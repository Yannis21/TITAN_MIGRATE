//AB/ Project StoixEmp2

// Project Object Structure
//   StoixEmp2 is a ReportViewSub
//     RadioGroupSub1 is a RadioGroupSub
//       Radio1 is a RadioSub
//       Radio2 is a RadioSub
//       Radio3 is a RadioSub
//       TextBoxSub28 is a TextBoxSub
//     GroupSub1 is a GroupSub
//       F_CODE_APO is a FormSub
//       TextBoxSub1 is a TextBoxSub
//       FormSub3 is a FormSub
//     GroupSub3 is a GroupSub
//       TextBoxSub25 is a TextBoxSub
//       frmYear is a FormSub
//       TextBoxSub26 is a TextBoxSub
//       frmMonth is a FormSub
//       frmMonthLekt is a FormSub
//       frmPolhths is a FormSub
//       frmPolhthsDescr is a FormSub
//       frmYpeyth is a FormSub
//       frmYpeythDescr is a FormSub
//       TextBoxSub1 is a TextBoxSub
//       TextBoxSub2 is a TextBoxSub
//       FormSub1 is a FormSub
//       Textbox1 is a Textbox
//       Form2 is a FormSub
//       chkMhden is a CheckBoxSub
//       chkApokripsi is a CheckBoxSub
//     ButtonSub1 is a Button
//       oPinakas is a Array
//       oPinakas2 is a Array
//       oPinHpal is a c2dArray
//     FCP_ProgressBar1 is a FCP_ProgressBar
//     RadioGroupSub2 is a RadioGroupSub
//       Radio1 is a RadioSub
//       Radio2 is a RadioSub
//       Radio3 is a RadioSub
//       ButtonSub1 is a ButtonSub
//     btnMess is a ButtonSub
//     ReportEmporias is a CrystalReportSubSQL
//     ReportMakeMeresRecords is a CrystalReportSubSQL
//     ReportMakeAnoixtosRecords is a CrystalReportSubSQL
//     ReportMakeHpalRecords is a CrystalReportSubSQL
//     ReportMakeTzirosRecords is a CrystalReport
//     ReportMakeAxioRecords is a CrystalReport
//     ReportMakeEisprakteaAxiografa is a CrystalReport
//     ReportMakeOfeilhRecords is a CrystalReport
//     ReportMakepaliaAxioRecords is a CrystalReport

// Register all objects
Register_Object ButtonSub1
Register_Object btnMess
Register_Object chkApokripsi
Register_Object chkMhden
Register_Object F_CODE_APO
Register_Object FCP_ProgressBar1
Register_Object Form2
Register_Object FormSub1
Register_Object FormSub3
Register_Object frmMonth
Register_Object frmMonthLekt
Register_Object frmPolhths
Register_Object frmPolhthsDescr
Register_Object frmYear
Register_Object frmYpeyth
Register_Object frmYpeythDescr
Register_Object GroupSub1
Register_Object GroupSub3
Register_Object oPinakas
Register_Object oPinakas2
Register_Object oPinHpal
Register_Object Radio1
Register_Object Radio2
Register_Object Radio3
Register_Object RadioGroupSub1
Register_Object RadioGroupSub2
Register_Object ReportEmporias
Register_Object ReportMakeAnoixtosRecords
Register_Object ReportMakeAxioRecords
Register_Object ReportMakeEisprakteaAxiografa
Register_Object ReportMakeHpalRecords
Register_Object ReportMakeMeresRecords
Register_Object ReportMakeOfeilhRecords
Register_Object ReportMakepaliaAxioRecords
Register_Object ReportMakeTzirosRecords
Register_Object StoixEmp2
Register_Object TextBoxSub1
Register_Object TextBoxSub2
Register_Object TextBoxSub25
Register_Object TextBoxSub26
Register_Object TextBoxSub28
Register_Object Textbox1


//AB/     Report View


    //AB-StoreTopStart
    Use dfallrpt
    Use syscurxr.dd
    Use sl100.sl
    use sl007.sl
    open clients
    use hmgio.sl
    use slrep.sl
    open sysrep
    Use sl111.sl
    Use sl108.sl
    Open Rptmp
    Open Clients
    Open Cmoves
    Open Wcmoves
    Open Particle
    Open Barticl
    Open Btypkin
    Open Ctypkin
    Open Bmove
    Open Baxiokat
    Open Baxio
    Use sl002.sl
    Use obarray2d.pkg
    
    //AB-StoreTopEnd

    //AB-IgnoreStart

    Use Rptvw.Sub
    Use Rgroup.Sub
    Use Radio.Sub
    Use Txtbox.Sub
    Use Group.Sub
    Use Form.Sub
    Use DFAllEnt.pkg
    Use Chkbox.Sub
    Use FCP_ProgressBar.PKG
    Use Button.Sub

    //AB-IgnoreEnd

    DEFERRED_VIEW Activate_StoixEmp2 FOR ;
    ;
    Object StoixEmp2 is a ReportViewSub

        //AB-StoreTopStart
                        
        Property String  psModule       Public ''
        property integer Epil           public 0
        property integer piWhat         public 0
        property integer piWhere        public 0
        property string  psBranch       public ''
        property string  psRep          public ''
        Property Integer piPoios        Public 0
        property string  psClientID     public ''
        property string  psPrespID      public ''
        property string  psSlsID        public ''
        property string  psClientName   public ''
        property string  psPrespName    public ''
        property string  psSlsName      public ''
        property integer piepidika      public 0
        
        //AB-StoreTopEnd

        Set Label to "Management Information System  - é†°¶§¶£†°· v2"
        Set Size to 234 455
        Set Location to 5 11
        Set Color to 10859729

        //AB-DDOStart


        //AB-DDOEnd

        Object RadioGroupSub1 is a RadioGroupSub
            Set Size to 66 151
            Set Location to 1 3
            Set Color to 10859729
            Object Radio1 is a RadioSub
                Set Label to "èú¢·´ú™"
                Set Size to 10 53
                Set Location to 10 5
                Set Color to 10859729
            End_Object    // Radio1

            Object Radio2 is a RadioSub
                Set Label to "è‡¢û´‚™"
                Set Size to 10 54
                Set Location to 10 87
                Set Color to 10859729
            End_Object    // Radio2

            Object Radio3 is a RadioSub
                Set Label to "ìß. è¢û®‡£È§"
                Set Size to 10 65
                Set Location to 25 5
                Set Color to 10859729
            End_Object    // Radio3

            Object TextBoxSub28 is a TextBoxSub

                //AB-StoreTopStart
                                                                                                                                                
                //AB-StoreTopEnd

                Set Label to "Ä§ õú§ úß†¢úöúÂ ©¨ö°ú°®†£‚§¶™ ìßúÁü. „ è‡¢û´„™ ´Ê´ú ´ò ú°´¨ß‡´†°· üò ôö¶Á§ ò§ò ìßúÁü. „ è‡¢û´„"
                Set Color to 10859729
                Set TextColor to clYellow
                Set Location to 37 5
                Set Size to 25 142
                Set Justification_Mode to jMode_Left
                Set TypeFace to "MS Sans Serif"

                //AB-StoreStart
                                                                                                                                                
                Set TextColor to clYellow
                
                
                //AB-StoreEnd

            End_Object    // TextBoxSub28


            //AB-StoreStart
                                                                                                    
            Procedure Notify_Select_State integer iToItem integer iFromItem
                Set piPoios to iToItem
            End_Procedure
            
            
            
            //AB-StoreEnd

        End_Object    // RadioGroupSub1

        Object GroupSub1 is a GroupSub
            Set Label to "Ñß†¢¶ö„ î¶®‚ò"
            Set Size to 28 283
            Set Location to 1 158
            Set Color to 10859729
            Object F_CODE_APO is a FormSub

                //AB-StoreTopStart
                                                                                                                                                
                //AB-StoreTopEnd

                Set Size to 13 65
                Set Location to 10 60
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
                Set Prompt_Button_Mode to pb_PromptOn
                Set Form_TypeFace Item 0 to "MS Sans Serif"

                //AB-StoreStart
                                                                                                                                                
                Set Prompt_Object to (SL100(Current_object))
                
                Procedure Prompt_Callback integer hPrompt
                    set Export_Column of hPrompt to 0
                    Set Initial_Column of hPrompt to 0
                end_procedure
                
                procedure onchange
                    String sclient
                    Get value item 0 to sClient
                    Set psClientID to sClient
                    Move (fsclient(Self,sclient)) to sclient
                    set value of (formsub3(self)) to sclient
                    Set psClientName to sClient
                end_procedure
                
                procedure prompt
                    Set psModule Of (sl100(Self)) to (psModule(Self))
                    Forward Send Prompt
                end_procedure
                
                
                
                
                //AB-StoreEnd

            End_Object    // F_CODE_APO

            Object TextBoxSub1 is a TextBoxSub
                Set Label to "ÄßÊ â‡õ†°Ê :"
                Set Auto_Size_State to FALSE
                Set Color to 10859729
                Set FontSize to 4 0
                Set Location to 11 5
                Set Size to 10 44
                Set TypeFace to "MS Sans Serif"
                Set Enabled_State to TRUE
            End_Object    // TextBoxSub1

            Object FormSub3 is a FormSub
                Set Size to 13 152
                Set Location to 10 127
                Set Color to 10859729
                Set Label_Col_Offset to 2
                Set Enabled_State to FALSE
                Set Form_TypeFace Item 0 to "MS Sans Serif"
                Set Item_Shadow_State Item 0 to TRUE
                Set Shadow_State Item 0 to TRUE

                //AB-StoreStart
                set enabled_state to false
                //AB-StoreEnd

            End_Object    // FormSub3


            //AB-StoreStart
            Function StartNumber Returns string
                Function_return (Value(f_code_apo(Current_object), 0))
            End_function
            
            //AB-StoreEnd

        End_Object    // GroupSub1

        Object GroupSub3 is a GroupSub
            Set Label to "Ñß†¢¶ö„ Ñ´¶¨™/ã„§ò, è‡¢û´„ && ìß. è¢û®‡£È§"
            Set Size to 148 283
            Set Location to 36 158
            Set Color to 10859729
            Object TextBoxSub25 is a TextBoxSub
                Set Label to "è‡¢û´„™"
                Set Auto_Size_State to FALSE
                Set Color to 10859729
                Set FontSize to 4 0
                Set Location to 42 7
                Set Size to 10 31
                Set TypeFace to "MS Sans Serif"
                Set Enabled_State to TRUE
            End_Object    // TextBoxSub25

            Object frmYear is a FormSub
                Set Size to 13 40
                Set Location to 24 7
                Set Label_Col_Offset to 2
                Set Form_TypeFace Item 0 to "MS Sans Serif"

                //AB-StoreStart
                                                                                                                                                
                //        Procedure OnChange
                //            Set piYear  to (Value(Self,0))
                //        End_Procedure
                
                //AB-StoreEnd

            End_Object    // frmYear

            Object TextBoxSub26 is a TextBoxSub
                Set Label to "ìß. è¢û®‡£È§"
                Set Auto_Size_State to FALSE
                Set Color to 10859729
                Set FontSize to 4 0
                Set Location to 66 7
                Set Size to 13 50
                Set TypeFace to "MS Sans Serif"
                Set Enabled_State to TRUE
            End_Object    // TextBoxSub26

            Object frmMonth is a FormSub
                Set Size to 13 28
                Set Location to 24 98
                Set Label_Col_Offset to 2
                Set Form_TypeFace Item 0 to "MS Sans Serif"

                //AB-StoreStart
                                                                                                                                                
                Procedure OnChange
                    //Set piMonth to (Value(Self,0))
                    Set Value Of frmMonthLekt Item 0 to ;
                        (TheMonthName(Value(Self,0),mMonthOnom))
                End_Procedure
                
                
                //AB-StoreEnd

            End_Object    // frmMonth

            Object frmMonthLekt is a FormSub
                Set Size to 13 109
                Set Location to 24 132
                Set Color to 10859729
                Set Label_Col_Offset to 2
                Set Enabled_State to FALSE
                Set Form_TypeFace Item 0 to "MS Sans Serif"
                Set Item_Shadow_State Item 0 to TRUE
                Set Shadow_State Item 0 to TRUE
            End_Object    // frmMonthLekt

            Object frmPolhths is a FormSub

                //AB-StoreTopStart
                                                                                                                                                
                //AB-StoreTopEnd

                Set Size to 13 83
                Set Location to 52 7
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
                Set Prompt_Button_Mode to pb_PromptOn
                Set Form_TypeFace Item 0 to "MS Sans Serif"

                //AB-StoreStart
                                                                                                                                                
                Set Prompt_Object to (sl108(Current_object))
                Procedure Prompt_Callback integer hPrompt
                    set Export_Column  of hPrompt to 0
                    Set Initial_Column of hPrompt to 0
                end_procedure
                
                procedure onchange
                    string sclient
                    get value item 0    to sclient
                    Set psSlsID         to sClient
                    Move (fsSalesmen(Self,sclient))         to sclient
                    set value of (frmPolhthsDescr(self))    to sclient
                    Set psSlsName to sClient
                end_procedure
                
                
                
                
                
                //AB-StoreEnd

            End_Object    // frmPolhths

            Object frmPolhthsDescr is a FormSub
                Set Size to 13 143
                Set Location to 52 98
                Set Color to 10859729
                Set Label_Col_Offset to 2
                Set Enabled_State to FALSE
                Set Form_TypeFace Item 0 to "MS Sans Serif"
                Set Item_Shadow_State Item 0 to TRUE
                Set Shadow_State Item 0 to TRUE

                //AB-StoreStart
                set enabled_state to false
                //AB-StoreEnd

            End_Object    // frmPolhthsDescr

            Object frmYpeyth is a FormSub

                //AB-StoreTopStart
                                                                                                                                                
                //AB-StoreTopEnd

                Set Size to 13 83
                Set Location to 79 7
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
                Set Prompt_Button_Mode to pb_PromptOn
                Set Form_TypeFace Item 0 to "MS Sans Serif"

                //AB-StoreStart
                                                                                                                                                
                Set Prompt_Object to (sl111(Current_object))
                
                Procedure Prompt_Callback integer hPrompt
                    set Export_Column  of hPrompt to 0
                    Set Initial_Column of hPrompt to 0
                end_procedure
                
                procedure onchange
                    string sclient
                    get value item 0    to sclient
                    Set psPrespID       to sClient
                    Move (fsPayresp(Self,sclient))      to sclient
                    set value of (frmYpeythDescr(self)) to sclient
                    Set psPrespName to sClient
                end_procedure
                
                
                
                
                
                
                
                //AB-StoreEnd

            End_Object    // frmYpeyth

            Object frmYpeythDescr is a FormSub
                Set Size to 13 143
                Set Location to 79 98
                Set Color to 10859729
                Set Label_Col_Offset to 2
                Set Enabled_State to FALSE
                Set Form_TypeFace Item 0 to "MS Sans Serif"
                Set Item_Shadow_State Item 0 to TRUE
                Set Shadow_State Item 0 to TRUE

                //AB-StoreStart
                set enabled_state to false
                //AB-StoreEnd

            End_Object    // frmYpeythDescr

            Object TextBoxSub1 is a TextBoxSub
                Set Label to "Ñ´¶™"
                Set Color to 10859729
                Set Location to 13 7
                Set Size to 10 19
                Set TypeFace to "MS Sans Serif"
            End_Object    // TextBoxSub1

            Object TextBoxSub2 is a TextBoxSub
                Set Label to "í®‚Æ¶§ ã„§ò™"
                Set Color to 10859729
                Set Location to 13 98
                Set Size to 10 49
                Set TypeFace to "MS Sans Serif"
            End_Object    // TextBoxSub2

            Object FormSub1 is a FormSub
                Set Size to 13 83
                Set Location to 104 7
                Set Label_Col_Offset to 2
                Set Prompt_Button_Mode to pb_PromptOn
                Set Form_TypeFace Item 0 to "MS Sans Serif"

                //AB-StoreStart
                                                                                                                                                
                                                                                                                                                
                Set Visible_State to False
                Set Enabled_State to False
                
                
                Set Prompt_Object to (sl002(Current_object))
                
                Procedure Prompt_Callback integer hPrompt
                    set Export_Column of hPrompt to 0
                    Set Initial_Column of hPrompt to 0
                end_procedure
                
                procedure onchange
                    string sbranch
                    get value item 0 to sbranch
                    clear branch
                    move syscurxr.company_code to branch.company_code
                    move sbranch               to branch.branch_code
                    find eq branch by index.1
                    if (found=1) set value of (form2(self)) to branch.branch_name
                    else         set value of (form2(self)) to ''
                end_procedure
                
                
                
                
                
                
                //AB-StoreEnd

            End_Object    // FormSub1

            Object Textbox1 is a Textbox
                Set Label to "ìß¶°/£ò"
                Set Color to 10859729
                Set Location to 94 7
                Set Size to 10 31
                Set TypeFace to "MS Sans Serif"

                //AB-StoreStart
                                                                                                                                                
                Set Visible_State to False
                
                
                //AB-StoreEnd

            End_Object    // Textbox1

            Object Form2 is a FormSub
                Set Size to 13 143
                Set Location to 103 99
                Set Color to 10859729
                Set Enabled_State to FALSE
                Set Form_TypeFace Item 0 to "MS Sans Serif"
                Set Item_Shadow_State Item 0 to TRUE
                Set Shadow_State Item 0 to TRUE

                //AB-StoreStart
                                                                                                                                                
                Set Visible_State to False
                Set Enabled_State to False
                
                //AB-StoreEnd

            End_Object    // Form2

            Object chkMhden is a CheckBoxSub
                Set Label to "èú¢·´ú™ £ú 0  ÜèÄä && Üèëé"
                Set Size to 10 109
                Set Location to 125 8
                Set Color to 10859729
            End_Object    // chkMhden

            Object chkApokripsi is a CheckBoxSub
                Set Label to "ï‡®†™ õû£†¶¨®öÂò ú° ´‡§ ß®‡´‚®‡§ ´‡§ 8 úöö®ò≠È§/ßú¢·´û"
                Set Size to 10 225
                Set Location to 135 8
                Set Color to 10859729
                Set Checked_State to TRUE
            End_Object    // chkApokripsi


            //AB-StoreStart
                                                                                                    
            Function fsPolhths Returns string
                Function_return (Value(frmPolhths(Current_object), 0))
            End_function
            
            Function fsYpeyth Returns string
                Function_return (Value(frmYpeyth(Current_object), 0))
            End_function
            
            Function fiYear Returns Integer
                Function_return (Value(frmYear(Current_object), 0))
            End_function
            
            Function fiMonth Returns Integer
                Function_return (Value(frmMonth(Current_object), 0))
            End_function
            
            Function fsMonth Returns String
                Function_return (Value(frmMonthLekt(Current_object), 0))
            End_function
            
            
            
            //AB-StoreEnd

        End_Object    // GroupSub3

        Object ButtonSub1 is a Button

            //AB-StoreTopStart
                    
            Object oPinakas is a Array
            End_Object
            
            Object oPinakas2 is a Array
            End_Object
            
            Object oPinHpal is a c2dArray
                Set piNumColumns to 3
            End_Object
            
            Function fiStoxosHpal String asCode Integer aiFlag Returns Integer
                If (aiFlag=0) Begin
                    Clear Clients
                    Move asCode to Clients.Client_ID
                    Find Eq Clients By Index.6
                    Function_Return Clients.Hpal
                End
                Else If (aiFlag=1 )Begin
                    Clear Payresp
                    Move asCode to Payresp.Presp_ID
                    Find Eq Payresp By Index.7
                    Function_Return Payresp.Stoxos_Ipal
                End
                Else Begin
                    Clear Salesmen
                    Move asCode to Salesmen.sls_ID
                    Find Eq Salesmen By Index.4
                    Function_Return Salesmen.sls_categfpa
                End
            End_Function
            
            Function fiStoxosHpso String asCode Integer aiFlag Returns Integer
                If (aiFlag=0) Begin
                    Clear Clients
                    Move asCode to Clients.Client_ID
                    Find Eq Clients By Index.6
                    Function_Return Clients.Hpso
                End
                Else If (aiFlag=1) Begin
                    Clear Payresp
                    Move asCode to Payresp.Presp_ID
                    Find Eq Payresp By Index.7
                    Function_Return Payresp.Stoxos_Ipso
                End
                Else Begin
                    Clear Salesmen
                    Move asCode to Salesmen.sls_ID
                    Find Eq Salesmen By Index.4
                    Function_Return Salesmen.sls_fpa
                End
            End_Function
            
            Function fsClientPayResp String asCode Returns String
                Clear Clients
                Move asCode to Clients.Client_ID
                Find Eq Clients By Index.6
                Function_Return (Trim(Clients.Presp_ID))
            End_Function
            
            //AB-StoreTopEnd

            Set Bitmap to "RUNPROG.BMP"
            Set Size to 18 28
            Set Location to 198 410

            //AB-StoreStart
                    
            //Set TooltipValue to "åúò Ñßú•ú®öò©Âò °ò† òß¶´ú¢‚©£ò´ò"
            
            Procedure OnClick
                Integer iYearTo iMonthTo iYearFrom iMonthFrom iBranch iDeikths iApokripsi iDeikths2
                Date    dHmniaApo dHmniaEos dHmnia
                String  sCompany sBranch sClientID s1  nOfeilh nAnoixtos iHpal sVal sName
                String  iHpso sPrespID sClientID2
                integer ihmgio iYes iFS iCount
                Number  n1 n2
            
                Get Value Of (FormSub1(GroupSub3(Self)))    to sBranch
                Move (Trim(sBranch))                        to sBranch
                Set psBranch                                to sBranch
            
                Move SyscurXR.Company_Code                  to sCompany
                Get fiYear  Of GroupSub3                    to iYearTo
                Get fiMonth Of GroupSub3                    to iMonthTo
                Move iMonthTo                               to iMonthFrom
                Move (iYearTo-1)                            to iYearFrom
            
                // Basikoi elegxoi data entry filtra epiloghs
                If ((iMonthTo<1) Or (iMonthTo>12)) Begin
                    Send Stop_Box 'äò§üò©£‚§û úß†¢¶ö„ £„§ò' 'è®¶©¶Æ„'
                    Send Activate to (frmMonth(GroupSub3(Self)))
                    Procedure_Return
                End
                If ((iYearTo<2002) Or (iYearTo>2100)) Begin
                    Send Stop_Box 'äò§üò©£‚§û úß†¢¶ö„ ‚´¶¨™' 'è®¶©¶Æ„'
                    Send Activate to (frmyear(GroupSub3(Self)))
                    Procedure_Return
                End
                If (psClientID(Self)<>'') Begin
                    Clear Clients
                    Move (psClientID(Self)) to Clients.Client_ID
                    Find Eq Clients By Index.6
                    If (Not(Found)) Begin
                        Send Stop_Box 'Ä§Áßò®°´¶™ èú¢·´û™' 'è®¶©¶Æ„'
                        Send Activate to (f_code_apo(GroupSub1(Self)))
                        Procedure_Return
                    End
                End
                If (psSlsID(Self)<>'') Begin
                    Clear Salesmen
                    Move (psSlsID(Self)) to Salesmen.Sls_ID
                    Find Eq Salesmen By Index.4
                    If (Not(Found)) Begin
                        Send Stop_Box 'Ä§Áßò®°´¶™ è‡¢û´„™' 'è®¶©¶Æ„'
                        Send Activate to (frmPolhths(GroupSub3(Self)))
                        Procedure_Return
                    End
                End
                If (psPrespID(Self)<>'') Begin
                    Clear Payresp
                    Move (psPrespID(Self)) to Payresp.Presp_ID
                    Find Eq Payresp By Index.7
                    If (Not(Found)) Begin
                        Send Stop_Box 'Ä§Áßò®°´¶™ ¨ßúÁü¨§¶™ ß¢û®‡£È§' 'è®¶©¶Æ„'
                        Send Activate to (frmYpeyth(GroupSub3(Self)))
                        Procedure_Return
                    End
                End
            //
                Zerofile Rptmp
                Erasefile "c:\hpal.txt"
                Erasefile "c:\rptmp3.txt"
                Erasefile "c:\rptmp3ax.txt"
                Erasefile "c:\rptmp3axn.txt"
                Erasefile "c:\rptmp3di.txt"
                Erasefile "c:\rptmp3dN.txt"
                Erasefile "c:\rptmp4.txt"
                Erasefile "c:\rptmp5.txt"
                Erasefile "c:\rptmp6.txt"
                Erasefile "c:\RptmHP.txt"
                Erasefile "c:\Anoixtos.txt"
            
                Move (DateCompose(TheDaySegment(EndOfMonth  (iMonthTo  ,iYearTo  )),iMonthTo  ,iYearTo  )) to dHmniaEos
                Move (DateCompose(TheDaySegment(BeginOfMonth(iMonthFrom,iYearFrom)),iMonthFrom,iYearFrom)) to dHmniaApo
            
                Get Checked_State Of (chkApokripsi(GroupSub3(Self))) to iApokripsi
            
                If (Not(iApokripsi)) Begin
                    // Make all records to keep all the rows for each client
                    // or for 1 client
                    If (piPoios(Self)=0) Begin
                        If (psClientID(Self)<>'') Begin
                            Clear Clients
                            Move (psClientID(Self)) to Clients.Client_ID
                            Find Eq Clients By Index.6
                            If (Not(Found)) Begin
                                Send Stop_Box 'Ä§Áßò®°´¶™ èú¢·´û™' 'è®¶©¶Æ„'
                                Procedure_Return
                            End
                            For iCount From 1 to 8
                                Clear Rptmp
                                Move sCompany               to Rptmp.Company_Code
                                Move sBranch                to Rptmp.Branch_Code
                                Move Clients.Client_ID      to Rptmp.ID1
                                Move iCount                 to Rptmp.Seira
                                Move Clients.Client_Name    to Rptmp.Name1
                                Move Clients.Hpso           to Rptmp.Stoxos_Hpso
                                Move Clients.Hpal           to Rptmp.Stoxos_Hpal
                                Saverecord Rptmp
                            Loop
                        End
                        Else Begin
                            File_Size Clients                   to iFS
                            Set piMinimum   Of FCP_ProgressBar1 to 1
                            Set piMaximum   Of FCP_ProgressBar1 to iFS
                            Set piAdvanceBy Of FCP_ProgressBar1 to 1
                            Set Label Of BtnMess to 'è®¶ú´¶†£ò©Âò Ê¢‡§ ´‡§ úöö®ò≠È§'
                            Clear Clients
                            Move 1 to Clients.Is_Client
                            Find Gt Clients By Index.7
                            While ((Found) And (Clients.Is_Client=1))
                                Send DoAdvance Of FCP_ProgressBar1
                                For iCount From 1 to 8
                                    Clear Rptmp
                                    Move sCompany               to Rptmp.Company_Code
                                    Move sBranch                to Rptmp.Branch_Code
                                    Move Clients.Client_ID      to Rptmp.ID1
                                    Move iCount                 to Rptmp.Seira
                                    Move Clients.Client_Name    to Rptmp.Name1
                                    Move Clients.Hpso           to Rptmp.Hpso
                                    Move Clients.Hpal           to Rptmp.Hpal
                                    Saverecord Rptmp
                                Loop
                                Find Gt Clients By Index.7
                            Loop
                        End
                    End
                    Else If (piPoios(Self)=1) Begin
                        If (psSlsID(Self)<>'') Begin
                            Clear Salesmen
                            Move (psSlsID(Self)) to Salesmen.SLS_ID
                            Find Eq Salesmen By Index.4
                            If (Not(Found)) Begin
                                Send Stop_Box 'Ä§Áßò®°´¶™ è‡¢û´„™' 'è®¶©¶Æ„'
                                Procedure_Return
                            End
                            For iCount From 1 to 8
                                Clear Rptmp
                                Move sCompany           to Rptmp.Company_Code
                                Move sBranch            to Rptmp.Branch_Code
                                Move Salesmen.Sls_ID    to Rptmp.ID1
                                Move iCount             to Rptmp.Seira
                                Move Salesmen.Sls_Name  to Rptmp.Name1
                                Saverecord Rptmp
                            Loop
                        End
                        Else Begin
                            File_Size Salesmen                  to iFS
                            Set piMinimum   Of FCP_ProgressBar1 to 1
                            Set piMaximum   Of FCP_ProgressBar1 to iFS
                            Set piAdvanceBy Of FCP_ProgressBar1 to 1
                            Set Label Of BtnMess to 'è®¶ú´¶†£ò©Âò Ê¢‡§ ´‡§ úöö®ò≠È§'
                            Clear Salesmen
                            Find Gt Salesmen.Recnum
                            While (Found)
                                Send DoAdvance Of FCP_ProgressBar1
                                For iCount From 1 to 8
                                    Clear Rptmp
                                    Move sCompany          to Rptmp.Company_Code
                                    Move sBranch           to Rptmp.Branch_Code
                                    Move Salesmen.Sls_ID   to Rptmp.ID1
                                    Move iCount            to Rptmp.Seira
                                    Move Salesmen.Sls_Name to Rptmp.Name1
                                    Saverecord Rptmp
                                Loop
                                Find Gt Salesmen.Recnum
                            Loop
                        End
                    End
                    Else Begin
                        If (psPrespID(Self)<>'') Begin
                            Clear Payresp
                            Move (psPrespID(Self)) to Payresp.Presp_ID
                            Find Eq Payresp By Index.7
                            If (Not(Found)) Begin
                                Send Stop_Box 'Ä§Áßò®°´¶™ ìß. è¢û®‡£È§' 'è®¶©¶Æ„'
                                Procedure_Return
                            End
                            For iCount From 1 to 8
                                Clear Rptmp
                                Move sCompany           to Rptmp.Company_Code
                                Move sBranch            to Rptmp.Branch_Code
                                Move Payresp.Presp_ID   to Rptmp.ID1
                                Move iCount             to Rptmp.Seira
                                Move Payresp.Presp_Name to Rptmp.Name1
                                Saverecord Rptmp
                            Loop
                        End
                        Else Begin
                            File_Size Payresp                   to iFS
                            Set piMinimum   Of FCP_ProgressBar1 to 1
                            Set piMaximum   Of FCP_ProgressBar1 to iFS
                            Set piAdvanceBy Of FCP_ProgressBar1 to 1
                            Set Label Of BtnMess to 'è®¶ú´¶†£ò©Âò Ê¢‡§ ´‡§ úöö®ò≠È§'
                            Clear Payresp
                            Find Gt Payresp.Recnum
                            While (Found)
                                Send DoAdvance Of FCP_ProgressBar1
                                For iCount From 1 to 8
                                    Clear Rptmp
                                    Move sCompany           to Rptmp.Company_Code
                                    Move sBranch            to Rptmp.Branch_Code
                                    Move Payresp.Presp_ID   to Rptmp.ID1
                                    Move iCount             to Rptmp.Seira
                                    Move Payresp.Presp_Name to Rptmp.Name1
                                    Saverecord Rptmp
                                Loop
                                Find Gt Payresp.Recnum
                            Loop
                        End
                    End
                End
            
            
            ///////////////////////////////////////////////////////////////
            ///////////////////////////////////////////////////////////////
                Number n30 n60 n90 n90Syn
            
                Set Label Of BtnMess to 'ìß¶¢¶ö†©£¶Â Ä§·¢¨©û™ Ä§¶†Æ´¶Á'
                Send Run_Report to ReportMakeAnoixtosRecords
            
                Direct_Input Channel 9 'C:\Anoixtos.txt'
                Send Delete_Data to oPinakas
            
                While (Not(Seqeof))
                    Read    Channel 9 sClientID n30 n60 n90 n90Syn
                    If (Trim(sClientID)='') Goto Telos_EdoN
            
                    // 17/02/2004
                    // Ellhnikoi Xarakthres mesa sto ID
                    If (Sysfile.version_Number='1') Move (ToOEM (sClientID)) to sClientID2
                    Else Move sClientID to sClientID2
            
                    // Make record 2 pedia anoixtou +30 +60 +90 90+ (Array 26-29)
                    Clear Rptmp
                    Move sCompany   to Rptmp.Company_Code
                    Move sBranch    to Rptmp.Branch_Code
                    Move sClientID2 to Rptmp.ID1
                    Move 2          to Rptmp.Seira
                    Find Eq Rptmp By Index.1
            
                    Move (Round_Number(n30   ,2)) to Rptmp.A30
                    Move (Round_Number(n60   ,2)) to Rptmp.A60
                    Move (Round_Number(n90   ,2)) to Rptmp.A90
                    Move (Round_Number(n90Syn,2)) to Rptmp.A120
            
            
                         If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID2)) to Rptmp.name1
                    Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID2)) to Rptmp.name1
                    Else                                                 Move (fsClient  (Self,sClientID2)) to Rptmp.name1
                    If (Trim(Rptmp.name1)='') Begin
                             If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID)) to Rptmp.name1
                        Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID)) to Rptmp.name1
                        Else                                                 Move (fsClient  (Self,sClientID)) to Rptmp.name1
                    End
            
                    Saverecord Rptmp
            
                    Set Label Of BtnMess to ('Ä§·¢¨©û Ä§¶†Æ´¶Á ä¶ö/£¶Á'+'  '+String(rptmp.recnum))
                    Readln  Channel 9
                    Send Delete_Data to oPinakas
                Loop
                Telos_EdoN:
                Close_Input Channel 9 'C:\Anoixtos.txt'
            
            
            ////////////////////////////////////////////////////////////////////////
            //////////////////// Tziros kai M3 /////////////////////////////////////
                Set Label Of BtnMess to 'ìß¶¢¶ö†©£¶Â íùÂ®¶¨ °ò† °¨ô†°È§'
                Send Run_Report to ReportMakeTzirosRecords
                Send Delete_Data to oPinakas
            
                Direct_Input Channel 9 'C:\rptmp3.txt'
            
                While (Not(Seqeof))
                    Read    Channel 9 sClientID sName
                    If (Trim(sClientID)='') Goto Telos_Edo2N
            
                    // 17/02/2004
                    // Ellhnikoi Xarakthres mesa sto ID
                    If (Sysfile.version_Number='1') Move (ToOEM (sClientID)) to sClientID2
                    Else Move sClientID to sClientID2
            
                    Send Delete_Data to oPinakas
            
                    // Gemizei to array apo 0-12 Tziros & 13-25 M3
                    For iDeikths From 0 to 25
                        Read    Channel 9 s1
                        Set Array_Value Of (oPinakas(Self)) Item iDeikths to s1
                    Loop
                    // Ayta ta 2 read einai gia ta lektika ton synolon
                    Read    Channel 9 s1 s1
                    // Gemizei to array apo 26-38 Syn Tzirou & 39-51 Syn M3
                    For iDeikths From 26 to 51
                        Read    Channel 9 s1
                        Set Array_Value Of (oPinakas(Self)) Item iDeikths to s1
                    Loop
            
            
                    // Make record 1 for M3 (Array 13-25)
                    Clear Rptmp
                    Move sCompany  to Rptmp.Company_Code
                    Move sBranch   to Rptmp.Branch_Code
                    Move sClientID2 to Rptmp.ID1
                    Move 1         to Rptmp.Seira
                    Find Eq Rptmp By Index.1
            
                    For iDeikths From 13 to 25
                        Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
                        Move (iDeikths-13)  to FieldIndex
                        Add (Round_Number(n1,1)) to Rptmp.Mhnas_Trex&
                    Loop
            
                         If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID2)) to Rptmp.name1
                    Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID2)) to Rptmp.name1
                    Else                                                 Move (fsClient  (Self,sClientID2)) to Rptmp.name1
                    If (Trim(Rptmp.name1)='') Begin
                             If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID)) to Rptmp.name1
                        Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID)) to Rptmp.name1
                        Else                                                 Move (fsClient  (Self,sClientID)) to Rptmp.name1
                    End
            
                    Saverecord Rptmp
            
                    Set Label Of BtnMess to ('ìß¶¢¶ö†©£¶Â íùÂ®¶¨ °ò† °¨ô†°È§'+'  '+String(Rptmp.Recnum))
            
            
                    // Make record 6 for Tziros (Array 0-12)
                    Clear Rptmp
                    Move sCompany  to Rptmp.Company_Code
                    Move sBranch   to Rptmp.Branch_Code
                    Move sClientID2 to Rptmp.ID1
                    Move 6         to Rptmp.Seira
                    Find Eq Rptmp By Index.1
                    For iDeikths From 0 to 12
                        Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
                        Move iDeikths  to FieldIndex
                        Add (Round_Number(n1,2)) to Rptmp.Mhnas_Trex&
                    Loop
            
                         If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID2)) to Rptmp.name1
                    Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID2)) to Rptmp.name1
                    Else                                                 Move (fsClient  (Self,sClientID2)) to Rptmp.name1
                    If (Trim(Rptmp.name1)='') Begin
                             If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID)) to Rptmp.name1
                        Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID)) to Rptmp.name1
                        Else                                                 Move (fsClient  (Self,sClientID)) to Rptmp.name1
                    End
            
                    Saverecord Rptmp
            
                    Set Label Of BtnMess to ('ìß¶¢¶ö†©£¶Â íùÂ®¶¨ °ò† °¨ô†°È§'+'  '+String(Rptmp.Recnum))
                    Readln  Channel 9
                Loop
                Telos_Edo2N:
            
            
                // Make Synola record 1 for M3 (Array 39-51)
                Clear Rptmp
            
                Move sCompany                                  to Rptmp.Company_Code
                Move sBranch                                   to Rptmp.Branch_Code
                Move '99999999'                                 to Rptmp.ID1
                Move 1                                          to Rptmp.Seira
                Find Eq Rptmp By Index.1
                For iDeikths From 39 to 51
                    Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
                    Move (iDeikths-39)  to FieldIndex
                    Add (Round_Number(n1,1)) to Rptmp.Mhnas_Trex&
                Loop
                Move 'óó6ˇëÁ§¶¢ò è‡¢„©ú†™ ã3'                  to Rptmp.name1
                Saverecord Rptmp
            
            
                // Make Synola record 6 for Tziros (Array 26-38)
                Clear Rptmp
            
                Move sCompany                                  to Rptmp.Company_Code
                Move sBranch                                   to Rptmp.Branch_Code
                Move '99999999'                                 to Rptmp.ID1
                Move 6                                          to Rptmp.Seira
                Find Eq Rptmp By Index.1
                For iDeikths From 26 to 38
                    Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
                    Move (iDeikths-26)  to FieldIndex
                    Add (Round_Number(n1,2)) to Rptmp.Mhnas_Trex&
                Loop
                Move 'óó6ˇëÁ§¶¢ò íùÂ®¶¨'                        to Rptmp.name1
                Saverecord Rptmp
                Close_Input Channel 9 'C:\rptmp3.txt'
            
            
            
            ////////////////////////////////////////////////////////////////////////
            //////  ãake record 3 aksiografon /////////////
                Set Label Of BtnMess to 'ìß¶¢¶ö†©£¶Â Ñ†©ß®ò°´‚‡§ Ä•†¶ö®·≠‡§'
                Set Report_Name     of ReportMakeAxioRecords to "rptmp3ax.rpt"
                Set ExportFileName  of ReportMakeAxioRecords to "c:\rptmp3ax.txt"
                Set piEpidika       of ReportMakeAxioRecords to 0
                Send Run_Report to ReportMakeAxioRecords
                Send Delete_Data to oPinakas
            
                Direct_Input Channel 9 'C:\rptmp3ax.txt'
            
                //
            
                While (Not(Seqeof))
                    Read    Channel 9 sClientID sName
                    If (Trim(sClientID)='') Goto Telos_Edo3N
                    // 17/02/2004
                    // Ellhnikoi Xarakthres mesa sto ID
                    If (Sysfile.version_Number='1') Move (ToOEM (sClientID)) to sClientID2
                    Else Move sClientID to sClientID2
            
                    Send Delete_Data to oPinakas
            
                    // Gemizei to array apo 0-12 aksiografa
                    For iDeikths From 0 to 12
                        Read    Channel 9 s1
                        Set Array_Value Of (oPinakas(Self)) Item iDeikths to s1
                    Loop
                    // Ayta ta 2 read einai gia ta lektika ton synolon
                    Read    Channel 9 s1 s1
                    // Gemizei to array apo 13-25 Syn aksiografon
                    For iDeikths From 13 to 25
                        Read    Channel 9 s1
                        Set Array_Value Of (oPinakas(Self)) Item iDeikths to s1
                    Loop
            
            
                    // Make record 3 for axiografa (Array 0-12)
                    Clear Rptmp
            
                    Move sCompany  to Rptmp.Company_Code
                    Move sBranch   to Rptmp.Branch_Code
                    Move sClientID2 to Rptmp.ID1
                    Move 3         to Rptmp.Seira
                    Find Eq Rptmp By Index.1
                    For iDeikths From 0 to 12
                        Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
                        Move iDeikths   to FieldIndex
                        Add (Round_Number(n1,2)) to Rptmp.Mhnas_Trex&
                    Loop
                         If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID2)) to Rptmp.name1
                    Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID2)) to Rptmp.name1
                    Else                                                 Move (fsClient  (Self,sClientID2)) to Rptmp.name1
                    If (Trim(Rptmp.name1)='') Begin
                             If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID)) to Rptmp.name1
                        Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID)) to Rptmp.name1
                        Else                                                 Move (fsClient  (Self,sClientID)) to Rptmp.name1
                    End
            
                    Saverecord Rptmp
            
                    Set Label Of BtnMess to ('ìß¶¢¶ö†©£¶Â Ñ†©ß®ò°´‚‡§ Ä•†¶ö®·≠‡§'+'  '+String(Rptmp.Recnum))
                    Readln  Channel 9
                loop
                Telos_Edo3N:
            
            
                // Make Synola record 3 for aksiografa synola (Array 13-25)
                Clear Rptmp
            
                Move sCompany                                  to Rptmp.Company_Code
                Move sBranch                                   to Rptmp.Branch_Code
                Move '99999999'                                to Rptmp.ID1
                Move 3                                         to Rptmp.Seira
                Find Eq Rptmp By Index.1
                For iDeikths From 13 to 25
                    Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
                    Move (iDeikths-13)  to FieldIndex
                    Add (Round_Number(n1,2)) to Rptmp.Mhnas_Trex&
                Loop
                Move 'óó3ˇëÁ§¶¢ò Ñ†©ß®ò°´‚‡§ Ä•†¶ö®·≠‡§'       to Rptmp.name1
                Saverecord Rptmp
                Close_Input Channel 9 'C:\rptmp3ax.txt'
            
            
            ////////////////////////////////////////////////////////////////////////
            //// Neos kodikas & report gia ta epidika
            //// me thn nea logikh tou Btypkin.Gtypkin_Code
            //// to opoio an exei timh 0 tote ola doyleyoun opos prepei,
            //// an exei timh 1 tote DEN lamvanetai yp opsin to poso
            //// kai an exei timh 2 tote to poso tou axiografou erxetai arnhtika
            //// Edo asxoloumaste MONO me to record 4 ton epidikon
            /////////////////////////////////////////////////////////////////////////
                Erasefile "c:\rptmp3dN.txt"
                Set Label Of BtnMess to 'ìß¶¢¶ö†©£¶Â ÑßÂõ†°‡§ Ä•†¶ö®·≠‡§'
                Set Report_Name     of ReportMakeAxioRecords to "rptmp3diNew.rpt"
                Set ExportFileName  of ReportMakeAxioRecords to "c:\rptmp3dN.txt"
                Set piEpidika       of ReportMakeAxioRecords to 1
                Send Run_Report to ReportMakeAxioRecords
                Send Delete_Data to oPinakas
            
                Direct_Input Channel 9 'C:\rptmp3dN.txt'
            
                While (Not(Seqeof))
                    Read    Channel 9 sClientID sName
                    If (Trim(sClientID)='') Goto Telos_Edo3N_1N
                    // 17/02/2004
                    // Ellhnikoi Xarakthres mesa sto ID
                    If (Sysfile.version_Number='1') Move (ToOEM (sClientID)) to sClientID2
                    Else Move sClientID to sClientID2
            
                    Send Delete_Data to oPinakas
            
                    // Gemizei to array apo 0-14 aksiografa
                    For iDeikths From 0 to 14
                        Read    Channel 9 s1
                        Set Array_Value Of (oPinakas(Self)) Item iDeikths to s1
                    Loop
                    // Ayta ta 2 read einai gia ta lektika ton synolon
                    Read    Channel 9 s1 s1
                    // Gemizei to array apo 15-27 Syn aksiografon
                    For iDeikths From 15 to 27
                        Read    Channel 9 s1
                        Set Array_Value Of (oPinakas(Self)) Item iDeikths to s1
                    Loop
            
                    // Make record 4 for úß†õ†°ò aksiografa (Array 0-12) +2 gia synola epit/synal
                    Clear Rptmp
            
                    Move sCompany  to Rptmp.Company_Code
                    Move sBranch   to Rptmp.Branch_Code
                    Move sClientID2 to Rptmp.ID1
                    Move 4         to Rptmp.Seira
                    Find Eq Rptmp By Index.1
                    For iDeikths From 0 to 14
                        Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
                        If (iDeikths>12) Begin
                            If (iDeikths=13) Add (Round_Number(n1,2)) to Rptmp.Epid_Epitag
                            Else             Add (Round_Number(n1,2)) to Rptmp.Epid_Synal
                        End
                        Else Begin
                            Move iDeikths   to FieldIndex
                            Add (Round_Number(n1,2)) to Rptmp.Mhnas_Trex&
                        End
                    Loop
            
                         If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID2)) to Rptmp.name1
                    Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID2)) to Rptmp.name1
                    Else                                                 Move (fsClient  (Self,sClientID2)) to Rptmp.name1
                    If (Trim(Rptmp.name1)='') Begin
                             If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID)) to Rptmp.name1
                        Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID)) to Rptmp.name1
                        Else                                                 Move (fsClient  (Self,sClientID)) to Rptmp.name1
                    End
            
                    Saverecord Rptmp
            
            
                    Set Label Of BtnMess to ('ìß¶¢¶ö†©£¶Â ÑßÂõ†°‡§ Ä•†¶ö®·≠‡§'+'  '+String(Rptmp.Recnum))
                    Readln  Channel 9
                loop
                Telos_Edo3N_1N:
            
                // Make Synola record 4 for aksiografa synola (Array 13-25)
                Clear Rptmp
                Move sCompany                                  to Rptmp.Company_Code
                Move sBranch                                   to Rptmp.Branch_Code
                Move '99999999'                                to Rptmp.ID1
                Move 4                                         to Rptmp.Seira
                Find Eq Rptmp By Index.1
                For iDeikths From 15 to 27
                    Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
                    Move (iDeikths-15)  to FieldIndex
                    Add (Round_Number(n1,2)) to Rptmp.Mhnas_Trex&
                Loop
                Move 'óó4ˇëÁ§¶¢ò ÑßÂõ†°‡§ Ä•†¶ö®·≠‡§'          to Rptmp.name1
                Saverecord Rptmp
            
                Close_Input Channel 9 'C:\rptmp3dN.txt'
            
            
            
            
            ////////////////////////////////////////////////////////////////////////
            //////////////////// Anoixtos Logar + Syn. Ofeilh///////////////////////
            ////////////////////////////////////////////////////////////////////////
            
                Set Label Of BtnMess to 'è®¶ú´¶†£ò©Âò Ä§¶†Æ´¶Á ä¶ö/£¶Á && ë¨§. é≠ú†¢„™'
                Send Run_Report to ReportMakeOfeilhRecords
                Send Delete_Data to oPinakas
            
                Direct_Input Channel 9 'C:\rptmp4.txt'
            
                While (Not(Seqeof))
                    Read    Channel 9 sClientID sName
                    If (Trim(sClientID)='') Goto Telos_Edo4N
            
                    // 17/02/2004
                    // Ellhnikoi Xarakthres mesa sto ID
                    If (Sysfile.version_Number='1') Move (ToOEM (sClientID)) to sClientID2
                    Else Move sClientID to sClientID2
            
                    Send Delete_Data to oPinakas
                    // Gemizei to array apo 0-12 An.Logariasmos
                    For iDeikths From 0 to 12
                        Read    Channel 9 s1
                        Set Array_Value Of (oPinakas(Self)) Item iDeikths to s1
                    Loop
            
                    // Make record 2 and 5 for Anoixtos Logariasmos and Syn Ofeilh (Array 0-12)
                    // Oles oi xreoseis kai oi pistoseis apo kykloma cmoves.
                    // diamorfonoun A.Log & S. Ofeilh
                    Clear Rptmp
                    Move sCompany  to Rptmp.Company_Code
                    Move sBranch   to Rptmp.Branch_Code
                    Move sClientID2 to Rptmp.ID1
                    Move 2         to Rptmp.Seira
                    Find Eq Rptmp By Index.1
                    For iDeikths From 0 to 12
                        Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
                        Move iDeikths  to FieldIndex
                        Add (Round_Number(n1,2)) to Rptmp.Mhnas_Trex&
                    Loop
                         If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID2)) to Rptmp.name1
                    Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID2)) to Rptmp.name1
                    Else                                                 Move (fsClient  (Self,sClientID2)) to Rptmp.name1
                    If (Trim(Rptmp.name1)='') Begin
                             If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID)) to Rptmp.name1
                        Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID)) to Rptmp.name1
                        Else                                                 Move (fsClient  (Self,sClientID)) to Rptmp.name1
                    End
                    Saverecord Rptmp
            
                    Clear Rptmp
                    Move sCompany  to Rptmp.Company_Code
                    Move sBranch   to Rptmp.Branch_Code
                    Move sClientID2 to Rptmp.ID1
                    Move 5         to Rptmp.Seira
                    Find Eq Rptmp By Index.1
                    For iDeikths From 0 to 12
                        Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
                        Move iDeikths  to FieldIndex
                        Add (Round_Number(n1,2)) to Rptmp.Mhnas_Trex&
                    Loop
                         If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID2)) to Rptmp.name1
                    Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID2)) to Rptmp.name1
                    Else                                                 Move (fsClient  (Self,sClientID2)) to Rptmp.name1
                    If (Trim(Rptmp.name1)='') Begin
                             If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID)) to Rptmp.name1
                        Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID)) to Rptmp.name1
                        Else                                                 Move (fsClient  (Self,sClientID)) to Rptmp.name1
                    End
                    Saverecord Rptmp
            
            
                    // Make Synola record 2 for Anoixtos logariasmos
                    Clear Rptmp
                    Move sCompany                                  to Rptmp.Company_Code
                    Move sBranch                                   to Rptmp.Branch_Code
                    Move '99999999'                                to Rptmp.ID1
                    Move 2                                         to Rptmp.Seira
                    Find Eq Rptmp By Index.1
                    For iDeikths From 0 to 12
                        Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
                        Move iDeikths   to FieldIndex
                        Add (Round_Number(n1,2)) to Rptmp.Mhnas_Trex&
                    Loop
                    Move 'óó2ˇëÁ§¶¢ò Ä§¶†Æ´¶Á ä¶öò®†ò©£¶Á'       to Rptmp.name1
                    Saverecord Rptmp
            
                    // Make Synola record 5 for synolikh ofeilh
                    Clear Rptmp
                    Move sCompany                                  to Rptmp.Company_Code
                    Move sBranch                                   to Rptmp.Branch_Code
                    Move '99999999'                                to Rptmp.ID1
                    Move 5                                         to Rptmp.Seira
                    Find Eq Rptmp By Index.1
                    For iDeikths From 0 to 12
                        Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
                        Move iDeikths   to FieldIndex
                        Add (Round_Number(n1,2)) to Rptmp.Mhnas_Trex&
                    Loop
                    Move 'óó5ˇëÁ§¶¢ò ë¨§¶¢†°„™ é≠ú†¢„™'       to Rptmp.name1
                    Saverecord Rptmp
            
                    Set Label Of BtnMess to ('è®¶ú´¶†£ò©Âò Ä§¶†Æ´¶Á ä¶ö/£¶Á && ë¨§. é≠ú†¢„™'+'  '+Trim(sClientID2)+' '+String(Rptmp.Recnum))
                    Readln  Channel 9
                Loop
                Telos_Edo4N:
            
                Close_Input Channel 9 'C:\rptmp4.txt'
            
            
                //////////////////////////////////////////////////////////////////
                // Anadiorganosh An.logariasmou & Syn. Ofeilhs Ana Pelath/Ypeuthyno
                // me thn logikh oti gia kathe mhna prosthetoume tous pio piso
                // PROSOXH KANEI ANADIORGANOSH KAI STA SYNOLA
                //////////////////////////////////////////////////////////////////
                Number nTotal
                Move 0 to nTotal
                Clear Rptmp
                Move sCompany  to Rptmp.Company_Code
                Move sBranch   to Rptmp.Branch_Code
                Move 2         to Rptmp.Seira
                Find Gt Rptmp By Index.6
                While ((Found=1) And (sCompany=Rptmp.Company_Code) And (sBranch=Rptmp.Branch_Code) And (Rptmp.Seira=2))
                    Move 12 to iCount
                    For iDeikths2 From 0 to 12
                        Move 0 to nTotal
                        For iDeikths From iDeikths2 to iCount
                            Move iDeikths  to FieldIndex
                            Add Rptmp.Mhnas_Trex& to nTotal
                        Loop
                        Move iDeikths2  to FieldIndex
                        Move nTotal     to Rptmp.Mhnas_Trex&
                    Loop
                    Saverecord Rptmp
                    Set Label Of BtnMess to ('É†ò£Ê®≠‡©û Ä§¶†Æ´¶Á ä¶ö/£¶Á '+'  '+Trim(Rptmp.ID1)+' '+String(Rptmp.Recnum))
            
                    Find Gt Rptmp By Index.6
                Loop
            
                Move 0 to nTotal
                Clear Rptmp
                Move sCompany  to Rptmp.Company_Code
                Move sBranch   to Rptmp.Branch_Code
                Move 5         to Rptmp.Seira
                Find Gt Rptmp By Index.6
                While ((Found=1) And (sCompany=Rptmp.Company_Code) And (sBranch=Rptmp.Branch_Code) And (Rptmp.Seira=5))
                    Move 12 to iCount
                    For iDeikths2 From 0 to 12
                        Move 0 to nTotal
                        For iDeikths From iDeikths2 to iCount
                            Move iDeikths  to FieldIndex
                            Add Rptmp.Mhnas_Trex& to nTotal
                        Loop
                        Move iDeikths2  to FieldIndex
                        Move nTotal to Rptmp.Mhnas_Trex&
                    Loop
                    Saverecord Rptmp
                    Set Label Of BtnMess to ('É†ò£Ê®≠‡©û ë¨§. é≠ú†¢„™'+'  '+Trim(Rptmp.Id1)+' '+String(Rptmp.Recnum))
            
                    Find Gt Rptmp By Index.6
                Loop
            
            ////////////////////////////////////////////////////////////////////////
            ////////            Make record 5 Synolilh ofeilh          /////////////
            ////////            è®¶©üú´¶¨£ú ´ò ò¢û°´ò ò•†¶ö®ò≠ò        /////////////
            ////////////////////////////////////////////////////////////////////////
            //   Nea logikh gia Posa Synolikon ofeilon
            ////////////////////////////////////////////////////////////////////////
                Integer jj jMhnas jEtos kMhnas kEtos
                Date    ddate
            
                Get fiYear  Of GroupSub3  to iYearTo
                Get fiMonth Of GroupSub3  to iMonthTo
            
                For jj From 0 to 12
            
                    Move (iMonthTo-jj) to jMhnas
                    Move iYearTo       to kEtos
            
                    If (jMhnas<=0) Begin
                        Move (12-(ABS(jMhnas))) to kMhnas
                        Move (iYearTo-1)        to kEtos
                    End
                    Else Move jMhnas            to kMhnas
            
                    Set piTrexonEtos  Of ReportMakeEisprakteaAxiografa to kEtos
                    Set piTrexonMhnas Of ReportMakeEisprakteaAxiografa to kMhnas
            
                    Move (DateCompose(TheDaySegment(beginOfMonth(kMhnas,(kEtos  ))),kMhnas,(kEtos  ))) to ddate
                    Move (DateCompose(TheDaySegment(endOfMonth  (kMhnas,(kEtos  ))),kMhnas,(kEtos  ))) to dhmniaeos
                    Move (DateCompose(TheDaySegment(BeginOfMonth(kMhnas,(kEtos-1))),kMhnas,(kEtos-1))) to dHmniaApo
            
            
                    Set Label Of BtnMess to 'É†òÆ®¶§†°¶Â ìß¶¢/©£¶Â Ñ†©ß®. Ä•†¶ö®·≠‡§'
                    Set Report_Name     of ReportMakeEisprakteaAxiografa to "rptmp3axn.rpt"
                    Set ExportFileName  of ReportMakeEisprakteaAxiografa to ("c:\"+String(jj)+".txt")
                    Send Run_Report to ReportMakeEisprakteaAxiografa
            
                    Send Delete_Data to oPinakas
            
                    Direct_Input Channel 9 ("c:\"+String(jj)+".txt")
            
                    //
            
                    While (Not(Seqeof))
                        Read    Channel 9 sClientID sName n1
                        If (Trim(sClientID)='') Goto Telos_Edo3axn
                        // 17/02/2004
                        // Ellhnikoi Xarakthres mesa sto ID
                        If (Sysfile.version_Number='1') Move (ToOEM (sClientID)) to sClientID2
                        Else Move sClientID to sClientID2
            
                        // Make record 5 for Synolikh ofeilh (Array 0-12)
                        Clear Rptmp
                        Move sCompany  to Rptmp.Company_Code
                        Move sBranch   to Rptmp.Branch_Code
                        Move sClientID2 to Rptmp.ID1
                        Move 5         to Rptmp.Seira
                        Find Eq Rptmp By Index.1
                        //Move s1 to n1
                        Move jj to FieldIndex
                        Add (Round_Number(n1,2)) to Rptmp.Mhnas_Trex&
            
                             If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID2)) to Rptmp.name1
                        Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID2)) to Rptmp.name1
                        Else                                                 Move (fsClient  (Self,sClientID2)) to Rptmp.name1
                        If (Trim(Rptmp.name1)='') Begin
                                 If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID)) to Rptmp.name1
                            Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID)) to Rptmp.name1
                            Else                                                 Move (fsClient  (Self,sClientID)) to Rptmp.name1
                        End
                        Saverecord Rptmp
            
                        // Make Synola record 5 for synolikh ofeilh
                        Clear Rptmp
                        Move sCompany                                  to Rptmp.Company_Code
                        Move sBranch                                   to Rptmp.Branch_Code
                        Move '99999999'                                to Rptmp.ID1
                        Move 5                                         to Rptmp.Seira
                        Find Eq Rptmp By Index.1
                        //Move s1 to n1
                        Move jj to FieldIndex
                        Add (Round_Number(n1,2)) to Rptmp.Mhnas_Trex&
                        Move 'óó5ˇëÁ§¶¢ò ë¨§¶¢†°„™ é≠ú†¢„™'       to Rptmp.name1
                        Saverecord Rptmp
                        Set Label Of BtnMess to ('É†òÆ®¶§†°¶Â ìß¶¢/©£¶Â Ñ†©ß®. Ä•†¶ö®·≠‡§'+'  '+Trim(sClientID2))
                        Readln  Channel 9
                    loop
                    Telos_Edo3axn:
                    Close_Input Channel 9 'C:\rptmp3ax.txt'
            
                Loop
            
            
            ////////////////////////////////////////////////////////////////////////
            //////// Hmeres HPAL kai HPSO + analysh anoixtou 30/60/90/90+///////////
                Set Label Of BtnMess to 'Ü£‚®ú™ ÜèÄä °ò† Üèëé'
                Send Run_Report to ReportMakeMeresRecords
                Send Delete_Data to oPinakas
                Number nHpal nHpso
                Direct_Input Channel 9 'C:\RptmHp.txt'
            
                While (Not(Seqeof))
                    Read    Channel 9 sClientID sName nHpal nHpso
                    If (Trim(sClientID)='') Goto Telos_Edo2P
            
                    // 17/02/2004
                    // Ellhnikoi Xarakthres mesa sto ID
                    If (Sysfile.version_Number='1') Move (ToOEM (sClientID)) to sClientID2
                    Else Move sClientID to sClientID2
            
                    Send Delete_Data to oPinakas
            
                    // Gemizei to array apo
                    //  0-12 Meres HPAL
                    // 13-25 Meres HPSO
                    For iDeikths From 0 to 12
                        Read    Channel 9 s1
                        Set Array_Value Of (oPinakas(Self)) Item iDeikths to s1
                    Loop
                    For iDeikths From 13 to 25
                        Read    Channel 9 s1
                        Set Array_Value Of (oPinakas(Self)) Item iDeikths to s1
                    Loop
            
                    // Make record 8 for Hpso (Array 13-25)
                    Clear Rptmp
                    Move sCompany   to Rptmp.Company_Code
                    Move sBranch    to Rptmp.Branch_Code
                    Move sClientID2 to Rptmp.ID1
                    Move 8          to Rptmp.Seira
                    Find Eq Rptmp By Index.1
            
            /// ??????????????? XREIAZONTAI ?????????????
            //        Move iHpso      to Rptmp.Hpso
            //        Move iHpal      to Rptmp.Hpal
            //        Move nAnoixtos  to Rptmp.Anoixtos
            //        Move nOfeilh    to Rptmp.Ofeilh
            /// ??????????????? XREIAZONTAI ?????????????
            
                    For iDeikths From 13 to 25
                        Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
                        Move (iDeikths-13)  to FieldIndex
                        Move (Round_Number(n1,0)) to Rptmp.Mhnas_Trex&
                    Loop
            
                         If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID2)) to Rptmp.name1
                    Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID2)) to Rptmp.name1
                    Else                                                 Move (fsClient  (Self,sClientID2)) to Rptmp.name1
                    If (Trim(Rptmp.name1)='') Begin
                             If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID)) to Rptmp.name1
                        Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID)) to Rptmp.name1
                        Else                                                 Move (fsClient  (Self,sClientID)) to Rptmp.name1
                    End
            
                    If ((piPoios(Self)=2) And (psPrespID(Self)='')) Begin
                        Get fiStoxosHpso sClientID2 1 to Rptmp.Stoxos_Hpso
                        Get fiStoxosHpal sClientID2 1 to Rptmp.Stoxos_Hpal
                    End
                    Else If ((piPoios(Self)=1) And (psSlsID(Self)='')) Begin
                        Get fiStoxosHpso sClientID2 2 to Rptmp.Stoxos_Hpso
                        Get fiStoxosHpal sClientID2 2 to Rptmp.Stoxos_Hpal
                    End
                    Else Begin
                        Get fiStoxosHpso sClientID2 0 to Rptmp.Stoxos_Hpso
                        Get fiStoxosHpal sClientID2 0 to Rptmp.Stoxos_Hpal
                    End
            
                    Move nHpal to Rptmp.Hpal
                    Move nHpso to Rptmp.Hpso
            
                    Saverecord Rptmp
                    Set Label Of BtnMess to ('ìß¶¢¶ö†©£¶Â ÜèÄä / Üèëé'+'  '+String(rptmp.recnum))
            //
                    // Make record 7 for Hpal (Array 0-12)
                    Clear Rptmp
                    Move sCompany  to Rptmp.Company_Code
                    Move sBranch   to Rptmp.Branch_Code
                    Move sClientID2 to Rptmp.ID1
                    Move 7         to Rptmp.Seira
                    Find Eq Rptmp By Index.1
            /// ??????????????? XREIAZONTAI ?????????????
            //        Move iHpso      to Rptmp.Hpso
            //        Move iHpal      to Rptmp.Hpal
            //        Move nAnoixtos  to Rptmp.Anoixtos
            //        Move nOfeilh    to Rptmp.Ofeilh
            /// ??????????????? XREIAZONTAI ?????????????
                    For iDeikths From 0 to 12
                        Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
                        Move iDeikths  to FieldIndex
                        Move (Round_Number(n1,0)) to Rptmp.Mhnas_Trex&
                    Loop
            
                         If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID2)) to Rptmp.name1
                    Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID2)) to Rptmp.name1
                    Else                                                 Move (fsClient  (Self,sClientID2)) to Rptmp.name1
                    If (Trim(Rptmp.name1)='') Begin
                             If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID)) to Rptmp.name1
                        Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID)) to Rptmp.name1
                        Else                                                 Move (fsClient  (Self,sClientID)) to Rptmp.name1
                    End
            
                    If ((piPoios(Self)=2) And (psPrespID(Self)='')) Begin
                        Get fiStoxosHpso sClientID2 1 to Rptmp.Stoxos_Hpso
                        Get fiStoxosHpal sClientID2 1 to Rptmp.Stoxos_Hpal
                    End
                    Else If ((piPoios(Self)=1) And (psSlsID(Self)='')) Begin
                        Get fiStoxosHpso sClientID2 2 to Rptmp.Stoxos_Hpso
                        Get fiStoxosHpal sClientID2 2 to Rptmp.Stoxos_Hpal
                    End
                    Else Begin
                        Get fiStoxosHpso sClientID2 0 to Rptmp.Stoxos_Hpso
                        Get fiStoxosHpal sClientID2 0 to Rptmp.Stoxos_Hpal
                    End
            
                    Saverecord Rptmp
            
                    Readln  Channel 9
                Loop
                Telos_Edo2P:
            
                Close_Input Channel 9 'C:\rptmHP.txt'
            
            
            
            /////////////////////////////////////////////////////////////////
            /////// Telos olon ton report pou xrhsimopoihthikan /////////////
            /////// gia na vgaloume ta epimerous apotelesmata   /////////////
            /////////////////////////////////////////////////////////////////
            
                Send RunemporReport  to (ReportEmporias(current_object))
                Set Label Of BtnMess to ''
            
                Set Epil           to 0
                Set piWhat         to 0
                Set piWhere        to 0
                Set psBranch       to ''
                Set psRep          to ''
                Set psClientID     to ''
                Set psPrespID      to ''
                Set psSlsID        to ''
                Set psClientName   to ''
                Set psPrespName    to ''
                Set psSlsName      to ''
                Set piepidika      to 0
            
                Set Value Of (frmYpeyth (GroupSub3(Self))) Item 0 to ''
                Set Value Of (frmPolhths(GroupSub3(Self))) Item 0 to ''
                Set Value Of (F_Code_Apo(GroupSub1(Self))) Item 0 to ''
            
            End_Procedure // OnClick
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            //AB-StoreEnd

        End_Object    // ButtonSub1

        Object FCP_ProgressBar1 is a FCP_ProgressBar
            Set Size to 13 249
            Set Location to 202 158

            //AB-StoreStart
                                                                                                    
            Set piBarColor1 to clAqua
            Set pbPercent   to False
            Set pbSmooth    to true
            Set pbVertical  to False
            
            
            
            //AB-StoreEnd

        End_Object    // FCP_ProgressBar1

        Object RadioGroupSub2 is a RadioGroupSub
            Set Size to 149 151
            Set Location to 66 3
            Set Color to 10859729
            Object Radio1 is a RadioSub
                Set Label to "ë´¶†ÆúÂò Ñ£ß¶®Âò™"
                Set Size to 10 79
                Set Location to 10 5
                Set Color to 10859729
            End_Object    // Radio1

            Object Radio2 is a RadioSub
                Set Label to "É†òÆ®¶§†°Ê ÜèÄä/Üèëé"
                Set Size to 10 103
                Set Location to 25 5
                Set Color to 10859729
            End_Object    // Radio2

            Object Radio3 is a RadioSub
                Set Label to "Ä§·¢¨©û Ä§. ä¶öò®/£¶Á. && ë¨§. é≠ú†¢."
                Set Size to 10 143
                Set Location to 40 5
                Set Color to 10859729
            End_Object    // Radio3

            Object ButtonSub1 is a ButtonSub
                Set Label to "ButtonSub1"
                Set Bitmap to "print_m.bmp"
                Set Size to 18 23
                Set Location to 127 124
                Set Form_TypeFace Item 0 to "MS Sans Serif"

                //AB-StoreStart
                                                                                                                                                
                Set TooltipValue to "íú¢ú¨´òÂò òß¶´ú¢‚©£ò´ò Æ‡®Â™ §‚ò úßú•ú®öò©Âò"
                
                Procedure OnClick
                    Send RunemporReport  to (ReportEmporias(current_object))
                End_Procedure // OnClick
                
                
                
                //AB-StoreEnd

            End_Object    // ButtonSub1


            //AB-StoreStart
                                                                                                    
            Procedure Notify_Select_State integer iToItem integer iFromItem
                Set piWhat to (iToItem+1)
            End_Procedure
            
            // If you set Current_radio you must set this after the
            // radio objects have been created AND after Notify_select_State has been
            // created. i.e. Set in bottom-code at end!!
            //Set Current_Radio to 0
            
            
            
            //AB-StoreEnd

        End_Object    // RadioGroupSub2

        Object btnMess is a ButtonSub
            Set Size to 13 249
            Set Location to 188 158
            Set Border_Style to Border_Normal
            Set Focus_Mode to NonFocusable
            Set Form_TypeFace Item 0 to "MS Sans Serif"

            //AB-StoreStart
            Procedure OnClick
            
            End_Procedure // OnClick
            //AB-StoreEnd

        End_Object    // btnMess


        //AB-StoreStart
                        
        Procedure Activate_View Returns Integer
            Integer rVal iYear iMonth
            Date    dHmnia
            String  sModule
            Sysdate dHmnia
            Forward Get Msg_Activate_View   to rVal
            Get psMenuModule  Of Main_Menu  to sModule
            Set psModule                    to sModule
            Move (TheMonthSegment(dHmnia))  to iMonth
            Move (TheYearSegment (dHmnia))  to iYear
            Set Value Of (frmYear (GroupSub3(Self)))   Item 0 to iYear
            Set Value Of (frmMonth(GroupSub3(Self)))   Item 0 to iMonth
            Procedure_Return rVal
        End_Procedure
        
        Object ReportEmporias is a CrystalReportSubSQL
        
            Property Integer piTiTrexei Public 0
        
            Set Report_View_id      to (Parent(Self))
            Set Output_Destination  to WQL_PRINT_TO_WINDOW
        
            Procedure OnStartPrinting
                Date    dHmniaEos
                String  Selection sHmgio sbranch
                String  sClientName sPrespName sSlsName
                String  sClientID sPrespID sSlsID
                Integer iMhden iYearTo iMonthTo
        
                Get fiYear  Of GroupSub3  to iYearTo
                Get fiMonth Of GroupSub3  to iMonthTo
                Move (DateCompose(TheDaySegment(EndOfMonth  (iMonthTo  ,iYearTo  )),iMonthTo  ,iYearTo  )) to dHmniaEos
        
                Get psClientID          to sClientID
                Get psClientName        to sClientName
                Get psSlsID             to sSlsID
                Get psSlsName           to sSlsName
                Get psPrespID           to sPrespID
                Get psPrespName         to sPrespName
        
                Get Checked_State Of (chkMhden(GroupSub3(StoixEmp2(Self)))) Item 0 to iMhden
        
                If (sSlsID<>'') Begin
                    Set Formula 'fPolhths'      to (Winql_String(Trim(sSlsID)))
                    Move (Replaces('"',sSlsName,'')) to sSlsName
                    Move (Replaces("'",sSlsName,'')) to sSlsName
                    Set Formula 'fPolhthsDescr' to (Winql_String(Trim(sSlsName)))
                End
                If (sPrespID<>'') Begin
                    Set Formula 'fYpeyth'      to (Winql_String(Trim(sPrespID)))
                    Move (Replaces('"',sPrespName,'')) to sPrespName
                    Move (Replaces("'",sPrespName,'')) to sPrespName
                    Set Formula 'fYpeythDescr' to (Winql_String(Trim(sPrespName)))
                End
                Get psbranch to sbranch
        
                Set Formula 'HmniaEos' to (WinQl_Date(dHmniaEos))
                Set Formula 'Mhdenikous'  to (Winql_Integer(iMhden))
        
            End_procedure // OnStartPrinting
        
            Procedure RunemporReport
                Send Cursor_Wait To (Cursor_Control(Current_Object))
                     if (piwhat(self)=1) Set Report_Name         to "Rptmp1n.rpt"
                else if (piwhat(self)=2) Set Report_Name         to "Rptmp2.rpt"
                else if (piwhat(self)=3) Set Report_Name         to "Hpalpeln.rpt"
                Set piTiTrexei to (piWhat(Self))
                Send Run_report
                Send Cursor_Ready To (Cursor_Control(Current_Object))
            End_procedure // Runempor
        End_Object
        
        Object ReportMakeMeresRecords is a CrystalReportSubSQL
            Set Report_Name     to "RptmHP.rpt"
            Set Report_View_id  to (Parent(Self))
        //        Set Output_Destination          to WQL_PRINT_TO_WINDOW
            Set Output_Destination          to WQL_PRINT_TO_FILE
            Set ExportFileName              to "c:\RptmHP.txt"
            Set UseReportNumberFormat_State to True
            Set ExportFormatType            to WQL_CommaSeparatedType
            Set FieldDelimiter              to ","
            Set StringDelimiter             to '"'
            Set UseReportDateFormat_State   To True
        End_Object
        
        Object ReportMakeAnoixtosRecords is a CrystalReportSubSQL
            Set Report_Name     to "Rptmp8.rpt"
            Set Report_View_id  to (Parent(Self))
        //        Set Output_Destination          to WQL_PRINT_TO_WINDOW
            Set Output_Destination          to WQL_PRINT_TO_FILE
            Set ExportFileName              to "c:\Anoixtos.txt"
            Set UseReportNumberFormat_State to True
            Set ExportFormatType            to WQL_CommaSeparatedType
            Set FieldDelimiter              to ","
            Set StringDelimiter             to '"'
            Set UseReportDateFormat_State   To True
        
            Procedure OnStartPrinting
        
                local string  lscatypes Startnumbern Startnamen Endnamen
                Local Date    Starthmen Endhmen
                Local string  sstr  Selection FileName slabel shmgio sPolhths sYpeyth
                local integer FileType Destination SortOrder starttypkinn iMhden iYearTo iMonthTo iWhat
                Local Integer NumSortFields CurSortField SortDirection wdate fepil iMhnas iEtos iPoios
                date apo eos ddate dHmniaEos
                string flysh1 flysh2 sbranch sPolhthsDescr sYpeythDescr
        
                Get fiYear  Of GroupSub3  to iYearTo
                Get fiMonth Of GroupSub3  to iMonthTo
                Move (DateCompose(TheDaySegment(EndOfMonth  (iMonthTo  ,iYearTo  )),iMonthTo  ,iYearTo  )) to dHmniaEos
        
                Get fsPolhths           to sPolhths
                Get fsYpeyth            to sYpeyth
                Move (Trim(sYpeyth))    to sYpeyth
                Move (Trim(sPolhths))   to sPolhths
        
                Get Value Of (frmPolhthsDescr(GroupSub3(StoixEmp2(Self)))) Item 0 to sPolhthsDescr
                Get Value Of (frmYpeythDescr (GroupSub3(StoixEmp2(Self)))) Item 0 to sYpeythDescr
                Get Checked_State Of (chkMhden(GroupSub3(StoixEmp2(Self)))) Item 0 to iMhden
        
                get psbranch to sbranch
        
                Move "" To Selection
                Append Selection (If(Selection <> "", " and ", ""))"{cmoves.company_code} = " '"' (Trim(syscurxr.company_code)) '"'
                if (sbranch<>'') Append Selection (If(Selection <> "", " and ", ""))"{cmoves.branch_code} = " '"' (Trim(sbranch)) '"'
        
                Append Selection (If(Selection <> "", " and ", "")) "{cmoves.cmoves_axia} <> " '' (0) ''
        
                Get StartNumber To StartNumbern
        
                If (Trim(StartNumbern)) ne "" ;
                  Append Selection (If(Selection <> "", " and ", "")) "{cmoves.client_id} = " '"' (Trim(startnumbern)) '"'
        
                Append Selection (If(Selection <> "", " and ", "")) "{cmoves.cmoves_hmnia} <= " (winql_date(dHmniaEos))
        
                // Gia to etos 2003 theloume kai tis kinhseis apografhs eno gia
                // ta ypoloipa eth DEN ta theloume
        
                Get piPoios Of StoixEmp2  to iPoios
                     If (iPoios=0) Append Selection (If(Selection <> "", " and ", "")) "{cmoves.client_id} <> ''"
                Else If (iPoios=1) Append Selection (If(Selection <> "", " and ", "")) "{cmoves.sls_id} <> ''"
                Else If (iPoios=2) Append Selection (If(Selection <> "", " and ", "")) "{cmoves.presp_id} <> ''"
        
                if (sPolhths<>'') Append Selection (If(Selection <> "", " and ", ""))"{cmoves.SLS_ID} = "   (Winql_String(sPolhths))  //'"' (Trim(sPolhths)) '"'
                if (sYpeyth <>'') Append Selection (If(Selection <> "", " and ", ""))"{cmoves.PRESP_ID} = " (Winql_String(sYpeyth))  //'"' (Trim(sYpeyth)) '"'
        
                get  psModule to flysh1
                move "04" to flysh2
                Move '' to sStr
                Move (Append(sStr,(flysh1+flysh2))) to sStr
                Move (Trim(sStr)) to sStr
                Append Selection (If(Selection <> "", " and ", "")) "InStr('" sStr "',{cmoves.module_from})<>0"
                Append Selection (If(Selection <> "", " and ", "")) ;
                      "If (Year({CMOVES.CMOVES_HMNIA})<>2003) Then If ({CMOVES.CTYPKIN_CODE}<> '101' And {CMOVES.CTYPKIN_CODE}<> '102' And {CMOVES.CTYPKIN_CODE}<> '201' And {CMOVES.CTYPKIN_CODE}<> '202') Then True Else False Else True"
        
                get  epil to fepil
                //Set Formula 'fForeas'   to (Winql_String(iPoios+1))
                Set Formula 'MhnasEos'  to (Winql_Number(iMonthTo))
                Set Formula 'EtosEos'   to (Winql_Number(iYearTo))
                Set Formula 'HmniaEos'  to (winql_date(dHmniaEos))
                Set SelectionFormula To Selection
        
                     If ((iPoios=2) And (sYpeyth =''))  Set Formula 'fforeas'  to (Winql_Number(1))
                Else If ((iPoios=1) And (sPolhths=''))  Set Formula 'fforeas'  to (Winql_Number(2))
                Else                                    Set Formula 'fforeas'  to (Winql_Number(0))
            End_procedure // OnStartPrinting
        
        End_Object
        
        
        Object ReportMakeHpalRecords is a CrystalReportSubSQL
            Set Report_Name     to "Hpal0_For_New.rpt"
            Set Report_View_id  to (Parent(Self))
        //        Set Output_Destination          to WQL_PRINT_TO_WINDOW
            Set Output_Destination          to WQL_PRINT_TO_FILE
            Set ExportFileName              to "c:\hpal.txt"
            Set UseReportNumberFormat_State to True
            Set ExportFormatType            to WQL_CommaSeparatedType
            Set FieldDelimiter              to ","
            Set StringDelimiter             to '"'
            Set UseReportDateFormat_State   To True
        
            Procedure OnStartPrinting
        
                local string  lscatypes Startnumbern Startnamen Endnamen
                Local Date    Starthmen Endhmen
                Local string  sstr  Selection FileName slabel shmgio sPolhths sYpeyth
                local integer FileType Destination SortOrder starttypkinn iMhden iYearTo iMonthTo iWhat
                Local Integer NumSortFields CurSortField SortDirection wdate fepil iMhnas iEtos iPoios
                date apo eos ddate dHmniaEos
                string flysh1 flysh2 sbranch sPolhthsDescr sYpeythDescr
        
                Get fiYear  Of GroupSub3  to iYearTo
                Get fiMonth Of GroupSub3  to iMonthTo
                Move (DateCompose(TheDaySegment(EndOfMonth  (iMonthTo  ,iYearTo  )),iMonthTo  ,iYearTo  )) to dHmniaEos
        
                Get fsPolhths           to sPolhths
                Get fsYpeyth            to sYpeyth
                Move (Trim(sYpeyth))    to sYpeyth
                Move (Trim(sPolhths))   to sPolhths
        
                Get Value Of (frmPolhthsDescr(GroupSub3(StoixEmp2(Self)))) Item 0 to sPolhthsDescr
                Get Value Of (frmYpeythDescr (GroupSub3(StoixEmp2(Self)))) Item 0 to sYpeythDescr
                Get Checked_State Of (chkMhden(GroupSub3(StoixEmp2(Self)))) Item 0 to iMhden
        
                get psbranch to sbranch
        
                Move "" To Selection
                Append Selection (If(Selection <> "", " and ", ""))"{cmoves.company_code} = " '"' (Trim(syscurxr.company_code)) '"'
                if (sbranch<>'') Append Selection (If(Selection <> "", " and ", ""))"{cmoves.branch_code} = " '"' (Trim(sbranch)) '"'
        
                Append Selection (If(Selection <> "", " and ", "")) "{cmoves.cmoves_axia} <> " '' (0) ''
        
                Get StartNumber To StartNumbern
        
                If (Trim(StartNumbern)) ne "" ;
                  Append Selection (If(Selection <> "", " and ", "")) "{cmoves.client_id} = " '"' (Trim(startnumbern)) '"'
        
                Append Selection (If(Selection <> "", " and ", "")) "{cmoves.cmoves_hmnia} <= " (winql_date(dHmniaEos))
        
                // Gia to etos 2003 theloume kai tis kinhseis apografhs eno gia
                // ta ypoloipa eth DEN ta theloume
        
                Get piPoios Of StoixEmp2  to iPoios
                     If (iPoios=0) Append Selection (If(Selection <> "", " and ", "")) "{cmoves.client_id} <> ''"
                Else If (iPoios=1) Append Selection (If(Selection <> "", " and ", "")) "{cmoves.sls_id} <> ''"
                Else If (iPoios=2) Append Selection (If(Selection <> "", " and ", "")) "{cmoves.presp_id} <> ''"
        
                if (sPolhths<>'') Append Selection (If(Selection <> "", " and ", ""))"{cmoves.SLS_ID} = "   (Winql_String(sPolhths))  //'"' (Trim(sPolhths)) '"'
                if (sYpeyth <>'') Append Selection (If(Selection <> "", " and ", ""))"{cmoves.PRESP_ID} = " (Winql_String(sYpeyth))  //'"' (Trim(sYpeyth)) '"'
        
                get  psModule to flysh1
                move "04" to flysh2
                Move '' to sStr
                Move (Append(sStr,(flysh1+flysh2))) to sStr
                Move (Trim(sStr)) to sStr
                Append Selection (If(Selection <> "", " and ", "")) "InStr('" sStr "',{cmoves.module_from})<>0"
                Append Selection (If(Selection <> "", " and ", "")) ;
                      "If (Year({CMOVES.CMOVES_HMNIA})<>2003) Then If ({CMOVES.CTYPKIN_CODE}<> '101' And {CMOVES.CTYPKIN_CODE}<> '102' And {CMOVES.CTYPKIN_CODE}<> '201' And {CMOVES.CTYPKIN_CODE}<> '202') Then True Else False Else True"
        
                get  epil to fepil
                //Set Formula 'fForeas'   to (Winql_String(iPoios+1))
                Set Formula 'MhnasEos'  to (Winql_Number(iMonthTo))
                Set Formula 'EtosEos'   to (Winql_Number(iYearTo))
                Set Formula 'HmniaEos'  to (winql_date(dHmniaEos))
                Set SelectionFormula To Selection
        
                     If ((iPoios=2) And (sYpeyth =''))  Set Formula 'fforeas'  to (Winql_Number(1))
                Else If ((iPoios=1) And (sPolhths=''))  Set Formula 'fforeas'  to (Winql_Number(2))
                Else                                    Set Formula 'fforeas'  to (Winql_Number(0))
            End_procedure // OnStartPrinting
        
        End_Object
        
        
        Object ReportMakeTzirosRecords is a CrystalReport
            Set Report_Name     to "rptmp3.rpt"
            Set Report_View_id  to (Parent(Self))
        //    Set Output_Destination          to WQL_PRINT_TO_WINDOW
            Set Output_Destination          to WQL_PRINT_TO_FILE
            Set ExportFileName              to "c:\rptmp3.txt"
            Set UseReportNumberFormat_State to True
            Set ExportFormatType            to WQL_CommaSeparatedType
            Set FieldDelimiter              to ","
            Set StringDelimiter             to '"'
            Set UseReportDateFormat_State   To True
        
            Procedure OnStartPrinting
        
                local string  lscatypes Startnumbern Startnamen Endnamen
                Local Date    Starthmen Endhmen
                Local string  sstr  Selection FileName slabel shmgio sPolhths sYpeyth
                local integer FileType Destination SortOrder starttypkinn iMhden iYearTo iMonthTo
                Local Integer NumSortFields CurSortField SortDirection wdate fepil iMhnas iEtos iPoios
                date apo eos ddate dHmniaEos dHmniaApo
                string flysh1 flysh2 sbranch sPolhthsDescr sYpeythDescr
        
                Get fiYear  Of GroupSub3  to iYearTo
                Get fiMonth Of GroupSub3  to iMonthTo
        
                Move (DateCompose(TheDaySegment(EndOfMonth(iMonthTo,(iYearTo))),iMonthTo,(iYearTo)))        to dHmniaEos
                Move (DateCompose(TheDaySegment(BeginOfMonth(iMonthTo,(iYearTo-1))),iMonthTo,(iYearTo-1)))  to dHmniaApo
        
                Get fsPolhths           to sPolhths
                Get fsYpeyth            to sYpeyth
                Move (Trim(sYpeyth))    to sYpeyth
                Move (Trim(sPolhths))   to sPolhths
        
                Get Value Of (frmPolhthsDescr(GroupSub3(StoixEmp2(Self)))) Item 0 to sPolhthsDescr
                Get Value Of (frmYpeythDescr (GroupSub3(StoixEmp2(Self)))) Item 0 to sYpeythDescr
                Get Checked_State Of (chkMhden(GroupSub3(StoixEmp2(Self)))) Item 0 to iMhden
        
                get psbranch to sbranch
                Move "" To Selection
                Append Selection (If(Selection <> "", " and ", ""))"{wcmoves.company_code} = " '"' (Trim(syscurxr.company_code)) '"'
        //        if (sbranch<>'') Append Selection (If(Selection <> "", " and ", ""))"{wcmoves.branch_code} = " '"' (Trim(sbranch)) '"'
        
                Get piPoios Of StoixEmp2  to iPoios
                     If (iPoios=0) Append Selection (If(Selection <> "", " and ", "")) "{wcmoves.client_id} <> ''"
                Else If (iPoios=1) Append Selection (If(Selection <> "", " and ", "")) "{wcmoves.sls_id} <> ''"
                Else If (iPoios=2) Append Selection (If(Selection <> "", " and ", "")) "{wcmoves.presp_id} <> ''"
        
                Get StartNumber To StartNumbern
        
                If (Trim(StartNumbern)) ne "" ;
                  Append Selection (If(Selection <> "", " and ", "")) "{wcmoves.client_id} = " '"' (Trim(startnumbern)) '"'
        
        
                Append Selection (If(Selection <> "", " and ", "")) "{wcmoves.wcmove_hmnia} >= " (winql_date(dHmniaApo))
                Append Selection (If(Selection <> "", " and ", "")) "{wcmoves.wcmove_hmnia} <= " (winql_date(dHmniaEos))
        
                if (sPolhths<>'') Append Selection (If(Selection <> "", " and ", ""))"{wcmoves.SLS_ID} = " '"' (Trim(sPolhths)) '"'
                if (sYpeyth <>'') Append Selection (If(Selection <> "", " and ", ""))"{wcmoves.PRESP_ID} = " '"' (Trim(sYpeyth)) '"'
        
                get  psModule to flysh1
                Append Selection (If(Selection <> "", " and ", ""))"{wcmoves.Module_From} = " '"' (Trim(flysh1)) '"'
        
        
                Set Formula 'fMhnas'  to (Winql_Number(iMonthTo))
                Set Formula 'fEtos'   to (Winql_Number(iYearTo))
        
                     If ((iPoios=2) And (sYpeyth =''))  Set Formula 'fforeas'  to (Winql_Number(1))
                Else If ((iPoios=1) And (sPolhths=''))  Set Formula 'fforeas'  to (Winql_Number(2))
                Else                                    Set Formula 'fforeas'  to (Winql_Number(0))
                Set SelectionFormula To Selection
        
            End_procedure // OnStartPrinting
        
        End_Object
        
        Object ReportMakeAxioRecords is a CrystalReport
            Set Report_View_id  to (Parent(Self))
        //    Set Output_Destination          to WQL_PRINT_TO_WINDOW
            Set Output_Destination          to WQL_PRINT_TO_FILE
            Set UseReportNumberFormat_State to True
            Set ExportFormatType            to WQL_CommaSeparatedType
            Set FieldDelimiter              to ","
            Set StringDelimiter             to '"'
            Set UseReportDateFormat_State   To True
        
            Procedure OnStartPrinting
        
                local string  lscatypes Startnumbern Startnamen Endnamen stext
                Local Date    Starthmen Endhmen
                Local string  sstr  Selection FileName slabel shmgio sPolhths sYpeyth sone
                local integer FileType Destination SortOrder starttypkinn iMhden iYearTo iMonthTo
                Local Integer NumSortFields CurSortField SortDirection wdate fepil iMhnas iEtos iPoios
                date apo eos ddate dHmniaEos dHmniaApo
                string flysh1 flysh2 sbranch sPolhthsDescr sYpeythDescr
                local integer iepidika
        
                get piepidika to iepidika
                move  1 to sone
                Get piPoios Of StoixEmp2  to iPoios
        
                Get fiYear  Of GroupSub3  to iYearTo
                Get fiMonth Of GroupSub3  to iMonthTo
        
                Move (DateCompose(TheDaySegment(beginOfMonth(iMonthTo,(iYearTo))),iMonthTo,(iYearTo)))        to ddate
                Move (DateCompose(TheDaySegment(endOfMonth(iMonthTo,(iYearTo))),iMonthTo,(iYearTo)))          to dhmniaeos
                Move (DateCompose(TheDaySegment(BeginOfMonth(iMonthTo,(iYearTo-1))),iMonthTo,(iYearTo-1)))    to dHmniaApo
        
                Get fsPolhths           to sPolhths
                Get fsYpeyth            to sYpeyth
                Move (Trim(sYpeyth))    to sYpeyth
                Move (Trim(sPolhths))   to sPolhths
        
                Get Value Of (frmPolhthsDescr(GroupSub3(StoixEmp2(Self)))) Item 0 to sPolhthsDescr
                Get Value Of (frmYpeythDescr (GroupSub3(StoixEmp2(Self)))) Item 0 to sYpeythDescr
                Get Checked_State Of (chkMhden(GroupSub3(StoixEmp2(Self)))) Item 0 to iMhden
        
                Move "" To Selection
                Append Selection (If(Selection <> "", " and ", ""))"{baxio.company_code} = " '"' (Trim(syscurxr.company_code)) '"'
                if (sbranch<>'') Append Selection (If(Selection <> "", " and ", ""))"{baxio.branch_code} = " '"' (Trim(sbranch)) '"'
                Append Selection (If(Selection <> "", " and ", ""))"{btypkin.btypkin_anti_xp} = 2"
        
        
                // 12/02/2004 KOBONTAI OI DESMEYMENES EPITAGES
                // kapoies palies epitages tou 01.A5.23111 me lanthasmena flags
                // vgazoun anoixto kai synolikh apo thn prosthiki 13469... apo
                // diamartyrimenes epitages.
                // Aytes tis gyrname se status 5 kai tis kovoume
                Append Selection (If(Selection <> "", " and ", ""))"{baxio.BAXIO_STATUS} <> 5 "
                //
        
                if (iepidika=0) begin
                    Append Selection (If(Selection <> "", " and ", ""))"{btypkin.btypkin_sign} = 1"
                    Append Selection (If(Selection <> "", " and ", ""))"{baxio.BAXIO_PLACE} <> 2 "
                    Append Selection (If(Selection <> "", " and ", "")) "{baxio.baxio_hmnial} >= " (winql_date(ddate))
                end
                else begin
                    Append Selection (If(Selection <> "", " and ", ""))"{baxio.BAXIO_status} = 3 "
                    Append Selection (If(Selection <> "", " and ", "")) "{baxio.baxio_hmnial} >= " (winql_date(dhmniaapo))
                    Append Selection (If(Selection <> "", " and ", "")) "{baxio.baxio_hmnial} <= " (winql_date(dhmniaeos))
                end
        
                Append Selection (If(Selection <> "", " and ", "")) "{barticl.barticl_hmnia} <= " (winql_date(dhmniaeos))
        
                Append Selection (If(Selection <> "", " and ", ""))"{barticl.barticl_ekleise} = " '"' (Trim(sone)) '"'
                move '#1#2#10#' to stext
                Append Selection (If(Selection <> "", " and ", "")) "InStr('" stext "',('#'+TOTEXT ({baxio.baxiokat_code},0)+'#'))<>0"
        
        
                     If (iPoios=0) Append Selection (If(Selection <> "", " and ", "")) "{baxio.baxio_code_in} <> ''"
                Else If (iPoios=1) Append Selection (If(Selection <> "", " and ", "")) "{bmove.sls_id} <> ''"
                Else If (iPoios=2) Append Selection (If(Selection <> "", " and ", "")) "{bmove.presp_id} <> ''"
        
                Get StartNumber To StartNumbern
        
                If (Trim(StartNumbern)) ne "" ;
                    Append Selection (If(Selection <> "", " and ", "")) "{baxio.baxio_code_in} = " '"' (Trim(startnumbern)) '"'
        
        
                if (sPolhths<>'') Append Selection (If(Selection <> "", " and ", ""))"{bmove.SLS_ID} = " '"' (Trim(sPolhths)) '"'
                if (sYpeyth <>'') Append Selection (If(Selection <> "", " and ", ""))"{bmove.PRESP_ID} = " '"' (Trim(sYpeyth)) '"'
        
        
                Set Formula 'fMhnas'  to (Winql_Number(iMonthTo))
                Set Formula 'fEtos'   to (Winql_Number(iYearTo))
        
                     If ((iPoios=2) And (sYpeyth =''))  Set Formula 'fforeas'  to (Winql_Number(1))
                Else If ((iPoios=1) And (sPolhths=''))  Set Formula 'fforeas'  to (Winql_Number(2))
                Else                                    Set Formula 'fforeas'  to (Winql_Number(0))
        
                Set SelectionFormula To Selection
        
            End_procedure // OnStartPrinting
        
        End_Object
        
        
        Object ReportMakeEisprakteaAxiografa is a CrystalReport
            Property Integer piTrexonMhnas  Public 0
            Property Integer piTrexonEtos   Public 0
            Set Report_View_id  to (Parent(Self))
        //    Set Output_Destination          to WQL_PRINT_TO_WINDOW
            Set Output_Destination          to WQL_PRINT_TO_FILE
            Set UseReportNumberFormat_State to True
            Set ExportFormatType            to WQL_CommaSeparatedType
            Set FieldDelimiter              to ","
            Set StringDelimiter             to '"'
            Set UseReportDateFormat_State   To True
        
            Procedure OnStartPrinting
        
                local string  lscatypes Startnumbern Startnamen Endnamen stext
                Local Date    Starthmen Endhmen
                Local string  sstr  Selection FileName slabel shmgio sPolhths sYpeyth sone
                local integer FileType Destination SortOrder starttypkinn iMhden iYearTo iMonthTo
                Local Integer NumSortFields CurSortField SortDirection wdate fepil iMhnas iEtos iPoios
                date apo eos ddate dHmniaEos dHmniaApo
                string flysh1 flysh2 sbranch sPolhthsDescr sYpeythDescr
                local integer iepidika
        
                move  1 to sone
                Get piPoios Of StoixEmp2  to iPoios
        
                Get piTrexonEtos  to iYearTo
                Get piTrexonMhnas to iMonthTo
        
                Move (DateCompose(TheDaySegment(BeginOfMonth(iMonthTo,(iYearTo  ))),iMonthTo,(iYearTo)))    to ddate
                Move (DateCompose(TheDaySegment(EndOfMonth  (iMonthTo,(iYearTo  ))),iMonthTo,(iYearTo)))    to dhmniaeos
                Move (DateCompose(TheDaySegment(BeginOfMonth(iMonthTo,(iYearTo-1))),iMonthTo,(iYearTo-1)))  to dHmniaApo
        
                Get fsPolhths           to sPolhths
                Get fsYpeyth            to sYpeyth
                Move (Trim(sYpeyth))    to sYpeyth
                Move (Trim(sPolhths))   to sPolhths
        
                Get Value Of (frmPolhthsDescr(GroupSub3(StoixEmp2(Self)))) Item 0 to sPolhthsDescr
                Get Value Of (frmYpeythDescr (GroupSub3(StoixEmp2(Self)))) Item 0 to sYpeythDescr
                Get Checked_State Of (chkMhden(GroupSub3(StoixEmp2(Self)))) Item 0 to iMhden
        
                Move "" To Selection
                Append Selection (If(Selection <> "", " and ", ""))"{baxio.company_code} = " '"' (Trim(syscurxr.company_code)) '"'
                if (sbranch<>'') Append Selection (If(Selection <> "", " and ", ""))"{baxio.branch_code} = " '"' (Trim(sbranch)) '"'
                Append Selection (If(Selection <> "", " and ", ""))"{btypkin.btypkin_anti_xp} = 2"
        
        
                // 12/02/2004 KOBONTAI OI DESMEYMENES EPITAGES
                // kapoies palies epitages tou 01.A5.23111 me lanthasmena flags
                // vgazoun anoixto kai synolikh apo thn prosthiki 13469... apo
                // diamartyrimenes epitages.
                // Aytes tis gyrname se status 5 kai tis kovoume
                ///////////Append Selection (If(Selection <> "", " and ", ""))"{baxio.BAXIO_STATUS} <> 5 "
        
                // 04/03/2003 Nea proseggish
                // Gia na mhn kanoun exoflhseis axiografon prohgoumenhs xrhshs
                // giati ayta ta axiografa logo tis metaforas tous exoun ftiaxei
                // neo soma kata thn allagh ths xrhshs kai etsi emfanixontai 2 FORES
                // ta kovoume me th paradoxh oti an ena axiografo exei
                // to year ths hmnias lhxhs > apo to year ths hmnias kataxorhshs
                // tote sigoyra tha exei metaferthei opote to kovoume
        
               // Append Selection (If(Selection <> "", " and ", "")) "(NOT(Year ({BAXIO.BAXIO_HMNIAL})>{BAXIO.YEAR_YEAR}))"
                Append Selection (If(Selection <> "", " and ", ""))"{baxio.BAXIO_PLACE} <> 2 "
                Append Selection (If(Selection <> "", " and ", ""))"{baxio.baxio_hmnial} > "(winql_date(dhmniaeos))
                Append Selection (If(Selection <> "", " and ", ""))"{barticl.barticl_hmnia} <= " (winql_date(dhmniaeos))
                Append Selection (If(Selection <> "", " and ", ""))"{barticl.barticl_ekleise} = " '"' (Trim(sone)) '"'
                move '#1#2#10#' to stext
                Append Selection (If(Selection <> "", " and ", "")) "InStr('" stext "',('#'+TOTEXT ({baxio.baxiokat_code},0)+'#'))<>0"
        
                     If (iPoios=0) Append Selection (If(Selection <> "", " and ", "")) "{baxio.baxio_code_in} <> ''"
                Else If (iPoios=1) Append Selection (If(Selection <> "", " and ", "")) "{bmove.sls_id} <> ''"
                Else If (iPoios=2) Append Selection (If(Selection <> "", " and ", "")) "{bmove.presp_id} <> ''"
        
                Get StartNumber To StartNumbern
        
                If (Trim(StartNumbern)) ne "" ;
                    Append Selection (If(Selection <> "", " and ", "")) "{baxio.baxio_code_in} = " '"' (Trim(startnumbern)) '"'
        
        
                if (sPolhths<>'') Append Selection (If(Selection <> "", " and ", ""))"{bmove.SLS_ID} = " '"' (Trim(sPolhths)) '"'
                if (sYpeyth <>'') Append Selection (If(Selection <> "", " and ", ""))"{bmove.PRESP_ID} = " '"' (Trim(sYpeyth)) '"'
        
        
                Set Formula 'fMhnas'  to (Winql_Number(iMonthTo))
                Set Formula 'fEtos'   to (Winql_Number(iYearTo))
        
                     If ((iPoios=2) And (sYpeyth =''))  Set Formula 'fforeas'  to (Winql_Number(1))
                Else If ((iPoios=1) And (sPolhths=''))  Set Formula 'fforeas'  to (Winql_Number(2))
                Else                                    Set Formula 'fforeas'  to (Winql_Number(0))
        
                Set SelectionFormula To Selection
        
            End_procedure // OnStartPrinting
        
        End_Object
        
        
        //  RPTMP4.TXT
        // 'è®¶ú´¶†£ò©Âò Ä§¶†Æ´¶Á ä¶ö/£¶Á && ë¨§. é≠ú†¢„™'
        // Mazeyei oles tis xreoseis & oles tis pistoseis apo Cmoves
        Object ReportMakeOfeilhRecords is a CrystalReport
            Set Report_Name     to "rptmp4n.rpt"
            Set Report_View_id  to (Parent(Self))
        //    Set Output_Destination          to WQL_PRINT_TO_WINDOW
            Set Output_Destination          to WQL_PRINT_TO_FILE
            Set ExportFileName              to "c:\rptmp4.txt"
            Set UseReportNumberFormat_State to True
            Set ExportFormatType            to WQL_CommaSeparatedType
            Set FieldDelimiter              to ","
            Set StringDelimiter             to '"'
            Set UseReportDateFormat_State   To True
        
            Procedure OnStartPrinting
        
                local string  lscatypes Startnumbern Startnamen Endnamen
                Local Date    Starthmen Endhmen
                Local string  sstr  Selection FileName slabel shmgio sPolhths sYpeyth
                local integer FileType Destination SortOrder starttypkinn iMhden iYearTo iMonthTo iWhat
                Local Integer NumSortFields CurSortField SortDirection wdate fepil iMhnas iEtos iPoios
                date apo eos ddate dHmniaEos
                string flysh1 flysh2 sbranch sPolhthsDescr sYpeythDescr
        
                Get fiYear  Of GroupSub3  to iYearTo
                Get fiMonth Of GroupSub3  to iMonthTo
                Move (DateCompose(TheDaySegment(EndOfMonth  (iMonthTo  ,iYearTo  )),iMonthTo  ,iYearTo  )) to dHmniaEos
        
                Get fsPolhths           to sPolhths
                Get fsYpeyth            to sYpeyth
                Move (Trim(sYpeyth))    to sYpeyth
                Move (Trim(sPolhths))   to sPolhths
        
                Get Value Of (frmPolhthsDescr(GroupSub3(StoixEmp2(Self)))) Item 0 to sPolhthsDescr
                Get Value Of (frmYpeythDescr (GroupSub3(StoixEmp2(Self)))) Item 0 to sYpeythDescr
                Get Checked_State Of (chkMhden(GroupSub3(StoixEmp2(Self)))) Item 0 to iMhden
        
                get psbranch to sbranch
                Move "" To Selection
                Append Selection (If(Selection <> "", " and ", ""))"{cmoves.company_code} = " '"' (Trim(syscurxr.company_code)) '"'
                if (sbranch<>'') Append Selection (If(Selection <> "", " and ", ""))"{cmoves.branch_code} = " '"' (Trim(sbranch)) '"'
        
                Append Selection (If(Selection <> "", " and ", "")) "{cmoves.cmoves_axia} <> " '' (0) ''
        
                Get StartNumber To StartNumbern
        
                If (Trim(StartNumbern)) ne "" ;
                  Append Selection (If(Selection <> "", " and ", "")) "{cmoves.client_id} = " '"' (Trim(startnumbern)) '"'
        
                Append Selection (If(Selection <> "", " and ", "")) "{cmoves.cmoves_hmnia} <= " (winql_date(dHmniaEos))
        
        
                Get piPoios Of StoixEmp2  to iPoios
                     If (iPoios=0) Append Selection (If(Selection <> "", " and ", "")) "{cmoves.client_id} <> ''"
                Else If (iPoios=1) Append Selection (If(Selection <> "", " and ", "")) "{cmoves.sls_id} <> ''"
                Else If (iPoios=2) Append Selection (If(Selection <> "", " and ", "")) "{cmoves.presp_id} <> ''"
        
        
                if (sPolhths<>'') Append Selection (If(Selection <> "", " and ", ""))"{cmoves.SLS_ID} = " '"' (Trim(sPolhths)) '"'
                if (sYpeyth <>'') Append Selection (If(Selection <> "", " and ", ""))"{cmoves.PRESP_ID} = " '"' (Trim(sYpeyth)) '"'
        
                get  psModule to flysh1
                Append Selection (If(Selection <> "", " and ", ""))"{cmoves.Module_From} = " '"' (Trim(flysh1)) '"'
        
                Append Selection (If(Selection <> "", " and ", "")) ;
                      "If (Year({CMOVES.CMOVES_HMNIA})<>2003) Then If ({CMOVES.CTYPKIN_CODE}<> '101' And {CMOVES.CTYPKIN_CODE}<> '102' And {CMOVES.CTYPKIN_CODE}<> '201' And {CMOVES.CTYPKIN_CODE}<> '202') Then True Else False Else True"
        
        
        
                Set Formula 'fMhnas'  to (Winql_Number(iMonthTo))
                Set Formula 'fEtos'   to (Winql_Number(iYearTo))
                ///Set Formula 'fForeas' to (Winql_String(iPoios+1))
        
                     If ((iPoios=2) And (sYpeyth =''))  Set Formula 'fforeas'  to (Winql_Number(1))
                Else If ((iPoios=1) And (sPolhths=''))  Set Formula 'fforeas'  to (Winql_Number(2))
                Else                                    Set Formula 'fforeas'  to (Winql_Number(0))
                Set SelectionFormula To Selection
        
            End_procedure // OnStartPrinting
        
        End_Object
        
        
        Object ReportMakepaliaAxioRecords is a CrystalReport
            Set Report_View_id  to (Parent(Self))
        //    Set Output_Destination          to WQL_PRINT_TO_WINDOW
            Set Output_Destination          to WQL_PRINT_TO_FILE
            Set UseReportNumberFormat_State to True
            Set ExportFormatType            to WQL_CommaSeparatedType
            Set FieldDelimiter              to ","
            Set StringDelimiter             to '"'
            Set UseReportDateFormat_State   To True
        
            Procedure OnStartPrinting
        
                local string  lscatypes Startnumbern Startnamen Endnamen stext
                Local Date    Starthmen Endhmen
                Local string  sstr  Selection FileName slabel shmgio sPolhths sYpeyth sone
                local integer FileType Destination SortOrder starttypkinn iMhden iYearTo iMonthTo
                Local Integer NumSortFields CurSortField SortDirection wdate fepil iMhnas iEtos iPoios
                date apo eos ddate dHmniaEos dHmniaApo
                string flysh1 flysh2 sbranch sPolhthsDescr sYpeythDescr
                local integer iepidika
        
                get piepidika to iepidika
                move  1 to sone
                Get piPoios Of StoixEmp2  to iPoios
        
                Get fiYear  Of GroupSub3  to iYearTo
                Get fiMonth Of GroupSub3  to iMonthTo
        
                Move (DateCompose(TheDaySegment(beginOfMonth(iMonthTo,(iYearTo))),iMonthTo,(iYearTo)))        to ddate
                Move (DateCompose(TheDaySegment(endOfMonth(iMonthTo,(iYearTo))),iMonthTo,(iYearTo)))          to dhmniaeos
                Move (DateCompose(TheDaySegment(BeginOfMonth(iMonthTo,(iYearTo-1))),iMonthTo,(iYearTo-1)))    to dHmniaApo
        
                Get fsPolhths           to sPolhths
                Get fsYpeyth            to sYpeyth
                Move (Trim(sYpeyth))    to sYpeyth
                Move (Trim(sPolhths))   to sPolhths
        
                Get Value Of (frmPolhthsDescr(GroupSub3(StoixEmp2(Self)))) Item 0 to sPolhthsDescr
                Get Value Of (frmYpeythDescr (GroupSub3(StoixEmp2(Self)))) Item 0 to sYpeythDescr
                Get Checked_State Of (chkMhden(GroupSub3(StoixEmp2(Self)))) Item 0 to iMhden
        
                Move "" To Selection
                Append Selection (If(Selection <> "", " and ", ""))"{baxio.company_code} = " '"' (Trim(syscurxr.company_code)) '"'
                if (sbranch<>'') Append Selection (If(Selection <> "", " and ", ""))"{baxio.branch_code} = " '"' (Trim(sbranch)) '"'
                Append Selection (If(Selection <> "", " and ", ""))"{btypkin.btypkin_anti_xp} = 2"
                Append Selection (If(Selection <> "", " and ", ""))"{btypkin.btypkin_sign} = 1"
        
                Append Selection (If(Selection <> "", " and ", ""))"{baxio.BAXIO_PLACE} <> 2 "
        
                Append Selection (If(Selection <> "", " and ", "")) "{baxio.baxio_hmnial} <= " (winql_date(dhmniaeos))
                Append Selection (If(Selection <> "", " and ", "")) "{barticl.barticl_hmnia} <= " (winql_date(dhmniaeos))
        
                Append Selection (If(Selection <> "", " and ", ""))"{barticl.barticl_ekleise} = " '"' (Trim(sone)) '"'
                move '#1#2#10#' to stext
                Append Selection (If(Selection <> "", " and ", "")) "InStr('" stext "',('#'+TOTEXT ({baxio.baxiokat_code},0)+'#'))<>0"
        
        
                     If (iPoios=0) Append Selection (If(Selection <> "", " and ", "")) "{baxio.baxio_code_in} <> ''"
                Else If (iPoios=1) Append Selection (If(Selection <> "", " and ", "")) "{bmove.sls_id} <> ''"
                Else If (iPoios=2) Append Selection (If(Selection <> "", " and ", "")) "{bmove.presp_id} <> ''"
        
                Get StartNumber To StartNumbern
        
                If (Trim(StartNumbern)) ne "" ;
                    Append Selection (If(Selection <> "", " and ", "")) "{baxio.baxio_code_in} = " '"' (Trim(startnumbern)) '"'
        
        
                if (sPolhths<>'') Append Selection (If(Selection <> "", " and ", ""))"{bmove.SLS_ID} = " '"' (Trim(sPolhths)) '"'
                if (sYpeyth <>'') Append Selection (If(Selection <> "", " and ", ""))"{bmove.PRESP_ID} = " '"' (Trim(sYpeyth)) '"'
        
        
                Set Formula 'fMhnas'  to (Winql_Number(iMonthTo))
                Set Formula 'fEtos'   to (Winql_Number(iYearTo))
                Set Formula 'fForeas' to (Winql_String(iPoios+1))
                Set SelectionFormula To Selection
        
            End_procedure // OnStartPrinting
        
        End_Object
        
        
        Function Startname Returns String
            Function_return (Startname(groupSub3(Current_object)))
        End_function // StartCustomer
        
        Function Starthme Returns integer
            Function_return (Starthme(groupSub3(Current_object)))
        End_function // StartNumber
        
        Function fsPolhths Returns string
            Function_return (fsPolhths(groupSub3(Current_object)))
        End_function
        
        Function fsYpeyth Returns string
            Function_return (fsYpeyth(groupSub3(Current_object)))
        End_function
        
        Function Endname Returns String
            Function_return (Endname(groupSub3(Current_object)))
        End_function // StartCustomer
        
        Function StartNumber Returns string
            Function_return (StartNumber(groupSub1(Current_object)))
        End_function // StartNumber
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        //AB-StoreEnd

    CD_End_Object    // StoixEmp2


    //AB-StoreStart
            
    //AB-StoreEnd

