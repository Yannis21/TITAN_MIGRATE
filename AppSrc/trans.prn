Compiling Program: C:\Vdf6\Develop\Empor\AppSrc\trans.src
Memory Available: 2147483647
1>Use AllEntSc
Using pre-compiled package ALLENTSC
INCLUDING FILE: ALLENTSC.PKI
29991>
29991>Register_Object Client_Area
29991>
29991>//AB-StoreTopStart
29991>Use Workspc.pkg
29991>//  Set date attributes as needed
29991>Set_Date_Attribute sysdate4_State to (TRUE)
29992>Set_Date_Attribute Date4_State    to (TRUE)
29993>Set_Date_Attribute epoch_value    to 30
29994>
29994>Object ProgramWorkspace is a WorkspaceSub
29996>    Set WorkspaceName to CURRENT$WORKSPACE
29997>    Set kEnter_Next_State to True
29998>//    Set ModuleName    to 'ProgramName' // Special module name.
29998>//    Set HelpName      to 'HelpName.hlp'// Please provide the name of your Windows help file.
29998>End_Object
29999>
29999>Use Help_Ids.inc // Developer should provide this file of help context links.
INCLUDING FILE: HELP_IDS.INC
29999>>>// Help_ids.inc
29999>>>//
29999>>>// Context ids for the order entry system. This uses
29999>>>// help file ordentry.hlp.
29999>>>//
29999>>>// This is a sample version. YOU must supply
29999>>>// the ID values
29999>>>
29999>>>//  Generic Context Ids
29999>>>//
29999>>>
29999>>>// It is expected that file-names ids will be the same as their
29999>>>// filenumber.
29999>>>
29999>>>
29999>>>//  View and selection-list specific context ids
29999>>>//
29999>>>//..........add view, object, selection-list ids here....
29999>Use Std_Help.pkg
INCLUDING FILE: STD_HELP.PKG
29999>>>// STD_HELP.PKG
29999>>>//
29999>>>// Global Help Object
29999>>>//
29999>>>//  Creates all Help Support required to access WINDOWs help system
29999>>>//  with DataFlex. Creates a global object named Help_Object.
29999>>>//
29999>>>//  9/19/97 JJT - Modified to define stadnard help Ids if they are undefined
29999>>>
29999>>>use DFHlpSys // Context Sensitive Help Support
29999>>>
29999>>>
29999>>>// This file needs to be provided by the developer. It will contain
29999>>>// symbolic replacements for the ID integer values used to access the
29999>>>// the windows help file's topics.
29999>>>//
29999>>>use Help_ids.inc
29999>>>
29999>>>// If the following are not defined in help_ids.inc,
29999>>>//  create default 0 values for them
29999>>>Define GeneralHelpId    for    0
29999>>>Define KeysHelpId       for    0
29999>>>Define FileHelpId       for    0
29999>>>Define ErrorHelpId      for    0  // probably not used in VDF
29999>>>Define IndexHelpId      for    0  // probably not used in VDF
29999>>>
29999>>>object Help_Object is a HelpSystem // global help object
30001>>>
30001>>>   Set Help_Id_General to GeneralHelpId    // these should all be defined
30002>>>   Set Help_Id_Index   to IndexHelpId      // in help_ids.inc.
30003>>>   Set Help_Id_Keys    to KeysHelpId       //
30004>>>   Set Help_Id_Files   to FileHelpId       //
30005>>>   Set Help_Id_Errors  to ErrorHelpId      //
30006>>>
30006>>>end_object
30007>Use WinQlSQL.Sub
INCLUDING FILE: WINQLSQL.SUB
30007>>>Use CrystalReport.pkg
30007>>>
30007>>>
30007>>>
30007>>>Type PEWindowOptions
30007>>>  Field PEWindowOptions.StructSize As Word
30007>>>  Field PEWindowOptions.hasGroupTree As Word
30007>>>  Field PEWindowOptions.canDrillDown As Word
30007>>>  Field PEWindowOptions.hasNavigationControls As Word
30007>>>  Field PEWindowOptions.hasCancelButton As Word
30007>>>  Field PEWindowOptions.hasPrintButton As Word
30007>>>  Field PEWindowOptions.hasExportButton As Word
30007>>>  Field PEWindowOptions.hasZoomControl As Word
30007>>>  Field PEWindowOptions.hasCloseButton As Word
30007>>>  Field PEWindowOptions.hasProgressControls As Word
30007>>>  Field PEWindowOptions.hasSearchButton As Word
30007>>>  Field PEWindowOptions.hasPrintSetupButton As Word
30007>>>  Field PEWindowOptions.hasRefreshButton As Word
30007>>>End_Type // PEWindowOptions
30007>>>
30007>>>External_Function32 PESetWindowOptions "PESetWindowOptions" CRPE32.DLL ;  Integer printJob pointer Options Returns Integer
30008>>>
30008>>>Class CrystalReportSubSQL Is A CrystalReport
30009>>>
30009>>>    Procedure Construct_Object
30010>>>        Forward send Construct_Object
30012>>>        // Everything on except hasGroupTree by default
30012>>>        property integer hasGroupTree 0
30013>>>        property integer canDrillDown 1
30014>>>        property integer hasNavigationControls 1
30015>>>        property integer hasCancelButton 1
30016>>>        property integer hasPrintButton 1
30017>>>        property integer hasExportButton 1
30018>>>        property integer hasZoomControl 1
30019>>>        property integer hasCloseButton 1
30020>>>        property integer hasProgressControls 1
30021>>>        property integer hasSearchButton 1
30022>>>        property integer hasPrintSetupButton 1
30023>>>        property integer hasRefreshButton 1
30024>>>
30024>>>        Set WindowStyle To (WS_MAXIMIZE iOr WS_OVERLAPPEDWINDOW)
30025>>>    End_Procedure // Construct_Object
30026>>>
30026>>>    Procedure OutputToWindow String sTitle Integer iLeft Integer iTop Integer iWidth Integer iHeight Integer iStyle Handle hParent
30027>>>        Integer iPrintJob iResult
30028>>>        String sPEWindowOptions
30028>>>        Pointer pPeWindowOptions
30028>>>
30028>>>        Get PrintJob To iPrintJob
30029>>>        FillType PEWindowOptions with 0     to sPEWindowOptions
30030>>>        put PEWindowOptions_Size            to sPEWindowOptions at PEWindowOptions.StructSize
30031>>>        put (hasGroupTree(self))            to sPEWindowOptions at PEWindowOptions.hasGroupTree
30032>>>        put (canDrillDown(self))            to sPEWindowOptions at PEWindowOptions.canDrillDown
30033>>>        put (hasNavigationControls(self))   to sPEWindowOptions at PEWindowOptions.hasNavigationControls
30034>>>        put (hasCancelButton(self))         to sPEWindowOptions at PEWindowOptions.hasCancelButton
30035>>>        put (hasPrintButton(self))          to sPEWindowOptions at PEWindowOptions.hasPrintButton
30036>>>        put (hasExportButton(self))         to sPEWindowOptions at PEWindowOptions.hasExportButton
30037>>>        put (hasZoomControl(self))          to sPEWindowOptions at PEWindowOptions.hasZoomControl
30038>>>        put (hasCloseButton(self))          to sPEWindowOptions at PEWindowOptions.hasCloseButton
30039>>>        put (hasProgressControls(self))     to sPEWindowOptions at PEWindowOptions.hasProgressControls
30040>>>        put (hasSearchButton(self))         to sPEWindowOptions at PEWindowOptions.hasSearchButton
30041>>>        put (hasPrintSetupButton(self))     to sPEWindowOptions at PEWindowOptions.hasPrintSetupButton
30042>>>        put (hasRefreshButton(self))        to sPEWindowOptions at PEWindowOptions.hasrefreshButton
30043>>>        GetAddress of sPEWindowOptions      to pPEWindowOptions
30044>>>        Move (PESetWindowOptions(iPrintJob, pPEWindowOptions)) to iResult
30045>>>        Forward Send OutputToWindow sTitle iLeft iTop iWidth iHeight iStyle hParent
30047>>>    End_Procedure // OutputToWindow
30048>>>
30048>>>    Procedure Set TmpFileDir String aDir
30049>>>        String lsCurrWspc lsDir
30050>>>
30050>>>        If (ghoWorkSpace <> 0) Begin
30052>>>            Get WorkSpaceName of ghoWorkSpace to lsCurrWspc
30053>>>            Insert "WorkSpaces\" in lsCurrWspc at 1
30055>>>            Get_Profile_String lsCurrWspc aDir to lsDir
30058>>>            Set Report_Data_Path to lsDir
30059>>>        End
30059>>>>
30059>>>    End_Procedure
30060>>>
30060>>>    Procedure DoWinQLReport
30061>>>        // This can be used when reports must be able to run in different data directories
30061>>>        Set TmpFileDir to "TmpFileDir"
30062>>>        Forward Send DoWinQLReport
30064>>>    End_Procedure
30065>>>
30065>>>    // This hook procedure is called after the print job has been opened.
30065>>>    Procedure OnInitializeReport
30066>>>        Integer iTables iMax iCount iType
30067>>>        String  sLocation sLocation2 sPath DirSep
30067>>>        String  sNewPath sNewLocation sDataPath sMyLocation
30067>>>        Forward Send OnInitializeReport
30069>>>            Move (Sysconf(SYSCONF_DIR_SEPARATOR)) To DirSep
30070>>>            Get NTables To iMax
30071>>>            Decrement iMax
30072>>>            Get Report_Data_Path                                    To sPath
30073>>>            If Not (Right(sPath,1)) Eq DirSep Move (sPath-DirSep)   To sPath
30076>>>            For iCount From 0 To iMax
30082>>>>
30082>>>                //Get NthTableLocation iCount         To sLocation
30082>>>                //Get Report_Base_File_Name sLocation To sLocation2
30082>>>                //Set NthTableLocation iCount         To (sPath-sLocation2)
30082>>>                //Get NthTableDBType           iCount to iType
30082>>>                //Showln '--------------------------------------------------------'
30082>>>                //Showln iCount
30082>>>                //Showln sLocation
30082>>>                //Showln sPath
30082>>>                //Showln sLocation2
30082>>>                //Showln iType
30082>>>
30082>>>                //If (Trim(LowerCase(sLocation2))='btnemp.dat') Begin
30082>>>                  //Set Report_Data_Path to ''
30082>>>                  //Get NthTableDBType              iCount to iType
30082>>>                  Set nthTableLogOnServerName     iCount to 'SMSNT' 0
30083>>>                  Set nthTableLogOnDataBaseName   iCount to 'SMS'   0
30084>>>                    //Set nthTableLogOnUserID         iCount to 'dbo'     0
30084>>>                    //Set nthTableLogOnPassword       iCount to '123'     0
30084>>>                  //Set NthTableLocation            iCount To "BTNEMP"
30084>>>                    //Set NthTableLocation iCount To (sPath-sLocation2)
30084>>>                  //Get NthTableLocation iCount                 To sMyLocation
30084>>>                  //Move (Replace(sLocation,sMyLocation,''))    To sMyLocation
30084>>>                  //Showln sMyLocation
30084>>>                  //Set NthTableLocation            iCount To sMyLocation
30084>>>                //End
30084>>>
30084>>>            Loop // For iCount From 0 To iMax
30085>>>>
30085>>>    End_Procedure // OnInitializeReport
30086>>>
30086>>>    // This hook procedure is called just before a print job is closed.
30086>>>    Procedure OnDeInitializeReport
30087>>>        Forward Send OnDEInitializeReport
30089>>>    End_Procedure // OnDeInitializeReport
30090>>>
30090>>>    // This hook procedure is called just before a the print job is started.
30090>>>    Procedure OnStartPrinting
30091>>>        Forward Send OnStartPrinting
30093>>>    End_Procedure // OnStartPrinting
30094>>>
30094>>>    // This hook procedure is called just after a print job has finished.
30094>>>    Procedure OnStopPrinting
30095>>>        Forward Send OnStopPrinting
30097>>>    End_Procedure // OnStopPrinting
30098>>>
30098>>>
30098>>>End_Class // CrystalReportSubSQL
30099>>>
30099>// General Functions-Procedures and Variables
30099>Use Globals.Inc
INCLUDING FILE: GLOBALS.INC
30099>>>
30099>>>        String  gs_Selected_Company_Code
30099>>>        String  gs_Selected_Branch_Code
30099>>>        Integer gi_Selected_Year
30099>>>        String gs_Selected_Year_Recr
30099>>>        String  gs_Module_Code
30099>>>
30099>>>
30099>>>//Open Currency
30099>>>//Function CurrDigits Global String asCurr Returns Integer
30099>>>//    Integer liDecX
30099>>>//    Clear Currency
30099>>>//    move asCurr to Currency.Currency_C_Code
30099>>>//    Find Eq Currency By Index.1
30099>>>//    move Currency.Currency_Dec to liDecX
30099>>>//    Function_Return liDecX
30099>>>//End_Function // CurrDigits
30099>>>
30099>>>Open Nomisma
INCLUDING FILE: NOMISMA.FD
30101>>>Open SysCurXr
INCLUDING FILE: SYSCURXR.FD
30103>>>
30103>>>Function fiDekadika_Nomismatos Global String asNomisma Returns Integer
30104>>>    Move (Trim(asNomisma)) to asNomisma
30105>>>    Clear Nomisma
30106>>>    If ( asNomisma<>'' ) Move asNomisma         to Nomisma.Nomisma_Code
30109>>>    Else                 Move SysCurXr.C_Code0  to Nomisma.Nomisma_Code
30111>>>    Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
30112>>>>
30112>>>    Function_Return Nomisma.Dekadika
30113>>>End_Function //
30114>>>
30114>>>Function fsgCode_W_Zeroes Global Integer aiCode Integer aiPlaces Returns String
30115>>>    String rVal
30116>>>    Integer iLength iInt
30116>>>    Move aiCode to rVal
30117>>>    Move (trim(rVal)) to rVal
30118>>>    For iInt From 1 to (aiPlaces-(Length(rVal)))
30124>>>>
30124>>>        Move (Insert('0',rVal,1)) to rVal
30125>>>    Loop
30126>>>>
30126>>>    Function_Return rVal
30127>>>End_Function
30128>>>
30128>>>Function fsgCode_n_Zeroes Global number aiCode Integer aiPlaces Returns String
30129>>>    String rVal
30130>>>    Integer iLength iInt ipos
30130>>>    Move aiCode to rVal
30131>>>    Move (trim(rVal)) to rVal
30132>>>    MOVE (aiPlaces-(Length(rVal))) to ipos
30133>>>    For iInt From 1 to ipos
30139>>>>
30139>>>        Move (Insert('0',rVal,1)) to rVal
30140>>>    Loop
30141>>>>
30141>>>    Function_Return rVal
30142>>>End_Function
30143>>>
30143>>>
30143>>>Open Year
INCLUDING FILE: YEAR.FD
30145>>>Procedure EnumDDsForRebuildConstrain for DataDictionary integer aiMsg integer ahId
30146>>>    Send aiMsg to Self
30147>>>End_Procedure
30148>>>
30148>>>Procedure DoRefindYear for baseclass Integer aiPanel Integer aiYearDD
30149>>>    Integer liChanged
30150>>>
30150>>>    If ((aiYearDD = 0) or (Main_File(aiYearDD)<>Year.File_Number)) ;        Procedure_Return (Message_Box("Invalid Year_DD","Developer's Warning",MB_OK,MB_ICONWARNING))
30153>>>    If (Not(Current_Record(aiYearDD))) Begin
30155>>>        Get Should_Save of aiPanel to liChanged
30156>>>        Send Clear to aiYearDD
30157>>>        Move gs_Selected_Company_Code to Year.Company_Code
30158>>>        Move gs_Selected_Branch_Code  to Year.Branch_Code
30159>>>        Move gi_Selected_Year         to Year.Year_Year
30160>>>        Send Find to aiYearDD Eq 1 //Year.Index.1 - company_code+ranch_code+year_year
30161>>>        If (Not(liChanged)) Set Changed_State of aiPanel to False
30164>>>    End
30164>>>>
30164>>>End_Procedure
30165>>>
30165>>>Procedure RebuildConstrainIfYearChanged for baseclass Integer aiPanel String asCurrentYearRecr Integer aiYearDDId
30166>>>    Integer liSrvr
30167>>>    String  lsCurrentYearRecr
30167>>>
30167>>>    If (asCurrentYearRecr <> gs_Selected_Year_Recr) Begin
30169>>>        Broadcast Send EnumDDsForRebuildConstrain to aiPanel msg_Rebuild_Constraints Self
30171>>>    End
30171>>>>
30171>>>    Send DoRefindYear aiPanel aiYearDDId //(Year_DD(Self))
30172>>>    Get Server of aiPanel to liSrvr
30173>>>    // Respects Default values
30173>>>    If (liSrvr) If (Not(Current_Record(liSrvr))) Send Request_Clear to aiPanel
30178>>>End_Procedure
30179>>>
30179>>>//                                       ’¦ View            Property «¦¬ View             ’¦ Year DDO «¦¬ View
30179>>>//                                                          Holds the current year rec0
30179>>>// ‰¢ã©ž : Send RbldConstrIfYearChanged (Gplan_Test(Self))  (psCurrentYearRecr(Self))     (Year_DD(Self))
30179>>>
30179>>>
30179>>>Function fiRefindYear Global Returns Integer
30180>>>    Clear Year
30181>>>    Move gs_Selected_Company_Code to Year.Company_Code
30182>>>    Move gs_Selected_Branch_Code  to Year.Branch_Code
30183>>>    Move gi_Selected_Year         to Year.Year_Year
30184>>>    Find eq Year by Index.1 //company_code+ranch_code+year_year
30185>>>>
30185>>>    Function_Return (Found = 0)
30186>>>End_Function //fiRefindYear
30187>>>
30187>>>Procedure DoRunApplication for Baseclass String sAppName
30188>>>    string sRuntime  lsStr
30189>>>
30189>>>    Append lsStr 'C:\Dns.bat ' sAppName
30191>>>    RunProgram Wait  lsStr
30192>>>
30192>>>//    get_profile_string "defaults" "VDFBinDir" to sRuntime
30192>>>//    append sRuntime "\dfrun " sAppName
30192>>>    Append sRuntime 'C:\Program Files\Accessories\WORDPAD.EXE ' sAppName
30194>>>    runprogram background sRuntime
30195>>>End_procedure // DoRunApplication
30196>>>
30196>>>// Run the Editor
30196>>>Procedure DoRunEditor for Baseclass String asFile
30197>>>    string sRunPath lsWspcName
30198>>>    Move (WorkspaceName(ProgramWorkspace(Self))) to lsWspcName
30199>>>    get_profile_string ("workspaces\"+lsWspcName) "programpath" to sRunPath
30202>>>    //append sRunPath "\Editor "  asFile //// js 15/03/2002 " " lsWspcName
30202>>>    Move (Replace('.',asFile,'')) to asFile
30203>>>    append sRunPath asFile //// js 15/03/2002 " " lsWspcName
30204>>>    send DoRunApplication sRunPath
30205>>>End_Procedure // DoRunEditor
30206>>>
30206>>>//--------------------------------------
30206>>>
30206>>>//start of global functions and procedures
30206>>>
30206>>>
30206>>>//®¨ž© £¦§¦ œå«˜  ˜§æ: ˜) gmoves.dd    :private.update_gmhnes_ghmnies
30206>>>Function gsfFind_Previous Global String lsCode;                                 String lsDelimiter;                                 Returns String
30207>>>         String  lsTemp_Code1 lsTemp_Code2
30208>>>         Integer liCounter
30208>>>
30208>>>         //1.˜­˜å¨œ©ž ¡œ¤é¤
30208>>>         Move (Trim(lsCode)) to lsCode                                  //§® 30.12.345
30209>>>
30209>>>         //2.˜¤« ©«¨¦­ã
30209>>>         For liCounter From 1 to (Length(lsCode))
30215>>>>
30215>>>             Move (Insert(;                           (Mid(lsCode,1,liCounter)),;                           lsTemp_Code1,;                           1;                         )) to lsTemp_Code1                             //§® 543.21.03
30216>>>         Loop
30217>>>>
30217>>>
30217>>>         //3.˜­˜å¨œ©ž ¡œ¤é¤ (›â¤ ®¨œ áœ«˜ , safety only)
30217>>>         Move (Trim(lsTemp_Code1)) to lsTemp_Code1
30218>>>
30218>>>         //4.§˜å¨¤à £æ¤¦ «¦ ›œ¥ æ £â¨¦ª «¦¬ ˜¤«å©«¨¦­¦¬, £œ«á «¦ §¨é«¦ delimiter
30218>>>         Move (Right(;                      lsTemp_Code1,;                      ((Length(lsTemp_Code1))-((Pos(lsDelimiter,lsTemp_Code1))));                    )) to lsTemp_Code1                                  // §® 21.03
30219>>>
30219>>>         //5.¥˜¤á ˜¤« ©«¨¦­ã «¦¬ ˜¤«å©«¨¦­¦¬
30219>>>         For liCounter from 1 to (Length(lsTemp_Code1))
30225>>>>
30225>>>             Move (Insert(;                           (Mid(lsTemp_Code1,1,liCounter)),;                           lsTemp_Code2,;                           1;                         )) to lsTemp_Code2                             //§® 30.12
30226>>>         Loop
30227>>>>
30227>>>
30227>>>         Function_Return (Trim(lsTemp_Code2))
30228>>>End_Function //gsffind_previous
30229>>>
30229>>>
30229>>>Function gifSystem_Check Returns Integer
30230>>>         Integer liF_Gtypkins liF_Garicls liF_Gmoves liF_Gplans liF_Gmhnes liF_Ghmnies
30231>>>         Integer liS_Gtypkins liS_Garicls liS_Gmoves liS_Gplans liS_Gmhnes liS_Ghmnies
30231>>>//       Clear Company
30231>>>//       Find Gt Company.Recnum
30231>>>//       While (Found = 1)
30231>>>//             Add Company.Company_NumGtypkin to liS_Gtypkins § Ÿ˜¤é© ©«¦ sysfile ¤˜ «˜ ¡˜¨˜«áà ˜¬«á
30231>>>//             Add Company.Company_NumGarticl to liS_Garticls
30231>>>//             Add Company.Company_NumGmoves  to liS_Gmoves
30231>>>//             //d Company.Company_NumGtypkin to liS_Gtypkins
30231>>>//             Add Company.Company_NumGplan   to liS_GPlans
30231>>>//             Add Company.Company_NumGmhnes  to liS_Gmhnes
30231>>>//             Add Company.Company_NumGhmnies to liS_Ghmnies
30231>>>//             Find Gt Company.Recnum
30231>>>//       Loop
30231>>>//
30231>>>//       Get_Attribute {attribute} [of {file-handle} ;
30231>>>//                        [{field-num} | {index-num} [{segment-num}]]] ;
30231>>>//                        To {variable}
30231>>>//
30231>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30231>>>//       Get_Attribute DF_FILE_RECORDS_USED of Garticl.File_Number to liF_Garticls
30231>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmoves.File_Number  to liF_Gmoves
30231>>>//       //t_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30231>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gplan.File_Number   to liF_Gplans
30231>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmhnes.File_Number  to liF_Gmhnes
30231>>>//       Get_Attribute DF_FILE_RECORDS_USED of Ghmnies.File_Number to liF_Ghmnies
30231>>>//
30231>>>
30231>>>//       //â¢œš®¦ª DF_FILE_MAX_RECORDS+ £œ records used
30231>>>
30231>>>//       //â¢œš®¦ª last rec0 = sysrec rec0
30231>>>
30231>>>    Function_Return 0
30232>>>End_Function //gifSystem_Check
30233>>>
30233>>>/////////////////////////////////////////////////////////////////
30233>>>//‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª, £œ ž ®à¨åª ›œ¡˜› ¡á  JS
30233>>>Function Sfi_All_Numbers Global Number anValue Integer aiLengthAkeraios Integer aiLengthDekadika Returns String
30234>>>
30234>>>    String  lsRetval lsValue lsAkeraios lsDekadika
30235>>>    Integer liInt liInteger iTimes iStart
30235>>>    Number  lnDecimals
30235>>>
30235>>>    Move (Integer(anValue))                                         to liInteger
30236>>>    Move (Round(AnValue-(Integer(anValue))*(10^aiLengthDekadika)))  to lnDecimals
30237>>>
30237>>>    Move liInteger              to lsAkeraios
30238>>>    Move lnDecimals             to lsDekadika
30239>>>    Move (Trim(lsAkeraios))     to lsAkeraios
30240>>>    Move (Trim(lsDekadika))     to lsDekadika
30241>>>
30241>>>    Move (Length(lsAkeraios)) to iStart
30242>>>    For iTimes From iStart to (aiLengthAkeraios-1)
30248>>>>
30248>>>        Insert "0" in lsAkeraios at 1
30250>>>    Loop
30251>>>>
30251>>>    Move (Trim(lsAkeraios)) to lsAkeraios
30252>>>
30252>>>    Move (Length(lsDekadika)) to iStart
30253>>>    For iTimes From iStart to (aiLengthDekadika-1)
30259>>>>
30259>>>        Move (Append(lsDekadika,"0")) to lsDekadika
30260>>>    Loop
30261>>>>
30261>>>    Move (Trim(lsDekadika)) to lsDekadika
30262>>>
30262>>>    If (aiLengthDekadika=0) Move '' to lsDekadika
30265>>>    Move '' to lsRetVal
30266>>>    Move (Pad((lsAkeraios-lsDekadika),(aiLengthAkeraios+aiLengthDekadika))) to lsRetval
30267>>>    Function_Return lsRetval
30268>>>End_Function //sfi_All_Numbers  ‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª
30269>>>              //                 £œ ž ®à¨åª ›œ¡˜› ¡á (JS)
30269>>>
30269>>>Open Codemast
30271>>>
30271>>>
30271>>>Function gsfCode_Mast Global String lsType String lsValue Returns String
30272>>>         Clear Codemast
30273>>>         Move lsType  to Codemast.Type
30274>>>         Move lsValue to Codemast.Code
30275>>>         Find Eq Codemast by Index.1 //type+code
30276>>>>
30276>>>         Function_Return Codemast.Description
30277>>>End_Function //code_mast
30278>>>
30278>>>
30278>>>Open Branch
INCLUDING FILE: BRANCH.FD
30280>>>Function fsgCode_With_Zeroes Global Integer aiCode    ;                                    Integer aiPlaces  ;                                    String asCompany  ;                                    String asBranch   ;                               Returns String
30281>>>    String rVal
30282>>>    Integer iInt
30282>>>    Clear Branch
30283>>>    Move asCompany  to Branch.Company_Code
30284>>>    Move asBranch   to Branch.Branch_Code
30285>>>    Find Eq Branch by Index.1
30286>>>>
30286>>>    If (Trim(Branch.Tomeas_Code)<>'') Move (Trim(Branch.Tomeas_Code)) to asBranch
30289>>>    Move (Trim(asCompany))  to asCompany
30290>>>    Move (Trim(asBranch))   to asBranch
30291>>>    If (Length(asCompany)=1) Insert '0' In asCompany At 1
30295>>>    If (Length(asBranch) =1) Insert '0' In asBranch  At 1
30299>>>    Move ''                                           to rVal
30300>>>    Move (Sfi_All_Numbers(aiCode,aiPlaces,0))         to rVal
30301>>>    Move (Append((asCompany+'.'+asBranch+'.'),rVal))  to rVal
30302>>>    Move (Trim(rVal))                                 to rVal
30303>>>    Function_Return rVal
30304>>>End_Function
30305>>>
30305>>>Function fsgStripCodeFromID Global String asID Returns Integer
30306>>>      Integer iLen iPos iInt
30307>>>      If (Trim(asID)='') Function_Return 0
30310>>>      Move (Trim  (asID)) to asID
30311>>>      Move (Length(asID)) to iLen
30312>>>      For iInt From 1     to iLen
30318>>>>
30318>>>          If (Mid(asID,1,iInt)='.') Move iInt to iPos
30321>>>      Loop
30322>>>>
30322>>>      Function_Return (Right(asID,(iLen-iPos)))
30323>>>End_Function
30324>>>
30324>>>
30324>>>
30324>>>
30324>>>
30324>>>
30324>>>Function fsCityDescr Global Integer aiCityID Returns String
30325>>>    String rVal
30326>>>    Open Cities
INCLUDING FILE: CITIES.FD
30328>>>    Clear Cities
30329>>>    Move aiCityID to Cities.City_ID
30330>>>    Find Eq Cities By Index.1
30331>>>>
30331>>>    If (Found=1) Move Cities.City_descr to rVal
30334>>>    Else         Move '' to rVal
30336>>>    Function_Return rVal
30337>>>End_Function
30338>>>
30338>>>Function fiTownIDFromCity Global Integer aiCityID Returns Integer
30339>>>    Open Cities
30341>>>    Clear Cities
30342>>>    Move aiCityID to Cities.City_ID
30343>>>    Find Eq Cities By Index.1
30344>>>>
30344>>>    Function_Return Cities.Town_ID
30345>>>End_Function
30346>>>
30346>>>Function fiCountryIDFromTown Global Integer aiTownID Returns Integer
30347>>>    Open Towns
INCLUDING FILE: TOWNS.FD
30349>>>    Clear Towns
30350>>>    Move aiTownID to Towns.Town_ID
30351>>>    Find Eq Towns By Index.1
30352>>>>
30352>>>    Function_Return Towns.Country_ID
30353>>>End_Function
30354>>>
30354>>>Function fsTownDescr Global Integer aiTownID Returns String
30355>>>    String rVal
30356>>>    Open Towns
30358>>>    Clear Towns
30359>>>    Move aiTownID to Towns.Town_ID
30360>>>    Find Eq Towns By Index.1
30361>>>>
30361>>>    If (Found=1) Move Towns.Town_descr to rVal
30364>>>    Else         Move '' to rVal
30366>>>    Function_Return rVal
30367>>>End_Function
30368>>>
30368>>>Function fsCountryDescr Global Integer aiCountryID Returns String
30369>>>    String rVal
30370>>>    Open Country
INCLUDING FILE: COUNTRY.FD
30372>>>    Clear Country
30373>>>    Move aiCountryID to Country.Country_ID
30374>>>    Find Eq Country By Index.1
30375>>>>
30375>>>    If (Found=1) Move Country.Country_descr to rVal
30378>>>    Else         Move '' to rVal
30380>>>    Function_Return rVal
30381>>>End_Function
30382>>>
30382>>>Function fsAreaDescr Global Integer aiAreaID Returns String
30383>>>    String rVal
30384>>>    Open Areas
INCLUDING FILE: AREAS.FD
30386>>>    Clear Areas
30387>>>    Move aiAreaID to Areas.Area_ID
30388>>>    Find Eq Areas By Index.1
30389>>>>
30389>>>    If (Found=1) Move Areas.Area_descr to rVal
30392>>>    Else         Move '' to rVal
30394>>>    Function_Return rVal
30395>>>End_Function
30396>>>
30396>>>Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
30397>>>    Local String rVal lsTmp lsOO lsLL
30398>>>    Local Number lnOO lnLL
30398>>>
30398>>>    Move '' to lsOO
30399>>>    Move '' to lsLL
30400>>>    Move '' to rVal
30401>>>
30401>>>    Move (Integer(anTime))                              to lnOO
30402>>>    ////////////////////////////////////////////
30402>>>    // sos sos sos jsjsjsjsjs yannis 30/03/2000
30402>>>    //If ((lnOO=24) and (lnll=0)) Move 0 to lnOO
30402>>>    ////////////////////////////////////////////
30402>>>
30402>>>    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
30403>>>
30403>>>    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
30406>>>    Else         Move (String(lnOO))                    to lsOO
30408>>>    Move (Trim(lsOO))                                   to lsOO
30409>>>
30409>>>    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
30412>>>    Else         Move (String(lnLL))                    to lsLL
30414>>>    Move (Trim(lsLL))                                   to lsLL
30415>>>
30415>>>    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
30416>>>
30416>>>    Move (Trim(rVal)) to rVal
30417>>>
30417>>>    Function_Return rVal
30418>>>End_Function
30419>>>
30419>>>Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
30420>>>    Local Number rVal nOres nLepta
30421>>>    Move (Integer(aiMinutes/60))    to nOres
30422>>>    Move (    Mod(aiMinutes,60))    to nLepta
30423>>>    Move (nOres+(nLepta/100))       to rVal
30424>>>    Function_Return rVal
30425>>>End_Function
30426>>>
30426>>>Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
30427>>>    Local Integer rVal
30428>>>    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
30429>>>    Function_Return rVal
30430>>>End_Function
30431>>>
30431>>>Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;                                                                    Number anEndTime    ;                                                                    Returns Integer
30432>>>    Local Integer rVal iMinStart iMinEnd
30433>>>
30433>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30436>>>
30436>>>    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
30437>>>    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
30438>>>    Move (iMinEnd-iMinStart)                                                     to rVal
30439>>>    Function_Return rVal
30440>>>End_Function
30441>>>
30441>>>
30441>>>Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;                                                                Number anEndTime    ;                                                                Returns Number
30442>>>    Local Integer iTmp
30443>>>    Local Number  rVal
30443>>>
30443>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30446>>>
30446>>>    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
30447>>>    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
30448>>>    Function_Return rVal
30449>>>End_Function
30450>>>
30450>>>
30450>>>
30450>>>Open WitemCL
INCLUDING FILE: WITEMCL.FD
30452>>>Open WitemCld
INCLUDING FILE: WITEMCLD.FD
30454>>>Open WitemxT
INCLUDING FILE: WITEMXT.FD
30456>>>
30456>>>Function fnTeleytaiaTimhAgoras String asPromCode String asItemCode  ;                               Date   adHmnia    Number anQty       ;                               Returns Number
30457>>>  Integer iExodos
30458>>>  Number nPoso nPct
30458>>>  Move 0 to nPoso
30459>>>  Move 0 to nPct
30460>>>  Move 0 to iExodos
30461>>>
30461>>>  Move (Trim(asItemCode)) to asItemCode
30462>>>  Move (Trim(asPromCode)) to asPromCode
30463>>>
30463>>>  // 1.Anazhthsh sto arxeio Witemcld
30463>>>  Clear Witemcld
30464>>>  Move asItemCode to Witemcld.Item_Code
30465>>>  Move asPromCode to Witemcld.Client_Code
30466>>>  Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30467>>>>
30467>>>  While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;                       (Witemcld.Client_Code= asPromCode) And ;                       (iExodos=0))
30471>>>      If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
30473>>>          Move 1 to iExodos
30474>>>               If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
30477>>>          Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
30481>>>      End
30481>>>>
30481>>>      Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30482>>>>
30482>>>  Loop
30483>>>>
30483>>>  If (iExodos) Begin
30485>>>      If (nPoso) Function_Return nPoso
30488>>>      Else Function_Return nPct
30490>>>  End
30490>>>>
30490>>>
30490>>>  // 2.Anazhthsh sto arxeio Witemcl
30490>>>  Clear WitemCL
30491>>>  Move (Trim(asPromCode)) to WitemCL.Client_Code
30492>>>  Move (Trim(asItemCode)) to WitemCL.Item_Code
30493>>>  Find Eq WitemCL By Index.1
30494>>>>
30494>>>  If (Found=1) Function_Return WitemCL.Client_Price
30497>>>
30497>>>  Function_Return 0
30498>>>End_Function
30499>>>
30499>>>Open BtnOrdd
INCLUDING FILE: BTNORDD.FD
30501>>>Function fnTeleytaiaTimhPolhshs String asWitemxRecr String asClientID ;                                String asWitemxCode Date   adHmnia    ;                                String asItemCode   Number anQty      ;                                String asCNCode     Returns Number
30502>>>
30502>>>  Integer iExodos iCheckDeop
30503>>>  Number nPoso nPct
30503>>>
30503>>>  Move (Num_Arguments=7) to iCheckDeop
30504>>>
30504>>>  Move 0 to nPoso
30505>>>  Move 0 to nPct
30506>>>  Move 0 to iExodos
30507>>>
30507>>>  Move (Trim(asItemCode))                 to asItemCode
30508>>>  Move (Trim(asClientID))                 to asClientID
30509>>>  Move (Trim(asWitemxRecr))               to asWitemxRecr
30510>>>  Move (Trim(asWitemxCode))               to asWitemxCode
30511>>>  If (iCheckDeop) Move (Trim(asCNCode))   to asCNCode
30514>>>
30514>>>  // 1. Anazhthsh apo DEOP ef' oson yparxei kodikos ergou
30514>>>  If (iCheckDeop) Begin
30516>>>      Clear btnordd
30517>>>      Move asClientID   to btnordd.vclient_id
30518>>>      Move asCNCode     to btnordd.vcn_code
30519>>>      Move asWitemxCode to btnordd.vitem
30520>>>      Move 0            to btnordd.vactive
30521>>>      Move adHmnia      to btnordd.arxh_date
30522>>>      Find LE btnordd by index.4//client_id+cn_code+item+arxh_date
30523>>>>
30523>>>      If ((found=1) and (asWitemxCode=btnordd.vitem)    and (adHmnia>=btnordd.arxh_date) ;                    and (adHmnia<=btnordd.deop_date)    and (btnordd.vactive=0)          ;                    and (asCNCode=btnordd.vcn_code)) begin
30525>>>          move btnordd.vprice to nPoso
30526>>>          If (nPoso) Function_Return nPoso
30529>>>      End
30529>>>>
30529>>>  End
30529>>>>
30529>>>
30529>>>  // 2.Anazhthsh sto arxeio Witemcld (Timokatalogos Pelath/Eidous)
30529>>>  Clear Witemcld
30530>>>  Move asItemCode to Witemcld.Item_Code
30531>>>  Move asClientID to Witemcld.Client_Code
30532>>>  Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30533>>>>
30533>>>  While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;                       (Witemcld.Client_Code= asClientID) And ;                       (iExodos=0))
30537>>>      If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
30539>>>          Move 1 to iExodos
30540>>>               If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
30543>>>          Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
30547>>>      End
30547>>>>
30547>>>      Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30548>>>>
30548>>>  Loop
30549>>>>
30549>>>  If (iExodos) Begin
30551>>>      If (nPoso) Function_Return nPoso
30554>>>      Else Function_Return nPct
30556>>>  End
30556>>>>
30556>>>
30556>>>
30556>>>  // 3.Anazhthsh sto arxeio Witemxt (Timokatalogos Eidous)
30556>>>  Clear Witemxt
30557>>>  Move SysCurXr.Company_Code  to Witemxt.Company_Code
30558>>>  Move SysCurXr.Branch_Code   to Witemxt.Branch_Code
30559>>>  Move SysCurXr.Year_Year     to Witemxt.Year_Year
30560>>>  Move asWitemxRecr           to Witemxt.Witemx_Recr
30561>>>  Find Gt Witemxt By Index.1 // Witemxt:Index.1
30562>>>>
30562>>>  While ((Found=1) And (Witemxt.Company_Code = SysCurXr.Company_Code) And ;                       (Witemxt.Branch_Code  = SysCurXr.Branch_Code ) And ;                       (Witemxt.Year_Year    = SysCurXr.Year_Year   ) And ;                       (Witemxt.Witemx_Recr  = asWitemxRecr         ) And ;                       (iExodos=0))
30566>>>      If ((adHmnia>=Witemxt.Value_Date) And (anQty<=Witemxt.Qty)) Begin
30568>>>          Move 1 to iExodos
30569>>>               If (Witemxt.Axia0 <>0) Move  Witemxt.Axia0         to nPoso
30572>>>          Else If (Witemxt.PcDisc<>0) Move (Witemxt.PcDisc*(-1))  to nPct
30576>>>      End
30576>>>>
30576>>>      Find Gt Witemxt By Index.1 // Witemxt:Index.1
30577>>>>
30577>>>  Loop
30578>>>>
30578>>>  If (iExodos) Begin
30580>>>      If (nPoso) Function_Return nPoso
30583>>>      Else Function_Return nPct
30585>>>  End
30585>>>>
30585>>>
30585>>>
30585>>>  // 4.Anazhthsh sto arxeio Witemcl (Teleytaia Timh Agoras)
30585>>>  Clear WitemCL
30586>>>  Move (Trim(asClientID)) to WitemCL.Client_Code
30587>>>  Move (Trim(asItemCode)) to WitemCL.Item_Code
30588>>>  Find Eq WitemCL By Index.1
30589>>>>
30589>>>  If (Found=1) Function_Return WitemCL.Client_Price
30592>>>
30592>>>  Function_Return 0
30593>>>End_Function
30594>>>
30594>>>Function fsStripTextFieldFromEnter Global String asStr Returns String
30595>>>    String sEnter
30596>>>    Move '' to sEnter
30597>>>    Append sEnter (Character(13)) (Character(10))
30599>>>    Move (Replaces(sEnter,asStr,' ')) to asStr
30600>>>    Function_return (Trim(asStr))
30601>>>End_function
30602>>>
30602>>>
30602>>>//end   of global functions and procedures
30602>>>Use Wait.DG
INCLUDING FILE: WAIT.DG
30602>>>>>USE AllEntSc
30602>>>>>
30602>>>>>//AB-IgnoreEnd
30602>>>>>
30602>>>>>
30602>>>>>//AB-IgnoreEnd
30602>>>>>
30602>>>>>Object Wait is a ModalPanelSub
30604>>>>>
30604>>>>>    //AB-StoreTopStart
30604>>>>>
30604>>>>>    // How to Use It
30604>>>>>    // Get the maximum position of the bar
30604>>>>>    // Move (Bar_Maximum_position(Wait(self))) to iMax
30604>>>>>    //
30604>>>>>    // Set the maximum position of the bar
30604>>>>>    // Set Bar_Maximum_position of (Wait(self)) to iMax
30604>>>>>    //
30604>>>>>    // Start Bar Progress from beginning
30604>>>>>    // Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
30604>>>>>    //
30604>>>>>    // End Bar Progress
30604>>>>>    // Send Bar_Current_Position to (Wait(Self)) iMax iMax iMax False
30604>>>>>    //
30604>>>>>    // Update Bar Progress
30604>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax True OR
30604>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax False
30604>>>>>    // When you want the update to be done for every i (this is slower)
30604>>>>>    // Where i=Counter's current value, icounter=Counter's Max Value and iMax=Bar Max Position
30604>>>>>    //
30604>>>>>    // Display Buttons on the object
30604>>>>>    // Set Button_State of (Wait(Self)) to False/True
30604>>>>>    // If the Progress Bar gets initialized without buttons, it MUST be Deactivated
30604>>>>>    //
30604>>>>>    // Initialization of the Progress Bar
30604>>>>>    // Send Popup to (Wait(Self))
30604>>>>>    //
30604>>>>>    // Deactivation of the Progress Bar
30604>>>>>    // Send Deactivate to (Wait(Self))
30604>>>>>    //
30604>>>>>    // Message during the process
30604>>>>>    // Set Wait_Message of (Wait(Self)) to "Now Processing..."
30604>>>>>    //
30604>>>>>    // Extra Info for button "Info >>"
30604>>>>>    // Send Wait_Details to (Wait(Self)) sFile sDetail bInitData
30604>>>>>    // If sFile<>'' then reads the contents of the file
30604>>>>>    // Else Fills the Edit with the string of sDetail
30604>>>>>    // If bInitData is True then the edit object is cleared first else extra info is appended
30604>>>>>    //
30604>>>>>    // Remarks instead of Progress Bar
30604>>>>>    // Set Button_State of (Wait(Self))     to False
30604>>>>>    // Set BarVisibleState of (Wait(Self))  to 'Remarks' False
30604>>>>>    // Update During Process
30604>>>>>    // Send UpdateWait to (Wait(Self)) 'Remarks'
30604>>>>>
30604>>>>>    //AB-StoreTopEnd
30604>>>>>
30604>>>>>    Set Exit_Application_Local_State to FALSE
30605>>>>>    Set Modal_State to FALSE
30606>>>>>    Set Popup_State to TRUE
30607>>>>>    Set Border_Style to Border_Thick
30608>>>>>    Set Minimize_Icon to FALSE
30609>>>>>    Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
30610>>>>>    Set Size to 138 256
30611>>>>>
30611>>>>>    //AB-DDOStart
30611>>>>>
30611>>>>>
30611>>>>>    //AB-DDOEnd
30611>>>>>
30611>>>>>    Object WaitBar is a ProgressBarSub
30613>>>>>
30613>>>>>        //AB-StoreTopStart
30613>>>>>
30613>>>>>        //AB-StoreTopEnd
30613>>>>>
30613>>>>>        Set Size to 21 243
30614>>>>>        Set Location to 7 4
30615>>>>>
30615>>>>>        //AB-StoreStart
30615>>>>>        Send DoRegSize  self smTopRight
30616>>>>>        //AB-StoreEnd
30616>>>>>
30616>>>>>    End_Object
30617>>>>>
30617>>>>>    Object WaitText is a TextBoxSub
30619>>>>>
30619>>>>>        //AB-StoreTopStart
30619>>>>>
30619>>>>>        //AB-StoreTopEnd
30619>>>>>
30619>>>>>        Set Enabled_State to TRUE
30620>>>>>        Set Label to "Processing"
30621>>>>>        Set FontSize to 4 0
30622>>>>>        Set Size to 10 81
30623>>>>>        Set Location to 36 5
30624>>>>>
30624>>>>>        //AB-StoreStart
30624>>>>>
30624>>>>>        //AB-StoreEnd
30624>>>>>
30624>>>>>    End_Object
30625>>>>>
30625>>>>>    Object bnCancel is a ButtonSub
30627>>>>>
30627>>>>>        //AB-StoreTopStart
30627>>>>>
30627>>>>>        //AB-StoreTopEnd
30627>>>>>
30627>>>>>        Set Default_State to TRUE
30628>>>>>        Set Label to "OK"
30629>>>>>        Set Location to 34 143
30630>>>>>
30630>>>>>        //AB-StoreStart
30630>>>>>
30630>>>>>        Procedure OnClick
30632>>>>>             Send Deactivate to (Wait(Self))
30633>>>>>        End_Procedure
30634>>>>>
30634>>>>>        Send DoRegAlign self amTopRight
30635>>>>>        //AB-StoreEnd
30635>>>>>
30635>>>>>    End_Object
30636>>>>>
30636>>>>>    Object bnDetail is a ButtonSub
30638>>>>>
30638>>>>>        //AB-StoreTopStart
30638>>>>>
30638>>>>>        //AB-StoreTopEnd
30638>>>>>
30638>>>>>        Set Focus_Mode to Pointer_Only
30639>>>>>        Set Label to "Info >>"
30640>>>>>        Set Location to 34 197
30641>>>>>
30641>>>>>        //AB-StoreStart
30641>>>>>
30641>>>>>        Procedure OnClick
30643>>>>>            Delegate Send Show_Details False
30645>>>>>        End_Procedure
30646>>>>>
30646>>>>>        Send DoRegAlign self amTopRight
30647>>>>>        //AB-StoreEnd
30647>>>>>
30647>>>>>    End_Object
30648>>>>>
30648>>>>>    Object LineControlSub1 is a LineControlSub
30650>>>>>
30650>>>>>        //AB-StoreTopStart
30650>>>>>
30650>>>>>        //AB-StoreTopEnd
30650>>>>>
30650>>>>>        Set Size to 2 243
30651>>>>>        Set Location to 54 4
30652>>>>>
30652>>>>>        //AB-StoreStart
30652>>>>>
30652>>>>>        Send DoRegSize  self smTopRight
30653>>>>>        //AB-StoreEnd
30653>>>>>
30653>>>>>    End_Object
30654>>>>>
30654>>>>>    Object WaitEdit is a editSub
30656>>>>>
30656>>>>>        //AB-StoreTopStart
30656>>>>>
30656>>>>>        //AB-StoreTopEnd
30656>>>>>
30656>>>>>        Set Enabled_State to FALSE
30657>>>>>        Set Read_Only_State to TRUE
30658>>>>>        Set Size to 58 243
30659>>>>>        Set Location to 60 4
30660>>>>>        Set Color to clWhite
30661>>>>>
30661>>>>>        //AB-StoreStart
30661>>>>>
30661>>>>>        Send DoRegSize Self amBottomRight
30662>>>>>        Delegate Set Size to 66 256
30664>>>>>
30664>>>>>        //AB-StoreEnd
30664>>>>>
30664>>>>>    End_Object
30665>>>>>
30665>>>>>    Object oTxtAntiBar is a TextBoxSub
30667>>>>>        Set Enabled_State to TRUE
30668>>>>>        Set Visible_State to FALSE
30669>>>>>        Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
30670>>>>>        Set Justification_Mode to (jMode_Center IOR jMode_VCenter)
30671>>>>>        Set Auto_Size_State to FALSE
30672>>>>>        Set FontWeight to 600
30673>>>>>        Set FontSize to 4 0
30674>>>>>        Set Size to 10 209
30675>>>>>        Set Location to 10 4
30676>>>>>        Set TextColor to clNavy
30677>>>>>    End_Object
30678>>>>>
30678>>>>>
30678>>>>>    //AB-StoreStart
30678>>>>>    Property Integer piWaitSize  Public (Size(Self))
30680>>>>>    Property Integer piPrevSize  Public (Size(Self))
30682>>>>>    Property Integer piState     Public False
30684>>>>>
30684>>>>>    Set Locate_Mode to Center_On_Screen
30685>>>>>    Set Destroy_Object_State to True
30686>>>>>
30686>>>>>    Procedure Show_Details Integer bAlways
30688>>>>>        Local Integer liOriSize liSize hiSize hiOriSize lowSize bState
30689>>>>>        Local String sLabel
30689>>>>>        Get Size                to liSize
30690>>>>>        Get piState             to bState
30691>>>>>        Get piWaitSize          to liOriSize
30692>>>>>        Move (Hi(liSize))       to hiSize
30693>>>>>        Move (Low(liSize))      to lowSize
30694>>>>>        Move (Hi(liOriSize))    to hiOriSize
30695>>>>>        If (bAlways) Begin
30697>>>>>            Set piState         to False
30698>>>>>            Move 0              to bState
30699>>>>>        End
30699>>>>>>
30699>>>>>        If bState Begin
30701>>>>>             Set Size to hiOriSize lowSize
30702>>>>>             Set Label of (bnDetail(Self)) to "Info >>"
30703>>>>>        End
30703>>>>>>
30703>>>>>        Else Begin
30704>>>>>             Set Size to 138 lowSize
30705>>>>>             Set Label of (bnDetail(Self)) to "<< Info"
30706>>>>>        End
30706>>>>>>
30706>>>>>        Set piState to (1-bState)
30707>>>>>    End_Procedure
30708>>>>>
30708>>>>>    Procedure Bar_Current_Position Integer iCount Integer iOccurances Integer iMaximum Integer bState
30710>>>>>       If (bState) Begin
30712>>>>>         If (Mod(iCount,(iCount*((Number(iMaximum))/(Number(iOccurances)))))=0) ;            Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
30715>>>>>       End
30715>>>>>>
30715>>>>>       Else Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
30717>>>>>    End_Procedure
30718>>>>>
30718>>>>>    Procedure DoInitialize_WaitBar
30720>>>>>        Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
30721>>>>>    End_Procedure
30722>>>>>
30722>>>>>    Procedure DoTerminate_WaitBar
30724>>>>>        Local Integer iMax
30725>>>>>        Get Maximum_position of (WaitBar(Self)) to iMax
30726>>>>>        Send Bar_Current_Position to (Wait(Self)) iMax iMax Imax False
30727>>>>>    End_Procedure
30728>>>>>
30728>>>>>    Procedure Set Bar_Maximum_Position Integer iMaximum
30730>>>>>         Set Maximum_position of (WaitBar(Self)) to iMaximum
30731>>>>>    End_Procedure
30732>>>>>
30732>>>>>    Function Bar_Maximum_Position Returns Integer
30734>>>>>        Function_Return (Maximum_position(WaitBar(Self)))
30735>>>>>    End_Function
30736>>>>>
30736>>>>>    Procedure Set Bar_Minimum_Position Integer iMinimum
30738>>>>>         Set Minimum_position of (WaitBar(Self)) to iMinimum
30739>>>>>    End_Procedure
30740>>>>>
30740>>>>>    Function Bar_Minimum_Position Returns Integer
30742>>>>>        Function_Return (Minimum_position(WaitBar(Self)))
30743>>>>>    End_Function
30744>>>>>
30744>>>>>    Procedure Set Bar_Step_Value Integer iStep
30746>>>>>         Set Step_Value of (WaitBar(Self)) to iStep
30747>>>>>    End_Procedure
30748>>>>>
30748>>>>>    Function Bar_Step_Value Returns Integer
30750>>>>>        Function_Return (Step_Value(WaitBar(Self)))
30751>>>>>    End_Function
30752>>>>>
30752>>>>>    Procedure Set Wait_Message String sMessage
30754>>>>>        Set Value of (WaitText(Self)) to sMessage
30755>>>>>    End_Procedure
30756>>>>>
30756>>>>>    Procedure Wait_Details String sFile String sDetail Integer bInitData
30758>>>>>        Local Integer liEditId
30759>>>>>        Move (WaitEdit(Self)) to liEditId
30760>>>>>        If bInitData Send Delete_Data to liEditId
30763>>>>>        If sFile ne "" Begin
30765>>>>>           Send Read to liEditId sFile
30766>>>>>           Send Beginning_Of_Data to liEditId
30767>>>>>        End
30767>>>>>>
30767>>>>>        Else Begin
30768>>>>>           Send Insert to liEditId sDetail
30769>>>>>        End
30769>>>>>>
30769>>>>>    End_Procedure
30770>>>>>
30770>>>>>    Procedure OnResize
30772>>>>>        Local Integer liSize liHiSize liPrevSize liHiPrevSize bState liHiLoc liLoc
30773>>>>>        Get Size to liPrevSize
30774>>>>>        Move (Hi(liPrevSize)) to liHiPrevSize
30775>>>>>        Forward Send OnResize
30777>>>>>        Get Location of (WaitEdit(Self)) to liLoc
30778>>>>>        Move (Hi(liLoc)) to liHiLoc
30779>>>>>        Get piState to bState
30780>>>>>        Get Size to liSize
30781>>>>>        Move (Hi(liSize)) to liHiSize
30782>>>>>        If (liHiSize > (liHiLoc +30)) Begin
30784>>>>>            Set Value of (bnDetail(Self)) to "<< Info"
30785>>>>>            If (liHiPrevSize <= (liHiLoc +30)) Set piState to (1-bState)
30788>>>>>        End
30788>>>>>>
30788>>>>>        Else Begin
30789>>>>>            Set Value of (bnDetail(Self)) to "Info >>"
30790>>>>>            If (liHiPrevSize > (liHiLoc +30)) Set piState to (1-bState)
30793>>>>>        End
30793>>>>>>
30793>>>>>    End_Procedure
30794>>>>>
30794>>>>>    Procedure Set Button_State Integer bState
30796>>>>>        If bState Begin
30798>>>>>            Set Caption_Bar to True
30799>>>>>            Set Size to 66 256
30800>>>>>        End
30800>>>>>>
30800>>>>>        Else Begin
30801>>>>>            Set Caption_Bar to False
30802>>>>>            Set Size to 38 256
30803>>>>>        End
30803>>>>>>
30803>>>>>    End_Procedure
30804>>>>>
30804>>>>>    Procedure Set BarVisibleState String sMsg Integer bState
30806>>>>>        Set Visible_State of (oTxtAntiBar(Self)) to (bState = 0)
30807>>>>>        Set Visible_State of (WaitBar(Self))     to (bState = 1)
30808>>>>>        If (bState = 0) Begin
30810>>>>>            Set Size to 24 256
30811>>>>>            Set Location of (oTxtAntiBar(Self)) to 6 5
30812>>>>>        End
30812>>>>>>
30812>>>>>        If sMsg ne "" Set Value of (oTxtAntiBar(Self)) to sMsg
30815>>>>>    End_Procedure
30816>>>>>
30816>>>>>    Procedure Deactivating integer search_mode Returns Integer
30818>>>>>        local integer rval
30819>>>>>        Forward Get MSG_Deactivating search_mode to rval
30821>>>>>        Set Modal_State of (Wait(Self)) to False
30822>>>>>        Set BarVisibleState of (Wait(Self)) to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..." True
30823>>>>>        Procedure_Return rval
30824>>>>>    End_Procedure
30825>>>>>
30825>>>>>    Procedure UpdateWait String sMsg
30827>>>>>        Set Value of (oTxtAntiBar(Self)) to sMsg
30828>>>>>    End_Procedure
30829>>>>>
30829>>>>>
30829>>>>>    Procedure Set Horizontal_Justification Integer aiMode
30831>>>>>        Set Justification_Mode of oTxtAntiBar to (jMode_VCenter IOR aiMode)
30832>>>>>    End_Procedure
30833>>>>>
30833>>>>>
30833>>>>>
30833>>>>>
30833>>>>>
30833>>>>>
30833>>>>>    //AB-StoreEnd
30833>>>>>
30833>>>>>End_Object
30834>>>>>
30834>>>>>
30834>>>>>//AB-StoreStart
30834>>>>>
30834>>>>>//AB-StoreEnd
30834>>>>>
30834>>>>>//AB/ End_Object    // prj
30834>>>
30834>Use Calendar.sl
INCLUDING FILE: CALENDAR.SL
30834>>>//AB/ Project Calendar
30834>>>//AB/ Object prj is a Lookup_Project
30834>>>//AB/     Set ProjectName to "Calendar"
30834>>>//AB/     Set ProjectFileName to "Calendar.sl"
30834>>>
30834>>>// Project Object Structure
30834>>>//   oCalendar is a dbModalPanel
30834>>>//     Container3d1 is a Container3d
30834>>>//       Grid2 is a Grid
30834>>>//       Textbox2 is a Textbox
30834>>>//       Textbox3 is a Textbox
30834>>>//       Textbox4 is a Textbox
30834>>>//       Textbox5 is a Textbox
30834>>>//       Textbox6 is a Textbox
30834>>>//       Textbox7 is a Textbox
30834>>>//       Textbox8 is a Textbox
30834>>>//       LineControl1 is a LineControl
30834>>>//       Container3d2 is a Container3d
30834>>>//         oRght is a BitmapContainer
30834>>>//         oLeft is a BitmapContainer
30834>>>//         oMonth is a Textbox
30834>>>//           oSelectMonth is a FloatingPopupMenu
30834>>>//         oYear is a Textbox
30834>>>//         oSelectYear is a Form
30834>>>//     BitmapContainer3 is a BitmapContainer
30834>>>//     oToday is a Textbox
30834>>>
30834>>>// Register all objects
30834>>>Register_Object BitmapContainer3
30834>>>Register_Object Container3d1
30834>>>Register_Object Container3d2
30834>>>Register_Object Grid2
30834>>>Register_Object LineControl1
30834>>>Register_Object oCalendar
30834>>>Register_Object oLeft
30834>>>Register_Object oMonth
30834>>>Register_Object oRght
30834>>>Register_Object oSelectMonth
30834>>>Register_Object oSelectYear
30834>>>Register_Object oToday
30834>>>Register_Object oYear
30834>>>Register_Object Textbox2
30834>>>Register_Object Textbox3
30834>>>Register_Object Textbox4
30834>>>Register_Object Textbox5
30834>>>Register_Object Textbox6
30834>>>Register_Object Textbox7
30834>>>Register_Object Textbox8
30834>>>
30834>>>
30834>>>
30834>>>//AB-StoreTopStart
30834>>>Use dates.utl
INCLUDING FILE: DATES.UTL
30834>>>>>// **********************************************************************
30834>>>>>// Use Dates.utl    // Date manipulation for VDF and DF3.1
30834>>>>>//
30834>>>>>// by Sture Andersen (sa1@vd.dk)
30834>>>>>//
30834>>>>>// The file contains a number of global functions for manipulating
30834>>>>>// dates. The package may be used with DataFlex 3.1 and Visual DataFlex.
30834>>>>>// This package is public domain.
30834>>>>>//
30834>>>>>// The package file is accompanied by a Word document (dfutil.doc)
30834>>>>>// listing the functions and their use.
30834>>>>>//
30834>>>>>//
30834>>>>>// Create: Fri  06-06-1997 - Merger of s_utl020, 021, 022, 023, 024, 025.
30834>>>>>// Update: Thu  26-06-1997 - Fixes for strange behavior when date4_state is set.
30834>>>>>//                         - Addition of popup_calendar to VDF.
30834>>>>>//         Sun  29-06-1997 - Character mode popup calender.
30834>>>>>//         Fri  04-07-1997 - Function WeekToDate added.
30834>>>>>//         Thu  10-07-1997 - Fixes.
30834>>>>>//         Mon  11-08-1997 - WeekToDate fixed.
30834>>>>>//         Sun  24-08-1997 - Character mode popup calender finished.
30834>>>>>//         Mon  15-12-1997 - Procedure Request_Popup_Calendar added.
30834>>>>>//         Mon  29-12-1997 - Procedures ItemYear2to4, ItemDate2to4 and
30834>>>>>//                           ItemSysdate added.
30834>>>>>//         Mon  29-12-1997 - Procedures FieldYear2to4, FieldDate2to4 and
30834>>>>>//                           FieldSysdate added.
30834>>>>>//         Sun  01-02-1998 - Functions Module_Compile_Date and
30834>>>>>//                           Module_Compile_Time added.
30834>>>>>//         Wed  25-02-1998 - Request_Popup in calendar object now only
30834>>>>>//                           responds if entry_state of the calling object
30834>>>>>//                           is true (VDF version). (No apparent effect)
30834>>>>>//         Sat  28-03-1998 - Added the following functions:
30834>>>>>//                             TS_SysTime      TS_ExtractDate
30834>>>>>//                             TS_ExtractTime  TS_ConvertToString
30834>>>>>//         Tue  26-05-1998 - Procedure TS_UI_Update added
30834>>>>>//         Sat  01-08-1998 - mask_date_window taken into account
30834>>>>>//         Mon  10-08-1998 - Functions Module_Start_Date and
30834>>>>>//                           Module_Start_Time added.
30834>>>>>//         Wed  02-09-1998 - Parameter for Module_Start_Date removed
30834>>>>>//         Mon  12-10-1998 - Portuguese added
30834>>>>>//         Wed  04-11-1998 - TS_TimeEstimator class added
30834>>>>>//         Tue  29-12-1998 - Function DateAsString added
30834>>>>>//         Wed  13-01-1999 - Function DateWeekNumber changed according to
30834>>>>>//                           Kjetil Johanson
30834>>>>>//         Mon  18-01-1999 - Function DateWeekNumber changed according to
30834>>>>>//                           Kjetil Johanson (again)
30834>>>>>//         Tue  19-01-1999 - Changed procedure names in TS_TimeEstimator
30834>>>>>//                           class (Continue->TS_Continue and Pause->
30834>>>>>//                           TS_Pause)
30834>>>>>//         Thu  21-01-1999 - Procedures DateFormatAsString and DateFormatName
30834>>>>>//                           added.
30834>>>>>//                         - Procedures DateCurrentSeparator and
30834>>>>>//                           DateCurrentFormat added.
30834>>>>>//         Tue  13-04-1999 - Julian constants added: Jan1st1900, Jan1st2000
30834>>>>>//                           Jan1st1000 and Jan1st100
30834>>>>>//         Mon  26-04-1999 - Changed procedure FieldYear2to4 and ItemYear2to4
30834>>>>>//                           to trap 3 digit years.
30834>>>>>//         Wed  27-04-1999 - Changed Dutch abbriviated day names (to 2 characters)
30834>>>>>//         Sun  02-05-1999 - Added function TS_Compose2
30834>>>>>//                         - Fixed error in TS_ConvertToString
30834>>>>>//         Tue  01-06-1999 - Added procedure popup_no_export to calendar.
30834>>>>>//         Thu  15-06-1999 - Fixed Date4to2 function and exporting dates
30834>>>>>//                           from the calendar to forms with no form_margin.
30834>>>>>//         Tue  07-09-1999 - Added function DateAsText
30834>>>>>//         Wed  27-10-1999 - Temporary fix for Module_Compile_Date function
30834>>>>>//                           in combination with y2k.
30834>>>>>//         Wed  19-12-1999 - Function StringToDate added.
30834>>>>>//                         - Existing function DateAsString renamed to
30834>>>>>//                           DateToString.
30834>>>>>//         Mon  03-01-2000 - Fix for VDF4. Popup calendar on empty date field
30834>>>>>//                           would result in seeding the calendar on year 100.
30834>>>>>//                           This error was caused by the fact that VDF 4
30834>>>>>//                           ignores SYSDATE4_STATE such that the sysdate
30834>>>>>//                           command returns 03-01-100
30834>>>>>//         Wed  01-02-2000 - Define instead of #REPLACE
30834>>>>>//         Wed  23-08-2000 - Function TS_Module_Compile_Time added
30834>>>>>//
30834>>>>>// NOTE:  There is language dependent string constants in this file.
30834>>>>>//        Currently there are sections for dutch, english, danish, swedish,
30834>>>>>//        norwegian, spanish, german and portuguese
30834>>>>>//
30834>>>>>//        These sections may be identified by searching the symbol LNG_DEFAULT
30834>>>>>//
30834>>>>>// ***********************************************************************
30834>>>>>
30834>>>>>Use ui
30834>>>>>Use Language    // Set default languange if not set by compiler command line
INCLUDING FILE: LANGUAGE.PKG
30834>>>>>>>// Use Language     // Default language setup
30834>>>>>>>// Sets default languange if not set by compiler command line
30834>>>>>>>
30834>>>>>>>define lng_dutch      for 131
30834>>>>>>>define lng_french     for 133 // NOT TRANSLATED. DO NOT SELECT!
30834>>>>>>>define lng_spanish    for 134
30834>>>>>>>define lng_italian    for 139 // NOT TRANSLATED. DO NOT SELECT!
30834>>>>>>>define lng_english    for 144
30834>>>>>>>define lng_danish     for 145
30834>>>>>>>define lng_swedish    for 146
30834>>>>>>>define lng_norwegian  for 147
30834>>>>>>>define lng_Greek    for 148
30834>>>>>>>define lng_german     for 149
30834>>>>>>>define lng_portuguese for 155
30834>>>>>>>define lng_papiamentu for 199 // NOT TRANSLATED. DO NOT SELECT!
30834>>>>>>>
30834>>>>>>>
30834>>>>>>>define lng_default for !@
30834>>>>>>>
30834>>>>>>>  define _LANGUAGE_ for $ENGLISH$
30834>>>>>>>
#REM LANGUAGE SET BY LANGUAGE.PKG: $ENGLISH$
30834>>>>>Use Seq_Chnl    // Defines global sequential device management operations (DAC)
30834>>>>>Use Macros.utl  // Various macros (DESKTOP_SECTION)
INCLUDING FILE: MACROS.UTL
30834>>>>>>>// Use Macros.utl   // Various macros (FOR_EX...)
30834>>>>>>>
30834>>>>>>>//  FOR_EX (extended FOR command)
30834>>>>>>>//  -----------------------------
30834>>>>>>>//> The FOR_EX command is exactly like the standard FOR command except
30834>>>>>>>//> that it will allow you to use keyword "DOWN_TO" instead of "TO" if
30834>>>>>>>//> you need to do a decremental loop.
30834>>>>>>>
30834>>>>>>>
30834>>>>>>>//  DESKTOP_SECTION
30834>>>>>>>//  ---------------
30834>>>>>>>//> The DESKTOP_SECTION/END_DESKTOP_SECTION commands will make a sequence of
30834>>>>>>>//> code compile (or rather instantiate) as if it was situated on the DESKTOP
30834>>>>>>>//> even when it isn't. DESKTOP_SECTION's may not be nested.
30834>>>>>>>
30834>>>>>>>
30834>>>>>>>
30834>>>>>
30834>>>>>// Switches
30834>>>>>
30834>>>>>define DATES_INCLUDE_POPUP for 1   // If set to 0 the popup calendar will not be included
30834>>>>>define DATES_DF31B_EPOCH   for 40  // DF3.1b didn't have an epoch setting. Therefore this symbol defines the epoch value for that version.
30834>>>>>
30834>>>>> define t.calendar.year           for "Year"
30834>>>>> define t.calendar.month          for "Month"
30834>>>>> define t.calendar.day            for "Day"
30834>>>>> define t.calendar.week           for "Wk."
30834>>>>> define t.calendar.calendar_popup for "Calendar Popup"
30834>>>>> define t.calendar.Monday         for "Monday"
30834>>>>> define t.calendar.Tuesday        for "Tuesday"
30834>>>>> define t.calendar.Wednesday      for "Wednesday"
30834>>>>> define t.calendar.Thursday       for "Thursday"
30834>>>>> define t.calendar.Friday         for "Friday"
30834>>>>> define t.calendar.Saturday       for "Saturday"
30834>>>>> define t.calendar.Sunday         for "Sunday"
30834>>>>> define t.calendar.January        for "January"
30834>>>>> define t.calendar.February       for "February"
30834>>>>> define t.calendar.March          for "March"
30834>>>>> define t.calendar.April          for "April"
30834>>>>> define t.calendar.May            for "May"
30834>>>>> define t.calendar.June           for "June"
30834>>>>> define t.calendar.July           for "July"
30834>>>>> define t.calendar.August         for "August"
30834>>>>> define t.calendar.September      for "September"
30834>>>>> define t.calendar.October        for "October"
30834>>>>> define t.calendar.November       for "November"
30834>>>>> define t.calendar.December       for "December"
30834>>>>> define t.calendar.ok             for "OK"
30834>>>>> define t.calendar.Cancel         for "Cancel"
30834>>>>> define t.calendar.Activate       for "Activate popup calendar (Ctrl+D)"
30834>>>>>
30834>>>>>define LargestPossibleDate for 913490 // December 31st 2500
30834>>>>>define Jan1st1900          for 693975
30834>>>>>define Jan1st2000          for 730500
30834>>>>>define Jan1st1000          for 365250
30834>>>>>define Jan1st105           for 38352
30834>>>>>define Jan1st100           for 36525
30834>>>>>
30834>>>>>enumeration_list // Date Segments
30834>>>>>  define DS_DAY
30834>>>>>  define DS_WEEK
30834>>>>>  define DS_MONTH
30834>>>>>  define DS_YEAR
30834>>>>>end_enumeration_list
30834>>>>>
30834>>>>>integer Dates$Year Dates$Month Dates$Day // internal use
30834>>>>>
30834>>>>>procedure DateDecompose global date date# //very internal!!
30835>>>>>  local integer pos1# pos2# format#
30836>>>>>  local string str# sep#
30836>>>>>  get_attribute DF_DATE_FORMAT to format#
30839>>>>>  get_attribute DF_DATE_SEPARATOR to pos1# // overload
30842>>>>>  character pos1# to sep#                  // end overload
30843>>>>>>
30843>>>>>  move date# to str#
30844>>>>>  replace sep# in str# with "$"
30846>>>>>  move strmark to pos1#
30847>>>>>  if [found] begin
30849>>>>>    replace sep# in str# with "$"
30851>>>>>    move strmark to pos2#
30852>>>>>  end
30852>>>>>>
30852>>>>>  else begin
30853>>>>>    move 0 to Dates$Year
30854>>>>>    move 0 to Dates$Month
30855>>>>>    move 0 to Dates$Day
30856>>>>>  end
30856>>>>>>
30856>>>>>  [ found] begin
30858>>>>>>
30858>>>>>    if format# eq DF_DATE_EUROPEAN ;          left str# to Dates$Day    (pos1#-1)
30862>>>>>    if format# eq DF_DATE_USA begin
30864>>>>>          mid  str# to Dates$Day    (pos2#-pos1#-1) (pos1#+1)
30867>>>>>>
30867>>>>>          left str# to Dates$Month  (pos1#-1)
30869>>>>>>
30869>>>>>    end
30869>>>>>>
30869>>>>>    else  mid  str# to Dates$Month  (pos2#-pos1#-1) (pos1#+1)
30873>>>>>
30873>>>>>    if format# eq DF_DATE_MILITARY begin
30875>>>>>          mid  str# to Dates$Day  2 (pos2#+1)
30878>>>>>>
30878>>>>>          left str# to Dates$Year   (pos1#-1)
30880>>>>>>
30880>>>>>    end
30880>>>>>>
30880>>>>>    else  mid  str# to Dates$Year 4 (pos2#+1)
30884>>>>>  end
30884>>>>>>
30884>>>>>end_procedure
30885>>>>>
30885>>>>>function DateCompose global integer day# integer month# integer year# returns date
30886>>>>>  local integer format#
30887>>>>>  local date date#
30887>>>>>  local string sep#
30887>>>>>  ifnot (day#*month#*year#) function_return 0
30890>>>>>  get_attribute DF_DATE_SEPARATOR to format# // overload
30893>>>>>  character format# to sep#                  // end overload
30894>>>>>>
30894>>>>>  get_attribute DF_DATE_FORMAT to format#
30897>>>>>  if day# gt 28 begin
30899>>>>>    if format# eq DF_DATE_EUROPEAN move (date(string(day#)+sep#+string(month#)+sep#+string(year#))) to date# // DMY
30902>>>>>    if format# eq DF_DATE_USA      move (date(string(month#)+sep#+string(day#)+sep#+string(year#))) to date# // MDY
30905>>>>>    if format# eq DF_DATE_MILITARY move (date(string(year#)+sep#+string(month#)+sep#+string(day#))) to date# // YMD
30908>>>>>    send DateDecompose date#
30909>>>>>    if Dates$Month ne month# move (day#-Dates$Day) to day#
30912>>>>>  end
30912>>>>>>
30912>>>>>  if format# eq DF_DATE_EUROPEAN function_return (date(string(day#)+sep#+string(month#)+sep#+string(year#))) // DMY
30915>>>>>  if format# eq DF_DATE_USA function_return (date(string(month#)+sep#+string(day#)+sep#+string(year#))) // MDY
30918>>>>>  function_return (date(string(year#)+sep#+string(month#)+sep#+string(day#))) // YMD
30919>>>>>end_function
30920>>>>>
30920>>>>>function DateFormatName global integer format# returns string
30921>>>>>  if format# eq DF_DATE_EUROPEAN function_return "European"
30924>>>>>  if format# eq DF_DATE_USA      function_return "United States"
30927>>>>>  if format# eq DF_DATE_MILITARY function_return "Military"
30930>>>>>end_function
30931>>>>>
30931>>>>>function DateCurrentSeparator global returns string
30932>>>>>  local integer rval#
30933>>>>>  get_attribute DF_DATE_SEPARATOR to rval#
30936>>>>>  function_return (character(rval#))
30937>>>>>end_function
30938>>>>>
30938>>>>>function DateCurrentFormat global returns integer
30939>>>>>  local integer rval#
30940>>>>>  get_attribute DF_DATE_FORMAT to rval#
30943>>>>>  function_return rval#
30944>>>>>end_function
30945>>>>>
30945>>>>>function DateFormatAsString global integer format# integer long# string sep# returns string
30946>>>>>  local string rval# letter#
30947>>>>>  if format# eq DF_DATE_EUROPEAN move "3342241111" to rval#
30950>>>>>  if format# eq DF_DATE_USA      move "2243341111" to rval#
30953>>>>>  if format# eq DF_DATE_MILITARY move "1111422433" to rval#
30956>>>>>  left t.calendar.year to letter# 1
30958>>>>>>
30958>>>>>  replace "1" in rval# with letter#
30960>>>>>  replace "1" in rval# with letter#
30962>>>>>  ifnot long# move "" to letter#
30965>>>>>  move (replaces("1",rval#,letter#)) to rval#
30966>>>>>  move (replaces("2",rval#,left(t.calendar.month,1))) to rval#
30967>>>>>  move (replaces("3",rval#,left(t.calendar.day,1))) to rval#
30968>>>>>  if sep# eq "" begin
30970>>>>>    get_attribute DF_DATE_SEPARATOR to format#
30973>>>>>    character format# to sep#
30974>>>>>>
30974>>>>>  end
30974>>>>>>
30974>>>>>  move (replaces("4",rval#,sep#)) to rval#
30975>>>>>  function_return rval#
30976>>>>>end_function
30977>>>>>
30977>>>>>function StringToDate global string date# integer format# integer four_digit_year# string sep# returns date
30978>>>>>  local integer sep_len# day# month# year#
30979>>>>>  move (length(sep#)) to sep_len#
30980>>>>>  if four_digit_year# move 4 to four_digit_year#
30983>>>>>  else move 2 to four_digit_year#
30985>>>>>  if format# eq DF_DATE_EUROPEAN begin // DMY
30987>>>>>    move (mid(date#,2,1)) to day#
30988>>>>>    move (mid(date#,2,3+sep_len#)) to month#
30989>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
30990>>>>>  end
30990>>>>>>
30990>>>>>  if format# eq DF_DATE_USA begin // MDY
30992>>>>>    move (mid(date#,2,1)) to month#
30993>>>>>    move (mid(date#,2,3+sep_len#)) to year#
30994>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
30995>>>>>  end
30995>>>>>>
30995>>>>>  if format# eq DF_DATE_MILITARY begin // YMD
30997>>>>>    move (mid(date#,four_digit_year#,1)) to year#
30998>>>>>    move (mid(date#,2,1+four_digit_year#+sep_len#)) to month#
30999>>>>>    move (mid(date#,2,3+four_digit_year#+sep_len#+sep_len#)) to day#
31000>>>>>  end
31000>>>>>>
31000>>>>>  function_return (DateCompose(day#,month#,year#))
31001>>>>>end_function
31002>>>>>
31002>>>>>function DateToString global date date# integer format# integer four_digit_year# string sep# returns string
31003>>>>>  local string rval# day# month# year#
31004>>>>>  get Date2to4 date# to date#
31005>>>>>  if (integer(date#)) begin
31007>>>>>    send DateDecompose date#
31008>>>>>    move Dates$Day to day#
31009>>>>>    if Dates$Day lt 10 insert "0" in day# at 1
31013>>>>>    move Dates$Month to month#
31014>>>>>    if Dates$Month lt 10 insert "0" in month# at 1
31018>>>>>    move Dates$Year to year#
31019>>>>>    ifnot four_digit_year# move (right(year#,2)) to year#
31022>>>>>    if format# eq DF_DATE_EUROPEAN move (day#+sep#+month#+sep#+year#) to rval# // DMY
31025>>>>>    if format# eq DF_DATE_USA      move (month#+sep#+day#+sep#+year#) to rval# // MDY
31028>>>>>    if format# eq DF_DATE_MILITARY move (year#+sep#+month#+sep#+day#) to rval# // YMD
31031>>>>>  end
31031>>>>>>
31031>>>>>  function_return rval#
31032>>>>>end_function
31033>>>>>
31033>>>>>// Function DateAsString is only here for compatibility with earlier versions.
31033>>>>>// Use function DateToString instead.
31033>>>>>function DateAsString global date date# integer format# integer four_digit_year# string sep# returns string
31034>>>>>  function_return (DateToString(date#,format#,four_digit_year#,sep#))
31035>>>>>end_function
31036>>>>>
31036>>>>>function DateIncrement global date date# integer segment# integer amount# returns date
31037>>>>>  if (date#=0) function_return 0
31040>>>>>  if segment# eq DS_WEEK function_return (date#+(amount#*7)) //weeks
31043>>>>>  if (segment#<>DS_DAY) begin // months or years
31045>>>>>    send DateDecompose date#
31046>>>>>    if segment# eq DS_MONTH begin //months
31048>>>>>      move (Dates$Month+amount#) to Dates$Month
31049>>>>>      if amount# ge 0 function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-1)/12)*12),Dates$Year+((Dates$Month-1)/12)))
31052>>>>>      function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-12)/12)*12),Dates$Year+((Dates$Month-12)/12)))
31053>>>>>    end //years:
31053>>>>>>
31053>>>>>    if segment# eq DS_YEAR function_return (DateCompose(Dates$Day,Dates$Month,Dates$Year+amount#))
31056>>>>>  end
31056>>>>>>
31056>>>>>  else function_return (date#+amount#) //days
31058>>>>>end_function
31059>>>>>
31059>>>>>function DateSegment global date date# integer segment# returns integer
31060>>>>>  send DateDecompose date#
31061>>>>>  if segment# eq DS_DAY   function_return Dates$Day
31064>>>>>  if segment# eq DS_MONTH function_return Dates$Month
31067>>>>>  if segment# eq DS_YEAR  function_return Dates$Year
31070>>>>>end_function
31071>>>>>
31071>>>>>function DateToInteger global date date# returns integer
31072>>>>>  send DateDecompose date#
31073>>>>>  function_return (Dates$Year*100+Dates$Month*100+Dates$Day)
31074>>>>>end_function
31075>>>>>
31075>>>>>function FirstDayInMonth global date date# returns date
31076>>>>>  local integer month# year#
31077>>>>>  move (DateSegment(date#,DS_MONTH)) to month#
31078>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31079>>>>>  function_return (DateCompose(1,month#,year#))
31080>>>>>end_function
31081>>>>>
31081>>>>>function LastDayInMonth global date date# returns date
31082>>>>>  move (DateIncrement(date#,DS_MONTH,1)) to date#
31083>>>>>  function_return (FirstDayInMonth(date#)-1)
31084>>>>>end_function
31085>>>>>
31085>>>>>function FirstDayInYear global date date# returns date
31086>>>>>  local integer year#
31087>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31088>>>>>  function_return (DateCompose(1,1,year#))
31089>>>>>end_function
31090>>>>>
31090>>>>>function LastDayInYear global date date# returns date
31091>>>>>  move (DateIncrement(date#,DS_YEAR,1)) to date#
31092>>>>>  function_return (FirstDayInYear(date#)-1)
31093>>>>>end_function
31094>>>>>
31094>>>>>// Prior to 18/1-99 version of DateWeekNumber
31094>>>>>//function DateWeekNumber global date date# returns integer
31094>>>>>//  local integer week# first_wd# day_of_year# year#
31094>>>>>//  if (date#=0) function_return 0
31094>>>>>//  get Date2to4 date# to date#
31094>>>>>//  move (DateSegment(date#,DS_YEAR)) to year#
31094>>>>>//  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31094>>>>>//  move (date#-FirstDayInYear(date#)) to day_of_year#
31094>>>>>//  move (day_of_year#-1-7+first_wd#) to day_of_year#
31094>>>>>//  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31094>>>>>//  else move 0 to week#
31094>>>>>//  if first_wd# le 4 increment week#
31094>>>>>//  if week# gt 52 begin
31094>>>>>//    move 1 to week#
31094>>>>>//    if first_wd# eq 4 move 53 to week#
31094>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31094>>>>>//  end
31094>>>>>//  if week# eq 0 begin
31094>>>>>//    //get DateWeekNumber (DateIncrement(date#,DS_YEAR,-1)) to first_wd# // Original line
31094>>>>>//    get DateDayNumber  (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#ÿ // changed line
31094>>>>>//    move 52 to week#
31094>>>>>//    if first_wd# eq 4 move 53 to week#
31094>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31094>>>>>//  end
31094>>>>>//  function_return week#
31094>>>>>//end_function
31094>>>>>
31094>>>>>function DateWeekNumber global date date# returns integer
31095>>>>>  local integer week# first_wd# day_of_year# year# wd#
31096>>>>>  if (date#=0) function_return 0
31099>>>>>  get Date2to4 date# to date#
31100>>>>>  // Leap-year test for actual or previous year
31100>>>>>  // Year# only used for selection between 52 and
31100>>>>>  // Therefore get year# from the first day of actual week
31100>>>>>  get DateDayNumber date# to wd#
31101>>>>>  move (DateSegment(date#-wd#+1,DS_YEAR)) to year#
31102>>>>>
31102>>>>>  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31103>>>>>  move (date#-FirstDayInYear(date#)) to day_of_year#
31104>>>>>  move (day_of_year#-1-7+first_wd#) to day_of_year#
31105>>>>>  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31108>>>>>  else move 0 to week#
31110>>>>>  if first_wd# le 4 increment week#
31113>>>>>  if week# gt 52 begin
31115>>>>>    move 1 to week#
31116>>>>>    if first_wd# eq 4 move 53 to week#
31119>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31126>>>>>  end
31126>>>>>>
31126>>>>>  if week# eq 0 begin
31128>>>>>    // Week 52 or 53
31128>>>>>    get DateDayNumber (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#
31129>>>>>    move 52 to week#
31130>>>>>    if first_wd# eq 4 move 53 to week#
31133>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31140>>>>>  end
31140>>>>>>
31140>>>>>  function_return week#
31141>>>>>end_function
31142>>>>>
31142>>>>>function DayName global integer int# returns string
31143>>>>>  if int# eq 1 function_return t.calendar.Monday
31146>>>>>  if int# eq 2 function_return t.calendar.Tuesday
31149>>>>>  if int# eq 3 function_return t.calendar.Wednesday
31152>>>>>  if int# eq 4 function_return t.calendar.Thursday
31155>>>>>  if int# eq 5 function_return t.calendar.Friday
31158>>>>>  if int# eq 6 function_return t.calendar.Saturday
31161>>>>>  if int# eq 7 function_return t.calendar.Sunday
31164>>>>>  function_return ""
31165>>>>>end_function
31166>>>>>
31166>>>>>function DateDayNumber global date date# returns integer
31167>>>>>  local integer rval# // 1=Monday, ... , 7=Sunday
31168>>>>>  get Date2to4 date# to date#
31169>>>>>  move date# to rval#
31170>>>>>  if rval# begin
31172>>>>>    if rval# gt 693975 move (rval#-2) to rval#
31175>>>>>    move (rval#-((rval#/7)*7)) to rval#
31176>>>>>    if rval# eq 0 move 7 to rval#
31179>>>>>  end
31179>>>>>>
31179>>>>>  function_return rval#
31180>>>>>end_function
31181>>>>>
31181>>>>>function DateDayName global date date# returns string
31182>>>>>  function_return (DayName(DateDayNumber(date#)))
31183>>>>>end_function
31184>>>>>
31184>>>>>function YearMaxWeek global integer year# returns integer
31185>>>>>  local integer wk1# wk2#
31186>>>>>  get DateWeekNumber (DateCompose(31,12,year#)) to wk1#
31187>>>>>  get DateWeekNumber (DateCompose(24,12,year#)) to wk2#
31188>>>>>  function_return (wk1# max wk2#)
31189>>>>>end_function
31190>>>>>
31190>>>>>function WeekToDate global integer year# integer week# returns date
31191>>>>>  local date date#
31192>>>>>  move (DateCompose(1,1,year#)) to date#
31193>>>>>  if (DateWeekNumber(date#)) ne 1 move (date#+7) to date# // week 52 or 53
31196>>>>>  move (date#-DateDayNumber(date#)+1) to date# // Now it's a Monday
31197>>>>>  function_return (week#-1*7+date#)
31198>>>>>end_function
31199>>>>>
31199>>>>>function MonthName global integer int# returns string
31200>>>>>  if int# eq  1 function_return t.calendar.January
31203>>>>>  if int# eq  2 function_return t.calendar.February
31206>>>>>  if int# eq  3 function_return t.calendar.March
31209>>>>>  if int# eq  4 function_return t.calendar.April
31212>>>>>  if int# eq  5 function_return t.calendar.May
31215>>>>>  if int# eq  6 function_return t.calendar.June
31218>>>>>  if int# eq  7 function_return t.calendar.July
31221>>>>>  if int# eq  8 function_return t.calendar.August
31224>>>>>  if int# eq  9 function_return t.calendar.September
31227>>>>>  if int# eq 10 function_return t.calendar.October
31230>>>>>  if int# eq 11 function_return t.calendar.November
31233>>>>>  if int# eq 12 function_return t.calendar.December
31236>>>>>  function_return ""
31237>>>>>end_function
31238>>>>>
31238>>>>>function DateMonthName global date date# returns string
31239>>>>>  function_return (MonthName(DateSegment(date#,DS_MONTH)))
31240>>>>>end_function
31241>>>>>
31241>>>>>function DateAsText global date date# string format# returns string
31242>>>>>  if date# eq 0 function_return ""
31245>>>>>  move (replace("#DN",format#,DateDayName(date#)))                  to format#
31246>>>>>  move (replace("#MN",format#,DateMonthName(date#)))                to format#
31247>>>>>  move (replace("#D" ,format#,string(DateSegment(date#,DS_DAY))))   to format#
31248>>>>>  move (replace("#Y" ,format#,string(DateSegment(date#,DS_YEAR))))  to format#
31249>>>>>  move (replace("#M" ,format#,string(DateSegment(date#,DS_MONTH)))) to format#
31250>>>>>  function_return format#
31251>>>>>end_function
31252>>>>>
31252>>>>>function Year2to4 global integer year# returns integer
31253>>>>>  local integer epoch_value#
31254>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31255>>>>>  if year# lt 100 begin
31257>>>>>    if year# gt epoch_value# function_return (year#+1900)
31260>>>>>    function_return (year#+2000)
31261>>>>>  end
31261>>>>>>
31261>>>>>  function_return year# // No conversion done!
31262>>>>>end_function
31263>>>>>
31263>>>>>function Date2to4 global date date# returns date
31264>>>>>  local integer epoch_value#
31265>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31266>>>>>  if date# gt 0 begin // Only if there is a date to convert
31268>>>>>    if (DateSegment(date#,DS_YEAR)) lt 105 begin
31270>>>>>      if Dates$Year gt epoch_value# function_return (DateIncrement(date#,DS_YEAR,1900))
31273>>>>>      function_return (DateIncrement(date#,DS_YEAR,2000))
31274>>>>>    end
31274>>>>>>
31274>>>>>    function_return date# // No conversion done!
31275>>>>>  end
31275>>>>>>
31275>>>>>end_function
31276>>>>>
31276>>>>>function Date4to2 global date date# returns date
31277>>>>>  local integer epoch_value# year#
31278>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31279>>>>>  if date# gt 0 begin // Only if there is a date to convert
31281>>>>>    move (DateSegment(date#,DS_YEAR)) to year#
31282>>>>>    if year# ge 100 begin // Only then conversion is needed!
31284>>>>>      if (year#>=(1900+epoch_value#) and year#<(2000+epoch_value#)) begin
31286>>>>>        if year# lt 2000 function_return (DateIncrement(date#,DS_YEAR,-1900))
31289>>>>>        else             function_return (DateIncrement(date#,DS_YEAR,-2000))
31291>>>>>      end
31291>>>>>>
31291>>>>>      else error 301 "Date is out of epoch range"
31293>>>>>    end
31293>>>>>>
31293>>>>>  end
31293>>>>>>
31293>>>>>  function_return date# // No conversion done!
31294>>>>>end_function
31295>>>>>
31295>>>>>function dSysDate global returns date
31296>>>>>  local date date#
31297>>>>>  sysdate4 date#
31298>>>>>  function_return date#
31299>>>>>end_function
31300>>>>>
31300>>>>>function iSysYear global returns integer
31301>>>>>  local date date#
31302>>>>>  sysdate4 date#
31303>>>>>  function_return (DateSegment(date#,DS_YEAR))
31304>>>>>end_function
31305>>>>>
31305>>>>>procedure ItemSysdate for desktop integer itm#
31306>>>>>  local date date#
31307>>>>>  get value item itm# to date#
31308>>>>>  if date# eq 0 begin
31310>>>>>    sysdate4 date#
31311>>>>>    set changed_value item itm# to date#
31312>>>>>  end
31312>>>>>>
31312>>>>>end_procedure
31313>>>>>
31313>>>>>procedure ItemDate2to4 for desktop integer itm#
31314>>>>>  local integer year#
31315>>>>>  local date date# new_date#
31315>>>>>  get value item itm# to date#
31316>>>>>
31316>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31317>>>>>  if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31320>>>>>  else move date# to new_date#
31322>>>>>
31322>>>>>  move (Date2to4(new_date#)) to new_date#
31323>>>>>  move (DateSegment(new_date#,3)) to year#
31324>>>>>  if (year#>99 and year#<1000) begin
31326>>>>>    error 15 // Illegal entry in this window
31327>>>>>>
31327>>>>>    procedure_return 1
31328>>>>>  end
31328>>>>>>
31328>>>>>  if new_date# ne date# set value item itm# to new_date#
31331>>>>>end_procedure
31332>>>>>
31332>>>>>procedure ItemYear2to4 for desktop integer itm#
31333>>>>>  local integer year# new_year#
31334>>>>>  get value item itm# to year#
31335>>>>>  if (year#>99 and year#<1000) begin
31337>>>>>    error 15 // Illegal entry in this window
31338>>>>>>
31338>>>>>    procedure_return 1
31339>>>>>  end
31339>>>>>>
31339>>>>>  move (Year2to4(year#)) to new_year#
31340>>>>>  if new_year# ne year# set value item itm# to new_year#
31343>>>>>end_procedure
31344>>>>>
31344>>>>> procedure FieldSysdate for DataDictionary integer fld#
31345>>>>>   local date date#
31346>>>>>   get field_current_value fld# to date#
31347>>>>>   if date# eq 0 begin
31349>>>>>     sysdate4 date#
31350>>>>>     set field_changed_value fld# to date#
31351>>>>>   end
31351>>>>>>
31351>>>>> end_procedure
31352>>>>>
31352>>>>> procedure FieldDate2to4 for DataDictionary integer fld#
31353>>>>>   local integer year#
31354>>>>>   local date date# new_date#
31354>>>>>   get field_current_value fld# to date#
31355>>>>>
31355>>>>>   move (DateSegment(date#,DS_YEAR)) to year#
31356>>>>>   if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31359>>>>>   else move date# to new_date#
31361>>>>>
31361>>>>>   move (Date2to4(new_date#)) to new_date#
31362>>>>>   move (DateSegment(new_date#,3)) to year#
31363>>>>>   if (year#>99 and year# <=999) begin
31365>>>>>     error 15 // Illegal entry in this window
31366>>>>>>
31366>>>>>     procedure_return 1
31367>>>>>   end
31367>>>>>>
31367>>>>>   if new_date# ne date# set field_changed_value fld# to new_date#
31370>>>>> end_procedure
31371>>>>>
31371>>>>> procedure FieldYear2to4 for DataDictionary integer fld#
31372>>>>>   local integer year# new_year# changed#
31373>>>>>   get field_current_value fld# to year#
31374>>>>>   get field_changed_state fld# to changed#
31375>>>>>   if changed# begin
31377>>>>>     if (year#>99 and year#<1000) begin
31379>>>>>       error 15 // Illegal entry in this window
31380>>>>>>
31380>>>>>       procedure_return 1
31381>>>>>     end
31381>>>>>>
31381>>>>>     move (Year2to4(year#)) to new_year#
31382>>>>>     if new_year# ne year# set field_changed_value fld# to new_year#
31385>>>>>   end
31385>>>>>>
31385>>>>> end_procedure
31386>>>>>
31386>>>>> function SysDate global returns date
31387>>>>>   function_return (dSysDate())
31388>>>>> end_function
31389>>>>>
31389>>>>>function sSysTime global returns string
31390>>>>>  local integer h# m# s#
31391>>>>>  sysdate4 h# h# m# s#
31395>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31396>>>>>end_function
31397>>>>>
31397>>>>>function TS_SysTime global returns number
31398>>>>>  local integer d# h# m# s#
31399>>>>>  sysdate4 d# h# m# s#
31403>>>>>  function_return (d#*24.0+h#*60+m#*60+s#)
31404>>>>>end_function
31405>>>>>
31405>>>>>//> This function returns a TS value composed from the date and time
31405>>>>>//> passed to it. Note that the time variable must be of the format
31405>>>>>//> "hh:mm:ss".
31405>>>>>function TS_Compose global date date# string time# returns number
31406>>>>>  local integer h# m# s#
31407>>>>>  left time# to h# 2
31409>>>>>>
31409>>>>>  mid time# to m# 2 4
31412>>>>>>
31412>>>>>  mid time# to s# 2 7
31415>>>>>>
31415>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31416>>>>>end_function
31417>>>>>
31417>>>>>function TS_Compose2 global date date# integer h# integer m# integer s# returns number
31418>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31419>>>>>end_function
31420>>>>>
31420>>>>>function TS_ExtractDate global number time# returns date
31421>>>>>  function_return (time#/86400) // 86400=24*60*60
31422>>>>>end_function
31423>>>>>
31423>>>>>function TS_ExtractTime global number time# returns string
31424>>>>>  local integer h# m# s#
31425>>>>>  move (time#-(86400.0*integer(TS_ExtractDate(time#)))) to s#
31426>>>>>  move (s#/3600) to h#
31427>>>>>  move (s#-(h#*3600)) to s#
31428>>>>>  move (s#/60) to m#
31429>>>>>  move (s#-(m#*60)) to s#
31430>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31431>>>>>end_function
31432>>>>>
31432>>>>>function TS_ConvertToString global number time# returns string
31433>>>>>  local date d#
31434>>>>>  move (TS_ExtractDate(time#)) to d#
31435>>>>>  if (integer(d#)) function_return (string(d#)+" "+TS_ExtractTime(time#))
31438>>>>>  else function_return (TS_ExtractTime(time#))
31440>>>>>end_function
31441>>>>>
31441>>>>>function TS_ConvertToStringNoDate global number ts# returns string
31442>>>>>  local integer h# m#
31443>>>>>  move (ts#/3600) to h#
31444>>>>>  move (ts#-(h#*3600)) to ts#
31445>>>>>  move (ts#/60) to m#
31446>>>>>  move (ts#-(m#*60)) to ts#
31447>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(ts#<10,"0","")+string(ts#))
31448>>>>>end_function
31449>>>>>
31449>>>>>// This procedure is used when a TS-variable must be displayed on screen.
31449>>>>>procedure TS_UI_Update global number TS# integer obj1# integer itm1# integer tmp_obj2# integer tmp_itm2#
31450>>>>>  local integer obj2# itm2#
31451>>>>>  if num_arguments gt 3 begin
31453>>>>>    move tmp_obj2# to obj2#
31454>>>>>    move tmp_itm2# to itm2#
31455>>>>>  end
31455>>>>>>
31455>>>>>  else begin
31456>>>>>    move obj1# to obj2#
31457>>>>>    move (itm1#+1) to itm2#
31458>>>>>  end
31458>>>>>>
31458>>>>>  set value of obj1# item itm1# to (TS_ExtractDate(TS#))
31459>>>>>  set value of obj2# item itm2# to (TS_ExtractTime(TS#))
31460>>>>>end_procedure
31461>>>>>
31461>>>>>class TS_TimeEstimator is an array
31462>>>>>  procedure construct_object
31463>>>>>    forward send construct_object
31465>>>>>    set delegation_mode to delegate_to_parent
31466>>>>>    property number  pnTotal   public 0 // Seconds needed to run the loop.
31467>>>>>    property number  pnElapsed public 0 // Seconds elapsed so far.
31468>>>>>    property number  pnLeft    public 0 // Number of seconds left
31469>>>>>    property number  pnStart   public 0
31470>>>>>    property number  pnPause   public 0
31471>>>>>    property number  pnPercent public 0
31472>>>>>    property integer piMin     public 0
31473>>>>>    property integer piMax     public 0
31474>>>>>  end_procedure
31475>>>>>
31475>>>>>  procedure TS_Start integer min# integer max#
31476>>>>>    set piMin to min#
31477>>>>>    set piMax to max#
31478>>>>>    set pnStart to (TS_SysTime())
31479>>>>>    set pnElapsed to 0
31480>>>>>    set pnPercent to 0
31481>>>>>  end_procedure
31482>>>>>
31482>>>>>  procedure TS_Calculate integer pos#
31483>>>>>    local integer min# max#
31484>>>>>    get piMin to min#
31485>>>>>    get piMax to max#
31486>>>>>    set pnElapsed to (TS_SysTime()-pnStart(current_object))
31487>>>>>    set pnTotal   to (pnElapsed(current_object)*(max#-min#)/number(pos#-min#))
31488>>>>>    set pnLeft    to (pnTotal(current_object)-pnElapsed(current_object))
31489>>>>>    set pnPercent to (100.0*(pos#-min#)/(max#-min#))
31490>>>>>  end_procedure
31491>>>>>
31491>>>>>  procedure TS_Pause
31492>>>>>    set pnPause to (TS_SysTime())
31493>>>>>  end_procedure
31494>>>>>
31494>>>>>  procedure TS_Continue
31495>>>>>    set pnStart to (pnStart(current_object)+TS_SysTime()-pnPause(current_object))
31496>>>>>  end_procedure
31497>>>>>end_class
31498>>>>>
31498>>>>>function TS_Module_Compile_Time global string path# returns number
31499>>>>>  local integer pos# day# month# year# seqeof# ch#
31500>>>>>  local string date# str# time#
31500>>>>>  move path# to str#
31501>>>>>  if str# ne "" begin
31503>>>>>    get Seq_New_Channel to ch#   // This method and Seq_Release_Channel are
31504>>>>>    send Seq_Release_Channel ch# // We only need it for a second
31505>>>>>      direct_input channel ch# (trim(str#)+".vd6") // VDF 6
31507>>>>>      [seqeof] direct_input channel ch# (trim(str#)+".vd5") // VDF 5
31509>>>>>    [ seqeof] move 1 to seqeof#
31510>>>>>    [~seqeof] move 0 to seqeof#
31511>>>>>    [~seqeof] readln str#
31512>>>>>    close_input channel ch#
31514>>>>>  end
31514>>>>>>
31514>>>>>  if seqeof# function_return 0
31517>>>>>  pos "," in str# to pos#
31519>>>>>>
31519>>>>>  move (mid(str#,18,pos#+2)) to str#
31520>>>>>  move (integer(mid(str#,2,4))) to day#
31521>>>>>  move (integer(mid(str#,2,1))) to month#
31522>>>>>  move (integer(mid(str#,2,7))) to year#
31523>>>>>  if year# eq 10 begin
31525>>>>>    move (integer(mid(str#,3,7))+1900) to year#
31526>>>>>    move (mid(str#,8,11)) to str#
31527>>>>>  end
31527>>>>>>
31527>>>>>  else move (mid(str#,8,10)) to str#
31529>>>>>  move (DateCompose(day#,month#,year#)) to date#
31530>>>>>  move (Date2to4(date#)) to date#
31531>>>>>  pos ":" in str# to pos#
31533>>>>>>
31533>>>>>  function_return (TS_Compose(date#,mid(str#,8,pos#-2)))
31534>>>>>end_function
31535>>>>>
31535>>>>>string Dates$Module_Compile_Time
31535>>>>>move "" to Dates$Module_Compile_Time
31536>>>>>
31536>>>>>function Module_Compile_Date global returns date
31537>>>>>  local number ts#
31538>>>>>  local string str#
31538>>>>>  get module_name to str# // 'module_name' is most likely the name of the .flx file.
31539>>>>>  get TS_Module_Compile_Time str# to ts#
31540>>>>>  move (TS_ExtractTime(ts#)) to Dates$Module_Compile_Time
31541>>>>>  function_return (TS_ExtractDate(ts#))
31542>>>>>end_function
31543>>>>>
31543>>>>>function Module_Compile_Time global returns string
31544>>>>>  local date grb#
31545>>>>>  // Module_Compile_Date must be called before this one!
31545>>>>>  if Dates$Module_Compile_Time eq "" move (Module_Compile_Date()) to grb#
31548>>>>>  function_return Dates$Module_Compile_Time
31549>>>>>end_function
31550>>>>>
31550>>>>>date   Dates$ModuleStartDate
31550>>>>>string Dates$ModuleStartTime 8
31550>>>>>move (dSysDate()) to Dates$ModuleStartDate
31551>>>>>move (sSysTime()) to Dates$ModuleStartTime
31552>>>>>
31552>>>>>function Module_Start_Date global returns date
31553>>>>>  function_return Dates$ModuleStartDate
31554>>>>>end_function
31555>>>>>
31555>>>>>function Module_Start_Time global returns string
31556>>>>>  function_return Dates$ModuleStartTime
31557>>>>>end_function
31558>>>>>
31558>>>>> register_procedure NotifyPopupCalendarChange date date#
31558>>>>> register_procedure NotifyPopupCalendarSelect date date#
31558>>>>>  use dfAllent
31558>>>>>  class calendar.textbox is a textbox
31559>>>>>    procedure construct_object
31560>>>>>      forward send construct_object
31562>>>>>      Set Auto_Size_State To False
31563>>>>>      Set Justification_Mode To (jMode_vCenter+jMode_Center)
31564>>>>>    end_procedure
31565>>>>>  end_class
31566>>>>>
31566>>>>>  register_object btn1
31566>>>>>  register_object btn6
31566>>>>>
31566>>>>>  class calendar.button is a button
31567>>>>>
31567>>>>>    procedure construct_object
31568>>>>>      forward send construct_object
31570>>>>>      set size to 15 18
31571>>>>>      on_key kleftarrow   send prev_day
31572>>>>>      on_key krightarrow  send next_day
31573>>>>>      on_key kuparrow     send prev_week
31574>>>>>      on_key kdownarrow   send next_week
31575>>>>>      property date p_assigned_date public 0
31576>>>>>    end_procedure
31577>>>>>
31577>>>>>    procedure switch // This makes all 42 buttons act as if they are one focus
31578>>>>>      send activate to (btn1(current_object))
31579>>>>>    end_procedure
31580>>>>>    procedure switch_back
31581>>>>>      send activate to (btn6(current_object))
31582>>>>>    end_procedure
31583>>>>>
31583>>>>>    procedure mouse_down
31584>>>>>      local integer current_object#
31585>>>>>      forward send mouse_down
31587>>>>>      move current_object to current_object#
31588>>>>>      delegate set p_current_date to (p_assigned_date(current_object#))
31590>>>>>    end_procedure
31591>>>>>  end_class
31592>>>>>
31592>>>>>  desktop_section
31598>>>>>    object popup_calendar is a ModalPanel
31600>>>>>      set size to 160 250
31601>>>>>      property date    p_current_date  public 0
31603>>>>>      property integer p_current_year  public -1
31605>>>>>      property integer p_current_month public -1
31607>>>>>      property integer pExportState    public 1
31609>>>>>
31609>>>>>      on_key key_ctrl+key_pgup send prev_year
31610>>>>>      on_key key_ctrl+key_pgdn send next_year
31611>>>>>      on_key          key_pgup send prev_month
31612>>>>>      on_key          key_pgdn send next_month
31613>>>>>      on_key key_ctrl+key_d    send go_today
31614>>>>>      on_key kcancel           send cancel
31615>>>>>
31615>>>>>      object cont3d is a container3d
31617>>>>>        set location to 5 5
31618>>>>>        set size to 120 237
31619>>>>>        object textbox_year is a calendar.textbox
31621>>>>>          set location to 5 5
31622>>>>>          set size to 15 30
31623>>>>>          set border_style to border_staticedge
31624>>>>>          procedure display
31626>>>>>            set value to (p_current_year(current_object))
31627>>>>>          end_procedure
31628>>>>>        end_object
31629>>>>>        object dayname_header is a container3d
31631>>>>>          set location to 5 39
31632>>>>>          set size to 15 126
31633>>>>>          set border_style to border_staticedge
31634>>>>>          procedure initialize
31636>>>>>            local integer itm#
31637>>>>>            for itm# from 0 to 6
31643>>>>>>
31643>>>>>              object txt is a calendar.textbox
31645>>>>>                set size to 12 17
31646>>>>>                set location to 0 (itm#*17.6+1)
31647>>>>>                 set value to (left(DayName(itm#+1),3))
31648>>>>>              end_object
31649>>>>>            loop
31650>>>>>>
31650>>>>>          end_procedure
31651>>>>>          send initialize
31652>>>>>        end_object
31653>>>>>        object weeknumber_header is a container3d
31655>>>>>          set location to 24 5
31656>>>>>          set size     to 89 30
31657>>>>>          set border_style to border_staticedge
31658>>>>>          object obj_id_array is an array
31660>>>>>          end_object
31661>>>>>          procedure initialize
31663>>>>>            local integer itm# obj#
31664>>>>>            move (obj_id_array(current_object)) to obj#
31665>>>>>            for itm# from 0 to 5
31671>>>>>>
31671>>>>>              object txt is a textbox
31673>>>>>                set size to 15 30
31674>>>>>                set location to (itm#*15+1) 1
31675>>>>>                set value of obj# item (item_count(obj#)) to current_object
31676>>>>>              end_object
31677>>>>>            loop
31678>>>>>>
31678>>>>>          end_procedure
31679>>>>>          procedure display
31681>>>>>            local integer itm# obj#
31682>>>>>            local date date# last_date#
31682>>>>>            move (obj_id_array(current_object)) to obj#
31683>>>>>            get p_current_date to date#
31684>>>>>            move (FirstDayInMonth(date#)) to date#
31685>>>>>            move (LastDayInMonth(date#)) to last_date#
31686>>>>>            move (date#-DateDayNumber(date#)+1) to date#
31687>>>>>            for itm# from 0 to 5
31693>>>>>>
31693>>>>>              if (itm#*7+date#) le last_date# ;                set value of (integer(value(obj#,itm#))) to (t.calendar.week*string(DateWeekNumber(itm#*7+date#)))
31696>>>>>              else set value of (integer(value(obj#,itm#))) to ""
31698>>>>>            loop
31699>>>>>>
31699>>>>>          end_procedure
31700>>>>>          send initialize
31701>>>>>        end_object
31702>>>>>        object days_grid is a container3d
31704>>>>>          set location to 23 39
31705>>>>>          set size     to 100 127
31706>>>>>          set border_style to border_none
31707>>>>>          object btn_array is an array
31709>>>>>          end_object
31710>>>>>          procedure initialize
31712>>>>>            local integer row# col# button_array#
31713>>>>>            move (btn_array(current_object)) to button_array#
31714>>>>>            for row# from 0 to 5
31720>>>>>>
31720>>>>>              for col# from 0 to 6
31726>>>>>>
31726>>>>>                object btn is a calendar.button
31728>>>>>                  set location to (row#*15) (col#*18)
31729>>>>>                  set value of button_array# item (item_count(button_array#)) to current_object
31730>>>>>                  on_item "" send move_value_out_ok
31731>>>>>                end_object
31732>>>>>              loop
31733>>>>>>
31733>>>>>            loop
31734>>>>>>
31734>>>>>          end_procedure
31735>>>>>          send initialize
31736>>>>>
31736>>>>>          procedure display.iii integer itm# integer day# integer activate#
31738>>>>>            local integer obj# current_day#
31739>>>>>            move (integer(value(btn_array(current_object),itm#))) to obj#
31740>>>>>            move (DateSegment(p_current_date(current_object),DS_DAY)) to current_day#
31741>>>>>            if activate# begin
31743>>>>>              if day# eq current_day# send activate to obj#
31746>>>>>            end
31746>>>>>>
31746>>>>>            else begin
31747>>>>>              if day# begin
31749>>>>>                set value of obj# to day#
31750>>>>>                set visible_state of obj# to true
31751>>>>>                set p_assigned_date of obj# to (DateCompose(day#,p_current_month(current_object),p_current_year(current_object)))
31752>>>>>              end
31752>>>>>>
31752>>>>>              else set visible_state of obj# to false
31754>>>>>            end
31754>>>>>>
31754>>>>>          end_procedure
31755>>>>>
31755>>>>>          procedure display integer activate#
31757>>>>>            local integer first_item# last_item# itm# day# date#
31758>>>>>            get p_current_date to date#
31759>>>>>            move (FirstDayInMonth(date#)) to date#
31760>>>>>            move (DateDayNumber(date#)-1) to first_item#
31761>>>>>            move (LastDayInMonth(date#)-date#+first_item#) to last_item#
31762>>>>>            ifnot activate# begin
31764>>>>>              for itm# from 0 to (first_item#-1)
31770>>>>>>
31770>>>>>                send display.iii itm# 0 0
31771>>>>>              loop
31772>>>>>>
31772>>>>>            end
31772>>>>>>
31772>>>>>            move 1 to day#
31773>>>>>            for itm# from first_item# to last_item#
31779>>>>>>
31779>>>>>              send display.iii itm# day# activate#
31780>>>>>              increment day#
31781>>>>>            loop
31782>>>>>>
31782>>>>>            ifnot activate# begin
31784>>>>>              for itm# from (last_item#+1) to 41
31790>>>>>>
31790>>>>>                send display.iii itm# 0 0
31791>>>>>              loop
31792>>>>>>
31792>>>>>            end
31792>>>>>>
31792>>>>>          end_procedure
31793>>>>>        end_object
31794>>>>>        object txt_month is a calendar.textbox
31796>>>>>          set size to 12 27
31797>>>>>          set location to 25 185
31798>>>>>          set value to t.calendar.month
31799>>>>>        end_object
31800>>>>>        object btn1 is a button
31802>>>>>          set size to 12 12
31803>>>>>          set location to 40 185
31804>>>>>          on_item "" send prev_month
31805>>>>>          set bitmap to "prev.bmp"
31806>>>>>          procedure switch_back
31808>>>>>            send display_main
31809>>>>>          end_procedure
31810>>>>>        end_object
31811>>>>>        object btn2 is a button
31813>>>>>          set size to 12 12
31814>>>>>          set location to 40 200
31815>>>>>          on_item "" send next_month
31816>>>>>          set bitmap to "next.bmp"
31817>>>>>        end_object
31818>>>>>        object txt_year is a calendar.textbox
31820>>>>>          set size to 12 27
31821>>>>>          set location to 70 185
31822>>>>>          set value to t.calendar.year
31823>>>>>        end_object
31824>>>>>        object btn3 is a button
31826>>>>>          set size to 12 12
31827>>>>>          set location to 85 185
31828>>>>>          on_item "" send prev_year
31829>>>>>          set bitmap to "prev.bmp"
31830>>>>>        end_object
31831>>>>>        object btn4 is a button
31833>>>>>          set size to 12 12
31834>>>>>          set location to 85 200
31835>>>>>          on_item "" send next_year
31836>>>>>          set bitmap to "next.bmp"
31837>>>>>        end_object
31838>>>>>      end_object
31839>>>>>      object btn5 is a button
31841>>>>>        set size to 14 60
31842>>>>>        set location to 129 115
31843>>>>>        on_item t.calendar.ok send move_value_out_ok
31844>>>>>      end_object
31845>>>>>      object btn6 is a button
31847>>>>>        set size to 14 60
31848>>>>>        set location to 129 182
31849>>>>>        on_item t.calendar.cancel send cancel
31850>>>>>        procedure switch
31852>>>>>          send display_main
31853>>>>>        end_procedure
31854>>>>>      end_object
31855>>>>>      procedure next_year
31857>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
31858>>>>>        send display_main
31859>>>>>      end_procedure
31860>>>>>      procedure prev_year
31862>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
31863>>>>>        send display_main
31864>>>>>      end_procedure
31865>>>>>      procedure next_month
31867>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
31868>>>>>        send display_main
31869>>>>>      end_procedure
31870>>>>>      procedure prev_month
31872>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
31873>>>>>        send display_main
31874>>>>>      end_procedure
31875>>>>>      procedure next_week
31877>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,1))
31878>>>>>        send display_main
31879>>>>>      end_procedure
31880>>>>>      procedure prev_week
31882>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,-1))
31883>>>>>        send display_main
31884>>>>>      end_procedure
31885>>>>>      procedure next_day
31887>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,1))
31888>>>>>        send display_main
31889>>>>>      end_procedure
31890>>>>>      procedure prev_day
31892>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,-1))
31893>>>>>        send display_main
31894>>>>>      end_procedure
31895>>>>>      procedure go_today
31897>>>>>        local date date#
31898>>>>>        sysdate4 date#
31899>>>>>        set p_current_date to date#
31900>>>>>        send display_main
31901>>>>>      end_procedure
31902>>>>>      property integer invoking_object_id public 0
31904>>>>>      procedure OnChange date date#
31906>>>>>        local integer focus# dm#
31907>>>>>        get invoking_object_id to focus#
31908>>>>>        if focus# gt desktop begin
31910>>>>>          get delegation_mode of focus# to dm#
31911>>>>>          set delegation_mode of focus# to no_delegate_or_error
31912>>>>>          send NotifyPopupCalendarChange to focus# date#
31913>>>>>          set delegation_mode of focus# to dm#
31914>>>>>        end
31914>>>>>>
31914>>>>>      end_procedure
31915>>>>>      procedure display
31917>>>>>        local integer date# month# year#
31918>>>>>        get p_current_date to date#
31919>>>>>        send OnChange date#
31920>>>>>        move (DateSegment(date#,DS_YEAR)) to year#
31921>>>>>        move (DateSegment(date#,DS_MONTH)) to month#
31922>>>>>        if (p_current_year(current_object)<>year# or p_current_month(current_object)<>month#) begin
31924>>>>>          set p_current_year to year#
31925>>>>>          set p_current_month to month#
31926>>>>>          set value to (t.calendar.calendar_popup+", "+MonthName(month#))
31927>>>>>          send display to (textbox_year(cont3d(current_object)))
31928>>>>>          send display to (weeknumber_header(cont3d(current_object)))
31929>>>>>          send display to (days_grid(cont3d(current_object))) 0
31930>>>>>        end
31930>>>>>>
31930>>>>>      end_procedure
31931>>>>>      procedure display_main
31933>>>>>        send display
31934>>>>>        send display to (days_grid(cont3d(current_object))) 1
31935>>>>>      end_procedure
31936>>>>>      procedure popup_no_export
31938>>>>>        set pExportState to false
31939>>>>>        send popup
31940>>>>>        set pExportState to true
31941>>>>>      end_procedure
31942>>>>>
31942>>>>>      procedure popup_group
31944>>>>>        local integer focus#
31945>>>>>        local date date#
31945>>>>>        move (focus(desktop)) to focus#
31946>>>>>        set invoking_object_id to focus#
31947>>>>>        get value of focus# item current to date#
31948>>>>>        ifnot (integer(date#)) move (dSysdate()) to date#
31951>>>>>        move (Date2to4(date#)) to date#
31952>>>>>        set p_current_date to date#
31953>>>>>        send display
31954>>>>>        forward send popup_group
31956>>>>>        send display to (days_grid(cont3d(current_object))) 1
31957>>>>>      end_procedure
31958>>>>>
31958>>>>>      procedure move_value_out
31960>>>>>        local integer focus# dm# margin# datatype#
31961>>>>>        if (pExportState(current_object)) begin
31963>>>>>          get invoking_object_id to focus#
31964>>>>>          if focus# gt desktop begin
31966>>>>>            get delegation_mode of focus# to dm#
31967>>>>>            set delegation_mode of focus# to no_delegate_or_error
31968>>>>>            send NotifyPopupCalendarSelect to focus# (p_current_date(current_object))
31969>>>>>            get form_margin of focus# item current to margin#
31970>>>>>            get form_datatype of focus# item current to datatype#
31971>>>>>            set delegation_mode of focus# to dm#
31972>>>>>            if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to (p_current_date(current_object))
31975>>>>>            else             set value of focus# item current to (Date4to2(p_current_date(current_object)))
31977>>>>>            set item_changed_state of focus# item current to true
31978>>>>>          end
31978>>>>>>
31978>>>>>        end
31978>>>>>>
31978>>>>>      end_procedure
31979>>>>>
31979>>>>>      procedure move_value_out_ok
31981>>>>>        send move_value_out
31982>>>>>        send deactivate
31983>>>>>      end_procedure
31984>>>>>
31984>>>>>      procedure request_popup
31986>>>>>        local integer focus# type# dm#
31987>>>>>        move (focus(desktop)) to focus#
31988>>>>>        if focus# gt desktop begin
31990>>>>>          get delegation_mode of focus# to dm#
31991>>>>>          set delegation_mode of focus# to no_delegate_or_error
31992>>>>>          get form_datatype of focus# item current to type#
31993>>>>>          if (type#=date_window or type#=mask_date_window) send popup
31996>>>>>          set delegation_mode of focus# to dm#
31997>>>>>        end
31997>>>>>>
31997>>>>>      end_procedure
31998>>>>>    end_object
31999>>>>>  end_desktop_section
32001>>>>>  // If the procedure below was not defined "for BaseClass" its symbolic
32001>>>>>  // substitute would become negative (because located on the desktop). This
32001>>>>>  // would result in the toolbar object not being able to handle it. Therefore:
32001>>>>>  procedure request_popup_calendar for BaseClass
32002>>>>>    send request_popup to (popup_calendar(current_object))
32003>>>>>  end_procedure
32004>>>>>  procedure popup_calendar_no_export
32005>>>>>    send popup_no_export to (popup_calendar(current_object))
32006>>>>>  end_procedure
32007>>>>>  register_procedure Add_Toolbar_Button_Bitmap string bmp# string Tip# string StHlp# integer msg# integer obj#
32007>>>>>  procedure Add_Calendar_tbButton integer oTb#
32008>>>>>    send Add_Toolbar_Button_Bitmap to oTb# "DfCalend.bmp" t.calendar.calendar_popup t.calendar.Activate msg_request_popup_calendar
32009>>>>>  end_procedure
32010>>>>> function s.calendar returns integer // Backwards compatible!!
32011>>>>>   function_return (popup_calendar(current_object))
32012>>>>> end_function
32013>>>>>
32013>>>>>// Karl,
32013>>>>>// Structure is as follows,
32013>>>>>//
32013>>>>>// //put this code in the top portion of the view code or in the program
32013>>>>>// code.
32013>>>>>//
32013>>>>>// Type SystemTime
32013>>>>>//   field SystemTime.iYear As Word
32013>>>>>//   field SystemTime.iMonth As Word
32013>>>>>//   field SystemTime.iDayOfWeek As Word
32013>>>>>//   field SystemTime.iDay As Word
32013>>>>>//   field SystemTime.iHour As Word
32013>>>>>//   field SystemTime.iMinute As Word
32013>>>>>//   field SystemTime.iSecond As Word
32013>>>>>//   field SystemTime.iMilliseconds As Word
32013>>>>>// End_Type
32013>>>>>//
32013>>>>>// external_function GetSystemTime "GetSystemTime" kernel32.dll Pointer lpGST Returns VOID_TYPE
32013>>>>>//
32013>>>>>// //put this code in an onClick or wherever
32013>>>>>// procedure onclick
32013>>>>>//   local integer iRetVal
32013>>>>>//   local string TimeData
32013>>>>>//   local pointer GST
32013>>>>>//
32013>>>>>//   ZeroType SystemTime to TimeData
32013>>>>>//   getAddress from TimeData to GST
32013>>>>>//
32013>>>>>//   move (GetSystemTime(GST)) to iRetVal
32013>>>>>// end_procedure
32013>>>>>//
32013>>>>>// To extract the data from the Structure after calling the function use
32013>>>>>// the getbuff command as follows:
32013>>>>>//
32013>>>>>// getbuff from TimeData as SystemTime.IVAL to var
32013>>>>>//
32013>>>>>// where IVAL is one of the vars such as iYear or iDay, etc.
32013>>>>>//
32013>>>>>// OLIVER NELSON
32013>>>>>//
32013>>>>>//
32013>>>
32013>>>//AB-StoreTopEnd
32013>>>
32013>>>//AB-IgnoreStart
32013>>>
32013>>>Use DFAllEnt.pkg
32013>>>
32013>>>
32013>>>//AB-IgnoreEnd
32013>>>
32013>>>CD_Popup_Object oCalendar is a dbModalPanel
32032>>>
32032>>>    //AB-StoreTopStart
32032>>>    on_key kcancel           send cancel
32033>>>    //AB-StoreTopEnd
32033>>>
32033>>>    Set Border_Style to Border_Normal
32034>>>    Set Caption_Bar to FALSE
32035>>>    Set Label to "Ÿ­¢ àì, 2001"
32036>>>    Set Size to 98 123
32037>>>    Set Location to 10 22
32038>>>    Set Color to clWhite
32039>>>
32039>>>    //AB-DDOStart
32039>>>
32039>>>
32039>>>    //AB-DDOEnd
32039>>>
32039>>>    Object Container3d1 is a Container3d
32041>>>        Set Size to 88 135
32042>>>        Set Location to -2 -1
32043>>>        Set Color to clWhite
32044>>>        Set Border_Style to Border_None
32045>>>        Object Grid2 is a Grid
32047>>>
32047>>>            //AB-StoreTopStart
32047>>>            property date    p_current_date     public 0
32049>>>            property integer p_current_year     public -1
32051>>>            property integer p_current_month    public -1
32053>>>            property integer p_selected_day     public -1
32055>>>            property integer pExportState       public 1
32057>>>            property integer invoking_object_id public 0
32059>>>            
32059>>>            Set Border_Style To BORDER_NONE
32060>>>            Set header_visible_state To False
32061>>>            set select_mode to no_select
32062>>>            Set Gridline_mode To GRID_VISIBLE_NONE
32063>>>            
32063>>>            on_key Key_F1 Send Help
32064>>>            on_key key_ctrl+key_pgup send prev_year
32065>>>            on_key key_ctrl+key_pgdn send next_year
32066>>>            on_key          key_pgup send prev_month
32067>>>            on_key          key_pgdn send next_month
32068>>>            on_key key_enter         send move_value_out
32069>>>            on_key key_ctrl+key_d    send go_today
32070>>>            
32070>>>            //AB-StoreTopEnd
32070>>>
32070>>>            Set Color to clWhite
32071>>>            Set CurrentCellColor to clWhite
32072>>>            Set CurrentCellTextColor to clWhite
32073>>>            Set Size to 61 145
32074>>>            Set Location to 30 1
32075>>>            Set Resize_Column_state to FALSE
32076>>>
32076>>>            Set Line_Width to 7 0
32077>>>
32077>>>            Set Form_Width    item 0 to 18
32078>>>            Set Header_Label  item 0 to "­"
32079>>>            
32079>>>            Set Form_Width    item 1 to 18
32080>>>            Set Header_Label  item 1 to "‚â"
32081>>>            
32081>>>            Set Form_Width    item 2 to 18
32082>>>            Set Header_Label  item 2 to "‘à"
32083>>>            
32083>>>            Set Form_Width    item 3 to 18
32084>>>            Set Header_Label  item 3 to "—â"
32085>>>            
32085>>>            Set Form_Width    item 4 to 18
32086>>>            Set Header_Label  item 4 to "â"
32087>>>            
32087>>>            Set Form_Width    item 5 to 18
32088>>>            Set Header_Label  item 5 to "‘¡"
32089>>>            
32089>>>            Set Form_Width    item 6 to 18
32090>>>            Set Header_Label  item 6 to "‚á"
32091>>>            
32091>>>
32091>>>            //AB-StoreStart
32091>>>            
32091>>>            procedure go_today
32093>>>                Date date#
32094>>>                sysdate4 date#
32095>>>                set p_current_date to date#
32096>>>                Send Update_Calendar
32097>>>            end_procedure
32098>>>            
32098>>>            procedure next_month
32100>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32101>>>                Send Update_Calendar
32102>>>            end_procedure
32103>>>            
32103>>>            procedure prev_month
32105>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32106>>>                Send Update_Calendar
32107>>>            end_procedure
32108>>>            
32108>>>            procedure next_year
32110>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32111>>>                Send Update_Calendar
32112>>>            end_procedure
32113>>>            
32113>>>            procedure prev_year
32115>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32116>>>                Send Update_Calendar
32117>>>            end_procedure
32118>>>            
32118>>>            Procedure Activate
32120>>>                Date date#
32121>>>                Forward Send Activate
32123>>>                Set current_item to (p_selected_day(Self))
32124>>>            End_Procedure
32125>>>            
32125>>>            Procedure Update_Calendar
32127>>>                Set Dynamic_Update_State To False
32128>>>                send Fill_List
32129>>>                Set Dynamic_Update_State To True
32130>>>                // Send Update_Label
32130>>>                Set current_item to (p_selected_day(Self))
32131>>>                Send Date_Changing to (oYear(Container3d2(self)))
32132>>>                Send Date_Changing to (oMonth(Container3d2(self)))
32133>>>            End_Procedure
32134>>>            
32134>>>            Procedure Fill_List
32136>>>                Integer iFor prevdate# date# first_item# last_item# day# prev_last# nextdate# next_first#
32137>>>                Integer cur_year# cur_month# cur_day# sel_month# sel_day# sel_year#
32137>>>                Date dToday
32137>>>                Send Delete_Data
32138>>>            
32138>>>                Get p_current_date to date#
32139>>>            
32139>>>                SysDate4 dToday
32140>>>                move (DateSegment(dToday,DS_DAY)) to cur_day#
32141>>>                move (DateSegment(dToday,DS_MONTH)) to cur_month#
32142>>>                move (DateSegment(dToday,DS_YEAR)) to cur_year#
32143>>>            
32143>>>                move (DateSegment(date#,DS_DAY)) to sel_day#
32144>>>                move (DateSegment(date#,DS_MONTH)) to sel_month#
32145>>>                move (DateSegment(date#,DS_YEAR)) to sel_year#
32146>>>                Set p_current_month To sel_month#
32147>>>                Set p_current_year To sel_year#
32148>>>            
32148>>>                move (FirstDayInMonth(date#)) to date#
32149>>>                move (DateDayNumber(date#)-1) to first_item#
32150>>>                move (LastDayInMonth(date#)-date#+first_item#) to last_item#
32151>>>                move (DateIncrement(date#,DS_Month,-1)) To prevdate#
32152>>>                move (DateSegment((LastDayInMonth(prevdate#)),DS_DAY)) to prev_last#
32153>>>            
32153>>>                If (first_item# > 0) Begin
32155>>>                    Move (first_item#-1) to day#
32156>>>                    For iFor from 0 to (first_item#-1)
32162>>>>
32162>>>                        Send Add_Item msg_move_value_out (prev_last#-day#)
32163>>>                        Set Entry_State Item iFor To False
32164>>>                        Set ItemTextColor Item iFor To clGray
32165>>>                        Decrement day#
32166>>>                    Loop
32167>>>>
32167>>>                End
32167>>>>
32167>>>            
32167>>>                Move 1 To day#
32168>>>                For iFor from first_item# to last_item#
32174>>>>
32174>>>                    Send Add_Item Msg_Move_Value_Out day#
32175>>>                    Set Entry_State Item iFor To False
32176>>>                    If ((cur_month# eq sel_month#)and(cur_year# eq sel_year#)and(Day# eq cur_day#)) Set Form_Bitmap Item iFor To "cdate.bmp"
32179>>>                    If Day# eq sel_day# Set p_selected_day To iFor
32182>>>                    Set Form_justification_mode Item iFor To FORM_DISPLAYRIGHT
32183>>>                    Set form_datatype item iFor To mask_numeric_window
32184>>>                    Set form_Mask item iFor To "## "
32185>>>                    Increment day#
32186>>>                Loop
32187>>>>
32187>>>            
32187>>>                move (DateIncrement(date#,DS_Month,1)) To nextdate#
32188>>>                move (DateSegment((LastDayInMonth(nextdate#)),DS_DAY)) to next_first#
32189>>>            
32189>>>                If (last_item# < 41) Begin
32191>>>                    Move 1 to day#
32192>>>                    For iFor from (last_item#+1) to 41
32198>>>>
32198>>>                        Send Add_Item msg_move_value_out day#
32199>>>                        Set Entry_State Item iFor To False
32200>>>                        Set ItemTextColor Item iFor To clGray
32201>>>                        Increment day#
32202>>>                    Loop
32203>>>>
32203>>>                End
32203>>>>
32203>>>            
32203>>>            End_Procedure
32204>>>            
32204>>>            Procedure Help
32206>>>                Send Info_Box ("<Up>, <Dn>, <Lft>, <Rgt> - select date.\n<PgUp>, <PgDn> - select month.\n<Ctrl>+<D> - set current date.\n<Ctrl>+<PgUp>, <PgDn> - Select year.\n\n(c) 2001, SCR. Special thanks to Sture Andersen.") ("Help on Calendar")
32207>>>            End_Procedure
32208>>>            
32208>>>            procedure mouse_click integer window integer char_pos
32210>>>                Send Move_Value_Out
32211>>>                forward send mouse_click window char_pos
32213>>>            end_procedure
32214>>>            
32214>>>            Procedure Move_Value_Out
32216>>>                Integer iYear iMonth iDay iItm
32217>>>                Date Date# next_date# prev_date#
32217>>>                Get Current_Item To iItm
32218>>>                If (pExportState(Self)) Begin
32220>>>                    Get Value Item iItm To iDay
32221>>>                    Get p_current_month to iMonth
32222>>>                    Get p_current_year  to iYear
32223>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32224>>>            
32224>>>                    If ((iItm>27)and(iDay<15)) Begin
32226>>>                        Move (DateCompose(1,iMonth,iYear)) To next_date#
32227>>>                        move (DateIncrement(next_date#,DS_Month,1)) To next_date#
32228>>>                        move (DateSegment(next_date#,DS_MONTH)) to iMonth
32229>>>                        move (DateSegment(next_date#,DS_YEAR)) to iYear
32230>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32231>>>                    End
32231>>>>
32231>>>                    If ((iItm<7)and(iDay>20)) Begin
32233>>>                        Move (DateCompose(1,iMonth,iYear)) To prev_date#
32234>>>                        move (DateIncrement(prev_date#,DS_Month,-1)) To prev_date#
32235>>>                        move (DateSegment(prev_date#,DS_MONTH)) to iMonth
32236>>>                        move (DateSegment(prev_date#,DS_YEAR)) to iYear
32237>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32238>>>                    End
32238>>>>
32238>>>            
32238>>>                    Send Export_Date date#
32239>>>                End
32239>>>>
32239>>>            End_Procedure
32240>>>            
32240>>>            Procedure Export_Date date date#
32242>>>                local integer focus# dm# margin# datatype#
32243>>>                get invoking_object_id to focus#
32244>>>            
32244>>>                if focus# gt desktop begin
32246>>>                     get delegation_mode of focus# to dm#
32247>>>                     set delegation_mode of focus# to no_delegate_or_error
32248>>>                     get form_margin of focus# item current to margin#
32249>>>                     get form_datatype of focus# item current to datatype#
32250>>>                     set delegation_mode of focus# to dm#
32251>>>                     if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to date#
32254>>>                     else             set value of focus# item current to (Date4to2(date#))
32256>>>                     set item_changed_state of focus# item current to true
32257>>>                end
32257>>>>
32257>>>                Send Close_Calendar
32258>>>            End_Procedure
32259>>>            //AB-StoreEnd
32259>>>
32259>>>        End_Object    // Grid2
32260>>>
32260>>>        Object Textbox2 is a Textbox
32262>>>            Set Label to "­"
32263>>>            Set Auto_Size_State to FALSE
32264>>>            Set Transparent_State to TRUE
32265>>>            Set Color to clWhite
32266>>>            Set TextColor to clNavy
32267>>>            Set Location to 19 4
32268>>>            Set Size to 10 15
32269>>>
32269>>>            //AB-StoreStart
32269>>>                                        
32269>>>            Set Label To (left(t.calendar.Monday,2))
32270>>>            //AB-StoreEnd
32270>>>
32270>>>        End_Object    // Textbox2
32271>>>
32271>>>        Object Textbox3 is a Textbox
32273>>>            Set Label to "‚â"
32274>>>            Set Auto_Size_State to FALSE
32275>>>            Set Transparent_State to TRUE
32276>>>            Set Color to clWhite
32277>>>            Set TextColor to clNavy
32278>>>            Set Location to 19 22
32279>>>            Set Size to 10 12
32280>>>
32280>>>            //AB-StoreStart
32280>>>                                        
32280>>>            Set Label To (left(t.calendar.Tuesday,2))
32281>>>            //AB-StoreEnd
32281>>>
32281>>>        End_Object    // Textbox3
32282>>>
32282>>>        Object Textbox4 is a Textbox
32284>>>            Set Label to "‘à"
32285>>>            Set Auto_Size_State to FALSE
32286>>>            Set Transparent_State to TRUE
32287>>>            Set Color to clWhite
32288>>>            Set TextColor to clNavy
32289>>>            Set Location to 19 39
32290>>>            Set Size to 10 15
32291>>>
32291>>>            //AB-StoreStart
32291>>>                                        
32291>>>            Set Label To (left(t.calendar.Wednesday,2))
32292>>>            //AB-StoreEnd
32292>>>
32292>>>        End_Object    // Textbox4
32293>>>
32293>>>        Object Textbox5 is a Textbox
32295>>>            Set Label to "—â"
32296>>>            Set Auto_Size_State to FALSE
32297>>>            Set Transparent_State to TRUE
32298>>>            Set Color to clWhite
32299>>>            Set TextColor to clNavy
32300>>>            Set Location to 19 57
32301>>>            Set Size to 10 17
32302>>>
32302>>>            //AB-StoreStart
32302>>>                                        
32302>>>            Set Label To (left(t.calendar.Thursday,2))
32303>>>            //AB-StoreEnd
32303>>>
32303>>>        End_Object    // Textbox5
32304>>>
32304>>>        Object Textbox6 is a Textbox
32306>>>            Set Label to "â"
32307>>>            Set Auto_Size_State to FALSE
32308>>>            Set Transparent_State to TRUE
32309>>>            Set Color to clWhite
32310>>>            Set TextColor to clNavy
32311>>>            Set Location to 19 76
32312>>>            Set Size to 10 17
32313>>>
32313>>>            //AB-StoreStart
32313>>>                                        
32313>>>            Set Label To (left(t.calendar.Friday,2))
32314>>>            //AB-StoreEnd
32314>>>
32314>>>        End_Object    // Textbox6
32315>>>
32315>>>        Object Textbox7 is a Textbox
32317>>>            Set Label to "‘¡"
32318>>>            Set Auto_Size_State to FALSE
32319>>>            Set Transparent_State to TRUE
32320>>>            Set Color to clWhite
32321>>>            Set TextColor to clNavy
32322>>>            Set Location to 19 91
32323>>>            Set Size to 10 18
32324>>>
32324>>>            //AB-StoreStart
32324>>>                                        
32324>>>            Set Label To (left(t.calendar.Saturday,2))
32325>>>            //AB-StoreEnd
32325>>>
32325>>>        End_Object    // Textbox7
32326>>>
32326>>>        Object Textbox8 is a Textbox
32328>>>            Set Label to "‚á"
32329>>>            Set Auto_Size_State to FALSE
32330>>>            Set Transparent_State to TRUE
32331>>>            Set Color to clWhite
32332>>>            Set TextColor to clNavy
32333>>>            Set Location to 19 109
32334>>>            Set Size to 10 17
32335>>>
32335>>>            //AB-StoreStart
32335>>>                                        
32335>>>            Set Label To (left(t.calendar.Sunday,2))
32336>>>            //AB-StoreEnd
32336>>>
32336>>>        End_Object    // Textbox8
32337>>>
32337>>>        Object LineControl1 is a LineControl
32339>>>            Set Line_Style to lnSINGLE
32340>>>            Set Size to 1 116
32341>>>            Set Location to 28 4
32342>>>
32342>>>            //AB-StoreStart
32342>>>                                        
32342>>>            //AB-StoreEnd
32342>>>
32342>>>        End_Object    // LineControl1
32343>>>
32343>>>        Object Container3d2 is a Container3d
32345>>>            Set Size to 18 131
32346>>>            Set Location to 1 1
32347>>>            Set Color to clNavy
32348>>>            Set Border_Style to Border_None
32349>>>            Object oRght is a BitmapContainer
32351>>>                Set Size to 10 14
32352>>>                Set Location to 4 105
32353>>>                Set Bitmap to "rght.bmp"
32354>>>                Set Border_Style to Border_None
32355>>>
32355>>>                //AB-StoreStart
32355>>>                Procedure Mouse_Down
32357>>>                    Send Next_Month to Grid2
32358>>>                End_Procedure
32359>>>                //AB-StoreEnd
32359>>>
32359>>>            End_Object    // oRght
32360>>>
32360>>>            Object oLeft is a BitmapContainer
32362>>>                Set Size to 10 14
32363>>>                Set Location to 4 3
32364>>>                Set Bitmap to "lft.bmp"
32365>>>                Set Border_Style to Border_None
32366>>>
32366>>>                //AB-StoreStart
32366>>>                Procedure Mouse_Down
32368>>>                    Send Prev_Month to Grid2
32369>>>                End_Procedure
32370>>>                //AB-StoreEnd
32370>>>
32370>>>            End_Object    // oLeft
32371>>>
32371>>>            Object oMonth is a Textbox
32373>>>
32373>>>                //AB-StoreTopStart
32373>>>                Property integer piSelected_Month public 0
32375>>>                //AB-StoreTopEnd
32375>>>
32375>>>                Set Label to "January"
32376>>>                Set Auto_Size_State to FALSE
32377>>>                Set Transparent_State to TRUE
32378>>>                Set Color to clWhite
32379>>>                Set TextColor to clWhite
32380>>>                Set Location to 4 23
32381>>>                Set Size to 10 43
32382>>>                Set FontWeight to 800
32383>>>                Set Justification_Mode to jMode_Center
32384>>>
32384>>>                //AB-StoreStart
32384>>>                                    
32384>>>                Procedure Mouse_Down
32386>>>                    Integer iState
32387>>>                    Get Visible_State of oSelectYear to iState
32388>>>                    If (iState) Send OnKillFocus to oSelectYear
32391>>>                    Send Popup to oSelectMonth
32392>>>                End_Procedure
32393>>>                
32393>>>                Procedure pSelectJan
32395>>>                    Set Label to t.calendar.january
32396>>>                    Set piSelected_Month to 1
32397>>>                    Send Adjust_Calendar
32398>>>                End_Procedure
32399>>>                Procedure pSelectFeb
32401>>>                    Set Label to t.calendar.february
32402>>>                    Set piSelected_Month to 2
32403>>>                    Send Adjust_Calendar
32404>>>                End_Procedure
32405>>>                Procedure pSelectMar
32407>>>                    Set Label to t.calendar.march
32408>>>                    Set piSelected_Month to 3
32409>>>                    Send Adjust_Calendar
32410>>>                End_Procedure
32411>>>                Procedure pSelectApr
32413>>>                    Set Label to t.calendar.april
32414>>>                    Set piSelected_Month to 4
32415>>>                    Send Adjust_Calendar
32416>>>                End_Procedure
32417>>>                Procedure pSelectMay
32419>>>                    Set Label to t.calendar.may
32420>>>                    Set piSelected_Month to 5
32421>>>                    Send Adjust_Calendar
32422>>>                End_Procedure
32423>>>                Procedure pSelectJun
32425>>>                    Set Label to t.calendar.june
32426>>>                    Set piSelected_Month to 6
32427>>>                    Send Adjust_Calendar
32428>>>                End_Procedure
32429>>>                Procedure pSelectJul
32431>>>                    Set Label to t.calendar.july
32432>>>                    Set piSelected_Month to 7
32433>>>                    Send Adjust_Calendar
32434>>>                End_Procedure
32435>>>                Procedure pSelectAug
32437>>>                    Set Label to t.calendar.august
32438>>>                    Set piSelected_Month to 8
32439>>>                    Send Adjust_Calendar
32440>>>                End_Procedure
32441>>>                Procedure pSelectSep
32443>>>                    Set Label to t.calendar.september
32444>>>                    Set piSelected_Month to 9
32445>>>                    Send Adjust_Calendar
32446>>>                End_Procedure
32447>>>                Procedure pSelectOct
32449>>>                    Set Label to t.calendar.october
32450>>>                    Set piSelected_Month to 10
32451>>>                    Send Adjust_Calendar
32452>>>                End_Procedure
32453>>>                Procedure pSelectNov
32455>>>                    Set Label to t.calendar.november
32456>>>                    Set piSelected_Month to 11
32457>>>                    Send Adjust_Calendar
32458>>>                End_Procedure
32459>>>                Procedure pSelectDec
32461>>>                    Set Label to t.calendar.december
32462>>>                    Set piSelected_Month to 12
32463>>>                    Send Adjust_Calendar
32464>>>                End_Procedure
32465>>>                
32465>>>                Object oSelectMonth is a FloatingPopupMenu
32467>>>                    Send Add_Item msg_pSelectJan t.calendar.january
32468>>>                    Send Add_Item msg_pSelectFeb t.calendar.february
32469>>>                    Send Add_Item msg_pSelectMar t.calendar.march
32470>>>                    Send Add_Item msg_pSelectApr t.calendar.april
32471>>>                    Send Add_Item msg_pSelectMay t.calendar.may
32472>>>                    Send Add_Item msg_pSelectJun t.calendar.june
32473>>>                    Send Add_Item msg_pSelectJul t.calendar.july
32474>>>                    Send Add_Item msg_pSelectAug t.calendar.august
32475>>>                    Send Add_Item msg_pSelectSep t.calendar.september
32476>>>                    Send Add_Item msg_pSelectOct t.calendar.october
32477>>>                    Send Add_Item msg_pSelectNov t.calendar.november
32478>>>                    Send Add_Item msg_pSelectDec t.calendar.december
32479>>>                End_Object
32480>>>                
32480>>>                Procedure Adjust_Calendar
32482>>>                    Date date#
32483>>>                    Integer iDay iMonth iYear iItm
32483>>>                    Set Visible_State to false
32484>>>                    Set Visible_State to true
32485>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
32486>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
32487>>>                    Get piSelected_Month to iMonth
32488>>>                    Get Label of oYear to iYear
32489>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32490>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
32491>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
32492>>>                End_Procedure
32493>>>                
32493>>>                Procedure Activating
32495>>>                    Forward Send Activating
32497>>>                    Send Date_Changing
32498>>>                End_Procedure
32499>>>                
32499>>>                Procedure Date_Changing
32501>>>                    Set Visible_State to false
32502>>>                    Set Label to (MonthName(p_current_Month(Grid2(Container3D1(Self)))))
32503>>>                    Set piSelected_Month to (p_current_Month(Grid2(Container3D1(Self))))
32504>>>                    Set Visible_State to true
32505>>>                End_Procedure
32506>>>                
32506>>>                
32506>>>                //AB-StoreEnd
32506>>>
32506>>>            End_Object    // oMonth
32507>>>
32507>>>            Object oYear is a Textbox
32509>>>                Set Label to "2001"
32510>>>                Set Transparent_State to TRUE
32511>>>                Set Color to clWhite
32512>>>                Set TextColor to clWhite
32513>>>                Set Location to 4 77
32514>>>                Set Size to 10 18
32515>>>                Set FontWeight to 800
32516>>>
32516>>>                //AB-StoreStart
32516>>>                                                    
32516>>>                Procedure Mouse_Down
32518>>>                    String sVal
32519>>>                    Get Label to sVal
32520>>>                    Set Value of oSelectYear item 0 to sVal
32521>>>                    Set Visible_State of oSelectYear to True
32522>>>                    Send Activate to (oSelectYear(Self))
32523>>>                End_Procedure
32524>>>                
32524>>>                Procedure Activating
32526>>>                    Forward Send Activating
32528>>>                    Send Date_Changing
32529>>>                End_Procedure
32530>>>                
32530>>>                Procedure Date_Changing
32532>>>                    Set Visible_State to false
32533>>>                    Set Label to (String(p_current_Year(Grid2(Container3D1(Self)))))
32534>>>                    Set Visible_State to true
32535>>>                End_Procedure
32536>>>                //AB-StoreEnd
32536>>>
32536>>>            End_Object    // oYear
32537>>>
32537>>>            Object oSelectYear is a Form
32539>>>
32539>>>                //AB-StoreTopStart
32539>>>                Set Visible_State To False
32540>>>                //AB-StoreTopEnd
32540>>>
32540>>>                Set Size to 10 24
32541>>>                Set Location to 4 75
32542>>>                Set Color to clWhite
32543>>>                Set TextColor to clNavy
32544>>>                Set Form_Border Item 0 to Border_Normal
32545>>>
32545>>>                //AB-StoreStart
32545>>>                                                    
32545>>>                On_Key Key_Enter Send OnKillFocus
32546>>>                On_Key Key_Escape Send OnKillFocus
32547>>>                
32547>>>                Procedure SetFontWeight
32549>>>                    Set Form_FontWeight item 0 to 800
32550>>>                End_Procedure
32551>>>                
32551>>>                Procedure OnKillFocus
32553>>>                    String sVal
32554>>>                    Integer iMonth iDay iYear iItm
32554>>>                    Date date#
32554>>>                    Get Value item 0 to sVal
32555>>>                    Set Visible_State of oYear to false
32556>>>                    Set Label of oYear to sVal
32557>>>                    Set Visible_State of oYear to true
32558>>>                    Set Visible_State to false
32559>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
32560>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
32561>>>                    Get piSelected_Month of oMonth to iMonth
32562>>>                    Get Value item 0 to iYear
32563>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32564>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
32565>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
32566>>>                End_Procedure
32567>>>                
32567>>>                Send SetFontWeight
32568>>>                //AB-StoreEnd
32568>>>
32568>>>            End_Object    // oSelectYear
32569>>>
32569>>>
32569>>>            //AB-StoreStart
32569>>>                            
32569>>>            Procedure Mouse_Down
32571>>>                Integer iState
32572>>>                Get Visible_State of oSelectYear to iState
32573>>>                If (iState) Send OnKillFocus to oSelectYear
32576>>>            End_Procedure
32577>>>            
32577>>>            //AB-StoreEnd
32577>>>
32577>>>        End_Object    // Container3d2
32578>>>
32578>>>
32578>>>        //AB-StoreStart
32578>>>                            
32578>>>        //AB-StoreEnd
32578>>>
32578>>>    End_Object    // Container3d1
32579>>>
32579>>>    Object BitmapContainer3 is a BitmapContainer
32581>>>        Set Size to 9 19
32582>>>        Set Location to 88 3
32583>>>        Set Color to clWhite
32584>>>        Set Bitmap to "cdate.bmp"
32585>>>        Set Border_Style to Border_None
32586>>>
32586>>>        //AB-StoreStart
32586>>>        Procedure Mouse_Down
32588>>>            Send go_today to (Grid2(Container3d1(Self)))
32589>>>            Send Adjust_Label to oToday
32590>>>        End_Procedure
32591>>>        //AB-StoreEnd
32591>>>
32591>>>    End_Object    // BitmapContainer3
32592>>>
32592>>>    Object oToday is a Textbox
32594>>>        Set Label to "Today: 01.01.2001"
32595>>>        Set Auto_Size_State to FALSE
32596>>>        Set Color to clWhite
32597>>>        Set Location to 88 22
32598>>>        Set Size to 8 73
32599>>>        Set FontWeight to 800
32600>>>
32600>>>        //AB-StoreStart
32600>>>        Procedure Mouse_Down
32602>>>            Send go_today to (Grid2(Container3d1(Self)))
32603>>>            Send Adjust_Label
32604>>>        End_Procedure
32605>>>        
32605>>>        Procedure Adjust_Label
32607>>>            date date#
32608>>>            SysDate4 date#
32609>>>            Set Visible_State To false
32610>>>            Set Label         to (t.calendar.today+": "+String(date#))
32611>>>            Set Visible_State To true
32612>>>        End_Procedure
32613>>>        
32613>>>        Procedure Activating
32615>>>            Forward Send Activating
32617>>>            Send Adjust_Label
32618>>>        End_Procedure
32619>>>        //AB-StoreEnd
32619>>>
32619>>>    End_Object    // oToday
32620>>>
32620>>>
32620>>>    //AB-StoreStart
32620>>>                
32620>>>    procedure popup
32622>>>        local integer focus# icItm iYear iMonth
32623>>>        local date date#
32623>>>        move (focus(desktop)) to focus#
32624>>>        set invoking_object_id of (Grid2(Container3d1(self))) to focus#
32625>>>        get value of focus# item current to date#
32626>>>        ifnot (integer(date#)) sysdate date#
32629>>>        move (Date2to4(date#)) to date#
32630>>>        set p_current_date of (Grid2(Container3d1(self))) to date#
32631>>>        send fill_list to (Grid2(Container3d1(self)))
32632>>>        move (DateSegment(date#,DS_YEAR)) to iYear
32633>>>        move (DateSegment(date#,DS_MONTH)) to iMonth
32634>>>        Set Label To (MonthName(iMonth)+', '+String(iYear))
32635>>>        forward send popup
32637>>>    end_procedure
32638>>>    
32638>>>    Procedure Close_Calendar
32640>>>        Send Exit
32641>>>    End_Procedure
32642>>>    //AB-StoreEnd
32642>>>
32642>>>CD_End_Object    // oCalendar
32644>>>>
32644>>>
32644>>>
32644>>>//AB-StoreStart
32644>>>    
32644>>>    
32644>>>//AB-StoreEnd
32644>>>
32644>>>//AB/ End_Object    // prj
32644>Use Dates.Utl
32644>Use Connect.Dg
INCLUDING FILE: CONNECT.DG
32644>>>//AB/ Project Connect
32644>>>//AB/ Object prj is a Dialog_Project
32644>>>//AB/     Set ProjectName to "Connect"
32644>>>//AB/     Set ProjectFileName to "CONNECT.DG"
32644>>>
32644>>>// Project Object Structure
32644>>>//   Connect is a BasicPanelSub
32644>>>//     BitmapContainer1 is a BitmapContainerSub
32644>>>//     Textbox5 is a TextBoxSub
32644>>>//     ComboForm2 is a ComboFormSub
32644>>>//     Textbox6 is a TextBoxSub
32644>>>//     Form4 is a FormSub
32644>>>//     Textbox7 is a TextBoxSub
32644>>>//     Form5 is a FormSub
32644>>>//     Textbox8 is a TextBoxSub
32644>>>//     Form6 is a FormSub
32644>>>//     CheckBox1 is a CheckBoxSub
32644>>>//     oOK_bn is a ButtonSub
32644>>>//     oCancel_bn is a ButtonSub
32644>>>
32644>>>// Register all objects
32644>>>Register_Object BitmapContainer1
32644>>>Register_Object CheckBox1
32644>>>Register_Object ComboForm2
32644>>>Register_Object Connect
32644>>>Register_Object Form4
32644>>>Register_Object Form5
32644>>>Register_Object Form6
32644>>>Register_Object oCancel_bn
32644>>>Register_Object oOK_bn
32644>>>Register_Object Textbox5
32644>>>Register_Object Textbox6
32644>>>Register_Object Textbox7
32644>>>Register_Object Textbox8
32644>>>
32644>>>
32644>>>
32644>>>//AB-StoreTopStart
32644>>>
32644>>>///#INCLUDE
32644>>>Use mertech.inc
INCLUDING FILE: MERTECH.INC
32644>>>>>USE UI
32644>>>>>
#REM -----------------------------------------------
#REM MERTECH DATA SYSTEMS INC. - WWW.MERTECHDATA.COM
#REM MERTECH.INC VERSION 2.1.9
#REM -----------------------------------------------
32644>>>>>
32644>>>>>
32644>>>>>
32644>>>>>
32644>>>>>
32644>>>>>//
32644>>>>>//
32644>>>>>//
32644>>>>>//
32644>>>>>//
32644>>>>>//-----------------------------------------------
32644>>>>>// SELECT_COLUMNS_FIND <FILE> <START> THRU <END>
32644>>>>>// SELECT_COLUMNS_FIND <FILE> <FIELD>
32644>>>>>// This command will issue a properly commands to define the FETCH attribute status
32644>>>>>// for file fields.
32644>>>>>//
32644>>>>>//------------------------------------------------------------------------------
32644>>>>>// RESET_FETCH_FIELDS <FILE NAME>|<FILE NUMBER> <DF_FETCH_TRUE>|<DF_FETCH_FALSE>
32644>>>>>//
32644>>>>>//
32644>>>>>//-----------------------------
32644>>>>>// SQL_FOR_ONEROW <file number>
32644>>>>>//
32644>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get just
32644>>>>>// one ROW for each DataFlex FIND command issued
32644>>>>>// In this case the DBMS optimizer will generate a query with just one row
32644>>>>>//
32644>>>>>//
32644>>>>>//-------------------------------------------------------------------------------
32644>>>>>// SQL_FOR_SET <file number> MAXROWS <number of rows> CACHE|NOCACHE <return code>
32644>>>>>//
32644>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get a SET of rows.
32644>>>>>// In this case the DBMS optimizer will generate a query with <number of rows> Rows.
32644>>>>>// if CACHE is passed as argument, all these rows will be transfered to ORAFlex and then it will
32644>>>>>// save them in a local CACHE buffer. Just the FIND GT and FIND LT will get local cache.
32644>>>>>// Otherwise, i.e NOCACHE,  ORAFLex won't create a local cache.
32644>>>>>//
32644>>>>>//
32644>>>>>//---------------
32644>>>>>// SQL_SET <stmt>
32644>>>>>//
32644>>>>>//-----------------------------------------
32644>>>>>// SQL_APPEND <stmt1> <stmt2> .... <stmtn>
32644>>>>>//
32644>>>>>//------------
32644>>>>>// SQL_EXECUTE
32644>>>>>//
32644>>>>>//----------------------------------------------------------------------
32644>>>>>// LOCK_TABLE [<FILE NAME>|<FILE NUMBER> <FILE NAME>|<FILE NUMBER> ....]
32644>>>>>//
32644>>>>>// LOCK_TABLE will lock the entire table specified as an argument
32644>>>>>// This command will start a new transaction if it still wasn't done.
32644>>>>>// LOCK_TABLE won't lock the other opened tables or the current rows present
32644>>>>>// in their buffers it will be necessary issue a REREAD command to Lock the current
32644>>>>>// rows and then atualize their buffers
32644>>>>>//
32644>>>>>//
32644>>>>>//-------------------------------------------
32644>>>>>// SQL_CHECK_TABLE <SCHEMA NAME> <TABLE NAME>
32644>>>>>//
32644>>>>>//-------------------------------
32644>>>>>// CREATE_TD_FILE  DFTRUE|DFFALSE
32644>>>>>// SET A GLOBAL ATTRIBUTE TO CREATE THE TD FILE AFTER CLOSING AN OPENED FILE
32644>>>>>//
32644>>>>>//-------------------------------------------------
32644>>>>>// OPEN_INT <DATAFLEX FILE NAME>
32644>>>>>// OPEN_INT <PHYSICAL NAME> AS <DATAFLEX FILE NAME>
32644>>>>>//
32644>>>>>// OPEN_INT will check if the OPEN done is an OPEN AS. IF it's true, OPEN_INT
32644>>>>>// will try to open an intermediate file, if there is one. Otherwise OPEN_INT
32644>>>>>// will issue a OPEN command
32644>>>>>// OPEN_INT must be inserted into FMAC file instead OPEN COMMAND
32644>>>>>//
32644>>>>>//=========================================================================================================
32644>>>>>// SELECT STUFFS
32644>>>>>//--------------
32644>>>>>// SQL_SET_STMT OF FILENAME|FILENUMBER TO <STATMENT1>
32644>>>>>//
32644>>>>>// SQL_APPEND_ OF FILENAME|FILENUMBER TO <STATMENT1> <STATMENT2> ... <STATMENTn>
32644>>>>>//
32644>>>>>//
32644>>>>>// SQL_APPEND_UPDCOL_STMT OF FILENAME|FILENUMBER VALUE EXPRESSION WITH FIELD1 FIELD2 ... FIELDN
32644>>>>>//
32644>>>>>// SQL_PREPARE_STMT OF FILENAME|FILENUMBER
32644>>>>>//
32644>>>>>// SQL_BIND_COLUMN [FILENAME|FILENUMBER] [FIELDNAME|FIELDNUMBER]
32644>>>>>//
32644>>>>>// SQL_BINDCOLUMNS_STMT OF FILENAME|FILENUMBER TO <COLUMN1> <COLUMN2> ... <COLUMNn>
32644>>>>>//
32644>>>>>// SQL_EXECUTE_STMT OF FILENAME|FILENUMBER
32644>>>>>//
32644>>>>>// SQL_COMMIT_STMT
32644>>>>>//
32644>>>>>// SQL_ROLLBACK_STMT
32644>>>>>//
32644>>>>>// SQL_FETCH_NEXT_ROW OF FILENAME|FILENUMBER
32644>>>>>//
32644>>>>>//
32644>>>>>//
32644>>>>>//
32644>>>>>// CALL_STORED_PROCEDURE will call a stored procedure passing arguments
32644>>>>>//
32644>>>>>// FORMAT TO USE : CALL_STORED_PROCEDURE <STORED_PROC_NAME> [PASSING <ARG1> <ARG2> ....<ARGn>]
32644>>>>>//
32644>>>>>//
32644>>>>>//---------------------------------------------------------------------------------------------
32644>>>>>// CALL_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
32644>>>>>// CALL_STORED_FUNCTION will call an Oracle stored function passing arguments
32644>>>>>//
32644>>>>>//---------------------------
32644>>>>>// SQL_TEXT_MESSAGE <MESSAGE>
32644>>>>>// Writes a message inside driver log trace file if this is activated
32644>>>>>//
32644>>>>>//-----------------------------------------------------
32644>>>>>// OUTPUT_INT_FILE FOR <FILE NUMBER> TO <INT FILE NAME>
32644>>>>>// Generating the INT file
32644>>>>>//
32644>>>>>// -----------------------
32644>>>>>// SQL_ERROR_MESSAGE <VAR>
32644>>>>>// SQL_ERROR_MESSAGE retrieve the native error message issued by server for error number 25000
32644>>>>>
32644>>>>>
32644>>>>>//=======================================================================================
32644>>>>>// SQLFlex Commands
32644>>>>>//-----------------
32644>>>>>//
32644>>>>>//-----------------------
32644>>>>>// SQLFlex_REVISION <VAR>
32644>>>>>// Retrieves SQLFlex revision
32644>>>>>//
32644>>>>>//-------------------------------------
32644>>>>>// SET_DATABASE_NAME TO <DATABASE NAME>
32644>>>>>// Sets current database
32644>>>>>//
32644>>>>>//---------------------------
32644>>>>>// GET_DATABASE_NAME TO <VAR>
32644>>>>>// Gets name of current database
32644>>>>>//
32644>>>>>//----------------------------------
32644>>>>>// SET_SCHEMA_NAME TO <SCHEMA NAME>
32644>>>>>// Sets current schema name
32644>>>>>//
32644>>>>>//-------------------------
32644>>>>>// GET_SCHEMA_NAME TO <VAR>
32644>>>>>// Gets current schema name
32644>>>>>//
32644>>>>>//--------------------------------
32644>>>>>// SQL_USEDATABASE <DATABASE NAME>
32644>>>>>// Specifies the current Database
32644>>>>>//
32644>>>>>//----------------------------
32644>>>>>// SET_CURRENT_SERVER TO <VAR>
32644>>>>>// Set the current logged server
32644>>>>>//
32644>>>>>//----------------------------
32644>>>>>// GET_CURRENT_SERVER TO <VAR>
32644>>>>>// Retrieves the current logged server
32644>>>>>//
32644>>>>>//-----------------------------
32644>>>>>// SET_HOST_NAME TO <HOST NAME>
32644>>>>>// Defines current host name
32644>>>>>//
32644>>>>>//-----------------------
32644>>>>>// GET_HOST_NAME TO <VAR>
32644>>>>>// Retrieves the current host name
32644>>>>>//
32644>>>>>//---------------------------------------------------------------
32644>>>>>// LOGIN_SQLFLEX <SERVER NAME> <USER NAME> <PASSWORD> <HOST NAME>
32644>>>>>// Specifies host name during login process
32644>>>>>//
32644>>>>>// SQL_CANCEL_QUERY_STMT
32644>>>>>//
32644>>>>>//========================================
32644>>>>>// SQL SERVER Stored Procedure Call engine
32644>>>>>//----------------------------------------
32644>>>>>//
32644>>>>>//
32644>>>>>
32644>>>>>//
32644>>>>>//--------------------------------------------------------------------------------------------------------------
32644>>>>>// CALL_SQLSERVER_PROCEDURE <procedure name> PASSING <VALUE1|VARIABLE1> [SQLOUT] <VALUE2|VARIABLE2> [SQLOUT] ...
32644>>>>>//
32644>>>>>// Executes a stored procedure. SQLOUT will be used to indicate that the stored procedure
32644>>>>>// returns a parameter. The matching parameter in the stored proceudre must have been created with
32644>>>>>// the keyword OUTPUT. Call all procedures that doesn't returns any query with this syntax
32644>>>>>//
32644>>>>>//
32644>>>>>//
32644>>>>>//-----------------------------------------------------------------------------
32644>>>>>
32644>>>>>
32644>>>>>//=============================================================================
32644>>>>>// ORAFlex Commands
32644>>>>>//-----------------
32644>>>>>//----------------------------
32644>>>>>// ORAFlex_REVISION <VARIABLE>
32644>>>>>// Retrieves ORAFlex revision
32644>>>>>//
32644>>>>>//---------------------------------
32644>>>>>// KEEP_FILES_OPEN OF <SERVER NAME>
32644>>>>>// Keeps all files opened even during a LOGOUT
32644>>>>>//
32644>>>>>//-----------------------------------------------
32644>>>>>// SET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
32644>>>>>// Defines the maximum number of cursors that ORAFlex will be allowed for using
32644>>>>>//
32644>>>>>//-----------------------------------------------
32644>>>>>// GET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
32644>>>>>// Retrieves the maximum number of cursors allowed for ORAFlex use
32644>>>>>//
32644>>>>>//---------------------------------------------
32644>>>>>// GET_OPENED_CURSORS OF <SERVER NAME> TO <VAR>
32644>>>>>// Retrieves the number of opened cursors
32644>>>>>//
32644>>>>>//-----------------------------------------------
32644>>>>>// ACTIVATE_TIME_STAMP OF <SERVER NAME> TO ON|OFF
32644>>>>>// Activates Time stamp for date columns
32644>>>>>//
32644>>>>>//----------------------------------------------------------------------------------------------------
32644>>>>>// CALL_ORACLE_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
32644>>>>>// CALL_ORACLE_STORED_FUNCTION will call an Oracle stored function passing arguments
32644>>>>>//
32644>>>>>//-----------------------------------------------------------------------------
32644>>>>>
32644>>>>>//=============================================================================
32644>>>>>// BUFFER save stuffs
32644>>>>>//-------------------
32644>>>>>
32644>>>>>//-------------------------------------------------------
32644>>>>>// SQL_SAVE_BUFFER_BEGIN OF <FILE NUMBER> TO <CACHE SIZE>
32644>>>>>// Initialize the BUFFER buffer
32644>>>>>//
32644>>>>>//---------------------------------
32644>>>>>// SQL_SAVE_BUFFER OF <FILE NUMBER>
32644>>>>>// Moves field buffer values to cache buffer
32644>>>>>//-------------------------------------
32644>>>>>// SQL_SAVE_BUFFER_END OF <FILE NUMBER>
32644>>>>>// Save rows that remains in cache
32644>>>>>//-----------------------------------------------------------------------------
32644>>>>>
32644>>>
32644>>>//AB-StoreTopEnd
32644>>>
32644>>>//AB-IgnoreStart
32644>>>
32644>>>Use Panel.Sub
32644>>>Use Bitmap.Sub
32644>>>Use Txtbox.Sub
32644>>>Use Cmbfrm.Sub
32644>>>Use Form.Sub
32644>>>Use Chkbox.Sub
32644>>>Use Button.Sub
32644>>>
32644>>>
32644>>>//AB-IgnoreEnd
32644>>>
32644>>>Object Connect is a BasicPanelSub
32646>>>
32646>>>    //AB-StoreTopStart
32646>>>
32646>>>    //AB-StoreTopEnd
32646>>>
32646>>>    Set Sysmenu_Icon to FALSE
32647>>>    Set Minimize_Icon to FALSE
32648>>>    Set Label to "Login"
32649>>>    Set Size to 105 230
32650>>>    Set Location to 20 37
32651>>>
32651>>>    //AB-DDOStart
32651>>>
32651>>>
32651>>>    //AB-DDOEnd
32651>>>
32651>>>    Object BitmapContainer1 is a BitmapContainerSub
32653>>>        Set Size to 21 23
32654>>>        Set Location to 4 4
32655>>>        Set Bitmap to "Login1.bmp"
32656>>>        Set Border_Style to Border_None
32657>>>        Set Bitmap_Style to Bitmap_Center
32658>>>        Set Dialog_Caption to "Select a bitmap file"
32659>>>
32659>>>        //AB-StoreStart
32659>>>
32659>>>
32659>>>
32659>>>
32659>>>        //AB-StoreEnd
32659>>>
32659>>>    End_Object    // BitmapContainer1
32660>>>
32660>>>    Object Textbox5 is a TextBoxSub
32662>>>        Set Label to "Driver:"
32663>>>        Set FontSize to 4 0
32664>>>        Set Location to 6 34
32665>>>        Set Size to 13 40
32666>>>        Set Enabled_State to TRUE
32667>>>    End_Object    // Textbox5
32668>>>
32668>>>    Object ComboForm2 is a ComboFormSub
32670>>>
32670>>>        //AB-StoreTopStart
32670>>>
32670>>>        Set CapsLock_State to True
32671>>>
32671>>>        //AB-StoreTopEnd
32671>>>
32671>>>        Set Size to 13 85
32672>>>        Set Location to 6 76
32673>>>        Set Label_Col_Offset to 2
32674>>>        Set Label_Justification_Mode to jMode_Right
32675>>>
32675>>>        //AB-StoreStart
32675>>>        Procedure Combo_Fill_List
32677>>>                Local String Availdrv## TempDrv##
32678>>>                Local Integer HowMany i p1## p2##
32678>>>
32678>>>                get_profile_string "WorkSpaces" "CurrentWorkspace" to AvailDrv##
32681>>>                If AvailDrv## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to AvailDrv##
32684>>>                insert "WorkSpaces\" in AvailDrv## at 1
32686>>>                get_profile_string AvailDrv## "AvailableDrivers" to AvailDrv##
32689>>>
32689>>>                Move Availdrv## to Tempdrv##
32690>>>                Repeat
32690>>>>
32690>>>                    Replace "|" in Tempdrv## With ""
32692>>>                    [Found] Increment HowMany
32693>>>                Until [Finderr]
32695>>>
32695>>>                Send Combo_add_Item ""
32696>>>
32696>>>                If HowMany lt 1 Begin
32698>>>                    If Availdrv## ne "" Send Combo_Add_Item (UpperCase(Availdrv##))
32701>>>                End
32701>>>>
32701>>>                Else Begin
32702>>>                    For i From 0 to HowMany
32708>>>>
32708>>>                        If i eq 0 Move 1 to p1##
32711>>>                        Else Begin
32712>>>                            Move ((Pos("|",Availdrv##))+1) to p1##
32713>>>                            Replace "|" in Availdrv## With ","
32715>>>                        End
32715>>>>
32715>>>                        Move ((Pos("|",Availdrv##))) to p2##
32716>>>                        Send Combo_Add_Item (UpperCase(Mid(Availdrv##,(p2##-p1##),p1##)))
32717>>>                    Loop
32718>>>>
32718>>>                End
32718>>>>
32718>>>        End_Procedure
32719>>>
32719>>>        Set Allow_Blank_state to True
32720>>>
32720>>>
32720>>>
32720>>>        //AB-StoreEnd
32720>>>
32720>>>    End_Object    // ComboForm2
32721>>>
32721>>>    Object Textbox6 is a TextBoxSub
32723>>>        Set Label to "Server:"
32724>>>        Set FontSize to 4 0
32725>>>        Set Location to 22 34
32726>>>        Set Size to 13 40
32727>>>        Set Enabled_State to TRUE
32728>>>    End_Object    // Textbox6
32729>>>
32729>>>    Object Form4 is a FormSub
32731>>>        Set Size to 13 93
32732>>>        Set Location to 22 76
32733>>>        Set Label_Col_Offset to 2
32734>>>        Set Label_Justification_Mode to jMode_Right
32735>>>    End_Object    // Form4
32736>>>
32736>>>    Object Textbox7 is a TextBoxSub
32738>>>        Set Label to "User Name:"
32739>>>        Set FontSize to 4 0
32740>>>        Set Location to 38 34
32741>>>        Set Size to 13 40
32742>>>        Set Enabled_State to TRUE
32743>>>    End_Object    // Textbox7
32744>>>
32744>>>    Object Form5 is a FormSub
32746>>>        Set Size to 13 93
32747>>>        Set Location to 38 76
32748>>>        Set Label_Col_Offset to 2
32749>>>        Set Label_Justification_Mode to jMode_Right
32750>>>    End_Object    // Form5
32751>>>
32751>>>    Object Textbox8 is a TextBoxSub
32753>>>        Set Label to "Password:"
32754>>>        Set FontSize to 4 0
32755>>>        Set Location to 54 34
32756>>>        Set Size to 13 40
32757>>>        Set Enabled_State to TRUE
32758>>>    End_Object    // Textbox8
32759>>>
32759>>>    Object Form6 is a FormSub
32761>>>        Set Size to 13 93
32762>>>        Set Location to 54 76
32763>>>        Set Label_Col_Offset to 2
32764>>>        Set Label_Justification_Mode to jMode_Right
32765>>>
32765>>>        //AB-StoreStart
32765>>>        Set Password_State Item 0 to True
32766>>>
32766>>>        //AB-StoreEnd
32766>>>
32766>>>    End_Object    // Form6
32767>>>
32767>>>    Object CheckBox1 is a CheckBoxSub
32769>>>        Set Label to "Save Password"
32770>>>        Set Size to 10 66
32771>>>        Set Location to 73 76
32772>>>        Set Status_Help to "Remember The Password at Next Login"
32773>>>    End_Object    // CheckBox1
32774>>>
32774>>>    Object oOK_bn is a ButtonSub
32776>>>        Set Label to "Co&nnect"
32777>>>        Set Default_State to TRUE
32778>>>        Set Bitmap to "mcr.bmp"
32779>>>        Set Size to 28 33
32780>>>        Set Location to 9 184
32781>>>
32781>>>        //AB-StoreStart
32781>>>        Procedure OnClick
32783>>>            Set LoginOk to True
32784>>>            Send Stop_Modal_ui
32785>>>        End_Procedure
32786>>>        Set Status_Help to "Connect"
32787>>>        //AB-StoreEnd
32787>>>
32787>>>    End_Object    // oOK_bn
32788>>>
32788>>>    Object oCancel_bn is a ButtonSub
32790>>>        Set Label to "&Cancel"
32791>>>        Set Bitmap to "exit2.bmp"
32792>>>        Set Size to 28 32
32793>>>        Set Location to 39 184
32794>>>
32794>>>        //AB-StoreStart
32794>>>
32794>>>        ON_KEY KENTER SEND Exit_Application to (Connect(Current_Object))
32795>>>
32795>>>        Procedure OnClick
32797>>>            Set LoginOk to False
32798>>>            Send Exit_Application to (Connect(Current_Object))
32799>>>        End_Procedure
32800>>>
32800>>>        Set Status_Help to "Close Application"
32801>>>
32801>>>
32801>>>        //AB-StoreEnd
32801>>>
32801>>>    End_Object    // oCancel_bn
32802>>>
32802>>>
32802>>>    //AB-StoreStart
32802>>>
32802>>>    Set Modal_State to True
32803>>>
32803>>>    // Now is WorkspaceAware
32803>>>
32803>>>    ON_KEY KENTER SEND OnClick to (oOk_bn(Current_Object))
32804>>>    ON_KEY KSAVE_RECORD SEND OK
32805>>>    ON_KEY KCANCEL SEND EXIT_APPLICATION
32806>>>    ON_KEY KCLOSE_PANEL SEND EXIT_APPLICATION
32807>>>
32807>>>    Set Locate_Mode to Center_On_Screen
32808>>>    Set Exit_Application_Local_State to False
32809>>>    Set Exit_MSG to Exit
32810>>>    Set Description_State to True
32811>>>
32811>>>    Property Integer LoginOk public false
32813>>>
32813>>>    External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;        Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
32814>>>
32814>>>    Function Network_User_Name Returns String
32816>>>        Local String sName sLength
32817>>>        Local Pointer lpName_Addr lpLength_Addr
32817>>>        Local Integer iRetval
32817>>>
32817>>>        Movestr (Repeat (Character (0), 255)) To sName
32818>>>>
32818>>>        GetAddress Of sName To lpName_Addr
32819>>>        Movestr (DwordToBytes (255)) To sLength
32820>>>>
32820>>>        GetAddress Of sLength To lpLength_Addr
32821>>>
32821>>>        Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
32822>>>>
32822>>>
32822>>>        If iRetval Eq 0 Function_Return (CString (sName))
32825>>>        Else Function_Return "User Unknown"
32827>>>    End_Function // Network_User_Name
32828>>>
32828>>>    Function fsCrypto String lsWay String lsOld Returns String
32830>>>        Local String lsNew lsTemp
32831>>>        Local Integer liCount
32831>>>           For liCount From 1 to (Length(lsOld))
32837>>>>
32837>>>               Mid lsOld to lsTemp 1 liCount
32840>>>>
32840>>>               If ((Uppercase(lsWay)) eq 'FORWARD') Begin
32842>>>               If ((Ascii(lsTemp) = 255)) Move (Character(32)) to lsTemp
32845>>>               Else Move (Character(Ascii(lsTemp)+1)) to lsTemp
32847>>>               End
32847>>>>
32847>>>               Else Begin
32848>>>                   If ((Uppercase(lsWay)) eq 'BACKWARD') Begin
32850>>>                       If ((Ascii(lsTemp) = 32)) Move (Character(255)) to lsTemp
32853>>>                       Else Move (Character(Ascii(lsTemp)-1)) to lsTemp
32855>>>                   End
32855>>>>
32855>>>               End
32855>>>>
32855>>>               Append lsNew lsTemp
32856>>>           Loop
32857>>>>
32857>>>        Function_Return (lsNew)
32858>>>    End_Function
32859>>>
32859>>>    Procedure Activating
32861>>>        Local String LoginDriver## LoginServer## LoginUserid## LoginPassword##
32862>>>        Local String LastLogin## LoginSeq##
32862>>>        Local Integer SavePassword##
32862>>>
32862>>>        Forward Send Activating
32864>>>
32864>>>        get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
32867>>>        If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
32870>>>        insert "WorkSpaces\" in LastLogin## at 1
32872>>>        Append LastLogin## "\" (Module_Name(Self)) "\LastLogin"
32875>>>        get_profile_string LastLogin## "LoginDriver" to LoginSeq##
32878>>>
32878>>>        If "|" in LoginSeq## move (left(LoginSeq##,(pos("|",LoginSeq##) -1))) to LoginDriver##
32881>>>        Else Move LoginSeq## to LoginDriver##
32883>>>        get_profile_string LastLogin## "LoginServer"  to LoginServer##
32886>>>        get_profile_string LastLogin## "LoginUserId"  to LoginUserId##
32889>>>        get_profile_string LastLogin## "SavePassword" to SavePassword##
32892>>>        If LoginUserId## eq "" Move (Network_User_Name(Current_Object)) to LoginUserId##
32895>>>
32895>>>        If (((UpperCase(LoginDriver##)) eq "DATAFLEX") or (LoginDriver## eq "")) Begin
32897>>>                Set Value of (ComboForm2(Current_Object)) Item 0 to ""
32898>>>                Set Value of (Form4(Current_Object))      Item 0 to ""
32899>>>        End
32899>>>>
32899>>>        Else Begin
32900>>>            Set Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
32901>>>            Set Value of (Form4(Current_Object))      Item 0 to LoginServer##
32902>>>        End
32902>>>>
32902>>>        Set Value of (Form5(Current_Object))      Item 0 to LoginUserID##
32903>>>        Set Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
32904>>>        If (SavePassword##) Begin
32906>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
32907>>>            get_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to LoginPassword##
32911>>>            Set Value of (Form6(Current_Object))      Item 0 to (fsCrypto(Self,"backward",LoginPassword##))
32912>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
32913>>>        End
32913>>>>
32913>>>    End_Procedure
32914>>>
32914>>>    Function LoginUser Returns Integer
32916>>>        Integer SavePassword## Size## PasswordOk
32917>>>        String LoginDriver## LoginServer## LoginUserid## LoginPassword## LoginSeq## LastLogin##
32917>>>        String lsLoginDate lsHH lsMM lsSS sDepartment
32917>>>        Integer liOpenCursors
32917>>>
32917>>>        Send Popup_Modal
32918>>>
32918>>>        Get Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
32919>>>        Get Value of (Form4(Current_Object))      Item 0 to LoginServer##
32920>>>        Get Value of (Form5(Current_Object))      Item 0 to LoginUserID##
32921>>>        Get Value of (Form6(Current_Object))      Item 0 to LoginPassword##
32922>>>        Get Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
32923>>>        Set Value of (Form6(Current_Object))      Item 0 to ""
32924>>>
32924>>>        If ((LoginDriver## <> "") and (UpperCase(LoginDriver##)<>"DATAFLEX"))  begin
32926>>>            send ignore_error to (error_info_object(current_object)) 25000
32927>>>            send ignore_error to (error_info_object(current_object)) 4255
32928>>>            send ignore_error to (error_info_object(current_object)) 12293
32929>>>            login LoginServer## LoginUserId## LoginPassword## LoginDriver##
32931>>>            send trap_error to (error_info_object(current_object)) 25000
32932>>>            send trap_error to (error_info_object(current_object)) 4255
32933>>>            send trap_error to (error_info_object(current_object)) 12293
32934>>>            If LastErr eq 25000 Begin
32936>>>                Error LastErr "Invalid Login Information"
32937>>>>
32937>>>                Set LoginOk to False
32938>>>                Send Exit_Application
32939>>>            End
32939>>>>
32939>>>            If LastErr eq 4255 Begin
32941>>>                Error LastErr "Invalid Driver Name"
32942>>>>
32942>>>                Set LoginOk to False
32943>>>                Send Exit_Application
32944>>>            End
32944>>>>
32944>>>            If LastErr eq 12293 Begin
32946>>>                Error LastErr "(IBM CLI)Database alias name or Database name not found"
32947>>>>
32947>>>                Set LoginOk to False
32948>>>                Send Exit_Application
32949>>>            End
32949>>>>
32949>>>            Set LoginOk to True
32950>>>            If (UpperCase(LoginDriver##) = "ORA_DRV") Begin
32952>>>                GET_MAX_OPEN_CURSORS of LoginServer## to liOpenCursors
32965>>>                If (liOpenCursors <> 0) SET_MAX_OPEN_CURSORS of LoginServer## to (liOpenCursors+2)
32978>>>            End
32978>>>>
32978>>>        End
32978>>>>
32978>>>        Else Begin
32979>>>            Set LoginOk to True
32980>>>            Open "Users" as Users
INCLUDING FILE: USERS.FD
32982>>>            Move "DATAFLEX" To LoginDriver##
32983>>>            Move "" to LoginServer##
32984>>>            File_Size Users to Size##
32987>>>            If Size## ne 0 Begin
32989>>>                 Clear Users
32990>>>                 Move LoginUSerId##   to Users.Login_Id
32991>>>                 Find eq Users by Index.1
32992>>>>
32992>>>                 [Finderr] Begin
32994>>>>
32994>>>                    Error 25000 "Unknown User"
32995>>>>
32995>>>                    Set LoginOk to False
32996>>>                    Get LoginOk to PasswordOk
32997>>>                    Function_Return PasswordOk
32998>>>                 End
32998>>>>
32998>>>                 [Found] Begin
33000>>>>
33000>>>                    If (LoginPassword## ne Users.Password) Begin
33002>>>                        Error 25000 "Invalid Password"
33003>>>>
33003>>>                        Set LoginOk to False
33004>>>                        Get LoginOk to PasswordOk
33005>>>                        Function_Return PasswordOk
33006>>>                    End
33006>>>>
33006>>>                    Else Move Users.Departm_Code to sDepartment
33008>>>                    Move (Trim(sDepartment)) to sDepartment
33009>>>                 End
33009>>>>
33009>>>            End
33009>>>>
33009>>>            Close Users
33010>>>
33010>>>
33010>>>    //            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33010>>>    //            Integer bFileExists
33010>>>    //            Get Get_File_Exists  "C:\AutLogIn.txt" To bFileExists
33010>>>    //            If (NOT(bFileExists)) Begin
33010>>>
33010>>>    //                Get Get_File_Exists  "C:\UsrLogin.txt" To bFileExists
33010>>>    //                If (bFileExists) Begin
33010>>>
33010>>>    ////                        If Size## ne 0 Begin
33010>>>
33010>>>    //                            Local String ss1 ss2 ss3 ss4
33010>>>    //                            Local String dd1 dd2 dd3 dd4
33010>>>    //                            Move '' to dd1
33010>>>    //                            Move '' to dd2
33010>>>    //                            Move '' to dd3
33010>>>    //                            Move '' to dd4
33010>>>
33010>>>    //                            Direct_Input Channel 8 "C:\UsrLogin.txt"
33010>>>    //                            Readln Channel 8 ss1 ss2 ss3 ss4
33010>>>    //                            While (Not(Seqeof))
33010>>>    //                                Move (Trim(ss1)) to ss1
33010>>>    //                                Move (Trim(ss2)) to ss2
33010>>>    //                                Move (Trim(ss3)) to ss3
33010>>>    //                                Move (Trim(ss4)) to ss4
33010>>>    //                                Append dd1 '"' ss1 '"'
33010>>>    //                                Append dd2 '"' ss2 '"'
33010>>>    //                                Append dd3 '"' ss3 '"'
33010>>>    //                                Append dd4 '"' ss4 '"'
33010>>>    //                                Login dd1 dd2 dd3 dd4
33010>>>    //                                Readln Channel 8 ss1 ss2 ss3 ss4
33010>>>    //                            Loop
33010>>>
33010>>>
33010>>>    ////                            // Only Filmnet Users Log on to SQL
33010>>>    ////                            If (sDepartment='FILMNET') Begin
33010>>>    ////                                ////// 20/06/2001 js Allagh apo Oracle se SQL server
33010>>>    ////                                ////// login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33010>>>    ////                                login '192.168.128.5'   'sa'    ''   'SQL_DRV'
33010>>>    ////                                login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33010>>>    ////                            End
33010>>>    ////                            Else login '192.168.128.5'      'sa'    ''   'SQL_DRV'
33010>>>    ////                            //Else login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33010>>>
33010>>>    ////                        End
33010>>>    ////                        Else Begin
33010>>>    ////                            ////// 20/06/2001 js Allagh apo Oracle se SQL server
33010>>>    ////                            ///// login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33010>>>    ////                            login '192.168.128.5'       'sa'    ''   'SQL_DRV'
33010>>>    ////                            //login '192.168.128.5'   'EPGDNS'    'DNS'   'SQL_DRV'
33010>>>    ////                            login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33010>>>    ////                        End
33010>>>
33010>>>
33010>>>    //                End
33010>>>
33010>>>    //            End
33010>>>    //            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33010>>>
33010>>>
33010>>>
33010>>>            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33010>>>            //*Integer bFileExists
33010>>>            //*Get Get_File_Exists  "C:\AutLogIn.txt" To bFileExists
33010>>>            //*If (NOT(bFileExists)) Begin
33010>>>            //*    If Size## ne 0 Begin
33010>>>            //*        // Only Filmnet Users Log on to SQL
33010>>>            //*        If (sDepartment='FILMNET') Begin
33010>>>            //*            login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33010>>>            //*            login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33010>>>            //*        End
33010>>>            //*        Else login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33010>>>            //*    End
33010>>>            //*    Else Begin
33010>>>            //*        login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33010>>>            //*        login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33010>>>            //*    End
33010>>>            //*
33010>>>            //*End
33010>>>            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33010>>>
33010>>>
33010>>>
33010>>>        End
33010>>>>
33010>>>
33010>>>        Get LoginOk to PasswordOk
33011>>>        Sysdate lsLoginDate lsHH lsMM lsSS
33015>>>        get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
33018>>>        If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
33021>>>        insert "WorkSpaces\" in LastLogin## at 1
33023>>>        get_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
33026>>>        If ((LoginDriver## ne "") and ((UpperCase(LoginDriver##)) ne "DATAFLEX")) Begin
33028>>>           If Not LoginDriver## in LoginSeq## Begin
33030>>>                 If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
33033>>>                 Else Move (LoginSeq##+"|"+LoginDriver##) to LoginSeq##
33035>>>                 set_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
33038>>>           End
33038>>>>
33038>>>        End
33038>>>>
33038>>>        Append LastLogin## "\" (Module_Name(Self))
33040>>>        Append LastLogin## "\LastLogin"
33041>>>        get_profile_string LastLogin## "LoginDriver" to LoginSeq##
33044>>>
33044>>>        If "|" in LoginSeq## Begin
33046>>>            If ((left(LoginSeq##,(pos("|",LoginSeq##) -1))) ne LoginDriver##) Insert (LoginDriver##+"|") in LoginSeq## at 1
33050>>>        End
33050>>>>
33050>>>        Else Begin
33051>>>            If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
33054>>>            Else If LoginSeq## ne LoginDriver## Insert (LoginDriver##+"|") in LoginSeq## at 1
33059>>>        End
33059>>>>
33059>>>        Left LoginSeq## to LoginSeq## 250
33061>>>>
33061>>>        set_profile_string LastLogin## "LoginDriver" to (UpperCase(LoginSeq##))
33064>>>        set_profile_string LastLogin## "LoginServer" to LoginServer##
33067>>>        set_profile_string LastLogin## "LoginUserId" to LoginUserId##
33070>>>        set_profile_string LastLogin## "SavePassword" to SavePassword##
33073>>>        If lsHH lt 10 Insert 0 in lsHH at 1
33077>>>        If lsMM lt 10 Insert 0 in lsMM at 1
33081>>>        If lsSS lt 10 Insert 0 in lsSS at 1
33085>>>        Append lsLoginDate " - " lsHH ":" lsMM ":" lsSS
33091>>>        set_profile_string LastLogin## "LoginTime" to lsLoginDate
33094>>>        If (SavePassword##) Begin
33096>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33097>>>            set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to (fsCrypto(Self,"forward",LoginPassword##))
33100>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33101>>>        End
33101>>>>
33101>>>        Else Begin
33102>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33103>>>            set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to ""
33106>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33107>>>        End
33107>>>>
33107>>>
33107>>>        Function_Return PasswordOk
33108>>>    End_Function
33109>>>
33109>>>    Procedure Login For Desktop
33110>>>        Local Integer LoginPassword##
33111>>>        Get LoginUser of (Connect(Current_Object)) to LoginPassword##
33112>>>        If Not LoginPassword## Send Exit_Application
33115>>>    End_Procedure
33116>>>
33116>>>    Function CheckLogin For Desktop Returns Integer
33117>>>        Local Integer LoginPassword##
33118>>>        Get LoginUser of (Connect(Current_Object)) to LoginPassword##
33119>>>        Function_Return LoginPassword##
33120>>>    End_Function
33121>>>
33121>>>
33121>>>
33121>>>    //AB-StoreEnd
33121>>>
33121>>>End_Object    // Connect
33122>>>
33122>>>
33122>>>//AB-StoreStart
33122>>>
33122>>>
33122>>>
33122>>>//AB-StoreEnd
33122>>>
33122>>>//AB/ End_Object    // prj
33122>Send Login
33123>Use SelectXr.Dg
INCLUDING FILE: SELECTXR.DG
33123>>>//AB/ Project Select / Change Xrhsh
33123>>>//AB/     Object prj is a Dialog_Project
33123>>>//AB/         Set ProjectName to "Select / Change Xrhsh"
33123>>>//AB/         Set ProjectFileName to "SelectXR.DG"
33123>>>
33123>>>// Project Object Structure
33123>>>//   oSelectYear is a dbModalPanelSub
33123>>>//     Company_DD is a DataDictionary
33123>>>//     Branch_DD is a DataDictionary
33123>>>//     Year_DD is a DataDictionary
33123>>>//     Company_Company_Code is a dbFormSub
33123>>>//     Company_Company_Name is a dbFormSub
33123>>>//     Branch_Branch_Code is a dbFormSub
33123>>>//     Branch_Branch_Name is a dbFormSub
33123>>>//     Year_Year_Year is a dbFormSub
33123>>>//     Year_Year_Descr is a dbFormSub
33123>>>//     Year_Year_Entrydate is a dbFormSub
33123>>>//     oOk_bn is a ButtonSub
33123>>>//     oCancel_bn is a ButtonSub
33123>>>//     otxtCompany is a TextBoxSub
33123>>>//     otxtBranch is a TextBoxSub
33123>>>//     otxtYear is a TextBoxSub
33123>>>//     otxtWorkingDay is a TextBoxSub
33123>>>//     otxtWorkingDay is a TextBoxSub
33123>>>//     chkxr is a CheckBoxSub
33123>>>
33123>>>// Register all objects
33123>>>Register_Object Branch_Branch_Code
33123>>>Register_Object Branch_Branch_Name
33123>>>Register_Object Branch_DD
33123>>>Register_Object Company_Company_Code
33123>>>Register_Object Company_Company_Name
33123>>>Register_Object Company_DD
33123>>>Register_Object chkxr
33123>>>Register_Object oCancel_bn
33123>>>Register_Object oOk_bn
33123>>>Register_Object oSelectYear
33123>>>Register_Object otxtBranch
33123>>>Register_Object otxtCompany
33123>>>Register_Object otxtWorkingDay
33123>>>Register_Object otxtYear
33123>>>Register_Object Year_DD
33123>>>Register_Object Year_Year_Descr
33123>>>Register_Object Year_Year_Entrydate
33123>>>Register_Object Year_Year_Year
33123>>>
33123>>>
33123>>>
33123>>>    //AB-StoreTopStart
33123>>>    
33123>>>    
33123>>>    
33123>>>    
33123>>>           String  gs_selected_beto_site
33123>>>    
33123>>>    Open SysCurXR
33125>>>    Open Nomisma
33127>>>    
33127>>>    //AB-StoreTopEnd
33127>>>
33127>>>    //AB-IgnoreStart
33127>>>
33127>>>    Use DFAllEnt.pkg
33127>>>    Use dbForm.Sub
33127>>>    Use Button.Sub
33127>>>    Use Txtbox.Sub
33127>>>    Use Chkbox.Sub
33127>>>
33127>>>
33127>>>    Use COMPANY.DD
INCLUDING FILE: COMPANY.DD
33127>>>>>//DDB-FileStart
33127>>>>>//DDB-HeaderStart
33127>>>>>
33127>>>>>// File Name : COMPANY.DD
33127>>>>>// Class Name: Company_DataDictionary
33127>>>>>// Revision  : 58
33127>>>>>// Version   : 2
33127>>>>>
33127>>>>>Use  Windows           // Basic Definitions
33127>>>>>Use  DataDict          // DataDictionary Class Definition
33127>>>>>Use  DDvalTbl          // Validation Table Class Definitions
33127>>>>>
33127>>>>>Open Company
INCLUDING FILE: COMPANY.FD
33129>>>>>Open Branch
33131>>>>>
33131>>>>>//DDB-HeaderEnd
33131>>>>>//DDB-ValidationStart
33131>>>>>
33131>>>>>Register_Object Company_Company_Doy_VT
33131>>>>>Register_Object Company_Company_J_Code_VT
33131>>>>>
33131>>>>>Object Company_Company_Doy_VT  is a CodeValidationTable
33133>>>>>    Set Type_Value        To "DOY"
33134>>>>>    Set Allow_Blank_State To TRUE
33135>>>>>    //DDB-ValidationCustomStart
33135>>>>>    //DDB-ValidationCustomEnd
33135>>>>>End_Object   // Company_Company_Doy_VT
33136>>>>>
33136>>>>>Object Company_Company_J_Code_VT  is a CodeValidationTable
33138>>>>>    Set Type_Value        To "JOB"
33139>>>>>    Set Allow_Blank_State To TRUE
33140>>>>>    //DDB-ValidationCustomStart
33140>>>>>    //DDB-ValidationCustomEnd
33140>>>>>End_Object   // Company_Company_J_Code_VT
33141>>>>>//DDB-ValidationEnd
33141>>>>>//DDB-SelectionStart
33141>>>>>//DDB/ ExternalSelectionList sl001  sl001.sl
33141>>>>>Register_Object sl001
33141>>>>>//DDB-SelectionEnd
33141>>>>> 
33141>>>>>Class Company_DataDictionary  is a DataDictionary
33142>>>>> 
33142>>>>>    // Update:
33142>>>>> 
33142>>>>>    Procedure Update
33143>>>>>        Forward Send Update
33145>>>>>        move 'DOY' to company.doy_type
33146>>>>>        move 'JOB' to company.jcode_type 
33147>>>>>        // Insert Code Here
33147>>>>>    End_Procedure   // Update
33148>>>>> 
33148>>>>>
33148>>>>>    // Operation_Not_Allowed:
33148>>>>>
33148>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
33149>>>>>        // Insert Code Here
33149>>>>>        Case Begin
33149>>>>>             Case (iError_Num = 1001)
33151>>>>>                  Error 1001 "DDC 051:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª „«˜ ¨œå˜ª!\n\n‰œ¤æª ‰à› ¡æª"
33152>>>>>>
33152>>>>>             Case Break
33153>>>>>
33153>>>>>             Case Else
33153>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
33155>>>>>        Case End
33155>>>>>    End_Procedure   // Operation_Not_Allowed
33156>>>>>
33156>>>>>
33156>>>>>    // Validate_Save:
33156>>>>>
33156>>>>>    Function Validate_Save  Returns Integer
33157>>>>>        Local Integer iReturnVal
33158>>>>>        Forward Get Validate_Save  To iReturnVal
33160>>>>>        If (Not(iReturnVal)) Begin
33162>>>>>            // Insert Code Here
33162>>>>>            If (Company.Company_Code="") Send Operation_Not_Allowed 1001
33165>>>>>        End
33165>>>>>>
33165>>>>>        Function_Return iReturnVal
33166>>>>>    End_Function   // Validate_Save
33167>>>>>
33167>>>>>
33167>>>>>    // Define_Fields:
33167>>>>>    // This procedure is used to set up all data-dictionary rules.
33167>>>>>
33167>>>>>    Procedure Define_Fields
33168>>>>>        Forward Send Define_Fields
33170>>>>>        //DDB-Generated-Code-Location
33170>>>>>        //DDB-DefineFieldStart
33170>>>>>
33170>>>>>        Set Main_File            To Company.File_Number
33171>>>>>        Set Cascade_Delete_State To FALSE
33172>>>>>
33172>>>>>
33172>>>>>        // Child (Client) file structure................
33172>>>>>        Send Add_Client_File  Branch.File_Number
33173>>>>>
33173>>>>>        // Field-based properties.......................
33173>>>>>
33173>>>>>        // Company.Company_Code
33173>>>>>        Set Field_Options          Field Company.Company_Code To DD_AUTOFIND   
33174>>>>>        Set Field_Prompt_Object    Field Company.Company_Code To (sl001(Self))
33175>>>>>
33175>>>>>        // Company.Company_Name
33175>>>>>        Set Field_Options          Field Company.Company_Name To DD_REQUIRED   
33176>>>>>        Set Field_Prompt_Object    Field Company.Company_Name To (sl001(Self))
33177>>>>>
33177>>>>>        // Company.Company_Afm
33177>>>>>        Set Field_Options          Field Company.Company_Afm To DD_AUTOFIND   
33178>>>>>
33178>>>>>        // Company.Company_Addr
33178>>>>>
33178>>>>>        // Company.Company_Tk
33178>>>>>
33178>>>>>        // Company.Company_Poli
33178>>>>>
33178>>>>>        // Company.Company_Doy
33178>>>>>        Set Field_Value_Table      Field Company.Company_Doy To (Company_Company_Doy_VT(Self))
33179>>>>>
33179>>>>>        // Company.Company_J_Code
33179>>>>>        Set Field_Value_Table      Field Company.Company_J_Code To (Company_Company_J_Code_VT(Self))
33180>>>>>
33180>>>>>        // Company.Company_C_Code0
33180>>>>>
33180>>>>>        // Company.Company_C_Cod00
33180>>>>>
33180>>>>>        // Company.Company_C_Coder
33180>>>>>
33180>>>>>        // Company.Company_Tel
33180>>>>>
33180>>>>>        // Company.Company_Fax
33180>>>>>
33180>>>>>        // Company.Company_Email
33180>>>>>
33180>>>>>        // Company.Company_Resp
33180>>>>>
33180>>>>>        // Company.Company_Bitmap
33180>>>>>
33180>>>>>        // Company.Beto_Site
33180>>>>>
33180>>>>>        // Company.Logo
33180>>>>>
33180>>>>>        // Company.Doy_Type
33180>>>>>
33180>>>>>        // Company.Jcode_Type
33180>>>>>
33180>>>>>        //DDB-DefineFieldEnd
33180>>>>>    End_Procedure    // Define_Fields
33181>>>>>
33181>>>>>    // Field_Defaults:
33181>>>>>    // This procedure is used to establish default field values.
33181>>>>>
33181>>>>>    Procedure Field_Defaults
33182>>>>>        Forward Send Field_Defaults
33184>>>>>        //DDB-Generated-Code-Location
33184>>>>>        //DDB-FieldDefaultStart
33184>>>>>        //DDB-FieldDefaultEnd
33184>>>>>    End_Procedure    // Field_Defaults
33185>>>>>End_Class    // Company_DataDictionary
33186>>>>>
33186>>>>>//DDB-Selection-pkg-Start
33186>>>>>
33186>>>>>Use sl001.sl         // sl001
INCLUDING FILE: SL001.SL
33186>>>>>>>//AB/ Project sl001 : Etairies
33186>>>>>>>//AB/     Object prj is a Lookup_Project
33186>>>>>>>//AB/         Set ProjectName to "sl001 : Etairies"
33186>>>>>>>//AB/         Set ProjectFileName to "sl001.SL"
33186>>>>>>>//AB/         Set GenerateFileName to "NONAME"
33186>>>>>>>
33186>>>>>>>// Project Object Structure
33186>>>>>>>//   sl001 is a dbModalPanel
33186>>>>>>>//     Company_DD is a DataDictionary
33186>>>>>>>//     oSelList is a dbList
33186>>>>>>>//     oOK_bn is a ButtonSub
33186>>>>>>>//     oCancel_bn is a ButtonSub
33186>>>>>>>//     oSearch_bn is a ButtonSub
33186>>>>>>>
33186>>>>>>>// Register all objects
33186>>>>>>>Register_Object Company_DD
33186>>>>>>>Register_Object oCancel_bn
33186>>>>>>>Register_Object oOK_bn
33186>>>>>>>Register_Object oSearch_bn
33186>>>>>>>Register_Object oSelList
33186>>>>>>>Register_Object sl001
33186>>>>>>>
33186>>>>>>>
33186>>>>>>>    //AB-IgnoreStart
33186>>>>>>>
33186>>>>>>>    Use DFAllEnt.pkg
33186>>>>>>>    Use Button.Sub
33186>>>>>>>
33186>>>>>>>
33186>>>>>>>    Use COMPANY.DD
33186>>>>>>>    
33186>>>>>>>    //AB-IgnoreEnd
33186>>>>>>>
33186>>>>>>>    CD_Popup_Object sl001 is a dbModalPanel
33205>>>>>>>        Set Label to "„«˜ ¨åœª"
33206>>>>>>>        Set Size to 148 297
33207>>>>>>>        Set Location to 12 27
33208>>>>>>>
33208>>>>>>>        //AB-DDOStart
33208>>>>>>>
33208>>>>>>>        Object Company_DD is a Company_DataDictionary
33210>>>>>>>        End_Object    // Company_DD
33211>>>>>>>
33211>>>>>>>        Set Main_DD to (Company_DD(self))
33212>>>>>>>        Set Server to (Company_DD(self))
33213>>>>>>>
33213>>>>>>>        //AB-DDOEnd
33213>>>>>>>
33213>>>>>>>        Object oSelList is a dbList
33215>>>>>>>            Set Main_File to Company.File_Number
33216>>>>>>>            Set Size to 105 280
33217>>>>>>>            Set Location to 6 6
33218>>>>>>>
33218>>>>>>>            Begin_Row
33221>>>>>>>                Entry_Item Company.Company_code
33222>>>>>>>                Entry_Item Company.Company_name
33223>>>>>>>                Entry_Item Company.Company_afm
33224>>>>>>>            End_Row
33229>>>>>>>
33229>>>>>>>            Set Form_Width    item 0 to 42
33230>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
33231>>>>>>>            
33231>>>>>>>            Set Form_Width    item 1 to 150
33232>>>>>>>            Set Header_Label  item 1 to "„§à¤¬£å˜"
33233>>>>>>>            
33233>>>>>>>            Set Form_Width    item 2 to 80
33234>>>>>>>            Set Header_Label  item 2 to "€.”.‹"
33235>>>>>>>            
33235>>>>>>>        End_Object    // oSelList
33236>>>>>>>
33236>>>>>>>        Object oOK_bn is a ButtonSub
33238>>>>>>>            Set Label to "&„§ ¢¦šã"
33239>>>>>>>            Set Location to 115 126
33240>>>>>>>
33240>>>>>>>            //AB-StoreStart
33240>>>>>>>            Procedure OnClick
33242>>>>>>>                Send OK To (oSelList(current_object))
33243>>>>>>>            End_Procedure
33244>>>>>>>            //AB-StoreEnd
33244>>>>>>>
33244>>>>>>>        End_Object    // oOK_bn
33245>>>>>>>
33245>>>>>>>        Object oCancel_bn is a ButtonSub
33247>>>>>>>            Set Label to "&€¡ç¨à©ž"
33248>>>>>>>            Set Location to 115 181
33249>>>>>>>
33249>>>>>>>            //AB-StoreStart
33249>>>>>>>            Procedure OnClick
33251>>>>>>>                Send Cancel To (oSelList(current_object))
33252>>>>>>>            End_Procedure
33253>>>>>>>            //AB-StoreEnd
33253>>>>>>>
33253>>>>>>>        End_Object    // oCancel_bn
33254>>>>>>>
33254>>>>>>>        Object oSearch_bn is a ButtonSub
33256>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
33257>>>>>>>            Set Location to 115 236
33258>>>>>>>
33258>>>>>>>            //AB-StoreStart
33258>>>>>>>            Procedure OnClick
33260>>>>>>>                Send Search To (oSelList(current_object))
33261>>>>>>>            End_Procedure
33262>>>>>>>            //AB-StoreEnd
33262>>>>>>>
33262>>>>>>>        End_Object    // oSearch_bn
33263>>>>>>>
33263>>>>>>>
33263>>>>>>>        //AB-StoreStart
33263>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To oOk_bn
33264>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To oCancel_bn
33265>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To oSearch_bn
33266>>>>>>>        //AB-StoreEnd
33266>>>>>>>
33266>>>>>>>    CD_End_Object    // sl001
33268>>>>>>>>
33268>>>>>>>
33268>>>>>>>//AB/     End_Object    // prj
33268>>>>>
33268>>>>>//DDB-Selection-pkg-End
33268>>>>>//DDB-FileEnd
33268>>>    Use BRANCH.DD
INCLUDING FILE: BRANCH.DD
33268>>>>>//DDB-FileStart
33268>>>>>//DDB-HeaderStart
33268>>>>>
33268>>>>>// File Name : BRANCH.DD
33268>>>>>// Class Name: Branch_DataDictionary
33268>>>>>// Revision  : 75
33268>>>>>// Version   : 2
33268>>>>>
33268>>>>>Use  Windows           // Basic Definitions
33268>>>>>Use  DataDict          // DataDictionary Class Definition
33268>>>>>Use  DDvalTbl          // Validation Table Class Definitions
33268>>>>>
33268>>>>>Open Branch
33270>>>>>Open Year
33272>>>>>Open Brzones
INCLUDING FILE: BRZONES.FD
33274>>>>>Open Tpbranch
INCLUDING FILE: TPBRANCH.FD
33276>>>>>Open Company
33278>>>>>Open Sysrecg
INCLUDING FILE: SYSRECG.FD
33280>>>>>
33280>>>>>//DDB-HeaderEnd
33280>>>>>//DDB-ValidationStart
33280>>>>>
33280>>>>>Register_Object Branch_Branch_Doy_VT
33280>>>>>Register_Object Branch_Branch_J_Code_VT
33280>>>>>Register_Object Branch_Branch_C_Code0_VT
33280>>>>>
33280>>>>>Object Branch_Branch_Doy_VT  is a CodeValidationTable
33282>>>>>    Set Type_Value        To "DOY"
33283>>>>>    Set Validate_State    To FALSE
33284>>>>>    Set Allow_Blank_State To TRUE
33285>>>>>    //DDB-ValidationCustomStart
33285>>>>>    //DDB-ValidationCustomEnd
33285>>>>>End_Object   // Branch_Branch_Doy_VT
33286>>>>>
33286>>>>>Object Branch_Branch_J_Code_VT  is a CodeValidationTable
33288>>>>>    Set Type_Value        To "JOB"
33289>>>>>    Set Allow_Blank_State To TRUE
33290>>>>>    //DDB-ValidationCustomStart
33290>>>>>    //DDB-ValidationCustomEnd
33290>>>>>End_Object   // Branch_Branch_J_Code_VT
33291>>>>>
33291>>>>>Object Branch_Branch_C_Code0_VT  is a CodeValidationTable
33293>>>>>    Set Type_Value        To ""
33294>>>>>    Set Allow_Blank_State To TRUE
33295>>>>>    //DDB-ValidationCustomStart
33295>>>>>    //DDB-ValidationCustomEnd
33295>>>>>End_Object   // Branch_Branch_C_Code0_VT
33296>>>>>//DDB-ValidationEnd
33296>>>>>//DDB-SelectionStart
33296>>>>>//DDB/ ExternalSelectionList SL002  Sl002.sl
33296>>>>>Register_Object SL002
33296>>>>>//DDB-SelectionEnd
33296>>>>>
33296>>>>>Class Branch_DataDictionary  is a DataDictionary
33297>>>>> 
33297>>>>>    Procedure Save_Main_File
33298>>>>>        Forward Send Save_Main_File
33300>>>>>        // Insert Code Here
33300>>>>>    End_Procedure   // Save_Main_File
33301>>>>> 
33301>>>>>    Procedure Creating
33302>>>>>        Forward Send Creating
33304>>>>>        // Insert Code Here
33304>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Branch.Branch_Rec0)))))) to Branch.Branch_Recr
33305>>>>>    End_Procedure   // Creating
33306>>>>>
33306>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
33307>>>>>        // Insert Code Here
33307>>>>>        Case Begin
33307>>>>>             Case (iError_Num = 1001)
33309>>>>>                  Error 1001 "DDC 052:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
33310>>>>>>
33310>>>>>             Case Break
33311>>>>>
33311>>>>>             Case Else
33311>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
33313>>>>>        Case End
33313>>>>>    End_Procedure   // Operation_Not_Allowed
33314>>>>>
33314>>>>>
33314>>>>>    // Validate_Save:
33314>>>>>
33314>>>>>    Function Validate_Save  Returns Integer
33315>>>>>        Local Integer iReturnVal
33316>>>>>        Forward Get Validate_Save  To iReturnVal
33318>>>>>        If (Not(iReturnVal)) Begin
33320>>>>>            // Insert Code Here
33320>>>>>            If (Branch.Branch_Code="") Send Operation_Not_Allowed 1001
33323>>>>>        End
33323>>>>>>
33323>>>>>        Function_Return iReturnVal
33324>>>>>    End_Function   // Validate_Save
33325>>>>>
33325>>>>>
33325>>>>>    // Define_Fields:
33325>>>>>    // This procedure is used to set up all data-dictionary rules.
33325>>>>>
33325>>>>>    Procedure Define_Fields
33326>>>>>        Forward Send Define_Fields
33328>>>>>        //DDB-Generated-Code-Location
33328>>>>>        //DDB-DefineFieldStart
33328>>>>>
33328>>>>>        Set Main_File            To Branch.File_Number
33329>>>>>        Set Cascade_Delete_State To FALSE
33330>>>>>
33330>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
33331>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOENTER     DD_FINDREQ    
33332>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
33333>>>>>
33333>>>>>        // Child (Client) file structure................
33333>>>>>        Send Add_Client_File  Year.File_Number
33334>>>>>        Send Add_Client_File  Brzones.File_Number
33335>>>>>        Send Add_Client_File  Tpbranch.File_Number
33336>>>>>
33336>>>>>        // Parent (Server) file structure...............
33336>>>>>        Send Add_Server_File  Company.File_Number
33337>>>>>
33337>>>>>        // External (System) file structure.............
33337>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
33338>>>>>
33338>>>>>        Define_Auto_Increment  Sysrecg.Branch_Rec0  To Branch.Branch_Rec0
33341>>>>>
33341>>>>>        // Field-based properties.......................
33341>>>>>
33341>>>>>        // Branch.Company_Code
33341>>>>>
33341>>>>>        // Branch.Branch_Code
33341>>>>>        Set Field_Options          Field Branch.Branch_Code To DD_AUTOFIND   
33342>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Code To (SL002(Self))
33343>>>>>        Set Key_Field_State        Field Branch.Branch_Code To TRUE
33344>>>>>
33344>>>>>        // Branch.Branch_Rec0
33344>>>>>
33344>>>>>        // Branch.Branch_Recr
33344>>>>>
33344>>>>>        // Branch.Branch_Name
33344>>>>>        Set Field_Options          Field Branch.Branch_Name To DD_REQUIRED   
33345>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Name To (SL002(Self))
33346>>>>>
33346>>>>>        // Branch.Branch_Afm
33346>>>>>
33346>>>>>        // Branch.Branch_Addr
33346>>>>>
33346>>>>>        // Branch.Branch_Tk
33346>>>>>
33346>>>>>        // Branch.Branch_Poli
33346>>>>>
33346>>>>>        // Branch.Branch_Doy
33346>>>>>        Set Field_Value_Table      Field Branch.Branch_Doy To (Branch_Branch_Doy_VT(Self))
33347>>>>>
33347>>>>>        // Branch.Branch_J_Code
33347>>>>>        Set Field_Value_Table      Field Branch.Branch_J_Code To (Branch_Branch_J_Code_VT(Self))
33348>>>>>
33348>>>>>        // Branch.Branch_C_Code0
33348>>>>>        Set Field_Value_Table      Field Branch.Branch_C_Code0 To (Branch_Branch_C_Code0_VT(Self))
33349>>>>>
33349>>>>>        // Branch.Branch_C_Code00
33349>>>>>
33349>>>>>        // Branch.Branch_C_Coder
33349>>>>>
33349>>>>>        // Branch.Branch_Tel
33349>>>>>
33349>>>>>        // Branch.Branch_Fax
33349>>>>>
33349>>>>>        // Branch.Branch_Email
33349>>>>>
33349>>>>>        // Branch.Branch_Resp
33349>>>>>
33349>>>>>        // Branch.Branch_Bitmap
33349>>>>>
33349>>>>>        // Branch.Branch_Site
33349>>>>>
33349>>>>>        // Branch.Branch_Apoth
33349>>>>>
33349>>>>>        // Branch.Beto_Site
33349>>>>>
33349>>>>>        // Branch.Path_Exp
33349>>>>>
33349>>>>>        // Branch.Exp_Txtname
33349>>>>>
33349>>>>>        // Branch.Send_Phone
33349>>>>>
33349>>>>>        // Branch.Send_Path_Files
33349>>>>>
33349>>>>>        // Branch.Send_Path_Conf
33349>>>>>
33349>>>>>        // Branch.Tomeas_Code
33349>>>>>
33349>>>>>        // Branch.Ftp_Sec_Retry
33349>>>>>
33349>>>>>        // Branch.Ftp_Sec_Exit
33349>>>>>
33349>>>>>        // Branch.Ras_Name
33349>>>>>
33349>>>>>        // Branch.Ras_Passw
33349>>>>>
33349>>>>>        // Branch.Ras_Domain
33349>>>>>
33349>>>>>        // Branch.Last_Hmnia_Ekt
33349>>>>>
33349>>>>>        // Branch.Deop_Logo
33349>>>>>
33349>>>>>        //DDB-DefineFieldEnd
33349>>>>>    End_Procedure    // Define_Fields
33350>>>>>
33350>>>>>    // Field_Defaults:
33350>>>>>    // This procedure is used to establish default field values.
33350>>>>>
33350>>>>>    Procedure Field_Defaults
33351>>>>>        Forward Send Field_Defaults
33353>>>>>        //DDB-Generated-Code-Location
33353>>>>>        //DDB-FieldDefaultStart
33353>>>>>        //DDB-FieldDefaultEnd
33353>>>>>    End_Procedure    // Field_Defaults
33354>>>>>End_Class    // Branch_DataDictionary
33355>>>>>
33355>>>>>//DDB-Selection-pkg-Start
33355>>>>>
33355>>>>>Use Sl002.sl         // SL002
INCLUDING FILE: SL002.SL
33355>>>>>>>//AB/ Project SL002:Branch
33355>>>>>>>//AB/ Object prj is a Lookup_Project
33355>>>>>>>//AB/     Set ProjectName to "SL002:Branch"
33355>>>>>>>//AB/     Set ProjectFileName to "Sl002.sl"
33355>>>>>>>
33355>>>>>>>// Project Object Structure
33355>>>>>>>//   SL002 is a dbModalPanelSub
33355>>>>>>>//     Company_DD is a DataDictionary
33355>>>>>>>//     Branch_DD is a DataDictionary
33355>>>>>>>//     oSelList is a dbListSub
33355>>>>>>>//     oOK_bn is a ButtonSub
33355>>>>>>>//     oCancel_bn is a ButtonSub
33355>>>>>>>//     oSearch_bn is a ButtonSub
33355>>>>>>>
33355>>>>>>>// Register all objects
33355>>>>>>>Register_Object Branch_DD
33355>>>>>>>Register_Object Company_DD
33355>>>>>>>Register_Object oCancel_bn
33355>>>>>>>Register_Object oOK_bn
33355>>>>>>>Register_Object oSearch_bn
33355>>>>>>>Register_Object oSelList
33355>>>>>>>Register_Object SL002
33355>>>>>>>
33355>>>>>>>
33355>>>>>>>//AB-IgnoreStart
33355>>>>>>>
33355>>>>>>>Use DFAllEnt.pkg
33355>>>>>>>Use dbList.Sub
33355>>>>>>>Use Button.Sub
33355>>>>>>>
33355>>>>>>>
33355>>>>>>>Use COMPANY.DD
33355>>>>>>>Use BRANCH.DD
33355>>>>>>>
33355>>>>>>>//AB-IgnoreEnd
33355>>>>>>>
33355>>>>>>>Object SL002 is a dbModalPanelSub
33357>>>>>>>
33357>>>>>>>    //AB-StoreTopStart
33357>>>>>>>    Property String psFragmaCompanyCode  ""
33359>>>>>>>    
33359>>>>>>>    //AB-StoreTopEnd
33359>>>>>>>
33359>>>>>>>    Set Minimize_Icon to FALSE
33360>>>>>>>    Set Label to "“§¦¡˜«˜©«ã£˜«˜"
33361>>>>>>>    Set Size to 146 430
33362>>>>>>>    Set Location to 4 5
33363>>>>>>>    Set Exit_Application_Local_State to FALSE
33364>>>>>>>    Set Modal_State to FALSE
33365>>>>>>>
33365>>>>>>>    //AB-DDOStart
33365>>>>>>>
33365>>>>>>>    Object Company_DD is a Company_DataDictionary
33367>>>>>>>    End_Object    // Company_DD
33368>>>>>>>
33368>>>>>>>    Object Branch_DD is a Branch_DataDictionary
33370>>>>>>>        Set DDO_Server to (Company_DD(self))
33371>>>>>>>
33371>>>>>>>        //AB-StoreStart
33371>>>>>>>        Procedure OnConstrain
33373>>>>>>>             String lsCompanyCode
33374>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
33375>>>>>>>             If (lsCompanyCode <> "") Constrain Branch.Company_code eq lsCompanyCode
33379>>>>>>>        End_Procedure // OnConstrain
33380>>>>>>>        
33380>>>>>>>        
33380>>>>>>>        
33380>>>>>>>        //AB-StoreEnd
33380>>>>>>>
33380>>>>>>>    End_Object    // Branch_DD
33381>>>>>>>
33381>>>>>>>    Set Main_DD to (Branch_DD(self))
33382>>>>>>>    Set Server to (Branch_DD(self))
33383>>>>>>>
33383>>>>>>>    //AB-DDOEnd
33383>>>>>>>
33383>>>>>>>    Object oSelList is a dbListSub
33385>>>>>>>        Set Main_File to Branch.File_Number
33386>>>>>>>        Set Size to 105 415
33387>>>>>>>        Set Location to 6 6
33388>>>>>>>
33388>>>>>>>        Begin_Row
33391>>>>>>>            Entry_Item Branch.Branch_code
33392>>>>>>>            Entry_Item Branch.Branch_name
33393>>>>>>>            Entry_Item Company.Company_code
33394>>>>>>>            Entry_Item Company.Company_name
33395>>>>>>>            Entry_Item Branch.Beto_site
33396>>>>>>>            Entry_Item Branch.Branch_recr
33397>>>>>>>        End_Row
33402>>>>>>>
33402>>>>>>>        Set Form_Width    item 0 to 60
33403>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
33404>>>>>>>        
33404>>>>>>>        Set Form_Width    item 1 to 128
33405>>>>>>>        Set Header_Label  item 1 to "Ž¤¦£˜"
33406>>>>>>>        
33406>>>>>>>        Set Form_Width    item 2 to 69
33407>>>>>>>        Set Header_Label  item 2 to "‰à› ¡æª „«˜ ¨å˜ª"
33408>>>>>>>        
33408>>>>>>>        Set Form_Width    item 3 to 109
33409>>>>>>>        Set Header_Label  item 3 to "Ž¤¦£˜ „«˜ ¨å˜ª"
33410>>>>>>>        
33410>>>>>>>        Set Form_Width    item 4 to 42
33411>>>>>>>        Set Header_Label  item 4 to "Site"
33412>>>>>>>        
33412>>>>>>>        Set Form_Width    item 5 to 0
33413>>>>>>>        Set Header_Label  item 5 to ""
33414>>>>>>>        
33414>>>>>>>
33414>>>>>>>        //AB-StoreStart
33414>>>>>>>        
33414>>>>>>>        Property String psStoreFragmaCompanyCode  ""
33416>>>>>>>        
33416>>>>>>>        Procedure Store_Defaults
33418>>>>>>>            forward send Store_Defaults
33420>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
33421>>>>>>>        end_Procedure // Store_Defaults
33422>>>>>>>        
33422>>>>>>>        Procedure Restore_Defaults
33424>>>>>>>            forward send Restore_Defaults
33426>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
33427>>>>>>>        end_Procedure // Restore_Defaults
33428>>>>>>>        
33428>>>>>>>        Procedure Activating
33430>>>>>>>            Forward Send Activating
33432>>>>>>>            Send Rebuild_Constraints to (Branch_DD(self))
33433>>>>>>>        End_Procedure // Activating
33434>>>>>>>        
33434>>>>>>>        Set Column_Options Item 5 to NoEnter True
33435>>>>>>>        
33435>>>>>>>        
33435>>>>>>>        //AB-StoreEnd
33435>>>>>>>
33435>>>>>>>    End_Object    // oSelList
33436>>>>>>>
33436>>>>>>>    Object oOK_bn is a ButtonSub
33438>>>>>>>        Set Label to "&„§ ¢¦šã"
33439>>>>>>>        Set Location to 112 262
33440>>>>>>>
33440>>>>>>>        //AB-StoreStart
33440>>>>>>>        Procedure OnClick
33442>>>>>>>            Send OK To (oSelList(current_object))
33443>>>>>>>        End_Procedure
33444>>>>>>>        //AB-StoreEnd
33444>>>>>>>
33444>>>>>>>    End_Object    // oOK_bn
33445>>>>>>>
33445>>>>>>>    Object oCancel_bn is a ButtonSub
33447>>>>>>>        Set Label to "&€¡ç¨à©ž"
33448>>>>>>>        Set Location to 112 317
33449>>>>>>>
33449>>>>>>>        //AB-StoreStart
33449>>>>>>>        Procedure OnClick
33451>>>>>>>            Send Cancel To (oSelList(current_object))
33452>>>>>>>        End_Procedure
33453>>>>>>>        //AB-StoreEnd
33453>>>>>>>
33453>>>>>>>    End_Object    // oCancel_bn
33454>>>>>>>
33454>>>>>>>    Object oSearch_bn is a ButtonSub
33456>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
33457>>>>>>>        Set Location to 112 372
33458>>>>>>>
33458>>>>>>>        //AB-StoreStart
33458>>>>>>>        Procedure OnClick
33460>>>>>>>            Send Search To (oSelList(current_object))
33461>>>>>>>        End_Procedure
33462>>>>>>>        //AB-StoreEnd
33462>>>>>>>
33462>>>>>>>    End_Object    // oSearch_bn
33463>>>>>>>
33463>>>>>>>
33463>>>>>>>    //AB-StoreStart
33463>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
33464>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
33465>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
33466>>>>>>>    
33466>>>>>>>    
33466>>>>>>>    //AB-StoreEnd
33466>>>>>>>
33466>>>>>>>End_Object    // SL002
33467>>>>>>>
33467>>>>>>>//AB/ End_Object    // prj
33467>>>>>
33467>>>>>//DDB-Selection-pkg-End
33467>>>>>//DDB-FileEnd
33467>>>    Use YEAR.DD
INCLUDING FILE: YEAR.DD
33467>>>>>//DDB-FileStart
33467>>>>>//DDB-HeaderStart
33467>>>>>
33467>>>>>// File Name : YEAR.DD
33467>>>>>// Class Name: Year_DataDictionary
33467>>>>>// Revision  : 118
33467>>>>>// Version   : 2
33467>>>>>
33467>>>>>Use  Windows           // Basic Definitions
33467>>>>>Use  DataDict          // DataDictionary Class Definition
33467>>>>>Use  DDvalTbl          // Validation Table Class Definitions
33467>>>>>
33467>>>>>Open Year
33469>>>>>Open Branch
33471>>>>>Open Syscurxr
33473>>>>>
33473>>>>>//DDB-HeaderEnd
33473>>>>>//DDB-ValidationStart
33473>>>>>
33473>>>>>Register_Object Year_Year_C_Code0_VT1
33473>>>>>Register_Object Year_Year_C_Code00_VT1
33473>>>>>Register_Object Year_Year_C_Coder_VT1
33473>>>>>
33473>>>>>Object Year_Year_C_Code0_VT1  is a CodeValidationTable
33475>>>>>    Set Type_Value        To "CURRENCY"
33476>>>>>    //DDB-ValidationCustomStart
33476>>>>>    //DDB-ValidationCustomEnd
33476>>>>>End_Object   // Year_Year_C_Code0_VT1
33477>>>>>
33477>>>>>Object Year_Year_C_Code00_VT1  is a CodeValidationTable
33479>>>>>    Set Type_Value        To "CURRENCY"
33480>>>>>    //DDB-ValidationCustomStart
33480>>>>>    //DDB-ValidationCustomEnd
33480>>>>>End_Object   // Year_Year_C_Code00_VT1
33481>>>>>
33481>>>>>Object Year_Year_C_Coder_VT1  is a CodeValidationTable
33483>>>>>    Set Type_Value        To "CURRENCY"
33484>>>>>    //DDB-ValidationCustomStart
33484>>>>>    //DDB-ValidationCustomEnd
33484>>>>>End_Object   // Year_Year_C_Coder_VT1
33485>>>>>//DDB-ValidationEnd
33485>>>>>//DDB-SelectionStart
33485>>>>>//DDB/ ExternalSelectionList SL003  Sl003.sl
33485>>>>>Register_Object SL003
33485>>>>>//DDB-SelectionEnd
33485>>>>>            
33485>>>>>Class Year_DataDictionary  is a DataDictionary
33486>>>>>    
33486>>>>>    Procedure Creating
33487>>>>>        Forward Send Creating
33489>>>>>        // Insert Code Here
33489>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Year.Year_Year)))))) to Year.Year_Recr
33490>>>>>    End_Procedure   // Creating
33491>>>>>
33491>>>>>
33491>>>>>    // Operation_Not_Allowed:
33491>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
33492>>>>>        // Insert Code Here
33492>>>>>        Case Begin    
33492>>>>>             Case (iError_Num = 1001)
33494>>>>>                  Error 1001 "DDC 053:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
33495>>>>>>
33495>>>>>             Case Break
33496>>>>>             Case (iError_Num=1002)
33499>>>>>                Error 1002 "DDC 053:Branch Site ¡˜«œ™˜å¤œ  ©«¦ Year ¡œ¤æ"
33500>>>>>>
33500>>>>>             Case Break
33501>>>>>             Case (iError_Num=1003)
33504>>>>>                Error 1003 "DDC 053:Company Code=0"
33505>>>>>>
33505>>>>>             Case Break
33506>>>>>             Case (iError_Num=1004)
33509>>>>>                Error 1004 "DDC 053:Branch Code=0"
33510>>>>>>
33510>>>>>             Case Break
33511>>>>>             Case Else
33511>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
33513>>>>>        Case End
33513>>>>>    End_Procedure   // Operation_Not_Allowed
33514>>>>>
33514>>>>>
33514>>>>>    // Update:
33514>>>>>    // Use this message to effect changes in related-to files. The
33514>>>>>    // Backout message should be designed to reverse the effects of this
33514>>>>>    // message. It is invoked while the database is locked.
33514>>>>>
33514>>>>>    Procedure Update
33515>>>>>        Forward Send Update
33517>>>>>        // Insert Code Here
33517>>>>>        Move Company.Company_Code   to Year.Company_Code
33518>>>>>        Move Branch.Branch_Code     to Year.Branch_Code
33519>>>>>        move branch.beto_site       to year.beto_site
33520>>>>>
33520>>>>>        //sos:parametrika apo sysfile?
33520>>>>>       
33520>>>>>       // If ((Year.Year_EntryDate-14) < Year.Year_XrhshFrom) Begin
33520>>>>>       //     Move Year.Year_XrhshFrom to Year.Year_OpenFrom
33520>>>>>       // End
33520>>>>>       // Else Begin
33520>>>>>       //     Move (Year.Year_EntryDate-14) to Year.Year_OpenFrom
33520>>>>>       // End
33520>>>>>      //  Move Year.Year_EntryDate      to Year.Year_OpenTo
33520>>>>>    End_Procedure   // Update
33521>>>>>
33521>>>>>    // Validate_Save:
33521>>>>>
33521>>>>>    Function Validate_Save  Returns Integer
33522>>>>>        Local Integer iReturnVal
33523>>>>>        Forward Get Validate_Save  To iReturnVal
33525>>>>>        If (Not(iReturnVal)) Begin
33527>>>>>                 If (Year.Year_Year   = 0) Send Operation_Not_Allowed 1001
33530>>>>>            Else If (Year.Company_Code='') Send Operation_Not_Allowed 1003
33534>>>>>            Else If (Year.Branch_Code ='') Send Operation_Not_Allowed 1004
33538>>>>>        End
33538>>>>>>
33538>>>>>        Function_Return iReturnVal
33539>>>>>    End_Function   // Validate_Save
33540>>>>>
33540>>>>>
33540>>>>>    // Define_Fields:
33540>>>>>    // This procedure is used to set up all data-dictionary rules.
33540>>>>>
33540>>>>>    Procedure Define_Fields
33541>>>>>        Forward Send Define_Fields
33543>>>>>        //DDB-Generated-Code-Location
33543>>>>>        //DDB-DefineFieldStart
33543>>>>>
33543>>>>>        Set Main_File            To Year.File_Number
33544>>>>>        Set Cascade_Delete_State To FALSE
33545>>>>>
33545>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
33546>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
33547>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
33548>>>>>
33548>>>>>        // Parent (Server) file structure...............
33548>>>>>        Send Add_Server_File  Branch.File_Number
33549>>>>>
33549>>>>>        // External (System) file structure.............
33549>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
33550>>>>>
33550>>>>>        // Field-based properties.......................
33550>>>>>
33550>>>>>        // Year.Company_Code
33550>>>>>
33550>>>>>        // Year.Branch_Code
33550>>>>>
33550>>>>>        // Year.Year_Year
33550>>>>>        Set Field_Options          Field Year.Year_Year To DD_AUTOFIND    DD_REQUIRED   
33551>>>>>        Set Field_Prompt_Object    Field Year.Year_Year To (SL003(Self))
33552>>>>>        Set Key_Field_State        Field Year.Year_Year To TRUE
33553>>>>>
33553>>>>>        // Year.Year_Recr
33553>>>>>        Set Field_Prompt_Object    Field Year.Year_Recr To (SL003(Self))
33554>>>>>
33554>>>>>        // Year.Branch_Recr
33554>>>>>
33554>>>>>        // Year.Year_Descr
33554>>>>>
33554>>>>>        // Year.Year_Isolfrom
33554>>>>>
33554>>>>>        // Year.Year_Isolto
33554>>>>>
33554>>>>>        // Year.Year_Openfrom
33554>>>>>
33554>>>>>        // Year.Year_Opento
33554>>>>>
33554>>>>>        // Year.Year_Entrydate
33554>>>>>
33554>>>>>        // Year.Year_Dateaa
33554>>>>>
33554>>>>>        // Year.Year_Xrhshfrom
33554>>>>>
33554>>>>>        // Year.Year_Xrhshto
33554>>>>>
33554>>>>>        // Year.Year_Myflimit
33554>>>>>
33554>>>>>        // Year.Year_Numgtypkin
33554>>>>>
33554>>>>>        // Year.Year_Numgarticl
33554>>>>>
33554>>>>>        // Year.Year_Numgmove
33554>>>>>
33554>>>>>        // Year.Year_Numgplan
33554>>>>>
33554>>>>>        // Year.Year_Numgformat
33554>>>>>
33554>>>>>        // Year.Year_Numgthaa
33554>>>>>
33554>>>>>        // Year.Year_Numgopen
33554>>>>>
33554>>>>>        // Year.Year_Numbtypkin
33554>>>>>
33554>>>>>        // Year.Year_Numbaxio
33554>>>>>
33554>>>>>        // Year.Year_Numbarticl
33554>>>>>
33554>>>>>        // Year.Year_Numbmove
33554>>>>>
33554>>>>>        // Year.Year_Delimiter
33554>>>>>
33554>>>>>        // Year.Year_Printer
33554>>>>>
33554>>>>>        // Year.Year_Valid_Char
33554>>>>>
33554>>>>>        // Year.Year_C_Code0
33554>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0 To "dbComboFormSub"
33555>>>>>        Set Field_Value_Table      Field Year.Year_C_Code0 To (Year_Year_C_Code0_VT1(Self))
33556>>>>>
33556>>>>>        // Year.Year_C_Code00
33556>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00 To "dbComboFormSub"
33557>>>>>        Set Field_Value_Table      Field Year.Year_C_Code00 To (Year_Year_C_Code00_VT1(Self))
33558>>>>>
33558>>>>>        // Year.Year_C_Coder
33558>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder To "dbComboFormSub"
33559>>>>>        Set Field_Value_Table      Field Year.Year_C_Coder To (Year_Year_C_Coder_VT1(Self))
33560>>>>>
33560>>>>>        // Year.Beto_Site
33560>>>>>
33560>>>>>        // Year.Clients_Plafon
33560>>>>>
33560>>>>>        // Year.Payresp_Plafon
33560>>>>>
33560>>>>>        // Year.Clients_Ofeilh
33560>>>>>
33560>>>>>        // Year.Payresp_Ofeilh
33560>>>>>
33560>>>>>        // Year.Working
33560>>>>>
33560>>>>>        //DDB-DefineFieldEnd
33560>>>>>
33560>>>>>        Set Main_File            To Year.File_Number
33561>>>>>        Set Cascade_Delete_State To FALSE
33562>>>>>
33562>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
33563>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
33564>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
33565>>>>>
33565>>>>>        // Child (Client) file structure................
33565>>>>>
33565>>>>>        // Parent (Server) file structure...............
33565>>>>>        Send Add_Server_File  Branch.File_Number
33566>>>>>
33566>>>>>        // Field-based properties.......................
33566>>>>>
33566>>>>>        // Year.Company_Code
33566>>>>>
33566>>>>>        // Year.Branch_Code
33566>>>>>
33566>>>>>        // Year.Year_Year
33566>>>>>        Set Field_Label_Long       Field Year.Year_Year           To "•¨ã©ž"
33567>>>>>        Set Field_Label_Short      Field Year.Year_Year           To "•¨ã©ž"
33568>>>>>        Set Field_Options          Field Year.Year_Year           To DD_REQUIRED
33569>>>>>        //Set Field_Prompt_Object    Field Year.Year_Year           To (SL053(Self))
33569>>>>>
33569>>>>>        // Year.Year_Descr
33569>>>>>        Set Field_Label_Long       Field Year.Year_Descr          To "œ¨ š¨˜­ã •¨ã©žª"
33570>>>>>        Set Field_Label_Short      Field Year.Year_Descr          To "œ¨.•¨ã©žª"
33571>>>>>
33571>>>>>        // Year.Year_C_Code0
33571>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0        To "dbComboForm"
33572>>>>>        Set Field_Label_Long       Field Year.Year_C_Code0        To "‰ç¨ ¦ Œæ£ ©£˜"
33573>>>>>        Set Field_Label_Short      Field Year.Year_C_Code0        To "‰¬¨.Œ¦£ ©£˜"
33574>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code0        To (Year_Year_C_Code0_VT(Self))
33574>>>>>
33574>>>>>        // Year.Year_C_Code00
33574>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00       To "dbComboForm"
33575>>>>>        Set Field_Label_Long       Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
33576>>>>>        Set Field_Label_Short      Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
33577>>>>>        //Set Field_Options          Field Year.Year_C_Code00       To DD_REQUIRED
33577>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code00       To (Year_Year_C_Code1_VT(Self))
33577>>>>>
33577>>>>>        // Year.Year_C_Coder
33577>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder        To "dbComboForm"
33578>>>>>        Set Field_Label_Long       Field Year.Year_C_Coder        To "Œæ£ ©£˜ REPORTING"
33579>>>>>        Set Field_Label_Short      Field Year.Year_C_Coder        To "Œæ£ ©£˜ REP"
33580>>>>>        //Set Field_Options          Field Year.Year_C_Coder        To DD_REQUIRED
33580>>>>>        //Set Field_Value_Table      Field Year.Year_C_Coder        To (Year_Year_C_Coder_VT(Self))
33580>>>>>
33580>>>>>        // Year.Year_Isolfrom
33580>>>>>        Set Field_Label_Long       Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
33581>>>>>        Set Field_Label_Short      Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
33582>>>>>
33582>>>>>        // Year.Year_Isolto
33582>>>>>        Set Field_Label_Long       Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
33583>>>>>        Set Field_Label_Short      Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
33584>>>>>
33584>>>>>        // Year.Year_Openfrom
33584>>>>>        Set Field_Label_Long       Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
33585>>>>>        Set Field_Label_Short      Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
33586>>>>>
33586>>>>>        // Year.Year_Opento
33586>>>>>        Set Field_Label_Long       Field Year.Year_Opento         To "„šš¨˜­âª „àª"
33587>>>>>        Set Field_Label_Short      Field Year.Year_Opento         To "„šš¨˜­âª „àª"
33588>>>>>
33588>>>>>        // Year.Year_Entrydate
33588>>>>>        Set Field_Label_Long       Field Year.Year_Entrydate      To "†£œ¨¦£ž¤å˜ „¨š˜©å˜ª"
33589>>>>>        Set Field_Label_Short      Field Year.Year_Entrydate      To "†£/¤å˜ „¨š˜©å˜ª"
33590>>>>>
33590>>>>>        // Year.Year_Dateaa
33590>>>>>
33590>>>>>        // Year.Year_Xrhshfrom
33590>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
33591>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
33592>>>>>
33592>>>>>        // Year.Year_Xrhshto
33592>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
33593>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
33594>>>>>
33594>>>>>        // Year.Year_Myflimit
33594>>>>>        Set Field_Label_Long       Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
33595>>>>>        Set Field_Label_Short      Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
33596>>>>>
33596>>>>>        // Year.Year_Numgtypkin
33596>>>>>        Set Field_Options          Field Year.Year_Numgtypkin     To DD_DISPLAYONLY
33597>>>>>
33597>>>>>        // Year.Year_Numgarticl
33597>>>>>        Set Field_Options          Field Year.Year_Numgarticl     To DD_DISPLAYONLY
33598>>>>>
33598>>>>>        // Year.Year_Numgmove
33598>>>>>        Set Field_Options          Field Year.Year_Numgmove       To DD_DISPLAYONLY
33599>>>>>
33599>>>>>        // Year.Year_Numgplan
33599>>>>>        Set Field_Options          Field Year.Year_Numgplan       To DD_DISPLAYONLY
33600>>>>>
33600>>>>>        // Year.Year_Numgformat
33600>>>>>        Set Field_Options          Field Year.Year_Numgformat     To DD_DISPLAYONLY
33601>>>>>
33601>>>>>        // Year.Year_Numgthaa
33601>>>>>        Set Field_Options          Field Year.Year_Numgthaa       To DD_DISPLAYONLY
33602>>>>>
33602>>>>>        // Year.Year_Numgopen
33602>>>>>        Set Field_Options          Field Year.Year_Numgopen       To DD_DISPLAYONLY
33603>>>>>
33603>>>>>        // Year.Year_Numbtypkin
33603>>>>>        Set Field_Options          Field Year.Year_Numbtypkin     To DD_DISPLAYONLY
33604>>>>>
33604>>>>>        // Year.Year_Numbaxio
33604>>>>>        Set Field_Options          Field Year.Year_Numbaxio       To DD_DISPLAYONLY
33605>>>>>
33605>>>>>        // Year.Year_Numbarticl
33605>>>>>        Set Field_Options          Field Year.Year_Numbarticl     To DD_DISPLAYONLY
33606>>>>>
33606>>>>>        // Year.Year_Numbmove
33606>>>>>        Set Field_Options          Field Year.Year_Numbmove       To DD_DISPLAYONLY
33607>>>>>
33607>>>>>        // Year.Year_Delimiter
33607>>>>>        Set Status_Help            Field Year.Year_Delimiter      To "ƒ ˜®à¨ ©« ¡æ š ˜ «¦ Š‘ «žª •¨ã©œàª"
33608>>>>>
33608>>>>>        // Year.Year_Printer
33608>>>>>
33608>>>>>        // Year.Year_Valid_Char
33608>>>>>
33608>>>>>    End_Procedure    // Define_Fields
33609>>>>>
33609>>>>>    // Field_Defaults:
33609>>>>>    // This procedure is used to establish default field values.
33609>>>>>
33609>>>>>    Procedure Field_Defaults
33610>>>>>        Forward Send Field_Defaults
33612>>>>>        //DDB-Generated-Code-Location
33612>>>>>        //DDB-FieldDefaultStart
33612>>>>>        //DDB-FieldDefaultEnd
33612>>>>>        Set Field_Changed_Value   Field Year.Year_Delimiter      To "."
33613>>>>>        Set Field_Changed_Value   Field Year.Year_Printer        To "LPT1:"
33614>>>>>        Set Field_Changed_Value   Field Year.Year_Valid_Char     To "1234567890"
33615>>>>>    End_Procedure    // Field_Defaults
33616>>>>>
33616>>>>>End_Class    // Year_DataDictionary
33617>>>>>//DDB-Selection-pkg-Start
33617>>>>>
33617>>>>>Use Sl003.sl         // SL003
INCLUDING FILE: SL003.SL
33617>>>>>>>//AB/ Project SL003:Year
33617>>>>>>>//AB/ Object prj is a Lookup_Project
33617>>>>>>>//AB/     Set ProjectName to "SL003:Year"
33617>>>>>>>//AB/     Set ProjectFileName to "Sl003.sl"
33617>>>>>>>
33617>>>>>>>// Project Object Structure
33617>>>>>>>//   SL003 is a dbModalPanelSub
33617>>>>>>>//     Company_DD is a DataDictionary
33617>>>>>>>//     Branch_DD is a DataDictionary
33617>>>>>>>//     Year_DD is a DataDictionary
33617>>>>>>>//     oSelList is a dbListSub
33617>>>>>>>//     oOK_bn is a ButtonSub
33617>>>>>>>//     oCancel_bn is a ButtonSub
33617>>>>>>>//     oSearch_bn is a ButtonSub
33617>>>>>>>
33617>>>>>>>// Register all objects
33617>>>>>>>Register_Object Branch_DD
33617>>>>>>>Register_Object Company_DD
33617>>>>>>>Register_Object oCancel_bn
33617>>>>>>>Register_Object oOK_bn
33617>>>>>>>Register_Object oSearch_bn
33617>>>>>>>Register_Object oSelList
33617>>>>>>>Register_Object SL003
33617>>>>>>>Register_Object Year_DD
33617>>>>>>>
33617>>>>>>>
33617>>>>>>>//AB-IgnoreStart
33617>>>>>>>
33617>>>>>>>Use DFAllEnt.pkg
33617>>>>>>>Use dbList.Sub
33617>>>>>>>Use Button.Sub
33617>>>>>>>
33617>>>>>>>
33617>>>>>>>Use COMPANY.DD
33617>>>>>>>Use BRANCH.DD
33617>>>>>>>Use YEAR.DD
33617>>>>>>>
33617>>>>>>>//AB-IgnoreEnd
33617>>>>>>>
33617>>>>>>>CD_Popup_Object SL003 is a dbModalPanelSub
33636>>>>>>>
33636>>>>>>>    //AB-StoreTopStart
33636>>>>>>>    Property String psFragmaCompanyCode  ""
33638>>>>>>>    Property String psFragmaBranchCode   ""
33640>>>>>>>    property integer pifragmaactive public 0
33642>>>>>>>    //AB-StoreTopEnd
33642>>>>>>>
33642>>>>>>>    Set Minimize_Icon to FALSE
33643>>>>>>>    Set Label to "•¨ã©œ ª"
33644>>>>>>>    Set Size to 149 449
33645>>>>>>>    Set Location to 4 7
33646>>>>>>>    Set Exit_Application_Local_State to FALSE
33647>>>>>>>    Set Modal_State to FALSE
33648>>>>>>>
33648>>>>>>>    //AB-DDOStart
33648>>>>>>>
33648>>>>>>>    Object Company_DD is a Company_DataDictionary
33650>>>>>>>    End_Object    // Company_DD
33651>>>>>>>
33651>>>>>>>    Object Branch_DD is a Branch_DataDictionary
33653>>>>>>>        Set DDO_Server to (Company_DD(self))
33654>>>>>>>    End_Object    // Branch_DD
33655>>>>>>>
33655>>>>>>>    Object Year_DD is a Year_DataDictionary
33657>>>>>>>        Set DDO_Server to (Branch_DD(self))
33658>>>>>>>
33658>>>>>>>        //AB-StoreStart
33658>>>>>>>        Procedure OnConstrain
33660>>>>>>>             String lsCompanyCode lsBranchCode
33661>>>>>>>             integer iactive
33661>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
33662>>>>>>>             get pifragmaactive to iactive
33663>>>>>>>             If (lsCompanyCode <> "") Begin
33665>>>>>>>                Get psFragmaBranchCode  to lsBranchCode
33666>>>>>>>                Constrain Year.Company_Code eq lsCompanyCode
33668>>>>>>>                If (lsBranchCode <> "") Constrain Year.Branch_code eq lsBranchCode
33672>>>>>>>             End
33672>>>>>>>>
33672>>>>>>>             if (iactive = 0) constrain year.working ne 1
33676>>>>>>>        End_Procedure // OnConstrain
33677>>>>>>>        
33677>>>>>>>        
33677>>>>>>>        
33677>>>>>>>        
33677>>>>>>>        
33677>>>>>>>        //AB-StoreEnd
33677>>>>>>>
33677>>>>>>>    End_Object    // Year_DD
33678>>>>>>>
33678>>>>>>>    Set Main_DD to (Year_DD(self))
33679>>>>>>>    Set Server to (Year_DD(self))
33680>>>>>>>
33680>>>>>>>    //AB-DDOEnd
33680>>>>>>>
33680>>>>>>>    Object oSelList is a dbListSub
33682>>>>>>>        Set Main_File to Year.File_Number
33683>>>>>>>        Set Size to 105 433
33684>>>>>>>        Set Location to 6 6
33685>>>>>>>
33685>>>>>>>        Begin_Row
33688>>>>>>>            Entry_Item Year.Year_year
33689>>>>>>>            Entry_Item Company.Company_code
33690>>>>>>>            Entry_Item Company.Company_name
33691>>>>>>>            Entry_Item Branch.Branch_code
33692>>>>>>>            Entry_Item Branch.Branch_name
33693>>>>>>>        End_Row
33698>>>>>>>
33698>>>>>>>        Set Form_Width    item 0 to 36
33699>>>>>>>        Set Header_Label  item 0 to "•¨ã©ž :          "
33700>>>>>>>        
33700>>>>>>>        Set Form_Width    item 1 to 71
33701>>>>>>>        Set Header_Label  item 1 to "‰à› ¡æª „«˜ ¨å˜ª"
33702>>>>>>>        
33702>>>>>>>        Set Form_Width    item 2 to 136
33703>>>>>>>        Set Header_Label  item 2 to "Ž¤¦£˜ „«˜ ¨å˜ª"
33704>>>>>>>        
33704>>>>>>>        Set Form_Width    item 3 to 73
33705>>>>>>>        Set Header_Label  item 3 to "‰à› ¡æª “§¦¡/«¦ª"
33706>>>>>>>        
33706>>>>>>>        Set Form_Width    item 4 to 109
33707>>>>>>>        Set Header_Label  item 4 to "Ž¤¦£˜ “§¦¡/«¦ª"
33708>>>>>>>        
33708>>>>>>>
33708>>>>>>>        //AB-StoreStart
33708>>>>>>>                                        
33708>>>>>>>        Property String psStoreFragmaCompanyCode  ""
33710>>>>>>>        Property String psStoreFragmaBranchCode   ""
33712>>>>>>>        
33712>>>>>>>        Procedure Store_Defaults
33714>>>>>>>            forward send Store_Defaults
33716>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
33717>>>>>>>            Set psStoreFragmaBranchCode  to (psFragmaBranchCode(Self))
33718>>>>>>>        end_Procedure // Store_Defaults
33719>>>>>>>        
33719>>>>>>>        Procedure Restore_Defaults
33721>>>>>>>            forward send Restore_Defaults
33723>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
33724>>>>>>>            Set psFragmaBranchCode  to (psStoreFragmaBranchCode(self))
33725>>>>>>>        end_Procedure // Restore_Defaults
33726>>>>>>>        
33726>>>>>>>        Procedure Activating
33728>>>>>>>            Forward Send Activating
33730>>>>>>>            Send Rebuild_Constraints to (Year_DD(self))
33731>>>>>>>        End_Procedure // Activating
33732>>>>>>>        
33732>>>>>>>        
33732>>>>>>>        
33732>>>>>>>        //AB-StoreEnd
33732>>>>>>>
33732>>>>>>>    End_Object    // oSelList
33733>>>>>>>
33733>>>>>>>    Object oOK_bn is a ButtonSub
33735>>>>>>>        Set Label to "&„§ ¢¦šã"
33736>>>>>>>        Set Location to 112 280
33737>>>>>>>
33737>>>>>>>        //AB-StoreStart
33737>>>>>>>        Procedure OnClick
33739>>>>>>>            Send OK To (oSelList(current_object))
33740>>>>>>>        End_Procedure
33741>>>>>>>        //AB-StoreEnd
33741>>>>>>>
33741>>>>>>>    End_Object    // oOK_bn
33742>>>>>>>
33742>>>>>>>    Object oCancel_bn is a ButtonSub
33744>>>>>>>        Set Label to "&€¡ç¨à©ž"
33745>>>>>>>        Set Location to 112 335
33746>>>>>>>
33746>>>>>>>        //AB-StoreStart
33746>>>>>>>        Procedure OnClick
33748>>>>>>>            Send Cancel To (oSelList(current_object))
33749>>>>>>>        End_Procedure
33750>>>>>>>        //AB-StoreEnd
33750>>>>>>>
33750>>>>>>>    End_Object    // oCancel_bn
33751>>>>>>>
33751>>>>>>>    Object oSearch_bn is a ButtonSub
33753>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
33754>>>>>>>        Set Location to 112 390
33755>>>>>>>
33755>>>>>>>        //AB-StoreStart
33755>>>>>>>        Procedure OnClick
33757>>>>>>>            Send Search To (oSelList(current_object))
33758>>>>>>>        End_Procedure
33759>>>>>>>        //AB-StoreEnd
33759>>>>>>>
33759>>>>>>>    End_Object    // oSearch_bn
33760>>>>>>>
33760>>>>>>>
33760>>>>>>>    //AB-StoreStart
33760>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
33761>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
33762>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
33763>>>>>>>    
33763>>>>>>>    
33763>>>>>>>    
33763>>>>>>>    //AB-StoreEnd
33763>>>>>>>
33763>>>>>>>CD_End_Object    // SL003
33765>>>>>>>>
33765>>>>>>>
33765>>>>>>>//AB/ End_Object    // prj
33765>>>>>
33765>>>>>//DDB-Selection-pkg-End
33765>>>>>//DDB-FileEnd
33765>>>    
33765>>>    //AB-IgnoreEnd
33765>>>
33765>>>    Object oSelectYear is a dbModalPanelSub
33767>>>
33767>>>        //AB-StoreTopStart
33767>>>        
33767>>>        Property String  psSelectedYearRecr  ''
33769>>>        Property Integer piChangeState False
33771>>>        
33771>>>        //AB-StoreTopEnd
33771>>>
33771>>>        Set Minimize_Icon to FALSE
33772>>>        Set Label to "„§ ¢¦šã „«˜ ¨œå˜ª - “§¦¡˜«˜©«ã£˜«¦ª - •¨ã©žª"
33773>>>        Set Size to 111 372
33774>>>        Set Location to 60 40
33775>>>        Set Color to 12232306
33776>>>        Set Popup_State to TRUE
33777>>>
33777>>>        //AB-DDOStart
33777>>>
33777>>>        Object Company_DD is a Company_DataDictionary
33779>>>
33779>>>            //AB-StoreStart
33779>>>            Set Foreign_Field_Options DD_KEYFIELD                   to DD_Clear_Field_Options DD_FindReq
33780>>>            Set Foreign_Field_Options DD_INDEXFIELD                 to DD_Clear_Field_Options DD_FindReq
33781>>>            Set Foreign_Field_Options Field Company.Company_Name    to DD_DisplayOnly
33782>>>            
33782>>>            
33782>>>            
33782>>>            //AB-StoreEnd
33782>>>
33782>>>        End_Object    // Company_DD
33783>>>
33783>>>        Object Branch_DD is a Branch_DataDictionary
33785>>>            Set DDO_Server to (Company_DD(self))
33786>>>
33786>>>            //AB-StoreStart
33786>>>            Set Foreign_Field_Options DD_KEYFIELD   to DD_Clear_Field_Options DD_FindReq
33787>>>            Set Foreign_Field_Options DD_INDEXFIELD to DD_Clear_Field_Options DD_FindReq
33788>>>            
33788>>>            Set Foreign_Field_Options DD_KEYFIELD   to DD_AutoFind_GE
33789>>>            Set Foreign_Field_Options DD_INDEXFIELD to DD_AutoFind_GE
33790>>>            
33790>>>            Set Foreign_Field_Options Field Branch.Branch_Name to DD_DisplayOnly
33791>>>            //AB-StoreEnd
33791>>>
33791>>>        End_Object    // Branch_DD
33792>>>
33792>>>        Object Year_DD is a Year_DataDictionary
33794>>>            Set DDO_Server to (Branch_DD(self))
33795>>>
33795>>>            //AB-StoreStart
33795>>>                                                                
33795>>>            Set Field_Options Field Year.Year_Descr to DD_DisplayOnly
33796>>>            Set Field_Options Field Year.Year_Year to DD_AutoFind_GE
33797>>>            
33797>>>            Function Validate_Delete Returns Integer
33799>>>                Function_Return 1
33800>>>            End_Function
33801>>>            
33801>>>            //AB-StoreEnd
33801>>>
33801>>>        End_Object    // Year_DD
33802>>>
33802>>>        Set Main_DD to (Year_DD(self))
33803>>>        Set Server to (Year_DD(self))
33804>>>
33804>>>        //AB-DDOEnd
33804>>>
33804>>>        Object Company_Company_Code is a dbFormSub
33806>>>            Entry_Item Company.Company_code
33807>>>            Set Size to 13 71
33808>>>            Set Location to 9 112
33809>>>            Set Label_Col_Offset to 2
33810>>>            Set Label_Justification_Mode to jMode_Right
33811>>>            Set Prompt_Button_Mode to pb_PromptOn
33812>>>            Set Auto_Clear_Deo_State to FALSE
33813>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
33814>>>
33814>>>            //AB-StoreStart
33814>>>                                                                
33814>>>            Set Prompt_Object to (sl001(Self))
33815>>>            
33815>>>            
33815>>>            //AB-StoreEnd
33815>>>
33815>>>        End_Object    // Company_Company_Code
33816>>>
33816>>>        Object Company_Company_Name is a dbFormSub
33818>>>            Entry_Item Company.Company_name
33819>>>            Set Size to 13 168
33820>>>            Set Location to 9 188
33821>>>            Set Label_Col_Offset to 2
33822>>>            Set Label_Justification_Mode to jMode_Right
33823>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
33824>>>
33824>>>            //AB-StoreStart
33824>>>                                                                
33824>>>            //AB-StoreEnd
33824>>>
33824>>>        End_Object    // Company_Company_Name
33825>>>
33825>>>        Object Branch_Branch_Code is a dbFormSub
33827>>>            Entry_Item Branch.Branch_code
33828>>>            Set Size to 13 71
33829>>>            Set Location to 23 112
33830>>>            Set Label_Col_Offset to 2
33831>>>            Set Label_Justification_Mode to jMode_Right
33832>>>            Set Prompt_Button_Mode to pb_PromptOn
33833>>>            Set Auto_Clear_Deo_State to FALSE
33834>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
33835>>>
33835>>>            //AB-StoreStart
33835>>>            Set Prompt_Object to (sl002(Self))
33836>>>            
33836>>>            Procedure Prompt_CallBack Integer hPrompt
33838>>>                string lsCompanyCode
33839>>>                Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
33840>>>                Set psFragmaCompanyCode of hPrompt to lsCompanyCode
33841>>>            End_Procedure
33842>>>            
33842>>>            
33842>>>            
33842>>>            
33842>>>            //AB-StoreEnd
33842>>>
33842>>>        End_Object    // Branch_Branch_Code
33843>>>
33843>>>        Object Branch_Branch_Name is a dbFormSub
33845>>>            Entry_Item Branch.Branch_name
33846>>>            Set Size to 13 168
33847>>>            Set Location to 23 188
33848>>>            Set Label_Justification_Mode to jMode_Right
33849>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
33850>>>
33850>>>            //AB-StoreStart
33850>>>                                                                
33850>>>                                                                
33850>>>            //AB-StoreEnd
33850>>>
33850>>>        End_Object    // Branch_Branch_Name
33851>>>
33851>>>        Object Year_Year_Year is a dbFormSub
33853>>>            Entry_Item Year.Year_year
33854>>>            Set Size to 13 71
33855>>>            Set Location to 37 112
33856>>>            Set Label_Col_Offset to 2
33857>>>            Set Label_Justification_Mode to jMode_Right
33858>>>            Set Prompt_Button_Mode to pb_PromptOn
33859>>>            Set Auto_Clear_Deo_State to FALSE
33860>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
33861>>>
33861>>>            //AB-StoreStart
33861>>>            Set Prompt_Object to (sl003(Self))
33862>>>            
33862>>>            Procedure Prompt_CallBack Integer hPrompt
33864>>>                String lsCompanyCode lsBranchCode
33865>>>                integer icheck
33865>>>                get checked_state of (chkxr(self)) to icheck
33866>>>                Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
33867>>>                Get Field_Current_Value of Branch_DD  Field Branch.Branch_Code   to lsBranchCode
33868>>>                Set psFragmaCompanyCode of hPrompt to lsCompanyCode
33869>>>                Set psFragmaBranchCode  of hPrompt to lsBranchCode
33870>>>                set pifragmaactive      of hPrompt to icheck
33871>>>            End_Procedure
33872>>>            
33872>>>            
33872>>>            
33872>>>            
33872>>>            
33872>>>            
33872>>>            //AB-StoreEnd
33872>>>
33872>>>        End_Object    // Year_Year_Year
33873>>>
33873>>>        Object Year_Year_Descr is a dbFormSub
33875>>>            Entry_Item Year.Year_descr
33876>>>            Set Size to 13 168
33877>>>            Set Location to 37 188
33878>>>            Set Label_Col_Offset to 2
33879>>>            Set Label_Justification_Mode to jMode_Right
33880>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
33881>>>
33881>>>            //AB-StoreStart
33881>>>                                                                
33881>>>            //AB-StoreEnd
33881>>>
33881>>>        End_Object    // Year_Year_Descr
33882>>>
33882>>>        Object Year_Year_Entrydate is a dbFormSub
33884>>>            Entry_Item Year.Year_entrydate
33885>>>            Set Size to 13 71
33886>>>            Set Location to 52 112
33887>>>            Set Label_Col_Offset to 2
33888>>>            Set Label_Justification_Mode to jMode_Right
33889>>>            Set Auto_Clear_Deo_State to FALSE
33890>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
33891>>>        End_Object    // Year_Year_Entrydate
33892>>>
33892>>>        Object oOk_bn is a ButtonSub
33894>>>            Set Label to "€§¦›¦®ã (F2)"
33895>>>            Set Size to 17 54
33896>>>            Set Location to 74 188
33897>>>            Set Form_FontHeight Item 0 to 14
33898>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
33899>>>
33899>>>            //AB-StoreStart
33899>>>                        
33899>>>            Procedure OnClick
33901>>>                Delegate Send AcceptTheValues
33903>>>            End_Procedure
33904>>>            
33904>>>            
33904>>>            
33904>>>            
33904>>>            //AB-StoreEnd
33904>>>
33904>>>        End_Object    // oOk_bn
33905>>>
33905>>>        Object oCancel_bn is a ButtonSub
33907>>>            Set Label to "„¥¦›¦ª "
33908>>>            Set Size to 17 54
33909>>>            Set Location to 74 302
33910>>>            Set Form_FontHeight Item 0 to 14
33911>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
33912>>>
33912>>>            //AB-StoreStart
33912>>>                                                                
33912>>>            Procedure OnClick
33914>>>               Send Exit_Application to oSelectYear
33915>>>            End_Procedure
33916>>>            
33916>>>            
33916>>>            
33916>>>            //AB-StoreEnd
33916>>>
33916>>>        End_Object    // oCancel_bn
33917>>>
33917>>>        Object otxtCompany is a TextBoxSub
33919>>>            Set Label to "„«˜ ¨œå˜"
33920>>>            Set Auto_Size_State to FALSE
33921>>>            Set Color to 12232306
33922>>>            Set FontSize to 14 8
33923>>>            Set Location to 9 10
33924>>>            Set Size to 10 35
33925>>>            Set FontWeight to 600
33926>>>            Set TypeFace to "MS Sans Serif"
33927>>>            Set Enabled_State to TRUE
33928>>>        End_Object    // otxtCompany
33929>>>
33929>>>        Object otxtBranch is a TextBoxSub
33931>>>            Set Label to "“§¦¡˜«˜©«ã£˜«˜"
33932>>>            Set Auto_Size_State to FALSE
33933>>>            Set Color to 12232306
33934>>>            Set FontSize to 14 8
33935>>>            Set Location to 23 10
33936>>>            Set Size to 10 63
33937>>>            Set FontWeight to 600
33938>>>            Set TypeFace to "MS Sans Serif"
33939>>>            Set Enabled_State to TRUE
33940>>>        End_Object    // otxtBranch
33941>>>
33941>>>        Object otxtYear is a TextBoxSub
33943>>>            Set Label to "•¨ã©ž :          "
33944>>>            Set Auto_Size_State to FALSE
33945>>>            Set Color to 12232306
33946>>>            Set FontSize to 14 8
33947>>>            Set Location to 38 10
33948>>>            Set Size to 10 40
33949>>>            Set FontWeight to 600
33950>>>            Set TypeFace to "MS Sans Serif"
33951>>>            Set Enabled_State to TRUE
33952>>>        End_Object    // otxtYear
33953>>>
33953>>>        Object otxtWorkingDay is a TextBoxSub
33955>>>            Set Label to "†£/¤å˜ „¨š˜©å˜ª"
33956>>>            Set Auto_Size_State to FALSE
33957>>>            Set Color to 12232306
33958>>>            Set FontSize to 14 8
33959>>>            Set Location to 52 10
33960>>>            Set Size to 10 63
33961>>>            Set FontWeight to 600
33962>>>            Set TypeFace to "MS Sans Serif"
33963>>>            Set Enabled_State to TRUE
33964>>>        End_Object    // otxtWorkingDay
33965>>>
33965>>>        Object otxtWorkingDay is a TextBoxSub
33967>>>            Set Label to "Ž¢œª ¦  ®¨ã©œ ª"
33968>>>            Set Auto_Size_State to FALSE
33969>>>            Set Color to 12232306
33970>>>            Set FontSize to 14 8
33971>>>            Set Location to 79 9
33972>>>            Set Size to 10 63
33973>>>            Set FontWeight to 600
33974>>>            Set TypeFace to "MS Sans Serif"
33975>>>            Set Enabled_State to TRUE
33976>>>        End_Object    // otxtWorkingDay
33977>>>
33977>>>        Object chkxr is a CheckBoxSub
33979>>>            Set Size to 13 22
33980>>>            Set Location to 79 113
33981>>>            Set Color to 12232306
33982>>>        End_Object    // chkxr
33983>>>
33983>>>
33983>>>        //AB-StoreStart
33983>>>        
33983>>>        Function ifSelect_Xrhsh Returns String
33985>>>            String  lsRecord_id
33986>>>            Set psSelectedYearRecr to gs_Selected_Year_Recr
33987>>>            send popup_modal
33988>>>            Get psSelectedYearRecr to lsRecord_id
33989>>>            Function_return lsRecord_Id
33990>>>        End_Function
33991>>>        
33991>>>        //Procedure Activate Returns Integer
33991>>>        //    Integer hID rVal
33991>>>        //    Move oSelectYear to hID
33991>>>        //    Forward Get Msg_Activate to rVal
33991>>>        //    Set Object_Shadow_State Of hID to   False
33991>>>        //    Set Visible_State Of oOK_Bn     to True
33991>>>        //    Set Visible_State Of oCancel_Bn to True
33991>>>        ////    Send Page_Object        To hID      True
33991>>>        //    Procedure_Return rVal
33991>>>        //End_Procedure
33991>>>        
33991>>>        
33991>>>        Procedure AcceptTheValues
33993>>>            Integer iRetVal liYearDD liCompanyDD liBranchDD
33994>>>            String ldcheck lsYearRecr lsSite sCname sBname sYname sNom1 sNom2 sNom3
33994>>>            Date ldYearXrhsh_From ldYearXrhsh_To
33994>>>            Move Year_DD to liYearDD
33995>>>            Get Field_Current_Value of liYearDD Field Year.Year_EntryDate to ldcheck
33996>>>            if (ldcheck = "") ;                Get Message_Box "The Chosen Date is Not Correct." "Attention" MB_OK MB_ICONWARNING to iRetVal
33999>>>            else begin
34000>>>                Get Field_Current_Value of liYearDD Field Year.Year_XrhshFrom   to ldYearXrhsh_From
34001>>>                Get Field_Current_Value of liYearDD Field Year.Year_XrhshTo     to ldYearXrhsh_To
34002>>>                if ((ldcheck < ldYearXrhsh_From) or (ldcheck > ldYearXrhsh_To)) ;                    Get Message_Box "The Date is Outside Range" "Attention" MB_OK MB_ICONWARNING to iRetVal
34005>>>                else begin
34006>>>                    Move Company_DD to liCompanyDD
34007>>>                    Move Branch_DD  to liBranchDD
34008>>>                    Move Year_DD    to liYearDD
34009>>>                    send Request_Save to liYearDD
34010>>>                    Get Field_Current_Value of liCompanyDD Field Company.Company_Code to gs_Selected_Company_Code
34011>>>                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_Code   to gs_Selected_Branch_Code
34012>>>        
34012>>>                    Get Field_Current_Value of liBranchDD  Field Branch.Beto_Site   to gs_Selected_Beto_Site
34013>>>        
34013>>>                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_Site   to lsSite
34014>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_Year       to gi_Selected_Year
34015>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_Recr       to lsYearRecr
34016>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_C_Code0    to sNom1
34017>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_C_Code00   to sNom2
34018>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_C_CodeR    to sNom3
34019>>>        
34019>>>                    Get Field_Current_Value of liCompanyDD Field Company.Company_Name to sCname
34020>>>                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_name   to sBname
34021>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_Descr      to sYname
34022>>>        
34022>>>        
34022>>>                    Local String    sCode
34022>>>                    Local Integer   iBreak
34022>>>                    Move 0 to iBreak
34023>>>                    Clear Nomisma
34024>>>                    Find Gt Nomisma.Recnum
34025>>>>
34025>>>                    While ((Found=1) And (iBreak=0))
34029>>>                        If (Nomisma.Einai_Euro='1') Begin
34031>>>                            Move 1 to iBreak
34032>>>                            Move Nomisma.Nomisma_Code to sCode
34033>>>                        End
34033>>>>
34033>>>                        If (Not(iBreak)) Find Gt Nomisma.Recnum
34036>>>                    Loop
34037>>>>
34037>>>                    Move (Trim(sCode)) to sCode
34038>>>        
34038>>>        
34038>>>                    Reread SysCurXR
34042>>>                    Move gs_Selected_Company_Code   to SysCurXR.Company_Code
34043>>>                    Move gs_Selected_beto_site      to SysCurXR.beto_site
34044>>>                    Move gs_Selected_Branch_Code    to SysCurXR.Branch_Code
34045>>>                    Move gi_Selected_Year           to SysCurXR.Year_Year
34046>>>                    Move lsYearRecr                 to SysCurXR.Year_Recr
34047>>>                    Move lsSite                     to SysCurXR.Branch_Site
34048>>>        
34048>>>                    Move sCname                     to SysCurXR.Company_Name
34049>>>                    Move sBname                     to SysCurXR.Branch_Name
34050>>>                    Move sYname                     to SysCurXR.Year_Descr
34051>>>        
34051>>>                    Move ldYearXrhsh_From           to SysCurXr.Year_XrhshFrom
34052>>>                    Move ldYearXrhsh_To             to SysCurXr.Year_XrhshTo
34053>>>        
34053>>>                    Move  (Trim(sNom1))             to SysCurXR.C_Code0
34054>>>                    Move  (Trim(sNom2))             to SysCurXR.C_Code00
34055>>>                    Move  (Trim(sNom3))             to SysCurXR.C_CodeR
34056>>>        
34056>>>                    Move sCode                      to SysCurXR.Euro_Code
34057>>>        
34057>>>                    Saverecord SysCurXR
34058>>>                    Unlock
34059>>>>
34059>>>        
34059>>>                    Move lsYearRecr                 to gs_Selected_Year_Recr
34060>>>                    Set psSelectedYearRecr          to lsYearRecr
34061>>>        
34061>>>                    Send Stop_Modal_ui
34062>>>        
34062>>>                    Set kEnter_Next_State of ghoWorkSpace to TRUE
34063>>>                End
34063>>>>
34063>>>            end
34063>>>>
34063>>>        End_Procedure
34064>>>        
34064>>>        Set Locate_Mode to Center_On_Screen
34065>>>        
34065>>>        On_Key KCancel      Send KeyAction to (oCancel_Bn(Self))
34066>>>        On_Key KClose_Panel Send KeyAction to (oCancel_Bn(Self))
34067>>>        On_Key Ksave_record send KeyAction to (oOK_Bn(Self))
34068>>>        
34068>>>        On_Key Key_alt+Key_A send KeyAction to (oOK_Bn(Self))
34069>>>        On_Key Key_alt+Key_Q send KeyAction to (oCancel_Bn(Self))
34070>>>        
34070>>>        
34070>>>        
34070>>>        
34070>>>        //AB-StoreEnd
34070>>>
34070>>>    End_Object    // oSelectYear
34071>>>
34071>>>
34071>>>    //AB-StoreStart
34071>>>    
34071>>>    Procedure Epelexe_Xrhsh for BaseClass
34072>>>        Integer liCompanyDD liBranchDD liYearDD liYear liModalId
34073>>>        String lsCompany lsBranch lsWhatXrhsh
34073>>>        Move oSelectYear to liModalId
34074>>>        Get ifSelect_Xrhsh Of liModalId to lsWhatXrhsh
34075>>>        if (Trim(lsWhatXrhsh)='') Send Exit_Application
34078>>>    End_Procedure
34079>>>    
34079>>>    Procedure Allaxe_Xrhsh for BaseClass
34080>>>        Integer rVal liModalId iID
34081>>>    
34081>>>        get message_box "‚ ˜ ¤˜ ˜¢¢á¥œ«œ ®¨ã©ž Ÿ˜ §¨â§œ  \n¤˜ ¡¢œå©à ¦¢˜ «˜ ˜¤¦ ®«á §˜¨áŸ¬¨˜ «žª œ­˜¨£¦šãª" '„§ ™œ™˜åà©ž €¢¢˜šãª •¨ã©žª' mb_yesno (mb_iconquestion ior mb_defbutton1) to rval
34082>>>        If (rVal = MBR_Yes) If (Close_All_Views(Self,True)=0) Begin
34086>>>            Move oSelectYear to liModalId
34087>>>            Send Epelexe_Xrhsh
34088>>>        End
34088>>>>
34088>>>    End_Procedure
34089>>>    
34089>>>    On_Key Key_Ctrl+Key_X Send Allaxe_Xrhsh
34090>>>    On_Key Key_Alt+Key_X  Send Allaxe_Xrhsh
34091>>>    
34091>>>    
34091>>>    
34091>>>    
34091>>>    //AB-StoreEnd
34091>>>
34091>>>//AB/     End_Object    // prj
34091>Send Epelexe_Xrhsh
34092>Use Menu_Sec.Sub
INCLUDING FILE: MENU_SEC.SUB
34092>>>
34092>>>Use Idiotht.pkg
INCLUDING FILE: IDIOTHT.PKG
34092>>>>>
34092>>>>>Open Users
34094>>>>>Open UserGrps
INCLUDING FILE: USERGRPS.FD
34096>>>>>Open Pedia
INCLUDING FILE: PEDIA.FD
34098>>>>>Open Arxeia
INCLUDING FILE: ARXEIA.FD
34100>>>>>Open GrpPedia
INCLUDING FILE: GRPPEDIA.FD
34102>>>>>Open GrpPed0
INCLUDING FILE: GRPPED0.FD
34104>>>>>Open GrpArx
INCLUDING FILE: GRPARX.FD
34106>>>>>Open GrpArx0
INCLUDING FILE: GRPARX0.FD
34108>>>>>Open ViewFlds
INCLUDING FILE: VIEWFLDS.FD
34110>>>>>Open Oth
INCLUDING FILE: OTH.FD
34112>>>>>Open GrpOth
INCLUDING FILE: GRPOTH.FD
34114>>>>>Open GrpOth0
INCLUDING FILE: GRPOTH0.FD
34116>>>>>Open Departm
INCLUDING FILE: DEPARTM.FD
34118>>>>>
34118>>>>>
34118>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
34119>>>>>
34119>>>>>Function Network_User_Name Returns String
34120>>>>>    Local String sName sLength
34121>>>>>    Local Pointer lpName_Addr lpLength_Addr
34121>>>>>    Local Integer iRetval
34121>>>>>    Movestr (Repeat (Character (0), 255)) To sName
34122>>>>>>
34122>>>>>    GetAddress Of sName To lpName_Addr
34123>>>>>    Movestr (DwordToBytes (255)) To sLength
34124>>>>>>
34124>>>>>    GetAddress Of sLength To lpLength_Addr
34125>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
34126>>>>>>
34126>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
34129>>>>>    Else Function_Return "User Unknown"
34131>>>>>End_Function // Network_User_Name
34132>>>>>
34132>>>>>Function fsGetOfficePath Global Returns String
34133>>>>>    String sRegistryKeyPath sRegOfficePath
34134>>>>>    Set_Registry_Root                                                   to HKEY_LOCAL_MACHINE "Software"
34135>>>>>    Move "Microsoft\Office\9.0\Word"                                    to sRegistryKeyPath
34136>>>>>    Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path"    to sRegOfficePath
34140>>>>>    Move (Trim(sRegOfficePath))                                         to sRegOfficePath
34141>>>>>    If (sRegOfficePath='') Begin
34143>>>>>        Move "Microsoft\Office\8.0\Word"                                to sRegistryKeyPath
34144>>>>>        Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34148>>>>>        Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34149>>>>>        If (sRegOfficePath='') Begin
34151>>>>>            Move "Microsoft\Office\7.0\Word"                             to sRegistryKeyPath
34152>>>>>            Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34156>>>>>            Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34157>>>>>            If (sRegOfficePath='') Begin
34159>>>>>                Move "Microsoft\Office\10.0\Word"                                to sRegistryKeyPath
34160>>>>>                Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34164>>>>>                Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34165>>>>>            End
34165>>>>>>
34165>>>>>        End
34165>>>>>>
34165>>>>>    End
34165>>>>>>
34165>>>>>    Function_Return sRegOfficePath
34166>>>>>End_Procedure
34167>>>>>
34167>>>>>
34167>>>>>Function fsGetLastDir Global Returns String
34168>>>>>    String sRegistryKeyPath sRegDir sUserName
34169>>>>>    Get Network_User_Name to sUserName
34170>>>>>
34170>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
34173>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
34176>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
34178>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
34180>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
34181>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
34182>>>>>    Get_profile_string sRegistryKeyPath "Path" to sRegDir
34185>>>>>    Function_Return sRegDir
34186>>>>>End_Procedure
34187>>>>>
34187>>>>>Function fiPutLastDir Global String asDirectory Returns Integer
34188>>>>>    String sRegistryKeyPath sRegDir sUserName
34189>>>>>    Get Network_User_Name to sUserName
34190>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
34193>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
34196>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
34198>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
34200>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
34201>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
34202>>>>>    Set_profile_string sRegistryKeyPath "Path" to asDirectory
34205>>>>>    Function_Return 0
34206>>>>>End_Procedure
34207>>>>>
34207>>>>>
34207>>>>>Function fsVresExt Global String asFileName Returns String
34208>>>>>    String rVal
34209>>>>>    Integer iPos iLen
34209>>>>>    Move (UpperCase(asFileName)) to asFileName
34210>>>>>    Move (Trim(asFileName)) to asFileName
34211>>>>>    Move 0 to iPos
34212>>>>>    For iLen from 1 to (length(asFileName))
34218>>>>>>
34218>>>>>        If (Mid(asFileName,1,iLen)='.') Move iLen to iPos
34221>>>>>    Loop
34222>>>>>>
34222>>>>>    If (Not(iPos)) Function_Return ''
34225>>>>>    Move (Right(asFileName,(Length(asFileName)-iPos))) to rVal
34226>>>>>    Move (Trim(rVal)) to rVal
34227>>>>>    Function_Return rVal
34228>>>>>End_Function
34229>>>>>
34229>>>>>
34229>>>>>Function fiScreenFieldStatus Global String asViewName String asDbFormName Returns Integer
34230>>>>>    Integer rVal iUser iGroup
34231>>>>>    String  sUser sRecr
34231>>>>>    Move (Trim(asViewName))     to asViewName
34232>>>>>    Move (Trim(asDbFormName))   to asDbFormName
34233>>>>>
34233>>>>>    If ((asViewName<>'') And (asDbFormName<>'')) Begin
34235>>>>>        Get fsLoginUserID to sUser
34236>>>>>        Clear Users
34237>>>>>        Move sUser        to Users.Login_ID
34238>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
34239>>>>>>
34239>>>>>        If (Found=1) Begin
34241>>>>>            Move Users.User_ID  to iUser
34242>>>>>            Move Users.Grp_ID   to iGroup
34243>>>>>            Clear GrpOth
34244>>>>>            Move iUser          to GrpOth.User_ID
34245>>>>>            Move asViewName     to GrpOth.View_Name
34246>>>>>            Move asDbFormName   to GrpOth.Scr_Field_Name
34247>>>>>            Find eq GrpOth by Index.2 // GrpOth:Index.2:User_ID+View_Name+Scr_Field_Name
34248>>>>>>
34248>>>>>            If (Found=1) Begin
34250>>>>>                // rVal=1 ==> NO READ ALLOWED
34250>>>>>                // rVal=2 ==> NO EDIT BUT CAN COPY
34250>>>>>                // rVal=3 ==> NO EDIT AND NO COPY
34250>>>>>                If (GrpOth.Allow_Read <>'1') Move 1 to rVal
34253>>>>>                Else Begin
34254>>>>>                    If (GrpOth.Allow_Change<>'1') Begin
34256>>>>>                        If (GrpOth.Allow_Copy<>'1') Move 3 to rVal
34259>>>>>                        Else                        Move 2 to rVal
34261>>>>>                    End
34261>>>>>>
34261>>>>>                End
34261>>>>>>
34261>>>>>            End
34261>>>>>>
34261>>>>>            Else Begin
34262>>>>>                Clear GrpOth0
34263>>>>>                Move iGroup         to GrpOth0.Group_ID
34264>>>>>                Move asViewName     to GrpOth0.View_Name
34265>>>>>                Move asDbFormName   to GrpOth0.Scr_Field_Name
34266>>>>>
34266>>>>>                Find eq GrpOth0 by Index.2 // GrpOth0:Index.2:Group_ID+View_Name+Scr_Field_Name
34267>>>>>>
34267>>>>>                If (Found=1) Begin
34269>>>>>                    // rVal=1 ==> NO READ ALLOWED
34269>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
34269>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
34269>>>>>                    If (GrpOth0.Allow_Read <>'1') Move 1 to rVal
34272>>>>>                    Else Begin
34273>>>>>                        If (GrpOth0.Allow_Change<>'1') Begin
34275>>>>>                            If (GrpOth0.Allow_Copy<>'1') Move 3 to rVal
34278>>>>>                            Else                         Move 2 to rVal
34280>>>>>                        End
34280>>>>>>
34280>>>>>                    End
34280>>>>>>
34280>>>>>                End
34280>>>>>>
34280>>>>>                Else Move 0 to rVal
34282>>>>>            End
34282>>>>>>
34282>>>>>        End
34282>>>>>>
34282>>>>>        Else Move 0 to rVal
34284>>>>>    End
34284>>>>>>
34284>>>>>    Function_Return rVal
34285>>>>>End_Function
34286>>>>>
34286>>>>>Function fiFieldStatus Global Integer aiFileNumber Integer aiFieldNumber Returns Integer
34287>>>>>    Integer rVal iUser iGroup
34288>>>>>    String  sUser sRecr
34288>>>>>    If ((aiFileNumber) And (aiFieldNumber)) Begin
34290>>>>>        Get fsLoginUserID to sUser
34291>>>>>        Clear Users
34292>>>>>        Move sUser        to Users.Login_ID
34293>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
34294>>>>>>
34294>>>>>        If (Found=1) Begin
34296>>>>>            Move Users.User_ID  to iUser
34297>>>>>            Move Users.Grp_ID   to iGroup
34298>>>>>            Clear Pedia
34299>>>>>            Move aiFileNumber  to Pedia.Arxeio_ID
34300>>>>>            Move aiFieldNumber to Pedia.Pedio_Number
34301>>>>>            Find eq Pedia By Index.1 // Pedia:Index.1:Arxeio_ID+Pedio_Number
34302>>>>>>
34302>>>>>            If (Found=1) Begin
34304>>>>>                Move (Trim(Pedia.Pedio_Recr))   to sRecr
34305>>>>>                // Find Combination User/File/Field in GRPPEDIA
34305>>>>>                Clear GrpPedia
34306>>>>>                Move iUser                      to GrpPedia.User_ID
34307>>>>>                Move (Trim(sRecr))              to GrpPedia.Pedio_Recr
34308>>>>>                Find eq GrpPedia by Index.4 // GrpPedia:Index.4:Pedio_Recr + User_ID
34309>>>>>>
34309>>>>>                If (Found=1) Begin
34311>>>>>                    // rVal=1 ==> NO READ ALLOWED
34311>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
34311>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
34311>>>>>                    If (GrpPedia.Allow_Read <>'1') Move 1 to rVal
34314>>>>>                    Else Begin
34315>>>>>                        If (GrpPedia.Allow_Change<>'1') Begin
34317>>>>>                            If (GrpPedia.Allow_Copy<>'1')   Move 3 to rVal
34320>>>>>                            Else                            Move 2 to rVal
34322>>>>>                        End
34322>>>>>>
34322>>>>>                    End
34322>>>>>>
34322>>>>>                End
34322>>>>>>
34322>>>>>                Else Begin
34323>>>>>                    // Find Combination UserGrps/File/Field in GRPPED0
34323>>>>>                    Clear GrpPed0
34324>>>>>                    Move iGroup         to GrpPed0.Group_ID
34325>>>>>                    Move (Trim(sRecr))  to GrpPed0.Pedio_Recr
34326>>>>>                    Find eq GrpPed0 by Index.4 // GrpPed0:Index.4:Pedio_Recr + Group_ID
34327>>>>>>
34327>>>>>                    If (Found=1) Begin
34329>>>>>                        // rVal=1 ==> NO READ ALLOWED
34329>>>>>                        // rVal=2 ==> NO EDIT BUT CAN COPY
34329>>>>>                        // rVal=3 ==> NO EDIT AND NO COPY
34329>>>>>                        If (GrpPed0.Allow_Read <>'1') Move 1 to rVal
34332>>>>>                        Else Begin
34333>>>>>                            If (GrpPed0.Allow_Change<>'1') Begin
34335>>>>>                                If (GrpPed0.Allow_Copy<>'1')   Move 3 to rVal
34338>>>>>                                Else                           Move 2 to rVal
34340>>>>>                            End
34340>>>>>>
34340>>>>>                        End
34340>>>>>>
34340>>>>>                    End
34340>>>>>>
34340>>>>>                End
34340>>>>>>
34340>>>>>            End
34340>>>>>>
34340>>>>>            Else Begin
34341>>>>>                Move 0 to rVal
34342>>>>>            End
34342>>>>>>
34342>>>>>        End
34342>>>>>>
34342>>>>>        Else Begin
34343>>>>>            Move 0 to rVal
34344>>>>>        End
34344>>>>>>
34344>>>>>    End
34344>>>>>>
34344>>>>>    Function_Return rVal
34345>>>>>End_Function
34346>>>>>
34346>>>>>Function fsReturnFileFromPath Global String asFullPath Returns String
34347>>>>>    String rVal lsDirSep
34348>>>>>    Integer iPos iMet iLen iCnt
34348>>>>>    Move (Trim(asFullPath))                 To rVal
34349>>>>>    Move (Sysconf(SYSCONF_DIR_SEPARATOR))   To lsDirSep
34350>>>>>    If (rVal Contains lsDirSep) Begin
34352>>>>>        Move (Length(rVal)) to iLen
34353>>>>>        Move iLen to iCnt
34354>>>>>        While iCnt Gt 0
34358>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Begin
34360>>>>>                If (iCnt=iLen) Function_Return asFullPath
34363>>>>>                Else Function_Return (Right(rVal,(iLen-iCnt)))
34365>>>>>            End
34365>>>>>>
34365>>>>>            Decrement iCnt
34366>>>>>        End // While iCnt Gt 0
34367>>>>>>
34367>>>>>    End
34367>>>>>>
34367>>>>>    Else  Function_Return (Trim(asFullPath))
34369>>>>>    Function_Return rVal
34370>>>>>End_Function
34371>>>>>
34371>>>>>Function fsReturnDirectoriesFromPath Global String asFullPath Returns String
34372>>>>>    String rVal lsDirSep
34373>>>>>    Integer iPos iMet iLen iCnt
34373>>>>>    Move (Trim(asFullPath))                 To rVal
34374>>>>>    Move (Sysconf(SYSCOnF_DIR_SEPARATOR))   To lsDirSep
34375>>>>>    If (rVal Contains lsDirSep) Begin
34377>>>>>        Move (Length(rVal)) to iLen
34378>>>>>        Move iLen to iCnt
34379>>>>>        While iCnt Gt 0
34383>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Function_Return (Left(rVal,iCnt))
34386>>>>>            Decrement iCnt
34387>>>>>        End // While iCnt Gt 0
34388>>>>>>
34388>>>>>    End
34388>>>>>>
34388>>>>>    Function_Return rVal
34389>>>>>End_Function
34390>>>>>
34390>>>>>//Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
34390>>>>>//    Local String rVal lsTmp lsOO lsLL
34390>>>>>//    Local Number lnOO lnLL
34390>>>>>
34390>>>>>//    Move '' to lsOO
34390>>>>>//    Move '' to lsLL
34390>>>>>//    Move '' to rVal
34390>>>>>
34390>>>>>//    Move (Integer(anTime))                              to lnOO
34390>>>>>//    ////////////////////////////////////////////
34390>>>>>//    // sos sos sos jsjsjsjsjs yannis 30/03/2000
34390>>>>>//    //If ((lnOO=24) and (lnll=0)) Move 0 to lnOO
34390>>>>>//    ////////////////////////////////////////////
34390>>>>>
34390>>>>>//    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
34390>>>>>
34390>>>>>//    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
34390>>>>>//    Else         Move (String(lnOO))                    to lsOO
34390>>>>>//    Move (Trim(lsOO))                                   to lsOO
34390>>>>>
34390>>>>>//    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
34390>>>>>//    Else         Move (String(lnLL))                    to lsLL
34390>>>>>//    Move (Trim(lsLL))                                   to lsLL
34390>>>>>
34390>>>>>//    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
34390>>>>>
34390>>>>>//    Move (Trim(rVal)) to rVal
34390>>>>>
34390>>>>>//    Function_Return rVal
34390>>>>>//End_Function
34390>>>>>
34390>>>>>//Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
34390>>>>>//    Local Number rVal nOres nLepta
34390>>>>>//    Move (Integer(aiMinutes/60))    to nOres
34390>>>>>//    Move (    Mod(aiMinutes,60))    to nLepta
34390>>>>>//    Move (nOres+(nLepta/100))       to rVal
34390>>>>>//    Function_Return rVal
34390>>>>>//End_Function
34390>>>>>
34390>>>>>//Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
34390>>>>>//    Local Integer rVal
34390>>>>>//    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
34390>>>>>//    Function_Return rVal
34390>>>>>//End_Function
34390>>>>>
34390>>>>>//Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;
34390>>>>>//                                                                    Number anEndTime    ;
34390>>>>>//                                                                    Returns Integer
34390>>>>>//    Local Integer rVal iMinStart iMinEnd
34390>>>>>
34390>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
34390>>>>>
34390>>>>>//    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
34390>>>>>//    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
34390>>>>>//    Move (iMinEnd-iMinStart)                                                     to rVal
34390>>>>>//    Function_Return rVal
34390>>>>>//End_Function
34390>>>>>
34390>>>>>
34390>>>>>//Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;
34390>>>>>//                                                                Number anEndTime    ;
34390>>>>>//                                                                Returns Number
34390>>>>>//    Local Integer iTmp
34390>>>>>//    Local Number  rVal
34390>>>>>
34390>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
34390>>>>>
34390>>>>>//    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
34390>>>>>//    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
34390>>>>>//    Function_Return rVal
34390>>>>>//End_Function
34390>>>>>
34390>>>>>
34390>>>>>Function fsLoginUserID Global Returns String
34391>>>>>    Local String LastLogin# LoginUserid#
34392>>>>>    get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin#
34395>>>>>    If LastLogin# eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin#
34398>>>>>    insert "WorkSpaces\" in LastLogin# at 1
34400>>>>>    Append LastLogin# "\" (Module_Name(Self)) "\LastLogin"
34403>>>>>    get_profile_string LastLogin# "LoginUserId"  to LoginUserId#
34406>>>>>    Trim LoginUserID# to LoginUserID#
34407>>>>>>
34407>>>>>    If LoginUserId# eq "" Move (Network_User_Name(Current_Object)) to LoginUserId#
34410>>>>>    Function_Return LoginUserID#
34411>>>>>End_Function
34412>>>>>
34412>>>>>Function fiWriteRegistryLastSDFPath Global String asLastPath Returns Integer
34413>>>>>    Integer rVal
34414>>>>>    String  lsCurrentWksp
34414>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34417>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34420>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34422>>>>>    // Œœ¦ ¡¢œ ›   - Last_SDF_Path -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
34422>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
34422>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
34425>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
34428>>>>>    Function_Return rVal
34429>>>>>End_Function
34430>>>>>
34430>>>>>
34430>>>>>Function fsReadRegistryLastSDFPath Global Returns String
34431>>>>>    String rVal lsCurrentWksp
34432>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34435>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34438>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34440>>>>>    // Œœ¦ ¡¢œ ›   - LastParastUsed -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
34440>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
34440>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
34443>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
34446>>>>>    Function_Return (Trim(rVal))
34447>>>>>End_Function
34448>>>>>
34448>>>>>
34448>>>>>Function fiWriteRegistryLastMCryptPath Global String asLastPath Returns Integer
34449>>>>>    Integer rVal
34450>>>>>    String  lsCurrentWksp
34450>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34453>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34456>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34458>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
34461>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
34464>>>>>    Function_Return rVal
34465>>>>>End_Function
34466>>>>>
34466>>>>>
34466>>>>>Function fsReadRegistryLastMCryptPath Global Returns String
34467>>>>>    String rVal lsCurrentWksp
34468>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34471>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34474>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34476>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
34479>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
34482>>>>>    Function_Return (Trim(rVal))
34483>>>>>End_Function
34484>>>>>
34484>>>>>
34484>>>>>Function fiWriteRegistryLastWEBPath Global String asLastPath Returns Integer
34485>>>>>    Integer rVal
34486>>>>>    String  lsCurrentWksp
34486>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34489>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34492>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34494>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
34497>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
34500>>>>>    Function_Return rVal
34501>>>>>End_Function
34502>>>>>
34502>>>>>
34502>>>>>Function fsReadRegistryLastWEBPath Global Returns String
34503>>>>>    String rVal lsCurrentWksp
34504>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34507>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34510>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34512>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
34515>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
34518>>>>>    Function_Return (Trim(rVal))
34519>>>>>End_Function
34520>>>>>
34520>>>>>
34520>>>>>
34520>>>>>Function fig_Is_Admin Global Returns Integer
34521>>>>>    String sUser
34522>>>>>    Integer rVal
34522>>>>>    Get fsLoginUserID to sUser
34523>>>>>    Move (trim(sUser)) to sUser
34524>>>>>    Clear Users
34525>>>>>    Move sUser to Users.Login_ID
34526>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
34527>>>>>>
34527>>>>>    Move Users.Admin_Rights to rVal
34528>>>>>    Function_Return rVal
34529>>>>>End_Function
34530>>>>>
34530>>>>>Function fig_The_User_Group Global Returns Integer
34531>>>>>    String sUser
34532>>>>>    Get fsLoginUserID   to sUser
34533>>>>>    Move (trim(sUser))  to sUser
34534>>>>>    Clear Users
34535>>>>>    Move sUser          to Users.Login_ID
34536>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
34537>>>>>>
34537>>>>>    Clear UserGrps
34538>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
34539>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
34540>>>>>>
34540>>>>>    Function_Return UserGrps.Grp_ID
34541>>>>>End_Function
34542>>>>>
34542>>>>>Function fsg_The_User_Department Global Returns String
34543>>>>>    String sUser
34544>>>>>    Get fsLoginUserID   to sUser
34545>>>>>    Move (trim(sUser))  to sUser
34546>>>>>    Clear Users
34547>>>>>    Move sUser          to Users.Login_ID
34548>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
34549>>>>>>
34549>>>>>    Clear Departm
34550>>>>>    Move Users.Departm_Code   to Departm.Code
34551>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
34552>>>>>>
34552>>>>>    Function_Return Departm.Code
34553>>>>>End_Function
34554>>>>>
34554>>>>>
34554>>>>>Function fig_Is_Specific_Admin Global String asUser Returns Integer
34555>>>>>    Integer rVal
34556>>>>>    Move (trim(asUser)) to asUser
34557>>>>>    Clear Users
34558>>>>>    Move asUser to Users.Login_ID
34559>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
34560>>>>>>
34560>>>>>    Move Users.Admin_Rights to rVal
34561>>>>>    Function_Return rVal
34562>>>>>End_Function
34563>>>>>
34563>>>>>Function fig_The_Specific_User_Group Global String asUser Returns Integer
34564>>>>>    Move (trim(asUser))  to asUser
34565>>>>>    Clear Users
34566>>>>>    Move asUser          to Users.Login_ID
34567>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
34568>>>>>>
34568>>>>>    Clear UserGrps
34569>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
34570>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
34571>>>>>>
34571>>>>>    Function_Return UserGrps.Grp_ID
34572>>>>>End_Function
34573>>>>>
34573>>>>>Function fsg_The_Specific_User_Department Global String asUser Returns String
34574>>>>>    Move (trim(asUser))  to asUser
34575>>>>>    Clear Users
34576>>>>>    Move asUser          to Users.Login_ID
34577>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
34578>>>>>>
34578>>>>>    Clear Departm
34579>>>>>    Move Users.Departm_Code   to Departm.Code
34580>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
34581>>>>>>
34581>>>>>    Function_Return Departm.Code
34582>>>>>End_Function
34583>>>>>
34583>>>>>
34583>>>
34583>>>Class ViewPopupMenu_Sec Is A ViewPopupMenu
34584>>>
34584>>>    Open Sysfile
INCLUDING FILE: SYSFILE.FD
34586>>>    Open Users
34588>>>    Open Views
INCLUDING FILE: VIEWS.FD
34590>>>    Open GrpViews
INCLUDING FILE: GRPVIEWS.FD
34592>>>    Open GrpView0
INCLUDING FILE: GRPVIEW0.FD
34594>>>    Open Arxeia
34596>>>    Open GrpArx
34598>>>
34598>>>    Function Find_User_Rights_In_Class String asView Returns Integer
34599>>>        String  lsView lsLogin
34600>>>        Integer liUser  liViews iGroup
34600>>>
34600>>>        Move (fsLoginUserID())      to lsLogin
34601>>>        Move (Trim(ToOEM(asView)))  to lsView
34602>>>
34602>>>        //////  /////////////////////////////////////
34602>>>        Clear Users
34603>>>        Move lsLogin    to Users.Login_ID
34604>>>
34604>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
34605>>>>
34605>>>        If (Found=1)  Begin
34607>>>            Move Users.User_ID  to liUser
34608>>>            Move Users.Grp_ID   to iGroup
34609>>>        End
34609>>>>
34609>>>        Else Function_Return 0
34611>>>
34611>>>        Clear Views
34612>>>        Move (Trim(lsView)) to Views.Menu_Name
34613>>>        Find eq Views by Index.2 // Views:Index.2:Views.Menu_Name
34614>>>>
34614>>>        If (Found=1) Begin
34616>>>            Move Views.View_ID to liViews
34617>>>            Clear GrpViews
34618>>>            Move liUser    to GrpViews.User_ID
34619>>>            Move liViews   to GrpViews.View_ID
34620>>>            Find Eq GrpViews by Index.1 // GrpViews:Index.1:GrpViews.User_ID+GrpViews.View_ID
34621>>>>
34621>>>            If (Found=1) Begin // And (liUser=GrpViews.User_ID) And (liViews=GrpViews.View_ID)) Begin
34623>>>                Function_Return (GrpViews.Allow_Read<>'1')
34624>>>            End
34624>>>>
34624>>>            Else Begin
34625>>>                Clear GrpView0
34626>>>                Move iGroup    to GrpView0.Group_ID
34627>>>                Move liViews   to GrpView0.View_ID
34628>>>                Find eq GrpView0 by Index.1 // GrpView0:Index.1:Group_ID+View_ID
34629>>>>
34629>>>                If (Found=1) Begin
34631>>>                    Function_Return (GrpView0.Allow_Read<>'1')
34632>>>                End
34632>>>>
34632>>>                Else         Function_Return 0
34634>>>            End
34634>>>>
34634>>>        End
34634>>>>
34634>>>        Else Function_Return 0
34636>>>    End_Function
34637>>>
34637>>>//    Procedure Enhmerose_Views_File_In_Class
34637>>>//        Integer liCount liInt liLastNo
34637>>>//        String lsStr
34637>>>//        Get Item_Count to liCount
34637>>>//        // find last view_id
34637>>>//        Clear Views
34637>>>//        Move 9999 to Views.View_ID
34637>>>//        Find lt Views by index.1 // view_id
34637>>>//        If (Found=1)    Move Views.View_ID  to liLastNo
34637>>>//        Else            Move 0              to liLastNo
34637>>>//        For liInt From 0 to (liCount-1)
34637>>>//            Get Value item liInt to lsStr
34637>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
34637>>>//            //Move (Trim(lsStr)) to lsStr
34637>>>//            If (lsStr<>'') Begin
34637>>>//                Clear Views
34637>>>//                Move lsStr to Views.Menu_Name
34637>>>//                Find eq Views by index.2 // Views.Menu_Name
34637>>>//                If (NOT(Found)) Begin
34637>>>//                    Add 1 to liLastNo
34637>>>//                    Move liLastNo to Views.View_ID
34637>>>//                    Saverecord Views
34637>>>//                End
34637>>>//            End
34637>>>//        Loop
34637>>>//        For liInt From 0 to (liCount-1)
34637>>>//            Get Value item liInt to lsStr
34637>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
34637>>>//            //Move (Trim(lsStr)) to lsStr
34637>>>//            If (lsStr<>'') Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
34637>>>//        Loop
34637>>>//    End_procedure
34637>>>
34637>>>    Procedure OnInitMenu
34638>>>        Integer liCount liInt liLastNo
34639>>>        String lsStr
34639>>>
34639>>>        Get Item_Count to liCount
34640>>>
34640>>>        // find last view_id
34640>>>        Clear Views
34641>>>        Move 9999 to Views.View_ID
34642>>>        Find lt Views by index.1 // view_id
34643>>>>
34643>>>        If (Found=1)    Move Views.View_ID  to liLastNo
34646>>>        Else            Move 0              to liLastNo
34648>>>        For liInt From 0 to (liCount-1)
34654>>>>
34654>>>            Get Value item liInt to lsStr
34655>>>            Move (Trim(lsStr)) to lsStr
34656>>>            If ((lsStr<>'') and (Length(lsStr)>2)) Begin
34658>>>                Clear Views
34659>>>                Move (ToOEM(lsStr)) to Views.Menu_Name
34660>>>                Find eq Views by index.2 // Views.Menu_Name
34661>>>>
34661>>>                If (NOT(Found)) Begin
34663>>>                    Add 1 to liLastNo
34664>>>                    Move liLastNo to Views.View_ID
34665>>>                    //Move (ToOEM(lsStr)) to Views.Menu_Name
34665>>>                    Saverecord Views
34666>>>                End
34666>>>>
34666>>>            End
34666>>>>
34666>>>        Loop
34667>>>>
34667>>>        For liInt From 0 to (liCount-1)
34673>>>>
34673>>>            Get Value item liInt to lsStr
34674>>>            Move (Trim(lsStr)) to lsStr
34675>>>            Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
34676>>>        Loop
34677>>>>
34677>>>
34677>>>    End_procedure
34678>>>
34678>>>//    Procedure End_Construct_Object
34678>>>//        Forward Send End_Construct_Object
34678>>>//        Send Enhmerose_Views_File_In_Class
34678>>>//    End_Procedure
34678>>>
34678>>>End_Class //ButtonSub
34679>>>
34679>>>
34679>Use dd_sec.sub
INCLUDING FILE: DD_SEC.SUB
34679>>>
34679>>>Open Sysfile
34681>>>Open UserGrps
34683>>>Open Users
34685>>>Open Views
34687>>>Open GrpViews
34689>>>Open Arxeia
34691>>>Open GrpArx
34693>>>Open GrpArx0
34695>>>Open GrpView0
34697>>>
34697>>>Use DD.Sub
34697>>>
34697>>>Class Datadictionary_Sec  Is A DatadictionarySub
34698>>>
34698>>>
34698>>>    Procedure Construct_Object
34699>>>        Forward Send Construct_Object
34701>>>        Property Integer cpiUpdate              0
34702>>>        Property Integer cpiBackout             0
34703>>>        Property Integer cpiEditing             0
34704>>>        Property Integer cpiFileNumber          0
34705>>>        Property String  cpsFileName            ''
34706>>>        Property String  cpsLoginID             ''
34707>>>        Property Integer cpiCannot_Read         0
34708>>>        Property Integer cpiCannot_Create       0
34709>>>        Property Integer cpiCannot_Delete       0
34710>>>        Property Integer cpiCannot_Edit         0
34711>>>        Property Integer piFN                   0
34712>>>    End_Procedure
34713>>>
34713>>>//    Procedure Save_Main_File
34713>>>//        If (Operation_Origin<>Self) Begin
34713>>>//            If Indirect_File.Recnum Eq 0 Procedure_Return
34713>>>//        End
34713>>>//        Forward Send Save_Main_File
34713>>>//    End_Procedure
34713>>>
34713>>>
34713>>>
34713>>>    Function Validate_Save Returns Integer
34714>>>        Integer rVal
34715>>>        Forward Get Validate_Save to rVal
34717>>>        If (Not(rVal)) Begin
34719>>>            Get cpiCannot_Read to rVal
34720>>>            If (Not(rVal)) Begin
34722>>>                Set cpiEditing to ((cpiBackout(Self)=1) and (cpiUpdate(Self)=1))
34723>>>                If (cpiEditing(Self)=1) Get cpiCannot_Edit      to rVal
34726>>>                Else                    Get cpiCannot_Create    to rVal
34728>>>            End
34728>>>>
34728>>>            If (rVal) Send Operation_Not_Allowed rVal
34731>>>        End
34731>>>>
34731>>>        Function_Return rVal
34732>>>    End_Function
34733>>>
34733>>>    Function Validate_Delete Returns Integer
34734>>>        Integer rVal
34735>>>        Forward Get Validate_Delete to rVal
34737>>>        If (Not(rVal)) Begin
34739>>>            Get cpiCannot_Read to rVal
34740>>>            If (Not(rVal)) Get cpiCannot_Delete to rVal
34743>>>            If (rVal) Send Operation_Not_Allowed rVal
34746>>>        End
34746>>>>
34746>>>        Function_Return rVal
34747>>>    End_Function
34748>>>
34748>>>    Procedure End_Construct_Object
34749>>>        Integer liSrv rVal
34750>>>        String lsStr
34750>>>        Forward Send End_Construct_Object
34752>>>        Get Main_File                                   To liSrv
34753>>>        Set cpiFileNumber                               To liSrv
34754>>>        Get_Attribute DF_FILE_PHYSICAL_NAME Of liSrv    To lsStr
34757>>>        Set cpsFileName                                 To (Trim(Uppercase(lsStr)))
34758>>>        Set cpsLoginID                                  To (fsLoginUserID())
34759>>>        Send Find_User_Rights
34760>>>        Set piFN to lisrv
34761>>>    End_Procedure
34762>>>
34762>>>    Procedure Find_User_Rights
34763>>>        String lsArxeio lsLogin
34764>>>        Integer liUser liArxeio iGroup
34764>>>
34764>>>        Get cpiFileNumber   to liArxeio
34765>>>        Get cpsFileName     to lsArxeio
34766>>>        Get cpsLoginID      to lsLogin
34767>>>
34767>>>        Clear Users
34768>>>        Move lsLogin    to Users.Login_ID
34769>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
34770>>>>
34770>>>        If (Found=1)  Begin
34772>>>            Move Users.User_ID  to liUser
34773>>>            Move Users.Grp_ID   to iGroup
34774>>>        End
34774>>>>
34774>>>        //Else Send Operation_Not_Allowed 9999
34774>>>
34774>>>        Clear Arxeia
34775>>>
34775>>>        Move liArxeio to Arxeia.Arxeio_ID
34776>>>        Find eq Arxeia by Index.1 // Arxeia:Index.1:Arxeia.Arxeio_ID
34777>>>>
34777>>>
34777>>>        If (Found=1) Begin
34779>>>            Move Arxeia.Arxeio_ID to liArxeio
34780>>>
34780>>>            Clear GrpArx
34781>>>            Move liUser     to GrpArx.User_ID
34782>>>            Move liArxeio   to GrpArx.Arxeio_ID
34783>>>            Find eq GrpArx by Index.1 // GrpArx:Index.1:GrpArx.User_ID+GrpArx.Arxeio_ID
34784>>>>
34784>>>            If (Found=1) Begin
34786>>>               If (GrpArx.Allow_Read  ='1') Set cpiCannot_Read   to 0
34789>>>               Else                         Set cpiCannot_Read   to 10003
34791>>>               If (GrpArx.Allow_Create='1') Set cpiCannot_Create to 0
34794>>>               Else                         Set cpiCannot_Create to 10000
34796>>>               If (GrpArx.Allow_Change='1') Set cpiCannot_Edit   to 0
34799>>>               Else                         Set cpiCannot_Edit   to 10001
34801>>>               If (GrpArx.Allow_Delete='1') Set cpiCannot_Delete to 0
34804>>>               Else                         Set cpiCannot_Delete to 10002
34806>>>            End
34806>>>>
34806>>>            Else Begin
34807>>>                Clear GrpArx0
34808>>>                Move iGroup   to GrpArx0.Group_ID
34809>>>                Move liArxeio to GrpArx0.Arxeio_ID
34810>>>                Find eq GrpArx0 by Index.1 // GrpArx0:Index.1:Group_ID+Arxeio_ID
34811>>>>
34811>>>                If (Found=1) Begin
34813>>>                    If (GrpArx0.Allow_Read  ='1')   Set cpiCannot_Read   to 0
34816>>>                    Else                            Set cpiCannot_Read   to 20003
34818>>>                    If (GrpArx0.Allow_Create='1')   Set cpiCannot_Create to 0
34821>>>                    Else                            Set cpiCannot_Create to 20000
34823>>>                    If (GrpArx0.Allow_Change='1')   Set cpiCannot_Edit   to 0
34826>>>                    Else                            Set cpiCannot_Edit   to 20001
34828>>>                    If (GrpArx0.Allow_Delete='1')   Set cpiCannot_Delete to 0
34831>>>                    Else                            Set cpiCannot_Delete to 20002
34833>>>                End
34833>>>>
34833>>>                Else Begin
34834>>>                    Set cpiCannot_Read   to 0
34835>>>                    Set cpiCannot_Edit   to 0
34836>>>                    Set cpiCannot_Create to 0
34837>>>                    Set cpiCannot_Delete to 0
34838>>>                End
34838>>>>
34838>>>            End
34838>>>>
34838>>>        End
34838>>>>
34838>>>        Else Begin
34839>>>            // €¤ ›œ¤ ™¨œŸœ  «¦ ˜¨®œ ¦ «¦«œ Ÿœà¨¦¬£œ ¦«  ¦ ®¨ž©«žª œ®œ  §¨¦©™˜©ž ©'˜¬«¦
34839>>>            Set cpiCannot_Read   to 0
34840>>>            Set cpiCannot_Edit   to 0
34841>>>            Set cpiCannot_Create to 0
34842>>>            Set cpiCannot_Delete to 0
34843>>>        End
34843>>>>
34843>>>    End_Procedure
34844>>>
34844>>>    Procedure Clear_main_file
34845>>>        Forward Send Clear_main_file
34847>>>        Set cpiBackout to 0
34848>>>        Set cpiUpdate  to 0
34849>>>    End_Procedure
34850>>>
34850>>>    Procedure Update
34851>>>        Forward Send Update
34853>>>        Set cpiUpdate to 1
34854>>>    End_Procedure
34855>>>
34855>>>    Procedure Backout
34856>>>        Forward Send Backout
34858>>>        Set cpiBackout to 1
34859>>>    End_Procedure
34860>>>
34860>>>    Procedure OnConstrain
34861>>>        Integer rVal liSrv
34862>>>        Forward Send OnConstrain
34864>>>        Get cpiFileNumber  To liSrv
34865>>>        Move liSrv         To Filenumber
34866>>>        Get cpiCannot_Read to rVal
34867>>>        If (rVal) Constrain Indirect_File.Recnum eq 0
34871>>>    End_Procedure
34872>>>
34872>>>    Procedure Operation_Not_Allowed  Integer iError_Num
34873>>>        String sLektiko
34874>>>        Move '' to sLektiko
34875>>>
34875>>>             If iError_Num eq 10000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
34878>>>        Else If iError_Num eq 10001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Users permissions. Check with your Administrator"    to sLektiko
34882>>>        Else If iError_Num eq 10002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
34886>>>        Else If iError_Num eq 10003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
34890>>>        Else If iError_Num eq 20000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
34894>>>        Else If iError_Num eq 20001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Group permissions. Check with your Administrator"    to sLektiko
34898>>>        Else If iError_Num eq 20002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
34902>>>        Else If iError_Num eq 20003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
34906>>>        Else If iError_Num eq  9999 Move "Unknown User in Users File"                                                                                    to sLektiko
34910>>>        Else If iError_Num eq 20101 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Change its Data"                 to sLektiko
34914>>>        Else If iError_Num eq 20102 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Delete It"                       to sLektiko
34918>>>        Append sLektiko '\nFile = ' (String(cpiFileNumber(Self))) ' - ' (CpsFileName(Self))
34922>>>
34922>>>             If iError_Num eq 10000 Error 10000 sLektiko
34925>>>        Else If iError_Num eq 10001 Error 10001 sLektiko
34929>>>        Else If iError_Num eq 10002 Error 10002 sLektiko
34933>>>        Else If iError_Num eq 10003 Error 10003 sLektiko
34937>>>        Else If iError_Num eq 20000 Error 20000 sLektiko
34941>>>        Else If iError_Num eq 20001 Error 20001 sLektiko
34945>>>        Else If iError_Num eq 20002 Error 20002 sLektiko
34949>>>        Else If iError_Num eq 20003 Error 20003 sLektiko
34953>>>        Else If iError_Num eq  9999 Error  9999 sLektiko
34957>>>        Else If iError_Num eq 20101 Error 20101 sLektiko
34961>>>        Else If iError_Num eq 20102 Error 20102 sLektiko
34965>>>
34965>>>        Else Forward Send Operation_Not_Allowed  iError_Num
34968>>>    End_Procedure   // Operation_Not_Allowed
34969>>>
34969>>>
34969>>>End_Class //Datadictionary_Sec
34970>//AB-StoreTopEnd
34970>
34970>
34970>Object Main is a Panelsub
34972>    Set Label To "transfer"
34973>
34973>    DFCreate_Menu Main_Menu
INCLUDING FILE: FILE_PM.INC
34976>>Object oMyWinPrint is an DF_PRINTER
34978>>
34978>>    Procedure DFPrint
34980>>        Local Integer iRetVal
34981>>
34981>>        Get DFGetPrintDialogFlags To iRetVal
34982>>
34982>>        If iRetVal Begin
34984>>            Send DFPrintDoc
34985>>            Send DFClearDoc
34986>>        End
34986>>>
34986>>    End_Procedure
34987>>    Move Current_Object to WinPrintId
34988>>End_Object
34989>>
34989>>
34989>>DFCreate_Menu "&File" File_Menu is a DEOPopupMenu
34993>>    On_Item "&Clear/Add\aF5" send Request_Clear
34994>>        Set Status_Help To 'Clear current record / Add a new record'
34995>>
34995>>    On_Item "Clear &all\aCtrl+F5" send Request_Clear_All
34996>>        Set Status_Help To 'Clear all data from view'
34997>>
34997>>    On_Item "&Delete\aShift+F2" send Request_Delete
34998>>        Set Status_Help To 'Delete the current record'
34999>>
34999>>    On_Item "&Find\aF9" send Find_GE
35000>>        Set Status_Help To 'Find a record'
35001>>
35001>>    On_Item "&Next\aF8" send Find_Next
35002>>        Set Status_Help To 'Find the Next record'
35003>>
35003>>    On_Item "&Previous\aF7" send Find_Previous
35004>>        Set Status_Help To 'Find the Previous record'
35005>>
35005>>    On_Item "Superfind\aShift+F9" send Superfind
35006>>        Set Status_Help To 'Superfind a record'
35007>>
35007>>    On_Item "Superfind next\aShift+F8" send Superfind_Next
35008>>        Set Status_Help To 'Superfind the Next record'
35009>>
35009>>    On_Item "Superfind previous\aShift+F7" send Superfind_Previous
35010>>        Set Status_Help To 'Superfind the Previous record'
35011>>
35011>>    On_Item "Find fi&rst\aCtrl+Home" send Beginning_Of_Data
35012>>        Set Status_Help To 'Find the First record'
35013>>
35013>>    On_Item "Find &last\aCtrl+End" send End_Of_Data
35014>>        Set Status_Help To 'Find the Last record'
35015>>
35015>>    On_Item "&Save\aF2" send Request_Save
35016>>        Set Status_Help To 'Save the current record'
35017>>
35017>>
35017>>    On_Item "" send NONE
35018>>
35018>>    on_item   "Printer Settings   "  send DFPrintSetup       to (oWinPrint(Self))
35019>>    Set Status_Help To ""
35020>>    on_item   "Print              "  send DFPrint            to (oMyWinPrint(Self))
35021>>    Set Status_Help To ""
35022>>
35022>>    On_Item "" send NONE
35023>>
35023>>    On_Item "Properties" send DoShowProperties to Self
35024>>    Set Status_Help To 'Setup Program Properties'
35025>>
35025>>    On_Item "" send NONE
35026>>
35026>>    On_Item "E&xit\aAlt+F4" send Exit_Application to desktop
35027>>        Set Status_Help To "Stop Program's execution"
35028>>
35028>>    Procedure DoShowProperties
35030>>       // If (Close_All_Views(Self,True)=0) Send Activate_View to (piPropertiesObjectId(self))
35030>>    End_Procedure
35031>>
35031>>    On_Key Key_Alt+Key_I Send DoShowProperties
35032>>
35032>>    //
35032>>    Procedure OnInitMenu
35034>>        Local integer Obj# IsDeo Changed NoIndex File# Field# Srvr Itm
35035>>        Local integer IsDeoControl lId liClId
35035>>        Get Focus to Obj#
35036>>        Get is_Function Get_DEO_Object Obj# TRUE to IsDeo
35037>>        If IsDeo Get Server of obj# to Srvr          // invoking data-set
35040>>        If (isDeo AND Srvr) Begin
35042>>            // returns T if object in question is a DEO control object (i.e.
35042>>            // understands the data_file, data_field messages).
35042>>            Get is_Function Get_DEO_Control_Object Obj# False to IsDeoControl
35043>>            Get Should_Save of Obj# to changed  // changed file?
35044>>            If IsDEOControl Begin
35046>>                Get data_file of Obj# to file#
35047>>                Get data_field of Obj# to field#
35048>>                Move ( File#=0 OR ;                    (Field_Main_Index(Srvr,File#,Field#)=-1) ;                    ) to NoIndex             // has a find index?
35049>>            End
35049>>>
35049>>            Else ;                Move 1 to NoIndex
35051>>            Set Shadow_state item  0  to False                     // Clear
35052>>            Set Shadow_state item  1  to False                     // Clear All
35053>>            Set Shadow_state item  2  to (Current_record(Srvr)=0)  // Delete
35054>>            Set Shadow_state item  3  to NoIndex                   // Find
35055>>            Set Shadow_state item  4  to NoIndex                   // Find Next
35056>>            Set Shadow_state item  5  to NoIndex                   // Find Previous
35057>>            Set Shadow_state item  6  to NoIndex                   // Superfind
35058>>            Set Shadow_state item  7  to NoIndex                   // Superfind Next
35059>>            Set Shadow_state item  8  to NoIndex                   // Superfind Previous
35060>>            Set Shadow_state item  9  to NoIndex                   // Find First
35061>>            Set Shadow_state item 10  to NoIndex                   // Find Last
35062>>            Set Shadow_state item 11  to (Should_Save(Srvr)=0)     // Save
35063>>            Set Shadow_state item 12  to NoIndex                   // Printer
35064>>            Set Shadow_state item 13  to NoIndex                   // Print
35065>>//            Set Shadow_state item 14  to NoIndex                   // Properties
35065>>//            Set Shadow_state item 15  to (Should_Save(Srvr)=0)     // Exodos
35065>>        End
35065>>>
35065>>        Else Begin
35066>>            for itm from 0 to 13
35072>>>
35072>>                set shadow_State item itm to TRUE
35073>>            Loop
35074>>>
35074>>        End
35074>>>
35074>> //       Set Shadow_State Item 14 to (piPropertiesObjectId(Self)=0)
35074>>    End_Procedure
35075>>
35075>>    Register_Procedure Activate_oPrnSetup
35075>>
35075>>End_Pull_Down
35077>>Set Status_Help to "Find, Save, Delete, Clear information or quit this application."
35078>
35078>        DFCreate_Menu "&View" ViewPopupMenu is a ViewPopupMenu
35082>        End_Pull_down
35084>        Set Status_Help To "Available Views"
35085>        
35085>        DFCreate_Menu "&Report" ReportPopupMenu is a ViewPopupMenu
35089>            On_Item "&R17_2:karteles eidon\aCtrl+1" Send Activate_R17_2
35090>        End_Pull_down
35092>        Set Status_Help To "Available Reports"
35093>        
INCLUDING FILE: NAVI_PM.INC
35093>>Use DFDEOMnu
35093>>
35093>>DFCreate_Menu "&Navigation" NAVIGATE_Menu is a DEOPopupMenu
35097>>    On_Item "&Next Area\aF6"            send Switch_Next_Area
35098>>        Set Status_Help To  'Move to Next Area'
35099>>
35099>>    On_Item "&Previous Area\aShift+F6"  send Switch_Prior_Area
35100>>        Set Status_Help To  'Move to Previous Area'
35101>>
35101>>    On_Item "N&ext View\aAlt+F6"        send Switch_Next_View
35102>>        Set Status_Help To  'Move to Next View'
35103>>
35103>>    On_Item "P&revious View\aCtrl+F6"   send Switch_Prior_View
35104>>        Set Status_Help To  'Move to Previous View'
35105>>
35105>>    On_Item ""                          send none
35106>>
35106>>    On_Item "&List\aF4"               send Prompt
35107>>        Set Status_Help To  'Show Selection Lists'
35108>>
35108>>    On_Item "&Zoom\aAlt+F9"             send Zoom
35109>>        Set Status_Help To  'Show Zoom'
35110>>
35110>>    Procedure OnInitMenu
35112>>        Local integer Obj# IsDeo Itm prmpt zm isDeoControl
35113>>        Get Focus to Obj#
35114>>        Get is_Function Get_DEO_Object Obj# TRUE to IsDeo
35115>>        If IsDeo Begin
35117>>            Get is_Function Get_DEO_Control_Object Obj# False to IsDeoControl
35118>>            If IsDeoControl Begin
35120>>                Get Prompt_Object of Obj# to Prmpt
35121>>                Get Zoom_Object of Obj# to zm
35122>>            End
35122>>>
35122>>            Set Shadow_state item 0  to False
35123>>            Set Shadow_state item 1  to False
35124>>            Set Shadow_state item 2  to False
35125>>            Set Shadow_state item 3  to False
35126>>            Set Shadow_state item 5  to (Prmpt=0)
35127>>            Set Shadow_state item 6  to (Zm=0)
35128>>        End
35128>>>
35128>>        Else Begin
35129>>            for itm from 0 to 6
35135>>>
35135>>                set shadow_State item itm to TRUE
35136>>            Loop
35137>>>
35137>>        End
35137>>>
35137>>    End_Procedure
35138>>
35138>>End_Pull_Down
35140>>Set Status_Help to "Navigation in different areas of the screen"
35141>>
INCLUDING FILE: WIN_PM.INC
35141>>DFCreate_Menu "&Window" Window_Menu
35145>>    Set select_mode to Multi_Select
35146>>    // normal number of items in pulldown (w/ no active views)
35146>>    property integer std_item_count public 0
35148>>
35148>>    DFCreate_Menu "&Preferences" Display_Options_Menu
35152>>        Set select_mode to Multi_Select
35153>>        On_Item "&ToolBar"        Send Toggle_Toolbar             To Self
35154>>        On_Item "&StatusBar"      Send Toggle_Statusbar           To Self
35155>>        On_Item "&Arrange Icons"  Send Toggle_Auto_Arrange_Icons  To Self
35156>>
35156>>        //  When ever the menu [pulldown] is initialized, check/set
35156>>        //  the state of its items.
35156>>        //
35156>>        Procedure OnInitMenu
35158>>            local integer bState
35159>>
35159>>            Get ToolBar_State to bState
35160>>            Set Select_State Item 0 to bState
35161>>            if  bState   Set Status_Help Item 0 To '' //'Hide the ToolBar'
35164>>            Else         Set Status_Help Item 0 to '' //'Show the ToolBar'
35166>>
35166>>            Get Statusbar_State to bState
35167>>            Set Select_State Item 1 to bState
35168>>            if  bState  Set Status_Help Item 1 To ''// 'Hide the StatusBar'
35171>>            Else        Set Status_Help Item 1 to ''// 'Show the StatusBar'
35173>>
35173>>            Get Auto_Arrange_Icons_State to bState
35174>>            Set Select_State Item 2 to bState
35175>>            if  bState  Set Status_Help Item 2 To '' //'Hide AutoArrange Icons'
35178>>            Else        Set Status_Help Item 2 to '' //'Show AutoArrange Icons'
35180>>
35180>>        End_procedure
35181>>
35181>>
35181>>    End_Pull_Down
35183>>    Set Status_Help                                           To '' //"Enable Toolbar, StatusBar, and AutoArrange Icons options"
35184>>
35184>>    On_Item ""
35185>>
35185>>    On_Item "&Cascade" send Cascade_Windows                   To Self
35186>>        Set Status_Help                                       To ''
35187>>
35187>>    On_Item "Tile &Horizontally" send Tile_Windows_Horizontal To Self
35188>>        Set Status_Help                                       To ''
35189>>
35189>>    On_Item "Tile &Vertically" send Tile_Windows_Vertical     To Self
35190>>        Set Status_Help                                       To ''
35191>>
35191>>    On_Item ""
35192>>
35192>>    On_Item "Minimize all" send Minimize_all_Windows          To Current_Object
35193>>        Set Status_Help                                       To ''
35194>>
35194>>    On_Item "&Restore all" send Restore_all_Windows           To Current_Object
35195>>        Set Status_Help                                       To ''
35196>>
35196>>    On_Item ""
35197>>
35197>>    On_Item "&Arrange Icons" send Arrange_Icons               To Current_Object
35198>>        Set Status_Help                                       To ''
35199>>
35199>>    // set this to the number of items in the menu with no views.
35199>>    Set Std_item_count to (item_count(current_object))
35200>>
35200>>    // add all active views to the end of the menu
35200>>    Procedure OnInitMenu
35202>>        local integer iStdCnt iNumCnt hVw hCl iCount
35203>>        Local string sLbl
35203>>        //*** Remove all old view items
35203>>        Get Item_count     to iNumCnt
35204>>        get Std_item_count to iStdCnt
35205>>        For iCount from 1  to (iNumCnt - iStdCnt)
35211>>>
35211>>            Send Delete_item iStdCnt
35212>>        Loop
35213>>>
35213>>
35213>>        Move iStdcnt to iNumCnt
35214>>        get Client_id to hCl // object id of client area
35215>>        If hCl Begin
35217>>           Get Next_Mdi_Dialog of hcl TRUE to hVw // find first view
35218>>           While hVw
35222>>              if (Active_state(hVw)) Begin
35224>>                 if iNumCnt eq iStdCnt Begin // if first view, add separator
35226>>                    send add_item 0 ''
35227>>                    increment iNumCnt
35228>>                 end
35228>>>
35228>>                 Get Label of hVw to sLbl // caption bar (name) of view
35229>>                 // note that all views understand the message activate_view.
35229>>                 send add_item msg_activate_view sLbl // set message, value and destination
35230>>                 set aux_value item iNumcnt to hVw
35231>>                 // if this is the focus view, mark it.
35231>>                 If (current_scope(desktop)=hVw and View_mode(hVw)<>VIEWMODE_ICONIZE) ;                     set select_state item iNumCnt to True
35234>>                 // create status help
35234>>                 Set Status_help item iNumCnt to ("Make this view (" - trim(sLbl) - ") the active window.")
35235>>                 increment iNumCnt
35236>>              end
35236>>>
35236>>              Get Next_Mdi_Dialog of hcl FALSE to hVw // find next
35237>>           End
35238>>>
35238>>        End
35238>>>
35238>>    End_Procedure // OnInitMenu
35239>>
35239>>End_Pull_Down
35241>>Set Status_Help to ''
INCLUDING FILE: HELPA_PM.INC
35242>>
35242>>
35242>>DFCreate_Menu "&Help" Help_Menu
35246>>    on_item "&Help Topic" send Help_on_topic
35247>>        Set Status_Help To "Search for help on a particular subject."
35248>>        on_item "" send NONE
35249>>    on_item "&Context Help"          send Extended_Help
35250>>        Set Status_Help To "Show Context sensitive help."
35251>>
35251>>    on_item "&Files Help"            send File_Help
35252>>        Set Status_Help To "Show Files help."
35253>>
35253>>    on_item "&Keys Help"             send Keys_Help
35254>>        Set Status_Help To "Show Keys help."
35255>>
35255>>    on_item "" send NONE
35256>>
35256>>    on_item "&How to Use Help"       send Help_For_Help
35257>>        Set Status_Help To "How to Use Help"
35258>>
35258>>    on_item "" send NONE
35259>>
35259>>    On_Item "&Tips of the Day" send Activate_TipOfDay
35260>>        Set Status_Help To "Tips of the Day"
35261>>
35261>>    on_item "" send NONE
35262>>
35262>>    On_item "About" Send Activate_About
35263>>        Set Status_Help To "System Information"
35264>>end_pull_down
35266>>Set Status_Help to "Access to the program's help subsystem"
35267>>
35267>>Register_Procedure Activate_TipOfDay
35267>>
35267>>
35267>    End_Menu
35269>
35269>    Use DFStdBtn.pkg //  Tool-Bar object.
INCLUDING FILE: DFSTDBTN.PKG
35269>>>// 07/23/96 JJT - New Class names
35269>>>// 10/03/97 KCR - removed leading separator
35269>>>
35269>>>Use DFMainBt  // dfMain_ButtonBar
INCLUDING FILE: DFMAINBT.PKG
35269>>>>>//-------------------------------------------------------------------------
35269>>>>>// DFMainBt.pkg - DfMain_ButtonBar class
35269>>>>>//
35269>>>>>//
35269>>>>>// 07/23/96 JJT - New Class names
35269>>>>>//-------------------------------------------------------------------------
35269>>>>>
35269>>>>>Use DfPanel // dfapp_buttonbar
35269>>>>>
35269>>>>>Class ToolBar is a AppToolBar
35270>>>>>
35270>>>>>    Function Is_Function Integer MsgId Integer ObjId Integer DelegateFg Returns Integer
35271>>>>>      Local integer rval MainObj#
35272>>>>>      Get Main_Panel_id to MainObj#
35273>>>>>      If (ObjId>Desktop AND MainObj#) ;         Get Is_Function of MainObj# MsgId ObjId DelegateFg to rVal
35276>>>>>      Function_Return rVal
35277>>>>>    End_Function
35278>>>>>
35278>>>>>    Procedure Redirect_Button_Message integer Itm
35279>>>>>         Local integer Msg# Aux# rval Understood
35280>>>>>         If (Shadow_State(Current_Object,itm)) Procedure_Return
35283>>>>>         Get Message   item itm  to Msg#
35284>>>>>         Get Aux_Value item itm  to Aux#
35285>>>>>         If Msg# Begin
35287>>>>>           If Aux# eq 0 Begin
35289>>>>>              Get Focus to Aux#
35290>>>>>              Get Is_Function Get_DEO_Object Aux# TRUE to Understood
35291>>>>>              If Not Understood Move 0 to Aux#
35294>>>>>           End
35294>>>>>>
35294>>>>>           If Aux# Get Msg# of Aux# to rval
35297>>>>>           Procedure_return rval
35298>>>>>         end
35298>>>>>>
35298>>>>>    End_Procedure // Redirect_Message
35299>>>>>
35299>>>>>End_Class
35300>>>>>
35300>>>>>
35300>>>
35300>>>//  Button bar object.
35300>>>//
35300>>>Object Tool_Bar is a ToolBar
35302>>>
35302>>>    Send ImageList_Add 'bgn.bmp'   // 0
35303>>>    Send ImageList_Add 'end.bmp'   // 1
35304>>>    Send ImageList_Add 'next.bmp'  // 2
35305>>>    Send ImageList_Add 'prev.bmp'  // 3
35306>>>    Send ImageList_Add 'clr.bmp'   // 4
35307>>>    Send ImageList_Add 'clra.bmp'  // 5
35308>>>
35308>>>    send Add_button (ico_user+0) msg_beginning_of_data
35309>>>    Send Add_ToolTip "Beginning of file"
35310>>>    Set  Status_Help To 'Find the First record (Ctrl+Home)'
35311>>>
35311>>>    send Add_button (ico_user+3) msg_find_previous
35312>>>    Send Add_ToolTip "Find Previous"
35313>>>    Set  Status_Help To 'Find the Previous record (F7)'
35314>>>
35314>>>    send Add_button (ico_user+2) msg_find_next
35315>>>    Send Add_ToolTip "Find Next"
35316>>>    Set  Status_Help To 'Find the Next record (F8)'
35317>>>
35317>>>    send Add_button (ico_user+1) msg_end_of_data
35318>>>    Send Add_ToolTip "End of File"
35319>>>    Set  Status_Help To 'Find the Last record (Ctrl+End)'
35320>>>
35320>>>    Send Add_space
35321>>>
35321>>>    send Add_button ico_std_find msg_prompt
35322>>>    Send Add_ToolTip "Prompt"
35323>>>    Set  Status_Help To 'Show available selections (F4)'
35324>>>
35324>>>    send Add_button (ico_user+4) msg_request_clear
35325>>>    Send Add_ToolTip "Clear"
35326>>>    Set  Status_Help To 'Clear current record / Add a new record (F5)'
35327>>>
35327>>>    send Add_button (ico_user+5) msg_request_clear_all
35328>>>    Send Add_ToolTip "Clear All"
35329>>>    Set  Status_Help To 'Clear all data from view (Ctrl+F5)'
35330>>>
35330>>>    send Add_space
35331>>>
35331>>>    send Add_button ico_std_filesave msg_request_save
35332>>>    Send Add_ToolTip "Save"
35333>>>    Set  Status_Help To 'Save the current record (F2)'
35334>>>
35334>>>    send Add_button ico_std_delete msg_request_delete
35335>>>    Send Add_ToolTip "Delete"
35336>>>    Set  Status_Help To 'Delete the current record (Shift+F2)'
35337>>>
35337>>>    send Add_space
35338>>>
35338>>>    send Add_button ico_std_cut msg_cut
35339>>>    Send Add_ToolTip "Cut"
35340>>>    Set  Status_Help to "Cuts the selection and puts it on the Clipboard"
35341>>>
35341>>>    send Add_button ico_std_copy msg_copy
35342>>>    Send Add_ToolTip "Copy"
35343>>>    Set  Status_Help to "Copies the selection and puts it on the Clipboard"
35344>>>
35344>>>    send Add_button ico_std_paste msg_paste
35345>>>    Send Add_ToolTip "Paste"
35346>>>    Set  Status_Help to "Inserts Clipboard contents"
35347>>>
35347>>>End_Object
35348>>>
35348>    
35348>    Object Client_Area is a AppClientAreasub
35350>        //  Include all views
35350>
35350>        //  Include all reports
35350>        Use R17_2.RV                                                                        
INCLUDING FILE: R17_2.RV
35350>>>//AB/ Project R17_2:karteles eidon
35350>>>//AB/     Object prj is a Report_Project
35350>>>//AB/         Set ProjectName to "R17_2:karteles eidon"
35350>>>//AB/         Set ProjectFileName to "R17_2.RV"
35350>>>
35350>>>// Project Object Structure
35350>>>//   R17_2 is a ReportView
35350>>>//     GroupSub1 is a GroupSub
35350>>>//       frapoapo is a FormSub
35350>>>//       Frkathapo is a FormSub
35350>>>//       FormSub4 is a FormSub
35350>>>//       TextBoxSub11 is a TextBoxSub
35350>>>//       TextBoxSub13 is a TextBoxSub
35350>>>//       TextBoxSub14 is a TextBoxSub
35350>>>//       fritemapo is a FormSub
35350>>>//       fritemeos is a FormSub
35350>>>//       LineControlSub2 is a LineControlSub
35350>>>//       FormSub6 is a FormSub
35350>>>//       FormSub7 is a FormSub
35350>>>//       TextBoxSub15 is a TextBoxSub
35350>>>//       FormSub9 is a FormSub
35350>>>//     GroupSub2 is a GroupSub
35350>>>//       FormSub1 is a FormSub
35350>>>//       FormSub2 is a FormSub
35350>>>//       TextBoxSub3 is a TextBoxSub
35350>>>//       TextBoxSub4 is a TextBoxSub
35350>>>//     RadioGroupSub5 is a RadioGroupSub
35350>>>//       Radio5 is a RadioSub
35350>>>//       Radio6 is a RadioSub
35350>>>//       Radio7 is a RadioSub
35350>>>//     RadioGroupSub4 is a RadioGroupSub
35350>>>//       RadioSub3 is a RadioSub
35350>>>//       RadioSub4 is a RadioSub
35350>>>//       TextBoxSub9 is a TextBoxSub
35350>>>//       TextBoxSub10 is a TextBoxSub
35350>>>//     LineControlSub1 is a LineControlSub
35350>>>//     ButtonSub1 is a ButtonSub
35350>>>//     ButtonSub2 is a ButtonSub
35350>>>//     GroupSub3 is a GroupSub
35350>>>//       FormSub10 is a FormSub
35350>>>//       FormSub11 is a FormSub
35350>>>//     karteles_BasicReport is a BasicReport
35350>>>//       Wtypkin_DD is a Wtypkin_DataDictionary
35350>>>//       Hmgiow_DD is a Hmgiow_DataDictionary
35350>>>//       Hmwtyp_DD is a Hmwtyp_DataDictionary
35350>>>//       wcmoves_dd is a wcmoves_datadictionary
35350>>>
35350>>>// Register all objects
35350>>>Register_Object ButtonSub1
35350>>>Register_Object ButtonSub2
35350>>>Register_Object FormSub1
35350>>>Register_Object FormSub10
35350>>>Register_Object FormSub11
35350>>>Register_Object FormSub2
35350>>>Register_Object FormSub4
35350>>>Register_Object FormSub6
35350>>>Register_Object FormSub7
35350>>>Register_Object FormSub9
35350>>>Register_Object Frkathapo
35350>>>Register_Object frapoapo
35350>>>Register_Object fritemapo
35350>>>Register_Object fritemeos
35350>>>Register_Object GroupSub1
35350>>>Register_Object GroupSub2
35350>>>Register_Object GroupSub3
35350>>>Register_Object Hmgiow_DD
35350>>>Register_Object Hmwtyp_DD
35350>>>Register_Object karteles_BasicReport
35350>>>Register_Object LineControlSub1
35350>>>Register_Object LineControlSub2
35350>>>Register_Object R17_2
35350>>>Register_Object Radio5
35350>>>Register_Object Radio6
35350>>>Register_Object Radio7
35350>>>Register_Object RadioGroupSub4
35350>>>Register_Object RadioGroupSub5
35350>>>Register_Object RadioSub3
35350>>>Register_Object RadioSub4
35350>>>Register_Object TextBoxSub10
35350>>>Register_Object TextBoxSub11
35350>>>Register_Object TextBoxSub13
35350>>>Register_Object TextBoxSub14
35350>>>Register_Object TextBoxSub15
35350>>>Register_Object TextBoxSub3
35350>>>Register_Object TextBoxSub4
35350>>>Register_Object TextBoxSub9
35350>>>Register_Object Wtypkin_DD
35350>>>Register_Object wcmoves_dd
35350>>>
35350>>>
35350>>>//AB/     Report View
35350>>>
35350>>>
35350>>>    //AB-StoreTopStart
35350>>>    use company.dd
35350>>>    use branch.dd
35350>>>    use year.dd
35350>>>    use Wapokat.DD
INCLUDING FILE: WAPOKAT.DD
35350>>>>>//DDB-FileStart
35350>>>>>//DDB-HeaderStart
35350>>>>>
35350>>>>>// File Name : WAPOKAT.DD
35350>>>>>// Class Name: Wapokat_DataDictionary
35350>>>>>// Revision  : 13
35350>>>>>// Version   : 2
35350>>>>>
35350>>>>>Use  Windows           // Basic Definitions
35350>>>>>Use  DataDict          // DataDictionary Class Definition
35350>>>>>Use  DDvalTbl          // Validation Table Class Definitions
35350>>>>>
35350>>>>>Open Wapokat
INCLUDING FILE: WAPOKAT.FD
35352>>>>>Open Wapomast
INCLUDING FILE: WAPOMAST.FD
35354>>>>>Open Sysrecw
INCLUDING FILE: SYSRECW.FD
35356>>>>>Open Syscurxr
35358>>>>>
35358>>>>>//DDB-HeaderEnd
35358>>>>>//DDB-SelectionStart
35358>>>>>//DDB/ ExternalSelectionList sl022  sl022.SL
35358>>>>>Register_Object sl022
35358>>>>>//DDB-SelectionEnd
35358>>>>>
35358>>>>>Class Wapokat_DataDictionary  is a DataDictionary
35359>>>>>
35359>>>>>    // Update:
35359>>>>>    Procedure Update
35360>>>>>        Forward Send Update
35362>>>>>        // Insert Code Here
35362>>>>>//        Move SysCurXR.Company_Code   to Wapokat.Company_Code
35362>>>>>//        Move SysCurXR.Branch_Code     to Wapokat.Branch_Code
35362>>>>>//        Move SysCurXR.Year_Year         to Wapokat.Year_Year
35362>>>>>    End_Procedure   // Update
35363>>>>> 
35363>>>>>     Procedure Creating
35364>>>>>        Forward Send Creating
35366>>>>>        // Insert Code Here
35366>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wapokat.Wapokat_Rec0)))))) to Wapokat.Wapokat_Recr
35367>>>>>    End_Procedure   // Creating
35368>>>>>
35368>>>>>
35368>>>>>    // Define_Fields:
35368>>>>>    // This procedure is used to set up all data-dictionary rules.
35368>>>>>
35368>>>>>    Procedure Define_Fields
35369>>>>>        Forward Send Define_Fields
35371>>>>>        //DDB-Generated-Code-Location
35371>>>>>        //DDB-DefineFieldStart
35371>>>>>
35371>>>>>        Set Main_File            To Wapokat.File_Number
35372>>>>>        Set Cascade_Delete_State To FALSE
35373>>>>>
35373>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
35374>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
35375>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
35376>>>>>
35376>>>>>        // Child (Client) file structure................
35376>>>>>        Send Add_Client_File  Wapomast.File_Number
35377>>>>>
35377>>>>>        // External (System) file structure.............
35377>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
35378>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
35379>>>>>
35379>>>>>        Define_Auto_Increment  Sysrecw.Wapokat_Rec0  To Wapokat.Wapokat_Rec0
35382>>>>>
35382>>>>>        // Field-based properties.......................
35382>>>>>
35382>>>>>        // Wapokat.Wapokat_Code
35382>>>>>        Set Field_Options          Field Wapokat.Wapokat_Code To DD_AUTOFIND   
35383>>>>>        Set Field_Prompt_Object    Field Wapokat.Wapokat_Code To (sl022(Self))
35384>>>>>
35384>>>>>        // Wapokat.Wapokat_Rec0
35384>>>>>        Set Field_Options          Field Wapokat.Wapokat_Rec0 To DD_AUTOFIND   
35385>>>>>
35385>>>>>        // Wapokat.Wapokat_Descr
35385>>>>>        Set Field_Prompt_Object    Field Wapokat.Wapokat_Descr To (sl022(Self))
35386>>>>>
35386>>>>>        // Wapokat.Wapokat_Recr
35386>>>>>        Set Field_Options          Field Wapokat.Wapokat_Recr To DD_AUTOFIND   
35387>>>>>
35387>>>>>        //DDB-DefineFieldEnd
35387>>>>>    End_Procedure    // Define_Fields
35388>>>>>
35388>>>>>    // Field_Defaults:
35388>>>>>    // This procedure is used to establish default field values.
35388>>>>>
35388>>>>>    Procedure Field_Defaults
35389>>>>>        Forward Send Field_Defaults
35391>>>>>        //DDB-Generated-Code-Location
35391>>>>>        //DDB-FieldDefaultStart
35391>>>>>        //DDB-FieldDefaultEnd
35391>>>>>    End_Procedure    // Field_Defaults
35392>>>>>
35392>>>>>End_Class    // Wapokat_DataDictionary
35393>>>>>//DDB-Selection-pkg-Start
35393>>>>>
35393>>>>>Use sl022.SL         // sl022
INCLUDING FILE: SL022.SL
35393>>>>>>>//AB/ Project sl022:kathg-apothkon
35393>>>>>>>//AB/ Object prj is a Lookup_Project
35393>>>>>>>//AB/     Set ProjectName to "sl022:kathg-apothkon"
35393>>>>>>>//AB/     Set ProjectFileName to "sl022.SL"
35393>>>>>>>
35393>>>>>>>// Project Object Structure
35393>>>>>>>//   sl022 is a dbModalPanelSub
35393>>>>>>>//     Wapokat_DD is a DataDictionary
35393>>>>>>>//     oSelList is a dbListSub
35393>>>>>>>//     oOK_bn is a ButtonSub
35393>>>>>>>//     oCancel_bn is a ButtonSub
35393>>>>>>>//     oSearch_bn is a ButtonSub
35393>>>>>>>
35393>>>>>>>// Register all objects
35393>>>>>>>Register_Object oCancel_bn
35393>>>>>>>Register_Object oOK_bn
35393>>>>>>>Register_Object oSearch_bn
35393>>>>>>>Register_Object oSelList
35393>>>>>>>Register_Object sl022
35393>>>>>>>Register_Object Wapokat_DD
35393>>>>>>>
35393>>>>>>>
35393>>>>>>>//AB-IgnoreStart
35393>>>>>>>
35393>>>>>>>Use DFAllEnt.pkg
35393>>>>>>>Use dbList.Sub
35393>>>>>>>Use Button.Sub
35393>>>>>>>
35393>>>>>>>
35393>>>>>>>Use WAPOKAT.DD
35393>>>>>>>
35393>>>>>>>//AB-IgnoreEnd
35393>>>>>>>
35393>>>>>>>CD_Popup_Object sl022 is a dbModalPanelSub
35412>>>>>>>    set label to "‰˜«žš¦¨åœª €§¦Ÿž¡é¤" 
35413>>>>>>>    Set Size to 148 297
35414>>>>>>>    Set Location to 12 19
35415>>>>>>>    Set Exit_Application_Local_State to FALSE
35416>>>>>>>    Set Modal_State to FALSE
35417>>>>>>>
35417>>>>>>>    //AB-DDOStart
35417>>>>>>>
35417>>>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
35419>>>>>>>    End_Object    // Wapokat_DD
35420>>>>>>>
35420>>>>>>>    Set Main_DD to (Wapokat_DD(self))
35421>>>>>>>    Set Server to (Wapokat_DD(self))
35422>>>>>>>
35422>>>>>>>    //AB-DDOEnd
35422>>>>>>>
35422>>>>>>>    Object oSelList is a dbListSub
35424>>>>>>>        Set Main_File to Wapokat.File_Number
35425>>>>>>>        Set Size to 105 280
35426>>>>>>>        Set Location to 6 6
35427>>>>>>>
35427>>>>>>>        Begin_Row
35430>>>>>>>            Entry_Item Wapokat.Wapokat_code
35431>>>>>>>            Entry_Item Wapokat.Wapokat_descr
35432>>>>>>>        End_Row
35437>>>>>>>
35437>>>>>>>        Set Form_Width    item 0 to 42
35438>>>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
35439>>>>>>>        
35439>>>>>>>        Set Form_Width    item 1 to 228
35440>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
35441>>>>>>>        
35441>>>>>>>    End_Object    // oSelList
35442>>>>>>>
35442>>>>>>>    Object oOK_bn is a ButtonSub
35444>>>>>>>        set label to "&„§ ¢¦šã" 
35445>>>>>>>        Set Location to 115 126
35446>>>>>>>
35446>>>>>>>        //AB-StoreStart
35446>>>>>>>        Procedure OnClick
35448>>>>>>>            Send OK To (oSelList(current_object))
35449>>>>>>>        End_Procedure
35450>>>>>>>        //AB-StoreEnd
35450>>>>>>>
35450>>>>>>>    End_Object    // oOK_bn
35451>>>>>>>
35451>>>>>>>    Object oCancel_bn is a ButtonSub
35453>>>>>>>        set label to "&€¡ç¨à©ž" 
35454>>>>>>>        Set Location to 115 181
35455>>>>>>>
35455>>>>>>>        //AB-StoreStart
35455>>>>>>>        Procedure OnClick
35457>>>>>>>            Send Cancel To (oSelList(current_object))
35458>>>>>>>        End_Procedure
35459>>>>>>>        //AB-StoreEnd
35459>>>>>>>
35459>>>>>>>    End_Object    // oCancel_bn
35460>>>>>>>
35460>>>>>>>    Object oSearch_bn is a ButtonSub
35462>>>>>>>        set label to "€&¤˜ã«ž©ž" 
35463>>>>>>>        Set Location to 115 236
35464>>>>>>>
35464>>>>>>>        //AB-StoreStart
35464>>>>>>>        Procedure OnClick
35466>>>>>>>            Send Search To (oSelList(current_object))
35467>>>>>>>        End_Procedure
35468>>>>>>>        //AB-StoreEnd
35468>>>>>>>
35468>>>>>>>    End_Object    // oSearch_bn
35469>>>>>>>
35469>>>>>>>
35469>>>>>>>    //AB-StoreStart
35469>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
35470>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
35471>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
35472>>>>>>>    //AB-StoreEnd
35472>>>>>>>
35472>>>>>>>CD_End_Object    // sl022
35474>>>>>>>>
35474>>>>>>>
35474>>>>>>>//AB/ End_Object    // prj
35474>>>>>
35474>>>>>//DDB-Selection-pkg-End
35474>>>>>//DDB-FileEnd
35474>>>    use Wapomast.DD
INCLUDING FILE: WAPOMAST.DD
35474>>>>>//DDB-FileStart
35474>>>>>//DDB-HeaderStart
35474>>>>>
35474>>>>>// File Name : WAPOMAST.DD
35474>>>>>// Class Name: Wapomast_DataDictionary
35474>>>>>// Revision  : 13
35474>>>>>// Version   : 2
35474>>>>>
35474>>>>>Use  Windows           // Basic Definitions
35474>>>>>Use  DataDict          // DataDictionary Class Definition
35474>>>>>Use  DDvalTbl          // Validation Table Class Definitions
35474>>>>>
35474>>>>>Open Wapomast
35476>>>>>Open Wax
INCLUDING FILE: WAX.FD
35478>>>>>Open Wapokat
35480>>>>>Open Sysrecw
35482>>>>>
35482>>>>>//DDB-HeaderEnd
35482>>>>>//DDB-SelectionStart
35482>>>>>//DDB/ ExternalSelectionList sl023  sl023.SL
35482>>>>>Register_Object sl023
35482>>>>>//DDB-SelectionEnd
35482>>>>>
35482>>>>>Class Wapomast_DataDictionary  is a DataDictionary
35483>>>>>    // Update:
35483>>>>>    Procedure Update
35484>>>>>        Forward Send Update
35486>>>>>        // Insert Code Here
35486>>>>>//        Move SysCurXR.Company_Code   to Wapomast.Company_Code
35486>>>>>//        Move SysCurXR.Branch_Code     to Wapomast.Branch_Code
35486>>>>>//        Move SysCurXR.Year_Year         to Wapomast.Year_Year
35486>>>>>        Move Wapokat.Wapokat_Code   to Wapomast.Wapokat_Code
35487>>>>>    End_Procedure   // Update
35488>>>>> 
35488>>>>>     Procedure Creating
35489>>>>>        Forward Send Creating
35491>>>>>        // Insert Code Here
35491>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wapomast.Wapomast_Rec0)))))) to Wapomast.Wapomast_Recr
35492>>>>>    End_Procedure   // Creating
35493>>>>>
35493>>>>>
35493>>>>>    // Define_Fields:
35493>>>>>    // This procedure is used to set up all data-dictionary rules.
35493>>>>>
35493>>>>>    Procedure Define_Fields
35494>>>>>        Forward Send Define_Fields
35496>>>>>        //DDB-Generated-Code-Location
35496>>>>>        //DDB-DefineFieldStart
35496>>>>>
35496>>>>>        Set Main_File            To Wapomast.File_Number
35497>>>>>        Set Cascade_Delete_State To FALSE
35498>>>>>
35498>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
35499>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
35500>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
35501>>>>>
35501>>>>>        // Child (Client) file structure................
35501>>>>>        Send Add_Client_File  Wax.File_Number
35502>>>>>
35502>>>>>        // Parent (Server) file structure...............
35502>>>>>        Send Add_Server_File  Wapokat.File_Number
35503>>>>>
35503>>>>>        // External (System) file structure.............
35503>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
35504>>>>>
35504>>>>>        Define_Auto_Increment  Sysrecw.Wapomast_Rec0  To Wapomast.Wapomast_Rec0
35507>>>>>
35507>>>>>        // Field-based properties.......................
35507>>>>>
35507>>>>>        // Wapomast.Wapokat_Code
35507>>>>>
35507>>>>>        // Wapomast.Wapokat_Recr
35507>>>>>
35507>>>>>        // Wapomast.Wapomast_Code
35507>>>>>        Set Field_Options          Field Wapomast.Wapomast_Code To DD_AUTOFIND   
35508>>>>>        Set Field_Prompt_Object    Field Wapomast.Wapomast_Code To (sl023(Self))
35509>>>>>
35509>>>>>        // Wapomast.Wapomast_Rec0
35509>>>>>        Set Field_Options          Field Wapomast.Wapomast_Rec0 To DD_AUTOFIND   
35510>>>>>
35510>>>>>        // Wapomast.Wapomast_Descr
35510>>>>>        Set Field_Prompt_Object    Field Wapomast.Wapomast_Descr To (sl023(Self))
35511>>>>>
35511>>>>>        // Wapomast.Wapomast_Recr
35511>>>>>        Set Field_Options          Field Wapomast.Wapomast_Recr To DD_AUTOFIND   
35512>>>>>
35512>>>>>        //DDB-DefineFieldEnd
35512>>>>>    End_Procedure    // Define_Fields
35513>>>>>
35513>>>>>    // Field_Defaults:
35513>>>>>    // This procedure is used to establish default field values.
35513>>>>>
35513>>>>>    Procedure Field_Defaults
35514>>>>>        Forward Send Field_Defaults
35516>>>>>        //DDB-Generated-Code-Location
35516>>>>>        //DDB-FieldDefaultStart
35516>>>>>        //DDB-FieldDefaultEnd
35516>>>>>    End_Procedure    // Field_Defaults
35517>>>>>
35517>>>>>End_Class    // Wapomast_DataDictionary
35518>>>>>//DDB-Selection-pkg-Start
35518>>>>>
35518>>>>>Use sl023.SL         // sl023
INCLUDING FILE: SL023.SL
35518>>>>>>>//AB/ Project sl023:apothkes
35518>>>>>>>//AB/ Object prj is a Lookup_Project
35518>>>>>>>//AB/     Set ProjectName to "sl023:apothkes"
35518>>>>>>>//AB/     Set ProjectFileName to "sl023.SL"
35518>>>>>>>
35518>>>>>>>// Project Object Structure
35518>>>>>>>//   sl023 is a dbModalPanelSub
35518>>>>>>>//     Wapokat_DD is a DataDictionary
35518>>>>>>>//     Wapomast_DD is a DataDictionary
35518>>>>>>>//     oSelList is a dbListSub
35518>>>>>>>//     oOK_bn is a ButtonSub
35518>>>>>>>//     oCancel_bn is a ButtonSub
35518>>>>>>>//     oSearch_bn is a ButtonSub
35518>>>>>>>
35518>>>>>>>// Register all objects
35518>>>>>>>Register_Object oCancel_bn
35518>>>>>>>Register_Object oOK_bn
35518>>>>>>>Register_Object oSearch_bn
35518>>>>>>>Register_Object oSelList
35518>>>>>>>Register_Object sl023
35518>>>>>>>Register_Object Wapokat_DD
35518>>>>>>>Register_Object Wapomast_DD
35518>>>>>>>
35518>>>>>>>
35518>>>>>>>//AB-IgnoreStart
35518>>>>>>>
35518>>>>>>>Use DFAllEnt.pkg
35518>>>>>>>Use dbList.Sub
35518>>>>>>>Use Button.Sub
35518>>>>>>>
35518>>>>>>>
35518>>>>>>>Use WAPOKAT.DD
35518>>>>>>>Use WAPOMAST.DD
35518>>>>>>>
35518>>>>>>>//AB-IgnoreEnd
35518>>>>>>>
35518>>>>>>>Object sl023 is a dbModalPanelSub
35520>>>>>>>
35520>>>>>>>    //AB-StoreTopStart
35520>>>>>>>    property string psapokat public ''
35522>>>>>>>    //AB-StoreTopEnd
35522>>>>>>>
35522>>>>>>>    Set Label to "€§¦Ÿã¡œª"
35523>>>>>>>    Set Size to 126 260
35524>>>>>>>    Set Location to 4 19
35525>>>>>>>    Set Exit_Application_Local_State to FALSE
35526>>>>>>>    Set Modal_State to FALSE
35527>>>>>>>
35527>>>>>>>    //AB-DDOStart
35527>>>>>>>
35527>>>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
35529>>>>>>>    End_Object    // Wapokat_DD
35530>>>>>>>
35530>>>>>>>    Object Wapomast_DD is a Wapomast_DataDictionary
35532>>>>>>>        Set DDO_Server to (Wapokat_DD(self))
35533>>>>>>>
35533>>>>>>>        //AB-StoreStart
35533>>>>>>>        
35533>>>>>>>        begin_constraints
35535>>>>>>>          if (psapokat(self) <> '') constrain wapomast.wapokat_code eq (psapokat(self))
35539>>>>>>>        
35539>>>>>>>        end_constraints
35542>>>>>>>        
35542>>>>>>>        //AB-StoreEnd
35542>>>>>>>
35542>>>>>>>    End_Object    // Wapomast_DD
35543>>>>>>>
35543>>>>>>>    Set Main_DD to (Wapomast_DD(self))
35544>>>>>>>    Set Server to (Wapomast_DD(self))
35545>>>>>>>
35545>>>>>>>    //AB-DDOEnd
35545>>>>>>>
35545>>>>>>>    Object oSelList is a dbListSub
35547>>>>>>>        Set Main_File to Wapomast.File_Number
35548>>>>>>>        Set Server to (Wapokat_DD(self))
35549>>>>>>>        Set Size to 89 240
35550>>>>>>>        Set Location to 6 6
35551>>>>>>>
35551>>>>>>>        Begin_Row
35554>>>>>>>            Entry_Item Wapomast.Wapomast_code
35555>>>>>>>            Entry_Item Wapomast.Wapomast_descr
35556>>>>>>>        End_Row
35561>>>>>>>
35561>>>>>>>        Set Form_Width    item 0 to 70
35562>>>>>>>        Set Header_Label  item 0 to "€§¦Ÿã¡ž      :"
35563>>>>>>>        
35563>>>>>>>        Set Form_Width    item 1 to 160
35564>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
35565>>>>>>>        
35565>>>>>>>
35565>>>>>>>        //AB-StoreStart
35565>>>>>>>                    
35565>>>>>>>                    
35565>>>>>>>        //AB-StoreEnd
35565>>>>>>>
35565>>>>>>>    End_Object    // oSelList
35566>>>>>>>
35566>>>>>>>    Object oOK_bn is a ButtonSub
35568>>>>>>>        Set Label to "&„§ ¢¦šã"
35569>>>>>>>        Set Location to 92 81
35570>>>>>>>
35570>>>>>>>        //AB-StoreStart
35570>>>>>>>        Procedure OnClick
35572>>>>>>>            Send OK To (oSelList(current_object))
35573>>>>>>>        End_Procedure
35574>>>>>>>        //AB-StoreEnd
35574>>>>>>>
35574>>>>>>>    End_Object    // oOK_bn
35575>>>>>>>
35575>>>>>>>    Object oCancel_bn is a ButtonSub
35577>>>>>>>        Set Label to "&€¡ç¨à©ž"
35578>>>>>>>        Set Location to 92 135
35579>>>>>>>
35579>>>>>>>        //AB-StoreStart
35579>>>>>>>        Procedure OnClick
35581>>>>>>>            Send Cancel To (oSelList(current_object))
35582>>>>>>>        End_Procedure
35583>>>>>>>        //AB-StoreEnd
35583>>>>>>>
35583>>>>>>>    End_Object    // oCancel_bn
35584>>>>>>>
35584>>>>>>>    Object oSearch_bn is a ButtonSub
35586>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
35587>>>>>>>        Set Location to 92 191
35588>>>>>>>
35588>>>>>>>        //AB-StoreStart
35588>>>>>>>        Procedure OnClick
35590>>>>>>>            Send Search To (oSelList(current_object))
35591>>>>>>>        End_Procedure
35592>>>>>>>        //AB-StoreEnd
35592>>>>>>>
35592>>>>>>>    End_Object    // oSearch_bn
35593>>>>>>>
35593>>>>>>>
35593>>>>>>>    //AB-StoreStart
35593>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
35594>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
35595>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
35596>>>>>>>    
35596>>>>>>>    procedure activate
35598>>>>>>>        send rebuild_constraints to wapomast_dd
35599>>>>>>>        send beginning_of_data to osellist true
35600>>>>>>>        forward send activate
35602>>>>>>>    end_procedure
35603>>>>>>>    
35603>>>>>>>    
35603>>>>>>>    //AB-StoreEnd
35603>>>>>>>
35603>>>>>>>End_Object    // sl023
35604>>>>>>>
35604>>>>>>>//AB/ End_Object    // prj
35604>>>>>
35604>>>>>//DDB-Selection-pkg-End
35604>>>>>//DDB-FileEnd
35604>>>    use wtypkin.dd
INCLUDING FILE: WTYPKIN.DD
35604>>>>>//DDB-FileStart
35604>>>>>//DDB-HeaderStart
35604>>>>>
35604>>>>>// File Name : WTYPKIN.DD
35604>>>>>// Class Name: Wtypkin_DataDictionary
35604>>>>>// Revision  : 49
35604>>>>>// Version   : 2
35604>>>>>
35604>>>>>Use  Windows           // Basic Definitions
35604>>>>>Use  DataDict          // DataDictionary Class Definition
35604>>>>>Use  DDvalTbl          // Validation Table Class Definitions
35604>>>>>
35604>>>>>Open Wtypkin
INCLUDING FILE: WTYPKIN.FD
35606>>>>>Open Ptyppar
INCLUDING FILE: PTYPPAR.FD
35608>>>>>Open Wcmoves
INCLUDING FILE: WCMOVES.FD
35610>>>>>Open Hmwtyp
INCLUDING FILE: HMWTYP.FD
35612>>>>>Open Wflagkin
INCLUDING FILE: WFLAGKIN.FD
35614>>>>>Open Sysrecw
35616>>>>>Open Syscurxr
35618>>>>>
35618>>>>>//DDB-HeaderEnd
35618>>>>>//DDB-ValidationStart
35618>>>>>
35618>>>>>Register_Object Wtypkin_Wtypkin_Module_VT
35618>>>>>
35618>>>>>Object Wtypkin_Wtypkin_Module_VT  is a CodeValidationTable
35620>>>>>    Set Type_Value        To "MODULE"
35621>>>>>    //DDB-ValidationCustomStart
35621>>>>>    //DDB-ValidationCustomEnd
35621>>>>>End_Object   // Wtypkin_Wtypkin_Module_VT
35622>>>>>//DDB-ValidationEnd
35622>>>>>//DDB-SelectionStart
35622>>>>>//DDB/ ExternalSelectionList sl029a  sl029a.SL
35622>>>>>Register_Object sl029a
35622>>>>>//DDB-SelectionEnd
35622>>>>>
35622>>>>>Class Wtypkin_DataDictionary  is a DataDictionary
35623>>>>>               
35623>>>>>    Procedure Construct_Object
35624>>>>>        Forward Send Construct_Object
35626>>>>>        Property Integer piMustNOTConstrain Public 0
35627>>>>>    End_Procedure
35628>>>>>
35628>>>>>    Procedure Save_Main_File
35629>>>>>        If (Operation_Origin<>Self) Begin
35631>>>>>            If Wtypkin.Recnum Eq 0 Procedure_Return
35634>>>>>        End
35634>>>>>>
35634>>>>>        Forward Send Save_Main_File
35636>>>>>    End_Procedure
35637>>>>>
35637>>>>>
35637>>>>>     Procedure Creating
35638>>>>>        Forward Send Creating
35640>>>>>        // Insert Code Here
35640>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wtypkin.Wtypkin_Rec0)))))) to Wtypkin.Wtypkin_Recr
35641>>>>>    End_Procedure   // Creating
35642>>>>>
35642>>>>>    // Define_Fields:
35642>>>>>    // This procedure is used to set up all data-dictionary rules.
35642>>>>>
35642>>>>>    Procedure Define_Fields
35643>>>>>        Forward Send Define_Fields
35645>>>>>        //DDB-Generated-Code-Location
35645>>>>>        //DDB-DefineFieldStart
35645>>>>>
35645>>>>>        Set Main_File            To Wtypkin.File_Number
35646>>>>>        Set Cascade_Delete_State To FALSE
35647>>>>>
35647>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
35648>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
35649>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
35650>>>>>
35650>>>>>        // Child (Client) file structure................
35650>>>>>        Send Add_Client_File  Ptyppar.File_Number
35651>>>>>        Send Add_Client_File  Wcmoves.File_Number
35652>>>>>        Send Add_Client_File  Hmwtyp.File_Number
35653>>>>>        Send Add_Client_File  Wflagkin.File_Number
35654>>>>>
35654>>>>>        // External (System) file structure.............
35654>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
35655>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
35656>>>>>
35656>>>>>        Define_Auto_Increment  Sysrecw.Wtypkin_Rec0  To Wtypkin.Wtypkin_Rec0
35659>>>>>
35659>>>>>        // Field-based properties.......................
35659>>>>>
35659>>>>>        // Wtypkin.Company_Code
35659>>>>>
35659>>>>>        // Wtypkin.Branch_Code
35659>>>>>
35659>>>>>        // Wtypkin.Year_Year
35659>>>>>
35659>>>>>        // Wtypkin.Wtypkin_Code
35659>>>>>        Set Field_Options          Field Wtypkin.Wtypkin_Code To DD_AUTOFIND   
35660>>>>>        Set Field_Prompt_Object    Field Wtypkin.Wtypkin_Code To (sl029a(Self))
35661>>>>>        Set Key_Field_State        Field Wtypkin.Wtypkin_Code To TRUE
35662>>>>>
35662>>>>>        // Wtypkin.Wtypkin_Rec0
35662>>>>>        Set Field_Options          Field Wtypkin.Wtypkin_Rec0 To DD_AUTOFIND   
35663>>>>>
35663>>>>>        // Wtypkin.Wtypkin_Recr
35663>>>>>
35663>>>>>        // Wtypkin.Year_Recr
35663>>>>>
35663>>>>>        // Wtypkin.Wtypkin_Descr
35663>>>>>        Set Field_Prompt_Object    Field Wtypkin.Wtypkin_Descr To (sl029a(Self))
35664>>>>>
35664>>>>>        // Wtypkin.Wtypkin_Anti
35664>>>>>
35664>>>>>        // Wtypkin.Wtypkin_Module
35664>>>>>        Set Field_Value_Table      Field Wtypkin.Wtypkin_Module To (Wtypkin_Wtypkin_Module_VT(Self))
35665>>>>>
35665>>>>>        // Wtypkin.Max_Days_Sx_Par
35665>>>>>
35665>>>>>        //DDB-DefineFieldEnd
35665>>>>>    End_Procedure    // Define_Fields
35666>>>>>
35666>>>>>    // Field_Defaults:
35666>>>>>    // This procedure is used to establish default field values.
35666>>>>>
35666>>>>>    Procedure Field_Defaults
35667>>>>>        Forward Send Field_Defaults
35669>>>>>        //DDB-Generated-Code-Location
35669>>>>>        //DDB-FieldDefaultStart
35669>>>>>        //DDB-FieldDefaultEnd
35669>>>>>    End_Procedure    // Field_Defaults
35670>>>>>
35670>>>>>End_Class    // Wtypkin_DataDictionary
35671>>>>>//DDB-Selection-pkg-Start
35671>>>>>
35671>>>>>Use sl029a.SL        // sl029a
INCLUDING FILE: SL029A.SL
35671>>>>>>>//AB/ Project sl029a:wtypkin
35671>>>>>>>//AB/     Object prj is a Lookup_Project
35671>>>>>>>//AB/         Set ProjectName to "sl029a:wtypkin"
35671>>>>>>>//AB/         Set ProjectFileName to "sl029a.SL"
35671>>>>>>>//AB/         Set GenerateFileName to "NONAME"
35671>>>>>>>
35671>>>>>>>// Project Object Structure
35671>>>>>>>//   sl029a is a dbModalPanelSub
35671>>>>>>>//     Wtypkin_DD is a DataDictionary
35671>>>>>>>//     oSelList is a dbListSub
35671>>>>>>>//     oOK_bn is a ButtonSub
35671>>>>>>>//     oCancel_bn is a ButtonSub
35671>>>>>>>//     oSearch_bn is a ButtonSub
35671>>>>>>>
35671>>>>>>>// Register all objects
35671>>>>>>>Register_Object oCancel_bn
35671>>>>>>>Register_Object oOK_bn
35671>>>>>>>Register_Object oSearch_bn
35671>>>>>>>Register_Object oSelList
35671>>>>>>>Register_Object sl029a
35671>>>>>>>Register_Object Wtypkin_DD
35671>>>>>>>
35671>>>>>>>
35671>>>>>>>    //AB-IgnoreStart
35671>>>>>>>
35671>>>>>>>    Use DFAllEnt.pkg
35671>>>>>>>    Use dbList.Sub
35671>>>>>>>    Use Button.Sub
35671>>>>>>>
35671>>>>>>>
35671>>>>>>>    Use WTYPKIN.DD
35671>>>>>>>    
35671>>>>>>>    //AB-IgnoreEnd
35671>>>>>>>
35671>>>>>>>    Object sl029a is a dbModalPanelSub
35673>>>>>>>        set label to "Ž¨ ©£æª ‰ ¤ã©œà¤ €§¦Ÿã¡žª" 
35674>>>>>>>        Set Size to 148 297
35675>>>>>>>        Set Location to 4 5
35676>>>>>>>        Set Exit_Application_Local_State to FALSE
35677>>>>>>>        Set Modal_State to FALSE
35678>>>>>>>
35678>>>>>>>        //AB-DDOStart
35678>>>>>>>
35678>>>>>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
35680>>>>>>>        End_Object    // Wtypkin_DD
35681>>>>>>>
35681>>>>>>>        Set Main_DD to (Wtypkin_DD(self))
35682>>>>>>>        Set Server to (Wtypkin_DD(self))
35683>>>>>>>
35683>>>>>>>        //AB-DDOEnd
35683>>>>>>>
35683>>>>>>>        Object oSelList is a dbListSub
35685>>>>>>>            Set Main_File to Wtypkin.File_Number
35686>>>>>>>            Set Size to 105 280
35687>>>>>>>            Set Location to 6 6
35688>>>>>>>
35688>>>>>>>            Begin_Row
35691>>>>>>>                Entry_Item Wtypkin.Wtypkin_code
35692>>>>>>>                Entry_Item Wtypkin.Wtypkin_descr
35693>>>>>>>            End_Row
35698>>>>>>>
35698>>>>>>>            Set Form_Width    item 0 to 60
35699>>>>>>>            set header_label  item 0 to "‰à› ¡¦ª" 
35700>>>>>>>            
35700>>>>>>>            Set Form_Width    item 1 to 212
35701>>>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
35702>>>>>>>            
35702>>>>>>>        End_Object    // oSelList
35703>>>>>>>
35703>>>>>>>        Object oOK_bn is a ButtonSub
35705>>>>>>>            set label to "&„§ ¢¦šã" 
35706>>>>>>>            Set Location to 115 126
35707>>>>>>>
35707>>>>>>>            //AB-StoreStart
35707>>>>>>>            Procedure OnClick
35709>>>>>>>                Send OK To (oSelList(current_object))
35710>>>>>>>            End_Procedure
35711>>>>>>>            //AB-StoreEnd
35711>>>>>>>
35711>>>>>>>        End_Object    // oOK_bn
35712>>>>>>>
35712>>>>>>>        Object oCancel_bn is a ButtonSub
35714>>>>>>>            set label to "&€¡ç¨à©ž" 
35715>>>>>>>            Set Location to 115 181
35716>>>>>>>
35716>>>>>>>            //AB-StoreStart
35716>>>>>>>            Procedure OnClick
35718>>>>>>>                Send Cancel To (oSelList(current_object))
35719>>>>>>>            End_Procedure
35720>>>>>>>            //AB-StoreEnd
35720>>>>>>>
35720>>>>>>>        End_Object    // oCancel_bn
35721>>>>>>>
35721>>>>>>>        Object oSearch_bn is a ButtonSub
35723>>>>>>>            set label to "€&¤˜ã«ž©ž" 
35724>>>>>>>            Set Location to 115 236
35725>>>>>>>
35725>>>>>>>            //AB-StoreStart
35725>>>>>>>            Procedure OnClick
35727>>>>>>>                Send Search To (oSelList(current_object))
35728>>>>>>>            End_Procedure
35729>>>>>>>            //AB-StoreEnd
35729>>>>>>>
35729>>>>>>>        End_Object    // oSearch_bn
35730>>>>>>>
35730>>>>>>>
35730>>>>>>>        //AB-StoreStart
35730>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
35731>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
35732>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
35733>>>>>>>        //AB-StoreEnd
35733>>>>>>>
35733>>>>>>>    End_Object    // sl029a
35734>>>>>>>
35734>>>>>>>//AB/     End_Object    // prj
35734>>>>>
35734>>>>>//DDB-Selection-pkg-End
35734>>>>>//DDB-FileEnd
35734>>>    use syscurxr.dd
INCLUDING FILE: SYSCURXR.DD
35734>>>>>//DDB-FileStart
35734>>>>>//DDB-HeaderStart
35734>>>>>
35734>>>>>// File Name : SYSCURXR.DD
35734>>>>>// Class Name: Syscurxr_DataDictionary
35734>>>>>// Revision  : 8
35734>>>>>// Version   : 2
35734>>>>>
35734>>>>>Use  Windows           // Basic Definitions
35734>>>>>Use  DataDict          // DataDictionary Class Definition
35734>>>>>Use  DDvalTbl          // Validation Table Class Definitions
35734>>>>>
35734>>>>>Open Syscurxr
35736>>>>>
35736>>>>>//DDB-HeaderEnd
35736>>>>>
35736>>>>>Class Syscurxr_DataDictionary  is a DataDictionary_Sec
35737>>>>>
35737>>>>>    // Define_Fields:
35737>>>>>    // This procedure is used to set up all data-dictionary rules.
35737>>>>>
35737>>>>>    Procedure Define_Fields
35738>>>>>        Forward Send Define_Fields
35740>>>>>        //DDB-Generated-Code-Location
35740>>>>>        //DDB-DefineFieldStart
35740>>>>>
35740>>>>>        Set Main_File            To Syscurxr.File_Number
35741>>>>>
35741>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
35742>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
35743>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
35744>>>>>
35744>>>>>        // Field-based properties.......................
35744>>>>>
35744>>>>>        // Syscurxr.Company_Code
35744>>>>>
35744>>>>>        // Syscurxr.Branch_Code
35744>>>>>
35744>>>>>        // Syscurxr.Year_Year
35744>>>>>
35744>>>>>        // Syscurxr.Branch_Site
35744>>>>>
35744>>>>>        // Syscurxr.Year_Recr
35744>>>>>
35744>>>>>        // Syscurxr.Company_Name
35744>>>>>
35744>>>>>        // Syscurxr.Branch_Name
35744>>>>>
35744>>>>>        // Syscurxr.Year_Descr
35744>>>>>
35744>>>>>        // Syscurxr.C_Code0
35744>>>>>
35744>>>>>        // Syscurxr.C_Code00
35744>>>>>
35744>>>>>        // Syscurxr.C_Coder
35744>>>>>
35744>>>>>        // Syscurxr.Year_Xrhshfrom
35744>>>>>
35744>>>>>        // Syscurxr.Year_Xrhshto
35744>>>>>
35744>>>>>        // Syscurxr.Beto_Site
35744>>>>>
35744>>>>>        // Syscurxr.Euro_Code
35744>>>>>
35744>>>>>        //DDB-DefineFieldEnd
35744>>>>>    End_Procedure    // Define_Fields
35745>>>>>
35745>>>>>    // Field_Defaults:
35745>>>>>    // This procedure is used to establish default field values.
35745>>>>>
35745>>>>>    Procedure Field_Defaults
35746>>>>>        Forward Send Field_Defaults
35748>>>>>        //DDB-Generated-Code-Location
35748>>>>>        //DDB-FieldDefaultStart
35748>>>>>        //DDB-FieldDefaultEnd
35748>>>>>    End_Procedure    // Field_Defaults
35749>>>>>
35749>>>>>End_Class    // Syscurxr_DataDictionary
35750>>>>>//DDB-FileEnd
35750>>>    Use Hmgiow.dd
INCLUDING FILE: HMGIOW.DD
35750>>>>>//DDB-FileStart
35750>>>>>//DDB-HeaderStart
35750>>>>>
35750>>>>>// File Name : HMGIOW.DD
35750>>>>>// Class Name: Hmgiow_DataDictionary
35750>>>>>// Revision  : 3
35750>>>>>// Version   : 2
35750>>>>>
35750>>>>>Use  Windows           // Basic Definitions
35750>>>>>Use  DataDict          // DataDictionary Class Definition
35750>>>>>Use  DDvalTbl          // Validation Table Class Definitions
35750>>>>>
35750>>>>>Open Hmgiow
INCLUDING FILE: HMGIOW.FD
35752>>>>>Open Hmwtyp
35754>>>>>Open Sysrecw
35756>>>>>
35756>>>>>//DDB-HeaderEnd
35756>>>>>//DDB-ValidationStart
35756>>>>>
35756>>>>>Register_Object Hmgiow_Hmgiow_Module_VT
35756>>>>>
35756>>>>>Object Hmgiow_Hmgiow_Module_VT  is a CodeValidationTable
35758>>>>>    Set Type_Value        To "MODULE"
35759>>>>>    //DDB-ValidationCustomStart
35759>>>>>    //DDB-ValidationCustomEnd
35759>>>>>End_Object   // Hmgiow_Hmgiow_Module_VT
35760>>>>>//DDB-ValidationEnd
35760>>>>>//DDB-SelectionStart
35760>>>>>//DDB/ ExternalSelectionList HmgioW  HmgioW.SL
35760>>>>>Register_Object HmgioW
35760>>>>>//DDB-SelectionEnd
35760>>>>>
35760>>>>>Class Hmgiow_DataDictionary  is a DataDictionary_Sec
35761>>>>>
35761>>>>>    // Define_Fields:
35761>>>>>    // This procedure is used to set up all data-dictionary rules.
35761>>>>>
35761>>>>>    Procedure Define_Fields
35762>>>>>        Forward Send Define_Fields
35764>>>>>        //DDB-Generated-Code-Location
35764>>>>>        //DDB-DefineFieldStart
35764>>>>>
35764>>>>>        Set Main_File            To Hmgiow.File_Number
35765>>>>>        Set Cascade_Delete_State To FALSE
35766>>>>>
35766>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
35767>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
35768>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
35769>>>>>
35769>>>>>        // Child (Client) file structure................
35769>>>>>        Send Add_Client_File  Hmwtyp.File_Number
35770>>>>>
35770>>>>>        // External (System) file structure.............
35770>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
35771>>>>>
35771>>>>>        Define_Auto_Increment  Sysrecw.Hmgiow_Code  To Hmgiow.Hmgiow_Code
35774>>>>>
35774>>>>>        // Field-based properties.......................
35774>>>>>
35774>>>>>        // Hmgiow.Hmgiow_Code
35774>>>>>        Set Field_Options          Field Hmgiow.Hmgiow_Code To DD_AUTOFIND
35775>>>>>        Set Field_Prompt_Object    Field Hmgiow.Hmgiow_Code To (HmgioW(Self))
35776>>>>>
35776>>>>>        // Hmgiow.Hmgiow_Descr
35776>>>>>        Set Field_Options          Field Hmgiow.Hmgiow_Descr To DD_AUTOFIND
35777>>>>>        Set Field_Prompt_Object    Field Hmgiow.Hmgiow_Descr To (HmgioW(Self))
35778>>>>>
35778>>>>>        // Hmgiow.Hmgiow_Module
35778>>>>>        Set Field_Value_Table      Field Hmgiow.Hmgiow_Module To (Hmgiow_Hmgiow_Module_VT(Self))
35779>>>>>
35779>>>>>        //DDB-DefineFieldEnd
35779>>>>>    End_Procedure    // Define_Fields
35780>>>>>
35780>>>>>    // Field_Defaults:
35780>>>>>    // This procedure is used to establish default field values.
35780>>>>>
35780>>>>>    Procedure Field_Defaults
35781>>>>>        Forward Send Field_Defaults
35783>>>>>        //DDB-Generated-Code-Location
35783>>>>>        //DDB-FieldDefaultStart
35783>>>>>        //DDB-FieldDefaultEnd
35783>>>>>    End_Procedure    // Field_Defaults
35784>>>>>
35784>>>>>End_Class    // Hmgiow_DataDictionary
35785>>>>>//DDB-Selection-pkg-Start
35785>>>>>
35785>>>>>Use HmgioW.SL        // HmgioW
INCLUDING FILE: HMGIOW.SL
35785>>>>>>>//AB/ Project HmgioW:Lookup
35785>>>>>>>//AB/     Object prj is a Lookup_Project
35785>>>>>>>//AB/         Set ProjectName to "HmgioW:Lookup"
35785>>>>>>>//AB/         Set ProjectFileName to "HmgioW.SL"
35785>>>>>>>//AB/         Set GenerateFileName to "NONAME"
35785>>>>>>>
35785>>>>>>>// Project Object Structure
35785>>>>>>>//   HmgioW is a dbModalPanelSub
35785>>>>>>>//     Hmgiow_DD is a DataDictionary
35785>>>>>>>//     oSelList is a dbListSub
35785>>>>>>>//     oOK_bn is a ButtonSub
35785>>>>>>>//     oCancel_bn is a ButtonSub
35785>>>>>>>//     oSearch_bn is a ButtonSub
35785>>>>>>>
35785>>>>>>>// Register all objects
35785>>>>>>>Register_Object HmgioW
35785>>>>>>>Register_Object Hmgiow_DD
35785>>>>>>>Register_Object oCancel_bn
35785>>>>>>>Register_Object oOK_bn
35785>>>>>>>Register_Object oSearch_bn
35785>>>>>>>Register_Object oSelList
35785>>>>>>>
35785>>>>>>>
35785>>>>>>>    //AB-IgnoreStart
35785>>>>>>>
35785>>>>>>>    Use DFAllEnt.pkg
35785>>>>>>>    Use dbList.Sub
35785>>>>>>>    Use Button.Sub
35785>>>>>>>
35785>>>>>>>
35785>>>>>>>    Use HMGIOW.DD
35785>>>>>>>    
35785>>>>>>>    //AB-IgnoreEnd
35785>>>>>>>
35785>>>>>>>    CD_Popup_Object HmgioW is a dbModalPanelSub
35804>>>>>>>
35804>>>>>>>        //AB-StoreTopStart
35804>>>>>>>        Property String psModule Public ''
35806>>>>>>>        
35806>>>>>>>        //AB-StoreTopEnd
35806>>>>>>>
35806>>>>>>>        set label to "†£œ¨¦¢æš ˜ €§¦Ÿã¡žª" 
35807>>>>>>>        Set Size to 148 297
35808>>>>>>>        Set Location to 5 9
35809>>>>>>>        Set Exit_Application_Local_State to FALSE
35810>>>>>>>        Set Modal_State to FALSE
35811>>>>>>>
35811>>>>>>>        //AB-DDOStart
35811>>>>>>>
35811>>>>>>>        Object Hmgiow_DD is a Hmgiow_DataDictionary
35813>>>>>>>        End_Object    // Hmgiow_DD
35814>>>>>>>
35814>>>>>>>        Set Main_DD to (Hmgiow_DD(self))
35815>>>>>>>        Set Server to (Hmgiow_DD(self))
35816>>>>>>>
35816>>>>>>>        //AB-DDOEnd
35816>>>>>>>
35816>>>>>>>        Object oSelList is a dbListSub
35818>>>>>>>            Set Main_File to Hmgiow.File_Number
35819>>>>>>>            Set Size to 105 280
35820>>>>>>>            Set Location to 6 6
35821>>>>>>>
35821>>>>>>>            Begin_Row
35824>>>>>>>                Entry_Item Hmgiow.Hmgiow_code
35825>>>>>>>                Entry_Item Hmgiow.Hmgiow_descr
35826>>>>>>>            End_Row
35831>>>>>>>
35831>>>>>>>            Set Form_Width    item 0 to 48
35832>>>>>>>            set header_label  item 0 to "‰à› ¡¦ª" 
35833>>>>>>>            
35833>>>>>>>            Set Form_Width    item 1 to 225
35834>>>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
35835>>>>>>>            
35835>>>>>>>        End_Object    // oSelList
35836>>>>>>>
35836>>>>>>>        Object oOK_bn is a ButtonSub
35838>>>>>>>            set label to "&„§ ¢¦šã" 
35839>>>>>>>            Set Location to 115 126
35840>>>>>>>
35840>>>>>>>            //AB-StoreStart
35840>>>>>>>            Procedure OnClick
35842>>>>>>>                Send OK To (oSelList(current_object))
35843>>>>>>>            End_Procedure
35844>>>>>>>            //AB-StoreEnd
35844>>>>>>>
35844>>>>>>>        End_Object    // oOK_bn
35845>>>>>>>
35845>>>>>>>        Object oCancel_bn is a ButtonSub
35847>>>>>>>            set label to "&€¡ç¨à©ž" 
35848>>>>>>>            Set Location to 115 181
35849>>>>>>>
35849>>>>>>>            //AB-StoreStart
35849>>>>>>>            Procedure OnClick
35851>>>>>>>                Send Cancel To (oSelList(current_object))
35852>>>>>>>            End_Procedure
35853>>>>>>>            //AB-StoreEnd
35853>>>>>>>
35853>>>>>>>        End_Object    // oCancel_bn
35854>>>>>>>
35854>>>>>>>        Object oSearch_bn is a ButtonSub
35856>>>>>>>            set label to "€&¤˜ã«ž©ž" 
35857>>>>>>>            Set Location to 115 236
35858>>>>>>>
35858>>>>>>>            //AB-StoreStart
35858>>>>>>>            Procedure OnClick
35860>>>>>>>                Send Search To (oSelList(current_object))
35861>>>>>>>            End_Procedure
35862>>>>>>>            //AB-StoreEnd
35862>>>>>>>
35862>>>>>>>        End_Object    // oSearch_bn
35863>>>>>>>
35863>>>>>>>
35863>>>>>>>        //AB-StoreStart
35863>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
35864>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
35865>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
35866>>>>>>>        
35866>>>>>>>        //AB-StoreEnd
35866>>>>>>>
35866>>>>>>>    CD_End_Object    // HmgioW
35868>>>>>>>>
35868>>>>>>>
35868>>>>>>>//AB/     End_Object    // prj
35868>>>>>
35868>>>>>//DDB-Selection-pkg-End
35868>>>>>//DDB-FileEnd
35868>>>    Use Hmwtyp.dd
INCLUDING FILE: HMWTYP.DD
35868>>>>>//DDB-FileStart
35868>>>>>//DDB-HeaderStart
35868>>>>>
35868>>>>>// File Name : HMWTYP.DD
35868>>>>>// Class Name: Hmwtyp_DataDictionary
35868>>>>>// Revision  : 1
35868>>>>>// Version   : 2
35868>>>>>
35868>>>>>Use  Windows           // Basic Definitions
35868>>>>>Use  DataDict          // DataDictionary Class Definition
35868>>>>>Use  DDvalTbl          // Validation Table Class Definitions
35868>>>>>
35868>>>>>Open Hmwtyp
35870>>>>>Open Hmgiow
35872>>>>>Open Wtypkin
35874>>>>>
35874>>>>>//DDB-HeaderEnd
35874>>>>>
35874>>>>>Class Hmwtyp_DataDictionary  is a DataDictionary_Sec
35875>>>>>
35875>>>>>    // Update:
35875>>>>>
35875>>>>>    Procedure Update
35876>>>>>        Forward Send Update
35878>>>>>        // Insert Code Here
35878>>>>>        Move SysCurXR.Company_Code  to HmWtyp.Company_Code
35879>>>>>        Move SysCurXR.Branch_Code   to HmWtyp.Branch_Code
35880>>>>>        Move SysCurXR.Year_Year     to HmWtyp.Year_Year
35881>>>>>        Move Wtypkin.Wtypkin_Code   to HmWtyp.Wtypkin_Code
35882>>>>>    End_Procedure   // Update
35883>>>>>
35883>>>>>
35883>>>>>
35883>>>>>
35883>>>>>    // Define_Fields:
35883>>>>>    // This procedure is used to set up all data-dictionary rules.
35883>>>>>
35883>>>>>    Procedure Define_Fields
35884>>>>>        Forward Send Define_Fields
35886>>>>>        //DDB-Generated-Code-Location
35886>>>>>        //DDB-DefineFieldStart
35886>>>>>
35886>>>>>        Set Main_File            To Hmwtyp.File_Number
35887>>>>>        Set Cascade_Delete_State To FALSE
35888>>>>>
35888>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
35889>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
35890>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
35891>>>>>
35891>>>>>        // Parent (Server) file structure...............
35891>>>>>        Send Add_Server_File  Hmgiow.File_Number
35892>>>>>        Send Add_Server_File  Wtypkin.File_Number
35893>>>>>
35893>>>>>        // Field-based properties.......................
35893>>>>>
35893>>>>>        // Hmwtyp.Hmgiow_Code
35893>>>>>
35893>>>>>        // Hmwtyp.Wtypkin_Recr
35893>>>>>
35893>>>>>        // Hmwtyp.Company_Code
35893>>>>>
35893>>>>>        // Hmwtyp.Branch_Code
35893>>>>>
35893>>>>>        // Hmwtyp.Year_Year
35893>>>>>
35893>>>>>        // Hmwtyp.Wtypkin_Code
35893>>>>>
35893>>>>>        //DDB-DefineFieldEnd
35893>>>>>    End_Procedure    // Define_Fields
35894>>>>>
35894>>>>>    // Field_Defaults:
35894>>>>>    // This procedure is used to establish default field values.
35894>>>>>
35894>>>>>    Procedure Field_Defaults
35895>>>>>        Forward Send Field_Defaults
35897>>>>>        //DDB-Generated-Code-Location
35897>>>>>        //DDB-FieldDefaultStart
35897>>>>>        //DDB-FieldDefaultEnd
35897>>>>>    End_Procedure    // Field_Defaults
35898>>>>>
35898>>>>>End_Class    // Hmwtyp_DataDictionary
35899>>>>>//DDB-FileEnd
35899>>>    use hmgiow.sl
35899>>>    use wax.sl
INCLUDING FILE: WAX.SL
35899>>>>>//AB/ Project Wax:Lookup Apothikhs
35899>>>>>//AB/ Object prj is a Lookup_Project
35899>>>>>//AB/     Set ProjectName to "Wax:Lookup Apothikhs"
35899>>>>>//AB/     Set ProjectFileName to "Wax.SL"
35899>>>>>//AB/     Set GenerateFileName to "NONAME"
35899>>>>>
35899>>>>>// Project Object Structure
35899>>>>>//   Wax is a dbModalPanelSub
35899>>>>>//     Wapokat_DD is a DataDictionary
35899>>>>>//     Wapomast_DD is a DataDictionary
35899>>>>>//     Wax_DD is a DataDictionary
35899>>>>>//     oSelList is a dbListSub
35899>>>>>//     oOK_bn is a ButtonSub
35899>>>>>//     oCancel_bn is a ButtonSub
35899>>>>>//     oSearch_bn is a ButtonSub
35899>>>>>
35899>>>>>// Register all objects
35899>>>>>Register_Object oCancel_bn
35899>>>>>Register_Object oOK_bn
35899>>>>>Register_Object oSearch_bn
35899>>>>>Register_Object oSelList
35899>>>>>Register_Object Wapokat_DD
35899>>>>>Register_Object Wapomast_DD
35899>>>>>Register_Object Wax
35899>>>>>Register_Object Wax_DD
35899>>>>>
35899>>>>>
35899>>>>>//AB-IgnoreStart
35899>>>>>
35899>>>>>Use DFAllEnt.pkg
35899>>>>>Use dbList.Sub
35899>>>>>Use Button.Sub
35899>>>>>
35899>>>>>
35899>>>>>Use WAPOKAT.DD
35899>>>>>Use WAPOMAST.DD
35899>>>>>Use WAX.DD
INCLUDING FILE: WAX.DD
35899>>>>>>>//DDB-FileStart
35899>>>>>>>//DDB-HeaderStart
35899>>>>>>>
35899>>>>>>>// File Name : WAX.DD
35899>>>>>>>// Class Name: Wax_DataDictionary
35899>>>>>>>// Revision  : 39
35899>>>>>>>// Version   : 2
35899>>>>>>>
35899>>>>>>>Use  Windows           // Basic Definitions
35899>>>>>>>Use  DataDict          // DataDictionary Class Definition
35899>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
35899>>>>>>>
35899>>>>>>>Open Wax
35901>>>>>>>Open Pmoves
INCLUDING FILE: PMOVES.FD
35903>>>>>>>Open Wcmoves
35905>>>>>>>Open Wam
INCLUDING FILE: WAM.FD
35907>>>>>>>Open Pmovesl
INCLUDING FILE: PMOVESL.FD
35909>>>>>>>Open Wapomast
35911>>>>>>>Open Sysrecw
35913>>>>>>>Open Syscurxr
35915>>>>>>>
35915>>>>>>>//DDB-HeaderEnd
35915>>>>>>>//DDB-SelectionStart
35915>>>>>>>//DDB/ ExternalSelectionList Wax  Wax.SL
35915>>>>>>>Register_Object Wax
35915>>>>>>>//DDB-SelectionEnd
35915>>>>>>>
35915>>>>>>>Class Wax_DataDictionary  is a DataDictionary_Sec
35916>>>>>>>
35916>>>>>>>    Procedure Construct_Object
35917>>>>>>>        Forward Send Construct_Object
35919>>>>>>>        Property Integer piMustNOTConstrain Public 0
35920>>>>>>>    End_Procedure //construct_object
35921>>>>>>>
35921>>>>>>>    Procedure OnConstrain
35922>>>>>>>        Forward Send OnConstrain
35924>>>>>>>        If (piMustNOTConstrain(Self)) Begin
35926>>>>>>>        End
35926>>>>>>>>
35926>>>>>>>        Else Begin
35927>>>>>>>            Constrain Wax.Company_Code  eq SysCurXR.Company_Code
35929>>>>>>>            Constrain Wax.Branch_Code   eq SysCurXR.Branch_Code
35931>>>>>>>            Constrain Wax.Year_Year     eq SysCurXR.Year_Year
35933>>>>>>>        End
35933>>>>>>>>
35933>>>>>>>    End_Procedure
35934>>>>>>>
35934>>>>>>>
35934>>>>>>>    // Update:
35934>>>>>>>    Procedure Update
35935>>>>>>>        Forward Send Update
35937>>>>>>>        // Insert Code Here
35937>>>>>>>        Move SysCurXR.Company_Code  to Wax.Company_Code
35938>>>>>>>        Move SysCurXR.Branch_Code   to Wax.Branch_Code
35939>>>>>>>        Move SysCurXR.Year_Year     to Wax.Year_Year
35940>>>>>>>        Move SysCurXR.Year_Recr     to Wax.Year_Recr
35941>>>>>>>        Move Wapokat.Wapokat_Code   to Wax.Wapokat_Code
35942>>>>>>>        Move Wapomast.Wapomast_Code to Wax.Wapomast_Code
35943>>>>>>>    End_Procedure   // Update
35944>>>>>>>
35944>>>>>>>     Procedure Creating
35945>>>>>>>        Forward Send Creating
35947>>>>>>>        // Insert Code Here
35947>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wax.Wax_Rec0)))))) to Wax.Wax_Recr
35948>>>>>>>    End_Procedure   // Creating
35949>>>>>>>
35949>>>>>>>
35949>>>>>>>
35949>>>>>>>    // Define_Fields:
35949>>>>>>>    // This procedure is used to set up all data-dictionary rules.
35949>>>>>>>
35949>>>>>>>    Procedure Define_Fields
35950>>>>>>>        Forward Send Define_Fields
35952>>>>>>>        //DDB-Generated-Code-Location
35952>>>>>>>        //DDB-DefineFieldStart
35952>>>>>>>
35952>>>>>>>        Set Main_File            To Wax.File_Number
35953>>>>>>>        Set Cascade_Delete_State To FALSE
35954>>>>>>>
35954>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
35955>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
35956>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
35957>>>>>>>
35957>>>>>>>        // Child (Client) file structure................
35957>>>>>>>        Send Add_Client_File  Pmoves.File_Number
35958>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
35959>>>>>>>        Send Add_Client_File  Wam.File_Number
35960>>>>>>>        Send Add_Client_File  Pmovesl.File_Number
35961>>>>>>>
35961>>>>>>>        // Parent (Server) file structure...............
35961>>>>>>>        Send Add_Server_File  Wapomast.File_Number
35962>>>>>>>
35962>>>>>>>        // External (System) file structure.............
35962>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
35963>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
35964>>>>>>>
35964>>>>>>>        Define_Auto_Increment  Sysrecw.Wax_Rec0  To Wax.Wax_Rec0
35967>>>>>>>
35967>>>>>>>        // Field-based properties.......................
35967>>>>>>>
35967>>>>>>>        // Wax.Company_Code
35967>>>>>>>
35967>>>>>>>        // Wax.Branch_Code
35967>>>>>>>
35967>>>>>>>        // Wax.Year_Year
35967>>>>>>>
35967>>>>>>>        // Wax.Wapokat_Code
35967>>>>>>>
35967>>>>>>>        // Wax.Wapomast_Code
35967>>>>>>>
35967>>>>>>>        // Wax.Wax_Code
35967>>>>>>>        Set Field_Options          Field Wax.Wax_Code To DD_AUTOFIND   
35968>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Code To (Wax(Self))
35969>>>>>>>
35969>>>>>>>        // Wax.Year_Recr
35969>>>>>>>
35969>>>>>>>        // Wax.Wapomast_Recr
35969>>>>>>>
35969>>>>>>>        // Wax.Wax_Rec0
35969>>>>>>>        Set Field_Options          Field Wax.Wax_Rec0 To DD_AUTOFIND   
35970>>>>>>>
35970>>>>>>>        // Wax.Wax_Recr
35970>>>>>>>        Set Field_Options          Field Wax.Wax_Recr To DD_AUTOFIND   
35971>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Recr To (Wax(Self))
35972>>>>>>>
35972>>>>>>>        // Wax.Wax_Descr
35972>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Descr To (Wax(Self))
35973>>>>>>>
35973>>>>>>>        //DDB-DefineFieldEnd
35973>>>>>>>    End_Procedure    // Define_Fields
35974>>>>>>>
35974>>>>>>>    // Field_Defaults:
35974>>>>>>>    // This procedure is used to establish default field values.
35974>>>>>>>
35974>>>>>>>    Procedure Field_Defaults
35975>>>>>>>        Forward Send Field_Defaults
35977>>>>>>>        //DDB-Generated-Code-Location
35977>>>>>>>        //DDB-FieldDefaultStart
35977>>>>>>>        //DDB-FieldDefaultEnd
35977>>>>>>>    End_Procedure    // Field_Defaults
35978>>>>>>>
35978>>>>>>>End_Class    // Wax_DataDictionary
35979>>>>>>>//DDB-Selection-pkg-Start
35979>>>>>>>
35979>>>>>>>Use Wax.SL           // Wax
35979>>>>>>>
35979>>>>>>>//DDB-Selection-pkg-End
35979>>>>>>>//DDB-FileEnd
35979>>>>>
35979>>>>>//AB-IgnoreEnd
35979>>>>>
35979>>>>>Object Wax is a dbModalPanelSub
35981>>>>>
35981>>>>>    //AB-StoreTopStart
35981>>>>>                            
35981>>>>>    Property Integer    piMustConstrain Public  0
35983>>>>>    Property Integer    piYear          Public  0
35985>>>>>    Property String     psCompany       Public ''
35987>>>>>    Property String     psBranch        Public ''
35989>>>>>    Property String     psWapokat       Public ''
35991>>>>>    
35991>>>>>    //AB-StoreTopEnd
35991>>>>>
35991>>>>>    Set Label to "‰˜«á¢¦š¦ª €§¦Ÿž¡é¤"
35992>>>>>    Set Size to 148 355
35993>>>>>    Set Location to 8 21
35994>>>>>    Set Exit_Application_Local_State to FALSE
35995>>>>>    Set Modal_State to FALSE
35996>>>>>
35996>>>>>    //AB-DDOStart
35996>>>>>
35996>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
35998>>>>>    End_Object    // Wapokat_DD
35999>>>>>
35999>>>>>    Object Wapomast_DD is a Wapomast_DataDictionary
36001>>>>>        Set DDO_Server to (Wapokat_DD(self))
36002>>>>>    End_Object    // Wapomast_DD
36003>>>>>
36003>>>>>    Object Wax_DD is a Wax_DataDictionary
36005>>>>>        Set DDO_Server to (Wapomast_DD(self))
36006>>>>>
36006>>>>>        //AB-StoreStart
36006>>>>>                            
36006>>>>>        Begin_Constraints
36008>>>>>            Integer iMustConstrain iYear
36009>>>>>            String  sCompany sBranch sWapokat
36009>>>>>            Get piMustConstrain to iMustConstrain
36010>>>>>            If (iMustConstrain) Begin
36012>>>>>                Get piYear     to  iYear
36013>>>>>                Get psCompany  to  sCompany
36014>>>>>                Get psBranch   to  sBranch
36015>>>>>                Get psWapokat  to  sWapokat
36016>>>>>                If (sCompany<>'') Begin
36018>>>>>                    Constrain Wax.Company_Code eq sCompany
36020>>>>>                    If (sBranch<>'') Begin
36022>>>>>                        Constrain Wax.Branch_Code eq sBranch
36024>>>>>                        If (iYear<>0) Begin
36026>>>>>                            Constrain Wax.Year_Year eq iYear
36028>>>>>                            If (sWapokat<>'') Begin
36030>>>>>                                Constrain Wax.Wapokat_Code eq sWapokat
36032>>>>>                            End
36032>>>>>>
36032>>>>>                        End
36032>>>>>>
36032>>>>>                    End
36032>>>>>>
36032>>>>>                End
36032>>>>>>
36032>>>>>            End
36032>>>>>>
36032>>>>>        End_Constraints
36035>>>>>        
36035>>>>>        
36035>>>>>        
36035>>>>>        
36035>>>>>        //AB-StoreEnd
36035>>>>>
36035>>>>>    End_Object    // Wax_DD
36036>>>>>
36036>>>>>    Set Main_DD to (Wax_DD(self))
36037>>>>>    Set Server to (Wax_DD(self))
36038>>>>>
36038>>>>>    //AB-DDOEnd
36038>>>>>
36038>>>>>    Object oSelList is a dbListSub
36040>>>>>        Set Main_File to Wax.File_Number
36041>>>>>        Set Size to 105 340
36042>>>>>        Set Location to 6 6
36043>>>>>
36043>>>>>        Begin_Row
36046>>>>>            Entry_Item Wax.Wax_recr
36047>>>>>            Entry_Item Wax.Wax_code
36048>>>>>            Entry_Item Wax.Wax_descr
36049>>>>>        End_Row
36054>>>>>
36054>>>>>        Set Form_Width    item 0 to 33
36055>>>>>        Set Header_Label  item 0 to "Recr"
36056>>>>>        
36056>>>>>        Set Form_Width    item 1 to 80
36057>>>>>        Set Header_Label  item 1 to "‰à› ¡æª"
36058>>>>>        
36058>>>>>        Set Form_Width    item 2 to 219
36059>>>>>        Set Header_Label  item 2 to "œ¨ š¨˜­ã"
36060>>>>>        
36060>>>>>
36060>>>>>        //AB-StoreStart
36060>>>>>                                                            
36060>>>>>        Procedure Activate
36062>>>>>            Send Rebuild_Constraints to Wax_DD
36063>>>>>            Send Beginning_Of_Data to oSelList True
36064>>>>>            Forward Send Activate
36066>>>>>        End_procedure
36067>>>>>        
36067>>>>>        
36067>>>>>        
36067>>>>>        //AB-StoreEnd
36067>>>>>
36067>>>>>    End_Object    // oSelList
36068>>>>>
36068>>>>>    Object oOK_bn is a ButtonSub
36070>>>>>        Set Label to "&„§ ¢¦šã"
36071>>>>>        Set Location to 113 186
36072>>>>>
36072>>>>>        //AB-StoreStart
36072>>>>>        Procedure OnClick
36074>>>>>            Send OK To (oSelList(current_object))
36075>>>>>        End_Procedure
36076>>>>>        //AB-StoreEnd
36076>>>>>
36076>>>>>    End_Object    // oOK_bn
36077>>>>>
36077>>>>>    Object oCancel_bn is a ButtonSub
36079>>>>>        Set Label to "&€¡ç¨à©ž"
36080>>>>>        Set Location to 113 241
36081>>>>>
36081>>>>>        //AB-StoreStart
36081>>>>>        Procedure OnClick
36083>>>>>            Send Cancel To (oSelList(current_object))
36084>>>>>        End_Procedure
36085>>>>>        //AB-StoreEnd
36085>>>>>
36085>>>>>    End_Object    // oCancel_bn
36086>>>>>
36086>>>>>    Object oSearch_bn is a ButtonSub
36088>>>>>        Set Label to "€&¤˜ã«ž©ž"
36089>>>>>        Set Location to 113 296
36090>>>>>
36090>>>>>        //AB-StoreStart
36090>>>>>        Procedure OnClick
36092>>>>>            Send Search To (oSelList(current_object))
36093>>>>>        End_Procedure
36094>>>>>        //AB-StoreEnd
36094>>>>>
36094>>>>>    End_Object    // oSearch_bn
36095>>>>>
36095>>>>>
36095>>>>>    //AB-StoreStart
36095>>>>>                            
36095>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
36096>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
36097>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
36098>>>>>    
36098>>>>>    
36098>>>>>    
36098>>>>>    
36098>>>>>    
36098>>>>>    
36098>>>>>    //AB-StoreEnd
36098>>>>>
36098>>>>>End_Object    // Wax
36099>>>>>
36099>>>>>//AB/ End_Object    // prj
36099>>>    use sl17.sl
INCLUDING FILE: SL17.SL
36099>>>>>//AB/ Project SL17:witemx
36099>>>>>//AB/     Object prj is a Lookup_Project
36099>>>>>//AB/         Set ProjectName to "SL17:witemx"
36099>>>>>//AB/         Set ProjectFileName to "sl17.SL"
36099>>>>>
36099>>>>>// Project Object Structure
36099>>>>>//   SL17 is a dbModalPanelSub
36099>>>>>//     Units_DD is a DataDictionary
36099>>>>>//     Witemkat_DD is a DataDictionary
36099>>>>>//     Fpa_DD is a DataDictionary
36099>>>>>//     Item_DD is a DataDictionary
36099>>>>>//     Witemx_DD is a DataDictionary
36099>>>>>//     oSelList is a dbListSub
36099>>>>>//     TextBoxSub1 is a TextBoxSub
36099>>>>>//     ocode is a FormSub
36099>>>>>//     TextBoxSub2 is a TextBoxSub
36099>>>>>//     operi is a FormSub
36099>>>>>//     RadioGroupSub1 is a RadioGroupSub
36099>>>>>//       Radio1 is a RadioSub
36099>>>>>//       Radio2 is a RadioSub
36099>>>>>//     ButtonSub1 is a ButtonSub
36099>>>>>//     TextBoxSub3 is a TextBoxSub
36099>>>>>//     ocodekat is a FormSub
36099>>>>>//     oOK_bn is a ButtonSub
36099>>>>>//     oCancel_bn is a ButtonSub
36099>>>>>//     oSearch_bn is a ButtonSub
36099>>>>>//     btnwitemcl is a ButtonSub
36099>>>>>
36099>>>>>// Register all objects
36099>>>>>Register_Object ButtonSub1
36099>>>>>Register_Object btnwitemcl
36099>>>>>Register_Object Fpa_DD
36099>>>>>Register_Object Item_DD
36099>>>>>Register_Object oCancel_bn
36099>>>>>Register_Object ocode
36099>>>>>Register_Object ocodekat
36099>>>>>Register_Object oOK_bn
36099>>>>>Register_Object operi
36099>>>>>Register_Object oSearch_bn
36099>>>>>Register_Object oSelList
36099>>>>>Register_Object Radio1
36099>>>>>Register_Object Radio2
36099>>>>>Register_Object RadioGroupSub1
36099>>>>>Register_Object SL17
36099>>>>>Register_Object TextBoxSub1
36099>>>>>Register_Object TextBoxSub2
36099>>>>>Register_Object TextBoxSub3
36099>>>>>Register_Object Units_DD
36099>>>>>Register_Object Witemkat_DD
36099>>>>>Register_Object Witemx_DD
36099>>>>>
36099>>>>>
36099>>>>>
36099>>>>>    //AB-StoreTopStart
36099>>>>>    
36099>>>>>    use dg186.dg
INCLUDING FILE: DG186.DG
36099>>>>>>>//AB/ Project dg186
36099>>>>>>>//AB/     Object prj is a Dialog_Project
36099>>>>>>>//AB/         Set ProjectName to "dg186"
36099>>>>>>>//AB/         Set ProjectFileName to "dg186.DG"
36099>>>>>>>//AB/         Set GenerateFileName to "NONAME"
36099>>>>>>>
36099>>>>>>>// Project Object Structure
36099>>>>>>>//   dg186 is a dbModalPanelSub
36099>>>>>>>//     Witemkat_DD is a DataDictionary
36099>>>>>>>//     Units_DD is a DataDictionary
36099>>>>>>>//     Fpa_DD is a DataDictionary
36099>>>>>>>//     Item_DD is a DataDictionary
36099>>>>>>>//     Witemcl_DD is a DataDictionary
36099>>>>>>>//     The_Table is a dbGrid
36099>>>>>>>//     TextBoxSub1 is a TextBoxSub
36099>>>>>>>//     TextBoxSub2 is a TextBoxSub
36099>>>>>>>//     TextBoxSub3 is a TextBoxSub
36099>>>>>>>//     ocode is a FormSub
36099>>>>>>>//     operi is a FormSub
36099>>>>>>>//     ocodeprom is a FormSub
36099>>>>>>>//     RadioGroupSub1 is a RadioGroupSub
36099>>>>>>>//       Radio1 is a RadioSub
36099>>>>>>>//       Radio2 is a RadioSub
36099>>>>>>>//     ButtonSub1 is a ButtonSub
36099>>>>>>>//     btnwitemcl is a ButtonSub
36099>>>>>>>
36099>>>>>>>// Register all objects
36099>>>>>>>Register_Object ButtonSub1
36099>>>>>>>Register_Object btnwitemcl
36099>>>>>>>Register_Object dg186
36099>>>>>>>Register_Object Fpa_DD
36099>>>>>>>Register_Object Item_DD
36099>>>>>>>Register_Object ocode
36099>>>>>>>Register_Object ocodeprom
36099>>>>>>>Register_Object operi
36099>>>>>>>Register_Object Radio1
36099>>>>>>>Register_Object Radio2
36099>>>>>>>Register_Object RadioGroupSub1
36099>>>>>>>Register_Object TextBoxSub1
36099>>>>>>>Register_Object TextBoxSub2
36099>>>>>>>Register_Object TextBoxSub3
36099>>>>>>>Register_Object The_Table
36099>>>>>>>Register_Object Units_DD
36099>>>>>>>Register_Object Witemcl_DD
36099>>>>>>>Register_Object Witemkat_DD
36099>>>>>>>
36099>>>>>>>
36099>>>>>>>
36099>>>>>>>    //AB-StoreTopStart
36099>>>>>>>    open clients
INCLUDING FILE: CLIENTS.FD
36101>>>>>>>    use sl17.sl
36101>>>>>>>    //AB-StoreTopEnd
36101>>>>>>>
36101>>>>>>>    //AB-IgnoreStart
36101>>>>>>>
36101>>>>>>>    Use DFAllEnt.pkg
36101>>>>>>>    Use Txtbox.Sub
36101>>>>>>>    Use Form.Sub
36101>>>>>>>    Use Rgroup.Sub
36101>>>>>>>    Use Radio.Sub
36101>>>>>>>    Use Button.Sub
36101>>>>>>>
36101>>>>>>>
36101>>>>>>>    Use WITEMKAT.DD
INCLUDING FILE: WITEMKAT.DD
36101>>>>>>>>>//DDB-FileStart
36101>>>>>>>>>//DDB-HeaderStart
36101>>>>>>>>>
36101>>>>>>>>>// File Name : WITEMKAT.DD
36101>>>>>>>>>// Class Name: Witemkat_DataDictionary
36101>>>>>>>>>// Revision  : 25
36101>>>>>>>>>// Version   : 2
36101>>>>>>>>>
36101>>>>>>>>>Use  Windows           // Basic Definitions
36101>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
36101>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
36101>>>>>>>>>
36101>>>>>>>>>Open Witemkat
INCLUDING FILE: WITEMKAT.FD
36103>>>>>>>>>Open Item
INCLUDING FILE: ITEM.FD
36105>>>>>>>>>Open Sysrecw
36107>>>>>>>>>Open Syscurxr
36109>>>>>>>>>
36109>>>>>>>>>//DDB-HeaderEnd
36109>>>>>>>>>//DDB-SelectionStart
36109>>>>>>>>>//DDB/ ExternalSelectionList sl024  sl024.SL
36109>>>>>>>>>//DDB/ ExternalSelectionList sl150  sl150.SL
36109>>>>>>>>>Register_Object sl024
36109>>>>>>>>>Register_Object sl150
36109>>>>>>>>>//DDB-SelectionEnd
36109>>>>>>>>>
36109>>>>>>>>>Class Witemkat_DataDictionary  is a DataDictionary
36110>>>>>>>>>
36110>>>>>>>>>     Procedure Creating
36111>>>>>>>>>        Forward Send Creating
36113>>>>>>>>>        // Insert Code Here
36113>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(WitemKat.WitemKat_Rec0)))))) to WitemKat.WitemKat_Recr
36114>>>>>>>>>    End_Procedure   // Creating
36115>>>>>>>>>   
36115>>>>>>>>>    Function Validate_Save  Returns Integer
36116>>>>>>>>>        Local Integer iReturnVal icheck
36117>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
36119>>>>>>>>>        If (Not(iReturnVal)) Begin
36121>>>>>>>>>            // Insert Code Here
36121>>>>>>>>>//           if (witemkat.codegl <> '') begin
36121>>>>>>>>>//              Move (Check_log(witemkat.codegl)) to iCheck  
36121>>>>>>>>>//              if (icheck) Move 24001 to iReturnVal 
36121>>>>>>>>>//           end
36121>>>>>>>>>           If (iReturnVal) Send Operation_Not_Allowed iReturnVal
36124>>>>>>>>>        End
36124>>>>>>>>>>
36124>>>>>>>>>        Function_Return iReturnVal
36125>>>>>>>>>    End_Function   // Validate_Save
36126>>>>>>>>> 
36126>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
36127>>>>>>>>>        String lsError_Message
36128>>>>>>>>>        Case Begin
36128>>>>>>>>>            Case (iError_Num = 24001)
36130>>>>>>>>>                Move "DDC 24: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ¡˜«žš¦¨å˜ª œå›¦¬ª" to lsError_Message
36131>>>>>>>>>              Case Break
36132>>>>>>>>>            Case Else
36132>>>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
36134>>>>>>>>>        Case End
36134>>>>>>>>>        Error iError_Num lsError_Message
36135>>>>>>>>>>
36135>>>>>>>>>    End_Procedure // operation_not_allowed
36136>>>>>>>>>
36136>>>>>>>>>
36136>>>>>>>>>
36136>>>>>>>>>    // Define_Fields:
36136>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
36136>>>>>>>>>
36136>>>>>>>>>    Procedure Define_Fields
36137>>>>>>>>>        Forward Send Define_Fields
36139>>>>>>>>>        //DDB-Generated-Code-Location
36139>>>>>>>>>        //DDB-DefineFieldStart
36139>>>>>>>>>
36139>>>>>>>>>        Set Main_File            To Witemkat.File_Number
36140>>>>>>>>>        Set Cascade_Delete_State To FALSE
36141>>>>>>>>>
36141>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
36142>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
36143>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
36144>>>>>>>>>
36144>>>>>>>>>        // Child (Client) file structure................
36144>>>>>>>>>        Send Add_Client_File  Item.File_Number
36145>>>>>>>>>
36145>>>>>>>>>        // External (System) file structure.............
36145>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
36146>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
36147>>>>>>>>>
36147>>>>>>>>>        Define_Auto_Increment  Sysrecw.Witemkat_Rec0  To Witemkat.Witemkat_Rec0
36150>>>>>>>>>
36150>>>>>>>>>        // Field-based properties.......................
36150>>>>>>>>>
36150>>>>>>>>>        // Witemkat.Witemkat_Code
36150>>>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Code To DD_AUTOFIND   
36151>>>>>>>>>        Set Field_Prompt_Object    Field Witemkat.Witemkat_Code To (sl024(Self))
36152>>>>>>>>>
36152>>>>>>>>>        // Witemkat.Witemkat_Rec0
36152>>>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Rec0 To DD_AUTOFIND   
36153>>>>>>>>>
36153>>>>>>>>>        // Witemkat.Witemkat_Descr
36153>>>>>>>>>        Set Field_Prompt_Object    Field Witemkat.Witemkat_Descr To (sl024(Self))
36154>>>>>>>>>
36154>>>>>>>>>        // Witemkat.Witemkat_Recr
36154>>>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Recr To DD_AUTOFIND   
36155>>>>>>>>>
36155>>>>>>>>>        // Witemkat.Codeglpol
36155>>>>>>>>>        Set Field_Prompt_Object    Field Witemkat.Codeglpol To (sl150(Self))
36156>>>>>>>>>
36156>>>>>>>>>        // Witemkat.Codeglago
36156>>>>>>>>>
36156>>>>>>>>>        //DDB-DefineFieldEnd
36156>>>>>>>>>    End_Procedure    // Define_Fields
36157>>>>>>>>>
36157>>>>>>>>>    // Field_Defaults:
36157>>>>>>>>>    // This procedure is used to establish default field values.
36157>>>>>>>>>
36157>>>>>>>>>    Procedure Field_Defaults
36158>>>>>>>>>        Forward Send Field_Defaults
36160>>>>>>>>>        //DDB-Generated-Code-Location
36160>>>>>>>>>        //DDB-FieldDefaultStart
36160>>>>>>>>>        //DDB-FieldDefaultEnd
36160>>>>>>>>>    End_Procedure    // Field_Defaults
36161>>>>>>>>>
36161>>>>>>>>>End_Class    // Witemkat_DataDictionary
36162>>>>>>>>>//DDB-Selection-pkg-Start
36162>>>>>>>>>
36162>>>>>>>>>Use sl024.SL         // sl024
INCLUDING FILE: SL024.SL
36162>>>>>>>>>>>//AB/ Project sl024:kathgories eidon
36162>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
36162>>>>>>>>>>>//AB/     Set ProjectName to "sl024:kathgories eidon"
36162>>>>>>>>>>>//AB/     Set ProjectFileName to "sl024.SL"
36162>>>>>>>>>>>
36162>>>>>>>>>>>// Project Object Structure
36162>>>>>>>>>>>//   sl024 is a dbModalPanelSub
36162>>>>>>>>>>>//     Witemkat_DD is a DataDictionary
36162>>>>>>>>>>>//     oSelList is a dbListSub
36162>>>>>>>>>>>//     oOK_bn is a ButtonSub
36162>>>>>>>>>>>//     oCancel_bn is a ButtonSub
36162>>>>>>>>>>>//     oSearch_bn is a ButtonSub
36162>>>>>>>>>>>
36162>>>>>>>>>>>// Register all objects
36162>>>>>>>>>>>Register_Object oCancel_bn
36162>>>>>>>>>>>Register_Object oOK_bn
36162>>>>>>>>>>>Register_Object oSearch_bn
36162>>>>>>>>>>>Register_Object oSelList
36162>>>>>>>>>>>Register_Object sl024
36162>>>>>>>>>>>Register_Object Witemkat_DD
36162>>>>>>>>>>>
36162>>>>>>>>>>>
36162>>>>>>>>>>>//AB-IgnoreStart
36162>>>>>>>>>>>
36162>>>>>>>>>>>Use DFAllEnt.pkg
36162>>>>>>>>>>>Use dbList.Sub
36162>>>>>>>>>>>Use Button.Sub
36162>>>>>>>>>>>
36162>>>>>>>>>>>
36162>>>>>>>>>>>Use WITEMKAT.DD
36162>>>>>>>>>>>
36162>>>>>>>>>>>//AB-IgnoreEnd
36162>>>>>>>>>>>
36162>>>>>>>>>>>Object sl024 is a dbModalPanelSub
36164>>>>>>>>>>>    Set Label to "‰˜«žš¦¨åœª „ ›é¤"
36165>>>>>>>>>>>    Set Size to 217 375
36166>>>>>>>>>>>    Set Location to 4 5
36167>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
36168>>>>>>>>>>>    Set Modal_State to FALSE
36169>>>>>>>>>>>
36169>>>>>>>>>>>    //AB-DDOStart
36169>>>>>>>>>>>
36169>>>>>>>>>>>    Object Witemkat_DD is a Witemkat_DataDictionary
36171>>>>>>>>>>>    End_Object    // Witemkat_DD
36172>>>>>>>>>>>
36172>>>>>>>>>>>    Set Main_DD to (Witemkat_DD(self))
36173>>>>>>>>>>>    Set Server to (Witemkat_DD(self))
36174>>>>>>>>>>>
36174>>>>>>>>>>>    //AB-DDOEnd
36174>>>>>>>>>>>
36174>>>>>>>>>>>    Object oSelList is a dbListSub
36176>>>>>>>>>>>        Set Main_File to Witemkat.File_Number
36177>>>>>>>>>>>        Set Size to 175 357
36178>>>>>>>>>>>        Set Location to 6 6
36179>>>>>>>>>>>
36179>>>>>>>>>>>        Begin_Row
36182>>>>>>>>>>>            Entry_Item Witemkat.Witemkat_code
36183>>>>>>>>>>>            Entry_Item Witemkat.Witemkat_descr
36184>>>>>>>>>>>        End_Row
36189>>>>>>>>>>>
36189>>>>>>>>>>>        Set Form_Width    item 0 to 124
36190>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
36191>>>>>>>>>>>        
36191>>>>>>>>>>>        Set Form_Width    item 1 to 223
36192>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
36193>>>>>>>>>>>        
36193>>>>>>>>>>>    End_Object    // oSelList
36194>>>>>>>>>>>
36194>>>>>>>>>>>    Object oOK_bn is a ButtonSub
36196>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
36197>>>>>>>>>>>        Set Location to 186 210
36198>>>>>>>>>>>
36198>>>>>>>>>>>        //AB-StoreStart
36198>>>>>>>>>>>        Procedure OnClick
36200>>>>>>>>>>>            Send OK To (oSelList(current_object))
36201>>>>>>>>>>>        End_Procedure
36202>>>>>>>>>>>        //AB-StoreEnd
36202>>>>>>>>>>>
36202>>>>>>>>>>>    End_Object    // oOK_bn
36203>>>>>>>>>>>
36203>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
36205>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
36206>>>>>>>>>>>        Set Location to 186 265
36207>>>>>>>>>>>
36207>>>>>>>>>>>        //AB-StoreStart
36207>>>>>>>>>>>        Procedure OnClick
36209>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
36210>>>>>>>>>>>        End_Procedure
36211>>>>>>>>>>>        //AB-StoreEnd
36211>>>>>>>>>>>
36211>>>>>>>>>>>    End_Object    // oCancel_bn
36212>>>>>>>>>>>
36212>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
36214>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
36215>>>>>>>>>>>        Set Location to 186 320
36216>>>>>>>>>>>
36216>>>>>>>>>>>        //AB-StoreStart
36216>>>>>>>>>>>        Procedure OnClick
36218>>>>>>>>>>>            Send Search To (oSelList(current_object))
36219>>>>>>>>>>>        End_Procedure
36220>>>>>>>>>>>        //AB-StoreEnd
36220>>>>>>>>>>>
36220>>>>>>>>>>>    End_Object    // oSearch_bn
36221>>>>>>>>>>>
36221>>>>>>>>>>>
36221>>>>>>>>>>>    //AB-StoreStart
36221>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
36222>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
36223>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
36224>>>>>>>>>>>    //AB-StoreEnd
36224>>>>>>>>>>>
36224>>>>>>>>>>>End_Object    // sl024
36225>>>>>>>>>>>
36225>>>>>>>>>>>//AB/ End_Object    // prj
36225>>>>>>>>>Use sl150.SL         // sl150
INCLUDING FILE: SL150.SL
36225>>>>>>>>>>>//AB/ Project sl150:GL Gplan
36225>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
36225>>>>>>>>>>>//AB/     Set ProjectName to "sl150:GL Gplan"
36225>>>>>>>>>>>//AB/     Set ProjectFileName to "sl150.SL"
36225>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
36225>>>>>>>>>>>
36225>>>>>>>>>>>// Project Object Structure
36225>>>>>>>>>>>//   sl150 is a dbModalPanel
36225>>>>>>>>>>>//     Gplan_DD is a DataDictionary
36225>>>>>>>>>>>//     oSelList is a dbList
36225>>>>>>>>>>>//     oOK_bn is a Button
36225>>>>>>>>>>>//     oCancel_bn is a Button
36225>>>>>>>>>>>//     oSearch_bn is a Button
36225>>>>>>>>>>>
36225>>>>>>>>>>>// Register all objects
36225>>>>>>>>>>>Register_Object Gplan_DD
36225>>>>>>>>>>>Register_Object oCancel_bn
36225>>>>>>>>>>>Register_Object oOK_bn
36225>>>>>>>>>>>Register_Object oSearch_bn
36225>>>>>>>>>>>Register_Object oSelList
36225>>>>>>>>>>>Register_Object sl150
36225>>>>>>>>>>>
36225>>>>>>>>>>>
36225>>>>>>>>>>>//AB-IgnoreStart
36225>>>>>>>>>>>
36225>>>>>>>>>>>Use DFAllEnt.pkg
36225>>>>>>>>>>>
36225>>>>>>>>>>>
36225>>>>>>>>>>>Use GPLAN.DD
INCLUDING FILE: GPLAN.DD
36225>>>>>>>>>>>>>//DDB-FileStart
36225>>>>>>>>>>>>>//DDB-HeaderStart
36225>>>>>>>>>>>>>
36225>>>>>>>>>>>>>// File Name : GPLAN.DD
36225>>>>>>>>>>>>>// Class Name: Gplan_DataDictionary
36225>>>>>>>>>>>>>// Revision  : 125
36225>>>>>>>>>>>>>// Version   : 2
36225>>>>>>>>>>>>>
36225>>>>>>>>>>>>>Use  Windows           // Basic Definitions
36225>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
36225>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
36225>>>>>>>>>>>>>
36225>>>>>>>>>>>>>Open Gplan
INCLUDING FILE: GPLAN.FD
36227>>>>>>>>>>>>>Open Gmovea
INCLUDING FILE: GMOVEA.FD
36229>>>>>>>>>>>>>Open Gplanmod
INCLUDING FILE: GPLANMOD.FD
36231>>>>>>>>>>>>>Open Gmhnes
INCLUDING FILE: GMHNES.FD
36233>>>>>>>>>>>>>Open Gmove
INCLUDING FILE: GMOVE.FD
36235>>>>>>>>>>>>>Open Gvatd
INCLUDING FILE: GVATD.FD
36237>>>>>>>>>>>>>Open Gpmoves
INCLUDING FILE: GPMOVES.FD
36239>>>>>>>>>>>>>Open Sysrecg
36241>>>>>>>>>>>>>Open Syscurgl
INCLUDING FILE: SYSCURGL.FD
36243>>>>>>>>>>>>>
36243>>>>>>>>>>>>>//DDB-HeaderEnd
36243>>>>>>>>>>>>>//DDB-ValidationStart
36243>>>>>>>>>>>>>
36243>>>>>>>>>>>>>Register_Object Gplan_Gplan_O_Code_VT
36243>>>>>>>>>>>>>Register_Object Gplan_Gplan_Yn_VT
36243>>>>>>>>>>>>>Register_Object Gplan_Gplan_Xpm_VT
36243>>>>>>>>>>>>>Register_Object Gplan_Gplan_Doy_VT
36243>>>>>>>>>>>>>Register_Object Gplan_Gplan_J_Code_VT
36243>>>>>>>>>>>>>Register_Object Gplan_Gplan_C_Code2_VT
36243>>>>>>>>>>>>>Register_Object Gplan_Gplan_I_A_Code_VT2
36243>>>>>>>>>>>>>Register_Object Gplan_Gplan_Myf_Sum_VT
36243>>>>>>>>>>>>>
36243>>>>>>>>>>>>>Object Gplan_Gplan_O_Code_VT  is a CodeValidationTable
36245>>>>>>>>>>>>>    Set Type_Value        To "OMADA"
36246>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
36247>>>>>>>>>>>>>    //DDB-ValidationCustomStart
36247>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
36247>>>>>>>>>>>>>End_Object   // Gplan_Gplan_O_Code_VT
36248>>>>>>>>>>>>>
36248>>>>>>>>>>>>>Object Gplan_Gplan_Yn_VT  is a CodeValidationTable
36250>>>>>>>>>>>>>    Set Type_Value        To "YESNO"
36251>>>>>>>>>>>>>    //DDB-ValidationCustomStart
36251>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
36251>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Yn_VT
36252>>>>>>>>>>>>>
36252>>>>>>>>>>>>>Object Gplan_Gplan_Xpm_VT  is a DescriptionValidationTable
36254>>>>>>>>>>>>>
36254>>>>>>>>>>>>>    Procedure Fill_List
36256>>>>>>>>>>>>>        Forward Send Fill_List
36258>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "•¨œ¦ç£œ¤¦ª"
36259>>>>>>>>>>>>>        Send Add_Table_Value  "2"  " ©«¦ç£œ¤¦ª"
36260>>>>>>>>>>>>>        Send Add_Table_Value  "3"  "‹ ¡«æª"
36261>>>>>>>>>>>>>    End_Procedure    // Fill_List
36262>>>>>>>>>>>>>    //DDB-ValidationCustomStart
36262>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
36262>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Xpm_VT
36263>>>>>>>>>>>>>
36263>>>>>>>>>>>>>Object Gplan_Gplan_Doy_VT  is a CodeValidationTable
36265>>>>>>>>>>>>>    Set Type_Value        To "DOY"
36266>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
36267>>>>>>>>>>>>>    //DDB-ValidationCustomStart
36267>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
36267>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Doy_VT
36268>>>>>>>>>>>>>
36268>>>>>>>>>>>>>Object Gplan_Gplan_J_Code_VT  is a CodeValidationTable
36270>>>>>>>>>>>>>    Set Type_Value        To "JOB"
36271>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
36272>>>>>>>>>>>>>    //DDB-ValidationCustomStart
36272>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
36272>>>>>>>>>>>>>End_Object   // Gplan_Gplan_J_Code_VT
36273>>>>>>>>>>>>>
36273>>>>>>>>>>>>>Object Gplan_Gplan_C_Code2_VT  is a CodeValidationTable
36275>>>>>>>>>>>>>    Set Type_Value        To "CURRENCY"
36276>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
36277>>>>>>>>>>>>>    //DDB-ValidationCustomStart
36277>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
36277>>>>>>>>>>>>>End_Object   // Gplan_Gplan_C_Code2_VT
36278>>>>>>>>>>>>>
36278>>>>>>>>>>>>>Object Gplan_Gplan_I_A_Code_VT2  is a CodeValidationTable
36280>>>>>>>>>>>>>    Set Type_Value        To "AITIOL"
36281>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
36282>>>>>>>>>>>>>    //DDB-ValidationCustomStart
36282>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
36282>>>>>>>>>>>>>End_Object   // Gplan_Gplan_I_A_Code_VT2
36283>>>>>>>>>>>>>
36283>>>>>>>>>>>>>Object Gplan_Gplan_Myf_Sum_VT  is a CodeValidationTable
36285>>>>>>>>>>>>>    Set Type_Value        To "MYF"
36286>>>>>>>>>>>>>    //DDB-ValidationCustomStart
36286>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
36286>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Myf_Sum_VT
36287>>>>>>>>>>>>>//DDB-ValidationEnd
36287>>>>>>>>>>>>>//DDB-SelectionStart
36287>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl150  sl150.sl
36287>>>>>>>>>>>>>//DDB/ ExternalSelectionList Gtypkin  Gtypkin.sl
36287>>>>>>>>>>>>>Register_Object sl150
36287>>>>>>>>>>>>>Register_Object Gtypkin
36287>>>>>>>>>>>>>//DDB-SelectionEnd
36287>>>>>>>>>>>>>Use arrays.Sub
36287>>>>>>>>>>>>>
36287>>>>>>>>>>>>>Use Gmovea.dd //®¨œ áœ«˜  ¦§à›ã§¦«œ, › æ«  œå¤˜  alias file ¡˜ 
INCLUDING FILE: GMOVEA.DD
36287>>>>>>>>>>>>>>>//DDB-FileStart
36287>>>>>>>>>>>>>>>//DDB-HeaderStart
36287>>>>>>>>>>>>>>>
36287>>>>>>>>>>>>>>>// File Name : GMOVEA.DD
36287>>>>>>>>>>>>>>>// Class Name: Gmovea_DataDictionary
36287>>>>>>>>>>>>>>>// Revision  : 17
36287>>>>>>>>>>>>>>>// Version   : 2
36287>>>>>>>>>>>>>>>
36287>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
36287>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
36287>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
36287>>>>>>>>>>>>>>>
36287>>>>>>>>>>>>>>>Open Gmovea
36289>>>>>>>>>>>>>>>Open Gopen
INCLUDING FILE: GOPEN.FD
36291>>>>>>>>>>>>>>>Open Garticl
INCLUDING FILE: GARTICL.FD
36293>>>>>>>>>>>>>>>Open Gplan
36295>>>>>>>>>>>>>>>
36295>>>>>>>>>>>>>>>//DDB-HeaderEnd
36295>>>>>>>>>>>>>>>
36295>>>>>>>>>>>>>>>//open master file
36295>>>>>>>>>>>>>>>Open Gmove
36297>>>>>>>>>>>>>>>
36297>>>>>>>>>>>>>>>//define alias-master condition
36297>>>>>>>>>>>>>>>Set_Attribute DF_FILE_ALIAS of Gmovea.File_Number to DF_FILE_IS_ALIAS
36300>>>>>>>>>>>>>>>Set_Attribute DF_FILE_ALIAS of Gmove.File_Number  to DF_FILE_IS_MASTER
36303>>>>>>>>>>>>>>>
36303>>>>>>>>>>>>>>>//clear all relationships from the alias file
36303>>>>>>>>>>>>>>>Set_Relate Gmovea.Garticl_Recr to |FN0,0
36304>>>>>>>>>>>>>>>>
36304>>>>>>>>>>>>>>>Set_Relate Gmovea.Gplan_Recr   to |FN0,0
36305>>>>>>>>>>>>>>>>
36305>>>>>>>>>>>>>>>
36305>>>>>>>>>>>>>>>
36305>>>>>>>>>>>>>>>Class Gmovea_DataDictionary  is a DataDictionary_Sec
36306>>>>>>>>>>>>>>>
36306>>>>>>>>>>>>>>>
36306>>>>>>>>>>>>>>>      //private
36306>>>>>>>>>>>>>>>      //œ¤ž£œ¨é¤œ  «˜ 13 §œ›å˜ open item
36306>>>>>>>>>>>>>>>      //¡˜¢œå«˜  ˜§æ update
36306>>>>>>>>>>>>>>>      Procedure private.Do_Compute_Open_Itemsa
36307>>>>>>>>>>>>>>>                Case Begin
36307>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_X0 > 0) //˜«æ­ ¦ ®¨œà©« ¡æ record
36309>>>>>>>>>>>>>>>                          Move "+"                                                 to Gmovea.Gmove_Topen
36310>>>>>>>>>>>>>>>                          Move (     Gmovea.Gmove_X0  - Gmovea.Gmove_Open_Sx0) to Gmovea.Gmove_Open_Yx0
36311>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yp0
36312>>>>>>>>>>>>>>>                     Case Break
36313>>>>>>>>>>>>>>>
36313>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_X0 < 0) //¯œ¬«¦- ®¨œà©« ¡æ record
36316>>>>>>>>>>>>>>>                          Move "-"                                                 to Gmovea.Gmove_Topen
36317>>>>>>>>>>>>>>>                          Move ((Abs(Gmovea.Gmove_X0))- Gmovea.Gmove_Open_Sp0) to Gmovea.Gmove_Open_Yp0
36318>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yx0
36319>>>>>>>>>>>>>>>                     Case Break
36320>>>>>>>>>>>>>>>
36320>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_P0 > 0) //˜«æ­ ¦ § ©«à« ¡æ record
36323>>>>>>>>>>>>>>>                          Move "-"                                                 to Gmovea.Gmove_Topen
36324>>>>>>>>>>>>>>>                          Move (     Gmovea.Gmove_P0  - Gmovea.Gmove_Open_Sp0) to Gmovea.Gmove_Open_Yp0
36325>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yx0
36326>>>>>>>>>>>>>>>                     Case Break
36327>>>>>>>>>>>>>>>
36327>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_P0 < 0) //¯œç«¦- ®¨œà©« ¡æ record
36330>>>>>>>>>>>>>>>                          Move "+"                                                 to Gmovea.Gmove_Topen
36331>>>>>>>>>>>>>>>                          Move ((Abs(Gmovea.Gmove_P0))- Gmovea.Gmove_Open_Sx0) to Gmovea.Gmove_Open_Yx0
36332>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yp0
36333>>>>>>>>>>>>>>>                     Case Break
36334>>>>>>>>>>>>>>>                Case End
36334>>>>>>>>>>>>>>>      End_Procedure //private.do_compute_open_itemsa
36335>>>>>>>>>>>>>>>
36335>>>>>>>>>>>>>>>
36335>>>>>>>>>>>>>>>
36335>>>>>>>>>>>>>>>      //private
36335>>>>>>>>>>>>>>>      //œ¢âš®œ  «˜ 13 §œ›å˜ open item
36335>>>>>>>>>>>>>>>      //¡˜¢œå«˜  ˜§æ validate save
36335>>>>>>>>>>>>>>>      Function  private.fi_Validate_Open_Itemsa Returns Integer
36336>>>>>>>>>>>>>>>
36336>>>>>>>>>>>>>>>                 //1101+1102+1103+1104:â¢œš®¦  £ã ˜¨¤ž« ¡é¤ ¬§¦¢¦å§à¤ §¨¦ª ©¬©®â« ©ž ¡˜  ©¬©®œ« ©Ÿâ¤«à¤ §¦©é¤
36336>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 >= 0                       )) Function_Return 1101
36339>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 >= 0                       )) Function_Return 1102
36342>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 >= 0                       )) Function_Return 1103
36345>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 >= 0                       )) Function_Return 1104
36348>>>>>>>>>>>>>>>
36348>>>>>>>>>>>>>>>                 Case Begin
36348>>>>>>>>>>>>>>>                      //1105+1106+1107+1108:â¢œš®¦  š ˜ ˜«æ­ ¦ ®¨œà©« ¡æ record
36348>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_X0 > 0)
36350>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 <=      Gmovea.Gmove_X0  )) Function_Return 1105
36353>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 <=      Gmovea.Gmove_X0  )) Function_Return 1106
36356>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0  = 0                       )) Function_Return 1107
36359>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0  = 0                       )) Function_Return 1108
36362>>>>>>>>>>>>>>>                      Case Break
36363>>>>>>>>>>>>>>>                      //1109+1110+1111+1112:â¢œš®¦  š ˜ ¯œ¬«¦- ®¨œà©« ¡æ record
36363>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_X0 < 0)
36366>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0  = 0                       )) Function_Return 1109
36369>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0  = 0                       )) Function_Return 1110
36372>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 <= (Abs(Gmovea.Gmove_X0)))) Function_Return 1111
36375>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 <= (Abs(Gmovea.Gmove_X0)))) Function_Return 1112
36378>>>>>>>>>>>>>>>                      Case Break
36379>>>>>>>>>>>>>>>                      //1113+1114+1115+1116:â¢œš®¦  š ˜ ˜«æ­ ¦ § ©«à« ¡æ record
36379>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_P0 > 0)
36382>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0  = 0                       )) Function_Return 1113
36385>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0  = 0                       )) Function_Return 1114
36388>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 <=      Gmovea.Gmove_P0  )) Function_Return 1115
36391>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 <=      Gmovea.Gmove_P0  )) Function_Return 1116
36394>>>>>>>>>>>>>>>                      Case Break
36395>>>>>>>>>>>>>>>                      //1117+1118+1119+1120:â¢œš®¦  š ˜ ¯œç«¦- ®¨œà©« ¡æ record
36395>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_P0 < 0)
36398>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 <= (Abs(Gmovea.Gmove_P0)))) Function_Return 1117
36401>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 <= (Abs(Gmovea.Gmove_P0)))) Function_Return 1118
36404>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0  = 0                       )) Function_Return 1119
36407>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0  = 0                       )) Function_Return 1120
36410>>>>>>>>>>>>>>>                      Case Break
36411>>>>>>>>>>>>>>>                 Case End
36411>>>>>>>>>>>>>>>
36411>>>>>>>>>>>>>>>                 Function_Return 0 //æ¢˜ ok
36412>>>>>>>>>>>>>>>      End_Function //private.fi_validate_open_itemsa
36413>>>>>>>>>>>>>>>
36413>>>>>>>>>>>>>>>    Procedure Update
36414>>>>>>>>>>>>>>>          Send private.Do_Compute_Open_Itemsa
36415>>>>>>>>>>>>>>>    End_Procedure //update
36416>>>>>>>>>>>>>>>
36416>>>>>>>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
36417>>>>>>>>>>>>>>>              String lsError_Message
36418>>>>>>>>>>>>>>>              Case Begin
36418>>>>>>>>>>>>>>>                   //˜§æ validate save
36418>>>>>>>>>>>>>>>                   Case (iError_Num = 1101)
36420>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ œå¤˜  ˜¨¤ž« ¡æ !");                        to lsError_Message
36421>>>>>>>>>>>>>>>                   Case Break
36422>>>>>>>>>>>>>>>                   Case (iError_Num = 1102)
36425>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ œå¤˜  ˜¨¤ž« ¡æ !");                        to lsError_Message
36426>>>>>>>>>>>>>>>                   Case Break
36427>>>>>>>>>>>>>>>                   Case (iError_Num = 1103)
36430>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª œå¤˜  ˜¨¤ž« ¡ã !");                        to lsError_Message
36431>>>>>>>>>>>>>>>                   Case Break
36432>>>>>>>>>>>>>>>                   Case (iError_Num = 1104)
36435>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª œå¤˜  ˜¨¤ž« ¡ã !");                        to lsError_Message
36436>>>>>>>>>>>>>>>                   Case Break
36437>>>>>>>>>>>>>>>                   //---------------------------------------Ÿœ« ¡âª ®¨œé©œ ª-----------------
36437>>>>>>>>>>>>>>>                   Case (iError_Num = 1105)
36440>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã ®¨âà©ž !");                        to lsError_Message
36441>>>>>>>>>>>>>>>                   Case Break
36442>>>>>>>>>>>>>>>                   Case (iError_Num = 1106)
36445>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã ®¨âà©ž !");                        to lsError_Message
36446>>>>>>>>>>>>>>>                   Case Break
36447>>>>>>>>>>>>>>>                   Case (iError_Num = 1107)
36450>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ !");                        to lsError_Message
36451>>>>>>>>>>>>>>>                   Case Break
36452>>>>>>>>>>>>>>>                   Case (iError_Num = 1108)
36455>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
36456>>>>>>>>>>>>>>>                   Case Break
36457>>>>>>>>>>>>>>>                   //---------------------------------------˜¨¤ž« ¡âª ®¨œé©œ ª---------------
36457>>>>>>>>>>>>>>>                   Case (iError_Num = 1109)
36460>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ!");                        to lsError_Message
36461>>>>>>>>>>>>>>>                   Case Break
36462>>>>>>>>>>>>>>>                   Case (iError_Num = 1110)
36465>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
36466>>>>>>>>>>>>>>>                   Case Break
36467>>>>>>>>>>>>>>>                   Case (iError_Num = 1111)
36470>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª ®¨âà©žª !");                        to lsError_Message
36471>>>>>>>>>>>>>>>                   Case Break
36472>>>>>>>>>>>>>>>                   Case (iError_Num = 1112)
36475>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª ®¨âà©žª !");                        to lsError_Message
36476>>>>>>>>>>>>>>>                   Case Break
36477>>>>>>>>>>>>>>>                   //---------------------------------------Ÿœ« ¡âª § ©«é©œ ª----------------
36477>>>>>>>>>>>>>>>                   Case (iError_Num = 1113)
36480>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ !");                        to lsError_Message
36481>>>>>>>>>>>>>>>                   Case Break
36482>>>>>>>>>>>>>>>                   Case (iError_Num = 1114)
36485>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
36486>>>>>>>>>>>>>>>                   Case Break
36487>>>>>>>>>>>>>>>                   Case (iError_Num = 1115)
36490>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã §å©«à©ž !");                        to lsError_Message
36491>>>>>>>>>>>>>>>                   Case Break
36492>>>>>>>>>>>>>>>                   Case (iError_Num = 1116)
36495>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã §å©«à©ž !");                        to lsError_Message
36496>>>>>>>>>>>>>>>                   Case Break
36497>>>>>>>>>>>>>>>                   //---------------------------------------˜¨àž« ¡âª § ©«é©œ ª----------------
36497>>>>>>>>>>>>>>>                   Case (iError_Num = 1117)
36500>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ!");                        to lsError_Message
36501>>>>>>>>>>>>>>>                   Case Break
36502>>>>>>>>>>>>>>>                   Case (iError_Num = 1118)
36505>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
36506>>>>>>>>>>>>>>>                   Case Break
36507>>>>>>>>>>>>>>>                   Case (iError_Num = 1119)
36510>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª §å©«à©žª !");                        to lsError_Message
36511>>>>>>>>>>>>>>>                   Case Break
36512>>>>>>>>>>>>>>>                   Case (iError_Num = 1120) //soso ayto den xoraei display stin othoni !
36515>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª §å©«à©žª !");                        to lsError_Message
36516>>>>>>>>>>>>>>>                   Case Break
36517>>>>>>>>>>>>>>>
36517>>>>>>>>>>>>>>>
36517>>>>>>>>>>>>>>>                   //˜§æ validate delete
36517>>>>>>>>>>>>>>>                   Case (iError_Num = 2001)
36520>>>>>>>>>>>>>>>                        Move ("DDC 067:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n˜¨˜¡˜¢é ¡˜¢â©˜«œ «ž¤ Solution !");                        to lsError_Message
36521>>>>>>>>>>>>>>>                   Case Break
36522>>>>>>>>>>>>>>>
36522>>>>>>>>>>>>>>>                   Case Else
36522>>>>>>>>>>>>>>>                        Forward Send Operation_Not_Allowed iError_Num
36524>>>>>>>>>>>>>>>              Case End
36524>>>>>>>>>>>>>>>
36524>>>>>>>>>>>>>>>              Error iError_Num lsError_Message
36525>>>>>>>>>>>>>>>>
36525>>>>>>>>>>>>>>>    End_Procedure   //operation_not_allowed
36526>>>>>>>>>>>>>>>
36526>>>>>>>>>>>>>>>
36526>>>>>>>>>>>>>>>    Function Validate_Save Returns Integer
36527>>>>>>>>>>>>>>>             Integer iReturnVal liOpen_Itemsa
36528>>>>>>>>>>>>>>>             Forward Get Validate_Save to iReturnVal
36530>>>>>>>>>>>>>>>
36530>>>>>>>>>>>>>>>             If (Not(iReturnVal));             Begin
36532>>>>>>>>>>>>>>>             //1101-1120:â¢œš®¦  open item
36532>>>>>>>>>>>>>>>              Move (private.fi_Validate_Open_Itemsa(Self)) to liOpen_Itemsa
36533>>>>>>>>>>>>>>>              If (liOpen_Itemsa <> 0) Send Operation_Not_Allowed liOpen_Itemsa
36536>>>>>>>>>>>>>>>             End //«â¢¦ª ¡é› ¡˜ validation
36536>>>>>>>>>>>>>>>>
36536>>>>>>>>>>>>>>>
36536>>>>>>>>>>>>>>>
36536>>>>>>>>>>>>>>>             Function_Return iReturnVal
36537>>>>>>>>>>>>>>>    End_Function //validate_save
36538>>>>>>>>>>>>>>>
36538>>>>>>>>>>>>>>>
36538>>>>>>>>>>>>>>>    //2001:«¦ alias Gmovea ›â¤ œ§ «¨â§œ  ‰ € ‹ ˆ €   › ˜š¨˜­ã
36538>>>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
36539>>>>>>>>>>>>>>>             Send Operation_Not_Allowed 2001 //¢áŸ¦ª «¦¬ ¡é› ¡˜ !!!
36540>>>>>>>>>>>>>>>    End_Function //validate_delete
36541>>>>>>>>>>>>>>>
36541>>>>>>>>>>>>>>>
36541>>>>>>>>>>>>>>>    // Define_Fields:
36541>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
36541>>>>>>>>>>>>>>>
36541>>>>>>>>>>>>>>>    Procedure Define_Fields
36542>>>>>>>>>>>>>>>        Forward Send Define_Fields
36544>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
36544>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
36544>>>>>>>>>>>>>>>
36544>>>>>>>>>>>>>>>        Set Main_File            To Gmovea.File_Number
36545>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
36546>>>>>>>>>>>>>>>
36546>>>>>>>>>>>>>>>
36546>>>>>>>>>>>>>>>        // Child (Client) file structure................
36546>>>>>>>>>>>>>>>        Send Add_Client_File  Gopen.File_Number
36547>>>>>>>>>>>>>>>
36547>>>>>>>>>>>>>>>        // Parent (Server) file structure...............
36547>>>>>>>>>>>>>>>        Send Add_Server_File  Garticl.File_Number
36548>>>>>>>>>>>>>>>        Send Add_Server_File  Gplan.File_Number
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Field-based properties.......................
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Company_Code
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Branch_Code
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Year_Year
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Code
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Garticl_Hmnia
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Garticl_No
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Garticl_Recr
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gplan_Recr
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_Rec0
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gplan_Code
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_Aitiol
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_X0
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_P0
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_X0k
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_P0k
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_X00
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_P00
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_X00k
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_P00k
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_X1
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_P1
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_X2
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_P2
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_X2k
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_P2k
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_Xr
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_Pr
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_Xrk
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_Prk
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_Dlixis
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_A_Code
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gthhmgio_Code
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_Aa
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx0
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp0
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx0
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp0
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx1
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp1
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx1
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp1
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx2
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp2
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx2
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp2
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_Sc_Code2
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_Aopen
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_Topen
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_Kk
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gthhmgio_Period
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gplan_Yn_Myfp
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gplan_Yn_Myfa
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gplan_Myf_Sump
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gplan_Myf_Suma
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag01
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag02
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag03
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag04
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag05
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag06
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag07
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag08
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag09
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag10
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag11
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag12
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag13
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag14
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag15
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag16
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag17
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag18
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag19
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag20
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Year_Recr
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        // Gmovea.Gmove_Recr
36549>>>>>>>>>>>>>>>
36549>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
36549>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
36550>>>>>>>>>>>>>>>
36550>>>>>>>>>>>>>>>    // Field_Defaults:
36550>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
36550>>>>>>>>>>>>>>>
36550>>>>>>>>>>>>>>>    Procedure Field_Defaults
36551>>>>>>>>>>>>>>>        Forward Send Field_Defaults
36553>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
36553>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
36553>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
36553>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
36554>>>>>>>>>>>>>>>End_Class    // Gmovea_DataDictionary
36555>>>>>>>>>>>>>>>//DDB-FileEnd
36555>>>>>>>>>>>>>              //©«ž¤ begin_transaction §¨¦¡˜¢œå deadlock
36555>>>>>>>>>>>>>
36555>>>>>>>>>>>>>Class Gplan_DataDictionary  is a DataDictionary_Sec
36556>>>>>>>>>>>>>
36556>>>>>>>>>>>>>    Procedure Construct_Object
36557>>>>>>>>>>>>>        Forward Send Construct_Object
36559>>>>>>>>>>>>>        Object oarrayGplan_Aux is a cPinakas
36561>>>>>>>>>>>>>        End_Object
36562>>>>>>>>>>>>>        Property Integer pioarray_Gplan_Aux (oarrayGplan_Aux(self))
36563>>>>>>>>>>>>>        Property String psValidChars ""
36564>>>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
36565>>>>>>>>>>>>>    End_Procedure   // Construct_Object
36566>>>>>>>>>>>>>
36566>>>>>>>>>>>>>    Procedure OnConstrain
36567>>>>>>>>>>>>>        Forward Send OnConstrain
36569>>>>>>>>>>>>>        If (piMustNOTConstrain(Self)) Begin
36571>>>>>>>>>>>>>        End
36571>>>>>>>>>>>>>>
36571>>>>>>>>>>>>>        Else Begin
36572>>>>>>>>>>>>>            Constrain Gplan.Company_Code  eq SysCurGL.Company_Code
36574>>>>>>>>>>>>>            Constrain Gplan.Branch_Code   eq SysCurGL.Branch_Code
36576>>>>>>>>>>>>>            Constrain Gplan.Year_Year     eq SysCurGL.Year_Year
36578>>>>>>>>>>>>>        End
36578>>>>>>>>>>>>>>
36578>>>>>>>>>>>>>    End_Procedure
36579>>>>>>>>>>>>>
36579>>>>>>>>>>>>>    Procedure Update
36580>>>>>>>>>>>>>        Forward Send Update
36582>>>>>>>>>>>>>        // Insert Code Here
36582>>>>>>>>>>>>>        Move SysCurGL.Company_Code  to Gplan.Company_Code
36583>>>>>>>>>>>>>        Move SysCurGL.Branch_Code   to Gplan.Branch_Code
36584>>>>>>>>>>>>>        Move SysCurGL.Year_Year     to Gplan.Year_Year
36585>>>>>>>>>>>>>        Move SysCurGL.Year_Recr     to Gplan.Year_Recr
36586>>>>>>>>>>>>>    End_Procedure   // Update
36587>>>>>>>>>>>>>
36587>>>>>>>>>>>>>    Procedure Creating
36588>>>>>>>>>>>>>        Forward Send Creating
36590>>>>>>>>>>>>>        // Insert Code Here
36590>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurGL.Branch_Site))+;                         (Trim(String(Gplan.Gplan_Rec0)))))) to Gplan.Gplan_Recr
36591>>>>>>>>>>>>>    End_Procedure   // Creating
36592>>>>>>>>>>>>>
36592>>>>>>>>>>>>>
36592>>>>>>>>>>>>>//////////////////////////////////////
36592>>>>>>>>>>>>>//////////////////////////////////////
36592>>>>>>>>>>>>>
36592>>>>>>>>>>>>>    Function fiCheckValidChars String asGplanCode String asValChars Returns Integer
36593>>>>>>>>>>>>>        String lsChar
36594>>>>>>>>>>>>>        Integer liLen liCharPos rVal
36594>>>>>>>>>>>>>        If (asGplanCode <> "") Begin
36596>>>>>>>>>>>>>            Move (Trim(asGplanCode)) to asGplanCode
36597>>>>>>>>>>>>>            Move (Length(asGplanCode)) to liLen
36598>>>>>>>>>>>>>            For liCharPos From 1 to liLen
36604>>>>>>>>>>>>>>
36604>>>>>>>>>>>>>               Move (Mid(asGplanCode,1,liCharPos)) to lsChar
36605>>>>>>>>>>>>>               If (Not(asValChars contains lsChar)) Begin
36607>>>>>>>>>>>>>                    Set psValidChars to asValChars
36608>>>>>>>>>>>>>                    Function_Return 1001
36609>>>>>>>>>>>>>               End
36609>>>>>>>>>>>>>>
36609>>>>>>>>>>>>>            Loop
36610>>>>>>>>>>>>>>
36610>>>>>>>>>>>>>        End
36610>>>>>>>>>>>>>>
36610>>>>>>>>>>>>>        Function_Return rVal
36611>>>>>>>>>>>>>    End_Function // fiCheckValidChars
36612>>>>>>>>>>>>>
36612>>>>>>>>>>>>>    // private_Do_Restore_Fields:
36612>>>>>>>>>>>>>    Procedure private_Do_Restore_Fields for Gplan_DataDictionary
36613>>>>>>>>>>>>>        // Insert Code Here
36613>>>>>>>>>>>>>        Local Integer lioarray_Gplan_Aux##
36614>>>>>>>>>>>>>        Local Integer liFile##
36614>>>>>>>>>>>>>        Local Integer liField_Count##
36614>>>>>>>>>>>>>        Local Integer liField_Type##
36614>>>>>>>>>>>>>        Local Integer liField##
36614>>>>>>>>>>>>>
36614>>>>>>>>>>>>>        Get pioarray_Gplan_Aux to lioarray_Gplan_Aux##
36615>>>>>>>>>>>>>        Get Main_File to liFile##
36616>>>>>>>>>>>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of liFile## to liField_Count##
36619>>>>>>>>>>>>>
36619>>>>>>>>>>>>>
36619>>>>>>>>>>>>>        For liField## from 0 to (liField_Count##-1)
36625>>>>>>>>>>>>>>
36625>>>>>>>>>>>>>            //Get_Attribute DF_FIELD_TYPE of iFile iField to iField_Type
36625>>>>>>>>>>>>>            move liField## to Fieldindex
36626>>>>>>>>>>>>>            Get Array_Value of lioarray_Gplan_Aux## Item (liField##+1) to Gplan.Company_Code&
36627>>>>>>>>>>>>>        Loop
36628>>>>>>>>>>>>>>
36628>>>>>>>>>>>>>        Send Delete_Data to lioarray_Gplan_Aux##
36629>>>>>>>>>>>>>    End_Procedure   // private_Do_Restore_Fields
36630>>>>>>>>>>>>>
36630>>>>>>>>>>>>>    // private_Do_Keep_Fields:
36630>>>>>>>>>>>>>
36630>>>>>>>>>>>>>    Procedure private_Do_Keep_Fields for Gplan_DataDictionary
36631>>>>>>>>>>>>>        // Insert Code Here
36631>>>>>>>>>>>>>        Local Integer lioarray_Gplan_Aux##
36632>>>>>>>>>>>>>        Local Integer liFile##
36632>>>>>>>>>>>>>        Local Integer liField_Count##
36632>>>>>>>>>>>>>        Local Integer liField_Type##
36632>>>>>>>>>>>>>        Local Integer liField##
36632>>>>>>>>>>>>>
36632>>>>>>>>>>>>>        Get pioarray_Gplan_Aux to lioarray_Gplan_Aux##
36633>>>>>>>>>>>>>        Get Main_File to liFile##
36634>>>>>>>>>>>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of liFile## to liField_Count##
36637>>>>>>>>>>>>>
36637>>>>>>>>>>>>>        Send Delete_Data to lioarray_Gplan_Aux##
36638>>>>>>>>>>>>>        Send Add_Item to lioarray_Gplan_Aux## 0 //sos.sos
36639>>>>>>>>>>>>>
36639>>>>>>>>>>>>>        For liField## from 0 to (liField_Count##-1)
36645>>>>>>>>>>>>>>
36645>>>>>>>>>>>>>            //Get_Attribute DF_FIELD_TYPE of iFile iField to iField_Type
36645>>>>>>>>>>>>>            move liField## to Fieldindex
36646>>>>>>>>>>>>>            Send Add_Item to lioarray_Gplan_Aux## Gplan.Company_Code&
36647>>>>>>>>>>>>>        Loop
36648>>>>>>>>>>>>>>
36648>>>>>>>>>>>>>    End_Procedure   // private_Do_Keep_Fields
36649>>>>>>>>>>>>>
36649>>>>>>>>>>>>>    // Request_Save:
36649>>>>>>>>>>>>>
36649>>>>>>>>>>>>>
36649>>>>>>>>>>>>>
36649>>>>>>>>>>>>>//-----------------------------------------------------------------------------
36649>>>>>>>>>>>>>    FUNCTION Compute_Bathmos for Gplan_DataDictionary STRING KODIKOS## RETURNS INTEGER
36650>>>>>>>>>>>>>             LOCAL INTEGER BATHMOS##
36651>>>>>>>>>>>>>             REPEAT
36651>>>>>>>>>>>>>>
36651>>>>>>>>>>>>>                   REPLACE "." IN KODIKOS## WITH ""
36653>>>>>>>>>>>>>                   [FOUND] INCREMENT BATHMOS##
36654>>>>>>>>>>>>>             UNTIL (FINDERR=1)
36656>>>>>>>>>>>>>             FUNCTION_RETURN (BATHMOS##+1)
36657>>>>>>>>>>>>>    END_FUNCTION //compute_bathmos
36658>>>>>>>>>>>>>
36658>>>>>>>>>>>>>    FUNCTION Find_Previous for Gplan_DataDictionary STRING LS_CODE1## RETURNS STRING
36659>>>>>>>>>>>>>        LOCAL STRING LS_TEMP_CODE1## LS_TEMP_CODE2##
36660>>>>>>>>>>>>>        LOCAL INTEGER LI_COUNTER##
36660>>>>>>>>>>>>>
36660>>>>>>>>>>>>>        FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_CODE1##))
36666>>>>>>>>>>>>>>
36666>>>>>>>>>>>>>             INSERT (MID(LS_CODE1##,1,LI_COUNTER##)) IN LS_TEMP_CODE1## AT 1
36668>>>>>>>>>>>>>        LOOP
36669>>>>>>>>>>>>>>
36669>>>>>>>>>>>>>        MOVE (RIGHT(LS_TEMP_CODE1##,(LENGTH(LS_TEMP_CODE1##)-(POS(".",LS_TEMP_CODE1##))))) ;             TO LS_TEMP_CODE1##
36670>>>>>>>>>>>>>        FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_TEMP_CODE1##))
36676>>>>>>>>>>>>>>
36676>>>>>>>>>>>>>            INSERT (MID(LS_TEMP_CODE1##,1,LI_COUNTER##)) IN LS_TEMP_CODE2## AT 1
36678>>>>>>>>>>>>>        LOOP
36679>>>>>>>>>>>>>>
36679>>>>>>>>>>>>>        FUNCTION_RETURN LS_TEMP_CODE2##
36680>>>>>>>>>>>>>    END_FUNCTION
36681>>>>>>>>>>>>>
36681>>>>>>>>>>>>>    FUNCTION fiCheck_Format STRING  LS_CODE1##;                            STRING  LS_MASK##;                            INTEGER LI_BATHMOS##;                            RETURNS INTEGER
36682>>>>>>>>>>>>>             String  LS_TEMP_CODE1## LS_TEMP_CODE2## LS_MASK2##
36683>>>>>>>>>>>>>             Integer LI_COUNTER## LI_BATHMOS1##
36683>>>>>>>>>>>>>             Move (Trim(ls_Code1##)) to ls_Code1##
36684>>>>>>>>>>>>>             Move (Trim(ls_Mask##))  to ls_Mask##
36685>>>>>>>>>>>>>             FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_MASK##))
36691>>>>>>>>>>>>>>
36691>>>>>>>>>>>>>                  IF ((MID(LS_MASK##,1,LI_COUNTER##)) = ".") INCREMENT LI_BATHMOS1##
36694>>>>>>>>>>>>>                  IF (LI_BATHMOS1## < LI_BATHMOS##) ;                  INSERT (MID(LS_MASK##,1,LI_COUNTER##)) IN LS_MASK2## AT LI_COUNTER##
36698>>>>>>>>>>>>>             LOOP
36699>>>>>>>>>>>>>>
36699>>>>>>>>>>>>>             IF (;                  (LENGTH(LS_CODE1##)) <> (LENGTH(LS_MASK2##));                ) FUNCTION_RETURN 1000
36702>>>>>>>>>>>>>             FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_MASK2##))
36708>>>>>>>>>>>>>>
36708>>>>>>>>>>>>>                  IF (;                      ((MID(LS_MASK2##,1,LI_COUNTER##)) = ".") AND;                      ((MID(LS_CODE1##,1,LI_COUNTER##)) <> ".");                     ) FUNCTION_RETURN 1000
36711>>>>>>>>>>>>>             LOOP
36712>>>>>>>>>>>>>>
36712>>>>>>>>>>>>>             FUNCTION_RETURN 0
36713>>>>>>>>>>>>>    END_FUNCTION //fiCHECK_FORMAT
36714>>>>>>>>>>>>>
36714>>>>>>>>>>>>>    Function fiBackward_Check for Gplan_DataDictionary String LsGplanCode_Back integer liBathmos Returns Integer
36715>>>>>>>>>>>>>        Integer liGplan_Yn_Last
36716>>>>>>>>>>>>>        Number liGplanRecnum
36716>>>>>>>>>>>>>        String LsSearch_CodePrevious
36716>>>>>>>>>>>>>
36716>>>>>>>>>>>>>        if (liBathmos > 1) begin
36718>>>>>>>>>>>>>
36718>>>>>>>>>>>>>            move (Current_Record(Self)) to liGplanRecnum
36719>>>>>>>>>>>>>            move gplan.Gplan_Yn_Last to liGplan_Yn_Last
36720>>>>>>>>>>>>>            Send private_Do_Keep_Fields
36721>>>>>>>>>>>>>
36721>>>>>>>>>>>>>            Move (Find_Previous(self,lsGplanCode_Back)) to lsSearch_CodePrevious
36722>>>>>>>>>>>>>
36722>>>>>>>>>>>>>            clear Gplan
36723>>>>>>>>>>>>>            move gs_Selected_Company_Code  to Gplan.Company_Code
36724>>>>>>>>>>>>>            move gs_Selected_Branch_Code   to Gplan.Branch_Code
36725>>>>>>>>>>>>>            move gi_Selected_Year          to Gplan.Year_Year
36726>>>>>>>>>>>>>            move lsSearch_CodePrevious     to Gplan.Gplan_Code
36727>>>>>>>>>>>>>            Find eq Gplan by index.1 // pkid
36728>>>>>>>>>>>>>>
36728>>>>>>>>>>>>>            If (Found = 0) begin
36730>>>>>>>>>>>>>                clear gplan
36731>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
36732>>>>>>>>>>>>>                find eq gplan.recnum
36733>>>>>>>>>>>>>>
36733>>>>>>>>>>>>>                Send private_Do_Restore_Fields
36734>>>>>>>>>>>>>                Function_return  7001 //return to fiValidate
36735>>>>>>>>>>>>>            end
36735>>>>>>>>>>>>>>
36735>>>>>>>>>>>>>            else begin
36736>>>>>>>>>>>>>               // The  previous logar marked last  and current greater bathmos
36736>>>>>>>>>>>>>               if   (Gplan.Gplan_yn_Last = 1) begin
36738>>>>>>>>>>>>>                   Send private_Do_Restore_Fields
36739>>>>>>>>>>>>>                   Function_return 7003
36740>>>>>>>>>>>>>               end
36740>>>>>>>>>>>>>>
36740>>>>>>>>>>>>>               clear gplan
36741>>>>>>>>>>>>>               move liGplanRecnum to gplan.recnum
36742>>>>>>>>>>>>>               find eq gplan.recnum
36743>>>>>>>>>>>>>>
36743>>>>>>>>>>>>>               Send private_Do_Restore_Fields
36744>>>>>>>>>>>>>               function_Return 0 //ok
36745>>>>>>>>>>>>>            end
36745>>>>>>>>>>>>>>
36745>>>>>>>>>>>>>        end
36745>>>>>>>>>>>>>>
36745>>>>>>>>>>>>>        Function_Return 0
36746>>>>>>>>>>>>>    End_Function  // fiBackward_Check
36747>>>>>>>>>>>>>    //-----------------------------------------------------------------------------
36747>>>>>>>>>>>>>
36747>>>>>>>>>>>>>
36747>>>>>>>>>>>>>    //-----------------------------------------------------------------------------
36747>>>>>>>>>>>>>    FUNCTION fiForward_Check for Gplan_DataDictionary STRING LS_GplanCode integer liMode Returns Integer
36748>>>>>>>>>>>>>        String lsNext_Anoep
36749>>>>>>>>>>>>>        Integer liGplan_Yn_Last
36749>>>>>>>>>>>>>        Number liGplanRecnum
36749>>>>>>>>>>>>>
36749>>>>>>>>>>>>>
36749>>>>>>>>>>>>>        //move gplan.recnum to liGplanRecnum
36749>>>>>>>>>>>>>        move (Current_Record(Self)) to liGplanRecnum
36750>>>>>>>>>>>>>        move gplan.Gplan_Code to lsNext_Anoep
36751>>>>>>>>>>>>>        move gplan.Gplan_Yn_Last to liGplan_Yn_Last
36752>>>>>>>>>>>>>        Send private_Do_Keep_Fields
36753>>>>>>>>>>>>>
36753>>>>>>>>>>>>>        if (liGplan_Yn_Last = 1)  begin
36755>>>>>>>>>>>>>            find gt gplan by index.1
36756>>>>>>>>>>>>>>
36756>>>>>>>>>>>>>            if (found = 0) begin
36758>>>>>>>>>>>>>                clear gplan
36759>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
36760>>>>>>>>>>>>>                find eq gplan.recnum
36761>>>>>>>>>>>>>>
36761>>>>>>>>>>>>>                Send private_Do_Restore_Fields
36762>>>>>>>>>>>>>            end
36762>>>>>>>>>>>>>>
36762>>>>>>>>>>>>>            else begin
36763>>>>>>>>>>>>>                // The Current and the previous logar marked last
36763>>>>>>>>>>>>>                if (Gplan.Gplan_Anoep = lsNext_Anoep) begin
36765>>>>>>>>>>>>>                    clear gplan
36766>>>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
36767>>>>>>>>>>>>>                    find eq gplan.recnum
36768>>>>>>>>>>>>>>
36768>>>>>>>>>>>>>                    Send private_Do_Restore_Fields
36769>>>>>>>>>>>>>                    Function_return 7004
36770>>>>>>>>>>>>>                end
36770>>>>>>>>>>>>>>
36770>>>>>>>>>>>>>                else begin
36771>>>>>>>>>>>>>                    clear gplan
36772>>>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
36773>>>>>>>>>>>>>                    find eq gplan.recnum
36774>>>>>>>>>>>>>>
36774>>>>>>>>>>>>>                    Send private_Do_Restore_Fields
36775>>>>>>>>>>>>>                end
36775>>>>>>>>>>>>>>
36775>>>>>>>>>>>>>            end
36775>>>>>>>>>>>>>>
36775>>>>>>>>>>>>>        end
36775>>>>>>>>>>>>>>
36775>>>>>>>>>>>>>
36775>>>>>>>>>>>>>        if (liMode = 1) begin
36777>>>>>>>>>>>>>            find gt gplan by index.1
36778>>>>>>>>>>>>>>
36778>>>>>>>>>>>>>            if (Found = 0) begin
36780>>>>>>>>>>>>>                clear gplan
36781>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
36782>>>>>>>>>>>>>                find eq gplan.recnum
36783>>>>>>>>>>>>>>
36783>>>>>>>>>>>>>                Send private_Do_Restore_Fields
36784>>>>>>>>>>>>>            end
36784>>>>>>>>>>>>>>
36784>>>>>>>>>>>>>            else begin
36785>>>>>>>>>>>>>                if (Gplan.Gplan_Anoep = lsNext_Anoep) begin
36787>>>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
36788>>>>>>>>>>>>>                    find eq gplan.recnum
36789>>>>>>>>>>>>>>
36789>>>>>>>>>>>>>                    Send private_Do_Restore_Fields
36790>>>>>>>>>>>>>                    Function_return 7010 //called from validate delete
36791>>>>>>>>>>>>>                end
36791>>>>>>>>>>>>>>
36791>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
36792>>>>>>>>>>>>>                find eq gplan.recnum
36793>>>>>>>>>>>>>>
36793>>>>>>>>>>>>>                //Send private_Do_Restore_Fields
36793>>>>>>>>>>>>>            end
36793>>>>>>>>>>>>>>
36793>>>>>>>>>>>>>        end
36793>>>>>>>>>>>>>>
36793>>>>>>>>>>>>>        Function_return 0
36794>>>>>>>>>>>>>    End_Function // fiForward_Check
36795>>>>>>>>>>>>>
36795>>>>>>>>>>>>>
36795>>>>>>>>>>>>>    Function private_Man_Gplan_Code for Gplan_DataDictionary integer liField## String lsGplan_Code integer liModeGplan Returns Integer
36796>>>>>>>>>>>>>
36796>>>>>>>>>>>>>        // Insert Code Here
36796>>>>>>>>>>>>>        Integer liCounter liPosition liLength liBathmos liRetVal
36797>>>>>>>>>>>>>        string lsMask lsCkeckChar lsSearchCode
36797>>>>>>>>>>>>>
36797>>>>>>>>>>>>>        Trim lsGplan_code to lsGplan_code
36798>>>>>>>>>>>>>>
36798>>>>>>>>>>>>>        Move lsGplan_Code to lsSearchCode
36799>>>>>>>>>>>>>    Search_Again:
36799>>>>>>>>>>>>>        clear Gformat
INCLUDING FILE: GFORMAT.FD
36800>>>>>>>>>>>>>        move SysCurGL.Company_Code  to Gformat.Company_Code
36801>>>>>>>>>>>>>        move SysCurGL.Branch_Code   to Gformat.Branch_Code
36802>>>>>>>>>>>>>        move SysCurGL.Year_Year     to Gformat.Year_Year
36803>>>>>>>>>>>>>        move lsSearchCode           to Gformat.Gformat_Code
36804>>>>>>>>>>>>>        Find eq Gformat by index.1
36805>>>>>>>>>>>>>>
36805>>>>>>>>>>>>>
36805>>>>>>>>>>>>>        if (Found = 1) begin
36807>>>>>>>>>>>>>            Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
36808>>>>>>>>>>>>>            Move (fiCheck_Format(self,lsGplan_Code,gformat.gformat_mask,liBathmos)) to liRetVal
36809>>>>>>>>>>>>>            if (liRetVal = 0) begin
36811>>>>>>>>>>>>>                Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
36812>>>>>>>>>>>>>                if (liModeGplan = 0) Begin
36814>>>>>>>>>>>>>                    if (Not(Current_Record(self))) begin
36816>>>>>>>>>>>>>                        set field_default_value field Gplan.gplan_Bathmos to libathmos //from deo
36817>>>>>>>>>>>>>                    end
36817>>>>>>>>>>>>>>
36817>>>>>>>>>>>>>                end
36817>>>>>>>>>>>>>>
36817>>>>>>>>>>>>>                if (libathmos > 1) begin
36819>>>>>>>>>>>>>                    Move (Find_Previous(self,lsGplan_Code)) to lsSearchCode
36820>>>>>>>>>>>>>                    if (liModeGplan = 0) Begin
36822>>>>>>>>>>>>>                        if (Not(Current_Record(self))) begin
36824>>>>>>>>>>>>>                            set field_default_value field Gplan.gplan_Anoep to lsSearchCode //from Deo
36825>>>>>>>>>>>>>                        End
36825>>>>>>>>>>>>>>
36825>>>>>>>>>>>>>                    End
36825>>>>>>>>>>>>>>
36825>>>>>>>>>>>>>                end
36825>>>>>>>>>>>>>>
36825>>>>>>>>>>>>>            function_return 0
36826>>>>>>>>>>>>>            end
36826>>>>>>>>>>>>>>
36826>>>>>>>>>>>>>            else begin
36827>>>>>>>>>>>>>                function_return 127
36828>>>>>>>>>>>>>            end
36828>>>>>>>>>>>>>>
36828>>>>>>>>>>>>>        end
36828>>>>>>>>>>>>>>
36828>>>>>>>>>>>>>        else begin
36829>>>>>>>>>>>>>            Move (Compute_Bathmos(self,lsSearchCode)) to liBathmos
36830>>>>>>>>>>>>>            if ((liBathmos-1) <> 0) begin
36832>>>>>>>>>>>>>                Move (Find_Previous(self,lsSearchCode)) to lsSearchCode
36833>>>>>>>>>>>>>                Goto Search_Again
36834>>>>>>>>>>>>>>
36834>>>>>>>>>>>>>            end
36834>>>>>>>>>>>>>>
36834>>>>>>>>>>>>>            else begin
36835>>>>>>>>>>>>>                clear Gformat
36836>>>>>>>>>>>>>                move SysCurGL.Company_Code  to Gformat.Company_Code
36837>>>>>>>>>>>>>                move SysCurGL.Branch_Code   to Gformat.Branch_Code
36838>>>>>>>>>>>>>                move SysCurGL.Year_Year     to Gformat.Year_Year
36839>>>>>>>>>>>>>                move "@@"                   to Gformat.Gformat_Code
36840>>>>>>>>>>>>>                Find eq Gformat by index.1 // pkid
36841>>>>>>>>>>>>>>
36841>>>>>>>>>>>>>//* to be a function
36841>>>>>>>>>>>>>                Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
36842>>>>>>>>>>>>>                Move (fiCheck_Format(self,lsGplan_Code,gformat.gformat_mask,liBathmos)) to liRetVal
36843>>>>>>>>>>>>>                if (liRetVal = 0) begin
36845>>>>>>>>>>>>>                    Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
36846>>>>>>>>>>>>>                    if (liModeGplan = 0) Begin
36848>>>>>>>>>>>>>                        if (Not(Current_Record(self))) begin
36850>>>>>>>>>>>>>                            set field_default_value field Gplan.gplan_Bathmos to libathmos //from Deo
36851>>>>>>>>>>>>>                        end
36851>>>>>>>>>>>>>>
36851>>>>>>>>>>>>>                    end
36851>>>>>>>>>>>>>>
36851>>>>>>>>>>>>>                    if (libathmos > 1) begin
36853>>>>>>>>>>>>>                        Move (Find_Previous(self,lsGplan_Code)) to lsSearchCode
36854>>>>>>>>>>>>>                        if (liModeGplan = 0) Begin
36856>>>>>>>>>>>>>                            if (Not(Current_Record(self))) begin
36858>>>>>>>>>>>>>                                set field_default_value field Gplan.gplan_Anoep to lsSearchCode //from Deo
36859>>>>>>>>>>>>>                            end
36859>>>>>>>>>>>>>>
36859>>>>>>>>>>>>>                        end
36859>>>>>>>>>>>>>>
36859>>>>>>>>>>>>>                    end
36859>>>>>>>>>>>>>>
36859>>>>>>>>>>>>>                function_return 0
36860>>>>>>>>>>>>>                end
36860>>>>>>>>>>>>>>
36860>>>>>>>>>>>>>                else begin
36861>>>>>>>>>>>>>                    function_return 127
36862>>>>>>>>>>>>>                end
36862>>>>>>>>>>>>>>
36862>>>>>>>>>>>>>
36862>>>>>>>>>>>>>                //* emd to be a function
36862>>>>>>>>>>>>>                function_return 0
36863>>>>>>>>>>>>>            end
36863>>>>>>>>>>>>>>
36863>>>>>>>>>>>>>        end
36863>>>>>>>>>>>>>>
36863>>>>>>>>>>>>>        Function_return 0    //ok
36864>>>>>>>>>>>>>    End_Function   // private_Man_Gplan_Code
36865>>>>>>>>>>>>>
36865>>>>>>>>>>>>>
36865>>>>>>>>>>>>>
36865>>>>>>>>>>>>>    // fiValidateGplanFields:
36865>>>>>>>>>>>>>
36865>>>>>>>>>>>>>    Function fiValidateGplanFields for Gplan_DataDictionary integer liField string lsFieldvalue Returns Integer
36866>>>>>>>>>>>>>        String  sName lsAnoep lsGplan_Code
36867>>>>>>>>>>>>>        Integer iMainFile liGplanRecnum liReturnVal liReturnValb liBathmos1
36867>>>>>>>>>>>>>        String lsValidChar lsDelimiter
36867>>>>>>>>>>>>>
36867>>>>>>>>>>>>>        Get Main_File to iMainFile
36868>>>>>>>>>>>>>        Get_Attribute DF_FIELD_NAME of iMainFile liField to sName
36871>>>>>>>>>>>>>
36871>>>>>>>>>>>>>        If (sName = 'GPLAN_CODE') Begin
36873>>>>>>>>>>>>>            move (trim(lsFieldvalue)) to lsFieldvalue //from deo
36874>>>>>>>>>>>>>            if (lsFieldvalue <>  "") begin //new
36876>>>>>>>>>>>>>                Move SyscurGL.Year_Valid_Char to lsValidChar
36877>>>>>>>>>>>>>                Move SyscurGL.Year_Delimiter  to lsDelimiter
36878>>>>>>>>>>>>>                Move (fiCheckValidChars(Self,lsFieldvalue,((Trim(lsValidChar))+(Trim(lsDelimiter))))) to liReturnVal
36879>>>>>>>>>>>>>                if (liReturnVal = '1001') begin
36881>>>>>>>>>>>>>                               error liReturnVal ("‹ž ˜§¦›œ¡«æª ®˜¨˜¡«ã¨˜ª š ˜ ¡à› ¡æ Š.‘ !\n\n€§¦›œ¡«¦å ®˜¨˜¡«ã¨œª : '" + (psValidChars(Self)) + "'")
36882>>>>>>>>>>>>>>
36882>>>>>>>>>>>>>                               Function_Return liReturnVal
36883>>>>>>>>>>>>>                            end
36883>>>>>>>>>>>>>>
36883>>>>>>>>>>>>>
36883>>>>>>>>>>>>>                Move (private_Man_Gplan_Code(self,liField,lsFieldvalue,0)) to liReturnVal
36884>>>>>>>>>>>>>                if (lireturnval <> 0) begin
36886>>>>>>>>>>>>>                                        error 127 ("ŠáŸ¦ª £¦¨­ã ¡à› ¡¦ç !\n\n"+Gplan.Gplan_Code)
36887>>>>>>>>>>>>>>
36887>>>>>>>>>>>>>                                        function_return 127
36888>>>>>>>>>>>>>                                      end
36888>>>>>>>>>>>>>>
36888>>>>>>>>>>>>>
36888>>>>>>>>>>>>>                get field_current_value field Gplan.gplan_Code to lsGplan_Code
36889>>>>>>>>>>>>>                get field_current_value field Gplan.gplan_Bathmos to liBathmos1
36890>>>>>>>>>>>>>                get field_current_value field Gplan.gplan_anoep to lsAnoep
36891>>>>>>>>>>>>>                Move (fiBackward_Check(self,lsGplan_Code,liBathmos1)) to liReturnValb
36892>>>>>>>>>>>>>                if (liReturnValb = '7001') begin
36894>>>>>>>>>>>>>                                               error 7001 "ƒœ¤ ¬§á¨®œ  ¦ §œ¨ ¢ž§« ¡æª ™˜Ÿ£æª !"
36895>>>>>>>>>>>>>>
36895>>>>>>>>>>>>>                                               Function_Return 8001
36896>>>>>>>>>>>>>                                            end
36896>>>>>>>>>>>>>>
36896>>>>>>>>>>>>>                if (liReturnValb = '7002') begin
36898>>>>>>>>>>>>>                                               error 7002 "“§á¨®œ  ¡à› ¡æª «œ¢œ¬«˜å¦¬ ™˜Ÿ£¦ç !"
36899>>>>>>>>>>>>>>
36899>>>>>>>>>>>>>                                               Function_Return 8002
36900>>>>>>>>>>>>>                                          end
36900>>>>>>>>>>>>>>
36900>>>>>>>>>>>>>                if (liReturnValb = '7003') begin
36902>>>>>>>>>>>>>                                               error 7003 "Ž §¨¦žš¦ç£œ¤¦ª œå¤˜  «œ¢œ¬«˜å¦¬ ™˜Ÿ£¦ç !"
36903>>>>>>>>>>>>>>
36903>>>>>>>>>>>>>                                               Function_Return 8003
36904>>>>>>>>>>>>>                                          end
36904>>>>>>>>>>>>>>
36904>>>>>>>>>>>>>
36904>>>>>>>>>>>>>                Move (fiForward_Check(self,lsGplan_Code,0)) to liReturnValb
36905>>>>>>>>>>>>>                if (liReturnValb = '7004') begin
36907>>>>>>>>>>>>>                                               error 7004 "“§á¨®œ  ¦ ˜¤é«œ¨¦ª ™˜Ÿ£æª !"
36908>>>>>>>>>>>>>>
36908>>>>>>>>>>>>>                                               Function_Return 8004
36909>>>>>>>>>>>>>                                            end
36909>>>>>>>>>>>>>>
36909>>>>>>>>>>>>>
36909>>>>>>>>>>>>>            end
36909>>>>>>>>>>>>>>
36909>>>>>>>>>>>>>            else Function_Return 0  //exit function ok!!!
36911>>>>>>>>>>>>>         end
36911>>>>>>>>>>>>>>
36911>>>>>>>>>>>>>         function_return 0
36912>>>>>>>>>>>>>    End_Function   // fiValidateGplanFields
36913>>>>>>>>>>>>>
36913>>>>>>>>>>>>>
36913>>>>>>>>>>>>>//-----------------------------------------------Save Operation ----------------------------------------------------
36913>>>>>>>>>>>>>
36913>>>>>>>>>>>>>
36913>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
36914>>>>>>>>>>>>>        //Forward Send Operation_Not_Allowed  iError_Num
36914>>>>>>>>>>>>>        // Insert Code Here
36914>>>>>>>>>>>>>                 if iError_num eq 127  error 127 ((Trim(Gplan.Gplan_Code))+" Wrong Format !!!! \n\n")
36917>>>>>>>>>>>>>            Else if iError_num eq 128  error 128 ("Not a valid Data Entry.  Account is Missing !!!!\n\n"+Gplan.Gplan_Code)
36921>>>>>>>>>>>>>            Else if iError_num eq 129  error 129 ("Not a valid Data Entry.  Bathmos is Missing !!!!\n\n"+Gplan.Gplan_Code)
36925>>>>>>>>>>>>>            Else if iError_num eq 130  error 130 ("Not a valid Data Entry.  Previews Account is Missing !!!!\n\n"+Gplan.Gplan_Code)
36929>>>>>>>>>>>>>            Else if iError_num eq 1100  error 1100 "DDC:150 - ‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
36933>>>>>>>>>>>>>            Else if iError_num eq 2100  error 2100 "DDC:150 - ‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
36937>>>>>>>>>>>>>            Else if iError_num eq 7001 error 8001 ("Anoep Does not Exist !!!!\n\n"+Gplan.Gplan_Code)
36941>>>>>>>>>>>>>            Else if iError_num eq 7002 error 8002 ("Last Exists\n\n!!!! "+Gplan.Gplan_Code)
36945>>>>>>>>>>>>>            Else if iError_num eq 7003 error 8003 ("Previous batmos is last  !!!!\n\n"+Gplan.Gplan_Code)
36949>>>>>>>>>>>>>            Else if iError_num eq 7004 error 8004 ("Greater bathmos exists  !!!!\n\n"+Gplan.Gplan_Code)
36953>>>>>>>>>>>>>            Else if iError_num eq 7010 error 7010 ("Greater bathmos exists  !!!!\n\n"+Gplan.Gplan_Code)
36957>>>>>>>>>>>>>            Else if (iError_num = 1001) error 1001 ("‹ž ˜§¦›œ¡«æª ®˜¨˜¡«ã¨˜ª š ˜ ¡à› ¡æ Š.‘ !\n\n€§¦›œ¡«¦å ®˜¨˜¡«ã¨œª : '" + (psValidChars(Self)) + "'")
36961>>>>>>>>>>>>>            Else Forward Send Operation_Not_Allowed  iError_Num
36964>>>>>>>>>>>>>    End_Procedure
36965>>>>>>>>>>>>>
36965>>>>>>>>>>>>>
36965>>>>>>>>>>>>>    Procedure Clear_From_Bpo
36966>>>>>>>>>>>>>        Clear Gplan
36967>>>>>>>>>>>>>    End_Procedure
36968>>>>>>>>>>>>>
36968>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
36969>>>>>>>>>>>>>        Local Integer iReturnVal iField##
36970>>>>>>>>>>>>>        locaL string lsVal##
36970>>>>>>>>>>>>>
36970>>>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
36972>>>>>>>>>>>>>
36972>>>>>>>>>>>>>
36972>>>>>>>>>>>>>        If (Not(iReturnVal))Begin
36974>>>>>>>>>>>>>            If (Not(Current_Record(Self))) Move (fiCheckValidChars(Self,Gplan.Gplan_Code,((Trim(Year.Year_Valid_Char))+(Trim(Year.Year_Delimiter))))) to iReturnVal
36977>>>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
36980>>>>>>>>>>>>>            If (Gplan.Gplan_Code    = "") Send Operation_Not_Allowed 128
36983>>>>>>>>>>>>>            If (Gplan.Gplan_Bathmos = 0 ) Send Operation_Not_Allowed 129
36986>>>>>>>>>>>>>            If (;                 (Gplan.Gplan_Bathmos <> 1) and;                 (Gplan.Gplan_Anoep = "");               ) Send Operation_Not_Allowed 130
36989>>>>>>>>>>>>>            For iField## from 4 to 4   // Field number for Starting and Ending pp's ???????
36995>>>>>>>>>>>>>>
36995>>>>>>>>>>>>>
36995>>>>>>>>>>>>>                Move (private_Man_Gplan_Code(self,iField##,Gplan.Gplan_Code,1))     to iReturnVal
36996>>>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
36999>>>>>>>>>>>>>
36999>>>>>>>>>>>>>                Move (fiBACKWARD_CHECK(self,Gplan.Gplan_Code,Gplan.Gplan_Bathmos)) to iReturnVal
37000>>>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
37003>>>>>>>>>>>>>
37003>>>>>>>>>>>>>                Move (fiFORWARD_CHECK(self,Gplan.Gplan_Code,0))                     to iReturnVal
37004>>>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
37007>>>>>>>>>>>>>
37007>>>>>>>>>>>>>            Loop
37008>>>>>>>>>>>>>>
37008>>>>>>>>>>>>>              //1100:cby = globals
37008>>>>>>>>>>>>>              If ( ;                   (Not(Gplan.Company_Code = SysCurGL.Company_Code)) or;                   (Not(Gplan.Branch_Code  = SysCurGL.Branch_Code )) or;                   (Not(Gplan.Year_Year    = SysCurGL.Year_Year   ));                  ) Send Operation_Not_Allowed 1100
37011>>>>>>>>>>>>>        End
37011>>>>>>>>>>>>>>
37011>>>>>>>>>>>>>        Function_Return iReturnVal
37012>>>>>>>>>>>>>    End_Function
37013>>>>>>>>>>>>>
37013>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
37014>>>>>>>>>>>>>        Local Integer iReturnVal liReturnValb##
37015>>>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
37017>>>>>>>>>>>>>
37017>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
37019>>>>>>>>>>>>>            // Insert Code Here
37019>>>>>>>>>>>>>               Move (fiFORWARD_CHECK(Self,Gplan.Gplan_Code,1)) to liReturnValb##
37020>>>>>>>>>>>>>               If (liReturnValb##>1) Send Operation_Not_Allowed liReturnValb##
37023>>>>>>>>>>>>>              //2100:cby = globals
37023>>>>>>>>>>>>>              If ( ;                   (Not(Gplan.Company_Code = SysCurGL.Company_Code)) or;                   (Not(Gplan.Branch_Code  = SysCurGL.Branch_Code )) or;                   (Not(Gplan.Year_Year    = SysCurGL.Year_Year   ));                  )                                                   Send Operation_Not_Allowed 2100
37026>>>>>>>>>>>>>        End
37026>>>>>>>>>>>>>>
37026>>>>>>>>>>>>>
37026>>>>>>>>>>>>>        Function_Return iReturnVal
37027>>>>>>>>>>>>>    End_Function
37028>>>>>>>>>>>>>
37028>>>>>>>>>>>>>
37028>>>>>>>>>>>>>//    Procedure Update
37028>>>>>>>>>>>>>//        Forward Send Update
37028>>>>>>>>>>>>>//        // Insert Code Here
37028>>>>>>>>>>>>>//        Move Company.Company_Code  to Gplan.Company_Code
37028>>>>>>>>>>>>>//        Move Branch.Branch_Code    to Gplan.Branch_Code
37028>>>>>>>>>>>>>//        Move Year.Year_Year        to Gplan.Year_Year
37028>>>>>>>>>>>>>//        Add 1 to Year.Year_NumGplan //˜¨ Ÿ£æª ¢¦š˜¨ ˜©£é¤ «žª ®¨ã©žª
37028>>>>>>>>>>>>>//    End_Procedure   // Update
37028>>>>>>>>>>>>>
37028>>>>>>>>>>>>>//    Procedure Backout
37028>>>>>>>>>>>>>//        Forward Send Backout
37028>>>>>>>>>>>>>//        Sub 1 from Year.Year_NumGplan //˜¨ Ÿ£æª ¢¦š˜¨ ˜©£é¤ «žª ®¨ã©žª
37028>>>>>>>>>>>>>//    End_Procedure //deleting
37028>>>>>>>>>>>>>
37028>>>>>>>>>>>>>
37028>>>>>>>>>>>>>
37028>>>>>>>>>>>>>    // Define_Fields:
37028>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
37028>>>>>>>>>>>>>
37028>>>>>>>>>>>>>    Procedure Define_Fields
37029>>>>>>>>>>>>>        Forward Send Define_Fields
37031>>>>>>>>>>>>>        //DDB-Generated-Code-Location
37031>>>>>>>>>>>>>        //DDB-DefineFieldStart
37031>>>>>>>>>>>>>
37031>>>>>>>>>>>>>        Set Main_File            To Gplan.File_Number
37032>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
37033>>>>>>>>>>>>>
37033>>>>>>>>>>>>>
37033>>>>>>>>>>>>>        // Child (Client) file structure................
37033>>>>>>>>>>>>>        Send Add_Client_File  Gmovea.File_Number
37034>>>>>>>>>>>>>        Send Add_Client_File  Gplanmod.File_Number
37035>>>>>>>>>>>>>        Send Add_Client_File  Gmhnes.File_Number
37036>>>>>>>>>>>>>        Send Add_Client_File  Gmove.File_Number
37037>>>>>>>>>>>>>        Send Add_Client_File  Gvatd.File_Number
37038>>>>>>>>>>>>>        Send Add_Client_File  Gpmoves.File_Number
37039>>>>>>>>>>>>>
37039>>>>>>>>>>>>>        // External (System) file structure.............
37039>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
37040>>>>>>>>>>>>>        Send Add_System_File  Syscurgl.File_Number  DD_LOCK_ON_ALL
37041>>>>>>>>>>>>>
37041>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gplan_Rec0  To Gplan.Gplan_Rec0
37044>>>>>>>>>>>>>
37044>>>>>>>>>>>>>        // Field-based properties.......................
37044>>>>>>>>>>>>>
37044>>>>>>>>>>>>>        // Gplan.Company_Code
37044>>>>>>>>>>>>>
37044>>>>>>>>>>>>>        // Gplan.Branch_Code
37044>>>>>>>>>>>>>
37044>>>>>>>>>>>>>        // Gplan.Year_Year
37044>>>>>>>>>>>>>
37044>>>>>>>>>>>>>        // Gplan.Gplan_Code
37044>>>>>>>>>>>>>        Set Field_Exit_msg         Field Gplan.Gplan_Code To get_fiValidateGplanFields
37045>>>>>>>>>>>>>        Set Field_Options          Field Gplan.Gplan_Code To DD_AUTOFIND    DD_REQUIRED   
37046>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Code To (sl150(Self))
37047>>>>>>>>>>>>>
37047>>>>>>>>>>>>>        // Gplan.Gplan_Rec0
37047>>>>>>>>>>>>>
37047>>>>>>>>>>>>>        // Gplan.Year_Recr
37047>>>>>>>>>>>>>
37047>>>>>>>>>>>>>        // Gplan.Gplan_Descr1
37047>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Descr1 To (sl150(Self))
37048>>>>>>>>>>>>>
37048>>>>>>>>>>>>>        // Gplan.Gplan_Descr2
37048>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Descr2 To (sl150(Self))
37049>>>>>>>>>>>>>
37049>>>>>>>>>>>>>        // Gplan.Gplan_Bathmos
37049>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Bathmos To "Calulated"
37049>>>>>>>>>>>>>
37049>>>>>>>>>>>>>        // Gplan.Gplan_Anoep
37049>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Anoep To "Calulated"
37049>>>>>>>>>>>>>
37049>>>>>>>>>>>>>        // Gplan.Gplan_O_Code
37049>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_O_Code To "dbComboFormSub"
37050>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_O_Code To (Gplan_Gplan_O_Code_VT(Self))
37051>>>>>>>>>>>>>
37051>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Xfer
37051>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Xfer To "dbComboFormSub"
37052>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Xfer To (Gplan_Gplan_Yn_VT(Self))
37053>>>>>>>>>>>>>
37053>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Last
37053>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Last To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1013)"
37053>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Last To "dbComboFormSub"
37054>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Last To (Gplan_Gplan_Yn_VT(Self))
37055>>>>>>>>>>>>>
37055>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Kin
37055>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Kin To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1014)"
37055>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Kin To "dbComboFormSub"
37056>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Kin To (Gplan_Gplan_Yn_VT(Self))
37057>>>>>>>>>>>>>
37057>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Kk
37057>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Kk To "dbComboFormSub"
37058>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Kk To (Gplan_Gplan_Yn_VT(Self))
37059>>>>>>>>>>>>>
37059>>>>>>>>>>>>>        // Gplan.Gplan_Xpm
37059>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Xpm To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1015+1016)"
37059>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Xpm To "dbComboFormSub"
37060>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Xpm To (Gplan_Gplan_Xpm_VT(Self))
37061>>>>>>>>>>>>>
37061>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Xy
37061>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Xy To "•¨ž© £¦§¦ œå«˜  ©«ž¤ private.trexe «¦¬ Gmove (1017)"
37061>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Xy To "dbComboFormSub"
37062>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Xy To (Gplan_Gplan_Yn_VT(Self))
37063>>>>>>>>>>>>>
37063>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Py
37063>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Py To "•¨ž© £¦§¦ œå«˜  ©«ž¤ private.trexe «¦¬ Gmove (1018)"
37063>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Py To "dbComboFormSub"
37064>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Py To (Gplan_Gplan_Yn_VT(Self))
37065>>>>>>>>>>>>>
37065>>>>>>>>>>>>>        // Gplan.Gplan_Fpaent
37065>>>>>>>>>>>>>
37065>>>>>>>>>>>>>        // Gplan.Gplan_Fpaent_Yn
37065>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Fpaent_Yn To (Gplan_Gplan_Yn_VT(Self))
37066>>>>>>>>>>>>>
37066>>>>>>>>>>>>>        // Gplan.Gplan_Afm
37066>>>>>>>>>>>>>
37066>>>>>>>>>>>>>        // Gplan.Gplan_Addr
37066>>>>>>>>>>>>>
37066>>>>>>>>>>>>>        // Gplan.Gplan_Tk
37066>>>>>>>>>>>>>
37066>>>>>>>>>>>>>        // Gplan.Gplan_Poli
37066>>>>>>>>>>>>>
37066>>>>>>>>>>>>>        // Gplan.Gplan_Doy
37066>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Doy To "dbComboFormSub"
37067>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Doy To (Gplan_Gplan_Doy_VT(Self))
37068>>>>>>>>>>>>>
37068>>>>>>>>>>>>>        // Gplan.Gplan_J_Code
37068>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_J_Code To "dbComboFormSub"
37069>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_J_Code To (Gplan_Gplan_J_Code_VT(Self))
37070>>>>>>>>>>>>>
37070>>>>>>>>>>>>>        // Gplan.Gplan_C_Code2
37070>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_C_Code2 To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1019)"
37070>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_C_Code2 To "dbComboFormSub"
37071>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_C_Code2 To (Gplan_Gplan_C_Code2_VT(Self))
37072>>>>>>>>>>>>>
37072>>>>>>>>>>>>>        // Gplan.Gplan_Tel
37072>>>>>>>>>>>>>
37072>>>>>>>>>>>>>        // Gplan.Gplan_Email
37072>>>>>>>>>>>>>
37072>>>>>>>>>>>>>        // Gplan.Gplan_Resp
37072>>>>>>>>>>>>>
37072>>>>>>>>>>>>>        // Gplan.Gplan_Bitmap
37072>>>>>>>>>>>>>
37072>>>>>>>>>>>>>        // Gplan.Gplan_Rep_Code
37072>>>>>>>>>>>>>
37072>>>>>>>>>>>>>        // Gplan.Gplan_Rep_Pct
37072>>>>>>>>>>>>>
37072>>>>>>>>>>>>>        // Gplan.Gplan_I_Xy_Code
37072>>>>>>>>>>>>>
37072>>>>>>>>>>>>>        // Gplan.Gplan_I_Py_Code
37072>>>>>>>>>>>>>
37072>>>>>>>>>>>>>        // Gplan.Gplan_I_Ctypkin
37072>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_I_Ctypkin To (Gtypkin(Self))
37073>>>>>>>>>>>>>
37073>>>>>>>>>>>>>        // Gplan.Gplan_I_A_Code
37073>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_I_A_Code To "dbComboFormSub"
37074>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_I_A_Code To (Gplan_Gplan_I_A_Code_VT2(Self))
37075>>>>>>>>>>>>>
37075>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Myfp
37075>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Myfp To "dbComboFormSub"
37076>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Myfp To (Gplan_Gplan_Yn_VT(Self))
37077>>>>>>>>>>>>>
37077>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Myfa
37077>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Myfa To "dbComboFormSub"
37078>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Myfa To (Gplan_Gplan_Yn_VT(Self))
37079>>>>>>>>>>>>>
37079>>>>>>>>>>>>>        // Gplan.Gplan_Myfnump
37079>>>>>>>>>>>>>
37079>>>>>>>>>>>>>        // Gplan.Gplan_Myfvalp
37079>>>>>>>>>>>>>
37079>>>>>>>>>>>>>        // Gplan.Gplan_Myfnuma
37079>>>>>>>>>>>>>
37079>>>>>>>>>>>>>        // Gplan.Gplan_Myfvala
37079>>>>>>>>>>>>>
37079>>>>>>>>>>>>>        // Gplan.Gplan_Myf_Sump
37079>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Myf_Sump To "‰˜Ÿ¦¨åœ  œá¤ ¦  ®¨œé©œ ª/§ ©«é©œ ª Ÿ˜ ˜Ÿ¨¦ ©«¦ç¤ ©«ž¤ ‹“”"
37079>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Myf_Sump To "dbComboFormSub"
37080>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Myf_Sump To (Gplan_Gplan_Myf_Sum_VT(Self))
37081>>>>>>>>>>>>>
37081>>>>>>>>>>>>>        // Gplan.Gplan_Myf_Suma
37081>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Myf_Suma To "dbComboFormSub"
37082>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Myf_Suma To (Gplan_Gplan_Myf_Sum_VT(Self))
37083>>>>>>>>>>>>>
37083>>>>>>>>>>>>>        // Gplan.Gplan_Sx0
37083>>>>>>>>>>>>>
37083>>>>>>>>>>>>>        // Gplan.Gplan_Sp0
37083>>>>>>>>>>>>>
37083>>>>>>>>>>>>>        // Gplan.Gplan_Sx00
37083>>>>>>>>>>>>>
37083>>>>>>>>>>>>>        // Gplan.Gplan_Sp00
37083>>>>>>>>>>>>>
37083>>>>>>>>>>>>>        // Gplan.Gplan_Sxr
37083>>>>>>>>>>>>>
37083>>>>>>>>>>>>>        // Gplan.Gplan_Spr
37083>>>>>>>>>>>>>
37083>>>>>>>>>>>>>        // Gplan.Gplan_Sx2
37083>>>>>>>>>>>>>
37083>>>>>>>>>>>>>        // Gplan.Gplan_Sp2
37083>>>>>>>>>>>>>
37083>>>>>>>>>>>>>        // Gplan.Gplan_Gmhnnorec
37083>>>>>>>>>>>>>
37083>>>>>>>>>>>>>        // Gplan.Gplan_Recr
37083>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Recr To (sl150(Self))
37084>>>>>>>>>>>>>
37084>>>>>>>>>>>>>        //DDB-DefineFieldEnd
37084>>>>>>>>>>>>>    End_Procedure    // Define_Fields
37085>>>>>>>>>>>>>
37085>>>>>>>>>>>>>    // Field_Defaults:
37085>>>>>>>>>>>>>    // This procedure is used to establish default field values.
37085>>>>>>>>>>>>>
37085>>>>>>>>>>>>>    Procedure Field_Defaults
37086>>>>>>>>>>>>>        Forward Send Field_Defaults
37088>>>>>>>>>>>>>        //DDB-Generated-Code-Location
37088>>>>>>>>>>>>>        //DDB-FieldDefaultStart
37088>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Xfer To 0
37089>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Last To 0
37090>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Kin To 1
37091>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Kk To 0
37092>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Xpm To 3
37093>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Xy To 1
37094>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Py To 1
37095>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Fpaent_Yn To 0
37096>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Rep_Pct To 100
37097>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Myfp To 0
37098>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Myfa To 0
37099>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
37099>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
37100>>>>>>>>>>>>>End_Class    // Gplan_DataDictionary
37101>>>>>>>>>>>>>
37101>>>>>>>>>>>>>
37101>>>>>>>>>>>>>
37101>>>>>>>>>>>>>
37101>>>>>>>>>>>>>
37101>>>>>>>>>>>>>
37101>>>>>>>>>>>>>
37101>>>>>>>>>>>>>
37101>>>>>>>>>>>>>
37101>>>>>>>>>>>>>
37101>>>>>>>>>>>>>
37101>>>>>>>>>>>>>
37101>>>>>>>>>>>>>
37101>>>>>>>>>>>>>
37101>>>>>>>>>>>>>//DDB-Selection-pkg-Start
37101>>>>>>>>>>>>>
37101>>>>>>>>>>>>>Use sl150.sl         // sl150
37101>>>>>>>>>>>>>Use Gtypkin.sl       // Gtypkin
INCLUDING FILE: GTYPKIN.SL
37101>>>>>>>>>>>>>>>//AB/ Project gtypkin:Gtypkin
37101>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
37101>>>>>>>>>>>>>>>//AB/     Set ProjectName to "gtypkin:Gtypkin"
37101>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "gtypkin.SL"
37101>>>>>>>>>>>>>>>
37101>>>>>>>>>>>>>>>// Project Object Structure
37101>>>>>>>>>>>>>>>//   gtypkin is a dbModalPanel
37101>>>>>>>>>>>>>>>//     Gthhmgio_DD is a DataDictionary
37101>>>>>>>>>>>>>>>//     Gtypkin_DD is a DataDictionary
37101>>>>>>>>>>>>>>>//     oSelList is a dbList
37101>>>>>>>>>>>>>>>//     oOK_bn is a Button
37101>>>>>>>>>>>>>>>//     oCancel_bn is a Button
37101>>>>>>>>>>>>>>>//     oSearch_bn is a Button
37101>>>>>>>>>>>>>>>
37101>>>>>>>>>>>>>>>// Register all objects
37101>>>>>>>>>>>>>>>Register_Object Gthhmgio_DD
37101>>>>>>>>>>>>>>>Register_Object Gtypkin_DD
37101>>>>>>>>>>>>>>>Register_Object gtypkin
37101>>>>>>>>>>>>>>>Register_Object oCancel_bn
37101>>>>>>>>>>>>>>>Register_Object oOK_bn
37101>>>>>>>>>>>>>>>Register_Object oSearch_bn
37101>>>>>>>>>>>>>>>Register_Object oSelList
37101>>>>>>>>>>>>>>>
37101>>>>>>>>>>>>>>>
37101>>>>>>>>>>>>>>>//AB-IgnoreStart
37101>>>>>>>>>>>>>>>
37101>>>>>>>>>>>>>>>Use DFAllEnt.pkg
37101>>>>>>>>>>>>>>>
37101>>>>>>>>>>>>>>>
37101>>>>>>>>>>>>>>>Use GTHHMGIO.DD
INCLUDING FILE: GTHHMGIO.DD
37101>>>>>>>>>>>>>>>>>//DDB-FileStart
37101>>>>>>>>>>>>>>>>>//DDB-HeaderStart
37101>>>>>>>>>>>>>>>>>
37101>>>>>>>>>>>>>>>>>// File Name : GTHHMGIO.DD
37101>>>>>>>>>>>>>>>>>// Class Name: Gthhmgio_DataDictionary
37101>>>>>>>>>>>>>>>>>// Revision  : 33
37101>>>>>>>>>>>>>>>>>// Version   : 2
37101>>>>>>>>>>>>>>>>>
37101>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
37101>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
37101>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
37101>>>>>>>>>>>>>>>>>
37101>>>>>>>>>>>>>>>>>Open Gthhmgio
INCLUDING FILE: GTHHMGIO.FD
37103>>>>>>>>>>>>>>>>>Open Gtypkin
INCLUDING FILE: GTYPKIN.FD
37105>>>>>>>>>>>>>>>>>Open Gthaa
INCLUDING FILE: GTHAA.FD
37107>>>>>>>>>>>>>>>>>Open Sysrecg
37109>>>>>>>>>>>>>>>>>
37109>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
37109>>>>>>>>>>>>>>>>>//DDB-ValidationStart
37109>>>>>>>>>>>>>>>>>
37109>>>>>>>>>>>>>>>>>Register_Object Gthhmgio_Gthhmgio_Period_VT
37109>>>>>>>>>>>>>>>>>
37109>>>>>>>>>>>>>>>>>Object Gthhmgio_Gthhmgio_Period_VT  is a CodeValidationTable
37111>>>>>>>>>>>>>>>>>    Set Type_Value        To "PERIOD"
37112>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
37112>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
37112>>>>>>>>>>>>>>>>>End_Object   // Gthhmgio_Gthhmgio_Period_VT
37113>>>>>>>>>>>>>>>>>//DDB-ValidationEnd
37113>>>>>>>>>>>>>>>>>//DDB-SelectionStart
37113>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList Gthhmgio  Gthhmgio.SL
37113>>>>>>>>>>>>>>>>>Register_Object Gthhmgio
37113>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
37113>>>>>>>>>>>>>>>>>
37113>>>>>>>>>>>>>>>>>Class Gthhmgio_DataDictionary  is a DataDictionary_Sec
37114>>>>>>>>>>>>>>>>>
37114>>>>>>>>>>>>>>>>>
37114>>>>>>>>>>>>>>>>>    // Define_Fields:
37114>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
37114>>>>>>>>>>>>>>>>>
37114>>>>>>>>>>>>>>>>>    Procedure Define_Fields
37115>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
37117>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
37117>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
37117>>>>>>>>>>>>>>>>>
37117>>>>>>>>>>>>>>>>>        Set Main_File            To Gthhmgio.File_Number
37118>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
37119>>>>>>>>>>>>>>>>>
37119>>>>>>>>>>>>>>>>>
37119>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
37119>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gtypkin.File_Number
37120>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gthaa.File_Number
37121>>>>>>>>>>>>>>>>>
37121>>>>>>>>>>>>>>>>>        // External (System) file structure.............
37121>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
37122>>>>>>>>>>>>>>>>>
37122>>>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gthhmgio_Rec0  To Gthhmgio.Gthhmgio_Rec0
37125>>>>>>>>>>>>>>>>>
37125>>>>>>>>>>>>>>>>>        // Field-based properties.......................
37125>>>>>>>>>>>>>>>>>
37125>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Code
37125>>>>>>>>>>>>>>>>>        Set Field_Options          Field Gthhmgio.Gthhmgio_Code To DD_AUTOFIND   
37126>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gthhmgio.Gthhmgio_Code To (Gthhmgio(Self))
37127>>>>>>>>>>>>>>>>>        Set Key_Field_State        Field Gthhmgio.Gthhmgio_Code To TRUE
37128>>>>>>>>>>>>>>>>>
37128>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Rec0
37128>>>>>>>>>>>>>>>>>
37128>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Descr
37128>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gthhmgio.Gthhmgio_Descr To (Gthhmgio(Self))
37129>>>>>>>>>>>>>>>>>
37129>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Period
37129>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gthhmgio.Gthhmgio_Period To (Gthhmgio_Gthhmgio_Period_VT(Self))
37130>>>>>>>>>>>>>>>>>
37130>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Recr
37130>>>>>>>>>>>>>>>>>        Set Field_Options          Field Gthhmgio.Gthhmgio_Recr To DD_AUTOFIND   
37131>>>>>>>>>>>>>>>>>        Set Key_Field_State        Field Gthhmgio.Gthhmgio_Recr To TRUE
37132>>>>>>>>>>>>>>>>>
37132>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
37132>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
37133>>>>>>>>>>>>>>>>>
37133>>>>>>>>>>>>>>>>>    // Field_Defaults:
37133>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
37133>>>>>>>>>>>>>>>>>
37133>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
37134>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
37136>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
37136>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
37136>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
37136>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
37137>>>>>>>>>>>>>>>>>End_Class    // Gthhmgio_DataDictionary
37138>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
37138>>>>>>>>>>>>>>>>>
37138>>>>>>>>>>>>>>>>>Use Gthhmgio.SL      // Gthhmgio
INCLUDING FILE: GTHHMGIO.SL
37138>>>>>>>>>>>>>>>>>>>//AB/ Project Gthhmgio:Gthhmgio
37138>>>>>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
37138>>>>>>>>>>>>>>>>>>>//AB/         Set ProjectName to "Gthhmgio:Gthhmgio"
37138>>>>>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "Gthhmgio.SL"
37138>>>>>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
37138>>>>>>>>>>>>>>>>>>>
37138>>>>>>>>>>>>>>>>>>>// Project Object Structure
37138>>>>>>>>>>>>>>>>>>>//   Gthhmgio is a dbModalPanel
37138>>>>>>>>>>>>>>>>>>>//     Gthhmgio_DD is a DataDictionary
37138>>>>>>>>>>>>>>>>>>>//     oSelList is a dbList
37138>>>>>>>>>>>>>>>>>>>//     oOK_bn is a Button
37138>>>>>>>>>>>>>>>>>>>//     oCancel_bn is a Button
37138>>>>>>>>>>>>>>>>>>>//     oSearch_bn is a Button
37138>>>>>>>>>>>>>>>>>>>
37138>>>>>>>>>>>>>>>>>>>// Register all objects
37138>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio_DD
37138>>>>>>>>>>>>>>>>>>>Register_Object oCancel_bn
37138>>>>>>>>>>>>>>>>>>>Register_Object oOK_bn
37138>>>>>>>>>>>>>>>>>>>Register_Object oSearch_bn
37138>>>>>>>>>>>>>>>>>>>Register_Object oSelList
37138>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio
37138>>>>>>>>>>>>>>>>>>>
37138>>>>>>>>>>>>>>>>>>>
37138>>>>>>>>>>>>>>>>>>>    //AB-IgnoreStart
37138>>>>>>>>>>>>>>>>>>>
37138>>>>>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
37138>>>>>>>>>>>>>>>>>>>
37138>>>>>>>>>>>>>>>>>>>
37138>>>>>>>>>>>>>>>>>>>    Use GTHHMGIO.DD
37138>>>>>>>>>>>>>>>>>>>
37138>>>>>>>>>>>>>>>>>>>    //AB-IgnoreEnd
37138>>>>>>>>>>>>>>>>>>>
37138>>>>>>>>>>>>>>>>>>>    CD_Popup_Object Gthhmgio is a dbModalPanel
37157>>>>>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
37158>>>>>>>>>>>>>>>>>>>        Set Label to "Šå©«˜ †£œ¨¦¢¦šåà¤"
37159>>>>>>>>>>>>>>>>>>>        Set Size to 148 297
37160>>>>>>>>>>>>>>>>>>>        Set Location to 4 5
37161>>>>>>>>>>>>>>>>>>>
37161>>>>>>>>>>>>>>>>>>>        //AB-DDOStart
37161>>>>>>>>>>>>>>>>>>>
37161>>>>>>>>>>>>>>>>>>>        Object Gthhmgio_DD is a Gthhmgio_DataDictionary
37163>>>>>>>>>>>>>>>>>>>        End_Object    // Gthhmgio_DD
37164>>>>>>>>>>>>>>>>>>>
37164>>>>>>>>>>>>>>>>>>>        Set Main_DD to (Gthhmgio_DD(self))
37165>>>>>>>>>>>>>>>>>>>        Set Server to (Gthhmgio_DD(self))
37166>>>>>>>>>>>>>>>>>>>
37166>>>>>>>>>>>>>>>>>>>        //AB-DDOEnd
37166>>>>>>>>>>>>>>>>>>>
37166>>>>>>>>>>>>>>>>>>>        Object oSelList is a dbList
37168>>>>>>>>>>>>>>>>>>>            Set Main_File to Gthhmgio.File_Number
37169>>>>>>>>>>>>>>>>>>>            Set Size to 105 280
37170>>>>>>>>>>>>>>>>>>>            Set Location to 6 6
37171>>>>>>>>>>>>>>>>>>>
37171>>>>>>>>>>>>>>>>>>>            Begin_Row
37174>>>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_code
37175>>>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_descr
37176>>>>>>>>>>>>>>>>>>>            End_Row
37181>>>>>>>>>>>>>>>>>>>
37181>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 52
37182>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
37183>>>>>>>>>>>>>>>>>>>
37183>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 220
37184>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
37185>>>>>>>>>>>>>>>>>>>
37185>>>>>>>>>>>>>>>>>>>        End_Object    // oSelList
37186>>>>>>>>>>>>>>>>>>>
37186>>>>>>>>>>>>>>>>>>>        Object oOK_bn is a Button
37188>>>>>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
37189>>>>>>>>>>>>>>>>>>>            Set Location to 111 127
37190>>>>>>>>>>>>>>>>>>>
37190>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
37190>>>>>>>>>>>>>>>>>>>            Procedure OnClick
37192>>>>>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
37193>>>>>>>>>>>>>>>>>>>            End_Procedure
37194>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
37194>>>>>>>>>>>>>>>>>>>
37194>>>>>>>>>>>>>>>>>>>        End_Object    // oOK_bn
37195>>>>>>>>>>>>>>>>>>>
37195>>>>>>>>>>>>>>>>>>>        Object oCancel_bn is a Button
37197>>>>>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
37198>>>>>>>>>>>>>>>>>>>            Set Location to 111 181
37199>>>>>>>>>>>>>>>>>>>
37199>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
37199>>>>>>>>>>>>>>>>>>>            Procedure OnClick
37201>>>>>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
37202>>>>>>>>>>>>>>>>>>>            End_Procedure
37203>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
37203>>>>>>>>>>>>>>>>>>>
37203>>>>>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
37204>>>>>>>>>>>>>>>>>>>
37204>>>>>>>>>>>>>>>>>>>        Object oSearch_bn is a Button
37206>>>>>>>>>>>>>>>>>>>            Set Label to "&€¤˜ã«ž©ž..."
37207>>>>>>>>>>>>>>>>>>>            Set Location to 111 237
37208>>>>>>>>>>>>>>>>>>>
37208>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
37208>>>>>>>>>>>>>>>>>>>            Procedure OnClick
37210>>>>>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
37211>>>>>>>>>>>>>>>>>>>            End_Procedure
37212>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
37212>>>>>>>>>>>>>>>>>>>
37212>>>>>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
37213>>>>>>>>>>>>>>>>>>>
37213>>>>>>>>>>>>>>>>>>>
37213>>>>>>>>>>>>>>>>>>>        //AB-StoreStart
37213>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
37214>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
37215>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
37216>>>>>>>>>>>>>>>>>>>        //AB-StoreEnd
37216>>>>>>>>>>>>>>>>>>>
37216>>>>>>>>>>>>>>>>>>>    CD_End_Object    // Gthhmgio
37218>>>>>>>>>>>>>>>>>>>>
37218>>>>>>>>>>>>>>>>>>>
37218>>>>>>>>>>>>>>>>>>>//AB/     End_Object    // prj
37218>>>>>>>>>>>>>>>>>
37218>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
37218>>>>>>>>>>>>>>>>>//DDB-FileEnd
37218>>>>>>>>>>>>>>>Use GTYPKIN.DD
INCLUDING FILE: GTYPKIN.DD
37218>>>>>>>>>>>>>>>>>//DDB-FileStart
37218>>>>>>>>>>>>>>>>>//DDB-HeaderStart
37218>>>>>>>>>>>>>>>>>
37218>>>>>>>>>>>>>>>>>// File Name : GTYPKIN.DD
37218>>>>>>>>>>>>>>>>>// Class Name: Gtypkin_DataDictionary
37218>>>>>>>>>>>>>>>>>// Revision  : 44
37218>>>>>>>>>>>>>>>>>// Version   : 2
37218>>>>>>>>>>>>>>>>>
37218>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
37218>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
37218>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
37218>>>>>>>>>>>>>>>>>
37218>>>>>>>>>>>>>>>>>Open Gtypkin
37220>>>>>>>>>>>>>>>>>Open Garticl
37222>>>>>>>>>>>>>>>>>Open Gflagkin
INCLUDING FILE: GFLAGKIN.FD
37224>>>>>>>>>>>>>>>>>Open Gparticl
INCLUDING FILE: GPARTICL.FD
37226>>>>>>>>>>>>>>>>>Open Gthhmgio
37228>>>>>>>>>>>>>>>>>Open Sysrecg
37230>>>>>>>>>>>>>>>>>
37230>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
37230>>>>>>>>>>>>>>>>>//DDB-SelectionStart
37230>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList gtypkin  gtypkin.SL
37230>>>>>>>>>>>>>>>>>Register_Object gtypkin
37230>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
37230>>>>>>>>>>>>>>>>>Open SysCurGL
37232>>>>>>>>>>>>>>>>>
37232>>>>>>>>>>>>>>>>>Class Gtypkin_DataDictionary  is a DataDictionary_Sec
37233>>>>>>>>>>>>>>>>>
37233>>>>>>>>>>>>>>>>>    Procedure Entry_Order_Date  Integer iField  Date dDate
37234>>>>>>>>>>>>>>>>>         // Add a default date if the field is blank
37234>>>>>>>>>>>>>>>>>         Integer Changed
37235>>>>>>>>>>>>>>>>>         Get Field_Changed_State iField to Changed
37236>>>>>>>>>>>>>>>>>         If (Changed=0 AND dDate =0) Begin
37238>>>>>>>>>>>>>>>>>             SysDate4 dDate
37239>>>>>>>>>>>>>>>>>             Set Field_Default_Value iField to dDate
37240>>>>>>>>>>>>>>>>>         End
37240>>>>>>>>>>>>>>>>>>
37240>>>>>>>>>>>>>>>>>    End_Procedure
37241>>>>>>>>>>>>>>>>>
37241>>>>>>>>>>>>>>>>>    Procedure Construct_Object
37242>>>>>>>>>>>>>>>>>        Forward Send Construct_Object
37244>>>>>>>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
37245>>>>>>>>>>>>>>>>>        Property Date    pdDefault_Hmnia    Public 0
37246>>>>>>>>>>>>>>>>>        Property Integer piRate             Public 0
37247>>>>>>>>>>>>>>>>>        Property Integer piGthhmgio_dd      Public 0
37248>>>>>>>>>>>>>>>>>    End_Procedure   // Construct_Object
37249>>>>>>>>>>>>>>>>>
37249>>>>>>>>>>>>>>>>>    Procedure OnConstrain
37250>>>>>>>>>>>>>>>>>        Forward Send OnConstrain
37252>>>>>>>>>>>>>>>>>        If (piMustNOTConstrain(Self)) Begin
37254>>>>>>>>>>>>>>>>>        End
37254>>>>>>>>>>>>>>>>>>
37254>>>>>>>>>>>>>>>>>        Else Begin
37255>>>>>>>>>>>>>>>>>            Constrain Gtypkin.Company_Code  eq SysCurGL.Company_Code
37257>>>>>>>>>>>>>>>>>            Constrain Gtypkin.Branch_Code   eq SysCurGL.Branch_Code
37259>>>>>>>>>>>>>>>>>            Constrain Gtypkin.Year_Year     eq SysCurGL.Year_Year
37261>>>>>>>>>>>>>>>>>        End
37261>>>>>>>>>>>>>>>>>>
37261>>>>>>>>>>>>>>>>>    End_Procedure
37262>>>>>>>>>>>>>>>>>
37262>>>>>>>>>>>>>>>>>    Procedure Update
37263>>>>>>>>>>>>>>>>>        Forward Send Update
37265>>>>>>>>>>>>>>>>>        // Insert Code Here
37265>>>>>>>>>>>>>>>>>        Move SysCurGL.Company_Code  to Gtypkin.Company_Code
37266>>>>>>>>>>>>>>>>>        Move SysCurGL.Branch_Code   to Gtypkin.Branch_Code
37267>>>>>>>>>>>>>>>>>        Move SysCurGL.Year_Year     to Gtypkin.Year_Year
37268>>>>>>>>>>>>>>>>>        Move SysCurGL.Year_Recr     to Gtypkin.Year_Recr
37269>>>>>>>>>>>>>>>>>        Move Gthhmgio.Gthhmgio_Code to Gtypkin.Gthhmgio_Code
37270>>>>>>>>>>>>>>>>>    End_Procedure   // Update
37271>>>>>>>>>>>>>>>>>
37271>>>>>>>>>>>>>>>>>    Procedure Creating
37272>>>>>>>>>>>>>>>>>        Forward Send Creating
37274>>>>>>>>>>>>>>>>>        // Insert Code Here
37274>>>>>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurGL.Branch_Site))+;                         (Trim(String(Gtypkin.Gtypkin_Rec0)))))) to Gtypkin.Gtypkin_Recr
37275>>>>>>>>>>>>>>>>>    End_Procedure   // Creating
37276>>>>>>>>>>>>>>>>>
37276>>>>>>>>>>>>>>>>>
37276>>>>>>>>>>>>>>>>>
37276>>>>>>>>>>>>>>>>>//----------------------------------------------------------------------------
37276>>>>>>>>>>>>>>>>>
37276>>>>>>>>>>>>>>>>>//    Procedure Creating
37276>>>>>>>>>>>>>>>>>//              Forward Send Creating
37276>>>>>>>>>>>>>>>>>//              Add 1 to Year.Year_NumGtypkin //˜¨ Ÿ£æª «ç§à¤ ¡ ¤ã©œà¤ «žª ®¨ã©žª
37276>>>>>>>>>>>>>>>>>//    End_Procedure //creating
37276>>>>>>>>>>>>>>>>>//    Procedure Deleting
37276>>>>>>>>>>>>>>>>>//              Forward Send Deleting
37276>>>>>>>>>>>>>>>>>//              Sub 1 from Year.Year_NumGtypkin //˜¨ Ÿ£æª «ç§à¤ ¡ ¤ã©œà¤ «žª ®¨ã©žª
37276>>>>>>>>>>>>>>>>>//    End_Procedure //deleting
37276>>>>>>>>>>>>>>>>>
37276>>>>>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
37277>>>>>>>>>>>>>>>>>        Integer iReturnVal
37278>>>>>>>>>>>>>>>>>        Forward Get Validate_Save To iReturnVal
37280>>>>>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
37282>>>>>>>>>>>>>>>>>            //1100:cby = globals
37282>>>>>>>>>>>>>>>>>            If ( ;                (Not(Gtypkin.Company_Code = SysCurGL.Company_Code)) or;                (Not(Gtypkin.Branch_Code  = SysCurGL.Branch_Code )) or;                (Not(Gtypkin.Year_Year    = SysCurGL.Year_Year   ));                ) Send Operation_Not_Allowed 1100
37285>>>>>>>>>>>>>>>>>        End
37285>>>>>>>>>>>>>>>>>>
37285>>>>>>>>>>>>>>>>>        Function_Return iReturnVal
37286>>>>>>>>>>>>>>>>>    End_Function   //validate_save
37287>>>>>>>>>>>>>>>>>
37287>>>>>>>>>>>>>>>>>
37287>>>>>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
37288>>>>>>>>>>>>>>>>>        Integer iReturnVal
37289>>>>>>>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
37291>>>>>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
37293>>>>>>>>>>>>>>>>>            //2100:cby = globals
37293>>>>>>>>>>>>>>>>>            If ( ;                (Not(Gtypkin.Company_Code = SysCurGL.Company_Code)) or;                (Not(Gtypkin.Branch_Code  = SysCurGL.Branch_Code )) or;                (Not(Gtypkin.Year_Year    = SysCurGL.Year_Year   ));                ) Send Operation_Not_Allowed 2100
37296>>>>>>>>>>>>>>>>>        End
37296>>>>>>>>>>>>>>>>>>
37296>>>>>>>>>>>>>>>>>        Function_Return iReturnVal
37297>>>>>>>>>>>>>>>>>    End_Function   // validate_delete
37298>>>>>>>>>>>>>>>>>
37298>>>>>>>>>>>>>>>>>
37298>>>>>>>>>>>>>>>>>
37298>>>>>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
37299>>>>>>>>>>>>>>>>>              Case Begin
37299>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1100)
37301>>>>>>>>>>>>>>>>>                        Error 1100 "DDC 151:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
37302>>>>>>>>>>>>>>>>>>
37302>>>>>>>>>>>>>>>>>                        Case Break
37303>>>>>>>>>>>>>>>>>                   Case (iError_Num = 2100)
37306>>>>>>>>>>>>>>>>>                        Error 2100 "DDC 151:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
37307>>>>>>>>>>>>>>>>>>
37307>>>>>>>>>>>>>>>>>                        Case Break
37308>>>>>>>>>>>>>>>>>                   Case Else
37308>>>>>>>>>>>>>>>>>                        Forward Send Operation_Not_Allowed  iError_Num
37310>>>>>>>>>>>>>>>>>              Case End
37310>>>>>>>>>>>>>>>>>    End_Procedure   //operation_not_allowed
37311>>>>>>>>>>>>>>>>>
37311>>>>>>>>>>>>>>>>>
37311>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
37312>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
37314>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
37314>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
37314>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
37314>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
37315>>>>>>>>>>>>>>>>>
37315>>>>>>>>>>>>>>>>>
37315>>>>>>>>>>>>>>>>>
37315>>>>>>>>>>>>>>>>>    // Define_Fields:
37315>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
37315>>>>>>>>>>>>>>>>>
37315>>>>>>>>>>>>>>>>>    Procedure Define_Fields
37316>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
37318>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
37318>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
37318>>>>>>>>>>>>>>>>>
37318>>>>>>>>>>>>>>>>>        Set Main_File            To Gtypkin.File_Number
37319>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
37320>>>>>>>>>>>>>>>>>
37320>>>>>>>>>>>>>>>>>
37320>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
37320>>>>>>>>>>>>>>>>>        Send Add_Client_File  Garticl.File_Number
37321>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gflagkin.File_Number
37322>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gparticl.File_Number
37323>>>>>>>>>>>>>>>>>
37323>>>>>>>>>>>>>>>>>        // Parent (Server) file structure...............
37323>>>>>>>>>>>>>>>>>        Send Add_Server_File  Gthhmgio.File_Number
37324>>>>>>>>>>>>>>>>>
37324>>>>>>>>>>>>>>>>>        // External (System) file structure.............
37324>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
37325>>>>>>>>>>>>>>>>>
37325>>>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gtypkin_Rec0  To Gtypkin.Gtypkin_Rec0
37328>>>>>>>>>>>>>>>>>
37328>>>>>>>>>>>>>>>>>        // Field-based properties.......................
37328>>>>>>>>>>>>>>>>>
37328>>>>>>>>>>>>>>>>>        // Gtypkin.Company_Code
37328>>>>>>>>>>>>>>>>>
37328>>>>>>>>>>>>>>>>>        // Gtypkin.Branch_Code
37328>>>>>>>>>>>>>>>>>
37328>>>>>>>>>>>>>>>>>        // Gtypkin.Year_Year
37328>>>>>>>>>>>>>>>>>
37328>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Code
37328>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gtypkin.Gtypkin_Code To (gtypkin(Self))
37329>>>>>>>>>>>>>>>>>
37329>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Rec0
37329>>>>>>>>>>>>>>>>>
37329>>>>>>>>>>>>>>>>>        // Gtypkin.Year_Recr
37329>>>>>>>>>>>>>>>>>
37329>>>>>>>>>>>>>>>>>        // Gtypkin.Gthhmgio_Code
37329>>>>>>>>>>>>>>>>>
37329>>>>>>>>>>>>>>>>>        // Gtypkin.Gthhmgio_Recr
37329>>>>>>>>>>>>>>>>>
37329>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Descr
37329>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gtypkin.Gtypkin_Descr To (gtypkin(Self))
37330>>>>>>>>>>>>>>>>>
37330>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Anti
37330>>>>>>>>>>>>>>>>>
37330>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Printer
37330>>>>>>>>>>>>>>>>>
37330>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Form
37330>>>>>>>>>>>>>>>>>
37330>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_L_No
37330>>>>>>>>>>>>>>>>>
37330>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_L_Hmnia
37330>>>>>>>>>>>>>>>>>
37330>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Seira
37330>>>>>>>>>>>>>>>>>
37330>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Abr
37330>>>>>>>>>>>>>>>>>
37330>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag01
37330>>>>>>>>>>>>>>>>>
37330>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag02
37330>>>>>>>>>>>>>>>>>
37330>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag03
37330>>>>>>>>>>>>>>>>>
37330>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag04
37330>>>>>>>>>>>>>>>>>
37330>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag05
37330>>>>>>>>>>>>>>>>>
37330>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag06
37330>>>>>>>>>>>>>>>>>
37330>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag07
37330>>>>>>>>>>>>>>>>>
37330>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag08
37330>>>>>>>>>>>>>>>>>
37330>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag09
37330>>>>>>>>>>>>>>>>>
37330>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag10
37330>>>>>>>>>>>>>>>>>
37330>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag11
37330>>>>>>>>>>>>>>>>>
37330>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag12
37330>>>>>>>>>>>>>>>>>
37330>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag13
37330>>>>>>>>>>>>>>>>>
37330>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag14
37330>>>>>>>>>>>>>>>>>
37330>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag15
37330>>>>>>>>>>>>>>>>>
37330>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag16
37330>>>>>>>>>>>>>>>>>
37330>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag17
37330>>>>>>>>>>>>>>>>>
37330>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag18
37330>>>>>>>>>>>>>>>>>
37330>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag19
37330>>>>>>>>>>>>>>>>>
37330>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag20
37330>>>>>>>>>>>>>>>>>
37330>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Recr
37330>>>>>>>>>>>>>>>>>
37330>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
37330>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
37331>>>>>>>>>>>>>>>>>End_Class    // Gtypkin_DataDictionary
37332>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
37332>>>>>>>>>>>>>>>>>
37332>>>>>>>>>>>>>>>>>Use gtypkin.SL       // gtypkin
37332>>>>>>>>>>>>>>>>>
37332>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
37332>>>>>>>>>>>>>>>>>//DDB-FileEnd
37332>>>>>>>>>>>>>>>
37332>>>>>>>>>>>>>>>//AB-IgnoreEnd
37332>>>>>>>>>>>>>>>
37332>>>>>>>>>>>>>>>CD_Popup_Object gtypkin is a dbModalPanel
37351>>>>>>>>>>>>>>>    Set Minimize_Icon to FALSE
37352>>>>>>>>>>>>>>>    Set Label to "Šå©«˜ ‰ ¤ã©œà¤"
37353>>>>>>>>>>>>>>>    Set Size to 148 467
37354>>>>>>>>>>>>>>>    Set Location to 4 5
37355>>>>>>>>>>>>>>>
37355>>>>>>>>>>>>>>>    //AB-DDOStart
37355>>>>>>>>>>>>>>>
37355>>>>>>>>>>>>>>>    Object Gthhmgio_DD is a Gthhmgio_DataDictionary
37357>>>>>>>>>>>>>>>    End_Object    // Gthhmgio_DD
37358>>>>>>>>>>>>>>>
37358>>>>>>>>>>>>>>>    Object Gtypkin_DD is a Gtypkin_DataDictionary
37360>>>>>>>>>>>>>>>        Set DDO_Server to (Gthhmgio_DD(self))
37361>>>>>>>>>>>>>>>    End_Object    // Gtypkin_DD
37362>>>>>>>>>>>>>>>
37362>>>>>>>>>>>>>>>    Set Main_DD to (Gtypkin_DD(self))
37363>>>>>>>>>>>>>>>    Set Server to (Gtypkin_DD(self))
37364>>>>>>>>>>>>>>>
37364>>>>>>>>>>>>>>>    //AB-DDOEnd
37364>>>>>>>>>>>>>>>
37364>>>>>>>>>>>>>>>    Object oSelList is a dbList
37366>>>>>>>>>>>>>>>        Set Main_File to Gtypkin.File_Number
37367>>>>>>>>>>>>>>>        Set Size to 105 450
37368>>>>>>>>>>>>>>>        Set Location to 6 6
37369>>>>>>>>>>>>>>>
37369>>>>>>>>>>>>>>>        Begin_Row
37372>>>>>>>>>>>>>>>            Entry_Item Gtypkin.Gtypkin_code
37373>>>>>>>>>>>>>>>            Entry_Item Gtypkin.Gtypkin_descr
37374>>>>>>>>>>>>>>>            Entry_Item Gtypkin.Gtypkin_anti
37375>>>>>>>>>>>>>>>            Entry_Item Gthhmgio.Gthhmgio_code
37376>>>>>>>>>>>>>>>            Entry_Item Gthhmgio.Gthhmgio_descr
37377>>>>>>>>>>>>>>>        End_Row
37382>>>>>>>>>>>>>>>
37382>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 40
37383>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
37384>>>>>>>>>>>>>>>        
37384>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 151
37385>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
37386>>>>>>>>>>>>>>>        
37386>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 98
37387>>>>>>>>>>>>>>>        Set Header_Label  item 2 to ""
37388>>>>>>>>>>>>>>>        
37388>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 55
37389>>>>>>>>>>>>>>>        Set Header_Label  item 3 to "‰à› ¡æª †£/š ¦¬"
37390>>>>>>>>>>>>>>>        
37390>>>>>>>>>>>>>>>        Set Form_Width    item 4 to 100
37391>>>>>>>>>>>>>>>        Set Header_Label  item 4 to "œ¨ š¨˜­ã †£/š ¦¬"
37392>>>>>>>>>>>>>>>        
37392>>>>>>>>>>>>>>>    End_Object    // oSelList
37393>>>>>>>>>>>>>>>
37393>>>>>>>>>>>>>>>    Object oOK_bn is a Button
37395>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
37396>>>>>>>>>>>>>>>        Set Location to 111 296
37397>>>>>>>>>>>>>>>
37397>>>>>>>>>>>>>>>        //AB-StoreStart
37397>>>>>>>>>>>>>>>        Procedure OnClick
37399>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
37400>>>>>>>>>>>>>>>        End_Procedure
37401>>>>>>>>>>>>>>>        //AB-StoreEnd
37401>>>>>>>>>>>>>>>
37401>>>>>>>>>>>>>>>    End_Object    // oOK_bn
37402>>>>>>>>>>>>>>>
37402>>>>>>>>>>>>>>>    Object oCancel_bn is a Button
37404>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
37405>>>>>>>>>>>>>>>        Set Location to 111 351
37406>>>>>>>>>>>>>>>
37406>>>>>>>>>>>>>>>        //AB-StoreStart
37406>>>>>>>>>>>>>>>        Procedure OnClick
37408>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
37409>>>>>>>>>>>>>>>        End_Procedure
37410>>>>>>>>>>>>>>>        //AB-StoreEnd
37410>>>>>>>>>>>>>>>
37410>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
37411>>>>>>>>>>>>>>>
37411>>>>>>>>>>>>>>>    Object oSearch_bn is a Button
37413>>>>>>>>>>>>>>>        Set Label to "&€¤˜ã«ž©ž..."
37414>>>>>>>>>>>>>>>        Set Location to 111 406
37415>>>>>>>>>>>>>>>
37415>>>>>>>>>>>>>>>        //AB-StoreStart
37415>>>>>>>>>>>>>>>        Procedure OnClick
37417>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
37418>>>>>>>>>>>>>>>        End_Procedure
37419>>>>>>>>>>>>>>>        //AB-StoreEnd
37419>>>>>>>>>>>>>>>
37419>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
37420>>>>>>>>>>>>>>>
37420>>>>>>>>>>>>>>>
37420>>>>>>>>>>>>>>>    //AB-StoreStart
37420>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
37421>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
37422>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
37423>>>>>>>>>>>>>>>    //AB-StoreEnd
37423>>>>>>>>>>>>>>>
37423>>>>>>>>>>>>>>>CD_End_Object    // gtypkin
37425>>>>>>>>>>>>>>>>
37425>>>>>>>>>>>>>>>
37425>>>>>>>>>>>>>>>//AB/ End_Object    // prj
37425>>>>>>>>>>>>>
37425>>>>>>>>>>>>>//DDB-Selection-pkg-End
37425>>>>>>>>>>>>>//DDB-FileEnd
37425>>>>>>>>>>>
37425>>>>>>>>>>>//AB-IgnoreEnd
37425>>>>>>>>>>>
37425>>>>>>>>>>>CD_Popup_Object sl150 is a dbModalPanel
37444>>>>>>>>>>>
37444>>>>>>>>>>>    //AB-StoreTopStart
37444>>>>>>>>>>>    Property Integer piFragmaLast -1
37446>>>>>>>>>>>    Property String  psFragmaFromCode ""
37448>>>>>>>>>>>    Property String  psFragmaToCode ""
37450>>>>>>>>>>>    
37450>>>>>>>>>>>    //AB-StoreTopEnd
37450>>>>>>>>>>>
37450>>>>>>>>>>>    Set Minimize_Icon to FALSE
37451>>>>>>>>>>>    Set Label to "Šå©«˜ Š¦š˜¨ ˜©£é¤"
37452>>>>>>>>>>>    Set Size to 204 393
37453>>>>>>>>>>>    Set Location to 5 16
37454>>>>>>>>>>>
37454>>>>>>>>>>>    //AB-DDOStart
37454>>>>>>>>>>>
37454>>>>>>>>>>>    Object Gplan_DD is a Gplan_DataDictionary
37456>>>>>>>>>>>
37456>>>>>>>>>>>        //AB-StoreStart
37456>>>>>>>>>>>                                                    
37456>>>>>>>>>>>        Procedure OnConstrain
37458>>>>>>>>>>>            Integer liFragmaLast
37459>>>>>>>>>>>            String lsFragmaFromCode lsFragmaToCode
37459>>>>>>>>>>>            Get piFragmaLast     to liFragmaLast
37460>>>>>>>>>>>            Get psFragmaFromCode to lsFragmaFromCode
37461>>>>>>>>>>>            Get psFragmaToCode   to lsFragmaToCode
37462>>>>>>>>>>>            If (liFragmaLast <> -1)     Constrain Gplan.Gplan_Yn_Last eq liFragmaLast
37466>>>>>>>>>>>            If (lsFragmaFromCode <> "") Constrain Gplan.Gplan_Code    ge lsFragmaFromCode
37470>>>>>>>>>>>            If (lsFragmaToCode <> "")   Constrain Gplan.Gplan_Code    le lsFragmaToCode
37474>>>>>>>>>>>        End_Procedure // OnConstrain
37475>>>>>>>>>>>        
37475>>>>>>>>>>>        
37475>>>>>>>>>>>        //AB-StoreEnd
37475>>>>>>>>>>>
37475>>>>>>>>>>>    End_Object    // Gplan_DD
37476>>>>>>>>>>>
37476>>>>>>>>>>>    Set Main_DD to (Gplan_DD(self))
37477>>>>>>>>>>>    Set Server to (Gplan_DD(self))
37478>>>>>>>>>>>
37478>>>>>>>>>>>    //AB-DDOEnd
37478>>>>>>>>>>>
37478>>>>>>>>>>>    Object oSelList is a dbList
37480>>>>>>>>>>>        Set Main_File to Gplan.File_Number
37481>>>>>>>>>>>        Set Size to 164 378
37482>>>>>>>>>>>        Set Location to 4 6
37483>>>>>>>>>>>
37483>>>>>>>>>>>        Begin_Row
37486>>>>>>>>>>>            Entry_Item Gplan.Gplan_code
37487>>>>>>>>>>>            Entry_Item Gplan.Gplan_descr1
37488>>>>>>>>>>>            Entry_Item Gplan.Gplan_bathmos
37489>>>>>>>>>>>            Entry_Item Gplan.Gplan_yn_last
37490>>>>>>>>>>>        End_Row
37495>>>>>>>>>>>
37495>>>>>>>>>>>        Set Form_Width    item 0 to 105
37496>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
37497>>>>>>>>>>>        
37497>>>>>>>>>>>        Set Form_Width    item 1 to 212
37498>>>>>>>>>>>        Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
37499>>>>>>>>>>>        
37499>>>>>>>>>>>        Set Form_Width    item 2 to 34
37500>>>>>>>>>>>        Set Header_Label  item 2 to "˜Ÿ£æª"
37501>>>>>>>>>>>        
37501>>>>>>>>>>>        Set Form_Width    item 3 to 19
37502>>>>>>>>>>>        Set Header_Label  item 3 to " ’"
37503>>>>>>>>>>>        Set Column_Checkbox_State  item 3 to True
37504>>>>>>>>>>>        
37504>>>>>>>>>>>
37504>>>>>>>>>>>        //AB-StoreStart
37504>>>>>>>>>>>                                                    
37504>>>>>>>>>>>        Property String piStoredFragmaLast -1
37506>>>>>>>>>>>        Property String psStoredFragmaFromCode ""
37508>>>>>>>>>>>        Property String psStoredFragmaToCode ""
37510>>>>>>>>>>>        
37510>>>>>>>>>>>        Procedure Store_Defaults
37512>>>>>>>>>>>            forward send Store_Defaults
37514>>>>>>>>>>>            Set piStoredFragmaLast     to (piFragmaLast(Self))
37515>>>>>>>>>>>            Set psStoredFragmaFromCode to (psFragmaFromCode(Self))
37516>>>>>>>>>>>            Set psStoredFragmaToCode   to (psFragmaToCode(Self))
37517>>>>>>>>>>>        end_Procedure // Store_Defaults
37518>>>>>>>>>>>        
37518>>>>>>>>>>>        Procedure Restore_Defaults
37520>>>>>>>>>>>            forward send Restore_Defaults
37522>>>>>>>>>>>            Set piFragmaLast     to (piStoredFragmaLast(self))
37523>>>>>>>>>>>            Set psFragmaFromCode to (psStoredFragmaFromCode(self))
37524>>>>>>>>>>>            Set psFragmaToCode   to (psStoredFragmaToCode(self))
37525>>>>>>>>>>>        end_Procedure // Restore_Defaults
37526>>>>>>>>>>>        
37526>>>>>>>>>>>        Procedure Activating
37528>>>>>>>>>>>            Forward Send Activating
37530>>>>>>>>>>>            Send Rebuild_Constraints to (Gplan_DD(self))
37531>>>>>>>>>>>        End_Procedure // Activating
37532>>>>>>>>>>>        
37532>>>>>>>>>>>        
37532>>>>>>>>>>>        
37532>>>>>>>>>>>        
37532>>>>>>>>>>>        //AB-StoreEnd
37532>>>>>>>>>>>
37532>>>>>>>>>>>    End_Object    // oSelList
37533>>>>>>>>>>>
37533>>>>>>>>>>>    Object oOK_bn is a Button
37535>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
37536>>>>>>>>>>>        Set Location to 170 226
37537>>>>>>>>>>>
37537>>>>>>>>>>>        //AB-StoreStart
37537>>>>>>>>>>>        Procedure OnClick
37539>>>>>>>>>>>            Send OK To (oSelList(current_object))
37540>>>>>>>>>>>        End_Procedure
37541>>>>>>>>>>>        //AB-StoreEnd
37541>>>>>>>>>>>
37541>>>>>>>>>>>    End_Object    // oOK_bn
37542>>>>>>>>>>>
37542>>>>>>>>>>>    Object oCancel_bn is a Button
37544>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
37545>>>>>>>>>>>        Set Location to 170 279
37546>>>>>>>>>>>
37546>>>>>>>>>>>        //AB-StoreStart
37546>>>>>>>>>>>        Procedure OnClick
37548>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
37549>>>>>>>>>>>        End_Procedure
37550>>>>>>>>>>>        //AB-StoreEnd
37550>>>>>>>>>>>
37550>>>>>>>>>>>    End_Object    // oCancel_bn
37551>>>>>>>>>>>
37551>>>>>>>>>>>    Object oSearch_bn is a Button
37553>>>>>>>>>>>        Set Label to "&€¤˜ã«ž©ž..."
37554>>>>>>>>>>>        Set Location to 170 334
37555>>>>>>>>>>>
37555>>>>>>>>>>>        //AB-StoreStart
37555>>>>>>>>>>>        Procedure OnClick
37557>>>>>>>>>>>            Send Search To (oSelList(current_object))
37558>>>>>>>>>>>        End_Procedure
37559>>>>>>>>>>>        //AB-StoreEnd
37559>>>>>>>>>>>
37559>>>>>>>>>>>    End_Object    // oSearch_bn
37560>>>>>>>>>>>
37560>>>>>>>>>>>
37560>>>>>>>>>>>    //AB-StoreStart
37560>>>>>>>>>>>                            
37560>>>>>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
37561>>>>>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
37562>>>>>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
37563>>>>>>>>>>>    
37563>>>>>>>>>>>    
37563>>>>>>>>>>>    
37563>>>>>>>>>>>    //AB-StoreEnd
37563>>>>>>>>>>>
37563>>>>>>>>>>>CD_End_Object    // sl150
37565>>>>>>>>>>>>
37565>>>>>>>>>>>
37565>>>>>>>>>>>//AB/ End_Object    // prj
37565>>>>>>>>>
37565>>>>>>>>>//DDB-Selection-pkg-End
37565>>>>>>>>>//DDB-FileEnd
37565>>>>>>>    Use UNITS.DD
INCLUDING FILE: UNITS.DD
37565>>>>>>>>>//DDB-FileStart
37565>>>>>>>>>//DDB-HeaderStart
37565>>>>>>>>>
37565>>>>>>>>>// File Name : UNITS.DD
37565>>>>>>>>>// Class Name: Units_DataDictionary
37565>>>>>>>>>// Revision  : 17
37565>>>>>>>>>// Version   : 2
37565>>>>>>>>>
37565>>>>>>>>>Use  Windows           // Basic Definitions
37565>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
37565>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
37565>>>>>>>>>
37565>>>>>>>>>Open Units
INCLUDING FILE: UNITS.FD
37567>>>>>>>>>Open Item
37569>>>>>>>>>Open Sysrecw
37571>>>>>>>>>Open Syscurxr
37573>>>>>>>>>
37573>>>>>>>>>//DDB-HeaderEnd
37573>>>>>>>>>//DDB-SelectionStart
37573>>>>>>>>>//DDB/ ExternalSelectionList sl025  sl025.SL
37573>>>>>>>>>Register_Object sl025
37573>>>>>>>>>//DDB-SelectionEnd
37573>>>>>>>>>
37573>>>>>>>>>Class Units_DataDictionary  is a DataDictionary
37574>>>>>>>>>
37574>>>>>>>>>    Procedure Save_Main_File
37575>>>>>>>>>        If (Operation_Origin<>Self) Begin
37577>>>>>>>>>            If Units.Recnum Eq 0 Procedure_Return
37580>>>>>>>>>        End
37580>>>>>>>>>>
37580>>>>>>>>>        Forward Send Save_Main_File
37582>>>>>>>>>    End_Procedure
37583>>>>>>>>>
37583>>>>>>>>>
37583>>>>>>>>>     Procedure Creating
37584>>>>>>>>>        Forward Send Creating
37586>>>>>>>>>        // Insert Code Here
37586>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Units.Units_Rec0)))))) to Units.Units_Recr
37587>>>>>>>>>    End_Procedure   // Creating
37588>>>>>>>>>
37588>>>>>>>>>
37588>>>>>>>>>
37588>>>>>>>>>    // Define_Fields:
37588>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
37588>>>>>>>>>
37588>>>>>>>>>    Procedure Define_Fields
37589>>>>>>>>>        Forward Send Define_Fields
37591>>>>>>>>>        //DDB-Generated-Code-Location
37591>>>>>>>>>        //DDB-DefineFieldStart
37591>>>>>>>>>
37591>>>>>>>>>        Set Main_File            To Units.File_Number
37592>>>>>>>>>        Set Cascade_Delete_State To FALSE
37593>>>>>>>>>
37593>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
37594>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
37595>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
37596>>>>>>>>>
37596>>>>>>>>>        // Child (Client) file structure................
37596>>>>>>>>>        Send Add_Client_File  Item.File_Number
37597>>>>>>>>>
37597>>>>>>>>>        // External (System) file structure.............
37597>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
37598>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
37599>>>>>>>>>
37599>>>>>>>>>        Define_Auto_Increment  Sysrecw.Units_Rec0  To Units.Units_Rec0
37602>>>>>>>>>
37602>>>>>>>>>        // Field-based properties.......................
37602>>>>>>>>>
37602>>>>>>>>>        // Units.Units_Code
37602>>>>>>>>>        Set Field_Options          Field Units.Units_Code To DD_AUTOFIND   
37603>>>>>>>>>        Set Field_Prompt_Object    Field Units.Units_Code To (sl025(Self))
37604>>>>>>>>>
37604>>>>>>>>>        // Units.Units_Rec0
37604>>>>>>>>>        Set Field_Options          Field Units.Units_Rec0 To DD_AUTOFIND   
37605>>>>>>>>>
37605>>>>>>>>>        // Units.Units_Descr
37605>>>>>>>>>        Set Field_Prompt_Object    Field Units.Units_Descr To (sl025(Self))
37606>>>>>>>>>
37606>>>>>>>>>        // Units.Units_Recr
37606>>>>>>>>>        Set Field_Options          Field Units.Units_Recr To DD_AUTOFIND   
37607>>>>>>>>>
37607>>>>>>>>>        //DDB-DefineFieldEnd
37607>>>>>>>>>    End_Procedure    // Define_Fields
37608>>>>>>>>>
37608>>>>>>>>>    // Field_Defaults:
37608>>>>>>>>>    // This procedure is used to establish default field values.
37608>>>>>>>>>
37608>>>>>>>>>    Procedure Field_Defaults
37609>>>>>>>>>        Forward Send Field_Defaults
37611>>>>>>>>>        //DDB-Generated-Code-Location
37611>>>>>>>>>        //DDB-FieldDefaultStart
37611>>>>>>>>>        //DDB-FieldDefaultEnd
37611>>>>>>>>>    End_Procedure    // Field_Defaults
37612>>>>>>>>>
37612>>>>>>>>>End_Class    // Units_DataDictionary
37613>>>>>>>>>//DDB-Selection-pkg-Start
37613>>>>>>>>>
37613>>>>>>>>>Use sl025.SL         // sl025
INCLUDING FILE: SL025.SL
37613>>>>>>>>>>>//AB/ Project sl025
37613>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
37613>>>>>>>>>>>//AB/     Set ProjectName to "sl025"
37613>>>>>>>>>>>//AB/     Set ProjectFileName to "sl025.SL"
37613>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
37613>>>>>>>>>>>
37613>>>>>>>>>>>// Project Object Structure
37613>>>>>>>>>>>//   sl025 is a dbModalPanelSub
37613>>>>>>>>>>>//     Units_DD is a DataDictionary
37613>>>>>>>>>>>//     oSelList is a dbListSub
37613>>>>>>>>>>>//     oOK_bn is a ButtonSub
37613>>>>>>>>>>>//     oCancel_bn is a ButtonSub
37613>>>>>>>>>>>//     oSearch_bn is a ButtonSub
37613>>>>>>>>>>>
37613>>>>>>>>>>>// Register all objects
37613>>>>>>>>>>>Register_Object oCancel_bn
37613>>>>>>>>>>>Register_Object oOK_bn
37613>>>>>>>>>>>Register_Object oSearch_bn
37613>>>>>>>>>>>Register_Object oSelList
37613>>>>>>>>>>>Register_Object sl025
37613>>>>>>>>>>>Register_Object Units_DD
37613>>>>>>>>>>>
37613>>>>>>>>>>>
37613>>>>>>>>>>>//AB-IgnoreStart
37613>>>>>>>>>>>
37613>>>>>>>>>>>Use DFAllEnt.pkg
37613>>>>>>>>>>>Use dbList.Sub
37613>>>>>>>>>>>Use Button.Sub
37613>>>>>>>>>>>
37613>>>>>>>>>>>
37613>>>>>>>>>>>Use UNITS.DD
37613>>>>>>>>>>>
37613>>>>>>>>>>>//AB-IgnoreEnd
37613>>>>>>>>>>>
37613>>>>>>>>>>>Object sl025 is a dbModalPanelSub
37615>>>>>>>>>>>    set label to "‹¦¤á›œª ‹â«¨ž©žª" 
37616>>>>>>>>>>>    Set Size to 148 297
37617>>>>>>>>>>>    Set Location to 4 5
37618>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
37619>>>>>>>>>>>    Set Modal_State to FALSE
37620>>>>>>>>>>>
37620>>>>>>>>>>>    //AB-DDOStart
37620>>>>>>>>>>>
37620>>>>>>>>>>>    Object Units_DD is a Units_DataDictionary
37622>>>>>>>>>>>    End_Object    // Units_DD
37623>>>>>>>>>>>
37623>>>>>>>>>>>    Set Main_DD to (Units_DD(self))
37624>>>>>>>>>>>    Set Server to (Units_DD(self))
37625>>>>>>>>>>>
37625>>>>>>>>>>>    //AB-DDOEnd
37625>>>>>>>>>>>
37625>>>>>>>>>>>    Object oSelList is a dbListSub
37627>>>>>>>>>>>        set main_file to units.file_number 
37628>>>>>>>>>>>        Set Size to 105 280
37629>>>>>>>>>>>        Set Location to 6 6
37630>>>>>>>>>>>
37630>>>>>>>>>>>        Begin_Row
37633>>>>>>>>>>>            entry_item units.units_code 
37634>>>>>>>>>>>            entry_item units.units_descr 
37635>>>>>>>>>>>        End_Row
37640>>>>>>>>>>>
37640>>>>>>>>>>>        Set Form_Width    item 0 to 91
37641>>>>>>>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
37642>>>>>>>>>>>        
37642>>>>>>>>>>>        Set Form_Width    item 1 to 180
37643>>>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
37644>>>>>>>>>>>        
37644>>>>>>>>>>>    End_Object    // oSelList
37645>>>>>>>>>>>
37645>>>>>>>>>>>    Object oOK_bn is a ButtonSub
37647>>>>>>>>>>>        set label to "&„§ ¢¦šã" 
37648>>>>>>>>>>>        Set Location to 115 126
37649>>>>>>>>>>>
37649>>>>>>>>>>>        //AB-StoreStart
37649>>>>>>>>>>>        Procedure OnClick
37651>>>>>>>>>>>            Send OK To (oSelList(current_object))
37652>>>>>>>>>>>        End_Procedure
37653>>>>>>>>>>>        //AB-StoreEnd
37653>>>>>>>>>>>
37653>>>>>>>>>>>    End_Object    // oOK_bn
37654>>>>>>>>>>>
37654>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
37656>>>>>>>>>>>        set label to "&€¡ç¨à©ž" 
37657>>>>>>>>>>>        Set Location to 115 181
37658>>>>>>>>>>>
37658>>>>>>>>>>>        //AB-StoreStart
37658>>>>>>>>>>>        Procedure OnClick
37660>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
37661>>>>>>>>>>>        End_Procedure
37662>>>>>>>>>>>        //AB-StoreEnd
37662>>>>>>>>>>>
37662>>>>>>>>>>>    End_Object    // oCancel_bn
37663>>>>>>>>>>>
37663>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
37665>>>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
37666>>>>>>>>>>>        Set Location to 115 236
37667>>>>>>>>>>>
37667>>>>>>>>>>>        //AB-StoreStart
37667>>>>>>>>>>>        Procedure OnClick
37669>>>>>>>>>>>            Send Search To (oSelList(current_object))
37670>>>>>>>>>>>        End_Procedure
37671>>>>>>>>>>>        //AB-StoreEnd
37671>>>>>>>>>>>
37671>>>>>>>>>>>    End_Object    // oSearch_bn
37672>>>>>>>>>>>
37672>>>>>>>>>>>
37672>>>>>>>>>>>    //AB-StoreStart
37672>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
37673>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
37674>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
37675>>>>>>>>>>>    //AB-StoreEnd
37675>>>>>>>>>>>
37675>>>>>>>>>>>End_Object    // sl025
37676>>>>>>>>>>>
37676>>>>>>>>>>>//AB/ End_Object    // prj
37676>>>>>>>>>
37676>>>>>>>>>//DDB-Selection-pkg-End
37676>>>>>>>>>//DDB-FileEnd
37676>>>>>>>    Use FPA.DD
INCLUDING FILE: FPA.DD
37676>>>>>>>>>//DDB-FileStart
37676>>>>>>>>>//DDB-HeaderStart
37676>>>>>>>>>
37676>>>>>>>>>// File Name : FPA.DD
37676>>>>>>>>>// Class Name: Fpa_DataDictionary
37676>>>>>>>>>// Revision  : 32
37676>>>>>>>>>// Version   : 2
37676>>>>>>>>>
37676>>>>>>>>>Use  Windows           // Basic Definitions
37676>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
37676>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
37676>>>>>>>>>
37676>>>>>>>>>Open Fpa
INCLUDING FILE: FPA.FD
37678>>>>>>>>>Open Iteml
INCLUDING FILE: ITEML.FD
37680>>>>>>>>>Open Partlfpa
INCLUDING FILE: PARTLFPA.FD
37682>>>>>>>>>Open Item
37684>>>>>>>>>
37684>>>>>>>>>//DDB-HeaderEnd
37684>>>>>>>>>//DDB-SelectionStart
37684>>>>>>>>>//DDB/ ExternalSelectionList Fpa  Fpa.SL
37684>>>>>>>>>//DDB/ ExternalSelectionList sl150  sl150.SL
37684>>>>>>>>>Register_Object Fpa
37684>>>>>>>>>Register_Object sl150
37684>>>>>>>>>//DDB-SelectionEnd
37684>>>>>>>>>
37684>>>>>>>>>Class Fpa_DataDictionary  is a DataDictionary_Sec
37685>>>>>>>>> 
37685>>>>>>>>>    // Validate_Save:
37685>>>>>>>>> 
37685>>>>>>>>>    Function Validate_Save  Returns Integer
37686>>>>>>>>>        Local Integer iReturnVal icheck
37687>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
37689>>>>>>>>>        If (Not(iReturnVal)) Begin
37691>>>>>>>>>            // Insert Code Here
37691>>>>>>>>>         //  if (fpa.agora_codegl <> '') begin
37691>>>>>>>>>         //     Move (Check_log(fpa.agora_codegl)) to iCheck  
37691>>>>>>>>>         //     if (icheck) Move 104001 to iReturnVal 
37691>>>>>>>>>         //  end
37691>>>>>>>>>         //  if (fpa.polhsh_codegl <> '') begin
37691>>>>>>>>>         //     Move (Check_log(fpa.polhsh_codegl)) to iCheck  
37691>>>>>>>>>         //     if (icheck) Move 104002 to iReturnVal
37691>>>>>>>>>         //  end   
37691>>>>>>>>>         //  If (iReturnVal) Send Operation_Not_Allowed iReturnVal
37691>>>>>>>>>        End
37691>>>>>>>>>>
37691>>>>>>>>>        Function_Return iReturnVal
37692>>>>>>>>>    End_Function   // Validate_Save
37693>>>>>>>>> 
37693>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
37694>>>>>>>>>        String lsError_Message
37695>>>>>>>>>        Case Begin
37695>>>>>>>>>            Case (iError_Num = 104001)
37697>>>>>>>>>                Move "DDC 104: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ”..€ ˜š¦¨é¤" to lsError_Message
37698>>>>>>>>>              Case Break
37699>>>>>>>>>            Case (iError_Num = 104002)
37702>>>>>>>>>                Move "DDC 104: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ”..€ §à¢ã©œà¤" to lsError_Message
37703>>>>>>>>>              Case Break
37704>>>>>>>>>            Case Else
37704>>>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
37706>>>>>>>>>        Case End
37706>>>>>>>>>        Error iError_Num lsError_Message
37707>>>>>>>>>>
37707>>>>>>>>>    End_Procedure // operation_not_allowed
37708>>>>>>>>>
37708>>>>>>>>>    // Define_Fields:
37708>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
37708>>>>>>>>>
37708>>>>>>>>>    Procedure Define_Fields
37709>>>>>>>>>        Forward Send Define_Fields
37711>>>>>>>>>        //DDB-Generated-Code-Location
37711>>>>>>>>>        //DDB-DefineFieldStart
37711>>>>>>>>>
37711>>>>>>>>>        Set Main_File            To Fpa.File_Number
37712>>>>>>>>>        Set Cascade_Delete_State To FALSE
37713>>>>>>>>>
37713>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
37714>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
37715>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
37716>>>>>>>>>
37716>>>>>>>>>        // Child (Client) file structure................
37716>>>>>>>>>        Send Add_Client_File  Iteml.File_Number
37717>>>>>>>>>        Send Add_Client_File  Partlfpa.File_Number
37718>>>>>>>>>        Send Add_Client_File  Item.File_Number
37719>>>>>>>>>
37719>>>>>>>>>        // Field-based properties.......................
37719>>>>>>>>>
37719>>>>>>>>>        // Fpa.Fpa_Pososto
37719>>>>>>>>>        Set Field_Options          Field Fpa.Fpa_Pososto To DD_AUTOFIND    DD_FINDREQ    
37720>>>>>>>>>        Set Field_Prompt_Object    Field Fpa.Fpa_Pososto To (Fpa(Self))
37721>>>>>>>>>        Set Key_Field_State        Field Fpa.Fpa_Pososto To TRUE
37722>>>>>>>>>
37722>>>>>>>>>        // Fpa.Fpa_Descr
37722>>>>>>>>>        Set Field_Options          Field Fpa.Fpa_Descr To DD_AUTOFIND   
37723>>>>>>>>>        Set Field_Prompt_Object    Field Fpa.Fpa_Descr To (Fpa(Self))
37724>>>>>>>>>
37724>>>>>>>>>        // Fpa.Agora_Codegl
37724>>>>>>>>>        Set Field_Prompt_Object    Field Fpa.Agora_Codegl To (sl150(Self))
37725>>>>>>>>>
37725>>>>>>>>>        // Fpa.Polhsh_Codegl
37725>>>>>>>>>
37725>>>>>>>>>        //DDB-DefineFieldEnd
37725>>>>>>>>>    End_Procedure    // Define_Fields
37726>>>>>>>>>
37726>>>>>>>>>    // Field_Defaults:
37726>>>>>>>>>    // This procedure is used to establish default field values.
37726>>>>>>>>>
37726>>>>>>>>>    Procedure Field_Defaults
37727>>>>>>>>>        Forward Send Field_Defaults
37729>>>>>>>>>        //DDB-Generated-Code-Location
37729>>>>>>>>>        //DDB-FieldDefaultStart
37729>>>>>>>>>        //DDB-FieldDefaultEnd
37729>>>>>>>>>    End_Procedure    // Field_Defaults
37730>>>>>>>>>
37730>>>>>>>>>End_Class    // Fpa_DataDictionary
37731>>>>>>>>>//DDB-Selection-pkg-Start
37731>>>>>>>>>
37731>>>>>>>>>Use Fpa.SL           // Fpa
INCLUDING FILE: FPA.SL
37731>>>>>>>>>>>//AB/ Project Fpa:Lookup
37731>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
37731>>>>>>>>>>>//AB/     Set ProjectName to "Fpa:Lookup"
37731>>>>>>>>>>>//AB/     Set ProjectFileName to "Fpa.SL"
37731>>>>>>>>>>>
37731>>>>>>>>>>>// Project Object Structure
37731>>>>>>>>>>>//   Fpa is a dbModalPanelSub
37731>>>>>>>>>>>//     Fpa_DD is a DataDictionary
37731>>>>>>>>>>>//     oSelList is a dbListSub
37731>>>>>>>>>>>//     oOK_bn is a ButtonSub
37731>>>>>>>>>>>//     oCancel_bn is a ButtonSub
37731>>>>>>>>>>>//     oSearch_bn is a ButtonSub
37731>>>>>>>>>>>
37731>>>>>>>>>>>// Register all objects
37731>>>>>>>>>>>Register_Object Fpa
37731>>>>>>>>>>>Register_Object Fpa_DD
37731>>>>>>>>>>>Register_Object oCancel_bn
37731>>>>>>>>>>>Register_Object oOK_bn
37731>>>>>>>>>>>Register_Object oSearch_bn
37731>>>>>>>>>>>Register_Object oSelList
37731>>>>>>>>>>>
37731>>>>>>>>>>>
37731>>>>>>>>>>>//AB-IgnoreStart
37731>>>>>>>>>>>
37731>>>>>>>>>>>Use DFAllEnt.pkg
37731>>>>>>>>>>>Use dbList.Sub
37731>>>>>>>>>>>Use Button.Sub
37731>>>>>>>>>>>
37731>>>>>>>>>>>
37731>>>>>>>>>>>Use FPA.DD
37731>>>>>>>>>>>
37731>>>>>>>>>>>//AB-IgnoreEnd
37731>>>>>>>>>>>
37731>>>>>>>>>>>CD_Popup_Object Fpa is a dbModalPanelSub
37750>>>>>>>>>>>    set label to "¦©¦©«á ”..€." 
37751>>>>>>>>>>>    Set Size to 148 181
37752>>>>>>>>>>>    Set Location to 4 5
37753>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
37754>>>>>>>>>>>    Set Modal_State to FALSE
37755>>>>>>>>>>>
37755>>>>>>>>>>>    //AB-DDOStart
37755>>>>>>>>>>>
37755>>>>>>>>>>>    Object Fpa_DD is a Fpa_DataDictionary
37757>>>>>>>>>>>    End_Object    // Fpa_DD
37758>>>>>>>>>>>
37758>>>>>>>>>>>    Set Main_DD to (Fpa_DD(self))
37759>>>>>>>>>>>    Set Server to (Fpa_DD(self))
37760>>>>>>>>>>>
37760>>>>>>>>>>>    //AB-DDOEnd
37760>>>>>>>>>>>
37760>>>>>>>>>>>    Object oSelList is a dbListSub
37762>>>>>>>>>>>        Set Main_File to Fpa.File_Number
37763>>>>>>>>>>>        Set Size to 105 165
37764>>>>>>>>>>>        Set Location to 6 6
37765>>>>>>>>>>>
37765>>>>>>>>>>>        Begin_Row
37768>>>>>>>>>>>            Entry_Item Fpa.Fpa_pososto
37769>>>>>>>>>>>            Entry_Item Fpa.Fpa_descr
37770>>>>>>>>>>>        End_Row
37775>>>>>>>>>>>
37775>>>>>>>>>>>        Set Form_Width    item 0 to 66
37776>>>>>>>>>>>        set header_label  item 0 to "% ”€" 
37777>>>>>>>>>>>        
37777>>>>>>>>>>>        Set Form_Width    item 1 to 90
37778>>>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
37779>>>>>>>>>>>        
37779>>>>>>>>>>>    End_Object    // oSelList
37780>>>>>>>>>>>
37780>>>>>>>>>>>    Object oOK_bn is a ButtonSub
37782>>>>>>>>>>>        set label to "&„§ ¢¦šã" 
37783>>>>>>>>>>>        Set Size to 14 46
37784>>>>>>>>>>>        Set Location to 113 26
37785>>>>>>>>>>>
37785>>>>>>>>>>>        //AB-StoreStart
37785>>>>>>>>>>>        Procedure OnClick
37787>>>>>>>>>>>            Send OK To (oSelList(current_object))
37788>>>>>>>>>>>        End_Procedure
37789>>>>>>>>>>>        //AB-StoreEnd
37789>>>>>>>>>>>
37789>>>>>>>>>>>    End_Object    // oOK_bn
37790>>>>>>>>>>>
37790>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
37792>>>>>>>>>>>        set label to "&€¡ç¨à©ž" 
37793>>>>>>>>>>>        Set Size to 14 46
37794>>>>>>>>>>>        Set Location to 113 75
37795>>>>>>>>>>>
37795>>>>>>>>>>>        //AB-StoreStart
37795>>>>>>>>>>>        Procedure OnClick
37797>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
37798>>>>>>>>>>>        End_Procedure
37799>>>>>>>>>>>        //AB-StoreEnd
37799>>>>>>>>>>>
37799>>>>>>>>>>>    End_Object    // oCancel_bn
37800>>>>>>>>>>>
37800>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
37802>>>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
37803>>>>>>>>>>>        Set Size to 14 46
37804>>>>>>>>>>>        Set Location to 113 126
37805>>>>>>>>>>>
37805>>>>>>>>>>>        //AB-StoreStart
37805>>>>>>>>>>>        Procedure OnClick
37807>>>>>>>>>>>            Send Search To (oSelList(current_object))
37808>>>>>>>>>>>        End_Procedure
37809>>>>>>>>>>>        //AB-StoreEnd
37809>>>>>>>>>>>
37809>>>>>>>>>>>    End_Object    // oSearch_bn
37810>>>>>>>>>>>
37810>>>>>>>>>>>
37810>>>>>>>>>>>    //AB-StoreStart
37810>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
37811>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
37812>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
37813>>>>>>>>>>>    //AB-StoreEnd
37813>>>>>>>>>>>
37813>>>>>>>>>>>CD_End_Object    // Fpa
37815>>>>>>>>>>>>
37815>>>>>>>>>>>
37815>>>>>>>>>>>//AB/ End_Object    // prj
37815>>>>>>>>>Use sl150.SL         // sl150
37815>>>>>>>>>
37815>>>>>>>>>//DDB-Selection-pkg-End
37815>>>>>>>>>//DDB-FileEnd
37815>>>>>>>    Use ITEM.DD
INCLUDING FILE: ITEM.DD
37815>>>>>>>>>//DDB-FileStart
37815>>>>>>>>>//DDB-HeaderStart
37815>>>>>>>>>
37815>>>>>>>>>// File Name : ITEM.DD
37815>>>>>>>>>// Class Name: Item_DataDictionary
37815>>>>>>>>>// Revision  : 53
37815>>>>>>>>>// Version   : 2
37815>>>>>>>>>
37815>>>>>>>>>Use  Windows           // Basic Definitions
37815>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
37815>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
37815>>>>>>>>>
37815>>>>>>>>>Open Item
37817>>>>>>>>>Open Witemx
INCLUDING FILE: WITEMX.FD
37819>>>>>>>>>Open Itemd
INCLUDING FILE: ITEMD.FD
37821>>>>>>>>>Open Witemcl
37823>>>>>>>>>Open Units
37825>>>>>>>>>Open Witemkat
37827>>>>>>>>>Open Fpa
37829>>>>>>>>>Open Sysrecw
37831>>>>>>>>>Open Witemx
37833>>>>>>>>>
37833>>>>>>>>>//DDB-HeaderEnd
37833>>>>>>>>>//DDB-ValidationStart
37833>>>>>>>>>
37833>>>>>>>>>Register_Object Item_Item_Qual_VT
37833>>>>>>>>>Register_Object Item_Item_Analysh_VT
37833>>>>>>>>>
37833>>>>>>>>>Object Item_Item_Qual_VT  is a CodeValidationTable
37835>>>>>>>>>    Set Type_Value        To "QUAL"
37836>>>>>>>>>    Set Validate_State    To FALSE
37837>>>>>>>>>    Set Allow_Blank_State To TRUE
37838>>>>>>>>>    //DDB-ValidationCustomStart
37838>>>>>>>>>    //DDB-ValidationCustomEnd
37838>>>>>>>>>End_Object   // Item_Item_Qual_VT
37839>>>>>>>>>
37839>>>>>>>>>Object Item_Item_Analysh_VT  is a CodeValidationTable
37841>>>>>>>>>    Set Type_Value        To "ITEMANAL"
37842>>>>>>>>>    Set Table_Title       To "€¤á¢¬©ž „å›¦¬ª"
37843>>>>>>>>>    //DDB-ValidationCustomStart
37843>>>>>>>>>    //DDB-ValidationCustomEnd
37843>>>>>>>>>End_Object   // Item_Item_Analysh_VT
37844>>>>>>>>>//DDB-ValidationEnd
37844>>>>>>>>>//DDB-SelectionStart
37844>>>>>>>>>//DDB/ ExternalSelectionList SL22s  sl22s.sl
37844>>>>>>>>>//DDB/ ExternalSelectionList sl022  sl022.SL
37844>>>>>>>>>Register_Object SL22s
37844>>>>>>>>>Register_Object sl022
37844>>>>>>>>>//DDB-SelectionEnd
37844>>>>>>>>>
37844>>>>>>>>>Class Item_DataDictionary  is a DataDictionary
37845>>>>>>>>>
37845>>>>>>>>>    Procedure Update
37846>>>>>>>>>        Forward Send Update
37848>>>>>>>>>        Move Witemkat.Witemkat_Code to Item.Witemkat_Code
37849>>>>>>>>>        Move Units.Units_Code       to Item.Units_Code
37850>>>>>>>>>    End_Procedure   // Update
37851>>>>>>>>>
37851>>>>>>>>>     Procedure Creating
37852>>>>>>>>>        Date dHmnia
37853>>>>>>>>>        Forward Send Creating
37855>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Item.Item_Rec0)))))) to Item.Item_Recr
37856>>>>>>>>>        Clear Witemx
37857>>>>>>>>>        Move SysCurXR.Company_Code    to Witemx.Company_Code
37858>>>>>>>>>        Move SysCurXR.Branch_Code     to Witemx.Branch_Code
37859>>>>>>>>>        Move SysCurXR.Year_Year       to Witemx.Year_Year
37860>>>>>>>>>        Move SysCurXR.Year_Year       to Witemx.Witemx_YearDesc
37861>>>>>>>>>        Move SysCurXR.Year_Recr       to Witemx.Year_Recr
37862>>>>>>>>>        Move Witemkat.Witemkat_Code   to Witemx.Witemkat_Code
37863>>>>>>>>>        Move Units.Units_Code         to Witemx.Units_Code
37864>>>>>>>>>        Move Item.Item_Code           to Witemx.Item_Code
37865>>>>>>>>>        Move Item.Item_Code           to Witemx.Witemx_Code
37866>>>>>>>>>        Move Item.Item_Descr          to Witemx.Witemx_Descr
37867>>>>>>>>>        Move Item.Wapokat_Code        to Witemx.ITEM_APOKAT_COD
37868>>>>>>>>>        Move Item.link1               to Witemx.link1
37869>>>>>>>>>        Move Item.link2               to Witemx.link2
37870>>>>>>>>>        Move Item.Item_Recr           to Witemx.Item_Recr
37871>>>>>>>>>        Move (Sysrecw.Witemx_Rec0+1)  to Witemx.Witemx_Rec0
37872>>>>>>>>>        Move (Sysrecw.Witemx_Rec0+1)  to Sysrecw.Witemx_Rec0
37873>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                       (Trim(String(Witemx.Witemx_Rec0)))))) ;                                      to Witemx.Witemx_Recr
37874>>>>>>>>>        Saverecord Sysrecw
37875>>>>>>>>>        Saverecord Witemx
37876>>>>>>>>>     End_Procedure   // Creating
37877>>>>>>>>>
37877>>>>>>>>>
37877>>>>>>>>>    // Define_Fields:
37877>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
37877>>>>>>>>>
37877>>>>>>>>>    Procedure Define_Fields
37878>>>>>>>>>        Forward Send Define_Fields
37880>>>>>>>>>        //DDB-Generated-Code-Location
37880>>>>>>>>>        //DDB-DefineFieldStart
37880>>>>>>>>>
37880>>>>>>>>>        Set Main_File            To Item.File_Number
37881>>>>>>>>>        Set Cascade_Delete_State To FALSE
37882>>>>>>>>>
37882>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
37883>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
37884>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
37885>>>>>>>>>
37885>>>>>>>>>        // Child (Client) file structure................
37885>>>>>>>>>        Send Add_Client_File  Witemx.File_Number
37886>>>>>>>>>        Send Add_Client_File  Itemd.File_Number
37887>>>>>>>>>        Send Add_Client_File  Witemcl.File_Number
37888>>>>>>>>>
37888>>>>>>>>>        // Parent (Server) file structure...............
37888>>>>>>>>>        Send Add_Server_File  Units.File_Number
37889>>>>>>>>>        Send Add_Server_File  Witemkat.File_Number
37890>>>>>>>>>        Send Add_Server_File  Fpa.File_Number
37891>>>>>>>>>
37891>>>>>>>>>        // External (System) file structure.............
37891>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
37892>>>>>>>>>        Send Add_System_File  Witemx.File_Number  DD_LOCK_ON_ALL
37893>>>>>>>>>
37893>>>>>>>>>        Define_Auto_Increment  Sysrecw.Item_Rec0  To Item.Item_Rec0
37896>>>>>>>>>
37896>>>>>>>>>        // Field-based properties.......................
37896>>>>>>>>>
37896>>>>>>>>>        // Item.Units_Code
37896>>>>>>>>>
37896>>>>>>>>>        // Item.Units_Recr
37896>>>>>>>>>
37896>>>>>>>>>        // Item.Witemkat_Code
37896>>>>>>>>>
37896>>>>>>>>>        // Item.Witemkat_Recr
37896>>>>>>>>>
37896>>>>>>>>>        // Item.Item_Code
37896>>>>>>>>>        Set Field_Options          Field Item.Item_Code To DD_AUTOFIND   
37897>>>>>>>>>        Set Field_Prompt_Object    Field Item.Item_Code To (SL22s(Self))
37898>>>>>>>>>        Set Key_Field_State        Field Item.Item_Code To TRUE
37899>>>>>>>>>
37899>>>>>>>>>        // Item.Item_Rec0
37899>>>>>>>>>        Set Field_Options          Field Item.Item_Rec0 To DD_AUTOFIND   
37900>>>>>>>>>
37900>>>>>>>>>        // Item.Item_Descr
37900>>>>>>>>>        Set Field_Prompt_Object    Field Item.Item_Descr To (SL22s(Self))
37901>>>>>>>>>
37901>>>>>>>>>        // Item.Item_Recr
37901>>>>>>>>>        Set Field_Options          Field Item.Item_Recr To DD_AUTOFIND   
37902>>>>>>>>>
37902>>>>>>>>>        // Item.Fpa_Pososto
37902>>>>>>>>>
37902>>>>>>>>>        // Item.Item_Qual
37902>>>>>>>>>        Set Field_Value_Table      Field Item.Item_Qual To (Item_Item_Qual_VT(Self))
37903>>>>>>>>>
37903>>>>>>>>>        // Item.Wapokat_Code
37903>>>>>>>>>        Set Field_Prompt_Object    Field Item.Wapokat_Code To (sl022(Self))
37904>>>>>>>>>
37904>>>>>>>>>        // Item.Item_Analysh
37904>>>>>>>>>        Set Field_Class_Name       Field Item.Item_Analysh To "dbComboFormsub"
37905>>>>>>>>>        Set Field_Value_Table      Field Item.Item_Analysh To (Item_Item_Analysh_VT(Self))
37906>>>>>>>>>
37906>>>>>>>>>        // Item.Item_Orio
37906>>>>>>>>>
37906>>>>>>>>>        // Item.Codeglpol
37906>>>>>>>>>
37906>>>>>>>>>        // Item.Codeglago
37906>>>>>>>>>
37906>>>>>>>>>        // Item.Link1
37906>>>>>>>>>
37906>>>>>>>>>        // Item.Link2
37906>>>>>>>>>
37906>>>>>>>>>        // Item.Group
37906>>>>>>>>>
37906>>>>>>>>>        //DDB-DefineFieldEnd
37906>>>>>>>>>    End_Procedure    // Define_Fields
37907>>>>>>>>>
37907>>>>>>>>>    // Field_Defaults:
37907>>>>>>>>>    // This procedure is used to establish default field values.
37907>>>>>>>>>
37907>>>>>>>>>    Procedure Field_Defaults
37908>>>>>>>>>        Forward Send Field_Defaults
37910>>>>>>>>>        //DDB-Generated-Code-Location
37910>>>>>>>>>        //DDB-FieldDefaultStart
37910>>>>>>>>>        Set Field_Changed_Value   Field Item.Item_Analysh To "0"
37911>>>>>>>>>        //DDB-FieldDefaultEnd
37911>>>>>>>>>    End_Procedure    // Field_Defaults
37912>>>>>>>>>
37912>>>>>>>>>End_Class    // Item_DataDictionary
37913>>>>>>>>>//DDB-Selection-pkg-Start
37913>>>>>>>>>
37913>>>>>>>>>Use sl22s.sl         // SL22s
INCLUDING FILE: SL22S.SL
37913>>>>>>>>>>>//AB/ Project SL22s:ITEM
37913>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
37913>>>>>>>>>>>//AB/     Set ProjectName to "SL22s:ITEM"
37913>>>>>>>>>>>//AB/     Set ProjectFileName to "sl22s.sl"
37913>>>>>>>>>>>
37913>>>>>>>>>>>// Project Object Structure
37913>>>>>>>>>>>//   SL22s is a dbModalPanel
37913>>>>>>>>>>>//     Witemkat_DD is a DataDictionary
37913>>>>>>>>>>>//     Units_DD is a DataDictionary
37913>>>>>>>>>>>//     Fpa_DD is a DataDictionary
37913>>>>>>>>>>>//     Item_DD is a DataDictionary
37913>>>>>>>>>>>//     oSelList is a dbList
37913>>>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
37913>>>>>>>>>>>//     ocode is a FormSub
37913>>>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
37913>>>>>>>>>>>//     operi is a FormSub
37913>>>>>>>>>>>//     RadioGroupSub1 is a RadioGroupSub
37913>>>>>>>>>>>//       Radio1 is a RadioSub
37913>>>>>>>>>>>//       Radio2 is a RadioSub
37913>>>>>>>>>>>//     ButtonSub1 is a ButtonSub
37913>>>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
37913>>>>>>>>>>>//     ocodekat is a FormSub
37913>>>>>>>>>>>//     oOK_bn is a ButtonSub
37913>>>>>>>>>>>//     oCancel_bn is a ButtonSub
37913>>>>>>>>>>>//     oSearch_bn is a ButtonSub
37913>>>>>>>>>>>
37913>>>>>>>>>>>// Register all objects
37913>>>>>>>>>>>Register_Object ButtonSub1
37913>>>>>>>>>>>Register_Object Fpa_DD
37913>>>>>>>>>>>Register_Object Item_DD
37913>>>>>>>>>>>Register_Object oCancel_bn
37913>>>>>>>>>>>Register_Object ocode
37913>>>>>>>>>>>Register_Object ocodekat
37913>>>>>>>>>>>Register_Object oOK_bn
37913>>>>>>>>>>>Register_Object operi
37913>>>>>>>>>>>Register_Object oSearch_bn
37913>>>>>>>>>>>Register_Object oSelList
37913>>>>>>>>>>>Register_Object Radio1
37913>>>>>>>>>>>Register_Object Radio2
37913>>>>>>>>>>>Register_Object RadioGroupSub1
37913>>>>>>>>>>>Register_Object SL22s
37913>>>>>>>>>>>Register_Object TextBoxSub1
37913>>>>>>>>>>>Register_Object TextBoxSub2
37913>>>>>>>>>>>Register_Object TextBoxSub3
37913>>>>>>>>>>>Register_Object Units_DD
37913>>>>>>>>>>>Register_Object Witemkat_DD
37913>>>>>>>>>>>
37913>>>>>>>>>>>
37913>>>>>>>>>>>
37913>>>>>>>>>>>//AB-StoreTopStart
37913>>>>>>>>>>>
37913>>>>>>>>>>>
37913>>>>>>>>>>>//AB-StoreTopEnd
37913>>>>>>>>>>>
37913>>>>>>>>>>>//AB-IgnoreStart
37913>>>>>>>>>>>
37913>>>>>>>>>>>Use DFAllEnt.pkg
37913>>>>>>>>>>>Use Txtbox.Sub
37913>>>>>>>>>>>Use Form.Sub
37913>>>>>>>>>>>Use Rgroup.Sub
37913>>>>>>>>>>>Use Radio.Sub
37913>>>>>>>>>>>Use Button.Sub
37913>>>>>>>>>>>
37913>>>>>>>>>>>
37913>>>>>>>>>>>Use WITEMKAT.DD
37913>>>>>>>>>>>Use UNITS.DD
37913>>>>>>>>>>>Use FPA.DD
37913>>>>>>>>>>>Use ITEM.DD
37913>>>>>>>>>>>
37913>>>>>>>>>>>//AB-IgnoreEnd
37913>>>>>>>>>>>
37913>>>>>>>>>>>CD_Popup_Object SL22s is a dbModalPanel
37932>>>>>>>>>>>
37932>>>>>>>>>>>    //AB-StoreTopStart
37932>>>>>>>>>>>    Property String     pscode                  ''
37934>>>>>>>>>>>    Property String     psperi                  ''
37936>>>>>>>>>>>    Property Integer    piContains_Or_Starts     0
37938>>>>>>>>>>>    Property String     pscodekat               ''
37940>>>>>>>>>>>
37940>>>>>>>>>>>    //AB-StoreTopEnd
37940>>>>>>>>>>>
37940>>>>>>>>>>>    Set Minimize_Icon to FALSE
37941>>>>>>>>>>>    Set Label to "€¨®œå¦ „ ›é¤"
37942>>>>>>>>>>>    Set Size to 270 484
37943>>>>>>>>>>>    Set Location to 1 6
37944>>>>>>>>>>>
37944>>>>>>>>>>>    //AB-DDOStart
37944>>>>>>>>>>>
37944>>>>>>>>>>>    Object Witemkat_DD is a Witemkat_DataDictionary
37946>>>>>>>>>>>    End_Object    // Witemkat_DD
37947>>>>>>>>>>>
37947>>>>>>>>>>>    Object Units_DD is a Units_DataDictionary
37949>>>>>>>>>>>    End_Object    // Units_DD
37950>>>>>>>>>>>
37950>>>>>>>>>>>    Object Fpa_DD is a Fpa_DataDictionary
37952>>>>>>>>>>>    End_Object    // Fpa_DD
37953>>>>>>>>>>>
37953>>>>>>>>>>>    Object Item_DD is a Item_DataDictionary
37955>>>>>>>>>>>
37955>>>>>>>>>>>        //AB-StoreTopStart
37955>>>>>>>>>>>        Function fiPeriexei Returns Integer
37957>>>>>>>>>>>                   String lsperi lscode  lscodekat
37958>>>>>>>>>>>                   Integer rVal liContains_Or_Starts
37958>>>>>>>>>>>                   Move 0 to rVal
37959>>>>>>>>>>>                   Get piContains_Or_Starts to liContains_Or_Starts
37960>>>>>>>>>>>                   Get psperi to lsperi
37961>>>>>>>>>>>                   Get pscode to lscode
37962>>>>>>>>>>>                   Get pscodekat to lscodekat
37963>>>>>>>>>>>                   Move (Trim(lsperi)) to lsperi
37964>>>>>>>>>>>                   Move (Trim(lscode)) to lscode
37965>>>>>>>>>>>              //     Move (Trim(lscodekat)) to lscodekat
37965>>>>>>>>>>>                   If (liContains_Or_Starts=0) Begin
37967>>>>>>>>>>>                       If ((Trim(item.item_descr)) Contains lsperi) Begin
37969>>>>>>>>>>>                           If ((Trim(item.item_code)) Contains lscode) Move 1 to rVal
37972>>>>>>>>>>>                       End
37972>>>>>>>>>>>>
37972>>>>>>>>>>>
37972>>>>>>>>>>>                   End
37972>>>>>>>>>>>>
37972>>>>>>>>>>>                   Else Begin
37973>>>>>>>>>>>                       If (Left(item.item_descr,(Length(lsperi)))=lsperi) Begin
37975>>>>>>>>>>>                           If (Left(item.item_code,(Length(lscode)))=lscode) Move 1 to rVal
37978>>>>>>>>>>>                       End
37978>>>>>>>>>>>>
37978>>>>>>>>>>>
37978>>>>>>>>>>>                   End
37978>>>>>>>>>>>>
37978>>>>>>>>>>>                   Function_Return rVal
37979>>>>>>>>>>>               End_Function
37980>>>>>>>>>>>
37980>>>>>>>>>>>               Function fiArxizeiperi Returns Integer
37982>>>>>>>>>>>                   String lsperi
37983>>>>>>>>>>>                   Get psperi to lsperi
37984>>>>>>>>>>>                   Move (Trim(lsperi)) to lsperi
37985>>>>>>>>>>>                   Function_Return (Left(item.item_descr,(Length(lsperi)))=lsperi)
37986>>>>>>>>>>>               End_Function
37987>>>>>>>>>>>
37987>>>>>>>>>>>               Function fiArxizeicode Returns Integer
37989>>>>>>>>>>>                   String lscode lscodekat
37990>>>>>>>>>>>                   Get pscode to lscode
37991>>>>>>>>>>>                   Move (Trim(lscode)) to lscode
37992>>>>>>>>>>>                   Function_Return (Left(item.item_code,(Length(lscode)))=lscode)
37993>>>>>>>>>>>               End_Function
37994>>>>>>>>>>>
37994>>>>>>>>>>>        //AB-StoreTopEnd
37994>>>>>>>>>>>
37994>>>>>>>>>>>        Set DDO_Server to (Units_DD(self))
37995>>>>>>>>>>>        Set DDO_Server to (Witemkat_DD(self))
37996>>>>>>>>>>>        Set DDO_Server to (Fpa_DD(self))
37997>>>>>>>>>>>
37997>>>>>>>>>>>        //AB-StoreStart
37997>>>>>>>>>>>
37997>>>>>>>>>>>
37997>>>>>>>>>>>
37997>>>>>>>>>>>        Begin_Constraints
37999>>>>>>>>>>>           String lsperi lscode lsvalue lstype lscodekat
38000>>>>>>>>>>>           Integer liContains_Or_Starts
38000>>>>>>>>>>>         //  Get FragmaItem  to lsValue
38000>>>>>>>>>>>
38000>>>>>>>>>>>               Get psperi  to lsperi
38001>>>>>>>>>>>               Get pscode  to lscode
38002>>>>>>>>>>>               Get pscodekat  to lscodekat
38003>>>>>>>>>>>               Get piContains_Or_Starts to liContains_Or_Starts
38004>>>>>>>>>>>               Move (Trim(lsperi)) to lsperi
38005>>>>>>>>>>>               Move (Trim(lscode)) to lscode
38006>>>>>>>>>>>               Move (Trim(lscodekat)) to lscodekat
38007>>>>>>>>>>>               If ((lsperi<>'') and (lscode<>'')) begin
38009>>>>>>>>>>>                    set ordering to 5
38010>>>>>>>>>>>                    Constrain item as (fiPeriexei(Self)=1)
38011>>>>>>>>>>>               end
38011>>>>>>>>>>>>
38011>>>>>>>>>>>               Else Begin
38012>>>>>>>>>>>                  If (liContains_Or_Starts=0) Begin
38014>>>>>>>>>>>                    If (lsperi<>'') begin
38016>>>>>>>>>>>                        set ordering to 3
38017>>>>>>>>>>>                        Constrain item.item_descr Contains lsperi
38019>>>>>>>>>>>                    end
38019>>>>>>>>>>>>
38019>>>>>>>>>>>                    Else If (lscode<>'') begin
38022>>>>>>>>>>>                        set ordering to 5
38023>>>>>>>>>>>                        Constrain item.item_code Contains lscode
38025>>>>>>>>>>>                    end
38025>>>>>>>>>>>>
38025>>>>>>>>>>>                  End
38025>>>>>>>>>>>>
38025>>>>>>>>>>>                  Else Begin
38026>>>>>>>>>>>                       If (lsperi<>'') begin
38028>>>>>>>>>>>                            set ordering to 3
38029>>>>>>>>>>>                            Constrain item as (fiArxizeiperi(Self)=1) //item.item_descr
38030>>>>>>>>>>>                       end
38030>>>>>>>>>>>>
38030>>>>>>>>>>>                       Else If (lscode<>'') begin
38033>>>>>>>>>>>                            set ordering to 5
38034>>>>>>>>>>>                            Constrain item as (fiArxizeicode(Self)=1) //item.item_code
38035>>>>>>>>>>>                       end
38035>>>>>>>>>>>>
38035>>>>>>>>>>>                  End
38035>>>>>>>>>>>>
38035>>>>>>>>>>>               End
38035>>>>>>>>>>>>
38035>>>>>>>>>>>               If (lscodekat<>'') Constrain item.witemkat_code Contains lscodekat
38039>>>>>>>>>>>
38039>>>>>>>>>>>        End_Constraints
38042>>>>>>>>>>>
38042>>>>>>>>>>>
38042>>>>>>>>>>>
38042>>>>>>>>>>>
38042>>>>>>>>>>>        //AB-StoreEnd
38042>>>>>>>>>>>
38042>>>>>>>>>>>    End_Object    // Item_DD
38043>>>>>>>>>>>
38043>>>>>>>>>>>    Set Main_DD to (Item_DD(self))
38044>>>>>>>>>>>    Set Server to (Item_DD(self))
38045>>>>>>>>>>>
38045>>>>>>>>>>>    //AB-DDOEnd
38045>>>>>>>>>>>
38045>>>>>>>>>>>    Object oSelList is a dbListSUB
38047>>>>>>>>>>>        Set Main_File to Item.File_Number
38048>>>>>>>>>>>        Set Ordering to 5
38049>>>>>>>>>>>        Set Size to 190 475
38050>>>>>>>>>>>        Set Location to -1 2
38051>>>>>>>>>>>        Set Color to 14280447
38052>>>>>>>>>>>        Set CurrentRowColor to 11783679
38053>>>>>>>>>>>        Set CurrentCellColor to 11783679
38054>>>>>>>>>>>        Set Auto_Index_State to FALSE
38055>>>>>>>>>>>
38055>>>>>>>>>>>        Begin_Row
38058>>>>>>>>>>>            Entry_Item Item.Item_code
38059>>>>>>>>>>>            Entry_Item Item.Item_descr
38060>>>>>>>>>>>            Entry_Item Item.Witemkat_code
38061>>>>>>>>>>>            Entry_Item Witemkat.Witemkat_descr
38062>>>>>>>>>>>            Entry_Item Item.Item_qual
38063>>>>>>>>>>>            Entry_Item Fpa.Fpa_pososto
38064>>>>>>>>>>>        End_Row
38069>>>>>>>>>>>
38069>>>>>>>>>>>        Set Form_Width    item 0 to 60
38070>>>>>>>>>>>        Set Header_Label  item 0 to "‰à›. „å›¦¬ª"
38071>>>>>>>>>>>
38071>>>>>>>>>>>        Set Form_Width    item 1 to 140
38072>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
38073>>>>>>>>>>>
38073>>>>>>>>>>>        Set Form_Width    item 2 to 70
38074>>>>>>>>>>>        Set Header_Label  item 2 to "‰à›. ‰˜«žš¦¨å˜ª"
38075>>>>>>>>>>>
38075>>>>>>>>>>>        Set Form_Width    item 3 to 88
38076>>>>>>>>>>>        Set Header_Label  item 3 to "œ¨ š¨˜­ã ‰˜«žš."
38077>>>>>>>>>>>
38077>>>>>>>>>>>        Set Form_Width    item 4 to 64
38078>>>>>>>>>>>        Set Header_Label  item 4 to "¦ æ«ž«˜"
38079>>>>>>>>>>>
38079>>>>>>>>>>>        Set Form_Width    item 5 to 45
38080>>>>>>>>>>>        Set Header_Label  item 5 to "‰˜«.”..€"
38081>>>>>>>>>>>
38081>>>>>>>>>>>
38081>>>>>>>>>>>        //AB-StoreStart
38081>>>>>>>>>>>        Property String Store_Fragma_Items public ""
38083>>>>>>>>>>>
38083>>>>>>>>>>>        //Procedure Store_Defaults
38083>>>>>>>>>>>        //   forward send Store_Defaults
38083>>>>>>>>>>>        //   Set Store_Fragma_Items to (FragmaItem(Self))
38083>>>>>>>>>>>        //end_Procedure
38083>>>>>>>>>>>
38083>>>>>>>>>>>        //Procedure Restore_Defaults
38083>>>>>>>>>>>
38083>>>>>>>>>>>        //    forward send Restore_Defaults
38083>>>>>>>>>>>        //    local string lsT
38083>>>>>>>>>>>        //    Get Store_Fragma_Items to lsT
38083>>>>>>>>>>>        //    Set FragmaItem to lsT
38083>>>>>>>>>>>        //end_Procedure
38083>>>>>>>>>>>
38083>>>>>>>>>>>        Procedure Activating
38085>>>>>>>>>>>           Forward send Activating
38087>>>>>>>>>>>           Send Rebuild_Constraints to (Item_DD(Self))
38088>>>>>>>>>>>        End_Procedure
38089>>>>>>>>>>>
38089>>>>>>>>>>>
38089>>>>>>>>>>>        //Set Color to 16776436
38089>>>>>>>>>>>        //Set TextColor to clNavy
38089>>>>>>>>>>>        //Set CurrentRowColor to 16775135
38089>>>>>>>>>>>        //Set CurrentRowTextColor to clNavy
38089>>>>>>>>>>>        //Set CurrentCellColor to 16775135
38089>>>>>>>>>>>        //Set CurrentCellTextColor to clNavy
38089>>>>>>>>>>>
38089>>>>>>>>>>>
38089>>>>>>>>>>>
38089>>>>>>>>>>>
38089>>>>>>>>>>>
38089>>>>>>>>>>>
38089>>>>>>>>>>>
38089>>>>>>>>>>>
38089>>>>>>>>>>>
38089>>>>>>>>>>>
38089>>>>>>>>>>>
38089>>>>>>>>>>>
38089>>>>>>>>>>>
38089>>>>>>>>>>>
38089>>>>>>>>>>>
38089>>>>>>>>>>>        //AB-StoreEnd
38089>>>>>>>>>>>
38089>>>>>>>>>>>    End_Object    // oSelList
38090>>>>>>>>>>>
38090>>>>>>>>>>>    Object TextBoxSub1 is a TextBoxSub
38092>>>>>>>>>>>        Set Label to "‘á¨à©ž ‰à› ¡¦ç ‚ á"
38093>>>>>>>>>>>        Set Auto_Size_State to FALSE
38094>>>>>>>>>>>        Set Location to 192 6
38095>>>>>>>>>>>        Set Size to 13 78
38096>>>>>>>>>>>    End_Object    // TextBoxSub1
38097>>>>>>>>>>>
38097>>>>>>>>>>>    Object ocode is a FormSub
38099>>>>>>>>>>>        Set Size to 13 197
38100>>>>>>>>>>>        Set Location to 192 79
38101>>>>>>>>>>>        Set Label_Col_Offset to 2
38102>>>>>>>>>>>
38102>>>>>>>>>>>        //AB-StoreStart
38102>>>>>>>>>>>
38102>>>>>>>>>>>        Procedure OnKILLFOCUS
38104>>>>>>>>>>>           // Forward Send OnChange
38104>>>>>>>>>>>            Send KeyAction to ButtonSub1
38105>>>>>>>>>>>        End_Procedure
38106>>>>>>>>>>>
38106>>>>>>>>>>>
38106>>>>>>>>>>>
38106>>>>>>>>>>>        //AB-StoreEnd
38106>>>>>>>>>>>
38106>>>>>>>>>>>    End_Object    // ocode
38107>>>>>>>>>>>
38107>>>>>>>>>>>    Object TextBoxSub2 is a TextBoxSub
38109>>>>>>>>>>>        Set Label to "‘á¨à©ž œ¨ š¨˜­ãª "
38110>>>>>>>>>>>        Set Auto_Size_State to FALSE
38111>>>>>>>>>>>        Set Location to 207 6
38112>>>>>>>>>>>        Set Size to 13 83
38113>>>>>>>>>>>    End_Object    // TextBoxSub2
38114>>>>>>>>>>>
38114>>>>>>>>>>>    Object operi is a FormSub
38116>>>>>>>>>>>        Set Size to 13 197
38117>>>>>>>>>>>        Set Location to 207 79
38118>>>>>>>>>>>        Set Label_Col_Offset to 2
38119>>>>>>>>>>>
38119>>>>>>>>>>>        //AB-StoreStart
38119>>>>>>>>>>>
38119>>>>>>>>>>>        Procedure OnKILLFOCUS
38121>>>>>>>>>>>          //  Forward Send OnChange
38121>>>>>>>>>>>            Send KeyAction to ButtonSub1
38122>>>>>>>>>>>        End_Procedure
38123>>>>>>>>>>>
38123>>>>>>>>>>>
38123>>>>>>>>>>>
38123>>>>>>>>>>>        //AB-StoreEnd
38123>>>>>>>>>>>
38123>>>>>>>>>>>    End_Object    // operi
38124>>>>>>>>>>>
38124>>>>>>>>>>>    Object RadioGroupSub1 is a RadioGroupSub
38126>>>>>>>>>>>        Set Size to 32 77
38127>>>>>>>>>>>        Set Location to 193 277
38128>>>>>>>>>>>        Object Radio1 is a RadioSub
38130>>>>>>>>>>>            Set Label to "œ¨ â®œ«˜ "
38131>>>>>>>>>>>            Set Size to 10 53
38132>>>>>>>>>>>            Set Location to 7 5
38133>>>>>>>>>>>        End_Object    // Radio1
38134>>>>>>>>>>>
38134>>>>>>>>>>>        Object Radio2 is a RadioSub
38136>>>>>>>>>>>            Set Label to "€¨®åœ  €§æ"
38137>>>>>>>>>>>            Set Size to 10 51
38138>>>>>>>>>>>            Set Location to 21 5
38139>>>>>>>>>>>        End_Object    // Radio2
38140>>>>>>>>>>>
38140>>>>>>>>>>>
38140>>>>>>>>>>>        //AB-StoreStart
38140>>>>>>>>>>>
38140>>>>>>>>>>>        Procedure Notify_Select_State integer iToItem integer iFromItem
38142>>>>>>>>>>>            //iToItem=0 => Contains, =1 => Starts with
38142>>>>>>>>>>>            Set piContains_Or_Starts to iToItem
38143>>>>>>>>>>>            Send KeyAction to ButtonSub1
38144>>>>>>>>>>>        End_Procedure
38145>>>>>>>>>>>
38145>>>>>>>>>>>        // If you set Current_radio you must set this after the
38145>>>>>>>>>>>        // radio objects have been created AND after Notify_select_State has been
38145>>>>>>>>>>>        // created. i.e. Set in bottom-code at end!!
38145>>>>>>>>>>>        //Set Current_Radio to 0
38145>>>>>>>>>>>
38145>>>>>>>>>>>
38145>>>>>>>>>>>        //AB-StoreEnd
38145>>>>>>>>>>>
38145>>>>>>>>>>>    End_Object    // RadioGroupSub1
38146>>>>>>>>>>>
38146>>>>>>>>>>>    Object ButtonSub1 is a ButtonSub
38148>>>>>>>>>>>        Set Label to "Search"
38149>>>>>>>>>>>        Set Size to 28 37
38150>>>>>>>>>>>        Set Location to 198 357
38151>>>>>>>>>>>        Set Form_FontWeight Item 0 to 800
38152>>>>>>>>>>>        Set Form_TypeFace Item 0 to "ms sans serif"
38153>>>>>>>>>>>
38153>>>>>>>>>>>        //AB-StoreStart
38153>>>>>>>>>>>
38153>>>>>>>>>>>        Set Visible_State to False
38154>>>>>>>>>>>
38154>>>>>>>>>>>        Procedure OnClick
38156>>>>>>>>>>>            Forward Send OnClick
38158>>>>>>>>>>>            Set pscode  to (Value(ocode(Self),0))
38159>>>>>>>>>>>            Set psperi  to (Value(operi(Self),0))
38160>>>>>>>>>>>            Set pscodekat  to (Value(ocodekat(Self),0))
38161>>>>>>>>>>>            send Rebuild_Constraints    to (item_DD(Self))
38162>>>>>>>>>>>            Send Beginning_Of_Data      to oSelList True
38163>>>>>>>>>>>        End_Procedure // OnClick
38164>>>>>>>>>>>
38164>>>>>>>>>>>
38164>>>>>>>>>>>
38164>>>>>>>>>>>
38164>>>>>>>>>>>
38164>>>>>>>>>>>
38164>>>>>>>>>>>
38164>>>>>>>>>>>
38164>>>>>>>>>>>
38164>>>>>>>>>>>
38164>>>>>>>>>>>
38164>>>>>>>>>>>
38164>>>>>>>>>>>
38164>>>>>>>>>>>        //AB-StoreEnd
38164>>>>>>>>>>>
38164>>>>>>>>>>>    End_Object    // ButtonSub1
38165>>>>>>>>>>>
38165>>>>>>>>>>>    Object TextBoxSub3 is a TextBoxSub
38167>>>>>>>>>>>        Set Label to "‰à›.‰˜«žš¦¨å˜ª ‚ á"
38168>>>>>>>>>>>        Set Auto_Size_State to FALSE
38169>>>>>>>>>>>        Set Location to 221 5
38170>>>>>>>>>>>        Set Size to 13 78
38171>>>>>>>>>>>    End_Object    // TextBoxSub3
38172>>>>>>>>>>>
38172>>>>>>>>>>>    Object ocodekat is a FormSub
38174>>>>>>>>>>>        Set Size to 13 197
38175>>>>>>>>>>>        Set Location to 221 78
38176>>>>>>>>>>>        Set Label_Col_Offset to 2
38177>>>>>>>>>>>
38177>>>>>>>>>>>        //AB-StoreStart
38177>>>>>>>>>>>
38177>>>>>>>>>>>        Procedure OnKILLFOCUS
38179>>>>>>>>>>>        //    Forward Send OnChange
38179>>>>>>>>>>>            Send KeyAction to ButtonSub1
38180>>>>>>>>>>>        End_Procedure
38181>>>>>>>>>>>
38181>>>>>>>>>>>
38181>>>>>>>>>>>        //AB-StoreEnd
38181>>>>>>>>>>>
38181>>>>>>>>>>>    End_Object    // ocodekat
38182>>>>>>>>>>>
38182>>>>>>>>>>>    Object oOK_bn is a ButtonSub
38184>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
38185>>>>>>>>>>>        Set Location to 237 316
38186>>>>>>>>>>>
38186>>>>>>>>>>>        //AB-StoreStart
38186>>>>>>>>>>>        Procedure OnClick
38188>>>>>>>>>>>            Send OK To (oSelList(current_object))
38189>>>>>>>>>>>        End_Procedure
38190>>>>>>>>>>>        //AB-StoreEnd
38190>>>>>>>>>>>
38190>>>>>>>>>>>    End_Object    // oOK_bn
38191>>>>>>>>>>>
38191>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
38193>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
38194>>>>>>>>>>>        Set Location to 237 371
38195>>>>>>>>>>>
38195>>>>>>>>>>>        //AB-StoreStart
38195>>>>>>>>>>>        Procedure OnClick
38197>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
38198>>>>>>>>>>>        End_Procedure
38199>>>>>>>>>>>        //AB-StoreEnd
38199>>>>>>>>>>>
38199>>>>>>>>>>>    End_Object    // oCancel_bn
38200>>>>>>>>>>>
38200>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
38202>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
38203>>>>>>>>>>>        Set Location to 237 426
38204>>>>>>>>>>>
38204>>>>>>>>>>>        //AB-StoreStart
38204>>>>>>>>>>>        Procedure OnClick
38206>>>>>>>>>>>            Send Search To (oSelList(current_object))
38207>>>>>>>>>>>        End_Procedure
38208>>>>>>>>>>>        //AB-StoreEnd
38208>>>>>>>>>>>
38208>>>>>>>>>>>    End_Object    // oSearch_bn
38209>>>>>>>>>>>
38209>>>>>>>>>>>
38209>>>>>>>>>>>    //AB-StoreStart
38209>>>>>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
38210>>>>>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
38211>>>>>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
38212>>>>>>>>>>>
38212>>>>>>>>>>>
38212>>>>>>>>>>>    procedure page integer pagemode
38214>>>>>>>>>>>        forward send page pagemode
38216>>>>>>>>>>>        set location to 40,40
38217>>>>>>>>>>>    end_procedure
38218>>>>>>>>>>>
38218>>>>>>>>>>>    procedure request_cancel
38220>>>>>>>>>>>        forward send request_cancel
38222>>>>>>>>>>>        set value of (ocode(self)) to ''
38223>>>>>>>>>>>        set value of (operi(self)) to ''
38224>>>>>>>>>>>        set value of (ocodekat(self)) to ''
38225>>>>>>>>>>>        Set psperi  to ''
38226>>>>>>>>>>>        Set pscode  to ''
38227>>>>>>>>>>>        Set pscodekat TO ''
38228>>>>>>>>>>>    end_procedure
38229>>>>>>>>>>>
38229>>>>>>>>>>>
38229>>>>>>>>>>>
38229>>>>>>>>>>>
38229>>>>>>>>>>>    //AB-StoreEnd
38229>>>>>>>>>>>
38229>>>>>>>>>>>CD_End_Object    // SL22s
38231>>>>>>>>>>>>
38231>>>>>>>>>>>
38231>>>>>>>>>>>
38231>>>>>>>>>>>//AB-StoreStart
38231>>>>>>>>>>>
38231>>>>>>>>>>>
38231>>>>>>>>>>>
38231>>>>>>>>>>>
38231>>>>>>>>>>>
38231>>>>>>>>>>>
38231>>>>>>>>>>>
38231>>>>>>>>>>>
38231>>>>>>>>>>>
38231>>>>>>>>>>>
38231>>>>>>>>>>>//AB-StoreEnd
38231>>>>>>>>>>>
38231>>>>>>>>>>>//AB/ End_Object    // prj
38231>>>>>>>>>Use sl022.SL         // sl022
38231>>>>>>>>>
38231>>>>>>>>>//DDB-Selection-pkg-End
38231>>>>>>>>>//DDB-FileEnd
38231>>>>>>>    Use WITEMCL.DD
INCLUDING FILE: WITEMCL.DD
38231>>>>>>>>>//DDB-FileStart
38231>>>>>>>>>//DDB-HeaderStart
38231>>>>>>>>>
38231>>>>>>>>>// File Name : WITEMCL.DD
38231>>>>>>>>>// Class Name: Witemcl_DataDictionary
38231>>>>>>>>>// Revision  : 16
38231>>>>>>>>>// Version   : 2
38231>>>>>>>>>
38231>>>>>>>>>Use  Windows           // Basic Definitions
38231>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
38231>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38231>>>>>>>>>
38231>>>>>>>>>Open Witemcl
38233>>>>>>>>>Open Witemcld
38235>>>>>>>>>Open Item
38237>>>>>>>>>Open Sysrecw
38239>>>>>>>>>
38239>>>>>>>>>//DDB-HeaderEnd
38239>>>>>>>>>//DDB-SelectionStart
38239>>>>>>>>>//DDB/ ExternalSelectionList SL100  sl100.sl
38239>>>>>>>>>Register_Object SL100
38239>>>>>>>>>//DDB-SelectionEnd
38239>>>>>>>>>
38239>>>>>>>>>Class Witemcl_DataDictionary  is a DataDictionary_Sec
38240>>>>>>>>> 
38240>>>>>>>>>    // Update:
38240>>>>>>>>> 
38240>>>>>>>>>    Procedure Update
38241>>>>>>>>>        Forward Send Update  
38243>>>>>>>>>        move item.item_descr to witemcl.item_descr
38244>>>>>>>>>    End_Procedure   // Update
38245>>>>>>>>> 
38245>>>>>>>>>
38245>>>>>>>>>    // Define_Fields:
38245>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
38245>>>>>>>>>
38245>>>>>>>>>    Procedure Define_Fields
38246>>>>>>>>>        Forward Send Define_Fields
38248>>>>>>>>>        //DDB-Generated-Code-Location
38248>>>>>>>>>        //DDB-DefineFieldStart
38248>>>>>>>>>
38248>>>>>>>>>        Set Main_File            To Witemcl.File_Number
38249>>>>>>>>>        Set Cascade_Delete_State To FALSE
38250>>>>>>>>>
38250>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
38251>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
38252>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38253>>>>>>>>>
38253>>>>>>>>>        // Child (Client) file structure................
38253>>>>>>>>>        Send Add_Client_File  Witemcld.File_Number
38254>>>>>>>>>
38254>>>>>>>>>        // Parent (Server) file structure...............
38254>>>>>>>>>        Send Add_Server_File  Item.File_Number
38255>>>>>>>>>
38255>>>>>>>>>        // External (System) file structure.............
38255>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
38256>>>>>>>>>
38256>>>>>>>>>        Define_Auto_Increment  Sysrecw.Witemcl_Rec0  To Witemcl.Rec0
38259>>>>>>>>>
38259>>>>>>>>>        // Field-based properties.......................
38259>>>>>>>>>
38259>>>>>>>>>        // Witemcl.Item_Code
38259>>>>>>>>>
38259>>>>>>>>>        // Witemcl.Client_Code
38259>>>>>>>>>        Set Field_Prompt_Object    Field Witemcl.Client_Code To (SL100(Self))
38260>>>>>>>>>
38260>>>>>>>>>        // Witemcl.Client_Itemcode
38260>>>>>>>>>
38260>>>>>>>>>        // Witemcl.Client_Date
38260>>>>>>>>>        Set Field_Mask_Type        Field Witemcl.Client_Date To MASK_DATE_WINDOW
38261>>>>>>>>>
38261>>>>>>>>>        // Witemcl.Client_Price
38261>>>>>>>>>        Set Field_Mask_Type        Field Witemcl.Client_Price To MASK_NUMERIC_WINDOW
38262>>>>>>>>>
38262>>>>>>>>>        // Witemcl.Item_Descr
38262>>>>>>>>>
38262>>>>>>>>>        // Witemcl.Rec0
38262>>>>>>>>>
38262>>>>>>>>>        // Witemcl.Is_Client
38262>>>>>>>>>
38262>>>>>>>>>        //DDB-DefineFieldEnd
38262>>>>>>>>>    End_Procedure    // Define_Fields
38263>>>>>>>>>
38263>>>>>>>>>    // Field_Defaults:
38263>>>>>>>>>    // This procedure is used to establish default field values.
38263>>>>>>>>>
38263>>>>>>>>>    Procedure Field_Defaults
38264>>>>>>>>>        Forward Send Field_Defaults
38266>>>>>>>>>        //DDB-Generated-Code-Location
38266>>>>>>>>>        //DDB-FieldDefaultStart
38266>>>>>>>>>        //DDB-FieldDefaultEnd
38266>>>>>>>>>    End_Procedure    // Field_Defaults
38267>>>>>>>>>
38267>>>>>>>>>End_Class    // Witemcl_DataDictionary
38268>>>>>>>>>//DDB-Selection-pkg-Start
38268>>>>>>>>>
38268>>>>>>>>>Use sl100.sl         // SL100
INCLUDING FILE: SL100.SL
38268>>>>>>>>>>>//AB/ Project SL100:PELATES
38268>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
38268>>>>>>>>>>>//AB/     Set ProjectName to "SL100:PELATES"
38268>>>>>>>>>>>//AB/     Set ProjectFileName to "SL100.SL"
38268>>>>>>>>>>>
38268>>>>>>>>>>>// Project Object Structure
38268>>>>>>>>>>>//   SL100 is a dbModalPanelSub
38268>>>>>>>>>>>//     Cities_DD is a DataDictionary
38268>>>>>>>>>>>//     Payresp_DD is a DataDictionary
38268>>>>>>>>>>>//     Clients_DD is a DataDictionary
38268>>>>>>>>>>>//     oSelList is a dbListSub
38268>>>>>>>>>>>//     oOK_bn is a ButtonSub
38268>>>>>>>>>>>//     oCancel_bn is a ButtonSub
38268>>>>>>>>>>>//     oSearch_bn is a ButtonSub
38268>>>>>>>>>>>
38268>>>>>>>>>>>// Register all objects
38268>>>>>>>>>>>Register_Object Cities_DD
38268>>>>>>>>>>>Register_Object Clients_DD
38268>>>>>>>>>>>Register_Object oCancel_bn
38268>>>>>>>>>>>Register_Object oOK_bn
38268>>>>>>>>>>>Register_Object oSearch_bn
38268>>>>>>>>>>>Register_Object oSelList
38268>>>>>>>>>>>Register_Object Payresp_DD
38268>>>>>>>>>>>Register_Object SL100
38268>>>>>>>>>>>
38268>>>>>>>>>>>
38268>>>>>>>>>>>//AB-IgnoreStart
38268>>>>>>>>>>>
38268>>>>>>>>>>>Use DFAllEnt.pkg
38268>>>>>>>>>>>Use dbList.Sub
38268>>>>>>>>>>>Use Button.Sub
38268>>>>>>>>>>>
38268>>>>>>>>>>>
38268>>>>>>>>>>>Use CITIES.DD
INCLUDING FILE: CITIES.DD
38268>>>>>>>>>>>>>//DDB-FileStart
38268>>>>>>>>>>>>>//DDB-HeaderStart
38268>>>>>>>>>>>>>
38268>>>>>>>>>>>>>// File Name : CITIES.DD
38268>>>>>>>>>>>>>// Class Name: Cities_DataDictionary
38268>>>>>>>>>>>>>// Revision  : 14
38268>>>>>>>>>>>>>// Version   : 2
38268>>>>>>>>>>>>>
38268>>>>>>>>>>>>>Use  Windows           // Basic Definitions
38268>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
38268>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38268>>>>>>>>>>>>>
38268>>>>>>>>>>>>>Open Cities
38270>>>>>>>>>>>>>Open Clients
38272>>>>>>>>>>>>>Open Towns
38274>>>>>>>>>>>>>
38274>>>>>>>>>>>>>//DDB-HeaderEnd
38274>>>>>>>>>>>>>//DDB-SelectionStart
38274>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.SL
38274>>>>>>>>>>>>>Register_Object sl198
38274>>>>>>>>>>>>>//DDB-SelectionEnd
38274>>>>>>>>>>>>>
38274>>>>>>>>>>>>>Class Cities_DataDictionary  is a DataDictionary_Sec
38275>>>>>>>>>>>>>
38275>>>>>>>>>>>>>    // Define_Fields:
38275>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
38275>>>>>>>>>>>>>
38275>>>>>>>>>>>>>    Procedure Define_Fields
38276>>>>>>>>>>>>>        Forward Send Define_Fields
38278>>>>>>>>>>>>>        //DDB-Generated-Code-Location
38278>>>>>>>>>>>>>        //DDB-DefineFieldStart
38278>>>>>>>>>>>>>
38278>>>>>>>>>>>>>        Set Main_File            To Cities.File_Number
38279>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
38280>>>>>>>>>>>>>
38280>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
38281>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
38282>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38283>>>>>>>>>>>>>
38283>>>>>>>>>>>>>        // Child (Client) file structure................
38283>>>>>>>>>>>>>        Send Add_Client_File  Clients.File_Number
38284>>>>>>>>>>>>>
38284>>>>>>>>>>>>>        // Parent (Server) file structure...............
38284>>>>>>>>>>>>>        Send Add_Server_File  Towns.File_Number
38285>>>>>>>>>>>>>
38285>>>>>>>>>>>>>        // Field-based properties.......................
38285>>>>>>>>>>>>>
38285>>>>>>>>>>>>>        // Cities.City_Id
38285>>>>>>>>>>>>>        Set Field_Options          Field Cities.City_Id To DD_AUTOFIND   
38286>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cities.City_Id To (sl198(Self))
38287>>>>>>>>>>>>>        Set Key_Field_State        Field Cities.City_Id To TRUE
38288>>>>>>>>>>>>>
38288>>>>>>>>>>>>>        // Cities.City_Descr
38288>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cities.City_Descr To (sl198(Self))
38289>>>>>>>>>>>>>
38289>>>>>>>>>>>>>        // Cities.Town_Id
38289>>>>>>>>>>>>>
38289>>>>>>>>>>>>>        //DDB-DefineFieldEnd
38289>>>>>>>>>>>>>    End_Procedure    // Define_Fields
38290>>>>>>>>>>>>>
38290>>>>>>>>>>>>>    // Field_Defaults:
38290>>>>>>>>>>>>>    // This procedure is used to establish default field values.
38290>>>>>>>>>>>>>
38290>>>>>>>>>>>>>    Procedure Field_Defaults
38291>>>>>>>>>>>>>        Forward Send Field_Defaults
38293>>>>>>>>>>>>>        //DDB-Generated-Code-Location
38293>>>>>>>>>>>>>        //DDB-FieldDefaultStart
38293>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
38293>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
38294>>>>>>>>>>>>>
38294>>>>>>>>>>>>>End_Class    // Cities_DataDictionary
38295>>>>>>>>>>>>>//DDB-Selection-pkg-Start
38295>>>>>>>>>>>>>
38295>>>>>>>>>>>>>Use sl198.SL         // sl198
INCLUDING FILE: SL198.SL
38295>>>>>>>>>>>>>>>//AB/ Project sl198:cities
38295>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
38295>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl198:cities"
38295>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl198.SL"
38295>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
38295>>>>>>>>>>>>>>>
38295>>>>>>>>>>>>>>>// Project Object Structure
38295>>>>>>>>>>>>>>>//   sl198 is a dbModalPanelSub
38295>>>>>>>>>>>>>>>//     Cities_DD is a DataDictionary
38295>>>>>>>>>>>>>>>//     oSelList is a dbListSub
38295>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
38295>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
38295>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
38295>>>>>>>>>>>>>>>
38295>>>>>>>>>>>>>>>// Register all objects
38295>>>>>>>>>>>>>>>Register_Object Cities_DD
38295>>>>>>>>>>>>>>>Register_Object oCancel_bn
38295>>>>>>>>>>>>>>>Register_Object oOK_bn
38295>>>>>>>>>>>>>>>Register_Object oSearch_bn
38295>>>>>>>>>>>>>>>Register_Object oSelList
38295>>>>>>>>>>>>>>>Register_Object sl198
38295>>>>>>>>>>>>>>>
38295>>>>>>>>>>>>>>>
38295>>>>>>>>>>>>>>>//AB-IgnoreStart
38295>>>>>>>>>>>>>>>
38295>>>>>>>>>>>>>>>Use DFAllEnt.pkg
38295>>>>>>>>>>>>>>>Use dbList.Sub
38295>>>>>>>>>>>>>>>Use Button.Sub
38295>>>>>>>>>>>>>>>
38295>>>>>>>>>>>>>>>
38295>>>>>>>>>>>>>>>Use CITIES.DD
38295>>>>>>>>>>>>>>>
38295>>>>>>>>>>>>>>>//AB-IgnoreEnd
38295>>>>>>>>>>>>>>>
38295>>>>>>>>>>>>>>>Object sl198 is a dbModalPanelSub
38297>>>>>>>>>>>>>>>    Set Label to "€¨®œå¦ æ¢œà¤"
38298>>>>>>>>>>>>>>>    Set Size to 148 297
38299>>>>>>>>>>>>>>>    Set Location to 4 5
38300>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
38301>>>>>>>>>>>>>>>    Set Modal_State to FALSE
38302>>>>>>>>>>>>>>>
38302>>>>>>>>>>>>>>>    //AB-DDOStart
38302>>>>>>>>>>>>>>>
38302>>>>>>>>>>>>>>>    Object Cities_DD is a Cities_DataDictionary
38304>>>>>>>>>>>>>>>
38304>>>>>>>>>>>>>>>        //AB-StoreStart
38304>>>>>>>>>>>>>>>                
38304>>>>>>>>>>>>>>>                
38304>>>>>>>>>>>>>>>        //AB-StoreEnd
38304>>>>>>>>>>>>>>>
38304>>>>>>>>>>>>>>>    End_Object    // Cities_DD
38305>>>>>>>>>>>>>>>
38305>>>>>>>>>>>>>>>    Set Main_DD to (Cities_DD(self))
38306>>>>>>>>>>>>>>>    Set Server to (Cities_DD(self))
38307>>>>>>>>>>>>>>>
38307>>>>>>>>>>>>>>>    //AB-DDOEnd
38307>>>>>>>>>>>>>>>
38307>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
38309>>>>>>>>>>>>>>>        Set Main_File to Cities.File_Number
38310>>>>>>>>>>>>>>>        Set Size to 105 280
38311>>>>>>>>>>>>>>>        Set Location to 6 6
38312>>>>>>>>>>>>>>>
38312>>>>>>>>>>>>>>>        Begin_Row
38315>>>>>>>>>>>>>>>            Entry_Item Cities.City_id
38316>>>>>>>>>>>>>>>            Entry_Item Cities.City_descr
38317>>>>>>>>>>>>>>>        End_Row
38322>>>>>>>>>>>>>>>
38322>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 50
38323>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
38324>>>>>>>>>>>>>>>        
38324>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 221
38325>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
38326>>>>>>>>>>>>>>>        
38326>>>>>>>>>>>>>>>
38326>>>>>>>>>>>>>>>        //AB-StoreStart
38326>>>>>>>>>>>>>>>        
38326>>>>>>>>>>>>>>>        Set Column_Option Item 0 to NoEnter True
38327>>>>>>>>>>>>>>>        
38327>>>>>>>>>>>>>>>        
38327>>>>>>>>>>>>>>>        
38327>>>>>>>>>>>>>>>        
38327>>>>>>>>>>>>>>>        
38327>>>>>>>>>>>>>>>        //AB-StoreEnd
38327>>>>>>>>>>>>>>>
38327>>>>>>>>>>>>>>>    End_Object    // oSelList
38328>>>>>>>>>>>>>>>
38328>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
38330>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
38331>>>>>>>>>>>>>>>        Set Location to 115 126
38332>>>>>>>>>>>>>>>
38332>>>>>>>>>>>>>>>        //AB-StoreStart
38332>>>>>>>>>>>>>>>        Procedure OnClick
38334>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
38335>>>>>>>>>>>>>>>        End_Procedure
38336>>>>>>>>>>>>>>>        //AB-StoreEnd
38336>>>>>>>>>>>>>>>
38336>>>>>>>>>>>>>>>    End_Object    // oOK_bn
38337>>>>>>>>>>>>>>>
38337>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
38339>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
38340>>>>>>>>>>>>>>>        Set Location to 115 181
38341>>>>>>>>>>>>>>>
38341>>>>>>>>>>>>>>>        //AB-StoreStart
38341>>>>>>>>>>>>>>>        Procedure OnClick
38343>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
38344>>>>>>>>>>>>>>>        End_Procedure
38345>>>>>>>>>>>>>>>        //AB-StoreEnd
38345>>>>>>>>>>>>>>>
38345>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
38346>>>>>>>>>>>>>>>
38346>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
38348>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
38349>>>>>>>>>>>>>>>        Set Location to 115 236
38350>>>>>>>>>>>>>>>
38350>>>>>>>>>>>>>>>        //AB-StoreStart
38350>>>>>>>>>>>>>>>        Procedure OnClick
38352>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
38353>>>>>>>>>>>>>>>        End_Procedure
38354>>>>>>>>>>>>>>>        //AB-StoreEnd
38354>>>>>>>>>>>>>>>
38354>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
38355>>>>>>>>>>>>>>>
38355>>>>>>>>>>>>>>>
38355>>>>>>>>>>>>>>>    //AB-StoreStart
38355>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
38356>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
38357>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
38358>>>>>>>>>>>>>>>    //AB-StoreEnd
38358>>>>>>>>>>>>>>>
38358>>>>>>>>>>>>>>>End_Object    // sl198
38359>>>>>>>>>>>>>>>
38359>>>>>>>>>>>>>>>//AB/ End_Object    // prj
38359>>>>>>>>>>>>>
38359>>>>>>>>>>>>>//DDB-Selection-pkg-End
38359>>>>>>>>>>>>>//DDB-FileEnd
38359>>>>>>>>>>>Use PAYRESP.DD
INCLUDING FILE: PAYRESP.DD
38359>>>>>>>>>>>>>//DDB-FileStart
38359>>>>>>>>>>>>>//DDB-HeaderStart
38359>>>>>>>>>>>>>
38359>>>>>>>>>>>>>// File Name : PAYRESP.DD
38359>>>>>>>>>>>>>// Class Name: Payresp_DataDictionary
38359>>>>>>>>>>>>>// Revision  : 78
38359>>>>>>>>>>>>>// Version   : 2
38359>>>>>>>>>>>>>
38359>>>>>>>>>>>>>Use  Windows           // Basic Definitions
38359>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
38359>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38359>>>>>>>>>>>>>
38359>>>>>>>>>>>>>Open Payresp
INCLUDING FILE: PAYRESP.FD
38361>>>>>>>>>>>>>Open Prspbank
INCLUDING FILE: PRSPBANK.FD
38363>>>>>>>>>>>>>Open Tppresp
INCLUDING FILE: TPPRESP.FD
38365>>>>>>>>>>>>>Open Clients
38367>>>>>>>>>>>>>Open Sysrecc
INCLUDING FILE: SYSRECC.FD
38369>>>>>>>>>>>>>
38369>>>>>>>>>>>>>//DDB-HeaderEnd
38369>>>>>>>>>>>>>//DDB-ValidationStart
38369>>>>>>>>>>>>>
38369>>>>>>>>>>>>>Register_Object Payresp_Presp_Doy_VT
38369>>>>>>>>>>>>>Register_Object Payresp_Presp_Categfpa_VT
38369>>>>>>>>>>>>>Register_Object Payresp_Feregios_VT
38369>>>>>>>>>>>>>
38369>>>>>>>>>>>>>Object Payresp_Presp_Doy_VT  is a CodeValidationTable
38371>>>>>>>>>>>>>    Set Type_Value        To "DOY"
38372>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
38373>>>>>>>>>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
38374>>>>>>>>>>>>>    //DDB-ValidationCustomStart
38374>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
38374>>>>>>>>>>>>>End_Object   // Payresp_Presp_Doy_VT
38375>>>>>>>>>>>>>
38375>>>>>>>>>>>>>Object Payresp_Presp_Categfpa_VT  is a CodeValidationTable
38377>>>>>>>>>>>>>    Set Type_Value        To "VAT_STATUS"
38378>>>>>>>>>>>>>    Set Validate_State    To FALSE
38379>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
38380>>>>>>>>>>>>>    //DDB-ValidationCustomStart
38380>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
38380>>>>>>>>>>>>>End_Object   // Payresp_Presp_Categfpa_VT
38381>>>>>>>>>>>>>
38381>>>>>>>>>>>>>Object Payresp_Feregios_VT  is a CodeValidationTable
38383>>>>>>>>>>>>>    Set Type_Value        To "FEREGIOS"
38384>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
38385>>>>>>>>>>>>>    Set Table_Title       To "ƒœå¡«œª ”œ¨œšš¬æ«ž«˜ª ”¦¨âà¤"
38386>>>>>>>>>>>>>    //DDB-ValidationCustomStart
38386>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
38386>>>>>>>>>>>>>End_Object   // Payresp_Feregios_VT
38387>>>>>>>>>>>>>//DDB-ValidationEnd
38387>>>>>>>>>>>>>//DDB-SelectionStart
38387>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl111  sl111.SL
38387>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
38387>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
38387>>>>>>>>>>>>>Register_Object sl111
38387>>>>>>>>>>>>>Register_Object sl198
38387>>>>>>>>>>>>>Register_Object sl197
38387>>>>>>>>>>>>>//DDB-SelectionEnd
38387>>>>>>>>>>>>>
38387>>>>>>>>>>>>>Open Year      
38389>>>>>>>>>>>>>
38389>>>>>>>>>>>>>Class Payresp_DataDictionary  is a DataDictionary_Sec
38390>>>>>>>>>>>>>
38390>>>>>>>>>>>>>    Procedure Construct_Object
38391>>>>>>>>>>>>>        Forward Send Construct_Object
38393>>>>>>>>>>>>>        Property Integer piCheckPlaf        Public 0
38394>>>>>>>>>>>>>    End_procedure
38395>>>>>>>>>>>>>
38395>>>>>>>>>>>>>    Procedure Update
38396>>>>>>>>>>>>>        Forward Send Update
38398>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to payresp.Company_Code
38399>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to payresp.Branch_Code
38400>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to payresp.Year_Year
38401>>>>>>>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
38401>>>>>>>>>>>>>        Move (payresp.Xreosh-payresp.Pistosh)   to payresp.Ypoloipo
38402>>>>>>>>>>>>>        Move (payresp.Plafon-payresp.ypoloipo)  to payresp.Overhead
38403>>>>>>>>>>>>>
38403>>>>>>>>>>>>>        //betolink
38403>>>>>>>>>>>>>        Move SysCurXR.Beto_Site      to payresp.presp_SiteW
38404>>>>>>>>>>>>>        Move payresp.presp_Rec0      to payresp.presp_SN
38405>>>>>>>>>>>>>        Move payresp.presp_id        to payresp.presp_Repm
38406>>>>>>>>>>>>>
38406>>>>>>>>>>>>>    End_Procedure   // Update
38407>>>>>>>>>>>>>
38407>>>>>>>>>>>>>     Procedure Creating
38408>>>>>>>>>>>>>        Forward Send Creating
38410>>>>>>>>>>>>>        // Insert Code Here
38410>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(payresp.presp_Rec0))))));                                    to payresp.presp_Recr
38411>>>>>>>>>>>>>        Move '1'                    to payresp.presp_Active
38412>>>>>>>>>>>>>        get fsgCode_With_Zeroes payresp.presp_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to payresp.presp_ID
38413>>>>>>>>>>>>>        clear year
38414>>>>>>>>>>>>>        move syscurxr.branch_code   to year.branch_code
38415>>>>>>>>>>>>>        move syscurxr.company_code  to year.company_code
38416>>>>>>>>>>>>>        move syscurxr.year_year     to YEAR.year_year
38417>>>>>>>>>>>>>        find eq year by index.1
38418>>>>>>>>>>>>>>
38418>>>>>>>>>>>>>        if (found=1) begin
38420>>>>>>>>>>>>>            move year.payresp_plafon to payresp.plafon
38421>>>>>>>>>>>>>            move year.payresp_ofeilh to payresp.orio_syn_ofeilh
38422>>>>>>>>>>>>>        end
38422>>>>>>>>>>>>>>
38422>>>>>>>>>>>>>    End_Procedure   // Creating
38423>>>>>>>>>>>>>
38423>>>>>>>>>>>>>   Function Validate_Save  Returns Integer
38424>>>>>>>>>>>>>        Integer iReturnVal iCheck iYes
38425>>>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
38427>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
38429>>>>>>>>>>>>>
38429>>>>>>>>>>>>>            If (Sysfile.Check_Afm=1) Begin
38431>>>>>>>>>>>>>                Move (Check_AFM(payresp.presp_Afm)) to iCheck
ERROR: 54 Invalid symbol in expression CHECK_AFM ON LINE: 109 (38431) OF FILE: V:\Vdf6\Develop\Empor\DDSrc\PAYRESP.DD
38432>>>>>>>>>>>>>                If (iCheck) Begin
38434>>>>>>>>>>>>>                         If (iCheck=1) Move 4001 to iReturnVal
38437>>>>>>>>>>>>>                    Else If (iCheck=2) Move 4002 to iReturnVal
38441>>>>>>>>>>>>>                    Else If (iCheck=3) Move 4003 to iReturnVal
38445>>>>>>>>>>>>>                End
38445>>>>>>>>>>>>>>
38445>>>>>>>>>>>>>            End
38445>>>>>>>>>>>>>>
38445>>>>>>>>>>>>>
38445>>>>>>>>>>>>>           If (piCheckPlaf(Self)=1) Begin
38447>>>>>>>>>>>>>                If ((PayResp.Plafon>0) And ((PayResp.Ypoloipo+PayResp.Posa_Apo_Dap)>PayResp.Plafon)) Begin
38449>>>>>>>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 5000 Payresp'  to iYes
38450>>>>>>>>>>>>>                        If (iYes=MBR_NO) Error 4004 'DDC111: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4004 to iReturnVal
38453>>>>>>>>>>>>>                End
38453>>>>>>>>>>>>>>
38453>>>>>>>>>>>>>                Else If ((PayResp.Orio_Syn_Ofeilh>0) And (PayResp.Synolikh_Ofeilh>PayResp.Orio_Syn_Ofeilh)) Begin
38456>>>>>>>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 5001 Payresp' to iYes
38457>>>>>>>>>>>>>                        If (iYes=MBR_NO) Error 4005 'DDC111: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
38460>>>>>>>>>>>>>                End
38460>>>>>>>>>>>>>>
38460>>>>>>>>>>>>>           End
38460>>>>>>>>>>>>>>
38460>>>>>>>>>>>>>        If (iReturnVal) Send Operation_Not_Allowed iReturnVal
38463>>>>>>>>>>>>>        End
38463>>>>>>>>>>>>>>
38463>>>>>>>>>>>>>        Function_Return iReturnVal
38464>>>>>>>>>>>>>    End_Function   // Validate_Save
38465>>>>>>>>>>>>>
38465>>>>>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
38466>>>>>>>>>>>>>        String lsError_Message
38467>>>>>>>>>>>>>        Case Begin
38467>>>>>>>>>>>>>            Case (iError_Num = 4001)
38469>>>>>>>>>>>>>                Move "DDC 100: Š˜¤Ÿ˜©£â¤¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤" to lsError_Message
38470>>>>>>>>>>>>>              Case Break
38471>>>>>>>>>>>>>            Case (iError_Num = 4002)
38474>>>>>>>>>>>>>                Move "DDC 100: ’¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤ ›œ¤ œå¤˜  9 ¯ã­ ¦" to lsError_Message
38475>>>>>>>>>>>>>              Case Break
38476>>>>>>>>>>>>>            Case (iError_Num = 4003)
38479>>>>>>>>>>>>>                Move "DDC 100: €¡˜«á¢¢ž¢¦ª ®˜¨˜¡«ã¨˜ª ©«¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤ " to lsError_Message
38480>>>>>>>>>>>>>              Case Break
38481>>>>>>>>>>>>>            Case (iError_Num = 4004)
38484>>>>>>>>>>>>>                Move "DDC 100: „š ¤œ ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç" to lsError_Message
38485>>>>>>>>>>>>>              Case Break
38486>>>>>>>>>>>>>            Case (iError_Num = 4005)
38489>>>>>>>>>>>>>                Move "DDC 100: „š ¤œ ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª" to lsError_Message
38490>>>>>>>>>>>>>              Case Break
38491>>>>>>>>>>>>>            Case Else
38491>>>>>>>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
38493>>>>>>>>>>>>>        Case End
38493>>>>>>>>>>>>>        Error iError_Num lsError_Message
38494>>>>>>>>>>>>>>
38494>>>>>>>>>>>>>    End_Procedure // operation_not_allowed
38495>>>>>>>>>>>>>
38495>>>>>>>>>>>>>
38495>>>>>>>>>>>>>
38495>>>>>>>>>>>>>    Procedure Define_Fields
38496>>>>>>>>>>>>>        Forward Send Define_Fields
38498>>>>>>>>>>>>>        //DDB-Generated-Code-Location
38498>>>>>>>>>>>>>        //DDB-DefineFieldStart
38498>>>>>>>>>>>>>
38498>>>>>>>>>>>>>        Set Main_File            To Payresp.File_Number
38499>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
38500>>>>>>>>>>>>>
38500>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
38501>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
38502>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38503>>>>>>>>>>>>>
38503>>>>>>>>>>>>>        // Child (Client) file structure................
38503>>>>>>>>>>>>>        Send Add_Client_File  Prspbank.File_Number
38504>>>>>>>>>>>>>        Send Add_Client_File  Tppresp.File_Number
38505>>>>>>>>>>>>>        Send Add_Client_File  Clients.File_Number
38506>>>>>>>>>>>>>
38506>>>>>>>>>>>>>        // External (System) file structure.............
38506>>>>>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
38507>>>>>>>>>>>>>
38507>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecc.Payresp_Rec0  To Payresp.Presp_Rec0
38510>>>>>>>>>>>>>
38510>>>>>>>>>>>>>        // Field-based properties.......................
38510>>>>>>>>>>>>>
38510>>>>>>>>>>>>>        // Payresp.Company_Code
38510>>>>>>>>>>>>>
38510>>>>>>>>>>>>>        // Payresp.Branch_Code
38510>>>>>>>>>>>>>
38510>>>>>>>>>>>>>        // Payresp.Year_Year
38510>>>>>>>>>>>>>
38510>>>>>>>>>>>>>        // Payresp.Custprom_Code
38510>>>>>>>>>>>>>
38510>>>>>>>>>>>>>        // Payresp.Presp_Id
38510>>>>>>>>>>>>>        Set Field_Options          Field Payresp.Presp_Id To DD_AUTOFIND    DD_NOPUT      
38511>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Id To (sl111(Self))
38512>>>>>>>>>>>>>        Set Key_Field_State        Field Payresp.Presp_Id To TRUE
38513>>>>>>>>>>>>>
38513>>>>>>>>>>>>>        // Payresp.Presp_Name
38513>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Name To (sl111(Self))
38514>>>>>>>>>>>>>
38514>>>>>>>>>>>>>        // Payresp.Presp_Afm
38514>>>>>>>>>>>>>
38514>>>>>>>>>>>>>        // Payresp.Presp_Rec0
38514>>>>>>>>>>>>>
38514>>>>>>>>>>>>>        // Payresp.Custprom_Recr
38514>>>>>>>>>>>>>
38514>>>>>>>>>>>>>        // Payresp.Presp_Recr
38514>>>>>>>>>>>>>
38514>>>>>>>>>>>>>        // Payresp.Last_Xreosh
38514>>>>>>>>>>>>>
38514>>>>>>>>>>>>>        // Payresp.Last_Pistosh
38514>>>>>>>>>>>>>
38514>>>>>>>>>>>>>        // Payresp.Last_Order
38514>>>>>>>>>>>>>
38514>>>>>>>>>>>>>        // Payresp.Presp_Doy
38514>>>>>>>>>>>>>        Set Field_Value_Table      Field Payresp.Presp_Doy To (Payresp_Presp_Doy_VT(Self))
38515>>>>>>>>>>>>>
38515>>>>>>>>>>>>>        // Payresp.Presp_Address
38515>>>>>>>>>>>>>
38515>>>>>>>>>>>>>        // Payresp.Presp_City_Id
38515>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_City_Id To (sl198(Self))
38516>>>>>>>>>>>>>
38516>>>>>>>>>>>>>        // Payresp.Presp_Area
38516>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Area To (sl197(Self))
38517>>>>>>>>>>>>>
38517>>>>>>>>>>>>>        // Payresp.Presp_Job
38517>>>>>>>>>>>>>
38517>>>>>>>>>>>>>        // Payresp.Presp_Respons
38517>>>>>>>>>>>>>
38517>>>>>>>>>>>>>        // Payresp.Presp_Zipcode
38517>>>>>>>>>>>>>
38517>>>>>>>>>>>>>        // Payresp.Presp_Phone
38517>>>>>>>>>>>>>
38517>>>>>>>>>>>>>        // Payresp.Presp_Fax
38517>>>>>>>>>>>>>
38517>>>>>>>>>>>>>        // Payresp.Presp_Mobile
38517>>>>>>>>>>>>>
38517>>>>>>>>>>>>>        // Payresp.Presp_Aoh
38517>>>>>>>>>>>>>
38517>>>>>>>>>>>>>        // Payresp.Presp_Email
38517>>>>>>>>>>>>>
38517>>>>>>>>>>>>>        // Payresp.Presp_Class
38517>>>>>>>>>>>>>
38517>>>>>>>>>>>>>        // Payresp.Presp_Details
38517>>>>>>>>>>>>>
38517>>>>>>>>>>>>>        // Payresp.Presp_Sitew
38517>>>>>>>>>>>>>
38517>>>>>>>>>>>>>        // Payresp.Presp_Codem
38517>>>>>>>>>>>>>
38517>>>>>>>>>>>>>        // Payresp.Presp_Categfpa
38517>>>>>>>>>>>>>        Set Field_Value_Table      Field Payresp.Presp_Categfpa To (Payresp_Presp_Categfpa_VT(Self))
38518>>>>>>>>>>>>>
38518>>>>>>>>>>>>>        // Payresp.Presp_Fpa
38518>>>>>>>>>>>>>
38518>>>>>>>>>>>>>        // Payresp.Presp_Public
38518>>>>>>>>>>>>>
38518>>>>>>>>>>>>>        // Payresp.Presp_Sn
38518>>>>>>>>>>>>>
38518>>>>>>>>>>>>>        // Payresp.Presp_Repm
38518>>>>>>>>>>>>>
38518>>>>>>>>>>>>>        // Payresp.Presp_Active
38518>>>>>>>>>>>>>
38518>>>>>>>>>>>>>        // Payresp.Presp_Reported
38518>>>>>>>>>>>>>
38518>>>>>>>>>>>>>        // Payresp.Presp_Pelprom
38518>>>>>>>>>>>>>
38518>>>>>>>>>>>>>        // Payresp.Presp_Lastupd
38518>>>>>>>>>>>>>
38518>>>>>>>>>>>>>        // Payresp.Presp_Markexp
38518>>>>>>>>>>>>>
38518>>>>>>>>>>>>>        // Payresp.Presp_Catjob
38518>>>>>>>>>>>>>
38518>>>>>>>>>>>>>        // Payresp.Is_Promhtheyths
38518>>>>>>>>>>>>>
38518>>>>>>>>>>>>>        // Payresp.Xreosh
38518>>>>>>>>>>>>>
38518>>>>>>>>>>>>>        // Payresp.Pistosh
38518>>>>>>>>>>>>>
38518>>>>>>>>>>>>>        // Payresp.Ypoloipo
38518>>>>>>>>>>>>>
38518>>>>>>>>>>>>>        // Payresp.Plafon
38518>>>>>>>>>>>>>
38518>>>>>>>>>>>>>        // Payresp.Overhead
38518>>>>>>>>>>>>>
38518>>>>>>>>>>>>>        // Payresp.Presp_Add_No
38518>>>>>>>>>>>>>
38518>>>>>>>>>>>>>        // Payresp.Presp_Nomos
38518>>>>>>>>>>>>>
38518>>>>>>>>>>>>>        // Payresp.Presp_Xora
38518>>>>>>>>>>>>>
38518>>>>>>>>>>>>>        // Payresp.Polh_Recr
38518>>>>>>>>>>>>>
38518>>>>>>>>>>>>>        // Payresp.Synolikh_Ofeilh
38518>>>>>>>>>>>>>
38518>>>>>>>>>>>>>        // Payresp.Stoxos_Ipal
38518>>>>>>>>>>>>>
38518>>>>>>>>>>>>>        // Payresp.Stoxos_Ipso
38518>>>>>>>>>>>>>
38518>>>>>>>>>>>>>        // Payresp.Poso_Se_Apait
38518>>>>>>>>>>>>>
38518>>>>>>>>>>>>>        // Payresp.Orio_Syn_Ofeilh
38518>>>>>>>>>>>>>
38518>>>>>>>>>>>>>        // Payresp.Posa_Apo_Dap
38518>>>>>>>>>>>>>
38518>>>>>>>>>>>>>        // Payresp.Feregios
38518>>>>>>>>>>>>>        Set Field_Value_Table      Field Payresp.Feregios To (Payresp_Feregios_VT(Self))
38519>>>>>>>>>>>>>
38519>>>>>>>>>>>>>        //DDB-DefineFieldEnd
38519>>>>>>>>>>>>>    End_Procedure    // Define_Fields
38520>>>>>>>>>>>>>
38520>>>>>>>>>>>>>    // Field_Defaults:
38520>>>>>>>>>>>>>    // This procedure is used to establish default field values.
38520>>>>>>>>>>>>>
38520>>>>>>>>>>>>>    Procedure Field_Defaults
38521>>>>>>>>>>>>>        Forward Send Field_Defaults
38523>>>>>>>>>>>>>        //DDB-Generated-Code-Location
38523>>>>>>>>>>>>>        //DDB-FieldDefaultStart
38523>>>>>>>>>>>>>        Set Field_Changed_Value   Field Payresp.Presp_Doy To "0"
38524>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
38524>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
38525>>>>>>>>>>>>>
38525>>>>>>>>>>>>>End_Class    // Payresp_DataDictionary
38526>>>>>>>>>>>>>//DDB-Selection-pkg-Start
38526>>>>>>>>>>>>>
38526>>>>>>>>>>>>>Use sl111.SL         // sl111
INCLUDING FILE: SL111.SL
38526>>>>>>>>>>>>>>>//AB/ Project sl111
38526>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
38526>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl111"
38526>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl111.SL"
38526>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
38526>>>>>>>>>>>>>>>
38526>>>>>>>>>>>>>>>// Project Object Structure
38526>>>>>>>>>>>>>>>//   sl111 is a dbModalPanelSub
38526>>>>>>>>>>>>>>>//     Payresp_DD is a DataDictionary
38526>>>>>>>>>>>>>>>//     oSelList is a dbListSub
38526>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
38526>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
38526>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
38526>>>>>>>>>>>>>>>
38526>>>>>>>>>>>>>>>// Register all objects
38526>>>>>>>>>>>>>>>Register_Object oCancel_bn
38526>>>>>>>>>>>>>>>Register_Object oOK_bn
38526>>>>>>>>>>>>>>>Register_Object oSearch_bn
38526>>>>>>>>>>>>>>>Register_Object oSelList
38526>>>>>>>>>>>>>>>Register_Object Payresp_DD
38526>>>>>>>>>>>>>>>Register_Object sl111
38526>>>>>>>>>>>>>>>
38526>>>>>>>>>>>>>>>
38526>>>>>>>>>>>>>>>//AB-IgnoreStart
38526>>>>>>>>>>>>>>>
38526>>>>>>>>>>>>>>>Use DFAllEnt.pkg
38526>>>>>>>>>>>>>>>Use dbList.Sub
38526>>>>>>>>>>>>>>>Use Button.Sub
38526>>>>>>>>>>>>>>>
38526>>>>>>>>>>>>>>>
38526>>>>>>>>>>>>>>>Use PAYRESP.DD
38526>>>>>>>>>>>>>>>
38526>>>>>>>>>>>>>>>//AB-IgnoreEnd
38526>>>>>>>>>>>>>>>
38526>>>>>>>>>>>>>>>Object sl111 is a dbModalPanelSub
38528>>>>>>>>>>>>>>>    Set Label to "“§œçŸ¬¤¦  ¢ž¨à£é¤ "
38529>>>>>>>>>>>>>>>    Set Size to 148 443
38530>>>>>>>>>>>>>>>    Set Location to 4 5
38531>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
38532>>>>>>>>>>>>>>>    Set Modal_State to FALSE
38533>>>>>>>>>>>>>>>
38533>>>>>>>>>>>>>>>    //AB-DDOStart
38533>>>>>>>>>>>>>>>
38533>>>>>>>>>>>>>>>    Object Payresp_DD is a Payresp_DataDictionary
38535>>>>>>>>>>>>>>>    End_Object    // Payresp_DD
38536>>>>>>>>>>>>>>>
38536>>>>>>>>>>>>>>>    Set Main_DD to (Payresp_DD(self))
38537>>>>>>>>>>>>>>>    Set Server to (Payresp_DD(self))
38538>>>>>>>>>>>>>>>
38538>>>>>>>>>>>>>>>    //AB-DDOEnd
38538>>>>>>>>>>>>>>>
38538>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
38540>>>>>>>>>>>>>>>        Set Main_File to Payresp.File_Number
38541>>>>>>>>>>>>>>>        Set Size to 105 430
38542>>>>>>>>>>>>>>>        Set Location to 6 6
38543>>>>>>>>>>>>>>>
38543>>>>>>>>>>>>>>>        Begin_Row
38546>>>>>>>>>>>>>>>            Entry_Item Payresp.Presp_id
38547>>>>>>>>>>>>>>>            Entry_Item Payresp.Presp_name
38548>>>>>>>>>>>>>>>            Entry_Item Payresp.Presp_afm
38549>>>>>>>>>>>>>>>            Entry_Item Payresp.Presp_address
38550>>>>>>>>>>>>>>>            Entry_Item Payresp.Presp_phone
38551>>>>>>>>>>>>>>>        End_Row
38556>>>>>>>>>>>>>>>
38556>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 60
38557>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
38558>>>>>>>>>>>>>>>        
38558>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 106
38559>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
38560>>>>>>>>>>>>>>>        
38560>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 60
38561>>>>>>>>>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
38562>>>>>>>>>>>>>>>        
38562>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 135
38563>>>>>>>>>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
38564>>>>>>>>>>>>>>>        
38564>>>>>>>>>>>>>>>        Set Form_Width    item 4 to 60
38565>>>>>>>>>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
38566>>>>>>>>>>>>>>>        
38566>>>>>>>>>>>>>>>    End_Object    // oSelList
38567>>>>>>>>>>>>>>>
38567>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
38569>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
38570>>>>>>>>>>>>>>>        Set Location to 113 277
38571>>>>>>>>>>>>>>>
38571>>>>>>>>>>>>>>>        //AB-StoreStart
38571>>>>>>>>>>>>>>>        Procedure OnClick
38573>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
38574>>>>>>>>>>>>>>>        End_Procedure
38575>>>>>>>>>>>>>>>        //AB-StoreEnd
38575>>>>>>>>>>>>>>>
38575>>>>>>>>>>>>>>>    End_Object    // oOK_bn
38576>>>>>>>>>>>>>>>
38576>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
38578>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
38579>>>>>>>>>>>>>>>        Set Location to 113 332
38580>>>>>>>>>>>>>>>
38580>>>>>>>>>>>>>>>        //AB-StoreStart
38580>>>>>>>>>>>>>>>        Procedure OnClick
38582>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
38583>>>>>>>>>>>>>>>        End_Procedure
38584>>>>>>>>>>>>>>>        //AB-StoreEnd
38584>>>>>>>>>>>>>>>
38584>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
38585>>>>>>>>>>>>>>>
38585>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
38587>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
38588>>>>>>>>>>>>>>>        Set Location to 113 387
38589>>>>>>>>>>>>>>>
38589>>>>>>>>>>>>>>>        //AB-StoreStart
38589>>>>>>>>>>>>>>>        Procedure OnClick
38591>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
38592>>>>>>>>>>>>>>>        End_Procedure
38593>>>>>>>>>>>>>>>        //AB-StoreEnd
38593>>>>>>>>>>>>>>>
38593>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
38594>>>>>>>>>>>>>>>
38594>>>>>>>>>>>>>>>
38594>>>>>>>>>>>>>>>    //AB-StoreStart
38594>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
38595>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
38596>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
38597>>>>>>>>>>>>>>>    //AB-StoreEnd
38597>>>>>>>>>>>>>>>
38597>>>>>>>>>>>>>>>End_Object    // sl111
38598>>>>>>>>>>>>>>>
38598>>>>>>>>>>>>>>>//AB/ End_Object    // prj
38598>>>>>>>>>>>>>Use sl198.sl         // sl198
38598>>>>>>>>>>>>>Use sl197.SL         // sl197
INCLUDING FILE: SL197.SL
38598>>>>>>>>>>>>>>>//AB/ Project sl197:areas
38598>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
38598>>>>>>>>>>>>>>>//AB/         Set ProjectName to "sl197:areas"
38598>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl197.SL"
38598>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
38598>>>>>>>>>>>>>>>
38598>>>>>>>>>>>>>>>// Project Object Structure
38598>>>>>>>>>>>>>>>//   sl197 is a dbModalPanelSub
38598>>>>>>>>>>>>>>>//     Areas_DD is a DataDictionary
38598>>>>>>>>>>>>>>>//     oSelList is a dbListSub
38598>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
38598>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
38598>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
38598>>>>>>>>>>>>>>>
38598>>>>>>>>>>>>>>>// Register all objects
38598>>>>>>>>>>>>>>>Register_Object Areas_DD
38598>>>>>>>>>>>>>>>Register_Object oCancel_bn
38598>>>>>>>>>>>>>>>Register_Object oOK_bn
38598>>>>>>>>>>>>>>>Register_Object oSearch_bn
38598>>>>>>>>>>>>>>>Register_Object oSelList
38598>>>>>>>>>>>>>>>Register_Object sl197
38598>>>>>>>>>>>>>>>
38598>>>>>>>>>>>>>>>
38598>>>>>>>>>>>>>>>    //AB-IgnoreStart
38598>>>>>>>>>>>>>>>
38598>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
38598>>>>>>>>>>>>>>>    Use dbList.Sub
38598>>>>>>>>>>>>>>>    Use Button.Sub
38598>>>>>>>>>>>>>>>
38598>>>>>>>>>>>>>>>
38598>>>>>>>>>>>>>>>    Use AREAS.DD
INCLUDING FILE: AREAS.DD
38598>>>>>>>>>>>>>>>>>//DDB-FileStart
38598>>>>>>>>>>>>>>>>>//DDB-HeaderStart
38598>>>>>>>>>>>>>>>>>
38598>>>>>>>>>>>>>>>>>// File Name : AREAS.DD
38598>>>>>>>>>>>>>>>>>// Class Name: Areas_DataDictionary
38598>>>>>>>>>>>>>>>>>// Revision  : 7
38598>>>>>>>>>>>>>>>>>// Version   : 2
38598>>>>>>>>>>>>>>>>>
38598>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
38598>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
38598>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38598>>>>>>>>>>>>>>>>>
38598>>>>>>>>>>>>>>>>>Open Areas
38600>>>>>>>>>>>>>>>>>Open Clients
38602>>>>>>>>>>>>>>>>>
38602>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
38602>>>>>>>>>>>>>>>>>//DDB-SelectionStart
38602>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
38602>>>>>>>>>>>>>>>>>Register_Object sl197
38602>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
38602>>>>>>>>>>>>>>>>>
38602>>>>>>>>>>>>>>>>>Class Areas_DataDictionary  is a DataDictionary_Sec
38603>>>>>>>>>>>>>>>>>
38603>>>>>>>>>>>>>>>>>    // Define_Fields:
38603>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
38603>>>>>>>>>>>>>>>>>
38603>>>>>>>>>>>>>>>>>    Procedure Define_Fields
38604>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
38606>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
38606>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
38606>>>>>>>>>>>>>>>>>
38606>>>>>>>>>>>>>>>>>        Set Main_File            To Areas.File_Number
38607>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
38608>>>>>>>>>>>>>>>>>
38608>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
38609>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
38610>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38611>>>>>>>>>>>>>>>>>
38611>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
38611>>>>>>>>>>>>>>>>>        Send Add_Client_File  Clients.File_Number
38612>>>>>>>>>>>>>>>>>
38612>>>>>>>>>>>>>>>>>        // Field-based properties.......................
38612>>>>>>>>>>>>>>>>>
38612>>>>>>>>>>>>>>>>>        // Areas.Area_Id
38612>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Areas.Area_Id To (sl197(Self))
38613>>>>>>>>>>>>>>>>>
38613>>>>>>>>>>>>>>>>>        // Areas.Area_Descr
38613>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Areas.Area_Descr To (sl197(Self))
38614>>>>>>>>>>>>>>>>>
38614>>>>>>>>>>>>>>>>>        // Areas.Area_Site
38614>>>>>>>>>>>>>>>>>
38614>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
38614>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
38615>>>>>>>>>>>>>>>>>
38615>>>>>>>>>>>>>>>>>    // Field_Defaults:
38615>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
38615>>>>>>>>>>>>>>>>>
38615>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
38616>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
38618>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
38618>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
38618>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
38618>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
38619>>>>>>>>>>>>>>>>>
38619>>>>>>>>>>>>>>>>>End_Class    // Areas_DataDictionary
38620>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
38620>>>>>>>>>>>>>>>>>
38620>>>>>>>>>>>>>>>>>Use sl197.SL         // sl197
38620>>>>>>>>>>>>>>>>>
38620>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
38620>>>>>>>>>>>>>>>>>//DDB-FileEnd
38620>>>>>>>>>>>>>>>    
38620>>>>>>>>>>>>>>>    //AB-IgnoreEnd
38620>>>>>>>>>>>>>>>
38620>>>>>>>>>>>>>>>    Object sl197 is a dbModalPanelSub
38622>>>>>>>>>>>>>>>
38622>>>>>>>>>>>>>>>        //AB-StoreTopStart
38622>>>>>>>>>>>>>>>                    
38622>>>>>>>>>>>>>>>        //AB-StoreTopEnd
38622>>>>>>>>>>>>>>>
38622>>>>>>>>>>>>>>>        Set Label to "€¨®œå¦ œ¨ ¦®é¤"
38623>>>>>>>>>>>>>>>        Set Size to 148 297
38624>>>>>>>>>>>>>>>        Set Location to 4 5
38625>>>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
38626>>>>>>>>>>>>>>>        Set Modal_State to FALSE
38627>>>>>>>>>>>>>>>
38627>>>>>>>>>>>>>>>        //AB-DDOStart
38627>>>>>>>>>>>>>>>
38627>>>>>>>>>>>>>>>        Object Areas_DD is a Areas_DataDictionary
38629>>>>>>>>>>>>>>>
38629>>>>>>>>>>>>>>>            //AB-StoreStart
38629>>>>>>>>>>>>>>>                                    
38629>>>>>>>>>>>>>>>            //AB-StoreEnd
38629>>>>>>>>>>>>>>>
38629>>>>>>>>>>>>>>>        End_Object    // Areas_DD
38630>>>>>>>>>>>>>>>
38630>>>>>>>>>>>>>>>        Set Main_DD to (Areas_DD(self))
38631>>>>>>>>>>>>>>>        Set Server to (Areas_DD(self))
38632>>>>>>>>>>>>>>>
38632>>>>>>>>>>>>>>>        //AB-DDOEnd
38632>>>>>>>>>>>>>>>
38632>>>>>>>>>>>>>>>        Object oSelList is a dbListSub
38634>>>>>>>>>>>>>>>            Set Main_File to Areas.File_Number
38635>>>>>>>>>>>>>>>            Set Ordering to 2
38636>>>>>>>>>>>>>>>            Set Size to 105 280
38637>>>>>>>>>>>>>>>            Set Location to 5 5
38638>>>>>>>>>>>>>>>            Set Export_Item_State to TRUE
38639>>>>>>>>>>>>>>>
38639>>>>>>>>>>>>>>>            Begin_Row
38642>>>>>>>>>>>>>>>                Entry_Item Areas.Area_id
38643>>>>>>>>>>>>>>>                Entry_Item Areas.Area_descr
38644>>>>>>>>>>>>>>>                Entry_Item Areas.Area_site
38645>>>>>>>>>>>>>>>            End_Row
38650>>>>>>>>>>>>>>>
38650>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 45
38651>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
38652>>>>>>>>>>>>>>>            
38652>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 192
38653>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
38654>>>>>>>>>>>>>>>            
38654>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 35
38655>>>>>>>>>>>>>>>            Set Header_Label  item 2 to "’¦£â˜ª"
38656>>>>>>>>>>>>>>>            
38656>>>>>>>>>>>>>>>
38656>>>>>>>>>>>>>>>            //AB-StoreStart
38656>>>>>>>>>>>>>>>            
38656>>>>>>>>>>>>>>>            Set Column_Option Item 0 to NoEnter True
38657>>>>>>>>>>>>>>>            
38657>>>>>>>>>>>>>>>            
38657>>>>>>>>>>>>>>>            //AB-StoreEnd
38657>>>>>>>>>>>>>>>
38657>>>>>>>>>>>>>>>        End_Object    // oSelList
38658>>>>>>>>>>>>>>>
38658>>>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
38660>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
38661>>>>>>>>>>>>>>>            Set Location to 115 126
38662>>>>>>>>>>>>>>>
38662>>>>>>>>>>>>>>>            //AB-StoreStart
38662>>>>>>>>>>>>>>>            Procedure OnClick
38664>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
38665>>>>>>>>>>>>>>>            End_Procedure
38666>>>>>>>>>>>>>>>            //AB-StoreEnd
38666>>>>>>>>>>>>>>>
38666>>>>>>>>>>>>>>>        End_Object    // oOK_bn
38667>>>>>>>>>>>>>>>
38667>>>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
38669>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
38670>>>>>>>>>>>>>>>            Set Location to 115 181
38671>>>>>>>>>>>>>>>
38671>>>>>>>>>>>>>>>            //AB-StoreStart
38671>>>>>>>>>>>>>>>            Procedure OnClick
38673>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
38674>>>>>>>>>>>>>>>            End_Procedure
38675>>>>>>>>>>>>>>>            //AB-StoreEnd
38675>>>>>>>>>>>>>>>
38675>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
38676>>>>>>>>>>>>>>>
38676>>>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
38678>>>>>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
38679>>>>>>>>>>>>>>>            Set Location to 115 236
38680>>>>>>>>>>>>>>>
38680>>>>>>>>>>>>>>>            //AB-StoreStart
38680>>>>>>>>>>>>>>>            Procedure OnClick
38682>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
38683>>>>>>>>>>>>>>>            End_Procedure
38684>>>>>>>>>>>>>>>            //AB-StoreEnd
38684>>>>>>>>>>>>>>>
38684>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
38685>>>>>>>>>>>>>>>
38685>>>>>>>>>>>>>>>
38685>>>>>>>>>>>>>>>        //AB-StoreStart
38685>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
38686>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
38687>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
38688>>>>>>>>>>>>>>>        
38688>>>>>>>>>>>>>>>        
38688>>>>>>>>>>>>>>>        
38688>>>>>>>>>>>>>>>        
38688>>>>>>>>>>>>>>>        
38688>>>>>>>>>>>>>>>        //AB-StoreEnd
38688>>>>>>>>>>>>>>>
38688>>>>>>>>>>>>>>>    End_Object    // sl197
38689>>>>>>>>>>>>>>>
38689>>>>>>>>>>>>>>>//AB/     End_Object    // prj
38689>>>>>>>>>>>>>
38689>>>>>>>>>>>>>//DDB-Selection-pkg-End
38689>>>>>>>>>>>>>//DDB-FileEnd
38689>>>>>>>>>>>Use CLIENTS.DD
INCLUDING FILE: CLIENTS.DD
38689>>>>>>>>>>>>>//DDB-FileStart
38689>>>>>>>>>>>>>//DDB-HeaderStart
38689>>>>>>>>>>>>>
38689>>>>>>>>>>>>>// File Name : CLIENTS.DD
38689>>>>>>>>>>>>>// Class Name: Clients_DataDictionary
38689>>>>>>>>>>>>>// Revision  : 228
38689>>>>>>>>>>>>>// Version   : 2
38689>>>>>>>>>>>>>
38689>>>>>>>>>>>>>Use  Windows           // Basic Definitions
38689>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
38689>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38689>>>>>>>>>>>>>
38689>>>>>>>>>>>>>Open Clients
38691>>>>>>>>>>>>>Open Cmoves
INCLUDING FILE: CMOVES.FD
38693>>>>>>>>>>>>>Open Particle
INCLUDING FILE: PARTICLE.FD
38695>>>>>>>>>>>>>Open Cmovesa
INCLUDING FILE: CMOVESA.FD
38697>>>>>>>>>>>>>Open Cn
INCLUDING FILE: CN.FD
38699>>>>>>>>>>>>>Open Particll
INCLUDING FILE: PARTICLL.FD
38701>>>>>>>>>>>>>Open Clnbank
INCLUDING FILE: CLNBANK.FD
38703>>>>>>>>>>>>>Open Tpclient
INCLUDING FILE: TPCLIENT.FD
38705>>>>>>>>>>>>>Open Clorder
INCLUDING FILE: CLORDER.FD
38707>>>>>>>>>>>>>Open Clitem
INCLUDING FILE: CLITEM.FD
38709>>>>>>>>>>>>>Open Cities
38711>>>>>>>>>>>>>Open Areas
38713>>>>>>>>>>>>>Open Payresp
38715>>>>>>>>>>>>>Open Syscurxr
38717>>>>>>>>>>>>>Open Sysrecc
38719>>>>>>>>>>>>>
38719>>>>>>>>>>>>>//DDB-HeaderEnd
38719>>>>>>>>>>>>>//DDB-ValidationStart
38719>>>>>>>>>>>>>
38719>>>>>>>>>>>>>Register_Object Clients_Client_Doy_VT
38719>>>>>>>>>>>>>Register_Object Clients_Client_Job_VT
38719>>>>>>>>>>>>>Register_Object Clients_Client_Categfpa_VT
38719>>>>>>>>>>>>>Register_Object Clients_Client_Catjob_VT1
38719>>>>>>>>>>>>>Register_Object Clients_Client_Idiot_VT
38719>>>>>>>>>>>>>Register_Object Clients_Feregios_VT
38719>>>>>>>>>>>>>
38719>>>>>>>>>>>>>Object Clients_Client_Doy_VT  is a CodeValidationTable
38721>>>>>>>>>>>>>    Set Type_Value        To "DOY"
38722>>>>>>>>>>>>>    Set Validate_State    To FALSE
38723>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
38724>>>>>>>>>>>>>    Set Table_Title       To "ƒ.Ž.“"
38725>>>>>>>>>>>>>    //DDB-ValidationCustomStart
38725>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
38725>>>>>>>>>>>>>End_Object   // Clients_Client_Doy_VT
38726>>>>>>>>>>>>>
38726>>>>>>>>>>>>>Object Clients_Client_Job_VT  is a CodeValidationTable
38728>>>>>>>>>>>>>    Set Type_Value        To "JOB"
38729>>>>>>>>>>>>>    Set Validate_State    To FALSE
38730>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
38731>>>>>>>>>>>>>    Set Table_Title       To "„§˜ššâ¢£˜«˜"
38732>>>>>>>>>>>>>    //DDB-ValidationCustomStart
38732>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
38732>>>>>>>>>>>>>End_Object   // Clients_Client_Job_VT
38733>>>>>>>>>>>>>
38733>>>>>>>>>>>>>Object Clients_Client_Categfpa_VT  is a CodeValidationTable
38735>>>>>>>>>>>>>    Set Type_Value        To "VAT_STATUS"
38736>>>>>>>>>>>>>    Set Validate_State    To FALSE
38737>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
38738>>>>>>>>>>>>>    //DDB-ValidationCustomStart
38738>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
38738>>>>>>>>>>>>>End_Object   // Clients_Client_Categfpa_VT
38739>>>>>>>>>>>>>
38739>>>>>>>>>>>>>Object Clients_Client_Catjob_VT1  is a CodeValidationTable
38741>>>>>>>>>>>>>    Set Type_Value        To "JOB"
38742>>>>>>>>>>>>>    Set Validate_State    To FALSE
38743>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
38744>>>>>>>>>>>>>    //DDB-ValidationCustomStart
38744>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
38744>>>>>>>>>>>>>End_Object   // Clients_Client_Catjob_VT1
38745>>>>>>>>>>>>>
38745>>>>>>>>>>>>>Object Clients_Client_Idiot_VT  is a CodeValidationTable
38747>>>>>>>>>>>>>    Set Type_Value        To "IDIOT"
38748>>>>>>>>>>>>>    Set Validate_State    To FALSE
38749>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
38750>>>>>>>>>>>>>    Set Table_Title       To "€¨®œå¦ ˆ› ¦«ã«à¤"
38751>>>>>>>>>>>>>    //DDB-ValidationCustomStart
38751>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
38751>>>>>>>>>>>>>End_Object   // Clients_Client_Idiot_VT
38752>>>>>>>>>>>>>
38752>>>>>>>>>>>>>Object Clients_Feregios_VT  is a CodeValidationTable
38754>>>>>>>>>>>>>    Set Type_Value        To "FEREGIOS"
38755>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
38756>>>>>>>>>>>>>    Set Table_Title       To "ƒœå¡«œª ”œ¨œšš¬æ«ž«˜ª ”¦¨âà¤"
38757>>>>>>>>>>>>>    //DDB-ValidationCustomStart
38757>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
38757>>>>>>>>>>>>>End_Object   // Clients_Feregios_VT
38758>>>>>>>>>>>>>//DDB-ValidationEnd
38758>>>>>>>>>>>>>//DDB-SelectionStart
38758>>>>>>>>>>>>>//DDB/ ExternalSelectionList SL100  SL100.SL
38758>>>>>>>>>>>>>Register_Object SL100
38758>>>>>>>>>>>>>//DDB-SelectionEnd
38758>>>>>>>>>>>>>Open Sysfile
38760>>>>>>>>>>>>>open year
38762>>>>>>>>>>>>>
38762>>>>>>>>>>>>>Class Clients_DataDictionary  is a DataDictionary_Sec
38763>>>>>>>>>>>>>
38763>>>>>>>>>>>>>    Procedure Construct_Object
38764>>>>>>>>>>>>>        Forward Send Construct_Object
38766>>>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
38767>>>>>>>>>>>>>        Property Integer piCheckPlaf        Public 0
38768>>>>>>>>>>>>>    End_Procedure
38769>>>>>>>>>>>>>
38769>>>>>>>>>>>>>    // Backout:
38769>>>>>>>>>>>>>    Procedure Backout
38770>>>>>>>>>>>>>        Forward Send Backout
38772>>>>>>>>>>>>>        // Insert Code Here
38772>>>>>>>>>>>>>    End_Procedure   // Backout
38773>>>>>>>>>>>>>
38773>>>>>>>>>>>>>
38773>>>>>>>>>>>>>
38773>>>>>>>>>>>>>    Procedure Update
38774>>>>>>>>>>>>>        Forward Send Update
38776>>>>>>>>>>>>>        // Insert Code Here
38776>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to Clients.Company_Code
38777>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Clients.Branch_Code
38778>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to Clients.Year_Year
38779>>>>>>>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
38779>>>>>>>>>>>>>        Move (Clients.Xreosh-Clients.Pistosh)   to Clients.Ypoloipo
38780>>>>>>>>>>>>>        Move (Clients.Plafon-Clients.Ypoloipo)  to Clients.Overhead
38781>>>>>>>>>>>>>
38781>>>>>>>>>>>>>        //Move Clients.Client_Address     to Clients.Client_LastUpd
38781>>>>>>>>>>>>>
38781>>>>>>>>>>>>>        //betolink
38781>>>>>>>>>>>>>        Move SysCurXR.Beto_Site      to Clients.Client_SiteW
38782>>>>>>>>>>>>>        Move Clients.Client_Rec0     to Clients.Client_SN
38783>>>>>>>>>>>>>        Move Clients.Client_id       to Clients.Client_Repm
38784>>>>>>>>>>>>>        Move Clients.Company_Code    to Clients.CLIENT_COMPANY
38785>>>>>>>>>>>>>        Move Clients.Client_id       to Clients.Client_RepMatch
38786>>>>>>>>>>>>>     //   Move (gsfCode_Mast('JOB',Clients.Client_CatJob)) to Clients.Client_Job
38786>>>>>>>>>>>>>    End_Procedure   // Update
38787>>>>>>>>>>>>>
38787>>>>>>>>>>>>>
38787>>>>>>>>>>>>>    Procedure Creating
38788>>>>>>>>>>>>>        date ddate iYes
38789>>>>>>>>>>>>>        Forward Send Creating
38791>>>>>>>>>>>>>        // Insert Code Here
38791>>>>>>>>>>>>>
38791>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Clients.Client_Rec0))))));                                    to Clients.Client_Recr
38792>>>>>>>>>>>>>        Move '1'                    to Clients.Client_Active
38793>>>>>>>>>>>>>        get fsgCode_With_Zeroes Clients.Client_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to Clients.Client_ID
38794>>>>>>>>>>>>>        sysdate4 ddate
38795>>>>>>>>>>>>>        move ddate                  to Clients.Client_Hmnia
38796>>>>>>>>>>>>>        clear year
38797>>>>>>>>>>>>>        move syscurxr.company_code  to year.company_code
38798>>>>>>>>>>>>>        move syscurxr.branch_code   to year.branch_code
38799>>>>>>>>>>>>>        move syscurxr.year_year     to year.year_year
38800>>>>>>>>>>>>>        find eq year by index.1
38801>>>>>>>>>>>>>>
38801>>>>>>>>>>>>>        If (found=1) begin
38803>>>>>>>>>>>>>            move year.clients_plafon to clients.plafon
38804>>>>>>>>>>>>>            move year.clients_ofeilh to clients.orio_syn_ofeilh
38805>>>>>>>>>>>>>        end
38805>>>>>>>>>>>>>>
38805>>>>>>>>>>>>>    End_Procedure   // Creating
38806>>>>>>>>>>>>>
38806>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
38807>>>>>>>>>>>>>        Integer iReturnVal iCheck iYes
38808>>>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
38810>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
38812>>>>>>>>>>>>>
38812>>>>>>>>>>>>>            If (clients.is_eksoter <> '1') begin
38814>>>>>>>>>>>>>                If (Clients.Is_Xondr='1') Begin
38816>>>>>>>>>>>>>                    If (Sysfile.Check_Afm=1) Begin
38818>>>>>>>>>>>>>                        Move (Check_AFM(Clients.Client_Afm)) to iCheck
ERROR: 54 Invalid symbol in expression CHECK_AFM ON LINE: 166 (38818) OF FILE: V:\Vdf6\Develop\Empor\DDSrc\CLIENTS.DD
38819>>>>>>>>>>>>>                        If (iCheck) Begin
38821>>>>>>>>>>>>>                                 If (iCheck=1) Move 4001 to iReturnVal
38824>>>>>>>>>>>>>                            Else If (iCheck=2) Move 4002 to iReturnVal
38828>>>>>>>>>>>>>                            Else If (iCheck=3) Move 4003 to iReturnVal
38832>>>>>>>>>>>>>                        End
38832>>>>>>>>>>>>>>
38832>>>>>>>>>>>>>                    End
38832>>>>>>>>>>>>>>
38832>>>>>>>>>>>>>                End
38832>>>>>>>>>>>>>>
38832>>>>>>>>>>>>>            End
38832>>>>>>>>>>>>>>
38832>>>>>>>>>>>>>
38832>>>>>>>>>>>>>            If (piCheckPlaf(Self)=1) Begin
38834>>>>>>>>>>>>>                If ((Clients.Plafon>0) And ((Clients.Ypoloipo+Clients.Posa_Apo_Dap)>Clients.Plafon)) Begin
38836>>>>>>>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4000 Clients' to iYes
38837>>>>>>>>>>>>>                    If (iYes=MBR_NO) Error 4004 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž' //Move 4004 to iReturnVal
38840>>>>>>>>>>>>>                End
38840>>>>>>>>>>>>>>
38840>>>>>>>>>>>>>                Else If ((PayResp.Plafon<>0) And (PayResp.Plafon<=PayResp.Synolikh_Ofeilh)) Begin
38843>>>>>>>>>>>>>                    Get YesNo_Box 'Ž ¬§œçŸ¬¤¦ª §¢ž¨à£ãª ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž\nŒ˜ ©¬¤œ®å©à ©«ž¤ ›ž£ ¦¬¨šå˜ œšš¨˜­ãª §œ¢á«ž;' to iYes
38844>>>>>>>>>>>>>                    If (iYes=MBR_NO) Error 4005 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
38847>>>>>>>>>>>>>                End
38847>>>>>>>>>>>>>>
38847>>>>>>>>>>>>>                Else If ((Clients.Orio_Syn_Ofeilh>0) And (Clients.Synolikh_Ofeilh>Clients.Orio_Syn_Ofeilh)) Begin
38850>>>>>>>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4001 Clients' to iYes
38851>>>>>>>>>>>>>                    If (iYes=MBR_NO) Error 4005 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
38854>>>>>>>>>>>>>                End
38854>>>>>>>>>>>>>>
38854>>>>>>>>>>>>>                Else If ((Clients.Orio_Syn_Ofeilh>0) And (PayResp.Orio_Syn_Ofeilh>0) And (Clients.Synolikh_Ofeilh>Payresp.Orio_Syn_Ofeilh)) Begin
38857>>>>>>>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4002 Clients' to iYes
38858>>>>>>>>>>>>>                    If (iYes=MBR_NO) Error 4006 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'   //Move 4006 to iReturnVal
38861>>>>>>>>>>>>>                End
38861>>>>>>>>>>>>>>
38861>>>>>>>>>>>>>                If ((Clients.Plafon>0) And ((Clients.Ypoloipo+Clients.Posa_Apo_Parag)>Clients.Plafon)) Begin
38863>>>>>>>>>>>>>                    Send Info_Box '’˜ §¦©á «à¤ ž£œ¨ž©åà¤ §˜¨˜ššœ¢ é¤\n¬§œ¨™˜å¤¦¬¤ «¦ › ˜Ÿâ© £¦ ¬§æ¢¦ §¦\n™á©ž §¢˜­æ¤ «¦¬ §œ¢á«ž' '¨¦©¦®ã !!!'
38864>>>>>>>>>>>>>                End
38864>>>>>>>>>>>>>>
38864>>>>>>>>>>>>>            End
38864>>>>>>>>>>>>>>
38864>>>>>>>>>>>>>
38864>>>>>>>>>>>>>            If (iReturnVal) Begin
38866>>>>>>>>>>>>>                Send Operation_Not_Allowed iReturnVal
38867>>>>>>>>>>>>>            End
38867>>>>>>>>>>>>>>
38867>>>>>>>>>>>>>        End
38867>>>>>>>>>>>>>>
38867>>>>>>>>>>>>>        Function_Return iReturnVal
38868>>>>>>>>>>>>>    End_Function   // Validate_Save
38869>>>>>>>>>>>>>
38869>>>>>>>>>>>>>
38869>>>>>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
38870>>>>>>>>>>>>>        String lsError_Message
38871>>>>>>>>>>>>>
38871>>>>>>>>>>>>>        Case Begin
38871>>>>>>>>>>>>>            Case (iError_Num = 4001)
38873>>>>>>>>>>>>>                Move "DDC 100: Š˜¤Ÿ˜©£â¤¦ €”‹ œ¢á«ž" ;                    to lsError_Message
38874>>>>>>>>>>>>>              Case Break
38875>>>>>>>>>>>>>            Case (iError_Num = 4002)
38878>>>>>>>>>>>>>                Move "DDC 100: ’¦ €”‹ œ¢á«ž ›œ¤ œå¤˜  9 ¯ã­ ¦" ;                    to lsError_Message
38879>>>>>>>>>>>>>              Case Break
38880>>>>>>>>>>>>>            Case (iError_Num = 4003)
38883>>>>>>>>>>>>>                Move "DDC 100: €¡˜«á¢¢ž¢¦ª ®˜¨˜¡«ã¨˜ª ©«¦ €”‹ œ¢á«ž" ;                    to lsError_Message
38884>>>>>>>>>>>>>              Case Break
38885>>>>>>>>>>>>>            Case (iError_Num = 4004)
38888>>>>>>>>>>>>>                Move "DDC 100: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ §œ¢á«ž" ;                    to lsError_Message
38889>>>>>>>>>>>>>              Case Break
38890>>>>>>>>>>>>>            Case (iError_Num = 4005)
38893>>>>>>>>>>>>>                Move "DDC 100: † ©¬¤¦¢ ¡ã ¦­œ ¢ã ¬§œ¨™˜å¤œ \n«¦ æ¨ ¦ ©¬¤¦¢ ¡ãª ¦­œ ¢ãª" ;                    to lsError_Message
38894>>>>>>>>>>>>>              Case Break
38895>>>>>>>>>>>>>            Case (iError_Num = 4006)
38898>>>>>>>>>>>>>                Move "DDC 100: † ©¬¤¦¢ ¡ã ¦­œ ¢ã ¬§œ¨™˜å¤œ \n«¦ æ¨ ¦ ©¬¤¦¢ ¡ãª ¦­œ ¢ãª «¦¬ “§œ¬Ÿç¤¦¬" ;                    to lsError_Message
38899>>>>>>>>>>>>>              Case Break
38900>>>>>>>>>>>>>
38900>>>>>>>>>>>>>            Case Else
38900>>>>>>>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
38902>>>>>>>>>>>>>        Case End
38902>>>>>>>>>>>>>
38902>>>>>>>>>>>>>        Error iError_Num lsError_Message
38903>>>>>>>>>>>>>>
38903>>>>>>>>>>>>>    End_Procedure // operation_not_allowed
38904>>>>>>>>>>>>>
38904>>>>>>>>>>>>>
38904>>>>>>>>>>>>>    // Define_Fields:
38904>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
38904>>>>>>>>>>>>>
38904>>>>>>>>>>>>>    Procedure Define_Fields
38905>>>>>>>>>>>>>        Forward Send Define_Fields
38907>>>>>>>>>>>>>        //DDB-Generated-Code-Location
38907>>>>>>>>>>>>>        //DDB-DefineFieldStart
38907>>>>>>>>>>>>>
38907>>>>>>>>>>>>>        Set Main_File            To Clients.File_Number
38908>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
38909>>>>>>>>>>>>>
38909>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
38910>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
38911>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38912>>>>>>>>>>>>>
38912>>>>>>>>>>>>>        // Child (Client) file structure................
38912>>>>>>>>>>>>>        Send Add_Client_File  Cmoves.File_Number
38913>>>>>>>>>>>>>        Send Add_Client_File  Particle.File_Number
38914>>>>>>>>>>>>>        Send Add_Client_File  Cmovesa.File_Number
38915>>>>>>>>>>>>>        Send Add_Client_File  Cn.File_Number
38916>>>>>>>>>>>>>        Send Add_Client_File  Particll.File_Number
38917>>>>>>>>>>>>>        Send Add_Client_File  Clnbank.File_Number
38918>>>>>>>>>>>>>        Send Add_Client_File  Tpclient.File_Number
38919>>>>>>>>>>>>>        Send Add_Client_File  Clorder.File_Number
38920>>>>>>>>>>>>>        Send Add_Client_File  Clitem.File_Number
38921>>>>>>>>>>>>>
38921>>>>>>>>>>>>>        // Parent (Server) file structure...............
38921>>>>>>>>>>>>>        Send Add_Server_File  Cities.File_Number
38922>>>>>>>>>>>>>        Send Add_Server_File  Areas.File_Number
38923>>>>>>>>>>>>>        Send Add_Server_File  Payresp.File_Number
38924>>>>>>>>>>>>>
38924>>>>>>>>>>>>>        // External (System) file structure.............
38924>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
38925>>>>>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
38926>>>>>>>>>>>>>
38926>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecc.Client_Rec0  To Clients.Client_Rec0
38929>>>>>>>>>>>>>
38929>>>>>>>>>>>>>        // Field-based properties.......................
38929>>>>>>>>>>>>>
38929>>>>>>>>>>>>>        // Clients.Company_Code
38929>>>>>>>>>>>>>
38929>>>>>>>>>>>>>        // Clients.Branch_Code
38929>>>>>>>>>>>>>
38929>>>>>>>>>>>>>        // Clients.Year_Year
38929>>>>>>>>>>>>>
38929>>>>>>>>>>>>>        // Clients.Custprom_Code
38929>>>>>>>>>>>>>
38929>>>>>>>>>>>>>        // Clients.Client_Id
38929>>>>>>>>>>>>>        Set Field_Options          Field Clients.Client_Id To DD_AUTOFIND    DD_NOPUT
38930>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Clients.Client_Id To (SL100(Self))
38931>>>>>>>>>>>>>        Set Key_Field_State        Field Clients.Client_Id To TRUE
38932>>>>>>>>>>>>>
38932>>>>>>>>>>>>>        // Clients.Client_Name
38932>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Clients.Client_Name To (SL100(Self))
38933>>>>>>>>>>>>>
38933>>>>>>>>>>>>>        // Clients.Client_Afm
38933>>>>>>>>>>>>>        Set Field_Options          Field Clients.Client_Afm To DD_AUTOFIND
38934>>>>>>>>>>>>>
38934>>>>>>>>>>>>>        // Clients.Client_Rec0
38934>>>>>>>>>>>>>        Set Field_Options          Field Clients.Client_Rec0 To DD_AUTOFIND
38935>>>>>>>>>>>>>
38935>>>>>>>>>>>>>        // Clients.Custprom_Recr
38935>>>>>>>>>>>>>
38935>>>>>>>>>>>>>        // Clients.Client_Recr
38935>>>>>>>>>>>>>        Set Field_Options          Field Clients.Client_Recr To DD_AUTOFIND
38936>>>>>>>>>>>>>
38936>>>>>>>>>>>>>        // Clients.Last_Xreosh
38936>>>>>>>>>>>>>
38936>>>>>>>>>>>>>        // Clients.Last_Pistosh
38936>>>>>>>>>>>>>
38936>>>>>>>>>>>>>        // Clients.Last_Order
38936>>>>>>>>>>>>>        Set Field_Class_Name       Field Clients.Last_Order To "dbComboFormSub"
38937>>>>>>>>>>>>>
38937>>>>>>>>>>>>>        // Clients.Client_Doy
38937>>>>>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Doy To (Clients_Client_Doy_VT(Self))
38938>>>>>>>>>>>>>
38938>>>>>>>>>>>>>        // Clients.Client_Address
38938>>>>>>>>>>>>>
38938>>>>>>>>>>>>>        // Clients.Client_City_Id
38938>>>>>>>>>>>>>
38938>>>>>>>>>>>>>        // Clients.Client_Area
38938>>>>>>>>>>>>>
38938>>>>>>>>>>>>>        // Clients.Client_Job
38938>>>>>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Job To (Clients_Client_Job_VT(Self))
38939>>>>>>>>>>>>>
38939>>>>>>>>>>>>>        // Clients.Client_Respons
38939>>>>>>>>>>>>>
38939>>>>>>>>>>>>>        // Clients.Client_Zipcode
38939>>>>>>>>>>>>>
38939>>>>>>>>>>>>>        // Clients.Client_Phone
38939>>>>>>>>>>>>>
38939>>>>>>>>>>>>>        // Clients.Client_Fax
38939>>>>>>>>>>>>>
38939>>>>>>>>>>>>>        // Clients.Client_Mobile
38939>>>>>>>>>>>>>
38939>>>>>>>>>>>>>        // Clients.Client_Aoh
38939>>>>>>>>>>>>>
38939>>>>>>>>>>>>>        // Clients.Client_Email
38939>>>>>>>>>>>>>
38939>>>>>>>>>>>>>        // Clients.Client_Class
38939>>>>>>>>>>>>>
38939>>>>>>>>>>>>>        // Clients.Client_Details
38939>>>>>>>>>>>>>
38939>>>>>>>>>>>>>        // Clients.Client_Sitew
38939>>>>>>>>>>>>>
38939>>>>>>>>>>>>>        // Clients.Client_Codem
38939>>>>>>>>>>>>>
38939>>>>>>>>>>>>>        // Clients.Client_Categfpa
38939>>>>>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Categfpa To (Clients_Client_Categfpa_VT(Self))
38940>>>>>>>>>>>>>
38940>>>>>>>>>>>>>        // Clients.Client_Fpa
38940>>>>>>>>>>>>>
38940>>>>>>>>>>>>>        // Clients.Client_Public
38940>>>>>>>>>>>>>
38940>>>>>>>>>>>>>        // Clients.Client_Sn
38940>>>>>>>>>>>>>
38940>>>>>>>>>>>>>        // Clients.Client_Repm
38940>>>>>>>>>>>>>
38940>>>>>>>>>>>>>        // Clients.Client_Active
38940>>>>>>>>>>>>>
38940>>>>>>>>>>>>>        // Clients.Client_Reported
38940>>>>>>>>>>>>>
38940>>>>>>>>>>>>>        // Clients.Client_Pelprom
38940>>>>>>>>>>>>>
38940>>>>>>>>>>>>>        // Clients.Client_Lastupd
38940>>>>>>>>>>>>>
38940>>>>>>>>>>>>>        // Clients.Client_Markexp
38940>>>>>>>>>>>>>
38940>>>>>>>>>>>>>        // Clients.Client_Catjob
38940>>>>>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Catjob To (Clients_Client_Catjob_VT1(Self))
38941>>>>>>>>>>>>>
38941>>>>>>>>>>>>>        // Clients.Is_Promhtheyths
38941>>>>>>>>>>>>>
38941>>>>>>>>>>>>>        // Clients.Xreosh
38941>>>>>>>>>>>>>
38941>>>>>>>>>>>>>        // Clients.Pistosh
38941>>>>>>>>>>>>>
38941>>>>>>>>>>>>>        // Clients.Ypoloipo
38941>>>>>>>>>>>>>
38941>>>>>>>>>>>>>        // Clients.Plafon
38941>>>>>>>>>>>>>
38941>>>>>>>>>>>>>        // Clients.Overhead
38941>>>>>>>>>>>>>
38941>>>>>>>>>>>>>        // Clients.Client_Company
38941>>>>>>>>>>>>>
38941>>>>>>>>>>>>>        // Clients.Client_Repmatch
38941>>>>>>>>>>>>>
38941>>>>>>>>>>>>>        // Clients.Client_Hmnia
38941>>>>>>>>>>>>>
38941>>>>>>>>>>>>>        // Clients.Client_Presp
38941>>>>>>>>>>>>>
38941>>>>>>>>>>>>>        // Clients.Client_Locked
38941>>>>>>>>>>>>>
38941>>>>>>>>>>>>>        // Clients.Synolikh_Ofeilh
38941>>>>>>>>>>>>>
38941>>>>>>>>>>>>>        // Clients.Client_Idiot
38941>>>>>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Idiot To (Clients_Client_Idiot_VT(Self))
38942>>>>>>>>>>>>>
38942>>>>>>>>>>>>>        // Clients.Client_Add_No
38942>>>>>>>>>>>>>
38942>>>>>>>>>>>>>        // Clients.Client_Nomos
38942>>>>>>>>>>>>>
38942>>>>>>>>>>>>>        // Clients.Client_Xora
38942>>>>>>>>>>>>>
38942>>>>>>>>>>>>>        // Clients.Polh_Recr
38942>>>>>>>>>>>>>
38942>>>>>>>>>>>>>        // Clients.Presp_Id
38942>>>>>>>>>>>>>
38942>>>>>>>>>>>>>        // Clients.Sum_Pct_Tpcl
38942>>>>>>>>>>>>>
38942>>>>>>>>>>>>>        // Clients.Is_Client
38942>>>>>>>>>>>>>
38942>>>>>>>>>>>>>        // Clients.Sysxetish
38942>>>>>>>>>>>>>
38942>>>>>>>>>>>>>        // Clients.Poso_Se_Apait
38942>>>>>>>>>>>>>
38942>>>>>>>>>>>>>        // Clients.Client_Glcode
38942>>>>>>>>>>>>>
38942>>>>>>>>>>>>>        // Clients.Is_Eksoter
38942>>>>>>>>>>>>>
38942>>>>>>>>>>>>>        // Clients.Is_Xondr
38942>>>>>>>>>>>>>
38942>>>>>>>>>>>>>        // Clients.Orio_Syn_Ofeilh
38942>>>>>>>>>>>>>
38942>>>>>>>>>>>>>        // Clients.Posa_Apo_Dap
38942>>>>>>>>>>>>>
38942>>>>>>>>>>>>>        // Clients.Client_Doybtm
38942>>>>>>>>>>>>>
38942>>>>>>>>>>>>>        // Clients.Posa_Apo_Parag
38942>>>>>>>>>>>>>
38942>>>>>>>>>>>>>        // Clients.Client_Ptyppar
38942>>>>>>>>>>>>>
38942>>>>>>>>>>>>>        // Clients.Client_Seira
38942>>>>>>>>>>>>>
38942>>>>>>>>>>>>>        // Clients.Hpso
38942>>>>>>>>>>>>>
38942>>>>>>>>>>>>>        // Clients.Hpal
38942>>>>>>>>>>>>>
38942>>>>>>>>>>>>>        // Clients.Feregios
38942>>>>>>>>>>>>>        Set Field_Value_Table      Field Clients.Feregios To (Clients_Feregios_VT(Self))
38943>>>>>>>>>>>>>
38943>>>>>>>>>>>>>        // Clients.Diakin
38943>>>>>>>>>>>>>
38943>>>>>>>>>>>>>        //DDB-DefineFieldEnd
38943>>>>>>>>>>>>>    End_Procedure    // Define_Fields
38944>>>>>>>>>>>>>
38944>>>>>>>>>>>>>    // Field_Defaults:
38944>>>>>>>>>>>>>    // This procedure is used to establish default field values.
38944>>>>>>>>>>>>>
38944>>>>>>>>>>>>>    Procedure Field_Defaults
38945>>>>>>>>>>>>>        Forward Send Field_Defaults
38947>>>>>>>>>>>>>        //DDB-Generated-Code-Location
38947>>>>>>>>>>>>>        //DDB-FieldDefaultStart
38947>>>>>>>>>>>>>        Set Field_Changed_Value   Field Clients.Client_Doy To "0"
38948>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
38948>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
38949>>>>>>>>>>>>>
38949>>>>>>>>>>>>>End_Class    // Clients_DataDictionary
38950>>>>>>>>>>>>>//DDB-Selection-pkg-Start
38950>>>>>>>>>>>>>
38950>>>>>>>>>>>>>Use SL100.SL         // SL100
38950>>>>>>>>>>>>>
38950>>>>>>>>>>>>>//DDB-Selection-pkg-End
38950>>>>>>>>>>>>>//DDB-FileEnd
38950>>>>>>>>>>>
38950>>>>>>>>>>>//AB-IgnoreEnd
38950>>>>>>>>>>>
38950>>>>>>>>>>>Object SL100 is a dbModalPanelSub
38952>>>>>>>>>>>
38952>>>>>>>>>>>    //AB-StoreTopStart
38952>>>>>>>>>>>        
38952>>>>>>>>>>>    Property String     psIsPromhtheyths    Public ''
38954>>>>>>>>>>>    Property Integer    piMustConstrain     Public  0
38956>>>>>>>>>>>    Property String     psModule            Public ''
38958>>>>>>>>>>>    
38958>>>>>>>>>>>    //AB-StoreTopEnd
38958>>>>>>>>>>>
38958>>>>>>>>>>>    Set Label to "‘¬¤˜¢¢˜©æ£œ¤¦  / ”¦¨œåª"
38959>>>>>>>>>>>    Set Size to 204 513
38960>>>>>>>>>>>    Set Location to 4 5
38961>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
38962>>>>>>>>>>>    Set Modal_State to FALSE
38963>>>>>>>>>>>
38963>>>>>>>>>>>    //AB-DDOStart
38963>>>>>>>>>>>
38963>>>>>>>>>>>    Object Cities_DD is a Cities_DataDictionary
38965>>>>>>>>>>>    End_Object    // Cities_DD
38966>>>>>>>>>>>
38966>>>>>>>>>>>    Object Payresp_DD is a Payresp_DataDictionary
38968>>>>>>>>>>>    End_Object    // Payresp_DD
38969>>>>>>>>>>>
38969>>>>>>>>>>>    Object Clients_DD is a Clients_DataDictionary
38971>>>>>>>>>>>        Set DDO_Server to (Cities_DD(self))
38972>>>>>>>>>>>        Set DDO_Server to (Payresp_DD(self))
38973>>>>>>>>>>>
38973>>>>>>>>>>>        //AB-StoreStart
38973>>>>>>>>>>>                                                
38973>>>>>>>>>>>        Begin_Constraints
38975>>>>>>>>>>>                 If (psModule(sl100(Self))='01') BEGIN
38977>>>>>>>>>>>                    Constrain Clients.is_Client        Eq '1'
38979>>>>>>>>>>>                 end
38979>>>>>>>>>>>>
38979>>>>>>>>>>>            Else If (psModule(sl100(Self))='02') begin
38982>>>>>>>>>>>                 set ordering to 4
38983>>>>>>>>>>>                 Constrain Clients.is_Promhtheyths  Eq '1'
38985>>>>>>>>>>>            end
38985>>>>>>>>>>>>
38985>>>>>>>>>>>        End_Constraints
38988>>>>>>>>>>>        
38988>>>>>>>>>>>        
38988>>>>>>>>>>>        
38988>>>>>>>>>>>        
38988>>>>>>>>>>>        
38988>>>>>>>>>>>        
38988>>>>>>>>>>>        
38988>>>>>>>>>>>        
38988>>>>>>>>>>>        
38988>>>>>>>>>>>        
38988>>>>>>>>>>>        //AB-StoreEnd
38988>>>>>>>>>>>
38988>>>>>>>>>>>    End_Object    // Clients_DD
38989>>>>>>>>>>>
38989>>>>>>>>>>>    Set Main_DD to (Clients_DD(self))
38990>>>>>>>>>>>    Set Server to (Clients_DD(self))
38991>>>>>>>>>>>
38991>>>>>>>>>>>    //AB-DDOEnd
38991>>>>>>>>>>>
38991>>>>>>>>>>>    Object oSelList is a dbListSub
38993>>>>>>>>>>>        Set Main_File to Clients.File_Number
38994>>>>>>>>>>>        Set Size to 161 498
38995>>>>>>>>>>>        Set Location to 6 6
38996>>>>>>>>>>>        Set Auto_Index_State to FALSE
38997>>>>>>>>>>>
38997>>>>>>>>>>>        Begin_Row
39000>>>>>>>>>>>            Entry_Item Clients.Client_id
39001>>>>>>>>>>>            Entry_Item Clients.Client_name
39002>>>>>>>>>>>            Entry_Item Clients.Client_afm
39003>>>>>>>>>>>            Entry_Item Clients.Last_xreosh
39004>>>>>>>>>>>            Entry_Item Clients.Last_pistosh
39005>>>>>>>>>>>            Entry_Item Clients.Last_order
39006>>>>>>>>>>>            Entry_Item Clients.Is_client
39007>>>>>>>>>>>            Entry_Item Clients.Is_promhtheyths
39008>>>>>>>>>>>        End_Row
39013>>>>>>>>>>>
39013>>>>>>>>>>>        Set Form_Width    item 0 to 52
39014>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
39015>>>>>>>>>>>        
39015>>>>>>>>>>>        Set Form_Width    item 1 to 172
39016>>>>>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
39017>>>>>>>>>>>        
39017>>>>>>>>>>>        Set Form_Width    item 2 to 50
39018>>>>>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
39019>>>>>>>>>>>        
39019>>>>>>>>>>>        Set Form_Width    item 3 to 57
39020>>>>>>>>>>>        Set Header_Label  item 3 to "’œ¢. •¨âà©ž"
39021>>>>>>>>>>>        
39021>>>>>>>>>>>        Set Form_Width    item 4 to 55
39022>>>>>>>>>>>        Set Header_Label  item 4 to "’œ¢. å©«à©ž"
39023>>>>>>>>>>>        
39023>>>>>>>>>>>        Set Form_Width    item 5 to 55
39024>>>>>>>>>>>        Set Header_Label  item 5 to "’œ¢. ˜¨˜šš"
39025>>>>>>>>>>>        
39025>>>>>>>>>>>        Set Form_Width    item 6 to 25
39026>>>>>>>>>>>        Set Header_Label  item 6 to "œ¢"
39027>>>>>>>>>>>        Set Column_Checkbox_State  item 6 to True
39028>>>>>>>>>>>        
39028>>>>>>>>>>>        Set Form_Width    item 7 to 25
39029>>>>>>>>>>>        Set Header_Label  item 7 to "¨¦"
39030>>>>>>>>>>>        Set Column_Checkbox_State  item 7 to True
39031>>>>>>>>>>>        
39031>>>>>>>>>>>
39031>>>>>>>>>>>        //AB-StoreStart
39031>>>>>>>>>>>                        
39031>>>>>>>>>>>        Set Column_Option Item 7 to NoEnter True
39032>>>>>>>>>>>        
39032>>>>>>>>>>>        Procedure Activating Returns Integer
39034>>>>>>>>>>>            Integer rVal
39035>>>>>>>>>>>            Forward Get Msg_Activating to rVal
39037>>>>>>>>>>>            set auto_index_state to true
39038>>>>>>>>>>>            Procedure_Return rVal
39039>>>>>>>>>>>        End_Procedure
39040>>>>>>>>>>>        
39040>>>>>>>>>>>        
39040>>>>>>>>>>>        
39040>>>>>>>>>>>        
39040>>>>>>>>>>>        
39040>>>>>>>>>>>        
39040>>>>>>>>>>>        
39040>>>>>>>>>>>        
39040>>>>>>>>>>>        
39040>>>>>>>>>>>        
39040>>>>>>>>>>>        
39040>>>>>>>>>>>        //AB-StoreEnd
39040>>>>>>>>>>>
39040>>>>>>>>>>>    End_Object    // oSelList
39041>>>>>>>>>>>
39041>>>>>>>>>>>    Object oOK_bn is a ButtonSub
39043>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
39044>>>>>>>>>>>        Set Location to 173 341
39045>>>>>>>>>>>
39045>>>>>>>>>>>        //AB-StoreStart
39045>>>>>>>>>>>        Procedure OnClick
39047>>>>>>>>>>>            Send OK To (oSelList(current_object))
39048>>>>>>>>>>>        End_Procedure
39049>>>>>>>>>>>        //AB-StoreEnd
39049>>>>>>>>>>>
39049>>>>>>>>>>>    End_Object    // oOK_bn
39050>>>>>>>>>>>
39050>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
39052>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
39053>>>>>>>>>>>        Set Location to 173 395
39054>>>>>>>>>>>
39054>>>>>>>>>>>        //AB-StoreStart
39054>>>>>>>>>>>        Procedure OnClick
39056>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
39057>>>>>>>>>>>        End_Procedure
39058>>>>>>>>>>>        //AB-StoreEnd
39058>>>>>>>>>>>
39058>>>>>>>>>>>    End_Object    // oCancel_bn
39059>>>>>>>>>>>
39059>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
39061>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
39062>>>>>>>>>>>        Set Location to 173 451
39063>>>>>>>>>>>
39063>>>>>>>>>>>        //AB-StoreStart
39063>>>>>>>>>>>        Procedure OnClick
39065>>>>>>>>>>>            Send Search To (oSelList(current_object))
39066>>>>>>>>>>>        End_Procedure
39067>>>>>>>>>>>        //AB-StoreEnd
39067>>>>>>>>>>>
39067>>>>>>>>>>>    End_Object    // oSearch_bn
39068>>>>>>>>>>>
39068>>>>>>>>>>>
39068>>>>>>>>>>>    //AB-StoreStart
39068>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39069>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39070>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39071>>>>>>>>>>>    
39071>>>>>>>>>>>    Set Modal_State to True
39072>>>>>>>>>>>    
39072>>>>>>>>>>>    Procedure Activating Returns Integer
39074>>>>>>>>>>>        Integer rVal
39075>>>>>>>>>>>        Forward Get Msg_Activating to rVal
39077>>>>>>>>>>>    
39077>>>>>>>>>>>             if (psmodule(self)='01') set label of sl100 to '‰˜«á¢¦š¦ª œ¢˜«é¤'
39080>>>>>>>>>>>        else if (psmodule(self)='02') set label of sl100 to '‰˜«á¢¦š¦ª ¨¦£žŸœ¬«é¤'
39084>>>>>>>>>>>        Send Rebuild_Constraints to Clients_DD
39085>>>>>>>>>>>        Send Beginning_Of_Data to oSelList True
39086>>>>>>>>>>>        Procedure_Return rVal
39087>>>>>>>>>>>    End_procedure
39088>>>>>>>>>>>    
39088>>>>>>>>>>>    procedure page integer pagemode
39090>>>>>>>>>>>        forward send page pagemode
39092>>>>>>>>>>>        set location to 40,40
39093>>>>>>>>>>>    end_procedure
39094>>>>>>>>>>>    
39094>>>>>>>>>>>    
39094>>>>>>>>>>>    
39094>>>>>>>>>>>    
39094>>>>>>>>>>>    
39094>>>>>>>>>>>    
39094>>>>>>>>>>>    
39094>>>>>>>>>>>    
39094>>>>>>>>>>>    
39094>>>>>>>>>>>    
39094>>>>>>>>>>>    
39094>>>>>>>>>>>    
39094>>>>>>>>>>>    
39094>>>>>>>>>>>    
39094>>>>>>>>>>>    
39094>>>>>>>>>>>    
39094>>>>>>>>>>>    //AB-StoreEnd
39094>>>>>>>>>>>
39094>>>>>>>>>>>End_Object    // SL100
39095>>>>>>>>>>>
39095>>>>>>>>>>>//AB/ End_Object    // prj
39095>>>>>>>>>
39095>>>>>>>>>//DDB-Selection-pkg-End
39095>>>>>>>>>//DDB-FileEnd
39095>>>>>>>    
39095>>>>>>>    //AB-IgnoreEnd
39095>>>>>>>
39095>>>>>>>    Object dg186 is a dbModalPanelSub
39097>>>>>>>
39097>>>>>>>        //AB-StoreTopStart
39097>>>>>>>        Function fsclient string code Returns string
39099>>>>>>>            string name
39100>>>>>>>            clear clients
39101>>>>>>>            move code to clients.client_id
39102>>>>>>>            find eq clients by index.6
39103>>>>>>>>
39103>>>>>>>            move clients.client_name to name
39104>>>>>>>            function_return name
39105>>>>>>>        end_Function
39106>>>>>>>        
39106>>>>>>>        Property String     pscode                  ''
39108>>>>>>>        Property String     psperi                  ''
39110>>>>>>>        Property Integer    piContains_Or_Starts     0
39112>>>>>>>        Property String     pscodeprom              ''
39114>>>>>>>        
39114>>>>>>>        
39114>>>>>>>        //AB-StoreTopEnd
39114>>>>>>>
39114>>>>>>>        Set Label to "‘¬©®œ«å©œ ª „ ›é¤ €§¦Ÿã¡žª"
39115>>>>>>>        Set Size to 289 527
39116>>>>>>>        Set Location to 0 2
39117>>>>>>>
39117>>>>>>>        //AB-DDOStart
39117>>>>>>>
39117>>>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
39119>>>>>>>        End_Object    // Witemkat_DD
39120>>>>>>>
39120>>>>>>>        Object Units_DD is a Units_DataDictionary
39122>>>>>>>        End_Object    // Units_DD
39123>>>>>>>
39123>>>>>>>        Object Fpa_DD is a Fpa_DataDictionary
39125>>>>>>>        End_Object    // Fpa_DD
39126>>>>>>>
39126>>>>>>>        Object Item_DD is a Item_DataDictionary
39128>>>>>>>            Set DDO_Server to (Units_DD(self))
39129>>>>>>>            Set DDO_Server to (Witemkat_DD(self))
39130>>>>>>>            Set DDO_Server to (Fpa_DD(self))
39131>>>>>>>        End_Object    // Item_DD
39132>>>>>>>
39132>>>>>>>        Object Witemcl_DD is a Witemcl_DataDictionary
39134>>>>>>>
39134>>>>>>>            //AB-StoreTopStart
39134>>>>>>>            Function fiPeriexei Returns Integer
39136>>>>>>>                       String lsperi lscode  lscodeprom
39137>>>>>>>                       Integer rVal liContains_Or_Starts
39137>>>>>>>                       Move 0 to rVal
39138>>>>>>>                       Get piContains_Or_Starts to liContains_Or_Starts
39139>>>>>>>                       Get psperi to lsperi
39140>>>>>>>                       Get pscode to lscode
39141>>>>>>>                       Get pscodeprom to lscodeprom
39142>>>>>>>                       Move (Trim(lsperi)) to lsperi
39143>>>>>>>                       Move (Trim(lscode)) to lscode
39144>>>>>>>                  //     Move (Trim(lscodekat)) to lscodekat
39144>>>>>>>                       If (liContains_Or_Starts=0) Begin
39146>>>>>>>                           If ((Trim(witemcl.item_descr)) Contains lsperi) Begin
39148>>>>>>>                               If ((Trim(witemcl.item_code)) Contains lscode) Move 1 to rVal
39151>>>>>>>                           End
39151>>>>>>>>
39151>>>>>>>            
39151>>>>>>>                       End
39151>>>>>>>>
39151>>>>>>>                       Else Begin
39152>>>>>>>                           If (Left(witemcl.item_descr,(Length(lsperi)))=lsperi) Begin
39154>>>>>>>                               If (Left(witemcl.item_code,(Length(lscode)))=lscode) Move 1 to rVal
39157>>>>>>>                           End
39157>>>>>>>>
39157>>>>>>>            
39157>>>>>>>                       End
39157>>>>>>>>
39157>>>>>>>                       Function_Return rVal
39158>>>>>>>                   End_Function
39159>>>>>>>            
39159>>>>>>>                   Function fiArxizeiperi Returns Integer
39161>>>>>>>                       String lsperi
39162>>>>>>>                       Get psperi to lsperi
39163>>>>>>>                       Move (Trim(lsperi)) to lsperi
39164>>>>>>>                       Function_Return (Left(witemcl.item_descr,(Length(lsperi)))=lsperi)
39165>>>>>>>                   End_Function
39166>>>>>>>            
39166>>>>>>>                   Function fiArxizeicode Returns Integer
39168>>>>>>>                       String lscode lscodeprom
39169>>>>>>>                       Get pscode to lscode
39170>>>>>>>                       Move (Trim(lscode)) to lscode
39171>>>>>>>                       Function_Return (Left(witemcl.item_code,(Length(lscode)))=lscode)
39172>>>>>>>                   End_Function
39173>>>>>>>            
39173>>>>>>>            //AB-StoreTopEnd
39173>>>>>>>
39173>>>>>>>            Set DDO_Server to (Item_DD(self))
39174>>>>>>>
39174>>>>>>>            //AB-StoreStart
39174>>>>>>>                                                                
39174>>>>>>>                                                                
39174>>>>>>>            Begin_Constraints
39176>>>>>>>               String lsperi lscode lsvalue lstype lscodeprom
39177>>>>>>>               Integer liContains_Or_Starts
39177>>>>>>>                   Get psperi  to lsperi
39178>>>>>>>                   Get pscode  to lscode
39179>>>>>>>                   Get pscodeprom  to lscodeprom
39180>>>>>>>                   Get piContains_Or_Starts to liContains_Or_Starts
39181>>>>>>>                   Move (Trim(lsperi)) to lsperi
39182>>>>>>>                   Move (Trim(lscode)) to lscode
39183>>>>>>>                   Move (Trim(lscodeprom)) to lscodeprom
39184>>>>>>>                   If ((lsperi<>'') and ;                      (lscode<>'')) Constrain witemcl as (fiPeriexei(Self)=1)
39187>>>>>>>                   Else Begin
39188>>>>>>>                      If (liContains_Or_Starts=0) Begin
39190>>>>>>>                      If (lsperi<>'') Constrain witemcl.item_descr Contains lsperi
39194>>>>>>>                      Else If (lscode<>'') Constrain witemcl.item_code Contains lscode
39199>>>>>>>                      End
39199>>>>>>>>
39199>>>>>>>                   Else Begin
39200>>>>>>>                       If (lsperi<>'') Constrain witemcl as (fiArxizeiperi(Self)=1) //witemcl.item_descr
39203>>>>>>>                       Else If (lscode<>'') Constrain witemcl as (fiArxizeicode(Self)=1) //witemcl.item_code
39207>>>>>>>                       End
39207>>>>>>>>
39207>>>>>>>                   End
39207>>>>>>>>
39207>>>>>>>                   If (lscodeprom<>'') Constrain witemcl.client_itemcode Contains lscodeprom
39211>>>>>>>            
39211>>>>>>>            End_Constraints
39214>>>>>>>            
39214>>>>>>>            
39214>>>>>>>            //AB-StoreEnd
39214>>>>>>>
39214>>>>>>>        End_Object    // Witemcl_DD
39215>>>>>>>
39215>>>>>>>        Set Main_DD to (Witemcl_DD(self))
39216>>>>>>>        Set Server to (Witemcl_DD(self))
39217>>>>>>>
39217>>>>>>>        //AB-DDOEnd
39217>>>>>>>
39217>>>>>>>        Object The_Table is a dbGrid
39219>>>>>>>            Set Main_File to Witemcl.File_Number
39220>>>>>>>            Set Size to 201 519
39221>>>>>>>            Set Location to 3 2
39222>>>>>>>            Set Color to 14280447
39223>>>>>>>            Set CurrentRowColor to 11783679
39224>>>>>>>            Set CurrentCellColor to 11783679
39225>>>>>>>            Set Wrap_State to TRUE
39226>>>>>>>
39226>>>>>>>            Begin_Row
39229>>>>>>>                Entry_Item Witemcl.Item_code
39230>>>>>>>                Entry_Item Witemcl.Client_itemcode
39231>>>>>>>                Entry_Item Witemcl.Item_descr
39232>>>>>>>                Entry_Item Witemcl.Client_code
39233>>>>>>>                Entry_Item (fsclient(self,witemcl.client_code))
39234>>>>>>>            End_Row
39239>>>>>>>
39239>>>>>>>            Set Form_Width    item 0 to 100
39240>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª „å›¦¬ª"
39241>>>>>>>            
39241>>>>>>>            Set Form_Width    item 1 to 100
39242>>>>>>>            Set Header_Label  item 1 to "„å›¦ª ¨¦£žŸœ¬«ã"
39243>>>>>>>            
39243>>>>>>>            Set Form_Width    item 2 to 200
39244>>>>>>>            Set Header_Label  item 2 to "œ¨ š¨˜­ã „å›¦¬ª"
39245>>>>>>>            
39245>>>>>>>            Set Form_Width    item 3 to 0
39246>>>>>>>            Set Header_Label  item 3 to ""
39247>>>>>>>            
39247>>>>>>>            Set Form_Width    item 4 to 111
39248>>>>>>>            Set Header_Label  item 4 to "¨¦£žŸœ¬«ãª"
39249>>>>>>>            
39249>>>>>>>
39249>>>>>>>            //AB-StoreStart
39249>>>>>>>            Set Column_Option Item 3 to NoEnter True
39250>>>>>>>            //set read_only_state to true
39250>>>>>>>            set no_create_state to true
39251>>>>>>>            set no_delete_state to true
39252>>>>>>>            //AB-StoreEnd
39252>>>>>>>
39252>>>>>>>        End_Object    // The_Table
39253>>>>>>>
39253>>>>>>>        Object TextBoxSub1 is a TextBoxSub
39255>>>>>>>            Set Label to "‘á¨à©ž ‰à› ¡¦ç ‚ á"
39256>>>>>>>            Set Auto_Size_State to FALSE
39257>>>>>>>            Set Location to 208 5
39258>>>>>>>            Set Size to 13 78
39259>>>>>>>        End_Object    // TextBoxSub1
39260>>>>>>>
39260>>>>>>>        Object TextBoxSub2 is a TextBoxSub
39262>>>>>>>            Set Label to "‘á¨à©ž œ¨ š¨˜­ãª "
39263>>>>>>>            Set Auto_Size_State to FALSE
39264>>>>>>>            Set Location to 223 5
39265>>>>>>>            Set Size to 13 83
39266>>>>>>>        End_Object    // TextBoxSub2
39267>>>>>>>
39267>>>>>>>        Object TextBoxSub3 is a TextBoxSub
39269>>>>>>>            Set Label to "„å›¦ª ¨¦£žŸœ¬«ã ‚ á"
39270>>>>>>>            Set Auto_Size_State to FALSE
39271>>>>>>>            Set Location to 237 5
39272>>>>>>>            Set Size to 13 78
39273>>>>>>>        End_Object    // TextBoxSub3
39274>>>>>>>
39274>>>>>>>        Object ocode is a FormSub
39276>>>>>>>            Set Size to 13 197
39277>>>>>>>            Set Location to 209 91
39278>>>>>>>            Set Label_Col_Offset to 2
39279>>>>>>>
39279>>>>>>>            //AB-StoreStart
39279>>>>>>>                                                                                                                                                                                                    
39279>>>>>>>            Procedure OnKILLFOCUS
39281>>>>>>>               Send KeyAction to ButtonSub1
39282>>>>>>>            End_Procedure
39283>>>>>>>            
39283>>>>>>>            
39283>>>>>>>            
39283>>>>>>>            
39283>>>>>>>            //AB-StoreEnd
39283>>>>>>>
39283>>>>>>>        End_Object    // ocode
39284>>>>>>>
39284>>>>>>>        Object operi is a FormSub
39286>>>>>>>            Set Size to 13 197
39287>>>>>>>            Set Location to 223 91
39288>>>>>>>            Set Label_Col_Offset to 2
39289>>>>>>>
39289>>>>>>>            //AB-StoreStart
39289>>>>>>>                                                                                                                                                                                                    
39289>>>>>>>            Procedure OnKILLFOCUS
39291>>>>>>>              Send KeyAction to ButtonSub1
39292>>>>>>>            End_Procedure
39293>>>>>>>            
39293>>>>>>>            
39293>>>>>>>            
39293>>>>>>>            
39293>>>>>>>            //AB-StoreEnd
39293>>>>>>>
39293>>>>>>>        End_Object    // operi
39294>>>>>>>
39294>>>>>>>        Object ocodeprom is a FormSub
39296>>>>>>>            Set Size to 13 197
39297>>>>>>>            Set Location to 238 91
39298>>>>>>>            Set Label_Col_Offset to 2
39299>>>>>>>
39299>>>>>>>            //AB-StoreStart
39299>>>>>>>                                                                                                                                                                                                    
39299>>>>>>>            Procedure OnKILLFOCUS
39301>>>>>>>                Send KeyAction to ButtonSub1
39302>>>>>>>            End_Procedure
39303>>>>>>>            
39303>>>>>>>            
39303>>>>>>>            
39303>>>>>>>            //AB-StoreEnd
39303>>>>>>>
39303>>>>>>>        End_Object    // ocodeprom
39304>>>>>>>
39304>>>>>>>        Object RadioGroupSub1 is a RadioGroupSub
39306>>>>>>>            Set Size to 32 77
39307>>>>>>>            Set Location to 209 296
39308>>>>>>>            Object Radio1 is a RadioSub
39310>>>>>>>                Set Label to "œ¨ â®œ«˜ "
39311>>>>>>>                Set Size to 10 53
39312>>>>>>>                Set Location to 7 5
39313>>>>>>>            End_Object    // Radio1
39314>>>>>>>
39314>>>>>>>            Object Radio2 is a RadioSub
39316>>>>>>>                Set Label to "€¨®åœ  €§æ"
39317>>>>>>>                Set Size to 10 51
39318>>>>>>>                Set Location to 21 5
39319>>>>>>>            End_Object    // Radio2
39320>>>>>>>
39320>>>>>>>
39320>>>>>>>            //AB-StoreStart
39320>>>>>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
39320>>>>>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
39322>>>>>>>                //iToItem=0 => Contains, =1 => Starts with
39322>>>>>>>                Set piContains_Or_Starts to iToItem
39323>>>>>>>                Send KeyAction to ButtonSub1
39324>>>>>>>            End_Procedure
39325>>>>>>>            
39325>>>>>>>            // If you set Current_radio you must set this after the
39325>>>>>>>            // radio objects have been created AND after Notify_select_State has been
39325>>>>>>>            // created. i.e. Set in bottom-code at end!!
39325>>>>>>>            //Set Current_Radio to 0
39325>>>>>>>            
39325>>>>>>>            
39325>>>>>>>            //AB-StoreEnd
39325>>>>>>>
39325>>>>>>>        End_Object    // RadioGroupSub1
39326>>>>>>>
39326>>>>>>>        Object ButtonSub1 is a ButtonSub
39328>>>>>>>            Set Label to "Search"
39329>>>>>>>            Set Size to 28 37
39330>>>>>>>            Set Location to 210 413
39331>>>>>>>            Set Form_FontWeight Item 0 to 800
39332>>>>>>>            Set Form_TypeFace Item 0 to "ms sans serif"
39333>>>>>>>
39333>>>>>>>            //AB-StoreStart
39333>>>>>>>                                        
39333>>>>>>>            Set Visible_State to False
39334>>>>>>>            
39334>>>>>>>            Procedure OnClick
39336>>>>>>>                Forward Send OnClick
39338>>>>>>>                Set pscode  to (Value(ocode(Self),0))
39339>>>>>>>                Set psperi  to (Value(operi(Self),0))
39340>>>>>>>                Set pscodeprom  to (Value(ocodeprom(Self),0))
39341>>>>>>>                send Rebuild_Constraints    to (witemcl_DD(Self))
39342>>>>>>>                Send Beginning_Of_Data      to the_table
39343>>>>>>>            End_Procedure // OnClick
39344>>>>>>>            
39344>>>>>>>            
39344>>>>>>>            
39344>>>>>>>            
39344>>>>>>>            
39344>>>>>>>            
39344>>>>>>>            
39344>>>>>>>            
39344>>>>>>>            
39344>>>>>>>            
39344>>>>>>>            
39344>>>>>>>            
39344>>>>>>>            
39344>>>>>>>            
39344>>>>>>>            
39344>>>>>>>            //AB-StoreEnd
39344>>>>>>>
39344>>>>>>>        End_Object    // ButtonSub1
39345>>>>>>>
39345>>>>>>>        Object btnwitemcl is a ButtonSub
39347>>>>>>>
39347>>>>>>>            //AB-StoreTopStart
39347>>>>>>>                                                                                    
39347>>>>>>>            //AB-StoreTopEnd
39347>>>>>>>
39347>>>>>>>            Set Label to "ButtonSub1"
39348>>>>>>>            Set Bitmap to "Filesys3.bmp"
39349>>>>>>>            Set Size to 22 25
39350>>>>>>>            Set Location to 214 482
39351>>>>>>>            Set Focus_Mode to Pointer_Only
39352>>>>>>>
39352>>>>>>>            //AB-StoreStart
39352>>>>>>>                                                                                    
39352>>>>>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«¦ œ¬¨œ«ã¨ ¦ „ ›é¤"
39353>>>>>>>            
39353>>>>>>>            Procedure OnClick
39355>>>>>>>                String  scode speri
39356>>>>>>>                Get value of (ocode(self)) to scode
39357>>>>>>>                Get value of (operi(self)) to speri
39358>>>>>>>                set pscode of (sl17(self)) to scode
39359>>>>>>>                set psperi of (sl17(self)) to speri
39360>>>>>>>                send request_cancel to dg186
39361>>>>>>>            End_Procedure // OnClick
39362>>>>>>>            
39362>>>>>>>            
39362>>>>>>>            
39362>>>>>>>            
39362>>>>>>>            
39362>>>>>>>            
39362>>>>>>>            
39362>>>>>>>            
39362>>>>>>>            
39362>>>>>>>            
39362>>>>>>>            
39362>>>>>>>            
39362>>>>>>>            
39362>>>>>>>            
39362>>>>>>>            
39362>>>>>>>            
39362>>>>>>>            
39362>>>>>>>            
39362>>>>>>>            
39362>>>>>>>            
39362>>>>>>>            
39362>>>>>>>            //AB-StoreEnd
39362>>>>>>>
39362>>>>>>>        End_Object    // btnwitemcl
39363>>>>>>>
39363>>>>>>>
39363>>>>>>>        //AB-StoreStart
39363>>>>>>>        Procedure Activating
39365>>>>>>>           integer rval
39366>>>>>>>           set value of (ocode(self)) to (pscode(self))
39367>>>>>>>           set value of (operi(self)) to (psperi(self))
39368>>>>>>>           Send Rebuild_Constraints to (witemcl_DD(Self))
39369>>>>>>>           Forward send Activating
39371>>>>>>>        
39371>>>>>>>        End_Procedure
39372>>>>>>>        
39372>>>>>>>        
39372>>>>>>>        
39372>>>>>>>        
39372>>>>>>>        
39372>>>>>>>        
39372>>>>>>>        //AB-StoreEnd
39372>>>>>>>
39372>>>>>>>    End_Object    // dg186
39373>>>>>>>
39373>>>>>>>
39373>>>>>>>    //AB-StoreStart
39373>>>>>>>        
39373>>>>>>>    //AB-StoreEnd
39373>>>>>>>
39373>>>>>>>//AB/     End_Object    // prj
39373>>>>>    
39373>>>>>    //AB-StoreTopEnd
39373>>>>>
39373>>>>>    //AB-IgnoreStart
39373>>>>>
39373>>>>>    Use DFAllEnt.pkg
39373>>>>>    Use dbList.Sub
39373>>>>>    Use Txtbox.Sub
39373>>>>>    Use Form.Sub
39373>>>>>    Use Rgroup.Sub
39373>>>>>    Use Radio.Sub
39373>>>>>    Use Button.Sub
39373>>>>>
39373>>>>>
39373>>>>>    Use UNITS.DD
39373>>>>>    Use WITEMKAT.DD
39373>>>>>    Use FPA.DD
39373>>>>>    Use ITEM.DD
39373>>>>>    Use WITEMX.DD
INCLUDING FILE: WITEMX.DD
39373>>>>>>>//DDB-FileStart
39373>>>>>>>//DDB-HeaderStart
39373>>>>>>>
39373>>>>>>>// File Name : WITEMX.DD
39373>>>>>>>// Class Name: Witemx_DataDictionary
39373>>>>>>>// Revision  : 72
39373>>>>>>>// Version   : 2
39373>>>>>>>
39373>>>>>>>Use  Windows           // Basic Definitions
39373>>>>>>>Use  DataDict          // DataDictionary Class Definition
39373>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39373>>>>>>>
39373>>>>>>>Open Witemx
39375>>>>>>>Open Wcmoves
39377>>>>>>>Open Witemxt
39379>>>>>>>Open Pmoves
39381>>>>>>>Open Wam
39383>>>>>>>Open Pmovesl
39385>>>>>>>Open Camovedd
INCLUDING FILE: CAMOVEDD.FD
39387>>>>>>>Open Witemxen
INCLUDING FILE: WITEMXEN.FD
39389>>>>>>>Open Item
39391>>>>>>>Open Sysrecw
39393>>>>>>>Open Syscurxr
39395>>>>>>>
39395>>>>>>>//DDB-HeaderEnd
39395>>>>>>>//DDB-SelectionStart
39395>>>>>>>//DDB/ ExternalSelectionList SL17  sl17.SL
39395>>>>>>>Register_Object SL17
39395>>>>>>>//DDB-SelectionEnd
39395>>>>>>>
39395>>>>>>>Class Witemx_DataDictionary  is a DataDictionary
39396>>>>>>>
39396>>>>>>>    Procedure Construct_Object
39397>>>>>>>        Forward Send Construct_Object
39399>>>>>>>        Property Integer piMustNOTConstrain Public 0
39400>>>>>>>    End_Procedure //construct_object
39401>>>>>>>
39401>>>>>>>    Procedure OnConstrain
39402>>>>>>>        Forward Send OnConstrain
39404>>>>>>>        If (piMustNOTConstrain(Self)) Begin
39406>>>>>>>        End
39406>>>>>>>>
39406>>>>>>>        Else Begin
39407>>>>>>>            Constrain Witemx.Company_Code  eq SysCurXR.Company_Code
39409>>>>>>>            Constrain Witemx.Branch_Code   eq SysCurXR.Branch_Code
39411>>>>>>>            Constrain Witemx.Year_Year     eq SysCurXR.Year_Year
39413>>>>>>>        End
39413>>>>>>>>
39413>>>>>>>    End_Procedure
39414>>>>>>>
39414>>>>>>>    Procedure Save_Main_File
39415>>>>>>>        If (Operation_Origin<>Self) Begin
39417>>>>>>>            If Witemx.Recnum Eq 0 Procedure_Return
39420>>>>>>>        End
39420>>>>>>>>
39420>>>>>>>        Forward Send Save_Main_File
39422>>>>>>>    End_Procedure
39423>>>>>>>
39423>>>>>>>    // Update:
39423>>>>>>>    Procedure Update
39424>>>>>>>        Forward Send Update
39426>>>>>>>        // Insert Code Here
39426>>>>>>>        Move SysCurXR.Company_Code  to Witemx.Company_Code
39427>>>>>>>        Move SysCurXR.Branch_Code   to Witemx.Branch_Code
39428>>>>>>>        Move SysCurXR.Year_Year     to Witemx.Year_Year
39429>>>>>>>        Move SysCurXR.Year_Recr     to Witemx.Year_Recr
39430>>>>>>>        Move Witemkat.Witemkat_Code to Witemx.Witemkat_Code
39431>>>>>>>        Move Units.Units_Code       to Witemx.Units_Code
39432>>>>>>>        Move Item.Item_Code         to Witemx.Item_Code
39433>>>>>>>        Move Item.Item_Code         to Witemx.Witemx_Code
39434>>>>>>>        Move Item.Item_Descr        to Witemx.Witemx_Descr
39435>>>>>>>        Move Item.Wapokat_Code      to Witemx.ITEM_APOKAT_COD 
39436>>>>>>>        Move Item.link1             to witemx.link1
39437>>>>>>>        move Item.link2             to witemx.link2
39438>>>>>>>        Move (Round_Number((Witemx.Axia_Xre/Witemx.Qty_Xre),4))  to Witemx.Mesosta_Xre
ERROR: 54 Invalid symbol in expression ROUND_NUMBER ON LINE: 72 (39438) OF FILE: V:\Vdf6\Develop\Empor\DDSrc\WITEMX.DD
39439>>>>>>>        Move (Round_Number((Witemx.Axia_Pis/Witemx.Qty_Pis),4))  to Witemx.Mesosta_Pis
ERROR: 54 Invalid symbol in expression ROUND_NUMBER ON LINE: 73 (39439) OF FILE: V:\Vdf6\Develop\Empor\DDSrc\WITEMX.DD
39440>>>>>>>    End_Procedure   // Update
39441>>>>>>>
39441>>>>>>>
39441>>>>>>>    Procedure Backout
39442>>>>>>>        Forward Send Backout
39444>>>>>>>        Move (Round_Number((Witemx.Axia_Xre/Witemx.Qty_Xre),4))  to Witemx.Mesosta_Xre
ERROR: 54 Invalid symbol in expression ROUND_NUMBER ON LINE: 79 (39444) OF FILE: V:\Vdf6\Develop\Empor\DDSrc\WITEMX.DD
39445>>>>>>>        Move (Round_Number((Witemx.Axia_Pis/Witemx.Qty_Pis),4))  to Witemx.Mesosta_Pis
ERROR: 54 Invalid symbol in expression ROUND_NUMBER ON LINE: 80 (39445) OF FILE: V:\Vdf6\Develop\Empor\DDSrc\WITEMX.DD
39446>>>>>>>    End_Procedure   // Update
39447>>>>>>>
39447>>>>>>>    Procedure Creating
39448>>>>>>>        Forward Send Creating
39450>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                       (Trim(String(Witemx.Witemx_Rec0)))))) to Witemx.Witemx_Recr
39451>>>>>>>    End_Procedure   // Creating
39452>>>>>>>
39452>>>>>>>
39452>>>>>>>
39452>>>>>>>    // Define_Fields:
39452>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39452>>>>>>>
39452>>>>>>>    Procedure Define_Fields
39453>>>>>>>        Forward Send Define_Fields
39455>>>>>>>        //DDB-Generated-Code-Location
39455>>>>>>>        //DDB-DefineFieldStart
39455>>>>>>>
39455>>>>>>>        Set Main_File            To Witemx.File_Number
39456>>>>>>>        Set Cascade_Delete_State To FALSE
39457>>>>>>>
39457>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39458>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39459>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39460>>>>>>>
39460>>>>>>>        // Child (Client) file structure................
39460>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
39461>>>>>>>        Send Add_Client_File  Witemxt.File_Number
39462>>>>>>>        Send Add_Client_File  Pmoves.File_Number
39463>>>>>>>        Send Add_Client_File  Wam.File_Number
39464>>>>>>>        Send Add_Client_File  Pmovesl.File_Number
39465>>>>>>>        Send Add_Client_File  Camovedd.File_Number
39466>>>>>>>        Send Add_Client_File  Witemxen.File_Number
39467>>>>>>>
39467>>>>>>>        // Parent (Server) file structure...............
39467>>>>>>>        Send Add_Server_File  Item.File_Number
39468>>>>>>>
39468>>>>>>>        // External (System) file structure.............
39468>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
39469>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
39470>>>>>>>
39470>>>>>>>        Define_Auto_Increment  Sysrecw.Witemx_Rec0  To Witemx.Witemx_Rec0
39473>>>>>>>
39473>>>>>>>        // Field-based properties.......................
39473>>>>>>>
39473>>>>>>>        // Witemx.Company_Code
39473>>>>>>>
39473>>>>>>>        // Witemx.Branch_Code
39473>>>>>>>
39473>>>>>>>        // Witemx.Year_Year
39473>>>>>>>
39473>>>>>>>        // Witemx.Units_Code
39473>>>>>>>
39473>>>>>>>        // Witemx.Witemkat_Code
39473>>>>>>>
39473>>>>>>>        // Witemx.Item_Code
39473>>>>>>>
39473>>>>>>>        // Witemx.Witemx_Code
39473>>>>>>>        Set Field_Options          Field Witemx.Witemx_Code To DD_AUTOFIND   
39474>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Code To (SL17(Self))
39475>>>>>>>
39475>>>>>>>        // Witemx.Witemx_Recr
39475>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Recr To (SL17(Self))
39476>>>>>>>
39476>>>>>>>        // Witemx.Year_Recr
39476>>>>>>>
39476>>>>>>>        // Witemx.Item_Recr
39476>>>>>>>
39476>>>>>>>        // Witemx.Witemx_Descr
39476>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Descr To (SL17(Self))
39477>>>>>>>
39477>>>>>>>        // Witemx.Witemx_Rec0
39477>>>>>>>
39477>>>>>>>        // Witemx.Witemx_Yeardesc
39477>>>>>>>
39477>>>>>>>        // Witemx.Item_Apokat_Cod
39477>>>>>>>
39477>>>>>>>        // Witemx.Qty_Xre
39477>>>>>>>
39477>>>>>>>        // Witemx.Qty_Pis
39477>>>>>>>
39477>>>>>>>        // Witemx.Axia_Xre
39477>>>>>>>
39477>>>>>>>        // Witemx.Axia_Pis
39477>>>>>>>
39477>>>>>>>        // Witemx.Mesosta_Xre
39477>>>>>>>
39477>>>>>>>        // Witemx.Mesosta_Pis
39477>>>>>>>
39477>>>>>>>        // Witemx.Link1
39477>>>>>>>
39477>>>>>>>        // Witemx.Link2
39477>>>>>>>
39477>>>>>>>        //DDB-DefineFieldEnd
39477>>>>>>>    End_Procedure    // Define_Fields
39478>>>>>>>
39478>>>>>>>    // Field_Defaults:
39478>>>>>>>    // This procedure is used to establish default field values.
39478>>>>>>>
39478>>>>>>>    Procedure Field_Defaults
39479>>>>>>>        Forward Send Field_Defaults
39481>>>>>>>        //DDB-Generated-Code-Location
39481>>>>>>>        //DDB-FieldDefaultStart
39481>>>>>>>        //DDB-FieldDefaultEnd
39481>>>>>>>    End_Procedure    // Field_Defaults
39482>>>>>>>
39482>>>>>>>End_Class    // Witemx_DataDictionary
39483>>>>>>>//DDB-Selection-pkg-Start
39483>>>>>>>
39483>>>>>>>Use sl17.SL          // SL17
39483>>>>>>>
39483>>>>>>>//DDB-Selection-pkg-End
39483>>>>>>>//DDB-FileEnd
39483>>>>>    
39483>>>>>    //AB-IgnoreEnd
39483>>>>>
39483>>>>>    Object SL17 is a dbModalPanelSub
39485>>>>>
39485>>>>>        //AB-StoreTopStart
39485>>>>>        
39485>>>>>        Property String     pscode                  ''
39487>>>>>        Property String     psperi                  ''
39489>>>>>        Property Integer    piContains_Or_Starts     0
39491>>>>>        Property String     pscodekat               ''
39493>>>>>        
39493>>>>>        //AB-StoreTopEnd
39493>>>>>
39493>>>>>        Set Minimize_Icon to FALSE
39494>>>>>        Set Label to "„¬¨œ«ã¨ ¦ €¨®œå¦¬ „ ›é¤"
39495>>>>>        Set Size to 266 484
39496>>>>>        Set Location to 9 14
39497>>>>>        Set Exit_Application_Local_State to FALSE
39498>>>>>        Set Modal_State to FALSE
39499>>>>>
39499>>>>>        //AB-DDOStart
39499>>>>>
39499>>>>>        Object Units_DD is a Units_DataDictionary
39501>>>>>        End_Object    // Units_DD
39502>>>>>
39502>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
39504>>>>>        End_Object    // Witemkat_DD
39505>>>>>
39505>>>>>        Object Fpa_DD is a Fpa_DataDictionary
39507>>>>>        End_Object    // Fpa_DD
39508>>>>>
39508>>>>>        Object Item_DD is a Item_DataDictionary
39510>>>>>
39510>>>>>            //AB-StoreTopStart
39510>>>>>            
39510>>>>>            
39510>>>>>            //AB-StoreTopEnd
39510>>>>>
39510>>>>>            Set DDO_Server to (Units_DD(self))
39511>>>>>            Set DDO_Server to (Witemkat_DD(self))
39512>>>>>            Set DDO_Server to (Fpa_DD(self))
39513>>>>>
39513>>>>>            //AB-StoreStart
39513>>>>>            
39513>>>>>            
39513>>>>>            
39513>>>>>            
39513>>>>>            
39513>>>>>            
39513>>>>>            
39513>>>>>            
39513>>>>>            //AB-StoreEnd
39513>>>>>
39513>>>>>        End_Object    // Item_DD
39514>>>>>
39514>>>>>        Object Witemx_DD is a Witemx_DataDictionary
39516>>>>>
39516>>>>>            //AB-StoreTopStart
39516>>>>>            Function fiPeriexei Returns Integer
39518>>>>>                       String lsperi lscode  lscodekat
39519>>>>>                       Integer rVal liContains_Or_Starts
39519>>>>>                       Move 0 to rVal
39520>>>>>                       Get piContains_Or_Starts to liContains_Or_Starts
39521>>>>>                       Get psperi to lsperi
39522>>>>>                       Get pscode to lscode
39523>>>>>                       Get pscodekat to lscodekat
39524>>>>>                       Move (Trim(lsperi)) to lsperi
39525>>>>>                       Move (Trim(lscode)) to lscode
39526>>>>>                       If (liContains_Or_Starts=0) Begin
39528>>>>>                           If ((Trim(witemx.witemx_descr)) Contains lsperi) Begin
39530>>>>>                               If ((Trim(witemx.witemx_code)) Contains lscode) Move 1 to rVal
39533>>>>>                           End
39533>>>>>>
39533>>>>>                       End
39533>>>>>>
39533>>>>>                       Else Begin
39534>>>>>                           If (Left(witemx.witemx_descr,(Length(lsperi)))=lsperi) Begin
39536>>>>>                               If (Left(witemx.witemx_code,(Length(lscode)))=lscode) Move 1 to rVal
39539>>>>>                           End
39539>>>>>>
39539>>>>>                       End
39539>>>>>>
39539>>>>>                       Function_Return rVal
39540>>>>>                   End_Function
39541>>>>>            
39541>>>>>                   Function fiArxizeiperi Returns Integer
39543>>>>>                       String lsperi
39544>>>>>                       Get psperi to lsperi
39545>>>>>                       Move (Trim(lsperi)) to lsperi
39546>>>>>                       Function_Return (Left(witemx.witemx_descr,(Length(lsperi)))=lsperi)
39547>>>>>                   End_Function
39548>>>>>            
39548>>>>>                   Function fiArxizeicode Returns Integer
39550>>>>>                       String lscode lscodekat
39551>>>>>                       Get pscode to lscode
39552>>>>>                       Move (Trim(lscode)) to lscode
39553>>>>>                       Function_Return (Left(witemx.witemx_code,(Length(lscode)))=lscode)
39554>>>>>                   End_Function
39555>>>>>            //AB-StoreTopEnd
39555>>>>>
39555>>>>>            Set DDO_Server to (Item_DD(self))
39556>>>>>
39556>>>>>            //AB-StoreStart
39556>>>>>            
39556>>>>>            Begin_Constraints
39558>>>>>               String lsperi lscode lsvalue lstype lscodekat
39559>>>>>               Integer liContains_Or_Starts
39559>>>>>               Get psperi               to lsperi
39560>>>>>               Get pscode               to lscode
39561>>>>>               Get pscodekat            to lscodekat
39562>>>>>               Get piContains_Or_Starts to liContains_Or_Starts
39563>>>>>               Move (Trim(lsperi))      to lsperi
39564>>>>>               Move (Trim(lscode))      to lscode
39565>>>>>               Move (Trim(lscodekat))   to lscodekat
39566>>>>>            
39566>>>>>               If ((lsperi<>'') and (lscode<>'')) Begin
39568>>>>>                    Set Ordering to 4
39569>>>>>                    Constrain witemx as (fiPeriexei(Self)=1)
39570>>>>>               End
39570>>>>>>
39570>>>>>               Else Begin
39571>>>>>                  If (liContains_Or_Starts=0) Begin
39573>>>>>                        If (lsperi<>'') Begin
39575>>>>>                            Set Ordering to 3
39576>>>>>                            Constrain witemx.witemx_descr Contains lsperi
39578>>>>>                        End
39578>>>>>>
39578>>>>>                        Else If (lscode<>'') Begin
39581>>>>>                            Set Ordering to 4
39582>>>>>                            Constrain witemx.witemx_code Contains lscode
39584>>>>>                        End
39584>>>>>>
39584>>>>>                  End
39584>>>>>>
39584>>>>>                  Else Begin
39585>>>>>                        If (lsperi<>'') Begin
39587>>>>>                            Set Ordering to 3
39588>>>>>                            Constrain witemx as (fiArxizeiperi(Self)=1) //witemx.witemx_descr
39589>>>>>                        End
39589>>>>>>
39589>>>>>                        Else If (lscode<>'') Begin
39592>>>>>                            Set Ordering to 4
39593>>>>>                            Constrain witemx as (fiArxizeicode(Self)=1) //witemx.witemx_code
39594>>>>>                        End
39594>>>>>>
39594>>>>>                  End
39594>>>>>>
39594>>>>>                  If (lscodekat<>'') Begin
39596>>>>>                        Constrain witemx.witemkat_code Contains lscodekat
39598>>>>>                  End
39598>>>>>>
39598>>>>>               End
39598>>>>>>
39598>>>>>            End_Constraints
39601>>>>>            
39601>>>>>            //AB-StoreEnd
39601>>>>>
39601>>>>>        End_Object    // Witemx_DD
39602>>>>>
39602>>>>>        Set Main_DD to (Witemx_DD(self))
39603>>>>>        Set Server to (Witemx_DD(self))
39604>>>>>
39604>>>>>        //AB-DDOEnd
39604>>>>>
39604>>>>>        Object oSelList is a dbListSub
39606>>>>>            Set Main_File to Witemx.File_Number
39607>>>>>            Set Ordering to 4
39608>>>>>            Set Size to 190 475
39609>>>>>            Set Location to 1 1
39610>>>>>            Set Color to 14280447
39611>>>>>            Set CurrentRowColor to 11783679
39612>>>>>            Set CurrentCellColor to 11783679
39613>>>>>
39613>>>>>            Begin_Row
39616>>>>>                Entry_Item Witemx.Witemx_code
39617>>>>>                Entry_Item Witemx.Witemx_descr
39618>>>>>                Entry_Item Witemx.Witemkat_code
39619>>>>>                Entry_Item Witemkat.Witemkat_descr
39620>>>>>                Entry_Item Item.Item_qual
39621>>>>>                Entry_Item Fpa.Fpa_pososto
39622>>>>>            End_Row
39627>>>>>
39627>>>>>            Set Form_Width    item 0 to 60
39628>>>>>            Set Header_Label  item 0 to "‰à›. „å›¦¬ª"
39629>>>>>            
39629>>>>>            Set Form_Width    item 1 to 140
39630>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
39631>>>>>            
39631>>>>>            Set Form_Width    item 2 to 70
39632>>>>>            Set Header_Label  item 2 to "‰à›. ‰˜«žš¦¨å˜ª"
39633>>>>>            
39633>>>>>            Set Form_Width    item 3 to 88
39634>>>>>            Set Header_Label  item 3 to "œ¨ š¨˜­ã ‰˜«žš."
39635>>>>>            
39635>>>>>            Set Form_Width    item 4 to 64
39636>>>>>            Set Header_Label  item 4 to "¦ æ«ž«˜"
39637>>>>>            
39637>>>>>            Set Form_Width    item 5 to 45
39638>>>>>            Set Header_Label  item 5 to "‰˜«.”..€"
39639>>>>>            
39639>>>>>
39639>>>>>            //AB-StoreStart
39639>>>>>            Property String Store_Fragma_Items public ""
39641>>>>>            
39641>>>>>            //Procedure Activating
39641>>>>>            //    Forward send Activating
39641>>>>>            //    Send Rebuild_Constraints to (witemx_DD(Self))
39641>>>>>            //End_Procedure
39641>>>>>            
39641>>>>>            Procedure End_Construct_Object
39643>>>>>                Forward Send End_Construct_Object
39645>>>>>                Set Color               to 14280447
39646>>>>>                Set CurrentRowColor     to 11783679
39647>>>>>                Set CurrentCellColor    to 11783679
39648>>>>>            End_Procedure
39649>>>>>            
39649>>>>>            
39649>>>>>            
39649>>>>>            
39649>>>>>            
39649>>>>>            
39649>>>>>            
39649>>>>>            
39649>>>>>            //AB-StoreEnd
39649>>>>>
39649>>>>>        End_Object    // oSelList
39650>>>>>
39650>>>>>        Object TextBoxSub1 is a TextBoxSub
39652>>>>>            Set Label to "‘á¨à©ž ¡à› ¡¦ç š ˜"
39653>>>>>            Set Auto_Size_State to FALSE
39654>>>>>            Set Location to 192 6
39655>>>>>            Set Size to 13 69
39656>>>>>        End_Object    // TextBoxSub1
39657>>>>>
39657>>>>>        Object ocode is a FormSub
39659>>>>>            Set Size to 13 197
39660>>>>>            Set Location to 192 79
39661>>>>>            Set Label_Col_Offset to 2
39662>>>>>
39662>>>>>            //AB-StoreStart
39662>>>>>            
39662>>>>>            Procedure OnKILLFOCUS00
39664>>>>>               Send KeyAction to ButtonSub1
39665>>>>>            End_Procedure
39666>>>>>            
39666>>>>>            
39666>>>>>            
39666>>>>>            
39666>>>>>            
39666>>>>>            //AB-StoreEnd
39666>>>>>
39666>>>>>        End_Object    // ocode
39667>>>>>
39667>>>>>        Object TextBoxSub2 is a TextBoxSub
39669>>>>>            Set Label to "‘á¨à©ž §œ¨ š¨˜­ãª "
39670>>>>>            Set Auto_Size_State to FALSE
39671>>>>>            Set Location to 207 6
39672>>>>>            Set Size to 13 71
39673>>>>>        End_Object    // TextBoxSub2
39674>>>>>
39674>>>>>        Object operi is a FormSub
39676>>>>>            Set Size to 13 197
39677>>>>>            Set Location to 207 79
39678>>>>>            Set Label_Col_Offset to 2
39679>>>>>
39679>>>>>            //AB-StoreStart
39679>>>>>            
39679>>>>>            Procedure OnKILLFOCUS00
39681>>>>>               Send KeyAction to ButtonSub1
39682>>>>>            End_Procedure
39683>>>>>            
39683>>>>>            
39683>>>>>            
39683>>>>>            
39683>>>>>            
39683>>>>>            //AB-StoreEnd
39683>>>>>
39683>>>>>        End_Object    // operi
39684>>>>>
39684>>>>>        Object RadioGroupSub1 is a RadioGroupSub
39686>>>>>            Set Size to 32 77
39687>>>>>            Set Location to 191 279
39688>>>>>            Object Radio1 is a RadioSub
39690>>>>>                Set Label to "œ¨ â®œ«˜ "
39691>>>>>                Set Size to 10 53
39692>>>>>                Set Location to 7 5
39693>>>>>            End_Object    // Radio1
39694>>>>>
39694>>>>>            Object Radio2 is a RadioSub
39696>>>>>                Set Label to "€¨®åœ  €§¦"
39697>>>>>                Set Size to 10 52
39698>>>>>                Set Location to 21 5
39699>>>>>            End_Object    // Radio2
39700>>>>>
39700>>>>>
39700>>>>>            //AB-StoreStart
39700>>>>>            
39700>>>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
39702>>>>>                //iToItem=0 => Contains, =1 => Starts with
39702>>>>>                Set piContains_Or_Starts to iToItem
39703>>>>>                //Send KeyAction to ButtonSub1
39703>>>>>            End_Procedure
39704>>>>>            
39704>>>>>            // If you set Current_radio you must set this after the
39704>>>>>            // radio objects have been created AND after Notify_select_State has been
39704>>>>>            // created. i.e. Set in bottom-code at end!!
39704>>>>>            //Set Current_Radio to 0
39704>>>>>            
39704>>>>>            
39704>>>>>            
39704>>>>>            //AB-StoreEnd
39704>>>>>
39704>>>>>        End_Object    // RadioGroupSub1
39705>>>>>
39705>>>>>        Object ButtonSub1 is a ButtonSub
39707>>>>>            Set Label to "œ¨ æ¨ ©œ"
39708>>>>>            Set Size to 15 197
39709>>>>>            Set Location to 236 79
39710>>>>>            Set Form_FontWeight Item 0 to 800
39711>>>>>            Set Form_TypeFace Item 0 to "ms sans serif"
39712>>>>>
39712>>>>>            //AB-StoreStart
39712>>>>>            //Set Visible_State to False
39712>>>>>            
39712>>>>>            Procedure OnClick
39714>>>>>                Forward Send OnClick
39716>>>>>                Set pscode      to (Value(ocode(Self),0))
39717>>>>>                Set psperi      to (Value(operi(Self),0))
39718>>>>>                Set pscodekat   to (Value(ocodekat(Self),0))
39719>>>>>                send Rebuild_Constraints    to (witemx_DD(Self))
39720>>>>>                Send Beginning_Of_Data      to oSelList True
39721>>>>>            End_Procedure // OnClick
39722>>>>>            
39722>>>>>            //AB-StoreEnd
39722>>>>>
39722>>>>>        End_Object    // ButtonSub1
39723>>>>>
39723>>>>>        Object TextBoxSub3 is a TextBoxSub
39725>>>>>            Set Label to "‰à›. ¡˜«žš¦¨å˜ª š ˜"
39726>>>>>            Set Auto_Size_State to FALSE
39727>>>>>            Set Location to 221 5
39728>>>>>            Set Size to 13 70
39729>>>>>        End_Object    // TextBoxSub3
39730>>>>>
39730>>>>>        Object ocodekat is a FormSub
39732>>>>>            Set Size to 13 197
39733>>>>>            Set Location to 221 79
39734>>>>>            Set Label_Col_Offset to 2
39735>>>>>
39735>>>>>            //AB-StoreStart
39735>>>>>            
39735>>>>>            Procedure OnKILLFOCUS00
39737>>>>>                Send KeyAction to ButtonSub1
39738>>>>>            End_Procedure
39739>>>>>            
39739>>>>>            
39739>>>>>            
39739>>>>>            
39739>>>>>            //AB-StoreEnd
39739>>>>>
39739>>>>>        End_Object    // ocodekat
39740>>>>>
39740>>>>>        Object oOK_bn is a ButtonSub
39742>>>>>            Set Label to "&„§ ¢¦šã"
39743>>>>>            Set Location to 232 318
39744>>>>>
39744>>>>>            //AB-StoreStart
39744>>>>>            Procedure OnClick
39746>>>>>                Send OK To (oSelList(current_object))
39747>>>>>            End_Procedure
39748>>>>>            //AB-StoreEnd
39748>>>>>
39748>>>>>        End_Object    // oOK_bn
39749>>>>>
39749>>>>>        Object oCancel_bn is a ButtonSub
39751>>>>>            Set Label to "&€¡ç¨à©ž"
39752>>>>>            Set Location to 232 373
39753>>>>>
39753>>>>>            //AB-StoreStart
39753>>>>>            Procedure OnClick
39755>>>>>                Send Cancel To (oSelList(current_object))
39756>>>>>            End_Procedure
39757>>>>>            //AB-StoreEnd
39757>>>>>
39757>>>>>        End_Object    // oCancel_bn
39758>>>>>
39758>>>>>        Object oSearch_bn is a ButtonSub
39760>>>>>            Set Label to "€&¤˜ã«ž©ž"
39761>>>>>            Set Location to 232 428
39762>>>>>
39762>>>>>            //AB-StoreStart
39762>>>>>            Procedure OnClick
39764>>>>>                Send Search To (oSelList(current_object))
39765>>>>>            End_Procedure
39766>>>>>            //AB-StoreEnd
39766>>>>>
39766>>>>>        End_Object    // oSearch_bn
39767>>>>>
39767>>>>>        Object btnwitemcl is a ButtonSub
39769>>>>>
39769>>>>>            //AB-StoreTopStart
39769>>>>>            
39769>>>>>            //AB-StoreTopEnd
39769>>>>>
39769>>>>>            Set Label to "ButtonSub1"
39770>>>>>            Set Bitmap to "Filesys3.bmp"
39771>>>>>            Set Size to 22 25
39772>>>>>            Set Location to 196 443
39773>>>>>            Set Focus_Mode to Pointer_Only
39774>>>>>
39774>>>>>            //AB-StoreStart
39774>>>>>            
39774>>>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«¦ œ¬¨œ«ã¨ ¦ „ ›é¤ / ¨¦£žŸœ¬«ã"
39775>>>>>            
39775>>>>>            Procedure OnClick
39777>>>>>                String  scode speri
39778>>>>>                Get value of (ocode(self)) to scode
39779>>>>>                Get value of (operi(self)) to speri
39780>>>>>                set pscode of (dg186(self)) to scode
39781>>>>>                set psperi of (dg186(self)) to speri
39782>>>>>              //  set modal_state of (sl17(self)) to false
39782>>>>>              //  Set block_mouse_state of v186 to true
39782>>>>>               Send popup_modal to (dg186(self))
39783>>>>>              //  send mouse_down to (v186(self))
39783>>>>>              //  Set block_mouse_state of v186 to false
39783>>>>>              //  set modal_state of (sl17(self)) to true
39783>>>>>            End_Procedure // OnClick
39784>>>>>            
39784>>>>>            
39784>>>>>            
39784>>>>>            
39784>>>>>            
39784>>>>>            
39784>>>>>            
39784>>>>>            
39784>>>>>            
39784>>>>>            
39784>>>>>            
39784>>>>>            
39784>>>>>            
39784>>>>>            
39784>>>>>            
39784>>>>>            
39784>>>>>            
39784>>>>>            
39784>>>>>            
39784>>>>>            
39784>>>>>            
39784>>>>>            
39784>>>>>            //AB-StoreEnd
39784>>>>>
39784>>>>>        End_Object    // btnwitemcl
39785>>>>>
39785>>>>>
39785>>>>>        //AB-StoreStart
39785>>>>>        
39785>>>>>        Set Locate_Mode to Center_On_Screen
39786>>>>>        
39786>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
39787>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
39788>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
39789>>>>>        
39789>>>>>        Procedure Activate
39791>>>>>            Send Rebuild_Constraints    to Witemx_DD
39792>>>>>            Send Beginning_Of_Data      to oSelList True
39793>>>>>            Forward Send Activate
39795>>>>>        End_Procedure
39796>>>>>        
39796>>>>>        
39796>>>>>        //AB-StoreEnd
39796>>>>>
39796>>>>>    End_Object    // SL17
39797>>>>>
39797>>>>>
39797>>>>>    //AB-StoreStart
39797>>>>>    
39797>>>>>    
39797>>>>>    
39797>>>>>    
39797>>>>>    
39797>>>>>    
39797>>>>>    
39797>>>>>    
39797>>>>>    
39797>>>>>    
39797>>>>>    
39797>>>>>    //AB-StoreEnd
39797>>>>>
39797>>>>>//AB/     End_Object    // prj
39797>>>    use sl024.sl
39797>>>    open wax
39799>>>    
39799>>>    //AB-StoreTopEnd
39799>>>
39799>>>    //AB-IgnoreStart
39799>>>
39799>>>    Use DFAllEnt.pkg
39799>>>    Use Group.Sub
39799>>>    Use Form.Sub
39799>>>    Use Txtbox.Sub
39799>>>    Use Line.Sub
39799>>>    Use Rgroup.Sub
39799>>>    Use Radio.Sub
39799>>>    Use Button.Sub
39799>>>
39799>>>    //AB-IgnoreEnd
39799>>>
39799>>>    ACTIVATE_VIEW Activate_R17_2 FOR R17_2
39803>>>
39803>>>    Object R17_2 is a ReportView
39805>>>
39805>>>        //AB-StoreTopStart
39805>>>        
39805>>>        property string  psdateto
39807>>>        property string  psdatefrom
39809>>>        property string  psitemfrom
39811>>>        property string  psitemto
39813>>>        property string  psapo
39815>>>        property string  pswaxfrom
39817>>>        property string  pswitemkatfrom
39819>>>        
39819>>>        
39819>>>        property integer piepil public 0
39821>>>        Property String  psModule Public ''
39823>>>        
39823>>>        property number  ktotambd0 public 0
39825>>>        property number  kdiscam0  public 0
39827>>>        property number  kextra0   public 0
39829>>>        property number  kqtyeisa  public 0
39831>>>        property number  kqtyexa   public 0
39833>>>        property number  kx0       public 0
39835>>>        property number  kp0       public 0
39837>>>        
39837>>>        property number  htotambd0 public 0
39839>>>        property number  hdiscam0  public 0
39841>>>        property number  hextra0   public 0
39843>>>        property number  hqtyeisa  public 0
39845>>>        property number  hqtyexa   public 0
39847>>>        property number  hx0       public 0
39849>>>        property number  hp0       public 0
39851>>>        
39851>>>        property number  ttotambd0 public 0
39853>>>        property number  tdiscam0  public 0
39855>>>        property number  textra0   public 0
39857>>>        property number  tqtyeisa  public 0
39859>>>        property number  tqtyexa   public 0
39861>>>        property number  tx0       public 0
39863>>>        property number  tp0       public 0
39865>>>        property integer pihmgio   public 0
39867>>>        //AB-StoreTopEnd
39867>>>
39867>>>        Set Label to "„¡«ç§à©ž ‰˜¨«â¢˜ª „ ›é¤"
39868>>>        Set Size to 250 292
39869>>>        Set Location to 2 11
39870>>>
39870>>>        //AB-DDOStart
39870>>>
39870>>>
39870>>>        //AB-DDOEnd
39870>>>
39870>>>        Object GroupSub1 is a GroupSub
39872>>>            Set Label to "„§ ¢¦šã ‰¨ «ž¨åà¤"
39873>>>            Set Size to 78 278
39874>>>            Set Location to 1 3
39875>>>            Object frapoapo is a FormSub
39877>>>
39877>>>                //AB-StoreTopStart
39877>>>                                                                                                                                                                                                                                                
39877>>>                //AB-StoreTopEnd
39877>>>
39877>>>                Set Size to 13 58
39878>>>                Set Location to 10 94
39879>>>                Set Label_Col_Offset to 2
39880>>>                Set Label_Justification_Mode to jMode_Right
39881>>>                Set Prompt_Button_Mode to pb_PromptOn
39882>>>
39882>>>                //AB-StoreStart
39882>>>                Set Prompt_Object to (wax(Current_object))
39883>>>                Procedure Prompt_Callback integer hPrompt
39885>>>                    set Export_Column of hPrompt to 0
39886>>>                    Set Initial_Column of hPrompt to 0
39887>>>                
39887>>>                end_procedure
39888>>>                
39888>>>                procedure onchange
39890>>>                    string wrecr
39891>>>                    get value of (frapoapo(self)) to wrecr
39892>>>                    move wrecr to wax.wax_recr
39893>>>                    find eq wax by index.2
39894>>>>
39894>>>                    if (found);                        set value of (formsub4(self)) to wax.wax_descr
39897>>>                    else;                        set value of (formsub4(self)) to ''
39899>>>                end_procedure
39900>>>                
39900>>>                procedure prompt
39902>>>                    set pswapokat of (wax(self)) to ''
39903>>>                    forward send prompt
39905>>>                end_procedure
39906>>>                
39906>>>                
39906>>>                
39906>>>                
39906>>>                
39906>>>                
39906>>>                
39906>>>                
39906>>>                
39906>>>                
39906>>>                
39906>>>                
39906>>>                //AB-StoreEnd
39906>>>
39906>>>            End_Object    // frapoapo
39907>>>
39907>>>            Object Frkathapo is a FormSub
39909>>>                Set Size to 13 58
39910>>>                Set Location to 26 94
39911>>>                Set Label_Col_Offset to 2
39912>>>                Set Prompt_Button_Mode to pb_PromptOn
39913>>>
39913>>>                //AB-StoreStart
39913>>>                Set Prompt_Object to (sl024(Current_object))
39914>>>                Procedure Prompt_Callback integer hPrompt
39916>>>                    set Export_Column of hPrompt to 0
39917>>>                    Set Initial_Column of hPrompt to 0
39918>>>                
39918>>>                end_procedure
39919>>>                
39919>>>                procedure onchange
39921>>>                    string scode
39922>>>                    get value of (frkathapo(self)) to scode
39923>>>                    move scode to witemkat.witemkat_code
39924>>>                    find eq witemkat by index.1
39925>>>>
39925>>>                    if (found)set value of (formsub9(self)) to witemkat.witemkat_descr
39928>>>                    else      set value of (formsub9(self)) to ''
39930>>>                end_procedure
39931>>>                //AB-StoreEnd
39931>>>
39931>>>            End_Object    // Frkathapo
39932>>>
39932>>>            Object FormSub4 is a FormSub
39934>>>                Set Size to 13 120
39935>>>                Set Location to 10 155
39936>>>                Set Label_Col_Offset to 2
39937>>>
39937>>>                //AB-StoreStart
39937>>>                set enabled_state to false
39938>>>                //AB-StoreEnd
39938>>>
39938>>>            End_Object    // FormSub4
39939>>>
39939>>>            Object TextBoxSub11 is a TextBoxSub
39941>>>                Set Label to "€§¦Ÿã¡ž"
39942>>>                Set Auto_Size_State to FALSE
39943>>>                Set FontSize to 4 0
39944>>>                Set Location to 11 5
39945>>>                Set Size to 10 53
39946>>>                Set Enabled_State to TRUE
39947>>>            End_Object    // TextBoxSub11
39948>>>
39948>>>            Object TextBoxSub13 is a TextBoxSub
39950>>>                Set Label to "€§æ „å›¦ª"
39951>>>                Set Auto_Size_State to FALSE
39952>>>                Set FontSize to 4 0
39953>>>                Set Location to 48 5
39954>>>                Set Size to 10 85
39955>>>                Set Enabled_State to TRUE
39956>>>            End_Object    // TextBoxSub13
39957>>>
39957>>>            Object TextBoxSub14 is a TextBoxSub
39959>>>                Set Label to "„éª „å›¦ª"
39960>>>                Set Auto_Size_State to FALSE
39961>>>                Set FontSize to 4 0
39962>>>                Set Location to 62 5
39963>>>                Set Size to 13 85
39964>>>                Set Enabled_State to TRUE
39965>>>            End_Object    // TextBoxSub14
39966>>>
39966>>>            Object fritemapo is a FormSub
39968>>>
39968>>>                //AB-StoreTopStart
39968>>>                                                                                                                                                                                                                                                
39968>>>                //AB-StoreTopEnd
39968>>>
39968>>>                Set Size to 13 59
39969>>>                Set Location to 46 93
39970>>>                Set Label_Col_Offset to 2
39971>>>                Set Label_Justification_Mode to jMode_Right
39972>>>                Set Prompt_Button_Mode to pb_PromptOn
39973>>>
39973>>>                //AB-StoreStart
39973>>>                Set Prompt_Object to (sl17(current_object))
39974>>>                Procedure Prompt_Callback integer hPrompt
39976>>>                    set Export_Column of hPrompt to 0
39977>>>                    Set Initial_Column of hPrompt to 0
39978>>>                
39978>>>                end_procedure
39979>>>                
39979>>>                procedure onchange
39981>>>                    string witem sdescr
39982>>>                    get value item 0 to witem
39983>>>                    move (fsitem(self,witem)) to sdescr
ERROR: 54 Invalid symbol in expression FSITEM ON LINE: 320 (39983) OF FILE: C:\Vdf6\Develop\Empor\AppSrc\R17_2.RV
39984>>>                    set value of (formsub6(self)) to sdescr
39985>>>                end_procedure
39986>>>                
39986>>>                
39986>>>                
39986>>>                
39986>>>                
39986>>>                
39986>>>                
39986>>>                
39986>>>                
39986>>>                
39986>>>                
39986>>>                
39986>>>                //AB-StoreEnd
39986>>>
39986>>>            End_Object    // fritemapo
39987>>>
39987>>>            Object fritemeos is a FormSub
39989>>>
39989>>>                //AB-StoreTopStart
39989>>>                                                                                                                                                                                                                                                
39989>>>                //AB-StoreTopEnd
39989>>>
39989>>>                Set Size to 13 59
39990>>>                Set Location to 62 93
39991>>>                Set Label_Col_Offset to 2
39992>>>                Set Label_Justification_Mode to jMode_Right
39993>>>                Set Prompt_Button_Mode to pb_PromptOn
39994>>>
39994>>>                //AB-StoreStart
39994>>>                Set Prompt_Object to (sl17(current_object))
39995>>>                Procedure Prompt_Callback integer hPrompt
39997>>>                    set Export_Column of hPrompt to 0
39998>>>                    Set Initial_Column of hPrompt to 0
39999>>>                
39999>>>                end_procedure
40000>>>                
40000>>>                procedure onchange
40002>>>                    string witem sdescr
40003>>>                    get value item 0 to witem
40004>>>                    move (fsitem(self,witem)) to sdescr
ERROR: 54 Invalid symbol in expression FSITEM ON LINE: 362 (40004) OF FILE: C:\Vdf6\Develop\Empor\AppSrc\R17_2.RV
40005>>>                    set value of (formsub7(self)) to sdescr
40006>>>                end_procedure
40007>>>                
40007>>>                
40007>>>                
40007>>>                
40007>>>                
40007>>>                
40007>>>                
40007>>>                
40007>>>                
40007>>>                //AB-StoreEnd
40007>>>
40007>>>            End_Object    // fritemeos
40008>>>
40008>>>            Object LineControlSub2 is a LineControlSub
40010>>>                Set Line_Style to lnSINGLE
40011>>>                Set Size to 2 276
40012>>>                Set Location to 43 1
40013>>>            End_Object    // LineControlSub2
40014>>>
40014>>>            Object FormSub6 is a FormSub
40016>>>                Set Size to 13 119
40017>>>                Set Location to 47 155
40018>>>                Set Label_Col_Offset to 2
40019>>>
40019>>>                //AB-StoreStart
40019>>>                set enabled_state to false
40020>>>                //AB-StoreEnd
40020>>>
40020>>>            End_Object    // FormSub6
40021>>>
40021>>>            Object FormSub7 is a FormSub
40023>>>                Set Size to 13 119
40024>>>                Set Location to 62 155
40025>>>                Set Label_Col_Offset to 2
40026>>>
40026>>>                //AB-StoreStart
40026>>>                set enabled_state to false
40027>>>                //AB-StoreEnd
40027>>>
40027>>>            End_Object    // FormSub7
40028>>>
40028>>>            Object TextBoxSub15 is a TextBoxSub
40030>>>                Set Label to "‰˜«žš¦¨å˜ „å›¦¬ª"
40031>>>                Set Auto_Size_State to FALSE
40032>>>                Set FontSize to 4 0
40033>>>                Set Location to 26 5
40034>>>                Set Size to 10 63
40035>>>                Set Enabled_State to TRUE
40036>>>            End_Object    // TextBoxSub15
40037>>>
40037>>>            Object FormSub9 is a FormSub
40039>>>                Set Size to 13 120
40040>>>                Set Location to 26 155
40041>>>                Set Label_Col_Offset to 2
40042>>>
40042>>>                //AB-StoreStart
40042>>>                set enabled_state to false
40043>>>                //AB-StoreEnd
40043>>>
40043>>>            End_Object    // FormSub9
40044>>>
40044>>>        End_Object    // GroupSub1
40045>>>
40045>>>        Object GroupSub2 is a GroupSub
40047>>>            Set Label to "„§ ¢¦šã †£œ¨¦£ž¤å˜ª ‰ ¤ã©œà¤"
40048>>>            Set Size to 28 280
40049>>>            Set Location to 80 1
40050>>>            Object FormSub1 is a FormSub
40052>>>
40052>>>                //AB-StoreTopStart
40052>>>                                                                                                                                                                                                                                                
40052>>>                //AB-StoreTopEnd
40052>>>
40052>>>                Set Size to 13 65
40053>>>                Set Location to 10 60
40054>>>                Set Label_Col_Offset to 2
40055>>>                Set Label_Justification_Mode to jMode_Right
40056>>>                Set Prompt_Button_Mode to pb_PromptOn
40057>>>
40057>>>                //AB-StoreStart
40057>>>                set Form_Datatype item 0 to mask_date_window
40058>>>                set prompt_object to (ocalendar(self))
40059>>>                
40059>>>                
40059>>>                //AB-StoreEnd
40059>>>
40059>>>            End_Object    // FormSub1
40060>>>
40060>>>            Object FormSub2 is a FormSub
40062>>>
40062>>>                //AB-StoreTopStart
40062>>>                                                                                                                                                                                                                                                
40062>>>                //AB-StoreTopEnd
40062>>>
40062>>>                Set Size to 13 68
40063>>>                Set Location to 10 200
40064>>>                Set Label_Col_Offset to 2
40065>>>                Set Label_Justification_Mode to jMode_Right
40066>>>                Set Prompt_Button_Mode to pb_PromptOn
40067>>>
40067>>>                //AB-StoreStart
40067>>>                set Form_Datatype item 0 to mask_date_window
40068>>>                set prompt_object to (ocalendar(self))
40069>>>                
40069>>>                
40069>>>                //AB-StoreEnd
40069>>>
40069>>>            End_Object    // FormSub2
40070>>>
40070>>>            Object TextBoxSub3 is a TextBoxSub
40072>>>                Set Label to "€§æ †£/¤å˜ :"
40073>>>                Set Auto_Size_State to FALSE
40074>>>                Set FontSize to 4 0
40075>>>                Set Location to 11 6
40076>>>                Set Size to 10 40
40077>>>                Set Enabled_State to TRUE
40078>>>            End_Object    // TextBoxSub3
40079>>>
40079>>>            Object TextBoxSub4 is a TextBoxSub
40081>>>                Set Label to "„àª †£¤å˜  :"
40082>>>                Set Auto_Size_State to FALSE
40083>>>                Set FontSize to 4 0
40084>>>                Set Location to 11 149
40085>>>                Set Size to 10 47
40086>>>                Set Enabled_State to TRUE
40087>>>            End_Object    // TextBoxSub4
40088>>>
40088>>>        End_Object    // GroupSub2
40089>>>
40089>>>        Object RadioGroupSub5 is a RadioGroupSub
40091>>>            Set Size to 25 127
40092>>>            Set Location to 148 0
40093>>>            Object Radio5 is a RadioSub
40095>>>                Set Size to 10 26
40096>>>                Set Location to 10 5
40097>>>
40097>>>                //AB-StoreStart
40097>>>                set label to syscurxr.c_code0
40098>>>                //AB-StoreEnd
40098>>>
40098>>>            End_Object    // Radio5
40099>>>
40099>>>            Object Radio6 is a RadioSub
40101>>>                Set Size to 10 32
40102>>>                Set Location to 10 44
40103>>>
40103>>>                //AB-StoreStart
40103>>>                set label to syscurxr.c_code00
40104>>>                //AB-StoreEnd
40104>>>
40104>>>            End_Object    // Radio6
40105>>>
40105>>>            Object Radio7 is a RadioSub
40107>>>                Set Size to 10 32
40108>>>                Set Location to 10 87
40109>>>
40109>>>                //AB-StoreStart
40109>>>                set label to syscurxr.c_coder
40110>>>                //AB-StoreEnd
40110>>>
40110>>>            End_Object    // Radio7
40111>>>
40111>>>
40111>>>            //AB-StoreStart
40111>>>                                                                                                                                                                            
40111>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
40113>>>                Forward Send Notify_Select_State  itoitem  ifromitem
40115>>>                If itoItem Eq 0 ;                    Set piepil to 1
40118>>>                Else If itoitem Eq 1;                    Set piepil to 2
40122>>>                Else If itoItem Eq 2 ;                    Set piepil to 3
40126>>>                //for augmentation
40126>>>            End_Procedure
40127>>>            
40127>>>            
40127>>>            
40127>>>            
40127>>>            
40127>>>            
40127>>>            
40127>>>            
40127>>>            
40127>>>            
40127>>>            
40127>>>            
40127>>>            
40127>>>            
40127>>>            //AB-StoreEnd
40127>>>
40127>>>        End_Object    // RadioGroupSub5
40128>>>
40128>>>        Object RadioGroupSub4 is a RadioGroupSub
40130>>>
40130>>>            //AB-StoreTopStart
40130>>>                                                                                                                                                                            
40130>>>            //AB-StoreTopEnd
40130>>>
40130>>>            Set Label to "„¡«ç&§à©ž"
40131>>>            Set Size to 42 78
40132>>>            Set Location to 188 1
40133>>>            Object RadioSub3 is a RadioSub
40135>>>                Set Size to 10 13
40136>>>                Set Location to 12 63
40137>>>            End_Object    // RadioSub3
40138>>>
40138>>>            Object RadioSub4 is a RadioSub
40140>>>                Set Size to 10 13
40141>>>                Set Location to 28 63
40142>>>            End_Object    // RadioSub4
40143>>>
40143>>>            Object TextBoxSub9 is a TextBoxSub
40145>>>                Set Label to "ŽŸæ¤ž :"
40146>>>                Set Auto_Size_State to FALSE
40147>>>                Set FontSize to 4 0
40148>>>                Set Location to 10 5
40149>>>                Set Size to 12 45
40150>>>                Set Enabled_State to TRUE
40151>>>            End_Object    // TextBoxSub9
40152>>>
40152>>>            Object TextBoxSub10 is a TextBoxSub
40154>>>                Set Label to "„¡«¬§à«ãª : "
40155>>>                Set Auto_Size_State to FALSE
40156>>>                Set FontSize to 4 0
40157>>>                Set Location to 24 5
40158>>>                Set Size to 12 45
40159>>>                Set Enabled_State to TRUE
40160>>>            End_Object    // TextBoxSub10
40161>>>
40161>>>
40161>>>            //AB-StoreStart
40161>>>            Procedure Notify_Select_State  Integer iNewItem  Integer iOldItem
40163>>>                Forward Send Notify_Select_State  iNewItem  iOldItem
40165>>>                If iNewItem EQ 0 Set Output_Device_Mode  To PRINT_TO_WINDOW
40168>>>                Else             Set Output_Device_Mode  To PRINT_TO_PRINTER
40170>>>            End_Procedure
40171>>>            //AB-StoreEnd
40171>>>
40171>>>        End_Object    // RadioGroupSub4
40172>>>
40172>>>        Object LineControlSub1 is a LineControlSub
40174>>>            Set Line_Style to lnSINGLE
40175>>>            Set Size to 2 288
40176>>>            Set Location to 114 0
40177>>>        End_Object    // LineControlSub1
40178>>>
40178>>>        Object ButtonSub1 is a ButtonSub
40180>>>
40180>>>            //AB-StoreTopStart
40180>>>                                                                                                                                                                            
40180>>>            //AB-StoreTopEnd
40180>>>
40180>>>            Set Label to "„¥¦›¦ª "
40181>>>            Set Size to 18 53
40182>>>            Set Location to 212 81
40183>>>
40183>>>            //AB-StoreStart
40183>>>            Procedure OnClick
40185>>>                Send Request_Cancel
40186>>>            End_Procedure
40187>>>            //AB-StoreEnd
40187>>>
40187>>>        End_Object    // ButtonSub1
40188>>>
40188>>>        Object ButtonSub2 is a ButtonSub
40190>>>
40190>>>            //AB-StoreTopStart
40190>>>                                                
40190>>>            //AB-StoreTopEnd
40190>>>
40190>>>            Set Label to "„¡«â¢œ©ž"
40191>>>            Set Size to 18 53
40192>>>            Set Location to 192 81
40193>>>
40193>>>            //AB-StoreStart
40193>>>            Procedure OnClick
INCLUDING FILE: RVIR17_2B.PKG
/HEADERR17_1
Image 2, HEADERR17_1
!
                                                                                                                                       ‘œ¢å›˜:  ___
„«˜ ¨å˜: ________________________                                   “§¦¡˜«á©«ž£˜: _________________________                            •¨ã©ž :  __________
                                                                                  ‰€’„Š„‘ „ˆƒ—Œ
                                                                                  ______________________________                 Œæ£ ©£˜ Report ____
                                                                    †£œ¨¦£.„¡«ç§à©žª: __/__/____
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
„§ ¢¦šã †£œ¨¦£ž¤å˜ª - €§æ [__/__/____]  „àª [__/__/____]
/SubHeaderR17_1
Image 3, SUBHEADERR17_1
€§¦Ÿã¡ž: __________________  __________________________________________   ‰˜«žš¦¨å˜ : __________________________________________   _____________________________________________________________________
/SubHeaderR17_2
Image 4, SUBHEADERR17_2
„å›¦ª  : __________________  __________________________________________
†£œ¨/¤å˜  ˜¨˜©«˜« ¡æ        ”¦¨â˜ª       „§à¤¬£å˜                 ’ £ã ‹¦¤á›. ‰˜Ÿ˜¨ã ’ £ã   „ ©˜šàšâª   €¥å˜ „ ©˜šàšé¤   „¥˜šàšâª    €¥å˜ „¥˜šàšé¤
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
/BodyR17_1
Image 5, BODYR17_1
__/__/__  __________________ ____________ _______________________ _ __,___.__  ___,___.__ _ _,___,___._ ___,___,___.__  _,___,___._  ___,___,___.__
/subtotalr17_2
Image 6, SUBTOTALR17_2
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                                  ‘ç¤¦¢˜  „å›¦¬ª :                  __,___.__  ___,___.__ _ _,___,___._ ___,___,___.__  _,___,___._  ___,___,___.__
/subtotalr17_1
Image 7, SUBTOTALR17_1
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                                ‘ç¤¦¢˜  €§¦Ÿã¡žª :                  __,___.__  ___,___.__ _ _,___,___._ ___,___,___.__  _,___,___._  ___,___,___.__
/TotalR17_1
Image 8, TOTALR17_1
========================================================================================================================================================================================================
                                  ‚œ¤ ¡á ‘ç¤¦¢˜  :                  __,___.__  ___,___.__ _ _,___,___._ ___,___,___.__  _,___,___._  ___,___,___.__
========================================================================================================================================================================================================
/FooterR17_1
Image 9, FOOTERR17_1
/*
40195>>>>
40195>>>                integer listatus ihmgio
40196>>>                string dateapo dateeos msgstr apo
40196>>>                move 0 to listatus
40197>>>                Get value of (formsub1(GroupSub2(Self)))    item 0 to dateapo
40198>>>                Get value of (formsub2(GroupSub2(Self)))    item 0 to dateeos
40199>>>                Get value of (formsub10(GroupSub3(Self)))   item 0 to ihmgio
40200>>>                if (ihmgio = 0) begin
40202>>>                      move "" to msgstr
40203>>>                      move 1 to listatus
40204>>>                      move "‘­á¢£˜ !! ƒâ¤ „§ ¢â¥˜«œ †£œ¨¦¢æš ¦ !!" to msgstr
40205>>>                      error 999 msgstr
40206>>>>
40206>>>                end
40206>>>>
40206>>>                if (dateapo ne "") begin
40208>>>                   if ((dateapo < syscurxr.year_xrhshfrom) or (dateapo > syscurxr.year_xrhshto)) begin
40210>>>                      move "" to msgstr
40211>>>                      move 1 to listatus
40212>>>                      move "†£/¤åœª „§ ¢¦šãª „¡«æª Ž¨åà¤ •¨ã©žª" to msgstr
40213>>>                      error 999 msgstr
40214>>>>
40214>>>                   end
40214>>>>
40214>>>                end
40214>>>>
40214>>>            
40214>>>                if (dateeos ne "") begin
40216>>>                   if ((dateeos < syscurxr.year_xrhshfrom) or (dateeos > syscurxr.year_xrhshto)) begin
40218>>>                      move "" to msgstr
40219>>>                      move 1 to listatus
40220>>>                      move "†£/¤åœª „§ ¢¦šãª „¡«æª Ž¨åà¤ •¨ã©žª" to msgstr
40221>>>                      error 999 msgstr
40222>>>>
40222>>>                   end
40222>>>>
40222>>>                end
40222>>>>
40222>>>                if (listatus=0) begin
40224>>>                     Send startreport
40225>>>                end
40225>>>>
40225>>>            
40225>>>            End_Procedure
40226>>>            
40226>>>            
40226>>>            
40226>>>            
40226>>>            
40226>>>            
40226>>>            
40226>>>            
40226>>>            
40226>>>            
40226>>>            
40226>>>            
40226>>>            
40226>>>            
40226>>>            
40226>>>            
40226>>>            
40226>>>            
40226>>>            
40226>>>            
40226>>>            
40226>>>            
40226>>>            
40226>>>            
40226>>>            
40226>>>            
40226>>>            
40226>>>            
40226>>>            
40226>>>            //AB-StoreEnd
40226>>>
40226>>>        End_Object    // ButtonSub2
40227>>>
40227>>>        Object GroupSub3 is a GroupSub
40229>>>            Set Label to "„§ ¢¦šã †£œ¨¦¢¦šå¦¬"
40230>>>            Set Size to 29 279
40231>>>            Set Location to 115 1
40232>>>            Object FormSub10 is a FormSub
40234>>>                Set Size to 13 47
40235>>>                Set Location to 9 93
40236>>>                Set Label_Col_Offset to 2
40237>>>                Set Prompt_Button_Mode to pb_PromptOn
40238>>>
40238>>>                //AB-StoreStart
40238>>>                Set Prompt_Object to (hmgiow(Current_object))
40239>>>                Set Numeric_Mask Item 0 to 2 0 '*, '
40240>>>                Procedure Prompt
40242>>>                    Forward Send prompt
40244>>>                End_procedure
40245>>>                
40245>>>                Procedure Prompt_Callback integer hPrompt
40247>>>                    set Export_Column of hPrompt    to    0
40248>>>                    Set Initial_Column of hPrompt   to    0
40249>>>                end_procedure
40250>>>                
40250>>>                procedure onchange
40252>>>                    string whmgio
40253>>>                    get value item 0 to whmgio
40254>>>                    move whmgio to hmgiow.hmgiow_code
40255>>>                    find eq hmgiow by index.1
40256>>>>
40256>>>                    if (found);                        set value of (formsub11(self)) to hmgiow.hmgiow_descr
40259>>>                    else;                        set value of (formsub11(self)) to ''
40261>>>                end_procedure
40262>>>                
40262>>>                
40262>>>                
40262>>>                
40262>>>                
40262>>>                
40262>>>                
40262>>>                
40262>>>                
40262>>>                
40262>>>                
40262>>>                //AB-StoreEnd
40262>>>
40262>>>            End_Object    // FormSub10
40263>>>
40263>>>            Object FormSub11 is a FormSub
40265>>>                Set Size to 13 133
40266>>>                Set Location to 9 143
40267>>>                Set Label_Col_Offset to 2
40268>>>
40268>>>                //AB-StoreStart
40268>>>                set enabled_state to false
40269>>>                //AB-StoreEnd
40269>>>
40269>>>            End_Object    // FormSub11
40270>>>
40270>>>        End_Object    // GroupSub3
40271>>>
40271>>>
40271>>>        //AB-StoreStart
40271>>>        
40271>>>        
40271>>>        Procedure Activate_View Returns Integer
40273>>>            Integer rVal
40274>>>            String sModule
40274>>>            set value of (formsub1(groupsub2(current_object))) to syscurxr.year_xrhshfrom
40275>>>            set value of (formsub2(groupsub2(current_object))) to syscurxr.year_xrhshto
40276>>>            Forward Get Msg_Activate_View to rVal
40278>>>            Procedure_Return rVal
40279>>>        End_procedure
40280>>>        
40280>>>        
40280>>>        Procedure StartReport
40282>>>            Integer iOutputDevice
40283>>>            String  FileName datefrom dateto itemfrom itemto waxfrom witemkatfrom
40283>>>            integer iepil iHmgio
40283>>>        
40283>>>            Get Output_Device_Mode To iOutputDevice
40284>>>            If iOutputDevice EQ PRINT_TO_WINDOW Begin
40286>>>               Make_Temp_File "TXT" FileName
40287>>>               Move ("c:\" - FileName)  To FileName
40288>>>               Set Output_Device_Name  To FileName
40289>>>            End
40289>>>>
40289>>>            Else ;            Set Output_Device_Name  To "Lpt1:"
40291>>>        
40291>>>           // Collection Of selection Criteria from VIEW
40291>>>           Get value of (fritemapo(GroupSub1(Self)))     item 0 to itemfrom
40292>>>           Get value of (fritemeos(GroupSub1(Self)))     item 0 to itemto
40293>>>           Get value of (frapoapo(GroupSub1(Self)))      item 0 to waxfrom
40294>>>           Get value of (FormSub1(GroupSub2(Self)))      item 0 to Datefrom
40295>>>           Get value of (FormSub2(GroupSub2(Self)))      item 0 to dateto
40296>>>           Get value of (frkathapo(GroupSub1(Self)))     item 0 to witemkatfrom
40297>>>           Get value of (FormSub10(GroupSub3(Self)))     item 0 to iHmgio //HMGIO
40298>>>           set psitemfrom          to itemfrom
40299>>>           set psitemto            to itemto
40300>>>           set pswaxfrom           to waxfrom
40301>>>           set pswitemkatfrom      to witemkatfrom
40302>>>           get piepil              to iepil
40303>>>           set pihmgio             to iHmgio
40304>>>           set psdatefrom          to datefrom
40305>>>           set psdateto            to dateto
40306>>>        //   ------------------------------------------------------------------------------
40306>>>        
40306>>>           Send Run_Report
40307>>>           If iOutputDevice EQ PRINT_TO_WINDOW Begin
40309>>>           //    RunProgram background "c:\mew9\mew32.exe" FileName
40309>>>               RunProgram background "notepad" FileName
40310>>>               EraseFile FileName
40311>>>>
40311>>>            End
40311>>>>
40311>>>        End_Procedure
40312>>>        
40312>>>        
40312>>>        Object karteles_BasicReport is a BasicReport
40314>>>        
40314>>>           Set Report_Title to "‰˜¨«â¢œª „ ›é¤                   "
40315>>>        
40315>>>           Object Wtypkin_DD is a Wtypkin_DataDictionary
40317>>>           End_Object    // Wtypkin_DD
40318>>>        
40318>>>           Object Hmgiow_DD is a Hmgiow_DataDictionary
40320>>>           End_Object    // Hmgiow_DD
40321>>>        
40321>>>           Object Hmwtyp_DD is a Hmwtyp_DataDictionary
40323>>>               Set DDO_Server to (wtypkin_DD(Self))
40324>>>               Set DDO_Server to (Hmgiow_DD(Self))
40325>>>               Begin_Constraints
40327>>>                   Integer iHmgio
40328>>>                   get piHmgio    to iHmgio
40329>>>                   if iHmgio ne 0 Constrain Hmwtyp.Hmgiow_code eq iHmgio
40333>>>                End_Constraints
40336>>>            End_Object    // HmCtyp_DD
40337>>>        
40337>>>        
40337>>>        
40337>>>           object wcmoves_dd is A wcmoves_datadictionary
ERROR: 4345 Type check error U_WCMOVES_DATADICTIONARY, U_WCMOVES_DATADICTIONARY,  ON LINE: 847 (40337) OF FILE: C:\Vdf6\Develop\Empor\AppSrc\R17_2.RV
ERROR: 4328 Undefined symbol in argument U_WCMOVES_DATADICTIONARY ON LINE: 847 (40337) OF FILE: C:\Vdf6\Develop\Empor\AppSrc\R17_2.RV
40339>>>             Property String psRecr Public ''
40341>>>        
40341>>>            Function fiMasKanei Returns Integer
40343>>>                Integer rVal
40344>>>                showln (psrecr(self))
40346>>>                If Wcmoves.Wtypkin_Recr In (psRecr(Self)) Move 1 to rVal
40349>>>                Else Move 0 to rval
40351>>>                Function_Return rVal
40352>>>            End_Function
40353>>>        
40353>>>            begin_constraints
40355>>>               String  datefrom dateto itemfrom itemto waxfrom witemkatfrom
40356>>>               integer iepil
40356>>>               get psdatefrom     to datefrom
40357>>>               get psdateto       to dateto
40358>>>               if (datefrom='') move '01/01/1980' to datefrom
40361>>>               if (dateto='')   move '01/01/1980' to dateto
40364>>>               get psitemfrom     to itemfrom
40365>>>               get psitemto       to itemto
40366>>>               get pswaxfrom      to waxfrom
40367>>>               get pswitemkatfrom to witemkatfrom
40368>>>               Constrain wcmoves.company_code eq syscurxr.company_code
40370>>>               Constrain wcmoves.branch_code  eq syscurxr.branch_code
40372>>>               Constrain wcmoves.year_year    eq syscurxr.year_year
40374>>>               showln datefrom '-' dateto
40378>>>               if datefrom     ne "" Constrain wcmoves.wcmove_hmnia ge datefrom
40382>>>               if dateto       ne "" Constrain wcmoves.wcmove_hmnia le dateto
40386>>>               if waxfrom      ne "" Constrain wcmoves.wax_recr  eq waxfrom
40390>>>               if itemfrom     ne "" Constrain wcmoves.witemx_code ge itemfrom
40394>>>               if itemto       ne "" Constrain wcmoves.witemx_code le itemto
40398>>>               if witemkatfrom ne "" Constrain wcmoves.witemkat_code eq witemkatfrom
40402>>>               Constrain Wcmoves As (fiMasKanei(self)=1)
40403>>>             end_constraints
40406>>>            end_object
40407>>>            Report_Main_File wcmoves
40408>>>            report_breaks wcmoves.wax_recr wcmoves.witemx_code
40422>>>        
40422>>>        
40422>>>            Function Starting_Main_Report Returns Integer
40424>>>              Local Integer iRetVal
40425>>>              Local String sStr
40425>>>              Move '' to sStr
40426>>>              Forward Get Starting_Main_Report to iRetval
40428>>>              set page_end to 60
40429>>>              set page_feed  to 66
40430>>>              Send Rebuild_Constraints to Hmwtyp_DD
40431>>>        
40431>>>              Send Find to Hmwtyp_dd First_Record 1
40432>>>              While (Found)
40436>>>                    Append sStr Hmwtyp.wtypkin_recr ','
40438>>>                    Send Find to Hmwtyp_dd Next_Record 1
40439>>>              Loop
40440>>>>
40440>>>              Set psRecr of Wcmoves_DD to sStr
40441>>>              Send Rebuild_Constraints to wCmoves_DD
40442>>>              Send Find to (wcmoves_dd(self)) First_Record 12
40443>>>              Report_Index BY Index.12 // €§¦Ÿã¡ž + „å›¦ª + †£/¤å˜
40445>>>            End_Function
40446>>>        
40446>>>           Procedure_Section Page_Top as Headerr17_1
40451>>>              Local Integer iPage ihmgio iepil
40451>>>              string lsvalue
40451>>>              date ddate
40451>>>              sysdate4 ddate
40452>>>              get piepil to iepil
40453>>>              Get Page_Count to headerr17_1.1
40454>>>              move syscurxr.company_name to headerr17_1.2
40455>>>              move syscurxr.branch_name  to headerr17_1.3
40456>>>              move syscurxr.year_year    to headerr17_1.4
40457>>>              move (trim(hmgiow.hmgiow_descr)) to  headerr22_1.5
ERROR: 4345 Type check error HEADERR22_1.5, HEADERR22_1.5, HEA ON LINE: 916 (40457) OF FILE: C:\Vdf6\Develop\Empor\AppSrc\R17_2.RV
ERROR: 4328 Undefined symbol in argument HEADERR22_1.5 ON LINE: 916 (40457) OF FILE: C:\Vdf6\Develop\Empor\AppSrc\R17_2.RV
40458>>>              case Begin
40458>>>                    Case (iepil = 1)
40460>>>                      print syscurxr.c_code0 to headerr17_1.6
40461>>>                      Case Break
40462>>>                    Case (iepil = 2)
40465>>>                      print syscurxr.c_code00 to headerr17_1.6
40466>>>                      Case Break
40467>>>                    Case (iepil = 3)
40470>>>                      print syscurxr.c_coder to headerr17_1.6
40471>>>                     Case Break
40472>>>              Case End
40472>>>              move ddate          to headerr17_1.7
40473>>>              get psdatefrom      to headerr17_1.8
40474>>>              get psdateto        to headerr17_1.9
40475>>>              OutPut_PageCheck
40476>>>        
40476>>>        
40476>>>           End_Procedure
40477>>>        
40477>>>          Procedure_Section SubHeader1 as SubheaderR17_1
40482>>>              move wax.wax_code             to subheaderr17_1.1
40483>>>              move wax.wax_descr            to subheaderr17_1.2
40484>>>              if (pswitemkatfrom(self)<>'')begin
40486>>>                  move witemkat.witemkat_code   to subheaderr17_1.3
40487>>>                  move witemkat.witemkat_descr  to subheaderr17_1.4
40488>>>              end
40488>>>>
40488>>>              else blankform subheaderr17_1.3 thru subheaderr17_1.4
40490>>>              output_pagecheck
40491>>>           end_procedure
40492>>>        
40492>>>           Procedure_Section SubHeader2 as SubheaderR17_2
40497>>>              move witemx.witemx_code       to subheaderr17_2.1
40498>>>              move witemx.witemx_descr      to subheaderr17_2.2
40499>>>              output_pagecheck
40500>>>           end_procedure
40501>>>        
40501>>>           Procedure_Section  Body as BodyR17_1
40506>>>                Integer iHmgio iepil
40506>>>                number   ntotambd0 ndiscam0 nqtyeisa nqtyexa nx0 np0
40506>>>                get ktotambd0 to ntotambd0
40507>>>                get kdiscam0  to ndiscam0
40508>>>                get kqtyeisa  to nqtyeisa
40509>>>                get kqtyexa   to nqtyexa
40510>>>                get kx0       to nx0
40511>>>                get kp0       to np0
40512>>>                get piepil to iepil
40513>>>                print wcmoves.wcmove_hmnia to bodyr17_1.1
40514>>>                print wcmoves.wcmove_par to bodyr17_1.2
40515>>>                print wcmoves.client_id to bodyr17_1.3
40516>>>                if (wcmoves.client_id<>'') begin
40518>>>                   clear clients
40519>>>                   move wcmoves.client_recr to clients.client_recr
40520>>>                   find eq clients by index.2
40521>>>>
40521>>>                   if (found=1) move clients.client_name to bodyr17_1.4
40524>>>                end
40524>>>>
40524>>>                else blankform bodyr17_1.3 thru bodyr17_1.4
40526>>>                print wtypkin.wtypkin_descr to bodyr17_1.5
40527>>>                if (iepil=1) begin
40529>>>                   if ((wcmoves.wcmove_qty_eisa <> 0)or(wcmoves.wcmove_x0  <> 0)) begin
40531>>>                       print wcmoves.unit_price0 to bodyr17_1.6
40532>>>                       print wcmoves.wcmov_totambd0 to bodyr17_1.7
40533>>>                       print wcmoves.wcmov_discam0  to bodyr17_1.8
40534>>>                       print wcmoves.wcmove_qty to bodyr17_1.9
40535>>>                       print wcmoves.wcmove_x0 to bodyr17_1.10
40536>>>                       if (wcmoves.wcmove_qty_eisa=0) begin
40538>>>                          print wcmoves.sx_posothta_eis to bodyr17_1.9
40539>>>                          print wcmoves.unit_price0 to bodyr17_1.6
40540>>>                       end
40540>>>>
40540>>>                       if (wcmoves.wcmove_x0=0) begin
40542>>>                          print wcmoves.wcmo_totambd0 to bodyr17_1.7
40543>>>                          print wcmoves.wcmo_discam0  to bodyr17_1.8
40544>>>                          print wcmoves.wcmov_x0      to bodyr17_1.10
40545>>>                          print wcmoves.unit_pric0 to bodyr17_1.6
40546>>>                       end
40546>>>>
40546>>>                       add   wcmoves.wcmov_totambd0 to ntotambd0
40547>>>                       add   wcmoves.wcmov_discam0  to ndiscam0
40548>>>                       add   wcmoves.wcmove_qty     to nqtyeisa
40549>>>                       add   wcmoves.wcmove_x0      to nx0
40550>>>                       print 0 to bodyr17_1.11
40551>>>                       print 0 to bodyr17_1.12
40552>>>                   end
40552>>>>
40552>>>                   if ((wcmoves.wcmove_qty_exa <> 0)or (wcmoves.wcmove_p0 <> 0)) begin
40554>>>                       print wcmoves.unit_price0 to bodyr17_1.6
40555>>>                       print wcmoves.wcmov_totambd0 to bodyr17_1.7
40556>>>                       print wcmoves.wcmov_discam0  to bodyr17_1.8
40557>>>                       print 0 to bodyr17_1.9
40558>>>                       print 0 to bodyr17_1.10
40559>>>                       print wcmoves.wcmove_qty to bodyr17_1.11
40560>>>                       print wcmoves.wcmove_p0 to bodyr17_1.12
40561>>>        
40561>>>                       if (wcmoves.wcmove_qty_exa=0) begin
40563>>>                          print wcmoves.sx_posothta_ex to bodyr17_1.11
40564>>>                          print wcmoves.unit_price0 to bodyr17_1.6
40565>>>                       end
40565>>>>
40565>>>                       if (wcmoves.wcmove_p0=0) begin
40567>>>                          print wcmoves.wcmo_totambd0 to bodyr17_1.7
40568>>>                          print wcmoves.wcmo_discam0  to bodyr17_1.8
40569>>>                          print wcmoves.wcmov_p0      to bodyr17_1.12
40570>>>                          print wcmoves.unit_pric0 to bodyr17_1.6
40571>>>                       end
40571>>>>
40571>>>        
40571>>>                       add   wcmoves.wcmov_totambd0 to ntotambd0
40572>>>                       add   wcmoves.wcmov_discam0  to ndiscam0
40573>>>                       add   wcmoves.wcmove_qty     to nqtyexa
40574>>>                       add   wcmoves.wcmove_p0      to np0
40575>>>                   end
40575>>>>
40575>>>                   output_pagecheck
40576>>>                end
40576>>>>
40576>>>                if (iepil=2) begin
40578>>>                    if ((wcmoves.wcmove_qty_eisa <> 0) or (wcmoves.wcmove_x00 <>0)) begin
40580>>>                       print wcmoves.unit_price00 to bodyr17_1.6
40581>>>                       print wcmoves.wcmov_totambd00 to bodyr17_1.7
40582>>>                       print wcmoves.wcmov_discam00 to  bodyr17_1.8
40583>>>                       print wcmoves.wcmove_qty to bodyr17_1.9
40584>>>                       print wcmoves.wcmove_x00 to bodyr17_1.10
40585>>>                       print 0 to bodyr17_1.11
40586>>>                       print 0 to bodyr17_1.12
40587>>>        
40587>>>                       if (wcmoves.wcmove_qty_eisa=0) begin
40589>>>                          print wcmoves.sx_posothta_eis to bodyr17_1.9
40590>>>                          print wcmoves.unit_price0 to bodyr17_1.6
40591>>>                       end
40591>>>>
40591>>>                       if (wcmoves.wcmove_x00=0) begin
40593>>>                          print wcmoves.wcmo_totambd00 to bodyr17_1.7
40594>>>                          print wcmoves.wcmo_discam00  to bodyr17_1.8
40595>>>                          print wcmoves.wcmov_x00      to bodyr17_1.10
40596>>>                          print wcmoves.unit_pric0     to bodyr17_1.6
40597>>>                       end
40597>>>>
40597>>>        
40597>>>                       add   wcmoves.wcmov_totambd00 to ntotambd0
40598>>>                       add   wcmoves.wcmov_discam00  to ndiscam0
40599>>>                       add   wcmoves.wcmove_qty      to nqtyeisa
40600>>>                       add   wcmoves.wcmove_x00      to nx0
40601>>>                    end
40601>>>>
40601>>>                    if ((wcmoves.wcmove_qty_exa <> 0) or (wcmoves.wcmove_p00 <>0)) begin
40603>>>                       print wcmoves.unit_price00 to bodyr17_1.6
40604>>>                       print wcmoves.wcmov_totambd00 to bodyr17_1.7
40605>>>                       print wcmoves.wcmov_discam00 to bodyr17_1.8
40606>>>                       print 0 to bodyr17_1.9
40607>>>                       print 0 to bodyr17_1.10
40608>>>                       print wcmoves.wcmove_qty to bodyr17_1.11
40609>>>                       print wcmoves.wcmove_p00 to bodyr17_1.12
40610>>>                       if (wcmoves.wcmove_qty_exa=0) begin
40612>>>                          print wcmoves.sx_posothta_ex to bodyr17_1.11
40613>>>                          print wcmoves.unit_price00 to bodyr17_1.6
40614>>>                       end
40614>>>>
40614>>>                       if (wcmoves.wcmove_p00=0) begin
40616>>>                          print wcmoves.wcmo_totambd00 to bodyr17_1.7
40617>>>                          print wcmoves.wcmo_discam00  to bodyr17_1.8
40618>>>                          print wcmoves.wcmov_p00      to bodyr17_1.12
40619>>>                          print wcmoves.unit_pric00    to bodyr17_1.6
40620>>>                       end
40620>>>>
40620>>>                       add   wcmoves.wcmov_totambd00 to ntotambd0
40621>>>                       add   wcmoves.wcmov_discam00  to ndiscam0
40622>>>                       add   wcmoves.wcmove_qty      to nqtyexa
40623>>>                       add   wcmoves.wcmove_p00      to np0
40624>>>                    end
40624>>>>
40624>>>                    output_pagecheck
40625>>>                end
40625>>>>
40625>>>                if (iepil=3) begin
40627>>>                    if ((wcmoves.wcmove_qty_eisa <> 0) or (wcmoves.wcmove_x1 <>0)) begin
40629>>>                       print wcmoves.unit_pricer to bodyr17_1.6
40630>>>                       print wcmoves.wcmov_totambd1 to bodyr17_1.7
40631>>>                       print wcmoves.wcmov_discam1 to bodyr17_1.8
40632>>>                       print wcmoves.wcmove_qty to bodyr17_1.9
40633>>>                       print wcmoves.wcmove_x1 to bodyr17_1.10
40634>>>                       print 0 to bodyr17_1.11
40635>>>                       print 0 to bodyr17_1.12
40636>>>                       if (wcmoves.wcmove_qty_eisa=0) begin
40638>>>                          print wcmoves.sx_posothta_eis to bodyr17_1.9
40639>>>                          print wcmoves.unit_pricer to bodyr17_1.6
40640>>>                       end
40640>>>>
40640>>>                       if (wcmoves.wcmove_x1=0) begin
40642>>>                          print wcmoves.wcmo_totambd1 to bodyr17_1.7
40643>>>                          print wcmoves.wcmo_discam1  to bodyr17_1.8
40644>>>                          print wcmoves.wcmov_x1      to bodyr17_1.10
40645>>>                          print wcmoves.unit_pricr     to bodyr17_1.6
40646>>>                       end
40646>>>>
40646>>>        
40646>>>                       add   wcmoves.wcmov_totambd1  to ntotambd0
40647>>>                       add   wcmoves.wcmov_discam1   to ndiscam0
40648>>>                       add   wcmoves.wcmove_qty      to nqtyeisa
40649>>>                       add   wcmoves.wcmove_x1       to nx0
40650>>>                    end
40650>>>>
40650>>>                    if ((wcmoves.wcmove_qty_exa <> 0) or (wcmoves.wcmove_p1<>0)) begin
40652>>>                       print wcmoves.unit_pricer to bodyr17_1.6
40653>>>                       print wcmoves.wcmov_totambd1 to bodyr17_1.7
40654>>>                       print wcmoves.wcmov_discam1 to bodyr17_1.8
40655>>>                       print 0 to bodyr17_1.9
40656>>>                       print 0 to bodyr17_1.10
40657>>>                       print wcmoves.wcmove_qty to bodyr17_1.11
40658>>>                       print wcmoves.wcmove_p1 to bodyr17_1.12
40659>>>                       if (wcmoves.wcmove_qty_exa=0) begin
40661>>>                          print wcmoves.sx_posothta_ex to bodyr17_1.11
40662>>>                          print wcmoves.unit_pricer to bodyr17_1.6
40663>>>                       end
40663>>>>
40663>>>                       if (wcmoves.wcmove_p1=0) begin
40665>>>                          print wcmoves.wcmo_totambd1 to bodyr17_1.7
40666>>>                          print wcmoves.wcmo_discam1  to bodyr17_1.8
40667>>>                          print wcmoves.wcmov_p1      to bodyr17_1.12
40668>>>                          print wcmoves.unit_pricr    to bodyr17_1.6
40669>>>                       end
40669>>>>
40669>>>        
40669>>>                       add   wcmoves.wcmov_totambd1  to ntotambd0
40670>>>                       add   wcmoves.wcmov_discam1   to ndiscam0
40671>>>                       add   wcmoves.wcmove_qty      to nqtyexa
40672>>>                       add   wcmoves.wcmove_p1       to np0
40673>>>                    end
40673>>>>
40673>>>                    output_pagecheck
40674>>>                end
40674>>>>
40674>>>                set ktotambd0 to ntotambd0
40675>>>                set kdiscam0  to ndiscam0
40676>>>                set kqtyeisa  to nqtyeisa
40677>>>                set kqtyexa   to nqtyexa
40678>>>                set kx0       to nx0
40679>>>                set kp0       to np0
40680>>>           End_Procedure
40681>>>        
40681>>>          Procedure_Section  subtotal2 as subtotalr17_2
40686>>>               number   ntotambd0 ndiscam0  nqtyeisa nqtyexa nx0 np0
40686>>>               number   nhtotambd0 nhdiscam0  nhqtyeisa nhqtyexa nhx0 nhp0
40686>>>               get ktotambd0 to ntotambd0
40687>>>               get kdiscam0  to ndiscam0
40688>>>               get kqtyeisa  to nqtyeisa
40689>>>               get kqtyexa   to nqtyexa
40690>>>               get kx0       to nx0
40691>>>               get kp0       to np0
40692>>>        
40692>>>               get htotambd0 to nhtotambd0
40693>>>               get hdiscam0  to nhdiscam0
40694>>>               get hqtyeisa  to nhqtyeisa
40695>>>               get hqtyexa   to nhqtyexa
40696>>>               get hx0       to nhx0
40697>>>               get hp0       to nhp0
40698>>>               blankform subtotalr17_2.1
40699>>>>
40699>>>               print ntotambd0      to Subtotalr17_2.2
40700>>>               print ndiscam0       to Subtotalr17_2.3
40701>>>               print nqtyeisa       to Subtotalr17_2.4
40702>>>               print nx0            to Subtotalr17_2.5
40703>>>               print nqtyexa        to Subtotalr17_2.6
40704>>>               print np0            to Subtotalr17_2.7
40705>>>        
40705>>>               add ntotambd0        to nhtotambd0
40706>>>               add ndiscam0         to nhdiscam0
40707>>>               add nqtyeisa         to nhqtyeisa
40708>>>               add nx0              to nhx0
40709>>>               add nqtyexa          to nhqtyexa
40710>>>               add np0              to nhp0
40711>>>        
40711>>>               set htotambd0 to nhtotambd0
40712>>>               set hdiscam0  to nhdiscam0
40713>>>               set hqtyeisa  to nhqtyeisa
40714>>>               set hqtyexa   to nhqtyexa
40715>>>               set hx0       to nhx0
40716>>>               set hp0       to nhp0
40717>>>        
40717>>>               set ktotambd0 to 0
40718>>>               set kdiscam0  to 0
40719>>>               set kqtyeisa  to 0
40720>>>               set kqtyexa   to 0
40721>>>               set kx0       to 0
40722>>>               set kp0       to 0
40723>>>               output_pagecheck
40724>>>        
40724>>>          end_procedure
40725>>>        
40725>>>           Procedure_Section  subtotal1 as subtotalr17_1
40730>>>                number   ntotambd0 ndiscam0  nqtyeisa nqtyexa nx0 np0
40730>>>                number   nhtotambd0 nhdiscam0 nhqtyeisa nhqtyexa nhx0 nhp0
40730>>>                get htotambd0 to ntotambd0
40731>>>                get hdiscam0  to ndiscam0
40732>>>                get hqtyeisa  to nqtyeisa
40733>>>                get hqtyexa   to nqtyexa
40734>>>                get hx0       to nx0
40735>>>                get hp0       to np0
40736>>>        
40736>>>                get ttotambd0 to nhtotambd0
40737>>>                get tdiscam0  to nhdiscam0
40738>>>                get tqtyeisa  to nhqtyeisa
40739>>>                get tqtyexa   to nhqtyexa
40740>>>                get tx0       to nhx0
40741>>>                get tp0       to nhp0
40742>>>        
40742>>>                blankform              subtotalr17_1.1
40743>>>>
40743>>>                print ntotambd0        to subtotalr17_1.2
40744>>>                print ndiscam0         to subtotalr17_1.3
40745>>>                print nqtyeisa         to subtotalr17_1.4
40746>>>                print nx0              to subtotalr17_1.5
40747>>>                print nqtyexa          to subtotalr17_1.6
40748>>>                print np0              to subtotalr17_1.7
40749>>>        
40749>>>                add ntotambd0        to nhtotambd0
40750>>>                add ndiscam0         to nhdiscam0
40751>>>                add nqtyeisa         to nhqtyeisa
40752>>>                add nx0              to nhx0
40753>>>                add nqtyexa          to nhqtyexa
40754>>>                add np0              to nhp0
40755>>>        
40755>>>                set ttotambd0 to nhtotambd0
40756>>>                set tdiscam0  to nhdiscam0
40757>>>                set tqtyeisa  to nhqtyeisa
40758>>>                set tqtyexa   to nhqtyexa
40759>>>                set tx0       to nhx0
40760>>>                set tp0       to nhp0
40761>>>        
40761>>>                set htotambd0 to 0
40762>>>                set hdiscam0  to 0
40763>>>                set hqtyeisa  to 0
40764>>>                set hqtyexa   to 0
40765>>>                set hx0       to 0
40766>>>                set hp0       to 0
40767>>>                output_pagecheck
40768>>>        
40768>>>           end_Procedure
40769>>>        
40769>>>           Procedure_Section  total as totalr17_1
40774>>>                number   ntotambd0 ndiscam0 nqtyeisa nqtyexa nx0 np0
40774>>>                get ttotambd0 to ntotambd0
40775>>>                get tdiscam0  to ndiscam0
40776>>>                get tqtyeisa  to nqtyeisa
40777>>>                get tqtyexa   to nqtyexa
40778>>>                get tx0       to nx0
40779>>>                get tp0       to np0
40780>>>        
40780>>>                blankform           totalr17_1.1
40781>>>>
40781>>>                print ntotambd0  to totalr17_1.2
40782>>>                print ndiscam0   to totalr17_1.3
40783>>>                print nqtyeisa   to totalr17_1.4
40784>>>                print nx0        to totalr17_1.5
40785>>>                print nqtyexa    to totalr17_1.6
40786>>>                print np0        to totalr17_1.7
40787>>>        
40787>>>                set ttotambd0 to 0
40788>>>                set tdiscam0  to 0
40789>>>                set tqtyeisa  to 0
40790>>>                set tqtyexa   to 0
40791>>>                set tx0       to 0
40792>>>                set tp0       to 0
40793>>>           //     send proc_normalp
40793>>>                print 'E'
40794>>>                output_pagecheck
40795>>>        
40795>>>           end_Procedure
40796>>>        
40796>>>           Procedure_Section Page_Bottom as Footerr17_1
40805>>>              output_pagecheck
40806>>>           End_Procedure
40807>>>        
40807>>>        
40807>>>           Procedure Ending_Report
40809>>>              blankform bodyr17_1.1 thru bodyr17_1.12
40810>>>>
40810>>>              blankform subtotalr17_2.1 thru subtotalr17_2.7
40811>>>>
40811>>>              blankform subtotalr17_1.1 thru subtotalr17_1.7
40812>>>>
40812>>>              blankform totalr17_1.1    thru totalr17_1.7
40813>>>>
40813>>>           End_Procedure
40814>>>        
40814>>>        End_Object
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        
40815>>>        //AB-StoreEnd
40815>>>
40815>>>    End_Object    // R17_2
40816>>>
40816>>>
40816>>>    //AB-StoreStart
40816>>>    
40816>>>    
40816>>>    
40816>>>    
40816>>>    
40816>>>    
40816>>>    
40816>>>    
40816>>>    //AB-StoreEnd
40816>>>
40816>>>//AB/     End_Object    // prj
40816>
40816>    End_Object  // Client_Area
40817>    
40817>    On_Key Key_Ctrl+Key_1 Send Activate_R17_2 To Client_Area
40818>    
40818>    Use DFStdSbr.pkg //  Status-Bar object.
INCLUDING FILE: DFSTDSBR.PKG
40818>>>// 07/23/96 JJT - New Class names
40818>>>// Very prototype global status bar
40818>>>//   
40818>>>
40818>>>Use dfMainSt.pkg
INCLUDING FILE: DFMAINST.PKG
40818>>>>>// 07/23/96 JJT - New Class names
40818>>>>>Use dfAstbar.pkg
40818>>>>>
40818>>>>>Class StatusBar is a AppStatusBar
40819>>>>>
40819>>>>>    Procedure Construct_Object
40820>>>>>       Forward Send Construct_Object
40822>>>>>       //
40822>>>>>       Send Add_Item 350  ''     // micro-help
40823>>>>>       Send Add_Item  40  'View:'
40824>>>>>       Set Item_Display_Style To sbNORMAL
40825>>>>>       Send Add_Item 200  ''     // view name
40826>>>>>       Send Add_Item   0  ''     // spring 'normal' to end
40827>>>>>       Set Item_Display_Style To sbNORMAL
40828>>>>>    End_Procedure // Construct_Object
40829>>>>>
40829>>>>>    Procedure Show_View_Name String sName
40830>>>>>        Set Value item 2 to sName
40831>>>>>    End_Procedure
40832>>>>>
40832>>>>>End_Class
40833>>>if (wait(self)) send deactivate to (wait(self))
40836>>>
40836>>>object oStatusBarSub Is a StatusBar
40838>>>
40838>>>    Use DFTimer // DfTimer Manager Must Have a WindowHandle
40838>>>
40838>>>    Property Integer piStdPanes Public (PaneCount(Self))
40840>>>
40840>>>    Set Value     Item 1 to "„§ ¢¦šã:"
40841>>>    Set PaneWidth item 1 to 50
40842>>>
40842>>>    Send AddPane 55  ""        sbLOWERED
40843>>>    Send AddPane 70  ""        sbLOWERED
40844>>>    Send AddPane 55  ""        sbLOWERED
40845>>>
40845>>>    Procedure pTimer
40847>>>        String lsDay lsHour lsHH lsMM lsSS
40848>>>        Integer liStdPanes lbState
40848>>>
40848>>>        Get piStdPanes to liStdPanes
40849>>>        Sysdate lsDay lsHH lsMM lsSS
40853>>>        If (Length(lsHH)=1) Insert "0" In lsHH At 1
40857>>>        If (Length(lsMM)=1) Insert "0" In lsMM At 1
40861>>>        If (Length(lsSS)=1) Insert "0" In lsSS At 1
40865>>>        Move (lsHH+":"+lsMM+":"+lsSS) to lsHour
40866>>>        Get Simple_state to lbState
40867>>>        If  Not (lbState) Begin
40869>>>            Set Value Item liStdPanes     to lsHour
40870>>>            Set Value Item (liStdPanes+1) to lsDay
40871>>>        End
40871>>>>
40871>>>    End_Procedure // pTimer
40872>>>
40872>>>
40872>>>    Object oTimerObj Is A DFTimer
40874>>>
40874>>>        Set Timeout to 1000
40875>>>        Set Timer_Active_State to TRUE
40876>>>        Set Timer_Object to (oStatusBarSub(Current_Object))
40877>>>        Set Timer_Message to pTimer
40878>>>
40878>>>    End_Object // oTimerObj
40879>>>
40879>>>End_Object // oStatusBarSub
40880>>>
40880>>>
40880>
40880>    //AB-PanelStoreStart
40880>    Use StdAbout.pkg // Standard "About" package.
INCLUDING FILE: STDABOUT.PKG
40880>>>//************************************************************************
40880>>>// Confidential Trade Secret.
40880>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
40880>>>// as an unpublished work.  All rights reserved.
40880>>>// DataFlex is a registered trademark of Data Access Corporation.
40880>>>//
40880>>>//************************************************************************
40880>>>//************************************************************************
40880>>>//
40880>>>// $File name  : StdAbout.pkg
40880>>>// $File title : Standard about object package for VDF
40880>>>// Notice      :
40880>>>// $Author(s)  : John Tuohy
40880>>>//
40880>>>// $Rev History
40880>>>//
40880>>>// JT 06/27/97   File created
40880>>>//************************************************************************
40880>>>
40880>>>// This provides a quick and simple way to create an about package for a program.
40880>>>// You need to create a message inside you client area called Activate_About.
40880>>>// Within this message you should send the message DoAbout passing needed
40880>>>// string information.
40880>>>//
40880>>>//       Procedure Activate_About
40880>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
40880>>>//       End_Procedure
40880>>>//    where: sTitle =     Name of application. If none provided, uses caption
40880>>>//                        bar title
40880>>>//           sVersion   = Version Line. If none provided, will be blank
40880>>>//           sCopyRight = Copyright Line. If none provided, will be blank
40880>>>//           sAuthor    = Author name, blank if none provided
40880>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
40880>>>//                        is used.
40880>>>// It is expected that you will place this in your own object package. For
40880>>>// example an order about package may look like this:
40880>>>//
40880>>>//   // OrderAbout.pkg
40880>>>//   Use StdAbout.pkg
40880>>>//   Procedure Activate_About
40880>>>//      Local String sTitle sCopyright sVersion sAuthor
40880>>>//      Move "My Order Entry System" to sTitle
40880>>>//      Move "Version 2.1" to sVersion
40880>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
40880>>>//      Move "John Smith"  to sAuthor
40880>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
40880>>>//   end_procedure
40880>>>//   // end of file.
40880>>>
40880>>>Use DfAbout.pkg
INCLUDING FILE: DFABOUT.PKG
40880>>>>>//************************************************************************
40880>>>>>// Confidential Trade Secret.
40880>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
40880>>>>>// as an unpublished work.  All rights reserved.
40880>>>>>// DataFlex is a registered trademark of Data Access Corporation.
40880>>>>>//
40880>>>>>//************************************************************************
40880>>>>>//************************************************************************
40880>>>>>//
40880>>>>>// $File name  : DfAbout.pkg
40880>>>>>// $File title : About class support
40880>>>>>// Notice      :
40880>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
40880>>>>>//
40880>>>>>// $Rev History
40880>>>>>//
40880>>>>>// JJT 11/5/98    Added version information
40880>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
40880>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
40880>>>>>//                workspace package.
40880>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
40880>>>>>//                class can create this object.
40880>>>>>//                Cleaned up the interface (used correct classes and messages)
40880>>>>>//                Added workspace reporting support to sys-info.
40880>>>>>//                Turned off wrapping in the sys-info editor.
40880>>>>>// KR  ??/??/96   File created
40880>>>>>//************************************************************************
40880>>>>>Use windows.pkg
40880>>>>>Use DFbitmap.pkg
40880>>>>>
40880>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
40881>>>>>
40881>>>>>//****************************************************************************
40881>>>>>// $Module type: FUNCTION
40881>>>>>// $Module name: Network_User_Name
40881>>>>>// $Author     : AK/VOO/KCR
40881>>>>>// Created     : 24-09-96 @ 19:17
40881>>>>>//
40881>>>>>// Description
40881>>>>>//    This function reads the current username of windows and returns that
40881>>>>>//    name or an text unknown user
40881>>>>>//
40881>>>>>// $Rev History
40881>>>>>//    24-09-96  Module header created
40881>>>>>//****************************************************************************
40881>>>>>Function Network_User_Name Returns String
40883>>>>>    Local String sName sLength
40884>>>>>    Local Pointer lpName_Addr lpLength_Addr
40884>>>>>    Local Integer iRetval
40884>>>>>
40884>>>>>    Movestr (Repeat (Character (0), 255)) To sName
40885>>>>>>
40885>>>>>    GetAddress Of sName To lpName_Addr
40886>>>>>    Movestr (DwordToBytes (255)) To sLength
40887>>>>>>
40887>>>>>    GetAddress Of sLength To lpLength_Addr
40888>>>>>
40888>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
40889>>>>>>
40889>>>>>
40889>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
40892>>>>>    Else Function_Return "User Unknown"
40894>>>>>End_Function // Network_User_Name
40895>>>>>
40895>>>>>Type MEMORYSTATUS
40895>>>>>   Field MEMORYSTATUS.dwLength         As Dword // sizeof(MEMORYSTATUS)
40895>>>>>   Field MEMORYSTATUS.dwMemoryLoad     As Dword // percent of memory in use
40895>>>>>   Field MEMORYSTATUS.dwTotalPhys      As Dword // bytes of physical memory
40895>>>>>   Field MEMORYSTATUS.dwAvailPhys      As Dword // free physical memory bytes
40895>>>>>   Field MEMORYSTATUS.dwTotalPageFile  As Dword // bytes of paging file
40895>>>>>   Field MEMORYSTATUS.dwAvailPageFile  As Dword // free bytes of paging file
40895>>>>>   Field MEMORYSTATUS.dwTotalVirtual   As Dword // user bytes of address space
40895>>>>>   Field MEMORYSTATUS.dwAvailVirtual   As Dword // free user bytes
40895>>>>>End_Type // MEMORYSTATUS
40895>>>>>
40895>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
40896>>>>>
40896>>>>>// If a global workspace object exists it will use this variable to store
40896>>>>>// its object id.
40896>>>>>
40896>>>>>Class SysinfoDisplay Is An Edit
40897>>>>>    Procedure Construct_Object
40898>>>>>        forward send construct_object
40900>>>>>
40900>>>>>        Set Location To 6 6
40901>>>>>        Set Size To 110 255
40902>>>>>        Set Read_Only_State To True
40903>>>>>        Set wrap_state to False
40904>>>>>    end_Procedure
40905>>>>>
40905>>>>>    //****************************************************************************
40905>>>>>    // $Module type: PROCEDURE
40905>>>>>    // $Module name: Add_Line
40905>>>>>    // $Author     : VOO
40905>>>>>    // Created     : 06-10-96 @ 15:23
40905>>>>>    //
40905>>>>>    // Description
40905>>>>>    //    This method will add a line to this edit object, it should go simpler
40905>>>>>    //    but it seems to be done this way.
40905>>>>>    //
40905>>>>>    // $Rev History
40905>>>>>    //    06-10-96  Module header created
40905>>>>>    //****************************************************************************
40905>>>>>    Procedure Add_Line String sVal
40906>>>>>        Local Integer iLine
40907>>>>>
40907>>>>>        Moveint (Line_Count (Current_Object)) To iLine
40908>>>>>>
40908>>>>>        If (iLine = 1 And Changed_State (Current_Object) = False) Moveint 0 To iLine
40911>>>>>        Set Value Item iLine To sVal
40912>>>>>    End_Procedure // Add_Line
40913>>>>>
40913>>>>>    //****************************************************************************
40913>>>>>    // $Module type: PROCEDURE
40913>>>>>    // $Module name: Show_Current_Directory
40913>>>>>    // $Author     : VOO
40913>>>>>    // Created     : 06-10-96 @ 15:24
40913>>>>>    //
40913>>>>>    // Description
40913>>>>>    //    This method will show the name of the current directory in the system
40913>>>>>    //    information box
40913>>>>>    //
40913>>>>>    // $Rev History
40913>>>>>    //    06-10-96  Module header created
40913>>>>>    //****************************************************************************
40913>>>>>    Procedure Show_Current_Directory
40914>>>>>        Local String sDir
40915>>>>>
40915>>>>>        Get_Current_Directory To sDir
40916>>>>>        Send Add_Line ("Current Directory: " + sDir)
40917>>>>>    End_Procedure // Show_Current_Directory
40918>>>>>
40918>>>>>    Procedure Show_Windows_Directory
40919>>>>>        Local String sWindir
40920>>>>>
40920>>>>>        Get_Windows_Directory To sWindir
40921>>>>>        Send Add_Line ("Windows Directory: " * sWindir)
40922>>>>>    End_Procedure // Show_Windows_Directory
40923>>>>>
40923>>>>>    Procedure Show_Current_User
40924>>>>>        Send Add_Line ("Network User Name: " * Network_User_Name (Current_Object))
40925>>>>>    End_Procedure // Show_Current_User
40926>>>>>
40926>>>>>    Procedure Show_Number_Format
40927>>>>>        Local Integer iFormat
40928>>>>>
40928>>>>>        Get_Attribute Df_Thousands_Separator To iFormat
40931>>>>>        Send Add_Line ('Thousands Separator: "' - Character (iFormat) - '" (' - String (iFormat) - ')')
40932>>>>>        Get_Number_Format To iFormat
40933>>>>>        Send Add_Line ('Decimal Separator: "' - If (iFormat = 0, '.', ',') - '"')
40934>>>>>    End_Procedure // Show_Number_Format
40935>>>>>
40935>>>>>    Procedure Show_Filelist_Name
40936>>>>>        Local String sFilename
40937>>>>>
40937>>>>>        Get_Attribute Df_Filelist_Name To sFilename
40940>>>>>        Send Add_Line ("Current Filelist: " * sFilename)
40941>>>>>    End_Procedure // Show_Filelist_Name
40942>>>>>
40942>>>>>    Procedure Show_Lock_Delay
40943>>>>>        Local Integer iLockdelay
40944>>>>>
40944>>>>>        Get_Attribute Df_Lock_Delay To iLockdelay
40947>>>>>        Send Add_Line ("Database Locking Delay: " * String (iLockdelay) * "Milliseconds")
40948>>>>>    End_Procedure // Show_Lock_Delay
40949>>>>>
40949>>>>>    Procedure Show_Lock_Timeout
40950>>>>>        Local Integer iLockTimeout
40951>>>>>
40951>>>>>        Get_Attribute Df_Lock_Timeout To iLockTimeout
40954>>>>>        Send Add_Line ("Database Locking Timeout: " * String (iLockTimeout) * "Milliseconds")
40955>>>>>    End_Procedure // Show_Lock_Timeout
40956>>>>>
40956>>>>>    Procedure Show_Screen_Size
40957>>>>>        Local Integer iYscreensize iXscreensize
40958>>>>>
40958>>>>>        Moveint (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
40959>>>>>>
40959>>>>>        Moveint (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
40960>>>>>>
40960>>>>>
40960>>>>>        Send Add_Line ("Video Resolution: " * String (iXscreensize) * "by" * String (iYscreensize))
40961>>>>>    End_Procedure // Show_Screen_Size
40962>>>>>
40962>>>>>    Procedure Show_Page_Size
40963>>>>>        Send Add_Line ("Page End: " * String (Pageend) * "Form Feed: " * String (Pagefeed))
40964>>>>>    End_procedure
40965>>>>>
40965>>>>>    Procedure Show_Date
40966>>>>>        Local Date dToday
40967>>>>>
40967>>>>>        Sysdate4 dToday
40968>>>>>        Send Add_Line ("Current System Date: " * String (dToday))
40969>>>>>    End_procedure // Show_Date
40970>>>>>
40970>>>>>    Procedure Show_Date_Format
40971>>>>>        Local Integer iDateFormat
40972>>>>>        Local String sDateFormat
40972>>>>>
40972>>>>>        Get_Attribute Df_Date_Format To iDateFormat
40975>>>>>        if iDateFormat Eq DF_DATE_USA ;            Movestr "USA" To sDateFormat
40978>>>>>        else if iDateformat Eq DF_DATE_EUROPEAN ;            Movestr "European" To sDateFormat
40982>>>>>        else if iDateformat Eq DF_DATE_MILITARY ;            Movestr "Military" To sDateFormat
40986>>>>>        else ;            Movestr "Unknown Date Type" To sDateFormat
40988>>>>>        Send Add_Line ("Date Format: " * sDateformat)
40989>>>>>    End_Procedure // Show_Date_Format
40990>>>>>
40990>>>>>    Procedure Show_Memavail
40991>>>>>        Local Integer iMem
40992>>>>>
40992>>>>>        Memory iMem
40993>>>>>>
40993>>>>>        Send Add_Line ("Available Memory: " * String (iMem))
40994>>>>>    End_Procedure // Show_Memavail
40995>>>>>
40995>>>>>    Procedure Show_Systemresources
40996>>>>>        Local String sMemoryStatus
40997>>>>>        Local Pointer lpsMemoryStatus
40997>>>>>        Local Integer iVoid
40997>>>>>        Local Dword dwMemoryLoad dwTotalPhys dwAvailPhys dwTotalPageFile dwAvailPageFile dwTotalVirtual dwAvailVirtual
40997>>>>>
40997>>>>>        ZeroType MEMORYSTATUS To sMemoryStatus
40998>>>>>        GetAddress Of sMemoryStatus To lpsMemoryStatus
40999>>>>>
40999>>>>>        Moveint (GlobalMemoryStatus (lpsMemoryStatus)) To iVoid
41000>>>>>>
41000>>>>>
41000>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwMemoryLoad    To dwMemoryLoad
41001>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPhys     To dwTotalPhys
41002>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPhys     To dwAvailPhys
41003>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPageFile To dwTotalPageFile
41004>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPageFile To dwAvailPageFile
41005>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalVirtual  To dwTotalVirtual
41006>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailVirtual  To dwAvailVirtual
41007>>>>>
41007>>>>>        Send Add_Line ("Current memory utilization:" * String (dwMemoryLoad))
41008>>>>>        Send Add_Line ("Percentage available physical memory:" * String (dwAvailPhys / dwTotalPhys * 100.0) - "%")
41009>>>>>        Send Add_Line ("Percentage available pagefile space:" * String (dwAvailPageFile / dwTotalPageFile * 100.0) - "%")
41010>>>>>        Send Add_Line ("Percentage available virtual memory:" * String (dwAvailVirtual / dwTotalVirtual * 100.0) - "%")
41011>>>>>    End_Procedure // Show_Systemresources
41012>>>>>
41012>>>>>    Procedure Show_Registration
41013>>>>>        Local String sRegName
41014>>>>>        Local Integer iSN
41014>>>>>        Registration sRegName iSN
41015>>>>>>
41015>>>>>
41015>>>>>        Send Add_Line ("Serial# : " + (String(iSN)))
41016>>>>>        Send Add_Line ("Reg Name: " + sRegName)
41017>>>>>
41017>>>>>    End_Procedure // Show_Current_Directory
41018>>>>>
41018>>>>>
41018>>>>>
41018>>>>>    //****************************************************************************
41018>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
41018>>>>>    // to the workspace object passing the an object and message to send back
41018>>>>>    // to this object. It is expected that the workspace object will send this
41018>>>>>    // message for every line of information it wants displayed (passing the
41018>>>>>    // information to be displayed
41018>>>>>    //****************************************************************************
41018>>>>>    register_procedure EnumerateWorkspaceData integer hObjId integer hmMessId
41018>>>>>    Procedure Show_WorkspaceInformation
41019>>>>>        If ghoWorkspace ;            Send EnumerateWorkspaceData to ghoWorkspace Current_object Msg_add_Line
41022>>>>>    End_Procedure
41023>>>>>
41023>>>>>    Function VersionStr integer iVer integer iRev integer iBld Returns string
41024>>>>>        Function_Return (string(iVer)-"."-string(iRev)-"."-string(iBld))
41025>>>>>    End_Function
41026>>>>>
41026>>>>>    Procedure Show_Versions
41027>>>>>        local integer iVersion iRevision iBuild
41028>>>>>        Version_information iVersion iRevision iBuild
41030>>>>>        Send Add_Line ("Runtime Version:" * VersionStr(self,iVersion,iRevision,iBuild) )
41031>>>>>        Send Add_Line ("Package Version:" * VersionStr(self,PKG_VERSION, PKG_REVISION, PKG_BUILD) )
41032>>>>>        Send Add_Line ("FMAC Version:"    * VersionStr(self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) )
41033>>>>>    End_Procedure
41034>>>>>
41034>>>>>
41034>>>>>    //***
41034>>>>>    //*** BW
41034>>>>>    //*** Procedure: Show_Drivers
41034>>>>>    //*** Purpose  : Show loaed database drivers
41034>>>>>    //***
41034>>>>>
41034>>>>>    Procedure Show_Drivers
41035>>>>>        Local String  Current_drvr
41036>>>>>        Local String  Loadeddrvrs
41036>>>>>        Local Integer Number_of_drvrs
41036>>>>>        Local Integer Count
41036>>>>>
41036>>>>>        Move "" To Loadeddrvrs
41037>>>>>        Get_attribute DF_NUMBER_DRIVERS To Number_of_drvrs
41040>>>>>        For Count From 1 To Number_of_drvrs
41046>>>>>>
41046>>>>>            Get_attribute DF_DRIVER_NAME Of Count To Current_drvr
41049>>>>>            If (Loadeddrvrs <> "") ;                Move (Append(Loadeddrvrs, ", ")) To Loadeddrvrs
41052>>>>>            Move (Append(Loadeddrvrs, Current_drvr)) To Loadeddrvrs
41053>>>>>        Loop
41054>>>>>>
41054>>>>>        Send Add_Line ("Database driver(s):" * Loadeddrvrs)
41055>>>>>    End_Procedure // Show_Drivers
41056>>>>>
41056>>>>>    //****************************************************************************
41056>>>>>    // $Module type: PROCEDURE
41056>>>>>    // $Module name: Add_Focus
41056>>>>>    // $Author     : VOO
41056>>>>>    // Created     : 24-09-96 @ 19:43
41056>>>>>    //
41056>>>>>    // Description
41056>>>>>    //    During activation we will remove the old information and add the newly
41056>>>>>    //    found systeminformation
41056>>>>>    //
41056>>>>>    // $Rev History
41056>>>>>    //    24-09-96  Module header created
41056>>>>>    //****************************************************************************
41056>>>>>    Procedure Add_Focus Integer hoRoot
41057>>>>>        Forward Send Add_Focus hoRoot
41059>>>>>
41059>>>>>        Send Delete_Data
41060>>>>>        Set Changed_State To False
41061>>>>>        Set Read_Only_State To True
41062>>>>>        Send Show_WorkSpaceInformation // added to show WS info
41063>>>>>        SEnd Show_Drivers
41064>>>>>        Send Show_Current_User
41065>>>>>        Send Show_Windows_Directory
41066>>>>>        Send Show_Current_Directory
41067>>>>>        Send Show_Filelist_Name
41068>>>>>        Send Show_Versions
41069>>>>>        Send Show_Memavail
41070>>>>>        Send Show_Screen_Size
41071>>>>>        Send Show_Page_Size
41072>>>>>        Send Show_Number_Format
41073>>>>>        Send Show_Date_Format
41074>>>>>        Send Show_Lock_Delay
41075>>>>>        Send Show_Lock_Timeout
41076>>>>>        Send Show_Date
41077>>>>>        Send Show_Systemresources
41078>>>>>        Send Show_Registration
41079>>>>>    End_Procedure // Show_All_Info
41080>>>>>
41080>>>>>End_Class // SysinfoDisplay
41081>>>>>
41081>>>>>
41081>>>>>//****************************************************************************
41081>>>>>// $Module type: OBJECT
41081>>>>>// $Module name: Sysinfo_Dialog
41081>>>>>// $Author     : VOO
41081>>>>>// Created     : 24-09-96 @ 18:47
41081>>>>>//
41081>>>>>// Description
41081>>>>>//    This object shows the systeminformation on the screen
41081>>>>>//
41081>>>>>// $Rev History
41081>>>>>//    24-09-96  Module header created
41081>>>>>//****************************************************************************
41081>>>>>Class SysInfoDialog Is A ModalPanel
41082>>>>>    Procedure Construct_Object
41083>>>>>        forward send construct_object
41085>>>>>
41085>>>>>        Set Caption_Bar To True
41086>>>>>        Set Sysmenu_Icon To True
41087>>>>>        Set Label To "System Information"
41088>>>>>        Set Size To 152 270
41089>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
41090>>>>>        Set Minimize_Icon To False
41091>>>>>        Set Maximize_Icon To False
41092>>>>>        Set Border_Style To Border_Dialog
41093>>>>>
41093>>>>>        Object Sysinfo_Display Is A SysInfoDisplay
41095>>>>>        End_Object
41096>>>>>
41096>>>>>        Object Close_Button Is A Button
41098>>>>>            Set Label to "&Close"
41099>>>>>            Set Location To 120 212
41100>>>>>            Set Message item 0 to msg_Close_Panel
41101>>>>>            Set default_action_button to current_object
41102>>>>>        End_Object // Close_Button
41103>>>>>
41103>>>>>        On_Key Kcancel       Send Close_Panel
41104>>>>>        On_Key Key_Alt+Key_C Send Close_Panel
41105>>>>>    End_procedure
41106>>>>>
41106>>>>>End_Class // SysinfoDialog
41107>>>>>
41107>>>>>// Purpose:
41107>>>>>//
41107>>>>>// Ken Ross 12/17/96 5:16PM
41107>>>>>//
41107>>>>>Class AboutDialog Is A ModalPanel
41108>>>>>
41108>>>>>    Procedure construct_object
41109>>>>>        String sVdfRootDir
41110>>>>>        forward send construct_object
41112>>>>>        Set Label to "About..."
41113>>>>>        Set Size to 100 217
41114>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
41115>>>>>
41115>>>>>        Object SysInfo_Dialog is a SysInfoDialog
41117>>>>>        End_Object
41118>>>>>
41118>>>>>        Object oBox is a Container3d
41120>>>>>            Set Border_Style to Border_StaticEdge
41121>>>>>            Set Size to 63 202
41122>>>>>            Set Location to 4 5
41123>>>>>
41123>>>>>            Object AboutGraphic is a BitmapContainer
41125>>>>>                Set Border_Style to Border_None
41126>>>>>                Set Bitmap_Style to Bitmap_Center
41127>>>>>                Set Size to 48 48
41128>>>>>                Set Location to 7 2
41129>>>>>            End_Object    // AboutGraphic
41130>>>>>
41130>>>>>            Object ProductName is a TextBox
41132>>>>>                Set label to "ProductName"
41133>>>>>                Set Size to 10 45
41134>>>>>                Set Location to 8 53
41135>>>>>            End_Object    // ProductName
41136>>>>>
41136>>>>>            Object Version is a TextBox
41138>>>>>                Set label to "Version"
41139>>>>>                Set Size to 10 25
41140>>>>>                Set Location to 21 53
41141>>>>>            End_Object    // Version
41142>>>>>
41142>>>>>            Object Copyright is a TextBox
41144>>>>>                Set label to "Copyright"
41145>>>>>                Set Size to 10 31
41146>>>>>                Set Location to 34 53
41147>>>>>            End_Object    // Copyright
41148>>>>>
41148>>>>>            Object Author is a TextBox
41150>>>>>                Set label to "Author"
41151>>>>>                Set Size to 10 22
41152>>>>>                Set Location to 46 53
41153>>>>>            End_Object    // Author
41154>>>>>
41154>>>>>        End_Object    // oBox
41155>>>>>
41155>>>>>        Object OK_bn is a Button
41157>>>>>            On_Item "&OK" Send Close_Panel
41158>>>>>            Set Size to 14 50
41159>>>>>            Set Location to 71 157
41160>>>>>        End_Object    // OK_bn
41161>>>>>
41161>>>>>        Object SysInfo_bn is a Button
41163>>>>>            On_Item "&System Info" Send Show_Sysinfo
41164>>>>>            Set Size to 14 50
41165>>>>>            Set Location to 71 101
41166>>>>>        End_Object    // SysInfo_bn
41167>>>>>
41167>>>>>        On_Key Kcancel Send KeyAction to (Ok_bn(Current_Object))
41168>>>>>        On_Key Key_Alt+Key_O Send KeyAction to (Ok_bn(Current_Object))
41169>>>>>        On_Key Key_Alt+Key_S Send KeyAction to (SysInfo_bn(Current_Object))
41170>>>>>
41170>>>>>        Get_Profile_String "Defaults" "VdfRootDir" To sVdfRootDir
41173>>>>>        Set logo to (sVdfRootDir +"\Bitmaps\DacAbout.bmp")  // square bitmaps of 42x42 work best
41174>>>>>
41174>>>>>    End_Procedure
41175>>>>>
41175>>>>>    Procedure set productname string sval
41176>>>>>        set label of (productname(oBox(current_object))) to sval
41177>>>>>    End_Procedure
41178>>>>>
41178>>>>>    Procedure set version string sval
41179>>>>>        set label of (version(oBox(current_object))) to sval
41180>>>>>    End_Procedure
41181>>>>>
41181>>>>>    Procedure set copyright string sval
41182>>>>>        set label of (copyright(oBox(current_object))) to sval
41183>>>>>    End_Procedure
41184>>>>>
41184>>>>>    Procedure set author string sval
41185>>>>>        set label of (author(oBox(current_object))) to sval
41186>>>>>    End_Procedure
41187>>>>>
41187>>>>>    // square bitmaps of 42x42 work best
41187>>>>>    //
41187>>>>>    Procedure set logo string sval
41188>>>>>        set bitmap of (aboutgraphic(oBox(current_object))) to sval
41189>>>>>    End_Procedure
41190>>>>>
41190>>>>>    Procedure Show_Sysinfo
41191>>>>>        Send Popup_Modal To (Sysinfo_Dialog(Current_Object))
41192>>>>>    End_Procedure // Show_Sysinfo
41193>>>>>
41193>>>>>End_Class
41194>>>>>
41194>>>>>
41194>>>>>//Object About_Dialog is an AboutDialog
41194>>>>>//    set productname to "Visual DataFlex"
41194>>>>>//    set version to "version 4.0"
41194>>>>>//    set copyright to "Copyright 1997 Data Access Corporation"
41194>>>>>//    set author to ""
41194>>>>>//    set logo to "ablogo.bmp"  // square bitmaps of 42x42 work best
41194>>>>>//End_Object
41194>>>>>
41194>>>>>//Procedure Activate_About
41194>>>>>//   Send Popup_Modal To (About_Dialog (Current_Object))
41194>>>>>//End_Procedure
41194>>>
41194>>>// *************************************************************************
41194>>>//  Public message. This is the default message. It is expected that you will
41194>>>//   create your own message to override this
41194>>>// *************************************************************************
41194>>>
41194>>>Procedure Activate_About
41196>>>   Send DoAbout "" "" "" "" "" ""
41197>>>End_Procedure
41198>>>
41198>>>// *************************************************************************
41198>>>//  Public message. It is expected that you will send this message (most
41198>>>//  likely from Activate_About. This creates an about object, activates it
41198>>>//  and destroys it when done. It is not exepected that you will augment this.
41198>>>// *************************************************************************
41198>>>
41198>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
41200>>>        Local integer hoObj hoMain
41201>>>
41201>>>        // create object
41201>>>        Object About is an AboutDialog
41203>>>            // if no title passed use the label of the main panel
41203>>>            // (if a main panel exists).
41203>>>            if sTitle     eq '' Begin
41205>>>                Get Main_Window to hoMain
41206>>>                if hoMain Get Label of hoMain to sTitle
41209>>>            end
41209>>>>
41209>>>            set productname to sTitle
41210>>>            set version     to sVersion
41211>>>            set copyright   to sCopyRight
41212>>>            set author      to sAuthor
41213>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
41216>>>            Move Current_Object to hoObj // object Id
41217>>>        End_Object
41218>>>        Send Popup to hoObj    // popup the about object
41219>>>        Send Request_Destroy_Object to hoObj // when done, it will be destroyed
41220>>>End_procedure
41221>    //AB-PanelStoreEnd
41221>
41221>
41221>End_Object
41222>
41222>
41222>//AB-StoreStart
41222>Start_UI
41223>
41223>
41223>
41223>
41223>
41223>
41223>
41223>
41223>
41223>
41223>
41223>
41223>
41223>
41223>
41223>
41223>
41223>
41223>//AB-StoreEnd
41223>
41223>
Summary
Memory Available: 2147483647
Total Errors   : 12
Total Symbols  : 23741
Total Resources: 0
Total Commands : 41222
Total Windows  : 49
Total Pages    : 9
Static Data    : 283385
Message area   : 218976
Total Blocks   : 13772
12 ERRORS HAVE BEEN FOUND.
