Compiling Program: C:\Vdf6\Develop\Empor\AppSrc\titan.src
Memory Available: 2147483647
1>Use AllEntSc
Using pre-compiled package ALLENTSC
INCLUDING FILE: ALLENTSC.PKI
30262>
30262>Register_Object Client_Area
30262>
30262>//AB-StoreTopStart
30262>Use Workspc.pkg
30262>
30262>//  Set date attributes as needed
30262>Set_Date_Attribute sysdate4_State to (TRUE)
30263>Set_Date_Attribute Date4_State    to (TRUE)
30264>Set_Date_Attribute epoch_value    to 30
30265>
30265>Object ProgramWorkspace is a WorkspaceSub
30267>    Set WorkspaceName to CURRENT$WORKSPACE
30268>    Set kEnter_Next_State to True
30269>//    Set ModuleName    to 'ProgramName' // Special module name.
30269>//    Set HelpName      to 'HelpName.hlp'// Please provide the name of your Windows help file.
30269>End_Object
30270>
30270>Use Help_Ids.inc // Developer should provide this file of help context links.
INCLUDING FILE: HELP_IDS.INC
30270>>>// Help_ids.inc
30270>>>//
30270>>>// Context ids for the order entry system. This uses
30270>>>// help file ordentry.hlp.
30270>>>//
30270>>>// This is a sample version. YOU must supply
30270>>>// the ID values
30270>>>
30270>>>//  Generic Context Ids
30270>>>//
30270>>>
30270>>>// It is expected that file-names ids will be the same as their
30270>>>// filenumber.
30270>>>
30270>>>
30270>>>//  View and selection-list specific context ids
30270>>>//
30270>>>//..........add view, object, selection-list ids here....
30270>Use Std_Help.pkg
INCLUDING FILE: STD_HELP.PKG
30270>>>// STD_HELP.PKG
30270>>>//
30270>>>// Global Help Object
30270>>>//
30270>>>//  Creates all Help Support required to access WINDOWs help system
30270>>>//  with DataFlex. Creates a global object named Help_Object.
30270>>>//
30270>>>//  9/19/97 JJT - Modified to define stadnard help Ids if they are undefined
30270>>>
30270>>>use DFHlpSys // Context Sensitive Help Support
30270>>>
30270>>>
30270>>>// This file needs to be provided by the developer. It will contain
30270>>>// symbolic replacements for the ID integer values used to access the
30270>>>// the windows help file's topics.
30270>>>//
30270>>>use Help_ids.inc
30270>>>
30270>>>// If the following are not defined in help_ids.inc,
30270>>>//  create default 0 values for them
30270>>>Define GeneralHelpId    for    0
30270>>>Define KeysHelpId       for    0
30270>>>Define FileHelpId       for    0
30270>>>Define ErrorHelpId      for    0  // probably not used in VDF
30270>>>Define IndexHelpId      for    0  // probably not used in VDF
30270>>>
30270>>>object Help_Object is a HelpSystem // global help object
30272>>>
30272>>>   Set Help_Id_General to GeneralHelpId    // these should all be defined
30273>>>   Set Help_Id_Index   to IndexHelpId      // in help_ids.inc.
30274>>>   Set Help_Id_Keys    to KeysHelpId       //
30275>>>   Set Help_Id_Files   to FileHelpId       //
30276>>>   Set Help_Id_Errors  to ErrorHelpId      //
30277>>>
30277>>>end_object
30278>
30278>// General Functions-Procedures and Variables
30278>Use Globals.Inc
INCLUDING FILE: GLOBALS.INC
30278>>>
30278>>>        String  gs_Selected_Company_Code
30278>>>        String  gs_Selected_Branch_Code
30278>>>        Integer gi_Selected_Year
30278>>>        String gs_Selected_Year_Recr
30278>>>        String  gs_Module_Code
30278>>>
30278>>>
30278>>>//Open Currency
30278>>>//Function CurrDigits Global String asCurr Returns Integer
30278>>>//    Integer liDecX
30278>>>//    Clear Currency
30278>>>//    move asCurr to Currency.Currency_C_Code
30278>>>//    Find Eq Currency By Index.1
30278>>>//    move Currency.Currency_Dec to liDecX
30278>>>//    Function_Return liDecX
30278>>>//End_Function // CurrDigits
30278>>>
30278>>>Open Nomisma
INCLUDING FILE: NOMISMA.FD
30280>>>Open SysCurXr
INCLUDING FILE: SYSCURXR.FD
30282>>>
30282>>>Function fiDekadika_Nomismatos Global String asNomisma Returns Integer
30283>>>    Move (Trim(asNomisma)) to asNomisma
30284>>>    Clear Nomisma
30285>>>    If ( asNomisma<>'' ) Move asNomisma         to Nomisma.Nomisma_Code
30288>>>    Else                 Move SysCurXr.C_Code0  to Nomisma.Nomisma_Code
30290>>>    Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
30291>>>>
30291>>>    Function_Return Nomisma.Dekadika
30292>>>End_Function //
30293>>>
30293>>>Function fsgCode_W_Zeroes Global Integer aiCode Integer aiPlaces Returns String
30294>>>    String rVal
30295>>>    Integer iLength iInt
30295>>>    Move aiCode to rVal
30296>>>    Move (trim(rVal)) to rVal
30297>>>    For iInt From 1 to (aiPlaces-(Length(rVal)))
30303>>>>
30303>>>        Move (Insert('0',rVal,1)) to rVal
30304>>>    Loop
30305>>>>
30305>>>    Function_Return rVal
30306>>>End_Function
30307>>>
30307>>>Function fsgCode_n_Zeroes Global number aiCode Integer aiPlaces Returns String
30308>>>    String rVal
30309>>>    Integer iLength iInt ipos
30309>>>    Move aiCode to rVal
30310>>>    Move (trim(rVal)) to rVal
30311>>>    MOVE (aiPlaces-(Length(rVal))) to ipos
30312>>>    For iInt From 1 to ipos
30318>>>>
30318>>>        Move (Insert('0',rVal,1)) to rVal
30319>>>    Loop
30320>>>>
30320>>>    Function_Return rVal
30321>>>End_Function
30322>>>
30322>>>
30322>>>Open Year
INCLUDING FILE: YEAR.FD
30324>>>Procedure EnumDDsForRebuildConstrain for DataDictionary integer aiMsg integer ahId
30325>>>    Send aiMsg to Self
30326>>>End_Procedure
30327>>>
30327>>>Procedure DoRefindYear for baseclass Integer aiPanel Integer aiYearDD
30328>>>    Integer liChanged
30329>>>
30329>>>    If ((aiYearDD = 0) or (Main_File(aiYearDD)<>Year.File_Number)) ;        Procedure_Return (Message_Box("Invalid Year_DD","Developer's Warning",MB_OK,MB_ICONWARNING))
30332>>>    If (Not(Current_Record(aiYearDD))) Begin
30334>>>        Get Should_Save of aiPanel to liChanged
30335>>>        Send Clear to aiYearDD
30336>>>        Move gs_Selected_Company_Code to Year.Company_Code
30337>>>        Move gs_Selected_Branch_Code  to Year.Branch_Code
30338>>>        Move gi_Selected_Year         to Year.Year_Year
30339>>>        Send Find to aiYearDD Eq 1 //Year.Index.1 - company_code+ranch_code+year_year
30340>>>        If (Not(liChanged)) Set Changed_State of aiPanel to False
30343>>>    End
30343>>>>
30343>>>End_Procedure
30344>>>
30344>>>Procedure RebuildConstrainIfYearChanged for baseclass Integer aiPanel String asCurrentYearRecr Integer aiYearDDId
30345>>>    Integer liSrvr
30346>>>    String  lsCurrentYearRecr
30346>>>
30346>>>    If (asCurrentYearRecr <> gs_Selected_Year_Recr) Begin
30348>>>        Broadcast Send EnumDDsForRebuildConstrain to aiPanel msg_Rebuild_Constraints Self
30350>>>    End
30350>>>>
30350>>>    Send DoRefindYear aiPanel aiYearDDId //(Year_DD(Self))
30351>>>    Get Server of aiPanel to liSrvr
30352>>>    // Respects Default values
30352>>>    If (liSrvr) If (Not(Current_Record(liSrvr))) Send Request_Clear to aiPanel
30357>>>End_Procedure
30358>>>
30358>>>//                                       ’¦ View            Property «¦¬ View             ’¦ Year DDO «¦¬ View
30358>>>//                                                          Holds the current year rec0
30358>>>// ‰¢ã©ž : Send RbldConstrIfYearChanged (Gplan_Test(Self))  (psCurrentYearRecr(Self))     (Year_DD(Self))
30358>>>
30358>>>
30358>>>Function fiRefindYear Global Returns Integer
30359>>>    Clear Year
30360>>>    Move gs_Selected_Company_Code to Year.Company_Code
30361>>>    Move gs_Selected_Branch_Code  to Year.Branch_Code
30362>>>    Move gi_Selected_Year         to Year.Year_Year
30363>>>    Find eq Year by Index.1 //company_code+ranch_code+year_year
30364>>>>
30364>>>    Function_Return (Found = 0)
30365>>>End_Function //fiRefindYear
30366>>>
30366>>>Procedure DoRunApplication for Baseclass String sAppName
30367>>>    string sRuntime  lsStr
30368>>>
30368>>>    Append lsStr 'C:\Dns.bat ' sAppName
30370>>>    RunProgram Wait  lsStr
30371>>>
30371>>>//    get_profile_string "defaults" "VDFBinDir" to sRuntime
30371>>>//    append sRuntime "\dfrun " sAppName
30371>>>    Append sRuntime 'C:\Program Files\Accessories\WORDPAD.EXE ' sAppName
30373>>>    runprogram background sRuntime
30374>>>End_procedure // DoRunApplication
30375>>>
30375>>>// Run the Editor
30375>>>Procedure DoRunEditor for Baseclass String asFile
30376>>>    string sRunPath lsWspcName
30377>>>    Move (WorkspaceName(ProgramWorkspace(Self))) to lsWspcName
30378>>>    get_profile_string ("workspaces\"+lsWspcName) "programpath" to sRunPath
30381>>>    //append sRunPath "\Editor "  asFile //// js 15/03/2002 " " lsWspcName
30381>>>    Move (Replace('.',asFile,'')) to asFile
30382>>>    append sRunPath asFile //// js 15/03/2002 " " lsWspcName
30383>>>    send DoRunApplication sRunPath
30384>>>End_Procedure // DoRunEditor
30385>>>
30385>>>//--------------------------------------
30385>>>
30385>>>//start of global functions and procedures
30385>>>
30385>>>
30385>>>//®¨ž© £¦§¦ œå«˜  ˜§æ: ˜) gmoves.dd    :private.update_gmhnes_ghmnies
30385>>>Function gsfFind_Previous Global String lsCode;                                 String lsDelimiter;                                 Returns String
30386>>>         String  lsTemp_Code1 lsTemp_Code2
30387>>>         Integer liCounter
30387>>>
30387>>>         //1.˜­˜å¨œ©ž ¡œ¤é¤
30387>>>         Move (Trim(lsCode)) to lsCode                                  //§® 30.12.345
30388>>>
30388>>>         //2.˜¤« ©«¨¦­ã
30388>>>         For liCounter From 1 to (Length(lsCode))
30394>>>>
30394>>>             Move (Insert(;                           (Mid(lsCode,1,liCounter)),;                           lsTemp_Code1,;                           1;                         )) to lsTemp_Code1                             //§® 543.21.03
30395>>>         Loop
30396>>>>
30396>>>
30396>>>         //3.˜­˜å¨œ©ž ¡œ¤é¤ (›â¤ ®¨œ áœ«˜ , safety only)
30396>>>         Move (Trim(lsTemp_Code1)) to lsTemp_Code1
30397>>>
30397>>>         //4.§˜å¨¤à £æ¤¦ «¦ ›œ¥ æ £â¨¦ª «¦¬ ˜¤«å©«¨¦­¦¬, £œ«á «¦ §¨é«¦ delimiter
30397>>>         Move (Right(;                      lsTemp_Code1,;                      ((Length(lsTemp_Code1))-((Pos(lsDelimiter,lsTemp_Code1))));                    )) to lsTemp_Code1                                  // §® 21.03
30398>>>
30398>>>         //5.¥˜¤á ˜¤« ©«¨¦­ã «¦¬ ˜¤«å©«¨¦­¦¬
30398>>>         For liCounter from 1 to (Length(lsTemp_Code1))
30404>>>>
30404>>>             Move (Insert(;                           (Mid(lsTemp_Code1,1,liCounter)),;                           lsTemp_Code2,;                           1;                         )) to lsTemp_Code2                             //§® 30.12
30405>>>         Loop
30406>>>>
30406>>>
30406>>>         Function_Return (Trim(lsTemp_Code2))
30407>>>End_Function //gsffind_previous
30408>>>
30408>>>
30408>>>Function gifSystem_Check Returns Integer
30409>>>         Integer liF_Gtypkins liF_Garicls liF_Gmoves liF_Gplans liF_Gmhnes liF_Ghmnies
30410>>>         Integer liS_Gtypkins liS_Garicls liS_Gmoves liS_Gplans liS_Gmhnes liS_Ghmnies
30410>>>//       Clear Company
30410>>>//       Find Gt Company.Recnum
30410>>>//       While (Found = 1)
30410>>>//             Add Company.Company_NumGtypkin to liS_Gtypkins § Ÿ˜¤é© ©«¦ sysfile ¤˜ «˜ ¡˜¨˜«áà ˜¬«á
30410>>>//             Add Company.Company_NumGarticl to liS_Garticls
30410>>>//             Add Company.Company_NumGmoves  to liS_Gmoves
30410>>>//             //d Company.Company_NumGtypkin to liS_Gtypkins
30410>>>//             Add Company.Company_NumGplan   to liS_GPlans
30410>>>//             Add Company.Company_NumGmhnes  to liS_Gmhnes
30410>>>//             Add Company.Company_NumGhmnies to liS_Ghmnies
30410>>>//             Find Gt Company.Recnum
30410>>>//       Loop
30410>>>//
30410>>>//       Get_Attribute {attribute} [of {file-handle} ;
30410>>>//                        [{field-num} | {index-num} [{segment-num}]]] ;
30410>>>//                        To {variable}
30410>>>//
30410>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30410>>>//       Get_Attribute DF_FILE_RECORDS_USED of Garticl.File_Number to liF_Garticls
30410>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmoves.File_Number  to liF_Gmoves
30410>>>//       //t_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30410>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gplan.File_Number   to liF_Gplans
30410>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmhnes.File_Number  to liF_Gmhnes
30410>>>//       Get_Attribute DF_FILE_RECORDS_USED of Ghmnies.File_Number to liF_Ghmnies
30410>>>//
30410>>>
30410>>>//       //â¢œš®¦ª DF_FILE_MAX_RECORDS+ £œ records used
30410>>>
30410>>>//       //â¢œš®¦ª last rec0 = sysrec rec0
30410>>>
30410>>>    Function_Return 0
30411>>>End_Function //gifSystem_Check
30412>>>
30412>>>/////////////////////////////////////////////////////////////////
30412>>>//‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª, £œ ž ®à¨åª ›œ¡˜› ¡á  JS
30412>>>Function Sfi_All_Numbers Global Number anValue Integer aiLengthAkeraios Integer aiLengthDekadika Returns String
30413>>>
30413>>>    String  lsRetval lsValue lsAkeraios lsDekadika
30414>>>    Integer liInt liInteger iTimes iStart
30414>>>    Number  lnDecimals
30414>>>
30414>>>    Move (Integer(anValue))                                         to liInteger
30415>>>    Move (Round(AnValue-(Integer(anValue))*(10^aiLengthDekadika)))  to lnDecimals
30416>>>
30416>>>    Move liInteger              to lsAkeraios
30417>>>    Move lnDecimals             to lsDekadika
30418>>>    Move (Trim(lsAkeraios))     to lsAkeraios
30419>>>    Move (Trim(lsDekadika))     to lsDekadika
30420>>>
30420>>>    Move (Length(lsAkeraios)) to iStart
30421>>>    For iTimes From iStart to (aiLengthAkeraios-1)
30427>>>>
30427>>>        Insert "0" in lsAkeraios at 1
30429>>>    Loop
30430>>>>
30430>>>    Move (Trim(lsAkeraios)) to lsAkeraios
30431>>>
30431>>>    Move (Length(lsDekadika)) to iStart
30432>>>    For iTimes From iStart to (aiLengthDekadika-1)
30438>>>>
30438>>>        Move (Append(lsDekadika,"0")) to lsDekadika
30439>>>    Loop
30440>>>>
30440>>>    Move (Trim(lsDekadika)) to lsDekadika
30441>>>
30441>>>    If (aiLengthDekadika=0) Move '' to lsDekadika
30444>>>    Move '' to lsRetVal
30445>>>    Move (Pad((lsAkeraios-lsDekadika),(aiLengthAkeraios+aiLengthDekadika))) to lsRetval
30446>>>    Function_Return lsRetval
30447>>>End_Function //sfi_All_Numbers  ‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª
30448>>>              //                 £œ ž ®à¨åª ›œ¡˜› ¡á (JS)
30448>>>
30448>>>Open Codemast
30450>>>
30450>>>
30450>>>Function gsfCode_Mast Global String lsType String lsValue Returns String
30451>>>         Clear Codemast
30452>>>         Move lsType  to Codemast.Type
30453>>>         Move lsValue to Codemast.Code
30454>>>         Find Eq Codemast by Index.1 //type+code
30455>>>>
30455>>>         Function_Return Codemast.Description
30456>>>End_Function //code_mast
30457>>>
30457>>>
30457>>>Open Branch
INCLUDING FILE: BRANCH.FD
30459>>>Function fsgCode_With_Zeroes Global Integer aiCode    ;                                    Integer aiPlaces  ;                                    String asCompany  ;                                    String asBranch   ;                               Returns String
30460>>>    String rVal
30461>>>    Integer iInt
30461>>>    Clear Branch
30462>>>    Move asCompany  to Branch.Company_Code
30463>>>    Move asBranch   to Branch.Branch_Code
30464>>>    Find Eq Branch by Index.1
30465>>>>
30465>>>    If (Trim(Branch.Tomeas_Code)<>'') Move (Trim(Branch.Tomeas_Code)) to asBranch
30468>>>    Move (Trim(asCompany))  to asCompany
30469>>>    Move (Trim(asBranch))   to asBranch
30470>>>    If (Length(asCompany)=1) Insert '0' In asCompany At 1
30474>>>    If (Length(asBranch) =1) Insert '0' In asBranch  At 1
30478>>>    Move ''                                           to rVal
30479>>>    Move (Sfi_All_Numbers(aiCode,aiPlaces,0))         to rVal
30480>>>    Move (Append((asCompany+'.'+asBranch+'.'),rVal))  to rVal
30481>>>    Move (Trim(rVal))                                 to rVal
30482>>>    Function_Return rVal
30483>>>End_Function
30484>>>
30484>>>Function fsgStripCodeFromID Global String asID Returns Integer
30485>>>      Integer iLen iPos iInt
30486>>>      If (Trim(asID)='') Function_Return 0
30489>>>      Move (Trim  (asID)) to asID
30490>>>      Move (Length(asID)) to iLen
30491>>>      For iInt From 1     to iLen
30497>>>>
30497>>>          If (Mid(asID,1,iInt)='.') Move iInt to iPos
30500>>>      Loop
30501>>>>
30501>>>      Function_Return (Right(asID,(iLen-iPos)))
30502>>>End_Function
30503>>>
30503>>>Function fsCityDescr Global Integer aiCityID Returns String
30504>>>    String rVal
30505>>>    Open Cities
INCLUDING FILE: CITIES.FD
30507>>>    Clear Cities
30508>>>    Move aiCityID to Cities.City_ID
30509>>>    Find Eq Cities By Index.1
30510>>>>
30510>>>    If (Found=1) Move Cities.City_descr to rVal
30513>>>    Else         Move '' to rVal
30515>>>    Function_Return rVal
30516>>>End_Function
30517>>>
30517>>>Function fiTownIDFromCity Global Integer aiCityID Returns Integer
30518>>>    Open Cities
30520>>>    Clear Cities
30521>>>    Move aiCityID to Cities.City_ID
30522>>>    Find Eq Cities By Index.1
30523>>>>
30523>>>    Function_Return Cities.Town_ID
30524>>>End_Function
30525>>>
30525>>>Function fiCountryIDFromTown Global Integer aiTownID Returns Integer
30526>>>    Open Towns
INCLUDING FILE: TOWNS.FD
30528>>>    Clear Towns
30529>>>    Move aiTownID to Towns.Town_ID
30530>>>    Find Eq Towns By Index.1
30531>>>>
30531>>>    Function_Return Towns.Country_ID
30532>>>End_Function
30533>>>
30533>>>Function fsTownDescr Global Integer aiTownID Returns String
30534>>>    String rVal
30535>>>    Open Towns
30537>>>    Clear Towns
30538>>>    Move aiTownID to Towns.Town_ID
30539>>>    Find Eq Towns By Index.1
30540>>>>
30540>>>    If (Found=1) Move Towns.Town_descr to rVal
30543>>>    Else         Move '' to rVal
30545>>>    Function_Return rVal
30546>>>End_Function
30547>>>
30547>>>Function fsCountryDescr Global Integer aiCountryID Returns String
30548>>>    String rVal
30549>>>    Open Country
INCLUDING FILE: COUNTRY.FD
30551>>>    Clear Country
30552>>>    Move aiCountryID to Country.Country_ID
30553>>>    Find Eq Country By Index.1
30554>>>>
30554>>>    If (Found=1) Move Country.Country_descr to rVal
30557>>>    Else         Move '' to rVal
30559>>>    Function_Return rVal
30560>>>End_Function
30561>>>
30561>>>Function fsAreaDescr Global Integer aiAreaID Returns String
30562>>>    String rVal
30563>>>    Open Areas
INCLUDING FILE: AREAS.FD
30565>>>    Clear Areas
30566>>>    Move aiAreaID to Areas.Area_ID
30567>>>    Find Eq Areas By Index.1
30568>>>>
30568>>>    If (Found=1) Move Areas.Area_descr to rVal
30571>>>    Else         Move '' to rVal
30573>>>    Function_Return rVal
30574>>>End_Function
30575>>>
30575>>>Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
30576>>>    Local String rVal lsTmp lsOO lsLL
30577>>>    Local Number lnOO lnLL
30577>>>
30577>>>    Move '' to lsOO
30578>>>    Move '' to lsLL
30579>>>    Move '' to rVal
30580>>>
30580>>>    Move (Integer(anTime))                              to lnOO
30581>>>
30581>>>    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
30582>>>
30582>>>    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
30585>>>    Else         Move (String(lnOO))                    to lsOO
30587>>>    Move (Trim(lsOO))                                   to lsOO
30588>>>
30588>>>    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
30591>>>    Else         Move (String(lnLL))                    to lsLL
30593>>>    Move (Trim(lsLL))                                   to lsLL
30594>>>
30594>>>    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
30595>>>
30595>>>    Move (Trim(rVal)) to rVal
30596>>>
30596>>>    Function_Return rVal
30597>>>End_Function
30598>>>
30598>>>Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
30599>>>    Local Number rVal nOres nLepta
30600>>>    Move (Integer(aiMinutes/60))    to nOres
30601>>>    Move (    Mod(aiMinutes,60))    to nLepta
30602>>>    Move (nOres+(nLepta/100))       to rVal
30603>>>    Function_Return rVal
30604>>>End_Function
30605>>>
30605>>>Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
30606>>>    Local Integer rVal
30607>>>    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
30608>>>    Function_Return rVal
30609>>>End_Function
30610>>>
30610>>>Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;                                                                    Number anEndTime    ;                                                                    Returns Integer
30611>>>    Local Integer rVal iMinStart iMinEnd
30612>>>
30612>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30615>>>
30615>>>    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
30616>>>    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
30617>>>    Move (iMinEnd-iMinStart)                                                     to rVal
30618>>>    Function_Return rVal
30619>>>End_Function
30620>>>
30620>>>
30620>>>Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;                                                                Number anEndTime    ;                                                                Returns Number
30621>>>    Local Integer iTmp
30622>>>    Local Number  rVal
30622>>>
30622>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30625>>>
30625>>>    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
30626>>>    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
30627>>>    Function_Return rVal
30628>>>End_Function
30629>>>
30629>>>
30629>>>
30629>>>Open WitemCL
INCLUDING FILE: WITEMCL.FD
30631>>>Open WitemCld
INCLUDING FILE: WITEMCLD.FD
30633>>>Open WitemxT
INCLUDING FILE: WITEMXT.FD
30635>>>
30635>>>Function fnTeleytaiaTimhAgoras String asPromCode String asItemCode  ;                               Date   adHmnia    Number anQty       ;                               Returns Number
30636>>>  Integer iExodos
30637>>>  Number nPoso nPct
30637>>>  Move 0 to nPoso
30638>>>  Move 0 to nPct
30639>>>  Move 0 to iExodos
30640>>>
30640>>>  Move (Trim(asItemCode)) to asItemCode
30641>>>  Move (Trim(asPromCode)) to asPromCode
30642>>>
30642>>>  // 1.Anazhthsh sto arxeio Witemcld
30642>>>  Clear Witemcld
30643>>>  Move asItemCode to Witemcld.Item_Code
30644>>>  Move asPromCode to Witemcld.Client_Code
30645>>>  Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30646>>>>
30646>>>  While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;                       (Witemcld.Client_Code= asPromCode) And ;                       (iExodos=0))
30650>>>      If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
30652>>>          Move 1 to iExodos
30653>>>               If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
30656>>>          Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
30660>>>      End
30660>>>>
30660>>>      Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30661>>>>
30661>>>  Loop
30662>>>>
30662>>>  If (iExodos) Begin
30664>>>      If (nPoso) Function_Return nPoso
30667>>>      Else Function_Return nPct
30669>>>  End
30669>>>>
30669>>>
30669>>>  // 2.Anazhthsh sto arxeio Witemcl
30669>>>  Clear WitemCL
30670>>>  Move (Trim(asPromCode)) to WitemCL.Client_Code
30671>>>  Move (Trim(asItemCode)) to WitemCL.Item_Code
30672>>>  Find Eq WitemCL By Index.1
30673>>>>
30673>>>  If (Found=1) Function_Return WitemCL.Client_Price
30676>>>
30676>>>  Function_Return 0
30677>>>End_Function
30678>>>
30678>>>Open BtnOrdd
INCLUDING FILE: BTNORDD.FD
30680>>>Function fnTeleytaiaTimhPolhshs String asWitemxRecr String asClientID ;                                String asWitemxCode Date   adHmnia    ;                                String asItemCode   Number anQty      ;                                String asCNCode     Returns Number
30681>>>
30681>>>  Integer iExodos iCheckDeop
30682>>>  Number nPoso nPct
30682>>>
30682>>>  Move (Num_Arguments=7) to iCheckDeop
30683>>>
30683>>>  Move 0 to nPoso
30684>>>  Move 0 to nPct
30685>>>  Move 0 to iExodos
30686>>>
30686>>>  Move (Trim(asItemCode))                 to asItemCode
30687>>>  Move (Trim(asClientID))                 to asClientID
30688>>>  Move (Trim(asWitemxRecr))               to asWitemxRecr
30689>>>  Move (Trim(asWitemxCode))               to asWitemxCode
30690>>>  If (iCheckDeop) Move (Trim(asCNCode))   to asCNCode
30693>>>
30693>>>  // 1. Anazhthsh apo DEOP ef' oson yparxei kodikos ergou
30693>>>  If (iCheckDeop) Begin
30695>>>      Clear btnordd
30696>>>      Move asClientID   to btnordd.vclient_id
30697>>>      Move asCNCode     to btnordd.vcn_code
30698>>>      Move asWitemxCode to btnordd.vitem
30699>>>      Move 0            to btnordd.vactive
30700>>>      Move adHmnia      to btnordd.arxh_date
30701>>>      Find LE btnordd by index.4//client_id+cn_code+item+arxh_date
30702>>>>
30702>>>      If ((found=1) and (asWitemxCode=btnordd.vitem)    and (adHmnia>=btnordd.arxh_date) ;                    and (adHmnia<=btnordd.deop_date)    and (btnordd.vactive=0)          ;                    and (asCNCode=btnordd.vcn_code)) begin
30704>>>          move btnordd.vprice to nPoso
30705>>>          If (nPoso) Function_Return nPoso
30708>>>      End
30708>>>>
30708>>>  End
30708>>>>
30708>>>
30708>>>  // 2.Anazhthsh sto arxeio Witemcld (Timokatalogos Pelath/Eidous)
30708>>>  Clear Witemcld
30709>>>  Move asItemCode to Witemcld.Item_Code
30710>>>  Move asClientID to Witemcld.Client_Code
30711>>>  Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30712>>>>
30712>>>  While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;                       (Witemcld.Client_Code= asClientID) And ;                       (iExodos=0))
30716>>>      If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
30718>>>          Move 1 to iExodos
30719>>>               If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
30722>>>          Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
30726>>>      End
30726>>>>
30726>>>      Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30727>>>>
30727>>>  Loop
30728>>>>
30728>>>  If (iExodos) Begin
30730>>>      If (nPoso) Function_Return nPoso
30733>>>      Else Function_Return nPct
30735>>>  End
30735>>>>
30735>>>
30735>>>
30735>>>  // 3.Anazhthsh sto arxeio Witemxt (Timokatalogos Eidous)
30735>>>  Clear Witemxt
30736>>>  Move SysCurXr.Company_Code  to Witemxt.Company_Code
30737>>>  Move SysCurXr.Branch_Code   to Witemxt.Branch_Code
30738>>>  Move SysCurXr.Year_Year     to Witemxt.Year_Year
30739>>>  Move asWitemxRecr           to Witemxt.Witemx_Recr
30740>>>  Find Gt Witemxt By Index.1 // Witemxt:Index.1
30741>>>>
30741>>>  While ((Found=1) And (Witemxt.Company_Code = SysCurXr.Company_Code) And ;                       (Witemxt.Branch_Code  = SysCurXr.Branch_Code ) And ;                       (Witemxt.Year_Year    = SysCurXr.Year_Year   ) And ;                       (Witemxt.Witemx_Recr  = asWitemxRecr         ) And ;                       (iExodos=0))
30745>>>      If ((adHmnia>=Witemxt.Value_Date) And (anQty<=Witemxt.Qty)) Begin
30747>>>          Move 1 to iExodos
30748>>>               If (Witemxt.Axia0 <>0) Move  Witemxt.Axia0         to nPoso
30751>>>          Else If (Witemxt.PcDisc<>0) Move (Witemxt.PcDisc*(-1))  to nPct
30755>>>      End
30755>>>>
30755>>>      Find Gt Witemxt By Index.1 // Witemxt:Index.1
30756>>>>
30756>>>  Loop
30757>>>>
30757>>>  If (iExodos) Begin
30759>>>      If (nPoso) Function_Return nPoso
30762>>>      Else Function_Return nPct
30764>>>  End
30764>>>>
30764>>>
30764>>>
30764>>>  // 4.Anazhthsh sto arxeio Witemcl (Teleytaia Timh Agoras)
30764>>>  Clear WitemCL
30765>>>  Move (Trim(asClientID)) to WitemCL.Client_Code
30766>>>  Move (Trim(asItemCode)) to WitemCL.Item_Code
30767>>>  Find Eq WitemCL By Index.1
30768>>>>
30768>>>  If (Found=1) Function_Return WitemCL.Client_Price
30771>>>
30771>>>  Function_Return 0
30772>>>End_Function
30773>>>
30773>>>Function fsStripTextFieldFromEnter Global String asStr Returns String
30774>>>    String sEnter
30775>>>    Move '' to sEnter
30776>>>    Move (Trim(asStr)) to asStr
30777>>>    Append sEnter (Character(13)) (Character(10))
30779>>>    Move (Replaces(sEnter,asStr,' ')) to asStr
30780>>>    Function_return (Trim(asStr))
30781>>>End_function
30782>>>
30782>>>
30782>>>//end   of global functions and procedures
30782>>>Use Wait.DG
INCLUDING FILE: WAIT.DG
30782>>>>>USE AllEntSc
30782>>>>>
30782>>>>>//AB-IgnoreEnd
30782>>>>>
30782>>>>>
30782>>>>>//AB-IgnoreEnd
30782>>>>>
30782>>>>>Object Wait is a ModalPanelSub
30784>>>>>
30784>>>>>    //AB-StoreTopStart
30784>>>>>
30784>>>>>    // How to Use It
30784>>>>>    // Get the maximum position of the bar
30784>>>>>    // Move (Bar_Maximum_position(Wait(self))) to iMax
30784>>>>>    //
30784>>>>>    // Set the maximum position of the bar
30784>>>>>    // Set Bar_Maximum_position of (Wait(self)) to iMax
30784>>>>>    //
30784>>>>>    // Start Bar Progress from beginning
30784>>>>>    // Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
30784>>>>>    //
30784>>>>>    // End Bar Progress
30784>>>>>    // Send Bar_Current_Position to (Wait(Self)) iMax iMax iMax False
30784>>>>>    //
30784>>>>>    // Update Bar Progress
30784>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax True OR
30784>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax False
30784>>>>>    // When you want the update to be done for every i (this is slower)
30784>>>>>    // Where i=Counter's current value, icounter=Counter's Max Value and iMax=Bar Max Position
30784>>>>>    //
30784>>>>>    // Display Buttons on the object
30784>>>>>    // Set Button_State of (Wait(Self)) to False/True
30784>>>>>    // If the Progress Bar gets initialized without buttons, it MUST be Deactivated
30784>>>>>    //
30784>>>>>    // Initialization of the Progress Bar
30784>>>>>    // Send Popup to (Wait(Self))
30784>>>>>    //
30784>>>>>    // Deactivation of the Progress Bar
30784>>>>>    // Send Deactivate to (Wait(Self))
30784>>>>>    //
30784>>>>>    // Message during the process
30784>>>>>    // Set Wait_Message of (Wait(Self)) to "Now Processing..."
30784>>>>>    //
30784>>>>>    // Extra Info for button "Info >>"
30784>>>>>    // Send Wait_Details to (Wait(Self)) sFile sDetail bInitData
30784>>>>>    // If sFile<>'' then reads the contents of the file
30784>>>>>    // Else Fills the Edit with the string of sDetail
30784>>>>>    // If bInitData is True then the edit object is cleared first else extra info is appended
30784>>>>>    //
30784>>>>>    // Remarks instead of Progress Bar
30784>>>>>    // Set Button_State of (Wait(Self))     to False
30784>>>>>    // Set BarVisibleState of (Wait(Self))  to 'Remarks' False
30784>>>>>    // Update During Process
30784>>>>>    // Send UpdateWait to (Wait(Self)) 'Remarks'
30784>>>>>
30784>>>>>    //AB-StoreTopEnd
30784>>>>>
30784>>>>>    Set Exit_Application_Local_State to FALSE
30785>>>>>    Set Modal_State to FALSE
30786>>>>>    Set Popup_State to TRUE
30787>>>>>    Set Border_Style to Border_Thick
30788>>>>>    Set Minimize_Icon to FALSE
30789>>>>>    Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
30790>>>>>    Set Size to 138 256
30791>>>>>
30791>>>>>    //AB-DDOStart
30791>>>>>
30791>>>>>
30791>>>>>    //AB-DDOEnd
30791>>>>>
30791>>>>>    Object WaitBar is a ProgressBarSub
30793>>>>>
30793>>>>>        //AB-StoreTopStart
30793>>>>>
30793>>>>>        //AB-StoreTopEnd
30793>>>>>
30793>>>>>        Set Size to 21 243
30794>>>>>        Set Location to 7 4
30795>>>>>
30795>>>>>        //AB-StoreStart
30795>>>>>        Send DoRegSize  self smTopRight
30796>>>>>        //AB-StoreEnd
30796>>>>>
30796>>>>>    End_Object
30797>>>>>
30797>>>>>    Object WaitText is a TextBoxSub
30799>>>>>
30799>>>>>        //AB-StoreTopStart
30799>>>>>
30799>>>>>        //AB-StoreTopEnd
30799>>>>>
30799>>>>>        Set Enabled_State to TRUE
30800>>>>>        Set Label to "Processing"
30801>>>>>        Set FontSize to 4 0
30802>>>>>        Set Size to 10 81
30803>>>>>        Set Location to 36 5
30804>>>>>
30804>>>>>        //AB-StoreStart
30804>>>>>
30804>>>>>        //AB-StoreEnd
30804>>>>>
30804>>>>>    End_Object
30805>>>>>
30805>>>>>    Object bnCancel is a ButtonSub
30807>>>>>
30807>>>>>        //AB-StoreTopStart
30807>>>>>
30807>>>>>        //AB-StoreTopEnd
30807>>>>>
30807>>>>>        Set Default_State to TRUE
30808>>>>>        Set Label to "OK"
30809>>>>>        Set Location to 34 143
30810>>>>>
30810>>>>>        //AB-StoreStart
30810>>>>>
30810>>>>>        Procedure OnClick
30812>>>>>             Send Deactivate to (Wait(Self))
30813>>>>>        End_Procedure
30814>>>>>
30814>>>>>        Send DoRegAlign self amTopRight
30815>>>>>        //AB-StoreEnd
30815>>>>>
30815>>>>>    End_Object
30816>>>>>
30816>>>>>    Object bnDetail is a ButtonSub
30818>>>>>
30818>>>>>        //AB-StoreTopStart
30818>>>>>
30818>>>>>        //AB-StoreTopEnd
30818>>>>>
30818>>>>>        Set Focus_Mode to Pointer_Only
30819>>>>>        Set Label to "Info >>"
30820>>>>>        Set Location to 34 197
30821>>>>>
30821>>>>>        //AB-StoreStart
30821>>>>>
30821>>>>>        Procedure OnClick
30823>>>>>            Delegate Send Show_Details False
30825>>>>>        End_Procedure
30826>>>>>
30826>>>>>        Send DoRegAlign self amTopRight
30827>>>>>        //AB-StoreEnd
30827>>>>>
30827>>>>>    End_Object
30828>>>>>
30828>>>>>    Object LineControlSub1 is a LineControlSub
30830>>>>>
30830>>>>>        //AB-StoreTopStart
30830>>>>>
30830>>>>>        //AB-StoreTopEnd
30830>>>>>
30830>>>>>        Set Size to 2 243
30831>>>>>        Set Location to 54 4
30832>>>>>
30832>>>>>        //AB-StoreStart
30832>>>>>
30832>>>>>        Send DoRegSize  self smTopRight
30833>>>>>        //AB-StoreEnd
30833>>>>>
30833>>>>>    End_Object
30834>>>>>
30834>>>>>    Object WaitEdit is a editSub
30836>>>>>
30836>>>>>        //AB-StoreTopStart
30836>>>>>
30836>>>>>        //AB-StoreTopEnd
30836>>>>>
30836>>>>>        Set Enabled_State to FALSE
30837>>>>>        Set Read_Only_State to TRUE
30838>>>>>        Set Size to 58 243
30839>>>>>        Set Location to 60 4
30840>>>>>        Set Color to clWhite
30841>>>>>
30841>>>>>        //AB-StoreStart
30841>>>>>
30841>>>>>        Send DoRegSize Self amBottomRight
30842>>>>>        Delegate Set Size to 66 256
30844>>>>>
30844>>>>>        //AB-StoreEnd
30844>>>>>
30844>>>>>    End_Object
30845>>>>>
30845>>>>>    Object oTxtAntiBar is a TextBoxSub
30847>>>>>        Set Enabled_State to TRUE
30848>>>>>        Set Visible_State to FALSE
30849>>>>>        Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
30850>>>>>        Set Justification_Mode to (jMode_Center IOR jMode_VCenter)
30851>>>>>        Set Auto_Size_State to FALSE
30852>>>>>        Set FontWeight to 600
30853>>>>>        Set FontSize to 4 0
30854>>>>>        Set Size to 10 209
30855>>>>>        Set Location to 10 4
30856>>>>>        Set TextColor to clNavy
30857>>>>>    End_Object
30858>>>>>
30858>>>>>
30858>>>>>    //AB-StoreStart
30858>>>>>    Property Integer piWaitSize  Public (Size(Self))
30860>>>>>    Property Integer piPrevSize  Public (Size(Self))
30862>>>>>    Property Integer piState     Public False
30864>>>>>
30864>>>>>    Set Locate_Mode to Center_On_Screen
30865>>>>>    Set Destroy_Object_State to True
30866>>>>>
30866>>>>>    Procedure Show_Details Integer bAlways
30868>>>>>        Local Integer liOriSize liSize hiSize hiOriSize lowSize bState
30869>>>>>        Local String sLabel
30869>>>>>        Get Size                to liSize
30870>>>>>        Get piState             to bState
30871>>>>>        Get piWaitSize          to liOriSize
30872>>>>>        Move (Hi(liSize))       to hiSize
30873>>>>>        Move (Low(liSize))      to lowSize
30874>>>>>        Move (Hi(liOriSize))    to hiOriSize
30875>>>>>        If (bAlways) Begin
30877>>>>>            Set piState         to False
30878>>>>>            Move 0              to bState
30879>>>>>        End
30879>>>>>>
30879>>>>>        If bState Begin
30881>>>>>             Set Size to hiOriSize lowSize
30882>>>>>             Set Label of (bnDetail(Self)) to "Info >>"
30883>>>>>        End
30883>>>>>>
30883>>>>>        Else Begin
30884>>>>>             Set Size to 138 lowSize
30885>>>>>             Set Label of (bnDetail(Self)) to "<< Info"
30886>>>>>        End
30886>>>>>>
30886>>>>>        Set piState to (1-bState)
30887>>>>>    End_Procedure
30888>>>>>
30888>>>>>    Procedure Bar_Current_Position Integer iCount Integer iOccurances Integer iMaximum Integer bState
30890>>>>>       If (bState) Begin
30892>>>>>         If (Mod(iCount,(iCount*((Number(iMaximum))/(Number(iOccurances)))))=0) ;            Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
30895>>>>>       End
30895>>>>>>
30895>>>>>       Else Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
30897>>>>>    End_Procedure
30898>>>>>
30898>>>>>    Procedure DoInitialize_WaitBar
30900>>>>>        Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
30901>>>>>    End_Procedure
30902>>>>>
30902>>>>>    Procedure DoTerminate_WaitBar
30904>>>>>        Local Integer iMax
30905>>>>>        Get Maximum_position of (WaitBar(Self)) to iMax
30906>>>>>        Send Bar_Current_Position to (Wait(Self)) iMax iMax Imax False
30907>>>>>    End_Procedure
30908>>>>>
30908>>>>>    Procedure Set Bar_Maximum_Position Integer iMaximum
30910>>>>>         Set Maximum_position of (WaitBar(Self)) to iMaximum
30911>>>>>    End_Procedure
30912>>>>>
30912>>>>>    Function Bar_Maximum_Position Returns Integer
30914>>>>>        Function_Return (Maximum_position(WaitBar(Self)))
30915>>>>>    End_Function
30916>>>>>
30916>>>>>    Procedure Set Bar_Minimum_Position Integer iMinimum
30918>>>>>         Set Minimum_position of (WaitBar(Self)) to iMinimum
30919>>>>>    End_Procedure
30920>>>>>
30920>>>>>    Function Bar_Minimum_Position Returns Integer
30922>>>>>        Function_Return (Minimum_position(WaitBar(Self)))
30923>>>>>    End_Function
30924>>>>>
30924>>>>>    Procedure Set Bar_Step_Value Integer iStep
30926>>>>>         Set Step_Value of (WaitBar(Self)) to iStep
30927>>>>>    End_Procedure
30928>>>>>
30928>>>>>    Function Bar_Step_Value Returns Integer
30930>>>>>        Function_Return (Step_Value(WaitBar(Self)))
30931>>>>>    End_Function
30932>>>>>
30932>>>>>    Procedure Set Wait_Message String sMessage
30934>>>>>        Set Value of (WaitText(Self)) to sMessage
30935>>>>>    End_Procedure
30936>>>>>
30936>>>>>    Procedure Wait_Details String sFile String sDetail Integer bInitData
30938>>>>>        Local Integer liEditId
30939>>>>>        Move (WaitEdit(Self)) to liEditId
30940>>>>>        If bInitData Send Delete_Data to liEditId
30943>>>>>        If sFile ne "" Begin
30945>>>>>           Send Read to liEditId sFile
30946>>>>>           Send Beginning_Of_Data to liEditId
30947>>>>>        End
30947>>>>>>
30947>>>>>        Else Begin
30948>>>>>           Send Insert to liEditId sDetail
30949>>>>>        End
30949>>>>>>
30949>>>>>    End_Procedure
30950>>>>>
30950>>>>>    Procedure OnResize
30952>>>>>        Local Integer liSize liHiSize liPrevSize liHiPrevSize bState liHiLoc liLoc
30953>>>>>        Get Size to liPrevSize
30954>>>>>        Move (Hi(liPrevSize)) to liHiPrevSize
30955>>>>>        Forward Send OnResize
30957>>>>>        Get Location of (WaitEdit(Self)) to liLoc
30958>>>>>        Move (Hi(liLoc)) to liHiLoc
30959>>>>>        Get piState to bState
30960>>>>>        Get Size to liSize
30961>>>>>        Move (Hi(liSize)) to liHiSize
30962>>>>>        If (liHiSize > (liHiLoc +30)) Begin
30964>>>>>            Set Value of (bnDetail(Self)) to "<< Info"
30965>>>>>            If (liHiPrevSize <= (liHiLoc +30)) Set piState to (1-bState)
30968>>>>>        End
30968>>>>>>
30968>>>>>        Else Begin
30969>>>>>            Set Value of (bnDetail(Self)) to "Info >>"
30970>>>>>            If (liHiPrevSize > (liHiLoc +30)) Set piState to (1-bState)
30973>>>>>        End
30973>>>>>>
30973>>>>>    End_Procedure
30974>>>>>
30974>>>>>    Procedure Set Button_State Integer bState
30976>>>>>        If bState Begin
30978>>>>>            Set Caption_Bar to True
30979>>>>>            Set Size to 66 256
30980>>>>>        End
30980>>>>>>
30980>>>>>        Else Begin
30981>>>>>            Set Caption_Bar to False
30982>>>>>            Set Size to 38 256
30983>>>>>        End
30983>>>>>>
30983>>>>>    End_Procedure
30984>>>>>
30984>>>>>    Procedure Set BarVisibleState String sMsg Integer bState
30986>>>>>        Set Visible_State of (oTxtAntiBar(Self)) to (bState = 0)
30987>>>>>        Set Visible_State of (WaitBar(Self))     to (bState = 1)
30988>>>>>        If (bState = 0) Begin
30990>>>>>            Set Size to 24 256
30991>>>>>            Set Location of (oTxtAntiBar(Self)) to 6 5
30992>>>>>        End
30992>>>>>>
30992>>>>>        If sMsg ne "" Set Value of (oTxtAntiBar(Self)) to sMsg
30995>>>>>    End_Procedure
30996>>>>>
30996>>>>>    Procedure Deactivating integer search_mode Returns Integer
30998>>>>>        local integer rval
30999>>>>>        Forward Get MSG_Deactivating search_mode to rval
31001>>>>>        Set Modal_State of (Wait(Self)) to False
31002>>>>>        Set BarVisibleState of (Wait(Self)) to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..." True
31003>>>>>        Procedure_Return rval
31004>>>>>    End_Procedure
31005>>>>>
31005>>>>>    Procedure UpdateWait String sMsg
31007>>>>>        Set Value of (oTxtAntiBar(Self)) to sMsg
31008>>>>>    End_Procedure
31009>>>>>
31009>>>>>
31009>>>>>    Procedure Set Horizontal_Justification Integer aiMode
31011>>>>>        Set Justification_Mode of oTxtAntiBar to (jMode_VCenter IOR aiMode)
31012>>>>>    End_Procedure
31013>>>>>
31013>>>>>
31013>>>>>
31013>>>>>
31013>>>>>
31013>>>>>
31013>>>>>    //AB-StoreEnd
31013>>>>>
31013>>>>>End_Object
31014>>>>>
31014>>>>>
31014>>>>>//AB-StoreStart
31014>>>>>
31014>>>>>//AB-StoreEnd
31014>>>>>
31014>>>>>//AB/ End_Object    // prj
31014>>>
31014>Use Calendar.sl
INCLUDING FILE: CALENDAR.SL
31014>>>//AB/ Project Calendar
31014>>>//AB/ Object prj is a Lookup_Project
31014>>>//AB/     Set ProjectName to "Calendar"
31014>>>//AB/     Set ProjectFileName to "Calendar.sl"
31014>>>
31014>>>// Project Object Structure
31014>>>//   oCalendar is a dbModalPanel
31014>>>//     Container3d1 is a Container3d
31014>>>//       Grid2 is a Grid
31014>>>//       Textbox2 is a Textbox
31014>>>//       Textbox3 is a Textbox
31014>>>//       Textbox4 is a Textbox
31014>>>//       Textbox5 is a Textbox
31014>>>//       Textbox6 is a Textbox
31014>>>//       Textbox7 is a Textbox
31014>>>//       Textbox8 is a Textbox
31014>>>//       LineControl1 is a LineControl
31014>>>//       Container3d2 is a Container3d
31014>>>//         oRght is a BitmapContainer
31014>>>//         oLeft is a BitmapContainer
31014>>>//         oMonth is a Textbox
31014>>>//           oSelectMonth is a FloatingPopupMenu
31014>>>//         oYear is a Textbox
31014>>>//         oSelectYear is a Form
31014>>>//     BitmapContainer3 is a BitmapContainer
31014>>>//     oToday is a Textbox
31014>>>
31014>>>// Register all objects
31014>>>Register_Object BitmapContainer3
31014>>>Register_Object Container3d1
31014>>>Register_Object Container3d2
31014>>>Register_Object Grid2
31014>>>Register_Object LineControl1
31014>>>Register_Object oCalendar
31014>>>Register_Object oLeft
31014>>>Register_Object oMonth
31014>>>Register_Object oRght
31014>>>Register_Object oSelectMonth
31014>>>Register_Object oSelectYear
31014>>>Register_Object oToday
31014>>>Register_Object oYear
31014>>>Register_Object Textbox2
31014>>>Register_Object Textbox3
31014>>>Register_Object Textbox4
31014>>>Register_Object Textbox5
31014>>>Register_Object Textbox6
31014>>>Register_Object Textbox7
31014>>>Register_Object Textbox8
31014>>>
31014>>>
31014>>>
31014>>>//AB-StoreTopStart
31014>>>Use dates.utl
INCLUDING FILE: DATES.UTL
31014>>>>>// **********************************************************************
31014>>>>>// Use Dates.utl    // Date manipulation for VDF and DF3.1
31014>>>>>//
31014>>>>>// by Sture Andersen (sa1@vd.dk)
31014>>>>>//
31014>>>>>// The file contains a number of global functions for manipulating
31014>>>>>// dates. The package may be used with DataFlex 3.1 and Visual DataFlex.
31014>>>>>// This package is public domain.
31014>>>>>//
31014>>>>>// The package file is accompanied by a Word document (dfutil.doc)
31014>>>>>// listing the functions and their use.
31014>>>>>//
31014>>>>>//
31014>>>>>// Create: Fri  06-06-1997 - Merger of s_utl020, 021, 022, 023, 024, 025.
31014>>>>>// Update: Thu  26-06-1997 - Fixes for strange behavior when date4_state is set.
31014>>>>>//                         - Addition of popup_calendar to VDF.
31014>>>>>//         Sun  29-06-1997 - Character mode popup calender.
31014>>>>>//         Fri  04-07-1997 - Function WeekToDate added.
31014>>>>>//         Thu  10-07-1997 - Fixes.
31014>>>>>//         Mon  11-08-1997 - WeekToDate fixed.
31014>>>>>//         Sun  24-08-1997 - Character mode popup calender finished.
31014>>>>>//         Mon  15-12-1997 - Procedure Request_Popup_Calendar added.
31014>>>>>//         Mon  29-12-1997 - Procedures ItemYear2to4, ItemDate2to4 and
31014>>>>>//                           ItemSysdate added.
31014>>>>>//         Mon  29-12-1997 - Procedures FieldYear2to4, FieldDate2to4 and
31014>>>>>//                           FieldSysdate added.
31014>>>>>//         Sun  01-02-1998 - Functions Module_Compile_Date and
31014>>>>>//                           Module_Compile_Time added.
31014>>>>>//         Wed  25-02-1998 - Request_Popup in calendar object now only
31014>>>>>//                           responds if entry_state of the calling object
31014>>>>>//                           is true (VDF version). (No apparent effect)
31014>>>>>//         Sat  28-03-1998 - Added the following functions:
31014>>>>>//                             TS_SysTime      TS_ExtractDate
31014>>>>>//                             TS_ExtractTime  TS_ConvertToString
31014>>>>>//         Tue  26-05-1998 - Procedure TS_UI_Update added
31014>>>>>//         Sat  01-08-1998 - mask_date_window taken into account
31014>>>>>//         Mon  10-08-1998 - Functions Module_Start_Date and
31014>>>>>//                           Module_Start_Time added.
31014>>>>>//         Wed  02-09-1998 - Parameter for Module_Start_Date removed
31014>>>>>//         Mon  12-10-1998 - Portuguese added
31014>>>>>//         Wed  04-11-1998 - TS_TimeEstimator class added
31014>>>>>//         Tue  29-12-1998 - Function DateAsString added
31014>>>>>//         Wed  13-01-1999 - Function DateWeekNumber changed according to
31014>>>>>//                           Kjetil Johanson
31014>>>>>//         Mon  18-01-1999 - Function DateWeekNumber changed according to
31014>>>>>//                           Kjetil Johanson (again)
31014>>>>>//         Tue  19-01-1999 - Changed procedure names in TS_TimeEstimator
31014>>>>>//                           class (Continue->TS_Continue and Pause->
31014>>>>>//                           TS_Pause)
31014>>>>>//         Thu  21-01-1999 - Procedures DateFormatAsString and DateFormatName
31014>>>>>//                           added.
31014>>>>>//                         - Procedures DateCurrentSeparator and
31014>>>>>//                           DateCurrentFormat added.
31014>>>>>//         Tue  13-04-1999 - Julian constants added: Jan1st1900, Jan1st2000
31014>>>>>//                           Jan1st1000 and Jan1st100
31014>>>>>//         Mon  26-04-1999 - Changed procedure FieldYear2to4 and ItemYear2to4
31014>>>>>//                           to trap 3 digit years.
31014>>>>>//         Wed  27-04-1999 - Changed Dutch abbriviated day names (to 2 characters)
31014>>>>>//         Sun  02-05-1999 - Added function TS_Compose2
31014>>>>>//                         - Fixed error in TS_ConvertToString
31014>>>>>//         Tue  01-06-1999 - Added procedure popup_no_export to calendar.
31014>>>>>//         Thu  15-06-1999 - Fixed Date4to2 function and exporting dates
31014>>>>>//                           from the calendar to forms with no form_margin.
31014>>>>>//         Tue  07-09-1999 - Added function DateAsText
31014>>>>>//         Wed  27-10-1999 - Temporary fix for Module_Compile_Date function
31014>>>>>//                           in combination with y2k.
31014>>>>>//         Wed  19-12-1999 - Function StringToDate added.
31014>>>>>//                         - Existing function DateAsString renamed to
31014>>>>>//                           DateToString.
31014>>>>>//         Mon  03-01-2000 - Fix for VDF4. Popup calendar on empty date field
31014>>>>>//                           would result in seeding the calendar on year 100.
31014>>>>>//                           This error was caused by the fact that VDF 4
31014>>>>>//                           ignores SYSDATE4_STATE such that the sysdate
31014>>>>>//                           command returns 03-01-100
31014>>>>>//         Wed  01-02-2000 - Define instead of #REPLACE
31014>>>>>//         Wed  23-08-2000 - Function TS_Module_Compile_Time added
31014>>>>>//
31014>>>>>// NOTE:  There is language dependent string constants in this file.
31014>>>>>//        Currently there are sections for dutch, english, danish, swedish,
31014>>>>>//        norwegian, spanish, german and portuguese
31014>>>>>//
31014>>>>>//        These sections may be identified by searching the symbol LNG_DEFAULT
31014>>>>>//
31014>>>>>// ***********************************************************************
31014>>>>>
31014>>>>>Use ui
31014>>>>>Use Language    // Set default languange if not set by compiler command line
INCLUDING FILE: LANGUAGE.PKG
31014>>>>>>>// Use Language     // Default language setup
31014>>>>>>>// Sets default languange if not set by compiler command line
31014>>>>>>>
31014>>>>>>>define lng_dutch      for 131
31014>>>>>>>define lng_french     for 133 // NOT TRANSLATED. DO NOT SELECT!
31014>>>>>>>define lng_spanish    for 134
31014>>>>>>>define lng_italian    for 139 // NOT TRANSLATED. DO NOT SELECT!
31014>>>>>>>define lng_english    for 144
31014>>>>>>>define lng_danish     for 145
31014>>>>>>>define lng_swedish    for 146
31014>>>>>>>define lng_norwegian  for 147
31014>>>>>>>define lng_Greek    for 148
31014>>>>>>>define lng_german     for 149
31014>>>>>>>define lng_portuguese for 155
31014>>>>>>>define lng_papiamentu for 199 // NOT TRANSLATED. DO NOT SELECT!
31014>>>>>>>
31014>>>>>>>
31014>>>>>>>define lng_default for !@
31014>>>>>>>
31014>>>>>>>  define _LANGUAGE_ for $ENGLISH$
31014>>>>>>>
#REM LANGUAGE SET BY LANGUAGE.PKG: $ENGLISH$
31014>>>>>Use Seq_Chnl    // Defines global sequential device management operations (DAC)
31014>>>>>Use Macros.utl  // Various macros (DESKTOP_SECTION)
INCLUDING FILE: MACROS.UTL
31014>>>>>>>// Use Macros.utl   // Various macros (FOR_EX...)
31014>>>>>>>
31014>>>>>>>//  FOR_EX (extended FOR command)
31014>>>>>>>//  -----------------------------
31014>>>>>>>//> The FOR_EX command is exactly like the standard FOR command except
31014>>>>>>>//> that it will allow you to use keyword "DOWN_TO" instead of "TO" if
31014>>>>>>>//> you need to do a decremental loop.
31014>>>>>>>
31014>>>>>>>
31014>>>>>>>//  DESKTOP_SECTION
31014>>>>>>>//  ---------------
31014>>>>>>>//> The DESKTOP_SECTION/END_DESKTOP_SECTION commands will make a sequence of
31014>>>>>>>//> code compile (or rather instantiate) as if it was situated on the DESKTOP
31014>>>>>>>//> even when it isn't. DESKTOP_SECTION's may not be nested.
31014>>>>>>>
31014>>>>>>>
31014>>>>>>>
31014>>>>>
31014>>>>>// Switches
31014>>>>>
31014>>>>>define DATES_INCLUDE_POPUP for 1   // If set to 0 the popup calendar will not be included
31014>>>>>define DATES_DF31B_EPOCH   for 40  // DF3.1b didn't have an epoch setting. Therefore this symbol defines the epoch value for that version.
31014>>>>>
31014>>>>> define t.calendar.year           for "Year"
31014>>>>> define t.calendar.month          for "Month"
31014>>>>> define t.calendar.day            for "Day"
31014>>>>> define t.calendar.week           for "Wk."
31014>>>>> define t.calendar.calendar_popup for "Calendar Popup"
31014>>>>> define t.calendar.Monday         for "Monday"
31014>>>>> define t.calendar.Tuesday        for "Tuesday"
31014>>>>> define t.calendar.Wednesday      for "Wednesday"
31014>>>>> define t.calendar.Thursday       for "Thursday"
31014>>>>> define t.calendar.Friday         for "Friday"
31014>>>>> define t.calendar.Saturday       for "Saturday"
31014>>>>> define t.calendar.Sunday         for "Sunday"
31014>>>>> define t.calendar.January        for "January"
31014>>>>> define t.calendar.February       for "February"
31014>>>>> define t.calendar.March          for "March"
31014>>>>> define t.calendar.April          for "April"
31014>>>>> define t.calendar.May            for "May"
31014>>>>> define t.calendar.June           for "June"
31014>>>>> define t.calendar.July           for "July"
31014>>>>> define t.calendar.August         for "August"
31014>>>>> define t.calendar.September      for "September"
31014>>>>> define t.calendar.October        for "October"
31014>>>>> define t.calendar.November       for "November"
31014>>>>> define t.calendar.December       for "December"
31014>>>>> define t.calendar.ok             for "OK"
31014>>>>> define t.calendar.Cancel         for "Cancel"
31014>>>>> define t.calendar.Activate       for "Activate popup calendar (Ctrl+D)"
31014>>>>>
31014>>>>>define LargestPossibleDate for 913490 // December 31st 2500
31014>>>>>define Jan1st1900          for 693975
31014>>>>>define Jan1st2000          for 730500
31014>>>>>define Jan1st1000          for 365250
31014>>>>>define Jan1st105           for 38352
31014>>>>>define Jan1st100           for 36525
31014>>>>>
31014>>>>>enumeration_list // Date Segments
31014>>>>>  define DS_DAY
31014>>>>>  define DS_WEEK
31014>>>>>  define DS_MONTH
31014>>>>>  define DS_YEAR
31014>>>>>end_enumeration_list
31014>>>>>
31014>>>>>integer Dates$Year Dates$Month Dates$Day // internal use
31014>>>>>
31014>>>>>procedure DateDecompose global date date# //very internal!!
31015>>>>>  local integer pos1# pos2# format#
31016>>>>>  local string str# sep#
31016>>>>>  get_attribute DF_DATE_FORMAT to format#
31019>>>>>  get_attribute DF_DATE_SEPARATOR to pos1# // overload
31022>>>>>  character pos1# to sep#                  // end overload
31023>>>>>>
31023>>>>>  move date# to str#
31024>>>>>  replace sep# in str# with "$"
31026>>>>>  move strmark to pos1#
31027>>>>>  if [found] begin
31029>>>>>    replace sep# in str# with "$"
31031>>>>>    move strmark to pos2#
31032>>>>>  end
31032>>>>>>
31032>>>>>  else begin
31033>>>>>    move 0 to Dates$Year
31034>>>>>    move 0 to Dates$Month
31035>>>>>    move 0 to Dates$Day
31036>>>>>  end
31036>>>>>>
31036>>>>>  [ found] begin
31038>>>>>>
31038>>>>>    if format# eq DF_DATE_EUROPEAN ;          left str# to Dates$Day    (pos1#-1)
31042>>>>>    if format# eq DF_DATE_USA begin
31044>>>>>          mid  str# to Dates$Day    (pos2#-pos1#-1) (pos1#+1)
31047>>>>>>
31047>>>>>          left str# to Dates$Month  (pos1#-1)
31049>>>>>>
31049>>>>>    end
31049>>>>>>
31049>>>>>    else  mid  str# to Dates$Month  (pos2#-pos1#-1) (pos1#+1)
31053>>>>>
31053>>>>>    if format# eq DF_DATE_MILITARY begin
31055>>>>>          mid  str# to Dates$Day  2 (pos2#+1)
31058>>>>>>
31058>>>>>          left str# to Dates$Year   (pos1#-1)
31060>>>>>>
31060>>>>>    end
31060>>>>>>
31060>>>>>    else  mid  str# to Dates$Year 4 (pos2#+1)
31064>>>>>  end
31064>>>>>>
31064>>>>>end_procedure
31065>>>>>
31065>>>>>function DateCompose global integer day# integer month# integer year# returns date
31066>>>>>  local integer format#
31067>>>>>  local date date#
31067>>>>>  local string sep#
31067>>>>>  ifnot (day#*month#*year#) function_return 0
31070>>>>>  get_attribute DF_DATE_SEPARATOR to format# // overload
31073>>>>>  character format# to sep#                  // end overload
31074>>>>>>
31074>>>>>  get_attribute DF_DATE_FORMAT to format#
31077>>>>>  if day# gt 28 begin
31079>>>>>    if format# eq DF_DATE_EUROPEAN move (date(string(day#)+sep#+string(month#)+sep#+string(year#))) to date# // DMY
31082>>>>>    if format# eq DF_DATE_USA      move (date(string(month#)+sep#+string(day#)+sep#+string(year#))) to date# // MDY
31085>>>>>    if format# eq DF_DATE_MILITARY move (date(string(year#)+sep#+string(month#)+sep#+string(day#))) to date# // YMD
31088>>>>>    send DateDecompose date#
31089>>>>>    if Dates$Month ne month# move (day#-Dates$Day) to day#
31092>>>>>  end
31092>>>>>>
31092>>>>>  if format# eq DF_DATE_EUROPEAN function_return (date(string(day#)+sep#+string(month#)+sep#+string(year#))) // DMY
31095>>>>>  if format# eq DF_DATE_USA function_return (date(string(month#)+sep#+string(day#)+sep#+string(year#))) // MDY
31098>>>>>  function_return (date(string(year#)+sep#+string(month#)+sep#+string(day#))) // YMD
31099>>>>>end_function
31100>>>>>
31100>>>>>function DateFormatName global integer format# returns string
31101>>>>>  if format# eq DF_DATE_EUROPEAN function_return "European"
31104>>>>>  if format# eq DF_DATE_USA      function_return "United States"
31107>>>>>  if format# eq DF_DATE_MILITARY function_return "Military"
31110>>>>>end_function
31111>>>>>
31111>>>>>function DateCurrentSeparator global returns string
31112>>>>>  local integer rval#
31113>>>>>  get_attribute DF_DATE_SEPARATOR to rval#
31116>>>>>  function_return (character(rval#))
31117>>>>>end_function
31118>>>>>
31118>>>>>function DateCurrentFormat global returns integer
31119>>>>>  local integer rval#
31120>>>>>  get_attribute DF_DATE_FORMAT to rval#
31123>>>>>  function_return rval#
31124>>>>>end_function
31125>>>>>
31125>>>>>function DateFormatAsString global integer format# integer long# string sep# returns string
31126>>>>>  local string rval# letter#
31127>>>>>  if format# eq DF_DATE_EUROPEAN move "3342241111" to rval#
31130>>>>>  if format# eq DF_DATE_USA      move "2243341111" to rval#
31133>>>>>  if format# eq DF_DATE_MILITARY move "1111422433" to rval#
31136>>>>>  left t.calendar.year to letter# 1
31138>>>>>>
31138>>>>>  replace "1" in rval# with letter#
31140>>>>>  replace "1" in rval# with letter#
31142>>>>>  ifnot long# move "" to letter#
31145>>>>>  move (replaces("1",rval#,letter#)) to rval#
31146>>>>>  move (replaces("2",rval#,left(t.calendar.month,1))) to rval#
31147>>>>>  move (replaces("3",rval#,left(t.calendar.day,1))) to rval#
31148>>>>>  if sep# eq "" begin
31150>>>>>    get_attribute DF_DATE_SEPARATOR to format#
31153>>>>>    character format# to sep#
31154>>>>>>
31154>>>>>  end
31154>>>>>>
31154>>>>>  move (replaces("4",rval#,sep#)) to rval#
31155>>>>>  function_return rval#
31156>>>>>end_function
31157>>>>>
31157>>>>>function StringToDate global string date# integer format# integer four_digit_year# string sep# returns date
31158>>>>>  local integer sep_len# day# month# year#
31159>>>>>  move (length(sep#)) to sep_len#
31160>>>>>  if four_digit_year# move 4 to four_digit_year#
31163>>>>>  else move 2 to four_digit_year#
31165>>>>>  if format# eq DF_DATE_EUROPEAN begin // DMY
31167>>>>>    move (mid(date#,2,1)) to day#
31168>>>>>    move (mid(date#,2,3+sep_len#)) to month#
31169>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31170>>>>>  end
31170>>>>>>
31170>>>>>  if format# eq DF_DATE_USA begin // MDY
31172>>>>>    move (mid(date#,2,1)) to month#
31173>>>>>    move (mid(date#,2,3+sep_len#)) to year#
31174>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31175>>>>>  end
31175>>>>>>
31175>>>>>  if format# eq DF_DATE_MILITARY begin // YMD
31177>>>>>    move (mid(date#,four_digit_year#,1)) to year#
31178>>>>>    move (mid(date#,2,1+four_digit_year#+sep_len#)) to month#
31179>>>>>    move (mid(date#,2,3+four_digit_year#+sep_len#+sep_len#)) to day#
31180>>>>>  end
31180>>>>>>
31180>>>>>  function_return (DateCompose(day#,month#,year#))
31181>>>>>end_function
31182>>>>>
31182>>>>>function DateToString global date date# integer format# integer four_digit_year# string sep# returns string
31183>>>>>  local string rval# day# month# year#
31184>>>>>  get Date2to4 date# to date#
31185>>>>>  if (integer(date#)) begin
31187>>>>>    send DateDecompose date#
31188>>>>>    move Dates$Day to day#
31189>>>>>    if Dates$Day lt 10 insert "0" in day# at 1
31193>>>>>    move Dates$Month to month#
31194>>>>>    if Dates$Month lt 10 insert "0" in month# at 1
31198>>>>>    move Dates$Year to year#
31199>>>>>    ifnot four_digit_year# move (right(year#,2)) to year#
31202>>>>>    if format# eq DF_DATE_EUROPEAN move (day#+sep#+month#+sep#+year#) to rval# // DMY
31205>>>>>    if format# eq DF_DATE_USA      move (month#+sep#+day#+sep#+year#) to rval# // MDY
31208>>>>>    if format# eq DF_DATE_MILITARY move (year#+sep#+month#+sep#+day#) to rval# // YMD
31211>>>>>  end
31211>>>>>>
31211>>>>>  function_return rval#
31212>>>>>end_function
31213>>>>>
31213>>>>>// Function DateAsString is only here for compatibility with earlier versions.
31213>>>>>// Use function DateToString instead.
31213>>>>>function DateAsString global date date# integer format# integer four_digit_year# string sep# returns string
31214>>>>>  function_return (DateToString(date#,format#,four_digit_year#,sep#))
31215>>>>>end_function
31216>>>>>
31216>>>>>function DateIncrement global date date# integer segment# integer amount# returns date
31217>>>>>  if (date#=0) function_return 0
31220>>>>>  if segment# eq DS_WEEK function_return (date#+(amount#*7)) //weeks
31223>>>>>  if (segment#<>DS_DAY) begin // months or years
31225>>>>>    send DateDecompose date#
31226>>>>>    if segment# eq DS_MONTH begin //months
31228>>>>>      move (Dates$Month+amount#) to Dates$Month
31229>>>>>      if amount# ge 0 function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-1)/12)*12),Dates$Year+((Dates$Month-1)/12)))
31232>>>>>      function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-12)/12)*12),Dates$Year+((Dates$Month-12)/12)))
31233>>>>>    end //years:
31233>>>>>>
31233>>>>>    if segment# eq DS_YEAR function_return (DateCompose(Dates$Day,Dates$Month,Dates$Year+amount#))
31236>>>>>  end
31236>>>>>>
31236>>>>>  else function_return (date#+amount#) //days
31238>>>>>end_function
31239>>>>>
31239>>>>>function DateSegment global date date# integer segment# returns integer
31240>>>>>  send DateDecompose date#
31241>>>>>  if segment# eq DS_DAY   function_return Dates$Day
31244>>>>>  if segment# eq DS_MONTH function_return Dates$Month
31247>>>>>  if segment# eq DS_YEAR  function_return Dates$Year
31250>>>>>end_function
31251>>>>>
31251>>>>>function DateToInteger global date date# returns integer
31252>>>>>  send DateDecompose date#
31253>>>>>  function_return (Dates$Year*100+Dates$Month*100+Dates$Day)
31254>>>>>end_function
31255>>>>>
31255>>>>>function FirstDayInMonth global date date# returns date
31256>>>>>  local integer month# year#
31257>>>>>  move (DateSegment(date#,DS_MONTH)) to month#
31258>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31259>>>>>  function_return (DateCompose(1,month#,year#))
31260>>>>>end_function
31261>>>>>
31261>>>>>function LastDayInMonth global date date# returns date
31262>>>>>  move (DateIncrement(date#,DS_MONTH,1)) to date#
31263>>>>>  function_return (FirstDayInMonth(date#)-1)
31264>>>>>end_function
31265>>>>>
31265>>>>>function FirstDayInYear global date date# returns date
31266>>>>>  local integer year#
31267>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31268>>>>>  function_return (DateCompose(1,1,year#))
31269>>>>>end_function
31270>>>>>
31270>>>>>function LastDayInYear global date date# returns date
31271>>>>>  move (DateIncrement(date#,DS_YEAR,1)) to date#
31272>>>>>  function_return (FirstDayInYear(date#)-1)
31273>>>>>end_function
31274>>>>>
31274>>>>>// Prior to 18/1-99 version of DateWeekNumber
31274>>>>>//function DateWeekNumber global date date# returns integer
31274>>>>>//  local integer week# first_wd# day_of_year# year#
31274>>>>>//  if (date#=0) function_return 0
31274>>>>>//  get Date2to4 date# to date#
31274>>>>>//  move (DateSegment(date#,DS_YEAR)) to year#
31274>>>>>//  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31274>>>>>//  move (date#-FirstDayInYear(date#)) to day_of_year#
31274>>>>>//  move (day_of_year#-1-7+first_wd#) to day_of_year#
31274>>>>>//  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31274>>>>>//  else move 0 to week#
31274>>>>>//  if first_wd# le 4 increment week#
31274>>>>>//  if week# gt 52 begin
31274>>>>>//    move 1 to week#
31274>>>>>//    if first_wd# eq 4 move 53 to week#
31274>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31274>>>>>//  end
31274>>>>>//  if week# eq 0 begin
31274>>>>>//    //get DateWeekNumber (DateIncrement(date#,DS_YEAR,-1)) to first_wd# // Original line
31274>>>>>//    get DateDayNumber  (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#ÿ // changed line
31274>>>>>//    move 52 to week#
31274>>>>>//    if first_wd# eq 4 move 53 to week#
31274>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31274>>>>>//  end
31274>>>>>//  function_return week#
31274>>>>>//end_function
31274>>>>>
31274>>>>>function DateWeekNumber global date date# returns integer
31275>>>>>  local integer week# first_wd# day_of_year# year# wd#
31276>>>>>  if (date#=0) function_return 0
31279>>>>>  get Date2to4 date# to date#
31280>>>>>  // Leap-year test for actual or previous year
31280>>>>>  // Year# only used for selection between 52 and
31280>>>>>  // Therefore get year# from the first day of actual week
31280>>>>>  get DateDayNumber date# to wd#
31281>>>>>  move (DateSegment(date#-wd#+1,DS_YEAR)) to year#
31282>>>>>
31282>>>>>  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31283>>>>>  move (date#-FirstDayInYear(date#)) to day_of_year#
31284>>>>>  move (day_of_year#-1-7+first_wd#) to day_of_year#
31285>>>>>  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31288>>>>>  else move 0 to week#
31290>>>>>  if first_wd# le 4 increment week#
31293>>>>>  if week# gt 52 begin
31295>>>>>    move 1 to week#
31296>>>>>    if first_wd# eq 4 move 53 to week#
31299>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31306>>>>>  end
31306>>>>>>
31306>>>>>  if week# eq 0 begin
31308>>>>>    // Week 52 or 53
31308>>>>>    get DateDayNumber (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#
31309>>>>>    move 52 to week#
31310>>>>>    if first_wd# eq 4 move 53 to week#
31313>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31320>>>>>  end
31320>>>>>>
31320>>>>>  function_return week#
31321>>>>>end_function
31322>>>>>
31322>>>>>function DayName global integer int# returns string
31323>>>>>  if int# eq 1 function_return t.calendar.Monday
31326>>>>>  if int# eq 2 function_return t.calendar.Tuesday
31329>>>>>  if int# eq 3 function_return t.calendar.Wednesday
31332>>>>>  if int# eq 4 function_return t.calendar.Thursday
31335>>>>>  if int# eq 5 function_return t.calendar.Friday
31338>>>>>  if int# eq 6 function_return t.calendar.Saturday
31341>>>>>  if int# eq 7 function_return t.calendar.Sunday
31344>>>>>  function_return ""
31345>>>>>end_function
31346>>>>>
31346>>>>>function DateDayNumber global date date# returns integer
31347>>>>>  local integer rval# // 1=Monday, ... , 7=Sunday
31348>>>>>  get Date2to4 date# to date#
31349>>>>>  move date# to rval#
31350>>>>>  if rval# begin
31352>>>>>    if rval# gt 693975 move (rval#-2) to rval#
31355>>>>>    move (rval#-((rval#/7)*7)) to rval#
31356>>>>>    if rval# eq 0 move 7 to rval#
31359>>>>>  end
31359>>>>>>
31359>>>>>  function_return rval#
31360>>>>>end_function
31361>>>>>
31361>>>>>function DateDayName global date date# returns string
31362>>>>>  function_return (DayName(DateDayNumber(date#)))
31363>>>>>end_function
31364>>>>>
31364>>>>>function YearMaxWeek global integer year# returns integer
31365>>>>>  local integer wk1# wk2#
31366>>>>>  get DateWeekNumber (DateCompose(31,12,year#)) to wk1#
31367>>>>>  get DateWeekNumber (DateCompose(24,12,year#)) to wk2#
31368>>>>>  function_return (wk1# max wk2#)
31369>>>>>end_function
31370>>>>>
31370>>>>>function WeekToDate global integer year# integer week# returns date
31371>>>>>  local date date#
31372>>>>>  move (DateCompose(1,1,year#)) to date#
31373>>>>>  if (DateWeekNumber(date#)) ne 1 move (date#+7) to date# // week 52 or 53
31376>>>>>  move (date#-DateDayNumber(date#)+1) to date# // Now it's a Monday
31377>>>>>  function_return (week#-1*7+date#)
31378>>>>>end_function
31379>>>>>
31379>>>>>function MonthName global integer int# returns string
31380>>>>>  if int# eq  1 function_return t.calendar.January
31383>>>>>  if int# eq  2 function_return t.calendar.February
31386>>>>>  if int# eq  3 function_return t.calendar.March
31389>>>>>  if int# eq  4 function_return t.calendar.April
31392>>>>>  if int# eq  5 function_return t.calendar.May
31395>>>>>  if int# eq  6 function_return t.calendar.June
31398>>>>>  if int# eq  7 function_return t.calendar.July
31401>>>>>  if int# eq  8 function_return t.calendar.August
31404>>>>>  if int# eq  9 function_return t.calendar.September
31407>>>>>  if int# eq 10 function_return t.calendar.October
31410>>>>>  if int# eq 11 function_return t.calendar.November
31413>>>>>  if int# eq 12 function_return t.calendar.December
31416>>>>>  function_return ""
31417>>>>>end_function
31418>>>>>
31418>>>>>function DateMonthName global date date# returns string
31419>>>>>  function_return (MonthName(DateSegment(date#,DS_MONTH)))
31420>>>>>end_function
31421>>>>>
31421>>>>>function DateAsText global date date# string format# returns string
31422>>>>>  if date# eq 0 function_return ""
31425>>>>>  move (replace("#DN",format#,DateDayName(date#)))                  to format#
31426>>>>>  move (replace("#MN",format#,DateMonthName(date#)))                to format#
31427>>>>>  move (replace("#D" ,format#,string(DateSegment(date#,DS_DAY))))   to format#
31428>>>>>  move (replace("#Y" ,format#,string(DateSegment(date#,DS_YEAR))))  to format#
31429>>>>>  move (replace("#M" ,format#,string(DateSegment(date#,DS_MONTH)))) to format#
31430>>>>>  function_return format#
31431>>>>>end_function
31432>>>>>
31432>>>>>function Year2to4 global integer year# returns integer
31433>>>>>  local integer epoch_value#
31434>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31435>>>>>  if year# lt 100 begin
31437>>>>>    if year# gt epoch_value# function_return (year#+1900)
31440>>>>>    function_return (year#+2000)
31441>>>>>  end
31441>>>>>>
31441>>>>>  function_return year# // No conversion done!
31442>>>>>end_function
31443>>>>>
31443>>>>>function Date2to4 global date date# returns date
31444>>>>>  local integer epoch_value#
31445>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31446>>>>>  if date# gt 0 begin // Only if there is a date to convert
31448>>>>>    if (DateSegment(date#,DS_YEAR)) lt 105 begin
31450>>>>>      if Dates$Year gt epoch_value# function_return (DateIncrement(date#,DS_YEAR,1900))
31453>>>>>      function_return (DateIncrement(date#,DS_YEAR,2000))
31454>>>>>    end
31454>>>>>>
31454>>>>>    function_return date# // No conversion done!
31455>>>>>  end
31455>>>>>>
31455>>>>>end_function
31456>>>>>
31456>>>>>function Date4to2 global date date# returns date
31457>>>>>  local integer epoch_value# year#
31458>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31459>>>>>  if date# gt 0 begin // Only if there is a date to convert
31461>>>>>    move (DateSegment(date#,DS_YEAR)) to year#
31462>>>>>    if year# ge 100 begin // Only then conversion is needed!
31464>>>>>      if (year#>=(1900+epoch_value#) and year#<(2000+epoch_value#)) begin
31466>>>>>        if year# lt 2000 function_return (DateIncrement(date#,DS_YEAR,-1900))
31469>>>>>        else             function_return (DateIncrement(date#,DS_YEAR,-2000))
31471>>>>>      end
31471>>>>>>
31471>>>>>      else error 301 "Date is out of epoch range"
31473>>>>>    end
31473>>>>>>
31473>>>>>  end
31473>>>>>>
31473>>>>>  function_return date# // No conversion done!
31474>>>>>end_function
31475>>>>>
31475>>>>>function dSysDate global returns date
31476>>>>>  local date date#
31477>>>>>  sysdate4 date#
31478>>>>>  function_return date#
31479>>>>>end_function
31480>>>>>
31480>>>>>function iSysYear global returns integer
31481>>>>>  local date date#
31482>>>>>  sysdate4 date#
31483>>>>>  function_return (DateSegment(date#,DS_YEAR))
31484>>>>>end_function
31485>>>>>
31485>>>>>procedure ItemSysdate for desktop integer itm#
31486>>>>>  local date date#
31487>>>>>  get value item itm# to date#
31488>>>>>  if date# eq 0 begin
31490>>>>>    sysdate4 date#
31491>>>>>    set changed_value item itm# to date#
31492>>>>>  end
31492>>>>>>
31492>>>>>end_procedure
31493>>>>>
31493>>>>>procedure ItemDate2to4 for desktop integer itm#
31494>>>>>  local integer year#
31495>>>>>  local date date# new_date#
31495>>>>>  get value item itm# to date#
31496>>>>>
31496>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31497>>>>>  if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31500>>>>>  else move date# to new_date#
31502>>>>>
31502>>>>>  move (Date2to4(new_date#)) to new_date#
31503>>>>>  move (DateSegment(new_date#,3)) to year#
31504>>>>>  if (year#>99 and year#<1000) begin
31506>>>>>    error 15 // Illegal entry in this window
31507>>>>>>
31507>>>>>    procedure_return 1
31508>>>>>  end
31508>>>>>>
31508>>>>>  if new_date# ne date# set value item itm# to new_date#
31511>>>>>end_procedure
31512>>>>>
31512>>>>>procedure ItemYear2to4 for desktop integer itm#
31513>>>>>  local integer year# new_year#
31514>>>>>  get value item itm# to year#
31515>>>>>  if (year#>99 and year#<1000) begin
31517>>>>>    error 15 // Illegal entry in this window
31518>>>>>>
31518>>>>>    procedure_return 1
31519>>>>>  end
31519>>>>>>
31519>>>>>  move (Year2to4(year#)) to new_year#
31520>>>>>  if new_year# ne year# set value item itm# to new_year#
31523>>>>>end_procedure
31524>>>>>
31524>>>>> procedure FieldSysdate for DataDictionary integer fld#
31525>>>>>   local date date#
31526>>>>>   get field_current_value fld# to date#
31527>>>>>   if date# eq 0 begin
31529>>>>>     sysdate4 date#
31530>>>>>     set field_changed_value fld# to date#
31531>>>>>   end
31531>>>>>>
31531>>>>> end_procedure
31532>>>>>
31532>>>>> procedure FieldDate2to4 for DataDictionary integer fld#
31533>>>>>   local integer year#
31534>>>>>   local date date# new_date#
31534>>>>>   get field_current_value fld# to date#
31535>>>>>
31535>>>>>   move (DateSegment(date#,DS_YEAR)) to year#
31536>>>>>   if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31539>>>>>   else move date# to new_date#
31541>>>>>
31541>>>>>   move (Date2to4(new_date#)) to new_date#
31542>>>>>   move (DateSegment(new_date#,3)) to year#
31543>>>>>   if (year#>99 and year# <=999) begin
31545>>>>>     error 15 // Illegal entry in this window
31546>>>>>>
31546>>>>>     procedure_return 1
31547>>>>>   end
31547>>>>>>
31547>>>>>   if new_date# ne date# set field_changed_value fld# to new_date#
31550>>>>> end_procedure
31551>>>>>
31551>>>>> procedure FieldYear2to4 for DataDictionary integer fld#
31552>>>>>   local integer year# new_year# changed#
31553>>>>>   get field_current_value fld# to year#
31554>>>>>   get field_changed_state fld# to changed#
31555>>>>>   if changed# begin
31557>>>>>     if (year#>99 and year#<1000) begin
31559>>>>>       error 15 // Illegal entry in this window
31560>>>>>>
31560>>>>>       procedure_return 1
31561>>>>>     end
31561>>>>>>
31561>>>>>     move (Year2to4(year#)) to new_year#
31562>>>>>     if new_year# ne year# set field_changed_value fld# to new_year#
31565>>>>>   end
31565>>>>>>
31565>>>>> end_procedure
31566>>>>>
31566>>>>> function SysDate global returns date
31567>>>>>   function_return (dSysDate())
31568>>>>> end_function
31569>>>>>
31569>>>>>function sSysTime global returns string
31570>>>>>  local integer h# m# s#
31571>>>>>  sysdate4 h# h# m# s#
31575>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31576>>>>>end_function
31577>>>>>
31577>>>>>function TS_SysTime global returns number
31578>>>>>  local integer d# h# m# s#
31579>>>>>  sysdate4 d# h# m# s#
31583>>>>>  function_return (d#*24.0+h#*60+m#*60+s#)
31584>>>>>end_function
31585>>>>>
31585>>>>>//> This function returns a TS value composed from the date and time
31585>>>>>//> passed to it. Note that the time variable must be of the format
31585>>>>>//> "hh:mm:ss".
31585>>>>>function TS_Compose global date date# string time# returns number
31586>>>>>  local integer h# m# s#
31587>>>>>  left time# to h# 2
31589>>>>>>
31589>>>>>  mid time# to m# 2 4
31592>>>>>>
31592>>>>>  mid time# to s# 2 7
31595>>>>>>
31595>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31596>>>>>end_function
31597>>>>>
31597>>>>>function TS_Compose2 global date date# integer h# integer m# integer s# returns number
31598>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31599>>>>>end_function
31600>>>>>
31600>>>>>function TS_ExtractDate global number time# returns date
31601>>>>>  function_return (time#/86400) // 86400=24*60*60
31602>>>>>end_function
31603>>>>>
31603>>>>>function TS_ExtractTime global number time# returns string
31604>>>>>  local integer h# m# s#
31605>>>>>  move (time#-(86400.0*integer(TS_ExtractDate(time#)))) to s#
31606>>>>>  move (s#/3600) to h#
31607>>>>>  move (s#-(h#*3600)) to s#
31608>>>>>  move (s#/60) to m#
31609>>>>>  move (s#-(m#*60)) to s#
31610>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31611>>>>>end_function
31612>>>>>
31612>>>>>function TS_ConvertToString global number time# returns string
31613>>>>>  local date d#
31614>>>>>  move (TS_ExtractDate(time#)) to d#
31615>>>>>  if (integer(d#)) function_return (string(d#)+" "+TS_ExtractTime(time#))
31618>>>>>  else function_return (TS_ExtractTime(time#))
31620>>>>>end_function
31621>>>>>
31621>>>>>function TS_ConvertToStringNoDate global number ts# returns string
31622>>>>>  local integer h# m#
31623>>>>>  move (ts#/3600) to h#
31624>>>>>  move (ts#-(h#*3600)) to ts#
31625>>>>>  move (ts#/60) to m#
31626>>>>>  move (ts#-(m#*60)) to ts#
31627>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(ts#<10,"0","")+string(ts#))
31628>>>>>end_function
31629>>>>>
31629>>>>>// This procedure is used when a TS-variable must be displayed on screen.
31629>>>>>procedure TS_UI_Update global number TS# integer obj1# integer itm1# integer tmp_obj2# integer tmp_itm2#
31630>>>>>  local integer obj2# itm2#
31631>>>>>  if num_arguments gt 3 begin
31633>>>>>    move tmp_obj2# to obj2#
31634>>>>>    move tmp_itm2# to itm2#
31635>>>>>  end
31635>>>>>>
31635>>>>>  else begin
31636>>>>>    move obj1# to obj2#
31637>>>>>    move (itm1#+1) to itm2#
31638>>>>>  end
31638>>>>>>
31638>>>>>  set value of obj1# item itm1# to (TS_ExtractDate(TS#))
31639>>>>>  set value of obj2# item itm2# to (TS_ExtractTime(TS#))
31640>>>>>end_procedure
31641>>>>>
31641>>>>>class TS_TimeEstimator is an array
31642>>>>>  procedure construct_object
31643>>>>>    forward send construct_object
31645>>>>>    set delegation_mode to delegate_to_parent
31646>>>>>    property number  pnTotal   public 0 // Seconds needed to run the loop.
31647>>>>>    property number  pnElapsed public 0 // Seconds elapsed so far.
31648>>>>>    property number  pnLeft    public 0 // Number of seconds left
31649>>>>>    property number  pnStart   public 0
31650>>>>>    property number  pnPause   public 0
31651>>>>>    property number  pnPercent public 0
31652>>>>>    property integer piMin     public 0
31653>>>>>    property integer piMax     public 0
31654>>>>>  end_procedure
31655>>>>>
31655>>>>>  procedure TS_Start integer min# integer max#
31656>>>>>    set piMin to min#
31657>>>>>    set piMax to max#
31658>>>>>    set pnStart to (TS_SysTime())
31659>>>>>    set pnElapsed to 0
31660>>>>>    set pnPercent to 0
31661>>>>>  end_procedure
31662>>>>>
31662>>>>>  procedure TS_Calculate integer pos#
31663>>>>>    local integer min# max#
31664>>>>>    get piMin to min#
31665>>>>>    get piMax to max#
31666>>>>>    set pnElapsed to (TS_SysTime()-pnStart(current_object))
31667>>>>>    set pnTotal   to (pnElapsed(current_object)*(max#-min#)/number(pos#-min#))
31668>>>>>    set pnLeft    to (pnTotal(current_object)-pnElapsed(current_object))
31669>>>>>    set pnPercent to (100.0*(pos#-min#)/(max#-min#))
31670>>>>>  end_procedure
31671>>>>>
31671>>>>>  procedure TS_Pause
31672>>>>>    set pnPause to (TS_SysTime())
31673>>>>>  end_procedure
31674>>>>>
31674>>>>>  procedure TS_Continue
31675>>>>>    set pnStart to (pnStart(current_object)+TS_SysTime()-pnPause(current_object))
31676>>>>>  end_procedure
31677>>>>>end_class
31678>>>>>
31678>>>>>function TS_Module_Compile_Time global string path# returns number
31679>>>>>  local integer pos# day# month# year# seqeof# ch#
31680>>>>>  local string date# str# time#
31680>>>>>  move path# to str#
31681>>>>>  if str# ne "" begin
31683>>>>>    get Seq_New_Channel to ch#   // This method and Seq_Release_Channel are
31684>>>>>    send Seq_Release_Channel ch# // We only need it for a second
31685>>>>>      direct_input channel ch# (trim(str#)+".vd6") // VDF 6
31687>>>>>      [seqeof] direct_input channel ch# (trim(str#)+".vd5") // VDF 5
31689>>>>>    [ seqeof] move 1 to seqeof#
31690>>>>>    [~seqeof] move 0 to seqeof#
31691>>>>>    [~seqeof] readln str#
31692>>>>>    close_input channel ch#
31694>>>>>  end
31694>>>>>>
31694>>>>>  if seqeof# function_return 0
31697>>>>>  pos "," in str# to pos#
31699>>>>>>
31699>>>>>  move (mid(str#,18,pos#+2)) to str#
31700>>>>>  move (integer(mid(str#,2,4))) to day#
31701>>>>>  move (integer(mid(str#,2,1))) to month#
31702>>>>>  move (integer(mid(str#,2,7))) to year#
31703>>>>>  if year# eq 10 begin
31705>>>>>    move (integer(mid(str#,3,7))+1900) to year#
31706>>>>>    move (mid(str#,8,11)) to str#
31707>>>>>  end
31707>>>>>>
31707>>>>>  else move (mid(str#,8,10)) to str#
31709>>>>>  move (DateCompose(day#,month#,year#)) to date#
31710>>>>>  move (Date2to4(date#)) to date#
31711>>>>>  pos ":" in str# to pos#
31713>>>>>>
31713>>>>>  function_return (TS_Compose(date#,mid(str#,8,pos#-2)))
31714>>>>>end_function
31715>>>>>
31715>>>>>string Dates$Module_Compile_Time
31715>>>>>move "" to Dates$Module_Compile_Time
31716>>>>>
31716>>>>>function Module_Compile_Date global returns date
31717>>>>>  local number ts#
31718>>>>>  local string str#
31718>>>>>  get module_name to str# // 'module_name' is most likely the name of the .flx file.
31719>>>>>  get TS_Module_Compile_Time str# to ts#
31720>>>>>  move (TS_ExtractTime(ts#)) to Dates$Module_Compile_Time
31721>>>>>  function_return (TS_ExtractDate(ts#))
31722>>>>>end_function
31723>>>>>
31723>>>>>function Module_Compile_Time global returns string
31724>>>>>  local date grb#
31725>>>>>  // Module_Compile_Date must be called before this one!
31725>>>>>  if Dates$Module_Compile_Time eq "" move (Module_Compile_Date()) to grb#
31728>>>>>  function_return Dates$Module_Compile_Time
31729>>>>>end_function
31730>>>>>
31730>>>>>date   Dates$ModuleStartDate
31730>>>>>string Dates$ModuleStartTime 8
31730>>>>>move (dSysDate()) to Dates$ModuleStartDate
31731>>>>>move (sSysTime()) to Dates$ModuleStartTime
31732>>>>>
31732>>>>>function Module_Start_Date global returns date
31733>>>>>  function_return Dates$ModuleStartDate
31734>>>>>end_function
31735>>>>>
31735>>>>>function Module_Start_Time global returns string
31736>>>>>  function_return Dates$ModuleStartTime
31737>>>>>end_function
31738>>>>>
31738>>>>> register_procedure NotifyPopupCalendarChange date date#
31738>>>>> register_procedure NotifyPopupCalendarSelect date date#
31738>>>>>  use dfAllent
31738>>>>>  class calendar.textbox is a textbox
31739>>>>>    procedure construct_object
31740>>>>>      forward send construct_object
31742>>>>>      Set Auto_Size_State To False
31743>>>>>      Set Justification_Mode To (jMode_vCenter+jMode_Center)
31744>>>>>    end_procedure
31745>>>>>  end_class
31746>>>>>
31746>>>>>  register_object btn1
31746>>>>>  register_object btn6
31746>>>>>
31746>>>>>  class calendar.button is a button
31747>>>>>
31747>>>>>    procedure construct_object
31748>>>>>      forward send construct_object
31750>>>>>      set size to 15 18
31751>>>>>      on_key kleftarrow   send prev_day
31752>>>>>      on_key krightarrow  send next_day
31753>>>>>      on_key kuparrow     send prev_week
31754>>>>>      on_key kdownarrow   send next_week
31755>>>>>      property date p_assigned_date public 0
31756>>>>>    end_procedure
31757>>>>>
31757>>>>>    procedure switch // This makes all 42 buttons act as if they are one focus
31758>>>>>      send activate to (btn1(current_object))
31759>>>>>    end_procedure
31760>>>>>    procedure switch_back
31761>>>>>      send activate to (btn6(current_object))
31762>>>>>    end_procedure
31763>>>>>
31763>>>>>    procedure mouse_down
31764>>>>>      local integer current_object#
31765>>>>>      forward send mouse_down
31767>>>>>      move current_object to current_object#
31768>>>>>      delegate set p_current_date to (p_assigned_date(current_object#))
31770>>>>>    end_procedure
31771>>>>>  end_class
31772>>>>>
31772>>>>>  desktop_section
31778>>>>>    object popup_calendar is a ModalPanel
31780>>>>>      set size to 160 250
31781>>>>>      property date    p_current_date  public 0
31783>>>>>      property integer p_current_year  public -1
31785>>>>>      property integer p_current_month public -1
31787>>>>>      property integer pExportState    public 1
31789>>>>>
31789>>>>>      on_key key_ctrl+key_pgup send prev_year
31790>>>>>      on_key key_ctrl+key_pgdn send next_year
31791>>>>>      on_key          key_pgup send prev_month
31792>>>>>      on_key          key_pgdn send next_month
31793>>>>>      on_key key_ctrl+key_d    send go_today
31794>>>>>      on_key kcancel           send cancel
31795>>>>>
31795>>>>>      object cont3d is a container3d
31797>>>>>        set location to 5 5
31798>>>>>        set size to 120 237
31799>>>>>        object textbox_year is a calendar.textbox
31801>>>>>          set location to 5 5
31802>>>>>          set size to 15 30
31803>>>>>          set border_style to border_staticedge
31804>>>>>          procedure display
31806>>>>>            set value to (p_current_year(current_object))
31807>>>>>          end_procedure
31808>>>>>        end_object
31809>>>>>        object dayname_header is a container3d
31811>>>>>          set location to 5 39
31812>>>>>          set size to 15 126
31813>>>>>          set border_style to border_staticedge
31814>>>>>          procedure initialize
31816>>>>>            local integer itm#
31817>>>>>            for itm# from 0 to 6
31823>>>>>>
31823>>>>>              object txt is a calendar.textbox
31825>>>>>                set size to 12 17
31826>>>>>                set location to 0 (itm#*17.6+1)
31827>>>>>                 set value to (left(DayName(itm#+1),3))
31828>>>>>              end_object
31829>>>>>            loop
31830>>>>>>
31830>>>>>          end_procedure
31831>>>>>          send initialize
31832>>>>>        end_object
31833>>>>>        object weeknumber_header is a container3d
31835>>>>>          set location to 24 5
31836>>>>>          set size     to 89 30
31837>>>>>          set border_style to border_staticedge
31838>>>>>          object obj_id_array is an array
31840>>>>>          end_object
31841>>>>>          procedure initialize
31843>>>>>            local integer itm# obj#
31844>>>>>            move (obj_id_array(current_object)) to obj#
31845>>>>>            for itm# from 0 to 5
31851>>>>>>
31851>>>>>              object txt is a textbox
31853>>>>>                set size to 15 30
31854>>>>>                set location to (itm#*15+1) 1
31855>>>>>                set value of obj# item (item_count(obj#)) to current_object
31856>>>>>              end_object
31857>>>>>            loop
31858>>>>>>
31858>>>>>          end_procedure
31859>>>>>          procedure display
31861>>>>>            local integer itm# obj#
31862>>>>>            local date date# last_date#
31862>>>>>            move (obj_id_array(current_object)) to obj#
31863>>>>>            get p_current_date to date#
31864>>>>>            move (FirstDayInMonth(date#)) to date#
31865>>>>>            move (LastDayInMonth(date#)) to last_date#
31866>>>>>            move (date#-DateDayNumber(date#)+1) to date#
31867>>>>>            for itm# from 0 to 5
31873>>>>>>
31873>>>>>              if (itm#*7+date#) le last_date# ;                set value of (integer(value(obj#,itm#))) to (t.calendar.week*string(DateWeekNumber(itm#*7+date#)))
31876>>>>>              else set value of (integer(value(obj#,itm#))) to ""
31878>>>>>            loop
31879>>>>>>
31879>>>>>          end_procedure
31880>>>>>          send initialize
31881>>>>>        end_object
31882>>>>>        object days_grid is a container3d
31884>>>>>          set location to 23 39
31885>>>>>          set size     to 100 127
31886>>>>>          set border_style to border_none
31887>>>>>          object btn_array is an array
31889>>>>>          end_object
31890>>>>>          procedure initialize
31892>>>>>            local integer row# col# button_array#
31893>>>>>            move (btn_array(current_object)) to button_array#
31894>>>>>            for row# from 0 to 5
31900>>>>>>
31900>>>>>              for col# from 0 to 6
31906>>>>>>
31906>>>>>                object btn is a calendar.button
31908>>>>>                  set location to (row#*15) (col#*18)
31909>>>>>                  set value of button_array# item (item_count(button_array#)) to current_object
31910>>>>>                  on_item "" send move_value_out_ok
31911>>>>>                end_object
31912>>>>>              loop
31913>>>>>>
31913>>>>>            loop
31914>>>>>>
31914>>>>>          end_procedure
31915>>>>>          send initialize
31916>>>>>
31916>>>>>          procedure display.iii integer itm# integer day# integer activate#
31918>>>>>            local integer obj# current_day#
31919>>>>>            move (integer(value(btn_array(current_object),itm#))) to obj#
31920>>>>>            move (DateSegment(p_current_date(current_object),DS_DAY)) to current_day#
31921>>>>>            if activate# begin
31923>>>>>              if day# eq current_day# send activate to obj#
31926>>>>>            end
31926>>>>>>
31926>>>>>            else begin
31927>>>>>              if day# begin
31929>>>>>                set value of obj# to day#
31930>>>>>                set visible_state of obj# to true
31931>>>>>                set p_assigned_date of obj# to (DateCompose(day#,p_current_month(current_object),p_current_year(current_object)))
31932>>>>>              end
31932>>>>>>
31932>>>>>              else set visible_state of obj# to false
31934>>>>>            end
31934>>>>>>
31934>>>>>          end_procedure
31935>>>>>
31935>>>>>          procedure display integer activate#
31937>>>>>            local integer first_item# last_item# itm# day# date#
31938>>>>>            get p_current_date to date#
31939>>>>>            move (FirstDayInMonth(date#)) to date#
31940>>>>>            move (DateDayNumber(date#)-1) to first_item#
31941>>>>>            move (LastDayInMonth(date#)-date#+first_item#) to last_item#
31942>>>>>            ifnot activate# begin
31944>>>>>              for itm# from 0 to (first_item#-1)
31950>>>>>>
31950>>>>>                send display.iii itm# 0 0
31951>>>>>              loop
31952>>>>>>
31952>>>>>            end
31952>>>>>>
31952>>>>>            move 1 to day#
31953>>>>>            for itm# from first_item# to last_item#
31959>>>>>>
31959>>>>>              send display.iii itm# day# activate#
31960>>>>>              increment day#
31961>>>>>            loop
31962>>>>>>
31962>>>>>            ifnot activate# begin
31964>>>>>              for itm# from (last_item#+1) to 41
31970>>>>>>
31970>>>>>                send display.iii itm# 0 0
31971>>>>>              loop
31972>>>>>>
31972>>>>>            end
31972>>>>>>
31972>>>>>          end_procedure
31973>>>>>        end_object
31974>>>>>        object txt_month is a calendar.textbox
31976>>>>>          set size to 12 27
31977>>>>>          set location to 25 185
31978>>>>>          set value to t.calendar.month
31979>>>>>        end_object
31980>>>>>        object btn1 is a button
31982>>>>>          set size to 12 12
31983>>>>>          set location to 40 185
31984>>>>>          on_item "" send prev_month
31985>>>>>          set bitmap to "prev.bmp"
31986>>>>>          procedure switch_back
31988>>>>>            send display_main
31989>>>>>          end_procedure
31990>>>>>        end_object
31991>>>>>        object btn2 is a button
31993>>>>>          set size to 12 12
31994>>>>>          set location to 40 200
31995>>>>>          on_item "" send next_month
31996>>>>>          set bitmap to "next.bmp"
31997>>>>>        end_object
31998>>>>>        object txt_year is a calendar.textbox
32000>>>>>          set size to 12 27
32001>>>>>          set location to 70 185
32002>>>>>          set value to t.calendar.year
32003>>>>>        end_object
32004>>>>>        object btn3 is a button
32006>>>>>          set size to 12 12
32007>>>>>          set location to 85 185
32008>>>>>          on_item "" send prev_year
32009>>>>>          set bitmap to "prev.bmp"
32010>>>>>        end_object
32011>>>>>        object btn4 is a button
32013>>>>>          set size to 12 12
32014>>>>>          set location to 85 200
32015>>>>>          on_item "" send next_year
32016>>>>>          set bitmap to "next.bmp"
32017>>>>>        end_object
32018>>>>>      end_object
32019>>>>>      object btn5 is a button
32021>>>>>        set size to 14 60
32022>>>>>        set location to 129 115
32023>>>>>        on_item t.calendar.ok send move_value_out_ok
32024>>>>>      end_object
32025>>>>>      object btn6 is a button
32027>>>>>        set size to 14 60
32028>>>>>        set location to 129 182
32029>>>>>        on_item t.calendar.cancel send cancel
32030>>>>>        procedure switch
32032>>>>>          send display_main
32033>>>>>        end_procedure
32034>>>>>      end_object
32035>>>>>      procedure next_year
32037>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32038>>>>>        send display_main
32039>>>>>      end_procedure
32040>>>>>      procedure prev_year
32042>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32043>>>>>        send display_main
32044>>>>>      end_procedure
32045>>>>>      procedure next_month
32047>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32048>>>>>        send display_main
32049>>>>>      end_procedure
32050>>>>>      procedure prev_month
32052>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32053>>>>>        send display_main
32054>>>>>      end_procedure
32055>>>>>      procedure next_week
32057>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,1))
32058>>>>>        send display_main
32059>>>>>      end_procedure
32060>>>>>      procedure prev_week
32062>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,-1))
32063>>>>>        send display_main
32064>>>>>      end_procedure
32065>>>>>      procedure next_day
32067>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,1))
32068>>>>>        send display_main
32069>>>>>      end_procedure
32070>>>>>      procedure prev_day
32072>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,-1))
32073>>>>>        send display_main
32074>>>>>      end_procedure
32075>>>>>      procedure go_today
32077>>>>>        local date date#
32078>>>>>        sysdate4 date#
32079>>>>>        set p_current_date to date#
32080>>>>>        send display_main
32081>>>>>      end_procedure
32082>>>>>      property integer invoking_object_id public 0
32084>>>>>      procedure OnChange date date#
32086>>>>>        local integer focus# dm#
32087>>>>>        get invoking_object_id to focus#
32088>>>>>        if focus# gt desktop begin
32090>>>>>          get delegation_mode of focus# to dm#
32091>>>>>          set delegation_mode of focus# to no_delegate_or_error
32092>>>>>          send NotifyPopupCalendarChange to focus# date#
32093>>>>>          set delegation_mode of focus# to dm#
32094>>>>>        end
32094>>>>>>
32094>>>>>      end_procedure
32095>>>>>      procedure display
32097>>>>>        local integer date# month# year#
32098>>>>>        get p_current_date to date#
32099>>>>>        send OnChange date#
32100>>>>>        move (DateSegment(date#,DS_YEAR)) to year#
32101>>>>>        move (DateSegment(date#,DS_MONTH)) to month#
32102>>>>>        if (p_current_year(current_object)<>year# or p_current_month(current_object)<>month#) begin
32104>>>>>          set p_current_year to year#
32105>>>>>          set p_current_month to month#
32106>>>>>          set value to (t.calendar.calendar_popup+", "+MonthName(month#))
32107>>>>>          send display to (textbox_year(cont3d(current_object)))
32108>>>>>          send display to (weeknumber_header(cont3d(current_object)))
32109>>>>>          send display to (days_grid(cont3d(current_object))) 0
32110>>>>>        end
32110>>>>>>
32110>>>>>      end_procedure
32111>>>>>      procedure display_main
32113>>>>>        send display
32114>>>>>        send display to (days_grid(cont3d(current_object))) 1
32115>>>>>      end_procedure
32116>>>>>      procedure popup_no_export
32118>>>>>        set pExportState to false
32119>>>>>        send popup
32120>>>>>        set pExportState to true
32121>>>>>      end_procedure
32122>>>>>
32122>>>>>      procedure popup_group
32124>>>>>        local integer focus#
32125>>>>>        local date date#
32125>>>>>        move (focus(desktop)) to focus#
32126>>>>>        set invoking_object_id to focus#
32127>>>>>        get value of focus# item current to date#
32128>>>>>        ifnot (integer(date#)) move (dSysdate()) to date#
32131>>>>>        move (Date2to4(date#)) to date#
32132>>>>>        set p_current_date to date#
32133>>>>>        send display
32134>>>>>        forward send popup_group
32136>>>>>        send display to (days_grid(cont3d(current_object))) 1
32137>>>>>      end_procedure
32138>>>>>
32138>>>>>      procedure move_value_out
32140>>>>>        local integer focus# dm# margin# datatype#
32141>>>>>        if (pExportState(current_object)) begin
32143>>>>>          get invoking_object_id to focus#
32144>>>>>          if focus# gt desktop begin
32146>>>>>            get delegation_mode of focus# to dm#
32147>>>>>            set delegation_mode of focus# to no_delegate_or_error
32148>>>>>            send NotifyPopupCalendarSelect to focus# (p_current_date(current_object))
32149>>>>>            get form_margin of focus# item current to margin#
32150>>>>>            get form_datatype of focus# item current to datatype#
32151>>>>>            set delegation_mode of focus# to dm#
32152>>>>>            if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to (p_current_date(current_object))
32155>>>>>            else             set value of focus# item current to (Date4to2(p_current_date(current_object)))
32157>>>>>            set item_changed_state of focus# item current to true
32158>>>>>          end
32158>>>>>>
32158>>>>>        end
32158>>>>>>
32158>>>>>      end_procedure
32159>>>>>
32159>>>>>      procedure move_value_out_ok
32161>>>>>        send move_value_out
32162>>>>>        send deactivate
32163>>>>>      end_procedure
32164>>>>>
32164>>>>>      procedure request_popup
32166>>>>>        local integer focus# type# dm#
32167>>>>>        move (focus(desktop)) to focus#
32168>>>>>        if focus# gt desktop begin
32170>>>>>          get delegation_mode of focus# to dm#
32171>>>>>          set delegation_mode of focus# to no_delegate_or_error
32172>>>>>          get form_datatype of focus# item current to type#
32173>>>>>          if (type#=date_window or type#=mask_date_window) send popup
32176>>>>>          set delegation_mode of focus# to dm#
32177>>>>>        end
32177>>>>>>
32177>>>>>      end_procedure
32178>>>>>    end_object
32179>>>>>  end_desktop_section
32181>>>>>  // If the procedure below was not defined "for BaseClass" its symbolic
32181>>>>>  // substitute would become negative (because located on the desktop). This
32181>>>>>  // would result in the toolbar object not being able to handle it. Therefore:
32181>>>>>  procedure request_popup_calendar for BaseClass
32182>>>>>    send request_popup to (popup_calendar(current_object))
32183>>>>>  end_procedure
32184>>>>>  procedure popup_calendar_no_export
32185>>>>>    send popup_no_export to (popup_calendar(current_object))
32186>>>>>  end_procedure
32187>>>>>  register_procedure Add_Toolbar_Button_Bitmap string bmp# string Tip# string StHlp# integer msg# integer obj#
32187>>>>>  procedure Add_Calendar_tbButton integer oTb#
32188>>>>>    send Add_Toolbar_Button_Bitmap to oTb# "DfCalend.bmp" t.calendar.calendar_popup t.calendar.Activate msg_request_popup_calendar
32189>>>>>  end_procedure
32190>>>>> function s.calendar returns integer // Backwards compatible!!
32191>>>>>   function_return (popup_calendar(current_object))
32192>>>>> end_function
32193>>>>>
32193>>>>>// Karl,
32193>>>>>// Structure is as follows,
32193>>>>>//
32193>>>>>// //put this code in the top portion of the view code or in the program
32193>>>>>// code.
32193>>>>>//
32193>>>>>// Type SystemTime
32193>>>>>//   field SystemTime.iYear As Word
32193>>>>>//   field SystemTime.iMonth As Word
32193>>>>>//   field SystemTime.iDayOfWeek As Word
32193>>>>>//   field SystemTime.iDay As Word
32193>>>>>//   field SystemTime.iHour As Word
32193>>>>>//   field SystemTime.iMinute As Word
32193>>>>>//   field SystemTime.iSecond As Word
32193>>>>>//   field SystemTime.iMilliseconds As Word
32193>>>>>// End_Type
32193>>>>>//
32193>>>>>// external_function GetSystemTime "GetSystemTime" kernel32.dll Pointer lpGST Returns VOID_TYPE
32193>>>>>//
32193>>>>>// //put this code in an onClick or wherever
32193>>>>>// procedure onclick
32193>>>>>//   local integer iRetVal
32193>>>>>//   local string TimeData
32193>>>>>//   local pointer GST
32193>>>>>//
32193>>>>>//   ZeroType SystemTime to TimeData
32193>>>>>//   getAddress from TimeData to GST
32193>>>>>//
32193>>>>>//   move (GetSystemTime(GST)) to iRetVal
32193>>>>>// end_procedure
32193>>>>>//
32193>>>>>// To extract the data from the Structure after calling the function use
32193>>>>>// the getbuff command as follows:
32193>>>>>//
32193>>>>>// getbuff from TimeData as SystemTime.IVAL to var
32193>>>>>//
32193>>>>>// where IVAL is one of the vars such as iYear or iDay, etc.
32193>>>>>//
32193>>>>>// OLIVER NELSON
32193>>>>>//
32193>>>>>//
32193>>>
32193>>>//AB-StoreTopEnd
32193>>>
32193>>>//AB-IgnoreStart
32193>>>
32193>>>Use DFAllEnt.pkg
32193>>>
32193>>>
32193>>>//AB-IgnoreEnd
32193>>>
32193>>>CD_Popup_Object oCalendar is a dbModalPanel
32212>>>
32212>>>    //AB-StoreTopStart
32212>>>    on_key kcancel           send cancel
32213>>>    //AB-StoreTopEnd
32213>>>
32213>>>    Set Border_Style to Border_Normal
32214>>>    Set Caption_Bar to FALSE
32215>>>    Set Label to "Ÿ­¢ àì, 2001"
32216>>>    Set Size to 98 123
32217>>>    Set Location to 10 22
32218>>>    Set Color to clWhite
32219>>>
32219>>>    //AB-DDOStart
32219>>>
32219>>>
32219>>>    //AB-DDOEnd
32219>>>
32219>>>    Object Container3d1 is a Container3d
32221>>>        Set Size to 88 135
32222>>>        Set Location to -2 -1
32223>>>        Set Color to clWhite
32224>>>        Set Border_Style to Border_None
32225>>>        Object Grid2 is a Grid
32227>>>
32227>>>            //AB-StoreTopStart
32227>>>            property date    p_current_date     public 0
32229>>>            property integer p_current_year     public -1
32231>>>            property integer p_current_month    public -1
32233>>>            property integer p_selected_day     public -1
32235>>>            property integer pExportState       public 1
32237>>>            property integer invoking_object_id public 0
32239>>>            
32239>>>            Set Border_Style To BORDER_NONE
32240>>>            Set header_visible_state To False
32241>>>            set select_mode to no_select
32242>>>            Set Gridline_mode To GRID_VISIBLE_NONE
32243>>>            
32243>>>            on_key Key_F1 Send Help
32244>>>            on_key key_ctrl+key_pgup send prev_year
32245>>>            on_key key_ctrl+key_pgdn send next_year
32246>>>            on_key          key_pgup send prev_month
32247>>>            on_key          key_pgdn send next_month
32248>>>            on_key key_enter         send move_value_out
32249>>>            on_key key_ctrl+key_d    send go_today
32250>>>            
32250>>>            //AB-StoreTopEnd
32250>>>
32250>>>            Set Color to clWhite
32251>>>            Set CurrentCellColor to clWhite
32252>>>            Set CurrentCellTextColor to clWhite
32253>>>            Set Size to 61 145
32254>>>            Set Location to 30 1
32255>>>            Set Resize_Column_state to FALSE
32256>>>
32256>>>            Set Line_Width to 7 0
32257>>>
32257>>>            Set Form_Width    item 0 to 18
32258>>>            Set Header_Label  item 0 to "­"
32259>>>            
32259>>>            Set Form_Width    item 1 to 18
32260>>>            Set Header_Label  item 1 to "‚â"
32261>>>            
32261>>>            Set Form_Width    item 2 to 18
32262>>>            Set Header_Label  item 2 to "‘à"
32263>>>            
32263>>>            Set Form_Width    item 3 to 18
32264>>>            Set Header_Label  item 3 to "—â"
32265>>>            
32265>>>            Set Form_Width    item 4 to 18
32266>>>            Set Header_Label  item 4 to "â"
32267>>>            
32267>>>            Set Form_Width    item 5 to 18
32268>>>            Set Header_Label  item 5 to "‘¡"
32269>>>            
32269>>>            Set Form_Width    item 6 to 18
32270>>>            Set Header_Label  item 6 to "‚á"
32271>>>            
32271>>>
32271>>>            //AB-StoreStart
32271>>>            
32271>>>            procedure go_today
32273>>>                Date date#
32274>>>                sysdate4 date#
32275>>>                set p_current_date to date#
32276>>>                Send Update_Calendar
32277>>>            end_procedure
32278>>>            
32278>>>            procedure next_month
32280>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32281>>>                Send Update_Calendar
32282>>>            end_procedure
32283>>>            
32283>>>            procedure prev_month
32285>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32286>>>                Send Update_Calendar
32287>>>            end_procedure
32288>>>            
32288>>>            procedure next_year
32290>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32291>>>                Send Update_Calendar
32292>>>            end_procedure
32293>>>            
32293>>>            procedure prev_year
32295>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32296>>>                Send Update_Calendar
32297>>>            end_procedure
32298>>>            
32298>>>            Procedure Activate
32300>>>                Date date#
32301>>>                Forward Send Activate
32303>>>                Set current_item to (p_selected_day(Self))
32304>>>            End_Procedure
32305>>>            
32305>>>            Procedure Update_Calendar
32307>>>                Set Dynamic_Update_State To False
32308>>>                send Fill_List
32309>>>                Set Dynamic_Update_State To True
32310>>>                // Send Update_Label
32310>>>                Set current_item to (p_selected_day(Self))
32311>>>                Send Date_Changing to (oYear(Container3d2(self)))
32312>>>                Send Date_Changing to (oMonth(Container3d2(self)))
32313>>>            End_Procedure
32314>>>            
32314>>>            Procedure Fill_List
32316>>>                Integer iFor prevdate# date# first_item# last_item# day# prev_last# nextdate# next_first#
32317>>>                Integer cur_year# cur_month# cur_day# sel_month# sel_day# sel_year#
32317>>>                Date dToday
32317>>>                Send Delete_Data
32318>>>            
32318>>>                Get p_current_date to date#
32319>>>            
32319>>>                SysDate4 dToday
32320>>>                move (DateSegment(dToday,DS_DAY)) to cur_day#
32321>>>                move (DateSegment(dToday,DS_MONTH)) to cur_month#
32322>>>                move (DateSegment(dToday,DS_YEAR)) to cur_year#
32323>>>            
32323>>>                move (DateSegment(date#,DS_DAY)) to sel_day#
32324>>>                move (DateSegment(date#,DS_MONTH)) to sel_month#
32325>>>                move (DateSegment(date#,DS_YEAR)) to sel_year#
32326>>>                Set p_current_month To sel_month#
32327>>>                Set p_current_year To sel_year#
32328>>>            
32328>>>                move (FirstDayInMonth(date#)) to date#
32329>>>                move (DateDayNumber(date#)-1) to first_item#
32330>>>                move (LastDayInMonth(date#)-date#+first_item#) to last_item#
32331>>>                move (DateIncrement(date#,DS_Month,-1)) To prevdate#
32332>>>                move (DateSegment((LastDayInMonth(prevdate#)),DS_DAY)) to prev_last#
32333>>>            
32333>>>                If (first_item# > 0) Begin
32335>>>                    Move (first_item#-1) to day#
32336>>>                    For iFor from 0 to (first_item#-1)
32342>>>>
32342>>>                        Send Add_Item msg_move_value_out (prev_last#-day#)
32343>>>                        Set Entry_State Item iFor To False
32344>>>                        Set ItemTextColor Item iFor To clGray
32345>>>                        Decrement day#
32346>>>                    Loop
32347>>>>
32347>>>                End
32347>>>>
32347>>>            
32347>>>                Move 1 To day#
32348>>>                For iFor from first_item# to last_item#
32354>>>>
32354>>>                    Send Add_Item Msg_Move_Value_Out day#
32355>>>                    Set Entry_State Item iFor To False
32356>>>                    If ((cur_month# eq sel_month#)and(cur_year# eq sel_year#)and(Day# eq cur_day#)) Set Form_Bitmap Item iFor To "cdate.bmp"
32359>>>                    If Day# eq sel_day# Set p_selected_day To iFor
32362>>>                    Set Form_justification_mode Item iFor To FORM_DISPLAYRIGHT
32363>>>                    Set form_datatype item iFor To mask_numeric_window
32364>>>                    Set form_Mask item iFor To "## "
32365>>>                    Increment day#
32366>>>                Loop
32367>>>>
32367>>>            
32367>>>                move (DateIncrement(date#,DS_Month,1)) To nextdate#
32368>>>                move (DateSegment((LastDayInMonth(nextdate#)),DS_DAY)) to next_first#
32369>>>            
32369>>>                If (last_item# < 41) Begin
32371>>>                    Move 1 to day#
32372>>>                    For iFor from (last_item#+1) to 41
32378>>>>
32378>>>                        Send Add_Item msg_move_value_out day#
32379>>>                        Set Entry_State Item iFor To False
32380>>>                        Set ItemTextColor Item iFor To clGray
32381>>>                        Increment day#
32382>>>                    Loop
32383>>>>
32383>>>                End
32383>>>>
32383>>>            
32383>>>            End_Procedure
32384>>>            
32384>>>            Procedure Help
32386>>>                Send Info_Box ("<Up>, <Dn>, <Lft>, <Rgt> - select date.\n<PgUp>, <PgDn> - select month.\n<Ctrl>+<D> - set current date.\n<Ctrl>+<PgUp>, <PgDn> - Select year.\n\n(c) 2001, SCR. Special thanks to Sture Andersen.") ("Help on Calendar")
32387>>>            End_Procedure
32388>>>            
32388>>>            procedure mouse_click integer window integer char_pos
32390>>>                Send Move_Value_Out
32391>>>                forward send mouse_click window char_pos
32393>>>            end_procedure
32394>>>            
32394>>>            Procedure Move_Value_Out
32396>>>                Integer iYear iMonth iDay iItm
32397>>>                Date Date# next_date# prev_date#
32397>>>                Get Current_Item To iItm
32398>>>                If (pExportState(Self)) Begin
32400>>>                    Get Value Item iItm To iDay
32401>>>                    Get p_current_month to iMonth
32402>>>                    Get p_current_year  to iYear
32403>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32404>>>            
32404>>>                    If ((iItm>27)and(iDay<15)) Begin
32406>>>                        Move (DateCompose(1,iMonth,iYear)) To next_date#
32407>>>                        move (DateIncrement(next_date#,DS_Month,1)) To next_date#
32408>>>                        move (DateSegment(next_date#,DS_MONTH)) to iMonth
32409>>>                        move (DateSegment(next_date#,DS_YEAR)) to iYear
32410>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32411>>>                    End
32411>>>>
32411>>>                    If ((iItm<7)and(iDay>20)) Begin
32413>>>                        Move (DateCompose(1,iMonth,iYear)) To prev_date#
32414>>>                        move (DateIncrement(prev_date#,DS_Month,-1)) To prev_date#
32415>>>                        move (DateSegment(prev_date#,DS_MONTH)) to iMonth
32416>>>                        move (DateSegment(prev_date#,DS_YEAR)) to iYear
32417>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32418>>>                    End
32418>>>>
32418>>>            
32418>>>                    Send Export_Date date#
32419>>>                End
32419>>>>
32419>>>            End_Procedure
32420>>>            
32420>>>            Procedure Export_Date date date#
32422>>>                local integer focus# dm# margin# datatype#
32423>>>                get invoking_object_id to focus#
32424>>>            
32424>>>                if focus# gt desktop begin
32426>>>                     get delegation_mode of focus# to dm#
32427>>>                     set delegation_mode of focus# to no_delegate_or_error
32428>>>                     get form_margin of focus# item current to margin#
32429>>>                     get form_datatype of focus# item current to datatype#
32430>>>                     set delegation_mode of focus# to dm#
32431>>>                     if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to date#
32434>>>                     else             set value of focus# item current to (Date4to2(date#))
32436>>>                     set item_changed_state of focus# item current to true
32437>>>                end
32437>>>>
32437>>>                Send Close_Calendar
32438>>>            End_Procedure
32439>>>            //AB-StoreEnd
32439>>>
32439>>>        End_Object    // Grid2
32440>>>
32440>>>        Object Textbox2 is a Textbox
32442>>>            Set Label to "­"
32443>>>            Set Auto_Size_State to FALSE
32444>>>            Set Transparent_State to TRUE
32445>>>            Set Color to clWhite
32446>>>            Set TextColor to clNavy
32447>>>            Set Location to 19 4
32448>>>            Set Size to 10 15
32449>>>
32449>>>            //AB-StoreStart
32449>>>                                        
32449>>>            Set Label To (left(t.calendar.Monday,2))
32450>>>            //AB-StoreEnd
32450>>>
32450>>>        End_Object    // Textbox2
32451>>>
32451>>>        Object Textbox3 is a Textbox
32453>>>            Set Label to "‚â"
32454>>>            Set Auto_Size_State to FALSE
32455>>>            Set Transparent_State to TRUE
32456>>>            Set Color to clWhite
32457>>>            Set TextColor to clNavy
32458>>>            Set Location to 19 22
32459>>>            Set Size to 10 12
32460>>>
32460>>>            //AB-StoreStart
32460>>>                                        
32460>>>            Set Label To (left(t.calendar.Tuesday,2))
32461>>>            //AB-StoreEnd
32461>>>
32461>>>        End_Object    // Textbox3
32462>>>
32462>>>        Object Textbox4 is a Textbox
32464>>>            Set Label to "‘à"
32465>>>            Set Auto_Size_State to FALSE
32466>>>            Set Transparent_State to TRUE
32467>>>            Set Color to clWhite
32468>>>            Set TextColor to clNavy
32469>>>            Set Location to 19 39
32470>>>            Set Size to 10 15
32471>>>
32471>>>            //AB-StoreStart
32471>>>                                        
32471>>>            Set Label To (left(t.calendar.Wednesday,2))
32472>>>            //AB-StoreEnd
32472>>>
32472>>>        End_Object    // Textbox4
32473>>>
32473>>>        Object Textbox5 is a Textbox
32475>>>            Set Label to "—â"
32476>>>            Set Auto_Size_State to FALSE
32477>>>            Set Transparent_State to TRUE
32478>>>            Set Color to clWhite
32479>>>            Set TextColor to clNavy
32480>>>            Set Location to 19 57
32481>>>            Set Size to 10 17
32482>>>
32482>>>            //AB-StoreStart
32482>>>                                        
32482>>>            Set Label To (left(t.calendar.Thursday,2))
32483>>>            //AB-StoreEnd
32483>>>
32483>>>        End_Object    // Textbox5
32484>>>
32484>>>        Object Textbox6 is a Textbox
32486>>>            Set Label to "â"
32487>>>            Set Auto_Size_State to FALSE
32488>>>            Set Transparent_State to TRUE
32489>>>            Set Color to clWhite
32490>>>            Set TextColor to clNavy
32491>>>            Set Location to 19 76
32492>>>            Set Size to 10 17
32493>>>
32493>>>            //AB-StoreStart
32493>>>                                        
32493>>>            Set Label To (left(t.calendar.Friday,2))
32494>>>            //AB-StoreEnd
32494>>>
32494>>>        End_Object    // Textbox6
32495>>>
32495>>>        Object Textbox7 is a Textbox
32497>>>            Set Label to "‘¡"
32498>>>            Set Auto_Size_State to FALSE
32499>>>            Set Transparent_State to TRUE
32500>>>            Set Color to clWhite
32501>>>            Set TextColor to clNavy
32502>>>            Set Location to 19 91
32503>>>            Set Size to 10 18
32504>>>
32504>>>            //AB-StoreStart
32504>>>                                        
32504>>>            Set Label To (left(t.calendar.Saturday,2))
32505>>>            //AB-StoreEnd
32505>>>
32505>>>        End_Object    // Textbox7
32506>>>
32506>>>        Object Textbox8 is a Textbox
32508>>>            Set Label to "‚á"
32509>>>            Set Auto_Size_State to FALSE
32510>>>            Set Transparent_State to TRUE
32511>>>            Set Color to clWhite
32512>>>            Set TextColor to clNavy
32513>>>            Set Location to 19 109
32514>>>            Set Size to 10 17
32515>>>
32515>>>            //AB-StoreStart
32515>>>                                        
32515>>>            Set Label To (left(t.calendar.Sunday,2))
32516>>>            //AB-StoreEnd
32516>>>
32516>>>        End_Object    // Textbox8
32517>>>
32517>>>        Object LineControl1 is a LineControl
32519>>>            Set Line_Style to lnSINGLE
32520>>>            Set Size to 1 116
32521>>>            Set Location to 28 4
32522>>>
32522>>>            //AB-StoreStart
32522>>>                                        
32522>>>            //AB-StoreEnd
32522>>>
32522>>>        End_Object    // LineControl1
32523>>>
32523>>>        Object Container3d2 is a Container3d
32525>>>            Set Size to 18 131
32526>>>            Set Location to 1 1
32527>>>            Set Color to clNavy
32528>>>            Set Border_Style to Border_None
32529>>>            Object oRght is a BitmapContainer
32531>>>                Set Size to 10 14
32532>>>                Set Location to 4 105
32533>>>                Set Bitmap to "rght.bmp"
32534>>>                Set Border_Style to Border_None
32535>>>
32535>>>                //AB-StoreStart
32535>>>                Procedure Mouse_Down
32537>>>                    Send Next_Month to Grid2
32538>>>                End_Procedure
32539>>>                //AB-StoreEnd
32539>>>
32539>>>            End_Object    // oRght
32540>>>
32540>>>            Object oLeft is a BitmapContainer
32542>>>                Set Size to 10 14
32543>>>                Set Location to 4 3
32544>>>                Set Bitmap to "lft.bmp"
32545>>>                Set Border_Style to Border_None
32546>>>
32546>>>                //AB-StoreStart
32546>>>                Procedure Mouse_Down
32548>>>                    Send Prev_Month to Grid2
32549>>>                End_Procedure
32550>>>                //AB-StoreEnd
32550>>>
32550>>>            End_Object    // oLeft
32551>>>
32551>>>            Object oMonth is a Textbox
32553>>>
32553>>>                //AB-StoreTopStart
32553>>>                Property integer piSelected_Month public 0
32555>>>                //AB-StoreTopEnd
32555>>>
32555>>>                Set Label to "January"
32556>>>                Set Auto_Size_State to FALSE
32557>>>                Set Transparent_State to TRUE
32558>>>                Set Color to clWhite
32559>>>                Set TextColor to clWhite
32560>>>                Set Location to 4 23
32561>>>                Set Size to 10 43
32562>>>                Set FontWeight to 800
32563>>>                Set Justification_Mode to jMode_Center
32564>>>
32564>>>                //AB-StoreStart
32564>>>                                    
32564>>>                Procedure Mouse_Down
32566>>>                    Integer iState
32567>>>                    Get Visible_State of oSelectYear to iState
32568>>>                    If (iState) Send OnKillFocus to oSelectYear
32571>>>                    Send Popup to oSelectMonth
32572>>>                End_Procedure
32573>>>                
32573>>>                Procedure pSelectJan
32575>>>                    Set Label to t.calendar.january
32576>>>                    Set piSelected_Month to 1
32577>>>                    Send Adjust_Calendar
32578>>>                End_Procedure
32579>>>                Procedure pSelectFeb
32581>>>                    Set Label to t.calendar.february
32582>>>                    Set piSelected_Month to 2
32583>>>                    Send Adjust_Calendar
32584>>>                End_Procedure
32585>>>                Procedure pSelectMar
32587>>>                    Set Label to t.calendar.march
32588>>>                    Set piSelected_Month to 3
32589>>>                    Send Adjust_Calendar
32590>>>                End_Procedure
32591>>>                Procedure pSelectApr
32593>>>                    Set Label to t.calendar.april
32594>>>                    Set piSelected_Month to 4
32595>>>                    Send Adjust_Calendar
32596>>>                End_Procedure
32597>>>                Procedure pSelectMay
32599>>>                    Set Label to t.calendar.may
32600>>>                    Set piSelected_Month to 5
32601>>>                    Send Adjust_Calendar
32602>>>                End_Procedure
32603>>>                Procedure pSelectJun
32605>>>                    Set Label to t.calendar.june
32606>>>                    Set piSelected_Month to 6
32607>>>                    Send Adjust_Calendar
32608>>>                End_Procedure
32609>>>                Procedure pSelectJul
32611>>>                    Set Label to t.calendar.july
32612>>>                    Set piSelected_Month to 7
32613>>>                    Send Adjust_Calendar
32614>>>                End_Procedure
32615>>>                Procedure pSelectAug
32617>>>                    Set Label to t.calendar.august
32618>>>                    Set piSelected_Month to 8
32619>>>                    Send Adjust_Calendar
32620>>>                End_Procedure
32621>>>                Procedure pSelectSep
32623>>>                    Set Label to t.calendar.september
32624>>>                    Set piSelected_Month to 9
32625>>>                    Send Adjust_Calendar
32626>>>                End_Procedure
32627>>>                Procedure pSelectOct
32629>>>                    Set Label to t.calendar.october
32630>>>                    Set piSelected_Month to 10
32631>>>                    Send Adjust_Calendar
32632>>>                End_Procedure
32633>>>                Procedure pSelectNov
32635>>>                    Set Label to t.calendar.november
32636>>>                    Set piSelected_Month to 11
32637>>>                    Send Adjust_Calendar
32638>>>                End_Procedure
32639>>>                Procedure pSelectDec
32641>>>                    Set Label to t.calendar.december
32642>>>                    Set piSelected_Month to 12
32643>>>                    Send Adjust_Calendar
32644>>>                End_Procedure
32645>>>                
32645>>>                Object oSelectMonth is a FloatingPopupMenu
32647>>>                    Send Add_Item msg_pSelectJan t.calendar.january
32648>>>                    Send Add_Item msg_pSelectFeb t.calendar.february
32649>>>                    Send Add_Item msg_pSelectMar t.calendar.march
32650>>>                    Send Add_Item msg_pSelectApr t.calendar.april
32651>>>                    Send Add_Item msg_pSelectMay t.calendar.may
32652>>>                    Send Add_Item msg_pSelectJun t.calendar.june
32653>>>                    Send Add_Item msg_pSelectJul t.calendar.july
32654>>>                    Send Add_Item msg_pSelectAug t.calendar.august
32655>>>                    Send Add_Item msg_pSelectSep t.calendar.september
32656>>>                    Send Add_Item msg_pSelectOct t.calendar.october
32657>>>                    Send Add_Item msg_pSelectNov t.calendar.november
32658>>>                    Send Add_Item msg_pSelectDec t.calendar.december
32659>>>                End_Object
32660>>>                
32660>>>                Procedure Adjust_Calendar
32662>>>                    Date date#
32663>>>                    Integer iDay iMonth iYear iItm
32663>>>                    Set Visible_State to false
32664>>>                    Set Visible_State to true
32665>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
32666>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
32667>>>                    Get piSelected_Month to iMonth
32668>>>                    Get Label of oYear to iYear
32669>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32670>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
32671>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
32672>>>                End_Procedure
32673>>>                
32673>>>                Procedure Activating
32675>>>                    Forward Send Activating
32677>>>                    Send Date_Changing
32678>>>                End_Procedure
32679>>>                
32679>>>                Procedure Date_Changing
32681>>>                    Set Visible_State to false
32682>>>                    Set Label to (MonthName(p_current_Month(Grid2(Container3D1(Self)))))
32683>>>                    Set piSelected_Month to (p_current_Month(Grid2(Container3D1(Self))))
32684>>>                    Set Visible_State to true
32685>>>                End_Procedure
32686>>>                
32686>>>                
32686>>>                //AB-StoreEnd
32686>>>
32686>>>            End_Object    // oMonth
32687>>>
32687>>>            Object oYear is a Textbox
32689>>>                Set Label to "2001"
32690>>>                Set Transparent_State to TRUE
32691>>>                Set Color to clWhite
32692>>>                Set TextColor to clWhite
32693>>>                Set Location to 4 77
32694>>>                Set Size to 10 18
32695>>>                Set FontWeight to 800
32696>>>
32696>>>                //AB-StoreStart
32696>>>                                                    
32696>>>                Procedure Mouse_Down
32698>>>                    String sVal
32699>>>                    Get Label to sVal
32700>>>                    Set Value of oSelectYear item 0 to sVal
32701>>>                    Set Visible_State of oSelectYear to True
32702>>>                    Send Activate to (oSelectYear(Self))
32703>>>                End_Procedure
32704>>>                
32704>>>                Procedure Activating
32706>>>                    Forward Send Activating
32708>>>                    Send Date_Changing
32709>>>                End_Procedure
32710>>>                
32710>>>                Procedure Date_Changing
32712>>>                    Set Visible_State to false
32713>>>                    Set Label to (String(p_current_Year(Grid2(Container3D1(Self)))))
32714>>>                    Set Visible_State to true
32715>>>                End_Procedure
32716>>>                //AB-StoreEnd
32716>>>
32716>>>            End_Object    // oYear
32717>>>
32717>>>            Object oSelectYear is a Form
32719>>>
32719>>>                //AB-StoreTopStart
32719>>>                Set Visible_State To False
32720>>>                //AB-StoreTopEnd
32720>>>
32720>>>                Set Size to 10 24
32721>>>                Set Location to 4 75
32722>>>                Set Color to clWhite
32723>>>                Set TextColor to clNavy
32724>>>                Set Form_Border Item 0 to Border_Normal
32725>>>
32725>>>                //AB-StoreStart
32725>>>                                                    
32725>>>                On_Key Key_Enter Send OnKillFocus
32726>>>                On_Key Key_Escape Send OnKillFocus
32727>>>                
32727>>>                Procedure SetFontWeight
32729>>>                    Set Form_FontWeight item 0 to 800
32730>>>                End_Procedure
32731>>>                
32731>>>                Procedure OnKillFocus
32733>>>                    String sVal
32734>>>                    Integer iMonth iDay iYear iItm
32734>>>                    Date date#
32734>>>                    Get Value item 0 to sVal
32735>>>                    Set Visible_State of oYear to false
32736>>>                    Set Label of oYear to sVal
32737>>>                    Set Visible_State of oYear to true
32738>>>                    Set Visible_State to false
32739>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
32740>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
32741>>>                    Get piSelected_Month of oMonth to iMonth
32742>>>                    Get Value item 0 to iYear
32743>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32744>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
32745>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
32746>>>                End_Procedure
32747>>>                
32747>>>                Send SetFontWeight
32748>>>                //AB-StoreEnd
32748>>>
32748>>>            End_Object    // oSelectYear
32749>>>
32749>>>
32749>>>            //AB-StoreStart
32749>>>                            
32749>>>            Procedure Mouse_Down
32751>>>                Integer iState
32752>>>                Get Visible_State of oSelectYear to iState
32753>>>                If (iState) Send OnKillFocus to oSelectYear
32756>>>            End_Procedure
32757>>>            
32757>>>            //AB-StoreEnd
32757>>>
32757>>>        End_Object    // Container3d2
32758>>>
32758>>>
32758>>>        //AB-StoreStart
32758>>>                            
32758>>>        //AB-StoreEnd
32758>>>
32758>>>    End_Object    // Container3d1
32759>>>
32759>>>    Object BitmapContainer3 is a BitmapContainer
32761>>>        Set Size to 9 19
32762>>>        Set Location to 88 3
32763>>>        Set Color to clWhite
32764>>>        Set Bitmap to "cdate.bmp"
32765>>>        Set Border_Style to Border_None
32766>>>
32766>>>        //AB-StoreStart
32766>>>        Procedure Mouse_Down
32768>>>            Send go_today to (Grid2(Container3d1(Self)))
32769>>>            Send Adjust_Label to oToday
32770>>>        End_Procedure
32771>>>        //AB-StoreEnd
32771>>>
32771>>>    End_Object    // BitmapContainer3
32772>>>
32772>>>    Object oToday is a Textbox
32774>>>        Set Label to "Today: 01.01.2001"
32775>>>        Set Auto_Size_State to FALSE
32776>>>        Set Color to clWhite
32777>>>        Set Location to 88 22
32778>>>        Set Size to 8 73
32779>>>        Set FontWeight to 800
32780>>>
32780>>>        //AB-StoreStart
32780>>>        Procedure Mouse_Down
32782>>>            Send go_today to (Grid2(Container3d1(Self)))
32783>>>            Send Adjust_Label
32784>>>        End_Procedure
32785>>>        
32785>>>        Procedure Adjust_Label
32787>>>            date date#
32788>>>            SysDate4 date#
32789>>>            Set Visible_State To false
32790>>>            Set Label         to (t.calendar.today+": "+String(date#))
32791>>>            Set Visible_State To true
32792>>>        End_Procedure
32793>>>        
32793>>>        Procedure Activating
32795>>>            Forward Send Activating
32797>>>            Send Adjust_Label
32798>>>        End_Procedure
32799>>>        //AB-StoreEnd
32799>>>
32799>>>    End_Object    // oToday
32800>>>
32800>>>
32800>>>    //AB-StoreStart
32800>>>                
32800>>>    procedure popup
32802>>>        local integer focus# icItm iYear iMonth
32803>>>        local date date#
32803>>>        move (focus(desktop)) to focus#
32804>>>        set invoking_object_id of (Grid2(Container3d1(self))) to focus#
32805>>>        get value of focus# item current to date#
32806>>>        ifnot (integer(date#)) sysdate date#
32809>>>        move (Date2to4(date#)) to date#
32810>>>        set p_current_date of (Grid2(Container3d1(self))) to date#
32811>>>        send fill_list to (Grid2(Container3d1(self)))
32812>>>        move (DateSegment(date#,DS_YEAR)) to iYear
32813>>>        move (DateSegment(date#,DS_MONTH)) to iMonth
32814>>>        Set Label To (MonthName(iMonth)+', '+String(iYear))
32815>>>        forward send popup
32817>>>    end_procedure
32818>>>    
32818>>>    Procedure Close_Calendar
32820>>>        Send Exit
32821>>>    End_Procedure
32822>>>    //AB-StoreEnd
32822>>>
32822>>>CD_End_Object    // oCalendar
32824>>>>
32824>>>
32824>>>
32824>>>//AB-StoreStart
32824>>>    
32824>>>    
32824>>>//AB-StoreEnd
32824>>>
32824>>>//AB/ End_Object    // prj
32824>Use Dates.Utl
32824>use roundfn.fnc
INCLUDING FILE: ROUNDFN.FNC
32824>>>// ===========================================================================
32824>>>//
32824>>>// The ROUND_NUMBER global function has been designed to return the rounded
32824>>>// value of a given 'numeric' argument at a specified rounding precision.
32824>>>//
32824>>>// ---------------------------------------------------------------------------
32824>>>// This version dispenses with the use of powers (10 ^ n) to perform the
32824>>>// necessary calculations.  It uses a string handling technique instead.
32824>>>// ---------------------------------------------------------------------------
32824>>>//
32824>>>// The function requires two arguments, as follows:-
32824>>>//
32824>>>// (a) The numeric value to be rounded, where the range of valid values is
32824>>>//     +/- 99,999,999,999,999.99999999.
32824>>>//
32824>>>// (b) The rounding precision required.  This must be an integer value in the
32824>>>//     range -13 to +8.  If a value outside this range is used, the nearest
32824>>>//     threshold value is substituted.
32824>>>//
32824>>>//     Values in the range +1 to +7 perform rounding on the decimal part of
32824>>>//     the number.  A value of +8 will perform no rounding at all.  A zero
32824>>>//     value will round to the nearest whole number.  Values -1 to -13 will
32824>>>//     round progressively to the left of the decimal point (a frequent
32824>>>//     requirement in financial reporting).
32824>>>//
32824>>>// If the result of the rounding produces a value outside the valid numeric
32824>>>// range (+/- 99,999,999,999,999.99999999) then a zero value is returned.
32824>>>//
32824>>>// Assumptions:-  The only assumptions made have been that the range of
32824>>>// numeric values and the limit of eight decimal places are unlikely to change
32824>>>// in the forseeable future.
32824>>>//
32824>>>// Examples:-
32824>>>//
32824>>>//  1st Argument      2nd Argument   Return Value
32824>>>//  ------------      ------------   ------------
32824>>>//  123456.87654321         8         123456.87654321
32824>>>//  123456.87654321         2         123456.88
32824>>>// -123456.87654321         2        -123456.88
32824>>>//  123456.98765432         0         123457
32824>>>// -123456.98765432        -1        -123460
32824>>>//  123456.98765432        -2         123500
32824>>>//  123456.98765432        -3         123000
32824>>>//  987654                 -4         990000
32824>>>//  987654                 -5        1000000
32824>>>//  987654                 -6        1000000
32824>>>//  987654                 -7              0
32824>>>//
32824>>>// ===========================================================================
32824>>>
32824>>>
32824>>>Function Round_Number GLOBAL number nVal integer iRnd returns Number
32825>>>
32825>>>  Local Number nAdj
32826>>>
32826>>>  Move 10000000000000 to nAdj
32827>>>
32827>>>  // If the rounding precision falls in the range 0 to 8, then return:-
32827>>>
32827>>>  If (iRnd >= 0) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 / (Number(Left(nAdj, ((iRnd + 1) ;      min 9)))) + nVal / (Number(Left(nAdj, (9 - (iRnd min 8))))) ;        * (Number(Left(nAdj, (9 - (iRnd min 8))))))
32830>>>
32830>>>  // Else, where the rounding precision is in the range -1 to -5, return:-
32830>>>
32830>>>  If (iRnd >= -5) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(Left(nAdj, (Abs(iRnd) + 9)))) ;        * (Number(Left(nAdj, (Abs(iRnd) + 9)))))
32833>>>
32833>>>  // Else, where the rounding precision is in the range -6 to -13, return:-
32833>>>
32833>>>  Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(nAdj)) / (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))) ;        * (Number(nAdj)) * (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))))
32834>>>
32834>>>End_Function
32835>use checkafm.pkg
INCLUDING FILE: CHECKAFM.PKG
32835>>>
32835>>>
32835>>>Function Check_Afm Global String Afm_Num Returns Integer
32836>>>    Integer iii Num1 Num2
32837>>>
32837>>>    Move (Trim(Afm_Num)) To Afm_Num
32838>>>    Move (Right(Afm_Num,1)) to Num2
32839>>>
32839>>>    If (Length(Afm_Num)<>9) Function_Return 2
32842>>>
32842>>>    For iii From 1 To (Length(Trim(Afm_Num)))
32848>>>>
32848>>>        If Not (Mid(Afm_Num,1,iii)) In  "0123456789" Function_Return 3
32851>>>    Loop
32852>>>>
32852>>>
32852>>>    Move 0 to Num1
32853>>>
32853>>>    For iii From 1 to 8
32859>>>>
32859>>>        Add ((Mid(Afm_Num,1,iii)) * (2 ^ (9 - iii))) to Num1
32860>>>    Loop
32861>>>>
32861>>>
32861>>>    Move (Mod(Num1,11)) to Num1
32862>>>    If (Num1=10) Move 0 to Num1
32865>>>
32865>>>    If (Num1=Num2)  Function_Return 0
32868>>>    Else            Function_Return 1
32870>>>End_Function
32871>>>
32871>use checklog.pkg
INCLUDING FILE: CHECKLOG.PKG
32871>>>open syscurgl
INCLUDING FILE: SYSCURGL.FD
32873>>>open syscurxr
32875>>>open gplan
INCLUDING FILE: GPLAN.FD
32877>>>open iteml
INCLUDING FILE: ITEML.FD
32879>>>open cn
INCLUDING FILE: CN.FD
32881>>>open payresp
INCLUDING FILE: PAYRESP.FD
32883>>>open salesmen
INCLUDING FILE: SALESMEN.FD
32885>>>open mhxanik
INCLUDING FILE: MHXANIK.FD
32887>>>open constrct
INCLUDING FILE: CONSTRCT.FD
32889>>>open clients
INCLUDING FILE: CLIENTS.FD
32891>>>open wtypkin
INCLUDING FILE: WTYPKIN.FD
32893>>>open wax
INCLUDING FILE: WAX.FD
32895>>>Function Check_log Global String slog Returns Integer
32896>>>    clear gplan
32897>>>    move syscurxr.company_code to gplan.company_code
32898>>>    move syscurxr.branch_code  to gplan.branch_code
32899>>>    move syscurxr.year_year    to gplan.year_year
32900>>>    move slog                  to gplan.gplan_code
32901>>>    find eq gplan by index.1
32902>>>>
32902>>>    if (found=1) function_return 0
32905>>>    else         function_return 1
32907>>>
32907>>>End_Function
32908>>>
32908>>>Function Check_last Global String slog Returns Integer
32909>>>    clear gplan
32910>>>    move syscurxr.company_code to gplan.company_code
32911>>>    move syscurxr.branch_code  to gplan.branch_code
32912>>>    move syscurxr.year_year    to gplan.year_year
32913>>>    move slog                  to gplan.gplan_code
32914>>>    find eq gplan by index.1
32915>>>>
32915>>>    if ((found=1) and (Gplan.Gplan_Yn_Last = 1)) Function_Return 0
32918>>>    else                                         Function_return 1
32920>>>
32920>>>End_Function
32921>>>
32921>>>Function fsgplandescr String slog Returns string
32922>>>    clear gplan
32923>>>    move syscurgl.company_code to gplan.company_code
32924>>>    move syscurgl.branch_code  to gplan.branch_code
32925>>>    move syscurgl.year_year    to gplan.year_year
32926>>>    move slog                  to gplan.gplan_code
32927>>>    find eq gplan by index.1
32928>>>>
32928>>>    if (found=1) function_return gplan.gplan_descr1
32931>>>    else         function_return ''
32933>>>
32933>>>End_Function
32934>>>
32934>>>Function fsclient string code Returns string
32935>>>    string name
32936>>>    clear clients
32937>>>    move code to clients.client_id
32938>>>    find eq clients by index.6
32939>>>>
32939>>>    if (found) move clients.client_name to name
32942>>>    else       move '' to name
32944>>>    function_return name
32945>>>end_Function
32946>>>
32946>>>Function fspayresp string code Returns string
32947>>>    string name
32948>>>    clear payresp
32949>>>    move code to payresp.presp_id
32950>>>    find eq payresp by index.7
32951>>>>
32951>>>    if (found) move payresp.presp_name to name
32954>>>    else       move '' to name
32956>>>    function_return name
32957>>>end_Function
32958>>>
32958>>>Function fssalesmen string code Returns string
32959>>>    string name
32960>>>    clear salesmen
32961>>>    move code to salesmen.sls_id
32962>>>    find eq salesmen by index.4
32963>>>>
32963>>>    if (found) move salesmen.sls_name to name
32966>>>    else       move '' to name
32968>>>    function_return name
32969>>>end_Function
32970>>>
32970>>>Function fsconstrct string code Returns string
32971>>>    string name
32972>>>    clear constrct
32973>>>    move code to constrct.cnt_id
32974>>>    find eq constrct by index.5
32975>>>>
32975>>>    if (found) move constrct.cnt_name to name
32978>>>    else       move '' to name
32980>>>    function_return name
32981>>>end_Function
32982>>>
32982>>>Function fsmhxanik string code Returns string
32983>>>    string name
32984>>>    clear mhxanik
32985>>>    move code to mhxanik.mhx_id
32986>>>    find eq mhxanik by index.4
32987>>>>
32987>>>    if (found) move mhxanik.mhx_name to name
32990>>>    else       move '' to name
32992>>>    function_return name
32993>>>end_Function
32994>>>
32994>>>
32994>>>Function fsptyppar string code Returns string
32995>>>    string sdescr
32996>>>    clear ptypparl
INCLUDING FILE: PTYPPARL.FD
32997>>>    move syscurxr.company_code to ptypparl.company_code
32998>>>    move syscurxr.branch_code  to ptypparl.branch_code
32999>>>    move syscurxr.year_year    to ptypparl.year_year
33000>>>    move code                  to ptypparl.ptyppar_code
33001>>>    find eq ptypparl by index.1
33002>>>>
33002>>>    move ptypparl.ptyppar_descr to sdescr
33003>>>    function_return sdescr
33004>>>end_Function
33005>>>
33005>>>Function fsgplan string code Returns string
33006>>>    string sdescr
33007>>>    clear gplan
33008>>>    move syscurxr.company_code to gplan.company_code
33009>>>    move syscurxr.branch_code  to gplan.branch_code
33010>>>    move syscurxr.year_year    to gplan.year_year
33011>>>    move code                  to gplan.gplan_code
33012>>>    find eq gplan by index.1
33013>>>>
33013>>>    move gplan.gplan_descr1    to sdescr
33014>>>    function_return sdescr
33015>>>end_Function
33016>>>
33016>>>Function fsitem string scode Returns string
33017>>>    clear iteml
33018>>>    move scode to iteml.item_code
33019>>>    find eq iteml by index.5
33020>>>>
33020>>>    function_return iteml.item_descr
33021>>>end_Function
33022>>>
33022>>>Function fswax string srecr Returns string
33023>>>    clear wax
33024>>>    move srecr to wax.wax_recr
33025>>>    find eq wax by index.2
33026>>>>
33026>>>    function_return wax.wax_descr
33027>>>end_Function
33028>>>
33028>>>
33028>>>Function fswitemx string code Returns string
33029>>>    string name
33030>>>    clear witemx
INCLUDING FILE: WITEMX.FD
33031>>>    move syscurxr.company_code to witemx.company_code
33032>>>    move syscurxr.branch_code  to witemx.branch_code
33033>>>    move syscurxr.year_year    to witemx.year_year
33034>>>    move code to witemx.witemx_code
33035>>>    find eq witemx by index.5
33036>>>>
33036>>>    move witemx.witemx_descr to name
33037>>>    function_return name
33038>>>end_Function
33039>>>
33039>>>Function fsCNDescr String asItem Returns String
33040>>>    Clear CN
33041>>>    move asItem to CN.CN_Code
33042>>>    Find Eq CN by Index.5
33043>>>>
33043>>>    Function_Return CN.CN_Descr
33044>>>End_Function
33045>>>
33045>>>Function fswtypkin String askin Returns String
33046>>>    Clear Wtypkin
33047>>>    move askin to Wtypkin.wtypkin_code
33048>>>    Find Eq wtypkin by Index.1
33049>>>>
33049>>>    Function_Return Wtypkin.wtypkin_descr
33050>>>End_Function
33051>>>
33051>>>Function FindGtypkinDescr Integer aiCode Returns String
33052>>>    String lsDescr
33053>>>    Clear Gtypkin
INCLUDING FILE: GTYPKIN.FD
33054>>>    Move syscurxr.company_code    to Gtypkin.Company_Code
33055>>>    Move syscurxr.Branch_Code     to Gtypkin.Branch_Code
33056>>>    Move syscurxr.Year_year       to Gtypkin.Year_Year
33057>>>    Move aiCode                   to Gtypkin.Gtypkin_Code
33058>>>    Find eq Gtypkin by Index.1
33059>>>>
33059>>>    [Found] Move Gtypkin.Gtypkin_Descr to lsDescr
33060>>>    Function_Return lsDescr
33061>>>End_Function // FindGtypkinDescr
33062>>>
33062>>>Function FindBtypkinDescr Integer aiCode Returns String
33063>>>    String lsDescr
33064>>>    Clear Btypkin
INCLUDING FILE: BTYPKIN.FD
33065>>>    Move syscurxr.company_code    to Btypkin.Company_Code
33066>>>    Move syscurxr.Branch_Code     to Btypkin.Branch_Code
33067>>>    Move syscurxr.Year_year       to Btypkin.Year_Year
33068>>>    Move aiCode                   to Btypkin.btypkin_Code
33069>>>    Find eq Btypkin by Index.1
33070>>>>
33070>>>    [Found] Move Btypkin.Btypkin_Descr to lsDescr
33071>>>    Function_Return lsDescr
33072>>>End_Function // FindGtypkinDescr
33073>>>
33073>>>
33073>Use Connect.Dg
INCLUDING FILE: CONNECT.DG
33073>>>//AB/ Project Connect
33073>>>//AB/ Object prj is a Dialog_Project
33073>>>//AB/     Set ProjectName to "Connect"
33073>>>//AB/     Set ProjectFileName to "CONNECT.DG"
33073>>>
33073>>>// Project Object Structure
33073>>>//   Connect is a BasicPanelSub
33073>>>//     BitmapContainer1 is a BitmapContainerSub
33073>>>//     Textbox5 is a TextBoxSub
33073>>>//     ComboForm2 is a ComboFormSub
33073>>>//     Textbox6 is a TextBoxSub
33073>>>//     Form4 is a FormSub
33073>>>//     Textbox7 is a TextBoxSub
33073>>>//     Form5 is a FormSub
33073>>>//     Textbox8 is a TextBoxSub
33073>>>//     Form6 is a FormSub
33073>>>//     CheckBox1 is a CheckBoxSub
33073>>>//     oOK_bn is a ButtonSub
33073>>>//     oCancel_bn is a ButtonSub
33073>>>
33073>>>// Register all objects
33073>>>Register_Object BitmapContainer1
33073>>>Register_Object CheckBox1
33073>>>Register_Object ComboForm2
33073>>>Register_Object Connect
33073>>>Register_Object Form4
33073>>>Register_Object Form5
33073>>>Register_Object Form6
33073>>>Register_Object oCancel_bn
33073>>>Register_Object oOK_bn
33073>>>Register_Object Textbox5
33073>>>Register_Object Textbox6
33073>>>Register_Object Textbox7
33073>>>Register_Object Textbox8
33073>>>
33073>>>
33073>>>
33073>>>//AB-StoreTopStart
33073>>>
33073>>>///#INCLUDE
33073>>>Use mertech.inc
INCLUDING FILE: MERTECH.INC
33073>>>>>USE UI
33073>>>>>
#REM -----------------------------------------------
#REM MERTECH DATA SYSTEMS INC. - WWW.MERTECHDATA.COM
#REM MERTECH.INC VERSION 2.1.9
#REM -----------------------------------------------
33073>>>>>
33073>>>>>
33073>>>>>
33073>>>>>
33073>>>>>
33073>>>>>//
33073>>>>>//
33073>>>>>//
33073>>>>>//
33073>>>>>//
33073>>>>>//-----------------------------------------------
33073>>>>>// SELECT_COLUMNS_FIND <FILE> <START> THRU <END>
33073>>>>>// SELECT_COLUMNS_FIND <FILE> <FIELD>
33073>>>>>// This command will issue a properly commands to define the FETCH attribute status
33073>>>>>// for file fields.
33073>>>>>//
33073>>>>>//------------------------------------------------------------------------------
33073>>>>>// RESET_FETCH_FIELDS <FILE NAME>|<FILE NUMBER> <DF_FETCH_TRUE>|<DF_FETCH_FALSE>
33073>>>>>//
33073>>>>>//
33073>>>>>//-----------------------------
33073>>>>>// SQL_FOR_ONEROW <file number>
33073>>>>>//
33073>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get just
33073>>>>>// one ROW for each DataFlex FIND command issued
33073>>>>>// In this case the DBMS optimizer will generate a query with just one row
33073>>>>>//
33073>>>>>//
33073>>>>>//-------------------------------------------------------------------------------
33073>>>>>// SQL_FOR_SET <file number> MAXROWS <number of rows> CACHE|NOCACHE <return code>
33073>>>>>//
33073>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get a SET of rows.
33073>>>>>// In this case the DBMS optimizer will generate a query with <number of rows> Rows.
33073>>>>>// if CACHE is passed as argument, all these rows will be transfered to ORAFlex and then it will
33073>>>>>// save them in a local CACHE buffer. Just the FIND GT and FIND LT will get local cache.
33073>>>>>// Otherwise, i.e NOCACHE,  ORAFLex won't create a local cache.
33073>>>>>//
33073>>>>>//
33073>>>>>//---------------
33073>>>>>// SQL_SET <stmt>
33073>>>>>//
33073>>>>>//-----------------------------------------
33073>>>>>// SQL_APPEND <stmt1> <stmt2> .... <stmtn>
33073>>>>>//
33073>>>>>//------------
33073>>>>>// SQL_EXECUTE
33073>>>>>//
33073>>>>>//----------------------------------------------------------------------
33073>>>>>// LOCK_TABLE [<FILE NAME>|<FILE NUMBER> <FILE NAME>|<FILE NUMBER> ....]
33073>>>>>//
33073>>>>>// LOCK_TABLE will lock the entire table specified as an argument
33073>>>>>// This command will start a new transaction if it still wasn't done.
33073>>>>>// LOCK_TABLE won't lock the other opened tables or the current rows present
33073>>>>>// in their buffers it will be necessary issue a REREAD command to Lock the current
33073>>>>>// rows and then atualize their buffers
33073>>>>>//
33073>>>>>//
33073>>>>>//-------------------------------------------
33073>>>>>// SQL_CHECK_TABLE <SCHEMA NAME> <TABLE NAME>
33073>>>>>//
33073>>>>>//-------------------------------
33073>>>>>// CREATE_TD_FILE  DFTRUE|DFFALSE
33073>>>>>// SET A GLOBAL ATTRIBUTE TO CREATE THE TD FILE AFTER CLOSING AN OPENED FILE
33073>>>>>//
33073>>>>>//-------------------------------------------------
33073>>>>>// OPEN_INT <DATAFLEX FILE NAME>
33073>>>>>// OPEN_INT <PHYSICAL NAME> AS <DATAFLEX FILE NAME>
33073>>>>>//
33073>>>>>// OPEN_INT will check if the OPEN done is an OPEN AS. IF it's true, OPEN_INT
33073>>>>>// will try to open an intermediate file, if there is one. Otherwise OPEN_INT
33073>>>>>// will issue a OPEN command
33073>>>>>// OPEN_INT must be inserted into FMAC file instead OPEN COMMAND
33073>>>>>//
33073>>>>>//=========================================================================================================
33073>>>>>// SELECT STUFFS
33073>>>>>//--------------
33073>>>>>// SQL_SET_STMT OF FILENAME|FILENUMBER TO <STATMENT1>
33073>>>>>//
33073>>>>>// SQL_APPEND_ OF FILENAME|FILENUMBER TO <STATMENT1> <STATMENT2> ... <STATMENTn>
33073>>>>>//
33073>>>>>//
33073>>>>>// SQL_APPEND_UPDCOL_STMT OF FILENAME|FILENUMBER VALUE EXPRESSION WITH FIELD1 FIELD2 ... FIELDN
33073>>>>>//
33073>>>>>// SQL_PREPARE_STMT OF FILENAME|FILENUMBER
33073>>>>>//
33073>>>>>// SQL_BIND_COLUMN [FILENAME|FILENUMBER] [FIELDNAME|FIELDNUMBER]
33073>>>>>//
33073>>>>>// SQL_BINDCOLUMNS_STMT OF FILENAME|FILENUMBER TO <COLUMN1> <COLUMN2> ... <COLUMNn>
33073>>>>>//
33073>>>>>// SQL_EXECUTE_STMT OF FILENAME|FILENUMBER
33073>>>>>//
33073>>>>>// SQL_COMMIT_STMT
33073>>>>>//
33073>>>>>// SQL_ROLLBACK_STMT
33073>>>>>//
33073>>>>>// SQL_FETCH_NEXT_ROW OF FILENAME|FILENUMBER
33073>>>>>//
33073>>>>>//
33073>>>>>//
33073>>>>>//
33073>>>>>// CALL_STORED_PROCEDURE will call a stored procedure passing arguments
33073>>>>>//
33073>>>>>// FORMAT TO USE : CALL_STORED_PROCEDURE <STORED_PROC_NAME> [PASSING <ARG1> <ARG2> ....<ARGn>]
33073>>>>>//
33073>>>>>//
33073>>>>>//---------------------------------------------------------------------------------------------
33073>>>>>// CALL_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
33073>>>>>// CALL_STORED_FUNCTION will call an Oracle stored function passing arguments
33073>>>>>//
33073>>>>>//---------------------------
33073>>>>>// SQL_TEXT_MESSAGE <MESSAGE>
33073>>>>>// Writes a message inside driver log trace file if this is activated
33073>>>>>//
33073>>>>>//-----------------------------------------------------
33073>>>>>// OUTPUT_INT_FILE FOR <FILE NUMBER> TO <INT FILE NAME>
33073>>>>>// Generating the INT file
33073>>>>>//
33073>>>>>// -----------------------
33073>>>>>// SQL_ERROR_MESSAGE <VAR>
33073>>>>>// SQL_ERROR_MESSAGE retrieve the native error message issued by server for error number 25000
33073>>>>>
33073>>>>>
33073>>>>>//=======================================================================================
33073>>>>>// SQLFlex Commands
33073>>>>>//-----------------
33073>>>>>//
33073>>>>>//-----------------------
33073>>>>>// SQLFlex_REVISION <VAR>
33073>>>>>// Retrieves SQLFlex revision
33073>>>>>//
33073>>>>>//-------------------------------------
33073>>>>>// SET_DATABASE_NAME TO <DATABASE NAME>
33073>>>>>// Sets current database
33073>>>>>//
33073>>>>>//---------------------------
33073>>>>>// GET_DATABASE_NAME TO <VAR>
33073>>>>>// Gets name of current database
33073>>>>>//
33073>>>>>//----------------------------------
33073>>>>>// SET_SCHEMA_NAME TO <SCHEMA NAME>
33073>>>>>// Sets current schema name
33073>>>>>//
33073>>>>>//-------------------------
33073>>>>>// GET_SCHEMA_NAME TO <VAR>
33073>>>>>// Gets current schema name
33073>>>>>//
33073>>>>>//--------------------------------
33073>>>>>// SQL_USEDATABASE <DATABASE NAME>
33073>>>>>// Specifies the current Database
33073>>>>>//
33073>>>>>//----------------------------
33073>>>>>// SET_CURRENT_SERVER TO <VAR>
33073>>>>>// Set the current logged server
33073>>>>>//
33073>>>>>//----------------------------
33073>>>>>// GET_CURRENT_SERVER TO <VAR>
33073>>>>>// Retrieves the current logged server
33073>>>>>//
33073>>>>>//-----------------------------
33073>>>>>// SET_HOST_NAME TO <HOST NAME>
33073>>>>>// Defines current host name
33073>>>>>//
33073>>>>>//-----------------------
33073>>>>>// GET_HOST_NAME TO <VAR>
33073>>>>>// Retrieves the current host name
33073>>>>>//
33073>>>>>//---------------------------------------------------------------
33073>>>>>// LOGIN_SQLFLEX <SERVER NAME> <USER NAME> <PASSWORD> <HOST NAME>
33073>>>>>// Specifies host name during login process
33073>>>>>//
33073>>>>>// SQL_CANCEL_QUERY_STMT
33073>>>>>//
33073>>>>>//========================================
33073>>>>>// SQL SERVER Stored Procedure Call engine
33073>>>>>//----------------------------------------
33073>>>>>//
33073>>>>>//
33073>>>>>
33073>>>>>//
33073>>>>>//--------------------------------------------------------------------------------------------------------------
33073>>>>>// CALL_SQLSERVER_PROCEDURE <procedure name> PASSING <VALUE1|VARIABLE1> [SQLOUT] <VALUE2|VARIABLE2> [SQLOUT] ...
33073>>>>>//
33073>>>>>// Executes a stored procedure. SQLOUT will be used to indicate that the stored procedure
33073>>>>>// returns a parameter. The matching parameter in the stored proceudre must have been created with
33073>>>>>// the keyword OUTPUT. Call all procedures that doesn't returns any query with this syntax
33073>>>>>//
33073>>>>>//
33073>>>>>//
33073>>>>>//-----------------------------------------------------------------------------
33073>>>>>
33073>>>>>
33073>>>>>//=============================================================================
33073>>>>>// ORAFlex Commands
33073>>>>>//-----------------
33073>>>>>//----------------------------
33073>>>>>// ORAFlex_REVISION <VARIABLE>
33073>>>>>// Retrieves ORAFlex revision
33073>>>>>//
33073>>>>>//---------------------------------
33073>>>>>// KEEP_FILES_OPEN OF <SERVER NAME>
33073>>>>>// Keeps all files opened even during a LOGOUT
33073>>>>>//
33073>>>>>//-----------------------------------------------
33073>>>>>// SET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
33073>>>>>// Defines the maximum number of cursors that ORAFlex will be allowed for using
33073>>>>>//
33073>>>>>//-----------------------------------------------
33073>>>>>// GET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
33073>>>>>// Retrieves the maximum number of cursors allowed for ORAFlex use
33073>>>>>//
33073>>>>>//---------------------------------------------
33073>>>>>// GET_OPENED_CURSORS OF <SERVER NAME> TO <VAR>
33073>>>>>// Retrieves the number of opened cursors
33073>>>>>//
33073>>>>>//-----------------------------------------------
33073>>>>>// ACTIVATE_TIME_STAMP OF <SERVER NAME> TO ON|OFF
33073>>>>>// Activates Time stamp for date columns
33073>>>>>//
33073>>>>>//----------------------------------------------------------------------------------------------------
33073>>>>>// CALL_ORACLE_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
33073>>>>>// CALL_ORACLE_STORED_FUNCTION will call an Oracle stored function passing arguments
33073>>>>>//
33073>>>>>//-----------------------------------------------------------------------------
33073>>>>>
33073>>>>>//=============================================================================
33073>>>>>// BUFFER save stuffs
33073>>>>>//-------------------
33073>>>>>
33073>>>>>//-------------------------------------------------------
33073>>>>>// SQL_SAVE_BUFFER_BEGIN OF <FILE NUMBER> TO <CACHE SIZE>
33073>>>>>// Initialize the BUFFER buffer
33073>>>>>//
33073>>>>>//---------------------------------
33073>>>>>// SQL_SAVE_BUFFER OF <FILE NUMBER>
33073>>>>>// Moves field buffer values to cache buffer
33073>>>>>//-------------------------------------
33073>>>>>// SQL_SAVE_BUFFER_END OF <FILE NUMBER>
33073>>>>>// Save rows that remains in cache
33073>>>>>//-----------------------------------------------------------------------------
33073>>>>>
33073>>>
33073>>>//AB-StoreTopEnd
33073>>>
33073>>>//AB-IgnoreStart
33073>>>
33073>>>Use Panel.Sub
33073>>>Use Bitmap.Sub
33073>>>Use Txtbox.Sub
33073>>>Use Cmbfrm.Sub
33073>>>Use Form.Sub
33073>>>Use Chkbox.Sub
33073>>>Use Button.Sub
33073>>>
33073>>>
33073>>>//AB-IgnoreEnd
33073>>>
33073>>>Object Connect is a BasicPanelSub
33075>>>
33075>>>    //AB-StoreTopStart
33075>>>
33075>>>    //AB-StoreTopEnd
33075>>>
33075>>>    Set Sysmenu_Icon to FALSE
33076>>>    Set Minimize_Icon to FALSE
33077>>>    Set Label to "Login"
33078>>>    Set Size to 105 230
33079>>>    Set Location to 20 37
33080>>>
33080>>>    //AB-DDOStart
33080>>>
33080>>>
33080>>>    //AB-DDOEnd
33080>>>
33080>>>    Object BitmapContainer1 is a BitmapContainerSub
33082>>>        Set Size to 21 23
33083>>>        Set Location to 4 4
33084>>>        Set Bitmap to "Login1.bmp"
33085>>>        Set Border_Style to Border_None
33086>>>        Set Bitmap_Style to Bitmap_Center
33087>>>        Set Dialog_Caption to "Select a bitmap file"
33088>>>
33088>>>        //AB-StoreStart
33088>>>
33088>>>
33088>>>
33088>>>
33088>>>        //AB-StoreEnd
33088>>>
33088>>>    End_Object    // BitmapContainer1
33089>>>
33089>>>    Object Textbox5 is a TextBoxSub
33091>>>        Set Label to "Driver:"
33092>>>        Set FontSize to 4 0
33093>>>        Set Location to 6 34
33094>>>        Set Size to 13 40
33095>>>        Set Enabled_State to TRUE
33096>>>    End_Object    // Textbox5
33097>>>
33097>>>    Object ComboForm2 is a ComboFormSub
33099>>>
33099>>>        //AB-StoreTopStart
33099>>>
33099>>>        Set CapsLock_State to True
33100>>>
33100>>>        //AB-StoreTopEnd
33100>>>
33100>>>        Set Size to 13 85
33101>>>        Set Location to 6 76
33102>>>        Set Label_Col_Offset to 2
33103>>>        Set Label_Justification_Mode to jMode_Right
33104>>>
33104>>>        //AB-StoreStart
33104>>>        Procedure Combo_Fill_List
33106>>>                Local String Availdrv## TempDrv##
33107>>>                Local Integer HowMany i p1## p2##
33107>>>
33107>>>                get_profile_string "WorkSpaces" "CurrentWorkspace" to AvailDrv##
33110>>>                If AvailDrv## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to AvailDrv##
33113>>>                insert "WorkSpaces\" in AvailDrv## at 1
33115>>>                get_profile_string AvailDrv## "AvailableDrivers" to AvailDrv##
33118>>>
33118>>>                Move Availdrv## to Tempdrv##
33119>>>                Repeat
33119>>>>
33119>>>                    Replace "|" in Tempdrv## With ""
33121>>>                    [Found] Increment HowMany
33122>>>                Until [Finderr]
33124>>>
33124>>>                Send Combo_add_Item ""
33125>>>
33125>>>                If HowMany lt 1 Begin
33127>>>                    If Availdrv## ne "" Send Combo_Add_Item (UpperCase(Availdrv##))
33130>>>                End
33130>>>>
33130>>>                Else Begin
33131>>>                    For i From 0 to HowMany
33137>>>>
33137>>>                        If i eq 0 Move 1 to p1##
33140>>>                        Else Begin
33141>>>                            Move ((Pos("|",Availdrv##))+1) to p1##
33142>>>                            Replace "|" in Availdrv## With ","
33144>>>                        End
33144>>>>
33144>>>                        Move ((Pos("|",Availdrv##))) to p2##
33145>>>                        Send Combo_Add_Item (UpperCase(Mid(Availdrv##,(p2##-p1##),p1##)))
33146>>>                    Loop
33147>>>>
33147>>>                End
33147>>>>
33147>>>        End_Procedure
33148>>>
33148>>>        Set Allow_Blank_state to True
33149>>>
33149>>>
33149>>>
33149>>>        //AB-StoreEnd
33149>>>
33149>>>    End_Object    // ComboForm2
33150>>>
33150>>>    Object Textbox6 is a TextBoxSub
33152>>>        Set Label to "Server:"
33153>>>        Set FontSize to 4 0
33154>>>        Set Location to 22 34
33155>>>        Set Size to 13 40
33156>>>        Set Enabled_State to TRUE
33157>>>    End_Object    // Textbox6
33158>>>
33158>>>    Object Form4 is a FormSub
33160>>>        Set Size to 13 93
33161>>>        Set Location to 22 76
33162>>>        Set Label_Col_Offset to 2
33163>>>        Set Label_Justification_Mode to jMode_Right
33164>>>    End_Object    // Form4
33165>>>
33165>>>    Object Textbox7 is a TextBoxSub
33167>>>        Set Label to "User Name:"
33168>>>        Set FontSize to 4 0
33169>>>        Set Location to 38 34
33170>>>        Set Size to 13 40
33171>>>        Set Enabled_State to TRUE
33172>>>    End_Object    // Textbox7
33173>>>
33173>>>    Object Form5 is a FormSub
33175>>>        Set Size to 13 93
33176>>>        Set Location to 38 76
33177>>>        Set Label_Col_Offset to 2
33178>>>        Set Label_Justification_Mode to jMode_Right
33179>>>    End_Object    // Form5
33180>>>
33180>>>    Object Textbox8 is a TextBoxSub
33182>>>        Set Label to "Password:"
33183>>>        Set FontSize to 4 0
33184>>>        Set Location to 54 34
33185>>>        Set Size to 13 40
33186>>>        Set Enabled_State to TRUE
33187>>>    End_Object    // Textbox8
33188>>>
33188>>>    Object Form6 is a FormSub
33190>>>        Set Size to 13 93
33191>>>        Set Location to 54 76
33192>>>        Set Label_Col_Offset to 2
33193>>>        Set Label_Justification_Mode to jMode_Right
33194>>>
33194>>>        //AB-StoreStart
33194>>>        Set Password_State Item 0 to True
33195>>>
33195>>>        //AB-StoreEnd
33195>>>
33195>>>    End_Object    // Form6
33196>>>
33196>>>    Object CheckBox1 is a CheckBoxSub
33198>>>        Set Label to "Save Password"
33199>>>        Set Size to 10 66
33200>>>        Set Location to 73 76
33201>>>        Set Status_Help to "Remember The Password at Next Login"
33202>>>    End_Object    // CheckBox1
33203>>>
33203>>>    Object oOK_bn is a ButtonSub
33205>>>        Set Label to "Co&nnect"
33206>>>        Set Default_State to TRUE
33207>>>        Set Bitmap to "mcr.bmp"
33208>>>        Set Size to 28 33
33209>>>        Set Location to 9 184
33210>>>
33210>>>        //AB-StoreStart
33210>>>        Procedure OnClick
33212>>>            Set LoginOk to True
33213>>>            Send Stop_Modal_ui
33214>>>        End_Procedure
33215>>>        Set Status_Help to "Connect"
33216>>>        //AB-StoreEnd
33216>>>
33216>>>    End_Object    // oOK_bn
33217>>>
33217>>>    Object oCancel_bn is a ButtonSub
33219>>>        Set Label to "&Cancel"
33220>>>        Set Bitmap to "exit2.bmp"
33221>>>        Set Size to 28 32
33222>>>        Set Location to 39 184
33223>>>
33223>>>        //AB-StoreStart
33223>>>
33223>>>        ON_KEY KENTER SEND Exit_Application to (Connect(Current_Object))
33224>>>
33224>>>        Procedure OnClick
33226>>>            Set LoginOk to False
33227>>>            Send Exit_Application to (Connect(Current_Object))
33228>>>        End_Procedure
33229>>>
33229>>>        Set Status_Help to "Close Application"
33230>>>
33230>>>
33230>>>        //AB-StoreEnd
33230>>>
33230>>>    End_Object    // oCancel_bn
33231>>>
33231>>>
33231>>>    //AB-StoreStart
33231>>>
33231>>>    Set Modal_State to True
33232>>>
33232>>>    // Now is WorkspaceAware
33232>>>
33232>>>    ON_KEY KENTER SEND OnClick to (oOk_bn(Current_Object))
33233>>>    ON_KEY KSAVE_RECORD SEND OK
33234>>>    ON_KEY KCANCEL SEND EXIT_APPLICATION
33235>>>    ON_KEY KCLOSE_PANEL SEND EXIT_APPLICATION
33236>>>
33236>>>    Set Locate_Mode to Center_On_Screen
33237>>>    Set Exit_Application_Local_State to False
33238>>>    Set Exit_MSG to Exit
33239>>>    Set Description_State to True
33240>>>
33240>>>    Property Integer LoginOk public false
33242>>>
33242>>>    External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;        Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
33243>>>
33243>>>    Function Network_User_Name Returns String
33245>>>        Local String sName sLength
33246>>>        Local Pointer lpName_Addr lpLength_Addr
33246>>>        Local Integer iRetval
33246>>>
33246>>>        Movestr (Repeat (Character (0), 255)) To sName
33247>>>>
33247>>>        GetAddress Of sName To lpName_Addr
33248>>>        Movestr (DwordToBytes (255)) To sLength
33249>>>>
33249>>>        GetAddress Of sLength To lpLength_Addr
33250>>>
33250>>>        Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
33251>>>>
33251>>>
33251>>>        If iRetval Eq 0 Function_Return (CString (sName))
33254>>>        Else Function_Return "User Unknown"
33256>>>    End_Function // Network_User_Name
33257>>>
33257>>>    Function fsCrypto String lsWay String lsOld Returns String
33259>>>        Local String lsNew lsTemp
33260>>>        Local Integer liCount
33260>>>           For liCount From 1 to (Length(lsOld))
33266>>>>
33266>>>               Mid lsOld to lsTemp 1 liCount
33269>>>>
33269>>>               If ((Uppercase(lsWay)) eq 'FORWARD') Begin
33271>>>               If ((Ascii(lsTemp) = 255)) Move (Character(32)) to lsTemp
33274>>>               Else Move (Character(Ascii(lsTemp)+1)) to lsTemp
33276>>>               End
33276>>>>
33276>>>               Else Begin
33277>>>                   If ((Uppercase(lsWay)) eq 'BACKWARD') Begin
33279>>>                       If ((Ascii(lsTemp) = 32)) Move (Character(255)) to lsTemp
33282>>>                       Else Move (Character(Ascii(lsTemp)-1)) to lsTemp
33284>>>                   End
33284>>>>
33284>>>               End
33284>>>>
33284>>>               Append lsNew lsTemp
33285>>>           Loop
33286>>>>
33286>>>        Function_Return (lsNew)
33287>>>    End_Function
33288>>>
33288>>>    Procedure Activating
33290>>>        Local String LoginDriver## LoginServer## LoginUserid## LoginPassword##
33291>>>        Local String LastLogin## LoginSeq##
33291>>>        Local Integer SavePassword##
33291>>>
33291>>>        Forward Send Activating
33293>>>
33293>>>        get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
33296>>>        If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
33299>>>        insert "WorkSpaces\" in LastLogin## at 1
33301>>>        Append LastLogin## "\" (Module_Name(Self)) "\LastLogin"
33304>>>        get_profile_string LastLogin## "LoginDriver" to LoginSeq##
33307>>>
33307>>>        If "|" in LoginSeq## move (left(LoginSeq##,(pos("|",LoginSeq##) -1))) to LoginDriver##
33310>>>        Else Move LoginSeq## to LoginDriver##
33312>>>        get_profile_string LastLogin## "LoginServer"  to LoginServer##
33315>>>        get_profile_string LastLogin## "LoginUserId"  to LoginUserId##
33318>>>        get_profile_string LastLogin## "SavePassword" to SavePassword##
33321>>>        If LoginUserId## eq "" Move (Network_User_Name(Current_Object)) to LoginUserId##
33324>>>
33324>>>        If (((UpperCase(LoginDriver##)) eq "DATAFLEX") or (LoginDriver## eq "")) Begin
33326>>>                Set Value of (ComboForm2(Current_Object)) Item 0 to ""
33327>>>                Set Value of (Form4(Current_Object))      Item 0 to ""
33328>>>        End
33328>>>>
33328>>>        Else Begin
33329>>>            Set Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
33330>>>            Set Value of (Form4(Current_Object))      Item 0 to LoginServer##
33331>>>        End
33331>>>>
33331>>>        Set Value of (Form5(Current_Object))      Item 0 to LoginUserID##
33332>>>        Set Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
33333>>>        If (SavePassword##) Begin
33335>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33336>>>            get_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to LoginPassword##
33340>>>            Set Value of (Form6(Current_Object))      Item 0 to (fsCrypto(Self,"backward",LoginPassword##))
33341>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33342>>>        End
33342>>>>
33342>>>    End_Procedure
33343>>>
33343>>>    Function LoginUser Returns Integer
33345>>>        Integer SavePassword## Size## PasswordOk
33346>>>        String LoginDriver## LoginServer## LoginUserid## LoginPassword## LoginSeq## LastLogin##
33346>>>        String lsLoginDate lsHH lsMM lsSS sDepartment
33346>>>        Integer liOpenCursors
33346>>>
33346>>>        Send Popup_Modal
33347>>>
33347>>>        Get Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
33348>>>        Get Value of (Form4(Current_Object))      Item 0 to LoginServer##
33349>>>        Get Value of (Form5(Current_Object))      Item 0 to LoginUserID##
33350>>>        Get Value of (Form6(Current_Object))      Item 0 to LoginPassword##
33351>>>        Get Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
33352>>>        Set Value of (Form6(Current_Object))      Item 0 to ""
33353>>>
33353>>>        If ((LoginDriver## <> "") and (UpperCase(LoginDriver##)<>"DATAFLEX"))  begin
33355>>>            send ignore_error to (error_info_object(current_object)) 25000
33356>>>            send ignore_error to (error_info_object(current_object)) 4255
33357>>>            send ignore_error to (error_info_object(current_object)) 12293
33358>>>            login LoginServer## LoginUserId## LoginPassword## LoginDriver##
33360>>>            send trap_error to (error_info_object(current_object)) 25000
33361>>>            send trap_error to (error_info_object(current_object)) 4255
33362>>>            send trap_error to (error_info_object(current_object)) 12293
33363>>>            If LastErr eq 25000 Begin
33365>>>                Error LastErr "Invalid Login Information"
33366>>>>
33366>>>                Set LoginOk to False
33367>>>                Send Exit_Application
33368>>>            End
33368>>>>
33368>>>            If LastErr eq 4255 Begin
33370>>>                Error LastErr "Invalid Driver Name"
33371>>>>
33371>>>                Set LoginOk to False
33372>>>                Send Exit_Application
33373>>>            End
33373>>>>
33373>>>            If LastErr eq 12293 Begin
33375>>>                Error LastErr "(IBM CLI)Database alias name or Database name not found"
33376>>>>
33376>>>                Set LoginOk to False
33377>>>                Send Exit_Application
33378>>>            End
33378>>>>
33378>>>            Set LoginOk to True
33379>>>            If (UpperCase(LoginDriver##) = "ORA_DRV") Begin
33381>>>                GET_MAX_OPEN_CURSORS of LoginServer## to liOpenCursors
33394>>>                If (liOpenCursors <> 0) SET_MAX_OPEN_CURSORS of LoginServer## to (liOpenCursors+2)
33407>>>            End
33407>>>>
33407>>>        End
33407>>>>
33407>>>        Else Begin
33408>>>            Set LoginOk to True
33409>>>            Open "Users" as Users
INCLUDING FILE: USERS.FD
33411>>>            Move "DATAFLEX" To LoginDriver##
33412>>>            Move "" to LoginServer##
33413>>>            File_Size Users to Size##
33416>>>            If Size## ne 0 Begin
33418>>>                 Clear Users
33419>>>                 Move LoginUSerId##   to Users.Login_Id
33420>>>                 Find eq Users by Index.1
33421>>>>
33421>>>                 [Finderr] Begin
33423>>>>
33423>>>                    Error 25000 "Unknown User"
33424>>>>
33424>>>                    Set LoginOk to False
33425>>>                    Get LoginOk to PasswordOk
33426>>>                    Function_Return PasswordOk
33427>>>                 End
33427>>>>
33427>>>                 [Found] Begin
33429>>>>
33429>>>                    If (LoginPassword## ne Users.Password) Begin
33431>>>                        Error 25000 "Invalid Password"
33432>>>>
33432>>>                        Set LoginOk to False
33433>>>                        Get LoginOk to PasswordOk
33434>>>                        Function_Return PasswordOk
33435>>>                    End
33435>>>>
33435>>>                    Else Move Users.Departm_Code to sDepartment
33437>>>                    Move (Trim(sDepartment)) to sDepartment
33438>>>                 End
33438>>>>
33438>>>            End
33438>>>>
33438>>>            Close Users
33439>>>
33439>>>
33439>>>    //            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33439>>>    //            Integer bFileExists
33439>>>    //            Get Get_File_Exists  "C:\AutLogIn.txt" To bFileExists
33439>>>    //            If (NOT(bFileExists)) Begin
33439>>>
33439>>>    //                Get Get_File_Exists  "C:\UsrLogin.txt" To bFileExists
33439>>>    //                If (bFileExists) Begin
33439>>>
33439>>>    ////                        If Size## ne 0 Begin
33439>>>
33439>>>    //                            Local String ss1 ss2 ss3 ss4
33439>>>    //                            Local String dd1 dd2 dd3 dd4
33439>>>    //                            Move '' to dd1
33439>>>    //                            Move '' to dd2
33439>>>    //                            Move '' to dd3
33439>>>    //                            Move '' to dd4
33439>>>
33439>>>    //                            Direct_Input Channel 8 "C:\UsrLogin.txt"
33439>>>    //                            Readln Channel 8 ss1 ss2 ss3 ss4
33439>>>    //                            While (Not(Seqeof))
33439>>>    //                                Move (Trim(ss1)) to ss1
33439>>>    //                                Move (Trim(ss2)) to ss2
33439>>>    //                                Move (Trim(ss3)) to ss3
33439>>>    //                                Move (Trim(ss4)) to ss4
33439>>>    //                                Append dd1 '"' ss1 '"'
33439>>>    //                                Append dd2 '"' ss2 '"'
33439>>>    //                                Append dd3 '"' ss3 '"'
33439>>>    //                                Append dd4 '"' ss4 '"'
33439>>>    //                                Login dd1 dd2 dd3 dd4
33439>>>    //                                Readln Channel 8 ss1 ss2 ss3 ss4
33439>>>    //                            Loop
33439>>>
33439>>>
33439>>>    ////                            // Only Filmnet Users Log on to SQL
33439>>>    ////                            If (sDepartment='FILMNET') Begin
33439>>>    ////                                ////// 20/06/2001 js Allagh apo Oracle se SQL server
33439>>>    ////                                ////// login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33439>>>    ////                                login '192.168.128.5'   'sa'    ''   'SQL_DRV'
33439>>>    ////                                login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33439>>>    ////                            End
33439>>>    ////                            Else login '192.168.128.5'      'sa'    ''   'SQL_DRV'
33439>>>    ////                            //Else login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33439>>>
33439>>>    ////                        End
33439>>>    ////                        Else Begin
33439>>>    ////                            ////// 20/06/2001 js Allagh apo Oracle se SQL server
33439>>>    ////                            ///// login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33439>>>    ////                            login '192.168.128.5'       'sa'    ''   'SQL_DRV'
33439>>>    ////                            //login '192.168.128.5'   'EPGDNS'    'DNS'   'SQL_DRV'
33439>>>    ////                            login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33439>>>    ////                        End
33439>>>
33439>>>
33439>>>    //                End
33439>>>
33439>>>    //            End
33439>>>    //            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33439>>>
33439>>>
33439>>>
33439>>>            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33439>>>            //*Integer bFileExists
33439>>>            //*Get Get_File_Exists  "C:\AutLogIn.txt" To bFileExists
33439>>>            //*If (NOT(bFileExists)) Begin
33439>>>            //*    If Size## ne 0 Begin
33439>>>            //*        // Only Filmnet Users Log on to SQL
33439>>>            //*        If (sDepartment='FILMNET') Begin
33439>>>            //*            login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33439>>>            //*            login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33439>>>            //*        End
33439>>>            //*        Else login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33439>>>            //*    End
33439>>>            //*    Else Begin
33439>>>            //*        login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33439>>>            //*        login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33439>>>            //*    End
33439>>>            //*
33439>>>            //*End
33439>>>            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33439>>>
33439>>>
33439>>>
33439>>>        End
33439>>>>
33439>>>
33439>>>        Get LoginOk to PasswordOk
33440>>>        Sysdate lsLoginDate lsHH lsMM lsSS
33444>>>        get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
33447>>>        If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
33450>>>        insert "WorkSpaces\" in LastLogin## at 1
33452>>>        get_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
33455>>>        If ((LoginDriver## ne "") and ((UpperCase(LoginDriver##)) ne "DATAFLEX")) Begin
33457>>>           If Not LoginDriver## in LoginSeq## Begin
33459>>>                 If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
33462>>>                 Else Move (LoginSeq##+"|"+LoginDriver##) to LoginSeq##
33464>>>                 set_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
33467>>>           End
33467>>>>
33467>>>        End
33467>>>>
33467>>>        Append LastLogin## "\" (Module_Name(Self))
33469>>>        Append LastLogin## "\LastLogin"
33470>>>        get_profile_string LastLogin## "LoginDriver" to LoginSeq##
33473>>>
33473>>>        If "|" in LoginSeq## Begin
33475>>>            If ((left(LoginSeq##,(pos("|",LoginSeq##) -1))) ne LoginDriver##) Insert (LoginDriver##+"|") in LoginSeq## at 1
33479>>>        End
33479>>>>
33479>>>        Else Begin
33480>>>            If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
33483>>>            Else If LoginSeq## ne LoginDriver## Insert (LoginDriver##+"|") in LoginSeq## at 1
33488>>>        End
33488>>>>
33488>>>        Left LoginSeq## to LoginSeq## 250
33490>>>>
33490>>>        set_profile_string LastLogin## "LoginDriver" to (UpperCase(LoginSeq##))
33493>>>        set_profile_string LastLogin## "LoginServer" to LoginServer##
33496>>>        set_profile_string LastLogin## "LoginUserId" to LoginUserId##
33499>>>        set_profile_string LastLogin## "SavePassword" to SavePassword##
33502>>>        If lsHH lt 10 Insert 0 in lsHH at 1
33506>>>        If lsMM lt 10 Insert 0 in lsMM at 1
33510>>>        If lsSS lt 10 Insert 0 in lsSS at 1
33514>>>        Append lsLoginDate " - " lsHH ":" lsMM ":" lsSS
33520>>>        set_profile_string LastLogin## "LoginTime" to lsLoginDate
33523>>>        If (SavePassword##) Begin
33525>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33526>>>            set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to (fsCrypto(Self,"forward",LoginPassword##))
33529>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33530>>>        End
33530>>>>
33530>>>        Else Begin
33531>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33532>>>            set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to ""
33535>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33536>>>        End
33536>>>>
33536>>>
33536>>>        Function_Return PasswordOk
33537>>>    End_Function
33538>>>
33538>>>    Procedure Login For Desktop
33539>>>        Local Integer LoginPassword##
33540>>>        Get LoginUser of (Connect(Current_Object)) to LoginPassword##
33541>>>        If Not LoginPassword## Send Exit_Application
33544>>>    End_Procedure
33545>>>
33545>>>    Function CheckLogin For Desktop Returns Integer
33546>>>        Local Integer LoginPassword##
33547>>>        Get LoginUser of (Connect(Current_Object)) to LoginPassword##
33548>>>        Function_Return LoginPassword##
33549>>>    End_Function
33550>>>
33550>>>
33550>>>
33550>>>    //AB-StoreEnd
33550>>>
33550>>>End_Object    // Connect
33551>>>
33551>>>
33551>>>//AB-StoreStart
33551>>>
33551>>>
33551>>>
33551>>>//AB-StoreEnd
33551>>>
33551>>>//AB/ End_Object    // prj
33551>Send Login
33552>Use Xrhsh.pkg
INCLUDING FILE: XRHSH.PKG
33552>>>//------------------------------
33552>>>Use SelectXr.Dg
INCLUDING FILE: SELECTXR.DG
33552>>>>>//AB/ Project SelectXr
33552>>>>>//AB/     Object prj is a Dialog_Project
33552>>>>>//AB/         Set ProjectName to "SelectXr"
33552>>>>>//AB/         Set ProjectFileName to "SelectXr.DG"
33552>>>>>//AB/         Set GenerateFileName to "NONAME"
33552>>>>>
33552>>>>>// Project Object Structure
33552>>>>>//   oSelectYear is a dbModalPanelSub
33552>>>>>//     Company_DD is a DataDictionary
33552>>>>>//     Branch_DD is a DataDictionary
33552>>>>>//     Year_DD is a DataDictionary
33552>>>>>//     Company_Company_Code is a dbFormSub
33552>>>>>//     Company_Company_Name is a dbFormSub
33552>>>>>//     Branch_Branch_Code is a dbFormSub
33552>>>>>//     Branch_Branch_Name is a dbFormSub
33552>>>>>//     Year_Year_Year is a dbFormSub
33552>>>>>//     Year_Year_Descr is a dbFormSub
33552>>>>>//     Year_Year_Entrydate is a dbFormSub
33552>>>>>//     oOk_bn is a ButtonSub
33552>>>>>//     oCancel_bn is a ButtonSub
33552>>>>>//     otxtCompany is a TextBoxSub
33552>>>>>//     otxtBranch is a TextBoxSub
33552>>>>>//     otxtYear is a TextBoxSub
33552>>>>>//     otxtWorkingDay is a TextBoxSub
33552>>>>>//     otxtWorkingDay is a TextBoxSub
33552>>>>>//     chkxr is a CheckBoxSub
33552>>>>>
33552>>>>>// Register all objects
33552>>>>>Register_Object Branch_Branch_Code
33552>>>>>Register_Object Branch_Branch_Name
33552>>>>>Register_Object Branch_DD
33552>>>>>Register_Object Company_Company_Code
33552>>>>>Register_Object Company_Company_Name
33552>>>>>Register_Object Company_DD
33552>>>>>Register_Object chkxr
33552>>>>>Register_Object oCancel_bn
33552>>>>>Register_Object oOk_bn
33552>>>>>Register_Object oSelectYear
33552>>>>>Register_Object otxtBranch
33552>>>>>Register_Object otxtCompany
33552>>>>>Register_Object otxtWorkingDay
33552>>>>>Register_Object otxtYear
33552>>>>>Register_Object Year_DD
33552>>>>>Register_Object Year_Year_Descr
33552>>>>>Register_Object Year_Year_Entrydate
33552>>>>>Register_Object Year_Year_Year
33552>>>>>
33552>>>>>
33552>>>>>
33552>>>>>    //AB-StoreTopStart
33552>>>>>
33552>>>>>
33552>>>>>
33552>>>>>
33552>>>>>           String  gs_selected_beto_site
33552>>>>>
33552>>>>>    Open SysCurXR
33554>>>>>    Open Nomisma
33556>>>>>
33556>>>>>    //AB-StoreTopEnd
33556>>>>>
33556>>>>>    //AB-IgnoreStart
33556>>>>>
33556>>>>>    Use DFAllEnt.pkg
33556>>>>>    Use dbForm.Sub
33556>>>>>    Use Button.Sub
33556>>>>>    Use Txtbox.Sub
33556>>>>>    Use Chkbox.Sub
33556>>>>>
33556>>>>>
33556>>>>>    Use COMPANY.DD
INCLUDING FILE: COMPANY.DD
33556>>>>>>>//DDB-FileStart
33556>>>>>>>//DDB-HeaderStart
33556>>>>>>>
33556>>>>>>>// File Name : COMPANY.DD
33556>>>>>>>// Class Name: Company_DataDictionary
33556>>>>>>>// Revision  : 60
33556>>>>>>>// Version   : 2
33556>>>>>>>
33556>>>>>>>Use  Windows           // Basic Definitions
33556>>>>>>>Use  DataDict          // DataDictionary Class Definition
33556>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
33556>>>>>>>
33556>>>>>>>Open Company
INCLUDING FILE: COMPANY.FD
33558>>>>>>>Open Branch
33560>>>>>>>
33560>>>>>>>//DDB-HeaderEnd
33560>>>>>>>//DDB-ValidationStart
33560>>>>>>>
33560>>>>>>>Register_Object Company_Company_Doy_VT
33560>>>>>>>Register_Object Company_Company_J_Code_VT
33560>>>>>>>
33560>>>>>>>Object Company_Company_Doy_VT  is a CodeValidationTable
33562>>>>>>>    Set Type_Value        To "DOY"
33563>>>>>>>    Set Allow_Blank_State To TRUE
33564>>>>>>>    //DDB-ValidationCustomStart
33564>>>>>>>    //DDB-ValidationCustomEnd
33564>>>>>>>End_Object   // Company_Company_Doy_VT
33565>>>>>>>
33565>>>>>>>Object Company_Company_J_Code_VT  is a CodeValidationTable
33567>>>>>>>    Set Type_Value        To "JOB"
33568>>>>>>>    Set Allow_Blank_State To TRUE
33569>>>>>>>    //DDB-ValidationCustomStart
33569>>>>>>>    //DDB-ValidationCustomEnd
33569>>>>>>>End_Object   // Company_Company_J_Code_VT
33570>>>>>>>//DDB-ValidationEnd
33570>>>>>>>//DDB-SelectionStart
33570>>>>>>>//DDB/ ExternalSelectionList sl001  sl001.sl
33570>>>>>>>Register_Object sl001
33570>>>>>>>//DDB-SelectionEnd
33570>>>>>>> 
33570>>>>>>>Class Company_DataDictionary  is a DataDictionary
33571>>>>>>> 
33571>>>>>>>    // Update:
33571>>>>>>> 
33571>>>>>>>    Procedure Update
33572>>>>>>>        Forward Send Update
33574>>>>>>>        move 'DOY' to company.doy_type
33575>>>>>>>        move 'JOB' to company.jcode_type 
33576>>>>>>>        // Insert Code Here
33576>>>>>>>    End_Procedure   // Update
33577>>>>>>> 
33577>>>>>>>
33577>>>>>>>    // Operation_Not_Allowed:
33577>>>>>>>
33577>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
33578>>>>>>>        // Insert Code Here
33578>>>>>>>        Case Begin
33578>>>>>>>             Case (iError_Num = 1001)
33580>>>>>>>                  Error 1001 "DDC 051:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª „«˜ ¨œå˜ª!\n\n‰œ¤æª ‰à› ¡æª"
33581>>>>>>>>
33581>>>>>>>             Case Break
33582>>>>>>>
33582>>>>>>>             Case Else
33582>>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
33584>>>>>>>        Case End
33584>>>>>>>    End_Procedure   // Operation_Not_Allowed
33585>>>>>>>
33585>>>>>>>
33585>>>>>>>    // Validate_Save:
33585>>>>>>>
33585>>>>>>>    Function Validate_Save  Returns Integer
33586>>>>>>>        Local Integer iReturnVal
33587>>>>>>>        Forward Get Validate_Save  To iReturnVal
33589>>>>>>>        If (Not(iReturnVal)) Begin
33591>>>>>>>            // Insert Code Here
33591>>>>>>>            If (Company.Company_Code="") Send Operation_Not_Allowed 1001
33594>>>>>>>        End
33594>>>>>>>>
33594>>>>>>>        Function_Return iReturnVal
33595>>>>>>>    End_Function   // Validate_Save
33596>>>>>>>
33596>>>>>>>
33596>>>>>>>    // Define_Fields:
33596>>>>>>>    // This procedure is used to set up all data-dictionary rules.
33596>>>>>>>
33596>>>>>>>    Procedure Define_Fields
33597>>>>>>>        Forward Send Define_Fields
33599>>>>>>>        //DDB-Generated-Code-Location
33599>>>>>>>        //DDB-DefineFieldStart
33599>>>>>>>
33599>>>>>>>        Set Main_File            To Company.File_Number
33600>>>>>>>        Set Cascade_Delete_State To FALSE
33601>>>>>>>
33601>>>>>>>
33601>>>>>>>        // Child (Client) file structure................
33601>>>>>>>        Send Add_Client_File  Branch.File_Number
33602>>>>>>>
33602>>>>>>>        // Field-based properties.......................
33602>>>>>>>
33602>>>>>>>        // Company.Company_Code
33602>>>>>>>        Set Field_Options          Field Company.Company_Code To DD_AUTOFIND   
33603>>>>>>>        Set Field_Prompt_Object    Field Company.Company_Code To (sl001(Self))
33604>>>>>>>
33604>>>>>>>        // Company.Company_Name
33604>>>>>>>        Set Field_Options          Field Company.Company_Name To DD_REQUIRED   
33605>>>>>>>        Set Field_Prompt_Object    Field Company.Company_Name To (sl001(Self))
33606>>>>>>>
33606>>>>>>>        // Company.Company_Afm
33606>>>>>>>        Set Field_Options          Field Company.Company_Afm To DD_AUTOFIND   
33607>>>>>>>
33607>>>>>>>        // Company.Company_Addr
33607>>>>>>>
33607>>>>>>>        // Company.Company_Tk
33607>>>>>>>
33607>>>>>>>        // Company.Company_Poli
33607>>>>>>>
33607>>>>>>>        // Company.Company_Doy
33607>>>>>>>        Set Field_Value_Table      Field Company.Company_Doy To (Company_Company_Doy_VT(Self))
33608>>>>>>>
33608>>>>>>>        // Company.Company_J_Code
33608>>>>>>>        Set Field_Value_Table      Field Company.Company_J_Code To (Company_Company_J_Code_VT(Self))
33609>>>>>>>
33609>>>>>>>        // Company.Company_C_Code0
33609>>>>>>>
33609>>>>>>>        // Company.Company_C_Cod00
33609>>>>>>>
33609>>>>>>>        // Company.Company_C_Coder
33609>>>>>>>
33609>>>>>>>        // Company.Company_Tel
33609>>>>>>>
33609>>>>>>>        // Company.Company_Fax
33609>>>>>>>
33609>>>>>>>        // Company.Company_Email
33609>>>>>>>
33609>>>>>>>        // Company.Company_Resp
33609>>>>>>>
33609>>>>>>>        // Company.Company_Bitmap
33609>>>>>>>
33609>>>>>>>        // Company.Beto_Site
33609>>>>>>>
33609>>>>>>>        // Company.Logo
33609>>>>>>>
33609>>>>>>>        // Company.Doy_Type
33609>>>>>>>
33609>>>>>>>        // Company.Jcode_Type
33609>>>>>>>
33609>>>>>>>        // Company.Sap_Code
33609>>>>>>>
33609>>>>>>>        //DDB-DefineFieldEnd
33609>>>>>>>    End_Procedure    // Define_Fields
33610>>>>>>>
33610>>>>>>>    // Field_Defaults:
33610>>>>>>>    // This procedure is used to establish default field values.
33610>>>>>>>
33610>>>>>>>    Procedure Field_Defaults
33611>>>>>>>        Forward Send Field_Defaults
33613>>>>>>>        //DDB-Generated-Code-Location
33613>>>>>>>        //DDB-FieldDefaultStart
33613>>>>>>>        //DDB-FieldDefaultEnd
33613>>>>>>>    End_Procedure    // Field_Defaults
33614>>>>>>>End_Class    // Company_DataDictionary
33615>>>>>>>
33615>>>>>>>//DDB-Selection-pkg-Start
33615>>>>>>>
33615>>>>>>>Use sl001.sl         // sl001
INCLUDING FILE: SL001.SL
33615>>>>>>>>>//AB/ Project sl001 : Etairies
33615>>>>>>>>>//AB/     Object prj is a Lookup_Project
33615>>>>>>>>>//AB/         Set ProjectName to "sl001 : Etairies"
33615>>>>>>>>>//AB/         Set ProjectFileName to "sl001.SL"
33615>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
33615>>>>>>>>>
33615>>>>>>>>>// Project Object Structure
33615>>>>>>>>>//   sl001 is a dbModalPanel
33615>>>>>>>>>//     Company_DD is a DataDictionary
33615>>>>>>>>>//     oSelList is a dbList
33615>>>>>>>>>//     oOK_bn is a ButtonSub
33615>>>>>>>>>//     oCancel_bn is a ButtonSub
33615>>>>>>>>>//     oSearch_bn is a ButtonSub
33615>>>>>>>>>
33615>>>>>>>>>// Register all objects
33615>>>>>>>>>Register_Object Company_DD
33615>>>>>>>>>Register_Object oCancel_bn
33615>>>>>>>>>Register_Object oOK_bn
33615>>>>>>>>>Register_Object oSearch_bn
33615>>>>>>>>>Register_Object oSelList
33615>>>>>>>>>Register_Object sl001
33615>>>>>>>>>
33615>>>>>>>>>
33615>>>>>>>>>    //AB-IgnoreStart
33615>>>>>>>>>
33615>>>>>>>>>    Use DFAllEnt.pkg
33615>>>>>>>>>    Use Button.Sub
33615>>>>>>>>>
33615>>>>>>>>>
33615>>>>>>>>>    Use COMPANY.DD
33615>>>>>>>>>    
33615>>>>>>>>>    //AB-IgnoreEnd
33615>>>>>>>>>
33615>>>>>>>>>    CD_Popup_Object sl001 is a dbModalPanel
33634>>>>>>>>>        Set Label to "„«˜ ¨åœª"
33635>>>>>>>>>        Set Size to 148 297
33636>>>>>>>>>        Set Location to 12 27
33637>>>>>>>>>
33637>>>>>>>>>        //AB-DDOStart
33637>>>>>>>>>
33637>>>>>>>>>        Object Company_DD is a Company_DataDictionary
33639>>>>>>>>>        End_Object    // Company_DD
33640>>>>>>>>>
33640>>>>>>>>>        Set Main_DD to (Company_DD(self))
33641>>>>>>>>>        Set Server to (Company_DD(self))
33642>>>>>>>>>
33642>>>>>>>>>        //AB-DDOEnd
33642>>>>>>>>>
33642>>>>>>>>>        Object oSelList is a dbList
33644>>>>>>>>>            Set Main_File to Company.File_Number
33645>>>>>>>>>            Set Size to 105 280
33646>>>>>>>>>            Set Location to 6 6
33647>>>>>>>>>
33647>>>>>>>>>            Begin_Row
33650>>>>>>>>>                Entry_Item Company.Company_code
33651>>>>>>>>>                Entry_Item Company.Company_name
33652>>>>>>>>>                Entry_Item Company.Company_afm
33653>>>>>>>>>            End_Row
33658>>>>>>>>>
33658>>>>>>>>>            Set Form_Width    item 0 to 42
33659>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
33660>>>>>>>>>            
33660>>>>>>>>>            Set Form_Width    item 1 to 150
33661>>>>>>>>>            Set Header_Label  item 1 to "„§à¤¬£å˜"
33662>>>>>>>>>            
33662>>>>>>>>>            Set Form_Width    item 2 to 80
33663>>>>>>>>>            Set Header_Label  item 2 to "€.”.‹"
33664>>>>>>>>>            
33664>>>>>>>>>        End_Object    // oSelList
33665>>>>>>>>>
33665>>>>>>>>>        Object oOK_bn is a ButtonSub
33667>>>>>>>>>            Set Label to "&„§ ¢¦šã"
33668>>>>>>>>>            Set Location to 115 126
33669>>>>>>>>>
33669>>>>>>>>>            //AB-StoreStart
33669>>>>>>>>>            Procedure OnClick
33671>>>>>>>>>                Send OK To (oSelList(current_object))
33672>>>>>>>>>            End_Procedure
33673>>>>>>>>>            //AB-StoreEnd
33673>>>>>>>>>
33673>>>>>>>>>        End_Object    // oOK_bn
33674>>>>>>>>>
33674>>>>>>>>>        Object oCancel_bn is a ButtonSub
33676>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
33677>>>>>>>>>            Set Location to 115 181
33678>>>>>>>>>
33678>>>>>>>>>            //AB-StoreStart
33678>>>>>>>>>            Procedure OnClick
33680>>>>>>>>>                Send Cancel To (oSelList(current_object))
33681>>>>>>>>>            End_Procedure
33682>>>>>>>>>            //AB-StoreEnd
33682>>>>>>>>>
33682>>>>>>>>>        End_Object    // oCancel_bn
33683>>>>>>>>>
33683>>>>>>>>>        Object oSearch_bn is a ButtonSub
33685>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
33686>>>>>>>>>            Set Location to 115 236
33687>>>>>>>>>
33687>>>>>>>>>            //AB-StoreStart
33687>>>>>>>>>            Procedure OnClick
33689>>>>>>>>>                Send Search To (oSelList(current_object))
33690>>>>>>>>>            End_Procedure
33691>>>>>>>>>            //AB-StoreEnd
33691>>>>>>>>>
33691>>>>>>>>>        End_Object    // oSearch_bn
33692>>>>>>>>>
33692>>>>>>>>>
33692>>>>>>>>>        //AB-StoreStart
33692>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To oOk_bn
33693>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To oCancel_bn
33694>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To oSearch_bn
33695>>>>>>>>>        //AB-StoreEnd
33695>>>>>>>>>
33695>>>>>>>>>    CD_End_Object    // sl001
33697>>>>>>>>>>
33697>>>>>>>>>
33697>>>>>>>>>//AB/     End_Object    // prj
33697>>>>>>>
33697>>>>>>>//DDB-Selection-pkg-End
33697>>>>>>>//DDB-FileEnd
33697>>>>>    Use BRANCH.DD
INCLUDING FILE: BRANCH.DD
33697>>>>>>>//DDB-FileStart
33697>>>>>>>//DDB-HeaderStart
33697>>>>>>>
33697>>>>>>>// File Name : BRANCH.DD
33697>>>>>>>// Class Name: Branch_DataDictionary
33697>>>>>>>// Revision  : 86
33697>>>>>>>// Version   : 2
33697>>>>>>>
33697>>>>>>>Use  Windows           // Basic Definitions
33697>>>>>>>Use  DataDict          // DataDictionary Class Definition
33697>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
33697>>>>>>>
33697>>>>>>>Open Branch
33699>>>>>>>Open Year
33701>>>>>>>Open Brzones
INCLUDING FILE: BRZONES.FD
33703>>>>>>>Open Tpbranch
INCLUDING FILE: TPBRANCH.FD
33705>>>>>>>Open Company
33707>>>>>>>Open Sysrecg
INCLUDING FILE: SYSRECG.FD
33709>>>>>>>
33709>>>>>>>//DDB-HeaderEnd
33709>>>>>>>//DDB-ValidationStart
33709>>>>>>>
33709>>>>>>>Register_Object Branch_Branch_Doy_VT
33709>>>>>>>Register_Object Branch_Branch_J_Code_VT
33709>>>>>>>Register_Object Branch_Branch_C_Code0_VT
33709>>>>>>>
33709>>>>>>>Object Branch_Branch_Doy_VT  is a CodeValidationTable
33711>>>>>>>    Set Type_Value        To "DOY"
33712>>>>>>>    Set Validate_State    To FALSE
33713>>>>>>>    Set Allow_Blank_State To TRUE
33714>>>>>>>    //DDB-ValidationCustomStart
33714>>>>>>>    //DDB-ValidationCustomEnd
33714>>>>>>>End_Object   // Branch_Branch_Doy_VT
33715>>>>>>>
33715>>>>>>>Object Branch_Branch_J_Code_VT  is a CodeValidationTable
33717>>>>>>>    Set Type_Value        To "JOB"
33718>>>>>>>    Set Allow_Blank_State To TRUE
33719>>>>>>>    //DDB-ValidationCustomStart
33719>>>>>>>    //DDB-ValidationCustomEnd
33719>>>>>>>End_Object   // Branch_Branch_J_Code_VT
33720>>>>>>>
33720>>>>>>>Object Branch_Branch_C_Code0_VT  is a CodeValidationTable
33722>>>>>>>    Set Type_Value        To ""
33723>>>>>>>    Set Allow_Blank_State To TRUE
33724>>>>>>>    //DDB-ValidationCustomStart
33724>>>>>>>    //DDB-ValidationCustomEnd
33724>>>>>>>End_Object   // Branch_Branch_C_Code0_VT
33725>>>>>>>//DDB-ValidationEnd
33725>>>>>>>//DDB-SelectionStart
33725>>>>>>>//DDB/ ExternalSelectionList SL002  Sl002.sl
33725>>>>>>>Register_Object SL002
33725>>>>>>>//DDB-SelectionEnd
33725>>>>>>>
33725>>>>>>>Class Branch_DataDictionary  is a DataDictionary
33726>>>>>>> 
33726>>>>>>>    Procedure Save_Main_File
33727>>>>>>>        Forward Send Save_Main_File
33729>>>>>>>        // Insert Code Here
33729>>>>>>>    End_Procedure   // Save_Main_File
33730>>>>>>> 
33730>>>>>>>    Procedure Creating
33731>>>>>>>        Forward Send Creating
33733>>>>>>>        // Insert Code Here
33733>>>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Branch.Branch_Rec0)))))) to Branch.Branch_Recr
33734>>>>>>>    End_Procedure   // Creating
33735>>>>>>>
33735>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
33736>>>>>>>        // Insert Code Here
33736>>>>>>>        Case Begin
33736>>>>>>>             Case (iError_Num = 1001)
33738>>>>>>>                  Error 1001 "DDC 052:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
33739>>>>>>>>
33739>>>>>>>             Case Break
33740>>>>>>>
33740>>>>>>>             Case Else
33740>>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
33742>>>>>>>        Case End
33742>>>>>>>    End_Procedure   // Operation_Not_Allowed
33743>>>>>>>
33743>>>>>>>
33743>>>>>>>    // Validate_Save:
33743>>>>>>>
33743>>>>>>>    Function Validate_Save  Returns Integer
33744>>>>>>>        Local Integer iReturnVal
33745>>>>>>>        Forward Get Validate_Save  To iReturnVal
33747>>>>>>>        If (Not(iReturnVal)) Begin
33749>>>>>>>            // Insert Code Here
33749>>>>>>>            If (Branch.Branch_Code="") Send Operation_Not_Allowed 1001
33752>>>>>>>        End
33752>>>>>>>>
33752>>>>>>>        Function_Return iReturnVal
33753>>>>>>>    End_Function   // Validate_Save
33754>>>>>>>
33754>>>>>>>
33754>>>>>>>    // Define_Fields:
33754>>>>>>>    // This procedure is used to set up all data-dictionary rules.
33754>>>>>>>
33754>>>>>>>    Procedure Define_Fields
33755>>>>>>>        Forward Send Define_Fields
33757>>>>>>>        //DDB-Generated-Code-Location
33757>>>>>>>        //DDB-DefineFieldStart
33757>>>>>>>
33757>>>>>>>        Set Main_File            To Branch.File_Number
33758>>>>>>>        Set Cascade_Delete_State To FALSE
33759>>>>>>>
33759>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
33760>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOENTER     DD_FINDREQ    
33761>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
33762>>>>>>>
33762>>>>>>>        // Child (Client) file structure................
33762>>>>>>>        Send Add_Client_File  Year.File_Number
33763>>>>>>>        Send Add_Client_File  Brzones.File_Number
33764>>>>>>>        Send Add_Client_File  Tpbranch.File_Number
33765>>>>>>>
33765>>>>>>>        // Parent (Server) file structure...............
33765>>>>>>>        Send Add_Server_File  Company.File_Number
33766>>>>>>>
33766>>>>>>>        // External (System) file structure.............
33766>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
33767>>>>>>>
33767>>>>>>>        Define_Auto_Increment  Sysrecg.Branch_Rec0  To Branch.Branch_Rec0
33770>>>>>>>
33770>>>>>>>        // Field-based properties.......................
33770>>>>>>>
33770>>>>>>>        // Branch.Company_Code
33770>>>>>>>
33770>>>>>>>        // Branch.Branch_Code
33770>>>>>>>        Set Field_Options          Field Branch.Branch_Code To DD_AUTOFIND   
33771>>>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Code To (SL002(Self))
33772>>>>>>>        Set Key_Field_State        Field Branch.Branch_Code To TRUE
33773>>>>>>>
33773>>>>>>>        // Branch.Branch_Rec0
33773>>>>>>>
33773>>>>>>>        // Branch.Branch_Recr
33773>>>>>>>
33773>>>>>>>        // Branch.Branch_Name
33773>>>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Name To (SL002(Self))
33774>>>>>>>
33774>>>>>>>        // Branch.Branch_Afm
33774>>>>>>>
33774>>>>>>>        // Branch.Branch_Addr
33774>>>>>>>
33774>>>>>>>        // Branch.Branch_Tk
33774>>>>>>>
33774>>>>>>>        // Branch.Branch_Poli
33774>>>>>>>
33774>>>>>>>        // Branch.Branch_Doy
33774>>>>>>>        Set Field_Value_Table      Field Branch.Branch_Doy To (Branch_Branch_Doy_VT(Self))
33775>>>>>>>
33775>>>>>>>        // Branch.Branch_J_Code
33775>>>>>>>        Set Field_Value_Table      Field Branch.Branch_J_Code To (Branch_Branch_J_Code_VT(Self))
33776>>>>>>>
33776>>>>>>>        // Branch.Branch_C_Code0
33776>>>>>>>        Set Field_Value_Table      Field Branch.Branch_C_Code0 To (Branch_Branch_C_Code0_VT(Self))
33777>>>>>>>
33777>>>>>>>        // Branch.Branch_C_Code00
33777>>>>>>>
33777>>>>>>>        // Branch.Branch_C_Coder
33777>>>>>>>
33777>>>>>>>        // Branch.Branch_Tel
33777>>>>>>>
33777>>>>>>>        // Branch.Branch_Fax
33777>>>>>>>
33777>>>>>>>        // Branch.Branch_Email
33777>>>>>>>
33777>>>>>>>        // Branch.Branch_Resp
33777>>>>>>>
33777>>>>>>>        // Branch.Branch_Bitmap
33777>>>>>>>
33777>>>>>>>        // Branch.Branch_Site
33777>>>>>>>
33777>>>>>>>        // Branch.Branch_Apoth
33777>>>>>>>
33777>>>>>>>        // Branch.Beto_Site
33777>>>>>>>
33777>>>>>>>        // Branch.Path_Exp
33777>>>>>>>
33777>>>>>>>        // Branch.Exp_Txtname
33777>>>>>>>
33777>>>>>>>        // Branch.Send_Phone
33777>>>>>>>
33777>>>>>>>        // Branch.Send_Path_Files
33777>>>>>>>
33777>>>>>>>        // Branch.Send_Path_Conf
33777>>>>>>>
33777>>>>>>>        // Branch.Tomeas_Code
33777>>>>>>>
33777>>>>>>>        // Branch.Ftp_Sec_Retry
33777>>>>>>>
33777>>>>>>>        // Branch.Ftp_Sec_Exit
33777>>>>>>>
33777>>>>>>>        // Branch.Ras_Name
33777>>>>>>>
33777>>>>>>>        // Branch.Ras_Passw
33777>>>>>>>
33777>>>>>>>        // Branch.Ras_Domain
33777>>>>>>>
33777>>>>>>>        // Branch.Last_Hmnia_Ekt
33777>>>>>>>
33777>>>>>>>        // Branch.Deop_Logo
33777>>>>>>>
33777>>>>>>>        // Branch.Entolh
33777>>>>>>>
33777>>>>>>>        // Branch.Paragogh
33777>>>>>>>
33777>>>>>>>        // Branch.Locked_Until
33777>>>>>>>
33777>>>>>>>        // Branch.Sap_Code
33777>>>>>>>
33777>>>>>>>        //DDB-DefineFieldEnd
33777>>>>>>>    End_Procedure    // Define_Fields
33778>>>>>>>
33778>>>>>>>    // Field_Defaults:
33778>>>>>>>    // This procedure is used to establish default field values.
33778>>>>>>>
33778>>>>>>>    Procedure Field_Defaults
33779>>>>>>>        Forward Send Field_Defaults
33781>>>>>>>        //DDB-Generated-Code-Location
33781>>>>>>>        //DDB-FieldDefaultStart
33781>>>>>>>        //DDB-FieldDefaultEnd
33781>>>>>>>    End_Procedure    // Field_Defaults
33782>>>>>>>End_Class    // Branch_DataDictionary
33783>>>>>>>
33783>>>>>>>//DDB-Selection-pkg-Start
33783>>>>>>>
33783>>>>>>>Use Sl002.sl         // SL002
INCLUDING FILE: SL002.SL
33783>>>>>>>>>//AB/ Project SL002:Branch
33783>>>>>>>>>//AB/ Object prj is a Lookup_Project
33783>>>>>>>>>//AB/     Set ProjectName to "SL002:Branch"
33783>>>>>>>>>//AB/     Set ProjectFileName to "Sl002.sl"
33783>>>>>>>>>
33783>>>>>>>>>// Project Object Structure
33783>>>>>>>>>//   SL002 is a dbModalPanelSub
33783>>>>>>>>>//     Company_DD is a DataDictionary
33783>>>>>>>>>//     Branch_DD is a DataDictionary
33783>>>>>>>>>//     oSelList is a dbListSub
33783>>>>>>>>>//     oOK_bn is a ButtonSub
33783>>>>>>>>>//     oCancel_bn is a ButtonSub
33783>>>>>>>>>//     oSearch_bn is a ButtonSub
33783>>>>>>>>>
33783>>>>>>>>>// Register all objects
33783>>>>>>>>>Register_Object Branch_DD
33783>>>>>>>>>Register_Object Company_DD
33783>>>>>>>>>Register_Object oCancel_bn
33783>>>>>>>>>Register_Object oOK_bn
33783>>>>>>>>>Register_Object oSearch_bn
33783>>>>>>>>>Register_Object oSelList
33783>>>>>>>>>Register_Object SL002
33783>>>>>>>>>
33783>>>>>>>>>
33783>>>>>>>>>//AB-IgnoreStart
33783>>>>>>>>>
33783>>>>>>>>>Use DFAllEnt.pkg
33783>>>>>>>>>Use dbList.Sub
33783>>>>>>>>>Use Button.Sub
33783>>>>>>>>>
33783>>>>>>>>>
33783>>>>>>>>>Use COMPANY.DD
33783>>>>>>>>>Use BRANCH.DD
33783>>>>>>>>>
33783>>>>>>>>>//AB-IgnoreEnd
33783>>>>>>>>>
33783>>>>>>>>>Object SL002 is a dbModalPanelSub
33785>>>>>>>>>
33785>>>>>>>>>    //AB-StoreTopStart
33785>>>>>>>>>    Property String psFragmaCompanyCode  ""
33787>>>>>>>>>    
33787>>>>>>>>>    //AB-StoreTopEnd
33787>>>>>>>>>
33787>>>>>>>>>    Set Minimize_Icon to FALSE
33788>>>>>>>>>    Set Label to "“§¦¡˜«˜©«ã£˜«˜"
33789>>>>>>>>>    Set Size to 146 430
33790>>>>>>>>>    Set Location to 4 5
33791>>>>>>>>>    Set Exit_Application_Local_State to FALSE
33792>>>>>>>>>    Set Modal_State to FALSE
33793>>>>>>>>>
33793>>>>>>>>>    //AB-DDOStart
33793>>>>>>>>>
33793>>>>>>>>>    Object Company_DD is a Company_DataDictionary
33795>>>>>>>>>    End_Object    // Company_DD
33796>>>>>>>>>
33796>>>>>>>>>    Object Branch_DD is a Branch_DataDictionary
33798>>>>>>>>>        Set DDO_Server to (Company_DD(self))
33799>>>>>>>>>
33799>>>>>>>>>        //AB-StoreStart
33799>>>>>>>>>        Procedure OnConstrain
33801>>>>>>>>>             String lsCompanyCode
33802>>>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
33803>>>>>>>>>             If (lsCompanyCode <> "") Constrain Branch.Company_code eq lsCompanyCode
33807>>>>>>>>>        End_Procedure // OnConstrain
33808>>>>>>>>>        
33808>>>>>>>>>        
33808>>>>>>>>>        
33808>>>>>>>>>        //AB-StoreEnd
33808>>>>>>>>>
33808>>>>>>>>>    End_Object    // Branch_DD
33809>>>>>>>>>
33809>>>>>>>>>    Set Main_DD to (Branch_DD(self))
33810>>>>>>>>>    Set Server to (Branch_DD(self))
33811>>>>>>>>>
33811>>>>>>>>>    //AB-DDOEnd
33811>>>>>>>>>
33811>>>>>>>>>    Object oSelList is a dbListSub
33813>>>>>>>>>        Set Main_File to Branch.File_Number
33814>>>>>>>>>        Set Size to 105 415
33815>>>>>>>>>        Set Location to 6 6
33816>>>>>>>>>
33816>>>>>>>>>        Begin_Row
33819>>>>>>>>>            Entry_Item Branch.Branch_code
33820>>>>>>>>>            Entry_Item Branch.Branch_name
33821>>>>>>>>>            Entry_Item Company.Company_code
33822>>>>>>>>>            Entry_Item Company.Company_name
33823>>>>>>>>>            Entry_Item Branch.Beto_site
33824>>>>>>>>>            Entry_Item Branch.Branch_recr
33825>>>>>>>>>        End_Row
33830>>>>>>>>>
33830>>>>>>>>>        Set Form_Width    item 0 to 60
33831>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
33832>>>>>>>>>        
33832>>>>>>>>>        Set Form_Width    item 1 to 128
33833>>>>>>>>>        Set Header_Label  item 1 to "Ž¤¦£˜"
33834>>>>>>>>>        
33834>>>>>>>>>        Set Form_Width    item 2 to 69
33835>>>>>>>>>        Set Header_Label  item 2 to "‰à› ¡æª „«˜ ¨å˜ª"
33836>>>>>>>>>        
33836>>>>>>>>>        Set Form_Width    item 3 to 109
33837>>>>>>>>>        Set Header_Label  item 3 to "Ž¤¦£˜ „«˜ ¨å˜ª"
33838>>>>>>>>>        
33838>>>>>>>>>        Set Form_Width    item 4 to 42
33839>>>>>>>>>        Set Header_Label  item 4 to "Site"
33840>>>>>>>>>        
33840>>>>>>>>>        Set Form_Width    item 5 to 0
33841>>>>>>>>>        Set Header_Label  item 5 to ""
33842>>>>>>>>>        
33842>>>>>>>>>
33842>>>>>>>>>        //AB-StoreStart
33842>>>>>>>>>        
33842>>>>>>>>>        Property String psStoreFragmaCompanyCode  ""
33844>>>>>>>>>        
33844>>>>>>>>>        Procedure Store_Defaults
33846>>>>>>>>>            forward send Store_Defaults
33848>>>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
33849>>>>>>>>>        end_Procedure // Store_Defaults
33850>>>>>>>>>        
33850>>>>>>>>>        Procedure Restore_Defaults
33852>>>>>>>>>            forward send Restore_Defaults
33854>>>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
33855>>>>>>>>>        end_Procedure // Restore_Defaults
33856>>>>>>>>>        
33856>>>>>>>>>        Procedure Activating
33858>>>>>>>>>            Forward Send Activating
33860>>>>>>>>>            Send Rebuild_Constraints to (Branch_DD(self))
33861>>>>>>>>>        End_Procedure // Activating
33862>>>>>>>>>        
33862>>>>>>>>>        Set Column_Options Item 5 to NoEnter True
33863>>>>>>>>>        
33863>>>>>>>>>        
33863>>>>>>>>>        //AB-StoreEnd
33863>>>>>>>>>
33863>>>>>>>>>    End_Object    // oSelList
33864>>>>>>>>>
33864>>>>>>>>>    Object oOK_bn is a ButtonSub
33866>>>>>>>>>        Set Label to "&„§ ¢¦šã"
33867>>>>>>>>>        Set Location to 112 262
33868>>>>>>>>>
33868>>>>>>>>>        //AB-StoreStart
33868>>>>>>>>>        Procedure OnClick
33870>>>>>>>>>            Send OK To (oSelList(current_object))
33871>>>>>>>>>        End_Procedure
33872>>>>>>>>>        //AB-StoreEnd
33872>>>>>>>>>
33872>>>>>>>>>    End_Object    // oOK_bn
33873>>>>>>>>>
33873>>>>>>>>>    Object oCancel_bn is a ButtonSub
33875>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
33876>>>>>>>>>        Set Location to 112 317
33877>>>>>>>>>
33877>>>>>>>>>        //AB-StoreStart
33877>>>>>>>>>        Procedure OnClick
33879>>>>>>>>>            Send Cancel To (oSelList(current_object))
33880>>>>>>>>>        End_Procedure
33881>>>>>>>>>        //AB-StoreEnd
33881>>>>>>>>>
33881>>>>>>>>>    End_Object    // oCancel_bn
33882>>>>>>>>>
33882>>>>>>>>>    Object oSearch_bn is a ButtonSub
33884>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
33885>>>>>>>>>        Set Location to 112 372
33886>>>>>>>>>
33886>>>>>>>>>        //AB-StoreStart
33886>>>>>>>>>        Procedure OnClick
33888>>>>>>>>>            Send Search To (oSelList(current_object))
33889>>>>>>>>>        End_Procedure
33890>>>>>>>>>        //AB-StoreEnd
33890>>>>>>>>>
33890>>>>>>>>>    End_Object    // oSearch_bn
33891>>>>>>>>>
33891>>>>>>>>>
33891>>>>>>>>>    //AB-StoreStart
33891>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
33892>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
33893>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
33894>>>>>>>>>    
33894>>>>>>>>>    
33894>>>>>>>>>    //AB-StoreEnd
33894>>>>>>>>>
33894>>>>>>>>>End_Object    // SL002
33895>>>>>>>>>
33895>>>>>>>>>//AB/ End_Object    // prj
33895>>>>>>>
33895>>>>>>>//DDB-Selection-pkg-End
33895>>>>>>>//DDB-FileEnd
33895>>>>>    Use YEAR.DD
INCLUDING FILE: YEAR.DD
33895>>>>>>>//DDB-FileStart
33895>>>>>>>//DDB-HeaderStart
33895>>>>>>>
33895>>>>>>>// File Name : YEAR.DD
33895>>>>>>>// Class Name: Year_DataDictionary
33895>>>>>>>// Revision  : 118
33895>>>>>>>// Version   : 2
33895>>>>>>>
33895>>>>>>>Use  Windows           // Basic Definitions
33895>>>>>>>Use  DataDict          // DataDictionary Class Definition
33895>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
33895>>>>>>>
33895>>>>>>>Open Year
33897>>>>>>>Open Branch
33899>>>>>>>Open Syscurxr
33901>>>>>>>
33901>>>>>>>//DDB-HeaderEnd
33901>>>>>>>//DDB-ValidationStart
33901>>>>>>>
33901>>>>>>>Register_Object Year_Year_C_Code0_VT1
33901>>>>>>>Register_Object Year_Year_C_Code00_VT1
33901>>>>>>>Register_Object Year_Year_C_Coder_VT1
33901>>>>>>>
33901>>>>>>>Object Year_Year_C_Code0_VT1  is a CodeValidationTable
33903>>>>>>>    Set Type_Value        To "CURRENCY"
33904>>>>>>>    //DDB-ValidationCustomStart
33904>>>>>>>    //DDB-ValidationCustomEnd
33904>>>>>>>End_Object   // Year_Year_C_Code0_VT1
33905>>>>>>>
33905>>>>>>>Object Year_Year_C_Code00_VT1  is a CodeValidationTable
33907>>>>>>>    Set Type_Value        To "CURRENCY"
33908>>>>>>>    //DDB-ValidationCustomStart
33908>>>>>>>    //DDB-ValidationCustomEnd
33908>>>>>>>End_Object   // Year_Year_C_Code00_VT1
33909>>>>>>>
33909>>>>>>>Object Year_Year_C_Coder_VT1  is a CodeValidationTable
33911>>>>>>>    Set Type_Value        To "CURRENCY"
33912>>>>>>>    //DDB-ValidationCustomStart
33912>>>>>>>    //DDB-ValidationCustomEnd
33912>>>>>>>End_Object   // Year_Year_C_Coder_VT1
33913>>>>>>>//DDB-ValidationEnd
33913>>>>>>>//DDB-SelectionStart
33913>>>>>>>//DDB/ ExternalSelectionList SL003  Sl003.sl
33913>>>>>>>Register_Object SL003
33913>>>>>>>//DDB-SelectionEnd
33913>>>>>>>            
33913>>>>>>>Class Year_DataDictionary  is a DataDictionary
33914>>>>>>>    
33914>>>>>>>    Procedure Creating
33915>>>>>>>        Forward Send Creating
33917>>>>>>>        // Insert Code Here
33917>>>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Year.Year_Year)))))) to Year.Year_Recr
33918>>>>>>>    End_Procedure   // Creating
33919>>>>>>>
33919>>>>>>>
33919>>>>>>>    // Operation_Not_Allowed:
33919>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
33920>>>>>>>        // Insert Code Here
33920>>>>>>>        Case Begin    
33920>>>>>>>             Case (iError_Num = 1001)
33922>>>>>>>                  Error 1001 "DDC 053:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
33923>>>>>>>>
33923>>>>>>>             Case Break
33924>>>>>>>             Case (iError_Num=1002)
33927>>>>>>>                Error 1002 "DDC 053:Branch Site ¡˜«œ™˜å¤œ  ©«¦ Year ¡œ¤æ"
33928>>>>>>>>
33928>>>>>>>             Case Break
33929>>>>>>>             Case (iError_Num=1003)
33932>>>>>>>                Error 1003 "DDC 053:Company Code=0"
33933>>>>>>>>
33933>>>>>>>             Case Break
33934>>>>>>>             Case (iError_Num=1004)
33937>>>>>>>                Error 1004 "DDC 053:Branch Code=0"
33938>>>>>>>>
33938>>>>>>>             Case Break
33939>>>>>>>             Case Else
33939>>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
33941>>>>>>>        Case End
33941>>>>>>>    End_Procedure   // Operation_Not_Allowed
33942>>>>>>>
33942>>>>>>>
33942>>>>>>>    // Update:
33942>>>>>>>    // Use this message to effect changes in related-to files. The
33942>>>>>>>    // Backout message should be designed to reverse the effects of this
33942>>>>>>>    // message. It is invoked while the database is locked.
33942>>>>>>>
33942>>>>>>>    Procedure Update
33943>>>>>>>        Forward Send Update
33945>>>>>>>        // Insert Code Here
33945>>>>>>>        Move Company.Company_Code   to Year.Company_Code
33946>>>>>>>        Move Branch.Branch_Code     to Year.Branch_Code
33947>>>>>>>        move branch.beto_site       to year.beto_site
33948>>>>>>>
33948>>>>>>>        //sos:parametrika apo sysfile?
33948>>>>>>>       
33948>>>>>>>       // If ((Year.Year_EntryDate-14) < Year.Year_XrhshFrom) Begin
33948>>>>>>>       //     Move Year.Year_XrhshFrom to Year.Year_OpenFrom
33948>>>>>>>       // End
33948>>>>>>>       // Else Begin
33948>>>>>>>       //     Move (Year.Year_EntryDate-14) to Year.Year_OpenFrom
33948>>>>>>>       // End
33948>>>>>>>      //  Move Year.Year_EntryDate      to Year.Year_OpenTo
33948>>>>>>>    End_Procedure   // Update
33949>>>>>>>
33949>>>>>>>    // Validate_Save:
33949>>>>>>>
33949>>>>>>>    Function Validate_Save  Returns Integer
33950>>>>>>>        Local Integer iReturnVal
33951>>>>>>>        Forward Get Validate_Save  To iReturnVal
33953>>>>>>>        If (Not(iReturnVal)) Begin
33955>>>>>>>                 If (Year.Year_Year   = 0) Send Operation_Not_Allowed 1001
33958>>>>>>>            Else If (Year.Company_Code='') Send Operation_Not_Allowed 1003
33962>>>>>>>            Else If (Year.Branch_Code ='') Send Operation_Not_Allowed 1004
33966>>>>>>>        End
33966>>>>>>>>
33966>>>>>>>        Function_Return iReturnVal
33967>>>>>>>    End_Function   // Validate_Save
33968>>>>>>>
33968>>>>>>>
33968>>>>>>>    // Define_Fields:
33968>>>>>>>    // This procedure is used to set up all data-dictionary rules.
33968>>>>>>>
33968>>>>>>>    Procedure Define_Fields
33969>>>>>>>        Forward Send Define_Fields
33971>>>>>>>        //DDB-Generated-Code-Location
33971>>>>>>>        //DDB-DefineFieldStart
33971>>>>>>>
33971>>>>>>>        Set Main_File            To Year.File_Number
33972>>>>>>>        Set Cascade_Delete_State To FALSE
33973>>>>>>>
33973>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
33974>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
33975>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
33976>>>>>>>
33976>>>>>>>        // Parent (Server) file structure...............
33976>>>>>>>        Send Add_Server_File  Branch.File_Number
33977>>>>>>>
33977>>>>>>>        // External (System) file structure.............
33977>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
33978>>>>>>>
33978>>>>>>>        // Field-based properties.......................
33978>>>>>>>
33978>>>>>>>        // Year.Company_Code
33978>>>>>>>
33978>>>>>>>        // Year.Branch_Code
33978>>>>>>>
33978>>>>>>>        // Year.Year_Year
33978>>>>>>>        Set Field_Options          Field Year.Year_Year To DD_AUTOFIND    DD_REQUIRED   
33979>>>>>>>        Set Field_Prompt_Object    Field Year.Year_Year To (SL003(Self))
33980>>>>>>>        Set Key_Field_State        Field Year.Year_Year To TRUE
33981>>>>>>>
33981>>>>>>>        // Year.Year_Recr
33981>>>>>>>        Set Field_Prompt_Object    Field Year.Year_Recr To (SL003(Self))
33982>>>>>>>
33982>>>>>>>        // Year.Branch_Recr
33982>>>>>>>
33982>>>>>>>        // Year.Year_Descr
33982>>>>>>>
33982>>>>>>>        // Year.Year_Isolfrom
33982>>>>>>>
33982>>>>>>>        // Year.Year_Isolto
33982>>>>>>>
33982>>>>>>>        // Year.Year_Openfrom
33982>>>>>>>
33982>>>>>>>        // Year.Year_Opento
33982>>>>>>>
33982>>>>>>>        // Year.Year_Entrydate
33982>>>>>>>
33982>>>>>>>        // Year.Year_Dateaa
33982>>>>>>>
33982>>>>>>>        // Year.Year_Xrhshfrom
33982>>>>>>>
33982>>>>>>>        // Year.Year_Xrhshto
33982>>>>>>>
33982>>>>>>>        // Year.Year_Myflimit
33982>>>>>>>
33982>>>>>>>        // Year.Year_Numgtypkin
33982>>>>>>>
33982>>>>>>>        // Year.Year_Numgarticl
33982>>>>>>>
33982>>>>>>>        // Year.Year_Numgmove
33982>>>>>>>
33982>>>>>>>        // Year.Year_Numgplan
33982>>>>>>>
33982>>>>>>>        // Year.Year_Numgformat
33982>>>>>>>
33982>>>>>>>        // Year.Year_Numgthaa
33982>>>>>>>
33982>>>>>>>        // Year.Year_Numgopen
33982>>>>>>>
33982>>>>>>>        // Year.Year_Numbtypkin
33982>>>>>>>
33982>>>>>>>        // Year.Year_Numbaxio
33982>>>>>>>
33982>>>>>>>        // Year.Year_Numbarticl
33982>>>>>>>
33982>>>>>>>        // Year.Year_Numbmove
33982>>>>>>>
33982>>>>>>>        // Year.Year_Delimiter
33982>>>>>>>
33982>>>>>>>        // Year.Year_Printer
33982>>>>>>>
33982>>>>>>>        // Year.Year_Valid_Char
33982>>>>>>>
33982>>>>>>>        // Year.Year_C_Code0
33982>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0 To "dbComboFormSub"
33983>>>>>>>        Set Field_Value_Table      Field Year.Year_C_Code0 To (Year_Year_C_Code0_VT1(Self))
33984>>>>>>>
33984>>>>>>>        // Year.Year_C_Code00
33984>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00 To "dbComboFormSub"
33985>>>>>>>        Set Field_Value_Table      Field Year.Year_C_Code00 To (Year_Year_C_Code00_VT1(Self))
33986>>>>>>>
33986>>>>>>>        // Year.Year_C_Coder
33986>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder To "dbComboFormSub"
33987>>>>>>>        Set Field_Value_Table      Field Year.Year_C_Coder To (Year_Year_C_Coder_VT1(Self))
33988>>>>>>>
33988>>>>>>>        // Year.Beto_Site
33988>>>>>>>
33988>>>>>>>        // Year.Clients_Plafon
33988>>>>>>>
33988>>>>>>>        // Year.Payresp_Plafon
33988>>>>>>>
33988>>>>>>>        // Year.Clients_Ofeilh
33988>>>>>>>
33988>>>>>>>        // Year.Payresp_Ofeilh
33988>>>>>>>
33988>>>>>>>        // Year.Working
33988>>>>>>>
33988>>>>>>>        //DDB-DefineFieldEnd
33988>>>>>>>
33988>>>>>>>        Set Main_File            To Year.File_Number
33989>>>>>>>        Set Cascade_Delete_State To FALSE
33990>>>>>>>
33990>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
33991>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
33992>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
33993>>>>>>>
33993>>>>>>>        // Child (Client) file structure................
33993>>>>>>>
33993>>>>>>>        // Parent (Server) file structure...............
33993>>>>>>>        Send Add_Server_File  Branch.File_Number
33994>>>>>>>
33994>>>>>>>        // Field-based properties.......................
33994>>>>>>>
33994>>>>>>>        // Year.Company_Code
33994>>>>>>>
33994>>>>>>>        // Year.Branch_Code
33994>>>>>>>
33994>>>>>>>        // Year.Year_Year
33994>>>>>>>        Set Field_Label_Long       Field Year.Year_Year           To "•¨ã©ž"
33995>>>>>>>        Set Field_Label_Short      Field Year.Year_Year           To "•¨ã©ž"
33996>>>>>>>        Set Field_Options          Field Year.Year_Year           To DD_REQUIRED
33997>>>>>>>        //Set Field_Prompt_Object    Field Year.Year_Year           To (SL053(Self))
33997>>>>>>>
33997>>>>>>>        // Year.Year_Descr
33997>>>>>>>        Set Field_Label_Long       Field Year.Year_Descr          To "œ¨ š¨˜­ã •¨ã©žª"
33998>>>>>>>        Set Field_Label_Short      Field Year.Year_Descr          To "œ¨.•¨ã©žª"
33999>>>>>>>
33999>>>>>>>        // Year.Year_C_Code0
33999>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0        To "dbComboForm"
34000>>>>>>>        Set Field_Label_Long       Field Year.Year_C_Code0        To "‰ç¨ ¦ Œæ£ ©£˜"
34001>>>>>>>        Set Field_Label_Short      Field Year.Year_C_Code0        To "‰¬¨.Œ¦£ ©£˜"
34002>>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code0        To (Year_Year_C_Code0_VT(Self))
34002>>>>>>>
34002>>>>>>>        // Year.Year_C_Code00
34002>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00       To "dbComboForm"
34003>>>>>>>        Set Field_Label_Long       Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
34004>>>>>>>        Set Field_Label_Short      Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
34005>>>>>>>        //Set Field_Options          Field Year.Year_C_Code00       To DD_REQUIRED
34005>>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code00       To (Year_Year_C_Code1_VT(Self))
34005>>>>>>>
34005>>>>>>>        // Year.Year_C_Coder
34005>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder        To "dbComboForm"
34006>>>>>>>        Set Field_Label_Long       Field Year.Year_C_Coder        To "Œæ£ ©£˜ REPORTING"
34007>>>>>>>        Set Field_Label_Short      Field Year.Year_C_Coder        To "Œæ£ ©£˜ REP"
34008>>>>>>>        //Set Field_Options          Field Year.Year_C_Coder        To DD_REQUIRED
34008>>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Coder        To (Year_Year_C_Coder_VT(Self))
34008>>>>>>>
34008>>>>>>>        // Year.Year_Isolfrom
34008>>>>>>>        Set Field_Label_Long       Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
34009>>>>>>>        Set Field_Label_Short      Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
34010>>>>>>>
34010>>>>>>>        // Year.Year_Isolto
34010>>>>>>>        Set Field_Label_Long       Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
34011>>>>>>>        Set Field_Label_Short      Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
34012>>>>>>>
34012>>>>>>>        // Year.Year_Openfrom
34012>>>>>>>        Set Field_Label_Long       Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
34013>>>>>>>        Set Field_Label_Short      Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
34014>>>>>>>
34014>>>>>>>        // Year.Year_Opento
34014>>>>>>>        Set Field_Label_Long       Field Year.Year_Opento         To "„šš¨˜­âª „àª"
34015>>>>>>>        Set Field_Label_Short      Field Year.Year_Opento         To "„šš¨˜­âª „àª"
34016>>>>>>>
34016>>>>>>>        // Year.Year_Entrydate
34016>>>>>>>        Set Field_Label_Long       Field Year.Year_Entrydate      To "†£œ¨¦£ž¤å˜ „¨š˜©å˜ª"
34017>>>>>>>        Set Field_Label_Short      Field Year.Year_Entrydate      To "†£/¤å˜ „¨š˜©å˜ª"
34018>>>>>>>
34018>>>>>>>        // Year.Year_Dateaa
34018>>>>>>>
34018>>>>>>>        // Year.Year_Xrhshfrom
34018>>>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
34019>>>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
34020>>>>>>>
34020>>>>>>>        // Year.Year_Xrhshto
34020>>>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
34021>>>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
34022>>>>>>>
34022>>>>>>>        // Year.Year_Myflimit
34022>>>>>>>        Set Field_Label_Long       Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
34023>>>>>>>        Set Field_Label_Short      Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
34024>>>>>>>
34024>>>>>>>        // Year.Year_Numgtypkin
34024>>>>>>>        Set Field_Options          Field Year.Year_Numgtypkin     To DD_DISPLAYONLY
34025>>>>>>>
34025>>>>>>>        // Year.Year_Numgarticl
34025>>>>>>>        Set Field_Options          Field Year.Year_Numgarticl     To DD_DISPLAYONLY
34026>>>>>>>
34026>>>>>>>        // Year.Year_Numgmove
34026>>>>>>>        Set Field_Options          Field Year.Year_Numgmove       To DD_DISPLAYONLY
34027>>>>>>>
34027>>>>>>>        // Year.Year_Numgplan
34027>>>>>>>        Set Field_Options          Field Year.Year_Numgplan       To DD_DISPLAYONLY
34028>>>>>>>
34028>>>>>>>        // Year.Year_Numgformat
34028>>>>>>>        Set Field_Options          Field Year.Year_Numgformat     To DD_DISPLAYONLY
34029>>>>>>>
34029>>>>>>>        // Year.Year_Numgthaa
34029>>>>>>>        Set Field_Options          Field Year.Year_Numgthaa       To DD_DISPLAYONLY
34030>>>>>>>
34030>>>>>>>        // Year.Year_Numgopen
34030>>>>>>>        Set Field_Options          Field Year.Year_Numgopen       To DD_DISPLAYONLY
34031>>>>>>>
34031>>>>>>>        // Year.Year_Numbtypkin
34031>>>>>>>        Set Field_Options          Field Year.Year_Numbtypkin     To DD_DISPLAYONLY
34032>>>>>>>
34032>>>>>>>        // Year.Year_Numbaxio
34032>>>>>>>        Set Field_Options          Field Year.Year_Numbaxio       To DD_DISPLAYONLY
34033>>>>>>>
34033>>>>>>>        // Year.Year_Numbarticl
34033>>>>>>>        Set Field_Options          Field Year.Year_Numbarticl     To DD_DISPLAYONLY
34034>>>>>>>
34034>>>>>>>        // Year.Year_Numbmove
34034>>>>>>>        Set Field_Options          Field Year.Year_Numbmove       To DD_DISPLAYONLY
34035>>>>>>>
34035>>>>>>>        // Year.Year_Delimiter
34035>>>>>>>        Set Status_Help            Field Year.Year_Delimiter      To "ƒ ˜®à¨ ©« ¡æ š ˜ «¦ Š‘ «žª •¨ã©œàª"
34036>>>>>>>
34036>>>>>>>        // Year.Year_Printer
34036>>>>>>>
34036>>>>>>>        // Year.Year_Valid_Char
34036>>>>>>>
34036>>>>>>>    End_Procedure    // Define_Fields
34037>>>>>>>
34037>>>>>>>    // Field_Defaults:
34037>>>>>>>    // This procedure is used to establish default field values.
34037>>>>>>>
34037>>>>>>>    Procedure Field_Defaults
34038>>>>>>>        Forward Send Field_Defaults
34040>>>>>>>        //DDB-Generated-Code-Location
34040>>>>>>>        //DDB-FieldDefaultStart
34040>>>>>>>        //DDB-FieldDefaultEnd
34040>>>>>>>        Set Field_Changed_Value   Field Year.Year_Delimiter      To "."
34041>>>>>>>        Set Field_Changed_Value   Field Year.Year_Printer        To "LPT1:"
34042>>>>>>>        Set Field_Changed_Value   Field Year.Year_Valid_Char     To "1234567890"
34043>>>>>>>    End_Procedure    // Field_Defaults
34044>>>>>>>
34044>>>>>>>End_Class    // Year_DataDictionary
34045>>>>>>>//DDB-Selection-pkg-Start
34045>>>>>>>
34045>>>>>>>Use Sl003.sl         // SL003
INCLUDING FILE: SL003.SL
34045>>>>>>>>>//AB/ Project SL003:Year
34045>>>>>>>>>//AB/ Object prj is a Lookup_Project
34045>>>>>>>>>//AB/     Set ProjectName to "SL003:Year"
34045>>>>>>>>>//AB/     Set ProjectFileName to "Sl003.sl"
34045>>>>>>>>>
34045>>>>>>>>>// Project Object Structure
34045>>>>>>>>>//   SL003 is a dbModalPanelSub
34045>>>>>>>>>//     Company_DD is a DataDictionary
34045>>>>>>>>>//     Branch_DD is a DataDictionary
34045>>>>>>>>>//     Year_DD is a DataDictionary
34045>>>>>>>>>//     oSelList is a dbListSub
34045>>>>>>>>>//     oOK_bn is a ButtonSub
34045>>>>>>>>>//     oCancel_bn is a ButtonSub
34045>>>>>>>>>//     oSearch_bn is a ButtonSub
34045>>>>>>>>>
34045>>>>>>>>>// Register all objects
34045>>>>>>>>>Register_Object Branch_DD
34045>>>>>>>>>Register_Object Company_DD
34045>>>>>>>>>Register_Object oCancel_bn
34045>>>>>>>>>Register_Object oOK_bn
34045>>>>>>>>>Register_Object oSearch_bn
34045>>>>>>>>>Register_Object oSelList
34045>>>>>>>>>Register_Object SL003
34045>>>>>>>>>Register_Object Year_DD
34045>>>>>>>>>
34045>>>>>>>>>
34045>>>>>>>>>//AB-IgnoreStart
34045>>>>>>>>>
34045>>>>>>>>>Use DFAllEnt.pkg
34045>>>>>>>>>Use dbList.Sub
34045>>>>>>>>>Use Button.Sub
34045>>>>>>>>>
34045>>>>>>>>>
34045>>>>>>>>>Use COMPANY.DD
34045>>>>>>>>>Use BRANCH.DD
34045>>>>>>>>>Use YEAR.DD
34045>>>>>>>>>
34045>>>>>>>>>//AB-IgnoreEnd
34045>>>>>>>>>
34045>>>>>>>>>CD_Popup_Object SL003 is a dbModalPanelSub
34064>>>>>>>>>
34064>>>>>>>>>    //AB-StoreTopStart
34064>>>>>>>>>    Property String psFragmaCompanyCode  ""
34066>>>>>>>>>    Property String psFragmaBranchCode   ""
34068>>>>>>>>>    property integer pifragmaactive public 0
34070>>>>>>>>>    //AB-StoreTopEnd
34070>>>>>>>>>
34070>>>>>>>>>    Set Minimize_Icon to FALSE
34071>>>>>>>>>    Set Label to "•¨ã©œ ª"
34072>>>>>>>>>    Set Size to 149 449
34073>>>>>>>>>    Set Location to 4 7
34074>>>>>>>>>    Set Exit_Application_Local_State to FALSE
34075>>>>>>>>>    Set Modal_State to FALSE
34076>>>>>>>>>
34076>>>>>>>>>    //AB-DDOStart
34076>>>>>>>>>
34076>>>>>>>>>    Object Company_DD is a Company_DataDictionary
34078>>>>>>>>>    End_Object    // Company_DD
34079>>>>>>>>>
34079>>>>>>>>>    Object Branch_DD is a Branch_DataDictionary
34081>>>>>>>>>        Set DDO_Server to (Company_DD(self))
34082>>>>>>>>>    End_Object    // Branch_DD
34083>>>>>>>>>
34083>>>>>>>>>    Object Year_DD is a Year_DataDictionary
34085>>>>>>>>>        Set DDO_Server to (Branch_DD(self))
34086>>>>>>>>>
34086>>>>>>>>>        //AB-StoreStart
34086>>>>>>>>>        Procedure OnConstrain
34088>>>>>>>>>             String lsCompanyCode lsBranchCode
34089>>>>>>>>>             integer iactive
34089>>>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
34090>>>>>>>>>             get pifragmaactive to iactive
34091>>>>>>>>>             If (lsCompanyCode <> "") Begin
34093>>>>>>>>>                Get psFragmaBranchCode  to lsBranchCode
34094>>>>>>>>>                Constrain Year.Company_Code eq lsCompanyCode
34096>>>>>>>>>                If (lsBranchCode <> "") Constrain Year.Branch_code eq lsBranchCode
34100>>>>>>>>>             End
34100>>>>>>>>>>
34100>>>>>>>>>             if (iactive = 0) constrain year.working ne 1
34104>>>>>>>>>        End_Procedure // OnConstrain
34105>>>>>>>>>        
34105>>>>>>>>>        
34105>>>>>>>>>        
34105>>>>>>>>>        
34105>>>>>>>>>        
34105>>>>>>>>>        //AB-StoreEnd
34105>>>>>>>>>
34105>>>>>>>>>    End_Object    // Year_DD
34106>>>>>>>>>
34106>>>>>>>>>    Set Main_DD to (Year_DD(self))
34107>>>>>>>>>    Set Server to (Year_DD(self))
34108>>>>>>>>>
34108>>>>>>>>>    //AB-DDOEnd
34108>>>>>>>>>
34108>>>>>>>>>    Object oSelList is a dbListSub
34110>>>>>>>>>        Set Main_File to Year.File_Number
34111>>>>>>>>>        Set Size to 105 433
34112>>>>>>>>>        Set Location to 6 6
34113>>>>>>>>>
34113>>>>>>>>>        Begin_Row
34116>>>>>>>>>            Entry_Item Year.Year_year
34117>>>>>>>>>            Entry_Item Company.Company_code
34118>>>>>>>>>            Entry_Item Company.Company_name
34119>>>>>>>>>            Entry_Item Branch.Branch_code
34120>>>>>>>>>            Entry_Item Branch.Branch_name
34121>>>>>>>>>        End_Row
34126>>>>>>>>>
34126>>>>>>>>>        Set Form_Width    item 0 to 36
34127>>>>>>>>>        Set Header_Label  item 0 to "•¨ã©ž :          "
34128>>>>>>>>>        
34128>>>>>>>>>        Set Form_Width    item 1 to 71
34129>>>>>>>>>        Set Header_Label  item 1 to "‰à› ¡æª „«˜ ¨å˜ª"
34130>>>>>>>>>        
34130>>>>>>>>>        Set Form_Width    item 2 to 136
34131>>>>>>>>>        Set Header_Label  item 2 to "Ž¤¦£˜ „«˜ ¨å˜ª"
34132>>>>>>>>>        
34132>>>>>>>>>        Set Form_Width    item 3 to 73
34133>>>>>>>>>        Set Header_Label  item 3 to "‰à› ¡æª “§¦¡/«¦ª"
34134>>>>>>>>>        
34134>>>>>>>>>        Set Form_Width    item 4 to 109
34135>>>>>>>>>        Set Header_Label  item 4 to "Ž¤¦£˜ “§¦¡/«¦ª"
34136>>>>>>>>>        
34136>>>>>>>>>
34136>>>>>>>>>        //AB-StoreStart
34136>>>>>>>>>                                                
34136>>>>>>>>>        Property String psStoreFragmaCompanyCode  ""
34138>>>>>>>>>        Property String psStoreFragmaBranchCode   ""
34140>>>>>>>>>        
34140>>>>>>>>>        Procedure Store_Defaults
34142>>>>>>>>>            forward send Store_Defaults
34144>>>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
34145>>>>>>>>>            Set psStoreFragmaBranchCode  to (psFragmaBranchCode(Self))
34146>>>>>>>>>        end_Procedure // Store_Defaults
34147>>>>>>>>>        
34147>>>>>>>>>        Procedure Restore_Defaults
34149>>>>>>>>>            forward send Restore_Defaults
34151>>>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
34152>>>>>>>>>            Set psFragmaBranchCode  to (psStoreFragmaBranchCode(self))
34153>>>>>>>>>        end_Procedure // Restore_Defaults
34154>>>>>>>>>        
34154>>>>>>>>>        Procedure Activating
34156>>>>>>>>>            Forward Send Activating
34158>>>>>>>>>            Send Rebuild_Constraints to (Year_DD(self))
34159>>>>>>>>>        End_Procedure // Activating
34160>>>>>>>>>        
34160>>>>>>>>>        
34160>>>>>>>>>        
34160>>>>>>>>>        //AB-StoreEnd
34160>>>>>>>>>
34160>>>>>>>>>    End_Object    // oSelList
34161>>>>>>>>>
34161>>>>>>>>>    Object oOK_bn is a ButtonSub
34163>>>>>>>>>        Set Label to "&„§ ¢¦šã"
34164>>>>>>>>>        Set Location to 112 280
34165>>>>>>>>>
34165>>>>>>>>>        //AB-StoreStart
34165>>>>>>>>>        Procedure OnClick
34167>>>>>>>>>            Send OK To (oSelList(current_object))
34168>>>>>>>>>        End_Procedure
34169>>>>>>>>>        //AB-StoreEnd
34169>>>>>>>>>
34169>>>>>>>>>    End_Object    // oOK_bn
34170>>>>>>>>>
34170>>>>>>>>>    Object oCancel_bn is a ButtonSub
34172>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
34173>>>>>>>>>        Set Location to 112 335
34174>>>>>>>>>
34174>>>>>>>>>        //AB-StoreStart
34174>>>>>>>>>        Procedure OnClick
34176>>>>>>>>>            Send Cancel To (oSelList(current_object))
34177>>>>>>>>>        End_Procedure
34178>>>>>>>>>        //AB-StoreEnd
34178>>>>>>>>>
34178>>>>>>>>>    End_Object    // oCancel_bn
34179>>>>>>>>>
34179>>>>>>>>>    Object oSearch_bn is a ButtonSub
34181>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
34182>>>>>>>>>        Set Location to 112 390
34183>>>>>>>>>
34183>>>>>>>>>        //AB-StoreStart
34183>>>>>>>>>        Procedure OnClick
34185>>>>>>>>>            Send Search To (oSelList(current_object))
34186>>>>>>>>>        End_Procedure
34187>>>>>>>>>        //AB-StoreEnd
34187>>>>>>>>>
34187>>>>>>>>>    End_Object    // oSearch_bn
34188>>>>>>>>>
34188>>>>>>>>>
34188>>>>>>>>>    //AB-StoreStart
34188>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
34189>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
34190>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
34191>>>>>>>>>    
34191>>>>>>>>>    
34191>>>>>>>>>    
34191>>>>>>>>>    //AB-StoreEnd
34191>>>>>>>>>
34191>>>>>>>>>CD_End_Object    // SL003
34193>>>>>>>>>>
34193>>>>>>>>>
34193>>>>>>>>>//AB/ End_Object    // prj
34193>>>>>>>
34193>>>>>>>//DDB-Selection-pkg-End
34193>>>>>>>//DDB-FileEnd
34193>>>>>
34193>>>>>    //AB-IgnoreEnd
34193>>>>>
34193>>>>>    Object oSelectYear is a dbModalPanelSub
34195>>>>>
34195>>>>>        //AB-StoreTopStart
34195>>>>>
34195>>>>>        Property String  psSelectedYearRecr  ''
34197>>>>>        Property Integer piChangeState False
34199>>>>>
34199>>>>>        //AB-StoreTopEnd
34199>>>>>
34199>>>>>        Set Minimize_Icon to FALSE
34200>>>>>        Set Label to "„§ ¢¦šã „«˜ ¨œå˜ª - “§¦¡˜«˜©«ã£˜«¦ª - •¨ã©žª"
34201>>>>>        Set Size to 111 372
34202>>>>>        Set Location to 60 40
34203>>>>>        Set Color to 12232306
34204>>>>>        Set Popup_State to TRUE
34205>>>>>
34205>>>>>        //AB-DDOStart
34205>>>>>
34205>>>>>        Object Company_DD is a Company_DataDictionary
34207>>>>>
34207>>>>>            //AB-StoreStart
34207>>>>>            Set Foreign_Field_Options DD_KEYFIELD                   to DD_Clear_Field_Options DD_FindReq
34208>>>>>            Set Foreign_Field_Options DD_INDEXFIELD                 to DD_Clear_Field_Options DD_FindReq
34209>>>>>            Set Foreign_Field_Options Field Company.Company_Name    to DD_DisplayOnly
34210>>>>>
34210>>>>>
34210>>>>>
34210>>>>>            //AB-StoreEnd
34210>>>>>
34210>>>>>        End_Object    // Company_DD
34211>>>>>
34211>>>>>        Object Branch_DD is a Branch_DataDictionary
34213>>>>>            Set DDO_Server to (Company_DD(self))
34214>>>>>
34214>>>>>            //AB-StoreStart
34214>>>>>            Set Foreign_Field_Options DD_KEYFIELD   to DD_Clear_Field_Options DD_FindReq
34215>>>>>            Set Foreign_Field_Options DD_INDEXFIELD to DD_Clear_Field_Options DD_FindReq
34216>>>>>
34216>>>>>            Set Foreign_Field_Options DD_KEYFIELD   to DD_AutoFind_GE
34217>>>>>            Set Foreign_Field_Options DD_INDEXFIELD to DD_AutoFind_GE
34218>>>>>
34218>>>>>            Set Foreign_Field_Options Field Branch.Branch_Name to DD_DisplayOnly
34219>>>>>            //AB-StoreEnd
34219>>>>>
34219>>>>>        End_Object    // Branch_DD
34220>>>>>
34220>>>>>        Object Year_DD is a Year_DataDictionary
34222>>>>>            Set DDO_Server to (Branch_DD(self))
34223>>>>>
34223>>>>>            //AB-StoreStart
34223>>>>>
34223>>>>>            Set Field_Options Field Year.Year_Descr to DD_DisplayOnly
34224>>>>>            Set Field_Options Field Year.Year_Year to DD_AutoFind_GE
34225>>>>>
34225>>>>>            Function Validate_Delete Returns Integer
34227>>>>>                Function_Return 1
34228>>>>>            End_Function
34229>>>>>
34229>>>>>            //AB-StoreEnd
34229>>>>>
34229>>>>>        End_Object    // Year_DD
34230>>>>>
34230>>>>>        Set Main_DD to (Year_DD(self))
34231>>>>>        Set Server to (Year_DD(self))
34232>>>>>
34232>>>>>        //AB-DDOEnd
34232>>>>>
34232>>>>>        Object Company_Company_Code is a dbFormSub
34234>>>>>            Entry_Item Company.Company_code
34235>>>>>            Set Size to 13 71
34236>>>>>            Set Location to 9 112
34237>>>>>            Set Label_Col_Offset to 2
34238>>>>>            Set Label_Justification_Mode to jMode_Right
34239>>>>>            Set Prompt_Button_Mode to pb_PromptOn
34240>>>>>            Set Auto_Clear_Deo_State to FALSE
34241>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34242>>>>>
34242>>>>>            //AB-StoreStart
34242>>>>>
34242>>>>>            Set Prompt_Object to (sl001(Self))
34243>>>>>
34243>>>>>
34243>>>>>            //AB-StoreEnd
34243>>>>>
34243>>>>>        End_Object    // Company_Company_Code
34244>>>>>
34244>>>>>        Object Company_Company_Name is a dbFormSub
34246>>>>>            Entry_Item Company.Company_name
34247>>>>>            Set Size to 13 168
34248>>>>>            Set Location to 9 188
34249>>>>>            Set Label_Col_Offset to 2
34250>>>>>            Set Label_Justification_Mode to jMode_Right
34251>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34252>>>>>
34252>>>>>            //AB-StoreStart
34252>>>>>
34252>>>>>            //AB-StoreEnd
34252>>>>>
34252>>>>>        End_Object    // Company_Company_Name
34253>>>>>
34253>>>>>        Object Branch_Branch_Code is a dbFormSub
34255>>>>>            Entry_Item Branch.Branch_code
34256>>>>>            Set Size to 13 71
34257>>>>>            Set Location to 23 112
34258>>>>>            Set Label_Col_Offset to 2
34259>>>>>            Set Label_Justification_Mode to jMode_Right
34260>>>>>            Set Prompt_Button_Mode to pb_PromptOn
34261>>>>>            Set Auto_Clear_Deo_State to FALSE
34262>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34263>>>>>
34263>>>>>            //AB-StoreStart
34263>>>>>            Set Prompt_Object to (sl002(Self))
34264>>>>>
34264>>>>>            Procedure Prompt_CallBack Integer hPrompt
34266>>>>>                string lsCompanyCode
34267>>>>>                Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
34268>>>>>                Set psFragmaCompanyCode of hPrompt to lsCompanyCode
34269>>>>>            End_Procedure
34270>>>>>
34270>>>>>
34270>>>>>
34270>>>>>
34270>>>>>            //AB-StoreEnd
34270>>>>>
34270>>>>>        End_Object    // Branch_Branch_Code
34271>>>>>
34271>>>>>        Object Branch_Branch_Name is a dbFormSub
34273>>>>>            Entry_Item Branch.Branch_name
34274>>>>>            Set Size to 13 168
34275>>>>>            Set Location to 23 188
34276>>>>>            Set Label_Justification_Mode to jMode_Right
34277>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34278>>>>>
34278>>>>>            //AB-StoreStart
34278>>>>>
34278>>>>>
34278>>>>>            //AB-StoreEnd
34278>>>>>
34278>>>>>        End_Object    // Branch_Branch_Name
34279>>>>>
34279>>>>>        Object Year_Year_Year is a dbFormSub
34281>>>>>            Entry_Item Year.Year_year
34282>>>>>            Set Size to 13 71
34283>>>>>            Set Location to 37 112
34284>>>>>            Set Label_Col_Offset to 2
34285>>>>>            Set Label_Justification_Mode to jMode_Right
34286>>>>>            Set Prompt_Button_Mode to pb_PromptOn
34287>>>>>            Set Auto_Clear_Deo_State to FALSE
34288>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34289>>>>>
34289>>>>>            //AB-StoreStart
34289>>>>>            Set Prompt_Object to (sl003(Self))
34290>>>>>
34290>>>>>            Procedure Prompt_CallBack Integer hPrompt
34292>>>>>                String lsCompanyCode lsBranchCode
34293>>>>>                integer icheck
34293>>>>>                get checked_state of (chkxr(self)) to icheck
34294>>>>>                Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
34295>>>>>                Get Field_Current_Value of Branch_DD  Field Branch.Branch_Code   to lsBranchCode
34296>>>>>                Set psFragmaCompanyCode of hPrompt to lsCompanyCode
34297>>>>>                Set psFragmaBranchCode  of hPrompt to lsBranchCode
34298>>>>>                set pifragmaactive      of hPrompt to icheck
34299>>>>>            End_Procedure
34300>>>>>
34300>>>>>
34300>>>>>
34300>>>>>
34300>>>>>
34300>>>>>
34300>>>>>            //AB-StoreEnd
34300>>>>>
34300>>>>>        End_Object    // Year_Year_Year
34301>>>>>
34301>>>>>        Object Year_Year_Descr is a dbFormSub
34303>>>>>            Entry_Item Year.Year_descr
34304>>>>>            Set Size to 13 168
34305>>>>>            Set Location to 37 188
34306>>>>>            Set Label_Col_Offset to 2
34307>>>>>            Set Label_Justification_Mode to jMode_Right
34308>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34309>>>>>
34309>>>>>            //AB-StoreStart
34309>>>>>
34309>>>>>            //AB-StoreEnd
34309>>>>>
34309>>>>>        End_Object    // Year_Year_Descr
34310>>>>>
34310>>>>>        Object Year_Year_Entrydate is a dbFormSub
34312>>>>>            Entry_Item Year.Year_entrydate
34313>>>>>            Set Size to 13 71
34314>>>>>            Set Location to 52 112
34315>>>>>            Set Label_Col_Offset to 2
34316>>>>>            Set Label_Justification_Mode to jMode_Right
34317>>>>>            Set Auto_Clear_Deo_State to FALSE
34318>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34319>>>>>        End_Object    // Year_Year_Entrydate
34320>>>>>
34320>>>>>        Object oOk_bn is a ButtonSub
34322>>>>>            Set Label to "€§¦›¦®ã (F2)"
34323>>>>>            Set Size to 17 54
34324>>>>>            Set Location to 74 188
34325>>>>>            Set Form_FontHeight Item 0 to 14
34326>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34327>>>>>
34327>>>>>            //AB-StoreStart
34327>>>>>
34327>>>>>            Procedure OnClick
34329>>>>>                Delegate Send AcceptTheValues
34331>>>>>            End_Procedure
34332>>>>>
34332>>>>>
34332>>>>>
34332>>>>>
34332>>>>>            //AB-StoreEnd
34332>>>>>
34332>>>>>        End_Object    // oOk_bn
34333>>>>>
34333>>>>>        Object oCancel_bn is a ButtonSub
34335>>>>>            Set Label to "„¥¦›¦ª "
34336>>>>>            Set Size to 17 54
34337>>>>>            Set Location to 74 302
34338>>>>>            Set Form_FontHeight Item 0 to 14
34339>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34340>>>>>
34340>>>>>            //AB-StoreStart
34340>>>>>
34340>>>>>            Procedure OnClick
34342>>>>>               Send Exit_Application to oSelectYear
34343>>>>>            End_Procedure
34344>>>>>
34344>>>>>
34344>>>>>
34344>>>>>            //AB-StoreEnd
34344>>>>>
34344>>>>>        End_Object    // oCancel_bn
34345>>>>>
34345>>>>>        Object otxtCompany is a TextBoxSub
34347>>>>>            Set Label to "„«˜ ¨œå˜"
34348>>>>>            Set Auto_Size_State to FALSE
34349>>>>>            Set Color to 12232306
34350>>>>>            Set FontSize to 14 8
34351>>>>>            Set Location to 9 10
34352>>>>>            Set Size to 10 35
34353>>>>>            Set FontWeight to 600
34354>>>>>            Set TypeFace to "MS Sans Serif"
34355>>>>>            Set Enabled_State to TRUE
34356>>>>>        End_Object    // otxtCompany
34357>>>>>
34357>>>>>        Object otxtBranch is a TextBoxSub
34359>>>>>            Set Label to "“§¦¡˜«˜©«ã£˜«˜"
34360>>>>>            Set Auto_Size_State to FALSE
34361>>>>>            Set Color to 12232306
34362>>>>>            Set FontSize to 14 8
34363>>>>>            Set Location to 23 10
34364>>>>>            Set Size to 10 63
34365>>>>>            Set FontWeight to 600
34366>>>>>            Set TypeFace to "MS Sans Serif"
34367>>>>>            Set Enabled_State to TRUE
34368>>>>>        End_Object    // otxtBranch
34369>>>>>
34369>>>>>        Object otxtYear is a TextBoxSub
34371>>>>>            Set Label to "•¨ã©ž :          "
34372>>>>>            Set Auto_Size_State to FALSE
34373>>>>>            Set Color to 12232306
34374>>>>>            Set FontSize to 14 8
34375>>>>>            Set Location to 38 10
34376>>>>>            Set Size to 10 40
34377>>>>>            Set FontWeight to 600
34378>>>>>            Set TypeFace to "MS Sans Serif"
34379>>>>>            Set Enabled_State to TRUE
34380>>>>>        End_Object    // otxtYear
34381>>>>>
34381>>>>>        Object otxtWorkingDay is a TextBoxSub
34383>>>>>            Set Label to "†£/¤å˜ „¨š˜©å˜ª"
34384>>>>>            Set Auto_Size_State to FALSE
34385>>>>>            Set Color to 12232306
34386>>>>>            Set FontSize to 14 8
34387>>>>>            Set Location to 52 10
34388>>>>>            Set Size to 10 63
34389>>>>>            Set FontWeight to 600
34390>>>>>            Set TypeFace to "MS Sans Serif"
34391>>>>>            Set Enabled_State to TRUE
34392>>>>>        End_Object    // otxtWorkingDay
34393>>>>>
34393>>>>>        Object otxtWorkingDay is a TextBoxSub
34395>>>>>            Set Label to "Ž¢œª ¦  ®¨ã©œ ª"
34396>>>>>            Set Auto_Size_State to FALSE
34397>>>>>            Set Color to 12232306
34398>>>>>            Set FontSize to 14 8
34399>>>>>            Set Location to 79 9
34400>>>>>            Set Size to 10 63
34401>>>>>            Set FontWeight to 600
34402>>>>>            Set TypeFace to "MS Sans Serif"
34403>>>>>            Set Enabled_State to TRUE
34404>>>>>        End_Object    // otxtWorkingDay
34405>>>>>
34405>>>>>        Object chkxr is a CheckBoxSub
34407>>>>>            Set Size to 13 22
34408>>>>>            Set Location to 79 113
34409>>>>>            Set Color to 12232306
34410>>>>>        End_Object    // chkxr
34411>>>>>
34411>>>>>
34411>>>>>        //AB-StoreStart
34411>>>>>
34411>>>>>        On_Key Key_Ctrl+Key_X Send None
34412>>>>>        On_Key Key_Alt+Key_X  Send None
34413>>>>>
34413>>>>>        Function ifSelect_Xrhsh Returns String
34415>>>>>            String  lsRecord_id
34416>>>>>            Set psSelectedYearRecr to gs_Selected_Year_Recr
34417>>>>>            send popup_modal
34418>>>>>            Get psSelectedYearRecr to lsRecord_id
34419>>>>>            Function_return lsRecord_Id
34420>>>>>        End_Function
34421>>>>>
34421>>>>>        Procedure AcceptTheValues
34423>>>>>            Integer iRetVal liYearDD liCompanyDD liBranchDD
34424>>>>>            String ldcheck lsYearRecr lsSite sCname sBname sYname sNom1 sNom2 sNom3
34424>>>>>            Date ldYearXrhsh_From ldYearXrhsh_To
34424>>>>>            Move Year_DD to liYearDD
34425>>>>>            Get Field_Current_Value of liYearDD Field Year.Year_EntryDate to ldcheck
34426>>>>>            if (ldcheck = "") ;                Get Message_Box "ƒœ¤ œ§ ¢â¥˜«œ ©à©«ã ž£œ¨¦£ž¤å˜." "¨¦©¦®ã" MB_OK MB_ICONWARNING to iRetVal
34429>>>>>            else begin
34430>>>>>                Get Field_Current_Value of liYearDD Field Year.Year_XrhshFrom   to ldYearXrhsh_From
34431>>>>>                Get Field_Current_Value of liYearDD Field Year.Year_XrhshTo     to ldYearXrhsh_To
34432>>>>>                if ((ldcheck < ldYearXrhsh_From) or (ldcheck > ldYearXrhsh_To)) ;                    Get Message_Box "†£œ¨/¤å˜ œ¡«éª ¦¨åà¤" "¨¦©¦®ã" MB_OK MB_ICONWARNING to iRetVal
34435>>>>>                else begin
34436>>>>>                    Move Company_DD to liCompanyDD
34437>>>>>                    Move Branch_DD  to liBranchDD
34438>>>>>                    Move Year_DD    to liYearDD
34439>>>>>                    send Request_Save to liYearDD
34440>>>>>                    Get Field_Current_Value of liCompanyDD Field Company.Company_Code to gs_Selected_Company_Code
34441>>>>>                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_Code   to gs_Selected_Branch_Code
34442>>>>>
34442>>>>>                    Get Field_Current_Value of liBranchDD  Field Branch.Beto_Site   to gs_Selected_Beto_Site
34443>>>>>
34443>>>>>                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_Site   to lsSite
34444>>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_Year       to gi_Selected_Year
34445>>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_Recr       to lsYearRecr
34446>>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_C_Code0    to sNom1
34447>>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_C_Code00   to sNom2
34448>>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_C_CodeR    to sNom3
34449>>>>>
34449>>>>>                    Get Field_Current_Value of liCompanyDD Field Company.Company_Name to sCname
34450>>>>>                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_name   to sBname
34451>>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_Descr      to sYname
34452>>>>>
34452>>>>>
34452>>>>>                    Local String    sCode
34452>>>>>                    Local Integer   iBreak
34452>>>>>                    Move 0 to iBreak
34453>>>>>                    Clear Nomisma
34454>>>>>                    Find Gt Nomisma.Recnum
34455>>>>>>
34455>>>>>                    While ((Found=1) And (iBreak=0))
34459>>>>>                        If (Nomisma.Einai_Euro='1') Begin
34461>>>>>                            Move 1 to iBreak
34462>>>>>                            Move Nomisma.Nomisma_Code to sCode
34463>>>>>                        End
34463>>>>>>
34463>>>>>                        If (Not(iBreak)) Find Gt Nomisma.Recnum
34466>>>>>                    Loop
34467>>>>>>
34467>>>>>                    Move (Trim(sCode)) to sCode
34468>>>>>
34468>>>>>
34468>>>>>                    Reread SysCurXR
34472>>>>>                    Move gs_Selected_Company_Code   to SysCurXR.Company_Code
34473>>>>>                    Move gs_Selected_beto_site      to SysCurXR.beto_site
34474>>>>>                    Move gs_Selected_Branch_Code    to SysCurXR.Branch_Code
34475>>>>>                    Move gi_Selected_Year           to SysCurXR.Year_Year
34476>>>>>                    Move lsYearRecr                 to SysCurXR.Year_Recr
34477>>>>>                    Move lsSite                     to SysCurXR.Branch_Site
34478>>>>>
34478>>>>>                    Move sCname                     to SysCurXR.Company_Name
34479>>>>>                    Move sBname                     to SysCurXR.Branch_Name
34480>>>>>                    Move sYname                     to SysCurXR.Year_Descr
34481>>>>>
34481>>>>>                    Move ldYearXrhsh_From           to SysCurXr.Year_XrhshFrom
34482>>>>>                    Move ldYearXrhsh_To             to SysCurXr.Year_XrhshTo
34483>>>>>
34483>>>>>                    Move  (Trim(sNom1))             to SysCurXR.C_Code0
34484>>>>>                    Move  (Trim(sNom2))             to SysCurXR.C_Code00
34485>>>>>                    Move  (Trim(sNom3))             to SysCurXR.C_CodeR
34486>>>>>
34486>>>>>                    Move sCode                      to SysCurXR.Euro_Code
34487>>>>>
34487>>>>>                    Saverecord SysCurXR
34488>>>>>                    Unlock
34489>>>>>>
34489>>>>>
34489>>>>>                    Move lsYearRecr                 to gs_Selected_Year_Recr
34490>>>>>                    Set psSelectedYearRecr          to lsYearRecr
34491>>>>>
34491>>>>>                    Send Stop_Modal_ui
34492>>>>>
34492>>>>>                    Set kEnter_Next_State of ghoWorkSpace to TRUE
34493>>>>>                End
34493>>>>>>
34493>>>>>            end
34493>>>>>>
34493>>>>>        End_Procedure
34494>>>>>
34494>>>>>        Set Locate_Mode to Center_On_Screen
34495>>>>>
34495>>>>>        On_Key KCancel      Send KeyAction to (oCancel_Bn(Self))
34496>>>>>        On_Key KClose_Panel Send KeyAction to (oCancel_Bn(Self))
34497>>>>>        On_Key Ksave_record send KeyAction to (oOK_Bn(Self))
34498>>>>>
34498>>>>>        On_Key Key_alt+Key_A send KeyAction to (oOK_Bn(Self))
34499>>>>>        On_Key Key_alt+Key_Q send KeyAction to (oCancel_Bn(Self))
34500>>>>>
34500>>>>>
34500>>>>>
34500>>>>>
34500>>>>>
34500>>>>>
34500>>>>>
34500>>>>>        //AB-StoreEnd
34500>>>>>
34500>>>>>    End_Object    // oSelectYear
34501>>>>>
34501>>>>>
34501>>>>>    //AB-StoreStart
34501>>>>>
34501>>>>>
34501>>>>>    //AB-StoreEnd
34501>>>>>
34501>>>>>//AB/     End_Object    // prj
34501>>>
34501>>>Procedure Epelexe_Xrhsh
34502>>>    Integer liCompanyDD liBranchDD liYearDD liYear liModalId
34503>>>    String lsCompany lsBranch lsWhatXrhsh
34503>>>    Move oSelectYear to liModalId
34504>>>    Get ifSelect_Xrhsh Of liModalId to lsWhatXrhsh
34505>>>    if (Trim(lsWhatXrhsh)='') Send Exit_Application
34508>>>End_Procedure
34509>>>
34509>>>Procedure Allaxe_Xrhsh
34510>>>    Integer rVal liModalId iID
34511>>>    If (Close_All_Views(Self,True)=0) Begin
34513>>>        Move oSelectYear to liModalId
34514>>>        Send Epelexe_Xrhsh
34515>>>    End
34515>>>>
34515>>>End_Procedure
34516>>>
34516>>>On_Key Key_Ctrl+Key_X Send Allaxe_Xrhsh
34517>>>On_Key Key_Alt+Key_X  Send Allaxe_Xrhsh
34518>>>
34518>>>Send Epelexe_Xrhsh
34519>>>//------------------------------
34519>>>
34519>Use Menu_Sec.Sub
INCLUDING FILE: MENU_SEC.SUB
34519>>>
34519>>>Use Idiotht.pkg
INCLUDING FILE: IDIOTHT.PKG
34519>>>>>
34519>>>>>Open Users
34521>>>>>Open UserGrps
INCLUDING FILE: USERGRPS.FD
34523>>>>>Open Pedia
INCLUDING FILE: PEDIA.FD
34525>>>>>Open Arxeia
INCLUDING FILE: ARXEIA.FD
34527>>>>>Open GrpPedia
INCLUDING FILE: GRPPEDIA.FD
34529>>>>>Open GrpPed0
INCLUDING FILE: GRPPED0.FD
34531>>>>>Open GrpArx
INCLUDING FILE: GRPARX.FD
34533>>>>>Open GrpArx0
INCLUDING FILE: GRPARX0.FD
34535>>>>>Open ViewFlds
INCLUDING FILE: VIEWFLDS.FD
34537>>>>>Open Oth
INCLUDING FILE: OTH.FD
34539>>>>>Open GrpOth
INCLUDING FILE: GRPOTH.FD
34541>>>>>Open GrpOth0
INCLUDING FILE: GRPOTH0.FD
34543>>>>>Open Departm
INCLUDING FILE: DEPARTM.FD
34545>>>>>
34545>>>>>
34545>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
34546>>>>>
34546>>>>>Function Network_User_Name Returns String
34547>>>>>    Local String sName sLength
34548>>>>>    Local Pointer lpName_Addr lpLength_Addr
34548>>>>>    Local Integer iRetval
34548>>>>>    Movestr (Repeat (Character (0), 255)) To sName
34549>>>>>>
34549>>>>>    GetAddress Of sName To lpName_Addr
34550>>>>>    Movestr (DwordToBytes (255)) To sLength
34551>>>>>>
34551>>>>>    GetAddress Of sLength To lpLength_Addr
34552>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
34553>>>>>>
34553>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
34556>>>>>    Else Function_Return "User Unknown"
34558>>>>>End_Function // Network_User_Name
34559>>>>>
34559>>>>>Function fsGetOfficePath Global Returns String
34560>>>>>    String sRegistryKeyPath sRegOfficePath
34561>>>>>    Set_Registry_Root                                                   to HKEY_LOCAL_MACHINE "Software"
34562>>>>>    Move "Microsoft\Office\9.0\Word"                                    to sRegistryKeyPath
34563>>>>>    Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path"    to sRegOfficePath
34567>>>>>    Move (Trim(sRegOfficePath))                                         to sRegOfficePath
34568>>>>>    If (sRegOfficePath='') Begin
34570>>>>>        Move "Microsoft\Office\8.0\Word"                                to sRegistryKeyPath
34571>>>>>        Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34575>>>>>        Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34576>>>>>        If (sRegOfficePath='') Begin
34578>>>>>            Move "Microsoft\Office\7.0\Word"                             to sRegistryKeyPath
34579>>>>>            Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34583>>>>>            Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34584>>>>>            If (sRegOfficePath='') Begin
34586>>>>>                Move "Microsoft\Office\10.0\Word"                                to sRegistryKeyPath
34587>>>>>                Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34591>>>>>                Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34592>>>>>            End
34592>>>>>>
34592>>>>>        End
34592>>>>>>
34592>>>>>    End
34592>>>>>>
34592>>>>>    Function_Return sRegOfficePath
34593>>>>>End_Procedure
34594>>>>>
34594>>>>>
34594>>>>>Function fsGetLastDir Global Returns String
34595>>>>>    String sRegistryKeyPath sRegDir sUserName
34596>>>>>    Get Network_User_Name to sUserName
34597>>>>>
34597>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
34600>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
34603>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
34605>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
34607>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
34608>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
34609>>>>>    Get_profile_string sRegistryKeyPath "Path" to sRegDir
34612>>>>>    Function_Return sRegDir
34613>>>>>End_Procedure
34614>>>>>
34614>>>>>Function fiPutLastDir Global String asDirectory Returns Integer
34615>>>>>    String sRegistryKeyPath sRegDir sUserName
34616>>>>>    Get Network_User_Name to sUserName
34617>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
34620>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
34623>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
34625>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
34627>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
34628>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
34629>>>>>    Set_profile_string sRegistryKeyPath "Path" to asDirectory
34632>>>>>    Function_Return 0
34633>>>>>End_Procedure
34634>>>>>
34634>>>>>
34634>>>>>Function fsVresExt Global String asFileName Returns String
34635>>>>>    String rVal
34636>>>>>    Integer iPos iLen
34636>>>>>    Move (UpperCase(asFileName)) to asFileName
34637>>>>>    Move (Trim(asFileName)) to asFileName
34638>>>>>    Move 0 to iPos
34639>>>>>    For iLen from 1 to (length(asFileName))
34645>>>>>>
34645>>>>>        If (Mid(asFileName,1,iLen)='.') Move iLen to iPos
34648>>>>>    Loop
34649>>>>>>
34649>>>>>    If (Not(iPos)) Function_Return ''
34652>>>>>    Move (Right(asFileName,(Length(asFileName)-iPos))) to rVal
34653>>>>>    Move (Trim(rVal)) to rVal
34654>>>>>    Function_Return rVal
34655>>>>>End_Function
34656>>>>>
34656>>>>>
34656>>>>>Function fiScreenFieldStatus Global String asViewName String asDbFormName Returns Integer
34657>>>>>    Integer rVal iUser iGroup
34658>>>>>    String  sUser sRecr
34658>>>>>    Move (Trim(asViewName))     to asViewName
34659>>>>>    Move (Trim(asDbFormName))   to asDbFormName
34660>>>>>
34660>>>>>    If ((asViewName<>'') And (asDbFormName<>'')) Begin
34662>>>>>        Get fsLoginUserID to sUser
34663>>>>>        Clear Users
34664>>>>>        Move sUser        to Users.Login_ID
34665>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
34666>>>>>>
34666>>>>>        If (Found=1) Begin
34668>>>>>            Move Users.User_ID  to iUser
34669>>>>>            Move Users.Grp_ID   to iGroup
34670>>>>>            Clear GrpOth
34671>>>>>            Move iUser          to GrpOth.User_ID
34672>>>>>            Move asViewName     to GrpOth.View_Name
34673>>>>>            Move asDbFormName   to GrpOth.Scr_Field_Name
34674>>>>>            Find eq GrpOth by Index.2 // GrpOth:Index.2:User_ID+View_Name+Scr_Field_Name
34675>>>>>>
34675>>>>>            If (Found=1) Begin
34677>>>>>                // rVal=1 ==> NO READ ALLOWED
34677>>>>>                // rVal=2 ==> NO EDIT BUT CAN COPY
34677>>>>>                // rVal=3 ==> NO EDIT AND NO COPY
34677>>>>>                If (GrpOth.Allow_Read <>'1') Move 1 to rVal
34680>>>>>                Else Begin
34681>>>>>                    If (GrpOth.Allow_Change<>'1') Begin
34683>>>>>                        If (GrpOth.Allow_Copy<>'1') Move 3 to rVal
34686>>>>>                        Else                        Move 2 to rVal
34688>>>>>                    End
34688>>>>>>
34688>>>>>                End
34688>>>>>>
34688>>>>>            End
34688>>>>>>
34688>>>>>            Else Begin
34689>>>>>                Clear GrpOth0
34690>>>>>                Move iGroup         to GrpOth0.Group_ID
34691>>>>>                Move asViewName     to GrpOth0.View_Name
34692>>>>>                Move asDbFormName   to GrpOth0.Scr_Field_Name
34693>>>>>
34693>>>>>                Find eq GrpOth0 by Index.2 // GrpOth0:Index.2:Group_ID+View_Name+Scr_Field_Name
34694>>>>>>
34694>>>>>                If (Found=1) Begin
34696>>>>>                    // rVal=1 ==> NO READ ALLOWED
34696>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
34696>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
34696>>>>>                    If (GrpOth0.Allow_Read <>'1') Move 1 to rVal
34699>>>>>                    Else Begin
34700>>>>>                        If (GrpOth0.Allow_Change<>'1') Begin
34702>>>>>                            If (GrpOth0.Allow_Copy<>'1') Move 3 to rVal
34705>>>>>                            Else                         Move 2 to rVal
34707>>>>>                        End
34707>>>>>>
34707>>>>>                    End
34707>>>>>>
34707>>>>>                End
34707>>>>>>
34707>>>>>                Else Move 0 to rVal
34709>>>>>            End
34709>>>>>>
34709>>>>>        End
34709>>>>>>
34709>>>>>        Else Move 0 to rVal
34711>>>>>    End
34711>>>>>>
34711>>>>>    Function_Return rVal
34712>>>>>End_Function
34713>>>>>
34713>>>>>Function fiFieldStatus Global Integer aiFileNumber Integer aiFieldNumber Returns Integer
34714>>>>>    Integer rVal iUser iGroup
34715>>>>>    String  sUser sRecr
34715>>>>>    If ((aiFileNumber) And (aiFieldNumber)) Begin
34717>>>>>        Get fsLoginUserID to sUser
34718>>>>>        Clear Users
34719>>>>>        Move sUser        to Users.Login_ID
34720>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
34721>>>>>>
34721>>>>>        If (Found=1) Begin
34723>>>>>            Move Users.User_ID  to iUser
34724>>>>>            Move Users.Grp_ID   to iGroup
34725>>>>>            Clear Pedia
34726>>>>>            Move aiFileNumber  to Pedia.Arxeio_ID
34727>>>>>            Move aiFieldNumber to Pedia.Pedio_Number
34728>>>>>            Find eq Pedia By Index.1 // Pedia:Index.1:Arxeio_ID+Pedio_Number
34729>>>>>>
34729>>>>>            If (Found=1) Begin
34731>>>>>                Move (Trim(Pedia.Pedio_Recr))   to sRecr
34732>>>>>                // Find Combination User/File/Field in GRPPEDIA
34732>>>>>                Clear GrpPedia
34733>>>>>                Move iUser                      to GrpPedia.User_ID
34734>>>>>                Move (Trim(sRecr))              to GrpPedia.Pedio_Recr
34735>>>>>                Find eq GrpPedia by Index.4 // GrpPedia:Index.4:Pedio_Recr + User_ID
34736>>>>>>
34736>>>>>                If (Found=1) Begin
34738>>>>>                    // rVal=1 ==> NO READ ALLOWED
34738>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
34738>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
34738>>>>>                    If (GrpPedia.Allow_Read <>'1') Move 1 to rVal
34741>>>>>                    Else Begin
34742>>>>>                        If (GrpPedia.Allow_Change<>'1') Begin
34744>>>>>                            If (GrpPedia.Allow_Copy<>'1')   Move 3 to rVal
34747>>>>>                            Else                            Move 2 to rVal
34749>>>>>                        End
34749>>>>>>
34749>>>>>                    End
34749>>>>>>
34749>>>>>                End
34749>>>>>>
34749>>>>>                Else Begin
34750>>>>>                    // Find Combination UserGrps/File/Field in GRPPED0
34750>>>>>                    Clear GrpPed0
34751>>>>>                    Move iGroup         to GrpPed0.Group_ID
34752>>>>>                    Move (Trim(sRecr))  to GrpPed0.Pedio_Recr
34753>>>>>                    Find eq GrpPed0 by Index.4 // GrpPed0:Index.4:Pedio_Recr + Group_ID
34754>>>>>>
34754>>>>>                    If (Found=1) Begin
34756>>>>>                        // rVal=1 ==> NO READ ALLOWED
34756>>>>>                        // rVal=2 ==> NO EDIT BUT CAN COPY
34756>>>>>                        // rVal=3 ==> NO EDIT AND NO COPY
34756>>>>>                        If (GrpPed0.Allow_Read <>'1') Move 1 to rVal
34759>>>>>                        Else Begin
34760>>>>>                            If (GrpPed0.Allow_Change<>'1') Begin
34762>>>>>                                If (GrpPed0.Allow_Copy<>'1')   Move 3 to rVal
34765>>>>>                                Else                           Move 2 to rVal
34767>>>>>                            End
34767>>>>>>
34767>>>>>                        End
34767>>>>>>
34767>>>>>                    End
34767>>>>>>
34767>>>>>                End
34767>>>>>>
34767>>>>>            End
34767>>>>>>
34767>>>>>            Else Begin
34768>>>>>                Move 0 to rVal
34769>>>>>            End
34769>>>>>>
34769>>>>>        End
34769>>>>>>
34769>>>>>        Else Begin
34770>>>>>            Move 0 to rVal
34771>>>>>        End
34771>>>>>>
34771>>>>>    End
34771>>>>>>
34771>>>>>    Function_Return rVal
34772>>>>>End_Function
34773>>>>>
34773>>>>>Function fsReturnFileFromPath Global String asFullPath Returns String
34774>>>>>    String rVal lsDirSep
34775>>>>>    Integer iPos iMet iLen iCnt
34775>>>>>    Move (Trim(asFullPath))                 To rVal
34776>>>>>    Move (Sysconf(SYSCONF_DIR_SEPARATOR))   To lsDirSep
34777>>>>>    If (rVal Contains lsDirSep) Begin
34779>>>>>        Move (Length(rVal)) to iLen
34780>>>>>        Move iLen to iCnt
34781>>>>>        While iCnt Gt 0
34785>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Begin
34787>>>>>                If (iCnt=iLen) Function_Return asFullPath
34790>>>>>                Else Function_Return (Right(rVal,(iLen-iCnt)))
34792>>>>>            End
34792>>>>>>
34792>>>>>            Decrement iCnt
34793>>>>>        End // While iCnt Gt 0
34794>>>>>>
34794>>>>>    End
34794>>>>>>
34794>>>>>    Else  Function_Return (Trim(asFullPath))
34796>>>>>    Function_Return rVal
34797>>>>>End_Function
34798>>>>>
34798>>>>>Function fsReturnDirectoriesFromPath Global String asFullPath Returns String
34799>>>>>    String rVal lsDirSep
34800>>>>>    Integer iPos iMet iLen iCnt
34800>>>>>    Move (Trim(asFullPath))                 To rVal
34801>>>>>    Move (Sysconf(SYSCOnF_DIR_SEPARATOR))   To lsDirSep
34802>>>>>    If (rVal Contains lsDirSep) Begin
34804>>>>>        Move (Length(rVal)) to iLen
34805>>>>>        Move iLen to iCnt
34806>>>>>        While iCnt Gt 0
34810>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Function_Return (Left(rVal,iCnt))
34813>>>>>            Decrement iCnt
34814>>>>>        End // While iCnt Gt 0
34815>>>>>>
34815>>>>>    End
34815>>>>>>
34815>>>>>    Function_Return rVal
34816>>>>>End_Function
34817>>>>>
34817>>>>>//Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
34817>>>>>//    Local String rVal lsTmp lsOO lsLL
34817>>>>>//    Local Number lnOO lnLL
34817>>>>>
34817>>>>>//    Move '' to lsOO
34817>>>>>//    Move '' to lsLL
34817>>>>>//    Move '' to rVal
34817>>>>>
34817>>>>>//    Move (Integer(anTime))                              to lnOO
34817>>>>>//    ////////////////////////////////////////////
34817>>>>>//    // sos sos sos jsjsjsjsjs yannis 30/03/2000
34817>>>>>//    //If ((lnOO=24) and (lnll=0)) Move 0 to lnOO
34817>>>>>//    ////////////////////////////////////////////
34817>>>>>
34817>>>>>//    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
34817>>>>>
34817>>>>>//    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
34817>>>>>//    Else         Move (String(lnOO))                    to lsOO
34817>>>>>//    Move (Trim(lsOO))                                   to lsOO
34817>>>>>
34817>>>>>//    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
34817>>>>>//    Else         Move (String(lnLL))                    to lsLL
34817>>>>>//    Move (Trim(lsLL))                                   to lsLL
34817>>>>>
34817>>>>>//    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
34817>>>>>
34817>>>>>//    Move (Trim(rVal)) to rVal
34817>>>>>
34817>>>>>//    Function_Return rVal
34817>>>>>//End_Function
34817>>>>>
34817>>>>>//Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
34817>>>>>//    Local Number rVal nOres nLepta
34817>>>>>//    Move (Integer(aiMinutes/60))    to nOres
34817>>>>>//    Move (    Mod(aiMinutes,60))    to nLepta
34817>>>>>//    Move (nOres+(nLepta/100))       to rVal
34817>>>>>//    Function_Return rVal
34817>>>>>//End_Function
34817>>>>>
34817>>>>>//Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
34817>>>>>//    Local Integer rVal
34817>>>>>//    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
34817>>>>>//    Function_Return rVal
34817>>>>>//End_Function
34817>>>>>
34817>>>>>//Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;
34817>>>>>//                                                                    Number anEndTime    ;
34817>>>>>//                                                                    Returns Integer
34817>>>>>//    Local Integer rVal iMinStart iMinEnd
34817>>>>>
34817>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
34817>>>>>
34817>>>>>//    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
34817>>>>>//    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
34817>>>>>//    Move (iMinEnd-iMinStart)                                                     to rVal
34817>>>>>//    Function_Return rVal
34817>>>>>//End_Function
34817>>>>>
34817>>>>>
34817>>>>>//Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;
34817>>>>>//                                                                Number anEndTime    ;
34817>>>>>//                                                                Returns Number
34817>>>>>//    Local Integer iTmp
34817>>>>>//    Local Number  rVal
34817>>>>>
34817>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
34817>>>>>
34817>>>>>//    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
34817>>>>>//    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
34817>>>>>//    Function_Return rVal
34817>>>>>//End_Function
34817>>>>>
34817>>>>>
34817>>>>>Function fsLoginUserID Global Returns String
34818>>>>>    Local String LastLogin# LoginUserid#
34819>>>>>    get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin#
34822>>>>>    If LastLogin# eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin#
34825>>>>>    insert "WorkSpaces\" in LastLogin# at 1
34827>>>>>    Append LastLogin# "\" (Module_Name(Self)) "\LastLogin"
34830>>>>>    get_profile_string LastLogin# "LoginUserId"  to LoginUserId#
34833>>>>>    Trim LoginUserID# to LoginUserID#
34834>>>>>>
34834>>>>>    If LoginUserId# eq "" Move (Network_User_Name(Current_Object)) to LoginUserId#
34837>>>>>    Function_Return LoginUserID#
34838>>>>>End_Function
34839>>>>>
34839>>>>>Function fiWriteRegistryLastSDFPath Global String asLastPath Returns Integer
34840>>>>>    Integer rVal
34841>>>>>    String  lsCurrentWksp
34841>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34844>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34847>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34849>>>>>    // Œœ¦ ¡¢œ ›   - Last_SDF_Path -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
34849>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
34849>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
34852>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
34855>>>>>    Function_Return rVal
34856>>>>>End_Function
34857>>>>>
34857>>>>>
34857>>>>>Function fsReadRegistryLastSDFPath Global Returns String
34858>>>>>    String rVal lsCurrentWksp
34859>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34862>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34865>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34867>>>>>    // Œœ¦ ¡¢œ ›   - LastParastUsed -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
34867>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
34867>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
34870>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
34873>>>>>    Function_Return (Trim(rVal))
34874>>>>>End_Function
34875>>>>>
34875>>>>>
34875>>>>>Function fiWriteRegistryLastMCryptPath Global String asLastPath Returns Integer
34876>>>>>    Integer rVal
34877>>>>>    String  lsCurrentWksp
34877>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34880>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34883>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34885>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
34888>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
34891>>>>>    Function_Return rVal
34892>>>>>End_Function
34893>>>>>
34893>>>>>
34893>>>>>Function fsReadRegistryLastMCryptPath Global Returns String
34894>>>>>    String rVal lsCurrentWksp
34895>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34898>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34901>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34903>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
34906>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
34909>>>>>    Function_Return (Trim(rVal))
34910>>>>>End_Function
34911>>>>>
34911>>>>>
34911>>>>>Function fiWriteRegistryLastWEBPath Global String asLastPath Returns Integer
34912>>>>>    Integer rVal
34913>>>>>    String  lsCurrentWksp
34913>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34916>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34919>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34921>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
34924>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
34927>>>>>    Function_Return rVal
34928>>>>>End_Function
34929>>>>>
34929>>>>>
34929>>>>>Function fsReadRegistryLastWEBPath Global Returns String
34930>>>>>    String rVal lsCurrentWksp
34931>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34934>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34937>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34939>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
34942>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
34945>>>>>    Function_Return (Trim(rVal))
34946>>>>>End_Function
34947>>>>>
34947>>>>>
34947>>>>>
34947>>>>>Function fig_Is_Admin Global Returns Integer
34948>>>>>    String sUser
34949>>>>>    Integer rVal
34949>>>>>    Get fsLoginUserID to sUser
34950>>>>>    Move (trim(sUser)) to sUser
34951>>>>>    Clear Users
34952>>>>>    Move sUser to Users.Login_ID
34953>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
34954>>>>>>
34954>>>>>    Move Users.Admin_Rights to rVal
34955>>>>>    Function_Return rVal
34956>>>>>End_Function
34957>>>>>
34957>>>>>Function fig_The_User_Group Global Returns Integer
34958>>>>>    String sUser
34959>>>>>    Get fsLoginUserID   to sUser
34960>>>>>    Move (trim(sUser))  to sUser
34961>>>>>    Clear Users
34962>>>>>    Move sUser          to Users.Login_ID
34963>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
34964>>>>>>
34964>>>>>    Clear UserGrps
34965>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
34966>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
34967>>>>>>
34967>>>>>    Function_Return UserGrps.Grp_ID
34968>>>>>End_Function
34969>>>>>
34969>>>>>Function fsg_The_User_Department Global Returns String
34970>>>>>    String sUser
34971>>>>>    Get fsLoginUserID   to sUser
34972>>>>>    Move (trim(sUser))  to sUser
34973>>>>>    Clear Users
34974>>>>>    Move sUser          to Users.Login_ID
34975>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
34976>>>>>>
34976>>>>>    Clear Departm
34977>>>>>    Move Users.Departm_Code   to Departm.Code
34978>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
34979>>>>>>
34979>>>>>    Function_Return Departm.Code
34980>>>>>End_Function
34981>>>>>
34981>>>>>
34981>>>>>Function fig_Is_Specific_Admin Global String asUser Returns Integer
34982>>>>>    Integer rVal
34983>>>>>    Move (trim(asUser)) to asUser
34984>>>>>    Clear Users
34985>>>>>    Move asUser to Users.Login_ID
34986>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
34987>>>>>>
34987>>>>>    Move Users.Admin_Rights to rVal
34988>>>>>    Function_Return rVal
34989>>>>>End_Function
34990>>>>>
34990>>>>>Function fig_The_Specific_User_Group Global String asUser Returns Integer
34991>>>>>    Move (trim(asUser))  to asUser
34992>>>>>    Clear Users
34993>>>>>    Move asUser          to Users.Login_ID
34994>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
34995>>>>>>
34995>>>>>    Clear UserGrps
34996>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
34997>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
34998>>>>>>
34998>>>>>    Function_Return UserGrps.Grp_ID
34999>>>>>End_Function
35000>>>>>
35000>>>>>Function fsg_The_Specific_User_Department Global String asUser Returns String
35001>>>>>    Move (trim(asUser))  to asUser
35002>>>>>    Clear Users
35003>>>>>    Move asUser          to Users.Login_ID
35004>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35005>>>>>>
35005>>>>>    Clear Departm
35006>>>>>    Move Users.Departm_Code   to Departm.Code
35007>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
35008>>>>>>
35008>>>>>    Function_Return Departm.Code
35009>>>>>End_Function
35010>>>>>
35010>>>>>
35010>>>
35010>>>Class ViewPopupMenu_Sec Is A ViewPopupMenu
35011>>>
35011>>>    Open Sysfile
INCLUDING FILE: SYSFILE.FD
35013>>>    Open Users
35015>>>    Open Views
INCLUDING FILE: VIEWS.FD
35017>>>    Open GrpViews
INCLUDING FILE: GRPVIEWS.FD
35019>>>    Open GrpView0
INCLUDING FILE: GRPVIEW0.FD
35021>>>    Open Arxeia
35023>>>    Open GrpArx
35025>>>
35025>>>    Function Find_User_Rights_In_Class String asView Returns Integer
35026>>>        String  lsView lsLogin
35027>>>        Integer liUser  liViews iGroup
35027>>>
35027>>>        Move (fsLoginUserID())      to lsLogin
35028>>>        Move (Trim(ToOEM(asView)))  to lsView
35029>>>
35029>>>        //////  /////////////////////////////////////
35029>>>        Clear Users
35030>>>        Move lsLogin    to Users.Login_ID
35031>>>
35031>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
35032>>>>
35032>>>        If (Found=1)  Begin
35034>>>            Move Users.User_ID  to liUser
35035>>>            Move Users.Grp_ID   to iGroup
35036>>>        End
35036>>>>
35036>>>        Else Function_Return 0
35038>>>
35038>>>        Clear Views
35039>>>        Move (Trim(lsView)) to Views.Menu_Name
35040>>>        Find eq Views by Index.2 // Views:Index.2:Views.Menu_Name
35041>>>>
35041>>>        If (Found=1) Begin
35043>>>            Move Views.View_ID to liViews
35044>>>            Clear GrpViews
35045>>>            Move liUser    to GrpViews.User_ID
35046>>>            Move liViews   to GrpViews.View_ID
35047>>>            Find Eq GrpViews by Index.1 // GrpViews:Index.1:GrpViews.User_ID+GrpViews.View_ID
35048>>>>
35048>>>            If (Found=1) Begin // And (liUser=GrpViews.User_ID) And (liViews=GrpViews.View_ID)) Begin
35050>>>                Function_Return (GrpViews.Allow_Read<>'1')
35051>>>            End
35051>>>>
35051>>>            Else Begin
35052>>>                Clear GrpView0
35053>>>                Move iGroup    to GrpView0.Group_ID
35054>>>                Move liViews   to GrpView0.View_ID
35055>>>                Find eq GrpView0 by Index.1 // GrpView0:Index.1:Group_ID+View_ID
35056>>>>
35056>>>                If (Found=1) Begin
35058>>>                    Function_Return (GrpView0.Allow_Read<>'1')
35059>>>                End
35059>>>>
35059>>>                Else         Function_Return 0
35061>>>            End
35061>>>>
35061>>>        End
35061>>>>
35061>>>        Else Function_Return 0
35063>>>    End_Function
35064>>>
35064>>>//    Procedure Enhmerose_Views_File_In_Class
35064>>>//        Integer liCount liInt liLastNo
35064>>>//        String lsStr
35064>>>//        Get Item_Count to liCount
35064>>>//        // find last view_id
35064>>>//        Clear Views
35064>>>//        Move 9999 to Views.View_ID
35064>>>//        Find lt Views by index.1 // view_id
35064>>>//        If (Found=1)    Move Views.View_ID  to liLastNo
35064>>>//        Else            Move 0              to liLastNo
35064>>>//        For liInt From 0 to (liCount-1)
35064>>>//            Get Value item liInt to lsStr
35064>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
35064>>>//            //Move (Trim(lsStr)) to lsStr
35064>>>//            If (lsStr<>'') Begin
35064>>>//                Clear Views
35064>>>//                Move lsStr to Views.Menu_Name
35064>>>//                Find eq Views by index.2 // Views.Menu_Name
35064>>>//                If (NOT(Found)) Begin
35064>>>//                    Add 1 to liLastNo
35064>>>//                    Move liLastNo to Views.View_ID
35064>>>//                    Saverecord Views
35064>>>//                End
35064>>>//            End
35064>>>//        Loop
35064>>>//        For liInt From 0 to (liCount-1)
35064>>>//            Get Value item liInt to lsStr
35064>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
35064>>>//            //Move (Trim(lsStr)) to lsStr
35064>>>//            If (lsStr<>'') Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
35064>>>//        Loop
35064>>>//    End_procedure
35064>>>
35064>>>    Procedure OnInitMenu
35065>>>        Integer liCount liInt liLastNo
35066>>>        String lsStr
35066>>>
35066>>>        Get Item_Count to liCount
35067>>>
35067>>>        // find last view_id
35067>>>        Clear Views
35068>>>        Move 9999 to Views.View_ID
35069>>>        Find lt Views by index.1 // view_id
35070>>>>
35070>>>        If (Found=1)    Move Views.View_ID  to liLastNo
35073>>>        Else            Move 0              to liLastNo
35075>>>        For liInt From 0 to (liCount-1)
35081>>>>
35081>>>            Get Value item liInt to lsStr
35082>>>            Move (Trim(lsStr)) to lsStr
35083>>>            If ((lsStr<>'') and (Length(lsStr)>2)) Begin
35085>>>                Clear Views
35086>>>                Move (ToOEM(lsStr)) to Views.Menu_Name
35087>>>                Find eq Views by index.2 // Views.Menu_Name
35088>>>>
35088>>>                If (NOT(Found)) Begin
35090>>>                    Add 1 to liLastNo
35091>>>                    Move liLastNo to Views.View_ID
35092>>>                    //Move (ToOEM(lsStr)) to Views.Menu_Name
35092>>>                    Saverecord Views
35093>>>                End
35093>>>>
35093>>>            End
35093>>>>
35093>>>        Loop
35094>>>>
35094>>>        For liInt From 0 to (liCount-1)
35100>>>>
35100>>>            Get Value item liInt to lsStr
35101>>>            Move (Trim(lsStr)) to lsStr
35102>>>            Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
35103>>>        Loop
35104>>>>
35104>>>
35104>>>    End_procedure
35105>>>
35105>>>//    Procedure End_Construct_Object
35105>>>//        Forward Send End_Construct_Object
35105>>>//        Send Enhmerose_Views_File_In_Class
35105>>>//    End_Procedure
35105>>>
35105>>>End_Class //ButtonSub
35106>>>
35106>>>
35106>
35106>//AB-StoreTopEnd
35106>
35106>
35106>Object Main is a Panelsub
35108>    Set Label To "Titan"
35109>
35109>    DFCreate_Menu Main_Menu
INCLUDING FILE: FILE_PM.INC
35112>>Object oMyWinPrint is an DF_PRINTER
35114>>
35114>>    Procedure DFPrint
35116>>        Local Integer iRetVal
35117>>
35117>>        Get DFGetPrintDialogFlags To iRetVal
35118>>
35118>>        If iRetVal Begin
35120>>            Send DFPrintDoc
35121>>            Send DFClearDoc
35122>>        End
35122>>>
35122>>    End_Procedure
35123>>    Move Current_Object to WinPrintId
35124>>End_Object
35125>>
35125>>
35125>>DFCreate_Menu "&File" File_Menu is a DEOPopupMenu
35129>>    On_Item "&Clear/Add\aF5" send Request_Clear
35130>>        Set Status_Help To 'Clear current record / Add a new record'
35131>>
35131>>    On_Item "Clear &all\aCtrl+F5" send Request_Clear_All
35132>>        Set Status_Help To 'Clear all data from view'
35133>>
35133>>    On_Item "&Delete\aShift+F2" send Request_Delete
35134>>        Set Status_Help To 'Delete the current record'
35135>>
35135>>    On_Item "&Find\aF9" send Find_GE
35136>>        Set Status_Help To 'Find a record'
35137>>
35137>>    On_Item "&Next\aF8" send Find_Next
35138>>        Set Status_Help To 'Find the Next record'
35139>>
35139>>    On_Item "&Previous\aF7" send Find_Previous
35140>>        Set Status_Help To 'Find the Previous record'
35141>>
35141>>    On_Item "Superfind\aShift+F9" send Superfind
35142>>        Set Status_Help To 'Superfind a record'
35143>>
35143>>    On_Item "Superfind next\aShift+F8" send Superfind_Next
35144>>        Set Status_Help To 'Superfind the Next record'
35145>>
35145>>    On_Item "Superfind previous\aShift+F7" send Superfind_Previous
35146>>        Set Status_Help To 'Superfind the Previous record'
35147>>
35147>>    On_Item "Find fi&rst\aCtrl+Home" send Beginning_Of_Data
35148>>        Set Status_Help To 'Find the First record'
35149>>
35149>>    On_Item "Find &last\aCtrl+End" send End_Of_Data
35150>>        Set Status_Help To 'Find the Last record'
35151>>
35151>>    On_Item "&Save\aF2" send Request_Save
35152>>        Set Status_Help To 'Save the current record'
35153>>
35153>>
35153>>    On_Item "" send NONE
35154>>
35154>>    on_item   "Printer Settings   "  send DFPrintSetup       to (oWinPrint(Self))
35155>>    Set Status_Help To ""
35156>>    on_item   "Print              "  send DFPrint            to (oMyWinPrint(Self))
35157>>    Set Status_Help To ""
35158>>
35158>>    On_Item "" send NONE
35159>>
35159>>    On_Item "Properties" send DoShowProperties to Self
35160>>    Set Status_Help To 'Setup Program Properties'
35161>>
35161>>    On_Item "" send NONE
35162>>
35162>>    On_Item "E&xit\aAlt+F4" send Exit_Application to desktop
35163>>        Set Status_Help To "Stop Program's execution"
35164>>
35164>>    Procedure DoShowProperties
35166>>       // If (Close_All_Views(Self,True)=0) Send Activate_View to (piPropertiesObjectId(self))
35166>>    End_Procedure
35167>>
35167>>    On_Key Key_Alt+Key_I Send DoShowProperties
35168>>
35168>>    //
35168>>    Procedure OnInitMenu
35170>>        Local integer Obj# IsDeo Changed NoIndex File# Field# Srvr Itm
35171>>        Local integer IsDeoControl lId liClId
35171>>        Get Focus to Obj#
35172>>        Get is_Function Get_DEO_Object Obj# TRUE to IsDeo
35173>>        If IsDeo Get Server of obj# to Srvr          // invoking data-set
35176>>        If (isDeo AND Srvr) Begin
35178>>            // returns T if object in question is a DEO control object (i.e.
35178>>            // understands the data_file, data_field messages).
35178>>            Get is_Function Get_DEO_Control_Object Obj# False to IsDeoControl
35179>>            Get Should_Save of Obj# to changed  // changed file?
35180>>            If IsDEOControl Begin
35182>>                Get data_file of Obj# to file#
35183>>                Get data_field of Obj# to field#
35184>>                Move ( File#=0 OR ;                    (Field_Main_Index(Srvr,File#,Field#)=-1) ;                    ) to NoIndex             // has a find index?
35185>>            End
35185>>>
35185>>            Else ;                Move 1 to NoIndex
35187>>            Set Shadow_state item  0  to False                     // Clear
35188>>            Set Shadow_state item  1  to False                     // Clear All
35189>>            Set Shadow_state item  2  to (Current_record(Srvr)=0)  // Delete
35190>>            Set Shadow_state item  3  to NoIndex                   // Find
35191>>            Set Shadow_state item  4  to NoIndex                   // Find Next
35192>>            Set Shadow_state item  5  to NoIndex                   // Find Previous
35193>>            Set Shadow_state item  6  to NoIndex                   // Superfind
35194>>            Set Shadow_state item  7  to NoIndex                   // Superfind Next
35195>>            Set Shadow_state item  8  to NoIndex                   // Superfind Previous
35196>>            Set Shadow_state item  9  to NoIndex                   // Find First
35197>>            Set Shadow_state item 10  to NoIndex                   // Find Last
35198>>            Set Shadow_state item 11  to (Should_Save(Srvr)=0)     // Save
35199>>            Set Shadow_state item 12  to NoIndex                   // Printer
35200>>            Set Shadow_state item 13  to NoIndex                   // Print
35201>>//            Set Shadow_state item 14  to NoIndex                   // Properties
35201>>//            Set Shadow_state item 15  to (Should_Save(Srvr)=0)     // Exodos
35201>>        End
35201>>>
35201>>        Else Begin
35202>>            for itm from 0 to 13
35208>>>
35208>>                set shadow_State item itm to TRUE
35209>>            Loop
35210>>>
35210>>        End
35210>>>
35210>> //       Set Shadow_State Item 14 to (piPropertiesObjectId(Self)=0)
35210>>    End_Procedure
35211>>
35211>>    Register_Procedure Activate_oPrnSetup
35211>>
35211>>End_Pull_Down
35213>>Set Status_Help to "Find, Save, Delete, Clear information or quit this application."
35214>
35214>        DFCreate_Menu "&View" ViewPopupMenu is a ViewPopupMenu
35218>            On_Item "&Taxioamal:amaliada\aCtrl+1" Send Activate_tAxioamal
35219>        End_Pull_down
35221>        Set Status_Help To "Available Views"
35222>        
INCLUDING FILE: NAVI_PM.INC
35222>>Use DFDEOMnu
35222>>
35222>>DFCreate_Menu "&Navigation" NAVIGATE_Menu is a DEOPopupMenu
35226>>    On_Item "&Next Area\aF6"            send Switch_Next_Area
35227>>        Set Status_Help To  'Move to Next Area'
35228>>
35228>>    On_Item "&Previous Area\aShift+F6"  send Switch_Prior_Area
35229>>        Set Status_Help To  'Move to Previous Area'
35230>>
35230>>    On_Item "N&ext View\aAlt+F6"        send Switch_Next_View
35231>>        Set Status_Help To  'Move to Next View'
35232>>
35232>>    On_Item "P&revious View\aCtrl+F6"   send Switch_Prior_View
35233>>        Set Status_Help To  'Move to Previous View'
35234>>
35234>>    On_Item ""                          send none
35235>>
35235>>    On_Item "&List\aF4"               send Prompt
35236>>        Set Status_Help To  'Show Selection Lists'
35237>>
35237>>    On_Item "&Zoom\aAlt+F9"             send Zoom
35238>>        Set Status_Help To  'Show Zoom'
35239>>
35239>>    Procedure OnInitMenu
35241>>        Local integer Obj# IsDeo Itm prmpt zm isDeoControl
35242>>        Get Focus to Obj#
35243>>        Get is_Function Get_DEO_Object Obj# TRUE to IsDeo
35244>>        If IsDeo Begin
35246>>            Get is_Function Get_DEO_Control_Object Obj# False to IsDeoControl
35247>>            If IsDeoControl Begin
35249>>                Get Prompt_Object of Obj# to Prmpt
35250>>                Get Zoom_Object of Obj# to zm
35251>>            End
35251>>>
35251>>            Set Shadow_state item 0  to False
35252>>            Set Shadow_state item 1  to False
35253>>            Set Shadow_state item 2  to False
35254>>            Set Shadow_state item 3  to False
35255>>            Set Shadow_state item 5  to (Prmpt=0)
35256>>            Set Shadow_state item 6  to (Zm=0)
35257>>        End
35257>>>
35257>>        Else Begin
35258>>            for itm from 0 to 6
35264>>>
35264>>                set shadow_State item itm to TRUE
35265>>            Loop
35266>>>
35266>>        End
35266>>>
35266>>    End_Procedure
35267>>
35267>>End_Pull_Down
35269>>Set Status_Help to "Navigation in different areas of the screen"
35270>>
INCLUDING FILE: WIN_PM.INC
35270>>DFCreate_Menu "&Window" Window_Menu
35274>>    Set select_mode to Multi_Select
35275>>    // normal number of items in pulldown (w/ no active views)
35275>>    property integer std_item_count public 0
35277>>
35277>>    DFCreate_Menu "&Preferences" Display_Options_Menu
35281>>        Set select_mode to Multi_Select
35282>>        On_Item "&ToolBar"        Send Toggle_Toolbar             To Self
35283>>        On_Item "&StatusBar"      Send Toggle_Statusbar           To Self
35284>>        On_Item "&Arrange Icons"  Send Toggle_Auto_Arrange_Icons  To Self
35285>>
35285>>        //  When ever the menu [pulldown] is initialized, check/set
35285>>        //  the state of its items.
35285>>        //
35285>>        Procedure OnInitMenu
35287>>            local integer bState
35288>>
35288>>            Get ToolBar_State to bState
35289>>            Set Select_State Item 0 to bState
35290>>            if  bState   Set Status_Help Item 0 To '' //'Hide the ToolBar'
35293>>            Else         Set Status_Help Item 0 to '' //'Show the ToolBar'
35295>>
35295>>            Get Statusbar_State to bState
35296>>            Set Select_State Item 1 to bState
35297>>            if  bState  Set Status_Help Item 1 To ''// 'Hide the StatusBar'
35300>>            Else        Set Status_Help Item 1 to ''// 'Show the StatusBar'
35302>>
35302>>            Get Auto_Arrange_Icons_State to bState
35303>>            Set Select_State Item 2 to bState
35304>>            if  bState  Set Status_Help Item 2 To '' //'Hide AutoArrange Icons'
35307>>            Else        Set Status_Help Item 2 to '' //'Show AutoArrange Icons'
35309>>
35309>>        End_procedure
35310>>
35310>>
35310>>    End_Pull_Down
35312>>    Set Status_Help                                           To '' //"Enable Toolbar, StatusBar, and AutoArrange Icons options"
35313>>
35313>>    On_Item ""
35314>>
35314>>    On_Item "&Cascade" send Cascade_Windows                   To Self
35315>>        Set Status_Help                                       To ''
35316>>
35316>>    On_Item "Tile &Horizontally" send Tile_Windows_Horizontal To Self
35317>>        Set Status_Help                                       To ''
35318>>
35318>>    On_Item "Tile &Vertically" send Tile_Windows_Vertical     To Self
35319>>        Set Status_Help                                       To ''
35320>>
35320>>    On_Item ""
35321>>
35321>>    On_Item "Minimize all" send Minimize_all_Windows          To Current_Object
35322>>        Set Status_Help                                       To ''
35323>>
35323>>    On_Item "&Restore all" send Restore_all_Windows           To Current_Object
35324>>        Set Status_Help                                       To ''
35325>>
35325>>    On_Item ""
35326>>
35326>>    On_Item "&Arrange Icons" send Arrange_Icons               To Current_Object
35327>>        Set Status_Help                                       To ''
35328>>
35328>>    // set this to the number of items in the menu with no views.
35328>>    Set Std_item_count to (item_count(current_object))
35329>>
35329>>    // add all active views to the end of the menu
35329>>    Procedure OnInitMenu
35331>>        local integer iStdCnt iNumCnt hVw hCl iCount
35332>>        Local string sLbl
35332>>        //*** Remove all old view items
35332>>        Get Item_count     to iNumCnt
35333>>        get Std_item_count to iStdCnt
35334>>        For iCount from 1  to (iNumCnt - iStdCnt)
35340>>>
35340>>            Send Delete_item iStdCnt
35341>>        Loop
35342>>>
35342>>
35342>>        Move iStdcnt to iNumCnt
35343>>        get Client_id to hCl // object id of client area
35344>>        If hCl Begin
35346>>           Get Next_Mdi_Dialog of hcl TRUE to hVw // find first view
35347>>           While hVw
35351>>              if (Active_state(hVw)) Begin
35353>>                 if iNumCnt eq iStdCnt Begin // if first view, add separator
35355>>                    send add_item 0 ''
35356>>                    increment iNumCnt
35357>>                 end
35357>>>
35357>>                 Get Label of hVw to sLbl // caption bar (name) of view
35358>>                 // note that all views understand the message activate_view.
35358>>                 send add_item msg_activate_view sLbl // set message, value and destination
35359>>                 set aux_value item iNumcnt to hVw
35360>>                 // if this is the focus view, mark it.
35360>>                 If (current_scope(desktop)=hVw and View_mode(hVw)<>VIEWMODE_ICONIZE) ;                     set select_state item iNumCnt to True
35363>>                 // create status help
35363>>                 Set Status_help item iNumCnt to ("Make this view (" - trim(sLbl) - ") the active window.")
35364>>                 increment iNumCnt
35365>>              end
35365>>>
35365>>              Get Next_Mdi_Dialog of hcl FALSE to hVw // find next
35366>>           End
35367>>>
35367>>        End
35367>>>
35367>>    End_Procedure // OnInitMenu
35368>>
35368>>End_Pull_Down
35370>>Set Status_Help to ''
INCLUDING FILE: HELPA_PM.INC
35371>>
35371>>
35371>>DFCreate_Menu "&Help" Help_Menu
35375>>    on_item "&Help Topic" send Help_on_topic
35376>>        Set Status_Help To "Search for help on a particular subject."
35377>>        on_item "" send NONE
35378>>    on_item "&Context Help"          send Extended_Help
35379>>        Set Status_Help To "Show Context sensitive help."
35380>>
35380>>    on_item "&Files Help"            send File_Help
35381>>        Set Status_Help To "Show Files help."
35382>>
35382>>    on_item "&Keys Help"             send Keys_Help
35383>>        Set Status_Help To "Show Keys help."
35384>>
35384>>    on_item "" send NONE
35385>>
35385>>    on_item "&How to Use Help"       send Help_For_Help
35386>>        Set Status_Help To "How to Use Help"
35387>>
35387>>    on_item "" send NONE
35388>>
35388>>    On_Item "&Tips of the Day" send Activate_TipOfDay
35389>>        Set Status_Help To "Tips of the Day"
35390>>
35390>>    on_item "" send NONE
35391>>
35391>>    On_item "About" Send Activate_About
35392>>        Set Status_Help To "System Information"
35393>>end_pull_down
35395>>Set Status_Help to "Access to the program's help subsystem"
35396>>
35396>>Register_Procedure Activate_TipOfDay
35396>>
35396>>
35396>    End_Menu
35398>
35398>    Use DFStdBtn.pkg //  Tool-Bar object.
INCLUDING FILE: DFSTDBTN.PKG
35398>>>// 07/23/96 JJT - New Class names
35398>>>// 10/03/97 KCR - removed leading separator
35398>>>
35398>>>Use DFMainBt  // dfMain_ButtonBar
INCLUDING FILE: DFMAINBT.PKG
35398>>>>>//-------------------------------------------------------------------------
35398>>>>>// DFMainBt.pkg - DfMain_ButtonBar class
35398>>>>>//
35398>>>>>//
35398>>>>>// 07/23/96 JJT - New Class names
35398>>>>>//-------------------------------------------------------------------------
35398>>>>>
35398>>>>>Use DfPanel // dfapp_buttonbar
35398>>>>>
35398>>>>>Class ToolBar is a AppToolBar
35399>>>>>
35399>>>>>    Function Is_Function Integer MsgId Integer ObjId Integer DelegateFg Returns Integer
35400>>>>>      Local integer rval MainObj#
35401>>>>>      Get Main_Panel_id to MainObj#
35402>>>>>      If (ObjId>Desktop AND MainObj#) ;         Get Is_Function of MainObj# MsgId ObjId DelegateFg to rVal
35405>>>>>      Function_Return rVal
35406>>>>>    End_Function
35407>>>>>
35407>>>>>    Procedure Redirect_Button_Message integer Itm
35408>>>>>         Local integer Msg# Aux# rval Understood
35409>>>>>         If (Shadow_State(Current_Object,itm)) Procedure_Return
35412>>>>>         Get Message   item itm  to Msg#
35413>>>>>         Get Aux_Value item itm  to Aux#
35414>>>>>         If Msg# Begin
35416>>>>>           If Aux# eq 0 Begin
35418>>>>>              Get Focus to Aux#
35419>>>>>              Get Is_Function Get_DEO_Object Aux# TRUE to Understood
35420>>>>>              If Not Understood Move 0 to Aux#
35423>>>>>           End
35423>>>>>>
35423>>>>>           If Aux# Get Msg# of Aux# to rval
35426>>>>>           Procedure_return rval
35427>>>>>         end
35427>>>>>>
35427>>>>>    End_Procedure // Redirect_Message
35428>>>>>
35428>>>>>End_Class
35429>>>>>
35429>>>>>
35429>>>
35429>>>//  Button bar object.
35429>>>//
35429>>>Object Tool_Bar is a ToolBar
35431>>>
35431>>>    Send ImageList_Add 'bgn.bmp'   // 0
35432>>>    Send ImageList_Add 'end.bmp'   // 1
35433>>>    Send ImageList_Add 'next.bmp'  // 2
35434>>>    Send ImageList_Add 'prev.bmp'  // 3
35435>>>    Send ImageList_Add 'clr.bmp'   // 4
35436>>>    Send ImageList_Add 'clra.bmp'  // 5
35437>>>
35437>>>    send Add_button (ico_user+0) msg_beginning_of_data
35438>>>    Send Add_ToolTip "Beginning of file"
35439>>>    Set  Status_Help To 'Find the First record (Ctrl+Home)'
35440>>>
35440>>>    send Add_button (ico_user+3) msg_find_previous
35441>>>    Send Add_ToolTip "Find Previous"
35442>>>    Set  Status_Help To 'Find the Previous record (F7)'
35443>>>
35443>>>    send Add_button (ico_user+2) msg_find_next
35444>>>    Send Add_ToolTip "Find Next"
35445>>>    Set  Status_Help To 'Find the Next record (F8)'
35446>>>
35446>>>    send Add_button (ico_user+1) msg_end_of_data
35447>>>    Send Add_ToolTip "End of File"
35448>>>    Set  Status_Help To 'Find the Last record (Ctrl+End)'
35449>>>
35449>>>    Send Add_space
35450>>>
35450>>>    send Add_button ico_std_find msg_prompt
35451>>>    Send Add_ToolTip "Prompt"
35452>>>    Set  Status_Help To 'Show available selections (F4)'
35453>>>
35453>>>    send Add_button (ico_user+4) msg_request_clear
35454>>>    Send Add_ToolTip "Clear"
35455>>>    Set  Status_Help To 'Clear current record / Add a new record (F5)'
35456>>>
35456>>>    send Add_button (ico_user+5) msg_request_clear_all
35457>>>    Send Add_ToolTip "Clear All"
35458>>>    Set  Status_Help To 'Clear all data from view (Ctrl+F5)'
35459>>>
35459>>>    send Add_space
35460>>>
35460>>>    send Add_button ico_std_filesave msg_request_save
35461>>>    Send Add_ToolTip "Save"
35462>>>    Set  Status_Help To 'Save the current record (F2)'
35463>>>
35463>>>    send Add_button ico_std_delete msg_request_delete
35464>>>    Send Add_ToolTip "Delete"
35465>>>    Set  Status_Help To 'Delete the current record (Shift+F2)'
35466>>>
35466>>>    send Add_space
35467>>>
35467>>>    send Add_button ico_std_cut msg_cut
35468>>>    Send Add_ToolTip "Cut"
35469>>>    Set  Status_Help to "Cuts the selection and puts it on the Clipboard"
35470>>>
35470>>>    send Add_button ico_std_copy msg_copy
35471>>>    Send Add_ToolTip "Copy"
35472>>>    Set  Status_Help to "Copies the selection and puts it on the Clipboard"
35473>>>
35473>>>    send Add_button ico_std_paste msg_paste
35474>>>    Send Add_ToolTip "Paste"
35475>>>    Set  Status_Help to "Inserts Clipboard contents"
35476>>>
35476>>>End_Object
35477>>>
35477>    
35477>    Object Client_Area is a AppClientAreasub
35479>
35479>        //AB-ClientStoreTopStart
35479>        Use DD_Sec.Sub
INCLUDING FILE: DD_SEC.SUB
35479>>>
35479>>>Open Sysfile
35481>>>Open UserGrps
35483>>>Open Users
35485>>>Open Views
35487>>>Open GrpViews
35489>>>Open Arxeia
35491>>>Open GrpArx
35493>>>Open GrpArx0
35495>>>Open GrpView0
35497>>>
35497>>>Use DD.Sub
35497>>>
35497>>>Class Datadictionary_Sec  Is A DatadictionarySub
35498>>>
35498>>>
35498>>>    Procedure Construct_Object
35499>>>        Forward Send Construct_Object
35501>>>        Property Integer cpiUpdate              0
35502>>>        Property Integer cpiBackout             0
35503>>>        Property Integer cpiEditing             0
35504>>>        Property Integer cpiFileNumber          0
35505>>>        Property String  cpsFileName            ''
35506>>>        Property String  cpsLoginID             ''
35507>>>        Property Integer cpiCannot_Read         0
35508>>>        Property Integer cpiCannot_Create       0
35509>>>        Property Integer cpiCannot_Delete       0
35510>>>        Property Integer cpiCannot_Edit         0
35511>>>        Property Integer piFN                   0
35512>>>    End_Procedure
35513>>>
35513>>>//    Procedure Save_Main_File
35513>>>//        If (Operation_Origin<>Self) Begin
35513>>>//            If Indirect_File.Recnum Eq 0 Procedure_Return
35513>>>//        End
35513>>>//        Forward Send Save_Main_File
35513>>>//    End_Procedure
35513>>>
35513>>>
35513>>>
35513>>>    Function Validate_Save Returns Integer
35514>>>        Integer rVal
35515>>>        Forward Get Validate_Save to rVal
35517>>>        If (Not(rVal)) Begin
35519>>>            Get cpiCannot_Read to rVal
35520>>>            If (Not(rVal)) Begin
35522>>>                Set cpiEditing to ((cpiBackout(Self)=1) and (cpiUpdate(Self)=1))
35523>>>                If (cpiEditing(Self)=1) Get cpiCannot_Edit      to rVal
35526>>>                Else                    Get cpiCannot_Create    to rVal
35528>>>            End
35528>>>>
35528>>>            If (rVal) Send Operation_Not_Allowed rVal
35531>>>        End
35531>>>>
35531>>>        Function_Return rVal
35532>>>    End_Function
35533>>>
35533>>>    Function Validate_Delete Returns Integer
35534>>>        Integer rVal
35535>>>        Forward Get Validate_Delete to rVal
35537>>>        If (Not(rVal)) Begin
35539>>>            Get cpiCannot_Read to rVal
35540>>>            If (Not(rVal)) Get cpiCannot_Delete to rVal
35543>>>            If (rVal) Send Operation_Not_Allowed rVal
35546>>>        End
35546>>>>
35546>>>        Function_Return rVal
35547>>>    End_Function
35548>>>
35548>>>    Procedure End_Construct_Object
35549>>>        Integer liSrv rVal
35550>>>        String lsStr
35550>>>        Forward Send End_Construct_Object
35552>>>        Get Main_File                                   To liSrv
35553>>>        Set cpiFileNumber                               To liSrv
35554>>>        Get_Attribute DF_FILE_PHYSICAL_NAME Of liSrv    To lsStr
35557>>>        Set cpsFileName                                 To (Trim(Uppercase(lsStr)))
35558>>>        Set cpsLoginID                                  To (fsLoginUserID())
35559>>>        Send Find_User_Rights
35560>>>        Set piFN to lisrv
35561>>>    End_Procedure
35562>>>
35562>>>    Procedure Find_User_Rights
35563>>>        String lsArxeio lsLogin
35564>>>        Integer liUser liArxeio iGroup
35564>>>
35564>>>        Get cpiFileNumber   to liArxeio
35565>>>        Get cpsFileName     to lsArxeio
35566>>>        Get cpsLoginID      to lsLogin
35567>>>
35567>>>        Clear Users
35568>>>        Move lsLogin    to Users.Login_ID
35569>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
35570>>>>
35570>>>        If (Found=1)  Begin
35572>>>            Move Users.User_ID  to liUser
35573>>>            Move Users.Grp_ID   to iGroup
35574>>>        End
35574>>>>
35574>>>        //Else Send Operation_Not_Allowed 9999
35574>>>
35574>>>        Clear Arxeia
35575>>>
35575>>>        Move liArxeio to Arxeia.Arxeio_ID
35576>>>        Find eq Arxeia by Index.1 // Arxeia:Index.1:Arxeia.Arxeio_ID
35577>>>>
35577>>>
35577>>>        If (Found=1) Begin
35579>>>            Move Arxeia.Arxeio_ID to liArxeio
35580>>>
35580>>>            Clear GrpArx
35581>>>            Move liUser     to GrpArx.User_ID
35582>>>            Move liArxeio   to GrpArx.Arxeio_ID
35583>>>            Find eq GrpArx by Index.1 // GrpArx:Index.1:GrpArx.User_ID+GrpArx.Arxeio_ID
35584>>>>
35584>>>            If (Found=1) Begin
35586>>>               If (GrpArx.Allow_Read  ='1') Set cpiCannot_Read   to 0
35589>>>               Else                         Set cpiCannot_Read   to 10003
35591>>>               If (GrpArx.Allow_Create='1') Set cpiCannot_Create to 0
35594>>>               Else                         Set cpiCannot_Create to 10000
35596>>>               If (GrpArx.Allow_Change='1') Set cpiCannot_Edit   to 0
35599>>>               Else                         Set cpiCannot_Edit   to 10001
35601>>>               If (GrpArx.Allow_Delete='1') Set cpiCannot_Delete to 0
35604>>>               Else                         Set cpiCannot_Delete to 10002
35606>>>            End
35606>>>>
35606>>>            Else Begin
35607>>>                Clear GrpArx0
35608>>>                Move iGroup   to GrpArx0.Group_ID
35609>>>                Move liArxeio to GrpArx0.Arxeio_ID
35610>>>                Find eq GrpArx0 by Index.1 // GrpArx0:Index.1:Group_ID+Arxeio_ID
35611>>>>
35611>>>                If (Found=1) Begin
35613>>>                    If (GrpArx0.Allow_Read  ='1')   Set cpiCannot_Read   to 0
35616>>>                    Else                            Set cpiCannot_Read   to 20003
35618>>>                    If (GrpArx0.Allow_Create='1')   Set cpiCannot_Create to 0
35621>>>                    Else                            Set cpiCannot_Create to 20000
35623>>>                    If (GrpArx0.Allow_Change='1')   Set cpiCannot_Edit   to 0
35626>>>                    Else                            Set cpiCannot_Edit   to 20001
35628>>>                    If (GrpArx0.Allow_Delete='1')   Set cpiCannot_Delete to 0
35631>>>                    Else                            Set cpiCannot_Delete to 20002
35633>>>                End
35633>>>>
35633>>>                Else Begin
35634>>>                    Set cpiCannot_Read   to 0
35635>>>                    Set cpiCannot_Edit   to 0
35636>>>                    Set cpiCannot_Create to 0
35637>>>                    Set cpiCannot_Delete to 0
35638>>>                End
35638>>>>
35638>>>            End
35638>>>>
35638>>>        End
35638>>>>
35638>>>        Else Begin
35639>>>            // €¤ ›œ¤ ™¨œŸœ  «¦ ˜¨®œ ¦ «¦«œ Ÿœà¨¦¬£œ ¦«  ¦ ®¨ž©«žª œ®œ  §¨¦©™˜©ž ©'˜¬«¦
35639>>>            Set cpiCannot_Read   to 0
35640>>>            Set cpiCannot_Edit   to 0
35641>>>            Set cpiCannot_Create to 0
35642>>>            Set cpiCannot_Delete to 0
35643>>>        End
35643>>>>
35643>>>    End_Procedure
35644>>>
35644>>>    Procedure Clear_main_file
35645>>>        Forward Send Clear_main_file
35647>>>        Set cpiBackout to 0
35648>>>        Set cpiUpdate  to 0
35649>>>    End_Procedure
35650>>>
35650>>>    Procedure Update
35651>>>        Forward Send Update
35653>>>        Set cpiUpdate to 1
35654>>>    End_Procedure
35655>>>
35655>>>    Procedure Backout
35656>>>        Forward Send Backout
35658>>>        Set cpiBackout to 1
35659>>>    End_Procedure
35660>>>
35660>>>    Procedure OnConstrain
35661>>>        Integer rVal liSrv
35662>>>        Forward Send OnConstrain
35664>>>        Get cpiFileNumber  To liSrv
35665>>>        Move liSrv         To Filenumber
35666>>>        Get cpiCannot_Read to rVal
35667>>>        If (rVal) Constrain Indirect_File.Recnum eq 0
35671>>>    End_Procedure
35672>>>
35672>>>    Procedure Operation_Not_Allowed  Integer iError_Num
35673>>>        String sLektiko
35674>>>        Move '' to sLektiko
35675>>>
35675>>>             If iError_Num eq 10000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
35678>>>        Else If iError_Num eq 10001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Users permissions. Check with your Administrator"    to sLektiko
35682>>>        Else If iError_Num eq 10002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
35686>>>        Else If iError_Num eq 10003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
35690>>>        Else If iError_Num eq 20000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
35694>>>        Else If iError_Num eq 20001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Group permissions. Check with your Administrator"    to sLektiko
35698>>>        Else If iError_Num eq 20002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
35702>>>        Else If iError_Num eq 20003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
35706>>>        Else If iError_Num eq  9999 Move "Unknown User in Users File"                                                                                    to sLektiko
35710>>>        Else If iError_Num eq 20101 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Change its Data"                 to sLektiko
35714>>>        Else If iError_Num eq 20102 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Delete It"                       to sLektiko
35718>>>        Append sLektiko '\nFile = ' (String(cpiFileNumber(Self))) ' - ' (CpsFileName(Self))
35722>>>
35722>>>             If iError_Num eq 10000 Error 10000 sLektiko
35725>>>        Else If iError_Num eq 10001 Error 10001 sLektiko
35729>>>        Else If iError_Num eq 10002 Error 10002 sLektiko
35733>>>        Else If iError_Num eq 10003 Error 10003 sLektiko
35737>>>        Else If iError_Num eq 20000 Error 20000 sLektiko
35741>>>        Else If iError_Num eq 20001 Error 20001 sLektiko
35745>>>        Else If iError_Num eq 20002 Error 20002 sLektiko
35749>>>        Else If iError_Num eq 20003 Error 20003 sLektiko
35753>>>        Else If iError_Num eq  9999 Error  9999 sLektiko
35757>>>        Else If iError_Num eq 20101 Error 20101 sLektiko
35761>>>        Else If iError_Num eq 20102 Error 20102 sLektiko
35765>>>
35765>>>        Else Forward Send Operation_Not_Allowed  iError_Num
35768>>>    End_Procedure   // Operation_Not_Allowed
35769>>>
35769>>>
35769>>>End_Class //Datadictionary_Sec
35770>        
35770>        use dg186.dg
INCLUDING FILE: DG186.DG
35770>>>//AB/ Project dg186
35770>>>//AB/     Object prj is a Dialog_Project
35770>>>//AB/         Set ProjectName to "dg186"
35770>>>//AB/         Set ProjectFileName to "dg186.DG"
35770>>>//AB/         Set GenerateFileName to "NONAME"
35770>>>
35770>>>// Project Object Structure
35770>>>//   dg186 is a dbModalPanelSub
35770>>>//     Witemkat_DD is a DataDictionary
35770>>>//     Units_DD is a DataDictionary
35770>>>//     Fpa_DD is a DataDictionary
35770>>>//     Item_DD is a DataDictionary
35770>>>//     Witemcl_DD is a DataDictionary
35770>>>//     The_Table is a dbGrid
35770>>>//     TextBoxSub1 is a TextBoxSub
35770>>>//     TextBoxSub2 is a TextBoxSub
35770>>>//     TextBoxSub3 is a TextBoxSub
35770>>>//     ocode is a FormSub
35770>>>//     operi is a FormSub
35770>>>//     ocodeprom is a FormSub
35770>>>//     RadioGroupSub1 is a RadioGroupSub
35770>>>//       Radio1 is a RadioSub
35770>>>//       Radio2 is a RadioSub
35770>>>//     ButtonSub1 is a ButtonSub
35770>>>//     btnwitemcl is a ButtonSub
35770>>>
35770>>>// Register all objects
35770>>>Register_Object ButtonSub1
35770>>>Register_Object btnwitemcl
35770>>>Register_Object dg186
35770>>>Register_Object Fpa_DD
35770>>>Register_Object Item_DD
35770>>>Register_Object ocode
35770>>>Register_Object ocodeprom
35770>>>Register_Object operi
35770>>>Register_Object Radio1
35770>>>Register_Object Radio2
35770>>>Register_Object RadioGroupSub1
35770>>>Register_Object TextBoxSub1
35770>>>Register_Object TextBoxSub2
35770>>>Register_Object TextBoxSub3
35770>>>Register_Object The_Table
35770>>>Register_Object Units_DD
35770>>>Register_Object Witemcl_DD
35770>>>Register_Object Witemkat_DD
35770>>>
35770>>>
35770>>>
35770>>>    //AB-StoreTopStart
35770>>>    open clients
35772>>>    use sl17.sl
INCLUDING FILE: SL17.SL
35772>>>>>//AB/ Project SL17:witemx
35772>>>>>//AB/     Object prj is a Lookup_Project
35772>>>>>//AB/         Set ProjectName to "SL17:witemx"
35772>>>>>//AB/         Set ProjectFileName to "sl17.SL"
35772>>>>>
35772>>>>>// Project Object Structure
35772>>>>>//   SL17 is a dbModalPanelSub
35772>>>>>//     Units_DD is a DataDictionary
35772>>>>>//     Witemkat_DD is a DataDictionary
35772>>>>>//     Fpa_DD is a DataDictionary
35772>>>>>//     Item_DD is a DataDictionary
35772>>>>>//     Witemx_DD is a DataDictionary
35772>>>>>//     oSelList is a dbListSub
35772>>>>>//     TextBoxSub1 is a TextBoxSub
35772>>>>>//     ocode is a FormSub
35772>>>>>//     TextBoxSub2 is a TextBoxSub
35772>>>>>//     operi is a FormSub
35772>>>>>//     RadioGroupSub1 is a RadioGroupSub
35772>>>>>//       Radio1 is a RadioSub
35772>>>>>//       Radio2 is a RadioSub
35772>>>>>//     ButtonSub1 is a ButtonSub
35772>>>>>//     TextBoxSub3 is a TextBoxSub
35772>>>>>//     ocodekat is a FormSub
35772>>>>>//     oOK_bn is a ButtonSub
35772>>>>>//     oCancel_bn is a ButtonSub
35772>>>>>//     oSearch_bn is a ButtonSub
35772>>>>>//     btnwitemcl is a ButtonSub
35772>>>>>
35772>>>>>// Register all objects
35772>>>>>Register_Object ButtonSub1
35772>>>>>Register_Object btnwitemcl
35772>>>>>Register_Object Fpa_DD
35772>>>>>Register_Object Item_DD
35772>>>>>Register_Object oCancel_bn
35772>>>>>Register_Object ocode
35772>>>>>Register_Object ocodekat
35772>>>>>Register_Object oOK_bn
35772>>>>>Register_Object operi
35772>>>>>Register_Object oSearch_bn
35772>>>>>Register_Object oSelList
35772>>>>>Register_Object Radio1
35772>>>>>Register_Object Radio2
35772>>>>>Register_Object RadioGroupSub1
35772>>>>>Register_Object SL17
35772>>>>>Register_Object TextBoxSub1
35772>>>>>Register_Object TextBoxSub2
35772>>>>>Register_Object TextBoxSub3
35772>>>>>Register_Object Units_DD
35772>>>>>Register_Object Witemkat_DD
35772>>>>>Register_Object Witemx_DD
35772>>>>>
35772>>>>>
35772>>>>>
35772>>>>>    //AB-StoreTopStart
35772>>>>>    use dg186.dg
35772>>>>>    //AB-StoreTopEnd
35772>>>>>
35772>>>>>    //AB-IgnoreStart
35772>>>>>
35772>>>>>    Use DFAllEnt.pkg
35772>>>>>    Use dbList.Sub
35772>>>>>    Use Txtbox.Sub
35772>>>>>    Use Form.Sub
35772>>>>>    Use Rgroup.Sub
35772>>>>>    Use Radio.Sub
35772>>>>>    Use Button.Sub
35772>>>>>
35772>>>>>
35772>>>>>    Use UNITS.DD
INCLUDING FILE: UNITS.DD
35772>>>>>>>//DDB-FileStart
35772>>>>>>>//DDB-HeaderStart
35772>>>>>>>
35772>>>>>>>// File Name : UNITS.DD
35772>>>>>>>// Class Name: Units_DataDictionary
35772>>>>>>>// Revision  : 17
35772>>>>>>>// Version   : 2
35772>>>>>>>
35772>>>>>>>Use  Windows           // Basic Definitions
35772>>>>>>>Use  DataDict          // DataDictionary Class Definition
35772>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
35772>>>>>>>
35772>>>>>>>Open Units
INCLUDING FILE: UNITS.FD
35774>>>>>>>Open Item
INCLUDING FILE: ITEM.FD
35776>>>>>>>Open Sysrecw
INCLUDING FILE: SYSRECW.FD
35778>>>>>>>Open Syscurxr
35780>>>>>>>
35780>>>>>>>//DDB-HeaderEnd
35780>>>>>>>//DDB-SelectionStart
35780>>>>>>>//DDB/ ExternalSelectionList sl025  sl025.SL
35780>>>>>>>Register_Object sl025
35780>>>>>>>//DDB-SelectionEnd
35780>>>>>>>
35780>>>>>>>Class Units_DataDictionary  is a DataDictionary
35781>>>>>>>
35781>>>>>>>    Procedure Save_Main_File
35782>>>>>>>        If (Operation_Origin<>Self) Begin
35784>>>>>>>            If Units.Recnum Eq 0 Procedure_Return
35787>>>>>>>        End
35787>>>>>>>>
35787>>>>>>>        Forward Send Save_Main_File
35789>>>>>>>    End_Procedure
35790>>>>>>>
35790>>>>>>>
35790>>>>>>>     Procedure Creating
35791>>>>>>>        Forward Send Creating
35793>>>>>>>        // Insert Code Here
35793>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Units.Units_Rec0)))))) to Units.Units_Recr
35794>>>>>>>    End_Procedure   // Creating
35795>>>>>>>
35795>>>>>>>
35795>>>>>>>
35795>>>>>>>    // Define_Fields:
35795>>>>>>>    // This procedure is used to set up all data-dictionary rules.
35795>>>>>>>
35795>>>>>>>    Procedure Define_Fields
35796>>>>>>>        Forward Send Define_Fields
35798>>>>>>>        //DDB-Generated-Code-Location
35798>>>>>>>        //DDB-DefineFieldStart
35798>>>>>>>
35798>>>>>>>        Set Main_File            To Units.File_Number
35799>>>>>>>        Set Cascade_Delete_State To FALSE
35800>>>>>>>
35800>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
35801>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
35802>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
35803>>>>>>>
35803>>>>>>>        // Child (Client) file structure................
35803>>>>>>>        Send Add_Client_File  Item.File_Number
35804>>>>>>>
35804>>>>>>>        // External (System) file structure.............
35804>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
35805>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
35806>>>>>>>
35806>>>>>>>        Define_Auto_Increment  Sysrecw.Units_Rec0  To Units.Units_Rec0
35809>>>>>>>
35809>>>>>>>        // Field-based properties.......................
35809>>>>>>>
35809>>>>>>>        // Units.Units_Code
35809>>>>>>>        Set Field_Options          Field Units.Units_Code To DD_AUTOFIND   
35810>>>>>>>        Set Field_Prompt_Object    Field Units.Units_Code To (sl025(Self))
35811>>>>>>>
35811>>>>>>>        // Units.Units_Rec0
35811>>>>>>>        Set Field_Options          Field Units.Units_Rec0 To DD_AUTOFIND   
35812>>>>>>>
35812>>>>>>>        // Units.Units_Descr
35812>>>>>>>        Set Field_Prompt_Object    Field Units.Units_Descr To (sl025(Self))
35813>>>>>>>
35813>>>>>>>        // Units.Units_Recr
35813>>>>>>>        Set Field_Options          Field Units.Units_Recr To DD_AUTOFIND   
35814>>>>>>>
35814>>>>>>>        //DDB-DefineFieldEnd
35814>>>>>>>    End_Procedure    // Define_Fields
35815>>>>>>>
35815>>>>>>>    // Field_Defaults:
35815>>>>>>>    // This procedure is used to establish default field values.
35815>>>>>>>
35815>>>>>>>    Procedure Field_Defaults
35816>>>>>>>        Forward Send Field_Defaults
35818>>>>>>>        //DDB-Generated-Code-Location
35818>>>>>>>        //DDB-FieldDefaultStart
35818>>>>>>>        //DDB-FieldDefaultEnd
35818>>>>>>>    End_Procedure    // Field_Defaults
35819>>>>>>>
35819>>>>>>>End_Class    // Units_DataDictionary
35820>>>>>>>//DDB-Selection-pkg-Start
35820>>>>>>>
35820>>>>>>>Use sl025.SL         // sl025
INCLUDING FILE: SL025.SL
35820>>>>>>>>>//AB/ Project sl025
35820>>>>>>>>>//AB/ Object prj is a Lookup_Project
35820>>>>>>>>>//AB/     Set ProjectName to "sl025"
35820>>>>>>>>>//AB/     Set ProjectFileName to "sl025.SL"
35820>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
35820>>>>>>>>>
35820>>>>>>>>>// Project Object Structure
35820>>>>>>>>>//   sl025 is a dbModalPanelSub
35820>>>>>>>>>//     Units_DD is a DataDictionary
35820>>>>>>>>>//     oSelList is a dbListSub
35820>>>>>>>>>//     oOK_bn is a ButtonSub
35820>>>>>>>>>//     oCancel_bn is a ButtonSub
35820>>>>>>>>>//     oSearch_bn is a ButtonSub
35820>>>>>>>>>
35820>>>>>>>>>// Register all objects
35820>>>>>>>>>Register_Object oCancel_bn
35820>>>>>>>>>Register_Object oOK_bn
35820>>>>>>>>>Register_Object oSearch_bn
35820>>>>>>>>>Register_Object oSelList
35820>>>>>>>>>Register_Object sl025
35820>>>>>>>>>Register_Object Units_DD
35820>>>>>>>>>
35820>>>>>>>>>
35820>>>>>>>>>//AB-IgnoreStart
35820>>>>>>>>>
35820>>>>>>>>>Use DFAllEnt.pkg
35820>>>>>>>>>Use dbList.Sub
35820>>>>>>>>>Use Button.Sub
35820>>>>>>>>>
35820>>>>>>>>>
35820>>>>>>>>>Use UNITS.DD
35820>>>>>>>>>
35820>>>>>>>>>//AB-IgnoreEnd
35820>>>>>>>>>
35820>>>>>>>>>Object sl025 is a dbModalPanelSub
35822>>>>>>>>>    set label to "‹¦¤á›œª ‹â«¨ž©žª" 
35823>>>>>>>>>    Set Size to 148 297
35824>>>>>>>>>    Set Location to 4 5
35825>>>>>>>>>    Set Exit_Application_Local_State to FALSE
35826>>>>>>>>>    Set Modal_State to FALSE
35827>>>>>>>>>
35827>>>>>>>>>    //AB-DDOStart
35827>>>>>>>>>
35827>>>>>>>>>    Object Units_DD is a Units_DataDictionary
35829>>>>>>>>>    End_Object    // Units_DD
35830>>>>>>>>>
35830>>>>>>>>>    Set Main_DD to (Units_DD(self))
35831>>>>>>>>>    Set Server to (Units_DD(self))
35832>>>>>>>>>
35832>>>>>>>>>    //AB-DDOEnd
35832>>>>>>>>>
35832>>>>>>>>>    Object oSelList is a dbListSub
35834>>>>>>>>>        set main_file to units.file_number 
35835>>>>>>>>>        Set Size to 105 280
35836>>>>>>>>>        Set Location to 6 6
35837>>>>>>>>>
35837>>>>>>>>>        Begin_Row
35840>>>>>>>>>            entry_item units.units_code 
35841>>>>>>>>>            entry_item units.units_descr 
35842>>>>>>>>>        End_Row
35847>>>>>>>>>
35847>>>>>>>>>        Set Form_Width    item 0 to 91
35848>>>>>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
35849>>>>>>>>>        
35849>>>>>>>>>        Set Form_Width    item 1 to 180
35850>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
35851>>>>>>>>>        
35851>>>>>>>>>    End_Object    // oSelList
35852>>>>>>>>>
35852>>>>>>>>>    Object oOK_bn is a ButtonSub
35854>>>>>>>>>        set label to "&„§ ¢¦šã" 
35855>>>>>>>>>        Set Location to 115 126
35856>>>>>>>>>
35856>>>>>>>>>        //AB-StoreStart
35856>>>>>>>>>        Procedure OnClick
35858>>>>>>>>>            Send OK To (oSelList(current_object))
35859>>>>>>>>>        End_Procedure
35860>>>>>>>>>        //AB-StoreEnd
35860>>>>>>>>>
35860>>>>>>>>>    End_Object    // oOK_bn
35861>>>>>>>>>
35861>>>>>>>>>    Object oCancel_bn is a ButtonSub
35863>>>>>>>>>        set label to "&€¡ç¨à©ž" 
35864>>>>>>>>>        Set Location to 115 181
35865>>>>>>>>>
35865>>>>>>>>>        //AB-StoreStart
35865>>>>>>>>>        Procedure OnClick
35867>>>>>>>>>            Send Cancel To (oSelList(current_object))
35868>>>>>>>>>        End_Procedure
35869>>>>>>>>>        //AB-StoreEnd
35869>>>>>>>>>
35869>>>>>>>>>    End_Object    // oCancel_bn
35870>>>>>>>>>
35870>>>>>>>>>    Object oSearch_bn is a ButtonSub
35872>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
35873>>>>>>>>>        Set Location to 115 236
35874>>>>>>>>>
35874>>>>>>>>>        //AB-StoreStart
35874>>>>>>>>>        Procedure OnClick
35876>>>>>>>>>            Send Search To (oSelList(current_object))
35877>>>>>>>>>        End_Procedure
35878>>>>>>>>>        //AB-StoreEnd
35878>>>>>>>>>
35878>>>>>>>>>    End_Object    // oSearch_bn
35879>>>>>>>>>
35879>>>>>>>>>
35879>>>>>>>>>    //AB-StoreStart
35879>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
35880>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
35881>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
35882>>>>>>>>>    //AB-StoreEnd
35882>>>>>>>>>
35882>>>>>>>>>End_Object    // sl025
35883>>>>>>>>>
35883>>>>>>>>>//AB/ End_Object    // prj
35883>>>>>>>
35883>>>>>>>//DDB-Selection-pkg-End
35883>>>>>>>//DDB-FileEnd
35883>>>>>    Use WITEMKAT.DD
INCLUDING FILE: WITEMKAT.DD
35883>>>>>>>//DDB-FileStart
35883>>>>>>>//DDB-HeaderStart
35883>>>>>>>
35883>>>>>>>// File Name : WITEMKAT.DD
35883>>>>>>>// Class Name: Witemkat_DataDictionary
35883>>>>>>>// Revision  : 25
35883>>>>>>>// Version   : 2
35883>>>>>>>
35883>>>>>>>Use  Windows           // Basic Definitions
35883>>>>>>>Use  DataDict          // DataDictionary Class Definition
35883>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
35883>>>>>>>
35883>>>>>>>Open Witemkat
INCLUDING FILE: WITEMKAT.FD
35885>>>>>>>Open Item
35887>>>>>>>Open Sysrecw
35889>>>>>>>Open Syscurxr
35891>>>>>>>
35891>>>>>>>//DDB-HeaderEnd
35891>>>>>>>//DDB-SelectionStart
35891>>>>>>>//DDB/ ExternalSelectionList sl024  sl024.SL
35891>>>>>>>//DDB/ ExternalSelectionList sl150  sl150.SL
35891>>>>>>>Register_Object sl024
35891>>>>>>>Register_Object sl150
35891>>>>>>>//DDB-SelectionEnd
35891>>>>>>>
35891>>>>>>>Class Witemkat_DataDictionary  is a DataDictionary
35892>>>>>>>
35892>>>>>>>     Procedure Creating
35893>>>>>>>        Forward Send Creating
35895>>>>>>>        // Insert Code Here
35895>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(WitemKat.WitemKat_Rec0)))))) to WitemKat.WitemKat_Recr
35896>>>>>>>    End_Procedure   // Creating
35897>>>>>>>   
35897>>>>>>>    Function Validate_Save  Returns Integer
35898>>>>>>>        Local Integer iReturnVal icheck
35899>>>>>>>        Forward Get Validate_Save  To iReturnVal
35901>>>>>>>        If (Not(iReturnVal)) Begin
35903>>>>>>>            // Insert Code Here
35903>>>>>>>//           if (witemkat.codegl <> '') begin
35903>>>>>>>//              Move (Check_log(witemkat.codegl)) to iCheck  
35903>>>>>>>//              if (icheck) Move 24001 to iReturnVal 
35903>>>>>>>//           end
35903>>>>>>>           If (iReturnVal) Send Operation_Not_Allowed iReturnVal
35906>>>>>>>        End
35906>>>>>>>>
35906>>>>>>>        Function_Return iReturnVal
35907>>>>>>>    End_Function   // Validate_Save
35908>>>>>>> 
35908>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
35909>>>>>>>        String lsError_Message
35910>>>>>>>        Case Begin
35910>>>>>>>            Case (iError_Num = 24001)
35912>>>>>>>                Move "DDC 24: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ¡˜«žš¦¨å˜ª œå›¦¬ª" to lsError_Message
35913>>>>>>>              Case Break
35914>>>>>>>            Case Else
35914>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
35916>>>>>>>        Case End
35916>>>>>>>        Error iError_Num lsError_Message
35917>>>>>>>>
35917>>>>>>>    End_Procedure // operation_not_allowed
35918>>>>>>>
35918>>>>>>>
35918>>>>>>>
35918>>>>>>>    // Define_Fields:
35918>>>>>>>    // This procedure is used to set up all data-dictionary rules.
35918>>>>>>>
35918>>>>>>>    Procedure Define_Fields
35919>>>>>>>        Forward Send Define_Fields
35921>>>>>>>        //DDB-Generated-Code-Location
35921>>>>>>>        //DDB-DefineFieldStart
35921>>>>>>>
35921>>>>>>>        Set Main_File            To Witemkat.File_Number
35922>>>>>>>        Set Cascade_Delete_State To FALSE
35923>>>>>>>
35923>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
35924>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
35925>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
35926>>>>>>>
35926>>>>>>>        // Child (Client) file structure................
35926>>>>>>>        Send Add_Client_File  Item.File_Number
35927>>>>>>>
35927>>>>>>>        // External (System) file structure.............
35927>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
35928>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
35929>>>>>>>
35929>>>>>>>        Define_Auto_Increment  Sysrecw.Witemkat_Rec0  To Witemkat.Witemkat_Rec0
35932>>>>>>>
35932>>>>>>>        // Field-based properties.......................
35932>>>>>>>
35932>>>>>>>        // Witemkat.Witemkat_Code
35932>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Code To DD_AUTOFIND   
35933>>>>>>>        Set Field_Prompt_Object    Field Witemkat.Witemkat_Code To (sl024(Self))
35934>>>>>>>
35934>>>>>>>        // Witemkat.Witemkat_Rec0
35934>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Rec0 To DD_AUTOFIND   
35935>>>>>>>
35935>>>>>>>        // Witemkat.Witemkat_Descr
35935>>>>>>>        Set Field_Prompt_Object    Field Witemkat.Witemkat_Descr To (sl024(Self))
35936>>>>>>>
35936>>>>>>>        // Witemkat.Witemkat_Recr
35936>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Recr To DD_AUTOFIND   
35937>>>>>>>
35937>>>>>>>        // Witemkat.Codeglpol
35937>>>>>>>        Set Field_Prompt_Object    Field Witemkat.Codeglpol To (sl150(Self))
35938>>>>>>>
35938>>>>>>>        // Witemkat.Codeglago
35938>>>>>>>
35938>>>>>>>        //DDB-DefineFieldEnd
35938>>>>>>>    End_Procedure    // Define_Fields
35939>>>>>>>
35939>>>>>>>    // Field_Defaults:
35939>>>>>>>    // This procedure is used to establish default field values.
35939>>>>>>>
35939>>>>>>>    Procedure Field_Defaults
35940>>>>>>>        Forward Send Field_Defaults
35942>>>>>>>        //DDB-Generated-Code-Location
35942>>>>>>>        //DDB-FieldDefaultStart
35942>>>>>>>        //DDB-FieldDefaultEnd
35942>>>>>>>    End_Procedure    // Field_Defaults
35943>>>>>>>
35943>>>>>>>End_Class    // Witemkat_DataDictionary
35944>>>>>>>//DDB-Selection-pkg-Start
35944>>>>>>>
35944>>>>>>>Use sl024.SL         // sl024
INCLUDING FILE: SL024.SL
35944>>>>>>>>>//AB/ Project sl024:kathgories eidon
35944>>>>>>>>>//AB/ Object prj is a Lookup_Project
35944>>>>>>>>>//AB/     Set ProjectName to "sl024:kathgories eidon"
35944>>>>>>>>>//AB/     Set ProjectFileName to "sl024.SL"
35944>>>>>>>>>
35944>>>>>>>>>// Project Object Structure
35944>>>>>>>>>//   sl024 is a dbModalPanelSub
35944>>>>>>>>>//     Witemkat_DD is a DataDictionary
35944>>>>>>>>>//     oSelList is a dbListSub
35944>>>>>>>>>//     oOK_bn is a ButtonSub
35944>>>>>>>>>//     oCancel_bn is a ButtonSub
35944>>>>>>>>>//     oSearch_bn is a ButtonSub
35944>>>>>>>>>
35944>>>>>>>>>// Register all objects
35944>>>>>>>>>Register_Object oCancel_bn
35944>>>>>>>>>Register_Object oOK_bn
35944>>>>>>>>>Register_Object oSearch_bn
35944>>>>>>>>>Register_Object oSelList
35944>>>>>>>>>Register_Object sl024
35944>>>>>>>>>Register_Object Witemkat_DD
35944>>>>>>>>>
35944>>>>>>>>>
35944>>>>>>>>>//AB-IgnoreStart
35944>>>>>>>>>
35944>>>>>>>>>Use DFAllEnt.pkg
35944>>>>>>>>>Use dbList.Sub
35944>>>>>>>>>Use Button.Sub
35944>>>>>>>>>
35944>>>>>>>>>
35944>>>>>>>>>Use WITEMKAT.DD
35944>>>>>>>>>
35944>>>>>>>>>//AB-IgnoreEnd
35944>>>>>>>>>
35944>>>>>>>>>Object sl024 is a dbModalPanelSub
35946>>>>>>>>>    Set Label to "‰˜«žš¦¨åœª „ ›é¤"
35947>>>>>>>>>    Set Size to 217 375
35948>>>>>>>>>    Set Location to 4 5
35949>>>>>>>>>    Set Exit_Application_Local_State to FALSE
35950>>>>>>>>>    Set Modal_State to FALSE
35951>>>>>>>>>
35951>>>>>>>>>    //AB-DDOStart
35951>>>>>>>>>
35951>>>>>>>>>    Object Witemkat_DD is a Witemkat_DataDictionary
35953>>>>>>>>>    End_Object    // Witemkat_DD
35954>>>>>>>>>
35954>>>>>>>>>    Set Main_DD to (Witemkat_DD(self))
35955>>>>>>>>>    Set Server to (Witemkat_DD(self))
35956>>>>>>>>>
35956>>>>>>>>>    //AB-DDOEnd
35956>>>>>>>>>
35956>>>>>>>>>    Object oSelList is a dbListSub
35958>>>>>>>>>        Set Main_File to Witemkat.File_Number
35959>>>>>>>>>        Set Size to 175 357
35960>>>>>>>>>        Set Location to 6 6
35961>>>>>>>>>
35961>>>>>>>>>        Begin_Row
35964>>>>>>>>>            Entry_Item Witemkat.Witemkat_code
35965>>>>>>>>>            Entry_Item Witemkat.Witemkat_descr
35966>>>>>>>>>        End_Row
35971>>>>>>>>>
35971>>>>>>>>>        Set Form_Width    item 0 to 124
35972>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
35973>>>>>>>>>        
35973>>>>>>>>>        Set Form_Width    item 1 to 223
35974>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
35975>>>>>>>>>        
35975>>>>>>>>>    End_Object    // oSelList
35976>>>>>>>>>
35976>>>>>>>>>    Object oOK_bn is a ButtonSub
35978>>>>>>>>>        Set Label to "&„§ ¢¦šã"
35979>>>>>>>>>        Set Location to 186 210
35980>>>>>>>>>
35980>>>>>>>>>        //AB-StoreStart
35980>>>>>>>>>        Procedure OnClick
35982>>>>>>>>>            Send OK To (oSelList(current_object))
35983>>>>>>>>>        End_Procedure
35984>>>>>>>>>        //AB-StoreEnd
35984>>>>>>>>>
35984>>>>>>>>>    End_Object    // oOK_bn
35985>>>>>>>>>
35985>>>>>>>>>    Object oCancel_bn is a ButtonSub
35987>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
35988>>>>>>>>>        Set Location to 186 265
35989>>>>>>>>>
35989>>>>>>>>>        //AB-StoreStart
35989>>>>>>>>>        Procedure OnClick
35991>>>>>>>>>            Send Cancel To (oSelList(current_object))
35992>>>>>>>>>        End_Procedure
35993>>>>>>>>>        //AB-StoreEnd
35993>>>>>>>>>
35993>>>>>>>>>    End_Object    // oCancel_bn
35994>>>>>>>>>
35994>>>>>>>>>    Object oSearch_bn is a ButtonSub
35996>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
35997>>>>>>>>>        Set Location to 186 320
35998>>>>>>>>>
35998>>>>>>>>>        //AB-StoreStart
35998>>>>>>>>>        Procedure OnClick
36000>>>>>>>>>            Send Search To (oSelList(current_object))
36001>>>>>>>>>        End_Procedure
36002>>>>>>>>>        //AB-StoreEnd
36002>>>>>>>>>
36002>>>>>>>>>    End_Object    // oSearch_bn
36003>>>>>>>>>
36003>>>>>>>>>
36003>>>>>>>>>    //AB-StoreStart
36003>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
36004>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
36005>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
36006>>>>>>>>>    //AB-StoreEnd
36006>>>>>>>>>
36006>>>>>>>>>End_Object    // sl024
36007>>>>>>>>>
36007>>>>>>>>>//AB/ End_Object    // prj
36007>>>>>>>Use sl150.SL         // sl150
INCLUDING FILE: SL150.SL
36007>>>>>>>>>//AB/ Project sl150:GL Gplan
36007>>>>>>>>>//AB/ Object prj is a Lookup_Project
36007>>>>>>>>>//AB/     Set ProjectName to "sl150:GL Gplan"
36007>>>>>>>>>//AB/     Set ProjectFileName to "sl150.SL"
36007>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
36007>>>>>>>>>
36007>>>>>>>>>// Project Object Structure
36007>>>>>>>>>//   sl150 is a dbModalPanel
36007>>>>>>>>>//     Gplan_DD is a DataDictionary
36007>>>>>>>>>//     oSelList is a dbList
36007>>>>>>>>>//     oOK_bn is a Button
36007>>>>>>>>>//     oCancel_bn is a Button
36007>>>>>>>>>//     oSearch_bn is a Button
36007>>>>>>>>>
36007>>>>>>>>>// Register all objects
36007>>>>>>>>>Register_Object Gplan_DD
36007>>>>>>>>>Register_Object oCancel_bn
36007>>>>>>>>>Register_Object oOK_bn
36007>>>>>>>>>Register_Object oSearch_bn
36007>>>>>>>>>Register_Object oSelList
36007>>>>>>>>>Register_Object sl150
36007>>>>>>>>>
36007>>>>>>>>>
36007>>>>>>>>>//AB-IgnoreStart
36007>>>>>>>>>
36007>>>>>>>>>Use DFAllEnt.pkg
36007>>>>>>>>>
36007>>>>>>>>>
36007>>>>>>>>>Use GPLAN.DD
INCLUDING FILE: GPLAN.DD
36007>>>>>>>>>>>//DDB-FileStart
36007>>>>>>>>>>>//DDB-HeaderStart
36007>>>>>>>>>>>
36007>>>>>>>>>>>// File Name : GPLAN.DD
36007>>>>>>>>>>>// Class Name: Gplan_DataDictionary
36007>>>>>>>>>>>// Revision  : 125
36007>>>>>>>>>>>// Version   : 2
36007>>>>>>>>>>>
36007>>>>>>>>>>>Use  Windows           // Basic Definitions
36007>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
36007>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
36007>>>>>>>>>>>
36007>>>>>>>>>>>Open Gplan
36009>>>>>>>>>>>Open Gmovea
INCLUDING FILE: GMOVEA.FD
36011>>>>>>>>>>>Open Gplanmod
INCLUDING FILE: GPLANMOD.FD
36013>>>>>>>>>>>Open Gmhnes
INCLUDING FILE: GMHNES.FD
36015>>>>>>>>>>>Open Gmove
INCLUDING FILE: GMOVE.FD
36017>>>>>>>>>>>Open Gvatd
INCLUDING FILE: GVATD.FD
36019>>>>>>>>>>>Open Gpmoves
INCLUDING FILE: GPMOVES.FD
36021>>>>>>>>>>>Open Sysrecg
36023>>>>>>>>>>>Open Syscurgl
36025>>>>>>>>>>>
36025>>>>>>>>>>>//DDB-HeaderEnd
36025>>>>>>>>>>>//DDB-ValidationStart
36025>>>>>>>>>>>
36025>>>>>>>>>>>Register_Object Gplan_Gplan_O_Code_VT
36025>>>>>>>>>>>Register_Object Gplan_Gplan_Yn_VT
36025>>>>>>>>>>>Register_Object Gplan_Gplan_Xpm_VT
36025>>>>>>>>>>>Register_Object Gplan_Gplan_Doy_VT
36025>>>>>>>>>>>Register_Object Gplan_Gplan_J_Code_VT
36025>>>>>>>>>>>Register_Object Gplan_Gplan_C_Code2_VT
36025>>>>>>>>>>>Register_Object Gplan_Gplan_I_A_Code_VT2
36025>>>>>>>>>>>Register_Object Gplan_Gplan_Myf_Sum_VT
36025>>>>>>>>>>>
36025>>>>>>>>>>>Object Gplan_Gplan_O_Code_VT  is a CodeValidationTable
36027>>>>>>>>>>>    Set Type_Value        To "OMADA"
36028>>>>>>>>>>>    Set Allow_Blank_State To TRUE
36029>>>>>>>>>>>    //DDB-ValidationCustomStart
36029>>>>>>>>>>>    //DDB-ValidationCustomEnd
36029>>>>>>>>>>>End_Object   // Gplan_Gplan_O_Code_VT
36030>>>>>>>>>>>
36030>>>>>>>>>>>Object Gplan_Gplan_Yn_VT  is a CodeValidationTable
36032>>>>>>>>>>>    Set Type_Value        To "YESNO"
36033>>>>>>>>>>>    //DDB-ValidationCustomStart
36033>>>>>>>>>>>    //DDB-ValidationCustomEnd
36033>>>>>>>>>>>End_Object   // Gplan_Gplan_Yn_VT
36034>>>>>>>>>>>
36034>>>>>>>>>>>Object Gplan_Gplan_Xpm_VT  is a DescriptionValidationTable
36036>>>>>>>>>>>
36036>>>>>>>>>>>    Procedure Fill_List
36038>>>>>>>>>>>        Forward Send Fill_List
36040>>>>>>>>>>>        Send Add_Table_Value  "1"  "•¨œ¦ç£œ¤¦ª"
36041>>>>>>>>>>>        Send Add_Table_Value  "2"  " ©«¦ç£œ¤¦ª"
36042>>>>>>>>>>>        Send Add_Table_Value  "3"  "‹ ¡«æª"
36043>>>>>>>>>>>    End_Procedure    // Fill_List
36044>>>>>>>>>>>    //DDB-ValidationCustomStart
36044>>>>>>>>>>>    //DDB-ValidationCustomEnd
36044>>>>>>>>>>>End_Object   // Gplan_Gplan_Xpm_VT
36045>>>>>>>>>>>
36045>>>>>>>>>>>Object Gplan_Gplan_Doy_VT  is a CodeValidationTable
36047>>>>>>>>>>>    Set Type_Value        To "DOY"
36048>>>>>>>>>>>    Set Allow_Blank_State To TRUE
36049>>>>>>>>>>>    //DDB-ValidationCustomStart
36049>>>>>>>>>>>    //DDB-ValidationCustomEnd
36049>>>>>>>>>>>End_Object   // Gplan_Gplan_Doy_VT
36050>>>>>>>>>>>
36050>>>>>>>>>>>Object Gplan_Gplan_J_Code_VT  is a CodeValidationTable
36052>>>>>>>>>>>    Set Type_Value        To "JOB"
36053>>>>>>>>>>>    Set Allow_Blank_State To TRUE
36054>>>>>>>>>>>    //DDB-ValidationCustomStart
36054>>>>>>>>>>>    //DDB-ValidationCustomEnd
36054>>>>>>>>>>>End_Object   // Gplan_Gplan_J_Code_VT
36055>>>>>>>>>>>
36055>>>>>>>>>>>Object Gplan_Gplan_C_Code2_VT  is a CodeValidationTable
36057>>>>>>>>>>>    Set Type_Value        To "CURRENCY"
36058>>>>>>>>>>>    Set Allow_Blank_State To TRUE
36059>>>>>>>>>>>    //DDB-ValidationCustomStart
36059>>>>>>>>>>>    //DDB-ValidationCustomEnd
36059>>>>>>>>>>>End_Object   // Gplan_Gplan_C_Code2_VT
36060>>>>>>>>>>>
36060>>>>>>>>>>>Object Gplan_Gplan_I_A_Code_VT2  is a CodeValidationTable
36062>>>>>>>>>>>    Set Type_Value        To "AITIOL"
36063>>>>>>>>>>>    Set Allow_Blank_State To TRUE
36064>>>>>>>>>>>    //DDB-ValidationCustomStart
36064>>>>>>>>>>>    //DDB-ValidationCustomEnd
36064>>>>>>>>>>>End_Object   // Gplan_Gplan_I_A_Code_VT2
36065>>>>>>>>>>>
36065>>>>>>>>>>>Object Gplan_Gplan_Myf_Sum_VT  is a CodeValidationTable
36067>>>>>>>>>>>    Set Type_Value        To "MYF"
36068>>>>>>>>>>>    //DDB-ValidationCustomStart
36068>>>>>>>>>>>    //DDB-ValidationCustomEnd
36068>>>>>>>>>>>End_Object   // Gplan_Gplan_Myf_Sum_VT
36069>>>>>>>>>>>//DDB-ValidationEnd
36069>>>>>>>>>>>//DDB-SelectionStart
36069>>>>>>>>>>>//DDB/ ExternalSelectionList sl150  sl150.sl
36069>>>>>>>>>>>//DDB/ ExternalSelectionList Gtypkin  Gtypkin.sl
36069>>>>>>>>>>>Register_Object sl150
36069>>>>>>>>>>>Register_Object Gtypkin
36069>>>>>>>>>>>//DDB-SelectionEnd
36069>>>>>>>>>>>Use arrays.Sub
36069>>>>>>>>>>>
36069>>>>>>>>>>>Use Gmovea.dd //®¨œ áœ«˜  ¦§à›ã§¦«œ, › æ«  œå¤˜  alias file ¡˜ 
INCLUDING FILE: GMOVEA.DD
36069>>>>>>>>>>>>>//DDB-FileStart
36069>>>>>>>>>>>>>//DDB-HeaderStart
36069>>>>>>>>>>>>>
36069>>>>>>>>>>>>>// File Name : GMOVEA.DD
36069>>>>>>>>>>>>>// Class Name: Gmovea_DataDictionary
36069>>>>>>>>>>>>>// Revision  : 17
36069>>>>>>>>>>>>>// Version   : 2
36069>>>>>>>>>>>>>
36069>>>>>>>>>>>>>Use  Windows           // Basic Definitions
36069>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
36069>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
36069>>>>>>>>>>>>>
36069>>>>>>>>>>>>>Open Gmovea
36071>>>>>>>>>>>>>Open Gopen
INCLUDING FILE: GOPEN.FD
36073>>>>>>>>>>>>>Open Garticl
INCLUDING FILE: GARTICL.FD
36075>>>>>>>>>>>>>Open Gplan
36077>>>>>>>>>>>>>
36077>>>>>>>>>>>>>//DDB-HeaderEnd
36077>>>>>>>>>>>>>
36077>>>>>>>>>>>>>//open master file
36077>>>>>>>>>>>>>Open Gmove
36079>>>>>>>>>>>>>
36079>>>>>>>>>>>>>//define alias-master condition
36079>>>>>>>>>>>>>Set_Attribute DF_FILE_ALIAS of Gmovea.File_Number to DF_FILE_IS_ALIAS
36082>>>>>>>>>>>>>Set_Attribute DF_FILE_ALIAS of Gmove.File_Number  to DF_FILE_IS_MASTER
36085>>>>>>>>>>>>>
36085>>>>>>>>>>>>>//clear all relationships from the alias file
36085>>>>>>>>>>>>>Set_Relate Gmovea.Garticl_Recr to |FN0,0
36086>>>>>>>>>>>>>>
36086>>>>>>>>>>>>>Set_Relate Gmovea.Gplan_Recr   to |FN0,0
36087>>>>>>>>>>>>>>
36087>>>>>>>>>>>>>
36087>>>>>>>>>>>>>
36087>>>>>>>>>>>>>Class Gmovea_DataDictionary  is a DataDictionary_Sec
36088>>>>>>>>>>>>>
36088>>>>>>>>>>>>>
36088>>>>>>>>>>>>>      //private
36088>>>>>>>>>>>>>      //œ¤ž£œ¨é¤œ  «˜ 13 §œ›å˜ open item
36088>>>>>>>>>>>>>      //¡˜¢œå«˜  ˜§æ update
36088>>>>>>>>>>>>>      Procedure private.Do_Compute_Open_Itemsa
36089>>>>>>>>>>>>>                Case Begin
36089>>>>>>>>>>>>>                     Case (Gmovea.Gmove_X0 > 0) //˜«æ­ ¦ ®¨œà©« ¡æ record
36091>>>>>>>>>>>>>                          Move "+"                                                 to Gmovea.Gmove_Topen
36092>>>>>>>>>>>>>                          Move (     Gmovea.Gmove_X0  - Gmovea.Gmove_Open_Sx0) to Gmovea.Gmove_Open_Yx0
36093>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yp0
36094>>>>>>>>>>>>>                     Case Break
36095>>>>>>>>>>>>>
36095>>>>>>>>>>>>>                     Case (Gmovea.Gmove_X0 < 0) //¯œ¬«¦- ®¨œà©« ¡æ record
36098>>>>>>>>>>>>>                          Move "-"                                                 to Gmovea.Gmove_Topen
36099>>>>>>>>>>>>>                          Move ((Abs(Gmovea.Gmove_X0))- Gmovea.Gmove_Open_Sp0) to Gmovea.Gmove_Open_Yp0
36100>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yx0
36101>>>>>>>>>>>>>                     Case Break
36102>>>>>>>>>>>>>
36102>>>>>>>>>>>>>                     Case (Gmovea.Gmove_P0 > 0) //˜«æ­ ¦ § ©«à« ¡æ record
36105>>>>>>>>>>>>>                          Move "-"                                                 to Gmovea.Gmove_Topen
36106>>>>>>>>>>>>>                          Move (     Gmovea.Gmove_P0  - Gmovea.Gmove_Open_Sp0) to Gmovea.Gmove_Open_Yp0
36107>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yx0
36108>>>>>>>>>>>>>                     Case Break
36109>>>>>>>>>>>>>
36109>>>>>>>>>>>>>                     Case (Gmovea.Gmove_P0 < 0) //¯œç«¦- ®¨œà©« ¡æ record
36112>>>>>>>>>>>>>                          Move "+"                                                 to Gmovea.Gmove_Topen
36113>>>>>>>>>>>>>                          Move ((Abs(Gmovea.Gmove_P0))- Gmovea.Gmove_Open_Sx0) to Gmovea.Gmove_Open_Yx0
36114>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yp0
36115>>>>>>>>>>>>>                     Case Break
36116>>>>>>>>>>>>>                Case End
36116>>>>>>>>>>>>>      End_Procedure //private.do_compute_open_itemsa
36117>>>>>>>>>>>>>
36117>>>>>>>>>>>>>
36117>>>>>>>>>>>>>
36117>>>>>>>>>>>>>      //private
36117>>>>>>>>>>>>>      //œ¢âš®œ  «˜ 13 §œ›å˜ open item
36117>>>>>>>>>>>>>      //¡˜¢œå«˜  ˜§æ validate save
36117>>>>>>>>>>>>>      Function  private.fi_Validate_Open_Itemsa Returns Integer
36118>>>>>>>>>>>>>
36118>>>>>>>>>>>>>                 //1101+1102+1103+1104:â¢œš®¦  £ã ˜¨¤ž« ¡é¤ ¬§¦¢¦å§à¤ §¨¦ª ©¬©®â« ©ž ¡˜  ©¬©®œ« ©Ÿâ¤«à¤ §¦©é¤
36118>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 >= 0                       )) Function_Return 1101
36121>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 >= 0                       )) Function_Return 1102
36124>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 >= 0                       )) Function_Return 1103
36127>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 >= 0                       )) Function_Return 1104
36130>>>>>>>>>>>>>
36130>>>>>>>>>>>>>                 Case Begin
36130>>>>>>>>>>>>>                      //1105+1106+1107+1108:â¢œš®¦  š ˜ ˜«æ­ ¦ ®¨œà©« ¡æ record
36130>>>>>>>>>>>>>                      Case (Gmovea.Gmove_X0 > 0)
36132>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 <=      Gmovea.Gmove_X0  )) Function_Return 1105
36135>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 <=      Gmovea.Gmove_X0  )) Function_Return 1106
36138>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0  = 0                       )) Function_Return 1107
36141>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0  = 0                       )) Function_Return 1108
36144>>>>>>>>>>>>>                      Case Break
36145>>>>>>>>>>>>>                      //1109+1110+1111+1112:â¢œš®¦  š ˜ ¯œ¬«¦- ®¨œà©« ¡æ record
36145>>>>>>>>>>>>>                      Case (Gmovea.Gmove_X0 < 0)
36148>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0  = 0                       )) Function_Return 1109
36151>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0  = 0                       )) Function_Return 1110
36154>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 <= (Abs(Gmovea.Gmove_X0)))) Function_Return 1111
36157>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 <= (Abs(Gmovea.Gmove_X0)))) Function_Return 1112
36160>>>>>>>>>>>>>                      Case Break
36161>>>>>>>>>>>>>                      //1113+1114+1115+1116:â¢œš®¦  š ˜ ˜«æ­ ¦ § ©«à« ¡æ record
36161>>>>>>>>>>>>>                      Case (Gmovea.Gmove_P0 > 0)
36164>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0  = 0                       )) Function_Return 1113
36167>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0  = 0                       )) Function_Return 1114
36170>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 <=      Gmovea.Gmove_P0  )) Function_Return 1115
36173>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 <=      Gmovea.Gmove_P0  )) Function_Return 1116
36176>>>>>>>>>>>>>                      Case Break
36177>>>>>>>>>>>>>                      //1117+1118+1119+1120:â¢œš®¦  š ˜ ¯œç«¦- ®¨œà©« ¡æ record
36177>>>>>>>>>>>>>                      Case (Gmovea.Gmove_P0 < 0)
36180>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 <= (Abs(Gmovea.Gmove_P0)))) Function_Return 1117
36183>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 <= (Abs(Gmovea.Gmove_P0)))) Function_Return 1118
36186>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0  = 0                       )) Function_Return 1119
36189>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0  = 0                       )) Function_Return 1120
36192>>>>>>>>>>>>>                      Case Break
36193>>>>>>>>>>>>>                 Case End
36193>>>>>>>>>>>>>
36193>>>>>>>>>>>>>                 Function_Return 0 //æ¢˜ ok
36194>>>>>>>>>>>>>      End_Function //private.fi_validate_open_itemsa
36195>>>>>>>>>>>>>
36195>>>>>>>>>>>>>    Procedure Update
36196>>>>>>>>>>>>>          Send private.Do_Compute_Open_Itemsa
36197>>>>>>>>>>>>>    End_Procedure //update
36198>>>>>>>>>>>>>
36198>>>>>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
36199>>>>>>>>>>>>>              String lsError_Message
36200>>>>>>>>>>>>>              Case Begin
36200>>>>>>>>>>>>>                   //˜§æ validate save
36200>>>>>>>>>>>>>                   Case (iError_Num = 1101)
36202>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ œå¤˜  ˜¨¤ž« ¡æ !");                        to lsError_Message
36203>>>>>>>>>>>>>                   Case Break
36204>>>>>>>>>>>>>                   Case (iError_Num = 1102)
36207>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ œå¤˜  ˜¨¤ž« ¡æ !");                        to lsError_Message
36208>>>>>>>>>>>>>                   Case Break
36209>>>>>>>>>>>>>                   Case (iError_Num = 1103)
36212>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª œå¤˜  ˜¨¤ž« ¡ã !");                        to lsError_Message
36213>>>>>>>>>>>>>                   Case Break
36214>>>>>>>>>>>>>                   Case (iError_Num = 1104)
36217>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª œå¤˜  ˜¨¤ž« ¡ã !");                        to lsError_Message
36218>>>>>>>>>>>>>                   Case Break
36219>>>>>>>>>>>>>                   //---------------------------------------Ÿœ« ¡âª ®¨œé©œ ª-----------------
36219>>>>>>>>>>>>>                   Case (iError_Num = 1105)
36222>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã ®¨âà©ž !");                        to lsError_Message
36223>>>>>>>>>>>>>                   Case Break
36224>>>>>>>>>>>>>                   Case (iError_Num = 1106)
36227>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã ®¨âà©ž !");                        to lsError_Message
36228>>>>>>>>>>>>>                   Case Break
36229>>>>>>>>>>>>>                   Case (iError_Num = 1107)
36232>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ !");                        to lsError_Message
36233>>>>>>>>>>>>>                   Case Break
36234>>>>>>>>>>>>>                   Case (iError_Num = 1108)
36237>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
36238>>>>>>>>>>>>>                   Case Break
36239>>>>>>>>>>>>>                   //---------------------------------------˜¨¤ž« ¡âª ®¨œé©œ ª---------------
36239>>>>>>>>>>>>>                   Case (iError_Num = 1109)
36242>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ!");                        to lsError_Message
36243>>>>>>>>>>>>>                   Case Break
36244>>>>>>>>>>>>>                   Case (iError_Num = 1110)
36247>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
36248>>>>>>>>>>>>>                   Case Break
36249>>>>>>>>>>>>>                   Case (iError_Num = 1111)
36252>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª ®¨âà©žª !");                        to lsError_Message
36253>>>>>>>>>>>>>                   Case Break
36254>>>>>>>>>>>>>                   Case (iError_Num = 1112)
36257>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª ®¨âà©žª !");                        to lsError_Message
36258>>>>>>>>>>>>>                   Case Break
36259>>>>>>>>>>>>>                   //---------------------------------------Ÿœ« ¡âª § ©«é©œ ª----------------
36259>>>>>>>>>>>>>                   Case (iError_Num = 1113)
36262>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ !");                        to lsError_Message
36263>>>>>>>>>>>>>                   Case Break
36264>>>>>>>>>>>>>                   Case (iError_Num = 1114)
36267>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
36268>>>>>>>>>>>>>                   Case Break
36269>>>>>>>>>>>>>                   Case (iError_Num = 1115)
36272>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã §å©«à©ž !");                        to lsError_Message
36273>>>>>>>>>>>>>                   Case Break
36274>>>>>>>>>>>>>                   Case (iError_Num = 1116)
36277>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã §å©«à©ž !");                        to lsError_Message
36278>>>>>>>>>>>>>                   Case Break
36279>>>>>>>>>>>>>                   //---------------------------------------˜¨àž« ¡âª § ©«é©œ ª----------------
36279>>>>>>>>>>>>>                   Case (iError_Num = 1117)
36282>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ!");                        to lsError_Message
36283>>>>>>>>>>>>>                   Case Break
36284>>>>>>>>>>>>>                   Case (iError_Num = 1118)
36287>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
36288>>>>>>>>>>>>>                   Case Break
36289>>>>>>>>>>>>>                   Case (iError_Num = 1119)
36292>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª §å©«à©žª !");                        to lsError_Message
36293>>>>>>>>>>>>>                   Case Break
36294>>>>>>>>>>>>>                   Case (iError_Num = 1120) //soso ayto den xoraei display stin othoni !
36297>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª §å©«à©žª !");                        to lsError_Message
36298>>>>>>>>>>>>>                   Case Break
36299>>>>>>>>>>>>>
36299>>>>>>>>>>>>>
36299>>>>>>>>>>>>>                   //˜§æ validate delete
36299>>>>>>>>>>>>>                   Case (iError_Num = 2001)
36302>>>>>>>>>>>>>                        Move ("DDC 067:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n˜¨˜¡˜¢é ¡˜¢â©˜«œ «ž¤ Solution !");                        to lsError_Message
36303>>>>>>>>>>>>>                   Case Break
36304>>>>>>>>>>>>>
36304>>>>>>>>>>>>>                   Case Else
36304>>>>>>>>>>>>>                        Forward Send Operation_Not_Allowed iError_Num
36306>>>>>>>>>>>>>              Case End
36306>>>>>>>>>>>>>
36306>>>>>>>>>>>>>              Error iError_Num lsError_Message
36307>>>>>>>>>>>>>>
36307>>>>>>>>>>>>>    End_Procedure   //operation_not_allowed
36308>>>>>>>>>>>>>
36308>>>>>>>>>>>>>
36308>>>>>>>>>>>>>    Function Validate_Save Returns Integer
36309>>>>>>>>>>>>>             Integer iReturnVal liOpen_Itemsa
36310>>>>>>>>>>>>>             Forward Get Validate_Save to iReturnVal
36312>>>>>>>>>>>>>
36312>>>>>>>>>>>>>             If (Not(iReturnVal));             Begin
36314>>>>>>>>>>>>>             //1101-1120:â¢œš®¦  open item
36314>>>>>>>>>>>>>              Move (private.fi_Validate_Open_Itemsa(Self)) to liOpen_Itemsa
36315>>>>>>>>>>>>>              If (liOpen_Itemsa <> 0) Send Operation_Not_Allowed liOpen_Itemsa
36318>>>>>>>>>>>>>             End //«â¢¦ª ¡é› ¡˜ validation
36318>>>>>>>>>>>>>>
36318>>>>>>>>>>>>>
36318>>>>>>>>>>>>>
36318>>>>>>>>>>>>>             Function_Return iReturnVal
36319>>>>>>>>>>>>>    End_Function //validate_save
36320>>>>>>>>>>>>>
36320>>>>>>>>>>>>>
36320>>>>>>>>>>>>>    //2001:«¦ alias Gmovea ›â¤ œ§ «¨â§œ  ‰ € ‹ ˆ €   › ˜š¨˜­ã
36320>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
36321>>>>>>>>>>>>>             Send Operation_Not_Allowed 2001 //¢áŸ¦ª «¦¬ ¡é› ¡˜ !!!
36322>>>>>>>>>>>>>    End_Function //validate_delete
36323>>>>>>>>>>>>>
36323>>>>>>>>>>>>>
36323>>>>>>>>>>>>>    // Define_Fields:
36323>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
36323>>>>>>>>>>>>>
36323>>>>>>>>>>>>>    Procedure Define_Fields
36324>>>>>>>>>>>>>        Forward Send Define_Fields
36326>>>>>>>>>>>>>        //DDB-Generated-Code-Location
36326>>>>>>>>>>>>>        //DDB-DefineFieldStart
36326>>>>>>>>>>>>>
36326>>>>>>>>>>>>>        Set Main_File            To Gmovea.File_Number
36327>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
36328>>>>>>>>>>>>>
36328>>>>>>>>>>>>>
36328>>>>>>>>>>>>>        // Child (Client) file structure................
36328>>>>>>>>>>>>>        Send Add_Client_File  Gopen.File_Number
36329>>>>>>>>>>>>>
36329>>>>>>>>>>>>>        // Parent (Server) file structure...............
36329>>>>>>>>>>>>>        Send Add_Server_File  Garticl.File_Number
36330>>>>>>>>>>>>>        Send Add_Server_File  Gplan.File_Number
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Field-based properties.......................
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Company_Code
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Branch_Code
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Year_Year
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gtypkin_Code
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Garticl_Hmnia
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Garticl_No
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Garticl_Recr
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gplan_Recr
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_Rec0
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gplan_Code
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_Aitiol
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_X0
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_P0
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_X0k
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_P0k
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_X00
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_P00
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_X00k
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_P00k
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_X1
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_P1
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_X2
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_P2
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_X2k
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_P2k
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_Xr
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_Pr
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_Xrk
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_Prk
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_Dlixis
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_A_Code
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gthhmgio_Code
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_Aa
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx0
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp0
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx0
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp0
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx1
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp1
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx1
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp1
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx2
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp2
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx2
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp2
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_Sc_Code2
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_Open
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_Aopen
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_Topen
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_Kk
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gthhmgio_Period
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gplan_Yn_Myfp
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gplan_Yn_Myfa
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gplan_Myf_Sump
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gplan_Myf_Suma
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag01
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag02
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag03
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag04
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag05
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag06
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag07
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag08
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag09
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag10
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag11
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag12
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag13
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag14
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag15
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag16
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag17
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag18
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag19
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag20
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Year_Recr
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        // Gmovea.Gmove_Recr
36331>>>>>>>>>>>>>
36331>>>>>>>>>>>>>        //DDB-DefineFieldEnd
36331>>>>>>>>>>>>>    End_Procedure    // Define_Fields
36332>>>>>>>>>>>>>
36332>>>>>>>>>>>>>    // Field_Defaults:
36332>>>>>>>>>>>>>    // This procedure is used to establish default field values.
36332>>>>>>>>>>>>>
36332>>>>>>>>>>>>>    Procedure Field_Defaults
36333>>>>>>>>>>>>>        Forward Send Field_Defaults
36335>>>>>>>>>>>>>        //DDB-Generated-Code-Location
36335>>>>>>>>>>>>>        //DDB-FieldDefaultStart
36335>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
36335>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
36336>>>>>>>>>>>>>End_Class    // Gmovea_DataDictionary
36337>>>>>>>>>>>>>//DDB-FileEnd
36337>>>>>>>>>>>              //©«ž¤ begin_transaction §¨¦¡˜¢œå deadlock
36337>>>>>>>>>>>
36337>>>>>>>>>>>Class Gplan_DataDictionary  is a DataDictionary_Sec
36338>>>>>>>>>>>
36338>>>>>>>>>>>    Procedure Construct_Object
36339>>>>>>>>>>>        Forward Send Construct_Object
36341>>>>>>>>>>>        Object oarrayGplan_Aux is a cPinakas
36343>>>>>>>>>>>        End_Object
36344>>>>>>>>>>>        Property Integer pioarray_Gplan_Aux (oarrayGplan_Aux(self))
36345>>>>>>>>>>>        Property String psValidChars ""
36346>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
36347>>>>>>>>>>>    End_Procedure   // Construct_Object
36348>>>>>>>>>>>
36348>>>>>>>>>>>    Procedure OnConstrain
36349>>>>>>>>>>>        Forward Send OnConstrain
36351>>>>>>>>>>>        If (piMustNOTConstrain(Self)) Begin
36353>>>>>>>>>>>        End
36353>>>>>>>>>>>>
36353>>>>>>>>>>>        Else Begin
36354>>>>>>>>>>>            Constrain Gplan.Company_Code  eq SysCurGL.Company_Code
36356>>>>>>>>>>>            Constrain Gplan.Branch_Code   eq SysCurGL.Branch_Code
36358>>>>>>>>>>>            Constrain Gplan.Year_Year     eq SysCurGL.Year_Year
36360>>>>>>>>>>>        End
36360>>>>>>>>>>>>
36360>>>>>>>>>>>    End_Procedure
36361>>>>>>>>>>>
36361>>>>>>>>>>>    Procedure Update
36362>>>>>>>>>>>        Forward Send Update
36364>>>>>>>>>>>        // Insert Code Here
36364>>>>>>>>>>>        Move SysCurGL.Company_Code  to Gplan.Company_Code
36365>>>>>>>>>>>        Move SysCurGL.Branch_Code   to Gplan.Branch_Code
36366>>>>>>>>>>>        Move SysCurGL.Year_Year     to Gplan.Year_Year
36367>>>>>>>>>>>        Move SysCurGL.Year_Recr     to Gplan.Year_Recr
36368>>>>>>>>>>>    End_Procedure   // Update
36369>>>>>>>>>>>
36369>>>>>>>>>>>    Procedure Creating
36370>>>>>>>>>>>        Forward Send Creating
36372>>>>>>>>>>>        // Insert Code Here
36372>>>>>>>>>>>        Move (Append('',((Trim(SysCurGL.Branch_Site))+;                         (Trim(String(Gplan.Gplan_Rec0)))))) to Gplan.Gplan_Recr
36373>>>>>>>>>>>    End_Procedure   // Creating
36374>>>>>>>>>>>
36374>>>>>>>>>>>
36374>>>>>>>>>>>//////////////////////////////////////
36374>>>>>>>>>>>//////////////////////////////////////
36374>>>>>>>>>>>
36374>>>>>>>>>>>    Function fiCheckValidChars String asGplanCode String asValChars Returns Integer
36375>>>>>>>>>>>        String lsChar
36376>>>>>>>>>>>        Integer liLen liCharPos rVal
36376>>>>>>>>>>>        If (asGplanCode <> "") Begin
36378>>>>>>>>>>>            Move (Trim(asGplanCode)) to asGplanCode
36379>>>>>>>>>>>            Move (Length(asGplanCode)) to liLen
36380>>>>>>>>>>>            For liCharPos From 1 to liLen
36386>>>>>>>>>>>>
36386>>>>>>>>>>>               Move (Mid(asGplanCode,1,liCharPos)) to lsChar
36387>>>>>>>>>>>               If (Not(asValChars contains lsChar)) Begin
36389>>>>>>>>>>>                    Set psValidChars to asValChars
36390>>>>>>>>>>>                    Function_Return 1001
36391>>>>>>>>>>>               End
36391>>>>>>>>>>>>
36391>>>>>>>>>>>            Loop
36392>>>>>>>>>>>>
36392>>>>>>>>>>>        End
36392>>>>>>>>>>>>
36392>>>>>>>>>>>        Function_Return rVal
36393>>>>>>>>>>>    End_Function // fiCheckValidChars
36394>>>>>>>>>>>
36394>>>>>>>>>>>    // private_Do_Restore_Fields:
36394>>>>>>>>>>>    Procedure private_Do_Restore_Fields for Gplan_DataDictionary
36395>>>>>>>>>>>        // Insert Code Here
36395>>>>>>>>>>>        Local Integer lioarray_Gplan_Aux##
36396>>>>>>>>>>>        Local Integer liFile##
36396>>>>>>>>>>>        Local Integer liField_Count##
36396>>>>>>>>>>>        Local Integer liField_Type##
36396>>>>>>>>>>>        Local Integer liField##
36396>>>>>>>>>>>
36396>>>>>>>>>>>        Get pioarray_Gplan_Aux to lioarray_Gplan_Aux##
36397>>>>>>>>>>>        Get Main_File to liFile##
36398>>>>>>>>>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of liFile## to liField_Count##
36401>>>>>>>>>>>
36401>>>>>>>>>>>
36401>>>>>>>>>>>        For liField## from 0 to (liField_Count##-1)
36407>>>>>>>>>>>>
36407>>>>>>>>>>>            //Get_Attribute DF_FIELD_TYPE of iFile iField to iField_Type
36407>>>>>>>>>>>            move liField## to Fieldindex
36408>>>>>>>>>>>            Get Array_Value of lioarray_Gplan_Aux## Item (liField##+1) to Gplan.Company_Code&
36409>>>>>>>>>>>        Loop
36410>>>>>>>>>>>>
36410>>>>>>>>>>>        Send Delete_Data to lioarray_Gplan_Aux##
36411>>>>>>>>>>>    End_Procedure   // private_Do_Restore_Fields
36412>>>>>>>>>>>
36412>>>>>>>>>>>    // private_Do_Keep_Fields:
36412>>>>>>>>>>>
36412>>>>>>>>>>>    Procedure private_Do_Keep_Fields for Gplan_DataDictionary
36413>>>>>>>>>>>        // Insert Code Here
36413>>>>>>>>>>>        Local Integer lioarray_Gplan_Aux##
36414>>>>>>>>>>>        Local Integer liFile##
36414>>>>>>>>>>>        Local Integer liField_Count##
36414>>>>>>>>>>>        Local Integer liField_Type##
36414>>>>>>>>>>>        Local Integer liField##
36414>>>>>>>>>>>
36414>>>>>>>>>>>        Get pioarray_Gplan_Aux to lioarray_Gplan_Aux##
36415>>>>>>>>>>>        Get Main_File to liFile##
36416>>>>>>>>>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of liFile## to liField_Count##
36419>>>>>>>>>>>
36419>>>>>>>>>>>        Send Delete_Data to lioarray_Gplan_Aux##
36420>>>>>>>>>>>        Send Add_Item to lioarray_Gplan_Aux## 0 //sos.sos
36421>>>>>>>>>>>
36421>>>>>>>>>>>        For liField## from 0 to (liField_Count##-1)
36427>>>>>>>>>>>>
36427>>>>>>>>>>>            //Get_Attribute DF_FIELD_TYPE of iFile iField to iField_Type
36427>>>>>>>>>>>            move liField## to Fieldindex
36428>>>>>>>>>>>            Send Add_Item to lioarray_Gplan_Aux## Gplan.Company_Code&
36429>>>>>>>>>>>        Loop
36430>>>>>>>>>>>>
36430>>>>>>>>>>>    End_Procedure   // private_Do_Keep_Fields
36431>>>>>>>>>>>
36431>>>>>>>>>>>    // Request_Save:
36431>>>>>>>>>>>
36431>>>>>>>>>>>
36431>>>>>>>>>>>
36431>>>>>>>>>>>//-----------------------------------------------------------------------------
36431>>>>>>>>>>>    FUNCTION Compute_Bathmos for Gplan_DataDictionary STRING KODIKOS## RETURNS INTEGER
36432>>>>>>>>>>>             LOCAL INTEGER BATHMOS##
36433>>>>>>>>>>>             REPEAT
36433>>>>>>>>>>>>
36433>>>>>>>>>>>                   REPLACE "." IN KODIKOS## WITH ""
36435>>>>>>>>>>>                   [FOUND] INCREMENT BATHMOS##
36436>>>>>>>>>>>             UNTIL (FINDERR=1)
36438>>>>>>>>>>>             FUNCTION_RETURN (BATHMOS##+1)
36439>>>>>>>>>>>    END_FUNCTION //compute_bathmos
36440>>>>>>>>>>>
36440>>>>>>>>>>>    FUNCTION Find_Previous for Gplan_DataDictionary STRING LS_CODE1## RETURNS STRING
36441>>>>>>>>>>>        LOCAL STRING LS_TEMP_CODE1## LS_TEMP_CODE2##
36442>>>>>>>>>>>        LOCAL INTEGER LI_COUNTER##
36442>>>>>>>>>>>
36442>>>>>>>>>>>        FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_CODE1##))
36448>>>>>>>>>>>>
36448>>>>>>>>>>>             INSERT (MID(LS_CODE1##,1,LI_COUNTER##)) IN LS_TEMP_CODE1## AT 1
36450>>>>>>>>>>>        LOOP
36451>>>>>>>>>>>>
36451>>>>>>>>>>>        MOVE (RIGHT(LS_TEMP_CODE1##,(LENGTH(LS_TEMP_CODE1##)-(POS(".",LS_TEMP_CODE1##))))) ;             TO LS_TEMP_CODE1##
36452>>>>>>>>>>>        FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_TEMP_CODE1##))
36458>>>>>>>>>>>>
36458>>>>>>>>>>>            INSERT (MID(LS_TEMP_CODE1##,1,LI_COUNTER##)) IN LS_TEMP_CODE2## AT 1
36460>>>>>>>>>>>        LOOP
36461>>>>>>>>>>>>
36461>>>>>>>>>>>        FUNCTION_RETURN LS_TEMP_CODE2##
36462>>>>>>>>>>>    END_FUNCTION
36463>>>>>>>>>>>
36463>>>>>>>>>>>    FUNCTION fiCheck_Format STRING  LS_CODE1##;                            STRING  LS_MASK##;                            INTEGER LI_BATHMOS##;                            RETURNS INTEGER
36464>>>>>>>>>>>             String  LS_TEMP_CODE1## LS_TEMP_CODE2## LS_MASK2##
36465>>>>>>>>>>>             Integer LI_COUNTER## LI_BATHMOS1##
36465>>>>>>>>>>>             Move (Trim(ls_Code1##)) to ls_Code1##
36466>>>>>>>>>>>             Move (Trim(ls_Mask##))  to ls_Mask##
36467>>>>>>>>>>>             FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_MASK##))
36473>>>>>>>>>>>>
36473>>>>>>>>>>>                  IF ((MID(LS_MASK##,1,LI_COUNTER##)) = ".") INCREMENT LI_BATHMOS1##
36476>>>>>>>>>>>                  IF (LI_BATHMOS1## < LI_BATHMOS##) ;                  INSERT (MID(LS_MASK##,1,LI_COUNTER##)) IN LS_MASK2## AT LI_COUNTER##
36480>>>>>>>>>>>             LOOP
36481>>>>>>>>>>>>
36481>>>>>>>>>>>             IF (;                  (LENGTH(LS_CODE1##)) <> (LENGTH(LS_MASK2##));                ) FUNCTION_RETURN 1000
36484>>>>>>>>>>>             FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_MASK2##))
36490>>>>>>>>>>>>
36490>>>>>>>>>>>                  IF (;                      ((MID(LS_MASK2##,1,LI_COUNTER##)) = ".") AND;                      ((MID(LS_CODE1##,1,LI_COUNTER##)) <> ".");                     ) FUNCTION_RETURN 1000
36493>>>>>>>>>>>             LOOP
36494>>>>>>>>>>>>
36494>>>>>>>>>>>             FUNCTION_RETURN 0
36495>>>>>>>>>>>    END_FUNCTION //fiCHECK_FORMAT
36496>>>>>>>>>>>
36496>>>>>>>>>>>    Function fiBackward_Check for Gplan_DataDictionary String LsGplanCode_Back integer liBathmos Returns Integer
36497>>>>>>>>>>>        Integer liGplan_Yn_Last
36498>>>>>>>>>>>        Number liGplanRecnum
36498>>>>>>>>>>>        String LsSearch_CodePrevious
36498>>>>>>>>>>>
36498>>>>>>>>>>>        if (liBathmos > 1) begin
36500>>>>>>>>>>>
36500>>>>>>>>>>>            move (Current_Record(Self)) to liGplanRecnum
36501>>>>>>>>>>>            move gplan.Gplan_Yn_Last to liGplan_Yn_Last
36502>>>>>>>>>>>            Send private_Do_Keep_Fields
36503>>>>>>>>>>>
36503>>>>>>>>>>>            Move (Find_Previous(self,lsGplanCode_Back)) to lsSearch_CodePrevious
36504>>>>>>>>>>>
36504>>>>>>>>>>>            clear Gplan
36505>>>>>>>>>>>            move gs_Selected_Company_Code  to Gplan.Company_Code
36506>>>>>>>>>>>            move gs_Selected_Branch_Code   to Gplan.Branch_Code
36507>>>>>>>>>>>            move gi_Selected_Year          to Gplan.Year_Year
36508>>>>>>>>>>>            move lsSearch_CodePrevious     to Gplan.Gplan_Code
36509>>>>>>>>>>>            Find eq Gplan by index.1 // pkid
36510>>>>>>>>>>>>
36510>>>>>>>>>>>            If (Found = 0) begin
36512>>>>>>>>>>>                clear gplan
36513>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
36514>>>>>>>>>>>                find eq gplan.recnum
36515>>>>>>>>>>>>
36515>>>>>>>>>>>                Send private_Do_Restore_Fields
36516>>>>>>>>>>>                Function_return  7001 //return to fiValidate
36517>>>>>>>>>>>            end
36517>>>>>>>>>>>>
36517>>>>>>>>>>>            else begin
36518>>>>>>>>>>>               // The  previous logar marked last  and current greater bathmos
36518>>>>>>>>>>>               if   (Gplan.Gplan_yn_Last = 1) begin
36520>>>>>>>>>>>                   Send private_Do_Restore_Fields
36521>>>>>>>>>>>                   Function_return 7003
36522>>>>>>>>>>>               end
36522>>>>>>>>>>>>
36522>>>>>>>>>>>               clear gplan
36523>>>>>>>>>>>               move liGplanRecnum to gplan.recnum
36524>>>>>>>>>>>               find eq gplan.recnum
36525>>>>>>>>>>>>
36525>>>>>>>>>>>               Send private_Do_Restore_Fields
36526>>>>>>>>>>>               function_Return 0 //ok
36527>>>>>>>>>>>            end
36527>>>>>>>>>>>>
36527>>>>>>>>>>>        end
36527>>>>>>>>>>>>
36527>>>>>>>>>>>        Function_Return 0
36528>>>>>>>>>>>    End_Function  // fiBackward_Check
36529>>>>>>>>>>>    //-----------------------------------------------------------------------------
36529>>>>>>>>>>>
36529>>>>>>>>>>>
36529>>>>>>>>>>>    //-----------------------------------------------------------------------------
36529>>>>>>>>>>>    FUNCTION fiForward_Check for Gplan_DataDictionary STRING LS_GplanCode integer liMode Returns Integer
36530>>>>>>>>>>>        String lsNext_Anoep
36531>>>>>>>>>>>        Integer liGplan_Yn_Last
36531>>>>>>>>>>>        Number liGplanRecnum
36531>>>>>>>>>>>
36531>>>>>>>>>>>
36531>>>>>>>>>>>        //move gplan.recnum to liGplanRecnum
36531>>>>>>>>>>>        move (Current_Record(Self)) to liGplanRecnum
36532>>>>>>>>>>>        move gplan.Gplan_Code to lsNext_Anoep
36533>>>>>>>>>>>        move gplan.Gplan_Yn_Last to liGplan_Yn_Last
36534>>>>>>>>>>>        Send private_Do_Keep_Fields
36535>>>>>>>>>>>
36535>>>>>>>>>>>        if (liGplan_Yn_Last = 1)  begin
36537>>>>>>>>>>>            find gt gplan by index.1
36538>>>>>>>>>>>>
36538>>>>>>>>>>>            if (found = 0) begin
36540>>>>>>>>>>>                clear gplan
36541>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
36542>>>>>>>>>>>                find eq gplan.recnum
36543>>>>>>>>>>>>
36543>>>>>>>>>>>                Send private_Do_Restore_Fields
36544>>>>>>>>>>>            end
36544>>>>>>>>>>>>
36544>>>>>>>>>>>            else begin
36545>>>>>>>>>>>                // The Current and the previous logar marked last
36545>>>>>>>>>>>                if (Gplan.Gplan_Anoep = lsNext_Anoep) begin
36547>>>>>>>>>>>                    clear gplan
36548>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
36549>>>>>>>>>>>                    find eq gplan.recnum
36550>>>>>>>>>>>>
36550>>>>>>>>>>>                    Send private_Do_Restore_Fields
36551>>>>>>>>>>>                    Function_return 7004
36552>>>>>>>>>>>                end
36552>>>>>>>>>>>>
36552>>>>>>>>>>>                else begin
36553>>>>>>>>>>>                    clear gplan
36554>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
36555>>>>>>>>>>>                    find eq gplan.recnum
36556>>>>>>>>>>>>
36556>>>>>>>>>>>                    Send private_Do_Restore_Fields
36557>>>>>>>>>>>                end
36557>>>>>>>>>>>>
36557>>>>>>>>>>>            end
36557>>>>>>>>>>>>
36557>>>>>>>>>>>        end
36557>>>>>>>>>>>>
36557>>>>>>>>>>>
36557>>>>>>>>>>>        if (liMode = 1) begin
36559>>>>>>>>>>>            find gt gplan by index.1
36560>>>>>>>>>>>>
36560>>>>>>>>>>>            if (Found = 0) begin
36562>>>>>>>>>>>                clear gplan
36563>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
36564>>>>>>>>>>>                find eq gplan.recnum
36565>>>>>>>>>>>>
36565>>>>>>>>>>>                Send private_Do_Restore_Fields
36566>>>>>>>>>>>            end
36566>>>>>>>>>>>>
36566>>>>>>>>>>>            else begin
36567>>>>>>>>>>>                if (Gplan.Gplan_Anoep = lsNext_Anoep) begin
36569>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
36570>>>>>>>>>>>                    find eq gplan.recnum
36571>>>>>>>>>>>>
36571>>>>>>>>>>>                    Send private_Do_Restore_Fields
36572>>>>>>>>>>>                    Function_return 7010 //called from validate delete
36573>>>>>>>>>>>                end
36573>>>>>>>>>>>>
36573>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
36574>>>>>>>>>>>                find eq gplan.recnum
36575>>>>>>>>>>>>
36575>>>>>>>>>>>                //Send private_Do_Restore_Fields
36575>>>>>>>>>>>            end
36575>>>>>>>>>>>>
36575>>>>>>>>>>>        end
36575>>>>>>>>>>>>
36575>>>>>>>>>>>        Function_return 0
36576>>>>>>>>>>>    End_Function // fiForward_Check
36577>>>>>>>>>>>
36577>>>>>>>>>>>
36577>>>>>>>>>>>    Function private_Man_Gplan_Code for Gplan_DataDictionary integer liField## String lsGplan_Code integer liModeGplan Returns Integer
36578>>>>>>>>>>>
36578>>>>>>>>>>>        // Insert Code Here
36578>>>>>>>>>>>        Integer liCounter liPosition liLength liBathmos liRetVal
36579>>>>>>>>>>>        string lsMask lsCkeckChar lsSearchCode
36579>>>>>>>>>>>
36579>>>>>>>>>>>        Trim lsGplan_code to lsGplan_code
36580>>>>>>>>>>>>
36580>>>>>>>>>>>        Move lsGplan_Code to lsSearchCode
36581>>>>>>>>>>>    Search_Again:
36581>>>>>>>>>>>        clear Gformat
INCLUDING FILE: GFORMAT.FD
36582>>>>>>>>>>>        move SysCurGL.Company_Code  to Gformat.Company_Code
36583>>>>>>>>>>>        move SysCurGL.Branch_Code   to Gformat.Branch_Code
36584>>>>>>>>>>>        move SysCurGL.Year_Year     to Gformat.Year_Year
36585>>>>>>>>>>>        move lsSearchCode           to Gformat.Gformat_Code
36586>>>>>>>>>>>        Find eq Gformat by index.1
36587>>>>>>>>>>>>
36587>>>>>>>>>>>
36587>>>>>>>>>>>        if (Found = 1) begin
36589>>>>>>>>>>>            Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
36590>>>>>>>>>>>            Move (fiCheck_Format(self,lsGplan_Code,gformat.gformat_mask,liBathmos)) to liRetVal
36591>>>>>>>>>>>            if (liRetVal = 0) begin
36593>>>>>>>>>>>                Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
36594>>>>>>>>>>>                if (liModeGplan = 0) Begin
36596>>>>>>>>>>>                    if (Not(Current_Record(self))) begin
36598>>>>>>>>>>>                        set field_default_value field Gplan.gplan_Bathmos to libathmos //from deo
36599>>>>>>>>>>>                    end
36599>>>>>>>>>>>>
36599>>>>>>>>>>>                end
36599>>>>>>>>>>>>
36599>>>>>>>>>>>                if (libathmos > 1) begin
36601>>>>>>>>>>>                    Move (Find_Previous(self,lsGplan_Code)) to lsSearchCode
36602>>>>>>>>>>>                    if (liModeGplan = 0) Begin
36604>>>>>>>>>>>                        if (Not(Current_Record(self))) begin
36606>>>>>>>>>>>                            set field_default_value field Gplan.gplan_Anoep to lsSearchCode //from Deo
36607>>>>>>>>>>>                        End
36607>>>>>>>>>>>>
36607>>>>>>>>>>>                    End
36607>>>>>>>>>>>>
36607>>>>>>>>>>>                end
36607>>>>>>>>>>>>
36607>>>>>>>>>>>            function_return 0
36608>>>>>>>>>>>            end
36608>>>>>>>>>>>>
36608>>>>>>>>>>>            else begin
36609>>>>>>>>>>>                function_return 127
36610>>>>>>>>>>>            end
36610>>>>>>>>>>>>
36610>>>>>>>>>>>        end
36610>>>>>>>>>>>>
36610>>>>>>>>>>>        else begin
36611>>>>>>>>>>>            Move (Compute_Bathmos(self,lsSearchCode)) to liBathmos
36612>>>>>>>>>>>            if ((liBathmos-1) <> 0) begin
36614>>>>>>>>>>>                Move (Find_Previous(self,lsSearchCode)) to lsSearchCode
36615>>>>>>>>>>>                Goto Search_Again
36616>>>>>>>>>>>>
36616>>>>>>>>>>>            end
36616>>>>>>>>>>>>
36616>>>>>>>>>>>            else begin
36617>>>>>>>>>>>                clear Gformat
36618>>>>>>>>>>>                move SysCurGL.Company_Code  to Gformat.Company_Code
36619>>>>>>>>>>>                move SysCurGL.Branch_Code   to Gformat.Branch_Code
36620>>>>>>>>>>>                move SysCurGL.Year_Year     to Gformat.Year_Year
36621>>>>>>>>>>>                move "@@"                   to Gformat.Gformat_Code
36622>>>>>>>>>>>                Find eq Gformat by index.1 // pkid
36623>>>>>>>>>>>>
36623>>>>>>>>>>>//* to be a function
36623>>>>>>>>>>>                Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
36624>>>>>>>>>>>                Move (fiCheck_Format(self,lsGplan_Code,gformat.gformat_mask,liBathmos)) to liRetVal
36625>>>>>>>>>>>                if (liRetVal = 0) begin
36627>>>>>>>>>>>                    Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
36628>>>>>>>>>>>                    if (liModeGplan = 0) Begin
36630>>>>>>>>>>>                        if (Not(Current_Record(self))) begin
36632>>>>>>>>>>>                            set field_default_value field Gplan.gplan_Bathmos to libathmos //from Deo
36633>>>>>>>>>>>                        end
36633>>>>>>>>>>>>
36633>>>>>>>>>>>                    end
36633>>>>>>>>>>>>
36633>>>>>>>>>>>                    if (libathmos > 1) begin
36635>>>>>>>>>>>                        Move (Find_Previous(self,lsGplan_Code)) to lsSearchCode
36636>>>>>>>>>>>                        if (liModeGplan = 0) Begin
36638>>>>>>>>>>>                            if (Not(Current_Record(self))) begin
36640>>>>>>>>>>>                                set field_default_value field Gplan.gplan_Anoep to lsSearchCode //from Deo
36641>>>>>>>>>>>                            end
36641>>>>>>>>>>>>
36641>>>>>>>>>>>                        end
36641>>>>>>>>>>>>
36641>>>>>>>>>>>                    end
36641>>>>>>>>>>>>
36641>>>>>>>>>>>                function_return 0
36642>>>>>>>>>>>                end
36642>>>>>>>>>>>>
36642>>>>>>>>>>>                else begin
36643>>>>>>>>>>>                    function_return 127
36644>>>>>>>>>>>                end
36644>>>>>>>>>>>>
36644>>>>>>>>>>>
36644>>>>>>>>>>>                //* emd to be a function
36644>>>>>>>>>>>                function_return 0
36645>>>>>>>>>>>            end
36645>>>>>>>>>>>>
36645>>>>>>>>>>>        end
36645>>>>>>>>>>>>
36645>>>>>>>>>>>        Function_return 0    //ok
36646>>>>>>>>>>>    End_Function   // private_Man_Gplan_Code
36647>>>>>>>>>>>
36647>>>>>>>>>>>
36647>>>>>>>>>>>
36647>>>>>>>>>>>    // fiValidateGplanFields:
36647>>>>>>>>>>>
36647>>>>>>>>>>>    Function fiValidateGplanFields for Gplan_DataDictionary integer liField string lsFieldvalue Returns Integer
36648>>>>>>>>>>>        String  sName lsAnoep lsGplan_Code
36649>>>>>>>>>>>        Integer iMainFile liGplanRecnum liReturnVal liReturnValb liBathmos1
36649>>>>>>>>>>>        String lsValidChar lsDelimiter
36649>>>>>>>>>>>
36649>>>>>>>>>>>        Get Main_File to iMainFile
36650>>>>>>>>>>>        Get_Attribute DF_FIELD_NAME of iMainFile liField to sName
36653>>>>>>>>>>>
36653>>>>>>>>>>>        If (sName = 'GPLAN_CODE') Begin
36655>>>>>>>>>>>            move (trim(lsFieldvalue)) to lsFieldvalue //from deo
36656>>>>>>>>>>>            if (lsFieldvalue <>  "") begin //new
36658>>>>>>>>>>>                Move SyscurGL.Year_Valid_Char to lsValidChar
36659>>>>>>>>>>>                Move SyscurGL.Year_Delimiter  to lsDelimiter
36660>>>>>>>>>>>                Move (fiCheckValidChars(Self,lsFieldvalue,((Trim(lsValidChar))+(Trim(lsDelimiter))))) to liReturnVal
36661>>>>>>>>>>>                if (liReturnVal = '1001') begin
36663>>>>>>>>>>>                               error liReturnVal ("‹ž ˜§¦›œ¡«æª ®˜¨˜¡«ã¨˜ª š ˜ ¡à› ¡æ Š.‘ !\n\n€§¦›œ¡«¦å ®˜¨˜¡«ã¨œª : '" + (psValidChars(Self)) + "'")
36664>>>>>>>>>>>>
36664>>>>>>>>>>>                               Function_Return liReturnVal
36665>>>>>>>>>>>                            end
36665>>>>>>>>>>>>
36665>>>>>>>>>>>
36665>>>>>>>>>>>                Move (private_Man_Gplan_Code(self,liField,lsFieldvalue,0)) to liReturnVal
36666>>>>>>>>>>>                if (lireturnval <> 0) begin
36668>>>>>>>>>>>                                        error 127 ("ŠáŸ¦ª £¦¨­ã ¡à› ¡¦ç !\n\n"+Gplan.Gplan_Code)
36669>>>>>>>>>>>>
36669>>>>>>>>>>>                                        function_return 127
36670>>>>>>>>>>>                                      end
36670>>>>>>>>>>>>
36670>>>>>>>>>>>
36670>>>>>>>>>>>                get field_current_value field Gplan.gplan_Code to lsGplan_Code
36671>>>>>>>>>>>                get field_current_value field Gplan.gplan_Bathmos to liBathmos1
36672>>>>>>>>>>>                get field_current_value field Gplan.gplan_anoep to lsAnoep
36673>>>>>>>>>>>                Move (fiBackward_Check(self,lsGplan_Code,liBathmos1)) to liReturnValb
36674>>>>>>>>>>>                if (liReturnValb = '7001') begin
36676>>>>>>>>>>>                                               error 7001 "ƒœ¤ ¬§á¨®œ  ¦ §œ¨ ¢ž§« ¡æª ™˜Ÿ£æª !"
36677>>>>>>>>>>>>
36677>>>>>>>>>>>                                               Function_Return 8001
36678>>>>>>>>>>>                                            end
36678>>>>>>>>>>>>
36678>>>>>>>>>>>                if (liReturnValb = '7002') begin
36680>>>>>>>>>>>                                               error 7002 "“§á¨®œ  ¡à› ¡æª «œ¢œ¬«˜å¦¬ ™˜Ÿ£¦ç !"
36681>>>>>>>>>>>>
36681>>>>>>>>>>>                                               Function_Return 8002
36682>>>>>>>>>>>                                          end
36682>>>>>>>>>>>>
36682>>>>>>>>>>>                if (liReturnValb = '7003') begin
36684>>>>>>>>>>>                                               error 7003 "Ž §¨¦žš¦ç£œ¤¦ª œå¤˜  «œ¢œ¬«˜å¦¬ ™˜Ÿ£¦ç !"
36685>>>>>>>>>>>>
36685>>>>>>>>>>>                                               Function_Return 8003
36686>>>>>>>>>>>                                          end
36686>>>>>>>>>>>>
36686>>>>>>>>>>>
36686>>>>>>>>>>>                Move (fiForward_Check(self,lsGplan_Code,0)) to liReturnValb
36687>>>>>>>>>>>                if (liReturnValb = '7004') begin
36689>>>>>>>>>>>                                               error 7004 "“§á¨®œ  ¦ ˜¤é«œ¨¦ª ™˜Ÿ£æª !"
36690>>>>>>>>>>>>
36690>>>>>>>>>>>                                               Function_Return 8004
36691>>>>>>>>>>>                                            end
36691>>>>>>>>>>>>
36691>>>>>>>>>>>
36691>>>>>>>>>>>            end
36691>>>>>>>>>>>>
36691>>>>>>>>>>>            else Function_Return 0  //exit function ok!!!
36693>>>>>>>>>>>         end
36693>>>>>>>>>>>>
36693>>>>>>>>>>>         function_return 0
36694>>>>>>>>>>>    End_Function   // fiValidateGplanFields
36695>>>>>>>>>>>
36695>>>>>>>>>>>
36695>>>>>>>>>>>//-----------------------------------------------Save Operation ----------------------------------------------------
36695>>>>>>>>>>>
36695>>>>>>>>>>>
36695>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
36696>>>>>>>>>>>        //Forward Send Operation_Not_Allowed  iError_Num
36696>>>>>>>>>>>        // Insert Code Here
36696>>>>>>>>>>>                 if iError_num eq 127  error 127 ((Trim(Gplan.Gplan_Code))+" Wrong Format !!!! \n\n")
36699>>>>>>>>>>>            Else if iError_num eq 128  error 128 ("Not a valid Data Entry.  Account is Missing !!!!\n\n"+Gplan.Gplan_Code)
36703>>>>>>>>>>>            Else if iError_num eq 129  error 129 ("Not a valid Data Entry.  Bathmos is Missing !!!!\n\n"+Gplan.Gplan_Code)
36707>>>>>>>>>>>            Else if iError_num eq 130  error 130 ("Not a valid Data Entry.  Previews Account is Missing !!!!\n\n"+Gplan.Gplan_Code)
36711>>>>>>>>>>>            Else if iError_num eq 1100  error 1100 "DDC:150 - ‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
36715>>>>>>>>>>>            Else if iError_num eq 2100  error 2100 "DDC:150 - ‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
36719>>>>>>>>>>>            Else if iError_num eq 7001 error 8001 ("Anoep Does not Exist !!!!\n\n"+Gplan.Gplan_Code)
36723>>>>>>>>>>>            Else if iError_num eq 7002 error 8002 ("Last Exists\n\n!!!! "+Gplan.Gplan_Code)
36727>>>>>>>>>>>            Else if iError_num eq 7003 error 8003 ("Previous batmos is last  !!!!\n\n"+Gplan.Gplan_Code)
36731>>>>>>>>>>>            Else if iError_num eq 7004 error 8004 ("Greater bathmos exists  !!!!\n\n"+Gplan.Gplan_Code)
36735>>>>>>>>>>>            Else if iError_num eq 7010 error 7010 ("Greater bathmos exists  !!!!\n\n"+Gplan.Gplan_Code)
36739>>>>>>>>>>>            Else if (iError_num = 1001) error 1001 ("‹ž ˜§¦›œ¡«æª ®˜¨˜¡«ã¨˜ª š ˜ ¡à› ¡æ Š.‘ !\n\n€§¦›œ¡«¦å ®˜¨˜¡«ã¨œª : '" + (psValidChars(Self)) + "'")
36743>>>>>>>>>>>            Else Forward Send Operation_Not_Allowed  iError_Num
36746>>>>>>>>>>>    End_Procedure
36747>>>>>>>>>>>
36747>>>>>>>>>>>
36747>>>>>>>>>>>    Procedure Clear_From_Bpo
36748>>>>>>>>>>>        Clear Gplan
36749>>>>>>>>>>>    End_Procedure
36750>>>>>>>>>>>
36750>>>>>>>>>>>    Function Validate_Save  Returns Integer
36751>>>>>>>>>>>        Local Integer iReturnVal iField##
36752>>>>>>>>>>>        locaL string lsVal##
36752>>>>>>>>>>>
36752>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
36754>>>>>>>>>>>
36754>>>>>>>>>>>
36754>>>>>>>>>>>        If (Not(iReturnVal))Begin
36756>>>>>>>>>>>            If (Not(Current_Record(Self))) Move (fiCheckValidChars(Self,Gplan.Gplan_Code,((Trim(Year.Year_Valid_Char))+(Trim(Year.Year_Delimiter))))) to iReturnVal
36759>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
36762>>>>>>>>>>>            If (Gplan.Gplan_Code    = "") Send Operation_Not_Allowed 128
36765>>>>>>>>>>>            If (Gplan.Gplan_Bathmos = 0 ) Send Operation_Not_Allowed 129
36768>>>>>>>>>>>            If (;                 (Gplan.Gplan_Bathmos <> 1) and;                 (Gplan.Gplan_Anoep = "");               ) Send Operation_Not_Allowed 130
36771>>>>>>>>>>>            For iField## from 4 to 4   // Field number for Starting and Ending pp's ???????
36777>>>>>>>>>>>>
36777>>>>>>>>>>>
36777>>>>>>>>>>>                Move (private_Man_Gplan_Code(self,iField##,Gplan.Gplan_Code,1))     to iReturnVal
36778>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
36781>>>>>>>>>>>
36781>>>>>>>>>>>                Move (fiBACKWARD_CHECK(self,Gplan.Gplan_Code,Gplan.Gplan_Bathmos)) to iReturnVal
36782>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
36785>>>>>>>>>>>
36785>>>>>>>>>>>                Move (fiFORWARD_CHECK(self,Gplan.Gplan_Code,0))                     to iReturnVal
36786>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
36789>>>>>>>>>>>
36789>>>>>>>>>>>            Loop
36790>>>>>>>>>>>>
36790>>>>>>>>>>>              //1100:cby = globals
36790>>>>>>>>>>>              If ( ;                   (Not(Gplan.Company_Code = SysCurGL.Company_Code)) or;                   (Not(Gplan.Branch_Code  = SysCurGL.Branch_Code )) or;                   (Not(Gplan.Year_Year    = SysCurGL.Year_Year   ));                  ) Send Operation_Not_Allowed 1100
36793>>>>>>>>>>>        End
36793>>>>>>>>>>>>
36793>>>>>>>>>>>        Function_Return iReturnVal
36794>>>>>>>>>>>    End_Function
36795>>>>>>>>>>>
36795>>>>>>>>>>>    Function Validate_Delete  Returns Integer
36796>>>>>>>>>>>        Local Integer iReturnVal liReturnValb##
36797>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
36799>>>>>>>>>>>
36799>>>>>>>>>>>        If (Not(iReturnVal)) Begin
36801>>>>>>>>>>>            // Insert Code Here
36801>>>>>>>>>>>               Move (fiFORWARD_CHECK(Self,Gplan.Gplan_Code,1)) to liReturnValb##
36802>>>>>>>>>>>               If (liReturnValb##>1) Send Operation_Not_Allowed liReturnValb##
36805>>>>>>>>>>>              //2100:cby = globals
36805>>>>>>>>>>>              If ( ;                   (Not(Gplan.Company_Code = SysCurGL.Company_Code)) or;                   (Not(Gplan.Branch_Code  = SysCurGL.Branch_Code )) or;                   (Not(Gplan.Year_Year    = SysCurGL.Year_Year   ));                  )                                                   Send Operation_Not_Allowed 2100
36808>>>>>>>>>>>        End
36808>>>>>>>>>>>>
36808>>>>>>>>>>>
36808>>>>>>>>>>>        Function_Return iReturnVal
36809>>>>>>>>>>>    End_Function
36810>>>>>>>>>>>
36810>>>>>>>>>>>
36810>>>>>>>>>>>//    Procedure Update
36810>>>>>>>>>>>//        Forward Send Update
36810>>>>>>>>>>>//        // Insert Code Here
36810>>>>>>>>>>>//        Move Company.Company_Code  to Gplan.Company_Code
36810>>>>>>>>>>>//        Move Branch.Branch_Code    to Gplan.Branch_Code
36810>>>>>>>>>>>//        Move Year.Year_Year        to Gplan.Year_Year
36810>>>>>>>>>>>//        Add 1 to Year.Year_NumGplan //˜¨ Ÿ£æª ¢¦š˜¨ ˜©£é¤ «žª ®¨ã©žª
36810>>>>>>>>>>>//    End_Procedure   // Update
36810>>>>>>>>>>>
36810>>>>>>>>>>>//    Procedure Backout
36810>>>>>>>>>>>//        Forward Send Backout
36810>>>>>>>>>>>//        Sub 1 from Year.Year_NumGplan //˜¨ Ÿ£æª ¢¦š˜¨ ˜©£é¤ «žª ®¨ã©žª
36810>>>>>>>>>>>//    End_Procedure //deleting
36810>>>>>>>>>>>
36810>>>>>>>>>>>
36810>>>>>>>>>>>
36810>>>>>>>>>>>    // Define_Fields:
36810>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
36810>>>>>>>>>>>
36810>>>>>>>>>>>    Procedure Define_Fields
36811>>>>>>>>>>>        Forward Send Define_Fields
36813>>>>>>>>>>>        //DDB-Generated-Code-Location
36813>>>>>>>>>>>        //DDB-DefineFieldStart
36813>>>>>>>>>>>
36813>>>>>>>>>>>        Set Main_File            To Gplan.File_Number
36814>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
36815>>>>>>>>>>>
36815>>>>>>>>>>>
36815>>>>>>>>>>>        // Child (Client) file structure................
36815>>>>>>>>>>>        Send Add_Client_File  Gmovea.File_Number
36816>>>>>>>>>>>        Send Add_Client_File  Gplanmod.File_Number
36817>>>>>>>>>>>        Send Add_Client_File  Gmhnes.File_Number
36818>>>>>>>>>>>        Send Add_Client_File  Gmove.File_Number
36819>>>>>>>>>>>        Send Add_Client_File  Gvatd.File_Number
36820>>>>>>>>>>>        Send Add_Client_File  Gpmoves.File_Number
36821>>>>>>>>>>>
36821>>>>>>>>>>>        // External (System) file structure.............
36821>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
36822>>>>>>>>>>>        Send Add_System_File  Syscurgl.File_Number  DD_LOCK_ON_ALL
36823>>>>>>>>>>>
36823>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gplan_Rec0  To Gplan.Gplan_Rec0
36826>>>>>>>>>>>
36826>>>>>>>>>>>        // Field-based properties.......................
36826>>>>>>>>>>>
36826>>>>>>>>>>>        // Gplan.Company_Code
36826>>>>>>>>>>>
36826>>>>>>>>>>>        // Gplan.Branch_Code
36826>>>>>>>>>>>
36826>>>>>>>>>>>        // Gplan.Year_Year
36826>>>>>>>>>>>
36826>>>>>>>>>>>        // Gplan.Gplan_Code
36826>>>>>>>>>>>        Set Field_Exit_msg         Field Gplan.Gplan_Code To get_fiValidateGplanFields
36827>>>>>>>>>>>        Set Field_Options          Field Gplan.Gplan_Code To DD_AUTOFIND    DD_REQUIRED   
36828>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Code To (sl150(Self))
36829>>>>>>>>>>>
36829>>>>>>>>>>>        // Gplan.Gplan_Rec0
36829>>>>>>>>>>>
36829>>>>>>>>>>>        // Gplan.Year_Recr
36829>>>>>>>>>>>
36829>>>>>>>>>>>        // Gplan.Gplan_Descr1
36829>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Descr1 To (sl150(Self))
36830>>>>>>>>>>>
36830>>>>>>>>>>>        // Gplan.Gplan_Descr2
36830>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Descr2 To (sl150(Self))
36831>>>>>>>>>>>
36831>>>>>>>>>>>        // Gplan.Gplan_Bathmos
36831>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Bathmos To "Calulated"
36831>>>>>>>>>>>
36831>>>>>>>>>>>        // Gplan.Gplan_Anoep
36831>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Anoep To "Calulated"
36831>>>>>>>>>>>
36831>>>>>>>>>>>        // Gplan.Gplan_O_Code
36831>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_O_Code To "dbComboFormSub"
36832>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_O_Code To (Gplan_Gplan_O_Code_VT(Self))
36833>>>>>>>>>>>
36833>>>>>>>>>>>        // Gplan.Gplan_Yn_Xfer
36833>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Xfer To "dbComboFormSub"
36834>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Xfer To (Gplan_Gplan_Yn_VT(Self))
36835>>>>>>>>>>>
36835>>>>>>>>>>>        // Gplan.Gplan_Yn_Last
36835>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Last To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1013)"
36835>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Last To "dbComboFormSub"
36836>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Last To (Gplan_Gplan_Yn_VT(Self))
36837>>>>>>>>>>>
36837>>>>>>>>>>>        // Gplan.Gplan_Yn_Kin
36837>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Kin To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1014)"
36837>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Kin To "dbComboFormSub"
36838>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Kin To (Gplan_Gplan_Yn_VT(Self))
36839>>>>>>>>>>>
36839>>>>>>>>>>>        // Gplan.Gplan_Yn_Kk
36839>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Kk To "dbComboFormSub"
36840>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Kk To (Gplan_Gplan_Yn_VT(Self))
36841>>>>>>>>>>>
36841>>>>>>>>>>>        // Gplan.Gplan_Xpm
36841>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Xpm To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1015+1016)"
36841>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Xpm To "dbComboFormSub"
36842>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Xpm To (Gplan_Gplan_Xpm_VT(Self))
36843>>>>>>>>>>>
36843>>>>>>>>>>>        // Gplan.Gplan_Yn_Xy
36843>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Xy To "•¨ž© £¦§¦ œå«˜  ©«ž¤ private.trexe «¦¬ Gmove (1017)"
36843>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Xy To "dbComboFormSub"
36844>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Xy To (Gplan_Gplan_Yn_VT(Self))
36845>>>>>>>>>>>
36845>>>>>>>>>>>        // Gplan.Gplan_Yn_Py
36845>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Py To "•¨ž© £¦§¦ œå«˜  ©«ž¤ private.trexe «¦¬ Gmove (1018)"
36845>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Py To "dbComboFormSub"
36846>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Py To (Gplan_Gplan_Yn_VT(Self))
36847>>>>>>>>>>>
36847>>>>>>>>>>>        // Gplan.Gplan_Fpaent
36847>>>>>>>>>>>
36847>>>>>>>>>>>        // Gplan.Gplan_Fpaent_Yn
36847>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Fpaent_Yn To (Gplan_Gplan_Yn_VT(Self))
36848>>>>>>>>>>>
36848>>>>>>>>>>>        // Gplan.Gplan_Afm
36848>>>>>>>>>>>
36848>>>>>>>>>>>        // Gplan.Gplan_Addr
36848>>>>>>>>>>>
36848>>>>>>>>>>>        // Gplan.Gplan_Tk
36848>>>>>>>>>>>
36848>>>>>>>>>>>        // Gplan.Gplan_Poli
36848>>>>>>>>>>>
36848>>>>>>>>>>>        // Gplan.Gplan_Doy
36848>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Doy To "dbComboFormSub"
36849>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Doy To (Gplan_Gplan_Doy_VT(Self))
36850>>>>>>>>>>>
36850>>>>>>>>>>>        // Gplan.Gplan_J_Code
36850>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_J_Code To "dbComboFormSub"
36851>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_J_Code To (Gplan_Gplan_J_Code_VT(Self))
36852>>>>>>>>>>>
36852>>>>>>>>>>>        // Gplan.Gplan_C_Code2
36852>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_C_Code2 To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1019)"
36852>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_C_Code2 To "dbComboFormSub"
36853>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_C_Code2 To (Gplan_Gplan_C_Code2_VT(Self))
36854>>>>>>>>>>>
36854>>>>>>>>>>>        // Gplan.Gplan_Tel
36854>>>>>>>>>>>
36854>>>>>>>>>>>        // Gplan.Gplan_Email
36854>>>>>>>>>>>
36854>>>>>>>>>>>        // Gplan.Gplan_Resp
36854>>>>>>>>>>>
36854>>>>>>>>>>>        // Gplan.Gplan_Bitmap
36854>>>>>>>>>>>
36854>>>>>>>>>>>        // Gplan.Gplan_Rep_Code
36854>>>>>>>>>>>
36854>>>>>>>>>>>        // Gplan.Gplan_Rep_Pct
36854>>>>>>>>>>>
36854>>>>>>>>>>>        // Gplan.Gplan_I_Xy_Code
36854>>>>>>>>>>>
36854>>>>>>>>>>>        // Gplan.Gplan_I_Py_Code
36854>>>>>>>>>>>
36854>>>>>>>>>>>        // Gplan.Gplan_I_Ctypkin
36854>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_I_Ctypkin To (Gtypkin(Self))
36855>>>>>>>>>>>
36855>>>>>>>>>>>        // Gplan.Gplan_I_A_Code
36855>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_I_A_Code To "dbComboFormSub"
36856>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_I_A_Code To (Gplan_Gplan_I_A_Code_VT2(Self))
36857>>>>>>>>>>>
36857>>>>>>>>>>>        // Gplan.Gplan_Yn_Myfp
36857>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Myfp To "dbComboFormSub"
36858>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Myfp To (Gplan_Gplan_Yn_VT(Self))
36859>>>>>>>>>>>
36859>>>>>>>>>>>        // Gplan.Gplan_Yn_Myfa
36859>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Myfa To "dbComboFormSub"
36860>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Myfa To (Gplan_Gplan_Yn_VT(Self))
36861>>>>>>>>>>>
36861>>>>>>>>>>>        // Gplan.Gplan_Myfnump
36861>>>>>>>>>>>
36861>>>>>>>>>>>        // Gplan.Gplan_Myfvalp
36861>>>>>>>>>>>
36861>>>>>>>>>>>        // Gplan.Gplan_Myfnuma
36861>>>>>>>>>>>
36861>>>>>>>>>>>        // Gplan.Gplan_Myfvala
36861>>>>>>>>>>>
36861>>>>>>>>>>>        // Gplan.Gplan_Myf_Sump
36861>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Myf_Sump To "‰˜Ÿ¦¨åœ  œá¤ ¦  ®¨œé©œ ª/§ ©«é©œ ª Ÿ˜ ˜Ÿ¨¦ ©«¦ç¤ ©«ž¤ ‹“”"
36861>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Myf_Sump To "dbComboFormSub"
36862>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Myf_Sump To (Gplan_Gplan_Myf_Sum_VT(Self))
36863>>>>>>>>>>>
36863>>>>>>>>>>>        // Gplan.Gplan_Myf_Suma
36863>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Myf_Suma To "dbComboFormSub"
36864>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Myf_Suma To (Gplan_Gplan_Myf_Sum_VT(Self))
36865>>>>>>>>>>>
36865>>>>>>>>>>>        // Gplan.Gplan_Sx0
36865>>>>>>>>>>>
36865>>>>>>>>>>>        // Gplan.Gplan_Sp0
36865>>>>>>>>>>>
36865>>>>>>>>>>>        // Gplan.Gplan_Sx00
36865>>>>>>>>>>>
36865>>>>>>>>>>>        // Gplan.Gplan_Sp00
36865>>>>>>>>>>>
36865>>>>>>>>>>>        // Gplan.Gplan_Sxr
36865>>>>>>>>>>>
36865>>>>>>>>>>>        // Gplan.Gplan_Spr
36865>>>>>>>>>>>
36865>>>>>>>>>>>        // Gplan.Gplan_Sx2
36865>>>>>>>>>>>
36865>>>>>>>>>>>        // Gplan.Gplan_Sp2
36865>>>>>>>>>>>
36865>>>>>>>>>>>        // Gplan.Gplan_Gmhnnorec
36865>>>>>>>>>>>
36865>>>>>>>>>>>        // Gplan.Gplan_Recr
36865>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Recr To (sl150(Self))
36866>>>>>>>>>>>
36866>>>>>>>>>>>        //DDB-DefineFieldEnd
36866>>>>>>>>>>>    End_Procedure    // Define_Fields
36867>>>>>>>>>>>
36867>>>>>>>>>>>    // Field_Defaults:
36867>>>>>>>>>>>    // This procedure is used to establish default field values.
36867>>>>>>>>>>>
36867>>>>>>>>>>>    Procedure Field_Defaults
36868>>>>>>>>>>>        Forward Send Field_Defaults
36870>>>>>>>>>>>        //DDB-Generated-Code-Location
36870>>>>>>>>>>>        //DDB-FieldDefaultStart
36870>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Xfer To 0
36871>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Last To 0
36872>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Kin To 1
36873>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Kk To 0
36874>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Xpm To 3
36875>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Xy To 1
36876>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Py To 1
36877>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Fpaent_Yn To 0
36878>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Rep_Pct To 100
36879>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Myfp To 0
36880>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Myfa To 0
36881>>>>>>>>>>>        //DDB-FieldDefaultEnd
36881>>>>>>>>>>>    End_Procedure    // Field_Defaults
36882>>>>>>>>>>>End_Class    // Gplan_DataDictionary
36883>>>>>>>>>>>
36883>>>>>>>>>>>
36883>>>>>>>>>>>
36883>>>>>>>>>>>
36883>>>>>>>>>>>
36883>>>>>>>>>>>
36883>>>>>>>>>>>
36883>>>>>>>>>>>
36883>>>>>>>>>>>
36883>>>>>>>>>>>
36883>>>>>>>>>>>
36883>>>>>>>>>>>
36883>>>>>>>>>>>
36883>>>>>>>>>>>
36883>>>>>>>>>>>//DDB-Selection-pkg-Start
36883>>>>>>>>>>>
36883>>>>>>>>>>>Use sl150.sl         // sl150
36883>>>>>>>>>>>Use Gtypkin.sl       // Gtypkin
INCLUDING FILE: GTYPKIN.SL
36883>>>>>>>>>>>>>//AB/ Project gtypkin:Gtypkin
36883>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
36883>>>>>>>>>>>>>//AB/         Set ProjectName to "gtypkin:Gtypkin"
36883>>>>>>>>>>>>>//AB/         Set ProjectFileName to "gtypkin.SL"
36883>>>>>>>>>>>>>
36883>>>>>>>>>>>>>// Project Object Structure
36883>>>>>>>>>>>>>//   gtypkin is a dbModalPanel
36883>>>>>>>>>>>>>//     Gthhmgio_DD is a DataDictionary
36883>>>>>>>>>>>>>//     Gtypkin_DD is a DataDictionary
36883>>>>>>>>>>>>>//     oSelList is a dbList
36883>>>>>>>>>>>>>//     oOK_bn is a Button
36883>>>>>>>>>>>>>//     oCancel_bn is a Button
36883>>>>>>>>>>>>>//     oSearch_bn is a Button
36883>>>>>>>>>>>>>
36883>>>>>>>>>>>>>// Register all objects
36883>>>>>>>>>>>>>Register_Object Gthhmgio_DD
36883>>>>>>>>>>>>>Register_Object Gtypkin_DD
36883>>>>>>>>>>>>>Register_Object gtypkin
36883>>>>>>>>>>>>>Register_Object oCancel_bn
36883>>>>>>>>>>>>>Register_Object oOK_bn
36883>>>>>>>>>>>>>Register_Object oSearch_bn
36883>>>>>>>>>>>>>Register_Object oSelList
36883>>>>>>>>>>>>>
36883>>>>>>>>>>>>>
36883>>>>>>>>>>>>>    //AB-IgnoreStart
36883>>>>>>>>>>>>>
36883>>>>>>>>>>>>>    Use DFAllEnt.pkg
36883>>>>>>>>>>>>>
36883>>>>>>>>>>>>>
36883>>>>>>>>>>>>>    Use GTHHMGIO.DD
INCLUDING FILE: GTHHMGIO.DD
36883>>>>>>>>>>>>>>>//DDB-FileStart
36883>>>>>>>>>>>>>>>//DDB-HeaderStart
36883>>>>>>>>>>>>>>>
36883>>>>>>>>>>>>>>>// File Name : GTHHMGIO.DD
36883>>>>>>>>>>>>>>>// Class Name: Gthhmgio_DataDictionary
36883>>>>>>>>>>>>>>>// Revision  : 33
36883>>>>>>>>>>>>>>>// Version   : 2
36883>>>>>>>>>>>>>>>
36883>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
36883>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
36883>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
36883>>>>>>>>>>>>>>>
36883>>>>>>>>>>>>>>>Open Gthhmgio
INCLUDING FILE: GTHHMGIO.FD
36885>>>>>>>>>>>>>>>Open Gtypkin
36887>>>>>>>>>>>>>>>Open Gthaa
INCLUDING FILE: GTHAA.FD
36889>>>>>>>>>>>>>>>Open Sysrecg
36891>>>>>>>>>>>>>>>
36891>>>>>>>>>>>>>>>//DDB-HeaderEnd
36891>>>>>>>>>>>>>>>//DDB-ValidationStart
36891>>>>>>>>>>>>>>>
36891>>>>>>>>>>>>>>>Register_Object Gthhmgio_Gthhmgio_Period_VT
36891>>>>>>>>>>>>>>>
36891>>>>>>>>>>>>>>>Object Gthhmgio_Gthhmgio_Period_VT  is a CodeValidationTable
36893>>>>>>>>>>>>>>>    Set Type_Value        To "PERIOD"
36894>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
36894>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
36894>>>>>>>>>>>>>>>End_Object   // Gthhmgio_Gthhmgio_Period_VT
36895>>>>>>>>>>>>>>>//DDB-ValidationEnd
36895>>>>>>>>>>>>>>>//DDB-SelectionStart
36895>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList Gthhmgio  Gthhmgio.SL
36895>>>>>>>>>>>>>>>Register_Object Gthhmgio
36895>>>>>>>>>>>>>>>//DDB-SelectionEnd
36895>>>>>>>>>>>>>>>
36895>>>>>>>>>>>>>>>Class Gthhmgio_DataDictionary  is a DataDictionary_Sec
36896>>>>>>>>>>>>>>>
36896>>>>>>>>>>>>>>>
36896>>>>>>>>>>>>>>>    // Define_Fields:
36896>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
36896>>>>>>>>>>>>>>>
36896>>>>>>>>>>>>>>>    Procedure Define_Fields
36897>>>>>>>>>>>>>>>        Forward Send Define_Fields
36899>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
36899>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
36899>>>>>>>>>>>>>>>
36899>>>>>>>>>>>>>>>        Set Main_File            To Gthhmgio.File_Number
36900>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
36901>>>>>>>>>>>>>>>
36901>>>>>>>>>>>>>>>
36901>>>>>>>>>>>>>>>        // Child (Client) file structure................
36901>>>>>>>>>>>>>>>        Send Add_Client_File  Gtypkin.File_Number
36902>>>>>>>>>>>>>>>        Send Add_Client_File  Gthaa.File_Number
36903>>>>>>>>>>>>>>>
36903>>>>>>>>>>>>>>>        // External (System) file structure.............
36903>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
36904>>>>>>>>>>>>>>>
36904>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gthhmgio_Rec0  To Gthhmgio.Gthhmgio_Rec0
36907>>>>>>>>>>>>>>>
36907>>>>>>>>>>>>>>>        // Field-based properties.......................
36907>>>>>>>>>>>>>>>
36907>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Code
36907>>>>>>>>>>>>>>>        Set Field_Options          Field Gthhmgio.Gthhmgio_Code To DD_AUTOFIND   
36908>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gthhmgio.Gthhmgio_Code To (Gthhmgio(Self))
36909>>>>>>>>>>>>>>>        Set Key_Field_State        Field Gthhmgio.Gthhmgio_Code To TRUE
36910>>>>>>>>>>>>>>>
36910>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Rec0
36910>>>>>>>>>>>>>>>
36910>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Descr
36910>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gthhmgio.Gthhmgio_Descr To (Gthhmgio(Self))
36911>>>>>>>>>>>>>>>
36911>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Period
36911>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gthhmgio.Gthhmgio_Period To (Gthhmgio_Gthhmgio_Period_VT(Self))
36912>>>>>>>>>>>>>>>
36912>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Recr
36912>>>>>>>>>>>>>>>        Set Field_Options          Field Gthhmgio.Gthhmgio_Recr To DD_AUTOFIND   
36913>>>>>>>>>>>>>>>        Set Key_Field_State        Field Gthhmgio.Gthhmgio_Recr To TRUE
36914>>>>>>>>>>>>>>>
36914>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
36914>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
36915>>>>>>>>>>>>>>>
36915>>>>>>>>>>>>>>>    // Field_Defaults:
36915>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
36915>>>>>>>>>>>>>>>
36915>>>>>>>>>>>>>>>    Procedure Field_Defaults
36916>>>>>>>>>>>>>>>        Forward Send Field_Defaults
36918>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
36918>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
36918>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
36918>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
36919>>>>>>>>>>>>>>>End_Class    // Gthhmgio_DataDictionary
36920>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
36920>>>>>>>>>>>>>>>
36920>>>>>>>>>>>>>>>Use Gthhmgio.SL      // Gthhmgio
INCLUDING FILE: GTHHMGIO.SL
36920>>>>>>>>>>>>>>>>>//AB/ Project Gthhmgio:Gthhmgio
36920>>>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
36920>>>>>>>>>>>>>>>>>//AB/         Set ProjectName to "Gthhmgio:Gthhmgio"
36920>>>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "Gthhmgio.SL"
36920>>>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
36920>>>>>>>>>>>>>>>>>
36920>>>>>>>>>>>>>>>>>// Project Object Structure
36920>>>>>>>>>>>>>>>>>//   Gthhmgio is a dbModalPanel
36920>>>>>>>>>>>>>>>>>//     Gthhmgio_DD is a DataDictionary
36920>>>>>>>>>>>>>>>>>//     oSelList is a dbList
36920>>>>>>>>>>>>>>>>>//     oOK_bn is a Button
36920>>>>>>>>>>>>>>>>>//     oCancel_bn is a Button
36920>>>>>>>>>>>>>>>>>//     oSearch_bn is a Button
36920>>>>>>>>>>>>>>>>>
36920>>>>>>>>>>>>>>>>>// Register all objects
36920>>>>>>>>>>>>>>>>>Register_Object Gthhmgio_DD
36920>>>>>>>>>>>>>>>>>Register_Object oCancel_bn
36920>>>>>>>>>>>>>>>>>Register_Object oOK_bn
36920>>>>>>>>>>>>>>>>>Register_Object oSearch_bn
36920>>>>>>>>>>>>>>>>>Register_Object oSelList
36920>>>>>>>>>>>>>>>>>Register_Object Gthhmgio
36920>>>>>>>>>>>>>>>>>
36920>>>>>>>>>>>>>>>>>
36920>>>>>>>>>>>>>>>>>    //AB-IgnoreStart
36920>>>>>>>>>>>>>>>>>
36920>>>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
36920>>>>>>>>>>>>>>>>>
36920>>>>>>>>>>>>>>>>>
36920>>>>>>>>>>>>>>>>>    Use GTHHMGIO.DD
36920>>>>>>>>>>>>>>>>>
36920>>>>>>>>>>>>>>>>>    //AB-IgnoreEnd
36920>>>>>>>>>>>>>>>>>
36920>>>>>>>>>>>>>>>>>    CD_Popup_Object Gthhmgio is a dbModalPanel
36939>>>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
36940>>>>>>>>>>>>>>>>>        Set Label to "Šå©«˜ †£œ¨¦¢¦šåà¤"
36941>>>>>>>>>>>>>>>>>        Set Size to 148 297
36942>>>>>>>>>>>>>>>>>        Set Location to 4 5
36943>>>>>>>>>>>>>>>>>
36943>>>>>>>>>>>>>>>>>        //AB-DDOStart
36943>>>>>>>>>>>>>>>>>
36943>>>>>>>>>>>>>>>>>        Object Gthhmgio_DD is a Gthhmgio_DataDictionary
36945>>>>>>>>>>>>>>>>>        End_Object    // Gthhmgio_DD
36946>>>>>>>>>>>>>>>>>
36946>>>>>>>>>>>>>>>>>        Set Main_DD to (Gthhmgio_DD(self))
36947>>>>>>>>>>>>>>>>>        Set Server to (Gthhmgio_DD(self))
36948>>>>>>>>>>>>>>>>>
36948>>>>>>>>>>>>>>>>>        //AB-DDOEnd
36948>>>>>>>>>>>>>>>>>
36948>>>>>>>>>>>>>>>>>        Object oSelList is a dbList
36950>>>>>>>>>>>>>>>>>            Set Main_File to Gthhmgio.File_Number
36951>>>>>>>>>>>>>>>>>            Set Size to 105 280
36952>>>>>>>>>>>>>>>>>            Set Location to 6 6
36953>>>>>>>>>>>>>>>>>
36953>>>>>>>>>>>>>>>>>            Begin_Row
36956>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_code
36957>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_descr
36958>>>>>>>>>>>>>>>>>            End_Row
36963>>>>>>>>>>>>>>>>>
36963>>>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 52
36964>>>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
36965>>>>>>>>>>>>>>>>>
36965>>>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 220
36966>>>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
36967>>>>>>>>>>>>>>>>>
36967>>>>>>>>>>>>>>>>>        End_Object    // oSelList
36968>>>>>>>>>>>>>>>>>
36968>>>>>>>>>>>>>>>>>        Object oOK_bn is a Button
36970>>>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
36971>>>>>>>>>>>>>>>>>            Set Location to 111 127
36972>>>>>>>>>>>>>>>>>
36972>>>>>>>>>>>>>>>>>            //AB-StoreStart
36972>>>>>>>>>>>>>>>>>            Procedure OnClick
36974>>>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
36975>>>>>>>>>>>>>>>>>            End_Procedure
36976>>>>>>>>>>>>>>>>>            //AB-StoreEnd
36976>>>>>>>>>>>>>>>>>
36976>>>>>>>>>>>>>>>>>        End_Object    // oOK_bn
36977>>>>>>>>>>>>>>>>>
36977>>>>>>>>>>>>>>>>>        Object oCancel_bn is a Button
36979>>>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
36980>>>>>>>>>>>>>>>>>            Set Location to 111 181
36981>>>>>>>>>>>>>>>>>
36981>>>>>>>>>>>>>>>>>            //AB-StoreStart
36981>>>>>>>>>>>>>>>>>            Procedure OnClick
36983>>>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
36984>>>>>>>>>>>>>>>>>            End_Procedure
36985>>>>>>>>>>>>>>>>>            //AB-StoreEnd
36985>>>>>>>>>>>>>>>>>
36985>>>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
36986>>>>>>>>>>>>>>>>>
36986>>>>>>>>>>>>>>>>>        Object oSearch_bn is a Button
36988>>>>>>>>>>>>>>>>>            Set Label to "&€¤˜ã«ž©ž..."
36989>>>>>>>>>>>>>>>>>            Set Location to 111 237
36990>>>>>>>>>>>>>>>>>
36990>>>>>>>>>>>>>>>>>            //AB-StoreStart
36990>>>>>>>>>>>>>>>>>            Procedure OnClick
36992>>>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
36993>>>>>>>>>>>>>>>>>            End_Procedure
36994>>>>>>>>>>>>>>>>>            //AB-StoreEnd
36994>>>>>>>>>>>>>>>>>
36994>>>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
36995>>>>>>>>>>>>>>>>>
36995>>>>>>>>>>>>>>>>>
36995>>>>>>>>>>>>>>>>>        //AB-StoreStart
36995>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
36996>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
36997>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
36998>>>>>>>>>>>>>>>>>        //AB-StoreEnd
36998>>>>>>>>>>>>>>>>>
36998>>>>>>>>>>>>>>>>>    CD_End_Object    // Gthhmgio
37000>>>>>>>>>>>>>>>>>>
37000>>>>>>>>>>>>>>>>>
37000>>>>>>>>>>>>>>>>>//AB/     End_Object    // prj
37000>>>>>>>>>>>>>>>
37000>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
37000>>>>>>>>>>>>>>>//DDB-FileEnd
37000>>>>>>>>>>>>>    Use GTYPKIN.DD
INCLUDING FILE: GTYPKIN.DD
37000>>>>>>>>>>>>>>>//DDB-FileStart
37000>>>>>>>>>>>>>>>//DDB-HeaderStart
37000>>>>>>>>>>>>>>>
37000>>>>>>>>>>>>>>>// File Name : GTYPKIN.DD
37000>>>>>>>>>>>>>>>// Class Name: Gtypkin_DataDictionary
37000>>>>>>>>>>>>>>>// Revision  : 44
37000>>>>>>>>>>>>>>>// Version   : 2
37000>>>>>>>>>>>>>>>
37000>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
37000>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
37000>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
37000>>>>>>>>>>>>>>>
37000>>>>>>>>>>>>>>>Open Gtypkin
37002>>>>>>>>>>>>>>>Open Garticl
37004>>>>>>>>>>>>>>>Open Gflagkin
INCLUDING FILE: GFLAGKIN.FD
37006>>>>>>>>>>>>>>>Open Gparticl
INCLUDING FILE: GPARTICL.FD
37008>>>>>>>>>>>>>>>Open Gthhmgio
37010>>>>>>>>>>>>>>>Open Sysrecg
37012>>>>>>>>>>>>>>>
37012>>>>>>>>>>>>>>>//DDB-HeaderEnd
37012>>>>>>>>>>>>>>>//DDB-SelectionStart
37012>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList gtypkin  gtypkin.SL
37012>>>>>>>>>>>>>>>Register_Object gtypkin
37012>>>>>>>>>>>>>>>//DDB-SelectionEnd
37012>>>>>>>>>>>>>>>Open SysCurGL
37014>>>>>>>>>>>>>>>
37014>>>>>>>>>>>>>>>Class Gtypkin_DataDictionary  is a DataDictionary_Sec
37015>>>>>>>>>>>>>>>
37015>>>>>>>>>>>>>>>    Procedure Entry_Order_Date  Integer iField  Date dDate
37016>>>>>>>>>>>>>>>         // Add a default date if the field is blank
37016>>>>>>>>>>>>>>>         Integer Changed
37017>>>>>>>>>>>>>>>         Get Field_Changed_State iField to Changed
37018>>>>>>>>>>>>>>>         If (Changed=0 AND dDate =0) Begin
37020>>>>>>>>>>>>>>>             SysDate4 dDate
37021>>>>>>>>>>>>>>>             Set Field_Default_Value iField to dDate
37022>>>>>>>>>>>>>>>         End
37022>>>>>>>>>>>>>>>>
37022>>>>>>>>>>>>>>>    End_Procedure
37023>>>>>>>>>>>>>>>
37023>>>>>>>>>>>>>>>    Procedure Construct_Object
37024>>>>>>>>>>>>>>>        Forward Send Construct_Object
37026>>>>>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
37027>>>>>>>>>>>>>>>        Property Date    pdDefault_Hmnia    Public 0
37028>>>>>>>>>>>>>>>        Property Integer piRate             Public 0
37029>>>>>>>>>>>>>>>        Property Integer piGthhmgio_dd      Public 0
37030>>>>>>>>>>>>>>>    End_Procedure   // Construct_Object
37031>>>>>>>>>>>>>>>
37031>>>>>>>>>>>>>>>    Procedure OnConstrain
37032>>>>>>>>>>>>>>>        Forward Send OnConstrain
37034>>>>>>>>>>>>>>>        If (piMustNOTConstrain(Self)) Begin
37036>>>>>>>>>>>>>>>        End
37036>>>>>>>>>>>>>>>>
37036>>>>>>>>>>>>>>>        Else Begin
37037>>>>>>>>>>>>>>>            Constrain Gtypkin.Company_Code  eq SysCurGL.Company_Code
37039>>>>>>>>>>>>>>>            Constrain Gtypkin.Branch_Code   eq SysCurGL.Branch_Code
37041>>>>>>>>>>>>>>>            Constrain Gtypkin.Year_Year     eq SysCurGL.Year_Year
37043>>>>>>>>>>>>>>>        End
37043>>>>>>>>>>>>>>>>
37043>>>>>>>>>>>>>>>    End_Procedure
37044>>>>>>>>>>>>>>>
37044>>>>>>>>>>>>>>>    Procedure Update
37045>>>>>>>>>>>>>>>        Forward Send Update
37047>>>>>>>>>>>>>>>        // Insert Code Here
37047>>>>>>>>>>>>>>>        Move SysCurGL.Company_Code  to Gtypkin.Company_Code
37048>>>>>>>>>>>>>>>        Move SysCurGL.Branch_Code   to Gtypkin.Branch_Code
37049>>>>>>>>>>>>>>>        Move SysCurGL.Year_Year     to Gtypkin.Year_Year
37050>>>>>>>>>>>>>>>        Move SysCurGL.Year_Recr     to Gtypkin.Year_Recr
37051>>>>>>>>>>>>>>>        Move Gthhmgio.Gthhmgio_Code to Gtypkin.Gthhmgio_Code
37052>>>>>>>>>>>>>>>    End_Procedure   // Update
37053>>>>>>>>>>>>>>>
37053>>>>>>>>>>>>>>>    Procedure Creating
37054>>>>>>>>>>>>>>>        Forward Send Creating
37056>>>>>>>>>>>>>>>        // Insert Code Here
37056>>>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurGL.Branch_Site))+;                         (Trim(String(Gtypkin.Gtypkin_Rec0)))))) to Gtypkin.Gtypkin_Recr
37057>>>>>>>>>>>>>>>    End_Procedure   // Creating
37058>>>>>>>>>>>>>>>
37058>>>>>>>>>>>>>>>
37058>>>>>>>>>>>>>>>
37058>>>>>>>>>>>>>>>//----------------------------------------------------------------------------
37058>>>>>>>>>>>>>>>
37058>>>>>>>>>>>>>>>//    Procedure Creating
37058>>>>>>>>>>>>>>>//              Forward Send Creating
37058>>>>>>>>>>>>>>>//              Add 1 to Year.Year_NumGtypkin //˜¨ Ÿ£æª «ç§à¤ ¡ ¤ã©œà¤ «žª ®¨ã©žª
37058>>>>>>>>>>>>>>>//    End_Procedure //creating
37058>>>>>>>>>>>>>>>//    Procedure Deleting
37058>>>>>>>>>>>>>>>//              Forward Send Deleting
37058>>>>>>>>>>>>>>>//              Sub 1 from Year.Year_NumGtypkin //˜¨ Ÿ£æª «ç§à¤ ¡ ¤ã©œà¤ «žª ®¨ã©žª
37058>>>>>>>>>>>>>>>//    End_Procedure //deleting
37058>>>>>>>>>>>>>>>
37058>>>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
37059>>>>>>>>>>>>>>>        Integer iReturnVal
37060>>>>>>>>>>>>>>>        Forward Get Validate_Save To iReturnVal
37062>>>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
37064>>>>>>>>>>>>>>>            //1100:cby = globals
37064>>>>>>>>>>>>>>>            If ( ;                (Not(Gtypkin.Company_Code = SysCurGL.Company_Code)) or;                (Not(Gtypkin.Branch_Code  = SysCurGL.Branch_Code )) or;                (Not(Gtypkin.Year_Year    = SysCurGL.Year_Year   ));                ) Send Operation_Not_Allowed 1100
37067>>>>>>>>>>>>>>>        End
37067>>>>>>>>>>>>>>>>
37067>>>>>>>>>>>>>>>        Function_Return iReturnVal
37068>>>>>>>>>>>>>>>    End_Function   //validate_save
37069>>>>>>>>>>>>>>>
37069>>>>>>>>>>>>>>>
37069>>>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
37070>>>>>>>>>>>>>>>        Integer iReturnVal
37071>>>>>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
37073>>>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
37075>>>>>>>>>>>>>>>            //2100:cby = globals
37075>>>>>>>>>>>>>>>            If ( ;                (Not(Gtypkin.Company_Code = SysCurGL.Company_Code)) or;                (Not(Gtypkin.Branch_Code  = SysCurGL.Branch_Code )) or;                (Not(Gtypkin.Year_Year    = SysCurGL.Year_Year   ));                ) Send Operation_Not_Allowed 2100
37078>>>>>>>>>>>>>>>        End
37078>>>>>>>>>>>>>>>>
37078>>>>>>>>>>>>>>>        Function_Return iReturnVal
37079>>>>>>>>>>>>>>>    End_Function   // validate_delete
37080>>>>>>>>>>>>>>>
37080>>>>>>>>>>>>>>>
37080>>>>>>>>>>>>>>>
37080>>>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
37081>>>>>>>>>>>>>>>              Case Begin
37081>>>>>>>>>>>>>>>                   Case (iError_Num = 1100)
37083>>>>>>>>>>>>>>>                        Error 1100 "DDC 151:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
37084>>>>>>>>>>>>>>>>
37084>>>>>>>>>>>>>>>                        Case Break
37085>>>>>>>>>>>>>>>                   Case (iError_Num = 2100)
37088>>>>>>>>>>>>>>>                        Error 2100 "DDC 151:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
37089>>>>>>>>>>>>>>>>
37089>>>>>>>>>>>>>>>                        Case Break
37090>>>>>>>>>>>>>>>                   Case Else
37090>>>>>>>>>>>>>>>                        Forward Send Operation_Not_Allowed  iError_Num
37092>>>>>>>>>>>>>>>              Case End
37092>>>>>>>>>>>>>>>    End_Procedure   //operation_not_allowed
37093>>>>>>>>>>>>>>>
37093>>>>>>>>>>>>>>>
37093>>>>>>>>>>>>>>>    Procedure Field_Defaults
37094>>>>>>>>>>>>>>>        Forward Send Field_Defaults
37096>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
37096>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
37096>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
37096>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
37097>>>>>>>>>>>>>>>
37097>>>>>>>>>>>>>>>
37097>>>>>>>>>>>>>>>
37097>>>>>>>>>>>>>>>    // Define_Fields:
37097>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
37097>>>>>>>>>>>>>>>
37097>>>>>>>>>>>>>>>    Procedure Define_Fields
37098>>>>>>>>>>>>>>>        Forward Send Define_Fields
37100>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
37100>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
37100>>>>>>>>>>>>>>>
37100>>>>>>>>>>>>>>>        Set Main_File            To Gtypkin.File_Number
37101>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
37102>>>>>>>>>>>>>>>
37102>>>>>>>>>>>>>>>
37102>>>>>>>>>>>>>>>        // Child (Client) file structure................
37102>>>>>>>>>>>>>>>        Send Add_Client_File  Garticl.File_Number
37103>>>>>>>>>>>>>>>        Send Add_Client_File  Gflagkin.File_Number
37104>>>>>>>>>>>>>>>        Send Add_Client_File  Gparticl.File_Number
37105>>>>>>>>>>>>>>>
37105>>>>>>>>>>>>>>>        // Parent (Server) file structure...............
37105>>>>>>>>>>>>>>>        Send Add_Server_File  Gthhmgio.File_Number
37106>>>>>>>>>>>>>>>
37106>>>>>>>>>>>>>>>        // External (System) file structure.............
37106>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
37107>>>>>>>>>>>>>>>
37107>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gtypkin_Rec0  To Gtypkin.Gtypkin_Rec0
37110>>>>>>>>>>>>>>>
37110>>>>>>>>>>>>>>>        // Field-based properties.......................
37110>>>>>>>>>>>>>>>
37110>>>>>>>>>>>>>>>        // Gtypkin.Company_Code
37110>>>>>>>>>>>>>>>
37110>>>>>>>>>>>>>>>        // Gtypkin.Branch_Code
37110>>>>>>>>>>>>>>>
37110>>>>>>>>>>>>>>>        // Gtypkin.Year_Year
37110>>>>>>>>>>>>>>>
37110>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Code
37110>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gtypkin.Gtypkin_Code To (gtypkin(Self))
37111>>>>>>>>>>>>>>>
37111>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Rec0
37111>>>>>>>>>>>>>>>
37111>>>>>>>>>>>>>>>        // Gtypkin.Year_Recr
37111>>>>>>>>>>>>>>>
37111>>>>>>>>>>>>>>>        // Gtypkin.Gthhmgio_Code
37111>>>>>>>>>>>>>>>
37111>>>>>>>>>>>>>>>        // Gtypkin.Gthhmgio_Recr
37111>>>>>>>>>>>>>>>
37111>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Descr
37111>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gtypkin.Gtypkin_Descr To (gtypkin(Self))
37112>>>>>>>>>>>>>>>
37112>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Anti
37112>>>>>>>>>>>>>>>
37112>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Printer
37112>>>>>>>>>>>>>>>
37112>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Form
37112>>>>>>>>>>>>>>>
37112>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_L_No
37112>>>>>>>>>>>>>>>
37112>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_L_Hmnia
37112>>>>>>>>>>>>>>>
37112>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Seira
37112>>>>>>>>>>>>>>>
37112>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Abr
37112>>>>>>>>>>>>>>>
37112>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag01
37112>>>>>>>>>>>>>>>
37112>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag02
37112>>>>>>>>>>>>>>>
37112>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag03
37112>>>>>>>>>>>>>>>
37112>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag04
37112>>>>>>>>>>>>>>>
37112>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag05
37112>>>>>>>>>>>>>>>
37112>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag06
37112>>>>>>>>>>>>>>>
37112>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag07
37112>>>>>>>>>>>>>>>
37112>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag08
37112>>>>>>>>>>>>>>>
37112>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag09
37112>>>>>>>>>>>>>>>
37112>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag10
37112>>>>>>>>>>>>>>>
37112>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag11
37112>>>>>>>>>>>>>>>
37112>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag12
37112>>>>>>>>>>>>>>>
37112>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag13
37112>>>>>>>>>>>>>>>
37112>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag14
37112>>>>>>>>>>>>>>>
37112>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag15
37112>>>>>>>>>>>>>>>
37112>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag16
37112>>>>>>>>>>>>>>>
37112>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag17
37112>>>>>>>>>>>>>>>
37112>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag18
37112>>>>>>>>>>>>>>>
37112>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag19
37112>>>>>>>>>>>>>>>
37112>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag20
37112>>>>>>>>>>>>>>>
37112>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Recr
37112>>>>>>>>>>>>>>>
37112>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
37112>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
37113>>>>>>>>>>>>>>>End_Class    // Gtypkin_DataDictionary
37114>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
37114>>>>>>>>>>>>>>>
37114>>>>>>>>>>>>>>>Use gtypkin.SL       // gtypkin
37114>>>>>>>>>>>>>>>
37114>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
37114>>>>>>>>>>>>>>>//DDB-FileEnd
37114>>>>>>>>>>>>>    
37114>>>>>>>>>>>>>    //AB-IgnoreEnd
37114>>>>>>>>>>>>>
37114>>>>>>>>>>>>>    CD_Popup_Object gtypkin is a dbModalPanel
37133>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
37134>>>>>>>>>>>>>        Set Label to "Šå©«˜ ‰ ¤ã©œà¤"
37135>>>>>>>>>>>>>        Set Size to 171 467
37136>>>>>>>>>>>>>        Set Location to 4 5
37137>>>>>>>>>>>>>
37137>>>>>>>>>>>>>        //AB-DDOStart
37137>>>>>>>>>>>>>
37137>>>>>>>>>>>>>        Object Gthhmgio_DD is a Gthhmgio_DataDictionary
37139>>>>>>>>>>>>>        End_Object    // Gthhmgio_DD
37140>>>>>>>>>>>>>
37140>>>>>>>>>>>>>        Object Gtypkin_DD is a Gtypkin_DataDictionary
37142>>>>>>>>>>>>>            Set DDO_Server to (Gthhmgio_DD(self))
37143>>>>>>>>>>>>>        End_Object    // Gtypkin_DD
37144>>>>>>>>>>>>>
37144>>>>>>>>>>>>>        Set Main_DD to (Gtypkin_DD(self))
37145>>>>>>>>>>>>>        Set Server to (Gtypkin_DD(self))
37146>>>>>>>>>>>>>
37146>>>>>>>>>>>>>        //AB-DDOEnd
37146>>>>>>>>>>>>>
37146>>>>>>>>>>>>>        Object oSelList is a dbList
37148>>>>>>>>>>>>>            Set Main_File to Gtypkin.File_Number
37149>>>>>>>>>>>>>            Set Size to 132 450
37150>>>>>>>>>>>>>            Set Location to 6 6
37151>>>>>>>>>>>>>
37151>>>>>>>>>>>>>            Begin_Row
37154>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_code
37155>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_descr
37156>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_abr
37157>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_seira
37158>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_code
37159>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_descr
37160>>>>>>>>>>>>>            End_Row
37165>>>>>>>>>>>>>
37165>>>>>>>>>>>>>            Set Form_Width    item 0 to 40
37166>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
37167>>>>>>>>>>>>>            
37167>>>>>>>>>>>>>            Set Form_Width    item 1 to 150
37168>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
37169>>>>>>>>>>>>>            
37169>>>>>>>>>>>>>            Set Form_Width    item 2 to 68
37170>>>>>>>>>>>>>            Set Header_Label  item 2 to "‘¬¤«¦£¦š¨˜­å˜"
37171>>>>>>>>>>>>>            
37171>>>>>>>>>>>>>            Set Form_Width    item 3 to 30
37172>>>>>>>>>>>>>            Set Header_Label  item 3 to "‘œ ¨á"
37173>>>>>>>>>>>>>            
37173>>>>>>>>>>>>>            Set Form_Width    item 4 to 55
37174>>>>>>>>>>>>>            Set Header_Label  item 4 to "‰à› ¡æª †£/š ¦¬"
37175>>>>>>>>>>>>>            
37175>>>>>>>>>>>>>            Set Form_Width    item 5 to 99
37176>>>>>>>>>>>>>            Set Header_Label  item 5 to "œ¨ š¨˜­ã †£/šå¦¬"
37177>>>>>>>>>>>>>            
37177>>>>>>>>>>>>>        End_Object    // oSelList
37178>>>>>>>>>>>>>
37178>>>>>>>>>>>>>        Object oOK_bn is a Button
37180>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
37181>>>>>>>>>>>>>            Set Location to 140 298
37182>>>>>>>>>>>>>
37182>>>>>>>>>>>>>            //AB-StoreStart
37182>>>>>>>>>>>>>            Procedure OnClick
37184>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
37185>>>>>>>>>>>>>            End_Procedure
37186>>>>>>>>>>>>>            //AB-StoreEnd
37186>>>>>>>>>>>>>
37186>>>>>>>>>>>>>        End_Object    // oOK_bn
37187>>>>>>>>>>>>>
37187>>>>>>>>>>>>>        Object oCancel_bn is a Button
37189>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
37190>>>>>>>>>>>>>            Set Location to 140 353
37191>>>>>>>>>>>>>
37191>>>>>>>>>>>>>            //AB-StoreStart
37191>>>>>>>>>>>>>            Procedure OnClick
37193>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
37194>>>>>>>>>>>>>            End_Procedure
37195>>>>>>>>>>>>>            //AB-StoreEnd
37195>>>>>>>>>>>>>
37195>>>>>>>>>>>>>        End_Object    // oCancel_bn
37196>>>>>>>>>>>>>
37196>>>>>>>>>>>>>        Object oSearch_bn is a Button
37198>>>>>>>>>>>>>            Set Label to "&€¤˜ã«ž©ž..."
37199>>>>>>>>>>>>>            Set Location to 140 408
37200>>>>>>>>>>>>>
37200>>>>>>>>>>>>>            //AB-StoreStart
37200>>>>>>>>>>>>>            Procedure OnClick
37202>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
37203>>>>>>>>>>>>>            End_Procedure
37204>>>>>>>>>>>>>            //AB-StoreEnd
37204>>>>>>>>>>>>>
37204>>>>>>>>>>>>>        End_Object    // oSearch_bn
37205>>>>>>>>>>>>>
37205>>>>>>>>>>>>>
37205>>>>>>>>>>>>>        //AB-StoreStart
37205>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
37206>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
37207>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
37208>>>>>>>>>>>>>        //AB-StoreEnd
37208>>>>>>>>>>>>>
37208>>>>>>>>>>>>>    CD_End_Object    // gtypkin
37210>>>>>>>>>>>>>>
37210>>>>>>>>>>>>>
37210>>>>>>>>>>>>>//AB/     End_Object    // prj
37210>>>>>>>>>>>
37210>>>>>>>>>>>//DDB-Selection-pkg-End
37210>>>>>>>>>>>//DDB-FileEnd
37210>>>>>>>>>
37210>>>>>>>>>//AB-IgnoreEnd
37210>>>>>>>>>
37210>>>>>>>>>CD_Popup_Object sl150 is a dbModalPanel
37229>>>>>>>>>
37229>>>>>>>>>    //AB-StoreTopStart
37229>>>>>>>>>    Property Integer piFragmaLast -1
37231>>>>>>>>>    Property String  psFragmaFromCode ""
37233>>>>>>>>>    Property String  psFragmaToCode ""
37235>>>>>>>>>    
37235>>>>>>>>>    //AB-StoreTopEnd
37235>>>>>>>>>
37235>>>>>>>>>    Set Minimize_Icon to FALSE
37236>>>>>>>>>    Set Label to "Šå©«˜ Š¦š˜¨ ˜©£é¤"
37237>>>>>>>>>    Set Size to 204 393
37238>>>>>>>>>    Set Location to 5 16
37239>>>>>>>>>
37239>>>>>>>>>    //AB-DDOStart
37239>>>>>>>>>
37239>>>>>>>>>    Object Gplan_DD is a Gplan_DataDictionary
37241>>>>>>>>>
37241>>>>>>>>>        //AB-StoreStart
37241>>>>>>>>>                                                    
37241>>>>>>>>>        Procedure OnConstrain
37243>>>>>>>>>            Integer liFragmaLast
37244>>>>>>>>>            String lsFragmaFromCode lsFragmaToCode
37244>>>>>>>>>            Get piFragmaLast     to liFragmaLast
37245>>>>>>>>>            Get psFragmaFromCode to lsFragmaFromCode
37246>>>>>>>>>            Get psFragmaToCode   to lsFragmaToCode
37247>>>>>>>>>            If (liFragmaLast <> -1)     Constrain Gplan.Gplan_Yn_Last eq liFragmaLast
37251>>>>>>>>>            If (lsFragmaFromCode <> "") Constrain Gplan.Gplan_Code    ge lsFragmaFromCode
37255>>>>>>>>>            If (lsFragmaToCode <> "")   Constrain Gplan.Gplan_Code    le lsFragmaToCode
37259>>>>>>>>>        End_Procedure // OnConstrain
37260>>>>>>>>>        
37260>>>>>>>>>        
37260>>>>>>>>>        //AB-StoreEnd
37260>>>>>>>>>
37260>>>>>>>>>    End_Object    // Gplan_DD
37261>>>>>>>>>
37261>>>>>>>>>    Set Main_DD to (Gplan_DD(self))
37262>>>>>>>>>    Set Server to (Gplan_DD(self))
37263>>>>>>>>>
37263>>>>>>>>>    //AB-DDOEnd
37263>>>>>>>>>
37263>>>>>>>>>    Object oSelList is a dbList
37265>>>>>>>>>        Set Main_File to Gplan.File_Number
37266>>>>>>>>>        Set Size to 164 378
37267>>>>>>>>>        Set Location to 4 6
37268>>>>>>>>>
37268>>>>>>>>>        Begin_Row
37271>>>>>>>>>            Entry_Item Gplan.Gplan_code
37272>>>>>>>>>            Entry_Item Gplan.Gplan_descr1
37273>>>>>>>>>            Entry_Item Gplan.Gplan_bathmos
37274>>>>>>>>>            Entry_Item Gplan.Gplan_yn_last
37275>>>>>>>>>        End_Row
37280>>>>>>>>>
37280>>>>>>>>>        Set Form_Width    item 0 to 105
37281>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
37282>>>>>>>>>        
37282>>>>>>>>>        Set Form_Width    item 1 to 212
37283>>>>>>>>>        Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
37284>>>>>>>>>        
37284>>>>>>>>>        Set Form_Width    item 2 to 34
37285>>>>>>>>>        Set Header_Label  item 2 to "˜Ÿ£æª"
37286>>>>>>>>>        
37286>>>>>>>>>        Set Form_Width    item 3 to 19
37287>>>>>>>>>        Set Header_Label  item 3 to " ’"
37288>>>>>>>>>        Set Column_Checkbox_State  item 3 to True
37289>>>>>>>>>        
37289>>>>>>>>>
37289>>>>>>>>>        //AB-StoreStart
37289>>>>>>>>>                                                    
37289>>>>>>>>>        Property String piStoredFragmaLast -1
37291>>>>>>>>>        Property String psStoredFragmaFromCode ""
37293>>>>>>>>>        Property String psStoredFragmaToCode ""
37295>>>>>>>>>        
37295>>>>>>>>>        Procedure Store_Defaults
37297>>>>>>>>>            forward send Store_Defaults
37299>>>>>>>>>            Set piStoredFragmaLast     to (piFragmaLast(Self))
37300>>>>>>>>>            Set psStoredFragmaFromCode to (psFragmaFromCode(Self))
37301>>>>>>>>>            Set psStoredFragmaToCode   to (psFragmaToCode(Self))
37302>>>>>>>>>        end_Procedure // Store_Defaults
37303>>>>>>>>>        
37303>>>>>>>>>        Procedure Restore_Defaults
37305>>>>>>>>>            forward send Restore_Defaults
37307>>>>>>>>>            Set piFragmaLast     to (piStoredFragmaLast(self))
37308>>>>>>>>>            Set psFragmaFromCode to (psStoredFragmaFromCode(self))
37309>>>>>>>>>            Set psFragmaToCode   to (psStoredFragmaToCode(self))
37310>>>>>>>>>        end_Procedure // Restore_Defaults
37311>>>>>>>>>        
37311>>>>>>>>>        Procedure Activating
37313>>>>>>>>>            Forward Send Activating
37315>>>>>>>>>            Send Rebuild_Constraints to (Gplan_DD(self))
37316>>>>>>>>>        End_Procedure // Activating
37317>>>>>>>>>        
37317>>>>>>>>>        
37317>>>>>>>>>        
37317>>>>>>>>>        
37317>>>>>>>>>        //AB-StoreEnd
37317>>>>>>>>>
37317>>>>>>>>>    End_Object    // oSelList
37318>>>>>>>>>
37318>>>>>>>>>    Object oOK_bn is a Button
37320>>>>>>>>>        Set Label to "&„§ ¢¦šã"
37321>>>>>>>>>        Set Location to 170 226
37322>>>>>>>>>
37322>>>>>>>>>        //AB-StoreStart
37322>>>>>>>>>        Procedure OnClick
37324>>>>>>>>>            Send OK To (oSelList(current_object))
37325>>>>>>>>>        End_Procedure
37326>>>>>>>>>        //AB-StoreEnd
37326>>>>>>>>>
37326>>>>>>>>>    End_Object    // oOK_bn
37327>>>>>>>>>
37327>>>>>>>>>    Object oCancel_bn is a Button
37329>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
37330>>>>>>>>>        Set Location to 170 279
37331>>>>>>>>>
37331>>>>>>>>>        //AB-StoreStart
37331>>>>>>>>>        Procedure OnClick
37333>>>>>>>>>            Send Cancel To (oSelList(current_object))
37334>>>>>>>>>        End_Procedure
37335>>>>>>>>>        //AB-StoreEnd
37335>>>>>>>>>
37335>>>>>>>>>    End_Object    // oCancel_bn
37336>>>>>>>>>
37336>>>>>>>>>    Object oSearch_bn is a Button
37338>>>>>>>>>        Set Label to "&€¤˜ã«ž©ž..."
37339>>>>>>>>>        Set Location to 170 334
37340>>>>>>>>>
37340>>>>>>>>>        //AB-StoreStart
37340>>>>>>>>>        Procedure OnClick
37342>>>>>>>>>            Send Search To (oSelList(current_object))
37343>>>>>>>>>        End_Procedure
37344>>>>>>>>>        //AB-StoreEnd
37344>>>>>>>>>
37344>>>>>>>>>    End_Object    // oSearch_bn
37345>>>>>>>>>
37345>>>>>>>>>
37345>>>>>>>>>    //AB-StoreStart
37345>>>>>>>>>                            
37345>>>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
37346>>>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
37347>>>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
37348>>>>>>>>>    
37348>>>>>>>>>    
37348>>>>>>>>>    
37348>>>>>>>>>    //AB-StoreEnd
37348>>>>>>>>>
37348>>>>>>>>>CD_End_Object    // sl150
37350>>>>>>>>>>
37350>>>>>>>>>
37350>>>>>>>>>//AB/ End_Object    // prj
37350>>>>>>>
37350>>>>>>>//DDB-Selection-pkg-End
37350>>>>>>>//DDB-FileEnd
37350>>>>>    Use FPA.DD
INCLUDING FILE: FPA.DD
37350>>>>>>>//DDB-FileStart
37350>>>>>>>//DDB-HeaderStart
37350>>>>>>>
37350>>>>>>>// File Name : FPA.DD
37350>>>>>>>// Class Name: Fpa_DataDictionary
37350>>>>>>>// Revision  : 34
37350>>>>>>>// Version   : 2
37350>>>>>>>
37350>>>>>>>Use  Windows           // Basic Definitions
37350>>>>>>>Use  DataDict          // DataDictionary Class Definition
37350>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
37350>>>>>>>
37350>>>>>>>Open Fpa
INCLUDING FILE: FPA.FD
37352>>>>>>>Open Iteml
37354>>>>>>>Open Partlfpa
INCLUDING FILE: PARTLFPA.FD
37356>>>>>>>Open Item
37358>>>>>>>
37358>>>>>>>//DDB-HeaderEnd
37358>>>>>>>//DDB-SelectionStart
37358>>>>>>>//DDB/ ExternalSelectionList Fpa  Fpa.SL
37358>>>>>>>//DDB/ ExternalSelectionList sl150  sl150.SL
37358>>>>>>>Register_Object Fpa
37358>>>>>>>Register_Object sl150
37358>>>>>>>//DDB-SelectionEnd
37358>>>>>>>
37358>>>>>>>Class Fpa_DataDictionary  is a DataDictionary_Sec
37359>>>>>>> 
37359>>>>>>>    // Validate_Save:
37359>>>>>>> 
37359>>>>>>>    Function Validate_Save  Returns Integer
37360>>>>>>>        Local Integer iReturnVal icheck
37361>>>>>>>        Forward Get Validate_Save  To iReturnVal
37363>>>>>>>        If (Not(iReturnVal)) Begin
37365>>>>>>>            // Insert Code Here
37365>>>>>>>         //  if (fpa.agora_codegl <> '') begin
37365>>>>>>>         //     Move (Check_log(fpa.agora_codegl)) to iCheck  
37365>>>>>>>         //     if (icheck) Move 104001 to iReturnVal 
37365>>>>>>>         //  end
37365>>>>>>>         //  if (fpa.polhsh_codegl <> '') begin
37365>>>>>>>         //     Move (Check_log(fpa.polhsh_codegl)) to iCheck  
37365>>>>>>>         //     if (icheck) Move 104002 to iReturnVal
37365>>>>>>>         //  end   
37365>>>>>>>         //  If (iReturnVal) Send Operation_Not_Allowed iReturnVal
37365>>>>>>>        End
37365>>>>>>>>
37365>>>>>>>        Function_Return iReturnVal
37366>>>>>>>    End_Function   // Validate_Save
37367>>>>>>> 
37367>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
37368>>>>>>>        String lsError_Message
37369>>>>>>>        Case Begin
37369>>>>>>>            Case (iError_Num = 104001)
37371>>>>>>>                Move "DDC 104: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ”..€ ˜š¦¨é¤" to lsError_Message
37372>>>>>>>              Case Break
37373>>>>>>>            Case (iError_Num = 104002)
37376>>>>>>>                Move "DDC 104: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ”..€ §à¢ã©œà¤" to lsError_Message
37377>>>>>>>              Case Break
37378>>>>>>>            Case Else
37378>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
37380>>>>>>>        Case End
37380>>>>>>>        Error iError_Num lsError_Message
37381>>>>>>>>
37381>>>>>>>    End_Procedure // operation_not_allowed
37382>>>>>>>
37382>>>>>>>    // Define_Fields:
37382>>>>>>>    // This procedure is used to set up all data-dictionary rules.
37382>>>>>>>
37382>>>>>>>    Procedure Define_Fields
37383>>>>>>>        Forward Send Define_Fields
37385>>>>>>>        //DDB-Generated-Code-Location
37385>>>>>>>        //DDB-DefineFieldStart
37385>>>>>>>
37385>>>>>>>        Set Main_File            To Fpa.File_Number
37386>>>>>>>        Set Cascade_Delete_State To FALSE
37387>>>>>>>
37387>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
37388>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
37389>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
37390>>>>>>>
37390>>>>>>>        // Child (Client) file structure................
37390>>>>>>>        Send Add_Client_File  Iteml.File_Number
37391>>>>>>>        Send Add_Client_File  Partlfpa.File_Number
37392>>>>>>>        Send Add_Client_File  Item.File_Number
37393>>>>>>>
37393>>>>>>>        // Field-based properties.......................
37393>>>>>>>
37393>>>>>>>        // Fpa.Fpa_Pososto
37393>>>>>>>        Set Field_Options          Field Fpa.Fpa_Pososto To DD_AUTOFIND    DD_REQUIRED   
37394>>>>>>>        Set Field_Prompt_Object    Field Fpa.Fpa_Pososto To (Fpa(Self))
37395>>>>>>>        Set Key_Field_State        Field Fpa.Fpa_Pososto To TRUE
37396>>>>>>>
37396>>>>>>>        // Fpa.Fpa_Descr
37396>>>>>>>        Set Field_Options          Field Fpa.Fpa_Descr To DD_AUTOFIND   
37397>>>>>>>        Set Field_Prompt_Object    Field Fpa.Fpa_Descr To (Fpa(Self))
37398>>>>>>>
37398>>>>>>>        // Fpa.Agora_Codegl
37398>>>>>>>        Set Field_Prompt_Object    Field Fpa.Agora_Codegl To (sl150(Self))
37399>>>>>>>
37399>>>>>>>        // Fpa.Polhsh_Codegl
37399>>>>>>>
37399>>>>>>>        //DDB-DefineFieldEnd
37399>>>>>>>    End_Procedure    // Define_Fields
37400>>>>>>>
37400>>>>>>>    // Field_Defaults:
37400>>>>>>>    // This procedure is used to establish default field values.
37400>>>>>>>
37400>>>>>>>    Procedure Field_Defaults
37401>>>>>>>        Forward Send Field_Defaults
37403>>>>>>>        //DDB-Generated-Code-Location
37403>>>>>>>        //DDB-FieldDefaultStart
37403>>>>>>>        //DDB-FieldDefaultEnd
37403>>>>>>>    End_Procedure    // Field_Defaults
37404>>>>>>>
37404>>>>>>>End_Class    // Fpa_DataDictionary
37405>>>>>>>//DDB-Selection-pkg-Start
37405>>>>>>>
37405>>>>>>>Use Fpa.SL           // Fpa
INCLUDING FILE: FPA.SL
37405>>>>>>>>>//AB/ Project Fpa:Lookup
37405>>>>>>>>>//AB/ Object prj is a Lookup_Project
37405>>>>>>>>>//AB/     Set ProjectName to "Fpa:Lookup"
37405>>>>>>>>>//AB/     Set ProjectFileName to "Fpa.SL"
37405>>>>>>>>>
37405>>>>>>>>>// Project Object Structure
37405>>>>>>>>>//   Fpa is a dbModalPanelSub
37405>>>>>>>>>//     Fpa_DD is a DataDictionary
37405>>>>>>>>>//     oSelList is a dbListSub
37405>>>>>>>>>//     oOK_bn is a ButtonSub
37405>>>>>>>>>//     oCancel_bn is a ButtonSub
37405>>>>>>>>>//     oSearch_bn is a ButtonSub
37405>>>>>>>>>
37405>>>>>>>>>// Register all objects
37405>>>>>>>>>Register_Object Fpa
37405>>>>>>>>>Register_Object Fpa_DD
37405>>>>>>>>>Register_Object oCancel_bn
37405>>>>>>>>>Register_Object oOK_bn
37405>>>>>>>>>Register_Object oSearch_bn
37405>>>>>>>>>Register_Object oSelList
37405>>>>>>>>>
37405>>>>>>>>>
37405>>>>>>>>>//AB-IgnoreStart
37405>>>>>>>>>
37405>>>>>>>>>Use DFAllEnt.pkg
37405>>>>>>>>>Use dbList.Sub
37405>>>>>>>>>Use Button.Sub
37405>>>>>>>>>
37405>>>>>>>>>
37405>>>>>>>>>Use FPA.DD
37405>>>>>>>>>
37405>>>>>>>>>//AB-IgnoreEnd
37405>>>>>>>>>
37405>>>>>>>>>CD_Popup_Object Fpa is a dbModalPanelSub
37424>>>>>>>>>    set label to "¦©¦©«á ”..€." 
37425>>>>>>>>>    Set Size to 148 181
37426>>>>>>>>>    Set Location to 4 5
37427>>>>>>>>>    Set Exit_Application_Local_State to FALSE
37428>>>>>>>>>    Set Modal_State to FALSE
37429>>>>>>>>>
37429>>>>>>>>>    //AB-DDOStart
37429>>>>>>>>>
37429>>>>>>>>>    Object Fpa_DD is a Fpa_DataDictionary
37431>>>>>>>>>    End_Object    // Fpa_DD
37432>>>>>>>>>
37432>>>>>>>>>    Set Main_DD to (Fpa_DD(self))
37433>>>>>>>>>    Set Server to (Fpa_DD(self))
37434>>>>>>>>>
37434>>>>>>>>>    //AB-DDOEnd
37434>>>>>>>>>
37434>>>>>>>>>    Object oSelList is a dbListSub
37436>>>>>>>>>        Set Main_File to Fpa.File_Number
37437>>>>>>>>>        Set Size to 105 165
37438>>>>>>>>>        Set Location to 6 6
37439>>>>>>>>>
37439>>>>>>>>>        Begin_Row
37442>>>>>>>>>            Entry_Item Fpa.Fpa_pososto
37443>>>>>>>>>            Entry_Item Fpa.Fpa_descr
37444>>>>>>>>>        End_Row
37449>>>>>>>>>
37449>>>>>>>>>        Set Form_Width    item 0 to 66
37450>>>>>>>>>        set header_label  item 0 to "% ”€" 
37451>>>>>>>>>        
37451>>>>>>>>>        Set Form_Width    item 1 to 90
37452>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
37453>>>>>>>>>        
37453>>>>>>>>>    End_Object    // oSelList
37454>>>>>>>>>
37454>>>>>>>>>    Object oOK_bn is a ButtonSub
37456>>>>>>>>>        set label to "&„§ ¢¦šã" 
37457>>>>>>>>>        Set Size to 14 46
37458>>>>>>>>>        Set Location to 113 26
37459>>>>>>>>>
37459>>>>>>>>>        //AB-StoreStart
37459>>>>>>>>>        Procedure OnClick
37461>>>>>>>>>            Send OK To (oSelList(current_object))
37462>>>>>>>>>        End_Procedure
37463>>>>>>>>>        //AB-StoreEnd
37463>>>>>>>>>
37463>>>>>>>>>    End_Object    // oOK_bn
37464>>>>>>>>>
37464>>>>>>>>>    Object oCancel_bn is a ButtonSub
37466>>>>>>>>>        set label to "&€¡ç¨à©ž" 
37467>>>>>>>>>        Set Size to 14 46
37468>>>>>>>>>        Set Location to 113 75
37469>>>>>>>>>
37469>>>>>>>>>        //AB-StoreStart
37469>>>>>>>>>        Procedure OnClick
37471>>>>>>>>>            Send Cancel To (oSelList(current_object))
37472>>>>>>>>>        End_Procedure
37473>>>>>>>>>        //AB-StoreEnd
37473>>>>>>>>>
37473>>>>>>>>>    End_Object    // oCancel_bn
37474>>>>>>>>>
37474>>>>>>>>>    Object oSearch_bn is a ButtonSub
37476>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
37477>>>>>>>>>        Set Size to 14 46
37478>>>>>>>>>        Set Location to 113 126
37479>>>>>>>>>
37479>>>>>>>>>        //AB-StoreStart
37479>>>>>>>>>        Procedure OnClick
37481>>>>>>>>>            Send Search To (oSelList(current_object))
37482>>>>>>>>>        End_Procedure
37483>>>>>>>>>        //AB-StoreEnd
37483>>>>>>>>>
37483>>>>>>>>>    End_Object    // oSearch_bn
37484>>>>>>>>>
37484>>>>>>>>>
37484>>>>>>>>>    //AB-StoreStart
37484>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
37485>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
37486>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
37487>>>>>>>>>    //AB-StoreEnd
37487>>>>>>>>>
37487>>>>>>>>>CD_End_Object    // Fpa
37489>>>>>>>>>>
37489>>>>>>>>>
37489>>>>>>>>>//AB/ End_Object    // prj
37489>>>>>>>Use sl150.SL         // sl150
37489>>>>>>>
37489>>>>>>>//DDB-Selection-pkg-End
37489>>>>>>>//DDB-FileEnd
37489>>>>>    Use ITEM.DD
INCLUDING FILE: ITEM.DD
37489>>>>>>>//DDB-FileStart
37489>>>>>>>//DDB-HeaderStart
37489>>>>>>>
37489>>>>>>>// File Name : ITEM.DD
37489>>>>>>>// Class Name: Item_DataDictionary
37489>>>>>>>// Revision  : 53
37489>>>>>>>// Version   : 2
37489>>>>>>>
37489>>>>>>>Use  Windows           // Basic Definitions
37489>>>>>>>Use  DataDict          // DataDictionary Class Definition
37489>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
37489>>>>>>>
37489>>>>>>>Open Item
37491>>>>>>>Open Witemx
37493>>>>>>>Open Itemd
INCLUDING FILE: ITEMD.FD
37495>>>>>>>Open Witemcl
37497>>>>>>>Open Units
37499>>>>>>>Open Witemkat
37501>>>>>>>Open Fpa
37503>>>>>>>Open Sysrecw
37505>>>>>>>Open Witemx
37507>>>>>>>
37507>>>>>>>//DDB-HeaderEnd
37507>>>>>>>//DDB-ValidationStart
37507>>>>>>>
37507>>>>>>>Register_Object Item_Item_Qual_VT
37507>>>>>>>Register_Object Item_Item_Analysh_VT
37507>>>>>>>
37507>>>>>>>Object Item_Item_Qual_VT  is a CodeValidationTable
37509>>>>>>>    Set Type_Value        To "QUAL"
37510>>>>>>>    Set Validate_State    To FALSE
37511>>>>>>>    Set Allow_Blank_State To TRUE
37512>>>>>>>    //DDB-ValidationCustomStart
37512>>>>>>>    //DDB-ValidationCustomEnd
37512>>>>>>>End_Object   // Item_Item_Qual_VT
37513>>>>>>>
37513>>>>>>>Object Item_Item_Analysh_VT  is a CodeValidationTable
37515>>>>>>>    Set Type_Value        To "ITEMANAL"
37516>>>>>>>    Set Table_Title       To "€¤á¢¬©ž „å›¦¬ª"
37517>>>>>>>    //DDB-ValidationCustomStart
37517>>>>>>>    //DDB-ValidationCustomEnd
37517>>>>>>>End_Object   // Item_Item_Analysh_VT
37518>>>>>>>//DDB-ValidationEnd
37518>>>>>>>//DDB-SelectionStart
37518>>>>>>>//DDB/ ExternalSelectionList SL22s  sl22s.sl
37518>>>>>>>//DDB/ ExternalSelectionList sl022  sl022.SL
37518>>>>>>>Register_Object SL22s
37518>>>>>>>Register_Object sl022
37518>>>>>>>//DDB-SelectionEnd
37518>>>>>>>
37518>>>>>>>Class Item_DataDictionary  is a DataDictionary
37519>>>>>>>
37519>>>>>>>    Procedure Update
37520>>>>>>>        Forward Send Update
37522>>>>>>>        Move Witemkat.Witemkat_Code to Item.Witemkat_Code
37523>>>>>>>        Move Units.Units_Code       to Item.Units_Code
37524>>>>>>>    End_Procedure   // Update
37525>>>>>>>
37525>>>>>>>     Procedure Creating
37526>>>>>>>        Date dHmnia
37527>>>>>>>        Forward Send Creating
37529>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Item.Item_Rec0)))))) to Item.Item_Recr
37530>>>>>>>        Clear Witemx
37531>>>>>>>        Move SysCurXR.Company_Code    to Witemx.Company_Code
37532>>>>>>>        Move SysCurXR.Branch_Code     to Witemx.Branch_Code
37533>>>>>>>        Move SysCurXR.Year_Year       to Witemx.Year_Year
37534>>>>>>>        Move SysCurXR.Year_Year       to Witemx.Witemx_YearDesc
37535>>>>>>>        Move SysCurXR.Year_Recr       to Witemx.Year_Recr
37536>>>>>>>        Move Witemkat.Witemkat_Code   to Witemx.Witemkat_Code
37537>>>>>>>        Move Units.Units_Code         to Witemx.Units_Code
37538>>>>>>>        Move Item.Item_Code           to Witemx.Item_Code
37539>>>>>>>        Move Item.Item_Code           to Witemx.Witemx_Code
37540>>>>>>>        Move Item.Item_Descr          to Witemx.Witemx_Descr
37541>>>>>>>        Move Item.Wapokat_Code        to Witemx.ITEM_APOKAT_COD
37542>>>>>>>        Move Item.link1               to Witemx.link1
37543>>>>>>>        Move Item.link2               to Witemx.link2
37544>>>>>>>        Move Item.Item_Recr           to Witemx.Item_Recr
37545>>>>>>>        Move (Sysrecw.Witemx_Rec0+1)  to Witemx.Witemx_Rec0
37546>>>>>>>        Move (Sysrecw.Witemx_Rec0+1)  to Sysrecw.Witemx_Rec0
37547>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                       (Trim(String(Witemx.Witemx_Rec0)))))) ;                                      to Witemx.Witemx_Recr
37548>>>>>>>        Saverecord Sysrecw
37549>>>>>>>        Saverecord Witemx
37550>>>>>>>     End_Procedure   // Creating
37551>>>>>>>
37551>>>>>>>
37551>>>>>>>    // Define_Fields:
37551>>>>>>>    // This procedure is used to set up all data-dictionary rules.
37551>>>>>>>
37551>>>>>>>    Procedure Define_Fields
37552>>>>>>>        Forward Send Define_Fields
37554>>>>>>>        //DDB-Generated-Code-Location
37554>>>>>>>        //DDB-DefineFieldStart
37554>>>>>>>
37554>>>>>>>        Set Main_File            To Item.File_Number
37555>>>>>>>        Set Cascade_Delete_State To FALSE
37556>>>>>>>
37556>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
37557>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
37558>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
37559>>>>>>>
37559>>>>>>>        // Child (Client) file structure................
37559>>>>>>>        Send Add_Client_File  Witemx.File_Number
37560>>>>>>>        Send Add_Client_File  Itemd.File_Number
37561>>>>>>>        Send Add_Client_File  Witemcl.File_Number
37562>>>>>>>
37562>>>>>>>        // Parent (Server) file structure...............
37562>>>>>>>        Send Add_Server_File  Units.File_Number
37563>>>>>>>        Send Add_Server_File  Witemkat.File_Number
37564>>>>>>>        Send Add_Server_File  Fpa.File_Number
37565>>>>>>>
37565>>>>>>>        // External (System) file structure.............
37565>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
37566>>>>>>>        Send Add_System_File  Witemx.File_Number  DD_LOCK_ON_ALL
37567>>>>>>>
37567>>>>>>>        Define_Auto_Increment  Sysrecw.Item_Rec0  To Item.Item_Rec0
37570>>>>>>>
37570>>>>>>>        // Field-based properties.......................
37570>>>>>>>
37570>>>>>>>        // Item.Units_Code
37570>>>>>>>
37570>>>>>>>        // Item.Units_Recr
37570>>>>>>>
37570>>>>>>>        // Item.Witemkat_Code
37570>>>>>>>
37570>>>>>>>        // Item.Witemkat_Recr
37570>>>>>>>
37570>>>>>>>        // Item.Item_Code
37570>>>>>>>        Set Field_Options          Field Item.Item_Code To DD_AUTOFIND   
37571>>>>>>>        Set Field_Prompt_Object    Field Item.Item_Code To (SL22s(Self))
37572>>>>>>>        Set Key_Field_State        Field Item.Item_Code To TRUE
37573>>>>>>>
37573>>>>>>>        // Item.Item_Rec0
37573>>>>>>>        Set Field_Options          Field Item.Item_Rec0 To DD_AUTOFIND   
37574>>>>>>>
37574>>>>>>>        // Item.Item_Descr
37574>>>>>>>        Set Field_Prompt_Object    Field Item.Item_Descr To (SL22s(Self))
37575>>>>>>>
37575>>>>>>>        // Item.Item_Recr
37575>>>>>>>        Set Field_Options          Field Item.Item_Recr To DD_AUTOFIND   
37576>>>>>>>
37576>>>>>>>        // Item.Fpa_Pososto
37576>>>>>>>
37576>>>>>>>        // Item.Item_Qual
37576>>>>>>>        Set Field_Value_Table      Field Item.Item_Qual To (Item_Item_Qual_VT(Self))
37577>>>>>>>
37577>>>>>>>        // Item.Wapokat_Code
37577>>>>>>>        Set Field_Prompt_Object    Field Item.Wapokat_Code To (sl022(Self))
37578>>>>>>>
37578>>>>>>>        // Item.Item_Analysh
37578>>>>>>>        Set Field_Class_Name       Field Item.Item_Analysh To "dbComboFormsub"
37579>>>>>>>        Set Field_Value_Table      Field Item.Item_Analysh To (Item_Item_Analysh_VT(Self))
37580>>>>>>>
37580>>>>>>>        // Item.Item_Orio
37580>>>>>>>
37580>>>>>>>        // Item.Codeglpol
37580>>>>>>>
37580>>>>>>>        // Item.Codeglago
37580>>>>>>>
37580>>>>>>>        // Item.Link1
37580>>>>>>>
37580>>>>>>>        // Item.Link2
37580>>>>>>>
37580>>>>>>>        // Item.Group
37580>>>>>>>
37580>>>>>>>        //DDB-DefineFieldEnd
37580>>>>>>>    End_Procedure    // Define_Fields
37581>>>>>>>
37581>>>>>>>    // Field_Defaults:
37581>>>>>>>    // This procedure is used to establish default field values.
37581>>>>>>>
37581>>>>>>>    Procedure Field_Defaults
37582>>>>>>>        Forward Send Field_Defaults
37584>>>>>>>        //DDB-Generated-Code-Location
37584>>>>>>>        //DDB-FieldDefaultStart
37584>>>>>>>        Set Field_Changed_Value   Field Item.Item_Analysh To "0"
37585>>>>>>>        //DDB-FieldDefaultEnd
37585>>>>>>>    End_Procedure    // Field_Defaults
37586>>>>>>>
37586>>>>>>>End_Class    // Item_DataDictionary
37587>>>>>>>//DDB-Selection-pkg-Start
37587>>>>>>>
37587>>>>>>>Use sl22s.sl         // SL22s
INCLUDING FILE: SL22S.SL
37587>>>>>>>>>//AB/ Project SL22s:ITEM
37587>>>>>>>>>//AB/     Object prj is a Lookup_Project
37587>>>>>>>>>//AB/         Set ProjectName to "SL22s:ITEM"
37587>>>>>>>>>//AB/         Set ProjectFileName to "sl22s.sl"
37587>>>>>>>>>
37587>>>>>>>>>// Project Object Structure
37587>>>>>>>>>//   SL22s is a dbModalPanel
37587>>>>>>>>>//     Witemkat_DD is a DataDictionary
37587>>>>>>>>>//     Units_DD is a DataDictionary
37587>>>>>>>>>//     Fpa_DD is a DataDictionary
37587>>>>>>>>>//     Item_DD is a DataDictionary
37587>>>>>>>>>//     oSelList is a dbListSub
37587>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
37587>>>>>>>>>//     ocode is a FormSub
37587>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
37587>>>>>>>>>//     operi is a FormSub
37587>>>>>>>>>//     RadioGroupSub1 is a RadioGroupSub
37587>>>>>>>>>//       Radio1 is a RadioSub
37587>>>>>>>>>//       Radio2 is a RadioSub
37587>>>>>>>>>//     ButtonSub1 is a ButtonSub
37587>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
37587>>>>>>>>>//     ocodekat is a FormSub
37587>>>>>>>>>//     oOK_bn is a ButtonSub
37587>>>>>>>>>//     oCancel_bn is a ButtonSub
37587>>>>>>>>>//     oSearch_bn is a ButtonSub
37587>>>>>>>>>
37587>>>>>>>>>// Register all objects
37587>>>>>>>>>Register_Object ButtonSub1
37587>>>>>>>>>Register_Object Fpa_DD
37587>>>>>>>>>Register_Object Item_DD
37587>>>>>>>>>Register_Object oCancel_bn
37587>>>>>>>>>Register_Object ocode
37587>>>>>>>>>Register_Object ocodekat
37587>>>>>>>>>Register_Object oOK_bn
37587>>>>>>>>>Register_Object operi
37587>>>>>>>>>Register_Object oSearch_bn
37587>>>>>>>>>Register_Object oSelList
37587>>>>>>>>>Register_Object Radio1
37587>>>>>>>>>Register_Object Radio2
37587>>>>>>>>>Register_Object RadioGroupSub1
37587>>>>>>>>>Register_Object SL22s
37587>>>>>>>>>Register_Object TextBoxSub1
37587>>>>>>>>>Register_Object TextBoxSub2
37587>>>>>>>>>Register_Object TextBoxSub3
37587>>>>>>>>>Register_Object Units_DD
37587>>>>>>>>>Register_Object Witemkat_DD
37587>>>>>>>>>
37587>>>>>>>>>
37587>>>>>>>>>
37587>>>>>>>>>    //AB-StoreTopStart
37587>>>>>>>>>                                
37587>>>>>>>>>                                
37587>>>>>>>>>    //AB-StoreTopEnd
37587>>>>>>>>>
37587>>>>>>>>>    //AB-IgnoreStart
37587>>>>>>>>>
37587>>>>>>>>>    Use DFAllEnt.pkg
37587>>>>>>>>>    Use dbList.Sub
37587>>>>>>>>>    Use Txtbox.Sub
37587>>>>>>>>>    Use Form.Sub
37587>>>>>>>>>    Use Rgroup.Sub
37587>>>>>>>>>    Use Radio.Sub
37587>>>>>>>>>    Use Button.Sub
37587>>>>>>>>>
37587>>>>>>>>>
37587>>>>>>>>>    Use WITEMKAT.DD
37587>>>>>>>>>    Use UNITS.DD
37587>>>>>>>>>    Use FPA.DD
37587>>>>>>>>>    Use ITEM.DD
37587>>>>>>>>>    
37587>>>>>>>>>    //AB-IgnoreEnd
37587>>>>>>>>>
37587>>>>>>>>>    CD_Popup_Object SL22s is a dbModalPanel
37606>>>>>>>>>
37606>>>>>>>>>        //AB-StoreTopStart
37606>>>>>>>>>        Property String     pscode                  ''
37608>>>>>>>>>        Property String     psperi                  ''
37610>>>>>>>>>        Property Integer    piContains_Or_Starts     0
37612>>>>>>>>>        Property String     pscodekat               ''
37614>>>>>>>>>        
37614>>>>>>>>>        //AB-StoreTopEnd
37614>>>>>>>>>
37614>>>>>>>>>        Set Minimize_Icon to FALSE
37615>>>>>>>>>        Set Label to "€¨®œå¦ „ ›é¤"
37616>>>>>>>>>        Set Size to 270 484
37617>>>>>>>>>        Set Location to 5 7
37618>>>>>>>>>
37618>>>>>>>>>        //AB-DDOStart
37618>>>>>>>>>
37618>>>>>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
37620>>>>>>>>>        End_Object    // Witemkat_DD
37621>>>>>>>>>
37621>>>>>>>>>        Object Units_DD is a Units_DataDictionary
37623>>>>>>>>>        End_Object    // Units_DD
37624>>>>>>>>>
37624>>>>>>>>>        Object Fpa_DD is a Fpa_DataDictionary
37626>>>>>>>>>        End_Object    // Fpa_DD
37627>>>>>>>>>
37627>>>>>>>>>        Object Item_DD is a Item_DataDictionary
37629>>>>>>>>>
37629>>>>>>>>>            //AB-StoreTopStart
37629>>>>>>>>>            Function fiPeriexei Returns Integer
37631>>>>>>>>>                       String lsperi lscode  lscodekat
37632>>>>>>>>>                       Integer rVal liContains_Or_Starts
37632>>>>>>>>>                       Move 0 to rVal
37633>>>>>>>>>                       Get piContains_Or_Starts to liContains_Or_Starts
37634>>>>>>>>>                       Get psperi to lsperi
37635>>>>>>>>>                       Get pscode to lscode
37636>>>>>>>>>                       Get pscodekat to lscodekat
37637>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
37638>>>>>>>>>                       Move (Trim(lscode)) to lscode
37639>>>>>>>>>                  //     Move (Trim(lscodekat)) to lscodekat
37639>>>>>>>>>                       If (liContains_Or_Starts=0) Begin
37641>>>>>>>>>                           If ((Trim(item.item_descr)) Contains lsperi) Begin
37643>>>>>>>>>                               If ((Trim(item.item_code)) Contains lscode) Move 1 to rVal
37646>>>>>>>>>                           End
37646>>>>>>>>>>
37646>>>>>>>>>            
37646>>>>>>>>>                       End
37646>>>>>>>>>>
37646>>>>>>>>>                       Else Begin
37647>>>>>>>>>                           If (Left(item.item_descr,(Length(lsperi)))=lsperi) Begin
37649>>>>>>>>>                               If (Left(item.item_code,(Length(lscode)))=lscode) Move 1 to rVal
37652>>>>>>>>>                           End
37652>>>>>>>>>>
37652>>>>>>>>>            
37652>>>>>>>>>                       End
37652>>>>>>>>>>
37652>>>>>>>>>                       Function_Return rVal
37653>>>>>>>>>                   End_Function
37654>>>>>>>>>            
37654>>>>>>>>>                   Function fiArxizeiperi Returns Integer
37656>>>>>>>>>                       String lsperi
37657>>>>>>>>>                       Get psperi to lsperi
37658>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
37659>>>>>>>>>                       Function_Return (Left(item.item_descr,(Length(lsperi)))=lsperi)
37660>>>>>>>>>                   End_Function
37661>>>>>>>>>            
37661>>>>>>>>>                   Function fiArxizeicode Returns Integer
37663>>>>>>>>>                       String lscode lscodekat
37664>>>>>>>>>                       Get pscode to lscode
37665>>>>>>>>>                       Move (Trim(lscode)) to lscode
37666>>>>>>>>>                       Function_Return (Left(item.item_code,(Length(lscode)))=lscode)
37667>>>>>>>>>                   End_Function
37668>>>>>>>>>            
37668>>>>>>>>>            //AB-StoreTopEnd
37668>>>>>>>>>
37668>>>>>>>>>            Set DDO_Server to (Units_DD(self))
37669>>>>>>>>>            Set DDO_Server to (Witemkat_DD(self))
37670>>>>>>>>>            Set DDO_Server to (Fpa_DD(self))
37671>>>>>>>>>
37671>>>>>>>>>            //AB-StoreStart
37671>>>>>>>>>                                                                                                
37671>>>>>>>>>                                                                                                
37671>>>>>>>>>                                                                                                
37671>>>>>>>>>            Begin_Constraints
37673>>>>>>>>>               String lsperi lscode lsvalue lstype lscodekat
37674>>>>>>>>>               Integer liContains_Or_Starts
37674>>>>>>>>>             //  Get FragmaItem  to lsValue
37674>>>>>>>>>            
37674>>>>>>>>>                   Get psperi  to lsperi
37675>>>>>>>>>                   Get pscode  to lscode
37676>>>>>>>>>                   Get pscodekat  to lscodekat
37677>>>>>>>>>                   Get piContains_Or_Starts to liContains_Or_Starts
37678>>>>>>>>>                   Move (Trim(lsperi)) to lsperi
37679>>>>>>>>>                   Move (Trim(lscode)) to lscode
37680>>>>>>>>>                   Move (Trim(lscodekat)) to lscodekat
37681>>>>>>>>>                   If ((lsperi<>'') and (lscode<>'')) begin
37683>>>>>>>>>                        set ordering to 5
37684>>>>>>>>>                        Constrain item as (fiPeriexei(Self)=1)
37685>>>>>>>>>                   end
37685>>>>>>>>>>
37685>>>>>>>>>                   Else Begin
37686>>>>>>>>>                      If (liContains_Or_Starts=0) Begin
37688>>>>>>>>>                        If (lsperi<>'') begin
37690>>>>>>>>>                            set ordering to 3
37691>>>>>>>>>                            Constrain item.item_descr Contains lsperi
37693>>>>>>>>>                        end
37693>>>>>>>>>>
37693>>>>>>>>>                        Else If (lscode<>'') begin
37696>>>>>>>>>                            set ordering to 5
37697>>>>>>>>>                            Constrain item.item_code Contains lscode
37699>>>>>>>>>                        end
37699>>>>>>>>>>
37699>>>>>>>>>                      End
37699>>>>>>>>>>
37699>>>>>>>>>                      Else Begin
37700>>>>>>>>>                           If (lsperi<>'') begin
37702>>>>>>>>>                                set ordering to 3
37703>>>>>>>>>                                Constrain item as (fiArxizeiperi(Self)=1) //item.item_descr
37704>>>>>>>>>                           end
37704>>>>>>>>>>
37704>>>>>>>>>                           Else If (lscode<>'') begin
37707>>>>>>>>>                                set ordering to 5
37708>>>>>>>>>                                Constrain item as (fiArxizeicode(Self)=1) //item.item_code
37709>>>>>>>>>                           end
37709>>>>>>>>>>
37709>>>>>>>>>                      End
37709>>>>>>>>>>
37709>>>>>>>>>                   End
37709>>>>>>>>>>
37709>>>>>>>>>                   If (lscodekat<>'') Constrain item.witemkat_code Contains lscodekat
37713>>>>>>>>>            
37713>>>>>>>>>            End_Constraints
37716>>>>>>>>>            
37716>>>>>>>>>            
37716>>>>>>>>>            
37716>>>>>>>>>            
37716>>>>>>>>>            //AB-StoreEnd
37716>>>>>>>>>
37716>>>>>>>>>        End_Object    // Item_DD
37717>>>>>>>>>
37717>>>>>>>>>        Set Main_DD to (Item_DD(self))
37718>>>>>>>>>        Set Server to (Item_DD(self))
37719>>>>>>>>>
37719>>>>>>>>>        //AB-DDOEnd
37719>>>>>>>>>
37719>>>>>>>>>        Object oSelList is a dbListSub
37721>>>>>>>>>            Set Main_File to Item.File_Number
37722>>>>>>>>>            Set Ordering to 5
37723>>>>>>>>>            Set Size to 190 475
37724>>>>>>>>>            Set Location to -1 2
37725>>>>>>>>>            Set Color to 14280447
37726>>>>>>>>>            Set CurrentRowColor to 11783679
37727>>>>>>>>>            Set CurrentCellColor to 11783679
37728>>>>>>>>>            Set Auto_Index_State to FALSE
37729>>>>>>>>>
37729>>>>>>>>>            Begin_Row
37732>>>>>>>>>                Entry_Item Item.Item_code
37733>>>>>>>>>                Entry_Item Item.Item_descr
37734>>>>>>>>>                Entry_Item Item.Witemkat_code
37735>>>>>>>>>                Entry_Item Witemkat.Witemkat_descr
37736>>>>>>>>>                Entry_Item Item.Item_qual
37737>>>>>>>>>                Entry_Item Fpa.Fpa_pososto
37738>>>>>>>>>            End_Row
37743>>>>>>>>>
37743>>>>>>>>>            Set Form_Width    item 0 to 60
37744>>>>>>>>>            Set Header_Label  item 0 to "‰à›. „å›¦¬ª"
37745>>>>>>>>>            
37745>>>>>>>>>            Set Form_Width    item 1 to 140
37746>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
37747>>>>>>>>>            
37747>>>>>>>>>            Set Form_Width    item 2 to 70
37748>>>>>>>>>            Set Header_Label  item 2 to "‰à›. ‰˜«žš¦¨å˜ª"
37749>>>>>>>>>            
37749>>>>>>>>>            Set Form_Width    item 3 to 88
37750>>>>>>>>>            Set Header_Label  item 3 to "œ¨ š¨˜­ã ‰˜«žš."
37751>>>>>>>>>            
37751>>>>>>>>>            Set Form_Width    item 4 to 64
37752>>>>>>>>>            Set Header_Label  item 4 to "¦ æ«ž«˜"
37753>>>>>>>>>            
37753>>>>>>>>>            Set Form_Width    item 5 to 45
37754>>>>>>>>>            Set Header_Label  item 5 to "‰˜«.”..€"
37755>>>>>>>>>            
37755>>>>>>>>>
37755>>>>>>>>>            //AB-StoreStart
37755>>>>>>>>>            
37755>>>>>>>>>            Property String Store_Fragma_Items public ""
37757>>>>>>>>>            
37757>>>>>>>>>            set export_item_state to true
37758>>>>>>>>>            
37758>>>>>>>>>            Procedure Activating
37760>>>>>>>>>               Forward send Activating
37762>>>>>>>>>               Send Rebuild_Constraints to (Item_DD(Self))
37763>>>>>>>>>            End_Procedure
37764>>>>>>>>>            
37764>>>>>>>>>            Function Child_Exiting Integer iWhere Returns Integer
37766>>>>>>>>>                local integer Rval
37767>>>>>>>>>                Forward get Child_Exiting iWhere  to Rval
37769>>>>>>>>>                set value of (ocode   (self))   to ''
37770>>>>>>>>>                set value of (operi   (self))   to ''
37771>>>>>>>>>                set value of (ocodekat(self))   to ''
37772>>>>>>>>>                set psperi                      to ''
37773>>>>>>>>>                set pscode                      to ''
37774>>>>>>>>>                set pscodekat                   to ''
37775>>>>>>>>>                function_return Rval // if non-zero do not enter
37776>>>>>>>>>            End_function
37777>>>>>>>>>            
37777>>>>>>>>>            
37777>>>>>>>>>            
37777>>>>>>>>>            
37777>>>>>>>>>            
37777>>>>>>>>>            
37777>>>>>>>>>            
37777>>>>>>>>>            
37777>>>>>>>>>            
37777>>>>>>>>>            
37777>>>>>>>>>            
37777>>>>>>>>>            
37777>>>>>>>>>            
37777>>>>>>>>>            
37777>>>>>>>>>            
37777>>>>>>>>>            
37777>>>>>>>>>            
37777>>>>>>>>>            
37777>>>>>>>>>            
37777>>>>>>>>>            
37777>>>>>>>>>            //AB-StoreEnd
37777>>>>>>>>>
37777>>>>>>>>>        End_Object    // oSelList
37778>>>>>>>>>
37778>>>>>>>>>        Object TextBoxSub1 is a TextBoxSub
37780>>>>>>>>>            Set Label to "‘á¨à©ž ‰à› ¡¦ç ‚ á"
37781>>>>>>>>>            Set Auto_Size_State to FALSE
37782>>>>>>>>>            Set Location to 192 6
37783>>>>>>>>>            Set Size to 13 78
37784>>>>>>>>>        End_Object    // TextBoxSub1
37785>>>>>>>>>
37785>>>>>>>>>        Object ocode is a FormSub
37787>>>>>>>>>            Set Size to 13 197
37788>>>>>>>>>            Set Location to 192 79
37789>>>>>>>>>            Set Label_Col_Offset to 2
37790>>>>>>>>>
37790>>>>>>>>>            //AB-StoreStart
37790>>>>>>>>>                                                
37790>>>>>>>>>            Procedure OnKILLFOCUS
37792>>>>>>>>>                Send KeyAction to ButtonSub1
37793>>>>>>>>>            End_Procedure
37794>>>>>>>>>            
37794>>>>>>>>>            
37794>>>>>>>>>            
37794>>>>>>>>>            
37794>>>>>>>>>            //AB-StoreEnd
37794>>>>>>>>>
37794>>>>>>>>>        End_Object    // ocode
37795>>>>>>>>>
37795>>>>>>>>>        Object TextBoxSub2 is a TextBoxSub
37797>>>>>>>>>            Set Label to "‘á¨à©ž œ¨ š¨˜­ãª "
37798>>>>>>>>>            Set Auto_Size_State to FALSE
37799>>>>>>>>>            Set Location to 207 6
37800>>>>>>>>>            Set Size to 13 83
37801>>>>>>>>>        End_Object    // TextBoxSub2
37802>>>>>>>>>
37802>>>>>>>>>        Object operi is a FormSub
37804>>>>>>>>>            Set Size to 13 197
37805>>>>>>>>>            Set Location to 207 79
37806>>>>>>>>>            Set Label_Col_Offset to 2
37807>>>>>>>>>
37807>>>>>>>>>            //AB-StoreStart
37807>>>>>>>>>                                                
37807>>>>>>>>>            Procedure OnKILLFOCUS
37809>>>>>>>>>                Send KeyAction to ButtonSub1
37810>>>>>>>>>            End_Procedure
37811>>>>>>>>>            
37811>>>>>>>>>            
37811>>>>>>>>>            
37811>>>>>>>>>            
37811>>>>>>>>>            //AB-StoreEnd
37811>>>>>>>>>
37811>>>>>>>>>        End_Object    // operi
37812>>>>>>>>>
37812>>>>>>>>>        Object RadioGroupSub1 is a RadioGroupSub
37814>>>>>>>>>            Set Size to 32 77
37815>>>>>>>>>            Set Location to 193 277
37816>>>>>>>>>            Object Radio1 is a RadioSub
37818>>>>>>>>>                Set Label to "œ¨ â®œ«˜ "
37819>>>>>>>>>                Set Size to 10 53
37820>>>>>>>>>                Set Location to 7 5
37821>>>>>>>>>            End_Object    // Radio1
37822>>>>>>>>>
37822>>>>>>>>>            Object Radio2 is a RadioSub
37824>>>>>>>>>                Set Label to "€¨®åœ  €§æ"
37825>>>>>>>>>                Set Size to 10 51
37826>>>>>>>>>                Set Location to 21 5
37827>>>>>>>>>            End_Object    // Radio2
37828>>>>>>>>>
37828>>>>>>>>>
37828>>>>>>>>>            //AB-StoreStart
37828>>>>>>>>>                                                
37828>>>>>>>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
37830>>>>>>>>>                Set piContains_Or_Starts to iToItem
37831>>>>>>>>>                Send KeyAction to ButtonSub1
37832>>>>>>>>>            End_Procedure
37833>>>>>>>>>            
37833>>>>>>>>>            
37833>>>>>>>>>            
37833>>>>>>>>>            
37833>>>>>>>>>            //AB-StoreEnd
37833>>>>>>>>>
37833>>>>>>>>>        End_Object    // RadioGroupSub1
37834>>>>>>>>>
37834>>>>>>>>>        Object ButtonSub1 is a ButtonSub
37836>>>>>>>>>            Set Label to "Search"
37837>>>>>>>>>            Set Size to 28 37
37838>>>>>>>>>            Set Location to 198 357
37839>>>>>>>>>            Set Form_FontWeight Item 0 to 800
37840>>>>>>>>>            Set Form_TypeFace Item 0 to "ms sans serif"
37841>>>>>>>>>
37841>>>>>>>>>            //AB-StoreStart
37841>>>>>>>>>                                                                                                
37841>>>>>>>>>            Set Visible_State to False
37842>>>>>>>>>            
37842>>>>>>>>>            Procedure OnClick
37844>>>>>>>>>                Forward Send OnClick
37846>>>>>>>>>                Set pscode  to (Value(ocode(Self),0))
37847>>>>>>>>>                Set psperi  to (Value(operi(Self),0))
37848>>>>>>>>>                Set pscodekat  to (Value(ocodekat(Self),0))
37849>>>>>>>>>                send Rebuild_Constraints    to (item_DD(Self))
37850>>>>>>>>>                Send Beginning_Of_Data      to oSelList True
37851>>>>>>>>>            End_Procedure // OnClick
37852>>>>>>>>>            
37852>>>>>>>>>            
37852>>>>>>>>>            
37852>>>>>>>>>            
37852>>>>>>>>>            
37852>>>>>>>>>            
37852>>>>>>>>>            
37852>>>>>>>>>            
37852>>>>>>>>>            
37852>>>>>>>>>            
37852>>>>>>>>>            
37852>>>>>>>>>            
37852>>>>>>>>>            
37852>>>>>>>>>            //AB-StoreEnd
37852>>>>>>>>>
37852>>>>>>>>>        End_Object    // ButtonSub1
37853>>>>>>>>>
37853>>>>>>>>>        Object TextBoxSub3 is a TextBoxSub
37855>>>>>>>>>            Set Label to "‰à›.‰˜«žš¦¨å˜ª ‚ á"
37856>>>>>>>>>            Set Auto_Size_State to FALSE
37857>>>>>>>>>            Set Location to 221 5
37858>>>>>>>>>            Set Size to 13 78
37859>>>>>>>>>        End_Object    // TextBoxSub3
37860>>>>>>>>>
37860>>>>>>>>>        Object ocodekat is a FormSub
37862>>>>>>>>>            Set Size to 13 197
37863>>>>>>>>>            Set Location to 221 78
37864>>>>>>>>>            Set Label_Col_Offset to 2
37865>>>>>>>>>
37865>>>>>>>>>            //AB-StoreStart
37865>>>>>>>>>                                                
37865>>>>>>>>>            Procedure OnKILLFOCUS
37867>>>>>>>>>               Send KeyAction to ButtonSub1
37868>>>>>>>>>            End_Procedure
37869>>>>>>>>>            
37869>>>>>>>>>            
37869>>>>>>>>>            
37869>>>>>>>>>            //AB-StoreEnd
37869>>>>>>>>>
37869>>>>>>>>>        End_Object    // ocodekat
37870>>>>>>>>>
37870>>>>>>>>>        Object oOK_bn is a ButtonSub
37872>>>>>>>>>            Set Label to "&„§ ¢¦šã"
37873>>>>>>>>>            Set Location to 237 316
37874>>>>>>>>>
37874>>>>>>>>>            //AB-StoreStart
37874>>>>>>>>>            Procedure OnClick
37876>>>>>>>>>                Send OK To (oSelList(current_object))
37877>>>>>>>>>            End_Procedure
37878>>>>>>>>>            //AB-StoreEnd
37878>>>>>>>>>
37878>>>>>>>>>        End_Object    // oOK_bn
37879>>>>>>>>>
37879>>>>>>>>>        Object oCancel_bn is a ButtonSub
37881>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
37882>>>>>>>>>            Set Location to 237 371
37883>>>>>>>>>
37883>>>>>>>>>            //AB-StoreStart
37883>>>>>>>>>            Procedure OnClick
37885>>>>>>>>>                Send Cancel To (oSelList(current_object))
37886>>>>>>>>>            End_Procedure
37887>>>>>>>>>            //AB-StoreEnd
37887>>>>>>>>>
37887>>>>>>>>>        End_Object    // oCancel_bn
37888>>>>>>>>>
37888>>>>>>>>>        Object oSearch_bn is a ButtonSub
37890>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
37891>>>>>>>>>            Set Location to 237 426
37892>>>>>>>>>
37892>>>>>>>>>            //AB-StoreStart
37892>>>>>>>>>            Procedure OnClick
37894>>>>>>>>>                Send Search To (oSelList(current_object))
37895>>>>>>>>>            End_Procedure
37896>>>>>>>>>            //AB-StoreEnd
37896>>>>>>>>>
37896>>>>>>>>>        End_Object    // oSearch_bn
37897>>>>>>>>>
37897>>>>>>>>>
37897>>>>>>>>>        //AB-StoreStart
37897>>>>>>>>>                
37897>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
37898>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
37899>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
37900>>>>>>>>>        
37900>>>>>>>>>        Set Locate_Mode to Center_On_Screen
37901>>>>>>>>>        
37901>>>>>>>>>        
37901>>>>>>>>>        
37901>>>>>>>>>        
37901>>>>>>>>>        
37901>>>>>>>>>        
37901>>>>>>>>>        
37901>>>>>>>>>        
37901>>>>>>>>>        
37901>>>>>>>>>        
37901>>>>>>>>>        
37901>>>>>>>>>        
37901>>>>>>>>>        //AB-StoreEnd
37901>>>>>>>>>
37901>>>>>>>>>    CD_End_Object    // SL22s
37903>>>>>>>>>>
37903>>>>>>>>>
37903>>>>>>>>>
37903>>>>>>>>>    //AB-StoreStart
37903>>>>>>>>>                                
37903>>>>>>>>>                                
37903>>>>>>>>>                                
37903>>>>>>>>>                                
37903>>>>>>>>>                                
37903>>>>>>>>>                                
37903>>>>>>>>>                                
37903>>>>>>>>>                                
37903>>>>>>>>>                                
37903>>>>>>>>>                                
37903>>>>>>>>>    //AB-StoreEnd
37903>>>>>>>>>
37903>>>>>>>>>//AB/     End_Object    // prj
37903>>>>>>>Use sl022.SL         // sl022
INCLUDING FILE: SL022.SL
37903>>>>>>>>>//AB/ Project sl022:kathg-apothkon
37903>>>>>>>>>//AB/ Object prj is a Lookup_Project
37903>>>>>>>>>//AB/     Set ProjectName to "sl022:kathg-apothkon"
37903>>>>>>>>>//AB/     Set ProjectFileName to "sl022.SL"
37903>>>>>>>>>
37903>>>>>>>>>// Project Object Structure
37903>>>>>>>>>//   sl022 is a dbModalPanelSub
37903>>>>>>>>>//     Wapokat_DD is a DataDictionary
37903>>>>>>>>>//     oSelList is a dbListSub
37903>>>>>>>>>//     oOK_bn is a ButtonSub
37903>>>>>>>>>//     oCancel_bn is a ButtonSub
37903>>>>>>>>>//     oSearch_bn is a ButtonSub
37903>>>>>>>>>
37903>>>>>>>>>// Register all objects
37903>>>>>>>>>Register_Object oCancel_bn
37903>>>>>>>>>Register_Object oOK_bn
37903>>>>>>>>>Register_Object oSearch_bn
37903>>>>>>>>>Register_Object oSelList
37903>>>>>>>>>Register_Object sl022
37903>>>>>>>>>Register_Object Wapokat_DD
37903>>>>>>>>>
37903>>>>>>>>>
37903>>>>>>>>>//AB-IgnoreStart
37903>>>>>>>>>
37903>>>>>>>>>Use DFAllEnt.pkg
37903>>>>>>>>>Use dbList.Sub
37903>>>>>>>>>Use Button.Sub
37903>>>>>>>>>
37903>>>>>>>>>
37903>>>>>>>>>Use WAPOKAT.DD
INCLUDING FILE: WAPOKAT.DD
37903>>>>>>>>>>>//DDB-FileStart
37903>>>>>>>>>>>//DDB-HeaderStart
37903>>>>>>>>>>>
37903>>>>>>>>>>>// File Name : WAPOKAT.DD
37903>>>>>>>>>>>// Class Name: Wapokat_DataDictionary
37903>>>>>>>>>>>// Revision  : 13
37903>>>>>>>>>>>// Version   : 2
37903>>>>>>>>>>>
37903>>>>>>>>>>>Use  Windows           // Basic Definitions
37903>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
37903>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
37903>>>>>>>>>>>
37903>>>>>>>>>>>Open Wapokat
INCLUDING FILE: WAPOKAT.FD
37905>>>>>>>>>>>Open Wapomast
INCLUDING FILE: WAPOMAST.FD
37907>>>>>>>>>>>Open Sysrecw
37909>>>>>>>>>>>Open Syscurxr
37911>>>>>>>>>>>
37911>>>>>>>>>>>//DDB-HeaderEnd
37911>>>>>>>>>>>//DDB-SelectionStart
37911>>>>>>>>>>>//DDB/ ExternalSelectionList sl022  sl022.SL
37911>>>>>>>>>>>Register_Object sl022
37911>>>>>>>>>>>//DDB-SelectionEnd
37911>>>>>>>>>>>
37911>>>>>>>>>>>Class Wapokat_DataDictionary  is a DataDictionary
37912>>>>>>>>>>>
37912>>>>>>>>>>>    // Update:
37912>>>>>>>>>>>    Procedure Update
37913>>>>>>>>>>>        Forward Send Update
37915>>>>>>>>>>>        // Insert Code Here
37915>>>>>>>>>>>//        Move SysCurXR.Company_Code   to Wapokat.Company_Code
37915>>>>>>>>>>>//        Move SysCurXR.Branch_Code     to Wapokat.Branch_Code
37915>>>>>>>>>>>//        Move SysCurXR.Year_Year         to Wapokat.Year_Year
37915>>>>>>>>>>>    End_Procedure   // Update
37916>>>>>>>>>>> 
37916>>>>>>>>>>>     Procedure Creating
37917>>>>>>>>>>>        Forward Send Creating
37919>>>>>>>>>>>        // Insert Code Here
37919>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wapokat.Wapokat_Rec0)))))) to Wapokat.Wapokat_Recr
37920>>>>>>>>>>>    End_Procedure   // Creating
37921>>>>>>>>>>>
37921>>>>>>>>>>>
37921>>>>>>>>>>>    // Define_Fields:
37921>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
37921>>>>>>>>>>>
37921>>>>>>>>>>>    Procedure Define_Fields
37922>>>>>>>>>>>        Forward Send Define_Fields
37924>>>>>>>>>>>        //DDB-Generated-Code-Location
37924>>>>>>>>>>>        //DDB-DefineFieldStart
37924>>>>>>>>>>>
37924>>>>>>>>>>>        Set Main_File            To Wapokat.File_Number
37925>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
37926>>>>>>>>>>>
37926>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
37927>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
37928>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
37929>>>>>>>>>>>
37929>>>>>>>>>>>        // Child (Client) file structure................
37929>>>>>>>>>>>        Send Add_Client_File  Wapomast.File_Number
37930>>>>>>>>>>>
37930>>>>>>>>>>>        // External (System) file structure.............
37930>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
37931>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
37932>>>>>>>>>>>
37932>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Wapokat_Rec0  To Wapokat.Wapokat_Rec0
37935>>>>>>>>>>>
37935>>>>>>>>>>>        // Field-based properties.......................
37935>>>>>>>>>>>
37935>>>>>>>>>>>        // Wapokat.Wapokat_Code
37935>>>>>>>>>>>        Set Field_Options          Field Wapokat.Wapokat_Code To DD_AUTOFIND   
37936>>>>>>>>>>>        Set Field_Prompt_Object    Field Wapokat.Wapokat_Code To (sl022(Self))
37937>>>>>>>>>>>
37937>>>>>>>>>>>        // Wapokat.Wapokat_Rec0
37937>>>>>>>>>>>        Set Field_Options          Field Wapokat.Wapokat_Rec0 To DD_AUTOFIND   
37938>>>>>>>>>>>
37938>>>>>>>>>>>        // Wapokat.Wapokat_Descr
37938>>>>>>>>>>>        Set Field_Prompt_Object    Field Wapokat.Wapokat_Descr To (sl022(Self))
37939>>>>>>>>>>>
37939>>>>>>>>>>>        // Wapokat.Wapokat_Recr
37939>>>>>>>>>>>        Set Field_Options          Field Wapokat.Wapokat_Recr To DD_AUTOFIND   
37940>>>>>>>>>>>
37940>>>>>>>>>>>        //DDB-DefineFieldEnd
37940>>>>>>>>>>>    End_Procedure    // Define_Fields
37941>>>>>>>>>>>
37941>>>>>>>>>>>    // Field_Defaults:
37941>>>>>>>>>>>    // This procedure is used to establish default field values.
37941>>>>>>>>>>>
37941>>>>>>>>>>>    Procedure Field_Defaults
37942>>>>>>>>>>>        Forward Send Field_Defaults
37944>>>>>>>>>>>        //DDB-Generated-Code-Location
37944>>>>>>>>>>>        //DDB-FieldDefaultStart
37944>>>>>>>>>>>        //DDB-FieldDefaultEnd
37944>>>>>>>>>>>    End_Procedure    // Field_Defaults
37945>>>>>>>>>>>
37945>>>>>>>>>>>End_Class    // Wapokat_DataDictionary
37946>>>>>>>>>>>//DDB-Selection-pkg-Start
37946>>>>>>>>>>>
37946>>>>>>>>>>>Use sl022.SL         // sl022
37946>>>>>>>>>>>
37946>>>>>>>>>>>//DDB-Selection-pkg-End
37946>>>>>>>>>>>//DDB-FileEnd
37946>>>>>>>>>
37946>>>>>>>>>//AB-IgnoreEnd
37946>>>>>>>>>
37946>>>>>>>>>CD_Popup_Object sl022 is a dbModalPanelSub
37965>>>>>>>>>    set label to "‰˜«žš¦¨åœª €§¦Ÿž¡é¤" 
37966>>>>>>>>>    Set Size to 148 297
37967>>>>>>>>>    Set Location to 12 19
37968>>>>>>>>>    Set Exit_Application_Local_State to FALSE
37969>>>>>>>>>    Set Modal_State to FALSE
37970>>>>>>>>>
37970>>>>>>>>>    //AB-DDOStart
37970>>>>>>>>>
37970>>>>>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
37972>>>>>>>>>    End_Object    // Wapokat_DD
37973>>>>>>>>>
37973>>>>>>>>>    Set Main_DD to (Wapokat_DD(self))
37974>>>>>>>>>    Set Server to (Wapokat_DD(self))
37975>>>>>>>>>
37975>>>>>>>>>    //AB-DDOEnd
37975>>>>>>>>>
37975>>>>>>>>>    Object oSelList is a dbListSub
37977>>>>>>>>>        Set Main_File to Wapokat.File_Number
37978>>>>>>>>>        Set Size to 105 280
37979>>>>>>>>>        Set Location to 6 6
37980>>>>>>>>>
37980>>>>>>>>>        Begin_Row
37983>>>>>>>>>            Entry_Item Wapokat.Wapokat_code
37984>>>>>>>>>            Entry_Item Wapokat.Wapokat_descr
37985>>>>>>>>>        End_Row
37990>>>>>>>>>
37990>>>>>>>>>        Set Form_Width    item 0 to 42
37991>>>>>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
37992>>>>>>>>>        
37992>>>>>>>>>        Set Form_Width    item 1 to 228
37993>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
37994>>>>>>>>>        
37994>>>>>>>>>    End_Object    // oSelList
37995>>>>>>>>>
37995>>>>>>>>>    Object oOK_bn is a ButtonSub
37997>>>>>>>>>        set label to "&„§ ¢¦šã" 
37998>>>>>>>>>        Set Location to 115 126
37999>>>>>>>>>
37999>>>>>>>>>        //AB-StoreStart
37999>>>>>>>>>        Procedure OnClick
38001>>>>>>>>>            Send OK To (oSelList(current_object))
38002>>>>>>>>>        End_Procedure
38003>>>>>>>>>        //AB-StoreEnd
38003>>>>>>>>>
38003>>>>>>>>>    End_Object    // oOK_bn
38004>>>>>>>>>
38004>>>>>>>>>    Object oCancel_bn is a ButtonSub
38006>>>>>>>>>        set label to "&€¡ç¨à©ž" 
38007>>>>>>>>>        Set Location to 115 181
38008>>>>>>>>>
38008>>>>>>>>>        //AB-StoreStart
38008>>>>>>>>>        Procedure OnClick
38010>>>>>>>>>            Send Cancel To (oSelList(current_object))
38011>>>>>>>>>        End_Procedure
38012>>>>>>>>>        //AB-StoreEnd
38012>>>>>>>>>
38012>>>>>>>>>    End_Object    // oCancel_bn
38013>>>>>>>>>
38013>>>>>>>>>    Object oSearch_bn is a ButtonSub
38015>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
38016>>>>>>>>>        Set Location to 115 236
38017>>>>>>>>>
38017>>>>>>>>>        //AB-StoreStart
38017>>>>>>>>>        Procedure OnClick
38019>>>>>>>>>            Send Search To (oSelList(current_object))
38020>>>>>>>>>        End_Procedure
38021>>>>>>>>>        //AB-StoreEnd
38021>>>>>>>>>
38021>>>>>>>>>    End_Object    // oSearch_bn
38022>>>>>>>>>
38022>>>>>>>>>
38022>>>>>>>>>    //AB-StoreStart
38022>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
38023>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
38024>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
38025>>>>>>>>>    //AB-StoreEnd
38025>>>>>>>>>
38025>>>>>>>>>CD_End_Object    // sl022
38027>>>>>>>>>>
38027>>>>>>>>>
38027>>>>>>>>>//AB/ End_Object    // prj
38027>>>>>>>
38027>>>>>>>//DDB-Selection-pkg-End
38027>>>>>>>//DDB-FileEnd
38027>>>>>    Use WITEMX.DD
INCLUDING FILE: WITEMX.DD
38027>>>>>>>//DDB-FileStart
38027>>>>>>>//DDB-HeaderStart
38027>>>>>>>
38027>>>>>>>// File Name : WITEMX.DD
38027>>>>>>>// Class Name: Witemx_DataDictionary
38027>>>>>>>// Revision  : 75
38027>>>>>>>// Version   : 2
38027>>>>>>>
38027>>>>>>>Use  Windows           // Basic Definitions
38027>>>>>>>Use  DataDict          // DataDictionary Class Definition
38027>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38027>>>>>>>
38027>>>>>>>Open Witemx
38029>>>>>>>Open Wcmoves
INCLUDING FILE: WCMOVES.FD
38031>>>>>>>Open Witemxt
38033>>>>>>>Open Pmoves
INCLUDING FILE: PMOVES.FD
38035>>>>>>>Open Wam
INCLUDING FILE: WAM.FD
38037>>>>>>>Open Pmovesl
INCLUDING FILE: PMOVESL.FD
38039>>>>>>>Open Witemxen
INCLUDING FILE: WITEMXEN.FD
38041>>>>>>>Open Camovedd
INCLUDING FILE: CAMOVEDD.FD
38043>>>>>>>Open Item
38045>>>>>>>Open Sysrecw
38047>>>>>>>Open Syscurxr
38049>>>>>>>
38049>>>>>>>//DDB-HeaderEnd
38049>>>>>>>//DDB-SelectionStart
38049>>>>>>>//DDB/ ExternalSelectionList SL17  sl17.SL
38049>>>>>>>Register_Object SL17
38049>>>>>>>//DDB-SelectionEnd
38049>>>>>>>
38049>>>>>>>Class Witemx_DataDictionary  is a DataDictionary
38050>>>>>>>
38050>>>>>>>    Procedure Construct_Object
38051>>>>>>>        Forward Send Construct_Object
38053>>>>>>>        Property Integer piMustNOTConstrain Public 0
38054>>>>>>>    End_Procedure //construct_object
38055>>>>>>>
38055>>>>>>>    Procedure OnConstrain
38056>>>>>>>        Forward Send OnConstrain
38058>>>>>>>        If (piMustNOTConstrain(Self)) Begin
38060>>>>>>>        End
38060>>>>>>>>
38060>>>>>>>        Else Begin
38061>>>>>>>            Constrain Witemx.Company_Code  eq SysCurXR.Company_Code
38063>>>>>>>            Constrain Witemx.Branch_Code   eq SysCurXR.Branch_Code
38065>>>>>>>            Constrain Witemx.Year_Year     eq SysCurXR.Year_Year
38067>>>>>>>        End
38067>>>>>>>>
38067>>>>>>>    End_Procedure
38068>>>>>>>
38068>>>>>>>    Procedure Save_Main_File
38069>>>>>>>        If (Operation_Origin<>Self) Begin
38071>>>>>>>            If Witemx.Recnum Eq 0 Procedure_Return
38074>>>>>>>        End
38074>>>>>>>>
38074>>>>>>>        Forward Send Save_Main_File
38076>>>>>>>    End_Procedure
38077>>>>>>>
38077>>>>>>>    // Update:
38077>>>>>>>    Procedure Update
38078>>>>>>>        Forward Send Update
38080>>>>>>>        // Insert Code Here
38080>>>>>>>        Move SysCurXR.Company_Code  to Witemx.Company_Code
38081>>>>>>>        Move SysCurXR.Branch_Code   to Witemx.Branch_Code
38082>>>>>>>        Move SysCurXR.Year_Year     to Witemx.Year_Year
38083>>>>>>>        Move SysCurXR.Year_Recr     to Witemx.Year_Recr
38084>>>>>>>        Move Witemkat.Witemkat_Code to Witemx.Witemkat_Code
38085>>>>>>>        Move Units.Units_Code       to Witemx.Units_Code
38086>>>>>>>        Move Item.Item_Code         to Witemx.Item_Code
38087>>>>>>>        Move Item.Item_Code         to Witemx.Witemx_Code
38088>>>>>>>        Move Item.Item_Descr        to Witemx.Witemx_Descr
38089>>>>>>>        Move Item.Wapokat_Code      to Witemx.ITEM_APOKAT_COD 
38090>>>>>>>        Move Item.link1             to witemx.link1
38091>>>>>>>        move Item.link2             to witemx.link2
38092>>>>>>>        Move (Round_Number((Witemx.Axia_Xre/Witemx.Qty_Xre),4))  to Witemx.Mesosta_Xre
38093>>>>>>>        Move (Round_Number((Witemx.Axia_Pis/Witemx.Qty_Pis),4))  to Witemx.Mesosta_Pis
38094>>>>>>>    End_Procedure   // Update
38095>>>>>>>
38095>>>>>>>
38095>>>>>>>    Procedure Backout
38096>>>>>>>        Forward Send Backout
38098>>>>>>>        Move (Round_Number((Witemx.Axia_Xre/Witemx.Qty_Xre),4))  to Witemx.Mesosta_Xre
38099>>>>>>>        Move (Round_Number((Witemx.Axia_Pis/Witemx.Qty_Pis),4))  to Witemx.Mesosta_Pis
38100>>>>>>>    End_Procedure   // Update
38101>>>>>>>
38101>>>>>>>    Procedure Creating
38102>>>>>>>        Forward Send Creating
38104>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                       (Trim(String(Witemx.Witemx_Rec0)))))) to Witemx.Witemx_Recr
38105>>>>>>>    End_Procedure   // Creating
38106>>>>>>>
38106>>>>>>>
38106>>>>>>>
38106>>>>>>>    // Define_Fields:
38106>>>>>>>    // This procedure is used to set up all data-dictionary rules.
38106>>>>>>>
38106>>>>>>>    Procedure Define_Fields
38107>>>>>>>        Forward Send Define_Fields
38109>>>>>>>        //DDB-Generated-Code-Location
38109>>>>>>>        //DDB-DefineFieldStart
38109>>>>>>>
38109>>>>>>>        Set Main_File            To Witemx.File_Number
38110>>>>>>>        Set Cascade_Delete_State To FALSE
38111>>>>>>>
38111>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
38112>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
38113>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38114>>>>>>>
38114>>>>>>>        // Child (Client) file structure................
38114>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
38115>>>>>>>        Send Add_Client_File  Witemxt.File_Number
38116>>>>>>>        Send Add_Client_File  Pmoves.File_Number
38117>>>>>>>        Send Add_Client_File  Wam.File_Number
38118>>>>>>>        Send Add_Client_File  Pmovesl.File_Number
38119>>>>>>>        Send Add_Client_File  Witemxen.File_Number
38120>>>>>>>        Send Add_Client_File  Camovedd.File_Number
38121>>>>>>>
38121>>>>>>>        // Parent (Server) file structure...............
38121>>>>>>>        Send Add_Server_File  Item.File_Number
38122>>>>>>>
38122>>>>>>>        // External (System) file structure.............
38122>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
38123>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
38124>>>>>>>
38124>>>>>>>        Define_Auto_Increment  Sysrecw.Witemx_Rec0  To Witemx.Witemx_Rec0
38127>>>>>>>
38127>>>>>>>        // Field-based properties.......................
38127>>>>>>>
38127>>>>>>>        // Witemx.Company_Code
38127>>>>>>>
38127>>>>>>>        // Witemx.Branch_Code
38127>>>>>>>
38127>>>>>>>        // Witemx.Year_Year
38127>>>>>>>
38127>>>>>>>        // Witemx.Units_Code
38127>>>>>>>
38127>>>>>>>        // Witemx.Witemkat_Code
38127>>>>>>>
38127>>>>>>>        // Witemx.Item_Code
38127>>>>>>>
38127>>>>>>>        // Witemx.Witemx_Code
38127>>>>>>>        Set Field_Options          Field Witemx.Witemx_Code To DD_AUTOFIND   
38128>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Code To (SL17(Self))
38129>>>>>>>        Set Key_Field_State        Field Witemx.Witemx_Code To TRUE
38130>>>>>>>
38130>>>>>>>        // Witemx.Witemx_Recr
38130>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Recr To (SL17(Self))
38131>>>>>>>
38131>>>>>>>        // Witemx.Year_Recr
38131>>>>>>>
38131>>>>>>>        // Witemx.Item_Recr
38131>>>>>>>
38131>>>>>>>        // Witemx.Witemx_Descr
38131>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Descr To (SL17(Self))
38132>>>>>>>
38132>>>>>>>        // Witemx.Witemx_Rec0
38132>>>>>>>
38132>>>>>>>        // Witemx.Witemx_Yeardesc
38132>>>>>>>
38132>>>>>>>        // Witemx.Item_Apokat_Cod
38132>>>>>>>
38132>>>>>>>        // Witemx.Qty_Xre
38132>>>>>>>
38132>>>>>>>        // Witemx.Qty_Pis
38132>>>>>>>
38132>>>>>>>        // Witemx.Axia_Xre
38132>>>>>>>
38132>>>>>>>        // Witemx.Axia_Pis
38132>>>>>>>
38132>>>>>>>        // Witemx.Mesosta_Xre
38132>>>>>>>
38132>>>>>>>        // Witemx.Mesosta_Pis
38132>>>>>>>
38132>>>>>>>        // Witemx.Link1
38132>>>>>>>
38132>>>>>>>        // Witemx.Link2
38132>>>>>>>
38132>>>>>>>        //DDB-DefineFieldEnd
38132>>>>>>>    End_Procedure    // Define_Fields
38133>>>>>>>
38133>>>>>>>    // Field_Defaults:
38133>>>>>>>    // This procedure is used to establish default field values.
38133>>>>>>>
38133>>>>>>>    Procedure Field_Defaults
38134>>>>>>>        Forward Send Field_Defaults
38136>>>>>>>        //DDB-Generated-Code-Location
38136>>>>>>>        //DDB-FieldDefaultStart
38136>>>>>>>        //DDB-FieldDefaultEnd
38136>>>>>>>    End_Procedure    // Field_Defaults
38137>>>>>>>
38137>>>>>>>End_Class    // Witemx_DataDictionary
38138>>>>>>>//DDB-Selection-pkg-Start
38138>>>>>>>
38138>>>>>>>Use sl17.SL          // SL17
38138>>>>>>>
38138>>>>>>>//DDB-Selection-pkg-End
38138>>>>>>>//DDB-FileEnd
38138>>>>>    
38138>>>>>    //AB-IgnoreEnd
38138>>>>>
38138>>>>>    Object SL17 is a dbModalPanelSub
38140>>>>>
38140>>>>>        //AB-StoreTopStart
38140>>>>>                
38140>>>>>        Property String     pscode                  ''
38142>>>>>        Property String     psperi                  ''
38144>>>>>        Property Integer    piContains_Or_Starts     0
38146>>>>>        Property String     pscodekat               ''
38148>>>>>        
38148>>>>>        //AB-StoreTopEnd
38148>>>>>
38148>>>>>        Set Minimize_Icon to FALSE
38149>>>>>        Set Label to "„¬¨œ«ã¨ ¦ €¨®œå¦¬ „ ›é¤"
38150>>>>>        Set Size to 266 484
38151>>>>>        Set Location to 9 14
38152>>>>>        Set Exit_Application_Local_State to FALSE
38153>>>>>        Set Modal_State to FALSE
38154>>>>>
38154>>>>>        //AB-DDOStart
38154>>>>>
38154>>>>>        Object Units_DD is a Units_DataDictionary
38156>>>>>        End_Object    // Units_DD
38157>>>>>
38157>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
38159>>>>>        End_Object    // Witemkat_DD
38160>>>>>
38160>>>>>        Object Fpa_DD is a Fpa_DataDictionary
38162>>>>>        End_Object    // Fpa_DD
38163>>>>>
38163>>>>>        Object Item_DD is a Item_DataDictionary
38165>>>>>
38165>>>>>            //AB-StoreTopStart
38165>>>>>                                                                                                    
38165>>>>>                                                                                                    
38165>>>>>            //AB-StoreTopEnd
38165>>>>>
38165>>>>>            Set DDO_Server to (Units_DD(self))
38166>>>>>            Set DDO_Server to (Witemkat_DD(self))
38167>>>>>            Set DDO_Server to (Fpa_DD(self))
38168>>>>>
38168>>>>>            //AB-StoreStart
38168>>>>>                                                                                                    
38168>>>>>                                                                                                    
38168>>>>>                                                                                                    
38168>>>>>                                                                                                    
38168>>>>>                                                                                                    
38168>>>>>                                                                                                    
38168>>>>>                                                                                                    
38168>>>>>                                                                                                    
38168>>>>>            //AB-StoreEnd
38168>>>>>
38168>>>>>        End_Object    // Item_DD
38169>>>>>
38169>>>>>        Object Witemx_DD is a Witemx_DataDictionary
38171>>>>>
38171>>>>>            //AB-StoreTopStart
38171>>>>>            Function fiPeriexei Returns Integer
38173>>>>>                       String lsperi lscode  lscodekat
38174>>>>>                       Integer rVal liContains_Or_Starts
38174>>>>>                       Move 0 to rVal
38175>>>>>                       Get piContains_Or_Starts to liContains_Or_Starts
38176>>>>>                       Get psperi to lsperi
38177>>>>>                       Get pscode to lscode
38178>>>>>                       Get pscodekat to lscodekat
38179>>>>>                       Move (Trim(lsperi)) to lsperi
38180>>>>>                       Move (Trim(lscode)) to lscode
38181>>>>>                       If (liContains_Or_Starts=0) Begin
38183>>>>>                           If ((Trim(witemx.witemx_descr)) Contains lsperi) Begin
38185>>>>>                               If ((Trim(witemx.witemx_code)) Contains lscode) Move 1 to rVal
38188>>>>>                           End
38188>>>>>>
38188>>>>>                       End
38188>>>>>>
38188>>>>>                       Else Begin
38189>>>>>                           If (Left(witemx.witemx_descr,(Length(lsperi)))=lsperi) Begin
38191>>>>>                               If (Left(witemx.witemx_code,(Length(lscode)))=lscode) Move 1 to rVal
38194>>>>>                           End
38194>>>>>>
38194>>>>>                       End
38194>>>>>>
38194>>>>>                       Function_Return rVal
38195>>>>>                   End_Function
38196>>>>>            
38196>>>>>                   Function fiArxizeiperi Returns Integer
38198>>>>>                       String lsperi
38199>>>>>                       Get psperi to lsperi
38200>>>>>                       Move (Trim(lsperi)) to lsperi
38201>>>>>                       Function_Return (Left(witemx.witemx_descr,(Length(lsperi)))=lsperi)
38202>>>>>                   End_Function
38203>>>>>            
38203>>>>>                   Function fiArxizeicode Returns Integer
38205>>>>>                       String lscode lscodekat
38206>>>>>                       Get pscode to lscode
38207>>>>>                       Move (Trim(lscode)) to lscode
38208>>>>>                       Function_Return (Left(witemx.witemx_code,(Length(lscode)))=lscode)
38209>>>>>                   End_Function
38210>>>>>            //AB-StoreTopEnd
38210>>>>>
38210>>>>>            Set DDO_Server to (Item_DD(self))
38211>>>>>
38211>>>>>            //AB-StoreStart
38211>>>>>                                                                                
38211>>>>>            Begin_Constraints
38213>>>>>               String lsperi lscode lsvalue lstype lscodekat
38214>>>>>               Integer liContains_Or_Starts
38214>>>>>               Get psperi               to lsperi
38215>>>>>               Get pscode               to lscode
38216>>>>>               Get pscodekat            to lscodekat
38217>>>>>               Get piContains_Or_Starts to liContains_Or_Starts
38218>>>>>               Move (Trim(lsperi))      to lsperi
38219>>>>>               Move (Trim(lscode))      to lscode
38220>>>>>               Move (Trim(lscodekat))   to lscodekat
38221>>>>>               Set Ordering to 4
38222>>>>>               If ((lsperi<>'') and (lscode<>'')) Begin
38224>>>>>                    Set Ordering to 4
38225>>>>>                    Constrain witemx as (fiPeriexei(Self)=1)
38226>>>>>               End
38226>>>>>>
38226>>>>>               Else Begin
38227>>>>>                  If (liContains_Or_Starts=0) Begin
38229>>>>>                        If (lsperi<>'') Begin
38231>>>>>                            Set Ordering to 3
38232>>>>>                            Constrain witemx.witemx_descr Contains lsperi
38234>>>>>                        End
38234>>>>>>
38234>>>>>                        Else If (lscode<>'') Begin
38237>>>>>                            Set Ordering to 4
38238>>>>>                            Constrain witemx.witemx_code Contains lscode
38240>>>>>                        End
38240>>>>>>
38240>>>>>                  End
38240>>>>>>
38240>>>>>                  Else Begin
38241>>>>>                        If (lsperi<>'') Begin
38243>>>>>                            Set Ordering to 3
38244>>>>>                            Constrain witemx as (fiArxizeiperi(Self)=1) //witemx.witemx_descr
38245>>>>>                        End
38245>>>>>>
38245>>>>>                        Else If (lscode<>'') Begin
38248>>>>>                            Set Ordering to 4
38249>>>>>                            Constrain witemx as (fiArxizeicode(Self)=1) //witemx.witemx_code
38250>>>>>                        End
38250>>>>>>
38250>>>>>                  End
38250>>>>>>
38250>>>>>                  If (lscodekat<>'') Begin
38252>>>>>                        Constrain witemx.witemkat_code Contains lscodekat
38254>>>>>                  End
38254>>>>>>
38254>>>>>               End
38254>>>>>>
38254>>>>>            End_Constraints
38257>>>>>            
38257>>>>>            
38257>>>>>            //AB-StoreEnd
38257>>>>>
38257>>>>>        End_Object    // Witemx_DD
38258>>>>>
38258>>>>>        Set Main_DD to (Witemx_DD(self))
38259>>>>>        Set Server to (Witemx_DD(self))
38260>>>>>
38260>>>>>        //AB-DDOEnd
38260>>>>>
38260>>>>>        Object oSelList is a dbListSub
38262>>>>>            Set Main_File to Witemx.File_Number
38263>>>>>            Set Ordering to 5
38264>>>>>            Set Size to 190 475
38265>>>>>            Set Location to 1 1
38266>>>>>            Set Color to 14280447
38267>>>>>            Set CurrentRowColor to 11783679
38268>>>>>            Set CurrentCellColor to 11783679
38269>>>>>            Set Auto_Index_State to FALSE
38270>>>>>
38270>>>>>            Begin_Row
38273>>>>>                Entry_Item Witemx.Witemx_code
38274>>>>>                Entry_Item Witemx.Witemx_descr
38275>>>>>                Entry_Item Witemx.Witemkat_code
38276>>>>>                Entry_Item Witemkat.Witemkat_descr
38277>>>>>                Entry_Item Item.Item_qual
38278>>>>>                Entry_Item Fpa.Fpa_pososto
38279>>>>>            End_Row
38284>>>>>
38284>>>>>            Set Form_Width    item 0 to 60
38285>>>>>            Set Header_Label  item 0 to "‰à›. „å›¦¬ª"
38286>>>>>            
38286>>>>>            Set Form_Width    item 1 to 140
38287>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
38288>>>>>            
38288>>>>>            Set Form_Width    item 2 to 70
38289>>>>>            Set Header_Label  item 2 to "‰à›. ‰˜«žš¦¨å˜ª"
38290>>>>>            
38290>>>>>            Set Form_Width    item 3 to 88
38291>>>>>            Set Header_Label  item 3 to "œ¨ š¨˜­ã ‰˜«žš."
38292>>>>>            
38292>>>>>            Set Form_Width    item 4 to 64
38293>>>>>            Set Header_Label  item 4 to "¦ æ«ž«˜"
38294>>>>>            
38294>>>>>            Set Form_Width    item 5 to 45
38295>>>>>            Set Header_Label  item 5 to "‰˜«.”..€"
38296>>>>>            
38296>>>>>
38296>>>>>            //AB-StoreStart
38296>>>>>            Property String Store_Fragma_Items public ""
38298>>>>>            set export_item_state to true
38299>>>>>            
38299>>>>>            Procedure End_Construct_Object
38301>>>>>                Forward Send End_Construct_Object
38303>>>>>                Set Color               to 14280447
38304>>>>>                Set CurrentRowColor     to 11783679
38305>>>>>                Set CurrentCellColor    to 11783679
38306>>>>>            End_Procedure
38307>>>>>            
38307>>>>>            Procedure Activating Returns Integer
38309>>>>>                Integer rVal
38310>>>>>                Forward Get Msg_Activating to rVal
38312>>>>>                set auto_index_state to true
38313>>>>>                Procedure_Return rVal
38314>>>>>            End_Procedure
38315>>>>>            
38315>>>>>            procedure move_value_out
38317>>>>>                forward send move_value_out
38319>>>>>                set value of (ocode(self)) to ''
38320>>>>>                set value of (operi(self)) to ''
38321>>>>>                set value of (ocodekat(self)) to ''
38322>>>>>                set psperi to ''
38323>>>>>                set pscode to ''
38324>>>>>                set pscodekat to ''
38325>>>>>            end_procedure
38326>>>>>            
38326>>>>>            
38326>>>>>            
38326>>>>>            
38326>>>>>            
38326>>>>>            
38326>>>>>            
38326>>>>>            
38326>>>>>            
38326>>>>>            //AB-StoreEnd
38326>>>>>
38326>>>>>        End_Object    // oSelList
38327>>>>>
38327>>>>>        Object TextBoxSub1 is a TextBoxSub
38329>>>>>            Set Label to "‘á¨à©ž ¡à› ¡¦ç š ˜"
38330>>>>>            Set Auto_Size_State to FALSE
38331>>>>>            Set Location to 192 6
38332>>>>>            Set Size to 13 69
38333>>>>>        End_Object    // TextBoxSub1
38334>>>>>
38334>>>>>        Object ocode is a FormSub
38336>>>>>            Set Size to 13 197
38337>>>>>            Set Location to 192 79
38338>>>>>            Set Label_Col_Offset to 2
38339>>>>>
38339>>>>>            //AB-StoreStart
38339>>>>>            
38339>>>>>            
38339>>>>>            
38339>>>>>            
38339>>>>>            
38339>>>>>            
38339>>>>>            
38339>>>>>            
38339>>>>>            //AB-StoreEnd
38339>>>>>
38339>>>>>        End_Object    // ocode
38340>>>>>
38340>>>>>        Object TextBoxSub2 is a TextBoxSub
38342>>>>>            Set Label to "‘á¨à©ž §œ¨ š¨˜­ãª "
38343>>>>>            Set Auto_Size_State to FALSE
38344>>>>>            Set Location to 207 6
38345>>>>>            Set Size to 13 71
38346>>>>>        End_Object    // TextBoxSub2
38347>>>>>
38347>>>>>        Object operi is a FormSub
38349>>>>>            Set Size to 13 197
38350>>>>>            Set Location to 207 79
38351>>>>>            Set Label_Col_Offset to 2
38352>>>>>
38352>>>>>            //AB-StoreStart
38352>>>>>            
38352>>>>>            
38352>>>>>            
38352>>>>>            
38352>>>>>            
38352>>>>>            
38352>>>>>            
38352>>>>>            //AB-StoreEnd
38352>>>>>
38352>>>>>        End_Object    // operi
38353>>>>>
38353>>>>>        Object RadioGroupSub1 is a RadioGroupSub
38355>>>>>            Set Size to 32 77
38356>>>>>            Set Location to 191 279
38357>>>>>            Object Radio1 is a RadioSub
38359>>>>>                Set Label to "œ¨ â®œ«˜ "
38360>>>>>                Set Size to 10 53
38361>>>>>                Set Location to 7 5
38362>>>>>            End_Object    // Radio1
38363>>>>>
38363>>>>>            Object Radio2 is a RadioSub
38365>>>>>                Set Label to "€¨®åœ  €§¦"
38366>>>>>                Set Size to 10 52
38367>>>>>                Set Location to 21 5
38368>>>>>            End_Object    // Radio2
38369>>>>>
38369>>>>>
38369>>>>>            //AB-StoreStart
38369>>>>>            
38369>>>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
38371>>>>>                Set piContains_Or_Starts to iToItem
38372>>>>>            End_Procedure
38373>>>>>            
38373>>>>>            
38373>>>>>            
38373>>>>>            
38373>>>>>            
38373>>>>>            //AB-StoreEnd
38373>>>>>
38373>>>>>        End_Object    // RadioGroupSub1
38374>>>>>
38374>>>>>        Object ButtonSub1 is a ButtonSub
38376>>>>>            Set Label to "œ¨ æ¨ ©œ"
38377>>>>>            Set Size to 15 197
38378>>>>>            Set Location to 236 79
38379>>>>>            Set Form_FontWeight Item 0 to 800
38380>>>>>            Set Form_TypeFace Item 0 to "ms sans serif"
38381>>>>>
38381>>>>>            //AB-StoreStart
38381>>>>>            
38381>>>>>            Procedure OnClick
38383>>>>>                Forward Send OnClick
38385>>>>>                Set pscode      to (Value(ocode(Self),0))
38386>>>>>                Set psperi      to (Value(operi(Self),0))
38387>>>>>                Set pscodekat   to (Value(ocodekat(Self),0))
38388>>>>>                send Rebuild_Constraints    to (witemx_DD(Self))
38389>>>>>                Send Beginning_Of_Data      to oSelList True
38390>>>>>            End_Procedure // OnClick
38391>>>>>            
38391>>>>>            
38391>>>>>            //AB-StoreEnd
38391>>>>>
38391>>>>>        End_Object    // ButtonSub1
38392>>>>>
38392>>>>>        Object TextBoxSub3 is a TextBoxSub
38394>>>>>            Set Label to "‰à›. ¡˜«žš¦¨å˜ª š ˜"
38395>>>>>            Set Auto_Size_State to FALSE
38396>>>>>            Set Location to 221 5
38397>>>>>            Set Size to 13 70
38398>>>>>        End_Object    // TextBoxSub3
38399>>>>>
38399>>>>>        Object ocodekat is a FormSub
38401>>>>>            Set Size to 13 197
38402>>>>>            Set Location to 221 79
38403>>>>>            Set Label_Col_Offset to 2
38404>>>>>
38404>>>>>            //AB-StoreStart
38404>>>>>            
38404>>>>>            
38404>>>>>            
38404>>>>>            
38404>>>>>            
38404>>>>>            
38404>>>>>            
38404>>>>>            //AB-StoreEnd
38404>>>>>
38404>>>>>        End_Object    // ocodekat
38405>>>>>
38405>>>>>        Object oOK_bn is a ButtonSub
38407>>>>>            Set Label to "&„§ ¢¦šã"
38408>>>>>            Set Location to 232 318
38409>>>>>
38409>>>>>            //AB-StoreStart
38409>>>>>            Procedure OnClick
38411>>>>>                Send OK To (oSelList(current_object))
38412>>>>>            End_Procedure
38413>>>>>            //AB-StoreEnd
38413>>>>>
38413>>>>>        End_Object    // oOK_bn
38414>>>>>
38414>>>>>        Object oCancel_bn is a ButtonSub
38416>>>>>            Set Label to "&€¡ç¨à©ž"
38417>>>>>            Set Location to 232 373
38418>>>>>
38418>>>>>            //AB-StoreStart
38418>>>>>            Procedure OnClick
38420>>>>>                Send Cancel To (oSelList(current_object))
38421>>>>>            End_Procedure
38422>>>>>            //AB-StoreEnd
38422>>>>>
38422>>>>>        End_Object    // oCancel_bn
38423>>>>>
38423>>>>>        Object oSearch_bn is a ButtonSub
38425>>>>>            Set Label to "€&¤˜ã«ž©ž"
38426>>>>>            Set Location to 232 428
38427>>>>>
38427>>>>>            //AB-StoreStart
38427>>>>>            Procedure OnClick
38429>>>>>                Send Search To (oSelList(current_object))
38430>>>>>            End_Procedure
38431>>>>>            //AB-StoreEnd
38431>>>>>
38431>>>>>        End_Object    // oSearch_bn
38432>>>>>
38432>>>>>        Object btnwitemcl is a ButtonSub
38434>>>>>
38434>>>>>            //AB-StoreTopStart
38434>>>>>            
38434>>>>>            //AB-StoreTopEnd
38434>>>>>
38434>>>>>            Set Label to "ButtonSub1"
38435>>>>>            Set Bitmap to "Filesys3.bmp"
38436>>>>>            Set Size to 22 25
38437>>>>>            Set Location to 196 443
38438>>>>>            Set Focus_Mode to Pointer_Only
38439>>>>>
38439>>>>>            //AB-StoreStart
38439>>>>>            
38439>>>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«¦ œ¬¨œ«ã¨ ¦ „ ›é¤ / ¨¦£žŸœ¬«ã"
38440>>>>>            
38440>>>>>            Procedure OnClick
38442>>>>>                String  scode speri
38443>>>>>                Get value of (ocode(self)) to scode
38444>>>>>                Get value of (operi(self)) to speri
38445>>>>>                set pscode of (dg186(self)) to scode
38446>>>>>                set psperi of (dg186(self)) to speri
38447>>>>>               Send popup_modal to (dg186(self))
38448>>>>>            End_Procedure // OnClick
38449>>>>>            
38449>>>>>            
38449>>>>>            
38449>>>>>            
38449>>>>>            
38449>>>>>            
38449>>>>>            
38449>>>>>            
38449>>>>>            
38449>>>>>            
38449>>>>>            
38449>>>>>            
38449>>>>>            
38449>>>>>            
38449>>>>>            
38449>>>>>            
38449>>>>>            
38449>>>>>            
38449>>>>>            
38449>>>>>            
38449>>>>>            
38449>>>>>            
38449>>>>>            
38449>>>>>            //AB-StoreEnd
38449>>>>>
38449>>>>>        End_Object    // btnwitemcl
38450>>>>>
38450>>>>>
38450>>>>>        //AB-StoreStart
38450>>>>>                
38450>>>>>        Set Locate_Mode to Center_On_Screen
38451>>>>>        
38451>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
38452>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
38453>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
38454>>>>>        
38454>>>>>        Procedure Activate
38456>>>>>            Send Rebuild_Constraints    to Witemx_DD
38457>>>>>            Send Beginning_Of_Data      to oSelList True
38458>>>>>            Forward Send Activate
38460>>>>>        End_Procedure
38461>>>>>        
38461>>>>>        procedure request_cancel
38463>>>>>            forward send request_cancel
38465>>>>>            set value of (ocode(self)) to ''
38466>>>>>            set value of (operi(self)) to ''
38467>>>>>            set value of (ocodekat(self)) to ''
38468>>>>>            Set psperi  to ''
38469>>>>>            Set pscode  to ''
38470>>>>>            Set pscodekat TO ''
38471>>>>>        end_procedure
38472>>>>>        
38472>>>>>        
38472>>>>>        
38472>>>>>        
38472>>>>>        
38472>>>>>        
38472>>>>>        
38472>>>>>        
38472>>>>>        
38472>>>>>        //AB-StoreEnd
38472>>>>>
38472>>>>>    End_Object    // SL17
38473>>>>>
38473>>>>>
38473>>>>>    //AB-StoreStart
38473>>>>>    
38473>>>>>    
38473>>>>>    
38473>>>>>    
38473>>>>>    
38473>>>>>    
38473>>>>>    
38473>>>>>    
38473>>>>>    
38473>>>>>    
38473>>>>>    
38473>>>>>    
38473>>>>>    //AB-StoreEnd
38473>>>>>
38473>>>>>//AB/     End_Object    // prj
38473>>>    //AB-StoreTopEnd
38473>>>
38473>>>    //AB-IgnoreStart
38473>>>
38473>>>    Use DFAllEnt.pkg
38473>>>    Use Txtbox.Sub
38473>>>    Use Form.Sub
38473>>>    Use Rgroup.Sub
38473>>>    Use Radio.Sub
38473>>>    Use Button.Sub
38473>>>
38473>>>
38473>>>    Use WITEMKAT.DD
38473>>>    Use UNITS.DD
38473>>>    Use FPA.DD
38473>>>    Use ITEM.DD
38473>>>    Use WITEMCL.DD
INCLUDING FILE: WITEMCL.DD
38473>>>>>//DDB-FileStart
38473>>>>>//DDB-HeaderStart
38473>>>>>
38473>>>>>// File Name : WITEMCL.DD
38473>>>>>// Class Name: Witemcl_DataDictionary
38473>>>>>// Revision  : 16
38473>>>>>// Version   : 2
38473>>>>>
38473>>>>>Use  Windows           // Basic Definitions
38473>>>>>Use  DataDict          // DataDictionary Class Definition
38473>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38473>>>>>
38473>>>>>Open Witemcl
38475>>>>>Open Witemcld
38477>>>>>Open Item
38479>>>>>Open Sysrecw
38481>>>>>
38481>>>>>//DDB-HeaderEnd
38481>>>>>//DDB-SelectionStart
38481>>>>>//DDB/ ExternalSelectionList SL100  sl100.sl
38481>>>>>Register_Object SL100
38481>>>>>//DDB-SelectionEnd
38481>>>>>
38481>>>>>Class Witemcl_DataDictionary  is a DataDictionary_Sec
38482>>>>> 
38482>>>>>    // Update:
38482>>>>> 
38482>>>>>    Procedure Update
38483>>>>>        Forward Send Update  
38485>>>>>        move item.item_descr to witemcl.item_descr
38486>>>>>    End_Procedure   // Update
38487>>>>> 
38487>>>>>
38487>>>>>    // Define_Fields:
38487>>>>>    // This procedure is used to set up all data-dictionary rules.
38487>>>>>
38487>>>>>    Procedure Define_Fields
38488>>>>>        Forward Send Define_Fields
38490>>>>>        //DDB-Generated-Code-Location
38490>>>>>        //DDB-DefineFieldStart
38490>>>>>
38490>>>>>        Set Main_File            To Witemcl.File_Number
38491>>>>>        Set Cascade_Delete_State To FALSE
38492>>>>>
38492>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
38493>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
38494>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38495>>>>>
38495>>>>>        // Child (Client) file structure................
38495>>>>>        Send Add_Client_File  Witemcld.File_Number
38496>>>>>
38496>>>>>        // Parent (Server) file structure...............
38496>>>>>        Send Add_Server_File  Item.File_Number
38497>>>>>
38497>>>>>        // External (System) file structure.............
38497>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
38498>>>>>
38498>>>>>        Define_Auto_Increment  Sysrecw.Witemcl_Rec0  To Witemcl.Rec0
38501>>>>>
38501>>>>>        // Field-based properties.......................
38501>>>>>
38501>>>>>        // Witemcl.Item_Code
38501>>>>>
38501>>>>>        // Witemcl.Client_Code
38501>>>>>        Set Field_Prompt_Object    Field Witemcl.Client_Code To (SL100(Self))
38502>>>>>
38502>>>>>        // Witemcl.Client_Itemcode
38502>>>>>
38502>>>>>        // Witemcl.Client_Date
38502>>>>>        Set Field_Mask_Type        Field Witemcl.Client_Date To MASK_DATE_WINDOW
38503>>>>>
38503>>>>>        // Witemcl.Client_Price
38503>>>>>        Set Field_Mask_Type        Field Witemcl.Client_Price To MASK_NUMERIC_WINDOW
38504>>>>>
38504>>>>>        // Witemcl.Item_Descr
38504>>>>>
38504>>>>>        // Witemcl.Rec0
38504>>>>>
38504>>>>>        // Witemcl.Is_Client
38504>>>>>
38504>>>>>        //DDB-DefineFieldEnd
38504>>>>>    End_Procedure    // Define_Fields
38505>>>>>
38505>>>>>    // Field_Defaults:
38505>>>>>    // This procedure is used to establish default field values.
38505>>>>>
38505>>>>>    Procedure Field_Defaults
38506>>>>>        Forward Send Field_Defaults
38508>>>>>        //DDB-Generated-Code-Location
38508>>>>>        //DDB-FieldDefaultStart
38508>>>>>        //DDB-FieldDefaultEnd
38508>>>>>    End_Procedure    // Field_Defaults
38509>>>>>
38509>>>>>End_Class    // Witemcl_DataDictionary
38510>>>>>//DDB-Selection-pkg-Start
38510>>>>>
38510>>>>>Use sl100.sl         // SL100
INCLUDING FILE: SL100.SL
38510>>>>>>>//AB/ Project SL100:PELATES
38510>>>>>>>//AB/     Object prj is a Lookup_Project
38510>>>>>>>//AB/         Set ProjectName to "SL100:PELATES"
38510>>>>>>>//AB/         Set ProjectFileName to "SL100.SL"
38510>>>>>>>
38510>>>>>>>// Project Object Structure
38510>>>>>>>//   sl100 is a dbModalPanelSub
38510>>>>>>>//     Clients_DD is a DataDictionary
38510>>>>>>>//     oSelList is a dbListSub
38510>>>>>>>//     oOK_bn is a ButtonSub
38510>>>>>>>//     oCancel_bn is a ButtonSub
38510>>>>>>>//     oSearch_bn is a ButtonSub
38510>>>>>>>
38510>>>>>>>// Register all objects
38510>>>>>>>Register_Object Clients_DD
38510>>>>>>>Register_Object oCancel_bn
38510>>>>>>>Register_Object oOK_bn
38510>>>>>>>Register_Object oSearch_bn
38510>>>>>>>Register_Object oSelList
38510>>>>>>>Register_Object sl100
38510>>>>>>>
38510>>>>>>>
38510>>>>>>>    //AB-IgnoreStart
38510>>>>>>>
38510>>>>>>>    Use DFAllEnt.pkg
38510>>>>>>>    Use dbList.Sub
38510>>>>>>>    Use Button.Sub
38510>>>>>>>
38510>>>>>>>
38510>>>>>>>    Use CLIENTS.DD
INCLUDING FILE: CLIENTS.DD
38510>>>>>>>>>//DDB-FileStart
38510>>>>>>>>>//DDB-HeaderStart
38510>>>>>>>>>
38510>>>>>>>>>// File Name : CLIENTS.DD
38510>>>>>>>>>// Class Name: Clients_DataDictionary
38510>>>>>>>>>// Revision  : 229
38510>>>>>>>>>// Version   : 2
38510>>>>>>>>>
38510>>>>>>>>>Use  Windows           // Basic Definitions
38510>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
38510>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38510>>>>>>>>>
38510>>>>>>>>>Open Clients
38512>>>>>>>>>Open Cmoves
INCLUDING FILE: CMOVES.FD
38514>>>>>>>>>Open Particle
INCLUDING FILE: PARTICLE.FD
38516>>>>>>>>>Open Cmovesa
INCLUDING FILE: CMOVESA.FD
38518>>>>>>>>>Open Cn
38520>>>>>>>>>Open Particll
INCLUDING FILE: PARTICLL.FD
38522>>>>>>>>>Open Clnbank
INCLUDING FILE: CLNBANK.FD
38524>>>>>>>>>Open Tpclient
INCLUDING FILE: TPCLIENT.FD
38526>>>>>>>>>Open Clorder
INCLUDING FILE: CLORDER.FD
38528>>>>>>>>>Open Clitem
INCLUDING FILE: CLITEM.FD
38530>>>>>>>>>Open Cities
38532>>>>>>>>>Open Areas
38534>>>>>>>>>Open Payresp
38536>>>>>>>>>Open Syscurxr
38538>>>>>>>>>Open Sysrecc
INCLUDING FILE: SYSRECC.FD
38540>>>>>>>>>
38540>>>>>>>>>//DDB-HeaderEnd
38540>>>>>>>>>//DDB-ValidationStart
38540>>>>>>>>>
38540>>>>>>>>>Register_Object Clients_Client_Doy_VT
38540>>>>>>>>>Register_Object Clients_Client_Job_VT
38540>>>>>>>>>Register_Object Clients_Client_Categfpa_VT
38540>>>>>>>>>Register_Object Clients_Client_Catjob_VT1
38540>>>>>>>>>Register_Object Clients_Client_Idiot_VT
38540>>>>>>>>>Register_Object Clients_Feregios_VT
38540>>>>>>>>>
38540>>>>>>>>>Object Clients_Client_Doy_VT  is a CodeValidationTable
38542>>>>>>>>>    Set Type_Value        To "DOY"
38543>>>>>>>>>    Set Validate_State    To FALSE
38544>>>>>>>>>    Set Allow_Blank_State To TRUE
38545>>>>>>>>>    Set Table_Title       To "ƒ.Ž.“"
38546>>>>>>>>>    //DDB-ValidationCustomStart
38546>>>>>>>>>    //DDB-ValidationCustomEnd
38546>>>>>>>>>End_Object   // Clients_Client_Doy_VT
38547>>>>>>>>>
38547>>>>>>>>>Object Clients_Client_Job_VT  is a CodeValidationTable
38549>>>>>>>>>    Set Type_Value        To "JOB"
38550>>>>>>>>>    Set Validate_State    To FALSE
38551>>>>>>>>>    Set Allow_Blank_State To TRUE
38552>>>>>>>>>    Set Table_Title       To "„§˜ššâ¢£˜«˜"
38553>>>>>>>>>    //DDB-ValidationCustomStart
38553>>>>>>>>>    //DDB-ValidationCustomEnd
38553>>>>>>>>>End_Object   // Clients_Client_Job_VT
38554>>>>>>>>>
38554>>>>>>>>>Object Clients_Client_Categfpa_VT  is a CodeValidationTable
38556>>>>>>>>>    Set Type_Value        To "VAT_STATUS"
38557>>>>>>>>>    Set Validate_State    To FALSE
38558>>>>>>>>>    Set Allow_Blank_State To TRUE
38559>>>>>>>>>    //DDB-ValidationCustomStart
38559>>>>>>>>>    //DDB-ValidationCustomEnd
38559>>>>>>>>>End_Object   // Clients_Client_Categfpa_VT
38560>>>>>>>>>
38560>>>>>>>>>Object Clients_Client_Catjob_VT1  is a CodeValidationTable
38562>>>>>>>>>    Set Type_Value        To "JOB"
38563>>>>>>>>>    Set Validate_State    To FALSE
38564>>>>>>>>>    Set Allow_Blank_State To TRUE
38565>>>>>>>>>    //DDB-ValidationCustomStart
38565>>>>>>>>>    //DDB-ValidationCustomEnd
38565>>>>>>>>>End_Object   // Clients_Client_Catjob_VT1
38566>>>>>>>>>
38566>>>>>>>>>Object Clients_Client_Idiot_VT  is a CodeValidationTable
38568>>>>>>>>>    Set Type_Value        To "IDIOT"
38569>>>>>>>>>    Set Validate_State    To FALSE
38570>>>>>>>>>    Set Allow_Blank_State To TRUE
38571>>>>>>>>>    Set Table_Title       To "€¨®œå¦ ˆ› ¦«ã«à¤"
38572>>>>>>>>>    //DDB-ValidationCustomStart
38572>>>>>>>>>    //DDB-ValidationCustomEnd
38572>>>>>>>>>End_Object   // Clients_Client_Idiot_VT
38573>>>>>>>>>
38573>>>>>>>>>Object Clients_Feregios_VT  is a CodeValidationTable
38575>>>>>>>>>    Set Type_Value        To "FEREGIOS"
38576>>>>>>>>>    Set Allow_Blank_State To TRUE
38577>>>>>>>>>    Set Table_Title       To "ƒœå¡«œª ”œ¨œšš¬æ«ž«˜ª ”¦¨âà¤"
38578>>>>>>>>>    //DDB-ValidationCustomStart
38578>>>>>>>>>    //DDB-ValidationCustomEnd
38578>>>>>>>>>End_Object   // Clients_Feregios_VT
38579>>>>>>>>>//DDB-ValidationEnd
38579>>>>>>>>>//DDB-SelectionStart
38579>>>>>>>>>//DDB/ ExternalSelectionList sl100  sl100.SL
38579>>>>>>>>>Register_Object sl100
38579>>>>>>>>>//DDB-SelectionEnd
38579>>>>>>>>>Open Sysfile
38581>>>>>>>>>open year
38583>>>>>>>>>
38583>>>>>>>>>Class Clients_DataDictionary  is a DataDictionary_Sec
38584>>>>>>>>>
38584>>>>>>>>>    Procedure Construct_Object
38585>>>>>>>>>        Forward Send Construct_Object
38587>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
38588>>>>>>>>>        Property Integer piCheckPlaf        Public 0
38589>>>>>>>>>    End_Procedure
38590>>>>>>>>>
38590>>>>>>>>>    // Backout:
38590>>>>>>>>>    Procedure Backout
38591>>>>>>>>>        Forward Send Backout
38593>>>>>>>>>        // Insert Code Here
38593>>>>>>>>>    End_Procedure   // Backout
38594>>>>>>>>>
38594>>>>>>>>>
38594>>>>>>>>>
38594>>>>>>>>>    Procedure Update
38595>>>>>>>>>        Forward Send Update
38597>>>>>>>>>        // Insert Code Here
38597>>>>>>>>>        Move SysCurXR.Company_Code  to Clients.Company_Code
38598>>>>>>>>>        Move SysCurXR.Branch_Code   to Clients.Branch_Code
38599>>>>>>>>>        Move SysCurXR.Year_Year     to Clients.Year_Year
38600>>>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
38600>>>>>>>>>        Move (Clients.Xreosh-Clients.Pistosh)   to Clients.Ypoloipo
38601>>>>>>>>>        Move (Clients.Plafon-Clients.Ypoloipo)  to Clients.Overhead
38602>>>>>>>>>
38602>>>>>>>>>        //Move Clients.Client_Address     to Clients.Client_LastUpd
38602>>>>>>>>>
38602>>>>>>>>>        //betolink
38602>>>>>>>>>        Move SysCurXR.Beto_Site      to Clients.Client_SiteW
38603>>>>>>>>>        Move Clients.Client_Rec0     to Clients.Client_SN
38604>>>>>>>>>        Move Clients.Client_id       to Clients.Client_Repm
38605>>>>>>>>>        Move Clients.Company_Code    to Clients.CLIENT_COMPANY
38606>>>>>>>>>        Move Clients.Client_id       to Clients.Client_RepMatch
38607>>>>>>>>>     //   Move (gsfCode_Mast('JOB',Clients.Client_CatJob)) to Clients.Client_Job
38607>>>>>>>>>    End_Procedure   // Update
38608>>>>>>>>>
38608>>>>>>>>>
38608>>>>>>>>>    Procedure Creating
38609>>>>>>>>>        date ddate iYes
38610>>>>>>>>>        Forward Send Creating
38612>>>>>>>>>        // Insert Code Here
38612>>>>>>>>>
38612>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Clients.Client_Rec0))))));                                    to Clients.Client_Recr
38613>>>>>>>>>        Move '1'                    to Clients.Client_Active
38614>>>>>>>>>        get fsgCode_With_Zeroes Clients.Client_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to Clients.Client_ID
38615>>>>>>>>>        sysdate4 ddate
38616>>>>>>>>>        move ddate                  to Clients.Client_Hmnia
38617>>>>>>>>>        clear year
38618>>>>>>>>>        move syscurxr.company_code  to year.company_code
38619>>>>>>>>>        move syscurxr.branch_code   to year.branch_code
38620>>>>>>>>>        move syscurxr.year_year     to year.year_year
38621>>>>>>>>>        find eq year by index.1
38622>>>>>>>>>>
38622>>>>>>>>>        If (found=1) begin
38624>>>>>>>>>            move year.clients_plafon to clients.plafon
38625>>>>>>>>>            move year.clients_ofeilh to clients.orio_syn_ofeilh
38626>>>>>>>>>        end
38626>>>>>>>>>>
38626>>>>>>>>>    End_Procedure   // Creating
38627>>>>>>>>>
38627>>>>>>>>>    Function Validate_Save  Returns Integer
38628>>>>>>>>>        Integer iReturnVal iCheck iYes
38629>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
38631>>>>>>>>>        If (Not(iReturnVal)) Begin
38633>>>>>>>>>
38633>>>>>>>>>            If (clients.is_eksoter <> '1') begin
38635>>>>>>>>>                If (Clients.Is_Xondr='1') Begin
38637>>>>>>>>>                    If (Sysfile.Check_Afm=1) Begin
38639>>>>>>>>>                        Move (Check_AFM(Clients.Client_Afm)) to iCheck
38640>>>>>>>>>                        If (iCheck) Begin
38642>>>>>>>>>                                 If (iCheck=1) Move 4001 to iReturnVal
38645>>>>>>>>>                            Else If (iCheck=2) Move 4002 to iReturnVal
38649>>>>>>>>>                            Else If (iCheck=3) Move 4003 to iReturnVal
38653>>>>>>>>>                        End
38653>>>>>>>>>>
38653>>>>>>>>>                    End
38653>>>>>>>>>>
38653>>>>>>>>>                End
38653>>>>>>>>>>
38653>>>>>>>>>            End
38653>>>>>>>>>>
38653>>>>>>>>>
38653>>>>>>>>>            If (piCheckPlaf(Self)=1) Begin
38655>>>>>>>>>                If ((Clients.Plafon>0) And ((Clients.Ypoloipo+Clients.Posa_Apo_Dap)>Clients.Plafon)) Begin
38657>>>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4000 Clients' to iYes
38658>>>>>>>>>                    If (iYes=MBR_NO) Error 4004 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž' //Move 4004 to iReturnVal
38661>>>>>>>>>                End
38661>>>>>>>>>>
38661>>>>>>>>>                Else If ((PayResp.Plafon<>0) And (PayResp.Plafon<=PayResp.Synolikh_Ofeilh)) Begin
38664>>>>>>>>>                    Get YesNo_Box 'Ž ¬§œçŸ¬¤¦ª §¢ž¨à£ãª ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž\nŒ˜ ©¬¤œ®å©à ©«ž¤ ›ž£ ¦¬¨šå˜ œšš¨˜­ãª §œ¢á«ž;' to iYes
38665>>>>>>>>>                    If (iYes=MBR_NO) Error 4005 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
38668>>>>>>>>>                End
38668>>>>>>>>>>
38668>>>>>>>>>                Else If ((Clients.Orio_Syn_Ofeilh>0) And (Clients.Synolikh_Ofeilh>Clients.Orio_Syn_Ofeilh)) Begin
38671>>>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4001 Clients' to iYes
38672>>>>>>>>>                    If (iYes=MBR_NO) Error 4005 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
38675>>>>>>>>>                End
38675>>>>>>>>>>
38675>>>>>>>>>                Else If ((Clients.Orio_Syn_Ofeilh>0) And (PayResp.Orio_Syn_Ofeilh>0) And (Clients.Synolikh_Ofeilh>Payresp.Orio_Syn_Ofeilh)) Begin
38678>>>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4002 Clients' to iYes
38679>>>>>>>>>                    If (iYes=MBR_NO) Error 4006 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'   //Move 4006 to iReturnVal
38682>>>>>>>>>                End
38682>>>>>>>>>>
38682>>>>>>>>>                If ((Clients.Plafon>0) And ((Clients.Ypoloipo+Clients.Posa_Apo_Parag)>Clients.Plafon)) Begin
38684>>>>>>>>>                    Send Info_Box '’˜ §¦©á «à¤ ž£œ¨ž©åà¤ §˜¨˜ššœ¢ é¤\n¬§œ¨™˜å¤¦¬¤ «¦ › ˜Ÿâ© £¦ ¬§æ¢¦ §¦\n™á©ž §¢˜­æ¤ «¦¬ §œ¢á«ž' '¨¦©¦®ã !!!'
38685>>>>>>>>>                End
38685>>>>>>>>>>
38685>>>>>>>>>            End
38685>>>>>>>>>>
38685>>>>>>>>>
38685>>>>>>>>>            If (iReturnVal) Begin
38687>>>>>>>>>                Send Operation_Not_Allowed iReturnVal
38688>>>>>>>>>            End
38688>>>>>>>>>>
38688>>>>>>>>>        End
38688>>>>>>>>>>
38688>>>>>>>>>        Function_Return iReturnVal
38689>>>>>>>>>    End_Function   // Validate_Save
38690>>>>>>>>>
38690>>>>>>>>>
38690>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
38691>>>>>>>>>        String lsError_Message
38692>>>>>>>>>
38692>>>>>>>>>        Case Begin
38692>>>>>>>>>            Case (iError_Num = 4001)
38694>>>>>>>>>                Move "DDC 100: Š˜¤Ÿ˜©£â¤¦ €”‹ œ¢á«ž" ;                    to lsError_Message
38695>>>>>>>>>              Case Break
38696>>>>>>>>>            Case (iError_Num = 4002)
38699>>>>>>>>>                Move "DDC 100: ’¦ €”‹ œ¢á«ž ›œ¤ œå¤˜  9 ¯ã­ ¦" ;                    to lsError_Message
38700>>>>>>>>>              Case Break
38701>>>>>>>>>            Case (iError_Num = 4003)
38704>>>>>>>>>                Move "DDC 100: €¡˜«á¢¢ž¢¦ª ®˜¨˜¡«ã¨˜ª ©«¦ €”‹ œ¢á«ž" ;                    to lsError_Message
38705>>>>>>>>>              Case Break
38706>>>>>>>>>            Case (iError_Num = 4004)
38709>>>>>>>>>                Move "DDC 100: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ §œ¢á«ž" ;                    to lsError_Message
38710>>>>>>>>>              Case Break
38711>>>>>>>>>            Case (iError_Num = 4005)
38714>>>>>>>>>                Move "DDC 100: † ©¬¤¦¢ ¡ã ¦­œ ¢ã ¬§œ¨™˜å¤œ \n«¦ æ¨ ¦ ©¬¤¦¢ ¡ãª ¦­œ ¢ãª" ;                    to lsError_Message
38715>>>>>>>>>              Case Break
38716>>>>>>>>>            Case (iError_Num = 4006)
38719>>>>>>>>>                Move "DDC 100: † ©¬¤¦¢ ¡ã ¦­œ ¢ã ¬§œ¨™˜å¤œ \n«¦ æ¨ ¦ ©¬¤¦¢ ¡ãª ¦­œ ¢ãª «¦¬ “§œ¬Ÿç¤¦¬" ;                    to lsError_Message
38720>>>>>>>>>              Case Break
38721>>>>>>>>>
38721>>>>>>>>>            Case Else
38721>>>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
38723>>>>>>>>>        Case End
38723>>>>>>>>>
38723>>>>>>>>>        Error iError_Num lsError_Message
38724>>>>>>>>>>
38724>>>>>>>>>    End_Procedure // operation_not_allowed
38725>>>>>>>>>
38725>>>>>>>>>
38725>>>>>>>>>    // Define_Fields:
38725>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
38725>>>>>>>>>
38725>>>>>>>>>    Procedure Define_Fields
38726>>>>>>>>>        Forward Send Define_Fields
38728>>>>>>>>>        //DDB-Generated-Code-Location
38728>>>>>>>>>        //DDB-DefineFieldStart
38728>>>>>>>>>
38728>>>>>>>>>        Set Main_File            To Clients.File_Number
38729>>>>>>>>>        Set Cascade_Delete_State To FALSE
38730>>>>>>>>>
38730>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
38731>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
38732>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38733>>>>>>>>>
38733>>>>>>>>>        // Child (Client) file structure................
38733>>>>>>>>>        Send Add_Client_File  Cmoves.File_Number
38734>>>>>>>>>        Send Add_Client_File  Particle.File_Number
38735>>>>>>>>>        Send Add_Client_File  Cmovesa.File_Number
38736>>>>>>>>>        Send Add_Client_File  Cn.File_Number
38737>>>>>>>>>        Send Add_Client_File  Particll.File_Number
38738>>>>>>>>>        Send Add_Client_File  Clnbank.File_Number
38739>>>>>>>>>        Send Add_Client_File  Tpclient.File_Number
38740>>>>>>>>>        Send Add_Client_File  Clorder.File_Number
38741>>>>>>>>>        Send Add_Client_File  Clitem.File_Number
38742>>>>>>>>>
38742>>>>>>>>>        // Parent (Server) file structure...............
38742>>>>>>>>>        Send Add_Server_File  Cities.File_Number
38743>>>>>>>>>        Send Add_Server_File  Areas.File_Number
38744>>>>>>>>>        Send Add_Server_File  Payresp.File_Number
38745>>>>>>>>>
38745>>>>>>>>>        // External (System) file structure.............
38745>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
38746>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
38747>>>>>>>>>
38747>>>>>>>>>        Define_Auto_Increment  Sysrecc.Client_Rec0  To Clients.Client_Rec0
38750>>>>>>>>>
38750>>>>>>>>>        // Field-based properties.......................
38750>>>>>>>>>
38750>>>>>>>>>        // Clients.Company_Code
38750>>>>>>>>>
38750>>>>>>>>>        // Clients.Branch_Code
38750>>>>>>>>>
38750>>>>>>>>>        // Clients.Year_Year
38750>>>>>>>>>
38750>>>>>>>>>        // Clients.Custprom_Code
38750>>>>>>>>>
38750>>>>>>>>>        // Clients.Client_Id
38750>>>>>>>>>        Set Field_Options          Field Clients.Client_Id To DD_AUTOFIND    DD_NOPUT
38751>>>>>>>>>        Set Field_Prompt_Object    Field Clients.Client_Id To (sl100(Self))
38752>>>>>>>>>        Set Key_Field_State        Field Clients.Client_Id To TRUE
38753>>>>>>>>>
38753>>>>>>>>>        // Clients.Client_Name
38753>>>>>>>>>        Set Field_Prompt_Object    Field Clients.Client_Name To (sl100(Self))
38754>>>>>>>>>
38754>>>>>>>>>        // Clients.Client_Afm
38754>>>>>>>>>        Set Field_Options          Field Clients.Client_Afm To DD_AUTOFIND
38755>>>>>>>>>
38755>>>>>>>>>        // Clients.Client_Rec0
38755>>>>>>>>>        Set Field_Options          Field Clients.Client_Rec0 To DD_AUTOFIND
38756>>>>>>>>>
38756>>>>>>>>>        // Clients.Custprom_Recr
38756>>>>>>>>>
38756>>>>>>>>>        // Clients.Client_Recr
38756>>>>>>>>>        Set Field_Options          Field Clients.Client_Recr To DD_AUTOFIND
38757>>>>>>>>>
38757>>>>>>>>>        // Clients.Last_Xreosh
38757>>>>>>>>>
38757>>>>>>>>>        // Clients.Last_Pistosh
38757>>>>>>>>>
38757>>>>>>>>>        // Clients.Last_Order
38757>>>>>>>>>        Set Field_Class_Name       Field Clients.Last_Order To "dbComboFormSub"
38758>>>>>>>>>
38758>>>>>>>>>        // Clients.Client_Doy
38758>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Doy To (Clients_Client_Doy_VT(Self))
38759>>>>>>>>>
38759>>>>>>>>>        // Clients.Client_Address
38759>>>>>>>>>
38759>>>>>>>>>        // Clients.Client_City_Id
38759>>>>>>>>>
38759>>>>>>>>>        // Clients.Client_Area
38759>>>>>>>>>
38759>>>>>>>>>        // Clients.Client_Job
38759>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Job To (Clients_Client_Job_VT(Self))
38760>>>>>>>>>
38760>>>>>>>>>        // Clients.Client_Respons
38760>>>>>>>>>
38760>>>>>>>>>        // Clients.Client_Zipcode
38760>>>>>>>>>
38760>>>>>>>>>        // Clients.Client_Phone
38760>>>>>>>>>
38760>>>>>>>>>        // Clients.Client_Fax
38760>>>>>>>>>
38760>>>>>>>>>        // Clients.Client_Mobile
38760>>>>>>>>>
38760>>>>>>>>>        // Clients.Client_Aoh
38760>>>>>>>>>
38760>>>>>>>>>        // Clients.Client_Email
38760>>>>>>>>>
38760>>>>>>>>>        // Clients.Client_Class
38760>>>>>>>>>
38760>>>>>>>>>        // Clients.Client_Details
38760>>>>>>>>>
38760>>>>>>>>>        // Clients.Client_Sitew
38760>>>>>>>>>
38760>>>>>>>>>        // Clients.Client_Codem
38760>>>>>>>>>
38760>>>>>>>>>        // Clients.Client_Categfpa
38760>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Categfpa To (Clients_Client_Categfpa_VT(Self))
38761>>>>>>>>>
38761>>>>>>>>>        // Clients.Client_Fpa
38761>>>>>>>>>
38761>>>>>>>>>        // Clients.Client_Public
38761>>>>>>>>>
38761>>>>>>>>>        // Clients.Client_Sn
38761>>>>>>>>>
38761>>>>>>>>>        // Clients.Client_Repm
38761>>>>>>>>>
38761>>>>>>>>>        // Clients.Client_Active
38761>>>>>>>>>
38761>>>>>>>>>        // Clients.Client_Reported
38761>>>>>>>>>
38761>>>>>>>>>        // Clients.Client_Pelprom
38761>>>>>>>>>
38761>>>>>>>>>        // Clients.Client_Lastupd
38761>>>>>>>>>
38761>>>>>>>>>        // Clients.Client_Markexp
38761>>>>>>>>>
38761>>>>>>>>>        // Clients.Client_Catjob
38761>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Catjob To (Clients_Client_Catjob_VT1(Self))
38762>>>>>>>>>
38762>>>>>>>>>        // Clients.Is_Promhtheyths
38762>>>>>>>>>
38762>>>>>>>>>        // Clients.Xreosh
38762>>>>>>>>>
38762>>>>>>>>>        // Clients.Pistosh
38762>>>>>>>>>
38762>>>>>>>>>        // Clients.Ypoloipo
38762>>>>>>>>>
38762>>>>>>>>>        // Clients.Plafon
38762>>>>>>>>>
38762>>>>>>>>>        // Clients.Overhead
38762>>>>>>>>>
38762>>>>>>>>>        // Clients.Client_Company
38762>>>>>>>>>
38762>>>>>>>>>        // Clients.Client_Repmatch
38762>>>>>>>>>
38762>>>>>>>>>        // Clients.Client_Hmnia
38762>>>>>>>>>
38762>>>>>>>>>        // Clients.Client_Presp
38762>>>>>>>>>
38762>>>>>>>>>        // Clients.Client_Locked
38762>>>>>>>>>
38762>>>>>>>>>        // Clients.Synolikh_Ofeilh
38762>>>>>>>>>
38762>>>>>>>>>        // Clients.Client_Idiot
38762>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Idiot To (Clients_Client_Idiot_VT(Self))
38763>>>>>>>>>
38763>>>>>>>>>        // Clients.Client_Add_No
38763>>>>>>>>>
38763>>>>>>>>>        // Clients.Client_Nomos
38763>>>>>>>>>
38763>>>>>>>>>        // Clients.Client_Xora
38763>>>>>>>>>
38763>>>>>>>>>        // Clients.Polh_Recr
38763>>>>>>>>>
38763>>>>>>>>>        // Clients.Presp_Id
38763>>>>>>>>>
38763>>>>>>>>>        // Clients.Sum_Pct_Tpcl
38763>>>>>>>>>
38763>>>>>>>>>        // Clients.Is_Client
38763>>>>>>>>>
38763>>>>>>>>>        // Clients.Sysxetish
38763>>>>>>>>>
38763>>>>>>>>>        // Clients.Poso_Se_Apait
38763>>>>>>>>>
38763>>>>>>>>>        // Clients.Client_Glcode
38763>>>>>>>>>
38763>>>>>>>>>        // Clients.Is_Eksoter
38763>>>>>>>>>
38763>>>>>>>>>        // Clients.Is_Xondr
38763>>>>>>>>>
38763>>>>>>>>>        // Clients.Orio_Syn_Ofeilh
38763>>>>>>>>>
38763>>>>>>>>>        // Clients.Posa_Apo_Dap
38763>>>>>>>>>
38763>>>>>>>>>        // Clients.Client_Doybtm
38763>>>>>>>>>
38763>>>>>>>>>        // Clients.Posa_Apo_Parag
38763>>>>>>>>>
38763>>>>>>>>>        // Clients.Client_Ptyppar
38763>>>>>>>>>
38763>>>>>>>>>        // Clients.Client_Seira
38763>>>>>>>>>
38763>>>>>>>>>        // Clients.Hpso
38763>>>>>>>>>
38763>>>>>>>>>        // Clients.Hpal
38763>>>>>>>>>
38763>>>>>>>>>        // Clients.Feregios
38763>>>>>>>>>        Set Field_Value_Table      Field Clients.Feregios To (Clients_Feregios_VT(Self))
38764>>>>>>>>>
38764>>>>>>>>>        // Clients.Diakin
38764>>>>>>>>>
38764>>>>>>>>>        //DDB-DefineFieldEnd
38764>>>>>>>>>    End_Procedure    // Define_Fields
38765>>>>>>>>>
38765>>>>>>>>>    // Field_Defaults:
38765>>>>>>>>>    // This procedure is used to establish default field values.
38765>>>>>>>>>
38765>>>>>>>>>    Procedure Field_Defaults
38766>>>>>>>>>        Forward Send Field_Defaults
38768>>>>>>>>>        //DDB-Generated-Code-Location
38768>>>>>>>>>        //DDB-FieldDefaultStart
38768>>>>>>>>>        Set Field_Changed_Value   Field Clients.Client_Doy To "0"
38769>>>>>>>>>        //DDB-FieldDefaultEnd
38769>>>>>>>>>    End_Procedure    // Field_Defaults
38770>>>>>>>>>
38770>>>>>>>>>End_Class    // Clients_DataDictionary
38771>>>>>>>>>//DDB-Selection-pkg-Start
38771>>>>>>>>>
38771>>>>>>>>>Use sl100.SL        // sl100
38771>>>>>>>>>
38771>>>>>>>>>//DDB-Selection-pkg-End
38771>>>>>>>>>//DDB-FileEnd
38771>>>>>>>    
38771>>>>>>>    //AB-IgnoreEnd
38771>>>>>>>
38771>>>>>>>    Object sl100 is a dbModalPanelSub
38773>>>>>>>
38773>>>>>>>        //AB-StoreTopStart
38773>>>>>>>                
38773>>>>>>>        Property String     FragmaClient        Public ''
38775>>>>>>>        Property String     psIsPromhtheyths    Public ''
38777>>>>>>>        Property Integer    piMustConstrain     Public  0
38779>>>>>>>        Property String     psModule            Public ''
38781>>>>>>>        
38781>>>>>>>        //AB-StoreTopEnd
38781>>>>>>>
38781>>>>>>>        Set Label to "(Xlate(Label(Self)))"
38782>>>>>>>        Set Size to 252 509
38783>>>>>>>        Set Location to 4 5
38784>>>>>>>        Set Popup_State to TRUE
38785>>>>>>>
38785>>>>>>>        //AB-DDOStart
38785>>>>>>>
38785>>>>>>>        Object Clients_DD is a Clients_DataDictionary
38787>>>>>>>
38787>>>>>>>            //AB-StoreTopStart
38787>>>>>>>                        
38787>>>>>>>            //AB-StoreTopEnd
38787>>>>>>>
38787>>>>>>>
38787>>>>>>>            //AB-StoreStart
38787>>>>>>>                        
38787>>>>>>>            Begin_Constraints
38789>>>>>>>                     If (psModule(Self)='01') Constrain Clients.is_Client        Eq '1'
38793>>>>>>>                Else If (psModule(Self)='02') Constrain Clients.is_Promhtheyths  Eq '1'
38798>>>>>>>            End_Constraints
38801>>>>>>>            
38801>>>>>>>            
38801>>>>>>>            
38801>>>>>>>            //AB-StoreEnd
38801>>>>>>>
38801>>>>>>>        End_Object    // Clients_DD
38802>>>>>>>
38802>>>>>>>        Set Main_DD to (Clients_DD(self))
38803>>>>>>>        Set Server to (Clients_DD(self))
38804>>>>>>>
38804>>>>>>>        //AB-DDOEnd
38804>>>>>>>
38804>>>>>>>        Object oSelList is a dbListSub
38806>>>>>>>            Set Main_File to Clients.File_Number
38807>>>>>>>            Set Ordering to 6
38808>>>>>>>            Set Size to 204 496
38809>>>>>>>            Set Location to 7 5
38810>>>>>>>            Set Auto_Index_State to FALSE
38811>>>>>>>            Set Modal_State to TRUE
38812>>>>>>>
38812>>>>>>>            Begin_Row
38815>>>>>>>                Entry_Item Clients.Client_id
38816>>>>>>>                Entry_Item Clients.Client_name
38817>>>>>>>                Entry_Item Clients.Client_afm
38818>>>>>>>                Entry_Item Clients.Last_xreosh
38819>>>>>>>                Entry_Item Clients.Last_pistosh
38820>>>>>>>                Entry_Item Clients.Last_order
38821>>>>>>>                Entry_Item Clients.Is_client
38822>>>>>>>                Entry_Item Clients.Is_promhtheyths
38823>>>>>>>            End_Row
38828>>>>>>>
38828>>>>>>>            Set Form_Width    item 0 to 64
38829>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
38830>>>>>>>            
38830>>>>>>>            Set Form_Width    item 1 to 133
38831>>>>>>>            Set Header_Label  item 1 to "„§à¤¬£å˜"
38832>>>>>>>            
38832>>>>>>>            Set Form_Width    item 2 to 62
38833>>>>>>>            Set Header_Label  item 2 to "€”‹"
38834>>>>>>>            
38834>>>>>>>            Set Form_Width    item 3 to 60
38835>>>>>>>            Set Header_Label  item 3 to "’œ¢. •¨âà©ž"
38836>>>>>>>            
38836>>>>>>>            Set Form_Width    item 4 to 60
38837>>>>>>>            Set Header_Label  item 4 to "’œ¢. å©«à©ž"
38838>>>>>>>            
38838>>>>>>>            Set Form_Width    item 5 to 60
38839>>>>>>>            Set Header_Label  item 5 to "’œ¢. ˜¨˜š"
38840>>>>>>>            
38840>>>>>>>            Set Form_Width    item 6 to 26
38841>>>>>>>            Set Header_Label  item 6 to "œ¢"
38842>>>>>>>            Set Column_Checkbox_State  item 6 to True
38843>>>>>>>            
38843>>>>>>>            Set Form_Width    item 7 to 26
38844>>>>>>>            Set Header_Label  item 7 to "¨¦£"
38845>>>>>>>            Set Column_Checkbox_State  item 7 to True
38846>>>>>>>            
38846>>>>>>>
38846>>>>>>>            //AB-StoreStart
38846>>>>>>>            
38846>>>>>>>            //Property String StoreFragmaClient   Public ''
38846>>>>>>>            //Property String StorePsModule       Public ''
38846>>>>>>>            
38846>>>>>>>            //Procedure Store_Defaults
38846>>>>>>>            //    Forward Send Store_Defaults
38846>>>>>>>            //    Set StoreFragmaClient   to (FragmaClient(Self))
38846>>>>>>>            //    Set StorePsModule       to (psModule    (Self))
38846>>>>>>>            //End_Procedure
38846>>>>>>>            
38846>>>>>>>            //Procedure ReStore_Defaults
38846>>>>>>>            //    Forward Send ReStore_Defaults
38846>>>>>>>            //    Set FragmaClient to (StoreFragmaClient(Self))
38846>>>>>>>            //    Set psModule     to (StorePsModule    (Self))
38846>>>>>>>            //End_Procedure
38846>>>>>>>            
38846>>>>>>>            Set Column_Option Item 6 to NoEnter True
38847>>>>>>>            Set Column_Option Item 7 to NoEnter True
38848>>>>>>>            
38848>>>>>>>            Procedure Activating
38850>>>>>>>                Forward Send Activating
38852>>>>>>>                Set Auto_Index_State to True
38853>>>>>>>            End_Procedure
38854>>>>>>>            
38854>>>>>>>            Procedure Activate
38856>>>>>>>                Send Rebuild_Constraints    to Clients_DD
38857>>>>>>>                If (FragmaClient(Self)<>'') Begin
38859>>>>>>>                    Clear Clients
38860>>>>>>>                    Move (FragmaClient(Self)) to Clients.Client_ID
38861>>>>>>>                    Find Eq Clients By Index.6
38862>>>>>>>>
38862>>>>>>>                    If (Found) Send Request_Find to Clients_DD Eq Clients.File_Number 6
38865>>>>>>>                End
38865>>>>>>>>
38865>>>>>>>                Forward Send Activate
38867>>>>>>>            End_procedure
38868>>>>>>>            
38868>>>>>>>            
38868>>>>>>>            
38868>>>>>>>            
38868>>>>>>>            //AB-StoreEnd
38868>>>>>>>
38868>>>>>>>        End_Object    // oSelList
38869>>>>>>>
38869>>>>>>>        Object oOK_bn is a ButtonSub
38871>>>>>>>            Set Label to "&„§ ¢¦šã"
38872>>>>>>>            Set Location to 218 341
38873>>>>>>>
38873>>>>>>>            //AB-StoreStart
38873>>>>>>>            Procedure OnClick
38875>>>>>>>                Send OK To (oSelList(current_object))
38876>>>>>>>            End_Procedure
38877>>>>>>>            //AB-StoreEnd
38877>>>>>>>
38877>>>>>>>        End_Object    // oOK_bn
38878>>>>>>>
38878>>>>>>>        Object oCancel_bn is a ButtonSub
38880>>>>>>>            Set Label to "&€¡ç¨à©ž"
38881>>>>>>>            Set Location to 218 396
38882>>>>>>>
38882>>>>>>>            //AB-StoreStart
38882>>>>>>>            Procedure OnClick
38884>>>>>>>                Send Cancel To (oSelList(current_object))
38885>>>>>>>            End_Procedure
38886>>>>>>>            //AB-StoreEnd
38886>>>>>>>
38886>>>>>>>        End_Object    // oCancel_bn
38887>>>>>>>
38887>>>>>>>        Object oSearch_bn is a ButtonSub
38889>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
38890>>>>>>>            Set Location to 218 451
38891>>>>>>>
38891>>>>>>>            //AB-StoreStart
38891>>>>>>>            Procedure OnClick
38893>>>>>>>                Send Search To (oSelList(current_object))
38894>>>>>>>            End_Procedure
38895>>>>>>>            //AB-StoreEnd
38895>>>>>>>
38895>>>>>>>        End_Object    // oSearch_bn
38896>>>>>>>
38896>>>>>>>
38896>>>>>>>        //AB-StoreStart
38896>>>>>>>                
38896>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
38897>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
38898>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
38899>>>>>>>        
38899>>>>>>>        Set Locate_Mode to Center_On_Screen
38900>>>>>>>        Set Modal_State to True
38901>>>>>>>        
38901>>>>>>>        Procedure Activating Returns Integer
38903>>>>>>>            Integer rVal
38904>>>>>>>            Forward Get Msg_Activating to rVal
38906>>>>>>>                 if (psmodule(self)='01') set label of sl100 to '‰˜«á¢¦š¦ª œ¢˜«é¤'
38909>>>>>>>            else if (psmodule(self)='02') set label of sl100 to '‰˜«á¢¦š¦ª ¨¦£žŸœ¬«é¤'
38913>>>>>>>            Procedure_Return rVal
38914>>>>>>>        End_procedure
38915>>>>>>>        
38915>>>>>>>        
38915>>>>>>>        
38915>>>>>>>        
38915>>>>>>>        
38915>>>>>>>        
38915>>>>>>>        
38915>>>>>>>        //AB-StoreEnd
38915>>>>>>>
38915>>>>>>>    End_Object    // sl100
38916>>>>>>>
38916>>>>>>>//AB/     End_Object    // prj
38916>>>>>
38916>>>>>//DDB-Selection-pkg-End
38916>>>>>//DDB-FileEnd
38916>>>    
38916>>>    //AB-IgnoreEnd
38916>>>
38916>>>    Object dg186 is a dbModalPanelSub
38918>>>
38918>>>        //AB-StoreTopStart
38918>>>        Function fsclient string code Returns string
38920>>>            string name
38921>>>            clear clients
38922>>>            move code to clients.client_id
38923>>>            find eq clients by index.6
38924>>>>
38924>>>            move clients.client_name to name
38925>>>            function_return name
38926>>>        end_Function
38927>>>        
38927>>>        Property String     pscode                  ''
38929>>>        Property String     psperi                  ''
38931>>>        Property Integer    piContains_Or_Starts     0
38933>>>        Property String     pscodeprom              ''
38935>>>        
38935>>>        
38935>>>        //AB-StoreTopEnd
38935>>>
38935>>>        Set Label to "‘¬©®œ«å©œ ª „ ›é¤ €§¦Ÿã¡žª"
38936>>>        Set Size to 289 527
38937>>>        Set Location to 0 2
38938>>>
38938>>>        //AB-DDOStart
38938>>>
38938>>>        Object Witemkat_DD is a Witemkat_DataDictionary
38940>>>        End_Object    // Witemkat_DD
38941>>>
38941>>>        Object Units_DD is a Units_DataDictionary
38943>>>        End_Object    // Units_DD
38944>>>
38944>>>        Object Fpa_DD is a Fpa_DataDictionary
38946>>>        End_Object    // Fpa_DD
38947>>>
38947>>>        Object Item_DD is a Item_DataDictionary
38949>>>            Set DDO_Server to (Units_DD(self))
38950>>>            Set DDO_Server to (Witemkat_DD(self))
38951>>>            Set DDO_Server to (Fpa_DD(self))
38952>>>        End_Object    // Item_DD
38953>>>
38953>>>        Object Witemcl_DD is a Witemcl_DataDictionary
38955>>>
38955>>>            //AB-StoreTopStart
38955>>>            Function fiPeriexei Returns Integer
38957>>>                       String lsperi lscode  lscodeprom
38958>>>                       Integer rVal liContains_Or_Starts
38958>>>                       Move 0 to rVal
38959>>>                       Get piContains_Or_Starts to liContains_Or_Starts
38960>>>                       Get psperi to lsperi
38961>>>                       Get pscode to lscode
38962>>>                       Get pscodeprom to lscodeprom
38963>>>                       Move (Trim(lsperi)) to lsperi
38964>>>                       Move (Trim(lscode)) to lscode
38965>>>                  //     Move (Trim(lscodekat)) to lscodekat
38965>>>                       If (liContains_Or_Starts=0) Begin
38967>>>                           If ((Trim(witemcl.item_descr)) Contains lsperi) Begin
38969>>>                               If ((Trim(witemcl.item_code)) Contains lscode) Move 1 to rVal
38972>>>                           End
38972>>>>
38972>>>            
38972>>>                       End
38972>>>>
38972>>>                       Else Begin
38973>>>                           If (Left(witemcl.item_descr,(Length(lsperi)))=lsperi) Begin
38975>>>                               If (Left(witemcl.item_code,(Length(lscode)))=lscode) Move 1 to rVal
38978>>>                           End
38978>>>>
38978>>>            
38978>>>                       End
38978>>>>
38978>>>                       Function_Return rVal
38979>>>                   End_Function
38980>>>            
38980>>>                   Function fiArxizeiperi Returns Integer
38982>>>                       String lsperi
38983>>>                       Get psperi to lsperi
38984>>>                       Move (Trim(lsperi)) to lsperi
38985>>>                       Function_Return (Left(witemcl.item_descr,(Length(lsperi)))=lsperi)
38986>>>                   End_Function
38987>>>            
38987>>>                   Function fiArxizeicode Returns Integer
38989>>>                       String lscode lscodeprom
38990>>>                       Get pscode to lscode
38991>>>                       Move (Trim(lscode)) to lscode
38992>>>                       Function_Return (Left(witemcl.item_code,(Length(lscode)))=lscode)
38993>>>                   End_Function
38994>>>            
38994>>>            //AB-StoreTopEnd
38994>>>
38994>>>            Set DDO_Server to (Item_DD(self))
38995>>>
38995>>>            //AB-StoreStart
38995>>>                                                                
38995>>>                                                                
38995>>>            Begin_Constraints
38997>>>               String lsperi lscode lsvalue lstype lscodeprom
38998>>>               Integer liContains_Or_Starts
38998>>>                   Get psperi  to lsperi
38999>>>                   Get pscode  to lscode
39000>>>                   Get pscodeprom  to lscodeprom
39001>>>                   Get piContains_Or_Starts to liContains_Or_Starts
39002>>>                   Move (Trim(lsperi)) to lsperi
39003>>>                   Move (Trim(lscode)) to lscode
39004>>>                   Move (Trim(lscodeprom)) to lscodeprom
39005>>>                   If ((lsperi<>'') and ;                      (lscode<>'')) Constrain witemcl as (fiPeriexei(Self)=1)
39008>>>                   Else Begin
39009>>>                      If (liContains_Or_Starts=0) Begin
39011>>>                      If (lsperi<>'') Constrain witemcl.item_descr Contains lsperi
39015>>>                      Else If (lscode<>'') Constrain witemcl.item_code Contains lscode
39020>>>                      End
39020>>>>
39020>>>                   Else Begin
39021>>>                       If (lsperi<>'') Constrain witemcl as (fiArxizeiperi(Self)=1) //witemcl.item_descr
39024>>>                       Else If (lscode<>'') Constrain witemcl as (fiArxizeicode(Self)=1) //witemcl.item_code
39028>>>                       End
39028>>>>
39028>>>                   End
39028>>>>
39028>>>                   If (lscodeprom<>'') Constrain witemcl.client_itemcode Contains lscodeprom
39032>>>            
39032>>>            End_Constraints
39035>>>            
39035>>>            
39035>>>            //AB-StoreEnd
39035>>>
39035>>>        End_Object    // Witemcl_DD
39036>>>
39036>>>        Set Main_DD to (Witemcl_DD(self))
39037>>>        Set Server to (Witemcl_DD(self))
39038>>>
39038>>>        //AB-DDOEnd
39038>>>
39038>>>        Object The_Table is a dbGrid
39040>>>            Set Main_File to Witemcl.File_Number
39041>>>            Set Size to 201 519
39042>>>            Set Location to 3 2
39043>>>            Set Color to 14280447
39044>>>            Set CurrentRowColor to 11783679
39045>>>            Set CurrentCellColor to 11783679
39046>>>            Set Wrap_State to TRUE
39047>>>
39047>>>            Begin_Row
39050>>>                Entry_Item Witemcl.Item_code
39051>>>                Entry_Item Witemcl.Client_itemcode
39052>>>                Entry_Item Witemcl.Item_descr
39053>>>                Entry_Item Witemcl.Client_code
39054>>>                Entry_Item (fsclient(self,witemcl.client_code))
39055>>>            End_Row
39060>>>
39060>>>            Set Form_Width    item 0 to 100
39061>>>            Set Header_Label  item 0 to "‰à› ¡æª „å›¦¬ª"
39062>>>            
39062>>>            Set Form_Width    item 1 to 100
39063>>>            Set Header_Label  item 1 to "„å›¦ª ¨¦£žŸœ¬«ã"
39064>>>            
39064>>>            Set Form_Width    item 2 to 200
39065>>>            Set Header_Label  item 2 to "œ¨ š¨˜­ã „å›¦¬ª"
39066>>>            
39066>>>            Set Form_Width    item 3 to 0
39067>>>            Set Header_Label  item 3 to ""
39068>>>            
39068>>>            Set Form_Width    item 4 to 111
39069>>>            Set Header_Label  item 4 to "¨¦£žŸœ¬«ãª"
39070>>>            
39070>>>
39070>>>            //AB-StoreStart
39070>>>            Set Column_Option Item 3 to NoEnter True
39071>>>            //set read_only_state to true
39071>>>            set no_create_state to true
39072>>>            set no_delete_state to true
39073>>>            //AB-StoreEnd
39073>>>
39073>>>        End_Object    // The_Table
39074>>>
39074>>>        Object TextBoxSub1 is a TextBoxSub
39076>>>            Set Label to "‘á¨à©ž ‰à› ¡¦ç ‚ á"
39077>>>            Set Auto_Size_State to FALSE
39078>>>            Set Location to 208 5
39079>>>            Set Size to 13 78
39080>>>        End_Object    // TextBoxSub1
39081>>>
39081>>>        Object TextBoxSub2 is a TextBoxSub
39083>>>            Set Label to "‘á¨à©ž œ¨ š¨˜­ãª "
39084>>>            Set Auto_Size_State to FALSE
39085>>>            Set Location to 223 5
39086>>>            Set Size to 13 83
39087>>>        End_Object    // TextBoxSub2
39088>>>
39088>>>        Object TextBoxSub3 is a TextBoxSub
39090>>>            Set Label to "„å›¦ª ¨¦£žŸœ¬«ã ‚ á"
39091>>>            Set Auto_Size_State to FALSE
39092>>>            Set Location to 237 5
39093>>>            Set Size to 13 78
39094>>>        End_Object    // TextBoxSub3
39095>>>
39095>>>        Object ocode is a FormSub
39097>>>            Set Size to 13 197
39098>>>            Set Location to 209 91
39099>>>            Set Label_Col_Offset to 2
39100>>>
39100>>>            //AB-StoreStart
39100>>>                                                                                                                                                                                                    
39100>>>            Procedure OnKILLFOCUS
39102>>>               Send KeyAction to ButtonSub1
39103>>>            End_Procedure
39104>>>            
39104>>>            
39104>>>            
39104>>>            
39104>>>            //AB-StoreEnd
39104>>>
39104>>>        End_Object    // ocode
39105>>>
39105>>>        Object operi is a FormSub
39107>>>            Set Size to 13 197
39108>>>            Set Location to 223 91
39109>>>            Set Label_Col_Offset to 2
39110>>>
39110>>>            //AB-StoreStart
39110>>>                                                                                                                                                                                                    
39110>>>            Procedure OnKILLFOCUS
39112>>>              Send KeyAction to ButtonSub1
39113>>>            End_Procedure
39114>>>            
39114>>>            
39114>>>            
39114>>>            
39114>>>            //AB-StoreEnd
39114>>>
39114>>>        End_Object    // operi
39115>>>
39115>>>        Object ocodeprom is a FormSub
39117>>>            Set Size to 13 197
39118>>>            Set Location to 238 91
39119>>>            Set Label_Col_Offset to 2
39120>>>
39120>>>            //AB-StoreStart
39120>>>                                                                                                                                                                                                    
39120>>>            Procedure OnKILLFOCUS
39122>>>                Send KeyAction to ButtonSub1
39123>>>            End_Procedure
39124>>>            
39124>>>            
39124>>>            
39124>>>            //AB-StoreEnd
39124>>>
39124>>>        End_Object    // ocodeprom
39125>>>
39125>>>        Object RadioGroupSub1 is a RadioGroupSub
39127>>>            Set Size to 32 77
39128>>>            Set Location to 209 296
39129>>>            Object Radio1 is a RadioSub
39131>>>                Set Label to "œ¨ â®œ«˜ "
39132>>>                Set Size to 10 53
39133>>>                Set Location to 7 5
39134>>>            End_Object    // Radio1
39135>>>
39135>>>            Object Radio2 is a RadioSub
39137>>>                Set Label to "€¨®åœ  €§æ"
39138>>>                Set Size to 10 51
39139>>>                Set Location to 21 5
39140>>>            End_Object    // Radio2
39141>>>
39141>>>
39141>>>            //AB-StoreStart
39141>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
39141>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
39143>>>                //iToItem=0 => Contains, =1 => Starts with
39143>>>                Set piContains_Or_Starts to iToItem
39144>>>                Send KeyAction to ButtonSub1
39145>>>            End_Procedure
39146>>>            
39146>>>            // If you set Current_radio you must set this after the
39146>>>            // radio objects have been created AND after Notify_select_State has been
39146>>>            // created. i.e. Set in bottom-code at end!!
39146>>>            //Set Current_Radio to 0
39146>>>            
39146>>>            
39146>>>            //AB-StoreEnd
39146>>>
39146>>>        End_Object    // RadioGroupSub1
39147>>>
39147>>>        Object ButtonSub1 is a ButtonSub
39149>>>            Set Label to "Search"
39150>>>            Set Size to 28 37
39151>>>            Set Location to 210 413
39152>>>            Set Form_FontWeight Item 0 to 800
39153>>>            Set Form_TypeFace Item 0 to "ms sans serif"
39154>>>
39154>>>            //AB-StoreStart
39154>>>                                        
39154>>>            Set Visible_State to False
39155>>>            
39155>>>            Procedure OnClick
39157>>>                Forward Send OnClick
39159>>>                Set pscode  to (Value(ocode(Self),0))
39160>>>                Set psperi  to (Value(operi(Self),0))
39161>>>                Set pscodeprom  to (Value(ocodeprom(Self),0))
39162>>>                send Rebuild_Constraints    to (witemcl_DD(Self))
39163>>>                Send Beginning_Of_Data      to the_table
39164>>>            End_Procedure // OnClick
39165>>>            
39165>>>            
39165>>>            
39165>>>            
39165>>>            
39165>>>            
39165>>>            
39165>>>            
39165>>>            
39165>>>            
39165>>>            
39165>>>            
39165>>>            
39165>>>            
39165>>>            
39165>>>            //AB-StoreEnd
39165>>>
39165>>>        End_Object    // ButtonSub1
39166>>>
39166>>>        Object btnwitemcl is a ButtonSub
39168>>>
39168>>>            //AB-StoreTopStart
39168>>>                                                                                    
39168>>>            //AB-StoreTopEnd
39168>>>
39168>>>            Set Label to "ButtonSub1"
39169>>>            Set Bitmap to "Filesys3.bmp"
39170>>>            Set Size to 22 25
39171>>>            Set Location to 214 482
39172>>>            Set Focus_Mode to Pointer_Only
39173>>>
39173>>>            //AB-StoreStart
39173>>>                                                                                    
39173>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«¦ œ¬¨œ«ã¨ ¦ „ ›é¤"
39174>>>            
39174>>>            Procedure OnClick
39176>>>                String  scode speri
39177>>>                Get value of (ocode(self)) to scode
39178>>>                Get value of (operi(self)) to speri
39179>>>                set pscode of (sl17(self)) to scode
39180>>>                set psperi of (sl17(self)) to speri
39181>>>                send request_cancel to dg186
39182>>>            End_Procedure // OnClick
39183>>>            
39183>>>            
39183>>>            
39183>>>            
39183>>>            
39183>>>            
39183>>>            
39183>>>            
39183>>>            
39183>>>            
39183>>>            
39183>>>            
39183>>>            
39183>>>            
39183>>>            
39183>>>            
39183>>>            
39183>>>            
39183>>>            
39183>>>            
39183>>>            
39183>>>            //AB-StoreEnd
39183>>>
39183>>>        End_Object    // btnwitemcl
39184>>>
39184>>>
39184>>>        //AB-StoreStart
39184>>>        Procedure Activating
39186>>>           integer rval
39187>>>           set value of (ocode(self)) to (pscode(self))
39188>>>           set value of (operi(self)) to (psperi(self))
39189>>>           Send Rebuild_Constraints to (witemcl_DD(Self))
39190>>>           Forward send Activating
39192>>>        
39192>>>        End_Procedure
39193>>>        
39193>>>        
39193>>>        
39193>>>        
39193>>>        
39193>>>        
39193>>>        //AB-StoreEnd
39193>>>
39193>>>    End_Object    // dg186
39194>>>
39194>>>
39194>>>    //AB-StoreStart
39194>>>        
39194>>>    //AB-StoreEnd
39194>>>
39194>>>//AB/     End_Object    // prj
39194>        Use Listes
INCLUDING FILE: LISTES.PKG
39194>>>Use Wax.sl
INCLUDING FILE: WAX.SL
39194>>>>>//AB/ Project Wax:Lookup Apothikhs
39194>>>>>//AB/ Object prj is a Lookup_Project
39194>>>>>//AB/     Set ProjectName to "Wax:Lookup Apothikhs"
39194>>>>>//AB/     Set ProjectFileName to "Wax.SL"
39194>>>>>//AB/     Set GenerateFileName to "NONAME"
39194>>>>>
39194>>>>>// Project Object Structure
39194>>>>>//   Wax is a dbModalPanelSub
39194>>>>>//     Wapokat_DD is a DataDictionary
39194>>>>>//     Wapomast_DD is a DataDictionary
39194>>>>>//     Wax_DD is a DataDictionary
39194>>>>>//     oSelList is a dbListSub
39194>>>>>//     oOK_bn is a ButtonSub
39194>>>>>//     oCancel_bn is a ButtonSub
39194>>>>>//     oSearch_bn is a ButtonSub
39194>>>>>
39194>>>>>// Register all objects
39194>>>>>Register_Object oCancel_bn
39194>>>>>Register_Object oOK_bn
39194>>>>>Register_Object oSearch_bn
39194>>>>>Register_Object oSelList
39194>>>>>Register_Object Wapokat_DD
39194>>>>>Register_Object Wapomast_DD
39194>>>>>Register_Object Wax
39194>>>>>Register_Object Wax_DD
39194>>>>>
39194>>>>>
39194>>>>>//AB-IgnoreStart
39194>>>>>
39194>>>>>Use DFAllEnt.pkg
39194>>>>>Use dbList.Sub
39194>>>>>Use Button.Sub
39194>>>>>
39194>>>>>
39194>>>>>Use WAPOKAT.DD
39194>>>>>Use WAPOMAST.DD
INCLUDING FILE: WAPOMAST.DD
39194>>>>>>>//DDB-FileStart
39194>>>>>>>//DDB-HeaderStart
39194>>>>>>>
39194>>>>>>>// File Name : WAPOMAST.DD
39194>>>>>>>// Class Name: Wapomast_DataDictionary
39194>>>>>>>// Revision  : 13
39194>>>>>>>// Version   : 2
39194>>>>>>>
39194>>>>>>>Use  Windows           // Basic Definitions
39194>>>>>>>Use  DataDict          // DataDictionary Class Definition
39194>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39194>>>>>>>
39194>>>>>>>Open Wapomast
39196>>>>>>>Open Wax
39198>>>>>>>Open Wapokat
39200>>>>>>>Open Sysrecw
39202>>>>>>>
39202>>>>>>>//DDB-HeaderEnd
39202>>>>>>>//DDB-SelectionStart
39202>>>>>>>//DDB/ ExternalSelectionList sl023  sl023.SL
39202>>>>>>>Register_Object sl023
39202>>>>>>>//DDB-SelectionEnd
39202>>>>>>>
39202>>>>>>>Class Wapomast_DataDictionary  is a DataDictionary
39203>>>>>>>    // Update:
39203>>>>>>>    Procedure Update
39204>>>>>>>        Forward Send Update
39206>>>>>>>        // Insert Code Here
39206>>>>>>>//        Move SysCurXR.Company_Code   to Wapomast.Company_Code
39206>>>>>>>//        Move SysCurXR.Branch_Code     to Wapomast.Branch_Code
39206>>>>>>>//        Move SysCurXR.Year_Year         to Wapomast.Year_Year
39206>>>>>>>        Move Wapokat.Wapokat_Code   to Wapomast.Wapokat_Code
39207>>>>>>>    End_Procedure   // Update
39208>>>>>>> 
39208>>>>>>>     Procedure Creating
39209>>>>>>>        Forward Send Creating
39211>>>>>>>        // Insert Code Here
39211>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wapomast.Wapomast_Rec0)))))) to Wapomast.Wapomast_Recr
39212>>>>>>>    End_Procedure   // Creating
39213>>>>>>>
39213>>>>>>>
39213>>>>>>>    // Define_Fields:
39213>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39213>>>>>>>
39213>>>>>>>    Procedure Define_Fields
39214>>>>>>>        Forward Send Define_Fields
39216>>>>>>>        //DDB-Generated-Code-Location
39216>>>>>>>        //DDB-DefineFieldStart
39216>>>>>>>
39216>>>>>>>        Set Main_File            To Wapomast.File_Number
39217>>>>>>>        Set Cascade_Delete_State To FALSE
39218>>>>>>>
39218>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39219>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39220>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39221>>>>>>>
39221>>>>>>>        // Child (Client) file structure................
39221>>>>>>>        Send Add_Client_File  Wax.File_Number
39222>>>>>>>
39222>>>>>>>        // Parent (Server) file structure...............
39222>>>>>>>        Send Add_Server_File  Wapokat.File_Number
39223>>>>>>>
39223>>>>>>>        // External (System) file structure.............
39223>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
39224>>>>>>>
39224>>>>>>>        Define_Auto_Increment  Sysrecw.Wapomast_Rec0  To Wapomast.Wapomast_Rec0
39227>>>>>>>
39227>>>>>>>        // Field-based properties.......................
39227>>>>>>>
39227>>>>>>>        // Wapomast.Wapokat_Code
39227>>>>>>>
39227>>>>>>>        // Wapomast.Wapokat_Recr
39227>>>>>>>
39227>>>>>>>        // Wapomast.Wapomast_Code
39227>>>>>>>        Set Field_Options          Field Wapomast.Wapomast_Code To DD_AUTOFIND   
39228>>>>>>>        Set Field_Prompt_Object    Field Wapomast.Wapomast_Code To (sl023(Self))
39229>>>>>>>
39229>>>>>>>        // Wapomast.Wapomast_Rec0
39229>>>>>>>        Set Field_Options          Field Wapomast.Wapomast_Rec0 To DD_AUTOFIND   
39230>>>>>>>
39230>>>>>>>        // Wapomast.Wapomast_Descr
39230>>>>>>>        Set Field_Prompt_Object    Field Wapomast.Wapomast_Descr To (sl023(Self))
39231>>>>>>>
39231>>>>>>>        // Wapomast.Wapomast_Recr
39231>>>>>>>        Set Field_Options          Field Wapomast.Wapomast_Recr To DD_AUTOFIND   
39232>>>>>>>
39232>>>>>>>        //DDB-DefineFieldEnd
39232>>>>>>>    End_Procedure    // Define_Fields
39233>>>>>>>
39233>>>>>>>    // Field_Defaults:
39233>>>>>>>    // This procedure is used to establish default field values.
39233>>>>>>>
39233>>>>>>>    Procedure Field_Defaults
39234>>>>>>>        Forward Send Field_Defaults
39236>>>>>>>        //DDB-Generated-Code-Location
39236>>>>>>>        //DDB-FieldDefaultStart
39236>>>>>>>        //DDB-FieldDefaultEnd
39236>>>>>>>    End_Procedure    // Field_Defaults
39237>>>>>>>
39237>>>>>>>End_Class    // Wapomast_DataDictionary
39238>>>>>>>//DDB-Selection-pkg-Start
39238>>>>>>>
39238>>>>>>>Use sl023.SL         // sl023
INCLUDING FILE: SL023.SL
39238>>>>>>>>>//AB/ Project sl023:apothkes
39238>>>>>>>>>//AB/ Object prj is a Lookup_Project
39238>>>>>>>>>//AB/     Set ProjectName to "sl023:apothkes"
39238>>>>>>>>>//AB/     Set ProjectFileName to "sl023.SL"
39238>>>>>>>>>
39238>>>>>>>>>// Project Object Structure
39238>>>>>>>>>//   sl023 is a dbModalPanelSub
39238>>>>>>>>>//     Wapokat_DD is a DataDictionary
39238>>>>>>>>>//     Wapomast_DD is a DataDictionary
39238>>>>>>>>>//     oSelList is a dbListSub
39238>>>>>>>>>//     oOK_bn is a ButtonSub
39238>>>>>>>>>//     oCancel_bn is a ButtonSub
39238>>>>>>>>>//     oSearch_bn is a ButtonSub
39238>>>>>>>>>
39238>>>>>>>>>// Register all objects
39238>>>>>>>>>Register_Object oCancel_bn
39238>>>>>>>>>Register_Object oOK_bn
39238>>>>>>>>>Register_Object oSearch_bn
39238>>>>>>>>>Register_Object oSelList
39238>>>>>>>>>Register_Object sl023
39238>>>>>>>>>Register_Object Wapokat_DD
39238>>>>>>>>>Register_Object Wapomast_DD
39238>>>>>>>>>
39238>>>>>>>>>
39238>>>>>>>>>//AB-IgnoreStart
39238>>>>>>>>>
39238>>>>>>>>>Use DFAllEnt.pkg
39238>>>>>>>>>Use dbList.Sub
39238>>>>>>>>>Use Button.Sub
39238>>>>>>>>>
39238>>>>>>>>>
39238>>>>>>>>>Use WAPOKAT.DD
39238>>>>>>>>>Use WAPOMAST.DD
39238>>>>>>>>>
39238>>>>>>>>>//AB-IgnoreEnd
39238>>>>>>>>>
39238>>>>>>>>>Object sl023 is a dbModalPanelSub
39240>>>>>>>>>
39240>>>>>>>>>    //AB-StoreTopStart
39240>>>>>>>>>    property string psapokat public ''
39242>>>>>>>>>    //AB-StoreTopEnd
39242>>>>>>>>>
39242>>>>>>>>>    Set Label to "€§¦Ÿã¡œª"
39243>>>>>>>>>    Set Size to 126 260
39244>>>>>>>>>    Set Location to 4 19
39245>>>>>>>>>    Set Exit_Application_Local_State to FALSE
39246>>>>>>>>>    Set Modal_State to FALSE
39247>>>>>>>>>
39247>>>>>>>>>    //AB-DDOStart
39247>>>>>>>>>
39247>>>>>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
39249>>>>>>>>>    End_Object    // Wapokat_DD
39250>>>>>>>>>
39250>>>>>>>>>    Object Wapomast_DD is a Wapomast_DataDictionary
39252>>>>>>>>>        Set DDO_Server to (Wapokat_DD(self))
39253>>>>>>>>>
39253>>>>>>>>>        //AB-StoreStart
39253>>>>>>>>>        
39253>>>>>>>>>        begin_constraints
39255>>>>>>>>>          if (psapokat(self) <> '') constrain wapomast.wapokat_code eq (psapokat(self))
39259>>>>>>>>>        
39259>>>>>>>>>        end_constraints
39262>>>>>>>>>        
39262>>>>>>>>>        //AB-StoreEnd
39262>>>>>>>>>
39262>>>>>>>>>    End_Object    // Wapomast_DD
39263>>>>>>>>>
39263>>>>>>>>>    Set Main_DD to (Wapomast_DD(self))
39264>>>>>>>>>    Set Server to (Wapomast_DD(self))
39265>>>>>>>>>
39265>>>>>>>>>    //AB-DDOEnd
39265>>>>>>>>>
39265>>>>>>>>>    Object oSelList is a dbListSub
39267>>>>>>>>>        Set Main_File to Wapomast.File_Number
39268>>>>>>>>>        Set Server to (Wapokat_DD(self))
39269>>>>>>>>>        Set Size to 89 240
39270>>>>>>>>>        Set Location to 6 6
39271>>>>>>>>>
39271>>>>>>>>>        Begin_Row
39274>>>>>>>>>            Entry_Item Wapomast.Wapomast_code
39275>>>>>>>>>            Entry_Item Wapomast.Wapomast_descr
39276>>>>>>>>>        End_Row
39281>>>>>>>>>
39281>>>>>>>>>        Set Form_Width    item 0 to 70
39282>>>>>>>>>        Set Header_Label  item 0 to "€§¦Ÿã¡ž      :"
39283>>>>>>>>>        
39283>>>>>>>>>        Set Form_Width    item 1 to 160
39284>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
39285>>>>>>>>>        
39285>>>>>>>>>
39285>>>>>>>>>        //AB-StoreStart
39285>>>>>>>>>                    
39285>>>>>>>>>                    
39285>>>>>>>>>        //AB-StoreEnd
39285>>>>>>>>>
39285>>>>>>>>>    End_Object    // oSelList
39286>>>>>>>>>
39286>>>>>>>>>    Object oOK_bn is a ButtonSub
39288>>>>>>>>>        Set Label to "&„§ ¢¦šã"
39289>>>>>>>>>        Set Location to 92 81
39290>>>>>>>>>
39290>>>>>>>>>        //AB-StoreStart
39290>>>>>>>>>        Procedure OnClick
39292>>>>>>>>>            Send OK To (oSelList(current_object))
39293>>>>>>>>>        End_Procedure
39294>>>>>>>>>        //AB-StoreEnd
39294>>>>>>>>>
39294>>>>>>>>>    End_Object    // oOK_bn
39295>>>>>>>>>
39295>>>>>>>>>    Object oCancel_bn is a ButtonSub
39297>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
39298>>>>>>>>>        Set Location to 92 135
39299>>>>>>>>>
39299>>>>>>>>>        //AB-StoreStart
39299>>>>>>>>>        Procedure OnClick
39301>>>>>>>>>            Send Cancel To (oSelList(current_object))
39302>>>>>>>>>        End_Procedure
39303>>>>>>>>>        //AB-StoreEnd
39303>>>>>>>>>
39303>>>>>>>>>    End_Object    // oCancel_bn
39304>>>>>>>>>
39304>>>>>>>>>    Object oSearch_bn is a ButtonSub
39306>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
39307>>>>>>>>>        Set Location to 92 191
39308>>>>>>>>>
39308>>>>>>>>>        //AB-StoreStart
39308>>>>>>>>>        Procedure OnClick
39310>>>>>>>>>            Send Search To (oSelList(current_object))
39311>>>>>>>>>        End_Procedure
39312>>>>>>>>>        //AB-StoreEnd
39312>>>>>>>>>
39312>>>>>>>>>    End_Object    // oSearch_bn
39313>>>>>>>>>
39313>>>>>>>>>
39313>>>>>>>>>    //AB-StoreStart
39313>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39314>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39315>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39316>>>>>>>>>    
39316>>>>>>>>>    procedure activate
39318>>>>>>>>>        send rebuild_constraints to wapomast_dd
39319>>>>>>>>>        send beginning_of_data to osellist true
39320>>>>>>>>>        forward send activate
39322>>>>>>>>>    end_procedure
39323>>>>>>>>>    
39323>>>>>>>>>    
39323>>>>>>>>>    //AB-StoreEnd
39323>>>>>>>>>
39323>>>>>>>>>End_Object    // sl023
39324>>>>>>>>>
39324>>>>>>>>>//AB/ End_Object    // prj
39324>>>>>>>
39324>>>>>>>//DDB-Selection-pkg-End
39324>>>>>>>//DDB-FileEnd
39324>>>>>Use WAX.DD
INCLUDING FILE: WAX.DD
39324>>>>>>>//DDB-FileStart
39324>>>>>>>//DDB-HeaderStart
39324>>>>>>>
39324>>>>>>>// File Name : WAX.DD
39324>>>>>>>// Class Name: Wax_DataDictionary
39324>>>>>>>// Revision  : 39
39324>>>>>>>// Version   : 2
39324>>>>>>>
39324>>>>>>>Use  Windows           // Basic Definitions
39324>>>>>>>Use  DataDict          // DataDictionary Class Definition
39324>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39324>>>>>>>
39324>>>>>>>Open Wax
39326>>>>>>>Open Pmoves
39328>>>>>>>Open Wcmoves
39330>>>>>>>Open Wam
39332>>>>>>>Open Pmovesl
39334>>>>>>>Open Wapomast
39336>>>>>>>Open Sysrecw
39338>>>>>>>Open Syscurxr
39340>>>>>>>
39340>>>>>>>//DDB-HeaderEnd
39340>>>>>>>//DDB-SelectionStart
39340>>>>>>>//DDB/ ExternalSelectionList Wax  Wax.SL
39340>>>>>>>Register_Object Wax
39340>>>>>>>//DDB-SelectionEnd
39340>>>>>>>
39340>>>>>>>Class Wax_DataDictionary  is a DataDictionary_Sec
39341>>>>>>>
39341>>>>>>>    Procedure Construct_Object
39342>>>>>>>        Forward Send Construct_Object
39344>>>>>>>        Property Integer piMustNOTConstrain Public 0
39345>>>>>>>    End_Procedure //construct_object
39346>>>>>>>
39346>>>>>>>    Procedure OnConstrain
39347>>>>>>>        Forward Send OnConstrain
39349>>>>>>>        If (piMustNOTConstrain(Self)) Begin
39351>>>>>>>        End
39351>>>>>>>>
39351>>>>>>>        Else Begin
39352>>>>>>>            Constrain Wax.Company_Code  eq SysCurXR.Company_Code
39354>>>>>>>            Constrain Wax.Branch_Code   eq SysCurXR.Branch_Code
39356>>>>>>>            Constrain Wax.Year_Year     eq SysCurXR.Year_Year
39358>>>>>>>        End
39358>>>>>>>>
39358>>>>>>>    End_Procedure
39359>>>>>>>
39359>>>>>>>
39359>>>>>>>    // Update:
39359>>>>>>>    Procedure Update
39360>>>>>>>        Forward Send Update
39362>>>>>>>        // Insert Code Here
39362>>>>>>>        Move SysCurXR.Company_Code  to Wax.Company_Code
39363>>>>>>>        Move SysCurXR.Branch_Code   to Wax.Branch_Code
39364>>>>>>>        Move SysCurXR.Year_Year     to Wax.Year_Year
39365>>>>>>>        Move SysCurXR.Year_Recr     to Wax.Year_Recr
39366>>>>>>>        Move Wapokat.Wapokat_Code   to Wax.Wapokat_Code
39367>>>>>>>        Move Wapomast.Wapomast_Code to Wax.Wapomast_Code
39368>>>>>>>    End_Procedure   // Update
39369>>>>>>>
39369>>>>>>>     Procedure Creating
39370>>>>>>>        Forward Send Creating
39372>>>>>>>        // Insert Code Here
39372>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wax.Wax_Rec0)))))) to Wax.Wax_Recr
39373>>>>>>>    End_Procedure   // Creating
39374>>>>>>>
39374>>>>>>>
39374>>>>>>>
39374>>>>>>>    // Define_Fields:
39374>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39374>>>>>>>
39374>>>>>>>    Procedure Define_Fields
39375>>>>>>>        Forward Send Define_Fields
39377>>>>>>>        //DDB-Generated-Code-Location
39377>>>>>>>        //DDB-DefineFieldStart
39377>>>>>>>
39377>>>>>>>        Set Main_File            To Wax.File_Number
39378>>>>>>>        Set Cascade_Delete_State To FALSE
39379>>>>>>>
39379>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39380>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39381>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39382>>>>>>>
39382>>>>>>>        // Child (Client) file structure................
39382>>>>>>>        Send Add_Client_File  Pmoves.File_Number
39383>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
39384>>>>>>>        Send Add_Client_File  Wam.File_Number
39385>>>>>>>        Send Add_Client_File  Pmovesl.File_Number
39386>>>>>>>
39386>>>>>>>        // Parent (Server) file structure...............
39386>>>>>>>        Send Add_Server_File  Wapomast.File_Number
39387>>>>>>>
39387>>>>>>>        // External (System) file structure.............
39387>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
39388>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
39389>>>>>>>
39389>>>>>>>        Define_Auto_Increment  Sysrecw.Wax_Rec0  To Wax.Wax_Rec0
39392>>>>>>>
39392>>>>>>>        // Field-based properties.......................
39392>>>>>>>
39392>>>>>>>        // Wax.Company_Code
39392>>>>>>>
39392>>>>>>>        // Wax.Branch_Code
39392>>>>>>>
39392>>>>>>>        // Wax.Year_Year
39392>>>>>>>
39392>>>>>>>        // Wax.Wapokat_Code
39392>>>>>>>
39392>>>>>>>        // Wax.Wapomast_Code
39392>>>>>>>
39392>>>>>>>        // Wax.Wax_Code
39392>>>>>>>        Set Field_Options          Field Wax.Wax_Code To DD_AUTOFIND   
39393>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Code To (Wax(Self))
39394>>>>>>>
39394>>>>>>>        // Wax.Year_Recr
39394>>>>>>>
39394>>>>>>>        // Wax.Wapomast_Recr
39394>>>>>>>
39394>>>>>>>        // Wax.Wax_Rec0
39394>>>>>>>        Set Field_Options          Field Wax.Wax_Rec0 To DD_AUTOFIND   
39395>>>>>>>
39395>>>>>>>        // Wax.Wax_Recr
39395>>>>>>>        Set Field_Options          Field Wax.Wax_Recr To DD_AUTOFIND   
39396>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Recr To (Wax(Self))
39397>>>>>>>
39397>>>>>>>        // Wax.Wax_Descr
39397>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Descr To (Wax(Self))
39398>>>>>>>
39398>>>>>>>        //DDB-DefineFieldEnd
39398>>>>>>>    End_Procedure    // Define_Fields
39399>>>>>>>
39399>>>>>>>    // Field_Defaults:
39399>>>>>>>    // This procedure is used to establish default field values.
39399>>>>>>>
39399>>>>>>>    Procedure Field_Defaults
39400>>>>>>>        Forward Send Field_Defaults
39402>>>>>>>        //DDB-Generated-Code-Location
39402>>>>>>>        //DDB-FieldDefaultStart
39402>>>>>>>        //DDB-FieldDefaultEnd
39402>>>>>>>    End_Procedure    // Field_Defaults
39403>>>>>>>
39403>>>>>>>End_Class    // Wax_DataDictionary
39404>>>>>>>//DDB-Selection-pkg-Start
39404>>>>>>>
39404>>>>>>>Use Wax.SL           // Wax
39404>>>>>>>
39404>>>>>>>//DDB-Selection-pkg-End
39404>>>>>>>//DDB-FileEnd
39404>>>>>
39404>>>>>//AB-IgnoreEnd
39404>>>>>
39404>>>>>Object Wax is a dbModalPanelSub
39406>>>>>
39406>>>>>    //AB-StoreTopStart
39406>>>>>                                    
39406>>>>>    Property Integer    piMustConstrain Public  0
39408>>>>>    Property Integer    piYear          Public  0
39410>>>>>    Property String     psCompany       Public ''
39412>>>>>    Property String     psBranch        Public ''
39414>>>>>    Property String     psWapokat       Public ''
39416>>>>>    
39416>>>>>    //AB-StoreTopEnd
39416>>>>>
39416>>>>>    Set Label to "‰˜«á¢¦š¦ª €§¦Ÿž¡é¤"
39417>>>>>    Set Size to 148 355
39418>>>>>    Set Location to 8 21
39419>>>>>    Set Exit_Application_Local_State to FALSE
39420>>>>>    Set Modal_State to FALSE
39421>>>>>
39421>>>>>    //AB-DDOStart
39421>>>>>
39421>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
39423>>>>>    End_Object    // Wapokat_DD
39424>>>>>
39424>>>>>    Object Wapomast_DD is a Wapomast_DataDictionary
39426>>>>>        Set DDO_Server to (Wapokat_DD(self))
39427>>>>>    End_Object    // Wapomast_DD
39428>>>>>
39428>>>>>    Object Wax_DD is a Wax_DataDictionary
39430>>>>>        Set DDO_Server to (Wapomast_DD(self))
39431>>>>>
39431>>>>>        //AB-StoreStart
39431>>>>>        
39431>>>>>        Begin_Constraints
39433>>>>>            Integer iMustConstrain iYear
39434>>>>>            String  sCompany sBranch sWapokat
39434>>>>>            Get piMustConstrain to iMustConstrain
39435>>>>>            If (iMustConstrain) Begin
39437>>>>>                Get piYear     to  iYear
39438>>>>>                Get psCompany  to  sCompany
39439>>>>>                Get psBranch   to  sBranch
39440>>>>>                Get psWapokat  to  sWapokat
39441>>>>>                If (sCompany<>'') Begin
39443>>>>>                    Constrain Wax.Company_Code eq sCompany
39445>>>>>                    If (sBranch<>'') Begin
39447>>>>>                        Constrain Wax.Branch_Code eq sBranch
39449>>>>>                        If (iYear<>0) Begin
39451>>>>>                            Constrain Wax.Year_Year eq iYear
39453>>>>>                            If (sWapokat<>'') Begin
39455>>>>>                                Constrain Wax.Wapokat_Code eq sWapokat
39457>>>>>                            End
39457>>>>>>
39457>>>>>                        End
39457>>>>>>
39457>>>>>                    End
39457>>>>>>
39457>>>>>                End
39457>>>>>>
39457>>>>>            End
39457>>>>>>
39457>>>>>        End_Constraints
39460>>>>>        
39460>>>>>        
39460>>>>>        
39460>>>>>        
39460>>>>>        
39460>>>>>        
39460>>>>>        //AB-StoreEnd
39460>>>>>
39460>>>>>    End_Object    // Wax_DD
39461>>>>>
39461>>>>>    Set Main_DD to (Wax_DD(self))
39462>>>>>    Set Server to (Wax_DD(self))
39463>>>>>
39463>>>>>    //AB-DDOEnd
39463>>>>>
39463>>>>>    Object oSelList is a dbListSub
39465>>>>>        Set Main_File to Wax.File_Number
39466>>>>>        Set Size to 105 340
39467>>>>>        Set Location to 5 6
39468>>>>>
39468>>>>>        Begin_Row
39471>>>>>            Entry_Item Wax.Wax_recr
39472>>>>>            Entry_Item Wax.Wax_code
39473>>>>>            Entry_Item Wax.Wax_descr
39474>>>>>        End_Row
39479>>>>>
39479>>>>>        Set Form_Width    item 0 to 33
39480>>>>>        Set Header_Label  item 0 to "Recr"
39481>>>>>        
39481>>>>>        Set Form_Width    item 1 to 80
39482>>>>>        Set Header_Label  item 1 to "‰à› ¡æª"
39483>>>>>        
39483>>>>>        Set Form_Width    item 2 to 219
39484>>>>>        Set Header_Label  item 2 to "œ¨ š¨˜­ã"
39485>>>>>        
39485>>>>>
39485>>>>>        //AB-StoreStart
39485>>>>>        
39485>>>>>        Procedure Activate
39487>>>>>            Send Rebuild_Constraints to Wax_DD
39488>>>>>            Send Beginning_Of_Data to oSelList True
39489>>>>>            Forward Send Activate
39491>>>>>        End_procedure
39492>>>>>        
39492>>>>>        //AB-StoreEnd
39492>>>>>
39492>>>>>    End_Object    // oSelList
39493>>>>>
39493>>>>>    Object oOK_bn is a ButtonSub
39495>>>>>        Set Label to "&„§ ¢¦šã"
39496>>>>>        Set Location to 113 186
39497>>>>>
39497>>>>>        //AB-StoreStart
39497>>>>>        Procedure OnClick
39499>>>>>            Send OK To (oSelList(current_object))
39500>>>>>        End_Procedure
39501>>>>>        //AB-StoreEnd
39501>>>>>
39501>>>>>    End_Object    // oOK_bn
39502>>>>>
39502>>>>>    Object oCancel_bn is a ButtonSub
39504>>>>>        Set Label to "&€¡ç¨à©ž"
39505>>>>>        Set Location to 113 241
39506>>>>>
39506>>>>>        //AB-StoreStart
39506>>>>>        Procedure OnClick
39508>>>>>            Send Cancel To (oSelList(current_object))
39509>>>>>        End_Procedure
39510>>>>>        //AB-StoreEnd
39510>>>>>
39510>>>>>    End_Object    // oCancel_bn
39511>>>>>
39511>>>>>    Object oSearch_bn is a ButtonSub
39513>>>>>        Set Label to "€&¤˜ã«ž©ž"
39514>>>>>        Set Location to 113 296
39515>>>>>
39515>>>>>        //AB-StoreStart
39515>>>>>        Procedure OnClick
39517>>>>>            Send Search To (oSelList(current_object))
39518>>>>>        End_Procedure
39519>>>>>        //AB-StoreEnd
39519>>>>>
39519>>>>>    End_Object    // oSearch_bn
39520>>>>>
39520>>>>>
39520>>>>>    //AB-StoreStart
39520>>>>>                                    
39520>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39521>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39522>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39523>>>>>    
39523>>>>>    
39523>>>>>    
39523>>>>>    
39523>>>>>    
39523>>>>>    
39523>>>>>    //AB-StoreEnd
39523>>>>>
39523>>>>>End_Object    // Wax
39524>>>>>
39524>>>>>//AB/ End_Object    // prj
39524>>>Use sl001.sl
39524>>>Use sl002.sl
39524>>>Use sl003.sl
39524>>>Use sl006.sl
INCLUDING FILE: SL006.SL
39524>>>>>//AB/ Project sl006:Cmoves lookup
39524>>>>>//AB/     Object prj is a Lookup_Project
39524>>>>>//AB/         Set ProjectName to "sl006:Cmoves lookup"
39524>>>>>//AB/         Set ProjectFileName to "sl006.SL"
39524>>>>>//AB/         Set GenerateFileName to "NONAME"
39524>>>>>
39524>>>>>// Project Object Structure
39524>>>>>//   sl006 is a dbModalPanelSub
39524>>>>>//     Ctypkin_DD is a DataDictionary
39524>>>>>//     Clients_DD is a DataDictionary
39524>>>>>//     Cmoves_DD is a DataDictionary
39524>>>>>//     oSelList is a dbListSub
39524>>>>>//     oOK_bn is a ButtonSub
39524>>>>>//     oCancel_bn is a ButtonSub
39524>>>>>//     oSearch_bn is a ButtonSub
39524>>>>>//     Cmoves_Axia_Pros_Sysx is a dbFormSub
39524>>>>>//     Cmoves_Axia_Sysxet is a dbFormSub
39524>>>>>//     Cmoves_Axia_Ypol_Sysx is a dbFormSub
39524>>>>>//     TextBoxSub1 is a TextBoxSub
39524>>>>>//     TextBoxSub2 is a TextBoxSub
39524>>>>>//     TextBoxSub3 is a TextBoxSub
39524>>>>>//     RadioGroupSub2 is a RadioGroupSub
39524>>>>>//       Radio4 is a RadioSub
39524>>>>>//       Radio5 is a RadioSub
39524>>>>>//       Radio6 is a RadioSub
39524>>>>>
39524>>>>>// Register all objects
39524>>>>>Register_Object Clients_DD
39524>>>>>Register_Object Cmoves_Axia_Pros_Sysx
39524>>>>>Register_Object Cmoves_Axia_Sysxet
39524>>>>>Register_Object Cmoves_Axia_Ypol_Sysx
39524>>>>>Register_Object Cmoves_DD
39524>>>>>Register_Object Ctypkin_DD
39524>>>>>Register_Object oCancel_bn
39524>>>>>Register_Object oOK_bn
39524>>>>>Register_Object oSearch_bn
39524>>>>>Register_Object oSelList
39524>>>>>Register_Object Radio4
39524>>>>>Register_Object Radio5
39524>>>>>Register_Object Radio6
39524>>>>>Register_Object RadioGroupSub2
39524>>>>>Register_Object sl006
39524>>>>>Register_Object TextBoxSub1
39524>>>>>Register_Object TextBoxSub2
39524>>>>>Register_Object TextBoxSub3
39524>>>>>
39524>>>>>
39524>>>>>    //AB-IgnoreStart
39524>>>>>
39524>>>>>    Use DFAllEnt.pkg
39524>>>>>    Use dbList.Sub
39524>>>>>    Use Button.Sub
39524>>>>>    Use dbForm.Sub
39524>>>>>    Use Txtbox.Sub
39524>>>>>    Use Rgroup.Sub
39524>>>>>    Use Radio.Sub
39524>>>>>
39524>>>>>
39524>>>>>    Use CTYPKIN.DD
INCLUDING FILE: CTYPKIN.DD
39524>>>>>>>//DDB-FileStart
39524>>>>>>>//DDB-HeaderStart
39524>>>>>>>
39524>>>>>>>// File Name : CTYPKIN.DD
39524>>>>>>>// Class Name: Ctypkin_DataDictionary
39524>>>>>>>// Revision  : 69
39524>>>>>>>// Version   : 2
39524>>>>>>>
39524>>>>>>>Use  Windows           // Basic Definitions
39524>>>>>>>Use  DataDict          // DataDictionary Class Definition
39524>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39524>>>>>>>
39524>>>>>>>Open Ctypkin
INCLUDING FILE: CTYPKIN.FD
39526>>>>>>>Open Cmoves
39528>>>>>>>Open Cflagkin
INCLUDING FILE: CFLAGKIN.FD
39530>>>>>>>Open Ptypparl
39532>>>>>>>Open Ptyppar
INCLUDING FILE: PTYPPAR.FD
39534>>>>>>>Open Hmctyp
INCLUDING FILE: HMCTYP.FD
39536>>>>>>>Open Cmovesa
39538>>>>>>>Open Sysrecc
39540>>>>>>>Open Syscurxr
39542>>>>>>>
39542>>>>>>>//DDB-HeaderEnd
39542>>>>>>>//DDB-ValidationStart
39542>>>>>>>
39542>>>>>>>Register_Object Ctypkin_Ctypkin_Module_VT
39542>>>>>>>
39542>>>>>>>Object Ctypkin_Ctypkin_Module_VT  is a CodeValidationTable
39544>>>>>>>    Set Type_Value        To "MODULE"
39545>>>>>>>    //DDB-ValidationCustomStart
39545>>>>>>>    //DDB-ValidationCustomEnd
39545>>>>>>>End_Object   // Ctypkin_Ctypkin_Module_VT
39546>>>>>>>//DDB-ValidationEnd
39546>>>>>>>//DDB-SelectionStart
39546>>>>>>>//DDB/ ExternalSelectionList sl007  sl007.SL
39546>>>>>>>Register_Object sl007
39546>>>>>>>//DDB-SelectionEnd
39546>>>>>>>
39546>>>>>>>Class Ctypkin_DataDictionary  is a DataDictionary
39547>>>>>>>         
39547>>>>>>>    Procedure Construct_Object
39548>>>>>>>        Forward Send Construct_Object
39550>>>>>>>        Property Integer piMustNOTConstrain Public 0
39551>>>>>>>    End_Procedure
39552>>>>>>>
39552>>>>>>>
39552>>>>>>>    Procedure Save_Main_File
39553>>>>>>>        If (Operation_Origin<>Self) Begin
39555>>>>>>>            If Ctypkin.Recnum Eq 0 Procedure_Return
39558>>>>>>>        End
39558>>>>>>>>
39558>>>>>>>        Forward Send Save_Main_File
39560>>>>>>>    End_Procedure
39561>>>>>>>
39561>>>>>>>     Procedure Creating
39562>>>>>>>        Forward Send Creating
39564>>>>>>>        // Insert Code Here
39564>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Ctypkin.Ctypkin_Rec0)))))) to Ctypkin.Ctypkin_Recr
39565>>>>>>>    End_Procedure   // Creating
39566>>>>>>>
39566>>>>>>>
39566>>>>>>>    // Define_Fields:
39566>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39566>>>>>>>
39566>>>>>>>    Procedure Define_Fields
39567>>>>>>>        Forward Send Define_Fields
39569>>>>>>>        //DDB-Generated-Code-Location
39569>>>>>>>        //DDB-DefineFieldStart
39569>>>>>>>
39569>>>>>>>        Set Main_File            To Ctypkin.File_Number
39570>>>>>>>        Set Cascade_Delete_State To FALSE
39571>>>>>>>
39571>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39572>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39573>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39574>>>>>>>
39574>>>>>>>        // Child (Client) file structure................
39574>>>>>>>        Send Add_Client_File  Cmoves.File_Number
39575>>>>>>>        Send Add_Client_File  Cflagkin.File_Number
39576>>>>>>>        Send Add_Client_File  Ptypparl.File_Number
39577>>>>>>>        Send Add_Client_File  Ptyppar.File_Number
39578>>>>>>>        Send Add_Client_File  Hmctyp.File_Number
39579>>>>>>>        Send Add_Client_File  Cmovesa.File_Number
39580>>>>>>>
39580>>>>>>>        // External (System) file structure.............
39580>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
39581>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
39582>>>>>>>
39582>>>>>>>        Define_Auto_Increment  Sysrecc.Ctypkin_Rec0  To Ctypkin.Ctypkin_Rec0
39585>>>>>>>
39585>>>>>>>        // Field-based properties.......................
39585>>>>>>>
39585>>>>>>>        // Ctypkin.Company_Code
39585>>>>>>>
39585>>>>>>>        // Ctypkin.Branch_Code
39585>>>>>>>
39585>>>>>>>        // Ctypkin.Year_Year
39585>>>>>>>
39585>>>>>>>        // Ctypkin.Ctypkin_Code
39585>>>>>>>        Set Field_Options          Field Ctypkin.Ctypkin_Code To DD_AUTOFIND   
39586>>>>>>>        Set Field_Prompt_Object    Field Ctypkin.Ctypkin_Code To (sl007(Self))
39587>>>>>>>        Set Key_Field_State        Field Ctypkin.Ctypkin_Code To TRUE
39588>>>>>>>
39588>>>>>>>        // Ctypkin.Ctypkin_Rec0
39588>>>>>>>
39588>>>>>>>        // Ctypkin.Ctypkin_Recr
39588>>>>>>>
39588>>>>>>>        // Ctypkin.Year_Recr
39588>>>>>>>
39588>>>>>>>        // Ctypkin.Ctypkin_Descr
39588>>>>>>>        Set Field_Prompt_Object    Field Ctypkin.Ctypkin_Descr To (sl007(Self))
39589>>>>>>>
39589>>>>>>>        // Ctypkin.Ctypkin_Anti
39589>>>>>>>
39589>>>>>>>        // Ctypkin.Ctypkin_Flags
39589>>>>>>>
39589>>>>>>>        // Ctypkin.Ctypkin_Module
39589>>>>>>>        Set Field_Value_Table      Field Ctypkin.Ctypkin_Module To (Ctypkin_Ctypkin_Module_VT(Self))
39590>>>>>>>
39590>>>>>>>        // Ctypkin.Open_Item
39590>>>>>>>
39590>>>>>>>        // Ctypkin.Check_Overhead
39590>>>>>>>
39590>>>>>>>        // Ctypkin.Max_Days_Sx_Par
39590>>>>>>>
39590>>>>>>>        // Ctypkin.Singular
39590>>>>>>>
39590>>>>>>>        // Ctypkin.Sub
39590>>>>>>>
39590>>>>>>>        // Ctypkin.Subreport
39590>>>>>>>
39590>>>>>>>        //DDB-DefineFieldEnd
39590>>>>>>>    End_Procedure    // Define_Fields
39591>>>>>>>
39591>>>>>>>    // Field_Defaults:
39591>>>>>>>    // This procedure is used to establish default field values.
39591>>>>>>>
39591>>>>>>>    Procedure Field_Defaults
39592>>>>>>>        Forward Send Field_Defaults
39594>>>>>>>        //DDB-Generated-Code-Location
39594>>>>>>>        //DDB-FieldDefaultStart
39594>>>>>>>        //DDB-FieldDefaultEnd
39594>>>>>>>    End_Procedure    // Field_Defaults
39595>>>>>>>
39595>>>>>>>End_Class    // Ctypkin_DataDictionary
39596>>>>>>>//DDB-Selection-pkg-Start
39596>>>>>>>
39596>>>>>>>Use sl007.SL         // sl007
INCLUDING FILE: SL007.SL
39596>>>>>>>>>//AB/ Project Ctypkin : sl007
39596>>>>>>>>>//AB/ Object prj is a Lookup_Project
39596>>>>>>>>>//AB/     Set ProjectName to "Ctypkin : sl007"
39596>>>>>>>>>//AB/     Set ProjectFileName to "sl007.SL"
39596>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
39596>>>>>>>>>
39596>>>>>>>>>// Project Object Structure
39596>>>>>>>>>//   sl007 is a dbModalPanelSub
39596>>>>>>>>>//     Ctypkin_DD is a DataDictionary
39596>>>>>>>>>//     oSelList is a dbListSub
39596>>>>>>>>>//     oOK_bn is a ButtonSub
39596>>>>>>>>>//     oCancel_bn is a ButtonSub
39596>>>>>>>>>//     oSearch_bn is a ButtonSub
39596>>>>>>>>>
39596>>>>>>>>>// Register all objects
39596>>>>>>>>>Register_Object Ctypkin_DD
39596>>>>>>>>>Register_Object oCancel_bn
39596>>>>>>>>>Register_Object oOK_bn
39596>>>>>>>>>Register_Object oSearch_bn
39596>>>>>>>>>Register_Object oSelList
39596>>>>>>>>>Register_Object sl007
39596>>>>>>>>>
39596>>>>>>>>>
39596>>>>>>>>>//AB-IgnoreStart
39596>>>>>>>>>
39596>>>>>>>>>Use DFAllEnt.pkg
39596>>>>>>>>>Use dbList.Sub
39596>>>>>>>>>Use Button.Sub
39596>>>>>>>>>
39596>>>>>>>>>
39596>>>>>>>>>Use CTYPKIN.DD
39596>>>>>>>>>
39596>>>>>>>>>//AB-IgnoreEnd
39596>>>>>>>>>
39596>>>>>>>>>Object sl007 is a dbModalPanelSub
39598>>>>>>>>>
39598>>>>>>>>>    //AB-StoreTopStart
39598>>>>>>>>>    Property String psModule Public ''
39600>>>>>>>>>    
39600>>>>>>>>>    //AB-StoreTopEnd
39600>>>>>>>>>
39600>>>>>>>>>    Set Label to "‰ ¤ã©œ ª    "
39601>>>>>>>>>    Set Size to 148 350
39602>>>>>>>>>    Set Location to 4 7
39603>>>>>>>>>    Set Exit_Application_Local_State to FALSE
39604>>>>>>>>>    Set Modal_State to FALSE
39605>>>>>>>>>
39605>>>>>>>>>    //AB-DDOStart
39605>>>>>>>>>
39605>>>>>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
39607>>>>>>>>>
39607>>>>>>>>>        //AB-StoreStart
39607>>>>>>>>>                                
39607>>>>>>>>>        Begin_Constraints
39609>>>>>>>>>            If (psModule(sl007(Self))<>'') Constrain Ctypkin.Ctypkin_Module eq (psModule(sl007(Self)))
39613>>>>>>>>>        End_Constraints
39616>>>>>>>>>        
39616>>>>>>>>>        
39616>>>>>>>>>        
39616>>>>>>>>>        
39616>>>>>>>>>        //AB-StoreEnd
39616>>>>>>>>>
39616>>>>>>>>>    End_Object    // Ctypkin_DD
39617>>>>>>>>>
39617>>>>>>>>>    Set Main_DD to (Ctypkin_DD(self))
39618>>>>>>>>>    Set Server to (Ctypkin_DD(self))
39619>>>>>>>>>
39619>>>>>>>>>    //AB-DDOEnd
39619>>>>>>>>>
39619>>>>>>>>>    Object oSelList is a dbListSub
39621>>>>>>>>>        Set Main_File to Ctypkin.File_Number
39622>>>>>>>>>        Set Size to 105 335
39623>>>>>>>>>        Set Location to 6 6
39624>>>>>>>>>
39624>>>>>>>>>        Begin_Row
39627>>>>>>>>>            Entry_Item Ctypkin.Ctypkin_code
39628>>>>>>>>>            Entry_Item Ctypkin.Ctypkin_descr
39629>>>>>>>>>        End_Row
39634>>>>>>>>>
39634>>>>>>>>>        Set Form_Width    item 0 to 71
39635>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª ‰ ¤ã©œàª"
39636>>>>>>>>>        
39636>>>>>>>>>        Set Form_Width    item 1 to 255
39637>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã ‰ ¤ã©œàª"
39638>>>>>>>>>        
39638>>>>>>>>>
39638>>>>>>>>>        //AB-StoreStart
39638>>>>>>>>>                    
39638>>>>>>>>>                    
39638>>>>>>>>>        Procedure Activate
39640>>>>>>>>>            Forward Send Activate
39642>>>>>>>>>            Send Beginning_Of_Data to oSelList True
39643>>>>>>>>>        End_Procedure
39644>>>>>>>>>        
39644>>>>>>>>>        
39644>>>>>>>>>        
39644>>>>>>>>>        
39644>>>>>>>>>        //AB-StoreEnd
39644>>>>>>>>>
39644>>>>>>>>>    End_Object    // oSelList
39645>>>>>>>>>
39645>>>>>>>>>    Object oOK_bn is a ButtonSub
39647>>>>>>>>>        Set Label to "&„§ ¢¦šã"
39648>>>>>>>>>        Set Location to 113 171
39649>>>>>>>>>
39649>>>>>>>>>        //AB-StoreStart
39649>>>>>>>>>        Procedure OnClick
39651>>>>>>>>>            Send OK To (oSelList(current_object))
39652>>>>>>>>>        End_Procedure
39653>>>>>>>>>        //AB-StoreEnd
39653>>>>>>>>>
39653>>>>>>>>>    End_Object    // oOK_bn
39654>>>>>>>>>
39654>>>>>>>>>    Object oCancel_bn is a ButtonSub
39656>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
39657>>>>>>>>>        Set Location to 113 226
39658>>>>>>>>>
39658>>>>>>>>>        //AB-StoreStart
39658>>>>>>>>>        Procedure OnClick
39660>>>>>>>>>            Send Cancel To (oSelList(current_object))
39661>>>>>>>>>        End_Procedure
39662>>>>>>>>>        //AB-StoreEnd
39662>>>>>>>>>
39662>>>>>>>>>    End_Object    // oCancel_bn
39663>>>>>>>>>
39663>>>>>>>>>    Object oSearch_bn is a ButtonSub
39665>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
39666>>>>>>>>>        Set Location to 113 281
39667>>>>>>>>>
39667>>>>>>>>>        //AB-StoreStart
39667>>>>>>>>>        Procedure OnClick
39669>>>>>>>>>            Send Search To (oSelList(current_object))
39670>>>>>>>>>        End_Procedure
39671>>>>>>>>>        //AB-StoreEnd
39671>>>>>>>>>
39671>>>>>>>>>    End_Object    // oSearch_bn
39672>>>>>>>>>
39672>>>>>>>>>
39672>>>>>>>>>    //AB-StoreStart
39672>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39673>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39674>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39675>>>>>>>>>    
39675>>>>>>>>>    Procedure Activate Returns Integer
39677>>>>>>>>>        Integer rVal
39678>>>>>>>>>        Send Rebuild_Constraints to Ctypkin_DD
39679>>>>>>>>>        Forward Get Msg_Activate to rVal
39681>>>>>>>>>        Procedure_Return rVal
39682>>>>>>>>>    End_Procedure
39683>>>>>>>>>    
39683>>>>>>>>>    //AB-StoreEnd
39683>>>>>>>>>
39683>>>>>>>>>End_Object    // sl007
39684>>>>>>>>>
39684>>>>>>>>>//AB/ End_Object    // prj
39684>>>>>>>
39684>>>>>>>//DDB-Selection-pkg-End
39684>>>>>>>//DDB-FileEnd
39684>>>>>    Use CLIENTS.DD
39684>>>>>    Use CMOVES.DD
INCLUDING FILE: CMOVES.DD
39684>>>>>>>//DDB-FileStart
39684>>>>>>>//DDB-HeaderStart
39684>>>>>>>
39684>>>>>>>// File Name : CMOVES.DD
39684>>>>>>>// Class Name: Cmoves_DataDictionary
39684>>>>>>>// Revision  : 136
39684>>>>>>>// Version   : 2
39684>>>>>>>
39684>>>>>>>Use  Windows           // Basic Definitions
39684>>>>>>>Use  DataDict          // DataDictionary Class Definition
39684>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39684>>>>>>>
39684>>>>>>>Open Cmoves
39686>>>>>>>Open Copen
INCLUDING FILE: COPEN.FD
39688>>>>>>>Open Ctypkin
39690>>>>>>>Open Clients
39692>>>>>>>Open Sysrecc
39694>>>>>>>Open Syscurxr
39696>>>>>>>
39696>>>>>>>//DDB-HeaderEnd
39696>>>>>>>//DDB-SelectionStart
39696>>>>>>>//DDB/ ExternalSelectionList sl006  sl006.SL
39696>>>>>>>//DDB/ ExternalSelectionList slNomism  slnomism.sl
39696>>>>>>>//DDB/ ExternalSelectionList sl041  sl041.SL
39696>>>>>>>Register_Object sl006
39696>>>>>>>Register_Object slNomism
39696>>>>>>>Register_Object sl041
39696>>>>>>>//DDB-SelectionEnd
39696>>>>>>>
39696>>>>>>>Use Payresp.DD
INCLUDING FILE: PAYRESP.DD
39696>>>>>>>>>//DDB-FileStart
39696>>>>>>>>>//DDB-HeaderStart
39696>>>>>>>>>
39696>>>>>>>>>// File Name : PAYRESP.DD
39696>>>>>>>>>// Class Name: Payresp_DataDictionary
39696>>>>>>>>>// Revision  : 78
39696>>>>>>>>>// Version   : 2
39696>>>>>>>>>
39696>>>>>>>>>Use  Windows           // Basic Definitions
39696>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
39696>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39696>>>>>>>>>
39696>>>>>>>>>Open Payresp
39698>>>>>>>>>Open Prspbank
INCLUDING FILE: PRSPBANK.FD
39700>>>>>>>>>Open Tppresp
INCLUDING FILE: TPPRESP.FD
39702>>>>>>>>>Open Clients
39704>>>>>>>>>Open Sysrecc
39706>>>>>>>>>
39706>>>>>>>>>//DDB-HeaderEnd
39706>>>>>>>>>//DDB-ValidationStart
39706>>>>>>>>>
39706>>>>>>>>>Register_Object Payresp_Presp_Doy_VT
39706>>>>>>>>>Register_Object Payresp_Presp_Categfpa_VT
39706>>>>>>>>>Register_Object Payresp_Feregios_VT
39706>>>>>>>>>
39706>>>>>>>>>Object Payresp_Presp_Doy_VT  is a CodeValidationTable
39708>>>>>>>>>    Set Type_Value        To "DOY"
39709>>>>>>>>>    Set Allow_Blank_State To TRUE
39710>>>>>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
39711>>>>>>>>>    //DDB-ValidationCustomStart
39711>>>>>>>>>    //DDB-ValidationCustomEnd
39711>>>>>>>>>End_Object   // Payresp_Presp_Doy_VT
39712>>>>>>>>>
39712>>>>>>>>>Object Payresp_Presp_Categfpa_VT  is a CodeValidationTable
39714>>>>>>>>>    Set Type_Value        To "VAT_STATUS"
39715>>>>>>>>>    Set Validate_State    To FALSE
39716>>>>>>>>>    Set Allow_Blank_State To TRUE
39717>>>>>>>>>    //DDB-ValidationCustomStart
39717>>>>>>>>>    //DDB-ValidationCustomEnd
39717>>>>>>>>>End_Object   // Payresp_Presp_Categfpa_VT
39718>>>>>>>>>
39718>>>>>>>>>Object Payresp_Feregios_VT  is a CodeValidationTable
39720>>>>>>>>>    Set Type_Value        To "FEREGIOS"
39721>>>>>>>>>    Set Allow_Blank_State To TRUE
39722>>>>>>>>>    Set Table_Title       To "ƒœå¡«œª ”œ¨œšš¬æ«ž«˜ª ”¦¨âà¤"
39723>>>>>>>>>    //DDB-ValidationCustomStart
39723>>>>>>>>>    //DDB-ValidationCustomEnd
39723>>>>>>>>>End_Object   // Payresp_Feregios_VT
39724>>>>>>>>>//DDB-ValidationEnd
39724>>>>>>>>>//DDB-SelectionStart
39724>>>>>>>>>//DDB/ ExternalSelectionList sl111  sl111.SL
39724>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
39724>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
39724>>>>>>>>>Register_Object sl111
39724>>>>>>>>>Register_Object sl198
39724>>>>>>>>>Register_Object sl197
39724>>>>>>>>>//DDB-SelectionEnd
39724>>>>>>>>>
39724>>>>>>>>>Open Year      
39726>>>>>>>>>
39726>>>>>>>>>Class Payresp_DataDictionary  is a DataDictionary_Sec
39727>>>>>>>>>
39727>>>>>>>>>    Procedure Construct_Object
39728>>>>>>>>>        Forward Send Construct_Object
39730>>>>>>>>>        Property Integer piCheckPlaf        Public 0
39731>>>>>>>>>    End_procedure
39732>>>>>>>>>
39732>>>>>>>>>    Procedure Update
39733>>>>>>>>>        Forward Send Update
39735>>>>>>>>>        Move SysCurXR.Company_Code  to payresp.Company_Code
39736>>>>>>>>>        Move SysCurXR.Branch_Code   to payresp.Branch_Code
39737>>>>>>>>>        Move SysCurXR.Year_Year     to payresp.Year_Year
39738>>>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
39738>>>>>>>>>        Move (payresp.Xreosh-payresp.Pistosh)   to payresp.Ypoloipo
39739>>>>>>>>>        Move (payresp.Plafon-payresp.ypoloipo)  to payresp.Overhead
39740>>>>>>>>>
39740>>>>>>>>>        //betolink
39740>>>>>>>>>        Move SysCurXR.Beto_Site      to payresp.presp_SiteW
39741>>>>>>>>>        Move payresp.presp_Rec0      to payresp.presp_SN
39742>>>>>>>>>        Move payresp.presp_id        to payresp.presp_Repm
39743>>>>>>>>>
39743>>>>>>>>>    End_Procedure   // Update
39744>>>>>>>>>
39744>>>>>>>>>     Procedure Creating
39745>>>>>>>>>        Forward Send Creating
39747>>>>>>>>>        // Insert Code Here
39747>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(payresp.presp_Rec0))))));                                    to payresp.presp_Recr
39748>>>>>>>>>        Move '1'                    to payresp.presp_Active
39749>>>>>>>>>        get fsgCode_With_Zeroes payresp.presp_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to payresp.presp_ID
39750>>>>>>>>>        clear year
39751>>>>>>>>>        move syscurxr.branch_code   to year.branch_code
39752>>>>>>>>>        move syscurxr.company_code  to year.company_code
39753>>>>>>>>>        move syscurxr.year_year     to YEAR.year_year
39754>>>>>>>>>        find eq year by index.1
39755>>>>>>>>>>
39755>>>>>>>>>        if (found=1) begin
39757>>>>>>>>>            move year.payresp_plafon to payresp.plafon
39758>>>>>>>>>            move year.payresp_ofeilh to payresp.orio_syn_ofeilh
39759>>>>>>>>>        end
39759>>>>>>>>>>
39759>>>>>>>>>    End_Procedure   // Creating
39760>>>>>>>>>
39760>>>>>>>>>   Function Validate_Save  Returns Integer
39761>>>>>>>>>        Integer iReturnVal iCheck iYes
39762>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
39764>>>>>>>>>        If (Not(iReturnVal)) Begin
39766>>>>>>>>>
39766>>>>>>>>>            If (Sysfile.Check_Afm=1) Begin
39768>>>>>>>>>                Move (Check_AFM(payresp.presp_Afm)) to iCheck
39769>>>>>>>>>                If (iCheck) Begin
39771>>>>>>>>>                         If (iCheck=1) Move 4001 to iReturnVal
39774>>>>>>>>>                    Else If (iCheck=2) Move 4002 to iReturnVal
39778>>>>>>>>>                    Else If (iCheck=3) Move 4003 to iReturnVal
39782>>>>>>>>>                End
39782>>>>>>>>>>
39782>>>>>>>>>            End
39782>>>>>>>>>>
39782>>>>>>>>>
39782>>>>>>>>>           If (piCheckPlaf(Self)=1) Begin
39784>>>>>>>>>                If ((PayResp.Plafon>0) And ((PayResp.Ypoloipo+PayResp.Posa_Apo_Dap)>PayResp.Plafon)) Begin
39786>>>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 5000 Payresp'  to iYes
39787>>>>>>>>>                        If (iYes=MBR_NO) Error 4004 'DDC111: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4004 to iReturnVal
39790>>>>>>>>>                End
39790>>>>>>>>>>
39790>>>>>>>>>                Else If ((PayResp.Orio_Syn_Ofeilh>0) And (PayResp.Synolikh_Ofeilh>PayResp.Orio_Syn_Ofeilh)) Begin
39793>>>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 5001 Payresp' to iYes
39794>>>>>>>>>                        If (iYes=MBR_NO) Error 4005 'DDC111: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
39797>>>>>>>>>                End
39797>>>>>>>>>>
39797>>>>>>>>>           End
39797>>>>>>>>>>
39797>>>>>>>>>        If (iReturnVal) Send Operation_Not_Allowed iReturnVal
39800>>>>>>>>>        End
39800>>>>>>>>>>
39800>>>>>>>>>        Function_Return iReturnVal
39801>>>>>>>>>    End_Function   // Validate_Save
39802>>>>>>>>>
39802>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
39803>>>>>>>>>        String lsError_Message
39804>>>>>>>>>        Case Begin
39804>>>>>>>>>            Case (iError_Num = 4001)
39806>>>>>>>>>                Move "DDC 100: Š˜¤Ÿ˜©£â¤¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤" to lsError_Message
39807>>>>>>>>>              Case Break
39808>>>>>>>>>            Case (iError_Num = 4002)
39811>>>>>>>>>                Move "DDC 100: ’¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤ ›œ¤ œå¤˜  9 ¯ã­ ¦" to lsError_Message
39812>>>>>>>>>              Case Break
39813>>>>>>>>>            Case (iError_Num = 4003)
39816>>>>>>>>>                Move "DDC 100: €¡˜«á¢¢ž¢¦ª ®˜¨˜¡«ã¨˜ª ©«¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤ " to lsError_Message
39817>>>>>>>>>              Case Break
39818>>>>>>>>>            Case (iError_Num = 4004)
39821>>>>>>>>>                Move "DDC 100: „š ¤œ ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç" to lsError_Message
39822>>>>>>>>>              Case Break
39823>>>>>>>>>            Case (iError_Num = 4005)
39826>>>>>>>>>                Move "DDC 100: „š ¤œ ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª" to lsError_Message
39827>>>>>>>>>              Case Break
39828>>>>>>>>>            Case Else
39828>>>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
39830>>>>>>>>>        Case End
39830>>>>>>>>>        Error iError_Num lsError_Message
39831>>>>>>>>>>
39831>>>>>>>>>    End_Procedure // operation_not_allowed
39832>>>>>>>>>
39832>>>>>>>>>
39832>>>>>>>>>
39832>>>>>>>>>    Procedure Define_Fields
39833>>>>>>>>>        Forward Send Define_Fields
39835>>>>>>>>>        //DDB-Generated-Code-Location
39835>>>>>>>>>        //DDB-DefineFieldStart
39835>>>>>>>>>
39835>>>>>>>>>        Set Main_File            To Payresp.File_Number
39836>>>>>>>>>        Set Cascade_Delete_State To FALSE
39837>>>>>>>>>
39837>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39838>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39839>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39840>>>>>>>>>
39840>>>>>>>>>        // Child (Client) file structure................
39840>>>>>>>>>        Send Add_Client_File  Prspbank.File_Number
39841>>>>>>>>>        Send Add_Client_File  Tppresp.File_Number
39842>>>>>>>>>        Send Add_Client_File  Clients.File_Number
39843>>>>>>>>>
39843>>>>>>>>>        // External (System) file structure.............
39843>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
39844>>>>>>>>>
39844>>>>>>>>>        Define_Auto_Increment  Sysrecc.Payresp_Rec0  To Payresp.Presp_Rec0
39847>>>>>>>>>
39847>>>>>>>>>        // Field-based properties.......................
39847>>>>>>>>>
39847>>>>>>>>>        // Payresp.Company_Code
39847>>>>>>>>>
39847>>>>>>>>>        // Payresp.Branch_Code
39847>>>>>>>>>
39847>>>>>>>>>        // Payresp.Year_Year
39847>>>>>>>>>
39847>>>>>>>>>        // Payresp.Custprom_Code
39847>>>>>>>>>
39847>>>>>>>>>        // Payresp.Presp_Id
39847>>>>>>>>>        Set Field_Options          Field Payresp.Presp_Id To DD_AUTOFIND    DD_NOPUT      
39848>>>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Id To (sl111(Self))
39849>>>>>>>>>        Set Key_Field_State        Field Payresp.Presp_Id To TRUE
39850>>>>>>>>>
39850>>>>>>>>>        // Payresp.Presp_Name
39850>>>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Name To (sl111(Self))
39851>>>>>>>>>
39851>>>>>>>>>        // Payresp.Presp_Afm
39851>>>>>>>>>
39851>>>>>>>>>        // Payresp.Presp_Rec0
39851>>>>>>>>>
39851>>>>>>>>>        // Payresp.Custprom_Recr
39851>>>>>>>>>
39851>>>>>>>>>        // Payresp.Presp_Recr
39851>>>>>>>>>
39851>>>>>>>>>        // Payresp.Last_Xreosh
39851>>>>>>>>>
39851>>>>>>>>>        // Payresp.Last_Pistosh
39851>>>>>>>>>
39851>>>>>>>>>        // Payresp.Last_Order
39851>>>>>>>>>
39851>>>>>>>>>        // Payresp.Presp_Doy
39851>>>>>>>>>        Set Field_Value_Table      Field Payresp.Presp_Doy To (Payresp_Presp_Doy_VT(Self))
39852>>>>>>>>>
39852>>>>>>>>>        // Payresp.Presp_Address
39852>>>>>>>>>
39852>>>>>>>>>        // Payresp.Presp_City_Id
39852>>>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_City_Id To (sl198(Self))
39853>>>>>>>>>
39853>>>>>>>>>        // Payresp.Presp_Area
39853>>>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Area To (sl197(Self))
39854>>>>>>>>>
39854>>>>>>>>>        // Payresp.Presp_Job
39854>>>>>>>>>
39854>>>>>>>>>        // Payresp.Presp_Respons
39854>>>>>>>>>
39854>>>>>>>>>        // Payresp.Presp_Zipcode
39854>>>>>>>>>
39854>>>>>>>>>        // Payresp.Presp_Phone
39854>>>>>>>>>
39854>>>>>>>>>        // Payresp.Presp_Fax
39854>>>>>>>>>
39854>>>>>>>>>        // Payresp.Presp_Mobile
39854>>>>>>>>>
39854>>>>>>>>>        // Payresp.Presp_Aoh
39854>>>>>>>>>
39854>>>>>>>>>        // Payresp.Presp_Email
39854>>>>>>>>>
39854>>>>>>>>>        // Payresp.Presp_Class
39854>>>>>>>>>
39854>>>>>>>>>        // Payresp.Presp_Details
39854>>>>>>>>>
39854>>>>>>>>>        // Payresp.Presp_Sitew
39854>>>>>>>>>
39854>>>>>>>>>        // Payresp.Presp_Codem
39854>>>>>>>>>
39854>>>>>>>>>        // Payresp.Presp_Categfpa
39854>>>>>>>>>        Set Field_Value_Table      Field Payresp.Presp_Categfpa To (Payresp_Presp_Categfpa_VT(Self))
39855>>>>>>>>>
39855>>>>>>>>>        // Payresp.Presp_Fpa
39855>>>>>>>>>
39855>>>>>>>>>        // Payresp.Presp_Public
39855>>>>>>>>>
39855>>>>>>>>>        // Payresp.Presp_Sn
39855>>>>>>>>>
39855>>>>>>>>>        // Payresp.Presp_Repm
39855>>>>>>>>>
39855>>>>>>>>>        // Payresp.Presp_Active
39855>>>>>>>>>
39855>>>>>>>>>        // Payresp.Presp_Reported
39855>>>>>>>>>
39855>>>>>>>>>        // Payresp.Presp_Pelprom
39855>>>>>>>>>
39855>>>>>>>>>        // Payresp.Presp_Lastupd
39855>>>>>>>>>
39855>>>>>>>>>        // Payresp.Presp_Markexp
39855>>>>>>>>>
39855>>>>>>>>>        // Payresp.Presp_Catjob
39855>>>>>>>>>
39855>>>>>>>>>        // Payresp.Is_Promhtheyths
39855>>>>>>>>>
39855>>>>>>>>>        // Payresp.Xreosh
39855>>>>>>>>>
39855>>>>>>>>>        // Payresp.Pistosh
39855>>>>>>>>>
39855>>>>>>>>>        // Payresp.Ypoloipo
39855>>>>>>>>>
39855>>>>>>>>>        // Payresp.Plafon
39855>>>>>>>>>
39855>>>>>>>>>        // Payresp.Overhead
39855>>>>>>>>>
39855>>>>>>>>>        // Payresp.Presp_Add_No
39855>>>>>>>>>
39855>>>>>>>>>        // Payresp.Presp_Nomos
39855>>>>>>>>>
39855>>>>>>>>>        // Payresp.Presp_Xora
39855>>>>>>>>>
39855>>>>>>>>>        // Payresp.Polh_Recr
39855>>>>>>>>>
39855>>>>>>>>>        // Payresp.Synolikh_Ofeilh
39855>>>>>>>>>
39855>>>>>>>>>        // Payresp.Stoxos_Ipal
39855>>>>>>>>>
39855>>>>>>>>>        // Payresp.Stoxos_Ipso
39855>>>>>>>>>
39855>>>>>>>>>        // Payresp.Poso_Se_Apait
39855>>>>>>>>>
39855>>>>>>>>>        // Payresp.Orio_Syn_Ofeilh
39855>>>>>>>>>
39855>>>>>>>>>        // Payresp.Posa_Apo_Dap
39855>>>>>>>>>
39855>>>>>>>>>        // Payresp.Feregios
39855>>>>>>>>>        Set Field_Value_Table      Field Payresp.Feregios To (Payresp_Feregios_VT(Self))
39856>>>>>>>>>
39856>>>>>>>>>        //DDB-DefineFieldEnd
39856>>>>>>>>>    End_Procedure    // Define_Fields
39857>>>>>>>>>
39857>>>>>>>>>    // Field_Defaults:
39857>>>>>>>>>    // This procedure is used to establish default field values.
39857>>>>>>>>>
39857>>>>>>>>>    Procedure Field_Defaults
39858>>>>>>>>>        Forward Send Field_Defaults
39860>>>>>>>>>        //DDB-Generated-Code-Location
39860>>>>>>>>>        //DDB-FieldDefaultStart
39860>>>>>>>>>        Set Field_Changed_Value   Field Payresp.Presp_Doy To "0"
39861>>>>>>>>>        //DDB-FieldDefaultEnd
39861>>>>>>>>>    End_Procedure    // Field_Defaults
39862>>>>>>>>>
39862>>>>>>>>>End_Class    // Payresp_DataDictionary
39863>>>>>>>>>//DDB-Selection-pkg-Start
39863>>>>>>>>>
39863>>>>>>>>>Use sl111.SL         // sl111
INCLUDING FILE: SL111.SL
39863>>>>>>>>>>>//AB/ Project sl111
39863>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
39863>>>>>>>>>>>//AB/     Set ProjectName to "sl111"
39863>>>>>>>>>>>//AB/     Set ProjectFileName to "sl111.SL"
39863>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
39863>>>>>>>>>>>
39863>>>>>>>>>>>// Project Object Structure
39863>>>>>>>>>>>//   sl111 is a dbModalPanelSub
39863>>>>>>>>>>>//     Payresp_DD is a DataDictionary
39863>>>>>>>>>>>//     oSelList is a dbListSub
39863>>>>>>>>>>>//     oOK_bn is a ButtonSub
39863>>>>>>>>>>>//     oCancel_bn is a ButtonSub
39863>>>>>>>>>>>//     oSearch_bn is a ButtonSub
39863>>>>>>>>>>>
39863>>>>>>>>>>>// Register all objects
39863>>>>>>>>>>>Register_Object oCancel_bn
39863>>>>>>>>>>>Register_Object oOK_bn
39863>>>>>>>>>>>Register_Object oSearch_bn
39863>>>>>>>>>>>Register_Object oSelList
39863>>>>>>>>>>>Register_Object Payresp_DD
39863>>>>>>>>>>>Register_Object sl111
39863>>>>>>>>>>>
39863>>>>>>>>>>>
39863>>>>>>>>>>>//AB-IgnoreStart
39863>>>>>>>>>>>
39863>>>>>>>>>>>Use DFAllEnt.pkg
39863>>>>>>>>>>>Use dbList.Sub
39863>>>>>>>>>>>Use Button.Sub
39863>>>>>>>>>>>
39863>>>>>>>>>>>
39863>>>>>>>>>>>Use PAYRESP.DD
39863>>>>>>>>>>>
39863>>>>>>>>>>>//AB-IgnoreEnd
39863>>>>>>>>>>>
39863>>>>>>>>>>>Object sl111 is a dbModalPanelSub
39865>>>>>>>>>>>    Set Label to "“§œçŸ¬¤¦  ¢ž¨à£é¤ "
39866>>>>>>>>>>>    Set Size to 148 443
39867>>>>>>>>>>>    Set Location to 4 5
39868>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
39869>>>>>>>>>>>    Set Modal_State to FALSE
39870>>>>>>>>>>>
39870>>>>>>>>>>>    //AB-DDOStart
39870>>>>>>>>>>>
39870>>>>>>>>>>>    Object Payresp_DD is a Payresp_DataDictionary
39872>>>>>>>>>>>    End_Object    // Payresp_DD
39873>>>>>>>>>>>
39873>>>>>>>>>>>    Set Main_DD to (Payresp_DD(self))
39874>>>>>>>>>>>    Set Server to (Payresp_DD(self))
39875>>>>>>>>>>>
39875>>>>>>>>>>>    //AB-DDOEnd
39875>>>>>>>>>>>
39875>>>>>>>>>>>    Object oSelList is a dbListSub
39877>>>>>>>>>>>        Set Main_File to Payresp.File_Number
39878>>>>>>>>>>>        Set Size to 105 430
39879>>>>>>>>>>>        Set Location to 6 6
39880>>>>>>>>>>>
39880>>>>>>>>>>>        Begin_Row
39883>>>>>>>>>>>            Entry_Item Payresp.Presp_id
39884>>>>>>>>>>>            Entry_Item Payresp.Presp_name
39885>>>>>>>>>>>            Entry_Item Payresp.Presp_afm
39886>>>>>>>>>>>            Entry_Item Payresp.Presp_address
39887>>>>>>>>>>>            Entry_Item Payresp.Presp_phone
39888>>>>>>>>>>>        End_Row
39893>>>>>>>>>>>
39893>>>>>>>>>>>        Set Form_Width    item 0 to 60
39894>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
39895>>>>>>>>>>>        
39895>>>>>>>>>>>        Set Form_Width    item 1 to 106
39896>>>>>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
39897>>>>>>>>>>>        
39897>>>>>>>>>>>        Set Form_Width    item 2 to 60
39898>>>>>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
39899>>>>>>>>>>>        
39899>>>>>>>>>>>        Set Form_Width    item 3 to 135
39900>>>>>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
39901>>>>>>>>>>>        
39901>>>>>>>>>>>        Set Form_Width    item 4 to 60
39902>>>>>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
39903>>>>>>>>>>>        
39903>>>>>>>>>>>    End_Object    // oSelList
39904>>>>>>>>>>>
39904>>>>>>>>>>>    Object oOK_bn is a ButtonSub
39906>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
39907>>>>>>>>>>>        Set Location to 113 277
39908>>>>>>>>>>>
39908>>>>>>>>>>>        //AB-StoreStart
39908>>>>>>>>>>>        Procedure OnClick
39910>>>>>>>>>>>            Send OK To (oSelList(current_object))
39911>>>>>>>>>>>        End_Procedure
39912>>>>>>>>>>>        //AB-StoreEnd
39912>>>>>>>>>>>
39912>>>>>>>>>>>    End_Object    // oOK_bn
39913>>>>>>>>>>>
39913>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
39915>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
39916>>>>>>>>>>>        Set Location to 113 332
39917>>>>>>>>>>>
39917>>>>>>>>>>>        //AB-StoreStart
39917>>>>>>>>>>>        Procedure OnClick
39919>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
39920>>>>>>>>>>>        End_Procedure
39921>>>>>>>>>>>        //AB-StoreEnd
39921>>>>>>>>>>>
39921>>>>>>>>>>>    End_Object    // oCancel_bn
39922>>>>>>>>>>>
39922>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
39924>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
39925>>>>>>>>>>>        Set Location to 113 387
39926>>>>>>>>>>>
39926>>>>>>>>>>>        //AB-StoreStart
39926>>>>>>>>>>>        Procedure OnClick
39928>>>>>>>>>>>            Send Search To (oSelList(current_object))
39929>>>>>>>>>>>        End_Procedure
39930>>>>>>>>>>>        //AB-StoreEnd
39930>>>>>>>>>>>
39930>>>>>>>>>>>    End_Object    // oSearch_bn
39931>>>>>>>>>>>
39931>>>>>>>>>>>
39931>>>>>>>>>>>    //AB-StoreStart
39931>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39932>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39933>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39934>>>>>>>>>>>    //AB-StoreEnd
39934>>>>>>>>>>>
39934>>>>>>>>>>>End_Object    // sl111
39935>>>>>>>>>>>
39935>>>>>>>>>>>//AB/ End_Object    // prj
39935>>>>>>>>>Use sl198.sl         // sl198
INCLUDING FILE: SL198.SL
39935>>>>>>>>>>>//AB/ Project sl198:cities
39935>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
39935>>>>>>>>>>>//AB/     Set ProjectName to "sl198:cities"
39935>>>>>>>>>>>//AB/     Set ProjectFileName to "sl198.SL"
39935>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
39935>>>>>>>>>>>
39935>>>>>>>>>>>// Project Object Structure
39935>>>>>>>>>>>//   sl198 is a dbModalPanelSub
39935>>>>>>>>>>>//     Cities_DD is a DataDictionary
39935>>>>>>>>>>>//     oSelList is a dbListSub
39935>>>>>>>>>>>//     oOK_bn is a ButtonSub
39935>>>>>>>>>>>//     oCancel_bn is a ButtonSub
39935>>>>>>>>>>>//     oSearch_bn is a ButtonSub
39935>>>>>>>>>>>
39935>>>>>>>>>>>// Register all objects
39935>>>>>>>>>>>Register_Object Cities_DD
39935>>>>>>>>>>>Register_Object oCancel_bn
39935>>>>>>>>>>>Register_Object oOK_bn
39935>>>>>>>>>>>Register_Object oSearch_bn
39935>>>>>>>>>>>Register_Object oSelList
39935>>>>>>>>>>>Register_Object sl198
39935>>>>>>>>>>>
39935>>>>>>>>>>>
39935>>>>>>>>>>>//AB-IgnoreStart
39935>>>>>>>>>>>
39935>>>>>>>>>>>Use DFAllEnt.pkg
39935>>>>>>>>>>>Use dbList.Sub
39935>>>>>>>>>>>Use Button.Sub
39935>>>>>>>>>>>
39935>>>>>>>>>>>
39935>>>>>>>>>>>Use CITIES.DD
INCLUDING FILE: CITIES.DD
39935>>>>>>>>>>>>>//DDB-FileStart
39935>>>>>>>>>>>>>//DDB-HeaderStart
39935>>>>>>>>>>>>>
39935>>>>>>>>>>>>>// File Name : CITIES.DD
39935>>>>>>>>>>>>>// Class Name: Cities_DataDictionary
39935>>>>>>>>>>>>>// Revision  : 14
39935>>>>>>>>>>>>>// Version   : 2
39935>>>>>>>>>>>>>
39935>>>>>>>>>>>>>Use  Windows           // Basic Definitions
39935>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
39935>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39935>>>>>>>>>>>>>
39935>>>>>>>>>>>>>Open Cities
39937>>>>>>>>>>>>>Open Clients
39939>>>>>>>>>>>>>Open Towns
39941>>>>>>>>>>>>>
39941>>>>>>>>>>>>>//DDB-HeaderEnd
39941>>>>>>>>>>>>>//DDB-SelectionStart
39941>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.SL
39941>>>>>>>>>>>>>Register_Object sl198
39941>>>>>>>>>>>>>//DDB-SelectionEnd
39941>>>>>>>>>>>>>
39941>>>>>>>>>>>>>Class Cities_DataDictionary  is a DataDictionary_Sec
39942>>>>>>>>>>>>>
39942>>>>>>>>>>>>>    // Define_Fields:
39942>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39942>>>>>>>>>>>>>
39942>>>>>>>>>>>>>    Procedure Define_Fields
39943>>>>>>>>>>>>>        Forward Send Define_Fields
39945>>>>>>>>>>>>>        //DDB-Generated-Code-Location
39945>>>>>>>>>>>>>        //DDB-DefineFieldStart
39945>>>>>>>>>>>>>
39945>>>>>>>>>>>>>        Set Main_File            To Cities.File_Number
39946>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
39947>>>>>>>>>>>>>
39947>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39948>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39949>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39950>>>>>>>>>>>>>
39950>>>>>>>>>>>>>        // Child (Client) file structure................
39950>>>>>>>>>>>>>        Send Add_Client_File  Clients.File_Number
39951>>>>>>>>>>>>>
39951>>>>>>>>>>>>>        // Parent (Server) file structure...............
39951>>>>>>>>>>>>>        Send Add_Server_File  Towns.File_Number
39952>>>>>>>>>>>>>
39952>>>>>>>>>>>>>        // Field-based properties.......................
39952>>>>>>>>>>>>>
39952>>>>>>>>>>>>>        // Cities.City_Id
39952>>>>>>>>>>>>>        Set Field_Options          Field Cities.City_Id To DD_AUTOFIND   
39953>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cities.City_Id To (sl198(Self))
39954>>>>>>>>>>>>>        Set Key_Field_State        Field Cities.City_Id To TRUE
39955>>>>>>>>>>>>>
39955>>>>>>>>>>>>>        // Cities.City_Descr
39955>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cities.City_Descr To (sl198(Self))
39956>>>>>>>>>>>>>
39956>>>>>>>>>>>>>        // Cities.Town_Id
39956>>>>>>>>>>>>>
39956>>>>>>>>>>>>>        //DDB-DefineFieldEnd
39956>>>>>>>>>>>>>    End_Procedure    // Define_Fields
39957>>>>>>>>>>>>>
39957>>>>>>>>>>>>>    // Field_Defaults:
39957>>>>>>>>>>>>>    // This procedure is used to establish default field values.
39957>>>>>>>>>>>>>
39957>>>>>>>>>>>>>    Procedure Field_Defaults
39958>>>>>>>>>>>>>        Forward Send Field_Defaults
39960>>>>>>>>>>>>>        //DDB-Generated-Code-Location
39960>>>>>>>>>>>>>        //DDB-FieldDefaultStart
39960>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
39960>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
39961>>>>>>>>>>>>>
39961>>>>>>>>>>>>>End_Class    // Cities_DataDictionary
39962>>>>>>>>>>>>>//DDB-Selection-pkg-Start
39962>>>>>>>>>>>>>
39962>>>>>>>>>>>>>Use sl198.SL         // sl198
39962>>>>>>>>>>>>>
39962>>>>>>>>>>>>>//DDB-Selection-pkg-End
39962>>>>>>>>>>>>>//DDB-FileEnd
39962>>>>>>>>>>>
39962>>>>>>>>>>>//AB-IgnoreEnd
39962>>>>>>>>>>>
39962>>>>>>>>>>>Object sl198 is a dbModalPanelSub
39964>>>>>>>>>>>    Set Label to "€¨®œå¦ æ¢œà¤"
39965>>>>>>>>>>>    Set Size to 148 297
39966>>>>>>>>>>>    Set Location to 4 5
39967>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
39968>>>>>>>>>>>    Set Modal_State to FALSE
39969>>>>>>>>>>>
39969>>>>>>>>>>>    //AB-DDOStart
39969>>>>>>>>>>>
39969>>>>>>>>>>>    Object Cities_DD is a Cities_DataDictionary
39971>>>>>>>>>>>
39971>>>>>>>>>>>        //AB-StoreStart
39971>>>>>>>>>>>                
39971>>>>>>>>>>>                
39971>>>>>>>>>>>        //AB-StoreEnd
39971>>>>>>>>>>>
39971>>>>>>>>>>>    End_Object    // Cities_DD
39972>>>>>>>>>>>
39972>>>>>>>>>>>    Set Main_DD to (Cities_DD(self))
39973>>>>>>>>>>>    Set Server to (Cities_DD(self))
39974>>>>>>>>>>>
39974>>>>>>>>>>>    //AB-DDOEnd
39974>>>>>>>>>>>
39974>>>>>>>>>>>    Object oSelList is a dbListSub
39976>>>>>>>>>>>        Set Main_File to Cities.File_Number
39977>>>>>>>>>>>        Set Size to 105 280
39978>>>>>>>>>>>        Set Location to 6 6
39979>>>>>>>>>>>
39979>>>>>>>>>>>        Begin_Row
39982>>>>>>>>>>>            Entry_Item Cities.City_id
39983>>>>>>>>>>>            Entry_Item Cities.City_descr
39984>>>>>>>>>>>        End_Row
39989>>>>>>>>>>>
39989>>>>>>>>>>>        Set Form_Width    item 0 to 50
39990>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
39991>>>>>>>>>>>        
39991>>>>>>>>>>>        Set Form_Width    item 1 to 221
39992>>>>>>>>>>>        Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
39993>>>>>>>>>>>        
39993>>>>>>>>>>>
39993>>>>>>>>>>>        //AB-StoreStart
39993>>>>>>>>>>>        
39993>>>>>>>>>>>        Set Column_Option Item 0 to NoEnter True
39994>>>>>>>>>>>        
39994>>>>>>>>>>>        
39994>>>>>>>>>>>        
39994>>>>>>>>>>>        
39994>>>>>>>>>>>        
39994>>>>>>>>>>>        //AB-StoreEnd
39994>>>>>>>>>>>
39994>>>>>>>>>>>    End_Object    // oSelList
39995>>>>>>>>>>>
39995>>>>>>>>>>>    Object oOK_bn is a ButtonSub
39997>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
39998>>>>>>>>>>>        Set Location to 115 126
39999>>>>>>>>>>>
39999>>>>>>>>>>>        //AB-StoreStart
39999>>>>>>>>>>>        Procedure OnClick
40001>>>>>>>>>>>            Send OK To (oSelList(current_object))
40002>>>>>>>>>>>        End_Procedure
40003>>>>>>>>>>>        //AB-StoreEnd
40003>>>>>>>>>>>
40003>>>>>>>>>>>    End_Object    // oOK_bn
40004>>>>>>>>>>>
40004>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
40006>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
40007>>>>>>>>>>>        Set Location to 115 181
40008>>>>>>>>>>>
40008>>>>>>>>>>>        //AB-StoreStart
40008>>>>>>>>>>>        Procedure OnClick
40010>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
40011>>>>>>>>>>>        End_Procedure
40012>>>>>>>>>>>        //AB-StoreEnd
40012>>>>>>>>>>>
40012>>>>>>>>>>>    End_Object    // oCancel_bn
40013>>>>>>>>>>>
40013>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
40015>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
40016>>>>>>>>>>>        Set Location to 115 236
40017>>>>>>>>>>>
40017>>>>>>>>>>>        //AB-StoreStart
40017>>>>>>>>>>>        Procedure OnClick
40019>>>>>>>>>>>            Send Search To (oSelList(current_object))
40020>>>>>>>>>>>        End_Procedure
40021>>>>>>>>>>>        //AB-StoreEnd
40021>>>>>>>>>>>
40021>>>>>>>>>>>    End_Object    // oSearch_bn
40022>>>>>>>>>>>
40022>>>>>>>>>>>
40022>>>>>>>>>>>    //AB-StoreStart
40022>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
40023>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
40024>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
40025>>>>>>>>>>>    //AB-StoreEnd
40025>>>>>>>>>>>
40025>>>>>>>>>>>End_Object    // sl198
40026>>>>>>>>>>>
40026>>>>>>>>>>>//AB/ End_Object    // prj
40026>>>>>>>>>Use sl197.SL         // sl197
INCLUDING FILE: SL197.SL
40026>>>>>>>>>>>//AB/ Project sl197:areas
40026>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
40026>>>>>>>>>>>//AB/         Set ProjectName to "sl197:areas"
40026>>>>>>>>>>>//AB/         Set ProjectFileName to "sl197.SL"
40026>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
40026>>>>>>>>>>>
40026>>>>>>>>>>>// Project Object Structure
40026>>>>>>>>>>>//   sl197 is a dbModalPanelSub
40026>>>>>>>>>>>//     Areas_DD is a DataDictionary
40026>>>>>>>>>>>//     oSelList is a dbListSub
40026>>>>>>>>>>>//     oOK_bn is a ButtonSub
40026>>>>>>>>>>>//     oCancel_bn is a ButtonSub
40026>>>>>>>>>>>//     oSearch_bn is a ButtonSub
40026>>>>>>>>>>>
40026>>>>>>>>>>>// Register all objects
40026>>>>>>>>>>>Register_Object Areas_DD
40026>>>>>>>>>>>Register_Object oCancel_bn
40026>>>>>>>>>>>Register_Object oOK_bn
40026>>>>>>>>>>>Register_Object oSearch_bn
40026>>>>>>>>>>>Register_Object oSelList
40026>>>>>>>>>>>Register_Object sl197
40026>>>>>>>>>>>
40026>>>>>>>>>>>
40026>>>>>>>>>>>    //AB-IgnoreStart
40026>>>>>>>>>>>
40026>>>>>>>>>>>    Use DFAllEnt.pkg
40026>>>>>>>>>>>    Use dbList.Sub
40026>>>>>>>>>>>    Use Button.Sub
40026>>>>>>>>>>>
40026>>>>>>>>>>>
40026>>>>>>>>>>>    Use AREAS.DD
INCLUDING FILE: AREAS.DD
40026>>>>>>>>>>>>>//DDB-FileStart
40026>>>>>>>>>>>>>//DDB-HeaderStart
40026>>>>>>>>>>>>>
40026>>>>>>>>>>>>>// File Name : AREAS.DD
40026>>>>>>>>>>>>>// Class Name: Areas_DataDictionary
40026>>>>>>>>>>>>>// Revision  : 7
40026>>>>>>>>>>>>>// Version   : 2
40026>>>>>>>>>>>>>
40026>>>>>>>>>>>>>Use  Windows           // Basic Definitions
40026>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
40026>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
40026>>>>>>>>>>>>>
40026>>>>>>>>>>>>>Open Areas
40028>>>>>>>>>>>>>Open Clients
40030>>>>>>>>>>>>>
40030>>>>>>>>>>>>>//DDB-HeaderEnd
40030>>>>>>>>>>>>>//DDB-SelectionStart
40030>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
40030>>>>>>>>>>>>>Register_Object sl197
40030>>>>>>>>>>>>>//DDB-SelectionEnd
40030>>>>>>>>>>>>>
40030>>>>>>>>>>>>>Class Areas_DataDictionary  is a DataDictionary_Sec
40031>>>>>>>>>>>>>
40031>>>>>>>>>>>>>    // Define_Fields:
40031>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
40031>>>>>>>>>>>>>
40031>>>>>>>>>>>>>    Procedure Define_Fields
40032>>>>>>>>>>>>>        Forward Send Define_Fields
40034>>>>>>>>>>>>>        //DDB-Generated-Code-Location
40034>>>>>>>>>>>>>        //DDB-DefineFieldStart
40034>>>>>>>>>>>>>
40034>>>>>>>>>>>>>        Set Main_File            To Areas.File_Number
40035>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
40036>>>>>>>>>>>>>
40036>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
40037>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
40038>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
40039>>>>>>>>>>>>>
40039>>>>>>>>>>>>>        // Child (Client) file structure................
40039>>>>>>>>>>>>>        Send Add_Client_File  Clients.File_Number
40040>>>>>>>>>>>>>
40040>>>>>>>>>>>>>        // Field-based properties.......................
40040>>>>>>>>>>>>>
40040>>>>>>>>>>>>>        // Areas.Area_Id
40040>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Areas.Area_Id To (sl197(Self))
40041>>>>>>>>>>>>>
40041>>>>>>>>>>>>>        // Areas.Area_Descr
40041>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Areas.Area_Descr To (sl197(Self))
40042>>>>>>>>>>>>>
40042>>>>>>>>>>>>>        // Areas.Area_Site
40042>>>>>>>>>>>>>
40042>>>>>>>>>>>>>        //DDB-DefineFieldEnd
40042>>>>>>>>>>>>>    End_Procedure    // Define_Fields
40043>>>>>>>>>>>>>
40043>>>>>>>>>>>>>    // Field_Defaults:
40043>>>>>>>>>>>>>    // This procedure is used to establish default field values.
40043>>>>>>>>>>>>>
40043>>>>>>>>>>>>>    Procedure Field_Defaults
40044>>>>>>>>>>>>>        Forward Send Field_Defaults
40046>>>>>>>>>>>>>        //DDB-Generated-Code-Location
40046>>>>>>>>>>>>>        //DDB-FieldDefaultStart
40046>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
40046>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
40047>>>>>>>>>>>>>
40047>>>>>>>>>>>>>End_Class    // Areas_DataDictionary
40048>>>>>>>>>>>>>//DDB-Selection-pkg-Start
40048>>>>>>>>>>>>>
40048>>>>>>>>>>>>>Use sl197.SL         // sl197
40048>>>>>>>>>>>>>
40048>>>>>>>>>>>>>//DDB-Selection-pkg-End
40048>>>>>>>>>>>>>//DDB-FileEnd
40048>>>>>>>>>>>    
40048>>>>>>>>>>>    //AB-IgnoreEnd
40048>>>>>>>>>>>
40048>>>>>>>>>>>    Object sl197 is a dbModalPanelSub
40050>>>>>>>>>>>
40050>>>>>>>>>>>        //AB-StoreTopStart
40050>>>>>>>>>>>                    
40050>>>>>>>>>>>        //AB-StoreTopEnd
40050>>>>>>>>>>>
40050>>>>>>>>>>>        Set Label to "€¨®œå¦ œ¨ ¦®é¤"
40051>>>>>>>>>>>        Set Size to 148 297
40052>>>>>>>>>>>        Set Location to 4 5
40053>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
40054>>>>>>>>>>>        Set Modal_State to FALSE
40055>>>>>>>>>>>
40055>>>>>>>>>>>        //AB-DDOStart
40055>>>>>>>>>>>
40055>>>>>>>>>>>        Object Areas_DD is a Areas_DataDictionary
40057>>>>>>>>>>>
40057>>>>>>>>>>>            //AB-StoreStart
40057>>>>>>>>>>>                                    
40057>>>>>>>>>>>            //AB-StoreEnd
40057>>>>>>>>>>>
40057>>>>>>>>>>>        End_Object    // Areas_DD
40058>>>>>>>>>>>
40058>>>>>>>>>>>        Set Main_DD to (Areas_DD(self))
40059>>>>>>>>>>>        Set Server to (Areas_DD(self))
40060>>>>>>>>>>>
40060>>>>>>>>>>>        //AB-DDOEnd
40060>>>>>>>>>>>
40060>>>>>>>>>>>        Object oSelList is a dbListSub
40062>>>>>>>>>>>            Set Main_File to Areas.File_Number
40063>>>>>>>>>>>            Set Ordering to 2
40064>>>>>>>>>>>            Set Size to 105 280
40065>>>>>>>>>>>            Set Location to 5 5
40066>>>>>>>>>>>            Set Export_Item_State to TRUE
40067>>>>>>>>>>>
40067>>>>>>>>>>>            Begin_Row
40070>>>>>>>>>>>                Entry_Item Areas.Area_id
40071>>>>>>>>>>>                Entry_Item Areas.Area_descr
40072>>>>>>>>>>>                Entry_Item Areas.Area_site
40073>>>>>>>>>>>            End_Row
40078>>>>>>>>>>>
40078>>>>>>>>>>>            Set Form_Width    item 0 to 45
40079>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
40080>>>>>>>>>>>            
40080>>>>>>>>>>>            Set Form_Width    item 1 to 192
40081>>>>>>>>>>>            Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
40082>>>>>>>>>>>            
40082>>>>>>>>>>>            Set Form_Width    item 2 to 35
40083>>>>>>>>>>>            Set Header_Label  item 2 to "’¦£â˜ª"
40084>>>>>>>>>>>            
40084>>>>>>>>>>>
40084>>>>>>>>>>>            //AB-StoreStart
40084>>>>>>>>>>>            
40084>>>>>>>>>>>            Set Column_Option Item 0 to NoEnter True
40085>>>>>>>>>>>            
40085>>>>>>>>>>>            
40085>>>>>>>>>>>            //AB-StoreEnd
40085>>>>>>>>>>>
40085>>>>>>>>>>>        End_Object    // oSelList
40086>>>>>>>>>>>
40086>>>>>>>>>>>        Object oOK_bn is a ButtonSub
40088>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
40089>>>>>>>>>>>            Set Location to 115 126
40090>>>>>>>>>>>
40090>>>>>>>>>>>            //AB-StoreStart
40090>>>>>>>>>>>            Procedure OnClick
40092>>>>>>>>>>>                Send OK To (oSelList(current_object))
40093>>>>>>>>>>>            End_Procedure
40094>>>>>>>>>>>            //AB-StoreEnd
40094>>>>>>>>>>>
40094>>>>>>>>>>>        End_Object    // oOK_bn
40095>>>>>>>>>>>
40095>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
40097>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
40098>>>>>>>>>>>            Set Location to 115 181
40099>>>>>>>>>>>
40099>>>>>>>>>>>            //AB-StoreStart
40099>>>>>>>>>>>            Procedure OnClick
40101>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
40102>>>>>>>>>>>            End_Procedure
40103>>>>>>>>>>>            //AB-StoreEnd
40103>>>>>>>>>>>
40103>>>>>>>>>>>        End_Object    // oCancel_bn
40104>>>>>>>>>>>
40104>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
40106>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
40107>>>>>>>>>>>            Set Location to 115 236
40108>>>>>>>>>>>
40108>>>>>>>>>>>            //AB-StoreStart
40108>>>>>>>>>>>            Procedure OnClick
40110>>>>>>>>>>>                Send Search To (oSelList(current_object))
40111>>>>>>>>>>>            End_Procedure
40112>>>>>>>>>>>            //AB-StoreEnd
40112>>>>>>>>>>>
40112>>>>>>>>>>>        End_Object    // oSearch_bn
40113>>>>>>>>>>>
40113>>>>>>>>>>>
40113>>>>>>>>>>>        //AB-StoreStart
40113>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
40114>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
40115>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
40116>>>>>>>>>>>        
40116>>>>>>>>>>>        
40116>>>>>>>>>>>        
40116>>>>>>>>>>>        
40116>>>>>>>>>>>        
40116>>>>>>>>>>>        //AB-StoreEnd
40116>>>>>>>>>>>
40116>>>>>>>>>>>    End_Object    // sl197
40117>>>>>>>>>>>
40117>>>>>>>>>>>//AB/     End_Object    // prj
40117>>>>>>>>>
40117>>>>>>>>>//DDB-Selection-pkg-End
40117>>>>>>>>>//DDB-FileEnd
40117>>>>>>>Use PmsSxet.DD
INCLUDING FILE: PMSSXET.DD
40117>>>>>>>>>//DDB-FileStart
40117>>>>>>>>>//DDB-HeaderStart
40117>>>>>>>>>
40117>>>>>>>>>// File Name : PMSSXET.DD
40117>>>>>>>>>// Class Name: PmsSxet_DataDictionary
40117>>>>>>>>>// Revision  : 27
40117>>>>>>>>>// Version   : 2
40117>>>>>>>>>
40117>>>>>>>>>Use  Windows           // Basic Definitions
40117>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
40117>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
40117>>>>>>>>>
40117>>>>>>>>>Open Pmssxet
INCLUDING FILE: PMSSXET.FD
40119>>>>>>>>>Open Pmoves
40121>>>>>>>>>Open Psxetika
INCLUDING FILE: PSXETIKA.FD
40123>>>>>>>>>Open Pmoves
40125>>>>>>>>>
40125>>>>>>>>>//DDB-HeaderEnd
40125>>>>>>>>>
40125>>>>>>>>>Use bpEnYpol.dg
INCLUDING FILE: BPENYPOL.DG
40125>>>>>>>>>>>//AB/ Project bpEnYpol
40125>>>>>>>>>>>//AB/ Object prj is a Dialog_Project
40125>>>>>>>>>>>//AB/     Set ProjectName to "bpEnYpol"
40125>>>>>>>>>>>//AB/     Set ProjectFileName to "bpEnYpol.DG"
40125>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
40125>>>>>>>>>>>
40125>>>>>>>>>>>// Project Object Structure
40125>>>>>>>>>>>//   bpEnYpol is a BusinessProcessSub
40125>>>>>>>>>>>
40125>>>>>>>>>>>// Register all objects
40125>>>>>>>>>>>Register_Object bpEnYpol
40125>>>>>>>>>>>
40125>>>>>>>>>>>
40125>>>>>>>>>>>//AB-IgnoreStart
40125>>>>>>>>>>>
40125>>>>>>>>>>>Use Bproces.Sub
40125>>>>>>>>>>>
40125>>>>>>>>>>>
40125>>>>>>>>>>>//AB-IgnoreEnd
40125>>>>>>>>>>>
40125>>>>>>>>>>>Object bpEnYpol is a BusinessProcessSub
40127>>>>>>>>>>>
40127>>>>>>>>>>>    //AB-StoreTopStart
40127>>>>>>>>>>>
40127>>>>>>>>>>>    Open Pmoves
40129>>>>>>>>>>>    Open Psxetika
40131>>>>>>>>>>>
40131>>>>>>>>>>>    Set Status_Panel_State to False
40132>>>>>>>>>>>    //Set Allow_Cancel_State  to True
40132>>>>>>>>>>>    Set Display_Error_State to True
40133>>>>>>>>>>>    //Set Process_Title to "               "
40133>>>>>>>>>>>    //Set Status_Log_id to (status_log(Self)) //Use statlog.pkg
40133>>>>>>>>>>>    //Set Status_log_state to True
40133>>>>>>>>>>>
40133>>>>>>>>>>>    Property Integer    piFromAkyrosh       Public  0
40135>>>>>>>>>>>    Property Integer    piLathos            Public  0
40137>>>>>>>>>>>    Property Number     pnQty               Public  0
40139>>>>>>>>>>>    Property Integer    piCurrentPartl      Public  0
40141>>>>>>>>>>>    Property Integer    piCurrentPmoves     Public  0
40143>>>>>>>>>>>    Property Integer    piCurrentPmsSxet    Public  0
40145>>>>>>>>>>>    Property String     psRecr              Public ''
40147>>>>>>>>>>>
40147>>>>>>>>>>>
40147>>>>>>>>>>>    //AB-StoreTopEnd
40147>>>>>>>>>>>
40147>>>>>>>>>>>    Set Size to 60 100
40148>>>>>>>>>>>    Set Location to 4 5
40149>>>>>>>>>>>
40149>>>>>>>>>>>    //AB-DDOStart
40149>>>>>>>>>>>
40149>>>>>>>>>>>
40149>>>>>>>>>>>    //AB-DDOEnd
40149>>>>>>>>>>>
40149>>>>>>>>>>>
40149>>>>>>>>>>>    //AB-StoreStart
40149>>>>>>>>>>>
40149>>>>>>>>>>>    Function fiUpdate_Pmoves_Qty String asRecr Number anQty Integer aiDoNotOpen Returns Integer
40151>>>>>>>>>>>        Clear Pmoves
40152>>>>>>>>>>>        Move asRecr to Pmoves.Pms_Recr
40153>>>>>>>>>>>        Find Eq Pmoves by index.2
40154>>>>>>>>>>>>
40154>>>>>>>>>>>        If (Found) Begin
40156>>>>>>>>>>>            If ((Pmoves.Timol_Qty+anQty) > Pmoves.Pms_Qty) Function_Return 40001
40159>>>>>>>>>>>            Else Begin
40160>>>>>>>>>>>                //Reread Pmoves
40160>>>>>>>>>>>                Add anQty to Pmoves.Timol_Qty
40161>>>>>>>>>>>                Move (Pmoves.Pms_Qty-Pmoves.Timol_Qty) to Pmoves.Timol_Ypol
40162>>>>>>>>>>>                Saverecord Pmoves
40163>>>>>>>>>>>               // Unlock
40163>>>>>>>>>>>
40163>>>>>>>>>>>                Clear Particle
40164>>>>>>>>>>>                Move Pmoves.Partl_Recr to Particle.Partl_Recr
40165>>>>>>>>>>>                Find Eq Particle by Index.2
40166>>>>>>>>>>>>
40166>>>>>>>>>>>                If (Found) Begin
40168>>>>>>>>>>>                   // Reread
40168>>>>>>>>>>>                    Add anQty to Particle.Timol_Qty
40169>>>>>>>>>>>                    If (Particle.Partl_TotTem>0) Begin
40171>>>>>>>>>>>                        Move (Particle.Partl_TotTem-Particle.Timol_Qty)     to Particle.Timol_Ypol
40172>>>>>>>>>>>
40172>>>>>>>>>>>                        If (aiDoNotOpen=1)  Move 1                          to Particle.Partl_Timol
40175>>>>>>>>>>>                        Else                Move (Particle.Timol_Ypol=0 )   to Particle.Partl_Timol
40177>>>>>>>>>>>                        // 07/01/2003
40177>>>>>>>>>>>                        //Else                Move (Particle.Timol_Qty>0 )    to Particle.Partl_Timol
40177>>>>>>>>>>>
40177>>>>>>>>>>>                    End
40177>>>>>>>>>>>>
40177>>>>>>>>>>>                    Else Move 0 to Particle.Partl_Timol
40179>>>>>>>>>>>                    Saverecord Particle
40180>>>>>>>>>>>                   // Unlock
40180>>>>>>>>>>>                End
40180>>>>>>>>>>>>
40180>>>>>>>>>>>                Else Function_Return 40002
40182>>>>>>>>>>>            End
40182>>>>>>>>>>>>
40182>>>>>>>>>>>        End
40182>>>>>>>>>>>>
40182>>>>>>>>>>>        Else Function_Return 40000
40184>>>>>>>>>>>        Function_Return 0
40185>>>>>>>>>>>    End_Function
40186>>>>>>>>>>>
40186>>>>>>>>>>>    Procedure OnProcess
40188>>>>>>>>>>>        Integer iLathos iSub iAkyro
40189>>>>>>>>>>>        String  sCurr sRecr sPmoveRecr sParticleRecr
40189>>>>>>>>>>>        Number  nQty nQty2
40189>>>>>>>>>>>
40189>>>>>>>>>>>        Set piLathos        to 0
40190>>>>>>>>>>>        Get pnQty           to nQty2
40191>>>>>>>>>>>        Get psRecr          to sRecr
40192>>>>>>>>>>>        Get piFromAkyrosh   to iAkyro
40193>>>>>>>>>>>
40193>>>>>>>>>>>        // An h posothta einai setarismenh thetika shmainei pos klhthike
40193>>>>>>>>>>>        // apo thn Update tou PmsSxet, allios an erthei arnhtikh apo thn Backout
40193>>>>>>>>>>>        // Prepei na to xeroume gia thn periptosh tou akyrotikou, opou tha trexei
40193>>>>>>>>>>>        // apanota h function kai tha antistrpsei to proshmo ths posothtas.
40193>>>>>>>>>>>        Move (nQty2<0)   to iSub
40194>>>>>>>>>>>
40194>>>>>>>>>>>
40194>>>>>>>>>>>        Get fiUpdate_Pmoves_Qty sRecr nQty2 0 to iLathos
40195>>>>>>>>>>>
40195>>>>>>>>>>>        If (iLathos) Begin
40197>>>>>>>>>>>            Set piLathos to iLathos
40198>>>>>>>>>>>            Procedure_Return
40199>>>>>>>>>>>        End
40199>>>>>>>>>>>>
40199>>>>>>>>>>>
40199>>>>>>>>>>>
40199>>>>>>>>>>>        // js 30/08/2002 Enhmerosh ena bhma pio piso sthn periptosh pou
40199>>>>>>>>>>>        // h enhmerosh ton pmoves apo backout kai update tou PmsSxet,
40199>>>>>>>>>>>        // afora Akyrotiko. (DAP --> TIM --> AKYROTIKO). Erxomaste dhladh edo apo
40199>>>>>>>>>>>        // AKYROTIKO na enhmerosoume tis posothtes tou TIMOLOGIOU.
40199>>>>>>>>>>>        // Sthn periptosh ayth prepei na kanoume ta exhs:
40199>>>>>>>>>>>        // 1. Eyresh ton sxetikon tou trxontos pmove TIMOLOGIOU
40199>>>>>>>>>>>        // 2. Antistrofh tou proshmou ths posothtas tous
40199>>>>>>>>>>>        // 3. Eyresh tou arxikou Pmoves (DAP) kai enhmerosh posothtas kinhshs
40199>>>>>>>>>>>
40199>>>>>>>>>>>        If (iAkyro) Begin
40201>>>>>>>>>>>            Clear Pmoves
40202>>>>>>>>>>>            Move sRecr to Pmoves.Pms_Recr
40203>>>>>>>>>>>            Find Eq Pmoves by index.2
40204>>>>>>>>>>>>
40204>>>>>>>>>>>            If (Found) Begin
40206>>>>>>>>>>>                Clear PmsSxet
40207>>>>>>>>>>>                Move sRecr to PmsSxet.Pms_Recr
40208>>>>>>>>>>>                Find Gt PmsSxet by Index.1
40209>>>>>>>>>>>>
40209>>>>>>>>>>>                While ((Found=1) And (PmsSxet.Pms_Recr=sRecr))
40213>>>>>>>>>>>                    Move PmsSxet.Sxetiko_Recr   to sCurr
40214>>>>>>>>>>>                    Move PmsSxet.Posothta       to nQty
40215>>>>>>>>>>>                    If (iSub) Begin
40217>>>>>>>>>>>                        // An Exei erthei apo Backout tou PmsSxet (to gnorizoume apo thn posothta
40217>>>>>>>>>>>                        // h opoia sto property einai arnhtikh) tote gyrname thn posothta tou
40217>>>>>>>>>>>                        // PmsSxet thetikh (Ousiastika thn afhnoume opos einai dhladh).
40217>>>>>>>>>>>                    End
40217>>>>>>>>>>>>
40217>>>>>>>>>>>                    Else Begin
40218>>>>>>>>>>>                        // An Exei erthei apo Update tou PmsSxet (to gnorizoume apo thn posothta
40218>>>>>>>>>>>                        // h opoia sto property einai thetikh) tote gyrname thn posothta tou
40218>>>>>>>>>>>                        // PmsSxet arnhtikh.
40218>>>>>>>>>>>                        Move (nQty*(-1)) to nQty
40219>>>>>>>>>>>                    End
40219>>>>>>>>>>>>
40219>>>>>>>>>>>
40219>>>>>>>>>>>                    //Get fiUpdate_Pmoves_Qty sCurr nQty 1 to iLathos
40219>>>>>>>>>>>                    // 07/01/2003 //
40219>>>>>>>>>>>                    Get fiUpdate_Pmoves_Qty sCurr nQty 0 to iLathos
40220>>>>>>>>>>>
40220>>>>>>>>>>>                    If (iLathos) Begin
40222>>>>>>>>>>>                        Set piLathos to (iLathos+3)
40223>>>>>>>>>>>                        // An Gyrisei Pmoves Not Found      (40000) To kanoume 40003
40223>>>>>>>>>>>                        // An Gyrisei problhma sto ypoloipo (40001) To kanoume 40004
40223>>>>>>>>>>>                        // An Gyrisei problhma sto particle (40002) To kanoume 40005
40223>>>>>>>>>>>                        Procedure_Return
40224>>>>>>>>>>>                    End
40224>>>>>>>>>>>>
40224>>>>>>>>>>>
40224>>>>>>>>>>>                    Clear PmsSxet
40225>>>>>>>>>>>                    Move sRecr      to PmsSxet.Pms_Recr
40226>>>>>>>>>>>                    Move sCurr      to PmsSxet.Sxetiko_Recr
40227>>>>>>>>>>>                    Find Eq PmsSxet by Index.1
40228>>>>>>>>>>>>
40228>>>>>>>>>>>                    Find Gt PmsSxet by Index.1
40229>>>>>>>>>>>>
40229>>>>>>>>>>>                Loop
40230>>>>>>>>>>>>
40230>>>>>>>>>>>            End
40230>>>>>>>>>>>>
40230>>>>>>>>>>>            Else Set piLathos to 40006
40232>>>>>>>>>>>        End
40232>>>>>>>>>>>>
40232>>>>>>>>>>>
40232>>>>>>>>>>>        If (piLathos(Self)<>0) Procedure_Return
40235>>>>>>>>>>>
40235>>>>>>>>>>>    End_Procedure
40236>>>>>>>>>>>
40236>>>>>>>>>>>    Procedure OnError integer error_info string errMsg
40238>>>>>>>>>>>    End_Procedure
40239>>>>>>>>>>>
40239>>>>>>>>>>>    Procedure Start_Process
40241>>>>>>>>>>>        Forward Send Start_Process
40243>>>>>>>>>>>    End_Procedure
40244>>>>>>>>>>>
40244>>>>>>>>>>>    Procedure End_Process
40246>>>>>>>>>>>        Forward Send End_Process
40248>>>>>>>>>>>        If (piCurrentPartl(Self)) Begin
40250>>>>>>>>>>>            Clear Particle
40251>>>>>>>>>>>            Move (piCurrentPartl(Self)) to Particle.Recnum
40252>>>>>>>>>>>            Find Eq Particle.Recnum
40253>>>>>>>>>>>>
40253>>>>>>>>>>>        End
40253>>>>>>>>>>>>
40253>>>>>>>>>>>        If (piCurrentPmoves(Self)) Begin
40255>>>>>>>>>>>            Clear Pmoves
40256>>>>>>>>>>>            Move (piCurrentPmoves(Self)) to Pmoves.Recnum
40257>>>>>>>>>>>            Find Eq Pmoves.Recnum
40258>>>>>>>>>>>>
40258>>>>>>>>>>>        End
40258>>>>>>>>>>>>
40258>>>>>>>>>>>        If (piCurrentPmsSxet(Self)<>0) Begin
40260>>>>>>>>>>>            Clear PmsSxet
40261>>>>>>>>>>>            Move (piCurrentPmsSxet(Self)) to PmsSxet.Recnum
40262>>>>>>>>>>>            Find Eq PmsSxet.Recnum
40263>>>>>>>>>>>>
40263>>>>>>>>>>>        End
40263>>>>>>>>>>>>
40263>>>>>>>>>>>    End_Procedure
40264>>>>>>>>>>>
40264>>>>>>>>>>>    //AB-StoreEnd
40264>>>>>>>>>>>
40264>>>>>>>>>>>End_Object    // bpEnYpol
40265>>>>>>>>>>>
40265>>>>>>>>>>>//AB/ End_Object    // prj
40265>>>>>>>>>Use MyArray.dg
INCLUDING FILE: MYARRAY.DG
40265>>>>>>>>>>>//AB/ Project MyArray
40265>>>>>>>>>>>//AB/     Object prj is a Dialog_Project
40265>>>>>>>>>>>//AB/         Set ProjectName to "MyArray"
40265>>>>>>>>>>>//AB/         Set ProjectFileName to "MyArray.DG"
40265>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
40265>>>>>>>>>>>
40265>>>>>>>>>>>// Project Object Structure
40265>>>>>>>>>>>//   Psx_Array is a BusinessProcessSub
40265>>>>>>>>>>>//     Ctypkin_DD2 is a Ctypkin_DataDictionary
40265>>>>>>>>>>>//     Wtypkin_DD2 is a Wtypkin_DataDictionary
40265>>>>>>>>>>>//     Ptyppar_DD2 is a Ptyppar_DataDictionary
40265>>>>>>>>>>>//     Country_DD2 is a Country_DataDictionary
40265>>>>>>>>>>>//     Towns_DD2 is a Towns_DataDictionary
40265>>>>>>>>>>>//     Cities_DD2 is a Cities_DataDictionary
40265>>>>>>>>>>>//     Areas_DD2 is a Areas_DataDictionary
40265>>>>>>>>>>>//     Payresp_DD2 is a Payresp_DataDictionary
40265>>>>>>>>>>>//     Clients_DD2 is a Clients_DataDictionary
40265>>>>>>>>>>>//     Nomisma_DD2 is a Nomisma_DataDictionary
40265>>>>>>>>>>>//     Particle_DD2 is a Particle_DataDictionary
40265>>>>>>>>>>>//     Ctypkin_DD is a Ctypkin_DataDictionary
40265>>>>>>>>>>>//     Wtypkin_DD is a Wtypkin_DataDictionary
40265>>>>>>>>>>>//     Ptyppar_DD is a Ptyppar_DataDictionary
40265>>>>>>>>>>>//     Country_DD is a Country_DataDictionary
40265>>>>>>>>>>>//     Towns_DD is a Towns_DataDictionary
40265>>>>>>>>>>>//     Cities_DD is a Cities_DataDictionary
40265>>>>>>>>>>>//     Areas_DD is a Areas_DataDictionary
40265>>>>>>>>>>>//     Payresp_DD is a Payresp_DataDictionary
40265>>>>>>>>>>>//     Clients_DD is a Clients_DataDictionary
40265>>>>>>>>>>>//     Nomisma_DD is a Nomisma_DataDictionary
40265>>>>>>>>>>>//     Particle_DD is a Particle_DataDictionary
40265>>>>>>>>>>>//     Psxetika_DD is a Psxetika_DataDictionary
40265>>>>>>>>>>>
40265>>>>>>>>>>>// Register all objects
40265>>>>>>>>>>>Register_Object Areas_DD
40265>>>>>>>>>>>Register_Object Areas_DD2
40265>>>>>>>>>>>Register_Object Cities_DD
40265>>>>>>>>>>>Register_Object Cities_DD2
40265>>>>>>>>>>>Register_Object Clients_DD
40265>>>>>>>>>>>Register_Object Clients_DD2
40265>>>>>>>>>>>Register_Object Country_DD
40265>>>>>>>>>>>Register_Object Country_DD2
40265>>>>>>>>>>>Register_Object Ctypkin_DD
40265>>>>>>>>>>>Register_Object Ctypkin_DD2
40265>>>>>>>>>>>Register_Object Nomisma_DD
40265>>>>>>>>>>>Register_Object Nomisma_DD2
40265>>>>>>>>>>>Register_Object Particle_DD
40265>>>>>>>>>>>Register_Object Particle_DD2
40265>>>>>>>>>>>Register_Object Payresp_DD
40265>>>>>>>>>>>Register_Object Payresp_DD2
40265>>>>>>>>>>>Register_Object Psx_Array
40265>>>>>>>>>>>Register_Object Psxetika_DD
40265>>>>>>>>>>>Register_Object Ptyppar_DD
40265>>>>>>>>>>>Register_Object Ptyppar_DD2
40265>>>>>>>>>>>Register_Object Towns_DD
40265>>>>>>>>>>>Register_Object Towns_DD2
40265>>>>>>>>>>>Register_Object Wtypkin_DD
40265>>>>>>>>>>>Register_Object Wtypkin_DD2
40265>>>>>>>>>>>
40265>>>>>>>>>>>
40265>>>>>>>>>>>
40265>>>>>>>>>>>    //AB-StoreTopStart
40265>>>>>>>>>>>
40265>>>>>>>>>>>    Use CTYPKIN.DD
40265>>>>>>>>>>>    Use WTYPKIN.DD
INCLUDING FILE: WTYPKIN.DD
40265>>>>>>>>>>>>>//DDB-FileStart
40265>>>>>>>>>>>>>//DDB-HeaderStart
40265>>>>>>>>>>>>>
40265>>>>>>>>>>>>>// File Name : WTYPKIN.DD
40265>>>>>>>>>>>>>// Class Name: Wtypkin_DataDictionary
40265>>>>>>>>>>>>>// Revision  : 49
40265>>>>>>>>>>>>>// Version   : 2
40265>>>>>>>>>>>>>
40265>>>>>>>>>>>>>Use  Windows           // Basic Definitions
40265>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
40265>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
40265>>>>>>>>>>>>>
40265>>>>>>>>>>>>>Open Wtypkin
40267>>>>>>>>>>>>>Open Ptyppar
40269>>>>>>>>>>>>>Open Wcmoves
40271>>>>>>>>>>>>>Open Hmwtyp
INCLUDING FILE: HMWTYP.FD
40273>>>>>>>>>>>>>Open Wflagkin
INCLUDING FILE: WFLAGKIN.FD
40275>>>>>>>>>>>>>Open Sysrecw
40277>>>>>>>>>>>>>Open Syscurxr
40279>>>>>>>>>>>>>
40279>>>>>>>>>>>>>//DDB-HeaderEnd
40279>>>>>>>>>>>>>//DDB-ValidationStart
40279>>>>>>>>>>>>>
40279>>>>>>>>>>>>>Register_Object Wtypkin_Wtypkin_Module_VT
40279>>>>>>>>>>>>>
40279>>>>>>>>>>>>>Object Wtypkin_Wtypkin_Module_VT  is a CodeValidationTable
40281>>>>>>>>>>>>>    Set Type_Value        To "MODULE"
40282>>>>>>>>>>>>>    //DDB-ValidationCustomStart
40282>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
40282>>>>>>>>>>>>>End_Object   // Wtypkin_Wtypkin_Module_VT
40283>>>>>>>>>>>>>//DDB-ValidationEnd
40283>>>>>>>>>>>>>//DDB-SelectionStart
40283>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl029a  sl029a.SL
40283>>>>>>>>>>>>>Register_Object sl029a
40283>>>>>>>>>>>>>//DDB-SelectionEnd
40283>>>>>>>>>>>>>
40283>>>>>>>>>>>>>Class Wtypkin_DataDictionary  is a DataDictionary
40284>>>>>>>>>>>>>               
40284>>>>>>>>>>>>>    Procedure Construct_Object
40285>>>>>>>>>>>>>        Forward Send Construct_Object
40287>>>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
40288>>>>>>>>>>>>>    End_Procedure
40289>>>>>>>>>>>>>
40289>>>>>>>>>>>>>    Procedure Save_Main_File
40290>>>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
40292>>>>>>>>>>>>>            If Wtypkin.Recnum Eq 0 Procedure_Return
40295>>>>>>>>>>>>>        End
40295>>>>>>>>>>>>>>
40295>>>>>>>>>>>>>        Forward Send Save_Main_File
40297>>>>>>>>>>>>>    End_Procedure
40298>>>>>>>>>>>>>
40298>>>>>>>>>>>>>
40298>>>>>>>>>>>>>     Procedure Creating
40299>>>>>>>>>>>>>        Forward Send Creating
40301>>>>>>>>>>>>>        // Insert Code Here
40301>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wtypkin.Wtypkin_Rec0)))))) to Wtypkin.Wtypkin_Recr
40302>>>>>>>>>>>>>    End_Procedure   // Creating
40303>>>>>>>>>>>>>
40303>>>>>>>>>>>>>    // Define_Fields:
40303>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
40303>>>>>>>>>>>>>
40303>>>>>>>>>>>>>    Procedure Define_Fields
40304>>>>>>>>>>>>>        Forward Send Define_Fields
40306>>>>>>>>>>>>>        //DDB-Generated-Code-Location
40306>>>>>>>>>>>>>        //DDB-DefineFieldStart
40306>>>>>>>>>>>>>
40306>>>>>>>>>>>>>        Set Main_File            To Wtypkin.File_Number
40307>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
40308>>>>>>>>>>>>>
40308>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
40309>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
40310>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
40311>>>>>>>>>>>>>
40311>>>>>>>>>>>>>        // Child (Client) file structure................
40311>>>>>>>>>>>>>        Send Add_Client_File  Ptyppar.File_Number
40312>>>>>>>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
40313>>>>>>>>>>>>>        Send Add_Client_File  Hmwtyp.File_Number
40314>>>>>>>>>>>>>        Send Add_Client_File  Wflagkin.File_Number
40315>>>>>>>>>>>>>
40315>>>>>>>>>>>>>        // External (System) file structure.............
40315>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
40316>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
40317>>>>>>>>>>>>>
40317>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Wtypkin_Rec0  To Wtypkin.Wtypkin_Rec0
40320>>>>>>>>>>>>>
40320>>>>>>>>>>>>>        // Field-based properties.......................
40320>>>>>>>>>>>>>
40320>>>>>>>>>>>>>        // Wtypkin.Company_Code
40320>>>>>>>>>>>>>
40320>>>>>>>>>>>>>        // Wtypkin.Branch_Code
40320>>>>>>>>>>>>>
40320>>>>>>>>>>>>>        // Wtypkin.Year_Year
40320>>>>>>>>>>>>>
40320>>>>>>>>>>>>>        // Wtypkin.Wtypkin_Code
40320>>>>>>>>>>>>>        Set Field_Options          Field Wtypkin.Wtypkin_Code To DD_AUTOFIND   
40321>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Wtypkin.Wtypkin_Code To (sl029a(Self))
40322>>>>>>>>>>>>>        Set Key_Field_State        Field Wtypkin.Wtypkin_Code To TRUE
40323>>>>>>>>>>>>>
40323>>>>>>>>>>>>>        // Wtypkin.Wtypkin_Rec0
40323>>>>>>>>>>>>>        Set Field_Options          Field Wtypkin.Wtypkin_Rec0 To DD_AUTOFIND   
40324>>>>>>>>>>>>>
40324>>>>>>>>>>>>>        // Wtypkin.Wtypkin_Recr
40324>>>>>>>>>>>>>
40324>>>>>>>>>>>>>        // Wtypkin.Year_Recr
40324>>>>>>>>>>>>>
40324>>>>>>>>>>>>>        // Wtypkin.Wtypkin_Descr
40324>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Wtypkin.Wtypkin_Descr To (sl029a(Self))
40325>>>>>>>>>>>>>
40325>>>>>>>>>>>>>        // Wtypkin.Wtypkin_Anti
40325>>>>>>>>>>>>>
40325>>>>>>>>>>>>>        // Wtypkin.Wtypkin_Module
40325>>>>>>>>>>>>>        Set Field_Value_Table      Field Wtypkin.Wtypkin_Module To (Wtypkin_Wtypkin_Module_VT(Self))
40326>>>>>>>>>>>>>
40326>>>>>>>>>>>>>        // Wtypkin.Max_Days_Sx_Par
40326>>>>>>>>>>>>>
40326>>>>>>>>>>>>>        //DDB-DefineFieldEnd
40326>>>>>>>>>>>>>    End_Procedure    // Define_Fields
40327>>>>>>>>>>>>>
40327>>>>>>>>>>>>>    // Field_Defaults:
40327>>>>>>>>>>>>>    // This procedure is used to establish default field values.
40327>>>>>>>>>>>>>
40327>>>>>>>>>>>>>    Procedure Field_Defaults
40328>>>>>>>>>>>>>        Forward Send Field_Defaults
40330>>>>>>>>>>>>>        //DDB-Generated-Code-Location
40330>>>>>>>>>>>>>        //DDB-FieldDefaultStart
40330>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
40330>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
40331>>>>>>>>>>>>>
40331>>>>>>>>>>>>>End_Class    // Wtypkin_DataDictionary
40332>>>>>>>>>>>>>//DDB-Selection-pkg-Start
40332>>>>>>>>>>>>>
40332>>>>>>>>>>>>>Use sl029a.SL        // sl029a
INCLUDING FILE: SL029A.SL
40332>>>>>>>>>>>>>>>//AB/ Project sl029a:wtypkin
40332>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
40332>>>>>>>>>>>>>>>//AB/         Set ProjectName to "sl029a:wtypkin"
40332>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl029a.SL"
40332>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
40332>>>>>>>>>>>>>>>
40332>>>>>>>>>>>>>>>// Project Object Structure
40332>>>>>>>>>>>>>>>//   sl029a is a dbModalPanelSub
40332>>>>>>>>>>>>>>>//     Wtypkin_DD is a DataDictionary
40332>>>>>>>>>>>>>>>//     oSelList is a dbListSub
40332>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
40332>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
40332>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
40332>>>>>>>>>>>>>>>
40332>>>>>>>>>>>>>>>// Register all objects
40332>>>>>>>>>>>>>>>Register_Object oCancel_bn
40332>>>>>>>>>>>>>>>Register_Object oOK_bn
40332>>>>>>>>>>>>>>>Register_Object oSearch_bn
40332>>>>>>>>>>>>>>>Register_Object oSelList
40332>>>>>>>>>>>>>>>Register_Object sl029a
40332>>>>>>>>>>>>>>>Register_Object Wtypkin_DD
40332>>>>>>>>>>>>>>>
40332>>>>>>>>>>>>>>>
40332>>>>>>>>>>>>>>>    //AB-IgnoreStart
40332>>>>>>>>>>>>>>>
40332>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
40332>>>>>>>>>>>>>>>    Use dbList.Sub
40332>>>>>>>>>>>>>>>    Use Button.Sub
40332>>>>>>>>>>>>>>>
40332>>>>>>>>>>>>>>>
40332>>>>>>>>>>>>>>>    Use WTYPKIN.DD
40332>>>>>>>>>>>>>>>    
40332>>>>>>>>>>>>>>>    //AB-IgnoreEnd
40332>>>>>>>>>>>>>>>
40332>>>>>>>>>>>>>>>    Object sl029a is a dbModalPanelSub
40334>>>>>>>>>>>>>>>        set label to "Ž¨ ©£æª ‰ ¤ã©œà¤ €§¦Ÿã¡žª" 
40335>>>>>>>>>>>>>>>        Set Size to 148 297
40336>>>>>>>>>>>>>>>        Set Location to 4 5
40337>>>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
40338>>>>>>>>>>>>>>>        Set Modal_State to FALSE
40339>>>>>>>>>>>>>>>
40339>>>>>>>>>>>>>>>        //AB-DDOStart
40339>>>>>>>>>>>>>>>
40339>>>>>>>>>>>>>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
40341>>>>>>>>>>>>>>>        End_Object    // Wtypkin_DD
40342>>>>>>>>>>>>>>>
40342>>>>>>>>>>>>>>>        Set Main_DD to (Wtypkin_DD(self))
40343>>>>>>>>>>>>>>>        Set Server to (Wtypkin_DD(self))
40344>>>>>>>>>>>>>>>
40344>>>>>>>>>>>>>>>        //AB-DDOEnd
40344>>>>>>>>>>>>>>>
40344>>>>>>>>>>>>>>>        Object oSelList is a dbListSub
40346>>>>>>>>>>>>>>>            Set Main_File to Wtypkin.File_Number
40347>>>>>>>>>>>>>>>            Set Size to 105 280
40348>>>>>>>>>>>>>>>            Set Location to 6 6
40349>>>>>>>>>>>>>>>
40349>>>>>>>>>>>>>>>            Begin_Row
40352>>>>>>>>>>>>>>>                Entry_Item Wtypkin.Wtypkin_code
40353>>>>>>>>>>>>>>>                Entry_Item Wtypkin.Wtypkin_descr
40354>>>>>>>>>>>>>>>            End_Row
40359>>>>>>>>>>>>>>>
40359>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 60
40360>>>>>>>>>>>>>>>            set header_label  item 0 to "‰à› ¡¦ª" 
40361>>>>>>>>>>>>>>>            
40361>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 212
40362>>>>>>>>>>>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
40363>>>>>>>>>>>>>>>            
40363>>>>>>>>>>>>>>>        End_Object    // oSelList
40364>>>>>>>>>>>>>>>
40364>>>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
40366>>>>>>>>>>>>>>>            set label to "&„§ ¢¦šã" 
40367>>>>>>>>>>>>>>>            Set Location to 115 126
40368>>>>>>>>>>>>>>>
40368>>>>>>>>>>>>>>>            //AB-StoreStart
40368>>>>>>>>>>>>>>>            Procedure OnClick
40370>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
40371>>>>>>>>>>>>>>>            End_Procedure
40372>>>>>>>>>>>>>>>            //AB-StoreEnd
40372>>>>>>>>>>>>>>>
40372>>>>>>>>>>>>>>>        End_Object    // oOK_bn
40373>>>>>>>>>>>>>>>
40373>>>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
40375>>>>>>>>>>>>>>>            set label to "&€¡ç¨à©ž" 
40376>>>>>>>>>>>>>>>            Set Location to 115 181
40377>>>>>>>>>>>>>>>
40377>>>>>>>>>>>>>>>            //AB-StoreStart
40377>>>>>>>>>>>>>>>            Procedure OnClick
40379>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
40380>>>>>>>>>>>>>>>            End_Procedure
40381>>>>>>>>>>>>>>>            //AB-StoreEnd
40381>>>>>>>>>>>>>>>
40381>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
40382>>>>>>>>>>>>>>>
40382>>>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
40384>>>>>>>>>>>>>>>            set label to "€&¤˜ã«ž©ž" 
40385>>>>>>>>>>>>>>>            Set Location to 115 236
40386>>>>>>>>>>>>>>>
40386>>>>>>>>>>>>>>>            //AB-StoreStart
40386>>>>>>>>>>>>>>>            Procedure OnClick
40388>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
40389>>>>>>>>>>>>>>>            End_Procedure
40390>>>>>>>>>>>>>>>            //AB-StoreEnd
40390>>>>>>>>>>>>>>>
40390>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
40391>>>>>>>>>>>>>>>
40391>>>>>>>>>>>>>>>
40391>>>>>>>>>>>>>>>        //AB-StoreStart
40391>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
40392>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
40393>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
40394>>>>>>>>>>>>>>>        //AB-StoreEnd
40394>>>>>>>>>>>>>>>
40394>>>>>>>>>>>>>>>    End_Object    // sl029a
40395>>>>>>>>>>>>>>>
40395>>>>>>>>>>>>>>>//AB/     End_Object    // prj
40395>>>>>>>>>>>>>
40395>>>>>>>>>>>>>//DDB-Selection-pkg-End
40395>>>>>>>>>>>>>//DDB-FileEnd
40395>>>>>>>>>>>    Use PTYPPAR.DD
INCLUDING FILE: PTYPPAR.DD
40395>>>>>>>>>>>>>//DDB-FileStart
40395>>>>>>>>>>>>>//DDB-HeaderStart
40395>>>>>>>>>>>>>
40395>>>>>>>>>>>>>// File Name : PTYPPAR.DD
40395>>>>>>>>>>>>>// Class Name: Ptyppar_DataDictionary
40395>>>>>>>>>>>>>// Revision  : 73
40395>>>>>>>>>>>>>// Version   : 2
40395>>>>>>>>>>>>>
40395>>>>>>>>>>>>>Use  Windows           // Basic Definitions
40395>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
40395>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
40395>>>>>>>>>>>>>
40395>>>>>>>>>>>>>Open Ptyppar
40397>>>>>>>>>>>>>Open Particle
40399>>>>>>>>>>>>>Open Pseira
INCLUDING FILE: PSEIRA.FD
40401>>>>>>>>>>>>>Open Ptypmet
INCLUDING FILE: PTYPMET.FD
40403>>>>>>>>>>>>>Open Ptypparh
INCLUDING FILE: PTYPPARH.FD
40405>>>>>>>>>>>>>Open Ctypkin
40407>>>>>>>>>>>>>Open Wtypkin
40409>>>>>>>>>>>>>Open Sysrecp
INCLUDING FILE: SYSRECP.FD
40411>>>>>>>>>>>>>Open Syscurxr
40413>>>>>>>>>>>>>
40413>>>>>>>>>>>>>//DDB-HeaderEnd
40413>>>>>>>>>>>>>//DDB-ValidationStart
40413>>>>>>>>>>>>>
40413>>>>>>>>>>>>>Register_Object Ptyppar_Ptyppar_Is_What_VT
40413>>>>>>>>>>>>>Register_Object Ptyppar_Ptyppar_Module_VT
40413>>>>>>>>>>>>>Register_Object Ptyppar_Ti_Typonei_Pms_VT1
40413>>>>>>>>>>>>>
40413>>>>>>>>>>>>>Object Ptyppar_Ptyppar_Is_What_VT  is a DescriptionValidationTable
40415>>>>>>>>>>>>>
40415>>>>>>>>>>>>>    Procedure Fill_List
40417>>>>>>>>>>>>>        Forward Send Fill_List
40419>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "€š¦¨á"
40420>>>>>>>>>>>>>        Send Add_Table_Value  "2"  "é¢ž©ž"
40421>>>>>>>>>>>>>        Send Add_Table_Value  "3"  "€ŠŠŽ"
40422>>>>>>>>>>>>>    End_Procedure    // Fill_List
40423>>>>>>>>>>>>>    //DDB-ValidationCustomStart
40423>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
40423>>>>>>>>>>>>>End_Object   // Ptyppar_Ptyppar_Is_What_VT
40424>>>>>>>>>>>>>
40424>>>>>>>>>>>>>Object Ptyppar_Ptyppar_Module_VT  is a CodeValidationTable
40426>>>>>>>>>>>>>    Set Type_Value        To "MODULE"
40427>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
40428>>>>>>>>>>>>>    //DDB-ValidationCustomStart
40428>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
40428>>>>>>>>>>>>>End_Object   // Ptyppar_Ptyppar_Module_VT
40429>>>>>>>>>>>>>
40429>>>>>>>>>>>>>Object Ptyppar_Ti_Typonei_Pms_VT1  is a DescriptionValidationTable
40431>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
40432>>>>>>>>>>>>>
40432>>>>>>>>>>>>>    Procedure Fill_List
40434>>>>>>>>>>>>>        Forward Send Fill_List
40436>>>>>>>>>>>>>        Send Add_Table_Value  ""  "¦©æ«ž«œª ¡˜  €¥åœª"
40437>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "¦©æ«ž«œª"
40438>>>>>>>>>>>>>        Send Add_Table_Value  "2"  "€¥åœª"
40439>>>>>>>>>>>>>    End_Procedure    // Fill_List
40440>>>>>>>>>>>>>    //DDB-ValidationCustomStart
40440>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
40440>>>>>>>>>>>>>End_Object   // Ptyppar_Ti_Typonei_Pms_VT1
40441>>>>>>>>>>>>>//DDB-ValidationEnd
40441>>>>>>>>>>>>>//DDB-SelectionStart
40441>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl012  sl012.SL
40441>>>>>>>>>>>>>Register_Object sl012
40441>>>>>>>>>>>>>//DDB-SelectionEnd
40441>>>>>>>>>>>>>
40441>>>>>>>>>>>>>Class Ptyppar_DataDictionary  is a DataDictionary_Sec
40442>>>>>>>>>>>>>
40442>>>>>>>>>>>>>    Procedure Construct_Object
40443>>>>>>>>>>>>>        Forward Send Construct_Object
40445>>>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
40446>>>>>>>>>>>>>        Property Integer piOldCtypkin       Public 0
40447>>>>>>>>>>>>>        Property Integer piOldWtypkin       Public 0
40448>>>>>>>>>>>>>    End_Procedure
40449>>>>>>>>>>>>>
40449>>>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
40450>>>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
40452>>>>>>>>>>>>>        Set piOldCtypkin to Ctypkin.Ctypkin_Code
40453>>>>>>>>>>>>>        Set piOldWtypkin to Wtypkin.Wtypkin_Code
40454>>>>>>>>>>>>>    End_Procedure   // New_Current_Record
40455>>>>>>>>>>>>>
40455>>>>>>>>>>>>>    Procedure OnConstrain
40456>>>>>>>>>>>>>        If (piMustNotConstrain(Self)=0) Begin
40458>>>>>>>>>>>>>            Constrain Ptyppar.Company_Code  eq SysCurXR.Company_Code
40460>>>>>>>>>>>>>            Constrain Ptyppar.Branch_Code   eq SysCurXR.Branch_Code
40462>>>>>>>>>>>>>        End
40462>>>>>>>>>>>>>>
40462>>>>>>>>>>>>>    End_Procedure
40463>>>>>>>>>>>>>
40463>>>>>>>>>>>>>    Procedure Clear_Main_File
40464>>>>>>>>>>>>>        Forward Send Clear_Main_File
40466>>>>>>>>>>>>>        Set piOldCtypkin to 0
40467>>>>>>>>>>>>>        Set piOldWtypkin to 0
40468>>>>>>>>>>>>>    End_Procedure
40469>>>>>>>>>>>>>
40469>>>>>>>>>>>>>    Procedure Save_Main_File
40470>>>>>>>>>>>>>        Integer isAdmin iYes
40471>>>>>>>>>>>>>        String  sStr
40471>>>>>>>>>>>>>        Get fig_Is_Admin to isAdmin
40472>>>>>>>>>>>>>
40472>>>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
40474>>>>>>>>>>>>>            If Ptyppar.Recnum Eq 0 Procedure_Return
40477>>>>>>>>>>>>>        End
40477>>>>>>>>>>>>>>
40477>>>>>>>>>>>>>        If (Operation_Origin=Self) Begin
40479>>>>>>>>>>>>>            If ((piOldCtypkin(Self)<>0) And (piOldCtypkin(Self)<>Ctypkin.Ctypkin_Code)) Begin
40481>>>>>>>>>>>>>                If (Not(isAdmin)) Error 1001 'ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ¡å¤ž©žª §œ¢á«ž'
40484>>>>>>>>>>>>>                Else Begin
40485>>>>>>>>>>>>>                    Move '' to sStr
40486>>>>>>>>>>>>>                    Append sStr '€¤ ˜¢¢á¥œ«œ ¡å¤ž©ž, £§¦¨œå ¤˜ œ§ž¨œá©œ  ã›ž ¡˜«˜®à¨ž£â¤˜ §˜¨˜©«˜« ¡á\n «˜ ¦§¦å˜ â®¦¬¤ ­« ˜®«œå £œ « ª §˜¢ âª ¡ ¤ã©œ ª §¦¬ «é¨˜ ˜¢¢áœ«œ\n„å©«œ ™â™˜ ¦  §àª Ÿâ¢œ«œ ¤˜ ©¬¤œ®å©à ?'
40487>>>>>>>>>>>>>                    Get YesNo_Box sStr to iYes
40488>>>>>>>>>>>>>                    If (iYes=MBR_NO) Error 1000 '€¡¬¨éŸž¡œ ž › ˜› ¡˜©å˜ ˜¢¢˜šãª ˜§¦ «¦¤ ®¨ã©«ž'
40491>>>>>>>>>>>>>                End
40491>>>>>>>>>>>>>>
40491>>>>>>>>>>>>>            End // If ((piOldCtypkin(Self)<>0) And (piOldCtypkin(Self)<>Ctypkin.Ctypkin_Code))
40491>>>>>>>>>>>>>>
40491>>>>>>>>>>>>>            If ((piOldWtypkin(Self)<>0) And (piOldWtypkin(Self)<>Wtypkin.Wtypkin_Code)) Begin
40493>>>>>>>>>>>>>                If (Not(isAdmin)) Error 1002 'ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ¡å¤ž©žª ˜§¦Ÿã¡žª'
40496>>>>>>>>>>>>>                Else Begin
40497>>>>>>>>>>>>>                    Move '' to sStr
40498>>>>>>>>>>>>>                    Append sStr '€¤ ˜¢¢á¥œ«œ ¡å¤ž©ž, £§¦¨œå ¤˜ œ§ž¨œá©œ  ã›ž ¡˜«˜®à¨ž£â¤˜ §˜¨˜©«˜« ¡á\n «˜ ¦§¦å˜ â®¦¬¤ ­« ˜®«œå £œ « ª §˜¢ âª ¡ ¤ã©œ ª §¦¬ «é¨˜ ˜¢¢áœ«œ\n„å©«œ ™â™˜ ¦  §àª Ÿâ¢œ«œ ¤˜ ©¬¤œ®å©à ?'
40499>>>>>>>>>>>>>                    Get YesNo_Box sStr to iYes
40500>>>>>>>>>>>>>                    If (iYes=MBR_NO) Error 1000 '€¡¬¨éŸž¡œ ž › ˜› ¡˜©å˜ ˜¢¢˜šãª ˜§¦ «¦¤ ®¨ã©«ž'
40503>>>>>>>>>>>>>                End
40503>>>>>>>>>>>>>>
40503>>>>>>>>>>>>>            End // ((piOldWtypkin(Self)<>0) And (piOldWtypkin(Self)<>Wtypkin.Wtypkin_Code))
40503>>>>>>>>>>>>>>
40503>>>>>>>>>>>>>        End // If (Operation_Origin=Self)
40503>>>>>>>>>>>>>>
40503>>>>>>>>>>>>>        Forward Send Save_Main_File
40505>>>>>>>>>>>>>    End_Procedure // Save_Main_File
40506>>>>>>>>>>>>>
40506>>>>>>>>>>>>>
40506>>>>>>>>>>>>>    Procedure Update
40507>>>>>>>>>>>>>        Forward Send Update
40509>>>>>>>>>>>>>        // Insert Code Here
40509>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to Ptyppar.Company_Code
40510>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Ptyppar.Branch_Code
40511>>>>>>>>>>>>>//        Move SysCurXR.Year_Year     to Ptyppar.Year_Year
40511>>>>>>>>>>>>>//        Move SysCurXR.Year_Recr     to Ptyppar.Year_Recr
40511>>>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code   to Ptyppar.Ctypkin_Code
40512>>>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code   to Ptyppar.Wtypkin_Code
40513>>>>>>>>>>>>>    End_Procedure   // Update
40514>>>>>>>>>>>>>
40514>>>>>>>>>>>>>    Procedure Creating
40515>>>>>>>>>>>>>        Forward Send Creating
40517>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Ptyppar.Ptyppar_Rec0)))))) to Ptyppar.Ptyppar_Recr
40518>>>>>>>>>>>>>    End_Procedure   // Creating
40519>>>>>>>>>>>>>
40519>>>>>>>>>>>>>
40519>>>>>>>>>>>>>    // Define_Fields:
40519>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
40519>>>>>>>>>>>>>    Procedure Define_Fields
40520>>>>>>>>>>>>>        Forward Send Define_Fields
40522>>>>>>>>>>>>>        //DDB-Generated-Code-Location
40522>>>>>>>>>>>>>        //DDB-DefineFieldStart
40522>>>>>>>>>>>>>
40522>>>>>>>>>>>>>        Set Main_File            To Ptyppar.File_Number
40523>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
40524>>>>>>>>>>>>>
40524>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
40525>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
40526>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
40527>>>>>>>>>>>>>
40527>>>>>>>>>>>>>        // Child (Client) file structure................
40527>>>>>>>>>>>>>        Send Add_Client_File  Particle.File_Number
40528>>>>>>>>>>>>>        Send Add_Client_File  Pseira.File_Number
40529>>>>>>>>>>>>>        Send Add_Client_File  Ptypmet.File_Number
40530>>>>>>>>>>>>>        Send Add_Client_File  Ptypparh.File_Number
40531>>>>>>>>>>>>>
40531>>>>>>>>>>>>>        // Parent (Server) file structure...............
40531>>>>>>>>>>>>>        Send Add_Server_File  Ctypkin.File_Number
40532>>>>>>>>>>>>>        Send Add_Server_File  Wtypkin.File_Number
40533>>>>>>>>>>>>>
40533>>>>>>>>>>>>>        // External (System) file structure.............
40533>>>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
40534>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
40535>>>>>>>>>>>>>
40535>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Ptyppar_Rec0  To Ptyppar.Ptyppar_Rec0
40538>>>>>>>>>>>>>
40538>>>>>>>>>>>>>        // Field-based properties.......................
40538>>>>>>>>>>>>>
40538>>>>>>>>>>>>>        // Ptyppar.Company_Code
40538>>>>>>>>>>>>>
40538>>>>>>>>>>>>>        // Ptyppar.Branch_Code
40538>>>>>>>>>>>>>
40538>>>>>>>>>>>>>        // Ptyppar.Year_Year
40538>>>>>>>>>>>>>
40538>>>>>>>>>>>>>        // Ptyppar.Ctypkin_Code
40538>>>>>>>>>>>>>
40538>>>>>>>>>>>>>        // Ptyppar.Wtypkin_Code
40538>>>>>>>>>>>>>
40538>>>>>>>>>>>>>        // Ptyppar.Year_Recr
40538>>>>>>>>>>>>>
40538>>>>>>>>>>>>>        // Ptyppar.Ctypkin_Recr
40538>>>>>>>>>>>>>
40538>>>>>>>>>>>>>        // Ptyppar.Wtypkin_Recr
40538>>>>>>>>>>>>>
40538>>>>>>>>>>>>>        // Ptyppar.Ptyppar_Code
40538>>>>>>>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Code To DD_AUTOFIND
40539>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Ptyppar.Ptyppar_Code To (sl012(Self))
40540>>>>>>>>>>>>>        Set Key_Field_State        Field Ptyppar.Ptyppar_Code To TRUE
40541>>>>>>>>>>>>>
40541>>>>>>>>>>>>>        // Ptyppar.Ptyppar_Rec0
40541>>>>>>>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Rec0 To DD_AUTOFIND
40542>>>>>>>>>>>>>
40542>>>>>>>>>>>>>        // Ptyppar.Ptyppar_Descr
40542>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Ptyppar.Ptyppar_Descr To (sl012(Self))
40543>>>>>>>>>>>>>
40543>>>>>>>>>>>>>        // Ptyppar.Ptyppar_Recr
40543>>>>>>>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Recr To DD_AUTOFIND   
40544>>>>>>>>>>>>>
40544>>>>>>>>>>>>>        // Ptyppar.Ptyppar_Is_What
40544>>>>>>>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ptyppar_Is_What To (Ptyppar_Ptyppar_Is_What_VT(Self))
40545>>>>>>>>>>>>>
40545>>>>>>>>>>>>>        // Ptyppar.Ptyppar_Module
40545>>>>>>>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ptyppar_Module To (Ptyppar_Ptyppar_Module_VT(Self))
40546>>>>>>>>>>>>>
40546>>>>>>>>>>>>>        // Ptyppar.Ptyppar_Abrev
40546>>>>>>>>>>>>>
40546>>>>>>>>>>>>>        // Ptyppar.Ftiaxnei_Tpay
40546>>>>>>>>>>>>>        Set Field_Class_Name       Field Ptyppar.Ftiaxnei_Tpay To "dbCheckBoxsub"
40547>>>>>>>>>>>>>
40547>>>>>>>>>>>>>        // Ptyppar.Ti_Typonei_Pms
40547>>>>>>>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ti_Typonei_Pms To (Ptyppar_Ti_Typonei_Pms_VT1(Self))
40548>>>>>>>>>>>>>
40548>>>>>>>>>>>>>        // Ptyppar.Einai_Paroxh_Yp
40548>>>>>>>>>>>>>        Set Field_Checkbox_Values  Field Ptyppar.Einai_Paroxh_Yp To "1"  "0"
40549>>>>>>>>>>>>>        Set Field_Class_Name       Field Ptyppar.Einai_Paroxh_Yp To "dbCheckBoxsub"
40550>>>>>>>>>>>>>
40550>>>>>>>>>>>>>        // Ptyppar.Gtypkin_Code
40550>>>>>>>>>>>>>
40550>>>>>>>>>>>>>        // Ptyppar.Sysxet_Ptyppar
40550>>>>>>>>>>>>>
40550>>>>>>>>>>>>>        // Ptyppar.Sysx_Ptyp_Recr
40550>>>>>>>>>>>>>
40550>>>>>>>>>>>>>        // Ptyppar.Check_Posa_Plaf
40550>>>>>>>>>>>>>
40550>>>>>>>>>>>>>        // Ptyppar.Singular
40550>>>>>>>>>>>>>
40550>>>>>>>>>>>>>        // Ptyppar.Sub
40550>>>>>>>>>>>>>
40550>>>>>>>>>>>>>        // Ptyppar.Constrain
40550>>>>>>>>>>>>>
40550>>>>>>>>>>>>>        // Ptyppar.Label
40550>>>>>>>>>>>>>
40550>>>>>>>>>>>>>        // Ptyppar.Label1
40550>>>>>>>>>>>>>
40550>>>>>>>>>>>>>        //DDB-DefineFieldEnd
40550>>>>>>>>>>>>>    End_Procedure    // Define_Fields
40551>>>>>>>>>>>>>
40551>>>>>>>>>>>>>    // Field_Defaults:
40551>>>>>>>>>>>>>    // This procedure is used to establish default field values.
40551>>>>>>>>>>>>>
40551>>>>>>>>>>>>>    Procedure Field_Defaults
40552>>>>>>>>>>>>>        Forward Send Field_Defaults
40554>>>>>>>>>>>>>        //DDB-Generated-Code-Location
40554>>>>>>>>>>>>>        //DDB-FieldDefaultStart
40554>>>>>>>>>>>>>        Set Field_Changed_Value   Field Ptyppar.Ftiaxnei_Tpay To "1"
40555>>>>>>>>>>>>>        Set Field_Changed_Value   Field Ptyppar.Einai_Paroxh_Yp To 0
40556>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
40556>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
40557>>>>>>>>>>>>>
40557>>>>>>>>>>>>>End_Class    // Ptyppar_DataDictionary
40558>>>>>>>>>>>>>//DDB-Selection-pkg-Start
40558>>>>>>>>>>>>>
40558>>>>>>>>>>>>>Use sl012.SL         // sl012
INCLUDING FILE: SL012.SL
40558>>>>>>>>>>>>>>>//AB/ Project sl012 : Ptyppar
40558>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
40558>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl012 : Ptyppar"
40558>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl012.SL"
40558>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
40558>>>>>>>>>>>>>>>
40558>>>>>>>>>>>>>>>// Project Object Structure
40558>>>>>>>>>>>>>>>//   sl012 is a dbModalPanelSub
40558>>>>>>>>>>>>>>>//     Ctypkin_DD is a DataDictionary
40558>>>>>>>>>>>>>>>//     Wtypkin_DD is a DataDictionary
40558>>>>>>>>>>>>>>>//     Ptyppar_DD is a DataDictionary
40558>>>>>>>>>>>>>>>//     oSelList is a dbListSub
40558>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
40558>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
40558>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
40558>>>>>>>>>>>>>>>
40558>>>>>>>>>>>>>>>// Register all objects
40558>>>>>>>>>>>>>>>Register_Object Ctypkin_DD
40558>>>>>>>>>>>>>>>Register_Object oCancel_bn
40558>>>>>>>>>>>>>>>Register_Object oOK_bn
40558>>>>>>>>>>>>>>>Register_Object oSearch_bn
40558>>>>>>>>>>>>>>>Register_Object oSelList
40558>>>>>>>>>>>>>>>Register_Object Ptyppar_DD
40558>>>>>>>>>>>>>>>Register_Object sl012
40558>>>>>>>>>>>>>>>Register_Object Wtypkin_DD
40558>>>>>>>>>>>>>>>
40558>>>>>>>>>>>>>>>
40558>>>>>>>>>>>>>>>//AB-IgnoreStart
40558>>>>>>>>>>>>>>>
40558>>>>>>>>>>>>>>>Use DFAllEnt.pkg
40558>>>>>>>>>>>>>>>Use dbList.Sub
40558>>>>>>>>>>>>>>>Use Button.Sub
40558>>>>>>>>>>>>>>>
40558>>>>>>>>>>>>>>>
40558>>>>>>>>>>>>>>>Use CTYPKIN.DD
40558>>>>>>>>>>>>>>>Use WTYPKIN.DD
40558>>>>>>>>>>>>>>>Use PTYPPAR.DD
40558>>>>>>>>>>>>>>>
40558>>>>>>>>>>>>>>>//AB-IgnoreEnd
40558>>>>>>>>>>>>>>>
40558>>>>>>>>>>>>>>>Object sl012 is a dbModalPanelSub
40560>>>>>>>>>>>>>>>
40560>>>>>>>>>>>>>>>    //AB-StoreTopStart
40560>>>>>>>>>>>>>>>    Property String psModule Public ''
40562>>>>>>>>>>>>>>>    Property integer pifromclient Public 0
40564>>>>>>>>>>>>>>>    
40564>>>>>>>>>>>>>>>    //AB-StoreTopEnd
40564>>>>>>>>>>>>>>>
40564>>>>>>>>>>>>>>>    Set Label to "’ç§¦  §˜¨˜©«˜« ¡é¤"
40565>>>>>>>>>>>>>>>    Set Size to 203 490
40566>>>>>>>>>>>>>>>    Set Location to 4 4
40567>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
40568>>>>>>>>>>>>>>>    Set Modal_State to FALSE
40569>>>>>>>>>>>>>>>
40569>>>>>>>>>>>>>>>    //AB-DDOStart
40569>>>>>>>>>>>>>>>
40569>>>>>>>>>>>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
40571>>>>>>>>>>>>>>>    End_Object    // Ctypkin_DD
40572>>>>>>>>>>>>>>>
40572>>>>>>>>>>>>>>>    Object Wtypkin_DD is a Wtypkin_DataDictionary
40574>>>>>>>>>>>>>>>    End_Object    // Wtypkin_DD
40575>>>>>>>>>>>>>>>
40575>>>>>>>>>>>>>>>    Object Ptyppar_DD is a Ptyppar_DataDictionary
40577>>>>>>>>>>>>>>>        Set DDO_Server to (Ctypkin_DD(self))
40578>>>>>>>>>>>>>>>        Set DDO_Server to (Wtypkin_DD(self))
40579>>>>>>>>>>>>>>>
40579>>>>>>>>>>>>>>>        //AB-StoreStart
40579>>>>>>>>>>>>>>>        
40579>>>>>>>>>>>>>>>        Procedure OnConstrain
40581>>>>>>>>>>>>>>>            Forward Send OnConstrain
40583>>>>>>>>>>>>>>>            If (psModule(Self)<>'') Begin
40585>>>>>>>>>>>>>>>                Constrain Ptyppar.Ptyppar_Module eq (psModule(Self))
40587>>>>>>>>>>>>>>>            End
40587>>>>>>>>>>>>>>>>
40587>>>>>>>>>>>>>>>            If (pifromclient(self)=1) Begin
40589>>>>>>>>>>>>>>>                Constrain Ptyppar.constrain eq '1'
40591>>>>>>>>>>>>>>>            End
40591>>>>>>>>>>>>>>>>
40591>>>>>>>>>>>>>>>        End_Procedure
40592>>>>>>>>>>>>>>>        
40592>>>>>>>>>>>>>>>        
40592>>>>>>>>>>>>>>>        
40592>>>>>>>>>>>>>>>        
40592>>>>>>>>>>>>>>>        //AB-StoreEnd
40592>>>>>>>>>>>>>>>
40592>>>>>>>>>>>>>>>    End_Object    // Ptyppar_DD
40593>>>>>>>>>>>>>>>
40593>>>>>>>>>>>>>>>    Set Main_DD to (Ptyppar_DD(self))
40594>>>>>>>>>>>>>>>    Set Server to (Ptyppar_DD(self))
40595>>>>>>>>>>>>>>>
40595>>>>>>>>>>>>>>>    //AB-DDOEnd
40595>>>>>>>>>>>>>>>
40595>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
40597>>>>>>>>>>>>>>>        Set Main_File to Ptyppar.File_Number
40598>>>>>>>>>>>>>>>        Set Size to 161 474
40599>>>>>>>>>>>>>>>        Set Location to 6 6
40600>>>>>>>>>>>>>>>
40600>>>>>>>>>>>>>>>        Begin_Row
40603>>>>>>>>>>>>>>>            Entry_Item Ptyppar.Ptyppar_code
40604>>>>>>>>>>>>>>>            Entry_Item Ptyppar.Ptyppar_descr
40605>>>>>>>>>>>>>>>            Entry_Item Ctypkin.Ctypkin_descr
40606>>>>>>>>>>>>>>>            Entry_Item Wtypkin.Wtypkin_descr
40607>>>>>>>>>>>>>>>        End_Row
40612>>>>>>>>>>>>>>>
40612>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 77
40613>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à›. ˜¨˜©«˜« ¡¦ç"
40614>>>>>>>>>>>>>>>        
40614>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 125
40615>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
40616>>>>>>>>>>>>>>>        
40616>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 137
40617>>>>>>>>>>>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž"
40618>>>>>>>>>>>>>>>        
40618>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 129
40619>>>>>>>>>>>>>>>        Set Header_Label  item 3 to "‰å¤ž©ž €§¦Ÿã¡žª"
40620>>>>>>>>>>>>>>>        
40620>>>>>>>>>>>>>>>
40620>>>>>>>>>>>>>>>        //AB-StoreStart
40620>>>>>>>>>>>>>>>        
40620>>>>>>>>>>>>>>>        Procedure Activate
40622>>>>>>>>>>>>>>>            Forward Send Activate
40624>>>>>>>>>>>>>>>            Send Rebuild_Constraints to Ptyppar_DD
40625>>>>>>>>>>>>>>>            Send Beginning_Of_Data to oSelList True
40626>>>>>>>>>>>>>>>        End_Procedure
40627>>>>>>>>>>>>>>>        
40627>>>>>>>>>>>>>>>        //AB-StoreEnd
40627>>>>>>>>>>>>>>>
40627>>>>>>>>>>>>>>>    End_Object    // oSelList
40628>>>>>>>>>>>>>>>
40628>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
40630>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
40631>>>>>>>>>>>>>>>        Set Location to 171 323
40632>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
40633>>>>>>>>>>>>>>>
40633>>>>>>>>>>>>>>>        //AB-StoreStart
40633>>>>>>>>>>>>>>>        Procedure OnClick
40635>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
40636>>>>>>>>>>>>>>>        End_Procedure
40637>>>>>>>>>>>>>>>        //AB-StoreEnd
40637>>>>>>>>>>>>>>>
40637>>>>>>>>>>>>>>>    End_Object    // oOK_bn
40638>>>>>>>>>>>>>>>
40638>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
40640>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
40641>>>>>>>>>>>>>>>        Set Location to 171 377
40642>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
40643>>>>>>>>>>>>>>>
40643>>>>>>>>>>>>>>>        //AB-StoreStart
40643>>>>>>>>>>>>>>>        Procedure OnClick
40645>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
40646>>>>>>>>>>>>>>>        End_Procedure
40647>>>>>>>>>>>>>>>        //AB-StoreEnd
40647>>>>>>>>>>>>>>>
40647>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
40648>>>>>>>>>>>>>>>
40648>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
40650>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
40651>>>>>>>>>>>>>>>        Set Location to 171 433
40652>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
40653>>>>>>>>>>>>>>>
40653>>>>>>>>>>>>>>>        //AB-StoreStart
40653>>>>>>>>>>>>>>>        Procedure OnClick
40655>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
40656>>>>>>>>>>>>>>>        End_Procedure
40657>>>>>>>>>>>>>>>        //AB-StoreEnd
40657>>>>>>>>>>>>>>>
40657>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
40658>>>>>>>>>>>>>>>
40658>>>>>>>>>>>>>>>
40658>>>>>>>>>>>>>>>    //AB-StoreStart
40658>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
40659>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
40660>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
40661>>>>>>>>>>>>>>>    
40661>>>>>>>>>>>>>>>    
40661>>>>>>>>>>>>>>>    //AB-StoreEnd
40661>>>>>>>>>>>>>>>
40661>>>>>>>>>>>>>>>End_Object    // sl012
40662>>>>>>>>>>>>>>>
40662>>>>>>>>>>>>>>>//AB/ End_Object    // prj
40662>>>>>>>>>>>>>
40662>>>>>>>>>>>>>//DDB-Selection-pkg-End
40662>>>>>>>>>>>>>//DDB-FileEnd
40662>>>>>>>>>>>    Use PSEIRA.DD
INCLUDING FILE: PSEIRA.DD
40662>>>>>>>>>>>>>//DDB-FileStart
40662>>>>>>>>>>>>>//DDB-HeaderStart
40662>>>>>>>>>>>>>
40662>>>>>>>>>>>>>// File Name : PSEIRA.DD
40662>>>>>>>>>>>>>// Class Name: Pseira_DataDictionary
40662>>>>>>>>>>>>>// Revision  : 34
40662>>>>>>>>>>>>>// Version   : 2
40662>>>>>>>>>>>>>
40662>>>>>>>>>>>>>Use  Windows           // Basic Definitions
40662>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
40662>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
40662>>>>>>>>>>>>>
40662>>>>>>>>>>>>>Open Pseira
40664>>>>>>>>>>>>>Open Ptyppar
40666>>>>>>>>>>>>>Open Sysrecp
40668>>>>>>>>>>>>>Open Syscurxr
40670>>>>>>>>>>>>>
40670>>>>>>>>>>>>>//DDB-HeaderEnd
40670>>>>>>>>>>>>>//DDB-SelectionStart
40670>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl013  sl013.SL
40670>>>>>>>>>>>>>Register_Object sl013
40670>>>>>>>>>>>>>//DDB-SelectionEnd
40670>>>>>>>>>>>>>
40670>>>>>>>>>>>>>Class Pseira_DataDictionary  is a DataDictionary
40671>>>>>>>>>>>>>
40671>>>>>>>>>>>>>    Procedure Save_Main_File
40672>>>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
40674>>>>>>>>>>>>>            If Pseira.Recnum Eq 0 Procedure_Return
40677>>>>>>>>>>>>>        End
40677>>>>>>>>>>>>>>
40677>>>>>>>>>>>>>        Forward Send Save_Main_File
40679>>>>>>>>>>>>>    End_Procedure
40680>>>>>>>>>>>>>
40680>>>>>>>>>>>>>    Procedure Update
40681>>>>>>>>>>>>>        Forward Send Update
40683>>>>>>>>>>>>>        // Insert Code Here
40683>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to Pseira.Company_Code
40684>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Pseira.Branch_Code
40685>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to Pseira.Year_Year
40686>>>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code   to Pseira.Ctypkin_Code
40687>>>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code   to Pseira.Wtypkin_Code
40688>>>>>>>>>>>>>        Move Ptyppar.Ptyppar_Code   to Pseira.Ptyppar_Code
40689>>>>>>>>>>>>>    End_Procedure   // Update
40690>>>>>>>>>>>>>
40690>>>>>>>>>>>>>
40690>>>>>>>>>>>>>     Procedure Creating
40691>>>>>>>>>>>>>        Forward Send Creating
40693>>>>>>>>>>>>>        // Insert Code Here
40693>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Pseira.Pseira_Rec0)))))) to Pseira.Pseira_Recr
40694>>>>>>>>>>>>>    End_Procedure   // Creating
40695>>>>>>>>>>>>>
40695>>>>>>>>>>>>>
40695>>>>>>>>>>>>>    // Define_Fields:
40695>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
40695>>>>>>>>>>>>>
40695>>>>>>>>>>>>>    Procedure Define_Fields
40696>>>>>>>>>>>>>        Forward Send Define_Fields
40698>>>>>>>>>>>>>        //DDB-Generated-Code-Location
40698>>>>>>>>>>>>>        //DDB-DefineFieldStart
40698>>>>>>>>>>>>>
40698>>>>>>>>>>>>>        Set Main_File            To Pseira.File_Number
40699>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
40700>>>>>>>>>>>>>
40700>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
40701>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
40702>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
40703>>>>>>>>>>>>>
40703>>>>>>>>>>>>>        // Parent (Server) file structure...............
40703>>>>>>>>>>>>>        Send Add_Server_File  Ptyppar.File_Number
40704>>>>>>>>>>>>>
40704>>>>>>>>>>>>>        // External (System) file structure.............
40704>>>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
40705>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
40706>>>>>>>>>>>>>
40706>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Pseira_Rec0  To Pseira.Pseira_Rec0
40709>>>>>>>>>>>>>
40709>>>>>>>>>>>>>        // Field-based properties.......................
40709>>>>>>>>>>>>>
40709>>>>>>>>>>>>>        // Pseira.Company_Code
40709>>>>>>>>>>>>>
40709>>>>>>>>>>>>>        // Pseira.Branch_Code
40709>>>>>>>>>>>>>
40709>>>>>>>>>>>>>        // Pseira.Year_Year
40709>>>>>>>>>>>>>
40709>>>>>>>>>>>>>        // Pseira.Ctypkin_Code
40709>>>>>>>>>>>>>
40709>>>>>>>>>>>>>        // Pseira.Wtypkin_Code
40709>>>>>>>>>>>>>
40709>>>>>>>>>>>>>        // Pseira.Ptyppar_Code
40709>>>>>>>>>>>>>
40709>>>>>>>>>>>>>        // Pseira.Ptyppar_Recr
40709>>>>>>>>>>>>>
40709>>>>>>>>>>>>>        // Pseira.Pseira_Seira
40709>>>>>>>>>>>>>        Set Field_Options          Field Pseira.Pseira_Seira To DD_AUTOFIND   
40710>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Pseira.Pseira_Seira To (sl013(Self))
40711>>>>>>>>>>>>>
40711>>>>>>>>>>>>>        // Pseira.Pseira_Rec0
40711>>>>>>>>>>>>>        Set Field_Options          Field Pseira.Pseira_Rec0 To DD_AUTOFIND   
40712>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Pseira.Pseira_Rec0 To (sl013(Self))
40713>>>>>>>>>>>>>
40713>>>>>>>>>>>>>        // Pseira.Pseira_Recr
40713>>>>>>>>>>>>>        Set Field_Options          Field Pseira.Pseira_Recr To DD_AUTOFIND   
40714>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Pseira.Pseira_Recr To (sl013(Self))
40715>>>>>>>>>>>>>
40715>>>>>>>>>>>>>        // Pseira.Pseira_Printer
40715>>>>>>>>>>>>>
40715>>>>>>>>>>>>>        // Pseira.Pseira_Form
40715>>>>>>>>>>>>>
40715>>>>>>>>>>>>>        // Pseira.Pseira_Autonum
40715>>>>>>>>>>>>>
40715>>>>>>>>>>>>>        // Pseira.Autonum_Plus
40715>>>>>>>>>>>>>
40715>>>>>>>>>>>>>        // Pseira.Autonum_Minus
40715>>>>>>>>>>>>>
40715>>>>>>>>>>>>>        // Pseira.Auto_Plus_Last
40715>>>>>>>>>>>>>
40715>>>>>>>>>>>>>        //DDB-DefineFieldEnd
40715>>>>>>>>>>>>>    End_Procedure    // Define_Fields
40716>>>>>>>>>>>>>
40716>>>>>>>>>>>>>    // Field_Defaults:
40716>>>>>>>>>>>>>    // This procedure is used to establish default field values.
40716>>>>>>>>>>>>>
40716>>>>>>>>>>>>>    Procedure Field_Defaults
40717>>>>>>>>>>>>>        Forward Send Field_Defaults
40719>>>>>>>>>>>>>        //DDB-Generated-Code-Location
40719>>>>>>>>>>>>>        //DDB-FieldDefaultStart
40719>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
40719>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
40720>>>>>>>>>>>>>
40720>>>>>>>>>>>>>End_Class    // Pseira_DataDictionary
40721>>>>>>>>>>>>>//DDB-Selection-pkg-Start
40721>>>>>>>>>>>>>
40721>>>>>>>>>>>>>Use sl013.SL         // sl013
INCLUDING FILE: SL013.SL
40721>>>>>>>>>>>>>>>//AB/ Project sl013:SeiraP
40721>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
40721>>>>>>>>>>>>>>>//AB/         Set ProjectName to "sl013:SeiraP"
40721>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl013.SL"
40721>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
40721>>>>>>>>>>>>>>>
40721>>>>>>>>>>>>>>>// Project Object Structure
40721>>>>>>>>>>>>>>>//   sl013 is a dbModalPanelSub
40721>>>>>>>>>>>>>>>//     Ctypkin_DD is a DataDictionary
40721>>>>>>>>>>>>>>>//     Wtypkin_DD is a DataDictionary
40721>>>>>>>>>>>>>>>//     Ptyppar_DD is a DataDictionary
40721>>>>>>>>>>>>>>>//     Pseira_DD is a DataDictionary
40721>>>>>>>>>>>>>>>//     oSelList is a dbListSub
40721>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
40721>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
40721>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
40721>>>>>>>>>>>>>>>
40721>>>>>>>>>>>>>>>// Register all objects
40721>>>>>>>>>>>>>>>Register_Object Ctypkin_DD
40721>>>>>>>>>>>>>>>Register_Object oCancel_bn
40721>>>>>>>>>>>>>>>Register_Object oOK_bn
40721>>>>>>>>>>>>>>>Register_Object oSearch_bn
40721>>>>>>>>>>>>>>>Register_Object oSelList
40721>>>>>>>>>>>>>>>Register_Object Pseira_DD
40721>>>>>>>>>>>>>>>Register_Object Ptyppar_DD
40721>>>>>>>>>>>>>>>Register_Object sl013
40721>>>>>>>>>>>>>>>Register_Object Wtypkin_DD
40721>>>>>>>>>>>>>>>
40721>>>>>>>>>>>>>>>
40721>>>>>>>>>>>>>>>    //AB-IgnoreStart
40721>>>>>>>>>>>>>>>
40721>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
40721>>>>>>>>>>>>>>>    Use dbList.Sub
40721>>>>>>>>>>>>>>>    Use Button.Sub
40721>>>>>>>>>>>>>>>
40721>>>>>>>>>>>>>>>
40721>>>>>>>>>>>>>>>    Use CTYPKIN.DD
40721>>>>>>>>>>>>>>>    Use WTYPKIN.DD
40721>>>>>>>>>>>>>>>    Use PTYPPAR.DD
40721>>>>>>>>>>>>>>>    Use PSEIRA.DD
40721>>>>>>>>>>>>>>>    
40721>>>>>>>>>>>>>>>    //AB-IgnoreEnd
40721>>>>>>>>>>>>>>>
40721>>>>>>>>>>>>>>>    Object sl013 is a dbModalPanelSub
40723>>>>>>>>>>>>>>>
40723>>>>>>>>>>>>>>>        //AB-StoreTopStart
40723>>>>>>>>>>>>>>>        Property String FragmaPtyppar_Recr Public ''
40725>>>>>>>>>>>>>>>        
40725>>>>>>>>>>>>>>>        //AB-StoreTopEnd
40725>>>>>>>>>>>>>>>
40725>>>>>>>>>>>>>>>        Set Label to "‰˜«á¢¦š¦ª ‘œ ¨é¤"
40726>>>>>>>>>>>>>>>        Set Size to 148 214
40727>>>>>>>>>>>>>>>        Set Location to 1 7
40728>>>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
40729>>>>>>>>>>>>>>>        Set Modal_State to FALSE
40730>>>>>>>>>>>>>>>
40730>>>>>>>>>>>>>>>        //AB-DDOStart
40730>>>>>>>>>>>>>>>
40730>>>>>>>>>>>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
40732>>>>>>>>>>>>>>>        End_Object    // Ctypkin_DD
40733>>>>>>>>>>>>>>>
40733>>>>>>>>>>>>>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
40735>>>>>>>>>>>>>>>        End_Object    // Wtypkin_DD
40736>>>>>>>>>>>>>>>
40736>>>>>>>>>>>>>>>        Object Ptyppar_DD is a Ptyppar_DataDictionary
40738>>>>>>>>>>>>>>>            Set DDO_Server to (Ctypkin_DD(self))
40739>>>>>>>>>>>>>>>            Set DDO_Server to (Wtypkin_DD(self))
40740>>>>>>>>>>>>>>>        End_Object    // Ptyppar_DD
40741>>>>>>>>>>>>>>>
40741>>>>>>>>>>>>>>>        Object Pseira_DD is a Pseira_DataDictionary
40743>>>>>>>>>>>>>>>            Set DDO_Server to (Ptyppar_DD(self))
40744>>>>>>>>>>>>>>>
40744>>>>>>>>>>>>>>>            //AB-StoreStart
40744>>>>>>>>>>>>>>>            Procedure OnConstrain
40746>>>>>>>>>>>>>>>                String sID
40747>>>>>>>>>>>>>>>                Forward Send OnConstrain
40749>>>>>>>>>>>>>>>                Get FragmaPtyppar_Recr to sID
40750>>>>>>>>>>>>>>>                Move (trim(sID)) to sID
40751>>>>>>>>>>>>>>>                If (sID<>'') Constrain Pseira.Ptyppar_Recr eq sID
40755>>>>>>>>>>>>>>>            End_procedure
40756>>>>>>>>>>>>>>>            
40756>>>>>>>>>>>>>>>            //AB-StoreEnd
40756>>>>>>>>>>>>>>>
40756>>>>>>>>>>>>>>>        End_Object    // Pseira_DD
40757>>>>>>>>>>>>>>>
40757>>>>>>>>>>>>>>>        Set Main_DD to (Pseira_DD(self))
40758>>>>>>>>>>>>>>>        Set Server to (Pseira_DD(self))
40759>>>>>>>>>>>>>>>
40759>>>>>>>>>>>>>>>        //AB-DDOEnd
40759>>>>>>>>>>>>>>>
40759>>>>>>>>>>>>>>>        Object oSelList is a dbListSub
40761>>>>>>>>>>>>>>>            Set Main_File to Pseira.File_Number
40762>>>>>>>>>>>>>>>            Set Size to 105 197
40763>>>>>>>>>>>>>>>            Set Location to 6 6
40764>>>>>>>>>>>>>>>
40764>>>>>>>>>>>>>>>            Begin_Row
40767>>>>>>>>>>>>>>>                Entry_Item Pseira.Pseira_seira
40768>>>>>>>>>>>>>>>                Entry_Item Pseira.Pseira_printer
40769>>>>>>>>>>>>>>>                Entry_Item Pseira.Pseira_autonum
40770>>>>>>>>>>>>>>>            End_Row
40775>>>>>>>>>>>>>>>
40775>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 40
40776>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‘œ ¨á"
40777>>>>>>>>>>>>>>>            
40777>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 135
40778>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "„¡«¬§à«ãª"
40779>>>>>>>>>>>>>>>            
40779>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 16
40780>>>>>>>>>>>>>>>            Set Header_Label  item 2 to "Autonum"
40781>>>>>>>>>>>>>>>            Set Column_Checkbox_State  item 2 to True
40782>>>>>>>>>>>>>>>            
40782>>>>>>>>>>>>>>>
40782>>>>>>>>>>>>>>>            //AB-StoreStart
40782>>>>>>>>>>>>>>>                    
40782>>>>>>>>>>>>>>>            Property String StoreFragmaPtyppar_Recr Public ''
40784>>>>>>>>>>>>>>>            
40784>>>>>>>>>>>>>>>            Procedure Store_Defaults
40786>>>>>>>>>>>>>>>                   Forward Send Store_Defaults
40788>>>>>>>>>>>>>>>                   Set StoreFragmaPtyppar_Recr to (FragmaPtyppar_Recr(Self))
40789>>>>>>>>>>>>>>>            End_Procedure
40790>>>>>>>>>>>>>>>            
40790>>>>>>>>>>>>>>>            Procedure ReStore_Defaults
40792>>>>>>>>>>>>>>>                   Forward Send ReStore_Defaults
40794>>>>>>>>>>>>>>>                   Set FragmaPtyppar_Recr to (StoreFragmaPtyppar_Recr(Self))
40795>>>>>>>>>>>>>>>            End_Procedure
40796>>>>>>>>>>>>>>>            
40796>>>>>>>>>>>>>>>            Procedure Activating
40798>>>>>>>>>>>>>>>                Forward Send Activating
40800>>>>>>>>>>>>>>>                Send Rebuild_Constraints to (Pseira_DD(Self))
40801>>>>>>>>>>>>>>>            End_Procedure
40802>>>>>>>>>>>>>>>            
40802>>>>>>>>>>>>>>>            
40802>>>>>>>>>>>>>>>            //AB-StoreEnd
40802>>>>>>>>>>>>>>>
40802>>>>>>>>>>>>>>>        End_Object    // oSelList
40803>>>>>>>>>>>>>>>
40803>>>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
40805>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
40806>>>>>>>>>>>>>>>            Set Location to 114 42
40807>>>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
40808>>>>>>>>>>>>>>>
40808>>>>>>>>>>>>>>>            //AB-StoreStart
40808>>>>>>>>>>>>>>>            Procedure OnClick
40810>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
40811>>>>>>>>>>>>>>>            End_Procedure
40812>>>>>>>>>>>>>>>            //AB-StoreEnd
40812>>>>>>>>>>>>>>>
40812>>>>>>>>>>>>>>>        End_Object    // oOK_bn
40813>>>>>>>>>>>>>>>
40813>>>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
40815>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
40816>>>>>>>>>>>>>>>            Set Location to 114 98
40817>>>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
40818>>>>>>>>>>>>>>>
40818>>>>>>>>>>>>>>>            //AB-StoreStart
40818>>>>>>>>>>>>>>>            Procedure OnClick
40820>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
40821>>>>>>>>>>>>>>>            End_Procedure
40822>>>>>>>>>>>>>>>            //AB-StoreEnd
40822>>>>>>>>>>>>>>>
40822>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
40823>>>>>>>>>>>>>>>
40823>>>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
40825>>>>>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
40826>>>>>>>>>>>>>>>            Set Location to 114 153
40827>>>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
40828>>>>>>>>>>>>>>>
40828>>>>>>>>>>>>>>>            //AB-StoreStart
40828>>>>>>>>>>>>>>>            Procedure OnClick
40830>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
40831>>>>>>>>>>>>>>>            End_Procedure
40832>>>>>>>>>>>>>>>            //AB-StoreEnd
40832>>>>>>>>>>>>>>>
40832>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
40833>>>>>>>>>>>>>>>
40833>>>>>>>>>>>>>>>
40833>>>>>>>>>>>>>>>        //AB-StoreStart
40833>>>>>>>>>>>>>>>            
40833>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
40834>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
40835>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
40836>>>>>>>>>>>>>>>        
40836>>>>>>>>>>>>>>>        
40836>>>>>>>>>>>>>>>        
40836>>>>>>>>>>>>>>>        
40836>>>>>>>>>>>>>>>        
40836>>>>>>>>>>>>>>>        
40836>>>>>>>>>>>>>>>        
40836>>>>>>>>>>>>>>>        
40836>>>>>>>>>>>>>>>        //AB-StoreEnd
40836>>>>>>>>>>>>>>>
40836>>>>>>>>>>>>>>>    End_Object    // sl013
40837>>>>>>>>>>>>>>>
40837>>>>>>>>>>>>>>>//AB/     End_Object    // prj
40837>>>>>>>>>>>>>
40837>>>>>>>>>>>>>//DDB-Selection-pkg-End
40837>>>>>>>>>>>>>//DDB-FileEnd
40837>>>>>>>>>>>    Use NOMISMA.DD
INCLUDING FILE: NOMISMA.DD
40837>>>>>>>>>>>>>//DDB-FileStart
40837>>>>>>>>>>>>>//DDB-HeaderStart
40837>>>>>>>>>>>>>
40837>>>>>>>>>>>>>// File Name : NOMISMA.DD
40837>>>>>>>>>>>>>// Class Name: Nomisma_DataDictionary
40837>>>>>>>>>>>>>// Revision  : 52
40837>>>>>>>>>>>>>// Version   : 2
40837>>>>>>>>>>>>>
40837>>>>>>>>>>>>>Use  Windows           // Basic Definitions
40837>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
40837>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
40837>>>>>>>>>>>>>
40837>>>>>>>>>>>>>Open Nomisma
40839>>>>>>>>>>>>>Open Isotimia
INCLUDING FILE: ISOTIMIA.FD
40841>>>>>>>>>>>>>Open Particle
40843>>>>>>>>>>>>>
40843>>>>>>>>>>>>>//DDB-HeaderEnd
40843>>>>>>>>>>>>>//DDB-ValidationStart
40843>>>>>>>>>>>>>
40843>>>>>>>>>>>>>Register_Object Nomisma_Nomisma_Type_VT
40843>>>>>>>>>>>>>Register_Object Nomisma_Nomisma_Sign0_VT
40843>>>>>>>>>>>>>Register_Object Nomisma_Nomisma_Sign00_VT
40843>>>>>>>>>>>>>Register_Object Nomisma_Nomisma_Signr_VT
40843>>>>>>>>>>>>>
40843>>>>>>>>>>>>>Object Nomisma_Nomisma_Type_VT  is a DescriptionValidationTable
40845>>>>>>>>>>>>>
40845>>>>>>>>>>>>>    Procedure Fill_List
40847>>>>>>>>>>>>>        Forward Send Fill_List
40849>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "Book1"
40850>>>>>>>>>>>>>        Send Add_Table_Value  "2"  "Book2"
40851>>>>>>>>>>>>>        Send Add_Table_Value  "3"  "Reporting"
40852>>>>>>>>>>>>>        Send Add_Table_Value  "0"  "Other"
40853>>>>>>>>>>>>>    End_Procedure    // Fill_List
40854>>>>>>>>>>>>>    //DDB-ValidationCustomStart
40854>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
40854>>>>>>>>>>>>>End_Object   // Nomisma_Nomisma_Type_VT
40855>>>>>>>>>>>>>
40855>>>>>>>>>>>>>Object Nomisma_Nomisma_Sign0_VT  is a DescriptionValidationTable
40857>>>>>>>>>>>>>
40857>>>>>>>>>>>>>    Procedure Fill_List
40859>>>>>>>>>>>>>        Forward Send Fill_List
40861>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
40862>>>>>>>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
40863>>>>>>>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨œ¯ £¦"
40864>>>>>>>>>>>>>    End_Procedure    // Fill_List
40865>>>>>>>>>>>>>    //DDB-ValidationCustomStart
40865>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
40865>>>>>>>>>>>>>End_Object   // Nomisma_Nomisma_Sign0_VT
40866>>>>>>>>>>>>>
40866>>>>>>>>>>>>>Object Nomisma_Nomisma_Sign00_VT  is a DescriptionValidationTable
40868>>>>>>>>>>>>>
40868>>>>>>>>>>>>>    Procedure Fill_List
40870>>>>>>>>>>>>>        Forward Send Fill_List
40872>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
40873>>>>>>>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
40874>>>>>>>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨â¯ £¦"
40875>>>>>>>>>>>>>    End_Procedure    // Fill_List
40876>>>>>>>>>>>>>    //DDB-ValidationCustomStart
40876>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
40876>>>>>>>>>>>>>End_Object   // Nomisma_Nomisma_Sign00_VT
40877>>>>>>>>>>>>>
40877>>>>>>>>>>>>>Object Nomisma_Nomisma_Signr_VT  is a DescriptionValidationTable
40879>>>>>>>>>>>>>
40879>>>>>>>>>>>>>    Procedure Fill_List
40881>>>>>>>>>>>>>        Forward Send Fill_List
40883>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
40884>>>>>>>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
40885>>>>>>>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨â¯ £¦"
40886>>>>>>>>>>>>>    End_Procedure    // Fill_List
40887>>>>>>>>>>>>>    //DDB-ValidationCustomStart
40887>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
40887>>>>>>>>>>>>>End_Object   // Nomisma_Nomisma_Signr_VT
40888>>>>>>>>>>>>>//DDB-ValidationEnd
40888>>>>>>>>>>>>>//DDB-SelectionStart
40888>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl059  sl059.sl
40888>>>>>>>>>>>>>Register_Object sl059
40888>>>>>>>>>>>>>//DDB-SelectionEnd
40888>>>>>>>>>>>>>
40888>>>>>>>>>>>>>Class Nomisma_DataDictionary  is a DataDictionary_Sec
40889>>>>>>>>>>>>>
40889>>>>>>>>>>>>>    Procedure Construct_Object
40890>>>>>>>>>>>>>        Forward Send Construct_Object
40892>>>>>>>>>>>>>        Property String psOldCode Public ''
40893>>>>>>>>>>>>>    End_procedure
40894>>>>>>>>>>>>>
40894>>>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
40895>>>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
40897>>>>>>>>>>>>>        Set psOldCode to Nomisma.Nomisma_Code
40898>>>>>>>>>>>>>    End_Procedure   // New_Current_Record
40899>>>>>>>>>>>>>
40899>>>>>>>>>>>>>    Procedure Save_Main_File
40900>>>>>>>>>>>>>        If ((Operation_Origin<>Self) And;             (Nomisma.Recnum=0)) Procedure_Return
40903>>>>>>>>>>>>>        Forward Send Save_Main_File
40905>>>>>>>>>>>>>    End_Procedure   // Save_Main_File
40906>>>>>>>>>>>>>
40906>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
40907>>>>>>>>>>>>>        Local Integer iReturnVal 
40908>>>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
40910>>>>>>>>>>>>>        If (Not(iReturnVal)) ;            Begin
40912>>>>>>>>>>>>>                     If  Nomisma.nomisma_Code eq ''                 Move 6220 to iReturnVal
40915>>>>>>>>>>>>>                Else If (Nomisma.Nomisma_Code <>(psOldCode(Self)) And ;                         (psOldCode(Self)<>''))  Move 6030 to iReturnVal
40919>>>>>>>>>>>>>                if iReturnVal Send Operation_Not_Allowed iReturnVal
40922>>>>>>>>>>>>>            End
40922>>>>>>>>>>>>>>
40922>>>>>>>>>>>>>        Function_Return iReturnVal
40923>>>>>>>>>>>>>    End_Function   // Validate_Save
40924>>>>>>>>>>>>>
40924>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
40925>>>>>>>>>>>>>             if iError_num eq 6220 error 6220 "Œ¦£ ©£˜«˜ => ‰à› ¡æª ¡œ¤æª "
40928>>>>>>>>>>>>>        Else if iError_num eq 6030 error 6030 "„§ ¢â¥«œ ¤æ£ ©£˜ ˜§¦ «ž¤ ¢å©«˜ £œ (F4)\nž §˜«ã©«œ §¨é«˜ F5 ©«¦ ž›ž ¬§á¨®¦¤\nà©«œ ¤˜ ¡˜Ÿ˜¨å©œ  ž ˜¨® ¡ã «¦¬ « £ã\n§¨å¤ œ§ ¢â¥œ«œ á¢¢¦"
40932>>>>>>>>>>>>>        //Else if iError_num eq 6030 error 6030 "ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ©«¦ ¡à› ¡æ ¤¦£å©£˜«¦ª"
40932>>>>>>>>>>>>>        else Forward Send Operation_Not_Allowed  iError_Num
40935>>>>>>>>>>>>>    End_Procedure   // Operation_Not_Allowed
40936>>>>>>>>>>>>>
40936>>>>>>>>>>>>>    Procedure Update
40937>>>>>>>>>>>>>        Forward Send Update
40939>>>>>>>>>>>>>        // Insert Code Here
40939>>>>>>>>>>>>>        SYSDATE NOMISMA.LUP
40940>>>>>>>>>>>>>    End_Procedure   // Update
40941>>>>>>>>>>>>>
40941>>>>>>>>>>>>>    Procedure Creating
40942>>>>>>>>>>>>>        Forward Send Creating
40944>>>>>>>>>>>>>        // Insert Code Here
40944>>>>>>>>>>>>>        SYSDATE NOMISMA.FUP
40945>>>>>>>>>>>>>    End_Procedure   // Creating
40946>>>>>>>>>>>>>
40946>>>>>>>>>>>>>    // Define_Fields:
40946>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
40946>>>>>>>>>>>>>
40946>>>>>>>>>>>>>    Procedure Define_Fields
40947>>>>>>>>>>>>>        Forward Send Define_Fields
40949>>>>>>>>>>>>>        //DDB-Generated-Code-Location
40949>>>>>>>>>>>>>        //DDB-DefineFieldStart
40949>>>>>>>>>>>>>
40949>>>>>>>>>>>>>        Set Main_File            To Nomisma.File_Number
40950>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
40951>>>>>>>>>>>>>
40951>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
40952>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
40953>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
40954>>>>>>>>>>>>>
40954>>>>>>>>>>>>>        // Child (Client) file structure................
40954>>>>>>>>>>>>>        Send Add_Client_File  Isotimia.File_Number
40955>>>>>>>>>>>>>        Send Add_Client_File  Particle.File_Number
40956>>>>>>>>>>>>>
40956>>>>>>>>>>>>>        // Field-based properties.......................
40956>>>>>>>>>>>>>
40956>>>>>>>>>>>>>        // Nomisma.Nomisma_Code
40956>>>>>>>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Code To DD_AUTOFIND    DD_CAPSLOCK   
40957>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Code To (sl059(Self))
40958>>>>>>>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Code To TRUE
40959>>>>>>>>>>>>>
40959>>>>>>>>>>>>>        // Nomisma.Nomisma_Descr
40959>>>>>>>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Descr To DD_CAPSLOCK   
40960>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Descr To (sl059(Self))
40961>>>>>>>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Descr To TRUE
40962>>>>>>>>>>>>>
40962>>>>>>>>>>>>>        // Nomisma.Nomisma_Short
40962>>>>>>>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Short To DD_CAPSLOCK   
40963>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Short To (sl059(Self))
40964>>>>>>>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Short To TRUE
40965>>>>>>>>>>>>>
40965>>>>>>>>>>>>>        // Nomisma.Dekadika
40965>>>>>>>>>>>>>
40965>>>>>>>>>>>>>        // Nomisma.Fup
40965>>>>>>>>>>>>>
40965>>>>>>>>>>>>>        // Nomisma.Lup
40965>>>>>>>>>>>>>
40965>>>>>>>>>>>>>        // Nomisma.Euro_Zone
40965>>>>>>>>>>>>>
40965>>>>>>>>>>>>>        // Nomisma.Einai_Drx
40965>>>>>>>>>>>>>
40965>>>>>>>>>>>>>        // Nomisma.Einai_Euro
40965>>>>>>>>>>>>>
40965>>>>>>>>>>>>>        // Nomisma.Monades
40965>>>>>>>>>>>>>
40965>>>>>>>>>>>>>        // Nomisma.Kl_Isot_Euro
40965>>>>>>>>>>>>>
40965>>>>>>>>>>>>>        // Nomisma.Nomisma_Type
40965>>>>>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Type To (Nomisma_Nomisma_Type_VT(Self))
40966>>>>>>>>>>>>>
40966>>>>>>>>>>>>>        // Nomisma.Nomisma_Sign0
40966>>>>>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Sign0 To (Nomisma_Nomisma_Sign0_VT(Self))
40967>>>>>>>>>>>>>
40967>>>>>>>>>>>>>        // Nomisma.Nomisma_Sign00
40967>>>>>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Sign00 To (Nomisma_Nomisma_Sign00_VT(Self))
40968>>>>>>>>>>>>>
40968>>>>>>>>>>>>>        // Nomisma.Nomisma_Signr
40968>>>>>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Signr To (Nomisma_Nomisma_Signr_VT(Self))
40969>>>>>>>>>>>>>
40969>>>>>>>>>>>>>        //DDB-DefineFieldEnd
40969>>>>>>>>>>>>>    End_Procedure    // Define_Fields
40970>>>>>>>>>>>>>
40970>>>>>>>>>>>>>    // Field_Defaults:
40970>>>>>>>>>>>>>    // This procedure is used to establish default field values.
40970>>>>>>>>>>>>>
40970>>>>>>>>>>>>>    Procedure Field_Defaults
40971>>>>>>>>>>>>>        Forward Send Field_Defaults
40973>>>>>>>>>>>>>        //DDB-Generated-Code-Location
40973>>>>>>>>>>>>>        //DDB-FieldDefaultStart
40973>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
40973>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
40974>>>>>>>>>>>>>
40974>>>>>>>>>>>>>End_Class    // Nomisma_DataDictionary
40975>>>>>>>>>>>>>//DDB-Selection-pkg-Start
40975>>>>>>>>>>>>>
40975>>>>>>>>>>>>>Use sl059.sl         // sl059
INCLUDING FILE: SL059.SL
40975>>>>>>>>>>>>>>>//AB/ Project sl059
40975>>>>>>>>>>>>>>>//AB/     Object prj is a LOOKUP_Project
40975>>>>>>>>>>>>>>>//AB/         Set ProjectName to "sl059"
40975>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl059.SL"
40975>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
40975>>>>>>>>>>>>>>>
40975>>>>>>>>>>>>>>>    //AB-IgnoreStart
40975>>>>>>>>>>>>>>>
40975>>>>>>>>>>>>>>>
40975>>>>>>>>>>>>>>>
40975>>>>>>>>>>>>>>>
40975>>>>>>>>>>>>>>>    Use NOMISMA.DD
40975>>>>>>>>>>>>>>>
40975>>>>>>>>>>>>>>>    //AB-IgnoreEnd
40975>>>>>>>>>>>>>>>
40975>>>>>>>>>>>>>>>    CD_Popup_Object sl059 is a dbModalPanelSub
40994>>>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
40995>>>>>>>>>>>>>>>        Set Modal_State to FALSE
40996>>>>>>>>>>>>>>>        Set Popup_State to FALSE
40997>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
40998>>>>>>>>>>>>>>>        set label to "Œ¦£å©£˜«˜" 
40999>>>>>>>>>>>>>>>        Set Size to 148 295
41000>>>>>>>>>>>>>>>        Set Location to 4 5
41001>>>>>>>>>>>>>>>
41001>>>>>>>>>>>>>>>        //AB-DDOStart
41001>>>>>>>>>>>>>>>
41001>>>>>>>>>>>>>>>        Object Nomisma_DD is a Nomisma_DataDictionary
41003>>>>>>>>>>>>>>>        End_Object    // Nomisma_DD
41004>>>>>>>>>>>>>>>
41004>>>>>>>>>>>>>>>        Set Main_DD to (Nomisma_DD(Current_Object))
41005>>>>>>>>>>>>>>>        Set Server to (Nomisma_DD(Current_Object))
41006>>>>>>>>>>>>>>>
41006>>>>>>>>>>>>>>>        //AB-DDOEnd
41006>>>>>>>>>>>>>>>
41006>>>>>>>>>>>>>>>        Object oSelList is a dbListSub
41008>>>>>>>>>>>>>>>            Set Main_File to Nomisma.File_Number
41009>>>>>>>>>>>>>>>            Set Size to 105 278
41010>>>>>>>>>>>>>>>            Set Location to 6 6
41011>>>>>>>>>>>>>>>
41011>>>>>>>>>>>>>>>            Begin_Row
41014>>>>>>>>>>>>>>>                Entry_Item Nomisma.Nomisma_code
41015>>>>>>>>>>>>>>>                Entry_Item Nomisma.Nomisma_descr
41016>>>>>>>>>>>>>>>                Entry_Item Nomisma.Nomisma_short
41017>>>>>>>>>>>>>>>                Entry_Item Nomisma.Dekadika
41018>>>>>>>>>>>>>>>            End_Row
41023>>>>>>>>>>>>>>>
41023>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 45
41024>>>>>>>>>>>>>>>            set header_label  item 0 to "‰à› ¡¦ª" 
41025>>>>>>>>>>>>>>>
41025>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 115
41026>>>>>>>>>>>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
41027>>>>>>>>>>>>>>>
41027>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 58
41028>>>>>>>>>>>>>>>            set header_label  item 2 to "‘ç¤«¦£ž" 
41029>>>>>>>>>>>>>>>
41029>>>>>>>>>>>>>>>            Set Form_Width    item 3 to 54
41030>>>>>>>>>>>>>>>            set header_label  item 3 to "ƒœ¡˜› ¡á" 
41031>>>>>>>>>>>>>>>
41031>>>>>>>>>>>>>>>        End_Object    // oSelList
41032>>>>>>>>>>>>>>>
41032>>>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
41034>>>>>>>>>>>>>>>            set label to "&„§ ¢¦šã" 
41035>>>>>>>>>>>>>>>            Set Location to 113 124
41036>>>>>>>>>>>>>>>
41036>>>>>>>>>>>>>>>            //AB-StoreStart
41036>>>>>>>>>>>>>>>            Procedure OnClick
41038>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
41039>>>>>>>>>>>>>>>            End_Procedure
41040>>>>>>>>>>>>>>>            //AB-StoreEnd
41040>>>>>>>>>>>>>>>
41040>>>>>>>>>>>>>>>        End_Object    // oOK_bn
41041>>>>>>>>>>>>>>>
41041>>>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
41043>>>>>>>>>>>>>>>            set label to "&€¡ç¨à©ž" 
41044>>>>>>>>>>>>>>>            Set Location to 113 179
41045>>>>>>>>>>>>>>>
41045>>>>>>>>>>>>>>>            //AB-StoreStart
41045>>>>>>>>>>>>>>>            Procedure OnClick
41047>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
41048>>>>>>>>>>>>>>>            End_Procedure
41049>>>>>>>>>>>>>>>            //AB-StoreEnd
41049>>>>>>>>>>>>>>>
41049>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
41050>>>>>>>>>>>>>>>
41050>>>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
41052>>>>>>>>>>>>>>>            set label to "€&¤˜ã«ž©ž" 
41053>>>>>>>>>>>>>>>            Set Location to 113 234
41054>>>>>>>>>>>>>>>
41054>>>>>>>>>>>>>>>            //AB-StoreStart
41054>>>>>>>>>>>>>>>            Procedure OnClick
41056>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
41057>>>>>>>>>>>>>>>            End_Procedure
41058>>>>>>>>>>>>>>>            //AB-StoreEnd
41058>>>>>>>>>>>>>>>
41058>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
41059>>>>>>>>>>>>>>>
41059>>>>>>>>>>>>>>>
41059>>>>>>>>>>>>>>>        //AB-StoreStart
41059>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
41060>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
41061>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
41062>>>>>>>>>>>>>>>        //AB-StoreEnd
41062>>>>>>>>>>>>>>>
41062>>>>>>>>>>>>>>>    CD_End_Object    // sl059
41064>>>>>>>>>>>>>>>>
41064>>>>>>>>>>>>>>>
41064>>>>>>>>>>>>>>>//AB/     End_Object    // prj
41064>>>>>>>>>>>>>
41064>>>>>>>>>>>>>//DDB-Selection-pkg-End
41064>>>>>>>>>>>>>//DDB-FileEnd
41064>>>>>>>>>>>    Use COUNTRY.DD
INCLUDING FILE: COUNTRY.DD
41064>>>>>>>>>>>>>//DDB-FileStart
41064>>>>>>>>>>>>>//DDB-HeaderStart
41064>>>>>>>>>>>>>
41064>>>>>>>>>>>>>// File Name : COUNTRY.DD
41064>>>>>>>>>>>>>// Class Name: Country_DataDictionary
41064>>>>>>>>>>>>>// Revision  : 3
41064>>>>>>>>>>>>>// Version   : 2
41064>>>>>>>>>>>>>
41064>>>>>>>>>>>>>Use  Windows           // Basic Definitions
41064>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
41064>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41064>>>>>>>>>>>>>
41064>>>>>>>>>>>>>Open Country
41066>>>>>>>>>>>>>Open Towns
41068>>>>>>>>>>>>>
41068>>>>>>>>>>>>>//DDB-HeaderEnd
41068>>>>>>>>>>>>>//DDB-SelectionStart
41068>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl058  sl058.SL
41068>>>>>>>>>>>>>Register_Object sl058
41068>>>>>>>>>>>>>//DDB-SelectionEnd
41068>>>>>>>>>>>>>
41068>>>>>>>>>>>>>Class Country_DataDictionary  is a DataDictionary_Sec
41069>>>>>>>>>>>>>
41069>>>>>>>>>>>>>    // Define_Fields:
41069>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41069>>>>>>>>>>>>>
41069>>>>>>>>>>>>>    Procedure Define_Fields
41070>>>>>>>>>>>>>        Forward Send Define_Fields
41072>>>>>>>>>>>>>        //DDB-Generated-Code-Location
41072>>>>>>>>>>>>>        //DDB-DefineFieldStart
41072>>>>>>>>>>>>>
41072>>>>>>>>>>>>>        Set Main_File            To Country.File_Number
41073>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
41074>>>>>>>>>>>>>
41074>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41075>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41076>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41077>>>>>>>>>>>>>
41077>>>>>>>>>>>>>        // Child (Client) file structure................
41077>>>>>>>>>>>>>        Send Add_Client_File  Towns.File_Number
41078>>>>>>>>>>>>>
41078>>>>>>>>>>>>>        // Field-based properties.......................
41078>>>>>>>>>>>>>
41078>>>>>>>>>>>>>        // Country.Country_Id
41078>>>>>>>>>>>>>        Set Field_Options          Field Country.Country_Id To DD_AUTOFIND   
41079>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Country.Country_Id To (sl058(Self))
41080>>>>>>>>>>>>>
41080>>>>>>>>>>>>>        // Country.Country_Descr
41080>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Country.Country_Descr To (sl058(Self))
41081>>>>>>>>>>>>>
41081>>>>>>>>>>>>>        //DDB-DefineFieldEnd
41081>>>>>>>>>>>>>    End_Procedure    // Define_Fields
41082>>>>>>>>>>>>>
41082>>>>>>>>>>>>>    // Field_Defaults:
41082>>>>>>>>>>>>>    // This procedure is used to establish default field values.
41082>>>>>>>>>>>>>
41082>>>>>>>>>>>>>    Procedure Field_Defaults
41083>>>>>>>>>>>>>        Forward Send Field_Defaults
41085>>>>>>>>>>>>>        //DDB-Generated-Code-Location
41085>>>>>>>>>>>>>        //DDB-FieldDefaultStart
41085>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
41085>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
41086>>>>>>>>>>>>>
41086>>>>>>>>>>>>>End_Class    // Country_DataDictionary
41087>>>>>>>>>>>>>//DDB-Selection-pkg-Start
41087>>>>>>>>>>>>>
41087>>>>>>>>>>>>>Use sl058.SL         // sl058
INCLUDING FILE: SL058.SL
41087>>>>>>>>>>>>>>>//AB/ Project sl058 : Countries - Xores
41087>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
41087>>>>>>>>>>>>>>>//AB/         Set ProjectName to "sl058 : Countries - Xores"
41087>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl058.SL"
41087>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
41087>>>>>>>>>>>>>>>
41087>>>>>>>>>>>>>>>// Project Object Structure
41087>>>>>>>>>>>>>>>//   sl058 is a dbModalPanelSub
41087>>>>>>>>>>>>>>>//     Country_DD is a DataDictionary
41087>>>>>>>>>>>>>>>//     oSelList is a dbListSub
41087>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
41087>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
41087>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
41087>>>>>>>>>>>>>>>
41087>>>>>>>>>>>>>>>// Register all objects
41087>>>>>>>>>>>>>>>Register_Object Country_DD
41087>>>>>>>>>>>>>>>Register_Object oCancel_bn
41087>>>>>>>>>>>>>>>Register_Object oOK_bn
41087>>>>>>>>>>>>>>>Register_Object oSearch_bn
41087>>>>>>>>>>>>>>>Register_Object oSelList
41087>>>>>>>>>>>>>>>Register_Object sl058
41087>>>>>>>>>>>>>>>
41087>>>>>>>>>>>>>>>
41087>>>>>>>>>>>>>>>    //AB-IgnoreStart
41087>>>>>>>>>>>>>>>
41087>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
41087>>>>>>>>>>>>>>>    Use dbList.Sub
41087>>>>>>>>>>>>>>>    Use Button.Sub
41087>>>>>>>>>>>>>>>
41087>>>>>>>>>>>>>>>
41087>>>>>>>>>>>>>>>    Use Country.DD
41087>>>>>>>>>>>>>>>    
41087>>>>>>>>>>>>>>>    //AB-IgnoreEnd
41087>>>>>>>>>>>>>>>
41087>>>>>>>>>>>>>>>    Object sl058 is a dbModalPanelSub
41089>>>>>>>>>>>>>>>        Set Label to "•é¨œª"
41090>>>>>>>>>>>>>>>        Set Size to 148 297
41091>>>>>>>>>>>>>>>        Set Location to 6 10
41092>>>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
41093>>>>>>>>>>>>>>>        Set Modal_State to FALSE
41094>>>>>>>>>>>>>>>
41094>>>>>>>>>>>>>>>        //AB-DDOStart
41094>>>>>>>>>>>>>>>
41094>>>>>>>>>>>>>>>        Object Country_DD is a Country_DataDictionary
41096>>>>>>>>>>>>>>>        End_Object    // Country_DD
41097>>>>>>>>>>>>>>>
41097>>>>>>>>>>>>>>>        Set Main_DD to (Country_DD(self))
41098>>>>>>>>>>>>>>>        Set Server to (Country_DD(self))
41099>>>>>>>>>>>>>>>
41099>>>>>>>>>>>>>>>        //AB-DDOEnd
41099>>>>>>>>>>>>>>>
41099>>>>>>>>>>>>>>>        Object oSelList is a dbListSub
41101>>>>>>>>>>>>>>>            Set Main_File to Country.File_Number
41102>>>>>>>>>>>>>>>            Set Size to 105 280
41103>>>>>>>>>>>>>>>            Set Location to 6 6
41104>>>>>>>>>>>>>>>
41104>>>>>>>>>>>>>>>            Begin_Row
41107>>>>>>>>>>>>>>>                Entry_Item Country.Country_id
41108>>>>>>>>>>>>>>>                Entry_Item Country.Country_descr
41109>>>>>>>>>>>>>>>            End_Row
41114>>>>>>>>>>>>>>>
41114>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 87
41115>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à›"
41116>>>>>>>>>>>>>>>            
41116>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 183
41117>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
41118>>>>>>>>>>>>>>>            
41118>>>>>>>>>>>>>>>        End_Object    // oSelList
41119>>>>>>>>>>>>>>>
41119>>>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
41121>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
41122>>>>>>>>>>>>>>>            Set Location to 115 126
41123>>>>>>>>>>>>>>>
41123>>>>>>>>>>>>>>>            //AB-StoreStart
41123>>>>>>>>>>>>>>>            Procedure OnClick
41125>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
41126>>>>>>>>>>>>>>>            End_Procedure
41127>>>>>>>>>>>>>>>            //AB-StoreEnd
41127>>>>>>>>>>>>>>>
41127>>>>>>>>>>>>>>>        End_Object    // oOK_bn
41128>>>>>>>>>>>>>>>
41128>>>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
41130>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
41131>>>>>>>>>>>>>>>            Set Location to 115 181
41132>>>>>>>>>>>>>>>
41132>>>>>>>>>>>>>>>            //AB-StoreStart
41132>>>>>>>>>>>>>>>            Procedure OnClick
41134>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
41135>>>>>>>>>>>>>>>            End_Procedure
41136>>>>>>>>>>>>>>>            //AB-StoreEnd
41136>>>>>>>>>>>>>>>
41136>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
41137>>>>>>>>>>>>>>>
41137>>>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
41139>>>>>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
41140>>>>>>>>>>>>>>>            Set Location to 115 236
41141>>>>>>>>>>>>>>>
41141>>>>>>>>>>>>>>>            //AB-StoreStart
41141>>>>>>>>>>>>>>>            Procedure OnClick
41143>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
41144>>>>>>>>>>>>>>>            End_Procedure
41145>>>>>>>>>>>>>>>            //AB-StoreEnd
41145>>>>>>>>>>>>>>>
41145>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
41146>>>>>>>>>>>>>>>
41146>>>>>>>>>>>>>>>
41146>>>>>>>>>>>>>>>        //AB-StoreStart
41146>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
41147>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
41148>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
41149>>>>>>>>>>>>>>>        //AB-StoreEnd
41149>>>>>>>>>>>>>>>
41149>>>>>>>>>>>>>>>    End_Object    // sl058
41150>>>>>>>>>>>>>>>
41150>>>>>>>>>>>>>>>//AB/     End_Object    // prj
41150>>>>>>>>>>>>>
41150>>>>>>>>>>>>>//DDB-Selection-pkg-End
41150>>>>>>>>>>>>>//DDB-FileEnd
41150>>>>>>>>>>>    Use TOWNS.DD
INCLUDING FILE: TOWNS.DD
41150>>>>>>>>>>>>>//DDB-FileStart
41150>>>>>>>>>>>>>//DDB-HeaderStart
41150>>>>>>>>>>>>>
41150>>>>>>>>>>>>>// File Name : TOWNS.DD
41150>>>>>>>>>>>>>// Class Name: Towns_DataDictionary
41150>>>>>>>>>>>>>// Revision  : 8
41150>>>>>>>>>>>>>// Version   : 2
41150>>>>>>>>>>>>>
41150>>>>>>>>>>>>>Use  Windows           // Basic Definitions
41150>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
41150>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41150>>>>>>>>>>>>>
41150>>>>>>>>>>>>>Open Towns
41152>>>>>>>>>>>>>Open Cities
41154>>>>>>>>>>>>>Open Country
41156>>>>>>>>>>>>>
41156>>>>>>>>>>>>>//DDB-HeaderEnd
41156>>>>>>>>>>>>>//DDB-SelectionStart
41156>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl057  sl057.SL
41156>>>>>>>>>>>>>Register_Object sl057
41156>>>>>>>>>>>>>//DDB-SelectionEnd
41156>>>>>>>>>>>>>
41156>>>>>>>>>>>>>Class Towns_DataDictionary  is a DataDictionary_Sec
41157>>>>>>>>>>>>>
41157>>>>>>>>>>>>>    Procedure Save_Main_File
41158>>>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
41160>>>>>>>>>>>>>            If Towns.Recnum Eq 0 Procedure_Return
41163>>>>>>>>>>>>>        End
41163>>>>>>>>>>>>>>
41163>>>>>>>>>>>>>        Forward Send Save_Main_File
41165>>>>>>>>>>>>>    End_Procedure
41166>>>>>>>>>>>>>
41166>>>>>>>>>>>>>
41166>>>>>>>>>>>>>    // Define_Fields:
41166>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41166>>>>>>>>>>>>>
41166>>>>>>>>>>>>>    Procedure Define_Fields
41167>>>>>>>>>>>>>        Forward Send Define_Fields
41169>>>>>>>>>>>>>        //DDB-Generated-Code-Location
41169>>>>>>>>>>>>>        //DDB-DefineFieldStart
41169>>>>>>>>>>>>>
41169>>>>>>>>>>>>>        Set Main_File            To Towns.File_Number
41170>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
41171>>>>>>>>>>>>>
41171>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   to DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41172>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD to DD_NOPUT       DD_FINDREQ    
41173>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    to DD_DISPLAYONLY
41174>>>>>>>>>>>>>
41174>>>>>>>>>>>>>        // Child (Client) file structure................
41174>>>>>>>>>>>>>        Send Add_Client_File  Cities.File_Number
41175>>>>>>>>>>>>>
41175>>>>>>>>>>>>>        // Parent (Server) file structure...............
41175>>>>>>>>>>>>>        Send Add_Server_File  Country.File_Number
41176>>>>>>>>>>>>>
41176>>>>>>>>>>>>>        // Field-based properties.......................
41176>>>>>>>>>>>>>
41176>>>>>>>>>>>>>        // Towns.Country_Id
41176>>>>>>>>>>>>>        Set Key_Field_State        Field Towns.Country_Id To TRUE
41177>>>>>>>>>>>>>
41177>>>>>>>>>>>>>        // Towns.Town_Id
41177>>>>>>>>>>>>>        Set Field_Options          Field Towns.Town_Id To DD_AUTOFIND   
41178>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Towns.Town_Id To (sl057(Self))
41179>>>>>>>>>>>>>
41179>>>>>>>>>>>>>        // Towns.Town_Descr
41179>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Towns.Town_Descr To (sl057(Self))
41180>>>>>>>>>>>>>
41180>>>>>>>>>>>>>        //DDB-DefineFieldEnd
41180>>>>>>>>>>>>>    End_Procedure    // Define_Fields
41181>>>>>>>>>>>>>
41181>>>>>>>>>>>>>    // Field_Defaults:
41181>>>>>>>>>>>>>    // This procedure is used to establish default field values.
41181>>>>>>>>>>>>>
41181>>>>>>>>>>>>>    Procedure Field_Defaults
41182>>>>>>>>>>>>>        Forward Send Field_Defaults
41184>>>>>>>>>>>>>        //DDB-Generated-Code-Location
41184>>>>>>>>>>>>>        //DDB-FieldDefaultStart
41184>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
41184>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
41185>>>>>>>>>>>>>
41185>>>>>>>>>>>>>End_Class    // Towns_DataDictionary
41186>>>>>>>>>>>>>//DDB-Selection-pkg-Start
41186>>>>>>>>>>>>>
41186>>>>>>>>>>>>>Use sl057.SL         // sl057
INCLUDING FILE: SL057.SL
41186>>>>>>>>>>>>>>>//AB/ Project sl057 : Towns -Nomoi - Eyr Perioxes
41186>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
41186>>>>>>>>>>>>>>>//AB/         Set ProjectName to "sl057 : Towns -Nomoi - Eyr Perioxes"
41186>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl057.SL"
41186>>>>>>>>>>>>>>>
41186>>>>>>>>>>>>>>>// Project Object Structure
41186>>>>>>>>>>>>>>>//   sl057 is a dbModalPanelSub
41186>>>>>>>>>>>>>>>//     Country_DD is a DataDictionary
41186>>>>>>>>>>>>>>>//     Towns_DD is a DataDictionary
41186>>>>>>>>>>>>>>>//     oSelList is a dbListSub
41186>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
41186>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
41186>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
41186>>>>>>>>>>>>>>>
41186>>>>>>>>>>>>>>>// Register all objects
41186>>>>>>>>>>>>>>>Register_Object Country_DD
41186>>>>>>>>>>>>>>>Register_Object oCancel_bn
41186>>>>>>>>>>>>>>>Register_Object oOK_bn
41186>>>>>>>>>>>>>>>Register_Object oSearch_bn
41186>>>>>>>>>>>>>>>Register_Object oSelList
41186>>>>>>>>>>>>>>>Register_Object sl057
41186>>>>>>>>>>>>>>>Register_Object Towns_DD
41186>>>>>>>>>>>>>>>
41186>>>>>>>>>>>>>>>
41186>>>>>>>>>>>>>>>    //AB-IgnoreStart
41186>>>>>>>>>>>>>>>
41186>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
41186>>>>>>>>>>>>>>>    Use dbList.Sub
41186>>>>>>>>>>>>>>>    Use Button.Sub
41186>>>>>>>>>>>>>>>
41186>>>>>>>>>>>>>>>
41186>>>>>>>>>>>>>>>    Use COUNTRY.DD
41186>>>>>>>>>>>>>>>    Use TOWNS.DD
41186>>>>>>>>>>>>>>>    
41186>>>>>>>>>>>>>>>    //AB-IgnoreEnd
41186>>>>>>>>>>>>>>>
41186>>>>>>>>>>>>>>>    Object sl057 is a dbModalPanelSub
41188>>>>>>>>>>>>>>>        Set Label to "Œ¦£¦å - „¬¨ç«œ¨œª §œ¨ ¦®âª"
41189>>>>>>>>>>>>>>>        Set Size to 148 297
41190>>>>>>>>>>>>>>>        Set Location to 6 10
41191>>>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
41192>>>>>>>>>>>>>>>        Set Modal_State to FALSE
41193>>>>>>>>>>>>>>>
41193>>>>>>>>>>>>>>>        //AB-DDOStart
41193>>>>>>>>>>>>>>>
41193>>>>>>>>>>>>>>>        Object Country_DD is a Country_DataDictionary
41195>>>>>>>>>>>>>>>        End_Object    // Country_DD
41196>>>>>>>>>>>>>>>
41196>>>>>>>>>>>>>>>        Object Towns_DD is a Towns_DataDictionary
41198>>>>>>>>>>>>>>>            Set DDO_Server to (Country_DD(self))
41199>>>>>>>>>>>>>>>        End_Object    // Towns_DD
41200>>>>>>>>>>>>>>>
41200>>>>>>>>>>>>>>>        Set Main_DD to (Towns_DD(self))
41201>>>>>>>>>>>>>>>        Set Server to (Towns_DD(self))
41202>>>>>>>>>>>>>>>
41202>>>>>>>>>>>>>>>        //AB-DDOEnd
41202>>>>>>>>>>>>>>>
41202>>>>>>>>>>>>>>>        Object oSelList is a dbListSub
41204>>>>>>>>>>>>>>>            Set Main_File to Towns.File_Number
41205>>>>>>>>>>>>>>>            Set Size to 105 280
41206>>>>>>>>>>>>>>>            Set Location to 6 6
41207>>>>>>>>>>>>>>>
41207>>>>>>>>>>>>>>>            Begin_Row
41210>>>>>>>>>>>>>>>                Entry_Item Towns.Town_id
41211>>>>>>>>>>>>>>>                Entry_Item Towns.Town_descr
41212>>>>>>>>>>>>>>>                Entry_Item Country.Country_descr
41213>>>>>>>>>>>>>>>            End_Row
41218>>>>>>>>>>>>>>>
41218>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 43
41219>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à›"
41220>>>>>>>>>>>>>>>            
41220>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 137
41221>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
41222>>>>>>>>>>>>>>>            
41222>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 94
41223>>>>>>>>>>>>>>>            Set Header_Label  item 2 to "•é¨˜"
41224>>>>>>>>>>>>>>>            
41224>>>>>>>>>>>>>>>        End_Object    // oSelList
41225>>>>>>>>>>>>>>>
41225>>>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
41227>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
41228>>>>>>>>>>>>>>>            Set Location to 115 126
41229>>>>>>>>>>>>>>>
41229>>>>>>>>>>>>>>>            //AB-StoreStart
41229>>>>>>>>>>>>>>>            Procedure OnClick
41231>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
41232>>>>>>>>>>>>>>>            End_Procedure
41233>>>>>>>>>>>>>>>            //AB-StoreEnd
41233>>>>>>>>>>>>>>>
41233>>>>>>>>>>>>>>>        End_Object    // oOK_bn
41234>>>>>>>>>>>>>>>
41234>>>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
41236>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
41237>>>>>>>>>>>>>>>            Set Location to 115 181
41238>>>>>>>>>>>>>>>
41238>>>>>>>>>>>>>>>            //AB-StoreStart
41238>>>>>>>>>>>>>>>            Procedure OnClick
41240>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
41241>>>>>>>>>>>>>>>            End_Procedure
41242>>>>>>>>>>>>>>>            //AB-StoreEnd
41242>>>>>>>>>>>>>>>
41242>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
41243>>>>>>>>>>>>>>>
41243>>>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
41245>>>>>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
41246>>>>>>>>>>>>>>>            Set Location to 115 236
41247>>>>>>>>>>>>>>>
41247>>>>>>>>>>>>>>>            //AB-StoreStart
41247>>>>>>>>>>>>>>>            Procedure OnClick
41249>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
41250>>>>>>>>>>>>>>>            End_Procedure
41251>>>>>>>>>>>>>>>            //AB-StoreEnd
41251>>>>>>>>>>>>>>>
41251>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
41252>>>>>>>>>>>>>>>
41252>>>>>>>>>>>>>>>
41252>>>>>>>>>>>>>>>        //AB-StoreStart
41252>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
41253>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
41254>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
41255>>>>>>>>>>>>>>>        //AB-StoreEnd
41255>>>>>>>>>>>>>>>
41255>>>>>>>>>>>>>>>    End_Object    // sl057
41256>>>>>>>>>>>>>>>
41256>>>>>>>>>>>>>>>//AB/     End_Object    // prj
41256>>>>>>>>>>>>>
41256>>>>>>>>>>>>>//DDB-Selection-pkg-End
41256>>>>>>>>>>>>>//DDB-FileEnd
41256>>>>>>>>>>>    Use CITIES.DD
41256>>>>>>>>>>>    Use PAYRESP.DD
41256>>>>>>>>>>>    Use AREAS.DD
41256>>>>>>>>>>>    Use CLIENTS.DD
41256>>>>>>>>>>>    Use PARTICLE.DD
INCLUDING FILE: PARTICLE.DD
41256>>>>>>>>>>>>>//DDB-FileStart
41256>>>>>>>>>>>>>//DDB-HeaderStart
41256>>>>>>>>>>>>>
41256>>>>>>>>>>>>>// File Name : PARTICLE.DD
41256>>>>>>>>>>>>>// Class Name: Particle_DataDictionary
41256>>>>>>>>>>>>>// Revision  : 237
41256>>>>>>>>>>>>>// Version   : 2
41256>>>>>>>>>>>>>
41256>>>>>>>>>>>>>Use  Windows           // Basic Definitions
41256>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
41256>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41256>>>>>>>>>>>>>
41256>>>>>>>>>>>>>Open Particle
41258>>>>>>>>>>>>>Open Pmoves
41260>>>>>>>>>>>>>Open Tparticl
INCLUDING FILE: TPARTICL.FD
41262>>>>>>>>>>>>>Open Partlfpa
41264>>>>>>>>>>>>>Open Pmovesl
41266>>>>>>>>>>>>>Open Psxetika
41268>>>>>>>>>>>>>Open Clients
41270>>>>>>>>>>>>>Open Ptyppar
41272>>>>>>>>>>>>>Open Nomisma
41274>>>>>>>>>>>>>Open Sysrecp
41276>>>>>>>>>>>>>Open Syscurxr
41278>>>>>>>>>>>>>Open Pseira
41280>>>>>>>>>>>>>Open Cn
41282>>>>>>>>>>>>>Open Partlfpa
41284>>>>>>>>>>>>>Open Clorder
41286>>>>>>>>>>>>>Open Clorderd
INCLUDING FILE: CLORDERD.FD
41288>>>>>>>>>>>>>Open Ypoprosf
INCLUDING FILE: YPOPROSF.FD
41290>>>>>>>>>>>>>Open Psxetika
41292>>>>>>>>>>>>>Open Pmoves
41294>>>>>>>>>>>>>
41294>>>>>>>>>>>>>//DDB-HeaderEnd
41294>>>>>>>>>>>>>//DDB-ValidationStart
41294>>>>>>>>>>>>>
41294>>>>>>>>>>>>>Register_Object Particle_Tropos_Diakin_VT
41294>>>>>>>>>>>>>Register_Object Particle_Skopos_Diakin_VT
41294>>>>>>>>>>>>>Register_Object Particle_Tropos_Plhromhs_VT
41294>>>>>>>>>>>>>
41294>>>>>>>>>>>>>Object Particle_Tropos_Diakin_VT  is a CodeValidationTable
41296>>>>>>>>>>>>>    Set Type_Value        To "SEND_TERMS"
41297>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
41298>>>>>>>>>>>>>    //DDB-ValidationCustomStart
41298>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
41298>>>>>>>>>>>>>End_Object   // Particle_Tropos_Diakin_VT
41299>>>>>>>>>>>>>
41299>>>>>>>>>>>>>Object Particle_Skopos_Diakin_VT  is a CodeValidationTable
41301>>>>>>>>>>>>>    Set Type_Value        To "SKOPOS"
41302>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
41303>>>>>>>>>>>>>    //DDB-ValidationCustomStart
41303>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
41303>>>>>>>>>>>>>End_Object   // Particle_Skopos_Diakin_VT
41304>>>>>>>>>>>>>
41304>>>>>>>>>>>>>Object Particle_Tropos_Plhromhs_VT  is a CodeValidationTable
41306>>>>>>>>>>>>>    Set Type_Value        To "PAY_TERMS"
41307>>>>>>>>>>>>>    Set Validate_State    To FALSE
41308>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
41309>>>>>>>>>>>>>    //DDB-ValidationCustomStart
41309>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
41309>>>>>>>>>>>>>End_Object   // Particle_Tropos_Plhromhs_VT
41310>>>>>>>>>>>>>//DDB-ValidationEnd
41310>>>>>>>>>>>>>//DDB-SelectionStart
41310>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl041  sl041.SL
41310>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl014  sl014.SL
41310>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl054  sl054.SL
41310>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl053  sl053.SL
41310>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl064  sl064.SL
41310>>>>>>>>>>>>>Register_Object sl041
41310>>>>>>>>>>>>>Register_Object sl014
41310>>>>>>>>>>>>>Register_Object sl054
41310>>>>>>>>>>>>>Register_Object sl053
41310>>>>>>>>>>>>>Register_Object sl064
41310>>>>>>>>>>>>>//DDB-SelectionEnd
41310>>>>>>>>>>>>>
41310>>>>>>>>>>>>>//Object oValidateSeira is a FileValidationTable
41310>>>>>>>>>>>>>//    Set Table_Title         to "„§ ¢¦šã ‘œ ¨áª ˜¨˜©«˜« ¡¦ç"
41310>>>>>>>>>>>>>//    Set Main_File           to Pseira.File_Number
41310>>>>>>>>>>>>>//    Set Code_Field          to  8 //Pseira.Pseira_Seira
41310>>>>>>>>>>>>>//    Set Description_Field   to 11 //Pseira.Pseira_Printer
41310>>>>>>>>>>>>>//    Set Ordering            to  1
41310>>>>>>>>>>>>>//    Set Static_State to False
41310>>>>>>>>>>>>>//End_Object
41310>>>>>>>>>>>>>
41310>>>>>>>>>>>>>Open Cars
INCLUDING FILE: CARS.FD
41312>>>>>>>>>>>>>Open Drivers
INCLUDING FILE: DRIVERS.FD
41314>>>>>>>>>>>>>Open Pumps
INCLUDING FILE: PUMPS.FD
41316>>>>>>>>>>>>>Open SysCurXr
41318>>>>>>>>>>>>>
41318>>>>>>>>>>>>>Class Particle_DataDictionary  is a DataDictionary_Sec
41319>>>>>>>>>>>>>
41319>>>>>>>>>>>>>    Function fsVresAntliaDescr String asOxhmaCode Returns String
41320>>>>>>>>>>>>>        String rVal
41321>>>>>>>>>>>>>        Clear Pumps
41322>>>>>>>>>>>>>        Move SysCurXr.Company_Code  to Pumps.Pump_Company
41323>>>>>>>>>>>>>        Move asOxhmaCode            to Pumps.Pump_ID
41324>>>>>>>>>>>>>        Find Eq Pumps By Index.1 // Pump_Company + Pump_ID
41325>>>>>>>>>>>>>>
41325>>>>>>>>>>>>>        If (Found) Move (Trim(Pumps.Pump_Descr)) to rVal
41328>>>>>>>>>>>>>        Else Move '' to rVal
41330>>>>>>>>>>>>>        Function_Return rVal
41331>>>>>>>>>>>>>    End_Function
41332>>>>>>>>>>>>>
41332>>>>>>>>>>>>>    Function fsVresOxhmaDescr String asOxhmaCode Returns String
41333>>>>>>>>>>>>>        String rVal
41334>>>>>>>>>>>>>        Clear Cars
41335>>>>>>>>>>>>>        Move SysCurXr.Company_Code  to Cars.Car_Company
41336>>>>>>>>>>>>>        Move asOxhmaCode            to Cars.Car_ID
41337>>>>>>>>>>>>>        Find Eq Cars By Index.1 // Car_Company + Car_ID
41338>>>>>>>>>>>>>>
41338>>>>>>>>>>>>>
41338>>>>>>>>>>>>>        If (Found) Move (Trim(Cars.Car_License)) to rVal
41341>>>>>>>>>>>>>        Else Move '' to rVal
41343>>>>>>>>>>>>>        Function_Return rVal
41344>>>>>>>>>>>>>    End_Function
41345>>>>>>>>>>>>>
41345>>>>>>>>>>>>>    Function fsVresDriverCode String asOxhmaCode Returns String
41346>>>>>>>>>>>>>        String rVal
41347>>>>>>>>>>>>>        Clear Cars
41348>>>>>>>>>>>>>        Move SysCurXr.Company_Code  to Cars.Car_Company
41349>>>>>>>>>>>>>        Move asOxhmaCode            to Cars.Car_ID
41350>>>>>>>>>>>>>        Find Eq Cars By Index.1 // Car_Company + Car_ID
41351>>>>>>>>>>>>>>
41351>>>>>>>>>>>>>        If (Found)  Move (Trim(Cars.Car_DriverID)) to rVal
41354>>>>>>>>>>>>>        Else        Move '' to rVal
41356>>>>>>>>>>>>>        Function_Return rVal
41357>>>>>>>>>>>>>    End_Function
41358>>>>>>>>>>>>>
41358>>>>>>>>>>>>>    Function fsVresDriverDescr String asDriverCode Returns String
41359>>>>>>>>>>>>>        String rVal
41360>>>>>>>>>>>>>        Clear Drivers
41361>>>>>>>>>>>>>        Move SysCurXr.Company_Code  to Drivers.Driver_Company
41362>>>>>>>>>>>>>        Move asDriverCode           to Drivers.Driver_ID
41363>>>>>>>>>>>>>        Find Eq Drivers By Index.1 // Driver_Company + Driver_ID
41364>>>>>>>>>>>>>>
41364>>>>>>>>>>>>>        If (Found) Move (Trim(Drivers.Driver_Name)) to rVal
41367>>>>>>>>>>>>>        Else Move '' to rVal
41369>>>>>>>>>>>>>        Function_Return rVal
41370>>>>>>>>>>>>>    End_Function
41371>>>>>>>>>>>>>
41371>>>>>>>>>>>>>    Procedure Construct_Object
41372>>>>>>>>>>>>>        Forward Send Construct_Object
41374>>>>>>>>>>>>>        Property String     psOldCode       Public ''
41375>>>>>>>>>>>>>        Property Integer    piPmovesID      Public  0
41376>>>>>>>>>>>>>        Property String     psOldUserID     Public ''
41377>>>>>>>>>>>>>        Property Integer    piOldSelected   Public  0
41378>>>>>>>>>>>>>        Property Integer    piFromMetasx    Public  0
41379>>>>>>>>>>>>>    End_procedure
41380>>>>>>>>>>>>>
41380>>>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
41381>>>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
41383>>>>>>>>>>>>>        Set psOldCode       to Particle.Nomisma_Code
41384>>>>>>>>>>>>>        Set psOldUserID     to Particle.Partl_ToposF
41385>>>>>>>>>>>>>        Set piOldSelected   to Particle.Partl_Selected
41386>>>>>>>>>>>>>    End_Procedure   // New_Current_Record
41387>>>>>>>>>>>>>
41387>>>>>>>>>>>>>    Procedure Shmera integer iField  Date dDate
41388>>>>>>>>>>>>>        Local Integer Changed
41389>>>>>>>>>>>>>        Get Field_Changed_State iField to Changed
41390>>>>>>>>>>>>>        If (Changed=0 AND dDate =0) Begin
41392>>>>>>>>>>>>>            SysDate4 dDate
41393>>>>>>>>>>>>>            Set Field_Default_Value iField to dDate
41394>>>>>>>>>>>>>        End
41394>>>>>>>>>>>>>>
41394>>>>>>>>>>>>>    End_Procedure   // Shmera
41395>>>>>>>>>>>>>
41395>>>>>>>>>>>>>    Procedure Shmera_Ora integer iField  Number nOra
41396>>>>>>>>>>>>>        Local Integer Changed
41397>>>>>>>>>>>>>        Date dDate
41397>>>>>>>>>>>>>        Number nHour nMin
41397>>>>>>>>>>>>>        Get Field_Changed_State iField to Changed
41398>>>>>>>>>>>>>        If (Changed=0 AND nOra =0) Begin
41400>>>>>>>>>>>>>            SysDate4 dDate nHour nMin
41403>>>>>>>>>>>>>            Set Field_Default_Value iField to (nHour+(nMin/100))
41404>>>>>>>>>>>>>        End
41404>>>>>>>>>>>>>>
41404>>>>>>>>>>>>>    End_Procedure   // Shmera
41405>>>>>>>>>>>>>
41405>>>>>>>>>>>>>    Procedure Shmera_Ora_String integer iField  String asOra
41406>>>>>>>>>>>>>        Local Integer Changed
41407>>>>>>>>>>>>>        Date dDate
41407>>>>>>>>>>>>>        Number nHour nMin nTotal
41407>>>>>>>>>>>>>        String sOra sMin
41407>>>>>>>>>>>>>        Get Field_Changed_State iField to Changed
41408>>>>>>>>>>>>>        If (Changed=0 AND asOra='') Begin
41410>>>>>>>>>>>>>            SysDate4 dDate nHour nMin
41413>>>>>>>>>>>>>            Move (nHour+(nMin/100)) to nTotal
41414>>>>>>>>>>>>>            Set Field_Default_Value iField to (fsConvert_Time_Number_To_String_With_Zeroes(nTotal))
41415>>>>>>>>>>>>>        End
41415>>>>>>>>>>>>>>
41415>>>>>>>>>>>>>    End_Procedure   // Shmera
41416>>>>>>>>>>>>>
41416>>>>>>>>>>>>>    Procedure Save_Main_File
41417>>>>>>>>>>>>>        String  sCodeApo sCodeEos sOldUserID sCurrentUserID
41418>>>>>>>>>>>>>        Integer iBreak iPmoves iSelected iOldSelected
41418>>>>>>>>>>>>>        Number  nPoso nPosoEuro nIsotimia nPosothtaKin
41418>>>>>>>>>>>>>        Date    dHmnia
41418>>>>>>>>>>>>>
41418>>>>>>>>>>>>>        If ((Operation_Origin<>Self) And ;            (Particle.Recnum=0)) Procedure_Return
41421>>>>>>>>>>>>>
41421>>>>>>>>>>>>>        If (Particle.Cn_Code<>'') Begin
41423>>>>>>>>>>>>>            Clear Cn
41424>>>>>>>>>>>>>            Move Particle.Cn_Code   to Cn.Cn_Code
41425>>>>>>>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
41426>>>>>>>>>>>>>>
41426>>>>>>>>>>>>>            If (Found) Begin
41428>>>>>>>>>>>>>                Move Cn.Cn_Sls_ID       to Particle.Sls_ID
41429>>>>>>>>>>>>>                Move Cn.CN_Cnt_ID       to Particle.Cnt_ID
41430>>>>>>>>>>>>>                Move Cn.CN_Recr         to Particle.CN_Recr
41431>>>>>>>>>>>>>            End
41431>>>>>>>>>>>>>>
41431>>>>>>>>>>>>>            Else Begin
41432>>>>>>>>>>>>>                Move ''                 to Particle.Sls_ID
41433>>>>>>>>>>>>>                Move ''                 to Particle.Cnt_ID
41434>>>>>>>>>>>>>                Move ''                 to Particle.CN_Recr
41435>>>>>>>>>>>>>            End
41435>>>>>>>>>>>>>>
41435>>>>>>>>>>>>>        End
41435>>>>>>>>>>>>>>
41435>>>>>>>>>>>>>        Else Begin
41436>>>>>>>>>>>>>            Move ''                 to Particle.Sls_ID
41437>>>>>>>>>>>>>            Move ''                 to Particle.Cnt_ID
41438>>>>>>>>>>>>>            Move ''                 to Particle.CN_Recr
41439>>>>>>>>>>>>>        End
41439>>>>>>>>>>>>>>
41439>>>>>>>>>>>>>
41439>>>>>>>>>>>>>        Move Pmoves.Recnum              to iPmoves
41440>>>>>>>>>>>>>
41440>>>>>>>>>>>>>        Move Particle.Partl_Selected    to iSelected
41441>>>>>>>>>>>>>        Get piOldSelected               to iOldSelected
41442>>>>>>>>>>>>>        Get fsLoginUserID               to sCurrentUserID
41443>>>>>>>>>>>>>        Get psOldUserID                 to sOldUserID
41444>>>>>>>>>>>>>
41444>>>>>>>>>>>>>        If (Particle.Partl_Disctof<>0) Begin
41446>>>>>>>>>>>>>            If (sOldUserID='') Move sCurrentUserID to Particle.Partl_Toposf
41449>>>>>>>>>>>>>        End
41449>>>>>>>>>>>>>>
41449>>>>>>>>>>>>>        Else Begin
41450>>>>>>>>>>>>>            Move '' to Particle.Partl_Toposf
41451>>>>>>>>>>>>>        End
41451>>>>>>>>>>>>>>
41451>>>>>>>>>>>>>
41451>>>>>>>>>>>>>        Move 0 to nPosothtaKin
41452>>>>>>>>>>>>>
41452>>>>>>>>>>>>>        //If (iSelected<>iOldSelected) Begin
41452>>>>>>>>>>>>>        If ((piFromMetasx(Self)) Or (iSelected<>iOldSelected))Begin
41454>>>>>>>>>>>>>            If ((Particle.Partl_Toposf=sCurrentUserID) Or (Particle.Partl_Toposf='')) Begin
41456>>>>>>>>>>>>>                If (iSelected) Begin
41458>>>>>>>>>>>>>                    Clear Pmoves
41459>>>>>>>>>>>>>                    Move Particle.Partl_Recr to Pmoves.Partl_Recr
41460>>>>>>>>>>>>>                    Find Gt Pmoves by index.3
41461>>>>>>>>>>>>>>
41461>>>>>>>>>>>>>                    While ((Found=1) And (Pmoves.Partl_Recr=Particle.Partl_Recr))
41465>>>>>>>>>>>>>                        Move Pmoves.Timol_Ypol  to Pmoves.Qty_Kinhshs
41466>>>>>>>>>>>>>                        Add  Pmoves.Timol_Ypol  to nPosothtaKin
41467>>>>>>>>>>>>>                        Move 1              to Pmoves.Pms_Selected
41468>>>>>>>>>>>>>                        Saverecord Pmoves
41469>>>>>>>>>>>>>                        Find Gt Pmoves by index.3
41470>>>>>>>>>>>>>>
41470>>>>>>>>>>>>>                    Loop
41471>>>>>>>>>>>>>>
41471>>>>>>>>>>>>>                    Move sCurrentUserID to Particle.Partl_Toposf
41472>>>>>>>>>>>>>                    Move nPosothtaKin   to Particle.Partl_Disctof
41473>>>>>>>>>>>>>                End
41473>>>>>>>>>>>>>>
41473>>>>>>>>>>>>>                Else Begin
41474>>>>>>>>>>>>>                    Clear Pmoves
41475>>>>>>>>>>>>>                    Move Particle.Partl_Recr to Pmoves.Partl_Recr
41476>>>>>>>>>>>>>                    Find Gt Pmoves by index.3
41477>>>>>>>>>>>>>>
41477>>>>>>>>>>>>>                    While ((Found=1) And (Pmoves.Partl_Recr=Particle.Partl_Recr))
41481>>>>>>>>>>>>>                        Move 0 to Pmoves.Qty_Kinhshs
41482>>>>>>>>>>>>>                        Move 0 to Pmoves.Pms_Selected
41483>>>>>>>>>>>>>                        Saverecord Pmoves
41484>>>>>>>>>>>>>                        Find Gt Pmoves by index.3
41485>>>>>>>>>>>>>>
41485>>>>>>>>>>>>>                    Loop
41486>>>>>>>>>>>>>>
41486>>>>>>>>>>>>>                    Move '' to Particle.Partl_Toposf
41487>>>>>>>>>>>>>                    Move 0  to Particle.Partl_Disctof
41488>>>>>>>>>>>>>                End
41488>>>>>>>>>>>>>>
41488>>>>>>>>>>>>>
41488>>>>>>>>>>>>>//                // js 11/04/2003
41488>>>>>>>>>>>>>//                If (iPmoves) Begin
41488>>>>>>>>>>>>>//                    Clear Pmoves
41488>>>>>>>>>>>>>//                    Move iPmoves to Pmoves.Recnum
41488>>>>>>>>>>>>>//                    Find Eq Pmoves.Recnum
41488>>>>>>>>>>>>>//                End
41488>>>>>>>>>>>>>
41488>>>>>>>>>>>>>            End
41488>>>>>>>>>>>>>>
41488>>>>>>>>>>>>>            Set piFromMetasx to 0
41489>>>>>>>>>>>>>        End
41489>>>>>>>>>>>>>>
41489>>>>>>>>>>>>>
41489>>>>>>>>>>>>>        Forward Send Save_Main_File
41491>>>>>>>>>>>>>
41491>>>>>>>>>>>>>    End_Procedure   // Save_Main_File
41492>>>>>>>>>>>>>
41492>>>>>>>>>>>>>
41492>>>>>>>>>>>>>    Procedure Calc_The_Totals
41493>>>>>>>>>>>>>        Number nPct nPoso nAxia nTmp
41494>>>>>>>>>>>>>
41494>>>>>>>>>>>>>        Move (Particle.Partl_AMDISCPMS  + ;              Particle.Partl_TotDiscPc)         to Particle.Partl_DiscAm
41495>>>>>>>>>>>>>
41495>>>>>>>>>>>>>        Move (Particle.Partl_TotAmBD    - ;              Particle.Partl_DiscAm)            to Particle.Partl_TotAmAd
41496>>>>>>>>>>>>>
41496>>>>>>>>>>>>>        Move (Particle.Partl_TotAmAd    + ;              Particle.Partl_Extra)             to Particle.Partl_GenAm
41497>>>>>>>>>>>>>
41497>>>>>>>>>>>>>        If ((Particle.Partl_Extra<>0) And (Particle.Partl_ExtraVatP<>0)) Begin
41499>>>>>>>>>>>>>            Move (Round(Particle.Partl_Extra        *;                        Particle.Partl_ExtraVatP    /;                  100))                         to Particle.Partl_ExtraVat
41500>>>>>>>>>>>>>        End
41500>>>>>>>>>>>>>>
41500>>>>>>>>>>>>>
41500>>>>>>>>>>>>>        If ((Particle.Partl_TotDiscPC<>0) And (Particle.Disc_Vat_Pct<>0)) Begin
41502>>>>>>>>>>>>>            Move (Round(Particle.Partl_TotDiscPC    *;                        Particle.Disc_Vat_Pct       /;                  100))                         to Particle.Disc_Vat_Poso
41503>>>>>>>>>>>>>        End
41503>>>>>>>>>>>>>>
41503>>>>>>>>>>>>>
41503>>>>>>>>>>>>>        Move (Particle.Partl_Vatam-Particle.Disc_Vat_Poso+Particle.Partl_ExtraVat) ;            to Particle.Total_Vat_Poso
41504>>>>>>>>>>>>>
41504>>>>>>>>>>>>>        Move (Particle.Partl_GenAm      + ;              Particle.Total_Vat_Poso ) to Particle.Partl_PayAm
41505>>>>>>>>>>>>>
41505>>>>>>>>>>>>>        If (Particle.PARTL_TOTTEM>0) Begin
41507>>>>>>>>>>>>>            Move (Particle.PARTL_TOTTEM-Particle.Timol_Qty) ;                                            to Particle.Timol_Ypol
41508>>>>>>>>>>>>>
41508>>>>>>>>>>>>>            Move (Particle.Timol_Ypol=0)    to Particle.Partl_Timol
41509>>>>>>>>>>>>>
41509>>>>>>>>>>>>>        End
41509>>>>>>>>>>>>>>
41509>>>>>>>>>>>>>        Else Move 0 to Particle.Partl_Timol
41511>>>>>>>>>>>>>
41511>>>>>>>>>>>>>        Move Particle.Partl_TotAmAD  to nAxia
41512>>>>>>>>>>>>>        Move Particle.Parakrat_Pct   to nPct
41513>>>>>>>>>>>>>        Move (Round_Number(((nAxia*nPct)/100),2)) to nTmp
41514>>>>>>>>>>>>>        Move nTmp to Particle.Parakrat_Poso
41515>>>>>>>>>>>>>    End_Procedure
41516>>>>>>>>>>>>>
41516>>>>>>>>>>>>>    Procedure Find_The_Rate
41517>>>>>>>>>>>>>        String  sCode sWhat
41518>>>>>>>>>>>>>        Integer iRateID
41518>>>>>>>>>>>>>        Number nEuro nIsot nRate
41518>>>>>>>>>>>>>        Date dHmnia
41518>>>>>>>>>>>>>        Move Nomisma.Nomisma_Code                   to sCode
41519>>>>>>>>>>>>>        If (Trim(sCode)='') Move SysCurXr.C_Code0   to sCode
41522>>>>>>>>>>>>>        Move Particle.Partl_Hmnia       to dHmnia
41523>>>>>>>>>>>>>        Move Particle.Isotimia          to nIsot
41524>>>>>>>>>>>>>        If (nIsot=0) Begin
41526>>>>>>>>>>>>>            If (dHmnia='') Sysdate dHmnia
41529>>>>>>>>>>>>>            Move (Trim(sCode)) to sCode
41530>>>>>>>>>>>>>            Clear Isotimia
41531>>>>>>>>>>>>>            Move sCode      to Isotimia.Nomisma_Code
41532>>>>>>>>>>>>>            Move (dHmnia+1) to Isotimia.Isotimia_Hmnia
41533>>>>>>>>>>>>>            Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
41534>>>>>>>>>>>>>>
41534>>>>>>>>>>>>>            If (Nomisma.Einai_Drx) Move 1 to Particle.Isotimia
41537>>>>>>>>>>>>>            Else Begin
41538>>>>>>>>>>>>>                Case Begin
41538>>>>>>>>>>>>>                    case (isotimia.poia_metatrepei='€') // Agora
41540>>>>>>>>>>>>>                        Move Isotimia.Isotimia_Agora to Particle.Isotimia
41541>>>>>>>>>>>>>                        Case Break
41542>>>>>>>>>>>>>                    case (isotimia.poia_metatrepei='') // Polhsh
41545>>>>>>>>>>>>>                        Move Isotimia.Isotimia_Polhsh to Particle.Isotimia
41546>>>>>>>>>>>>>                        Case Break
41547>>>>>>>>>>>>>                    Case (Isotimia.Poia_Metatrepei='F') // Fixing
41550>>>>>>>>>>>>>                        Move Isotimia.Isotimia_Fixing to Particle.Isotimia
41551>>>>>>>>>>>>>                        Case Break
41552>>>>>>>>>>>>>                    Case (Isotimia.Poia_Metatrepei='P') // Private
41555>>>>>>>>>>>>>                        Move Isotimia.Isotimia_Privat to Particle.Isotimia
41556>>>>>>>>>>>>>                        Case Break
41557>>>>>>>>>>>>>                Case End
41557>>>>>>>>>>>>>            End
41557>>>>>>>>>>>>>>
41557>>>>>>>>>>>>>        End
41557>>>>>>>>>>>>>>
41557>>>>>>>>>>>>>        Else Begin
41558>>>>>>>>>>>>>            If (dHmnia='') Sysdate      dHmnia
41561>>>>>>>>>>>>>            Move (Trim(sCode))      to  sCode
41562>>>>>>>>>>>>>            Clear Nomisma
41563>>>>>>>>>>>>>            Move sCode              to Nomisma.Nomisma_Code
41564>>>>>>>>>>>>>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
41565>>>>>>>>>>>>>>
41565>>>>>>>>>>>>>            If (Nomisma.Einai_Drx) Move 1 to Particle.Isotimia
41568>>>>>>>>>>>>>        End
41568>>>>>>>>>>>>>>
41568>>>>>>>>>>>>>    End_Procedure
41569>>>>>>>>>>>>>
41569>>>>>>>>>>>>>    Procedure Update
41570>>>>>>>>>>>>>        String  sCodeApo sCodeEos
41571>>>>>>>>>>>>>        String  sCar sCarDescr sDriver sDriverDescr
41571>>>>>>>>>>>>>        Integer iBreak iPmovesID
41571>>>>>>>>>>>>>        Number  nPoso nPosoEuro nIsotimia
41571>>>>>>>>>>>>>        Date    dHmnia
41571>>>>>>>>>>>>>
41571>>>>>>>>>>>>>        Forward Send Update
41573>>>>>>>>>>>>>
41573>>>>>>>>>>>>>        Send Find_The_Rate
41574>>>>>>>>>>>>>
41574>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to Particle.Company_Code
41575>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Particle.Branch_Code
41576>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to Particle.Year_Year
41577>>>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code   to Particle.Ctypkin_Code
41578>>>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code   to Particle.Wtypkin_Code
41579>>>>>>>>>>>>>        //Move Custprom.Custprom_Code to Particle.Custprom_Code
41579>>>>>>>>>>>>>        Move Clients.Client_ID      to Particle.Client_ID
41580>>>>>>>>>>>>>        Move Ptyppar.Ptyppar_Code   to Particle.Ptyppar_Code
41581>>>>>>>>>>>>>        Move Ptyppar.Ptyppar_Module to Particle.Partl_Module
41582>>>>>>>>>>>>>
41582>>>>>>>>>>>>>        Move Payresp.Presp_ID       to Particle.Presp_ID
41583>>>>>>>>>>>>>
41583>>>>>>>>>>>>>        Send Calc_The_Totals
41584>>>>>>>>>>>>>
41584>>>>>>>>>>>>>        Move    Particle.Oxhma_Code             to sCar
41585>>>>>>>>>>>>>        Get     fsVresOxhmaDescr sCar           to Particle.Oxhma_Descr
41586>>>>>>>>>>>>>        Get     fsVresDriverCode sCar           to Particle.Odhgos_Code
41587>>>>>>>>>>>>>        Move    Particle.Odhgos_Code            to sDriver
41588>>>>>>>>>>>>>        Get     fsVresDriverDescr sDriver       to Particle.Odhgos_Name
41589>>>>>>>>>>>>>        Move    Particle.Antlia_Code            to sCar
41590>>>>>>>>>>>>>        Get     fsVresAntliaDescr sCar          to sCarDescr
41591>>>>>>>>>>>>>        Move    sCarDescr                       to Particle.Antlia_Descr
41592>>>>>>>>>>>>>
41592>>>>>>>>>>>>>        If (Particle.Partl_ExtraVat) Begin
41594>>>>>>>>>>>>>            Clear PartlFpa
41595>>>>>>>>>>>>>            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
41596>>>>>>>>>>>>>            Move Particle.Partl_ExtraVatP   to PartlFpa.Fpa_Pososto
41597>>>>>>>>>>>>>            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
41598>>>>>>>>>>>>>>
41598>>>>>>>>>>>>>            Add Particle.Partl_ExtraVat     to PartlFpa.PartlFpa_Poso
41599>>>>>>>>>>>>>            Saverecord PartlFpa
41600>>>>>>>>>>>>>        End
41600>>>>>>>>>>>>>>
41600>>>>>>>>>>>>>
41600>>>>>>>>>>>>>        If (Particle.Disc_Vat_Poso) Begin
41602>>>>>>>>>>>>>            Clear PartlFpa
41603>>>>>>>>>>>>>            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
41604>>>>>>>>>>>>>            Move Particle.Disc_Vat_Pct      to PartlFpa.Fpa_Pososto
41605>>>>>>>>>>>>>            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
41606>>>>>>>>>>>>>>
41606>>>>>>>>>>>>>            Add Particle.Disc_Vat_Poso      to PartlFpa.PartlFpa_Poso
41607>>>>>>>>>>>>>            Saverecord PartlFpa
41608>>>>>>>>>>>>>        End
41608>>>>>>>>>>>>>>
41608>>>>>>>>>>>>>
41608>>>>>>>>>>>>>        // 01/10/2001 Mphke edo anti gia thn creating gia na kalipsei to problhma
41608>>>>>>>>>>>>>        // pou proekeipte an gia kapoio logo den symplhrvnotan seira kai o arithmos
41608>>>>>>>>>>>>>        // emene 0 eprepe na sbhstoun OLA ta lines kai to idio to parastatiko gia na
41608>>>>>>>>>>>>>        // xanatrexei o kodikas elegxou seiras kai arithmou
41608>>>>>>>>>>>>>        // Tora trexei sthn Update (giati sthn Save_Main_File kanei validation
41608>>>>>>>>>>>>>        // PRIN kai kobei thn eggrafh epeidh o arithmos einai 0
41608>>>>>>>>>>>>>        If ( ((Operation_Origin=Self) Or                 ;             (Operation_Origin=(piPmovesID(Self)))) And  ;             (Particle.Partl_No=0)) Send Kathorise_Thn_Seira
41611>>>>>>>>>>>>>        // 01/10/2001
41611>>>>>>>>>>>>>    End_Procedure   // Update
41612>>>>>>>>>>>>>
41612>>>>>>>>>>>>>    Procedure Backout
41613>>>>>>>>>>>>>        Forward Send Backout
41615>>>>>>>>>>>>>        Send Calc_The_Totals
41616>>>>>>>>>>>>>
41616>>>>>>>>>>>>>        If (Particle.Partl_ExtraVat) Begin
41618>>>>>>>>>>>>>            Clear PartlFpa
41619>>>>>>>>>>>>>            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
41620>>>>>>>>>>>>>            Move Particle.Partl_ExtraVatP   to PartlFpa.Fpa_Pososto
41621>>>>>>>>>>>>>            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
41622>>>>>>>>>>>>>>
41622>>>>>>>>>>>>>            Sub Particle.Partl_ExtraVat   From PartlFpa.PartlFpa_Poso
41623>>>>>>>>>>>>>            Saverecord PartlFpa
41624>>>>>>>>>>>>>            If (PartlFpa.PartlFpa_Poso=0) Delete PartlFpa
41627>>>>>>>>>>>>>        End
41627>>>>>>>>>>>>>>
41627>>>>>>>>>>>>>
41627>>>>>>>>>>>>>        If (Particle.Disc_Vat_Poso) Begin
41629>>>>>>>>>>>>>            Clear PartlFpa
41630>>>>>>>>>>>>>            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
41631>>>>>>>>>>>>>            Move Particle.Disc_Vat_Pct      to PartlFpa.Fpa_Pososto
41632>>>>>>>>>>>>>            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
41633>>>>>>>>>>>>>>
41633>>>>>>>>>>>>>            Sub Particle.Disc_Vat_Poso    From PartlFpa.PartlFpa_Poso
41634>>>>>>>>>>>>>            Saverecord PartlFpa
41635>>>>>>>>>>>>>            If (PartlFpa.PartlFpa_Poso=0) Delete PartlFpa
41638>>>>>>>>>>>>>        End
41638>>>>>>>>>>>>>>
41638>>>>>>>>>>>>>    End_Procedure
41639>>>>>>>>>>>>>
41639>>>>>>>>>>>>>    Procedure Kathorise_Thn_Seira
41640>>>>>>>>>>>>>        Integer iNextNo iSeiraRecnum iPtypparRecnum
41641>>>>>>>>>>>>>
41641>>>>>>>>>>>>>//       js 25/04/2002 Prosthikh gia na ypostirixei ektyposh promhtheyton
41641>>>>>>>>>>>>>        If (Ptyppar.Ptyppar_Is_What='2') Begin
41643>>>>>>>>>>>>>            Clear Pseira
41644>>>>>>>>>>>>>            Move SysCurXr.Company_Code  to Pseira.Company_Code
41645>>>>>>>>>>>>>            Move SysCurXr.Branch_Code   to Pseira.Branch_Code
41646>>>>>>>>>>>>>            //Move SysCurXr.Year_Year     to Pseira.Year_Year
41646>>>>>>>>>>>>>            //Move Ctypkin.Ctypkin_Code   to Pseira.Ctypkin_Code
41646>>>>>>>>>>>>>            //Move Wtypkin.Wtypkin_Code   to Pseira.Wtypkin_Code
41646>>>>>>>>>>>>>            Move Ptyppar.Ptyppar_Code   to Pseira.Ptyppar_Code
41647>>>>>>>>>>>>>            Move Particle.Pseira_Seira  to Pseira.Pseira_Seira
41648>>>>>>>>>>>>>            Find eq Pseira By Index.1 // Pseira:Index.1:Company_Code+Branch_Code+Year_Year+;
41649>>>>>>>>>>>>>>
41649>>>>>>>>>>>>>                                    //                Ctypkin_Code+Wtypkin_Code+Ptyppar_Code+Seira_Seira
41649>>>>>>>>>>>>>            If (Found=1) Begin
41651>>>>>>>>>>>>>                // €¤ ž ©œ ¨˜ œ ¤˜  autonum ¡˜  «¦ §˜¨˜©«˜« ¡¦ œ ¤˜  «¬§¦¬ 2 —Š†‘†
41651>>>>>>>>>>>>>                If ((Pseira.Pseira_Autonum  = 1)    And ;                    (Particle.Partl_No      = 0 )) Begin
41653>>>>>>>>>>>>>                    Move (Pseira.Autonum_Minus-1) to iNextNo
41654>>>>>>>>>>>>>                    Move (Pseira.Autonum_Minus-1) to Pseira.Autonum_Minus
41655>>>>>>>>>>>>>                    Saverecord Pseira
41656>>>>>>>>>>>>>                    Move iNextNo to Particle.Partl_No
41657>>>>>>>>>>>>>                End
41657>>>>>>>>>>>>>>
41657>>>>>>>>>>>>>            End
41657>>>>>>>>>>>>>>
41657>>>>>>>>>>>>>        End
41657>>>>>>>>>>>>>>
41657>>>>>>>>>>>>>        Else Begin
41658>>>>>>>>>>>>>//       js 25/04/2002 Prosthikh gia na ypostirixei ektyposh promhtheyton
41658>>>>>>>>>>>>>            If ((Ptyppar.Ptyppar_Is_What='1') And (Trim(Ptyppar.Sysxet_Ptyppar)<>'')) Begin
41660>>>>>>>>>>>>>                Move (Random(-10000000)-1) To Particle.Partl_No
41661>>>>>>>>>>>>>            End
41661>>>>>>>>>>>>>>
41661>>>>>>>>>>>>>        End
41661>>>>>>>>>>>>>>
41661>>>>>>>>>>>>>    End_Procedure
41662>>>>>>>>>>>>>
41662>>>>>>>>>>>>>    Procedure Creating
41663>>>>>>>>>>>>>        Integer iNextNo
41664>>>>>>>>>>>>>        String  sNo sSeira
41664>>>>>>>>>>>>>        Forward Send Creating
41666>>>>>>>>>>>>>        // Insert Code Here
41666>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                         (Trim(String(Particle.Partl_Rec0)))))) to Particle.Partl_Recr
41667>>>>>>>>>>>>>
41667>>>>>>>>>>>>>        If (Particle.Disc_Vat_Pct   =0) Move 18 to Particle.Disc_Vat_Pct
41670>>>>>>>>>>>>>        If (Particle.Partl_ExtraVatP=0) Move 18 to Particle.Partl_ExtraVatP
41673>>>>>>>>>>>>>
41673>>>>>>>>>>>>>        Move Clients.Ypoloipo to Particle.Prohg_Ypol
41674>>>>>>>>>>>>>
41674>>>>>>>>>>>>>        If ((Trim(Ptyppar.Ti_Typonei_Pms)<>'2') And (Trim(Particle.Cn_Code)<>'')) Begin
41676>>>>>>>>>>>>>            Clear Cn
41677>>>>>>>>>>>>>            Move Particle.Cn_Code   to Cn.Cn_Code
41678>>>>>>>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
41679>>>>>>>>>>>>>>
41679>>>>>>>>>>>>>            If (Found) Begin
41681>>>>>>>>>>>>>                Move Particle.Partl_No      to sNo
41682>>>>>>>>>>>>>                Move Particle.Pseira_Seira  to sSeira
41683>>>>>>>>>>>>>                Move (Trim(sNo))            to sNo
41684>>>>>>>>>>>>>                Move (Trim(sSeira))         to sSeira
41685>>>>>>>>>>>>>                if (cn.hm_prot_fortio='')   Move Particle.Partl_Hmnia   to Cn.Hm_prot_Fortio
41688>>>>>>>>>>>>>                Move Particle.Partl_Hmnia   to Cn.Hm_Tel_Fortio
41689>>>>>>>>>>>>>                Move (Trim(sSeira+' '+sNo)) to Cn.Tel_Fortio_No
41690>>>>>>>>>>>>>                Saverecord CN
41691>>>>>>>>>>>>>            End
41691>>>>>>>>>>>>>>
41691>>>>>>>>>>>>>        End
41691>>>>>>>>>>>>>>
41691>>>>>>>>>>>>>    End_Procedure   // Creating
41692>>>>>>>>>>>>>
41692>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
41693>>>>>>>>>>>>>        String sStr
41694>>>>>>>>>>>>>        Move '' to sStr
41695>>>>>>>>>>>>>        Append sStr "DDC 14: ’¦ §˜¨˜©«˜« ¡æ §œ¨ â®œ  œ¤˜ œå›¦ª «¦ ¦§¦å¦\n"
41696>>>>>>>>>>>>>        Append sStr "§˜¨¦¬© áœ  ¡å¤ž©ž §¨¦ª £œ«˜©®ž£˜« ©£æ ˜§¦ «¦¤ ®¨ã©«ž\n"
41697>>>>>>>>>>>>>        Append sStr Particle.Partl_Toposf ". ˜«ã©«œ F5 £œ«˜ «¦ Ž‰"
41699>>>>>>>>>>>>>
41699>>>>>>>>>>>>>             If (iError_Num = 1001) Error 1001 "DDC 14: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ˜¨˜©«˜« ¡¦ç"
41702>>>>>>>>>>>>>        Else If (iError_Num = 1002) Error 1002 "DDC 14: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ”¦¨â˜"
41706>>>>>>>>>>>>>        Else If (iError_Num = 1003) Error 1003 "DDC 14: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã Œ¦£å©£˜«¦ª"
41710>>>>>>>>>>>>>        Else If (iError_Num = 1004) Error 1004 "DDC 14: †£œ¨¦£ž¤å˜ §˜¨˜©«˜« ¡¦ç ¡œ¤ã"
41714>>>>>>>>>>>>>        Else If (iError_Num = 1005) Error 1005 "DDC 14: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
41718>>>>>>>>>>>>>        Else If (iError_Num = 1006) Error 1006 "DDC 14: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
41722>>>>>>>>>>>>>        Else If (iError_Num = 1007) Error 1007 "DDC 14: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
41726>>>>>>>>>>>>>        Else If (iError_Num = 1008) Error 1008 "DDC 14: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
41730>>>>>>>>>>>>>        Else If (iError_Num = 1009) Error 1009 "DDC 14: ƒœ¤ œå¤˜  œ­ ¡«ã ž › ˜š¨˜­ã \n„®œ  ›ž£ ¦¬¨šžŸœå £œ«˜©®ž£˜« ©£â¤¦ §˜¨˜©«˜« ¡æ"
41734>>>>>>>>>>>>>        Else If (iError_Num = 1010) Error 1010 "DDC 14: † é¨˜ §¨â§œ  ¤˜ ›¦Ÿœå\n£œ 2 ¯ž­å˜ š ˜ «ž¤ é¨˜ ¡˜  2 š ˜ «˜ ¢œ§«á"
41738>>>>>>>>>>>>>        Else If (iError_Num = 1011) Error 1011 "DDC 14: †£œ¨¦£ž¤å˜ §¨¦šœ¤â©«œ¨ž «žª «œ¢œ¬«˜å˜ª œ¡«ç§à©žª"
41742>>>>>>>>>>>>>        Else If (iError_Num = 1012) Error 1012 sStr
41746>>>>>>>>>>>>>        Else If (iError_Num = 1055) Error 1055 "DDC 14: †£œ¨¦£ž¤åœª œ¡«æª ¦¨åà¤ ®¨ã©žª"
41750>>>>>>>>>>>>>        Else If (iError_Num = 1060) Error 1060 "DDC 14: ˜¨˜©«˜« ¡æ £œ«˜©®ž£˜« ©£â¤¦.\nƒœ¤ œ§ «¨â§œ«˜  ¦§¦ ˜›ã§¦«œ ˜¢¢˜šã ©«¦ ®œåà¤"
41754>>>>>>>>>>>>>        Else If (iError_Num = 1061) Error 1061 "DDC 14: ˜¨˜©«˜« ¡æ £œ«˜©®ž£˜« ©£â¤¦.\nƒœ¤ œ§ «¨â§œ«˜  ¤˜ › ˜š¨˜­œå"
41758>>>>>>>>>>>>>        Else If (iError_Num = 6040) Error 6040 "DDC 14: ƒœ¤ â®œ  §¨¦©› ¦¨ ©«œå ¡à› ¡æª ¤¦£å©£˜«¦ª"
41762>>>>>>>>>>>>>        Else If (iError_Num = 6050) Error 6050 "DDC 14: Ž œ¢á«žª ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž"
41766>>>>>>>>>>>>>        Else If (iError_Num = 6051) Error 6051 "DDC 14: ’¦ §˜¨˜©«˜« ¡æ ¡ ¤œå ˜¥åœª ˜¢¢á «¦ ©ç¤¦¢¦ «à¤ ˜¥ é¤ «¦¬ œå¤˜  £ž›œ¤ ¡æ"
41770>>>>>>>>>>>>>        Else If (iError_Num = 6060) Error 6060 "DDC 14: Ž “§œçŸ¬¤¦ª ¢ž¨à£é¤ ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž"
41774>>>>>>>>>>>>>        Else If (iError_Num = 1110) Error 1110 "DDC 14: †£/¤å˜ §˜¨˜©«˜« ¡¦ç <= †£/¤å˜ª ¡¢œ ©å£˜«¦ª\nƒœ¤ œ§ «¨â§œ«˜  ¡˜££å˜ «¨¦§¦§¦åž©ž ©«¦ §˜¨˜©«˜« ¡æ"
41778>>>>>>>>>>>>>        Else If (iError_Num = 1065) Error 1065 "DDC 14: Ž €¨ Ÿ£æª «¦¬ §˜¨˜©«˜« ¡¦ç \nƒ„Œ §¨â§œ  ¡˜  ›œ¤ £§¦¨œå ¤˜ œå¤˜  £ž›œ¤ ¡æª"
41782>>>>>>>>>>>>>        Else Forward Send Operation_Not_Allowed  iError_Num
41785>>>>>>>>>>>>>    End_Procedure   // Operation_Not_Allowed
41786>>>>>>>>>>>>>
41786>>>>>>>>>>>>>    Function Validate_Save Returns Integer
41787>>>>>>>>>>>>>        Number nqty
41788>>>>>>>>>>>>>        Integer iReturnVal iYes
41788>>>>>>>>>>>>>        String  sCurrentUserID sOldUserID
41788>>>>>>>>>>>>>
41788>>>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
41790>>>>>>>>>>>>>
41790>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
41792>>>>>>>>>>>>>                 If (Ptyppar.Recnum      = 0)   Move 1001 to iReturnVal
41795>>>>>>>>>>>>>            Else If (Clients.Recnum      = 0)   Move 1002 to iReturnVal
41799>>>>>>>>>>>>>            Else If (Nomisma.Recnum      = 0)   Move 1003 to iReturnVal
41803>>>>>>>>>>>>>            Else If (Particle.Partl_Hmnia='')   Move 1004 to iReturnVal
41807>>>>>>>>>>>>>            Else If  Nomisma.nomisma_Code eq '' Move 6040 to iReturnVal
41811>>>>>>>>>>>>>            Else Begin
41812>>>>>>>>>>>>>//                If ((Clients.Plafon>0) And (Clients.OverHead<1) And (Sysfile.Over_OverHead<>'1')) Begin
41812>>>>>>>>>>>>>//                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
41812>>>>>>>>>>>>>//                    If (iYes=MBR_NO) Move 6050 to iReturnVal
41812>>>>>>>>>>>>>//                End
41812>>>>>>>>>>>>>//                Else If ((Clients.Plafon>0) And (PayResp.Plafon>0) And (PayResp.OverHead<1) And (Sysfile.Over_OverHead<>'1')) Begin
41812>>>>>>>>>>>>>//                    Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
41812>>>>>>>>>>>>>//                    If (iYes=MBR_NO) Move 6060 to iReturnVal
41812>>>>>>>>>>>>>//                End
41812>>>>>>>>>>>>>//                Else If ((PayResp.Plafon>0) And (PayResp.OverHead<1) And (Sysfile.Over_OverHead<>'1')) begin
41812>>>>>>>>>>>>>//                    Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
41812>>>>>>>>>>>>>//                    If (iYes=MBR_NO) Move 6060 to iReturnVal
41812>>>>>>>>>>>>>//                End
41812>>>>>>>>>>>>>
41812>>>>>>>>>>>>>                If ((Particle.Partl_Hmnia<SYSCURXR.YEAR_XRHSHFROM) Or ;                    (Particle.Partl_Hmnia>SYSCURXR.YEAR_XRHSHTO))     ;                                                Move 1055 to iReturnVal
41815>>>>>>>>>>>>>                Else Begin
41816>>>>>>>>>>>>>                    If (Particle.Partl_Disctof<>0) Begin
41818>>>>>>>>>>>>>                        Get fsLoginUserID to sCurrentUserID
41819>>>>>>>>>>>>>                        Get psOldUserID   to sOldUserID
41820>>>>>>>>>>>>>                        If (sOldUserID<>'') Begin
41822>>>>>>>>>>>>>                            If (sOldUserID<>sCurrentUserID) Move 1012 to iReturnVal
41825>>>>>>>>>>>>>                        End
41825>>>>>>>>>>>>>>
41825>>>>>>>>>>>>>                        //Else Move sCurrentUserID to Particle.Partl_Toposf
41825>>>>>>>>>>>>>                    End
41825>>>>>>>>>>>>>>
41825>>>>>>>>>>>>>                    //Else Move '' to Particle.Partl_Toposf
41825>>>>>>>>>>>>>                End
41825>>>>>>>>>>>>>>
41825>>>>>>>>>>>>>            End
41825>>>>>>>>>>>>>>
41825>>>>>>>>>>>>>/////////////////////////////////////////////////////////////////////////////
41825>>>>>>>>>>>>>// js 26/08/2002 Erothsh: Pos tha piaso ena parastatiko to opoio kinei
41825>>>>>>>>>>>>>//               axies alla katalhgei na exei geniko synolo 0 (an p.x.
41825>>>>>>>>>>>>>//               ginoun ekptoseis 100%.
41825>>>>>>>>>>>>>//               Apanthsh: To piano edo me ton oro oti den mporei na kopsei
41825>>>>>>>>>>>>>//               timologio m'ena eidos mono to opoio exei ekptosh 100%, opote
41825>>>>>>>>>>>>>//               ef'oson tha yparxoun pano apo ena eidos, to eidos me thn
41825>>>>>>>>>>>>>//               ekptosh prepei na kataxorithei san 2o kai meta.POTE proto
41825>>>>>>>>>>>>>//               giati etsi tha exei 0 to synolo tou parastatikou kai tha
41825>>>>>>>>>>>>>//               varesei to validation.
41825>>>>>>>>>>>>>
41825>>>>>>>>>>>>>// Rem giati sthn fash metasxhmatismou apo DAP se TIM den yparxoun times sto DAP
41825>>>>>>>>>>>>>// opote kai to TIM pou paragetai den exei times (Eno leme pos TIM xoris times den ginetai
41825>>>>>>>>>>>>>// Bebaia edo mporoume na elegxoume epipleon an to paragomeno erxetai apo metasxhmatismo
41825>>>>>>>>>>>>>// opote kai tha to afhname. NA TO DOUME.
41825>>>>>>>>>>>>>//            Else If ((Sysfile.Mhdeniko_Partl=0) And (Ptyppar.Ti_Typonei_Pms<>'1') And ;
41825>>>>>>>>>>>>>//                     (Particle.Partl_Payam=0)   And (Particle.Partl_NoOfLines>0)) ;
41825>>>>>>>>>>>>>//                    Move 6051 to iReturnVal
41825>>>>>>>>>>>>>
41825>>>>>>>>>>>>>/////////////////////////////////////////////////////////////////////////////
41825>>>>>>>>>>>>>
41825>>>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
41828>>>>>>>>>>>>>        End
41828>>>>>>>>>>>>>>
41828>>>>>>>>>>>>>        Function_Return iReturnVal
41829>>>>>>>>>>>>>    End_Function   // Validate_Save
41830>>>>>>>>>>>>>
41830>>>>>>>>>>>>>
41830>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
41831>>>>>>>>>>>>>        Integer iReturnVal
41832>>>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
41834>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
41836>>>>>>>>>>>>>            If (Particle.Partl_Timol = 1) Move 1009 to iReturnVal
41839>>>>>>>>>>>>>            Else If ( (Sysfile.Hm_Kleisimatos<>'') And ;                      (Particle.Partl_Hmnia<=Sysfile.Hm_Kleisimatos) ) ;                     Move 1110 to iReturnVal
41843>>>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
41846>>>>>>>>>>>>>        End
41846>>>>>>>>>>>>>>
41846>>>>>>>>>>>>>        Function_Return iReturnVal
41847>>>>>>>>>>>>>    End_Function   // Validate_Delete
41848>>>>>>>>>>>>>
41848>>>>>>>>>>>>>
41848>>>>>>>>>>>>>    // Define_Fields:
41848>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41848>>>>>>>>>>>>>
41848>>>>>>>>>>>>>    Procedure Define_Fields
41849>>>>>>>>>>>>>        Forward Send Define_Fields
41851>>>>>>>>>>>>>        //DDB-Generated-Code-Location
41851>>>>>>>>>>>>>        //DDB-DefineFieldStart
41851>>>>>>>>>>>>>
41851>>>>>>>>>>>>>        Set Main_File            To Particle.File_Number
41852>>>>>>>>>>>>>
41852>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
41853>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
41854>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41855>>>>>>>>>>>>>
41855>>>>>>>>>>>>>        // Child (Client) file structure................
41855>>>>>>>>>>>>>        Send Add_Client_File  Pmoves.File_Number
41856>>>>>>>>>>>>>        Send Add_Client_File  Tparticl.File_Number
41857>>>>>>>>>>>>>        Send Add_Client_File  Partlfpa.File_Number
41858>>>>>>>>>>>>>        Send Add_Client_File  Pmovesl.File_Number
41859>>>>>>>>>>>>>        Send Add_Client_File  Psxetika.File_Number
41860>>>>>>>>>>>>>
41860>>>>>>>>>>>>>        // Parent (Server) file structure...............
41860>>>>>>>>>>>>>        Send Add_Server_File  Clients.File_Number
41861>>>>>>>>>>>>>        Send Add_Server_File  Ptyppar.File_Number
41862>>>>>>>>>>>>>        Send Add_Server_File  Nomisma.File_Number
41863>>>>>>>>>>>>>
41863>>>>>>>>>>>>>        // External (System) file structure.............
41863>>>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
41864>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
41865>>>>>>>>>>>>>        Send Add_System_File  Pseira.File_Number  DD_LOCK_ON_ALL
41866>>>>>>>>>>>>>        Send Add_System_File  Cn.File_Number  DD_LOCK_ON_ALL
41867>>>>>>>>>>>>>        Send Add_System_File  Partlfpa.File_Number  DD_LOCK_ON_ALL
41868>>>>>>>>>>>>>        Send Add_System_File  Clorder.File_Number  DD_LOCK_ON_ALL
41869>>>>>>>>>>>>>        Send Add_System_File  Clorderd.File_Number  DD_LOCK_ON_ALL
41870>>>>>>>>>>>>>        Send Add_System_File  Ypoprosf.File_Number  DD_LOCK_ON_ALL
41871>>>>>>>>>>>>>        Send Add_System_File  Psxetika.File_Number  DD_LOCK_ON_ALL
41872>>>>>>>>>>>>>        Send Add_System_File  Pmoves.File_Number  DD_LOCK_ON_ALL
41873>>>>>>>>>>>>>
41873>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Particle_Rec0  To Particle.Partl_Rec0
41876>>>>>>>>>>>>>
41876>>>>>>>>>>>>>        // Field-based properties.......................
41876>>>>>>>>>>>>>
41876>>>>>>>>>>>>>        // Particle.Company_Code
41876>>>>>>>>>>>>>
41876>>>>>>>>>>>>>        // Particle.Branch_Code
41876>>>>>>>>>>>>>
41876>>>>>>>>>>>>>        // Particle.Year_Year
41876>>>>>>>>>>>>>
41876>>>>>>>>>>>>>        // Particle.Ctypkin_Code
41876>>>>>>>>>>>>>
41876>>>>>>>>>>>>>        // Particle.Wtypkin_Code
41876>>>>>>>>>>>>>
41876>>>>>>>>>>>>>        // Particle.Ptyppar_Code
41876>>>>>>>>>>>>>
41876>>>>>>>>>>>>>        // Particle.Pseira_Seira
41876>>>>>>>>>>>>>
41876>>>>>>>>>>>>>        // Particle.Custprom_Code
41876>>>>>>>>>>>>>
41876>>>>>>>>>>>>>        // Particle.Client_Id
41876>>>>>>>>>>>>>
41876>>>>>>>>>>>>>        // Particle.Partl_No
41876>>>>>>>>>>>>>
41876>>>>>>>>>>>>>        // Particle.Cn_Recr
41876>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Cn_Recr To (sl041(Self))
41877>>>>>>>>>>>>>
41877>>>>>>>>>>>>>        // Particle.Pseira_Recr
41877>>>>>>>>>>>>>
41877>>>>>>>>>>>>>        // Particle.Partl_Hmnia
41877>>>>>>>>>>>>>        Set Field_Entry_msg        Field Particle.Partl_Hmnia To Shmera
41878>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Partl_Hmnia To (sl014(Self))
41879>>>>>>>>>>>>>
41879>>>>>>>>>>>>>        // Particle.Partl_Rec0
41879>>>>>>>>>>>>>        Set Field_Options          Field Particle.Partl_Rec0 To DD_AUTOFIND
41880>>>>>>>>>>>>>
41880>>>>>>>>>>>>>        // Particle.Partl_Lastno
41880>>>>>>>>>>>>>
41880>>>>>>>>>>>>>        // Particle.Partl_Tdiakin
41880>>>>>>>>>>>>>
41880>>>>>>>>>>>>>        // Particle.Partl_Car
41880>>>>>>>>>>>>>
41880>>>>>>>>>>>>>        // Particle.Partl_Reldoc
41880>>>>>>>>>>>>>
41880>>>>>>>>>>>>>        // Particle.Partl_Toposf
41880>>>>>>>>>>>>>
41880>>>>>>>>>>>>>        // Particle.Partl_Toposa
41880>>>>>>>>>>>>>
41880>>>>>>>>>>>>>        // Particle.Partl_Troposa
41880>>>>>>>>>>>>>
41880>>>>>>>>>>>>>        // Particle.Partl_Tof
41880>>>>>>>>>>>>>
41880>>>>>>>>>>>>>        // Particle.Partl_Disctof
41880>>>>>>>>>>>>>
41880>>>>>>>>>>>>>        // Particle.Partl_Disccl
41880>>>>>>>>>>>>>
41880>>>>>>>>>>>>>        // Particle.Partl_Autodisc
41880>>>>>>>>>>>>>
41880>>>>>>>>>>>>>        // Particle.Partl_Time
41880>>>>>>>>>>>>>
41880>>>>>>>>>>>>>        // Particle.Partl_Totambd
41880>>>>>>>>>>>>>
41880>>>>>>>>>>>>>        // Particle.Partl_Amdiscpms
41880>>>>>>>>>>>>>
41880>>>>>>>>>>>>>        // Particle.Partl_Totdiscpc
41880>>>>>>>>>>>>>
41880>>>>>>>>>>>>>        // Particle.Partl_Discam
41880>>>>>>>>>>>>>
41880>>>>>>>>>>>>>        // Particle.Partl_Totamad
41880>>>>>>>>>>>>>
41880>>>>>>>>>>>>>        // Particle.Partl_Vatpct
41880>>>>>>>>>>>>>
41880>>>>>>>>>>>>>        // Particle.Partl_Vatam
41880>>>>>>>>>>>>>
41880>>>>>>>>>>>>>        // Particle.Partl_Genam
41880>>>>>>>>>>>>>
41880>>>>>>>>>>>>>        // Particle.Partl_Extra
41880>>>>>>>>>>>>>
41880>>>>>>>>>>>>>        // Particle.Partl_Extravatp
41880>>>>>>>>>>>>>
41880>>>>>>>>>>>>>        // Particle.Partl_Extravat
41880>>>>>>>>>>>>>
41880>>>>>>>>>>>>>        // Particle.Partl_Payam
41880>>>>>>>>>>>>>
41880>>>>>>>>>>>>>        // Particle.Partl_Befypol
41880>>>>>>>>>>>>>
41880>>>>>>>>>>>>>        // Particle.Partl_Currypol
41880>>>>>>>>>>>>>
41880>>>>>>>>>>>>>        // Particle.Partl_Tottem
41880>>>>>>>>>>>>>
41880>>>>>>>>>>>>>        // Particle.Partl_Det
41880>>>>>>>>>>>>>
41880>>>>>>>>>>>>>        // Particle.Partl_Recr
41880>>>>>>>>>>>>>        Set Field_Options          Field Particle.Partl_Recr To DD_AUTOFIND
41881>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Partl_Recr To (sl014(Self))
41882>>>>>>>>>>>>>
41882>>>>>>>>>>>>>        // Particle.Cn_Code
41882>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Cn_Code To (sl041(Self))
41883>>>>>>>>>>>>>
41883>>>>>>>>>>>>>        // Particle.Client_Recr
41883>>>>>>>>>>>>>
41883>>>>>>>>>>>>>        // Particle.Ptyppar_Recr
41883>>>>>>>>>>>>>
41883>>>>>>>>>>>>>        // Particle.Partl_Ekleise
41883>>>>>>>>>>>>>
41883>>>>>>>>>>>>>        // Particle.Partl_Ekl_Recr
41883>>>>>>>>>>>>>
41883>>>>>>>>>>>>>        // Particle.Partl_Ektyposh
41883>>>>>>>>>>>>>
41883>>>>>>>>>>>>>        // Particle.Partl_Akyrosh
41883>>>>>>>>>>>>>
41883>>>>>>>>>>>>>        // Particle.Partl_Akyr_Recr
41883>>>>>>>>>>>>>
41883>>>>>>>>>>>>>        // Particle.Partl_Nooflines
41883>>>>>>>>>>>>>
41883>>>>>>>>>>>>>        // Particle.Cmoves_Recr
41883>>>>>>>>>>>>>
41883>>>>>>>>>>>>>        // Particle.Nomisma_Code
41883>>>>>>>>>>>>>
41883>>>>>>>>>>>>>        // Particle.Isotimia
41883>>>>>>>>>>>>>
41883>>>>>>>>>>>>>        // Particle.Wcmoves_Recr
41883>>>>>>>>>>>>>
41883>>>>>>>>>>>>>        // Particle.Partl_Module
41883>>>>>>>>>>>>>
41883>>>>>>>>>>>>>        // Particle.Partl_Timol
41883>>>>>>>>>>>>>        Set Field_Mask             Field Particle.Partl_Timol To "#"
41884>>>>>>>>>>>>>        Set Field_Mask_Type        Field Particle.Partl_Timol To MASK_NUMERIC_WINDOW
41885>>>>>>>>>>>>>
41885>>>>>>>>>>>>>        // Particle.Partl_Selected
41885>>>>>>>>>>>>>
41885>>>>>>>>>>>>>        // Particle.Partl_Tim_Recr
41885>>>>>>>>>>>>>
41885>>>>>>>>>>>>>        // Particle.Partl_Vsn
41885>>>>>>>>>>>>>
41885>>>>>>>>>>>>>        // Particle.Sls_Id
41885>>>>>>>>>>>>>
41885>>>>>>>>>>>>>        // Particle.Presp_Id
41885>>>>>>>>>>>>>
41885>>>>>>>>>>>>>        // Particle.Cnt_Id
41885>>>>>>>>>>>>>
41885>>>>>>>>>>>>>        // Particle.Topos_Apostolhs
41885>>>>>>>>>>>>>
41885>>>>>>>>>>>>>        // Particle.Tropos_Diakin
41885>>>>>>>>>>>>>        Set Field_Class_Name       Field Particle.Tropos_Diakin To "dbComboFormsub"
41886>>>>>>>>>>>>>        Set Field_Value_Table      Field Particle.Tropos_Diakin To (Particle_Tropos_Diakin_VT(Self))
41887>>>>>>>>>>>>>
41887>>>>>>>>>>>>>        // Particle.Ora_Apostolhs
41887>>>>>>>>>>>>>        Set Field_Entry_msg        Field Particle.Ora_Apostolhs To Shmera_Ora_String
41888>>>>>>>>>>>>>        Set Field_Mask             Field Particle.Ora_Apostolhs To "##:##"
41889>>>>>>>>>>>>>
41889>>>>>>>>>>>>>        // Particle.Skopos_Diakin
41889>>>>>>>>>>>>>        Set Field_Class_Name       Field Particle.Skopos_Diakin To "dbComboFormsub"
41890>>>>>>>>>>>>>        Set Field_Value_Table      Field Particle.Skopos_Diakin To (Particle_Skopos_Diakin_VT(Self))
41891>>>>>>>>>>>>>
41891>>>>>>>>>>>>>        // Particle.Tropos_Plhromhs
41891>>>>>>>>>>>>>        Set Field_Value_Table      Field Particle.Tropos_Plhromhs To (Particle_Tropos_Plhromhs_VT(Self))
41892>>>>>>>>>>>>>
41892>>>>>>>>>>>>>        // Particle.Odhgos_Code
41892>>>>>>>>>>>>>
41892>>>>>>>>>>>>>        // Particle.Odhgos_Name
41892>>>>>>>>>>>>>
41892>>>>>>>>>>>>>        // Particle.Oxhma_Code
41892>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Oxhma_Code To (sl054(Self))
41893>>>>>>>>>>>>>
41893>>>>>>>>>>>>>        // Particle.Oxhma_Descr
41893>>>>>>>>>>>>>
41893>>>>>>>>>>>>>        // Particle.Antlia_Code
41893>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Antlia_Code To (sl053(Self))
41894>>>>>>>>>>>>>
41894>>>>>>>>>>>>>        // Particle.Antlia_Descr
41894>>>>>>>>>>>>>
41894>>>>>>>>>>>>>        // Particle.Partl_Euro
41894>>>>>>>>>>>>>
41894>>>>>>>>>>>>>        // Particle.Disc_Vat_Pct
41894>>>>>>>>>>>>>
41894>>>>>>>>>>>>>        // Particle.Disc_Vat_Poso
41894>>>>>>>>>>>>>
41894>>>>>>>>>>>>>        // Particle.Total_Vat_Poso
41894>>>>>>>>>>>>>
41894>>>>>>>>>>>>>        // Particle.Exei_Sxetika
41894>>>>>>>>>>>>>
41894>>>>>>>>>>>>>        // Particle.Aitiol
41894>>>>>>>>>>>>>
41894>>>>>>>>>>>>>        // Particle.Max_Days_Date
41894>>>>>>>>>>>>>
41894>>>>>>>>>>>>>        // Particle.Timol_Qty
41894>>>>>>>>>>>>>
41894>>>>>>>>>>>>>        // Particle.Timol_Ypol
41894>>>>>>>>>>>>>
41894>>>>>>>>>>>>>        // Particle.Epilogh_Ekkrem
41894>>>>>>>>>>>>>
41894>>>>>>>>>>>>>        // Particle.No_Print_Module
41894>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Particle.No_Print_Module To "Œ˜ £ž¤ «¬§é¤œ«˜  (˜§¦ ˜¢¢¦ ¡ç¡¢à£˜ §.®.§˜¨˜š ©œ ¨¦£)"
41894>>>>>>>>>>>>>
41894>>>>>>>>>>>>>        // Particle.Prohg_Ypol
41894>>>>>>>>>>>>>
41894>>>>>>>>>>>>>        // Particle.Trex_Ypol
41894>>>>>>>>>>>>>
41894>>>>>>>>>>>>>        // Particle.Parakrat_Pct
41894>>>>>>>>>>>>>
41894>>>>>>>>>>>>>        // Particle.Parakrat_Poso
41894>>>>>>>>>>>>>
41894>>>>>>>>>>>>>        // Particle.Cms_Parak_Recr
41894>>>>>>>>>>>>>
41894>>>>>>>>>>>>>        // Particle.Enhm_Logik
41894>>>>>>>>>>>>>
41894>>>>>>>>>>>>>        // Particle.Se_Logik
41894>>>>>>>>>>>>>
41894>>>>>>>>>>>>>        // Particle.Akyro
41894>>>>>>>>>>>>>
41894>>>>>>>>>>>>>        // Particle.Zone_Id
41894>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Zone_Id To (sl064(Self))
41895>>>>>>>>>>>>>
41895>>>>>>>>>>>>>        //DDB-DefineFieldEnd
41895>>>>>>>>>>>>>    End_Procedure    // Define_Fields
41896>>>>>>>>>>>>>
41896>>>>>>>>>>>>>    // Field_Defaults:
41896>>>>>>>>>>>>>    // This procedure is used to establish default field values.
41896>>>>>>>>>>>>>
41896>>>>>>>>>>>>>    Procedure Field_Defaults
41897>>>>>>>>>>>>>        Forward Send Field_Defaults
41899>>>>>>>>>>>>>        //DDB-Generated-Code-Location
41899>>>>>>>>>>>>>        //DDB-FieldDefaultStart
41899>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
41899>>>>>>>>>>>>>        Set Field_Changed_Value Field Particle.Nomisma_Code to SyscurXr.C_Code0
41900>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
41901>>>>>>>>>>>>>
41901>>>>>>>>>>>>>End_Class    // Particle_DataDictionary
41902>>>>>>>>>>>>>//DDB-Selection-pkg-Start
41902>>>>>>>>>>>>>
41902>>>>>>>>>>>>>Use sl041.SL         // sl041
INCLUDING FILE: SL041.SL
41902>>>>>>>>>>>>>>>//AB/ Project CN : sl041
41902>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
41902>>>>>>>>>>>>>>>//AB/         Set ProjectName to "CN : sl041"
41902>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl041.SL"
41902>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
41902>>>>>>>>>>>>>>>
41902>>>>>>>>>>>>>>>// Project Object Structure
41902>>>>>>>>>>>>>>>//   sl041 is a dbModalPanelSub
41902>>>>>>>>>>>>>>>//     Clients_DD is a DataDictionary
41902>>>>>>>>>>>>>>>//     Cn_DD is a DataDictionary
41902>>>>>>>>>>>>>>>//     oSelList is a dbListSub
41902>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
41902>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
41902>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
41902>>>>>>>>>>>>>>>
41902>>>>>>>>>>>>>>>// Register all objects
41902>>>>>>>>>>>>>>>Register_Object Clients_DD
41902>>>>>>>>>>>>>>>Register_Object Cn_DD
41902>>>>>>>>>>>>>>>Register_Object oCancel_bn
41902>>>>>>>>>>>>>>>Register_Object oOK_bn
41902>>>>>>>>>>>>>>>Register_Object oSearch_bn
41902>>>>>>>>>>>>>>>Register_Object oSelList
41902>>>>>>>>>>>>>>>Register_Object sl041
41902>>>>>>>>>>>>>>>
41902>>>>>>>>>>>>>>>
41902>>>>>>>>>>>>>>>    //AB-IgnoreStart
41902>>>>>>>>>>>>>>>
41902>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
41902>>>>>>>>>>>>>>>    Use dbList.Sub
41902>>>>>>>>>>>>>>>    Use Button.Sub
41902>>>>>>>>>>>>>>>
41902>>>>>>>>>>>>>>>
41902>>>>>>>>>>>>>>>    Use CLIENTS.DD
41902>>>>>>>>>>>>>>>    Use CN.DD
INCLUDING FILE: CN.DD
41902>>>>>>>>>>>>>>>>>//DDB-FileStart
41902>>>>>>>>>>>>>>>>>//DDB-HeaderStart
41902>>>>>>>>>>>>>>>>>
41902>>>>>>>>>>>>>>>>>// File Name : CN.DD
41902>>>>>>>>>>>>>>>>>// Class Name: Cn_DataDictionary
41902>>>>>>>>>>>>>>>>>// Revision  : 89
41902>>>>>>>>>>>>>>>>>// Version   : 2
41902>>>>>>>>>>>>>>>>>
41902>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
41902>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
41902>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41902>>>>>>>>>>>>>>>>>
41902>>>>>>>>>>>>>>>>>Open Cn
41904>>>>>>>>>>>>>>>>>Open Cnzones
INCLUDING FILE: CNZONES.FD
41906>>>>>>>>>>>>>>>>>Open Tperga
INCLUDING FILE: TPERGA.FD
41908>>>>>>>>>>>>>>>>>Open Btnordh
INCLUDING FILE: BTNORDH.FD
41910>>>>>>>>>>>>>>>>>Open Dorderh
INCLUDING FILE: DORDERH.FD
41912>>>>>>>>>>>>>>>>>Open Clients
41914>>>>>>>>>>>>>>>>>Open Salesmen
41916>>>>>>>>>>>>>>>>>Open Mhxanik
41918>>>>>>>>>>>>>>>>>Open Constrct
41920>>>>>>>>>>>>>>>>>Open Sysrecc
41922>>>>>>>>>>>>>>>>>Open Syscurxr
41924>>>>>>>>>>>>>>>>>
41924>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
41924>>>>>>>>>>>>>>>>>//DDB-ValidationStart
41924>>>>>>>>>>>>>>>>>
41924>>>>>>>>>>>>>>>>>Register_Object Cn_Cn_Categfpa_VT1
41924>>>>>>>>>>>>>>>>>Register_Object Cn_Tropos_Metaf_VT
41924>>>>>>>>>>>>>>>>>Register_Object Cn_Eidos_Cn_VT
41924>>>>>>>>>>>>>>>>>Register_Object Cn_Yesno_VT
41924>>>>>>>>>>>>>>>>>
41924>>>>>>>>>>>>>>>>>Object Cn_Cn_Categfpa_VT1  is a CodeValidationTable
41926>>>>>>>>>>>>>>>>>    Set Type_Value        To "VAT_STATUS"
41927>>>>>>>>>>>>>>>>>    Set Validate_State    To FALSE
41928>>>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
41929>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
41929>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
41929>>>>>>>>>>>>>>>>>End_Object   // Cn_Cn_Categfpa_VT1
41930>>>>>>>>>>>>>>>>>
41930>>>>>>>>>>>>>>>>>Object Cn_Tropos_Metaf_VT  is a CodeValidationTable
41932>>>>>>>>>>>>>>>>>    Set Type_Value        To "FORTOSH"
41933>>>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
41934>>>>>>>>>>>>>>>>>    Set Table_Title       To "’¨æ§¦  ‹œ«˜­¦¨áª"
41935>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
41935>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
41935>>>>>>>>>>>>>>>>>End_Object   // Cn_Tropos_Metaf_VT
41936>>>>>>>>>>>>>>>>>
41936>>>>>>>>>>>>>>>>>Object Cn_Eidos_Cn_VT  is a CodeValidationTable
41938>>>>>>>>>>>>>>>>>    Set Type_Value        To "EIDOSCN"
41939>>>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
41940>>>>>>>>>>>>>>>>>    Set Table_Title       To "„å›¦ª „¨š¦¬"
41941>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
41941>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
41941>>>>>>>>>>>>>>>>>End_Object   // Cn_Eidos_Cn_VT
41942>>>>>>>>>>>>>>>>>
41942>>>>>>>>>>>>>>>>>Object Cn_Yesno_VT  is a CodeValidationTable
41944>>>>>>>>>>>>>>>>>    Set Type_Value        To "YESNO"
41945>>>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
41946>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
41946>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
41946>>>>>>>>>>>>>>>>>End_Object   // Cn_Yesno_VT
41947>>>>>>>>>>>>>>>>>//DDB-ValidationEnd
41947>>>>>>>>>>>>>>>>>//DDB-SelectionStart
41947>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl041  sl041.sl
41947>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
41947>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
41947>>>>>>>>>>>>>>>>>Register_Object sl041
41947>>>>>>>>>>>>>>>>>Register_Object sl198
41947>>>>>>>>>>>>>>>>>Register_Object sl197
41947>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
41947>>>>>>>>>>>>>>>>>
41947>>>>>>>>>>>>>>>>>Class Cn_DataDictionary  is a DataDictionary_Sec
41948>>>>>>>>>>>>>>>>>
41948>>>>>>>>>>>>>>>>>
41948>>>>>>>>>>>>>>>>>    Procedure Update
41949>>>>>>>>>>>>>>>>>        Forward Send Update
41951>>>>>>>>>>>>>>>>>        // Insert Code Here
41951>>>>>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to CN.Company_Code
41952>>>>>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to CN.Branch_Code
41953>>>>>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to CN.Year_Year
41954>>>>>>>>>>>>>>>>>        //Move Custprom.Custprom_Code to CN.Custprom_Code
41954>>>>>>>>>>>>>>>>>        Move Clients.Client_ID      to CN.Client_ID
41955>>>>>>>>>>>>>>>>>
41955>>>>>>>>>>>>>>>>>        Move SysCurXR.Beto_Site      to CN.Cn_SiteW
41956>>>>>>>>>>>>>>>>>        Move Cn.Cn_Rec0              to CN.Cn_SN
41957>>>>>>>>>>>>>>>>>        Move Cn.Client_id            to Cn.Cn_clientid
41958>>>>>>>>>>>>>>>>>        Move Cn.cn_code              to Cn.Cn_Repmatch
41959>>>>>>>>>>>>>>>>>        Move Cn.Cn_Code              to Cn.Constraction_ID
41960>>>>>>>>>>>>>>>>>        Move PayResp.Presp_ID        to Cn.Cn_Presp_ID
41961>>>>>>>>>>>>>>>>>        Move Salesmen.Sls_ID         to Cn.Cn_Sls_ID
41962>>>>>>>>>>>>>>>>>        Move Constrct.Cnt_ID         to Cn.Cn_Cnt_ID
41963>>>>>>>>>>>>>>>>>        Move mhxanik.mhx_id          to Cn.mhxanik_ID
41964>>>>>>>>>>>>>>>>>    End_Procedure   // Update
41965>>>>>>>>>>>>>>>>>
41965>>>>>>>>>>>>>>>>>     Procedure Creating
41966>>>>>>>>>>>>>>>>>        Forward Send Creating
41968>>>>>>>>>>>>>>>>>        // Insert Code Here
41968>>>>>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(CN.CN_Rec0)))))) to CN.CN_Recr
41969>>>>>>>>>>>>>>>>>        Get fsgCode_With_Zeroes CN.CN_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to CN.CN_Code
41970>>>>>>>>>>>>>>>>>    End_Procedure   // Creating
41971>>>>>>>>>>>>>>>>>
41971>>>>>>>>>>>>>>>>>
41971>>>>>>>>>>>>>>>>>
41971>>>>>>>>>>>>>>>>>    // Define_Fields:
41971>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41971>>>>>>>>>>>>>>>>>
41971>>>>>>>>>>>>>>>>>    Procedure Define_Fields
41972>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
41974>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
41974>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
41974>>>>>>>>>>>>>>>>>
41974>>>>>>>>>>>>>>>>>        Set Main_File            To Cn.File_Number
41975>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
41976>>>>>>>>>>>>>>>>>
41976>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41977>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41978>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41979>>>>>>>>>>>>>>>>>
41979>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
41979>>>>>>>>>>>>>>>>>        Send Add_Client_File  Cnzones.File_Number
41980>>>>>>>>>>>>>>>>>        Send Add_Client_File  Tperga.File_Number
41981>>>>>>>>>>>>>>>>>        Send Add_Client_File  Btnordh.File_Number
41982>>>>>>>>>>>>>>>>>        Send Add_Client_File  Dorderh.File_Number
41983>>>>>>>>>>>>>>>>>
41983>>>>>>>>>>>>>>>>>        // Parent (Server) file structure...............
41983>>>>>>>>>>>>>>>>>        Send Add_Server_File  Clients.File_Number
41984>>>>>>>>>>>>>>>>>        Send Add_Server_File  Salesmen.File_Number
41985>>>>>>>>>>>>>>>>>        Send Add_Server_File  Mhxanik.File_Number
41986>>>>>>>>>>>>>>>>>        Send Add_Server_File  Constrct.File_Number
41987>>>>>>>>>>>>>>>>>
41987>>>>>>>>>>>>>>>>>        // External (System) file structure.............
41987>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
41988>>>>>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
41989>>>>>>>>>>>>>>>>>
41989>>>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecc.Cn_Rec0  To Cn.Cn_Rec0
41992>>>>>>>>>>>>>>>>>
41992>>>>>>>>>>>>>>>>>        // Field-based properties.......................
41992>>>>>>>>>>>>>>>>>
41992>>>>>>>>>>>>>>>>>        // Cn.Company_Code
41992>>>>>>>>>>>>>>>>>
41992>>>>>>>>>>>>>>>>>        // Cn.Branch_Code
41992>>>>>>>>>>>>>>>>>
41992>>>>>>>>>>>>>>>>>        // Cn.Year_Year
41992>>>>>>>>>>>>>>>>>
41992>>>>>>>>>>>>>>>>>        // Cn.Custprom_Code
41992>>>>>>>>>>>>>>>>>
41992>>>>>>>>>>>>>>>>>        // Cn.Client_Id
41992>>>>>>>>>>>>>>>>>
41992>>>>>>>>>>>>>>>>>        // Cn.Cn_Code
41992>>>>>>>>>>>>>>>>>        Set Field_Options          Field Cn.Cn_Code To DD_AUTOFIND    DD_NOPUT      
41993>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_Code To (sl041(Self))
41994>>>>>>>>>>>>>>>>>        Set Key_Field_State        Field Cn.Cn_Code To TRUE
41995>>>>>>>>>>>>>>>>>
41995>>>>>>>>>>>>>>>>>        // Cn.Client_Recr
41995>>>>>>>>>>>>>>>>>
41995>>>>>>>>>>>>>>>>>        // Cn.Cn_Rec0
41995>>>>>>>>>>>>>>>>>
41995>>>>>>>>>>>>>>>>>        // Cn.Cn_Recr
41995>>>>>>>>>>>>>>>>>
41995>>>>>>>>>>>>>>>>>        // Cn.Cn_Descr
41995>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_Descr To (sl041(Self))
41996>>>>>>>>>>>>>>>>>
41996>>>>>>>>>>>>>>>>>        // Cn.Cn_Address
41996>>>>>>>>>>>>>>>>>
41996>>>>>>>>>>>>>>>>>        // Cn.Cn_Zipcode
41996>>>>>>>>>>>>>>>>>
41996>>>>>>>>>>>>>>>>>        // Cn.Cn_City
41996>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_City To (sl198(Self))
41997>>>>>>>>>>>>>>>>>
41997>>>>>>>>>>>>>>>>>        // Cn.Cn_Area
41997>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_Area To (sl197(Self))
41998>>>>>>>>>>>>>>>>>
41998>>>>>>>>>>>>>>>>>        // Cn.Cn_License
41998>>>>>>>>>>>>>>>>>
41998>>>>>>>>>>>>>>>>>        // Cn.Cn_Responsible
41998>>>>>>>>>>>>>>>>>
41998>>>>>>>>>>>>>>>>>        // Cn.Cn_Cnt_Recr
41998>>>>>>>>>>>>>>>>>
41998>>>>>>>>>>>>>>>>>        // Cn.Cn_Cnt_Id
41998>>>>>>>>>>>>>>>>>
41998>>>>>>>>>>>>>>>>>        // Cn.Cn_Phone
41998>>>>>>>>>>>>>>>>>
41998>>>>>>>>>>>>>>>>>        // Cn.Cn_Zone
41998>>>>>>>>>>>>>>>>>
41998>>>>>>>>>>>>>>>>>        // Cn.Cn_Sls_Recr
41998>>>>>>>>>>>>>>>>>
41998>>>>>>>>>>>>>>>>>        // Cn.Cn_Sls_Id
41998>>>>>>>>>>>>>>>>>
41998>>>>>>>>>>>>>>>>>        // Cn.Cn_Details
41998>>>>>>>>>>>>>>>>>
41998>>>>>>>>>>>>>>>>>        // Cn.Cn_Distance
41998>>>>>>>>>>>>>>>>>
41998>>>>>>>>>>>>>>>>>        // Cn.Cn_Pump
41998>>>>>>>>>>>>>>>>>
41998>>>>>>>>>>>>>>>>>        // Cn.Cn_Pumplicense
41998>>>>>>>>>>>>>>>>>
41998>>>>>>>>>>>>>>>>>        // Cn.Cn_Totalstats
41998>>>>>>>>>>>>>>>>>
41998>>>>>>>>>>>>>>>>>        // Cn.Cn_Analstats
41998>>>>>>>>>>>>>>>>>
41998>>>>>>>>>>>>>>>>>        // Cn.Cn_Coated
41998>>>>>>>>>>>>>>>>>
41998>>>>>>>>>>>>>>>>>        // Cn.Cn_Sitew
41998>>>>>>>>>>>>>>>>>
41998>>>>>>>>>>>>>>>>>        // Cn.Cn_Clientmatch
41998>>>>>>>>>>>>>>>>>
41998>>>>>>>>>>>>>>>>>        // Cn.Cn_Codematch
41998>>>>>>>>>>>>>>>>>
41998>>>>>>>>>>>>>>>>>        // Cn.Cn_Pumpid
41998>>>>>>>>>>>>>>>>>
41998>>>>>>>>>>>>>>>>>        // Cn.Cn_Clientid
41998>>>>>>>>>>>>>>>>>
41998>>>>>>>>>>>>>>>>>        // Cn.Cn_Sn
41998>>>>>>>>>>>>>>>>>
41998>>>>>>>>>>>>>>>>>        // Cn.Cn_Repmatch
41998>>>>>>>>>>>>>>>>>
41998>>>>>>>>>>>>>>>>>        // Cn.Cn_Active
41998>>>>>>>>>>>>>>>>>        Set Field_Checkbox_Values  Field Cn.Cn_Active To "A"  "F"
41999>>>>>>>>>>>>>>>>>
41999>>>>>>>>>>>>>>>>>        // Cn.Cn_Reported
41999>>>>>>>>>>>>>>>>>
41999>>>>>>>>>>>>>>>>>        // Cn.Cn_Lastupdated
41999>>>>>>>>>>>>>>>>>
41999>>>>>>>>>>>>>>>>>        // Cn.Cn_Markexp
41999>>>>>>>>>>>>>>>>>
41999>>>>>>>>>>>>>>>>>        // Cn.Cn_Vdetails
41999>>>>>>>>>>>>>>>>>
41999>>>>>>>>>>>>>>>>>        // Cn.Cn_Vticket
41999>>>>>>>>>>>>>>>>>
41999>>>>>>>>>>>>>>>>>        // Cn.Constraction_Id
41999>>>>>>>>>>>>>>>>>
41999>>>>>>>>>>>>>>>>>        // Cn.Cn_Presp_Id
41999>>>>>>>>>>>>>>>>>
41999>>>>>>>>>>>>>>>>>        // Cn.Cn_Presp_Recr
41999>>>>>>>>>>>>>>>>>
41999>>>>>>>>>>>>>>>>>        // Cn.Cn_Add_No
41999>>>>>>>>>>>>>>>>>
41999>>>>>>>>>>>>>>>>>        // Cn.Cn_Nomos
41999>>>>>>>>>>>>>>>>>
41999>>>>>>>>>>>>>>>>>        // Cn.Cn_Xora
41999>>>>>>>>>>>>>>>>>
41999>>>>>>>>>>>>>>>>>        // Cn.Polh_Recr
41999>>>>>>>>>>>>>>>>>
41999>>>>>>>>>>>>>>>>>        // Cn.Lic_Number
41999>>>>>>>>>>>>>>>>>
41999>>>>>>>>>>>>>>>>>        // Cn.Lic_Date
41999>>>>>>>>>>>>>>>>>        Set Field_Mask_Type        Field Cn.Lic_Date To MASK_DATE_WINDOW
42000>>>>>>>>>>>>>>>>>
42000>>>>>>>>>>>>>>>>>        // Cn.Lic_Lixi
42000>>>>>>>>>>>>>>>>>        Set Field_Mask_Type        Field Cn.Lic_Lixi To MASK_DATE_WINDOW
42001>>>>>>>>>>>>>>>>>
42001>>>>>>>>>>>>>>>>>        // Cn.Lic_Auth
42001>>>>>>>>>>>>>>>>>
42001>>>>>>>>>>>>>>>>>        // Cn.Cn_Start_Date
42001>>>>>>>>>>>>>>>>>        Set Field_Mask_Type        Field Cn.Cn_Start_Date To MASK_DATE_WINDOW
42002>>>>>>>>>>>>>>>>>
42002>>>>>>>>>>>>>>>>>        // Cn.Cn_End_Date
42002>>>>>>>>>>>>>>>>>        Set Field_Mask_Type        Field Cn.Cn_End_Date To MASK_DATE_WINDOW
42003>>>>>>>>>>>>>>>>>
42003>>>>>>>>>>>>>>>>>        // Cn.Cn_Categfpa
42003>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Cn.Cn_Categfpa To (Cn_Cn_Categfpa_VT1(Self))
42004>>>>>>>>>>>>>>>>>
42004>>>>>>>>>>>>>>>>>        // Cn.Cn_Tpay
42004>>>>>>>>>>>>>>>>>
42004>>>>>>>>>>>>>>>>>        // Cn.Mhxanik_Id
42004>>>>>>>>>>>>>>>>>
42004>>>>>>>>>>>>>>>>>        // Cn.Sum_Pct_Tper
42004>>>>>>>>>>>>>>>>>
42004>>>>>>>>>>>>>>>>>        // Cn.Cn_M3
42004>>>>>>>>>>>>>>>>>
42004>>>>>>>>>>>>>>>>>        // Cn.Aa_Deop
42004>>>>>>>>>>>>>>>>>
42004>>>>>>>>>>>>>>>>>        // Cn.Hm_Tel_Fortio
42004>>>>>>>>>>>>>>>>>        Set Field_Mask_Type        Field Cn.Hm_Tel_Fortio To MASK_DATE_WINDOW
42005>>>>>>>>>>>>>>>>>
42005>>>>>>>>>>>>>>>>>        // Cn.Tel_Fortio_No
42005>>>>>>>>>>>>>>>>>
42005>>>>>>>>>>>>>>>>>        // Cn.Tropos_Metaf
42005>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Cn.Tropos_Metaf To (Cn_Tropos_Metaf_VT(Self))
42006>>>>>>>>>>>>>>>>>
42006>>>>>>>>>>>>>>>>>        // Cn.Eidos_Cn
42006>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Cn.Eidos_Cn To (Cn_Eidos_Cn_VT(Self))
42007>>>>>>>>>>>>>>>>>
42007>>>>>>>>>>>>>>>>>        // Cn.Polhths_Constr
42007>>>>>>>>>>>>>>>>>
42007>>>>>>>>>>>>>>>>>        // Cn.Polhths_Mhx
42007>>>>>>>>>>>>>>>>>
42007>>>>>>>>>>>>>>>>>        // Cn.Hm_Prot_Fortio
42007>>>>>>>>>>>>>>>>>        Set Field_Mask_Type        Field Cn.Hm_Prot_Fortio To MASK_DATE_WINDOW
42008>>>>>>>>>>>>>>>>>
42008>>>>>>>>>>>>>>>>>        // Cn.Mesoskyklos
42008>>>>>>>>>>>>>>>>>
42008>>>>>>>>>>>>>>>>>        // Cn.Diodia
42008>>>>>>>>>>>>>>>>>
42008>>>>>>>>>>>>>>>>>        // Cn.Yesno
42008>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Cn.Yesno To (Cn_Yesno_VT(Self))
42009>>>>>>>>>>>>>>>>>
42009>>>>>>>>>>>>>>>>>        // Cn.Dateeggy
42009>>>>>>>>>>>>>>>>>        Set Field_Mask_Type        Field Cn.Dateeggy To MASK_DATE_WINDOW
42010>>>>>>>>>>>>>>>>>
42010>>>>>>>>>>>>>>>>>        // Cn.Cn_Branch
42010>>>>>>>>>>>>>>>>>
42010>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
42010>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
42011>>>>>>>>>>>>>>>>>
42011>>>>>>>>>>>>>>>>>    // Field_Defaults:
42011>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
42011>>>>>>>>>>>>>>>>>          
42011>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
42012>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
42014>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
42014>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
42014>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Cn.Cn_Active To "A"
42015>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
42015>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
42016>>>>>>>>>>>>>>>>>
42016>>>>>>>>>>>>>>>>>End_Class    // Cn_DataDictionary
42017>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
42017>>>>>>>>>>>>>>>>>
42017>>>>>>>>>>>>>>>>>Use sl041.sl         // sl041
42017>>>>>>>>>>>>>>>>>Use sl198.sl         // sl198
42017>>>>>>>>>>>>>>>>>Use sl197.SL         // sl197
42017>>>>>>>>>>>>>>>>>
42017>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
42017>>>>>>>>>>>>>>>>>//DDB-FileEnd
42017>>>>>>>>>>>>>>>    
42017>>>>>>>>>>>>>>>    //AB-IgnoreEnd
42017>>>>>>>>>>>>>>>
42017>>>>>>>>>>>>>>>    Object sl041 is a dbModalPanelSub
42019>>>>>>>>>>>>>>>
42019>>>>>>>>>>>>>>>        //AB-StoreTopStart
42019>>>>>>>>>>>>>>>        Property String FragmaClient_ID Public ''
42021>>>>>>>>>>>>>>>        
42021>>>>>>>>>>>>>>>        //AB-StoreTopEnd
42021>>>>>>>>>>>>>>>
42021>>>>>>>>>>>>>>>        Set Label to "„§ ¢¦šã „¨šà¤"
42022>>>>>>>>>>>>>>>        Set Size to 249 500
42023>>>>>>>>>>>>>>>        Set Location to 2 6
42024>>>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
42025>>>>>>>>>>>>>>>        Set Modal_State to FALSE
42026>>>>>>>>>>>>>>>
42026>>>>>>>>>>>>>>>        //AB-DDOStart
42026>>>>>>>>>>>>>>>
42026>>>>>>>>>>>>>>>        Object Clients_DD is a Clients_DataDictionary
42028>>>>>>>>>>>>>>>
42028>>>>>>>>>>>>>>>            //AB-StoreStart
42028>>>>>>>>>>>>>>>                                                                                                                                                                                                                                        
42028>>>>>>>>>>>>>>>                                                                                                                                                                                                                                        
42028>>>>>>>>>>>>>>>                                                                                                                                                                                                                                        
42028>>>>>>>>>>>>>>>            //AB-StoreEnd
42028>>>>>>>>>>>>>>>
42028>>>>>>>>>>>>>>>        End_Object    // Clients_DD
42029>>>>>>>>>>>>>>>
42029>>>>>>>>>>>>>>>        Object Cn_DD is a Cn_DataDictionary
42031>>>>>>>>>>>>>>>            Set DDO_Server to (Clients_DD(self))
42032>>>>>>>>>>>>>>>
42032>>>>>>>>>>>>>>>            //AB-StoreStart
42032>>>>>>>>>>>>>>>                                            
42032>>>>>>>>>>>>>>>            Begin_Constraints
42034>>>>>>>>>>>>>>>                String sID
42035>>>>>>>>>>>>>>>                Get FragmaClient_ID to sID
42036>>>>>>>>>>>>>>>                If (sID<>'') begin
42038>>>>>>>>>>>>>>>                    set ordering to 4
42039>>>>>>>>>>>>>>>                    Constrain CN.Client_ID eq sID
42041>>>>>>>>>>>>>>>                end
42041>>>>>>>>>>>>>>>>
42041>>>>>>>>>>>>>>>                ELSE SET ORDERING TO -1
42043>>>>>>>>>>>>>>>            End_Constraints
42046>>>>>>>>>>>>>>>            
42046>>>>>>>>>>>>>>>            
42046>>>>>>>>>>>>>>>            
42046>>>>>>>>>>>>>>>            
42046>>>>>>>>>>>>>>>            
42046>>>>>>>>>>>>>>>            
42046>>>>>>>>>>>>>>>            
42046>>>>>>>>>>>>>>>            
42046>>>>>>>>>>>>>>>            
42046>>>>>>>>>>>>>>>            
42046>>>>>>>>>>>>>>>            
42046>>>>>>>>>>>>>>>            
42046>>>>>>>>>>>>>>>            
42046>>>>>>>>>>>>>>>            
42046>>>>>>>>>>>>>>>            
42046>>>>>>>>>>>>>>>            //AB-StoreEnd
42046>>>>>>>>>>>>>>>
42046>>>>>>>>>>>>>>>        End_Object    // Cn_DD
42047>>>>>>>>>>>>>>>
42047>>>>>>>>>>>>>>>        Set Main_DD to (Cn_DD(self))
42048>>>>>>>>>>>>>>>        Set Server to (Cn_DD(self))
42049>>>>>>>>>>>>>>>
42049>>>>>>>>>>>>>>>        //AB-DDOEnd
42049>>>>>>>>>>>>>>>
42049>>>>>>>>>>>>>>>        Object oSelList is a dbListSub
42051>>>>>>>>>>>>>>>            Set Main_File to Cn.File_Number
42052>>>>>>>>>>>>>>>            Set Ordering to 4
42053>>>>>>>>>>>>>>>            Set Size to 209 481
42054>>>>>>>>>>>>>>>            Set Location to 6 6
42055>>>>>>>>>>>>>>>            Set Auto_Index_State to FALSE
42056>>>>>>>>>>>>>>>
42056>>>>>>>>>>>>>>>            Begin_Row
42059>>>>>>>>>>>>>>>                Entry_Item Cn.Cn_code
42060>>>>>>>>>>>>>>>                Entry_Item Cn.Cn_descr
42061>>>>>>>>>>>>>>>                Entry_Item Cn.Client_id
42062>>>>>>>>>>>>>>>                Entry_Item Clients.Client_name
42063>>>>>>>>>>>>>>>                Entry_Item Cn.Cn_active
42064>>>>>>>>>>>>>>>            End_Row
42069>>>>>>>>>>>>>>>
42069>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 61
42070>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª „¨š¦¬"
42071>>>>>>>>>>>>>>>            
42071>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 185
42072>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã „¨š¦¬"
42073>>>>>>>>>>>>>>>            
42073>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 60
42074>>>>>>>>>>>>>>>            Set Header_Label  item 2 to "‰à›.œ¢á«ž"
42075>>>>>>>>>>>>>>>            
42075>>>>>>>>>>>>>>>            Set Form_Width    item 3 to 123
42076>>>>>>>>>>>>>>>            Set Header_Label  item 3 to "„§à¤¬£å˜ œ¢á«ž"
42077>>>>>>>>>>>>>>>            
42077>>>>>>>>>>>>>>>            Set Form_Width    item 4 to 44
42078>>>>>>>>>>>>>>>            Set Header_Label  item 4 to "‘œ „¥â¢ ¥ž"
42079>>>>>>>>>>>>>>>            Set Column_Checkbox_State  item 4 to True
42080>>>>>>>>>>>>>>>            
42080>>>>>>>>>>>>>>>
42080>>>>>>>>>>>>>>>            //AB-StoreStart
42080>>>>>>>>>>>>>>>                                            
42080>>>>>>>>>>>>>>>            Property String StoreFragmaClient_ID Public ''
42082>>>>>>>>>>>>>>>            
42082>>>>>>>>>>>>>>>            Procedure Store_Defaults
42084>>>>>>>>>>>>>>>                   Forward Send Store_Defaults
42086>>>>>>>>>>>>>>>                   Set StoreFragmaClient_ID to (FragmaClient_ID(Self))
42087>>>>>>>>>>>>>>>            End_Procedure
42088>>>>>>>>>>>>>>>            
42088>>>>>>>>>>>>>>>            Procedure ReStore_Defaults
42090>>>>>>>>>>>>>>>                   Forward Send ReStore_Defaults
42092>>>>>>>>>>>>>>>                   Set FragmaClient_ID to (StoreFragmaClient_ID(Self))
42093>>>>>>>>>>>>>>>            End_Procedure
42094>>>>>>>>>>>>>>>            
42094>>>>>>>>>>>>>>>            Procedure Activating Returns Integer
42096>>>>>>>>>>>>>>>                Integer rVal
42097>>>>>>>>>>>>>>>                Forward Get Msg_Activating to rVal
42099>>>>>>>>>>>>>>>                set auto_index_state to true
42100>>>>>>>>>>>>>>>                SET ORDERING TO -1
42101>>>>>>>>>>>>>>>                Procedure_Return rVal
42102>>>>>>>>>>>>>>>            End_Procedure
42103>>>>>>>>>>>>>>>            
42103>>>>>>>>>>>>>>>            
42103>>>>>>>>>>>>>>>            
42103>>>>>>>>>>>>>>>            
42103>>>>>>>>>>>>>>>            
42103>>>>>>>>>>>>>>>            
42103>>>>>>>>>>>>>>>            
42103>>>>>>>>>>>>>>>            
42103>>>>>>>>>>>>>>>            
42103>>>>>>>>>>>>>>>            
42103>>>>>>>>>>>>>>>            
42103>>>>>>>>>>>>>>>            
42103>>>>>>>>>>>>>>>            
42103>>>>>>>>>>>>>>>            
42103>>>>>>>>>>>>>>>            
42103>>>>>>>>>>>>>>>            
42103>>>>>>>>>>>>>>>            
42103>>>>>>>>>>>>>>>            
42103>>>>>>>>>>>>>>>            //AB-StoreEnd
42103>>>>>>>>>>>>>>>
42103>>>>>>>>>>>>>>>        End_Object    // oSelList
42104>>>>>>>>>>>>>>>
42104>>>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
42106>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
42107>>>>>>>>>>>>>>>            Set Location to 219 327
42108>>>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
42109>>>>>>>>>>>>>>>
42109>>>>>>>>>>>>>>>            //AB-StoreStart
42109>>>>>>>>>>>>>>>            Procedure OnClick
42111>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
42112>>>>>>>>>>>>>>>            End_Procedure
42113>>>>>>>>>>>>>>>            //AB-StoreEnd
42113>>>>>>>>>>>>>>>
42113>>>>>>>>>>>>>>>        End_Object    // oOK_bn
42114>>>>>>>>>>>>>>>
42114>>>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
42116>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
42117>>>>>>>>>>>>>>>            Set Location to 219 383
42118>>>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
42119>>>>>>>>>>>>>>>
42119>>>>>>>>>>>>>>>            //AB-StoreStart
42119>>>>>>>>>>>>>>>            Procedure OnClick
42121>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
42122>>>>>>>>>>>>>>>            End_Procedure
42123>>>>>>>>>>>>>>>            //AB-StoreEnd
42123>>>>>>>>>>>>>>>
42123>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
42124>>>>>>>>>>>>>>>
42124>>>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
42126>>>>>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
42127>>>>>>>>>>>>>>>            Set Location to 219 437
42128>>>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
42129>>>>>>>>>>>>>>>
42129>>>>>>>>>>>>>>>            //AB-StoreStart
42129>>>>>>>>>>>>>>>            Procedure OnClick
42131>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
42132>>>>>>>>>>>>>>>            End_Procedure
42133>>>>>>>>>>>>>>>            //AB-StoreEnd
42133>>>>>>>>>>>>>>>
42133>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
42134>>>>>>>>>>>>>>>
42134>>>>>>>>>>>>>>>
42134>>>>>>>>>>>>>>>        //AB-StoreStart
42134>>>>>>>>>>>>>>>                        
42134>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
42135>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
42136>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
42137>>>>>>>>>>>>>>>        Set Modal_State to True
42138>>>>>>>>>>>>>>>        Procedure Activating Returns Integer
42140>>>>>>>>>>>>>>>            Integer rVal
42141>>>>>>>>>>>>>>>            Forward Get Msg_Activating to rVal
42143>>>>>>>>>>>>>>>            Send Rebuild_Constraints to (CN_DD(Self))
42144>>>>>>>>>>>>>>>            Send Beginning_Of_Data to oSelList
42145>>>>>>>>>>>>>>>            Procedure_Return rVal
42146>>>>>>>>>>>>>>>        End_Procedure
42147>>>>>>>>>>>>>>>        
42147>>>>>>>>>>>>>>>        procedure page integer pagemode
42149>>>>>>>>>>>>>>>            forward send page pagemode
42151>>>>>>>>>>>>>>>            set location to 40,40
42152>>>>>>>>>>>>>>>        end_procedure
42153>>>>>>>>>>>>>>>        
42153>>>>>>>>>>>>>>>        
42153>>>>>>>>>>>>>>>        
42153>>>>>>>>>>>>>>>        
42153>>>>>>>>>>>>>>>        
42153>>>>>>>>>>>>>>>        
42153>>>>>>>>>>>>>>>        
42153>>>>>>>>>>>>>>>        
42153>>>>>>>>>>>>>>>        
42153>>>>>>>>>>>>>>>        
42153>>>>>>>>>>>>>>>        
42153>>>>>>>>>>>>>>>        
42153>>>>>>>>>>>>>>>        
42153>>>>>>>>>>>>>>>        
42153>>>>>>>>>>>>>>>        
42153>>>>>>>>>>>>>>>        
42153>>>>>>>>>>>>>>>        
42153>>>>>>>>>>>>>>>        
42153>>>>>>>>>>>>>>>        //AB-StoreEnd
42153>>>>>>>>>>>>>>>
42153>>>>>>>>>>>>>>>    End_Object    // sl041
42154>>>>>>>>>>>>>>>
42154>>>>>>>>>>>>>>>//AB/     End_Object    // prj
42154>>>>>>>>>>>>>Use sl014.SL         // sl014
INCLUDING FILE: SL014.SL
42154>>>>>>>>>>>>>>>//AB/ Project sl014:Particle Lookup
42154>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
42154>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl014:Particle Lookup"
42154>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl014.SL"
42154>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
42154>>>>>>>>>>>>>>>
42154>>>>>>>>>>>>>>>// Project Object Structure
42154>>>>>>>>>>>>>>>//   sl014 is a dbModalPanelSub
42154>>>>>>>>>>>>>>>//     Ctypkin_DD is a DataDictionary
42154>>>>>>>>>>>>>>>//     Wtypkin_DD is a DataDictionary
42154>>>>>>>>>>>>>>>//     Ptyppar_DD is a DataDictionary
42154>>>>>>>>>>>>>>>//     Clients_DD is a DataDictionary
42154>>>>>>>>>>>>>>>//     Nomisma_DD is a DataDictionary
42154>>>>>>>>>>>>>>>//     Particle_DD is a DataDictionary
42154>>>>>>>>>>>>>>>//     oSelList is a dbListSub
42154>>>>>>>>>>>>>>>//     cSyDateForm1 is a cSyDateForm
42154>>>>>>>>>>>>>>>//     FormSub1 is a FormSub
42154>>>>>>>>>>>>>>>//     FormSub3 is a FormSub
42154>>>>>>>>>>>>>>>//     FormSub2 is a FormSub
42154>>>>>>>>>>>>>>>//     FormSub4 is a FormSub
42154>>>>>>>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
42154>>>>>>>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
42154>>>>>>>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
42154>>>>>>>>>>>>>>>//     ButtonSub1 is a ButtonSub
42154>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
42154>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
42154>>>>>>>>>>>>>>>
42154>>>>>>>>>>>>>>>// Register all objects
42154>>>>>>>>>>>>>>>Register_Object ButtonSub1
42154>>>>>>>>>>>>>>>Register_Object Clients_DD
42154>>>>>>>>>>>>>>>Register_Object Ctypkin_DD
42154>>>>>>>>>>>>>>>Register_Object cSyDateForm1
42154>>>>>>>>>>>>>>>Register_Object FormSub1
42154>>>>>>>>>>>>>>>Register_Object FormSub2
42154>>>>>>>>>>>>>>>Register_Object FormSub3
42154>>>>>>>>>>>>>>>Register_Object FormSub4
42154>>>>>>>>>>>>>>>Register_Object Nomisma_DD
42154>>>>>>>>>>>>>>>Register_Object oOK_bn
42154>>>>>>>>>>>>>>>Register_Object oSearch_bn
42154>>>>>>>>>>>>>>>Register_Object oSelList
42154>>>>>>>>>>>>>>>Register_Object Particle_DD
42154>>>>>>>>>>>>>>>Register_Object Ptyppar_DD
42154>>>>>>>>>>>>>>>Register_Object sl014
42154>>>>>>>>>>>>>>>Register_Object TextBoxSub1
42154>>>>>>>>>>>>>>>Register_Object TextBoxSub2
42154>>>>>>>>>>>>>>>Register_Object TextBoxSub3
42154>>>>>>>>>>>>>>>Register_Object Wtypkin_DD
42154>>>>>>>>>>>>>>>
42154>>>>>>>>>>>>>>>
42154>>>>>>>>>>>>>>>
42154>>>>>>>>>>>>>>>//AB-StoreTopStart
42154>>>>>>>>>>>>>>>    
42154>>>>>>>>>>>>>>>Open PtypparL
42156>>>>>>>>>>>>>>>
42156>>>>>>>>>>>>>>>Use sl100.sl
42156>>>>>>>>>>>>>>>Use sl012.sl
42156>>>>>>>>>>>>>>>
42156>>>>>>>>>>>>>>>//AB-StoreTopEnd
42156>>>>>>>>>>>>>>>
42156>>>>>>>>>>>>>>>//AB-IgnoreStart
42156>>>>>>>>>>>>>>>
42156>>>>>>>>>>>>>>>Use DFAllEnt.pkg
42156>>>>>>>>>>>>>>>Use dbList.Sub
42156>>>>>>>>>>>>>>>Use cSyDateForm.Pkg
INCLUDING FILE: CSYDATEFORM.PKG
42156>>>>>>>>>>>>>>>>>Use cSyDateIntelliMix.pkg
INCLUDING FILE: CSYDATEINTELLIMIX.PKG
42156>>>>>>>>>>>>>>>>>>>Use Calendar.Sl // Needed for date prompt.
42156>>>>>>>>>>>>>>>>>>>Use Dates.Utl
42156>>>>>>>>>>>>>>>>>>>
42156>>>>>>>>>>>>>>>>>>>   Define cStatusHelp       for "F4 = Calendar. T = Today, B = Begin of month, E = End of month."
42156>>>>>>>>>>>>>>>>>>>   Define cDateToday        for "T"
42156>>>>>>>>>>>>>>>>>>>   Define cDateBeginOfMonth for "B"
42156>>>>>>>>>>>>>>>>>>>   Define cDateEndOfMonth   for "E"
42156>>>>>>>>>>>>>>>>>>>
42156>>>>>>>>>>>>>>>>>>>Class cSyIntelliSense_Date_Mixin is a Message
42157>>>>>>>>>>>>>>>>>>>   Procedure DoDefineIntelliSenseDateMixin
42158>>>>>>>>>>>>>>>>>>>      Property Date    pdOriginal_Value          Public 0
42159>>>>>>>>>>>>>>>>>>>      Property Integer pbIntelliSense_Date_State Public dfTrue
42160>>>>>>>>>>>>>>>>>>>      Property Integer pbEnableCalendarPrompt    Public dfTrue
42161>>>>>>>>>>>>>>>>>>>   End_Procedure // DoDefineIntelliSenseDateMixin
42162>>>>>>>>>>>>>>>>>>>
42162>>>>>>>>>>>>>>>>>>>   // **WvA: Augmented to store the current date-value before any changes are made
42162>>>>>>>>>>>>>>>>>>>   Procedure Entering returns Integer
42163>>>>>>>>>>>>>>>>>>>      Integer iRetVal
42164>>>>>>>>>>>>>>>>>>>      Date    dOriginal
42164>>>>>>>>>>>>>>>>>>>      Forward Get Msg_Entering to iRetVal
42166>>>>>>>>>>>>>>>>>>>      If (iRetVal = 0) Begin
42168>>>>>>>>>>>>>>>>>>>         Send DoStoreOriginalDate
42169>>>>>>>>>>>>>>>>>>>      End
42169>>>>>>>>>>>>>>>>>>>>
42169>>>>>>>>>>>>>>>>>>>      Procedure_Return iRetVal
42170>>>>>>>>>>>>>>>>>>>   End_Procedure // Entering
42171>>>>>>>>>>>>>>>>>>>
42171>>>>>>>>>>>>>>>>>>>   //**WvA: This procedure is augmented to see if the user entered a 1 or 2 digit
42171>>>>>>>>>>>>>>>>>>>   //       value with the intention to only change the day-part of the current date.
42171>>>>>>>>>>>>>>>>>>>   Procedure Next
42172>>>>>>>>>>>>>>>>>>>      Send DoIntelliSenseDate
42173>>>>>>>>>>>>>>>>>>>      Forward Send Next
42175>>>>>>>>>>>>>>>>>>>   End_Procedure // Next
42176>>>>>>>>>>>>>>>>>>>
42176>>>>>>>>>>>>>>>>>>>   // **WvA: Store the current date-value before any changes are made
42176>>>>>>>>>>>>>>>>>>>   Procedure DoStoreOriginalDate
42177>>>>>>>>>>>>>>>>>>>      Date    dOriginal
42178>>>>>>>>>>>>>>>>>>>      //If (pbIntelliSense_Date_State(Self)) Begin
42178>>>>>>>>>>>>>>>>>>>         Get Value Item 0 to dOriginal
42179>>>>>>>>>>>>>>>>>>>         Set pdOriginal_Value to dOriginal
42180>>>>>>>>>>>>>>>>>>>      //End
42180>>>>>>>>>>>>>>>>>>>   End_Procedure // DoStoreOriginalDate
42181>>>>>>>>>>>>>>>>>>>
42181>>>>>>>>>>>>>>>>>>>   Procedure DoIntelliSenseDate
42182>>>>>>>>>>>>>>>>>>>      Integer iCurrent iStored iDaysOffSet iSep iDate_Format bChanged iYear
42183>>>>>>>>>>>>>>>>>>>      Date    dCurrent dOriginal
42183>>>>>>>>>>>>>>>>>>>      String  sStored  sCurrent sSep sMask
42183>>>>>>>>>>>>>>>>>>>
42183>>>>>>>>>>>>>>>>>>>      Get Item_Changed_State Item 0 to bChanged
42184>>>>>>>>>>>>>>>>>>>      Get pdOriginal_Value to dOriginal
42185>>>>>>>>>>>>>>>>>>>      If (pbIntelliSense_Date_State(Self) And (bChanged)) Begin
42187>>>>>>>>>>>>>>>>>>>         If (dOriginal Eq 0) Sysdate4 dOriginal
42190>>>>>>>>>>>>>>>>>>>
42190>>>>>>>>>>>>>>>>>>>         // We need the masked value, because the normal value is corrected by the runtime for
42190>>>>>>>>>>>>>>>>>>>         // USA dates.
42190>>>>>>>>>>>>>>>>>>>         Get Masked_Value Item 0 to sCurrent // getting a 2 digit entered date to a datavariable results in an error.
42191>>>>>>>>>>>>>>>>>>>         Move (Replaces(" ",sCurrent,"")) to sCurrent
42192>>>>>>>>>>>>>>>>>>>         Get_Attribute DF_DATE_SEPARATOR to iSep
42195>>>>>>>>>>>>>>>>>>>         Move (Character(iSep)) to sSep
42196>>>>>>>>>>>>>>>>>>>
42196>>>>>>>>>>>>>>>>>>>         // Although the sep value is "/" in the European date format, the mask seperator is "-".
42196>>>>>>>>>>>>>>>>>>>         Move (Replaces("-",sCurrent,sSep)) to sCurrent
42197>>>>>>>>>>>>>>>>>>>         Move (sSep+sSep) to sMask
42198>>>>>>>>>>>>>>>>>>>
42198>>>>>>>>>>>>>>>>>>>         // Now check if the user just entered a day or a day and a month.
42198>>>>>>>>>>>>>>>>>>>         // Something very special is going on here. We are interpreting a string, so the format
42198>>>>>>>>>>>>>>>>>>>         // will always be the same, even for USA or Military dates. "99//" where 9 can be any number
42198>>>>>>>>>>>>>>>>>>>         //If ( (length(sCurrent) > 2) And (Right(sCurrent,2) = sMask)  ) Begin
42198>>>>>>>>>>>>>>>>>>>         If ((length(sCurrent) <= 4) And (Right(sCurrent,2) = sMask)) Begin
42200>>>>>>>>>>>>>>>>>>>            Move (replace(sMask,sCurrent,"")) to sCurrent
42201>>>>>>>>>>>>>>>>>>>            Move sCurrent to iCurrent
42202>>>>>>>>>>>>>>>>>>>            If ((iCurrent >= 1) And (iCurrent <= 31)) Begin
42204>>>>>>>>>>>>>>>>>>>               Get_Attribute DF_DATE_FORMAT to iDate_Format
42207>>>>>>>>>>>>>>>>>>>               If (iDate_Format = DF_DATE_USA) Begin
42209>>>>>>>>>>>>>>>>>>>                  Move (Mid( String(dOriginal),2,4)) to iDaysOffSet
42210>>>>>>>>>>>>>>>>>>>               End
42210>>>>>>>>>>>>>>>>>>>>
42210>>>>>>>>>>>>>>>>>>>               Else If (iDate_Format = DF_DATE_EUROPEAN) Begin
42213>>>>>>>>>>>>>>>>>>>                  Move (Left( String(dOriginal),2 )) to iDaysOffSet
42214>>>>>>>>>>>>>>>>>>>               End
42214>>>>>>>>>>>>>>>>>>>>
42214>>>>>>>>>>>>>>>>>>>               Else If (iDate_Format = DF_DATE_MILITARY) Begin
42217>>>>>>>>>>>>>>>>>>>                  Move (Right( String(dOriginal),2 )) to iDaysOffSet
42218>>>>>>>>>>>>>>>>>>>               End
42218>>>>>>>>>>>>>>>>>>>>
42218>>>>>>>>>>>>>>>>>>>               Set Value Item 0 to (Date(dOriginal - iDaysOffSet + iCurrent))
42219>>>>>>>>>>>>>>>>>>>            End // Let the runtime handle the error if value not in the range 1..31
42219>>>>>>>>>>>>>>>>>>>>
42219>>>>>>>>>>>>>>>>>>>         End
42219>>>>>>>>>>>>>>>>>>>>
42219>>>>>>>>>>>>>>>>>>>         Else If ((length(sCurrent) > 4) And (Right(sCurrent,1) = sSep)) Begin
42222>>>>>>>>>>>>>>>>>>>            Get_Attribute DF_DATE_FORMAT to iDate_Format
42225>>>>>>>>>>>>>>>>>>>            If ((iDate_Format = DF_DATE_USA) Or (iDate_Format = DF_DATE_EUROPEAN)) Begin
42227>>>>>>>>>>>>>>>>>>>               Move (Right(dOriginal,4)) to iYear
42228>>>>>>>>>>>>>>>>>>>            End
42228>>>>>>>>>>>>>>>>>>>>
42228>>>>>>>>>>>>>>>>>>>            Else If (iDate_Format = DF_DATE_MILITARY) Begin
42231>>>>>>>>>>>>>>>>>>>               Move (Left(dOriginal,4))  to iYear
42232>>>>>>>>>>>>>>>>>>>            End
42232>>>>>>>>>>>>>>>>>>>>
42232>>>>>>>>>>>>>>>>>>>            Set Value Item 0 to (Date(sCurrent + String(iYear)))
42233>>>>>>>>>>>>>>>>>>>         End
42233>>>>>>>>>>>>>>>>>>>>
42233>>>>>>>>>>>>>>>>>>>      End
42233>>>>>>>>>>>>>>>>>>>>
42233>>>>>>>>>>>>>>>>>>>   End_Procedure // DoIntelliSenseDate
42234>>>>>>>>>>>>>>>>>>>
42234>>>>>>>>>>>>>>>>>>>   Procedure Key Integer iKey Returns Integer
42235>>>>>>>>>>>>>>>>>>>      Date dToday dTemp
42236>>>>>>>>>>>>>>>>>>>      Sysdate4 dToday
42237>>>>>>>>>>>>>>>>>>>
42237>>>>>>>>>>>>>>>>>>>      If ((Character(iKey) EQ cDateToday) OR (Character(iKey) EQ Lowercase(cDateToday))) Begin
42239>>>>>>>>>>>>>>>>>>>         Set Value to dToday
42240>>>>>>>>>>>>>>>>>>>      End
42240>>>>>>>>>>>>>>>>>>>>
42240>>>>>>>>>>>>>>>>>>>      Else If ((Character(iKey) EQ cDateBeginOfMonth) OR (Character(iKey) EQ Lowercase(cDateBeginOfMonth))) Begin
42243>>>>>>>>>>>>>>>>>>>         Get FirstDayInMonth dToday to dTemp
42244>>>>>>>>>>>>>>>>>>>         Set Value to dTemp
42245>>>>>>>>>>>>>>>>>>>      End
42245>>>>>>>>>>>>>>>>>>>>
42245>>>>>>>>>>>>>>>>>>>      Else If ((Character(iKey) EQ cDateEndOfMonth) OR (Character(iKey) EQ Lowercase(cDateEndOfMonth))) Begin
42248>>>>>>>>>>>>>>>>>>>         Get LastDayInMonth dToday to dTemp
42249>>>>>>>>>>>>>>>>>>>         Set Value to dTemp
42250>>>>>>>>>>>>>>>>>>>      End
42250>>>>>>>>>>>>>>>>>>>>
42250>>>>>>>>>>>>>>>>>>>      Else Forward Send Key iKey
42253>>>>>>>>>>>>>>>>>>>   End_procedure
42254>>>>>>>>>>>>>>>>>>>
42254>>>>>>>>>>>>>>>>>>>End_Class // cSyIntelliSense_Date_Mixin
42255>>>>>>>>>>>>>>>>>
42255>>>>>>>>>>>>>>>>>Class cSyDateForm Is A FormSub
42256>>>>>>>>>>>>>>>>>   Procedure Construct_Object
42257>>>>>>>>>>>>>>>>>      Forward Send Construct_Object
42259>>>>>>>>>>>>>>>>>
42259>>>>>>>>>>>>>>>>>      Set Prompt_Button_Mode   to PB_PromptOn
42260>>>>>>>>>>>>>>>>>      Set Form_Datatype Item 0 to Mask_Date_Window
42261>>>>>>>>>>>>>>>>>
42261>>>>>>>>>>>>>>>>>      Send DoDefineIntelliSenseDateMixin
42262>>>>>>>>>>>>>>>>>
42262>>>>>>>>>>>>>>>>>      On_Key kPrompt Send Prompt
42263>>>>>>>>>>>>>>>>>
42263>>>>>>>>>>>>>>>>>      Set Prompt_Object to (oCalendar(Self))
42264>>>>>>>>>>>>>>>>>      Set Status_Help   to cStatusHelp
42265>>>>>>>>>>>>>>>>>
42265>>>>>>>>>>>>>>>>>   End_Procedure // Construct_Object
42266>>>>>>>>>>>>>>>>>
42266>>>>>>>>>>>>>>>>>   Import_Class_Protocol cSyIntelliSense_Date_Mixin
42267>>>>>>>>>>>>>>>>>
42267>>>>>>>>>>>>>>>>>//   Function Form_Datatype Integer iItem Returns Integer
42267>>>>>>>>>>>>>>>>>//      Integer iDatatype
42267>>>>>>>>>>>>>>>>>//
42267>>>>>>>>>>>>>>>>>//      If (iItem = Current) Begin
42267>>>>>>>>>>>>>>>>>//         Get Current_Item to iItem
42267>>>>>>>>>>>>>>>>>//      End
42267>>>>>>>>>>>>>>>>>//
42267>>>>>>>>>>>>>>>>>//      Forward Get Form_Datatype Item iItem to iDataType
42267>>>>>>>>>>>>>>>>>//
42267>>>>>>>>>>>>>>>>>//      Function_Return iDatatype
42267>>>>>>>>>>>>>>>>>//   End_Function // Form_Datatype
42267>>>>>>>>>>>>>>>>>
42267>>>>>>>>>>>>>>>>>End_Class // cSyDateForm
42268>>>>>>>>>>>>>>>Use Form.Sub
42268>>>>>>>>>>>>>>>Use Txtbox.Sub
42268>>>>>>>>>>>>>>>Use Button.Sub
42268>>>>>>>>>>>>>>>
42268>>>>>>>>>>>>>>>
42268>>>>>>>>>>>>>>>Use CTYPKIN.DD
42268>>>>>>>>>>>>>>>Use WTYPKIN.DD
42268>>>>>>>>>>>>>>>Use PTYPPAR.DD
42268>>>>>>>>>>>>>>>Use CLIENTS.DD
42268>>>>>>>>>>>>>>>Use NOMISMA.DD
42268>>>>>>>>>>>>>>>Use PARTICLE.DD
42268>>>>>>>>>>>>>>>
42268>>>>>>>>>>>>>>>//AB-IgnoreEnd
42268>>>>>>>>>>>>>>>
42268>>>>>>>>>>>>>>>Object sl014 is a dbModalPanelSub
42270>>>>>>>>>>>>>>>
42270>>>>>>>>>>>>>>>    //AB-StoreTopStart
42270>>>>>>>>>>>>>>>            
42270>>>>>>>>>>>>>>>    Property String psModule        Public ''
42272>>>>>>>>>>>>>>>    Property String psClient        Public ''
42274>>>>>>>>>>>>>>>    Property String psPtyppar       Public ''
42276>>>>>>>>>>>>>>>    Property String psCtypkin       Public ''
42278>>>>>>>>>>>>>>>    Property String psWtypkin       Public ''
42280>>>>>>>>>>>>>>>    Property String psPtypparRecr   Public ''
42282>>>>>>>>>>>>>>>    Property Date   pdHmnia         Public ''
42284>>>>>>>>>>>>>>>    
42284>>>>>>>>>>>>>>>    //AB-StoreTopEnd
42284>>>>>>>>>>>>>>>
42284>>>>>>>>>>>>>>>    Set Label to "˜¨˜©«˜« ¡á"
42285>>>>>>>>>>>>>>>    Set Size to 282 523
42286>>>>>>>>>>>>>>>    Set Location to 4 3
42287>>>>>>>>>>>>>>>    Set Color to 12363657
42288>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
42289>>>>>>>>>>>>>>>    Set Modal_State to FALSE
42290>>>>>>>>>>>>>>>
42290>>>>>>>>>>>>>>>    //AB-DDOStart
42290>>>>>>>>>>>>>>>
42290>>>>>>>>>>>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
42292>>>>>>>>>>>>>>>    End_Object    // Ctypkin_DD
42293>>>>>>>>>>>>>>>
42293>>>>>>>>>>>>>>>    Object Wtypkin_DD is a Wtypkin_DataDictionary
42295>>>>>>>>>>>>>>>    End_Object    // Wtypkin_DD
42296>>>>>>>>>>>>>>>
42296>>>>>>>>>>>>>>>    Object Ptyppar_DD is a Ptyppar_DataDictionary
42298>>>>>>>>>>>>>>>        Set DDO_Server to (Ctypkin_DD(self))
42299>>>>>>>>>>>>>>>        Set DDO_Server to (Wtypkin_DD(self))
42300>>>>>>>>>>>>>>>    End_Object    // Ptyppar_DD
42301>>>>>>>>>>>>>>>
42301>>>>>>>>>>>>>>>    Object Clients_DD is a Clients_DataDictionary
42303>>>>>>>>>>>>>>>    End_Object    // Clients_DD
42304>>>>>>>>>>>>>>>
42304>>>>>>>>>>>>>>>    Object Nomisma_DD is a Nomisma_DataDictionary
42306>>>>>>>>>>>>>>>    End_Object    // Nomisma_DD
42307>>>>>>>>>>>>>>>
42307>>>>>>>>>>>>>>>    Object Particle_DD is a Particle_DataDictionary
42309>>>>>>>>>>>>>>>        Set DDO_Server to (Clients_DD(self))
42310>>>>>>>>>>>>>>>        Set DDO_Server to (Ptyppar_DD(self))
42311>>>>>>>>>>>>>>>        Set DDO_Server to (Nomisma_DD(self))
42312>>>>>>>>>>>>>>>
42312>>>>>>>>>>>>>>>        //AB-StoreStart
42312>>>>>>>>>>>>>>>        
42312>>>>>>>>>>>>>>>        Procedure OnConstrain
42314>>>>>>>>>>>>>>>            String  sPtyppar sWtypkin sCtypkin sClientID sPtypparRecr
42315>>>>>>>>>>>>>>>            Date    dHmnia
42315>>>>>>>>>>>>>>>        
42315>>>>>>>>>>>>>>>            Get psClient        to sClientID
42316>>>>>>>>>>>>>>>            Get psPtyppar       to sPtyppar
42317>>>>>>>>>>>>>>>            Get psPtypparRecr   to sPtypparRecr
42318>>>>>>>>>>>>>>>            Get psCtypkin       to sCtypkin
42319>>>>>>>>>>>>>>>            Get psWtypkin       to sWtypkin
42320>>>>>>>>>>>>>>>            Get Value Of cSyDateForm1 Item 0 to dHmnia
42321>>>>>>>>>>>>>>>        
42321>>>>>>>>>>>>>>>            If (sClientID<>'') Begin
42323>>>>>>>>>>>>>>>                If (sPtypparRecr<>'') Begin
42325>>>>>>>>>>>>>>>                    Set Ordering to 1
42326>>>>>>>>>>>>>>>                    Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
42328>>>>>>>>>>>>>>>                    Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
42330>>>>>>>>>>>>>>>                    Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
42332>>>>>>>>>>>>>>>                    Constrain Particle.CustProm_Code    Eq ''
42334>>>>>>>>>>>>>>>                    Constrain Particle.Client_ID        Eq sClientID
42336>>>>>>>>>>>>>>>                    Constrain Particle.Ctypkin_Code     Eq sCtypkin
42338>>>>>>>>>>>>>>>                    Constrain Particle.Wtypkin_Code     Eq sWtypkin
42340>>>>>>>>>>>>>>>                    Constrain Particle.Ptyppar_Code     Eq sPtyppar
42342>>>>>>>>>>>>>>>                    If (dHmnia<>'') ;                        Constrain Particle.Partl_Hmnia  Eq dHmnia
42346>>>>>>>>>>>>>>>                End
42346>>>>>>>>>>>>>>>>
42346>>>>>>>>>>>>>>>                Else Begin
42347>>>>>>>>>>>>>>>                    Set Ordering to 13
42348>>>>>>>>>>>>>>>                    Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
42350>>>>>>>>>>>>>>>                    Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
42352>>>>>>>>>>>>>>>                    Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
42354>>>>>>>>>>>>>>>                    Constrain Particle.Client_ID        Eq sClientID
42356>>>>>>>>>>>>>>>                    If (dHmnia<>'') ;                        Constrain Particle.Partl_Hmnia  Eq dHmnia
42360>>>>>>>>>>>>>>>                End
42360>>>>>>>>>>>>>>>>
42360>>>>>>>>>>>>>>>            End
42360>>>>>>>>>>>>>>>>
42360>>>>>>>>>>>>>>>            Else If (sPtypparRecr<>'') Begin
42363>>>>>>>>>>>>>>>                Set Ordering to 12
42364>>>>>>>>>>>>>>>                Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
42366>>>>>>>>>>>>>>>                Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
42368>>>>>>>>>>>>>>>                Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
42370>>>>>>>>>>>>>>>                Constrain Particle.Partl_Module     Eq (psModule(Self))
42372>>>>>>>>>>>>>>>                Constrain Particle.Ptyppar_Recr     Eq sPtypparRecr
42374>>>>>>>>>>>>>>>                If (dHmnia<>'') ;                    Constrain Particle.Partl_Hmnia  Eq dHmnia
42378>>>>>>>>>>>>>>>            End
42378>>>>>>>>>>>>>>>>
42378>>>>>>>>>>>>>>>            Else  Begin
42379>>>>>>>>>>>>>>>                Set Ordering to 14
42380>>>>>>>>>>>>>>>                Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
42382>>>>>>>>>>>>>>>                Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
42384>>>>>>>>>>>>>>>                Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
42386>>>>>>>>>>>>>>>                Constrain Particle.Partl_Module     Eq (psModule(Self))
42388>>>>>>>>>>>>>>>                If (dHmnia<>'') ;                    Constrain Particle.Partl_Hmnia  Eq dHmnia
42392>>>>>>>>>>>>>>>            End
42392>>>>>>>>>>>>>>>>
42392>>>>>>>>>>>>>>>        
42392>>>>>>>>>>>>>>>        End_Procedure
42393>>>>>>>>>>>>>>>        
42393>>>>>>>>>>>>>>>        
42393>>>>>>>>>>>>>>>        
42393>>>>>>>>>>>>>>>        
42393>>>>>>>>>>>>>>>        
42393>>>>>>>>>>>>>>>        
42393>>>>>>>>>>>>>>>        
42393>>>>>>>>>>>>>>>        
42393>>>>>>>>>>>>>>>        
42393>>>>>>>>>>>>>>>        
42393>>>>>>>>>>>>>>>        
42393>>>>>>>>>>>>>>>        
42393>>>>>>>>>>>>>>>        
42393>>>>>>>>>>>>>>>        
42393>>>>>>>>>>>>>>>        
42393>>>>>>>>>>>>>>>        
42393>>>>>>>>>>>>>>>        //AB-StoreEnd
42393>>>>>>>>>>>>>>>
42393>>>>>>>>>>>>>>>    End_Object    // Particle_DD
42394>>>>>>>>>>>>>>>
42394>>>>>>>>>>>>>>>    Set Main_DD to (Particle_DD(self))
42395>>>>>>>>>>>>>>>    Set Server to (Particle_DD(self))
42396>>>>>>>>>>>>>>>
42396>>>>>>>>>>>>>>>    //AB-DDOEnd
42396>>>>>>>>>>>>>>>
42396>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
42398>>>>>>>>>>>>>>>
42398>>>>>>>>>>>>>>>        //AB-StoreTopStart
42398>>>>>>>>>>>>>>>                                                                        
42398>>>>>>>>>>>>>>>                                                                        
42398>>>>>>>>>>>>>>>        //AB-StoreTopEnd
42398>>>>>>>>>>>>>>>
42398>>>>>>>>>>>>>>>        Set Main_File to Particle.File_Number
42399>>>>>>>>>>>>>>>        Set Size to 208 511
42400>>>>>>>>>>>>>>>        Set Location to 6 5
42401>>>>>>>>>>>>>>>        Set Auto_Index_State to FALSE
42402>>>>>>>>>>>>>>>
42402>>>>>>>>>>>>>>>        Begin_Row
42405>>>>>>>>>>>>>>>            Entry_Item Particle.Partl_hmnia
42406>>>>>>>>>>>>>>>            Entry_Item Ptyppar.Ptyppar_descr
42407>>>>>>>>>>>>>>>            Entry_Item Particle.Pseira_seira
42408>>>>>>>>>>>>>>>            Entry_Item Particle.Partl_no
42409>>>>>>>>>>>>>>>            Entry_Item Clients.Client_id
42410>>>>>>>>>>>>>>>            Entry_Item Clients.Client_name
42411>>>>>>>>>>>>>>>            Entry_Item Particle.Partl_ekleise
42412>>>>>>>>>>>>>>>        End_Row
42417>>>>>>>>>>>>>>>
42417>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 60
42418>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "†£œ¨/¤å˜"
42419>>>>>>>>>>>>>>>        
42419>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 117
42420>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "˜¨˜©«˜« ¡æ"
42421>>>>>>>>>>>>>>>        
42421>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 36
42422>>>>>>>>>>>>>>>        Set Header_Label  item 2 to "‘œ ¨á"
42423>>>>>>>>>>>>>>>        
42423>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 60
42424>>>>>>>>>>>>>>>        Set Header_Label  item 3 to "€¨ Ÿ£æª"
42425>>>>>>>>>>>>>>>        
42425>>>>>>>>>>>>>>>        Set Form_Width    item 4 to 57
42426>>>>>>>>>>>>>>>        Set Header_Label  item 4 to "‰à› ¡æª"
42427>>>>>>>>>>>>>>>        
42427>>>>>>>>>>>>>>>        Set Form_Width    item 5 to 159
42428>>>>>>>>>>>>>>>        Set Header_Label  item 5 to "œ¢á«žª / ¨¦£žŸœ¬«ãª"
42429>>>>>>>>>>>>>>>        
42429>>>>>>>>>>>>>>>        Set Form_Width    item 6 to 16
42430>>>>>>>>>>>>>>>        Set Header_Label  item 6 to "K"
42431>>>>>>>>>>>>>>>        Set Column_Checkbox_State  item 6 to True
42432>>>>>>>>>>>>>>>        
42432>>>>>>>>>>>>>>>
42432>>>>>>>>>>>>>>>        //AB-StoreStart
42432>>>>>>>>>>>>>>>                                                                        
42432>>>>>>>>>>>>>>>        Procedure Activate
42434>>>>>>>>>>>>>>>            Send Keyaction to ButtonSub1
42435>>>>>>>>>>>>>>>            Forward Send Activate
42437>>>>>>>>>>>>>>>        End_procedure
42438>>>>>>>>>>>>>>>        
42438>>>>>>>>>>>>>>>        Procedure Activating
42440>>>>>>>>>>>>>>>            Forward Send Activating
42442>>>>>>>>>>>>>>>            Set Auto_Index_State to True
42443>>>>>>>>>>>>>>>        End_Procedure
42444>>>>>>>>>>>>>>>        
42444>>>>>>>>>>>>>>>        
42444>>>>>>>>>>>>>>>        //AB-StoreEnd
42444>>>>>>>>>>>>>>>
42444>>>>>>>>>>>>>>>    End_Object    // oSelList
42445>>>>>>>>>>>>>>>
42445>>>>>>>>>>>>>>>    Object cSyDateForm1 is a cSyDateForm
42447>>>>>>>>>>>>>>>        Set Size to 13 85
42448>>>>>>>>>>>>>>>        Set Location to 222 54
42449>>>>>>>>>>>>>>>        Set Label_Col_Offset to 2
42450>>>>>>>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
42451>>>>>>>>>>>>>>>        Set Form_Mask Item 0 to "d/M/yyyy"
42452>>>>>>>>>>>>>>>
42452>>>>>>>>>>>>>>>        //AB-StoreStart
42452>>>>>>>>>>>>>>>                                                
42452>>>>>>>>>>>>>>>        Procedure Key Integer iKey
42454>>>>>>>>>>>>>>>            Integer iRetVal
42455>>>>>>>>>>>>>>>            Forward Send Key iKey
42457>>>>>>>>>>>>>>>            If (iKey=277) Begin
42459>>>>>>>>>>>>>>>                Send Clear_Me
42460>>>>>>>>>>>>>>>            End
42460>>>>>>>>>>>>>>>>
42460>>>>>>>>>>>>>>>        End_Procedure
42461>>>>>>>>>>>>>>>        
42461>>>>>>>>>>>>>>>        Procedure Clear_Me
42463>>>>>>>>>>>>>>>            Set Value Item 0 to ''
42464>>>>>>>>>>>>>>>            Send KeyAction to ButtonSub1
42465>>>>>>>>>>>>>>>        End_Procedure
42466>>>>>>>>>>>>>>>        
42466>>>>>>>>>>>>>>>        Procedure Exiting00000
42468>>>>>>>>>>>>>>>            Forward Send Exiting
42470>>>>>>>>>>>>>>>            Send KeyAction to ButtonSub1
42471>>>>>>>>>>>>>>>        End_procedure
42472>>>>>>>>>>>>>>>        
42472>>>>>>>>>>>>>>>        
42472>>>>>>>>>>>>>>>        
42472>>>>>>>>>>>>>>>        //AB-StoreEnd
42472>>>>>>>>>>>>>>>
42472>>>>>>>>>>>>>>>    End_Object    // cSyDateForm1
42473>>>>>>>>>>>>>>>
42473>>>>>>>>>>>>>>>    Object FormSub1 is a FormSub
42475>>>>>>>>>>>>>>>        Set Size to 13 85
42476>>>>>>>>>>>>>>>        Set Location to 236 54
42477>>>>>>>>>>>>>>>        Set Label_Col_Offset to 2
42478>>>>>>>>>>>>>>>        Set Prompt_Button_Mode to pb_PromptOn
42479>>>>>>>>>>>>>>>
42479>>>>>>>>>>>>>>>        //AB-StoreStart
42479>>>>>>>>>>>>>>>                                        
42479>>>>>>>>>>>>>>>        Set Prompt_Object to (sl012(Self))
42480>>>>>>>>>>>>>>>        
42480>>>>>>>>>>>>>>>        Procedure Prompt
42482>>>>>>>>>>>>>>>            String sModule
42483>>>>>>>>>>>>>>>            Get psModule Of (sl012(Self)) to sModule
42484>>>>>>>>>>>>>>>            Set psModule Of (sl012(Self)) to (psModule(Self))
42485>>>>>>>>>>>>>>>            Forward Send Prompt
42487>>>>>>>>>>>>>>>            Set psModule Of (sl012(Self)) to sModule
42488>>>>>>>>>>>>>>>        End_Procedure
42489>>>>>>>>>>>>>>>        
42489>>>>>>>>>>>>>>>        Procedure OnChange
42491>>>>>>>>>>>>>>>            String s1
42492>>>>>>>>>>>>>>>            Get Value Item 0 to s1
42493>>>>>>>>>>>>>>>            Set Value Of FormSub3 Item 0 to (fsPtyppar(Self,s1))
42494>>>>>>>>>>>>>>>            Clear Ptypparl
42495>>>>>>>>>>>>>>>            Move Syscurxr.Company_Code  to ptypparl.Company_Code
42496>>>>>>>>>>>>>>>            Move Syscurxr.Branch_Code   to ptypparl.Branch_Code
42497>>>>>>>>>>>>>>>            Move s1                     to Ptypparl.Ptyppar_Code
42498>>>>>>>>>>>>>>>            Find Eq Ptypparl by index.1
42499>>>>>>>>>>>>>>>>
42499>>>>>>>>>>>>>>>            Set psPtyppar       to s1
42500>>>>>>>>>>>>>>>            Set psPtypparRecr   to Ptypparl.Ptyppar_Recr
42501>>>>>>>>>>>>>>>            Set psWtypkin       to PtypparL.Wtypkin_Code
42502>>>>>>>>>>>>>>>            Set psCtypkin       to PtypparL.Ctypkin_Code
42503>>>>>>>>>>>>>>>        End_Procedure
42504>>>>>>>>>>>>>>>        
42504>>>>>>>>>>>>>>>        
42504>>>>>>>>>>>>>>>        
42504>>>>>>>>>>>>>>>        
42504>>>>>>>>>>>>>>>        
42504>>>>>>>>>>>>>>>        
42504>>>>>>>>>>>>>>>        
42504>>>>>>>>>>>>>>>        //AB-StoreEnd
42504>>>>>>>>>>>>>>>
42504>>>>>>>>>>>>>>>    End_Object    // FormSub1
42505>>>>>>>>>>>>>>>
42505>>>>>>>>>>>>>>>    Object FormSub3 is a FormSub
42507>>>>>>>>>>>>>>>        Set Size to 13 195
42508>>>>>>>>>>>>>>>        Set Location to 236 145
42509>>>>>>>>>>>>>>>        Set Color to 12363657
42510>>>>>>>>>>>>>>>        Set Label_Col_Offset to 2
42511>>>>>>>>>>>>>>>        Set Enabled_State to FALSE
42512>>>>>>>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
42513>>>>>>>>>>>>>>>        Set Shadow_State Item 0 to TRUE
42514>>>>>>>>>>>>>>>    End_Object    // FormSub3
42515>>>>>>>>>>>>>>>
42515>>>>>>>>>>>>>>>    Object FormSub2 is a FormSub
42517>>>>>>>>>>>>>>>        Set Size to 13 85
42518>>>>>>>>>>>>>>>        Set Location to 250 54
42519>>>>>>>>>>>>>>>        Set Label_Col_Offset to 2
42520>>>>>>>>>>>>>>>        Set Prompt_Button_Mode to pb_PromptOn
42521>>>>>>>>>>>>>>>
42521>>>>>>>>>>>>>>>        //AB-StoreStart
42521>>>>>>>>>>>>>>>                                        
42521>>>>>>>>>>>>>>>        Set Prompt_Object to (sl100(Self))
42522>>>>>>>>>>>>>>>        
42522>>>>>>>>>>>>>>>        Procedure Prompt
42524>>>>>>>>>>>>>>>            String sModule
42525>>>>>>>>>>>>>>>            Get psModule Of (sl100(Self)) to sModule
42526>>>>>>>>>>>>>>>            Set psModule Of (sl100(Self)) to (psModule(Self))
42527>>>>>>>>>>>>>>>            Forward Send Prompt
42529>>>>>>>>>>>>>>>            Set psModule Of (sl100(Self)) to sModule
42530>>>>>>>>>>>>>>>        End_Procedure
42531>>>>>>>>>>>>>>>        
42531>>>>>>>>>>>>>>>        Procedure OnChange
42533>>>>>>>>>>>>>>>            String s1
42534>>>>>>>>>>>>>>>            Get Value Item 0 to s1
42535>>>>>>>>>>>>>>>            Set Value Of FormSub4 Item 0 to (fsClient(Self,s1))
42536>>>>>>>>>>>>>>>            Set psClient to s1
42537>>>>>>>>>>>>>>>        End_Procedure
42538>>>>>>>>>>>>>>>        
42538>>>>>>>>>>>>>>>        
42538>>>>>>>>>>>>>>>        
42538>>>>>>>>>>>>>>>        
42538>>>>>>>>>>>>>>>        
42538>>>>>>>>>>>>>>>        
42538>>>>>>>>>>>>>>>        
42538>>>>>>>>>>>>>>>        //AB-StoreEnd
42538>>>>>>>>>>>>>>>
42538>>>>>>>>>>>>>>>    End_Object    // FormSub2
42539>>>>>>>>>>>>>>>
42539>>>>>>>>>>>>>>>    Object FormSub4 is a FormSub
42541>>>>>>>>>>>>>>>        Set Size to 13 195
42542>>>>>>>>>>>>>>>        Set Location to 250 145
42543>>>>>>>>>>>>>>>        Set Color to 12363657
42544>>>>>>>>>>>>>>>        Set Label_Col_Offset to 2
42545>>>>>>>>>>>>>>>        Set Enabled_State to FALSE
42546>>>>>>>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
42547>>>>>>>>>>>>>>>        Set Shadow_State Item 0 to TRUE
42548>>>>>>>>>>>>>>>    End_Object    // FormSub4
42549>>>>>>>>>>>>>>>
42549>>>>>>>>>>>>>>>    Object TextBoxSub1 is a TextBoxSub
42551>>>>>>>>>>>>>>>        Set Label to "†£œ¨/¤å˜"
42552>>>>>>>>>>>>>>>        Set Color to 12363657
42553>>>>>>>>>>>>>>>        Set Location to 222 5
42554>>>>>>>>>>>>>>>        Set Size to 10 35
42555>>>>>>>>>>>>>>>    End_Object    // TextBoxSub1
42556>>>>>>>>>>>>>>>
42556>>>>>>>>>>>>>>>    Object TextBoxSub2 is a TextBoxSub
42558>>>>>>>>>>>>>>>        Set Label to "˜¨˜©«/¡æ"
42559>>>>>>>>>>>>>>>        Set Color to 12363657
42560>>>>>>>>>>>>>>>        Set Location to 237 4
42561>>>>>>>>>>>>>>>        Set Size to 10 41
42562>>>>>>>>>>>>>>>    End_Object    // TextBoxSub2
42563>>>>>>>>>>>>>>>
42563>>>>>>>>>>>>>>>    Object TextBoxSub3 is a TextBoxSub
42565>>>>>>>>>>>>>>>        Set Label to "”¦¨â˜ª"
42566>>>>>>>>>>>>>>>        Set Color to 12363657
42567>>>>>>>>>>>>>>>        Set Location to 252 4
42568>>>>>>>>>>>>>>>        Set Size to 10 31
42569>>>>>>>>>>>>>>>    End_Object    // TextBoxSub3
42570>>>>>>>>>>>>>>>
42570>>>>>>>>>>>>>>>    Object ButtonSub1 is a ButtonSub
42572>>>>>>>>>>>>>>>        Set Label to "œ¨ æ¨ ©œ"
42573>>>>>>>>>>>>>>>        Set Size to 13 50
42574>>>>>>>>>>>>>>>        Set Location to 252 355
42575>>>>>>>>>>>>>>>        Set Form_FontWeight Item 0 to 600
42576>>>>>>>>>>>>>>>
42576>>>>>>>>>>>>>>>        //AB-StoreStart
42576>>>>>>>>>>>>>>>                                                            
42576>>>>>>>>>>>>>>>        Procedure OnClick
42578>>>>>>>>>>>>>>>            Send Rebuild_Constraints to Particle_DD
42579>>>>>>>>>>>>>>>            Send Beginning_Of_Data to oSelList True
42580>>>>>>>>>>>>>>>        End_Procedure // OnClick
42581>>>>>>>>>>>>>>>        
42581>>>>>>>>>>>>>>>        
42581>>>>>>>>>>>>>>>        //AB-StoreEnd
42581>>>>>>>>>>>>>>>
42581>>>>>>>>>>>>>>>    End_Object    // ButtonSub1
42582>>>>>>>>>>>>>>>
42582>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
42584>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
42585>>>>>>>>>>>>>>>        Set Size to 13 50
42586>>>>>>>>>>>>>>>        Set Location to 252 413
42587>>>>>>>>>>>>>>>
42587>>>>>>>>>>>>>>>        //AB-StoreStart
42587>>>>>>>>>>>>>>>        Procedure OnClick
42589>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
42590>>>>>>>>>>>>>>>        End_Procedure
42591>>>>>>>>>>>>>>>        //AB-StoreEnd
42591>>>>>>>>>>>>>>>
42591>>>>>>>>>>>>>>>    End_Object    // oOK_bn
42592>>>>>>>>>>>>>>>
42592>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
42594>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
42595>>>>>>>>>>>>>>>        Set Size to 13 50
42596>>>>>>>>>>>>>>>        Set Location to 252 466
42597>>>>>>>>>>>>>>>
42597>>>>>>>>>>>>>>>        //AB-StoreStart
42597>>>>>>>>>>>>>>>        Procedure OnClick
42599>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
42600>>>>>>>>>>>>>>>        End_Procedure
42601>>>>>>>>>>>>>>>        //AB-StoreEnd
42601>>>>>>>>>>>>>>>
42601>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
42602>>>>>>>>>>>>>>>
42602>>>>>>>>>>>>>>>
42602>>>>>>>>>>>>>>>    //AB-StoreStart
42602>>>>>>>>>>>>>>>            
42602>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
42603>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
42604>>>>>>>>>>>>>>>    
42604>>>>>>>>>>>>>>>    Set Locate_Mode to Center_On_Screen
42605>>>>>>>>>>>>>>>    Set Modal_State to True
42606>>>>>>>>>>>>>>>    
42606>>>>>>>>>>>>>>>    Procedure Request_Cancel
42608>>>>>>>>>>>>>>>        Set Value Of cSyDateForm1 Item 0 to ''
42609>>>>>>>>>>>>>>>        Send Clear to Particle_DD
42610>>>>>>>>>>>>>>>        Forward Send Request_Cancel
42612>>>>>>>>>>>>>>>    End_Procedure
42613>>>>>>>>>>>>>>>    
42613>>>>>>>>>>>>>>>    
42613>>>>>>>>>>>>>>>    
42613>>>>>>>>>>>>>>>    
42613>>>>>>>>>>>>>>>    
42613>>>>>>>>>>>>>>>    
42613>>>>>>>>>>>>>>>    
42613>>>>>>>>>>>>>>>    
42613>>>>>>>>>>>>>>>    
42613>>>>>>>>>>>>>>>    
42613>>>>>>>>>>>>>>>    
42613>>>>>>>>>>>>>>>    
42613>>>>>>>>>>>>>>>    
42613>>>>>>>>>>>>>>>    
42613>>>>>>>>>>>>>>>    
42613>>>>>>>>>>>>>>>    
42613>>>>>>>>>>>>>>>    
42613>>>>>>>>>>>>>>>    
42613>>>>>>>>>>>>>>>    
42613>>>>>>>>>>>>>>>    //AB-StoreEnd
42613>>>>>>>>>>>>>>>
42613>>>>>>>>>>>>>>>End_Object    // sl014
42614>>>>>>>>>>>>>>>
42614>>>>>>>>>>>>>>>
42614>>>>>>>>>>>>>>>//AB-StoreStart
42614>>>>>>>>>>>>>>>    
42614>>>>>>>>>>>>>>>    
42614>>>>>>>>>>>>>>>//AB-StoreEnd
42614>>>>>>>>>>>>>>>
42614>>>>>>>>>>>>>>>//AB/ End_Object    // prj
42614>>>>>>>>>>>>>Use sl054.SL         // sl054
INCLUDING FILE: SL054.SL
42614>>>>>>>>>>>>>>>//AB/ Project sl054:cars
42614>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
42614>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl054:cars"
42614>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl054.SL"
42614>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
42614>>>>>>>>>>>>>>>
42614>>>>>>>>>>>>>>>// Project Object Structure
42614>>>>>>>>>>>>>>>//   sl054 is a dbModalPanelSub
42614>>>>>>>>>>>>>>>//     Cars_DD is a DataDictionary
42614>>>>>>>>>>>>>>>//     oSelList is a dbListSub
42614>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
42614>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
42614>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
42614>>>>>>>>>>>>>>>
42614>>>>>>>>>>>>>>>// Register all objects
42614>>>>>>>>>>>>>>>Register_Object Cars_DD
42614>>>>>>>>>>>>>>>Register_Object oCancel_bn
42614>>>>>>>>>>>>>>>Register_Object oOK_bn
42614>>>>>>>>>>>>>>>Register_Object oSearch_bn
42614>>>>>>>>>>>>>>>Register_Object oSelList
42614>>>>>>>>>>>>>>>Register_Object sl054
42614>>>>>>>>>>>>>>>
42614>>>>>>>>>>>>>>>
42614>>>>>>>>>>>>>>>//AB-IgnoreStart
42614>>>>>>>>>>>>>>>
42614>>>>>>>>>>>>>>>Use DFAllEnt.pkg
42614>>>>>>>>>>>>>>>Use dbList.Sub
42614>>>>>>>>>>>>>>>Use Button.Sub
42614>>>>>>>>>>>>>>>
42614>>>>>>>>>>>>>>>
42614>>>>>>>>>>>>>>>Use Cars.DD
INCLUDING FILE: CARS.DD
42614>>>>>>>>>>>>>>>>>//DDB-FileStart
42614>>>>>>>>>>>>>>>>>//DDB-HeaderStart
42614>>>>>>>>>>>>>>>>>
42614>>>>>>>>>>>>>>>>>// File Name : CARS.DD
42614>>>>>>>>>>>>>>>>>// Class Name: Cars_DataDictionary
42614>>>>>>>>>>>>>>>>>// Revision  : 7
42614>>>>>>>>>>>>>>>>>// Version   : 2
42614>>>>>>>>>>>>>>>>>
42614>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
42614>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
42614>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
42614>>>>>>>>>>>>>>>>>
42614>>>>>>>>>>>>>>>>>Open Cars
42616>>>>>>>>>>>>>>>>>
42616>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
42616>>>>>>>>>>>>>>>>>//DDB-ValidationStart
42616>>>>>>>>>>>>>>>>>
42616>>>>>>>>>>>>>>>>>Register_Object Cars_Ctype_Id_VT
42616>>>>>>>>>>>>>>>>>
42616>>>>>>>>>>>>>>>>>Object Cars_Ctype_Id_VT  is a CodeValidationTable
42618>>>>>>>>>>>>>>>>>    Set Type_Value        To "PUMPSTYPE"
42619>>>>>>>>>>>>>>>>>    Set Validate_State    To FALSE
42620>>>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
42621>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
42621>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
42621>>>>>>>>>>>>>>>>>End_Object   // Cars_Ctype_Id_VT
42622>>>>>>>>>>>>>>>>>//DDB-ValidationEnd
42622>>>>>>>>>>>>>>>>>//DDB-SelectionStart
42622>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl054  sl054.SL
42622>>>>>>>>>>>>>>>>>Register_Object sl054
42622>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
42622>>>>>>>>>>>>>>>>>
42622>>>>>>>>>>>>>>>>>Class Cars_DataDictionary  is a DataDictionary_Sec
42623>>>>>>>>>>>>>>>>>
42623>>>>>>>>>>>>>>>>>    // Update:
42623>>>>>>>>>>>>>>>>>
42623>>>>>>>>>>>>>>>>>    Procedure Update
42624>>>>>>>>>>>>>>>>>        Forward Send Update
42626>>>>>>>>>>>>>>>>>        move syscurxr.company_code  to cars.car_company
42627>>>>>>>>>>>>>>>>>        move syscurxr.beto_site     to cars.car_bsite
42628>>>>>>>>>>>>>>>>>        // Insert Code Here
42628>>>>>>>>>>>>>>>>>    End_Procedure   // Update
42629>>>>>>>>>>>>>>>>>
42629>>>>>>>>>>>>>>>>>
42629>>>>>>>>>>>>>>>>>    // Define_Fields:
42629>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
42629>>>>>>>>>>>>>>>>>
42629>>>>>>>>>>>>>>>>>    Procedure Define_Fields
42630>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
42632>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
42632>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
42632>>>>>>>>>>>>>>>>>
42632>>>>>>>>>>>>>>>>>        Set Main_File            To Cars.File_Number
42633>>>>>>>>>>>>>>>>>
42633>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
42634>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
42635>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
42636>>>>>>>>>>>>>>>>>
42636>>>>>>>>>>>>>>>>>        // Field-based properties.......................
42636>>>>>>>>>>>>>>>>>
42636>>>>>>>>>>>>>>>>>        // Cars.Car_Recnum
42636>>>>>>>>>>>>>>>>>
42636>>>>>>>>>>>>>>>>>        // Cars.Car_Company
42636>>>>>>>>>>>>>>>>>
42636>>>>>>>>>>>>>>>>>        // Cars.Car_Id
42636>>>>>>>>>>>>>>>>>        Set Field_Options          Field Cars.Car_Id To DD_AUTOFIND   
42637>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cars.Car_Id To (sl054(Self))
42638>>>>>>>>>>>>>>>>>        Set Key_Field_State        Field Cars.Car_Id To TRUE
42639>>>>>>>>>>>>>>>>>
42639>>>>>>>>>>>>>>>>>        // Cars.Car_Descr
42639>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cars.Car_Descr To (sl054(Self))
42640>>>>>>>>>>>>>>>>>
42640>>>>>>>>>>>>>>>>>        // Cars.Car_License
42640>>>>>>>>>>>>>>>>>
42640>>>>>>>>>>>>>>>>>        // Cars.Car_Driverrecn
42640>>>>>>>>>>>>>>>>>
42640>>>>>>>>>>>>>>>>>        // Cars.Car_Details
42640>>>>>>>>>>>>>>>>>
42640>>>>>>>>>>>>>>>>>        // Cars.Car_Maxm3
42640>>>>>>>>>>>>>>>>>
42640>>>>>>>>>>>>>>>>>        // Cars.Car_Sitew
42640>>>>>>>>>>>>>>>>>
42640>>>>>>>>>>>>>>>>>        // Cars.Car_Tare
42640>>>>>>>>>>>>>>>>>
42640>>>>>>>>>>>>>>>>>        // Cars.Car_Codematch
42640>>>>>>>>>>>>>>>>>
42640>>>>>>>>>>>>>>>>>        // Cars.Car_Driverid
42640>>>>>>>>>>>>>>>>>
42640>>>>>>>>>>>>>>>>>        // Cars.Car_Sn
42640>>>>>>>>>>>>>>>>>
42640>>>>>>>>>>>>>>>>>        // Cars.Car_Lastupdated
42640>>>>>>>>>>>>>>>>>
42640>>>>>>>>>>>>>>>>>        // Cars.Car_Markexp
42640>>>>>>>>>>>>>>>>>
42640>>>>>>>>>>>>>>>>>        // Cars.Car_748tare1
42640>>>>>>>>>>>>>>>>>
42640>>>>>>>>>>>>>>>>>        // Cars.Car_748tare2
42640>>>>>>>>>>>>>>>>>
42640>>>>>>>>>>>>>>>>>        // Cars.Car_748sign
42640>>>>>>>>>>>>>>>>>
42640>>>>>>>>>>>>>>>>>        // Cars.Car_Bsite
42640>>>>>>>>>>>>>>>>>
42640>>>>>>>>>>>>>>>>>        // Cars.Ctype_Id
42640>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Cars.Ctype_Id To "dbComboFormsub"
42641>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Cars.Ctype_Id To (Cars_Ctype_Id_VT(Self))
42642>>>>>>>>>>>>>>>>>
42642>>>>>>>>>>>>>>>>>        // Cars.Pagio
42642>>>>>>>>>>>>>>>>>
42642>>>>>>>>>>>>>>>>>        // Cars.Parakrat
42642>>>>>>>>>>>>>>>>>
42642>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
42642>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
42643>>>>>>>>>>>>>>>>>
42643>>>>>>>>>>>>>>>>>    // Field_Defaults:
42643>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
42643>>>>>>>>>>>>>>>>>
42643>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
42644>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
42646>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
42646>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
42646>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
42646>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
42647>>>>>>>>>>>>>>>>>
42647>>>>>>>>>>>>>>>>>End_Class    // Cars_DataDictionary
42648>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
42648>>>>>>>>>>>>>>>>>
42648>>>>>>>>>>>>>>>>>Use sl054.SL         // sl054
42648>>>>>>>>>>>>>>>>>
42648>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
42648>>>>>>>>>>>>>>>>>//DDB-FileEnd
42648>>>>>>>>>>>>>>>
42648>>>>>>>>>>>>>>>//AB-IgnoreEnd
42648>>>>>>>>>>>>>>>
42648>>>>>>>>>>>>>>>Object sl054 is a dbModalPanelSub
42650>>>>>>>>>>>>>>>    Set Label to "€¨®œå¦ Ž®ž£á«à¤"
42651>>>>>>>>>>>>>>>    Set Size to 148 420
42652>>>>>>>>>>>>>>>    Set Location to 4 5
42653>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
42654>>>>>>>>>>>>>>>    Set Modal_State to FALSE
42655>>>>>>>>>>>>>>>
42655>>>>>>>>>>>>>>>    //AB-DDOStart
42655>>>>>>>>>>>>>>>
42655>>>>>>>>>>>>>>>    Object Cars_DD is a Cars_DataDictionary
42657>>>>>>>>>>>>>>>    End_Object    // Cars_DD
42658>>>>>>>>>>>>>>>
42658>>>>>>>>>>>>>>>    Set Main_DD to (Cars_DD(self))
42659>>>>>>>>>>>>>>>    Set Server to (Cars_DD(self))
42660>>>>>>>>>>>>>>>
42660>>>>>>>>>>>>>>>    //AB-DDOEnd
42660>>>>>>>>>>>>>>>
42660>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
42662>>>>>>>>>>>>>>>        Set Main_File to Cars.File_Number
42663>>>>>>>>>>>>>>>        Set Size to 105 403
42664>>>>>>>>>>>>>>>        Set Location to 6 6
42665>>>>>>>>>>>>>>>
42665>>>>>>>>>>>>>>>        Begin_Row
42668>>>>>>>>>>>>>>>            Entry_Item Cars.Car_id
42669>>>>>>>>>>>>>>>            Entry_Item Cars.Car_descr
42670>>>>>>>>>>>>>>>            Entry_Item Cars.Car_license
42671>>>>>>>>>>>>>>>            Entry_Item Cars.Car_maxm3
42672>>>>>>>>>>>>>>>            Entry_Item Cars.Car_driverid
42673>>>>>>>>>>>>>>>        End_Row
42678>>>>>>>>>>>>>>>
42678>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 80
42679>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à›.Ž®ã£˜«¦ª"
42680>>>>>>>>>>>>>>>        
42680>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 120
42681>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
42682>>>>>>>>>>>>>>>        
42682>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 80
42683>>>>>>>>>>>>>>>        Set Header_Label  item 2 to "€¨ Ÿ.‰¬¡¢¦­¦¨å˜ª"
42684>>>>>>>>>>>>>>>        
42684>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 50
42685>>>>>>>>>>>>>>>        Set Header_Label  item 3 to "Max.m3"
42686>>>>>>>>>>>>>>>        
42686>>>>>>>>>>>>>>>        Set Form_Width    item 4 to 65
42687>>>>>>>>>>>>>>>        Set Header_Label  item 4 to "‰à›.Ž›žš¦ç"
42688>>>>>>>>>>>>>>>        
42688>>>>>>>>>>>>>>>    End_Object    // oSelList
42689>>>>>>>>>>>>>>>
42689>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
42691>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
42692>>>>>>>>>>>>>>>        Set Location to 114 249
42693>>>>>>>>>>>>>>>
42693>>>>>>>>>>>>>>>        //AB-StoreStart
42693>>>>>>>>>>>>>>>        Procedure OnClick
42695>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
42696>>>>>>>>>>>>>>>        End_Procedure
42697>>>>>>>>>>>>>>>        //AB-StoreEnd
42697>>>>>>>>>>>>>>>
42697>>>>>>>>>>>>>>>    End_Object    // oOK_bn
42698>>>>>>>>>>>>>>>
42698>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
42700>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
42701>>>>>>>>>>>>>>>        Set Location to 114 305
42702>>>>>>>>>>>>>>>
42702>>>>>>>>>>>>>>>        //AB-StoreStart
42702>>>>>>>>>>>>>>>        Procedure OnClick
42704>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
42705>>>>>>>>>>>>>>>        End_Procedure
42706>>>>>>>>>>>>>>>        //AB-StoreEnd
42706>>>>>>>>>>>>>>>
42706>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
42707>>>>>>>>>>>>>>>
42707>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
42709>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
42710>>>>>>>>>>>>>>>        Set Location to 114 359
42711>>>>>>>>>>>>>>>
42711>>>>>>>>>>>>>>>        //AB-StoreStart
42711>>>>>>>>>>>>>>>        Procedure OnClick
42713>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
42714>>>>>>>>>>>>>>>        End_Procedure
42715>>>>>>>>>>>>>>>        //AB-StoreEnd
42715>>>>>>>>>>>>>>>
42715>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
42716>>>>>>>>>>>>>>>
42716>>>>>>>>>>>>>>>
42716>>>>>>>>>>>>>>>    //AB-StoreStart
42716>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
42717>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
42718>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
42719>>>>>>>>>>>>>>>    //AB-StoreEnd
42719>>>>>>>>>>>>>>>
42719>>>>>>>>>>>>>>>End_Object    // sl054
42720>>>>>>>>>>>>>>>
42720>>>>>>>>>>>>>>>//AB/ End_Object    // prj
42720>>>>>>>>>>>>>Use sl053.SL         // sl053
INCLUDING FILE: SL053.SL
42720>>>>>>>>>>>>>>>//AB/ Project sl053:pumps
42720>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
42720>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl053:pumps"
42720>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl053.SL"
42720>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
42720>>>>>>>>>>>>>>>
42720>>>>>>>>>>>>>>>// Project Object Structure
42720>>>>>>>>>>>>>>>//   sl053 is a dbModalPanelSub
42720>>>>>>>>>>>>>>>//     Pumps_DD is a DataDictionary
42720>>>>>>>>>>>>>>>//     oSelList is a dbListSub
42720>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
42720>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
42720>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
42720>>>>>>>>>>>>>>>
42720>>>>>>>>>>>>>>>// Register all objects
42720>>>>>>>>>>>>>>>Register_Object oCancel_bn
42720>>>>>>>>>>>>>>>Register_Object oOK_bn
42720>>>>>>>>>>>>>>>Register_Object oSearch_bn
42720>>>>>>>>>>>>>>>Register_Object oSelList
42720>>>>>>>>>>>>>>>Register_Object Pumps_DD
42720>>>>>>>>>>>>>>>Register_Object sl053
42720>>>>>>>>>>>>>>>
42720>>>>>>>>>>>>>>>
42720>>>>>>>>>>>>>>>//AB-IgnoreStart
42720>>>>>>>>>>>>>>>
42720>>>>>>>>>>>>>>>Use DFAllEnt.pkg
42720>>>>>>>>>>>>>>>Use dbList.Sub
42720>>>>>>>>>>>>>>>Use Button.Sub
42720>>>>>>>>>>>>>>>
42720>>>>>>>>>>>>>>>
42720>>>>>>>>>>>>>>>Use Pumps.DD
INCLUDING FILE: PUMPS.DD
42720>>>>>>>>>>>>>>>>>//DDB-FileStart
42720>>>>>>>>>>>>>>>>>//DDB-HeaderStart
42720>>>>>>>>>>>>>>>>>
42720>>>>>>>>>>>>>>>>>// File Name : PUMPS.DD
42720>>>>>>>>>>>>>>>>>// Class Name: Pumps_DataDictionary
42720>>>>>>>>>>>>>>>>>// Revision  : 11
42720>>>>>>>>>>>>>>>>>// Version   : 2
42720>>>>>>>>>>>>>>>>>
42720>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
42720>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
42720>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
42720>>>>>>>>>>>>>>>>>
42720>>>>>>>>>>>>>>>>>Open Pumps
42722>>>>>>>>>>>>>>>>>
42722>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
42722>>>>>>>>>>>>>>>>>//DDB-ValidationStart
42722>>>>>>>>>>>>>>>>>
42722>>>>>>>>>>>>>>>>>Register_Object Pumps_Ctype_Id_VT
42722>>>>>>>>>>>>>>>>>
42722>>>>>>>>>>>>>>>>>Object Pumps_Ctype_Id_VT  is a CodeValidationTable
42724>>>>>>>>>>>>>>>>>    Set Type_Value        To "PUMPSTYPE"
42725>>>>>>>>>>>>>>>>>    Set Validate_State    To FALSE
42726>>>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
42727>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
42727>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
42727>>>>>>>>>>>>>>>>>End_Object   // Pumps_Ctype_Id_VT
42728>>>>>>>>>>>>>>>>>//DDB-ValidationEnd
42728>>>>>>>>>>>>>>>>>//DDB-SelectionStart
42728>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl053  sl053.SL
42728>>>>>>>>>>>>>>>>>Register_Object sl053
42728>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
42728>>>>>>>>>>>>>>>>>
42728>>>>>>>>>>>>>>>>>Class Pumps_DataDictionary  is a DataDictionary_Sec
42729>>>>>>>>>>>>>>>>>
42729>>>>>>>>>>>>>>>>>    // Update:
42729>>>>>>>>>>>>>>>>>
42729>>>>>>>>>>>>>>>>>    Procedure Update
42730>>>>>>>>>>>>>>>>>        Forward Send Update
42732>>>>>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to Pumps.Pump_Company
42733>>>>>>>>>>>>>>>>>        Move SysCurXR.Beto_Site     to Pumps.Pump_SiteW
42734>>>>>>>>>>>>>>>>>    End_Procedure   // Update
42735>>>>>>>>>>>>>>>>>
42735>>>>>>>>>>>>>>>>>
42735>>>>>>>>>>>>>>>>>    // Define_Fields:
42735>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
42735>>>>>>>>>>>>>>>>>
42735>>>>>>>>>>>>>>>>>    Procedure Define_Fields
42736>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
42738>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
42738>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
42738>>>>>>>>>>>>>>>>>
42738>>>>>>>>>>>>>>>>>        Set Main_File            To Pumps.File_Number
42739>>>>>>>>>>>>>>>>>
42739>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
42740>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
42741>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
42742>>>>>>>>>>>>>>>>>
42742>>>>>>>>>>>>>>>>>        // Field-based properties.......................
42742>>>>>>>>>>>>>>>>>
42742>>>>>>>>>>>>>>>>>        // Pumps.Pump_Recnum
42742>>>>>>>>>>>>>>>>>
42742>>>>>>>>>>>>>>>>>        // Pumps.Pump_Company
42742>>>>>>>>>>>>>>>>>
42742>>>>>>>>>>>>>>>>>        // Pumps.Pump_Id
42742>>>>>>>>>>>>>>>>>        Set Field_Options          Field Pumps.Pump_Id To DD_AUTOFIND   
42743>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Pumps.Pump_Id To (sl053(Self))
42744>>>>>>>>>>>>>>>>>        Set Key_Field_State        Field Pumps.Pump_Id To TRUE
42745>>>>>>>>>>>>>>>>>
42745>>>>>>>>>>>>>>>>>        // Pumps.Pump_Descr
42745>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Pumps.Pump_Descr To (sl053(Self))
42746>>>>>>>>>>>>>>>>>
42746>>>>>>>>>>>>>>>>>        // Pumps.Pump_License
42746>>>>>>>>>>>>>>>>>
42746>>>>>>>>>>>>>>>>>        // Pumps.Pump_Mhkos
42746>>>>>>>>>>>>>>>>>
42746>>>>>>>>>>>>>>>>>        // Pumps.Pump_Mhkosch
42746>>>>>>>>>>>>>>>>>
42746>>>>>>>>>>>>>>>>>        // Pumps.Pump_Codematch
42746>>>>>>>>>>>>>>>>>
42746>>>>>>>>>>>>>>>>>        // Pumps.Pump_Sitew
42746>>>>>>>>>>>>>>>>>
42746>>>>>>>>>>>>>>>>>        // Pumps.Pump_Driver
42746>>>>>>>>>>>>>>>>>
42746>>>>>>>>>>>>>>>>>        // Pumps.Pump_Bsite
42746>>>>>>>>>>>>>>>>>
42746>>>>>>>>>>>>>>>>>        // Pumps.Ctype_Id
42746>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Pumps.Ctype_Id To "dbComboFormsub"
42747>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Pumps.Ctype_Id To (Pumps_Ctype_Id_VT(Self))
42748>>>>>>>>>>>>>>>>>
42748>>>>>>>>>>>>>>>>>        // Pumps.Pagiomin
42748>>>>>>>>>>>>>>>>>
42748>>>>>>>>>>>>>>>>>        // Pumps.Pricem3
42748>>>>>>>>>>>>>>>>>
42748>>>>>>>>>>>>>>>>>        // Pumps.Parakrat
42748>>>>>>>>>>>>>>>>>
42748>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
42748>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
42749>>>>>>>>>>>>>>>>>
42749>>>>>>>>>>>>>>>>>    // Field_Defaults:
42749>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
42749>>>>>>>>>>>>>>>>>
42749>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
42750>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
42752>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
42752>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
42752>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
42752>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
42753>>>>>>>>>>>>>>>>>
42753>>>>>>>>>>>>>>>>>End_Class    // Pumps_DataDictionary
42754>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
42754>>>>>>>>>>>>>>>>>
42754>>>>>>>>>>>>>>>>>Use sl053.SL         // sl053
42754>>>>>>>>>>>>>>>>>
42754>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
42754>>>>>>>>>>>>>>>>>//DDB-FileEnd
42754>>>>>>>>>>>>>>>
42754>>>>>>>>>>>>>>>//AB-IgnoreEnd
42754>>>>>>>>>>>>>>>
42754>>>>>>>>>>>>>>>Object sl053 is a dbModalPanelSub
42756>>>>>>>>>>>>>>>    Set Label to "€¨®œå¦ €¤«¢ é¤"
42757>>>>>>>>>>>>>>>    Set Size to 148 325
42758>>>>>>>>>>>>>>>    Set Location to 4 5
42759>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
42760>>>>>>>>>>>>>>>    Set Modal_State to FALSE
42761>>>>>>>>>>>>>>>
42761>>>>>>>>>>>>>>>    //AB-DDOStart
42761>>>>>>>>>>>>>>>
42761>>>>>>>>>>>>>>>    Object Pumps_DD is a Pumps_DataDictionary
42763>>>>>>>>>>>>>>>    End_Object    // Pumps_DD
42764>>>>>>>>>>>>>>>
42764>>>>>>>>>>>>>>>    Set Main_DD to (Pumps_DD(self))
42765>>>>>>>>>>>>>>>    Set Server to (Pumps_DD(self))
42766>>>>>>>>>>>>>>>
42766>>>>>>>>>>>>>>>    //AB-DDOEnd
42766>>>>>>>>>>>>>>>
42766>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
42768>>>>>>>>>>>>>>>        Set Main_File to Pumps.File_Number
42769>>>>>>>>>>>>>>>        Set Size to 105 309
42770>>>>>>>>>>>>>>>        Set Location to 6 6
42771>>>>>>>>>>>>>>>
42771>>>>>>>>>>>>>>>        Begin_Row
42774>>>>>>>>>>>>>>>            Entry_Item Pumps.Pump_id
42775>>>>>>>>>>>>>>>            Entry_Item Pumps.Pump_descr
42776>>>>>>>>>>>>>>>            Entry_Item Pumps.Pump_license
42777>>>>>>>>>>>>>>>            Entry_Item Pumps.Pump_mhkos
42778>>>>>>>>>>>>>>>        End_Row
42783>>>>>>>>>>>>>>>
42783>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 70
42784>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª €¤«¢å˜ª"
42785>>>>>>>>>>>>>>>        
42785>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 120
42786>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
42787>>>>>>>>>>>>>>>        
42787>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 65
42788>>>>>>>>>>>>>>>        Set Header_Label  item 2 to " ¤˜¡å›˜"
42789>>>>>>>>>>>>>>>        
42789>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 46
42790>>>>>>>>>>>>>>>        Set Header_Label  item 3 to "‹ã¡¦ª"
42791>>>>>>>>>>>>>>>        
42791>>>>>>>>>>>>>>>    End_Object    // oSelList
42792>>>>>>>>>>>>>>>
42792>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
42794>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
42795>>>>>>>>>>>>>>>        Set Location to 114 157
42796>>>>>>>>>>>>>>>
42796>>>>>>>>>>>>>>>        //AB-StoreStart
42796>>>>>>>>>>>>>>>        Procedure OnClick
42798>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
42799>>>>>>>>>>>>>>>        End_Procedure
42800>>>>>>>>>>>>>>>        //AB-StoreEnd
42800>>>>>>>>>>>>>>>
42800>>>>>>>>>>>>>>>    End_Object    // oOK_bn
42801>>>>>>>>>>>>>>>
42801>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
42803>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
42804>>>>>>>>>>>>>>>        Set Location to 114 212
42805>>>>>>>>>>>>>>>
42805>>>>>>>>>>>>>>>        //AB-StoreStart
42805>>>>>>>>>>>>>>>        Procedure OnClick
42807>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
42808>>>>>>>>>>>>>>>        End_Procedure
42809>>>>>>>>>>>>>>>        //AB-StoreEnd
42809>>>>>>>>>>>>>>>
42809>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
42810>>>>>>>>>>>>>>>
42810>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
42812>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
42813>>>>>>>>>>>>>>>        Set Location to 114 267
42814>>>>>>>>>>>>>>>
42814>>>>>>>>>>>>>>>        //AB-StoreStart
42814>>>>>>>>>>>>>>>        Procedure OnClick
42816>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
42817>>>>>>>>>>>>>>>        End_Procedure
42818>>>>>>>>>>>>>>>        //AB-StoreEnd
42818>>>>>>>>>>>>>>>
42818>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
42819>>>>>>>>>>>>>>>
42819>>>>>>>>>>>>>>>
42819>>>>>>>>>>>>>>>    //AB-StoreStart
42819>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
42820>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
42821>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
42822>>>>>>>>>>>>>>>    //AB-StoreEnd
42822>>>>>>>>>>>>>>>
42822>>>>>>>>>>>>>>>End_Object    // sl053
42823>>>>>>>>>>>>>>>
42823>>>>>>>>>>>>>>>//AB/ End_Object    // prj
42823>>>>>>>>>>>>>Use sl064.SL         // sl064
INCLUDING FILE: SL064.SL
42823>>>>>>>>>>>>>>>//AB/ Project sl064 : Zones
42823>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
42823>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl064 : Zones"
42823>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl064.SL"
42823>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
42823>>>>>>>>>>>>>>>
42823>>>>>>>>>>>>>>>// Project Object Structure
42823>>>>>>>>>>>>>>>//   sl064 is a dbModalPanelSub
42823>>>>>>>>>>>>>>>//     Zones_DD is a DataDictionary
42823>>>>>>>>>>>>>>>//     oSelList is a dbListSub
42823>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
42823>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
42823>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
42823>>>>>>>>>>>>>>>
42823>>>>>>>>>>>>>>>// Register all objects
42823>>>>>>>>>>>>>>>Register_Object oCancel_bn
42823>>>>>>>>>>>>>>>Register_Object oOK_bn
42823>>>>>>>>>>>>>>>Register_Object oSearch_bn
42823>>>>>>>>>>>>>>>Register_Object oSelList
42823>>>>>>>>>>>>>>>Register_Object sl064
42823>>>>>>>>>>>>>>>Register_Object Zones_DD
42823>>>>>>>>>>>>>>>
42823>>>>>>>>>>>>>>>
42823>>>>>>>>>>>>>>>//AB-IgnoreStart
42823>>>>>>>>>>>>>>>
42823>>>>>>>>>>>>>>>Use DFAllEnt.pkg
42823>>>>>>>>>>>>>>>Use dbList.Sub
42823>>>>>>>>>>>>>>>Use Button.Sub
42823>>>>>>>>>>>>>>>
42823>>>>>>>>>>>>>>>
42823>>>>>>>>>>>>>>>Use ZONES.DD
INCLUDING FILE: ZONES.DD
42823>>>>>>>>>>>>>>>>>//DDB-FileStart
42823>>>>>>>>>>>>>>>>>//DDB-HeaderStart
42823>>>>>>>>>>>>>>>>>
42823>>>>>>>>>>>>>>>>>// File Name : ZONES.DD
42823>>>>>>>>>>>>>>>>>// Class Name: Zones_DataDictionary
42823>>>>>>>>>>>>>>>>>// Revision  : 2
42823>>>>>>>>>>>>>>>>>// Version   : 2
42823>>>>>>>>>>>>>>>>>
42823>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
42823>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
42823>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
42823>>>>>>>>>>>>>>>>>
42823>>>>>>>>>>>>>>>>>Open Zones
INCLUDING FILE: ZONES.FD
42825>>>>>>>>>>>>>>>>>Open Brzones
42827>>>>>>>>>>>>>>>>>
42827>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
42827>>>>>>>>>>>>>>>>>//DDB-SelectionStart
42827>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl064  sl064.SL
42827>>>>>>>>>>>>>>>>>Register_Object sl064
42827>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
42827>>>>>>>>>>>>>>>>>
42827>>>>>>>>>>>>>>>>>Class Zones_DataDictionary  is a DataDictionary_Sec
42828>>>>>>>>>>>>>>>>>
42828>>>>>>>>>>>>>>>>>    // Define_Fields:
42828>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
42828>>>>>>>>>>>>>>>>>
42828>>>>>>>>>>>>>>>>>    Procedure Define_Fields
42829>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
42831>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
42831>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
42831>>>>>>>>>>>>>>>>>
42831>>>>>>>>>>>>>>>>>        Set Main_File            To Zones.File_Number
42832>>>>>>>>>>>>>>>>>
42832>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
42833>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
42834>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
42835>>>>>>>>>>>>>>>>>
42835>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
42835>>>>>>>>>>>>>>>>>        Send Add_Client_File  Brzones.File_Number
42836>>>>>>>>>>>>>>>>>
42836>>>>>>>>>>>>>>>>>        // Field-based properties.......................
42836>>>>>>>>>>>>>>>>>
42836>>>>>>>>>>>>>>>>>        // Zones.Zone_Id
42836>>>>>>>>>>>>>>>>>        Set Field_Options          Field Zones.Zone_Id To DD_AUTOFIND
42837>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Zones.Zone_Id To (sl064(Self))
42838>>>>>>>>>>>>>>>>>
42838>>>>>>>>>>>>>>>>>        // Zones.Zone_Descr
42838>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Zones.Zone_Descr To (sl064(Self))
42839>>>>>>>>>>>>>>>>>
42839>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
42839>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
42840>>>>>>>>>>>>>>>>>
42840>>>>>>>>>>>>>>>>>    // Field_Defaults:
42840>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
42840>>>>>>>>>>>>>>>>>
42840>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
42841>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
42843>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
42843>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
42843>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
42843>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
42844>>>>>>>>>>>>>>>>>
42844>>>>>>>>>>>>>>>>>End_Class    // Zones_DataDictionary
42845>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
42845>>>>>>>>>>>>>>>>>
42845>>>>>>>>>>>>>>>>>Use sl064.SL         // sl064
42845>>>>>>>>>>>>>>>>>
42845>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
42845>>>>>>>>>>>>>>>>>//DDB-FileEnd
42845>>>>>>>>>>>>>>>
42845>>>>>>>>>>>>>>>//AB-IgnoreEnd
42845>>>>>>>>>>>>>>>
42845>>>>>>>>>>>>>>>CD_Popup_Object sl064 is a dbModalPanelSub
42864>>>>>>>>>>>>>>>    Set Label to "…é¤œª"
42865>>>>>>>>>>>>>>>    Set Size to 148 297
42866>>>>>>>>>>>>>>>    Set Location to 4 5
42867>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
42868>>>>>>>>>>>>>>>    Set Modal_State to FALSE
42869>>>>>>>>>>>>>>>
42869>>>>>>>>>>>>>>>    //AB-DDOStart
42869>>>>>>>>>>>>>>>
42869>>>>>>>>>>>>>>>    Object Zones_DD is a Zones_DataDictionary
42871>>>>>>>>>>>>>>>    End_Object    // Zones_DD
42872>>>>>>>>>>>>>>>
42872>>>>>>>>>>>>>>>    Set Main_DD to (Zones_DD(self))
42873>>>>>>>>>>>>>>>    Set Server to (Zones_DD(self))
42874>>>>>>>>>>>>>>>
42874>>>>>>>>>>>>>>>    //AB-DDOEnd
42874>>>>>>>>>>>>>>>
42874>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
42876>>>>>>>>>>>>>>>        Set Main_File to Zones.File_Number
42877>>>>>>>>>>>>>>>        Set Size to 105 280
42878>>>>>>>>>>>>>>>        Set Location to 6 6
42879>>>>>>>>>>>>>>>
42879>>>>>>>>>>>>>>>        Begin_Row
42882>>>>>>>>>>>>>>>            Entry_Item Zones.Zone_id
42883>>>>>>>>>>>>>>>            Entry_Item Zones.Zone_descr
42884>>>>>>>>>>>>>>>        End_Row
42889>>>>>>>>>>>>>>>
42889>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 73
42890>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
42891>>>>>>>>>>>>>>>        
42891>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 199
42892>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
42893>>>>>>>>>>>>>>>        
42893>>>>>>>>>>>>>>>    End_Object    // oSelList
42894>>>>>>>>>>>>>>>
42894>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
42896>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
42897>>>>>>>>>>>>>>>        Set Location to 115 126
42898>>>>>>>>>>>>>>>
42898>>>>>>>>>>>>>>>        //AB-StoreStart
42898>>>>>>>>>>>>>>>        Procedure OnClick
42900>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
42901>>>>>>>>>>>>>>>        End_Procedure
42902>>>>>>>>>>>>>>>        //AB-StoreEnd
42902>>>>>>>>>>>>>>>
42902>>>>>>>>>>>>>>>    End_Object    // oOK_bn
42903>>>>>>>>>>>>>>>
42903>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
42905>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
42906>>>>>>>>>>>>>>>        Set Location to 115 181
42907>>>>>>>>>>>>>>>
42907>>>>>>>>>>>>>>>        //AB-StoreStart
42907>>>>>>>>>>>>>>>        Procedure OnClick
42909>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
42910>>>>>>>>>>>>>>>        End_Procedure
42911>>>>>>>>>>>>>>>        //AB-StoreEnd
42911>>>>>>>>>>>>>>>
42911>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
42912>>>>>>>>>>>>>>>
42912>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
42914>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
42915>>>>>>>>>>>>>>>        Set Location to 115 236
42916>>>>>>>>>>>>>>>
42916>>>>>>>>>>>>>>>        //AB-StoreStart
42916>>>>>>>>>>>>>>>        Procedure OnClick
42918>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
42919>>>>>>>>>>>>>>>        End_Procedure
42920>>>>>>>>>>>>>>>        //AB-StoreEnd
42920>>>>>>>>>>>>>>>
42920>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
42921>>>>>>>>>>>>>>>
42921>>>>>>>>>>>>>>>
42921>>>>>>>>>>>>>>>    //AB-StoreStart
42921>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
42922>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
42923>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
42924>>>>>>>>>>>>>>>    //AB-StoreEnd
42924>>>>>>>>>>>>>>>
42924>>>>>>>>>>>>>>>CD_End_Object    // sl064
42926>>>>>>>>>>>>>>>>
42926>>>>>>>>>>>>>>>
42926>>>>>>>>>>>>>>>//AB/ End_Object    // prj
42926>>>>>>>>>>>>>
42926>>>>>>>>>>>>>//DDB-Selection-pkg-End
42926>>>>>>>>>>>>>//DDB-FileEnd
42926>>>>>>>>>>>    Use WAPOKAT.DD
42926>>>>>>>>>>>    Use WAPOMAST.DD
42926>>>>>>>>>>>    Use WAX.DD
42926>>>>>>>>>>>    Use UNITS.DD
42926>>>>>>>>>>>    Use WITEMKAT.DD
42926>>>>>>>>>>>    Use FPA.DD
42926>>>>>>>>>>>    Use ITEM.DD
42926>>>>>>>>>>>    Use WITEMX.DD
42926>>>>>>>>>>>    Use PMOVES.DD
INCLUDING FILE: PMOVES.DD
42926>>>>>>>>>>>>>//DDB-FileStart
42926>>>>>>>>>>>>>//DDB-HeaderStart
42926>>>>>>>>>>>>>
42926>>>>>>>>>>>>>// File Name : PMOVES.DD
42926>>>>>>>>>>>>>// Class Name: Pmoves_DataDictionary
42926>>>>>>>>>>>>>// Revision  : 135
42926>>>>>>>>>>>>>// Version   : 2
42926>>>>>>>>>>>>>
42926>>>>>>>>>>>>>Use  Windows           // Basic Definitions
42926>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
42926>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
42926>>>>>>>>>>>>>
42926>>>>>>>>>>>>>Open Pmoves
42928>>>>>>>>>>>>>Open Pmsdtl
INCLUDING FILE: PMSDTL.FD
42930>>>>>>>>>>>>>Open Pmssxet
42932>>>>>>>>>>>>>Open Wax
42934>>>>>>>>>>>>>Open Witemx
42936>>>>>>>>>>>>>Open Particle
42938>>>>>>>>>>>>>Open Sysrecp
42940>>>>>>>>>>>>>Open Syscurxr
42942>>>>>>>>>>>>>Open Partlfpa
42944>>>>>>>>>>>>>Open Clorder
42946>>>>>>>>>>>>>Open Clorderd
42948>>>>>>>>>>>>>Open Btnemp
INCLUDING FILE: BTNEMP.FD
42950>>>>>>>>>>>>>
42950>>>>>>>>>>>>>//DDB-HeaderEnd
42950>>>>>>>>>>>>>Open Fpa
42952>>>>>>>>>>>>>Open PartlFpa 
42954>>>>>>>>>>>>>Open Item
42956>>>>>>>>>>>>>Open Wtypkin
42958>>>>>>>>>>>>>Open Witemkat
42960>>>>>>>>>>>>>Open Wapomast     
42962>>>>>>>>>>>>>Open Wapokat
42964>>>>>>>>>>>>>Open Payresp
42966>>>>>>>>>>>>>
42966>>>>>>>>>>>>>Class Pmoves_DataDictionary  is a DataDictionary_Sec
42967>>>>>>>>>>>>>
42967>>>>>>>>>>>>>    // Delete_Main_File:
42967>>>>>>>>>>>>>
42967>>>>>>>>>>>>>    Procedure Delete_Main_File
42968>>>>>>>>>>>>>        clear btnemp
42969>>>>>>>>>>>>>        move pmoves.pms_recr to btnemp.pms_recr
42970>>>>>>>>>>>>>        find ge btnemp by index.11
42971>>>>>>>>>>>>>>
42971>>>>>>>>>>>>>        if ((found=1) and (pmoves.pms_recr=btnemp.pms_recr)) begin
42973>>>>>>>>>>>>>           move 0 to btnemp.pms_recr
42974>>>>>>>>>>>>>           saverecord btnemp
42975>>>>>>>>>>>>>        end
42975>>>>>>>>>>>>>>
42975>>>>>>>>>>>>>        Forward Send Delete_Main_File
42977>>>>>>>>>>>>>        // Insert Code Here
42977>>>>>>>>>>>>>    End_Procedure   // Delete_Main_File
42978>>>>>>>>>>>>>
42978>>>>>>>>>>>>>
42978>>>>>>>>>>>>>    Procedure Construct_Object
42979>>>>>>>>>>>>>        Forward Send Construct_Object
42981>>>>>>>>>>>>>        Property Number  pnoQty         Public  0
42982>>>>>>>>>>>>>        Property integer pifromclorder  Public  0
42983>>>>>>>>>>>>>        Property Integer piCheckZeroFpa Public  0
42984>>>>>>>>>>>>>        Property Integer piPmsSxetID    Public  0
42985>>>>>>>>>>>>>        Property integer piFromMetasx   Public  0
42986>>>>>>>>>>>>>    End_Procedure
42987>>>>>>>>>>>>>
42987>>>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
42988>>>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
42990>>>>>>>>>>>>>        Set pnoQty      to Pmoves.Pms_Qty
42991>>>>>>>>>>>>>    End_Procedure   // New_Current_Record
42992>>>>>>>>>>>>>
42992>>>>>>>>>>>>>    Procedure Save_Main_File
42993>>>>>>>>>>>>>        Integer iYes
42994>>>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
42996>>>>>>>>>>>>>            If Pmoves.Recnum Eq 0 Procedure_Return
42999>>>>>>>>>>>>>        End
42999>>>>>>>>>>>>>>
42999>>>>>>>>>>>>>
42999>>>>>>>>>>>>>        If ((Operation_Origin=Self) And (piCheckZeroFpa(Self))) Begin
43001>>>>>>>>>>>>>            // Elegxos FPA
43001>>>>>>>>>>>>>            // An typonei otidhpote ektos apo 1 (mono Posothtes)
43001>>>>>>>>>>>>>            If ((Ptyppar.Ti_Typonei_Pms<>'1')   And ;                (Pmoves.Pms_Vatam=0)            And ;                (Operation_Mode<>MODE_DELETING)) Begin
43003>>>>>>>>>>>>>                Move (YesNo_Box("¦©æ ”€ £ž›œ¤ ¡æ. Œ˜ ©¬¤œ®å©à ;", ;                                     "¨¦©¦®ã",  MB_DEFBUTTON2) ) to iYes
43004>>>>>>>>>>>>>                If (iYes=MBR_NO)  Send Operation_Not_Allowed 8000
43007>>>>>>>>>>>>>            End
43007>>>>>>>>>>>>>>
43007>>>>>>>>>>>>>        End
43007>>>>>>>>>>>>>>
43007>>>>>>>>>>>>>        Forward Send Save_Main_File
43009>>>>>>>>>>>>>    End_Procedure
43010>>>>>>>>>>>>>
43010>>>>>>>>>>>>>    Function fnTeleytaiaTimh Returns Number
43011>>>>>>>>>>>>>        Number  rVal nQty
43012>>>>>>>>>>>>>        String  sClientID sWitemxCode
43012>>>>>>>>>>>>>        Date    dHmnia
43012>>>>>>>>>>>>>        String  sWhat sRecr sClientCode sItemCode sCN
43012>>>>>>>>>>>>>
43012>>>>>>>>>>>>>        Get File_Field_Current_Value File_Field Ptyppar.Ptyppar_Is_What to sWhat
43013>>>>>>>>>>>>>        If (Trim(sWhat)='1') Begin
43015>>>>>>>>>>>>>            // 1=€š¦¨œª
43015>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Witemx.Witemx_Recr      to sRecr
43016>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Pms_Qty          to nQty
43017>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_Hmnia    to dHmnia
43018>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Item.Item_Code          to sItemCode
43019>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Clients.Client_ID       to sClientCode
43020>>>>>>>>>>>>>            // Sto arxeio Globals.inc
43020>>>>>>>>>>>>>            Get fnTeleytaiaTimhAgoras sClientCode sItemCode dHmnia nQty to rVal
43021>>>>>>>>>>>>>        End
43021>>>>>>>>>>>>>>
43021>>>>>>>>>>>>>        Else If (Trim(sWhat)='2') Begin
43024>>>>>>>>>>>>>            // 2=à¢ã©œ ª
43024>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Pms_Qty          to nQty
43025>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Item.Item_Code          to sItemCode
43026>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_Hmnia    to dHmnia
43027>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Cn_Code        to sCN
43028>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Witemx.Witemx_Recr      to sRecr
43029>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Clients.Client_ID       to sClientID
43030>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Witemx.Witemx_Code      to sWitemxCode
43031>>>>>>>>>>>>>            // Sto arxeio Globals.inc
43031>>>>>>>>>>>>>            Get fnTeleytaiaTimhPolhshs sRecr sClientID sWitemxCode dHmnia sItemCode nQty sCN to rVal
43032>>>>>>>>>>>>>        End
43032>>>>>>>>>>>>>>
43032>>>>>>>>>>>>>        Function_Return rVal
43033>>>>>>>>>>>>>    End_Function
43034>>>>>>>>>>>>>
43034>>>>>>>>>>>>>    Procedure Creating
43035>>>>>>>>>>>>>        Forward Send Creating
43037>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Pmoves.Pms_Rec0)))))) to Pmoves.Pms_Recr
43038>>>>>>>>>>>>>    End_Procedure   // Creating
43039>>>>>>>>>>>>>
43039>>>>>>>>>>>>>    Procedure Update
43040>>>>>>>>>>>>>        Integer iDecimals
43041>>>>>>>>>>>>>        Number  nInt
43041>>>>>>>>>>>>>        String  sCurrentUser
43041>>>>>>>>>>>>>
43041>>>>>>>>>>>>>        Forward Send Update
43043>>>>>>>>>>>>>
43043>>>>>>>>>>>>>        Move SysCurXR.Company_Code                          to Pmoves.Company_Code
43044>>>>>>>>>>>>>        Move SysCurXR.Branch_Code                           to Pmoves.Branch_Code
43045>>>>>>>>>>>>>        Move SysCurXR.Year_Year                             to Pmoves.Year_Year
43046>>>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code                           to Pmoves.Ctypkin_Code
43047>>>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code                           to Pmoves.Wtypkin_Code
43048>>>>>>>>>>>>>
43048>>>>>>>>>>>>>        Move Witemkat.Witemkat_Code                         to Pmoves.Witemkat_Code
43049>>>>>>>>>>>>>        Move Item.Item_Code                                 to Pmoves.Item_Code
43050>>>>>>>>>>>>>        Move Witemx.Witemx_Code                             to Pmoves.Witemx_Code
43051>>>>>>>>>>>>>        Move Wapokat.Wapokat_Code                           to Pmoves.Wapokat_Code
43052>>>>>>>>>>>>>        Move Wapomast.Wapomast_Code                         to Pmoves.Wapomast_Code
43053>>>>>>>>>>>>>        Move Wax.Wax_Code                                   to Pmoves.Wax_Code
43054>>>>>>>>>>>>>
43054>>>>>>>>>>>>>        //Move Custprom.Custprom_Code                         to Pmoves.Custprom_Code
43054>>>>>>>>>>>>>        Move Clients.Client_ID                              to Pmoves.Client_ID
43055>>>>>>>>>>>>>        Move Ptyppar.Ptyppar_Code                           to Pmoves.Ptyppar_Code
43056>>>>>>>>>>>>>        Move Ptyppar.TI_TYPONEI_PMS                         to Pmoves.TI_TYPONEI_PMS
43057>>>>>>>>>>>>>        Move Particle.PSeira_Seira                          to Pmoves.Pseira_Seira
43058>>>>>>>>>>>>>
43058>>>>>>>>>>>>>        Move Nomisma.Nomisma_Code                           to Pmoves.Pms_Sc_Code2
43059>>>>>>>>>>>>>        Move Nomisma.Dekadika                               To iDecimals
43060>>>>>>>>>>>>>
43060>>>>>>>>>>>>>        Move Particle.CN_Code                               to Pmoves.CN_Code
43061>>>>>>>>>>>>>        Move Particle.Partl_No                              to Pmoves.Partl_No
43062>>>>>>>>>>>>>        Move Particle.Partl_Hmnia                           to Pmoves.Partl_Hmnia
43063>>>>>>>>>>>>>        Move Particle.Partl_Module                          to Pmoves.Pms_Module
43064>>>>>>>>>>>>>        Move Particle.Partl_Rec0                            to Pmoves.Partl_Rec0
43065>>>>>>>>>>>>>
43065>>>>>>>>>>>>>        Move Particle.Sls_ID                                to Pmoves.Sls_ID
43066>>>>>>>>>>>>>        Move Particle.Presp_ID                              to Pmoves.Presp_ID
43067>>>>>>>>>>>>>        Move Particle.Cnt_ID                                to Pmoves.Cnt_ID
43068>>>>>>>>>>>>>        Move Item.Units_Code                                to Pmoves.Pms_UnitCode
43069>>>>>>>>>>>>>        move witemx.witemx_descr                            to pmoves.witemx_descr
43070>>>>>>>>>>>>>        move ptyppar.ptyppar_descr                          to pmoves.ptyppar_descr
43071>>>>>>>>>>>>>        move clients.client_name                            to pmoves.client_name
43072>>>>>>>>>>>>>        move particle.antlia_code                           to pmoves.pump_id
43073>>>>>>>>>>>>>        move particle.oxhma_code                            to pmoves.car_id
43074>>>>>>>>>>>>>        if (particle.zone_id='') move pmoves.zone           to particle.zone_id
43077>>>>>>>>>>>>>        else move particle.Zone_ID                          to pmoves.Zone
43079>>>>>>>>>>>>>        
43079>>>>>>>>>>>>>        Move (Pmoves.Pms_Qty-Pmoves.Timol_Qty)              to Pmoves.Timol_Ypol
43080>>>>>>>>>>>>>
43080>>>>>>>>>>>>>        Move (Pmoves.Qty_Kinhshs>0)                         to Pmoves.pms_Selected
43081>>>>>>>>>>>>>
43081>>>>>>>>>>>>>        Move (Round_Number((Pmoves.Pms_Qty*Pmoves.Pms_UnitPrice),iDecimals))    ;                                                            to Pmoves.Pms_Ambd
43082>>>>>>>>>>>>>        Move (Round_Number((Pmoves.Pms_Ambd*Pmoves.Pms_PctDisc/100),iDecimals)) ;                                                            to Pmoves.Pms_Discam
43083>>>>>>>>>>>>>        Move (Pmoves.Pms_Ambd-Pmoves.Pms_Discam)            to Pmoves.Pms_Amaftdisc
43084>>>>>>>>>>>>>
43084>>>>>>>>>>>>>        Move (Round_Number((Pmoves.Pms_Amaftdisc*Pmoves.Pms_Vatpct/100),iDecimals));                                                            to Pmoves.Pms_Vatam
43085>>>>>>>>>>>>>        Move (Pmoves.Pms_Amaftdisc+Pmoves.Pms_Vatam)        to Pmoves.Pms_Payable
43086>>>>>>>>>>>>>        Move Pmoves.Pms_Payable                             to Pmoves.Pms_Axia
43087>>>>>>>>>>>>>
43087>>>>>>>>>>>>>        Add Pmoves.Pms_Qty                                  to Particle.Partl_TotTem
43088>>>>>>>>>>>>>        Add Pmoves.Timol_Qty                                to Particle.Timol_Qty
43089>>>>>>>>>>>>>
43089>>>>>>>>>>>>>        Add Pmoves.Pms_Ambd                                 to Particle.Partl_TotAmBD
43090>>>>>>>>>>>>>        Add Pmoves.Pms_DiscAm                               to Particle.Partl_AMDISCPMS
43091>>>>>>>>>>>>>        Add Pmoves.Pms_Amaftdisc                            to Particle.Partl_TotAmAd
43092>>>>>>>>>>>>>        Add Pmoves.Pms_Vatam                                to Particle.Partl_Vatam
43093>>>>>>>>>>>>>        Add 1                                               to Particle.Partl_NoOfLines
43094>>>>>>>>>>>>>
43094>>>>>>>>>>>>>        If (Pmoves.Pms_Vatam) Begin
43096>>>>>>>>>>>>>            Clear PartlFpa
43097>>>>>>>>>>>>>            Move Particle.Partl_Recr                            to PartlFpa.Partl_Recr
43098>>>>>>>>>>>>>            Move Pmoves.Pms_VatPct                              to PartlFpa.Fpa_Pososto
43099>>>>>>>>>>>>>            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
43100>>>>>>>>>>>>>>
43100>>>>>>>>>>>>>            Add Pmoves.Pms_Vatam                                to PartlFpa.PartlFpa_Poso
43101>>>>>>>>>>>>>            Saverecord PartlFpa
43102>>>>>>>>>>>>>        End
43102>>>>>>>>>>>>>>
43102>>>>>>>>>>>>>
43102>>>>>>>>>>>>>        // An einai parastatiko polhshs kai to ptyppar einai flagarismeno oti
43102>>>>>>>>>>>>>        // prepei na enhmerosh to pedio Clients.Posa_apo_dap
43102>>>>>>>>>>>>>        // tote theoroume oti ypoxreotika prepei na vroume timh apo
43102>>>>>>>>>>>>>        // function timokatalogon kai na thn krathsoume sto pedio
43102>>>>>>>>>>>>>        // Pmoves.Posa_apo_dap
43102>>>>>>>>>>>>>        If ((Ptyppar.Ptyppar_Is_What='2') And (Ptyppar.Check_Posa_Plaf='1')) Begin
43104>>>>>>>>>>>>>            // An to pedio Particle.Partl_Vsn einai 0 tote shmainei
43104>>>>>>>>>>>>>            // oti den einai parastatiko metasxhmatismeno (px D.AP) ara
43104>>>>>>>>>>>>>            // h update prepei na prosthesei sto antistoixo pedio client
43104>>>>>>>>>>>>>            // An omos einai metasxhmatismeno (px apo D.AP tora einai
43104>>>>>>>>>>>>>            // Timologio) tote  prepei h update na afairesei apo to pedio
43104>>>>>>>>>>>>>            // tou client dioti to arxiko D.AP eixe prosthesei.
43104>>>>>>>>>>>>>
43104>>>>>>>>>>>>>            Move (Round_Number(Pmoves.Pms_Payable,2)) to Pmoves.Posa_Apo_Dap
43105>>>>>>>>>>>>>
43105>>>>>>>>>>>>>            If (Particle.Partl_Vsn=0) Begin
43107>>>>>>>>>>>>>                Add Pmoves.Posa_Apo_Dap to Clients.Posa_Apo_Dap
43108>>>>>>>>>>>>>                Add Pmoves.Posa_Apo_Dap to Payresp.Posa_Apo_Dap
43109>>>>>>>>>>>>>            End
43109>>>>>>>>>>>>>>
43109>>>>>>>>>>>>>            Else Begin
43110>>>>>>>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Clients.Posa_Apo_Dap
43111>>>>>>>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Payresp.Posa_Apo_Dap
43112>>>>>>>>>>>>>            End
43112>>>>>>>>>>>>>>
43112>>>>>>>>>>>>>        End
43112>>>>>>>>>>>>>>
43112>>>>>>>>>>>>>
43112>>>>>>>>>>>>>        Add Pmoves.Qty_Kinhshs  to Particle.Partl_Disctof
43113>>>>>>>>>>>>>
43113>>>>>>>>>>>>>    End_Procedure   // Update
43114>>>>>>>>>>>>>
43114>>>>>>>>>>>>>    // Backout:
43114>>>>>>>>>>>>>    Procedure Backout
43115>>>>>>>>>>>>>
43115>>>>>>>>>>>>>        Forward Send Backout
43117>>>>>>>>>>>>>
43117>>>>>>>>>>>>>        Sub Pmoves.Pms_Qty        From Particle.Partl_TotTem
43118>>>>>>>>>>>>>        Sub Pmoves.Timol_Qty      From Particle.Timol_Qty
43119>>>>>>>>>>>>>        Sub Pmoves.Pms_Ambd       From Particle.Partl_TotAmBD
43120>>>>>>>>>>>>>        Sub Pmoves.Pms_DiscAm     From Particle.Partl_AMDISCPMS
43121>>>>>>>>>>>>>        Sub Pmoves.Pms_Amaftdisc  From Particle.Partl_TotAmAd
43122>>>>>>>>>>>>>        Sub Pmoves.Pms_Vatam      From Particle.Partl_Vatam
43123>>>>>>>>>>>>>        Sub 1                     From Particle.Partl_NoOfLines
43124>>>>>>>>>>>>>
43124>>>>>>>>>>>>>        If (Pmoves.Pms_Vatam) Begin
43126>>>>>>>>>>>>>            Clear PartlFpa
43127>>>>>>>>>>>>>            Move Particle.Partl_Recr    to PartlFpa.Partl_Recr
43128>>>>>>>>>>>>>            Move Pmoves.Pms_VatPct      to PartlFpa.Fpa_Pososto
43129>>>>>>>>>>>>>            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
43130>>>>>>>>>>>>>>
43130>>>>>>>>>>>>>            Sub Pmoves.Pms_Vatam      From PartlFpa.PartlFpa_Poso
43131>>>>>>>>>>>>>            Saverecord PartlFpa
43132>>>>>>>>>>>>>        End
43132>>>>>>>>>>>>>>
43132>>>>>>>>>>>>>
43132>>>>>>>>>>>>>        // An einai parastatiko polhshs kai to ptyppar einai flagarismeno oti
43132>>>>>>>>>>>>>        // prepei na enhmerosh to pedio Clients.Posa_apo_dap
43132>>>>>>>>>>>>>        // tote theoroume oti ypoxreotika prepei na vroume timh sto pedio
43132>>>>>>>>>>>>>        // Pmoves.Posa_apo_dap
43132>>>>>>>>>>>>>        If ((Ptyppar.Ptyppar_Is_What='2') And (Ptyppar.Check_Posa_Plaf='1')) Begin
43134>>>>>>>>>>>>>            // An to pedio Particle.Partl_Vsn einai 0 tote shmainei
43134>>>>>>>>>>>>>            // oti den einai parastatiko metasxhmatismeno (px D.AP) ara
43134>>>>>>>>>>>>>            // h backout prepei na afairesei apo antistoixo pedio client
43134>>>>>>>>>>>>>            // An omos einai metasxhmatismeno (px apo D.AP tora einai
43134>>>>>>>>>>>>>            // Timologio) tote  prepei h backout na prosthesi sto pedio
43134>>>>>>>>>>>>>            // tou client dioti to arxiko D.AP eixe afairethei.
43134>>>>>>>>>>>>>            If (Particle.Partl_Vsn=0) Begin
43136>>>>>>>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Clients.Posa_Apo_Dap
43137>>>>>>>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Payresp.Posa_Apo_Dap
43138>>>>>>>>>>>>>            End
43138>>>>>>>>>>>>>>
43138>>>>>>>>>>>>>            Else Begin
43139>>>>>>>>>>>>>                Add Pmoves.Posa_Apo_Dap to Clients.Posa_Apo_Dap
43140>>>>>>>>>>>>>                Add Pmoves.Posa_Apo_Dap to Payresp.Posa_Apo_Dap
43141>>>>>>>>>>>>>            End
43141>>>>>>>>>>>>>>
43141>>>>>>>>>>>>>        End
43141>>>>>>>>>>>>>>
43141>>>>>>>>>>>>>
43141>>>>>>>>>>>>>        Sub Pmoves.Qty_Kinhshs From Particle.Partl_Disctof
43142>>>>>>>>>>>>>
43142>>>>>>>>>>>>>    End_Procedure   // Backout
43143>>>>>>>>>>>>>
43143>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
43144>>>>>>>>>>>>>             If (iError_Num = 1001) Error 1001 "DDC 18: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ©«¦ Wax"
43147>>>>>>>>>>>>>        Else If (iError_Num = 1002) Error 1002 "DDC 18: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ©«¦ Witemx"
43151>>>>>>>>>>>>>        Else If (iError_Num = 1003) Error 1003 "DDC 18: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ©«¦ Particle"
43155>>>>>>>>>>>>>        Else If (iError_Num = 1004) Error 1004 "DDC 18: ¦©æ«ž«˜ „å›¦¬ª ‹ž›œ¤ ¡ã\nƒ ˜š¨á¯«œ ˜¤ Ÿâ¢œ«œ, «ž š¨˜££ã «¦¬ œå›¦¬ª"
43159>>>>>>>>>>>>>        Else If (iError_Num = 1005) Error 1005 "DDC 18: ¦©æ §¨¦ „¡§«à©žª ‹ž›œ¤ ¡æ"
43163>>>>>>>>>>>>>        Else If (iError_Num = 1006) Error 1006 "DDC 18: ¦©æ §¨¦ ”€ ‹ž›œ¤ ¡æ"
43167>>>>>>>>>>>>>        Else If (iError_Num = 1007) Error 1007 "DDC 18: ¦©æ ¢ž¨à«â¦ „å›¦¬ª ‹ž›œ¤ ¡æ"
43171>>>>>>>>>>>>>        Else If (iError_Num = 1009) Error 1009 "DDC 18: ƒœ¤ œå¤˜  œ­ ¡«ã ž › ˜š¨˜­ã \n„®œ  ›ž£ ¦¬¨šžŸœå £œ«˜©®ž£˜« ©£â¤¦ §˜¨˜©«˜« ¡æ"
43175>>>>>>>>>>>>>        Else If (iError_Num = 1010) Error 1010 "DDC 18: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ §œ¢á«ž"
43179>>>>>>>>>>>>>        Else If (iError_Num = 1011) Error 1011 "DDC 18: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ ¬§. §¢ž¨à£ãª"
43183>>>>>>>>>>>>>        Else If (iError_Num = 1012) Error 1012 "DDC 18: ’¦ œå›¦ª ˜¬«æ §¨¦ã¢Ÿœ ˜§¦ £œ«˜©®ž£˜« ©£æ ¡˜  ›œ¤ › ˜š¨á­œ«˜ .\nƒ ˜š¨á¯«œ «¦ §˜¨˜©«˜« ¡æ ¡˜  ¥˜¤˜£œ«˜©®ž£˜«å©«œ «¦ ˜¨® ¡æ."
43187>>>>>>>>>>>>>        Else If (iError_Num = 1013) Error 1013 "DDC 18: ’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\n‰ ¤ãŸž¡œ §¦©æ«ž«˜ > ˜§¦ «ž › ˜Ÿâ© £ž"
43191>>>>>>>>>>>>>        Else If (iError_Num = 1111) Error 1111 "DDC 18: ƒœ¤ â®œ  ¡˜«˜®à¨žŸœå ©«¦ ©ç©«ž£˜ «â«¦ ¦ §¦©¦©«æ ”€"
43195>>>>>>>>>>>>>        Else If (iError_Num = 1105) Error 1105 "DDC 18: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
43199>>>>>>>>>>>>>        Else If (iError_Num = 1106) Error 1106 "DDC 18: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
43203>>>>>>>>>>>>>        Else If (iError_Num = 1107) Error 1107 "DDC 18: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
43207>>>>>>>>>>>>>        Else If (iError_Num = 1108) Error 1108 "DDC 18: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
43211>>>>>>>>>>>>>        Else If (iError_Num = 1110) Error 1110 "DDC 18: †£/¤å˜ §˜¨˜©«˜« ¡¦ç <= †£/¤å˜ª ¡¢œ ©å£˜«¦ª\nƒœ¤ œ§ «¨â§œ«˜  ¡˜££å˜ «¨¦§¦§¦åž©ž ©«¦ §˜¨˜©«˜« ¡æ"
43215>>>>>>>>>>>>>        Else If (iError_Num = 6001) Error 6001 "DDC 18: ƒœ¤ §¨¦¡ç§«œ  §¦©¦ ˜§¦ « £¦¡˜«á¢¦š¦"
43219>>>>>>>>>>>>>        Else If (iError_Num = 7000) Error 7000 "DDC 18: ¨¦â¨®œ«˜  ˜§¦ ˜¨˜ššœ¢å˜. † š¨˜££ã ˜¬«ã £æ¤¦ › ˜š¨á­œ«˜ "
43223>>>>>>>>>>>>>        Else If (iError_Num = 7001) Error 7001 "DDC 18: ’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ."
43227>>>>>>>>>>>>>        Else If (iError_Num = 7005) Error 7005 "DDC 18: † §¦©æ«ž«˜ ›œ¤ «¨¦§¦§¦ œå«˜  š ˜«  §¨¦ã¢Ÿœ ˜§¦ £œ«˜©®ž£˜« ©£æ.\nƒ ˜š¨á¯«œ «¦ §˜¨˜©«˜« ¡æ ¡˜  ¥˜¤˜£œ«˜©®ž£˜«å©«œ «¦ ˜¨® ¡æ."
43231>>>>>>>>>>>>>        Else If (iError_Num = 8000) Error 8000 "DDC 18: €¡¬¨éŸž¡œ ž ¡˜«˜®é¨ž©ž «¦¬ œå›¦¬ª ˜§¦ «¦¤ ®¨ã©«ž\n‹œ«˜ «¦ Ž‰, §˜«ã©«œ F5"
43235>>>>>>>>>>>>>        Else Forward Send Operation_Not_Allowed  iError_Num
43238>>>>>>>>>>>>>    End_Procedure   // Operation_Not_Allowed
43239>>>>>>>>>>>>>
43239>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
43240>>>>>>>>>>>>>        Integer iReturnVal iFpaRecnum iYes
43241>>>>>>>>>>>>>        Number  nInt nqty nQtyKin
43241>>>>>>>>>>>>>        String  sUserID sOldUserID
43241>>>>>>>>>>>>>
43241>>>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
43243>>>>>>>>>>>>>
43243>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
43245>>>>>>>>>>>>>            If (Pmoves.Pms_VatPct) Begin
43247>>>>>>>>>>>>>                Move Fpa.Recnum to iFpaRecnum
43248>>>>>>>>>>>>>                Clear Fpa
43249>>>>>>>>>>>>>                Move Pmoves.Pms_VatPct      to Fpa.Fpa_Pososto
43250>>>>>>>>>>>>>                Find eq Fpa By Index.1 // Fpa:Index.1:Fpa_Pososto
43251>>>>>>>>>>>>>>
43251>>>>>>>>>>>>>                If (Not(Found)) Move 1111 to iReturnVal
43254>>>>>>>>>>>>>                If (iFpaRecnum) Begin
43256>>>>>>>>>>>>>                    Clear Fpa
43257>>>>>>>>>>>>>                    Move iFpaRecnum to Fpa.Recnum
43258>>>>>>>>>>>>>                    Find Eq Fpa.Recnum
43259>>>>>>>>>>>>>>
43259>>>>>>>>>>>>>                End
43259>>>>>>>>>>>>>>
43259>>>>>>>>>>>>>            End
43259>>>>>>>>>>>>>>
43259>>>>>>>>>>>>>                 If (Wax.Recnum          =0) Move 1001 to iReturnVal
43262>>>>>>>>>>>>>            Else If (Witemx.Recnum       =0) Move 1002 to iReturnVal
43266>>>>>>>>>>>>>            Else If (Particle.Recnum     =0) Move 1003 to iReturnVal
43270>>>>>>>>>>>>>            Else If (Pmoves.Pms_Qty      =0) Move 1004 to iReturnVal
43274>>>>>>>>>>>>>            Else If ( (Sysfile.Hm_Kleisimatos<>'') And ;                      (Particle.Partl_Hmnia<=Sysfile.Hm_Kleisimatos) ) ;                     Move 1110 to iReturnVal
43278>>>>>>>>>>>>>            Else Begin
43279>>>>>>>>>>>>>                If (Pmoves.Timol_Ypol<0)                        Move 7001 to iReturnVal
43282>>>>>>>>>>>>>
43282>>>>>>>>>>>>>
43282>>>>>>>>>>>>>                // SOS SOS SOS 24/10/2002 ¨¦©¦¨ ¤˜ Off š ˜«  ®«¬§˜œ  ©« ª ˜¤«¢ œª
43282>>>>>>>>>>>>>                Else If (Pmoves.Qty_Kinhshs>Pmoves.Timol_Ypol)  Move 1013 to iReturnVal
43286>>>>>>>>>>>>>
43286>>>>>>>>>>>>>//                Else If ((Ptyppar.Ptyppar_Is_What='2') And (Ptyppar.Check_Posa_Plaf='1')) Begin
43286>>>>>>>>>>>>>//                    If (Pmoves.Posa_Apo_Dap=0) Begin
43286>>>>>>>>>>>>>//                        Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
43286>>>>>>>>>>>>>//                        If (iYes=MBR_NO) Move 6001 to iReturnVal
43286>>>>>>>>>>>>>//                    End
43286>>>>>>>>>>>>>//                End
43286>>>>>>>>>>>>>//                Else If ((Clients.Plafon>0) And ;
43286>>>>>>>>>>>>>//                    ((Clients.Ypoloipo+Pmoves.Posa_Apo_Dap)>Clients.Plafon) And ;
43286>>>>>>>>>>>>>//                    (Ptyppar.Check_Posa_Plaf='1')) Begin
43286>>>>>>>>>>>>>//                        Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
43286>>>>>>>>>>>>>//                        If (iYes=MBR_NO) Move 1010 to iReturnVal
43286>>>>>>>>>>>>>//                End
43286>>>>>>>>>>>>>//                Else If ((PayResp.Plafon>0) And ;
43286>>>>>>>>>>>>>//                        ((PayResp.Ypoloipo+Pmoves.Posa_Apo_Dap)>PayResp.Plafon) And ;
43286>>>>>>>>>>>>>//                         (Ptyppar.Check_Posa_Plaf='1')) Begin
43286>>>>>>>>>>>>>//                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
43286>>>>>>>>>>>>>//                        If (iYes=MBR_NO) Move 1011 to iReturnVal
43286>>>>>>>>>>>>>//                End
43286>>>>>>>>>>>>>                Else If ((pmoves.clorderd_recr <> '') and (pifromclorder(self)<>1)) begin //?? Pmoves ???ÿ????š???? ? ???????êœ??
43289>>>>>>>>>>>>>                    get pnoqty to nqty
43290>>>>>>>>>>>>>                    if (nqty <> pmoves.pms_qty)                 Move 7000 to iReturnVal
43293>>>>>>>>>>>>>                End
43293>>>>>>>>>>>>>>
43293>>>>>>>>>>>>>
43293>>>>>>>>>>>>>                Else If ((Pmoves.Qty_Ypol=1) And (piFromMetasx(Self)=0)) begin
43296>>>>>>>>>>>>>                    // js 28/08/2002
43296>>>>>>>>>>>>>                    // To pedio Qty_Ypol xrhsimopoihtai gia na flagarei an ena Pmove
43296>>>>>>>>>>>>>                    // exei proelthei apo metasxhmatismo (Eite sygkentrotika, eite analytika)
43296>>>>>>>>>>>>>                    // To xrhsimopoihsame ayto gia na mhn anoixtei neo pedio.
43296>>>>>>>>>>>>>                    // An loipon exei proelthei apo metasxhmatismo DEN epitrepetai tropopoihsh
43296>>>>>>>>>>>>>                    // ths posothtas tou ap' eutheias alla mono meso ths posothtas mias
43296>>>>>>>>>>>>>                    // sygkekrimenhs eggrafhs tou arxeiou PmsSxet
43296>>>>>>>>>>>>>                    If (Operation_Origin=Self) Begin
43298>>>>>>>>>>>>>                        get pnoqty to nqty
43299>>>>>>>>>>>>>                        if (nqty <> pmoves.pms_qty)             Move 7005 to iReturnVal
43302>>>>>>>>>>>>>                    End
43302>>>>>>>>>>>>>>
43302>>>>>>>>>>>>>                End
43302>>>>>>>>>>>>>>
43302>>>>>>>>>>>>>            End
43302>>>>>>>>>>>>>>
43302>>>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
43305>>>>>>>>>>>>>        End
43305>>>>>>>>>>>>>>
43305>>>>>>>>>>>>>        Function_Return iReturnVal
43306>>>>>>>>>>>>>    End_Function   // Validate_Save
43307>>>>>>>>>>>>>
43307>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
43308>>>>>>>>>>>>>        Integer iReturnVal
43309>>>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
43311>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
43313>>>>>>>>>>>>>            If (Particle.Partl_Timol=1) Move 1009 to iReturnVal
43316>>>>>>>>>>>>>            Else If ( (Sysfile.Hm_Kleisimatos<>'') And ;                      (Particle.Partl_Hmnia<=Sysfile.Hm_Kleisimatos) ) ;                Move 1110 to iReturnVal
43320>>>>>>>>>>>>>            Else If ((pmoves.qty_ypol=1) And (Operation_Origin=Self)) Move 1012 to iReturnVal
43324>>>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
43327>>>>>>>>>>>>>        End
43327>>>>>>>>>>>>>>
43327>>>>>>>>>>>>>        Function_Return iReturnVal
43328>>>>>>>>>>>>>    End_Function   // Validate_Delete
43329>>>>>>>>>>>>>
43329>>>>>>>>>>>>>    Procedure Set_UnitPrice integer iField  Number nNum
43330>>>>>>>>>>>>>        Local Integer   Changed
43331>>>>>>>>>>>>>        Local Number    nInt
43331>>>>>>>>>>>>>        Get Field_Changed_State iField to Changed
43332>>>>>>>>>>>>>        If (Changed=0 AND nNum=0) Begin
43334>>>>>>>>>>>>>            Get fnTeleytaiaTimh to nInt
43335>>>>>>>>>>>>>            Set Field_Default_Value iField to nInt
43336>>>>>>>>>>>>>        End
43336>>>>>>>>>>>>>>
43336>>>>>>>>>>>>>    End_Procedure   // Shmera
43337>>>>>>>>>>>>>
43337>>>>>>>>>>>>>    Procedure Set_Discount integer iField  Number nNum
43338>>>>>>>>>>>>>        Local Integer Changed
43339>>>>>>>>>>>>>        Local Number nInt
43339>>>>>>>>>>>>>        Get Field_Changed_State iField to Changed
43340>>>>>>>>>>>>>        If (Changed=0 AND nNum=0) Begin
43342>>>>>>>>>>>>>            Get fnTeleytaiaTimh to nInt
43343>>>>>>>>>>>>>            If (nInt<0) Begin
43345>>>>>>>>>>>>>                Move (nInt*(-1)) to nInt
43346>>>>>>>>>>>>>                Set Field_Default_Value iField to nInt
43347>>>>>>>>>>>>>            End
43347>>>>>>>>>>>>>>
43347>>>>>>>>>>>>>        End
43347>>>>>>>>>>>>>>
43347>>>>>>>>>>>>>    End_Procedure   // Shmera
43348>>>>>>>>>>>>>
43348>>>>>>>>>>>>>    Procedure Set_FPA integer iField  Number nNum
43349>>>>>>>>>>>>>        Local Integer Changed
43350>>>>>>>>>>>>>        Local Number nInt
43350>>>>>>>>>>>>>        Get Field_Changed_State iField to Changed
43351>>>>>>>>>>>>>        If (Changed=0 AND nNum=0) Begin
43353>>>>>>>>>>>>>            Move Item.Fpa_Pososto to nInt
43354>>>>>>>>>>>>>            Set Field_Default_Value iField to nInt
43355>>>>>>>>>>>>>        End
43355>>>>>>>>>>>>>>
43355>>>>>>>>>>>>>    End_Procedure   // Shmera
43356>>>>>>>>>>>>>
43356>>>>>>>>>>>>>    // Define_Fields:
43356>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
43356>>>>>>>>>>>>>
43356>>>>>>>>>>>>>    Procedure Define_Fields
43357>>>>>>>>>>>>>        Forward Send Define_Fields
43359>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43359>>>>>>>>>>>>>        //DDB-DefineFieldStart
43359>>>>>>>>>>>>>
43359>>>>>>>>>>>>>        Set Main_File            To Pmoves.File_Number
43360>>>>>>>>>>>>>
43360>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
43361>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
43362>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43363>>>>>>>>>>>>>
43363>>>>>>>>>>>>>        // Child (Client) file structure................
43363>>>>>>>>>>>>>        Send Add_Client_File  Pmsdtl.File_Number
43364>>>>>>>>>>>>>        Send Add_Client_File  Pmssxet.File_Number
43365>>>>>>>>>>>>>
43365>>>>>>>>>>>>>        // Parent (Server) file structure...............
43365>>>>>>>>>>>>>        Send Add_Server_File  Wax.File_Number
43366>>>>>>>>>>>>>        Send Add_Server_File  Witemx.File_Number
43367>>>>>>>>>>>>>        Send Add_Server_File  Particle.File_Number
43368>>>>>>>>>>>>>
43368>>>>>>>>>>>>>        // External (System) file structure.............
43368>>>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
43369>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
43370>>>>>>>>>>>>>        Send Add_System_File  Partlfpa.File_Number  DD_LOCK_ON_ALL
43371>>>>>>>>>>>>>        Send Add_System_File  Clorder.File_Number  DD_LOCK_ON_ALL
43372>>>>>>>>>>>>>        Send Add_System_File  Clorderd.File_Number  DD_LOCK_ON_ALL
43373>>>>>>>>>>>>>        Send Add_System_File  Btnemp.File_Number  DD_LOCK_ON_ALL
43374>>>>>>>>>>>>>
43374>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Pmoves_Rec0  To Pmoves.Pms_Rec0
43377>>>>>>>>>>>>>
43377>>>>>>>>>>>>>        // Field-based properties.......................
43377>>>>>>>>>>>>>
43377>>>>>>>>>>>>>        // Pmoves.Company_Code
43377>>>>>>>>>>>>>
43377>>>>>>>>>>>>>        // Pmoves.Branch_Code
43377>>>>>>>>>>>>>
43377>>>>>>>>>>>>>        // Pmoves.Year_Year
43377>>>>>>>>>>>>>
43377>>>>>>>>>>>>>        // Pmoves.Ctypkin_Code
43377>>>>>>>>>>>>>
43377>>>>>>>>>>>>>        // Pmoves.Wtypkin_Code
43377>>>>>>>>>>>>>
43377>>>>>>>>>>>>>        // Pmoves.Custprom_Code
43377>>>>>>>>>>>>>
43377>>>>>>>>>>>>>        // Pmoves.Client_Id
43377>>>>>>>>>>>>>
43377>>>>>>>>>>>>>        // Pmoves.Cn_Code
43377>>>>>>>>>>>>>
43377>>>>>>>>>>>>>        // Pmoves.Ptyppar_Code
43377>>>>>>>>>>>>>
43377>>>>>>>>>>>>>        // Pmoves.Partl_Hmnia
43377>>>>>>>>>>>>>
43377>>>>>>>>>>>>>        // Pmoves.Pseira_Seira
43377>>>>>>>>>>>>>
43377>>>>>>>>>>>>>        // Pmoves.Partl_No
43377>>>>>>>>>>>>>
43377>>>>>>>>>>>>>        // Pmoves.Partl_Rec0
43377>>>>>>>>>>>>>
43377>>>>>>>>>>>>>        // Pmoves.Witemkat_Code
43377>>>>>>>>>>>>>
43377>>>>>>>>>>>>>        // Pmoves.Units_Code
43377>>>>>>>>>>>>>
43377>>>>>>>>>>>>>        // Pmoves.Item_Code
43377>>>>>>>>>>>>>
43377>>>>>>>>>>>>>        // Pmoves.Witemx_Code
43377>>>>>>>>>>>>>
43377>>>>>>>>>>>>>        // Pmoves.Wapokat_Code
43377>>>>>>>>>>>>>
43377>>>>>>>>>>>>>        // Pmoves.Wapomast_Code
43377>>>>>>>>>>>>>
43377>>>>>>>>>>>>>        // Pmoves.Wax_Code
43377>>>>>>>>>>>>>
43377>>>>>>>>>>>>>        // Pmoves.Wax_Recr
43377>>>>>>>>>>>>>
43377>>>>>>>>>>>>>        // Pmoves.Witemx_Recr
43377>>>>>>>>>>>>>
43377>>>>>>>>>>>>>        // Pmoves.Partl_Recr
43377>>>>>>>>>>>>>
43377>>>>>>>>>>>>>        // Pmoves.Pms_Rec0
43377>>>>>>>>>>>>>        Set Field_Options          Field Pmoves.Pms_Rec0 To DD_AUTOFIND   
43378>>>>>>>>>>>>>
43378>>>>>>>>>>>>>        // Pmoves.Pms_No
43378>>>>>>>>>>>>>
43378>>>>>>>>>>>>>        // Pmoves.Pms_Recr
43378>>>>>>>>>>>>>
43378>>>>>>>>>>>>>        // Pmoves.Pms_Unitcode
43378>>>>>>>>>>>>>
43378>>>>>>>>>>>>>        // Pmoves.Pms_Qty
43378>>>>>>>>>>>>>
43378>>>>>>>>>>>>>        // Pmoves.Pms_Unitprice
43378>>>>>>>>>>>>>        Set Field_Entry_msg        Field Pmoves.Pms_Unitprice To Set_UnitPrice
43379>>>>>>>>>>>>>
43379>>>>>>>>>>>>>        // Pmoves.Pms_Ambd
43379>>>>>>>>>>>>>
43379>>>>>>>>>>>>>        // Pmoves.Pms_Pctdisc
43379>>>>>>>>>>>>>        Set Field_Entry_msg        Field Pmoves.Pms_Pctdisc To Set_Discount
43380>>>>>>>>>>>>>
43380>>>>>>>>>>>>>        // Pmoves.Pms_Discam
43380>>>>>>>>>>>>>
43380>>>>>>>>>>>>>        // Pmoves.Pms_Amaftdisc
43380>>>>>>>>>>>>>
43380>>>>>>>>>>>>>        // Pmoves.Pms_Vatpct
43380>>>>>>>>>>>>>        Set Field_Entry_msg        Field Pmoves.Pms_Vatpct To Set_FPA
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_Vatam
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_Exrampct
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_Exdet
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_Payable
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_Axia
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_X0
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_P0
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_X00
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_P00
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_X1
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_P1
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_X2
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_P2
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_Dlixis
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_A_Code
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_Status_E
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_Status_A
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_S0
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_Ys0
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_S1
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_Ys1
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_S2
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_Ys2
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_Sc_Code2
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_Open
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_Aopen
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_M_Code
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_Yn_Myf
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_Myf_Axia
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_Kk
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_C_Code2
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_Cn_Code
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Wcmoves_Recr
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_Module
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Btnl2_Recr
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Btnemp_Recr
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Btarticle_Recr
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Sls_Id
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Presp_Id
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Cnt_Id
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Mhxanik_Id
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Extra_Epimer
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Ekpt_Epimer
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Clorderd_Recr
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Witemx_Descr
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Ptyppar_Descr
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Ti_Typonei_Pms
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Timol_Qty
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Timol_Ypol
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Posa_Apo_Dap
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Qty_Ypol
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>        // Pmoves.Pms_Selected
43381>>>>>>>>>>>>>        Set Field_Class_Name       Field Pmoves.Pms_Selected To "dbCheckBoxsub"
43382>>>>>>>>>>>>>
43382>>>>>>>>>>>>>        // Pmoves.Qty_Kinhshs
43382>>>>>>>>>>>>>
43382>>>>>>>>>>>>>        // Pmoves.Sx_Parast
43382>>>>>>>>>>>>>
43382>>>>>>>>>>>>>        // Pmoves.Sx_Hmnia
43382>>>>>>>>>>>>>
43382>>>>>>>>>>>>>        // Pmoves.Sx_Seira
43382>>>>>>>>>>>>>
43382>>>>>>>>>>>>>        // Pmoves.Sx_Arithmos
43382>>>>>>>>>>>>>
43382>>>>>>>>>>>>>        // Pmoves.Pump_Id
43382>>>>>>>>>>>>>
43382>>>>>>>>>>>>>        // Pmoves.Car_Id
43382>>>>>>>>>>>>>
43382>>>>>>>>>>>>>        // Pmoves.Item_Ypot
43382>>>>>>>>>>>>>
43382>>>>>>>>>>>>>        // Pmoves.Qty_Return
43382>>>>>>>>>>>>>
43382>>>>>>>>>>>>>        // Pmoves.Client_Name
43382>>>>>>>>>>>>>
43382>>>>>>>>>>>>>        // Pmoves.Zone
43382>>>>>>>>>>>>>
43382>>>>>>>>>>>>>        //DDB-DefineFieldEnd
43382>>>>>>>>>>>>>    End_Procedure    // Define_Fields
43383>>>>>>>>>>>>>
43383>>>>>>>>>>>>>    // Field_Defaults:
43383>>>>>>>>>>>>>    // This procedure is used to establish default field values.
43383>>>>>>>>>>>>>
43383>>>>>>>>>>>>>    Procedure Field_Defaults
43384>>>>>>>>>>>>>        Forward Send Field_Defaults
43386>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43386>>>>>>>>>>>>>        //DDB-FieldDefaultStart
43386>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
43386>>>>>>>>>>>>>        //Set Field_Changed_Value Field Pmoves.Pms_VatPct to Item.Fpa_Pososto
43386>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
43387>>>>>>>>>>>>>
43387>>>>>>>>>>>>>End_Class    // Pmoves_DataDictionary
43388>>>>>>>>>>>>>//DDB-FileEnd
43388>>>>>>>>>>>    Use PmsDtl.DD
INCLUDING FILE: PMSDTL.DD
43388>>>>>>>>>>>>>//DDB-FileStart
43388>>>>>>>>>>>>>//DDB-HeaderStart
43388>>>>>>>>>>>>>
43388>>>>>>>>>>>>>// File Name : PmsDtl.DD
43388>>>>>>>>>>>>>// Class Name: Pmsdtl_DataDictionary
43388>>>>>>>>>>>>>// Revision  : 0
43388>>>>>>>>>>>>>// Version   : 2
43388>>>>>>>>>>>>>
43388>>>>>>>>>>>>>Use  Windows           // Basic Definitions
43388>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
43388>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43388>>>>>>>>>>>>>
43388>>>>>>>>>>>>>Open Pmsdtl
43390>>>>>>>>>>>>>Open Pmoves
43392>>>>>>>>>>>>>
43392>>>>>>>>>>>>>//DDB-HeaderEnd
43392>>>>>>>>>>>>>
43392>>>>>>>>>>>>>Class Pmsdtl_DataDictionary  is a DataDictionary_Sec
43393>>>>>>>>>>>>>
43393>>>>>>>>>>>>>    // Define_Fields:
43393>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
43393>>>>>>>>>>>>>
43393>>>>>>>>>>>>>    Procedure Define_Fields
43394>>>>>>>>>>>>>        Forward Send Define_Fields
43396>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43396>>>>>>>>>>>>>        //DDB-DefineFieldStart
43396>>>>>>>>>>>>>
43396>>>>>>>>>>>>>        Set Main_File            To Pmsdtl.File_Number
43397>>>>>>>>>>>>>
43397>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
43398>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
43399>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43400>>>>>>>>>>>>>
43400>>>>>>>>>>>>>        // Parent (Server) file structure...............
43400>>>>>>>>>>>>>        Send Add_Server_File  Pmoves.File_Number
43401>>>>>>>>>>>>>
43401>>>>>>>>>>>>>        // Field-based properties.......................
43401>>>>>>>>>>>>>
43401>>>>>>>>>>>>>        // Pmsdtl.Pms_Recr
43401>>>>>>>>>>>>>        Set Field_Options          Field Pmsdtl.Pms_Recr To DD_AUTOFIND   
43402>>>>>>>>>>>>>        Set Key_Field_State        Field Pmsdtl.Pms_Recr To TRUE
43403>>>>>>>>>>>>>
43403>>>>>>>>>>>>>        // Pmsdtl.Line1
43403>>>>>>>>>>>>>
43403>>>>>>>>>>>>>        // Pmsdtl.Line2
43403>>>>>>>>>>>>>
43403>>>>>>>>>>>>>        // Pmsdtl.Line3
43403>>>>>>>>>>>>>
43403>>>>>>>>>>>>>        // Pmsdtl.Line4
43403>>>>>>>>>>>>>
43403>>>>>>>>>>>>>        // Pmsdtl.Line5
43403>>>>>>>>>>>>>
43403>>>>>>>>>>>>>        //DDB-DefineFieldEnd
43403>>>>>>>>>>>>>    End_Procedure    // Define_Fields
43404>>>>>>>>>>>>>
43404>>>>>>>>>>>>>    // Field_Defaults:
43404>>>>>>>>>>>>>    // This procedure is used to establish default field values.
43404>>>>>>>>>>>>>
43404>>>>>>>>>>>>>    Procedure Field_Defaults
43405>>>>>>>>>>>>>        Forward Send Field_Defaults
43407>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43407>>>>>>>>>>>>>        //DDB-FieldDefaultStart
43407>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
43407>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
43408>>>>>>>>>>>>>
43408>>>>>>>>>>>>>End_Class    // Pmsdtl_DataDictionary
43409>>>>>>>>>>>>>//DDB-FileEnd
43409>>>>>>>>>>>    Use BAXIOKAT.DD
INCLUDING FILE: BAXIOKAT.DD
43409>>>>>>>>>>>>>//DDB-FileStart
43409>>>>>>>>>>>>>//DDB-HeaderStart
43409>>>>>>>>>>>>>
43409>>>>>>>>>>>>>// File Name : BAXIOKAT.DD
43409>>>>>>>>>>>>>// Class Name: Baxiokat_DataDictionary
43409>>>>>>>>>>>>>// Revision  : 44
43409>>>>>>>>>>>>>// Version   : 2
43409>>>>>>>>>>>>>
43409>>>>>>>>>>>>>Use  Windows           // Basic Definitions
43409>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
43409>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43409>>>>>>>>>>>>>
43409>>>>>>>>>>>>>Open Baxiokat
INCLUDING FILE: BAXIOKAT.FD
43411>>>>>>>>>>>>>Open Baxio
INCLUDING FILE: BAXIO.FD
43413>>>>>>>>>>>>>Open Bkinkat
INCLUDING FILE: BKINKAT.FD
43415>>>>>>>>>>>>>Open Tpclient
43417>>>>>>>>>>>>>Open Tperga
43419>>>>>>>>>>>>>Open Tparticl
43421>>>>>>>>>>>>>Open Sysrecb
INCLUDING FILE: SYSRECB.FD
43423>>>>>>>>>>>>>
43423>>>>>>>>>>>>>//DDB-HeaderEnd
43423>>>>>>>>>>>>>//DDB-ValidationStart
43423>>>>>>>>>>>>>
43423>>>>>>>>>>>>>//DDB/ ExternalValidationTable Baxiokat_Type_VT  BAXIO.PKG
43423>>>>>>>>>>>>>
43423>>>>>>>>>>>>>Register_Object Baxiokat_Type_VT
43423>>>>>>>>>>>>>Register_Object Baxiokat_Baxiokat_Yn5390_VT
43423>>>>>>>>>>>>>Register_Object Baxiokat_Baxiokat_Bank_VT
43423>>>>>>>>>>>>>Register_Object Baxiokat_Baxiokat_Formul_VT
43423>>>>>>>>>>>>>Use BAXIO.PKG        // Baxiokat_Type_VT
INCLUDING FILE: BAXIO.PKG
43423>>>>>>>>>>>>>>>// **************************************************************************
43423>>>>>>>>>>>>>>>// *Code Style   : Object                                                   *
43423>>>>>>>>>>>>>>>// *Name         : Baxio.vts                                                *
43423>>>>>>>>>>>>>>>// *Revision     : 1                                                        *
43423>>>>>>>>>>>>>>>// *Main File    :                                                          *
43423>>>>>>>>>>>>>>>// *Location     : \Home.Win\Easyware\ED\Appsrc                             *
43423>>>>>>>>>>>>>>>// *Creation Date: 01/09/99                                                 *
43423>>>>>>>>>>>>>>>// *Last Update  :                                                          *
43423>>>>>>>>>>>>>>>// *Author       : JA                                                       *
43423>>>>>>>>>>>>>>>// *Includes     :                                                          *
43423>>>>>>>>>>>>>>>// *Comments     : œ¨ â®œ  æ¢˜ «˜ static validation tables «¦¬             *
43423>>>>>>>>>>>>>>>// *             : module «à¤ ˜¥ ¦š¨á­à¤.                                   *
43423>>>>>>>>>>>>>>>// *             :                                                          *
43423>>>>>>>>>>>>>>>// *             :                                                          *
43423>>>>>>>>>>>>>>>// *Returns      :                                                          *
43423>>>>>>>>>>>>>>>// *             :                                                          *
43423>>>>>>>>>>>>>>>// *‰nown bugs   :                                                          *
43423>>>>>>>>>>>>>>>// *             :                                                          *
43423>>>>>>>>>>>>>>>// *Improvements :                                                          *
43423>>>>>>>>>>>>>>>// *             :                                                          *
43423>>>>>>>>>>>>>>>// *             :                                                          *
43423>>>>>>>>>>>>>>>// **************************************************************************
43423>>>>>>>>>>>>>>>// *                        A N A L Y S I S                                 *
43423>>>>>>>>>>>>>>>// **************************************************************************
43423>>>>>>>>>>>>>>>// *                                                                        *
43423>>>>>>>>>>>>>>>// **************************************************************************
43423>>>>>>>>>>>>>>>
43423>>>>>>>>>>>>>>>
43423>>>>>>>>>>>>>>>//Set Allow_Blank_State To TRUE
43423>>>>>>>>>>>>>>>
43423>>>>>>>>>>>>>>>//used by: 1. baxiokat.baxiokat_type
43423>>>>>>>>>>>>>>>Object Baxiokat_Type_VT  is a DescriptionValidationTable
43425>>>>>>>>>>>>>>>       set table_title to "„å›¦ª €¥ ¦š¨á­¦¬"
43426>>>>>>>>>>>>>>>       Procedure Fill_List
43428>>>>>>>>>>>>>>>                 Forward Send Fill_List
43430>>>>>>>>>>>>>>>                 Send Add_Table_Value  "1"  "„ ©§¨˜¡«â¦"
43431>>>>>>>>>>>>>>>                 send add_table_value  "2"  "¢ž¨à«â¦"
43432>>>>>>>>>>>>>>>       End_Procedure //fill_list
43433>>>>>>>>>>>>>>>End_Object   //Baxiokat_Type_VT
43434>>>>>>>>>>>>>>>
43434>>>>>>>>>>>>>>>
43434>>>>>>>>>>>>>>>//¡˜«˜©«á©œ ª ˜¥ ¦š¨á­à¤
43434>>>>>>>>>>>>>>>//used by: 1. bkinkat.baxio_stat_from :¡˜«á©«˜©ž ˜§æ
43434>>>>>>>>>>>>>>>//         2. bkinkat.baxio_stat_to   :¡˜«á©«˜©ž ©â
43434>>>>>>>>>>>>>>>//         3. baxio.baxio_status      :¡˜«á©«˜©ž
43434>>>>>>>>>>>>>>>//â¤˜ ˜¥ æš¨˜­¦ œå¤˜  § Ÿ˜¤æ ¤˜ ™¨œŸœå ©« ª §˜¨˜¡á«à 3 ¡˜«˜©«á©œ ª:
43434>>>>>>>>>>>>>>>Object Baxio_Status_VT  is a DescriptionValidationTable
43436>>>>>>>>>>>>>>>       set table_title to "‰˜«˜©«á©œ ª €¥ ¦š¨á­à¤"
43437>>>>>>>>>>>>>>>       Procedure Fill_List
43439>>>>>>>>>>>>>>>                 Forward Send Fill_List
43441>>>>>>>>>>>>>>>                 Send Add_Table_Value  "1"  "„¡¡¨œ£âª"
43442>>>>>>>>>>>>>>>                 Send Add_Table_Value  "2"  "„¥¦­¢ž£â¤¦"
43443>>>>>>>>>>>>>>>                 Send Add_Table_Value  "3"  "ƒ ˜£˜¨«¬¨ž£â¤¦"
43444>>>>>>>>>>>>>>>                 Send Add_Table_Value  "4"  "’˜£œå¦"
43445>>>>>>>>>>>>>>>                 Send Add_Table_Value  "5"  "ƒœ©£œ¬£â¤¦"
43446>>>>>>>>>>>>>>>
43446>>>>>>>>>>>>>>>       End_Procedure // fill_list
43447>>>>>>>>>>>>>>>End_Object   //Baxio_Status_VT1
43448>>>>>>>>>>>>>>>
43448>>>>>>>>>>>>>>>
43448>>>>>>>>>>>>>>>
43448>>>>>>>>>>>>>>>//used by: 1. btypkin.btypkin_anti1
43448>>>>>>>>>>>>>>>//         2. btypkin.btypkin_anti2
43448>>>>>>>>>>>>>>>//         3. baxio.baxio_file_in
43448>>>>>>>>>>>>>>>//         4. baxio.baxio_file_out
43448>>>>>>>>>>>>>>>//         5. baxio.baxio_lfile
43448>>>>>>>>>>>>>>>Object Bfile_VT  is a DescriptionValidationTable
43450>>>>>>>>>>>>>>>       set table_title to "‘¬¤˜¢¢˜©æ£œ¤¦ª/˜¨˜¢ã§«žª ˜§æ"
43451>>>>>>>>>>>>>>>       Procedure Fill_List
43453>>>>>>>>>>>>>>>                 Forward Send Fill_List
43455>>>>>>>>>>>>>>>                 Send Add_Table_Value  "-1" "ƒœ¤ “§á¨®œ "
43456>>>>>>>>>>>>>>>                 Send Add_Table_Value  "0"  "Data Entry"
43457>>>>>>>>>>>>>>>                 Send Add_Table_Value  "1"  "Š¦š˜¨ ˜©£é¤ ‚Š"
43458>>>>>>>>>>>>>>>                 send add_table_value  "2"  "”¦¨â˜ª"
43459>>>>>>>>>>>>>>>                 Send Add_Table_Value  "3"  "¨¦£žŸœ¬«é¤"
43460>>>>>>>>>>>>>>>                 Send Add_Table_Value  "5"  "Ž ‘¬¤˜¢¢˜©æ£œ¤¦ª"
43461>>>>>>>>>>>>>>>                 Send Add_Table_Value  "6"  "’œ¢.˜¨˜¢ã§«žª"
43462>>>>>>>>>>>>>>>       End_Procedure // fill_list
43463>>>>>>>>>>>>>>>End_Object   // Btypkin_Btypkin_Anti_VT
43464>>>>>>>>>>>>>>>
43464>>>>>>>>>>>>>
43464>>>>>>>>>>>>>Object Baxiokat_Baxiokat_Yn5390_VT  is a DescriptionValidationTable
43466>>>>>>>>>>>>>
43466>>>>>>>>>>>>>    Procedure Fill_List
43468>>>>>>>>>>>>>        Forward Send Fill_List
43470>>>>>>>>>>>>>        Send Add_Table_Value  "0"  "Ž® "
43471>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "Œ˜ "
43472>>>>>>>>>>>>>    End_Procedure    // Fill_List
43473>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43473>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43473>>>>>>>>>>>>>End_Object   // Baxiokat_Baxiokat_Yn5390_VT
43474>>>>>>>>>>>>>
43474>>>>>>>>>>>>>Object Baxiokat_Baxiokat_Bank_VT  is a CodeValidationTable
43476>>>>>>>>>>>>>    Set Type_Value        To "BANK"
43477>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
43478>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43478>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43478>>>>>>>>>>>>>End_Object   // Baxiokat_Baxiokat_Bank_VT
43479>>>>>>>>>>>>>
43479>>>>>>>>>>>>>Object Baxiokat_Baxiokat_Formul_VT  is a DescriptionValidationTable
43481>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
43482>>>>>>>>>>>>>
43482>>>>>>>>>>>>>    Procedure Fill_List
43484>>>>>>>>>>>>>        Forward Send Fill_List
43486>>>>>>>>>>>>>        Send Add_Table_Value  "0"  ""
43487>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "’ç§¦ª 1"
43488>>>>>>>>>>>>>        Send Add_Table_Value  "2"  "’ç§¦ª 2"
43489>>>>>>>>>>>>>    End_Procedure    // Fill_List
43490>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43490>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43490>>>>>>>>>>>>>End_Object   // Baxiokat_Baxiokat_Formul_VT
43491>>>>>>>>>>>>>//DDB-ValidationEnd
43491>>>>>>>>>>>>>//DDB-SelectionStart
43491>>>>>>>>>>>>>//DDB/ ExternalSelectionList SL034  SL034.SL
43491>>>>>>>>>>>>>Register_Object SL034
43491>>>>>>>>>>>>>//DDB-SelectionEnd
43491>>>>>>>>>>>>>
43491>>>>>>>>>>>>>Open Syscurxr
43493>>>>>>>>>>>>>Open Btypkin
43495>>>>>>>>>>>>>Open Bkinkat
43497>>>>>>>>>>>>>
43497>>>>>>>>>>>>>
43497>>>>>>>>>>>>>// Apo Baxio_DD
43497>>>>>>>>>>>>>Register_Function private.Default_Axio_C_Code2 Returns String
43497>>>>>>>>>>>>>//
43497>>>>>>>>>>>>>
43497>>>>>>>>>>>>>Class Baxiokat_DataDictionary  is a DataDictionary_Sec
43498>>>>>>>>>>>>>
43498>>>>>>>>>>>>>     Procedure Creating
43499>>>>>>>>>>>>>        Forward Send Creating
43501>>>>>>>>>>>>>        // Insert Code Here
43501>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Baxiokat.Baxiokat_Rec0)))))) to Baxiokat.Baxiokat_Recr
43502>>>>>>>>>>>>>    End_Procedure   // Creating
43503>>>>>>>>>>>>>
43503>>>>>>>>>>>>>     Procedure Construct_Object
43504>>>>>>>>>>>>>               Forward Send Construct_Object
43506>>>>>>>>>>>>>
43506>>>>>>>>>>>>>               //object id «é¤ ddo servers š ˜ «á barticl+bmove+baxio+baxiokat
43506>>>>>>>>>>>>>               //©œ«á¨¦¤«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
43506>>>>>>>>>>>>>               //®¨ž© £œç¦¬¤ ©«ž¤ private.exit_btypkin_code
43506>>>>>>>>>>>>>               //š ˜ ¤˜ ©œ«á¨¦¬¤ «¦ visual interface
43506>>>>>>>>>>>>>               Property Integer piBarticl_dd  0
43507>>>>>>>>>>>>>               Property Integer piBmove_dd    0
43508>>>>>>>>>>>>>               Property Integer piBaxio_dd    0
43509>>>>>>>>>>>>>               Property Integer piBtypkin_dd 0
43510>>>>>>>>>>>>>     End_Procedure   //construct_object
43511>>>>>>>>>>>>>
43511>>>>>>>>>>>>>
43511>>>>>>>>>>>>>     //private
43511>>>>>>>>>>>>>     //¡˜¢œå«˜  ˜§æ: iexit «¦¬ baxiokat_code
43511>>>>>>>>>>>>>     //©œ«á¨œ      : «ž¤ default « £ã «¦¬ baxio_c_code2, ˜¤á¢¦š˜ £œ «¦ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
43511>>>>>>>>>>>>>     Procedure private.Exit_Baxiokat_Code Integer liField Integer liBaxiokat_Code
43512>>>>>>>>>>>>>               String lsBaxio_C_Code_2
43513>>>>>>>>>>>>>        PROCEDURE_RETURN
43514>>>>>>>>>>>>>//jsjsjs 24/01/2001
43514>>>>>>>>>>>>>//               Get File_Field_Current_Value File_Field Year.Year_C_Code0 to lsBaxio_C_Code_2
43514>>>>>>>>>>>>>
43514>>>>>>>>>>>>>//               Set Field_Changed_Value of (piBaxio_dd(Self)) Field Baxio.Baxio_C_Code2 to  lsBaxio_C_Code_2 //(private.Default_Axio_C_Code2((piBAxio_dd(Self))))
43514>>>>>>>>>>>>>//jsjsjs 24/01/2001
43514>>>>>>>>>>>>>     End_Procedure //private.exit_baxiokat_code
43515>>>>>>>>>>>>>
43515>>>>>>>>>>>>>
43515>>>>>>>>>>>>>    //private
43515>>>>>>>>>>>>>    //¡˜¢œå«˜  ˜§æ:
43515>>>>>>>>>>>>>    //©œ«á¨œ : «ž¤ default value to baxiokat_code, ˜¤á¢¦š˜ £œ «¦ btypkin.baxiokat_num
43515>>>>>>>>>>>>>    Procedure private.Entry_Baxiokat_Code Integer liField Integer liBaxiokat_Code
43516>>>>>>>>>>>>>              Integer liBtypkin_dd liBkinkat_Num liBtypkin_Rec0
43517>>>>>>>>>>>>>
43517>>>>>>>>>>>>>        PROCEDURE_RETURN
43518>>>>>>>>>>>>>
43518>>>>>>>>>>>>>
43518>>>>>>>>>>>>>    End_Procedure //private.entry_gtypkin_code
43519>>>>>>>>>>>>>
43519>>>>>>>>>>>>>
43519>>>>>>>>>>>>>
43519>>>>>>>>>>>>>
43519>>>>>>>>>>>>>    Procedure Update
43520>>>>>>>>>>>>>          Forward Send Update
43522>>>>>>>>>>>>>          If (Baxiokat.Baxiokat_Yn5390 = 0);          Begin //œá¤ ›â¤ œå¤˜  £ž®˜¤¦š¨˜­ž£â¤œª œ§ «˜šâª, £ž›â¤ ©œ æ¢˜ «˜ ©®œ« ¡á §œ›å˜
43524>>>>>>>>>>>>>               Move "" to Baxiokat.Baxiokat_Bank
43525>>>>>>>>>>>>>               Move "" to Baxiokat.Baxiokat_Lno
43526>>>>>>>>>>>>>               Move 0  to Baxiokat.Baxiokat_Formul
43527>>>>>>>>>>>>>          End
43527>>>>>>>>>>>>>>
43527>>>>>>>>>>>>>    End_Procedure
43528>>>>>>>>>>>>>
43528>>>>>>>>>>>>>
43528>>>>>>>>>>>>>    Procedure Define_Fields
43529>>>>>>>>>>>>>        Forward Send Define_Fields
43531>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43531>>>>>>>>>>>>>        //DDB-DefineFieldStart
43531>>>>>>>>>>>>>
43531>>>>>>>>>>>>>        Set Main_File            To Baxiokat.File_Number
43532>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
43533>>>>>>>>>>>>>
43533>>>>>>>>>>>>>
43533>>>>>>>>>>>>>        // Child (Client) file structure................
43533>>>>>>>>>>>>>        Send Add_Client_File  Baxio.File_Number
43534>>>>>>>>>>>>>        Send Add_Client_File  Bkinkat.File_Number
43535>>>>>>>>>>>>>        Send Add_Client_File  Tpclient.File_Number
43536>>>>>>>>>>>>>        Send Add_Client_File  Tperga.File_Number
43537>>>>>>>>>>>>>        Send Add_Client_File  Tparticl.File_Number
43538>>>>>>>>>>>>>
43538>>>>>>>>>>>>>        // External (System) file structure.............
43538>>>>>>>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
43539>>>>>>>>>>>>>
43539>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecb.Baxiokat_Rec0  To Baxiokat.Baxiokat_Rec0
43542>>>>>>>>>>>>>
43542>>>>>>>>>>>>>        // Field-based properties.......................
43542>>>>>>>>>>>>>
43542>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Code
43542>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Code To (SL034(Self))
43543>>>>>>>>>>>>>
43543>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Descr
43543>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Descr To (SL034(Self))
43544>>>>>>>>>>>>>
43544>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Rec0
43544>>>>>>>>>>>>>
43544>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Recr
43544>>>>>>>>>>>>>
43544>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Type
43544>>>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Type To (Baxiokat_Type_VT(Self))
43545>>>>>>>>>>>>>
43545>>>>>>>>>>>>>        // Baxiokat.Baxio_Lcode
43545>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Baxiokat.Baxio_Lcode To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ creating/deleting «¦¬ baxio)"
43545>>>>>>>>>>>>>
43545>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Yn5390
43545>>>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Yn5390 To (Baxiokat_Baxiokat_Yn5390_VT(Self))
43546>>>>>>>>>>>>>
43546>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Bank
43546>>>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Bank To (Baxiokat_Baxiokat_Bank_VT(Self))
43547>>>>>>>>>>>>>
43547>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Lno
43547>>>>>>>>>>>>>
43547>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Formul
43547>>>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Formul To (Baxiokat_Baxiokat_Formul_VT(Self))
43548>>>>>>>>>>>>>
43548>>>>>>>>>>>>>        //DDB-DefineFieldEnd
43548>>>>>>>>>>>>>
43548>>>>>>>>>>>>>        Set Main_File            To Baxiokat.File_Number
43549>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
43550>>>>>>>>>>>>>
43550>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
43551>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
43552>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43553>>>>>>>>>>>>>
43553>>>>>>>>>>>>>        // Child (Client) file structure................
43553>>>>>>>>>>>>>        Send Add_Client_File  Baxio.File_Number
43554>>>>>>>>>>>>>        Send Add_Client_File  Bkinkat.File_Number
43555>>>>>>>>>>>>>
43555>>>>>>>>>>>>>        // External (System) file structure.............
43555>>>>>>>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
43556>>>>>>>>>>>>>
43556>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecb.Baxiokat_Rec0  To Baxiokat.Baxiokat_Rec0
43559>>>>>>>>>>>>>
43559>>>>>>>>>>>>>        // Field-based properties.......................
43559>>>>>>>>>>>>>
43559>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Code
43559>>>>>>>>>>>>>        Set Field_Entry_msg        Field Baxiokat.Baxiokat_Code   To private.Entry_Baxiokat_Code
43560>>>>>>>>>>>>>        Set Field_Exit_msg         Field Baxiokat.Baxiokat_Code   To private.Exit_Baxiokat_Code
43561>>>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Code   To "‰à› ¡æª „å›¦¬ª €¥ ¦š¨á­¦¬"
43562>>>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Code   To "„å›¦ª"
43563>>>>>>>>>>>>>        Set Field_Options          Field Baxiokat.Baxiokat_Code   To DD_AUTOFIND    DD_REQUIRED
43564>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Code   To (SL034(Self))
43565>>>>>>>>>>>>>        Set Key_Field_State        Field Baxiokat.Baxiokat_Code   To TRUE
43566>>>>>>>>>>>>>
43566>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Descr
43566>>>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Descr  To "œ¨ š¨˜­ã „å›¦¬ª €¥ ¦š¨á­¦¬"
43567>>>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Descr  To "œ¨ š¨˜­ã"
43568>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Descr  To (SL034(Self))
43569>>>>>>>>>>>>>
43569>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Rec0
43569>>>>>>>>>>>>>        Set Field_Options          Field Baxiokat.Baxiokat_Rec0   To DD_AUTOFIND    DD_REQUIRED
43570>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Rec0   To (SL034(Self))
43571>>>>>>>>>>>>>        Set Key_Field_State        Field Baxiokat.Baxiokat_Rec0   To TRUE
43572>>>>>>>>>>>>>
43572>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Type
43572>>>>>>>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Type   To "dbComboForm_EZ"
43573>>>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Type   To "„ ©§¨˜¡«â¦/¢ž¨à«â¦"
43574>>>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Type   To "„ ©./¢ã¨."
43575>>>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Type   To (Baxiokat_Type_VT(Self))
43576>>>>>>>>>>>>>
43576>>>>>>>>>>>>>        // Baxiokat.Baxio_Lcode
43576>>>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxio_Lcode     To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª €¥ ¦šá­¦¬"
43577>>>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxio_Lcode     To "’œ¢.€¨ Ÿ£æª"
43578>>>>>>>>>>>>>        Set Field_Options          Field Baxiokat.Baxio_Lcode     To DD_DISPLAYONLY
43579>>>>>>>>>>>>>
43579>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Yn5390
43579>>>>>>>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Yn5390 To "dbComboForm_EZ"
43580>>>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Yn5390 To "‹ž®˜¤¦š¨˜­ž£â¤œª „§ «˜šâª ?"
43581>>>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Yn5390 To "‹ž®/¡âª „§ «˜šâª"
43582>>>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Yn5390 To (Baxiokat_Baxiokat_Yn5390_VT(Self))
43583>>>>>>>>>>>>>
43583>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Bank
43583>>>>>>>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Bank   To "dbComboForm_EZ"
43584>>>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Bank   To "’¨á§œ˜"
43585>>>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Bank   To "’¨á§œ˜"
43586>>>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Bank   To (Baxiokat_Baxiokat_Bank_VT(Self))
43587>>>>>>>>>>>>>
43587>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Lno
43587>>>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Lno    To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª"
43588>>>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Lno    To "’œ¢.€¨ Ÿ£æª"
43589>>>>>>>>>>>>>
43589>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Formul
43589>>>>>>>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Formul To "dbComboForm_EZ"
43590>>>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Formul To "€¢šæ¨ Ÿ£¦ª Check Digit"
43591>>>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Formul To "Check Digit"
43592>>>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Formul To (Baxiokat_Baxiokat_Formul_VT(Self))
43593>>>>>>>>>>>>>
43593>>>>>>>>>>>>>    End_Procedure    // Define_Fields
43594>>>>>>>>>>>>>
43594>>>>>>>>>>>>>
43594>>>>>>>>>>>>>    Procedure Field_Defaults
43595>>>>>>>>>>>>>        Forward Send Field_Defaults
43597>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43597>>>>>>>>>>>>>        //DDB-FieldDefaultStart
43597>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
43597>>>>>>>>>>>>>        Set Field_Changed_Value   Field Baxiokat.Baxiokat_Yn5390 To 0
43598>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
43599>>>>>>>>>>>>>
43599>>>>>>>>>>>>>End_Class    // Baxiokat_DataDictionary
43600>>>>>>>>>>>>>//DDB-Selection-pkg-Start
43600>>>>>>>>>>>>>
43600>>>>>>>>>>>>>Use SL034.SL         // SL034
INCLUDING FILE: SL034.SL
43600>>>>>>>>>>>>>>>//AB/ Project SL034:BAXIOKAT
43600>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
43600>>>>>>>>>>>>>>>//AB/     Set ProjectName to "SL034:BAXIOKAT"
43600>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "SL034.SL"
43600>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
43600>>>>>>>>>>>>>>>
43600>>>>>>>>>>>>>>>// Project Object Structure
43600>>>>>>>>>>>>>>>//   SL034 is a dbModalPanelSub
43600>>>>>>>>>>>>>>>//     Baxiokat_DD is a DataDictionary
43600>>>>>>>>>>>>>>>//     oSelList is a dbListSub
43600>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
43600>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
43600>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
43600>>>>>>>>>>>>>>>
43600>>>>>>>>>>>>>>>// Register all objects
43600>>>>>>>>>>>>>>>Register_Object Baxiokat_DD
43600>>>>>>>>>>>>>>>Register_Object oCancel_bn
43600>>>>>>>>>>>>>>>Register_Object oOK_bn
43600>>>>>>>>>>>>>>>Register_Object oSearch_bn
43600>>>>>>>>>>>>>>>Register_Object oSelList
43600>>>>>>>>>>>>>>>Register_Object SL034
43600>>>>>>>>>>>>>>>
43600>>>>>>>>>>>>>>>
43600>>>>>>>>>>>>>>>//AB-IgnoreStart
43600>>>>>>>>>>>>>>>
43600>>>>>>>>>>>>>>>Use DFAllEnt.pkg
43600>>>>>>>>>>>>>>>Use dbList.Sub
43600>>>>>>>>>>>>>>>Use Button.Sub
43600>>>>>>>>>>>>>>>
43600>>>>>>>>>>>>>>>
43600>>>>>>>>>>>>>>>Use BAXIOKAT.DD
43600>>>>>>>>>>>>>>>
43600>>>>>>>>>>>>>>>//AB-IgnoreEnd
43600>>>>>>>>>>>>>>>
43600>>>>>>>>>>>>>>>CD_Popup_Object SL034 is a dbModalPanelSub
43619>>>>>>>>>>>>>>>    set label to "‰˜«žš¦¨åœª €¥ ¦š¨á­à¤" 
43620>>>>>>>>>>>>>>>    Set Size to 206 347
43621>>>>>>>>>>>>>>>    Set Location to 4 5
43622>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
43623>>>>>>>>>>>>>>>    Set Modal_State to FALSE
43624>>>>>>>>>>>>>>>
43624>>>>>>>>>>>>>>>    //AB-DDOStart
43624>>>>>>>>>>>>>>>
43624>>>>>>>>>>>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
43626>>>>>>>>>>>>>>>    End_Object    // Baxiokat_DD
43627>>>>>>>>>>>>>>>
43627>>>>>>>>>>>>>>>    Set Main_DD to (Baxiokat_DD(self))
43628>>>>>>>>>>>>>>>    Set Server to (Baxiokat_DD(self))
43629>>>>>>>>>>>>>>>
43629>>>>>>>>>>>>>>>    //AB-DDOEnd
43629>>>>>>>>>>>>>>>
43629>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
43631>>>>>>>>>>>>>>>        Set Main_File to Baxiokat.File_Number
43632>>>>>>>>>>>>>>>        Set Size to 164 335
43633>>>>>>>>>>>>>>>        Set Location to 5 4
43634>>>>>>>>>>>>>>>
43634>>>>>>>>>>>>>>>        Begin_Row
43637>>>>>>>>>>>>>>>            Entry_Item Baxiokat.Baxiokat_code
43638>>>>>>>>>>>>>>>            Entry_Item Baxiokat.Baxiokat_descr
43639>>>>>>>>>>>>>>>            Entry_Item Baxiokat.Baxiokat_type
43640>>>>>>>>>>>>>>>            Entry_Item (Export_Code_Description(Self,2,Baxiokat.Baxiokat_type))
43641>>>>>>>>>>>>>>>        End_Row
43646>>>>>>>>>>>>>>>
43646>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 55
43647>>>>>>>>>>>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
43648>>>>>>>>>>>>>>>
43648>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 172
43649>>>>>>>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
43650>>>>>>>>>>>>>>>
43650>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 16
43651>>>>>>>>>>>>>>>        set header_label  item 2 to "’ç§¦ª" 
43652>>>>>>>>>>>>>>>
43652>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 83
43653>>>>>>>>>>>>>>>        set header_label  item 3 to "„ ©./¢ž¨." 
43654>>>>>>>>>>>>>>>
43654>>>>>>>>>>>>>>>    End_Object    // oSelList
43655>>>>>>>>>>>>>>>
43655>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
43657>>>>>>>>>>>>>>>        set label to "&„§ ¢¦šã" 
43658>>>>>>>>>>>>>>>        Set Location to 172 180
43659>>>>>>>>>>>>>>>
43659>>>>>>>>>>>>>>>        //AB-StoreStart
43659>>>>>>>>>>>>>>>        Procedure OnClick
43661>>>>>>>>>>>>>>>            Send OK To oSelList
43662>>>>>>>>>>>>>>>        End_Procedure
43663>>>>>>>>>>>>>>>        //AB-StoreEnd
43663>>>>>>>>>>>>>>>
43663>>>>>>>>>>>>>>>    End_Object    // oOK_bn
43664>>>>>>>>>>>>>>>
43664>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
43666>>>>>>>>>>>>>>>        set label to "&€¡ç¨à©ž" 
43667>>>>>>>>>>>>>>>        Set Location to 172 234
43668>>>>>>>>>>>>>>>
43668>>>>>>>>>>>>>>>        //AB-StoreStart
43668>>>>>>>>>>>>>>>        Procedure OnClick
43670>>>>>>>>>>>>>>>            Send Cancel To oSelList
43671>>>>>>>>>>>>>>>        End_Procedure
43672>>>>>>>>>>>>>>>        //AB-StoreEnd
43672>>>>>>>>>>>>>>>
43672>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
43673>>>>>>>>>>>>>>>
43673>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
43675>>>>>>>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
43676>>>>>>>>>>>>>>>        Set Location to 172 289
43677>>>>>>>>>>>>>>>
43677>>>>>>>>>>>>>>>        //AB-StoreStart
43677>>>>>>>>>>>>>>>        Procedure OnClick
43679>>>>>>>>>>>>>>>            Send Search To oSelList
43680>>>>>>>>>>>>>>>        End_Procedure
43681>>>>>>>>>>>>>>>        //AB-StoreEnd
43681>>>>>>>>>>>>>>>
43681>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
43682>>>>>>>>>>>>>>>
43682>>>>>>>>>>>>>>>
43682>>>>>>>>>>>>>>>    //AB-StoreStart
43682>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
43683>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
43684>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
43685>>>>>>>>>>>>>>>    //AB-StoreEnd
43685>>>>>>>>>>>>>>>
43685>>>>>>>>>>>>>>>CD_End_Object    // SL034
43687>>>>>>>>>>>>>>>>
43687>>>>>>>>>>>>>>>
43687>>>>>>>>>>>>>>>//AB/ End_Object    // prj
43687>>>>>>>>>>>>>
43687>>>>>>>>>>>>>//DDB-Selection-pkg-End
43687>>>>>>>>>>>>>//DDB-FileEnd
43687>>>>>>>>>>>    Use SYSCURXR.DD
INCLUDING FILE: SYSCURXR.DD
43687>>>>>>>>>>>>>//DDB-FileStart
43687>>>>>>>>>>>>>//DDB-HeaderStart
43687>>>>>>>>>>>>>
43687>>>>>>>>>>>>>// File Name : SYSCURXR.DD
43687>>>>>>>>>>>>>// Class Name: Syscurxr_DataDictionary
43687>>>>>>>>>>>>>// Revision  : 8
43687>>>>>>>>>>>>>// Version   : 2
43687>>>>>>>>>>>>>
43687>>>>>>>>>>>>>Use  Windows           // Basic Definitions
43687>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
43687>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43687>>>>>>>>>>>>>
43687>>>>>>>>>>>>>Open Syscurxr
43689>>>>>>>>>>>>>
43689>>>>>>>>>>>>>//DDB-HeaderEnd
43689>>>>>>>>>>>>>
43689>>>>>>>>>>>>>Class Syscurxr_DataDictionary  is a DataDictionary_Sec
43690>>>>>>>>>>>>>
43690>>>>>>>>>>>>>    // Define_Fields:
43690>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
43690>>>>>>>>>>>>>
43690>>>>>>>>>>>>>    Procedure Define_Fields
43691>>>>>>>>>>>>>        Forward Send Define_Fields
43693>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43693>>>>>>>>>>>>>        //DDB-DefineFieldStart
43693>>>>>>>>>>>>>
43693>>>>>>>>>>>>>        Set Main_File            To Syscurxr.File_Number
43694>>>>>>>>>>>>>
43694>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
43695>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
43696>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43697>>>>>>>>>>>>>
43697>>>>>>>>>>>>>        // Field-based properties.......................
43697>>>>>>>>>>>>>
43697>>>>>>>>>>>>>        // Syscurxr.Company_Code
43697>>>>>>>>>>>>>
43697>>>>>>>>>>>>>        // Syscurxr.Branch_Code
43697>>>>>>>>>>>>>
43697>>>>>>>>>>>>>        // Syscurxr.Year_Year
43697>>>>>>>>>>>>>
43697>>>>>>>>>>>>>        // Syscurxr.Branch_Site
43697>>>>>>>>>>>>>
43697>>>>>>>>>>>>>        // Syscurxr.Year_Recr
43697>>>>>>>>>>>>>
43697>>>>>>>>>>>>>        // Syscurxr.Company_Name
43697>>>>>>>>>>>>>
43697>>>>>>>>>>>>>        // Syscurxr.Branch_Name
43697>>>>>>>>>>>>>
43697>>>>>>>>>>>>>        // Syscurxr.Year_Descr
43697>>>>>>>>>>>>>
43697>>>>>>>>>>>>>        // Syscurxr.C_Code0
43697>>>>>>>>>>>>>
43697>>>>>>>>>>>>>        // Syscurxr.C_Code00
43697>>>>>>>>>>>>>
43697>>>>>>>>>>>>>        // Syscurxr.C_Coder
43697>>>>>>>>>>>>>
43697>>>>>>>>>>>>>        // Syscurxr.Year_Xrhshfrom
43697>>>>>>>>>>>>>
43697>>>>>>>>>>>>>        // Syscurxr.Year_Xrhshto
43697>>>>>>>>>>>>>
43697>>>>>>>>>>>>>        // Syscurxr.Beto_Site
43697>>>>>>>>>>>>>
43697>>>>>>>>>>>>>        // Syscurxr.Euro_Code
43697>>>>>>>>>>>>>
43697>>>>>>>>>>>>>        //DDB-DefineFieldEnd
43697>>>>>>>>>>>>>    End_Procedure    // Define_Fields
43698>>>>>>>>>>>>>
43698>>>>>>>>>>>>>    // Field_Defaults:
43698>>>>>>>>>>>>>    // This procedure is used to establish default field values.
43698>>>>>>>>>>>>>
43698>>>>>>>>>>>>>    Procedure Field_Defaults
43699>>>>>>>>>>>>>        Forward Send Field_Defaults
43701>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43701>>>>>>>>>>>>>        //DDB-FieldDefaultStart
43701>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
43701>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
43702>>>>>>>>>>>>>
43702>>>>>>>>>>>>>End_Class    // Syscurxr_DataDictionary
43703>>>>>>>>>>>>>//DDB-FileEnd
43703>>>>>>>>>>>    Use PMSSXET.DD
43703>>>>>>>>>>>    Use SALESMEN.DD
INCLUDING FILE: SALESMEN.DD
43703>>>>>>>>>>>>>//DDB-FileStart
43703>>>>>>>>>>>>>//DDB-HeaderStart
43703>>>>>>>>>>>>>
43703>>>>>>>>>>>>>// File Name : SALESMEN.DD
43703>>>>>>>>>>>>>// Class Name: Salesmen_DataDictionary
43703>>>>>>>>>>>>>// Revision  : 57
43703>>>>>>>>>>>>>// Version   : 2
43703>>>>>>>>>>>>>
43703>>>>>>>>>>>>>Use  Windows           // Basic Definitions
43703>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
43703>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43703>>>>>>>>>>>>>
43703>>>>>>>>>>>>>Open Salesmen
43705>>>>>>>>>>>>>Open Cn
43707>>>>>>>>>>>>>Open Sysrecc
43709>>>>>>>>>>>>>
43709>>>>>>>>>>>>>//DDB-HeaderEnd
43709>>>>>>>>>>>>>//DDB-ValidationStart
43709>>>>>>>>>>>>>
43709>>>>>>>>>>>>>Register_Object Salesmen_Sls_Doy_VT
43709>>>>>>>>>>>>>
43709>>>>>>>>>>>>>Object Salesmen_Sls_Doy_VT  is a CodeValidationTable
43711>>>>>>>>>>>>>    Set Type_Value        To "DOY"
43712>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
43713>>>>>>>>>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
43714>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43714>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43714>>>>>>>>>>>>>End_Object   // Salesmen_Sls_Doy_VT
43715>>>>>>>>>>>>>//DDB-ValidationEnd
43715>>>>>>>>>>>>>//DDB-SelectionStart
43715>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl108  sl108.sl
43715>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
43715>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
43715>>>>>>>>>>>>>Register_Object sl108
43715>>>>>>>>>>>>>Register_Object sl198
43715>>>>>>>>>>>>>Register_Object sl197
43715>>>>>>>>>>>>>//DDB-SelectionEnd
43715>>>>>>>>>>>>>
43715>>>>>>>>>>>>>Class Salesmen_DataDictionary  is a DataDictionary_Sec
43716>>>>>>>>>>>>> 
43716>>>>>>>>>>>>>    // Save_Main_File:
43716>>>>>>>>>>>>> 
43716>>>>>>>>>>>>>    Procedure Save_Main_File
43717>>>>>>>>>>>>>        If ((Operation_Origin<>Self) And (Salesmen.Sls_ID='')) Procedure_Return
43720>>>>>>>>>>>>>        Forward Send Save_Main_File
43722>>>>>>>>>>>>>    End_Procedure   // Save_Main_File
43723>>>>>>>>>>>>> 
43723>>>>>>>>>>>>>    // Define_Fields:
43723>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
43723>>>>>>>>>>>>>     Procedure Update
43724>>>>>>>>>>>>>        Forward Send Update
43726>>>>>>>>>>>>>        // Insert Code Here
43726>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to salesmen.Company_Code
43727>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to salesmen.Branch_Code
43728>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to salesmen.Year_Year
43729>>>>>>>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
43729>>>>>>>>>>>>>        Move (salesmen.Xreosh-salesmen.Pistosh)   to salesmen.Ypoloipo
43730>>>>>>>>>>>>>        Move (salesmen.Plafon-salesmen.ypoloipo)  to salesmen.Overhead
43731>>>>>>>>>>>>>
43731>>>>>>>>>>>>>        //Move Clients.Client_Address     to Clients.Client_LastUpd
43731>>>>>>>>>>>>>
43731>>>>>>>>>>>>>        //betolink
43731>>>>>>>>>>>>>        Move SysCurXR.Beto_Site      to salesmen.sls_SiteW
43732>>>>>>>>>>>>>        Move salesmen.sls_Rec0       to salesmen.sls_SN
43733>>>>>>>>>>>>>        Move salesmen.sls_id         to salesmen.sls_Repm
43734>>>>>>>>>>>>>
43734>>>>>>>>>>>>>    End_Procedure   // Update
43735>>>>>>>>>>>>>
43735>>>>>>>>>>>>>     Procedure Creating
43736>>>>>>>>>>>>>        Forward Send Creating
43738>>>>>>>>>>>>>        // Insert Code Here
43738>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(salesmen.sls_Rec0))))));                                    to salesmen.sls_Recr
43739>>>>>>>>>>>>>        Move '1'                    to salesmen.sls_Active
43740>>>>>>>>>>>>>        get fsgCode_With_Zeroes salesmen.sls_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to salesmen.sls_ID
43741>>>>>>>>>>>>>    End_Procedure   // Creating
43742>>>>>>>>>>>>>
43742>>>>>>>>>>>>>    Procedure Define_Fields
43743>>>>>>>>>>>>>        Forward Send Define_Fields
43745>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43745>>>>>>>>>>>>>        //DDB-DefineFieldStart
43745>>>>>>>>>>>>>
43745>>>>>>>>>>>>>        Set Main_File            To Salesmen.File_Number
43746>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
43747>>>>>>>>>>>>>
43747>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
43748>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
43749>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43750>>>>>>>>>>>>>
43750>>>>>>>>>>>>>        // Child (Client) file structure................
43750>>>>>>>>>>>>>        Send Add_Client_File  Cn.File_Number
43751>>>>>>>>>>>>>
43751>>>>>>>>>>>>>        // External (System) file structure.............
43751>>>>>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
43752>>>>>>>>>>>>>
43752>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecc.Salesmen_Rec0  To Salesmen.Sls_Rec0
43755>>>>>>>>>>>>>
43755>>>>>>>>>>>>>        // Field-based properties.......................
43755>>>>>>>>>>>>>
43755>>>>>>>>>>>>>        // Salesmen.Company_Code
43755>>>>>>>>>>>>>
43755>>>>>>>>>>>>>        // Salesmen.Branch_Code
43755>>>>>>>>>>>>>
43755>>>>>>>>>>>>>        // Salesmen.Year_Year
43755>>>>>>>>>>>>>
43755>>>>>>>>>>>>>        // Salesmen.Sls_Id
43755>>>>>>>>>>>>>        Set Field_Options          Field Salesmen.Sls_Id To DD_AUTOFIND    DD_FINDREQ    
43756>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Id To (sl108(Self))
43757>>>>>>>>>>>>>        Set Key_Field_State        Field Salesmen.Sls_Id To TRUE
43758>>>>>>>>>>>>>
43758>>>>>>>>>>>>>        // Salesmen.Sls_Name
43758>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Name To (sl108(Self))
43759>>>>>>>>>>>>>
43759>>>>>>>>>>>>>        // Salesmen.Sls_Afm
43759>>>>>>>>>>>>>
43759>>>>>>>>>>>>>        // Salesmen.Sls_Rec0
43759>>>>>>>>>>>>>
43759>>>>>>>>>>>>>        // Salesmen.Sls_Recr
43759>>>>>>>>>>>>>
43759>>>>>>>>>>>>>        // Salesmen.Last_Xreosh
43759>>>>>>>>>>>>>
43759>>>>>>>>>>>>>        // Salesmen.Last_Pistosh
43759>>>>>>>>>>>>>
43759>>>>>>>>>>>>>        // Salesmen.Last_Order
43759>>>>>>>>>>>>>
43759>>>>>>>>>>>>>        // Salesmen.Sls_Doy
43759>>>>>>>>>>>>>        Set Field_Value_Table      Field Salesmen.Sls_Doy To (Salesmen_Sls_Doy_VT(Self))
43760>>>>>>>>>>>>>
43760>>>>>>>>>>>>>        // Salesmen.Sls_Address
43760>>>>>>>>>>>>>
43760>>>>>>>>>>>>>        // Salesmen.Sls_City
43760>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_City To (sl198(Self))
43761>>>>>>>>>>>>>
43761>>>>>>>>>>>>>        // Salesmen.Sls_Area
43761>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Area To (sl197(Self))
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Sls_Job
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Sls_Respons
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Sls_Zipcode
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Sls_Phone
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Sls_Fax
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Sls_Mobile
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Sls_Aoh
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Sls_Email
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Sls_Class
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Sls_Details
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Sls_Sitew
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Sls_Codem
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Sls_Categfpa
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Sls_Fpa
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Sls_Public
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Sls_Sn
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Sls_Repm
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Sls_Active
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Sls_Reported
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Sls_Lastupd
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Sls_Markexp
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Sls_Catjob
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Xreosh
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Pistosh
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Ypoloipo
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Plafon
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Overhead
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Sls_Add_No
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Sls_Nomos
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Sls_Xora
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        // Salesmen.Polh_Recr
43762>>>>>>>>>>>>>
43762>>>>>>>>>>>>>        //DDB-DefineFieldEnd
43762>>>>>>>>>>>>>    End_Procedure    // Define_Fields
43763>>>>>>>>>>>>>
43763>>>>>>>>>>>>>    // Field_Defaults:
43763>>>>>>>>>>>>>    // This procedure is used to establish default field values.
43763>>>>>>>>>>>>>
43763>>>>>>>>>>>>>    Procedure Field_Defaults
43764>>>>>>>>>>>>>        Forward Send Field_Defaults
43766>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43766>>>>>>>>>>>>>        //DDB-FieldDefaultStart
43766>>>>>>>>>>>>>        Set Field_Changed_Value   Field Salesmen.Sls_Doy To "0"
43767>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
43767>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
43768>>>>>>>>>>>>>
43768>>>>>>>>>>>>>End_Class    // Salesmen_DataDictionary
43769>>>>>>>>>>>>>//DDB-Selection-pkg-Start
43769>>>>>>>>>>>>>
43769>>>>>>>>>>>>>Use sl108.sl         // sl108
INCLUDING FILE: SL108.SL
43769>>>>>>>>>>>>>>>//AB/ Project sl108:polhtes
43769>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
43769>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl108:polhtes"
43769>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl108.SL"
43769>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
43769>>>>>>>>>>>>>>>
43769>>>>>>>>>>>>>>>// Project Object Structure
43769>>>>>>>>>>>>>>>//   sl108 is a dbModalPanelSub
43769>>>>>>>>>>>>>>>//     Salesmen_DD is a DataDictionary
43769>>>>>>>>>>>>>>>//     oSelList is a dbListSub
43769>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
43769>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
43769>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
43769>>>>>>>>>>>>>>>
43769>>>>>>>>>>>>>>>// Register all objects
43769>>>>>>>>>>>>>>>Register_Object oCancel_bn
43769>>>>>>>>>>>>>>>Register_Object oOK_bn
43769>>>>>>>>>>>>>>>Register_Object oSearch_bn
43769>>>>>>>>>>>>>>>Register_Object oSelList
43769>>>>>>>>>>>>>>>Register_Object Salesmen_DD
43769>>>>>>>>>>>>>>>Register_Object sl108
43769>>>>>>>>>>>>>>>
43769>>>>>>>>>>>>>>>
43769>>>>>>>>>>>>>>>//AB-IgnoreStart
43769>>>>>>>>>>>>>>>
43769>>>>>>>>>>>>>>>Use DFAllEnt.pkg
43769>>>>>>>>>>>>>>>Use dbList.Sub
43769>>>>>>>>>>>>>>>Use Button.Sub
43769>>>>>>>>>>>>>>>
43769>>>>>>>>>>>>>>>
43769>>>>>>>>>>>>>>>Use SALESMEN.DD
43769>>>>>>>>>>>>>>>
43769>>>>>>>>>>>>>>>//AB-IgnoreEnd
43769>>>>>>>>>>>>>>>
43769>>>>>>>>>>>>>>>Object sl108 is a dbModalPanelSub
43771>>>>>>>>>>>>>>>    Set Label to "‹ž«¨é¦ à¢ž«é¤"
43772>>>>>>>>>>>>>>>    Set Size to 148 421
43773>>>>>>>>>>>>>>>    Set Location to 4 5
43774>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
43775>>>>>>>>>>>>>>>    Set Modal_State to FALSE
43776>>>>>>>>>>>>>>>
43776>>>>>>>>>>>>>>>    //AB-DDOStart
43776>>>>>>>>>>>>>>>
43776>>>>>>>>>>>>>>>    Object Salesmen_DD is a Salesmen_DataDictionary
43778>>>>>>>>>>>>>>>    End_Object    // Salesmen_DD
43779>>>>>>>>>>>>>>>
43779>>>>>>>>>>>>>>>    Set Main_DD to (Salesmen_DD(self))
43780>>>>>>>>>>>>>>>    Set Server to (Salesmen_DD(self))
43781>>>>>>>>>>>>>>>
43781>>>>>>>>>>>>>>>    //AB-DDOEnd
43781>>>>>>>>>>>>>>>
43781>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
43783>>>>>>>>>>>>>>>        Set Main_File to Salesmen.File_Number
43784>>>>>>>>>>>>>>>        Set Size to 105 408
43785>>>>>>>>>>>>>>>        Set Location to 6 6
43786>>>>>>>>>>>>>>>
43786>>>>>>>>>>>>>>>        Begin_Row
43789>>>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_id
43790>>>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_name
43791>>>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_afm
43792>>>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_address
43793>>>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_phone
43794>>>>>>>>>>>>>>>        End_Row
43799>>>>>>>>>>>>>>>
43799>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 60
43800>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
43801>>>>>>>>>>>>>>>        
43801>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 100
43802>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
43803>>>>>>>>>>>>>>>        
43803>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 60
43804>>>>>>>>>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
43805>>>>>>>>>>>>>>>        
43805>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 125
43806>>>>>>>>>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
43807>>>>>>>>>>>>>>>        
43807>>>>>>>>>>>>>>>        Set Form_Width    item 4 to 54
43808>>>>>>>>>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
43809>>>>>>>>>>>>>>>        
43809>>>>>>>>>>>>>>>    End_Object    // oSelList
43810>>>>>>>>>>>>>>>
43810>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
43812>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
43813>>>>>>>>>>>>>>>        Set Location to 117 255
43814>>>>>>>>>>>>>>>
43814>>>>>>>>>>>>>>>        //AB-StoreStart
43814>>>>>>>>>>>>>>>        Procedure OnClick
43816>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
43817>>>>>>>>>>>>>>>        End_Procedure
43818>>>>>>>>>>>>>>>        //AB-StoreEnd
43818>>>>>>>>>>>>>>>
43818>>>>>>>>>>>>>>>    End_Object    // oOK_bn
43819>>>>>>>>>>>>>>>
43819>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
43821>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
43822>>>>>>>>>>>>>>>        Set Location to 117 310
43823>>>>>>>>>>>>>>>
43823>>>>>>>>>>>>>>>        //AB-StoreStart
43823>>>>>>>>>>>>>>>        Procedure OnClick
43825>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
43826>>>>>>>>>>>>>>>        End_Procedure
43827>>>>>>>>>>>>>>>        //AB-StoreEnd
43827>>>>>>>>>>>>>>>
43827>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
43828>>>>>>>>>>>>>>>
43828>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
43830>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
43831>>>>>>>>>>>>>>>        Set Location to 117 365
43832>>>>>>>>>>>>>>>
43832>>>>>>>>>>>>>>>        //AB-StoreStart
43832>>>>>>>>>>>>>>>        Procedure OnClick
43834>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
43835>>>>>>>>>>>>>>>        End_Procedure
43836>>>>>>>>>>>>>>>        //AB-StoreEnd
43836>>>>>>>>>>>>>>>
43836>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
43837>>>>>>>>>>>>>>>
43837>>>>>>>>>>>>>>>
43837>>>>>>>>>>>>>>>    //AB-StoreStart
43837>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
43838>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
43839>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
43840>>>>>>>>>>>>>>>    //AB-StoreEnd
43840>>>>>>>>>>>>>>>
43840>>>>>>>>>>>>>>>End_Object    // sl108
43841>>>>>>>>>>>>>>>
43841>>>>>>>>>>>>>>>//AB/ End_Object    // prj
43841>>>>>>>>>>>>>Use sl198.sl         // sl198
43841>>>>>>>>>>>>>Use sl197.SL         // sl197
43841>>>>>>>>>>>>>
43841>>>>>>>>>>>>>//DDB-Selection-pkg-End
43841>>>>>>>>>>>>>//DDB-FileEnd
43841>>>>>>>>>>>    Use CONSTRCT.DD
INCLUDING FILE: CONSTRCT.DD
43841>>>>>>>>>>>>>//DDB-FileStart
43841>>>>>>>>>>>>>//DDB-HeaderStart
43841>>>>>>>>>>>>>
43841>>>>>>>>>>>>>// File Name : CONSTRCT.DD
43841>>>>>>>>>>>>>// Class Name: Constrct_DataDictionary
43841>>>>>>>>>>>>>// Revision  : 48
43841>>>>>>>>>>>>>// Version   : 2
43841>>>>>>>>>>>>>
43841>>>>>>>>>>>>>Use  Windows           // Basic Definitions
43841>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
43841>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43841>>>>>>>>>>>>>
43841>>>>>>>>>>>>>Open Constrct
43843>>>>>>>>>>>>>Open Cn
43845>>>>>>>>>>>>>Open Sysrecc
43847>>>>>>>>>>>>>
43847>>>>>>>>>>>>>//DDB-HeaderEnd
43847>>>>>>>>>>>>>//DDB-ValidationStart
43847>>>>>>>>>>>>>
43847>>>>>>>>>>>>>Register_Object Constrct_Cnt_Doy_VT1
43847>>>>>>>>>>>>>
43847>>>>>>>>>>>>>Object Constrct_Cnt_Doy_VT1  is a CodeValidationTable
43849>>>>>>>>>>>>>    Set Type_Value        To "DOY"
43850>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
43851>>>>>>>>>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
43852>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43852>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43852>>>>>>>>>>>>>End_Object   // Constrct_Cnt_Doy_VT1
43853>>>>>>>>>>>>>//DDB-ValidationEnd
43853>>>>>>>>>>>>>//DDB-SelectionStart
43853>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl109  sl109.SL
43853>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
43853>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
43853>>>>>>>>>>>>>Register_Object sl109
43853>>>>>>>>>>>>>Register_Object sl198
43853>>>>>>>>>>>>>Register_Object sl197
43853>>>>>>>>>>>>>//DDB-SelectionEnd
43853>>>>>>>>>>>>>
43853>>>>>>>>>>>>>Class Constrct_DataDictionary  is a DataDictionary_Sec
43854>>>>>>>>>>>>>
43854>>>>>>>>>>>>>
43854>>>>>>>>>>>>>
43854>>>>>>>>>>>>>    Procedure Update
43855>>>>>>>>>>>>>        Forward Send Update
43857>>>>>>>>>>>>>        // Insert Code Here
43857>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to constrct.Company_Code
43858>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to constrct.Branch_Code
43859>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to constrct.Year_Year
43860>>>>>>>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
43860>>>>>>>>>>>>>        Move (constrct.Xreosh-Constrct.Pistosh)   to Constrct.Ypoloipo
43861>>>>>>>>>>>>>        Move (constrct.Plafon-Constrct.Ypoloipo)  to Constrct.Overhead
43862>>>>>>>>>>>>>
43862>>>>>>>>>>>>>        //betolink
43862>>>>>>>>>>>>>        Move SysCurXR.Beto_Site      to Constrct.cnt_SiteW
43863>>>>>>>>>>>>>        Move Constrct.cnt_Rec0        to Constrct.cnt_SN
43864>>>>>>>>>>>>>        Move Constrct.cnt_id          to constrct.cnt_Repm
43865>>>>>>>>>>>>>
43865>>>>>>>>>>>>>    End_Procedure   // Update
43866>>>>>>>>>>>>>
43866>>>>>>>>>>>>>     Procedure Creating
43867>>>>>>>>>>>>>        Forward Send Creating
43869>>>>>>>>>>>>>        // Insert Code Here
43869>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Constrct.cnt_Rec0))))));                                    to Constrct.Cnt_Recr
43870>>>>>>>>>>>>>        Move '1'                    to Constrct.Cnt_Active
43871>>>>>>>>>>>>>        Get fsgCode_With_Zeroes Constrct.Cnt_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to Constrct.cnt_ID
43872>>>>>>>>>>>>>    End_Procedure   // Creating
43873>>>>>>>>>>>>>
43873>>>>>>>>>>>>>
43873>>>>>>>>>>>>>    Procedure Define_Fields
43874>>>>>>>>>>>>>        Forward Send Define_Fields
43876>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43876>>>>>>>>>>>>>        //DDB-DefineFieldStart
43876>>>>>>>>>>>>>
43876>>>>>>>>>>>>>        Set Main_File            To Constrct.File_Number
43877>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
43878>>>>>>>>>>>>>
43878>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
43879>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
43880>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43881>>>>>>>>>>>>>
43881>>>>>>>>>>>>>        // Child (Client) file structure................
43881>>>>>>>>>>>>>        Send Add_Client_File  Cn.File_Number
43882>>>>>>>>>>>>>
43882>>>>>>>>>>>>>        // External (System) file structure.............
43882>>>>>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
43883>>>>>>>>>>>>>
43883>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecc.Constrct_Rec0  To Constrct.Cnt_Rec0
43886>>>>>>>>>>>>>
43886>>>>>>>>>>>>>        // Field-based properties.......................
43886>>>>>>>>>>>>>
43886>>>>>>>>>>>>>        // Constrct.Company_Code
43886>>>>>>>>>>>>>
43886>>>>>>>>>>>>>        // Constrct.Branch_Code
43886>>>>>>>>>>>>>
43886>>>>>>>>>>>>>        // Constrct.Year_Year
43886>>>>>>>>>>>>>
43886>>>>>>>>>>>>>        // Constrct.Cnt_Id
43886>>>>>>>>>>>>>        Set Field_Options          Field Constrct.Cnt_Id To DD_AUTOFIND    DD_NOPUT      
43887>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_Id To (sl109(Self))
43888>>>>>>>>>>>>>        Set Key_Field_State        Field Constrct.Cnt_Id To TRUE
43889>>>>>>>>>>>>>
43889>>>>>>>>>>>>>        // Constrct.Cnt_Name
43889>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_Name To (sl109(Self))
43890>>>>>>>>>>>>>
43890>>>>>>>>>>>>>        // Constrct.Cnt_Afm
43890>>>>>>>>>>>>>
43890>>>>>>>>>>>>>        // Constrct.Cnt_Rec0
43890>>>>>>>>>>>>>
43890>>>>>>>>>>>>>        // Constrct.Cnt_Recr
43890>>>>>>>>>>>>>
43890>>>>>>>>>>>>>        // Constrct.Last_Xreosh
43890>>>>>>>>>>>>>
43890>>>>>>>>>>>>>        // Constrct.Last_Pistosh
43890>>>>>>>>>>>>>
43890>>>>>>>>>>>>>        // Constrct.Last_Order
43890>>>>>>>>>>>>>
43890>>>>>>>>>>>>>        // Constrct.Cnt_Doy
43890>>>>>>>>>>>>>        Set Field_Value_Table      Field Constrct.Cnt_Doy To (Constrct_Cnt_Doy_VT1(Self))
43891>>>>>>>>>>>>>
43891>>>>>>>>>>>>>        // Constrct.Cnt_Address
43891>>>>>>>>>>>>>
43891>>>>>>>>>>>>>        // Constrct.Cnt_City
43891>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_City To (sl198(Self))
43892>>>>>>>>>>>>>
43892>>>>>>>>>>>>>        // Constrct.Cnt_Area
43892>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_Area To (sl197(Self))
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Cnt_Job
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Cnt_Respons
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Cnt_Zipcode
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Cnt_Phone
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Cnt_Fax
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Cnt_Mobile
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Cnt_Aoh
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Cnt_Email
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Cnt_Class
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Cnt_Details
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Cnt_Sitew
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Cnt_Codem
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Cnt_Categfpa
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Cnt_Fpa
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Cnt_Public
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Cnt_Sn
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Cnt_Repm
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Cnt_Active
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Cnt_Reported
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Cnt_Pelprom
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Cnt_Lastupdated
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Cnt_Markexp
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Cnt_Catjob
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Xreosh
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Pistosh
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Ypoloipo
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Plafon
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Overhead
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Cnt_Add_No
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Cnt_Nomos
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Cnt_Xora
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        // Constrct.Polh_Recr
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>        //DDB-DefineFieldEnd
43893>>>>>>>>>>>>>    End_Procedure    // Define_Fields
43894>>>>>>>>>>>>>
43894>>>>>>>>>>>>>    // Field_Defaults:
43894>>>>>>>>>>>>>    // This procedure is used to establish default field values.
43894>>>>>>>>>>>>>
43894>>>>>>>>>>>>>    Procedure Field_Defaults
43895>>>>>>>>>>>>>        Forward Send Field_Defaults
43897>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43897>>>>>>>>>>>>>        //DDB-FieldDefaultStart
43897>>>>>>>>>>>>>        Set Field_Changed_Value   Field Constrct.Cnt_Doy To "0"
43898>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
43898>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
43899>>>>>>>>>>>>>
43899>>>>>>>>>>>>>End_Class    // Constrct_DataDictionary
43900>>>>>>>>>>>>>//DDB-Selection-pkg-Start
43900>>>>>>>>>>>>>
43900>>>>>>>>>>>>>Use sl109.SL         // sl109
INCLUDING FILE: SL109.SL
43900>>>>>>>>>>>>>>>//AB/ Project sl109
43900>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
43900>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl109"
43900>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl109.SL"
43900>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
43900>>>>>>>>>>>>>>>
43900>>>>>>>>>>>>>>>// Project Object Structure
43900>>>>>>>>>>>>>>>//   sl109 is a dbModalPanelSub
43900>>>>>>>>>>>>>>>//     Constrct_DD is a DataDictionary
43900>>>>>>>>>>>>>>>//     oSelList is a dbListSub
43900>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
43900>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
43900>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
43900>>>>>>>>>>>>>>>
43900>>>>>>>>>>>>>>>// Register all objects
43900>>>>>>>>>>>>>>>Register_Object Constrct_DD
43900>>>>>>>>>>>>>>>Register_Object oCancel_bn
43900>>>>>>>>>>>>>>>Register_Object oOK_bn
43900>>>>>>>>>>>>>>>Register_Object oSearch_bn
43900>>>>>>>>>>>>>>>Register_Object oSelList
43900>>>>>>>>>>>>>>>Register_Object sl109
43900>>>>>>>>>>>>>>>
43900>>>>>>>>>>>>>>>
43900>>>>>>>>>>>>>>>//AB-IgnoreStart
43900>>>>>>>>>>>>>>>
43900>>>>>>>>>>>>>>>Use DFAllEnt.pkg
43900>>>>>>>>>>>>>>>Use dbList.Sub
43900>>>>>>>>>>>>>>>Use Button.Sub
43900>>>>>>>>>>>>>>>
43900>>>>>>>>>>>>>>>
43900>>>>>>>>>>>>>>>Use CONSTRCT.DD
43900>>>>>>>>>>>>>>>
43900>>>>>>>>>>>>>>>//AB-IgnoreEnd
43900>>>>>>>>>>>>>>>
43900>>>>>>>>>>>>>>>Object sl109 is a dbModalPanelSub
43902>>>>>>>>>>>>>>>    Set Label to "„¨š¦¢á™¦  "
43903>>>>>>>>>>>>>>>    Set Size to 148 427
43904>>>>>>>>>>>>>>>    Set Location to 4 5
43905>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
43906>>>>>>>>>>>>>>>    Set Modal_State to FALSE
43907>>>>>>>>>>>>>>>
43907>>>>>>>>>>>>>>>    //AB-DDOStart
43907>>>>>>>>>>>>>>>
43907>>>>>>>>>>>>>>>    Object Constrct_DD is a Constrct_DataDictionary
43909>>>>>>>>>>>>>>>    End_Object    // Constrct_DD
43910>>>>>>>>>>>>>>>
43910>>>>>>>>>>>>>>>    Set Main_DD to (Constrct_DD(self))
43911>>>>>>>>>>>>>>>    Set Server to (Constrct_DD(self))
43912>>>>>>>>>>>>>>>
43912>>>>>>>>>>>>>>>    //AB-DDOEnd
43912>>>>>>>>>>>>>>>
43912>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
43914>>>>>>>>>>>>>>>        Set Main_File to Constrct.File_Number
43915>>>>>>>>>>>>>>>        Set Size to 105 415
43916>>>>>>>>>>>>>>>        Set Location to 6 6
43917>>>>>>>>>>>>>>>
43917>>>>>>>>>>>>>>>        Begin_Row
43920>>>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_id
43921>>>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_name
43922>>>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_afm
43923>>>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_address
43924>>>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_phone
43925>>>>>>>>>>>>>>>        End_Row
43930>>>>>>>>>>>>>>>
43930>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 70
43931>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
43932>>>>>>>>>>>>>>>        
43932>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 100
43933>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
43934>>>>>>>>>>>>>>>        
43934>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 50
43935>>>>>>>>>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
43936>>>>>>>>>>>>>>>        
43936>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 135
43937>>>>>>>>>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
43938>>>>>>>>>>>>>>>        
43938>>>>>>>>>>>>>>>        Set Form_Width    item 4 to 52
43939>>>>>>>>>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
43940>>>>>>>>>>>>>>>        
43940>>>>>>>>>>>>>>>    End_Object    // oSelList
43941>>>>>>>>>>>>>>>
43941>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
43943>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
43944>>>>>>>>>>>>>>>        Set Location to 116 261
43945>>>>>>>>>>>>>>>
43945>>>>>>>>>>>>>>>        //AB-StoreStart
43945>>>>>>>>>>>>>>>        Procedure OnClick
43947>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
43948>>>>>>>>>>>>>>>        End_Procedure
43949>>>>>>>>>>>>>>>        //AB-StoreEnd
43949>>>>>>>>>>>>>>>
43949>>>>>>>>>>>>>>>    End_Object    // oOK_bn
43950>>>>>>>>>>>>>>>
43950>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
43952>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
43953>>>>>>>>>>>>>>>        Set Location to 116 315
43954>>>>>>>>>>>>>>>
43954>>>>>>>>>>>>>>>        //AB-StoreStart
43954>>>>>>>>>>>>>>>        Procedure OnClick
43956>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
43957>>>>>>>>>>>>>>>        End_Procedure
43958>>>>>>>>>>>>>>>        //AB-StoreEnd
43958>>>>>>>>>>>>>>>
43958>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
43959>>>>>>>>>>>>>>>
43959>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
43961>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
43962>>>>>>>>>>>>>>>        Set Location to 116 371
43963>>>>>>>>>>>>>>>
43963>>>>>>>>>>>>>>>        //AB-StoreStart
43963>>>>>>>>>>>>>>>        Procedure OnClick
43965>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
43966>>>>>>>>>>>>>>>        End_Procedure
43967>>>>>>>>>>>>>>>        //AB-StoreEnd
43967>>>>>>>>>>>>>>>
43967>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
43968>>>>>>>>>>>>>>>
43968>>>>>>>>>>>>>>>
43968>>>>>>>>>>>>>>>    //AB-StoreStart
43968>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
43969>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
43970>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
43971>>>>>>>>>>>>>>>    //AB-StoreEnd
43971>>>>>>>>>>>>>>>
43971>>>>>>>>>>>>>>>End_Object    // sl109
43972>>>>>>>>>>>>>>>
43972>>>>>>>>>>>>>>>//AB/ End_Object    // prj
43972>>>>>>>>>>>>>Use sl198.sl         // sl198
43972>>>>>>>>>>>>>Use sl197.SL         // sl197
43972>>>>>>>>>>>>>
43972>>>>>>>>>>>>>//DDB-Selection-pkg-End
43972>>>>>>>>>>>>>//DDB-FileEnd
43972>>>>>>>>>>>    Use CN.DD
43972>>>>>>>>>>>    Use PSXETIKA.DD
INCLUDING FILE: PSXETIKA.DD
43972>>>>>>>>>>>>>//DDB-FileStart
43972>>>>>>>>>>>>>//DDB-HeaderStart
43972>>>>>>>>>>>>>
43972>>>>>>>>>>>>>// File Name : PSXETIKA.DD
43972>>>>>>>>>>>>>// Class Name: Psxetika_DataDictionary
43972>>>>>>>>>>>>>// Revision  : 14
43972>>>>>>>>>>>>>// Version   : 2
43972>>>>>>>>>>>>>
43972>>>>>>>>>>>>>Use  Windows           // Basic Definitions
43972>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
43972>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43972>>>>>>>>>>>>>
43972>>>>>>>>>>>>>Open Psxetika
43974>>>>>>>>>>>>>Open Particle
43976>>>>>>>>>>>>>Open Sysrecp
43978>>>>>>>>>>>>>
43978>>>>>>>>>>>>>//DDB-HeaderEnd
43978>>>>>>>>>>>>>
43978>>>>>>>>>>>>>Class Psxetika_DataDictionary  is a DataDictionary_Sec
43979>>>>>>>>>>>>>    
43979>>>>>>>>>>>>>    Procedure Creating
43980>>>>>>>>>>>>>        Integer iNextNo
43981>>>>>>>>>>>>>        Forward Send Creating
43983>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Psxetika.Psxetika_Rec0)))))) to Psxetika.Psxetika_Recr
43984>>>>>>>>>>>>>    End_Procedure   // Creating
43985>>>>>>>>>>>>>
43985>>>>>>>>>>>>>    Procedure Update
43986>>>>>>>>>>>>>        Forward Send Update
43988>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to Psxetika.Company_Code
43989>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Psxetika.Branch_Code
43990>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to Psxetika.Year_Year
43991>>>>>>>>>>>>>        Move Clients.Client_ID      to Psxetika.Client_ID
43992>>>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code   to Psxetika.Ctypkin_Code
43993>>>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code   to Psxetika.Wtypkin_Code
43994>>>>>>>>>>>>>        Move Ptyppar.Ptyppar_Code   to Psxetika.Ptyppar_Code
43995>>>>>>>>>>>>>        Move Particle.Partl_Hmnia   to Psxetika.Partl_Hmnia
43996>>>>>>>>>>>>>        Move Pseira.Pseira_Seira    to Psxetika.Pseira_Seira
43997>>>>>>>>>>>>>        Move Particle.Partl_No      to Psxetika.Partl_No
43998>>>>>>>>>>>>>    End_Procedure   // Update
43999>>>>>>>>>>>>>
43999>>>>>>>>>>>>>
43999>>>>>>>>>>>>>    Procedure Request_Save
44000>>>>>>>>>>>>>        Number  nQty
44001>>>>>>>>>>>>>        String  sParticleRecr sPsxetikaRecr
44001>>>>>>>>>>>>>
44001>>>>>>>>>>>>>        Forward Send Request_Save
44003>>>>>>>>>>>>>
44003>>>>>>>>>>>>>        Get File_Field_Current_Value File_Field Particle.Partl_Recr     to sParticleRecr
44004>>>>>>>>>>>>>        Get File_Field_Current_Value File_Field Psxetika.Psx_Partl_Recr to sPsxetikaRecr
44005>>>>>>>>>>>>>        If ((Trim(sParticleRecr)<>'') And (Trim(sPsxetikaRecr)<>'')) Begin
44007>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Psxetika.Pms_Sx_Qty to nQty
44008>>>>>>>>>>>>>            If (nQty=0) Begin
44010>>>>>>>>>>>>>                // An h posothta pou menei apo to athroisma posothtas ton Pmoves Sxetika
44010>>>>>>>>>>>>>                // Mhdenisei, ayto shmainei pos den yparxoun alla Pmoves Sxetika, ara
44010>>>>>>>>>>>>>                // prepei na diagrafei ayto to Psxetika record kai to antistrofo tou.
44010>>>>>>>>>>>>>                Delete Psxetika
44011>>>>>>>>>>>>>                Clear Psxetika
44012>>>>>>>>>>>>>                Move sPsxetikaRecr  to Psxetika.Partl_Recr
44013>>>>>>>>>>>>>                Move sParticleRecr  to Psxetika.Psx_Partl_Recr
44014>>>>>>>>>>>>>                Find Eq Psxetika by Index.4
44015>>>>>>>>>>>>>>
44015>>>>>>>>>>>>>                If (Found) Delete Psxetika
44018>>>>>>>>>>>>>            End
44018>>>>>>>>>>>>>>
44018>>>>>>>>>>>>>        End
44018>>>>>>>>>>>>>>
44018>>>>>>>>>>>>>    End_Procedure
44019>>>>>>>>>>>>>
44019>>>>>>>>>>>>>
44019>>>>>>>>>>>>>    // Define_Fields:
44019>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
44019>>>>>>>>>>>>>
44019>>>>>>>>>>>>>    Procedure Define_Fields
44020>>>>>>>>>>>>>        Forward Send Define_Fields
44022>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44022>>>>>>>>>>>>>        //DDB-DefineFieldStart
44022>>>>>>>>>>>>>
44022>>>>>>>>>>>>>        Set Main_File            To Psxetika.File_Number
44023>>>>>>>>>>>>>
44023>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
44024>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
44025>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
44026>>>>>>>>>>>>>
44026>>>>>>>>>>>>>        // Parent (Server) file structure...............
44026>>>>>>>>>>>>>        Send Add_Server_File  Particle.File_Number
44027>>>>>>>>>>>>>
44027>>>>>>>>>>>>>        // External (System) file structure.............
44027>>>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
44028>>>>>>>>>>>>>
44028>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Psxetika_Rec0  To Psxetika.Psxetika_Rec0
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Field-based properties.......................
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Company_Code
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Branch_Code
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Year_Year
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Ctypkin_Code
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Wtypkin_Code
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Ptyppar_Code
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Pseira_Seira
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Custprom_Code
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Client_Id
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Partl_No
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Partl_Hmnia
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Partl_Recr
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Psx_Partl_Recr
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Psxetika_Recr
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Psxetika_Rec0
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Sx_Company_Code
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Sx_Branch_Code
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Sx_Year_Year
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Sx_Ctypkin_Code
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Sx_Wtypkin_Code
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Sx_Ptyppar_Code
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Sx_Pseira_Seira
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Sx_Custpromcode
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Sx_Client_Id
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Sx_Partl_No
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Sx_Partl_Hmnia
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Sx_Ctypkin_Desc
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Sx_Wtypkin_Desc
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Sx_Ptyppar_Desc
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Sx_Custpromdesc
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Sx_Client_Desc
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Psxetika.Pms_Sx_Qty
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        //DDB-DefineFieldEnd
44031>>>>>>>>>>>>>    End_Procedure    // Define_Fields
44032>>>>>>>>>>>>>
44032>>>>>>>>>>>>>    // Field_Defaults:
44032>>>>>>>>>>>>>    // This procedure is used to establish default field values.
44032>>>>>>>>>>>>>
44032>>>>>>>>>>>>>    Procedure Field_Defaults
44033>>>>>>>>>>>>>        Forward Send Field_Defaults
44035>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44035>>>>>>>>>>>>>        //DDB-FieldDefaultStart
44035>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
44035>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
44036>>>>>>>>>>>>>
44036>>>>>>>>>>>>>End_Class    // Psxetika_DataDictionary
44037>>>>>>>>>>>>>//DDB-FileEnd
44037>>>>>>>>>>>    Use TPARTICL.DD
INCLUDING FILE: TPARTICL.DD
44037>>>>>>>>>>>>>//DDB-FileStart
44037>>>>>>>>>>>>>//DDB-HeaderStart
44037>>>>>>>>>>>>>
44037>>>>>>>>>>>>>// File Name : TPARTICL.DD
44037>>>>>>>>>>>>>// Class Name: Tparticl_DataDictionary
44037>>>>>>>>>>>>>// Revision  : 27
44037>>>>>>>>>>>>>// Version   : 2
44037>>>>>>>>>>>>>
44037>>>>>>>>>>>>>Use  Windows           // Basic Definitions
44037>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
44037>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
44037>>>>>>>>>>>>>
44037>>>>>>>>>>>>>Open Tparticl
44039>>>>>>>>>>>>>Open Particle
44041>>>>>>>>>>>>>Open Baxiokat
44043>>>>>>>>>>>>>Open Sysrecc
44045>>>>>>>>>>>>>
44045>>>>>>>>>>>>>//DDB-HeaderEnd
44045>>>>>>>>>>>>>//DDB-ValidationStart
44045>>>>>>>>>>>>>
44045>>>>>>>>>>>>>Register_Object Mera_Tou_Mhna_VT
44045>>>>>>>>>>>>>
44045>>>>>>>>>>>>>Object Mera_Tou_Mhna_VT  is a CodeValidationTable
44047>>>>>>>>>>>>>    Set Type_Value        To "HMERES"
44048>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
44049>>>>>>>>>>>>>    //DDB-ValidationCustomStart
44049>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
44049>>>>>>>>>>>>>End_Object   // Mera_Tou_Mhna_VT
44050>>>>>>>>>>>>>//DDB-ValidationEnd
44050>>>>>>>>>>>>>
44050>>>>>>>>>>>>>Class Tparticl_DataDictionary  is a DataDictionary_Sec
44051>>>>>>>>>>>>>
44051>>>>>>>>>>>>>    Procedure Construct_Object
44052>>>>>>>>>>>>>        Forward Send Construct_Object
44054>>>>>>>>>>>>>        Property Integer piParticleID Public 0
44055>>>>>>>>>>>>>        Property Integer piBaxiokatID Public 0
44056>>>>>>>>>>>>>    End_Procedure
44057>>>>>>>>>>>>>
44057>>>>>>>>>>>>>    Procedure End_Construct_Object
44058>>>>>>>>>>>>>        Integer iID
44059>>>>>>>>>>>>>        Forward Send End_Construct_Object
44061>>>>>>>>>>>>>        Move (Find_Server_DDO(Self,Particle.File_Number )) to iID
44062>>>>>>>>>>>>>        Set piParticleID to iID
44063>>>>>>>>>>>>>        Move (Find_Server_DDO(Self,Baxiokat.File_Number )) to iID
44064>>>>>>>>>>>>>        Set piBaxiokatID to iID
44065>>>>>>>>>>>>>    End_Procedure
44066>>>>>>>>>>>>>
44066>>>>>>>>>>>>>    Procedure Calc_All_The_Fields
44067>>>>>>>>>>>>>        Number  nSynolo nPoso nPososto naxia
44068>>>>>>>>>>>>>        Date    dHmniaPlhromhs dHmniaParalabhs dHmniaTimologiou
44068>>>>>>>>>>>>>        Date    dProkeiptei dProsDate dAddDate dStartDate dEndDate
44068>>>>>>>>>>>>>        Integer iMeresXaritos iMeratouMhna iMeresParalabhs iID iInt iAdd
44068>>>>>>>>>>>>>        Integer iMeresPlhroteo iCode iXhmero iMhnasTimologiou  iMet
44068>>>>>>>>>>>>>
44068>>>>>>>>>>>>>        Get piBaxiokatID                                                to iID
44069>>>>>>>>>>>>>        Get Field_Current_Value Of iID Field Baxiokat.Baxiokat_Code     to iCode
44070>>>>>>>>>>>>>
44070>>>>>>>>>>>>>
44070>>>>>>>>>>>>>        Get piParticleID                                                to iID
44071>>>>>>>>>>>>>        Get Field_Current_Value Of iID Field Particle.Partl_Payam       to nSynolo
44072>>>>>>>>>>>>>        Get Field_Current_Value Of iID Field Particle.Partl_Hmnia       to dHmniaTimologiou
44073>>>>>>>>>>>>>        Get Field_Current_Value        Field TParticl.Pct_Epi_Synolou   to nPososto
44074>>>>>>>>>>>>>        Get Field_Current_Value        Field TParticl.Paralabh_Meres    to iMeresParalabhs
44075>>>>>>>>>>>>>        Get Field_Current_Value        Field TParticl.Xarhtos_Meres     to iMeresXaritos
44076>>>>>>>>>>>>>        Get Field_Current_Value        Field TParticl.Plhroteo_Meres    to iMeresPlhroteo
44077>>>>>>>>>>>>>
44077>>>>>>>>>>>>>        //////////////////////////////////////////////////////////////////////////
44077>>>>>>>>>>>>>        /////        10 (x)     -      10 (y)         /          30 (z)      /////
44077>>>>>>>>>>>>>        /////  iMeresParalabhs    iMeresXaritos              iMeresPlhroteo  /////
44077>>>>>>>>>>>>>        //////////////////////////////////////////////////////////////////////////
44077>>>>>>>>>>>>>
44077>>>>>>>>>>>>>        //  1. Kathorise thn 1h tou mhna, hmeromhniaka
44077>>>>>>>>>>>>>        Move ('01'+'/'+(String(TheMonthSegment(dHmniaTimologiou)))+'/'+;                       (String(TheYearSegment(dHmniaTimologiou)))) to dStartDate
44078>>>>>>>>>>>>>
44078>>>>>>>>>>>>>//        //  2. Vres thn Hmeromhnia paralabhs (Teleytaia hmera tou epomenou y hmerou
44078>>>>>>>>>>>>>//        //     sthn opoia meta tha prosthesoume tis hmeres paralabhs (x) )
44078>>>>>>>>>>>>>//        Move dStartDate to dHmniaParalabhs
44078>>>>>>>>>>>>>//        While (dHmniaParalabhs<(dHmniaTimologiou+iMeresXaritos))
44078>>>>>>>>>>>>>//            Add iMeresXaritos to dHmniaParalabhs
44078>>>>>>>>>>>>>//        Loop
44078>>>>>>>>>>>>>//        Add iMeresParalabhs to dHmniaParalabhs
44078>>>>>>>>>>>>>
44078>>>>>>>>>>>>>//        //  3. Vres thn Hmeromhnia Lhxhs ths epitaghs  (Teleytaia hmera tou trxontos y hmerou
44078>>>>>>>>>>>>>//        //     sthn opoia meta tha prosthesoume tis hmeres plhroteo (z) )
44078>>>>>>>>>>>>>//        Move dStartDate to dHmniaPlhromhs
44078>>>>>>>>>>>>>//        While (dHmniaPlhromhs<dHmniaTimologiou)
44078>>>>>>>>>>>>>//            Add iMeresXaritos to dHmniaPlhromhs
44078>>>>>>>>>>>>>//        Loop
44078>>>>>>>>>>>>>//        Add iMeresPlhroteo  to dHmniaPlhromhs
44078>>>>>>>>>>>>>
44078>>>>>>>>>>>>>        //  2. Vres thn Hmeromhnia  ths teleytaias hmera tou trexontos y hmerou
44078>>>>>>>>>>>>>        Move dStartDate to dHmniaParalabhs
44079>>>>>>>>>>>>>        If (iMeresXaritos<>0) Begin
44081>>>>>>>>>>>>>            While (dHmniaParalabhs<dHmniaTimologiou)
44085>>>>>>>>>>>>>                Add iMeresXaritos   to dHmniaParalabhs
44086>>>>>>>>>>>>>            Loop
44087>>>>>>>>>>>>>>
44087>>>>>>>>>>>>>        End
44087>>>>>>>>>>>>>>
44087>>>>>>>>>>>>>        Move dHmniaParalabhs    to dHmniaPlhromhs
44088>>>>>>>>>>>>>
44088>>>>>>>>>>>>>        Add (iMeresParalabhs-1) to dHmniaParalabhs
44089>>>>>>>>>>>>>        Add (iMeresPlhroteo-1)  to dHmniaPlhromhs
44090>>>>>>>>>>>>>
44090>>>>>>>>>>>>>        // Ypologise prota to poso bash posostou se sxesh me synolo parastatikou
44090>>>>>>>>>>>>>        Move (Round_number((nSynolo*nPososto/100),2))   to naxia
44091>>>>>>>>>>>>>
44091>>>>>>>>>>>>>        Set Field_Changed_Value Field TParticl.Poso     to naxia
44092>>>>>>>>>>>>>        Set Field_Changed_Value Field TParticl.Paralabh to dHmniaParalabhs
44093>>>>>>>>>>>>>        Set Field_Changed_Value Field TParticl.Exoflhsh to dHmniaPlhromhs
44094>>>>>>>>>>>>>
44094>>>>>>>>>>>>>    End_Procedure
44095>>>>>>>>>>>>>
44095>>>>>>>>>>>>>
44095>>>>>>>>>>>>>    Procedure Creating
44096>>>>>>>>>>>>>        Forward Send Creating
44098>>>>>>>>>>>>>        // Insert Code Here
44098>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Tparticl.Tparticl_Rec0))))));                                    to Tparticl.Tparticl_Recr
44099>>>>>>>>>>>>>    End_Procedure   // Creating
44100>>>>>>>>>>>>>
44100>>>>>>>>>>>>>
44100>>>>>>>>>>>>>    Procedure Save_Main_File
44101>>>>>>>>>>>>>        If (tparticl.isok <> '1') move ' ' to tparticl.isok
44104>>>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
44106>>>>>>>>>>>>>            If tparticl.Recnum Eq 0 Procedure_Return
44109>>>>>>>>>>>>>        End
44109>>>>>>>>>>>>>>
44109>>>>>>>>>>>>>      Forward Send Save_Main_File
44111>>>>>>>>>>>>>    End_Procedure   // Save_Main_File
44112>>>>>>>>>>>>>
44112>>>>>>>>>>>>>
44112>>>>>>>>>>>>>
44112>>>>>>>>>>>>>
44112>>>>>>>>>>>>>
44112>>>>>>>>>>>>>    // Define_Fields:
44112>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
44112>>>>>>>>>>>>>
44112>>>>>>>>>>>>>    Procedure Define_Fields
44113>>>>>>>>>>>>>        Forward Send Define_Fields
44115>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44115>>>>>>>>>>>>>        //DDB-DefineFieldStart
44115>>>>>>>>>>>>>
44115>>>>>>>>>>>>>        Set Main_File            To Tparticl.File_Number
44116>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
44117>>>>>>>>>>>>>
44117>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
44118>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
44119>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
44120>>>>>>>>>>>>>
44120>>>>>>>>>>>>>        // Parent (Server) file structure...............
44120>>>>>>>>>>>>>        Send Add_Server_File  Particle.File_Number
44121>>>>>>>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
44122>>>>>>>>>>>>>
44122>>>>>>>>>>>>>        // External (System) file structure.............
44122>>>>>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
44123>>>>>>>>>>>>>
44123>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecc.Tparticl_Rec0  To Tparticl.Tparticl_Rec0
44126>>>>>>>>>>>>>
44126>>>>>>>>>>>>>        // Field-based properties.......................
44126>>>>>>>>>>>>>
44126>>>>>>>>>>>>>        // Tparticl.Partl_Recr
44126>>>>>>>>>>>>>
44126>>>>>>>>>>>>>        // Tparticl.Baxiokat_Code
44126>>>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Baxiokat_Code To Calc_All_The_Fields
44127>>>>>>>>>>>>>
44127>>>>>>>>>>>>>        // Tparticl.Pct_Epi_Synolou
44127>>>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Pct_Epi_Synolou To Calc_All_The_Fields
44128>>>>>>>>>>>>>
44128>>>>>>>>>>>>>        // Tparticl.Paralabh_Meres
44128>>>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Paralabh_Meres To Calc_All_The_Fields
44129>>>>>>>>>>>>>
44129>>>>>>>>>>>>>        // Tparticl.Xarhtos_Meres
44129>>>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Xarhtos_Meres To Calc_All_The_Fields
44130>>>>>>>>>>>>>
44130>>>>>>>>>>>>>        // Tparticl.Plhroteo_Meres
44130>>>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Plhroteo_Meres To Calc_All_The_Fields
44131>>>>>>>>>>>>>
44131>>>>>>>>>>>>>        // Tparticl.Tparticl_Rec0
44131>>>>>>>>>>>>>
44131>>>>>>>>>>>>>        // Tparticl.Tparticl_Recr
44131>>>>>>>>>>>>>
44131>>>>>>>>>>>>>        // Tparticl.Mera_Tou_Mhna
44131>>>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Mera_Tou_Mhna To Calc_All_The_Fields
44132>>>>>>>>>>>>>        Set Field_Value_Table      Field Tparticl.Mera_Tou_Mhna To (Mera_Tou_Mhna_VT(Self))
44133>>>>>>>>>>>>>
44133>>>>>>>>>>>>>        // Tparticl.Poso
44133>>>>>>>>>>>>>
44133>>>>>>>>>>>>>        // Tparticl.Paralabh
44133>>>>>>>>>>>>>
44133>>>>>>>>>>>>>        // Tparticl.Exoflhsh
44133>>>>>>>>>>>>>
44133>>>>>>>>>>>>>        // Tparticl.Isok
44133>>>>>>>>>>>>>
44133>>>>>>>>>>>>>        //DDB-DefineFieldEnd
44133>>>>>>>>>>>>>    End_Procedure    // Define_Fields
44134>>>>>>>>>>>>>
44134>>>>>>>>>>>>>    // Field_Defaults:
44134>>>>>>>>>>>>>    // This procedure is used to establish default field values.
44134>>>>>>>>>>>>>
44134>>>>>>>>>>>>>    Procedure Field_Defaults
44135>>>>>>>>>>>>>        Forward Send Field_Defaults
44137>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44137>>>>>>>>>>>>>        //DDB-FieldDefaultStart
44137>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
44137>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
44138>>>>>>>>>>>>>
44138>>>>>>>>>>>>>End_Class    // Tparticl_DataDictionary
44139>>>>>>>>>>>>>//DDB-FileEnd
44139>>>>>>>>>>>    Use PARTLFPA.DD
INCLUDING FILE: PARTLFPA.DD
44139>>>>>>>>>>>>>//DDB-FileStart
44139>>>>>>>>>>>>>//DDB-HeaderStart
44139>>>>>>>>>>>>>
44139>>>>>>>>>>>>>// File Name : PARTLFPA.DD
44139>>>>>>>>>>>>>// Class Name: Partlfpa_DataDictionary
44139>>>>>>>>>>>>>// Revision  : 5
44139>>>>>>>>>>>>>// Version   : 2
44139>>>>>>>>>>>>>
44139>>>>>>>>>>>>>Use  Windows           // Basic Definitions
44139>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
44139>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
44139>>>>>>>>>>>>>
44139>>>>>>>>>>>>>Open Partlfpa
44141>>>>>>>>>>>>>Open Particle
44143>>>>>>>>>>>>>Open Fpa
44145>>>>>>>>>>>>>
44145>>>>>>>>>>>>>//DDB-HeaderEnd
44145>>>>>>>>>>>>> 
44145>>>>>>>>>>>>>Class Partlfpa_DataDictionary  is a DataDictionary_Sec
44146>>>>>>>>>>>>>
44146>>>>>>>>>>>>>
44146>>>>>>>>>>>>>    // Define_Fields:
44146>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
44146>>>>>>>>>>>>>
44146>>>>>>>>>>>>>    Procedure Define_Fields
44147>>>>>>>>>>>>>        Forward Send Define_Fields
44149>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44149>>>>>>>>>>>>>        //DDB-DefineFieldStart
44149>>>>>>>>>>>>>
44149>>>>>>>>>>>>>        Set Main_File            To Partlfpa.File_Number
44150>>>>>>>>>>>>>
44150>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
44151>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
44152>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
44153>>>>>>>>>>>>>
44153>>>>>>>>>>>>>        // Parent (Server) file structure...............
44153>>>>>>>>>>>>>        Send Add_Server_File  Particle.File_Number
44154>>>>>>>>>>>>>        Send Add_Server_File  Fpa.File_Number
44155>>>>>>>>>>>>>
44155>>>>>>>>>>>>>        // Field-based properties.......................
44155>>>>>>>>>>>>>
44155>>>>>>>>>>>>>        // Partlfpa.Partl_Recr
44155>>>>>>>>>>>>>
44155>>>>>>>>>>>>>        // Partlfpa.Fpa_Pososto
44155>>>>>>>>>>>>>
44155>>>>>>>>>>>>>        // Partlfpa.Partlfpa_Poso
44155>>>>>>>>>>>>>
44155>>>>>>>>>>>>>        // Partlfpa.Poso_Pro_Ekpt
44155>>>>>>>>>>>>>
44155>>>>>>>>>>>>>        // Partlfpa.Poso_Ekpt
44155>>>>>>>>>>>>>
44155>>>>>>>>>>>>>        // Partlfpa.Poso_Pro_Fpa
44155>>>>>>>>>>>>>
44155>>>>>>>>>>>>>        //DDB-DefineFieldEnd
44155>>>>>>>>>>>>>    End_Procedure    // Define_Fields
44156>>>>>>>>>>>>>
44156>>>>>>>>>>>>>    // Field_Defaults:
44156>>>>>>>>>>>>>    // This procedure is used to establish default field values.
44156>>>>>>>>>>>>>
44156>>>>>>>>>>>>>    Procedure Field_Defaults
44157>>>>>>>>>>>>>        Forward Send Field_Defaults
44159>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44159>>>>>>>>>>>>>        //DDB-FieldDefaultStart
44159>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
44159>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
44160>>>>>>>>>>>>>
44160>>>>>>>>>>>>>End_Class    // Partlfpa_DataDictionary
44161>>>>>>>>>>>>>//DDB-FileEnd
44161>>>>>>>>>>>
44161>>>>>>>>>>>    //AB-StoreTopEnd
44161>>>>>>>>>>>
44161>>>>>>>>>>>    //AB-IgnoreStart
44161>>>>>>>>>>>
44161>>>>>>>>>>>    Use Bproces.Sub
44161>>>>>>>>>>>
44161>>>>>>>>>>>
44161>>>>>>>>>>>    //AB-IgnoreEnd
44161>>>>>>>>>>>
44161>>>>>>>>>>>    Object Psx_Array is a BusinessProcessSub
44163>>>>>>>>>>>
44163>>>>>>>>>>>        //AB-StoreTopStart
44163>>>>>>>>>>>
44163>>>>>>>>>>>        Property    String  psParticleRecr0 Public ''
44165>>>>>>>>>>>        Property    String  psPsxetikaRecr0 Public ''
44167>>>>>>>>>>>        Property    String  psClient_Desc   Public ''
44169>>>>>>>>>>>        Property    String  psPtyppar_Desc  Public ''
44171>>>>>>>>>>>        Property    String  psSeira_Seira   Public ''
44173>>>>>>>>>>>        Property    Date    pdPartl_Hmnia   Public ''
44175>>>>>>>>>>>        Property    Integer piPartl_No      Public  0
44177>>>>>>>>>>>        Property    Number  pnPosothta      Public  0
44179>>>>>>>>>>>
44179>>>>>>>>>>>        Object Ctypkin_DD2 is a Ctypkin_DataDictionary
44181>>>>>>>>>>>        End_Object    // Ctypkin_DD2
44182>>>>>>>>>>>
44182>>>>>>>>>>>        Object Wtypkin_DD2 is a Wtypkin_DataDictionary
44184>>>>>>>>>>>        End_Object    // Wtypkin_DD2
44185>>>>>>>>>>>
44185>>>>>>>>>>>        Object Ptyppar_DD2 is a Ptyppar_DataDictionary
44187>>>>>>>>>>>            Set DDO_Server to (Ctypkin_DD2(self))
44188>>>>>>>>>>>            Set DDO_Server to (Wtypkin_DD2(self))
44189>>>>>>>>>>>        End_Object    // Ptyppar_DD2
44190>>>>>>>>>>>
44190>>>>>>>>>>>        Object Country_DD2 is a Country_DataDictionary
44192>>>>>>>>>>>        End_Object    // Country_DD2
44193>>>>>>>>>>>
44193>>>>>>>>>>>        Object Towns_DD2 is a Towns_DataDictionary
44195>>>>>>>>>>>            Set DDO_Server to (Country_DD2(self))
44196>>>>>>>>>>>        End_Object    // Towns_DD2
44197>>>>>>>>>>>
44197>>>>>>>>>>>        Object Cities_DD2 is a Cities_DataDictionary
44199>>>>>>>>>>>            Set DDO_Server to (Towns_DD2(self))
44200>>>>>>>>>>>        End_Object    // Cities_DD2
44201>>>>>>>>>>>
44201>>>>>>>>>>>        Object Areas_DD2 is a Areas_DataDictionary
44203>>>>>>>>>>>        End_Object    // Areas_DD2
44204>>>>>>>>>>>
44204>>>>>>>>>>>        Object Payresp_DD2 is a Payresp_DataDictionary
44206>>>>>>>>>>>        End_Object    // Payresp_DD2
44207>>>>>>>>>>>
44207>>>>>>>>>>>        Object Clients_DD2 is a Clients_DataDictionary
44209>>>>>>>>>>>            Set DDO_Server to (Cities_DD2(self))
44210>>>>>>>>>>>            Set DDO_Server to (Areas_DD2(self))
44211>>>>>>>>>>>            Set DDO_Server to (Payresp_DD2(self))
44212>>>>>>>>>>>        End_Object    // Clients_DD2
44213>>>>>>>>>>>
44213>>>>>>>>>>>        Object Nomisma_DD2 is a Nomisma_DataDictionary
44215>>>>>>>>>>>        End_Object    // Nomisma_DD2
44216>>>>>>>>>>>
44216>>>>>>>>>>>        Object Particle_DD2 is a Particle_DataDictionary
44218>>>>>>>>>>>            Set DDO_Server to (Clients_DD2(self))
44219>>>>>>>>>>>            Set DDO_Server to (Ptyppar_DD2(self))
44220>>>>>>>>>>>            Set DDO_Server to (Nomisma_DD2(self))
44221>>>>>>>>>>>        End_Object    // Particle_DD2
44222>>>>>>>>>>>
44222>>>>>>>>>>>
44222>>>>>>>>>>>        /////////////////////////////////////////////
44222>>>>>>>>>>>
44222>>>>>>>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
44224>>>>>>>>>>>        End_Object    // Ctypkin_DD
44225>>>>>>>>>>>
44225>>>>>>>>>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
44227>>>>>>>>>>>        End_Object    // Wtypkin_DD
44228>>>>>>>>>>>
44228>>>>>>>>>>>        Object Ptyppar_DD is a Ptyppar_DataDictionary
44230>>>>>>>>>>>            Set DDO_Server to (Ctypkin_DD(self))
44231>>>>>>>>>>>            Set DDO_Server to (Wtypkin_DD(self))
44232>>>>>>>>>>>        End_Object    // Ptyppar_DD
44233>>>>>>>>>>>
44233>>>>>>>>>>>        Object Country_DD is a Country_DataDictionary
44235>>>>>>>>>>>        End_Object    // Country_DD
44236>>>>>>>>>>>
44236>>>>>>>>>>>        Object Towns_DD is a Towns_DataDictionary
44238>>>>>>>>>>>            Set DDO_Server to (Country_DD(self))
44239>>>>>>>>>>>        End_Object    // Towns_DD
44240>>>>>>>>>>>
44240>>>>>>>>>>>        Object Cities_DD is a Cities_DataDictionary
44242>>>>>>>>>>>            Set DDO_Server to (Towns_DD(self))
44243>>>>>>>>>>>        End_Object    // Cities_DD
44244>>>>>>>>>>>
44244>>>>>>>>>>>        Object Areas_DD is a Areas_DataDictionary
44246>>>>>>>>>>>        End_Object    // Areas_DD
44247>>>>>>>>>>>
44247>>>>>>>>>>>        Object Payresp_DD is a Payresp_DataDictionary
44249>>>>>>>>>>>        End_Object    // Payresp_DD
44250>>>>>>>>>>>
44250>>>>>>>>>>>        Object Clients_DD is a Clients_DataDictionary
44252>>>>>>>>>>>            Set DDO_Server to (Cities_DD(self))
44253>>>>>>>>>>>            Set DDO_Server to (Areas_DD(self))
44254>>>>>>>>>>>            Set DDO_Server to (Payresp_DD(self))
44255>>>>>>>>>>>        End_Object    // Clients_DD
44256>>>>>>>>>>>
44256>>>>>>>>>>>        Object Nomisma_DD is a Nomisma_DataDictionary
44258>>>>>>>>>>>        End_Object    // Nomisma_DD
44259>>>>>>>>>>>
44259>>>>>>>>>>>        Object Particle_DD is a Particle_DataDictionary
44261>>>>>>>>>>>            Set DDO_Server to (Clients_DD(self))
44262>>>>>>>>>>>            Set DDO_Server to (Ptyppar_DD(self))
44263>>>>>>>>>>>            Set DDO_Server to (Nomisma_DD(self))
44264>>>>>>>>>>>        End_Object    // Particle_DD
44265>>>>>>>>>>>
44265>>>>>>>>>>>        Object Psxetika_DD is a Psxetika_DataDictionary
44267>>>>>>>>>>>            Set DDO_Server      to (Particle_DD(self))
44268>>>>>>>>>>>            Set Constrain_File  to Particle.File_Number
44269>>>>>>>>>>>        End_Object
44270>>>>>>>>>>>
44270>>>>>>>>>>>
44270>>>>>>>>>>>        //AB-StoreTopEnd
44270>>>>>>>>>>>
44270>>>>>>>>>>>        Set Size to 60 100
44271>>>>>>>>>>>
44271>>>>>>>>>>>        //AB-DDOStart
44271>>>>>>>>>>>
44271>>>>>>>>>>>
44271>>>>>>>>>>>        //AB-DDOEnd
44271>>>>>>>>>>>
44271>>>>>>>>>>>
44271>>>>>>>>>>>        //AB-StoreStart
44271>>>>>>>>>>>
44271>>>>>>>>>>>        Procedure Find_Sxetika_Data String asParentRecr
44273>>>>>>>>>>>            String  sClient_Desc sPtyppar_Desc sPseira_Seira
44274>>>>>>>>>>>            Date    dPartl_Hmnia
44274>>>>>>>>>>>            Integer iPartl_No
44274>>>>>>>>>>>
44274>>>>>>>>>>>            Send Clear          to Particle_DD2
44275>>>>>>>>>>>            Move asParentRecr   to Particle.Partl_Recr
44276>>>>>>>>>>>            Send Find           to Particle_DD2 Eq 2
44277>>>>>>>>>>>
44277>>>>>>>>>>>            Get Field_Current_Value Of Clients_DD2  Field Clients.Client_Name   to sClient_Desc
44278>>>>>>>>>>>            Get Field_Current_Value Of Ptyppar_DD2  Field Ptyppar.Ptyppar_Descr to sPtyppar_Desc
44279>>>>>>>>>>>            Get Field_Current_Value Of Particle_DD2 Field Particle.Pseira_Seira to sPseira_Seira
44280>>>>>>>>>>>            Get Field_Current_Value Of Particle_DD2 Field Particle.Partl_Hmnia  to dPartl_Hmnia
44281>>>>>>>>>>>            Get Field_Current_Value Of Particle_DD2 Field Particle.Partl_No     to iPartl_No
44282>>>>>>>>>>>
44282>>>>>>>>>>>            Set psPtyppar_Desc      to sPtyppar_Desc
44283>>>>>>>>>>>            Set psClient_Desc       to sClient_Desc
44284>>>>>>>>>>>            Set psSeira_Seira       to sPseira_Seira
44285>>>>>>>>>>>            Set pdPartl_Hmnia       to dPartl_Hmnia
44286>>>>>>>>>>>            Set piPartl_No          to iPartl_No
44287>>>>>>>>>>>        End_Procedure
44288>>>>>>>>>>>
44288>>>>>>>>>>>
44288>>>>>>>>>>>        Procedure Make_The_Record
44290>>>>>>>>>>>
44290>>>>>>>>>>>            Set psPtyppar_Desc      to ''
44291>>>>>>>>>>>            Set psClient_Desc       to ''
44292>>>>>>>>>>>            Set psSeira_Seira       to ''
44293>>>>>>>>>>>            Set pdPartl_Hmnia       to ''
44294>>>>>>>>>>>            Set piPartl_No          to 0
44295>>>>>>>>>>>
44295>>>>>>>>>>>            Clear Psxetika
44296>>>>>>>>>>>            Move (psParticleRecr0(Self)) to Psxetika.Partl_Recr
44297>>>>>>>>>>>            Move (psPsxetikaRecr0(Self)) to Psxetika.Psx_Partl_Recr
44298>>>>>>>>>>>            Find Eq Psxetika by index.4
44299>>>>>>>>>>>>
44299>>>>>>>>>>>
44299>>>>>>>>>>>            If (Not(Found)) Begin
44301>>>>>>>>>>>
44301>>>>>>>>>>>                Send Find_Sxetika_Data (psPsxetikaRecr0(Self))
44302>>>>>>>>>>>
44302>>>>>>>>>>>                Send Clear to Particle_DD
44303>>>>>>>>>>>                Send Clear to Psxetika_DD
44304>>>>>>>>>>>
44304>>>>>>>>>>>                // Vres ton mpampa
44304>>>>>>>>>>>                Move (psParticleRecr0(Self)) to Particle.Partl_Recr
44305>>>>>>>>>>>                Send Find to Particle_DD Eq 2
44306>>>>>>>>>>>
44306>>>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Psx_Partl_Recr    ;                                                to (psPsxetikaRecr0(Self))
44307>>>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Client_Desc    ;                                                to (psClient_Desc(Self))
44308>>>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Ptyppar_Desc   ;                                                to (psPtyppar_Desc(Self))
44309>>>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_Hmnia    ;                                                to (pdPartl_Hmnia(Self))
44310>>>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_No       ;                                                to (piPartl_No(Self))
44311>>>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.SX_Pseira_Seira   ;                                                to (psSeira_Seira(Self))
44312>>>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Pms_Sx_Qty        ;                                                to (pnPosothta(Self))
44313>>>>>>>>>>>
44313>>>>>>>>>>>                Send Request_Save               to Psxetika_DD
44314>>>>>>>>>>>
44314>>>>>>>>>>>
44314>>>>>>>>>>>                // Make also 2nd Record
44314>>>>>>>>>>>                Clear Psxetika
44315>>>>>>>>>>>                Move (psPsxetikaRecr0(Self)) to Psxetika.Partl_Recr
44316>>>>>>>>>>>                Move (psParticleRecr0(Self)) to Psxetika.Psx_Partl_Recr
44317>>>>>>>>>>>                Find Eq Psxetika by index.4
44318>>>>>>>>>>>>
44318>>>>>>>>>>>
44318>>>>>>>>>>>                If (Not(Found)) Begin
44320>>>>>>>>>>>
44320>>>>>>>>>>>                    Send Find_Sxetika_Data (psParticleRecr0(Self))
44321>>>>>>>>>>>
44321>>>>>>>>>>>                    Send Clear to Particle_DD
44322>>>>>>>>>>>                    Send Clear to Psxetika_DD
44323>>>>>>>>>>>
44323>>>>>>>>>>>                    Move (psPsxetikaRecr0(Self)) to Particle.Partl_Recr
44324>>>>>>>>>>>                    Send Find to Particle_DD Eq 2
44325>>>>>>>>>>>
44325>>>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Psx_Partl_Recr    ;                                                    to (psParticleRecr0(Self))
44326>>>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Client_Desc    ;                                                    to (psClient_Desc(Self))
44327>>>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Ptyppar_Desc   ;                                                    to (psPtyppar_Desc(Self))
44328>>>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_Hmnia    ;                                                    to (pdPartl_Hmnia(Self))
44329>>>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_No       ;                                                    to (piPartl_No(Self))
44330>>>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.SX_Pseira_Seira   ;                                                    to (psSeira_Seira(Self))
44331>>>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Pms_Sx_Qty        ;                                                    to (pnPosothta(Self))
44332>>>>>>>>>>>                    Send Request_Save               to Psxetika_DD
44333>>>>>>>>>>>                End
44333>>>>>>>>>>>>
44333>>>>>>>>>>>            End
44333>>>>>>>>>>>>
44333>>>>>>>>>>>        End_Procedure
44334>>>>>>>>>>>
44334>>>>>>>>>>>        //AB-StoreEnd
44334>>>>>>>>>>>
44334>>>>>>>>>>>    End_Object    // Psx_Array
44335>>>>>>>>>>>
44335>>>>>>>>>>>
44335>>>>>>>>>>>    //AB-StoreStart
44335>>>>>>>>>>>
44335>>>>>>>>>>>    //AB-StoreEnd
44335>>>>>>>>>>>
44335>>>>>>>>>>>//AB/     End_Object    // prj
44335>>>>>>>>>//Use bpMakeSx.dg
44335>>>>>>>>>
44335>>>>>>>>>Class PmsSxet_DataDictionary  is a DataDictionary_Sec
44336>>>>>>>>>
44336>>>>>>>>>    Procedure Construct_Object
44337>>>>>>>>>        Forward Send Construct_Object
44339>>>>>>>>>        Property Integer piFromCreate   Public 0
44340>>>>>>>>>    End_Procedure
44341>>>>>>>>>
44341>>>>>>>>>    Procedure Creating
44342>>>>>>>>>        Forward Send Creating
44344>>>>>>>>>        Set piFromCreate to 1
44345>>>>>>>>>    End_Procedure
44346>>>>>>>>>
44346>>>>>>>>>    Procedure Update
44347>>>>>>>>>        String  sRecr1 sRecr2 sPmsSxet
44348>>>>>>>>>        Number  nQty
44348>>>>>>>>>        Integer iLathos iCurrentPmoves iAkyro iCurrentPmsSxet iCurrentPartl
44348>>>>>>>>>
44348>>>>>>>>>        Forward Send Update
44350>>>>>>>>>
44350>>>>>>>>>        Move (Trim(Particle.Partl_LastNo)='1')  to iAkyro
44351>>>>>>>>>        Move Particle.Partl_Recr                to sRecr1
44352>>>>>>>>>        Move Pmoves.Recnum                      to iCurrentPmoves
44353>>>>>>>>>        Move PmsSxet.Recnum                     to iCurrentPmsSxet
44354>>>>>>>>>        Move PmsSxet.Arx_Partl_Recr             to sRecr2
44355>>>>>>>>>        Move PmsSxet.Posothta                   to nQty
44356>>>>>>>>>        Move Particle.Recnum                    to iCurrentPartl
44357>>>>>>>>>
44357>>>>>>>>>
44357>>>>>>>>>        If (piFromCreate(Self)<>1) Begin
44359>>>>>>>>>            Add nQty to Pmoves.Pms_Qty
44360>>>>>>>>>            Saverecord Pmoves
44361>>>>>>>>>
44361>>>>>>>>>            Set pnQty               Of bpEnYpol to nQty
44362>>>>>>>>>            Set psRecr              Of bpEnYpol to PmsSxet.Sxetiko_Recr
44363>>>>>>>>>            Set piFromAkyrosh       Of bpEnYpol to (iAkyro=1)
44364>>>>>>>>>            Set piCurrentPartl      Of bpEnYpol to iCurrentPartl
44365>>>>>>>>>            Set piCurrentPmoves     Of bpEnYpol to iCurrentPmoves
44366>>>>>>>>>            Set piCurrentPmsSxet    Of bpEnYpol to iCurrentPmsSxet
44367>>>>>>>>>            Send DoProcess          to bpEnYpol
44368>>>>>>>>>
44368>>>>>>>>>            Get piLathos            Of bpEnYpol to iLathos
44369>>>>>>>>>
44369>>>>>>>>>                 If (iLathos=40000) Error 8000 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
44372>>>>>>>>>            Else If (iLathos=40001) Error 8001 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
44376>>>>>>>>>            Else If (iLathos=40002) Error 8002 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
44380>>>>>>>>>            Else If (iLathos=40003) Error 8003 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
44384>>>>>>>>>            Else If (iLathos=40004) Error 8004 '’¦ §¨à«˜¨® ¡æ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
44388>>>>>>>>>            Else If (iLathos=40005) Error 8005 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
44392>>>>>>>>>            Else If (iLathos=40006) Error 8006 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
44396>>>>>>>>>
44396>>>>>>>>>        End
44396>>>>>>>>>>
44396>>>>>>>>>
44396>>>>>>>>>        // Epanafora posothtas giati afou trexei h backout me timh px 3 eno h update exei timh 4
44396>>>>>>>>>        // sthn epanatopothethsh ths bpenypol xanavriskei to current pmssxet record
44396>>>>>>>>>        // kai xanei thn posothta thn kainourgia opote epanerxetai me thn posothta ths
44396>>>>>>>>>        // backout pou einai 3.
44396>>>>>>>>>        Move nQty to PmsSxet.Posothta
44397>>>>>>>>>
44397>>>>>>>>>
44397>>>>>>>>>        Clear Psxetika
44398>>>>>>>>>        Move sRecr1 to Psxetika.Partl_Recr
44399>>>>>>>>>        Move sRecr2 to Psxetika.Psx_Partl_Recr
44400>>>>>>>>>        Find Eq Psxetika by index.4
44401>>>>>>>>>>
44401>>>>>>>>>        If (Found) Begin
44403>>>>>>>>>            Add nQty to Psxetika.Pms_Sx_Qty
44404>>>>>>>>>            Saverecord Psxetika
44405>>>>>>>>>        End
44405>>>>>>>>>>
44405>>>>>>>>>
44405>>>>>>>>>        Clear Psxetika
44406>>>>>>>>>        Move sRecr2 to Psxetika.Partl_Recr
44407>>>>>>>>>        Move sRecr1 to Psxetika.Psx_Partl_Recr
44408>>>>>>>>>        Find Eq Psxetika by index.4
44409>>>>>>>>>>
44409>>>>>>>>>        If (Found) Begin
44411>>>>>>>>>            Add nQty to Psxetika.Pms_Sx_Qty
44412>>>>>>>>>            Saverecord Psxetika
44413>>>>>>>>>        End
44413>>>>>>>>>>
44413>>>>>>>>>    End_Procedure
44414>>>>>>>>>
44414>>>>>>>>>    Procedure Backout
44415>>>>>>>>>        String  sRecr1 sRecr2 sPmsSxet
44416>>>>>>>>>        Number  nQty
44416>>>>>>>>>        Integer iLathos iCurrentPmoves iAkyro iCurrentPmsSxet iCurrentPartl
44416>>>>>>>>>
44416>>>>>>>>>        Move (Trim(Particle.Partl_LastNo)='1')  to iAkyro
44417>>>>>>>>>        Move Particle.Partl_Recr                to sRecr1
44418>>>>>>>>>        Move Pmoves.Recnum                      to iCurrentPmoves
44419>>>>>>>>>        Move PmsSxet.Recnum                     to iCurrentPmsSxet
44420>>>>>>>>>        Move PmsSxet.Arx_Partl_Recr             to sRecr2
44421>>>>>>>>>        Move PmsSxet.Posothta                   to nQty
44422>>>>>>>>>        Move Particle.Recnum                    to iCurrentPartl
44423>>>>>>>>>
44423>>>>>>>>>        Forward Send Backout
44425>>>>>>>>>
44425>>>>>>>>>        Set pnQty               Of bpEnYpol to (nQty*(-1))
44426>>>>>>>>>        Set psRecr              Of bpEnYpol to PmsSxet.Sxetiko_Recr
44427>>>>>>>>>        Set piFromAkyrosh       Of bpEnYpol to (iAkyro=1)
44428>>>>>>>>>        Set piCurrentPartl      Of bpEnYpol to iCurrentPartl
44429>>>>>>>>>        Set piCurrentPmoves     Of bpEnYpol to iCurrentPmoves
44430>>>>>>>>>        Set piCurrentPmsSxet    Of bpEnYpol to iCurrentPmsSxet
44431>>>>>>>>>        Send DoProcess          to bpEnYpol
44432>>>>>>>>>
44432>>>>>>>>>        Get piLathos            Of bpEnYpol to iLathos
44433>>>>>>>>>
44433>>>>>>>>>             If (iLathos=40000) Error 8000 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nBackout PmsSxet'
44436>>>>>>>>>        Else If (iLathos=40001) Error 8001 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nBackout PmsSxet'
44440>>>>>>>>>        Else If (iLathos=40002) Error 8002 'ƒœ¤ ™¨âŸž¡œ Particle\nBackout PmsSxet'
44444>>>>>>>>>        Else If (iLathos=40003) Error 8003 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nBackout PmsSxet'
44448>>>>>>>>>        Else If (iLathos=40004) Error 8004 '’¦ §¨à«˜¨® ¡æ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nBackout PmsSxet'
44452>>>>>>>>>        Else If (iLathos=40005) Error 8005 'ƒœ¤ ™¨âŸž¡œ Particle\nBackout PmsSxet'
44456>>>>>>>>>        Else If (iLathos=40006) Error 8006 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nBackout PmsSxet'
44460>>>>>>>>>
44460>>>>>>>>>        Clear Psxetika
44461>>>>>>>>>        Move sRecr1 to Psxetika.Partl_Recr
44462>>>>>>>>>        Move sRecr2 to Psxetika.Psx_Partl_Recr
44463>>>>>>>>>        Find Eq Psxetika by index.4
44464>>>>>>>>>>
44464>>>>>>>>>        If (Found) Begin
44466>>>>>>>>>            Sub nQty from Psxetika.Pms_Sx_Qty
44467>>>>>>>>>            Saverecord Psxetika
44468>>>>>>>>>        End
44468>>>>>>>>>>
44468>>>>>>>>>
44468>>>>>>>>>        Clear Psxetika
44469>>>>>>>>>        Move sRecr2 to Psxetika.Partl_Recr
44470>>>>>>>>>        Move sRecr1 to Psxetika.Psx_Partl_Recr
44471>>>>>>>>>        Find Eq Psxetika by index.4
44472>>>>>>>>>>
44472>>>>>>>>>        If (Found) Begin
44474>>>>>>>>>            Sub nQty from Psxetika.Pms_Sx_Qty
44475>>>>>>>>>            Saverecord Psxetika
44476>>>>>>>>>        End
44476>>>>>>>>>>
44476>>>>>>>>>    End_Procedure
44477>>>>>>>>>
44477>>>>>>>>>    Procedure Request_Save
44478>>>>>>>>>        Integer iInt iLathos iMustDelete iCurrentPmoves iAkyro iCurrentPmsSxet iCurrentPartl
44479>>>>>>>>>        String  sParticleRecr sPmsSxetRecr sPmovesRecr sArxPartlRecr sRecr1 sRecr2 sPmsSxet
44479>>>>>>>>>        Number  nQty
44479>>>>>>>>>
44479>>>>>>>>>        Set piFromCreate to 0
44480>>>>>>>>>
44480>>>>>>>>>        Forward Send Request_Save
44482>>>>>>>>>
44482>>>>>>>>>        If (piFromCreate(Self)=1) Begin
44484>>>>>>>>>            Set piFromCreate                                                to 0
44485>>>>>>>>>
44485>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Recnum         to iCurrentPartl
44486>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_Recr     to sParticleRecr
44487>>>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Pms_Recr         to sPmovesRecr
44488>>>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Recnum           to iCurrentPmoves
44489>>>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Recnum          to iCurrentPmsSxet
44490>>>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Sxetiko_Recr    to sPmsSxetRecr
44491>>>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Arx_Partl_Recr  to sArxPartlRecr
44492>>>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Posothta        to nQty
44493>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_LastNo   to iAkyro
44494>>>>>>>>>            Move (iAkyro=1)                                                 to iAkyro
44495>>>>>>>>>
44495>>>>>>>>>            Set pnQty               Of bpEnYpol to nQty
44496>>>>>>>>>            Set psRecr              Of bpEnYpol to sPmsSxetRecr
44497>>>>>>>>>            Set piFromAkyrosh       Of bpEnYpol to (iAkyro=1)
44498>>>>>>>>>            Set piCurrentPartl      Of bpEnYpol to iCurrentPartl
44499>>>>>>>>>            Set piCurrentPmoves     Of bpEnYpol to iCurrentPmoves
44500>>>>>>>>>            Set piCurrentPmsSxet    Of bpEnYpol to iCurrentPmsSxet
44501>>>>>>>>>            Send DoProcess          to bpEnYpol
44502>>>>>>>>>            Get piLathos            Of bpEnYpol to iLathos
44503>>>>>>>>>
44503>>>>>>>>>                 If (iLathos=40000) Error 8000 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
44506>>>>>>>>>            Else If (iLathos=40001) Error 8001 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
44510>>>>>>>>>            Else If (iLathos=40002) Error 8002 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
44514>>>>>>>>>            Else If (iLathos=40003) Error 8003 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
44518>>>>>>>>>            Else If (iLathos=40004) Error 8004 '’¦ §¨à«˜¨® ¡æ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
44522>>>>>>>>>            Else If (iLathos=40005) Error 8005 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
44526>>>>>>>>>            Else If (iLathos=40006) Error 8006 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
44530>>>>>>>>>
44530>>>>>>>>>            Set psParticleRecr0     Of Psx_Array to sParticleRecr
44531>>>>>>>>>            Set psPsxetikaRecr0     Of Psx_Array to sArxPartlRecr
44532>>>>>>>>>            Set pnPosothta          Of Psx_Array to nQty
44533>>>>>>>>>            Send Make_The_Record    Of Psx_Array
44534>>>>>>>>>
44534>>>>>>>>>            // Xana vres tis eggrafes
44534>>>>>>>>>            Clear Particle
44535>>>>>>>>>            Move sParticleRecr  to Particle.Partl_Recr
44536>>>>>>>>>            Find Eq Particle by index.2
44537>>>>>>>>>>
44537>>>>>>>>>
44537>>>>>>>>>            Clear Pmoves
44538>>>>>>>>>            Move sPmovesRecr    to Pmoves.Pms_Recr
44539>>>>>>>>>            Find Eq Pmoves by index.2
44540>>>>>>>>>>
44540>>>>>>>>>
44540>>>>>>>>>            Clear PmsSxet
44541>>>>>>>>>            Move sPmovesRecr    to PmsSxet.Pms_Recr
44542>>>>>>>>>            Move sPmsSxetRecr   to PmsSxet.Sxetiko_Recr
44543>>>>>>>>>            Find Eq PmsSxet by Index.1
44544>>>>>>>>>>
44544>>>>>>>>>
44544>>>>>>>>>        End
44544>>>>>>>>>>
44544>>>>>>>>>    End_Procedure
44545>>>>>>>>>
44545>>>>>>>>>
44545>>>>>>>>>    Procedure Define_Fields
44546>>>>>>>>>        Forward Send Define_Fields
44548>>>>>>>>>        //DDB-Generated-Code-Location
44548>>>>>>>>>        //DDB-DefineFieldStart
44548>>>>>>>>>
44548>>>>>>>>>        Set Main_File            To Pmssxet.File_Number
44549>>>>>>>>>
44549>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
44550>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
44551>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
44552>>>>>>>>>
44552>>>>>>>>>        // Parent (Server) file structure...............
44552>>>>>>>>>        Send Add_Server_File  Pmoves.File_Number
44553>>>>>>>>>
44553>>>>>>>>>        // External (System) file structure.............
44553>>>>>>>>>        Send Add_System_File  Psxetika.File_Number  DD_LOCK_ON_ALL
44554>>>>>>>>>        Send Add_System_File  Pmoves.File_Number  DD_LOCK_ON_ALL
44555>>>>>>>>>
44555>>>>>>>>>        // Field-based properties.......................
44555>>>>>>>>>
44555>>>>>>>>>        // Pmssxet.Pms_Recr
44555>>>>>>>>>
44555>>>>>>>>>        // Pmssxet.Sxetiko_Recr
44555>>>>>>>>>
44555>>>>>>>>>        // Pmssxet.Posothta
44555>>>>>>>>>
44555>>>>>>>>>        // Pmssxet.Arx_Partl_Recr
44555>>>>>>>>>
44555>>>>>>>>>        // Pmssxet.Sx_Parast
44555>>>>>>>>>
44555>>>>>>>>>        // Pmssxet.Sx_Hmnia
44555>>>>>>>>>
44555>>>>>>>>>        // Pmssxet.Sx_Foreas
44555>>>>>>>>>
44555>>>>>>>>>        // Pmssxet.Sx_Arithmos
44555>>>>>>>>>
44555>>>>>>>>>        // Pmssxet.Sx_Seira
44555>>>>>>>>>
44555>>>>>>>>>        // Pmssxet.Sx_Posothta
44555>>>>>>>>>
44555>>>>>>>>>        //DDB-DefineFieldEnd
44555>>>>>>>>>    End_Procedure    // Define_Fields
44556>>>>>>>>>
44556>>>>>>>>>    Procedure Field_Defaults
44557>>>>>>>>>        Forward Send Field_Defaults
44559>>>>>>>>>        //DDB-Generated-Code-Location
44559>>>>>>>>>        //DDB-FieldDefaultStart
44559>>>>>>>>>        //DDB-FieldDefaultEnd
44559>>>>>>>>>    End_Procedure    // Field_Defaults
44560>>>>>>>>>
44560>>>>>>>>>End_Class    // Pmssxet_DataDictionary
44561>>>>>>>>>//DDB-FileEnd
44561>>>>>>>
44561>>>>>>>Class Cmoves_DataDictionary  is a DataDictionary
44562>>>>>>>
44562>>>>>>>    Procedure Construct_Object
44563>>>>>>>        Forward Send Construct_Object
44565>>>>>>>        Property Integer piFromBP           Public 0
44566>>>>>>>        Property Integer piNotMoveSyscurXr  Public 0   
44567>>>>>>>        Property Integer piFromxrhsh        Public 0  //œ¤›œ ¥ž ¦«  œ¨®œ«˜  ˜§¦ £œ«˜­¦¨á ¬§¦¢¦å§à¤
44568>>>>>>>    End_Procedure
44569>>>>>>>
44569>>>>>>>    Function Validate_Save  Returns Integer
44570>>>>>>>        Integer iReturnVal iOpen_Items iCheck ifromxrhsh iYes
44571>>>>>>>        String sModule
44571>>>>>>>        get pifromxrhsh to ifromxrhsh
44572>>>>>>>        Forward Get Validate_Save  To iReturnVal
44574>>>>>>>        If (Not(iReturnVal)) Begin
44576>>>>>>>            
44576>>>>>>>            Clear Branch
44577>>>>>>>            Move SyscurXr.Company_Code  to Branch.Company_Code
44578>>>>>>>            Move SyscurXr.Branch_Code   to Branch.Branch_Code
44579>>>>>>>            Find Eq Branch By Index.1
44580>>>>>>>>
44580>>>>>>>            If (Not(Found)) Move 6666 to iReturnVal
44583>>>>>>>            Else If ((Branch.Locked_Until<>'') And (Cmoves.Cmoves_Hmnia<=Branch.Locked_Until)) Move 6667 to iReturnVal
44587>>>>>>>            
44587>>>>>>>            If (Cmoves.Axia_Ypol_Sysx<0) Begin
44589>>>>>>>                Move 10101 to iReturnVal
44590>>>>>>>            End
44590>>>>>>>>
44590>>>>>>>            Else Begin
44591>>>>>>>                
44591>>>>>>>                Move Ctypkin.Check_Overhead to iCheck
44592>>>>>>>                If (iCheck) Begin
44594>>>>>>>                    If ((Clients.Plafon>0) And (Clients.Overhead<0) And (Sysfile.Over_Overhead<>'1')) Begin
44596>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 3000 Cmoves' to iYes
44597>>>>>>>                        If (iYes=MBR_NO) Move 11170 to iReturnVal
44600>>>>>>>                    End
44600>>>>>>>>
44600>>>>>>>                    Else If ((PayResp.Plafon>0) And (PayResp.Overhead<0) And (Sysfile.Over_Overhead<>'1')) Begin
44603>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 3001 Cmoves' to iYes
44604>>>>>>>                        If (iYes=MBR_NO) Move 11171 to iReturnVal
44607>>>>>>>                    End
44607>>>>>>>>
44607>>>>>>>                End
44607>>>>>>>>
44607>>>>>>>                
44607>>>>>>>                If (iReturnVal) Send Operation_Not_Allowed iReturnVal
44610>>>>>>>                
44610>>>>>>>                If ((Cmoves.Prn_Theor='1') And (piFromBP(Self)<>1)) Move 22278 to iReturnVal
44613>>>>>>>                Else If ((Clients.Client_Locked='1') And (piFromBP(Self)<>1)) Move 11172 to iReturnVal
44617>>>>>>>                
44617>>>>>>>                // ˜¤ œ¨®œ«˜  ˜§¦ £œ«˜­¦¨á ¬§¦¢¦å§à¤ £ž¤ «¦¤ ¡¦™œ ª
44617>>>>>>>                Else If ((Cmoves.Cmoves_Hmnia<syscurxr.Year_Xrhshfrom and ifromxrhsh<>1) Or ;                         (Cmoves.Cmoves_Hmnia>Syscurxr.Year_Xrhshto and ifromxrhsh<>1)) Move 22277 to iReturnVal
44621>>>>>>>                Else Begin
44622>>>>>>>                    If (Cmoves.Module_From='') Move 22250 to iReturnVal
44625>>>>>>>                    Else Begin
44626>>>>>>>                        If (piFromBP(Self)<>1) Begin // €¤ ›œ¤ §¨¦œ¨®œ«˜  ˜§¦ « ª 2 Business Process
44628>>>>>>>                            If (Cmoves.Module_From<>gs_Module_Code) Move 22288 to iReturnVal
44631>>>>>>>                            Else If (Cmoves.Recnum<>0) Begin // €¤ ›œ¤ ¡˜¤œ  create ¤œ˜ œšš¨˜­ž
44634>>>>>>>                                If (Cmoves.Barticl_Recr<>'') Move 22284 to iReturnVal
44637>>>>>>>                                Else If (Cmoves.Partl_Recr  <>'') Begin
44640>>>>>>>                                    If (Cmoves.Module_From='01') Move 22283 to iReturnVal
44643>>>>>>>                                    Else If (Cmoves.Module_From='02') Move 22282 to iReturnVal
44647>>>>>>>                                End
44647>>>>>>>>
44647>>>>>>>                            End
44647>>>>>>>>
44647>>>>>>>                        End
44647>>>>>>>>
44647>>>>>>>                    End
44647>>>>>>>>
44647>>>>>>>                End
44647>>>>>>>>
44647>>>>>>>            End
44647>>>>>>>>
44647>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
44650>>>>>>>        End
44650>>>>>>>>
44650>>>>>>>        Function_Return iReturnVal
44651>>>>>>>    End_Function   // Validate_Save
44652>>>>>>>
44652>>>>>>>    Function Validate_Delete  Returns Integer
44653>>>>>>>        Integer iReturnVal
44654>>>>>>>        String sModule
44654>>>>>>>        Forward Get Validate_Delete  To iReturnVal
44656>>>>>>>        If (Not(iReturnVal)) Begin
44658>>>>>>>
44658>>>>>>>            Clear Branch
44659>>>>>>>            Move SyscurXr.Company_Code  to Branch.Company_Code
44660>>>>>>>            Move SyscurXr.Branch_Code   to Branch.Branch_Code
44661>>>>>>>            Find Eq Branch By Index.1
44662>>>>>>>>
44662>>>>>>>            If (Not(Found)) Move 6668 to iReturnVal
44665>>>>>>>            Else If ((Branch.Locked_Until<>'') And (Cmoves.Cmoves_Hmnia<=Branch.Locked_Until)) Move 6669 to iReturnVal
44669>>>>>>>            
44669>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
44672>>>>>>>            
44672>>>>>>>            If (Cmoves.Prn_Theor='1') Move 22279 to iReturnVal
44675>>>>>>>            Else If (piFromBP(Self)<>1) Begin
44678>>>>>>>                If (Cmoves.Module_From<>gs_Module_Code) Move 22289 to iReturnVal
44681>>>>>>>                Else Begin
44682>>>>>>>                    If (Cmoves.Barticl_Recr<>'') Move 22287 to iReturnVal
44685>>>>>>>                    Else If (Cmoves.Partl_Recr  <>'') Begin
44688>>>>>>>                        If (Cmoves.Module_From='01') Move 22286 to iReturnVal
44691>>>>>>>                        Else If (Cmoves.Module_From='02') Move 22285 to iReturnVal
44695>>>>>>>                    End
44695>>>>>>>>
44695>>>>>>>                End
44695>>>>>>>>
44695>>>>>>>            End
44695>>>>>>>>
44695>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
44698>>>>>>>        End
44698>>>>>>>>
44698>>>>>>>        Function_Return iReturnVal
44699>>>>>>>    End_Function   // Validate_Delete
44700>>>>>>>
44700>>>>>>>    Procedure Save_Main_File
44701>>>>>>>        If (Operation_Origin<>Self) Begin
44703>>>>>>>            If Cmoves.Recnum Eq 0 Procedure_Return
44706>>>>>>>        End
44706>>>>>>>>
44706>>>>>>>        If (Cmoves.Cn_Code<>'') Begin
44708>>>>>>>            Clear Cn
44709>>>>>>>            Move Cmoves.Cn_Code to Cn.Cn_Code
44710>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
44711>>>>>>>>
44711>>>>>>>            Move Cn.Cn_Sls_ID      to Cmoves.Sls_ID
44712>>>>>>>            Move cn.Mhxanik_id     to Cmoves.Mhxanik_Id
44713>>>>>>>            Move Cn.CN_Cnt_ID      to Cmoves.Cnt_ID
44714>>>>>>>            Move Cn.Cn_Recr        to Cmoves.Cn_Recr
44715>>>>>>>        End
44715>>>>>>>>
44715>>>>>>>        Else Begin
44716>>>>>>>            Move ''     to Cmoves.Sls_ID
44717>>>>>>>            Move ''     to Cmoves.Cnt_ID
44718>>>>>>>            Move ''     to Cmoves.Cn_Recr
44719>>>>>>>            Move ''     to Cmoves.Mhxanik_id
44720>>>>>>>        End
44720>>>>>>>>
44720>>>>>>>        Forward Send Save_Main_File
44722>>>>>>>    End_Procedure   // Save_Main_File
44723>>>>>>>
44723>>>>>>>
44723>>>>>>>    Procedure Update
44724>>>>>>>        String sNomisma
44725>>>>>>>        Forward Send Update
44727>>>>>>>        
44727>>>>>>>        If (piNotMoveSyscurXr(Self)=0) Begin
44729>>>>>>>            Move SysCurXR.Company_Code      to Cmoves.Company_Code
44730>>>>>>>            Move SysCurXR.Branch_Code       to Cmoves.Branch_Code
44731>>>>>>>        End
44731>>>>>>>>
44731>>>>>>>        
44731>>>>>>>        //˜¤ šå¤œ«˜  £œ«˜­¦¨á ¬§¦¢¦å§à¤
44731>>>>>>>        if (pifromxrhsh(self)=1)    Move (SysCurXR.Year_Year+1) to Cmoves.Year_Year
44734>>>>>>>        else                        Move SysCurXR.Year_Year     to Cmoves.Year_Year
44736>>>>>>>        
44736>>>>>>>        //Move Custprom.Custprom_Code to Cmoves.Custprom_Code
44736>>>>>>>        Move Clients.Client_ID          to Cmoves.Client_ID
44737>>>>>>>        Move Clients.Client_Name        to Cmoves.Client_Name
44738>>>>>>>        Move Ctypkin.Ctypkin_Descr      to Cmoves.Ctypkin_Descr
44739>>>>>>>
44739>>>>>>>        // js 28/03/2002 Gia na mhn allazei sta Copen me to Ctypkin tou CmovesA
44739>>>>>>>        If (Cmoves.Ctypkin_Code='') ;            Move Ctypkin.Ctypkin_Code   to Cmoves.Ctypkin_Code
44742>>>>>>>
44742>>>>>>>
44742>>>>>>>        Move payresp.presp_ID           to Cmoves.Presp_ID
44743>>>>>>>
44743>>>>>>>        ///an enhmeronei synolikh ofeilh pelath
44743>>>>>>>        if (Cmoves.enhm_ofeilh='1') begin
44745>>>>>>>            Add (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) to Clients.Synolikh_ofeilh
44746>>>>>>>            Add (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) to Payresp.Synolikh_ofeilh
44747>>>>>>>        end
44747>>>>>>>>
44747>>>>>>>
44747>>>>>>>        If (Cmoves.Enhm_Ypol_Pel='1') Begin
44749>>>>>>>            If (Cmoves.Cmoves_x0<>0) Begin
44751>>>>>>>                Add Cmoves.Cmoves_x0 to Clients.Xreosh
44752>>>>>>>                Add Cmoves.Cmoves_x0 to PayResp.Xreosh
44753>>>>>>>            End
44753>>>>>>>>
44753>>>>>>>            Else If (Cmoves.Cmoves_p0<>0) Begin
44756>>>>>>>                Add Cmoves.Cmoves_p0 to Clients.Pistosh
44757>>>>>>>                Add Cmoves.Cmoves_p0 to PayResp.Pistosh
44758>>>>>>>            End
44758>>>>>>>>
44758>>>>>>>        End
44758>>>>>>>>
44758>>>>>>>        If (Cmoves.Enhm_Hmnies_Pel='1') Begin
44760>>>>>>>            If (Cmoves.Cmoves_x0<>0) Begin
44762>>>>>>>                Move Cmoves.Cmoves_Hmnia   to Clients.Last_Xreosh
44763>>>>>>>                Move Cmoves.Cmoves_Hmnia   to PayResp.Last_Xreosh
44764>>>>>>>            End
44764>>>>>>>>
44764>>>>>>>            Else If (Cmoves.Cmoves_p0<>0) Begin
44767>>>>>>>                Move Cmoves.Cmoves_Hmnia   to Clients.Last_Pistosh
44768>>>>>>>                Move Cmoves.Cmoves_Hmnia   to PayResp.Last_Pistosh
44769>>>>>>>            End
44769>>>>>>>>
44769>>>>>>>        End
44769>>>>>>>>
44769>>>>>>>
44769>>>>>>>             If ((Cmoves.Cmoves_M_Code='') And (Cmoves.Module_From  <>'')) Move Cmoves.Module_From     to Cmoves.Cmoves_M_Code
44772>>>>>>>        Else If ((Cmoves.Module_From  ='') And (Cmoves.Cmoves_M_Code<>'')) Move Cmoves.Cmoves_M_Code   to Cmoves.Module_From
44776>>>>>>>
44776>>>>>>>        If (Ctypkin.Open_Item='1') Move (Cmoves.Axia_Pros_Sysx-Cmoves.Axia_Sysxet) to Cmoves.Axia_Ypol_Sysx
44779>>>>>>>        Else Begin
44780>>>>>>>            Move 0 to Cmoves.Axia_Pros_Sysx
44781>>>>>>>            Move 0 to Cmoves.Axia_Sysxet
44782>>>>>>>            Move 0 to Cmoves.Axia_Ypol_Sysx
44783>>>>>>>        End
44783>>>>>>>>
44783>>>>>>>
44783>>>>>>>        // js 23/01/2002
44783>>>>>>>        // Enhmerosh Pediou Flag_Ypol to opoio antiprosopeyei
44783>>>>>>>        // to an h eggrafh exei diathesimo ypoloipo pros sysxetish
44783>>>>>>>        Move (Cmoves.Axia_Ypol_Sysx<>0) to Cmoves.Flag_Ypol
44784>>>>>>>
44784>>>>>>>        // js 23/01/2002
44784>>>>>>>        // Enhmerosh Pediou Flag_Open to opoio antiprosopeyei
44784>>>>>>>        // an einai xreosh=1, pistosh=2, arnhtikh xreosh=2 arnhtikh Pistosh=1
44784>>>>>>>        // gia na emfanizei ta antistrofa sto copen
44784>>>>>>>        If (Ctypkin.Open_Item='1') Begin
44786>>>>>>>            If ((Cmoves.Cmoves_X0<>0) And ((Cmoves.Cmoves_P0=0))) Begin
44788>>>>>>>                Move 1                          to Cmoves.Flag_Copen
44789>>>>>>>                If (Cmoves.Cmoves_X0<0) Move 2  to Cmoves.Flag_Copen
44792>>>>>>>            End
44792>>>>>>>>
44792>>>>>>>            Else If ((Cmoves.Cmoves_P0<>0) And ((Cmoves.Cmoves_X0=0))) Begin
44795>>>>>>>                Move 2                          to Cmoves.Flag_Copen
44796>>>>>>>                If (Cmoves.Cmoves_P0<0) Move 1  to Cmoves.Flag_Copen
44799>>>>>>>            End
44799>>>>>>>>
44799>>>>>>>            Else Move 0 to Cmoves.Flag_Copen
44801>>>>>>>        End
44801>>>>>>>>
44801>>>>>>>        Else Move 0 to Cmoves.Flag_Copen
44803>>>>>>>    End_Procedure   // Update
44804>>>>>>>
44804>>>>>>>    Procedure Backout
44805>>>>>>>        Forward Send Backout
44807>>>>>>>
44807>>>>>>>        if (Cmoves.enhm_ofeilh='1') begin
44809>>>>>>>            sub (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) from Clients.Synolikh_ofeilh
44810>>>>>>>            sub (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) from Payresp.Synolikh_ofeilh
44811>>>>>>>        end
44811>>>>>>>>
44811>>>>>>>
44811>>>>>>>//        if (Cmoves.enhm_ofeilh='2') begin
44811>>>>>>>//            sub ((Cmoves.Cmoves_x0-Cmoves.cmoves_p0)*-1) from Clients.Synolikh_ofeilh
44811>>>>>>>//            sub ((Cmoves.Cmoves_x0-Cmoves.cmoves_p0)*-1) from Payresp.Synolikh_ofeilh
44811>>>>>>>//        end
44811>>>>>>>
44811>>>>>>>        If (Cmoves.Enhm_Ypol_Pel='1') Begin
44813>>>>>>>            If (Cmoves.Cmoves_x0<>0) Begin
44815>>>>>>>                Sub Cmoves.Cmoves_x0 From Clients.Xreosh
44816>>>>>>>                Sub Cmoves.Cmoves_x0 From PayResp.Xreosh
44817>>>>>>>            End
44817>>>>>>>>
44817>>>>>>>            Else If (Cmoves.Cmoves_p0<>0) Begin
44820>>>>>>>                Sub Cmoves.Cmoves_p0 From Clients.Pistosh
44821>>>>>>>                Sub Cmoves.Cmoves_p0 From PayResp.Pistosh
44822>>>>>>>            End
44822>>>>>>>>
44822>>>>>>>        End
44822>>>>>>>>
44822>>>>>>>    End_Procedure
44823>>>>>>>
44823>>>>>>>    Procedure Creating
44824>>>>>>>        Forward Send Creating
44826>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Cmoves.Cmoves_Rec0)))))) to Cmoves.Cmoves_Recr
44827>>>>>>>
44827>>>>>>>        //If ((Cmoves.Module_From='' ) Or (piFromBP(Self)<>1)) Move gs_Module_Code to Cmoves.Module_From
44827>>>>>>>
44827>>>>>>>        If (Ctypkin.Open_Item ='1') Begin
44829>>>>>>>                 If (Cmoves.Cmoves_x0<>0) Move (Abs(Cmoves.Cmoves_x0)) to Cmoves.Axia_Pros_Sysx
44832>>>>>>>            Else If (Cmoves.Cmoves_p0<>0) Move (Abs(Cmoves.Cmoves_p0)) to Cmoves.Axia_Pros_Sysx
44836>>>>>>>        End
44836>>>>>>>>
44836>>>>>>>    End_Procedure   // Creating
44837>>>>>>>
44837>>>>>>>
44837>>>>>>>
44837>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
44838>>>>>>>        String lsError_Message
44839>>>>>>>
44839>>>>>>>        Case Begin
44839>>>>>>>
44839>>>>>>>            Case (iError_Num = 6666)
44841>>>>>>>                Move "DDC 006: ‘­á¢£˜ 6666 €›ç¤˜«ž ž œšš¨˜­ž!\nƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ ¬§¦¡˜«˜©«ž£á«à¤" to lsError_Message
44842>>>>>>>            Case Break
44843>>>>>>>
44843>>>>>>>            Case (iError_Num = 6667)
44846>>>>>>>                Move "DDC 006: ‘­á¢£˜ 6667 €›ç¤˜«ž ž œšš¨˜­ž!\n†£/¤å˜ ¡å¤ž©žª §¨¦šœ¤â©«œ¨ž ž£/¤å˜ª ¡¢œ ›é£˜«¦ª" to lsError_Message
44847>>>>>>>            Case Break
44848>>>>>>>
44848>>>>>>>            Case (iError_Num = 6668)
44851>>>>>>>                Move "DDC 006: ‘­á¢£˜ 6668 €›ç¤˜«ž ž › ˜š¨˜­ã!\nƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ ¬§¦¡˜«˜©«ž£á«à¤" to lsError_Message
44852>>>>>>>            Case Break
44853>>>>>>>
44853>>>>>>>            Case (iError_Num = 6669)
44856>>>>>>>                Move "DDC 006: ‘­á¢£˜ 6669 €›ç¤˜«ž ž › ˜š¨˜­ã!\n†£/¤å˜ ¡å¤ž©žª §¨¦šœ¤â©«œ¨ž ž£/¤å˜ª ¡¢œ ›é£˜«¦ª" to lsError_Message
44857>>>>>>>            Case Break
44858>>>>>>>
44858>>>>>>>            Case (iError_Num = 22277)
44861>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n†£œ¨¦£ž¤åœª œ¡«æª ¦¨åà¤ ®¨ã©žª" to lsError_Message
44862>>>>>>>            Case Break
44863>>>>>>>
44863>>>>>>>            Case (iError_Num = 22278)
44866>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ã!\n\„®œ  «¬§àŸœ  Ÿœà¨ž£â¤¦" to lsError_Message
44867>>>>>>>            Case Break
44868>>>>>>>
44868>>>>>>>            Case (iError_Num = 22279)
44871>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\„®œ  «¬§àŸœ  Ÿœà¨ž£â¤¦" to lsError_Message
44872>>>>>>>            Case Break
44873>>>>>>>
44873>>>>>>>            Case (iError_Num = 11170)
44876>>>>>>>                Move "DDC 006:’¦ § ©«à« ¡æ æ¨ ¦ «¦¬ ­¦¨â˜ â®œ  œ¥˜¤«¢žŸœå" to lsError_Message
44877>>>>>>>            Case Break
44878>>>>>>>
44878>>>>>>>            Case (iError_Num = 11171)
44881>>>>>>>                Move "DDC 006:’¦ § ©«à« ¡æ æ¨ ¦ «¦¬ “§. ¢ž¨à£é¤ â®œ  œ¥˜¤«¢žŸœå" to lsError_Message
44882>>>>>>>            Case Break
44883>>>>>>>
44883>>>>>>>            Case (iError_Num = 11172)
44886>>>>>>>                Move "DDC 006:Ž ­¦¨â˜ª œå¤˜  ¡¢œ ›à£â¤¦ª ¢æšà § ©«à« ¡¦ç ¦¨å¦¬" to lsError_Message
44887>>>>>>>            Case Break
44888>>>>>>>
44888>>>>>>>            Case (iError_Num = 22288)
44891>>>>>>>                Clear Codemast
44892>>>>>>>                Move "MODULE" to Codemast.Type
44893>>>>>>>                Move Cmoves.Module_From to Codemast.Code
44894>>>>>>>                Find Eq Codemast by Index.1 //type+code
44895>>>>>>>>
44895>>>>>>>                Move ("DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n(† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ "+;                (Trim(Codemast.Description))+" )") to lsError_Message
44896>>>>>>>            Case Break
44897>>>>>>>
44897>>>>>>>            Case (iError_Num = 22250)
44900>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n’¦ ¡ç¡¢à£˜ (Module) «žª œšš¨˜­ãª œå¤˜  ¡œ¤æ" to lsError_Message
44901>>>>>>>            Case Break
44902>>>>>>>
44902>>>>>>>            Case (iError_Num = 22284)
44905>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ «˜ €¥ æš¨˜­˜" to lsError_Message
44906>>>>>>>            Case Break
44907>>>>>>>            Case (iError_Num = 22283)
44910>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ « ª à¢ã©œ ª" to lsError_Message
44911>>>>>>>            Case Break
44912>>>>>>>            Case (iError_Num = 22282)
44915>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ « ª €š¦¨âª" to lsError_Message
44916>>>>>>>            Case Break
44917>>>>>>>
44917>>>>>>>            //˜§æ validate delete
44917>>>>>>>            Case (iError_Num = 22289)
44920>>>>>>>                Clear Codemast
44921>>>>>>>                Move "MODULE" to Codemast.Type
44922>>>>>>>                Move Cmoves.Module_From to Codemast.Code
44923>>>>>>>                Find Eq Codemast by Index.1 //type+code
44924>>>>>>>>
44924>>>>>>>                Move ("DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n(† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ "+;                (Trim(Codemast.Description))+" )") to lsError_Message
44925>>>>>>>            Case Break
44926>>>>>>>
44926>>>>>>>            Case (iError_Num = 22287)
44929>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ «˜ €¥ æš¨˜­˜" to lsError_Message
44930>>>>>>>            Case Break
44931>>>>>>>            Case (iError_Num = 22286)
44934>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ « ª à¢ã©œ ª" to lsError_Message
44935>>>>>>>            Case Break
44936>>>>>>>            Case (iError_Num = 22285)
44939>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ « ª €š¦¨âª" to lsError_Message
44940>>>>>>>            Case Break
44941>>>>>>>
44941>>>>>>>            //â¢œš®¦  open items
44941>>>>>>>            Case (iError_Num = 10101)
44944>>>>>>>                Move ("DDC 006:€¡˜«á¢¢ž¢ž „šš¨˜­ã.\n\n"+;                "’¦ ©¬©®œ« ©£â¤¦ §¦©æ œå¤˜  £œš˜¢ç«œ¨¦\n˜§¦ «¦ ˜¨® ¡á › ˜Ÿâ© £¦ §¨¦ª ©¬©®â« ©ž");                to lsError_Message
44945>>>>>>>            Case Break
44946>>>>>>>
44946>>>>>>>            Case Else
44946>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
44948>>>>>>>        Case End
44948>>>>>>>
44948>>>>>>>        Error iError_Num lsError_Message
44949>>>>>>>>
44949>>>>>>>    End_Procedure // operation_not_allowed
44950>>>>>>>
44950>>>>>>>
44950>>>>>>>    // Define_Fields:
44950>>>>>>>    // This procedure is used to set up all data-dictionary rules.
44950>>>>>>>
44950>>>>>>>    Procedure Define_Fields
44951>>>>>>>        Forward Send Define_Fields
44953>>>>>>>        //DDB-Generated-Code-Location
44953>>>>>>>        //DDB-DefineFieldStart
44953>>>>>>>
44953>>>>>>>        Set Main_File            To Cmoves.File_Number
44954>>>>>>>        Set Cascade_Delete_State To FALSE
44955>>>>>>>
44955>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
44956>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
44957>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
44958>>>>>>>
44958>>>>>>>        // Child (Client) file structure................
44958>>>>>>>        Send Add_Client_File  Copen.File_Number
44959>>>>>>>
44959>>>>>>>        // Parent (Server) file structure...............
44959>>>>>>>        Send Add_Server_File  Ctypkin.File_Number
44960>>>>>>>        Send Add_Server_File  Clients.File_Number
44961>>>>>>>
44961>>>>>>>        // External (System) file structure.............
44961>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_NEW_SAVE_DELETE
44962>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
44963>>>>>>>
44963>>>>>>>        Define_Auto_Increment  Sysrecc.Cmoves_Rec0  To Cmoves.Cmoves_Rec0
44966>>>>>>>
44966>>>>>>>        // Field-based properties.......................
44966>>>>>>>
44966>>>>>>>        // Cmoves.Company_Code
44966>>>>>>>
44966>>>>>>>        // Cmoves.Branch_Code
44966>>>>>>>
44966>>>>>>>        // Cmoves.Year_Year
44966>>>>>>>
44966>>>>>>>        // Cmoves.Custprom_Code
44966>>>>>>>
44966>>>>>>>        // Cmoves.Client_Id
44966>>>>>>>
44966>>>>>>>        // Cmoves.Ctypkin_Code
44966>>>>>>>
44966>>>>>>>        // Cmoves.Cmoves_Recr
44966>>>>>>>
44966>>>>>>>        // Cmoves.Cmoves_Rec0
44966>>>>>>>        Set Field_Options          Field Cmoves.Cmoves_Rec0 To DD_AUTOFIND   
44967>>>>>>>
44967>>>>>>>        // Cmoves.Cmoves_Hmnia
44967>>>>>>>        Set Field_Prompt_Object    Field Cmoves.Cmoves_Hmnia To (sl006(Self))
44968>>>>>>>
44968>>>>>>>        // Cmoves.Ctypkin_Recr
44968>>>>>>>
44968>>>>>>>        // Cmoves.Cmoves_Par
44968>>>>>>>
44968>>>>>>>        // Cmoves.Partl_Recr
44968>>>>>>>        //DDB/ Comment_Short       Field Cmoves.Partl_Recr To "‘¬¤›œ©ž record £œ ¡ç¡¢à£˜ à¢ã©œà¤"
44968>>>>>>>
44968>>>>>>>        // Cmoves.Cmoves_Axia
44968>>>>>>>
44968>>>>>>>        // Cmoves.Cmoves_X0
44968>>>>>>>
44968>>>>>>>        // Cmoves.Cmoves_P0
44968>>>>>>>
44968>>>>>>>        // Cmoves.Cmoves_X00
44968>>>>>>>
44968>>>>>>>        // Cmoves.Cmoves_P00
44968>>>>>>>
44968>>>>>>>        // Cmoves.Cmoves_X1
44968>>>>>>>
44968>>>>>>>        // Cmoves.Cmoves_P1
44968>>>>>>>
44968>>>>>>>        // Cmoves.Cmoves_X2
44968>>>>>>>
44968>>>>>>>        // Cmoves.Cmoves_P2
44968>>>>>>>
44968>>>>>>>        // Cmoves.Cmoves_Dlixis
44968>>>>>>>
44968>>>>>>>        // Cmoves.Cmoves_A_Code
44968>>>>>>>
44968>>>>>>>        // Cmoves.Cmoves_Status_E
44968>>>>>>>
44968>>>>>>>        // Cmoves.Cmoves_Status_A
44968>>>>>>>
44968>>>>>>>        // Cmoves.Cmoves_S0
44968>>>>>>>
44968>>>>>>>        // Cmoves.Cmoves_Ys0
44968>>>>>>>
44968>>>>>>>        // Cmoves.Cmoves_S1
44968>>>>>>>
44968>>>>>>>        // Cmoves.Cmoves_Ys1
44968>>>>>>>
44968>>>>>>>        // Cmoves.Cmoves_S2
44968>>>>>>>
44968>>>>>>>        // Cmoves.Cmoves_Ys2
44968>>>>>>>
44968>>>>>>>        // Cmoves.Cmoves_Sc_Code2
44968>>>>>>>        Set Field_Prompt_Object    Field Cmoves.Cmoves_Sc_Code2 To (slNomism(Self))
44969>>>>>>>
44969>>>>>>>        // Cmoves.Cmoves_Open
44969>>>>>>>
44969>>>>>>>        // Cmoves.Cmoves_Aopen
44969>>>>>>>
44969>>>>>>>        // Cmoves.Cmoves_M_Code
44969>>>>>>>
44969>>>>>>>        // Cmoves.Cmoves_Yn_Myf
44969>>>>>>>
44969>>>>>>>        // Cmoves.Cmoves_Myf_Axia
44969>>>>>>>
44969>>>>>>>        // Cmoves.Cmoves_Kk
44969>>>>>>>
44969>>>>>>>        // Cmoves.Cmoves_C_Code2
44969>>>>>>>
44969>>>>>>>        // Cmoves.Cn_Code
44969>>>>>>>        Set Field_Prompt_Object    Field Cmoves.Cn_Code To (sl041(Self))
44970>>>>>>>
44970>>>>>>>        // Cmoves.Client_Recr
44970>>>>>>>
44970>>>>>>>        // Cmoves.Barticl_Recr
44970>>>>>>>
44970>>>>>>>        // Cmoves.Cmoves_Qty
44970>>>>>>>
44970>>>>>>>        // Cmoves.Cmove_Totambd0
44970>>>>>>>
44970>>>>>>>        // Cmoves.Cmove_Discam0
44970>>>>>>>
44970>>>>>>>        // Cmoves.Cmove_Totamad0
44970>>>>>>>
44970>>>>>>>        // Cmoves.Cmove_Vatam0
44970>>>>>>>
44970>>>>>>>        // Cmoves.Cmove_Extra0
44970>>>>>>>
44970>>>>>>>        // Cmoves.Cmove_Totambd00
44970>>>>>>>
44970>>>>>>>        // Cmoves.Cmove_Discam00
44970>>>>>>>
44970>>>>>>>        // Cmoves.Cmove_Totamad00
44970>>>>>>>
44970>>>>>>>        // Cmoves.Cmove_Vatam00
44970>>>>>>>
44970>>>>>>>        // Cmoves.Cmove_Extra00
44970>>>>>>>
44970>>>>>>>        // Cmoves.Cmove_Totambd1
44970>>>>>>>
44970>>>>>>>        // Cmoves.Cmove_Discam1
44970>>>>>>>
44970>>>>>>>        // Cmoves.Cmove_Totamad1
44970>>>>>>>
44970>>>>>>>        // Cmoves.Cmove_Vatam1
44970>>>>>>>
44970>>>>>>>        // Cmoves.Cmove_Extra1
44970>>>>>>>
44970>>>>>>>        // Cmoves.Module_From
44970>>>>>>>
44970>>>>>>>        // Cmoves.Parast_Abrev
44970>>>>>>>
44970>>>>>>>        // Cmoves.Enhm_Ypol_Pel
44970>>>>>>>
44970>>>>>>>        // Cmoves.Enhm_Hmnies_Pel
44970>>>>>>>
44970>>>>>>>        // Cmoves.Sls_Id
44970>>>>>>>
44970>>>>>>>        // Cmoves.Presp_Id
44970>>>>>>>
44970>>>>>>>        // Cmoves.Cnt_Id
44970>>>>>>>
44970>>>>>>>        // Cmoves.Cmoves_Open_Sx0
44970>>>>>>>
44970>>>>>>>        // Cmoves.Cmoves_Open_Sp0
44970>>>>>>>
44970>>>>>>>        // Cmoves.Cmoves_Open_Yx0
44970>>>>>>>
44970>>>>>>>        // Cmoves.Cmoves_Open_Yp0
44970>>>>>>>
44970>>>>>>>        // Cmoves.Cmoves_Open_Sx1
44970>>>>>>>
44970>>>>>>>        // Cmoves.Cmoves_Open_Sp1
44970>>>>>>>
44970>>>>>>>        // Cmoves.Cmoves_Open_Sx2
44970>>>>>>>
44970>>>>>>>        // Cmoves.Cmoves_Open_Sp2
44970>>>>>>>
44970>>>>>>>        // Cmoves.Cmoves_Topen
44970>>>>>>>
44970>>>>>>>        // Cmoves.Cn_Recr
44970>>>>>>>
44970>>>>>>>        // Cmoves.Axia_Pros_Sysx
44970>>>>>>>
44970>>>>>>>        // Cmoves.Axia_Sysxet
44970>>>>>>>
44970>>>>>>>        // Cmoves.Axia_Ypol_Sysx
44970>>>>>>>
44970>>>>>>>        // Cmoves.Axia_Pros_Sys00
44970>>>>>>>
44970>>>>>>>        // Cmoves.Axia_Sysxet00
44970>>>>>>>
44970>>>>>>>        // Cmoves.Axia_Ypol_Sys00
44970>>>>>>>
44970>>>>>>>        // Cmoves.Axia_Pros_Sysr
44970>>>>>>>
44970>>>>>>>        // Cmoves.Axia_Sysxetr
44970>>>>>>>
44970>>>>>>>        // Cmoves.Axia_Ypol_Sysr
44970>>>>>>>
44970>>>>>>>        // Cmoves.Mhxanik_Id
44970>>>>>>>
44970>>>>>>>        // Cmoves.Prn_Theor
44970>>>>>>>
44970>>>>>>>        // Cmoves.Is_Closed
44970>>>>>>>
44970>>>>>>>        // Cmoves.Flag_Copen
44970>>>>>>>
44970>>>>>>>        // Cmoves.Flag_Ypol
44970>>>>>>>
44970>>>>>>>        // Cmoves.Ctypkin_Descr
44970>>>>>>>
44970>>>>>>>        // Cmoves.Client_Name
44970>>>>>>>
44970>>>>>>>        // Cmoves.Enhm_Ofeilh
44970>>>>>>>
44970>>>>>>>        //DDB-DefineFieldEnd
44970>>>>>>>    End_Procedure    // Define_Fields
44971>>>>>>>
44971>>>>>>>    // Field_Defaults:
44971>>>>>>>    // This procedure is used to establish default field values.
44971>>>>>>>
44971>>>>>>>    Procedure Field_Defaults
44972>>>>>>>        Forward Send Field_Defaults
44974>>>>>>>        //DDB-Generated-Code-Location
44974>>>>>>>        //DDB-FieldDefaultStart
44974>>>>>>>        //DDB-FieldDefaultEnd
44974>>>>>>>    End_Procedure    // Field_Defaults
44975>>>>>>>
44975>>>>>>>End_Class    // Cmoves_DataDictionary
44976>>>>>>>//DDB-Selection-pkg-Start
44976>>>>>>>
44976>>>>>>>Use sl006.SL         // sl006
44976>>>>>>>Use slnomism.sl      // slNomism
INCLUDING FILE: SLNOMISM.SL
44976>>>>>>>>>//AB/ Project slNomism
44976>>>>>>>>>//AB/ Object prj is a Lookup_Project
44976>>>>>>>>>//AB/     Set ProjectName to "slNomism"
44976>>>>>>>>>//AB/     Set ProjectFileName to "slNomism.SL"
44976>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
44976>>>>>>>>>
44976>>>>>>>>>// Project Object Structure
44976>>>>>>>>>//   slNomism is a dbModalPanelSub
44976>>>>>>>>>//     Nomisma_DD is a DataDictionary
44976>>>>>>>>>//     oSelList is a dbListSub
44976>>>>>>>>>//     oOK_bn is a ButtonSub
44976>>>>>>>>>//     oSearch_bn is a ButtonSub
44976>>>>>>>>>
44976>>>>>>>>>// Register all objects
44976>>>>>>>>>Register_Object Nomisma_DD
44976>>>>>>>>>Register_Object oOK_bn
44976>>>>>>>>>Register_Object oSearch_bn
44976>>>>>>>>>Register_Object oSelList
44976>>>>>>>>>Register_Object slNomism
44976>>>>>>>>>
44976>>>>>>>>>
44976>>>>>>>>>//AB-IgnoreStart
44976>>>>>>>>>
44976>>>>>>>>>Use DFAllEnt.pkg
44976>>>>>>>>>Use dbList.Sub
44976>>>>>>>>>Use Button.Sub
44976>>>>>>>>>
44976>>>>>>>>>
44976>>>>>>>>>Use NOMISMA.DD
44976>>>>>>>>>
44976>>>>>>>>>//AB-IgnoreEnd
44976>>>>>>>>>
44976>>>>>>>>>Object slNomism is a dbModalPanelSub
44978>>>>>>>>>
44978>>>>>>>>>    //AB-StoreTopStart
44978>>>>>>>>>    
44978>>>>>>>>>    
44978>>>>>>>>>    
44978>>>>>>>>>    //AB-StoreTopEnd
44978>>>>>>>>>
44978>>>>>>>>>    Set Label to "Œ¦£å©£˜«˜"
44979>>>>>>>>>    Set Size to 175 397
44980>>>>>>>>>    Set Location to 5 7
44981>>>>>>>>>    Set Exit_Application_Local_State to FALSE
44982>>>>>>>>>    Set Modal_State to FALSE
44983>>>>>>>>>
44983>>>>>>>>>    //AB-DDOStart
44983>>>>>>>>>
44983>>>>>>>>>    Object Nomisma_DD is a Nomisma_DataDictionary
44985>>>>>>>>>    End_Object    // Nomisma_DD
44986>>>>>>>>>
44986>>>>>>>>>    Set Main_DD to (Nomisma_DD(self))
44987>>>>>>>>>    Set Server to (Nomisma_DD(self))
44988>>>>>>>>>
44988>>>>>>>>>    //AB-DDOEnd
44988>>>>>>>>>
44988>>>>>>>>>    Object oSelList is a dbListSub
44990>>>>>>>>>        Set Main_File to Nomisma.File_Number
44991>>>>>>>>>        Set Size to 130 382
44992>>>>>>>>>        Set Location to 6 6
44993>>>>>>>>>
44993>>>>>>>>>        Begin_Row
44996>>>>>>>>>            Entry_Item Nomisma.Nomisma_code
44997>>>>>>>>>            Entry_Item Nomisma.Nomisma_descr
44998>>>>>>>>>            Entry_Item Nomisma.Dekadika
44999>>>>>>>>>            Entry_Item Nomisma.Euro_zone
45000>>>>>>>>>            Entry_Item Nomisma.Einai_drx
45001>>>>>>>>>            Entry_Item Nomisma.Einai_euro
45002>>>>>>>>>        End_Row
45007>>>>>>>>>
45007>>>>>>>>>        Set Form_Width    item 0 to 49
45008>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
45009>>>>>>>>>        
45009>>>>>>>>>        Set Form_Width    item 1 to 115
45010>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
45011>>>>>>>>>        
45011>>>>>>>>>        Set Form_Width    item 2 to 47
45012>>>>>>>>>        Set Header_Label  item 2 to "ƒœ¡˜› ¡á"
45013>>>>>>>>>        
45013>>>>>>>>>        Set Form_Width    item 3 to 55
45014>>>>>>>>>        Set Header_Label  item 3 to "…é¤ž EURO"
45015>>>>>>>>>        Set Column_Checkbox_State  item 3 to True
45016>>>>>>>>>        
45016>>>>>>>>>        Set Form_Width    item 4 to 55
45017>>>>>>>>>        Set Header_Label  item 4 to "„å¤˜  ƒ•"
45018>>>>>>>>>        Set Column_Checkbox_State  item 4 to True
45019>>>>>>>>>        
45019>>>>>>>>>        Set Form_Width    item 5 to 55
45020>>>>>>>>>        Set Header_Label  item 5 to "„å¤˜  „¬¨é"
45021>>>>>>>>>        Set Column_Checkbox_State  item 5 to True
45022>>>>>>>>>        
45022>>>>>>>>>
45022>>>>>>>>>        //AB-StoreStart
45022>>>>>>>>>        
45022>>>>>>>>>        //AB-StoreEnd
45022>>>>>>>>>
45022>>>>>>>>>    End_Object    // oSelList
45023>>>>>>>>>
45023>>>>>>>>>    Object oOK_bn is a ButtonSub
45025>>>>>>>>>        Set Label to "&„§ ¢¦šã"
45026>>>>>>>>>        Set Location to 140 279
45027>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45028>>>>>>>>>
45028>>>>>>>>>        //AB-StoreStart
45028>>>>>>>>>        Procedure OnClick
45030>>>>>>>>>            Send OK To (oSelList(current_object))
45031>>>>>>>>>        End_Procedure
45032>>>>>>>>>        //AB-StoreEnd
45032>>>>>>>>>
45032>>>>>>>>>    End_Object    // oOK_bn
45033>>>>>>>>>
45033>>>>>>>>>    Object oSearch_bn is a ButtonSub
45035>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
45036>>>>>>>>>        Set Location to 140 339
45037>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45038>>>>>>>>>
45038>>>>>>>>>        //AB-StoreStart
45038>>>>>>>>>        
45038>>>>>>>>>        Procedure OnClick
45040>>>>>>>>>            Send Search To (oSelList(current_object))
45041>>>>>>>>>        End_Procedure
45042>>>>>>>>>        
45042>>>>>>>>>        
45042>>>>>>>>>        Set Visible_State to False
45043>>>>>>>>>        Set Enabled_State to False
45044>>>>>>>>>        //AB-StoreEnd
45044>>>>>>>>>
45044>>>>>>>>>    End_Object    // oSearch_bn
45045>>>>>>>>>
45045>>>>>>>>>
45045>>>>>>>>>    //AB-StoreStart
45045>>>>>>>>>    
45045>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
45046>>>>>>>>>    
45046>>>>>>>>>    On_Key Key_Alt+Key_s Send KeyAction To (oSearch_bn(current_object))
45047>>>>>>>>>    
45047>>>>>>>>>    
45047>>>>>>>>>    
45047>>>>>>>>>    
45047>>>>>>>>>    //AB-StoreEnd
45047>>>>>>>>>
45047>>>>>>>>>End_Object    // slNomism
45048>>>>>>>>>
45048>>>>>>>>>//AB/ End_Object    // prj
45048>>>>>>>Use sl041.SL         // sl041
45048>>>>>>>
45048>>>>>>>//DDB-Selection-pkg-End
45048>>>>>>>//DDB-FileEnd
45048>>>>>    
45048>>>>>    //AB-IgnoreEnd
45048>>>>>
45048>>>>>    Object sl006 is a dbModalPanelSub
45050>>>>>
45050>>>>>        //AB-StoreTopStart
45050>>>>>                                    
45050>>>>>        Property String     psModule    Public ''
45052>>>>>        Property String     psClientID  Public ''
45054>>>>>        Property Date       pdApo       public ''
45056>>>>>        Property Date       pdEos       public ''
45058>>>>>        Property Integer    piXr_Or_Pi  public  0
45060>>>>>        Property Integer    piWhat      public  0
45062>>>>>        
45062>>>>>        //AB-StoreTopEnd
45062>>>>>
45062>>>>>        Set Label to "‰ ¤ã©œ ª ”¦¨âà¤"
45063>>>>>        Set Size to 270 519
45064>>>>>        Set Location to 5 7
45065>>>>>        Set Exit_Application_Local_State to FALSE
45066>>>>>        Set Modal_State to FALSE
45067>>>>>
45067>>>>>        //AB-DDOStart
45067>>>>>
45067>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
45069>>>>>        End_Object    // Ctypkin_DD
45070>>>>>
45070>>>>>        Object Clients_DD is a Clients_DataDictionary
45072>>>>>        End_Object    // Clients_DD
45073>>>>>
45073>>>>>        Object Cmoves_DD is a Cmoves_DataDictionary
45075>>>>>            Set DDO_Server to (Ctypkin_DD(self))
45076>>>>>            Set DDO_Server to (Clients_DD(self))
45077>>>>>
45077>>>>>            //AB-StoreStart
45077>>>>>            
45077>>>>>            Begin_Constraints
45079>>>>>            
45079>>>>>                Constrain Cmoves.Company_Code   Eq SyscurXr.Company_Code
45081>>>>>                Constrain Cmoves.Branch_Code    Eq SyscurXr.Branch_Code
45083>>>>>                Constrain Cmoves.Year_Year      Eq SyscurXr.Year_Year
45085>>>>>            
45085>>>>>                If (psClientID(Self)<>'')   Constrain Cmoves.Client_ID      Eq (psClientID(Self))
45089>>>>>                If (pdApo(Self)<>'')        Constrain Cmoves.Cmoves_Hmnia   Ge (pdApo(Self))
45093>>>>>                If (pdEos(Self)<>'')        Constrain Cmoves.Cmoves_Hmnia   Le (pdEos(Self))
45097>>>>>            
45097>>>>>                Constrain Cmoves.Module_From    Eq (psModule(Self))
45099>>>>>            
45099>>>>>                     If (piWhat(Self)=1) Constrain Cmoves.Flag_Ypol Eq 1
45103>>>>>                Else If (piWhat(Self)=2) Constrain Cmoves.Flag_Ypol Eq 0
45108>>>>>            
45108>>>>>            End_Constraints
45111>>>>>            
45111>>>>>            
45111>>>>>            
45111>>>>>            
45111>>>>>            
45111>>>>>            
45111>>>>>            
45111>>>>>            
45111>>>>>            
45111>>>>>            
45111>>>>>            
45111>>>>>            
45111>>>>>            
45111>>>>>            
45111>>>>>            
45111>>>>>            
45111>>>>>            
45111>>>>>            
45111>>>>>            
45111>>>>>            
45111>>>>>            
45111>>>>>            
45111>>>>>            
45111>>>>>            
45111>>>>>            
45111>>>>>            //AB-StoreEnd
45111>>>>>
45111>>>>>        End_Object    // Cmoves_DD
45112>>>>>
45112>>>>>        Set Main_DD to (Cmoves_DD(self))
45113>>>>>        Set Server to (Cmoves_DD(self))
45114>>>>>
45114>>>>>        //AB-DDOEnd
45114>>>>>
45114>>>>>        Object oSelList is a dbListSub
45116>>>>>
45116>>>>>            //AB-StoreTopStart
45116>>>>>                                                                                                                                                                                                                                                                                                                    
45116>>>>>            //AB-StoreTopEnd
45116>>>>>
45116>>>>>            Set Main_File to Cmoves.File_Number
45117>>>>>            Set Ordering to 4
45118>>>>>            Set Size to 199 505
45119>>>>>            Set Location to 31 7
45120>>>>>            Set Auto_Index_State to FALSE
45121>>>>>
45121>>>>>            Begin_Row
45124>>>>>                Entry_Item Cmoves.Cmoves_hmnia
45125>>>>>                Entry_Item Cmoves.Cmoves_par
45126>>>>>                Entry_Item Ctypkin.Ctypkin_descr
45127>>>>>                Entry_Item Clients.Client_name
45128>>>>>                Entry_Item Cmoves.Cmoves_axia
45129>>>>>                Entry_Item Cmoves.Cmoves_sc_code2
45130>>>>>                Entry_Item Cmoves.Module_from
45131>>>>>            End_Row
45136>>>>>
45136>>>>>            Set Form_Width    item 0 to 57
45137>>>>>            Set Header_Label  item 0 to "†£œ¨/¤å˜"
45138>>>>>            
45138>>>>>            Set Form_Width    item 1 to 121
45139>>>>>            Set Header_Label  item 1 to "€ « ¦¢¦šå˜"
45140>>>>>            
45140>>>>>            Set Form_Width    item 2 to 65
45141>>>>>            Set Header_Label  item 2 to "‰å¤ž©ž"
45142>>>>>            
45142>>>>>            Set Form_Width    item 3 to 107
45143>>>>>            Set Header_Label  item 3 to "‘¬¤˜¢¢˜©æ£œ¤¦ª"
45144>>>>>            
45144>>>>>            Set Form_Width    item 4 to 63
45145>>>>>            Set Header_Label  item 4 to " €¥å˜"
45146>>>>>            
45146>>>>>            Set Form_Width    item 5 to 42
45147>>>>>            Set Header_Label  item 5 to "Œæ£ ©£˜"
45148>>>>>            
45148>>>>>            Set Form_Width    item 6 to 45
45149>>>>>            Set Header_Label  item 6 to "‰ç¡¢à£˜"
45150>>>>>            
45150>>>>>
45150>>>>>            //AB-StoreStart
45150>>>>>                                                                                                                                                                                                                                                                                                                    
45150>>>>>            Procedure End_Construct_Object
45152>>>>>                String  sNom
45153>>>>>                Integer iDecs
45153>>>>>                Forward Send End_Construct_Object
45155>>>>>                Move SysCurxr.C_Code0 to sNom
45156>>>>>                Clear Nomisma
45157>>>>>                Move sNom to Nomisma.Nomisma_Code
45158>>>>>                Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
45159>>>>>>
45159>>>>>                If (Found=1)    Move Nomisma.Dekadika to iDecs
45162>>>>>                Else            Move 0 to iDecs
45164>>>>>            
45164>>>>>                // Ž¨ ¦¬£œ §àª ˜¤ «¦ ™˜© ¡æ ¤¦£ ©£˜ ®¨ã©žª ƒ„Œ œ®œ  ›œ¡˜› ¡á
45164>>>>>                // «æ«œ œ¥' ¦¨ ©£¦ç ™á¦¬£œ œ£œ ª 2
45164>>>>>                If (iDecs=0) Move 2 to iDecs
45167>>>>>                //
45167>>>>>            
45167>>>>>                Set Points          Item 4 to       iDecs
45168>>>>>                Set Numeric_Mask    Item 4 to 14    iDecs '*, '
45169>>>>>            End_Procedure
45170>>>>>            
45170>>>>>            
45170>>>>>            
45170>>>>>            
45170>>>>>            
45170>>>>>            //AB-StoreEnd
45170>>>>>
45170>>>>>        End_Object    // oSelList
45171>>>>>
45171>>>>>        Object oOK_bn is a ButtonSub
45173>>>>>            Set Label to "&„§ ¢¦šã"
45174>>>>>            Set Location to 236 350
45175>>>>>
45175>>>>>            //AB-StoreStart
45175>>>>>            Procedure OnClick
45177>>>>>                Send OK To (oSelList(current_object))
45178>>>>>            End_Procedure
45179>>>>>            //AB-StoreEnd
45179>>>>>
45179>>>>>        End_Object    // oOK_bn
45180>>>>>
45180>>>>>        Object oCancel_bn is a ButtonSub
45182>>>>>            Set Label to "&€¡ç¨à©ž"
45183>>>>>            Set Location to 236 404
45184>>>>>
45184>>>>>            //AB-StoreStart
45184>>>>>            Procedure OnClick
45186>>>>>                Send Cancel To (oSelList(current_object))
45187>>>>>            End_Procedure
45188>>>>>            //AB-StoreEnd
45188>>>>>
45188>>>>>        End_Object    // oCancel_bn
45189>>>>>
45189>>>>>        Object oSearch_bn is a ButtonSub
45191>>>>>            Set Label to "€&¤˜ã«ž©ž"
45192>>>>>            Set Location to 236 460
45193>>>>>
45193>>>>>            //AB-StoreStart
45193>>>>>            Procedure OnClick
45195>>>>>                Send Search To (oSelList(current_object))
45196>>>>>            End_Procedure
45197>>>>>            //AB-StoreEnd
45197>>>>>
45197>>>>>        End_Object    // oSearch_bn
45198>>>>>
45198>>>>>        Object Cmoves_Axia_Pros_Sysx is a dbFormSub
45200>>>>>            Entry_Item Cmoves.Axia_pros_sysx
45201>>>>>            Set Size to 13 54
45202>>>>>            Set Location to 236 24
45203>>>>>            Set Color to clBtnFace
45204>>>>>            Set Label_Col_Offset to 2
45205>>>>>            Set Label_Justification_Mode to jMode_Right
45206>>>>>            Set Enabled_State to FALSE
45207>>>>>            Set Item_Shadow_State Item 0 to TRUE
45208>>>>>            Set Shadow_State Item 0 to TRUE
45209>>>>>
45209>>>>>            //AB-StoreStart
45209>>>>>            Set points item 0 to 2
45210>>>>>            Set Numeric_Mask Item 0 to 8 2 ' ,*'
45211>>>>>            
45211>>>>>            //AB-StoreEnd
45211>>>>>
45211>>>>>        End_Object    // Cmoves_Axia_Pros_Sysx
45212>>>>>
45212>>>>>        Object Cmoves_Axia_Sysxet is a dbFormSub
45214>>>>>            Entry_Item Cmoves.Axia_sysxet
45215>>>>>            Set Size to 13 54
45216>>>>>            Set Location to 236 140
45217>>>>>            Set Color to clBtnFace
45218>>>>>            Set Label_Col_Offset to 2
45219>>>>>            Set Label_Justification_Mode to jMode_Right
45220>>>>>            Set Enabled_State to FALSE
45221>>>>>            Set Item_Shadow_State Item 0 to TRUE
45222>>>>>            Set Shadow_State Item 0 to TRUE
45223>>>>>
45223>>>>>            //AB-StoreStart
45223>>>>>            Set points item 0 to 2
45224>>>>>            Set Numeric_Mask Item 0 to 8 2 ' ,*'
45225>>>>>            
45225>>>>>            //AB-StoreEnd
45225>>>>>
45225>>>>>        End_Object    // Cmoves_Axia_Sysxet
45226>>>>>
45226>>>>>        Object Cmoves_Axia_Ypol_Sysx is a dbFormSub
45228>>>>>            Entry_Item Cmoves.Axia_ypol_sysx
45229>>>>>            Set Size to 13 54
45230>>>>>            Set Location to 236 248
45231>>>>>            Set Color to clBtnFace
45232>>>>>            Set Label_Col_Offset to 2
45233>>>>>            Set Label_Justification_Mode to jMode_Right
45234>>>>>            Set Enabled_State to FALSE
45235>>>>>            Set Item_Shadow_State Item 0 to TRUE
45236>>>>>            Set Shadow_State Item 0 to TRUE
45237>>>>>
45237>>>>>            //AB-StoreStart
45237>>>>>                                                                                            
45237>>>>>            Set points item 0 to 2
45238>>>>>            Set Numeric_Mask Item 0 to 8 2 ' ,*'
45239>>>>>            
45239>>>>>            //AB-StoreEnd
45239>>>>>
45239>>>>>        End_Object    // Cmoves_Axia_Ypol_Sysx
45240>>>>>
45240>>>>>        Object TextBoxSub1 is a TextBoxSub
45242>>>>>            Set Label to "€¥å˜"
45243>>>>>            Set Location to 238 7
45244>>>>>            Set Size to 10 15
45245>>>>>        End_Object    // TextBoxSub1
45246>>>>>
45246>>>>>        Object TextBoxSub2 is a TextBoxSub
45248>>>>>            Set Label to "‘¬©®œ« ©£â¤ž"
45249>>>>>            Set Location to 238 89
45250>>>>>            Set Size to 10 49
45251>>>>>        End_Object    // TextBoxSub2
45252>>>>>
45252>>>>>        Object TextBoxSub3 is a TextBoxSub
45254>>>>>            Set Label to "ƒ ˜Ÿâ© £ž"
45255>>>>>            Set Location to 238 210
45256>>>>>            Set Size to 10 35
45257>>>>>        End_Object    // TextBoxSub3
45258>>>>>
45258>>>>>        Object RadioGroupSub2 is a RadioGroupSub
45260>>>>>            Set Label to "„§ ¢¦šã ‰ ¤ã©œà¤"
45261>>>>>            Set Size to 24 497
45262>>>>>            Set Location to 3 9
45263>>>>>            Object Radio4 is a RadioSub
45265>>>>>                Set Label to "Ž¢œª"
45266>>>>>                Set Size to 10 37
45267>>>>>                Set Location to 10 97
45268>>>>>            End_Object    // Radio4
45269>>>>>
45269>>>>>            Object Radio5 is a RadioSub
45271>>>>>                Set Label to "‹œ ¬§æ¢¦ §¦ ©¬©®â« ©žª"
45272>>>>>                Set Size to 10 97
45273>>>>>                Set Location to 10 167
45274>>>>>            End_Object    // Radio5
45275>>>>>
45275>>>>>            Object Radio6 is a RadioSub
45277>>>>>                Set Label to "•à¨åª ¬§æ¢¦ §¦ ©¬©®â« ©žª"
45278>>>>>                Set Size to 10 111
45279>>>>>                Set Location to 10 278
45280>>>>>            End_Object    // Radio6
45281>>>>>
45281>>>>>
45281>>>>>            //AB-StoreStart
45281>>>>>                                                                                
45281>>>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
45283>>>>>                Set piWhat to iToItem
45284>>>>>                Send Rebuild_Constraints to Cmoves_DD
45285>>>>>                Send Beginning_Of_Data To oSelList True
45286>>>>>            End_Procedure
45287>>>>>            
45287>>>>>            Set Current_Radio to 1
45288>>>>>            
45288>>>>>            
45288>>>>>            
45288>>>>>            
45288>>>>>            //AB-StoreEnd
45288>>>>>
45288>>>>>        End_Object    // RadioGroupSub2
45289>>>>>
45289>>>>>
45289>>>>>        //AB-StoreStart
45289>>>>>                                    
45289>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
45290>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
45291>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
45292>>>>>        
45292>>>>>        Set Modal_State to True
45293>>>>>        
45293>>>>>        Procedure Activate
45295>>>>>            String  sNom
45296>>>>>            Integer iDecs rVal
45296>>>>>            Set piWhat to 1
45297>>>>>            Set Current_Radio Of RadioGroupSub2 to 1
45298>>>>>            Forward Send Activate
45300>>>>>            Send Rebuild_Constraints        to Cmoves_DD
45301>>>>>            Send Beginning_Of_Data          to oSelList True
45302>>>>>        End_procedure
45303>>>>>        
45303>>>>>        
45303>>>>>        
45303>>>>>        
45303>>>>>        
45303>>>>>        
45303>>>>>        
45303>>>>>        
45303>>>>>        
45303>>>>>        
45303>>>>>        
45303>>>>>        
45303>>>>>        
45303>>>>>        
45303>>>>>        
45303>>>>>        
45303>>>>>        
45303>>>>>        
45303>>>>>        
45303>>>>>        
45303>>>>>        
45303>>>>>        
45303>>>>>        
45303>>>>>        
45303>>>>>        
45303>>>>>        
45303>>>>>        //AB-StoreEnd
45303>>>>>
45303>>>>>    End_Object    // sl006
45304>>>>>
45304>>>>>//AB/     End_Object    // prj
45304>>>Use sl007.sl
45304>>>Use sl007r.sl
INCLUDING FILE: SL007R.SL
45304>>>>>//AB/ Project sl007r:Ctypkin lookup with RecR 1st Col
45304>>>>>//AB/     Object prj is a Lookup_Project
45304>>>>>//AB/         Set ProjectName to "sl007r:Ctypkin lookup with RecR 1st Col"
45304>>>>>//AB/         Set ProjectFileName to "sl007r.SL"
45304>>>>>//AB/         Set GenerateFileName to "NONAME"
45304>>>>>
45304>>>>>// Project Object Structure
45304>>>>>//   sl007r is a dbModalPanelSub
45304>>>>>//     Ctypkin_DD is a DataDictionary
45304>>>>>//     oSelList is a dbListSub
45304>>>>>//     oOK_bn is a ButtonSub
45304>>>>>//     oCancel_bn is a ButtonSub
45304>>>>>//     oSearch_bn is a ButtonSub
45304>>>>>
45304>>>>>// Register all objects
45304>>>>>Register_Object Ctypkin_DD
45304>>>>>Register_Object oCancel_bn
45304>>>>>Register_Object oOK_bn
45304>>>>>Register_Object oSearch_bn
45304>>>>>Register_Object oSelList
45304>>>>>Register_Object sl007r
45304>>>>>
45304>>>>>
45304>>>>>    //AB-IgnoreStart
45304>>>>>
45304>>>>>    Use DFAllEnt.pkg
45304>>>>>    Use dbList.Sub
45304>>>>>    Use Button.Sub
45304>>>>>
45304>>>>>
45304>>>>>    Use CTYPKIN.DD
45304>>>>>    
45304>>>>>    //AB-IgnoreEnd
45304>>>>>
45304>>>>>    CD_Popup_Object sl007r is a dbModalPanelSub
45323>>>>>        Set Label to "Ctypkin"
45324>>>>>        Set Size to 148 480
45325>>>>>        Set Location to 12 16
45326>>>>>        Set Exit_Application_Local_State to FALSE
45327>>>>>        Set Modal_State to FALSE
45328>>>>>
45328>>>>>        //AB-DDOStart
45328>>>>>
45328>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
45330>>>>>        End_Object    // Ctypkin_DD
45331>>>>>
45331>>>>>        Set Main_DD to (Ctypkin_DD(self))
45332>>>>>        Set Server to (Ctypkin_DD(self))
45333>>>>>
45333>>>>>        //AB-DDOEnd
45333>>>>>
45333>>>>>        Object oSelList is a dbListSub
45335>>>>>            Set Main_File to Ctypkin.File_Number
45336>>>>>            Set Size to 105 465
45337>>>>>            Set Location to 6 6
45338>>>>>
45338>>>>>            Begin_Row
45341>>>>>                Entry_Item Ctypkin.Ctypkin_recr
45342>>>>>                Entry_Item Ctypkin.Ctypkin_code
45343>>>>>                Entry_Item Ctypkin.Ctypkin_descr
45344>>>>>                Entry_Item Ctypkin.Ctypkin_anti
45345>>>>>            End_Row
45350>>>>>
45350>>>>>            Set Form_Width    item 0 to 72
45351>>>>>            Set Header_Label  item 0 to "RecR"
45352>>>>>            
45352>>>>>            Set Form_Width    item 1 to 58
45353>>>>>            Set Header_Label  item 1 to "Ctypkin code"
45354>>>>>            
45354>>>>>            Set Form_Width    item 2 to 209
45355>>>>>            Set Header_Label  item 2 to "Ctypkin descr"
45356>>>>>            
45356>>>>>            Set Form_Width    item 3 to 120
45357>>>>>            Set Header_Label  item 3 to "Ctypkin anti"
45358>>>>>            
45358>>>>>
45358>>>>>            //AB-StoreStart
45358>>>>>            
45358>>>>>            Set Column_Option Item 0 to Noenter True
45359>>>>>            
45359>>>>>            //AB-StoreEnd
45359>>>>>
45359>>>>>        End_Object    // oSelList
45360>>>>>
45360>>>>>        Object oOK_bn is a ButtonSub
45362>>>>>            set label to "&„§ ¢¦šã" 
45363>>>>>            Set Location to 114 312
45364>>>>>
45364>>>>>            //AB-StoreStart
45364>>>>>            Procedure OnClick
45366>>>>>                Send OK To (oSelList(current_object))
45367>>>>>            End_Procedure
45368>>>>>            //AB-StoreEnd
45368>>>>>
45368>>>>>        End_Object    // oOK_bn
45369>>>>>
45369>>>>>        Object oCancel_bn is a ButtonSub
45371>>>>>            set label to "&€¡ç¨à©ž" 
45372>>>>>            Set Location to 114 367
45373>>>>>
45373>>>>>            //AB-StoreStart
45373>>>>>            Procedure OnClick
45375>>>>>                Send Cancel To (oSelList(current_object))
45376>>>>>            End_Procedure
45377>>>>>            //AB-StoreEnd
45377>>>>>
45377>>>>>        End_Object    // oCancel_bn
45378>>>>>
45378>>>>>        Object oSearch_bn is a ButtonSub
45380>>>>>            set label to "€&¤˜ã«ž©ž" 
45381>>>>>            Set Location to 114 422
45382>>>>>
45382>>>>>            //AB-StoreStart
45382>>>>>            Procedure OnClick
45384>>>>>                Send Search To (oSelList(current_object))
45385>>>>>            End_Procedure
45386>>>>>            //AB-StoreEnd
45386>>>>>
45386>>>>>        End_Object    // oSearch_bn
45387>>>>>
45387>>>>>
45387>>>>>        //AB-StoreStart
45387>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
45388>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
45389>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
45390>>>>>        //AB-StoreEnd
45390>>>>>
45390>>>>>    CD_End_Object    // sl007r
45392>>>>>>
45392>>>>>
45392>>>>>//AB/     End_Object    // prj
45392>>>Use sl012.sl
45392>>>Use sl013.sl
45392>>>Use sl013b.sl
INCLUDING FILE: SL013B.SL
45392>>>>>//AB/ Project sl013b : Pseira
45392>>>>>//AB/ Object prj is a Lookup_Project
45392>>>>>//AB/     Set ProjectName to "sl013b : Pseira"
45392>>>>>//AB/     Set ProjectFileName to "sl013b.SL"
45392>>>>>//AB/     Set GenerateFileName to "NONAME"
45392>>>>>
45392>>>>>// Project Object Structure
45392>>>>>//   sl013b is a dbModalPanelSub
45392>>>>>//     Ctypkin_DD is a DataDictionary
45392>>>>>//     Wtypkin_DD is a DataDictionary
45392>>>>>//     Ptyppar_DD is a DataDictionary
45392>>>>>//     Pseira_DD is a DataDictionary
45392>>>>>//     oSelList is a dbListSub
45392>>>>>//     oOK_bn is a ButtonSub
45392>>>>>//     oCancel_bn is a ButtonSub
45392>>>>>//     oSearch_bn is a ButtonSub
45392>>>>>
45392>>>>>// Register all objects
45392>>>>>Register_Object Ctypkin_DD
45392>>>>>Register_Object oCancel_bn
45392>>>>>Register_Object oOK_bn
45392>>>>>Register_Object oSearch_bn
45392>>>>>Register_Object oSelList
45392>>>>>Register_Object Pseira_DD
45392>>>>>Register_Object Ptyppar_DD
45392>>>>>Register_Object sl013b
45392>>>>>Register_Object Wtypkin_DD
45392>>>>>
45392>>>>>
45392>>>>>//AB-IgnoreStart
45392>>>>>
45392>>>>>Use DFAllEnt.pkg
45392>>>>>Use dbList.Sub
45392>>>>>Use Button.Sub
45392>>>>>
45392>>>>>
45392>>>>>Use CTYPKIN.DD
45392>>>>>Use WTYPKIN.DD
45392>>>>>Use PTYPPAR.DD
45392>>>>>Use PSEIRA.DD
45392>>>>>
45392>>>>>//AB-IgnoreEnd
45392>>>>>
45392>>>>>Object sl013b is a dbModalPanelSub
45394>>>>>    set label to "‘œ ¨œª §˜¨˜©«˜« ¡é¤ §é¢ž©žª" 
45395>>>>>    Set Size to 148 297
45396>>>>>    Set Location to 4 4
45397>>>>>    Set Exit_Application_Local_State to FALSE
45398>>>>>    Set Modal_State to FALSE
45399>>>>>
45399>>>>>    //AB-DDOStart
45399>>>>>
45399>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
45401>>>>>    End_Object    // Ctypkin_DD
45402>>>>>
45402>>>>>    Object Wtypkin_DD is a Wtypkin_DataDictionary
45404>>>>>    End_Object    // Wtypkin_DD
45405>>>>>
45405>>>>>    Object Ptyppar_DD is a Ptyppar_DataDictionary
45407>>>>>        Set DDO_Server to (Ctypkin_DD(self))
45408>>>>>        Set DDO_Server to (Wtypkin_DD(self))
45409>>>>>    End_Object    // Ptyppar_DD
45410>>>>>
45410>>>>>    Object Pseira_DD is a Pseira_DataDictionary
45412>>>>>        Set DDO_Server to (Ptyppar_DD(self))
45413>>>>>    End_Object    // Pseira_DD
45414>>>>>
45414>>>>>    Set Main_DD to (Pseira_DD(self))
45415>>>>>    Set Server to (Pseira_DD(self))
45416>>>>>
45416>>>>>    //AB-DDOEnd
45416>>>>>
45416>>>>>    Object oSelList is a dbListSub
45418>>>>>        Set Main_File to Pseira.File_Number
45419>>>>>        Set Size to 105 280
45420>>>>>        Set Location to 6 6
45421>>>>>
45421>>>>>        Begin_Row
45424>>>>>            Entry_Item Pseira.Pseira_seira
45425>>>>>        End_Row
45430>>>>>
45430>>>>>        Set Form_Width    item 0 to 270
45431>>>>>        set header_label  item 0 to "‘œ ¨˜" 
45432>>>>>        
45432>>>>>    End_Object    // oSelList
45433>>>>>
45433>>>>>    Object oOK_bn is a ButtonSub
45435>>>>>        set label to "&„§ ¢¦šã" 
45436>>>>>        Set Location to 115 126
45437>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45438>>>>>
45438>>>>>        //AB-StoreStart
45438>>>>>        Procedure OnClick
45440>>>>>            Send OK To (oSelList(current_object))
45441>>>>>        End_Procedure
45442>>>>>        //AB-StoreEnd
45442>>>>>
45442>>>>>    End_Object    // oOK_bn
45443>>>>>
45443>>>>>    Object oCancel_bn is a ButtonSub
45445>>>>>        set label to "&€¡ç¨à©ž" 
45446>>>>>        Set Location to 115 181
45447>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45448>>>>>
45448>>>>>        //AB-StoreStart
45448>>>>>        Procedure OnClick
45450>>>>>            Send Cancel To (oSelList(current_object))
45451>>>>>        End_Procedure
45452>>>>>        //AB-StoreEnd
45452>>>>>
45452>>>>>    End_Object    // oCancel_bn
45453>>>>>
45453>>>>>    Object oSearch_bn is a ButtonSub
45455>>>>>        set label to "€&¤˜ã«ž©ž" 
45456>>>>>        Set Location to 115 236
45457>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45458>>>>>
45458>>>>>        //AB-StoreStart
45458>>>>>        Procedure OnClick
45460>>>>>            Send Search To (oSelList(current_object))
45461>>>>>        End_Procedure
45462>>>>>        //AB-StoreEnd
45462>>>>>
45462>>>>>    End_Object    // oSearch_bn
45463>>>>>
45463>>>>>
45463>>>>>    //AB-StoreStart
45463>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
45464>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
45465>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
45466>>>>>    //AB-StoreEnd
45466>>>>>
45466>>>>>End_Object    // sl013b
45467>>>>>
45467>>>>>//AB/ End_Object    // prj
45467>>>Use sl014.sl
45467>>>Use sl022.sl
45467>>>Use sl023.sl
45467>>>Use sl024.sl
45467>>>Use sl025.sl
45467>>>Use sl026.sl
INCLUDING FILE: SL026.SL
45467>>>>>//AB/ Project sl026:Item
45467>>>>>//AB/     Object prj is a Lookup_Project
45467>>>>>//AB/         Set ProjectName to "sl026:Item"
45467>>>>>//AB/         Set ProjectFileName to "sl026.SL"
45467>>>>>//AB/         Set GenerateFileName to "NONAME"
45467>>>>>
45467>>>>>// Project Object Structure
45467>>>>>//   sl026 is a dbModalPanelSub
45467>>>>>//     Witemkat_DD is a DataDictionary
45467>>>>>//     Units_DD is a DataDictionary
45467>>>>>//     Item_DD is a DataDictionary
45467>>>>>//     oSelList is a dbListSub
45467>>>>>//     oOK_bn is a ButtonSub
45467>>>>>//     oCancel_bn is a ButtonSub
45467>>>>>//     oSearch_bn is a ButtonSub
45467>>>>>
45467>>>>>// Register all objects
45467>>>>>Register_Object Item_DD
45467>>>>>Register_Object oCancel_bn
45467>>>>>Register_Object oOK_bn
45467>>>>>Register_Object oSearch_bn
45467>>>>>Register_Object oSelList
45467>>>>>Register_Object sl026
45467>>>>>Register_Object Units_DD
45467>>>>>Register_Object Witemkat_DD
45467>>>>>
45467>>>>>
45467>>>>>    //AB-IgnoreStart
45467>>>>>
45467>>>>>    Use DFAllEnt.pkg
45467>>>>>    Use dbList.Sub
45467>>>>>    Use Button.Sub
45467>>>>>
45467>>>>>
45467>>>>>    Use WITEMKAT.DD
45467>>>>>    Use UNITS.DD
45467>>>>>    Use ITEM.DD
45467>>>>>    
45467>>>>>    //AB-IgnoreEnd
45467>>>>>
45467>>>>>    Object sl026 is a dbModalPanelSub
45469>>>>>        set label to "€¨®œå¦ „ ›é¤" 
45470>>>>>        Set Size to 148 297
45471>>>>>        Set Location to 2 15
45472>>>>>        Set Exit_Application_Local_State to FALSE
45473>>>>>        Set Modal_State to FALSE
45474>>>>>
45474>>>>>        //AB-DDOStart
45474>>>>>
45474>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
45476>>>>>        End_Object    // Witemkat_DD
45477>>>>>
45477>>>>>        Object Units_DD is a Units_DataDictionary
45479>>>>>        End_Object    // Units_DD
45480>>>>>
45480>>>>>        Object Item_DD is a Item_DataDictionary
45482>>>>>            Set DDO_Server to (Units_DD(self))
45483>>>>>            Set DDO_Server to (Witemkat_DD(self))
45484>>>>>        End_Object    // Item_DD
45485>>>>>
45485>>>>>        Set Main_DD to (Item_DD(self))
45486>>>>>        Set Server to (Item_DD(self))
45487>>>>>
45487>>>>>        //AB-DDOEnd
45487>>>>>
45487>>>>>        Object oSelList is a dbListSub
45489>>>>>            Set Main_File to Item.File_Number
45490>>>>>            Set Server to (Units_DD(self))
45491>>>>>            Set Size to 105 280
45492>>>>>            Set Location to 6 6
45493>>>>>
45493>>>>>            Begin_Row
45496>>>>>                Entry_Item Item.Item_code
45497>>>>>                Entry_Item Item.Item_descr
45498>>>>>                Entry_Item Item.Witemkat_code
45499>>>>>                entry_item units.units_descr 
45500>>>>>            End_Row
45505>>>>>
45505>>>>>            Set Form_Width    item 0 to 60
45506>>>>>            set header_label  item 0 to "„ ›¦ª" 
45507>>>>>            
45507>>>>>            Set Form_Width    item 1 to 89
45508>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
45509>>>>>            
45509>>>>>            Set Form_Width    item 2 to 44
45510>>>>>            set header_label  item 2 to "‰˜«žš¦¨å˜   :" 
45511>>>>>            
45511>>>>>            Set Form_Width    item 3 to 79
45512>>>>>            set header_label  item 3 to "‹¦¤.‹â«¨ž©žª" 
45513>>>>>            
45513>>>>>        End_Object    // oSelList
45514>>>>>
45514>>>>>        Object oOK_bn is a ButtonSub
45516>>>>>            set label to "&„§ ¢¦šã" 
45517>>>>>            Set Location to 115 126
45518>>>>>
45518>>>>>            //AB-StoreStart
45518>>>>>            Procedure OnClick
45520>>>>>                Send OK To (oSelList(current_object))
45521>>>>>            End_Procedure
45522>>>>>            //AB-StoreEnd
45522>>>>>
45522>>>>>        End_Object    // oOK_bn
45523>>>>>
45523>>>>>        Object oCancel_bn is a ButtonSub
45525>>>>>            set label to "&€¡ç¨à©ž" 
45526>>>>>            Set Location to 115 181
45527>>>>>
45527>>>>>            //AB-StoreStart
45527>>>>>            Procedure OnClick
45529>>>>>                Send Cancel To (oSelList(current_object))
45530>>>>>            End_Procedure
45531>>>>>            //AB-StoreEnd
45531>>>>>
45531>>>>>        End_Object    // oCancel_bn
45532>>>>>
45532>>>>>        Object oSearch_bn is a ButtonSub
45534>>>>>            set label to "€&¤˜ã«ž©ž" 
45535>>>>>            Set Location to 115 236
45536>>>>>
45536>>>>>            //AB-StoreStart
45536>>>>>            Procedure OnClick
45538>>>>>                Send Search To (oSelList(current_object))
45539>>>>>            End_Procedure
45540>>>>>            //AB-StoreEnd
45540>>>>>
45540>>>>>        End_Object    // oSearch_bn
45541>>>>>
45541>>>>>
45541>>>>>        //AB-StoreStart
45541>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
45542>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
45543>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
45544>>>>>        //AB-StoreEnd
45544>>>>>
45544>>>>>    End_Object    // sl026
45545>>>>>
45545>>>>>//AB/     End_Object    // prj
45545>>>Use sl026a.sl
INCLUDING FILE: SL026A.SL
45545>>>>>//AB/ Project sl026a:item
45545>>>>>//AB/ Object prj is a Lookup_Project
45545>>>>>//AB/     Set ProjectName to "sl026a:item"
45545>>>>>//AB/     Set ProjectFileName to "sl026a.SL"
45545>>>>>//AB/     Set GenerateFileName to "NONAME"
45545>>>>>
45545>>>>>// Project Object Structure
45545>>>>>//   sl026a is a dbModalPanelSub
45545>>>>>//     Witemkat_DD is a DataDictionary
45545>>>>>//     Units_DD is a DataDictionary
45545>>>>>//     Fpa_DD is a DataDictionary
45545>>>>>//     Item_DD is a DataDictionary
45545>>>>>//     oSelList is a dbListSub
45545>>>>>//     oOK_bn is a ButtonSub
45545>>>>>//     oCancel_bn is a ButtonSub
45545>>>>>//     oSearch_bn is a ButtonSub
45545>>>>>
45545>>>>>// Register all objects
45545>>>>>Register_Object Fpa_DD
45545>>>>>Register_Object Item_DD
45545>>>>>Register_Object oCancel_bn
45545>>>>>Register_Object oOK_bn
45545>>>>>Register_Object oSearch_bn
45545>>>>>Register_Object oSelList
45545>>>>>Register_Object sl026a
45545>>>>>Register_Object Units_DD
45545>>>>>Register_Object Witemkat_DD
45545>>>>>
45545>>>>>
45545>>>>>//AB-IgnoreStart
45545>>>>>
45545>>>>>Use DFAllEnt.pkg
45545>>>>>Use dbList.Sub
45545>>>>>Use Button.Sub
45545>>>>>
45545>>>>>
45545>>>>>Use WITEMKAT.DD
45545>>>>>Use UNITS.DD
45545>>>>>Use FPA.DD
45545>>>>>Use ITEM.DD
45545>>>>>
45545>>>>>//AB-IgnoreEnd
45545>>>>>
45545>>>>>Object sl026a is a dbModalPanelSub
45547>>>>>    set label to "„å›ž" 
45548>>>>>    Set Size to 148 372
45549>>>>>    Set Location to 4 5
45550>>>>>    Set Exit_Application_Local_State to FALSE
45551>>>>>    Set Modal_State to FALSE
45552>>>>>
45552>>>>>    //AB-DDOStart
45552>>>>>
45552>>>>>    Object Witemkat_DD is a Witemkat_DataDictionary
45554>>>>>    End_Object    // Witemkat_DD
45555>>>>>
45555>>>>>    Object Units_DD is a Units_DataDictionary
45557>>>>>    End_Object    // Units_DD
45558>>>>>
45558>>>>>    Object Fpa_DD is a Fpa_DataDictionary
45560>>>>>    End_Object    // Fpa_DD
45561>>>>>
45561>>>>>    Object Item_DD is a Item_DataDictionary
45563>>>>>        Set DDO_Server to (Units_DD(self))
45564>>>>>        Set DDO_Server to (Witemkat_DD(self))
45565>>>>>        Set DDO_Server to (Fpa_DD(self))
45566>>>>>    End_Object    // Item_DD
45567>>>>>
45567>>>>>    Set Main_DD to (Item_DD(self))
45568>>>>>    Set Server to (Item_DD(self))
45569>>>>>
45569>>>>>    //AB-DDOEnd
45569>>>>>
45569>>>>>    Object oSelList is a dbListSub
45571>>>>>        Set Main_File to Item.File_Number
45572>>>>>        Set Size to 105 359
45573>>>>>        Set Location to 6 6
45574>>>>>
45574>>>>>        Begin_Row
45577>>>>>            Entry_Item Item.Item_code
45578>>>>>            Entry_Item Item.Item_descr
45579>>>>>            Entry_Item Fpa.Fpa_pososto
45580>>>>>            Entry_Item Item.Item_qual
45581>>>>>        End_Row
45586>>>>>
45586>>>>>        Set Form_Width    item 0 to 70
45587>>>>>        set header_label  item 0 to "‰à› ¡æª „ ›¦¬ª" 
45588>>>>>        
45588>>>>>        Set Form_Width    item 1 to 160
45589>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
45590>>>>>        
45590>>>>>        Set Form_Width    item 2 to 59
45591>>>>>        set header_label  item 2 to "% ”€" 
45592>>>>>        
45592>>>>>        Set Form_Width    item 3 to 62
45593>>>>>        set header_label  item 3 to "¦ æ«ž«˜" 
45594>>>>>        
45594>>>>>    End_Object    // oSelList
45595>>>>>
45595>>>>>    Object oOK_bn is a ButtonSub
45597>>>>>        set label to "&„§ ¢¦šã" 
45598>>>>>        Set Location to 114 207
45599>>>>>
45599>>>>>        //AB-StoreStart
45599>>>>>        Procedure OnClick
45601>>>>>            Send OK To (oSelList(current_object))
45602>>>>>        End_Procedure
45603>>>>>        //AB-StoreEnd
45603>>>>>
45603>>>>>    End_Object    // oOK_bn
45604>>>>>
45604>>>>>    Object oCancel_bn is a ButtonSub
45606>>>>>        set label to "&€¡ç¨à©ž" 
45607>>>>>        Set Location to 114 261
45608>>>>>
45608>>>>>        //AB-StoreStart
45608>>>>>        Procedure OnClick
45610>>>>>            Send Cancel To (oSelList(current_object))
45611>>>>>        End_Procedure
45612>>>>>        //AB-StoreEnd
45612>>>>>
45612>>>>>    End_Object    // oCancel_bn
45613>>>>>
45613>>>>>    Object oSearch_bn is a ButtonSub
45615>>>>>        set label to "€&¤˜ã«ž©ž" 
45616>>>>>        Set Location to 114 317
45617>>>>>
45617>>>>>        //AB-StoreStart
45617>>>>>        Procedure OnClick
45619>>>>>            Send Search To (oSelList(current_object))
45620>>>>>        End_Procedure
45621>>>>>        //AB-StoreEnd
45621>>>>>
45621>>>>>    End_Object    // oSearch_bn
45622>>>>>
45622>>>>>
45622>>>>>    //AB-StoreStart
45622>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
45623>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
45624>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
45625>>>>>    //AB-StoreEnd
45625>>>>>
45625>>>>>End_Object    // sl026a
45626>>>>>
45626>>>>>//AB/ End_Object    // prj
45626>>>Use sl029.sl
INCLUDING FILE: SL029.SL
45626>>>>>//AB/ Project Wtypkin : sl029
45626>>>>>//AB/ Object prj is a Lookup_Project
45626>>>>>//AB/     Set ProjectName to "Wtypkin : sl029"
45626>>>>>//AB/     Set ProjectFileName to "sl029.SL"
45626>>>>>
45626>>>>>// Project Object Structure
45626>>>>>//   sl029 is a dbModalPanelSub
45626>>>>>//     Wtypkin_DD is a DataDictionary
45626>>>>>//     oSelList is a dbListSub
45626>>>>>//     oOK_bn is a ButtonSub
45626>>>>>//     oCancel_bn is a ButtonSub
45626>>>>>//     oSearch_bn is a ButtonSub
45626>>>>>
45626>>>>>// Register all objects
45626>>>>>Register_Object oCancel_bn
45626>>>>>Register_Object oOK_bn
45626>>>>>Register_Object oSearch_bn
45626>>>>>Register_Object oSelList
45626>>>>>Register_Object sl029
45626>>>>>Register_Object Wtypkin_DD
45626>>>>>
45626>>>>>
45626>>>>>//AB-IgnoreStart
45626>>>>>
45626>>>>>Use DFAllEnt.pkg
45626>>>>>Use dbList.Sub
45626>>>>>Use Button.Sub
45626>>>>>
45626>>>>>
45626>>>>>Use WTYPKIN.DD
45626>>>>>
45626>>>>>//AB-IgnoreEnd
45626>>>>>
45626>>>>>CD_Popup_Object sl029 is a dbModalPanelSub
45645>>>>>    set label to "‰ ¤ã©œ ª €§¦Ÿã¡žª" 
45646>>>>>    Set Size to 148 480
45647>>>>>    Set Location to 12 16
45648>>>>>    Set Exit_Application_Local_State to FALSE
45649>>>>>    Set Modal_State to FALSE
45650>>>>>
45650>>>>>    //AB-DDOStart
45650>>>>>
45650>>>>>    Object Wtypkin_DD is a Wtypkin_DataDictionary
45652>>>>>    End_Object    // Wtypkin_DD
45653>>>>>
45653>>>>>    Set Main_DD to (Wtypkin_DD(self))
45654>>>>>    Set Server to (Wtypkin_DD(self))
45655>>>>>
45655>>>>>    //AB-DDOEnd
45655>>>>>
45655>>>>>    Object oSelList is a dbListSub
45657>>>>>        Set Main_File to Wtypkin.File_Number
45658>>>>>        Set Size to 105 465
45659>>>>>        Set Location to 6 6
45660>>>>>
45660>>>>>        Begin_Row
45663>>>>>            Entry_Item Wtypkin.Wtypkin_code
45664>>>>>            Entry_Item Wtypkin.Wtypkin_descr
45665>>>>>            Entry_Item Wtypkin.Wtypkin_anti
45666>>>>>        End_Row
45671>>>>>
45671>>>>>        Set Form_Width    item 0 to 43
45672>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
45673>>>>>        
45673>>>>>        Set Form_Width    item 1 to 293
45674>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã ‰å¤ž©žª" 
45675>>>>>        
45675>>>>>        Set Form_Width    item 2 to 120
45676>>>>>        set header_label  item 2 to "„¤›œ ¥ž" 
45677>>>>>        
45677>>>>>    End_Object    // oSelList
45678>>>>>
45678>>>>>    Object oOK_bn is a ButtonSub
45680>>>>>        set label to "&„§ ¢¦šã" 
45681>>>>>        Set Location to 114 312
45682>>>>>
45682>>>>>        //AB-StoreStart
45682>>>>>        Procedure OnClick
45684>>>>>            Send OK To (oSelList(current_object))
45685>>>>>        End_Procedure
45686>>>>>        //AB-StoreEnd
45686>>>>>
45686>>>>>    End_Object    // oOK_bn
45687>>>>>
45687>>>>>    Object oCancel_bn is a ButtonSub
45689>>>>>        set label to "&€¡ç¨à©ž" 
45690>>>>>        Set Location to 114 367
45691>>>>>
45691>>>>>        //AB-StoreStart
45691>>>>>        Procedure OnClick
45693>>>>>            Send Cancel To (oSelList(current_object))
45694>>>>>        End_Procedure
45695>>>>>        //AB-StoreEnd
45695>>>>>
45695>>>>>    End_Object    // oCancel_bn
45696>>>>>
45696>>>>>    Object oSearch_bn is a ButtonSub
45698>>>>>        set label to "€&¤˜ã«ž©ž" 
45699>>>>>        Set Location to 114 422
45700>>>>>
45700>>>>>        //AB-StoreStart
45700>>>>>        Procedure OnClick
45702>>>>>            Send Search To (oSelList(current_object))
45703>>>>>        End_Procedure
45704>>>>>        //AB-StoreEnd
45704>>>>>
45704>>>>>    End_Object    // oSearch_bn
45705>>>>>
45705>>>>>
45705>>>>>    //AB-StoreStart
45705>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
45706>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
45707>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
45708>>>>>    //AB-StoreEnd
45708>>>>>
45708>>>>>CD_End_Object    // sl029
45710>>>>>>
45710>>>>>
45710>>>>>//AB/ End_Object    // prj
45710>>>Use sl029a.sl
45710>>>Use sl031.sl
INCLUDING FILE: SL031.SL
45710>>>>>//AB/ Project SL031:BTYPKIN
45710>>>>>//AB/     Object prj is a Lookup_Project
45710>>>>>//AB/         Set ProjectName to "SL031:BTYPKIN"
45710>>>>>//AB/         Set ProjectFileName to "SL031.SL"
45710>>>>>
45710>>>>>// Project Object Structure
45710>>>>>//   SL031 is a dbModalPanelSub
45710>>>>>//     Btypkin_DD is a DataDictionary
45710>>>>>//     oSelList is a dbListSub
45710>>>>>//     oOK_bn is a ButtonSub
45710>>>>>//     oCancel_bn is a ButtonSub
45710>>>>>//     oSearch_bn is a ButtonSub
45710>>>>>
45710>>>>>// Register all objects
45710>>>>>Register_Object Btypkin_DD
45710>>>>>Register_Object oCancel_bn
45710>>>>>Register_Object oOK_bn
45710>>>>>Register_Object oSearch_bn
45710>>>>>Register_Object oSelList
45710>>>>>Register_Object SL031
45710>>>>>
45710>>>>>
45710>>>>>    //AB-IgnoreStart
45710>>>>>
45710>>>>>    Use DFAllEnt.pkg
45710>>>>>    Use dbList.Sub
45710>>>>>    Use Button.Sub
45710>>>>>
45710>>>>>
45710>>>>>    Use BTYPKIN.DD
INCLUDING FILE: BTYPKIN.DD
45710>>>>>>>//DDB-FileStart
45710>>>>>>>//DDB-HeaderStart
45710>>>>>>>
45710>>>>>>>// File Name : BTYPKIN.DD
45710>>>>>>>// Class Name: Btypkin_DataDictionary
45710>>>>>>>// Revision  : 108
45710>>>>>>>// Version   : 2
45710>>>>>>>
45710>>>>>>>Use  Windows           // Basic Definitions
45710>>>>>>>Use  DataDict          // DataDictionary Class Definition
45710>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
45710>>>>>>>
45710>>>>>>>Open Btypkin
45712>>>>>>>Open Bflagkin
INCLUDING FILE: BFLAGKIN.FD
45714>>>>>>>Open Bkinkat
45716>>>>>>>Open Barticl
INCLUDING FILE: BARTICL.FD
45718>>>>>>>Open Sysrecb
45720>>>>>>>
45720>>>>>>>//DDB-HeaderEnd
45720>>>>>>>//DDB-ValidationStart
45720>>>>>>>
45720>>>>>>>//DDB/ ExternalValidationTable Bfile_VT  Baxio.pkg
45720>>>>>>>
45720>>>>>>>Register_Object Bfile_VT
45720>>>>>>>Register_Object Btypkin_Btypkin_Anti_Xp_VT
45720>>>>>>>Use Baxio.pkg        // Bfile_VT
45720>>>>>>>
45720>>>>>>>Object Btypkin_Btypkin_Anti_Xp_VT  is a DescriptionValidationTable
45722>>>>>>>
45722>>>>>>>    Procedure Fill_List
45724>>>>>>>        Forward Send Fill_List
45726>>>>>>>        Send Add_Table_Value  "1"  "•¨œé¤œ«˜ "
45727>>>>>>>        Send Add_Table_Value  "2"  " ©«é¤œ«˜ "
45728>>>>>>>    End_Procedure    // Fill_List
45729>>>>>>>    //DDB-ValidationCustomStart
45729>>>>>>>    //DDB-ValidationCustomEnd
45729>>>>>>>End_Object   // Btypkin_Btypkin_Anti_Xp_VT
45730>>>>>>>//DDB-ValidationEnd
45730>>>>>>>//DDB-SelectionStart
45730>>>>>>>//DDB/ ExternalSelectionList SL031  SL031.SL
45730>>>>>>>//DDB/ ExternalSelectionList sl007  sl007.SL
45730>>>>>>>//DDB/ ExternalSelectionList sl007r  sl007r.SL
45730>>>>>>>Register_Object SL031
45730>>>>>>>Register_Object sl007
45730>>>>>>>Register_Object sl007r
45730>>>>>>>//DDB-SelectionEnd
45730>>>>>>>
45730>>>>>>>// JSJSJSJS 24/01/2001 Register_Object SL056 //¢å©«˜ gplan
45730>>>>>>>//Register_Object SL056 //¢å©«˜ vendor
45730>>>>>>>
45730>>>>>>>
45730>>>>>>>Open SysCurXr
45732>>>>>>>
45732>>>>>>>Open Barticl //©œ«á¨œ  prompt objects
45734>>>>>>>// JSJSJSJS 24/01/2001 Open Gtypkin //™¨å©¡œ  rec0 ©«ž¤ update, externalyy updated, lock on save
45734>>>>>>>//Open Ctypkin //™¨å©¡œ  rec0 ©«ž¤ update, externalyy updated, lock on save
45734>>>>>>>//Open Vtypkin //™¨å©¡œ  rec0 ©«ž¤ update, externalyy updated, lock on save
45734>>>>>>>
45734>>>>>>>
45734>>>>>>>// JSJSJSJS 24/01/2001 Use SL056.SL //¢å©«˜ gplan
45734>>>>>>>//Use SL102.SL //¢å©«˜ customer
45734>>>>>>>//Use SL???.SL //¢å©«˜ vendor
45734>>>>>>>Use sl100.sl // Clients selection list
45734>>>>>>>
45734>>>>>>>//*********************************************************************************
45734>>>>>>>//*          A N A L Y S I S                                                      *
45734>>>>>>>//*********************************************************************************
45734>>>>>>>//† ¡áŸœ ¡å¤ž©ž ˜¥ ¦š¨á­à¤ ˜§¦«œ¢œå £å˜ ©¬¤˜¢¢˜šã.
45734>>>>>>>//„§¦£â¤àª ¦¨åœ«˜  £¦¤¦©ã£˜¤«˜ â¤˜ª ©¬¤˜¢¢˜©æ£œ¤¦ª
45734>>>>>>>
45734>>>>>>>//’é¨˜, ¦  › á­¦¨¦  «ç§¦  ©¬¤˜¢¢˜©¦£â¤à¤ §¦¬ ¬§¦©«ž¨åœ  «¦ ©ç©«ž£˜ ©ã£œ¨˜, œå¤˜ 
45734>>>>>>>//¦  œ¥ãª : 1  "Š¦š˜¨ ˜©£æª ‚Š : contsrained ¢å©«˜ gplan apo-eos Btypkin.Gplan_Code_Apo
45734>>>>>>>//                                                               Btypkin.Gplan_Code_Apo
45734>>>>>>>//                               ©«ž¤ §œ¨å§«à©ž ˜¬«ã, ¦ ¢¦š˜¨ ˜©£æª §¦¬ Ÿ˜ œ§ ¢œšœå
45734>>>>>>>//                               ©«¦ barticl, Ÿ˜ "­áœ " «ž¤ ®¨âà©ž/§å©«à©ž §¦¬ â®¦¬£œ
45734>>>>>>>//                               ›ž¢é©œ  ©«¦ §œ›å¦ Btypkin.Btypkin_Anti_Xp.
45734>>>>>>>//          2  "œ¢á«žª        : ¢å©«˜ customer
45734>>>>>>>//          3  "¨¦£žŸœ¬«ãª    : ¢å©«˜ vendor
45734>>>>>>>//          4  "Š¦ §¦å         : œá¤ «¦ modula ˜¥ ¦š¨á­à¤ §¦¬¢žŸœå ˜¬«æ¤¦£˜,
45734>>>>>>>//                               «æ«œ «¦¤ ©¬¤˜¢¢˜©æ£œ¤¦ ˜§¢éª «¦¤ §¢ž¡«¨¦¢¦š¦ç£œ.
45734>>>>>>>
45734>>>>>>>//† ©¬¤˜¢¢˜šã šå¤œ«˜  £œ ˜¥ æš¨˜­˜, á¨˜ §¨â§œ  ¤˜ š¤à¨å¦¬£œ œá¤ Ÿ˜ › ˜¡ ¤ã©¦¬£œ
45734>>>>>>>//£æ¤¦¤ 1 «ç§¦ ˜¥ ¦š¨á­à¤, ã §¦¢¢¦çª (§œ›å¦ Btypkin.Baxiokat_Code).
45734>>>>>>>//„á¤ ˜¬«æ œå¤˜  0, «æ«œ ©«¦ grid «¦¬ bmove ¦ user £˜ª ›ž¢é¤œ  baxiokat,
45734>>>>>>>//˜¢¢¦ éª «¦ §œ›å¦ œå¤˜  ¡¢œ ›à£â¤¦.
45734>>>>>>>
45734>>>>>>>Class Btypkin_DataDictionary  is a DataDictionary_Sec
45735>>>>>>>
45735>>>>>>>    Procedure Construct_Object
45736>>>>>>>              Forward Send Construct_Object
45738>>>>>>>
45738>>>>>>>              //object id «é¤ ddo servers š ˜ «á barticl+bmove+baxio+baxiokat
45738>>>>>>>              //©œ«á¨¦¤«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
45738>>>>>>>              //®¨ž© £œç¦¬¤ ©«ž¤ private.exit_btypkin_code
45738>>>>>>>              //š ˜ ¤˜ ©œ«á¨¦¬¤ «¦ visual interface
45738>>>>>>>              Property Integer piBarticl_dd  0
45739>>>>>>>              Property Integer piBmove_dd    0
45740>>>>>>>              Property Integer piBaxio_dd    0
45741>>>>>>>              Property Integer piBaxiokat_dd 0
45742>>>>>>>              Property Integer piMustNOTConstrain Public 0
45743>>>>>>>    End_Procedure   //construct_object
45744>>>>>>>
45744>>>>>>>//      //private
45744>>>>>>>//      //¡˜¢œå«˜  ˜§¦ «ž¤ private.Exit_Btypkin_Code
45744>>>>>>>//      Procedure private.Set_Prompt_Objects_of_all_Connected_DEOs Integer liPrompt_Object_id ;
45744>>>>>>>//                                                                 Integer liField            ;
45744>>>>>>>//                                                                 Integer iMustConstrain     ;
45744>>>>>>>//                                                                 String  sPelProm
45744>>>>>>>//                Integer iMax iCount iDEO liTemp liBarticl_dd iPelListID
45744>>>>>>>
45744>>>>>>>//                Move (sl100(Self)) to iPelListID
45744>>>>>>>//             //   den exei nohma giati den kanoyn tipota sthn lista
45744>>>>>>>//             //   If (iPelListID) Set piMustConstrain     Of iPelListID to 0
45744>>>>>>>//             //   If (iPelListID) Set psIsPromhtheyths    Of iPelListID to ''
45744>>>>>>>
45744>>>>>>>//                Get piBarticl_dd to liBarticl_dd
45744>>>>>>>//                If (liBarticl_dd <> 0);
45744>>>>>>>//                Begin //œá¤ æ¤«àª ¬§á¨®œ  client ddo £œ main file «¦ barticl
45744>>>>>>>//                     Get Data_Set_User_Interface_Count of liBarticl_dd to iMax
45744>>>>>>>//                     Decrement iMax
45744>>>>>>>//                     For iCount from 0 to iMax
45744>>>>>>>//                         Move (Data_Set_User_Interface(liBarticl_dd ,iCount)) to iDEO
45744>>>>>>>//                         Get Data_Field of iDEO Item 0 to liTemp
45744>>>>>>>//                         If (liTemp = liField);
45744>>>>>>>//                         Begin //œá¤ ™¨ž¡˜ deo (dfform?) §¦¬ ˜¤˜­â¨œ«˜  ©«¦ §œ›å¦ ©¬¤˜¢¢˜©æ£œ¤¦ª
45744>>>>>>>//                            If (liPrompt_Object_id <> 0);
45744>>>>>>>//                               Begin
45744>>>>>>>//                                  Set Prompt_Object      of iDEO to liPrompt_Object_id
45744>>>>>>>//                                  Set Prompt_Button_Mode of iDEO to PB_promptOn
45744>>>>>>>//                                  If (iMustConstrain) Begin
45744>>>>>>>//                                  //   den exei nohma giati den kanoyn tipota sthn lista
45744>>>>>>>//                                  //  If (liPrompt_Object_id) Set piMustConstrain     Of liPrompt_Object_id to iMustConstrain
45744>>>>>>>//                                  //  If (liPrompt_Object_id) Set psIsPromhtheyths    Of liPrompt_Object_id to sPelProm
45744>>>>>>>//                                  End
45744>>>>>>>//                            End
45744>>>>>>>//                            Else Begin
45744>>>>>>>//                                Set Prompt_Object      of iDEO to 0
45744>>>>>>>//                                Set Prompt_Button_Mode of iDEO to PB_promptOff
45744>>>>>>>//                            End
45744>>>>>>>//                         End
45744>>>>>>>//                     Loop
45744>>>>>>>//                End
45744>>>>>>>//      End_Procedure //private.set_prompt_objects_of_all_connected_dEOS
45744>>>>>>>
45744>>>>>>>
45744>>>>>>>//    //private
45744>>>>>>>//    //¡˜¢œå«˜  ˜§æ: iexit «¦¬ btypkin_code
45744>>>>>>>//    //¡˜¢œå    «ã¤: private.Set_Prompt_Objects_of_all_Connected_DEOS
45744>>>>>>>//    //©œ«á¨œ      : «á prompt objects š ˜ «¦ barticl_anti, ˜¤á¢¦š˜ £œ «¦ btypkin_anti.
45744>>>>>>>//    Procedure private.Exit_Btypkin_Code Integer liField Integer liBtypkin_Code
45744>>>>>>>//              Integer liBtypkin_Anti1 liBaxiokat_Num liBtypkin_Anti2
45744>>>>>>>//              Integer liBaxiokat_dd liBarticl_dd
45744>>>>>>>//              String lsBarticlCode1
45744>>>>>>>
45744>>>>>>>//            // btypkin_anti
45744>>>>>>>//            // "-1" "ƒâ¤ “§á¨®œ "
45744>>>>>>>//            // "0"  "Data Entry"
45744>>>>>>>//            // "1"  "Š¦š˜¨ ˜©£é¤ ‚Š"
45744>>>>>>>//            // "2"  "”¦¨â˜ª"
45744>>>>>>>//            // "3"  "¨¦£žŸœ¬«é¤"
45744>>>>>>>//            // "5"  "Ž ‘¬¤˜¢¢˜©æ£œ¤¦ª"
45744>>>>>>>//            // "6"  "’œ¢.˜¨˜¢ã§«žª"
45744>>>>>>>
45744>>>>>>>
45744>>>>>>>
45744>>>>>>>//              Get Field_Current_Value Field Btypkin.Btypkin_Anti1 to liBtypkin_Anti1
45744>>>>>>>//              Get Field_Current_Value Field Btypkin.Btypkin_Anti2 to liBtypkin_Anti2
45744>>>>>>>//              Case Begin
45744>>>>>>>//                   Case (liBtypkin_Anti1 = 1) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ š¢
45744>>>>>>>//                         Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0 Field Barticl.Barticl_Code1 0 ''
45744>>>>>>>//                   Case Break
45744>>>>>>>
45744>>>>>>>//                   Case (liBtypkin_Anti1 = 2) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §œ¢á«œª
45744>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code1 1 ''
45744>>>>>>>//                   Case Break
45744>>>>>>>
45744>>>>>>>//                   Case (liBtypkin_Anti1 = 3) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §¨¦£žŸœ¬«âª=> ¢ ©«˜ §œ¢˜«à¤
45744>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code1 1 '1'
45744>>>>>>>//                   Case Break
45744>>>>>>>
45744>>>>>>>//                   Case Else //=4 ¢¦ §¦å:©¬¤˜¢¢˜©æ£œ¤¦ª £œ user manual data entry
45744>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0  Field Barticl.Barticl_Code1 0 ''
45744>>>>>>>//                   Case Break
45744>>>>>>>//              Case End
45744>>>>>>>
45744>>>>>>>//              Case Begin
45744>>>>>>>//                   Case (liBtypkin_Anti2 = 1) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ š¢
45744>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0 Field Barticl.Barticl_Code2 0 ''
45744>>>>>>>//                   Case Break
45744>>>>>>>
45744>>>>>>>//                   Case (liBtypkin_Anti2 = 2) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §œ¢á«œª
45744>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code2 1 ''
45744>>>>>>>//                   Case Break
45744>>>>>>>
45744>>>>>>>//                   Case (liBtypkin_Anti2 = 3) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §¨¦£žŸœ¬«âª=> Š ©«˜ œ¢˜«é¤
45744>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code2 1 '1'
45744>>>>>>>//                   Case Break
45744>>>>>>>
45744>>>>>>>//                   Case Else //=4 ¢¦ §¦å:©¬¤˜¢¢˜©æ£œ¤¦ª £œ user manual data entry
45744>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0  Field Barticl.Barticl_Code2 0 ''
45744>>>>>>>//                   Case Break
45744>>>>>>>//              Case End
45744>>>>>>>//    End_Procedure //private.exit_btypkin_code
45744>>>>>>>
45744>>>>>>>//    // New_Current_Record:
45744>>>>>>>
45744>>>>>>>//    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
45744>>>>>>>//        Integer liBtypkinCodeFldNum
45744>>>>>>>//        Forward Send New_Current_Record  iOldRec iNewRec
45744>>>>>>>//        Get_FieldNumber Btypkin.Btypkin_Code to liBtypkinCodeFldNum
45744>>>>>>>//        Send private.Exit_Btypkin_Code liBtypkinCodeFldNum Btypkin.Btypkin_Code
45744>>>>>>>//        // Insert Code Here
45744>>>>>>>//    End_Procedure   // New_Current_Record
45744>>>>>>>
45744>>>>>>>
45744>>>>>>>    //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
45744>>>>>>>    //™) ˜¤áš¤à©ž properties
45744>>>>>>>    //š) › ˜®œå¨ ©ž calculated §œ›åà¤
45744>>>>>>>    //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
45744>>>>>>>    //œ) œ¤ž£â¨à©ž properties after
45744>>>>>>>    Procedure Update
45745>>>>>>>
45745>>>>>>>              Forward Send Update
45747>>>>>>>
45747>>>>>>>              //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
45747>>>>>>>                Move SysCurXR.Company_Code  to Btypkin.Company_Code
45748>>>>>>>                Move SysCurXR.Branch_Code   to Btypkin.Branch_Code
45749>>>>>>>                Move SysCurXR.Year_Year     to Btypkin.Year_Year
45750>>>>>>>                Move SysCurXR.Year_Recr     to Btypkin.Year_Recr
45751>>>>>>>
45751>>>>>>>              //™) ˜¤áš¤à©ž properties
45751>>>>>>>
45751>>>>>>>              //š) › ˜®œå¨ ©ž calculated §œ›åà¤
45751>>>>>>>              //š.1:Gplan_Code_Apo1 (conditional)
45751>>>>>>>              //š.2:Gplan_Code_Eos1 (conditional)
45751>>>>>>>              If (Btypkin.Btypkin_Anti1 <> 1);              Begin //æ®  ˜§¦ šœ¤ ¡ã ¢¦š ©« ¡ã
45753>>>>>>>                   Move "" to Btypkin.Gplan_Code_Apo1
45754>>>>>>>                   Move "" to Btypkin.Gplan_Code_Eos1
45755>>>>>>>              End
45755>>>>>>>>
45755>>>>>>>
45755>>>>>>>              //š.3:Gplan_Code_Apo2 (conditional)
45755>>>>>>>              //š.4:Gplan_Code_Eos2 (conditional)
45755>>>>>>>              If (Btypkin.Btypkin_Anti2 <> 1);              Begin //æ®  ˜§¦ šœ¤ ¡ã ¢¦š ©« ¡ã
45757>>>>>>>                   Move "" to Btypkin.Gplan_Code_Apo2
45758>>>>>>>                   Move "" to Btypkin.Gplan_Code_Eos2
45759>>>>>>>              End
45759>>>>>>>>
45759>>>>>>>
45759>>>>>>>              //š.3:gtypkin_rec0 (conditional)
45759>>>>>>>              Case Begin
45759>>>>>>>                   Case (Btypkin.Gtypkin_Code <> 0) //œ¤ž£œ¨é¤œ  šœ¤ ¡ã ¢¦š ©« ¡ã
45761>>>>>>>//jsjsjs 24/01/2001
45761>>>>>>>//                         Clear Gtypkin
45761>>>>>>>//                         Move Btypkin.Company_Code to Gtypkin.Company_Code
45761>>>>>>>//                         Move Btypkin.Branch_Code  to Gtypkin.Branch_Code
45761>>>>>>>//                         Move Btypkin.Year_Year    to Gtypkin.Year_Year
45761>>>>>>>//                         Move Btypkin.Gtypkin_Code to Gtypkin.Gtypkin_Code
45761>>>>>>>//                         Find Eq Gtypkin by Index.1 //company_code+branch_code+year_year+gtypkin_code
45761>>>>>>>//                         If (Found = 1) Move Gtypkin.Gtypkin_Rec0 to Btypkin.Gtypkin_Rec0
45761>>>>>>>//                         Else           Send Operation_Not_Allowed 3001 //›â¤ ™¨âŸž¡œ «¦ gtypkin_rec0, please reindex
45761>>>>>>>//jsjsjs 24/01/2001
45761>>>>>>>                   Case Break
45762>>>>>>>                   Case Else                        //›â¤ œ¤ž£œ¨é¤œ  šœ¤ ¡ã ¢¦š ©« ¡ã
45762>>>>>>>                         Move 0 to Btypkin.Gtypkin_Rec0
45763>>>>>>>              Case End
45763>>>>>>>
45763>>>>>>>              //š.4:ctypkin_rec0 (conditional)
45763>>>>>>>              Case Begin
45763>>>>>>>                   Case (Btypkin.Ctypkin_Code <> 0) //œ¤ž£œ¨é¤œ  §œ¢á«œª
45765>>>>>>>                         Clear Ctypkin
45766>>>>>>>                         Move Btypkin.Company_Code to Ctypkin.Company_Code
45767>>>>>>>                         Move Btypkin.Branch_Code  to Ctypkin.Branch_Code
45768>>>>>>>                         Move Btypkin.Year_Year    to Ctypkin.Year_Year
45769>>>>>>>                         Move Btypkin.Ctypkin_Code to Ctypkin.Ctypkin_Code
45770>>>>>>>                         Find Eq Ctypkin by Index.1 //company_code+branch_code+year_year+Ctypkin_code
45771>>>>>>>>
45771>>>>>>>                         If (Found = 1) Begin
45773>>>>>>>                            Move Ctypkin.Ctypkin_Rec0 to Btypkin.Ctypkin_Rec0
45774>>>>>>>                            Move Ctypkin.Ctypkin_Recr to Btypkin.Ctypkin_Recr
45775>>>>>>>                         End
45775>>>>>>>>
45775>>>>>>>                         Else           Send Operation_Not_Allowed 3002 //›â¤ ™¨âŸž¡œ «¦ Ctypkin_rec0, please reindex
45777>>>>>>>                   Case Break
45778>>>>>>>                   Case Else                        //›â¤ œ¤ž£œ¨é¤œ  §œ¢á«œª
45778>>>>>>>                         Move  0 to Btypkin.Ctypkin_Rec0
45779>>>>>>>                         Move '' to Btypkin.Ctypkin_Recr
45780>>>>>>>              Case End
45780>>>>>>>
45780>>>>>>>              //š.5:vtypkin_rec0 (conditional)
45780>>>>>>>              Case Begin
45780>>>>>>>                   Case (Btypkin.Vtypkin_Code <> 0) //œ¤ž£œ¨é¤œ  §¨¦£žŸœ¬«âª
45782>>>>>>>                         //Clear Vtypkin
45782>>>>>>>                         //Move Btypkin.Company_Code to Vtypkin.Company_Code
45782>>>>>>>                         //Move Btypkin.Branch_Code  to Vtypkin.Branch_Code
45782>>>>>>>                         //Move Btypkin.Year_Year    to Vtypkin.Year_Year
45782>>>>>>>                         //Move Btypkin.Vtypkin_Code to Vtypkin.Vtypkin_Code
45782>>>>>>>                         //Find Eq Vtypkin by Index.1 //company_code+branch_code+year_year+Vtypkin_code
45782>>>>>>>                         //If (Found = 1) Move Vtypkin.Vtypkin_Rec0 to Btypkin.Vtypkin_Rec0
45782>>>>>>>                         //Else           Send Operation_Not_Allowed 3003 //›â¤ ™¨âŸž¡œ «¦ Vtypkin_rec0, please reindex
45782>>>>>>>                   Case Break
45783>>>>>>>                   Case Else                        //›â¤ œ¤ž£œ¨é¤œ  §¨¦£žŸœ¬«âª
45783>>>>>>>                         Move 0 to Btypkin.Vtypkin_Rec0
45784>>>>>>>              Case End
45784>>>>>>>
45784>>>>>>>              //š.6:btypkin_l_hmnia (conditional)
45784>>>>>>>              If (Btypkin.Btypkin_L_No = 0) Move 0 to Btypkin.Btypkin_L_Hmnia
45787>>>>>>>
45787>>>>>>>
45787>>>>>>>              //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
45787>>>>>>>
45787>>>>>>>              //œ) œ¤ž£â¨à©ž properties after
45787>>>>>>>    End_Procedure //update
45788>>>>>>>
45788>>>>>>>    Procedure Creating
45789>>>>>>>              Forward Send Creating
45791>>>>>>>              //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBtypkin //˜¨ Ÿ£æª á¨Ÿ¨à¤ «žª ®¨ã©žª
45791>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Btypkin.Btypkin_Rec0)))))) to Btypkin.Btypkin_Recr
45792>>>>>>>    End_Procedure //creating
45793>>>>>>>
45793>>>>>>>//    Procedure OnConstrain
45793>>>>>>>//        Set piMustNOTConstrain to True
45793>>>>>>>        
45793>>>>>>>//        If (piMustNOTConstrain(Self)) Begin
45793>>>>>>>//        End
45793>>>>>>>//        Else Begin
45793>>>>>>>//            Constrain Btypkin.Company_Code  eq SysCurXR.Company_Code
45793>>>>>>>//            Constrain Btypkin.Branch_Code   eq SysCurXR.Branch_Code
45793>>>>>>>//            Constrain Btypkin.Year_Year     eq SysCurXR.Year_Year
45793>>>>>>>//        End
45793>>>>>>>//    End_Procedure
45793>>>>>>>
45793>>>>>>>
45793>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
45794>>>>>>>              String lsError_Message
45795>>>>>>>              Case Begin
45795>>>>>>>                   //˜§æ validate save
45795>>>>>>>                   Case (iError_Num = 1001)
45797>>>>>>>                        //Move ("DDC 141:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n† «¨¦§¦§¦åž©ž œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");
45797>>>>>>>                        //to lsError_Message
45797>>>>>>>                   Case Break
45798>>>>>>>                   Case (iError_Num = 1100)
45801>>>>>>>                        Move "DDC 141:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
45802>>>>>>>                        Case Break
45803>>>>>>>
45803>>>>>>>                   //˜§æ validate delete
45803>>>>>>>                   Case (iError_Num = 2001)
45806>>>>>>>                        //Clear Codemast
45806>>>>>>>                        //Move ("DDC 141:€›ç¤˜«ž ž › ˜š¨˜­ã !\n\n† › ˜š¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");
45806>>>>>>>                        //to lsError_Message
45806>>>>>>>                   Case Break
45807>>>>>>>                   Case (iError_Num = 2100)
45810>>>>>>>                        Move "DDC 141:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
45811>>>>>>>                        Case Break
45812>>>>>>>
45812>>>>>>>                   //˜§æ update
45812>>>>>>>                   Case (iError_Num = 3001)
45815>>>>>>>                        Move ("DDC 141:ƒâ¤ ™¨âŸž¡œ ž ˜¤«å©«¦ ®ž ¡å¤ž©ž «žª ‚œ¤ ¡ãª Š¦š ©« ¡ãª !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
45816>>>>>>>                   Case Break
45817>>>>>>>                   Case (iError_Num = 3002)
45820>>>>>>>                        Move ("DDC 141:ƒâ¤ ™¨âŸž¡œ ž ˜¤«å©«¦ ®ž ¡å¤ž©ž «é¤ œ¢˜«é¤ !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
45821>>>>>>>                   Case Break
45822>>>>>>>                   Case (iError_Num = 3003)
45825>>>>>>>                        Move ("DDC 141:ƒâ¤ ™¨âŸž¡œ ž ˜¤«å©«¦ ®ž ¡å¤ž©ž «é¤ ¨¦£žŸœ¬«é¤ !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
45826>>>>>>>                   Case Break
45827>>>>>>>
45827>>>>>>>
45827>>>>>>>
45827>>>>>>>                   Case Else
45827>>>>>>>                        Forward Send Operation_Not_Allowed iError_Num
45829>>>>>>>              Case End
45829>>>>>>>
45829>>>>>>>              Error iError_Num lsError_Message
45830>>>>>>>>
45830>>>>>>>    End_Procedure // operation_not_allowed
45831>>>>>>>
45831>>>>>>>
45831>>>>>>>//    //1001:
45831>>>>>>>//    //˜§˜š¦¨œçœ«˜  «¦ btypkin ¤˜ ˜¢¢áœ  parent year
45831>>>>>>>//    Function Validate_Save Returns Integer
45831>>>>>>>//             Integer iReturnVal
45831>>>>>>>
45831>>>>>>>//             Forward Get Validate_Save to iReturnVal
45831>>>>>>>
45831>>>>>>>//             If (Not(iReturnVal));
45831>>>>>>>//             Begin
45831>>>>>>>//                  //1100:cby = globals
45831>>>>>>>//                  If ( ;
45831>>>>>>>//                      (Not(Btypkin.Company_Code = SysCurXR.Company_Code))or ;
45831>>>>>>>//                      (Not(Btypkin.Branch_Code  = SysCurXR.Branch_Code)) or ;
45831>>>>>>>//                      (Not(Btypkin.Year_Year    = SysCurXR.Year_Year))      ;
45831>>>>>>>//                      )                                                   Send Operation_Not_Allowed 1100
45831>>>>>>>//             End //«â¢¦ª ¡é› ¡˜ validation
45831>>>>>>>//             Function_Return iReturnVal
45831>>>>>>>//    End_Function   // validate_save
45831>>>>>>>
45831>>>>>>>
45831>>>>>>>//    //2001:
45831>>>>>>>//    Function Validate_Delete  Returns Integer
45831>>>>>>>//             Integer iReturnVal
45831>>>>>>>//             Forward Get Validate_Delete  To iReturnVal
45831>>>>>>>//             If (Not(iReturnVal));
45831>>>>>>>//             Begin
45831>>>>>>>
45831>>>>>>>//                  //2100:cby = globals
45831>>>>>>>//                  If ( ;
45831>>>>>>>//                      (Not(Btypkin.Company_Code = SysCurXR.Company_Code))or ;
45831>>>>>>>//                      (Not(Btypkin.Branch_Code  = SysCurXR.Branch_Code)) or ;
45831>>>>>>>//                      (Not(Btypkin.Year_Year    = SysCurXR.Year_Year))      ;
45831>>>>>>>//                      )                                                   Send Operation_Not_Allowed 2100
45831>>>>>>>//             End //«â¢¦ª ¡é› ¡˜ validation
45831>>>>>>>//             Function_Return iReturnVal
45831>>>>>>>//    End_Function   // Validate_Delete
45831>>>>>>>
45831>>>>>>>
45831>>>>>>>    Procedure Define_Fields
45832>>>>>>>        Forward Send Define_Fields
45834>>>>>>>        //DDB-Generated-Code-Location
45834>>>>>>>        //DDB-DefineFieldStart
45834>>>>>>>
45834>>>>>>>        Set Main_File            To Btypkin.File_Number
45835>>>>>>>        Set Cascade_Delete_State To FALSE
45836>>>>>>>
45836>>>>>>>
45836>>>>>>>        // Child (Client) file structure................
45836>>>>>>>        Send Add_Client_File  Bflagkin.File_Number
45837>>>>>>>        Send Add_Client_File  Bkinkat.File_Number
45838>>>>>>>        Send Add_Client_File  Barticl.File_Number
45839>>>>>>>
45839>>>>>>>        // External (System) file structure.............
45839>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
45840>>>>>>>
45840>>>>>>>        Define_Auto_Increment  Sysrecb.Btypkin_Rec0  To Btypkin.Btypkin_Rec0
45843>>>>>>>
45843>>>>>>>        // Field-based properties.......................
45843>>>>>>>
45843>>>>>>>        // Btypkin.Company_Code
45843>>>>>>>        //DDB/ Comment_Short       Field Btypkin.Company_Code To "„¤ž£œ¨é¤œ«˜  ©«ž¤ update"
45843>>>>>>>
45843>>>>>>>        // Btypkin.Branch_Code
45843>>>>>>>        //DDB/ Comment_Short       Field Btypkin.Branch_Code To "„¤ž£œ¨é¤œ«˜  ©«ž¤ update"
45843>>>>>>>
45843>>>>>>>        // Btypkin.Year_Year
45843>>>>>>>        //DDB/ Comment_Short       Field Btypkin.Year_Year To "„¤ž£œ¨é¤œ«˜  ©«ž¤ update"
45843>>>>>>>
45843>>>>>>>        // Btypkin.Btypkin_Code
45843>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Code To (SL031(Self))
45844>>>>>>>
45844>>>>>>>        // Btypkin.Btypkin_Rec0
45844>>>>>>>
45844>>>>>>>        // Btypkin.Btypkin_Recr
45844>>>>>>>
45844>>>>>>>        // Btypkin.Year_Recr
45844>>>>>>>
45844>>>>>>>        // Btypkin.Btypkin_Descr
45844>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Descr To (SL031(Self))
45845>>>>>>>
45845>>>>>>>        // Btypkin.Gtypkin_Code
45845>>>>>>>
45845>>>>>>>        // Btypkin.Ctypkin_Code
45845>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Ctypkin_Code To (sl007(Self))
45846>>>>>>>
45846>>>>>>>        // Btypkin.Vtypkin_Code
45846>>>>>>>
45846>>>>>>>        // Btypkin.Gtypkin_Rec0
45846>>>>>>>
45846>>>>>>>        // Btypkin.Ctypkin_Rec0
45846>>>>>>>
45846>>>>>>>        // Btypkin.Vtypkin_Rec0
45846>>>>>>>
45846>>>>>>>        // Btypkin.Btypkin_Anti1
45846>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti1 To (Bfile_VT(Self))
45847>>>>>>>
45847>>>>>>>        // Btypkin.Gplan_Code_Apo1
45847>>>>>>>
45847>>>>>>>        // Btypkin.Gplan_Code_Eos1
45847>>>>>>>
45847>>>>>>>        // Btypkin.Btypkin_Anti2
45847>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti2 To (Bfile_VT(Self))
45848>>>>>>>
45848>>>>>>>        // Btypkin.Gplan_Code_Apo2
45848>>>>>>>
45848>>>>>>>        // Btypkin.Gplan_Code_Eos2
45848>>>>>>>
45848>>>>>>>        // Btypkin.Bflagkin_Num
45848>>>>>>>
45848>>>>>>>        // Btypkin.Bkinkat_Num
45848>>>>>>>        //DDB/ Comment_Short       Field Btypkin.Bkinkat_Num To "“§¦¢¦šåœ«˜  ©«ž¤ update «¦¬ bkinkat."
45848>>>>>>>
45848>>>>>>>        // Btypkin.Btypkin_Anti_Xp
45848>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti_Xp To (Btypkin_Btypkin_Anti_Xp_VT(Self))
45849>>>>>>>
45849>>>>>>>        // Btypkin.Btypkin_Printer
45849>>>>>>>
45849>>>>>>>        // Btypkin.Btypkin_Pdescr
45849>>>>>>>
45849>>>>>>>        // Btypkin.Btypkin_Form
45849>>>>>>>
45849>>>>>>>        // Btypkin.Btypkin_L_No
45849>>>>>>>
45849>>>>>>>        // Btypkin.Btypkin_L_Hmnia
45849>>>>>>>        Set Field_Mask_Type        Field Btypkin.Btypkin_L_Hmnia To MASK_DATE_WINDOW
45850>>>>>>>
45850>>>>>>>        // Btypkin.Btypkin_Seira
45850>>>>>>>
45850>>>>>>>        // Btypkin.Btypkin_Abr
45850>>>>>>>
45850>>>>>>>        // Btypkin.Btypkin_Flag01
45850>>>>>>>        //DDB/ Comment_Short       Field Btypkin.Btypkin_Flag01 To "“§¦¢¦šåœ«˜  ©«ž¤ update/backout «¦¬ bflagkin."
45850>>>>>>>
45850>>>>>>>        // Btypkin.Btypkin_Flag02
45850>>>>>>>
45850>>>>>>>        // Btypkin.Btypkin_Flag03
45850>>>>>>>
45850>>>>>>>        // Btypkin.Btypkin_Flag04
45850>>>>>>>
45850>>>>>>>        // Btypkin.Btypkin_Flag05
45850>>>>>>>        Set Field_Checkbox_Values  Field Btypkin.Btypkin_Flag05 To "1"  "0"
45851>>>>>>>
45851>>>>>>>        // Btypkin.Btypkin_Flag06
45851>>>>>>>
45851>>>>>>>        // Btypkin.Btypkin_Flag07
45851>>>>>>>
45851>>>>>>>        // Btypkin.Btypkin_Flag08
45851>>>>>>>
45851>>>>>>>        // Btypkin.Btypkin_Flag09
45851>>>>>>>
45851>>>>>>>        // Btypkin.Btypkin_Flag10
45851>>>>>>>
45851>>>>>>>        // Btypkin.Btypkin_Flag11
45851>>>>>>>
45851>>>>>>>        // Btypkin.Btypkin_Flag12
45851>>>>>>>
45851>>>>>>>        // Btypkin.Btypkin_Flag13
45851>>>>>>>
45851>>>>>>>        // Btypkin.Btypkin_Flag14
45851>>>>>>>
45851>>>>>>>        // Btypkin.Btypkin_Flag15
45851>>>>>>>
45851>>>>>>>        // Btypkin.Btypkin_Flag16
45851>>>>>>>
45851>>>>>>>        // Btypkin.Btypkin_Flag17
45851>>>>>>>
45851>>>>>>>        // Btypkin.Btypkin_Flag18
45851>>>>>>>
45851>>>>>>>        // Btypkin.Btypkin_Flag19
45851>>>>>>>
45851>>>>>>>        // Btypkin.Btypkin_Flag20
45851>>>>>>>
45851>>>>>>>        // Btypkin.Btypkin_Sign
45851>>>>>>>        Set Field_Checkbox_Values  Field Btypkin.Btypkin_Sign To "1"  "-1"
45852>>>>>>>
45852>>>>>>>        // Btypkin.Ctypkin_Recr
45852>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Ctypkin_Recr To (sl007r(Self))
45853>>>>>>>
45853>>>>>>>        // Btypkin.Label
45853>>>>>>>
45853>>>>>>>        //DDB-DefineFieldEnd
45853>>>>>>>
45853>>>>>>>        Set Main_File            To Btypkin.File_Number
45854>>>>>>>        Set Cascade_Delete_State To FALSE
45855>>>>>>>
45855>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
45856>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
45857>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
45858>>>>>>>
45858>>>>>>>        // Child (Client) file structure................
45858>>>>>>>        Send Add_Client_File  Bflagkin.File_Number
45859>>>>>>>        Send Add_Client_File  Barticl.File_Number
45860>>>>>>>        Send Add_Client_File  Bkinkat.File_Number
45861>>>>>>>
45861>>>>>>>        // External (System) file structure.............
45861>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
45862>>>>>>>        //Send Add_System_File  Gtypkin.File_Number  DD_LOCK_ON_SAVE
45862>>>>>>>
45862>>>>>>>        Define_Auto_Increment  Sysrecb.Btypkin_Rec0  To Btypkin.Btypkin_Rec0
45865>>>>>>>
45865>>>>>>>        // Field-based properties.......................
45865>>>>>>>
45865>>>>>>>        // Btypkin.Company_Code
45865>>>>>>>
45865>>>>>>>        // Btypkin.Branch_Code
45865>>>>>>>
45865>>>>>>>        // Btypkin.Year_Year
45865>>>>>>>
45865>>>>>>>        // Btypkin.Btypkin_Code
45865>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Code     To "‰à› ¡æª ‰å¤ž©žª"
45866>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Code     To "‰å¤ž©ž"
45867>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Code     To DD_AUTOFIND    DD_REQUIRED
45868>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Code     To (sl031(Self))
45869>>>>>>>        Set Key_Field_State        Field Btypkin.Btypkin_Code     To TRUE
45870>>>>>>>
45870>>>>>>>        // Btypkin.Btypkin_Rec0
45870>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Rec0     To DD_AUTOFIND    DD_NOPUT       DD_REQUIRED
45871>>>>>>>        Set Key_Field_State        Field Btypkin.Btypkin_Rec0     To TRUE
45872>>>>>>>
45872>>>>>>>        // Btypkin.Year_Rec0
45872>>>>>>>
45872>>>>>>>        // Btypkin.Btypkin_Descr
45872>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Descr    To "œ¨ š¨˜­ã ‰å¤ž©žª"
45873>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Descr    To "œ¨ š¨˜­ã"
45874>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Descr    To (sl031(Self))
45875>>>>>>>
45875>>>>>>>        // Btypkin.Gtypkin_Code
45875>>>>>>>        Set Field_Label_Long       Field Btypkin.Gtypkin_Code     To "‰å¤ž©ž ‚Š"
45876>>>>>>>        Set Field_Label_Short      Field Btypkin.Gtypkin_Code     To "‰å¤ž©ž ‚Š"
45877>>>>>>>        //Set Field_Prompt_Object    Field Btypkin.Gtypkin_Code     To (SL055(Self))
45877>>>>>>>
45877>>>>>>>        // Btypkin.Ctypkin_Code
45877>>>>>>>        Set Field_Label_Long       Field Btypkin.Ctypkin_Code     To "‰å¤ž©ž œ¢˜«é¤"
45878>>>>>>>        Set Field_Label_Short      Field Btypkin.Ctypkin_Code     To "‰å¤ž©ž œ¢˜«é¤"
45879>>>>>>>
45879>>>>>>>        // Btypkin.Vtypkin_Code
45879>>>>>>>        Set Field_Label_Long       Field Btypkin.Vtypkin_Code     To "‰å¤ž©ž ¨¦£žŸœ¬«é¤"
45880>>>>>>>        Set Field_Label_Short      Field Btypkin.Vtypkin_Code     To "‰å¤ž©ž ¨¦£žŸœ¬«é¤"
45881>>>>>>>
45881>>>>>>>        // Btypkin.Gtypkin_Rec0
45881>>>>>>>        Set Field_Options          Field Btypkin.Gtypkin_Rec0     To DD_DISPLAYONLY
45882>>>>>>>
45882>>>>>>>        // Btypkin.Ctypkin_Rec0
45882>>>>>>>        Set Field_Options          Field Btypkin.Ctypkin_Rec0     To DD_DISPLAYONLY
45883>>>>>>>
45883>>>>>>>        // Btypkin.Vtypkin_Rec0
45883>>>>>>>        Set Field_Options          Field Btypkin.Vtypkin_Rec0     To DD_DISPLAYONLY
45884>>>>>>>
45884>>>>>>>        // Btypkin.Btypkin_Anti1
45884>>>>>>>        Set Field_Class_Name       Field Btypkin.Btypkin_Anti1    To "dbComboForm_EZ"
45885>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Anti1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª ˜§¦ ˜¨®œå¦:"
45886>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Anti1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª"
45887>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti1    To (Bfile_VT(Self))
45888>>>>>>>
45888>>>>>>>        // Btypkin.Gplan_Code_Apo1
45888>>>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Apo1  To "€§¦ ‰à› ¡æ ‚Š"
45889>>>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Apo1  To "€§¦ ‰à› ¡æ ‚Š"
45890>>>>>>>
45890>>>>>>>        // Btypkin.Gplan_Code_Eos1
45890>>>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Eos1  To "„àª ‰à› ¡æ ‚Š"
45891>>>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Eos1  To "„àª ‰à› ¡æ ‚Š"
45892>>>>>>>
45892>>>>>>>        // Btypkin.Btypkin_Anti2
45892>>>>>>>        Set Field_Class_Name       Field Btypkin.Btypkin_Anti2    To "dbComboForm_EZ"
45893>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Anti2    To "˜¨˜¢ã§«žª ˜§¦ ˜¨®œå¦:"
45894>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Anti2    To "˜¨˜¢ã§«žª"
45895>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti2    To (Bfile_VT(Self))
45896>>>>>>>
45896>>>>>>>        // Btypkin.Gplan_Code_Apo2
45896>>>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Apo2  To "€§¦ ‰à› ¡æ ‚Š"
45897>>>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Apo2  To "€§¦ ‰à› ¡æ ‚Š"
45898>>>>>>>
45898>>>>>>>        // Btypkin.Gplan_Code_Eos2
45898>>>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Eos2  To "„àª ‰à› ¡æ ‚Š"
45899>>>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Eos2  To "„àª ‰à› ¡æ ‚Š"
45900>>>>>>>
45900>>>>>>>        // Btypkin.Bflagkin_Num
45900>>>>>>>        Set Field_Label_Long       Field Btypkin.Bflagkin_Num     To "¢ãŸ¦ª Flags"
45901>>>>>>>        Set Field_Label_Short      Field Btypkin.Bflagkin_Num     To "¢ãŸ¦ª Flags"
45902>>>>>>>        Set Field_Options          Field Btypkin.Bflagkin_Num     To DD_DISPLAYONLY
45903>>>>>>>
45903>>>>>>>        // Btypkin.Bkinkat_Num
45903>>>>>>>        Set Field_Label_Long       Field Btypkin.Bkinkat_Num      To "¢ãŸ¦ª ‰˜«žš¦¨ é¤ €¥ é¤"
45904>>>>>>>        Set Field_Label_Short      Field Btypkin.Bkinkat_Num      To "¢ãŸ¦ª ‰˜«.€¥ é¤"
45905>>>>>>>        Set Field_Options          Field Btypkin.Bkinkat_Num      To DD_DISPLAYONLY
45906>>>>>>>
45906>>>>>>>        // Btypkin.Btypkin_Anti_Xp
45906>>>>>>>        Set Field_Class_Name       Field Btypkin.Btypkin_Anti_Xp  To "dbComboForm_EZ"
45907>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Anti_Xp  To "Ž ©¬¤˜¢¢˜©æ£œ¤¦ª:"
45908>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Anti_Xp  To "• ‘¬¤˜¢¢˜©¦£â¤¦¬"
45909>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti_Xp  To (Btypkin_Btypkin_Anti_Xp_VT(Self))
45910>>>>>>>
45910>>>>>>>        // Btypkin.Btypkin_Printer
45910>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Printer  To "ƒ œçŸ¬¤©ž „¡«¬§à«ã"
45911>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Printer  To "„¡«¬§à«ãª"
45912>>>>>>>
45912>>>>>>>        // Btypkin.Btypkin_Pdescr
45912>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Pdescr   To "’å«¢¦ª „¡«ç§à©žª"
45913>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Pdescr   To "’å«¢¦ª „¡«ç§à©žª"
45914>>>>>>>
45914>>>>>>>        // Btypkin.Btypkin_Form
45914>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Form     To "”æ¨£˜ „¡«ç§à©žª"
45915>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Form     To "”æ¨£˜"
45916>>>>>>>
45916>>>>>>>        // Btypkin.Btypkin_L_No
45916>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_L_No     To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª"
45917>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_L_No     To "’œ¢.€¨."
45918>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_L_No     To DD_DISPLAYONLY
45919>>>>>>>
45919>>>>>>>        // Btypkin.Btypkin_L_Hmnia
45919>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_L_Hmnia  To "’œ¢œ¬«˜å˜ †£/¤å˜"
45920>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_L_Hmnia  To "’œ¢.†£/¤å˜"
45921>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_L_Hmnia  To DD_DISPLAYONLY
45922>>>>>>>
45922>>>>>>>        // Btypkin.Btypkin_Seira
45922>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Seira    To "‘œ ¨á"
45923>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Seira    To "‘œ ¨á"
45924>>>>>>>
45924>>>>>>>        // Btypkin.Btypkin_Abr
45924>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Abr      To "‘¬¤«¦£¦š¨˜­å˜"
45925>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Abr      To "‘¬¤«/­å˜"
45926>>>>>>>
45926>>>>>>>        // Btypkin.Btypkin_Flag01
45926>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag01   To DD_DISPLAYONLY
45927>>>>>>>
45927>>>>>>>        // Btypkin.Btypkin_Flag02
45927>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag02   To DD_DISPLAYONLY
45928>>>>>>>
45928>>>>>>>        // Btypkin.Btypkin_Flag03
45928>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag03   To DD_DISPLAYONLY
45929>>>>>>>
45929>>>>>>>        // Btypkin.Btypkin_Flag04
45929>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag04   To DD_DISPLAYONLY
45930>>>>>>>
45930>>>>>>>        // Btypkin.Btypkin_Flag05
45930>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag05   To DD_DISPLAYONLY
45931>>>>>>>
45931>>>>>>>        // Btypkin.Btypkin_Flag06
45931>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag06   To DD_DISPLAYONLY
45932>>>>>>>
45932>>>>>>>        // Btypkin.Btypkin_Flag07
45932>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag07   To DD_DISPLAYONLY
45933>>>>>>>
45933>>>>>>>        // Btypkin.Btypkin_Flag08
45933>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag08   To DD_DISPLAYONLY
45934>>>>>>>
45934>>>>>>>        // Btypkin.Btypkin_Flag09
45934>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag09   To DD_DISPLAYONLY
45935>>>>>>>
45935>>>>>>>        // Btypkin.Btypkin_Flag10
45935>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag10   To DD_DISPLAYONLY
45936>>>>>>>
45936>>>>>>>        // Btypkin.Btypkin_Flag11
45936>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag11   To DD_DISPLAYONLY
45937>>>>>>>
45937>>>>>>>        // Btypkin.Btypkin_Flag12
45937>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag12   To DD_DISPLAYONLY
45938>>>>>>>
45938>>>>>>>        // Btypkin.Btypkin_Flag13
45938>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag13   To DD_DISPLAYONLY
45939>>>>>>>
45939>>>>>>>        // Btypkin.Btypkin_Flag14
45939>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag14   To DD_DISPLAYONLY
45940>>>>>>>
45940>>>>>>>        // Btypkin.Btypkin_Flag15
45940>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag15   To DD_DISPLAYONLY
45941>>>>>>>
45941>>>>>>>        // Btypkin.Btypkin_Flag16
45941>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag16   To DD_DISPLAYONLY
45942>>>>>>>
45942>>>>>>>        // Btypkin.Btypkin_Flag17
45942>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag17   To DD_DISPLAYONLY
45943>>>>>>>
45943>>>>>>>        // Btypkin.Btypkin_Flag18
45943>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag18   To DD_DISPLAYONLY
45944>>>>>>>
45944>>>>>>>        // Btypkin.Btypkin_Flag19
45944>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag19   To DD_DISPLAYONLY
45945>>>>>>>
45945>>>>>>>        // Btypkin.Btypkin_Flag20
45945>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag20   To DD_DISPLAYONLY
45946>>>>>>>
45946>>>>>>>    End_Procedure    // Define_Fields
45947>>>>>>>
45947>>>>>>>
45947>>>>>>>
45947>>>>>>>    // Field_Defaults:
45947>>>>>>>    // This procedure is used to establish default field values.
45947>>>>>>>
45947>>>>>>>    Procedure Field_Defaults
45948>>>>>>>        Forward Send Field_Defaults
45950>>>>>>>        //DDB-Generated-Code-Location
45950>>>>>>>        //DDB-FieldDefaultStart
45950>>>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Anti1 To 0
45951>>>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Anti2 To 0
45952>>>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Anti_Xp To 1
45953>>>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Flag05 To 0
45954>>>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Sign To 1
45955>>>>>>>        //DDB-FieldDefaultEnd
45955>>>>>>>    End_Procedure    // Field_Defaults
45956>>>>>>>End_Class    // Btypkin_DataDictionary
45957>>>>>>>//DDB-Selection-pkg-Start
45957>>>>>>>
45957>>>>>>>Use SL031.SL         // SL031
45957>>>>>>>Use sl007.SL         // sl007
45957>>>>>>>Use sl007r.SL        // sl007r
45957>>>>>>>
45957>>>>>>>//DDB-Selection-pkg-End
45957>>>>>>>//DDB-FileEnd
45957>>>>>    
45957>>>>>    //AB-IgnoreEnd
45957>>>>>
45957>>>>>    CD_Popup_Object SL031 is a dbModalPanelSub
45976>>>>>        set label to "‰ ¤ã©œ ª  €¥ ¦š¨á­à¤" 
45977>>>>>        Set Size to 213 506
45978>>>>>        Set Location to 4 5
45979>>>>>        Set Exit_Application_Local_State to FALSE
45980>>>>>        Set Modal_State to FALSE
45981>>>>>
45981>>>>>        //AB-DDOStart
45981>>>>>
45981>>>>>        Object Btypkin_DD is a Btypkin_DataDictionary
45983>>>>>        End_Object    // Btypkin_DD
45984>>>>>
45984>>>>>        Set Main_DD to (Btypkin_DD(self))
45985>>>>>        Set Server to (Btypkin_DD(self))
45986>>>>>
45986>>>>>        //AB-DDOEnd
45986>>>>>
45986>>>>>        Object oSelList is a dbListSub
45988>>>>>            Set Main_File to Btypkin.File_Number
45989>>>>>            Set Size to 173 491
45990>>>>>            Set Location to 3 6
45991>>>>>
45991>>>>>            Begin_Row
45994>>>>>                Entry_Item Btypkin.Btypkin_code
45995>>>>>                Entry_Item Btypkin.Btypkin_descr
45996>>>>>                Entry_Item Btypkin.Gtypkin_code
45997>>>>>                Entry_Item Btypkin.Ctypkin_code
45998>>>>>                Entry_Item Btypkin.Vtypkin_code
45999>>>>>                Entry_Item Btypkin.Btypkin_anti_xp
46000>>>>>            End_Row
46005>>>>>
46005>>>>>            Set Form_Width    item 0 to 39
46006>>>>>            set header_label  item 0 to "‰å¤ž©ž" 
46007>>>>>            
46007>>>>>            Set Form_Width    item 1 to 186
46008>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
46009>>>>>            
46009>>>>>            Set Form_Width    item 2 to 57
46010>>>>>            set header_label  item 2 to "‰å¤ž©ž ‚Š" 
46011>>>>>            
46011>>>>>            Set Form_Width    item 3 to 69
46012>>>>>            set header_label  item 3 to "‰ ¤ã©œ ª œ¢˜«é¤        " 
46013>>>>>            
46013>>>>>            Set Form_Width    item 4 to 59
46014>>>>>            set header_label  item 4 to "‰å¤ž©ž ¨¦£." 
46015>>>>>            
46015>>>>>            Set Form_Width    item 5 to 71
46016>>>>>            set header_label  item 5 to "• ‘¬¤˜¢¢˜©¦£." 
46017>>>>>            
46017>>>>>        End_Object    // oSelList
46018>>>>>
46018>>>>>        Object oOK_bn is a ButtonSub
46020>>>>>            set label to "&„§ ¢¦šã" 
46021>>>>>            Set Location to 177 337
46022>>>>>
46022>>>>>            //AB-StoreStart
46022>>>>>            Procedure OnClick
46024>>>>>                Send OK To oSelList
46025>>>>>            End_Procedure
46026>>>>>            //AB-StoreEnd
46026>>>>>
46026>>>>>        End_Object    // oOK_bn
46027>>>>>
46027>>>>>        Object oCancel_bn is a ButtonSub
46029>>>>>            set label to "&€¡ç¨à©ž" 
46030>>>>>            Set Location to 177 393
46031>>>>>
46031>>>>>            //AB-StoreStart
46031>>>>>            Procedure OnClick
46033>>>>>                Send Cancel To oSelList
46034>>>>>            End_Procedure
46035>>>>>            //AB-StoreEnd
46035>>>>>
46035>>>>>        End_Object    // oCancel_bn
46036>>>>>
46036>>>>>        Object oSearch_bn is a ButtonSub
46038>>>>>            set label to "€&¤˜ã«ž©ž" 
46039>>>>>            Set Location to 177 447
46040>>>>>
46040>>>>>            //AB-StoreStart
46040>>>>>            Procedure OnClick
46042>>>>>                Send Search To oSelList
46043>>>>>            End_Procedure
46044>>>>>            //AB-StoreEnd
46044>>>>>
46044>>>>>        End_Object    // oSearch_bn
46045>>>>>
46045>>>>>
46045>>>>>        //AB-StoreStart
46045>>>>>        On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
46046>>>>>        On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
46047>>>>>        On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
46048>>>>>        
46048>>>>>        //AB-StoreEnd
46048>>>>>
46048>>>>>    CD_End_Object    // SL031
46050>>>>>>
46050>>>>>
46050>>>>>//AB/     End_Object    // prj
46050>>>Use sl031r.sl
INCLUDING FILE: SL031R.SL
46050>>>>>//AB/ Project sl031r:Btypkin with recr 1st col
46050>>>>>//AB/     Object prj is a Lookup_Project
46050>>>>>//AB/         Set ProjectName to "sl031r:Btypkin with recr 1st col"
46050>>>>>//AB/         Set ProjectFileName to "sl031r.SL"
46050>>>>>//AB/         Set GenerateFileName to "NONAME"
46050>>>>>
46050>>>>>// Project Object Structure
46050>>>>>//   SL031r is a dbModalPanelSub
46050>>>>>//     Btypkin_DD is a DataDictionary
46050>>>>>//     oSelList is a dbListSub
46050>>>>>//     oOK_bn is a ButtonSub
46050>>>>>//     oCancel_bn is a ButtonSub
46050>>>>>//     oSearch_bn is a ButtonSub
46050>>>>>
46050>>>>>// Register all objects
46050>>>>>Register_Object Btypkin_DD
46050>>>>>Register_Object oCancel_bn
46050>>>>>Register_Object oOK_bn
46050>>>>>Register_Object oSearch_bn
46050>>>>>Register_Object oSelList
46050>>>>>Register_Object SL031r
46050>>>>>
46050>>>>>
46050>>>>>    //AB-IgnoreStart
46050>>>>>
46050>>>>>    Use DFAllEnt.pkg
46050>>>>>    Use dbList.Sub
46050>>>>>    Use Button.Sub
46050>>>>>
46050>>>>>
46050>>>>>    Use BTYPKIN.DD
46050>>>>>    
46050>>>>>    //AB-IgnoreEnd
46050>>>>>
46050>>>>>    CD_Popup_Object SL031r is a dbModalPanelSub
46069>>>>>        set label to "‰ ¤ã©œ ª  €¥ ¦š¨á­à¤" 
46070>>>>>        Set Size to 213 362
46071>>>>>        Set Location to 4 5
46072>>>>>        Set Exit_Application_Local_State to FALSE
46073>>>>>        Set Modal_State to FALSE
46074>>>>>
46074>>>>>        //AB-DDOStart
46074>>>>>
46074>>>>>        Object Btypkin_DD is a Btypkin_DataDictionary
46076>>>>>        End_Object    // Btypkin_DD
46077>>>>>
46077>>>>>        Set Main_DD to (Btypkin_DD(self))
46078>>>>>        Set Server to (Btypkin_DD(self))
46079>>>>>
46079>>>>>        //AB-DDOEnd
46079>>>>>
46079>>>>>        Object oSelList is a dbListSub
46081>>>>>            Set Main_File to Btypkin.File_Number
46082>>>>>            Set Size to 173 347
46083>>>>>            Set Location to 2 6
46084>>>>>
46084>>>>>            Begin_Row
46087>>>>>                Entry_Item Btypkin.Btypkin_recr
46088>>>>>                Entry_Item Btypkin.Btypkin_code
46089>>>>>                Entry_Item Btypkin.Btypkin_descr
46090>>>>>                Entry_Item Btypkin.Gtypkin_code
46091>>>>>                Entry_Item Btypkin.Ctypkin_code
46092>>>>>                Entry_Item Btypkin.Vtypkin_code
46093>>>>>                Entry_Item Btypkin.Btypkin_anti_xp
46094>>>>>            End_Row
46099>>>>>
46099>>>>>            Set Form_Width    item 0 to 58
46100>>>>>            Set Header_Label  item 0 to "Btypkin recr"
46101>>>>>            
46101>>>>>            Set Form_Width    item 1 to 36
46102>>>>>            set header_label  item 1 to "‰å¤ž©ž" 
46103>>>>>            
46103>>>>>            Set Form_Width    item 2 to 86
46104>>>>>            set header_label  item 2 to "œ¨ š¨˜­ã" 
46105>>>>>            
46105>>>>>            Set Form_Width    item 3 to 36
46106>>>>>            set header_label  item 3 to "‰å¤ž©ž ‚Š" 
46107>>>>>            
46107>>>>>            Set Form_Width    item 4 to 36
46108>>>>>            set header_label  item 4 to "‰ ¤ã©œ ª œ¢˜«é¤        " 
46109>>>>>            
46109>>>>>            Set Form_Width    item 5 to 36
46110>>>>>            set header_label  item 5 to "‰å¤ž©ž ¨¦£žŸœ¬«é¤" 
46111>>>>>            
46111>>>>>            Set Form_Width    item 6 to 53
46112>>>>>            set header_label  item 6 to "• ‘¬¤˜¢¢˜©¦£â¤¦¬" 
46113>>>>>            
46113>>>>>
46113>>>>>            //AB-StoreStart
46113>>>>>            Set Column_Option Item 0 to NoEnter True
46114>>>>>            
46114>>>>>            //AB-StoreEnd
46114>>>>>
46114>>>>>        End_Object    // oSelList
46115>>>>>
46115>>>>>        Object oOK_bn is a ButtonSub
46117>>>>>            set label to "&„§ ¢¦šã" 
46118>>>>>            Set Location to 178 194
46119>>>>>
46119>>>>>            //AB-StoreStart
46119>>>>>            Procedure OnClick
46121>>>>>                Send OK To oSelList
46122>>>>>            End_Procedure
46123>>>>>            //AB-StoreEnd
46123>>>>>
46123>>>>>        End_Object    // oOK_bn
46124>>>>>
46124>>>>>        Object oCancel_bn is a ButtonSub
46126>>>>>            set label to "&€¡ç¨à©ž" 
46127>>>>>            Set Location to 178 249
46128>>>>>
46128>>>>>            //AB-StoreStart
46128>>>>>            Procedure OnClick
46130>>>>>                Send Cancel To oSelList
46131>>>>>            End_Procedure
46132>>>>>            //AB-StoreEnd
46132>>>>>
46132>>>>>        End_Object    // oCancel_bn
46133>>>>>
46133>>>>>        Object oSearch_bn is a ButtonSub
46135>>>>>            set label to "€&¤˜ã«ž©ž" 
46136>>>>>            Set Location to 178 304
46137>>>>>
46137>>>>>            //AB-StoreStart
46137>>>>>            Procedure OnClick
46139>>>>>                Send Search To oSelList
46140>>>>>            End_Procedure
46141>>>>>            //AB-StoreEnd
46141>>>>>
46141>>>>>        End_Object    // oSearch_bn
46142>>>>>
46142>>>>>
46142>>>>>        //AB-StoreStart
46142>>>>>        On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
46143>>>>>        On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
46144>>>>>        On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
46145>>>>>        
46145>>>>>        //AB-StoreEnd
46145>>>>>
46145>>>>>    CD_End_Object    // SL031r
46147>>>>>>
46147>>>>>
46147>>>>>//AB/     End_Object    // prj
46147>>>Use sl033.sl
INCLUDING FILE: SL033.SL
46147>>>>>//AB/ Project SL033:BKINKAT
46147>>>>>//AB/ Object prj is a Lookup_Project
46147>>>>>//AB/     Set ProjectName to "SL033:BKINKAT"
46147>>>>>//AB/     Set ProjectFileName to "sl033.SL"
46147>>>>>
46147>>>>>// Project Object Structure
46147>>>>>//   sl033 is a dbModalPanelSub
46147>>>>>//     Company_DD is a DataDictionary
46147>>>>>//     Branch_DD is a DataDictionary
46147>>>>>//     Year_DD is a DataDictionary
46147>>>>>//     Btypkin_DD is a DataDictionary
46147>>>>>//     Baxiokat_DD is a DataDictionary
46147>>>>>//     Bkinkat_DD is a DataDictionary
46147>>>>>//     oSelList is a dbListSub
46147>>>>>//     oOK_bn is a ButtonSub
46147>>>>>//     oCancel_bn is a ButtonSub
46147>>>>>//     oSearch_bn is a ButtonSub
46147>>>>>
46147>>>>>// Register all objects
46147>>>>>Register_Object Baxiokat_DD
46147>>>>>Register_Object Bkinkat_DD
46147>>>>>Register_Object Branch_DD
46147>>>>>Register_Object Btypkin_DD
46147>>>>>Register_Object Company_DD
46147>>>>>Register_Object oCancel_bn
46147>>>>>Register_Object oOK_bn
46147>>>>>Register_Object oSearch_bn
46147>>>>>Register_Object oSelList
46147>>>>>Register_Object sl033
46147>>>>>Register_Object Year_DD
46147>>>>>
46147>>>>>
46147>>>>>//AB-IgnoreStart
46147>>>>>
46147>>>>>Use DFAllEnt.pkg
46147>>>>>Use dbList.Sub
46147>>>>>Use Button.Sub
46147>>>>>
46147>>>>>
46147>>>>>Use COMPANY.DD
46147>>>>>Use BRANCH.DD
46147>>>>>Use YEAR.DD
46147>>>>>Use BTYPKIN.DD
46147>>>>>Use BAXIOKAT.DD
46147>>>>>Use BKINKAT.DD
INCLUDING FILE: BKINKAT.DD
46147>>>>>>>//DDB-FileStart
46147>>>>>>>//DDB-HeaderStart
46147>>>>>>>
46147>>>>>>>// File Name : BKINKAT.DD
46147>>>>>>>// Class Name: Bkinkat_DataDictionary
46147>>>>>>>// Revision  : 39
46147>>>>>>>// Version   : 2
46147>>>>>>>
46147>>>>>>>Use  Windows           // Basic Definitions
46147>>>>>>>Use  DataDict          // DataDictionary Class Definition
46147>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
46147>>>>>>>
46147>>>>>>>Open Bkinkat
46149>>>>>>>Open Bkinkath
INCLUDING FILE: BKINKATH.FD
46151>>>>>>>Open Baxiokat
46153>>>>>>>Open Btypkin
46155>>>>>>>Open Sysrecb
46157>>>>>>>Open Bmove
INCLUDING FILE: BMOVE.FD
46159>>>>>>>
46159>>>>>>>//DDB-HeaderEnd
46159>>>>>>>//DDB-ValidationStart
46159>>>>>>>
46159>>>>>>>//DDB/ ExternalValidationTable Baxio_Status_VT  Baxio.Pkg
46159>>>>>>>
46159>>>>>>>Register_Object Bkinkat_Bkinkat_Yn_New_VT
46159>>>>>>>Register_Object Baxio_Status_VT
46159>>>>>>>Register_Object Bkinkat_Baxio_Place_VT
46159>>>>>>>Use Baxio.Pkg        // Baxio_Status_VT
46159>>>>>>>
46159>>>>>>>Object Bkinkat_Bkinkat_Yn_New_VT  is a DescriptionValidationTable
46161>>>>>>>
46161>>>>>>>    Procedure Fill_List
46163>>>>>>>        Forward Send Fill_List
46165>>>>>>>        Send Add_Table_Value  "0"  "Ž® "
46166>>>>>>>        Send Add_Table_Value  "1"  "Œ˜ "
46167>>>>>>>    End_Procedure    // Fill_List
46168>>>>>>>    //DDB-ValidationCustomStart
46168>>>>>>>    //DDB-ValidationCustomEnd
46168>>>>>>>End_Object   // Bkinkat_Bkinkat_Yn_New_VT
46169>>>>>>>
46169>>>>>>>Object Bkinkat_Baxio_Place_VT  is a CodeValidationTable
46171>>>>>>>    Set Type_Value        To "BAXIOPLACE"
46172>>>>>>>    Set Allow_Blank_State To TRUE
46173>>>>>>>    //DDB-ValidationCustomStart
46173>>>>>>>    //DDB-ValidationCustomEnd
46173>>>>>>>End_Object   // Bkinkat_Baxio_Place_VT
46174>>>>>>>//DDB-ValidationEnd
46174>>>>>>>Open SysCurXr
46176>>>>>>>
46176>>>>>>>Class Bkinkat_DataDictionary  is a DataDictionary_Sec
46177>>>>>>>
46177>>>>>>>    // Creating:
46177>>>>>>>
46177>>>>>>>    Procedure Creating
46178>>>>>>>        Forward Send Creating
46180>>>>>>>        // Insert Code Here
46180>>>>>>>        Move (Append('',((Trim(SysCurXr.Branch_Site))+;                         (Trim(String(Bkinkat.Bkinkat_Rec0)))))) to Bkinkat.Bkinkat_Recr
46181>>>>>>>    End_Procedure   // Creating
46182>>>>>>>
46182>>>>>>>      //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
46182>>>>>>>      //™) ˜¤áš¤à©ž properties
46182>>>>>>>      //š) › ˜®œå¨ ©ž calculated §œ›åà¤
46182>>>>>>>      //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
46182>>>>>>>      //œ) œ¤ž£â¨à©ž properties after
46182>>>>>>>      Procedure Update
46183>>>>>>>                Forward Send Update
46185>>>>>>>
46185>>>>>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
46185>>>>>>>                Move Syscurxr.Company_Code  to Bkinkat.Company_Code
46186>>>>>>>                Move Syscurxr.Branch_Code   to Bkinkat.Branch_Code
46187>>>>>>>                Move Syscurxr.Year_Year     to Bkinkat.Year_Year
46188>>>>>>>                Move Btypkin.Btypkin_Code   to Bkinkat.Btypkin_Code
46189>>>>>>>                Move Baxiokat.Baxiokat_Code to Bkinkat.Baxiokat_Code
46190>>>>>>>
46190>>>>>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
46190>>>>>>>                //š.1:baxio_stat_from + baxio_plac_from:
46190>>>>>>>                //    æ«˜¤ ›ž£ ¦¬¨š¦ç£œ ¤â¦ ˜¥ æš¨˜­¦,
46190>>>>>>>                //    §¨¦­˜¤éª "â¨®œ«˜ " ˜§¦ «¦ §¦¬Ÿœ¤á !
46190>>>>>>>                //    ¡˜  â®œ  ¡˜«á©«˜©ž 1
46190>>>>>>>                If (Bkinkat.Bkinkat_Yn_New = 1);                Begin
46192>>>>>>>                     Move 1 to Bkinkat.Baxio_Stat_From //¡˜«á©«˜ž ˜§æ = œ¡¡¨œ£âª
46193>>>>>>>                     Move 0 to Bkinkat.Baxio_Plac_From //¤â¦ ˜¥ æš¨˜­¦
46194>>>>>>>                End
46194>>>>>>>>
46194>>>>>>>                Else;                Begin //©«ã¤ ˜¤«åŸœ«ž §œ¨å§«à©ž, §¨â§œ  «˜ 2 §œ›å˜ ¤˜ œå¤˜  > 0
46195>>>>>>>                     //If (Not(Bkinkat.Baxio_Stat_From > 0)) Send Operation_Not_Allowed 3001 //¡˜«á©«˜ž ˜§æ = œ¡¡¨œ£âª
46195>>>>>>>                     If (Not(Bkinkat.Baxio_Plac_From > 0)) Send Operation_Not_Allowed 3001 //«¦ ¬§á¨®¦¤ ˜¥ æš¨˜­¦ §¨â§œ  ¡á§¦¬ ¤˜ ™¨å©¡œ«˜ 
46198>>>>>>>                End
46198>>>>>>>>
46198>>>>>>>
46198>>>>>>>                //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ btypkin
46198>>>>>>>                Add 1 to   Btypkin.Bkinkat_Num
46199>>>>>>>
46199>>>>>>>                //Move BkinKat.BkinKat_Rec0   to BkinKat.BkinKat_code
46199>>>>>>>      End_Procedure   //update
46200>>>>>>>
46200>>>>>>>
46200>>>>>>>      Procedure Backout
46201>>>>>>>                Forward Send Backout
46203>>>>>>>
46203>>>>>>>                //œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ Btypkin
46203>>>>>>>                Sub 1 from Btypkin.Bkinkat_Num
46204>>>>>>>      End_Procedure   //backout
46205>>>>>>>
46205>>>>>>>
46205>>>>>>>      Procedure Operation_Not_Allowed Integer iError_Num
46206>>>>>>>                String lsError_Message
46207>>>>>>>                Case Begin
46207>>>>>>>                     //˜§æ validate save
46207>>>>>>>                     Case (iError_Num = 1001)
46209>>>>>>>                     Case Break
46210>>>>>>>                     //˜§æ update
46210>>>>>>>                     Case (iError_Num = 3001)
46213>>>>>>>                          Move ("DDC 146:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n’¦ ¬§á¨®¦¤ ˜¥ æš¨˜­¦ §¨â§œ  ¡á§¦¬ ¤˜ ™¨å©¡œ«˜  !");                          to lsError_Message
46214>>>>>>>                     Case Break
46215>>>>>>>
46215>>>>>>>                     Case Else
46215>>>>>>>                          Forward Send Operation_Not_Allowed iError_Num
46217>>>>>>>                Case End
46217>>>>>>>
46217>>>>>>>                Error iError_Num lsError_Message
46218>>>>>>>>
46218>>>>>>>      End_Procedure // operation_not_allowed
46219>>>>>>>
46219>>>>>>>
46219>>>>>>>//----------------------------------------------------------------------------
46219>>>>>>>    Procedure Define_Fields
46220>>>>>>>        Forward Send Define_Fields
46222>>>>>>>        //DDB-Generated-Code-Location
46222>>>>>>>        //DDB-DefineFieldStart
46222>>>>>>>
46222>>>>>>>        Set Main_File            To Bkinkat.File_Number
46223>>>>>>>        Set Cascade_Delete_State To FALSE
46224>>>>>>>
46224>>>>>>>
46224>>>>>>>        // Child (Client) file structure................
46224>>>>>>>        Send Add_Client_File  Bkinkath.File_Number
46225>>>>>>>
46225>>>>>>>        // Parent (Server) file structure...............
46225>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
46226>>>>>>>        Send Add_Server_File  Btypkin.File_Number
46227>>>>>>>
46227>>>>>>>        // External (System) file structure.............
46227>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
46228>>>>>>>        Send Add_System_File  Bmove.File_Number  DD_LOCK_ON_ALL
46229>>>>>>>
46229>>>>>>>        Define_Auto_Increment  Sysrecb.Bkinkat_Rec0  To Bkinkat.Bkinkat_Rec0
46232>>>>>>>
46232>>>>>>>        // Field-based properties.......................
46232>>>>>>>
46232>>>>>>>        // Bkinkat.Company_Code
46232>>>>>>>
46232>>>>>>>        // Bkinkat.Branch_Code
46232>>>>>>>
46232>>>>>>>        // Bkinkat.Year_Year
46232>>>>>>>
46232>>>>>>>        // Bkinkat.Btypkin_Code
46232>>>>>>>
46232>>>>>>>        // Bkinkat.Baxiokat_Code
46232>>>>>>>
46232>>>>>>>        // Bkinkat.Bkinkat_Code
46232>>>>>>>
46232>>>>>>>        // Bkinkat.Bkinkat_Rec0
46232>>>>>>>
46232>>>>>>>        // Bkinkat.Bkinkat_Recr
46232>>>>>>>
46232>>>>>>>        // Bkinkat.Btypkin_Recr
46232>>>>>>>
46232>>>>>>>        // Bkinkat.Baxiokat_Recr
46232>>>>>>>
46232>>>>>>>        // Bkinkat.Bkinkat_Yn_New
46232>>>>>>>        Set Field_Value_Table      Field Bkinkat.Bkinkat_Yn_New To (Bkinkat_Bkinkat_Yn_New_VT(Self))
46233>>>>>>>
46233>>>>>>>        // Bkinkat.Baxio_Stat_From
46233>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Stat_From To (Baxio_Status_VT(Self))
46234>>>>>>>
46234>>>>>>>        // Bkinkat.Baxio_Stat_To
46234>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Stat_To To (Baxio_Status_VT(Self))
46235>>>>>>>
46235>>>>>>>        // Bkinkat.Baxio_Plac_From
46235>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Plac_From To (Bkinkat_Baxio_Place_VT(Self))
46236>>>>>>>
46236>>>>>>>        // Bkinkat.Baxio_Plac_To
46236>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Plac_To To (Bkinkat_Baxio_Place_VT(Self))
46237>>>>>>>
46237>>>>>>>        // Bkinkat.Bkinkat_Gplncod
46237>>>>>>>
46237>>>>>>>        //DDB-DefineFieldEnd
46237>>>>>>>
46237>>>>>>>        Set Main_File            To Bkinkat.File_Number
46238>>>>>>>        Set Cascade_Delete_State To FALSE
46239>>>>>>>
46239>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
46240>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
46241>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
46242>>>>>>>
46242>>>>>>>        // Parent (Server) file structure...............
46242>>>>>>>        Send Add_Server_File  Btypkin.File_Number
46243>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
46244>>>>>>>
46244>>>>>>>        // External (System) file structure.............
46244>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
46245>>>>>>>
46245>>>>>>>        Define_Auto_Increment  Sysrecb.Bkinkat_Rec0  To Bkinkat.Bkinkat_Rec0
46248>>>>>>>
46248>>>>>>>        // Field-based properties.......................
46248>>>>>>>
46248>>>>>>>        // Bkinkat.Btypkin_Code
46248>>>>>>>        Set Key_Field_State        Field Bkinkat.Btypkin_Code     To TRUE
46249>>>>>>>
46249>>>>>>>        // Bkinkat.Baxiokat_Code
46249>>>>>>>        Set Field_Options          Field Bkinkat.Baxiokat_Code    To DD_AUTOFIND
46250>>>>>>>        Set Key_Field_State        Field Bkinkat.Baxiokat_Code    To TRUE
46251>>>>>>>
46251>>>>>>>        // Bkinkat.Bkinkat_Rec0
46251>>>>>>>        Set Field_Options          Field Bkinkat.Bkinkat_Rec0     To DD_NOPUT
46252>>>>>>>
46252>>>>>>>        // Bkinkat.Btypkin_Rec0
46252>>>>>>>        //Set Field_Options          Field Bkinkat.Btypkin_Rec0     To DD_NOPUT
46252>>>>>>>
46252>>>>>>>        // Bkinkat.Baxiokat_Rec0
46252>>>>>>>        //Set Field_Options          Field Bkinkat.Baxiokat_Rec0    To DD_NOPUT
46252>>>>>>>
46252>>>>>>>        // Bkinkat.Bkinkat_Yn_New
46252>>>>>>>        Set Field_Class_Name       Field Bkinkat.Bkinkat_Yn_New   To "dbComboForm_EZ"
46253>>>>>>>        Set Field_Label_Long       Field Bkinkat.Bkinkat_Yn_New   To "Œâ¦ €¥ æš¨˜­¦ ?"
46254>>>>>>>        Set Field_Label_Short      Field Bkinkat.Bkinkat_Yn_New   To "Œâ¦ ?"
46255>>>>>>>        Set Field_Value_Table      Field Bkinkat.Bkinkat_Yn_New   To (Bkinkat_Bkinkat_Yn_New_VT(Self))
46256>>>>>>>
46256>>>>>>>        // Bkinkat.Baxio_Stat_From
46256>>>>>>>        Set Field_Class_Name       Field Bkinkat.Baxio_Stat_From  To "dbComboForm_EZ"
46257>>>>>>>        Set Field_Label_Long       Field Bkinkat.Baxio_Stat_From  To "‰˜«á©«˜©ž €§æ"
46258>>>>>>>        Set Field_Label_Short      Field Bkinkat.Baxio_Stat_From  To "‰˜«á©«˜©ž €§æ"
46259>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Stat_From  To (Baxio_Status_VT(Self))
46260>>>>>>>
46260>>>>>>>        // Bkinkat.Baxio_Stat_To
46260>>>>>>>        Set Field_Class_Name       Field Bkinkat.Baxio_Stat_To    To "dbComboForm_EZ"
46261>>>>>>>        Set Field_Label_Long       Field Bkinkat.Baxio_Stat_To    To "‰˜«á©«˜©ž ‘â"
46262>>>>>>>        Set Field_Label_Short      Field Bkinkat.Baxio_Stat_To    To "‰˜«á©«˜©ž ‘â"
46263>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Stat_To    To (Baxio_Status_VT(Self))
46264>>>>>>>
46264>>>>>>>        // Bkinkat.Baxio_Plac_From
46264>>>>>>>        Set Field_Class_Name       Field Bkinkat.Baxio_Plac_From  To "dbComboForm_EZ"
46265>>>>>>>        Set Field_Label_Long       Field Bkinkat.Baxio_Plac_From  To "„¬¨å¡œ«¦ ©â"
46266>>>>>>>        Set Field_Label_Short      Field Bkinkat.Baxio_Plac_From  To "„¬¨å¡œ«¦ ©â"
46267>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Plac_From  To (Bkinkat_Baxio_Place_VT(Self))
46268>>>>>>>
46268>>>>>>>        // Bkinkat.Baxio_Plac_To
46268>>>>>>>        Set Field_Class_Name       Field Bkinkat.Baxio_Plac_To    To "dbComboForm_EZ"
46269>>>>>>>        Set Field_Label_Long       Field Bkinkat.Baxio_Plac_To    To "áœ  ‘â"
46270>>>>>>>        Set Field_Label_Short      Field Bkinkat.Baxio_Plac_To    To "áœ  ‘â"
46271>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Plac_To    To (Bkinkat_Baxio_Place_VT(Self))
46272>>>>>>>
46272>>>>>>>        // Bkinkat.Bkinkat_Gplncod
46272>>>>>>>        Set Field_Label_Long       Field Bkinkat.Bkinkat_Gplncod  To "‰à› ¡æª ‚Š"
46273>>>>>>>        Set Field_Label_Short      Field Bkinkat.Bkinkat_Gplncod  To "‰à› ¡æª ‚Š"
46274>>>>>>>        //Set Field_Prompt_Object    Field Bkinkat.Bkinkat_Gplncod  To (SL056(Self))
46274>>>>>>>
46274>>>>>>>    End_Procedure    // Define_Fields
46275>>>>>>>
46275>>>>>>>
46275>>>>>>>    Procedure Field_Defaults
46276>>>>>>>        Forward Send Field_Defaults
46278>>>>>>>        //DDB-Generated-Code-Location
46278>>>>>>>        //DDB-FieldDefaultStart
46278>>>>>>>        //DDB-FieldDefaultEnd
46278>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Bkinkat_Yn_New   To 0
46279>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Baxio_Stat_From  To "1"
46280>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Baxio_Stat_To    To "1"
46281>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Baxio_Plac_From  To "1"
46282>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Baxio_Plac_To    To "1"
46283>>>>>>>    End_Procedure    // Field_Defaults
46284>>>>>>>
46284>>>>>>>End_Class    // Bkinkat_DataDictionary
46285>>>>>>>//DDB-FileEnd
46285>>>>>
46285>>>>>//AB-IgnoreEnd
46285>>>>>
46285>>>>>CD_Popup_Object sl033 is a dbModalPanelSub
46304>>>>>
46304>>>>>    //AB-StoreTopStart
46304>>>>>    Property Integer piFragmaBtypkinCode 0
46306>>>>>    
46306>>>>>    
46306>>>>>    
46306>>>>>    //AB-StoreTopEnd
46306>>>>>
46306>>>>>    Set Label to "‰˜«žš¦¨åœª ˜¥ ¦š¨á­à¤ š ˜ « ª ¡ ¤ã©œ ª"
46307>>>>>    Set Size to 206 362
46308>>>>>    Set Location to 4 5
46309>>>>>    Set Exit_Application_Local_State to FALSE
46310>>>>>    Set Modal_State to FALSE
46311>>>>>
46311>>>>>    //AB-DDOStart
46311>>>>>
46311>>>>>    Object Company_DD is a Company_DataDictionary
46313>>>>>    End_Object    // Company_DD
46314>>>>>
46314>>>>>    Object Branch_DD is a Branch_DataDictionary
46316>>>>>        Set DDO_Server to (Company_DD(self))
46317>>>>>    End_Object    // Branch_DD
46318>>>>>
46318>>>>>    Object Year_DD is a Year_DataDictionary
46320>>>>>        Set DDO_Server to (Branch_DD(self))
46321>>>>>    End_Object    // Year_DD
46322>>>>>
46322>>>>>    Object Btypkin_DD is a Btypkin_DataDictionary
46324>>>>>        Set DDO_Server to (Year_DD(self))
46325>>>>>    End_Object    // Btypkin_DD
46326>>>>>
46326>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
46328>>>>>    End_Object    // Baxiokat_DD
46329>>>>>
46329>>>>>    Object Bkinkat_DD is a Bkinkat_DataDictionary
46331>>>>>        Set DDO_Server to (Btypkin_DD(self))
46332>>>>>        Set DDO_Server to (Baxiokat_DD(self))
46333>>>>>
46333>>>>>        //AB-StoreStart
46333>>>>>                                
46333>>>>>        Procedure OnConstrain
46335>>>>>            Integer liBtypkinCode
46336>>>>>        
46336>>>>>            Get piFragmaBtypkinCode to liBtypkinCode
46337>>>>>            If (liBtypkinCode <> 0) Constrain Bkinkat.Btypkin_Code eq liBtypkinCode
46341>>>>>        End_Procedure // OnConstrain
46342>>>>>        
46342>>>>>        //AB-StoreEnd
46342>>>>>
46342>>>>>    End_Object    // Bkinkat_DD
46343>>>>>
46343>>>>>    Set Main_DD to (Bkinkat_DD(self))
46344>>>>>    Set Server to (Bkinkat_DD(self))
46345>>>>>
46345>>>>>    //AB-DDOEnd
46345>>>>>
46345>>>>>    Object oSelList is a dbListSub
46347>>>>>        Set Main_File to Bkinkat.File_Number
46348>>>>>        Set Size to 164 350
46349>>>>>        Set Location to 5 4
46350>>>>>
46350>>>>>        Begin_Row
46353>>>>>            Entry_Item Baxiokat.Baxiokat_code
46354>>>>>            Entry_Item Baxiokat.Baxiokat_descr
46355>>>>>            Entry_Item Baxiokat.Baxiokat_type
46356>>>>>            Entry_Item (Export_Code_Description(Self,2,Baxiokat.Baxiokat_type))
46357>>>>>        End_Row
46362>>>>>
46362>>>>>        Set Form_Width    item 0 to 36
46363>>>>>        Set Header_Label  item 0 to "„ ›¦ª"
46364>>>>>        
46364>>>>>        Set Form_Width    item 1 to 194
46365>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
46366>>>>>        
46366>>>>>        Set Form_Width    item 2 to 29
46367>>>>>        Set Header_Label  item 2 to "„ ©./¢ž¨."
46368>>>>>        
46368>>>>>        Set Form_Width    item 3 to 83
46369>>>>>        Set Header_Label  item 3 to "„ ©./¢ž¨."
46370>>>>>        
46370>>>>>
46370>>>>>        //AB-StoreStart
46370>>>>>                                
46370>>>>>        Property Integer piStoreFragmaBtypkinCode 0
46372>>>>>        
46372>>>>>        
46372>>>>>        Procedure Store_Defaults
46374>>>>>           Forward Send Store_Defaults
46376>>>>>           Set piStoreFragmaBtypkinCode to (piFragmaBtypkinCode(Self))
46377>>>>>        End_Procedure
46378>>>>>        
46378>>>>>        Procedure ReStore_Defaults
46380>>>>>           Forward Send ReStore_Defaults
46382>>>>>           Set piFragmaBtypkinCode to (piStoreFragmaBtypkinCode(Self))
46383>>>>>        End_Procedure
46384>>>>>        
46384>>>>>        Procedure Activating
46386>>>>>           Forward Send Activating
46388>>>>>           Send Rebuild_Constraints to Bkinkat_DD
46389>>>>>        End_Procedure
46390>>>>>        
46390>>>>>        
46390>>>>>        //AB-StoreEnd
46390>>>>>
46390>>>>>    End_Object    // oSelList
46391>>>>>
46391>>>>>    Object oOK_bn is a ButtonSub
46393>>>>>        Set Label to "&„§ ¢¦šã"
46394>>>>>        Set Location to 172 195
46395>>>>>
46395>>>>>        //AB-StoreStart
46395>>>>>        Procedure OnClick
46397>>>>>            Send OK To (oSelList(current_object))
46398>>>>>        End_Procedure
46399>>>>>        //AB-StoreEnd
46399>>>>>
46399>>>>>    End_Object    // oOK_bn
46400>>>>>
46400>>>>>    Object oCancel_bn is a ButtonSub
46402>>>>>        Set Label to "&€¡ç¨à©ž"
46403>>>>>        Set Location to 172 250
46404>>>>>
46404>>>>>        //AB-StoreStart
46404>>>>>        Procedure OnClick
46406>>>>>            Send Cancel To (oSelList(current_object))
46407>>>>>        End_Procedure
46408>>>>>        //AB-StoreEnd
46408>>>>>
46408>>>>>    End_Object    // oCancel_bn
46409>>>>>
46409>>>>>    Object oSearch_bn is a ButtonSub
46411>>>>>        Set Label to "€&¤˜ã«ž©ž"
46412>>>>>        Set Location to 172 304
46413>>>>>
46413>>>>>        //AB-StoreStart
46413>>>>>        Procedure OnClick
46415>>>>>            Send Search To (oSelList(current_object))
46416>>>>>        End_Procedure
46417>>>>>        //AB-StoreEnd
46417>>>>>
46417>>>>>    End_Object    // oSearch_bn
46418>>>>>
46418>>>>>
46418>>>>>    //AB-StoreStart
46418>>>>>    
46418>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
46419>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
46420>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
46421>>>>>    
46421>>>>>    
46421>>>>>    
46421>>>>>    
46421>>>>>    //AB-StoreEnd
46421>>>>>
46421>>>>>CD_End_Object    // sl033
46423>>>>>>
46423>>>>>
46423>>>>>//AB/ End_Object    // prj
46423>>>Use sl034.sl
46423>>>Use sl036.sl
INCLUDING FILE: SL036.SL
46423>>>>>//AB/ Project SL036:BARTICL
46423>>>>>//AB/ Object prj is a Lookup_Project
46423>>>>>//AB/     Set ProjectName to "SL036:BARTICL"
46423>>>>>//AB/     Set ProjectFileName to "SL036.SL"
46423>>>>>
46423>>>>>// Project Object Structure
46423>>>>>//   SL036 is a dbModalPanelSub
46423>>>>>//     Btypkin_DD is a DataDictionary
46423>>>>>//     Barticl_DD is a DataDictionary
46423>>>>>//     oSelList is a dbListSub
46423>>>>>//     oOK_bn is a ButtonSub
46423>>>>>//     oCancel_bn is a ButtonSub
46423>>>>>//     oSearch_bn is a ButtonSub
46423>>>>>
46423>>>>>// Register all objects
46423>>>>>Register_Object Barticl_DD
46423>>>>>Register_Object Btypkin_DD
46423>>>>>Register_Object oCancel_bn
46423>>>>>Register_Object oOK_bn
46423>>>>>Register_Object oSearch_bn
46423>>>>>Register_Object oSelList
46423>>>>>Register_Object SL036
46423>>>>>
46423>>>>>
46423>>>>>//AB-IgnoreStart
46423>>>>>
46423>>>>>Use DFAllEnt.pkg
46423>>>>>Use dbList.Sub
46423>>>>>Use Button.Sub
46423>>>>>
46423>>>>>
46423>>>>>Use BTYPKIN.DD
46423>>>>>Use BARTICL.DD
INCLUDING FILE: BARTICL.DD
46423>>>>>>>//DDB-FileStart
46423>>>>>>>//DDB-HeaderStart
46423>>>>>>>
46423>>>>>>>// File Name : BARTICL.DD
46423>>>>>>>// Class Name: Barticl_DataDictionary
46423>>>>>>>// Revision  : 71
46423>>>>>>>// Version   : 2
46423>>>>>>>
46423>>>>>>>Use  Windows           // Basic Definitions
46423>>>>>>>Use  DataDict          // DataDictionary Class Definition
46423>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
46423>>>>>>>
46423>>>>>>>Open Barticl
46425>>>>>>>Open Bmove
46427>>>>>>>Open Bsum
INCLUDING FILE: BSUM.FD
46429>>>>>>>Open Btypkin
46431>>>>>>>Open Sysrecb
46433>>>>>>>Open Cn
46435>>>>>>>
46435>>>>>>>//DDB-HeaderEnd
46435>>>>>>>//DDB-ValidationStart
46435>>>>>>>
46435>>>>>>>Register_Object Barticl_Barticl_M_Code_VT
46435>>>>>>>
46435>>>>>>>Object Barticl_Barticl_M_Code_VT  is a CodeValidationTable
46437>>>>>>>    Set Type_Value        To "MODULE"
46438>>>>>>>    Set Allow_Blank_State To TRUE
46439>>>>>>>    //DDB-ValidationCustomStart
46439>>>>>>>    //DDB-ValidationCustomEnd
46439>>>>>>>End_Object   // Barticl_Barticl_M_Code_VT
46440>>>>>>>//DDB-ValidationEnd
46440>>>>>>>//DDB-SelectionStart
46440>>>>>>>//DDB/ ExternalSelectionList Barticl  Barticl.SL
46440>>>>>>>//DDB/ ExternalSelectionList sl041  sl041.SL
46440>>>>>>>Register_Object Barticl
46440>>>>>>>Register_Object sl041
46440>>>>>>>//DDB-SelectionEnd
46440>>>>>>>
46440>>>>>>>Class Barticl_DataDictionary  is a DataDictionary_Sec
46441>>>>>>>
46441>>>>>>>    Procedure Shmera integer iField  Date dDate
46442>>>>>>>        Local Integer Changed
46443>>>>>>>        Get Field_Changed_State iField to Changed
46444>>>>>>>        If (Changed=0 AND dDate =0) Begin
46446>>>>>>>            SysDate4 dDate
46447>>>>>>>            Set Field_Default_Value iField to dDate
46448>>>>>>>        End
46448>>>>>>>>
46448>>>>>>>    End_Procedure   // Shmera
46449>>>>>>>
46449>>>>>>>    Procedure Save_Main_File
46450>>>>>>>        If (Barticl.Cn_Code<>'') Begin
46452>>>>>>>            Clear Cn
46453>>>>>>>            Move Barticl.Cn_Code to Cn.Cn_Code
46454>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
46455>>>>>>>>
46455>>>>>>>            Move Cn.Cn_Sls_ID     to Barticl.Sls_ID
46456>>>>>>>            Move Cn.Cn_Presp_ID   to Barticl.Presp_ID
46457>>>>>>>            Move Cn.CN_Cnt_ID     to Barticl.Cnt_ID
46458>>>>>>>        End
46458>>>>>>>>
46458>>>>>>>        Forward Send Save_Main_File
46460>>>>>>>    End_Procedure   // Save_Main_File
46461>>>>>>>
46461>>>>>>>      Procedure private.Initialize_Properties
46462>>>>>>>                 //£ž›œ¤ ©£æª §˜¢˜ é¤
46462>>>>>>>                 Set psB_Btypkin_Recr    to ''
46463>>>>>>>                 Set pdB_Barticl_Hmnia   to 0
46464>>>>>>>                 Set piB_Barticl_No      to 0
46465>>>>>>>                 Set psB_Barticl_Code1   to ""
46466>>>>>>>
46466>>>>>>>                 Set pdB_Garticl_Hmnia   to 0  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
46467>>>>>>>                 Set piB_Garticl_No      to 0
46468>>>>>>>                 Set psB_Garticl_Aitiol  to ""
46469>>>>>>>
46469>>>>>>>                 //£ž›œ¤ ©£æª ¤âà¤
46469>>>>>>>                 Set psA_Btypkin_Recr    to ''
46470>>>>>>>                 Set pdA_Barticl_Hmnia   to 0
46471>>>>>>>                 Set piA_Barticl_No      to 0
46472>>>>>>>                 Set psA_Barticl_Code1   to ""
46473>>>>>>>
46473>>>>>>>                 Set pdA_Garticl_Hmnia   to 0  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
46474>>>>>>>                 Set piA_Garticl_No      to 0
46475>>>>>>>                 Set psA_Garticl_Aitiol  to ""
46476>>>>>>>
46476>>>>>>>                 Set psB_Gplan_Code to ""
46477>>>>>>>                 Set psA_Gplan_Code to ""
46478>>>>>>>
46478>>>>>>>      End_Procedure //private.Initialize_Properties
46479>>>>>>>
46479>>>>>>>
46479>>>>>>>      Procedure Construct_Object
46480>>>>>>>                Forward Send Construct_Object
46482>>>>>>>
46482>>>>>>>                Property String  psA_Btypkin_Recr     ''
46483>>>>>>>                Property Date    pdA_Barticl_Hmnia    0
46484>>>>>>>                Property Integer piA_Barticl_No       0
46485>>>>>>>                Property String  psB_Barticl_Code1    ""
46486>>>>>>>
46486>>>>>>>                Property String  psB_Btypkin_Recr     ''
46487>>>>>>>                Property Date    pdB_Barticl_Hmnia    0
46488>>>>>>>                Property Integer piB_Barticl_No       0
46489>>>>>>>                Property String  psA_Barticl_Code1    ""
46490>>>>>>>
46490>>>>>>>                Property Date    pdA_Garticl_Hmnia    0 //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
46491>>>>>>>                Property Integer piA_Garticl_No       0
46492>>>>>>>                Property String  psA_Garticl_Aitiol   ''
46493>>>>>>>
46493>>>>>>>                Property Date    pdB_Garticl_Hmnia    0 //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
46494>>>>>>>                Property Integer piB_Garticl_No       0
46495>>>>>>>                Property String  psB_Garticl_Aitiol   ''
46496>>>>>>>
46496>>>>>>>
46496>>>>>>>                Property Integer piBaxio_dd           0 //object id «¦¬ ddo server š ˜ «¦ baxio
46497>>>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
46497>>>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ ???
46497>>>>>>>                Property Integer piBaxiokat_dd        0 //object id «¦¬ ddo server š ˜ «¦ baxio
46498>>>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
46498>>>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ ???
46498>>>>>>>                Property Integer piBmove_dd           0 //object id «¦¬ ddo server š ˜ «¦ bmove
46499>>>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
46499>>>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ cascade update
46499>>>>>>>                Property Integer piBtypkin_dd         0 //object id «¦¬ ddo server š ˜ «¦ btypkin
46500>>>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
46500>>>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ cascade update
46500>>>>>>>
46500>>>>>>>                Property String  psB_Gplan_Code
46501>>>>>>>                Property String  psA_Gplan_Code
46502>>>>>>>
46502>>>>>>>
46502>>>>>>>                Property Integer piCreated_Barticl 0 //©œ«á¨œ«˜  ©«ž¤ creating,
46503>>>>>>>                                                     //®¨ž© £¦§¦ œå«˜  ©«ž¤ update+validate_save ¡˜ 
46503>>>>>>>                                                     //£ž›œ¤åœ«˜  ©«ž¤ request_save «¦¬ bmove
46503>>>>>>>
46503>>>>>>>                Property  Integer piDo_GL_Maintainance       0 //object id «žª business process
46504>>>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «ã¤ šœ¤ ¡ã ¢¦š ©« ¡ã
46504>>>>>>>                Property  Integer piDo_CUSTOMER_Maintainance 0 //object id «žª business process
46505>>>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §œ¢á«œª
46505>>>>>>>                Property  Integer piDo_VENDOR_Maintainance   0 //object id «žª business process
46506>>>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §¨¦£žŸœ¬«âª
46506>>>>>>>      End_Procedure   //construct_object
46507>>>>>>>
46507>>>>>>>      Procedure Update
46508>>>>>>>                Integer liBAxio_dd liBaxiokat_dd
46509>>>>>>>                Forward Send Update
46511>>>>>>>
46511>>>>>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
46511>>>>>>>                Move Syscurxr.Company_Code  to Barticl.Company_Code
46512>>>>>>>                Move Syscurxr.Branch_Code   to Barticl.Branch_Code
46513>>>>>>>                Move Syscurxr.Year_Year     to Barticl.Year_Year
46514>>>>>>>                Move Btypkin.Btypkin_Code   to Barticl.Btypkin_Code
46515>>>>>>>
46515>>>>>>>
46515>>>>>>>                //™) ˜¤áš¤à©ž properties
46515>>>>>>>                Get piBaxio_dd    to liBaxio_dd    //«¦ ddo §¦¬ "©œ¨™å¨œ " «¦ baxio
46516>>>>>>>                Get piBaxiokat_dd to liBaxiokat_dd //«¦ ddo §¦¬ "©œ¨™å¨œ " «¦ baxiokat
46517>>>>>>>
46517>>>>>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
46517>>>>>>>                //š.1:btypkin.btypkin_L_Hmnia //«œ¢œ¬«˜å˜ ž£œ¨¦£ž¤å˜
46517>>>>>>>                 Move (Barticl.Barticl_Hmnia Max Btypkin.Btypkin_L_Hmnia) to Btypkin.Btypkin_L_Hmnia
46518>>>>>>>
46518>>>>>>>                Case Begin
46518>>>>>>>                    Case (Btypkin.Btypkin_Anti2 = 5) //§˜¨˜¢ã§«žª œå¤˜  ¦ å› ¦ª ¦ ©¬¤˜¢¢˜©æ£œ¤¦ª
46520>>>>>>>                        Move Barticl.Barticl_Code1 to Barticl.Barticl_Code2
46521>>>>>>>                        Move Barticl.Barticl_Epon1 to Barticl.Barticl_Epon2
46522>>>>>>>                      Case Break
46523>>>>>>>                    Case (Btypkin.Btypkin_Anti2 = (-1)) //›â¤ ¬§á¨®œ  §˜¨˜¢ã§«žª
46526>>>>>>>                        Move ""                    to Barticl.Barticl_Code2
46527>>>>>>>                        Move ""                    to Barticl.Barticl_Epon2
46528>>>>>>>                      Case Break
46529>>>>>>>                Case End
46529>>>>>>>
46529>>>>>>>
46529>>>>>>>                Case Begin
46529>>>>>>>                    Case ((Btypkin.Btypkin_Anti1=2) Or (Btypkin.Btypkin_Anti1=3))
46531>>>>>>>                        Clear Clients
46532>>>>>>>                        Move Barticl.Barticl_Code1 to Clients.Client_ID
46533>>>>>>>                        Find Eq Clients by Index.6 //Client_ID
46534>>>>>>>>
46534>>>>>>>                        If (Found = 1) Move Clients.Client_Recr to Barticl.Client_Mrecr
46537>>>>>>>                        Else Send Operation_Not_Allowed 3002 //›â¤ ™¨âŸž¡œ «¦ Master Customer_rec0, please reindex
46539>>>>>>>                      Case Break
46540>>>>>>>                Case End
46540>>>>>>>
46540>>>>>>>                If (Btypkin.Gtypkin_Code <> 0);                Begin //œá¤ ž ¡å¤ž©ž œ¤ž£œ¨é¤œ  «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã, ®¨œ á¦£˜  ¦§à›ã§¦«œ
46542>>>>>>>                      //master gplan rec0
46542>>>>>>>                      Case Begin
46542>>>>>>>                           Case (Btypkin.Btypkin_Anti1 = 1) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ š¢
46544>>>>>>>//jsjsjs 24/01/2001
46544>>>>>>>//                                Clear Gplan
46544>>>>>>>//                                Move Barticl.Company_Code  to Gplan.Company_Code
46544>>>>>>>//                                Move Barticl.Branch_Code   to Gplan.Branch_Code
46544>>>>>>>//                                Move Barticl.Year_Year     to Gplan.Year_Year
46544>>>>>>>//                                Move Barticl.Barticl_Code1 to Gplan.Gplan_Code
46544>>>>>>>//                                Find Eq Gplan by Index.1 //company_code+branch_code+year_year+Gplan_code
46544>>>>>>>//                                If (Found = 1) Move Gplan.Gplan_Rec0 to Barticl.Gplan_Mrec0
46544>>>>>>>//                                Else           Send Operation_Not_Allowed 3001 //›â¤ ™¨âŸž¡œ «¦ Master Gplan_rec0
46544>>>>>>>//jsjsjs 24/01/2001
46544>>>>>>>                           Case Break
46545>>>>>>>                           Case Else                        //=4 ¢¦ §¦å:©¬¤˜¢¢˜©æ£œ¤¦ª £œ user manual data entry
46545>>>>>>>                                Move 0 to Barticl.Gplan_Mrec0
46546>>>>>>>                      Case End
46546>>>>>>>                End   //please check the logic
46546>>>>>>>>
46546>>>>>>>
46546>>>>>>>
46546>>>>>>>                //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
46546>>>>>>>
46546>>>>>>>                //œ) œ¤ž£â¨à©ž properties after (˜§æ parent buffers!)
46546>>>>>>>                Set psA_Btypkin_Recr    to Btypkin.Btypkin_Recr
46547>>>>>>>                Set pdA_Barticl_Hmnia   to Barticl.Barticl_Hmnia
46548>>>>>>>                Set piA_Barticl_No      to Barticl.Barticl_No
46549>>>>>>>                Set psA_Barticl_Code1   to Barticl.Barticl_Code1
46550>>>>>>>
46550>>>>>>>                Set pdA_Garticl_Hmnia   to Barticl.Barticl_Hmnia  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
46551>>>>>>>                Set piA_Garticl_No      to Barticl.Barticl_No
46552>>>>>>>                Set psA_Garticl_Aitiol  to Barticl.Barticl_Aitiol
46553>>>>>>>
46553>>>>>>>      End_Procedure   //update
46554>>>>>>>
46554>>>>>>>
46554>>>>>>>      Procedure Backout
46555>>>>>>>                Forward Send Backout
46557>>>>>>>
46557>>>>>>>                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
46557>>>>>>>                Set psB_Btypkin_Recr    to Barticl.Btypkin_Recr
46558>>>>>>>                Set pdB_Barticl_Hmnia   to Barticl.Barticl_Hmnia
46559>>>>>>>                Set piB_Barticl_No      to Barticl.Barticl_No
46560>>>>>>>                Set psB_Barticl_Code1   to Barticl.Barticl_Code1
46561>>>>>>>
46561>>>>>>>                Set pdB_Garticl_Hmnia   to Barticl.Barticl_Hmnia  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
46562>>>>>>>                Set piB_Garticl_No      to Barticl.Barticl_No
46563>>>>>>>                Set psB_Garticl_Aitiol  to Barticl.Barticl_Aitiol
46564>>>>>>>      End_Procedure   // backout
46565>>>>>>>
46565>>>>>>>
46565>>>>>>>      Procedure Creating
46566>>>>>>>                Forward Send Creating
46568>>>>>>>
46568>>>>>>>                //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBarticl //˜¨ Ÿ£æª á¨Ÿ¨à¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
46568>>>>>>>
46568>>>>>>>            Move (Append('',((Trim(SysCurXR.Branch_Site))+;                            (Trim(String(Barticl.Barticl_Rec0)))))) to Barticl.Barticl_Recr
46569>>>>>>>
46569>>>>>>>                If (Barticl.Barticl_M_Code='') Move gs_Module_Code to Barticl.Barticl_M_Code
46572>>>>>>>
46572>>>>>>>                //************************************************************************
46572>>>>>>>                //flag 5:˜¬«æ£˜«ž ˜¨åŸ£ž©ž                                               *
46572>>>>>>>                //************************************************************************
46572>>>>>>>                If (Btypkin.Btypkin_Flag05 = TRUE);                     Begin //«¦ á¨Ÿ¨¦ â®œ  ˜¬«æ£˜«ž ˜¨åŸ£ž©ž
46574>>>>>>>                      Add 1 to Btypkin.Btypkin_L_No
46575>>>>>>>                      Move Btypkin.Btypkin_L_No  to Barticl.Barticl_No
46576>>>>>>>                     End
46576>>>>>>>>
46576>>>>>>>                Else Begin //«¦ á¨Ÿ¨¦ â®œ  ®œ ¨¦¡å¤ž«ž ˜¨åŸ£ž©ž
46577>>>>>>>                     End
46577>>>>>>>>
46577>>>>>>>
46577>>>>>>>                Set piCreated_Barticl to TRUE
46578>>>>>>>      End_Procedure //creating
46579>>>>>>>
46579>>>>>>>
46579>>>>>>>      Procedure Deleting
46580>>>>>>>                Forward Send Deleting
46582>>>>>>>
46582>>>>>>>                //jsjsjs 24/01/2001 Sub 1 from Year.Year_NumBarticl //˜¨ Ÿ£æª á¨Ÿ¨à¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
46582>>>>>>>                If (Btypkin.Btypkin_L_No = Barticl.Barticl_No);                Begin //œá¤ › ˜š¨á­à «¦¤ «œ¢œ¬«˜å¦ ˜¨ Ÿ£æª !!! sos pleas check the logic!
46584>>>>>>>                  Sub 1 from Btypkin.Btypkin_L_No
46585>>>>>>>                  // js 05/09/2002
46585>>>>>>>                  Saverecord Btypkin
46586>>>>>>>                End
46586>>>>>>>>
46586>>>>>>>      End_Procedure //deleting
46587>>>>>>>
46587>>>>>>>
46587>>>>>>>      Procedure Operation_Not_Allowed Integer iError_Num
46588>>>>>>>                String lsError_Message
46589>>>>>>>                Case Begin
46589>>>>>>>                     //˜§æ validate save
46589>>>>>>>                     Case (iError_Num = 1001)
46591>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž †£œ¨¦£ž¤å˜ !\n\n‹ ¡¨æ«œ¨ž «žª œ¤á¨¥œàª ®¨ã©œàª ("+;                          (String(SysCurXr.Year_XrhshFrom))+")") to lsError_Message
46592>>>>>>>                     Case Break
46593>>>>>>>                     Case (iError_Num = 1002)
46596>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž †£œ¨¦£ž¤å˜ !\n\n‹œš˜¢ç«œ¨ž «žª ¢ã¥œàª ®¨ã©œàª ("+;                          (String(SysCurXr.Year_XrhshTo))+")") to lsError_Message
46597>>>>>>>                     Case Break
46598>>>>>>>                     Case (iError_Num = 1003)
46601>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "ƒâ¤ œ§ «¨â§œ«˜  ˜¢˜šã «ç§¦¬ ¡å¤ž©žª!");                          to lsError_Message
46602>>>>>>>                     Case Break
46603>>>>>>>                     Case (iError_Num = 1004)
46606>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n† ž£œ¨¦£ž¤å˜ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ «¦ á¨Ÿ¨¦!");                          to lsError_Message
46607>>>>>>>                     Case Break
46608>>>>>>>                     Case (iError_Num = 1005)
46611>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\nŽ ˜¨ Ÿ£æª «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ «¦ á¨Ÿ¨¦!");                          to lsError_Message
46612>>>>>>>                     Case Break
46613>>>>>>>                     Case (iError_Num = 1006)
46616>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n† ˜ « ¦¢¦šå˜ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ «¦ á¨Ÿ¨¦!");                          to lsError_Message
46617>>>>>>>                     Case Break
46618>>>>>>>                     Case (iError_Num = 1007)
46621>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n‹ž›œ¤ ¡æª ˜¨ Ÿ£æª §˜¨˜©«˜« ¡¦ç !");                          to lsError_Message
46622>>>>>>>                     Case Break
46623>>>>>>>                     Case (iError_Num = 1008)
46626>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "ƒâ¤ œ§ «¨â§œ«˜  ˜¢˜šã ©¬¤˜¢¢˜©¦£â¤¦¬!");                          to lsError_Message
46627>>>>>>>                     Case Break
46628>>>>>>>                     Case (iError_Num = 1009)
46631>>>>>>>                          Clear Codemast
46632>>>>>>>                          Move "MODULE" to Codemast.Type
46633>>>>>>>                          Move Barticl.Barticl_M_Code to Codemast.Code
46634>>>>>>>                          Find Eq Codemast by Index.1 //type+code
46635>>>>>>>>
46635>>>>>>>                          Move ("DDC 036:€›ç¤˜«ž ž „šš¨˜­ã\n\n(’¦ á¨Ÿ¨¦ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§æ "+;                          (Trim(Codemast.Description))+" )") to lsError_Message
46636>>>>>>>                     Case Break
46637>>>>>>>                     Case (iError_Num = 1011)
46640>>>>>>>                          Move ("DDC 036:€›ç¤˜«ž ž „šš¨˜­ã\n\n(ƒœ¤ â®œ  ¦¨ ©Ÿœå «¦ ¡ç¡¢à£˜!)");                          to lsError_Message
46641>>>>>>>                     Case Break
46642>>>>>>>                     Case (iError_Num = 1100)
46645>>>>>>>                          Move "DDC 036:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
46646>>>>>>>                          Case Break
46647>>>>>>>
46647>>>>>>>                     Case (iError_Num = 2100)
46650>>>>>>>                          Move "DDC 036:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
46651>>>>>>>                          Case Break
46652>>>>>>>
46652>>>>>>>                   //˜§æ update
46652>>>>>>>                   Case (iError_Num = 3001)
46655>>>>>>>                        Move ("DDC 036:ƒâ¤ ™¨âŸž¡œ ¦ ¡à› ¡æª "+ (Trim(Barticl.Barticl_Code1)) + " ©«ã ‚œ¤ ¡ã Š¦š ©« ¡ã !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
46656>>>>>>>                   Case Break
46657>>>>>>>                   Case (iError_Num = 3002)
46660>>>>>>>                        Move ("DDC 036:ƒâ¤ ™¨âŸž¡œ ¦ ¡à› ¡æª "+ (Trim(Barticl.Barticl_Code1)) + " ©«ã ‚œ¤ ¡ã Š¦š ©« ¡ã š ˜ «¦¤ œ¢á«ž !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
46661>>>>>>>                   Case Break
46662>>>>>>>                   Case (iError_Num = 3003)
46665>>>>>>>                        Move ("DDC 036:ƒâ¤ ™¨âŸž¡œ ¦ ¡à› ¡æª "+ (Trim(Barticl.Barticl_Code1)) + " ©«ã ‚œ¤ ¡ã Š¦š ©« ¡ã š ˜ «¦¤ ¨¦£žŸœ¬«ã !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
46666>>>>>>>                   Case Break
46667>>>>>>>
46667>>>>>>>                     Case Else
46667>>>>>>>                          Forward Send Operation_Not_Allowed iError_Num
46669>>>>>>>                Case End
46669>>>>>>>
46669>>>>>>>                Error iError_Num lsError_Message
46670>>>>>>>>
46670>>>>>>>      End_Procedure // operation_not_allowed
46671>>>>>>>
46671>>>>>>>      Function Validate_Save Returns Integer
46672>>>>>>>               Integer iReturnVal
46673>>>>>>>
46673>>>>>>>               Forward Get Validate_Save to iReturnVal
46675>>>>>>>               //Set piCreated_Barticl to 0
46675>>>>>>>
46675>>>>>>>               If (Not(iReturnVal));               Begin
46677>>>>>>>                //1001+1002:â¢œš®¦  ž£œ¨¦£ž¤å˜ª
46677>>>>>>>                If (Not(Barticl.Barticl_Hmnia >= SysCurXr.Year_XrhshFrom )) Send Operation_Not_Allowed 1001
46680>>>>>>>                If (Not(Barticl.Barticl_Hmnia <= SysCurXr.Year_XrhshTo   )) Send Operation_Not_Allowed 1002
46683>>>>>>>
46683>>>>>>>                //1007:â¢œš®¦ª ˜¨ Ÿ£¦ç §˜¨˜©«˜« ¡¦ç
46683>>>>>>>                If (Not(Barticl.Barticl_No     >  0                  )) Send Operation_Not_Allowed 1007
46686>>>>>>>
46686>>>>>>>                //1011:â¢œš®¦ª £ã ¡œ¤¦ç module œšš¨˜­ãª
46686>>>>>>>                If (Trim(Barticl.Barticl_M_Code)="")       Send Operation_Not_Allowed 1011
46689>>>>>>>                //---------«â¢¦ª œ¢âš®à¤ create & edit barticl record----------------------
46689>>>>>>>
46689>>>>>>>                //---------â¢œš®¦  create barticl record----------------------
46689>>>>>>>                //sososo £ž§àª §¨œ§œ  ¤˜ §˜ ¥à £œ «ž¤ current record ????
46689>>>>>>>                If (Barticl.Recnum =  0);                Begin //œá¤ ›ž£ ¦¬¨šé ¤â¦ record
46691>>>>>>>                End   //«â¢¦ª œ¢âš®à¤ ›ž£ ¦¬¨šå˜ª ¤â¦¬ barticl record
46691>>>>>>>>
46691>>>>>>>
46691>>>>>>>                //---------â¢œš®¦  editing existing barticl records-------------------
46691>>>>>>>                Else;                Begin //edit an existing record
46692>>>>>>>                      //1003:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent btypkin record
46692>>>>>>>                      If (Not;                          ((psB_Btypkin_Recr(Self)) = Btypkin.Btypkin_Recr);                         )                                              Send Operation_Not_Allowed 1003
46695>>>>>>>                      //1004:«¨¦§¦§¦åž©ž (edit) barticl_hmnia £æ¤¦¤ ˜§æ barticl_dd
46695>>>>>>>                      If (;                           ((pdB_Barticl_Hmnia(Self))     <> Barticl.Barticl_Hmnia) and;                           ((Main_File(OPERATION_ORIGIN)) <> Barticl.File_Number);                         )                                              Send Operation_Not_Allowed 1004
46698>>>>>>>                      //1005:«¨¦§¦§¦åž©ž (edit) barticl_no £æ¤¦¤ ˜§æ barticl_dd
46698>>>>>>>                      If (;                           ((piB_Barticl_No   (Self))     <> Barticl.Barticl_No) and;                           ((Main_File(OPERATION_ORIGIN)) <> Barticl.File_Number);                         )                                              Send Operation_Not_Allowed 1005
46701>>>>>>>
46701>>>>>>>
46701>>>>>>>                      //1006:«¨¦§¦§¦åž©ž (edit) barticl_aitiol £æ¤¦¤ ˜§æ barticl_dd
46701>>>>>>>                      If (;                           ((psB_Garticl_Aitiol(Self))    <> Barticl.Barticl_Aitiol) and;                           ((Main_File(OPERATION_ORIGIN)) <> Barticl.File_Number) ;                         )                                              Send Operation_Not_Allowed 1006
46704>>>>>>>
46704>>>>>>>
46704>>>>>>>
46704>>>>>>>                      //1008:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã barticl_code1 (©¬¤˜¢¢˜©¦£â¤¦¬)
46704>>>>>>>                      If (Not;                          ((psB_Barticl_Code1(Self)) = Barticl.Barticl_Code1);                         )                                              Send Operation_Not_Allowed 1008
46707>>>>>>>                End   //«â¢¦ª œ¢âš®à¤ editing existing barticl record
46707>>>>>>>>
46707>>>>>>>                If ( ;                    (Not(Barticl.Company_Code = Syscurxr.Company_Code)) or;                    (Not(Barticl.Branch_Code  = Syscurxr.Branch_Code )) or;                    (Not(Barticl.Year_Year    = Syscurxr.Year_Year   ));                    )                                                   Send Operation_Not_Allowed 1100
46710>>>>>>>
46710>>>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
46710>>>>>>>>
46710>>>>>>>               Function_Return iReturnVal
46711>>>>>>>      End_Function   // validate_save
46712>>>>>>>
46712>>>>>>>
46712>>>>>>>      Function Validate_Delete  Returns Integer
46713>>>>>>>               Integer iReturnVal
46714>>>>>>>               Forward Get Validate_Delete  To iReturnVal
46716>>>>>>>               If (Not(iReturnVal));               Begin
46718>>>>>>>                    If ( ;                        (Not(Barticl.Company_Code = Syscurxr.Company_Code)) or;                        (Not(Barticl.Branch_Code  = Syscurxr.Branch_Code )) or;                        (Not(Barticl.Year_Year    = Syscurxr.Year_Year   ));                        )                                                   Send Operation_Not_Allowed 2100
46721>>>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
46721>>>>>>>>
46721>>>>>>>               Function_Return iReturnVal
46722>>>>>>>      End_Function   // Validate_Delete
46723>>>>>>>
46723>>>>>>>
46723>>>>>>>
46723>>>>>>>      Procedure Request_Save
46724>>>>>>>               Integer liGarticl_Rec0 liCmove_Rec0 liVmove_Rec0 iErrorObj
46725>>>>>>>
46725>>>>>>>               Send private.Initialize_Properties //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties
46726>>>>>>>
46726>>>>>>>               //ž cascade update «¨â®œ  £æ¤¦¤ ©œ existing barticl records
46726>>>>>>>               //æ«˜¤ ›ž£ ¦¬¨šé ¤â¦ record, «æ«œ ›â¤ ®¨œ á¦£˜  «å§¦«˜
46726>>>>>>>               If ((Current_Record(Self)) = 0) Begin
46728>>>>>>>                    Forward Send Request_Save
46730>>>>>>>                    Send private.Initialize_Properties //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties
46731>>>>>>>                    Procedure_Return
46732>>>>>>>               End
46732>>>>>>>>
46732>>>>>>>
46732>>>>>>>               //æ«˜¤ ¡á¤à edit existing record, §¨â§œ  ¤˜ «¨â®à «ž¤ cascade update
46732>>>>>>>               //š ˜ ¤˜ â¤ž£œ¨é©à (œá¤ ­¬© ¡á ®¨œ áœ«˜ ) «˜ child bmoves
46732>>>>>>>               //£œ « ª ˜¢¢˜šâª «à¤ 3 foreign §œ›åà¤ «¦¬ barticl
46732>>>>>>>               //(btypkin_code+barticl_hmnia+barticl_no)
46732>>>>>>>               //§¨æª «¦ §˜¨æ¤ ›â¤ œ§ «¨â§œ«˜  ˜¢¢˜šã «¦¬ btypkin.
46732>>>>>>>
46732>>>>>>>               BEGIN_TRANSACTION
46733>>>>>>>               Move Error_Object_ID to iErrorObj
46734>>>>>>>               Forward Send Request_Save
46736>>>>>>>
46736>>>>>>>               //˜¤áš¤à©ž rec0's «à¤ ˜¤«å©«¦ ®à¤ articl's «à¤ ¢¦ §é¤ modules
46736>>>>>>>               Get Field_Current_Value Field Barticl.Garticl_Rec0 to liGarticl_Rec0
46737>>>>>>>               Get Field_Current_Value Field Barticl.Carticl_Rec0 to liCmove_Rec0
46738>>>>>>>               Get Field_Current_Value Field Barticl.Varticl_Rec0 to liVmove_Rec0
46739>>>>>>>
46739>>>>>>>               Send private.Transaction_Cascade_Update_Bmove //cascade œ¤ž£â¨à©ž bmove
46740>>>>>>>
46740>>>>>>>               END_TRANSACTION
46741>>>>>>>               Move iErrorObj to Error_Object_ID
46742>>>>>>>               Send private.Initialize_Properties //£ž›œ¤ ©£æª properties š ˜ œ§æ£œ¤ž ¡å¤ž©ž
46743>>>>>>>
46743>>>>>>>               //œ§˜¤˜­¦¨á «¦¬ system indicator err
46743>>>>>>>               Indicate Err False
46744>>>>>>>     End_Procedure   // request_save
46745>>>>>>>
46745>>>>>>>
46745>>>>>>>     //ž ¨¦¬«å¤˜ ˜¬«ã ˜¤˜¢˜£™á¤œ  ¤˜ ¡á¤œ  cascade update ©«¦ bmove
46745>>>>>>>     //¡˜¢œå«˜  ˜§æ «ã¤ request save, £â©˜ ˜§æ transaction, £æ¤¦¤ š ˜ existing barticl records.
46745>>>>>>>     //œ§ ©«¨â­œ  ¢áŸž :
46745>>>>>>>     Procedure private.Transaction_Cascade_Update_Bmove
46746>>>>>>>               Integer liBmove_dd
46747>>>>>>>
46747>>>>>>>               //§˜¢˜ âª ¡˜  ¤âœª « £âª «¦¬ barticl
46747>>>>>>>               String   lsB_Btypkin_Recr     lsA_Btypkin_Recr
46747>>>>>>>               Date     ldB_Barticl_Hmnia    ldA_Barticl_Hmnia
46747>>>>>>>               Integer  liB_Barticl_No       liA_Barticl_No
46747>>>>>>>
46747>>>>>>>               //˜¤áš¤à©ž §˜¢˜ é¤ « £é¤ barticl
46747>>>>>>>               Get psB_Btypkin_Recr    to lsB_Btypkin_Recr
46748>>>>>>>               Get pdB_Barticl_Hmnia   to ldB_Barticl_Hmnia
46749>>>>>>>               Get piB_Barticl_No      to liB_Barticl_No
46750>>>>>>>
46750>>>>>>>               //˜¤áš¤à©ž ¤âà¤ « £é¤ barticl
46750>>>>>>>               Get psA_Btypkin_Recr    to lsA_Btypkin_Recr
46751>>>>>>>               Get pdA_Barticl_Hmnia   to ldA_Barticl_Hmnia
46752>>>>>>>               Get piA_Barticl_No      to liA_Barticl_No
46753>>>>>>>
46753>>>>>>>               //œá¤ æ¢œª ¦  « £âª before+after œå¤˜  å©œª,
46753>>>>>>>               //«æ«œ ›â¤ £§˜å¤à ¡˜Ÿæ¢¦¬ ©«¦¤ ¡æ§¦ ¤˜ «¨â¥à,
46753>>>>>>>               //˜¢¢á ­œçšà ...«¨â®¦¤«˜ª!
46753>>>>>>>               If (;                    (lsB_Btypkin_Recr   = lsA_Btypkin_Recr   ) and;                    (ldB_Barticl_Hmnia  = ldA_Barticl_Hmnia  ) and;                    (liB_Barticl_No     = liA_Barticl_No     )    ;                   ) Begin
46755>>>>>>>                      Procedure_Return
46756>>>>>>>                     End
46756>>>>>>>>
46756>>>>>>>
46756>>>>>>>
46756>>>>>>>               //**************************************************************************
46756>>>>>>>               //02.rebuild constraints, ¢æšà «à¤ ¡¢á©œà¤
46756>>>>>>>               //**************************************************************************
46756>>>>>>>               Get piBmove_dd           to liBmove_dd
46757>>>>>>>               Send Rebuild_Constraints to (piBtypkin_dd(Self))
46758>>>>>>>               Send Rebuild_Constraints to Self
46759>>>>>>>               Send Rebuild_Constraints to (piBaxio_dd  (Self))
46760>>>>>>>               Send Rebuild_Constraints to liBmove_dd
46761>>>>>>>
46761>>>>>>>               //**************************************************************************
46761>>>>>>>               //03.©á¨à©ž Bmove
46761>>>>>>>               //**************************************************************************
46761>>>>>>>               Send Clear to liBmove_dd
46762>>>>>>>               Send Find to liBmove_dd FIRST_RECORD 3 //barticl_recr+bmove_rec0
46763>>>>>>>               While (Found=1)
46767>>>>>>>                      Send Request_Save to liBmove_dd
46768>>>>>>>                      Send Find to liBmove_dd NEXT_RECORD 3 //Barticl_recr+Bmove_rec0
46769>>>>>>>               Loop
46770>>>>>>>>
46770>>>>>>>               Send Find to liBmove_dd FIRST_RECORD 3 //barticl_rec0+bmove_rec0
46771>>>>>>>               //send check_arthro_for_ypol (› æ«  £§¦¨œå ¤˜ ˜¢¢á¥œ   ©¦« £å˜ !)
46771>>>>>>>     End_Procedure //private.transaction_cascade_update_bmove
46772>>>>>>>
46772>>>>>>>
46772>>>>>>>
46772>>>>>>>     //ž ¨¦¬«å¤˜ ˜¬«ã ˜¤˜¢˜£™á¤œ  ¤˜ œ¤ž£œ¨é©œ  æ©˜ ˜§¦ «˜ ¬§æ¢¦ §˜ 3 modules «¦¬ ©¬©«ã£˜«¦ª
46772>>>>>>>     //§¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤.
46772>>>>>>>     //¡˜¢œå«˜  ˜§æ «åª request save & delete, £â©˜ ˜§æ transaction.
46772>>>>>>>     //œ§ ©«¨â­œ  ¢áŸž :
46772>>>>>>>     Procedure private.Transaction_Update_Other_Modules Integer liGarticl_Rec0;                                                        Integer liCmove_Rec0;                                                        Integer liVmove_Rec0;                                                        Integer liMode
46773>>>>>>>
46773>>>>>>>               Integer liDo_GL_Maintainance liDo_CUSTOMER_Maintainance liDo_VENDOR_Maintainance
46774>>>>>>>               Integer liMust_Update_GL     liMust_Update_CUSTOMER     liMust_Update_VENDOR
46774>>>>>>>
46774>>>>>>>               //4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
46774>>>>>>>               Integer liFlag02 liFlag03 liFlag04 liFlag05
46774>>>>>>>
46774>>>>>>>               //œç¨œ©ž «à¤ ¢¦ §é¤ modules §¦¬ §¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤
46774>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Gtypkin_Rec0   to liMust_Update_GL
46775>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Ctypkin_Rec0   to liMust_Update_CUSTOMER
46776>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Vtypkin_Rec0   to liMust_Update_VENDOR
46777>>>>>>>
46777>>>>>>>               //˜¤áš¤à©ž «à¤ 4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
46777>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag02 to liFlag02
46778>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag03 to liFlag03
46779>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag04 to liFlag04
46780>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag05 to liFlag05
46781>>>>>>>
46781>>>>>>>     End_Procedure //private.transaction_update_other_modules
46782>>>>>>>
46782>>>>>>>
46782>>>>>>>    Procedure Define_Fields
46783>>>>>>>        Forward Send Define_Fields
46785>>>>>>>        //DDB-Generated-Code-Location
46785>>>>>>>        //DDB-DefineFieldStart
46785>>>>>>>
46785>>>>>>>        Set Main_File            To Barticl.File_Number
46786>>>>>>>        Set Cascade_Delete_State To FALSE
46787>>>>>>>
46787>>>>>>>
46787>>>>>>>        // Child (Client) file structure................
46787>>>>>>>        Send Add_Client_File  Bmove.File_Number
46788>>>>>>>        Send Add_Client_File  Bsum.File_Number
46789>>>>>>>
46789>>>>>>>        // Parent (Server) file structure...............
46789>>>>>>>        Send Add_Server_File  Btypkin.File_Number
46790>>>>>>>
46790>>>>>>>        // External (System) file structure.............
46790>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
46791>>>>>>>        Send Add_System_File  Cn.File_Number  DD_LOCK_ON_ALL
46792>>>>>>>
46792>>>>>>>        Define_Auto_Increment  Sysrecb.Barticl_Rec0  To Barticl.Barticl_Rec0
46795>>>>>>>
46795>>>>>>>        // Field-based properties.......................
46795>>>>>>>
46795>>>>>>>        // Barticl.Company_Code
46795>>>>>>>
46795>>>>>>>        // Barticl.Branch_Code
46795>>>>>>>
46795>>>>>>>        // Barticl.Year_Year
46795>>>>>>>
46795>>>>>>>        // Barticl.Btypkin_Code
46795>>>>>>>
46795>>>>>>>        // Barticl.Barticl_Hmnia
46795>>>>>>>        Set Field_Entry_msg        Field Barticl.Barticl_Hmnia To Shmera
46796>>>>>>>        Set Field_Mask_Type        Field Barticl.Barticl_Hmnia To MASK_DATE_WINDOW
46797>>>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_Hmnia To (Barticl(Self))
46798>>>>>>>
46798>>>>>>>        // Barticl.Barticl_No
46798>>>>>>>
46798>>>>>>>        // Barticl.Barticl_Rec0
46798>>>>>>>
46798>>>>>>>        // Barticl.Barticl_Recr
46798>>>>>>>
46798>>>>>>>        // Barticl.Btypkin_Recr
46798>>>>>>>
46798>>>>>>>        // Barticl.Barticl_Code1
46798>>>>>>>
46798>>>>>>>        // Barticl.Barticl_Epon1
46798>>>>>>>
46798>>>>>>>        // Barticl.Barticl_Code2
46798>>>>>>>
46798>>>>>>>        // Barticl.Barticl_Epon2
46798>>>>>>>
46798>>>>>>>        // Barticl.Barticl_Aitiol
46798>>>>>>>
46798>>>>>>>        // Barticl.Barticl_Sv2
46798>>>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Sv2 To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
46798>>>>>>>
46798>>>>>>>        // Barticl.Barticl_Sv0
46798>>>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Sv0 To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
46798>>>>>>>
46798>>>>>>>        // Barticl.Barticl_Sv00
46798>>>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Sv00 To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
46798>>>>>>>
46798>>>>>>>        // Barticl.Barticl_Svr
46798>>>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Svr To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
46798>>>>>>>
46798>>>>>>>        // Barticl.Barticl_Lines
46798>>>>>>>
46798>>>>>>>        // Barticl.Barticl_Bmovela
46798>>>>>>>
46798>>>>>>>        // Barticl.Barticl_M_Code
46798>>>>>>>        Set Field_Value_Table      Field Barticl.Barticl_M_Code To (Barticl_Barticl_M_Code_VT(Self))
46799>>>>>>>
46799>>>>>>>        // Barticl.Garticl_Rec0
46799>>>>>>>
46799>>>>>>>        // Barticl.Carticl_Rec0
46799>>>>>>>
46799>>>>>>>        // Barticl.Varticl_Rec0
46799>>>>>>>
46799>>>>>>>        // Barticl.Gmove_Mrec0
46799>>>>>>>
46799>>>>>>>        // Barticl.Gplan_Mrec0
46799>>>>>>>
46799>>>>>>>        // Barticl.Client_Mrecr
46799>>>>>>>
46799>>>>>>>        // Barticl.Barticl_Ekleise
46799>>>>>>>
46799>>>>>>>        // Barticl.Cmoves_Recr
46799>>>>>>>
46799>>>>>>>        // Barticl.Isotimia
46799>>>>>>>
46799>>>>>>>        // Barticl.Cn_Code
46799>>>>>>>        Set Field_Prompt_Object    Field Barticl.Cn_Code To (sl041(Self))
46800>>>>>>>
46800>>>>>>>        // Barticl.Cn_Descr
46800>>>>>>>
46800>>>>>>>        // Barticl.Cn_Recr
46800>>>>>>>
46800>>>>>>>        // Barticl.Sls_Id
46800>>>>>>>
46800>>>>>>>        // Barticl.Cnt_Id
46800>>>>>>>
46800>>>>>>>        // Barticl.Presp_Id
46800>>>>>>>
46800>>>>>>>        // Barticl.Se_Logik
46800>>>>>>>
46800>>>>>>>        // Barticl.Sxolia1
46800>>>>>>>
46800>>>>>>>        // Barticl.Sxolia2
46800>>>>>>>
46800>>>>>>>        // Barticl.Partl_Akyr_Recr
46800>>>>>>>
46800>>>>>>>        //DDB-DefineFieldEnd
46800>>>>>>>
46800>>>>>>>        Set Main_File            To Barticl.File_Number
46801>>>>>>>
46801>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
46802>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
46803>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
46804>>>>>>>
46804>>>>>>>        // Child (Client) file structure................
46804>>>>>>>        Send Add_Client_File  Bsum.File_Number
46805>>>>>>>        Send Add_Client_File  Bmove.File_Number
46806>>>>>>>
46806>>>>>>>        // Parent (Server) file structure...............
46806>>>>>>>        Send Add_Server_File  Btypkin.File_Number
46807>>>>>>>
46807>>>>>>>        // External (System) file structure.............
46807>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
46808>>>>>>>        //Send Add_System_File  Gplan.File_Number  DD_LOCK_ON_SAVE
46808>>>>>>>
46808>>>>>>>        Define_Auto_Increment  Sysrecb.Barticl_Rec0  To Barticl.Barticl_Rec0
46811>>>>>>>
46811>>>>>>>        // Field-based properties.......................
46811>>>>>>>
46811>>>>>>>        // Barticl.Company_Code
46811>>>>>>>
46811>>>>>>>        // Barticl.Branch_Code
46811>>>>>>>
46811>>>>>>>        // Barticl.Year_Year
46811>>>>>>>
46811>>>>>>>        // Barticl.Btypkin_Code
46811>>>>>>>
46811>>>>>>>        // Barticl.Barticl_Hmnia
46811>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Hmnia    To "†£/¤å˜"
46812>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Hmnia    To "†£/¤å˜"
46813>>>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_Hmnia    To (Barticl(Self))
46814>>>>>>>
46814>>>>>>>        // Barticl.Barticl_No
46814>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_No       To "€¨ Ÿ£æª"
46815>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_No       To "€¨ Ÿ£æª"
46816>>>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_No       To (Barticl(Self))
46817>>>>>>>
46817>>>>>>>        // Barticl.Barticl_Rec0
46817>>>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_Rec0     To (Barticl(Self))
46818>>>>>>>        Set Key_Field_State        Field Barticl.Barticl_Rec0     To TRUE
46819>>>>>>>
46819>>>>>>>        // Barticl.Btypkin_Rec0
46819>>>>>>>
46819>>>>>>>        // Barticl.Barticl_Code1
46819>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Code1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª"
46820>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Code1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª"
46821>>>>>>>
46821>>>>>>>        // Barticl.Barticl_Epon1
46821>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Epon1    To "„§à¤¬£å˜"
46822>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Epon1    To "„§à¤¬£å˜"
46823>>>>>>>
46823>>>>>>>        // Barticl.Barticl_Code2
46823>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Code2    To "˜¨˜¢ã§«žª"
46824>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Code2    To "˜¨˜¢ã§«žª"
46825>>>>>>>
46825>>>>>>>        // Barticl.Barticl_Epon2
46825>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Epon2    To "„§à¤¬£å˜"
46826>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Epon2    To "„§à¤¬£å˜"
46827>>>>>>>
46827>>>>>>>        // Barticl.Barticl_Aitiol
46827>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Aitiol   To "€ « ¦¢¦šå˜"
46828>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Aitiol   To "€ « ¦¢¦šå˜"
46829>>>>>>>
46829>>>>>>>        // Barticl.Barticl_Sv2
46829>>>>>>>        Set Field_Options          Field Barticl.Barticl_Sv2      To DD_DISPLAYONLY
46830>>>>>>>
46830>>>>>>>        // Barticl.Barticl_Sv0
46830>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Sv0      To "‘ç¤¦¢˜ €¥ é¤ ‘œ ‰ç¨ ¦ Œæ£ ©£˜ •¨ã©žª"
46831>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Sv0      To "‘ç¤¦¢˜"
46832>>>>>>>        Set Field_Options          Field Barticl.Barticl_Sv0      To DD_DISPLAYONLY
46833>>>>>>>
46833>>>>>>>        // Barticl.Barticl_Sv00
46833>>>>>>>        Set Field_Options          Field Barticl.Barticl_Sv00     To DD_DISPLAYONLY
46834>>>>>>>
46834>>>>>>>        // Barticl.Barticl_Svr
46834>>>>>>>        Set Field_Options          Field Barticl.Barticl_Svr      To DD_DISPLAYONLY
46835>>>>>>>
46835>>>>>>>        // Barticl.Barticl_Lines
46835>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Lines    To "’œ£á® ˜"
46836>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Lines    To "’œ£á® ˜"
46837>>>>>>>        Set Field_Options          Field Barticl.Barticl_Lines    To DD_DISPLAYONLY
46838>>>>>>>
46838>>>>>>>        // Barticl.Barticl_Bmovela
46838>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Bmovela  To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª ‚¨˜££ãª"
46839>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Bmovela  To "’œ¢. €¨.‚¨˜££ãª"
46840>>>>>>>        Set Field_Options          Field Barticl.Barticl_Bmovela  To DD_DISPLAYONLY
46841>>>>>>>
46841>>>>>>>        // Barticl.Barticl_M_Code
46841>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_M_Code   To "Module „šš¨˜­ãª"
46842>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_M_Code   To "Module „šš¨˜­ãª"
46843>>>>>>>        Set Field_Options          Field Barticl.Barticl_M_Code   To DD_DISPLAYONLY
46844>>>>>>>        Set Field_Value_Table      Field Barticl.Barticl_M_Code   To (Barticl_Barticl_M_Code_VT(Self))
46845>>>>>>>
46845>>>>>>>        // Barticl.Garticl_Rec0
46845>>>>>>>        Set Field_Options          Field Barticl.Garticl_Rec0     To DD_DISPLAYONLY
46846>>>>>>>
46846>>>>>>>        // Barticl.Carticl_Rec0
46846>>>>>>>        Set Field_Options          Field Barticl.Carticl_Rec0     To DD_DISPLAYONLY
46847>>>>>>>
46847>>>>>>>        // Barticl.Varticl_Rec0
46847>>>>>>>        Set Field_Options          Field Barticl.Varticl_Rec0     To DD_DISPLAYONLY
46848>>>>>>>
46848>>>>>>>        // Barticl.Gmove_Mrec0
46848>>>>>>>        Set Field_Options          Field Barticl.Gmove_Mrec0      To DD_DISPLAYONLY
46849>>>>>>>
46849>>>>>>>        // Barticl.Gplan_Mrec0
46849>>>>>>>        Set Field_Options          Field Barticl.Gplan_Mrec0      To DD_DISPLAYONLY
46850>>>>>>>
46850>>>>>>>    End_Procedure    // Define_Fields
46851>>>>>>>
46851>>>>>>>
46851>>>>>>>    Procedure Field_Defaults
46852>>>>>>>        Forward Send Field_Defaults
46854>>>>>>>        //DDB-Generated-Code-Location
46854>>>>>>>        //DDB-FieldDefaultStart
46854>>>>>>>        //DDB-FieldDefaultEnd
46854>>>>>>>    End_Procedure    // Field_Defaults
46855>>>>>>>
46855>>>>>>>End_Class    // Barticl_DataDictionary
46856>>>>>>>//DDB-Selection-pkg-Start
46856>>>>>>>
46856>>>>>>>Use Barticl.SL       // Barticl
INCLUDING FILE: BARTICL.SL
46856>>>>>>>>>//AB/ Project Barticl:Lookup
46856>>>>>>>>>//AB/ Object prj is a Lookup_Project
46856>>>>>>>>>//AB/     Set ProjectName to "Barticl:Lookup"
46856>>>>>>>>>//AB/     Set ProjectFileName to "Barticl.SL"
46856>>>>>>>>>
46856>>>>>>>>>// Project Object Structure
46856>>>>>>>>>//   Barticl is a dbModalPanelSub
46856>>>>>>>>>//     Btypkin_DD2 is a Btypkin_DataDictionary
46856>>>>>>>>>//     Btypkin_DD is a DataDictionary
46856>>>>>>>>>//     Barticl_DD is a DataDictionary
46856>>>>>>>>>//     Country_DD is a DataDictionary
46856>>>>>>>>>//     Towns_DD is a DataDictionary
46856>>>>>>>>>//     Cities_DD is a DataDictionary
46856>>>>>>>>>//     Areas_DD is a DataDictionary
46856>>>>>>>>>//     Payresp_DD is a DataDictionary
46856>>>>>>>>>//     Clients_DD is a DataDictionary
46856>>>>>>>>>//     oSelList is a dbListSub
46856>>>>>>>>>//     Btypkin_Btypkin_Code is a dbFormSub
46856>>>>>>>>>//     Btypkin_Btypkin_Descr is a dbFormSub
46856>>>>>>>>>//     Clients_Client_Name is a dbFormSub
46856>>>>>>>>>//     cSyDateForm1 is a cSyDateForm
46856>>>>>>>>>//     chkOpen is a CheckBoxSub
46856>>>>>>>>>//     ButtonSub1 is a ButtonSub
46856>>>>>>>>>//     oOK_bn is a ButtonSub
46856>>>>>>>>>//     oCancel_bn is a ButtonSub
46856>>>>>>>>>
46856>>>>>>>>>// Register all objects
46856>>>>>>>>>Register_Object Areas_DD
46856>>>>>>>>>Register_Object Barticl
46856>>>>>>>>>Register_Object Barticl_DD
46856>>>>>>>>>Register_Object Btypkin_Btypkin_Code
46856>>>>>>>>>Register_Object Btypkin_Btypkin_Descr
46856>>>>>>>>>Register_Object Btypkin_DD
46856>>>>>>>>>Register_Object Btypkin_DD2
46856>>>>>>>>>Register_Object ButtonSub1
46856>>>>>>>>>Register_Object Cities_DD
46856>>>>>>>>>Register_Object Clients_Client_Name
46856>>>>>>>>>Register_Object Clients_DD
46856>>>>>>>>>Register_Object Country_DD
46856>>>>>>>>>Register_Object chkOpen
46856>>>>>>>>>Register_Object cSyDateForm1
46856>>>>>>>>>Register_Object oCancel_bn
46856>>>>>>>>>Register_Object oOK_bn
46856>>>>>>>>>Register_Object oSelList
46856>>>>>>>>>Register_Object Payresp_DD
46856>>>>>>>>>Register_Object Towns_DD
46856>>>>>>>>>
46856>>>>>>>>>
46856>>>>>>>>>//AB-IgnoreStart
46856>>>>>>>>>
46856>>>>>>>>>Use DFAllEnt.pkg
46856>>>>>>>>>Use dbList.Sub
46856>>>>>>>>>Use dbForm.Sub
46856>>>>>>>>>Use cSyDateForm.Pkg
46856>>>>>>>>>Use Chkbox.Sub
46856>>>>>>>>>Use Button.Sub
46856>>>>>>>>>
46856>>>>>>>>>
46856>>>>>>>>>Use BTYPKIN.DD
46856>>>>>>>>>Use BARTICL.DD
46856>>>>>>>>>Use COUNTRY.DD
46856>>>>>>>>>Use TOWNS.DD
46856>>>>>>>>>Use CITIES.DD
46856>>>>>>>>>Use AREAS.DD
46856>>>>>>>>>Use PAYRESP.DD
46856>>>>>>>>>Use CLIENTS.DD
46856>>>>>>>>>
46856>>>>>>>>>//AB-IgnoreEnd
46856>>>>>>>>>
46856>>>>>>>>>Object Barticl is a dbModalPanelSub
46858>>>>>>>>>
46858>>>>>>>>>    //AB-StoreTopStart
46858>>>>>>>>>    
46858>>>>>>>>>    Property Integer    piWhat              Public  0
46860>>>>>>>>>    Property Integer    FragmaTypkinCode    Public  0
46862>>>>>>>>>    Property Integer    piIsOpen            Public  0
46864>>>>>>>>>    Property String     FragmaClientID      Public ''
46866>>>>>>>>>    Property String     FragmaClientEpon    Public ''
46868>>>>>>>>>    Property Date       FragmaHmnia         Public ''
46870>>>>>>>>>    
46870>>>>>>>>>    Object Btypkin_DD2 is a Btypkin_DataDictionary
46872>>>>>>>>>    End_Object
46873>>>>>>>>>    
46873>>>>>>>>>    
46873>>>>>>>>>    //AB-StoreTopEnd
46873>>>>>>>>>
46873>>>>>>>>>    Set Label to "‰ ¤ã©œ ª €¥ ¦š¨á­à¤"
46874>>>>>>>>>    Set Size to 289 519
46875>>>>>>>>>    Set Location to 2 5
46876>>>>>>>>>    Set Exit_Application_Local_State to FALSE
46877>>>>>>>>>    Set Modal_State to FALSE
46878>>>>>>>>>
46878>>>>>>>>>    //AB-DDOStart
46878>>>>>>>>>
46878>>>>>>>>>    Object Btypkin_DD is a Btypkin_DataDictionary
46880>>>>>>>>>    End_Object    // Btypkin_DD
46881>>>>>>>>>
46881>>>>>>>>>    Object Barticl_DD is a Barticl_DataDictionary
46883>>>>>>>>>        Set DDO_Server to (Btypkin_DD(self))
46884>>>>>>>>>
46884>>>>>>>>>        //AB-StoreStart
46884>>>>>>>>>                    
46884>>>>>>>>>        Begin_Constraints
46886>>>>>>>>>            Integer iTypkinCode iWhat isOpen
46887>>>>>>>>>            String  sClientID sClientEpon
46887>>>>>>>>>            Date    dHmnia
46887>>>>>>>>>        
46887>>>>>>>>>            Get FragmaTypkinCode    to iTypkinCode
46888>>>>>>>>>            Get FragmaClientID      to sClientID
46889>>>>>>>>>            Get FragmaClientEpon    to sClientEpon
46890>>>>>>>>>            Get FragmaHmnia         to dHmnia
46891>>>>>>>>>            Get piIsOpen            to isOpen
46892>>>>>>>>>        
46892>>>>>>>>>            If (iTypkinCode<>'') Begin
46894>>>>>>>>>                If (sClientID<>'') Begin
46896>>>>>>>>>                    Set Ordering Of Barticl_DD to 8
46897>>>>>>>>>                    // Comp+Br+Year+Btypkin_Code+Epon1+Hmnia+Recnum
46897>>>>>>>>>                    Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
46899>>>>>>>>>                    Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
46901>>>>>>>>>                    Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
46903>>>>>>>>>                    Constrain Barticl.Btypkin_Code  Eq iTypkinCode
46905>>>>>>>>>                    Constrain Barticl.Barticl_Epon1 Eq sClientEpon
46907>>>>>>>>>                    If (dHmnia<>'') Constrain Barticl.Barticl_Hmnia Eq dHmnia
46911>>>>>>>>>                End
46911>>>>>>>>>>
46911>>>>>>>>>                Else Begin
46912>>>>>>>>>                    Set Ordering Of Barticl_DD to 11
46913>>>>>>>>>                    // Comp+Br+Year+Btypkin_Code+Hmnia+Epon1+Recnum
46913>>>>>>>>>                    Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
46915>>>>>>>>>                    Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
46917>>>>>>>>>                    Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
46919>>>>>>>>>                    Constrain Barticl.Btypkin_Code  Eq iTypkinCode
46921>>>>>>>>>                    If (dHmnia<>'') Constrain Barticl.Barticl_Hmnia Eq dHmnia
46925>>>>>>>>>                End
46925>>>>>>>>>>
46925>>>>>>>>>            End
46925>>>>>>>>>>
46925>>>>>>>>>            Else If (dHmnia<>'') Begin
46928>>>>>>>>>                Set Ordering Of Barticl_DD to 9
46929>>>>>>>>>                // Comp+Br+Year+Hmnia+Epon1+Recnum
46929>>>>>>>>>                Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
46931>>>>>>>>>                Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
46933>>>>>>>>>                Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
46935>>>>>>>>>                Constrain Barticl.Barticl_Hmnia Eq dHmnia
46937>>>>>>>>>                If (sClientID<>'') Constrain Barticl.Barticl_Epon1 Eq sClientEpon
46941>>>>>>>>>            End
46941>>>>>>>>>>
46941>>>>>>>>>            Else If (sClientID<>'') Begin
46944>>>>>>>>>                Set Ordering Of Barticl_DD to 8
46945>>>>>>>>>                // Comp+Br+Year+Epon1+Hmnia+Recnum
46945>>>>>>>>>                Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
46947>>>>>>>>>                Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
46949>>>>>>>>>                Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
46951>>>>>>>>>                Constrain Barticl.Barticl_Epon1 Eq sClientEpon
46953>>>>>>>>>            End
46953>>>>>>>>>>
46953>>>>>>>>>            Else Begin
46954>>>>>>>>>                Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
46956>>>>>>>>>                Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
46958>>>>>>>>>                Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
46960>>>>>>>>>            End
46960>>>>>>>>>>
46960>>>>>>>>>            If (isOpen) Constrain Barticl.Barticl_Ekleise NE '1'
46964>>>>>>>>>        End_Constraints
46967>>>>>>>>>        
46967>>>>>>>>>        
46967>>>>>>>>>        
46967>>>>>>>>>        
46967>>>>>>>>>        
46967>>>>>>>>>        
46967>>>>>>>>>        
46967>>>>>>>>>        
46967>>>>>>>>>        
46967>>>>>>>>>        
46967>>>>>>>>>        
46967>>>>>>>>>        
46967>>>>>>>>>        
46967>>>>>>>>>        
46967>>>>>>>>>        //AB-StoreEnd
46967>>>>>>>>>
46967>>>>>>>>>    End_Object    // Barticl_DD
46968>>>>>>>>>
46968>>>>>>>>>    Object Country_DD is a Country_DataDictionary
46970>>>>>>>>>    End_Object    // Country_DD
46971>>>>>>>>>
46971>>>>>>>>>    Object Towns_DD is a Towns_DataDictionary
46973>>>>>>>>>        Set DDO_Server to (Country_DD(self))
46974>>>>>>>>>    End_Object    // Towns_DD
46975>>>>>>>>>
46975>>>>>>>>>    Object Cities_DD is a Cities_DataDictionary
46977>>>>>>>>>        Set DDO_Server to (Towns_DD(self))
46978>>>>>>>>>    End_Object    // Cities_DD
46979>>>>>>>>>
46979>>>>>>>>>    Object Areas_DD is a Areas_DataDictionary
46981>>>>>>>>>    End_Object    // Areas_DD
46982>>>>>>>>>
46982>>>>>>>>>    Object Payresp_DD is a Payresp_DataDictionary
46984>>>>>>>>>    End_Object    // Payresp_DD
46985>>>>>>>>>
46985>>>>>>>>>    Object Clients_DD is a Clients_DataDictionary
46987>>>>>>>>>        Set DDO_Server to (Cities_DD(self))
46988>>>>>>>>>        Set DDO_Server to (Areas_DD(self))
46989>>>>>>>>>        Set DDO_Server to (Payresp_DD(self))
46990>>>>>>>>>    End_Object    // Clients_DD
46991>>>>>>>>>
46991>>>>>>>>>    Set Main_DD to (Barticl_DD(self))
46992>>>>>>>>>    Set Server to (Barticl_DD(self))
46993>>>>>>>>>
46993>>>>>>>>>    //AB-DDOEnd
46993>>>>>>>>>
46993>>>>>>>>>    Object oSelList is a dbListSub
46995>>>>>>>>>        Set Main_File to Barticl.File_Number
46996>>>>>>>>>        Set Size to 219 505
46997>>>>>>>>>        Set Location to 6 6
46998>>>>>>>>>
46998>>>>>>>>>        Begin_Row
47001>>>>>>>>>            Entry_Item Barticl.Barticl_no
47002>>>>>>>>>            Entry_Item Barticl.Barticl_hmnia
47003>>>>>>>>>            Entry_Item Btypkin.Btypkin_code
47004>>>>>>>>>            Entry_Item Btypkin.Btypkin_descr
47005>>>>>>>>>            Entry_Item Barticl.Barticl_code1
47006>>>>>>>>>            Entry_Item Barticl.Barticl_epon1
47007>>>>>>>>>            Entry_Item Barticl.Barticl_sv0
47008>>>>>>>>>            Entry_Item Barticl.Barticl_ekleise
47009>>>>>>>>>        End_Row
47014>>>>>>>>>
47014>>>>>>>>>        Set Form_Width    item 0 to 53
47015>>>>>>>>>        Set Header_Label  item 0 to "€¨ Ÿ£æª"
47016>>>>>>>>>        
47016>>>>>>>>>        Set Form_Width    item 1 to 48
47017>>>>>>>>>        Set Header_Label  item 1 to "†£œ¨/¤å˜"
47018>>>>>>>>>        
47018>>>>>>>>>        Set Form_Width    item 2 to 39
47019>>>>>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž"
47020>>>>>>>>>        
47020>>>>>>>>>        Set Form_Width    item 3 to 100
47021>>>>>>>>>        Set Header_Label  item 3 to "œ¨ š¨˜­ã"
47022>>>>>>>>>        
47022>>>>>>>>>        Set Form_Width    item 4 to 60
47023>>>>>>>>>        Set Header_Label  item 4 to "‘¬¤˜¢/¤¦ª"
47024>>>>>>>>>        
47024>>>>>>>>>        Set Form_Width    item 5 to 122
47025>>>>>>>>>        Set Header_Label  item 5 to "„§à¤¬£å˜"
47026>>>>>>>>>        
47026>>>>>>>>>        Set Form_Width    item 6 to 60
47027>>>>>>>>>        Set Header_Label  item 6 to "¦©æ"
47028>>>>>>>>>        
47028>>>>>>>>>        Set Form_Width    item 7 to 16
47029>>>>>>>>>        Set Header_Label  item 7 to "‰"
47030>>>>>>>>>        Set Column_Checkbox_State  item 7 to True
47031>>>>>>>>>        
47031>>>>>>>>>
47031>>>>>>>>>        //AB-StoreStart
47031>>>>>>>>>                                                
47031>>>>>>>>>        //Property Integer StoreFragmaTypkinCode  Public 0
47031>>>>>>>>>        //Property String  StoreFragmaClientID    Public ''
47031>>>>>>>>>        //Property String  StoreFragmaClientEpon  Public ''
47031>>>>>>>>>        //Property Date    StoreFragmaHmnia       Public ''
47031>>>>>>>>>        
47031>>>>>>>>>        Procedure End_Construct_Object
47033>>>>>>>>>            Integer iDecimals
47034>>>>>>>>>            Forward Send End_Construct_Object
47036>>>>>>>>>            Get fiDekadika_Nomismatos SysCurXr.C_Code0   to    iDecimals
47037>>>>>>>>>            Set Points Item 6 to iDecimals
47038>>>>>>>>>            Set Numeric_Mask Item 6 to 14 iDecimals ' ,*'
47039>>>>>>>>>        End_Procedure
47040>>>>>>>>>        
47040>>>>>>>>>        //Procedure Store_Defaults
47040>>>>>>>>>        //       Forward Send Store_Defaults
47040>>>>>>>>>        //       Set StoreFragmaTypkinCode    to (FragmaTypkinCode(Self))
47040>>>>>>>>>        //       Set StoreFragmaClientID      to (FragmaClientID  (Self))
47040>>>>>>>>>        //       Set StoreFragmaClientEpon    to (FragmaClientEpon(Self))
47040>>>>>>>>>        //       Set StoreFragmaHmnia         to (FragmaHmnia     (Self))
47040>>>>>>>>>        //End_Procedure
47040>>>>>>>>>        
47040>>>>>>>>>        //Procedure ReStore_Defaults
47040>>>>>>>>>        //       Forward Send ReStore_Defaults
47040>>>>>>>>>        //       Set FragmaTypkinCode to (StoreFragmaTypkinCode(Self))
47040>>>>>>>>>        //       Set FragmaClientID   to (StoreFragmaClientID  (Self))
47040>>>>>>>>>        //       Set FragmaClientEpon to (StoreFragmaClientEpon(Self))
47040>>>>>>>>>        //       Set FragmaHmnia      to (StoreFragmaHmnia     (Self))
47040>>>>>>>>>        //End_Procedure
47040>>>>>>>>>        
47040>>>>>>>>>        Procedure Activate
47042>>>>>>>>>            Send Keyaction to ButtonSub1
47043>>>>>>>>>            Forward Send Activate
47045>>>>>>>>>        End_procedure
47046>>>>>>>>>        
47046>>>>>>>>>        Procedure Activating
47048>>>>>>>>>            Forward Send Activating
47050>>>>>>>>>            Set Auto_Index_State to True
47051>>>>>>>>>        End_Procedure
47052>>>>>>>>>        
47052>>>>>>>>>        
47052>>>>>>>>>        
47052>>>>>>>>>        
47052>>>>>>>>>        
47052>>>>>>>>>        
47052>>>>>>>>>        
47052>>>>>>>>>        
47052>>>>>>>>>        
47052>>>>>>>>>        
47052>>>>>>>>>        
47052>>>>>>>>>        
47052>>>>>>>>>        
47052>>>>>>>>>        
47052>>>>>>>>>        
47052>>>>>>>>>        
47052>>>>>>>>>        
47052>>>>>>>>>        
47052>>>>>>>>>        
47052>>>>>>>>>        
47052>>>>>>>>>        
47052>>>>>>>>>        //AB-StoreEnd
47052>>>>>>>>>
47052>>>>>>>>>    End_Object    // oSelList
47053>>>>>>>>>
47053>>>>>>>>>    Object Btypkin_Btypkin_Code is a dbFormSub
47055>>>>>>>>>        Entry_Item Btypkin.Btypkin_code
47056>>>>>>>>>        Set Label to "’ç§¦ª ‰å¤ž©žª"
47057>>>>>>>>>        Set Size to 13 49
47058>>>>>>>>>        Set Location to 229 84
47059>>>>>>>>>        Set Label_Col_Offset to 5
47060>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
47061>>>>>>>>>
47061>>>>>>>>>        //AB-StoreStart
47061>>>>>>>>>                                                                                            
47061>>>>>>>>>        Set Server to (Btypkin_DD2(Self))
47062>>>>>>>>>        
47062>>>>>>>>>        Procedure Key Integer iKey
47064>>>>>>>>>            Integer iRetVal
47065>>>>>>>>>            Forward Send Key iKey
47067>>>>>>>>>            If (iKey=277) Send Clear to Btypkin_DD2
47070>>>>>>>>>        End_Procedure
47071>>>>>>>>>        
47071>>>>>>>>>        
47071>>>>>>>>>        //AB-StoreEnd
47071>>>>>>>>>
47071>>>>>>>>>    End_Object    // Btypkin_Btypkin_Code
47072>>>>>>>>>
47072>>>>>>>>>    Object Btypkin_Btypkin_Descr is a dbFormSub
47074>>>>>>>>>        Entry_Item Btypkin.Btypkin_descr
47075>>>>>>>>>        Set Size to 13 133
47076>>>>>>>>>        Set Location to 229 139
47077>>>>>>>>>        Set Color to clBtnFace
47078>>>>>>>>>        Set Label_Col_Offset to 2
47079>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
47080>>>>>>>>>        Set Enabled_State to FALSE
47081>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
47082>>>>>>>>>        Set Shadow_State Item 0 to TRUE
47083>>>>>>>>>
47083>>>>>>>>>        //AB-StoreStart
47083>>>>>>>>>        Set Server to (Btypkin_DD2(Self))
47084>>>>>>>>>        
47084>>>>>>>>>        //AB-StoreEnd
47084>>>>>>>>>
47084>>>>>>>>>    End_Object    // Btypkin_Btypkin_Descr
47085>>>>>>>>>
47085>>>>>>>>>    Object Clients_Client_Name is a dbFormSub
47087>>>>>>>>>        Entry_Item Clients.Client_name
47088>>>>>>>>>        Set Server to (Clients_DD(self))
47089>>>>>>>>>        Set Label to "‘¬¤˜¢¢˜©æ£œ¤¦ª"
47090>>>>>>>>>        Set Size to 13 188
47091>>>>>>>>>        Set Location to 244 84
47092>>>>>>>>>        Set Label_Col_Offset to 5
47093>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
47094>>>>>>>>>
47094>>>>>>>>>        //AB-StoreStart
47094>>>>>>>>>                                                                                            
47094>>>>>>>>>        Procedure Key Integer iKey
47096>>>>>>>>>            Integer iRetVal
47097>>>>>>>>>            Forward Send Key iKey
47099>>>>>>>>>            If (iKey=277) Send Clear to Clients_DD
47102>>>>>>>>>        End_Procedure
47103>>>>>>>>>        
47103>>>>>>>>>        //AB-StoreEnd
47103>>>>>>>>>
47103>>>>>>>>>    End_Object    // Clients_Client_Name
47104>>>>>>>>>
47104>>>>>>>>>    Object cSyDateForm1 is a cSyDateForm
47106>>>>>>>>>        Set Label to "†£œ¨¦£ž¤å˜"
47107>>>>>>>>>        Set Size to 13 66
47108>>>>>>>>>        Set Location to 258 84
47109>>>>>>>>>        Set Label_Col_Offset to 5
47110>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
47111>>>>>>>>>        Set Form_Mask Item 0 to "dd/MM/yyyy"
47112>>>>>>>>>
47112>>>>>>>>>        //AB-StoreStart
47112>>>>>>>>>                                                                                            
47112>>>>>>>>>        On_Key KClear Send ClearMe
47113>>>>>>>>>        
47113>>>>>>>>>        Procedure ClearMe
47115>>>>>>>>>            Set Value Item 0 to ''
47116>>>>>>>>>        End_Procedure
47117>>>>>>>>>        
47117>>>>>>>>>        //AB-StoreEnd
47117>>>>>>>>>
47117>>>>>>>>>    End_Object    // cSyDateForm1
47118>>>>>>>>>
47118>>>>>>>>>    Object chkOpen is a CheckBoxSub
47120>>>>>>>>>        Set Label to "‹æ¤¦ ˜¤¦ ®«á"
47121>>>>>>>>>        Set Size to 10 62
47122>>>>>>>>>        Set Location to 260 156
47123>>>>>>>>>    End_Object    // chkOpen
47124>>>>>>>>>
47124>>>>>>>>>    Object ButtonSub1 is a ButtonSub
47126>>>>>>>>>        Set Label to "œ¨ æ¨ ©œ"
47127>>>>>>>>>        Set Size to 13 52
47128>>>>>>>>>        Set Location to 258 219
47129>>>>>>>>>
47129>>>>>>>>>        //AB-StoreStart
47129>>>>>>>>>                            
47129>>>>>>>>>        Procedure OnClick
47131>>>>>>>>>            String  sEpon sID
47132>>>>>>>>>            Integer iTypkin isOpen
47132>>>>>>>>>            Date    dHmnia
47132>>>>>>>>>        
47132>>>>>>>>>            Get Value Of cSyDateForm1 Item 0                                  to dHmnia
47133>>>>>>>>>            Get Field_Current_Value Of Clients_DD  Field Clients.Client_ID    to sID
47134>>>>>>>>>            Get Field_Current_Value Of Clients_DD  Field Clients.Client_Name  to sEpon
47135>>>>>>>>>            Get Field_Current_Value Of Btypkin_DD2 Field Btypkin.Btypkin_Code to iTypkin
47136>>>>>>>>>        
47136>>>>>>>>>            Get Checked_State Of chkOpen to isOpen
47137>>>>>>>>>        
47137>>>>>>>>>            Set FragmaTypkinCode    to iTypkin
47138>>>>>>>>>            Set FragmaClientID      to sID
47139>>>>>>>>>            Set FragmaClientEpon    to sEpon
47140>>>>>>>>>            Set FragmaHmnia         to dHmnia
47141>>>>>>>>>            Set piIsOpen            to isOpen
47142>>>>>>>>>        
47142>>>>>>>>>            Send Rebuild_Constraints    to Barticl_DD
47143>>>>>>>>>            Send Beginning_Of_Data      to oSelList True
47144>>>>>>>>>        End_Procedure // OnClick
47145>>>>>>>>>        
47145>>>>>>>>>        
47145>>>>>>>>>        
47145>>>>>>>>>        //AB-StoreEnd
47145>>>>>>>>>
47145>>>>>>>>>    End_Object    // ButtonSub1
47146>>>>>>>>>
47146>>>>>>>>>    Object oOK_bn is a ButtonSub
47148>>>>>>>>>        Set Label to "&„§ ¢¦šã"
47149>>>>>>>>>        Set Size to 13 50
47150>>>>>>>>>        Set Location to 258 406
47151>>>>>>>>>        Set Focus_Mode to Pointer_Only
47152>>>>>>>>>
47152>>>>>>>>>        //AB-StoreStart
47152>>>>>>>>>        Procedure OnClick
47154>>>>>>>>>            Send OK To (oSelList(current_object))
47155>>>>>>>>>        End_Procedure
47156>>>>>>>>>        //AB-StoreEnd
47156>>>>>>>>>
47156>>>>>>>>>    End_Object    // oOK_bn
47157>>>>>>>>>
47157>>>>>>>>>    Object oCancel_bn is a ButtonSub
47159>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
47160>>>>>>>>>        Set Size to 13 50
47161>>>>>>>>>        Set Location to 258 461
47162>>>>>>>>>        Set Focus_Mode to Pointer_Only
47163>>>>>>>>>
47163>>>>>>>>>        //AB-StoreStart
47163>>>>>>>>>        Procedure OnClick
47165>>>>>>>>>            Send Cancel To (oSelList(current_object))
47166>>>>>>>>>        End_Procedure
47167>>>>>>>>>        //AB-StoreEnd
47167>>>>>>>>>
47167>>>>>>>>>    End_Object    // oCancel_bn
47168>>>>>>>>>
47168>>>>>>>>>
47168>>>>>>>>>    //AB-StoreStart
47168>>>>>>>>>    
47168>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
47169>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
47170>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
47171>>>>>>>>>    
47171>>>>>>>>>    Set Modal_State to True
47172>>>>>>>>>    
47172>>>>>>>>>    Procedure Activate
47174>>>>>>>>>        If (FragmaTypkinCode(Self)<>0) Begin
47176>>>>>>>>>            Send Clear to Btypkin_DD2
47177>>>>>>>>>            Move (FragmaTypkinCode(Self)) to Btypkin.Btypkin_Code
47178>>>>>>>>>            Send Find to Btypkin_DD2 Eq 1
47179>>>>>>>>>        End
47179>>>>>>>>>>
47179>>>>>>>>>        Else Send Clear to Btypkin_DD2
47181>>>>>>>>>        If (FragmaClientID(Self)<>'') Begin
47183>>>>>>>>>            Send Clear to Clients_DD
47184>>>>>>>>>            Move (FragmaClientID(Self)) to Clients.Client_ID
47185>>>>>>>>>            Send Find to Clients_DD Eq 6
47186>>>>>>>>>        End
47186>>>>>>>>>>
47186>>>>>>>>>        Else Send Clear to Clients_DD
47188>>>>>>>>>        If (FragmaHmnia(Self)<>'') Set Value Of cSyDateForm1 Item 0 to (FragmaHmnia(Self))
47191>>>>>>>>>        Else                       Set Value Of cSyDateForm1 Item 0 to ''
47193>>>>>>>>>        Forward Send Activate
47195>>>>>>>>>    End_Procedure
47196>>>>>>>>>    
47196>>>>>>>>>    //AB-StoreEnd
47196>>>>>>>>>
47196>>>>>>>>>End_Object    // Barticl
47197>>>>>>>>>
47197>>>>>>>>>//AB/ End_Object    // prj
47197>>>>>>>Use sl041.SL         // sl041
47197>>>>>>>
47197>>>>>>>//DDB-Selection-pkg-End
47197>>>>>>>//DDB-FileEnd
47197>>>>>
47197>>>>>//AB-IgnoreEnd
47197>>>>>
47197>>>>>Object SL036 is a dbModalPanelSub
47199>>>>>
47199>>>>>    //AB-StoreTopStart
47199>>>>>    Property String     psClientID      Public ''
47201>>>>>    Property String     psEponymo       Public ''
47203>>>>>    Property Date       pdHmnia         Public ''
47205>>>>>    Property Integer    piTypkinCode    Public  0
47207>>>>>    
47207>>>>>    
47207>>>>>    //AB-StoreTopEnd
47207>>>>>
47207>>>>>    Set Label to "‰ ¤ã©œ ª  €¥ ¦š¨á­à¤"
47208>>>>>    Set Size to 288 522
47209>>>>>    Set Location to 6 3
47210>>>>>    Set Exit_Application_Local_State to FALSE
47211>>>>>    Set Modal_State to FALSE
47212>>>>>
47212>>>>>    //AB-DDOStart
47212>>>>>
47212>>>>>    Object Btypkin_DD is a Btypkin_DataDictionary
47214>>>>>    End_Object    // Btypkin_DD
47215>>>>>
47215>>>>>    Object Barticl_DD is a Barticl_DataDictionary
47217>>>>>        Set DDO_Server to (Btypkin_DD(self))
47218>>>>>
47218>>>>>        //AB-StoreStart
47218>>>>>        
47218>>>>>        Begin_Constraints
47220>>>>>            String  sClientID
47221>>>>>            Date    dHmnia
47221>>>>>            Integer iTypkinCode
47221>>>>>        
47221>>>>>            Get piTypkinCode    to iTypkinCode
47222>>>>>            Get psClientID      to sClientID
47223>>>>>            Get pdHmnia         to dHmnia
47224>>>>>        
47224>>>>>            Constrain Barticl.Company_Code  Eq Syscurxr.Company_Code
47226>>>>>            Constrain Barticl.Branch_Code   Eq Syscurxr.Branch_Code
47228>>>>>            Constrain Barticl.Year_Year     Eq Syscurxr.Year_Year
47230>>>>>        
47230>>>>>            If (sClientID  <> 0) Begin
47232>>>>>                If (iTypkinCode<> 0) Begin
47234>>>>>                    Set Ordering to 8
47235>>>>>                    Constrain Barticl.Btypkin_Code  Eq iTypkinCode
47237>>>>>                    Constrain Barticl.Barticl_Code1 Eq sClientID
47239>>>>>                End
47239>>>>>>
47239>>>>>                Else Begin
47240>>>>>                    Set Ordering to 10
47241>>>>>                    Constrain Barticl.Barticl_Code1 Eq sClientID
47243>>>>>                End
47243>>>>>>
47243>>>>>            End
47243>>>>>>
47243>>>>>            Else If (dHmnia     <>'') Begin
47246>>>>>                Set Ordering to 9
47247>>>>>                Constrain Barticl.Barticl_Hmnia Eq dHmnia
47249>>>>>            End
47249>>>>>>
47249>>>>>            Else If (iTypkinCode<> 0) Begin
47252>>>>>                Set Ordering to 1
47253>>>>>                Constrain Barticl.Btypkin_Code  Eq iTypkinCode
47255>>>>>            End
47255>>>>>>
47255>>>>>        End_Constraints
47258>>>>>        
47258>>>>>        //AB-StoreEnd
47258>>>>>
47258>>>>>    End_Object    // Barticl_DD
47259>>>>>
47259>>>>>    Set Main_DD to (Barticl_DD(self))
47260>>>>>    Set Server to (Barticl_DD(self))
47261>>>>>
47261>>>>>    //AB-DDOEnd
47261>>>>>
47261>>>>>    Object oSelList is a dbListSub
47263>>>>>        Set Main_File to Barticl.File_Number
47264>>>>>        Set Server to (Btypkin_DD(self))
47265>>>>>        Set Size to 238 508
47266>>>>>        Set Location to 4 5
47267>>>>>
47267>>>>>        Begin_Row
47270>>>>>            Entry_Item Barticl.Barticl_no
47271>>>>>            Entry_Item Barticl.Barticl_hmnia
47272>>>>>            Entry_Item Btypkin.Btypkin_code
47273>>>>>            Entry_Item Btypkin.Btypkin_descr
47274>>>>>            Entry_Item Barticl.Barticl_epon1
47275>>>>>            Entry_Item Barticl.Barticl_sv0
47276>>>>>        End_Row
47281>>>>>
47281>>>>>        Set Form_Width    item 0 to 84
47282>>>>>        Set Header_Label  item 0 to "€¨ Ÿ£æª"
47283>>>>>        
47283>>>>>        Set Form_Width    item 1 to 57
47284>>>>>        Set Header_Label  item 1 to "†£œ¨¦£ž¤å˜"
47285>>>>>        
47285>>>>>        Set Form_Width    item 2 to 41
47286>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž"
47287>>>>>        
47287>>>>>        Set Form_Width    item 3 to 157
47288>>>>>        Set Header_Label  item 3 to "œ¨ š¨˜­ã"
47289>>>>>        
47289>>>>>        Set Form_Width    item 4 to 102
47290>>>>>        Set Header_Label  item 4 to "‘¬¤˜¢¢˜©æ£œ¤¦ª"
47291>>>>>        
47291>>>>>        Set Form_Width    item 5 to 60
47292>>>>>        Set Header_Label  item 5 to "¦©æ"
47293>>>>>        
47293>>>>>
47293>>>>>        //AB-StoreStart
47293>>>>>                                                
47293>>>>>        Set Numeric_mask Item 5 to 14 0 ' ,*'
47294>>>>>        
47294>>>>>        Procedure Activating
47296>>>>>            Send Rebuild_Constraints    to Barticl_DD
47297>>>>>            Send Beginning_Of_Data      to oSelList True
47298>>>>>            Forward Send Activating
47300>>>>>        End_Procedure
47301>>>>>        
47301>>>>>        
47301>>>>>        
47301>>>>>        
47301>>>>>        
47301>>>>>        
47301>>>>>        //AB-StoreEnd
47301>>>>>
47301>>>>>    End_Object    // oSelList
47302>>>>>
47302>>>>>    Object oOK_bn is a ButtonSub
47304>>>>>        Set Label to "&„§ ¢¦šã"
47305>>>>>        Set Location to 255 354
47306>>>>>
47306>>>>>        //AB-StoreStart
47306>>>>>        Procedure OnClick
47308>>>>>            Send OK To oSelList
47309>>>>>        End_Procedure
47310>>>>>        //AB-StoreEnd
47310>>>>>
47310>>>>>    End_Object    // oOK_bn
47311>>>>>
47311>>>>>    Object oCancel_bn is a ButtonSub
47313>>>>>        Set Label to "&€¡ç¨à©ž"
47314>>>>>        Set Location to 255 410
47315>>>>>
47315>>>>>        //AB-StoreStart
47315>>>>>        Procedure OnClick
47317>>>>>            Send Cancel To oSelList
47318>>>>>        End_Procedure
47319>>>>>        //AB-StoreEnd
47319>>>>>
47319>>>>>    End_Object    // oCancel_bn
47320>>>>>
47320>>>>>    Object oSearch_bn is a ButtonSub
47322>>>>>        Set Label to "€&¤˜ã«ž©ž"
47323>>>>>        Set Location to 255 464
47324>>>>>
47324>>>>>        //AB-StoreStart
47324>>>>>        Procedure OnClick
47326>>>>>            Send Search To oSelList
47327>>>>>        End_Procedure
47328>>>>>        //AB-StoreEnd
47328>>>>>
47328>>>>>    End_Object    // oSearch_bn
47329>>>>>
47329>>>>>
47329>>>>>    //AB-StoreStart
47329>>>>>    On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
47330>>>>>    On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
47331>>>>>    On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
47332>>>>>    
47332>>>>>    
47332>>>>>    
47332>>>>>    
47332>>>>>    
47332>>>>>    
47332>>>>>    
47332>>>>>    
47332>>>>>    //AB-StoreEnd
47332>>>>>
47332>>>>>End_Object    // SL036
47333>>>>>
47333>>>>>//AB/ End_Object    // prj
47333>>>Use sl036r.sl
INCLUDING FILE: SL036R.SL
47333>>>>>//AB/ Project sl036r:Barticle with recr 1st col
47333>>>>>//AB/     Object prj is a Lookup_Project
47333>>>>>//AB/         Set ProjectName to "sl036r:Barticle with recr 1st col"
47333>>>>>//AB/         Set ProjectFileName to "sl036r.SL"
47333>>>>>//AB/         Set GenerateFileName to "NONAME"
47333>>>>>
47333>>>>>// Project Object Structure
47333>>>>>//   sl036r is a dbModalPanelSub
47333>>>>>//     Btypkin_DD is a DataDictionary
47333>>>>>//     Barticl_DD is a DataDictionary
47333>>>>>//     oSelList is a dbListSub
47333>>>>>//     oOK_bn is a ButtonSub
47333>>>>>//     oCancel_bn is a ButtonSub
47333>>>>>//     oSearch_bn is a ButtonSub
47333>>>>>
47333>>>>>// Register all objects
47333>>>>>Register_Object Barticl_DD
47333>>>>>Register_Object Btypkin_DD
47333>>>>>Register_Object oCancel_bn
47333>>>>>Register_Object oOK_bn
47333>>>>>Register_Object oSearch_bn
47333>>>>>Register_Object oSelList
47333>>>>>Register_Object sl036r
47333>>>>>
47333>>>>>
47333>>>>>    //AB-IgnoreStart
47333>>>>>
47333>>>>>    Use DFAllEnt.pkg
47333>>>>>    Use dbList.Sub
47333>>>>>    Use Button.Sub
47333>>>>>
47333>>>>>
47333>>>>>    Use BTYPKIN.DD
47333>>>>>    Use BARTICL.DD
47333>>>>>    
47333>>>>>    //AB-IgnoreEnd
47333>>>>>
47333>>>>>    CD_Popup_Object sl036r is a dbModalPanelSub
47352>>>>>        set label to "‰ ¤ã©œ ª  €¥ ¦š¨á­à¤" 
47353>>>>>        Set Size to 148 440
47354>>>>>        Set Location to 4 5
47355>>>>>        Set Exit_Application_Local_State to FALSE
47356>>>>>        Set Modal_State to FALSE
47357>>>>>
47357>>>>>        //AB-DDOStart
47357>>>>>
47357>>>>>        Object Btypkin_DD is a Btypkin_DataDictionary
47359>>>>>        End_Object    // Btypkin_DD
47360>>>>>
47360>>>>>        Object Barticl_DD is a Barticl_DataDictionary
47362>>>>>            Set DDO_Server to (Btypkin_DD(self))
47363>>>>>        End_Object    // Barticl_DD
47364>>>>>
47364>>>>>        Set Main_DD to (Barticl_DD(self))
47365>>>>>        Set Server to (Barticl_DD(self))
47366>>>>>
47366>>>>>        //AB-DDOEnd
47366>>>>>
47366>>>>>        Object oSelList is a dbListSub
47368>>>>>            Set Main_File to Barticl.File_Number
47369>>>>>            Set Server to (Btypkin_DD(self))
47370>>>>>            Set Size to 105 424
47371>>>>>            Set Location to 6 6
47372>>>>>
47372>>>>>            Begin_Row
47375>>>>>                Entry_Item Barticl.Barticl_recr
47376>>>>>                Entry_Item Barticl.Barticl_no
47377>>>>>                Entry_Item Barticl.Barticl_hmnia
47378>>>>>                Entry_Item Btypkin.Btypkin_code
47379>>>>>                Entry_Item Btypkin.Btypkin_descr
47380>>>>>            End_Row
47385>>>>>
47385>>>>>            Set Form_Width    item 0 to 56
47386>>>>>            Set Header_Label  item 0 to "Barticl recr"
47387>>>>>            
47387>>>>>            Set Form_Width    item 1 to 84
47388>>>>>            set header_label  item 1 to "€¨ Ÿ£æª" 
47389>>>>>            
47389>>>>>            Set Form_Width    item 2 to 60
47390>>>>>            set header_label  item 2 to "†£œ¨¦£ž¤å˜" 
47391>>>>>            
47391>>>>>            Set Form_Width    item 3 to 38
47392>>>>>            set header_label  item 3 to "‰å¤ž©ž" 
47393>>>>>            
47393>>>>>            Set Form_Width    item 4 to 179
47394>>>>>            set header_label  item 4 to "œ¨ š¨˜­ã" 
47395>>>>>            
47395>>>>>
47395>>>>>            //AB-StoreStart
47395>>>>>            Set Column_Option Item 0 to NoEnter True
47396>>>>>            
47396>>>>>            //AB-StoreEnd
47396>>>>>
47396>>>>>        End_Object    // oSelList
47397>>>>>
47397>>>>>        Object oOK_bn is a ButtonSub
47399>>>>>            set label to "&„§ ¢¦šã" 
47400>>>>>            Set Location to 114 271
47401>>>>>
47401>>>>>            //AB-StoreStart
47401>>>>>            Procedure OnClick
47403>>>>>                Send OK To oSelList
47404>>>>>            End_Procedure
47405>>>>>            //AB-StoreEnd
47405>>>>>
47405>>>>>        End_Object    // oOK_bn
47406>>>>>
47406>>>>>        Object oCancel_bn is a ButtonSub
47408>>>>>            set label to "&€¡ç¨à©ž" 
47409>>>>>            Set Location to 114 327
47410>>>>>
47410>>>>>            //AB-StoreStart
47410>>>>>            Procedure OnClick
47412>>>>>                Send Cancel To oSelList
47413>>>>>            End_Procedure
47414>>>>>            //AB-StoreEnd
47414>>>>>
47414>>>>>        End_Object    // oCancel_bn
47415>>>>>
47415>>>>>        Object oSearch_bn is a ButtonSub
47417>>>>>            set label to "€&¤˜ã«ž©ž" 
47418>>>>>            Set Location to 114 381
47419>>>>>
47419>>>>>            //AB-StoreStart
47419>>>>>            Procedure OnClick
47421>>>>>                Send Search To oSelList
47422>>>>>            End_Procedure
47423>>>>>            //AB-StoreEnd
47423>>>>>
47423>>>>>        End_Object    // oSearch_bn
47424>>>>>
47424>>>>>
47424>>>>>        //AB-StoreStart
47424>>>>>        On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
47425>>>>>        On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
47426>>>>>        On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
47427>>>>>        
47427>>>>>        //AB-StoreEnd
47427>>>>>
47427>>>>>    CD_End_Object    // sl036r
47429>>>>>>
47429>>>>>
47429>>>>>//AB/     End_Object    // prj
47429>>>Use sl037.sl
INCLUDING FILE: SL037.SL
47429>>>>>//AB/ Project SL037:BAXIO
47429>>>>>//AB/ Object prj is a Lookup_Project
47429>>>>>//AB/     Set ProjectName to "SL037:BAXIO"
47429>>>>>//AB/     Set ProjectFileName to "SL037.SL"
47429>>>>>
47429>>>>>// Project Object Structure
47429>>>>>//   SL037 is a dbModalPanelSub
47429>>>>>//     Baxiokat_DD is a DataDictionary
47429>>>>>//     Baxio_DD is a DataDictionary
47429>>>>>//     oSelList is a dbListSub
47429>>>>>//     TextBoxSub1 is a TextBoxSub
47429>>>>>//     cSyDateForm1 is a cSyDateForm
47429>>>>>//     TextBoxSub2 is a TextBoxSub
47429>>>>>//     cSyDateForm2 is a cSyDateForm
47429>>>>>//     TextBoxSub4 is a TextBoxSub
47429>>>>>//     TextBoxSub5 is a TextBoxSub
47429>>>>>//     FormSub1 is a FormSub
47429>>>>>//     FormSub2 is a FormSub
47429>>>>>//     FormSub3 is a FormSub
47429>>>>>//     FormSub4 is a FormSub
47429>>>>>//     ButtonSub1 is a ButtonSub
47429>>>>>//     oOK_bn is a ButtonSub
47429>>>>>
47429>>>>>// Register all objects
47429>>>>>Register_Object Baxio_DD
47429>>>>>Register_Object Baxiokat_DD
47429>>>>>Register_Object ButtonSub1
47429>>>>>Register_Object cSyDateForm1
47429>>>>>Register_Object cSyDateForm2
47429>>>>>Register_Object FormSub1
47429>>>>>Register_Object FormSub2
47429>>>>>Register_Object FormSub3
47429>>>>>Register_Object FormSub4
47429>>>>>Register_Object oOK_bn
47429>>>>>Register_Object oSelList
47429>>>>>Register_Object SL037
47429>>>>>Register_Object TextBoxSub1
47429>>>>>Register_Object TextBoxSub2
47429>>>>>Register_Object TextBoxSub4
47429>>>>>Register_Object TextBoxSub5
47429>>>>>
47429>>>>>
47429>>>>>//AB-IgnoreStart
47429>>>>>
47429>>>>>Use DFAllEnt.pkg
47429>>>>>Use dbList.Sub
47429>>>>>Use Txtbox.Sub
47429>>>>>Use cSyDateForm.Pkg
47429>>>>>Use Form.Sub
47429>>>>>Use Button.Sub
47429>>>>>
47429>>>>>
47429>>>>>Use BAXIOKAT.DD
47429>>>>>Use BAXIO.DD
INCLUDING FILE: BAXIO.DD
47429>>>>>>>//DDB-FileStart
47429>>>>>>>//DDB-HeaderStart
47429>>>>>>>
47429>>>>>>>// File Name : BAXIO.DD
47429>>>>>>>// Class Name: Baxio_DataDictionary
47429>>>>>>>// Revision  : 106
47429>>>>>>>// Version   : 2
47429>>>>>>>
47429>>>>>>>Use  Windows           // Basic Definitions
47429>>>>>>>Use  DataDict          // DataDictionary Class Definition
47429>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
47429>>>>>>>
47429>>>>>>>Open Baxio
47431>>>>>>>Open Bmove
47433>>>>>>>Open Baxiokat
47435>>>>>>>Open Sysrecb
47437>>>>>>>
47437>>>>>>>//DDB-HeaderEnd
47437>>>>>>>//DDB-ValidationStart
47437>>>>>>>
47437>>>>>>>//DDB/ ExternalValidationTable Baxio_Status_VT  Baxio.pkg
47437>>>>>>>//DDB/ ExternalValidationTable Bfile_VT  Baxio.pkg
47437>>>>>>>
47437>>>>>>>Register_Object Baxio_Status_VT
47437>>>>>>>Register_Object Baxio_Baxio_Place_VT
47437>>>>>>>Register_Object Bfile_VT
47437>>>>>>>Register_Object Baxio_Baxio_Bank_VT
47437>>>>>>>Register_Object Baxio_Baxio_Banka_VT
47437>>>>>>>Register_Object Baxio_Baxio_From_VT
47437>>>>>>>Register_Object Baxio_Baxio_Topos_VT1
47437>>>>>>>Use Baxio.pkg        // Baxio_Status_VT, Bfile_VT
47437>>>>>>>
47437>>>>>>>Object Baxio_Baxio_Place_VT  is a CodeValidationTable
47439>>>>>>>    Set Type_Value        To "BAXIOPLACE"
47440>>>>>>>    //DDB-ValidationCustomStart
47440>>>>>>>    //DDB-ValidationCustomEnd
47440>>>>>>>End_Object   // Baxio_Baxio_Place_VT
47441>>>>>>>
47441>>>>>>>Object Baxio_Baxio_Bank_VT  is a CodeValidationTable
47443>>>>>>>    Set Type_Value        To "BANK"
47444>>>>>>>    Set Allow_Blank_State To TRUE
47445>>>>>>>    //DDB-ValidationCustomStart
47445>>>>>>>    //DDB-ValidationCustomEnd
47445>>>>>>>End_Object   // Baxio_Baxio_Bank_VT
47446>>>>>>>
47446>>>>>>>Object Baxio_Baxio_Banka_VT  is a CodeValidationTable
47448>>>>>>>    Set Type_Value        To "BANK"
47449>>>>>>>    Set Allow_Blank_State To TRUE
47450>>>>>>>    //DDB-ValidationCustomStart
47450>>>>>>>    //DDB-ValidationCustomEnd
47450>>>>>>>End_Object   // Baxio_Baxio_Banka_VT
47451>>>>>>>
47451>>>>>>>Object Baxio_Baxio_From_VT  is a DescriptionValidationTable
47453>>>>>>>    Set Allow_Blank_State To TRUE
47454>>>>>>>    Set Table_Title       To "€¥ æš¨˜­¦  ›å¦¬ / «¨å«¦¬"
47455>>>>>>>
47455>>>>>>>    Procedure Fill_List
47457>>>>>>>        Forward Send Fill_List
47459>>>>>>>        Send Add_Table_Value  "0"  "ˆ›å¦¬"
47460>>>>>>>        Send Add_Table_Value  "1"  "’¨å«¦¬"
47461>>>>>>>    End_Procedure    // Fill_List
47462>>>>>>>    //DDB-ValidationCustomStart
47462>>>>>>>    //DDB-ValidationCustomEnd
47462>>>>>>>End_Object   // Baxio_Baxio_From_VT
47463>>>>>>>
47463>>>>>>>Object Baxio_Baxio_Topos_VT1  is a DescriptionValidationTable
47465>>>>>>>    Set Allow_Blank_State To TRUE
47466>>>>>>>    Set Table_Title       To "€¥ æš¨˜­¦ €«« ¡ãª / „§˜¨®å˜ª"
47467>>>>>>>
47467>>>>>>>    Procedure Fill_List
47469>>>>>>>        Forward Send Fill_List
47471>>>>>>>        Send Add_Table_Value  "0"  "€«« ¡ãª"
47472>>>>>>>        Send Add_Table_Value  "1"  "„§˜¨®å˜ª"
47473>>>>>>>    End_Procedure    // Fill_List
47474>>>>>>>    //DDB-ValidationCustomStart
47474>>>>>>>    //DDB-ValidationCustomEnd
47474>>>>>>>End_Object   // Baxio_Baxio_Topos_VT1
47475>>>>>>>//DDB-ValidationEnd
47475>>>>>>>//DDB-SelectionStart
47475>>>>>>>//DDB/ ExternalSelectionList SL037  SL037.SL
47475>>>>>>>//DDB/ ExternalSelectionList slNomism  slnomism.sl
47475>>>>>>>Register_Object SL037
47475>>>>>>>Register_Object slNomism
47475>>>>>>>//DDB-SelectionEnd
47475>>>>>>>
47475>>>>>>>Class Baxio_DataDictionary  is a DataDictionary_Sec
47476>>>>>>>
47476>>>>>>>      Procedure Construct_Object
47477>>>>>>>                Forward Send Construct_Object
47479>>>>>>>
47479>>>>>>>                //btypkin related properties:
47479>>>>>>>                //œ¤ž£œ¨é¤¦¤«˜  ©«ã¤: update «¦¬ bmove,
47479>>>>>>>                //£ž›œ¤å¦¤«˜   ©«ž¤: request save & delete «¦¬ bmove.
47479>>>>>>>                Property Integer piBtypkin_Flag03 0
47480>>>>>>>                Property Integer piBtypkin_Flag04 0
47481>>>>>>>                Property Integer pifromxrhsh      0
47482>>>>>>>
47482>>>>>>>                //baxio related properties:
47482>>>>>>>                //œ¤ž£œ¨é¤œ«˜     ©«ž¤: creating,
47482>>>>>>>                //®¨ž© £¦§¦ œå«˜  ©«ž¤: update «¦¬ bmove š ˜ ¤˜ œ¤œ¨š¦§¦ ã©œ  «ž¤ private.created_baxio «¦¬ bmove,
47482>>>>>>>                //£ž›œ¤åœ«˜      ©«ž¤: request save & delete «¦¬ bmove.
47482>>>>>>>                Property Integer piCreated_Baxio  0
47483>>>>>>>
47483>>>>>>>                //œ¤ž£œ¨é¤¦¤«˜     ©«ž¤: backout,
47483>>>>>>>                //®¨ž© £¦§¦ ¦ç¤«˜  ©«ž¤: validate_save š ˜ «¦¤ â¢œš®¦ editing «¦¬ baxio,
47483>>>>>>>                //£ž›œ¤å¦¤«˜      ©«ž¤: request save & delete «¦¬ bmove.
47483>>>>>>>                Property Number  pnB_Baxio_V2      0
47484>>>>>>>                Property Number  pnB_Baxio_V0      0
47485>>>>>>>                Property Number  pnB_Baxio_V00     0
47486>>>>>>>                Property Number  pnB_Baxio_Vr      0
47487>>>>>>>                Property String  psB_Baxio_C_Code2 ""
47488>>>>>>>                Property Integer piB_Baxio_Status  0
47489>>>>>>>                Property Integer piB_Baxio_Place   0
47490>>>>>>>
47490>>>>>>>                //properties š ˜ œ¢âš®¦¬ª ˜¢˜ššãª parent records:
47490>>>>>>>                //œ¤ž£œ¨é¤¦¤«˜     ©«ž¤:backout,
47490>>>>>>>                //®¨ž© £¦§¦ ¦ç¤«˜  ©«ž¤: validate_save š ˜ «¦¤ â¢œš®¦ editing «à¤ §œ›åà¤,
47490>>>>>>>                //£ž›œ¤å¦¤«˜      ©«ž¤: request save & delete «¦¬ bmove.
47490>>>>>>>                Property Integer piB_Baxiokat_Code 0
47491>>>>>>>                Property Integer piB_Year_Year     0
47492>>>>>>>                Property Integer piMustNOTConstrain Public 0
47493>>>>>>>      End_Procedure //construct_object
47494>>>>>>>
47494>>>>>>>
47494>>>>>>>
47494>>>>>>>//    Function fngConvertPoso_Baxio String asNomismaCodeApo ;
47494>>>>>>>//                            Number anPoso           ;
47494>>>>>>>//                            String asNomismaCodeSe  ;
47494>>>>>>>//                            Date   adHmnia          ;
47494>>>>>>>//                            Number nIsotimia  Returns Number
47494>>>>>>>
47494>>>>>>>//        Number rVal nApo_Euro_Isot nSe_Euro_Isot
47494>>>>>>>//        Integer iApo_Einai_Euro_Zone iApo_Einai_DRX iApo_Einai_Euro iDekadika_Apo
47494>>>>>>>//        Integer iSe_Einai_Euro_Zone  iSe_Einai_DRX  iSe_Einai_Euro  iDekadika_Se
47494>>>>>>>
47494>>>>>>>//        If (asNomismaCodeApo=asNomismaCodeSe) Function_Return anPoso
47494>>>>>>>
47494>>>>>>>//        Clear Nomisma
47494>>>>>>>//        Move (Trim(asNomismaCodeApo)) to Nomisma.Nomisma_Code
47494>>>>>>>//        Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
47494>>>>>>>//        Move Nomisma.Euro_Zone      to iApo_Einai_Euro_Zone
47494>>>>>>>//        Move Nomisma.Einai_DRX      to iApo_Einai_DRX
47494>>>>>>>//        Move Nomisma.Einai_EURO     to iApo_Einai_Euro
47494>>>>>>>//        Move Nomisma.KL_ISOT_EURO   to nApo_Euro_Isot
47494>>>>>>>//        Move Nomisma.Dekadika       to iDekadika_Apo
47494>>>>>>>
47494>>>>>>>//        Clear Nomisma
47494>>>>>>>//        Move (Trim(asNomismaCodeSe)) to Nomisma.Nomisma_Code
47494>>>>>>>//        Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
47494>>>>>>>//        Move Nomisma.Euro_Zone      to iSe_Einai_Euro_Zone
47494>>>>>>>//        Move Nomisma.Einai_DRX      to iSe_Einai_DRX
47494>>>>>>>//        Move Nomisma.Einai_EURO     to iSe_Einai_Euro
47494>>>>>>>//        Move Nomisma.KL_ISOT_EURO   to nSe_Euro_Isot
47494>>>>>>>//        Move Nomisma.Dekadika       to iDekadika_Se
47494>>>>>>>
47494>>>>>>>//        //05a. ??ÿ??? ? --> ??? 
47494>>>>>>>//        Calc (anPoso/nApo_Euro_Isot) to rVal
47494>>>>>>>//        Move (Round_Number(rVal,6)) to rVal
47494>>>>>>>//        //05b. ???         --> ??ÿ??? ?™ *
47494>>>>>>>//        Calc (rVal*nSe_Euro_Isot) to rVal
47494>>>>>>>//        Move (Round_Number(rVal,iDekadika_Se)) to rVal
47494>>>>>>>//        Function_Return rVal
47494>>>>>>>//    End_Function
47494>>>>>>>
47494>>>>>>>
47494>>>>>>>
47494>>>>>>>      //¡˜Ÿ¦¨åœ  «ž¤ default « £ã «¦¬ ¤¦£å©£˜«¦ª ˜¤á¢¦š˜ £œ «¦ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
47494>>>>>>>      Function Default_Axio_C_Code2 Returns String
47495>>>>>>>               String lsBaxio_C_Code_2
47496>>>>>>>               //Get File_Field_Current_Value File_Field SyscurXr.C_Code0 to lsBaxio_C_Code_2
47496>>>>>>>               Move SyscurXr.C_Code0 to lsBaxio_C_Code_2
47497>>>>>>>               Function_Return (Trim(lsBaxio_C_Code_2))
47498>>>>>>>      End_Function //default_axio_c_code2
47499>>>>>>>
47499>>>>>>>
47499>>>>>>>      // js 09/02/2002 den yparxei enhmerosh ton nomismatvn xrhshs
47499>>>>>>>      Procedure Convert_Axio_Values
47500>>>>>>>
47500>>>>>>>                Integer liBtypkin_Flag03 liBtypkin_Flag04
47501>>>>>>>
47501>>>>>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_Code0    ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_Rate0       to Baxio.Baxio_V0
47502>>>>>>>
47502>>>>>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_Code00   ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_Rate00      to Baxio.Baxio_V00
47503>>>>>>>
47503>>>>>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_CodeR    ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_RateR       to Baxio.Baxio_VR
47504>>>>>>>
47504>>>>>>>
47504>>>>>>>//                Move (fngConvertPoso_Baxio(Self,Baxio.Baxio_C_Code2,   ;
47504>>>>>>>//                                     Baxio.Baxio_V2,        ;
47504>>>>>>>//                                     SyscurXr.C_Code0,      ;
47504>>>>>>>//                                     Baxio.Baxio_HmniaE,    ;
47504>>>>>>>//                                     Baxio.Baxio_Rate0)     ;
47504>>>>>>>//                                    ) to Baxio.Baxio_V0
47504>>>>>>>//                If (liBtypkin_Flag03 = TRUE);
47504>>>>>>>//                     Begin
47504>>>>>>>//                      //˜¥å˜ 2-->00
47504>>>>>>>//                      Move (fngConvertPoso_Baxio(Self, Baxio.Baxio_C_Code2, ;
47504>>>>>>>//                                            Baxio.Baxio_V2,      ;
47504>>>>>>>//                                            SyscurXr.C_Code00,   ;
47504>>>>>>>//                                            Baxio.Baxio_HmniaE,  ;
47504>>>>>>>//                                            Baxio.Baxio_Rate00)  ;
47504>>>>>>>//                                          ) to Baxio.Baxio_V00
47504>>>>>>>//                     End
47504>>>>>>>//                Else Begin
47504>>>>>>>//                      Move 0            to Baxio.Baxio_V00
47504>>>>>>>//                     End
47504>>>>>>>//                If (liBtypkin_Flag04 = TRUE);
47504>>>>>>>//                     Begin
47504>>>>>>>//                      //˜¥å˜ 2-->r
47504>>>>>>>//                      Move (fngConvertPoso_Baxio(Self,Baxio.Baxio_C_Code2, ;
47504>>>>>>>//                                       Baxio.Baxio_V2,      ;
47504>>>>>>>//                                       SyscurXr.C_CodeR,    ;
47504>>>>>>>//                                       Baxio.Baxio_HmniaE,  ;
47504>>>>>>>//                                       Baxio.Baxio_RateR)   ;
47504>>>>>>>//                                      ) to Baxio.Baxio_VR
47504>>>>>>>//                     End
47504>>>>>>>//                Else Begin
47504>>>>>>>//                      Move 0            to Baxio.Baxio_VR
47504>>>>>>>//                     End
47504>>>>>>>      End_Procedure
47505>>>>>>>
47505>>>>>>>
47505>>>>>>>
47505>>>>>>>      Procedure Constrain
47506>>>>>>>                Forward Send Constrain
47508>>>>>>>                If (piMustNOTConstrain(Self)) Begin
47510>>>>>>>                End
47510>>>>>>>>
47510>>>>>>>                Else Begin
47511>>>>>>>                    Constrain Baxio.Company_Code Eq Syscurxr.Company_Code
47513>>>>>>>                    Constrain Baxio.Branch_Code  Eq Syscurxr.Branch_Code
47515>>>>>>>                    Constrain Baxio.Year_Year    Eq Syscurxr.Year_Year
47517>>>>>>>                End
47517>>>>>>>>
47517>>>>>>>      End_Procedure   //constrain
47518>>>>>>>
47518>>>>>>>
47518>>>>>>>      //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
47518>>>>>>>      //™) ˜¤áš¤à©ž properties
47518>>>>>>>      //š) › ˜®œå¨ ©ž calculated §œ›åà¤
47518>>>>>>>      //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
47518>>>>>>>      //œ) œ¤ž£â¨à©ž properties after
47518>>>>>>>      Procedure Update
47519>>>>>>>                Forward Send Update
47521>>>>>>>                
47521>>>>>>>                If (Baxio.Baxio_C_Code2='') Move SyscurXr.C_Code0 to Baxio.Baxio_C_Code2
47524>>>>>>>                
47524>>>>>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
47524>>>>>>>                Move Syscurxr.Company_Code  to Baxio.Company_Code
47525>>>>>>>                Move Syscurxr.Branch_Code   to Baxio.Branch_Code
47526>>>>>>>                Move Syscurxr.Year_Year     to Baxio.Year_Year
47527>>>>>>>                Move Syscurxr.Year_Recr     to Baxio.Year_Recr
47528>>>>>>>                Move Baxiokat.Baxiokat_Code to Baxio.Baxiokat_Code
47529>>>>>>>
47529>>>>>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
47529>>>>>>>                //š01:œ¥ ¦¨ ©£¦ç, «˜ §¢ž¨à«â˜ ›â¤ â®¦¬¤ ©«¦ ®œå˜ §˜¨˜¢¢˜™ãª
47529>>>>>>>                If (Baxiokat.Baxiokat_Type = 2);                Begin //˜¥ æš¨˜­˜ §¢ž¨à«â˜
47531>>>>>>>                     Move "" to Baxio.Baxio_Code_In
47532>>>>>>>                     Move "" to Baxio.Baxio_Epon_In
47533>>>>>>>                     Move 0  to Baxio.Baxio_Fpar_In
47534>>>>>>>                End
47534>>>>>>>>
47534>>>>>>>                //š02:yyyy + mm + dd ¢ã¥žª š ˜ «˜ reports
47534>>>>>>>                Move (TheYearSegment (Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_YYYY
47535>>>>>>>                Move (TheMonthSegment(Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_MM
47536>>>>>>>                Move (TheDaySegment  (Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_DD
47537>>>>>>>
47537>>>>>>>                //š03:§¨é«¦ª & «œ¢œ¬«˜å¦ª §˜¨˜¢ã§«žª
47537>>>>>>>                If (Baxio.Baxio_Lcode = "");                Begin
47539>>>>>>>                     Move (-1) to Baxio.Baxio_File_Out
47540>>>>>>>                     Move ""   to Baxio.Baxio_Code_Out
47541>>>>>>>                     Move ""   to Baxio.Baxio_Epon_Out
47542>>>>>>>                     Move ""   to Baxio.Baxio_Fpar_Out
47543>>>>>>>
47543>>>>>>>                     Move (-1) to Baxio.Baxio_Lfile
47544>>>>>>>                     Move ""   to Baxio.Baxio_Lepon
47545>>>>>>>                     Move ""   to Baxio.Baxio_Lpar
47546>>>>>>>                End
47546>>>>>>>>
47546>>>>>>>      End_Procedure //update
47547>>>>>>>
47547>>>>>>>
47547>>>>>>>      Procedure Backout
47548>>>>>>>                Forward Send Backout
47550>>>>>>>
47550>>>>>>>                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
47550>>>>>>>                Set pnB_Baxio_V2      to Baxio.Baxio_V2
47551>>>>>>>                Set pnB_Baxio_V0      to Baxio.Baxio_V0
47552>>>>>>>                Set pnB_Baxio_V00     to Baxio.Baxio_V00
47553>>>>>>>                Set pnB_Baxio_Vr      to Baxio.Baxio_Vr
47554>>>>>>>                Set psB_Baxio_C_Code2 to Baxio.Baxio_C_Code2
47555>>>>>>>                Set piB_Baxio_Status  to Baxio.Baxio_Status
47556>>>>>>>                Set piB_Baxio_Place   to Baxio.Baxio_Place
47557>>>>>>>                Set piB_Baxiokat_Code to Baxio.Baxiokat_Code    //š ˜ â¢œš®¦ ˜¢˜ššãª parent
47558>>>>>>>                Set piB_Year_Year     to Baxio.Year_Year        //š ˜ â¢œš®¦ ˜¢˜ššãª parent
47559>>>>>>>      End_Procedure //backout
47560>>>>>>>
47560>>>>>>>
47560>>>>>>>      Procedure New_Current_Record Integer liOld_Record Integer liNew_Record
47561>>>>>>>                Forward Send New_Current_Record liOld_Record liNew_Record
47563>>>>>>>                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
47563>>>>>>>                Set pnB_Baxio_V2      to Baxio.Baxio_V2
47564>>>>>>>                Set pnB_Baxio_V0      to Baxio.Baxio_V0
47565>>>>>>>                Set pnB_Baxio_V00     to Baxio.Baxio_V00
47566>>>>>>>                Set pnB_Baxio_Vr      to Baxio.Baxio_Vr
47567>>>>>>>                Set psB_Baxio_C_Code2 to Baxio.Baxio_C_Code2
47568>>>>>>>                Set piB_Baxio_Status  to Baxio.Baxio_Status
47569>>>>>>>                Set piB_Baxiokat_Code to Baxio.Baxiokat_Code    //š ˜ â¢œš®¦ ˜¢˜ššãª parent
47570>>>>>>>                Set piB_Year_Year     to Baxio.Year_Year        //š ˜ â¢œš®¦ ˜¢˜ššãª parent
47571>>>>>>>      End_Procedure //new_current_record
47572>>>>>>>
47572>>>>>>>
47572>>>>>>>      Procedure Creating
47573>>>>>>>                Forward Send Creating
47575>>>>>>>
47575>>>>>>>                //˜¨ Ÿ£æª ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
47575>>>>>>>                //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBaxio
47575>>>>>>>
47575>>>>>>>                //«œ¢œ¬«˜å¦ª ¡à› ¡æª ˜¨ Ÿ£æª ˜¥ ¦š¨á­¦¬
47575>>>>>>>                Add 1 to Baxiokat.Baxio_Lcode
47576>>>>>>>                Move Baxiokat.Baxio_Lcode to Baxio.Baxio_Code
47577>>>>>>>
47577>>>>>>>                //«¦ property ˜¬«æ œ¤œ¨š¦§¦ œå «ž¤ private.created_baxio
47577>>>>>>>                //£â©à «žª update ©«¦ bmove
47577>>>>>>>                Set piCreated_Baxio to TRUE
47578>>>>>>>
47578>>>>>>>//
47578>>>>>>>//                Move SysCurXr.C_Code0 to Baxio.Baxio_C_Code2
47578>>>>>>>
47578>>>>>>>                Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                 (Trim(String(Baxio.Baxio_Rec0)))))) to Baxio.Baxio_Recr
47579>>>>>>>
47579>>>>>>>      End_Procedure //creating
47580>>>>>>>
47580>>>>>>>
47580>>>>>>>      Procedure Operation_Not_Allowed Integer iError_Num
47581>>>>>>>                String lsError_Message
47582>>>>>>>                Case Begin
47582>>>>>>>                     //˜§æ validate save
47582>>>>>>>                     Case (iError_Num = 1001)
47584>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  ¦§à©›ã§¦«œ ž£œ¨¦£ž¤å˜ ¢ã¥œàª!");                          to lsError_Message
47585>>>>>>>                     Case Break
47586>>>>>>>                     Case (iError_Num = 1002)
47589>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
47590>>>>>>>                     Case Break
47591>>>>>>>                     Case (iError_Num = 1003)
47594>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  ¦§à©›ã§¦«œ ¤æ£ ©£˜!");                          to lsError_Message
47595>>>>>>>                     Case Break
47596>>>>>>>                     Case (iError_Num = 1004)
47599>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
47600>>>>>>>                     Case Break
47601>>>>>>>                     Case (iError_Num = 1005)
47604>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
47605>>>>>>>                     Case Break
47606>>>>>>>                     Case (iError_Num = 1006)
47609>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ Reporting).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
47610>>>>>>>                     Case Break
47611>>>>>>>
47611>>>>>>>                     Case (iError_Num = 1007)
47614>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\nŒâ˜ €¥ æš¨˜­˜ ›ž£ ¦¬¨š¦ç¤«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
47615>>>>>>>                     Case Break
47616>>>>>>>                     Case (iError_Num = 1008)
47619>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n’¦ ¤æ£ ©£˜ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
47620>>>>>>>                     Case Break
47621>>>>>>>                     Case (iError_Num = 1009)
47624>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
47625>>>>>>>                     Case Break
47626>>>>>>>                     Case (iError_Num = 1010)
47629>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©žª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
47630>>>>>>>                     Case Break
47631>>>>>>>                     Case (iError_Num = 1011)
47634>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜ •¨ã©žª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
47635>>>>>>>                     Case Break
47636>>>>>>>                     Case (iError_Num = 1012)
47639>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (Œæ£ ©£˜ Reporting) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
47640>>>>>>>                     Case Break
47641>>>>>>>                     Case (iError_Num = 1013)
47644>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n’¦ ˜¥ æš¨˜­¦ â®œ  œ¥¦­¢žŸœå !");                          to lsError_Message
47645>>>>>>>                     Case Break
47646>>>>>>>
47646>>>>>>>                     Case (iError_Num = 1014)
47649>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ ›â¤ œ§ «¨â§œ«˜  ¤˜ ˜¢¢á¥œ  ¡˜«žš¦¨å˜!");                          to lsError_Message
47650>>>>>>>                     Case Break
47651>>>>>>>                     Case (iError_Num = 1015)
47654>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ ›â¤ œ§ «¨â§œ«˜  ¤˜ ˜¢¢á¥œ  ®¨ã©ž!");                          to lsError_Message
47655>>>>>>>                     Case Break
47656>>>>>>>                     Case (iError_Num = 1100)
47659>>>>>>>                          Move "DDC 037:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
47660>>>>>>>                          Case Break
47661>>>>>>>
47661>>>>>>>                     //˜§æ validate delete
47661>>>>>>>                     Case (iError_Num = 2007)
47664>>>>>>>                          Move ("DDC 037:€›ç¤˜«ž ž › ˜š¨˜­ã !\n\n’¦ €¥ æš¨˜­¦ › ˜š¨á­œ«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
47665>>>>>>>                     Case Break
47666>>>>>>>                     Case (iError_Num = 2100)
47669>>>>>>>                          Move "DDC 037:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
47670>>>>>>>                          Case Break
47671>>>>>>>
47671>>>>>>>                     Case Else
47671>>>>>>>                          Forward Send Operation_Not_Allowed iError_Num
47673>>>>>>>                Case End
47673>>>>>>>
47673>>>>>>>                Error iError_Num lsError_Message
47674>>>>>>>>
47674>>>>>>>      End_Procedure // operation_not_allowed
47675>>>>>>>
47675>>>>>>>      //1001:baxio_hmnial > 0
47675>>>>>>>      //1002:baxio_v2 > 0            (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ œšš¨˜­ãª
47675>>>>>>>      //1003:baxio_c_code2 <> ""     (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ £ã¤ â®œ  ¤æ£ ©£˜)
47675>>>>>>>
47675>>>>>>>      //1004:baxio_v0 > 0            (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©žª
47675>>>>>>>      //1005:baxio_v00 > 0 if flag 3 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ›œ¬«œ¨œç¦¤ ¤æ£ ©£˜ ®¨ã©žª
47675>>>>>>>      //1006:baxio_vr > 0  of flag 4 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ reporting
47675>>>>>>>
47675>>>>>>>
47675>>>>>>>      //1007:›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬ œ§ «¨â§œ«˜  £æ¤¦¤ ˜§¦ «¦ bmove_dd, ›ž¢˜›ã §¨â§œ 
47675>>>>>>>      //       If (baxio.recnum=0) then operation_origin must be = bmove_dd
47675>>>>>>>      //1008:«¨¦§¦§¦åž©ž (edit) baxio_c_code2 £æ¤¦¤ ˜§æ bmove_dd
47675>>>>>>>      //1009:«¨¦§¦§¦åž©ž (edit) baxio_v2      £æ¤¦¤ ˜§æ bmove_dd
47675>>>>>>>      //1010:«¨¦§¦§¦åž©ž (edit) baxio_v0      £æ¤¦¤ ˜§æ bmove_dd
47675>>>>>>>      //1011:«¨¦§¦§¦åž©ž (edit) baxio_v00     £æ¤¦¤ ˜§æ bmove_dd
47675>>>>>>>      //1012:«¨¦§¦§¦åž©ž (edit) baxio_vr      £æ¤¦¤ ˜§æ bmove_dd
47675>>>>>>>
47675>>>>>>>      //1013:œá¤ «¦ status œå¤˜  œ¥¦­¢ž£â¤¦, ˜§˜š¦¨œçœ¦¤«˜  æ¢˜ «˜ §œ¨˜ «â¨à edits
47675>>>>>>>
47675>>>>>>>      //1014:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent baxiokat record
47675>>>>>>>      //1015:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent year     record
47675>>>>>>>      Function Validate_Save Returns Integer
47676>>>>>>>               Integer iReturnVal
47677>>>>>>>
47677>>>>>>>               Forward Get Validate_Save to iReturnVal
47679>>>>>>>
47679>>>>>>>               If (Not(iReturnVal));               Begin
47681>>>>>>>
47681>>>>>>>                //---------â¢œš®¦  ›ž£ ¦¬¨šå˜ª ¤â¦¬ baxio record----------------------
47681>>>>>>>                //sososo £ž§àª §¨œ§œ  ¤˜ §˜ ¥à £œ «ž¤ current record ????
47681>>>>>>>                If (Baxio.Recnum =  0);                Begin //œá¤ ›ž£ ¦¬¨šé ¤â¦ record
47683>>>>>>>                      //1007:â¢œš®¦ª ›ž£ ¦¬¨šå˜ª ¤â¦¬ ˜¥ ¦š¨á­¦¬ ˜§¦ «¦ baxio_dd
47683>>>>>>>
47683>>>>>>>                      If (pifromxrhsh(Self)=0) Begin
47685>>>>>>>                        If (Not((Main_File(OPERATION_ORIGIN)) =  Bmove.File_Number)) Send Operation_Not_Allowed 1007
47688>>>>>>>                      End
47688>>>>>>>>
47688>>>>>>>                End   //«â¢¦ª œ¢âš®à¤ ›ž£ ¦¬¨šå˜ª ¤â¦¬ baxio record
47688>>>>>>>>
47688>>>>>>>
47688>>>>>>>
47688>>>>>>>                //---------â¢œš®¦  editing existing baxio records---------------------
47688>>>>>>>                Else;                Begin //edit an existing record
47689>>>>>>>                      //1008:«¨¦§¦§¦åž©ž (edit) baxio_c_code2 £æ¤¦¤ ˜§æ bmove_dd
47689>>>>>>>
47689>>>>>>>                      If (pifromxrhsh(Self)=0) Begin
47691>>>>>>>
47691>>>>>>>                        If (;                            ((psB_Baxio_C_Code2(Self))     <> Baxio.Baxio_C_Code2) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1008
47694>>>>>>>                        //1009:«¨¦§¦§¦åž©ž (edit) baxio_v2 £æ¤¦¤ ˜§æ bmove_dd
47694>>>>>>>                        If (;                            ((pnB_Baxio_V2(Self))          <> Baxio.Baxio_V2      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1009
47697>>>>>>>                        //1010:«¨¦§¦§¦åž©ž (edit) baxio_v0 £æ¤¦¤ ˜§æ bmove_dd
47697>>>>>>>                        If (;                            ((pnB_Baxio_V0(Self))          <> Baxio.Baxio_V0      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1010
47700>>>>>>>                        //1011:«¨¦§¦§¦åž©ž (edit) baxio_v00 £æ¤¦¤ ˜§æ bmove_dd
47700>>>>>>>                        If (;                            ((pnB_Baxio_V00(Self))         <> Baxio.Baxio_V00     ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1011
47703>>>>>>>                        //1012:«¨¦§¦§¦åž©ž (edit) baxio_vr £æ¤¦¤ ˜§æ bmove_dd
47703>>>>>>>                        If (;                            ((pnB_Baxio_Vr(Self))          <> Baxio.Baxio_Vr      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1012
47706>>>>>>>
47706>>>>>>>                      End
47706>>>>>>>>
47706>>>>>>>                        // Egine rem 20/12/2001 giati an orisoume sta metrhta gia paradeigma
47706>>>>>>>                        // oti to status SE einai exoflhmeno, tote xtypaei to validation sto
47706>>>>>>>                        // kleisimo toy barticle. Alloste den vlepoume giati den mporei na
47706>>>>>>>                        // anoigokleisei
47706>>>>>>>//                      //1013:œá¤ «¦ status œå¤˜  œ¥¦­¢ž£â¤¦, ˜§˜š¦¨œç¦¤«˜  æ¢˜ «˜ §œ¨˜ «â¨à edits ˜§¦ «¦ bmove
47706>>>>>>>//                      If (;
47706>>>>>>>//                           ((piB_Baxio_Status(Self))      = 2                    ) and;
47706>>>>>>>//                           ((Main_File(OPERATION_ORIGIN)) =  Bmove.File_Number);
47706>>>>>>>//                         )                                                       Send Operation_Not_Allowed 1013
47706>>>>>>>
47706>>>>>>>                      If (pifromxrhsh(Self)=0) Begin
47708>>>>>>>                        //1014:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent baxiokat record
47708>>>>>>>                        If (Not;                            ((piB_Baxiokat_Code(Self)) =  Baxiokat.Baxiokat_Code);                            )                                                       Send Operation_Not_Allowed 1014
47711>>>>>>>
47711>>>>>>>                        //1015:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent year record
47711>>>>>>>                        If (Not;                            ((piB_Year_Year    (Self)) =  SysCurXr.Year_Year        );                            )                                                       Send Operation_Not_Allowed 1015
47714>>>>>>>                      End
47714>>>>>>>>
47714>>>>>>>                End   //«â¢¦ª œ¢âš®à¤ editing existing baxio records
47714>>>>>>>>
47714>>>>>>>
47714>>>>>>>                //¢¦§¦å â¢œš®¦ 
47714>>>>>>>                //1001:baxio_hmnial > 0
47714>>>>>>>                If (Not(Baxio.Baxio_Hmnial > 0 ))   Send Operation_Not_Allowed 1001
47717>>>>>>>                //1002:baxio_v2 > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ œšš¨˜­ãª
47717>>>>>>>                If (Not(Baxio.Baxio_V2 > 0))         Send Operation_Not_Allowed 1002
47720>>>>>>>                //1003:baxio_c_code2 <> ""
47720>>>>>>>                If (Not(Baxio.Baxio_C_Code2 <>""))    Send Operation_Not_Allowed 1003
47723>>>>>>>                //1004:baxio_v0 > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
47723>>>>>>>//--------------If (Not(Baxio.Baxio_V0 > 0))         Send Operation_Not_Allowed 1004
47723>>>>>>>                //1005:baxio_v00> 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ›œ¬«œ¨œç¦¤ ¤æ£ ©£˜ ®¨ã©œàª
47723>>>>>>>//--------------If (Not(Baxio.Baxio_V00> 0))         Send Operation_Not_Allowed 1005
47723>>>>>>>                //1006:baxio_vr > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ reporting
47723>>>>>>>//--------------If (Not(Baxio.Baxio_VR > 0))         Send Operation_Not_Allowed 1006
47723>>>>>>>                //1100:cby = globals
47723>>>>>>>
47723>>>>>>>                If (pifromxrhsh(Self)=0) Begin
47725>>>>>>>
47725>>>>>>>                    If ( ;                        (Not(Baxio.Company_Code = SyscurXr.Company_Code)) or;                        (Not(Baxio.Branch_Code  = SyscurXr.Branch_Code )) or;                        (Not(Baxio.Year_Year    = SyscurXr.Year_Year   ));                        )                                                   Send Operation_Not_Allowed 1100
47728>>>>>>>
47728>>>>>>>               End
47728>>>>>>>>
47728>>>>>>>
47728>>>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
47728>>>>>>>>
47728>>>>>>>               Function_Return iReturnVal
47729>>>>>>>      End_Function //validate_save
47730>>>>>>>
47730>>>>>>>
47730>>>>>>>      //2007:ž › ˜š¨˜­ã ˜¥ ¦š¨á­¦¬ œ§ «¨â§œ«˜  £æ¤¦¤ ˜§¦ «¦ bmove_dd
47730>>>>>>>      Function Validate_Delete  Returns Integer
47731>>>>>>>               Integer iReturnVal
47732>>>>>>>               Forward Get Validate_Delete  To iReturnVal
47734>>>>>>>               If (Not(iReturnVal));               Begin
47736>>>>>>>
47736>>>>>>>                  //2007:â¢œš®¦ª › ˜š¨˜­ãª ˜¥ ¦š¨á­¦¬ (£æ¤¦¤ ˜§¦ bmove_dd)
47736>>>>>>>                  If ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number)          Send Operation_Not_Allowed 2007
47739>>>>>>>
47739>>>>>>>                  //2100:cby = globals
47739>>>>>>>                  If ( ;                      (Not(Baxio.Company_Code = Syscurxr.Company_Code)) or;                      (Not(Baxio.Branch_Code  = Syscurxr.Branch_Code )) or;                      (Not(Baxio.Year_Year    = Syscurxr.Year_Year        ));                      )                                                   Send Operation_Not_Allowed 2100
47742>>>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
47742>>>>>>>>
47742>>>>>>>               Function_Return iReturnVal
47743>>>>>>>      End_Function //validate_delete
47744>>>>>>>
47744>>>>>>>
47744>>>>>>>//------------------------------------------------------------------
47744>>>>>>>    Procedure Define_Fields
47745>>>>>>>        Forward Send Define_Fields
47747>>>>>>>        //DDB-Generated-Code-Location
47747>>>>>>>        //DDB-DefineFieldStart
47747>>>>>>>
47747>>>>>>>        Set Main_File            To Baxio.File_Number
47748>>>>>>>        Set Cascade_Delete_State To FALSE
47749>>>>>>>
47749>>>>>>>
47749>>>>>>>        // Child (Client) file structure................
47749>>>>>>>        Send Add_Client_File  Bmove.File_Number
47750>>>>>>>
47750>>>>>>>        // Parent (Server) file structure...............
47750>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
47751>>>>>>>
47751>>>>>>>        // External (System) file structure.............
47751>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
47752>>>>>>>
47752>>>>>>>        Define_Auto_Increment  Sysrecb.Baxio_Rec0  To Baxio.Baxio_Rec0
47755>>>>>>>
47755>>>>>>>        // Field-based properties.......................
47755>>>>>>>
47755>>>>>>>        // Baxio.Company_Code
47755>>>>>>>
47755>>>>>>>        // Baxio.Branch_Code
47755>>>>>>>
47755>>>>>>>        // Baxio.Year_Year
47755>>>>>>>
47755>>>>>>>        // Baxio.Baxiokat_Code
47755>>>>>>>
47755>>>>>>>        // Baxio.Baxio_Code
47755>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Code To (SL037(Self))
47756>>>>>>>
47756>>>>>>>        // Baxio.Baxio_Rec0
47756>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Rec0 To (SL037(Self))
47757>>>>>>>
47757>>>>>>>        // Baxio.Year_Recr
47757>>>>>>>
47757>>>>>>>        // Baxio.Baxiokat_Recr
47757>>>>>>>
47757>>>>>>>        // Baxio.Baxio_Recr
47757>>>>>>>
47757>>>>>>>        // Baxio.Baxio_Status
47757>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Status To (Baxio_Status_VT(Self))
47758>>>>>>>
47758>>>>>>>        // Baxio.Baxio_Place
47758>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Place To (Baxio_Baxio_Place_VT(Self))
47759>>>>>>>
47759>>>>>>>        // Baxio.Baxio_File_In
47759>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_In To (Bfile_VT(Self))
47760>>>>>>>
47760>>>>>>>        // Baxio.Baxio_Code_In
47760>>>>>>>        //DDB/ Comment_Short       Field Baxio.Baxio_Code_In To "To BIAXIOKAT_FILE ¡˜Ÿ¦¨åœ  «ž¤ ©®œ« ¡ã ¢å©«˜"
47760>>>>>>>
47760>>>>>>>        // Baxio.Baxio_Epon_In
47760>>>>>>>
47760>>>>>>>        // Baxio.Baxio_Fpar_In
47760>>>>>>>
47760>>>>>>>        // Baxio.Baxio_File_Out
47760>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_Out To (Bfile_VT(Self))
47761>>>>>>>
47761>>>>>>>        // Baxio.Baxio_Code_Out
47761>>>>>>>
47761>>>>>>>        // Baxio.Baxio_Epon_Out
47761>>>>>>>
47761>>>>>>>        // Baxio.Baxio_Fpar_Out
47761>>>>>>>
47761>>>>>>>        // Baxio.Baxio_Lfile
47761>>>>>>>
47761>>>>>>>        // Baxio.Baxio_Lcode
47761>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Lcode To (Bfile_VT(Self))
47762>>>>>>>
47762>>>>>>>        // Baxio.Baxio_Lepon
47762>>>>>>>
47762>>>>>>>        // Baxio.Baxio_Lpar
47762>>>>>>>
47762>>>>>>>        // Baxio.Baxio_Bank00000
47762>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Bank00000 To (Baxio_Baxio_Bank_VT(Self))
47763>>>>>>>
47763>>>>>>>        // Baxio.Baxio_Hmniae
47763>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniae To (SL037(Self))
47764>>>>>>>
47764>>>>>>>        // Baxio.Baxio_Hmniap000
47764>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniap000 To (SL037(Self))
47765>>>>>>>
47765>>>>>>>        // Baxio.Baxio_Hmnial
47765>>>>>>>        //DDB/ Comment_Short       Field Baxio.Baxio_Hmnial To "†£/¤å˜ Šã¥žª:"
47765>>>>>>>
47765>>>>>>>        // Baxio.Baxio_Ekdoths
47765>>>>>>>
47765>>>>>>>        // Baxio.Baxio_Ekdothse
47765>>>>>>>
47765>>>>>>>        // Baxio.Baxio_Sediatagh
47765>>>>>>>
47765>>>>>>>        // Baxio.Baxio_Sdiataghe
47765>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Sdiataghe To (SL037(Self))
47766>>>>>>>
47766>>>>>>>        // Baxio.Baxio_Banka
47766>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Banka To (Baxio_Baxio_Banka_VT(Self))
47767>>>>>>>
47767>>>>>>>        // Baxio.Baxio_Opistho
47767>>>>>>>
47767>>>>>>>        // Baxio.Baxio_No
47767>>>>>>>
47767>>>>>>>        // Baxio.Baxio_V2
47767>>>>>>>
47767>>>>>>>        // Baxio.Baxio_V0
47767>>>>>>>
47767>>>>>>>        // Baxio.Baxio_V00
47767>>>>>>>
47767>>>>>>>        // Baxio.Baxio_Vr
47767>>>>>>>
47767>>>>>>>        // Baxio.Baxio_Rate0
47767>>>>>>>
47767>>>>>>>        // Baxio.Baxio_Rate00
47767>>>>>>>
47767>>>>>>>        // Baxio.Baxio_Rater
47767>>>>>>>
47767>>>>>>>        // Baxio.Baxio_C_Code2
47767>>>>>>>        Set Field_Entry_msg        Field Baxio.Baxio_C_Code2 To get_Default_Axio_C_Code2
47768>>>>>>>        Set Field_Options          Field Baxio.Baxio_C_Code2 To DD_CAPSLOCK   
47769>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_C_Code2 To (slNomism(Self))
47770>>>>>>>
47770>>>>>>>        // Baxio.Baxio_Lixi_Yyyy
47770>>>>>>>
47770>>>>>>>        // Baxio.Baxio_Lixi_Mm
47770>>>>>>>
47770>>>>>>>        // Baxio.Baxio_Lixi_Dd
47770>>>>>>>
47770>>>>>>>        // Baxio.Baxio_Bmove_Laa
47770>>>>>>>
47770>>>>>>>        // Baxio.Baxio_Desm
47770>>>>>>>
47770>>>>>>>        // Baxio.Baxio_From
47770>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_From To (Baxio_Baxio_From_VT(Self))
47771>>>>>>>
47771>>>>>>>        // Baxio.Baxio_Topos
47771>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Topos To (Baxio_Baxio_Topos_VT1(Self))
47772>>>>>>>
47772>>>>>>>        //DDB-DefineFieldEnd
47772>>>>>>>
47772>>>>>>>        Set Main_File            To Baxio.File_Number
47773>>>>>>>        Set Cascade_Delete_State To FALSE
47774>>>>>>>
47774>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
47775>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
47776>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
47777>>>>>>>
47777>>>>>>>        // Child (Client) file structure................
47777>>>>>>>        Send Add_Client_File  Bmove.File_Number
47778>>>>>>>
47778>>>>>>>        // Parent (Server) file structure...............
47778>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
47779>>>>>>>
47779>>>>>>>        // External (System) file structure.............
47779>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
47780>>>>>>>
47780>>>>>>>        Define_Auto_Increment  Sysrecb.Baxio_Rec0  To Baxio.Baxio_Rec0
47783>>>>>>>
47783>>>>>>>        // Field-based properties.......................
47783>>>>>>>
47783>>>>>>>        // Baxio.Company_Code
47783>>>>>>>
47783>>>>>>>        // Baxio.Branch_Code
47783>>>>>>>
47783>>>>>>>        // Baxio.Year_Year
47783>>>>>>>
47783>>>>>>>        // Baxio.Baxiokat_Code
47783>>>>>>>
47783>>>>>>>        // Baxio.Baxio_Code
47783>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Code         To "‰à› ¡æª €¥ ¦š¨á­¦¬"
47784>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Code         To "‰à› ¡æª"
47785>>>>>>>        Set Field_Options          Field Baxio.Baxio_Code         To DD_AUTOFIND    DD_NOPUT
47786>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Code         To (sl037(Self))
47787>>>>>>>        Set Key_Field_State        Field Baxio.Baxio_Code         To TRUE
47788>>>>>>>
47788>>>>>>>        // Baxio.Baxio_Rec0
47788>>>>>>>        Set Field_Options          Field Baxio.Baxio_Rec0         To DD_AUTOFIND    DD_REQUIRED
47789>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Rec0         To (sl037(Self))
47790>>>>>>>        Set Key_Field_State        Field Baxio.Baxio_Rec0         To TRUE
47791>>>>>>>
47791>>>>>>>        // Baxio.Year_Rec0
47791>>>>>>>
47791>>>>>>>        // Baxio.Baxiokat_Rec0
47791>>>>>>>
47791>>>>>>>        // Baxio.Baxio_Status
47791>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Status       To "dbComboForm_EZ"
47792>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Status       To "‰˜«á©«˜©ž"
47793>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Status       To "‰˜«á©«˜©ž"
47794>>>>>>>        Set Field_Options  Field Baxio.Baxio_Status  To DD_DISPLAYONLY
47795>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Status       To (Baxio_Status_VT(Self))
47796>>>>>>>
47796>>>>>>>        // Baxio.Baxio_Place
47796>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Place        To "dbComboForm_EZ"
47797>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Place        To "„¬¨å©¡œ«˜ "
47798>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Place        To "„¬¨å©¡œ«˜ "
47799>>>>>>>        Set Field_Options          Field Baxio.Baxio_Place        To DD_DISPLAYONLY
47800>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Place        To (Baxio_Baxio_Place_VT(Self))
47801>>>>>>>
47801>>>>>>>        // Baxio.Baxio_File_In
47801>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_In      To (Bfile_VT(Self))
47802>>>>>>>
47802>>>>>>>        // Baxio.Baxio_Code_In
47802>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Code_In      To "˜¨œ¢ã­Ÿž €§æ"
47803>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Code_In      To "˜¨œ¢ã­Ÿž €§æ"
47804>>>>>>>        Set Field_Options          Field Baxio.Baxio_Code_In      To DD_DISPLAYONLY
47805>>>>>>>
47805>>>>>>>        // Baxio.Baxio_Epon_In
47805>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Epon_In      To "„§à¤¬£å˜"
47806>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Epon_In      To "„§à¤¬£å˜"
47807>>>>>>>        Set Field_Options          Field Baxio.Baxio_Epon_In      To DD_DISPLAYONLY
47808>>>>>>>
47808>>>>>>>        // Baxio.Baxio_Fpar_In
47808>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Fpar_In      To "˜¨/¡æ ˜¨˜¢˜™ãª"
47809>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Fpar_In      To "˜¨/¡æ ˜¨˜¢."
47810>>>>>>>        Set Field_Options          Field Baxio.Baxio_Fpar_In      To DD_DISPLAYONLY
47811>>>>>>>
47811>>>>>>>        // Baxio.Baxio_File_Out
47811>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_Out     To (Bfile_VT(Self))
47812>>>>>>>
47812>>>>>>>        // Baxio.Baxio_Code_Out
47812>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Code_Out     To "¨é«¦ª ˜¨˜¢ã§«žª"
47813>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Code_Out     To "¨é«¦ª ˜¨˜¢ã§«žª"
47814>>>>>>>        Set Field_Options          Field Baxio.Baxio_Code_Out     To DD_DISPLAYONLY
47815>>>>>>>
47815>>>>>>>        // Baxio.Baxio_Epon_Out
47815>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Epon_Out     To "„§à¤¬£å˜"
47816>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Epon_Out     To "„§à¤¬£å˜"
47817>>>>>>>        Set Field_Options          Field Baxio.Baxio_Epon_Out     To DD_DISPLAYONLY
47818>>>>>>>
47818>>>>>>>        // Baxio.Baxio_Fpar_Out
47818>>>>>>>        Set Field_Options          Field Baxio.Baxio_Fpar_Out     To DD_DISPLAYONLY
47819>>>>>>>
47819>>>>>>>        // Baxio.Baxio_Lfile
47819>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Lfile        To (Bfile_VT(Self))
47820>>>>>>>
47820>>>>>>>        // Baxio.Baxio_Lcode
47820>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Lcode        To "’œ¢œ¬«˜å¦ª ˜¨˜¢ã§«žª"
47821>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Lcode        To "’œ¢.˜¨˜¢ã§«žª"
47822>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lcode        To DD_DISPLAYONLY
47823>>>>>>>
47823>>>>>>>        // Baxio.Baxio_Lepon
47823>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lepon        To DD_DISPLAYONLY
47824>>>>>>>
47824>>>>>>>        // Baxio.Baxio_Lpar
47824>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Lpar         To "˜¨/¡æ ˜¨á›¦©žª"
47825>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Lpar         To "˜¨/¡æ ˜¨á›¦©žª"
47826>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lpar         To DD_DISPLAYONLY
47827>>>>>>>
47827>>>>>>>        // Baxio.Baxio_Bank00000
47827>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Bank00000    To "dbComboForm_EZ"
47828>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Bank00000    To (Baxio_Baxio_Bank_VT(Self))
47829>>>>>>>
47829>>>>>>>        // Baxio.Baxio_Hmniae
47829>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmniae       To "dbSpinForm_EZ"
47830>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmniae       To "†£/¤å˜ „¡›¦©žª"
47831>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmniae       To "†£/¤å˜ „¡›¦©žª"
47832>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniae       To (sl037(Self))
47833>>>>>>>
47833>>>>>>>        // Baxio.Baxio_Hmniap000
47833>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmniap000    To "dbSpinForm_EZ"
47834>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmniap000    To "†£/¤å˜ ˜¨˜¢˜™ãª"
47835>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmniap000    To "†£/¤å˜ ˜¨˜¢˜™ãª"
47836>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniap000    To (sl037(Self))
47837>>>>>>>
47837>>>>>>>        // Baxio.Baxio_Hmnial
47837>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmnial       To "dbSpinForm_EZ"
47838>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmnial       To "†£/¤å˜ Šã¥žª"
47839>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmnial       To "†£/¤å˜ Šã¥žª"
47840>>>>>>>        Set Field_Options          Field Baxio.Baxio_Hmnial       To DD_REQUIRED
47841>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmnial       To (sl037(Self))
47842>>>>>>>
47842>>>>>>>        // Baxio.Baxio_Ekdoths
47842>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Ekdoths      To "€¨® ¡æª „¡›æ«žª"
47843>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Ekdoths      To "€¨®.„¡›æ«žª"
47844>>>>>>>
47844>>>>>>>        // Baxio.Baxio_Ekdothse
47844>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Ekdothse     To "„§à¤¬£å˜ €¨® ¡¦ç „¡›æ«ž"
47845>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Ekdothse     To "„§à¤¬£å˜"
47846>>>>>>>
47846>>>>>>>        // Baxio.Baxio_Sediatagh
47846>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Sediatagh    To "‘œ ƒ ˜«˜šã"
47847>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Sediatagh    To "‘œ ƒ ˜«˜šã"
47848>>>>>>>
47848>>>>>>>        // Baxio.Baxio_Sdiataghe
47848>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Sdiataghe    To "„§à¤¬£å˜ €¨® ¡¦ç ƒ ¡˜ ¦ç®¦¬"
47849>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Sdiataghe    To "„§à¤¬£å˜"
47850>>>>>>>
47850>>>>>>>        // Baxio.Baxio_Banka
47850>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Banka        To "dbComboForm_EZ"
47851>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Banka        To "’¨á§œ˜"
47852>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Banka        To "’¨á§œ˜"
47853>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Banka        To (Baxio_Baxio_Banka_VT(Self))
47854>>>>>>>
47854>>>>>>>        // Baxio.Baxio_Opistho
47854>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Opistho      To "Š¦ §¦å Ž§ ©Ÿ¦š¨á­¦ "
47855>>>>>>>
47855>>>>>>>        // Baxio.Baxio_No
47855>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_No           To "€¨ Ÿ£æª"
47856>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_No           To "€¨ Ÿ£æª"
47857>>>>>>>
47857>>>>>>>        // Baxio.Baxio_V2
47857>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_V2           To "¦©æ"
47858>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_V2           To "¦©æ"
47859>>>>>>>        Set Field_Options          Field Baxio.Baxio_V2           To DD_REQUIRED
47860>>>>>>>
47860>>>>>>>        // Baxio.Baxio_V0
47860>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_V0           To "¦©æ ‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª"
47861>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_V0           To "¦©æ(‰¬¨. Œæ£.•¨.)"
47862>>>>>>>
47862>>>>>>>        // Baxio.Baxio_V00
47862>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_V00          To "¦©æ ƒœ¬«œ¨œç¦¤  Œæ£ ©£˜ •¨ã©œàª"
47863>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_V00          To "¦©æ(ƒœ¬«. Œæ£.•¨.)"
47864>>>>>>>
47864>>>>>>>        // Baxio.Baxio_Vr
47864>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Vr           To "¦©æ Œæ£ ©£˜ Reporting"
47865>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Vr           To "¦©æ( Œæ£.Rep.)"
47866>>>>>>>
47866>>>>>>>        // Baxio.Baxio_Rate0
47866>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Rate0        To "Rate 1"
47867>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Rate0        To "Rate 1"
47868>>>>>>>
47868>>>>>>>        // Baxio.Baxio_Rate00
47868>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Rate00       To "Rate 2"
47869>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Rate00       To "Rate 2"
47870>>>>>>>
47870>>>>>>>        // Baxio.Baxio_Rater
47870>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Rater        To "Rate 3"
47871>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Rater        To "Rate 3"
47872>>>>>>>
47872>>>>>>>        // Baxio.Baxio_C_Code2
47872>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_C_Code2      To "dbComboForm_EZ"
47873>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_C_Code2      To "Œæ£ ©£˜"
47874>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_C_Code2      To "Œæ£ ©£˜"
47875>>>>>>>        Set Field_Options          Field Baxio.Baxio_C_Code2      To DD_REQUIRED
47876>>>>>>>
47876>>>>>>>        // Baxio.Baxio_Lixi_Yyyy
47876>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Yyyy    To DD_DISPLAYONLY
47877>>>>>>>
47877>>>>>>>        // Baxio.Baxio_Lixi_Mm
47877>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Mm      To DD_DISPLAYONLY
47878>>>>>>>
47878>>>>>>>        // Baxio.Baxio_Lixi_Dd
47878>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Dd      To DD_DISPLAYONLY
47879>>>>>>>
47879>>>>>>>        // Baxio.Baxio_Bmove_Laa
47879>>>>>>>        Set Field_Options          Field Baxio.Baxio_Bmove_Laa    To DD_DISPLAYONLY
47880>>>>>>>
47880>>>>>>>    End_Procedure    // Define_Fields
47881>>>>>>>
47881>>>>>>>
47881>>>>>>>    Procedure Field_Defaults
47882>>>>>>>        Forward Send Field_Defaults
47884>>>>>>>        //DDB-Generated-Code-Location
47884>>>>>>>        //DDB-FieldDefaultStart
47884>>>>>>>        Set Field_Changed_Value   Field Baxio.Baxio_Status To 1
47885>>>>>>>        Set Field_Changed_Value   Field Baxio.Baxio_Place To 1
47886>>>>>>>        //DDB-FieldDefaultEnd
47886>>>>>>>    End_Procedure    // Field_Defaults
47887>>>>>>>
47887>>>>>>>End_Class    // Baxio_DataDictionary
47888>>>>>>>//DDB-Selection-pkg-Start
47888>>>>>>>
47888>>>>>>>Use SL037.SL         // SL037
47888>>>>>>>Use slnomism.sl      // slNomism
47888>>>>>>>
47888>>>>>>>//DDB-Selection-pkg-End
47888>>>>>>>//DDB-FileEnd
47888>>>>>
47888>>>>>//AB-IgnoreEnd
47888>>>>>
47888>>>>>Object SL037 is a dbModalPanelSub
47890>>>>>
47890>>>>>    //AB-StoreTopStart
47890>>>>>        
47890>>>>>    Property Integer piFragmaBaxiokatRec0 Public  0
47892>>>>>    Property Integer piFragmaBaxiokatCode Public  0
47894>>>>>    Property Integer piFragmaBaxioStatus  Public  0
47896>>>>>    Property Integer piFragmaBaxioPlace   Public  0
47898>>>>>    Property string  psfragmaclient       Public ''
47900>>>>>    Property String  psFragmaBaxioStatus  Public ''
47902>>>>>    Property String  psEkdoths            Public ''
47904>>>>>    Property String  psApodekths          Public ''
47906>>>>>    Property Date pdApo                   Public ''
47908>>>>>    Property Date pdEos                   Public ''
47910>>>>>    
47910>>>>>    //AB-StoreTopEnd
47910>>>>>
47910>>>>>    Set Label to "‰˜«á¢¦š¦ª €¥ ¦š¨á­à¤"
47911>>>>>    Set Size to 287 527
47912>>>>>    Set Location to 2 3
47913>>>>>    Set Exit_Application_Local_State to FALSE
47914>>>>>    Set Modal_State to FALSE
47915>>>>>
47915>>>>>    //AB-DDOStart
47915>>>>>
47915>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
47917>>>>>    End_Object    // Baxiokat_DD
47918>>>>>
47918>>>>>    Object Baxio_DD is a Baxio_DataDictionary
47920>>>>>        Set DDO_Server to (Baxiokat_DD(self))
47921>>>>>
47921>>>>>        //AB-StoreStart
47921>>>>>                        
47921>>>>>        Function fiIsOK Returns Integer
47923>>>>>            String lsBaxioStatus sclient
47924>>>>>            Get psFragmaBaxioStatus  to lsBaxioStatus
47925>>>>>            Get psfragmaclient       to sclient
47926>>>>>            If (Trim(sClient)='') Begin
47928>>>>>                If (lsBaxioStatus Contains Baxio.Baxio_Status) Function_Return 1
47931>>>>>            End
47931>>>>>>
47931>>>>>            Else Begin
47932>>>>>                If (baxio.baxio_desm Eq sClient And lsBaxioStatus Contains Baxio.Baxio_Status) Function_Return 1
47935>>>>>            End
47935>>>>>>
47935>>>>>            Function_Return 0
47936>>>>>        End_Function
47937>>>>>        
47937>>>>>        Procedure OnConstrain
47939>>>>>        
47939>>>>>            Integer liBaxiokatCode liBaxioStatus liBaxioPlace
47940>>>>>            string  sclient lsBaxioStatus sApodekths sEkdoths
47940>>>>>            Date    dApo dEos
47940>>>>>        
47940>>>>>            Forward Send OnConstrain
47942>>>>>        
47942>>>>>            Get piFragmaBaxiokatCode    to liBaxiokatCode
47943>>>>>            Get psFragmaBaxioStatus     to lsBaxioStatus
47944>>>>>            Get piFragmaBaxioPlace      to liBaxioPlace
47945>>>>>        
47945>>>>>            Get psApodekths             to sApodekths
47946>>>>>            Get psEkdoths               to sEkdoths
47947>>>>>            Get pdApo                   to dApo
47948>>>>>            Get pdEos                   to dEos
47949>>>>>        
47949>>>>>            If (liBaxioKatCode <> 0) Begin
47951>>>>>                Constrain Baxio.Baxiokat_Code eq liBaxiokatCode
47953>>>>>                If (liBaxioPlace  <> 0)  Constrain Baxio.Baxio_Place eq liBaxioPlace
47957>>>>>                If (lsBaxioStatus <> '') Constrain Baxio as (fiIsOK(Self)=1)
47960>>>>>            End
47960>>>>>>
47960>>>>>        
47960>>>>>            If (sApodekths  <>'') Constrain Baxio.Baxio_Code_Out    Eq sApodekths
47964>>>>>            If (sEkdoths    <>'') Constrain Baxio.Baxio_Code_In     Eq sEkdoths
47968>>>>>            If (dApo        <>'') Constrain Baxio.Baxio_HmniaL      Ge dApo
47972>>>>>            If (dEos        <>'') Constrain Baxio.Baxio_HmniaL      Le dEos
47976>>>>>        
47976>>>>>        End_Procedure // OnConstrain
47977>>>>>        
47977>>>>>        
47977>>>>>        
47977>>>>>        
47977>>>>>        
47977>>>>>        
47977>>>>>        
47977>>>>>        
47977>>>>>        
47977>>>>>        
47977>>>>>        
47977>>>>>        
47977>>>>>        
47977>>>>>        //AB-StoreEnd
47977>>>>>
47977>>>>>    End_Object    // Baxio_DD
47978>>>>>
47978>>>>>    Set Main_DD to (Baxio_DD(self))
47979>>>>>    Set Server to (Baxio_DD(self))
47980>>>>>
47980>>>>>    //AB-DDOEnd
47980>>>>>
47980>>>>>    Object oSelList is a dbListSub
47982>>>>>        Set Main_File to Baxio.File_Number
47983>>>>>        Set Size to 228 514
47984>>>>>        Set Location to 4 6
47985>>>>>        Set Auto_Index_State to FALSE
47986>>>>>
47986>>>>>        Begin_Row
47989>>>>>            Entry_Item Baxio.Baxio_code
47990>>>>>            Entry_Item Baxio.Baxio_epon_in
47991>>>>>            Entry_Item Baxio.Baxio_epon_out
47992>>>>>            Entry_Item Baxiokat.Baxiokat_descr
47993>>>>>            Entry_Item Baxio.Baxio_hmnial
47994>>>>>            Entry_Item Baxio.Baxio_v2
47995>>>>>            Entry_Item Baxio.Baxio_banka
47996>>>>>            Entry_Item (Export_Code_Description(Self,6,Baxio.Baxio_banka))
47997>>>>>            Entry_Item Baxio.Baxio_no
47998>>>>>        End_Row
48003>>>>>
48003>>>>>        Set Form_Width    item 0 to 41
48004>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
48005>>>>>        
48005>>>>>        Set Form_Width    item 1 to 98
48006>>>>>        Set Header_Label  item 1 to "„¡›æ«žª"
48007>>>>>        
48007>>>>>        Set Form_Width    item 2 to 94
48008>>>>>        Set Header_Label  item 2 to "€§¦›â¡«žª"
48009>>>>>        
48009>>>>>        Set Form_Width    item 3 to 75
48010>>>>>        Set Header_Label  item 3 to "œ¨ š¨˜­ã"
48011>>>>>        
48011>>>>>        Set Form_Width    item 4 to 47
48012>>>>>        Set Header_Label  item 4 to "Šã¥ž"
48013>>>>>        
48013>>>>>        Set Form_Width    item 5 to 48
48014>>>>>        Set Header_Label  item 5 to "¦©æ"
48015>>>>>        
48015>>>>>        Set Form_Width    item 6 to 12
48016>>>>>        Set Header_Label  item 6 to "‰à› ¡æª ’¨á§œ˜"
48017>>>>>        
48017>>>>>        Set Form_Width    item 7 to 42
48018>>>>>        Set Header_Label  item 7 to "’¨á§œ˜"
48019>>>>>        
48019>>>>>        Set Form_Width    item 8 to 53
48020>>>>>        Set Header_Label  item 8 to "€¨ Ÿ£æª"
48021>>>>>        
48021>>>>>
48021>>>>>        //AB-StoreStart
48021>>>>>        
48021>>>>>        Property Integer piStoreFragmaBaxiokatRec0 Public 0
48023>>>>>        Property Integer piStoreFragmaBaxiokatCode Public 0
48025>>>>>        Property Integer piStoreFragmaBaxioStatus  Public 0
48027>>>>>        Property Integer piStoreFragmaBaxioPlace   Public 0
48029>>>>>        Property String  psStoreFragmaBaxioStatus  Public ''
48031>>>>>        
48031>>>>>        Procedure Store_Defaults
48033>>>>>            Forward Send Store_Defaults
48035>>>>>            Set piStoreFragmaBaxiokatRec0 to (piFragmaBaxiokatRec0(Self))
48036>>>>>            Set piStoreFragmaBaxiokatCode to (piFragmaBaxiokatCode(Self))
48037>>>>>            Set piStoreFragmaBaxioStatus  to (piFragmaBaxioStatus(Self))
48038>>>>>            Set piStoreFragmaBaxioPlace   to (piFragmaBaxioPlace(Self))
48039>>>>>            Set psStoreFragmaBaxioStatus  to (psFragmaBaxioStatus(Self))
48040>>>>>        End_Procedure // Store_Defaults
48041>>>>>        
48041>>>>>        Procedure Restore_Defaults
48043>>>>>            Forward Send Restore_Defaults
48045>>>>>            Set piFragmaBaxiokatRec0 to (piStoreFragmaBaxiokatRec0(Self))
48046>>>>>            Set piFragmaBaxiokatCode to (piStoreFragmaBaxiokatCode(Self))
48047>>>>>            Set piFragmaBaxioStatus  to (piStoreFragmaBaxioStatus(Self))
48048>>>>>            Set piFragmaBaxioPlace   to (piStoreFragmaBaxioPlace(Self))
48049>>>>>            Set psFragmaBaxioStatus  to (psStoreFragmaBaxioStatus(Self))
48050>>>>>        End_Procedure // Restore_Defaults
48051>>>>>        
48051>>>>>        Procedure Activating
48053>>>>>            Forward Send Activating
48055>>>>>            Set Auto_Index_State        to True
48056>>>>>            Send Rebuild_Constraints    to Baxio_DD
48057>>>>>        End_Procedure
48058>>>>>        
48058>>>>>        Procedure End_Construct_Object
48060>>>>>            Integer iDecs
48061>>>>>            Forward Send End_Construct_Object
48063>>>>>            Get fiDekadika_Nomismatos SysCurXr.C_Code0  to    iDecs
48064>>>>>            Set Points Item 5 to iDecs
48065>>>>>            Set Numeric_Mask Item 5 to 10 iDecs ' ,*'
48066>>>>>        End_Procedure
48067>>>>>        
48067>>>>>        
48067>>>>>        
48067>>>>>        
48067>>>>>        
48067>>>>>        
48067>>>>>        
48067>>>>>        
48067>>>>>        
48067>>>>>        
48067>>>>>        //AB-StoreEnd
48067>>>>>
48067>>>>>    End_Object    // oSelList
48068>>>>>
48068>>>>>    Object TextBoxSub1 is a TextBoxSub
48070>>>>>        Set Label to "Šã¥ž ˜§¦"
48071>>>>>        Set Location to 241 7
48072>>>>>        Set Size to 10 35
48073>>>>>    End_Object    // TextBoxSub1
48074>>>>>
48074>>>>>    Object cSyDateForm1 is a cSyDateForm
48076>>>>>        Set Size to 13 66
48077>>>>>        Set Location to 240 45
48078>>>>>        Set Label_Col_Offset to 2
48079>>>>>        Set Label_Justification_Mode to jMode_Right
48080>>>>>        Set Form_Mask Item 0 to "d/M/yyyy"
48081>>>>>
48081>>>>>        //AB-StoreStart
48081>>>>>                        
48081>>>>>        Procedure Key Integer iKey
48083>>>>>            Integer iRetVal
48084>>>>>            Forward Send Key iKey
48086>>>>>            If (iKey=277) Begin
48088>>>>>                Set Value Item 0 to ''
48089>>>>>                //Send KeyAction to ButtonSub1
48089>>>>>            End
48089>>>>>>
48089>>>>>        End_Procedure
48090>>>>>        
48090>>>>>        
48090>>>>>        //AB-StoreEnd
48090>>>>>
48090>>>>>    End_Object    // cSyDateForm1
48091>>>>>
48091>>>>>    Object TextBoxSub2 is a TextBoxSub
48093>>>>>        Set Label to "Šã¥ž œàª"
48094>>>>>        Set Location to 258 7
48095>>>>>        Set Size to 10 35
48096>>>>>    End_Object    // TextBoxSub2
48097>>>>>
48097>>>>>    Object cSyDateForm2 is a cSyDateForm
48099>>>>>        Set Size to 13 66
48100>>>>>        Set Location to 256 45
48101>>>>>        Set Label_Col_Offset to 2
48102>>>>>        Set Label_Justification_Mode to jMode_Right
48103>>>>>        Set Form_Mask Item 0 to "d/M/yyyy"
48104>>>>>
48104>>>>>        //AB-StoreStart
48104>>>>>                        
48104>>>>>        Procedure Key Integer iKey
48106>>>>>            Integer iRetVal
48107>>>>>            Forward Send Key iKey
48109>>>>>            If (iKey=277) Begin
48111>>>>>                Set Value Item 0 to ''
48112>>>>>                //Send KeyAction to ButtonSub1
48112>>>>>            End
48112>>>>>>
48112>>>>>        End_Procedure
48113>>>>>        
48113>>>>>        
48113>>>>>        //AB-StoreEnd
48113>>>>>
48113>>>>>    End_Object    // cSyDateForm2
48114>>>>>
48114>>>>>    Object TextBoxSub4 is a TextBoxSub
48116>>>>>        Set Label to "„¡›æ«žª"
48117>>>>>        Set Location to 241 118
48118>>>>>        Set Size to 10 33
48119>>>>>    End_Object    // TextBoxSub4
48120>>>>>
48120>>>>>    Object TextBoxSub5 is a TextBoxSub
48122>>>>>        Set Label to "€§¦›â¡«žª"
48123>>>>>        Set Location to 258 118
48124>>>>>        Set Size to 10 39
48125>>>>>    End_Object    // TextBoxSub5
48126>>>>>
48126>>>>>    Object FormSub1 is a FormSub
48128>>>>>        Set Size to 13 77
48129>>>>>        Set Location to 240 159
48130>>>>>        Set Label_Col_Offset to 2
48131>>>>>        Set Prompt_Button_Mode to pb_PromptOn
48132>>>>>
48132>>>>>        //AB-StoreStart
48132>>>>>                        
48132>>>>>        Set Prompt_Object to (sl100(Self))
48133>>>>>        
48133>>>>>        Procedure OnChange
48135>>>>>            String s1
48136>>>>>            Get Value Item 0 to s1
48137>>>>>            Set Value Of FormSub2 Item 0 to (fsClient(Self,s1))
48138>>>>>            Set psEkdoths to s1
48139>>>>>        End_Procedure
48140>>>>>        
48140>>>>>        
48140>>>>>        
48140>>>>>        
48140>>>>>        
48140>>>>>        
48140>>>>>        
48140>>>>>        //AB-StoreEnd
48140>>>>>
48140>>>>>    End_Object    // FormSub1
48141>>>>>
48141>>>>>    Object FormSub2 is a FormSub
48143>>>>>        Set Size to 13 187
48144>>>>>        Set Location to 240 240
48145>>>>>        Set Color to clBtnFace
48146>>>>>        Set Label_Col_Offset to 2
48147>>>>>        Set Enabled_State to FALSE
48148>>>>>        Set Item_Shadow_State Item 0 to TRUE
48149>>>>>        Set Shadow_State Item 0 to TRUE
48150>>>>>    End_Object    // FormSub2
48151>>>>>
48151>>>>>    Object FormSub3 is a FormSub
48153>>>>>        Set Size to 13 77
48154>>>>>        Set Location to 256 159
48155>>>>>        Set Label_Col_Offset to 2
48156>>>>>        Set Prompt_Button_Mode to pb_PromptOn
48157>>>>>
48157>>>>>        //AB-StoreStart
48157>>>>>                        
48157>>>>>        Set Prompt_Object to (sl100(Self))
48158>>>>>        
48158>>>>>        Procedure OnChange
48160>>>>>            String s1
48161>>>>>            Get Value Item 0 to s1
48162>>>>>            Set Value Of FormSub4 Item 0 to (fsClient(Self,s1))
48163>>>>>            Set psApodekths to s1
48164>>>>>        End_Procedure
48165>>>>>        
48165>>>>>        
48165>>>>>        
48165>>>>>        
48165>>>>>        
48165>>>>>        
48165>>>>>        
48165>>>>>        //AB-StoreEnd
48165>>>>>
48165>>>>>    End_Object    // FormSub3
48166>>>>>
48166>>>>>    Object FormSub4 is a FormSub
48168>>>>>        Set Size to 13 187
48169>>>>>        Set Location to 256 240
48170>>>>>        Set Color to clBtnFace
48171>>>>>        Set Label_Col_Offset to 2
48172>>>>>        Set Enabled_State to FALSE
48173>>>>>        Set Item_Shadow_State Item 0 to TRUE
48174>>>>>        Set Shadow_State Item 0 to TRUE
48175>>>>>    End_Object    // FormSub4
48176>>>>>
48176>>>>>    Object ButtonSub1 is a ButtonSub
48178>>>>>        Set Label to "œ¨ æ¨ ©œ"
48179>>>>>        Set Size to 14 43
48180>>>>>        Set Location to 256 430
48181>>>>>
48181>>>>>        //AB-StoreStart
48181>>>>>                        
48181>>>>>        Procedure OnClick
48183>>>>>            Date dApo dEos
48184>>>>>            Get Value Of cSyDateForm1 Item 0 to dApo
48185>>>>>            Get Value Of cSyDateForm2 Item 0 to dEos
48186>>>>>            Set pdApo to dApo
48187>>>>>            Set pdEos to dEos
48188>>>>>            Send Rebuild_Constraints to Baxio_DD
48189>>>>>            Send Beginning_Of_Data to oSelList True
48190>>>>>        End_Procedure // OnClick
48191>>>>>        
48191>>>>>        
48191>>>>>        
48191>>>>>        
48191>>>>>        
48191>>>>>        
48191>>>>>        
48191>>>>>        
48191>>>>>        
48191>>>>>        
48191>>>>>        
48191>>>>>        
48191>>>>>        
48191>>>>>        //AB-StoreEnd
48191>>>>>
48191>>>>>    End_Object    // ButtonSub1
48192>>>>>
48192>>>>>    Object oOK_bn is a ButtonSub
48194>>>>>        Set Label to "&„§ ¢¦šã"
48195>>>>>        Set Size to 14 43
48196>>>>>        Set Location to 256 478
48197>>>>>
48197>>>>>        //AB-StoreStart
48197>>>>>        Procedure OnClick
48199>>>>>            Send OK To oSelList
48200>>>>>        End_Procedure
48201>>>>>        //AB-StoreEnd
48201>>>>>
48201>>>>>    End_Object    // oOK_bn
48202>>>>>
48202>>>>>
48202>>>>>    //AB-StoreStart
48202>>>>>        
48202>>>>>    On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
48203>>>>>    
48203>>>>>    Procedure Request_Cancel
48205>>>>>        Set Value Of cSyDateForm1 Item 0 to ''
48206>>>>>        Set Value Of cSyDateForm2 Item 0 to ''
48207>>>>>        Set Value Of FormSub1     Item 0 to ''
48208>>>>>        Set Value Of FormSub2     Item 0 to ''
48209>>>>>        Forward Send Request_Cancel
48211>>>>>    End_Procedure
48212>>>>>    
48212>>>>>    
48212>>>>>    
48212>>>>>    
48212>>>>>    
48212>>>>>    //AB-StoreEnd
48212>>>>>
48212>>>>>End_Object    // SL037
48213>>>>>
48213>>>>>//AB/ End_Object    // prj
48213>>>Use sl041.sl
48213>>>Use sl045.sl
INCLUDING FILE: SL045.SL
48213>>>>>//AB/ Project sl045: Wcmoves lookup
48213>>>>>//AB/     Object prj is a Lookup_Project
48213>>>>>//AB/         Set ProjectName to "sl045: Wcmoves lookup"
48213>>>>>//AB/         Set ProjectFileName to "sl045.SL"
48213>>>>>//AB/         Set GenerateFileName to "NONAME"
48213>>>>>
48213>>>>>// Project Object Structure
48213>>>>>//   sl045 is a dbModalPanelSub
48213>>>>>//     Wcmoves_DD is a DataDictionary
48213>>>>>//     oSelList is a dbListSub
48213>>>>>//     cSyDateForm1 is a cSyDateForm
48213>>>>>//     FormSub1 is a FormSub
48213>>>>>//     FormSub3 is a FormSub
48213>>>>>//     oOK_bn is a ButtonSub
48213>>>>>//     oSearch_bn is a ButtonSub
48213>>>>>//     ButtonSub1 is a ButtonSub
48213>>>>>//     TextBoxSub1 is a TextBoxSub
48213>>>>>//     TextBoxSub2 is a TextBoxSub
48213>>>>>
48213>>>>>// Register all objects
48213>>>>>Register_Object ButtonSub1
48213>>>>>Register_Object cSyDateForm1
48213>>>>>Register_Object FormSub1
48213>>>>>Register_Object FormSub3
48213>>>>>Register_Object oOK_bn
48213>>>>>Register_Object oSearch_bn
48213>>>>>Register_Object oSelList
48213>>>>>Register_Object sl045
48213>>>>>Register_Object TextBoxSub1
48213>>>>>Register_Object TextBoxSub2
48213>>>>>Register_Object Wcmoves_DD
48213>>>>>
48213>>>>>
48213>>>>>
48213>>>>>    //AB-StoreTopStart
48213>>>>>    use sl22s.sl
48213>>>>>    
48213>>>>>    //AB-StoreTopEnd
48213>>>>>
48213>>>>>    //AB-IgnoreStart
48213>>>>>
48213>>>>>    Use DFAllEnt.pkg
48213>>>>>    Use dbList.Sub
48213>>>>>    Use cSyDateForm.Pkg
48213>>>>>    Use Form.Sub
48213>>>>>    Use Button.Sub
48213>>>>>    Use Txtbox.Sub
48213>>>>>
48213>>>>>
48213>>>>>    Use WCMOVES.DD
INCLUDING FILE: WCMOVES.DD
48213>>>>>>>//DDB-FileStart
48213>>>>>>>//DDB-HeaderStart
48213>>>>>>>
48213>>>>>>>// File Name : WCMOVES.DD
48213>>>>>>>// Class Name: Wcmoves_DataDictionary
48213>>>>>>>// Revision  : 65
48213>>>>>>>// Version   : 2
48213>>>>>>>
48213>>>>>>>Use  Windows           // Basic Definitions
48213>>>>>>>Use  DataDict          // DataDictionary Class Definition
48213>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48213>>>>>>>
48213>>>>>>>Open Wcmoves
48215>>>>>>>Open Wtypkin
48217>>>>>>>Open Wax
48219>>>>>>>Open Witemx
48221>>>>>>>Open Sysrecw
48223>>>>>>>Open Wam
48225>>>>>>>
48225>>>>>>>//DDB-HeaderEnd
48225>>>>>>>//DDB-SelectionStart
48225>>>>>>>//DDB/ ExternalSelectionList sl045  sl045.SL
48225>>>>>>>//DDB/ ExternalSelectionList slNomism  slnomism.sl
48225>>>>>>>Register_Object sl045
48225>>>>>>>Register_Object slNomism
48225>>>>>>>//DDB-SelectionEnd
48225>>>>>>>
48225>>>>>>>Class Wcmoves_DataDictionary  is a DataDictionary_Sec
48226>>>>>>>
48226>>>>>>>   Procedure Construct_Object
48227>>>>>>>        Forward Send Construct_Object
48229>>>>>>>        Property Integer piFromxrhsh Public 0 //œ¤›œ ¥ž ¦«  œ¨®œ«˜  ˜§¦ €§¦š¨˜­ã ˜§¦Ÿã¡žª
48230>>>>>>>    End_Procedure
48231>>>>>>>
48231>>>>>>>    Function Validate_Save  Returns Integer
48232>>>>>>>        Integer iReturnVal iOpen_Items ifromxrhsh
48233>>>>>>>        String sModule
48233>>>>>>>        get pifromxrhsh to ifromxrhsh
48234>>>>>>>        Forward Get Validate_Save  To iReturnVal
48236>>>>>>>        If (Not(iReturnVal)) Begin
48238>>>>>>>
48238>>>>>>>            Clear Branch
48239>>>>>>>            Move SyscurXr.Company_Code  to Branch.Company_Code
48240>>>>>>>            Move SyscurXr.Branch_Code   to Branch.Branch_Code
48241>>>>>>>            Find Eq Branch By Index.1
48242>>>>>>>>
48242>>>>>>>            If (Not(Found)) Send Operation_Not_Allowed 6666
48245>>>>>>>            Else If ((Branch.Locked_Until<>'') And (WCmoves.WCmove_Hmnia<=Branch.Locked_Until)) Send Operation_Not_Allowed 6667
48249>>>>>>>
48249>>>>>>>            If (WCmoves.Prn_Theor='1') Move 8878 to iReturnVal
48252>>>>>>>            // ˜§¦ ˜§¦š¨˜­ã
48252>>>>>>>            Else If ((WCmoves.WCmove_Hmnia<SYSCURXR.YEAR_XRHSHFROM and ifromxrhsh<>1) Or ;                     (WCmoves.WCmove_Hmnia>SYSCURXR.YEAR_XRHSHTO and ifromxrhsh<>1))     ;                    Move 8877 to iReturnVal
48256>>>>>>>            Else If ((WCmoves.WCmove_QTY =0) And (WCmoves.Unit_Price=0)) Move 8833 to iReturnVal
48260>>>>>>>//                     (WCmoves.WCmove_Axia=0))    ;
48260>>>>>>>// js Allagh 26/08/2002 Gia na mporei na yparxei kinhsh Wcmoves
48260>>>>>>>//    me synolikh axia 0 (na exei timh monados alla p.x. ekptosh 100%)
48260>>>>>>>//    s' ena timologio polhshs.
48260>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
48263>>>>>>>        End
48263>>>>>>>>
48263>>>>>>>        Function_Return iReturnVal
48264>>>>>>>    End_Function   // Validate_Save
48265>>>>>>>
48265>>>>>>>    Function Validate_Delete  Returns Integer
48266>>>>>>>        Integer iReturnVal
48267>>>>>>>        String sModule
48267>>>>>>>        Forward Get Validate_Delete  To iReturnVal
48269>>>>>>>        If (Not(iReturnVal)) Begin
48271>>>>>>>
48271>>>>>>>            Clear Branch
48272>>>>>>>            Move SyscurXr.Company_Code  to Branch.Company_Code
48273>>>>>>>            Move SyscurXr.Branch_Code   to Branch.Branch_Code
48274>>>>>>>            Find Eq Branch By Index.1
48275>>>>>>>>
48275>>>>>>>            If (Not(Found)) Send Operation_Not_Allowed 6668
48278>>>>>>>            Else If ((Branch.Locked_Until<>'') And (WCmoves.WCmove_Hmnia<=Branch.Locked_Until)) Send Operation_Not_Allowed 6669
48282>>>>>>>
48282>>>>>>>            If (WCmoves.Prn_Theor='1') Move 8879 to iReturnVal
48285>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
48288>>>>>>>        End
48288>>>>>>>>
48288>>>>>>>        Function_Return iReturnVal
48289>>>>>>>    End_Function   // Validate_Delete
48290>>>>>>>
48290>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
48291>>>>>>>        String lsError_Message
48292>>>>>>>        Case Begin
48292>>>>>>>
48292>>>>>>>            Case (iError_Num = 6666)
48294>>>>>>>                Move "DDC 045: ‘­á¢£˜ 6666 €›ç¤˜«ž ž œšš¨˜­ž!\nƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ ¬§¦¡˜«˜©«ž£á«à¤" to lsError_Message
48295>>>>>>>            Case Break
48296>>>>>>>
48296>>>>>>>            Case (iError_Num = 6667)
48299>>>>>>>                Move "DDC 045: ‘­á¢£˜ 6667 €›ç¤˜«ž ž œšš¨˜­ž!\n†£/¤å˜ ¡å¤ž©žª §¨¦šœ¤â©«œ¨ž ž£/¤å˜ª ¡¢œ ›é£˜«¦ª" to lsError_Message
48300>>>>>>>            Case Break
48301>>>>>>>
48301>>>>>>>            Case (iError_Num = 6668)
48304>>>>>>>                Move "DDC 045: ‘­á¢£˜ 6668 €›ç¤˜«ž ž › ˜š¨˜­ã!\nƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ ¬§¦¡˜«˜©«ž£á«à¤" to lsError_Message
48305>>>>>>>            Case Break
48306>>>>>>>
48306>>>>>>>            Case (iError_Num = 6669)
48309>>>>>>>                Move "DDC 045: ‘­á¢£˜ 6669 €›ç¤˜«ž ž › ˜š¨˜­ã!\n†£/¤å˜ ¡å¤ž©žª §¨¦šœ¤â©«œ¨ž ž£/¤å˜ª ¡¢œ ›é£˜«¦ª" to lsError_Message
48310>>>>>>>            Case Break
48311>>>>>>>
48311>>>>>>>
48311>>>>>>>            Case (iError_Num = 8833)
48314>>>>>>>                Move "DDC 045:€›ç¤˜«ž ž œšš¨˜­ã!\n˜¥å˜ ¡˜  §¦©æ«ž«˜ œå¤˜  0" to lsError_Message
48315>>>>>>>            Case Break
48316>>>>>>>            Case (iError_Num = 8844)
48319>>>>>>>                Move "DDC 045: ’¦ ¬§æ¢¦ §¦ §¦©æ«ž«˜ª ˜§¦Ÿã¡žª §¨¦¡ç§«œ  ˜¨¤ž« ¡æ \n† «¨â®¦¬©˜ ¡å¤ž©ž ƒ„Œ Ÿ˜ ¡˜«˜®à¨žŸœå" to lsError_Message
48320>>>>>>>            Case Break
48321>>>>>>>            Case (iError_Num = 8877)
48324>>>>>>>                Move "DDC 045:€›ç¤˜«ž ž œšš¨˜­ž!\n\n†£œ¨¦£ž¤åœª œ¡«æª ¦¨åà¤ ®¨ã©žª" to lsError_Message
48325>>>>>>>            Case Break
48326>>>>>>>            Case (iError_Num = 8878)
48329>>>>>>>                Move "DDC 045:€›ç¤˜«ž ž œšš¨˜­ã!\n\„®œ  «¬§àŸœ  Ÿœà¨ž£â¤¦" to lsError_Message
48330>>>>>>>            Case Break
48331>>>>>>>            Case (iError_Num = 8879)
48334>>>>>>>                Move "DDC 045:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\„®œ  «¬§àŸœ  Ÿœà¨ž£â¤¦" to lsError_Message
48335>>>>>>>            Case Break
48336>>>>>>>            Case Else
48336>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
48338>>>>>>>        Case End
48338>>>>>>>        Error iError_Num lsError_Message
48339>>>>>>>>
48339>>>>>>>    End_Procedure // operation_not_allowed
48340>>>>>>>
48340>>>>>>>    Procedure Save_Main_File
48341>>>>>>>        If (Operation_Origin<>Self) Begin
48343>>>>>>>            If Wcmoves.Recnum Eq 0 Procedure_Return
48346>>>>>>>        End
48346>>>>>>>>
48346>>>>>>>        If (WCmoves.Cn_Code<>'') Begin
48348>>>>>>>            Clear Cn
48349>>>>>>>            Move WCmoves.Cn_Code    to Cn.Cn_Code
48350>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
48351>>>>>>>>
48351>>>>>>>            Move Cn.Cn_Sls_ID       to WCmoves.Sls_ID
48352>>>>>>>            Move Cn.CN_Cnt_ID       to WCmoves.Cnt_ID
48353>>>>>>>            Move Cn.Cn_Recr         to WCmoves.Cn_Recr
48354>>>>>>>            Move Cn.mhxanik_id      to Wcmoves.mhxanik_ID
48355>>>>>>>        End
48355>>>>>>>>
48355>>>>>>>        Else Begin
48356>>>>>>>            Move ''     to WCmoves.Sls_ID
48357>>>>>>>            Move ''     to WCmoves.Cnt_ID
48358>>>>>>>            Move ''     to WCmoves.Cn_Recr
48359>>>>>>>            Move ''     to Wcmoves.Mhxanik_ID
48360>>>>>>>        End
48360>>>>>>>>
48360>>>>>>>
48360>>>>>>>        Forward Send Save_Main_File
48362>>>>>>>    End_Procedure   // Save_Main_File
48363>>>>>>>
48363>>>>>>>    Procedure Enhm_Wam Number anQtyEisa Number anQtyExa Number anXre Number anPis Integer iSign
48364>>>>>>>        Integer isFound ifromxrhsh
48365>>>>>>>        get pifromxrhsh to ifromxrhsh
48366>>>>>>>        Move 0 to isFound
48367>>>>>>>
48367>>>>>>>        // 02/10/2001 js
48367>>>>>>>        // Klhsh apo Backout kai Update
48367>>>>>>>        Clear Wam
48368>>>>>>>        Move SysCurXR.Company_Code  to Wam.Company_Code
48369>>>>>>>        Move SysCurXR.Branch_Code   to Wam.Branch_Code
48370>>>>>>>        // ¡ ¤ã©œ ª ˜§¦š¨˜­ãª ¤˜ œ¤ž£œ¨é©¦¬¤ ˜§æŸœ£˜ ¤â˜ª ®¨ã©žª
48370>>>>>>>        if (ifromxrhsh=1) move (syscurxr.year_year+1) to wam.year_year
48373>>>>>>>        else              Move SysCurXR.Year_Year     to Wam.Year_Year
48375>>>>>>>        Move Wapokat.Wapokat_Code   to Wam.Wapokat_Code
48376>>>>>>>        Move Wapomast.Wapomast_Code to Wam.Wapomast_Code
48377>>>>>>>        Move Wax.Wax_Code           to Wam.Wax_Code
48378>>>>>>>        Move Witemkat.Witemkat_Code to Wam.Witemkat_Code
48379>>>>>>>        Move Units.Units_Code       to Wam.Units_Code
48380>>>>>>>        Move Item.Item_Code         to Wam.Item_Code
48381>>>>>>>        Move Witemx.Witemx_Code     to Wam.Witemx_Code
48382>>>>>>>        Find Eq Wam By Index.1
48383>>>>>>>>
48383>>>>>>>        If (Not(Found)) Begin
48385>>>>>>>            Move (SysrecW.Wam_Rec0+1)   to Wam.Wam_Rec0
48386>>>>>>>            Move (SysrecW.Wam_Rec0+1)   to SysrecW.Wam_Rec0
48387>>>>>>>            Saverecord SysrecW
48388>>>>>>>            Move (Append('',((Trim(SysCurXR.Branch_Site))+;                             (Trim(String(Wam.Wam_Rec0)))))) to Wam.Wam_Recr
48389>>>>>>>            Move Witemx.Witemx_Recr to Wam.Witemx_Recr
48390>>>>>>>            Move Wax.Wax_Recr       to Wam.Wax_Recr
48391>>>>>>>        End
48391>>>>>>>>
48391>>>>>>>        Add (anQtyEisa*iSign)       to Wam.Wam_qty_Eisa
48392>>>>>>>        Add (anQtyExa *iSign)       to Wam.Wam_qty_Exa
48393>>>>>>>        Add (anXre    *iSign)       to Wam.Wam_Amt_Eisa
48394>>>>>>>        Add (anPis    *iSign)       to Wam.Wam_Amt_Exa
48395>>>>>>>
48395>>>>>>>        Move (Wam.Wam_Qty_Eisa-Wam.Wam_Qty_Exa) to Wam.Wam_Qty_Apoth
48396>>>>>>>        Move (Wam.Wam_Amt_Eisa-Wam.Wam_Amt_Exa) to Wam.Wam_Amt_Apoth
48397>>>>>>>
48397>>>>>>>        Saverecord Wam
48398>>>>>>>
48398>>>>>>>        If (Sysfile.Chk_Apothema='1') Begin
48400>>>>>>>            If ((Wam.Wam_qty_Exa  >Wam.Wam_qty_Eisa) Or ;                (Wam.Wam_Qty_Apoth<0)) Send Operation_Not_Allowed 8844
48403>>>>>>>        End
48403>>>>>>>>
48403>>>>>>>        // 02/10/2001 js
48403>>>>>>>    End_Procedure
48404>>>>>>>
48404>>>>>>>    // Update:
48404>>>>>>>    Procedure Update
48405>>>>>>>        integer ifromxrhsh
48406>>>>>>>        Number nx np nqtyx nqtyp
48406>>>>>>>        Forward Send Update
48408>>>>>>>        get pifromxrhsh to ifromxrhsh
48409>>>>>>>        // Insert Code Here
48409>>>>>>>        Move SysCurXR.Company_Code  to WCmoves.Company_Code
48410>>>>>>>        Move SysCurXR.Branch_Code   to WCmoves.Branch_Code
48411>>>>>>>        // ¤˜ š¨á¯œ  ˜§¦š¨˜­ã ©«¦ œ«¦ª + 1
48411>>>>>>>        if (ifromxrhsh=1) move (syscurxr.year_year+1) to wcmoves.year_year
48414>>>>>>>        else              Move SysCurXR.Year_Year     to Wcmoves.Year_Year
48416>>>>>>>       // Move SysCurXR.Year_Year     to WCmoves.Year_Year
48416>>>>>>>        Move Wtypkin.Wtypkin_Code   to WCmoves.Wtypkin_Code
48417>>>>>>>        Move Wapokat.Wapokat_Code   to WCmoves.Wapokat_Code
48418>>>>>>>        Move Wapomast.Wapomast_Code to WCmoves.Wapomast_Code
48419>>>>>>>        Move Wax.Wax_Code           to WCmoves.Wax_Code
48420>>>>>>>        Move Witemkat.Witemkat_Code to WCmoves.Witemkat_Code
48421>>>>>>>        Move Units.Units_Code       to WCmoves.Units_Code
48422>>>>>>>        Move Item.Item_Code         to WCmoves.Item_Code
48423>>>>>>>        Move Witemx.Witemx_Code     to WCmoves.Witemx_Code
48424>>>>>>>
48424>>>>>>>
48424>>>>>>>        Move 0 to nx
48425>>>>>>>        Move 0 to np
48426>>>>>>>        Move 0 to nqtyx
48427>>>>>>>        Move 0 to nqtyp
48428>>>>>>>
48428>>>>>>>        // js 13/02/2002
48428>>>>>>>        // An ta extra pedia timon den exoun timh tote to wcmoves enhmeronei me axies
48428>>>>>>>        If (Wcmoves.Wcmov_Axia=0) Begin
48430>>>>>>>                 If (Wcmoves.Wcmove_X0<>0)  Move Wcmoves.Wcmov_Totamad0 to nx
48433>>>>>>>            Else If (Wcmoves.Wcmove_P0<>0)  Move Wcmoves.Wcmov_Totamad0 to np
48437>>>>>>>        End
48437>>>>>>>>
48437>>>>>>>        // An ta extra pedia posothton den exoun timh tote to wcmoves enhmeronei me posothtes
48437>>>>>>>        If ((Wcmoves.Sx_Posothta_Eis=0) And (Wcmoves.Sx_Posothta_Ex=0)) Begin
48439>>>>>>>                 If (Wcmoves.Wcmove_Qty_Eisa<>0) Move Wcmoves.Wcmove_Qty_Eisa   to nqtyx
48442>>>>>>>            Else If (Wcmoves.Wcmove_Qty_Exa <>0) Move Wcmoves.Wcmove_Qty_Exa    to nqtyp
48446>>>>>>>        End
48446>>>>>>>>
48446>>>>>>>
48446>>>>>>>        Add nqtyx   to witemx.qty_xre
48447>>>>>>>        Add nqtyp   to witemx.qty_pis
48448>>>>>>>        Add nx      to witemx.axia_xre
48449>>>>>>>        Add np      to witemx.axia_pis
48450>>>>>>>
48450>>>>>>>        // 02/10/2001 Enhmerosh arxeiou WAM
48450>>>>>>>        Send Enhm_Wam   nqtyx   ;                        nqtyp   ;                        nx      ;                        np      ;                        1
48451>>>>>>>
48451>>>>>>>        If (Wcmoves.Wcmove_SC_Code2='') ;             Move SyscurXr.C_Code0 to Wcmoves.Wcmove_SC_Code2
48454>>>>>>>
48454>>>>>>>
48454>>>>>>>    End_Procedure   // Update
48455>>>>>>>
48455>>>>>>>     // Backout:
48455>>>>>>>    Procedure Backout
48456>>>>>>>        Number nx np nqtyx nqtyp
48457>>>>>>>        Forward Send Backout
48459>>>>>>>
48459>>>>>>>        Move 0 to nx
48460>>>>>>>        Move 0 to np
48461>>>>>>>        Move 0 to nqtyx
48462>>>>>>>        Move 0 to nqtyp
48463>>>>>>>
48463>>>>>>>        // js 13/02/2002
48463>>>>>>>        // An ta extra pedia timon den exoun timh tote to wcmoves enhmeronei me axies
48463>>>>>>>        If (Wcmoves.Wcmov_Axia=0) Begin
48465>>>>>>>                 If (Wcmoves.Wcmove_X0<>0)  Move Wcmoves.Wcmov_Totamad0 to nx
48468>>>>>>>            Else If (Wcmoves.Wcmove_P0<>0)  Move Wcmoves.Wcmov_Totamad0 to np
48472>>>>>>>        End
48472>>>>>>>>
48472>>>>>>>        // An ta extra pedia posothton den exoun timh tote to wcmoves enhmeronei me posothtes
48472>>>>>>>        If ((Wcmoves.Sx_Posothta_Eis=0) And (Wcmoves.Sx_Posothta_Ex=0)) Begin
48474>>>>>>>                 If (Wcmoves.Wcmove_Qty_Eisa<>0) Move Wcmoves.Wcmove_Qty_Eisa   to nqtyx
48477>>>>>>>            Else If (Wcmoves.Wcmove_Qty_Exa <>0) Move Wcmoves.Wcmove_Qty_Exa    to nqtyp
48481>>>>>>>        End
48481>>>>>>>>
48481>>>>>>>
48481>>>>>>>        Sub nqtyx  From witemx.qty_xre
48482>>>>>>>        Sub nqtyp  From witemx.qty_pis
48483>>>>>>>        Sub nx     From witemx.axia_xre
48484>>>>>>>        Sub np     From witemx.axia_pis
48485>>>>>>>
48485>>>>>>>        // 02/10/2001 Enhmerosh arxeiou WAM
48485>>>>>>>        Send Enhm_Wam   nqtyx   ;                        nqtyp   ;                        nx      ;                        np      ;                        -1
48486>>>>>>>    End_Procedure   // Backout
48487>>>>>>>
48487>>>>>>>
48487>>>>>>>    // Creating:
48487>>>>>>>     Procedure Creating
48488>>>>>>>        Forward Send Creating
48490>>>>>>>        // Insert Code Here
48490>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wcmoves.Wcmove_Rec0)))))) to Wcmoves.Wcmove_Recr
48491>>>>>>>        If (Wcmoves.Wcmove_SC_Code2='') Move SyscurXr.C_Code0 to Wcmoves.Wcmove_SC_Code2
48494>>>>>>>    End_Procedure   // Creating
48495>>>>>>>
48495>>>>>>>    // Define_Fields:
48495>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48495>>>>>>>
48495>>>>>>>   Procedure Entry_wcmoves_date Integer iField Date dDate
48496>>>>>>>         Local Integer Changed
48497>>>>>>>         Get Field_Changed_State iField to Changed
48498>>>>>>>         If ( Changed=0 AND dDate = 0) Begin
48500>>>>>>>           SysDate4 dDate
48501>>>>>>>           Set Field_Default_Value iField to dDate
48502>>>>>>>         End
48502>>>>>>>>
48502>>>>>>>   End_Procedure
48503>>>>>>>
48503>>>>>>>
48503>>>>>>>    Procedure Define_Fields
48504>>>>>>>        Forward Send Define_Fields
48506>>>>>>>        //DDB-Generated-Code-Location
48506>>>>>>>        //DDB-DefineFieldStart
48506>>>>>>>
48506>>>>>>>        Set Main_File            To Wcmoves.File_Number
48507>>>>>>>        Set Cascade_Delete_State To FALSE
48508>>>>>>>
48508>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
48509>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
48510>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48511>>>>>>>
48511>>>>>>>        // Parent (Server) file structure...............
48511>>>>>>>        Send Add_Server_File  Wtypkin.File_Number
48512>>>>>>>        Send Add_Server_File  Wax.File_Number
48513>>>>>>>        Send Add_Server_File  Witemx.File_Number
48514>>>>>>>
48514>>>>>>>        // External (System) file structure.............
48514>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
48515>>>>>>>        Send Add_System_File  Wam.File_Number  DD_LOCK_ON_ALL
48516>>>>>>>
48516>>>>>>>        Define_Auto_Increment  Sysrecw.Wcmoves_Rec0  To Wcmoves.Wcmove_Rec0
48519>>>>>>>
48519>>>>>>>        // Field-based properties.......................
48519>>>>>>>
48519>>>>>>>        // Wcmoves.Company_Code
48519>>>>>>>
48519>>>>>>>        // Wcmoves.Branch_Code
48519>>>>>>>
48519>>>>>>>        // Wcmoves.Year_Year
48519>>>>>>>
48519>>>>>>>        // Wcmoves.Wtypkin_Code
48519>>>>>>>
48519>>>>>>>        // Wcmoves.Wapokat_Code
48519>>>>>>>
48519>>>>>>>        // Wcmoves.Wapomast_Code
48519>>>>>>>
48519>>>>>>>        // Wcmoves.Wax_Code
48519>>>>>>>
48519>>>>>>>        // Wcmoves.Witemkat_Code
48519>>>>>>>
48519>>>>>>>        // Wcmoves.Units_Code
48519>>>>>>>
48519>>>>>>>        // Wcmoves.Item_Code
48519>>>>>>>
48519>>>>>>>        // Wcmoves.Witemx_Code
48519>>>>>>>
48519>>>>>>>        // Wcmoves.Wcmove_Recr
48519>>>>>>>
48519>>>>>>>        // Wcmoves.Wcmove_Rec0
48519>>>>>>>
48519>>>>>>>        // Wcmoves.Wcmove_Hmnia
48519>>>>>>>        Set Field_Entry_msg        Field Wcmoves.Wcmove_Hmnia To Entry_wcmoves_date
48520>>>>>>>        Set Field_Mask_Type        Field Wcmoves.Wcmove_Hmnia To MASK_DATE_WINDOW
48521>>>>>>>        Set Field_Prompt_Object    Field Wcmoves.Wcmove_Hmnia To (sl045(Self))
48522>>>>>>>
48522>>>>>>>        // Wcmoves.Wtypkin_Recr
48522>>>>>>>
48522>>>>>>>        // Wcmoves.Wax_Recr
48522>>>>>>>
48522>>>>>>>        // Wcmoves.Witemx_Recr
48522>>>>>>>
48522>>>>>>>        // Wcmoves.Wcmove_Par
48522>>>>>>>
48522>>>>>>>        // Wcmoves.Partl_Recr
48522>>>>>>>
48522>>>>>>>        // Wcmoves.Wcmove_Axia
48522>>>>>>>
48522>>>>>>>        // Wcmoves.Wcmove_X0
48522>>>>>>>
48522>>>>>>>        // Wcmoves.Wcmove_P0
48522>>>>>>>
48522>>>>>>>        // Wcmoves.Wcmove_X00
48522>>>>>>>
48522>>>>>>>        // Wcmoves.Wcmove_P00
48522>>>>>>>
48522>>>>>>>        // Wcmoves.Wcmove_X1
48522>>>>>>>
48522>>>>>>>        // Wcmoves.Wcmove_P1
48522>>>>>>>
48522>>>>>>>        // Wcmoves.Wcmove_X2
48522>>>>>>>
48522>>>>>>>        // Wcmoves.Wcmove_P2
48522>>>>>>>
48522>>>>>>>        // Wcmoves.Wcmove_Dlixis
48522>>>>>>>
48522>>>>>>>        // Wcmoves.Wcmove_A_Code
48522>>>>>>>
48522>>>>>>>        // Wcmoves.Wcmove_Status_E
48522>>>>>>>
48522>>>>>>>        // Wcmoves.Wcmove_Status_A
48522>>>>>>>
48522>>>>>>>        // Wcmoves.Wcmove_S0
48522>>>>>>>
48522>>>>>>>        // Wcmoves.Wcmove_Ys0
48522>>>>>>>
48522>>>>>>>        // Wcmoves.Wcmove_S1
48522>>>>>>>
48522>>>>>>>        // Wcmoves.Wcmove_Ys1
48522>>>>>>>
48522>>>>>>>        // Wcmoves.Wcmove_S2
48522>>>>>>>
48522>>>>>>>        // Wcmoves.Wcmove_Ys2
48522>>>>>>>
48522>>>>>>>        // Wcmoves.Wcmove_Sc_Code2
48522>>>>>>>        Set Field_Prompt_Object    Field Wcmoves.Wcmove_Sc_Code2 To (slNomism(Self))
48523>>>>>>>
48523>>>>>>>        // Wcmoves.Wcmove_Open
48523>>>>>>>
48523>>>>>>>        // Wcmoves.Wcmove_Aopen
48523>>>>>>>
48523>>>>>>>        // Wcmoves.Wcmove_Yn_Myf
48523>>>>>>>
48523>>>>>>>        // Wcmoves.Wcmove_Myf_Axia
48523>>>>>>>
48523>>>>>>>        // Wcmoves.Wcmove_Kk
48523>>>>>>>
48523>>>>>>>        // Wcmoves.Wcmove_C_Code2
48523>>>>>>>        Set Field_Prompt_Object    Field Wcmoves.Wcmove_C_Code2 To (slNomism(Self))
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Client_Recr
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Cn_Code
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmove_Qty
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmov_Totambd0
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmov_Discam0
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmov_Totamad0
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmov_Vatam0
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmov_Extra0
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmov_Totambd00
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmov_Discam00
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmov_Totamad00
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmov_Vatam00
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmov_Extra00
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmov_Totambd1
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmov_Discam1
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmov_Totamad1
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmov_Vatam1
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmov_Extra1
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmove_Qty_Exa
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmove_Qty_Eisa
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Client_Id
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Module_From
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Unit_Price0
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Unit_Price00
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Unit_Pricer
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Cn_Recr
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Sls_Id
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Cnt_Id
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Presp_Id
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Mhxanik_Id
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Prn_Theor
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Extra_Axia
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Extra_Axia0
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Extra_Axia00
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Extra_Axiar
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Disc_Axia
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Disc_Axia0
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Disc_Axia00
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Disc_Axiar
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Unit_Price
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Particle_Recr
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Sx_Posothta_Eis
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Sx_Posothta_Ex
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmov_Axia
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmov_X0
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmov_X00
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmov_X1
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmov_X2
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmov_P0
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmov_P00
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmov_P1
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmov_P2
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Unit_Pric0
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Unit_Pric00
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Unit_Pricr
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmo_Totambd0
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmo_Totambd00
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmo_Totambd1
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmo_Discam0
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmo_Discam00
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmo_Discam1
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmo_Totamad0
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmo_Totamad00
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmo_Totamad1
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmo_Vatam0
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmo_Vatam00
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmo_Vatam1
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmo_Extra0
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmo_Extra00
48524>>>>>>>
48524>>>>>>>        // Wcmoves.Wcmo_Extra1
48524>>>>>>>
48524>>>>>>>        //DDB-DefineFieldEnd
48524>>>>>>>    End_Procedure    // Define_Fields
48525>>>>>>>
48525>>>>>>>    // Field_Defaults:
48525>>>>>>>    // This procedure is used to establish default field values.
48525>>>>>>>
48525>>>>>>>    Procedure Field_Defaults
48526>>>>>>>        Forward Send Field_Defaults
48528>>>>>>>        //DDB-Generated-Code-Location
48528>>>>>>>        //DDB-FieldDefaultStart
48528>>>>>>>        //DDB-FieldDefaultEnd
48528>>>>>>>    End_Procedure    // Field_Defaults
48529>>>>>>>
48529>>>>>>>
48529>>>>>>>
48529>>>>>>>End_Class    // Wcmoves_DataDictionary
48530>>>>>>>//DDB-Selection-pkg-Start
48530>>>>>>>
48530>>>>>>>Use sl045.SL         // sl045
48530>>>>>>>Use slnomism.sl      // slNomism
48530>>>>>>>
48530>>>>>>>//DDB-Selection-pkg-End
48530>>>>>>>//DDB-FileEnd
48530>>>>>    
48530>>>>>    //AB-IgnoreEnd
48530>>>>>
48530>>>>>    Object sl045 is a dbModalPanelSub
48532>>>>>
48532>>>>>        //AB-StoreTopStart
48532>>>>>        Property String psModule    Public ''
48534>>>>>        Property String psItemxCode Public ''
48536>>>>>        Property date   pddate      Public ''
48538>>>>>        //AB-StoreTopEnd
48538>>>>>
48538>>>>>        Set Label to "‰ ¤ã©œ ª €§¦Ÿã¡žª"
48539>>>>>        Set Size to 279 515
48540>>>>>        Set Location to 0 4
48541>>>>>        Set Exit_Application_Local_State to FALSE
48542>>>>>        Set Modal_State to FALSE
48543>>>>>
48543>>>>>        //AB-DDOStart
48543>>>>>
48543>>>>>        Object Wcmoves_DD is a Wcmoves_DataDictionary
48545>>>>>
48545>>>>>            //AB-StoreStart
48545>>>>>                        
48545>>>>>            Begin_Constraints
48547>>>>>                Constrain wcmoves.company_code  eq syscurxr.company_code
48549>>>>>                Constrain wcmoves.branch_code   eq syscurxr.branch_code
48551>>>>>                Constrain wcmoves.year_year     eq syscurxr.year_year
48553>>>>>                If (psItemxCode(Self)<>'') Begin
48555>>>>>                    Set Ordering to 15
48556>>>>>                    Constrain WCmoves.Witemx_Code Eq (Trim(psItemxCode(Self)))
48558>>>>>                    if (pddate(self)<>'') constrain wcmoves.wcmove_hmnia eq (pddate(self))
48562>>>>>                End
48562>>>>>>
48562>>>>>                Else begin
48563>>>>>                    Set Ordering to 3
48564>>>>>                    if (pddate(self)<>'') constrain wcmoves.wcmove_hmnia eq (pddate(self))
48568>>>>>                End
48568>>>>>>
48568>>>>>            End_Constraints
48571>>>>>            
48571>>>>>            
48571>>>>>            
48571>>>>>            
48571>>>>>            
48571>>>>>            
48571>>>>>            
48571>>>>>            
48571>>>>>            
48571>>>>>            
48571>>>>>            
48571>>>>>            
48571>>>>>            
48571>>>>>            
48571>>>>>            
48571>>>>>            
48571>>>>>            //AB-StoreEnd
48571>>>>>
48571>>>>>        End_Object    // Wcmoves_DD
48572>>>>>
48572>>>>>        Set Main_DD to (Wcmoves_DD(self))
48573>>>>>        Set Server to (Wcmoves_DD(self))
48574>>>>>
48574>>>>>        //AB-DDOEnd
48574>>>>>
48574>>>>>        Object oSelList is a dbListSub
48576>>>>>            Set Main_File to Wcmoves.File_Number
48577>>>>>            Set Size to 229 501
48578>>>>>            Set Location to 2 7
48579>>>>>            Set Auto_Index_State to FALSE
48580>>>>>
48580>>>>>            Begin_Row
48583>>>>>                Entry_Item Wcmoves.Witemx_code
48584>>>>>                Entry_Item (fswax(self,wcmoves.wax_recr))
48585>>>>>                Entry_Item (fswtypkin(self,wcmoves.wtypkin_code))
48586>>>>>                Entry_Item Wcmoves.Wcmove_hmnia
48587>>>>>                Entry_Item Wcmoves.Wcmove_par
48588>>>>>                Entry_Item Wcmoves.Wcmove_axia
48589>>>>>                Entry_Item Wcmoves.Wcmove_qty
48590>>>>>                Entry_Item Wcmoves.Wcmove_sc_code2
48591>>>>>                Entry_Item Wcmoves.Module_from
48592>>>>>            End_Row
48597>>>>>
48597>>>>>            Set Form_Width    item 0 to 85
48598>>>>>            Set Header_Label  item 0 to "„å›¦ª"
48599>>>>>            
48599>>>>>            Set Form_Width    item 1 to 50
48600>>>>>            Set Header_Label  item 1 to "€§¦Ÿã¡ž "
48601>>>>>            
48601>>>>>            Set Form_Width    item 2 to 80
48602>>>>>            Set Header_Label  item 2 to "‰å¤ž©ž"
48603>>>>>            
48603>>>>>            Set Form_Width    item 3 to 51
48604>>>>>            Set Header_Label  item 3 to "†£œ¨/¤å˜"
48605>>>>>            
48605>>>>>            Set Form_Width    item 4 to 65
48606>>>>>            Set Header_Label  item 4 to "€ « ¦¢¦šå˜"
48607>>>>>            
48607>>>>>            Set Form_Width    item 5 to 60
48608>>>>>            Set Header_Label  item 5 to " €¥å˜"
48609>>>>>            
48609>>>>>            Set Form_Width    item 6 to 51
48610>>>>>            Set Header_Label  item 6 to "¦©æ«ž«˜"
48611>>>>>            
48611>>>>>            Set Form_Width    item 7 to 26
48612>>>>>            Set Header_Label  item 7 to "Œ¦£"
48613>>>>>            
48613>>>>>            Set Form_Width    item 8 to 27
48614>>>>>            Set Header_Label  item 8 to "‰ç¡¢"
48615>>>>>            
48615>>>>>
48615>>>>>            //AB-StoreStart
48615>>>>>                                    
48615>>>>>            Procedure End_Construct_Object
48617>>>>>                String  sNom
48618>>>>>                Integer iDecs
48618>>>>>                Forward Send End_Construct_Object
48620>>>>>                Move SysCurxr.C_Code0 to sNom
48621>>>>>                Clear Nomisma
48622>>>>>                Move sNom to Nomisma.Nomisma_Code
48623>>>>>                Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
48624>>>>>>
48624>>>>>                If (Found=1)    Move Nomisma.Dekadika to iDecs
48627>>>>>                Else            Move 0 to iDecs
48629>>>>>                // ˜¨˜›¦®ã: ˜¤ «¦ ™˜© ¡æ ¤¦£ ©£˜ ®¨ã©žª ƒ„Œ œ®œ  ›œ¡˜› ¡á
48629>>>>>                // «æ«œ œ¥' ¦¨ ©£¦ç ™á¦¬£œ œ£œ ª 2
48629>>>>>                If (iDecs=0) Move 2 to iDecs
48632>>>>>                Set Points          Item 5 to       iDecs
48633>>>>>                Set Numeric_Mask    Item 5 to 14    iDecs '*, '
48634>>>>>                Set Points          Item 6 to       2 // ¦©æ«ž«˜
48635>>>>>            End_Procedure
48636>>>>>            
48636>>>>>            Procedure Activate
48638>>>>>                Send Keyaction to ButtonSub1
48639>>>>>                Forward Send Activate
48641>>>>>            End_procedure
48642>>>>>            
48642>>>>>            
48642>>>>>            
48642>>>>>            
48642>>>>>            
48642>>>>>            
48642>>>>>            
48642>>>>>            
48642>>>>>            
48642>>>>>            
48642>>>>>            
48642>>>>>            
48642>>>>>            
48642>>>>>            
48642>>>>>            
48642>>>>>            
48642>>>>>            
48642>>>>>            
48642>>>>>            
48642>>>>>            //AB-StoreEnd
48642>>>>>
48642>>>>>        End_Object    // oSelList
48643>>>>>
48643>>>>>        Object cSyDateForm1 is a cSyDateForm
48645>>>>>            Set Size to 13 75
48646>>>>>            Set Location to 236 51
48647>>>>>            Set Label_Col_Offset to 2
48648>>>>>            Set Label_Justification_Mode to jMode_Right
48649>>>>>            Set Form_Mask Item 0 to "d/M/yyyy"
48650>>>>>
48650>>>>>            //AB-StoreStart
48650>>>>>                                            
48650>>>>>            Procedure Key Integer iKey
48652>>>>>                Integer iRetVal
48653>>>>>                Forward Send Key iKey
48655>>>>>                If (iKey=277) Begin
48657>>>>>                    Send Clear_Me
48658>>>>>                End
48658>>>>>>
48658>>>>>            End_Procedure
48659>>>>>            
48659>>>>>            Procedure Clear_Me
48661>>>>>                Set Value Item 0 to ''
48662>>>>>                Send KeyAction to ButtonSub1
48663>>>>>            End_Procedure
48664>>>>>            
48664>>>>>            Procedure onchange
48666>>>>>                date ddate
48667>>>>>                get value item 0 to ddate
48668>>>>>                set pddate to ddate
48669>>>>>            
48669>>>>>            end_procedure
48670>>>>>            
48670>>>>>            
48670>>>>>            
48670>>>>>            
48670>>>>>            
48670>>>>>            
48670>>>>>            
48670>>>>>            
48670>>>>>            
48670>>>>>            //AB-StoreEnd
48670>>>>>
48670>>>>>        End_Object    // cSyDateForm1
48671>>>>>
48671>>>>>        Object FormSub1 is a FormSub
48673>>>>>            Set Size to 13 75
48674>>>>>            Set Location to 250 51
48675>>>>>            Set Label_Col_Offset to 2
48676>>>>>            Set Prompt_Button_Mode to pb_PromptOn
48677>>>>>
48677>>>>>            //AB-StoreStart
48677>>>>>                                                                                            
48677>>>>>            Set Prompt_Object to (sl22s(Self))
48678>>>>>            
48678>>>>>            
48678>>>>>            Procedure OnChange
48680>>>>>                String sitem
48681>>>>>                Get Value Item 0 to sitem
48682>>>>>                set psitemxcode to sitem
48683>>>>>                Set Value Of FormSub3 Item 0 to (fsitem(Self,sitem))
48684>>>>>            End_Procedure
48685>>>>>            
48685>>>>>            Procedure Key Integer iKey
48687>>>>>                Integer iRetVal
48688>>>>>                Forward Send Key iKey
48690>>>>>                If (iKey=277) Begin
48692>>>>>                    Send Clear_item
48693>>>>>                End
48693>>>>>>
48693>>>>>            End_Procedure
48694>>>>>            
48694>>>>>            Procedure Clear_item
48696>>>>>                Set Value Item 0 to ''
48697>>>>>                Send KeyAction to ButtonSub1
48698>>>>>            End_Procedure
48699>>>>>            
48699>>>>>            
48699>>>>>            
48699>>>>>            
48699>>>>>            
48699>>>>>            
48699>>>>>            
48699>>>>>            
48699>>>>>            
48699>>>>>            //AB-StoreEnd
48699>>>>>
48699>>>>>        End_Object    // FormSub1
48700>>>>>
48700>>>>>        Object FormSub3 is a FormSub
48702>>>>>            Set Size to 13 195
48703>>>>>            Set Location to 250 132
48704>>>>>            Set Color to clBtnFace
48705>>>>>            Set Label_Col_Offset to 2
48706>>>>>            Set Enabled_State to FALSE
48707>>>>>            Set Item_Shadow_State Item 0 to TRUE
48708>>>>>            Set Shadow_State Item 0 to TRUE
48709>>>>>        End_Object    // FormSub3
48710>>>>>
48710>>>>>        Object oOK_bn is a ButtonSub
48712>>>>>            Set Label to "&„§ ¢¦šã"
48713>>>>>            Set Location to 248 397
48714>>>>>
48714>>>>>            //AB-StoreStart
48714>>>>>            Procedure OnClick
48716>>>>>                Send OK To (oSelList(current_object))
48717>>>>>            End_Procedure
48718>>>>>            //AB-StoreEnd
48718>>>>>
48718>>>>>        End_Object    // oOK_bn
48719>>>>>
48719>>>>>        Object oSearch_bn is a ButtonSub
48721>>>>>            Set Label to "€&¤˜ã«ž©ž"
48722>>>>>            Set Location to 248 457
48723>>>>>
48723>>>>>            //AB-StoreStart
48723>>>>>            Procedure OnClick
48725>>>>>                Send Search To (oSelList(current_object))
48726>>>>>            End_Procedure
48727>>>>>            //AB-StoreEnd
48727>>>>>
48727>>>>>        End_Object    // oSearch_bn
48728>>>>>
48728>>>>>        Object ButtonSub1 is a ButtonSub
48730>>>>>            Set Label to "œ¨ æ¨ ©œ"
48731>>>>>            Set Size to 13 50
48732>>>>>            Set Location to 249 337
48733>>>>>            Set Form_FontWeight Item 0 to 600
48734>>>>>
48734>>>>>            //AB-StoreStart
48734>>>>>                                                                                                        
48734>>>>>            Procedure OnClick
48736>>>>>                Send Rebuild_Constraints to Wcmoves_DD
48737>>>>>                Send Beginning_Of_Data to oSelList True
48738>>>>>            End_Procedure // OnClick
48739>>>>>            
48739>>>>>            
48739>>>>>            
48739>>>>>            //AB-StoreEnd
48739>>>>>
48739>>>>>        End_Object    // ButtonSub1
48740>>>>>
48740>>>>>        Object TextBoxSub1 is a TextBoxSub
48742>>>>>            Set Label to "†£/¤å˜"
48743>>>>>            Set Location to 239 5
48744>>>>>            Set Size to 10 31
48745>>>>>        End_Object    // TextBoxSub1
48746>>>>>
48746>>>>>        Object TextBoxSub2 is a TextBoxSub
48748>>>>>            Set Label to "„å›¦ª"
48749>>>>>            Set Location to 251 5
48750>>>>>            Set Size to 12 21
48751>>>>>        End_Object    // TextBoxSub2
48752>>>>>
48752>>>>>
48752>>>>>        //AB-StoreStart
48752>>>>>                        
48752>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
48753>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
48754>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
48755>>>>>        
48755>>>>>        Set Locate_Mode to Center_On_Screen
48756>>>>>        Set Modal_State to True
48757>>>>>        
48757>>>>>        Procedure Activate
48759>>>>>            Forward send Activate
48761>>>>>        End_Procedure
48762>>>>>        
48762>>>>>        Procedure Request_Cancel
48764>>>>>            Set Value Of cSyDateForm1 Item 0 to ''
48765>>>>>            set value of formsub1     item 0 to ''
48766>>>>>            set value of formsub3     item 0 to ''
48767>>>>>            Send Clear to wcmoves_dd
48768>>>>>            Forward Send Request_Cancel
48770>>>>>        End_Procedure
48771>>>>>        
48771>>>>>        
48771>>>>>        
48771>>>>>        
48771>>>>>        
48771>>>>>        
48771>>>>>        
48771>>>>>        
48771>>>>>        
48771>>>>>        
48771>>>>>        
48771>>>>>        //AB-StoreEnd
48771>>>>>
48771>>>>>    End_Object    // sl045
48772>>>>>
48772>>>>>
48772>>>>>    //AB-StoreStart
48772>>>>>                        
48772>>>>>                        
48772>>>>>                        
48772>>>>>    //AB-StoreEnd
48772>>>>>
48772>>>>>//AB/     End_Object    // prj
48772>>>use sl052.sl
INCLUDING FILE: SL052.SL
48772>>>>>//AB/ Project sl052:drivers
48772>>>>>//AB/ Object prj is a Lookup_Project
48772>>>>>//AB/     Set ProjectName to "sl052:drivers"
48772>>>>>//AB/     Set ProjectFileName to "sl052.SL"
48772>>>>>//AB/     Set GenerateFileName to "NONAME"
48772>>>>>
48772>>>>>// Project Object Structure
48772>>>>>//   sl052 is a dbModalPanelSub
48772>>>>>//     Drivers_DD is a DataDictionary
48772>>>>>//     oSelList is a dbListSub
48772>>>>>//     oOK_bn is a ButtonSub
48772>>>>>//     oCancel_bn is a ButtonSub
48772>>>>>//     oSearch_bn is a ButtonSub
48772>>>>>
48772>>>>>// Register all objects
48772>>>>>Register_Object Drivers_DD
48772>>>>>Register_Object oCancel_bn
48772>>>>>Register_Object oOK_bn
48772>>>>>Register_Object oSearch_bn
48772>>>>>Register_Object oSelList
48772>>>>>Register_Object sl052
48772>>>>>
48772>>>>>
48772>>>>>//AB-IgnoreStart
48772>>>>>
48772>>>>>Use DFAllEnt.pkg
48772>>>>>Use dbList.Sub
48772>>>>>Use Button.Sub
48772>>>>>
48772>>>>>
48772>>>>>Use DRIVERS.DD
INCLUDING FILE: DRIVERS.DD
48772>>>>>>>//DDB-FileStart
48772>>>>>>>//DDB-HeaderStart
48772>>>>>>>
48772>>>>>>>// File Name : DRIVERS.DD
48772>>>>>>>// Class Name: Drivers_DataDictionary
48772>>>>>>>// Revision  : 18
48772>>>>>>>// Version   : 2
48772>>>>>>>
48772>>>>>>>Use  Windows           // Basic Definitions
48772>>>>>>>Use  DataDict          // DataDictionary Class Definition
48772>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48772>>>>>>>
48772>>>>>>>Open Drivers
48774>>>>>>>Open Sysrecc
48776>>>>>>>
48776>>>>>>>//DDB-HeaderEnd
48776>>>>>>>//DDB-ValidationStart
48776>>>>>>>
48776>>>>>>>Register_Object Drivers_Driver_Doy_VT
48776>>>>>>>
48776>>>>>>>Object Drivers_Driver_Doy_VT  is a CodeValidationTable
48778>>>>>>>    Set Type_Value        To "DOY"
48779>>>>>>>    Set Validate_State    To FALSE
48780>>>>>>>    Set Allow_Blank_State To TRUE
48781>>>>>>>    //DDB-ValidationCustomStart
48781>>>>>>>    //DDB-ValidationCustomEnd
48781>>>>>>>End_Object   // Drivers_Driver_Doy_VT
48782>>>>>>>//DDB-ValidationEnd
48782>>>>>>>//DDB-SelectionStart
48782>>>>>>>//DDB/ ExternalSelectionList sl052  sl052.SL
48782>>>>>>>Register_Object sl052
48782>>>>>>>//DDB-SelectionEnd
48782>>>>>>>
48782>>>>>>>Class Drivers_DataDictionary  is a DataDictionary_Sec
48783>>>>>>>
48783>>>>>>>    // Define_Fields:
48783>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48783>>>>>>>
48783>>>>>>>    Procedure Update
48784>>>>>>>        Forward Send Update
48786>>>>>>>        // Insert Code Here
48786>>>>>>>        Move SysCurXR.Company_Code  to drivers.driver_company
48787>>>>>>>
48787>>>>>>>        //betolink
48787>>>>>>>        Move SysCurXR.Beto_Site     to drivers.driver_SiteW
48788>>>>>>>        Move drivers.drivers_Rec0   to drivers.driver_SN
48789>>>>>>>        Move drivers.driver_id      to drivers.driver_repmatch
48790>>>>>>>
48790>>>>>>>    End_Procedure   // Update
48791>>>>>>>
48791>>>>>>>     Procedure Creating
48792>>>>>>>        Forward Send Creating
48794>>>>>>>        date ddate
48795>>>>>>>        sysdate4 ddate
48796>>>>>>>        // Insert Code Here
48796>>>>>>>        Get fsgCode_With_Zeroes drivers.drivers_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to drivers.driver_ID
48797>>>>>>>        move ddate to drivers.driver_hmnia
48798>>>>>>>    End_Procedure   // Creating
48799>>>>>>>
48799>>>>>>>
48799>>>>>>>
48799>>>>>>>
48799>>>>>>>    Procedure Define_Fields
48800>>>>>>>        Forward Send Define_Fields
48802>>>>>>>        //DDB-Generated-Code-Location
48802>>>>>>>        //DDB-DefineFieldStart
48802>>>>>>>
48802>>>>>>>        Set Main_File            To Drivers.File_Number
48803>>>>>>>        Set Cascade_Delete_State To FALSE
48804>>>>>>>
48804>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
48805>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
48806>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48807>>>>>>>
48807>>>>>>>        // External (System) file structure.............
48807>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
48808>>>>>>>
48808>>>>>>>        Define_Auto_Increment  Sysrecc.Drivers_Rec0  To Drivers.Drivers_Rec0
48811>>>>>>>
48811>>>>>>>        // Field-based properties.......................
48811>>>>>>>
48811>>>>>>>        // Drivers.Driver_Recnum
48811>>>>>>>
48811>>>>>>>        // Drivers.Driver_Company
48811>>>>>>>
48811>>>>>>>        // Drivers.Driver_Id
48811>>>>>>>        Set Field_Options          Field Drivers.Driver_Id To DD_AUTOFIND   
48812>>>>>>>        Set Field_Prompt_Object    Field Drivers.Driver_Id To (sl052(Self))
48813>>>>>>>        Set Key_Field_State        Field Drivers.Driver_Id To TRUE
48814>>>>>>>
48814>>>>>>>        // Drivers.Driver_Name
48814>>>>>>>        Set Field_Prompt_Object    Field Drivers.Driver_Name To (sl052(Self))
48815>>>>>>>
48815>>>>>>>        // Drivers.Driver_Doy
48815>>>>>>>        Set Field_Value_Table      Field Drivers.Driver_Doy To (Drivers_Driver_Doy_VT(Self))
48816>>>>>>>
48816>>>>>>>        // Drivers.Driver_Afm
48816>>>>>>>
48816>>>>>>>        // Drivers.Driver_Address
48816>>>>>>>
48816>>>>>>>        // Drivers.Driver_Zipcode
48816>>>>>>>
48816>>>>>>>        // Drivers.Driver_City
48816>>>>>>>
48816>>>>>>>        // Drivers.Driver_Area
48816>>>>>>>
48816>>>>>>>        // Drivers.Driver_Phone
48816>>>>>>>
48816>>>>>>>        // Drivers.Driver_Fax
48816>>>>>>>
48816>>>>>>>        // Drivers.Driver_Mobile
48816>>>>>>>
48816>>>>>>>        // Drivers.Driver_Aoh
48816>>>>>>>
48816>>>>>>>        // Drivers.Driver_Details
48816>>>>>>>
48816>>>>>>>        // Drivers.Driver_Sitew
48816>>>>>>>
48816>>>>>>>        // Drivers.Driver_Sn
48816>>>>>>>
48816>>>>>>>        // Drivers.Driver_Codem
48816>>>>>>>
48816>>>>>>>        // Drivers.Driver_Repmatch
48816>>>>>>>
48816>>>>>>>        // Drivers.Driver_Hmnia
48816>>>>>>>        Set Field_Mask_Type        Field Drivers.Driver_Hmnia To MASK_DATE_WINDOW
48817>>>>>>>
48817>>>>>>>        // Drivers.Drivers_Rec0
48817>>>>>>>
48817>>>>>>>        // Drivers.Driver_Add_No
48817>>>>>>>
48817>>>>>>>        // Drivers.Driver_Nomos
48817>>>>>>>
48817>>>>>>>        // Drivers.Driver_Xora
48817>>>>>>>
48817>>>>>>>        // Drivers.Polh_Recr
48817>>>>>>>
48817>>>>>>>        //DDB-DefineFieldEnd
48817>>>>>>>    End_Procedure    // Define_Fields
48818>>>>>>>
48818>>>>>>>    // Field_Defaults:
48818>>>>>>>    // This procedure is used to establish default field values.
48818>>>>>>>
48818>>>>>>>    Procedure Field_Defaults
48819>>>>>>>        Forward Send Field_Defaults
48821>>>>>>>        //DDB-Generated-Code-Location
48821>>>>>>>        //DDB-FieldDefaultStart
48821>>>>>>>        //DDB-FieldDefaultEnd
48821>>>>>>>    End_Procedure    // Field_Defaults
48822>>>>>>>
48822>>>>>>>End_Class    // Drivers_DataDictionary
48823>>>>>>>//DDB-Selection-pkg-Start
48823>>>>>>>
48823>>>>>>>Use sl052.SL         // sl052
48823>>>>>>>
48823>>>>>>>//DDB-Selection-pkg-End
48823>>>>>>>//DDB-FileEnd
48823>>>>>
48823>>>>>//AB-IgnoreEnd
48823>>>>>
48823>>>>>Object sl052 is a dbModalPanelSub
48825>>>>>    Set Label to "€¨®œå¦ Ž›žšé¤ "
48826>>>>>    Set Size to 148 371
48827>>>>>    Set Location to 4 5
48828>>>>>    Set Exit_Application_Local_State to FALSE
48829>>>>>    Set Modal_State to FALSE
48830>>>>>
48830>>>>>    //AB-DDOStart
48830>>>>>
48830>>>>>    Object Drivers_DD is a Drivers_DataDictionary
48832>>>>>    End_Object    // Drivers_DD
48833>>>>>
48833>>>>>    Set Main_DD to (Drivers_DD(self))
48834>>>>>    Set Server to (Drivers_DD(self))
48835>>>>>
48835>>>>>    //AB-DDOEnd
48835>>>>>
48835>>>>>    Object oSelList is a dbListSub
48837>>>>>        Set Main_File to Drivers.File_Number
48838>>>>>        Set Size to 105 354
48839>>>>>        Set Location to 6 6
48840>>>>>
48840>>>>>        Begin_Row
48843>>>>>            Entry_Item Drivers.Driver_id
48844>>>>>            Entry_Item Drivers.Driver_name
48845>>>>>            Entry_Item Drivers.Driver_afm
48846>>>>>            Entry_Item Drivers.Driver_city
48847>>>>>            Entry_Item Drivers.Driver_phone
48848>>>>>        End_Row
48853>>>>>
48853>>>>>        Set Form_Width    item 0 to 70
48854>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
48855>>>>>        
48855>>>>>        Set Form_Width    item 1 to 100
48856>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
48857>>>>>        
48857>>>>>        Set Form_Width    item 2 to 50
48858>>>>>        Set Header_Label  item 2 to "€.”.‹"
48859>>>>>        
48859>>>>>        Set Form_Width    item 3 to 76
48860>>>>>        Set Header_Label  item 3 to "æ¢ž"
48861>>>>>        
48861>>>>>        Set Form_Width    item 4 to 50
48862>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
48863>>>>>        
48863>>>>>    End_Object    // oSelList
48864>>>>>
48864>>>>>    Object oOK_bn is a ButtonSub
48866>>>>>        Set Label to "&„§ ¢¦šã"
48867>>>>>        Set Location to 114 201
48868>>>>>
48868>>>>>        //AB-StoreStart
48868>>>>>        Procedure OnClick
48870>>>>>            Send OK To (oSelList(current_object))
48871>>>>>        End_Procedure
48872>>>>>        //AB-StoreEnd
48872>>>>>
48872>>>>>    End_Object    // oOK_bn
48873>>>>>
48873>>>>>    Object oCancel_bn is a ButtonSub
48875>>>>>        Set Label to "&€¡ç¨à©ž"
48876>>>>>        Set Location to 114 255
48877>>>>>
48877>>>>>        //AB-StoreStart
48877>>>>>        Procedure OnClick
48879>>>>>            Send Cancel To (oSelList(current_object))
48880>>>>>        End_Procedure
48881>>>>>        //AB-StoreEnd
48881>>>>>
48881>>>>>    End_Object    // oCancel_bn
48882>>>>>
48882>>>>>    Object oSearch_bn is a ButtonSub
48884>>>>>        Set Label to "€&¤˜ã«ž©ž"
48885>>>>>        Set Location to 114 311
48886>>>>>
48886>>>>>        //AB-StoreStart
48886>>>>>        Procedure OnClick
48888>>>>>            Send Search To (oSelList(current_object))
48889>>>>>        End_Procedure
48890>>>>>        //AB-StoreEnd
48890>>>>>
48890>>>>>    End_Object    // oSearch_bn
48891>>>>>
48891>>>>>
48891>>>>>    //AB-StoreStart
48891>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
48892>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
48893>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
48894>>>>>    //AB-StoreEnd
48894>>>>>
48894>>>>>End_Object    // sl052
48895>>>>>
48895>>>>>//AB/ End_Object    // prj
48895>>>Use sl057.sl
48895>>>Use sl058.sl
48895>>>Use sl059.sl
48895>>>Use sl060.sl
INCLUDING FILE: SL060.SL
48895>>>>>//AB/ Project sl060
48895>>>>>//AB/     Object prj is a LOOKUP_Project
48895>>>>>//AB/         Set ProjectName to "sl060"
48895>>>>>//AB/         Set ProjectFileName to "sl060.SL"
48895>>>>>//AB/         Set GenerateFileName to "NONAME"
48895>>>>>
48895>>>>>    //AB-IgnoreStart
48895>>>>>
48895>>>>>
48895>>>>>
48895>>>>>
48895>>>>>    Use ISOTIMIA.DD
INCLUDING FILE: ISOTIMIA.DD
48895>>>>>>>//DDB-FileStart
48895>>>>>>>//DDB-HeaderStart
48895>>>>>>>
48895>>>>>>>// File Name : ISOTIMIA.DD
48895>>>>>>>// Class Name: Isotimia_DataDictionary
48895>>>>>>>// Revision  : 18
48895>>>>>>>// Version   : 2
48895>>>>>>>
48895>>>>>>>Use  Windows           // Basic Definitions
48895>>>>>>>Use  DataDict          // DataDictionary Class Definition
48895>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48895>>>>>>>
48895>>>>>>>Open Isotimia
48897>>>>>>>Open Nomisma
48899>>>>>>>
48899>>>>>>>//DDB-HeaderEnd
48899>>>>>>>//DDB-ValidationStart
48899>>>>>>>
48899>>>>>>>Register_Object Isotimia_Poia_Metatrepei_VT
48899>>>>>>>
48899>>>>>>>Object Isotimia_Poia_Metatrepei_VT  is a DescriptionValidationTable
48901>>>>>>>    Set Allow_Blank_State To TRUE
48902>>>>>>>
48902>>>>>>>    Procedure Fill_List
48904>>>>>>>        Forward Send Fill_List
48906>>>>>>>        Send Add_Table_Value  "€"  "€‚Ž€"
48907>>>>>>>        Send Add_Table_Value  ""  "—Š†‘†"
48908>>>>>>>        Send Add_Table_Value  "F"  "FIXING"
48909>>>>>>>        Send Add_Table_Value  "P"  "PRIVATE"
48910>>>>>>>    End_Procedure    // Fill_List
48911>>>>>>>    //DDB-ValidationCustomStart
48911>>>>>>>    //DDB-ValidationCustomEnd
48911>>>>>>>End_Object   // Isotimia_Poia_Metatrepei_VT
48912>>>>>>>//DDB-ValidationEnd
48912>>>>>>>//DDB-SelectionStart
48912>>>>>>>//DDB/ ExternalSelectionList sl060  sl060.sl
48912>>>>>>>Register_Object sl060
48912>>>>>>>//DDB-SelectionEnd
48912>>>>>>>
48912>>>>>>>Class Isotimia_DataDictionary  is a DataDictionary_Sec
48913>>>>>>>
48913>>>>>>>
48913>>>>>>>    Function Validate_Save  Returns Integer
48914>>>>>>>        Local Integer iReturnVal
48915>>>>>>>        Forward Get Validate_Save  To iReturnVal
48917>>>>>>>        If (Not(iReturnVal)) ;            Begin
48919>>>>>>>                If Isotimia.isotimia_Hmnia eq ''  move 635 to iReturnVal
48922>>>>>>>                if iReturnVal Send Operation_Not_Allowed iReturnVal
48925>>>>>>>            End
48925>>>>>>>>
48925>>>>>>>        Function_Return iReturnVal
48926>>>>>>>    End_Function   // Validate_Save
48927>>>>>>>
48927>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
48928>>>>>>>        if iError_num eq 635 error 635 "ˆ©¦« £åœª => †£œ¨¦£ž¤å˜ ¡œ¤ã "
48931>>>>>>>        else Forward Send Operation_Not_Allowed  iError_Num
48934>>>>>>>    End_Procedure   // Operation_Not_Allowed
48935>>>>>>>
48935>>>>>>>
48935>>>>>>>
48935>>>>>>>    // Creating:
48935>>>>>>>    // This message is sent each time a new record is created in the
48935>>>>>>>    // main file. You should use this to assign field values that
48935>>>>>>>    // apply to the creation of a new record (i.e. assigning a unique ID
48935>>>>>>>    // from a system_file field). Creating is invoked while the database
48935>>>>>>>    // is locked.
48935>>>>>>>
48935>>>>>>>    Procedure Creating
48936>>>>>>>        Forward Send Creating
48938>>>>>>>        // Insert Code Here
48938>>>>>>>        SYSDATE ISOTIMIA.FUP
48939>>>>>>>        Move Nomisma.Kl_Isot_Euro to Isotimia.Isotimia_Euro
48940>>>>>>>    End_Procedure   // Creating
48941>>>>>>>
48941>>>>>>>
48941>>>>>>>    // Update:
48941>>>>>>>    // Use this message to effect changes in related-to files. The
48941>>>>>>>    // Backout message should be designed to reverse the effects of this
48941>>>>>>>    // message. It is invoked while the database is locked.
48941>>>>>>>
48941>>>>>>>    Procedure Update
48942>>>>>>>        Forward Send Update
48944>>>>>>>        // Insert Code Here
48944>>>>>>>        MOVE NOMISMA.NOMISMA_DESCR  TO ISOTIMIA.NOMISMA_DESCR
48945>>>>>>>        MOVE NOMISMA.NOMISMA_SHORT  TO ISOTIMIA.NOMISMA_SHORT
48946>>>>>>>        MOVE NOMISMA.DEKADIKA       TO ISOTIMIA.DEKADIKA
48947>>>>>>>        SYSDATE ISOTIMIA.LUP
48948>>>>>>>    End_Procedure   // Update
48949>>>>>>>
48949>>>>>>>
48949>>>>>>>
48949>>>>>>>
48949>>>>>>>    // Define_Fields:
48949>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48949>>>>>>>
48949>>>>>>>    Procedure Define_Fields
48950>>>>>>>        Forward Send Define_Fields
48952>>>>>>>        //DDB-Generated-Code-Location
48952>>>>>>>        //DDB-DefineFieldStart
48952>>>>>>>
48952>>>>>>>        Set Main_File            To Isotimia.File_Number
48953>>>>>>>        Set Cascade_Delete_State To FALSE
48954>>>>>>>
48954>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
48955>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
48956>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48957>>>>>>>
48957>>>>>>>        // Parent (Server) file structure...............
48957>>>>>>>        Send Add_Server_File  Nomisma.File_Number
48958>>>>>>>
48958>>>>>>>        // Field-based properties.......................
48958>>>>>>>
48958>>>>>>>        // Isotimia.Nomisma_Code
48958>>>>>>>
48958>>>>>>>        // Isotimia.Isotimia_Hmnia
48958>>>>>>>        Set Field_Prompt_Object    Field Isotimia.Isotimia_Hmnia To (sl060(Self))
48959>>>>>>>
48959>>>>>>>        // Isotimia.Isotimia_Agora
48959>>>>>>>
48959>>>>>>>        // Isotimia.Isotimia_Polhsh
48959>>>>>>>
48959>>>>>>>        // Isotimia.Isotimia_Fixing
48959>>>>>>>
48959>>>>>>>        // Isotimia.Isotimia_Privat
48959>>>>>>>
48959>>>>>>>        // Isotimia.Nomisma_Descr
48959>>>>>>>
48959>>>>>>>        // Isotimia.Nomisma_Short
48959>>>>>>>
48959>>>>>>>        // Isotimia.Fup
48959>>>>>>>
48959>>>>>>>        // Isotimia.Lup
48959>>>>>>>
48959>>>>>>>        // Isotimia.Sxolia
48959>>>>>>>
48959>>>>>>>        // Isotimia.Dekadika
48959>>>>>>>
48959>>>>>>>        // Isotimia.Isotimia_Euro
48959>>>>>>>
48959>>>>>>>        // Isotimia.Poia_Metatrepei
48959>>>>>>>        Set Field_Value_Table      Field Isotimia.Poia_Metatrepei To (Isotimia_Poia_Metatrepei_VT(Self))
48960>>>>>>>
48960>>>>>>>        //DDB-DefineFieldEnd
48960>>>>>>>    End_Procedure    // Define_Fields
48961>>>>>>>
48961>>>>>>>    // Field_Defaults:
48961>>>>>>>    // This procedure is used to establish default field values.
48961>>>>>>>
48961>>>>>>>    Procedure Field_Defaults
48962>>>>>>>        Forward Send Field_Defaults
48964>>>>>>>        //DDB-Generated-Code-Location
48964>>>>>>>        //DDB-FieldDefaultStart
48964>>>>>>>        //DDB-FieldDefaultEnd
48964>>>>>>>    End_Procedure    // Field_Defaults
48965>>>>>>>
48965>>>>>>>End_Class    // Isotimia_DataDictionary
48966>>>>>>>//DDB-Selection-pkg-Start
48966>>>>>>>
48966>>>>>>>Use sl060.sl         // sl060
48966>>>>>>>
48966>>>>>>>//DDB-Selection-pkg-End
48966>>>>>>>//DDB-FileEnd
48966>>>>>
48966>>>>>    //AB-IgnoreEnd
48966>>>>>
48966>>>>>    CD_Popup_Object sl060 is a dbModalPanelSub
48985>>>>>
48985>>>>>        //AB-StoreTopStart
48985>>>>>        Property Integer Fragmasl060 Public 0
48987>>>>>
48987>>>>>        //AB-StoreTopEnd
48987>>>>>
48987>>>>>        Set Minimize_Icon to FALSE
48988>>>>>        set label to "ˆ©¦« £åœª" 
48989>>>>>        Set Size to 148 353
48990>>>>>        Set Location to 4 5
48991>>>>>
48991>>>>>        //AB-DDOStart
48991>>>>>
48991>>>>>        Object Isotimia_DD is a Isotimia_DataDictionary
48993>>>>>
48993>>>>>            //AB-StoreTopStart
48993>>>>>
48993>>>>>            //AB-StoreTopEnd
48993>>>>>
48993>>>>>
48993>>>>>            //AB-StoreStart
48993>>>>>            Begin_Constraints
48995>>>>>                Local Integer liNomisma
48996>>>>>                Get Fragmasl060 to liNomisma
48997>>>>>                If liNomisma ne 0 Constrain Isotimia.Nomisma_Code eq liNomisma
49001>>>>>            End_Constraints
49004>>>>>            //AB-StoreEnd
49004>>>>>
49004>>>>>        End_Object    // Isotimia_DD
49005>>>>>
49005>>>>>        Set Main_DD to (Isotimia_DD(Current_Object))
49006>>>>>        Set Server to (Isotimia_DD(Current_Object))
49007>>>>>
49007>>>>>        //AB-DDOEnd
49007>>>>>
49007>>>>>        Object oSelList is a dbListSub
49009>>>>>
49009>>>>>            //AB-StoreTopStart
49009>>>>>
49009>>>>>            //AB-StoreTopEnd
49009>>>>>
49009>>>>>            Set Main_File to Isotimia.File_Number
49010>>>>>            Set Size to 105 337
49011>>>>>            Set Location to 6 6
49012>>>>>
49012>>>>>            Begin_Row
49015>>>>>                Entry_Item Isotimia.Isotimia_hmnia
49016>>>>>                Entry_Item Isotimia.Isotimia_agora
49017>>>>>                Entry_Item Isotimia.Isotimia_polhsh
49018>>>>>                Entry_Item Isotimia.Isotimia_fixing
49019>>>>>                Entry_Item Isotimia.Isotimia_privat
49020>>>>>            End_Row
49025>>>>>
49025>>>>>            Set Form_Width    item 0 to 53
49026>>>>>            set header_label  item 0 to "†£œ¨¦£ž¤å˜" 
49027>>>>>
49027>>>>>            Set Form_Width    item 1 to 66
49028>>>>>            set header_label  item 1 to "€š¦¨á" 
49029>>>>>
49029>>>>>            Set Form_Width    item 2 to 71
49030>>>>>            set header_label  item 2 to "é¢ž©ž" 
49031>>>>>
49031>>>>>            Set Form_Width    item 3 to 70
49032>>>>>            Set Header_Label  item 3 to "Fixing"
49033>>>>>
49033>>>>>            Set Form_Width    item 4 to 70
49034>>>>>            set header_label  item 4 to "¨¦©à§ ¡ã" 
49035>>>>>
49035>>>>>
49035>>>>>            //AB-StoreStart
49035>>>>>            Property Integer StoreFragmasl060 Public 0
49037>>>>>
49037>>>>>
49037>>>>>            Procedure Store_Defaults
49039>>>>>                   Forward Send Store_Defaults
49041>>>>>                   Set StoreFragmasl060 to (Fragmasl060(Self))
49042>>>>>            End_Procedure
49043>>>>>
49043>>>>>            Procedure ReStore_Defaults
49045>>>>>                   Forward Send ReStore_Defaults
49047>>>>>                   Set Fragmasl060 to (StoreFragmasl060(Self))
49048>>>>>            End_Procedure
49049>>>>>
49049>>>>>            Procedure Activating
49051>>>>>               Forward Send Activating
49053>>>>>               Send Rebuild_Constraints to (Isotimia_DD(Self))
49054>>>>>            End_Procedure
49055>>>>>
49055>>>>>            //AB-StoreEnd
49055>>>>>
49055>>>>>        End_Object    // oSelList
49056>>>>>
49056>>>>>        Object oOK_bn is a ButtonSub
49058>>>>>            set label to "&„§ ¢¦šã" 
49059>>>>>            Set Location to 115 183
49060>>>>>
49060>>>>>            //AB-StoreStart
49060>>>>>            Procedure OnClick
49062>>>>>                Send OK To (oSelList(current_object))
49063>>>>>            End_Procedure
49064>>>>>            //AB-StoreEnd
49064>>>>>
49064>>>>>        End_Object    // oOK_bn
49065>>>>>
49065>>>>>        Object oCancel_bn is a ButtonSub
49067>>>>>            set label to "&€¡ç¨à©ž" 
49068>>>>>            Set Location to 115 238
49069>>>>>
49069>>>>>            //AB-StoreStart
49069>>>>>            Procedure OnClick
49071>>>>>                Send Cancel To (oSelList(current_object))
49072>>>>>            End_Procedure
49073>>>>>            //AB-StoreEnd
49073>>>>>
49073>>>>>        End_Object    // oCancel_bn
49074>>>>>
49074>>>>>        Object oSearch_bn is a ButtonSub
49076>>>>>            set label to "€&¤˜ã«ž©ž" 
49077>>>>>            Set Location to 115 293
49078>>>>>
49078>>>>>            //AB-StoreStart
49078>>>>>            Procedure OnClick
49080>>>>>                Send Search To (oSelList(current_object))
49081>>>>>            End_Procedure
49082>>>>>            //AB-StoreEnd
49082>>>>>
49082>>>>>        End_Object    // oSearch_bn
49083>>>>>
49083>>>>>
49083>>>>>        //AB-StoreStart
49083>>>>>
49083>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49084>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49085>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49086>>>>>        //AB-StoreEnd
49086>>>>>
49086>>>>>    CD_End_Object    // sl060
49088>>>>>>
49088>>>>>
49088>>>>>//AB/     End_Object    // prj
49088>>>Use sl94_1.sl
INCLUDING FILE: SL94_1.SL
49088>>>>>//AB/ Project sl94_1:paraggelies Prom
49088>>>>>//AB/     Object prj is a Lookup_Project
49088>>>>>//AB/         Set ProjectName to "sl94_1:paraggelies Prom"
49088>>>>>//AB/         Set ProjectFileName to "sl94_1.SL"
49088>>>>>
49088>>>>>// Project Object Structure
49088>>>>>//   sl94_1 is a dbModalPanelSub
49088>>>>>//     Country_DD is a DataDictionary
49088>>>>>//     Towns_DD is a DataDictionary
49088>>>>>//     Cities_DD is a DataDictionary
49088>>>>>//     Payresp_DD is a DataDictionary
49088>>>>>//     Areas_DD is a DataDictionary
49088>>>>>//     Clients_DD is a DataDictionary
49088>>>>>//     Clorder_DD is a DataDictionary
49088>>>>>//     oSelList is a dbList
49088>>>>>//     oOK_bn is a ButtonSub
49088>>>>>//     oCancel_bn is a ButtonSub
49088>>>>>//     oSearch_bn is a ButtonSub
49088>>>>>
49088>>>>>// Register all objects
49088>>>>>Register_Object Areas_DD
49088>>>>>Register_Object Cities_DD
49088>>>>>Register_Object Clients_DD
49088>>>>>Register_Object Clorder_DD
49088>>>>>Register_Object Country_DD
49088>>>>>Register_Object oCancel_bn
49088>>>>>Register_Object oOK_bn
49088>>>>>Register_Object oSearch_bn
49088>>>>>Register_Object oSelList
49088>>>>>Register_Object Payresp_DD
49088>>>>>Register_Object sl94_1
49088>>>>>Register_Object Towns_DD
49088>>>>>
49088>>>>>
49088>>>>>
49088>>>>>    //AB-StoreTopStart
49088>>>>>    open nomisma
49090>>>>>    //AB-StoreTopEnd
49090>>>>>
49090>>>>>    //AB-IgnoreStart
49090>>>>>
49090>>>>>    Use DFAllEnt.pkg
49090>>>>>    Use Button.Sub
49090>>>>>
49090>>>>>
49090>>>>>    Use COUNTRY.DD
49090>>>>>    Use TOWNS.DD
49090>>>>>    Use CITIES.DD
49090>>>>>    Use PAYRESP.DD
49090>>>>>    Use AREAS.DD
49090>>>>>    Use CLIENTS.DD
49090>>>>>    Use CLORDER.DD
INCLUDING FILE: CLORDER.DD
49090>>>>>>>//DDB-FileStart
49090>>>>>>>//DDB-HeaderStart
49090>>>>>>>
49090>>>>>>>// File Name : CLORDER.DD
49090>>>>>>>// Class Name: Clorder_DataDictionary
49090>>>>>>>// Revision  : 34
49090>>>>>>>// Version   : 2
49090>>>>>>>
49090>>>>>>>Use  Windows           // Basic Definitions
49090>>>>>>>Use  DataDict          // DataDictionary Class Definition
49090>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49090>>>>>>>
49090>>>>>>>Open Clorder
49092>>>>>>>Open Clorderd
49094>>>>>>>Open Clients
49096>>>>>>>Open Sysrecc
49098>>>>>>>Open Codetype
INCLUDING FILE: CODETYPE.FD
49100>>>>>>>
49100>>>>>>>//DDB-HeaderEnd
49100>>>>>>>//DDB-ValidationStart
49100>>>>>>>
49100>>>>>>>Register_Object Clorder_Tropos_VT
49100>>>>>>>Register_Object Clorder_How_Pay_VT
49100>>>>>>>
49100>>>>>>>Object Clorder_Tropos_VT  is a CodeValidationTable
49102>>>>>>>    Set Type_Value        To "SEND_TERMS"
49103>>>>>>>    Set Validate_State    To FALSE
49104>>>>>>>    Set Allow_Blank_State To TRUE
49105>>>>>>>    Set Table_Title       To "’¨æ§¦  ˜¨á›¦©žª"
49106>>>>>>>    //DDB-ValidationCustomStart
49106>>>>>>>    //DDB-ValidationCustomEnd
49106>>>>>>>End_Object   // Clorder_Tropos_VT
49107>>>>>>>
49107>>>>>>>Object Clorder_How_Pay_VT  is a CodeValidationTable
49109>>>>>>>    Set Type_Value        To "PAY_TERMS"
49110>>>>>>>    Set Validate_State    To FALSE
49111>>>>>>>    Set Allow_Blank_State To TRUE
49112>>>>>>>    Set Table_Title       To "’¨æ§¦  ¢ž¨à£ãª"
49113>>>>>>>    //DDB-ValidationCustomStart
49113>>>>>>>    //DDB-ValidationCustomEnd
49113>>>>>>>End_Object   // Clorder_How_Pay_VT
49114>>>>>>>//DDB-ValidationEnd
49114>>>>>>>//DDB-SelectionStart
49114>>>>>>>//DDB/ ExternalSelectionList slNomism  slnomism.sl
49114>>>>>>>Register_Object slNomism
49114>>>>>>>//DDB-SelectionEnd
49114>>>>>>>  
49114>>>>>>>Class Clorder_DataDictionary  is a DataDictionary_Sec
49115>>>>>>>
49115>>>>>>>    // Define_Fields:
49115>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49115>>>>>>>
49115>>>>>>>    Procedure Define_Fields
49116>>>>>>>        Forward Send Define_Fields
49118>>>>>>>        //DDB-Generated-Code-Location
49118>>>>>>>        //DDB-DefineFieldStart
49118>>>>>>>
49118>>>>>>>        Set Main_File            To Clorder.File_Number
49119>>>>>>>        Set Cascade_Delete_State To FALSE
49120>>>>>>>
49120>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49121>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49122>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49123>>>>>>>
49123>>>>>>>        // Child (Client) file structure................
49123>>>>>>>        Send Add_Client_File  Clorderd.File_Number
49124>>>>>>>
49124>>>>>>>        // Parent (Server) file structure...............
49124>>>>>>>        Send Add_Server_File  Clients.File_Number
49125>>>>>>>
49125>>>>>>>        // External (System) file structure.............
49125>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
49126>>>>>>>        Send Add_System_File  Codetype.File_Number  DD_LOCK_ON_ALL
49127>>>>>>>
49127>>>>>>>        // Field-based properties.......................
49127>>>>>>>
49127>>>>>>>        // Clorder.Company_Code
49127>>>>>>>
49127>>>>>>>        // Clorder.Branch_Code
49127>>>>>>>
49127>>>>>>>        // Clorder.Year_Year
49127>>>>>>>
49127>>>>>>>        // Clorder.Aapar
49127>>>>>>>
49127>>>>>>>        // Clorder.Clients_Code
49127>>>>>>>
49127>>>>>>>        // Clorder.Armod
49127>>>>>>>
49127>>>>>>>        // Clorder.Order1_Recr
49127>>>>>>>
49127>>>>>>>        // Clorder.Rec0
49127>>>>>>>
49127>>>>>>>        // Clorder.Recr
49127>>>>>>>
49127>>>>>>>        // Clorder.Our_Date
49127>>>>>>>        Set Field_Mask_Type        Field Clorder.Our_Date To MASK_DATE_WINDOW
49128>>>>>>>
49128>>>>>>>        // Clorder.Rial_Date
49128>>>>>>>        Set Field_Mask_Type        Field Clorder.Rial_Date To MASK_DATE_WINDOW
49129>>>>>>>
49129>>>>>>>        // Clorder.Qty
49129>>>>>>>
49129>>>>>>>        // Clorder.Unitprice
49129>>>>>>>
49129>>>>>>>        // Clorder.Disc
49129>>>>>>>
49129>>>>>>>        // Clorder.Fpa
49129>>>>>>>
49129>>>>>>>        // Clorder.Net
49129>>>>>>>
49129>>>>>>>        // Clorder.Extra
49129>>>>>>>
49129>>>>>>>        // Clorder.Total
49129>>>>>>>
49129>>>>>>>        // Clorder.Aaparprom
49129>>>>>>>
49129>>>>>>>        // Clorder.Tropos
49129>>>>>>>        Set Field_Value_Table      Field Clorder.Tropos To (Clorder_Tropos_VT(Self))
49130>>>>>>>
49130>>>>>>>        // Clorder.Date
49130>>>>>>>        Set Field_Entry_msg        Field Clorder.Date To Entry_clorder_date
49131>>>>>>>        Set Field_Mask_Type        Field Clorder.Date To MASK_DATE_WINDOW
49132>>>>>>>
49132>>>>>>>        // Clorder.How_Pay
49132>>>>>>>        Set Field_Value_Table      Field Clorder.How_Pay To (Clorder_How_Pay_VT(Self))
49133>>>>>>>
49133>>>>>>>        // Clorder.Finish
49133>>>>>>>        Set Field_Mask             Field Clorder.Finish To "#"
49134>>>>>>>        Set Field_Mask_Type        Field Clorder.Finish To MASK_NUMERIC_WINDOW
49135>>>>>>>
49135>>>>>>>        // Clorder.Okey
49135>>>>>>>        Set Field_Mask             Field Clorder.Okey To "#"
49136>>>>>>>        Set Field_Mask_Type        Field Clorder.Okey To MASK_NUMERIC_WINDOW
49137>>>>>>>
49137>>>>>>>        // Clorder.Akyrh
49137>>>>>>>        Set Field_Mask             Field Clorder.Akyrh To "#"
49138>>>>>>>        Set Field_Mask_Type        Field Clorder.Akyrh To MASK_NUMERIC_WINDOW
49139>>>>>>>
49139>>>>>>>        // Clorder.Sxolia
49139>>>>>>>
49139>>>>>>>        // Clorder.Posodtl
49139>>>>>>>
49139>>>>>>>        // Clorder.Qtydtl
49139>>>>>>>
49139>>>>>>>        // Clorder.Nomisma
49139>>>>>>>        Set Field_Prompt_Object    Field Clorder.Nomisma To (slNomism(Self))
49140>>>>>>>
49140>>>>>>>        // Clorder.Module
49140>>>>>>>
49140>>>>>>>        // Clorder.Codetype
49140>>>>>>>
49140>>>>>>>        //DDB-DefineFieldEnd
49140>>>>>>>    End_Procedure    // Define_Fields
49141>>>>>>>
49141>>>>>>>     Procedure Update
49142>>>>>>>        Forward Send Update
49144>>>>>>>        move syscurxr.company_code to clorder.company_code
49145>>>>>>>        move syscurxr.branch_code  to clorder.branch_code
49146>>>>>>>        move syscurxr.year_year    to clorder.year_year
49147>>>>>>>        MOVE CODETYPE.TYPE         to clorder.codetype
49148>>>>>>>        // Insert Code Here
49148>>>>>>>    End_Procedure   // Update
49149>>>>>>>
49149>>>>>>>
49149>>>>>>>
49149>>>>>>>
49149>>>>>>>    Procedure Creating
49150>>>>>>>        if (clorder.module <> '01') move '02' to clorder.module
49153>>>>>>>        if (clorder.module = '01') begin
49155>>>>>>>           move (sysrecc.clorderc_rec0 + 1) to clorder.rec0
49156>>>>>>>           move clorder.rec0 to sysrecc.clorderc_rec0
49157>>>>>>>           saverecord sysrecc
49158>>>>>>>        end
49158>>>>>>>>
49158>>>>>>>        else begin
49159>>>>>>>           move (sysrecc.clorder_rec0 + 1) to clorder.rec0
49160>>>>>>>           move clorder.rec0 to sysrecc.clorder_rec0
49161>>>>>>>           saverecord sysrecc
49162>>>>>>>        end
49162>>>>>>>>
49162>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                         (Trim(String(clorder.rec0)))))) to clorder.recr
49163>>>>>>>        Move clorder.recr to clorder.aapar
49164>>>>>>>        move clorder.date to clients.last_order
49165>>>>>>>    End_Procedure   //
49166>>>>>>>    // Field_Defaults:
49166>>>>>>>    // This procedure is used to establish default field values.
49166>>>>>>>
49166>>>>>>>     Procedure Entry_clorder_date Integer iField Date dDate
49167>>>>>>>         Local Integer Changed
49168>>>>>>>         Get Field_Changed_State iField to Changed
49169>>>>>>>         If ( Changed=0 AND dDate = 0) Begin
49171>>>>>>>           SysDate4 dDate
49172>>>>>>>           Set Field_Default_Value iField to dDate
49173>>>>>>>         End
49173>>>>>>>>
49173>>>>>>>    End_Procedure
49174>>>>>>>
49174>>>>>>>
49174>>>>>>>    Procedure Field_Defaults
49175>>>>>>>        Forward Send Field_Defaults
49177>>>>>>>        //DDB-Generated-Code-Location
49177>>>>>>>        //DDB-FieldDefaultStart
49177>>>>>>>        //DDB-FieldDefaultEnd
49177>>>>>>>    End_Procedure    // Field_Defaults
49178>>>>>>>
49178>>>>>>>End_Class    // Clorder_DataDictionary
49179>>>>>>>//DDB-Selection-pkg-Start
49179>>>>>>>
49179>>>>>>>Use slnomism.sl      // slNomism
49179>>>>>>>
49179>>>>>>>//DDB-Selection-pkg-End
49179>>>>>>>//DDB-FileEnd
49179>>>>>
49179>>>>>    //AB-IgnoreEnd
49179>>>>>
49179>>>>>    Object sl94_1 is a dbModalPanelSub
49181>>>>>
49181>>>>>        //AB-StoreTopStart
49181>>>>>        property string psmodule public ''
49183>>>>>        property string psclient public ''
49185>>>>>        //AB-StoreTopEnd
49185>>>>>
49185>>>>>        Set Label to "˜¨˜ššœ¢åœª €¤á ¨¦£žŸœ¬«ã"
49186>>>>>        Set Size to 239 506
49187>>>>>        Set Location to 4 5
49188>>>>>        Set Exit_Application_Local_State to FALSE
49189>>>>>        Set Modal_State to FALSE
49190>>>>>
49190>>>>>        //AB-DDOStart
49190>>>>>
49190>>>>>        Object Country_DD is a Country_DataDictionary
49192>>>>>        End_Object    // Country_DD
49193>>>>>
49193>>>>>        Object Towns_DD is a Towns_DataDictionary
49195>>>>>            Set DDO_Server to (Country_DD(self))
49196>>>>>        End_Object    // Towns_DD
49197>>>>>
49197>>>>>        Object Cities_DD is a Cities_DataDictionary
49199>>>>>            Set DDO_Server to (Towns_DD(self))
49200>>>>>        End_Object    // Cities_DD
49201>>>>>
49201>>>>>        Object Payresp_DD is a Payresp_DataDictionary
49203>>>>>        End_Object    // Payresp_DD
49204>>>>>
49204>>>>>        Object Areas_DD is a Areas_DataDictionary
49206>>>>>        End_Object    // Areas_DD
49207>>>>>
49207>>>>>        Object Clients_DD is a Clients_DataDictionary
49209>>>>>            Set DDO_Server to (Cities_DD(self))
49210>>>>>            Set DDO_Server to (Payresp_DD(self))
49211>>>>>            Set DDO_Server to (Areas_DD(self))
49212>>>>>        End_Object    // Clients_DD
49213>>>>>
49213>>>>>        Object Clorder_DD is a Clorder_DataDictionary
49215>>>>>            Set DDO_Server to (Clients_DD(self))
49216>>>>>
49216>>>>>            //AB-StoreStart
49216>>>>>            Procedure OnConstrain
49218>>>>>                Constrain clorder.company_code  eq SysCurXR.Company_Code
49220>>>>>                Constrain clorder.Branch_Code   eq SysCurXR.Branch_Code
49222>>>>>                Constrain clorder.Year_Year     eq SysCurXR.Year_Year
49224>>>>>
49224>>>>>                If (psModule(Self)<>'') Begin
49226>>>>>                    Constrain clorder.Module eq (psModule(Self))
49228>>>>>                End
49228>>>>>>
49228>>>>>                If (psclient(Self)<>'') Begin
49230>>>>>                    Constrain clorder.clients_code eq (psclient(Self))
49232>>>>>                End
49232>>>>>>
49232>>>>>            End_Procedure
49233>>>>>
49233>>>>>
49233>>>>>
49233>>>>>
49233>>>>>
49233>>>>>
49233>>>>>
49233>>>>>
49233>>>>>
49233>>>>>
49233>>>>>
49233>>>>>
49233>>>>>
49233>>>>>
49233>>>>>
49233>>>>>
49233>>>>>
49233>>>>>            //AB-StoreEnd
49233>>>>>
49233>>>>>        End_Object    // Clorder_DD
49234>>>>>
49234>>>>>        Set Main_DD to (Clorder_DD(self))
49235>>>>>        Set Server to (Clorder_DD(self))
49236>>>>>
49236>>>>>        //AB-DDOEnd
49236>>>>>
49236>>>>>        Object oSelList is a dbListsub
49238>>>>>            Set Main_File to Clorder.File_Number
49239>>>>>            Set Ordering to 1
49240>>>>>            Set Size to 199 493
49241>>>>>            Set Location to 6 6
49242>>>>>            Set Color to 14280447
49243>>>>>            Set CurrentRowColor to 11783679
49244>>>>>            Set CurrentCellColor to 11783679
49245>>>>>
49245>>>>>            Begin_Row
49248>>>>>                Entry_Item Clorder.Aapar
49249>>>>>                Entry_Item Clients.Client_name
49250>>>>>                Entry_Item Clorder.Date
49251>>>>>                Entry_Item Clorder.Armod
49252>>>>>                Entry_Item Clorder.Nomisma
49253>>>>>                Entry_Item Clorder.Total
49254>>>>>                Entry_Item Clorder.Finish
49255>>>>>                Entry_Item Clorder.Okey
49256>>>>>                Entry_Item Clorder.Akyrh
49257>>>>>                Entry_Item Clorder.Rial_date
49258>>>>>            End_Row
49263>>>>>
49263>>>>>            Set Form_Width    item 0 to 52
49264>>>>>            Set Header_Label  item 0 to "€/˜ ˜¨˜šš."
49265>>>>>
49265>>>>>            Set Form_Width    item 1 to 87
49266>>>>>            Set Header_Label  item 1 to ""
49267>>>>>
49267>>>>>            Set Form_Width    item 2 to 45
49268>>>>>            Set Header_Label  item 2 to "†£/¤å˜ "
49269>>>>>
49269>>>>>            Set Form_Width    item 3 to 82
49270>>>>>            Set Header_Label  item 3 to "“§œçŸ¬¤¦ª ‘ç¤«˜¥žª"
49271>>>>>
49271>>>>>            Set Form_Width    item 4 to 30
49272>>>>>            Set Header_Label  item 4 to "Œæ£"
49273>>>>>
49273>>>>>            Set Form_Width    item 5 to 69
49274>>>>>            Set Header_Label  item 5 to "‘ç¤.˜¨˜ššœ¢å˜ª"
49275>>>>>
49275>>>>>            Set Form_Width    item 6 to 17
49276>>>>>            Set Header_Label  item 6 to "Ž‰"
49277>>>>>            Set Column_Checkbox_State  item 6 to True
49278>>>>>
49278>>>>>            Set Form_Width    item 7 to 33
49279>>>>>            Set Header_Label  item 7 to "„§ ™œ™."
49280>>>>>            Set Column_Checkbox_State  item 7 to True
49281>>>>>
49281>>>>>            Set Form_Width    item 8 to 30
49282>>>>>            Set Header_Label  item 8 to "€¡¬¨ž"
49283>>>>>            Set Column_Checkbox_State  item 8 to True
49284>>>>>
49284>>>>>            Set Form_Width    item 9 to 43
49285>>>>>            Set Header_Label  item 9 to "œ¨˜ àŸ."
49286>>>>>
49286>>>>>
49286>>>>>            //AB-StoreStart
49286>>>>>            Set Points          Item 5 to       2
49287>>>>>            Set Numeric_Mask    Item 5 to 14    2 ' ,*'
49288>>>>>            set ordering to 1
49289>>>>>            Property String Store_Fragma_prom public ""
49291>>>>>            //
49291>>>>>            Procedure Store_Defaults
49293>>>>>               forward send Store_Defaults
49295>>>>>               Set Store_Fragma_prom to (psclient(Self))
49296>>>>>            end_Procedure
49297>>>>>            //
49297>>>>>            Procedure Restore_Defaults
49299>>>>>                forward send Restore_Defaults
49301>>>>>                Set psclient to (Store_Fragma_prom(Self))
49302>>>>>            end_Procedure
49303>>>>>            //
49303>>>>>            
49303>>>>>            
49303>>>>>            
49303>>>>>            Procedure Activating Returns Integer
49305>>>>>                Integer rVal
49306>>>>>                Forward Get Msg_Activating to rVal
49308>>>>>                     if (psmodule(self)='01') set label of sl100 to '‰˜«á¢¦š¦ª œ¢˜«é¤'
49311>>>>>                else if (psmodule(self)='02') set label of sl100 to '‰˜«á¢¦š¦ª ¨¦£žŸœ¬«é¤'
49315>>>>>                Send Rebuild_Constraints to Clorder_DD
49316>>>>>              //  Send Beginning_Of_Data to oSelList True
49316>>>>>                Procedure_Return rVal
49317>>>>>            End_procedure
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            
49318>>>>>            //AB-StoreEnd
49318>>>>>
49318>>>>>        End_Object    // oSelList
49319>>>>>
49319>>>>>        Object oOK_bn is a ButtonSub
49321>>>>>            Set Label to "€§¦›¦®ã"
49322>>>>>            Set Location to 209 334
49323>>>>>
49323>>>>>            //AB-StoreStart
49323>>>>>            Procedure OnClick
49325>>>>>                Send OK To (oSelList(current_object))
49326>>>>>            End_Procedure
49327>>>>>            //AB-StoreEnd
49327>>>>>
49327>>>>>        End_Object    // oOK_bn
49328>>>>>
49328>>>>>        Object oCancel_bn is a ButtonSub
49330>>>>>            Set Label to "€¡ç¨à©ž"
49331>>>>>            Set Location to 209 388
49332>>>>>
49332>>>>>            //AB-StoreStart
49332>>>>>            Procedure OnClick
49334>>>>>                Send Cancel To (oSelList(current_object))
49335>>>>>            End_Procedure
49336>>>>>            //AB-StoreEnd
49336>>>>>
49336>>>>>        End_Object    // oCancel_bn
49337>>>>>
49337>>>>>        Object oSearch_bn is a ButtonSub
49339>>>>>            Set Label to "€¤˜ã«ž©ž"
49340>>>>>            Set Location to 209 444
49341>>>>>
49341>>>>>            //AB-StoreStart
49341>>>>>            Procedure OnClick
49343>>>>>                Send Search To (oSelList(current_object))
49344>>>>>            End_Procedure
49345>>>>>            //AB-StoreEnd
49345>>>>>
49345>>>>>        End_Object    // oSearch_bn
49346>>>>>
49346>>>>>
49346>>>>>        //AB-StoreStart
49346>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49347>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49348>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49349>>>>>        procedure page integer pagemode
49351>>>>>            forward send page pagemode
49353>>>>>            set location to 40,40
49354>>>>>        end_procedure
49355>>>>>        Procedure Activating returns integer
49357>>>>>            string smodule
49358>>>>>            integer rval
49358>>>>>            get psmodule to smodule
49359>>>>>            if (sModule='01') set header_label  of (osellist(self)) item 1 to 'œ¢á«žª'
49362>>>>>            else              set header_label  of (osellist(self)) item 1 to '¨¦£žŸœ¬«ãª'
49364>>>>>            if (sModule='01') set label of sl94_1 to '˜¨˜ššœ¢åœª / œ¢á«ž'
49367>>>>>            else              set label of sl94_1 to '˜¨˜ššœ¢åœª / ¨¦£žŸœ¬«ã'
49369>>>>>            Send Rebuild_Constraints to clorder_DD
49370>>>>>            Send Beginning_Of_Data to oSelList True
49371>>>>>            Procedure_Return rVal
49372>>>>>        
49372>>>>>        End_Procedure
49373>>>>>        
49373>>>>>        
49373>>>>>        
49373>>>>>        
49373>>>>>        
49373>>>>>        
49373>>>>>        
49373>>>>>        
49373>>>>>        
49373>>>>>        
49373>>>>>        
49373>>>>>        
49373>>>>>        
49373>>>>>        
49373>>>>>        
49373>>>>>        //AB-StoreEnd
49373>>>>>
49373>>>>>    End_Object    // sl94_1
49374>>>>>
49374>>>>>
49374>>>>>    //AB-StoreStart
49374>>>>>                            
49374>>>>>                            
49374>>>>>                            
49374>>>>>    //AB-StoreEnd
49374>>>>>
49374>>>>>//AB/     End_Object    // prj
49374>>>Use sl100.sl
49374>>>use sl108.sl
49374>>>use sl182.sl
INCLUDING FILE: SL182.SL
49374>>>>>//AB/ Project sl182:diakiniseis eidon
49374>>>>>//AB/     Object prj is a Lookup_Project
49374>>>>>//AB/         Set ProjectName to "sl182:diakiniseis eidon"
49374>>>>>//AB/         Set ProjectFileName to "sl182.SL"
49374>>>>>//AB/         Set GenerateFileName to "NONAME"
49374>>>>>
49374>>>>>// Project Object Structure
49374>>>>>//   sl182 is a dbModalPanelSub
49374>>>>>//     Witemxtr_DD is a DataDictionary
49374>>>>>//     Witemxtd_DD is a DataDictionary
49374>>>>>//     oSelList is a dbListSub
49374>>>>>//     oOK_bn is a ButtonSub
49374>>>>>//     oCancel_bn is a ButtonSub
49374>>>>>//     oSearch_bn is a ButtonSub
49374>>>>>
49374>>>>>// Register all objects
49374>>>>>Register_Object oCancel_bn
49374>>>>>Register_Object oOK_bn
49374>>>>>Register_Object oSearch_bn
49374>>>>>Register_Object oSelList
49374>>>>>Register_Object sl182
49374>>>>>Register_Object Witemxtd_DD
49374>>>>>Register_Object Witemxtr_DD
49374>>>>>
49374>>>>>
49374>>>>>
49374>>>>>    //AB-StoreTopStart
49374>>>>>    open wax
49376>>>>>    //AB-StoreTopEnd
49376>>>>>
49376>>>>>    //AB-IgnoreStart
49376>>>>>
49376>>>>>    Use DFAllEnt.pkg
49376>>>>>    Use dbList.Sub
49376>>>>>    Use Button.Sub
49376>>>>>
49376>>>>>
49376>>>>>    Use WITEMXTR.DD
INCLUDING FILE: WITEMXTR.DD
49376>>>>>>>//DDB-FileStart
49376>>>>>>>//DDB-HeaderStart
49376>>>>>>>
49376>>>>>>>// File Name : WITEMXTR.DD
49376>>>>>>>// Class Name: Witemxtr_DataDictionary
49376>>>>>>>// Revision  : 28
49376>>>>>>>// Version   : 2
49376>>>>>>>
49376>>>>>>>Use  Windows           // Basic Definitions
49376>>>>>>>Use  DataDict          // DataDictionary Class Definition
49376>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49376>>>>>>>
49376>>>>>>>Open Witemxtr
INCLUDING FILE: WITEMXTR.FD
49378>>>>>>>Open Witemxtd
INCLUDING FILE: WITEMXTD.FD
49380>>>>>>>Open Sysrecw
49382>>>>>>>Open Branch
49384>>>>>>>
49384>>>>>>>//DDB-HeaderEnd
49384>>>>>>>//DDB-SelectionStart
49384>>>>>>>//DDB/ ExternalSelectionList sl182  sl182.SL
49384>>>>>>>//DDB/ ExternalSelectionList sl029a  sl029a.sl
49384>>>>>>>Register_Object sl182
49384>>>>>>>Register_Object sl029a
49384>>>>>>>//DDB-SelectionEnd
49384>>>>>>>
49384>>>>>>>Class Witemxtr_DataDictionary  is a DataDictionary_sec
49385>>>>>>>
49385>>>>>>>    // Define_Fields:
49385>>>>>>>    // This procedure is used to set up all data-dictionary rules. 
49385>>>>>>>    
49385>>>>>>>    Procedure Construct_Object
49386>>>>>>>        Forward Send Construct_Object
49388>>>>>>>        Property Integer piMustNOTConstrain Public 0
49389>>>>>>>    End_Procedure //construct_object
49390>>>>>>>
49390>>>>>>>    Procedure OnConstrain
49391>>>>>>>        Forward Send OnConstrain
49393>>>>>>>        Constrain Witemxtr.Company_Code  eq SysCurXR.Company_Code
49395>>>>>>>        Constrain Witemxtr.Branch_Code   eq SysCurXR.Branch_Code
49397>>>>>>>        Constrain Witemxtr.Year_Year     eq SysCurXR.Year_Year
49399>>>>>>>    End_Procedure
49400>>>>>>>
49400>>>>>>>    // Update:
49400>>>>>>>    Procedure Update
49401>>>>>>>        Forward Send Update
49403>>>>>>>        // Insert Code Here
49403>>>>>>>        Move SysCurXR.Company_Code  to Witemxtr.Company_Code
49404>>>>>>>        Move SysCurXR.Branch_Code   to Witemxtr.Branch_Code
49405>>>>>>>        Move SysCurXR.Year_Year     to Witemxtr.Year_Year
49406>>>>>>>    End_Procedure   // Update
49407>>>>>>>
49407>>>>>>>    Procedure Creating
49408>>>>>>>        Forward Send Creating 
49410>>>>>>>        integer idecs 
49411>>>>>>>        string srecr sentolh
49411>>>>>>>        clear branch
49412>>>>>>>        move syscurxr.company_code to branch.company_code
49413>>>>>>>        move syscurxr.branch_code  to branch.branch_code
49414>>>>>>>        find eq branch by index.1 
49415>>>>>>>>
49415>>>>>>>        move (branch.entolh + 1) to branch.entolh
49416>>>>>>>        saverecord branch  
49417>>>>>>>        move branch.entolh to sentolh
49418>>>>>>>        move 5 to idecs
49419>>>>>>>        get fsgCode_n_Zeroes sentolh idecs to srecr
49420>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(srecr)))))) to Witemxtr.Recr
49421>>>>>>>        Move (append('','„¤›¦› ˜¡.œ ›é¤ €¨.§˜¨˜©«. ' +(trim(Witemxtr.RecR)))) to witemxtr.descr 
49422>>>>>>>    End_Procedure   // Creating    
49423>>>>>>>     
49423>>>>>>>    Procedure Shmera integer iField  Date dDate
49424>>>>>>>        Local Integer Changed
49425>>>>>>>        Get Field_Changed_State iField to Changed
49426>>>>>>>        If (Changed=0 AND dDate =0) Begin
49428>>>>>>>            SysDate4 dDate
49429>>>>>>>            Set Field_Default_Value iField to dDate
49430>>>>>>>        End
49430>>>>>>>>
49430>>>>>>>    End_Procedure   // Shmera
49431>>>>>>>
49431>>>>>>>    // Define_Fields:
49431>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49431>>>>>>>
49431>>>>>>>    Procedure Define_Fields
49432>>>>>>>        Forward Send Define_Fields
49434>>>>>>>        //DDB-Generated-Code-Location
49434>>>>>>>        //DDB-DefineFieldStart
49434>>>>>>>
49434>>>>>>>        Set Main_File            To Witemxtr.File_Number
49435>>>>>>>        Set Cascade_Delete_State To FALSE
49436>>>>>>>
49436>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49437>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49438>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49439>>>>>>>
49439>>>>>>>        // Child (Client) file structure................
49439>>>>>>>        Send Add_Client_File  Witemxtd.File_Number
49440>>>>>>>
49440>>>>>>>        // External (System) file structure.............
49440>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
49441>>>>>>>        Send Add_System_File  Branch.File_Number  DD_LOCK_ON_ALL
49442>>>>>>>
49442>>>>>>>        Define_Auto_Increment  Sysrecw.Witemxtr_Rec0  To Witemxtr.Rec0
49445>>>>>>>
49445>>>>>>>        // Field-based properties.......................
49445>>>>>>>
49445>>>>>>>        // Witemxtr.Company_Code
49445>>>>>>>
49445>>>>>>>        // Witemxtr.Branch_Code
49445>>>>>>>
49445>>>>>>>        // Witemxtr.Year_Year
49445>>>>>>>
49445>>>>>>>        // Witemxtr.Code
49445>>>>>>>        Set Field_Options          Field Witemxtr.Code To DD_AUTOFIND   
49446>>>>>>>        Set Key_Field_State        Field Witemxtr.Code To TRUE
49447>>>>>>>
49447>>>>>>>        // Witemxtr.Recr
49447>>>>>>>
49447>>>>>>>        // Witemxtr.Rec0
49447>>>>>>>
49447>>>>>>>        // Witemxtr.Hmnia
49447>>>>>>>        Set Field_Entry_msg        Field Witemxtr.Hmnia To Shmera
49448>>>>>>>        Set Field_Mask_Type        Field Witemxtr.Hmnia To MASK_DATE_WINDOW
49449>>>>>>>        Set Field_Prompt_Object    Field Witemxtr.Hmnia To (sl182(Self))
49450>>>>>>>
49450>>>>>>>        // Witemxtr.Descr
49450>>>>>>>
49450>>>>>>>        // Witemxtr.Wax_From
49450>>>>>>>
49450>>>>>>>        // Witemxtr.Wax_To
49450>>>>>>>
49450>>>>>>>        // Witemxtr.Ekleise
49450>>>>>>>
49450>>>>>>>        // Witemxtr.Qty
49450>>>>>>>
49450>>>>>>>        // Witemxtr.Fpa
49450>>>>>>>
49450>>>>>>>        // Witemxtr.Axia
49450>>>>>>>
49450>>>>>>>        // Witemxtr.Total
49450>>>>>>>
49450>>>>>>>        // Witemxtr.Wtypkin_From
49450>>>>>>>        Set Field_Prompt_Object    Field Witemxtr.Wtypkin_From To (sl029a(Self))
49451>>>>>>>
49451>>>>>>>        // Witemxtr.Wtypkin_To
49451>>>>>>>        Set Field_Prompt_Object    Field Witemxtr.Wtypkin_To To (sl029a(Self))
49452>>>>>>>
49452>>>>>>>        // Witemxtr.From_No
49452>>>>>>>
49452>>>>>>>        // Witemxtr.To_No
49452>>>>>>>
49452>>>>>>>        // Witemxtr.Particle_Recr
49452>>>>>>>
49452>>>>>>>        //DDB-DefineFieldEnd
49452>>>>>>>    End_Procedure    // Define_Fields
49453>>>>>>>
49453>>>>>>>    // Field_Defaults:
49453>>>>>>>    // This procedure is used to establish default field values.
49453>>>>>>>
49453>>>>>>>    Procedure Field_Defaults
49454>>>>>>>        Forward Send Field_Defaults
49456>>>>>>>        //DDB-Generated-Code-Location
49456>>>>>>>        //DDB-FieldDefaultStart
49456>>>>>>>        Set Field_Changed_Value   Field Witemxtr.From_No To "1"
49457>>>>>>>        //DDB-FieldDefaultEnd
49457>>>>>>>    End_Procedure    // Field_Defaults
49458>>>>>>>
49458>>>>>>>End_Class    // Witemxtr_DataDictionary
49459>>>>>>>//DDB-Selection-pkg-Start
49459>>>>>>>
49459>>>>>>>Use sl182.SL         // sl182
49459>>>>>>>Use sl029a.sl        // sl029a
49459>>>>>>>
49459>>>>>>>//DDB-Selection-pkg-End
49459>>>>>>>//DDB-FileEnd
49459>>>>>    Use WITEMXTD.DD
INCLUDING FILE: WITEMXTD.DD
49459>>>>>>>//DDB-FileStart
49459>>>>>>>//DDB-HeaderStart
49459>>>>>>>
49459>>>>>>>// File Name : WITEMXTD.DD
49459>>>>>>>// Class Name: Witemxtd_DataDictionary
49459>>>>>>>// Revision  : 11
49459>>>>>>>// Version   : 2
49459>>>>>>>
49459>>>>>>>Use  Windows           // Basic Definitions
49459>>>>>>>Use  DataDict          // DataDictionary Class Definition
49459>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49459>>>>>>>
49459>>>>>>>Open Witemxtd
49461>>>>>>>Open Witemxtr
49463>>>>>>>Open Sysrecw
49465>>>>>>>
49465>>>>>>>//DDB-HeaderEnd
49465>>>>>>>//DDB-SelectionStart
49465>>>>>>>//DDB/ ExternalSelectionList SL17  sl17.SL
49465>>>>>>>//DDB/ ExternalSelectionList Wax  wax.sl
49465>>>>>>>Register_Object SL17
49465>>>>>>>Register_Object Wax
49465>>>>>>>//DDB-SelectionEnd
49465>>>>>>>
49465>>>>>>>Class Witemxtd_DataDictionary  is a DataDictionary_sec
49466>>>>>>>
49466>>>>>>>    // Define_Fields:
49466>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49466>>>>>>>   procedure creating 
49467>>>>>>>        Forward Send Creating
49469>>>>>>>        // Insert Code Here
49469>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Witemxtd.Rec0)))))) to Witemxtd.Recr
49470>>>>>>>    End_Procedure   // Creating
49471>>>>>>>    
49471>>>>>>>     Procedure Backout
49472>>>>>>>        Forward Send Backout
49474>>>>>>>
49474>>>>>>>        // Insert Code Here
49474>>>>>>>        sub witemxtd.qty_from       from witemxtr.qty
49475>>>>>>>        sub witemxtd.fpa_from       from witemxtr.fpa
49476>>>>>>>        sub witemxtd.axia_from      from witemxtr.axia
49477>>>>>>>        sub witemxtd.total_from     from witemxtr.total
49478>>>>>>>        
49478>>>>>>>    End_Procedure   // Backout
49479>>>>>>>
49479>>>>>>>
49479>>>>>>>
49479>>>>>>>    Procedure Update
49480>>>>>>>        Forward Send Update
49482>>>>>>>      
49482>>>>>>>        Move (round_number((witemxtd.qty_from*witemxtd.unitprice_from),2))   to witemxtd.axia_from
49483>>>>>>>        Move (Round_number(((witemxtd.axia_from*witemxtd.pcfpa_from/100)),2));                                                to witemxtd.fpa_from
49484>>>>>>>        Move (witemxtd.axia_from+witemxtd.fpa_from) to witemxtd.total_from
49485>>>>>>>        Add witemxtd.qty_from     to witemxtr.qty
49486>>>>>>>        Add witemxtd.fpa_from     to witemxtr.fpa
49487>>>>>>>        Add witemxtd.axia_from    to witemxtr.axia
49488>>>>>>>        Add witemxtd.total_from   to witemxtr.total
49489>>>>>>>        // Insert Code Here
49489>>>>>>>    End_Procedure   // Update
49490>>>>>>>    
49490>>>>>>>    
49490>>>>>>>    
49490>>>>>>>    Procedure Define_Fields
49491>>>>>>>        Forward Send Define_Fields
49493>>>>>>>        //DDB-Generated-Code-Location
49493>>>>>>>        //DDB-DefineFieldStart
49493>>>>>>>
49493>>>>>>>        Set Main_File            To Witemxtd.File_Number
49494>>>>>>>
49494>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49495>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49496>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49497>>>>>>>
49497>>>>>>>        // Parent (Server) file structure...............
49497>>>>>>>        Send Add_Server_File  Witemxtr.File_Number
49498>>>>>>>
49498>>>>>>>        // External (System) file structure.............
49498>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
49499>>>>>>>
49499>>>>>>>        Define_Auto_Increment  Sysrecw.Witemxtd_Rec0  To Witemxtd.Rec0
49502>>>>>>>
49502>>>>>>>        // Field-based properties.......................
49502>>>>>>>
49502>>>>>>>        // Witemxtd.Witemxtr_Recr
49502>>>>>>>
49502>>>>>>>        // Witemxtd.Recr
49502>>>>>>>
49502>>>>>>>        // Witemxtd.Rec0
49502>>>>>>>
49502>>>>>>>        // Witemxtd.Witemx_Code
49502>>>>>>>        Set Field_Prompt_Object    Field Witemxtd.Witemx_Code To (SL17(Self))
49503>>>>>>>
49503>>>>>>>        // Witemxtd.Qty_From
49503>>>>>>>
49503>>>>>>>        // Witemxtd.Unitprice_From
49503>>>>>>>
49503>>>>>>>        // Witemxtd.Fpa_From
49503>>>>>>>
49503>>>>>>>        // Witemxtd.Pcfpa_From
49503>>>>>>>
49503>>>>>>>        // Witemxtd.Axia_From
49503>>>>>>>
49503>>>>>>>        // Witemxtd.Total_From
49503>>>>>>>
49503>>>>>>>        // Witemxtd.Wcmoves_Recr
49503>>>>>>>
49503>>>>>>>        // Witemxtd.Wax_From
49503>>>>>>>        Set Field_Prompt_Object    Field Witemxtd.Wax_From To (Wax(Self))
49504>>>>>>>
49504>>>>>>>        // Witemxtd.Wax_To
49504>>>>>>>        Set Field_Prompt_Object    Field Witemxtd.Wax_To To (Wax(Self))
49505>>>>>>>
49505>>>>>>>        //DDB-DefineFieldEnd
49505>>>>>>>    End_Procedure    // Define_Fields
49506>>>>>>>
49506>>>>>>>    // Field_Defaults:
49506>>>>>>>    // This procedure is used to establish default field values.
49506>>>>>>>
49506>>>>>>>    Procedure Field_Defaults
49507>>>>>>>        Forward Send Field_Defaults
49509>>>>>>>        //DDB-Generated-Code-Location
49509>>>>>>>        //DDB-FieldDefaultStart
49509>>>>>>>        //DDB-FieldDefaultEnd
49509>>>>>>>    End_Procedure    // Field_Defaults
49510>>>>>>>
49510>>>>>>>End_Class    // Witemxtd_DataDictionary
49511>>>>>>>//DDB-Selection-pkg-Start
49511>>>>>>>
49511>>>>>>>Use sl17.SL          // SL17
49511>>>>>>>Use wax.sl           // Wax
49511>>>>>>>
49511>>>>>>>//DDB-Selection-pkg-End
49511>>>>>>>//DDB-FileEnd
49511>>>>>    
49511>>>>>    //AB-IgnoreEnd
49511>>>>>
49511>>>>>    Object sl182 is a dbModalPanelSub
49513>>>>>
49513>>>>>        //AB-StoreTopStart
49513>>>>>                
49513>>>>>        //AB-StoreTopEnd
49513>>>>>
49513>>>>>        Set Label to "‹˜ ¡âª ¡ ¤ã©œ ª œ ›é¤ ©« ª ˜§¦Ÿã¡œª"
49514>>>>>        Set Size to 262 453
49515>>>>>        Set Location to 4 5
49516>>>>>        Set Exit_Application_Local_State to FALSE
49517>>>>>        Set Modal_State to FALSE
49518>>>>>
49518>>>>>        //AB-DDOStart
49518>>>>>
49518>>>>>        Object Witemxtr_DD is a Witemxtr_DataDictionary
49520>>>>>        End_Object    // Witemxtr_DD
49521>>>>>
49521>>>>>        Object Witemxtd_DD is a Witemxtd_DataDictionary
49523>>>>>            Set DDO_Server to (Witemxtr_DD(self))
49524>>>>>            Set Constrain_File to Witemxtr.File_Number
49525>>>>>        End_Object    // Witemxtd_DD
49526>>>>>
49526>>>>>        Set Main_DD to (Witemxtr_DD(self))
49527>>>>>        Set Server to (Witemxtr_DD(self))
49528>>>>>
49528>>>>>        //AB-DDOEnd
49528>>>>>
49528>>>>>        Object oSelList is a dbListSub
49530>>>>>            Set Main_File to Witemxtr.File_Number
49531>>>>>            Set Size to 220 435
49532>>>>>            Set Location to 6 6
49533>>>>>
49533>>>>>            Begin_Row
49536>>>>>                Entry_Item Witemxtr.Hmnia
49537>>>>>                Entry_Item Witemxtr.Descr
49538>>>>>                Entry_Item Witemxtr.Qty
49539>>>>>                Entry_Item Witemxtr.Axia
49540>>>>>                Entry_Item Witemxtr.Fpa
49541>>>>>                Entry_Item Witemxtr.Total
49542>>>>>                Entry_Item Witemxtr.Ekleise
49543>>>>>            End_Row
49548>>>>>
49548>>>>>            Set Form_Width    item 0 to 48
49549>>>>>            Set Header_Label  item 0 to "†£/¤å˜"
49550>>>>>            
49550>>>>>            Set Form_Width    item 1 to 165
49551>>>>>            Set Header_Label  item 1 to "˜¨˜©«˜« ¡æ"
49552>>>>>            
49552>>>>>            Set Form_Width    item 2 to 35
49553>>>>>            Set Header_Label  item 2 to "¦©¦«."
49554>>>>>            
49554>>>>>            Set Form_Width    item 3 to 50
49555>>>>>            Set Header_Label  item 3 to "€¥å˜"
49556>>>>>            
49556>>>>>            Set Form_Width    item 4 to 50
49557>>>>>            Set Header_Label  item 4 to "”€"
49558>>>>>            
49558>>>>>            Set Form_Width    item 5 to 60
49559>>>>>            Set Header_Label  item 5 to "‘ç¤¦¢¦"
49560>>>>>            
49560>>>>>            Set Form_Width    item 6 to 20
49561>>>>>            Set Header_Label  item 6 to "Ž‰"
49562>>>>>            Set Column_Checkbox_State  item 6 to True
49563>>>>>            
49563>>>>>
49563>>>>>            //AB-StoreStart
49563>>>>>            
49563>>>>>            Procedure End_Construct_Object
49565>>>>>                String  sNom
49566>>>>>                Integer iDecs
49566>>>>>                Forward Send End_Construct_Object
49568>>>>>                Move SysCurxr.C_Code0 to sNom
49569>>>>>                Clear Nomisma
49570>>>>>                Move sNom to Nomisma.Nomisma_Code
49571>>>>>                Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
49572>>>>>>
49572>>>>>                If (Found=1)    Move Nomisma.Dekadika to iDecs
49575>>>>>                Else            Move 0 to iDecs
49577>>>>>            
49577>>>>>                // Ž¨ ¦¬£œ §àª ˜¤ «¦ ™˜© ¡æ ¤¦£ ©£˜ ®¨ã©žª ƒ„Œ œ®œ  ›œ¡˜› ¡á
49577>>>>>                // «æ«œ œ¥' ¦¨ ©£¦ç ™á¦¬£œ œ£œ ª 2
49577>>>>>                If (iDecs=0) Move 2 to iDecs
49580>>>>>                //
49580>>>>>                Set Points          Item 2 to       1
49581>>>>>                Set Points          Item 3 to       iDecs
49582>>>>>                Set Numeric_Mask    Item 3 to 14    iDecs ' ,*'
49583>>>>>                Set Points          Item 4 to       iDecs
49584>>>>>                Set Numeric_Mask    Item 4 to 14    iDecs ' ,*'
49585>>>>>                Set Points          Item 5 to       iDecs
49586>>>>>                Set Numeric_Mask    Item 5 to 14    iDecs ' ,*'
49587>>>>>            End_Procedure
49588>>>>>            
49588>>>>>            
49588>>>>>            
49588>>>>>            
49588>>>>>            
49588>>>>>            
49588>>>>>            
49588>>>>>            
49588>>>>>            //AB-StoreEnd
49588>>>>>
49588>>>>>        End_Object    // oSelList
49589>>>>>
49589>>>>>        Object oOK_bn is a ButtonSub
49591>>>>>            Set Label to "&„§ ¢¦šã"
49592>>>>>            Set Location to 230 283
49593>>>>>
49593>>>>>            //AB-StoreStart
49593>>>>>            Procedure OnClick
49595>>>>>                Send OK To (oSelList(current_object))
49596>>>>>            End_Procedure
49597>>>>>            //AB-StoreEnd
49597>>>>>
49597>>>>>        End_Object    // oOK_bn
49598>>>>>
49598>>>>>        Object oCancel_bn is a ButtonSub
49600>>>>>            Set Label to "&€¡ç¨à©ž"
49601>>>>>            Set Location to 230 339
49602>>>>>
49602>>>>>            //AB-StoreStart
49602>>>>>            Procedure OnClick
49604>>>>>                Send Cancel To (oSelList(current_object))
49605>>>>>            End_Procedure
49606>>>>>            //AB-StoreEnd
49606>>>>>
49606>>>>>        End_Object    // oCancel_bn
49607>>>>>
49607>>>>>        Object oSearch_bn is a ButtonSub
49609>>>>>            Set Label to "€&¤˜ã«ž©ž..."
49610>>>>>            Set Location to 230 393
49611>>>>>
49611>>>>>            //AB-StoreStart
49611>>>>>            Procedure OnClick
49613>>>>>                Send Search To (oSelList(current_object))
49614>>>>>            End_Procedure
49615>>>>>            //AB-StoreEnd
49615>>>>>
49615>>>>>        End_Object    // oSearch_bn
49616>>>>>
49616>>>>>
49616>>>>>        //AB-StoreStart
49616>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49617>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49618>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49619>>>>>        
49619>>>>>        
49619>>>>>        
49619>>>>>        
49619>>>>>        
49619>>>>>        
49619>>>>>        //AB-StoreEnd
49619>>>>>
49619>>>>>    End_Object    // sl182
49620>>>>>
49620>>>>>
49620>>>>>    //AB-StoreStart
49620>>>>>                                    
49620>>>>>    //AB-StoreEnd
49620>>>>>
49620>>>>>//AB/     End_Object    // prj
49620>>>Use sl186a.sl
INCLUDING FILE: SL186A.SL
49620>>>>>//AB/ Project sl186a:item-clients
49620>>>>>//AB/ Object prj is a Lookup_Project
49620>>>>>//AB/     Set ProjectName to "sl186a:item-clients"
49620>>>>>//AB/     Set ProjectFileName to "sl186a.SL"
49620>>>>>//AB/     Set GenerateFileName to "NONAME"
49620>>>>>
49620>>>>>// Project Object Structure
49620>>>>>//   sl186a is a dbModalPanelSub
49620>>>>>//     clients_dd2 is a clients_DataDictionary
49620>>>>>//     Witemkat_DD is a DataDictionary
49620>>>>>//     Units_DD is a DataDictionary
49620>>>>>//     Fpa_DD is a DataDictionary
49620>>>>>//     Item_DD is a DataDictionary
49620>>>>>//     Witemcl_DD is a DataDictionary
49620>>>>>//     oSelList is a dblist
49620>>>>>//     oOK_bn is a ButtonSub
49620>>>>>//     oCancel_bn is a ButtonSub
49620>>>>>//     oSearch_bn is a ButtonSub
49620>>>>>
49620>>>>>// Register all objects
49620>>>>>Register_Object clients_dd2
49620>>>>>Register_Object Fpa_DD
49620>>>>>Register_Object Item_DD
49620>>>>>Register_Object oCancel_bn
49620>>>>>Register_Object oOK_bn
49620>>>>>Register_Object oSearch_bn
49620>>>>>Register_Object oSelList
49620>>>>>Register_Object sl186a
49620>>>>>Register_Object Units_DD
49620>>>>>Register_Object Witemcl_DD
49620>>>>>Register_Object Witemkat_DD
49620>>>>>
49620>>>>>
49620>>>>>
49620>>>>>//AB-StoreTopStart
49620>>>>>open clients
49622>>>>>
49622>>>>>//AB-StoreTopEnd
49622>>>>>
49622>>>>>//AB-IgnoreStart
49622>>>>>
49622>>>>>Use DFAllEnt.pkg
49622>>>>>Use dbList.Sub
49622>>>>>Use Button.Sub
49622>>>>>
49622>>>>>
49622>>>>>Use WITEMKAT.DD
49622>>>>>Use UNITS.DD
49622>>>>>Use FPA.DD
49622>>>>>Use ITEM.DD
49622>>>>>Use WITEMCL.DD
49622>>>>>
49622>>>>>//AB-IgnoreEnd
49622>>>>>
49622>>>>>Object sl186a is a dbModalPanelSub
49624>>>>>
49624>>>>>    //AB-StoreTopStart
49624>>>>>
49624>>>>>    Property String Fragmaprom Public ""
49626>>>>>
49626>>>>>    object clients_dd2 is a clients_DataDictionary
49628>>>>>    end_object
49629>>>>>
49629>>>>>    Function fnclient String asCode Returns string
49631>>>>>        String sDescr
49632>>>>>        send clear to clients_dd2
49633>>>>>        move asCode to clients.client_id
49634>>>>>        send find to clients_dd2 eq 6
49635>>>>>        get field_current_value of clients_dd2 field clients.client_name to sDescr
49636>>>>>        function_return sDescr
49637>>>>>    end_Function
49638>>>>>
49638>>>>>    //AB-StoreTopEnd
49638>>>>>
49638>>>>>    Set Label to "„å›ž €¤á ¨¦£žŸœ¬«ã"
49639>>>>>    Set Size to 254 495
49640>>>>>    Set Location to 5 5
49641>>>>>    Set Exit_Application_Local_State to FALSE
49642>>>>>    Set Modal_State to FALSE
49643>>>>>
49643>>>>>    //AB-DDOStart
49643>>>>>
49643>>>>>    Object Witemkat_DD is a Witemkat_DataDictionary
49645>>>>>    End_Object    // Witemkat_DD
49646>>>>>
49646>>>>>    Object Units_DD is a Units_DataDictionary
49648>>>>>    End_Object    // Units_DD
49649>>>>>
49649>>>>>    Object Fpa_DD is a Fpa_DataDictionary
49651>>>>>    End_Object    // Fpa_DD
49652>>>>>
49652>>>>>    Object Item_DD is a Item_DataDictionary
49654>>>>>        Set DDO_Server to (Units_DD(self))
49655>>>>>        Set DDO_Server to (Witemkat_DD(self))
49656>>>>>        Set DDO_Server to (Fpa_DD(self))
49657>>>>>    End_Object    // Item_DD
49658>>>>>
49658>>>>>    Object Witemcl_DD is a Witemcl_DataDictionary
49660>>>>>        Set DDO_Server to (Item_DD(self))
49661>>>>>
49661>>>>>        //AB-StoreStart
49661>>>>>
49661>>>>>        Begin_Constraints
49663>>>>>            If (fragmaprom(Self)<>'') Begin
49665>>>>>                Constrain witemcl.client_code eq (fragmaprom(Self))
49667>>>>>            End
49667>>>>>>
49667>>>>>        End_Constraints
49670>>>>>
49670>>>>>
49670>>>>>        //AB-StoreEnd
49670>>>>>
49670>>>>>    End_Object    // Witemcl_DD
49671>>>>>
49671>>>>>    Set Main_DD to (Witemcl_DD(self))
49672>>>>>    Set Server to (Witemcl_DD(self))
49673>>>>>
49673>>>>>    //AB-DDOEnd
49673>>>>>
49673>>>>>    Object oSelList is a dblist
49675>>>>>        Set Main_File to Witemcl.File_Number
49676>>>>>        Set Ordering to 2
49677>>>>>        Set Size to 212 480
49678>>>>>        Set Location to 6 6
49679>>>>>        Set Color to 14280447
49680>>>>>        Set CurrentRowColor to 11783679
49681>>>>>        Set CurrentCellColor to 11783679
49682>>>>>
49682>>>>>        Begin_Row
49685>>>>>            Entry_Item Item.Item_code
49686>>>>>            Entry_Item Item.Item_descr
49687>>>>>            Entry_Item Witemcl.Client_code
49688>>>>>            Entry_Item (Fnclient(self,witemcl.client_code))
49689>>>>>            Entry_Item Witemcl.Client_itemcode
49690>>>>>            Entry_Item Witemcl.Client_date
49691>>>>>            Entry_Item Witemcl.Client_price
49692>>>>>        End_Row
49697>>>>>
49697>>>>>        Set Form_Width    item 0 to 61
49698>>>>>        Set Header_Label  item 0 to "‰à›.„å›¦¬ª"
49699>>>>>
49699>>>>>        Set Form_Width    item 1 to 90
49700>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã „å›¦¬ª"
49701>>>>>
49701>>>>>        Set Form_Width    item 2 to 55
49702>>>>>        Set Header_Label  item 2 to "‰à›.”¦¨â˜"
49703>>>>>
49703>>>>>        Set Form_Width    item 3 to 96
49704>>>>>        Set Header_Label  item 3 to "„§à¤¬£å˜ ”¦¨â˜"
49705>>>>>
49705>>>>>        Set Form_Width    item 4 to 60
49706>>>>>        Set Header_Label  item 4 to "„å›¦ª ¨¦£žŸ."
49707>>>>>
49707>>>>>        Set Form_Width    item 5 to 60
49708>>>>>        Set Header_Label  item 5 to "’'†£/¤å˜ „ ©˜š."
49709>>>>>
49709>>>>>        Set Form_Width    item 6 to 52
49710>>>>>        Set Header_Label  item 6 to "’'’ £ã „ ©˜š."
49711>>>>>
49711>>>>>
49711>>>>>        //AB-StoreStart
49711>>>>>
49711>>>>>        Property String Store_Fragma_prom public ""
49713>>>>>
49713>>>>>        Procedure Store_Defaults
49715>>>>>           forward send Store_Defaults
49717>>>>>           Set Store_Fragma_prom to (Fragmaprom(Self))
49718>>>>>        end_Procedure
49719>>>>>
49719>>>>>        Procedure Restore_Defaults
49721>>>>>            forward send Restore_Defaults
49723>>>>>            Set Fragmaprom to (Store_Fragma_prom(Self))
49724>>>>>        end_Procedure
49725>>>>>
49725>>>>>        Procedure Activating
49727>>>>>            Forward Send Activating
49729>>>>>            Send Rebuild_Constraints to WitemCl_DD
49730>>>>>        End_Procedure
49731>>>>>
49731>>>>>        Procedure End_Construct_Object
49733>>>>>            Integer iDecimals
49734>>>>>            Forward Send End_Construct_Object
49736>>>>>            Get fiDekadika_Nomismatos  SysCurXr.C_Code0  to    iDecimals
49737>>>>>            Set Points          Item 6 to       iDecimals
49738>>>>>            Set Numeric_Mask    Item 6 to 14    iDecimals '*, '
49739>>>>>        End_Procedure
49740>>>>>
49740>>>>>
49740>>>>>
49740>>>>>
49740>>>>>
49740>>>>>
49740>>>>>
49740>>>>>        //AB-StoreEnd
49740>>>>>
49740>>>>>    End_Object    // oSelList
49741>>>>>
49741>>>>>    Object oOK_bn is a ButtonSub
49743>>>>>        Set Label to "&„§ ¢¦šã"
49744>>>>>        Set Location to 222 326
49745>>>>>
49745>>>>>        //AB-StoreStart
49745>>>>>        Procedure OnClick
49747>>>>>            Send OK To (oSelList(current_object))
49748>>>>>        End_Procedure
49749>>>>>        //AB-StoreEnd
49749>>>>>
49749>>>>>    End_Object    // oOK_bn
49750>>>>>
49750>>>>>    Object oCancel_bn is a ButtonSub
49752>>>>>        Set Label to "&€¡ç¨à©ž"
49753>>>>>        Set Location to 222 381
49754>>>>>
49754>>>>>        //AB-StoreStart
49754>>>>>        Procedure OnClick
49756>>>>>            Send Cancel To (oSelList(current_object))
49757>>>>>        End_Procedure
49758>>>>>        //AB-StoreEnd
49758>>>>>
49758>>>>>    End_Object    // oCancel_bn
49759>>>>>
49759>>>>>    Object oSearch_bn is a ButtonSub
49761>>>>>        Set Label to "€&¤˜ã«ž©ž..."
49762>>>>>        Set Location to 222 436
49763>>>>>
49763>>>>>        //AB-StoreStart
49763>>>>>        Procedure OnClick
49765>>>>>            Send Search To (oSelList(current_object))
49766>>>>>        End_Procedure
49767>>>>>        //AB-StoreEnd
49767>>>>>
49767>>>>>    End_Object    // oSearch_bn
49768>>>>>
49768>>>>>
49768>>>>>    //AB-StoreStart
49768>>>>>
49768>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49769>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49770>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49771>>>>>    procedure page integer pagemode
49773>>>>>        forward send page pagemode
49775>>>>>        set location to 40,40
49776>>>>>    end_procedure
49777>>>>>
49777>>>>>
49777>>>>>
49777>>>>>
49777>>>>>
49777>>>>>
49777>>>>>
49777>>>>>
49777>>>>>
49777>>>>>
49777>>>>>
49777>>>>>
49777>>>>>
49777>>>>>    //AB-StoreEnd
49777>>>>>
49777>>>>>End_Object    // sl186a
49778>>>>>
49778>>>>>
49778>>>>>//AB-StoreStart
49778>>>>>
49778>>>>>
49778>>>>>
49778>>>>>
49778>>>>>//AB-StoreEnd
49778>>>>>
49778>>>>>//AB/ End_Object    // prj
49778>>>Use sl22.sl
INCLUDING FILE: SL22.SL
49778>>>>>//AB/ Project sl22:kathgories apothkon
49778>>>>>//AB/     Object prj is a Lookup_Project
49778>>>>>//AB/         Set ProjectName to "sl22:kathgories apothkon"
49778>>>>>//AB/         Set ProjectFileName to "sl22.SL"
49778>>>>>//AB/         Set GenerateFileName to "NONAME"
49778>>>>>
49778>>>>>// Project Object Structure
49778>>>>>//   sl22 is a dbModalPanelSub
49778>>>>>//     Wapokat_DD is a DataDictionary
49778>>>>>//     oSelList is a dbListSub
49778>>>>>//     oOK_bn is a ButtonSub
49778>>>>>//     oCancel_bn is a ButtonSub
49778>>>>>//     oSearch_bn is a ButtonSub
49778>>>>>
49778>>>>>// Register all objects
49778>>>>>Register_Object oCancel_bn
49778>>>>>Register_Object oOK_bn
49778>>>>>Register_Object oSearch_bn
49778>>>>>Register_Object oSelList
49778>>>>>Register_Object sl22
49778>>>>>Register_Object Wapokat_DD
49778>>>>>
49778>>>>>
49778>>>>>    //AB-IgnoreStart
49778>>>>>
49778>>>>>    Use DFAllEnt.pkg
49778>>>>>    Use dbList.Sub
49778>>>>>    Use Button.Sub
49778>>>>>
49778>>>>>
49778>>>>>    Use WAPOKAT.DD
49778>>>>>    
49778>>>>>    //AB-IgnoreEnd
49778>>>>>
49778>>>>>    Object sl22 is a dbModalPanelSub
49780>>>>>        set label to "‰˜«žš¦¨åœª €§¦Ÿž¡é¤" 
49781>>>>>        Set Size to 148 297
49782>>>>>        Set Location to 4 5
49783>>>>>        Set Exit_Application_Local_State to FALSE
49784>>>>>        Set Modal_State to FALSE
49785>>>>>
49785>>>>>        //AB-DDOStart
49785>>>>>
49785>>>>>        Object Wapokat_DD is a Wapokat_DataDictionary
49787>>>>>        End_Object    // Wapokat_DD
49788>>>>>
49788>>>>>        Set Main_DD to (Wapokat_DD(self))
49789>>>>>        Set Server to (Wapokat_DD(self))
49790>>>>>
49790>>>>>        //AB-DDOEnd
49790>>>>>
49790>>>>>        Object oSelList is a dbListSub
49792>>>>>            Set Main_File to Wapokat.File_Number
49793>>>>>            Set Size to 105 280
49794>>>>>            Set Location to 6 6
49795>>>>>
49795>>>>>            Begin_Row
49798>>>>>                Entry_Item Wapokat.Wapokat_code
49799>>>>>                Entry_Item Wapokat.Wapokat_descr
49800>>>>>            End_Row
49805>>>>>
49805>>>>>            Set Form_Width    item 0 to 80
49806>>>>>            set header_label  item 0 to "‰à› ¡¦ª" 
49807>>>>>            
49807>>>>>            Set Form_Width    item 1 to 191
49808>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
49809>>>>>            
49809>>>>>        End_Object    // oSelList
49810>>>>>
49810>>>>>        Object oOK_bn is a ButtonSub
49812>>>>>            set label to "&„§ ¢¦šã" 
49813>>>>>            Set Location to 115 126
49814>>>>>
49814>>>>>            //AB-StoreStart
49814>>>>>            Procedure OnClick
49816>>>>>                Send OK To (oSelList(current_object))
49817>>>>>            End_Procedure
49818>>>>>            //AB-StoreEnd
49818>>>>>
49818>>>>>        End_Object    // oOK_bn
49819>>>>>
49819>>>>>        Object oCancel_bn is a ButtonSub
49821>>>>>            set label to "&€¡ç¨à©ž" 
49822>>>>>            Set Location to 115 181
49823>>>>>
49823>>>>>            //AB-StoreStart
49823>>>>>            Procedure OnClick
49825>>>>>                Send Cancel To (oSelList(current_object))
49826>>>>>            End_Procedure
49827>>>>>            //AB-StoreEnd
49827>>>>>
49827>>>>>        End_Object    // oCancel_bn
49828>>>>>
49828>>>>>        Object oSearch_bn is a ButtonSub
49830>>>>>            set label to "€&¤˜ã«ž©ž" 
49831>>>>>            Set Location to 115 236
49832>>>>>
49832>>>>>            //AB-StoreStart
49832>>>>>            Procedure OnClick
49834>>>>>                Send Search To (oSelList(current_object))
49835>>>>>            End_Procedure
49836>>>>>            //AB-StoreEnd
49836>>>>>
49836>>>>>        End_Object    // oSearch_bn
49837>>>>>
49837>>>>>
49837>>>>>        //AB-StoreStart
49837>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49838>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49839>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49840>>>>>        //AB-StoreEnd
49840>>>>>
49840>>>>>    End_Object    // sl22
49841>>>>>
49841>>>>>//AB/     End_Object    // prj
49841>>>Use sl23.sl
INCLUDING FILE: SL23.SL
49841>>>>>//AB/ Project sl23: apothkes
49841>>>>>//AB/     Object prj is a Lookup_Project
49841>>>>>//AB/         Set ProjectName to "sl23: apothkes"
49841>>>>>//AB/         Set ProjectFileName to "sl23.SL"
49841>>>>>//AB/         Set GenerateFileName to "NONAME"
49841>>>>>
49841>>>>>// Project Object Structure
49841>>>>>//   sl23 is a dbModalPanelSub
49841>>>>>//     Wapokat_DD is a DataDictionary
49841>>>>>//     Wapomast_DD is a DataDictionary
49841>>>>>//     oSelList is a dbListSub
49841>>>>>//     oOK_bn is a ButtonSub
49841>>>>>//     oCancel_bn is a ButtonSub
49841>>>>>//     oSearch_bn is a ButtonSub
49841>>>>>
49841>>>>>// Register all objects
49841>>>>>Register_Object oCancel_bn
49841>>>>>Register_Object oOK_bn
49841>>>>>Register_Object oSearch_bn
49841>>>>>Register_Object oSelList
49841>>>>>Register_Object sl23
49841>>>>>Register_Object Wapokat_DD
49841>>>>>Register_Object Wapomast_DD
49841>>>>>
49841>>>>>
49841>>>>>    //AB-IgnoreStart
49841>>>>>
49841>>>>>    Use DFAllEnt.pkg
49841>>>>>    Use dbList.Sub
49841>>>>>    Use Button.Sub
49841>>>>>
49841>>>>>
49841>>>>>    Use WAPOKAT.DD
49841>>>>>    Use WAPOMAST.DD
49841>>>>>    
49841>>>>>    //AB-IgnoreEnd
49841>>>>>
49841>>>>>    Object sl23 is a dbModalPanelSub
49843>>>>>        set label to "€§¦Ÿã¡œª" 
49844>>>>>        Set Size to 148 285
49845>>>>>        Set Location to 4 5
49846>>>>>        Set Exit_Application_Local_State to FALSE
49847>>>>>        Set Modal_State to FALSE
49848>>>>>
49848>>>>>        //AB-DDOStart
49848>>>>>
49848>>>>>        Object Wapokat_DD is a Wapokat_DataDictionary
49850>>>>>        End_Object    // Wapokat_DD
49851>>>>>
49851>>>>>        Object Wapomast_DD is a Wapomast_DataDictionary
49853>>>>>            Set DDO_Server to (Wapokat_DD(self))
49854>>>>>        End_Object    // Wapomast_DD
49855>>>>>
49855>>>>>        Set Main_DD to (Wapomast_DD(self))
49856>>>>>        Set Server to (Wapomast_DD(self))
49857>>>>>
49857>>>>>        //AB-DDOEnd
49857>>>>>
49857>>>>>        Object oSelList is a dbListSub
49859>>>>>            Set Main_File to Wapomast.File_Number
49860>>>>>            Set Size to 105 269
49861>>>>>            Set Location to 6 6
49862>>>>>
49862>>>>>            Begin_Row
49865>>>>>                Entry_Item Wapomast.Wapomast_code
49866>>>>>                Entry_Item Wapomast.Wapomast_descr
49867>>>>>            End_Row
49872>>>>>
49872>>>>>            Set Form_Width    item 0 to 80
49873>>>>>            set header_label  item 0 to "€§¦Ÿã¡œª" 
49874>>>>>            
49874>>>>>            Set Form_Width    item 1 to 180
49875>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
49876>>>>>            
49876>>>>>        End_Object    // oSelList
49877>>>>>
49877>>>>>        Object oOK_bn is a ButtonSub
49879>>>>>            set label to "&„§ ¢¦šã" 
49880>>>>>            Set Location to 113 115
49881>>>>>
49881>>>>>            //AB-StoreStart
49881>>>>>            Procedure OnClick
49883>>>>>                Send OK To (oSelList(current_object))
49884>>>>>            End_Procedure
49885>>>>>            //AB-StoreEnd
49885>>>>>
49885>>>>>        End_Object    // oOK_bn
49886>>>>>
49886>>>>>        Object oCancel_bn is a ButtonSub
49888>>>>>            set label to "&€¡ç¨à©ž" 
49889>>>>>            Set Location to 113 170
49890>>>>>
49890>>>>>            //AB-StoreStart
49890>>>>>            Procedure OnClick
49892>>>>>                Send Cancel To (oSelList(current_object))
49893>>>>>            End_Procedure
49894>>>>>            //AB-StoreEnd
49894>>>>>
49894>>>>>        End_Object    // oCancel_bn
49895>>>>>
49895>>>>>        Object oSearch_bn is a ButtonSub
49897>>>>>            set label to "€&¤˜ã«ž©ž" 
49898>>>>>            Set Location to 113 225
49899>>>>>
49899>>>>>            //AB-StoreStart
49899>>>>>            Procedure OnClick
49901>>>>>                Send Search To (oSelList(current_object))
49902>>>>>            End_Procedure
49903>>>>>            //AB-StoreEnd
49903>>>>>
49903>>>>>        End_Object    // oSearch_bn
49904>>>>>
49904>>>>>
49904>>>>>        //AB-StoreStart
49904>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49905>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49906>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49907>>>>>        //AB-StoreEnd
49907>>>>>
49907>>>>>    End_Object    // sl23
49908>>>>>
49908>>>>>//AB/     End_Object    // prj
49908>>>Use slNomism.sl
49908>>>Use CodeType.sl
INCLUDING FILE: CODETYPE.SL
49908>>>>>//AB/ Project CodeType LookUp
49908>>>>>//AB/     Object prj is a LOOKUP_Project
49908>>>>>//AB/         Set ProjectName to "CodeType LookUp"
49908>>>>>//AB/         Set ProjectFileName to "Codetype.sl"
49908>>>>>
49908>>>>>    //AB-IgnoreStart
49908>>>>>
49908>>>>>    USE AllentSc
49908>>>>>
49908>>>>>
49908>>>>>    Use CODETYPE.DD
INCLUDING FILE: CODETYPE.DD
49908>>>>>>>//DDB-FileStart
49908>>>>>>>//DDB-HeaderStart
49908>>>>>>>
49908>>>>>>>// File Name : CODETYPE.DD
49908>>>>>>>// Class Name: Codetype_DataDictionary
49908>>>>>>>// Revision  : 4
49908>>>>>>>// Version   : 2
49908>>>>>>>
49908>>>>>>>Use  Windows           // Basic Definitions
49908>>>>>>>Use  DataDict          // DataDictionary Class Definition
49908>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49908>>>>>>>
49908>>>>>>>Open Codetype
49910>>>>>>>Open Codemast
49912>>>>>>>
49912>>>>>>>//DDB-HeaderEnd
49912>>>>>>>//DDB-SelectionStart
49912>>>>>>>//DDB/ ExternalSelectionList CodeType_SL  codetype.sl
49912>>>>>>>Register_Object CodeType_SL
49912>>>>>>>//DDB-SelectionEnd
49912>>>>>>>
49912>>>>>>>Class Codetype_DataDictionary is a DataDictionary
49913>>>>>>>
49913>>>>>>>    // Disallow blank keys
49913>>>>>>>    Function Validate_Save Returns Integer
49914>>>>>>>        If CodeType.Type eq '' Begin
49916>>>>>>>            Error 300 '‰œ¤âª « £âª ›œ¤ œ§ «¨â§¦¤˜« .'
49917>>>>>>>>
49917>>>>>>>            Function_Return 1
49918>>>>>>>        End
49918>>>>>>>>
49918>>>>>>>    End_Function // Validate_Save
49919>>>>>>>
49919>>>>>>>    // Define_Fields:
49919>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49919>>>>>>>
49919>>>>>>>    Procedure Define_Fields
49920>>>>>>>        Forward Send Define_Fields
49922>>>>>>>        //DDB-Generated-Code-Location
49922>>>>>>>        //DDB-DefineFieldStart
49922>>>>>>>
49922>>>>>>>        Set Main_File            To Codetype.File_Number
49923>>>>>>>        Set Cascade_Delete_State To FALSE
49924>>>>>>>
49924>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49925>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49926>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49927>>>>>>>
49927>>>>>>>        // Child (Client) file structure................
49927>>>>>>>        Send Add_Client_File  Codemast.File_Number
49928>>>>>>>
49928>>>>>>>        // Field-based properties.......................
49928>>>>>>>
49928>>>>>>>        // Codetype.Type
49928>>>>>>>        Set Field_Options          Field Codetype.Type To DD_AUTOFIND    DD_REQUIRED    DD_CAPSLOCK   
49929>>>>>>>        Set Field_Prompt_Object    Field Codetype.Type To (CodeType_SL(Self))
49930>>>>>>>        Set Key_Field_State        Field Codetype.Type To TRUE
49931>>>>>>>
49931>>>>>>>        // Codetype.Description
49931>>>>>>>        Set Field_Prompt_Object    Field Codetype.Description To (CodeType_SL(Self))
49932>>>>>>>
49932>>>>>>>        // Codetype.Comment
49932>>>>>>>        Set Status_Help            Field Codetype.Comment To "‹å˜ ˜¤˜¢¬« ¡æ«œ¨ž §œ¨ š¨˜­ã «žª ¡˜«žš¦¨å˜ª «¦¬ ¡à› ¡¦ç."
49933>>>>>>>
49933>>>>>>>        //DDB-DefineFieldEnd
49933>>>>>>>    End_Procedure    // Define_Fields
49934>>>>>>>
49934>>>>>>>    // Field_Defaults:
49934>>>>>>>    // This procedure is used to establish default field values.
49934>>>>>>>
49934>>>>>>>    Procedure Field_Defaults
49935>>>>>>>        Forward Send Field_Defaults
49937>>>>>>>        //DDB-Generated-Code-Location
49937>>>>>>>        //DDB-FieldDefaultStart
49937>>>>>>>        //DDB-FieldDefaultEnd
49937>>>>>>>    End_Procedure    // Field_Defaults
49938>>>>>>>End_Class    //  Codetype_DataDictionary
49939>>>>>>>//DDB-Selection-pkg-Start
49939>>>>>>>
49939>>>>>>>Use codetype.sl      // CodeType_SL
49939>>>>>>>
49939>>>>>>>//DDB-Selection-pkg-End
49939>>>>>>>//DDB-FileEnd
49939>>>>>
49939>>>>>    //AB-IgnoreEnd
49939>>>>>
49939>>>>>    CD_Popup_Object CodeType_SL is a dbModalPanelSub
49958>>>>>        Set Minimize_Icon to FALSE
49959>>>>>        set label to "€¨®œå¦ CODETYPE" 
49960>>>>>        Set Size to 151 264
49961>>>>>        Set Location to 5 5
49962>>>>>
49962>>>>>        //AB-DDOStart
49962>>>>>
49962>>>>>        Object Codetype_DD is a Codetype_DataDictionary
49964>>>>>        End_Object    // Codetype_DD
49965>>>>>
49965>>>>>        Set Main_DD to (Codetype_DD(Current_Object))
49966>>>>>        Set Server to (Codetype_DD(Current_Object))
49967>>>>>
49967>>>>>        //AB-DDOEnd
49967>>>>>
49967>>>>>        Object oSelList is a dbListSub
49969>>>>>            Set Main_File to Codetype.File_Number
49970>>>>>            Set Size to 105 247
49971>>>>>            Set Location to 6 6
49972>>>>>
49972>>>>>            Begin_Row
49975>>>>>                Entry_Item Codetype.Type
49976>>>>>                Entry_Item Codetype.Description
49977>>>>>            End_Row
49982>>>>>
49982>>>>>            Set Form_Width    item 0 to 60
49983>>>>>            set header_label  item 0 to "’ç§¦ª" 
49984>>>>>
49984>>>>>            Set Form_Width    item 1 to 180
49985>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
49986>>>>>
49986>>>>>        End_Object    // oSelList
49987>>>>>
49987>>>>>        Object oOK_bn is a ButtonSub
49989>>>>>            Set Default_State to TRUE
49990>>>>>            set label to "&„§ ¢¦šã" 
49991>>>>>            Set Location to 115 93
49992>>>>>
49992>>>>>            //AB-StoreStart
49992>>>>>            Procedure OnClick
49994>>>>>                Send OK To (oSelList(current_object))
49995>>>>>            End_Procedure
49996>>>>>            //AB-StoreEnd
49996>>>>>
49996>>>>>        End_Object    // oOK_bn
49997>>>>>
49997>>>>>        Object oCancel_bn is a ButtonSub
49999>>>>>            set label to "&€¡ç¨à©ž" 
50000>>>>>            Set Location to 115 148
50001>>>>>
50001>>>>>            //AB-StoreStart
50001>>>>>            Procedure OnClick
50003>>>>>                Send Cancel To (oSelList(current_object))
50004>>>>>            End_Procedure
50005>>>>>            //AB-StoreEnd
50005>>>>>
50005>>>>>        End_Object    // oCancel_bn
50006>>>>>
50006>>>>>        Object oSearch_bn is a ButtonSub
50008>>>>>            set label to "€&¤˜ã«ž©ž" 
50009>>>>>            Set Location to 115 203
50010>>>>>
50010>>>>>            //AB-StoreStart
50010>>>>>            Procedure OnClick
50012>>>>>                Send Search To (oSelList(current_object))
50013>>>>>            End_Procedure
50014>>>>>            //AB-StoreEnd
50014>>>>>
50014>>>>>        End_Object    // oSearch_bn
50015>>>>>
50015>>>>>
50015>>>>>        //AB-StoreStart
50015>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
50016>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
50017>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
50018>>>>>        //AB-StoreEnd
50018>>>>>
50018>>>>>    CD_End_Object    // CodeType_SL
50020>>>>>>
50020>>>>>
50020>>>>>//AB/     End_Object    // prj
50020>>>Use Fpa.sl
50020>>>Use Hmgio.sl
INCLUDING FILE: HMGIO.SL
50020>>>>>//AB/ Project Hmgio:Lookup
50020>>>>>//AB/ Object prj is a Lookup_Project
50020>>>>>//AB/     Set ProjectName to "Hmgio:Lookup"
50020>>>>>//AB/     Set ProjectFileName to "Hmgio.SL"
50020>>>>>//AB/     Set GenerateFileName to "NONAME"
50020>>>>>
50020>>>>>// Project Object Structure
50020>>>>>//   Hmgio is a dbModalPanelSub
50020>>>>>//     Hmgio_DD is a DataDictionary
50020>>>>>//     oSelList is a dbListSub
50020>>>>>//     oOK_bn is a ButtonSub
50020>>>>>//     oCancel_bn is a ButtonSub
50020>>>>>//     oSearch_bn is a ButtonSub
50020>>>>>
50020>>>>>// Register all objects
50020>>>>>Register_Object Hmgio
50020>>>>>Register_Object Hmgio_DD
50020>>>>>Register_Object oCancel_bn
50020>>>>>Register_Object oOK_bn
50020>>>>>Register_Object oSearch_bn
50020>>>>>Register_Object oSelList
50020>>>>>
50020>>>>>
50020>>>>>//AB-IgnoreStart
50020>>>>>
50020>>>>>Use DFAllEnt.pkg
50020>>>>>Use dbList.Sub
50020>>>>>Use Button.Sub
50020>>>>>
50020>>>>>
50020>>>>>Use HMGIO.DD
INCLUDING FILE: HMGIO.DD
50020>>>>>>>//DDB-FileStart
50020>>>>>>>//DDB-HeaderStart
50020>>>>>>>
50020>>>>>>>// File Name : HMGIO.DD
50020>>>>>>>// Class Name: Hmgio_DataDictionary
50020>>>>>>>// Revision  : 8
50020>>>>>>>// Version   : 2
50020>>>>>>>
50020>>>>>>>Use  Windows           // Basic Definitions
50020>>>>>>>Use  DataDict          // DataDictionary Class Definition
50020>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
50020>>>>>>>
50020>>>>>>>Open Hmgio
INCLUDING FILE: HMGIO.FD
50022>>>>>>>Open Hmctyp
50024>>>>>>>Open Sysrecc
50026>>>>>>>
50026>>>>>>>//DDB-HeaderEnd
50026>>>>>>>//DDB-ValidationStart
50026>>>>>>>
50026>>>>>>>Register_Object Hmgio_Hmgio_Module_VT
50026>>>>>>>
50026>>>>>>>Object Hmgio_Hmgio_Module_VT  is a CodeValidationTable
50028>>>>>>>    Set Type_Value        To "MODULE"
50029>>>>>>>    Set Validate_State    To FALSE
50030>>>>>>>    Set Allow_Blank_State To TRUE
50031>>>>>>>    //DDB-ValidationCustomStart
50031>>>>>>>    //DDB-ValidationCustomEnd
50031>>>>>>>End_Object   // Hmgio_Hmgio_Module_VT
50032>>>>>>>//DDB-ValidationEnd
50032>>>>>>>//DDB-SelectionStart
50032>>>>>>>//DDB/ ExternalSelectionList Hmgio  Hmgio.SL
50032>>>>>>>Register_Object Hmgio
50032>>>>>>>//DDB-SelectionEnd
50032>>>>>>>
50032>>>>>>>Class Hmgio_DataDictionary  is a DataDictionary_Sec
50033>>>>>>>
50033>>>>>>>    // Define_Fields:
50033>>>>>>>    // This procedure is used to set up all data-dictionary rules.
50033>>>>>>>
50033>>>>>>>    Procedure Define_Fields
50034>>>>>>>        Forward Send Define_Fields
50036>>>>>>>        //DDB-Generated-Code-Location
50036>>>>>>>        //DDB-DefineFieldStart
50036>>>>>>>
50036>>>>>>>        Set Main_File            To Hmgio.File_Number
50037>>>>>>>        Set Cascade_Delete_State To FALSE
50038>>>>>>>
50038>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
50039>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
50040>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
50041>>>>>>>
50041>>>>>>>        // Child (Client) file structure................
50041>>>>>>>        Send Add_Client_File  Hmctyp.File_Number
50042>>>>>>>
50042>>>>>>>        // External (System) file structure.............
50042>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
50043>>>>>>>
50043>>>>>>>        Define_Auto_Increment  Sysrecc.Hmgio_Code  To Hmgio.Hmgio_Code
50046>>>>>>>
50046>>>>>>>        // Field-based properties.......................
50046>>>>>>>
50046>>>>>>>        // Hmgio.Hmgio_Code
50046>>>>>>>        Set Field_Options          Field Hmgio.Hmgio_Code To DD_AUTOFIND   
50047>>>>>>>        Set Field_Prompt_Object    Field Hmgio.Hmgio_Code To (Hmgio(Self))
50048>>>>>>>        Set Key_Field_State        Field Hmgio.Hmgio_Code To TRUE
50049>>>>>>>
50049>>>>>>>        // Hmgio.Hmgio_Descr
50049>>>>>>>        Set Field_Prompt_Object    Field Hmgio.Hmgio_Descr To (Hmgio(Self))
50050>>>>>>>
50050>>>>>>>        // Hmgio.Hmgio_Module
50050>>>>>>>        Set Field_Value_Table      Field Hmgio.Hmgio_Module To (Hmgio_Hmgio_Module_VT(Self))
50051>>>>>>>
50051>>>>>>>        //DDB-DefineFieldEnd
50051>>>>>>>    End_Procedure    // Define_Fields
50052>>>>>>>
50052>>>>>>>    // Field_Defaults:
50052>>>>>>>    // This procedure is used to establish default field values.
50052>>>>>>>
50052>>>>>>>    Procedure Field_Defaults
50053>>>>>>>        Forward Send Field_Defaults
50055>>>>>>>        //DDB-Generated-Code-Location
50055>>>>>>>        //DDB-FieldDefaultStart
50055>>>>>>>        //DDB-FieldDefaultEnd
50055>>>>>>>    End_Procedure    // Field_Defaults
50056>>>>>>>
50056>>>>>>>End_Class    // Hmgio_DataDictionary
50057>>>>>>>//DDB-Selection-pkg-Start
50057>>>>>>>
50057>>>>>>>Use Hmgio.SL         // Hmgio
50057>>>>>>>
50057>>>>>>>//DDB-Selection-pkg-End
50057>>>>>>>//DDB-FileEnd
50057>>>>>
50057>>>>>//AB-IgnoreEnd
50057>>>>>
50057>>>>>Object Hmgio is a dbModalPanelSub
50059>>>>>
50059>>>>>    //AB-StoreTopStart
50059>>>>>    Property String psModule Public ''
50061>>>>>    
50061>>>>>    //AB-StoreTopEnd
50061>>>>>
50061>>>>>    Set Label to "†£œ¨¦¢æš ˜"
50062>>>>>    Set Size to 200 297
50063>>>>>    Set Location to 4 5
50064>>>>>    Set Exit_Application_Local_State to FALSE
50065>>>>>    Set Modal_State to FALSE
50066>>>>>
50066>>>>>    //AB-DDOStart
50066>>>>>
50066>>>>>    Object Hmgio_DD is a Hmgio_DataDictionary
50068>>>>>
50068>>>>>        //AB-StoreStart
50068>>>>>        Function fiEggrafh_OK Returns Integer
50070>>>>>            Integer rVal
50071>>>>>            String sModule
50071>>>>>            Get psModule to sModule
50072>>>>>            If ((hmgio.Hmgio_Module=smodule) Or (hmgio.Hmgio_Module='04')) Move 1 to rVal
50075>>>>>            Function_Return rVal
50076>>>>>        End_Function
50077>>>>>        
50077>>>>>        Begin_Constraints
50079>>>>>             Constrain hmgio as (fiEggrafh_OK(Self)=1)
50080>>>>>        End_Constraints
50083>>>>>        
50083>>>>>        
50083>>>>>        
50083>>>>>        
50083>>>>>        
50083>>>>>        //AB-StoreEnd
50083>>>>>
50083>>>>>    End_Object    // Hmgio_DD
50084>>>>>
50084>>>>>    Set Main_DD to (Hmgio_DD(self))
50085>>>>>    Set Server to (Hmgio_DD(self))
50086>>>>>
50086>>>>>    //AB-DDOEnd
50086>>>>>
50086>>>>>    Object oSelList is a dbListSub
50088>>>>>        Set Main_File to Hmgio.File_Number
50089>>>>>        Set Size to 161 280
50090>>>>>        Set Location to 6 6
50091>>>>>        Set Auto_Index_State to FALSE
50092>>>>>
50092>>>>>        Begin_Row
50095>>>>>            Entry_Item Hmgio.Hmgio_code
50096>>>>>            Entry_Item Hmgio.Hmgio_descr
50097>>>>>        End_Row
50102>>>>>
50102>>>>>        Set Form_Width    item 0 to 84
50103>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
50104>>>>>        
50104>>>>>        Set Form_Width    item 1 to 188
50105>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
50106>>>>>        
50106>>>>>
50106>>>>>        //AB-StoreStart
50106>>>>>                                    
50106>>>>>        Procedure Activate
50108>>>>>            Forward Send Activate
50110>>>>>            Send Rebuild_Constraints to Hmgio_DD
50111>>>>>            Send Beginning_Of_Data to oSelList True
50112>>>>>        End_Procedure
50113>>>>>        
50113>>>>>        //AB-StoreEnd
50113>>>>>
50113>>>>>    End_Object    // oSelList
50114>>>>>
50114>>>>>    Object oOK_bn is a ButtonSub
50116>>>>>        Set Label to "&„§ ¢¦šã"
50117>>>>>        Set Location to 169 131
50118>>>>>
50118>>>>>        //AB-StoreStart
50118>>>>>        Procedure OnClick
50120>>>>>            Send OK To (oSelList(current_object))
50121>>>>>        End_Procedure
50122>>>>>        //AB-StoreEnd
50122>>>>>
50122>>>>>    End_Object    // oOK_bn
50123>>>>>
50123>>>>>    Object oCancel_bn is a ButtonSub
50125>>>>>        Set Label to "&€¡ç¨à©ž"
50126>>>>>        Set Location to 169 185
50127>>>>>
50127>>>>>        //AB-StoreStart
50127>>>>>        Procedure OnClick
50129>>>>>            Send Cancel To (oSelList(current_object))
50130>>>>>        End_Procedure
50131>>>>>        //AB-StoreEnd
50131>>>>>
50131>>>>>    End_Object    // oCancel_bn
50132>>>>>
50132>>>>>    Object oSearch_bn is a ButtonSub
50134>>>>>        Set Label to "€&¤˜ã«ž©ž"
50135>>>>>        Set Location to 169 241
50136>>>>>
50136>>>>>        //AB-StoreStart
50136>>>>>        Procedure OnClick
50138>>>>>            Send Search To (oSelList(current_object))
50139>>>>>        End_Procedure
50140>>>>>        //AB-StoreEnd
50140>>>>>
50140>>>>>    End_Object    // oSearch_bn
50141>>>>>
50141>>>>>
50141>>>>>    //AB-StoreStart
50141>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
50142>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
50143>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
50144>>>>>    
50144>>>>>    //AB-StoreEnd
50144>>>>>
50144>>>>>End_Object    // Hmgio
50145>>>>>
50145>>>>>//AB/ End_Object    // prj
50145>>>Use Hmgiow.sl
INCLUDING FILE: HMGIOW.SL
50145>>>>>//AB/ Project HmgioW:Lookup
50145>>>>>//AB/     Object prj is a Lookup_Project
50145>>>>>//AB/         Set ProjectName to "HmgioW:Lookup"
50145>>>>>//AB/         Set ProjectFileName to "HmgioW.SL"
50145>>>>>//AB/         Set GenerateFileName to "NONAME"
50145>>>>>
50145>>>>>// Project Object Structure
50145>>>>>//   HmgioW is a dbModalPanelSub
50145>>>>>//     Hmgiow_DD is a DataDictionary
50145>>>>>//     oSelList is a dbListSub
50145>>>>>//     oOK_bn is a ButtonSub
50145>>>>>//     oCancel_bn is a ButtonSub
50145>>>>>//     oSearch_bn is a ButtonSub
50145>>>>>
50145>>>>>// Register all objects
50145>>>>>Register_Object HmgioW
50145>>>>>Register_Object Hmgiow_DD
50145>>>>>Register_Object oCancel_bn
50145>>>>>Register_Object oOK_bn
50145>>>>>Register_Object oSearch_bn
50145>>>>>Register_Object oSelList
50145>>>>>
50145>>>>>
50145>>>>>    //AB-IgnoreStart
50145>>>>>
50145>>>>>    Use DFAllEnt.pkg
50145>>>>>    Use dbList.Sub
50145>>>>>    Use Button.Sub
50145>>>>>
50145>>>>>
50145>>>>>    Use HMGIOW.DD
INCLUDING FILE: HMGIOW.DD
50145>>>>>>>//DDB-FileStart
50145>>>>>>>//DDB-HeaderStart
50145>>>>>>>
50145>>>>>>>// File Name : HMGIOW.DD
50145>>>>>>>// Class Name: Hmgiow_DataDictionary
50145>>>>>>>// Revision  : 3
50145>>>>>>>// Version   : 2
50145>>>>>>>
50145>>>>>>>Use  Windows           // Basic Definitions
50145>>>>>>>Use  DataDict          // DataDictionary Class Definition
50145>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
50145>>>>>>>
50145>>>>>>>Open Hmgiow
INCLUDING FILE: HMGIOW.FD
50147>>>>>>>Open Hmwtyp
50149>>>>>>>Open Sysrecw
50151>>>>>>>
50151>>>>>>>//DDB-HeaderEnd
50151>>>>>>>//DDB-ValidationStart
50151>>>>>>>
50151>>>>>>>Register_Object Hmgiow_Hmgiow_Module_VT
50151>>>>>>>
50151>>>>>>>Object Hmgiow_Hmgiow_Module_VT  is a CodeValidationTable
50153>>>>>>>    Set Type_Value        To "MODULE"
50154>>>>>>>    //DDB-ValidationCustomStart
50154>>>>>>>    //DDB-ValidationCustomEnd
50154>>>>>>>End_Object   // Hmgiow_Hmgiow_Module_VT
50155>>>>>>>//DDB-ValidationEnd
50155>>>>>>>//DDB-SelectionStart
50155>>>>>>>//DDB/ ExternalSelectionList HmgioW  HmgioW.SL
50155>>>>>>>Register_Object HmgioW
50155>>>>>>>//DDB-SelectionEnd
50155>>>>>>>
50155>>>>>>>Class Hmgiow_DataDictionary  is a DataDictionary_Sec
50156>>>>>>>
50156>>>>>>>    // Define_Fields:
50156>>>>>>>    // This procedure is used to set up all data-dictionary rules.
50156>>>>>>>
50156>>>>>>>    Procedure Define_Fields
50157>>>>>>>        Forward Send Define_Fields
50159>>>>>>>        //DDB-Generated-Code-Location
50159>>>>>>>        //DDB-DefineFieldStart
50159>>>>>>>
50159>>>>>>>        Set Main_File            To Hmgiow.File_Number
50160>>>>>>>        Set Cascade_Delete_State To FALSE
50161>>>>>>>
50161>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
50162>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
50163>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
50164>>>>>>>
50164>>>>>>>        // Child (Client) file structure................
50164>>>>>>>        Send Add_Client_File  Hmwtyp.File_Number
50165>>>>>>>
50165>>>>>>>        // External (System) file structure.............
50165>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
50166>>>>>>>
50166>>>>>>>        Define_Auto_Increment  Sysrecw.Hmgiow_Code  To Hmgiow.Hmgiow_Code
50169>>>>>>>
50169>>>>>>>        // Field-based properties.......................
50169>>>>>>>
50169>>>>>>>        // Hmgiow.Hmgiow_Code
50169>>>>>>>        Set Field_Options          Field Hmgiow.Hmgiow_Code To DD_AUTOFIND
50170>>>>>>>        Set Field_Prompt_Object    Field Hmgiow.Hmgiow_Code To (HmgioW(Self))
50171>>>>>>>
50171>>>>>>>        // Hmgiow.Hmgiow_Descr
50171>>>>>>>        Set Field_Options          Field Hmgiow.Hmgiow_Descr To DD_AUTOFIND
50172>>>>>>>        Set Field_Prompt_Object    Field Hmgiow.Hmgiow_Descr To (HmgioW(Self))
50173>>>>>>>
50173>>>>>>>        // Hmgiow.Hmgiow_Module
50173>>>>>>>        Set Field_Value_Table      Field Hmgiow.Hmgiow_Module To (Hmgiow_Hmgiow_Module_VT(Self))
50174>>>>>>>
50174>>>>>>>        //DDB-DefineFieldEnd
50174>>>>>>>    End_Procedure    // Define_Fields
50175>>>>>>>
50175>>>>>>>    // Field_Defaults:
50175>>>>>>>    // This procedure is used to establish default field values.
50175>>>>>>>
50175>>>>>>>    Procedure Field_Defaults
50176>>>>>>>        Forward Send Field_Defaults
50178>>>>>>>        //DDB-Generated-Code-Location
50178>>>>>>>        //DDB-FieldDefaultStart
50178>>>>>>>        //DDB-FieldDefaultEnd
50178>>>>>>>    End_Procedure    // Field_Defaults
50179>>>>>>>
50179>>>>>>>End_Class    // Hmgiow_DataDictionary
50180>>>>>>>//DDB-Selection-pkg-Start
50180>>>>>>>
50180>>>>>>>Use HmgioW.SL        // HmgioW
50180>>>>>>>
50180>>>>>>>//DDB-Selection-pkg-End
50180>>>>>>>//DDB-FileEnd
50180>>>>>    
50180>>>>>    //AB-IgnoreEnd
50180>>>>>
50180>>>>>    CD_Popup_Object HmgioW is a dbModalPanelSub
50199>>>>>
50199>>>>>        //AB-StoreTopStart
50199>>>>>        Property String psModule Public ''
50201>>>>>        
50201>>>>>        //AB-StoreTopEnd
50201>>>>>
50201>>>>>        set label to "†£œ¨¦¢æš ˜ €§¦Ÿã¡žª" 
50202>>>>>        Set Size to 148 297
50203>>>>>        Set Location to 5 9
50204>>>>>        Set Exit_Application_Local_State to FALSE
50205>>>>>        Set Modal_State to FALSE
50206>>>>>
50206>>>>>        //AB-DDOStart
50206>>>>>
50206>>>>>        Object Hmgiow_DD is a Hmgiow_DataDictionary
50208>>>>>        End_Object    // Hmgiow_DD
50209>>>>>
50209>>>>>        Set Main_DD to (Hmgiow_DD(self))
50210>>>>>        Set Server to (Hmgiow_DD(self))
50211>>>>>
50211>>>>>        //AB-DDOEnd
50211>>>>>
50211>>>>>        Object oSelList is a dbListSub
50213>>>>>            Set Main_File to Hmgiow.File_Number
50214>>>>>            Set Size to 105 280
50215>>>>>            Set Location to 6 6
50216>>>>>
50216>>>>>            Begin_Row
50219>>>>>                Entry_Item Hmgiow.Hmgiow_code
50220>>>>>                Entry_Item Hmgiow.Hmgiow_descr
50221>>>>>            End_Row
50226>>>>>
50226>>>>>            Set Form_Width    item 0 to 48
50227>>>>>            set header_label  item 0 to "‰à› ¡¦ª" 
50228>>>>>            
50228>>>>>            Set Form_Width    item 1 to 225
50229>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
50230>>>>>            
50230>>>>>        End_Object    // oSelList
50231>>>>>
50231>>>>>        Object oOK_bn is a ButtonSub
50233>>>>>            set label to "&„§ ¢¦šã" 
50234>>>>>            Set Location to 115 126
50235>>>>>
50235>>>>>            //AB-StoreStart
50235>>>>>            Procedure OnClick
50237>>>>>                Send OK To (oSelList(current_object))
50238>>>>>            End_Procedure
50239>>>>>            //AB-StoreEnd
50239>>>>>
50239>>>>>        End_Object    // oOK_bn
50240>>>>>
50240>>>>>        Object oCancel_bn is a ButtonSub
50242>>>>>            set label to "&€¡ç¨à©ž" 
50243>>>>>            Set Location to 115 181
50244>>>>>
50244>>>>>            //AB-StoreStart
50244>>>>>            Procedure OnClick
50246>>>>>                Send Cancel To (oSelList(current_object))
50247>>>>>            End_Procedure
50248>>>>>            //AB-StoreEnd
50248>>>>>
50248>>>>>        End_Object    // oCancel_bn
50249>>>>>
50249>>>>>        Object oSearch_bn is a ButtonSub
50251>>>>>            set label to "€&¤˜ã«ž©ž" 
50252>>>>>            Set Location to 115 236
50253>>>>>
50253>>>>>            //AB-StoreStart
50253>>>>>            Procedure OnClick
50255>>>>>                Send Search To (oSelList(current_object))
50256>>>>>            End_Procedure
50257>>>>>            //AB-StoreEnd
50257>>>>>
50257>>>>>        End_Object    // oSearch_bn
50258>>>>>
50258>>>>>
50258>>>>>        //AB-StoreStart
50258>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
50259>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
50260>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
50261>>>>>        
50261>>>>>        //AB-StoreEnd
50261>>>>>
50261>>>>>    CD_End_Object    // HmgioW
50263>>>>>>
50263>>>>>
50263>>>>>//AB/     End_Object    // prj
50263>>>Use Witemx.sl
INCLUDING FILE: WITEMX.SL
50263>>>>>//AB/ Project Witemx:Lookup Eidon Apothikhs
50263>>>>>//AB/     Object prj is a Lookup_Project
50263>>>>>//AB/         Set ProjectName to "Witemx:Lookup Eidon Apothikhs"
50263>>>>>//AB/         Set ProjectFileName to "Witemx.SL"
50263>>>>>//AB/         Set GenerateFileName to "NONAME"
50263>>>>>
50263>>>>>// Project Object Structure
50263>>>>>//   Witemx is a dbModalPanelSub
50263>>>>>//     Units_DD is a DataDictionary
50263>>>>>//     Witemkat_DD is a DataDictionary
50263>>>>>//     Item_DD is a DataDictionary
50263>>>>>//     Witemx_DD is a DataDictionary
50263>>>>>//     oSelList is a dbListSub
50263>>>>>//     oOK_bn is a ButtonSub
50263>>>>>//     oCancel_bn is a ButtonSub
50263>>>>>//     oSearch_bn is a ButtonSub
50263>>>>>
50263>>>>>// Register all objects
50263>>>>>Register_Object Item_DD
50263>>>>>Register_Object oCancel_bn
50263>>>>>Register_Object oOK_bn
50263>>>>>Register_Object oSearch_bn
50263>>>>>Register_Object oSelList
50263>>>>>Register_Object Units_DD
50263>>>>>Register_Object Witemkat_DD
50263>>>>>Register_Object Witemx
50263>>>>>Register_Object Witemx_DD
50263>>>>>
50263>>>>>
50263>>>>>    //AB-IgnoreStart
50263>>>>>
50263>>>>>    Use DFAllEnt.pkg
50263>>>>>    Use dbList.Sub
50263>>>>>    Use Button.Sub
50263>>>>>
50263>>>>>
50263>>>>>    Use UNITS.DD
50263>>>>>    Use WITEMKAT.DD
50263>>>>>    Use ITEM.DD
50263>>>>>    Use WITEMX.DD
50263>>>>>    
50263>>>>>    //AB-IgnoreEnd
50263>>>>>
50263>>>>>    CD_Popup_Object Witemx is a dbModalPanelSub
50282>>>>>        set label to "„ ›ž / Witemx" 
50283>>>>>        Set Size to 148 503
50284>>>>>        Set Location to 4 5
50285>>>>>        Set Exit_Application_Local_State to FALSE
50286>>>>>        Set Modal_State to FALSE
50287>>>>>
50287>>>>>        //AB-DDOStart
50287>>>>>
50287>>>>>        Object Units_DD is a Units_DataDictionary
50289>>>>>        End_Object    // Units_DD
50290>>>>>
50290>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
50292>>>>>        End_Object    // Witemkat_DD
50293>>>>>
50293>>>>>        Object Item_DD is a Item_DataDictionary
50295>>>>>            Set DDO_Server to (Units_DD(self))
50296>>>>>            Set DDO_Server to (Witemkat_DD(self))
50297>>>>>        End_Object    // Item_DD
50298>>>>>
50298>>>>>        Object Witemx_DD is a Witemx_DataDictionary
50300>>>>>            Set DDO_Server to (Item_DD(self))
50301>>>>>        End_Object    // Witemx_DD
50302>>>>>
50302>>>>>        Set Main_DD to (Witemx_DD(self))
50303>>>>>        Set Server to (Witemx_DD(self))
50304>>>>>
50304>>>>>        //AB-DDOEnd
50304>>>>>
50304>>>>>        Object oSelList is a dbListSub
50306>>>>>            Set Main_File to Witemx.File_Number
50307>>>>>            Set Size to 105 488
50308>>>>>            Set Location to 6 6
50309>>>>>
50309>>>>>            Begin_Row
50312>>>>>                Entry_Item Witemx.Witemx_recr
50313>>>>>                Entry_Item Witemx.Witemx_code
50314>>>>>                Entry_Item Witemx.Witemx_descr
50315>>>>>                entry_item units.units_descr 
50316>>>>>                Entry_Item Witemkat.Witemkat_descr
50317>>>>>                Entry_Item Item.Item_descr
50318>>>>>            End_Row
50323>>>>>
50323>>>>>            Set Form_Width    item 0 to 43
50324>>>>>            Set Header_Label  item 0 to "Recr"
50325>>>>>            
50325>>>>>            Set Form_Width    item 1 to 43
50326>>>>>            set header_label  item 1 to "‰à› ¡¦ª" 
50327>>>>>            
50327>>>>>            Set Form_Width    item 2 to 176
50328>>>>>            set header_label  item 2 to "œ¨ š¨˜­ã" 
50329>>>>>            
50329>>>>>            Set Form_Width    item 3 to 46
50330>>>>>            set header_label  item 3 to "‹/‹" 
50331>>>>>            
50331>>>>>            Set Form_Width    item 4 to 104
50332>>>>>            set header_label  item 4 to "‰˜«žš¦¨å˜   :" 
50333>>>>>            
50333>>>>>            Set Form_Width    item 5 to 69
50334>>>>>            set header_label  item 5 to "„ ›¦ª" 
50335>>>>>            
50335>>>>>        End_Object    // oSelList
50336>>>>>
50336>>>>>        Object oOK_bn is a ButtonSub
50338>>>>>            set label to "&„§ ¢¦šã" 
50339>>>>>            Set Location to 113 335
50340>>>>>
50340>>>>>            //AB-StoreStart
50340>>>>>            Procedure OnClick
50342>>>>>                Send OK To (oSelList(current_object))
50343>>>>>            End_Procedure
50344>>>>>            //AB-StoreEnd
50344>>>>>
50344>>>>>        End_Object    // oOK_bn
50345>>>>>
50345>>>>>        Object oCancel_bn is a ButtonSub
50347>>>>>            set label to "&€¡ç¨à©ž" 
50348>>>>>            Set Location to 113 390
50349>>>>>
50349>>>>>            //AB-StoreStart
50349>>>>>            Procedure OnClick
50351>>>>>                Send Cancel To (oSelList(current_object))
50352>>>>>            End_Procedure
50353>>>>>            //AB-StoreEnd
50353>>>>>
50353>>>>>        End_Object    // oCancel_bn
50354>>>>>
50354>>>>>        Object oSearch_bn is a ButtonSub
50356>>>>>            set label to "€&¤˜ã«ž©ž" 
50357>>>>>            Set Location to 113 445
50358>>>>>
50358>>>>>            //AB-StoreStart
50358>>>>>            Procedure OnClick
50360>>>>>                Send Search To (oSelList(current_object))
50361>>>>>            End_Procedure
50362>>>>>            //AB-StoreEnd
50362>>>>>
50362>>>>>        End_Object    // oSearch_bn
50363>>>>>
50363>>>>>
50363>>>>>        //AB-StoreStart
50363>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
50364>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
50365>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
50366>>>>>        //AB-StoreEnd
50366>>>>>
50366>>>>>    CD_End_Object    // Witemx
50368>>>>>>
50368>>>>>
50368>>>>>//AB/     End_Object    // prj
50368>>>Use Cities.sl
INCLUDING FILE: CITIES.SL
50368>>>>>//AB/ Project Cities:lookup
50368>>>>>//AB/ Object prj is a Lookup_Project
50368>>>>>//AB/     Set ProjectName to "Cities:lookup"
50368>>>>>//AB/     Set ProjectFileName to "Cities.SL"
50368>>>>>//AB/     Set GenerateFileName to "NONAME"
50368>>>>>
50368>>>>>// Project Object Structure
50368>>>>>//   Cities is a dbModalPanelSub
50368>>>>>//     Cities_DD is a DataDictionary
50368>>>>>//     oSelList is a dbListSub
50368>>>>>//     oOK_bn is a ButtonSub
50368>>>>>//     oCancel_bn is a ButtonSub
50368>>>>>//     oSearch_bn is a ButtonSub
50368>>>>>
50368>>>>>// Register all objects
50368>>>>>Register_Object Cities
50368>>>>>Register_Object Cities_DD
50368>>>>>Register_Object oCancel_bn
50368>>>>>Register_Object oOK_bn
50368>>>>>Register_Object oSearch_bn
50368>>>>>Register_Object oSelList
50368>>>>>
50368>>>>>
50368>>>>>//AB-IgnoreStart
50368>>>>>
50368>>>>>Use DFAllEnt.pkg
50368>>>>>Use dbList.Sub
50368>>>>>Use Button.Sub
50368>>>>>
50368>>>>>
50368>>>>>Use CITIES.DD
50368>>>>>
50368>>>>>//AB-IgnoreEnd
50368>>>>>
50368>>>>>CD_Popup_Object Cities is a dbModalPanelSub
50387>>>>>    Set Label to "Cities"
50388>>>>>    Set Size to 148 297
50389>>>>>    Set Location to 4 5
50390>>>>>    Set Exit_Application_Local_State to FALSE
50391>>>>>    Set Modal_State to FALSE
50392>>>>>
50392>>>>>    //AB-DDOStart
50392>>>>>
50392>>>>>    Object Cities_DD is a Cities_DataDictionary
50394>>>>>    End_Object    // Cities_DD
50395>>>>>
50395>>>>>    Set Main_DD to (Cities_DD(self))
50396>>>>>    Set Server to (Cities_DD(self))
50397>>>>>
50397>>>>>    //AB-DDOEnd
50397>>>>>
50397>>>>>    Object oSelList is a dbListSub
50399>>>>>        Set Main_File to Cities.File_Number
50400>>>>>        Set Size to 105 280
50401>>>>>        Set Location to 6 6
50402>>>>>
50402>>>>>        Begin_Row
50405>>>>>            Entry_Item Cities.City_id
50406>>>>>            Entry_Item Cities.City_descr
50407>>>>>        End_Row
50412>>>>>
50412>>>>>        Set Form_Width    item 0 to 52
50413>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
50414>>>>>        
50414>>>>>        Set Form_Width    item 1 to 221
50415>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
50416>>>>>        
50416>>>>>    End_Object    // oSelList
50417>>>>>
50417>>>>>    Object oOK_bn is a ButtonSub
50419>>>>>        set label to "&„§ ¢¦šã" 
50420>>>>>        Set Location to 115 126
50421>>>>>
50421>>>>>        //AB-StoreStart
50421>>>>>        Procedure OnClick
50423>>>>>            Send OK To (oSelList(current_object))
50424>>>>>        End_Procedure
50425>>>>>        //AB-StoreEnd
50425>>>>>
50425>>>>>    End_Object    // oOK_bn
50426>>>>>
50426>>>>>    Object oCancel_bn is a ButtonSub
50428>>>>>        set label to "&€¡ç¨à©ž" 
50429>>>>>        Set Location to 115 181
50430>>>>>
50430>>>>>        //AB-StoreStart
50430>>>>>        Procedure OnClick
50432>>>>>            Send Cancel To (oSelList(current_object))
50433>>>>>        End_Procedure
50434>>>>>        //AB-StoreEnd
50434>>>>>
50434>>>>>    End_Object    // oCancel_bn
50435>>>>>
50435>>>>>    Object oSearch_bn is a ButtonSub
50437>>>>>        set label to "€&¤˜ã«ž©ž" 
50438>>>>>        Set Location to 115 236
50439>>>>>
50439>>>>>        //AB-StoreStart
50439>>>>>        Procedure OnClick
50441>>>>>            Send Search To (oSelList(current_object))
50442>>>>>        End_Procedure
50443>>>>>        //AB-StoreEnd
50443>>>>>
50443>>>>>    End_Object    // oSearch_bn
50444>>>>>
50444>>>>>
50444>>>>>    //AB-StoreStart
50444>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
50445>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
50446>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
50447>>>>>    //AB-StoreEnd
50447>>>>>
50447>>>>>CD_End_Object    // Cities
50449>>>>>>
50449>>>>>
50449>>>>>//AB/ End_Object    // prj
50449>>>Use constrCn.sl
INCLUDING FILE: CONSTRCN.SL
50449>>>>>//AB/ Project CONSTRCN:LOOKUP
50449>>>>>//AB/ Object prj is a Lookup_Project
50449>>>>>//AB/     Set ProjectName to "CONSTRCN:LOOKUP"
50449>>>>>//AB/     Set ProjectFileName to "CONSTRCN.SL"
50449>>>>>
50449>>>>>// Project Object Structure
50449>>>>>//   CONSTRCN is a dbModalPanelSub
50449>>>>>//     Constrct_DD is a DataDictionary
50449>>>>>//     oSelList is a dbListSub
50449>>>>>//     oOK_bn is a ButtonSub
50449>>>>>//     oCancel_bn is a ButtonSub
50449>>>>>//     oSearch_bn is a ButtonSub
50449>>>>>
50449>>>>>// Register all objects
50449>>>>>Register_Object CONSTRCN
50449>>>>>Register_Object Constrct_DD
50449>>>>>Register_Object oCancel_bn
50449>>>>>Register_Object oOK_bn
50449>>>>>Register_Object oSearch_bn
50449>>>>>Register_Object oSelList
50449>>>>>
50449>>>>>
50449>>>>>//AB-IgnoreStart
50449>>>>>
50449>>>>>Use DFAllEnt.pkg
50449>>>>>Use dbList.Sub
50449>>>>>Use Button.Sub
50449>>>>>
50449>>>>>
50449>>>>>Use CONSTRCT.DD
50449>>>>>
50449>>>>>//AB-IgnoreEnd
50449>>>>>
50449>>>>>CD_Popup_Object CONSTRCN is a dbModalPanelSub
50468>>>>>    Set Label to "Constructors"
50469>>>>>    Set Size to 148 423
50470>>>>>    Set Location to 6 6
50471>>>>>    Set Exit_Application_Local_State to FALSE
50472>>>>>    Set Modal_State to FALSE
50473>>>>>
50473>>>>>    //AB-DDOStart
50473>>>>>
50473>>>>>    Object Constrct_DD is a Constrct_DataDictionary
50475>>>>>    End_Object    // Constrct_DD
50476>>>>>
50476>>>>>    Set Main_DD to (Constrct_DD(self))
50477>>>>>    Set Server to (Constrct_DD(self))
50478>>>>>
50478>>>>>    //AB-DDOEnd
50478>>>>>
50478>>>>>    Object oSelList is a dbListSub
50480>>>>>        Set Main_File to Constrct.File_Number
50481>>>>>        Set Size to 105 406
50482>>>>>        Set Location to 6 6
50483>>>>>
50483>>>>>        Begin_Row
50486>>>>>            Entry_Item Constrct.Cnt_id
50487>>>>>            Entry_Item Constrct.Cnt_name
50488>>>>>            Entry_Item Constrct.Cnt_phone
50489>>>>>        End_Row
50494>>>>>
50494>>>>>        Set Form_Width    item 0 to 59
50495>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
50496>>>>>        
50496>>>>>        Set Form_Width    item 1 to 189
50497>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
50498>>>>>        
50498>>>>>        Set Form_Width    item 2 to 151
50499>>>>>        Set Header_Label  item 2 to "’ž¢â­à¤˜"
50500>>>>>        
50500>>>>>    End_Object    // oSelList
50501>>>>>
50501>>>>>    Object oOK_bn is a ButtonSub
50503>>>>>        Set Label to "&„§ ¢¦šã"
50504>>>>>        Set Location to 114 253
50505>>>>>
50505>>>>>        //AB-StoreStart
50505>>>>>        Procedure OnClick
50507>>>>>            Send OK To (oSelList(current_object))
50508>>>>>        End_Procedure
50509>>>>>        //AB-StoreEnd
50509>>>>>
50509>>>>>    End_Object    // oOK_bn
50510>>>>>
50510>>>>>    Object oCancel_bn is a ButtonSub
50512>>>>>        Set Label to "&€¡ç¨à©ž"
50513>>>>>        Set Location to 114 307
50514>>>>>
50514>>>>>        //AB-StoreStart
50514>>>>>        Procedure OnClick
50516>>>>>            Send Cancel To (oSelList(current_object))
50517>>>>>        End_Procedure
50518>>>>>        //AB-StoreEnd
50518>>>>>
50518>>>>>    End_Object    // oCancel_bn
50519>>>>>
50519>>>>>    Object oSearch_bn is a ButtonSub
50521>>>>>        Set Label to "€&¤˜ã«ž©ž"
50522>>>>>        Set Location to 114 363
50523>>>>>
50523>>>>>        //AB-StoreStart
50523>>>>>        Procedure OnClick
50525>>>>>            Send Search To (oSelList(current_object))
50526>>>>>        End_Procedure
50527>>>>>        //AB-StoreEnd
50527>>>>>
50527>>>>>    End_Object    // oSearch_bn
50528>>>>>
50528>>>>>
50528>>>>>    //AB-StoreStart
50528>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
50529>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
50530>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
50531>>>>>    //AB-StoreEnd
50531>>>>>
50531>>>>>CD_End_Object    // CONSTRCN
50533>>>>>>
50533>>>>>
50533>>>>>//AB/ End_Object    // prj
50533>>>
50533>>>
50533>        use v3.vw
INCLUDING FILE: V3.VW
50533>>>//AB/ Project V3:ETAIREIES
50533>>>//AB/     Object prj is a View_Project
50533>>>//AB/         Set ProjectName to "V3:ETAIREIES"
50533>>>//AB/         Set ProjectFileName to "V3.vw"
50533>>>
50533>>>// Project Object Structure
50533>>>//   V3 is a dbViewSub
50533>>>//     sysrecc is a sysrecc_DataDictionary
50533>>>//     Company_DDF2 is a Company_DataDictionary
50533>>>//     Branch_DDF2 is a Branch_DataDictionary
50533>>>//     Year_DDF2 is a Year_DataDictionary
50533>>>//     Company_DDR is a Company_DataDictionary
50533>>>//     Branch_DDR is a Branch_DataDictionary
50533>>>//     Year_DDR is a Year_DataDictionary
50533>>>//     Ctypkin_DDR is a Ctypkin_DataDictionary
50533>>>//     Cflagkin_DDR is a Cflagkin_DataDictionary
50533>>>//     Ctypkin_DDW is a Ctypkin_DataDictionary
50533>>>//     Cflagkin_DDW is a Cflagkin_DataDictionary
50533>>>//     Btypkin_DDR is a Btypkin_DataDictionary
50533>>>//     Bflagkin_DDR is a Bflagkin_DataDictionary
50533>>>//     Btypkin_DDW is a Btypkin_DataDictionary
50533>>>//     Bflagkin_DDW is a Bflagkin_DataDictionary
50533>>>//     Wtypkin_DDR is a Wtypkin_DataDictionary
50533>>>//     Wtypkin_DDW is a Wtypkin_DataDictionary
50533>>>//     Wflagkin_DDW is a Wflagkin_DataDictionary
50533>>>//     Wflagkin_DDR is a Wflagkin_DataDictionary
50533>>>//     Clients_DDR is a Clients_DataDictionary
50533>>>//     CN_DDR is a CN_DataDictionary
50533>>>//     Clients_DDW is a Clients_DataDictionary
50533>>>//     CN_DDW is a CN_DataDictionary
50533>>>//     BaxioKat_DDR is a BaxioKat_DataDictionary
50533>>>//     BaxioKat_DDW is a BaxioKat_DataDictionary
50533>>>//     Baxio_DDR is a Baxio_DataDictionary
50533>>>//     Baxio_DDW is a Baxio_DataDictionary
50533>>>//     Wapokat_DDW is a Wapokat_DataDictionary
50533>>>//     Wapomast_DDW is a Wapomast_DataDictionary
50533>>>//     Wax_DDW is a Wax_DataDictionary
50533>>>//     Wapokat_DDR is a Wapokat_DataDictionary
50533>>>//     Wapomast_DDR is a Wapomast_DataDictionary
50533>>>//     Wax_DDR is a Wax_DataDictionary
50533>>>//     Fpa_DDR is a Fpa_DataDictionary
50533>>>//     Fpa_DDW is a Fpa_DataDictionary
50533>>>//     Witemkat_DDR is a Witemkat_DataDictionary
50533>>>//     Units_DDR is a Units_DataDictionary
50533>>>//     Item_DDR is a Item_DataDictionary
50533>>>//     Witemx_DDR is a Witemx_DataDictionary
50533>>>//     Witemxt_DDR is a Witemxt_DataDictionary
50533>>>//     Witemkat_DDW is a Witemkat_DataDictionary
50533>>>//     Units_DDW is a Units_DataDictionary
50533>>>//     Item_DDW is a Item_DataDictionary
50533>>>//     Witemx_DDW is a Witemx_DataDictionary
50533>>>//     Hmgio_DDR is a Hmgio_DataDictionary
50533>>>//     Hmgio_DDW is a Hmgio_DataDictionary
50533>>>//     HmgioW_DDR is a HmgioW_DataDictionary
50533>>>//     HmgioW_DDW is a HmgioW_DataDictionary
50533>>>//     Witemxt_DDW is a Witemxt_DataDictionary
50533>>>//     HmCtyp_DDR is a HmCtyp_DataDictionary
50533>>>//     HmCtyp_DDW is a HmCtyp_DataDictionary
50533>>>//     HmWtyp_DDR is a HmWtyp_DataDictionary
50533>>>//     HmWtyp_DDW is a HmWtyp_DataDictionary
50533>>>//     Ptyppar_DDR is a Ptyppar_DataDictionary
50533>>>//     Ptyppar_DDW is a Ptyppar_DataDictionary
50533>>>//     ptypmet_DDW is a ptypmet_DataDictionary
50533>>>//     ptypmet_DDR is a ptypmet_DataDictionary
50533>>>//     Pseira_DDW is a Pseira_DataDictionary
50533>>>//     Pseira_DDR is a Pseira_DataDictionary
50533>>>//     BkinKat_DDR is a BkinKat_DataDictionary
50533>>>//     BkinKat_DDW is a BkinKat_DataDictionary
50533>>>//     Country_DD2 is a Country_DataDictionary
50533>>>//     Towns_DD2 is a Towns_DataDictionary
50533>>>//     Cities_DD2 is a Cities_DataDictionary
50533>>>//     Areas_DD2 is a Areas_DataDictionary
50533>>>//     Payresp_DD2 is a Payresp_DataDictionary
50533>>>//     Clients_DD2 is a Clients_DataDictionary
50533>>>//     Clorder_DD is a Clorder_DataDictionary
50533>>>//     Clorderd_DD is a Clorderd_DataDictionary
50533>>>//     Clorder_DD2 is a Clorder_DataDictionary
50533>>>//     Clorderd_DD2 is a Clorderd_DataDictionary
50533>>>//     Company_DD is a DataDictionary
50533>>>//     Branch_DD is a DataDictionary
50533>>>//     Year_DD is a DataDictionary
50533>>>//     Ctypkin_DD is a DataDictionary
50533>>>//     Cflagkin_DD is a DataDictionary
50533>>>//     Syscurxr_DD is a DataDictionary
50533>>>//     Company_Company_Code is a dbFormSub
50533>>>//     Company_Company_Name is a dbFormSub
50533>>>//     Company_Logo is a dbFormSub
50533>>>//     dbTabDialogSub1 is a dbTabDialogSub
50533>>>//       TP_db1 is a dbTabPage
50533>>>//         Company_Company_Afm is a dbFormSub
50533>>>//         Company_Company_Addr is a dbFormSub
50533>>>//         Company_Company_Doy is a dbComboFormSub
50533>>>//         Company_Company_J_Code is a dbComboFormSub
50533>>>//         Company_Company_Tk is a dbFormSub
50533>>>//         Company_Company_Poli is a dbFormSub
50533>>>//         Company_Company_Tel is a dbFormSub
50533>>>//         Company_Company_Fax is a dbFormSub
50533>>>//         Company_Company_Email is a dbFormSub
50533>>>//         Company_Company_Resp is a dbFormSub
50533>>>//         TextBoxSub3 is a TextBoxSub
50533>>>//         TextBoxSub4 is a TextBoxSub
50533>>>//         TextBoxSub5 is a TextBoxSub
50533>>>//         TextBoxSub6 is a TextBoxSub
50533>>>//         TextBoxSub7 is a TextBoxSub
50533>>>//         TextBoxSub8 is a TextBoxSub
50533>>>//         TextBoxSub9 is a TextBoxSub
50533>>>//         TextBoxSub10 is a TextBoxSub
50533>>>//         TextBoxSub14 is a TextBoxSub
50533>>>//         Textbox1 is a Textbox
50533>>>//         TextBoxSub49 is a TextBoxSub
50533>>>//         Company_Sap_Code is a dbFormSub
50533>>>//       TP_db2 is a dbTabPage
50533>>>//         Branch_table is a dbGridSub
50533>>>//         TextBoxSub34 is a TextBoxSub
50533>>>//         branch_branch_Afm is a dbFormSub
50533>>>//         TextBoxSub35 is a TextBoxSub
50533>>>//         branch_branch_Doy is a dbComboFormSub
50533>>>//         TextBoxSub36 is a TextBoxSub
50533>>>//         branch_branch_Addr is a dbFormSub
50533>>>//         TextBoxSub37 is a TextBoxSub
50533>>>//         branch_branch_Tk is a dbFormSub
50533>>>//         TextBoxSub38 is a TextBoxSub
50533>>>//         branch_branch_Poli is a dbFormSub
50533>>>//         TextBoxSub39 is a TextBoxSub
50533>>>//         branch_branch_Tel is a dbFormSub
50533>>>//         TextBoxSub40 is a TextBoxSub
50533>>>//         branch_branch_Fax is a dbFormSub
50533>>>//         TextBoxSub41 is a TextBoxSub
50533>>>//         branch_branch_Email is a dbFormSub
50533>>>//         TextBoxSub42 is a TextBoxSub
50533>>>//         branch_branch_Resp is a dbFormSub
50533>>>//         Branch_Path_Exp is a dbFormSub
50533>>>//         Branch_Exp_Txtname is a dbFormSub
50533>>>//         TextBoxSub45 is a TextBoxSub
50533>>>//         TextBoxSub46 is a TextBoxSub
50533>>>//         Branch_Send_Phone is a dbFormSub
50533>>>//         Branch_Ras_Name is a dbFormSub
50533>>>//         Branch_Ras_Passw is a dbFormSub
50533>>>//         Branch_Ras_Domain is a dbFormSub
50533>>>//         TextBoxSub47 is a TextBoxSub
50533>>>//         Branch_Entolh is a dbFormSub
50533>>>//         TextBoxSub48 is a TextBoxSub
50533>>>//         Branch_Paragogh is a dbFormSub
50533>>>//         Branch_Locked_Until is a dbFormSub
50533>>>//         TextBoxSub50 is a TextBoxSub
50533>>>//         Branch_Sap_Code is a dbFormSub
50533>>>//       dbTabPageSub3 is a dbTabPageSub
50533>>>//         The_Table is a dbGrid
50533>>>//         TextBoxSub24 is a TextBoxSub
50533>>>//         chkPtyppar is a CheckBoxSub
50533>>>//         chkForce is a CheckBoxSub
50533>>>//         txtM1 is a TextBoxSub
50533>>>//         txtM2 is a TextBoxSub
50533>>>//         chkWitemx is a CheckBoxSub
50533>>>//         chkWax is a CheckBoxSub
50533>>>//         chkBaxio is a CheckBoxSub
50533>>>//         TextBoxSub32 is a TextBoxSub
50533>>>//         Company_Company_Code is a dbFormSub
50533>>>//         TextBoxSub33 is a TextBoxSub
50533>>>//         Company_Company_Name is a dbFormSub
50533>>>//         chkclorder is a CheckBoxSub
50533>>>//         chkptypmet is a CheckBoxSub
50533>>>//         frmOtherYear is a dbFormSub
50533>>>//         Company_Company_Name is a dbFormSub
50533>>>//         Branch_Branch_Name is a dbFormSub
50533>>>//         Year_Year_Year is a dbFormSub
50533>>>//         TextBoxSub44 is a TextBoxSub
50533>>>//     TextBoxSub1 is a TextBoxSub
50533>>>//     TextBoxSub2 is a TextBoxSub
50533>>>//     dbBitmap3 is a dbBitmap
50533>>>//     TextBoxSub43 is a TextBoxSub
50533>>>
50533>>>// Register all objects
50533>>>Register_Object Areas_DD2
50533>>>Register_Object Baxio_DDR
50533>>>Register_Object Baxio_DDW
50533>>>Register_Object BaxioKat_DDR
50533>>>Register_Object BaxioKat_DDW
50533>>>Register_Object Bflagkin_DDR
50533>>>Register_Object Bflagkin_DDW
50533>>>Register_Object BkinKat_DDR
50533>>>Register_Object BkinKat_DDW
50533>>>Register_Object Branch_Branch_Name
50533>>>Register_Object Branch_DD
50533>>>Register_Object Branch_DDF2
50533>>>Register_Object Branch_DDR
50533>>>Register_Object Branch_Entolh
50533>>>Register_Object Branch_Exp_Txtname
50533>>>Register_Object Branch_Locked_Until
50533>>>Register_Object Branch_Paragogh
50533>>>Register_Object Branch_Path_Exp
50533>>>Register_Object Branch_Ras_Domain
50533>>>Register_Object Branch_Ras_Name
50533>>>Register_Object Branch_Ras_Passw
50533>>>Register_Object Branch_Sap_Code
50533>>>Register_Object Branch_Send_Phone
50533>>>Register_Object Branch_table
50533>>>Register_Object Btypkin_DDR
50533>>>Register_Object Btypkin_DDW
50533>>>Register_Object branch_branch_Addr
50533>>>Register_Object branch_branch_Afm
50533>>>Register_Object branch_branch_Doy
50533>>>Register_Object branch_branch_Email
50533>>>Register_Object branch_branch_Fax
50533>>>Register_Object branch_branch_Poli
50533>>>Register_Object branch_branch_Resp
50533>>>Register_Object branch_branch_Tel
50533>>>Register_Object branch_branch_Tk
50533>>>Register_Object Cflagkin_DD
50533>>>Register_Object Cflagkin_DDR
50533>>>Register_Object Cflagkin_DDW
50533>>>Register_Object Cities_DD2
50533>>>Register_Object Clients_DD2
50533>>>Register_Object Clients_DDR
50533>>>Register_Object Clients_DDW
50533>>>Register_Object Clorder_DD
50533>>>Register_Object Clorder_DD2
50533>>>Register_Object Clorderd_DD
50533>>>Register_Object Clorderd_DD2
50533>>>Register_Object CN_DDR
50533>>>Register_Object CN_DDW
50533>>>Register_Object Company_Company_Addr
50533>>>Register_Object Company_Company_Afm
50533>>>Register_Object Company_Company_Code
50533>>>Register_Object Company_Company_Doy
50533>>>Register_Object Company_Company_Email
50533>>>Register_Object Company_Company_Fax
50533>>>Register_Object Company_Company_J_Code
50533>>>Register_Object Company_Company_Name
50533>>>Register_Object Company_Company_Poli
50533>>>Register_Object Company_Company_Resp
50533>>>Register_Object Company_Company_Tel
50533>>>Register_Object Company_Company_Tk
50533>>>Register_Object Company_DD
50533>>>Register_Object Company_DDF2
50533>>>Register_Object Company_DDR
50533>>>Register_Object Company_Logo
50533>>>Register_Object Company_Sap_Code
50533>>>Register_Object Country_DD2
50533>>>Register_Object Ctypkin_DD
50533>>>Register_Object Ctypkin_DDR
50533>>>Register_Object Ctypkin_DDW
50533>>>Register_Object chkBaxio
50533>>>Register_Object chkclorder
50533>>>Register_Object chkForce
50533>>>Register_Object chkPtyppar
50533>>>Register_Object chkptypmet
50533>>>Register_Object chkWax
50533>>>Register_Object chkWitemx
50533>>>Register_Object dbBitmap3
50533>>>Register_Object dbTabDialogSub1
50533>>>Register_Object dbTabPageSub3
50533>>>Register_Object Fpa_DDR
50533>>>Register_Object Fpa_DDW
50533>>>Register_Object frmOtherYear
50533>>>Register_Object HmCtyp_DDR
50533>>>Register_Object HmCtyp_DDW
50533>>>Register_Object Hmgio_DDR
50533>>>Register_Object Hmgio_DDW
50533>>>Register_Object HmgioW_DDR
50533>>>Register_Object HmgioW_DDW
50533>>>Register_Object HmWtyp_DDR
50533>>>Register_Object HmWtyp_DDW
50533>>>Register_Object Item_DDR
50533>>>Register_Object Item_DDW
50533>>>Register_Object Payresp_DD2
50533>>>Register_Object Pseira_DDR
50533>>>Register_Object Pseira_DDW
50533>>>Register_Object Ptyppar_DDR
50533>>>Register_Object Ptyppar_DDW
50533>>>Register_Object ptypmet_DDR
50533>>>Register_Object ptypmet_DDW
50533>>>Register_Object Syscurxr_DD
50533>>>Register_Object sysrecc
50533>>>Register_Object TextBoxSub1
50533>>>Register_Object TextBoxSub10
50533>>>Register_Object TextBoxSub14
50533>>>Register_Object TextBoxSub2
50533>>>Register_Object TextBoxSub24
50533>>>Register_Object TextBoxSub3
50533>>>Register_Object TextBoxSub32
50533>>>Register_Object TextBoxSub33
50533>>>Register_Object TextBoxSub34
50533>>>Register_Object TextBoxSub35
50533>>>Register_Object TextBoxSub36
50533>>>Register_Object TextBoxSub37
50533>>>Register_Object TextBoxSub38
50533>>>Register_Object TextBoxSub39
50533>>>Register_Object TextBoxSub4
50533>>>Register_Object TextBoxSub40
50533>>>Register_Object TextBoxSub41
50533>>>Register_Object TextBoxSub42
50533>>>Register_Object TextBoxSub43
50533>>>Register_Object TextBoxSub44
50533>>>Register_Object TextBoxSub45
50533>>>Register_Object TextBoxSub46
50533>>>Register_Object TextBoxSub47
50533>>>Register_Object TextBoxSub48
50533>>>Register_Object TextBoxSub49
50533>>>Register_Object TextBoxSub5
50533>>>Register_Object TextBoxSub50
50533>>>Register_Object TextBoxSub6
50533>>>Register_Object TextBoxSub7
50533>>>Register_Object TextBoxSub8
50533>>>Register_Object TextBoxSub9
50533>>>Register_Object Textbox1
50533>>>Register_Object The_Table
50533>>>Register_Object Towns_DD2
50533>>>Register_Object TP_db1
50533>>>Register_Object TP_db2
50533>>>Register_Object txtM1
50533>>>Register_Object txtM2
50533>>>Register_Object Units_DDR
50533>>>Register_Object Units_DDW
50533>>>Register_Object V3
50533>>>Register_Object Wapokat_DDR
50533>>>Register_Object Wapokat_DDW
50533>>>Register_Object Wapomast_DDR
50533>>>Register_Object Wapomast_DDW
50533>>>Register_Object Wax_DDR
50533>>>Register_Object Wax_DDW
50533>>>Register_Object Wflagkin_DDR
50533>>>Register_Object Wflagkin_DDW
50533>>>Register_Object Witemkat_DDR
50533>>>Register_Object Witemkat_DDW
50533>>>Register_Object Witemx_DDR
50533>>>Register_Object Witemx_DDW
50533>>>Register_Object Witemxt_DDR
50533>>>Register_Object Witemxt_DDW
50533>>>Register_Object Wtypkin_DDR
50533>>>Register_Object Wtypkin_DDW
50533>>>Register_Object Year_DD
50533>>>Register_Object Year_DDF2
50533>>>Register_Object Year_DDR
50533>>>Register_Object Year_Year_Year
50533>>>
50533>>>
50533>>>//AB/     AppBuild VIEW
50533>>>
50533>>>
50533>>>    //AB-StoreTopStart
50533>>>            
50533>>>    Open SysCurXr
50535>>>    Open Company
50537>>>    Open Branch
50539>>>    Open Year
50541>>>    
50541>>>    use sysrecc.dd
INCLUDING FILE: SYSRECC.DD
50541>>>>>//DDB-FileStart
50541>>>>>//DDB-HeaderStart
50541>>>>>
50541>>>>>// File Name : SYSRECC.DD
50541>>>>>// Class Name: Sysrecc_DataDictionary
50541>>>>>// Revision  : 42
50541>>>>>// Version   : 2
50541>>>>>
50541>>>>>Use  Windows           // Basic Definitions
50541>>>>>Use  DataDict          // DataDictionary Class Definition
50541>>>>>Use  DDvalTbl          // Validation Table Class Definitions
50541>>>>>
50541>>>>>Open Sysrecc
50543>>>>>
50543>>>>>//DDB-HeaderEnd
50543>>>>>
50543>>>>>Class Sysrecc_DataDictionary  is a DataDictionary
50544>>>>>
50544>>>>>    // Define_Fields:
50544>>>>>    // This procedure is used to set up all data-dictionary rules.
50544>>>>>
50544>>>>>    Procedure Define_Fields
50545>>>>>        Forward Send Define_Fields
50547>>>>>        //DDB-Generated-Code-Location
50547>>>>>        //DDB-DefineFieldStart
50547>>>>>
50547>>>>>        Set Main_File            To Sysrecc.File_Number
50548>>>>>
50548>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
50549>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
50550>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
50551>>>>>
50551>>>>>        // Field-based properties.......................
50551>>>>>
50551>>>>>        // Sysrecc.Ctypkin_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Cflagkin_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Client_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Cmoves_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Copen_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Cmhnes_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Chmnies_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Custprom_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Cn_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Constr_Clients
50551>>>>>
50551>>>>>        // Sysrecc.Hmgio_Code
50551>>>>>
50551>>>>>        // Sysrecc.Payresp_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Salesmen_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Constrct_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Drivers_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Mhxanik_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Brzone_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Cnzone_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Tpclient_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Tperga_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Tparticl_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Tppresp_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Tpbranch_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Orders_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Ordersd_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Clorder_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Clorderd_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Ordersc_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Ordersdc_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Clorderc_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Clorderdc_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Yclients_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Aa_Ypoprosf
50551>>>>>
50551>>>>>        // Sysrecc.Btnemp_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Btnordh_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Dorderh_Rec0
50551>>>>>
50551>>>>>        // Sysrecc.Dorderd_Rec0
50551>>>>>
50551>>>>>        //DDB-DefineFieldEnd
50551>>>>>    End_Procedure    // Define_Fields
50552>>>>>
50552>>>>>    // Field_Defaults:
50552>>>>>    // This procedure is used to establish default field values.
50552>>>>>
50552>>>>>    Procedure Field_Defaults
50553>>>>>        Forward Send Field_Defaults
50555>>>>>        //DDB-Generated-Code-Location
50555>>>>>        //DDB-FieldDefaultStart
50555>>>>>        //DDB-FieldDefaultEnd
50555>>>>>    End_Procedure    // Field_Defaults
50556>>>>>
50556>>>>>End_Class    // Sysrecc_DataDictionary
50557>>>>>//DDB-FileEnd
50557>>>    Use Company.DD
50557>>>    Use Branch.DD
50557>>>    Use Year.DD
50557>>>    Use Btypkin.DD
50557>>>    Use Bflagkin.DD
INCLUDING FILE: BFLAGKIN.DD
50557>>>>>//DDB-FileStart
50557>>>>>//DDB-HeaderStart
50557>>>>>
50557>>>>>// File Name : BFLAGKIN.DD
50557>>>>>// Class Name: Bflagkin_DataDictionary
50557>>>>>// Revision  : 17
50557>>>>>// Version   : 2
50557>>>>>
50557>>>>>Use  Windows           // Basic Definitions
50557>>>>>Use  DataDict          // DataDictionary Class Definition
50557>>>>>Use  DDvalTbl          // Validation Table Class Definitions
50557>>>>>
50557>>>>>Open Bflagkin
50559>>>>>Open Btypkin
50561>>>>>Open Sysrecb
50563>>>>>
50563>>>>>//DDB-HeaderEnd
50563>>>>>//DDB-ValidationStart
50563>>>>>
50563>>>>>Register_Object Bflagkin_Bflagkin_Flag_VT
50563>>>>>
50563>>>>>Object Bflagkin_Bflagkin_Flag_VT  is a DescriptionValidationTable
50565>>>>>
50565>>>>>    Procedure Fill_List
50567>>>>>        Forward Send Fill_List
50569>>>>>        Send Add_Table_Value  "1"  "„¤ž£œ¨é¤œ  •¨œà§ ©«é©œ ª"
50570>>>>>        Send Add_Table_Value  "2"  "€¥åœª ©œ â¤¦ Œæ£ ©£˜"
50571>>>>>        Send Add_Table_Value  "3"  "‹œ«˜¨¦§ã €¥ é¤ ©œ ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜ •¨ã©žª"
50572>>>>>        Send Add_Table_Value  "4"  "‹œ«˜¨¦§ã €¥ é¤ ©œ Reporting Œæ£ ©£˜ •¨ã©žª"
50573>>>>>        Send Add_Table_Value  "5"  "€¬«æ£˜«ž ˜¨åŸ£ž©ž"
50574>>>>>        Send Add_Table_Value  "6"  "€¬¥á¤œ  ‹.“.”. à¢ã©œà¤ ¡˜«á ¦©æ«ž«˜"
50575>>>>>        Send Add_Table_Value  "7"  "€¬¥á¤œ  ‹.“.”. à¢ã©œà¤ ¡˜«á €¥å˜"
50576>>>>>        Send Add_Table_Value  "8"  "‹œ é¤œ  ‹.“.”. à¢ã©œà¤ ¡˜«á ¦©æ«ž«˜"
50577>>>>>        Send Add_Table_Value  "9"  "‹œ é¤œ  ‹.“.”. à¢ã©œà¤ ¡˜«á €¥å˜"
50578>>>>>        Send Add_Table_Value  "10"  "€¬¥á¤œ  ‹.“.”. €š¦¨é¤ ¡˜«á ¦©æ«ž«˜"
50579>>>>>        Send Add_Table_Value  "11"  "€¬¥á¤œ  ‹.“.”. €š¦¨é¤ ¡˜«á €¥å˜"
50580>>>>>        Send Add_Table_Value  "12"  "‹œ é¤œ  ‹.“.”. €š¦¨é¤ ¡˜«á ¦©æ«ž«˜"
50581>>>>>        Send Add_Table_Value  "13"  "‹œ é¤œ  ‹.“.”. €š¦¨é¤ ¡˜«á €¥å˜"
50582>>>>>        Send Add_Table_Value  "14"  "€¡¬¨à« ¡ã ‰å¤ž©ž"
50583>>>>>        Send Add_Table_Value  "15"  "„¤ž£œ¨é¤œ  €Ÿ¨¦ ©«ã 1"
50584>>>>>        Send Add_Table_Value  "16"  "„¤ž£œ¨é¤œ  €Ÿ¨¦ ©«ã 2"
50585>>>>>        Send Add_Table_Value  "17"  "„¤ž£œ¨é¤œ  „ › ¡âª œ¨ æ›¦¬ª"
50586>>>>>        Send Add_Table_Value  "18"  "„§ «¨œ§æ£œ¤œª †£œ¨/¤åœª ˜§¦:"
50587>>>>>        Send Add_Table_Value  "19"  "‰å¤ž©ž €§¦š¨˜­ãª"
50588>>>>>        Send Add_Table_Value  "20"  "‰å¤ž©ž ¨¦¬§¦¢¦š ©£¦ç"
50589>>>>>    End_Procedure    // Fill_List
50590>>>>>    //DDB-ValidationCustomStart
50590>>>>>    //DDB-ValidationCustomEnd
50590>>>>>End_Object   // Bflagkin_Bflagkin_Flag_VT
50591>>>>>//DDB-ValidationEnd
50591>>>>>
50591>>>>>Open Syscurxr
50593>>>>>
50593>>>>>Class Bflagkin_DataDictionary  is a DataDictionary_Sec
50594>>>>>
50594>>>>>    // Creating:
50594>>>>>
50594>>>>>    Procedure Creating
50595>>>>>        Forward Send Creating
50597>>>>>        // Insert Code Here
50597>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Bflagkin.Bflagkin_Rec0)))))) to Bflagkin.Bflagkin_Recr
50598>>>>>    End_Procedure   // Creating
50599>>>>>
50599>>>>>    Procedure Update
50600>>>>>              Forward Send Update
50602>>>>>
50602>>>>>              //œ¤ž£â¨à©ž £ã related §œ›åà¤
50602>>>>>              Move Syscurxr.Company_Code to Bflagkin.Company_Code
50603>>>>>              Move Syscurxr.Branch_Code  to Bflagkin.Branch_Code
50604>>>>>              Move Syscurxr.Year_Year    to Bflagkin.Year_Year
50605>>>>>              Move Btypkin.Btypkin_Code  to Bflagkin.Btypkin_Code
50606>>>>>
50606>>>>>              //œ¤ž£â¨à©ž Btypkin_flags
50606>>>>>                   If (Bflagkin.Bflagkin_Flag =  1) Move 1 to Btypkin.Btypkin_Flag01
50609>>>>>              Else If (Bflagkin.Bflagkin_Flag =  2) Move 1 to Btypkin.Btypkin_Flag02
50613>>>>>              Else If (Bflagkin.Bflagkin_Flag =  3) Move 1 to Btypkin.Btypkin_Flag03
50617>>>>>              Else If (Bflagkin.Bflagkin_Flag =  4) Move 1 to Btypkin.Btypkin_Flag04
50621>>>>>              Else If (Bflagkin.Bflagkin_Flag =  5) Move 1 to Btypkin.Btypkin_Flag05
50625>>>>>              Else If (Bflagkin.Bflagkin_Flag =  6) Move 1 to Btypkin.Btypkin_Flag06
50629>>>>>              Else If (Bflagkin.Bflagkin_Flag =  7) Move 1 to Btypkin.Btypkin_Flag07
50633>>>>>              Else If (Bflagkin.Bflagkin_Flag =  8) Move 1 to Btypkin.Btypkin_Flag08
50637>>>>>              Else If (Bflagkin.Bflagkin_Flag =  9) Move 1 to Btypkin.Btypkin_Flag09
50641>>>>>              Else If (Bflagkin.Bflagkin_Flag = 10) Move 1 to Btypkin.Btypkin_Flag10
50645>>>>>              Else If (Bflagkin.Bflagkin_Flag = 11) Move 1 to Btypkin.Btypkin_Flag11
50649>>>>>              Else If (Bflagkin.Bflagkin_Flag = 12) Move 1 to Btypkin.Btypkin_Flag12
50653>>>>>              Else If (Bflagkin.Bflagkin_Flag = 13) Move 1 to Btypkin.Btypkin_Flag13
50657>>>>>              Else If (Bflagkin.Bflagkin_Flag = 14) Move 1 to Btypkin.Btypkin_Flag14
50661>>>>>              Else If (Bflagkin.Bflagkin_Flag = 15) Move 1 to Btypkin.Btypkin_Flag15
50665>>>>>              Else If (Bflagkin.Bflagkin_Flag = 16) Move 1 to Btypkin.Btypkin_Flag16
50669>>>>>              Else If (Bflagkin.Bflagkin_Flag = 17) Move 1 to Btypkin.Btypkin_Flag17
50673>>>>>              Else If (Bflagkin.Bflagkin_Flag = 18) Move 1 to Btypkin.Btypkin_Flag18
50677>>>>>              Else If (Bflagkin.Bflagkin_Flag = 19) Move 1 to Btypkin.Btypkin_Flag19
50681>>>>>              Else If (Bflagkin.Bflagkin_Flag = 20) Move 1 to Btypkin.Btypkin_Flag20
50685>>>>>              Add 1 to Btypkin.Bflagkin_num
50686>>>>>    End_Procedure   //update
50687>>>>>
50687>>>>>
50687>>>>>    Procedure Backout
50688>>>>>              Forward Send Backout
50690>>>>>
50690>>>>>              //œ¤ž£â¨à©ž Btypkin_flags
50690>>>>>                   If (Bflagkin.Bflagkin_Flag =  1) Move 0 to Btypkin.Btypkin_Flag01
50693>>>>>              Else If (Bflagkin.Bflagkin_Flag =  2) Move 0 to Btypkin.Btypkin_Flag02
50697>>>>>              Else If (Bflagkin.Bflagkin_Flag =  3) Move 0 to Btypkin.Btypkin_Flag03
50701>>>>>              Else If (Bflagkin.Bflagkin_Flag =  4) Move 0 to Btypkin.Btypkin_Flag04
50705>>>>>              Else If (Bflagkin.Bflagkin_Flag =  5) Move 0 to Btypkin.Btypkin_Flag05
50709>>>>>              Else If (Bflagkin.Bflagkin_Flag =  6) Move 0 to Btypkin.Btypkin_Flag06
50713>>>>>              Else If (Bflagkin.Bflagkin_Flag =  7) Move 0 to Btypkin.Btypkin_Flag07
50717>>>>>              Else If (Bflagkin.Bflagkin_Flag =  8) Move 0 to Btypkin.Btypkin_Flag08
50721>>>>>              Else If (Bflagkin.Bflagkin_Flag =  9) Move 0 to Btypkin.Btypkin_Flag09
50725>>>>>              Else If (Bflagkin.Bflagkin_Flag = 10) Move 0 to Btypkin.Btypkin_Flag10
50729>>>>>              Else If (Bflagkin.Bflagkin_Flag = 11) Move 0 to Btypkin.Btypkin_Flag11
50733>>>>>              Else If (Bflagkin.Bflagkin_Flag = 12) Move 0 to Btypkin.Btypkin_Flag12
50737>>>>>              Else If (Bflagkin.Bflagkin_Flag = 13) Move 0 to Btypkin.Btypkin_Flag13
50741>>>>>              Else If (Bflagkin.Bflagkin_Flag = 14) Move 0 to Btypkin.Btypkin_Flag14
50745>>>>>              Else If (Bflagkin.Bflagkin_Flag = 15) Move 0 to Btypkin.Btypkin_Flag15
50749>>>>>              Else If (Bflagkin.Bflagkin_Flag = 16) Move 0 to Btypkin.Btypkin_Flag16
50753>>>>>              Else If (Bflagkin.Bflagkin_Flag = 17) Move 0 to Btypkin.Btypkin_Flag17
50757>>>>>              Else If (Bflagkin.Bflagkin_Flag = 18) Move 0 to Btypkin.Btypkin_Flag18
50761>>>>>              Else If (Bflagkin.Bflagkin_Flag = 19) Move 0 to Btypkin.Btypkin_Flag19
50765>>>>>              Else If (Bflagkin.Bflagkin_Flag = 20) Move 0 to Btypkin.Btypkin_Flag20
50769>>>>>              Sub 1 From Btypkin.Bflagkin_num
50770>>>>>    End_Procedure   //backout
50771>>>>>
50771>>>>>
50771>>>>>    Procedure Define_Fields
50772>>>>>        Forward Send Define_Fields
50774>>>>>        //DDB-Generated-Code-Location
50774>>>>>        //DDB-DefineFieldStart
50774>>>>>
50774>>>>>        Set Main_File            To Bflagkin.File_Number
50775>>>>>        Set Cascade_Delete_State To FALSE
50776>>>>>
50776>>>>>
50776>>>>>        // Parent (Server) file structure...............
50776>>>>>        Send Add_Server_File  Btypkin.File_Number
50777>>>>>
50777>>>>>        // External (System) file structure.............
50777>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
50778>>>>>
50778>>>>>        Define_Auto_Increment  Sysrecb.Bflagkin_Rec0  To Bflagkin.Bflagkin_Rec0
50781>>>>>
50781>>>>>        // Field-based properties.......................
50781>>>>>
50781>>>>>        // Bflagkin.Company_Code
50781>>>>>
50781>>>>>        // Bflagkin.Branch_Code
50781>>>>>
50781>>>>>        // Bflagkin.Year_Year
50781>>>>>
50781>>>>>        // Bflagkin.Btypkin_Code
50781>>>>>
50781>>>>>        // Bflagkin.Bflagkin_Flag
50781>>>>>        Set Field_Value_Table      Field Bflagkin.Bflagkin_Flag To (Bflagkin_Bflagkin_Flag_VT(Self))
50782>>>>>
50782>>>>>        // Bflagkin.Bflagkin_Rec0
50782>>>>>
50782>>>>>        // Bflagkin.Btypkin_Recr
50782>>>>>
50782>>>>>        // Bflagkin.Bflagkin_Recr
50782>>>>>
50782>>>>>        //DDB-DefineFieldEnd
50782>>>>>
50782>>>>>        Set Main_File            To Bflagkin.File_Number
50783>>>>>        Set Cascade_Delete_State To FALSE
50784>>>>>
50784>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
50785>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
50786>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
50787>>>>>
50787>>>>>        // Parent (Server) file structure...............
50787>>>>>        Send Add_Server_File  Btypkin.File_Number
50788>>>>>
50788>>>>>        // External (System) file structure.............
50788>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
50789>>>>>
50789>>>>>        Define_Auto_Increment  Sysrecb.Bflagkin_Rec0  To Bflagkin.Bflagkin_Rec0
50792>>>>>
50792>>>>>        // Field-based properties.......................
50792>>>>>
50792>>>>>        // Bflagkin.Company_Code
50792>>>>>
50792>>>>>        // Bflagkin.Branch_Code
50792>>>>>
50792>>>>>        // Bflagkin.Year_Year
50792>>>>>
50792>>>>>        // Bflagkin.Btypkin_Code
50792>>>>>
50792>>>>>        // Bflagkin.Bflagkin_Flag
50792>>>>>        Set Field_Value_Table      Field Bflagkin.Bflagkin_Flag   To (Bflagkin_Bflagkin_Flag_VT(Self))
50793>>>>>
50793>>>>>        // Bflagkin.Bflagkin_Rec0
50793>>>>>
50793>>>>>        // Bflagkin.Btypkin_Rec0
50793>>>>>
50793>>>>>    End_Procedure    // Define_Fields
50794>>>>>
50794>>>>>
50794>>>>>    Procedure Field_Defaults
50795>>>>>        Forward Send Field_Defaults
50797>>>>>        //DDB-Generated-Code-Location
50797>>>>>        //DDB-FieldDefaultStart
50797>>>>>        //DDB-FieldDefaultEnd
50797>>>>>    End_Procedure    // Field_Defaults
50798>>>>>
50798>>>>>End_Class    // Bflagkin_DataDictionary
50799>>>>>//DDB-FileEnd
50799>>>    Use Wtypkin.DD
50799>>>    Use Wflagkin.DD
INCLUDING FILE: WFLAGKIN.DD
50799>>>>>//DDB-FileStart
50799>>>>>//DDB-HeaderStart
50799>>>>>
50799>>>>>// File Name : WFLAGKIN.DD
50799>>>>>// Class Name: Wflagkin_DataDictionary
50799>>>>>// Revision  : 15
50799>>>>>// Version   : 2
50799>>>>>
50799>>>>>Use  Windows           // Basic Definitions
50799>>>>>Use  DataDict          // DataDictionary Class Definition
50799>>>>>Use  DDvalTbl          // Validation Table Class Definitions
50799>>>>>
50799>>>>>Open Wflagkin
50801>>>>>Open Wtypkin
50803>>>>>Open Sysrecw
50805>>>>>Open Syscurxr
50807>>>>>
50807>>>>>//DDB-HeaderEnd
50807>>>>>//DDB-ValidationStart
50807>>>>>
50807>>>>>Register_Object Wflagkin_Wflagkin_Flag_VT
50807>>>>>
50807>>>>>Object Wflagkin_Wflagkin_Flag_VT  is a CodeValidationTable
50809>>>>>    Set Type_Value        To "WFLAGS"
50810>>>>>    //DDB-ValidationCustomStart
50810>>>>>    //DDB-ValidationCustomEnd
50810>>>>>End_Object   // Wflagkin_Wflagkin_Flag_VT
50811>>>>>//DDB-ValidationEnd
50811>>>>>
50811>>>>>Class Wflagkin_DataDictionary  is a DataDictionary
50812>>>>>
50812>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
50813>>>>>        String lsError_Message
50814>>>>>        Case Begin
50814>>>>>            Case (iError_Num = 70001)
50816>>>>>                Move "DDC 019:ƒœ¤ œ§ «¨â§¦¤«˜  Flags ˜¤à «à¤ 2 ¯ž­åà¤" to lsError_Message
50817>>>>>            Case Break
50818>>>>>            Case (iError_Num = 70002)
50821>>>>>                Move "DDC 019:ƒœ¤ œ§ «¨â§¦¤«˜  Flags £ž›œ¤ ¡á" to lsError_Message
50822>>>>>            Case Break
50823>>>>>            Case Else
50823>>>>>                Forward Send Operation_Not_Allowed iError_Num
50825>>>>>        Case End
50825>>>>>        Error iError_Num lsError_Message
50826>>>>>>
50826>>>>>    End_Procedure // operation_not_allowed
50827>>>>>
50827>>>>>
50827>>>>>    Function Validate_Save  Returns Integer
50828>>>>>        Integer iReturnVal
50829>>>>>        Forward Get Validate_Save  To iReturnVal
50831>>>>>        If (Not(iReturnVal)) Begin
50833>>>>>                 If (Length(Trim(Wflagkin.Wflagkin_Flag))>2)    Move 70001 to iReturnVal
50836>>>>>            Else If (Wflagkin.Flag_Numeric=0)                   Move 70002 to iReturnVal
50840>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
50843>>>>>        End
50843>>>>>>
50843>>>>>        Function_Return iReturnVal
50844>>>>>    End_Function   // Validate_Save
50845>>>>>
50845>>>>>
50845>>>>>    // Update:
50845>>>>>    Procedure Update
50846>>>>>        Forward Send Update
50848>>>>>        // Insert Code Here
50848>>>>>        Move Company.Company_Code   to Wflagkin.Company_Code
50849>>>>>        Move Branch.Branch_Code     to Wflagkin.Branch_Code
50850>>>>>        Move Year.Year_Year         to Wflagkin.Year_Year
50851>>>>>        Move Wtypkin.Wtypkin_Code   to Wflagkin.Wtypkin_Code
50852>>>>>        
50852>>>>>        Move Wflagkin.Wflagkin_Flag to Wflagkin.Flag_Numeric
50853>>>>>        
50853>>>>>    End_Procedure   // Update
50854>>>>> 
50854>>>>>     Procedure Creating
50855>>>>>        Forward Send Creating
50857>>>>>        // Insert Code Here
50857>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wflagkin.Wflagkin_Rec0)))))) to Wflagkin.Wflagkin_Recr
50858>>>>>    End_Procedure   // Creating
50859>>>>>
50859>>>>>
50859>>>>>    // Define_Fields:
50859>>>>>    // This procedure is used to set up all data-dictionary rules.
50859>>>>>
50859>>>>>    Procedure Define_Fields
50860>>>>>        Forward Send Define_Fields
50862>>>>>        //DDB-Generated-Code-Location
50862>>>>>        //DDB-DefineFieldStart
50862>>>>>
50862>>>>>        Set Main_File            To Wflagkin.File_Number
50863>>>>>        Set Cascade_Delete_State To FALSE
50864>>>>>
50864>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
50865>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
50866>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
50867>>>>>
50867>>>>>        // Parent (Server) file structure...............
50867>>>>>        Send Add_Server_File  Wtypkin.File_Number
50868>>>>>
50868>>>>>        // External (System) file structure.............
50868>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
50869>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
50870>>>>>
50870>>>>>        Define_Auto_Increment  Sysrecw.Wflagkin_Rec0  To Wflagkin.Wflagkin_Rec0
50873>>>>>
50873>>>>>        // Field-based properties.......................
50873>>>>>
50873>>>>>        // Wflagkin.Company_Code
50873>>>>>
50873>>>>>        // Wflagkin.Branch_Code
50873>>>>>
50873>>>>>        // Wflagkin.Year_Year
50873>>>>>
50873>>>>>        // Wflagkin.Wtypkin_Code
50873>>>>>
50873>>>>>        // Wflagkin.Wflagkin_Flag
50873>>>>>        Set Field_Value_Table      Field Wflagkin.Wflagkin_Flag To (Wflagkin_Wflagkin_Flag_VT(Self))
50874>>>>>
50874>>>>>        // Wflagkin.Wtypkin_Recr
50874>>>>>
50874>>>>>        // Wflagkin.Wflagkin_Descr
50874>>>>>
50874>>>>>        // Wflagkin.Wflagkin_Rec0
50874>>>>>        Set Field_Options          Field Wflagkin.Wflagkin_Rec0 To DD_AUTOFIND   
50875>>>>>
50875>>>>>        // Wflagkin.Wflagkin_Recr
50875>>>>>
50875>>>>>        // Wflagkin.Flag_Numeric
50875>>>>>
50875>>>>>        //DDB-DefineFieldEnd
50875>>>>>    End_Procedure    // Define_Fields
50876>>>>>
50876>>>>>    // Field_Defaults:
50876>>>>>    // This procedure is used to establish default field values.
50876>>>>>
50876>>>>>    Procedure Field_Defaults
50877>>>>>        Forward Send Field_Defaults
50879>>>>>        //DDB-Generated-Code-Location
50879>>>>>        //DDB-FieldDefaultStart
50879>>>>>        //DDB-FieldDefaultEnd
50879>>>>>    End_Procedure    // Field_Defaults
50880>>>>>
50880>>>>>End_Class    // Wflagkin_DataDictionary
50881>>>>>//DDB-FileEnd
50881>>>    use clients.dd
50881>>>    use payresp.dd
50881>>>    use areas.dd
50881>>>    use cities.dd
50881>>>    use towns.dd
50881>>>    use country.dd
50881>>>    Use CN.DD
50881>>>    Use Baxio.DD
50881>>>    Use BaxioKat.DD
50881>>>    Use WapoKat.DD
50881>>>    Use Wapomast.DD
50881>>>    Use Wax.DD
50881>>>    Use WitemKat.DD
50881>>>    use units.dd
50881>>>    Use Item.DD
50881>>>    Use Witemx.DD
50881>>>    Use Witemxt.DD
INCLUDING FILE: WITEMXT.DD
50881>>>>>//DDB-FileStart
50881>>>>>//DDB-HeaderStart
50881>>>>>
50881>>>>>// File Name : WITEMXT.DD
50881>>>>>// Class Name: Witemxt_DataDictionary
50881>>>>>// Revision  : 15
50881>>>>>// Version   : 2
50881>>>>>
50881>>>>>Use  Windows           // Basic Definitions
50881>>>>>Use  DataDict          // DataDictionary Class Definition
50881>>>>>Use  DDvalTbl          // Validation Table Class Definitions
50881>>>>>
50881>>>>>Open Witemxt
50883>>>>>Open Witemx
50885>>>>>Open Sysrecw
50887>>>>>
50887>>>>>//DDB-HeaderEnd
50887>>>>>
50887>>>>>Class Witemxt_DataDictionary  is a DataDictionary_Sec
50888>>>>>
50888>>>>>   Procedure OnConstrain
50889>>>>>        Forward Send OnConstrain
50891>>>>>        Constrain WitemxT.Company_Code  eq SysCurXR.Company_Code
50893>>>>>        Constrain WitemxT.Branch_Code   eq SysCurXR.Branch_Code
50895>>>>>        Constrain WitemxT.Year_Year     eq SysCurXR.Year_Year
50897>>>>>    End_Procedure
50898>>>>>
50898>>>>>    // Update:
50898>>>>>    Procedure Update
50899>>>>>        Forward Send Update
50901>>>>>        // Insert Code Here
50901>>>>>        Move SysCurXR.Company_Code  to WitemxT.Company_Code
50902>>>>>        Move SysCurXR.Branch_Code   to WitemxT.Branch_Code
50903>>>>>        Move SysCurXR.Year_Year     to WitemxT.Year_Year
50904>>>>>        Move Witemx.Witemx_Recr     to WitemxT.Witemx_Recr
50905>>>>>        Move Item.Item_Code         to Witemxt.Item_Code
50906>>>>>    End_Procedure   // Update
50907>>>>>
50907>>>>>     Procedure Creating
50908>>>>>        Forward Send Creating
50910>>>>>        // Insert Code Here
50910>>>>>        //Move (Append('',((Trim(SysCurXR.Branch_Site))+;
50910>>>>>        //                  (Trim(String(WitemxT.WitemxT_Rec0)))))) to WitemxT.Witemx_Recr
50910>>>>>    End_Procedure   // Creating
50911>>>>>   
50911>>>>>    Procedure Shmera integer iField  Date dDate
50912>>>>>        Local Integer Changed
50913>>>>>        Get Field_Changed_State iField to Changed
50914>>>>>        If (Changed=0 AND dDate =0) Begin
50916>>>>>            SysDate4 dDate
50917>>>>>            Set Field_Default_Value iField to dDate
50918>>>>>        End
50918>>>>>>
50918>>>>>     End_Procedure   // Shmera
50919>>>>>   
50919>>>>>   
50919>>>>>    // Define_Fields:
50919>>>>>    // This procedure is used to set up all data-dictionary rules.
50919>>>>>
50919>>>>>    Procedure Define_Fields
50920>>>>>        Forward Send Define_Fields
50922>>>>>        //DDB-Generated-Code-Location
50922>>>>>        //DDB-DefineFieldStart
50922>>>>>
50922>>>>>        Set Main_File            To Witemxt.File_Number
50923>>>>>
50923>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
50924>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
50925>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
50926>>>>>
50926>>>>>        // Parent (Server) file structure...............
50926>>>>>        Send Add_Server_File  Witemx.File_Number
50927>>>>>
50927>>>>>        // External (System) file structure.............
50927>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_NEW_SAVE_DELETE
50928>>>>>
50928>>>>>        Define_Auto_Increment  Sysrecw.Witemxt_Rec0  To Witemxt.Witemxt_Rec0
50931>>>>>
50931>>>>>        // Field-based properties.......................
50931>>>>>
50931>>>>>        // Witemxt.Company_Code
50931>>>>>
50931>>>>>        // Witemxt.Branch_Code
50931>>>>>
50931>>>>>        // Witemxt.Year_Year
50931>>>>>
50931>>>>>        // Witemxt.Witemxt_Rec0
50931>>>>>
50931>>>>>        // Witemxt.Witemx_Recr
50931>>>>>
50931>>>>>        // Witemxt.Axia
50931>>>>>
50931>>>>>        // Witemxt.Axia0
50931>>>>>
50931>>>>>        // Witemxt.Axia00
50931>>>>>
50931>>>>>        // Witemxt.Axiar
50931>>>>>
50931>>>>>        // Witemxt.Value_Date
50931>>>>>        Set Field_Entry_msg        Field Witemxt.Value_Date To Shmera
50932>>>>>        Set Field_Mask_Type        Field Witemxt.Value_Date To MASK_DATE_WINDOW
50933>>>>>
50933>>>>>        // Witemxt.Qty
50933>>>>>
50933>>>>>        // Witemxt.Pcdisc
50933>>>>>
50933>>>>>        // Witemxt.Orio
50933>>>>>
50933>>>>>        // Witemxt.Pagioorio
50933>>>>>
50933>>>>>        // Witemxt.Pcdiscantlia
50933>>>>>
50933>>>>>        // Witemxt.Item_Code
50933>>>>>
50933>>>>>        //DDB-DefineFieldEnd
50933>>>>>    End_Procedure    // Define_Fields
50934>>>>>
50934>>>>>    // Field_Defaults:
50934>>>>>    // This procedure is used to establish default field values.
50934>>>>>
50934>>>>>    Procedure Field_Defaults
50935>>>>>        Forward Send Field_Defaults
50937>>>>>        //DDB-Generated-Code-Location
50937>>>>>        //DDB-FieldDefaultStart
50937>>>>>        //DDB-FieldDefaultEnd
50937>>>>>    End_Procedure    // Field_Defaults
50938>>>>>
50938>>>>>End_Class    // Witemxt_DataDictionary
50939>>>>>//DDB-FileEnd
50939>>>    Use Fpa.DD
50939>>>    Use Ptyppar.DD
50939>>>    Use Pseira.DD
50939>>>    Use HmCtyp.DD
INCLUDING FILE: HMCTYP.DD
50939>>>>>//DDB-FileStart
50939>>>>>//DDB-HeaderStart
50939>>>>>
50939>>>>>// File Name : HMCTYP.DD
50939>>>>>// Class Name: Hmctyp_DataDictionary
50939>>>>>// Revision  : 4
50939>>>>>// Version   : 2
50939>>>>>
50939>>>>>Use  Windows           // Basic Definitions
50939>>>>>Use  DataDict          // DataDictionary Class Definition
50939>>>>>Use  DDvalTbl          // Validation Table Class Definitions
50939>>>>>
50939>>>>>Open Hmctyp
50941>>>>>Open Hmgio
50943>>>>>Open Ctypkin
50945>>>>>
50945>>>>>//DDB-HeaderEnd
50945>>>>>
50945>>>>>Class Hmctyp_DataDictionary  is a DataDictionary_Sec
50946>>>>>
50946>>>>>    // Update:
50946>>>>>
50946>>>>>    Procedure Update
50947>>>>>        Forward Send Update
50949>>>>>        // Insert Code Here
50949>>>>>        Move SysCurXR.Company_Code  to HmCtyp.Company_Code
50950>>>>>        Move SysCurXR.Branch_Code   to HmCtyp.Branch_Code
50951>>>>>        Move SysCurXR.Year_Year     to HmCtyp.Year_Year
50952>>>>>        Move Ctypkin.Ctypkin_Code   to HmCtyp.Ctypkin_Code
50953>>>>>    End_Procedure   // Update
50954>>>>>
50954>>>>>
50954>>>>>    // Define_Fields:
50954>>>>>    // This procedure is used to set up all data-dictionary rules.
50954>>>>>
50954>>>>>    Procedure Define_Fields
50955>>>>>        Forward Send Define_Fields
50957>>>>>        //DDB-Generated-Code-Location
50957>>>>>        //DDB-DefineFieldStart
50957>>>>>
50957>>>>>        Set Main_File            To Hmctyp.File_Number
50958>>>>>        Set Cascade_Delete_State To FALSE
50959>>>>>
50959>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
50960>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
50961>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
50962>>>>>
50962>>>>>        // Parent (Server) file structure...............
50962>>>>>        Send Add_Server_File  Hmgio.File_Number
50963>>>>>        Send Add_Server_File  Ctypkin.File_Number
50964>>>>>
50964>>>>>        // Field-based properties.......................
50964>>>>>
50964>>>>>        // Hmctyp.Hmgio_Code
50964>>>>>
50964>>>>>        // Hmctyp.Ctypkin_Recr
50964>>>>>
50964>>>>>        // Hmctyp.Company_Code
50964>>>>>
50964>>>>>        // Hmctyp.Branch_Code
50964>>>>>
50964>>>>>        // Hmctyp.Year_Year
50964>>>>>
50964>>>>>        // Hmctyp.Ctypkin_Code
50964>>>>>
50964>>>>>        //DDB-DefineFieldEnd
50964>>>>>    End_Procedure    // Define_Fields
50965>>>>>
50965>>>>>    // Field_Defaults:
50965>>>>>    // This procedure is used to establish default field values.
50965>>>>>
50965>>>>>    Procedure Field_Defaults
50966>>>>>        Forward Send Field_Defaults
50968>>>>>        //DDB-Generated-Code-Location
50968>>>>>        //DDB-FieldDefaultStart
50968>>>>>        //DDB-FieldDefaultEnd
50968>>>>>    End_Procedure    // Field_Defaults
50969>>>>>
50969>>>>>End_Class    // Hmctyp_DataDictionary
50970>>>>>//DDB-FileEnd
50970>>>    Use HmWtyp.DD
INCLUDING FILE: HMWTYP.DD
50970>>>>>//DDB-FileStart
50970>>>>>//DDB-HeaderStart
50970>>>>>
50970>>>>>// File Name : HMWTYP.DD
50970>>>>>// Class Name: Hmwtyp_DataDictionary
50970>>>>>// Revision  : 1
50970>>>>>// Version   : 2
50970>>>>>
50970>>>>>Use  Windows           // Basic Definitions
50970>>>>>Use  DataDict          // DataDictionary Class Definition
50970>>>>>Use  DDvalTbl          // Validation Table Class Definitions
50970>>>>>
50970>>>>>Open Hmwtyp
50972>>>>>Open Hmgiow
50974>>>>>Open Wtypkin
50976>>>>>
50976>>>>>//DDB-HeaderEnd
50976>>>>>
50976>>>>>Class Hmwtyp_DataDictionary  is a DataDictionary_Sec
50977>>>>>
50977>>>>>    // Update:
50977>>>>>
50977>>>>>    Procedure Update
50978>>>>>        Forward Send Update
50980>>>>>        // Insert Code Here
50980>>>>>        Move SysCurXR.Company_Code  to HmWtyp.Company_Code
50981>>>>>        Move SysCurXR.Branch_Code   to HmWtyp.Branch_Code
50982>>>>>        Move SysCurXR.Year_Year     to HmWtyp.Year_Year
50983>>>>>        Move Wtypkin.Wtypkin_Code   to HmWtyp.Wtypkin_Code
50984>>>>>    End_Procedure   // Update
50985>>>>>
50985>>>>>
50985>>>>>
50985>>>>>
50985>>>>>    // Define_Fields:
50985>>>>>    // This procedure is used to set up all data-dictionary rules.
50985>>>>>
50985>>>>>    Procedure Define_Fields
50986>>>>>        Forward Send Define_Fields
50988>>>>>        //DDB-Generated-Code-Location
50988>>>>>        //DDB-DefineFieldStart
50988>>>>>
50988>>>>>        Set Main_File            To Hmwtyp.File_Number
50989>>>>>        Set Cascade_Delete_State To FALSE
50990>>>>>
50990>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
50991>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
50992>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
50993>>>>>
50993>>>>>        // Parent (Server) file structure...............
50993>>>>>        Send Add_Server_File  Hmgiow.File_Number
50994>>>>>        Send Add_Server_File  Wtypkin.File_Number
50995>>>>>
50995>>>>>        // Field-based properties.......................
50995>>>>>
50995>>>>>        // Hmwtyp.Hmgiow_Code
50995>>>>>
50995>>>>>        // Hmwtyp.Wtypkin_Recr
50995>>>>>
50995>>>>>        // Hmwtyp.Company_Code
50995>>>>>
50995>>>>>        // Hmwtyp.Branch_Code
50995>>>>>
50995>>>>>        // Hmwtyp.Year_Year
50995>>>>>
50995>>>>>        // Hmwtyp.Wtypkin_Code
50995>>>>>
50995>>>>>        //DDB-DefineFieldEnd
50995>>>>>    End_Procedure    // Define_Fields
50996>>>>>
50996>>>>>    // Field_Defaults:
50996>>>>>    // This procedure is used to establish default field values.
50996>>>>>
50996>>>>>    Procedure Field_Defaults
50997>>>>>        Forward Send Field_Defaults
50999>>>>>        //DDB-Generated-Code-Location
50999>>>>>        //DDB-FieldDefaultStart
50999>>>>>        //DDB-FieldDefaultEnd
50999>>>>>    End_Procedure    // Field_Defaults
51000>>>>>
51000>>>>>End_Class    // Hmwtyp_DataDictionary
51001>>>>>//DDB-FileEnd
51001>>>    Use Hmgio.DD
51001>>>    Use HmgioW.DD
51001>>>    Use Bkinkat.DD
51001>>>    use ptypmet.dd
INCLUDING FILE: PTYPMET.DD
51001>>>>>//DDB-FileStart
51001>>>>>//DDB-HeaderStart
51001>>>>>
51001>>>>>// File Name : PTYPMET.DD
51001>>>>>// Class Name: Ptypmet_DataDictionary
51001>>>>>// Revision  : 4
51001>>>>>// Version   : 2
51001>>>>>
51001>>>>>Use  Windows           // Basic Definitions
51001>>>>>Use  DataDict          // DataDictionary Class Definition
51001>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51001>>>>>
51001>>>>>Open Ptypmet
51003>>>>>Open Ptyppar
51005>>>>>
51005>>>>>//DDB-HeaderEnd
51005>>>>>//DDB-SelectionStart
51005>>>>>//DDB/ ExternalSelectionList sl012  sl012.SL
51005>>>>>Register_Object sl012
51005>>>>>//DDB-SelectionEnd
51005>>>>>
51005>>>>>Class Ptypmet_DataDictionary  is a DataDictionary_Sec
51006>>>>> 
51006>>>>>    // Define_Fields:
51006>>>>>    // This procedure is used to set up all data-dictionary rules.
51006>>>>>
51006>>>>>    Procedure Define_Fields
51007>>>>>        Forward Send Define_Fields
51009>>>>>        //DDB-Generated-Code-Location
51009>>>>>        //DDB-DefineFieldStart
51009>>>>>
51009>>>>>        Set Main_File            To Ptypmet.File_Number
51010>>>>>        Set Cascade_Delete_State To FALSE
51011>>>>>
51011>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
51012>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
51013>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51014>>>>>
51014>>>>>        // Parent (Server) file structure...............
51014>>>>>        Send Add_Server_File  Ptyppar.File_Number
51015>>>>>
51015>>>>>        // Field-based properties.......................
51015>>>>>
51015>>>>>        // Ptypmet.Ptyppar_Recr
51015>>>>>
51015>>>>>        // Ptypmet.Se_Ptyppar_Code
51015>>>>>        Set Field_Prompt_Object    Field Ptypmet.Se_Ptyppar_Code To (sl012(Self))
51016>>>>>
51016>>>>>        // Ptypmet.Se_Ptyppar_Desc
51016>>>>>        Set Field_Options          Field Ptypmet.Se_Ptyppar_Desc To DD_NOPUT      
51017>>>>>        Set Field_Prompt_Object    Field Ptypmet.Se_Ptyppar_Desc To (sl012(Self))
51018>>>>>
51018>>>>>        // Ptypmet.Ena_Pros_Ena
51018>>>>>        Set Field_Checkbox_Values  Field Ptypmet.Ena_Pros_Ena To "1"  "0"
51019>>>>>        Set Field_Class_Name       Field Ptypmet.Ena_Pros_Ena To "dbCheckBoxsub"
51020>>>>>
51020>>>>>        //DDB-DefineFieldEnd
51020>>>>>    End_Procedure    // Define_Fields
51021>>>>>
51021>>>>>    // Field_Defaults:
51021>>>>>    // This procedure is used to establish default field values.
51021>>>>>
51021>>>>>    Procedure Field_Defaults
51022>>>>>        Forward Send Field_Defaults
51024>>>>>        //DDB-Generated-Code-Location
51024>>>>>        //DDB-FieldDefaultStart
51024>>>>>        Set Field_Changed_Value   Field Ptypmet.Ena_Pros_Ena To 0
51025>>>>>        //DDB-FieldDefaultEnd
51025>>>>>    End_Procedure    // Field_Defaults
51026>>>>>
51026>>>>>End_Class    // Ptypmet_DataDictionary
51027>>>>>//DDB-Selection-pkg-Start
51027>>>>>
51027>>>>>Use sl012.SL         // sl012
51027>>>>>
51027>>>>>//DDB-Selection-pkg-End
51027>>>>>//DDB-FileEnd
51027>>>    
51027>>>    use clorder.dd
51027>>>    use clorderd.dd
INCLUDING FILE: CLORDERD.DD
51027>>>>>//DDB-FileStart
51027>>>>>//DDB-HeaderStart
51027>>>>>
51027>>>>>// File Name : CLORDERD.DD
51027>>>>>// Class Name: Clorderd_DataDictionary
51027>>>>>// Revision  : 52
51027>>>>>// Version   : 2
51027>>>>>
51027>>>>>Use  Windows           // Basic Definitions
51027>>>>>Use  DataDict          // DataDictionary Class Definition
51027>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51027>>>>>
51027>>>>>Open Clorderd
51029>>>>>Open Clorder
51031>>>>>Open Sysrecc
51033>>>>>Open Iteml
51035>>>>>Open Witemcl
51037>>>>>
51037>>>>>//DDB-HeaderEnd
51037>>>>>
51037>>>>>Open Clorder
51039>>>>>
51039>>>>>Class Clorderd_DataDictionary  is a DataDictionary_Sec
51040>>>>>
51040>>>>>       Procedure Creating
51041>>>>>        string sitem sprom
51042>>>>>        Forward Send Creating
51044>>>>>        // Insert Code Here
51044>>>>>        if (clorder.module <> '01') move '02' to clorder.module
51047>>>>>        if (clorderd.module = '01') begin
51049>>>>>           move (sysrecc.clorderdc_rec0 + 1) to clorderd.rec0
51050>>>>>           move clorderd.rec0 to sysrecc.clorderdc_rec0
51051>>>>>           saverecord sysrecc
51052>>>>>        end
51052>>>>>>
51052>>>>>        else begin
51053>>>>>           move (sysrecc.clorderd_rec0 + 1) to clorderd.rec0
51054>>>>>           move clorderd.rec0 to sysrecc.clorderd_rec0
51055>>>>>           saverecord sysrecc
51056>>>>>        end
51056>>>>>>
51056>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                         (Trim(String(clorderd.rec0)))))) to clorderd.recr
51057>>>>>
51057>>>>>        if (clorder.module = '02') Begin
51059>>>>>          clear witemcl
51060>>>>>          Move clorderd.item_code   to witemcl.item_code
51061>>>>>          Move clorder.clients_code to witemcl.client_code
51062>>>>>          find eq witemcl by index.1
51063>>>>>>
51063>>>>>          move witemcl.client_itemcode to clorderd.client_item
51064>>>>>        end
51064>>>>>>
51064>>>>>
51064>>>>>       End_Procedure   // Creating
51065>>>>>
51065>>>>>
51065>>>>>    // Backout:
51065>>>>>
51065>>>>>    Procedure Backout
51066>>>>>        Forward Send Backout
51068>>>>>
51068>>>>>        // Insert Code Here
51068>>>>>        sub clorderd.Qty            from clorder.qty
51069>>>>>        sub clorderd.posofpa        from clorder.fpa
51070>>>>>        sub clorderd.posodisc       from clorder.disc
51071>>>>>        sub clorderd.posoextra      from clorder.extra
51072>>>>>        sub clorderd.posototal      from clorder.total
51073>>>>>        sub clorderd.net            from clorder.net
51074>>>>>        sub clorderd.kinish_posothta from clorder.qtydtl
51075>>>>>        sub clorderd.kinhsh_poso     from clorder.posodtl
51076>>>>>    End_Procedure   // Backout
51077>>>>>
51077>>>>>
51077>>>>>
51077>>>>>    Procedure Update
51078>>>>>        Forward Send Update
51080>>>>>        number nQtykinhsh nTimhMon nQtyTimhMon nPctEkpt nPosoEkpt nPosoNet
51081>>>>>        number nPctFpa nPosoFpa npososynolo
51081>>>>>        move syscurxr.company_code to clorderd.company_code
51082>>>>>        move syscurxr.branch_code  to clorderd.branch_code
51083>>>>>        move syscurxr.year_year    to clorderd.year_year
51084>>>>>        move clorder.aapar         to clorderd.aa_par
51085>>>>>        move clorder.clients_code  to clorderd.clients_code
51086>>>>>        move clorder.date          to clorderd.date
51087>>>>>        move clorder.module        to clorderd.module
51088>>>>>        if (clorderd.ourdate = "") begin
51090>>>>>            move clorder.our_date to clorderd.ourdate
51091>>>>>        end
51091>>>>>>
51091>>>>>        Move (round_number((clorderd.qty*clorderd.unitprice),2))   to clorderd.net
51092>>>>>        Move (Round_number(((clorderd.net*clorderd.pcdisc/100)),2)) ;                                                           to clorderd.posodisc
51093>>>>>        Move (clorderd.net-clorderd.posodisc)              to clorderd.net
51094>>>>>        Move (Round_number(((clorderd.net*clorderd.pcfpa/100)),2));                                                           to clorderd.posofpa
51095>>>>>        Move (clorderd.net+clorderd.posofpa+clorderd.posoextra) to clorderd.posototal
51096>>>>>        Add clorderd.Qty          to clorder.qty
51097>>>>>        Add clorderd.posofpa      to clorder.fpa
51098>>>>>        Add clorderd.posodisc     to clorder.disc
51099>>>>>        Add clorderd.posoextra    to clorder.extra
51100>>>>>        Add clorderd.posototal    to clorder.total
51101>>>>>        add clorderd.net          to clorder.net
51102>>>>>
51102>>>>>
51102>>>>>        move clorderd.kinish_posothta to nQtykinhsh
51103>>>>>        move clorderd.unitprice   To nTimhMon
51104>>>>>        if ((nQtykinhsh<>0) or (nTimhMon<>0)) begin
51106>>>>>           Move (round_number((nQtykinhsh*nTimhMon),2)) to nQtyTimhMon
51107>>>>>           move clorderd.pcdisc     To nPctEkpt
51108>>>>>           move clorderd.posodisc   To nPosoEkpt
51109>>>>>           Move  (Round_number(((nQtyTimhMon*nPctEkpt/100)),2)) to nPosoEkpt
51110>>>>>           Move (nQtyTimhMon-nPosoEkpt)                         To nPosoNet
51111>>>>>           move nPosonet to clorderd.kinhsh_net
51112>>>>>           move clorderd.pcfpa      To nPctFpa
51113>>>>>           move clorderd.posofpa    To nPosoFpa
51114>>>>>           Move (Round_number(((nPosoNet*nPctFpa/100)),2)) to nPosoFpa
51115>>>>>           move nPosoFpa to clorderd.kinhsh_fpa
51116>>>>>           Move (nPosoNet+nPosoFpa) to npososynolo
51117>>>>>           move npososynolo to clorderd.kinhsh_poso
51118>>>>>           add clorderd.kinish_posothta to clorder.qtydtl
51119>>>>>           add clorderd.kinhsh_poso     to clorder.posodtl
51120>>>>>        end
51120>>>>>>
51120>>>>>
51120>>>>>
51120>>>>>
51120>>>>>
51120>>>>>        // Insert Code Here
51120>>>>>    End_Procedure   // Update
51121>>>>>
51121>>>>>    Procedure Entry_clorder_fpa Integer iField number nfpa
51122>>>>>         Local Integer Changed
51123>>>>>         string sitem
51123>>>>>         Get Field_Changed_State iField to Changed
51124>>>>>         If ( Changed=0 AND nfpa = 0) Begin
51126>>>>>            clear item
51127>>>>>            move clorderd.item_code to sitem
51128>>>>>            move sitem to iteml.item_code
51129>>>>>            find eq iteml by index.5
51130>>>>>>
51130>>>>>            move iteml.fpa_pososto to nfpa
51131>>>>>            Set Field_Default_Value iField to nfpa
51132>>>>>         End
51132>>>>>>
51132>>>>>    end_procedure
51133>>>>>
51133>>>>>  // Procedure entry_clorderd_itemcode Integer iField string itemcode
51133>>>>>  //   Local Integer Changed
51133>>>>>  //   string sitem sprom
51133>>>>>  //   If (itemcode <>'') Begin
51133>>>>>  //      clear witemcl
51133>>>>>  //      get field_current_value of clorderd_dd field clorderd.item_code   to sitem
51133>>>>>  //      get field_current_value of clorder_dd  field clorder.clients_code to sprom
51133>>>>>  //      move sitem to witemcl.item_code
51133>>>>>  //      move sprom to witemcl.client_code
51133>>>>>  //      find eq witemcl by index.1
51133>>>>>  //      move witemcl.client_itemcode to itemcode
51133>>>>>  //      Set Field_Default_Value (iField+2) to itemcode
51133>>>>>  //   end
51133>>>>>  // end_Procedure
51133>>>>>
51133>>>>>    Procedure entry_clorderd_price Integer iField number nprice
51134>>>>>      Local Integer Changed
51135>>>>>      string sitem sprom
51135>>>>>      Get Field_Changed_State iField to Changed
51136>>>>>      If ( Changed=0 AND nprice = 0) Begin
51138>>>>>         clear witemcl                              
51139>>>>>         Get File_Field_Current_Value File_Field clorder.clients_code   to sProm
51140>>>>>         Get File_Field_Current_Value File_Field clorderd.item_code     to sItem
51141>>>>>//         get field_current_value of clorderd_dd field clorderd.item_code   to sitem
51141>>>>>//         get field_current_value of clorder_dd  field clorder.clients_code to sprom
51141>>>>>         move sitem to witemcl.item_code
51142>>>>>         move sprom to witemcl.client_code
51143>>>>>         find eq witemcl by index.1
51144>>>>>>
51144>>>>>         move witemcl.client_price to nprice
51145>>>>>         Set Field_Default_Value iField to nprice
51146>>>>>      end
51146>>>>>>
51146>>>>>    end_Procedure
51147>>>>>
51147>>>>>
51147>>>>>
51147>>>>>    Procedure Define_Fields
51148>>>>>        Forward Send Define_Fields
51150>>>>>        //DDB-Generated-Code-Location
51150>>>>>        //DDB-DefineFieldStart
51150>>>>>
51150>>>>>        Set Main_File            To Clorderd.File_Number
51151>>>>>        Set Cascade_Delete_State To FALSE
51152>>>>>
51152>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
51153>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
51154>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51155>>>>>
51155>>>>>        // Parent (Server) file structure...............
51155>>>>>        Send Add_Server_File  Clorder.File_Number
51156>>>>>
51156>>>>>        // External (System) file structure.............
51156>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
51157>>>>>        Send Add_System_File  Iteml.File_Number  DD_LOCK_ON_ALL
51158>>>>>        Send Add_System_File  Witemcl.File_Number  DD_LOCK_ON_ALL
51159>>>>>
51159>>>>>        // Field-based properties.......................
51159>>>>>
51159>>>>>        // Clorderd.Company_Code
51159>>>>>
51159>>>>>        // Clorderd.Branch_Code
51159>>>>>
51159>>>>>        // Clorderd.Year_Year
51159>>>>>
51159>>>>>        // Clorderd.Clients_Code
51159>>>>>
51159>>>>>        // Clorderd.Aa_Par
51159>>>>>
51159>>>>>        // Clorderd.Rec0
51159>>>>>
51159>>>>>        // Clorderd.Item_Code
51159>>>>>
51159>>>>>        // Clorderd.Client_Item
51159>>>>>
51159>>>>>        // Clorderd.Qty
51159>>>>>
51159>>>>>        // Clorderd.Net
51159>>>>>
51159>>>>>        // Clorderd.Pcdisc
51159>>>>>
51159>>>>>        // Clorderd.Pcfpa
51159>>>>>        Set Field_Entry_msg        Field Clorderd.Pcfpa To Entry_clorder_fpa
51160>>>>>
51160>>>>>        // Clorderd.Posodisc
51160>>>>>
51160>>>>>        // Clorderd.Posofpa
51160>>>>>
51160>>>>>        // Clorderd.Posoextra
51160>>>>>
51160>>>>>        // Clorderd.Posototal
51160>>>>>
51160>>>>>        // Clorderd.Unitprice
51160>>>>>        Set Field_Entry_msg        Field Clorderd.Unitprice To entry_clorderd_price
51161>>>>>
51161>>>>>        // Clorderd.Ourdate
51161>>>>>        Set Field_Mask_Type        Field Clorderd.Ourdate To MASK_DATE_WINDOW
51162>>>>>
51162>>>>>        // Clorderd.Rial_Date
51162>>>>>        Set Field_Mask_Type        Field Clorderd.Rial_Date To MASK_DATE_WINDOW
51163>>>>>
51163>>>>>        // Clorderd.Finish
51163>>>>>        Set Field_Mask             Field Clorderd.Finish To "#"
51164>>>>>        Set Field_Mask_Type        Field Clorderd.Finish To MASK_NUMERIC_WINDOW
51165>>>>>
51165>>>>>        // Clorderd.Clorder_Recr
51165>>>>>
51165>>>>>        // Clorderd.Kinish_Posothta
51165>>>>>
51165>>>>>        // Clorderd.Kinhsh_Poso
51165>>>>>
51165>>>>>        // Clorderd.Kinhsh_Fpa
51165>>>>>
51165>>>>>        // Clorderd.Kinhsh_Net
51165>>>>>
51165>>>>>        // Clorderd.Rial_Qty
51165>>>>>
51165>>>>>        // Clorderd.Akyrh
51165>>>>>        Set Field_Mask             Field Clorderd.Akyrh To "#"
51166>>>>>        Set Field_Mask_Type        Field Clorderd.Akyrh To MASK_NUMERIC_WINDOW
51167>>>>>
51167>>>>>        // Clorderd.Ypol_Qty
51167>>>>>
51167>>>>>        // Clorderd.Akyrh_Qty
51167>>>>>
51167>>>>>        // Clorderd.Epistrofh_Qty
51167>>>>>
51167>>>>>        // Clorderd.Status
51167>>>>>        Set Field_Mask             Field Clorderd.Status To "#"
51168>>>>>        Set Field_Mask_Type        Field Clorderd.Status To MASK_NUMERIC_WINDOW
51169>>>>>
51169>>>>>        // Clorderd.Date
51169>>>>>        Set Field_Mask_Type        Field Clorderd.Date To MASK_DATE_WINDOW
51170>>>>>
51170>>>>>        // Clorderd.Recr
51170>>>>>
51170>>>>>        // Clorderd.Wax_Recr
51170>>>>>
51170>>>>>        // Clorderd.Pmoves_Recr
51170>>>>>
51170>>>>>        // Clorderd.Module
51170>>>>>
51170>>>>>        //DDB-DefineFieldEnd
51170>>>>>    End_Procedure    // Define_Fields
51171>>>>>
51171>>>>>    // Field_Defaults:
51171>>>>>    // This procedure is used to establish default field values.
51171>>>>>
51171>>>>>    Procedure Field_Defaults
51172>>>>>        Forward Send Field_Defaults
51174>>>>>        //DDB-Generated-Code-Location
51174>>>>>        //DDB-FieldDefaultStart
51174>>>>>        //DDB-FieldDefaultEnd
51174>>>>>    End_Procedure    // Field_Defaults
51175>>>>>
51175>>>>>End_Class    // Clorderd_DataDictionary
51176>>>>>//DDB-FileEnd
51176>>>    use sl001.sl
51176>>>    
51176>>>    
51176>>>    //AB-StoreTopEnd
51176>>>
51176>>>    //AB-IgnoreStart
51176>>>
51176>>>    Use dbView.Sub
51176>>>    Use DFAllEnt.pkg
51176>>>    Use dbForm.Sub
51176>>>    Use dbTabdlg.Sub
51176>>>    Use dbCmbfrm.Sub
51176>>>    Use Txtbox.Sub
51176>>>    Use dbGrid.Sub
51176>>>    Use Chkbox.Sub
51176>>>
51176>>>    Use COMPANY.DD
51176>>>    Use BRANCH.DD
51176>>>    Use YEAR.DD
51176>>>    Use CTYPKIN.DD
51176>>>    Use CFLAGKIN.DD
INCLUDING FILE: CFLAGKIN.DD
51176>>>>>//DDB-FileStart
51176>>>>>//DDB-HeaderStart
51176>>>>>
51176>>>>>// File Name : CFLAGKIN.DD
51176>>>>>// Class Name: Cflagkin_DataDictionary
51176>>>>>// Revision  : 28
51176>>>>>// Version   : 2
51176>>>>>
51176>>>>>Use  Windows           // Basic Definitions
51176>>>>>Use  DataDict          // DataDictionary Class Definition
51176>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51176>>>>>
51176>>>>>Open Cflagkin
51178>>>>>Open Ctypkin
51180>>>>>Open Sysrecc
51182>>>>>Open Syscurxr
51184>>>>>
51184>>>>>//DDB-HeaderEnd
51184>>>>>//DDB-ValidationStart
51184>>>>>
51184>>>>>Register_Object Cflagkin_Flag
51184>>>>>
51184>>>>>Object Cflagkin_Flag  is a CodeValidationTable
51186>>>>>    Set Type_Value        To "CFLAGS"
51187>>>>>    //DDB-ValidationCustomStart
51187>>>>>    //DDB-ValidationCustomEnd
51187>>>>>End_Object   // Cflagkin_Flag
51188>>>>>//DDB-ValidationEnd
51188>>>>>
51188>>>>>Class Cflagkin_DataDictionary  is a DataDictionary
51189>>>>>
51189>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
51190>>>>>        String lsError_Message
51191>>>>>        Case Begin
51191>>>>>            Case (iError_Num = 7001)
51193>>>>>                Move "DDC 008:ƒœ¤ œ§ «¨â§¦¤«˜  Flags ˜¤à «à¤ 2 ¯ž­åà¤" to lsError_Message
51194>>>>>            Case Break
51195>>>>>            Case (iError_Num = 7002)
51198>>>>>                Move "DDC 008:ƒœ¤ œ§ «¨â§¦¤«˜  Flags £ž›œ¤ ¡á" to lsError_Message
51199>>>>>            Case Break
51200>>>>>            Case Else
51200>>>>>                Forward Send Operation_Not_Allowed iError_Num
51202>>>>>        Case End
51202>>>>>        Error iError_Num lsError_Message
51203>>>>>>
51203>>>>>    End_Procedure // operation_not_allowed
51204>>>>>
51204>>>>>    Function Validate_Save  Returns Integer
51205>>>>>        Integer iReturnVal
51206>>>>>        Forward Get Validate_Save  To iReturnVal
51208>>>>>        If (Not(iReturnVal)) Begin
51210>>>>>                 If (Length(Trim(Cflagkin.Cflagkin_Flag))>2)    Move 7001 to iReturnVal
51213>>>>>            Else If (Cflagkin.Flag_Numeric=0)                   Move 7002 to iReturnVal
51217>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
51220>>>>>        End
51220>>>>>>
51220>>>>>        Function_Return iReturnVal
51221>>>>>    End_Function   // Validate_Save
51222>>>>>
51222>>>>>    Procedure Update
51223>>>>>        Forward Send Update
51225>>>>>        // Insert Code Here
51225>>>>>//        Move SysCurXR.Company_Code  to Cflagkin.Company_Code
51225>>>>>//        Move SysCurXR.Branch_Code   to Cflagkin.Branch_Code
51225>>>>>//        Move SysCurXR.Year_Year     to Cflagkin.Year_Year
51225>>>>>        Move Ctypkin.Ctypkin_Code   to Cflagkin.Ctypkin_Code
51226>>>>>        Move Cflagkin.Cflagkin_Flag to Cflagkin.Flag_Numeric
51227>>>>>    End_Procedure   // Update
51228>>>>>
51228>>>>>    Procedure Creating
51229>>>>>        Forward Send Creating
51231>>>>>        // Insert Code Here
51231>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Cflagkin.Cflagkin_Rec0)))))) to Cflagkin.Cflagkin_Recr
51232>>>>>    End_Procedure   // Creating
51233>>>>>
51233>>>>>    // Define_Fields:
51233>>>>>    // This procedure is used to set up all data-dictionary rules.
51233>>>>>
51233>>>>>    Procedure Define_Fields
51234>>>>>        Forward Send Define_Fields
51236>>>>>        //DDB-Generated-Code-Location
51236>>>>>        //DDB-DefineFieldStart
51236>>>>>
51236>>>>>        Set Main_File            To Cflagkin.File_Number
51237>>>>>        Set Cascade_Delete_State To FALSE
51238>>>>>
51238>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
51239>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
51240>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51241>>>>>
51241>>>>>        // Parent (Server) file structure...............
51241>>>>>        Send Add_Server_File  Ctypkin.File_Number
51242>>>>>
51242>>>>>        // External (System) file structure.............
51242>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
51243>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
51244>>>>>
51244>>>>>        Define_Auto_Increment  Sysrecc.Cflagkin_Rec0  To Cflagkin.Cflagkin_Rec0
51247>>>>>
51247>>>>>        // Field-based properties.......................
51247>>>>>
51247>>>>>        // Cflagkin.Company_Code
51247>>>>>
51247>>>>>        // Cflagkin.Branch_Code
51247>>>>>
51247>>>>>        // Cflagkin.Year_Year
51247>>>>>
51247>>>>>        // Cflagkin.Ctypkin_Code
51247>>>>>
51247>>>>>        // Cflagkin.Cflagkin_Flag
51247>>>>>        Set Field_Value_Table      Field Cflagkin.Cflagkin_Flag To (Cflagkin_Flag(Self))
51248>>>>>
51248>>>>>        // Cflagkin.Ctypkin_Recr
51248>>>>>
51248>>>>>        // Cflagkin.Cflagkin_Descr
51248>>>>>
51248>>>>>        // Cflagkin.Cflagkin_Rec0
51248>>>>>        Set Field_Options          Field Cflagkin.Cflagkin_Rec0 To DD_AUTOFIND   
51249>>>>>
51249>>>>>        // Cflagkin.Cflagkin_Recr
51249>>>>>
51249>>>>>        // Cflagkin.Flag_Numeric
51249>>>>>
51249>>>>>        //DDB-DefineFieldEnd
51249>>>>>    End_Procedure    // Define_Fields
51250>>>>>
51250>>>>>    // Field_Defaults:
51250>>>>>    // This procedure is used to establish default field values.
51250>>>>>
51250>>>>>    Procedure Field_Defaults
51251>>>>>        Forward Send Field_Defaults
51253>>>>>        //DDB-Generated-Code-Location
51253>>>>>        //DDB-FieldDefaultStart
51253>>>>>        //DDB-FieldDefaultEnd
51253>>>>>    End_Procedure    // Field_Defaults
51254>>>>>
51254>>>>>End_Class    // Cflagkin_DataDictionary
51255>>>>>//DDB-FileEnd
51255>>>    Use SYSCURXR.DD
51255>>>    
51255>>>    //AB-IgnoreEnd
51255>>>
51255>>>    ACTIVATE_VIEW Activate_V3 FOR V3
51259>>>
51259>>>    Object V3 is a dbViewSub
51261>>>
51261>>>        //AB-StoreTopStart
51261>>>        property string psrecr public ''
51263>>>        Property String psCurXr Public ''
51265>>>        
51265>>>        Object sysrecc is a sysrecc_DataDictionary
51267>>>        End_Object    // sysrecc
51268>>>        
51268>>>        Object Company_DDF2 is a Company_DataDictionary
51270>>>        End_Object    // Company_DDF2
51271>>>        
51271>>>        Object Branch_DDF2 is a Branch_DataDictionary
51273>>>            Set DDO_Server to (Company_DDF2(self))
51274>>>        End_Object    // Branch_DDF2
51275>>>        
51275>>>        Object Year_DDF2 is a Year_DataDictionary
51277>>>            Set DDO_Server to (Branch_DDF2(self))
51278>>>        End_Object    // Year_DDF2
51279>>>        
51279>>>        Object Company_DDR is a Company_DataDictionary
51281>>>        End_Object    // Company_DDR
51282>>>        
51282>>>        Object Branch_DDR is a Branch_DataDictionary
51284>>>            Set DDO_Server to (Company_DDR(self))
51285>>>        End_Object    // Branch_DDR
51286>>>        
51286>>>        Object Year_DDR is a Year_DataDictionary
51288>>>            Set DDO_Server to (Branch_DDR(self))
51289>>>        End_Object    // Year_DDR
51290>>>        
51290>>>        Object Ctypkin_DDR is a Ctypkin_DataDictionary
51292>>>            Set piMustNOTConstrain(Self)) to True
51293>>>        End_Object    // Ctypkin_DDR
51294>>>        
51294>>>        Object Cflagkin_DDR is a Cflagkin_DataDictionary
51296>>>            Set DDO_Server to (Ctypkin_DDR(self))
51297>>>            Set Constrain_File to Ctypkin.File_Number
51298>>>        End_Object    // Cflagkin_DDR
51299>>>        
51299>>>        Object Ctypkin_DDW is a Ctypkin_DataDictionary
51301>>>            Set piMustNOTConstrain(Self)) to True
51302>>>        End_Object    // Ctypkin_DDR
51303>>>        
51303>>>        Object Cflagkin_DDW is a Cflagkin_DataDictionary
51305>>>            Set DDO_Server to (Ctypkin_DDW(self))
51306>>>        End_Object    // Cflagkin_DDR
51307>>>        
51307>>>        Object Btypkin_DDR is a Btypkin_DataDictionary
51309>>>            Set piMustNOTConstrain(Self)) to True
51310>>>        End_Object    // Btypkin_DDR
51311>>>        
51311>>>        Object Bflagkin_DDR is a Bflagkin_DataDictionary
51313>>>            Set DDO_Server to (Btypkin_DDR(self))
51314>>>            Set Constrain_File to Btypkin.File_Number
51315>>>        End_Object    // Bflagkin_DDR
51316>>>        
51316>>>        Object Btypkin_DDW is a Btypkin_DataDictionary
51318>>>            Set piMustNOTConstrain(Self)) to True
51319>>>        End_Object    // Btypkin_DDW
51320>>>        
51320>>>        Object Bflagkin_DDW is a Bflagkin_DataDictionary
51322>>>            Set DDO_Server to (Btypkin_DDW(self))
51323>>>        End_Object    // Bflagkin_DDR
51324>>>        
51324>>>        Object Wtypkin_DDR is a Wtypkin_DataDictionary
51326>>>            Set piMustNOTConstrain(Self)) to True
51327>>>        End_Object    // Wtypkin_DDR
51328>>>        
51328>>>        Object Wtypkin_DDW is a Wtypkin_DataDictionary
51330>>>            Set piMustNOTConstrain(Self)) to True
51331>>>        End_Object    // Wtypkin_DDR
51332>>>        
51332>>>        Object Wflagkin_DDW is a Wflagkin_DataDictionary
51334>>>            Set DDO_Server to (Wtypkin_DDW(self))
51335>>>        End_Object    // Wflagkin_DDR
51336>>>        
51336>>>        Object Wflagkin_DDR is a Wflagkin_DataDictionary
51338>>>            Set DDO_Server to (Wtypkin_DDR(self))
51339>>>            Set Constrain_File to Wtypkin.File_Number
51340>>>        End_Object    // Wflagkin_DDR
51341>>>        
51341>>>        Object Clients_DDR is a Clients_DataDictionary
51343>>>            Set piMustNOTConstrain(Self)) to True
51344>>>        End_Object    // Clients_DDR
51345>>>        
51345>>>        Object CN_DDR is a CN_DataDictionary
51347>>>            Set DDO_Server to (Clients_DDR(self))
51348>>>            set constrain_file to clients.file_number
51349>>>        End_Object    // CN_DDR
51350>>>        
51350>>>        Object Clients_DDW is a Clients_DataDictionary
51352>>>            Set piMustNOTConstrain(Self)) to True
51353>>>        End_Object    // Clients_DDR
51354>>>        
51354>>>        Object CN_DDW is a CN_DataDictionary
51356>>>            Set DDO_Server to (Clients_DDW(self))
51357>>>        End_Object    // CN_DDR
51358>>>        
51358>>>        
51358>>>        Object BaxioKat_DDR is a BaxioKat_DataDictionary
51360>>>        End_Object    // BaxioKat_DDR
51361>>>        
51361>>>        Object BaxioKat_DDW is a BaxioKat_DataDictionary
51363>>>        End_Object    // BaxioKat_DDW
51364>>>        
51364>>>        Object Baxio_DDR is a Baxio_DataDictionary
51366>>>            Set piMustNOTConstrain(Self)) to True
51367>>>            set pifromxrhsh(self))        to true
51368>>>            Set DDO_Server to (BaxioKat_DDR(self))
51369>>>        End_Object    // Baxio_DDR
51370>>>        
51370>>>        Object Baxio_DDW is a Baxio_DataDictionary
51372>>>        
51372>>>            Set piMustNOTConstrain(Self)) to True
51373>>>            set pifromxrhsh(self))        to true
51374>>>        
51374>>>            Set DDO_Server to (BaxioKat_DDW(self))
51375>>>        
51375>>>            Set Field_Options Field Baxio.Baxio_Status      To DD_Clear_Field_Options DD_DISPLAYONLY
51376>>>            Set Field_Options Field Baxio.Baxio_Place       To DD_Clear_Field_Options DD_DISPLAYONLY
51377>>>            Set Field_Options Field Baxio.Baxio_Code_In     To DD_Clear_Field_Options DD_DISPLAYONLY
51378>>>            Set Field_Options Field Baxio.Baxio_Epon_In     To DD_Clear_Field_Options DD_DISPLAYONLY
51379>>>            Set Field_Options Field Baxio.Baxio_Fpar_In     To DD_Clear_Field_Options DD_DISPLAYONLY
51380>>>            Set Field_Options Field Baxio.Baxio_Code_Out    To DD_Clear_Field_Options DD_DISPLAYONLY
51381>>>            Set Field_Options Field Baxio.Baxio_Epon_Out    To DD_Clear_Field_Options DD_DISPLAYONLY
51382>>>            Set Field_Options Field Baxio.Baxio_Fpar_Out    To DD_Clear_Field_Options DD_DISPLAYONLY
51383>>>            Set Field_Options Field Baxio.Baxio_Lepon       To DD_Clear_Field_Options DD_DISPLAYONLY
51384>>>            Set Field_Options Field Baxio.Baxio_Lpar        To DD_Clear_Field_Options DD_DISPLAYONLY
51385>>>            Set Field_Options Field Baxio.Baxio_Lixi_Yyyy   To DD_Clear_Field_Options DD_DISPLAYONLY
51386>>>            Set Field_Options Field Baxio.Baxio_Lixi_Mm     To DD_Clear_Field_Options DD_DISPLAYONLY
51387>>>            Set Field_Options Field Baxio.Baxio_Lixi_Dd     To DD_Clear_Field_Options DD_DISPLAYONLY
51388>>>            Set Field_Options Field Baxio.Baxio_Bmove_Laa   To DD_Clear_Field_Options DD_DISPLAYONLY
51389>>>            Set Field_Options Field Baxio.Baxio_Place       To DD_Clear_Field_Options DD_DISPLAYONLY
51390>>>        
51390>>>        End_Object    // Baxio_DDW
51391>>>        
51391>>>        Object Wapokat_DDW is a Wapokat_DataDictionary
51393>>>        End_Object    // Wapokat_DDW
51394>>>        
51394>>>        Object Wapomast_DDW is a Wapomast_DataDictionary
51396>>>            Set DDO_Server to (Wapokat_DDW(self))
51397>>>        End_Object    // Wapomast_DDW
51398>>>        
51398>>>        Object Wax_DDW is a Wax_DataDictionary
51400>>>            Set piMustNOTConstrain(Self)) to True
51401>>>            Set DDO_Server to (Wapomast_DDW(self))
51402>>>        End_Object    // Wax_DDW
51403>>>        
51403>>>        Object Wapokat_DDR is a Wapokat_DataDictionary
51405>>>        End_Object    // Wapokat_DDR
51406>>>        
51406>>>        Object Wapomast_DDR is a Wapomast_DataDictionary
51408>>>            Set DDO_Server to (Wapokat_DDR(self))
51409>>>        End_Object    // Wapomast_DDR
51410>>>        
51410>>>        Object Wax_DDR is a Wax_DataDictionary
51412>>>            Set piMustNOTConstrain(Self)) to True
51413>>>            Set DDO_Server to (Wapomast_DDR(self))
51414>>>        End_Object    // Wax_DDR
51415>>>        
51415>>>        Object Fpa_DDR is a Fpa_DataDictionary
51417>>>        End_Object    // Fpa_DDR
51418>>>        
51418>>>        Object Fpa_DDW is a Fpa_DataDictionary
51420>>>        End_Object    // Fpa_DDW
51421>>>        
51421>>>        Object Witemkat_DDR is a Witemkat_DataDictionary
51423>>>        End_Object    // Witemkat_DDR
51424>>>        
51424>>>        Object Units_DDR is a Units_DataDictionary
51426>>>        End_Object    // Units_DDR
51427>>>        
51427>>>        Object Item_DDR is a Item_DataDictionary
51429>>>            Set DDO_Server to (Witemkat_DDR(self))
51430>>>            Set DDO_Server to (Units_DDR(self))
51431>>>            Set DDO_Server to (Fpa_DDR(self))
51432>>>        End_Object    // Item_DDR
51433>>>        
51433>>>        Object Witemx_DDR is a Witemx_DataDictionary
51435>>>            Set DDO_Server to (Item_DDR(self))
51436>>>            Set piMustNOTConstrain(Self)) to True
51437>>>        End_Object    // Witemx_DDR
51438>>>        
51438>>>        Object Witemxt_DDR is a Witemxt_DataDictionary
51440>>>            Set DDO_Server to (Witemx_DDR(self))
51441>>>            Set Constrain_File to Witemx.File_Number
51442>>>        End_Object    // Witemx_DDR
51443>>>        
51443>>>        Object Witemkat_DDW is a Witemkat_DataDictionary
51445>>>        End_Object    // Witemkat_DDW
51446>>>        
51446>>>        Object Units_DDW is a Units_DataDictionary
51448>>>        End_Object    // Units_DDW
51449>>>        
51449>>>        Object Item_DDW is a Item_DataDictionary
51451>>>            Set DDO_Server to (Witemkat_DDW(self))
51452>>>            Set DDO_Server to (Units_DDW(self))
51453>>>            Set DDO_Server to (Fpa_DDW(self))
51454>>>        End_Object    // Item_DDW
51455>>>        
51455>>>        Object Witemx_DDW is a Witemx_DataDictionary
51457>>>            Set DDO_Server to (Item_DDW(self))
51458>>>            Set piMustNOTConstrain(Self)) to True
51459>>>        End_Object    // Witemx_DDW
51460>>>        
51460>>>        Object Hmgio_DDR is a Hmgio_DataDictionary
51462>>>        End_Object    // Hmgio_DDR
51463>>>        
51463>>>        Object Hmgio_DDW is a Hmgio_DataDictionary
51465>>>        End_Object    // Hmgio_DDW
51466>>>        
51466>>>        Object HmgioW_DDR is a HmgioW_DataDictionary
51468>>>        End_Object    // HmgioW_DDR
51469>>>        
51469>>>        Object HmgioW_DDW is a HmgioW_DataDictionary
51471>>>        End_Object    // HmgioW_DDW
51472>>>        
51472>>>        Object Witemxt_DDW is a Witemxt_DataDictionary
51474>>>            Set DDO_Server to (Witemx_DDW(self))
51475>>>        End_Object    // Witemx_DDW
51476>>>        
51476>>>        Object HmCtyp_DDR is a HmCtyp_DataDictionary
51478>>>            Set DDO_Server to (Ctypkin_DDR(self))
51479>>>            Set DDO_Server to (Hmgio_DDR(self))
51480>>>        End_Object    // HmCtyp_DDR
51481>>>        
51481>>>        Object HmCtyp_DDW is a HmCtyp_DataDictionary
51483>>>            Set DDO_Server to (Ctypkin_DDW(self))
51484>>>            Set DDO_Server to (Hmgio_DDW(self))
51485>>>        End_Object    // HmCtyp_DDW
51486>>>        
51486>>>        Object HmWtyp_DDR is a HmWtyp_DataDictionary
51488>>>            Set DDO_Server to (Wtypkin_DDR(self))
51489>>>            Set DDO_Server to (HmgioW_DDR(self))
51490>>>        End_Object    // HmWtyp_DDR
51491>>>        
51491>>>        Object HmWtyp_DDW is a HmWtyp_DataDictionary
51493>>>            Set DDO_Server to (Wtypkin_DDW(self))
51494>>>            Set DDO_Server to (HmgioW_DDW(self))
51495>>>        End_Object    // HmWtyp_DDW
51496>>>        
51496>>>        Object Ptyppar_DDR is a Ptyppar_DataDictionary
51498>>>            Set DDO_Server to (Ctypkin_DDR(self))
51499>>>            Set DDO_Server to (Wtypkin_DDR(self))
51500>>>            Set piMustNOTConstrain(Self)) to True
51501>>>        End_Object    // Ptyppar_DDR
51502>>>        
51502>>>        Object Ptyppar_DDW is a Ptyppar_DataDictionary
51504>>>            Set DDO_Server to (Ctypkin_DDW(self))
51505>>>            Set DDO_Server to (Wtypkin_DDW(self))
51506>>>            Set piMustNOTConstrain(Self)) to True
51507>>>        End_Object    // Ptyppar_DDR
51508>>>        
51508>>>        Object ptypmet_DDW is a ptypmet_DataDictionary
51510>>>            Set DDO_Server to (ptyppar_DDW(self))
51511>>>            Set Constrain_File to ptyppar.File_Number
51512>>>        End_Object    // ptypmet_DDW
51513>>>        
51513>>>        Object ptypmet_DDR is a ptypmet_DataDictionary
51515>>>            Set DDO_Server to (ptyppar_DDR(self))
51516>>>            Set Constrain_File to ptyppar.File_Number
51517>>>        End_Object    // ptypmet_DDR
51518>>>        
51518>>>        Object Pseira_DDW is a Pseira_DataDictionary
51520>>>            Set DDO_Server to (Ptyppar_DDW(self))
51521>>>        End_Object    // Pseira_DDR
51522>>>        
51522>>>        Object Pseira_DDR is a Pseira_DataDictionary
51524>>>            Set DDO_Server to (Ptyppar_DDR(self))
51525>>>            Set Constrain_File to Ptyppar.File_Number
51526>>>        End_Object    // Pseira_DDR
51527>>>        
51527>>>        Object BkinKat_DDR is a BkinKat_DataDictionary
51529>>>            Set DDO_Server to (Btypkin_DDR(self))
51530>>>            Set DDO_Server to (Baxiokat_DDR(self))
51531>>>        End_Object    // BkinKat_DDR
51532>>>        
51532>>>        Object BkinKat_DDW is a BkinKat_DataDictionary
51534>>>            Set DDO_Server to (Btypkin_DDW(self))
51535>>>            Set DDO_Server to (Baxiokat_DDW(self))
51536>>>        End_Object    // BkinKat_DDW
51537>>>        
51537>>>        
51537>>>        Object Country_DD2 is a Country_DataDictionary
51539>>>        End_Object    // Country_DD
51540>>>        
51540>>>        Object Towns_DD2 is a Towns_DataDictionary
51542>>>            Set DDO_Server to (Country_DD2(self))
51543>>>        End_Object    // Towns_DD
51544>>>        
51544>>>        Object Cities_DD2 is a Cities_DataDictionary
51546>>>            Set DDO_Server to (Towns_DD2(self))
51547>>>        End_Object    // Cities_DD
51548>>>        
51548>>>        Object Areas_DD2 is a Areas_DataDictionary
51550>>>        End_Object    // Areas_DD
51551>>>        
51551>>>        Object Payresp_DD2 is a Payresp_DataDictionary
51553>>>        End_Object    // Payresp_DD
51554>>>        
51554>>>        Object Clients_DD2 is a Clients_DataDictionary
51556>>>            Set DDO_Server to (Cities_DD2(self))
51557>>>            Set DDO_Server to (Areas_DD2(self))
51558>>>            Set DDO_Server to (Payresp_DD2(self))
51559>>>            set no_delete_state to true
51560>>>        End_Object
51561>>>        
51561>>>        Object Clorder_DD is a Clorder_DataDictionary
51563>>>            procedure update
51565>>>            end_procedure
51566>>>            procedure creating
51568>>>            end_procedure
51569>>>        End_Object    // Clorder_DD
51570>>>        
51570>>>        Object Clorderd_DD is a Clorderd_DataDictionary
51572>>>            Set DDO_Server to (clorder_DD(self))
51573>>>            begin_constraints
51575>>>              string srecr
51576>>>              get psrecr to srecr
51577>>>              constrain clorderd.clorder_recr eq srecr
51579>>>            end_constraints
51582>>>            procedure update
51584>>>            end_procedure
51585>>>            procedure creating
51587>>>            end_procedure
51588>>>        end_object
51589>>>        
51589>>>        Object Clorder_DD2 is a Clorder_DataDictionary
51591>>>            Set DDO_Server to (Clients_DD2(self))
51592>>>            Set Constrain_File to Clients.File_Number
51593>>>            procedure update
51595>>>            end_procedure
51596>>>            procedure creating
51598>>>            end_procedure
51599>>>        End_Object    // Clorder_DD
51600>>>        
51600>>>        Object Clorderd_DD2 is a Clorderd_DataDictionary
51602>>>            Set DDO_Server to (clorder_DD2(self))
51603>>>            Set Constrain_File to clorder.File_Number
51604>>>            procedure update
51606>>>            end_procedure
51607>>>            procedure creating
51609>>>            end_procedure
51610>>>        end_object
51611>>>        
51611>>>        Function Confirm_Delete_company Returns Integer
51613>>>            local integer rval
51614>>>            Get confirm "ƒ ˜š¨˜­ã „«˜ ¨œå˜ª ??" to rval
51615>>>            Function_Return rval
51616>>>        End_Function
51617>>>        
51617>>>        Function Confirm_Save_company Returns Integer
51619>>>            local integer NoSave Srvr Rec
51620>>>            Get Server to Srvr
51621>>>            Get Current_Record of Srvr to Rec
51622>>>            If Rec eq 0 ;               Get Confirm "„šš¨˜­ã Œâ˜ª „«˜ ¨œå˜ª ??" to NoSave
51625>>>            Function_Return NoSave
51626>>>        End_Function
51627>>>        
51627>>>        Function Save_header returns integer
51629>>>           Local integer Rec Changed Srvr
51630>>>           Get Server to Srvr
51631>>>           Get Current_Record of Srvr to Rec
51632>>>           Get Should_Save to Changed
51633>>>        
51633>>>        
51633>>>           If (Rec=0 AND Changed=0) Begin
51635>>>              Error 300 '¨â§œ  Œá ¨¦žšžŸœå „šš¨˜­ã „«˜ ¨œå˜ª !!'
51636>>>>
51636>>>              Function_Return 1
51637>>>           End
51637>>>>
51637>>>        
51637>>>           Send request_save_no_clear
51638>>>        
51638>>>        
51638>>>           Get Should_Save to Changed
51639>>>           Get Current_record of Srvr to Rec
51640>>>           If (Rec=0 OR Changed) ;              Function_return 1
51643>>>        end_function
51644>>>        
51644>>>        //AB-StoreTopEnd
51644>>>
51644>>>        Set Label to "„«˜ ¨å˜ - “§¦¡˜«á©«ž£˜ - •¨ã©ž"
51645>>>        Set Size to 294 517
51646>>>        Set Location to 1 3
51647>>>
51647>>>        //AB-DDOStart
51647>>>
51647>>>        Object Company_DD is a Company_DataDictionary
51649>>>
51649>>>            //AB-StoreStart
51649>>>                                                    
51649>>>                                                    
51649>>>                                                    
51649>>>            //AB-StoreEnd
51649>>>
51649>>>        End_Object    // Company_DD
51650>>>
51650>>>        Object Branch_DD is a Branch_DataDictionary
51652>>>            Set DDO_Server to (Company_DD(self))
51653>>>            Set Constrain_File to Company.File_Number
51654>>>
51654>>>            //AB-StoreStart
51654>>>                                                    
51654>>>                                                    
51654>>>                                                    
51654>>>            //AB-StoreEnd
51654>>>
51654>>>        End_Object    // Branch_DD
51655>>>
51655>>>        Object Year_DD is a Year_DataDictionary
51657>>>            Set DDO_Server to (Branch_DD(self))
51658>>>            Set Constrain_File to Branch.File_Number
51659>>>        End_Object    // Year_DD
51660>>>
51660>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
51662>>>        End_Object    // Ctypkin_DD
51663>>>
51663>>>        Object Cflagkin_DD is a Cflagkin_DataDictionary
51665>>>            Set DDO_Server to (Ctypkin_DD(self))
51666>>>        End_Object    // Cflagkin_DD
51667>>>
51667>>>        Object Syscurxr_DD is a Syscurxr_DataDictionary
51669>>>        End_Object    // Syscurxr_DD
51670>>>
51670>>>        Set Main_DD to (Company_DD(self))
51671>>>        Set Server to (Company_DD(self))
51672>>>
51672>>>        //AB-DDOEnd
51672>>>
51672>>>        Object Company_Company_Code is a dbFormSub
51674>>>            Entry_Item Company.Company_code
51675>>>            Set Size to 13 66
51676>>>            Set Location to 6 77
51677>>>            Set Label_Col_Offset to 2
51678>>>            Set Label_Justification_Mode to jMode_Right
51679>>>
51679>>>            //AB-StoreStart
51679>>>            Set Prompt_Object to (sl001(Current_object))
51680>>>            //AB-StoreEnd
51680>>>
51680>>>        End_Object    // Company_Company_Code
51681>>>
51681>>>        Object Company_Company_Name is a dbFormSub
51683>>>            Entry_Item Company.Company_name
51684>>>            Set Size to 13 285
51685>>>            Set Location to 22 77
51686>>>            Set Label_Col_Offset to 2
51687>>>            Set Label_Justification_Mode to jMode_Right
51688>>>
51688>>>            //AB-StoreStart
51688>>>            Set Prompt_Object to (sl001(Current_object))
51689>>>            
51689>>>            
51689>>>            //AB-StoreEnd
51689>>>
51689>>>        End_Object    // Company_Company_Name
51690>>>
51690>>>        Object Company_Logo is a dbFormSub
51692>>>            Entry_Item Company.Logo
51693>>>            Set Size to 13 285
51694>>>            Set Location to 37 77
51695>>>            Set Label_Col_Offset to 2
51696>>>            Set Label_Justification_Mode to jMode_Right
51697>>>        End_Object    // Company_Logo
51698>>>
51698>>>        Object dbTabDialogSub1 is a dbTabDialogSub
51700>>>
51700>>>            //AB-StoreTopStart
51700>>>                                                    
51700>>>            //AB-StoreTopEnd
51700>>>
51700>>>            Set Size to 225 506
51701>>>            Set Location to 52 4
51702>>>            Set Rotate_Mode to RM_Rotate
51703>>>            Set Border_Style to Border_Normal
51704>>>            Object TP_db1 is a dbTabPage
51706>>>
51706>>>                //AB-StoreTopStart
51706>>>                                                                        
51706>>>                //AB-StoreTopEnd
51706>>>
51706>>>                Set Label to "‘«¦ ®œå˜ „«˜ ¨œå˜ª"
51707>>>                Object Company_Company_Afm is a dbFormSub
51709>>>                    Entry_Item Company.Company_afm
51710>>>                    Set Size to 13 126
51711>>>                    Set Location to 10 71
51712>>>                    Set Label_Col_Offset to 2
51713>>>                    Set Label_Justification_Mode to jMode_Right
51714>>>                End_Object    // Company_Company_Afm
51715>>>
51715>>>                Object Company_Company_Addr is a dbFormSub
51717>>>                    Entry_Item Company.Company_addr
51718>>>                    Set Size to 13 285
51719>>>                    Set Location to 28 71
51720>>>                    Set Label_Col_Offset to 2
51721>>>                    Set Label_Justification_Mode to jMode_Right
51722>>>                End_Object    // Company_Company_Addr
51723>>>
51723>>>                Object Company_Company_Doy is a dbComboFormSub
51725>>>                    Entry_Item Company.Company_doy
51726>>>                    Set Size to 13 127
51727>>>                    Set Location to 44 70
51728>>>                    Set Label_Col_Offset to 2
51729>>>                    Set Label_Justification_Mode to jMode_Right
51730>>>                    Set Entry_State Item 0 to FALSE
51731>>>
51731>>>                    //AB-StoreStart
51731>>>                                                                                            
51731>>>                    Procedure Combo_Fill_List
51733>>>                        Forward Send Combo_Fill_List
51735>>>                    End_Procedure
51736>>>                    
51736>>>                    
51736>>>                    
51736>>>                    
51736>>>                    
51736>>>                    //AB-StoreEnd
51736>>>
51736>>>                End_Object    // Company_Company_Doy
51737>>>
51737>>>                Object Company_Company_J_Code is a dbComboFormSub
51739>>>                    Entry_Item Company.Company_j_code
51740>>>                    Set Size to 15 127
51741>>>                    Set Location to 61 70
51742>>>                    Set Label_Col_Offset to 2
51743>>>                End_Object    // Company_Company_J_Code
51744>>>
51744>>>                Object Company_Company_Tk is a dbFormSub
51746>>>                    Entry_Item Company.Company_tk
51747>>>                    Set Size to 13 83
51748>>>                    Set Location to 78 70
51749>>>                    Set Label_Col_Offset to 2
51750>>>                    Set Label_Justification_Mode to jMode_Right
51751>>>                End_Object    // Company_Company_Tk
51752>>>
51752>>>                Object Company_Company_Poli is a dbFormSub
51754>>>                    Entry_Item Company.Company_poli
51755>>>                    Set Size to 13 83
51756>>>                    Set Location to 95 70
51757>>>                    Set Label_Col_Offset to 2
51758>>>                    Set Label_Justification_Mode to jMode_Right
51759>>>                End_Object    // Company_Company_Poli
51760>>>
51760>>>                Object Company_Company_Tel is a dbFormSub
51762>>>                    Entry_Item Company.Company_tel
51763>>>                    Set Size to 13 83
51764>>>                    Set Location to 112 70
51765>>>                    Set Label_Col_Offset to 2
51766>>>                    Set Label_Justification_Mode to jMode_Right
51767>>>                End_Object    // Company_Company_Tel
51768>>>
51768>>>                Object Company_Company_Fax is a dbFormSub
51770>>>                    Entry_Item Company.Company_fax
51771>>>                    Set Size to 13 83
51772>>>                    Set Location to 128 70
51773>>>                    Set Label_Col_Offset to 2
51774>>>                    Set Label_Justification_Mode to jMode_Right
51775>>>                End_Object    // Company_Company_Fax
51776>>>
51776>>>                Object Company_Company_Email is a dbFormSub
51778>>>                    Entry_Item Company.Company_email
51779>>>                    Set Size to 13 83
51780>>>                    Set Location to 145 70
51781>>>                    Set Label_Col_Offset to 2
51782>>>                    Set Label_Justification_Mode to jMode_Right
51783>>>                End_Object    // Company_Company_Email
51784>>>
51784>>>                Object Company_Company_Resp is a dbFormSub
51786>>>                    Entry_Item Company.Company_resp
51787>>>                    Set Size to 13 285
51788>>>                    Set Location to 162 70
51789>>>                    Set Label_Col_Offset to 2
51790>>>                    Set Label_Justification_Mode to jMode_Right
51791>>>                End_Object    // Company_Company_Resp
51792>>>
51792>>>                Object TextBoxSub3 is a TextBoxSub
51794>>>                    Set Label to "€.”.‹"
51795>>>                    Set Auto_Size_State to FALSE
51796>>>                    Set TextColor to clWindow
51797>>>                    Set FontSize to 4 0
51798>>>                    Set Location to 13 9
51799>>>                    Set Size to 10 55
51800>>>                    Set Justification_Mode to jMode_Left
51801>>>                    Set TypeFace to "MS Sans Serif"
51802>>>                    Set Enabled_State to TRUE
51803>>>                End_Object    // TextBoxSub3
51804>>>
51804>>>                Object TextBoxSub4 is a TextBoxSub
51806>>>                    Set Label to "ƒ œçŸ¬¤©ž"
51807>>>                    Set Auto_Size_State to FALSE
51808>>>                    Set TextColor to clWindow
51809>>>                    Set FontSize to 4 0
51810>>>                    Set Location to 29 9
51811>>>                    Set Size to 10 55
51812>>>                    Set Justification_Mode to jMode_Left
51813>>>                    Set TypeFace to "MS Sans Serif"
51814>>>                    Set Enabled_State to TRUE
51815>>>                End_Object    // TextBoxSub4
51816>>>
51816>>>                Object TextBoxSub5 is a TextBoxSub
51818>>>                    Set Label to "T.K"
51819>>>                    Set Auto_Size_State to FALSE
51820>>>                    Set TextColor to clWindow
51821>>>                    Set FontSize to 4 0
51822>>>                    Set Location to 81 9
51823>>>                    Set Size to 10 55
51824>>>                    Set Justification_Mode to jMode_Left
51825>>>                    Set TypeFace to "MS Sans Serif"
51826>>>                    Set Enabled_State to TRUE
51827>>>                End_Object    // TextBoxSub5
51828>>>
51828>>>                Object TextBoxSub6 is a TextBoxSub
51830>>>                    Set Label to "æ¢ž"
51831>>>                    Set Auto_Size_State to FALSE
51832>>>                    Set TextColor to clWindow
51833>>>                    Set FontSize to 4 0
51834>>>                    Set Location to 98 9
51835>>>                    Set Size to 10 55
51836>>>                    Set Justification_Mode to jMode_Left
51837>>>                    Set TypeFace to "MS Sans Serif"
51838>>>                    Set Enabled_State to TRUE
51839>>>                End_Object    // TextBoxSub6
51840>>>
51840>>>                Object TextBoxSub7 is a TextBoxSub
51842>>>                    Set Label to "’ž¢â­à¤¦"
51843>>>                    Set Auto_Size_State to FALSE
51844>>>                    Set TextColor to clWindow
51845>>>                    Set FontSize to 4 0
51846>>>                    Set Location to 114 9
51847>>>                    Set Size to 10 55
51848>>>                    Set Justification_Mode to jMode_Left
51849>>>                    Set TypeFace to "MS Sans Serif"
51850>>>                    Set Enabled_State to TRUE
51851>>>                End_Object    // TextBoxSub7
51852>>>
51852>>>                Object TextBoxSub8 is a TextBoxSub
51854>>>                    Set Label to "€¨ Ÿ£æª Fax"
51855>>>                    Set Auto_Size_State to FALSE
51856>>>                    Set TextColor to clWindow
51857>>>                    Set FontSize to 4 0
51858>>>                    Set Location to 129 9
51859>>>                    Set Size to 10 55
51860>>>                    Set Justification_Mode to jMode_Left
51861>>>                    Set TypeFace to "MS Sans Serif"
51862>>>                    Set Enabled_State to TRUE
51863>>>                End_Object    // TextBoxSub8
51864>>>
51864>>>                Object TextBoxSub9 is a TextBoxSub
51866>>>                    Set Label to "Email"
51867>>>                    Set Auto_Size_State to FALSE
51868>>>                    Set TextColor to clWindow
51869>>>                    Set FontSize to 4 0
51870>>>                    Set Location to 146 9
51871>>>                    Set Size to 10 55
51872>>>                    Set Justification_Mode to jMode_Left
51873>>>                    Set TypeFace to "MS Sans Serif"
51874>>>                    Set Enabled_State to TRUE
51875>>>                End_Object    // TextBoxSub9
51876>>>
51876>>>                Object TextBoxSub10 is a TextBoxSub
51878>>>                    Set Label to "“§œçŸ¬¤¦ª"
51879>>>                    Set Auto_Size_State to FALSE
51880>>>                    Set TextColor to clWindow
51881>>>                    Set FontSize to 4 0
51882>>>                    Set Location to 163 9
51883>>>                    Set Size to 10 55
51884>>>                    Set Justification_Mode to jMode_Left
51885>>>                    Set TypeFace to "MS Sans Serif"
51886>>>                    Set Enabled_State to TRUE
51887>>>                End_Object    // TextBoxSub10
51888>>>
51888>>>                Object TextBoxSub14 is a TextBoxSub
51890>>>                    Set Label to "ƒ.Ž.“"
51891>>>                    Set Auto_Size_State to FALSE
51892>>>                    Set TextColor to clWindow
51893>>>                    Set FontSize to 4 0
51894>>>                    Set Location to 46 9
51895>>>                    Set Size to 10 55
51896>>>                    Set Justification_Mode to jMode_Left
51897>>>                    Set TypeFace to "MS Sans Serif"
51898>>>                    Set Enabled_State to TRUE
51899>>>                End_Object    // TextBoxSub14
51900>>>
51900>>>                Object Textbox1 is a Textbox
51902>>>                    Set Label to "„§áššœ¢£˜"
51903>>>                    Set Location to 64 7
51904>>>                    Set Size to 10 43
51905>>>                End_Object    // Textbox1
51906>>>
51906>>>                Object TextBoxSub49 is a TextBoxSub
51908>>>                    Set Label to "‰à› ¡æª SAP"
51909>>>                    Set Auto_Size_State to FALSE
51910>>>                    Set TextColor to clWindow
51911>>>                    Set FontSize to 4 0
51912>>>                    Set Location to 180 9
51913>>>                    Set Size to 10 55
51914>>>                    Set Justification_Mode to jMode_Left
51915>>>                    Set TypeFace to "MS Sans Serif"
51916>>>                    Set Enabled_State to TRUE
51917>>>                End_Object    // TextBoxSub49
51918>>>
51918>>>                Object Company_Sap_Code is a dbFormSub
51920>>>                    Entry_Item Company.Sap_code
51921>>>                    Set Size to 13 66
51922>>>                    Set Location to 179 70
51923>>>                    Set Label_Col_Offset to 2
51924>>>                    Set Label_Justification_Mode to jMode_Right
51925>>>                End_Object    // Company_Sap_Code
51926>>>
51926>>>
51926>>>                //AB-StoreStart
51926>>>                Set Label to "‘«¦ ®œå˜ „«˜ ¨å˜ª"
51927>>>                
51927>>>                //AB-StoreEnd
51927>>>
51927>>>            End_Object    // TP_db1
51928>>>
51928>>>            Object TP_db2 is a dbTabPage
51930>>>
51930>>>                //AB-StoreTopStart
51930>>>                                                                        
51930>>>                //AB-StoreTopEnd
51930>>>
51930>>>                Set Label to "‘«¦ ®œå˜ “§¦¡˜«˜©«ã£˜«¦ª"
51931>>>                Object Branch_table is a dbGridSub
51933>>>
51933>>>                    //AB-StoreTopStart
51933>>>                                                                                            
51933>>>                                                                                            
51933>>>                    //AB-StoreTopEnd
51933>>>
51933>>>                    Set Main_File to Branch.File_Number
51934>>>                    Set Server to (Branch_DD(self))
51935>>>                    Set Size to 79 493
51936>>>                    Set Location to 4 2
51937>>>                    Set Wrap_State to TRUE
51938>>>
51938>>>                    Begin_Row
51941>>>                        Entry_Item Branch.Branch_code
51942>>>                        Entry_Item Branch.Branch_name
51943>>>                        Entry_Item Branch.Branch_site
51944>>>                        Entry_Item Branch.Deop_logo
51945>>>                    End_Row
51950>>>
51950>>>                    Set Form_Width    item 0 to 108
51951>>>                    Set Header_Label  item 0 to "‰à› ¡æª"
51952>>>                    
51952>>>                    Set Form_Width    item 1 to 240
51953>>>                    Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
51954>>>                    
51954>>>                    Set Form_Width    item 2 to 40
51955>>>                    Set Header_Label  item 2 to "’¦£â˜ª"
51956>>>                    
51956>>>                    Set Form_Width    item 3 to 97
51957>>>                    Set Header_Label  item 3 to "’¦£â˜ª-ƒ„Ž"
51958>>>                    
51958>>>
51958>>>                    //AB-StoreStart
51958>>>                    set currentrowcolor to 11468799
51959>>>                    set currentcellcolor to 11468799
51960>>>                    Set child_table_state        to TRUE
51961>>>                    Function Child_entering returns Integer
51963>>>                    local integer rval
51964>>>                        Delegate Get Save_Header to rval
51966>>>                        function_return rval
51967>>>                    End_Function
51968>>>                    
51968>>>                    Function Confirm_Delete_branch Returns Integer
51970>>>                        local integer rval
51971>>>                        Get confirm "ƒ ˜š¨˜­ã “§¦¡˜«˜©«ã£˜«¦ª ??" to rval
51972>>>                        Function_Return rval
51973>>>                    End_Function
51974>>>                    
51974>>>                    
51974>>>                    Function Confirm_Save_branch Returns Integer
51976>>>                        local integer rval
51977>>>                        Get Confirm "„šš¨˜­ã “§¦¡˜«˜©«ã£˜«¦ª ??" to rval
51978>>>                        Function_Return rval
51979>>>                    End_Function
51980>>>                    
51980>>>                    Set Verify_Save_MSG       to GET_Confirm_save_branch
51981>>>                    Set Verify_Delete_MSG     to GET_Confirm_delete_branch
51982>>>                    
51982>>>                    Procedure refresh integer iMode
51984>>>                        local integer iRec
51985>>>                        Get Current_record of (branch_dd(Current_object)) to iRec
51986>>>                        if (irec > 0) begin
51988>>>                            Forward Send Refresh iMode
51990>>>                        end
51990>>>>
51990>>>                    End_procedure
51991>>>                    
51991>>>                    Procedure Next_Row
51993>>>                        Send Activate
51994>>>                        Set Current_Item to (Base_Item(self))
51995>>>                        Send Down_row
51996>>>                    End_Procedure
51997>>>                    
51997>>>                    
51997>>>                    
51997>>>                    
51997>>>                    //AB-StoreEnd
51997>>>
51997>>>                End_Object    // Branch_table
51998>>>
51998>>>                Object TextBoxSub34 is a TextBoxSub
52000>>>                    Set Label to "€.”.‹"
52001>>>                    Set Auto_Size_State to FALSE
52002>>>                    Set TextColor to clWindow
52003>>>                    Set FontSize to 4 0
52004>>>                    Set Location to 79 3
52005>>>                    Set Size to 10 55
52006>>>                    Set Justification_Mode to jMode_Left
52007>>>                    Set TypeFace to "MS Sans Serif"
52008>>>                    Set Enabled_State to TRUE
52009>>>                End_Object    // TextBoxSub34
52010>>>
52010>>>                Object branch_branch_Afm is a dbFormSub
52012>>>                    Entry_Item Branch.Branch_afm
52013>>>                    Set Server to (Branch_DD(self))
52014>>>                    Set Size to 13 77
52015>>>                    Set Location to 78 65
52016>>>                    Set Label_Col_Offset to 2
52017>>>                    Set Label_Justification_Mode to jMode_Right
52018>>>                End_Object    // branch_branch_Afm
52019>>>
52019>>>                Object TextBoxSub35 is a TextBoxSub
52021>>>                    Set Label to "ƒ.Ž.“"
52022>>>                    Set Auto_Size_State to FALSE
52023>>>                    Set TextColor to clWindow
52024>>>                    Set FontSize to 4 0
52025>>>                    Set Location to 79 147
52026>>>                    Set Size to 10 27
52027>>>                    Set Justification_Mode to jMode_Left
52028>>>                    Set TypeFace to "MS Sans Serif"
52029>>>                    Set Enabled_State to TRUE
52030>>>                End_Object    // TextBoxSub35
52031>>>
52031>>>                Object branch_branch_Doy is a dbComboFormSub
52033>>>                    Entry_Item Branch.Branch_doy
52034>>>                    Set Server to (Branch_DD(self))
52035>>>                    Set Size to 13 126
52036>>>                    Set Location to 77 181
52037>>>                    Set Label_Col_Offset to 2
52038>>>                    Set Label_Justification_Mode to jMode_Right
52039>>>                End_Object    // branch_branch_Doy
52040>>>
52040>>>                Object TextBoxSub36 is a TextBoxSub
52042>>>                    Set Label to "ƒ œçŸ¬¤©ž"
52043>>>                    Set Auto_Size_State to FALSE
52044>>>                    Set TextColor to clWindow
52045>>>                    Set FontSize to 4 0
52046>>>                    Set Location to 94 3
52047>>>                    Set Size to 10 55
52048>>>                    Set Justification_Mode to jMode_Left
52049>>>                    Set TypeFace to "MS Sans Serif"
52050>>>                    Set Enabled_State to TRUE
52051>>>                End_Object    // TextBoxSub36
52052>>>
52052>>>                Object branch_branch_Addr is a dbFormSub
52054>>>                    Entry_Item Branch.Branch_addr
52055>>>                    Set Server to (Branch_DD(self))
52056>>>                    Set Size to 13 243
52057>>>                    Set Location to 92 65
52058>>>                    Set Label_Col_Offset to 2
52059>>>                    Set Label_Justification_Mode to jMode_Right
52060>>>                End_Object    // branch_branch_Addr
52061>>>
52061>>>                Object TextBoxSub37 is a TextBoxSub
52063>>>                    Set Label to "T.K"
52064>>>                    Set Auto_Size_State to FALSE
52065>>>                    Set TextColor to clWindow
52066>>>                    Set FontSize to 4 0
52067>>>                    Set Location to 107 3
52068>>>                    Set Size to 10 55
52069>>>                    Set Justification_Mode to jMode_Left
52070>>>                    Set TypeFace to "MS Sans Serif"
52071>>>                    Set Enabled_State to TRUE
52072>>>                End_Object    // TextBoxSub37
52073>>>
52073>>>                Object branch_branch_Tk is a dbFormSub
52075>>>                    Entry_Item Branch.Branch_tk
52076>>>                    Set Server to (Branch_DD(self))
52077>>>                    Set Size to 13 77
52078>>>                    Set Location to 106 65
52079>>>                    Set Label_Col_Offset to 2
52080>>>                    Set Label_Justification_Mode to jMode_Right
52081>>>                End_Object    // branch_branch_Tk
52082>>>
52082>>>                Object TextBoxSub38 is a TextBoxSub
52084>>>                    Set Label to "æ¢ž"
52085>>>                    Set Auto_Size_State to FALSE
52086>>>                    Set TextColor to clWindow
52087>>>                    Set FontSize to 4 0
52088>>>                    Set Location to 121 3
52089>>>                    Set Size to 10 55
52090>>>                    Set Justification_Mode to jMode_Left
52091>>>                    Set TypeFace to "MS Sans Serif"
52092>>>                    Set Enabled_State to TRUE
52093>>>                End_Object    // TextBoxSub38
52094>>>
52094>>>                Object branch_branch_Poli is a dbFormSub
52096>>>                    Entry_Item Branch.Branch_poli
52097>>>                    Set Server to (Branch_DD(self))
52098>>>                    Set Size to 13 243
52099>>>                    Set Location to 120 65
52100>>>                    Set Label_Col_Offset to 2
52101>>>                    Set Label_Justification_Mode to jMode_Right
52102>>>                End_Object    // branch_branch_Poli
52103>>>
52103>>>                Object TextBoxSub39 is a TextBoxSub
52105>>>                    Set Label to "’ž¢â­à¤¦"
52106>>>                    Set Auto_Size_State to FALSE
52107>>>                    Set TextColor to clWindow
52108>>>                    Set FontSize to 4 0
52109>>>                    Set Location to 135 3
52110>>>                    Set Size to 10 55
52111>>>                    Set Justification_Mode to jMode_Left
52112>>>                    Set TypeFace to "MS Sans Serif"
52113>>>                    Set Enabled_State to TRUE
52114>>>                End_Object    // TextBoxSub39
52115>>>
52115>>>                Object branch_branch_Tel is a dbFormSub
52117>>>                    Entry_Item Branch.Branch_tel
52118>>>                    Set Server to (Branch_DD(self))
52119>>>                    Set Size to 13 77
52120>>>                    Set Location to 134 65
52121>>>                    Set Label_Col_Offset to 2
52122>>>                    Set Label_Justification_Mode to jMode_Right
52123>>>                End_Object    // branch_branch_Tel
52124>>>
52124>>>                Object TextBoxSub40 is a TextBoxSub
52126>>>                    Set Label to "€¨ Ÿ£æª Fax"
52127>>>                    Set Auto_Size_State to FALSE
52128>>>                    Set TextColor to clWindow
52129>>>                    Set FontSize to 4 0
52130>>>                    Set Location to 135 169
52131>>>                    Set Size to 10 55
52132>>>                    Set Justification_Mode to jMode_Left
52133>>>                    Set TypeFace to "MS Sans Serif"
52134>>>                    Set Enabled_State to TRUE
52135>>>                End_Object    // TextBoxSub40
52136>>>
52136>>>                Object branch_branch_Fax is a dbFormSub
52138>>>                    Entry_Item Branch.Branch_fax
52139>>>                    Set Server to (Branch_DD(self))
52140>>>                    Set Size to 13 77
52141>>>                    Set Location to 134 231
52142>>>                    Set Label_Col_Offset to 2
52143>>>                    Set Label_Justification_Mode to jMode_Right
52144>>>                End_Object    // branch_branch_Fax
52145>>>
52145>>>                Object TextBoxSub41 is a TextBoxSub
52147>>>                    Set Label to "Email"
52148>>>                    Set Auto_Size_State to FALSE
52149>>>                    Set TextColor to clWindow
52150>>>                    Set FontSize to 4 0
52151>>>                    Set Location to 149 3
52152>>>                    Set Size to 10 55
52153>>>                    Set Justification_Mode to jMode_Left
52154>>>                    Set TypeFace to "MS Sans Serif"
52155>>>                    Set Enabled_State to TRUE
52156>>>                End_Object    // TextBoxSub41
52157>>>
52157>>>                Object branch_branch_Email is a dbFormSub
52159>>>                    Entry_Item Branch.Branch_email
52160>>>                    Set Server to (Branch_DD(self))
52161>>>                    Set Size to 13 243
52162>>>                    Set Location to 148 65
52163>>>                    Set Label_Col_Offset to 2
52164>>>                    Set Label_Justification_Mode to jMode_Right
52165>>>                End_Object    // branch_branch_Email
52166>>>
52166>>>                Object TextBoxSub42 is a TextBoxSub
52168>>>                    Set Label to "“§œçŸ¬¤¦ª"
52169>>>                    Set Auto_Size_State to FALSE
52170>>>                    Set TextColor to clWindow
52171>>>                    Set FontSize to 4 0
52172>>>                    Set Location to 162 3
52173>>>                    Set Size to 10 55
52174>>>                    Set Justification_Mode to jMode_Left
52175>>>                    Set TypeFace to "MS Sans Serif"
52176>>>                    Set Enabled_State to TRUE
52177>>>                End_Object    // TextBoxSub42
52178>>>
52178>>>                Object branch_branch_Resp is a dbFormSub
52180>>>                    Entry_Item Branch.Branch_resp
52181>>>                    Set Server to (Branch_DD(self))
52182>>>                    Set Size to 13 243
52183>>>                    Set Location to 162 65
52184>>>                    Set Label_Col_Offset to 2
52185>>>                    Set Label_Justification_Mode to jMode_Right
52186>>>                End_Object    // branch_branch_Resp
52187>>>
52187>>>                Object Branch_Path_Exp is a dbFormSub
52189>>>                    Entry_Item Branch.Path_exp
52190>>>                    Set Server to (Branch_DD(self))
52191>>>                    Set Size to 13 243
52192>>>                    Set Location to 176 65
52193>>>                    Set Label_Col_Offset to 2
52194>>>                    Set Label_Justification_Mode to jMode_Right
52195>>>                End_Object    // Branch_Path_Exp
52196>>>
52196>>>                Object Branch_Exp_Txtname is a dbFormSub
52198>>>                    Entry_Item Branch.Exp_txtname
52199>>>                    Set Server to (Branch_DD(self))
52200>>>                    Set Size to 13 156
52201>>>                    Set Location to 190 65
52202>>>                    Set Label_Col_Offset to 2
52203>>>                    Set Label_Justification_Mode to jMode_Right
52204>>>                End_Object    // Branch_Exp_Txtname
52205>>>
52205>>>                Object TextBoxSub45 is a TextBoxSub
52207>>>                    Set Label to "€¨®œå¦ TXT"
52208>>>                    Set Auto_Size_State to FALSE
52209>>>                    Set TextColor to clWindow
52210>>>                    Set FontSize to 4 0
52211>>>                    Set Location to 195 3
52212>>>                    Set Size to 10 55
52213>>>                    Set Justification_Mode to jMode_Left
52214>>>                    Set TypeFace to "MS Sans Serif"
52215>>>                    Set Enabled_State to TRUE
52216>>>                End_Object    // TextBoxSub45
52217>>>
52217>>>                Object TextBoxSub46 is a TextBoxSub
52219>>>                    Set Label to "Path Exp §¨¦š¨/£¦ç"
52220>>>                    Set Auto_Size_State to FALSE
52221>>>                    Set TextColor to clWindow
52222>>>                    Set FontSize to 4 0
52223>>>                    Set Location to 174 3
52224>>>                    Set Size to 18 47
52225>>>                    Set Justification_Mode to jMode_Left
52226>>>                    Set TypeFace to "MS Sans Serif"
52227>>>                    Set Enabled_State to TRUE
52228>>>                End_Object    // TextBoxSub46
52229>>>
52229>>>                Object Branch_Send_Phone is a dbFormSub
52231>>>                    Entry_Item Branch.Send_phone
52232>>>                    Set Server to (Branch_DD(self))
52233>>>                    Set Label to "’ž¢â­à¤¦"
52234>>>                    Set Size to 13 126
52235>>>                    Set Location to 92 357
52236>>>                    Set Label_Col_Offset to 12
52237>>>                    Set Label_Justification_Mode to jMode_Right
52238>>>                End_Object    // Branch_Send_Phone
52239>>>
52239>>>                Object Branch_Ras_Name is a dbFormSub
52241>>>                    Entry_Item Branch.Ras_name
52242>>>                    Set Server to (Branch_DD(self))
52243>>>                    Set Label to "•¨ã©«žª"
52244>>>                    Set Size to 13 126
52245>>>                    Set Location to 106 357
52246>>>                    Set Label_Col_Offset to 12
52247>>>                    Set Label_Justification_Mode to jMode_Right
52248>>>                End_Object    // Branch_Ras_Name
52249>>>
52249>>>                Object Branch_Ras_Passw is a dbFormSub
52251>>>                    Entry_Item Branch.Ras_passw
52252>>>                    Set Server to (Branch_DD(self))
52253>>>                    Set Label to "‰à› ¡æª"
52254>>>                    Set Size to 13 66
52255>>>                    Set Location to 120 357
52256>>>                    Set Label_Col_Offset to 12
52257>>>                    Set Label_Justification_Mode to jMode_Right
52258>>>                End_Object    // Branch_Ras_Passw
52259>>>
52259>>>                Object Branch_Ras_Domain is a dbFormSub
52261>>>                    Entry_Item Branch.Ras_domain
52262>>>                    Set Server to (Branch_DD(self))
52263>>>                    Set Label to "Domain"
52264>>>                    Set Size to 13 126
52265>>>                    Set Location to 134 357
52266>>>                    Set Label_Col_Offset to 5
52267>>>                    Set Label_Justification_Mode to jMode_Right
52268>>>                End_Object    // Branch_Ras_Domain
52269>>>
52269>>>                Object TextBoxSub47 is a TextBoxSub
52271>>>                    Set Label to "€/€ „¤«¦¢ãª ƒ ˜¡ ¤.€§¦Ÿž¡é¤"
52272>>>                    Set Location to 167 324
52273>>>                    Set Size to 11 101
52274>>>                End_Object    // TextBoxSub47
52275>>>
52275>>>                Object Branch_Entolh is a dbFormSub
52277>>>                    Entry_Item Branch.Entolh
52278>>>                    Set Server to (Branch_DD(self))
52279>>>                    Set Size to 13 54
52280>>>                    Set Location to 164 428
52281>>>                    Set Label_Col_Offset to 2
52282>>>                    Set Label_Justification_Mode to jMode_Right
52283>>>                End_Object    // Branch_Entolh
52284>>>
52284>>>                Object TextBoxSub48 is a TextBoxSub
52286>>>                    Set Label to "€/€ „¤«¦¢ãª ˜¨˜šàšãª"
52287>>>                    Set Location to 180 334
52288>>>                    Set Size to 12 91
52289>>>                End_Object    // TextBoxSub48
52290>>>
52290>>>                Object Branch_Paragogh is a dbFormSub
52292>>>                    Entry_Item Branch.Paragogh
52293>>>                    Set Server to (Branch_DD(self))
52294>>>                    Set Size to 13 54
52295>>>                    Set Location to 178 428
52296>>>                    Set Label_Col_Offset to 2
52297>>>                    Set Label_Justification_Mode to jMode_Right
52298>>>                End_Object    // Branch_Paragogh
52299>>>
52299>>>                Object Branch_Locked_Until is a dbFormSub
52301>>>                    Entry_Item Branch.Locked_until
52302>>>                    Set Server to (Branch_DD(self))
52303>>>                    Set Label to "‰¢œ ›à£â¤˜"
52304>>>                    Set Size to 13 66
52305>>>                    Set Location to 149 416
52306>>>                    Set Label_Col_Offset to 5
52307>>>                    Set Label_Justification_Mode to jMode_Right
52308>>>                End_Object    // Branch_Locked_Until
52309>>>
52309>>>                Object TextBoxSub50 is a TextBoxSub
52311>>>                    Set Label to "‰à› ¡æª SAP"
52312>>>                    Set Auto_Size_State to FALSE
52313>>>                    Set TextColor to clWindow
52314>>>                    Set FontSize to 4 0
52315>>>                    Set Location to 196 375
52316>>>                    Set Size to 10 48
52317>>>                    Set Justification_Mode to jMode_Left
52318>>>                    Set TypeFace to "MS Sans Serif"
52319>>>                    Set Enabled_State to TRUE
52320>>>                End_Object    // TextBoxSub50
52321>>>
52321>>>                Object Branch_Sap_Code is a dbFormSub
52323>>>                    Entry_Item Branch.Sap_code
52324>>>                    Set Server to (Branch_DD(self))
52325>>>                    Set Size to 13 54
52326>>>                    Set Location to 193 428
52327>>>                    Set Label_Col_Offset to 2
52328>>>                    Set Label_Justification_Mode to jMode_Right
52329>>>                End_Object    // Branch_Sap_Code
52330>>>
52330>>>
52330>>>                //AB-StoreStart
52330>>>                Set Label to "“§¦¡˜«˜©«ã£˜«˜"
52331>>>                
52331>>>                //AB-StoreEnd
52331>>>
52331>>>            End_Object    // TP_db2
52332>>>
52332>>>            Object dbTabPageSub3 is a dbTabPageSub
52334>>>                Set Label to "dbTabPageSub3"
52335>>>                Object The_Table is a dbGrid
52337>>>                    Set Main_File to Year.File_Number
52338>>>                    Set Server to (Year_DD(self))
52339>>>                    Set Ordering to 1
52340>>>                    Set Size to 70 494
52341>>>                    Set Location to 44 3
52342>>>                    Set Wrap_State to TRUE
52343>>>
52343>>>                    Begin_Row
52346>>>                        Entry_Item Year.Year_year
52347>>>                        Entry_Item Year.Year_descr
52348>>>                        Entry_Item Year.Working
52349>>>                        Entry_Item Year.Year_xrhshfrom
52350>>>                        Entry_Item Year.Year_xrhshto
52351>>>                        Entry_Item Year.Year_entrydate
52352>>>                        Entry_Item Year.Year_c_code0
52353>>>                        Entry_Item Year.Year_c_code00
52354>>>                        Entry_Item Year.Year_c_coder
52355>>>                        Entry_Item Year.Clients_plafon
52356>>>                        Entry_Item Year.Payresp_plafon
52357>>>                        Entry_Item Year.Clients_ofeilh
52358>>>                        Entry_Item Year.Payresp_ofeilh
52359>>>                    End_Row
52364>>>
52364>>>                    Set Form_Width    item 0 to 50
52365>>>                    Set Header_Label  item 0 to "•¨ã©ž :          "
52366>>>                    
52366>>>                    Set Form_Width    item 1 to 70
52367>>>                    Set Header_Label  item 1 to "œ¨ š¨˜­ã"
52368>>>                    
52368>>>                    Set Form_Width    item 2 to 42
52369>>>                    Set Header_Label  item 2 to "€¤œ¤œ¨šã"
52370>>>                    Set Column_Checkbox_State  item 2 to True
52371>>>                    
52371>>>                    Set Form_Width    item 3 to 50
52372>>>                    Set Header_Label  item 3 to "•¨ã©ž €§æ"
52373>>>                    
52373>>>                    Set Form_Width    item 4 to 49
52374>>>                    Set Header_Label  item 4 to "•¨ã©ž „éª"
52375>>>                    
52375>>>                    Set Form_Width    item 5 to 57
52376>>>                    Set Header_Label  item 5 to "†£/¤å˜ ‰˜«˜®."
52377>>>                    
52377>>>                    Set Form_Width    item 6 to 35
52378>>>                    Set Header_Label  item 6 to "€' Œæ£"
52379>>>                    
52379>>>                    Set Form_Width    item 7 to 35
52380>>>                    Set Header_Label  item 7 to "' Œæ£"
52381>>>                    
52381>>>                    Set Form_Width    item 8 to 48
52382>>>                    Set Header_Label  item 8 to "Œæ£.Report"
52383>>>                    
52383>>>                    Set Form_Width    item 9 to 51
52384>>>                    Set Header_Label  item 9 to "¢˜­æ¤ œ¢"
52385>>>                    
52385>>>                    Set Form_Width    item 10 to 52
52386>>>                    Set Header_Label  item 10 to "“§œçŸ. ¢ž¨"
52387>>>                    
52387>>>                    Set Form_Width    item 11 to 90
52388>>>                    Set Header_Label  item 11 to "‘¬¤.Ž­œ ¢ã œ¢á«ž"
52389>>>                    
52389>>>                    Set Form_Width    item 12 to 90
52390>>>                    Set Header_Label  item 12 to "‘¬¤.Ž­œ ¢ã “§œ¬Ÿ.¢ž¨."
52391>>>                    
52391>>>
52391>>>                    //AB-StoreStart
52391>>>                    Procedure End_Construct_Object
52393>>>                        Integer iDecimals
52394>>>                        Forward Send End_Construct_Object
52396>>>                        Get fiDekadika_Nomismatos SysCurXr.C_Code0 to    iDecimals
52397>>>                        Set Points Item 9 to iDecimals
52398>>>                        Set Points Item 10 to iDecimals
52399>>>                        Set Numeric_Mask Item 9 to 14 iDecimals ' ,*'
52400>>>                        Set Numeric_Mask Item 10 to 14 iDecimals ' ,*'
52401>>>                        Set Numeric_Mask Item 11 to 14 iDecimals ' ,*'
52402>>>                        Set Numeric_Mask Item 12 to 14 iDecimals ' ,*'
52403>>>                    End_Procedure
52404>>>                    
52404>>>                    Function row_save returns integer
52406>>>                    
52406>>>                            Integer iRetVal liYearDD liCompanyDD liBranchDD liYearDDF2 liCompanyDDF2 liBranchDDF2 iYear iLastYear rVal SysYear
52407>>>                            Integer iYparxei iCtypkin iBtypkin iWtypkin iForce iClient iBaxio iPtyppar iWitemx iWax
52407>>>                            integer iclorder iptypmet
52407>>>                            String  sYearRecr sSite sCname sBname sYname sNom1 sNom2 sNom3 sAnti sFlags sRR2 sRR3
52407>>>                            String  sCompany_Code sBranch_Code sBeto_Site sCode sFlag sRR sDescr sDescrFlag sModule
52407>>>                            Date    ldYearXrhsh_From ldYearXrhsh_To
52407>>>                    
52407>>>                    
52407>>>                            Date    bBTYPKIN_L_HMNIA ddate
52407>>>                            Integer bGTYPKIN_CODE bCTYPKIN_CODE bVTYPKIN_CODE bGTYPKIN_REC0 bBTYPKIN_SIGN
52407>>>                            Integer bCTYPKIN_REC0 bVTYPKIN_REC0 bBTYPKIN_ANTI1 bBTYPKIN_ANTI2
52407>>>                            Integer bBFLAGKIN_NUM bBTYPKIN_ANTI_XP bBTYPKIN_L_NO isNewBranch
52407>>>                            Integer bBTYPKIN_FLAG01  bBTYPKIN_FLAG02  bBTYPKIN_FLAG03 bBTYPKIN_FLAG04
52407>>>                            Integer bBTYPKIN_FLAG05  bBTYPKIN_FLAG06  bBTYPKIN_FLAG07 bBTYPKIN_FLAG08
52407>>>                            Integer bBTYPKIN_FLAG09  bBTYPKIN_FLAG10 bBTYPKIN_FLAG11 bBTYPKIN_FLAG12
52407>>>                            Integer bBTYPKIN_FLAG13 bBTYPKIN_FLAG14 bBTYPKIN_FLAG15 bBTYPKIN_FLAG16
52407>>>                            Integer bBTYPKIN_FLAG17 bBTYPKIN_FLAG18 bBTYPKIN_FLAG19 bBTYPKIN_FLAG20
52407>>>                            String  bGPLAN_CODE_APO1  bGPLAN_CODE_EOS1 bGPLAN_CODE_APO2 bGPLAN_CODE_EOS2
52407>>>                            String  bBTYPKIN_PRINTER bBTYPKIN_PDESCR bBTYPKIN_FORM bBTYPKIN_SEIRA SysYearRecr
52407>>>                            String  bBTYPKIN_ABR bCTYPKIN_RECR bBTYPKIN_DESCR sYearRecrNew SysCompany SysBranch
52407>>>                            Number  bBKINKAT_NUM cXREOSH cPISTOSH cYPOLOIPO cPLAFON cOVERHEAD
52407>>>                            String  cCUSTPROM_CODE cCLIENT_ID cCLIENT_NAME cCLIENT_AFM cCUSTPROM_RECR cCLIENT_RECR
52407>>>                            Integer cCLIENT_REC0 cCLIENT_DOY cCLIENT_CITY cCLIENT_AREA cCLIENT_CATEGFPA cCLIENT_FPA cCLIENT_PUBLIC
52407>>>                            Integer cCLIENT_CATJOB
52407>>>                            Date    cLAST_XREOSH cLAST_PISTOSH cLAST_ORDER cCLIENT_LASTUPD
52407>>>                            String  cCLIENT_ADDRESS cCLIENT_JOB cCLIENT_RESPONS cCLIENT_ZIPCODE cCLIENT_PHONE cCLIENT_CODEM
52407>>>                            String  cCLIENT_FAX cCLIENT_MOBILE cCLIENT_AOH cCLIENT_EMAIL cCLIENT_CLASS cCLIENT_DETAILS cCLIENT_SITEW
52407>>>                            String  cCLIENT_SN cCLIENT_REPM cCLIENT_ACTIVE cCLIENT_REPORTED cCLIENT_PELPROM cCLIENT_MARKEXP
52407>>>                            String  cIS_PROMHTHEYTHS cis_pelaths
52407>>>                            Integer dAXIOKAT_CODE dAXIO_REC0 dAXIO_STATUS dAXIO_PLACE dAXIO_FILE_IN dAXIO_FILE_OUT
52407>>>                            Integer dAXIO_LFILE
52407>>>                            String  dEAR_RECR dAXIOKAT_RECR dAXIO_RECR dAXIO_CODE_IN dAXIO_EPON_IN dAXIO_FPAR_IN
52407>>>                            String  dAXIO_CODE_OUT dAXIO_EPON_OUT dAXIO_FPAR_OUT dAXIO_LCODE dAXIO_LEPON dAXIO_LPAR
52407>>>                            Date    dAXIO_HMNIAE dAXIO_HMNIAP000 dAXIO_HMNIAL
52407>>>                            String  dAXIO_BANK00000 dAXIO_EKDOTHS dAXIO_EKDOTHSE dAXIO_SDIATAGH dAXIO_SDIATAGHE dAXIO_BANKA
52407>>>                            String  dAXIO_NO dAXIO_C_CODE2 dAXIO_OPISTHO
52407>>>                            Number  dAXIO_V2 dAXIO_V0 dAXIO_V00 dAXIO_VR dAXIO_RATE0 dAXIO_RATE00 dAXIO_RATER
52407>>>                            Integer dAXIO_LIXI_YYYY dAXIO_LIXI_MM dAXIO_LIXI_DD dAXIO_BMOVE_LAA
52407>>>                    
52407>>>                            String  wWAPOKAT_CODE wWAPOMAST_CODE wWAX_CODE wYEAR_RECR wWAPOMAST_RECR wWAX_RECR wWAX_DESCR
52407>>>                            Integer wWAX_REC0 igridid
52407>>>                    
52407>>>                            String  zUNITS_CODE zWITEMKAT_CODE zITEM_CODE zWITEMX_CODE zWITEMX_RECR zYEAR_RECR
52407>>>                            String  zITEM_RECR zWITEMX_DESCR zWITEMX_YEARDESC zITEM_APOKAT_COD sYear_Anaforas
52407>>>                            Integer zWITEMX_REC0 zAXIA zAXIA0 zAXIA00 zAXIAR tPTYPPAR_REC0 rVal1
52407>>>                            Integer tPSEIRA_REC0 tPSEIRA_AUTONUM tAUTONUM_PLUS tAUTONUM_MINUS iHmCtyp iHmWtyp iBkinkat
52407>>>                            Date    zVALUE_DATE dourdate drialdate
52407>>>                    
52407>>>                            String tCTYPKIN_CODE tWTYPKIN_CODE tYEAR_RECR tCTYPKIN_RECR tWTYPKIN_RECR
52407>>>                            String tPTYPPAR_CODE tPTYPPAR_DESCR tPTYPPAR_IS_WHAT tPTYPPAR_MODULE SysBetoSite
52407>>>                            String tPTYPPAR_ABREV tPSEIRA_SEIRA tPSEIRA_PRINTER tPSEIRA_FORM sCurrentXrhsh
52407>>>                    
52407>>>                            String uHMGIO_CODE uCTYPKIN_RECR uCTYPKIN_CODE uWTYPKIN_RECR uWTYPKIN_CODE
52407>>>                            string saapar sarmod sorder1 saaparprom stropos showpay sitem sclientitem
52407>>>                            number nqty nunit ndisc nfpa nnet nextra ntotal nposodtl nqtydtl
52407>>>                            integer ifinish iokey iakyrh istatus
52407>>>                            number npcdisc npcfpa nkposothta nkposo nkfpa nknet nrialqty nypolqty
52407>>>                            number nakyrhqty nepistrofhqty
52407>>>                            string spmovesrecr swaxrecr sirec0 srecr clorderdrecr sptypparrecr
52407>>>                            string septypparcode sepryppardesc
52407>>>                            String sOPEN_ITEM sCHECK_OVERHEAD sOtherYear
52407>>>                            Integer iMAX_DAYS_SX_PAR ienaprosena
52407>>>                    
52407>>>                            String  hFTIAXNEI_TPAY hTI_TYPONEI_PMS hSYSXET_PTYPPAR hSYSX_PTYP_RECR hCHECK_POSA_PLAF
52407>>>                            Integer hEINAI_PAROXH_YP hGTYPKIN_CODE
52407>>>                    
52407>>>                        move (the_table(dbtabpagesub3(dbtabdialogsub1(self)))) to igridid
52408>>>                    //                    Get Checked_State Of chkClient      to iClient
52408>>>                        Get Checked_State Of chkBaxio       to iBaxio
52409>>>                        Get Checked_State Of chkPtyppar     to iPtyppar
52410>>>                        Get Checked_State Of chkWitemx      to iWitemx
52411>>>                    //                    Get Checked_State Of chkBkinkat     to iBkinkat
52411>>>                        Get Checked_State Of chkWax         to iWax
52412>>>                        Get Checked_State Of chkclorder     to iclorder
52413>>>                        Get Checked_State Of chkptypmet     to iptypmet
52414>>>                        Get Checked_State Of chkForce       to iForce
52415>>>                    
52415>>>                    
52415>>>                        Move (Trim(SysCurXr.Company_Code))  to SysCompany
52416>>>                        Move (Trim(SysCurXr.Branch_Code))   to SysBranch
52417>>>                        Move (Trim(SysCurXr.Year_Year))     to SysYear
52418>>>                        Move (Trim(SysCurXr.Year_Recr))     to SysYearRecr
52419>>>                        Move (Trim(SysCurXr.Beto_Site))     to SysBetoSite
52420>>>                    
52420>>>                        Get psCurXr                 to sCurrentXrhsh
52421>>>                        Move (Trim(sCurrentXrhsh))  to sCurrentXrhsh
52422>>>                    
52422>>>                        Move 0 to iLastYear
52423>>>                        Move 0 to isNewBranch
52424>>>                    
52424>>>                        Get Field_Current_Value Of Year_DDF2 Field Year.Year_Recr to sOtherYear
52425>>>                        Move (Trim(sOtherYear)) to sOtherYear
52426>>>                    
52426>>>                        If (sOtherYear<>'') Begin
52428>>>                            //  1. ‘¬¢¢¦šã ©«¦ ®œåà¤ á¢¢žª œ«˜ ¨å˜/¬§¦¡˜«/®¨ã©ž
52428>>>                            Move Company_DDF2                                                     to liCompanyDDF2
52429>>>                            Move Branch_DDF2                                                      to liBranchDDF2
52430>>>                            Move Year_DDF2                                                        to liYearDDF2
52431>>>                            Get Field_Current_Value of liCompanyDDF2 Field Company.Company_Code   to sCompany_Code
52432>>>                            Get Field_Current_Value of liBranchDDF2  Field Branch.Branch_Code     to sBranch_Code
52433>>>                            Get Field_Current_Value of liBranchDDF2  Field Branch.Beto_Site       to sBeto_Site
52434>>>                            Get Field_Current_Value of liBranchDDF2  Field Branch.Branch_Site     to sSite
52435>>>                            Get Field_Current_Value of liYearDDF2    Field Year.Year_Year         to iYear
52436>>>                            Get Field_Current_Value of liYearDDF2    Field Year.Year_Recr         to sYearRecr
52437>>>                            Get Field_Current_Value of liYearDDF2    Field Year.Year_C_Code0      to sNom1
52438>>>                            Get Field_Current_Value of liYearDDF2    Field Year.Year_C_Code00     to sNom2
52439>>>                            Get Field_Current_Value of liYearDDF2    Field Year.Year_C_CodeR      to sNom3
52440>>>                            Get Field_Current_Value of liCompanyDDF2 Field Company.Company_Name   to sCname
52441>>>                            Get Field_Current_Value of liBranchDDF2  Field Branch.Branch_name     to sBname
52442>>>                            Get Field_Current_Value of liYearDDF2    Field Year.Year_Descr        to sYname
52443>>>                            Move 0 to isNewBranch
52444>>>                    
52444>>>                            Send Clear to Year_DDR
52445>>>                            Move sCompany_Code   to Year.Company_Code
52446>>>                            Move sBranch_Code    to Year.Branch_Code
52447>>>                            Move iYear           to Year.Year_Year
52448>>>                            Send Find to Year_DDR EQ 1 // Company_Code+Branch_Code+Year_Year
52449>>>                            If (Found=1) Begin
52451>>>                                Get Field_Current_Value of Year_DDR     Field Year.Year_Year    to iLastYear
52452>>>                                Get Field_Current_Value of Year_DDR     Field Year.Year_Recr    to SysYearRecr
52453>>>                                Get Field_Current_Value of Branch_DDR   Field Branch.Beto_Site  to SysBetoSite
52454>>>                                Move iLastYear      to SysYear
52455>>>                                Move sCompany_Code  to SysCompany
52456>>>                                Move sBranch_Code   to SysBranch
52457>>>                            End
52457>>>>
52457>>>                            Else Begin
52458>>>                                Move 0  to SysYear
52459>>>                                Move '' to SysCompany
52460>>>                                Move '' to SysBranch
52461>>>                            End
52461>>>>
52461>>>                        End // If (sOtherYear<>'')
52461>>>>
52461>>>                        Else Begin
52462>>>                            Send Stop_Box 'ƒœ¤ œ§ ¢â¥˜«œ œ«˜ ¨å˜ / ®¨ã©ž ˜¤« š¨˜­ãª' '‘­á¢£˜'
52463>>>                            Procedure_Return
52464>>>                        End
52464>>>>
52464>>>                    
52464>>>                        Forward Get row_save to rVal
52466>>>                    
52466>>>                    
52466>>>                        If (Not(rVal)) Begin
52468>>>                    
52468>>>                            Move Company_DD to liCompanyDD
52469>>>                            Move Branch_DD  to liBranchDD
52470>>>                            Move Year_DD    to liYearDD
52471>>>                    
52471>>>                    
52471>>>                            //  2. ‘¬¢¢¦šã ©«¦ ®œåà¤ Œâ˜ª •¨ã©žª
52471>>>                            Get Field_Current_Value of liCompanyDD Field Company.Company_Code   to sCompany_Code
52472>>>                            Get Field_Current_Value of liBranchDD  Field Branch.Branch_Code     to sBranch_Code
52473>>>                            Get Field_Current_Value of liYearDD    Field Year.Year_Year         to iYear
52474>>>                            Get Field_Current_Value of liYearDD    Field Year.Year_Recr         to sYearRecrNew
52475>>>                    
52475>>>                            //////////////////////////////////////////////////////////////
52475>>>                            // €¤ ›œ¤ ¬§á¨®œ  iLastYear ©ž£˜å¤œ  §àª ›œ¤ ™¨âŸž¡œ œšš¨˜­ã
52475>>>                            // §¨¦žš¦ç£œ¤žª ®¨ã©žª ˜§¦ ˜¬«ã §¦¬ ¡˜«˜®à¨œå«˜  «é¨˜
52475>>>                            // ¦§æ«œ ›œ¤ œ®œ  « §¦«˜ ¤˜ ˜¤« š¨á¯œ 
52475>>>                    
52475>>>                            // €¢¢ éª ž £œ«˜™¢ž«ž iLastYear §œ¨ œ®œ  «¦ œ«¦ª ˜§¦ «¦ ˜§¦ ¦ ˜¤« š¨˜­¦¬£œ
52475>>>                            //    ¡˜  ž £œ«˜™¢ž«ž iYear     §œ¨ œ®œ  «¦ œ«¦ª ©«¦ ¦§¦ ¦ ˜¤« š¨˜­¦¬£œ
52475>>>                    
52475>>>                            If (Not(iLastYear))     Procedure_Return
52478>>>                    
52478>>>                          // georg 18/10/01
52478>>>                          // ¦«˜¤ £œ«˜­œ¨¦¬£œ ¡ ¤ã©œ ª ©œ ˜¢¢¦ ¬§¦¡˜«á©«ž£˜ £˜ª ¡¦™œ 
52478>>>                          //  If (iLastYear=iYear)    Procedure_Return
52478>>>                    
52478>>>                            //////////////////////////////////////////////////////////////
52478>>>                    
52478>>>                            // ƒž£ ¦¬¨šå˜ ¤â¦¬ record SysCurXr
52478>>>                            Get Field_Current_Value of liCompanyDD Field Company.Company_Code to gs_Selected_Company_Code
52479>>>                            Get Field_Current_Value of liBranchDD  Field Branch.Branch_Code   to gs_Selected_Branch_Code
52480>>>                            Get Field_Current_Value of liBranchDD  Field Branch.Beto_Site     to gs_Selected_Beto_Site
52481>>>                    
52481>>>                            Get Field_Current_Value of liBranchDD  Field Branch.Branch_Site   to sSite
52482>>>                            Get Field_Current_Value of liYearDD    Field Year.Year_Year       to gi_Selected_Year
52483>>>                            Get Field_Current_Value of liYearDD    Field Year.Year_Recr       to sYearRecr
52484>>>                            Get Field_Current_Value of liYearDD    Field Year.Year_C_Code0    to sNom1
52485>>>                            Get Field_Current_Value of liYearDD    Field Year.Year_C_Code00   to sNom2
52486>>>                            Get Field_Current_Value of liYearDD    Field Year.Year_C_CodeR    to sNom3
52487>>>                    
52487>>>                            Get Field_Current_Value of liCompanyDD Field Company.Company_Name to sCname
52488>>>                            Get Field_Current_Value of liBranchDD  Field Branch.Branch_name   to sBname
52489>>>                            Get Field_Current_Value of liYearDD    Field Year.Year_Descr      to sYname
52490>>>                    
52490>>>                            Reread SysCurXR
52494>>>                            Move gs_Selected_Company_Code   to SysCurXR.Company_Code
52495>>>                            Move gs_Selected_beto_site      to SysCurXR.beto_site
52496>>>                            Move gs_Selected_Branch_Code    to SysCurXR.Branch_Code
52497>>>                            Move gi_Selected_Year           to SysCurXR.Year_Year
52498>>>                            Move sYearRecr                  to SysCurXR.Year_Recr
52499>>>                            Move sSite                      to SysCurXR.Branch_Site
52500>>>                    
52500>>>                            Move sCname                     to SysCurXR.Company_Name
52501>>>                            Move sBname                     to SysCurXR.Branch_Name
52502>>>                            Move sYname                     to SysCurXR.Year_Descr
52503>>>                    
52503>>>                            Move ldYearXrhsh_From           to SysCurXr.Year_XrhshFrom
52504>>>                            Move ldYearXrhsh_To             to SysCurXr.Year_XrhshTo
52505>>>                    
52505>>>                            Move  (Trim(sNom1))             to SysCurXR.C_Code0
52506>>>                            Move  (Trim(sNom2))             to SysCurXR.C_Code00
52507>>>                            Move  (Trim(sNom3))             to SysCurXR.C_CodeR
52508>>>                    
52508>>>                            Saverecord SysCurXR
52509>>>                            Unlock
52510>>>>
52510>>>                    
52510>>>                    //                //////////////////
52510>>>                    //                //  E) Baxio
52510>>>                    //                //////////////////
52510>>>                    
52510>>>                                    If (iBaxio) Begin
52512>>>                                        Send Clear      to Baxio_DDR
52513>>>                                        Move SysCompany to Baxio.Company_Code
52514>>>                                        Move SysBranch  to Baxio.Branch_Code
52515>>>                                        Move SysYear    to Baxio.Year_Year
52516>>>                                        Send Find To Baxio_DDR Gt 1 //Comp+branch+year+Baxiokat_Code+Baxio_Code
52517>>>                    
52517>>>                                        While ((Found=1) And (SysCompany=Baxio.Company_Code)   ;                                                         And (SysBranch=Baxio.Branch_Code)     ;                                                         And (SysYear=Baxio.Year_Year))
52521>>>                    
52521>>>                                            Set Label Of txtM1 to 'Baxio'
52522>>>                                            Set Label Of txtM2 to Baxio.Baxio_Code
52523>>>                    
52523>>>                                            Get Field_Current_value Of Baxio_DDR Field Baxio.Baxio_Code             to sCode
52524>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.Baxio_Recr             to sRR
52525>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIOKAT_CODE          to dAxioKAT_CODE
52526>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIOKAT_RECR          to dAxioKAT_RECR
52527>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_STATUS           to dAxio_STATUS
52528>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_PLACE            to dAxio_PLACE
52529>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_FILE_IN          to dAxio_FILE_IN
52530>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_CODE_IN          to dAxio_CODE_IN
52531>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_EPON_IN          to dAxio_EPON_IN
52532>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_FPAR_IN          to dAxio_FPAR_IN
52533>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_FILE_OUT         to dAxio_FILE_OUT
52534>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_CODE_OUT         to dAxio_CODE_OUT
52535>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_EPON_OUT         to dAxio_EPON_OUT
52536>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_FPAR_OUT         to dAxio_FPAR_OUT
52537>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_LFILE            to dAxio_LFILE
52538>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_LCODE            to dAxio_LCODE
52539>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_LEPON            to dAxio_LEPON
52540>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_LPAR             to dAxio_LPAR
52541>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_BANK00000        to dAxio_BANK00000
52542>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_HMNIAE           to dAxio_HMNIAE
52543>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_HMNIAP000        to dAxio_HMNIAP000
52544>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_HMNIAL           to dAxio_HMNIAL
52545>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_EKDOTHS          to dAxio_EKDOTHS
52546>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_EKDOTHSE         to dAxio_EKDOTHSE
52547>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_sediatagh        to dAxio_sdiatagh
52548>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_SDIATAGHE        to dAxio_SDIATAGHE
52549>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_BANKA            to dAxio_BANKA
52550>>>                                            //Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_OPISTHO          to dAxio_OPISTHO
52550>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_NO               to dAxio_NO
52551>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_V2               to dAxio_V2
52552>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_V0               to dAxio_V0
52553>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_V00              to dAxio_V00
52554>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_VR               to dAxio_VR
52555>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_RATE0            to dAxio_RATE0
52556>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_RATE00           to dAxio_RATE00
52557>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_RATER            to dAxio_RATER
52558>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_C_CODE2          to dAxio_C_CODE2
52559>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_LIXI_YYYY        to dAxio_LIXI_YYYY
52560>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_LIXI_MM          to dAxio_LIXI_MM
52561>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_BMOVE_LAA        to dAxio_BMOVE_LAA
52562>>>                                            Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_LIXI_DD          to dAxio_LIXI_DD
52563>>>                    
52563>>>                                            Send Clear to Baxio_DDW
52564>>>                    
52564>>>                                            Move sCompany_Code  to Baxio.Company_Code
52565>>>                                            Move sBranch_Code   to Baxio.Branch_Code
52566>>>                                            Move iYear          to Baxio.Year_Year
52567>>>                                            Move dAxioKAT_CODE  to Baxio.BaxioKat_Code
52568>>>                                            Move sCode          to Baxio.Baxio_Code
52569>>>                    
52569>>>                                            Send Find to Baxio_DDW Eq 1
52570>>>                    
52570>>>                                            If (iForce) Begin
52572>>>                                                Send Clear to baxioKat_DDW
52573>>>                                                Move dAxioKAT_RECR to BaxioKat.BaxioKat_Recr
52574>>>                                                Send Find to Baxiokat_DDW Eq 2
52575>>>                                                Set Field_Changed_Value Of Baxio_DDW Field Baxio.Company_Code   to sCompany_Code
52576>>>                                                Set Field_Changed_Value Of Baxio_DDW Field Baxio.Branch_Code    to sBranch_Code
52577>>>                                                Set Field_Changed_Value Of Baxio_DDW Field Baxio.Year_Year      to iYear
52578>>>                                                Set Field_Changed_Value Of Baxio_DDW Field Baxio.Baxio_Code   to sCode
52579>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.Baxio_Recr             to sRR
52580>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIOKAT_CODE          to dAxioKAT_CODE
52581>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIOKAT_RECR          to dAxioKAT_RECR
52582>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_STATUS           to dAxio_STATUS
52583>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_PLACE            to dAxio_PLACE
52584>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_FILE_IN          to dAxio_FILE_IN
52585>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_CODE_IN          to dAxio_CODE_IN
52586>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_EPON_IN          to dAxio_EPON_IN
52587>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_FPAR_IN          to dAxio_FPAR_IN
52588>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_FILE_OUT         to dAxio_FILE_OUT
52589>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_CODE_OUT         to dAxio_CODE_OUT
52590>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_EPON_OUT         to dAxio_EPON_OUT
52591>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_FPAR_OUT         to dAxio_FPAR_OUT
52592>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_LFILE            to dAxio_LFILE
52593>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_LCODE            to dAxio_LCODE
52594>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_LEPON            to dAxio_LEPON
52595>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_LPAR             to dAxio_LPAR
52596>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_BANK00000        to dAxio_BANK00000
52597>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_HMNIAE           to dAxio_HMNIAE
52598>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_HMNIAP000        to dAxio_HMNIAP000
52599>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_HMNIAL           to dAxio_HMNIAL
52600>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_EKDOTHS          to dAxio_EKDOTHS
52601>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_EKDOTHSE         to dAxio_EKDOTHSE
52602>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_sediatagh        to dAxio_sdiatagh
52603>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_SDIATAGHE        to dAxio_SDIATAGHE
52604>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_BANKA            to dAxio_BANKA
52605>>>                                                //Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_OPISTHO          to dAxio_OPISTHO
52605>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_NO               to dAxio_NO
52606>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_V2               to dAxio_V2
52607>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_V0               to dAxio_V0
52608>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_V00              to dAxio_V00
52609>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_VR               to dAxio_VR
52610>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_RATE0            to dAxio_RATE0
52611>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_RATE00           to dAxio_RATE00
52612>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_RATER            to dAxio_RATER
52613>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_C_CODE2          to dAxio_C_CODE2
52614>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_LIXI_YYYY        to dAxio_LIXI_YYYY
52615>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_LIXI_MM          to dAxio_LIXI_MM
52616>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_BMOVE_LAA        to dAxio_BMOVE_LAA
52617>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_LIXI_DD          to dAxio_LIXI_DD
52618>>>                                                if ((daxiokat_code=1 or daxiokat_code=2 or daxiokat_code=200 or daxiokat_code=201)and(daxio_status=1));                                                   Send Request_Save to Baxio_DDW
52621>>>                                                if ((daxiokat_code=1 or daxiokat_code=2 or daxiokat_code=200 or daxiokat_code=201)and(daxio_status=3));                                                   Send Request_Save to Baxio_DDW
52624>>>                                            End
52624>>>>
52624>>>                                            Else If (NOT(Found)) Begin
52627>>>                                                Send Clear to baxioKat_DDW
52628>>>                                                Move dAxioKAT_RECR to BaxioKat.BaxioKat_Recr
52629>>>                                                Send Find to Baxiokat_DDW Eq 2
52630>>>                                                Set Field_Changed_Value Of Baxio_DDW Field Baxio.Company_Code   to sCompany_Code
52631>>>                                                Set Field_Changed_Value Of Baxio_DDW Field Baxio.Branch_Code    to sBranch_Code
52632>>>                                                Set Field_Changed_Value Of Baxio_DDW Field Baxio.Year_Year      to iYear
52633>>>                                                Set Field_Changed_Value Of Baxio_DDW Field Baxio.Baxio_Code   to sCode
52634>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.Baxio_Recr             to sRR
52635>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIOKAT_CODE          to dAxioKAT_CODE
52636>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIOKAT_RECR          to dAxioKAT_RECR
52637>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_STATUS           to dAxio_STATUS
52638>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_PLACE            to dAxio_PLACE
52639>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_FILE_IN          to dAxio_FILE_IN
52640>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_CODE_IN          to dAxio_CODE_IN
52641>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_EPON_IN          to dAxio_EPON_IN
52642>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_FPAR_IN          to dAxio_FPAR_IN
52643>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_FILE_OUT         to dAxio_FILE_OUT
52644>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_CODE_OUT         to dAxio_CODE_OUT
52645>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_EPON_OUT         to dAxio_EPON_OUT
52646>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_FPAR_OUT         to dAxio_FPAR_OUT
52647>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_LFILE            to dAxio_LFILE
52648>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_LCODE            to dAxio_LCODE
52649>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_LEPON            to dAxio_LEPON
52650>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_LPAR             to dAxio_LPAR
52651>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_BANK00000        to dAxio_BANK00000
52652>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_HMNIAE           to dAxio_HMNIAE
52653>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_HMNIAP000        to dAxio_HMNIAP000
52654>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_HMNIAL           to dAxio_HMNIAL
52655>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_EKDOTHS          to dAxio_EKDOTHS
52656>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_EKDOTHSE         to dAxio_EKDOTHSE
52657>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_sediatagh        to dAxio_sdiatagh
52658>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_SDIATAGHE        to dAxio_SDIATAGHE
52659>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_BANKA            to dAxio_BANKA
52660>>>                                                //Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_OPISTHO          to dAxio_OPISTHO
52660>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_NO               to dAxio_NO
52661>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_V2               to dAxio_V2
52662>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_V0               to dAxio_V0
52663>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_V00              to dAxio_V00
52664>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_VR               to dAxio_VR
52665>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_RATE0            to dAxio_RATE0
52666>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_RATE00           to dAxio_RATE00
52667>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_RATER            to dAxio_RATER
52668>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_C_CODE2          to dAxio_C_CODE2
52669>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_LIXI_YYYY        to dAxio_LIXI_YYYY
52670>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_LIXI_MM          to dAxio_LIXI_MM
52671>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_BMOVE_LAA        to dAxio_BMOVE_LAA
52672>>>                                                Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_LIXI_DD          to dAxio_LIXI_DD
52673>>>                                                if ((daxiokat_code=1 or daxiokat_code=2 or daxiokat_code=200 or daxiokat_code=201)and(daxio_status=1));                                                   Send Request_Save to Baxio_DDW
52676>>>                                                if ((daxiokat_code=1 or daxiokat_code=2 or daxiokat_code=200 or daxiokat_code=201)and(daxio_status=3));                                                   Send Request_Save to Baxio_DDW
52679>>>                                            End
52679>>>>
52679>>>                    
52679>>>                                            Send Clear to Baxio_DDR
52680>>>                                            Move sRR to Baxio.Baxio_Recr
52681>>>                                            Send Request_Find to Baxio_DDR eq Baxio.File_Number 2
52682>>>                    
52682>>>                                            Send Request_Find To Baxio_DDR Gt Baxio.File_Number 1 //Comp+branch+year+Baxiokat_Code+Baxio_Code
52683>>>                                        Loop
52684>>>>
52684>>>                                    End // If (iBaxio)
52684>>>>
52684>>>                    
52684>>>                    
52684>>>                            //////////////////
52684>>>                            //  F) Wax
52684>>>                            //////////////////
52684>>>                            String sCode2
52684>>>                    
52684>>>                            If (iWax) Begin
52686>>>                                Send Clear          to Wax_DDR
52687>>>                                Move SysCompany to Wax.Company_Code
52688>>>                                Move SysBranch  to Wax.Branch_Code
52689>>>                                Move SysYear        to Wax.Year_Year
52690>>>                                Send Find To Wax_DDR Gt 1 //Comp+branch+year+Wax_Code
52691>>>                                While ((Found=1) And (SysCompany=Wax.Company_Code)   ;                                                 And (SysBranch=Wax.Branch_Code)     ;                                                 And (SysYear=Wax.Year_Year))
52695>>>                    
52695>>>                                    Set Label Of txtM1 to 'Wax'
52696>>>                                    Set Label Of txtM2 to Wax.Wax_Code
52697>>>                    
52697>>>                                    Get Field_Current_value Of Wax_DDR Field Wax.Wax_Code           to sCode
52698>>>                                    Get Field_Current_Value Of Wax_DDR Field Wax.Wax_Recr           to sRR
52699>>>                                    Get Field_Current_Value Of Wax_DDR Field Wax.Wapomast_CODE      to wWAPOMAST_CODE
52700>>>                                    Get Field_Current_Value Of Wax_DDR Field Wax.Wapomast_RECR      to wWapomast_RECR
52701>>>                                    Get Field_Current_Value Of Wax_DDR Field Wax.Wapokat_CODE       to wWAPOKAT_CODE
52702>>>                                    Get Field_Current_Value Of Wax_DDR Field Wax.WAX_DESCR          to wWAX_DESCR
52703>>>                    
52703>>>                                    Send Clear to Wax_DDW
52704>>>                                    Move sCompany_Code  to Wax.Company_Code
52705>>>                                    Move sBranch_Code   to Wax.Branch_Code
52706>>>                                    Move iYear          to Wax.Year_Year
52707>>>                                    Move wWapokat_Code  to Wax.Wapokat_Code
52708>>>                                    Move wWapomast_Code to Wax.Wapomast_Code
52709>>>                    
52709>>>                                    //////////////////////////////////////////////////////
52709>>>                                    // 19/03/2001 JSJS ‰€’ŽˆŒ ‘“Œ„ŒŽ†‘†‘ ‹„ ’ŽŒ ’ŽŠ†
52709>>>                                    // ’Ž „ƒˆŽ WAX_CODE €ˆŒ„ˆ ’ˆ‹† €Ž ’Ž CURRENT YEAR
52709>>>                                    // Move sCode          to Wax.Wax_Code
52709>>>                                    Move iYear          to Wax.Wax_Code
52710>>>                                    //////////////////////////////////////////////////////
52710>>>                    
52710>>>                                    Send Find to Wax_DDW Eq 1
52711>>>                    
52711>>>                                    If (iForce) Begin
52713>>>                                        If (Found) Begin
52715>>>                                            Set Field_Changed_Value Of Wax_DDW Field Wax.WAX_DESCR      to wWAX_DESCR
52716>>>                                            Send Request_Save to Wax_DDW
52717>>>                                        End
52717>>>>
52717>>>                                        Else Begin
52718>>>                                            Send Clear to Wapomast_DDW
52719>>>                                            Move wWapomast_RECR to Wapomast.Wapomast_Recr
52720>>>                                            Send Find to Wapomast_DDW Eq 2
52721>>>                                            Set Field_Changed_Value Of Wax_DDW Field Wax.Company_Code   to sCompany_Code
52722>>>                                            Set Field_Changed_Value Of Wax_DDW Field Wax.Branch_Code    to sBranch_Code
52723>>>                                            Set Field_Changed_Value Of Wax_DDW Field Wax.Year_Year      to iYear
52724>>>                                            Set Field_Changed_Value Of Wax_DDW Field Wax.Wapokat_CODE   to wWAPOKAT_CODE
52725>>>                                            Set Field_Changed_Value of Wax_DDW Field Wax.Wapomast_CODE  to wWapomast_Code
52726>>>                    
52726>>>                                            //////////////////////////////////////////////////////
52726>>>                                            // 19/03/2001 JSJS ‰€’ŽˆŒ ‘“Œ„ŒŽ†‘†‘ ‹„ ’ŽŒ ’ŽŠ†
52726>>>                                            // ’Ž „ƒˆŽ WAX_CODE €ˆŒ„ˆ ’ˆ‹† €Ž ’Ž CURRENT YEAR
52726>>>                                            //Set Field_Changed_Value Of Wax_DDW Field Wax.Wax_Code       to sCode
52726>>>                                            Set Field_Changed_Value Of Wax_DDW Field Wax.Wax_Code       to iYear
52727>>>                                            //////////////////////////////////////////////////////
52727>>>                    
52727>>>                                            Set Field_Changed_Value of Wax_DDW Field Wax.Wax_Recr       to sRR
52728>>>                                            Set Field_Changed_Value Of Wax_DDW Field Wax.WAX_DESCR      to wWAX_DESCR
52729>>>                                            Send Request_Save to Wax_DDW
52730>>>                                        End
52730>>>>
52730>>>                                    End
52730>>>>
52730>>>                                    Else If (NOT(Found)) Begin
52733>>>                                        Send Clear to Wapomast_DDW
52734>>>                                        Move wWapomast_RECR to Wapomast.Wapomast_Recr
52735>>>                                        Send Find to Wapomast_DDW Eq 2
52736>>>                                        Set Field_Changed_Value Of Wax_DDW Field Wax.Company_Code   to sCompany_Code
52737>>>                                        Set Field_Changed_Value Of Wax_DDW Field Wax.Branch_Code    to sBranch_Code
52738>>>                                        Set Field_Changed_Value Of Wax_DDW Field Wax.Year_Year      to iYear
52739>>>                                        Set Field_Changed_Value Of Wax_DDW Field Wax.Wapokat_CODE   to wWAPOKAT_CODE
52740>>>                                        Set Field_Changed_Value of Wax_DDW Field Wax.Wapomast_CODE  to wWapomast_Code
52741>>>                                        //////////////////////////////////////////////////////
52741>>>                                        // 19/03/2001 JSJS ‰€’ŽˆŒ ‘“Œ„ŒŽ†‘†‘ ‹„ ’ŽŒ ’ŽŠ†
52741>>>                                        // ’Ž „ƒˆŽ WAX_CODE €ˆŒ„ˆ ’ˆ‹† €Ž ’Ž CURRENT YEAR
52741>>>                                        //Set Field_Changed_Value Of Wax_DDW Field Wax.Wax_Code       to sCode
52741>>>                                        Set Field_Changed_Value Of Wax_DDW Field Wax.Wax_Code       to iYear
52742>>>                                        //////////////////////////////////////////////////////
52742>>>                                        Set Field_Changed_Value of Wax_DDW Field Wax.Wax_Recr       to sRR
52743>>>                                        Set Field_Changed_Value Of Wax_DDW Field Wax.WAX_DESCR      to wWAX_DESCR
52744>>>                                        Send Request_Save to Wax_DDW
52745>>>                                    End
52745>>>>
52745>>>                    
52745>>>                                    Send Clear to Wax_DDR
52746>>>                                    Move sRR to Wax.Wax_Recr
52747>>>                                    Send Find to Wax_DDR eq 2
52748>>>                    
52748>>>                                    Send Find To Wax_DDR Gt 1 //Comp+branch+year+Wapokat_Code+Wapomast_Code+Wax_Code
52749>>>                                Loop
52750>>>>
52750>>>                            End // If (iWax)
52750>>>>
52750>>>                    
52750>>>                    
52750>>>                    
52750>>>                    
52750>>>                    
52750>>>                            //////////////////
52750>>>                            //  G) Witemx
52750>>>                            //////////////////
52750>>>                    
52750>>>                            Integer iRec0 iRec01
52750>>>                    
52750>>>                            If (iWitemx) Begin
52752>>>                    
52752>>>                    
52752>>>                                Send Clear          to Witemx_DDR
52753>>>                                Move SysCompany to Witemx.Company_Code
52754>>>                                Move SysBranch  to Witemx.Branch_Code
52755>>>                                Move SysYear        to Witemx.Year_Year
52756>>>                                Send Find To Witemx_DDR Gt 1 //Comp+branch+year+Witemx_Code
52757>>>                                While ((Found=1) And (SysCompany=Witemx.Company_Code)   ;                                                 And (SysBranch=Witemx.Branch_Code)     ;                                                 And (SysYear=Witemx.Year_Year))
52761>>>                    
52761>>>                                    Set Label Of txtM1 to 'Witemx'
52762>>>                                    Set Label Of txtM2 to Witemx.Witemx_Code
52763>>>                    
52763>>>                                    Get Field_Current_value Of Witemx_DDR Field Witemx.Witemx_Code      to sCode
52764>>>                                    Get Field_Current_Value Of Witemx_DDR Field Witemx.Witemx_Recr      to sRR
52765>>>                                    Get Field_Current_Value Of Witemx_DDR Field Witemx.Witemx_Rec0      to iRec0
52766>>>                                    Get Field_Current_Value Of Witemx_DDR Field Witemx.UNITS_CODE       to zUNITS_CODE
52767>>>                                    Get Field_Current_Value Of Witemx_DDR Field Witemx.WITEMKAT_CODE    to zWITEMKAT_CODE
52768>>>                                    Get Field_Current_Value Of Witemx_DDR Field Witemx.ITEM_CODE        to zITEM_CODE
52769>>>                                    Get Field_Current_Value Of Witemx_DDR Field Witemx.WITEMX_RECR      to zWITEMX_RECR
52770>>>                                    Get Field_Current_Value Of Witemx_DDR Field Witemx.ITEM_RECR        to zITEM_RECR
52771>>>                                    Get Field_Current_Value Of Witemx_DDR Field Witemx.WITEMX_DESCR     to zWITEMX_DESCR
52772>>>                                    Get Field_Current_Value Of Witemx_DDR Field Witemx.WITEMX_YEARDESC  to zWITEMX_YEARDESC
52773>>>                                    Get Field_Current_Value Of Witemx_DDR Field Witemx.ITEM_APOKAT_COD  to zITEM_APOKAT_COD
52774>>>                                    Get Field_Current_Value Of Witemx_DDR Field Witemx.ITEM_APOKAT_COD  to zITEM_APOKAT_COD
52775>>>                    
52775>>>                                    Send Clear to Witemx_DDW
52776>>>                                    Move sCompany_Code  to Witemx.Company_Code
52777>>>                                    Move sBranch_Code   to Witemx.Branch_Code
52778>>>                                    Move iYear          to Witemx.Year_Year
52779>>>                                    Move zUnits_Code    to Witemx.Units_Code
52780>>>                                    Move zWITEMKAT_CODE to Witemx.Witemkat_Code
52781>>>                                    Move zITEM_CODE     to Witemx.Item_Code
52782>>>                                    Move sCode          to Witemx.Witemx_Code
52783>>>                    
52783>>>                                    Send Find to Witemx_DDW Eq 1
52784>>>                    
52784>>>                                    If (iForce) Begin
52786>>>                                        If (Found) Begin
52788>>>                                            Set Field_Changed_Value Of Witemx_DDW Field Witemx.WITEMX_DESCR     to zWITEMX_DESCR
52789>>>                                            Set Field_Changed_Value Of Witemx_DDW Field Witemx.WITEMX_YEARDESC  to iYear
52790>>>                                            Set Field_Changed_Value Of Witemx_DDW Field Witemx.ITEM_APOKAT_COD  to zITEM_APOKAT_COD
52791>>>                                            Send Request_Save to Witemx_DDW
52792>>>                                        End
52792>>>>
52792>>>                                        Else Begin
52793>>>                                            Send Clear to Item_DDW
52794>>>                                            Move zItem_Code to Item.Item_Code
52795>>>                                            Send Find To Item_DDW eq 5
52796>>>                                            Set Field_Changed_Value Of Witemx_DDW Field Witemx.Company_Code     to sCompany_Code
52797>>>                                            Set Field_Changed_Value Of Witemx_DDW Field Witemx.Branch_Code      to sBranch_Code
52798>>>                                            Set Field_Changed_Value Of Witemx_DDW Field Witemx.Year_Year        to iYear
52799>>>                                            Set Field_Changed_Value Of Witemx_DDW Field Witemx.UNITS_CODE       to zUNITS_CODE
52800>>>                                            Set Field_Changed_Value Of Witemx_DDW Field Witemx.WITEMKAT_CODE    to zWITEMKAT_CODE
52801>>>                                            Set Field_Changed_Value Of Witemx_DDW Field Witemx.ITEM_CODE        to zItem_Code
52802>>>                                            Set Field_Changed_Value Of Witemx_DDW Field Witemx.Witemx_Code      to sCode
52803>>>                                            Set Field_Changed_Value Of Witemx_DDW Field Witemx.WITEMX_DESCR     to zWITEMX_DESCR
52804>>>                                            Set Field_Changed_Value Of Witemx_DDW Field Witemx.WITEMX_YEARDESC  to iYear
52805>>>                                            Set Field_Changed_Value Of Witemx_DDW Field Witemx.ITEM_APOKAT_COD  to zITEM_APOKAT_COD
52806>>>                                            Send Request_Save to Witemx_DDW
52807>>>                                        End
52807>>>>
52807>>>                                    End
52807>>>>
52807>>>                                    Else If (NOT(Found)) Begin
52810>>>                                        Send Clear to Item_DDW
52811>>>                                        Move zItem_Code to Item.Item_Code
52812>>>                                        Send Find To Item_DDW eq 5
52813>>>                                        Set Field_Changed_Value Of Witemx_DDW Field Witemx.Company_Code     to sCompany_Code
52814>>>                                        Set Field_Changed_Value Of Witemx_DDW Field Witemx.Branch_Code      to sBranch_Code
52815>>>                                        Set Field_Changed_Value Of Witemx_DDW Field Witemx.Year_Year        to iYear
52816>>>                                        Set Field_Changed_Value Of Witemx_DDW Field Witemx.UNITS_CODE       to zUNITS_CODE
52817>>>                                        Set Field_Changed_Value Of Witemx_DDW Field Witemx.WITEMKAT_CODE    to zWITEMKAT_CODE
52818>>>                                        Set Field_Changed_Value Of Witemx_DDW Field Witemx.ITEM_CODE        to zItem_Code
52819>>>                                        Set Field_Changed_Value Of Witemx_DDW Field Witemx.Witemx_Code      to sCode
52820>>>                                        Set Field_Changed_Value Of Witemx_DDW Field Witemx.WITEMX_DESCR     to zWITEMX_DESCR
52821>>>                                        Set Field_Changed_Value Of Witemx_DDW Field Witemx.WITEMX_YEARDESC  to iYear
52822>>>                                        Set Field_Changed_Value Of Witemx_DDW Field Witemx.ITEM_APOKAT_COD  to zITEM_APOKAT_COD
52823>>>                                        Send Request_Save to Witemx_DDW
52824>>>                                    End
52824>>>>
52824>>>                    
52824>>>                                    Get Field_Current_Value Of Witemx_DDW Field Witemx.Witemx_Recr to sRR3
52825>>>                    
52825>>>                                    Clear Witemxt
52826>>>                                    Move sRR    to Witemxt.Witemx_Recr
52827>>>                                    Find Gt Witemxt By Index.4
52828>>>>
52828>>>                                    While ((Found=1) And (sRR=Witemxt.Witemx_Recr))
52832>>>                                        Move Witemxt.Witemxt_Rec0   to iRec01
52833>>>                                        Move Witemxt.AXIA           to zAXIA
52834>>>                                        Move Witemxt.AXIA0          to zAXIA0
52835>>>                                        Move Witemxt.AXIA00         to zAXIA00
52836>>>                                        Move Witemxt.AXIAR          to zAXIAR
52837>>>                                        Move Witemxt.VALUE_DATE     to zVALUE_DATE
52838>>>                    
52838>>>                                        ////////////////////////////////////////////
52838>>>                                        Clear Witemxt
52839>>>                                        Move sCompany_Code      to Witemxt.Company_Code
52840>>>                                        Move sBranch_Code       to Witemxt.Branch_Code
52841>>>                                        Move iYear              to Witemxt.Year_Year
52842>>>                                        Move sRR3               to Witemxt.Witemx_Recr
52843>>>                                        Move zValue_Date        to Witemxt.Value_Date
52844>>>                    
52844>>>                                        Find Eq Witemxt By Index.1
52845>>>>
52845>>>                    
52845>>>                                        If (iForce) Begin
52847>>>                                            If (Found) Begin
52849>>>                                                Clear Witemx
52850>>>                                                Move sRR3 to Witemx.Witemx_Recr
52851>>>                                                Find Eq Witemx By Index.2
52852>>>>
52852>>>                                                Reread
52853>>>                                                Move Witemx.Witemx_Recr To Witemxt.Witemx_Recr
52854>>>                                                Move zAxia              to Witemxt.Axia
52855>>>                                                Move zAxia0             to Witemxt.Axia0
52856>>>                                                Move zAxia00            to Witemxt.Axia00
52857>>>                                                Move zAxiaR             to Witemxt.AxiaR
52858>>>                                                Saverecord Witemxt
52859>>>                                                Unlock
52860>>>>
52860>>>                                            End
52860>>>>
52860>>>                                            Else Begin
52861>>>                                                Clear Witemx
52862>>>                                                Move sRR3 to Witemx.Witemx_Recr
52863>>>                                                Find Eq Witemx By Index.2
52864>>>>
52864>>>                                                Move sCompany_Code              To Witemxt.Company_Code
52865>>>                                                Move sBranch_Code               To Witemxt.Branch_Code
52866>>>                                                Move iYear                      To Witemxt.Year_Year
52867>>>                                                Move Witemx.Witemx_Recr         To Witemxt.Witemx_Recr
52868>>>                                                Move zAxia                      to Witemxt.Axia
52869>>>                                                Move zAxia0                     to Witemxt.Axia0
52870>>>                                                Move zAxia00                    to Witemxt.Axia00
52871>>>                                                Move zAxiaR                     to Witemxt.AxiaR
52872>>>                                                Move (SYSRECW.Witemxt_REC0+1)  To Witemxt.Witemxt_Rec0
52873>>>                                                Reread SysrecW
52877>>>                                                Move (SYSRECW.Witemxt_REC0+1)  To SysrecW.Witemxt_Rec0
52878>>>                                                Saverecord SysrecW
52879>>>                                                Unlock
52880>>>>
52880>>>                                                Saverecord Witemxt
52881>>>                                            End
52881>>>>
52881>>>                                        End
52881>>>>
52881>>>                                        Else If (Not(Found)) Begin
52884>>>                                            Clear Witemx
52885>>>                                            Move sRR3 to Witemx.Witemx_Recr
52886>>>                                            Find Eq Witemx By Index.2
52887>>>>
52887>>>                                            Move sCompany_Code              To Witemxt.Company_Code
52888>>>                                            Move sBranch_Code               To Witemxt.Branch_Code
52889>>>                                            Move iYear                      To Witemxt.Year_Year
52890>>>                                            Move Witemx.Witemx_Recr         To Witemxt.Witemx_Recr
52891>>>                                            Move zAxia                      to Witemxt.Axia
52892>>>                                            Move zAxia0                     to Witemxt.Axia0
52893>>>                                            Move zAxia00                    to Witemxt.Axia00
52894>>>                                            Move zAxiaR                     to Witemxt.AxiaR
52895>>>                                            Move (SYSRECW.Witemxt_REC0+1)  To Witemxt.Witemxt_Rec0
52896>>>                                            Reread SysrecW
52900>>>                                            Move (SYSRECW.Witemxt_REC0+1)  To SysrecW.Witemxt_Rec0
52901>>>                                            Saverecord SysrecW
52902>>>                                            Unlock
52903>>>>
52903>>>                                            Saverecord Witemxt
52904>>>                                        End
52904>>>>
52904>>>                                        ////////////////////////////////////////////
52904>>>                                        Clear Witemxt
52905>>>                                        Move iRec01 to Witemxt.Witemxt_Rec0
52906>>>                                        Find eq Witemxt By Index.2
52907>>>>
52907>>>                                        Find Gt Witemxt By Index.4
52908>>>>
52908>>>                                    Loop
52909>>>>
52909>>>                    
52909>>>                                    Send Clear to Witemx_DDR
52910>>>                                    Move sRR to Witemx.Witemx_Recr
52911>>>                                    Send Find to Witemx_DDR eq 2
52912>>>                    
52912>>>                                    Send Find To Witemx_DDR Gt 1 //Comp+branch+year+Witemx_Code
52913>>>                                Loop
52914>>>>
52914>>>                            End // If (Witemx)
52914>>>>
52914>>>                    
52914>>>                            //////////////////
52914>>>                            //  H) Ptyppar
52914>>>                            //////////////////
52914>>>                            If (iPtyppar) Begin
52916>>>                                Send Clear      to Ptyppar_DDR
52917>>>                                Move SysCompany to Ptyppar.Company_Code
52918>>>                                Move SysBranch  to Ptyppar.Branch_Code
52919>>>                                Send Find To Ptyppar_DDR Gt 1 //Comp+branch+Ptyppar_Code
52920>>>                                While ((Found=1) And (SysCompany=Ptyppar.Company_Code)   ;                                                 And (SysBranch=Ptyppar.Branch_Code))
52924>>>                                    Set Label Of txtM1 to 'Ptyppar'
52925>>>                                    Set Label Of txtM2 to Ptyppar.Ptyppar_Code
52926>>>                    
52926>>>                                    Get Field_Current_value Of Ptyppar_DDR Field Ptyppar.Ptyppar_Code       to sCode
52927>>>                                    Get Field_Current_Value Of Ptyppar_DDR Field Ptyppar.Ptyppar_Recr       to sRR
52928>>>                                    Get Field_Current_value Of Ptyppar_DDR Field Ptyppar.CTYPKIN_CODE       to tCTYPKIN_CODE
52929>>>                                    Get Field_Current_Value Of Ptyppar_DDR Field Ptyppar.WTYPKIN_CODE       to tWTYPKIN_CODE
52930>>>                                    Get Field_Current_Value Of Ptyppar_DDR Field Ptyppar.CTYPKIN_RECR       to tCTYPKIN_RECR
52931>>>                                    Get Field_Current_Value Of Ptyppar_DDR Field Ptyppar.WTYPKIN_RECR       to tWTYPKIN_RECR
52932>>>                                    Get Field_Current_Value Of Ptyppar_DDR Field Ptyppar.PTYPPAR_DESCR      to tPTYPPAR_DESCR
52933>>>                                    Get Field_Current_Value Of Ptyppar_DDR Field Ptyppar.PTYPPAR_IS_WHAT    to tPTYPPAR_IS_WHAT
52934>>>                                    Get Field_Current_Value Of Ptyppar_DDR Field Ptyppar.PTYPPAR_MODULE     to tPTYPPAR_MODULE
52935>>>                                    Get Field_Current_Value Of Ptyppar_DDR Field Ptyppar.PTYPPAR_ABREV      to tPTYPPAR_ABREV
52936>>>                    
52936>>>                                    Get Field_Current_Value Of Ptyppar_DDR Field Ptyppar.FTIAXNEI_TPAY      to hFTIAXNEI_TPAY
52937>>>                                    Get Field_Current_Value Of Ptyppar_DDR Field Ptyppar.TI_TYPONEI_PMS     to hTI_TYPONEI_PMS
52938>>>                                    Get Field_Current_Value Of Ptyppar_DDR Field Ptyppar.EINAI_PAROXH_YP    to hEINAI_PAROXH_YP
52939>>>                                    Get Field_Current_Value Of Ptyppar_DDR Field Ptyppar.GTYPKIN_CODE       to hGTYPKIN_CODE
52940>>>                                    Get Field_Current_Value Of Ptyppar_DDR Field Ptyppar.SYSXET_PTYPPAR     to hSYSXET_PTYPPAR
52941>>>                                    Get Field_Current_Value Of Ptyppar_DDR Field Ptyppar.SYSX_PTYP_RECR     to hSYSX_PTYP_RECR
52942>>>                                    Get Field_Current_Value Of Ptyppar_DDR Field Ptyppar.CHECK_POSA_PLAF    to hCHECK_POSA_PLAF
52943>>>                    
52943>>>                                    Send Clear to Ptyppar_DDW
52944>>>                                    Move sCompany_Code  to Ptyppar.Company_Code
52945>>>                                    Move sBranch_Code   to Ptyppar.Branch_Code
52946>>>                                    Move sCode          to Ptyppar.Ptyppar_Code
52947>>>                                    Send Find to Ptyppar_DDW Eq 1
52948>>>                    
52948>>>                                    If (iForce) Begin
52950>>>                                        If (Found) Begin
52952>>>                                            Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.PTYPPAR_DESCR    to tPTYPPAR_DESCR
52953>>>                                            Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.PTYPPAR_IS_WHAT  to tPTYPPAR_IS_WHAT
52954>>>                                            Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.PTYPPAR_MODULE   to tPTYPPAR_MODULE
52955>>>                                            Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.PTYPPAR_ABREV    to tPTYPPAR_ABREV
52956>>>                                            Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.FTIAXNEI_TPAY    to hFTIAXNEI_TPAY
52957>>>                                            Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.TI_TYPONEI_PMS   to hTI_TYPONEI_PMS
52958>>>                                            Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.EINAI_PAROXH_YP  to hEINAI_PAROXH_YP
52959>>>                                            Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.GTYPKIN_CODE     to hGTYPKIN_CODE
52960>>>                                            Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.SYSXET_PTYPPAR   to hSYSXET_PTYPPAR
52961>>>                                            Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.SYSX_PTYP_RECR   to hSYSX_PTYP_RECR
52962>>>                                            Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.CHECK_POSA_PLAF  to hCHECK_POSA_PLAF
52963>>>                                            Send Request_Save to Ptyppar_DDW
52964>>>                                        End
52964>>>>
52964>>>                                        Else Begin
52965>>>                                            Send Clear          to Ctypkin_DDW
52966>>>                                            Move tCTYPKIN_CODE  to Ctypkin.Ctypkin_Code
52967>>>                                            Send Find           to Ctypkin_DDW Eq 1
52968>>>                    
52968>>>                                            Send Clear          to Wtypkin_DDW
52969>>>                                            Move tWtypkin_CODE  to Wtypkin.Wtypkin_Code
52970>>>                                            Send Find           to Wtypkin_DDW Eq 1
52971>>>                    
52971>>>                                            Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.Company_Code     to sCompany_Code
52972>>>                                            Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.Branch_Code      to sBranch_Code
52973>>>                                            Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.PTYPPAR_CODE     to sCODE
52974>>>                                            Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.PTYPPAR_DESCR    to tPTYPPAR_DESCR
52975>>>                                            Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.PTYPPAR_IS_WHAT  to tPTYPPAR_IS_WHAT
52976>>>                                            Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.PTYPPAR_MODULE   to tPTYPPAR_MODULE
52977>>>                                            Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.PTYPPAR_ABREV    to tPTYPPAR_ABREV
52978>>>                                            Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.FTIAXNEI_TPAY    to hFTIAXNEI_TPAY
52979>>>                                            Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.TI_TYPONEI_PMS   to hTI_TYPONEI_PMS
52980>>>                                            Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.EINAI_PAROXH_YP  to hEINAI_PAROXH_YP
52981>>>                                            Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.GTYPKIN_CODE     to hGTYPKIN_CODE
52982>>>                                            Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.SYSXET_PTYPPAR   to hSYSXET_PTYPPAR
52983>>>                                            Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.SYSX_PTYP_RECR   to hSYSX_PTYP_RECR
52984>>>                                            Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.CHECK_POSA_PLAF  to hCHECK_POSA_PLAF
52985>>>                                            Send Request_Save to Ptyppar_DDW
52986>>>                                        End
52986>>>>
52986>>>                                    End
52986>>>>
52986>>>                                    Else If (NOT(Found)) Begin
52989>>>                    
52989>>>                                        Send Clear          to Ctypkin_DDW
52990>>>                                        Move tCTYPKIN_CODE  to Ctypkin.Ctypkin_Code
52991>>>                                        Send Find           to Ctypkin_DDW Eq 1
52992>>>                    
52992>>>                                        Send Clear          to Wtypkin_DDW
52993>>>                                        Move tWtypkin_CODE  to Wtypkin.Wtypkin_Code
52994>>>                                        Send Find           to Wtypkin_DDW Eq 1
52995>>>                    
52995>>>                                        Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.Company_Code     to sCompany_Code
52996>>>                                        Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.Branch_Code      to sBranch_Code
52997>>>                                        Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.PTYPPAR_CODE     to sCODE
52998>>>                                        Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.PTYPPAR_DESCR    to tPTYPPAR_DESCR
52999>>>                                        Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.PTYPPAR_IS_WHAT  to tPTYPPAR_IS_WHAT
53000>>>                                        Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.PTYPPAR_MODULE   to tPTYPPAR_MODULE
53001>>>                                        Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.PTYPPAR_ABREV    to tPTYPPAR_ABREV
53002>>>                                        Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.FTIAXNEI_TPAY    to hFTIAXNEI_TPAY
53003>>>                                        Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.TI_TYPONEI_PMS   to hTI_TYPONEI_PMS
53004>>>                                        Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.EINAI_PAROXH_YP  to hEINAI_PAROXH_YP
53005>>>                                        Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.GTYPKIN_CODE     to hGTYPKIN_CODE
53006>>>                                        Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.SYSXET_PTYPPAR   to hSYSXET_PTYPPAR
53007>>>                                        Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.SYSX_PTYP_RECR   to hSYSX_PTYP_RECR
53008>>>                                        Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.CHECK_POSA_PLAF  to hCHECK_POSA_PLAF
53009>>>                                        Send Request_Save to Ptyppar_DDW
53010>>>                                    End
53010>>>>
53010>>>                    
53010>>>                                    Get Field_Current_Value Of Ptyppar_DDW Field Ptyppar.Ptyppar_Recr to sRR3
53011>>>                    
53011>>>                                    Clear Pseira
53012>>>                                    Move sRR to Pseira.Ptyppar_Recr
53013>>>                                    Find Gt Pseira By Index.3
53014>>>>
53014>>>                                    While ((Found=1) And (sRR=Pseira.Ptyppar_Recr))
53018>>>                    
53018>>>                                        Move Pseira.Pseira_Recr    to sRR2
53019>>>                                        Move Pseira.PSEIRA_SEIRA   to   tPSEIRA_SEIRA
53020>>>                                        Move Pseira.PSEIRA_REC0    to   tPSEIRA_REC0
53021>>>                                        Move Pseira.PSEIRA_PRINTER to   tPSEIRA_PRINTER
53022>>>                                        Move Pseira.PSEIRA_FORM    to   tPSEIRA_FORM
53023>>>                                        Move Pseira.PSEIRA_AUTONUM to   tPSEIRA_AUTONUM
53024>>>                                        Move Pseira.AUTONUM_PLUS   to   tAUTONUM_PLUS
53025>>>                                        Move Pseira.AUTONUM_MINUS  to   tAUTONUM_MINUS
53026>>>                                        ////////////////////////////////////////////
53026>>>                                        Clear Pseira
53027>>>                                        Move sCompany_Code      to Pseira.Company_Code
53028>>>                                        Move sBranch_Code       to Pseira.Branch_Code
53029>>>                                        //Move iYear              to Pseira.Year_Year
53029>>>                                        Move sCode              to Pseira.Ptyppar_Code
53030>>>                                        Move tpSeira_Seira      to Pseira.Pseira_Seira
53031>>>                                        Find Eq Pseira By Index.1
53032>>>>
53032>>>                                        If (iForce) Begin
53034>>>                                            If (Found) Begin
53036>>>                                                Clear Ptyppar
53037>>>                                                Move sRR3 to Ptyppar.Ptyppar_Recr
53038>>>                                                Find Eq Ptyppar By Index.2
53039>>>>
53039>>>                                                Reread
53040>>>                                                Move tWTYPKIN_CODE              to Pseira.WTYPKIN_CODE
53041>>>                                                Move tCtypkin_CODE              to Pseira.Ctypkin_CODE
53042>>>                                                Move tPSEIRA_PRINTER            to Pseira.PSEIRA_PRINTER
53043>>>                                                Move tPSEIRA_FORM               to Pseira.PSEIRA_FORM
53044>>>                                                Move tPSEIRA_AUTONUM            to Pseira.PSEIRA_AUTONUM
53045>>>                                                Move tAUTONUM_PLUS              to Pseira.AUTONUM_PLUS
53046>>>                                                Move tAUTONUM_MINUS             to Pseira.AUTONUM_MINUS
53047>>>                                                Move Ptyppar.Ptyppar_Recr       To Pseira.Ptyppar_Recr
53048>>>                                                Saverecord Pseira
53049>>>                                                Unlock
53050>>>>
53050>>>                                            End
53050>>>>
53050>>>                                            Else Begin
53051>>>                                                Clear Ptyppar
53052>>>                                                Move sRR3 to Ptyppar.Ptyppar_Recr
53053>>>                                                Find Eq Ptyppar By Index.2
53054>>>>
53054>>>                                                Move sCompany_Code              To Pseira.Company_Code
53055>>>                                                Move sBranch_Code               To Pseira.Branch_Code
53056>>>                                                //Move iYear                      To Pseira.Year_Year
53056>>>                                                Move sCode                      To Pseira.Ptyppar_Code
53057>>>                                                Move tPSEIRA_SEIRA              to Pseira.PSEIRA_SEIRA
53058>>>                                                Move tPSEIRA_PRINTER            to Pseira.PSEIRA_PRINTER
53059>>>                                                Move tPSEIRA_FORM               to Pseira.PSEIRA_FORM
53060>>>                                                Move tPSEIRA_AUTONUM            to Pseira.PSEIRA_AUTONUM
53061>>>                                                Move tAUTONUM_PLUS              to Pseira.AUTONUM_PLUS
53062>>>                                                Move tAUTONUM_MINUS             to Pseira.AUTONUM_MINUS
53063>>>                                                Move tWTYPKIN_CODE              to Pseira.WTYPKIN_CODE
53064>>>                                                Move tCtypkin_CODE              to Pseira.Ctypkin_CODE
53065>>>                                                Move Ptyppar.Ptyppar_Recr       To Pseira.Ptyppar_Recr
53066>>>                                                Move (SYSRECP.Pseira_REC0+1)    To Pseira.Pseira_Rec0
53067>>>                                                Reread SysrecP
53071>>>                                                Move (SYSRECP.Pseira_REC0+1)    To SysrecP.Pseira_Rec0
53072>>>                                                Saverecord SysrecP
53073>>>                                                Unlock
53074>>>>
53074>>>                                                Move (Append('',((Trim(sSite))+;                                                (Trim(String(Pseira.Pseira_Rec0)))))) to Pseira.Pseira_Recr
53075>>>                                                Saverecord Pseira
53076>>>                                            End
53076>>>>
53076>>>                                        End
53076>>>>
53076>>>                                        Else If (Not(Found)) Begin
53079>>>                                            Clear Ptyppar
53080>>>                                            Move sRR3 to Ptyppar.Ptyppar_Recr
53081>>>                                            Find Eq Ptyppar By Index.2
53082>>>>
53082>>>                                            Move sCompany_Code              To Pseira.Company_Code
53083>>>                                            Move sBranch_Code               To Pseira.Branch_Code
53084>>>                                            //Move iYear                      To Pseira.Year_Year
53084>>>                                            Move sCode                      To Pseira.Ptyppar_Code
53085>>>                                            Move tPSEIRA_SEIRA              to Pseira.PSEIRA_SEIRA
53086>>>                                            Move tPSEIRA_PRINTER            to Pseira.PSEIRA_PRINTER
53087>>>                                            Move tPSEIRA_FORM               to Pseira.PSEIRA_FORM
53088>>>                                            Move tPSEIRA_AUTONUM            to Pseira.PSEIRA_AUTONUM
53089>>>                                            Move tAUTONUM_PLUS              to Pseira.AUTONUM_PLUS
53090>>>                                            Move tAUTONUM_MINUS             to Pseira.AUTONUM_MINUS
53091>>>                                            Move tWTYPKIN_CODE              to Pseira.WTYPKIN_CODE
53092>>>                                            Move tCtypkin_CODE              to Pseira.Ctypkin_CODE
53093>>>                                            Move Ptyppar.Ptyppar_Recr       To Pseira.Ptyppar_Recr
53094>>>                                            Move (SYSRECP.Pseira_REC0+1)    To Pseira.Pseira_Rec0
53095>>>                                            Reread SysrecP
53099>>>                                            Move (SYSRECP.Pseira_REC0+1)    To SysrecP.Pseira_Rec0
53100>>>                                            Saverecord SysrecP
53101>>>                                            Unlock
53102>>>>
53102>>>                                            Move (Append('',((Trim(sSite))+;                                            (Trim(String(Pseira.Pseira_Rec0)))))) to Pseira.Pseira_Recr
53103>>>                                            Saverecord Pseira
53104>>>                                        End
53104>>>>
53104>>>                                        ////////////////////////////////////////////
53104>>>                                        Clear Pseira
53105>>>                                        Move sRR2 to Pseira.Pseira_Recr
53106>>>                                        Find eq Pseira By Index.2
53107>>>>
53107>>>                                        Find Gt Pseira By Index.3
53108>>>>
53108>>>                                    Loop
53109>>>>
53109>>>                    
53109>>>                                    Send Clear to Ptyppar_DDR
53110>>>                                    Move SysCompany     to Ptyppar.Company_Code
53111>>>                                    Move SysBranch      to Ptyppar.Branch_Code
53112>>>                                    Move sCode          to Ptyppar.Ptyppar_Code
53113>>>                                    Send Find to Ptyppar_DDR Eq 1
53114>>>                    
53114>>>                                    Send Find To Ptyppar_DDR Gt 1 //Comp+branch+Ptyppar_Code
53115>>>                                Loop
53116>>>>
53116>>>                            End // If (iPtyppar)
53116>>>>
53116>>>                    
53116>>>                    
53116>>>                                If (iclorder) Begin
53118>>>                                  Send Clear       to clorder_DD
53119>>>                                  Move SysCompany  to clorder.Company_Code
53120>>>                                  Move SysBranch   to clorder.Branch_Code
53121>>>                                  Move SysYear     to clorder.Year_Year
53122>>>                                  Send Find To clorder_DD Gt 1 //Comp+branch+year+clients_code+aapar
53123>>>                                  while (found=1)
53127>>>                                       Get Field_Current_value Of clorder_DD Field clorder.recr    to srr
53128>>>                                       set psrecr to srr
53129>>>                                       if    ((clorder.rial_date='') and (SysCompany=clorder.Company_Code)   ;                                                                     and (Sysbranch=clorder.Branch_Code)     ;                                                                     and (SysYear=clorder.Year_Year)) begin
53131>>>                                        Set Label Of txtM1 to 'clorder'
53132>>>                                        Set Label Of txtM2 to clorder.aapar
53133>>>                                        Get Field_Current_value Of clorder_DD Field clorder.aapar          to saapar
53134>>>                                        Get Field_Current_Value Of clorder_DD Field clorder.clients_code   to scode
53135>>>                                        Get Field_Current_Value Of clorder_DD Field clorder.armod          to sarmod
53136>>>                                        Get Field_Current_Value Of clorder_DD Field clorder.order1_recr    to sorder1
53137>>>                                        Get Field_Current_Value Of clorder_DD Field clorder.our_date       to dourdate
53138>>>                                        Get Field_Current_Value Of clorder_DD Field clorder.rial_date      to drialdate
53139>>>                                        Get Field_Current_Value Of clorder_DD Field clorder.qty            to nqty
53140>>>                                        Get Field_Current_Value Of clorder_DD Field clorder.unitprice      to nunit
53141>>>                                        Get Field_Current_Value Of clorder_DD Field clorder.disc           to ndisc
53142>>>                                        Get Field_Current_Value Of clorder_DD Field clorder.fpa            to nfpa
53143>>>                                        Get Field_Current_Value Of clorder_DD Field clorder.net            to nnet
53144>>>                                        Get Field_Current_Value Of clorder_DD Field clorder.extra          to nextra
53145>>>                                        Get Field_Current_Value Of clorder_DD Field clorder.total          to ntotal
53146>>>                                        Get Field_Current_Value Of clorder_DD Field clorder.aaparprom      to saaparprom
53147>>>                                        Get Field_Current_Value Of clorder_DD Field clorder.tropos         to stropos
53148>>>                                        Get Field_Current_Value Of clorder_DD Field clorder.date           to ddate
53149>>>                                        Get Field_Current_Value Of clorder_DD Field clorder.how_pay        to showpay
53150>>>                                        Get Field_Current_Value Of clorder_DD Field clorder.finish         to ifinish
53151>>>                                        Get Field_Current_Value Of clorder_DD Field clorder.okey           to iokey
53152>>>                                        Get Field_Current_Value Of clorder_DD Field clorder.akyrh          to iakyrh
53153>>>                                        Get Field_Current_Value Of clorder_DD Field clorder.posodtl        to nposodtl
53154>>>                                        Get Field_Current_Value Of clorder_DD Field clorder.qtydtl         to nqtydtl
53155>>>                                        Get Field_Current_Value Of clorder_DD Field clorder.nomisma        to snom1
53156>>>                                        Get Field_Current_Value Of clorder_DD Field clorder.module         to smodule
53157>>>                                        Send Clear to clorder_DD2
53158>>>                                        Move sCompany_Code  to clorder.Company_Code
53159>>>                                        Move sBranch_Code   to clorder.Branch_Code
53160>>>                                        Move iYear          to clorder.Year_Year
53161>>>                                        Move sCode          to clorder.clients_Code
53162>>>                                        move saapar         to clorder.aapar
53163>>>                                        Send Find to clorder_DD2 Eq 1
53164>>>                                        If (NOT(Found)) Begin
53166>>>                                            move scode to clients.client_id
53167>>>                                            send find to clients_dd2 eq 6
53168>>>                                            Set Field_Changed_Value Of clorder_DD2 Field clorder.Company_Code   to sCompany_Code
53169>>>                                            Set Field_Changed_Value Of clorder_DD2 Field clorder.Branch_Code    to sBranch_Code
53170>>>                                            Set Field_Changed_Value Of clorder_DD2 Field clorder.Year_Year      to iYear
53171>>>                                            set Field_changed_value Of clorder_DD2 Field clorder.aapar          to saapar
53172>>>                                            set Field_changed_Value Of clorder_DD2 Field clorder.clients_code   to scode
53173>>>                                            set Field_changed_Value Of clorder_DD2 Field clorder.armod          to sarmod
53174>>>                                            set Field_changed_Value Of clorder_DD2 Field clorder.order1_recr    to sorder1
53175>>>                                            set Field_changed_Value Of clorder_DD2 Field clorder.our_date       to dourdate
53176>>>                                            set Field_changed_Value Of clorder_DD2 Field clorder.rial_date      to drialdate
53177>>>                                            set Field_changed_Value Of clorder_DD2 Field clorder.qty            to nqty
53178>>>                                            set Field_changed_Value Of clorder_DD2 Field clorder.unitprice      to nunit
53179>>>                                            set Field_changed_Value Of clorder_DD2 Field clorder.disc           to ndisc
53180>>>                                            set Field_changed_Value Of clorder_DD2 Field clorder.fpa            to nfpa
53181>>>                                            set Field_changed_Value Of clorder_DD2 Field clorder.net            to nnet
53182>>>                                            set Field_changed_Value Of clorder_DD2 Field clorder.extra          to nextra
53183>>>                                            set Field_changed_Value Of clorder_DD2 Field clorder.total          to ntotal
53184>>>                                            set Field_changed_Value Of clorder_DD2 Field clorder.aaparprom      to saaparprom
53185>>>                                            set Field_changed_Value Of clorder_DD2 Field clorder.tropos         to stropos
53186>>>                                            set Field_changed_Value Of clorder_DD2 Field clorder.date           to ddate
53187>>>                                            set Field_changed_Value Of clorder_DD2 Field clorder.how_pay        to showpay
53188>>>                                            set Field_changed_Value Of clorder_DD2 Field clorder.finish         to ifinish
53189>>>                                            set Field_changed_Value Of clorder_DD2 Field clorder.okey           to iokey
53190>>>                                            set Field_changed_Value Of clorder_DD2 Field clorder.akyrh          to iakyrh
53191>>>                                            set Field_changed_Value Of clorder_DD2 Field clorder.posodtl        to nposodtl
53192>>>                                            set Field_changed_Value Of clorder_DD2 Field clorder.qtydtl         to nqtydtl
53193>>>                                            set Field_changed_Value Of clorder_DD2 Field clorder.nomisma        to snom1
53194>>>                                            set Field_changed_Value Of clorder_DD2 Field clorder.module         to smodule
53195>>>                                            reread sysrecc
53199>>>                                            if (smodule = '01') begin
53201>>>                                               move (sysrecc.clorderc_rec0 + 1) to sirec0
53202>>>                                               move sirec0 to sysrecc.clorderc_rec0
53203>>>                                               saverecord sysrecc
53204>>>                                            end
53204>>>>
53204>>>                                            else begin
53205>>>                                               move (sysrecc.clorder_rec0 + 1) to sirec0
53206>>>                                               move sirec0 to sysrecc.clorder_rec0
53207>>>                                               saverecord sysrecc
53208>>>                                            end
53208>>>>
53208>>>                                            unlock
53209>>>>
53209>>>                                            set Field_changed_Value Of clorder_DD2 Field clorder.rec0 to sirec0
53210>>>                                            Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                                (Trim(String(sirec0)))))) to sirec0
53211>>>                                            set Field_changed_Value Of clorder_DD2 Field clorder.recr to sirec0
53212>>>                                            send request_save to clorder_dd2
53213>>>                                            send rebuild_constraints to clorderd_dd
53214>>>                                            send find to clorderd_dd first_record 1
53215>>>                                            while (found=1)
53219>>>                                                  Get Field_Current_value Of clorderd_DD Field clorderd.recr           to clorderdrecr
53220>>>                                                  Get Field_Current_value Of clorderd_DD Field clorderd.aa_par         to saapar
53221>>>                                                  Get Field_Current_Value Of clorderd_DD Field clorderd.clients_code   to scode
53222>>>                                                  Get Field_Current_Value Of clorderd_DD Field clorderd.item_code      to sitem
53223>>>                                                  Get Field_Current_Value Of clorderd_DD Field clorderd.client_item    to sclientitem
53224>>>                                                  Get Field_Current_Value Of clorderd_DD Field clorderd.pcdisc         to npcdisc
53225>>>                                                  Get Field_Current_Value Of clorderd_DD Field clorderd.pcfpa          to npcfpa
53226>>>                                                  Get Field_Current_Value Of clorderd_DD Field clorderd.ourdate        to dourdate
53227>>>                                                  Get Field_Current_Value Of clorderd_DD Field clorderd.rial_date      to drialdate
53228>>>                                                  Get Field_Current_Value Of clorderd_DD Field clorderd.qty            to nqty
53229>>>                                                  Get Field_Current_Value Of clorderd_DD Field clorderd.unitprice      to nunit
53230>>>                                                  Get Field_Current_Value Of clorderd_DD Field clorderd.posodisc       to ndisc
53231>>>                                                  Get Field_Current_Value Of clorderd_DD Field clorderd.posofpa        to nfpa
53232>>>                                                  Get Field_Current_Value Of clorderd_DD Field clorderd.net            to nnet
53233>>>                                                  Get Field_Current_Value Of clorderd_DD Field clorderd.posoextra      to nextra
53234>>>                                                  Get Field_Current_Value Of clorderd_DD Field clorderd.posototal      to ntotal
53235>>>                                                  Get Field_Current_Value Of clorderd_DD Field clorderd.kinish_posothta to nkposothta
53236>>>                                                  Get Field_Current_Value Of clorderd_DD Field clorderd.kinhsh_poso    to nkposo
53237>>>                                                  Get Field_Current_Value Of clorderd_DD Field clorderd.date           to ddate
53238>>>                                                  Get Field_Current_Value Of clorderd_DD Field clorderd.kinhsh_fpa     to nkfpa
53239>>>                                                  Get Field_Current_Value Of clorderd_DD Field clorderd.finish         to ifinish
53240>>>                                                  Get Field_Current_Value Of clorderd_DD Field clorderd.kinhsh_net     to nknet
53241>>>                                                  Get Field_Current_Value Of clorderd_DD Field clorderd.akyrh          to iakyrh
53242>>>                                                  Get Field_Current_Value Of clorderd_DD Field clorderd.rial_qty       to nrialqty
53243>>>                                                  Get Field_Current_Value Of clorderd_DD Field clorderd.ypol_qty       to nypolqty
53244>>>                                                  Get Field_Current_Value Of clorderd_DD Field clorderd.akyrh_qty      to nakyrhqty
53245>>>                                                  Get Field_Current_Value Of clorderd_DD Field clorderd.epistrofh_qty  to nepistrofhqty
53246>>>                                                  Get Field_Current_Value Of clorderd_DD Field clorderd.status         to istatus
53247>>>                                                  Get Field_Current_Value Of clorderd_DD Field clorderd.pmoves_recr    to spmovesrecr
53248>>>                                                  Get Field_Current_Value Of clorderd_DD Field clorderd.wax_recr       to swaxrecr
53249>>>                                                  Get Field_Current_Value Of clorderd_DD Field clorderd.module         to smodule
53250>>>                                                  send clear to wax_ddr
53251>>>                                                  move swaxrecr to wax.wax_recr
53252>>>                                                  send find to wax_ddr eq 2
53253>>>                                                  if (found=1) begin
53255>>>                                                      Get Field_Current_Value Of wax_ddr Field wax.wapokat_code  to wwapokat_code
53256>>>                                                      Get Field_Current_Value Of wax_ddr Field wax.wapomast_code to wwapomast_code
53257>>>                                                      Get Field_Current_Value Of wax_ddr Field wax.wax_code      to wwax_code
53258>>>                                                      send clear to wax_ddr
53259>>>                                                      Move sCompany_Code  to wax.Company_Code
53260>>>                                                      Move sBranch_Code   to wax.Branch_Code
53261>>>                                                      Move iYear          to wax.Year_Year
53262>>>                                                      move wwapokat_code  to wax.wapokat_code
53263>>>                                                      move wwapomast_code to wax.wapomast_code
53264>>>                                                      Move iYear          to wax.wax_code
53265>>>                                                      send find to wax_ddr eq 1
53266>>>                                                      if (found=1) Get Field_Current_Value Of wax_ddr Field wax.wax_recr to swaxrecr
53269>>>                                                  end
53269>>>>
53269>>>                                                  Send Clear to clorderd_DD2
53270>>>                                                  set Field_changed_value Of clorderd_DD2 Field clorderd.company_code   to sCompany_Code
53271>>>                                                  set Field_changed_value Of clorderd_DD2 Field clorderd.branch_code    to sBranch_Code
53272>>>                                                  set Field_changed_value Of clorderd_DD2 Field clorderd.year_year      to iYear
53273>>>                                                  set Field_changed_value Of clorderd_DD2 Field clorderd.aa_par         to saapar
53274>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.clients_code   to scode
53275>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.item_code      to sitem
53276>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.client_item    to sclientitem
53277>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.pcdisc         to npcdisc
53278>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.pcfpa          to npcfpa
53279>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.ourdate        to dourdate
53280>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.rial_date      to drialdate
53281>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.qty            to nqty
53282>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.unitprice      to nunit
53283>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.posodisc       to ndisc
53284>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.posofpa        to nfpa
53285>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.net            to nnet
53286>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.posoextra      to nextra
53287>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.posototal      to ntotal
53288>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.kinish_posothta to nkposothta
53289>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.kinhsh_poso    to nkposo
53290>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.date           to ddate
53291>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.kinhsh_fpa     to nkfpa
53292>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.finish         to ifinish
53293>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.kinhsh_net     to nknet
53294>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.akyrh          to iakyrh
53295>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.rial_qty       to nrialqty
53296>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.ypol_qty       to nypolqty
53297>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.akyrh_qty      to nakyrhqty
53298>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.epistrofh_qty  to nepistrofhqty
53299>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.status         to istatus
53300>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.pmoves_recr    to spmovesrecr
53301>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.wax_recr       to swaxrecr
53302>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.module         to smodule
53303>>>                                                  reread sysrecc
53307>>>                                                  if (smodule = '01') begin
53309>>>                                                     move (sysrecc.clorderdc_rec0 + 1) to sirec0
53310>>>                                                     move sirec0 to sysrecc.clorderdc_rec0
53311>>>                                                     saverecord sysrecc
53312>>>                                                  end
53312>>>>
53312>>>                                                  else begin
53313>>>                                                     move (sysrecc.clorderd_rec0 + 1) to sirec0
53314>>>                                                     move sirec0 to sysrecc.clorderd_rec0
53315>>>                                                     saverecord sysrecc
53316>>>                                                  end
53316>>>>
53316>>>                                                  unlock
53317>>>>
53317>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.rec0 to  sirec0
53318>>>                                                  Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                                       (Trim(String(sirec0)))))) to sirec0
53319>>>                                                  set Field_changed_Value Of clorderd_DD2 Field clorderd.recr to  sirec0
53320>>>                                                  send request_save to clorderd_dd2
53321>>>                                             send clear to clorderd_dd
53322>>>                                             move clorderdrecr to clorderd.recr
53323>>>                                             send find to clorderd_dd eq 2
53324>>>                                             send find to clorderd_dd gt 1
53325>>>                                             loop
53326>>>>
53326>>>                                          end
53326>>>>
53326>>>                                       end
53326>>>>
53326>>>                    
53326>>>                                    Move sRR to clorder.recr
53327>>>                                    Send Find to clorder_DD eq 2
53328>>>                                    Send Find To clorder_DD Gt 1 //Comp+branch+year+clients_code+aapar
53329>>>                                  Loop
53330>>>>
53330>>>                                End // If (iclorder)
53330>>>>
53330>>>                    
53330>>>                            // „§˜¤˜­¦¨á «¨â®¦¬©˜ª ®¨ã©žª
53330>>>                            If  (Trim(sCurrentXrhsh)<>'') Begin
53332>>>                                Send Clear to Year_DDR
53333>>>                                Move sCurrentXrhsh   to Year.Year_Recr
53334>>>                                Send Find to Year_DDR Eq 2
53335>>>                                If (Found) Begin
53337>>>                                    // „§˜¤˜­¦¨á  record SysCurXr
53337>>>                                    Get Field_Current_Value of Company_DDR Field Company.Company_Code to gs_Selected_Company_Code
53338>>>                                    Get Field_Current_Value of Company_DDR Field Company.Company_Name to sCname
53339>>>                                    Get Field_Current_Value of Branch_DDR  Field Branch.Branch_Code   to gs_Selected_Branch_Code
53340>>>                                    Get Field_Current_Value of Branch_DDR  Field Branch.Beto_Site     to gs_Selected_Beto_Site
53341>>>                                    Get Field_Current_Value of Branch_DDR  Field Branch.Branch_Site   to sSite
53342>>>                                    Get Field_Current_Value of Branch_DDR  Field Branch.Branch_name   to sBname
53343>>>                                    Get Field_Current_Value of Year_DDR    Field Year.Year_Year       to gi_Selected_Year
53344>>>                                    Get Field_Current_Value of Year_DDR    Field Year.Year_XrhshFrom  to ldYearXrhsh_From
53345>>>                                    Get Field_Current_Value of Year_DDR    Field Year.Year_XrhshTo    to ldYearXrhsh_To
53346>>>                                    Get Field_Current_Value of Year_DDR    Field Year.Year_Recr       to sYearRecr
53347>>>                                    Get Field_Current_Value of Year_DDR    Field Year.Year_C_Code0    to sNom1
53348>>>                                    Get Field_Current_Value of Year_DDR    Field Year.Year_C_Code00   to sNom2
53349>>>                                    Get Field_Current_Value of Year_DDR    Field Year.Year_C_CodeR    to sNom3
53350>>>                                    Get Field_Current_Value of Year_DDR    Field Year.Year_Descr      to sYname
53351>>>                                    Reread SysCurXR
53355>>>                                    Move gs_Selected_Company_Code   to SysCurXR.Company_Code
53356>>>                                    Move gs_Selected_beto_site      to SysCurXR.beto_site
53357>>>                                    Move gs_Selected_Branch_Code    to SysCurXR.Branch_Code
53358>>>                                    Move gi_Selected_Year           to SysCurXR.Year_Year
53359>>>                                    Move sYearRecr                  to SysCurXR.Year_Recr
53360>>>                                    Move sSite                      to SysCurXR.Branch_Site
53361>>>                                    Move sCname                     to SysCurXR.Company_Name
53362>>>                                    Move sBname                     to SysCurXR.Branch_Name
53363>>>                                    Move sYname                     to SysCurXR.Year_Descr
53364>>>                                    Move ldYearXrhsh_From           to SysCurXr.Year_XrhshFrom
53365>>>                                    Move ldYearXrhsh_To             to SysCurXr.Year_XrhshTo
53366>>>                                    Move  (Trim(sNom1))             to SysCurXR.C_Code0
53367>>>                                    Move  (Trim(sNom2))             to SysCurXR.C_Code00
53368>>>                                    Move  (Trim(sNom3))             to SysCurXR.C_CodeR
53369>>>                                    Saverecord SysCurXR
53370>>>                                    Unlock
53371>>>>
53371>>>                                End
53371>>>>
53371>>>                            End
53371>>>>
53371>>>                        End
53371>>>>
53371>>>                        send info_box "† › ˜› ¡˜©å˜ ˜¤¦åš£˜«¦ª ®¨ã©žª «œ¢œåà©œ.\n¨å¤ ©¬¤œ®å©œ«œ, ¡¢œå©«œ «ž¤ œ­˜¨£¦šã ¡˜  ¥˜¤˜£§œå«œ" '¢ž¨¦­¦¨å˜'
53372>>>                        Set Label Of txtM1 to ''
53373>>>                        Set Label Of txtM2 to ''
53374>>>                    
53374>>>                        Function_Return rVal
53375>>>                    End_Function
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    
53376>>>                    //AB-StoreEnd
53376>>>
53376>>>                End_Object    // The_Table
53377>>>
53377>>>                Object TextBoxSub24 is a TextBoxSub
53379>>>                    Set Label to "‘«¦ á¤¦ š£˜ ¤â˜ª ®¨ã©žª ¤˜ £œ«˜­œ¨Ÿ¦ç¤ ¦  ˜¡æ¢¦¬Ÿœª œšš¨˜­âª "
53380>>>                    Set TextColor to clRed
53381>>>                    Set Location to 122 3
53382>>>                    Set Size to 10 239
53383>>>                    Set FontWeight to 600
53384>>>                End_Object    // TextBoxSub24
53385>>>
53385>>>                Object chkPtyppar is a CheckBoxSub
53387>>>                    Set Label to "Ptyppar"
53388>>>                    Set Size to 10 41
53389>>>                    Set Location to 137 3
53390>>>                End_Object    // chkPtyppar
53391>>>
53391>>>                Object chkForce is a CheckBoxSub
53393>>>                    Set Label to "Forced Update"
53394>>>                    Set Size to 10 64
53395>>>                    Set Location to 168 3
53396>>>                End_Object    // chkForce
53397>>>
53397>>>                Object txtM1 is a TextBoxSub
53399>>>                    Set Label to "txtM1"
53400>>>                    Set Location to 169 80
53401>>>                    Set Size to 10 58
53402>>>
53402>>>                    //AB-StoreStart
53402>>>                    Set label to ''
53403>>>                    
53403>>>                    //AB-StoreEnd
53403>>>
53403>>>                End_Object    // txtM1
53404>>>
53404>>>                Object txtM2 is a TextBoxSub
53406>>>                    Set Label to "txtM2"
53407>>>                    Set Location to 169 146
53408>>>                    Set Size to 10 81
53409>>>
53409>>>                    //AB-StoreStart
53409>>>                    Set label to ''
53410>>>                    
53410>>>                    //AB-StoreEnd
53410>>>
53410>>>                End_Object    // txtM2
53411>>>
53411>>>                Object chkWitemx is a CheckBoxSub
53413>>>                    Set Label to "Witemx"
53414>>>                    Set Size to 10 40
53415>>>                    Set Location to 150 79
53416>>>                End_Object    // chkWitemx
53417>>>
53417>>>                Object chkWax is a CheckBoxSub
53419>>>                    Set Label to "Wax"
53420>>>                    Set Size to 10 31
53421>>>                    Set Location to 137 79
53422>>>                End_Object    // chkWax
53423>>>
53423>>>                Object chkBaxio is a CheckBoxSub
53425>>>                    Set Label to "Baxio"
53426>>>                    Set Size to 10 34
53427>>>                    Set Location to 137 159
53428>>>                End_Object    // chkBaxio
53429>>>
53429>>>                Object TextBoxSub32 is a TextBoxSub
53431>>>                    Set Label to "‰à› ¡æª “§¦¡˜«.:     "
53432>>>                    Set Auto_Size_State to FALSE
53433>>>                    Set TextColor to clNavy
53434>>>                    Set FontSize to 4 0
53435>>>                    Set Location to 7 15
53436>>>                    Set Size to 10 60
53437>>>                    Set Justification_Mode to jMode_Left
53438>>>                    Set TypeFace to "MS Sans Serif"
53439>>>                    Set Enabled_State to TRUE
53440>>>                End_Object    // TextBoxSub32
53441>>>
53441>>>                Object Company_Company_Code is a dbFormSub
53443>>>                    Entry_Item Branch.Branch_code
53444>>>                    Set Server to (Branch_DD(self))
53445>>>                    Set Size to 13 66
53446>>>                    Set Location to 6 77
53447>>>                    Set Label_Col_Offset to 2
53448>>>                    Set Label_Justification_Mode to jMode_Right
53449>>>
53449>>>                    //AB-StoreStart
53449>>>                    Set Prompt_Object to (sl002(Current_object))
53450>>>                    //AB-StoreEnd
53450>>>
53450>>>                End_Object    // Company_Company_Code
53451>>>
53451>>>                Object TextBoxSub33 is a TextBoxSub
53453>>>                    Set Label to "Ž¤¦£˜©å˜ :"
53454>>>                    Set Auto_Size_State to FALSE
53455>>>                    Set TextColor to clNavy
53456>>>                    Set FontSize to 4 0
53457>>>                    Set Location to 22 15
53458>>>                    Set Size to 10 55
53459>>>                    Set Justification_Mode to jMode_Left
53460>>>                    Set TypeFace to "MS Sans Serif"
53461>>>                    Set Enabled_State to TRUE
53462>>>                End_Object    // TextBoxSub33
53463>>>
53463>>>                Object Company_Company_Name is a dbFormSub
53465>>>                    Entry_Item Branch.Branch_name
53466>>>                    Set Server to (Branch_DD(self))
53467>>>                    Set Size to 13 285
53468>>>                    Set Location to 22 77
53469>>>                    Set Label_Col_Offset to 2
53470>>>                    Set Label_Justification_Mode to jMode_Right
53471>>>
53471>>>                    //AB-StoreStart
53471>>>                    Set Prompt_Object to (sl001(Current_object))
53472>>>                    //AB-StoreEnd
53472>>>
53472>>>                End_Object    // Company_Company_Name
53473>>>
53473>>>                Object chkclorder is a CheckBoxSub
53475>>>                    Set Label to "Clorder"
53476>>>                    Set Size to 10 39
53477>>>                    Set Location to 150 159
53478>>>                End_Object    // chkclorder
53479>>>
53479>>>                Object chkptypmet is a CheckBoxSub
53481>>>                    Set Label to "Ptypmet"
53482>>>                    Set Size to 10 42
53483>>>                    Set Location to 150 3
53484>>>                End_Object    // chkptypmet
53485>>>
53485>>>                Object frmOtherYear is a dbFormSub
53487>>>                    Entry_Item Year.Year_recr
53488>>>                    Set Server to (Year_DD(self))
53489>>>                    Set Size to 13 77
53490>>>                    Set Location to 132 355
53491>>>                    Set Label_Col_Offset to 2
53492>>>                    Set Label_Justification_Mode to jMode_Right
53493>>>                    Set Prompt_Button_Mode to pb_PromptOn
53494>>>
53494>>>                    //AB-StoreStart
53494>>>                                                                                            
53494>>>                    Set Prompt_Object to (sl003(Self))
53495>>>                    Set Server to (Year_DDF2(Self))
53496>>>                    
53496>>>                    
53496>>>                    
53496>>>                    //AB-StoreEnd
53496>>>
53496>>>                End_Object    // frmOtherYear
53497>>>
53497>>>                Object Company_Company_Name is a dbFormSub
53499>>>                    Entry_Item Company.Company_name
53500>>>                    Set Size to 13 126
53501>>>                    Set Location to 146 355
53502>>>                    Set Color to clBtnFace
53503>>>                    Set Label_Col_Offset to 2
53504>>>                    Set Label_Justification_Mode to jMode_Right
53505>>>                    Set Enabled_State to FALSE
53506>>>                    Set Item_Shadow_State Item 0 to TRUE
53507>>>                    Set Shadow_State Item 0 to TRUE
53508>>>
53508>>>                    //AB-StoreStart
53508>>>                                                                                            
53508>>>                    Set Server to (Year_DDF2(Self))
53509>>>                    
53509>>>                    
53509>>>                    //AB-StoreEnd
53509>>>
53509>>>                End_Object    // Company_Company_Name
53510>>>
53510>>>                Object Branch_Branch_Name is a dbFormSub
53512>>>                    Entry_Item Branch.Branch_name
53513>>>                    Set Server to (Branch_DD(self))
53514>>>                    Set Size to 13 126
53515>>>                    Set Location to 159 355
53516>>>                    Set Color to clBtnFace
53517>>>                    Set Label_Col_Offset to 2
53518>>>                    Set Label_Justification_Mode to jMode_Right
53519>>>                    Set Enabled_State to FALSE
53520>>>                    Set Item_Shadow_State Item 0 to TRUE
53521>>>                    Set Shadow_State Item 0 to TRUE
53522>>>
53522>>>                    //AB-StoreStart
53522>>>                                                                                            
53522>>>                    Set Server to (Year_DDF2(Self))
53523>>>                    
53523>>>                    
53523>>>                    //AB-StoreEnd
53523>>>
53523>>>                End_Object    // Branch_Branch_Name
53524>>>
53524>>>                Object Year_Year_Year is a dbFormSub
53526>>>                    Entry_Item Year.Year_year
53527>>>                    Set Server to (Year_DD(self))
53528>>>                    Set Size to 13 45
53529>>>                    Set Location to 132 436
53530>>>                    Set Color to clBtnFace
53531>>>                    Set Label_Col_Offset to 2
53532>>>                    Set Label_Justification_Mode to jMode_Right
53533>>>                    Set Enabled_State to FALSE
53534>>>                    Set Item_Shadow_State Item 0 to TRUE
53535>>>                    Set Shadow_State Item 0 to TRUE
53536>>>
53536>>>                    //AB-StoreStart
53536>>>                                                                                            
53536>>>                    Set Server to (Year_DDF2(Self))
53537>>>                    
53537>>>                    
53537>>>                    //AB-StoreEnd
53537>>>
53537>>>                End_Object    // Year_Year_Year
53538>>>
53538>>>                Object TextBoxSub44 is a TextBoxSub
53540>>>                    Set Label to "„§ ¢¦šã •¨ã©žª ˜§¦ á¢¢ž œ«˜ ¨å˜/®¨ã©ž"
53541>>>                    Set Location to 134 296
53542>>>                    Set Size to 25 54
53543>>>                    Set Justification_Mode to jMode_Center
53544>>>                End_Object    // TextBoxSub44
53545>>>
53545>>>
53545>>>                //AB-StoreStart
53545>>>                Set label to '•¨ã©œ ª / „«˜ ¨œå˜'
53546>>>                //AB-StoreEnd
53546>>>
53546>>>            End_Object    // dbTabPageSub3
53547>>>
53547>>>
53547>>>            //AB-StoreStart
53547>>>            Set Label to "‘«¦ ®œå˜ „«˜ ¨å˜ª"
53548>>>            
53548>>>            //AB-StoreEnd
53548>>>
53548>>>        End_Object    // dbTabDialogSub1
53549>>>
53549>>>        Object TextBoxSub1 is a TextBoxSub
53551>>>            Set Label to "‰à› ¡æª „«˜ ¨å˜ª     "
53552>>>            Set Auto_Size_State to FALSE
53553>>>            Set TextColor to clNavy
53554>>>            Set FontSize to 4 0
53555>>>            Set Location to 7 6
53556>>>            Set Size to 10 60
53557>>>            Set Justification_Mode to jMode_Left
53558>>>            Set TypeFace to "MS Sans Serif"
53559>>>            Set Enabled_State to TRUE
53560>>>        End_Object    // TextBoxSub1
53561>>>
53561>>>        Object TextBoxSub2 is a TextBoxSub
53563>>>            Set Label to "Ž¤¦£˜©å˜"
53564>>>            Set Auto_Size_State to FALSE
53565>>>            Set TextColor to clNavy
53566>>>            Set FontSize to 4 0
53567>>>            Set Location to 22 6
53568>>>            Set Size to 10 55
53569>>>            Set Justification_Mode to jMode_Left
53570>>>            Set TypeFace to "MS Sans Serif"
53571>>>            Set Enabled_State to TRUE
53572>>>        End_Object    // TextBoxSub2
53573>>>
53573>>>        Object dbBitmap3 is a dbBitmap
53575>>>            Entry_Item Company.Company_bitmap
53576>>>            Set Border_Style to Border_Normal
53577>>>            Set Size to 46 80
53578>>>            Set Location to 2 431
53579>>>            Set Bitmap_Style to Bitmap_Stretch
53580>>>
53580>>>            //AB-StoreStart
53580>>>            set Store_With_Pathname_State to true
53581>>>            //AB-StoreEnd
53581>>>
53581>>>        End_Object    // dbBitmap3
53582>>>
53582>>>        Object TextBoxSub43 is a TextBoxSub
53584>>>            Set Label to "„£§¦¨ ¡ã „§à¤¬£å˜"
53585>>>            Set Auto_Size_State to FALSE
53586>>>            Set TextColor to clNavy
53587>>>            Set FontSize to 4 0
53588>>>            Set Location to 38 6
53589>>>            Set Size to 12 66
53590>>>            Set Justification_Mode to jMode_Left
53591>>>            Set TypeFace to "MS Sans Serif"
53592>>>            Set Enabled_State to TRUE
53593>>>        End_Object    // TextBoxSub43
53594>>>
53594>>>
53594>>>        //AB-StoreStart
53594>>>                                
53594>>>        Set Verify_Exit_Msg     to Get_No_Confirmation
53595>>>        Set Verify_Save_MSG     to GET_Confirm_save_company
53596>>>        Set Verify_Delete_MSG   to GET_Confirm_delete_company
53597>>>        
53597>>>        Procedure Activate_View Returns Integer
53599>>>            Integer rVal igridid
53600>>>            String sCurrentXrhsh
53600>>>            Forward Get Msg_Activate_View to rVal
53602>>>            move (the_table(dbtabpagesub3(dbtabdialogsub1(self)))) to igridid
53603>>>            Get Field_Current_Value Of SysCurXr_DD Field SysCurXr.Year_Recr  to sCurrentXrhsh
53604>>>            Set psCurXr to sCurrentXrhsh
53605>>>            Procedure_return rVal
53606>>>        End_Procedure
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        
53607>>>        //AB-StoreEnd
53607>>>
53607>>>    End_Object    // V3
53608>>>
53608>>>
53608>>>    //AB-StoreStart
53608>>>            
53608>>>            
53608>>>            
53608>>>            
53608>>>            
53608>>>            
53608>>>            
53608>>>            
53608>>>            
53608>>>            
53608>>>    //AB-StoreEnd
53608>>>
53608>>>//AB/     End_Object    // prj
53608>        Open Nomisma
53610>        Open Isotimia
53612>        Use Roundfn.Fnc
53612>        
53612>        Function fngConvertPoso Global String asNomismaCodeApo Number anPoso ;                                       String asNomismaCodeSe  Date   adHmnia;                                       Number nIsotimia  Returns Number
53613>        
53613>            Number rVal nApo_Euro_Isot nSe_Euro_Isot
53614>            Integer iApo_Einai_Euro_Zone iApo_Einai_DRX iApo_Einai_Euro iDekadika_Apo
53614>            Integer iSe_Einai_Euro_Zone  iSe_Einai_DRX  iSe_Einai_Euro  iDekadika_Se
53614>            String  sCode
53614>        
53614>            If (asNomismaCodeApo=asNomismaCodeSe) Function_Return anPoso
53617>        
53617>            Clear Nomisma
53618>            Move (Trim(asNomismaCodeApo)) to Nomisma.Nomisma_Code
53619>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
53620>            Move Nomisma.Euro_Zone      to iApo_Einai_Euro_Zone
53621>            Move Nomisma.Einai_DRX      to iApo_Einai_DRX
53622>            Move Nomisma.Einai_EURO     to iApo_Einai_Euro
53623>            Move Nomisma.KL_ISOT_EURO   to nApo_Euro_Isot
53624>            Move Nomisma.Dekadika       to iDekadika_Apo
53625>            // 1. An to nomisma APO den einai ths zonhs euro prepei na vrethei h isotimia tou
53625>            If ((NOT(iApo_Einai_Euro_Zone)) And (nApo_Euro_Isot=0))  Begin
53627>                If (adHmnia='') Sysdate            adHmnia
53630>                Move (Trim(asNomismaCodeApo))   to sCode
53631>                Clear Isotimia
53632>                Move sCode                      to Isotimia.Nomisma_Code
53633>                Move (adHmnia+1)                to Isotimia.Isotimia_Hmnia
53634>                Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
53635>                Move Isotimia.Isotimia_Euro     to nApo_Euro_Isot
53636>            End
53636>        
53636>            Clear Nomisma
53637>            Move (Trim(asNomismaCodeSe)) to Nomisma.Nomisma_Code
53638>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
53639>            Move Nomisma.Euro_Zone      to iSe_Einai_Euro_Zone
53640>            Move Nomisma.Einai_DRX      to iSe_Einai_DRX
53641>            Move Nomisma.Einai_EURO     to iSe_Einai_Euro
53642>            Move Nomisma.KL_ISOT_EURO   to nSe_Euro_Isot
53643>            Move Nomisma.Dekadika       to iDekadika_Se
53644>            // 2. An to nomisma SE den einai ths zonhs euro prepei na vrethei h isotimia tou
53644>            If ((NOT(iSe_Einai_Euro_Zone)) And (nSe_Euro_Isot=0)) Begin
53646>                If (adHmnia='') Sysdate            adHmnia
53649>                Move (Trim(asNomismaCodeSe))    to sCode
53650>                Clear Isotimia
53651>                Move sCode                      to Isotimia.Nomisma_Code
53652>                Move (adHmnia+1)                to Isotimia.Isotimia_Hmnia
53653>                Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
53654>                Move Isotimia.Isotimia_Euro     to nSe_Euro_Isot
53655>            End
53655>        
53655>            Calc (anPoso/nApo_Euro_Isot) to rVal
53656>            Move (Round_Number(rVal,6)) to rVal
53657>            Calc (rVal*nSe_Euro_Isot) to rVal
53658>            Move (Round_Number(rVal,iDekadika_Se)) to rVal
53659>        
53659>            Function_Return rVal
53660>        End_Function
53661>        
53661>        //AB-ClientStoreTopEnd
53661>
53661>        //  Include all views
53661>        Use Taxioamal.VW                                                                    
INCLUDING FILE: TAXIOAMAL.VW
53661>>>//AB/ Project Taxioamal:amaliada
53661>>>//AB/ Object prj is a View_Project
53661>>>//AB/     Set ProjectName to "Taxioamal:amaliada"
53661>>>//AB/     Set ProjectFileName to "Taxioamal.VW"
53661>>>
53661>>>// Project Object Structure
53661>>>//   tAxioamal is a dbViewSub
53661>>>//     Ctypkin_DD is a Ctypkin_DataDictionary
53661>>>//     Country_DD is a Country_DataDictionary
53661>>>//     Towns_DD is a Towns_DataDictionary
53661>>>//     Cities_DD is a Cities_DataDictionary
53661>>>//     Payresp_DD is a Payresp_DataDictionary
53661>>>//     Constrct_DD is a Constrct_DataDictionary
53661>>>//     Salesmen_DD is a Salesmen_DataDictionary
53661>>>//     Mhxanik_DD is a Mhxanik_DataDictionary
53661>>>//     Areas_DD is a Areas_DataDictionary
53661>>>//     Btypkin_DD is a Btypkin_DataDictionary
53661>>>//     Baxiokat_DD is a Baxiokat_DataDictionary
53661>>>//     Barticl_DD is a Barticl_DataDictionary
53661>>>//     Bsum_DD is a Bsum_DataDictionary
53661>>>//     Baxio_DD is a Baxio_DataDictionary
53661>>>//     Syscurxr_DD is a Syscurxr_DataDictionary
53661>>>//     Sysrecc_DD is a Sysrecc_DataDictionary
53661>>>//     Clients_DD is a Clients_DataDictionary
53661>>>//     Cn_DD is a Cn_DataDictionary
53661>>>//     Tperga_DD is a Tperga_DataDictionary
53661>>>//     Bmove_DD is a Bmove_DataDictionary
53661>>>//     Cmoves_DD is a Cmoves_DataDictionary
53661>>>//     Btnordh_DD is a Btnordh_DataDictionary
53661>>>//     Btnordd_DD is a Btnordd_DataDictionary
53661>>>//     frmFileName is a FormSub
53661>>>//     frmBranch is a FormSub
53661>>>//     ButtonSub1 is a ButtonSub
53661>>>//     TextBoxSub1 is a TextBoxSub
53661>>>//     RadioGroupSub1 is a RadioGroupSub
53661>>>//       Radio1 is a RadioSub
53661>>>//       Radio2 is a RadioSub
53661>>>//       Radio3 is a RadioSub
53661>>>//       Radio1 is a RadioSub
53661>>>//       Radio2 is a RadioSub
53661>>>//     TextBoxSub2 is a TextBoxSub
53661>>>//     oOpenFile is a OpenDialog
53661>>>
53661>>>// Register all objects
53661>>>Register_Object Areas_DD
53661>>>Register_Object Barticl_DD
53661>>>Register_Object Baxio_DD
53661>>>Register_Object Baxiokat_DD
53661>>>Register_Object Bmove_DD
53661>>>Register_Object Bsum_DD
53661>>>Register_Object Btnordd_DD
53661>>>Register_Object Btnordh_DD
53661>>>Register_Object Btypkin_DD
53661>>>Register_Object ButtonSub1
53661>>>Register_Object Cities_DD
53661>>>Register_Object Clients_DD
53661>>>Register_Object Cmoves_DD
53661>>>Register_Object Cn_DD
53661>>>Register_Object Constrct_DD
53661>>>Register_Object Country_DD
53661>>>Register_Object Ctypkin_DD
53661>>>Register_Object frmBranch
53661>>>Register_Object frmFileName
53661>>>Register_Object Mhxanik_DD
53661>>>Register_Object oOpenFile
53661>>>Register_Object Payresp_DD
53661>>>Register_Object Radio1
53661>>>Register_Object Radio2
53661>>>Register_Object Radio3
53661>>>Register_Object RadioGroupSub1
53661>>>Register_Object Salesmen_DD
53661>>>Register_Object Syscurxr_DD
53661>>>Register_Object Sysrecc_DD
53661>>>Register_Object TextBoxSub1
53661>>>Register_Object TextBoxSub2
53661>>>Register_Object Towns_DD
53661>>>Register_Object Tperga_DD
53661>>>Register_Object tAxioamal
53661>>>
53661>>>
53661>>>//AB/ AppBuild VIEW
53661>>>
53661>>>
53661>>>//AB-StoreTopStart
53661>>>                    
53661>>>Use sl041.sl
53661>>>
53661>>>Use bpEnCmv3.dg // Business Process Finilizing Barticle
INCLUDING FILE: BPENCMV3.DG
53661>>>>>//AB/ Project bpencmv3
53661>>>>>//AB/     Object prj is a Dialog_Project
53661>>>>>//AB/         Set ProjectName to "bpencmv3"
53661>>>>>//AB/         Set ProjectFileName to "bpencmv3.DG"
53661>>>>>
53661>>>>>// Project Object Structure
53661>>>>>//   bpencmv3 is a BusinessProcessSub
53661>>>>>//     Ctypkin_DD is a DataDictionary
53661>>>>>//     Country_DD is a DataDictionary
53661>>>>>//     Towns_DD is a DataDictionary
53661>>>>>//     Cities_DD is a DataDictionary
53661>>>>>//     Payresp_DD is a DataDictionary
53661>>>>>//     Areas_DD is a DataDictionary
53661>>>>>//     Clients_DD is a DataDictionary
53661>>>>>//     Cmoves_DD is a DataDictionary
53661>>>>>//     Cflagkin_DD is a DataDictionary
53661>>>>>//     Btypkin_DD is a DataDictionary
53661>>>>>//     Baxiokat_DD is a DataDictionary
53661>>>>>//     Barticl_DD is a DataDictionary
53661>>>>>//     Baxio_DD is a DataDictionary
53661>>>>>//     Bmove_DD is a DataDictionary
53661>>>>>//     Nomisma_DD is a DataDictionary
53661>>>>>
53661>>>>>// Register all objects
53661>>>>>Register_Object Areas_DD
53661>>>>>Register_Object Barticl_DD
53661>>>>>Register_Object Baxio_DD
53661>>>>>Register_Object Baxiokat_DD
53661>>>>>Register_Object Bmove_DD
53661>>>>>Register_Object Btypkin_DD
53661>>>>>Register_Object bpencmv3
53661>>>>>Register_Object Cflagkin_DD
53661>>>>>Register_Object Cities_DD
53661>>>>>Register_Object Clients_DD
53661>>>>>Register_Object Cmoves_DD
53661>>>>>Register_Object Country_DD
53661>>>>>Register_Object Ctypkin_DD
53661>>>>>Register_Object Nomisma_DD
53661>>>>>Register_Object Payresp_DD
53661>>>>>Register_Object Towns_DD
53661>>>>>
53661>>>>>
53661>>>>>
53661>>>>>    //AB-StoreTopStart
53661>>>>>
53661>>>>>
53661>>>>>    //AB-StoreTopEnd
53661>>>>>
53661>>>>>    //AB-IgnoreStart
53661>>>>>
53661>>>>>    Use Bproces.Sub
53661>>>>>    Use DFAllEnt.pkg
53661>>>>>
53661>>>>>
53661>>>>>    Use CTYPKIN.DD
53661>>>>>    Use COUNTRY.DD
53661>>>>>    Use TOWNS.DD
53661>>>>>    Use CITIES.DD
53661>>>>>    Use PAYRESP.DD
53661>>>>>    Use AREAS.DD
53661>>>>>    Use CLIENTS.DD
53661>>>>>    Use CMOVES.DD
53661>>>>>    Use CFLAGKIN.DD
53661>>>>>    Use BTYPKIN.DD
53661>>>>>    Use BAXIOKAT.DD
53661>>>>>    Use BARTICL.DD
53661>>>>>    Use BAXIO.DD
53661>>>>>    Use BMOVE.DD
INCLUDING FILE: BMOVE.DD
53661>>>>>>>//DDB-FileStart
53661>>>>>>>//DDB-HeaderStart
53661>>>>>>>
53661>>>>>>>// File Name : BMOVE.DD
53661>>>>>>>// Class Name: Bmove_DataDictionary
53661>>>>>>>// Revision  : 47
53661>>>>>>>// Version   : 2
53661>>>>>>>
53661>>>>>>>Use  Windows           // Basic Definitions
53661>>>>>>>Use  DataDict          // DataDictionary Class Definition
53661>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
53661>>>>>>>
53661>>>>>>>Open Bmove
53663>>>>>>>Open Barticl
53665>>>>>>>Open Baxio
53667>>>>>>>Open Sysrecb
53669>>>>>>>Open Bkinkat
53671>>>>>>>Open Bsum
53673>>>>>>>
53673>>>>>>>//DDB-HeaderEnd
53673>>>>>>>
53673>>>>>>>      //§ Ÿ˜¤¦å ©¬¤›¬˜©£¦å « £é¤ «à¤ bkinkat.baxio_stat_from + bkinkat.baxio_stat_to
53673>>>>>>>      //  ˜§¦          ©œ
53673>>>>>>>      //    0           0    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
53673>>>>>>>      //    0           1    â ©˜šàšã ©«¦ ®˜¨«¦­¬¢á¡ ¦ (create a new baxio (33.90))
53673>>>>>>>      //    0           2    â¥˜šàšã ˜§¦ ®˜¨«¦­¬¢á¡ ¦  (create a new baxio (53.90))
53673>>>>>>>
53673>>>>>>>      //    1           0    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
53673>>>>>>>      //    1           1    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
53673>>>>>>>      //    1           2    â¥˜šàšã ˜§¦ ®˜¨«¦­¬¢á¡ ¦
53673>>>>>>>
53673>>>>>>>      //    2           0    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
53673>>>>>>>      //    2           1    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
53673>>>>>>>      //    2           2    £œ«˜™å™˜©ž §® ˜§¦ «¨á§œ˜ ©œ «¨á§œ˜
53673>>>>>>>
53673>>>>>>>
53673>>>>>>>//Register_Object SL056 //¢å©«˜ gplan
53673>>>>>>>//Register_Object SL102 //¢å©«˜ customer
53673>>>>>>>//gister_Object SL056   //¢å©«˜ vendor
53673>>>>>>>
53673>>>>>>>Open SysCurXr
53675>>>>>>>Open Baxiokat
53677>>>>>>>Open Btypkin
53679>>>>>>>Open Bkinkat
53681>>>>>>>Open Baxio
53683>>>>>>>
53683>>>>>>>//Use i:\homewin.dev\easyware.vis\gl\appsrc\doGlMntn.Bp //œ¤ž£â¨à©ž šœ¤ ¡ãª ¢¦š ©« ¡ãª
53683>>>>>>>//jsjsjsjs 24/01/2001 Use                                       doGlMntn.Bp //œ¤ž£â¨à©ž šœ¤ ¡ãª ¢¦š ©« ¡ãª
53683>>>>>>>
53683>>>>>>>//Use                                doCUMntn.Bp //œ¤ž£â¨à©ž §œ¢˜«é¤
53683>>>>>>>//Use                                doVEMntn.Bp //œ¤ž£â¨à©ž §¨¦£žŸœ¬«é¤
53683>>>>>>>
53683>>>>>>>Class Bmove_DataDictionary  is a DataDictionary_Sec
53684>>>>>>>
53684>>>>>>>      Procedure Construct_Object
53685>>>>>>>                Forward Send Construct_Object
53687>>>>>>>
53687>>>>>>>                Property Integer piCan_Create_Baxio (FALSE)
53688>>>>>>>
53688>>>>>>>                //object id «é¤ ddo servers š ˜ «á barticl+bmove+baxio+baxiokat
53688>>>>>>>                //©œ«á¨¦¤«˜  ˜§¦ «ž¤ end_construct
53688>>>>>>>                //®¨ž© £œç¦¬¤ ©«ž¤ private.exit_btypkin_code
53688>>>>>>>                //š ˜ ¤˜ ©œ«á¨¦¬¤ «¦ visual interface
53688>>>>>>>                Property Integer piBarticl_dd        0
53689>>>>>>>                Property Integer piBaxio_dd          0
53690>>>>>>>                Property Integer piBtypkin_dd        0
53691>>>>>>>                Property Integer piBaxiokat_dd       0
53692>>>>>>>                Property Integer piBaxio_Status_From 0
53693>>>>>>>                Property Integer piBaxio_Status_To   0
53694>>>>>>>
53694>>>>>>>                Property Integer piCreated_Bmove  0 //©œ«á¨œ«˜  ©«ž¤ creating,
53695>>>>>>>                                                    //®¨ž© £¦§¦ œå«˜  ©«ž¤ update+validate_save ¡˜ 
53695>>>>>>>                                                    //£ž›œ¤åœ«˜  ©«ž¤ request_save & delete «¦¬ bmove
53695>>>>>>>
53695>>>>>>>                Property Integer piB_Baxio_Status  0
53696>>>>>>>                Property Integer piA_Baxio_Status  0
53697>>>>>>>
53697>>>>>>>                //19 §˜¢˜ âª « £âª
53697>>>>>>>                Property  Integer piB_Garticl_Rec0           0
53698>>>>>>>                Property  Integer piB_Gtypkin_Rec0           0
53699>>>>>>>                Property  Date    pdB_Garticl_Hmnia          0
53700>>>>>>>                Property  Integer piB_Garticl_No             0
53701>>>>>>>                Property  String  psB_Garticl_C_Code2        0
53702>>>>>>>                Property  Number  pnB_Garticl_Rate0          0
53703>>>>>>>                Property  Number  pnB_Garticl_Rate00         0
53704>>>>>>>                Property  Number  pnB_Garticl_RateR          0
53705>>>>>>>                Property  String  psB_Garticl_Aitiol         0
53706>>>>>>>
53706>>>>>>>                Property  Integer piB_Gmove_Master_Rec0      0
53707>>>>>>>                Property  Integer piB_Gplan_Master_Rec0      0
53708>>>>>>>                Property  Number  pnB_Gmove_Master_X2        0
53709>>>>>>>                Property  Number  pnB_Gmove_Master_P2        0
53710>>>>>>>                Property  String  psB_Gmove_Master_Aitiol    0
53711>>>>>>>
53711>>>>>>>                Property  Integer piB_Gmove_Slave_Rec0       0
53712>>>>>>>                Property  Integer piB_Gplan_Slave_Rec0       0
53713>>>>>>>                Property  Number  pnB_Gmove_Slave_X2         0
53714>>>>>>>                Property  Number  pnB_Gmove_Slave_P2         0
53715>>>>>>>                Property  String  psB_Gmove_Slave_Aitiol     0
53716>>>>>>>
53716>>>>>>>                //19 ¤âœª « £âª
53716>>>>>>>                Property  Integer piA_Garticl_Rec0           0
53717>>>>>>>                Property  Integer piA_Gtypkin_Rec0           0
53718>>>>>>>                Property  Date    pdA_Garticl_Hmnia          0
53719>>>>>>>                Property  Integer piA_Garticl_No             0
53720>>>>>>>                Property  String  psA_Garticl_C_Code2        0
53721>>>>>>>                Property  Number  pnA_Garticl_Rate0          0
53722>>>>>>>                Property  Number  pnA_Garticl_Rate00         0
53723>>>>>>>                Property  Number  pnA_Garticl_RateR          0
53724>>>>>>>                Property  String  psA_Garticl_Aitiol         0
53725>>>>>>>
53725>>>>>>>                Property  Integer piA_Gmove_Master_Rec0      0
53726>>>>>>>                Property  Integer piA_Gplan_Master_Rec0      0
53727>>>>>>>                Property  Number  pnA_Gmove_Master_X2        0
53728>>>>>>>                Property  Number  pnA_Gmove_Master_P2        0
53729>>>>>>>                Property  String  psA_Gmove_Master_Aitiol    0
53730>>>>>>>
53730>>>>>>>                Property  Integer piA_Gmove_Slave_Rec0       0
53731>>>>>>>                Property  Integer piA_Gplan_Slave_Rec0       0
53732>>>>>>>                Property  Number  pnA_Gmove_Slave_X2         0
53733>>>>>>>                Property  Number  pnA_Gmove_Slave_P2         0
53734>>>>>>>                Property  String  psA_Gmove_Slave_Aitiol     0
53735>>>>>>>
53735>>>>>>>                Property  Integer piDo_GL_Maintainance       0 //object id «žª business process
53736>>>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «ã¤ šœ¤ ¡ã ¢¦š ©« ¡ã
53736>>>>>>>                Property  Integer piDo_CUSTOMER_Maintainance 0 //object id «žª business process
53737>>>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §œ¢á«œª
53737>>>>>>>                Property  Integer piDo_VENDOR_Maintainance   0 //object id «žª business process
53738>>>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §¨¦£žŸœ¬«âª
53738>>>>>>>
53738>>>>>>>                //3 properties š ˜ «ž¤ feedback œ¤ž£â¨à©ž ˜§¦ «ž¤ š¢
53738>>>>>>>                Property Integer  piF_Garticl_Rec0           0
53739>>>>>>>                Property Integer  piF_Gmove_Master_Rec0      0
53740>>>>>>>                Property Integer  piF_Gmove_Slave_Rec0       0
53741>>>>>>>
53741>>>>>>>                Property Integer  piUpdate                   0
53742>>>>>>>                Property Integer  piBackout                  0
53743>>>>>>>
53743>>>>>>>                //properties š ˜ «ž¤ procedural œ¤ž£â¨à©ž «¦¬ bsum
53743>>>>>>>                Property String   psB_Barticl_Recr           ''
53744>>>>>>>                Property String   psB_Baxiokat_Recr          ''
53745>>>>>>>                Property Number   pnB_Baxio_V2               0
53746>>>>>>>                Property Number   pnB_Baxio_V0               0
53747>>>>>>>                Property Number   pnB_Baxio_V00              0
53748>>>>>>>                Property Number   pnB_Baxio_VR               0
53749>>>>>>>
53749>>>>>>>                Property String   psA_Barticl_Recr           ''
53750>>>>>>>                Property String   psA_Baxiokat_Recr          ''
53751>>>>>>>                Property Number   pnA_Baxio_V2               0
53752>>>>>>>                Property Number   pnA_Baxio_V0               0
53753>>>>>>>                Property Number   pnA_Baxio_V00              0
53754>>>>>>>                Property Number   pnA_Baxio_VR               0
53755>>>>>>>
53755>>>>>>>                //booleans §¦¬ ›ž¢é¤¦¬¤ «˜ operations §¦¬ Ÿ˜ šå¤¦¬¤ ©«ž¤ š¢
53755>>>>>>>                Property Integer  piGarticl_Delete          0 //©œ«á¨œ«˜  ©«ž¤ backout
53756>>>>>>>                Property Integer  piGarticl_Edit            0 //˜¤«åŸœ«¦ «¦¬ create (update)
53757>>>>>>>                Property Integer  piGarticl_Create          0 //©œ«á¨œ«˜  ©«ž¤ update
53758>>>>>>>
53758>>>>>>>                Property Integer  piMaster_Gmove_Delete     0 //©œ«á¨œ«˜  ©«ž¤ backout
53759>>>>>>>                Property Integer  piMaster_Gmove_Edit       0 //˜¤«åŸœ«¦ «¦¬ create (update)
53760>>>>>>>                Property Integer  piMaster_Gmove_Create     0 //©œ«á¨œ«˜  ©«ž¤ private.creating_barticl
53761>>>>>>>
53761>>>>>>>                Property Integer  piSlave_Gmove_Delete      0 //©œ«á¨¦¤«˜  ©«ž¤ update_bsum
53762>>>>>>>                Property Integer  piSlave_Gmove_Edit        0 //©œ«á¨¦¤«˜  ©«ž¤ update_bsum
53763>>>>>>>                Property Integer  piSlave_Gmove_Create      0 //©œ«á¨¦¤«˜  ©«ž¤ update_bsum
53764>>>>>>>      End_Procedure   //construct_object
53765>>>>>>>
53765>>>>>>>
53765>>>>>>>
53765>>>>>>>      //****************************************************************************************
53765>>>>>>>      //**************P R O C E D U R A L    „ Œ † ‹„  — ‘ †    B S U M************************
53765>>>>>>>      //****************************************************************************************
53765>>>>>>>
53765>>>>>>>
53765>>>>>>>      //¡˜¢œå«˜  ˜§æ save+delete_main_file, «˜ œ£§¢œ¡æ£œ¤˜ ˜¨®œå˜ œå¤˜  locked
53765>>>>>>>      //¡˜  transaction is enabled !
53765>>>>>>>      //œ§å©žª â®à current record ©œ æ¢˜ «˜ parents.
53765>>>>>>>      //¡˜¢œå «ž¤ private.update_bsum
53765>>>>>>>      //œ§ ©«¨â­œ  «˜ œ¥ãª ¢áŸž:6001:˜¡˜«á¢¢ž¢¦ §¨æ©ž£¦ (¢áŸ¦ª ¡é› ¡˜ª)
53765>>>>>>>      //                        6002:ƒâ¤ â«¨œ¥œ ¦ç«œ update ¦ç«œ backout !
53765>>>>>>>      //œ§å©žª ˜§¦ ¢áŸ¦ª «¦¬ ¡é› ¡˜, £§¦¨œå ¤˜ ›é©œ  ¡˜  Error 10001 "Wrong Num Arguments!\n\nPlease Call Solution!"
53765>>>>>>>
53765>>>>>>>      //¡˜¢œå «ž¤ private.update_bsum 1 ­¦¨á š ˜ backout (˜­˜å¨œ©ž §˜¢˜ é¤ « £é¤) ¡˜ 
53765>>>>>>>      //                              1 ­¦¨á š ˜ update  (§¨æ©Ÿœ©ž ¤âà¤ « £é¤)
53765>>>>>>>      //œ¢âš®¦¤«˜  æ¢œª ¦  §˜¨á£œ«¨¦  before+after œá¤ œå¤˜  å©œª,
53765>>>>>>>      //¦§æ«œ ›â¤ œ¤ž£œ¨é¤à    ‰ € ‡ Ž Š Ž “    «¦ bsum (§® ¡á¤à £æ¤¦¤ ˜¢¢˜šã ˜ « ¦¢¦šå˜ª)
53765>>>>>>>      Procedure private.Trexe Returns Integer
53766>>>>>>>                Integer liBackout liUpdate
53767>>>>>>>
53767>>>>>>>                String  lsB_Barticl_Recr lsB_Baxiokat_Recr
53767>>>>>>>                Number  lnB_Baxio_V2
53767>>>>>>>                Number  lnB_Baxio_V0
53767>>>>>>>                Number  lnB_Baxio_V00
53767>>>>>>>                Number  lnB_Baxio_VR
53767>>>>>>>
53767>>>>>>>                String  lsA_Barticl_Recr lsA_Baxiokat_Recr
53767>>>>>>>                Number  lnA_Baxio_V2
53767>>>>>>>                Number  lnA_Baxio_V0
53767>>>>>>>                Number  lnA_Baxio_V00
53767>>>>>>>                Number  lnA_Baxio_VR
53767>>>>>>>
53767>>>>>>>                //˜¤áš¤à©ž ¡˜«á©«˜©žª «¦¬ ddo
53767>>>>>>>                Get piBackout to liBackout
53768>>>>>>>                Get piUpdate  to liUpdate
53769>>>>>>>
53769>>>>>>>                //š ˜ ¢æš¦¬ª ˜©­˜¢œå˜ª, â¢œš®¦ª backout & update
53769>>>>>>>                If (;                     (liBAckout = 0) and;                     (liUpdate  = 0);                   ) Begin
53771>>>>>>>                      Send Operation_Not_Allowed 6002 //"ƒâ¤ â«¨œ¥œ ¦ç«œ update ¦ç«œ backout !"
53772>>>>>>>                      //Procedure_Return    //› ˜¡¦§ã «¦¬ transaction! (£á¢¢¦¤ «œ¢œåàª ˜§åŸ˜¤¦, but who knows!
53772>>>>>>>                     End
53772>>>>>>>>
53772>>>>>>>
53772>>>>>>>                //˜¤áš¤à©ž §˜¢˜ é¤ « £é¤
53772>>>>>>>                Get psB_Barticl_Recr  to lsB_Barticl_Recr
53773>>>>>>>                Get psB_Baxiokat_Recr to lsB_Baxiokat_Recr
53774>>>>>>>                Get pnB_Baxio_V2      to lnB_Baxio_V2
53775>>>>>>>                Get pnB_Baxio_V0      to lnB_Baxio_V0
53776>>>>>>>                Get pnB_Baxio_V00     to lnB_Baxio_V00
53777>>>>>>>                Get pnB_Baxio_VR      to lnB_Baxio_VR
53778>>>>>>>
53778>>>>>>>                //˜¤áš¤à©ž ¤âà¤ « £é¤
53778>>>>>>>                Get psA_Barticl_Recr  to lsA_Barticl_Recr
53779>>>>>>>                Get psA_Baxiokat_Recr to lsA_Baxiokat_Recr
53780>>>>>>>                Get pnA_Baxio_V2      to lnA_Baxio_V2
53781>>>>>>>                Get pnA_Baxio_V0      to lnA_Baxio_V0
53782>>>>>>>                Get pnA_Baxio_V00     to lnA_Baxio_V00
53783>>>>>>>                Get pnA_Baxio_VR      to lnA_Baxio_VR
53784>>>>>>>
53784>>>>>>>                //œá¤ æ¢œª ¦  §˜¨á£œ«¨¦  before+after œå¤˜  å©œª,
53784>>>>>>>                //«æ«œ ›â¤ £§˜å¤à ¡˜Ÿæ¢¦¬ ©«ž¤ œ¤ž£â¨à©ž  ©¦¬šåà¤,
53784>>>>>>>                //˜¢¢á ­œçšà ...«¨â®¦¤«˜ª!
53784>>>>>>>                //sosos £ã§àª §¨â§œ  ¤˜ œ¢œš¥à gtypkin + gplan slave master ?
53784>>>>>>>                If (;                     (lsB_Barticl_Recr  =lsA_Barticl_Recr ) and;                     (lsB_Baxiokat_Recr =lsA_Baxiokat_Recr) and;                     (lnB_Baxio_V2      =lnA_Baxio_V2)      and;                     (lnB_Baxio_V0      =lnA_Baxio_V0)      and;                     (lnB_Baxio_V00     =lnA_Baxio_V00)     and;                     (lnB_Baxio_VR      =lnA_Baxio_VR)         ;                    ) Begin
53786>>>>>>>                       Procedure_Return
53787>>>>>>>                      End
53787>>>>>>>>
53787>>>>>>>
53787>>>>>>>                //˜­˜å¨œ©ž §˜¢˜ é¤ « £é¤
53787>>>>>>>                If (liBackout = 1);                Begin
53789>>>>>>>                     Send private.Update_Bsum lsB_Barticl_Recr;                                              lsB_Baxiokat_Recr;                                              lnB_Baxio_V2;                                              lnB_Baxio_V0;                                              lnB_Baxio_V00;                                              lnB_Baxio_VR;                                              (-1)
53790>>>>>>>                End //if (libackout = 1)
53790>>>>>>>>
53790>>>>>>>
53790>>>>>>>                //§¨æ©Ÿœ©ž ¤âà¤ « £é¤
53790>>>>>>>                If (liUpdate = 1);                Begin
53792>>>>>>>                     Send private.Update_Bsum lsA_Barticl_Recr;                                              lsA_Baxiokat_Recr;                                              lnA_Baxio_V2;                                              lnA_Baxio_V0;                                              lnA_Baxio_V00;                                              lnA_Baxio_VR;                                              1
53793>>>>>>>                End //if (liupdate = 1)
53793>>>>>>>>
53793>>>>>>>      End_Procedure //private.trexe
53794>>>>>>>
53794>>>>>>>
53794>>>>>>>      //¡˜¢œå«˜  ˜§æ «ž¤ prepare_to_update_bsum
53794>>>>>>>      //¡˜Ÿ¦¨åœ  «¦ slave operation
53794>>>>>>>      Procedure private.Update_Bsum String lsBarticl_Recr;                                    String lsBaxiokat_Recr;                                    Number  lnV2;                                    Number  lnV0;                                    Number  lnV00;                                    Number  lnVR;                                    Integer liSign
53795>>>>>>>
53795>>>>>>>                Integer liSlave_Gmove_Create //¡˜Ÿ˜¨á š ˜ ¢æš¦¬ª compilation
53796>>>>>>>
53796>>>>>>>                //š ˜ ¢æš¦¬ª ˜©­˜¢œå˜ª, £ã¤ «¬®æ¤ ¥œ§œ¨á©à «¦¬ª 255 ®˜¨˜¡«ã¨œª
53796>>>>>>>                If (Num_Arguments <> 7 ) Error 10001 "Wrong Num Arguments!\n\nPlease Call Solution!"
53799>>>>>>>
53799>>>>>>>                //**************************************************************************
53799>>>>>>>                //01.¬§¦¢¦š ©£æª & â¢œš®¦ª §¨¦©ã£¦¬ (+ ã -)
53799>>>>>>>                //**************************************************************************
53799>>>>>>>                If (;                     ((Abs(liSign)) <> 1 );                   ) Begin
53801>>>>>>>                      Send Operation_Not_Allowed 6001 //˜¡˜«á¢¢ž¢¦ §¨æ©ž£¦ (¢áŸ¦ª ¡é› ¡˜ª)
53802>>>>>>>                                                      //› ˜¡¦§ã «¦¬ transaction!
53802>>>>>>>                     End
53802>>>>>>>>
53802>>>>>>>                Move (lnV2  * liSign) to lnV2
53803>>>>>>>                Move (lnV0  * liSign) to lnV0
53804>>>>>>>                Move (lnV00 * liSign) to lnV00
53805>>>>>>>                Move (lnVR  * liSign) to lnVR
53806>>>>>>>
53806>>>>>>>                //**************************************************************************
53806>>>>>>>                //02.œ¤ž£â¨à©ž bsum
53806>>>>>>>                //**************************************************************************
53806>>>>>>>
53806>>>>>>>                //02.1:œç¨œ©ž/›ž£ ¦¬¨šå˜ & œ¤ž£â¨à©ž bsum
53806>>>>>>>                Clear Bsum
53807>>>>>>>                Move lsBarticl_Recr  to Bsum.Barticl_Recr
53808>>>>>>>                Move lsBaxiokat_Recr to Bsum.Baxiokat_Recr
53809>>>>>>>                Find Eq Bsum by Index.1 //barticl_recr+baxiokat_recr !!!!!!
53810>>>>>>>>
53810>>>>>>>                If (Found=0);                Begin //˜¨®ã ›ž£ ¦¬¨šå˜s ¤â¦¬ record bsum
53812>>>>>>>
53812>>>>>>>                      // jsjsjs 27/01/2001
53812>>>>>>>                      Add 1 to SysrecB.Bsum_Rec0
53813>>>>>>>                      Saverecord SysrecB
53814>>>>>>>                      Move SysrecB.Bsum_Rec0  to Bsum.Bsum_Rec0
53815>>>>>>>                      Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                        (Trim(String(Bsum.Bsum_Rec0)))))) to Bsum.Bsum_Recr
53816>>>>>>>
53816>>>>>>>                      //Add 1 to SysrecB.Bsum_Rec0
53816>>>>>>>                      //Saverecord SysrecB
53816>>>>>>>                      //§¨¦©¦®ã ! ›â¤ â®à rec mhdenia  ! ! !
53816>>>>>>>                      //Move SysrecB.Bsum_Rec0       to Bsum.Bsum_Rec0
53816>>>>>>>                      //œ¤ž£â¨à©ž £ã related §œ›åà¤
53816>>>>>>>                      //§¨¦©¦®ã ! ›â¤ â®à £ã related §œ›å˜ ! ! !
53816>>>>>>>                      Set piSlave_Gmove_Create to 1  //›ž£ ¦¬¨šå˜ ¤â¦¬ gmove slave record
53817>>>>>>>                      Move 1 to liSlave_Gmove_Create //¡˜Ÿ˜¨á š ˜ ¢æš¦¬ª compilation
53818>>>>>>>                End //«â¢¦ª ›ž£ ¦¬¨šå˜s ¤â¦¬ record bsum
53818>>>>>>>>
53818>>>>>>>
53818>>>>>>>                //02.2:œ¤ž£â¨à©ž bsum (update+backout)
53818>>>>>>>
53818>>>>>>>                //02.3:©é© £¦ ã › ˜š¨˜­ã «¦¬ bsum
53818>>>>>>>
53818>>>>>>>                If (;                     (Bsum.Bsum_SV2 + lnV2  = 0) and;                     ((piUpdate(Self))      = 0);                   );                Begin
53820>>>>>>>                     Delete Bsum
53821>>>>>>>                     Set piSlave_Gmove_Delete  to 1 //› ˜š¨˜­ã gmove slave record
53822>>>>>>>                End
53822>>>>>>>>
53822>>>>>>>                Else;                Begin
53823>>>>>>>                     Add lnV2  to Bsum.Bsum_SV2
53824>>>>>>>                     Add lnV0  to Bsum.Bsum_SV0
53825>>>>>>>                     Add lnV00 to Bsum.Bsum_SV00
53826>>>>>>>                     Add lnVR  to Bsum.Bsum_SVR
53827>>>>>>>                     Saverecord Bsum
53828>>>>>>>                     Set piSlave_Gmove_Edit    to (Not(liSlave_Gmove_Create)) //edit gmove slave record
53829>>>>>>>                End
53829>>>>>>>>
53829>>>>>>>
53829>>>>>>>      End_Procedure //private.update_bsum
53830>>>>>>>      //****************************************************************************************
53830>>>>>>>      //**************P R O C E D U R A L    „ Œ † ‹„  — ‘ †    B S U M************************
53830>>>>>>>      //****************************************************************************************
53830>>>>>>>
53830>>>>>>>
53830>>>>>>>      //private
53830>>>>>>>      //¡˜¢œå«˜  ˜§æ request save & delete, ˜¡¨ ™éª §¨å¤ ¡˜  £œ«á «¦ forward send
53830>>>>>>>      Procedure private.Initialize_Properties
53831>>>>>>>                Integer liBarticl_dd liBaxio_dd
53832>>>>>>>
53832>>>>>>>                //barticl related properties
53832>>>>>>>                Get piBarticl_dd to liBarticl_dd
53833>>>>>>>                If (liBarticl_dd <> 0);                Begin //œá¤ æ¤«àª ™¨å©¡à ¡á§¦ ¦ barticl_server_ddo
53835>>>>>>>                     Set piCreated_Barticl of liBarticl_dd to 0
53836>>>>>>>                End
53836>>>>>>>>
53836>>>>>>>                Else Error 10000 "Bmove does not have a Barticl Server ! ! !"
53838>>>>>>>
53838>>>>>>>                //baxio   related properties
53838>>>>>>>                Get piBaxio_dd to liBaxio_dd
53839>>>>>>>                If (liBaxio_dd <> 0);                Begin //œá¤ æ¤«àª ™¨å©¡à ¡á§¦ ¦ baxio_server_ddo
53841>>>>>>>                     Set piCreated_Baxio   of liBaxio_dd to 0
53842>>>>>>>                     Set pnB_Baxio_V2      of liBaxio_dd to 0
53843>>>>>>>                     Set pnB_Baxio_V0      of liBaxio_dd to 0
53844>>>>>>>                     Set pnB_Baxio_V00     of liBaxio_dd to 0
53845>>>>>>>                     Set pnB_Baxio_Vr      of liBaxio_dd to 0
53846>>>>>>>                     Set psB_Baxio_C_Code2 of liBaxio_dd to ""
53847>>>>>>>                     Set piB_Baxio_Status  of liBaxio_dd to 0
53848>>>>>>>                     Set piB_Baxiokat_Code of liBaxio_dd to 0
53849>>>>>>>                     Set piB_Year_Year     of liBaxio_dd to 0
53850>>>>>>>                     Set piBtypkin_Flag03  of liBaxio_dd to 0
53851>>>>>>>                     Set piBtypkin_Flag04  of liBaxio_dd to 0
53852>>>>>>>                End
53852>>>>>>>>
53852>>>>>>>                Else Error 10000 "Bmove does not have a Baxio Server ! ! !"
53854>>>>>>>
53854>>>>>>>                Set piCreated_Bmove  to 0 //©œ«á¨œ«˜  ©«ž¤ creating,
53855>>>>>>>
53855>>>>>>>                //£ž›œ¤ ©£æª 19 §˜¢˜ é¤ « £é¤
53855>>>>>>>                Set piB_Garticl_Rec0         to 0
53856>>>>>>>                Set piB_Gtypkin_Rec0         to 0
53857>>>>>>>                Set pdB_Garticl_Hmnia        to 0
53858>>>>>>>                Set piB_Garticl_No           to 0
53859>>>>>>>                Set psB_Garticl_C_Code2      to 0
53860>>>>>>>                Set pnB_Garticl_Rate0        to 0
53861>>>>>>>                Set pnB_Garticl_Rate00       to 0
53862>>>>>>>                Set pnB_Garticl_RateR        to 0
53863>>>>>>>                Set psB_Garticl_Aitiol       to 0
53864>>>>>>>
53864>>>>>>>                Set piB_Gmove_Master_Rec0    to 0
53865>>>>>>>                Set piB_Gplan_Master_Rec0    to 0
53866>>>>>>>                Set pnB_Gmove_Master_X2      to 0
53867>>>>>>>                Set pnB_Gmove_Master_P2      to 0
53868>>>>>>>                Set psB_Gmove_Master_Aitiol  to 0
53869>>>>>>>
53869>>>>>>>                Set piB_Gmove_Slave_Rec0     to 0
53870>>>>>>>                Set piB_Gplan_Slave_Rec0     to 0
53871>>>>>>>                Set pnB_Gmove_Slave_X2       to 0
53872>>>>>>>                Set pnB_Gmove_Slave_P2       to 0
53873>>>>>>>                Set psB_Gmove_Slave_Aitiol   to 0
53874>>>>>>>
53874>>>>>>>                //£ž›œ¤ ©£æª 19 ¤âà¤ « £é¤
53874>>>>>>>                Set piA_Garticl_Rec0         to 0
53875>>>>>>>                Set piA_Gtypkin_Rec0         to 0
53876>>>>>>>                Set pdA_Garticl_Hmnia        to 0
53877>>>>>>>                Set piA_Garticl_No           to 0
53878>>>>>>>                Set psA_Garticl_C_Code2      to 0
53879>>>>>>>                Set pnA_Garticl_Rate0        to 0
53880>>>>>>>                Set pnA_Garticl_Rate00       to 0
53881>>>>>>>                Set pnA_Garticl_RateR        to 0
53882>>>>>>>                Set psA_Garticl_Aitiol       to 0
53883>>>>>>>
53883>>>>>>>                Set piA_Gmove_Master_Rec0    to 0
53884>>>>>>>                Set piA_Gplan_Master_Rec0    to 0
53885>>>>>>>                Set pnA_Gmove_Master_X2      to 0
53886>>>>>>>                Set pnA_Gmove_Master_P2      to 0
53887>>>>>>>                Set psA_Gmove_Master_Aitiol  to 0
53888>>>>>>>
53888>>>>>>>                Set piA_Gmove_Slave_Rec0     to 0
53889>>>>>>>                Set piA_Gplan_Slave_Rec0     to 0
53890>>>>>>>                Set pnA_Gmove_Slave_X2       to 0
53891>>>>>>>                Set pnA_Gmove_Slave_P2       to 0
53892>>>>>>>                Set psA_Gmove_Slave_Aitiol   to 0
53893>>>>>>>
53893>>>>>>>                Set piBaxio_Status_From      to 0
53894>>>>>>>                Set piBaxio_Status_To        to 0
53895>>>>>>>
53895>>>>>>>                //3 properties š ˜ «ž¤ feedback œ¤ž£â¨à©ž ˜§¦ «ž¤ š¢
53895>>>>>>>                Set piF_Garticl_Rec0         to 0
53896>>>>>>>                Set piF_Gmove_Master_Rec0    to 0
53897>>>>>>>                Set piF_Gmove_Slave_Rec0     to 0
53898>>>>>>>
53898>>>>>>>                Set piUpdate                 to 0
53899>>>>>>>                Set piBackout                to 0
53900>>>>>>>
53900>>>>>>>                //properties š ˜ «ž¤ procedural œ¤ž£â¨à©ž «¦¬ bsum
53900>>>>>>>                Set psB_Barticl_Recr         to ''
53901>>>>>>>                Set psB_Baxiokat_Recr        to ''
53902>>>>>>>                Set pnB_Baxio_V2             to 0
53903>>>>>>>                Set pnB_Baxio_V0             to 0
53904>>>>>>>                Set pnB_Baxio_V00            to 0
53905>>>>>>>                Set pnB_Baxio_VR             to 0
53906>>>>>>>
53906>>>>>>>                Set psA_Barticl_Recr         to ''
53907>>>>>>>                Set psA_Baxiokat_Recr        to ''
53908>>>>>>>                Set pnA_Baxio_V2             to 0
53909>>>>>>>                Set pnA_Baxio_V0             to 0
53910>>>>>>>                Set pnA_Baxio_V00            to 0
53911>>>>>>>                Set pnA_Baxio_VR             to 0
53912>>>>>>>
53912>>>>>>>                //booleans §¦¬ ›ž¢é¤¦¬¤ «˜ operations §¦¬ Ÿ˜ šå¤œ  ©«¦¤ š¢
53912>>>>>>>                Set  piGarticl_Delete         to  0
53913>>>>>>>                Set  piGarticl_Edit           to  0
53914>>>>>>>                Set  piGarticl_Create         to  0
53915>>>>>>>
53915>>>>>>>                Set  piMaster_Gmove_Delete    to  0
53916>>>>>>>                Set  piMaster_Gmove_Edit      to  0
53917>>>>>>>                Set  piMaster_Gmove_Create    to  0
53918>>>>>>>
53918>>>>>>>                Set  piSlave_Gmove_Delete     to  0
53919>>>>>>>                Set  piSlave_Gmove_Edit       to  0
53920>>>>>>>                Set  piSlave_Gmove_Create     to  0
53921>>>>>>>      End_Procedure //private.Initialize_Properties
53922>>>>>>>
53922>>>>>>>
53922>>>>>>>      //private
53922>>>>>>>      //¡˜¢œå«˜  ˜§¦ «ž¤ update
53922>>>>>>>      Procedure private.Creating_Barticl
53923>>>>>>>      End_Procedure //private.creating_barticl
53924>>>>>>>
53924>>>>>>>
53924>>>>>>>      //private
53924>>>>>>>      //¡˜¢œå«˜  ˜§¦ «ž¤ update, ˜­¦ç â®œ  ™¨œå kinkat record
53924>>>>>>>      Procedure private.Creating_Baxio
53925>>>>>>>                Integer liCan_Create_Baxio //¡˜Ÿ˜¨á š ˜ ¢æš¦¬ª compilation only
53926>>>>>>>
53926>>>>>>>                //¡˜«'˜¨®áª ¤â˜ axio records ›ž£ ¦¬¨š¦ç¤«˜  £æ¤¦¤ æ«˜¤ :
53926>>>>>>>                //˜) œå¤˜  œ ©§¨˜¡«â˜ + «¦ bkinkat œ§ «¨â§œ  ›ž£ ¦¬¨šå˜, ã
53926>>>>>>>                //™) œå¤˜  §¢ž¨à«â˜   + «¦ bkinkat œ§ «¨â§œ  ›ž£ ¦¬¨šå˜.
53926>>>>>>>                //æ«˜¤ ›ž£ ¦¬¨š¦ç£œ ¤â˜ axio records, «æ«œ:
53926>>>>>>>                //˜)œ¤ž£â¨à©ž §œ›åà¤ first in, £æ¤¦ š ˜ œ ©§¨˜¡«â˜
53926>>>>>>>                //™)œ¤ž£â¨à©ž §œ›åà¤ first out, £æ¤¦ š ˜ §¢ž¨à«â˜
53926>>>>>>>                //š) §œ›å˜ status + place (˜¬«á «œ¢ ¡á «˜ œ¤ž£œ¨é¤à ©«ž¤ update)
53926>>>>>>>                Case Begin
53926>>>>>>>                     //›ž£ ¦¬¨šå˜ ˜¥ ¦š¨á­¦¬ œ ©§¨˜¡«â¦¬, œ¡¡¨œ£âª ©«¦ ®˜¨«¦­¬¢á¡ ¦
53926>>>>>>>                     Case ((Baxiokat.Baxiokat_Type = 1) and (Bkinkat.Bkinkat_Yn_New = 1))
53928>>>>>>>                          Move Btypkin.Btypkin_Anti1   to Baxio.Baxio_File_In
53929>>>>>>>                          Move Barticl.Barticl_Code1   to Baxio.Baxio_Code_In
53930>>>>>>>                          Move Barticl.Barticl_Epon1   to Baxio.Baxio_Epon_In
53931>>>>>>>                          Move Barticl.Barticl_Recr    to Baxio.Baxio_Fpar_In
53932>>>>>>>
53932>>>>>>>                          Move (-1)                    to Baxio.Baxio_File_Out //›â¤ ¬§á¨®œ 
53933>>>>>>>                          Move ""                      to Baxio.Baxio_Code_Out
53934>>>>>>>                          Move ""                      to Baxio.Baxio_Epon_Out
53935>>>>>>>                          Move 0                       to Baxio.Baxio_Fpar_Out
53936>>>>>>>                     Case Break
53937>>>>>>>
53937>>>>>>>                     //›ž£ ¦¬¨šå˜ ˜¥ ¦š¨á­¦¬ §¢ž¨à«â¦¬, œ¡¡¨œ£âª ©«¦ bkinkat_plac_to
53937>>>>>>>                     Case ((Baxiokat.Baxiokat_Type = 2) and (Bkinkat.Bkinkat_Yn_New = 1))
53940>>>>>>>                          Move (-1)                    to Baxio.Baxio_File_In  //›â¤ ¬§á¨®œ 
53941>>>>>>>                          Move ""                      to Baxio.Baxio_Code_In
53942>>>>>>>                          Move ""                      to Baxio.Baxio_Epon_In
53943>>>>>>>                          Move 0                       to Baxio.Baxio_Fpar_In
53944>>>>>>>
53944>>>>>>>                          Move Btypkin.Btypkin_Anti1   to Baxio.Baxio_File_Out
53945>>>>>>>                          Move Barticl.Barticl_Code1   to Baxio.Baxio_Code_Out
53946>>>>>>>                          Move Barticl.Barticl_Epon1   to Baxio.Baxio_Epon_Out
53947>>>>>>>                          Move Barticl.Barticl_Recr    to Baxio.Baxio_Fpar_Out
53948>>>>>>>                     Case Break
53949>>>>>>>
53949>>>>>>>                     Case Else //§¨¦­˜¤éª ¡á«  ›â¤ §áœ  ¡˜¢á
53949>>>>>>>                          Send Operation_Not_Allowed 3001 //›â¤ œ§ «¨â§œ«˜  ž ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬
53950>>>>>>>                Case End
53950>>>>>>>
53950>>>>>>>                If (Trim(Baxio.Baxio_C_Code2)='') Move (Trim(SysCurXr.C_Code0)) to Baxio.Baxio_C_Code2
53953>>>>>>>
53953>>>>>>>                //›œç«œ¨¦ª â¢œš®¦ª ›ž£ ¦¬¨šå˜ª ¤â¦¬ ˜¥ ¦š¨á­¦¬ ˜§æ «¦ bkinkay_yn_create !
53953>>>>>>>                Get piCan_Create_Baxio to liCan_Create_Baxio //¡˜Ÿ˜¨á š ˜ ¢æš¦¬ª compilation only
53954>>>>>>>                If (liCan_Create_Baxio = FALSE) Send Operation_Not_Allowed 3001 //›â¤ œ§ «¨â§œ«˜  ž ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬
53957>>>>>>>      End_Procedure //private.creating_baxio
53958>>>>>>>
53958>>>>>>>
53958>>>>>>>//      //private
53958>>>>>>>//      //™¨å©¡œ  ˜§æ «¦ bsum «¦ gmove slave rec0
53958>>>>>>>//      //¡˜¢œå«˜  ˜§æ update+backout ?
53958>>>>>>>//      Function private.fiBsum_Gmove_Srec0 String lsBarticl_Recr ;
53958>>>>>>>//                                          String lsBaxiokat_Recr;
53958>>>>>>>//                                          Returns Integer
53958>>>>>>>//               Clear Bsum
53958>>>>>>>//               Move lsBarticl_Recr  to Bsum.Barticl_Recr
53958>>>>>>>//               Move lsBaxiokat_Recr to Bsum.Baxiokat_Recr
53958>>>>>>>//               Find Eq Bsum by Index.1 //barticl_recr+baxiokat_recr
53958>>>>>>>//               Function_Return Bsum.Gmove_Srec0
53958>>>>>>>//      End_Function //private.fibsum_gmove_srec0
53958>>>>>>>
53958>>>>>>>
53958>>>>>>>      //private
53958>>>>>>>      //™¨å©¡œ  œá¤ ž ©¬š¡œ¡¨ £â¤ž btypkin ¡ ¤œå «¦ libaxiokat_code
53958>>>>>>>      //¡˜¢œå«˜  ˜§æ update+validate_save
53958>>>>>>>      Function private.fiBkinkat_Baxiokat_Code String lsBtypkin_Recr;                                               Integer liBaxiokat_Code;                                               Returns Integer
53959>>>>>>>               Clear Bkinkat
53960>>>>>>>               Move SysCurXr.Company_Code   to Bkinkat.Company_Code
53961>>>>>>>               Move SysCurXr.Branch_Code    to Bkinkat.Branch_Code
53962>>>>>>>               Move SysCurXr.Year_Year      to Bkinkat.Year_year
53963>>>>>>>               Move lsBtypkin_Recr          to Bkinkat.Btypkin_Recr
53964>>>>>>>               Move liBaxiokat_Code         to Bkinkat.Baxiokat_Code
53965>>>>>>>               Find Eq Bkinkat by Index.3 //Company+Branch+Year+btypkin_recr+baxiokat_code
53966>>>>>>>>
53966>>>>>>>               If (Found = 0) Begin
53968>>>>>>>                               Set piBaxio_Status_From to (-1)
53969>>>>>>>                               Set piBaxio_Status_To   to (-1)
53970>>>>>>>                               Function_Return 0
53971>>>>>>>                              End
53971>>>>>>>>
53971>>>>>>>               Set piBaxio_Status_From to Bkinkat.Baxio_Stat_From
53972>>>>>>>               Set piBaxio_Status_To   to Bkinkat.Baxio_Stat_To
53973>>>>>>>
53973>>>>>>>
53973>>>>>>>               Function_Return Bkinkat.Baxiokat_Code
53974>>>>>>>      End_Function //private.fibkinkat_baxiokat_code
53975>>>>>>>
53975>>>>>>>
53975>>>>>>>      //¡˜¢œå«˜  ˜§æ update & backout
53975>>>>>>>      //¡˜  œ¤ž£œ¨é¤œ  « ª ©¬¤¦¢ ¡âª ˜¥åœª «¦¬ barticl
53975>>>>>>>      Procedure private.Adjust_Balances Integer liSign;                                        Number  lnBaxio_V2;                                        Number  lnBaxio_V0;                                        Number  lnBaxio_V00;                                        Number  lnBaxio_VR
53976>>>>>>>                If (;                     ((Abs(liSign)) <> 1 );                   ) Begin
53978>>>>>>>                      Error 10000 "€¡˜«á¢¢ž¢¦ §¨æ©ž£¦, ¢áŸ¦ª ¡é› ¡˜" //› ˜¡¦§ã «¦¬ transaction!
53979>>>>>>>>
53979>>>>>>>                      Procedure_Return
53980>>>>>>>                     End
53980>>>>>>>>
53980>>>>>>>
53980>>>>>>>                 //¤æ£ ©£˜ œšš¨˜­ãª
53980>>>>>>>                Add (lnBaxio_V2  * liSign) to Barticl.Barticl_SV2
53981>>>>>>>
53981>>>>>>>                //¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©žª
53981>>>>>>>                Add (lnBaxio_V0  * liSign) to Barticl.Barticl_SV0
53982>>>>>>>
53982>>>>>>>                //›œ¬«œ¨œç¦¤ ¤æ£ ©£˜ ®¨ã©žª
53982>>>>>>>                Add (lnBaxio_V00 * liSign) to Barticl.Barticl_SV00
53983>>>>>>>
53983>>>>>>>                //¤æ£ ©£˜ reporting
53983>>>>>>>                Add (lnBaxio_VR  * liSign) to Barticl.Barticl_SVR
53984>>>>>>>      End_Procedure //private.adjust_balances
53985>>>>>>>
53985>>>>>>>
53985>>>>>>>
53985>>>>>>>
53985>>>>>>>      //æ¢˜ «˜ ddo ˜¬«ãª «ãª ¡¢á©žª, œ¤ž£œ¨é¤¦¬¤ «˜ 4 parents ¡˜  «¦¤ œ¬˜«æ «¦¬ª
53985>>>>>>>      //£œ æ¢˜ «˜ ddo id's
53985>>>>>>>      //œ§å©žª §¨â§œ  ¤˜ ¬§á¨®¦¬¤ ¡˜  ¦  3 bpo's š ˜ «ž¤ œ¤ž£â¨à©ž «à¤ ¢¦ §é¤ modules
53985>>>>>>>      Procedure End_Construct_Object
53986>>>>>>>                Integer liBtypkin_dd liBarticl_dd liBaxio_dd liBaxiokat_dd
53987>>>>>>>
53987>>>>>>>                Forward Send End_Construct_Object
53989>>>>>>>
53989>>>>>>>                Move (Find_Server_DDO(Self        ,Barticl.File_Number )) to liBarticl_dd
53990>>>>>>>                Move (Find_Server_DDO(Self        ,Baxio.File_Number   )) to liBaxio_dd
53991>>>>>>>                Move (Find_Server_DDO(liBarticl_dd,Btypkin.File_Number )) to liBtypkin_dd
53992>>>>>>>                Move (Find_Server_DDO(liBaxio_dd  ,Baxiokat.File_Number)) to liBaxiokat_dd
53993>>>>>>>
53993>>>>>>>                //object id «žª business process §¦¬ œ¤ž£œ¨é¤œ  «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã
53993>>>>>>>                //jsjsjs 24/01/2001 Set piDo_GL_Maintainance       to (oDo_GL_Maintainance      (Self))
53993>>>>>>>
53993>>>>>>>                //object id «žª business process §¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §œ¢á«œª
53993>>>>>>>//------------->Set piDo_CUSTOMER_Maintainance to (oDo_CUSTOMER_Maintainance(Self))
53993>>>>>>>
53993>>>>>>>                //object id «žª business process §¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §¨¦£žŸœ¬«âª
53993>>>>>>>//------------->Set piDo_VENDOR_Maintainance   to (oDo_VENDOR_Maintainance  (Self))
53993>>>>>>>
53993>>>>>>>                //â¢œš®¦  ¬§¦®¨œà« ¡ãª ç§˜¨¥žª ¡˜  «à¤ 4 ddo'w
53993>>>>>>>                If (liBarticl_dd  = 0) Error 10000 "Bmove does not have a Barticl  Server ! ! !"
53996>>>>>>>                If (liBaxio_dd    = 0) Error 10000 "Bmove does not have a Baxio    Server ! ! !"
53999>>>>>>>                If (liBtypkin_dd  = 0) Error 10000 "Bmove does not have a Btypkin  Server ! ! !"
54002>>>>>>>                If (liBaxiokat_dd = 0) Error 10000 "Bmove does not have a Baxiokat Server ! ! !"
54005>>>>>>>
54005>>>>>>>                //properties › ¡á «¦¬
54005>>>>>>>                //æ§¦¬ «˜ ®¨ž© £¦§¦ é, Ÿ˜ £§¦¨¦ç©˜ ¤˜ â¡˜¤˜ «ž¤ å› ˜ ›¦¬¢œ á £œ «ž¤ file_field_value ?
54005>>>>>>>                //æ®  ©« ª §œ¨ §«é©œ ª §¦¬ › ˜®œ ¨å¦£˜¦ properties !
54005>>>>>>>                Set piBarticl_dd                  to liBarticl_dd
54006>>>>>>>                Set piBaxio_dd                    to liBaxio_dd
54007>>>>>>>                Set piBtypkin_dd                  to liBtypkin_dd
54008>>>>>>>                Set piBaxiokat_dd                 to liBaxiokat_dd
54009>>>>>>>
54009>>>>>>>                //properties «¦¬ btypkin
54009>>>>>>>                Set piBarticl_dd  of liBtypkin_dd to liBarticl_dd
54010>>>>>>>                Set piBmove_dd    of liBtypkin_dd to Self
54011>>>>>>>                Set piBaxio_dd    of liBtypkin_dd to liBaxio_dd
54012>>>>>>>                Set piBaxiokat_dd of liBtypkin_dd to liBaxiokat_dd
54013>>>>>>>
54013>>>>>>>                //properties «¦¬ baxiokat
54013>>>>>>>                Set piBarticl_dd  of liBaxiokat_dd to liBarticl_dd
54014>>>>>>>                Set piBmove_dd    of liBaxiokat_dd to Self
54015>>>>>>>                Set piBaxio_dd    of liBaxiokat_dd to liBaxio_dd
54016>>>>>>>                Set piBtypkin_dd  of liBaxiokat_dd to liBtypkin_dd
54017>>>>>>>
54017>>>>>>>                //properties «¦¬ barticl
54017>>>>>>>                Set piBmove_dd    of liBarticl_dd  to Self
54018>>>>>>>                Set piBaxio_dd    of liBarticl_dd  to liBaxio_dd
54019>>>>>>>                Set piBtypkin_dd  of liBarticl_dd  to liBtypkin_dd
54020>>>>>>>                Set piBaxiokat_dd of liBarticl_dd  to liBaxiokat_dd
54021>>>>>>>
54021>>>>>>>      End_Procedure   //end_construct_object
54022>>>>>>>
54022>>>>>>>      //£á¢¢¦¤ œå¤˜  á®¨ž©«ž, › æ«  §á¤«˜ «¦ bmove_dd «¦ › ˜®œ ¨å¦£˜ 
54022>>>>>>>      //œå«˜  ©˜¤ detail «¦¬ barticl, œå«˜  ©˜¤ detail «¦¬ baxio !
54022>>>>>>>      //ã constrain Ÿ˜ £¦¬ ®¨œ ˜©Ÿœå £æ¤¦¤ œá¤ â®à main server «¦ bmove_dd ! ! !
54022>>>>>>>      Procedure Constrain
54023>>>>>>>                Forward Send Constrain
54025>>>>>>>                Constrain Bmove.Company_Code  eq SysCurXR.Company_Code
54027>>>>>>>                Constrain Bmove.Branch_Code   eq SysCurXR.Branch_Code
54029>>>>>>>                Constrain Bmove.Year_Year     eq SysCurXR.Year_Year
54031>>>>>>>      End_Procedure   //constrain
54032>>>>>>>
54032>>>>>>>
54032>>>>>>>      //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
54032>>>>>>>      //™) ˜¤áš¤à©ž properties
54032>>>>>>>      //š) › ˜®œå¨ ©ž calculated §œ›åà¤
54032>>>>>>>      //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
54032>>>>>>>      //œ) œ¤ž£â¨à©ž properties after
54032>>>>>>>      Procedure Update
54033>>>>>>>                Integer liTemp
54034>>>>>>>                Integer liBarticl_dd      liBaxio_dd
54034>>>>>>>                Integer liCreated_Barticl liCreated_Baxio
54034>>>>>>>                String  lsGplan_Slave_Code
54034>>>>>>>
54034>>>>>>>                Forward Send Update
54036>>>>>>>
54036>>>>>>>                //0)š ˜ ¢æš¦¬ª  › ˜ «œ¨æ«ž«˜ª, æ¢¦ª ¦ ¡é› ¡˜ª
54036>>>>>>>                //«é¤ creating baxio + barticl  (?) «¨â®œ  «é¨˜, ˜§¦ «ž¤ update «¦¬ bmove ! ! !
54036>>>>>>>                //§¨é«˜ œ¤«¦§åà bkikat
54036>>>>>>>                Move (private.fiBkinkat_Baxiokat_Code(Self,;                                    Btypkin.Btypkin_Recr,;                                    Baxiokat.Baxiokat_Code);                     ) to liTemp
54037>>>>>>>                If (liTemp = 0) Send Operation_Not_Allowed 3002 //›â¤ œ§ «¨â§œ«˜  ž ¡å¤ž©ž baxiokat_code £œ «¦ btypkin
54040>>>>>>>
54040>>>>>>>
54040>>>>>>>                //***********************************************************
54040>>>>>>>                //*    ˜§æ œ›é ¡˜  ¡á«à, â®à §¢â¦¤ active bkinkat record    *
54040>>>>>>>                //***********************************************************
54040>>>>>>>
54040>>>>>>>
54040>>>>>>>                //œç¨œ©ž «à¤ 2 server ddo's
54040>>>>>>>                Get piBarticl_dd to liBarticl_dd
54041>>>>>>>                Get piBaxio_dd   to liBaxio_dd
54042>>>>>>>
54042>>>>>>>                //œ¤ž£â¨à©ž «¦¬ parent barticl dd
54042>>>>>>>                If (liBarticl_dd <> 0);                Begin
54044>>>>>>>                    Get piCreated_Barticl of liBarticl_dd to liCreated_Barticl
54045>>>>>>>                    If (liCreated_Barticl = TRUE)  Send private.Creating_Barticl
54048>>>>>>>                End
54048>>>>>>>>
54048>>>>>>>                Else Error 10000 "Bmove does not have a Barticl Server ! ! !"
54050>>>>>>>
54050>>>>>>>                //œ¤ž£â¨à©ž «¦¬ parent baxio dd
54050>>>>>>>                If (liBaxio_dd   <> 0);                Begin
54052>>>>>>>                    Get piCreated_Baxio   of liBaxio_dd   to liCreated_Baxio
54053>>>>>>>                    If (liCreated_Baxio   = TRUE)  Send private.Creating_Baxio
54056>>>>>>>                    Set piBtypkin_Flag03 of liBaxio_dd to Btypkin.Btypkin_Flag03
54057>>>>>>>                    Set piBtypkin_Flag04 of liBaxio_dd to Btypkin.Btypkin_Flag04
54058>>>>>>>                End
54058>>>>>>>>
54058>>>>>>>                Else Error 10000 "Bmove does not have a Baxio Server ! ! !"
54060>>>>>>>
54060>>>>>>>// jsjsjs sos energopoihsh xenou nomismatos 29/11/2001
54060>>>>>>>//                //***************************************************************************
54060>>>>>>>//                //============================================================================
54060>>>>>>>//                //||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
54060>>>>>>>//                //£œ«˜«¨¦§ã «žª ˜¥å˜ª ˜§æ ¤æ£ ©£˜ œšš¨˜­ãª (2) ©«˜ ¢¦ §á 3 ¤¦£å©£˜«˜  (0+00+r)
54060>>>>>>>//                Move 1                  to Baxio.Baxio_Rate0 //sosososo §¨¦©à¨ ¤á, £æ¤¦¤ ˜¥ æš¨˜­˜ ©œ ›¨®
54060>>>>>>>//                Move SysCurXr.C_Code0   to Baxio.Baxio_C_Code2 //sosososo §¨¦©à¨ ¤á, £æ¤¦¤ ˜¥ æš¨˜­˜ ©œ ›¨®
54060>>>>>>>//                //***************************************************************************
54060>>>>>>>//                //============================================================================
54060>>>>>>>//                //||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
54060>>>>>>>// jsjsjs sos energopoihsh xenou nomismatos 29/11/2001
54060>>>>>>>
54060>>>>>>>                Send Convert_Axio_Values to liBaxio_dd
54061>>>>>>>
54061>>>>>>>
54061>>>>>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
54061>>>>>>>                Move SysCurXr.Company_Code  to Bmove.Company_Code
54062>>>>>>>                Move SysCurXr.Branch_Code   to Bmove.Branch_Code
54063>>>>>>>                Move SysCurXr.Year_Year     to Bmove.Year_Year
54064>>>>>>>                Move Baxio.Baxio_Code       to Bmove.Baxio_Code
54065>>>>>>>                Move Btypkin.Btypkin_Code   to Bmove.Btypkin_Code
54066>>>>>>>                Move Btypkin.Btypkin_Recr   to Bmove.Btypkin_Recr
54067>>>>>>>                Move Barticl.Barticl_Hmnia  to Bmove.Barticl_Hmnia
54068>>>>>>>                Move Barticl.Barticl_No     to Bmove.Barticl_No
54069>>>>>>>
54069>>>>>>>                Move Barticl.Sls_ID         to Bmove.Sls_ID
54070>>>>>>>                Move Barticl.Presp_ID       to Bmove.Presp_ID
54071>>>>>>>                Move Barticl.Cnt_ID         to Bmove.Cnt_ID
54072>>>>>>>
54072>>>>>>>
54072>>>>>>>                //™) ˜¤áš¤à©ž properties
54072>>>>>>>
54072>>>>>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
54072>>>>>>>
54072>>>>>>>                //š.01:œ¤ž£â¨à©ž §œ›åà¤ previous §˜¨˜¢ã§«žª «¦¬ bmove š ˜ æ¢˜ «˜ ˜¥ æš¨˜­˜
54072>>>>>>>                //     §¨¦«¦ç ˜¢¢á¥à «˜ last §œ›å˜ «¦¬ baxio, «˜ ¡¨˜«áà ©«˜
54072>>>>>>>                //     previous §œ›å˜ «¦¬ bmove,
54072>>>>>>>                //     é©«œ ©«ž¤ deleting ¤˜ «˜ œ§˜¤˜­â¨à
54072>>>>>>>                Move Baxio.Baxio_Lfile      to  Bmove.Baxio_Pfile
54073>>>>>>>                Move Baxio.Baxio_Lcode      to  Bmove.Baxio_Pcode
54074>>>>>>>                Move Baxio.Baxio_Lepon      to  Bmove.Baxio_Pepon
54075>>>>>>>                Move Baxio.Baxio_Lpar       to  Bmove.Baxio_Ppar
54076>>>>>>>
54076>>>>>>>                //š.02:œ¤ž£â¨à©ž §œ›åà¤ last («œ¢œ¬«˜å¦ª §˜¨˜¢ã§«žª) «¦¬ baxio š ˜ æ¢˜ «˜ ˜¥ æš¨˜­˜
54076>>>>>>>
54076>>>>>>>// ----------------------------------------------------------------------------
54076>>>>>>>// js 24/02/2002    Ayth h periptosh den isxyei xoris elegxo giati otan afora
54076>>>>>>>//                  plhromh dikh mas o promhtheyths mpainei sto 1o koutaki dhladh
54076>>>>>>>//                  ston ekdoth kai paramenei kenos o apodekths (Code2).
54076>>>>>>>//                  Otan loipon menei kenos o apodekths den enhmeronei Lcode
54076>>>>>>>//                  kai an den enhmerosei Lcode tote apo to Baxio_DD katharizontai
54076>>>>>>>//                  ola ta _Out pedia
54076>>>>>>>
54076>>>>>>>//                Move Btypkin.Btypkin_Anti2  to Baxio.Baxio_Lfile
54076>>>>>>>//                Move Barticl.Barticl_Code2  to Baxio.Baxio_Lcode
54076>>>>>>>//                Move Barticl.Barticl_Epon2  to Baxio.Baxio_Lepon
54076>>>>>>>//                Move Barticl.Barticl_Recr   to Baxio.Baxio_Lpar
54076>>>>>>>
54076>>>>>>>                If (Baxiokat.Baxiokat_Type = 2) Begin
54078>>>>>>>                    If (Trim(Barticl.Barticl_Code2)<>'') Begin
54080>>>>>>>                        Move Btypkin.Btypkin_Anti2  to Baxio.Baxio_Lfile
54081>>>>>>>                        Move Barticl.Barticl_Code2  to Baxio.Baxio_Lcode
54082>>>>>>>                        Move Barticl.Barticl_Epon2  to Baxio.Baxio_Lepon
54083>>>>>>>                        Move Barticl.Barticl_Recr   to Baxio.Baxio_Lpar
54084>>>>>>>                    End
54084>>>>>>>>
54084>>>>>>>                    Else Begin
54085>>>>>>>                        Move Btypkin.Btypkin_Anti1  to Baxio.Baxio_Lfile
54086>>>>>>>                        Move Barticl.Barticl_Code1  to Baxio.Baxio_Lcode
54087>>>>>>>                        Move Barticl.Barticl_Epon1  to Baxio.Baxio_Lepon
54088>>>>>>>                        Move Barticl.Barticl_Recr   to Baxio.Baxio_Lpar
54089>>>>>>>                    End
54089>>>>>>>>
54089>>>>>>>                End
54089>>>>>>>>
54089>>>>>>>                Else If (Baxiokat.Baxiokat_Type = 1) Begin
54092>>>>>>>                    // js 24/02/2002 PARATHRHSEIS
54092>>>>>>>                    // Edo den kanoume elegxo giati an einai eisprakteo (xoris metavivash)
54092>>>>>>>                    // tote epeidh den anoigei to Code2 ex orismou tha einai kena
54092>>>>>>>                    // An tora einai eispraktea pros metavivash tote ex orismou
54092>>>>>>>                    // to Code2 exei timh apo thn othonh opote kai tha enhmerosei
54092>>>>>>>                    // me Lcode h update tou Baxio_DD
54092>>>>>>>                    // to kolpo edo einai oti apitoume apo ton xrhsth sthn periptosh
54092>>>>>>>                    // metavivashs na plhktrologhsei ston ekdoth KAI ston apodekth
54092>>>>>>>                    // ton idio kodiko tou promhtheyth ston opoio metavivazei thn epitagh
54092>>>>>>>
54092>>>>>>>                    // Ayto prepei sto epomeno version na allaxei opos epishs kai to gegonos
54092>>>>>>>                    // oti menei panta keno to pedio tou paralhpth stis eispraktees apo pelath
54092>>>>>>>                    // eno theoro oti tha prepe na mpainei h 'etairia' opos epishs kai
54092>>>>>>>                    // stis epitages plhrotees dikes mas menei keno o ekdoths pou pali
54092>>>>>>>                    // tha'prepe na'maste 'emeis' (Mia kartella dhladh opou h 'etairia mas'
54092>>>>>>>                    // tha emfanizetai kai pelaths kai promhtheyths.
54092>>>>>>>                    // js 24/02/2002 Parathrhseis
54092>>>>>>>                    Move Btypkin.Btypkin_Anti2  to Baxio.Baxio_Lfile
54093>>>>>>>                    Move Barticl.Barticl_Code2  to Baxio.Baxio_Lcode
54094>>>>>>>                    Move Barticl.Barticl_Epon2  to Baxio.Baxio_Lepon
54095>>>>>>>                    Move Barticl.Barticl_Recr   to Baxio.Baxio_Lpar
54096>>>>>>>                End
54096>>>>>>>>
54096>>>>>>>
54096>>>>>>>// ----------------------------------------------------------------------------
54096>>>>>>>
54096>>>>>>>                //š.03:œ¤ž£â¨à©ž §œ›åà¤ first out (§¨é«¦ª §˜¨˜¢ã§«žª) «¦¬ baxio š ˜ æ¢˜ «˜ ˜¥ æš¨˜­˜
54096>>>>>>>                //     ¡˜  œ­'æ©¦¤ ›â¤ â®¦¬¤ ã›ž œ¤ž£œ¨àŸœå,
54096>>>>>>>                //     ›ž¢˜›ã §¨æ¡œ «˜  š ˜ «ž¤ §¨é«ž £œ«˜™å™˜©ž-œ¥˜šàšã
54096>>>>>>>                If (;                     (Baxio.Baxio_Code_Out = "" );                   );                Begin
54098>>>>>>>                      Move Btypkin.Btypkin_Anti2   to Baxio.Baxio_File_Out
54099>>>>>>>                      Move Barticl.Barticl_Code2   to Baxio.Baxio_Code_Out
54100>>>>>>>                      Move Barticl.Barticl_Epon2   to Baxio.Baxio_Epon_Out
54101>>>>>>>                      Move Barticl.Barticl_Recr    to Baxio.Baxio_Fpar_Out
54102>>>>>>>                End
54102>>>>>>>>
54102>>>>>>>
54102>>>>>>>                //š.04:œ¤ž£â¨à©ž §œ›åà¤ status + place «¦¬ baxio, ˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž (bkinkat)
54102>>>>>>>                Move Bkinkat.Baxio_Stat_To  to Baxio.Baxio_Status //¡˜«á©«˜©ž :˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž
54103>>>>>>>                Move Bkinkat.Baxio_Plac_To  to Baxio.Baxio_Place  //œ¬¨å¡œ«˜ :˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž
54104>>>>>>>
54104>>>>>>>//                //š.05:©«¦ ®œå˜ slave gplan rec0
54104>>>>>>>//                Case Begin
54104>>>>>>>//                     Case (Btypkin.Gtypkin_Code <> 0) //œá¤ ž ¡å¤ž©ž œ¤ž£œ¨é¤œ  ‚Š
54104>>>>>>>////jsjsjs 24/01/2001
54104>>>>>>>////                          Clear Gplan
54104>>>>>>>////                          Move Company.Company_Code    to Gplan.Company_Code
54104>>>>>>>////                          Move Branch.Branch_Code      to Gplan.Branch_Code
54104>>>>>>>////                          Move Year.Year_Year          to Gplan.Year_Year
54104>>>>>>>////                          Move Bkinkat.Bkinkat_GplnCod to Gplan.Gplan_Code
54104>>>>>>>////                          Find Eq Gplan by Index.1 //company_code+branch_code+year_year+Gplan_code
54104>>>>>>>////                          If (Found = 1) Move Gplan.Gplan_Rec0 to Bmove.Gplan_SRec0
54104>>>>>>>////                          Else           Send Operation_Not_Allowed 3001 //›â¤ ™¨âŸž¡œ «¦ slave gplan_rec0
54104>>>>>>>////jsjsjs 24/01/2001
54104>>>>>>>//                     Case Break //æ® , › æ«  £§¦¨œå ¤˜ œ¤ž£œ¨é¤œ ¡˜  á¢¢˜ modules
54104>>>>>>>
54104>>>>>>>//                     Case (Btypkin.Ctypkin_Code <> 0) //œá¤ ž ¡å¤ž©ž œ¤ž£œ¨é¤œ  §œ¢á«œª
54104>>>>>>>//                     Case Break
54104>>>>>>>
54104>>>>>>>//                     Case (Btypkin.Vtypkin_Code <> 0) //œá¤ ž ¡å¤ž©ž œ¤ž£œ¨é¤œ  §¨¦£žŸœ¬«âª
54104>>>>>>>//                     Case Break
54104>>>>>>>
54104>>>>>>>//                     Case Else                        //›â¤ œ¤ž£œ¨é¤œ«˜  ¡˜¤â¤˜ ˜§¦ «˜ 3 modules
54104>>>>>>>//                          Move 0 to Bmove.Gplan_SRec0
54104>>>>>>>//                Case End
54104>>>>>>>
54104>>>>>>>                //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
54104>>>>>>>                Send private.Adjust_Balances (1);                                             Baxio.Baxio_V2;                                             Baxio.Baxio_V0;                                             Baxio.Baxio_V00;                                             Baxio.Baxio_VR
54105>>>>>>>
54105>>>>>>>//                //œ) œ¤ž£â¨à©ž properties after (˜§æ parent buffers!)
54105>>>>>>>//                Set piA_Garticl_Rec0         to Barticl.Garticl_Rec0
54105>>>>>>>//                Set piA_Gtypkin_Rec0         to Btypkin.Gtypkin_Rec0
54105>>>>>>>//                Set pdA_Garticl_Hmnia        to Barticl.Barticl_Hmnia
54105>>>>>>>//                Set piA_Garticl_No           to Barticl.Barticl_No
54105>>>>>>>//                Set psA_Garticl_C_Code2      to Baxio.Baxio_C_Code2
54105>>>>>>>//                Set pnA_Garticl_Rate0        to Baxio.Baxio_Rate0
54105>>>>>>>//                Set pnA_Garticl_Rate00       to Baxio.Baxio_Rate00
54105>>>>>>>//                Set pnA_Garticl_RateR        to Baxio.Baxio_RateR
54105>>>>>>>//                Set psA_Garticl_Aitiol       to Barticl.Barticl_Aitiol
54105>>>>>>>
54105>>>>>>>//                Set piA_Gmove_Master_Rec0    to Barticl.Gmove_Mrec0
54105>>>>>>>//                Set piA_Gplan_Master_Rec0    to Barticl.Gplan_Mrec0
54105>>>>>>>
54105>>>>>>>                //â¢œš®¦ª §¨¦©ã£¦¬
54105>>>>>>>                //If ((Abs(Btypkin.Btypkin_Sign)) <> 1) Error 10000 "To Btypkin Sign œå¤˜  ¢áŸ¦ª !"
54105>>>>>>>
54105>>>>>>>                Case Begin
54105>>>>>>>                     Case (Btypkin.Btypkin_Anti_Xp = 1) //®¨âà©ž master, §å©«à©ž slave
54107>>>>>>>//                          Set pnA_Gmove_Master_X2 to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
54107>>>>>>>//                          Set pnA_Gmove_Master_P2 to 0
54107>>>>>>>//                          Set pnA_Gmove_Slave_X2  to 0
54107>>>>>>>//                          Set pnA_Gmove_Slave_P2  to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
54107>>>>>>>                     Case Break
54108>>>>>>>                     Case (Btypkin.Btypkin_Anti_Xp = 2) // §å©«à©ž master, ®¨âà©ž slave
54111>>>>>>>//                          Set pnA_Gmove_Master_X2 to 0
54111>>>>>>>//                          Set pnA_Gmove_Master_P2 to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
54111>>>>>>>//                          Set pnA_Gmove_Slave_X2  to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
54111>>>>>>>//                          Set pnA_Gmove_Slave_P2  to 0
54111>>>>>>>                     Case Break
54112>>>>>>>                     Case Else
54112>>>>>>>                          Error 10000 "To Btypkin XP œå¤˜  ¢áŸ¦ª!"
54113>>>>>>>>
54113>>>>>>>                Case End
54113>>>>>>>//                Set psA_Gmove_Master_Aitiol  to Barticl.Barticl_Aitiol
54113>>>>>>>
54113>>>>>>>//                Set piA_Gmove_Slave_Rec0     to (private.fiBsum_Gmove_Srec0(Self,;
54113>>>>>>>//                                                                            Barticl.Barticl_Rec0,;
54113>>>>>>>//                                                                            Baxiokat.Baxiokat_Rec0))
54113>>>>>>>//                Set piA_Gplan_Slave_Rec0     to Bmove.Gplan_Srec0
54113>>>>>>>//                Set psA_Gmove_Slave_Aitiol   to Barticl.Barticl_Aitiol
54113>>>>>>>
54113>>>>>>>                Set piUpdate to 1
54114>>>>>>>
54114>>>>>>>                //properties š ˜ «ž¤ procedural œ¤ž£â¨à©ž «¦¬ bsum
54114>>>>>>>                Set psA_Barticl_Recr         to Barticl.Barticl_Recr
54115>>>>>>>                Set psA_Baxiokat_Recr        to Baxiokat.Baxiokat_Recr
54116>>>>>>>                Set pnA_Baxio_V2             to Baxio.Baxio_V2
54117>>>>>>>                Set pnA_Baxio_V0             to Baxio.Baxio_V0
54118>>>>>>>                Set pnA_Baxio_V00            to Baxio.Baxio_V00
54119>>>>>>>                Set pnA_Baxio_VR             to Baxio.Baxio_VR
54120>>>>>>>
54120>>>>>>>//                //booleans §¦¬ ›ž¢é¤¦¬¤ «˜ operations §¦¬ Ÿ˜ šå¤¦¬¤ ©«ã¤ š¢
54120>>>>>>>//                If (Barticl.Garticl_Rec0 = 0);
54120>>>>>>>//                Begin //«¦ barticl ›â¤ â®œ  ©¬¤›œŸœå £œ master gmove
54120>>>>>>>//                     If (Barticl.Gmove_Mrec0 <> 0) Error 10000 "Master Gmove <> 0 !"
54120>>>>>>>//                     Set  piGarticl_Create         to  1
54120>>>>>>>//                     Set  piMaster_Gmove_Create    to  1
54120>>>>>>>//                End
54120>>>>>>>//                Set piGarticl_Edit      to  (Not(piGarticl_Create     (Self)))
54120>>>>>>>//                Set piMaster_Gmove_Edit to  (Not(piMaster_Gmove_Create(Self)))
54120>>>>>>>      End_Procedure   //update
54121>>>>>>>
54121>>>>>>>
54121>>>>>>>      Procedure Backout
54122>>>>>>>                Forward Send Backout
54124>>>>>>>
54124>>>>>>>                //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
54124>>>>>>>                Send private.Adjust_Balances (-1);                                             Baxio.Baxio_V2;                                             Baxio.Baxio_V0;                                             Baxio.Baxio_V00;                                             Baxio.Baxio_VR
54125>>>>>>>
54125>>>>>>>
54125>>>>>>>
54125>>>>>>>                //******************************
54125>>>>>>>                //prosoxi ! allagi sto bmove def gia na exo kai ayta ta pedia !!!
54125>>>>>>>                //******************************
54125>>>>>>>
54125>>>>>>>//                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
54125>>>>>>>//                Set piB_Garticl_Rec0         to Barticl.Garticl_Rec0
54125>>>>>>>//                Set piB_Gtypkin_Rec0         to Btypkin.Gtypkin_Rec0
54125>>>>>>>//                Set pdB_Garticl_Hmnia        to Bmove.Barticl_Hmnia     //sosososo
54125>>>>>>>//                Set piB_Garticl_No           to Bmove.Barticl_No        //sosososo
54125>>>>>>>//                Set psB_Garticl_C_Code2      to Baxio.Baxio_C_Code2
54125>>>>>>>//                Set pnB_Garticl_Rate0        to Baxio.Baxio_Rate0
54125>>>>>>>//                Set pnB_Garticl_Rate00       to Baxio.Baxio_Rate00
54125>>>>>>>//                Set pnB_Garticl_RateR        to Baxio.Baxio_RateR
54125>>>>>>>//                Set psB_Garticl_Aitiol       to Barticl.Barticl_Aitiol
54125>>>>>>>
54125>>>>>>>//                Set piB_Gmove_Master_Rec0    to Barticl.Gmove_Mrec0
54125>>>>>>>//                Set piB_Gplan_Master_Rec0    to Barticl.Gplan_Mrec0
54125>>>>>>>
54125>>>>>>>                //â¢œš®¦ª §¨¦©ã£¦¬
54125>>>>>>>                //If ((Abs(Btypkin.Btypkin_Sign)) <> 1) Error 10000 "To Btypkin Sign œå¤˜  ¢áŸ¦ª !"
54125>>>>>>>
54125>>>>>>>                Case Begin
54125>>>>>>>                     Case (Btypkin.Btypkin_Anti_Xp = 1) //®¨âà©ž master, §å©«à©ž slave
54127>>>>>>>//                          Set pnB_Gmove_Master_X2 to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
54127>>>>>>>//                          Set pnB_Gmove_Master_P2 to 0
54127>>>>>>>//                          Set pnB_Gmove_Slave_X2  to 0
54127>>>>>>>//                          Set pnB_Gmove_Slave_P2  to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
54127>>>>>>>                     Case Break
54128>>>>>>>                     Case (Btypkin.Btypkin_Anti_Xp = 2) // §å©«à©ž master, ®¨âà©ž slave
54131>>>>>>>//                          Set pnB_Gmove_Master_X2 to 0
54131>>>>>>>//                          Set pnB_Gmove_Master_P2 to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
54131>>>>>>>//                          Set pnB_Gmove_Slave_X2  to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
54131>>>>>>>//                          Set pnB_Gmove_Slave_P2  to 0
54131>>>>>>>                     Case Break
54132>>>>>>>                     Case Else
54132>>>>>>>                          Error 10000 "To Btypkin XP œå¤˜  ¢áŸ¦ª!"
54133>>>>>>>>
54133>>>>>>>                Case End
54133>>>>>>>//                Set psB_Gmove_Master_Aitiol  to Barticl.Barticl_Aitiol
54133>>>>>>>
54133>>>>>>>//                Set piB_Gmove_Slave_Rec0     to (private.fiBsum_Gmove_Srec0(Self,;
54133>>>>>>>//                                                                            Barticl.Barticl_Rec0,;
54133>>>>>>>//                                                                            Baxiokat.Baxiokat_Rec0))
54133>>>>>>>
54133>>>>>>>//                Set piB_Gplan_Slave_Rec0     to Bmove.Gplan_Srec0
54133>>>>>>>//                Set psB_Gmove_Slave_Aitiol   to Barticl.Barticl_Aitiol
54133>>>>>>>
54133>>>>>>>                Set piBackout to 1
54134>>>>>>>
54134>>>>>>>                //properties š ˜ «ž¤ procedural œ¤ž£â¨à©ž «¦¬ bsum
54134>>>>>>>                Set psB_Barticl_Recr         to Barticl.Barticl_Recr
54135>>>>>>>                Set psB_Baxiokat_Recr        to Baxiokat.Baxiokat_Recr
54136>>>>>>>                Set pnB_Baxio_V2             to Baxio.Baxio_V2
54137>>>>>>>                Set pnB_Baxio_V0             to Baxio.Baxio_V0
54138>>>>>>>                Set pnB_Baxio_V00            to Baxio.Baxio_V00
54139>>>>>>>                Set pnB_Baxio_VR             to Baxio.Baxio_VR
54140>>>>>>>
54140>>>>>>>
54140>>>>>>>//                //booleans §¦¬ ›ž¢é¤¦¬¤ «¦ operation §¦¬ Ÿ˜ šå¤œ  ©«ã¤ š¢
54140>>>>>>>//                Case Begin
54140>>>>>>>//                     Case  (Barticl.Barticl_Lines = 0) //œá¤ › ˜š¨á­à «ž¤ «œ¢œ¬«˜å˜ š¨˜££ã «¦¬ barticl, «æ«œ Ÿ˜ › ˜š¨á¯à ¡˜  «¦ garticl
54140>>>>>>>//                           Set  piGarticl_Delete         to  1
54140>>>>>>>//                           Set  piMaster_Gmove_Delete    to  1
54140>>>>>>>//                     Case Break
54140>>>>>>>//                     Case  (Barticl.Barticl_Lines > 0) //˜¢¢¦ éª Ÿ˜ ¡á¤à edit ©«¦ garticl
54140>>>>>>>//                           Set  piGarticl_Edit           to  1
54140>>>>>>>//                           Set  piMaster_Gmove_Edit      to  1
54140>>>>>>>//                     Case Break
54140>>>>>>>//                     Case  (Barticl.Barticl_Lines < 0) //§¨æ™¢ž£˜, ¡á«  «¨â®œ 
54140>>>>>>>//                           Send Operation_Not_Allowed 9999 //«¨â¥«œ ¦¢ ¡á â¢œš®¦ ™á©žª
54140>>>>>>>//                     Case Break
54140>>>>>>>//                Case End
54140>>>>>>>
54140>>>>>>>/////////////////////Case (Barticl.Garticl_Rec0 = 0) //«¦ barticl ›â¤ â®œ  ©¬¤›œŸœå £œ master gmove
54140>>>>>>>/////////////////////     //If (Barticl.Gmove_Mrec0 <> 0) Error 1000 " djfdfsdds"
54140>>>>>>>/////////////////////Case Break
54140>>>>>>>      End_Procedure   // backout
54141>>>>>>>
54141>>>>>>>
54141>>>>>>>      Procedure Creating
54142>>>>>>>                Integer liBaxio_Status_From liBaxio_Status_To
54143>>>>>>>
54143>>>>>>>                Forward Send Creating
54145>>>>>>>
54145>>>>>>>            Move (Append('',((Trim(SysCurXR.Branch_Site))+;                             (Trim(String(Bmove.Bmove_Rec0)))))) to Bmove.Bmove_Recr
54146>>>>>>>
54146>>>>>>>
54146>>>>>>>                //˜¨ Ÿ£æª ¡ ¤ã©œà¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
54146>>>>>>>                //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBmove
54146>>>>>>>
54146>>>>>>>                //˜¨ Ÿ£æª š¨˜££é¤ barticl
54146>>>>>>>                Add 1 to Barticl.Barticl_Lines
54147>>>>>>>
54147>>>>>>>                //˜/˜ š¨˜££ãª á¨Ÿ¨¦¬
54147>>>>>>>                Add 1 to Barticl.Barticl_BmoveLa
54148>>>>>>>                Move Barticl.Barticl_BmoveLa to Bmove.Bmove_AA
54149>>>>>>>
54149>>>>>>>                //˜/˜ ¡å¤ž©žª ˜¥ ¦š¨á­¦¬
54149>>>>>>>                Add 1 to Baxio.Baxio_Bmove_Laa
54150>>>>>>>                Move Baxio.Baxio_Bmove_Laa to Bmove.Baxio_AA
54151>>>>>>>
54151>>>>>>>                //pourqua ??????
54151>>>>>>>                Get piBaxio_Status_From to liBaxio_Status_From
54152>>>>>>>                Get piBaxio_Status_To   to liBaxio_Status_To
54153>>>>>>>                //Set biBaxio_Status of liBaxio_dd to liBaxio_Status_From
54153>>>>>>>      End_Procedure //creating
54154>>>>>>>
54154>>>>>>>
54154>>>>>>>      Procedure Deleting
54155>>>>>>>                Integer liTemp
54156>>>>>>>
54156>>>>>>>                //œá¤ › ˜š¨á­à «ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬,
54156>>>>>>>                //æ¢˜ œå¤˜  ok, œå«œ «¦ ¡á¤à ˜§¦ «¦ bmove, œå«œ ˜§¦ «¦ barticl,
54156>>>>>>>                //œå«œ «œ¢ ¡á ˜§æ ¦§¦¬›ã§¦«œ !
54156>>>>>>>                //œá¤ æ£àª ›â¤ › ˜š¨á­à «ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬, ˜¢¢á ¡á§¦ ˜ á¢¢ž,
54156>>>>>>>                //§¨â§œ  ¤˜ › ˜¡æ¯à «¦ transaction, ˜¤˜¥á¨«ž«˜ ˜§¦ §¦ç «¦ â®à ¡˜¢â©œ .
54156>>>>>>>                //˜¬«æ ™â™˜ ˜ œ¢âš®œ«˜  ¡˜  ©«ž¤ validate delete, ˜¢¢á ¦¬© ˜©« ¡á §¨â§œ 
54156>>>>>>>                //¤˜ œ¢œšŸœå œ›é, › æ«  ž › ˜š¨˜­ã £§¦¨œå ¤˜ ¥œ¡ ¤ã©œ  ˜§æ cascade delete
54156>>>>>>>                //«¦¬ barticl.
54156>>>>>>>                //£œ á¢¢˜ ¢æš ˜ œ¤œ¨š¦§¦ é «ž¤ validate delete æ«˜¤ ž › ˜š¨˜­ã
54156>>>>>>>                //›â¤ ¥œ¡ ¤áœ  ˜§¦ «¦ bmove !
54156>>>>>>>                If (OPERATION_ORIGIN <> (Self));                Begin
54158>>>>>>>                     Get Validate_Delete to liTemp
54159>>>>>>>                     If (liTemp <> 0) Send Operation_Not_Allowed liTemp //á®¨ž©«¦
54162>>>>>>>                End
54162>>>>>>>>
54162>>>>>>>
54162>>>>>>>                Forward Send Deleting
54164>>>>>>>
54164>>>>>>>                //§¨é«˜ œ¤«¦§åà bkinkat
54164>>>>>>>                Move (private.fiBkinkat_Baxiokat_Code(Self,;                                    Btypkin.Btypkin_Recr,;                                    Baxiokat.Baxiokat_Code);                     ) to liTemp
54165>>>>>>>                If (liTemp = 0) Send Operation_Not_Allowed 4002 //›â¤ œ§ «¨â§œ«˜  ž ¡å¤ž©ž baxiokat_code £œ «¦ btypkin
54168>>>>>>>
54168>>>>>>>
54168>>>>>>>                //***********************************************************
54168>>>>>>>                //*    ˜§æ œ›é ¡˜  ¡á«à, â®à §¢â¦¤ active bkinkat record    *
54168>>>>>>>                //***********************************************************
54168>>>>>>>
54168>>>>>>>                //˜¨ Ÿ£æª ¡ ¤ã©œà¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
54168>>>>>>>                //jsjsjs 24/01/2001 Sub 1 from Year.Year_NumBmove
54168>>>>>>>
54168>>>>>>>                //˜¨ Ÿ£æª š¨˜££é¤ barticl
54168>>>>>>>                Sub 1 from Barticl.Barticl_Lines
54169>>>>>>>
54169>>>>>>>                //˜/˜ š¨˜££ãª á¨Ÿ¨¦¬
54169>>>>>>>                If (Bmove.Bmove_AA = Barticl.Barticl_BmoveLa);                Sub 1 from Barticl.Barticl_BmoveLa
54172>>>>>>>
54172>>>>>>>                //˜/˜ ¡å¤ž©žª ˜¥ ¦š¨á­¦¬
54172>>>>>>>                If (Bmove.Baxio_AA = Baxio.Baxio_Bmove_Laa);                Sub 1 from Baxio.Baxio_Bmove_Laa
54175>>>>>>>
54175>>>>>>>                //š.03:œ¤ž£â¨à©ž §œ›åà¤ status + place, ˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž (bkinkat)
54175>>>>>>>                //     ›ž¢˜›ã œ§˜¤˜­â¨à «¦ status ¡˜  «¦ place ˜§¦ œ¡â  §¦¬ «˜ §ã¨˜.
54175>>>>>>>                //     ™œ™˜åàª, › ˜š¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬
54175>>>>>>>                Move Bkinkat.Baxio_Stat_From to Baxio.Baxio_Status //¡˜«á©«˜ž :˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž
54176>>>>>>>                Move Bkinkat.Baxio_Plac_From to Baxio.Baxio_Place  //œ¬¨å¡œ«˜ :˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž
54177>>>>>>>
54177>>>>>>>                //œ›é Ÿ˜ §¨â§œ  ¤˜ ™á¢à ¡˜  «¦¤ §¨¦žš¦ç£œ¤¦ ˜§¦›â¡«ž ! ! ! !
54177>>>>>>>                //     ž œ¤ž£â¨à©ž §œ›åà¤ previous «¦¬ bmove š ˜ æ¢˜ «˜ ˜¥ æš¨˜­˜
54177>>>>>>>                //     âš ¤œ ©«ž¤ update §¨¦«¦ç ˜¢¢á¥à «˜ last §œ›å˜ «¦¬ baxio,
54177>>>>>>>                //     «˜ ¡¨˜«áà ©«˜
54177>>>>>>>                //     previous §œ›å˜ «¦¬ bmove,
54177>>>>>>>                //     â«©  é©«œ ©«ž¤ deleteig ¤˜ «˜ œ§˜¤˜­â¨à ©«¦ baxio
54177>>>>>>>                Move Bmove.Baxio_Pfile to Baxio.Baxio_Lfile
54178>>>>>>>                Move Bmove.Baxio_Pcode to Baxio.Baxio_Lcode
54179>>>>>>>                Move Bmove.Baxio_Pepon to Baxio.Baxio_Lepon
54180>>>>>>>                Move Bmove.Baxio_Ppar  to Baxio.Baxio_Lpar
54181>>>>>>>
54181>>>>>>>                // js 05/09/2002
54181>>>>>>>                Saverecord Barticl
54182>>>>>>>                Saverecord Baxio
54183>>>>>>>
54183>>>>>>>      End_Procedure //deleting
54184>>>>>>>
54184>>>>>>>
54184>>>>>>>      Procedure Save_Main_File
54185>>>>>>>                Forward Send Save_Main_File
54187>>>>>>>                Send private.Trexe //procedural › ˜®œå¨ ©ž bsums
54188>>>>>>>      End_Procedure//save_main_file
54189>>>>>>>
54189>>>>>>>
54189>>>>>>>      Procedure Delete_Main_File
54190>>>>>>>                Integer liTemp
54191>>>>>>>
54191>>>>>>>                Forward Send Delete_Main_File
54193>>>>>>>                Send private.Trexe //procedural › ˜®œå¨ ©ž bsums
54194>>>>>>>
54194>>>>>>>                //œá¤ › ˜š¨á­à «ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬, «æ«œ Ÿ˜ › ˜š¨á¯à ¡˜  ˜¬«æ
54194>>>>>>>                //¦¬© ˜©« ¡á ˜§æ œ›é ¡˜  £æ¤¦¤ ˜§¦ œ›é šå¤œ«˜  ž › ˜š¨˜­ã ˜¥ ¦š¨á­¦¬,
54194>>>>>>>                //œå¤˜  ¢¦ §æ¤ ž deleteing «¦¬ baxio !
54194>>>>>>>                If (Baxio.Baxio_Bmove_Laa = 0);                Begin
54196>>>>>>>
54196>>>>>>>                     //˜¨ Ÿ£æª ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
54196>>>>>>>                     //jsjsjs 26/01/2001
54196>>>>>>>                     //Sub 1 from Year.Year_NumBaxio
54196>>>>>>>
54196>>>>>>>                     //«œ¢œ¬«˜å˜ª ¡à› ¡æª ˜¨ Ÿ£æª ˜¥ ¦š¨á­¦¬
54196>>>>>>>                     If (Baxiokat.Baxio_Lcode = Baxio.Baxio_Code);                     Sub 1 from Baxiokat.Baxio_Lcode
54199>>>>>>>
54199>>>>>>>                     Delete Baxio
54200>>>>>>>                End
54200>>>>>>>>
54200>>>>>>>      End_Procedure //delete_main_file
54201>>>>>>>
54201>>>>>>>
54201>>>>>>>      Procedure Operation_Not_Allowed Integer iError_Num
54202>>>>>>>                String lsError_Message
54203>>>>>>>                Case Begin
54203>>>>>>>                     //˜§æ validate save
54203>>>>>>>                     Case (iError_Num = 5555)
54205>>>>>>>                          Move ("† ˜§¦Ÿã¡œ¬©ž ˜¡¬¨éŸž¡œ ˜§¦ «¦¤ ®¨ã©«ž");                          to lsError_Message
54206>>>>>>>                     Case Break
54207>>>>>>>                     Case (iError_Num = 1001)
54210>>>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n† «¨¦§¦§¦åž©ž œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");                          to lsError_Message
54211>>>>>>>                     Case Break
54212>>>>>>>                     Case (iError_Num = 1004)
54215>>>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n† ¡å¤ž©ž œ§ «¨â§œ«˜  £æ¤¦¤ £œ ¤â˜ ˜¥ æš¨˜­¦ !");                          to lsError_Message
54216>>>>>>>                     Case Break
54217>>>>>>>                     Case (iError_Num = 1005)
54220>>>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n† ¡å¤ž©ž œ§ «¨â§œ«˜  £æ¤¦¤ ©œ ¬§á¨®¦¤ ˜¥ æš¨˜­¦ !");                          to lsError_Message
54221>>>>>>>                     Case Break
54222>>>>>>>                     Case (iError_Num = 1006)
54225>>>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n’¦ barticl â®œ  «¨¦§¦§¦ žŸœå!");                          to lsError_Message
54226>>>>>>>                     Case Break
54227>>>>>>>                     Case (iError_Num = 1100)
54230>>>>>>>                          Move "DDC 44:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
54231>>>>>>>                     Case Break
54232>>>>>>>
54232>>>>>>>                     //˜§æ validate delete
54232>>>>>>>                     Case (iError_Num = 2001)
54235>>>>>>>                          Move ("DDC 44:€›ç¤˜«ž ž › ˜š¨˜­ã !\n\n† › ˜š¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");                          to lsError_Message
54236>>>>>>>                     Case Break
54237>>>>>>>                     Case (iError_Num = 2100)
54240>>>>>>>                          Move "DDC 44:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
54241>>>>>>>                     Case Break
54242>>>>>>>
54242>>>>>>>                     //˜§æ update
54242>>>>>>>                     Case (iError_Num = 3001)
54245>>>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\nƒâ¤ œ§ «¨â§œ«˜  ž ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬ !");                          to lsError_Message
54246>>>>>>>                     Case Break
54247>>>>>>>                     Case (iError_Num = 3002)
54250>>>>>>>                          Move ("DDC 44:‹ã €§¦›œ¡«æª «ç§¦ª €¥ ¦š¨á­¦¬ š ˜ «ž¤ ‰å¤ž©ž !\n\n‹œ "+(Trim(Btypkin.Btypkin_Descr))+;                          " ›â¤ ¡ ¤¦ç¤«˜  " + (Trim(Baxiokat.Baxiokat_Descr)));                          to lsError_Message
54251>>>>>>>                     Case Break
54252>>>>>>>
54252>>>>>>>                     //˜§æ deleting
54252>>>>>>>                     Case (iError_Num = 4002)
54255>>>>>>>                          Move ("DDC 44:‹ã €§¦›œ¡«æª «ç§¦ª €¥ ¦š¨á­¦¬ š ˜ «ž¤ ƒ ˜š¨˜­ã !\n\n‹œ "+(Trim(Btypkin.Btypkin_Descr))+;                          " ›â¤ ¡ ¤¦ç¤«˜  " + (Trim(Baxiokat.Baxiokat_Descr)));                          to lsError_Message
54256>>>>>>>                     Case Break
54257>>>>>>>
54257>>>>>>>                     //˜§æ private.Transaction_Update_Other_Modules
54257>>>>>>>                     Case (iError_Num = 5001) //›â¤ £§æ¨œ©˜ ¤˜ ¥˜¤˜™¨é barticl by recnum!
54260>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Barticl Recnum Not Found)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
54261>>>>>>>                     Case Break
54262>>>>>>>                     Case (iError_Num = 5002) //›â¤ £§æ¨œ©˜ ¤˜ ¥˜¤˜™¨é bsum by recnum!
54265>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Bsum Recnum Not Found)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
54266>>>>>>>                     Case Break
54267>>>>>>>                     Case (iError_Num = 5003) //«¦ create master âš ¤œ ©œ ã›ž ©¬¤›œ›œ£â¤¦ barticl
54270>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Create Master on Connected B Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
54271>>>>>>>                     Case Break
54272>>>>>>>                     Case (iError_Num = 5004) //«¦ create master âš ¤œ ©œ £ã Ÿœ« ¡á gl records
54275>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Create Master on Non Positive GL Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
54276>>>>>>>                     Case Break
54277>>>>>>>                     Case (iError_Num = 5005) //«¦ edit master âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤˜ barticl records
54280>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Edit Master on Non Connected B Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
54281>>>>>>>                     Case Break
54282>>>>>>>                     Case (iError_Num = 5006) //«¦ edit master ›â¤ âš ¤œ ©«˜ å› ˜ master records
54285>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Edit Master not on Same Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
54286>>>>>>>                     Case Break
54287>>>>>>>                     Case (iError_Num = 5007) //«¦ create slave âš ¤œ ©œ œå¤˜  ã›ž ©¬¤›œ›œ£â¤¦ bsum
54290>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Create Slave on Connected B Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
54291>>>>>>>                     Case Break
54292>>>>>>>                     Case (iError_Num = 5008) //«¦ create slave âš ¤œ ©œ £ã Ÿœ« ¡æ gl record
54295>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Create Slave on Non Positive GL Record)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
54296>>>>>>>                     Case Break
54297>>>>>>>                     Case (iError_Num = 5009) //«¦ edit slave âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤¦ record
54300>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Edit Slave on Non Connected B Record)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
54301>>>>>>>                     Case Break
54302>>>>>>>                     Case (iError_Num = 5010) //«¦ edit slave ›â¤ âš ¤œ ©«¦ å› ¦ slave record
54305>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Edit Slave not on Same Record)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
54306>>>>>>>                     Case Break
54307>>>>>>>                     Case (iError_Num = 5011) //«¦ delete master âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤˜ records
54310>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Delete Master on Non Connected B Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
54311>>>>>>>                     Case Break
54312>>>>>>>                     Case (iError_Num = 5012) //«¦ delete master ›â¤ â›à©œ £ž›œ¤ ¡á master records «žª š¢
54315>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Delete Master not with 0 GL Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
54316>>>>>>>                     Case Break
54317>>>>>>>
54317>>>>>>>                     //˜§æ private.trexe (save+delete main file)
54317>>>>>>>                     Case (iError_Num = 6001) //¢áŸ¦ª «¦¬ ¡é› ¡˜
54320>>>>>>>                          Move ("DDC 44:Transaction Aborted! (€¡˜«á¢¢ž¢¦ §¨æ©ž£¦)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «ž¢œ­à¤ã©«œ ©«ž¤ Solution!") to lsError_Message
54321>>>>>>>                     Case Break
54322>>>>>>>                     Case (iError_Num = 6002) //¢áŸ¦ª «¦¬ ¡é› ¡˜
54325>>>>>>>                          Move ("DDC 44:Transaction Aborted! (update=0 + backout=0)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «ž¢œ­à¤ã©«œ ©«ž¤ Solution!") to lsError_Message
54326>>>>>>>                     Case Break
54327>>>>>>>
54327>>>>>>>                     Case Else
54327>>>>>>>                          Forward Send Operation_Not_Allowed iError_Num
54329>>>>>>>                Case End
54329>>>>>>>
54329>>>>>>>                Error iError_Num lsError_Message
54330>>>>>>>>
54330>>>>>>>      End_Procedure // operation_not_allowed
54331>>>>>>>
54331>>>>>>>
54331>>>>>>>
54331>>>>>>>
54331>>>>>>>     //1001:Baxio_AA = baxio_bmove_laa (editing £æ¤¦¤ ©«¦¤ «œ¢œ¬«˜å¦ ˜˜ ¡å¤ž©žª «¦¬ ˜¥ ¦š¨á­¦¬)
54331>>>>>>>     //1002:create a new bmove £æ¤¦¤ œá¤ «¦ baxio_status <> œ¥¦­¢ž£â¤¦
54331>>>>>>>     //1003:˜§˜š¦¨œçœ«˜  «¦ bmove ¤˜ ˜¢¢áœ  parent barticl
54331>>>>>>>     //1004:˜§˜š¦¨œçœ«˜  «¦ bmove ¤˜ ˜¢¢áœ  parent baxiokat
54331>>>>>>>     //1005:œá¤ ž ¡å¤ž©ž ž«áœ  ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬
54331>>>>>>>     //     ¡˜  ¡á¤à create bmove, §¨â§œ  ¤˜ â®à ¡á¤œ  ¡˜  create baxio
54331>>>>>>>     //1006:›â¤ œ§ «¨â§œ«˜  save ©«¦ bmove, œá¤ «¦ barticl â®œ  šå¤œ  edit
54331>>>>>>>     //     ¡˜  ›â¤ â®œ  «¨â¥œ  ž request_save
54331>>>>>>>     //1007
54331>>>>>>>     //1008
54331>>>>>>>     //?1009:m_code:ž œšš¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ˜§¦ ¦ module §¦¬ «ž¤ ›ž£ ¦ç¨šž©œ
54331>>>>>>>      Function Validate_Save Returns Integer
54332>>>>>>>               Integer iReturnVal liBarticl_dd_Changed isNO
54333>>>>>>>
54333>>>>>>>               Forward Get Validate_Save to iReturnVal
54335>>>>>>>
54335>>>>>>>               If (Not(iReturnVal));               Begin
54337>>>>>>>
54337>>>>>>>//                If (Baxio.Baxio_HmniaL<Barticl.Barticl_Hmnia) Begin
54337>>>>>>>//                    Get YesNo_Box '† ž£œ¨¦£ž¤å˜ «žª œ§ «˜šãª œå¤˜ \n§¨¦šœ¤â©«œ¨ž «žª ž£œ¨¦£ž¤å˜ª «¦¬ §˜¨˜©«˜« ¡¦ç.\nŒ˜ ©¬¤œ®å©à ?' to isNO
54337>>>>>>>//                    If (isNO=MBR_NO) Send Operation_Not_Allowed 5555
54337>>>>>>>//                End
54337>>>>>>>
54337>>>>>>>                //---------â¢œš®¦  ›ž£ ¦¬¨šå˜ª ¤â¦¬ bmove record----------------------
54337>>>>>>>                If (Bmove.Recnum =  0);                Begin //œá¤ ›ž£ ¦¬¨šé ¤â¦ bmove record
54339>>>>>>>                      //1005:š ˜ ¤˜ ›œ®Ÿé «ž¤ ›ž£ ¦¬¨šå˜ ¤â¦¬ baxio record, §¨â§œ :
54339>>>>>>>                      //     1.œá¤ ž ¡å¤ž©ž ž«áœ  «ž¤ ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬,
54339>>>>>>>                      //       «æ«œ §¨â§œ  ¤˜ â®à æ¤«àª ¡á¤œ  ¡˜  create baxio.
54339>>>>>>>                      //     2.œá¤ ž ¡å¤ž©ž ›â¤ ž«áœ  «ž¤ ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬,
54339>>>>>>>                      //       «æ«œ ›â¤ §¨â§œ  ¤˜ â®à ¡á¤œ  ¡˜  create baxio.
54339>>>>>>>                      If ((piCan_Create_Baxio(Self)) = TRUE);                      Begin
54341>>>>>>>                      If (Not(;                              ((piCreated_Baxio(piBaxio_dd(Self))) = TRUE);                         )) Send Operation_Not_Allowed 1004 //ž ¡å¤ž©ž œ§ «¨â§œ«˜  £æ¤¦¤ £œ ¤â˜ ˜¥ æ§š¨˜­¦
54344>>>>>>>                      End
54344>>>>>>>>
54344>>>>>>>                      Else;                      Begin
54345>>>>>>>                      If (Not(;                              ((piCreated_Baxio(piBaxio_dd(Self))) = FALSE);                         )) Send Operation_Not_Allowed 1005 //ž ¡å¤ž©ž œ§ «¨â§œ«˜  £æ¤¦¤ ©œ ¬§á¨®¦¤ ˜¥ æ§š¨˜­¦
54348>>>>>>>                      End
54348>>>>>>>>
54348>>>>>>>
54348>>>>>>>                      //1002:create a new bmove £æ¤¦¤ œá¤ «¦ baxio_status <> œ¥¦­¢ž£â¤¦
54348>>>>>>>                      //If (Not(;
54348>>>>>>>                      //        (Baxio.Baxio_Old_Status <> 2);
54348>>>>>>>                      //   )) Send Operation_Not_Allowed 1002
54348>>>>>>>                End   //«â¢¦ª œ¢âš®à¤ ›ž£ ¦¬¨šå˜ª ¤â¦¬ bmove record
54348>>>>>>>>
54348>>>>>>>
54348>>>>>>>
54348>>>>>>>                //---------â¢œš®¦  editing existing bmove records---------------------
54348>>>>>>>                Else;                Begin //edit an existing record
54349>>>>>>>                      //1001:Baxio_AA = baxio_bmove_laa (editing £æ¤¦¤ ©«¦¤ «œ¢œ¬«˜å¦ ˜˜ ¡å¤ž©žª «¦¬ ˜¥ ¦š¨á­¦¬)
54349>>>>>>>                      If (Not(;                              (Baxio.Baxio_Bmove_Laa = Bmove.Baxio_AA);                         )) Send Operation_Not_Allowed 1001
54352>>>>>>>                End   //«â¢¦ª œ¢âš®à¤ editing existing bmove records
54352>>>>>>>>
54352>>>>>>>
54352>>>>>>>/////////////// js 07/08/2001  07-08-2001
54352>>>>>>>             // Ž ¡à› ¡˜ª ˜¬«¦ª £§ž¡œ remarks š ˜«  ž ¢¦š ¡ž £˜ª £œ©à «¦¬ ˜¤¦ ¥œ / ¡¢œ ©œ
54352>>>>>>>             // ¡˜  «¦ ©«ž© £¦ «žª œ­˜¨£¦šžª œ ¤˜  «œ«¦ ˜ §¦¬ ›œ¤ š ¤œ«˜  ˜¢¢ à©ž
54352>>>>>>>             // ˜§¦ ˜¢¢¦ ©ž£œ ¦ ©«¦ Barticl, ¡˜  œ§ §¢œ¦¤ ™˜¨˜œ  ¦«˜¤ ˜¤¦ š¦¡¢œ ¤œ 
54352>>>>>>>             // «¦ §˜¨˜©«˜« ¡¦ (§¨¦­˜¤àª š ˜«  £ž›œ¤ ¦¬¤ «˜ properties §¨¦ ¡˜  £œ«˜
54352>>>>>>>             // ˜§¦ «ž¤ private.Initialize_Properties
54352>>>>>>>//                //1006:›â¤ œ§ «¨â§œ«˜  save ©«¦ bmove, œá¤ «¦ barticl â®œ  šå¤œ  edit
54352>>>>>>>//                //     ¡˜  ›â¤ â®œ  «¨â¥œ  ž request_save
54352>>>>>>>//                Get Changed_State of (piBarticl_dd(Self)) to liBarticl_dd_Changed
54352>>>>>>>//                If (liBarticl_dd_Changed = TRUE) Send Operation_Not_Allowed 1006
54352>>>>>>>/////////////// js 07/08/2001  07-08-2001
54352>>>>>>>
54352>>>>>>>
54352>>>>>>>
54352>>>>>>>
54352>>>>>>>                //1100:cby = globals
54352>>>>>>>                If ( ;                    (Not(Bmove.Company_Code = SysCurXr.Company_Code)) or;                    (Not(Bmove.Branch_Code  = SysCurXr.Branch_Code )) or;                    (Not(Bmove.Year_Year    = SysCurXr.Year_Year   ));                    )                                                   Send Operation_Not_Allowed 1100
54355>>>>>>>
54355>>>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
54355>>>>>>>>
54355>>>>>>>               Function_Return iReturnVal
54356>>>>>>>      End_Function //validate_save
54357>>>>>>>
54357>>>>>>>
54357>>>>>>>      //2001:Baxio_AA = baxio_bmove_laa (delete £æ¤¦¤ «¦¤ «œ¢œ¬«˜å¦ ˜˜ ¡å¤ž©žª «¦¬ ˜¥ ¦š¨á­¦¬)
54357>>>>>>>      Function Validate_Delete  Returns Integer
54358>>>>>>>               Integer iReturnVal
54359>>>>>>>               Forward Get Validate_Delete  To iReturnVal
54361>>>>>>>               If (Not(iReturnVal));               Begin
54363>>>>>>>
54363>>>>>>>                //2001:â¢œš®¦ª «œ¢œ¬«˜å¦¬ ˜˜ ¡å¤ž©žª ˜¥ ¦š¨á­¦¬
54363>>>>>>>                If (Not(Bmove.Baxio_AA = Baxio.Baxio_Bmove_Laa))       Send Operation_Not_Allowed 2001
54366>>>>>>>                If ( ;                    (Not(Bmove.Company_Code = SysCurXr.Company_Code)) or;                    (Not(Bmove.Branch_Code  = SysCurXr.Branch_Code )) or;                    (Not(Bmove.Year_Year    = SysCurXr.Year_Year   ));                    )                                                   Send Operation_Not_Allowed 2100
54369>>>>>>>
54369>>>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
54369>>>>>>>>
54369>>>>>>>               Function_Return iReturnVal
54370>>>>>>>      End_Function //validate_delete
54371>>>>>>>
54371>>>>>>>
54371>>>>>>>      Procedure Request_Save
54372>>>>>>>                Integer liBaxiokat_Code liBaxio_Allow_Foreign_New_Save_State iErrorObj
54373>>>>>>>                String  lsBtypkin_Recr
54373>>>>>>>                //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties §¦¬ ˜­¦¨¦ç¤ «¦ transaction
54373>>>>>>>                Send private.Initialize_Properties
54374>>>>>>>                //˜¤áš¤à©ž «¨â®¦¬©˜ª ¡˜«á©«˜©žª «¦¬ baxio_dd
54374>>>>>>>                Get Allow_Foreign_New_Save_State of (piBaxio_dd(Self)) to liBaxio_Allow_Foreign_New_Save_State
54375>>>>>>>
54375>>>>>>>                //«¦ bkinkat_yn_new ¨¬Ÿ£åœ  œá¤ Ÿ˜ ¡á¤à œ ©˜šàšã ¤â¦¬ ˜¥ ¦š¨á­¦¬
54375>>>>>>>                Get File_Field_Current_Value File_Field Btypkin.Btypkin_Recr   to lsBtypkin_Recr
54376>>>>>>>                Get File_Field_Current_Value File_Field Baxiokat.Baxiokat_Code to liBaxiokat_Code
54377>>>>>>>
54377>>>>>>>                Clear Bkinkat
54378>>>>>>>                Move SysCurXr.Company_Code   to Bkinkat.Company_Code
54379>>>>>>>                Move SysCurXr.Branch_Code    to Bkinkat.Branch_Code
54380>>>>>>>                Move SysCurXr.Year_Year      to Bkinkat.Year_Year
54381>>>>>>>                Move lsBtypkin_Recr  to Bkinkat.Btypkin_Recr
54382>>>>>>>                Move liBaxiokat_Code to Bkinkat.Baxiokat_Code
54383>>>>>>>                Find Eq Bkinkat by Index.3 //company+branch+Year+btypkin_recr+baxiokat_code
54384>>>>>>>>
54384>>>>>>>                If (Found = 0) Begin //›â¤ œ§ «¨â§œ«˜  ž ¡å¤ž©ž baxiokat_code £œ «¦ btypkin
54386>>>>>>>                                Send Operation_Not_Allowed 3002
54387>>>>>>>                               End
54387>>>>>>>>
54387>>>>>>>
54387>>>>>>>                If (Bkinkat.Bkinkat_YN_New  = TRUE);                     Begin //œ ©˜šàšã ¤â¦¬ ˜¥ ¦š¨á­¦¬, á¨˜ œ§ «¨â§à «¦ create ©«¦ baxio
54389>>>>>>>                      Set Allow_Foreign_New_Save_State of (piBaxio_dd(Self)) to TRUE
54390>>>>>>>                      Set piCan_Create_Baxio                                 to TRUE
54391>>>>>>>                     End
54391>>>>>>>>
54391>>>>>>>                Else Begin //› ˜¡å¤ž©ž ¬§á¨®¦¤«¦ª ˜¥ ¦š¨á­¦¬, á¨˜ ›â¤ œ§ «¨â§à «¦ create ©«¦ baxio
54392>>>>>>>                      Set Allow_Foreign_New_Save_State of (piBaxio_dd(Self)) to FALSE
54393>>>>>>>                      Set piCan_Create_Baxio                                 to FALSE
54394>>>>>>>                     End
54394>>>>>>>>
54394>>>>>>>
54394>>>>>>>                Forward Send Request_Save
54396>>>>>>>
54396>>>>>>>                //œ§˜¤˜¤˜­¦¨á ˜¨® ¡ãª ¡˜«á©«˜©žª «¦¬ baxio_dd
54396>>>>>>>                Set Allow_Foreign_New_Save_State of (piBaxio_dd(Self)) to liBaxio_Allow_Foreign_New_Save_State
54397>>>>>>>                Set Smart_Filemode_State to True
54398>>>>>>>                //£ž›œ¤ ©£æª properties š ˜ œ§æ£œ¤ž ¡å¤ž©ž
54398>>>>>>>                Send private.Initialize_Properties
54399>>>>>>>                //œ§˜¤˜­¦¨á «¦¬ system indicator err
54399>>>>>>>                Indicate Err False
54400>>>>>>>      End_Procedure //request_save
54401>>>>>>>
54401>>>>>>>
54401>>>>>>>      Procedure Request_Delete
54402>>>>>>>                Integer iErrorObj
54403>>>>>>>                Send private.Initialize_Properties //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties
54404>>>>>>>                Forward Send Request_Delete
54406>>>>>>>                Send private.Initialize_Properties //£ž›œ¤ ©£æª properties š ˜ œ§æ£œ¤ž ¡å¤ž©ž
54407>>>>>>>                //œ§˜¤˜­¦¨á «¦¬ system indicator err
54407>>>>>>>                Indicate Err False
54408>>>>>>>      End_Procedure   //request_delete
54409>>>>>>>
54409>>>>>>>
54409>>>>>>>//      //ž ¨¦¬«å¤˜ ˜¬«ã ˜¤˜¢˜£™á¤œ  ¤˜ œ¤ž£œ¨é©œ  æ©˜ ˜§¦ «˜ ¬§æ¢¦ §˜ 3 modules «¦¬ ©¬©«ã£˜«¦ª
54409>>>>>>>//      //§¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤.
54409>>>>>>>//      //¡˜¢œå«˜  ˜§æ « ª request save & delete, £â©˜ ˜§æ transaction.
54409>>>>>>>//      //œ§ ©«¨â­œ  ¢áŸž : 5001 - 5012 š ˜ «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã
54409>>>>>>>//      Procedure private.Transaction_Update_Other_Modules
54409>>>>>>>//                Integer liDo_GL_Maintainance liDo_CUSTOMER_Maintainance liDo_VENDOR_Maintainance
54409>>>>>>>//                Integer liMust_Update_GL     liMust_Update_CUSTOMER     liMust_Update_VENDOR
54409>>>>>>>
54409>>>>>>>//                //š ˜ «ž¤ œç¨œ©ž «¦¬ bsum
54409>>>>>>>//                String lsBaxiokat_Recr
54409>>>>>>>
54409>>>>>>>//                //final values, š ˜ «ã¤ feedback œ¤ž£â¨à©ž «¦¬ barticl & bsum ˜§¦ «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã
54409>>>>>>>//                Integer liF_Garticl_Rec0 liF_Gmove_Master_Rec0 liF_Gmove_Slave_Rec0
54409>>>>>>>
54409>>>>>>>//                //final values, š ˜ «ã¤ feedback œ¤ž£â¨à©ž «¦¬ barticl ˜§¦ «¦çª §œ¢á«œª
54409>>>>>>>//                Integer liF_Carticl_Rec0 liF_Cmove_Rec0
54409>>>>>>>
54409>>>>>>>//                //final values, š ˜ «ã¤ feedback œ¤ž£â¨à©ž «¦¬ barticl ˜§¦ «¦çª §¨¦£žŸœ¬«âª
54409>>>>>>>//                Integer liF_Varticl_Rec0 liF_Vmove_Rec0
54409>>>>>>>
54409>>>>>>>//               //4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
54409>>>>>>>//               Integer liFlag02 liFlag03 liFlag04 liFlag05
54409>>>>>>>
54409>>>>>>>
54409>>>>>>>//                //œç¨œ©ž «à¤ ¢¦ §é¤ modules §¦¬ §¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤
54409>>>>>>>//                Get Field_Current_Value of (piBtypkin_dd(Self)) Field Btypkin.Gtypkin_Rec0 to liMust_Update_GL
54409>>>>>>>//                Get Field_Current_Value of (piBtypkin_dd(Self)) Field Btypkin.Ctypkin_Rec0 to liMust_Update_CUSTOMER
54409>>>>>>>//                Get Field_Current_Value of (piBtypkin_dd(Self)) Field Btypkin.Vtypkin_Rec0 to liMust_Update_VENDOR
54409>>>>>>>
54409>>>>>>>//               //˜¤áš¤à©ž «à¤ 4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
54409>>>>>>>//               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag02 to liFlag02
54409>>>>>>>//               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag03 to liFlag03
54409>>>>>>>//               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag04 to liFlag04
54409>>>>>>>//               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag05 to liFlag05
54409>>>>>>>
54409>>>>>>>
54409>>>>>>>//                //                                                  s  l  a  v  e  = bsum
54409>>>>>>>//                //                                        edit        create        delete
54409>>>>>>>//                //                                       -----        ------        ------
54409>>>>>>>//                // master garticl + gmove     edit         x            x              x
54409>>>>>>>//                //                            create                    x
54409>>>>>>>//                //                            delete                                   x
54409>>>>>>>//                // slave  gmove               edit         x            x              x
54409>>>>>>>//                //                            create                    x
54409>>>>>>>//                //                            delete                                   x
54409>>>>>>>
54409>>>>>>>
54409>>>>>>>//                If (;
54409>>>>>>>//                    ( liMust_Update_Gl     > 0                   ) and;
54409>>>>>>>//                    ((pnB_Baxio_V2(Self)) <> (pnA_Baxio_V2(Self)));
54409>>>>>>>//                   );
54409>>>>>>>//                Begin //edit œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ ˜¥å˜ v2 !
54409>>>>>>>//                //***************************************************************************
54409>>>>>>>//                //*  €  • †    „ Œ † ‹ „  — ‘ † ‘    ‚ „ Œ ˆ ‰ † ‘    Š Ž ‚ ˆ ‘ ’ ˆ ‰ † ‘ *
54409>>>>>>>//                //***************************************************************************
54409>>>>>>>//                //œ­'æ©¦¤ «¦ bmove record ©éŸž¡œ/› ˜š¨á­ž¡œ ¡˜¤¦¤ ¡á, §¨¦®à¨áà ©«ž¤ bpo
54409>>>>>>>//                //š ˜ «ž¤ œ¤ž£â¨à©ž «žª šœ¤ ¡ãª ¢¦š ©« ¡ãª, œá¤ æ£àª ®¨œ áœ«˜ ]
54409>>>>>>>
54409>>>>>>>//// jsjsjs 24/01/2001
54409>>>>>>>////                Send Transaction_BCVWmove_Update_GL to (piDo_GL_Maintainance(Self)) (Self);
54409>>>>>>>////                                                                                    liFlag02;
54409>>>>>>>////                                                                                    liFlag03;
54409>>>>>>>////                                                                                    liFlag04;
54409>>>>>>>////                                                                                    liFlag05
54409>>>>>>>//// jsjsjs 24/01/2001
54409>>>>>>>
54409>>>>>>>//                //œ­'æ©¦¤ ¡˜  «¦ bmove record ©éŸž¡œ/› ˜š¨á­ž¡œ ¡˜¤¦¤ ¡á,
54409>>>>>>>//                //¡˜  ž bpo â«¨œ¥œ ®à¨åª error,  ¡˜«˜®à¨é «¦ transaction
54409>>>>>>>//                //¡˜  œ¤ž£œ¨é¤à «© ©®œ« ¡á ˜¨®œå˜, › ˜™á¦¤«˜ª «˜
54409>>>>>>>//                //3 properties §¦¬ â®œ  œ§ ©«¨â¯œ  ž bpo œ¤ž£â¨à©žª «žª š¢
54409>>>>>>>//                Get piF_Garticl_Rec0      to liF_Garticl_Rec0       //barticl
54409>>>>>>>//                Get piF_Gmove_Master_Rec0 to liF_Gmove_Master_Rec0  //barticl
54409>>>>>>>//                Get piF_Gmove_Slave_Rec0  to liF_Gmove_Slave_Rec0   //bmove
54409>>>>>>>
54409>>>>>>>//                //œ¤ž£â¨à©ž bmove & barticl & bsum š ˜ « ª œšš¨˜­âª ©«á á¢¢˜ modules
54409>>>>>>>//                //œç¨œ©ž barticl, › æ«  œå¤˜  ˜§˜¨˜å«ž«¦ ©œ æ¢˜ «˜ operations
54409>>>>>>>//                Clear Barticl
54409>>>>>>>//                Get Current_Record of (piBarticl_dd(Self)) to Barticl.Recnum
54409>>>>>>>//                Find Eq Barticl.Recnum
54409>>>>>>>//                If (Found = 0);
54409>>>>>>>//                Begin //›â¤ £§æ¨œ©˜ ¤˜ ™¨é barticl by recnum
54409>>>>>>>//                      Send Operation_Not_Allowed 5001
54409>>>>>>>//                End
54409>>>>>>>
54409>>>>>>>//                //=======================================================================
54409>>>>>>>//                //œ­'æ©¦¤ ¡á¤à create or edit ©«¦ bmove,
54409>>>>>>>//                //™á©œ  «¦¬ §å¤˜¡˜ ©«¦ master ¡á¤à create or edit
54409>>>>>>>//                If ((piUpdate(Self)) = TRUE);
54409>>>>>>>//                Begin
54409>>>>>>>//                     //œç¨œ©ž bsum, «¦ ¦§¦å¦ ®¨œ áœ«˜  £æ¤¦¤ œ›é ¡˜  æ®  ©«ž¤ ¦¢ ¡ã › ˜š¨˜­ã «¦¬ garticl
54409>>>>>>>//                     Get Field_Current_Value of (piBaxiokat_dd(Self)) Field Baxiokat.Baxiokat_Recr to lsBaxiokat_Recr
54409>>>>>>>//                     Clear Bsum
54409>>>>>>>//                     Move Barticl.Barticl_Recr to Bsum.Barticl_Recr
54409>>>>>>>//                     Move lsBaxiokat_Recr      to Bsum.Baxiokat_Recr
54409>>>>>>>//                     Find Eq Bsum by Index.1 //barticl_recr+baxiokat_recr !!!!!!
54409>>>>>>>//                     If (Found=0);
54409>>>>>>>//                     Begin //›â¤ £§æ¨œ©˜ ¤˜ ™¨é bsum by recnum
54409>>>>>>>//                           Send Operation_Not_Allowed 5002
54409>>>>>>>//                     End
54409>>>>>>>
54409>>>>>>>//                     //œ¤ž£â¨à©ž master (create or edit)
54409>>>>>>>//                     Case Begin
54409>>>>>>>//                          //©«¦ create master, §¨â§œ  ž ©ç¤›œ©ž ¤© šå¤œ  «é¨˜,
54409>>>>>>>//                          //›ž¢˜›ã §¨â§œ  ¡˜  «˜ 2 §œ›å˜ ¤˜ œå¤˜  0,
54409>>>>>>>//                          //œ¤é «˜ master records «žª š¢ §¨â§œ  ¤˜ â®¦¬¤ Ÿœ« ¡ã « £ã.
54409>>>>>>>//                          Case ((piGarticl_Create(Self)) = TRUE)
54409>>>>>>>//                               If (;
54409>>>>>>>//                                    (Barticl.Garticl_Rec0 <> 0) or;
54409>>>>>>>//                                    (Barticl.Gmove_Mrec0  <> 0);
54409>>>>>>>//                                  ) Send Operation_Not_Allowed 5003 //«¦ create master âš ¤œ ©œ ã›ž ©¬¤›œ›œ£â¤¦ barticl
54409>>>>>>>//                               If (;
54409>>>>>>>//                                    (liF_Garticl_Rec0       <= 0) or;
54409>>>>>>>//                                    (liF_Gmove_Master_Rec0  <= 0);
54409>>>>>>>//                                  ) Send Operation_Not_Allowed 5004 //«¦ create master âš ¤œ ©œ £ã Ÿœ« ¡á gl records
54409>>>>>>>//                               Move liF_Garticl_Rec0      to Barticl.Garticl_Rec0 //©ç¤›œ©ž £œ garticl
54409>>>>>>>//                               Move liF_Gmove_Master_Rec0 to Barticl.Gmove_Mrec0  //©ç¤›œ©ž £œ master gmove
54409>>>>>>>//                               Saverecord Barticl
54409>>>>>>>//                          Case Break
54409>>>>>>>
54409>>>>>>>//                          //©«¦ edit master, §¨â§œ  ž ©ç¤›œ©ž ã›ž ¤˜ ¬§á¨®œ ,
54409>>>>>>>//                          //›ž¢˜›ã §¨â§œ  ¡˜  «˜ 2 §œ›å˜ ¤˜ œå¤˜  > 0
54409>>>>>>>//                          //¡˜  £á¢ ©«˜ ¤˜ © š¦¬¨œ¬«¦ç£œ æ«  ¡á¤˜£œ œ¤ž£â¨à©ž «žª š¢ ©«˜ å› ˜ master records
54409>>>>>>>//                          Case Else
54409>>>>>>>//                               If (;
54409>>>>>>>//                                    (Barticl.Garticl_Rec0 <= 0) or;
54409>>>>>>>//                                    (Barticl.Gmove_Mrec0  <= 0);
54409>>>>>>>//                                  ) Send Operation_Not_Allowed 5005 //«¦ edit master âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤˜ records
54409>>>>>>>//                               If (;
54409>>>>>>>//                                    (liF_Garticl_Rec0      <> Barticl.Garticl_Rec0) or;
54409>>>>>>>//                                    (liF_Gmove_Master_Rec0 <> Barticl.Gmove_Mrec0 );
54409>>>>>>>//                                  ) Send Operation_Not_Allowed 5006 //«¦ edit master ›â¤ âš ¤œ ©«˜ å› ˜ master records
54409>>>>>>>//                          Case Break
54409>>>>>>>//                     Case End //«â¢¦ª œ¤ž£â¨à©žª master
54409>>>>>>>
54409>>>>>>>//                     //œ¤ž£â¨à©ž slave (create or edit)
54409>>>>>>>//                     Case Begin
54409>>>>>>>//                          //©«¦ create slave, §¨â§œ  ž ©ç¤›œ©ž ¤˜ šå¤œ  «é¨˜,
54409>>>>>>>//                          //›ž¢˜›ã §¨â§œ  «o 1 §œ›åo ¤˜ œå¤˜  0,
54409>>>>>>>//                          //œ¤é «o slave record «žª š¢ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã « £ã.
54409>>>>>>>//                          Case ((piSlave_Gmove_Create(Self)) = TRUE)
54409>>>>>>>//                               If (Bsum.Gmove_Srec0 <> 0);
54409>>>>>>>//                                    Send Operation_Not_Allowed 5007 //«¦ create slave âš ¤œ ©œ œå¤˜  ã›ž ©¬¤›œ›œ£â¤¦ bsum
54409>>>>>>>//                               If (liF_Gmove_Slave_Rec0  <= 0);
54409>>>>>>>//                                    Send Operation_Not_Allowed 5008 //«¦ create slave âš ¤œ ©œ £ã Ÿœ« ¡æ gl record
54409>>>>>>>//                               Move liF_Gmove_Slave_Rec0  to Bsum.Gmove_Srec0     //©ç¤›œ©ž £œ slave gmove
54409>>>>>>>//                               Saverecord Bsum
54409>>>>>>>//                          Case Break
54409>>>>>>>
54409>>>>>>>//                          //©«¦ edit slave, §¨â§œ  ž ©ç¤›œ©ž ã›ž ¤˜ ¬§á¨®œ ,
54409>>>>>>>//                          //›ž¢˜›ã §¨â§œ  «¦ 1 §œ›å¦ ¤˜ œå¤˜  > 0
54409>>>>>>>//                          //¡˜  £á¢ ©«˜ ¤˜ © š¦¬¨œ¬«¦ç£œ æ«  ¡á¤˜£œ œ¤ž£â¨à©ž «žª š¢ ©«¦ å› ¦ slave record
54409>>>>>>>//                          Case Else
54409>>>>>>>//                               If (Bsum.Gmove_Srec0 =  0);
54409>>>>>>>//                                    Send Operation_Not_Allowed 5009 //«¦ edit slave âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤¦ record
54409>>>>>>>//                               If (liF_Gmove_Slave_Rec0  <> Bsum.Gmove_Srec0);
54409>>>>>>>//                                    Send Operation_Not_Allowed 5010 //«¦ edit slave ›â¤ âš ¤œ ©«¦ å› ¦ slave record
54409>>>>>>>//                          Case Break
54409>>>>>>>//                     Case End //«â¢¦ª œ¤ž£â¨à©žª slave
54409>>>>>>>//                End //«â¢¦ª œ¤ž£â¨à©žª edit or create bmove & barticl & bsum š ˜ « ª œšš¨˜­âª ©«á á¢¢˜ modules
54409>>>>>>>//                //=======================================================================
54409>>>>>>>
54409>>>>>>>//                //œ­'æ©¦¤ ©™ã¤à «ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ barticl,
54409>>>>>>>//                //®à¨åª æ£àª ¤˜ ©™ã©à ˜¬«æ,
54409>>>>>>>//                //£ž›œ¤åà ©«¦ barticl «¦ Garticl_Rec0 & Gmove_Mrec0,
54409>>>>>>>//                //š ˜ ¤˜ ˜§¦©¬¤›â©à «¦ barticl ˜§¦ «¦ garticl & «¦ gmove
54409>>>>>>>//                If ((piGarticl_Delete(Self)) = TRUE);
54409>>>>>>>//                Begin
54409>>>>>>>//                     //©«¦ delete master, §¨â§œ  ž ©ç¤›œ©ž ã›ž ¤˜ ¬§á¨®œ ,
54409>>>>>>>//                     //›ž¢˜›ã §¨â§œ  ¡˜  «˜ 2 §œ›å˜ ¤˜ œå¤˜  > 0
54409>>>>>>>//                     //¡˜  £á¢ ©«˜ ¤˜ © š¦¬¨œ¬«¦ç£œ æ«  «˜ master records «žª š¢ œå¤˜  £ž›œ¤ ¡á
54409>>>>>>>//                     If (;
54409>>>>>>>//                          (Barticl.Garticl_Rec0 <= 0) or;
54409>>>>>>>//                          (Barticl.Gmove_Mrec0  <= 0);
54409>>>>>>>//                        ) Send Operation_Not_Allowed 5011 //«¦ delete master âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤˜ records
54409>>>>>>>//                     If (;
54409>>>>>>>//                          (liF_Garticl_Rec0      <> 0) or;
54409>>>>>>>//                          (liF_Gmove_Master_Rec0 <> 0);
54409>>>>>>>//                        ) Send Operation_Not_Allowed 5012 //«¦ delete master ›â¤ â›à©œ £ž›œ¤ ¡á master records «žª š¢
54409>>>>>>>//                     Move liF_Garticl_Rec0      to Barticl.Garticl_Rec0 //˜§¦©ç¤›œ©ž £œ garticl
54409>>>>>>>//                     Move liF_Gmove_Master_Rec0 to Barticl.Gmove_Mrec0  //˜§¦˜ç¤›œ©ž £œ master gmove
54409>>>>>>>//                     Saverecord Barticl
54409>>>>>>>//                End //«â¢¦ª ˜§¦©ç¤›œ©žª barticl ˜§¦ garticl & gmove
54409>>>>>>>//                //****************************************************************************
54409>>>>>>>//                //* ’ „ Š Ž ‘    „ Œ † ‹ „  — ‘ † ‘    ‚ „ Œ ˆ ‰ † ‘    Š Ž ‚ ˆ ‘ ’ ˆ ‰ † ‘ *
54409>>>>>>>//                //****************************************************************************
54409>>>>>>>//                End //if (liMust_Update_Gl > 0) and ...
54409>>>>>>>
54409>>>>>>>
54409>>>>>>>
54409>>>>>>>//                If (liMust_Update_CUSTOMER > 0);
54409>>>>>>>//                Begin
54409>>>>>>>//                //****************************************************************************
54409>>>>>>>//                //*  €  • †    „ Œ † ‹ „  — ‘ † ‘     „ Š € ’ — Œ                         *
54409>>>>>>>//                //****************************************************************************
54409>>>>>>>//                //****************************************************************************
54409>>>>>>>//                //* ’ „ Š Ž ‘    „ Œ † ‹ „  — ‘ † ‘     „ Š € ’ — Œ                        *
54409>>>>>>>//                //****************************************************************************
54409>>>>>>>//                End //if (liMust_Update_CUSTOMER > 0)
54409>>>>>>>
54409>>>>>>>
54409>>>>>>>
54409>>>>>>>//                If (liMust_Update_VENDOR  > 0);
54409>>>>>>>//                Begin
54409>>>>>>>//                //****************************************************************************
54409>>>>>>>//                //*  €  • †    „ Œ † ‹ „  — ‘ † ‘      Ž ‹ † ‡ „ “ ’ — Œ                 *
54409>>>>>>>//                //****************************************************************************
54409>>>>>>>//                //****************************************************************************
54409>>>>>>>//                //* ’ „ Š Ž ‘    „ Œ † ‹ „  — ‘ † ‘      Ž ‹ † ‡ „ “ ’ — Œ                *
54409>>>>>>>//                //****************************************************************************
54409>>>>>>>//                End //if (liMust_Update_VENDOR > 0)
54409>>>>>>>
54409>>>>>>>//      End_Procedure //private.transaction_update_other_modules
54409>>>>>>>
54409>>>>>>>
54409>>>>>>>              //§˜¨'æ¢¦ §¦¬ œå¤˜  ..›ç¤˜£ž, ›â¤ §˜å¦¬¤ › æ«  «˜ §œ›å˜ œå¤˜  display only ! ¡˜  foreign fields
54409>>>>>>>              //Set File_Field_Entry File_Field Barticl.Garticl_Rec0 FALSE to liF_Garticl_Rec0
54409>>>>>>>              //Set File_Field_Entry File_Field Barticl.Gmove_Mrec0  FALSE to liF_Gmove_Master_Rec0
54409>>>>>>>              //Set File_Field_Entry File_Field Barticl.Gplan_Mrec0  FALSE to liF_Gplan_Master_Rec0
54409>>>>>>>
54409>>>>>>>              //Set File_Field_Entry File_Field Bmove.Gmove_Srec0    FALSE to liF_Gmove_Slave_Rec0
54409>>>>>>>              //Set File_Field_Entry File_Field Bmove.Gplan_Srec0    FALSE to liF_Gplan_Slave_Rec0
54409>>>>>>>
54409>>>>>>>              //Set File_Field_Changed_Value File_Field Barticl.Garticl_Rec0 to liF_Garticl_Rec0
54409>>>>>>>               //Set File_Field_Changed_Value File_Field Barticl.Gmove_Mrec0  to liF_Gmove_Master_Rec0
54409>>>>>>>              //Set File_Field_Changed_Value File_Field Barticl.Gplan_Mrec0  to liF_Gplan_Master_Rec0
54409>>>>>>>
54409>>>>>>>               //Set Field_Changed_Value      Field      Bmove.Gmove_Srec0    to liF_Gmove_Slave_Rec0
54409>>>>>>>               //Set Field_Changed_Value      Field      Bmove.Gplan_Srec0    to liF_Gplan_Slave_Rec0
54409>>>>>>>
54409>>>>>>>
54409>>>>>>>               //Forward Send Request_Save
54409>>>>>>>
54409>>>>>>>
54409>>>>>>>
54409>>>>>>>
54409>>>>>>>
54409>>>>>>>//--------------------------------------------------------------------------------
54409>>>>>>>    Procedure Define_Fields
54410>>>>>>>        Forward Send Define_Fields
54412>>>>>>>        //DDB-Generated-Code-Location
54412>>>>>>>        //DDB-DefineFieldStart
54412>>>>>>>
54412>>>>>>>        Set Main_File            To Bmove.File_Number
54413>>>>>>>        Set Cascade_Delete_State To FALSE
54414>>>>>>>
54414>>>>>>>
54414>>>>>>>        // Parent (Server) file structure...............
54414>>>>>>>        Send Add_Server_File  Barticl.File_Number
54415>>>>>>>        Send Add_Server_File  Baxio.File_Number
54416>>>>>>>
54416>>>>>>>        // External (System) file structure.............
54416>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
54417>>>>>>>        Send Add_System_File  Bkinkat.File_Number  DD_LOCK_ON_ALL
54418>>>>>>>        Send Add_System_File  Bsum.File_Number  DD_LOCK_ON_ALL
54419>>>>>>>
54419>>>>>>>        Define_Auto_Increment  Sysrecb.Bmove_Rec0  To Bmove.Bmove_Rec0
54422>>>>>>>
54422>>>>>>>        // Field-based properties.......................
54422>>>>>>>
54422>>>>>>>        // Bmove.Company_Code
54422>>>>>>>
54422>>>>>>>        // Bmove.Branch_Code
54422>>>>>>>
54422>>>>>>>        // Bmove.Year_Year
54422>>>>>>>
54422>>>>>>>        // Bmove.Btypkin_Code
54422>>>>>>>
54422>>>>>>>        // Bmove.Barticl_Hmnia
54422>>>>>>>
54422>>>>>>>        // Bmove.Barticl_No
54422>>>>>>>
54422>>>>>>>        // Bmove.Baxio_Code
54422>>>>>>>
54422>>>>>>>        // Bmove.Barticl_Recr
54422>>>>>>>
54422>>>>>>>        // Bmove.Baxio_Recr
54422>>>>>>>
54422>>>>>>>        // Bmove.Bmove_Rec0
54422>>>>>>>
54422>>>>>>>        // Bmove.Bmove_Recr
54422>>>>>>>
54422>>>>>>>        // Bmove.Bmove_Aa
54422>>>>>>>
54422>>>>>>>        // Bmove.Baxio_Aa
54422>>>>>>>
54422>>>>>>>        // Bmove.Gplan_Srec0
54422>>>>>>>
54422>>>>>>>        // Bmove.Baxio_Pfile
54422>>>>>>>
54422>>>>>>>        // Bmove.Baxio_Pcode
54422>>>>>>>
54422>>>>>>>        // Bmove.Baxio_Pepon
54422>>>>>>>
54422>>>>>>>        // Bmove.Baxio_Ppar
54422>>>>>>>
54422>>>>>>>        // Bmove.Btypkin_Recr
54422>>>>>>>
54422>>>>>>>        // Bmove.Sls_Id
54422>>>>>>>
54422>>>>>>>        // Bmove.Cnt_Id
54422>>>>>>>
54422>>>>>>>        // Bmove.Presp_Id
54422>>>>>>>
54422>>>>>>>        // Bmove.Bmove_M_Code
54422>>>>>>>
54422>>>>>>>        // Bmove.Cmoves_Recr
54422>>>>>>>
54422>>>>>>>        // Bmove.Exei_Enhmerosei
54422>>>>>>>
54422>>>>>>>        // Bmove.Hmnia_Enhmeros
54422>>>>>>>
54422>>>>>>>        //DDB-DefineFieldEnd
54422>>>>>>>
54422>>>>>>>        Set Main_File            To Bmove.File_Number
54423>>>>>>>        Set Cascade_Delete_State To FALSE
54424>>>>>>>
54424>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
54425>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
54426>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
54427>>>>>>>
54427>>>>>>>        // Parent (Server) file structure...............
54427>>>>>>>        Send Add_Server_File  Baxio.File_Number
54428>>>>>>>        Send Add_Server_File  Barticl.File_Number
54429>>>>>>>
54429>>>>>>>        // External (System) file structure.............
54429>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
54430>>>>>>>        Send Add_System_File  Bkinkat.File_Number  DD_LOCK_ON_ALL
54431>>>>>>>        Send Add_System_File  Bsum.File_Number  DD_LOCK_ON_ALL
54432>>>>>>>
54432>>>>>>>        Define_Auto_Increment  Sysrecb.Bmove_Rec0  To Bmove.Bmove_Rec0
54435>>>>>>>
54435>>>>>>>        // Field-based properties.......................
54435>>>>>>>
54435>>>>>>>        // Bmove.Company_Code
54435>>>>>>>
54435>>>>>>>        // Bmove.Branch_Code
54435>>>>>>>
54435>>>>>>>        // Bmove.Year_Year
54435>>>>>>>
54435>>>>>>>        // Bmove.Btypkin_Code
54435>>>>>>>
54435>>>>>>>        // Bmove.Barticl_Hmnia
54435>>>>>>>
54435>>>>>>>        // Bmove.Barticl_No
54435>>>>>>>
54435>>>>>>>        // Bmove.Barticl_Rec0
54435>>>>>>>
54435>>>>>>>        // Bmove.Baxio_Rec0
54435>>>>>>>
54435>>>>>>>        // Bmove.Bmove_Rec0
54435>>>>>>>
54435>>>>>>>        // Bmove.Bmove_Aa
54435>>>>>>>        Set Field_Options          Field Bmove.Bmove_Aa           To DD_DISPLAYONLY
54436>>>>>>>
54436>>>>>>>        // Bmove.Baxio_Aa
54436>>>>>>>        Set Field_Options          Field Bmove.Baxio_Aa           To DD_DISPLAYONLY
54437>>>>>>>
54437>>>>>>>        // Bmove.Gplan_Srec0
54437>>>>>>>        Set Field_Options          Field Bmove.Gplan_Srec0        To DD_DISPLAYONLY
54438>>>>>>>
54438>>>>>>>        // Bmove.Baxio_Pfile
54438>>>>>>>
54438>>>>>>>        // Bmove.Baxio_Pcode
54438>>>>>>>
54438>>>>>>>        // Bmove.Baxio_Pepon
54438>>>>>>>
54438>>>>>>>        // Bmove.Baxio_Ppar
54438>>>>>>>
54438>>>>>>>    End_Procedure    // Define_Fields
54439>>>>>>>
54439>>>>>>>
54439>>>>>>>    Procedure Field_Defaults
54440>>>>>>>        Forward Send Field_Defaults
54442>>>>>>>        //DDB-Generated-Code-Location
54442>>>>>>>        //DDB-FieldDefaultStart
54442>>>>>>>        //DDB-FieldDefaultEnd
54442>>>>>>>    End_Procedure    // Field_Defaults
54443>>>>>>>
54443>>>>>>>End_Class    // Bmove_DataDictionary
54444>>>>>>>//DDB-FileEnd
54444>>>>>    Use NOMISMA.DD
54444>>>>>
54444>>>>>    //AB-IgnoreEnd
54444>>>>>
54444>>>>>    Object bpencmv3 is a BusinessProcessSub
54446>>>>>
54446>>>>>        //AB-StoreTopStart
54446>>>>>        Property String      psModule        Public ''
54448>>>>>        Property String      psBarticleRecr  Public ''
54450>>>>>        Property String      psCmovesRecr    Public ''
54452>>>>>        Property Integer     piWithDeletion  Public  0
54454>>>>>        Property Integer     piLathos        Public  0
54456>>>>>        Property Integer     piTxtID         Public  0
54458>>>>>        Property String      piBarticleRecn  Public  0
54460>>>>>
54460>>>>>
54460>>>>>        ////////////////////////////////////////////////////////////
54460>>>>>        /////////// Extra Data Set Needed For Finding //////////////
54460>>>>>        /////////// Incoming Bmove Record             //////////////
54460>>>>>        ////////////////////////////////////////////////////////////
54460>>>>>
54460>>>>>        Set Status_Panel_State to False
54461>>>>>        //Set Allow_Cancel_State  to True
54461>>>>>        Set Display_Error_State to True
54462>>>>>        //Set Process_Title to "               "
54462>>>>>        //Set Status_Log_id to (status_log(Self)) //Use statlog.pkg
54462>>>>>        //Set Status_log_state to True
54462>>>>>
54462>>>>>        //AB-StoreTopEnd
54462>>>>>
54462>>>>>        Set Size        to 58 88
54463>>>>>        Set Location    to 18 52
54464>>>>>
54464>>>>>        //AB-DDOStart
54464>>>>>
54464>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
54466>>>>>        End_Object    // Ctypkin_DD
54467>>>>>
54467>>>>>        Object Country_DD is a Country_DataDictionary
54469>>>>>        End_Object    // Country_DD
54470>>>>>
54470>>>>>        Object Towns_DD is a Towns_DataDictionary
54472>>>>>            Set DDO_Server to (Country_DD(self))
54473>>>>>        End_Object    // Towns_DD
54474>>>>>
54474>>>>>        Object Cities_DD is a Cities_DataDictionary
54476>>>>>            Set DDO_Server to (Towns_DD(self))
54477>>>>>        End_Object    // Cities_DD
54478>>>>>
54478>>>>>        Object Payresp_DD is a Payresp_DataDictionary
54480>>>>>        End_Object    // Payresp_DD
54481>>>>>
54481>>>>>        Object Areas_DD is a Areas_DataDictionary
54483>>>>>        End_Object    // Areas_DD
54484>>>>>
54484>>>>>        Object Clients_DD is a Clients_DataDictionary
54486>>>>>            Set DDO_Server to (Cities_DD(self))
54487>>>>>            Set DDO_Server to (Payresp_DD(self))
54488>>>>>            Set DDO_Server to (Areas_DD(self))
54489>>>>>        End_Object    // Clients_DD
54490>>>>>
54490>>>>>        Object Cmoves_DD is a Cmoves_DataDictionary
54492>>>>>            Set DDO_Server  to (Ctypkin_DD(self))
54493>>>>>            Set DDO_Server  to (Clients_DD(self))
54494>>>>>            Set piFromBP    to 1
54495>>>>>        End_Object    // Cmoves_DD
54496>>>>>
54496>>>>>        Object Cflagkin_DD is a Cflagkin_DataDictionary
54498>>>>>            Set DDO_Server to (Ctypkin_DD(self))
54499>>>>>        End_Object    // Cflagkin_DD
54500>>>>>
54500>>>>>        Object Btypkin_DD is a Btypkin_DataDictionary
54502>>>>>        End_Object    // Btypkin_DD
54503>>>>>
54503>>>>>        Object Baxiokat_DD is a Baxiokat_DataDictionary
54505>>>>>        End_Object    // Baxiokat_DD
54506>>>>>
54506>>>>>        Object Barticl_DD is a Barticl_DataDictionary
54508>>>>>            Set DDO_Server to (Btypkin_DD(self))
54509>>>>>        End_Object    // Barticl_DD
54510>>>>>
54510>>>>>        Object Baxio_DD is a Baxio_DataDictionary
54512>>>>>            Set DDO_Server to (Baxiokat_DD(self))
54513>>>>>        End_Object    // Baxio_DD
54514>>>>>
54514>>>>>        Object Bmove_DD is a Bmove_DataDictionary
54516>>>>>            Set DDO_Server to (Barticl_DD(self))
54517>>>>>            Set DDO_Server to (Baxio_DD(self))
54518>>>>>            Set Constrain_File to Barticl.File_Number
54519>>>>>        End_Object    // Bmove_DD
54520>>>>>
54520>>>>>        Object Nomisma_DD is a Nomisma_DataDictionary
54522>>>>>        End_Object    // Nomisma_DD
54523>>>>>
54523>>>>>        //AB-DDOEnd
54523>>>>>
54523>>>>>
54523>>>>>        //AB-StoreStart
54523>>>>>
54523>>>>>        Function fiDelete_Cmoves_Record String asRecr Integer aiDelete Returns Integer
54525>>>>>            Integer rVal iErr
54526>>>>>            Move 0 to rVal
54527>>>>>            Send Clear to Cmoves_DD
54528>>>>>            Move asRecr to Cmoves.Cmoves_Recr
54529>>>>>            Send Find to Cmoves_DD eq 2 //Cmoves:Index.2:Cmoves_Recr
54530>>>>>            If (Found=1) Begin
54532>>>>>                If (aiDelete) Begin
54534>>>>>                    Send UpdateWait to (Wait(Self))  ('ƒ ˜š¨˜­ã ‰å¤ž©žª '+(String(Cmoves.Recnum)))
54535>>>>>                    Send Request_Delete to Cmoves_DD
54536>>>>>                End
54536>>>>>>
54536>>>>>            End
54536>>>>>>
54536>>>>>            Else Begin
54537>>>>>                Move 60003 to rVal
54538>>>>>                // If From Deletion and Could not find Cmoves with Barticle_Cmoves_Recr set piLathos
54538>>>>>                If (aiDelete) error 6003 "ƒœ¤ ™¨âŸž¡œ Cmoves £œ «¦ Cmoves Recr «¦¬ §˜¨˜©«˜« ¡¦ç"
54541>>>>>            End
54541>>>>>>
54541>>>>>            Function_Return rVal
54542>>>>>        End_Function
54543>>>>>
54543>>>>>        Procedure Deal_With_Barticle
54545>>>>>            Integer iErr isClosed iInt iWithDeletion iSign iClient iID iMustSaveClientYpoloipa
54546>>>>>            Integer iEpireazeiAxies iMustEnhmWitemcl  iEpireazeiPosothtes iAntistrofhProshmou iBmoveRec0
54546>>>>>            Integer iOneWflag iiPartlNO iExitFlag iMustSaveWCmoves iExeiSxetika iBmoveRecnum iMustSaveEpisf
54546>>>>>            Integer iMustSaveCmoves iMustSaveClient iMyf iInt2 iOneCflag iAnti iiBarticleNO iMustsaveofeilh
54546>>>>>
54546>>>>>            String  ssPtypparDescr ssSeiraDescr sWCmovesRecr sRecr2 ssPtypparDescrShort sPelaths
54546>>>>>            String  sRecr sParticle_CmovesRecr sCtypkinRecr sCn_Code sSls_ID sCnt_ID sPresp_ID
54546>>>>>            String  sClientRecr sCmovesRecr sNomisma sFlag sWtypkinRecr sItem sLocked sModule
54546>>>>>            String  sWitemxRecr sWaxRecr sClientID sPerigrafh sParticle_WCmovesRecr ssBtypkinDescrShort
54546>>>>>
54546>>>>>            Number  nVatam nGenAm nExtra nPayam nDiscAm nIsotimia nUnitPrice nGSynolo
54546>>>>>            Number  nTotAmBd nTotDiscPms nTotDiscPC nTotAmAd nActualXreosh nActualPistosh
54546>>>>>            Number  nAthr1 nAthr2 nAthr3 nAthr4 nAthr5 nAthr6 nParastXreosh nParastPistosh
54546>>>>>            Number  nPoso nXre nPis nMyf nPosothta nAthr7 nAthr8 nPosothtaFinal nXreFinal nPisFinal
54546>>>>>            Number  nApait nEpitPoso nofeilh nofeilhpayresp napaitpayresp
54546>>>>>            Date    dHmnia dLastPis dLastXre dLastXreParast dLastPisParast
54546>>>>>
54546>>>>>            Number nQtyEisFinal nQtyExFinal nQtyEis nQtyEx nJS
54546>>>>>
54546>>>>>
54546>>>>>            Get psBarticleRecr  to sRecr
54547>>>>>            Move (Trim(sRecr))  to sRecr
54548>>>>>            Send Clear          to Barticl_DD
54549>>>>>            Move srecr          to Barticl.Barticl_Recr
54550>>>>>            Send Find to Barticl_DD Eq 2 // Barticl:Index.2:Barticl_Recr
54551>>>>>// todo: 25/06/2002 Logo tou find ktypaei to gamhmeno mhnyma otan kleinei h efarmogh
54551>>>>>// omos kammia allagh me opoiadhpote tropopoihsh tou kodika, eite kanoume manual find prota,
54551>>>>>// eite find_by_recnum. Opoiadhpote find mh procedural ektelestei exei to idio apotelesma
54551>>>>>
54551>>>>>//          Send Find_By_Recnum to Barticl_DD Barticl.File_Number (piBarticleRecn(Self))
54551>>>>>
54551>>>>>            If (Found=1) Begin
54553>>>>>                Get Field_Current_Value Of Btypkin_DD Field Btypkin.Btypkin_anti1   to iAnti
54554>>>>>                Get Field_Current_Value Of Barticl_DD Field Barticl.Barticl_Ekleise to isClosed
54555>>>>>                Get Field_Current_Value Of Barticl_DD Field Barticl.CN_Code         to sCN_Code
54556>>>>>
54556>>>>>                If (isClosed) Begin
54558>>>>>                    Move 0 to iExitFlag
54559>>>>>
54559>>>>>                    Send Find To Bmove_DD First_Record 3 //Bmoves:Index.3:Barticl_Recr + Bmove_Rec0
54560>>>>>                    While ((Found=1) And (iExitFlag=0))
54564>>>>>                        Get Field_Current_Value Of Bmove_DD Field Bmove.Cmoves_Recr to sRecr2
54565>>>>>                        Move (Trim(sRecr2)) to sRecr2
54566>>>>>                        If (Not(sRecr2='')) Move (fiDelete_Cmoves_Record(Self,sRecr2,1))  to iInt2
54569>>>>>                        Else                Move 0 to iInt2
54571>>>>>
54571>>>>>                        Send Clear to Ctypkin_DD
54572>>>>>                        Get Field_Current_Value Of Btypkin_DD Field Btypkin.Ctypkin_Recr to sCtypkinRecr
54573>>>>>                        Move 0 to iMustSaveEpisf
54574>>>>>                        Clear Cflagkin
54575>>>>>                        Move sCtypkinRecr to Cflagkin.Ctypkin_Recr
54576>>>>>                        Find Gt Cflagkin By Index.5 // Cflagkin:Index.5:Ctypkin_Recr+Flag_Numeric+Cflagkin_Recr
54577>>>>>>
54577>>>>>                        While ((Found=1) And (sCtypkinRecr=Cflagkin.Ctypkin_Recr))
54581>>>>>                            Move Cflagkin.Cflagkin_Flag to sFlag
54582>>>>>                            Move (Trim(sFlag)) to sFlag
54583>>>>>                                 If (sFlag='60') Move 1 to iMustSaveEpisf   // Enhmeronei Episfalh Posa Thetika
54586>>>>>                            Else If (sFlag='61') Move 2 to iMustSaveEpisf   // Enhmeronei Episfalh Posa Arnhtika
54590>>>>>                            Else If (sflag='66') Move 1 to iMustsaveofeilh  // enhmerovnei synolikh ofeilh
54594>>>>>                            Find Gt Cflagkin By Index.5 // Cflagkin:Index.5:Ctypkin_Recr+Flag_Numeric+Cflagkin_Recr
54595>>>>>>
54595>>>>>                        Loop
54596>>>>>>
54596>>>>>
54596>>>>>                        If ((iMustSaveEpisf<>0) or (imustsaveofeilh<>0)) Begin
54598>>>>>                            Move 0  to nApait
54599>>>>>                            Move 0  to nEpitPoso
54600>>>>>                            Move 0  to nofeilh
54601>>>>>                            Move 0  to nofeilhpayresp
54602>>>>>                            Move 0  to napaitpayresp
54603>>>>>                            Move '' to sPelaths
54604>>>>>
54604>>>>>                            //Get field_current_value of Baxio_dd field Baxio.Baxio_V0            to nEpitPoso
54604>>>>>                            Get field_current_value of Baxio_dd field Baxio.Baxio_V2            to nEpitPoso
54605>>>>>                            Get field_current_value of Baxio_dd field Baxio.Baxio_Code_In       to sPelaths
54606>>>>>
54606>>>>>                            // js 13/03/2003 Giati oi apografikes xreoseis pou kataxorountai apo
54606>>>>>                            // ta axiografa ?? exoun keno ayto to pedio apo thn klash tou baxio
54606>>>>>                            // Elegxetai to pedio Baxiokat.Baxiokat_Type  opou an einai 2 (Xreosh)
54606>>>>>                            // mhdenizei to pedio tou pelath Baxio.Baxio_Code_In
54606>>>>>                            If (Trim(sPelaths)='') Get field_current_value of Barticl_dd field Barticl.Barticl_code1 to sPelaths
54609>>>>>                            // js 13/03/2003
54609>>>>>
54609>>>>>                            Send Clear to Clients_DD
54610>>>>>                            Move (Trim(sPelaths)) to Clients.Client_ID
54611>>>>>                            Send Find to Clients_DD Eq 6 // Clients:index.6:Client_ID
54612>>>>>                            If (Found=1) Begin
54614>>>>>                                Get field_current_value of clients_dd field clients.Poso_Se_Apait   to nApait
54615>>>>>                                Get field_current_value of payresp_dd field payresp.Poso_Se_Apait   to nApaitpayresp
54616>>>>>                                Get field_current_value of clients_dd field clients.synolikh_ofeilh to nofeilh
54617>>>>>                                Get field_current_value of payresp_dd field payresp.synolikh_ofeilh to nofeilhpayresp
54618>>>>>
54618>>>>>                                If (iMustSaveofeilh=1)  Begin
54620>>>>>//                                    Set Field_Changed_Value of clients_dd field clients.synolikh_ofeilh to (nepitposo+nofeilh)
54620>>>>>//                                    Send Request_Save to Clients_DD
54620>>>>>//                                    Set Field_Changed_Value of payresp_dd field payresp.synolikh_ofeilh to (nepitposo+nofeilhpayresp)
54620>>>>>//                                    Send Request_Save to payresp_DD
54620>>>>>                                    If (Baxiokat.Baxiokat_Type = 2) Begin
54622>>>>>                                        Set Field_Changed_Value of clients_dd field clients.synolikh_ofeilh to (nofeilh-nepitposo)
54623>>>>>                                        Send Request_Save to Clients_DD
54624>>>>>                                        Set Field_Changed_Value of payresp_dd field payresp.synolikh_ofeilh to (nofeilhpayresp-nepitposo)
54625>>>>>                                        Send Request_Save to payresp_DD
54626>>>>>                                    End
54626>>>>>>
54626>>>>>                                    Else Begin
54627>>>>>                                        Set Field_Changed_Value of clients_dd field clients.synolikh_ofeilh to (nofeilh+nepitposo)
54628>>>>>                                        Send Request_Save to Clients_DD
54629>>>>>                                        Set Field_Changed_Value of payresp_dd field payresp.synolikh_ofeilh to (nofeilhpayresp+nepitposo)
54630>>>>>                                        Send Request_Save to payresp_DD
54631>>>>>                                    End
54631>>>>>>
54631>>>>>                                End
54631>>>>>>
54631>>>>>
54631>>>>>                                If (iMustSaveEpisf=1)  Begin
54633>>>>>                                    Sub nEpitPoso from nApait
54634>>>>>                                    Set Field_Changed_Value of clients_dd field clients.Poso_Se_Apait to nApait
54635>>>>>                                    Send Request_Save to Clients_DD
54636>>>>>                                    Sub nepitposo from napaitpayresp
54637>>>>>                                    Set Field_Changed_Value of payresp_dd field payresp.Poso_Se_Apait to nApaitpayresp
54638>>>>>                                    Send Request_Save to payresp_DD
54639>>>>>                                End
54639>>>>>>
54639>>>>>                                Else If (iMustSaveEpisf=2)  Begin
54642>>>>>                                    Sub (nEpitPoso*(-1)) to nApait
54643>>>>>                                    Set Field_Changed_Value of clients_dd field clients.Poso_Se_Apait to nApait
54644>>>>>                                    Send Request_Save to Clients_DD
54645>>>>>                                    Sub (nEpitPoso*(-1)) to nApaitpayresp
54646>>>>>                                    Set Field_Changed_Value of payresp_dd field payresp.Poso_Se_Apait to nApaitpayresp
54647>>>>>                                    Send Request_Save to payresp_DD
54648>>>>>                                End
54648>>>>>>
54648>>>>>                            End
54648>>>>>>
54648>>>>>                            Else Begin
54649>>>>>                            End
54649>>>>>>
54649>>>>>                        End
54649>>>>>>
54649>>>>>
54649>>>>>                        If (iInt2<>0) Move iInt2 to iExitFlag
54652>>>>>                        Else Begin
54653>>>>>                            Send UpdateWait to (Wait(Self)) ('„¤ž£œ¨à©ž ‰å¤ž©žª '+(String(Bmove.Recnum)))
54654>>>>>                            Set Field_Changed_Value Of Bmove_DD Field Bmove.Cmoves_Recr to ''
54655>>>>>                            Send Request_Save to Bmove_DD
54656>>>>>                        End
54656>>>>>>
54656>>>>>                        Send Find To Bmove_DD Next_Record 3 //Bmoves:Index.3:Barticl_Recr + Bmove_Rec0
54657>>>>>                    Loop
54658>>>>>>
54658>>>>>
54658>>>>>
54658>>>>>
54658>>>>>                    If (iExitFlag) Move iExitFlag   to iInt2
54661>>>>>                    Else           Move 0           to iInt2
54663>>>>>
54663>>>>>                    If (Not(iInt2)) Begin
54665>>>>>                        // €¤ ›œ¤ ®«¬§ž©œ ¢˜Ÿ¦ª ¡˜«˜ «ž¤ › ˜š¨˜­ž ¡˜  › œš¨˜­œ  ©à©«˜ «¦ Cmoves ¡˜  «¦ Wcmoves record
54665>>>>>                        // «¦«œ ¡˜Ÿ˜¨ ¦¬£œ «¦ Barticle ˜§¦ ©ž£á› ˜ Cmoves kai Wcmoves
54665>>>>>                        // ¡˜  ¥œ£˜¨¡˜¨¦¬£œ «¦ record Barticle àª ‹† ‰¢œ ©«æ §¢â¦¤
54665>>>>>                        Set Field_Changed_Value Of Barticl_DD Field Barticl.Cmoves_Recr         to ''
54666>>>>>                        Set Field_Changed_Value Of Barticl_DD Field Barticl.Barticl_Ekleise     to ''
54667>>>>>                        Send Request_Save to Barticl_DD
54668>>>>>                        //Send info_box "’¦ §˜¨˜©«˜« ¡æ œå¤˜  «é¨˜ ˜¤¦ ®«æ.\n„§ «¨â§œ«œ ž «¨¦§¦§¦åž©ž «¦¬" '¢ž¨¦­¦¨å˜'
54668>>>>>                    End
54668>>>>>>
54668>>>>>                    Else Begin
54669>>>>>                        // •«¬§ž©œ ¢˜Ÿ¦ª ©«ž¤ › ˜š¨˜­ž WCmoves
54669>>>>>                        error 6111 "ƒœ¤ ™¨âŸž¡œ Cmoves š ˜ › ˜š¨˜­ã"
54670>>>>>>
54670>>>>>                    End
54670>>>>>>
54670>>>>>
54670>>>>>                End
54670>>>>>>
54670>>>>>                //// IF IS NOT CLOSED (Barticle)
54670>>>>>                Else Begin
54671>>>>>                    Integer iiRecn
54671>>>>>                    Move 0 to iExitFlag
54672>>>>>                    Send Clear To Bmove_DD
54673>>>>>                    Send Find To Bmove_DD First_Record 3 //Bmove:Index.3:Barticl_Recr+Bmove_Rec0
54674>>>>>                    While ((Found=1) And (iExitFlag=0))
54678>>>>>                        Get Field_Current_Value Of Bmove_DD Field Bmove.Recnum to iiRecn
54679>>>>>                        Move 0 to iInt
54680>>>>>                        Get Field_Current_Value Of Bmove_DD Field Bmove.Cmoves_Recr to sRecr2
54681>>>>>                        Move (Trim(sRecr2)) to sRecr2
54682>>>>>                        If (Not(sRecr2='')) Begin
54684>>>>>                            Move (fiDelete_Cmoves_Record(Self,sRecr2,0))  to iInt
54685>>>>>                            If (iInt<>60003) Move 1 to iExitFlag
54688>>>>>                        End
54688>>>>>>
54688>>>>>                        Send Find To Bmove_DD Next_Record 3
54689>>>>>                        Send UpdateWait to (Wait(Self)) ('„¤ž£œ¨à©ž ‰å¤ž©žª '+(String(Bmove.Recnum)))
54690>>>>>                    Loop
54691>>>>>>
54691>>>>>
54691>>>>>                    If (iExitFlag) Begin
54693>>>>>                        error 6100  "Found Cmoves Record on Open Barticl"
54694>>>>>>
54694>>>>>                    End
54694>>>>>>
54694>>>>>
54694>>>>>        ///////////////////////////// SOS ///////
54694>>>>>        ///////////////////////////  ENHMEROSH FLAGS APO WFLAGKIN <ARXH>  //////////////////////////////
54694>>>>>        //////////////////////////jsjsjsjsjsjsjsjs
54694>>>>>
54694>>>>>                    Send Find To Bmove_DD First_Record 3 // Bmove:Index.2:Bmove_Recr
54695>>>>>
54695>>>>>                    While (Found=1)
54699>>>>>
54699>>>>>                        Send Clear to Ctypkin_DD
54700>>>>>                        Send Clear to Cflagkin_DD
54701>>>>>                        Send Clear to Clients_DD
54702>>>>>                        Send Clear to Cmoves_DD
54703>>>>>
54703>>>>>                        Get Field_Current_Value Of Btypkin_DD   Field Btypkin.Ctypkin_Recr  to sCtypkinRecr
54704>>>>>                        Get Field_Current_Value Of Barticl_DD   Field Barticl.Client_Mrecr  to sClientRecr
54705>>>>>                        move sclientrecr to clients.client_recr
54706>>>>>                        Send Find to Clients_DD eq 2 //Clients:Index.2:Client_Recr
54707>>>>>
54707>>>>>                        If (Not(Found)) Begin
54709>>>>>                            If ((iAnti=2) Or (iAnti=3)) error 5005 "Client record not found"
54712>>>>>                             ///// Else Goto Skip_All_Ctypkin
54712>>>>>                            ///// @@##@@ 21/12/2001 yannis
54712>>>>>                            ///// h allagh ayth egine gia na mporoume na enhmeronoume
54712>>>>>                            ///// kartella pelath apo episfalh posa opote kai prepei
54712>>>>>                            ///// na diabazei ta cflags
54712>>>>>                        End
54712>>>>>>
54712>>>>>
54712>>>>>                        Move sCtypkinRecr to Ctypkin.Ctypkin_Recr
54713>>>>>                        Send Find to Ctypkin_DD eq 2 //Ctypkin:Index.2:Client_Recr
54714>>>>>                        If (Not(Found)) error 5006 "Ctypkin record not found"
54717>>>>>                        Get Field_Current_Value Of Barticl_DD   Field Barticl.Barticl_Hmnia     to dHmnia
54718>>>>>                        Get Field_Current_Value Of Barticl_DD   Field Barticl.Barticl_Aitiol    to sPerigrafh
54719>>>>>            //                    Get Field_Current_Value Of Barticl_DD   Field Barticl.Isotimia          to nIsotimia
54719>>>>>                        Get Field_Current_Value Of Ctypkin_DD   Field Ctypkin.Ctypkin_Module    to sModule
54720>>>>>                        Get Field_Current_Value Of Barticl_DD   Field Barticl.Sls_ID            to sSls_ID
54721>>>>>                        Get Field_Current_Value Of Barticl_DD   Field Barticl.Cnt_ID            to sCnt_ID
54722>>>>>                        Get Field_Current_Value Of Barticl_DD   Field Barticl.Presp_ID          to sPresp_ID
54723>>>>>
54723>>>>>                        Move 1 to iSign // Always 'Update'
54724>>>>>                        Move 0 to iOneCflag
54725>>>>>                        Move 0 to iMustSaveCmoves
54726>>>>>                        Move 0 to iMustSaveClient
54727>>>>>                        Move 0 to iMustSaveClientYpoloipa
54728>>>>>                        Move 0 to iMustSaveEpisf
54729>>>>>                        Move 0 to iAntistrofhProshmou
54730>>>>>                        Move 0 to imustsaveofeilh
54731>>>>>
54731>>>>>                        Send UpdateWait to (Wait(Self)) ('„¤ž£œ¨à©ž ‰å¤ž©žª '+(String(Bmove.Recnum)))
54732>>>>>
54732>>>>>                        Move 0 to iOneWflag
54733>>>>>                        Move 0 to iMustSaveWCmoves
54734>>>>>                        Move 0 to nPosothtaFinal
54735>>>>>                        Move 0 to nXreFinal
54736>>>>>                        Move 0 to nPisFinal
54737>>>>>                        Move 0 to iEpireazeiAxies
54738>>>>>                        Move 0 to iEpireazeiPosothtes
54739>>>>>                        Move 0 to nXre
54740>>>>>                        Move 0 to nPis
54741>>>>>                        Move 0 to nQtyEis
54742>>>>>                        Move 0 to nQtyEx
54743>>>>>                        Move 0 to iMustEnhmWitemcl
54744>>>>>
54744>>>>>                        Get Field_Current_Value Of Baxio_DD   Field Baxio.Baxio_C_Code2  to sNomisma
54745>>>>>                        Move (Trim(sNomisma))   to sNomisma
54746>>>>>                        Move sNomisma to Nomisma.Nomisma_Code
54747>>>>>                        Send Find to Nomisma_DD eq 1 //Nomisma:Index.1:Nomisma_Code
54748>>>>>                        If (Not(Found)) Begin
54750>>>>>                            error 20000 "ƒœ¤ ™¨âŸž¡œ «¦ ¤æ£ ©£˜"
54751>>>>>>
54751>>>>>                        End
54751>>>>>>
54751>>>>>
54751>>>>>                        Get Field_Current_Value Of Baxio_DD     Field Baxio.Baxio_V2        to nPoso
54752>>>>>                        Get Field_Current_Value Of Barticl_DD   Field Barticl.Barticl_Hmnia to dHmnia
54753>>>>>                        Move 1                                                              to nPosothta
54754>>>>>
54754>>>>>                        Move 0 to iAntistrofhProshmou
54755>>>>>
54755>>>>>                        Clear Cflagkin
54756>>>>>                        Move sCtypkinRecr           to Cflagkin.Ctypkin_Recr
54757>>>>>                        Find Gt Cflagkin By Index.5 // Cflagkin:Index.5:Ctypkin_Recr+Flag_Numeric+Cflagkin_Recr
54758>>>>>>
54758>>>>>
54758>>>>>                        While ((Found=1) And (sCtypkinRecr=Cflagkin.Ctypkin_Recr))
54762>>>>>
54762>>>>>                            Move 1 to iOneCflag
54763>>>>>                            Move Cflagkin.Cflagkin_Flag to sFlag
54764>>>>>                            Move (Trim(sFlag)) to sFlag
54765>>>>>
54765>>>>>                            Case Begin
54765>>>>>                                Case (sFlag='1')
54767>>>>>                                    Move 1 to iMustSaveCmoves
54768>>>>>                                Case Break
54769>>>>>                                Case (sFlag='2') // Antistrofh Proshmou
54772>>>>>                                    Move (nPoso*iSign*(-1)) to nPoso
54773>>>>>                                    Move 1 to iAntistrofhProshmou
54774>>>>>                                Case Break
54775>>>>>                                Case (sFlag='3') // Epireazei xreoseis
54778>>>>>                                    Move (nPoso*iSign)  to nXre
54779>>>>>                                    Move 0              to nPis
54780>>>>>                                Case Break
54781>>>>>                                Case (sFlag='4') // Epireazei pistoseis
54784>>>>>                                    Move (nPoso*iSign)  to nPis
54785>>>>>                                    Move 0              to nXre
54786>>>>>                                Case Break
54787>>>>>                                Case (sFlag='5') // Epireazei Hmeromhnies
54790>>>>>                                    Move 1 to iMustSaveClient
54791>>>>>                                    If (nXre<>0) Begin
54793>>>>>                                        Move dHmnia to dLastXre
54794>>>>>                                        Move dHmnia to dLastXreParast
54795>>>>>                                        Move ''     to dLastPis
54796>>>>>                                        Move ''     to dLastPisParast
54797>>>>>                                    End
54797>>>>>>
54797>>>>>                                    Else If (nPis<>0) Begin
54800>>>>>                                        Move dHmnia to dLastPis
54801>>>>>                                        Move dHmnia to dLastPisParast
54802>>>>>                                        Move ''     to dLastXre
54803>>>>>                                        Move ''     to dLastXreParast
54804>>>>>                                    End
54804>>>>>>
54804>>>>>                                Case Break
54805>>>>>                                Case (sFlag='6') // Epireazei Hmeromhnia teleytaias paraggelias
54808>>>>>                                Case Break
54809>>>>>                                Case (sFlag='7') // Epireazei ekkremh axiografa
54812>>>>>                                Case Break
54813>>>>>                                Case (sFlag='8') // Epireazei Diamartyrhmena
54816>>>>>                                Case Break
54817>>>>>                                Case (sFlag='9') // Epireazei Tziro
54820>>>>>                                Case Break
54821>>>>>                                Case (sFlag='10') // Epireazei Apografh xreoshs
54824>>>>>                                Case Break
54825>>>>>                                Case (sFlag='11') // Epireazei Apografh Pistosh
54828>>>>>                                Case Break
54829>>>>>                                Case (sFlag='12') // Symmetoxh se MYF (Plythos)
54832>>>>>                                    Move iSign to iMyf
54833>>>>>                                Case Break
54834>>>>>                                Case (sFlag='13') // Symmetoxh se MYF (Axia)
54837>>>>>                                    Move (nPoso*iSign)  to nMyf
54838>>>>>                                Case Break
54839>>>>>                                Case (sFlag='14') // Axies se Xeno sma
54842>>>>>                                    // Blepe sxetika erothmata sthn arxh ths procedure
54842>>>>>                                Case Break
54843>>>>>                                Case (sFlag='15') // Aytomath dhmiourgia axiografou
54846>>>>>                                Case Break
54847>>>>>                                Case (sFlag='16') // Allagh XreoPistoshs me antistrofh proshmou
54850>>>>>                                    If (nXre<>0) Begin
54852>>>>>                                        Move (nXre*(-1))    to nPis
54853>>>>>                                        Move 0              to nXre
54854>>>>>                                    End
54854>>>>>>
54854>>>>>                                    Else If (nPis<>0) Begin
54857>>>>>                                        Move (nPis*(-1))    to nXre
54858>>>>>                                        Move 0              to nPis
54859>>>>>                                    End
54859>>>>>>
54859>>>>>                                Case Break
54860>>>>>                                Case (sFlag='17') // Afairei apo Myf (akyrotika)
54863>>>>>                                    // Thelei exhghsh ti shmainei 'afairei' ?
54863>>>>>                                    // apo posothta? apo axia? apo allou?
54863>>>>>                                Case Break
54864>>>>>                                Case (sFlag='23') // Athroisths 1
54867>>>>>                                    Move (nPoso*iSign) to nAthr1
54868>>>>>                                Case Break
54869>>>>>                                Case (sFlag='24') // Athroisths 2
54872>>>>>                                    Move (nPoso*iSign) to nAthr2
54873>>>>>                                Case Break
54874>>>>>                                Case (sFlag='25') // Athroisths 3
54877>>>>>                                    Move (nPoso*iSign) to nAthr3
54878>>>>>                                Case Break
54879>>>>>                                Case (sFlag='26') // Athroisths 4
54882>>>>>                                    Move (nPoso*iSign) to nAthr4
54883>>>>>                                Case Break
54884>>>>>                                Case (sFlag='27') // Athroisths 5
54887>>>>>                                    Move (nPoso*iSign) to nAthr5
54888>>>>>                                Case Break
54889>>>>>                                Case (sFlag='28') // Athroisths 6
54892>>>>>                                    Move (nPoso*iSign) to nAthr6
54893>>>>>                                Case Break
54894>>>>>                                Case (sFlag='29') // Athroisths 7
54897>>>>>                                    Move (nPoso*iSign) to nAthr7
54898>>>>>                                Case Break
54899>>>>>                                Case (sFlag='30') // Athroisths 8
54902>>>>>                                    Move (nPoso*iSign) to nAthr8
54903>>>>>                                Case Break
54904>>>>>
54904>>>>>                                Case (sFlag='60') // Enhmeronei Episfalh Posa Thetika
54907>>>>>                                    Move 1 to iMustSaveEpisf
54908>>>>>                                Case Break
54909>>>>>
54909>>>>>                                Case (sFlag='61') // Enhmeronei Episfalh Posa Arnhtika
54912>>>>>                                    Move 2 to iMustSaveEpisf
54913>>>>>                                Case Break
54914>>>>>
54914>>>>>                                Case (sFlag='66') // Enhmeronei synolikh ofeilh
54917>>>>>                                    Move 1 to iMustSaveofeilh
54918>>>>>                                Case Break
54919>>>>>
54919>>>>>
54919>>>>>                                Case (sFlag='99') // Enhmeronei Ypoloipa
54922>>>>>                                    Move 1 to iMustSaveClientYpoloipa
54923>>>>>                                Case Break
54924>>>>>
54924>>>>>                            Case End
54924>>>>>                            Find Gt Cflagkin By Index.5 // Cflagkin:Index.5:Ctypkin_Recr+Flag_Numeric+Cflagkin_Recr
54925>>>>>>
54925>>>>>                        Loop
54926>>>>>>
54926>>>>>
54926>>>>>
54926>>>>>                        If ((iOneCflag) And (iMustSaveCmoves)) Begin
54928>>>>>
54928>>>>>                            If (nXre<>0) Begin
54930>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_Axia   to nXre
54931>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x0 ;                                    to (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Code0,dHmnia,nIsotimia))
54932>>>>>                                Move (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Code0,dHmnia,nIsotimia)) to nParastXreosh
54933>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x00 ;                                    to (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Code00,dHmnia,nIsotimia))
54934>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x1 ;                                    to (fngConvertPoso(sNomisma,nXre,SysCurXr.C_CodeR,dHmnia,nIsotimia))
54935>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x2     to nXre
54936>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p0     to 0
54937>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p00    to 0
54938>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p1     to 0
54939>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p2     to 0
54940>>>>>                                Move 0 to nParastPistosh
54941>>>>>                            End
54941>>>>>>
54941>>>>>                            Else If (nPis<>0) Begin
54944>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_Axia   to nPis
54945>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p0 ;                                    to (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Code0,dHmnia,nIsotimia))
54946>>>>>                                Move (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Code0,dHmnia,nIsotimia)) to nParastPistosh
54947>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p00 ;                                    to (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Code00,dHmnia,nIsotimia))
54948>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p1 ;                                    to (fngConvertPoso(sNomisma,nPis,SysCurXr.C_CodeR,dHmnia,nIsotimia))
54949>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p2     to nPis
54950>>>>>
54950>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x0     to 0
54951>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x00    to 0
54952>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x1     to 0
54953>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x2     to 0
54954>>>>>                                Move 0 to nParastXreosh
54955>>>>>                            End
54955>>>>>>
54955>>>>>                            Set Field_Changed_Value Of Cmoves_DD    Field Cmoves.Cmoves_Hmnia   to dHmnia
54956>>>>>                            Set Field_Changed_Value Of Cmoves_DD    Field Cmoves.Barticl_Recr   to sRecr
54957>>>>>                            Set Field_Changed_Value Of Cmoves_DD    Field Cmoves.CN_Code        to (Trim(sCN_Code))
54958>>>>>
54958>>>>>                            // jsjsjsjs 28/01/2001 Hard Coded tou kerata to nomisma eggrafhs = 'GRD'
54958>>>>>                            Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_SC_Code2   to (Trim(sNomisma))
54959>>>>>                            Get Field_Current_Value Of Btypkin_DD  Field Btypkin.Btypkin_Abr    to ssBtypkinDescrShort
54960>>>>>                            Get Field_Current_Value Of Barticl_DD  Field Barticl.Barticl_No     to iiBarticleNO
54961>>>>>                            Move '' to sPerigrafh
54962>>>>>                            Move (Append(sPerigrafh,('*'+(Trim(ssBtypkinDescrShort))+'  '+ ;                                                    (String(iiBarticleNO))+ '*'))) to sPerigrafh
54963>>>>>                            //
54963>>>>>                            Set Field_Changed_Value Of Cmoves_DD    Field Cmoves.Cmoves_Par     to (Trim(sPerigrafh))
54964>>>>>
54964>>>>>                            //////////////////////////////////////////////////////////////////////////////
54964>>>>>                            // jsjsjsjs 06/02/2001 ©¬£§¢ž¨à¤¦¤«˜  «˜ §˜¨˜¡˜«à §œ› ˜
54964>>>>>                            //                     £œ «¦  › ¦ §¦©¦ š ˜ ¢¦š¦¬ª reportin ˜¥ ¦š¨˜­à¤
54964>>>>>                            //////////////////////////////////////////////////////////////////////////////
54964>>>>>                            Get Field_Current_Value Of Cmoves_DD Field Cmoves.Cmoves_Axia to nJS
54965>>>>>
54965>>>>>
54965>>>>>                            If (iAntistrofhProshmou)    Move (-1) to iSign
54968>>>>>                            Else                        Move   1  to iSign
54970>>>>>
54970>>>>>                            Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmove_TotAmBd0    ;                                to ((fngConvertPoso(sNomisma,nJS,SysCurXr.C_Code0,dHmnia,nIsotimia))*iSign)
54971>>>>>                            Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmove_TotAmBd00   ;                                to ((fngConvertPoso(sNomisma,nJS,SysCurXr.C_Code00,dHmnia,nIsotimia))*iSign)
54972>>>>>                            Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmove_TotAmBd1    ;                                to ((fngConvertPoso(sNomisma,nJS,SysCurXr.C_CodeR,dHmnia,nIsotimia))*iSign)
54973>>>>>                            //////////////////////////////////////////////////////////////////////////////
54973>>>>>                            //////////////////////////////////////////////////////////////////////////////
54973>>>>>
54973>>>>>
54973>>>>>                            Set Field_Changed_Value Of Cmoves_DD   Field Cmoves.Module_From  to (trim(sModule))
54974>>>>>
54974>>>>>                            Get field_current_value of clients_dd field clients.recnum to iclient
54975>>>>>
54975>>>>>                            If (iClient) Begin
54977>>>>>                                If (iMustSaveClientYpoloipa =1)  Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Enhm_Ypol_Pel   to '1'
54980>>>>>                                If (iMustSaveClient         =1)  Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Enhm_Hmnies_Pel to '1'
54983>>>>>                            End
54983>>>>>>
54983>>>>>
54983>>>>>                            Else begin
54984>>>>>                                error 5011 "Client record not found while saving cmoves"
54985>>>>>>
54985>>>>>                            end
54985>>>>>>
54985>>>>>                            Set Field_Changed_Value Of Cmoves_DD   Field Cmoves.Sls_ID      to sSls_ID
54986>>>>>                            Set Field_Changed_Value Of Cmoves_DD   Field Cmoves.Cnt_ID      to sCnt_ID
54987>>>>>                            Set Field_Changed_Value Of Cmoves_DD   Field Cmoves.Presp_ID    to sPresp_ID
54988>>>>>                            Send Request_Save to Cmoves_DD
54989>>>>>
54989>>>>>                            Get Field_Current_Value Of Cmoves_DD Field Cmoves.Cmoves_Recr to sCmovesRecr
54990>>>>>
54990>>>>>                            If (Trim(sCmovesRecr)='') error 5008 "Saved Cmoves but dont have Recr"
54993>>>>>                            // jsjsjs 31/08/2001
54993>>>>>                            Skip_All_Ctypkin:
54993>>>>>
54993>>>>>                            //Set Field_Changed_Value Of Barticl_DD Field Barticl.Cmoves_Recr      to (Trim(sCmovesRecr))
54993>>>>>                            If ((iAnti=2) Or (iAnti=3)) ;                                Set Field_Changed_Value Of BMove_DD Field BMove.Cmoves_Recr to (Trim(sCmovesRecr))
54996>>>>>                            // jsjsjs 31/08/2001
54996>>>>>
54996>>>>>                            Send Request_Save to Bmove_DD
54997>>>>>                            Set Field_Changed_Value Of Barticl_DD Field Barticl.Barticl_Ekleise  to '1'
54998>>>>>                            Send Request_Save to Barticl_DD
54999>>>>>                        End
54999>>>>>>
54999>>>>>                        Else Begin
55000>>>>>                            // Prosthetos kodikas gia na kleinei kai ta axiografa
55000>>>>>                            // ta opoia den kanoun kammia kinhsh.
55000>>>>>                            Set Field_Changed_Value Of Barticl_DD Field Barticl.Barticl_Ekleise  to '1'
55001>>>>>                            Send Request_Save to Barticl_DD
55002>>>>>                        End
55002>>>>>>
55002>>>>>
55002>>>>>                        // @@##@@## yannis
55002>>>>>                        If ((iMustSaveEpisf<>0) or (imustsaveofeilh<>0)) Begin
55004>>>>>                            Move 0  to nApait
55005>>>>>                            Move 0  to napaitpayresp
55006>>>>>                            Move 0  to nEpitPoso
55007>>>>>                            Move '' to sPelaths
55008>>>>>                            Move 0  to nofeilh
55009>>>>>                            Move 0  to nofeilhpayresp
55010>>>>>                            //Get field_current_value of Baxio_dd field Baxio.Baxio_V0            to nEpitPoso
55010>>>>>                            Get field_current_value of Baxio_dd field Baxio.Baxio_V2            to nEpitPoso
55011>>>>>                            Get field_current_value of Baxio_dd field Baxio.Baxio_Code_In       to sPelaths
55012>>>>>
55012>>>>>                            // js 13/03/2003 Giati oi apografikes xreoseis pou kataxorountai apo
55012>>>>>                            // ta axiografa ?? exoun keno ayto to pedio apo thn klash tou baxio
55012>>>>>                            // Elegxetai to pedio Baxiokat.Baxiokat_Type  opou an einai 2 (Xreosh)
55012>>>>>                            // mhdenizei to pedio tou pelath Baxio.Baxio_Code_In
55012>>>>>                            If (Trim(sPelaths)='') Get field_current_value of Barticl_dd field Barticl.Barticl_code1 to sPelaths
55015>>>>>                            // js 13/03/2003
55015>>>>>
55015>>>>>                            Send Clear to Clients_DD
55016>>>>>                            Move (Trim(sPelaths)) to Clients.Client_ID
55017>>>>>                            Send Find to Clients_DD Eq 6 // Clients:index.6:Client_ID
55018>>>>>                            If (Found=1) Begin
55020>>>>>                                Get field_current_value of clients_dd field clients.Poso_Se_Apait   to nApait
55021>>>>>                                Get field_current_value of payresp_dd field payresp.Poso_Se_Apait   to nApaitpayresp
55022>>>>>                                Get field_current_value of clients_dd field clients.synolikh_ofeilh to nofeilh
55023>>>>>                                Get field_current_value of payresp_dd field payresp.synolikh_ofeilh to nofeilhpayresp
55024>>>>>
55024>>>>>                                If (iMustSaveofeilh=1)  Begin
55026>>>>>                                    If (Baxiokat.Baxiokat_Type = 2) Begin
55028>>>>>                                        Set Field_Changed_Value of clients_dd field clients.synolikh_ofeilh to (nofeilh+nepitposo)
55029>>>>>                                        Send Request_Save to Clients_DD
55030>>>>>                                        Set Field_Changed_Value of payresp_dd field payresp.synolikh_ofeilh to (nofeilhpayresp+nepitposo)
55031>>>>>                                        Send Request_Save to payresp_DD
55032>>>>>                                    End
55032>>>>>>
55032>>>>>                                    Else Begin
55033>>>>>                                        Set Field_Changed_Value of clients_dd field clients.synolikh_ofeilh to (nofeilh-nepitposo)
55034>>>>>                                        Send Request_Save to Clients_DD
55035>>>>>                                        Set Field_Changed_Value of payresp_dd field payresp.synolikh_ofeilh to (nofeilhpayresp-nepitposo)
55036>>>>>                                        Send Request_Save to payresp_DD
55037>>>>>                                    End
55037>>>>>>
55037>>>>>                                End
55037>>>>>>
55037>>>>>
55037>>>>>                                If (iMustSaveEpisf=1)  Begin
55039>>>>>                                    Add nEpitPoso to nApait
55040>>>>>                                    Set Field_Changed_Value of clients_dd field clients.Poso_Se_Apait to nApait
55041>>>>>                                    Send Request_Save to Clients_DD
55042>>>>>                                    Add nEpitPoso to nApaitpayresp
55043>>>>>                                    Set Field_Changed_Value of payresp_dd field payresp.Poso_Se_Apait to nApaitpayresp
55044>>>>>                                    Send Request_Save to payresp_DD
55045>>>>>
55045>>>>>                                End
55045>>>>>>
55045>>>>>                                Else If (iMustSaveEpisf=2)  Begin
55048>>>>>                                    Add (nEpitPoso*(-1)) to nApait
55049>>>>>                                    Set Field_Changed_Value of clients_dd field clients.Poso_Se_Apait to nApait
55050>>>>>                                    Send Request_Save to Clients_DD
55051>>>>>                                    Add (nEpitPoso*(-1)) to nApaitpayresp
55052>>>>>                                    Set Field_Changed_Value of payresp_dd field payresp.Poso_Se_Apait to nApaitpayresp
55053>>>>>                                    Send Request_Save to payresp_DD
55054>>>>>                                End
55054>>>>>>
55054>>>>>
55054>>>>>                                Set Field_Changed_Value Of Barticl_DD Field Barticl.Barticl_Ekleise  to '1'
55055>>>>>                                Send Request_Save to Barticl_DD
55056>>>>>                            End
55056>>>>>>
55056>>>>>                            Else Begin
55057>>>>>                            End
55057>>>>>>
55057>>>>>                        End
55057>>>>>>
55057>>>>>
55057>>>>>                        Move sCtypkinRecr to Ctypkin.Ctypkin_Recr
55058>>>>>                        Send Find to Ctypkin_DD eq 2 //Ctypkin:Index.2:Client_Recr
55059>>>>>                        If (Not(Found)) error 5006 "Ctypkin record not found"
55062>>>>>
55062>>>>>                        Send Find To Bmove_DD Next_Record 3 // Bmove:Index.2:Bmove_Recr
55063>>>>>                    Loop
55064>>>>>>
55064>>>>>
55064>>>>>                    //send info_box "€¥ æš¨˜­˜ œ§ «¬®éª ¡¢œ ©£â¤˜.\nƒœ¤ «¨¦§¦§¦ ¦ç¤«˜  ˜¤ ›œ¤ ¥œ¡¢œ ›é©¦¬¤" '¢ž¨¦­¦¨å˜'
55064>>>>>                End
55064>>>>>>
55064>>>>>            End
55064>>>>>>
55064>>>>>            Else error 5001 "’¦ ˜¨® ¡æ Barticle Recr ›œ¤ ™¨âŸž¡œ"
55066>>>>>        End_procedure
55067>>>>>
55067>>>>>
55067>>>>>        Procedure OnProcess
55069>>>>>            If (psModule(Self)='') error 5999 "Business Process Called without setting psModule property"
55072>>>>>            If (Trim(psBarticleRecr(Self))<>'') Send Deal_With_Barticle
55075>>>>>            Else error 5000  "ƒœ¤ ¬§á¨®œ  ˜¨® ¡æ Barticle Recr"// No Initial Barticle recr is passed
55077>>>>>        End_Procedure
55078>>>>>
55078>>>>>        Procedure Start_Process
55080>>>>>            Integer iErr iID
55081>>>>>            Indicate Err False
55082>>>>>            Set Button_State    of (Wait(Self)) to False
55083>>>>>            Set BarVisibleState of (Wait(Self)) to '' False
55084>>>>>            Send Popup                          to (Wait(Self))
55085>>>>>            Set piLathos                        to 0
55086>>>>>            Forward Send Start_Process
55088>>>>>        End_Procedure
55089>>>>>
55089>>>>>        Procedure End_Process
55091>>>>>            Forward Send End_Process
55093>>>>>            Send Deactivate to (Wait(Self))
55094>>>>>        End_Procedure
55095>>>>>
55095>>>>>        //AB-StoreEnd
55095>>>>>
55095>>>>>    End_Object    // bpencmv3
55096>>>>>
55096>>>>>//AB/     End_Object    // prj
55096>>>
55096>>>Use slNomism.sl
55096>>>Use Globals.Inc
55096>>>Use sl033.sl
55096>>>Use r044.rv
INCLUDING FILE: R044.RV
55096>>>>>//AB/ Project R044:BMOVES
55096>>>>>//AB/     Object prj is a Report_Project
55096>>>>>//AB/         Set ProjectName to "R044:BMOVES"
55096>>>>>//AB/         Set ProjectFileName to "r044.RV"
55096>>>>>
55096>>>>>// Project Object Structure
55096>>>>>//   R044 is a ReportViewSub
55096>>>>>//     GroupSub2 is a GroupSub
55096>>>>>//       FormSub1 is a FormSub
55096>>>>>//       FormSub2 is a FormSub
55096>>>>>//       TextBoxSub7 is a TextBoxSub
55096>>>>>//       TextBoxSub8 is a TextBoxSub
55096>>>>>//     GroupSub1 is a GroupSub
55096>>>>>//       frmG12_3 is a FormSub
55096>>>>>//       frmG12_4 is a FormSub
55096>>>>>//       TextBoxSub3 is a TextBoxSub
55096>>>>>//       TextBoxSub4 is a TextBoxSub
55096>>>>>//     GroupSub3 is a GroupSub
55096>>>>>//       frmG1 is a FormSub
55096>>>>>//       frmG2 is a FormSub
55096>>>>>//       TextBoxSub9 is a TextBoxSub
55096>>>>>//       TextBoxSub10 is a TextBoxSub
55096>>>>>//     oSelectCurr is a GroupSub
55096>>>>>//       chkbCurr0 is a CheckBoxSub
55096>>>>>//       chkbCurr00 is a CheckBoxSub
55096>>>>>//       chkbCurrR is a CheckBoxSub
55096>>>>>//       chkbKeepTogether is a CheckBoxSub
55096>>>>>//     rdgSelectPrint is a RadioGroupSub
55096>>>>>//       RadioSub5 is a RadioSub
55096>>>>>//       RadioSub6 is a RadioSub
55096>>>>>//       rdFile is a RadioSub
55096>>>>>//       frmFile is a FormSub
55096>>>>>//     FormSub5 is a FormSub
55096>>>>>//     oPrint_bn is a ButtonSub
55096>>>>>//     oExit_bn is a ButtonSub
55096>>>>>//     grpYear is a GroupSub
55096>>>>>//       frmCompany is a FormSub
55096>>>>>//       frmBranch is a FormSub
55096>>>>>//       frmYear is a FormSub
55096>>>>>//       TextBoxSub11 is a TextBoxSub
55096>>>>>//       TextBoxSub12 is a TextBoxSub
55096>>>>>//       TextBoxSub13 is a TextBoxSub
55096>>>>>//     oClear_bn is a ButtonSub
55096>>>>>//     Textbox1 is a Textbox
55096>>>>>//     branch_name is a FormSub
55096>>>>>//     BMoves_BasicReport is a BasicReportSub
55096>>>>>
55096>>>>>// Register all objects
55096>>>>>Register_Object BMoves_BasicReport
55096>>>>>Register_Object branch_name
55096>>>>>Register_Object chkbCurr0
55096>>>>>Register_Object chkbCurr00
55096>>>>>Register_Object chkbCurrR
55096>>>>>Register_Object chkbKeepTogether
55096>>>>>Register_Object FormSub1
55096>>>>>Register_Object FormSub2
55096>>>>>Register_Object FormSub5
55096>>>>>Register_Object frmBranch
55096>>>>>Register_Object frmCompany
55096>>>>>Register_Object frmFile
55096>>>>>Register_Object frmG1
55096>>>>>Register_Object frmG12_3
55096>>>>>Register_Object frmG12_4
55096>>>>>Register_Object frmG2
55096>>>>>Register_Object frmYear
55096>>>>>Register_Object GroupSub1
55096>>>>>Register_Object GroupSub2
55096>>>>>Register_Object GroupSub3
55096>>>>>Register_Object grpYear
55096>>>>>Register_Object oClear_bn
55096>>>>>Register_Object oExit_bn
55096>>>>>Register_Object oPrint_bn
55096>>>>>Register_Object oSelectCurr
55096>>>>>Register_Object R044
55096>>>>>Register_Object RadioSub5
55096>>>>>Register_Object RadioSub6
55096>>>>>Register_Object rdFile
55096>>>>>Register_Object rdgSelectPrint
55096>>>>>Register_Object TextBoxSub10
55096>>>>>Register_Object TextBoxSub11
55096>>>>>Register_Object TextBoxSub12
55096>>>>>Register_Object TextBoxSub13
55096>>>>>Register_Object TextBoxSub3
55096>>>>>Register_Object TextBoxSub4
55096>>>>>Register_Object TextBoxSub7
55096>>>>>Register_Object TextBoxSub8
55096>>>>>Register_Object TextBoxSub9
55096>>>>>Register_Object Textbox1
55096>>>>>
55096>>>>>
55096>>>>>//AB/     Report View
55096>>>>>
55096>>>>>
55096>>>>>    //AB-StoreTopStart
55096>>>>>    Use DFAllRpt.pkg
55096>>>>>    Use BasicRpt.Sub
INCLUDING FILE: BASICRPT.SUB
55096>>>>>>>Use Dfrpt.pkg
55096>>>>>>>
55096>>>>>>>Class BasicReportSub is a BasicReport
55097>>>>>>>
55097>>>>>>>  Procedure Start_Log
55098>>>>>>>     Send Log_Status ("Starting Report:"+Report_Title(Current_Object))
55099>>>>>>>  End_Procedure // Start_Log
55100>>>>>>>
55100>>>>>>>  Procedure End_Log
55101>>>>>>>     Send Log_Status ("Ending Report:  " + Report_Title(Current_Object))
55102>>>>>>>  End_Procedure // End_Log
55103>>>>>>>
55103>>>>>>>  Procedure Error_Log_Status integer ErrNum integer Err_Line string ErrMsg
55104>>>>>>>     Send Log_Status ("Error #"* String(ErrNum) + "." * ErrMsg)
55105>>>>>>>  End_Procedure // Error_Log_Status
55106>>>>>>>
55106>>>>>>>  Procedure Update_Status_Page
55107>>>>>>>     If (Page_End(Current_Object)) EQ 0 ;        Send Update_Status ("Record: " + String(Page_Count(Current_Object)))
55110>>>>>>>     Else Send Update_Status ("Page: " + String(Page_Count(Current_Object)))
55112>>>>>>>  End_Procedure // Update_Status_Page
55113>>>>>>>
55113>>>>>>>  Function Report_Interrupt Returns Integer
55114>>>>>>>     Integer rVal
55115>>>>>>>     String Mess
55115>>>>>>>
55115>>>>>>>     If (Error_Check_State(Current_Object)) ;        Move "An error occured during processing. Do you want to cancel ?" to Mess
55118>>>>>>>     Else ;            Move  "Do you want to cancel the process ?" to Mess
55120>>>>>>>            Get YesNo_Box Mess "Process Interrupted" to rVal
55121>>>>>>>     Function_Return (Rval=MBR_YES)
55122>>>>>>>  End_Function  // Report_Interrupt
55123>>>>>>>
55123>>>>>>>End_Class // BasicReportSub
55124>>>>>>>
55124>>>>>>>Class WinReportSub is a WinReport
55125>>>>>>>
55125>>>>>>>  Procedure Start_Log
55126>>>>>>>     Send Log_Status ("Start Report:"+Report_Title(Current_Object))
55127>>>>>>>  End_Procedure // Start_Log
55128>>>>>>>
55128>>>>>>>  Procedure End_Log
55129>>>>>>>     Send Log_Status ("End Report:  " + Report_Title(Current_Object))
55130>>>>>>>  End_Procedure // End_Log
55131>>>>>>>
55131>>>>>>>  Procedure Error_Log_Status integer ErrNum integer Err_Line string ErrMsg
55132>>>>>>>     Send Log_Status ("Error #"* String(ErrNum) + "." * ErrMsg)
55133>>>>>>>  End_Procedure // Error_Log_Status
55134>>>>>>>
55134>>>>>>>  Procedure Update_Status_Page
55135>>>>>>>     If (Page_End(Current_Object)) EQ 0 ;        Send Update_Status ("Record: " + String(Page_Count(Current_Object)))
55138>>>>>>>     Else Send Update_Status ("Page: " + String(Page_Count(Current_Object)))
55140>>>>>>>  End_Procedure // Update_Status_Page
55141>>>>>>>
55141>>>>>>>  Function Report_Interrupt Returns Integer
55142>>>>>>>     Integer rVal
55143>>>>>>>     String Mess
55143>>>>>>>
55143>>>>>>>     If (Error_Check_State(Current_Object)) ;        Move "An error occured during processing. Do you want to cancel ?" to Mess
55146>>>>>>>     Else ;            Move  "Do you want to cancel the process ?" to Mess
55148>>>>>>>            Get YesNo_Box Mess "Process Interrupted" to rVal
55149>>>>>>>     Function_Return (Rval=MBR_YES)
55150>>>>>>>  End_Function  // Report_Interrupt
55151>>>>>>>
55151>>>>>>>End_Class // WinReportSub
55152>>>>>>>
55152>>>>>    
55152>>>>>    Use SysCurXr.DD
55152>>>>>    Use BTYPKIN.DD
55152>>>>>    Use BARTICL.DD
55152>>>>>    Use BMOVE.DD
55152>>>>>    Use BAXIOKAT.DD
55152>>>>>    Use BAXIO.DD
55152>>>>>    
55152>>>>>    Use Rvi044.pkg
INCLUDING FILE: RVI044.PKG
/HEADERR044
Image 2, HEADERR044
 ________________________________________   ________________________________________   _________________
                                            †‹„ŽŠŽ‚ˆŽ €ˆŽ‚€”—Œ
                                            =====================
/SubHeaderR044_1
Image 3, SUBHEADERR044_1
_____________________________________________________________________________   ‘„ˆ€ : ___
‰ˆŒ†‘† : _________     €.€€‘’.: ____________.     €.€‡Ž“ : ____________.  †‹/Œˆ€ : __/__/____
‘“Œ€ŠŠ€‘Ž‹„ŒŽ‘ : ___________________________________
€€Š†’†‘     : ___________________________________   ‰“ˆŽ ŒŽ‹ˆ‘‹€ •†‘†‘ : ___________   ‘“ŒŽŠŽ : _,___,___,___.__
€ˆ’ˆŽŠŽ‚ˆ€ : _______________________________________________
-------------------------------------------------------------------------------------------------------------------------------
   €/€ „ˆƒŽ‘                    ‰—ƒˆ‰Ž‘ ’€„…€     €ˆ‡‹Ž‘      ŒŽ‹ˆ‘‹€             Ž‘Ž        Š†† ‰“ˆŽ               Ž‘Ž
                                                                 „‚‚€”†‘                             ŒŽ‹ˆ‘‹€
-------------------------------------------------------------------------------------------------------------------------------
/SubHeaderR044_2
Image 4, SUBHEADERR044_2
/BodyR044
Image 5, BODYR044
_____. _________________ _____________. ___________ ____________ _______ _,___,___,___.__  __/__/____ _______ _,___,___,___.__
/SubtotalR044_1
Image 6, SUBTOTALR044_1
/SubtotalR044_2
Image 7, SUBTOTALR044_2
-------------------------------------------------------------------------------------------------------------------------------
‘“ŒŽŠŽ                                                                             ’„‹€•ˆ€ : _______.         _,___,___,___.__
===============================================================================================================================
/RecParArticl
Image 8, RECPARARTICL
_________.
/FooterR044_1
Image 9, FOOTERR044_1
__/__/____
/*
55152>>>>>    Use sl031r.sl
55152>>>>>    Use sl036r.sl
55152>>>>>    use sl002.sl
55152>>>>>    //AB-StoreTopEnd
55152>>>>>
55152>>>>>    //AB-IgnoreStart
55152>>>>>
55152>>>>>    Use Rptvw.Sub
INCLUDING FILE: RPTVW.SUB
55152>>>>>>>Use DFRptvw.pkg
55152>>>>>>>Use dbRptvw.pkg
INCLUDING FILE: DBRPTVW.PKG
55152>>>>>>>>>
55152>>>>>>>>>Use Windows
55152>>>>>>>>>Use DfPanel
55152>>>>>>>>>Use EnClient
55152>>>>>>>>>Use DFNav_mx
55152>>>>>>>>>Use dfConfrm
55152>>>>>>>>>Use dfRptVw
55152>>>>>>>>>Use DFGSINI
55152>>>>>>>>>
55152>>>>>>>>>Class dbReportAppClient_ is a ReportView STARTMAC ECstart
55153>>>>>>>>>    Import_Class_Protocol Entry_Client
55154>>>>>>>>>    //  Defeat the activating augmentation for auto-locate
55154>>>>>>>>>    Procedure Activating Returns Integer
55155>>>>>>>>>      local integer RVal
55156>>>>>>>>>      forward get MSG_activating to rVal
55158>>>>>>>>>      Procedure_Return rVal
55159>>>>>>>>>    End_Procedure
55160>>>>>>>>>End_Class // dbReportAppClient_
55161>>>>>>>>>
55161>>>>>>>>>Class dbReportAppView_ is a dbReportAppClient_
55162>>>>>>>>>  import_Class_protocol entry_view_Client
55163>>>>>>>>>End_Class // dbReportAppView_
55164>>>>>>>>>
55164>>>>>>>>>
55164>>>>>>>>>Class dbReportView is a dbReportAppView_
55165>>>>>>>>>
55165>>>>>>>>>     Procedure Construct_Object
55166>>>>>>>>>      Forward Send Construct_Object No_Image
55168>>>>>>>>>      Send Define_DFNavigation  // GUI navigate changes
55169>>>>>>>>>      // dialog views get activated as popup objects.
55169>>>>>>>>>      set Dso_Detach_Mode to Detach_Always
55170>>>>>>>>>
55170>>>>>>>>>      Set Verify_Data_Loss_Msg TO GET_No_Confirmation
55171>>>>>>>>>      Set Verify_Delete_Msg    TO GET_No_Confirmation
55172>>>>>>>>>      Set Verify_Save_Msg      TO GET_No_Confirmation
55173>>>>>>>>>      Set Verify_Exit_Msg      TO GET_No_confirmation
55174>>>>>>>>>      //
55174>>>>>>>>>      // This reportview-client will almost always be a modalpanel, therefore minimizing
55174>>>>>>>>>      // is out of the question...
55174>>>>>>>>>      Set Minimize_Icon To False
55175>>>>>>>>>      Set Maximize_Icon To False
55176>>>>>>>>>   End_Procedure // Construct_Object
55177>>>>>>>>>
55177>>>>>>>>>   Procedure Request_Delete
55178>>>>>>>>>   End_Procedure // request_delete
55179>>>>>>>>>
55179>>>>>>>>>   Procedure Request_Save
55180>>>>>>>>>   End_Procedure // request_save
55181>>>>>>>>>
55181>>>>>>>>>   Function Exit_Application_Check Returns Integer
55182>>>>>>>>>     Function_return 0
55183>>>>>>>>>   End_Function
55184>>>>>>>>>
55184>>>>>>>>>   Import_Class_Protocol DFNavigate_Mixin
55185>>>>>>>>>
55185>>>>>>>>>  //  Returns TRUE to indicate that this is a DEO. This is used by
55185>>>>>>>>>  //  delegation to figure out if you are within a DEO and should therefore
55185>>>>>>>>>  //  send a DEO message. DEO clients set this true
55185>>>>>>>>>  Function DEO_Object Returns integer
55186>>>>>>>>>    Function_Return 1
55187>>>>>>>>>  End_Function // DEO_Object
55188>>>>>>>>>
55188>>>>>>>>>  //
55188>>>>>>>>>  //  Activate message for views that:
55188>>>>>>>>>  //  1. restores the view if it is minimized
55188>>>>>>>>>  //  2. Maintains the current scope's focus.
55188>>>>>>>>>  //
55188>>>>>>>>>  Procedure Activate_current_scope
55189>>>>>>>>>    If ( View_mode(Current_Object)=VIEWMODE_ICONIZE ) ;       Set view_mode to viewmode_normal
55192>>>>>>>>>    Set Current_Scope to Current_Object
55193>>>>>>>>>  End_Procedure // Activate_current_scope
55194>>>>>>>>>
55194>>>>>>>>>  //  Pass full object name - return the relative name
55194>>>>>>>>>  //  e.g.,  Main.View.Obj1 --> Obj1
55194>>>>>>>>>  Function Local_Object_name string nm returns string
55195>>>>>>>>>     local integer ps
55196>>>>>>>>>     Repeat
55196>>>>>>>>>>
55196>>>>>>>>>       pos "." in nm to ps
55198>>>>>>>>>>
55198>>>>>>>>>       If ps eq 0 function_return nm
55201>>>>>>>>>       increment ps
55202>>>>>>>>>       Mid Nm to Nm 255 ps
55205>>>>>>>>>>
55205>>>>>>>>>     Loop
55206>>>>>>>>>>
55206>>>>>>>>>  end_function
55207>>>>>>>>>
55207>>>>>>>>>  //  Take string "#1,#2" and return integer hi #1 + #2
55207>>>>>>>>>  Function Parse_Complex string sVal returns integer
55208>>>>>>>>>     Local integer ps
55209>>>>>>>>>     Pos "," in sVal to ps
55211>>>>>>>>>>
55211>>>>>>>>>     if ps ;        Function_Return ( integer(left(sVal,ps-1))*65536 + ;                          integer(mid(sVal,255,ps+1)) )
55214>>>>>>>>>  End_Function // Parse_Complex
55215>>>>>>>>>
55215>>>>>>>>>  // Convert a complex integer to a string "hi,Low"
55215>>>>>>>>>  //
55215>>>>>>>>>  Function Complex_to_String integer i1 returns string
55216>>>>>>>>>     function_return ( string(hi(i1)) - "," - String(low(i1)) )
55217>>>>>>>>>  End_function
55218>>>>>>>>>
55218>>>>>>>>>
55218>>>>>>>>>  // *WvA: I don't want to save locations of a reportview noted in the registry.
55218>>>>>>>>>  // These printing dialogs are centered on the panel anyway, so it doesn't make any
55218>>>>>>>>>  // sense to clutter up the registry with this kind of nonsense.
55218>>>>>>>>>  ////
55218>>>>>>>>>  ////  Save View information to dfwin.ini file. Save as:
55218>>>>>>>>>  ////  View_ObjectName=LOC:Row,Col  e.g., Cust_Ent=LOC:10,20
55218>>>>>>>>>  ////     Leaving room for growth here.
55218>>>>>>>>>  ////
55218>>>>>>>>>  Procedure Save_Environment
55219>>>>>>>>>  //   Local String nm Vn st
55219>>>>>>>>>  //   Local Integer H
55219>>>>>>>>>  //
55219>>>>>>>>>  //   Get System_Profile_String "SaveEnvironment" to St
55219>>>>>>>>>  //   Move (Uppercase(trim(st))) to st
55219>>>>>>>>>  //   If (st="YES" or st="ON" or st="TRUE") Begin
55219>>>>>>>>>  //     // Note with the 3.05 version we will have problems if the view has
55219>>>>>>>>>  //     // been maximized and then iconized. We still don't know what the normal
55219>>>>>>>>>  //     // size/loc is when maximized. We will take a chance and assume that an
55219>>>>>>>>>  //     // iconized view is always non-zoomed (since views don't support the zoom
55219>>>>>>>>>  //     // button).
55219>>>>>>>>>  //     If (View_mode(Current_Object)<>VIEWMODE_ZOOM) Begin
55219>>>>>>>>>  //
55219>>>>>>>>>  //       Get Name to Vn // full name of object
55219>>>>>>>>>  //       Get Local_Object_Name Vn to Vn   // just get the local name
55219>>>>>>>>>  //       Get GUILocation to H             // complex location
55219>>>>>>>>>  //       Get Complex_to_String h to nm    // convert complex to "hi,low"
55219>>>>>>>>>  //       Set System_Profile_String VN to ("LOC:"+Nm)
55219>>>>>>>>>  //     End
55219>>>>>>>>>  //   End
55219>>>>>>>>>  //
55219>>>>>>>>>  End_Procedure
55220>>>>>>>>>  //
55220>>>>>>>>>  //// Augment to check for view string in .INI. Currently, if found
55220>>>>>>>>>  //// set the location
55220>>>>>>>>>  ////
55220>>>>>>>>>  Procedure Load_Environment
55221>>>>>>>>>  //   Local String nm Vn Lc
55221>>>>>>>>>  //   Local Integer H ps
55221>>>>>>>>>  //   // see above for reasoning on this
55221>>>>>>>>>  //   If (View_mode(Current_Object)=VIEWMODE_NORMAL) Begin
55221>>>>>>>>>  //     Get Name to Vn
55221>>>>>>>>>  //     Get Local_Object_Name Vn to Vn
55221>>>>>>>>>  //     Get System_Profile_String Vn to Nm
55221>>>>>>>>>  //     IF Nm ne '' Begin
55221>>>>>>>>>  //        Pos "LOC:" in Nm to Ps   // look for LOC:row,col
55221>>>>>>>>>  //        If Ps Begin
55221>>>>>>>>>  //           Mid Nm to Lc 255 (Ps+4)
55221>>>>>>>>>  //           Pos " " in Lc to ps
55221>>>>>>>>>  //           if Ps left lc to lc (ps-1)
55221>>>>>>>>>  //           Get Parse_Complex lc to H
55221>>>>>>>>>  //           Set GUILocation to (Hi(H)) (Low(H))
55221>>>>>>>>>  //           Send Adjust_Logicals
55221>>>>>>>>>  //        End
55221>>>>>>>>>  //     End
55221>>>>>>>>>  //   End
55221>>>>>>>>>  End_Procedure
55222>>>>>>>>>
55222>>>>>>>>>  Function View_Changed returns Integer
55223>>>>>>>>>     Local Integer Changed
55224>>>>>>>>>     Broadcast Get Data_Set_Should_Save to Changed // Ask for changes in Data-sets
55226>>>>>>>>>     Function_Return Changed
55227>>>>>>>>>  End_Function
55228>>>>>>>>>
55228>>>>>>>>>  Procedure Notify_Exit_Application
55229>>>>>>>>>    Send Save_Environment
55230>>>>>>>>>  End_procedure
55231>>>>>>>>>
55231>>>>>>>>>  Procedure End_Construct_Object
55232>>>>>>>>>     Send Load_Environment
55233>>>>>>>>>     //Send Define_SysMenu
55233>>>>>>>>>     Forward Send End_Construct_Object
55235>>>>>>>>>  End_Procedure // End_Construct_Object
55236>>>>>>>>>
55236>>>>>>>>>  Procedure Close_Client
55237>>>>>>>>>     Send Exit_Function
55238>>>>>>>>>  End_Procedure
55239>>>>>>>>>
55239>>>>>>>>>  Procedure Entering_Scope returns Integer
55240>>>>>>>>>     Local Integer rVal
55241>>>>>>>>>     Forward Get MSG_Entering_Scope to rVal
55243>>>>>>>>>     If not rVal send Show_View_Name (Label(Current_Object))
55246>>>>>>>>>  End_Procedure
55247>>>>>>>>>
55247>>>>>>>>>  Procedure Exiting_Scope integer whereto returns Integer
55248>>>>>>>>>     Local Integer rVal
55249>>>>>>>>>     Forward Get MSG_Exiting_Scope whereto to rVal
55251>>>>>>>>>     If not rVal Send Show_View_Name ''
55254>>>>>>>>>  End_Procedure
55255>>>>>>>>>
55255>>>>>>>>>  Procedure Show_view_Name string sHelp
55256>>>>>>>>>     Local Integer rVal Id
55257>>>>>>>>>     Get Statusbar_id to id
55258>>>>>>>>>     If Id Send Show_View_Name to Id sHelp
55261>>>>>>>>>  End_Procedure
55262>>>>>>>>>
55262>>>>>>>>>  Function Should_Save_Recursive returns integer
55263>>>>>>>>>    Function_return (View_Changed(Current_Object))
55264>>>>>>>>>  End_Function
55265>>>>>>>>>
55265>>>>>>>>>End_Class // dbReportView
55266>>>>>>>
55266>>>>>>>Class ReportViewSub is a ReportView
55267>>>>>>>
55267>>>>>>>    Procedure Construct_Object
55268>>>>>>>        Forward Send Construct_Object
55270>>>>>>>        Property Integer Server 0
55271>>>>>>>    End_Procedure // Construct_Object
55272>>>>>>>
55272>>>>>>>    Procedure Page Integer PageMode
55273>>>>>>>        Integer hWnd
55274>>>>>>>        Forward Send Page PageMode
55276>>>>>>>        Get Window_Handle to hWnd
55277>>>>>>>        If (hWnd) Begin
55279>>>>>>>            Send GreekSysMenu
55280>>>>>>>        End
55280>>>>>>>>
55280>>>>>>>    End_Procedure
55281>>>>>>>
55281>>>>>>>    Procedure Close_Panel
55282>>>>>>>        Local Integer liScope
55283>>>>>>>        Move (Prior_Scope(Desktop)) To liScope
55284>>>>>>>        Move (Scope_Focus(liScope)) To liScope
55285>>>>>>>        Forward Send Close_Panel
55287>>>>>>>        Send Activate To liScope
55288>>>>>>>    End_Procedure // Close_Panel
55289>>>>>>>
55289>>>>>>>End_Class
55290>>>>>>>
55290>>>>>>>Class dbReportViewSub is a dbReportView
55291>>>>>>>
55291>>>>>>>    Procedure Construct_Object
55292>>>>>>>        Forward Send Construct_Object
55294>>>>>>>        Property Integer Server 0
55295>>>>>>>    End_Procedure // Construct_Object
55296>>>>>>>
55296>>>>>>>    Procedure Page Integer PageMode
55297>>>>>>>        Integer hWnd
55298>>>>>>>        Forward Send Page PageMode
55300>>>>>>>        Get Window_Handle to hWnd
55301>>>>>>>        If (hWnd) Begin
55303>>>>>>>            Send GreekSysMenu
55304>>>>>>>        End
55304>>>>>>>>
55304>>>>>>>    End_Procedure
55305>>>>>>>
55305>>>>>>>    Procedure Close_Panel
55306>>>>>>>        Local Integer liScope
55307>>>>>>>        Move (Prior_Scope(Desktop)) To liScope
55308>>>>>>>        Move (Scope_Focus(liScope)) To liScope
55309>>>>>>>        Forward Send Close_Panel
55311>>>>>>>        Send Activate To liScope
55312>>>>>>>    End_Procedure // Close_Panel
55313>>>>>>>End_Class
55314>>>>>>>
55314>>>>>    Use Group.Sub
55314>>>>>    Use Form.Sub
55314>>>>>    Use Txtbox.Sub
55314>>>>>    Use Chkbox.Sub
55314>>>>>    Use Rgroup.Sub
55314>>>>>    Use Radio.Sub
55314>>>>>    Use Button.Sub
55314>>>>>    Use DFAllEnt.pkg
55314>>>>>
55314>>>>>    //AB-IgnoreEnd
55314>>>>>
55314>>>>>    ACTIVATE_VIEW Activate_R044 FOR R044
55318>>>>>
55318>>>>>    Object R044 is a ReportViewSub
55320>>>>>
55320>>>>>        //AB-StoreTopStart
55320>>>>>        Property Integer Sort_IndexR044 0
55322>>>>>        property string  psbranch public ''
55324>>>>>        Open Syscurxr
55326>>>>>        open branch
55328>>>>>        //AB-StoreTopEnd
55328>>>>>
55328>>>>>        Set Label to "R044:†£œ¨¦¢æš ¦ €¥ ¦š¨á­à¤"
55329>>>>>        Set Size to 228 324
55330>>>>>        Set Location to 5 7
55331>>>>>
55331>>>>>        //AB-DDOStart
55331>>>>>
55331>>>>>
55331>>>>>        //AB-DDOEnd
55331>>>>>
55331>>>>>        Object GroupSub2 is a GroupSub
55333>>>>>            Set Label to "„§ ¢¦šã †£œ¨¦£ž¤å˜ª €¨Ÿ¨à¤"
55334>>>>>            Set Size to 28 317
55335>>>>>            Set Location to 28 3
55336>>>>>            Object FormSub1 is a FormSub
55338>>>>>                Set Size to 13 60
55339>>>>>                Set Location to 10 51
55340>>>>>                Set Label_Col_Offset to 2
55341>>>>>                Set Label_Justification_Mode to jMode_Right
55342>>>>>                Set Form_Datatype Item 0 to Mask_Date_Window
55343>>>>>                Set Form_Mask Item 0 to "dd/mm/yyyy"
55344>>>>>
55344>>>>>                //AB-StoreStart
55344>>>>>                set Form_Datatype item 0 to mask_date_window
55345>>>>>                
55345>>>>>                
55345>>>>>                //AB-StoreEnd
55345>>>>>
55345>>>>>            End_Object    // FormSub1
55346>>>>>
55346>>>>>            Object FormSub2 is a FormSub
55348>>>>>                Set Size to 13 60
55349>>>>>                Set Location to 10 164
55350>>>>>                Set Label_Col_Offset to 2
55351>>>>>                Set Label_Justification_Mode to jMode_Right
55352>>>>>                Set Form_Datatype Item 0 to Mask_Date_Window
55353>>>>>                Set Form_Mask Item 0 to "dd/MM/yy"
55354>>>>>
55354>>>>>                //AB-StoreStart
55354>>>>>                set Form_Datatype item 0 to mask_date_window
55355>>>>>                
55355>>>>>                
55355>>>>>                //AB-StoreEnd
55355>>>>>
55355>>>>>            End_Object    // FormSub2
55356>>>>>
55356>>>>>            Object TextBoxSub7 is a TextBoxSub
55358>>>>>                Set Label to "€§æ †£/¤å˜ "
55359>>>>>                Set Auto_Size_State to FALSE
55360>>>>>                Set FontSize to 4 0
55361>>>>>                Set Location to 10 5
55362>>>>>                Set Size to 10 41
55363>>>>>                Set Enabled_State to TRUE
55364>>>>>            End_Object    // TextBoxSub7
55365>>>>>
55365>>>>>            Object TextBoxSub8 is a TextBoxSub
55367>>>>>                Set Label to "„àª †£¤å˜  :"
55368>>>>>                Set Auto_Size_State to FALSE
55369>>>>>                Set FontSize to 4 0
55370>>>>>                Set Location to 11 124
55371>>>>>                Set Size to 10 37
55372>>>>>                Set Enabled_State to TRUE
55373>>>>>            End_Object    // TextBoxSub8
55374>>>>>
55374>>>>>        End_Object    // GroupSub2
55375>>>>>
55375>>>>>        Object GroupSub1 is a GroupSub
55377>>>>>            Set Label to "„§ ¢¦šã €¨Ÿ¨à¤"
55378>>>>>            Set Size to 46 151
55379>>>>>            Set Location to 58 3
55380>>>>>            Object frmG12_3 is a FormSub
55382>>>>>                Set Size to 13 71
55383>>>>>                Set Location to 10 60
55384>>>>>                Set Label_Col_Offset to 2
55385>>>>>                Set Label_Justification_Mode to jMode_Right
55386>>>>>                Set Prompt_Button_Mode to pb_PromptOn
55387>>>>>                Set Form_Margin Item 0 to 14
55388>>>>>
55388>>>>>                //AB-StoreStart
55388>>>>>                Set Prompt_Object to (Sl036r(Current_object))
55389>>>>>                
55389>>>>>                //Procedure RetValue
55389>>>>>                //    Set Value Item 0 to Barticl.Barticl_Recr
55389>>>>>                //End_Procedure // RetValue
55389>>>>>                
55389>>>>>                //// this is called by the prompt list upon initialization. This will let us
55389>>>>>                //// set special properties for the list's one time use. In this case we
55389>>>>>                //// want the intial column and the export column to be name (col 1)
55389>>>>>                //Procedure Prompt_Callback integer hPrompt
55389>>>>>                //    Integer liFld liBestColumn
55389>>>>>                //    Get_Fieldnumber Barticl.Barticl_Recr to liFld
55389>>>>>                //    Get Select_Best_Column Of hPrompt Barticl.File_Number liFld To liBestColumn
55389>>>>>                //    Set Export_Column Of hPrompt        To liBestColumn
55389>>>>>                //    Set Initial_Column Of hPrompt       To liBestColumn
55389>>>>>                //    Set display_buffer_msg of hPrompt   to msg_RetValue
55389>>>>>                //end_procedure
55389>>>>>                
55389>>>>>                
55389>>>>>                
55389>>>>>                
55389>>>>>                
55389>>>>>                
55389>>>>>                //AB-StoreEnd
55389>>>>>
55389>>>>>            End_Object    // frmG12_3
55390>>>>>
55390>>>>>            Object frmG12_4 is a FormSub
55392>>>>>                Set Size to 13 71
55393>>>>>                Set Location to 27 60
55394>>>>>                Set Label_Col_Offset to 2
55395>>>>>                Set Label_Justification_Mode to jMode_Right
55396>>>>>                Set Prompt_Button_Mode to pb_PromptOn
55397>>>>>                Set Form_Margin Item 0 to 14
55398>>>>>
55398>>>>>                //AB-StoreStart
55398>>>>>                Set Prompt_Object to (Sl036r(Current_object))
55399>>>>>                
55399>>>>>                //Procedure RetValue
55399>>>>>                //    Set Value Item 0 to Barticl.Barticl_Recr
55399>>>>>                //End_Procedure // RetValue
55399>>>>>                //
55399>>>>>                //// this is called by the prompt list upon initialization. This will let us
55399>>>>>                //// set special properties for the list's one time use. In this case we
55399>>>>>                //// want the intial column and the export column to be name (col 1)
55399>>>>>                //Procedure Prompt_Callback integer hPrompt
55399>>>>>                //    Integer liFld liBestColumn
55399>>>>>                //
55399>>>>>                //    Get_Fieldnumber Barticl.Barticl_Recr to liFld
55399>>>>>                //    Get Select_Best_Column Of hPrompt Barticl.File_Number liFld To liBestColumn
55399>>>>>                //    Set Export_Column Of hPrompt To liBestColumn
55399>>>>>                //    Set Initial_Column Of hPrompt To liBestColumn
55399>>>>>                //    Set display_buffer_msg of hPrompt to msg_RetValue
55399>>>>>                //end_procedure // Prompt_Callback
55399>>>>>                //
55399>>>>>                
55399>>>>>                
55399>>>>>                
55399>>>>>                //AB-StoreEnd
55399>>>>>
55399>>>>>            End_Object    // frmG12_4
55400>>>>>
55400>>>>>            Object TextBoxSub3 is a TextBoxSub
55402>>>>>                Set Label to "€§æ €¨Ÿ¨¦  :"
55403>>>>>                Set Auto_Size_State to FALSE
55404>>>>>                Set FontSize to 4 0
55405>>>>>                Set Location to 10 5
55406>>>>>                Set Size to 10 45
55407>>>>>                Set Enabled_State to TRUE
55408>>>>>            End_Object    // TextBoxSub3
55409>>>>>
55409>>>>>            Object TextBoxSub4 is a TextBoxSub
55411>>>>>                Set Label to "„àª €¨Ÿ¨¦  :"
55412>>>>>                Set Auto_Size_State to FALSE
55413>>>>>                Set FontSize to 4 0
55414>>>>>                Set Location to 26 5
55415>>>>>                Set Size to 13 47
55416>>>>>                Set Enabled_State to TRUE
55417>>>>>            End_Object    // TextBoxSub4
55418>>>>>
55418>>>>>
55418>>>>>            //AB-StoreStart
55418>>>>>                                                                                                        
55418>>>>>                                                                                                        
55418>>>>>            //AB-StoreEnd
55418>>>>>
55418>>>>>        End_Object    // GroupSub1
55419>>>>>
55419>>>>>        Object GroupSub3 is a GroupSub
55421>>>>>            Set Label to "„§ ¢¦šã ‰ ¤ã©œà¤"
55422>>>>>            Set Size to 46 160
55423>>>>>            Set Location to 58 159
55424>>>>>            Object frmG1 is a FormSub
55426>>>>>                Set Size to 13 63
55427>>>>>                Set Location to 10 60
55428>>>>>                Set Label_Col_Offset to 2
55429>>>>>                Set Label_Justification_Mode to jMode_Right
55430>>>>>                Set Prompt_Button_Mode to pb_PromptOn
55431>>>>>                Set Form_Margin Item 0 to 6
55432>>>>>
55432>>>>>                //AB-StoreStart
55432>>>>>                Set Prompt_Object to (Sl031r(Current_object))
55433>>>>>                
55433>>>>>                //Procedure RetValue
55433>>>>>                //    Set Value Item 0 to Btypkin.Btypkin_Recr
55433>>>>>                //End_Procedure // RetValue
55433>>>>>                //
55433>>>>>                //// this is called by the prompt list upon initialization. This will let us
55433>>>>>                //// set special properties for the list's one time use. In this case we
55433>>>>>                //// want the intial column and the export column to be name (col 1)
55433>>>>>                //Procedure Prompt_Callback integer hPrompt
55433>>>>>                //    Integer liFld liBestColumn
55433>>>>>                //
55433>>>>>                //    Get_Fieldnumber Btypkin.Btypkin_Recr to liFld
55433>>>>>                //    Get Select_Best_Column Of hPrompt Btypkin.File_Number liFld To liBestColumn
55433>>>>>                //    Set Export_Column Of hPrompt To liBestColumn
55433>>>>>                //    Set Initial_Column Of hPrompt To liBestColumn
55433>>>>>                //    Set display_buffer_msg of hPrompt to msg_RetValue
55433>>>>>                //end_procedure // Prompt_Callback
55433>>>>>                
55433>>>>>                
55433>>>>>                
55433>>>>>                
55433>>>>>                //AB-StoreEnd
55433>>>>>
55433>>>>>            End_Object    // frmG1
55434>>>>>
55434>>>>>            Object frmG2 is a FormSub
55436>>>>>                Set Size to 13 63
55437>>>>>                Set Location to 27 60
55438>>>>>                Set Label_Col_Offset to 2
55439>>>>>                Set Label_Justification_Mode to jMode_Right
55440>>>>>                Set Prompt_Button_Mode to pb_PromptOn
55441>>>>>                Set Form_Margin Item 0 to 6
55442>>>>>
55442>>>>>                //AB-StoreStart
55442>>>>>                Set Prompt_Object to (Sl031r(Current_object))
55443>>>>>                
55443>>>>>                //Procedure RetValue
55443>>>>>                //    Set Value Item 0 to Btypkin.Btypkin_Recr
55443>>>>>                //End_Procedure // RetValue
55443>>>>>                //
55443>>>>>                //// this is called by the prompt list upon initialization. This will let us
55443>>>>>                //// set special properties for the list's one time use. In this case we
55443>>>>>                //// want the intial column and the export column to be name (col 1)
55443>>>>>                //Procedure Prompt_Callback integer hPrompt
55443>>>>>                //    Integer liFld liBestColumn
55443>>>>>                //
55443>>>>>                //    Get_Fieldnumber Btypkin.Btypkin_Recr to liFld
55443>>>>>                //    Get Select_Best_Column Of hPrompt Btypkin.File_Number liFld To liBestColumn
55443>>>>>                //    Set Export_Column Of hPrompt To liBestColumn
55443>>>>>                //    Set Initial_Column Of hPrompt To liBestColumn
55443>>>>>                //    Set display_buffer_msg of hPrompt to msg_RetValue
55443>>>>>                //end_procedure // Prompt_Callback
55443>>>>>                //
55443>>>>>                
55443>>>>>                
55443>>>>>                //AB-StoreEnd
55443>>>>>
55443>>>>>            End_Object    // frmG2
55444>>>>>
55444>>>>>            Object TextBoxSub9 is a TextBoxSub
55446>>>>>                Set Label to "€§æ ‰å¤ž©ž   :"
55447>>>>>                Set Auto_Size_State to FALSE
55448>>>>>                Set FontSize to 4 0
55449>>>>>                Set Location to 10 5
55450>>>>>                Set Size to 10 45
55451>>>>>                Set Enabled_State to TRUE
55452>>>>>            End_Object    // TextBoxSub9
55453>>>>>
55453>>>>>            Object TextBoxSub10 is a TextBoxSub
55455>>>>>                Set Label to "„àª ‰å¤ž©ž   :"
55456>>>>>                Set Auto_Size_State to FALSE
55457>>>>>                Set FontSize to 4 0
55458>>>>>                Set Location to 26 5
55459>>>>>                Set Size to 13 47
55460>>>>>                Set Enabled_State to TRUE
55461>>>>>            End_Object    // TextBoxSub10
55462>>>>>
55462>>>>>
55462>>>>>            //AB-StoreStart
55462>>>>>                                                                                                        
55462>>>>>                                                                                                        
55462>>>>>                                                                                                        
55462>>>>>                                                                                                        
55462>>>>>            //AB-StoreEnd
55462>>>>>
55462>>>>>        End_Object    // GroupSub3
55463>>>>>
55463>>>>>        Object oSelectCurr is a GroupSub
55465>>>>>            Set Label to "„§ ¢¦šã Œ¦£ ©£á«à¤"
55466>>>>>            Set Size to 28 317
55467>>>>>            Set Location to 106 3
55468>>>>>            Object chkbCurr0 is a CheckBoxSub
55470>>>>>                Set Label to "0"
55471>>>>>                Set Size to 10 21
55472>>>>>                Set Location to 12 15
55473>>>>>            End_Object    // chkbCurr0
55474>>>>>
55474>>>>>            Object chkbCurr00 is a CheckBoxSub
55476>>>>>                Set Label to "00"
55477>>>>>                Set Size to 10 25
55478>>>>>                Set Location to 12 90
55479>>>>>            End_Object    // chkbCurr00
55480>>>>>
55480>>>>>            Object chkbCurrR is a CheckBoxSub
55482>>>>>                Set Label to "rep"
55483>>>>>                Set Size to 10 27
55484>>>>>                Set Location to 12 162
55485>>>>>            End_Object    // chkbCurrR
55486>>>>>
55486>>>>>            Object chkbKeepTogether is a CheckBoxSub
55488>>>>>                Set Size to 10 17
55489>>>>>                Set Location to 12 251
55490>>>>>                Set Enabled_State to FALSE
55491>>>>>                Set Item_Shadow_State Item 0 to TRUE
55492>>>>>                Set Shadow_State Item 0 to TRUE
55493>>>>>
55493>>>>>                //AB-StoreStart
55493>>>>>                                                                                                                                            
55493>>>>>                Set Visible_State to False
55494>>>>>                //AB-StoreEnd
55494>>>>>
55494>>>>>            End_Object    // chkbKeepTogether
55495>>>>>
55495>>>>>        End_Object    // oSelectCurr
55496>>>>>
55496>>>>>        Object rdgSelectPrint is a RadioGroupSub
55498>>>>>            Set Label to "„¡«ç&§à©ž"
55499>>>>>            Set Size to 28 317
55500>>>>>            Set Location to 137 3
55501>>>>>            Object RadioSub5 is a RadioSub
55503>>>>>                Set Label to "ŽŸæ¤ž :"
55504>>>>>                Set Size to 10 36
55505>>>>>                Set Location to 12 6
55506>>>>>            End_Object    // RadioSub5
55507>>>>>
55507>>>>>            Object RadioSub6 is a RadioSub
55509>>>>>                Set Label to "„¡«¬§à«ãª : "
55510>>>>>                Set Size to 10 49
55511>>>>>                Set Location to 12 51
55512>>>>>            End_Object    // RadioSub6
55513>>>>>
55513>>>>>            Object rdFile is a RadioSub
55515>>>>>                Set Label to "€¨®œå¦"
55516>>>>>                Set Size to 10 41
55517>>>>>                Set Location to 12 113
55518>>>>>                Set Auto_Size_State to FALSE
55519>>>>>            End_Object    // rdFile
55520>>>>>
55520>>>>>            Object frmFile is a FormSub
55522>>>>>                Set Size to 13 144
55523>>>>>                Set Location to 10 158
55524>>>>>                Set Color to clBtnFace
55525>>>>>                Set Label_Col_Offset to 2
55526>>>>>                Set Enabled_State to FALSE
55527>>>>>                Set Item_Shadow_State Item 0 to TRUE
55528>>>>>                Set Shadow_State Item 0 to TRUE
55529>>>>>            End_Object    // frmFile
55530>>>>>
55530>>>>>
55530>>>>>            //AB-StoreStart
55530>>>>>            Procedure Notify_Select_State  Integer iNewItem  Integer iOldItem
55532>>>>>                If iNewItem EQ 0     Set Output_Device_Mode  To PRINT_TO_WINDOW
55535>>>>>                Else If iNewItem EQ 1   Set Output_Device_Mode  To PRINT_TO_PRINTER
55539>>>>>                Else If iNewItem EQ 2   Set Output_Device_Mode  To PRINT_TO_FILE
55543>>>>>                Set Enabled_State of frmFile to (iNewItem = 2)
55544>>>>>            End_Procedure
55545>>>>>            
55545>>>>>            
55545>>>>>            //AB-StoreEnd
55545>>>>>
55545>>>>>        End_Object    // rdgSelectPrint
55546>>>>>
55546>>>>>        Object FormSub5 is a FormSub
55548>>>>>            Set Size to 13 69
55549>>>>>            Set Location to 171 73
55550>>>>>            Set Label_Col_Offset to 2
55551>>>>>            Set Prompt_Button_Mode to pb_PromptOn
55552>>>>>
55552>>>>>            //AB-StoreStart
55552>>>>>            Set Prompt_Object to (sl002(Current_object))
55553>>>>>            
55553>>>>>            procedure onchange
55555>>>>>                string sbranch
55556>>>>>                get value item 0 to sbranch
55557>>>>>                clear branch
55558>>>>>                move syscurxr.company_code to branch.company_code
55559>>>>>                move sbranch               to branch.branch_code
55560>>>>>                find eq branch by index.1
55561>>>>>>
55561>>>>>                if (found=1) set value of (branch_name(self)) to branch.branch_name
55564>>>>>                else         set value of (branch_name(self)) to ''
55566>>>>>                set psbranch to branch.branch_code
55567>>>>>            end_procedure
55568>>>>>            
55568>>>>>            //AB-StoreEnd
55568>>>>>
55568>>>>>        End_Object    // FormSub5
55569>>>>>
55569>>>>>        Object oPrint_bn is a ButtonSub
55571>>>>>            Set Label to "„¡«â¢œ©ž (F2)"
55572>>>>>            Set Size to 18 53
55573>>>>>            Set Location to 193 208
55574>>>>>
55574>>>>>            //AB-StoreStart
55574>>>>>            Procedure OnClick
55576>>>>>                Send StartReport
55577>>>>>            End_Procedure // OnClick
55578>>>>>            
55578>>>>>            
55578>>>>>            //AB-StoreEnd
55578>>>>>
55578>>>>>        End_Object    // oPrint_bn
55579>>>>>
55579>>>>>        Object oExit_bn is a ButtonSub
55581>>>>>            Set Label to "„¥¦›¦ª (Esc)"
55582>>>>>            Set Size to 18 53
55583>>>>>            Set Location to 193 267
55584>>>>>
55584>>>>>            //AB-StoreStart
55584>>>>>            Procedure OnClick
55586>>>>>                Send Request_Cancel
55587>>>>>            End_Procedure // OnClick
55588>>>>>            
55588>>>>>            //AB-StoreEnd
55588>>>>>
55588>>>>>        End_Object    // oExit_bn
55589>>>>>
55589>>>>>        Object grpYear is a GroupSub
55591>>>>>            Set Size to 24 316
55592>>>>>            Set Location to 1 3
55593>>>>>            Object frmCompany is a FormSub
55595>>>>>                Set Size to 13 71
55596>>>>>                Set Location to 8 36
55597>>>>>                Set Color to clBtnFace
55598>>>>>                Set Label_Col_Offset to 2
55599>>>>>                Set Label_Justification_Mode to jMode_Right
55600>>>>>                Set Enabled_State to FALSE
55601>>>>>                Set Item_Shadow_State Item 0 to TRUE
55602>>>>>                Set Shadow_State Item 0 to TRUE
55603>>>>>            End_Object    // frmCompany
55604>>>>>
55604>>>>>            Object frmBranch is a FormSub
55606>>>>>                Set Size to 13 85
55607>>>>>                Set Location to 8 147
55608>>>>>                Set Color to clBtnFace
55609>>>>>                Set Label_Col_Offset to 2
55610>>>>>                Set Label_Justification_Mode to jMode_Right
55611>>>>>                Set Enabled_State to FALSE
55612>>>>>                Set Item_Shadow_State Item 0 to TRUE
55613>>>>>                Set Shadow_State Item 0 to TRUE
55614>>>>>            End_Object    // frmBranch
55615>>>>>
55615>>>>>            Object frmYear is a FormSub
55617>>>>>                Set Size to 13 43
55618>>>>>                Set Location to 8 268
55619>>>>>                Set Color to clBtnFace
55620>>>>>                Set Label_Col_Offset to 2
55621>>>>>                Set Label_Justification_Mode to jMode_Right
55622>>>>>                Set Enabled_State to FALSE
55623>>>>>                Set Item_Shadow_State Item 0 to TRUE
55624>>>>>                Set Shadow_State Item 0 to TRUE
55625>>>>>            End_Object    // frmYear
55626>>>>>
55626>>>>>            Object TextBoxSub11 is a TextBoxSub
55628>>>>>                Set Label to "„«˜ ¨œå˜"
55629>>>>>                Set Location to 8 3
55630>>>>>                Set Size to 10 30
55631>>>>>            End_Object    // TextBoxSub11
55632>>>>>
55632>>>>>            Object TextBoxSub12 is a TextBoxSub
55634>>>>>                Set Label to "“§¦¡/£˜"
55635>>>>>                Set Location to 9 109
55636>>>>>                Set Size to 10 33
55637>>>>>            End_Object    // TextBoxSub12
55638>>>>>
55638>>>>>            Object TextBoxSub13 is a TextBoxSub
55640>>>>>                Set Label to "•¨ã©ž           "
55641>>>>>                Set Location to 8 234
55642>>>>>                Set Size to 10 29
55643>>>>>            End_Object    // TextBoxSub13
55644>>>>>
55644>>>>>        End_Object    // grpYear
55645>>>>>
55645>>>>>        Object oClear_bn is a ButtonSub
55647>>>>>            Set Label to "€¡ç¨à©ž (F5)"
55648>>>>>            Set Size to 18 53
55649>>>>>            Set Location to 193 3
55650>>>>>            Set Focus_Mode to Pointer_Only
55651>>>>>
55651>>>>>            //AB-StoreStart
55651>>>>>                                                                                                        
55651>>>>>            Set MDI_Container to (R044(Self))
55652>>>>>            
55652>>>>>            Procedure OnClick
55654>>>>>                Delegate Send Request_Clear
55656>>>>>                Forward Send OnClick
55658>>>>>            End_Procedure // OnClick
55659>>>>>            
55659>>>>>            
55659>>>>>            
55659>>>>>            
55659>>>>>            //AB-StoreEnd
55659>>>>>
55659>>>>>        End_Object    // oClear_bn
55660>>>>>
55660>>>>>        Object Textbox1 is a Textbox
55662>>>>>            Set Label to "“§¦¡˜«á©«ž£˜"
55663>>>>>            Set Location to 172 5
55664>>>>>            Set Size to 10 54
55665>>>>>            Set FontWeight to 600
55666>>>>>        End_Object    // Textbox1
55667>>>>>
55667>>>>>        Object branch_name is a FormSub
55669>>>>>            Set Size to 13 145
55670>>>>>            Set Location to 170 161
55671>>>>>            Set Label_Col_Offset to 2
55672>>>>>
55672>>>>>            //AB-StoreStart
55672>>>>>            set enabled_state to false
55673>>>>>            //AB-StoreEnd
55673>>>>>
55673>>>>>        End_Object    // branch_name
55674>>>>>
55674>>>>>
55674>>>>>        //AB-StoreStart
55674>>>>>                
55674>>>>>        Property String     pdDate_To           ""
55676>>>>>        Property String     pdDate_From         ""
55678>>>>>        
55678>>>>>        //jsjsjs 29/01/2001
55678>>>>>        //Property Number pnSelArthro     0
55678>>>>>        //Property Number pnSelArthro_1   0
55678>>>>>        //Property Number pnSelArthro_2   0
55678>>>>>        //Property Integer    piBtypKin_Code_From  0
55678>>>>>        //Property Integer    piBtypKin_Code_To    0
55678>>>>>        Property String psBtypKin_Recr_From     ''
55680>>>>>        Property String psBtypKin_recr_To       ''
55682>>>>>        Property String psSelArthro             ''
55684>>>>>        Property String psSelArthro_1           ''
55686>>>>>        Property String psSelArthro_2           ''
55688>>>>>        //jsjsjs 29/01/2001
55688>>>>>        
55688>>>>>        Property Integer piSeries 0
55690>>>>>        Property Integer piKeepSectionTogether 0 //All one by one currencies
55692>>>>>        Property Integer piState1 0
55694>>>>>        Property Integer piState2 0
55696>>>>>        Property Integer piState3 0
55698>>>>>        Property Integer piFromGmoveView False
55700>>>>>        
55700>>>>>        Procedure PrintCurrArthro String asSelectedArthro String asPrinter String lsBtypkinRecr Date ldBarticlHmnia
55702>>>>>            Integer liRptId
55703>>>>>            Set psSelArthro to asSelectedArthro
55704>>>>>            if (psSelArthro(Self) <> '') Begin
55706>>>>>                Set pdDate_To           to ldBarticlHmnia
55707>>>>>                Set pdDate_From         to ldBarticlHmnia
55708>>>>>                Set psBtypKin_Recr_From to lsBtypkinRecr
55709>>>>>                Set psBtypKin_Recr_To   to lsBtypkinRecr
55710>>>>>                Get Report_Object_Id    to liRptId
55711>>>>>                If (liRptId) Send Rebuild_Constraints to liRptId
55714>>>>>                Set piFromGmoveView     to True
55715>>>>>                If (asPrinter = "") Move "lpt1:" to asPrinter
55718>>>>>                Set Output_Device_Name  To asPrinter
55719>>>>>                Send Run_Report
55720>>>>>                Set piFromGmoveView     to False
55721>>>>>                Set psSelArthro         to ''
55722>>>>>                Set pdDate_To           to ''
55723>>>>>                Set pdDate_From         to ''
55724>>>>>                Set psBtypKin_Recr_From to ''
55725>>>>>                Set psBtypKin_Recr_To   to ''
55726>>>>>            end
55726>>>>>>
55726>>>>>        End_Procedure // PrintCurrArthro
55727>>>>>        
55727>>>>>        Procedure StartReport
55729>>>>>            Integer iOutputDevice liRptId
55730>>>>>            String  FileName
55730>>>>>            Date ldDate_From ldDate_To
55730>>>>>            Integer liGthaa_044
55730>>>>>            String lsSelArthro_1 lsSelArthro_2 lsBtypKin_Recr_From lsBtypKin_Recr_To
55730>>>>>            Integer liState1 liState2 liState3 liKeepSectionTogether
55730>>>>>        
55730>>>>>            Get Output_Device_Mode To iOutputDevice
55731>>>>>        
55731>>>>>            If iOutputDevice EQ PRINT_TO_WINDOW Begin
55733>>>>>               Make_Temp_File "TXT" FileName
55734>>>>>               Move (".\" - FileName)  To FileName
55735>>>>>               Set Output_Device_Name  To FileName
55736>>>>>            End
55736>>>>>>
55736>>>>>            Else If iOutputDevice EQ PRINT_TO_PRINTER ;               Set Output_Device_Name  To "Lpt1:"
55740>>>>>            Else If iOutputDevice EQ PRINT_TO_FILE Begin
55743>>>>>               Get Value of (frmFile(rdgSelectPrint (Self))) Item 0 to FileName
55744>>>>>               If (FileName = "") Make_Temp_File "TXT" FileName
55747>>>>>               Move (".\" - FileName)  To FileName
55748>>>>>               Set Output_Device_Name  To FileName
55749>>>>>            End
55749>>>>>>
55749>>>>>        
55749>>>>>            Get value of (FormSub1(GroupSub2(Self))) item 0 to ldDate_From
55750>>>>>            Set pdDate_From to ldDate_From
55751>>>>>            Get value of (FormSub2(GroupSub2(Self))) item 0 to ldDate_To
55752>>>>>            Set pdDate_To to ldDate_To
55753>>>>>        
55753>>>>>            Get value of (FrmG1(GroupSub3(Self))) item 0 to lsBtypKin_Recr_From
55754>>>>>            Set psBtypKin_Recr_From to (Trim(lsBtypKin_Recr_From))
55755>>>>>            Get value of (FrmG2(GroupSub3(Self))) item 0 to lsBtypKin_Recr_To
55756>>>>>            Set psBtypKin_Recr_To to (Trim(lsBtypKin_Recr_To))
55757>>>>>        
55757>>>>>            Get value of (FrmG12_3(GroupSub1(Self))) item 0 to lsSelArthro_1
55758>>>>>            Set psSelArthro_1 to (Trim(lsSelArthro_1))
55759>>>>>            Get value of (FrmG12_4(GroupSub1(Self))) item 0 to lsSelArthro_2
55760>>>>>            Set psSelArthro_2 to (Trim(lsSelArthro_2))
55761>>>>>        
55761>>>>>            Set piSeries to 0
55762>>>>>        
55762>>>>>            //--------------------------------------------------------------------------------
55762>>>>>            Get checked_State of (chkbCurr0(oSelectCurr(Self))) to liState1
55763>>>>>            Set piState1 to liState1
55764>>>>>            Get checked_State of (chkbCurr00(oSelectCurr(Self))) to liState2
55765>>>>>            Set piState2 to liState2
55766>>>>>            Get checked_State of (chkbCurrR(oSelectCurr(Self))) to liState3
55767>>>>>            Set piState3 to liState3
55768>>>>>            Get checked_State of (chkbKeepTogether(oSelectCurr(Self))) to liKeepSectionTogether
55769>>>>>            Set piKeepSectionTogether to liKeepSectionTogether
55770>>>>>            //--------------------------------------------------------------------------------
55770>>>>>        
55770>>>>>            Get Report_Object_Id to liRptId
55771>>>>>            If (liRptId) Send Rebuild_Constraints to liRptId
55774>>>>>        
55774>>>>>            if (piState1(Self) = 1) begin
55776>>>>>                    Set piSeries to 1 //Book1
55777>>>>>                    Set piState1 to 0
55778>>>>>                    Send Run_Report
55779>>>>>            end
55779>>>>>>
55779>>>>>            if (piState2(Self) = 1) begin
55781>>>>>                    Set piSeries to 2 //Book2
55782>>>>>                    Set piState2 to 0
55783>>>>>                    send Run_Report
55784>>>>>            end
55784>>>>>>
55784>>>>>            if (piState3(Self) = 1) begin
55786>>>>>                    Set piSeries to 3 //Reporting
55787>>>>>                    Set piState3 to 0
55788>>>>>                    send Run_Report
55789>>>>>            end
55789>>>>>>
55789>>>>>            If (piSeries(Self) = 0) send Run_Report
55792>>>>>        
55792>>>>>            if (piKeepSectionTogether(Self) = 1) begin
55794>>>>>                Set piKeepSectionTogether to 0
55795>>>>>                send page_bottom to (BMoves_BasicReport(Self))
55796>>>>>                formfeed
55797>>>>>>
55797>>>>>            end
55797>>>>>>
55797>>>>>        
55797>>>>>            If iOutputDevice EQ PRINT_TO_WINDOW Begin
55799>>>>>               //Send DoRunEditor FileName "Empor"
55799>>>>>               RunProgram background "NotePad" FileName
55800>>>>>               EraseFile FileName
55801>>>>>>
55801>>>>>            End
55801>>>>>>
55801>>>>>        End_Procedure   // StartReport
55802>>>>>        
55802>>>>>        Function Bank_Descr String asCode Returns string
55804>>>>>            String lsDescr
55805>>>>>        
55805>>>>>            Clear Codemast
55806>>>>>            Move "BANK" to CodeMast.Type
55807>>>>>            Move asCode to CodeMast.Code
55808>>>>>            Find eq Codemast by Index.1
55809>>>>>>
55809>>>>>            [Found] Move (Trim(Codemast.Description)) to lsDescr
55810>>>>>            Function_Return lsDescr
55811>>>>>        End_Function // Bank_Descr
55812>>>>>        
55812>>>>>        Object BMoves_BasicReport is a BasicReportSub
55814>>>>>        
55814>>>>>            if (piKeepSectionTogether(Self) = 1) begin
55816>>>>>                set new_page_state to false
55817>>>>>            end
55817>>>>>>
55817>>>>>        
55817>>>>>           Set report_view_id to (Parent(Self))
55818>>>>>           set report_caption to "ƒ ˜› ¡˜©å˜ ©œ œ¥â¢ ¥ž             "
55819>>>>>           set report_title to "„¡«ç§à©ž €¨Ÿ¨à¤                     "
55820>>>>>           Report_Main_File BMove
55821>>>>>           Report_breaks Bmove.Barticl_Hmnia Bmove.Barticl_Recr
55835>>>>>        
55835>>>>>           Procedure Constrain
55837>>>>>                //jsjsjs 29/01/2001 Number lnSelArthro lnSelArthro_1 lnSelArthro_2
55837>>>>>                String lsSelArthro lsSelArthro_1 lsSelArthro_2 sbranch
55838>>>>>                Integer liGarticlStatusE
55838>>>>>                get psbranch to sbranch
55839>>>>>                Constrain Bmove.Company_Code eq SysCurXr.Company_Code
55841>>>>>                if (sbranch<>'');                    Constrain Bmove.Branch_Code  eq Sbranch
55845>>>>>                Constrain Bmove.Year_Year    eq SysCurXr.Year_Year
55847>>>>>        
55847>>>>>                Get psSelArthro     to lsSelArthro
55848>>>>>                Get psSelArthro_1   to lsSelArthro_1
55849>>>>>                Get psSelArthro_2   to lsSelArthro_2
55850>>>>>        
55850>>>>>                If (pdDate_From        (Self)<>'')  Constrain Bmove.Barticl_Hmnia ge (pdDate_From(Self))
55854>>>>>                If (pdDate_To          (Self)<>'')  Constrain Bmove.Barticl_Hmnia le (pdDate_To(Self))
55858>>>>>                if (psBtypKin_Recr_From(Self)<>'')  Constrain Bmove.Btypkin_Recr  ge (psBtypKin_Recr_From(Self))
55862>>>>>                if (psBtypKin_Recr_To  (Self)<>'')  Constrain Bmove.Btypkin_Recr  le (psBtypKin_Recr_To(Self))
55866>>>>>                if (lsSelArthro              <>'')  Constrain Bmove.Barticl_recr  eq lsSelArthro
55870>>>>>                Else if ((lsSelArthro_1<>'') OR (lsSelArthro_2 <> '')) Begin
55873>>>>>                     If  (lsSelArthro_1<>'') Constrain Bmove.Barticl_recr ge lsSelArthro_1
55877>>>>>                     If  (lsSelArthro_2<>'') Constrain Bmove.Barticl_recr le lsSelArthro_2
55881>>>>>                End
55881>>>>>>
55881>>>>>                Forward Send Constrain
55883>>>>>           End_Procedure // Constrain
55884>>>>>        
55884>>>>>           Function Starting_Report Returns Integer
55886>>>>>                Zero_SubTotals SubHeaderR044_1.10
55887>>>>>                Zero_SubTotals BodyR044.7 BodyR044.10 RecParArticl.1
55890>>>>>                Zero_SubTotals SubtotalR044_2.1 SubtotalR044_2.2
55892>>>>>           End_Function // Starting_Report
55893>>>>>        
55893>>>>>           Function Starting_Main_Report Returns Integer
55895>>>>>              Integer iRetVal
55896>>>>>              Integer iIndexR044 liRepPanelId
55896>>>>>              Forward Get Starting_Main_Report to iRetval
55898>>>>>        
55898>>>>>              If (piFromGmoveView(Self)) Begin
55900>>>>>                   Move 5 to iIndexR044  //
55901>>>>>              End
55901>>>>>>
55901>>>>>              Else Begin
55902>>>>>                   Move 5 to iIndexR044
55903>>>>>              End
55903>>>>>>
55903>>>>>              Report_Index BY iIndexR044    // set the sort order
55905>>>>>              Blankform FooterR044_1.1
55906>>>>>>
55906>>>>>              Get Report_Status_Panel to liRepPanelId
55907>>>>>              set button_text of lireppanelid to "&€¡ç¨à©ž"
55908>>>>>              Set page_feed to  0 //66 // default -2
55909>>>>>              Set page_end  to 63    // default 59
55910>>>>>              Function_Return iRetval
55911>>>>>           End_Function
55912>>>>>        
55912>>>>>           Procedure_Section Page_Top as HeaderR044
55917>>>>>              Integer iPage
55917>>>>>              string sbranch
55917>>>>>              Get Page_Count  To iPage
55918>>>>>              get psbranch    to sbranch
55919>>>>>              clear branch
55920>>>>>              move syscurxr.company_code to branch.company_code
55921>>>>>              move sbranch               to branch.branch_code
55922>>>>>              find eq branch by index.1
55923>>>>>>
55923>>>>>              if (found=1) print branch.branch_name to HeaderR044.2
55926>>>>>              else         print ''                 to HeaderR044.2
55928>>>>>              print SysCurXr.Company_Name to HeaderR044.1
55929>>>>>            //  print SysCurXr.Branch_Name  to HeaderR044.2
55929>>>>>              print SysCurXr.Year_Descr   to HeaderR044.3
55930>>>>>        
55930>>>>>             // Print iPage                to HeaderR044.7
55930>>>>>              OutPut_PageCheck
55931>>>>>           End_Procedure
55932>>>>>        
55932>>>>>           Procedure_Section SubHeader1
55934>>>>>           End_Procedure // SubHeader1
55935>>>>>        
55935>>>>>           Procedure_Section SubHeader2 as SubheaderR044_1
55940>>>>>              Integer iPage liSeries
55940>>>>>              Number lnYpol
55940>>>>>              String lsCCode
55940>>>>>        
55940>>>>>        
55940>>>>>              Get piSeries to liSeries
55941>>>>>              Print Btypkin.Btypkin_Pdescr to SubheaderR044_1.1
55942>>>>>              Print Btypkin.Btypkin_Seira  to SubheaderR044_1.2
55943>>>>>              Print Btypkin.Btypkin_Code   to SubheaderR044_1.3
55944>>>>>              Print Barticl.Barticl_No     to SubheaderR044_1.4
55945>>>>>              Print Barticl.Barticl_Rec0   to SubheaderR044_1.5
55946>>>>>              Print Barticl.Barticl_Hmnia  to SubheaderR044_1.6
55947>>>>>              Print Barticl.Barticl_Epon1  to SubheaderR044_1.7
55948>>>>>              Print Barticl.Barticl_Epon2  to SubheaderR044_1.8
55949>>>>>        
55949>>>>>              If (liSeries = 1) Begin
55951>>>>>                Move Barticl.Barticl_Sv0  to lnYpol
55952>>>>>                Move Year.Year_C_Code0    to lsCCode
55953>>>>>              End
55953>>>>>>
55953>>>>>              Else If (liSeries = 2) Begin
55956>>>>>                Move Barticl.Barticl_Sv00 to lnYpol
55957>>>>>                Move Year.Year_C_Code00   to lsCCode
55958>>>>>              End
55958>>>>>>
55958>>>>>              Else If (liSeries = 3) Begin
55961>>>>>                Move Barticl.Barticl_SvR  to lnYpol
55962>>>>>                Move Year.Year_C_CodeR    to lsCCode
55963>>>>>              End
55963>>>>>>
55963>>>>>              Else If (liSeries = 0) Begin
55966>>>>>                Move Barticl.Barticl_Sv0  to lnYpol
55967>>>>>                Move Year.Year_C_Code0    to lsCCode
55968>>>>>              End
55968>>>>>>
55968>>>>>              Print lscCode                to SubheaderR044_1.9
55969>>>>>              Print lnYpol                 to SubheaderR044_1.10
55970>>>>>              Print Barticl.Barticl_Aitiol to SubheaderR044_1.11
55971>>>>>        
55971>>>>>              OutPut_PageCheck
55972>>>>>           End_Procedure
55973>>>>>        
55973>>>>>           Procedure_Section  Body as BodyR044
55978>>>>>             Integer liSeries
55978>>>>>             Number lnAjia
55978>>>>>             String lsCCode
55978>>>>>        
55978>>>>>             send update_status ('„šš¨˜­ã ' + string(barticl.barticl_hmnia) + ":" +  string(bmove.bmove_rec0))
55979>>>>>             Get piSeries to liSeries
55980>>>>>             Print Bmove.Bmove_aa                to BodyR044.1
55981>>>>>             Print Baxiokat.Baxiokat_Descr       to BodyR044.2
55982>>>>>             Print Baxio.Baxio_Code              to BodyR044.3
55983>>>>>             Print (Bank_Descr(Self,Baxio.Baxio_Banka))    to BodyR044.4
55984>>>>>             Print Baxio.Baxio_No                to BodyR044.5
55985>>>>>        
55985>>>>>             Print Baxio.Baxio_C_Code2           to BodyR044.6
55986>>>>>             Print Baxio.Baxio_V2                to BodyR044.7 //{ points=2} //Reccord
55987>>>>>        
55987>>>>>             Print Baxio.Baxio_Hmnial            to BodyR044.8
55988>>>>>        
55988>>>>>             if (liSeries = 1) begin
55990>>>>>                Move Year.Year_C_Code0  to lsCCode
55991>>>>>                Move Baxio.Baxio_V0     to lnAjia
55992>>>>>             end
55992>>>>>>
55992>>>>>             if (liSeries = 2) begin
55994>>>>>                Move Year.Year_C_Code00 to lsCCode
55995>>>>>                Move Baxio.Baxio_V00    to lnAjia
55996>>>>>             End
55996>>>>>>
55996>>>>>             if (liSeries = 3) begin
55998>>>>>                Move Year.Year_C_CodeR  to lsCCode
55999>>>>>                 Move Baxio.Baxio_VR    to lnAjia
56000>>>>>             End
56000>>>>>>
56000>>>>>             if (liSeries = 0) begin
56002>>>>>                Move Year.Year_C_Code0  to lsCCode
56003>>>>>                Move Baxio.Baxio_V0     to lnAjia
56004>>>>>             end
56004>>>>>>
56004>>>>>        
56004>>>>>             Print lsCCode                       to BodyR044.9  //{ points=2} BOOK
56005>>>>>             Print lnAjia                        to BodyR044.10 //{ points=2} BOOK
56006>>>>>             Add 1 to RecParArticl.1
56007>>>>>             OutPut_PageCheck
56008>>>>>           End_Procedure
56009>>>>>        
56009>>>>>           Procedure_Section  Subtotal2 as SubtotalR044_2
56014>>>>>        
56014>>>>>             Print    RecParArticl.1   to SubtotalR044_2.1
56015>>>>>             Subtotal BodyR044.10      to SubtotalR044_2.2 //{ points=2}
56017>>>>>             BlankForm RecParArticl.1
56018>>>>>>
56018>>>>>        
56018>>>>>             OutPut_PageCheck
56019>>>>>           end_Procedure  // Subtotal2
56020>>>>>        
56020>>>>>           Procedure_Section  Subtotal1 as SubtotalR044_1
56025>>>>>        
56025>>>>>             //Subtotal SubtotalR044_2.2 to SubtotalR044_1.1 { points=2}
56025>>>>>             //Subtotal SubtotalR044_2.3 to SubtotalR044_1.2 { points=2}
56025>>>>>        
56025>>>>>             //If (piFromGmoveView(Self)=0) OutPut_PageCheck
56025>>>>>        
56025>>>>>           end_Procedure // Subtotal1
56026>>>>>        
56026>>>>>           Procedure_Section Page_Bottom as FooterR044_1
56035>>>>>               if (piKeepSectionTogether(self) <> 1)  OutPut_PageCheck
56038>>>>>           End_Procedure
56039>>>>>        
56039>>>>>        
56039>>>>>           Procedure Ending_Report
56041>>>>>               Integer rVal
56042>>>>>               Blankform SubtotalR044_2.1
56043>>>>>>
56043>>>>>               // „§˜¤˜­¦¨á «à¤ Buffers
56043>>>>>               Get fiRefindYear to rVal
56044>>>>>           End_Procedure
56045>>>>>        
56045>>>>>        End_Object // GMoves_BasicReport
56046>>>>>        
56046>>>>>        Procedure Activate_View Returns Integer
56048>>>>>            Integer Rval
56049>>>>>            Forward Get MSG_Activate_View   to Rval
56051>>>>>            If (Not(rVal))  Begin
56053>>>>>                Set Value of (frmCompany(grpYear(Self))) to SysCurXr.Company_Name
56054>>>>>                Set Value of (frmBranch(grpYear(Self)))  to SysCurXr.Branch_Name
56055>>>>>                Set Value of (frmYear(grpYear(Self)))    to SysCurXr.Year_Descr
56056>>>>>                set value of (formsub5(self))            to SysCurXr.Branch_code
56057>>>>>                set label of (chkbCurr0(oSelectCurr(Self)))  To SysCurXr.C_Code0
56058>>>>>                set label of (chkbCurr00(oSelectCurr(Self))) To SysCurXr.C_Code00
56059>>>>>                set label of (chkbCurrR(oSelectCurr(Self)))  To SysCurXr.C_CodeR
56060>>>>>                Set checked_State of (chkbCurr0(oSelectCurr(Self))) to 1
56061>>>>>            End
56061>>>>>>
56061>>>>>            Procedure_Return rVal
56062>>>>>        End_Procedure // Activate_View
56063>>>>>        
56063>>>>>        Procedure Request_Clear
56065>>>>>            Set Value of (FormSub1(GroupSub2(Self))) Item 0 to ""
56066>>>>>            Set Value of (FormSub2(GroupSub2(Self))) Item 0 to ""
56067>>>>>            Set Value of (frmG12_3(GroupSub1(Self))) Item 0 to ""
56068>>>>>            Set Value of (frmG12_4(GroupSub1(Self))) Item 0 to ""
56069>>>>>            Set Value of (frmG1(GroupSub3(Self))) Item 0 to ""
56070>>>>>            Set Value of (frmG2(GroupSub3(Self))) Item 0 to ""
56071>>>>>            Set checked_State of (chkbCurr0(oSelectCurr(Self))) to True
56072>>>>>            Set checked_State of (chkbCurr00(oSelectCurr(Self))) to False
56073>>>>>            Set checked_State of (chkbCurrR(oSelectCurr(Self))) to False
56074>>>>>            Set checked_State of (chkbKeepTogether(oSelectCurr(Self))) to False
56075>>>>>            Send Activate to (FormSub1(GroupSub2(Self)))
56076>>>>>        End_Procedure // Request_Clear
56077>>>>>        
56077>>>>>        //Set Verify_Exit_Msg To Get_No_Confirmation
56077>>>>>        On_Key kSave_Record Send KeyAction to oPrint_bn
56078>>>>>        On_Key kCancel      Send KeyAction to oExit_bn
56079>>>>>        On_Key kClear       Send Request_Clear
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        
56080>>>>>        //AB-StoreEnd
56080>>>>>
56080>>>>>    End_Object    // R044
56081>>>>>
56081>>>>>
56081>>>>>    //AB-StoreStart
56081>>>>>            
56081>>>>>            
56081>>>>>            
56081>>>>>            
56081>>>>>            
56081>>>>>            
56081>>>>>    //AB-StoreEnd
56081>>>>>
56081>>>>>//AB/     End_Object    // prj
56081>>>Use v037.vw
INCLUDING FILE: V037.VW
56081>>>>>//AB/ Project V037:BAXIO
56081>>>>>//AB/ Object prj is a View_Project
56081>>>>>//AB/     Set ProjectName to "V037:BAXIO"
56081>>>>>//AB/     Set ProjectFileName to "V037.VW"
56081>>>>>
56081>>>>>// Project Object Structure
56081>>>>>//   VW037 is a dbViewSub
56081>>>>>//     Btypkin_DD is a DataDictionary
56081>>>>>//     Baxiokat_DD is a DataDictionary
56081>>>>>//     Barticl_DD is a DataDictionary
56081>>>>>//     Baxio_DD is a DataDictionary
56081>>>>>//     Syscurxr_DD is a DataDictionary
56081>>>>>//     Bmove_DD is a DataDictionary
56081>>>>>//     Baxiokat_Baxiokat_Code is a dbFormSub
56081>>>>>//     Baxiokat_Baxiokat_Descr is a dbFormSub
56081>>>>>//     Baxio_Baxio_Code is a dbFormSub
56081>>>>>//     Baxio_Baxio_Status is a dbFormSub
56081>>>>>//     Baxio_Baxio_Place is a dbFormSub
56081>>>>>//     dbTbDlgAxio is a dbTabDialogSub
56081>>>>>//       TP_Additional is a dbTabPage
56081>>>>>//         dbGrpObligate is a dbGroupSub
56081>>>>>//           Baxio_Baxio_Hmnial is a dbFormSub
56081>>>>>//           Baxio_Baxio_V4 is a dbFormSub
56081>>>>>//           Rate0 is a dbFormSub
56081>>>>>//           Rate00 is a dbFormSub
56081>>>>>//           RateR is a dbFormSub
56081>>>>>//           TextBoxSub3 is a TextBoxSub
56081>>>>>//           TextBoxSub4 is a TextBoxSub
56081>>>>>//           TextBoxSub5 is a TextBoxSub
56081>>>>>//           txtnom1 is a TextBoxSub
56081>>>>>//           txtnom2 is a TextBoxSub
56081>>>>>//           txtnom3 is a TextBoxSub
56081>>>>>//           Baxio_Baxio_C_Code2 is a dbFormSub
56081>>>>>//         dbGrpOptional is a dbGroupSub
56081>>>>>//           Baxio_Baxio_Ekdoths is a dbFormSub
56081>>>>>//           Baxio_Baxio_Ekdothse is a dbFormSub
56081>>>>>//           Baxio_Baxio_Sediatagh is a dbFormSub
56081>>>>>//           Baxio_Baxio_Sdiataghe is a dbFormSub
56081>>>>>//           Baxio_Baxio_Banka is a dbComboFormSub
56081>>>>>//           Baxio_Baxio_No is a dbFormSub
56081>>>>>//           Baxio_Baxio_From is a dbComboFormSub
56081>>>>>//           Baxio_Baxio_Topos is a dbComboFormSub
56081>>>>>//           Baxio_Baxio_Opistho is a dbEditSub
56081>>>>>//           TextBoxSub6 is a TextBoxSub
56081>>>>>//           TextBoxSub7 is a TextBoxSub
56081>>>>>//           TextBoxSub8 is a TextBoxSub
56081>>>>>//           TextBoxSub9 is a TextBoxSub
56081>>>>>//           TextBoxSub10 is a TextBoxSub
56081>>>>>//           TextBoxSub11 is a TextBoxSub
56081>>>>>//           TextBoxSub12 is a TextBoxSub
56081>>>>>//           Textbox3 is a Textbox
56081>>>>>//           Textbox4 is a Textbox
56081>>>>>//       TP_Status is a dbTabPage
56081>>>>>//         dbGrpEispraktea is a dbGroupSub
56081>>>>>//           Baxio_Baxio_Fbarticl is a dbFormSub
56081>>>>>//           Baxio_Baxio_Code_In is a dbFormSub
56081>>>>>//           Baxio_Baxio_Epon_In is a dbFormSub
56081>>>>>//           dbFrmHmnia is a dbFormSub
56081>>>>>//           dbFrmNo is a dbFormSub
56081>>>>>//           dbFrmGtypkin is a dbFormSub
56081>>>>>//           TextBoxSub18 is a TextBoxSub
56081>>>>>//           TextBoxSub19 is a TextBoxSub
56081>>>>>//           TextBoxSub24 is a TextBoxSub
56081>>>>>//           TextBoxSub27 is a TextBoxSub
56081>>>>>//           TextBoxSub30 is a TextBoxSub
56081>>>>>//         dbGrpPlhrotea is a dbGroupSub
56081>>>>>//           Baxio_Baxio_Lbarticl is a dbFormSub
56081>>>>>//           Baxio_Baxio_Code_Out is a dbFormSub
56081>>>>>//           Baxio_Baxio_Epon_Out is a dbFormSub
56081>>>>>//           dbFrmHmnia is a dbFormSub
56081>>>>>//           dbFrmNo is a dbFormSub
56081>>>>>//           dbFrmGtypkin is a dbFormSub
56081>>>>>//           TextBoxSub20 is a TextBoxSub
56081>>>>>//           TextBoxSub21 is a TextBoxSub
56081>>>>>//           TextBoxSub25 is a TextBoxSub
56081>>>>>//           TextBoxSub28 is a TextBoxSub
56081>>>>>//           TextBoxSub31 is a TextBoxSub
56081>>>>>//         dbGrpCurrentStat is a dbGroupSub
56081>>>>>//           Baxio_Baxio_Lcode is a dbFormSub
56081>>>>>//           Baxio_Baxio_Lepon is a dbFormSub
56081>>>>>//           Baxio_Baxio_Lpar is a dbFormSub
56081>>>>>//           dbFrmHmnia is a dbFormSub
56081>>>>>//           dbFrmNo is a dbFormSub
56081>>>>>//           dbFrmGtypkin is a dbFormSub
56081>>>>>//           TextBoxSub22 is a TextBoxSub
56081>>>>>//           TextBoxSub23 is a TextBoxSub
56081>>>>>//           TextBoxSub26 is a TextBoxSub
56081>>>>>//           TextBoxSub29 is a TextBoxSub
56081>>>>>//           TextBoxSub32 is a TextBoxSub
56081>>>>>//       TP_Bmove is a dbTabPage
56081>>>>>//         grdBmove is a dbGridSub
56081>>>>>//     dbGrpYear is a dbGroupSub
56081>>>>>//       Company_Company_Name is a dbFormSub
56081>>>>>//       Branch_Branch_Name is a dbFormSub
56081>>>>>//       Year_Year_Year is a dbFormSub
56081>>>>>//       otxtCompany is a TextBoxSub
56081>>>>>//       otxtBranch is a TextBoxSub
56081>>>>>//       otxtYear is a TextBoxSub
56081>>>>>//     TextBoxSub1 is a TextBoxSub
56081>>>>>//     TextBoxSub2 is a TextBoxSub
56081>>>>>//     TextBoxSub13 is a TextBoxSub
56081>>>>>//     TextBoxSub14 is a TextBoxSub
56081>>>>>
56081>>>>>// Register all objects
56081>>>>>Register_Object Barticl_DD
56081>>>>>Register_Object Baxio_Baxio_Banka
56081>>>>>Register_Object Baxio_Baxio_C_Code2
56081>>>>>Register_Object Baxio_Baxio_Code
56081>>>>>Register_Object Baxio_Baxio_Code_In
56081>>>>>Register_Object Baxio_Baxio_Code_Out
56081>>>>>Register_Object Baxio_Baxio_Ekdoths
56081>>>>>Register_Object Baxio_Baxio_Ekdothse
56081>>>>>Register_Object Baxio_Baxio_Epon_In
56081>>>>>Register_Object Baxio_Baxio_Epon_Out
56081>>>>>Register_Object Baxio_Baxio_Fbarticl
56081>>>>>Register_Object Baxio_Baxio_From
56081>>>>>Register_Object Baxio_Baxio_Hmnial
56081>>>>>Register_Object Baxio_Baxio_Lbarticl
56081>>>>>Register_Object Baxio_Baxio_Lcode
56081>>>>>Register_Object Baxio_Baxio_Lepon
56081>>>>>Register_Object Baxio_Baxio_Lpar
56081>>>>>Register_Object Baxio_Baxio_No
56081>>>>>Register_Object Baxio_Baxio_Opistho
56081>>>>>Register_Object Baxio_Baxio_Place
56081>>>>>Register_Object Baxio_Baxio_Sdiataghe
56081>>>>>Register_Object Baxio_Baxio_Sediatagh
56081>>>>>Register_Object Baxio_Baxio_Status
56081>>>>>Register_Object Baxio_Baxio_Topos
56081>>>>>Register_Object Baxio_Baxio_V4
56081>>>>>Register_Object Baxio_DD
56081>>>>>Register_Object Baxiokat_Baxiokat_Code
56081>>>>>Register_Object Baxiokat_Baxiokat_Descr
56081>>>>>Register_Object Baxiokat_DD
56081>>>>>Register_Object Bmove_DD
56081>>>>>Register_Object Branch_Branch_Name
56081>>>>>Register_Object Btypkin_DD
56081>>>>>Register_Object Company_Company_Name
56081>>>>>Register_Object dbFrmGtypkin
56081>>>>>Register_Object dbFrmHmnia
56081>>>>>Register_Object dbFrmNo
56081>>>>>Register_Object dbGrpCurrentStat
56081>>>>>Register_Object dbGrpEispraktea
56081>>>>>Register_Object dbGrpObligate
56081>>>>>Register_Object dbGrpOptional
56081>>>>>Register_Object dbGrpPlhrotea
56081>>>>>Register_Object dbGrpYear
56081>>>>>Register_Object dbTbDlgAxio
56081>>>>>Register_Object grdBmove
56081>>>>>Register_Object otxtBranch
56081>>>>>Register_Object otxtCompany
56081>>>>>Register_Object otxtYear
56081>>>>>Register_Object Rate0
56081>>>>>Register_Object Rate00
56081>>>>>Register_Object RateR
56081>>>>>Register_Object Syscurxr_DD
56081>>>>>Register_Object TextBoxSub1
56081>>>>>Register_Object TextBoxSub10
56081>>>>>Register_Object TextBoxSub11
56081>>>>>Register_Object TextBoxSub12
56081>>>>>Register_Object TextBoxSub13
56081>>>>>Register_Object TextBoxSub14
56081>>>>>Register_Object TextBoxSub18
56081>>>>>Register_Object TextBoxSub19
56081>>>>>Register_Object TextBoxSub2
56081>>>>>Register_Object TextBoxSub20
56081>>>>>Register_Object TextBoxSub21
56081>>>>>Register_Object TextBoxSub22
56081>>>>>Register_Object TextBoxSub23
56081>>>>>Register_Object TextBoxSub24
56081>>>>>Register_Object TextBoxSub25
56081>>>>>Register_Object TextBoxSub26
56081>>>>>Register_Object TextBoxSub27
56081>>>>>Register_Object TextBoxSub28
56081>>>>>Register_Object TextBoxSub29
56081>>>>>Register_Object TextBoxSub3
56081>>>>>Register_Object TextBoxSub30
56081>>>>>Register_Object TextBoxSub31
56081>>>>>Register_Object TextBoxSub32
56081>>>>>Register_Object TextBoxSub4
56081>>>>>Register_Object TextBoxSub5
56081>>>>>Register_Object TextBoxSub6
56081>>>>>Register_Object TextBoxSub7
56081>>>>>Register_Object TextBoxSub8
56081>>>>>Register_Object TextBoxSub9
56081>>>>>Register_Object Textbox3
56081>>>>>Register_Object Textbox4
56081>>>>>Register_Object TP_Additional
56081>>>>>Register_Object TP_Bmove
56081>>>>>Register_Object TP_Status
56081>>>>>Register_Object txtnom1
56081>>>>>Register_Object txtnom2
56081>>>>>Register_Object txtnom3
56081>>>>>Register_Object VW037
56081>>>>>Register_Object Year_Year_Year
56081>>>>>
56081>>>>>
56081>>>>>//AB/ AppBuild VIEW
56081>>>>>
56081>>>>>//AB-IgnoreStart
56081>>>>>
56081>>>>>Use dbView.Sub
56081>>>>>Use DFAllEnt.pkg
56081>>>>>Use dbForm.Sub
56081>>>>>Use dbTabdlg.Sub
56081>>>>>Use dbGroup.Sub
56081>>>>>Use Txtbox.Sub
56081>>>>>Use dbCmbfrm.Sub
56081>>>>>Use dbEdit.Sub
56081>>>>>Use dbGrid.Sub
56081>>>>>
56081>>>>>Use BTYPKIN.DD
56081>>>>>Use BAXIOKAT.DD
56081>>>>>Use BARTICL.DD
56081>>>>>Use BAXIO.DD
56081>>>>>Use SYSCURXR.DD
56081>>>>>Use BMOVE.DD
56081>>>>>
56081>>>>>//AB-IgnoreEnd
56081>>>>>
56081>>>>>ACTIVATE_VIEW Activate_VW037 FOR VW037
56085>>>>>
56085>>>>>Object VW037 is a dbViewSub
56087>>>>>
56087>>>>>    //AB-StoreTopStart
56087>>>>>                                                                    
56087>>>>>    //AB-StoreTopEnd
56087>>>>>
56087>>>>>    Set Label to "V037:€¥ æš¨˜­˜"
56088>>>>>    Set Size to 278 515
56089>>>>>    Set Location to 1 0
56090>>>>>
56090>>>>>    //AB-DDOStart
56090>>>>>
56090>>>>>    Object Btypkin_DD is a Btypkin_DataDictionary
56092>>>>>
56092>>>>>        //AB-StoreStart
56092>>>>>                                                                                                                
56092>>>>>        Set Field_Prompt_Object Field Btypkin.Btypkin_Code to None
56093>>>>>        
56093>>>>>        
56093>>>>>        
56093>>>>>        //AB-StoreEnd
56093>>>>>
56093>>>>>    End_Object    // Btypkin_DD
56094>>>>>
56094>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
56096>>>>>
56096>>>>>        //AB-StoreStart
56096>>>>>                                                                                                                
56096>>>>>        Set Field_Options Field Baxiokat.Baxiokat_Code  to DD_Clear_Field_Options DD_Required
56097>>>>>        
56097>>>>>        Set Foreign_Field_Options DD_IndexField         to DD_Clear_Field_Options DD_FindReq
56098>>>>>        Set Foreign_Field_Options DD_KeyField           to DD_Clear_Field_Options DD_FindReq
56099>>>>>        
56099>>>>>        
56099>>>>>        //AB-StoreEnd
56099>>>>>
56099>>>>>    End_Object    // Baxiokat_DD
56100>>>>>
56100>>>>>    Object Barticl_DD is a Barticl_DataDictionary
56102>>>>>        Set DDO_Server to (Btypkin_DD(self))
56103>>>>>
56103>>>>>        //AB-StoreStart
56103>>>>>                                                                                                                
56103>>>>>        Set Field_Prompt_Object Field Barticl.Barticl_Hmnia to None
56104>>>>>        Set Field_Prompt_Object Field Barticl.Barticl_No    to None
56105>>>>>        
56105>>>>>        //AB-StoreEnd
56105>>>>>
56105>>>>>    End_Object    // Barticl_DD
56106>>>>>
56106>>>>>    Object Baxio_DD is a Baxio_DataDictionary
56108>>>>>        Set DDO_Server to (Baxiokat_DD(self))
56109>>>>>
56109>>>>>        //AB-StoreStart
56109>>>>>                                                                                                                
56109>>>>>        Function Validate_Save Returns Integer
56111>>>>>            Integer rVal
56112>>>>>            Forward Get Validate_Save to rVal
56114>>>>>            If (Not(rval)) If (Not(Current_Record(Self))) Move 1 to rVal
56119>>>>>            Function_Return rVal
56120>>>>>        End_Procedure // Validate_Save
56121>>>>>        
56121>>>>>        
56121>>>>>        
56121>>>>>        
56121>>>>>        //AB-StoreEnd
56121>>>>>
56121>>>>>    End_Object    // Baxio_DD
56122>>>>>
56122>>>>>    Object Syscurxr_DD is a Syscurxr_DataDictionary
56124>>>>>    End_Object    // Syscurxr_DD
56125>>>>>
56125>>>>>    Object Bmove_DD is a Bmove_DataDictionary
56127>>>>>        Set DDO_Server to (Barticl_DD(self))
56128>>>>>        Set DDO_Server to (Baxio_DD(self))
56129>>>>>        Set Constrain_File to Baxio.File_Number
56130>>>>>
56130>>>>>        //AB-StoreStart
56130>>>>>                                                                                                                
56130>>>>>        Set Ordering to 4
56131>>>>>        
56131>>>>>        Function Validate_Save Returns Integer
56133>>>>>            Function_Return 1
56134>>>>>        End_Procedure // Validate_Save
56135>>>>>        
56135>>>>>        Function Validate_Delete  Returns Integer
56137>>>>>            Function_Return 1
56138>>>>>        End_Function // Validate_Delete
56139>>>>>        
56139>>>>>        
56139>>>>>        
56139>>>>>        
56139>>>>>        
56139>>>>>        //AB-StoreEnd
56139>>>>>
56139>>>>>    End_Object    // Bmove_DD
56140>>>>>
56140>>>>>    Set Main_DD to (Baxio_DD(self))
56141>>>>>    Set Server to (Baxio_DD(self))
56142>>>>>
56142>>>>>    //AB-DDOEnd
56142>>>>>
56142>>>>>    Object Baxiokat_Baxiokat_Code is a dbFormSub
56144>>>>>        Entry_Item Baxiokat.Baxiokat_code
56145>>>>>        Set Size to 13 42
56146>>>>>        Set Location to 36 41
56147>>>>>        Set Label_Col_Offset to 35
56148>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
56149>>>>>    End_Object    // Baxiokat_Baxiokat_Code
56150>>>>>
56150>>>>>    Object Baxiokat_Baxiokat_Descr is a dbFormSub
56152>>>>>        Entry_Item Baxiokat.Baxiokat_descr
56153>>>>>        Set Size to 13 182
56154>>>>>        Set Location to 36 86
56155>>>>>        Set Label_Col_Offset to 2
56156>>>>>        Set Label_Justification_Mode to jMode_Right
56157>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
56158>>>>>    End_Object    // Baxiokat_Baxiokat_Descr
56159>>>>>
56159>>>>>    Object Baxio_Baxio_Code is a dbFormSub
56161>>>>>        Entry_Item Baxio.Baxio_code
56162>>>>>        Set Size to 13 116
56163>>>>>        Set Location to 50 41
56164>>>>>        Set Label_Col_Offset to 35
56165>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
56166>>>>>
56166>>>>>        //AB-StoreStart
56166>>>>>                                                                                                                
56166>>>>>        Procedure Prompt_Callback Integer hPrompt
56168>>>>>            Integer liBaxiokatCode
56169>>>>>            Get Field_Current_Value of Baxiokat_DD Field Baxiokat.Baxiokat_Code to liBaxiokatCode
56170>>>>>            Set piFragmaBaxiokatCode of hPrompt to liBaxiokatCode
56171>>>>>            Set Auto_Index_State of hPrompt to False
56172>>>>>        End_Procedure // Prompt_Callback
56173>>>>>        
56173>>>>>        
56173>>>>>        
56173>>>>>        
56173>>>>>        
56173>>>>>        
56173>>>>>        //AB-StoreEnd
56173>>>>>
56173>>>>>    End_Object    // Baxio_Baxio_Code
56174>>>>>
56174>>>>>    Object Baxio_Baxio_Status is a dbFormSub
56176>>>>>
56176>>>>>        //AB-StoreTopStart
56176>>>>>                                                                                                                
56176>>>>>        Function Show_Status_Descr Returns String
56178>>>>>            Integer iValue iSrv iField iObj liStatusId
56179>>>>>            String sDesc sVal
56179>>>>>            If (Current_Record(Baxio_DD(Self))) Begin
56181>>>>>                Get Server of Baxio_Baxio_Status to iSrv
56182>>>>>                Get_FieldNumber Baxio.Baxio_Status to iField
56183>>>>>                Get Field_Current_Value of iSrv Field Baxio.Baxio_Status to sVal
56184>>>>>                Move Baxio_Status_VT to iObj
56185>>>>>                If (iObj) get Find_Code_Description of iObj sVal to sDesc
56188>>>>>                Function_Return sDesc
56189>>>>>            End
56189>>>>>>
56189>>>>>        End_Function // Show_Status_Descr
56190>>>>>        
56190>>>>>        //AB-StoreTopEnd
56190>>>>>
56190>>>>>        Entry_Item (Show_Status_Descr(Self))
56191>>>>>        Set Size to 13 116
56192>>>>>        Set Location to 36 340
56193>>>>>        Set Label_Col_Offset to 50
56194>>>>>
56194>>>>>        //AB-StoreStart
56194>>>>>                                                                                                                
56194>>>>>                                                                                                                
56194>>>>>        //AB-StoreEnd
56194>>>>>
56194>>>>>    End_Object    // Baxio_Baxio_Status
56195>>>>>
56195>>>>>    Object Baxio_Baxio_Place is a dbFormSub
56197>>>>>
56197>>>>>        //AB-StoreTopStart
56197>>>>>                                                                                                                
56197>>>>>        Function Show_Place_Descr Returns String
56199>>>>>            Integer iValue iSrv iField iObj liStatusId
56200>>>>>            String sDesc sVal
56200>>>>>            If (Current_Record(Baxio_DD(Self))) Begin
56202>>>>>                Get Server of Baxio_Baxio_Place to iSrv
56203>>>>>                Get_FieldNumber Baxio.Baxio_Place to iField
56204>>>>>                Get Field_Current_Value of iSrv Field Baxio.Baxio_Place to sVal
56205>>>>>                Move Baxio_Baxio_Place_VT to iObj
56206>>>>>                If (iObj) get Find_Code_Description of iObj sVal to sDesc
56209>>>>>                Function_Return sDesc
56210>>>>>            End
56210>>>>>>
56210>>>>>        End_Function // Show_Place_Descr
56211>>>>>        
56211>>>>>        //AB-StoreTopEnd
56211>>>>>
56211>>>>>        Entry_Item (Show_Place_Descr(Self))
56212>>>>>        Set Size to 13 116
56213>>>>>        Set Location to 50 340
56214>>>>>        Set Label_Col_Offset to 50
56215>>>>>
56215>>>>>        //AB-StoreStart
56215>>>>>                                                                                                                
56215>>>>>                                                                                                                
56215>>>>>                                                                                                                
56215>>>>>                                                                                                                
56215>>>>>                                                                                                                
56215>>>>>                                                                                                                
56215>>>>>        //AB-StoreEnd
56215>>>>>
56215>>>>>    End_Object    // Baxio_Baxio_Place
56216>>>>>
56216>>>>>    Object dbTbDlgAxio is a dbTabDialogSub
56218>>>>>        Set Size to 191 507
56219>>>>>        Set Location to 70 2
56220>>>>>        Object TP_Additional is a dbTabPage
56222>>>>>            Set Label to "¨æ©Ÿœ«˜"
56223>>>>>            Object dbGrpObligate is a dbGroupSub
56225>>>>>                Set Label to "“§¦®¨œà« ¡á ‘«¦ ®œå˜"
56226>>>>>                Set Size to 60 492
56227>>>>>                Set Location to 3 4
56228>>>>>                Set TextColor to clNavy
56229>>>>>                Object Baxio_Baxio_Hmnial is a dbFormSub
56231>>>>>                    Entry_Item Baxio.Baxio_hmnial
56232>>>>>                    Set Size to 13 66
56233>>>>>                    Set Location to 10 82
56234>>>>>                    Set Label_Col_Offset to 70
56235>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
56236>>>>>                End_Object    // Baxio_Baxio_Hmnial
56237>>>>>
56237>>>>>                Object Baxio_Baxio_V4 is a dbFormSub
56239>>>>>                    Entry_Item Baxio.Baxio_v2
56240>>>>>                    Set Size to 13 66
56241>>>>>                    Set Location to 40 82
56242>>>>>                    Set Label_Col_Offset to 70
56243>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
56244>>>>>
56244>>>>>                    //AB-StoreStart
56244>>>>>                                                                                                                                                                                                                                                    
56244>>>>>                    //Set Points Item 0 to 0
56244>>>>>                    //Set Numeric_Mask Item 0 to 14  0 ' ,*'
56244>>>>>                    
56244>>>>>                    Procedure End_Construct_Object
56246>>>>>                        Integer iDecimals
56247>>>>>                        Forward Send End_Construct_Object
56249>>>>>                        Get fiDekadika_Nomismatos  SysCurXr.C_Code0  to    iDecimals
56250>>>>>                        Set Points Item 0 to iDecimals
56251>>>>>                        Set Numeric_Mask Item 0 to 14 iDecimals ' ,*'
56252>>>>>                    End_Procedure
56253>>>>>                    
56253>>>>>                    
56253>>>>>                    //AB-StoreEnd
56253>>>>>
56253>>>>>                End_Object    // Baxio_Baxio_V4
56254>>>>>
56254>>>>>                Object Rate0 is a dbFormSub
56256>>>>>                    Entry_Item Baxio.Baxio_rate0
56257>>>>>                    Set Size to 13 46
56258>>>>>                    Set Location to 11 440
56259>>>>>                    Set Label_Col_Offset to 35
56260>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
56261>>>>>
56261>>>>>                    //AB-StoreStart
56261>>>>>                                                                                                                                                                                                                                                    
56261>>>>>                    Set Points Item 0 to 0
56262>>>>>                    Set Visible_State to False
56263>>>>>                    Set Enabled_State to False
56264>>>>>                    
56264>>>>>                    
56264>>>>>                    
56264>>>>>                    //AB-StoreEnd
56264>>>>>
56264>>>>>                End_Object    // Rate0
56265>>>>>
56265>>>>>                Object Rate00 is a dbFormSub
56267>>>>>                    Entry_Item Baxio.Baxio_rate00
56268>>>>>                    Set Size to 13 46
56269>>>>>                    Set Location to 26 440
56270>>>>>                    Set Label_Col_Offset to 35
56271>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
56272>>>>>
56272>>>>>                    //AB-StoreStart
56272>>>>>                                                                                                                                                                                                                                                    
56272>>>>>                    Set Points Item 0 to 2
56273>>>>>                    Set Visible_State to False
56274>>>>>                    Set Enabled_State to False
56275>>>>>                    
56275>>>>>                    //AB-StoreEnd
56275>>>>>
56275>>>>>                End_Object    // Rate00
56276>>>>>
56276>>>>>                Object RateR is a dbFormSub
56278>>>>>                    Entry_Item Baxio.Baxio_rater
56279>>>>>                    Set Size to 13 46
56280>>>>>                    Set Location to 41 440
56281>>>>>                    Set Label_Col_Offset to 35
56282>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
56283>>>>>
56283>>>>>                    //AB-StoreStart
56283>>>>>                                                                                                                                                                                                                                                    
56283>>>>>                    Set Points Item 0 to 2
56284>>>>>                    Set Visible_State to False
56285>>>>>                    Set Enabled_State to False
56286>>>>>                    
56286>>>>>                    
56286>>>>>                    //AB-StoreEnd
56286>>>>>
56286>>>>>                End_Object    // RateR
56287>>>>>
56287>>>>>                Object TextBoxSub3 is a TextBoxSub
56289>>>>>                    Set Label to "†£/¤å˜ Šã¥žª"
56290>>>>>                    Set Location to 11 18
56291>>>>>                    Set Size to 10 57
56292>>>>>                End_Object    // TextBoxSub3
56293>>>>>
56293>>>>>                Object TextBoxSub4 is a TextBoxSub
56295>>>>>                    Set Label to "Œæ£ ©£˜"
56296>>>>>                    Set Location to 24 18
56297>>>>>                    Set Size to 10 32
56298>>>>>                End_Object    // TextBoxSub4
56299>>>>>
56299>>>>>                Object TextBoxSub5 is a TextBoxSub
56301>>>>>                    Set Label to "¦©æ"
56302>>>>>                    Set Location to 39 18
56303>>>>>                    Set Size to 10 32
56304>>>>>                End_Object    // TextBoxSub5
56305>>>>>
56305>>>>>                Object txtnom1 is a TextBoxSub
56307>>>>>                    Set Label to "ˆ©¦« £å˜1"
56308>>>>>                    Set Location to 13 405
56309>>>>>                    Set Size to 10 31
56310>>>>>
56310>>>>>                    //AB-StoreStart
56310>>>>>                    Set Visible_State to False
56311>>>>>                    
56311>>>>>                    //AB-StoreEnd
56311>>>>>
56311>>>>>                End_Object    // txtnom1
56312>>>>>
56312>>>>>                Object txtnom2 is a TextBoxSub
56314>>>>>                    Set Label to "ˆ©¦« £å˜2"
56315>>>>>                    Set Location to 28 405
56316>>>>>                    Set Size to 10 31
56317>>>>>
56317>>>>>                    //AB-StoreStart
56317>>>>>                    Set Visible_State to False
56318>>>>>                    
56318>>>>>                    //AB-StoreEnd
56318>>>>>
56318>>>>>                End_Object    // txtnom2
56319>>>>>
56319>>>>>                Object txtnom3 is a TextBoxSub
56321>>>>>                    Set Label to "ˆ©¦« £å˜3"
56322>>>>>                    Set Location to 43 405
56323>>>>>                    Set Size to 10 31
56324>>>>>
56324>>>>>                    //AB-StoreStart
56324>>>>>                    Set Visible_State to False
56325>>>>>                    
56325>>>>>                    //AB-StoreEnd
56325>>>>>
56325>>>>>                End_Object    // txtnom3
56326>>>>>
56326>>>>>                Object Baxio_Baxio_C_Code2 is a dbFormSub
56328>>>>>
56328>>>>>                    //AB-StoreTopStart
56328>>>>>                    //Procedure Set_The_Decimal_Points
56328>>>>>                    //    Integer iContID
56328>>>>>                    //    String  sCode sPartlRecr
56328>>>>>                    //    date    dHmnia
56328>>>>>                    
56328>>>>>                    //    Move (dbGrpObligate(TP_Additional(dbtbDlgAxio(Self)))) to iContID
56328>>>>>                    
56328>>>>>                    //    Get Field_Current_Value Of Baxio_DD Field Baxio.Baxio_Sc_Code2 to sCode
56328>>>>>                    //    Move (Trim(sCode))  to sCode
56328>>>>>                    
56328>>>>>                    //    Clear Nomisma
56328>>>>>                    //    Move sCode to Nomisma.Nomisma_Code
56328>>>>>                    //    Find eq Nomisma by Index.1
56328>>>>>                    //    Set Points          Of (Axia(iContID)) Item  0 to Nomisma.Dekadika
56328>>>>>                    //    Set Numeric_Mask    Of (Axia(iContID)) Item  0 to 12 Nomisma.Dekadika "*,"
56328>>>>>                    
56328>>>>>                    //    Get Label Of (TxtNom1(iContID)) Item 0 to sCode
56328>>>>>                    //    Move (Trim(sCode))  to sCode
56328>>>>>                    //    Clear Nomisma
56328>>>>>                    //    Move sCode to Nomisma.Nomisma_Code
56328>>>>>                    //    Find eq Nomisma by Index.1
56328>>>>>                    //    Set Points          Of (X0(iContID)) Item  0 to Nomisma.Dekadika
56328>>>>>                    //    Set Points          Of (P0(iContID)) Item  0 to Nomisma.Dekadika
56328>>>>>                    //    Set Numeric_Mask Of (X0(iContID))          Item  0  to 12 Nomisma.Dekadika "*,"
56328>>>>>                    //    Set Numeric_Mask Of (P0(iContID))          Item  0  to 12 Nomisma.Dekadika "*,"
56328>>>>>                    
56328>>>>>                    //    Get Label Of (TxtNom2(iContID)) Item 0 to sCode
56328>>>>>                    //    Move (Trim(sCode))  to sCode
56328>>>>>                    //    Clear Nomisma
56328>>>>>                    //    Move sCode to Nomisma.Nomisma_Code
56328>>>>>                    //    Find eq Nomisma by Index.1
56328>>>>>                    //    Set Points          Of (X00(iContID)) Item  0 to Nomisma.Dekadika
56328>>>>>                    //    Set Numeric_Mask Of (X00(iContID))         Item  0  to 12 Nomisma.Dekadika "*,"
56328>>>>>                    //    Set Points          Of (P00(iContID)) Item  0 to Nomisma.Dekadika
56328>>>>>                    //    Set Numeric_Mask Of (P00(iContID))         Item  0  to 12 Nomisma.Dekadika "*,"
56328>>>>>                    
56328>>>>>                    //    Get Label Of (TxtNom3(iContID)) Item 0 to sCode
56328>>>>>                    //    Move (Trim(sCode))  to sCode
56328>>>>>                    //    Clear Nomisma
56328>>>>>                    //    Move sCode to Nomisma.Nomisma_Code
56328>>>>>                    //    Find eq Nomisma by Index.1
56328>>>>>                    //    Set Points          Of (X1(iContID)) Item  0 to     Nomisma.Dekadika
56328>>>>>                    //    Set Numeric_Mask Of (X1(iContID))    Item  0 to 12  Nomisma.Dekadika "*,"
56328>>>>>                    //    Set Points          Of (P1(iContID)) Item  0 to     Nomisma.Dekadika
56328>>>>>                    //    Set Numeric_Mask Of (P1(iContID))    Item  0 to 12  Nomisma.Dekadika "*,"
56328>>>>>                    //End_procedure
56328>>>>>                    
56328>>>>>                    
56328>>>>>                    //AB-StoreTopEnd
56328>>>>>
56328>>>>>                    Entry_Item Baxio.Baxio_c_code2
56329>>>>>                    Set Size to 13 66
56330>>>>>                    Set Location to 25 82
56331>>>>>                    Set Label_Col_Offset to 2
56332>>>>>                    Set Label_Justification_Mode to jMode_Right
56333>>>>>                    Set Prompt_Button_Mode to pb_PromptOff
56334>>>>>
56334>>>>>                    //AB-StoreStart
56334>>>>>                                                                                                                                                                                                                                                    
56334>>>>>                    //Procedure OnChange
56334>>>>>                    //    Send Set_The_Decimal_Points
56334>>>>>                    //End_Procedure
56334>>>>>                    
56334>>>>>                    
56334>>>>>                    //AB-StoreEnd
56334>>>>>
56334>>>>>                End_Object    // Baxio_Baxio_C_Code2
56335>>>>>
56335>>>>>            End_Object    // dbGrpObligate
56336>>>>>
56336>>>>>            Object dbGrpOptional is a dbGroupSub
56338>>>>>                Set Label to "¨¦˜ ¨œ« ¡á ‘«¦ ®œå˜"
56339>>>>>                Set Size to 106 492
56340>>>>>                Set Location to 65 4
56341>>>>>                Set TextColor to clNavy
56342>>>>>                Object Baxio_Baxio_Ekdoths is a dbFormSub
56344>>>>>                    Entry_Item Baxio.Baxio_ekdoths
56345>>>>>                    Set Size to 13 126
56346>>>>>                    Set Location to 10 81
56347>>>>>                    Set Label_Col_Offset to 70
56348>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
56349>>>>>                End_Object    // Baxio_Baxio_Ekdoths
56350>>>>>
56350>>>>>                Object Baxio_Baxio_Ekdothse is a dbFormSub
56352>>>>>                    Entry_Item Baxio.Baxio_ekdothse
56353>>>>>                    Set Size to 13 208
56354>>>>>                    Set Location to 10 264
56355>>>>>                    Set Label_Col_Offset to 35
56356>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
56357>>>>>                End_Object    // Baxio_Baxio_Ekdothse
56358>>>>>
56358>>>>>                Object Baxio_Baxio_Sediatagh is a dbFormSub
56360>>>>>                    Entry_Item Baxio.Baxio_sediatagh
56361>>>>>                    Set Size to 13 126
56362>>>>>                    Set Location to 26 81
56363>>>>>                    Set Label_Col_Offset to 70
56364>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
56365>>>>>                End_Object    // Baxio_Baxio_Sediatagh
56366>>>>>
56366>>>>>                Object Baxio_Baxio_Sdiataghe is a dbFormSub
56368>>>>>                    Entry_Item Baxio.Baxio_sdiataghe
56369>>>>>                    Set Size to 13 208
56370>>>>>                    Set Location to 26 264
56371>>>>>                    Set Label_Col_Offset to 35
56372>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
56373>>>>>                End_Object    // Baxio_Baxio_Sdiataghe
56374>>>>>
56374>>>>>                Object Baxio_Baxio_Banka is a dbComboFormSub
56376>>>>>                    Entry_Item Baxio.Baxio_banka
56377>>>>>                    Set Size to 13 126
56378>>>>>                    Set Location to 40 81
56379>>>>>                    Set Label_Col_Offset to 70
56380>>>>>                End_Object    // Baxio_Baxio_Banka
56381>>>>>
56381>>>>>                Object Baxio_Baxio_No is a dbFormSub
56383>>>>>                    Entry_Item Baxio.Baxio_no
56384>>>>>                    Set Size to 13 126
56385>>>>>                    Set Location to 55 81
56386>>>>>                    Set Label_Col_Offset to 70
56387>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
56388>>>>>                End_Object    // Baxio_Baxio_No
56389>>>>>
56389>>>>>                Object Baxio_Baxio_From is a dbComboFormSub
56391>>>>>                    Entry_Item Baxio.Baxio_from
56392>>>>>                    Set Size to 13 54
56393>>>>>                    Set Location to 70 81
56394>>>>>                    Set Label_Col_Offset to 2
56395>>>>>
56395>>>>>                    //AB-StoreStart
56395>>>>>                                                            
56395>>>>>                    Procedure Combo_Fill_List
56397>>>>>                        Send Combo_Add_Item  "ˆ›å¦¬" "0"
56398>>>>>                        Send Combo_Add_Item  "’¨å«¦¬" "1"
56399>>>>>                    End_Procedure
56400>>>>>                    
56400>>>>>                    
56400>>>>>                    
56400>>>>>                    
56400>>>>>                    
56400>>>>>                    
56400>>>>>                    //AB-StoreEnd
56400>>>>>
56400>>>>>                End_Object    // Baxio_Baxio_From
56401>>>>>
56401>>>>>                Object Baxio_Baxio_Topos is a dbComboFormSub
56403>>>>>                    Entry_Item Baxio.Baxio_topos
56404>>>>>                    Set Size to 13 54
56405>>>>>                    Set Location to 84 81
56406>>>>>                    Set Label_Col_Offset to 2
56407>>>>>
56407>>>>>                    //AB-StoreStart
56407>>>>>                    Procedure Combo_Fill_List
56409>>>>>                        Send Combo_Add_Item  "€«« ¡ãª" "0"
56410>>>>>                        Send Combo_Add_Item  "„§˜¨®å˜ª" "1"
56411>>>>>                    End_Procedure
56412>>>>>                    
56412>>>>>                    
56412>>>>>                    
56412>>>>>                    
56412>>>>>                    
56412>>>>>                    
56412>>>>>                    //AB-StoreEnd
56412>>>>>
56412>>>>>                End_Object    // Baxio_Baxio_Topos
56413>>>>>
56413>>>>>                Object Baxio_Baxio_Opistho is a dbEditSub
56415>>>>>                    Entry_Item Baxio.Baxio_opistho
56416>>>>>                    Set Size to 48 211
56417>>>>>                    Set Location to 50 263
56418>>>>>                End_Object    // Baxio_Baxio_Opistho
56419>>>>>
56419>>>>>                Object TextBoxSub6 is a TextBoxSub
56421>>>>>                    Set Label to "€¨® ¡æª „¡›æ«žª:"
56422>>>>>                    Set Location to 11 10
56423>>>>>                    Set Size to 10 63
56424>>>>>                End_Object    // TextBoxSub6
56425>>>>>
56425>>>>>                Object TextBoxSub7 is a TextBoxSub
56427>>>>>                    Set Label to "‘œ ƒ ˜«˜šã:"
56428>>>>>                    Set Location to 25 10
56429>>>>>                    Set Size to 10 56
56430>>>>>                End_Object    // TextBoxSub7
56431>>>>>
56431>>>>>                Object TextBoxSub8 is a TextBoxSub
56433>>>>>                    Set Label to "’¨á§œ˜"
56434>>>>>                    Set Location to 40 10
56435>>>>>                    Set Size to 10 35
56436>>>>>                End_Object    // TextBoxSub8
56437>>>>>
56437>>>>>                Object TextBoxSub9 is a TextBoxSub
56439>>>>>                    Set Label to "€¨ Ÿ£æª"
56440>>>>>                    Set Location to 55 10
56441>>>>>                    Set Size to 10 47
56442>>>>>                End_Object    // TextBoxSub9
56443>>>>>
56443>>>>>                Object TextBoxSub10 is a TextBoxSub
56445>>>>>                    Set Label to "„§à¤¬£å˜"
56446>>>>>                    Set Location to 12 224
56447>>>>>                    Set Size to 10 36
56448>>>>>                End_Object    // TextBoxSub10
56449>>>>>
56449>>>>>                Object TextBoxSub11 is a TextBoxSub
56451>>>>>                    Set Label to "„§à¤¬£å˜"
56452>>>>>                    Set Location to 28 224
56453>>>>>                    Set Size to 10 36
56454>>>>>                End_Object    // TextBoxSub11
56455>>>>>
56455>>>>>                Object TextBoxSub12 is a TextBoxSub
56457>>>>>                    Set Label to "Š¦ §¦å Ž§ ©Ÿ¦š¨á­¦ "
56458>>>>>                    Set Location to 41 265
56459>>>>>                    Set Size to 10 79
56460>>>>>                End_Object    // TextBoxSub12
56461>>>>>
56461>>>>>                Object Textbox3 is a Textbox
56463>>>>>                    Set Label to "ˆ›å¦¬/’¨å«¦¬"
56464>>>>>                    Set Location to 71 10
56465>>>>>                    Set Size to 10 46
56466>>>>>                End_Object    // Textbox3
56467>>>>>
56467>>>>>                Object Textbox4 is a Textbox
56469>>>>>                    Set Label to "€«« ¡ãª/„§˜¨®å˜ª"
56470>>>>>                    Set Location to 86 10
56471>>>>>                    Set Size to 10 63
56472>>>>>                End_Object    // Textbox4
56473>>>>>
56473>>>>>            End_Object    // dbGrpOptional
56474>>>>>
56474>>>>>
56474>>>>>            //AB-StoreStart
56474>>>>>            set label to "‘«â¢œ®¦ª/‘é£˜ €¥ ¦š¨á­¦¬"
56475>>>>>            
56475>>>>>            //AB-StoreEnd
56475>>>>>
56475>>>>>        End_Object    // TP_Additional
56476>>>>>
56476>>>>>        Object TP_Status is a dbTabPage
56478>>>>>            Set Label to "‰˜«á©«˜©ž"
56479>>>>>            Object dbGrpEispraktea is a dbGroupSub
56481>>>>>                Set Label to "„ ©§¨˜¡«â˜"
56482>>>>>                Set Size to 44 493
56483>>>>>                Set Location to 4 3
56484>>>>>                Set TextColor to clNavy
56485>>>>>                Object Baxio_Baxio_Fbarticl is a dbFormSub
56487>>>>>
56487>>>>>                    //AB-StoreTopStart
56487>>>>>                    Procedure Find_Barticls
56489>>>>>                        Integer liBarticlRec0 liWhichBarticl
56490>>>>>                        Date ldHmnia
56490>>>>>                        String liNo liBtypkin
56490>>>>>                    
56490>>>>>                        Move Barticl.Barticl_Rec0 to liBarticlRec0
56491>>>>>                    
56491>>>>>                        Get Field_Current_Value of Baxio_DD Field Baxio.Baxio_Fpar_In to liWhichBarticl
56492>>>>>                        If (liWhichBarticl <> 0) Begin
56494>>>>>                            Clear Barticl
56495>>>>>                            Move liWhichBarticl to Barticl.Barticl_Rec0
56496>>>>>                            Find eq Barticl by Index.2
56497>>>>>>
56497>>>>>                            [Found] Begin
56499>>>>>>
56499>>>>>                                Move Barticl.Barticl_Hmnia   to ldHmnia
56500>>>>>                                Move Barticl.Barticl_No      to liNo
56501>>>>>                                Move Barticl.Btypkin_Code    to liBtypkin
56502>>>>>                            End
56502>>>>>>
56502>>>>>                        End
56502>>>>>>
56502>>>>>                        Set Value of dbfrmHmnia   Item 0 to ldHmnia
56503>>>>>                        Set Value of dbfrmNo      Item 0 to liNo
56504>>>>>                        Set Value of dbfrmGtypkin Item 0 to liBtypkin
56505>>>>>                    
56505>>>>>                        Move "" to ldHmnia
56506>>>>>                        Move "" to liNo
56507>>>>>                        Move "" to liBtypkin
56508>>>>>                    
56508>>>>>                        Get Field_Current_Value of Baxio_DD Field Baxio.Baxio_Fpar_Out to liWhichBarticl
56509>>>>>                        If (liWhichBarticl <> 0) Begin
56511>>>>>                            Clear Barticl
56512>>>>>                            Move liWhichBarticl to Barticl.Barticl_Rec0
56513>>>>>                            Find eq Barticl by Index.2
56514>>>>>>
56514>>>>>                            [Found] Begin
56516>>>>>>
56516>>>>>                                Move Barticl.Barticl_Hmnia   to ldHmnia
56517>>>>>                                Move Barticl.Barticl_No      to liNo
56518>>>>>                                Move Barticl.Btypkin_Code    to liBtypkin
56519>>>>>                            End
56519>>>>>>
56519>>>>>                        End
56519>>>>>>
56519>>>>>                        Set Value of (dbfrmHmnia(dbGrpPlhrotea(Self)))   Item 0 to ldHmnia
56520>>>>>                        Set Value of (dbfrmNo(dbGrpPlhrotea(Self)))      Item 0 to liNo
56521>>>>>                        Set Value of (dbfrmGtypkin(dbGrpPlhrotea(Self))) Item 0 to liBtypkin
56522>>>>>                    
56522>>>>>                        Move "" to ldHmnia
56523>>>>>                        Move "" to liNo
56524>>>>>                        Move "" to liBtypkin
56525>>>>>                    
56525>>>>>                        Get Field_Current_Value of Baxio_DD Field Baxio.Baxio_Lpar to liWhichBarticl
56526>>>>>                        If (liWhichBarticl <> 0) Begin
56528>>>>>                            Clear Barticl
56529>>>>>                            Move liWhichBarticl to Barticl.Barticl_Rec0
56530>>>>>                            Find eq Barticl by Index.2
56531>>>>>>
56531>>>>>                            [Found] Begin
56533>>>>>>
56533>>>>>                                Move Barticl.Barticl_Hmnia   to ldHmnia
56534>>>>>                                Move Barticl.Barticl_No      to liNo
56535>>>>>                                Move Barticl.Btypkin_Code    to liBtypkin
56536>>>>>                            End
56536>>>>>>
56536>>>>>                        End
56536>>>>>>
56536>>>>>                        Set Value of (dbfrmHmnia(dbGrpCurrentStat(Self)))   Item 0 to ldHmnia
56537>>>>>                        Set Value of (dbfrmNo(dbGrpCurrentStat(Self)))      Item 0 to liNo
56538>>>>>                        Set Value of (dbfrmGtypkin(dbGrpCurrentStat(Self))) Item 0 to liBtypkin
56539>>>>>                    
56539>>>>>                        Clear Barticl
56540>>>>>                        Move liBarticlRec0 to Barticl.Barticl_Rec0
56541>>>>>                        Find eq Barticl by Index.2
56542>>>>>>
56542>>>>>                    End_Procedure
56543>>>>>                    
56543>>>>>                    //AB-StoreTopEnd
56543>>>>>
56543>>>>>                    Entry_Item Baxio.Baxio_fpar_in
56544>>>>>                    Set Size to 13 90
56545>>>>>                    Set Location to 10 109
56546>>>>>                    Set Label_Col_Offset to 90
56547>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
56548>>>>>
56548>>>>>                    //AB-StoreStart
56548>>>>>                                                                                                                                                                                                                                                    
56548>>>>>                    Procedure Refresh Integer iMode
56550>>>>>                        Forward Send Refresh iMode
56552>>>>>                        Send Find_Barticls
56553>>>>>                    End_Procedure // Refresh
56554>>>>>                    
56554>>>>>                    
56554>>>>>                    
56554>>>>>                    
56554>>>>>                    
56554>>>>>                    //AB-StoreEnd
56554>>>>>
56554>>>>>                End_Object    // Baxio_Baxio_Fbarticl
56555>>>>>
56555>>>>>                Object Baxio_Baxio_Code_In is a dbFormSub
56557>>>>>                    Entry_Item Baxio.Baxio_code_in
56558>>>>>                    Set Size to 13 126
56559>>>>>                    Set Location to 24 109
56560>>>>>                    Set Label_Col_Offset to 90
56561>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
56562>>>>>                End_Object    // Baxio_Baxio_Code_In
56563>>>>>
56563>>>>>                Object Baxio_Baxio_Epon_In is a dbFormSub
56565>>>>>                    Entry_Item Baxio.Baxio_epon_in
56566>>>>>                    Set Size to 13 192
56567>>>>>                    Set Location to 24 283
56568>>>>>                    Set Color to clBtnFace
56569>>>>>                    Set Label_Col_Offset to 40
56570>>>>>                    Set Enabled_State to FALSE
56571>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
56572>>>>>                    Set Item_Shadow_State Item 0 to TRUE
56573>>>>>                    Set Shadow_State Item 0 to TRUE
56574>>>>>                End_Object    // Baxio_Baxio_Epon_In
56575>>>>>
56575>>>>>                Object dbFrmHmnia is a dbFormSub
56577>>>>>                    Set Size to 13 65
56578>>>>>                    Set Location to 10 231
56579>>>>>                    Set Color to clBtnFace
56580>>>>>                    Set Label_Col_Offset to 2
56581>>>>>                    Set Label_Justification_Mode to jMode_Right
56582>>>>>                    Set Enabled_State to FALSE
56583>>>>>                    Set Item_Shadow_State Item 0 to TRUE
56584>>>>>                    Set Shadow_State Item 0 to TRUE
56585>>>>>                End_Object    // dbFrmHmnia
56586>>>>>
56586>>>>>                Object dbFrmNo is a dbFormSub
56588>>>>>                    Set Size to 13 65
56589>>>>>                    Set Location to 10 318
56590>>>>>                    Set Color to clBtnFace
56591>>>>>                    Set Label_Col_Offset to 2
56592>>>>>                    Set Label_Justification_Mode to jMode_Right
56593>>>>>                    Set Enabled_State to FALSE
56594>>>>>                    Set Item_Shadow_State Item 0 to TRUE
56595>>>>>                    Set Shadow_State Item 0 to TRUE
56596>>>>>                End_Object    // dbFrmNo
56597>>>>>
56597>>>>>                Object dbFrmGtypkin is a dbFormSub
56599>>>>>                    Set Label to "‰å¤ž©ž"
56600>>>>>                    Set Size to 13 57
56601>>>>>                    Set Location to 10 418
56602>>>>>                    Set Color to clBtnFace
56603>>>>>                    Set Label_Col_Offset to 2
56604>>>>>                    Set Label_Justification_Mode to jMode_Right
56605>>>>>                    Set Enabled_State to FALSE
56606>>>>>                    Set Item_Shadow_State Item 0 to TRUE
56607>>>>>                    Set Shadow_State Item 0 to TRUE
56608>>>>>                End_Object    // dbFrmGtypkin
56609>>>>>
56609>>>>>                Object TextBoxSub18 is a TextBoxSub
56611>>>>>                    Set Label to "˜¨/¡æ ˜¨˜¢˜™ãª:"
56612>>>>>                    Set Location to 12 18
56613>>>>>                    Set Size to 10 69
56614>>>>>                End_Object    // TextBoxSub18
56615>>>>>
56615>>>>>                Object TextBoxSub19 is a TextBoxSub
56617>>>>>                    Set Label to "˜¨˜¢ã­Ÿž¡œ ˜§æ:"
56618>>>>>                    Set Location to 25 18
56619>>>>>                    Set Size to 10 67
56620>>>>>                End_Object    // TextBoxSub19
56621>>>>>
56621>>>>>                Object TextBoxSub24 is a TextBoxSub
56623>>>>>                    Set Label to "†£-¤å˜"
56624>>>>>                    Set Location to 12 201
56625>>>>>                    Set Size to 10 26
56626>>>>>                End_Object    // TextBoxSub24
56627>>>>>
56627>>>>>                Object TextBoxSub27 is a TextBoxSub
56629>>>>>                    Set Label to "„§à¤¬£å˜"
56630>>>>>                    Set Location to 26 239
56631>>>>>                    Set Size to 10 39
56632>>>>>                End_Object    // TextBoxSub27
56633>>>>>
56633>>>>>                Object TextBoxSub30 is a TextBoxSub
56635>>>>>                    Set Label to "Œ¦:"
56636>>>>>                    Set Location to 11 298
56637>>>>>                    Set Size to 10 15
56638>>>>>                End_Object    // TextBoxSub30
56639>>>>>
56639>>>>>            End_Object    // dbGrpEispraktea
56640>>>>>
56640>>>>>            Object dbGrpPlhrotea is a dbGroupSub
56642>>>>>                Set Label to "„ ©§¨˜¡«â˜/¢ž¨à«â˜"
56643>>>>>                Set Size to 44 493
56644>>>>>                Set Location to 51 3
56645>>>>>                Set TextColor to clNavy
56646>>>>>                Object Baxio_Baxio_Lbarticl is a dbFormSub
56648>>>>>                    Entry_Item Baxio.Baxio_fpar_out
56649>>>>>                    Set Size to 13 90
56650>>>>>                    Set Location to 10 109
56651>>>>>                    Set Label_Col_Offset to 90
56652>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
56653>>>>>                End_Object    // Baxio_Baxio_Lbarticl
56654>>>>>
56654>>>>>                Object Baxio_Baxio_Code_Out is a dbFormSub
56656>>>>>                    Entry_Item Baxio.Baxio_code_out
56657>>>>>                    Set Size to 13 126
56658>>>>>                    Set Location to 25 109
56659>>>>>                    Set Label_Col_Offset to 90
56660>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
56661>>>>>                End_Object    // Baxio_Baxio_Code_Out
56662>>>>>
56662>>>>>                Object Baxio_Baxio_Epon_Out is a dbFormSub
56664>>>>>                    Entry_Item Baxio.Baxio_epon_out
56665>>>>>                    Set Size to 13 192
56666>>>>>                    Set Location to 25 283
56667>>>>>                    Set Color to clBtnFace
56668>>>>>                    Set Label_Col_Offset to 40
56669>>>>>                    Set Enabled_State to FALSE
56670>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
56671>>>>>                    Set Item_Shadow_State Item 0 to TRUE
56672>>>>>                    Set Shadow_State Item 0 to TRUE
56673>>>>>                End_Object    // Baxio_Baxio_Epon_Out
56674>>>>>
56674>>>>>                Object dbFrmHmnia is a dbFormSub
56676>>>>>                    Set Size to 13 65
56677>>>>>                    Set Location to 10 231
56678>>>>>                    Set Color to clBtnFace
56679>>>>>                    Set Label_Col_Offset to 2
56680>>>>>                    Set Label_Justification_Mode to jMode_Right
56681>>>>>                    Set Enabled_State to FALSE
56682>>>>>                    Set Item_Shadow_State Item 0 to TRUE
56683>>>>>                    Set Shadow_State Item 0 to TRUE
56684>>>>>                End_Object    // dbFrmHmnia
56685>>>>>
56685>>>>>                Object dbFrmNo is a dbFormSub
56687>>>>>                    Set Size to 13 65
56688>>>>>                    Set Location to 10 318
56689>>>>>                    Set Color to clBtnFace
56690>>>>>                    Set Label_Col_Offset to 2
56691>>>>>                    Set Label_Justification_Mode to jMode_Right
56692>>>>>                    Set Enabled_State to FALSE
56693>>>>>                    Set Item_Shadow_State Item 0 to TRUE
56694>>>>>                    Set Shadow_State Item 0 to TRUE
56695>>>>>                End_Object    // dbFrmNo
56696>>>>>
56696>>>>>                Object dbFrmGtypkin is a dbFormSub
56698>>>>>                    Set Label to "‰å¤ž©ž"
56699>>>>>                    Set Size to 13 57
56700>>>>>                    Set Location to 10 418
56701>>>>>                    Set Color to clBtnFace
56702>>>>>                    Set Label_Col_Offset to 2
56703>>>>>                    Set Label_Justification_Mode to jMode_Right
56704>>>>>                    Set Enabled_State to FALSE
56705>>>>>                    Set Item_Shadow_State Item 0 to TRUE
56706>>>>>                    Set Shadow_State Item 0 to TRUE
56707>>>>>                End_Object    // dbFrmGtypkin
56708>>>>>
56708>>>>>                Object TextBoxSub20 is a TextBoxSub
56710>>>>>                    Set Label to "˜¨/¡æ ˜¨á›¦©žª:"
56711>>>>>                    Set Location to 10 19
56712>>>>>                    Set Size to 10 71
56713>>>>>                End_Object    // TextBoxSub20
56714>>>>>
56714>>>>>                Object TextBoxSub21 is a TextBoxSub
56716>>>>>                    Set Label to "¨é«¦ª ˜¨˜¢ã§«žª:"
56717>>>>>                    Set Location to 24 19
56718>>>>>                    Set Size to 10 78
56719>>>>>                End_Object    // TextBoxSub21
56720>>>>>
56720>>>>>                Object TextBoxSub25 is a TextBoxSub
56722>>>>>                    Set Label to "†£-¤å˜"
56723>>>>>                    Set Location to 10 201
56724>>>>>                    Set Size to 10 26
56725>>>>>                End_Object    // TextBoxSub25
56726>>>>>
56726>>>>>                Object TextBoxSub28 is a TextBoxSub
56728>>>>>                    Set Label to "„§à¤¬£å˜"
56729>>>>>                    Set Location to 27 237
56730>>>>>                    Set Size to 10 41
56731>>>>>                End_Object    // TextBoxSub28
56732>>>>>
56732>>>>>                Object TextBoxSub31 is a TextBoxSub
56734>>>>>                    Set Label to "Œ¦:"
56735>>>>>                    Set Location to 12 298
56736>>>>>                    Set Size to 9 15
56737>>>>>                End_Object    // TextBoxSub31
56738>>>>>
56738>>>>>            End_Object    // dbGrpPlhrotea
56739>>>>>
56739>>>>>            Object dbGrpCurrentStat is a dbGroupSub
56741>>>>>                Set Label to "’¨â®¦¬©˜ ‰˜«á©«˜©ž"
56742>>>>>                Set Size to 44 493
56743>>>>>                Set Location to 98 3
56744>>>>>                Set TextColor to clNavy
56745>>>>>                Object Baxio_Baxio_Lcode is a dbFormSub
56747>>>>>                    Entry_Item Baxio.Baxio_lcode
56748>>>>>                    Set Size to 13 126
56749>>>>>                    Set Location to 24 109
56750>>>>>                    Set Label_Col_Offset to 90
56751>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
56752>>>>>                End_Object    // Baxio_Baxio_Lcode
56753>>>>>
56753>>>>>                Object Baxio_Baxio_Lepon is a dbFormSub
56755>>>>>                    Entry_Item Baxio.Baxio_lepon
56756>>>>>                    Set Size to 13 192
56757>>>>>                    Set Location to 24 283
56758>>>>>                    Set Color to clBtnFace
56759>>>>>                    Set Label_Col_Offset to 40
56760>>>>>                    Set Enabled_State to FALSE
56761>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
56762>>>>>                    Set Item_Shadow_State Item 0 to TRUE
56763>>>>>                    Set Shadow_State Item 0 to TRUE
56764>>>>>                End_Object    // Baxio_Baxio_Lepon
56765>>>>>
56765>>>>>                Object Baxio_Baxio_Lpar is a dbFormSub
56767>>>>>                    Entry_Item Baxio.Baxio_lpar
56768>>>>>                    Set Size to 13 90
56769>>>>>                    Set Location to 9 109
56770>>>>>                    Set Label_Col_Offset to 90
56771>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
56772>>>>>                End_Object    // Baxio_Baxio_Lpar
56773>>>>>
56773>>>>>                Object dbFrmHmnia is a dbFormSub
56775>>>>>                    Set Size to 13 65
56776>>>>>                    Set Location to 10 231
56777>>>>>                    Set Color to clBtnFace
56778>>>>>                    Set Label_Col_Offset to 2
56779>>>>>                    Set Label_Justification_Mode to jMode_Right
56780>>>>>                    Set Enabled_State to FALSE
56781>>>>>                    Set Item_Shadow_State Item 0 to TRUE
56782>>>>>                    Set Shadow_State Item 0 to TRUE
56783>>>>>                End_Object    // dbFrmHmnia
56784>>>>>
56784>>>>>                Object dbFrmNo is a dbFormSub
56786>>>>>                    Set Size to 13 65
56787>>>>>                    Set Location to 10 318
56788>>>>>                    Set Color to clBtnFace
56789>>>>>                    Set Label_Col_Offset to 2
56790>>>>>                    Set Label_Justification_Mode to jMode_Right
56791>>>>>                    Set Enabled_State to FALSE
56792>>>>>                    Set Item_Shadow_State Item 0 to TRUE
56793>>>>>                    Set Shadow_State Item 0 to TRUE
56794>>>>>                End_Object    // dbFrmNo
56795>>>>>
56795>>>>>                Object dbFrmGtypkin is a dbFormSub
56797>>>>>                    Set Label to "‰å¤ž©ž"
56798>>>>>                    Set Size to 13 57
56799>>>>>                    Set Location to 10 418
56800>>>>>                    Set Color to clBtnFace
56801>>>>>                    Set Label_Col_Offset to 2
56802>>>>>                    Set Label_Justification_Mode to jMode_Right
56803>>>>>                    Set Enabled_State to FALSE
56804>>>>>                    Set Item_Shadow_State Item 0 to TRUE
56805>>>>>                    Set Shadow_State Item 0 to TRUE
56806>>>>>                End_Object    // dbFrmGtypkin
56807>>>>>
56807>>>>>                Object TextBoxSub22 is a TextBoxSub
56809>>>>>                    Set Label to "’œ¢œ¬«˜å¦ ˜¨/¡æ:"
56810>>>>>                    Set Location to 11 13
56811>>>>>                    Set Size to 10 68
56812>>>>>                End_Object    // TextBoxSub22
56813>>>>>
56813>>>>>                Object TextBoxSub23 is a TextBoxSub
56815>>>>>                    Set Label to "’œ¢œ¬«˜å¦ª ˜¨˜¢ã§«žª:"
56816>>>>>                    Set Location to 24 13
56817>>>>>                    Set Size to 10 90
56818>>>>>                End_Object    // TextBoxSub23
56819>>>>>
56819>>>>>                Object TextBoxSub26 is a TextBoxSub
56821>>>>>                    Set Label to "†£-¤å˜"
56822>>>>>                    Set Location to 11 200
56823>>>>>                    Set Size to 10 27
56824>>>>>                End_Object    // TextBoxSub26
56825>>>>>
56825>>>>>                Object TextBoxSub29 is a TextBoxSub
56827>>>>>                    Set Label to "„§à¤¬£å˜"
56828>>>>>                    Set Location to 26 239
56829>>>>>                    Set Size to 10 40
56830>>>>>                End_Object    // TextBoxSub29
56831>>>>>
56831>>>>>                Object TextBoxSub32 is a TextBoxSub
56833>>>>>                    Set Label to "Œ¦:"
56834>>>>>                    Set Location to 11 297
56835>>>>>                    Set Size to 10 15
56836>>>>>                End_Object    // TextBoxSub32
56837>>>>>
56837>>>>>            End_Object    // dbGrpCurrentStat
56838>>>>>
56838>>>>>
56838>>>>>            //AB-StoreStart
56838>>>>>            set label to "Š¦ §á ‘«¦ ®œå˜"
56839>>>>>            
56839>>>>>            //AB-StoreEnd
56839>>>>>
56839>>>>>        End_Object    // TP_Status
56840>>>>>
56840>>>>>        Object TP_Bmove is a dbTabPage
56842>>>>>            Set Label to "‰å¤ž©ž"
56843>>>>>            Object grdBmove is a dbGridSub
56845>>>>>                Set Main_File to Bmove.File_Number
56846>>>>>                Set Server to (Bmove_DD(self))
56847>>>>>                Set Ordering to 4
56848>>>>>                Set Size to 159 489
56849>>>>>                Set Location to 7 5
56850>>>>>                Set Wrap_State to TRUE
56851>>>>>                Set Read_Only_State to TRUE
56852>>>>>
56852>>>>>                Begin_Row
56855>>>>>                    Entry_Item Btypkin.Btypkin_code
56856>>>>>                    Entry_Item Btypkin.Btypkin_descr
56857>>>>>                    Entry_Item Barticl.Barticl_hmnia
56858>>>>>                    Entry_Item Barticl.Barticl_no
56859>>>>>                    Entry_Item Barticl.Barticl_code1
56860>>>>>                    Entry_Item Barticl.Barticl_code2
56861>>>>>                End_Row
56866>>>>>
56866>>>>>                Set Form_Width    item 0 to 38
56867>>>>>                Set Header_Label  item 0 to "‰å¤ž©ž"
56868>>>>>                
56868>>>>>                Set Form_Width    item 1 to 197
56869>>>>>                Set Header_Label  item 1 to "œ¨ š¨˜­ã"
56870>>>>>                
56870>>>>>                Set Form_Width    item 2 to 45
56871>>>>>                Set Header_Label  item 2 to "†£-¤å˜"
56872>>>>>                
56872>>>>>                Set Form_Width    item 3 to 45
56873>>>>>                Set Header_Label  item 3 to "€¨ Ÿ£æª"
56874>>>>>                
56874>>>>>                Set Form_Width    item 4 to 82
56875>>>>>                Set Header_Label  item 4 to "‘¬¤˜¢¢˜©©æ£œ¤¦ª"
56876>>>>>                
56876>>>>>                Set Form_Width    item 5 to 76
56877>>>>>                Set Header_Label  item 5 to "˜¨˜¢ã§«žª"
56878>>>>>                
56878>>>>>
56878>>>>>                //AB-StoreStart
56878>>>>>                                                                                                                                                                                                        
56878>>>>>                Procedure Set Col_Entry_State Integer iItem Integer iState
56880>>>>>                    Integer liPrototype
56881>>>>>                    Get Prototype_Object to liPrototype
56882>>>>>                    Set Entry_State of liPrototype Item iItem to iState
56883>>>>>                End_Procedure // Col_Entry_State
56884>>>>>                
56884>>>>>                Set Col_Entry_State to 0 False
56885>>>>>                Set Col_Entry_State to 1 False
56886>>>>>                Set Col_Entry_State to 2 False
56887>>>>>                Set Col_Entry_State to 3 False
56888>>>>>                Set Col_Entry_State to 4 False
56889>>>>>                Set Col_Entry_State to 5 False
56890>>>>>                
56890>>>>>                Procedure Mouse_Up Integer aiWindow Integer iChar_Pos
56892>>>>>                End_Procedure // Mouse_Up
56893>>>>>                
56893>>>>>                Procedure Request_Clear_All
56895>>>>>                End_Procedure // Request_Clear_All
56896>>>>>                
56896>>>>>                
56896>>>>>                
56896>>>>>                
56896>>>>>                
56896>>>>>                
56896>>>>>                //AB-StoreEnd
56896>>>>>
56896>>>>>            End_Object    // grdBmove
56897>>>>>
56897>>>>>
56897>>>>>            //AB-StoreStart
56897>>>>>            set label to "‰ ¤ã©œ ª    "
56898>>>>>            //AB-StoreEnd
56898>>>>>
56898>>>>>        End_Object    // TP_Bmove
56899>>>>>
56899>>>>>    End_Object    // dbTbDlgAxio
56900>>>>>
56900>>>>>    Object dbGrpYear is a dbGroupSub
56902>>>>>        Set Size to 26 505
56903>>>>>        Set Location to 2 3
56904>>>>>        Object Company_Company_Name is a dbFormSub
56906>>>>>            Entry_Item Syscurxr.Company_name
56907>>>>>            Set Server to (Syscurxr_DD(self))
56908>>>>>            Set Size to 13 139
56909>>>>>            Set Location to 9 47
56910>>>>>            Set Color to clBtnFace
56911>>>>>            Set Label_Col_Offset to 2
56912>>>>>            Set Label_Justification_Mode to jMode_Right
56913>>>>>            Set Enabled_State to FALSE
56914>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
56915>>>>>            Set Item_Shadow_State Item 0 to TRUE
56916>>>>>            Set Shadow_State Item 0 to TRUE
56917>>>>>        End_Object    // Company_Company_Name
56918>>>>>
56918>>>>>        Object Branch_Branch_Name is a dbFormSub
56920>>>>>            Entry_Item Syscurxr.Branch_name
56921>>>>>            Set Server to (Syscurxr_DD(self))
56922>>>>>            Set Size to 13 141
56923>>>>>            Set Location to 9 241
56924>>>>>            Set Color to clBtnFace
56925>>>>>            Set Label_Col_Offset to 2
56926>>>>>            Set Label_Justification_Mode to jMode_Right
56927>>>>>            Set Enabled_State to FALSE
56928>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
56929>>>>>            Set Item_Shadow_State Item 0 to TRUE
56930>>>>>            Set Shadow_State Item 0 to TRUE
56931>>>>>        End_Object    // Branch_Branch_Name
56932>>>>>
56932>>>>>        Object Year_Year_Year is a dbFormSub
56934>>>>>            Entry_Item Syscurxr.Year_year
56935>>>>>            Set Server to (Syscurxr_DD(self))
56936>>>>>            Set Size to 13 61
56937>>>>>            Set Location to 9 440
56938>>>>>            Set Color to clBtnFace
56939>>>>>            Set Label_Col_Offset to 2
56940>>>>>            Set Label_Justification_Mode to jMode_Right
56941>>>>>            Set Enabled_State to FALSE
56942>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
56943>>>>>            Set Item_Shadow_State Item 0 to TRUE
56944>>>>>            Set Shadow_State Item 0 to TRUE
56945>>>>>
56945>>>>>            //AB-StoreStart
56945>>>>>                                                                                                                                                            
56945>>>>>                                                                                                                                                            
56945>>>>>                                                                                                                                                            
56945>>>>>            //AB-StoreEnd
56945>>>>>
56945>>>>>        End_Object    // Year_Year_Year
56946>>>>>
56946>>>>>        Object otxtCompany is a TextBoxSub
56948>>>>>            Set Label to "„«˜ ¨œå˜"
56949>>>>>            Set Auto_Size_State to FALSE
56950>>>>>            Set TextColor to clNavy
56951>>>>>            Set FontSize to 4 0
56952>>>>>            Set Location to 10 8
56953>>>>>            Set Size to 10 31
56954>>>>>            Set FontWeight to 800
56955>>>>>            Set Justification_Mode to jMode_Right
56956>>>>>            Set TypeFace to "MS Sans Serif"
56957>>>>>            Set Enabled_State to TRUE
56958>>>>>        End_Object    // otxtCompany
56959>>>>>
56959>>>>>        Object otxtBranch is a TextBoxSub
56961>>>>>            Set Label to "“§¦¡/£˜ :"
56962>>>>>            Set Auto_Size_State to FALSE
56963>>>>>            Set TextColor to clNavy
56964>>>>>            Set FontSize to 4 0
56965>>>>>            Set Location to 10 200
56966>>>>>            Set Size to 10 31
56967>>>>>            Set FontWeight to 800
56968>>>>>            Set Justification_Mode to jMode_Right
56969>>>>>            Set TypeFace to "MS Sans Serif"
56970>>>>>            Set Enabled_State to TRUE
56971>>>>>        End_Object    // otxtBranch
56972>>>>>
56972>>>>>        Object otxtYear is a TextBoxSub
56974>>>>>            Set Label to "•¨ã©ž :          "
56975>>>>>            Set Auto_Size_State to FALSE
56976>>>>>            Set TextColor to clNavy
56977>>>>>            Set FontSize to 4 0
56978>>>>>            Set Location to 10 408
56979>>>>>            Set Size to 10 24
56980>>>>>            Set FontWeight to 800
56981>>>>>            Set Justification_Mode to jMode_Right
56982>>>>>            Set TypeFace to "MS Sans Serif"
56983>>>>>            Set Enabled_State to TRUE
56984>>>>>        End_Object    // otxtYear
56985>>>>>
56985>>>>>    End_Object    // dbGrpYear
56986>>>>>
56986>>>>>    Object TextBoxSub1 is a TextBoxSub
56988>>>>>        Set Label to "„å›¦ª"
56989>>>>>        Set Location to 36 5
56990>>>>>        Set Size to 10 35
56991>>>>>    End_Object    // TextBoxSub1
56992>>>>>
56992>>>>>    Object TextBoxSub2 is a TextBoxSub
56994>>>>>        Set Label to "‰à› ¡æª"
56995>>>>>        Set Location to 49 5
56996>>>>>        Set Size to 10 33
56997>>>>>    End_Object    // TextBoxSub2
56998>>>>>
56998>>>>>    Object TextBoxSub13 is a TextBoxSub
57000>>>>>        Set Label to "‰˜«á©«˜©ž"
57001>>>>>        Set Location to 37 285
57002>>>>>        Set Size to 10 51
57003>>>>>    End_Object    // TextBoxSub13
57004>>>>>
57004>>>>>    Object TextBoxSub14 is a TextBoxSub
57006>>>>>        Set Label to "¨å©¡œ«˜ "
57007>>>>>        Set Location to 49 285
57008>>>>>        Set Size to 12 39
57009>>>>>    End_Object    // TextBoxSub14
57010>>>>>
57010>>>>>
57010>>>>>    //AB-StoreStart
57010>>>>>                                                                    
57010>>>>>                                                                    
57010>>>>>    //AB-StoreEnd
57010>>>>>
57010>>>>>End_Object    // VW037
57011>>>>>
57011>>>>>//AB/ End_Object    // prj
57011>>>Use sl100.sl
57011>>>Use sl036.sl
57011>>>use r36.rv
INCLUDING FILE: R36.RV
57011>>>>>//AB/ Project R36:ektyposh barticl
57011>>>>>//AB/     Object prj is a Report_Project
57011>>>>>//AB/         Set ProjectName to "R36:ektyposh barticl"
57011>>>>>//AB/         Set ProjectFileName to "r36.rv"
57011>>>>>
57011>>>>>// Project Object Structure
57011>>>>>//   r36 is a ReportViewSub
57011>>>>>//     DestRadio is a RadioGroup
57011>>>>>//       WindowRadio is a Radio
57011>>>>>//       PrinterRadio is a Radio
57011>>>>>//     ButtonSub3 is a ButtonSub
57011>>>>>//     ButtonSub4 is a ButtonSub
57011>>>>>//     AXIO_BasicReport is a BasicReport
57011>>>>>//       Btypkin_DD is a Btypkin_DataDictionary
57011>>>>>//       Baxiokat_DD is a Baxiokat_DataDictionary
57011>>>>>//       Barticl_DD is a Barticl_DataDictionary
57011>>>>>//       Bsum_DD is a Bsum_DataDictionary
57011>>>>>//       Baxio_DD is a Baxio_DataDictionary
57011>>>>>//       Syscurxr_DD is a Syscurxr_DataDictionary
57011>>>>>//       Clients_DD is a Clients_DataDictionary
57011>>>>>//       Bmove_DD is a Bmove_DataDictionary
57011>>>>>
57011>>>>>// Register all objects
57011>>>>>Register_Object AXIO_BasicReport
57011>>>>>Register_Object Barticl_DD
57011>>>>>Register_Object Baxio_DD
57011>>>>>Register_Object Baxiokat_DD
57011>>>>>Register_Object Bmove_DD
57011>>>>>Register_Object Bsum_DD
57011>>>>>Register_Object Btypkin_DD
57011>>>>>Register_Object ButtonSub3
57011>>>>>Register_Object ButtonSub4
57011>>>>>Register_Object Clients_DD
57011>>>>>Register_Object DestRadio
57011>>>>>Register_Object PrinterRadio
57011>>>>>Register_Object r36
57011>>>>>Register_Object Syscurxr_DD
57011>>>>>Register_Object WindowRadio
57011>>>>>
57011>>>>>
57011>>>>>//AB/     Report View
57011>>>>>
57011>>>>>
57011>>>>>    //AB-StoreTopStart
57011>>>>>                                                        
57011>>>>>    Use dfallrpt.pkg
57011>>>>>    use btypkin.dd
57011>>>>>    use baxiokat.dd
57011>>>>>    Use barticl.dd
57011>>>>>    use bsum.dd
INCLUDING FILE: BSUM.DD
57011>>>>>>>//DDB-FileStart
57011>>>>>>>//DDB-HeaderStart
57011>>>>>>>
57011>>>>>>>// File Name : BSUM.DD
57011>>>>>>>// Class Name: Bsum_DataDictionary
57011>>>>>>>// Revision  : 11
57011>>>>>>>// Version   : 2
57011>>>>>>>
57011>>>>>>>Use  Windows           // Basic Definitions
57011>>>>>>>Use  DataDict          // DataDictionary Class Definition
57011>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
57011>>>>>>>
57011>>>>>>>Open Bsum
57013>>>>>>>Open Barticl
57015>>>>>>>Open Sysrecb
57017>>>>>>>
57017>>>>>>>//DDB-HeaderEnd
57017>>>>>>>Class Bsum_DataDictionary  is a DataDictionary_Sec
57018>>>>>>>
57018>>>>>>>    // Creating:
57018>>>>>>>
57018>>>>>>>    Procedure Creating
57019>>>>>>>        Forward Send Creating
57021>>>>>>>        // Insert Code Here
57021>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Bsum.Bsum_Rec0)))))) to Bsum.Bsum_Recr
57022>>>>>>>    End_Procedure   // Creating
57023>>>>>>>
57023>>>>>>>
57023>>>>>>>    Procedure Define_Fields
57024>>>>>>>        Forward Send Define_Fields
57026>>>>>>>        //DDB-Generated-Code-Location
57026>>>>>>>        //DDB-DefineFieldStart
57026>>>>>>>
57026>>>>>>>        Set Main_File            To Bsum.File_Number
57027>>>>>>>        Set Cascade_Delete_State To FALSE
57028>>>>>>>
57028>>>>>>>
57028>>>>>>>        // Parent (Server) file structure...............
57028>>>>>>>        Send Add_Server_File  Barticl.File_Number
57029>>>>>>>
57029>>>>>>>        // External (System) file structure.............
57029>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
57030>>>>>>>
57030>>>>>>>        Define_Auto_Increment  Sysrecb.Bsum_Rec0  To Bsum.Bsum_Rec0
57033>>>>>>>
57033>>>>>>>        // Field-based properties.......................
57033>>>>>>>
57033>>>>>>>        // Bsum.Barticl_Recr
57033>>>>>>>
57033>>>>>>>        // Bsum.Baxiokat_Recr
57033>>>>>>>
57033>>>>>>>        // Bsum.Bsum_Sv2
57033>>>>>>>
57033>>>>>>>        // Bsum.Bsum_Sv0
57033>>>>>>>
57033>>>>>>>        // Bsum.Bsum_Sv00
57033>>>>>>>
57033>>>>>>>        // Bsum.Bsum_Svr
57033>>>>>>>
57033>>>>>>>        // Bsum.Gmove_Srec0
57033>>>>>>>
57033>>>>>>>        // Bsum.Bsum_Rec0
57033>>>>>>>
57033>>>>>>>        // Bsum.Bsum_Recr
57033>>>>>>>
57033>>>>>>>        //DDB-DefineFieldEnd
57033>>>>>>>
57033>>>>>>>        Set Main_File            To Bsum.File_Number
57034>>>>>>>
57034>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
57035>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
57036>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
57037>>>>>>>
57037>>>>>>>        // Parent (Server) file structure...............
57037>>>>>>>        Send Add_Server_File  Barticl.File_Number
57038>>>>>>>
57038>>>>>>>        // Field-based properties.......................
57038>>>>>>>
57038>>>>>>>        // Bsum.Barticl_Rec0
57038>>>>>>>
57038>>>>>>>        // Bsum.Baxiokat_Rec0
57038>>>>>>>
57038>>>>>>>        // Bsum.Bsum_Sv2
57038>>>>>>>
57038>>>>>>>        // Bsum.Bsum_Sv0
57038>>>>>>>
57038>>>>>>>        // Bsum.Bsum_Sv00
57038>>>>>>>
57038>>>>>>>        // Bsum.Bsum_Svr
57038>>>>>>>
57038>>>>>>>        // Bsum.Gmove_Srec0
57038>>>>>>>
57038>>>>>>>    End_Procedure    // Define_Fields
57039>>>>>>>
57039>>>>>>>
57039>>>>>>>    Procedure Field_Defaults
57040>>>>>>>        Forward Send Field_Defaults
57042>>>>>>>        //DDB-Generated-Code-Location
57042>>>>>>>        //DDB-FieldDefaultStart
57042>>>>>>>        //DDB-FieldDefaultEnd
57042>>>>>>>    End_Procedure    // Field_Defaults
57043>>>>>>>
57043>>>>>>>End_Class    // Bsum_DataDictionary
57044>>>>>>>//DDB-FileEnd
57044>>>>>    use baxio.dd
57044>>>>>    use syscurxr.dd
57044>>>>>    use clients.dd
57044>>>>>    use bmove.dd
57044>>>>>    Use rvi36.pkg
INCLUDING FILE: RVI36.PKG
/HEADERR36
Image 10, HEADERR36
 !
 __________________________________                                                          †‹Œˆ€  : __________
 __________________________________                                                          €.€ : __________
 __________________________________
 __________     ___________________
 €”‹ __________ ƒŽ“ _______________
                                  _______________________________________________
                                  ===============================================
                    ‘ « ¦   ® œ å ˜   ‹ œ « ˜ ™   ™ ˜  æ £ œ ¤ ¦ ¬   € ¥   ¦ š ¨ á ­ ¦ ¬     ‘«¦ ®œå˜ €§¦›â¡«ž
   ˜/˜   „å›¦ª €¥ ¦š¨á­¦¬      €¨ Ÿ£æª     „¡›æ«žª      ’¨á§œ˜  †£.Šã¥žª   Œ¦£.         €¥å˜
/BodyR36
Image 11, BODYR36
  ___  _____________________ ____________ ____________ ________ __/__/____ ___ ___,___,___.__ ____________________
/TotalR36
Image 12, TOTALR36
------------------------------------------------------------------------------------------------------------------
                                                   ‘ç¤¦¢¦ €¥å˜ª €¥ ¦š¨á­à¤ ___,___,___,___.__
       ‚ ˜ «ž __________________________________               Ž ˜¨˜¢˜™é¤
˜¨˜«ž¨ã©œ ª: ____________________________________________________________
              ____________________________________________________________  !
/*
57044>>>>>    open codemast
57046>>>>>    open company
57048>>>>>    //AB-StoreTopEnd
57048>>>>>
57048>>>>>    //AB-IgnoreStart
57048>>>>>
57048>>>>>    Use DFAllEnt.pkg
57048>>>>>    Use Button.Sub
57048>>>>>
57048>>>>>    //AB-IgnoreEnd
57048>>>>>
57048>>>>>    ACTIVATE_VIEW Activate_r36 FOR r36
57052>>>>>
57052>>>>>    Object r36 is a ReportViewSub
57054>>>>>
57054>>>>>        //AB-StoreTopStart
57054>>>>>        
57054>>>>>        Property Integer Sort_Indexaxio   Public 1
57056>>>>>        Property string  psrecr           public ''
57058>>>>>        property integer piaa             public 0
57060>>>>>        //AB-StoreTopEnd
57060>>>>>
57060>>>>>        Set Label to "„¡«ç§à©ž Bmoves"
57061>>>>>        Set Size to 64 186
57062>>>>>        Set Location to 1 7
57063>>>>>
57063>>>>>        //AB-DDOStart
57063>>>>>
57063>>>>>
57063>>>>>        //AB-DDOEnd
57063>>>>>
57063>>>>>        Object DestRadio is a RadioGroup
57065>>>>>
57065>>>>>            //AB-StoreTopStart
57065>>>>>                        
57065>>>>>            //AB-StoreTopEnd
57065>>>>>
57065>>>>>            Set Label to "„¡«ç§à©ž"
57066>>>>>            Set Size to 42 49
57067>>>>>            Set Location to 2 1
57068>>>>>            Object WindowRadio is a Radio
57070>>>>>                Set Size to 13 30
57071>>>>>                Set Location to 12 12
57072>>>>>                Set Bitmap to "screen4.bmp"
57073>>>>>            End_Object    // WindowRadio
57074>>>>>
57074>>>>>            Object PrinterRadio is a Radio
57076>>>>>                Set Size to 10 31
57077>>>>>                Set Location to 30 12
57078>>>>>                Set Bitmap to "PRINT_M1.BMP"
57079>>>>>            End_Object    // PrinterRadio
57080>>>>>
57080>>>>>
57080>>>>>            //AB-StoreStart
57080>>>>>            Procedure Notify_Select_State  Integer iNewItem  Integer iOldItem
57082>>>>>                Forward Send Notify_Select_State  iNewItem  iOldItem
57084>>>>>                If iNewItem EQ 0 Set Output_Device_Mode  To PRINT_TO_WINDOW
57087>>>>>              //  Set Output_Device_Mode  To PRINT_TO_WINDOW
57087>>>>>            End_Procedure
57088>>>>>            
57088>>>>>            
57088>>>>>            
57088>>>>>            
57088>>>>>            
57088>>>>>            
57088>>>>>            
57088>>>>>            //AB-StoreEnd
57088>>>>>
57088>>>>>        End_Object    // DestRadio
57089>>>>>
57089>>>>>        Object ButtonSub3 is a ButtonSub
57091>>>>>
57091>>>>>            //AB-StoreTopStart
57091>>>>>                                                                                                                                                                                                                                                            
57091>>>>>            //AB-StoreTopEnd
57091>>>>>
57091>>>>>            Set Bitmap to "RUNPROG.BMP"
57092>>>>>            Set Size to 18 27
57093>>>>>            Set Location to 6 59
57094>>>>>
57094>>>>>            //AB-StoreStart
57094>>>>>            Procedure OnClick
57096>>>>>            
57096>>>>>            
57096>>>>>            End_Procedure
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            
57097>>>>>            //AB-StoreEnd
57097>>>>>
57097>>>>>        End_Object    // ButtonSub3
57098>>>>>
57098>>>>>        Object ButtonSub4 is a ButtonSub
57100>>>>>
57100>>>>>            //AB-StoreTopStart
57100>>>>>                                                                                                                                                                                                                                                                                            
57100>>>>>            //AB-StoreTopEnd
57100>>>>>
57100>>>>>            Set Bitmap to "CANCEL.BMP"
57101>>>>>            Set Size to 18 27
57102>>>>>            Set Location to 28 58
57103>>>>>
57103>>>>>            //AB-StoreStart
57103>>>>>            Procedure OnClick
57105>>>>>                Send Request_Cancel
57106>>>>>            End_Procedure
57107>>>>>            
57107>>>>>            
57107>>>>>            
57107>>>>>            
57107>>>>>            //AB-StoreEnd
57107>>>>>
57107>>>>>        End_Object    // ButtonSub4
57108>>>>>
57108>>>>>
57108>>>>>        //AB-StoreStart
57108>>>>>        
57108>>>>>        //Selection Variables
57108>>>>>        
57108>>>>>        //HELP-VARIABLES
57108>>>>>        
57108>>>>>        Procedure StartReport
57110>>>>>        
57110>>>>>            Local Integer iOutputDevice
57111>>>>>            Local String  FileName
57111>>>>>            local integer inew_state
57111>>>>>            Get Output_Device_Mode To iOutputDevice
57112>>>>>            If iOutputDevice EQ 0 Begin
57114>>>>>               Make_Temp_File "TXT" FileName
57115>>>>>               Move (".\" - FileName)  To FileName
57116>>>>>               Set Output_Device_Name  To FileName
57117>>>>>              // set piprinter to 1
57117>>>>>            End
57117>>>>>>
57117>>>>>            Else ;            Set Output_Device_Name  To "Lpt1:"
57119>>>>>        
57119>>>>>            SEND RUN_REPORT
57120>>>>>        
57120>>>>>         //   If iOutputDevice EQ 1 Begin
57120>>>>>         //      RunProgram background "notepad" FileName
57120>>>>>         //      EraseFile FileName
57120>>>>>          //  End
57120>>>>>        
57120>>>>>        End_Procedure   // StartReport
57121>>>>>        
57121>>>>>        
57121>>>>>        Object AXIO_BasicReport is a BasicReport
57123>>>>>        
57123>>>>>           Set Report_Title to "„¡«ç§à©ž €¥ ¦š¨á­à¤       "
57124>>>>>        
57124>>>>>           Object Btypkin_DD is a Btypkin_DataDictionary
57126>>>>>           End_Object    // Btypkin_DD
57127>>>>>        
57127>>>>>           Object Baxiokat_DD is a Baxiokat_DataDictionary
57129>>>>>           End_Object    // Baxiokat_DD
57130>>>>>        
57130>>>>>           Object Barticl_DD is a Barticl_DataDictionary
57132>>>>>              Set DDO_Server to (Btypkin_DD(self))
57133>>>>>           End_Object    // Barticl_DD
57134>>>>>        
57134>>>>>           Object Bsum_DD is a Bsum_DataDictionary
57136>>>>>              Set DDO_Server to (Barticl_DD(self))
57137>>>>>              Set Constrain_File to Barticl.File_Number
57138>>>>>           End_Object    // Bsum_DD
57139>>>>>        
57139>>>>>           Object Baxio_DD is a Baxio_DataDictionary
57141>>>>>              Set DDO_Server to (Baxiokat_DD(self))
57142>>>>>           End_Object    // Baxio_DD
57143>>>>>        
57143>>>>>           Object Syscurxr_DD is a Syscurxr_DataDictionary
57145>>>>>           End_Object    // Syscurxr_DD
57146>>>>>        
57146>>>>>            Object Clients_DD is a Clients_DataDictionary
57148>>>>>        
57148>>>>>            End_Object    // Clients_DD
57149>>>>>        
57149>>>>>        
57149>>>>>            Object Bmove_DD is a Bmove_DataDictionary
57151>>>>>                Set DDO_Server to (Barticl_DD(self))
57152>>>>>                Set DDO_Server to (Baxio_DD(self))
57153>>>>>                Set Constrain_File to Barticl.File_Number
57154>>>>>                begin_constraints
57156>>>>>                    constrain bmove.barticl_recr eq (psrecr(self))
57158>>>>>                end_constraints
57161>>>>>            End_Object    // Bmove_DD
57162>>>>>        
57162>>>>>        
57162>>>>>        
57162>>>>>        
57162>>>>>            //Main DD for the report
57162>>>>>            Set Server To (bmove_dd(Current_Object))
57163>>>>>        
57163>>>>>            //Breaks and Index for the report
57163>>>>>            Report_Index By Index.1
57165>>>>>            Function Starting_Main_Report Returns Integer
57167>>>>>              Integer iIndexaxio
57168>>>>>              Local Integer iRetVal
57168>>>>>              set page_feed to 66
57169>>>>>              set page_end to 60
57170>>>>>              set piaa to 0
57171>>>>>              Forward Get Starting_Main_Report to iRetval
57173>>>>>              send rebuild_constraints to bmove_dd
57174>>>>>              Send Find to (bmove_dd(self)) First_Record 1
57175>>>>>              Get Sort_Indexaxio  To iIndexaxio
57176>>>>>              Report_Index BY iIndexaxio
57178>>>>>           End_Function
57179>>>>>        
57179>>>>>           Procedure_Section Page_Top as HeaderR36
57184>>>>>               date ddate
57184>>>>>               sysdate4 ddate
57185>>>>>               clear company
57186>>>>>               move barticl.company_code  to company.company_code
57187>>>>>               find eq company by index.1
57188>>>>>>
57188>>>>>               print company.company_name to headerr36.1
57189>>>>>               print ddate                to headerr36.2
57190>>>>>               clear codemast
57191>>>>>               move 'JOB' to codemast.type
57192>>>>>               move company.company_j_code to codemast.code
57193>>>>>               find eq codemast by index.1
57194>>>>>>
57194>>>>>               move codemast.description   to headerr36.3
57195>>>>>               move barticl.barticl_no      to headerr36.4
57196>>>>>               move company.company_addr   to headerr36.5
57197>>>>>               move company.company_tk     to headerr36.6
57198>>>>>               move company.company_poli   to headerr36.7
57199>>>>>               move company.company_afm    to headerr36.8
57200>>>>>               clear codemast
57201>>>>>               move 'DOY' to codemast.type
57202>>>>>               move company.company_doy    to codemast.code
57203>>>>>               find eq codemast by index.1
57204>>>>>>
57204>>>>>               move codemast.description   to headerr36.9
57205>>>>>               move btypkin.btypkin_descr  to headerr36.10
57206>>>>>               OutPut_PageCheck
57207>>>>>           End_Procedure
57208>>>>>        
57208>>>>>           Procedure_Section  Body as BodyR36
57213>>>>>              number iaa
57213>>>>>              get piaa                      to iaa
57214>>>>>              add 1                         to iaa
57215>>>>>              set piaa                      to iaa
57216>>>>>              print iaa                     to bodyr36.1
57217>>>>>              print baxiokat.baxiokat_descr to bodyr36.2
57218>>>>>              Print baxio.baxio_no          to bodyr36.3
57219>>>>>              clear codemast
57220>>>>>              move 'BANK' to codemast.type
57221>>>>>              move baxio.baxio_banka to codemast.code
57222>>>>>              find eq codemast by index.1
57223>>>>>>
57223>>>>>              move baxio.baxio_epon_in    to bodyr36.4
57224>>>>>              move codemast.description   to bodyr36.5
57225>>>>>              move baxio.baxio_hmnial     to bodyr36.6
57226>>>>>              move baxio.baxio_c_code2    to bodyr36.7
57227>>>>>              print baxio.baxio_v2        to bodyr36.8
57228>>>>>              move baxio.baxio_epon_out   to bodyr36.9
57229>>>>>              add bodyr36.8               to totalr36.1
57230>>>>>              OutPut_PageCheck
57231>>>>>           End_Procedure
57232>>>>>        
57232>>>>>           PROCEDURE_SECTION TOTAL AS TOTALR36
57237>>>>>             // Subtotal BodyR36.8      TO totalr36.1
57237>>>>>              print totalr36.1
57238>>>>>              print company.company_name to totalr36.2
57239>>>>>              print barticl.sxolia1      to totalr36.3
57240>>>>>              print barticl.sxolia2      to totalr36.4
57241>>>>>              output_pagecheck
57242>>>>>           END_PROCEDURE
57243>>>>>        
57243>>>>>           Procedure Ending_Report
57245>>>>>             Blankform BodyR36.1      Thru BodyR36.9
57246>>>>>>
57246>>>>>           End_Procedure
57247>>>>>        
57247>>>>>        End_Object
57248>>>>>        
57248>>>>>        
57248>>>>>        Procedure Activate_View Returns Integer
57250>>>>>            Local Integer Rval
57251>>>>>            Forward Get MSG_Activate_View to Rval
57253>>>>>        End_Procedure
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        
57254>>>>>        //AB-StoreEnd
57254>>>>>
57254>>>>>    End_Object    // r36
57255>>>>>
57255>>>>>
57255>>>>>    //AB-StoreStart
57255>>>>>                                                        
57255>>>>>                                                        
57255>>>>>                                                        
57255>>>>>                                                        
57255>>>>>                                                        
57255>>>>>                                                        
57255>>>>>                                                        
57255>>>>>                                                        
57255>>>>>                                                        
57255>>>>>                                                        
57255>>>>>                                                        
57255>>>>>                                                        
57255>>>>>                                                        
57255>>>>>                                                        
57255>>>>>                                                        
57255>>>>>                                                        
57255>>>>>                                                        
57255>>>>>                                                        
57255>>>>>                                                        
57255>>>>>                                                        
57255>>>>>                                                        
57255>>>>>                                                        
57255>>>>>                                                        
57255>>>>>                                                        
57255>>>>>                                                        
57255>>>>>                                                        
57255>>>>>                                                        
57255>>>>>                                                        
57255>>>>>    //AB-StoreEnd
57255>>>>>
57255>>>>>//AB/     End_Object    // prj
57255>>>Use baxio.dd
57255>>>Use Tperga.dd
INCLUDING FILE: TPERGA.DD
57255>>>>>//DDB-FileStart
57255>>>>>//DDB-HeaderStart
57255>>>>>
57255>>>>>// File Name : TPERGA.DD
57255>>>>>// Class Name: Tperga_DataDictionary
57255>>>>>// Revision  : 14
57255>>>>>// Version   : 2
57255>>>>>
57255>>>>>Use  Windows           // Basic Definitions
57255>>>>>Use  DataDict          // DataDictionary Class Definition
57255>>>>>Use  DDvalTbl          // Validation Table Class Definitions
57255>>>>>
57255>>>>>Open Tperga
57257>>>>>Open Cn
57259>>>>>Open Baxiokat
57261>>>>>Open Sysrecc
57263>>>>>
57263>>>>>//DDB-HeaderEnd
57263>>>>>
57263>>>>>Class Tperga_DataDictionary  is a DataDictionary_Sec
57264>>>>>
57264>>>>>    Procedure Save_Main_File
57265>>>>>        If (Operation_Origin<>Self) Begin
57267>>>>>            If Tperga.Recnum Eq 0 Procedure_Return
57270>>>>>        End
57270>>>>>>
57270>>>>>        Forward Send Save_Main_File
57272>>>>>    End_Procedure
57273>>>>>
57273>>>>>
57273>>>>>
57273>>>>>    Procedure Creating
57274>>>>>        Forward Send Creating
57276>>>>>        // Insert Code Here
57276>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(TPErga.TPErga_Rec0))))));                                    to TPErga.TPErga_Recr
57277>>>>>    End_Procedure   // Creating
57278>>>>>
57278>>>>>    // Define_Fields:
57278>>>>>    // This procedure is used to set up all data-dictionary rules.
57278>>>>>
57278>>>>>    Procedure Define_Fields
57279>>>>>        Forward Send Define_Fields
57281>>>>>        //DDB-Generated-Code-Location
57281>>>>>        //DDB-DefineFieldStart
57281>>>>>
57281>>>>>        Set Main_File            To Tperga.File_Number
57282>>>>>        Set Cascade_Delete_State To FALSE
57283>>>>>
57283>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
57284>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
57285>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
57286>>>>>
57286>>>>>        // Parent (Server) file structure...............
57286>>>>>        Send Add_Server_File  Cn.File_Number
57287>>>>>        Send Add_Server_File  Baxiokat.File_Number
57288>>>>>
57288>>>>>        // External (System) file structure.............
57288>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
57289>>>>>
57289>>>>>        Define_Auto_Increment  Sysrecc.Tperga_Rec0  To Tperga.Tperga_Rec0
57292>>>>>
57292>>>>>        // Field-based properties.......................
57292>>>>>
57292>>>>>        // Tperga.Cn_Code
57292>>>>>
57292>>>>>        // Tperga.Baxiokat_Code
57292>>>>>
57292>>>>>        // Tperga.Pct_Epi_Synolou
57292>>>>>
57292>>>>>        // Tperga.Paralabh_Meres
57292>>>>>
57292>>>>>        // Tperga.Xarhtos_Meres
57292>>>>>
57292>>>>>        // Tperga.Plhroteo_Meres
57292>>>>>
57292>>>>>        // Tperga.Tperga_Rec0
57292>>>>>
57292>>>>>        // Tperga.Tperga_Recr
57292>>>>>
57292>>>>>        //DDB-DefineFieldEnd
57292>>>>>    End_Procedure    // Define_Fields
57293>>>>>
57293>>>>>    // Field_Defaults:
57293>>>>>    // This procedure is used to establish default field values.
57293>>>>>
57293>>>>>    Procedure Field_Defaults
57294>>>>>        Forward Send Field_Defaults
57296>>>>>        //DDB-Generated-Code-Location
57296>>>>>        //DDB-FieldDefaultStart
57296>>>>>        //DDB-FieldDefaultEnd
57296>>>>>    End_Procedure    // Field_Defaults
57297>>>>>
57297>>>>>End_Class    // Tperga_DataDictionary
57298>>>>>//DDB-FileEnd
57298>>>Use BtnOrdH.DD
INCLUDING FILE: BTNORDH.DD
57298>>>>>//DDB-FileStart
57298>>>>>//DDB-HeaderStart
57298>>>>>
57298>>>>>// File Name : BTNORDH.DD
57298>>>>>// Class Name: Btnordh_DataDictionary
57298>>>>>// Revision  : 51
57298>>>>>// Version   : 2
57298>>>>>
57298>>>>>Use  Windows           // Basic Definitions
57298>>>>>Use  DataDict          // DataDictionary Class Definition
57298>>>>>Use  DDvalTbl          // Validation Table Class Definitions
57298>>>>>
57298>>>>>Open Btnordh
57300>>>>>Open Btnordd
57302>>>>>Open Cn
57304>>>>>Open Sysrecc
57306>>>>>
57306>>>>>//DDB-HeaderEnd
57306>>>>>//DDB-ValidationStart
57306>>>>>
57306>>>>>Register_Object Btnordh_Velxr_VT1
57306>>>>>
57306>>>>>Object Btnordh_Velxr_VT1  is a CodeValidationTable
57308>>>>>    Set Type_Value        To "ELXREOSH"
57309>>>>>    Set Table_Title       To "•¨âà©ž „¢¢œ §é¤ ”¦¨«åà¤"
57310>>>>>    //DDB-ValidationCustomStart
57310>>>>>    //DDB-ValidationCustomEnd
57310>>>>>End_Object   // Btnordh_Velxr_VT1
57311>>>>>//DDB-ValidationEnd
57311>>>>>
57311>>>>>Class Btnordh_DataDictionary  is a DataDictionary_Sec
57312>>>>>    
57312>>>>>    Procedure Construct_Object
57313>>>>>        Forward Send Construct_Object
57315>>>>>        Property integer piactive  Public 0
57316>>>>>    End_Procedure
57317>>>>>    
57317>>>>>    Procedure Creating
57318>>>>>        String  sClientCode sCNCode
57319>>>>>        Integer iClientCode iCnCode iAA
57319>>>>>        date ddate
57319>>>>>        Forward Send Creating
57321>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                        (Trim(String(BTNORDH.Rec0)))))) to BTNORDH.Recr
57322>>>>>        if (sysfile.ascclientid=0);            Move (fsgStripCodeFromID(Clients.Client_ID))    to iClientCode
57325>>>>>        else;            mid clients.client_id to sclientcode 5 7 
57329>>>>>        Move (fsgStripCodeFromID(CN.CN_Code))           to iCnCode
57330>>>>>        Move Cn.AA_Deop                                 to iAA
57331>>>>>        Add 1                                           to iAA  
57332>>>>>        Add 1                                           to Cn.AA_Deop
57333>>>>>
57333>>>>>        if (sysfile.ascclientid=0);            Get Sfi_All_Numbers iClientCode Sysfile.Client_Digits 0 to sClientCode
57336>>>>>        Get Sfi_All_Numbers iCNCode     Sysfile.Client_Digits 0 to sCNCode
57337>>>>>        
57337>>>>>        Move (sClientCode+sCNCode+'/'+(String(iAA)))    to btnordh.aa_deop  
57338>>>>>        sysdate4 ddate
57339>>>>>        if (btnordh.date_create='') move ddate to btnordh.date_create
57342>>>>>        if (btnordh.deop_date ='') move ddate to btnordh.deop_date 
57345>>>>>        if (piactive(self)=1) move 0 to btnordh.deop_active
57348>>>>>        else move 1 to btnordh.deop_active
57350>>>>>        // Insert Code Here
57350>>>>>    End_Procedure   // Creating
57351>>>>>
57351>>>>>     Procedure Update
57352>>>>>        Forward Send Update 
57354>>>>>       
57354>>>>>        // Insert Code Here
57354>>>>>        Move SysCurXR.Company_Code  to btnordh.Vcompany
57355>>>>>        Move SysCurXR.Branch_Code   to btnordh.Vbranch 
57356>>>>>        move syscurxr.year_year     to btnordh.vyear  
57357>>>>>        move cn.cn_code             to btnordh.cn_code  
57358>>>>>        move clients.client_id      to btnordh.client_id
57359>>>>>        move payresp.presp_id       to btnordh.presp_id  
57360>>>>>        if (btnordh.deop_date = '');            move cn.cn_start_date to btnordh.deop_date
57363>>>>>     end_procedure
57364>>>>>
57364>>>>>
57364>>>>> 
57364>>>>>    // Define_Fields:
57364>>>>>    // This procedure is used to set up all data-dictionary rules.
57364>>>>>
57364>>>>>    Procedure Define_Fields
57365>>>>>        Forward Send Define_Fields
57367>>>>>        //DDB-Generated-Code-Location
57367>>>>>        //DDB-DefineFieldStart
57367>>>>>
57367>>>>>        Set Main_File            To Btnordh.File_Number
57368>>>>>        Set Cascade_Delete_State To FALSE
57369>>>>>
57369>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
57370>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
57371>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
57372>>>>>
57372>>>>>        // Child (Client) file structure................
57372>>>>>        Send Add_Client_File  Btnordd.File_Number
57373>>>>>
57373>>>>>        // Parent (Server) file structure...............
57373>>>>>        Send Add_Server_File  Cn.File_Number
57374>>>>>
57374>>>>>        // External (System) file structure.............
57374>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
57375>>>>>
57375>>>>>        Define_Auto_Increment  Sysrecc.Btnordh_Rec0  To Btnordh.Rec0
57378>>>>>
57378>>>>>        // Field-based properties.......................
57378>>>>>
57378>>>>>        // Btnordh.Vcompany
57378>>>>>
57378>>>>>        // Btnordh.Vbranch
57378>>>>>
57378>>>>>        // Btnordh.Vyear
57378>>>>>
57378>>>>>        // Btnordh.Rec0
57378>>>>>
57378>>>>>        // Btnordh.Recr
57378>>>>>
57378>>>>>        // Btnordh.Aa_Deop
57378>>>>>
57378>>>>>        // Btnordh.Cn_Recr
57378>>>>>
57378>>>>>        // Btnordh.Sxolia
57378>>>>>
57378>>>>>        // Btnordh.Cn_Code
57378>>>>>
57378>>>>>        // Btnordh.Client_Id
57378>>>>>
57378>>>>>        // Btnordh.Presp_Id
57378>>>>>
57378>>>>>        // Btnordh.Deop_Date
57378>>>>>        Set Field_Mask_Type        Field Btnordh.Deop_Date To MASK_DATE_WINDOW
57379>>>>>
57379>>>>>        // Btnordh.Deop_Active
57379>>>>>
57379>>>>>        // Btnordh.Eleiph
57379>>>>>
57379>>>>>        // Btnordh.Locked
57379>>>>>
57379>>>>>        // Btnordh.User_Id
57379>>>>>
57379>>>>>        // Btnordh.Date_Create
57379>>>>>
57379>>>>>        // Btnordh.Date_Modify
57379>>>>>
57379>>>>>        // Btnordh.Date_Locked
57379>>>>>
57379>>>>>        // Btnordh.Deop_Lhxh
57379>>>>>        Set Field_Mask_Type        Field Btnordh.Deop_Lhxh To MASK_DATE_WINDOW
57380>>>>>
57380>>>>>        // Btnordh.Statero
57380>>>>>
57380>>>>>        // Btnordh.Velxr
57380>>>>>        Set Field_Value_Table      Field Btnordh.Velxr To (Btnordh_Velxr_VT1(Self))
57381>>>>>
57381>>>>>        // Btnordh.Timeout
57381>>>>>
57381>>>>>        // Btnordh.Timeout1
57381>>>>>
57381>>>>>        //DDB-DefineFieldEnd
57381>>>>>    End_Procedure    // Define_Fields
57382>>>>>
57382>>>>>    
57382>>>>>    // Field_Defaults:
57382>>>>>    // This procedure is used to establish default field values.
57382>>>>>
57382>>>>>    Procedure Field_Defaults
57383>>>>>        Forward Send Field_Defaults
57385>>>>>        //DDB-Generated-Code-Location
57385>>>>>        //DDB-FieldDefaultStart
57385>>>>>        //DDB-FieldDefaultEnd
57385>>>>>    End_Procedure    // Field_Defaults
57386>>>>>
57386>>>>>End_Class    // Btnordh_DataDictionary
57387>>>>>//DDB-FileEnd
57387>>>Use BtnOrdD.DD
INCLUDING FILE: BTNORDD.DD
57387>>>>>//DDB-FileStart
57387>>>>>//DDB-HeaderStart
57387>>>>>
57387>>>>>// File Name : BTNORDD.DD
57387>>>>>// Class Name: Btnordd_DataDictionary
57387>>>>>// Revision  : 46
57387>>>>>// Version   : 2
57387>>>>>
57387>>>>>Use  Windows           // Basic Definitions
57387>>>>>Use  DataDict          // DataDictionary Class Definition
57387>>>>>Use  DDvalTbl          // Validation Table Class Definitions
57387>>>>>
57387>>>>>Open Btnordd
57389>>>>>Open Btnordh
57391>>>>>
57391>>>>>//DDB-HeaderEnd
57391>>>>>//DDB-ValidationStart
57391>>>>>
57391>>>>>Register_Object Btnordd_Vkatish_VT
57391>>>>>Register_Object Btnordd_Velxr_VT
57391>>>>>
57391>>>>>Object Btnordd_Vkatish_VT  is a CodeValidationTable
57393>>>>>    Set Type_Value        To "KATISH"
57394>>>>>    Set Allow_Blank_State To TRUE
57395>>>>>    Set Table_Title       To "‰€‡ˆ‘†"
57396>>>>>    //DDB-ValidationCustomStart
57396>>>>>    //DDB-ValidationCustomEnd
57396>>>>>End_Object   // Btnordd_Vkatish_VT
57397>>>>>
57397>>>>>Object Btnordd_Velxr_VT  is a CodeValidationTable
57399>>>>>    Set Type_Value        To "ELXREOSH"
57400>>>>>    Set Validate_State    To FALSE
57401>>>>>    Set Table_Title       To "•¨âà©ž „¢¢œ §é¤ ”¦¨«åà¤"
57402>>>>>    //DDB-ValidationCustomStart
57402>>>>>    //DDB-ValidationCustomEnd
57402>>>>>End_Object   // Btnordd_Velxr_VT
57403>>>>>//DDB-ValidationEnd
57403>>>>>Open Item
57405>>>>>
57405>>>>>Class Btnordd_DataDictionary  is a DataDictionary_Sec
57406>>>>> 
57406>>>>>    Procedure Construct_Object
57407>>>>>        Forward Send Construct_Object
57409>>>>>        Property Number pnOldPctDisc    Public 0
57410>>>>>        Property Number pnOldPosoDisc   Public 0
57411>>>>>    End_Procedure
57412>>>>>    
57412>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
57413>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
57415>>>>>        Set pnOldPctDisc    to Btnordd.Vdisc
57416>>>>>        Set pnOldPosoDisc   to Btnordd.VdiscPoso
57417>>>>>    End_Procedure   // New_Current_Record
57418>>>>>
57418>>>>>    Procedure Creating
57419>>>>>        Forward Send Creating   
57421>>>>>        move btnordh.deop_active to btnordd.vactive
57422>>>>>    End_Procedure   // Creating
57423>>>>> 
57423>>>>>   Procedure Update
57424>>>>>        Number iOldPct iOldPoso Total
57425>>>>>        Forward Send Update   
57427>>>>>        Get pnOldPosoDisc           to iOldPoso
57428>>>>>        Get pnOldPctDisc            to iOldPct
57429>>>>>        move btnordh.aa_deop        to btnordd.vorderbt
57430>>>>>        move btnordh.client_id      to btnordd.vclient_id
57431>>>>>        move btnordh.cn_code        to btnordd.vcn_code
57432>>>>>        move btnordh.deop_lhxh      to btnordd.deop_date   
57433>>>>>        move btnordh.deop_date      to btnordd.arxh_date
57434>>>>>      
57434>>>>>        If  (Btnordd.Vqty <> 0) Begin
57436>>>>>            Move  btnordd.VunitPrice to btnordd.Vprice
57437>>>>>            If (btnordd.vdisc >0) move (round_number(((btnordd.vprice * btnordd.vdisc) / 100),2)) to total
57440>>>>>            Move (btnordd.vprice - total) to btnordd.vprice
57441>>>>>        End
57441>>>>>>
57441>>>>>        Else Begin
57442>>>>>            move 0 to btnordd.vprice
57443>>>>>            Move 0 to btnordd.Vdisc
57444>>>>>            Move 0 to btnordd.VdiscPoso
57445>>>>>        End
57445>>>>>>
57445>>>>>
57445>>>>>        Clear Item
57446>>>>>        Move Btnordd.Vitem to Item.Item_Code
57447>>>>>        Find Eq Item by Index.5
57448>>>>>>
57448>>>>>        Move Item.Item_Descr to btnordd.Vitem_Descr
57449>>>>>        Move Item.Item_Qual  to btnordd.VQual
57450>>>>>   End_Procedure
57451>>>>>   
57451>>>>> 
57451>>>>>
57451>>>>>    // Define_Fields:
57451>>>>>    // This procedure is used to set up all data-dictionary rules.
57451>>>>>
57451>>>>>    Procedure Define_Fields
57452>>>>>        Forward Send Define_Fields
57454>>>>>        //DDB-Generated-Code-Location
57454>>>>>        //DDB-DefineFieldStart
57454>>>>>
57454>>>>>        Set Main_File            To Btnordd.File_Number
57455>>>>>
57455>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
57456>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
57457>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
57458>>>>>
57458>>>>>        // Parent (Server) file structure...............
57458>>>>>        Send Add_Server_File  Btnordh.File_Number
57459>>>>>
57459>>>>>        // Field-based properties.......................
57459>>>>>
57459>>>>>        // Btnordd.Btnordh_Recr
57459>>>>>
57459>>>>>        // Btnordd.Vitem
57459>>>>>
57459>>>>>        // Btnordd.Vitem_Descr
57459>>>>>
57459>>>>>        // Btnordd.Vqual
57459>>>>>
57459>>>>>        // Btnordd.Vqty
57459>>>>>
57459>>>>>        // Btnordd.Vunitprice
57459>>>>>
57459>>>>>        // Btnordd.Vdisc
57459>>>>>
57459>>>>>        // Btnordd.Vprice
57459>>>>>
57459>>>>>        // Btnordd.Vkatish
57459>>>>>        Set Field_Value_Table      Field Btnordd.Vkatish To (Btnordd_Vkatish_VT(Self))
57460>>>>>
57460>>>>>        // Btnordd.Vxrm3
57460>>>>>
57460>>>>>        // Btnordd.Vpagiaxrm3
57460>>>>>
57460>>>>>        // Btnordd.Vpagiaxrprice
57460>>>>>
57460>>>>>        // Btnordd.Vanopagia
57460>>>>>
57460>>>>>        // Btnordd.Vsthsimo
57460>>>>>
57460>>>>>        // Btnordd.Veleipes
57460>>>>>
57460>>>>>        // Btnordd.Vorderbt
57460>>>>>
57460>>>>>        // Btnordd.Vclient_Id
57460>>>>>
57460>>>>>        // Btnordd.Vcn_Code
57460>>>>>
57460>>>>>        // Btnordd.Vactive
57460>>>>>
57460>>>>>        // Btnordd.Deop_Date
57460>>>>>
57460>>>>>        // Btnordd.Velxr
57460>>>>>        Set Field_Value_Table      Field Btnordd.Velxr To (Btnordd_Velxr_VT(Self))
57461>>>>>
57461>>>>>        // Btnordd.Arxh_Date
57461>>>>>        Set Field_Mask_Type        Field Btnordd.Arxh_Date To MASK_DATE_WINDOW
57462>>>>>
57462>>>>>        // Btnordd.Vdiscposo
57462>>>>>
57462>>>>>        // Btnordd.Vqtyused
57462>>>>>
57462>>>>>        //DDB-DefineFieldEnd
57462>>>>>    End_Procedure    // Define_Fields
57463>>>>>
57463>>>>>    // Field_Defaults:
57463>>>>>    // This procedure is used to establish default field values.
57463>>>>>
57463>>>>>    Procedure Field_Defaults
57464>>>>>        Forward Send Field_Defaults
57466>>>>>        //DDB-Generated-Code-Location
57466>>>>>        //DDB-FieldDefaultStart
57466>>>>>        //DDB-FieldDefaultEnd
57466>>>>>    End_Procedure    // Field_Defaults
57467>>>>>
57467>>>>>End_Class    // Btnordd_DataDictionary
57468>>>>>//DDB-FileEnd
57468>>>Use Mhxanik.DD
INCLUDING FILE: MHXANIK.DD
57468>>>>>//DDB-FileStart
57468>>>>>//DDB-HeaderStart
57468>>>>>
57468>>>>>// File Name : MHXANIK.DD
57468>>>>>// Class Name: Mhxanik_DataDictionary
57468>>>>>// Revision  : 24
57468>>>>>// Version   : 2
57468>>>>>
57468>>>>>Use  Windows           // Basic Definitions
57468>>>>>Use  DataDict          // DataDictionary Class Definition
57468>>>>>Use  DDvalTbl          // Validation Table Class Definitions
57468>>>>>
57468>>>>>Open Mhxanik
57470>>>>>Open Cn
57472>>>>>Open Sysrecc
57474>>>>>
57474>>>>>//DDB-HeaderEnd
57474>>>>>//DDB-ValidationStart
57474>>>>>
57474>>>>>Register_Object Mhxanik_Mhx_Doy_VT
57474>>>>>
57474>>>>>Object Mhxanik_Mhx_Doy_VT  is a CodeValidationTable
57476>>>>>    Set Type_Value        To "DOY"
57477>>>>>    Set Validate_State    To FALSE
57478>>>>>    Set Allow_Blank_State To TRUE
57479>>>>>    //DDB-ValidationCustomStart
57479>>>>>    //DDB-ValidationCustomEnd
57479>>>>>End_Object   // Mhxanik_Mhx_Doy_VT
57480>>>>>//DDB-ValidationEnd
57480>>>>>//DDB-SelectionStart
57480>>>>>//DDB/ ExternalSelectionList sl055  sl055.SL
57480>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
57480>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
57480>>>>>Register_Object sl055
57480>>>>>Register_Object sl198
57480>>>>>Register_Object sl197
57480>>>>>//DDB-SelectionEnd
57480>>>>>
57480>>>>>Class Mhxanik_DataDictionary  is a DataDictionary_Sec
57481>>>>>
57481>>>>>     Procedure Update
57482>>>>>        Forward Send Update
57484>>>>>        // Insert Code Here
57484>>>>>        Move SysCurXR.Company_Code  to Mhxanik.Company_Code
57485>>>>>        Move SysCurXR.Branch_Code   to Mhxanik.Branch_Code
57486>>>>>        Move SysCurXR.Year_Year     to Mhxanik.Year_Year
57487>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
57487>>>>>        Move (Mhxanik.Xreosh-Mhxanik.Pistosh)   to Mhxanik.Ypoloipo
57488>>>>>        Move (Mhxanik.Plafon-Mhxanik.ypoloipo)  to Mhxanik.Overhead
57489>>>>>
57489>>>>>        //Move Clients.Client_Address     to Clients.Client_LastUpd
57489>>>>>
57489>>>>>        //betolink
57489>>>>>        Move SysCurXR.Beto_Site         to Mhxanik.Mhx_SiteW
57490>>>>>        Move Mhxanik.Mhx_Rec0           to Mhxanik.Mhx_SN
57491>>>>>        Move Mhxanik.Mhx_id             to Mhxanik.Mhx_Repm
57492>>>>>
57492>>>>>    End_Procedure   // Update
57493>>>>>
57493>>>>>     Procedure Creating
57494>>>>>        Forward Send Creating
57496>>>>>        // Insert Code Here
57496>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Mhxanik.Mhx_Rec0))))));                                    to Mhxanik.Mhx_Recr
57497>>>>>        Move '1'                    to Mhxanik.Mhx_Active
57498>>>>>        get fsgCode_With_Zeroes Mhxanik.Mhx_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to Mhxanik.Mhx_ID
57499>>>>>    End_Procedure   // Creating
57500>>>>>
57500>>>>>
57500>>>>>    // Define_Fields:
57500>>>>>    // This procedure is used to set up all data-dictionary rules.
57500>>>>>
57500>>>>>    Procedure Define_Fields
57501>>>>>        Forward Send Define_Fields
57503>>>>>        //DDB-Generated-Code-Location
57503>>>>>        //DDB-DefineFieldStart
57503>>>>>
57503>>>>>        Set Main_File            To Mhxanik.File_Number
57504>>>>>        Set Cascade_Delete_State To FALSE
57505>>>>>
57505>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
57506>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
57507>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
57508>>>>>
57508>>>>>        // Child (Client) file structure................
57508>>>>>        Send Add_Client_File  Cn.File_Number
57509>>>>>
57509>>>>>        // External (System) file structure.............
57509>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
57510>>>>>
57510>>>>>        Define_Auto_Increment  Sysrecc.Mhxanik_Rec0  To Mhxanik.Mhx_Rec0
57513>>>>>
57513>>>>>        // Field-based properties.......................
57513>>>>>
57513>>>>>        // Mhxanik.Company_Code
57513>>>>>
57513>>>>>        // Mhxanik.Branch_Code
57513>>>>>
57513>>>>>        // Mhxanik.Year_Year
57513>>>>>
57513>>>>>        // Mhxanik.Mhx_Id
57513>>>>>        Set Field_Options          Field Mhxanik.Mhx_Id To DD_AUTOFIND    DD_NOPUT      
57514>>>>>        Set Field_Prompt_Object    Field Mhxanik.Mhx_Id To (sl055(Self))
57515>>>>>        Set Key_Field_State        Field Mhxanik.Mhx_Id To TRUE
57516>>>>>
57516>>>>>        // Mhxanik.Mhx_Name
57516>>>>>        Set Field_Prompt_Object    Field Mhxanik.Mhx_Name To (sl055(Self))
57517>>>>>
57517>>>>>        // Mhxanik.Mhx_Afm
57517>>>>>
57517>>>>>        // Mhxanik.Mhx_Rec0
57517>>>>>
57517>>>>>        // Mhxanik.Mhx_Recr
57517>>>>>
57517>>>>>        // Mhxanik.Last_Xreosh
57517>>>>>
57517>>>>>        // Mhxanik.Last_Pistosh
57517>>>>>
57517>>>>>        // Mhxanik.Last_Order
57517>>>>>
57517>>>>>        // Mhxanik.Mhx_Doy
57517>>>>>        Set Field_Value_Table      Field Mhxanik.Mhx_Doy To (Mhxanik_Mhx_Doy_VT(Self))
57518>>>>>
57518>>>>>        // Mhxanik.Mhx_Address
57518>>>>>
57518>>>>>        // Mhxanik.Mhx_City
57518>>>>>        Set Field_Prompt_Object    Field Mhxanik.Mhx_City To (sl198(Self))
57519>>>>>
57519>>>>>        // Mhxanik.Mhx_Area
57519>>>>>        Set Field_Prompt_Object    Field Mhxanik.Mhx_Area To (sl197(Self))
57520>>>>>
57520>>>>>        // Mhxanik.Mhx_Job
57520>>>>>
57520>>>>>        // Mhxanik.Mhx_Respons
57520>>>>>
57520>>>>>        // Mhxanik.Mhx_Zipcode
57520>>>>>
57520>>>>>        // Mhxanik.Mhx_Phone
57520>>>>>
57520>>>>>        // Mhxanik.Mhx_Fax
57520>>>>>
57520>>>>>        // Mhxanik.Mhx_Mobile
57520>>>>>
57520>>>>>        // Mhxanik.Mhx_Aoh
57520>>>>>
57520>>>>>        // Mhxanik.Mhx_Email
57520>>>>>
57520>>>>>        // Mhxanik.Mhx_Class
57520>>>>>
57520>>>>>        // Mhxanik.Mhx_Details
57520>>>>>
57520>>>>>        // Mhxanik.Mhx_Sitew
57520>>>>>
57520>>>>>        // Mhxanik.Mhx_Codem
57520>>>>>
57520>>>>>        // Mhxanik.Mhx_Categfpa
57520>>>>>
57520>>>>>        // Mhxanik.Mhx_Fpa
57520>>>>>
57520>>>>>        // Mhxanik.Mhx_Public
57520>>>>>
57520>>>>>        // Mhxanik.Mhx_Sn
57520>>>>>
57520>>>>>        // Mhxanik.Mhx_Repm
57520>>>>>
57520>>>>>        // Mhxanik.Mhx_Active
57520>>>>>
57520>>>>>        // Mhxanik.Mhx_Reported
57520>>>>>
57520>>>>>        // Mhxanik.Mhx_Lastupd
57520>>>>>
57520>>>>>        // Mhxanik.Mhx_Markexp
57520>>>>>
57520>>>>>        // Mhxanik.Mhx_Catjob
57520>>>>>
57520>>>>>        // Mhxanik.Xreosh
57520>>>>>
57520>>>>>        // Mhxanik.Pistosh
57520>>>>>
57520>>>>>        // Mhxanik.Ypoloipo
57520>>>>>
57520>>>>>        // Mhxanik.Plafon
57520>>>>>
57520>>>>>        // Mhxanik.Overhead
57520>>>>>
57520>>>>>        // Mhxanik.Mhx_Add_No
57520>>>>>
57520>>>>>        // Mhxanik.Mhx_Nomos
57520>>>>>
57520>>>>>        // Mhxanik.Mhx_Xora
57520>>>>>
57520>>>>>        // Mhxanik.Polh_Recr
57520>>>>>
57520>>>>>        //DDB-DefineFieldEnd
57520>>>>>    End_Procedure    // Define_Fields
57521>>>>>
57521>>>>>    // Field_Defaults:
57521>>>>>    // This procedure is used to establish default field values.
57521>>>>>
57521>>>>>    Procedure Field_Defaults
57522>>>>>        Forward Send Field_Defaults
57524>>>>>        //DDB-Generated-Code-Location
57524>>>>>        //DDB-FieldDefaultStart
57524>>>>>        Set Field_Changed_Value   Field Mhxanik.Mhx_Doy To "0"
57525>>>>>        Set Field_Changed_Value   Field Mhxanik.Mhx_City To 0
57526>>>>>        //DDB-FieldDefaultEnd
57526>>>>>    End_Procedure    // Field_Defaults
57527>>>>>
57527>>>>>End_Class    // Mhxanik_DataDictionary
57528>>>>>//DDB-Selection-pkg-Start
57528>>>>>
57528>>>>>Use sl055.SL         // sl055
INCLUDING FILE: SL055.SL
57528>>>>>>>//AB/ Project sl055:mhxanikoi
57528>>>>>>>//AB/ Object prj is a Lookup_Project
57528>>>>>>>//AB/     Set ProjectName to "sl055:mhxanikoi"
57528>>>>>>>//AB/     Set ProjectFileName to "sl055.SL"
57528>>>>>>>//AB/     Set GenerateFileName to "NONAME"
57528>>>>>>>
57528>>>>>>>// Project Object Structure
57528>>>>>>>//   sl055 is a dbModalPanelSub
57528>>>>>>>//     Mhxanik_DD is a DataDictionary
57528>>>>>>>//     oSelList is a dbListSub
57528>>>>>>>//     oOK_bn is a ButtonSub
57528>>>>>>>//     oCancel_bn is a ButtonSub
57528>>>>>>>//     oSearch_bn is a ButtonSub
57528>>>>>>>
57528>>>>>>>// Register all objects
57528>>>>>>>Register_Object Mhxanik_DD
57528>>>>>>>Register_Object oCancel_bn
57528>>>>>>>Register_Object oOK_bn
57528>>>>>>>Register_Object oSearch_bn
57528>>>>>>>Register_Object oSelList
57528>>>>>>>Register_Object sl055
57528>>>>>>>
57528>>>>>>>
57528>>>>>>>//AB-IgnoreStart
57528>>>>>>>
57528>>>>>>>Use DFAllEnt.pkg
57528>>>>>>>Use dbList.Sub
57528>>>>>>>Use Button.Sub
57528>>>>>>>
57528>>>>>>>
57528>>>>>>>Use MHXANIK.DD
57528>>>>>>>
57528>>>>>>>//AB-IgnoreEnd
57528>>>>>>>
57528>>>>>>>Object sl055 is a dbModalPanelSub
57530>>>>>>>    Set Label to "€¨®œå¦ ‹ž®˜¤ ¡é¤"
57531>>>>>>>    Set Size to 148 430
57532>>>>>>>    Set Location to 4 5
57533>>>>>>>    Set Exit_Application_Local_State to FALSE
57534>>>>>>>    Set Modal_State to FALSE
57535>>>>>>>
57535>>>>>>>    //AB-DDOStart
57535>>>>>>>
57535>>>>>>>    Object Mhxanik_DD is a Mhxanik_DataDictionary
57537>>>>>>>    End_Object    // Mhxanik_DD
57538>>>>>>>
57538>>>>>>>    Set Main_DD to (Mhxanik_DD(self))
57539>>>>>>>    Set Server to (Mhxanik_DD(self))
57540>>>>>>>
57540>>>>>>>    //AB-DDOEnd
57540>>>>>>>
57540>>>>>>>    Object oSelList is a dbListSub
57542>>>>>>>        Set Main_File to Mhxanik.File_Number
57543>>>>>>>        Set Size to 105 415
57544>>>>>>>        Set Location to 6 6
57545>>>>>>>
57545>>>>>>>        Begin_Row
57548>>>>>>>            Entry_Item Mhxanik.Mhx_id
57549>>>>>>>            Entry_Item Mhxanik.Mhx_name
57550>>>>>>>            Entry_Item Mhxanik.Mhx_afm
57551>>>>>>>            Entry_Item Mhxanik.Mhx_address
57552>>>>>>>            Entry_Item Mhxanik.Mhx_phone
57553>>>>>>>        End_Row
57558>>>>>>>
57558>>>>>>>        Set Form_Width    item 0 to 70
57559>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
57560>>>>>>>        
57560>>>>>>>        Set Form_Width    item 1 to 100
57561>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
57562>>>>>>>        
57562>>>>>>>        Set Form_Width    item 2 to 50
57563>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
57564>>>>>>>        
57564>>>>>>>        Set Form_Width    item 3 to 135
57565>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
57566>>>>>>>        
57566>>>>>>>        Set Form_Width    item 4 to 52
57567>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
57568>>>>>>>        
57568>>>>>>>    End_Object    // oSelList
57569>>>>>>>
57569>>>>>>>    Object oOK_bn is a ButtonSub
57571>>>>>>>        Set Label to "&„§ ¢¦šã"
57572>>>>>>>        Set Location to 113 263
57573>>>>>>>
57573>>>>>>>        //AB-StoreStart
57573>>>>>>>        Procedure OnClick
57575>>>>>>>            Send OK To (oSelList(current_object))
57576>>>>>>>        End_Procedure
57577>>>>>>>        //AB-StoreEnd
57577>>>>>>>
57577>>>>>>>    End_Object    // oOK_bn
57578>>>>>>>
57578>>>>>>>    Object oCancel_bn is a ButtonSub
57580>>>>>>>        Set Label to "&€¡ç¨à©ž"
57581>>>>>>>        Set Location to 113 317
57582>>>>>>>
57582>>>>>>>        //AB-StoreStart
57582>>>>>>>        Procedure OnClick
57584>>>>>>>            Send Cancel To (oSelList(current_object))
57585>>>>>>>        End_Procedure
57586>>>>>>>        //AB-StoreEnd
57586>>>>>>>
57586>>>>>>>    End_Object    // oCancel_bn
57587>>>>>>>
57587>>>>>>>    Object oSearch_bn is a ButtonSub
57589>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
57590>>>>>>>        Set Location to 113 373
57591>>>>>>>
57591>>>>>>>        //AB-StoreStart
57591>>>>>>>        Procedure OnClick
57593>>>>>>>            Send Search To (oSelList(current_object))
57594>>>>>>>        End_Procedure
57595>>>>>>>        //AB-StoreEnd
57595>>>>>>>
57595>>>>>>>    End_Object    // oSearch_bn
57596>>>>>>>
57596>>>>>>>
57596>>>>>>>    //AB-StoreStart
57596>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
57597>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
57598>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
57599>>>>>>>    //AB-StoreEnd
57599>>>>>>>
57599>>>>>>>End_Object    // sl055
57600>>>>>>>
57600>>>>>>>//AB/ End_Object    // prj
57600>>>>>Use sl198.sl         // sl198
57600>>>>>Use sl197.SL         // sl197
57600>>>>>
57600>>>>>//DDB-Selection-pkg-End
57600>>>>>//DDB-FileEnd
57600>>>Use Constrct.dd
57600>>>Use Salesmen.dd
57600>>>use sysrecc.dd
57600>>>
57600>>>//Use bp2ndCop.dg
57600>>>//Use bpACopen.dg
57600>>>
57600>>>
57600>>>//AB-StoreTopEnd
57600>>>
57600>>>//AB-IgnoreStart
57600>>>
57600>>>Use dbView.Sub
57600>>>Use Form.Sub
57600>>>Use Button.Sub
57600>>>Use Txtbox.Sub
57600>>>Use Rgroup.Sub
57600>>>Use Radio.Sub
57600>>>Use DFAllEnt.pkg
57600>>>
57600>>>//AB-IgnoreEnd
57600>>>
57600>>>ACTIVATE_VIEW Activate_tAxioamal FOR tAxioamal
57604>>>
57604>>>Object tAxioamal is a dbViewSub
57606>>>
57606>>>    //AB-StoreTopStart
57606>>>                                                    
57606>>>    Property Integer piLathos   Public   0
57608>>>    Property String  psModule   Public '01'
57610>>>    Property Integer piWhat     Public   0
57612>>>    
57612>>>    //Open Sysrecc
57612>>>    Open SysCurXR
57614>>>    Open Year
57616>>>    
57616>>>    
57616>>>    //////////////////////////////////////////////////////
57616>>>    // DataDictionary Structure needed for making Barticle
57616>>>    //////////////////////////////////////////////////////
57616>>>    
57616>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
57618>>>    End_Object    // Ctypkin_DD
57619>>>    
57619>>>    Object Country_DD is a Country_DataDictionary
57621>>>    End_Object    // Country_DD
57622>>>    
57622>>>    Object Towns_DD is a Towns_DataDictionary
57624>>>        Set DDO_Server to (Country_DD(self))
57625>>>    End_Object    // Towns_DD
57626>>>    
57626>>>    Object Cities_DD is a Cities_DataDictionary
57628>>>        Set DDO_Server to (Towns_DD(self))
57629>>>    End_Object    // Cities_DD
57630>>>    
57630>>>    Object Payresp_DD is a Payresp_DataDictionary
57632>>>    End_Object    // Payresp_DD
57633>>>    
57633>>>    Object Constrct_DD is a Constrct_DataDictionary
57635>>>    End_Object    // Constrct_DD
57636>>>    
57636>>>    Object Salesmen_DD is a Salesmen_DataDictionary
57638>>>    End_Object    // Salesmen_DD
57639>>>    
57639>>>    Object Mhxanik_DD is a Mhxanik_DataDictionary
57641>>>    End_Object    // Mhxanik_DD
57642>>>    
57642>>>    Object Areas_DD is a Areas_DataDictionary
57644>>>    End_Object    // Areas_DD
57645>>>    
57645>>>    Object Btypkin_DD is a Btypkin_DataDictionary
57647>>>        Set Foreign_Field_Options DD_KEYFIELD           to DD_Clear_Field_Options DD_FindReq
57648>>>        Set Foreign_Field_Options DD_INDEXFIELD         to DD_Clear_Field_Options DD_FindReq
57649>>>        Set Field_Options Field Btypkin.Btypkin_Code    to DD_Clear_Field_Options DD_Required
57650>>>    End_Object    // Btypkin_DD
57651>>>    
57651>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
57653>>>    End_Object    // Baxiokat_DD
57654>>>    
57654>>>    Object Barticl_DD is a Barticl_DataDictionary
57656>>>        Set DDO_Server to (Btypkin_DD(self))
57657>>>    End_Object    // Barticl_DD
57658>>>    
57658>>>    Object Bsum_DD is a Bsum_DataDictionary
57660>>>        Set DDO_Server to (Barticl_DD(self))
57661>>>        Set Constrain_File to Barticl.File_Number
57662>>>    End_Object    // Bsum_DD
57663>>>    
57663>>>    Object Baxio_DD is a Baxio_DataDictionary
57665>>>        Set DDO_Server to (Baxiokat_DD(self))
57666>>>        Set allow_foreign_new_save_state to true
57667>>>    End_Object    // Baxio_DD
57668>>>    
57668>>>    Object Syscurxr_DD is a Syscurxr_DataDictionary
57670>>>    End_Object    // Syscurxr_DD
57671>>>    
57671>>>    Object Sysrecc_DD is a Sysrecc_DataDictionary
57673>>>    End_Object    // Sysrecc
57674>>>    
57674>>>    Object Clients_DD is a Clients_DataDictionary
57676>>>        Set DDO_Server to (Cities_DD(self))
57677>>>        Set DDO_Server to (Payresp_DD(self))
57678>>>        Set DDO_Server to (Areas_DD(self))
57679>>>    End_Object    // Clients_DD
57680>>>    
57680>>>    Object Cn_DD is a Cn_DataDictionary
57682>>>        Set DDO_Server to (Clients_DD(self))
57683>>>        Set DDO_Server to (Constrct_DD(self))
57684>>>        Set DDO_Server to (Salesmen_DD(self))
57685>>>        Set DDO_Server to (Mhxanik_DD(self))
57686>>>    End_Object    // Cn_DD
57687>>>    
57687>>>    Object Tperga_DD is a Tperga_DataDictionary
57689>>>        Set DDO_Server to (CN_DD(self))
57690>>>        Set DDO_Server to (Baxiokat_DD(self))
57691>>>        Set Constrain_File to CN.File_Number
57692>>>    End_Object    // Btnordd_DD
57693>>>    
57693>>>    Object Bmove_DD is a Bmove_DataDictionary
57695>>>        Set DDO_Server to (Barticl_DD(self))
57696>>>        Set DDO_Server to (Baxio_DD(self))
57697>>>        Set Constrain_File to Barticl.File_Number
57698>>>    End_Object    // Bmove_DD
57699>>>    
57699>>>    Object Cmoves_DD is a Cmoves_DataDictionary
57701>>>        Set DDO_Server to (Ctypkin_DD(self))
57702>>>        Set DDO_Server to (Clients_DD(self))
57703>>>        //Set Constrain_File to Clients.File_Number
57703>>>        Set piFromBP to True
57704>>>    
57704>>>    
57704>>>        Procedure Update
57706>>>            String  sNomisma
57707>>>            Date    dHmnia
57707>>>            Move Cmoves.Cmoves_Hmnia                to  dHmnia
57708>>>            If (dHmnia='') Sysdate4                     Cmoves.Cmoves_Hmnia
57711>>>            Move Cmoves.Cmoves_Sc_Code2             to  sNomisma
57712>>>            Move (Trim(sNomisma))                   to  sNomisma
57713>>>            If (sNomisma='') Move SysCurXr.C_Code0  to  Cmoves.Cmoves_Sc_Code2
57716>>>    
57716>>>            Send Compute_all_Fields 1
57717>>>    
57717>>>            Forward Send Update
57719>>>    
57719>>>            If (Ctypkin.Open_Item='1') Begin
57721>>>                If (Cmoves.Axia_Pros_Sysx=0) ;                    Move (Abs(Cmoves.Cmoves_Axia))              to Cmoves.Axia_Pros_Sysx
57724>>>                Move (Cmoves.Axia_Pros_Sysx-Cmoves.Axia_Sysxet) to Cmoves.Axia_Ypol_Sysx
57725>>>                Move (Cmoves.Axia_Ypol_Sysx<>0)                 to Cmoves.Flag_Ypol
57726>>>    
57726>>>                If ((Cmoves.Cmoves_X0<>0) And ((Cmoves.Cmoves_P0=0))) Begin
57728>>>                    Move 1                          to Cmoves.Flag_Copen
57729>>>                    If (Cmoves.Cmoves_X0<0) Move 2  to Cmoves.Flag_Copen
57732>>>                End
57732>>>>
57732>>>                Else If ((Cmoves.Cmoves_P0<>0) And ((Cmoves.Cmoves_X0=0))) Begin
57735>>>                    Move 2                          to Cmoves.Flag_Copen
57736>>>                    If (Cmoves.Cmoves_P0<0) Move 1  to Cmoves.Flag_Copen
57739>>>                End
57739>>>>
57739>>>                Else Move 0 to Cmoves.Flag_Copen
57741>>>            End
57741>>>>
57741>>>        End_Procedure
57742>>>    
57742>>>        Procedure Backout
57744>>>            Forward Send Backout
57746>>>            Send Compute_all_Fields (-1)
57747>>>        End_Procedure
57748>>>    
57748>>>        Procedure Compute_all_Fields Number aiSign
57750>>>            Integer iErr isClosed iInt iWithDeletion iClient iSign
57751>>>            Integer iOneWflag iiPartlNO iExitFlag iMustSaveWCmoves iMustSaveClientYpoloipa
57751>>>            Integer iMustSaveCmoves iMustSaveClient iMyf iInt2 iOneCflag
57751>>>            Integer iMaxDays iAnameneiSxetiko iExeiSxetika iPartlTimol imustsaveofeilh
57751>>>    
57751>>>            String  ssPtypparDescr ssSeiraDescr sWCmovesRecr sRecr2 ssPtypparDescrShort
57751>>>            String  sRecr sParticle_CmovesRecr sCtypkinRecr sCn_Code
57751>>>            String  sClientRecr sCmovesRecr sNomisma sFlag sWtypkinRecr
57751>>>            String  sWitemxRecr sWaxRecr sClientID sPerigrafh sParticle_WCmovesRecr
57751>>>    
57751>>>            Number  nVatam nGenAm nExtra nPayam nDiscAm nIsotimia
57751>>>            Number  nTotAmBd nTotDiscPms nTotDiscPC nTotAmAd
57751>>>            Number  nAthr1 nAthr2 nAthr3 nAthr4 nAthr5 nAthr6
57751>>>            Number  nPoso nXre nPis nMyf nPosothta nAthr7 nAthr8
57751>>>    
57751>>>            Date    dHmnia dLastPis dLastXre dLastXreParast dLastPisParast
57751>>>            String sModule
57751>>>    
57751>>>            Move '01' to sModule
57752>>>    
57752>>>            Move 1 to iSign
57753>>>    
57753>>>            If ((Cmoves.Module_From=sModule) And (Cmoves.Barticl_Recr='') And (Cmoves.Partl_Recr=''))  Begin
57755>>>    
57755>>>                Move Ctypkin.Ctypkin_Recr   to sCtypkinRecr
57756>>>                move clients.client_recr    to sclientrecr
57757>>>                Move Cmoves.Cmoves_sc_code2 to sNomisma
57758>>>                Move (Trim(sNomisma))       to sNomisma
57759>>>    
57759>>>                If (Trim(sCtypkinRecr)='') Begin
57761>>>                    send stop_box '-åí ??åôå åðéë?îåé ôýðï ê-íç?ç?' ("error 1011 vwcmoves  "+'?ëçñï?ïñ-á')
57762>>>                    Procedure_Return
57763>>>                End
57763>>>>
57763>>>                Else If (Trim(sClientRecr)='') Begin
57766>>>                        if (smodule='01') send stop_box '-åí ??åôå åðéë?îåé ?åë-ôç'      ("error 1012 vwcmoves  "+'?ëçñï?ïñ-á')
57769>>>                    else if (smodule='02') send stop_box '-åí ??åôå åðéë?îåé ?ñïìçèåõô?'  ("error 1013 vwcmoves  "+'?ëçñï?ïñ-á')
57773>>>                    Procedure_Return
57774>>>                End
57774>>>>
57774>>>                Else If (Trim(sNomisma)='') Begin
57777>>>                    send stop_box '-åí ??åôå åðéë?îåé =ïìé?ìá' ("error 1014 vwcmoves  "+'?ëçñï?ïñ-á')
57778>>>                    Procedure_Return
57779>>>                End
57779>>>>
57779>>>    
57779>>>    
57779>>>                Move Cmoves.Cmoves_Hmnia    to dHmnia
57780>>>                Move Cmoves.Cmoves_Axia     to nPoso
57781>>>    
57781>>>                Move 0 to iOneCflag
57782>>>                Move 0 to iMustSaveCmoves
57783>>>                Move 0 to iMustSaveClient
57784>>>                Move 0 to iMustSaveClientYpoloipa
57785>>>                Move 0 to iAnameneiSxetiko
57786>>>                Move 0 to imustsaveofeilh
57787>>>                Move 0 to iMaxDays
57788>>>    
57788>>>                Clear Cflagkin
57789>>>                Move sCtypkinRecr           to Cflagkin.Ctypkin_Recr
57790>>>                Find Gt Cflagkin By Index.5 // Cflagkin:Index.5:Ctypkin_Recr+Flag_Numeric+Cflagkin_Recr
57791>>>>
57791>>>                While ((Found=1) And (sCtypkinRecr=Cflagkin.Ctypkin_Recr))
57795>>>                    Move 1 to iOneCflag
57796>>>                    Move Cflagkin.Cflagkin_Flag to sFlag
57797>>>                    Move (Trim(sFlag)) to sFlag
57798>>>    
57798>>>                    Case Begin
57798>>>                        Case (sFlag='1')
57800>>>                            Move 1 to iMustSaveCmoves
57801>>>                        Case Break
57802>>>                        Case (sFlag='2') // Antistrofh Proshmou
57805>>>                            Move (nPoso*iSign*(-1)) to nPoso
57806>>>                        Case Break
57807>>>                        Case (sFlag='3') // Epireazei xreoseis
57810>>>                            Move (nPoso*iSign)  to nXre
57811>>>                            Move 0              to nPis
57812>>>                        Case Break
57813>>>                        Case (sFlag='4') // Epireazei pistoseis
57816>>>                            Move (nPoso*iSign)  to nPis
57817>>>                            Move 0              to nXre
57818>>>                        Case Break
57819>>>                        Case (sFlag='5') // Epireazei Hmeromhnies
57822>>>                            Move 1 to iMustSaveClient
57823>>>                            If (nXre<>0) Begin
57825>>>                                Move dHmnia to dLastXre
57826>>>                                Move dHmnia to dLastXreParast
57827>>>                                Move ''     to dLastPis
57828>>>                                Move ''     to dLastPisParast
57829>>>                            End
57829>>>>
57829>>>                            Else If (nPis<>0) Begin
57832>>>                                Move dHmnia to dLastPis
57833>>>                                Move dHmnia to dLastPisParast
57834>>>                                Move ''     to dLastXre
57835>>>                                Move ''     to dLastXreParast
57836>>>                            End
57836>>>>
57836>>>                        Case Break
57837>>>                        Case (sFlag='6') // Epireazei Hmeromhnia teleytaias paraggelias
57840>>>                        Case Break
57841>>>                        Case (sFlag='7') // Epireazei ekkremh axiografa
57844>>>                        Case Break
57845>>>                        Case (sFlag='8') // Epireazei Diamartyrhmena
57848>>>                        Case Break
57849>>>                        Case (sFlag='9') // Epireazei Tziro
57852>>>                        Case Break
57853>>>                        Case (sFlag='10') // Epireazei Apografh xreoshs
57856>>>                        Case Break
57857>>>                        Case (sFlag='11') // Epireazei Apografh Pistosh
57860>>>                        Case Break
57861>>>                        Case (sFlag='12') // Symmetoxh se MYF (Plythos)
57864>>>                            Move iSign to iMyf
57865>>>                        Case Break
57866>>>                        Case (sFlag='13') // Symmetoxh se MYF (Axia)
57869>>>                            Move (nPoso*iSign)  to nMyf
57870>>>                        Case Break
57871>>>                        Case (sFlag='14') // Axies se Xeno sma
57874>>>                            // Blepe sxetika erothmata sthn arxh ths procedure
57874>>>                        Case Break
57875>>>                        Case (sFlag='15') // Aytomath dhmiourgia axiografou
57878>>>                        Case Break
57879>>>                        Case (sFlag='16') // Allagh XreoPistoshs me antistrofh proshmou
57882>>>                            If (nXre<>0) Begin
57884>>>                                Move (nXre*(-1))    to nPis
57885>>>                                Move 0              to nXre
57886>>>                            End
57886>>>>
57886>>>                            Else If (nPis<>0) Begin
57889>>>                                Move (nPis*(-1))    to nXre
57890>>>                                Move 0              to nPis
57891>>>                            End
57891>>>>
57891>>>                        Case Break
57892>>>                        Case (sFlag='17') // Afairei apo Myf (akyrotika)
57895>>>                            // Thelei exhghsh ti shmainei 'afairei' ?
57895>>>                            // apo posothta? apo axia? apo allou?
57895>>>                        Case Break
57896>>>                        Case (sFlag='23') // Athroisths 1
57899>>>                            Move (nPoso*iSign) to nAthr1
57900>>>                        Case Break
57901>>>                        Case (sFlag='24') // Athroisths 2
57904>>>                            Move (nPoso*iSign) to nAthr2
57905>>>                        Case Break
57906>>>                        Case (sFlag='25') // Athroisths 3
57909>>>                            Move (nPoso*iSign) to nAthr3
57910>>>                        Case Break
57911>>>                        Case (sFlag='26') // Athroisths 4
57914>>>                            Move (nPoso*iSign) to nAthr4
57915>>>                        Case Break
57916>>>                        Case (sFlag='27') // Athroisths 5
57919>>>                            Move (nPoso*iSign) to nAthr5
57920>>>                        Case Break
57921>>>                        Case (sFlag='28') // Athroisths 6
57924>>>                            Move (nPoso*iSign) to nAthr6
57925>>>                        Case Break
57926>>>                        Case (sFlag='29') // Athroisths 7
57929>>>                            Move (nPoso*iSign) to nAthr7
57930>>>                        Case Break
57931>>>                        Case (sFlag='30') // Athroisths 8
57934>>>                            Move (nPoso*iSign) to nAthr8
57935>>>                        Case Break
57936>>>                        Case (sFlag='50') // Anamenei sxetika
57939>>>                            Move 1 to iAnameneiSxetiko
57940>>>                            Move Ctypkin.Max_Days_Sx_Par to iMaxDays
57941>>>                        Case Break
57942>>>                        Case (sFlag='66') // ephreazei synolikh ofeilh
57945>>>                            Move 1 to iMustSaveofeilh
57946>>>                        Case Break
57947>>>                        Case (sFlag='99') // Enhmeronei Ypoloipa
57950>>>                            Move 1 to iMustSaveClientYpoloipa
57951>>>                        Case Break
57952>>>    
57952>>>                    Case End
57952>>>    
57952>>>                    Find Gt Cflagkin By Index.5 // Cflagkin:Index.5:Ctypkin_Recr+Flag_Numeric+Cflagkin_Recr
57953>>>>
57953>>>                Loop
57954>>>>
57954>>>    
57954>>>                If ((iOneCflag) And (iMustSaveCmoves)) Begin
57956>>>                    If (nXre<>0) Begin
57958>>>                        Move nXre to Cmoves.Cmoves_Axia
57959>>>                        If (aiSign=1) Begin
57961>>>                            Add (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Code0,dHmnia,nIsotimia))  to Cmoves.Cmoves_x0
57962>>>                            Add (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Code00,dHmnia,nIsotimia)) to Cmoves.Cmoves_x00
57963>>>                            Add (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Coder,dHmnia,nIsotimia))  to Cmoves.Cmoves_x1
57964>>>                            Add nXre to Cmoves.Cmoves_x2
57965>>>                        End
57965>>>>
57965>>>                        Else Begin
57966>>>                            Sub (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Code0,dHmnia,nIsotimia))  From Cmoves.Cmoves_x0
57967>>>                            Sub (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Code00,dHmnia,nIsotimia)) From Cmoves.Cmoves_x00
57968>>>                            Sub (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Coder,dHmnia,nIsotimia))  From Cmoves.Cmoves_x1
57969>>>                            Sub nXre From Cmoves.Cmoves_x2
57970>>>                        End
57970>>>>
57970>>>                    End
57970>>>>
57970>>>                    Else If (nPis<>0) Begin
57973>>>                        Move nPis to Cmoves.Cmoves_Axia
57974>>>                        If (aiSign=1) Begin
57976>>>                            Add (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Code0,dHmnia,nIsotimia))  to Cmoves.Cmoves_p0
57977>>>                            Add (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Code00,dHmnia,nIsotimia)) to Cmoves.Cmoves_p00
57978>>>                            Add (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Coder,dHmnia,nIsotimia))  to Cmoves.Cmoves_p1
57979>>>                            Add nPis to Cmoves.Cmoves_p2
57980>>>                        End
57980>>>>
57980>>>                        Else Begin
57981>>>                            Sub (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Code0,dHmnia,nIsotimia))  From Cmoves.Cmoves_p0
57982>>>                            Sub (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Code00,dHmnia,nIsotimia)) From Cmoves.Cmoves_p00
57983>>>                            Sub (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Coder,dHmnia,nIsotimia))  From Cmoves.Cmoves_p1
57984>>>                            Sub nPis From Cmoves.Cmoves_p2
57985>>>                        End
57985>>>>
57985>>>                    End
57985>>>>
57985>>>                    Move (Trim(sModule)) to Cmoves.Module_From
57986>>>                    If (Trim(sClientRecr)<>'') Begin
57988>>>                        If (iMustSaveClientYpoloipa =1)  Move '1' to Cmoves.Enhm_Ypol_Pel
57991>>>                        If (iMustSaveClient         =1)  Move '1' to Cmoves.Enhm_Hmnies_Pel
57994>>>                        If (iMustSaveofeilh         =1)  Move '1' to Cmoves.Enhm_ofeilh
57997>>>                    End
57997>>>>
57997>>>                    Else Begin
57998>>>                             if (smodule='01') send stop_box '-åí ??åôå åðéë?îåé ?åëáôç'       ("error 1015 vwcmoves  "+'?ëçñï?ïñ-á')
58001>>>                        else if (smodule='02') send stop_box '-åí ??åôå åðéë?îåé ?ñïìçèåõô?'  ("error 1016 vwcmoves  "+'?ëçñï?ïñ-á')
58005>>>                        Procedure_Return
58006>>>                    End
58006>>>>
58006>>>                End
58006>>>>
58006>>>            End
58006>>>>
58006>>>        End_procedure
58007>>>    End_Object    // Cmoves_DD
58008>>>    
58008>>>    Object Btnordh_DD is a Btnordh_DataDictionary
58010>>>        Set DDO_Server to (Cn_DD(self))
58011>>>        Set Constrain_File to Cn.File_Number
58012>>>        Send DefineAllExtendedFields
58013>>>    End_Object    // Btnordh_DD
58014>>>    
58014>>>    Object Btnordd_DD is a Btnordd_DataDictionary
58016>>>        Set DDO_Server to (Btnordh_DD(self))
58017>>>        Set Constrain_File to Btnordh.File_Number
58018>>>    End_Object    // Btnordd_DD
58019>>>    
58019>>>    //////////////////////////////////////////////////////
58019>>>    // DataDictionary Structure needed for making Barticle
58019>>>    //////////////////////////////////////////////////////
58019>>>    
58019>>>    
58019>>>    //AB-StoreTopEnd
58019>>>
58019>>>    Set Label to "ƒž£ ¦¬¨šå˜ „šš¨˜­é¤ - ‚â­¬¨œª"
58020>>>    Set Size to 193 451
58021>>>    Set Location to 9 7
58022>>>
58022>>>    //AB-DDOStart
58022>>>
58022>>>
58022>>>    //AB-DDOEnd
58022>>>
58022>>>    Object frmFileName is a FormSub
58024>>>        Set Size to 13 321
58025>>>        Set Location to 6 63
58026>>>        Set Label_Col_Offset to 2
58027>>>        Set Label_Justification_Mode to jMode_Right
58028>>>        Set Prompt_Button_Mode to pb_PromptOn
58029>>>
58029>>>        //AB-StoreStart
58029>>>                                                                                            
58029>>>        Procedure Prompt
58031>>>            String  sFileName
58032>>>            Integer bOpen
58032>>>            Get Show_Dialog of oOpenFile To bOpen
58033>>>            If bOpen Begin
58035>>>                Get File_Name of oOpenFile to sFileName
58036>>>                If (Trim(sFileName)<>'') Set Value Item 0 to sFileName
58039>>>            End
58039>>>>
58039>>>        End_Procedure
58040>>>        
58040>>>        
58040>>>        //AB-StoreEnd
58040>>>
58040>>>    End_Object    // frmFileName
58041>>>
58041>>>    Object frmBranch is a FormSub
58043>>>        Set Size to 13 35
58044>>>        Set Location to 44 205
58045>>>        Set Label_Col_Offset to 2
58046>>>        Set Label_Justification_Mode to jMode_Right
58047>>>    End_Object    // frmBranch
58048>>>
58048>>>    Object ButtonSub1 is a ButtonSub
58050>>>
58050>>>        //AB-StoreTopStart
58050>>>        
58050>>>        //AB-StoreTopEnd
58050>>>
58050>>>        Set Label to "„§œ¥œ¨š˜©å˜"
58051>>>        Set Size to 14 218
58052>>>        Set Location to 157 114
58053>>>
58053>>>        //AB-StoreStart
58053>>>        
58053>>>        Procedure OnClick
58055>>>            String  sFile sFile2 sLabel sBr
58056>>>            Integer iFileExists iCheckAfm
58056>>>            Get label to slabel
58057>>>            Set Enabled_State to False
58058>>>        
58058>>>            Get Value Of frmBranch Item 0 to sBr
58059>>>            Move (Trim(sBr)) to sBr
58060>>>        
58060>>>            Move Sysfile.Check_Afm to iCheckAfm
58061>>>        
58061>>>            If (iCheckAFM) Begin
58063>>>                Reread Sysfile
58067>>>                Move 0 to Sysfile.Check_Afm
58068>>>                Saverecord Sysfile
58069>>>                Unlock
58070>>>>
58070>>>            End
58070>>>>
58070>>>        
58070>>>            // Mhdenismos tou ASCII kathe fora pou trexei
58070>>>            Direct_Output Channel 9 'C:\Titan_Kinhseis_Error.txt'
58072>>>            Close_Output Channel 9
58074>>>            //
58074>>>        
58074>>>            Get Value Of frmFileName item 0 to sFile
58075>>>            Move (Trim(UpperCase(sFile)))   to sFile
58076>>>            If (sFile<>'') Begin
58078>>>                Get Get_File_Exists sFile   To iFileExists
58079>>>                If (NOT(iFileExists)) Begin
58081>>>                    Send Stop_Box "ƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦." "‘­á¢£˜ 1001"
58082>>>                    Set Enabled_State to True
58083>>>                    Procedure_Return
58084>>>                End
58084>>>>
58084>>>        
58084>>>                     If (piWhat(Self)=0) Send Make_Payresp_Record   sFile
58087>>>                Else If (piWhat(Self)=1) Send Read_Pelates          sFile
58091>>>                Else If (piWhat(Self)=2) Send Read_Erga             sFile
58095>>>                Else If (piWhat(Self)=3) Send Read_Deop             sFile
58099>>>                Else If (piWhat(Self)=4) Begin
58102>>>                    If (sBr<>'') Send Read_Kinhseis         sFile sBr
58105>>>                    Else Begin
58106>>>                        Send Info_Box 'ƒœ¤ §¢ž¡«¨¦¢¦šã©˜«œ ¬§¦¡˜«á©«ž£˜' '¢ž¨¦­¦¨å˜'
58107>>>                        Procedure_Return
58108>>>                    End
58108>>>>
58108>>>                End
58108>>>>
58108>>>        
58108>>>                Send Info_Box "† ƒ ˜› ¡˜©å˜ «œ¢œåà©œ" "¢ž¨¦­¦¨å˜"
58109>>>            End
58109>>>>
58109>>>            Else Send Stop_Box 'ƒœ¤ §¨¦©› ¦¨å©˜«œ §¦¬ ™¨å©¡œ«œ «¦ ˜¨®œå¦' '‘­á¢£˜ 1002'
58111>>>        
58111>>>            If (iCheckAFM) Begin
58113>>>                Reread Sysfile
58117>>>                Move 1 to Sysfile.Check_Afm
58118>>>                Saverecord Sysfile
58119>>>                Unlock
58120>>>>
58120>>>            End
58120>>>>
58120>>>        
58120>>>            Set Label Of ButtonSub1 to sLabel
58121>>>            Set Enabled_State to True
58122>>>        End_Procedure // OnClick
58123>>>        
58123>>>        
58123>>>        Function Make_Payresp   String asArmodios       ;                                String asArmodiosAdd    ;                                String asArmodiosLoipa  ;                                String asAFM            ;                                String asDOY            ;                                String asPrespCode      ;                                Returns String
58125>>>            Integer isFound iLen
58126>>>            String  sID
58126>>>        
58126>>>            Move 0  to isFound
58127>>>            Move '' to sID
58128>>>        
58128>>>            Move (Trim(asArmodios     ))    to asArmodios
58129>>>            Move (Trim(asArmodiosAdd  ))    to asArmodiosAdd
58130>>>            Move (Trim(asArmodiosLoipa))    to asArmodiosLoipa
58131>>>            Move (Trim(asAFM          ))    to asAFM
58132>>>            Move (Trim(asDOY          ))    to asDOY
58133>>>            Move (Trim(asPrespCode    ))    to asPrespCode
58134>>>        
58134>>>            Move (Length(asArmodiosAdd))    to iLen
58135>>>        
58135>>>            // 1. Elegxos an yparxei bash kodikou
58135>>>            //    Teleytaio pedio arxeio Pelates.txt
58135>>>            //    21/12/2002
58135>>>            Clear Payresp
58136>>>            Move asPrespCode to Payresp.Presp_Codem
58137>>>            Find Ge Payresp By Index.8 // Presp_Codem+Presp_ID
58138>>>>
58138>>>            If ((Found=1) And (Payresp.Presp_Codem=asPrespCode)) ;                Function_Return Payresp.Presp_ID
58141>>>        
58141>>>            // 2. An den vrethei elegxos bash eponymias
58141>>>            Clear Payresp
58142>>>            Move asArmodios to Payresp.Presp_Name
58143>>>            Find Gt Payresp by Index.3 // Presp_Name+Presp_Recr
58144>>>>
58144>>>            While ((Found) And (Payresp.Presp_Name=asArmodios) And (isFound=0))
58148>>>                If ((Left(Payresp.Presp_Address,iLen))=asArmodiosAdd) Begin
58150>>>                    Move 1                  to isFound
58151>>>                    Move Payresp.Presp_ID   to sID
58152>>>                End
58152>>>>
58152>>>                Find Gt Payresp by Index.3 // Presp_Name+Presp_Recr
58153>>>>
58153>>>            Loop
58154>>>>
58154>>>        
58154>>>            If (isFound) Function_Return sID
58157>>>        
58157>>>            // Make the new record
58157>>>            Clear Payresp
58158>>>            Move (Sysrecc.Payresp_Rec0+1)   to Payresp.Presp_Rec0
58159>>>            Move (Sysrecc.Payresp_Rec0+1)   to Sysrecc.Payresp_Rec0
58160>>>            Saverecord Sysrecc
58161>>>            Move (Append('',((Trim(SysCurXR.Branch_Site))+;                             (Trim(String(payresp.presp_Rec0))))));                                            to payresp.presp_Recr
58162>>>        
58162>>>            Get fsgCode_With_Zeroes Payresp.Presp_Rec0      ;                                    Sysfile.Client_Digits   ;                                    SysCurXr.Company_Code   ;                                    SysCurXr.Branch_Code    ;                                            to Payresp.Presp_ID
58163>>>        
58163>>>            Move Payresp.Presp_ID           to sID
58164>>>        
58164>>>            Clear Year
58165>>>            Move Syscurxr.Branch_Code       to Year.Branch_Code
58166>>>            Move Syscurxr.Company_Code      to Year.Company_Code
58167>>>            Move Syscurxr.Year_Year         to Year.Year_Year
58168>>>            Find Eq Year By Index.1
58169>>>>
58169>>>            If (Found=1) Begin
58171>>>                Move Year.Payresp_Plafon    to Payresp.Plafon
58172>>>                Move Year.Payresp_Ofeilh    to Payresp.Orio_Syn_Ofeilh
58173>>>            End
58173>>>>
58173>>>        
58173>>>            Move SysCurXr.Company_Code      to Payresp.Company_Code
58174>>>            Move SysCurXr.Branch_Code       to Payresp.Branch_Code
58175>>>            Move SysCurXr.Year_Year         to Payresp.Year_Year
58176>>>            Move Syscurxr.Beto_Site         to Payresp.Presp_Sitew
58177>>>            Move Payresp.Presp_Rec0         to Payresp.Presp_Sn
58178>>>            Move Payresp.Presp_Id           to Payresp.Presp_Repm
58179>>>            Move '1'                        to Payresp.Presp_Active
58180>>>        
58180>>>            Move asArmodios                 to Payresp.Presp_Name
58181>>>            Move asArmodiosAdd              to Payresp.Presp_Address
58182>>>            Move asArmodiosLoipa            to Payresp.Presp_Phone
58183>>>            Move asAFM                      to Payresp.Presp_AFM
58184>>>            //Move asDOY                      to Payresp.Presp_DOY
58184>>>            Move asPrespCode                to Payresp.Presp_Codem
58185>>>        
58185>>>            Saverecord Payresp
58186>>>            Function_Return sID
58187>>>        End_Function // Make_Payresp
58188>>>        
58188>>>        Procedure Make_Payresp_Record String asFile
58190>>>            String  sLine sPrespcode  sPrespName sID
58191>>>            Integer iInt1
58191>>>            Direct_Input Channel 1 asFile
58193>>>        
58193>>>            Readln Channel 1 sLine
58195>>>        
58195>>>            While (Not(Seqeof))
58199>>>                Move (Mid(sLine,06, 01  ))  to sPrespCode
58200>>>                Move (Mid(sLine,25, 12  ))  to sPrespName
58201>>>        
58201>>>                Move (Trim(sPrespCode))     to sPrespCode
58202>>>                Move (Trim(sPrespName))     to sPrespName
58203>>>        
58203>>>                Add 1                       to iInt1
58204>>>                Set Label Of ButtonSub1     to (String(iInt1))
58205>>>        
58205>>>                If (sPrespName='') Goto Read_Presp_Next
58208>>>        
58208>>>                Clear Payresp
58209>>>                Move sPrespCode to Payresp.Presp_Codem
58210>>>                Find Ge Payresp By Index.8 // Presp_Codem+Presp_ID
58211>>>>
58211>>>                If ((Found=1) And (Payresp.Presp_Codem=sPrespCode)) Goto Read_Presp_Next
58214>>>        
58214>>>                // Make the new record
58214>>>                Clear Payresp
58215>>>                Move sPrespCode to Payresp.Presp_Codem
58216>>>                Move sPrespName to Payresp.Presp_Name
58217>>>        
58217>>>                Move (Sysrecc.Payresp_Rec0+1)   to Payresp.Presp_Rec0
58218>>>                Move (Sysrecc.Payresp_Rec0+1)   to Sysrecc.Payresp_Rec0
58219>>>                Saverecord Sysrecc
58220>>>                Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                (Trim(String(payresp.presp_Rec0))))));                                                to payresp.presp_Recr
58221>>>        
58221>>>                Get fsgCode_With_Zeroes Payresp.Presp_Rec0      ;                                        Sysfile.Client_Digits   ;                                        SysCurXr.Company_Code   ;                                        SysCurXr.Branch_Code    ;                                                to Payresp.Presp_ID
58222>>>        
58222>>>                Move Payresp.Presp_ID           to sID
58223>>>        
58223>>>                Clear Year
58224>>>                Move Syscurxr.Branch_Code       to Year.Branch_Code
58225>>>                Move Syscurxr.Company_Code      to Year.Company_Code
58226>>>                Move Syscurxr.Year_Year         to Year.Year_Year
58227>>>                Find Eq Year By Index.1
58228>>>>
58228>>>                If (Found=1) Begin
58230>>>                    Move Year.Payresp_Plafon    to Payresp.Plafon
58231>>>                    Move Year.Payresp_Ofeilh    to Payresp.Orio_Syn_Ofeilh
58232>>>                End
58232>>>>
58232>>>        
58232>>>                Move SysCurXr.Company_Code      to Payresp.Company_Code
58233>>>                Move SysCurXr.Branch_Code       to Payresp.Branch_Code
58234>>>                Move SysCurXr.Year_Year         to Payresp.Year_Year
58235>>>                Move Syscurxr.Beto_Site         to Payresp.Presp_Sitew
58236>>>                Move Payresp.Presp_Rec0         to Payresp.Presp_Sn
58237>>>                Move Payresp.Presp_Id           to Payresp.Presp_Repm
58238>>>                Move '1'                        to Payresp.Presp_Active
58239>>>        
58239>>>                Saverecord Payresp
58240>>>        
58240>>>                Read_Presp_Next:
58240>>>                Readln Channel 1 sLine
58242>>>            Loop
58243>>>>
58243>>>            Set Label Of ButtonSub1 to ''
58244>>>            Close_output Channel 1
58246>>>        End_Procedure
58247>>>        
58247>>>        
58247>>>        Procedure Read_Deop String asFile
58249>>>        
58249>>>            Set_Argument_Size 1024
58250>>>>
58250>>>            // €¤œ¥á¨«ž«œª ‹œ«˜™¢ž«âª
58250>>>            String  sLine sToAnsi sClientID
58251>>>            Integer iLathos iInt1
58251>>>            //String  sVorderbt sVitem sDeopDate sVclientid svcncode svitem sarxhdate
58251>>>        
58251>>>            /////////////////////////
58251>>>        
58251>>>            // ‹œ«˜™¢ž«âª §œ›åà¤
58251>>>            Local String  sDeop sKodPel sKodErgo sEidos
58251>>>            Local String  sOroiPlhromhs sSxolia sSynPlyn sCNCode sSN
58251>>>            Number  nM3 nTimhM3 iElleiph  iPagioAntlias
58251>>>            Integer iHmeresApoTim iZonh itropoi
58251>>>            Date    dHmniaEkdoshs dEnarxh dLhxh
58251>>>        
58251>>>            Move 0 to iInt1
58252>>>        
58252>>>            Append_Output Channel 9 'C:\Titan_Kinhseis_Error.txt'
58254>>>        
58254>>>            Direct_Input Channel 1 asFile
58256>>>            Readln Channel 1 sLine
58258>>>            While (Not(Seqeof))
58262>>>        
58262>>>                Move (Mid(sLine,10, 01  ))  to sDeop
58263>>>                Move (Mid(sLine,05, 11  ))  to sKodPel
58264>>>                Move (Mid(sLine,05, 16  ))  to sKodErgo
58265>>>                Move (Mid(sLine,08, 21  ))  to sEidos
58266>>>                Move (Mid(sLine,08, 29  ))  to nM3
58267>>>                Move (Mid(sLine,10, 37  ))  to nTimhM3
58268>>>                Move (Mid(sLine,02, 47  ))  to iHmeresApoTim
58269>>>                Move (Mid(sLine,03, 49  ))  to sOroiPlhromhs
58270>>>                Move (Mid(sLine,08, 52  ))  to dHmniaEkdoshs
58271>>>                Move (Mid(sLine,08, 60  ))  to dEnarxh
58272>>>                //Move (Mid(sLine,08, 68  ))  to dLhxh
58272>>>        
58272>>>                // Tolis 14/04/2003
58272>>>                Move '31/12/2002'           to dLhxh
58273>>>                //
58273>>>        
58273>>>                Move (Mid(sLine,02, 76  ))  to iZonh
58274>>>                Move (Mid(sLine,06, 78  ))  to iElleiph
58275>>>                Move (Mid(sLine,06, 84  ))  to iPagioAntlias
58276>>>                Move (Mid(sLine,04, 90  ))  to sSynPlyn
58277>>>                Move (Mid(sLine,63, 94  ))  to sSxolia
58278>>>        
58278>>>                Move (Trim(sKodPel      ))  to sKodPel
58279>>>                Move (Trim(sKodErgo     ))  to sKodErgo
58280>>>                Move (Trim(sDeop        ))  to sDeop
58281>>>                Move (Trim(sEidos       ))  to sEidos
58282>>>                Move (Trim(sOroiPlhromhs))  to sOroiPlhromhs
58283>>>                Move (Trim(sSxolia      ))  to sSxolia
58284>>>        
58284>>>                Add 1 to iInt1
58285>>>                Set Label Of ButtonSub1 to (String(iInt1))
58286>>>                if (dlhxh<'01/01/2000') goto read_deop_next
58289>>>        
58289>>>        
58289>>>                Send Clear to CN_DD
58290>>>                Move (Trim(sKodPel+sKodErgo)) to CN.CN_CodeMatch  // 1151700001
58291>>>                Send Find to CN_DD GE 8 // CN_CodeMatch+CN_Code
58292>>>                If (NOT((Found) And (CN.CN_CodeMatch=Trim(sKodPel+sKodErgo)))) Begin
58294>>>                    Writeln Channel 9 'ƒ„Ž     - Record #' (String(iInt1)) '    CN.CN_CODEMATCH=' (Trim(sKodPel+sKodErgo))
58300>>>                    Goto Read_Deop_Next
58301>>>>
58301>>>                End
58301>>>>
58301>>>        
58301>>>                Get fsgCode_With_Zeroes Cn.Cn_SN                ;                                        Sysfile.Client_Digits   ;                                        SysCurXr.Company_Code   ;                                        SysCurXr.Branch_Code    ;                                                    to sSN
58302>>>                Get fsgStripCodeFromID sSN to sSN
58303>>>                Move (Trim(sKodPel)+(Trim(sSN)))    to sCNCode
58304>>>        
58304>>>        
58304>>>                Begin_Transaction
58305>>>                    Lock
58306>>>>
58306>>>        
58306>>>                    Clear btnordh
58307>>>                    Move (Trim(sCNCode)) to btnordh.AA_Deop
58308>>>                    Find Ge Btnordh by index.1
58309>>>>
58309>>>        
58309>>>                    If ((Found=1) And (Left(btnordh.AA_Deop,10)=(Trim(sCNCode)))) Begin
58311>>>                        Send Find_By_Recnum to Btnordh_DD Btnordh.File_Number Btnordh.Recnum
58312>>>                    End
58312>>>>
58312>>>                    Else Begin
58313>>>                        Send Clear to btnordh_DD
58314>>>                        Set Field_Changed_Value Of Btnordh_DD Field Btnordh.AA_Deop     to sDeop
58315>>>                        Set Field_Changed_Value Of Btnordh_DD Field Btnordh.Sxolia      to sSxolia
58316>>>                        Set Field_Changed_Value Of Btnordh_DD Field Btnordh.Deop_Date   to dEnarxh
58317>>>                        Set Field_Changed_Value Of Btnordh_DD Field Btnordh.Eleiph      to iElleiph
58318>>>                        Set Field_Changed_Value Of Btnordh_DD Field Btnordh.Date_Create to dHmniaEkdoshs
58319>>>                        Set Field_Changed_Value Of Btnordh_DD Field Btnordh.Deop_Lhxh   to dLhxh
58320>>>                        Send Request_Save to Btnordh_DD
58321>>>                    End
58321>>>>
58321>>>        
58321>>>                    Send Clear to btnordd_DD
58322>>>                    Set Field_Changed_Value Of btnordd_DD Field btnordd.Vitem       to sEidos
58323>>>                    Set Field_Changed_Value Of btnordd_DD Field btnordd.VQty        to nM3
58324>>>                    Set Field_Changed_Value Of btnordd_DD Field btnordd.VUnitPrice  to nTimhM3
58325>>>                    Set field_changed_value of btnordd_dd field btnordd.vpagiaxrm3  to iPagioAntlias
58326>>>                     If (Trim(sSynPlyn)='ŽŠ€') ;                        Set Field_Changed_Value Of Btnordh_DD Field Btnordh.VELXR   to '2'
58329>>>                    Else If (Trim(sSynPlyn)='€Œ„“') ;                        Set Field_Changed_Value Of Btnordh_DD Field Btnordh.VELXR   to '0'
58333>>>                    Else If (Trim(sSynPlyn)='Š†Œ') ;                        Set Field_Changed_Value Of Btnordh_DD Field Btnordh.VELXR   to '1'
58337>>>        
58337>>>                    Send Request_Save to Btnordd_DD
58338>>>        
58338>>>                    Send Request_Save to Btnordh_DD
58339>>>        
58339>>>                         If (Trim(sOroiPlhromhs)='001') Move 99 to iTropoi
58342>>>                    Else If (Trim(sOroiPlhromhs)='002') Move  1 to iTropoi
58346>>>                    Else If (Trim(sOroiPlhromhs)='003') Move  1 to iTropoi
58350>>>                    Else If (Trim(sOroiPlhromhs)='004') Move  1 to iTropoi
58354>>>                    Else If (Trim(sOroiPlhromhs)='005') Move  1 to iTropoi
58358>>>                    Else If (Trim(sOroiPlhromhs)='006') Move  2 to iTropoi
58362>>>                    Else If (Trim(sOroiPlhromhs)='007') Move  2 to iTropoi
58366>>>                    Else If (Trim(sOroiPlhromhs)='008') Move  2 to iTropoi
58370>>>                    Else If (Trim(sOroiPlhromhs)='009') Move  2 to iTropoi
58374>>>                    Else If (Trim(sOroiPlhromhs)='010') Move 99 to iTropoi
58378>>>                    Else If (Trim(sOroiPlhromhs)='011') Move  1 to iTropoi
58382>>>                    Else If (Trim(sOroiPlhromhs)='012') Move  1 to iTropoi
58386>>>                    Else If (Trim(sOroiPlhromhs)='045') Move  1 to iTropoi
58390>>>        
58390>>>                    Clear Tperga
58391>>>                    Move 100        to Tperga.Pct_Epi_Synolou
58392>>>                    Move iTropoi    to Tperga.Baxiokat_Code
58393>>>                    Move CN.Cn_Code to Tperga.Cn_Code
58394>>>                    Find Eq Tperga by index.1
58395>>>>
58395>>>        
58395>>>                    If (Not(Found)) Begin
58397>>>                        Send Clear to TPErga_DD
58398>>>                        Move itropoi to Baxiokat.Baxiokat_Code
58399>>>                        Send Request_Find to Baxiokat_DD Eq Baxiokat.File_Number 1
58400>>>                        Set Field_Changed_Value Of TPErga_DD Field Tperga.Pct_Epi_Synolou   to 100
58401>>>                        Set Field_Changed_Value Of TPErga_DD Field Tperga.Paralabh_Meres    to  10
58402>>>                        Set Field_Changed_Value Of TPErga_DD Field Tperga.Xarhtos_Meres     to  10
58403>>>                        Set Field_Changed_Value Of TPErga_DD Field Tperga.Plhroteo_Meres    to  30
58404>>>                        Send Request_Save to Tperga_DD
58405>>>                    End
58405>>>>
58405>>>                End_Transaction
58406>>>        
58406>>>                Read_Deop_Next:
58406>>>                Unlock
58407>>>>
58407>>>        
58407>>>                Readln Channel 1 sLine
58409>>>            Loop
58410>>>>
58410>>>            Set Label Of ButtonSub1 to ''
58411>>>            Close_Output Channel 9
58413>>>        End_Procedure // Read_Deop
58414>>>        
58414>>>        
58414>>>        Procedure Read_Pelates String asFile
58416>>>            // €¤œ¥á¨«ž«œª ‹œ«˜™¢ž«âª
58416>>>            String  sLine sClientID
58417>>>            Integer iLathos iNum iInt1 iInt2
58417>>>            /////////////////////////
58417>>>        
58417>>>            // ‹œ«˜™¢ž«âª §œ›åà¤
58417>>>            Local String  sKodPel sPelName sAfm sPresp
58417>>>            Local String  sStoixeia  sArmodios sArmodiosAdd sArmodiosLoipa
58417>>>            String  sDOY sPrespID
58417>>>            Integer iXondr iStatus iLastClient
58417>>>            Number  nOrioAnoixto nAnoixto nOrioYpol nYpol
58417>>>            Date    dCreation
58417>>>        
58417>>>            Move 0 to iInt1
58418>>>            Move 0 to iInt2
58419>>>        
58419>>>            /////////////////////////
58419>>>        
58419>>>            Direct_Input Channel 1 asFile
58421>>>            Readln Channel 1 sLine
58423>>>            While (Not(Seqeof))
58427>>>        
58427>>>                Move (Mid(sLine,05, 01))    to sKodPel
58428>>>                Move (Mid(sLine,25, 06))    to sPelName
58429>>>                Move (Mid(sLine,09, 31))    to sAFM
58430>>>                Move (Mid(sLine,01, 40))    to iXondr
58431>>>                Move (Mid(sLine,60, 41))    to sStoixeia
58432>>>                Move (Mid(sLine,25,101))    to sArmodios
58433>>>                Move (Mid(sLine,25,126))    to sArmodiosAdd
58434>>>                Move (Mid(sLine,25,151))    to sArmodiosLoipa
58435>>>                Move (Mid(sLine,08,176))    to dCreation
58436>>>                Move (Mid(sLine,26,184))    to sDOY
58437>>>                Move (Mid(sLine,01,210))    to iStatus
58438>>>                Move (Mid(sLine,10,211))    to nOrioAnoixto
58439>>>                Move (Mid(sLine,10,221))    to nAnoixto
58440>>>                Move (Mid(sLine,10,231))    to nOrioYpol
58441>>>                Move (Mid(sLine,10,241))    to nYpol
58442>>>                Move (Mid(sLine,06,251))    to sPresp
58443>>>        
58443>>>                Move (Trim(sKodPel))        to sKodPel
58444>>>                Move (Trim(sPelName))       to sPelName
58445>>>                Move (Trim(sAFM))           to sAFM
58446>>>                Move (Trim(sStoixeia))      to sStoixeia
58447>>>                Move (Trim(sArmodios))      to sArmodios
58448>>>                Move (Trim(sArmodiosAdd))   to sArmodiosAdd
58449>>>                Move (Trim(sArmodiosLoipa)) to sArmodiosLoipa
58450>>>                Move (Trim(sDOY))           to sDOY
58451>>>                Move (Trim(sPresp))         to sPresp
58452>>>        
58452>>>        
58452>>>                Add 1 to iInt1
58453>>>                Set Label Of ButtonSub1 to (String(iInt1))
58454>>>        
58454>>>        
58454>>>                Clear Clients
58455>>>                move '' to sclientid
58456>>>                append sclientid ((trim(SysCurXr.Company_Code))+'.'+(trim(SysCurXr.Branch_Code))+'.'+(trim(skodpel)))
58457>>>                Move sClientID                  to Clients.Client_Id
58458>>>                Find Eq Clients By Index.6 // Client_ID
58459>>>>
58459>>>                If (Found) Goto Read_Pel_Next
58462>>>        
58462>>>                Clear Clients
58463>>>                Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                 (Trim(sKodPel))))) to Clients.Client_Recr
58464>>>                Find Eq Clients by index.2
58465>>>>
58465>>>                If (Found) Goto Read_Pel_Next
58468>>>        
58468>>>        
58468>>>                If (sPelName='') Begin
58470>>>                    Writeln Channel 9 'œ¢á«œª     - Record #' (String(iInt1)) '    Client without name  iID=' sKodPel
58476>>>                    Goto Read_Pel_Next
58477>>>>
58477>>>                End
58477>>>>
58477>>>        
58477>>>                Clear Clients
58478>>>                //‚ á «ž¤ §œ¨å§«à©ž §¦¬ ¬§á¨®œ  string ©«¦¤ ¡à› ¡æ §¦¬ › ˜™á¦¬£œ
58478>>>                reread sysrecc
58482>>>                move (sysrecc.client_rec0+1)    to sysrecc.client_rec0
58483>>>                saverecord sysrecc
58484>>>                unlock
58485>>>>
58485>>>                //
58485>>>                Move sysrecc.client_rec0          to Clients.Client_Rec0
58486>>>              //  Move sKodPel                    to Clients.Client_Rec0
58486>>>                Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                 (Trim(String(Clients.Client_Rec0))))));                                                to Clients.Client_Recr
58487>>>        
58487>>>                Move SysCurXR.Company_Code      to Clients.Company_Code
58488>>>                Move SysCurXR.Branch_Code       to Clients.Branch_Code
58489>>>                Move SysCurXR.Year_Year         to Clients.Year_Year
58490>>>        
58490>>>                Move '1'                        to Clients.Client_Active
58491>>>        
58491>>>                // To iStatus exei times 0=Closed 1=Open ara antistrefoume.
58491>>>                Move (1-iStatus)                to Clients.Client_Locked
58492>>>        
58492>>>                Get Make_Payresp sArmodios sArmodiosAdd sArmodiosLoipa sAFM sDOY sPresp ;                                                to sPrespID
58493>>>        
58493>>>                Move sClientID                  to Clients.Client_ID
58494>>>                Move sPelName                   to Clients.Client_Name
58495>>>                Move sAFM                       to Clients.Client_AFM
58496>>>                Move sStoixeia                  to Clients.Client_Address
58497>>>                Move sPrespID                   to Clients.Presp_ID
58498>>>                Move dCreation                  to Clients.Client_Hmnia
58499>>>                Move sDOY                       to Clients.Client_DOYBTM
58500>>>                //betolink
58500>>>                Move SysCurXR.Beto_Site         to Clients.Client_Sitew
58501>>>                Move Clients.Client_Rec0        to Clients.Client_Sn
58502>>>                Move Clients.Client_id          to Clients.Client_Repm
58503>>>                Move Clients.Company_Code       to Clients.CLIENT_COMPANY
58504>>>                Move Clients.Client_id          to Clients.Client_RepMatch
58505>>>        
58505>>>                Move '1'                        to Clients.is_Client
58506>>>        
58506>>>                // Na Dieykrinistei ti paei pou ??????????????????????????????
58506>>>                //Move nOrioAnoixto               to Clients.Plafon
58506>>>                //Move nAnoixto                   to Clients.Orio_Syn_Ofeilh
58506>>>                //Move nOrioYpol                  to Clients.Orio_Syn_Ofeilh
58506>>>                //Move nOrio                      to Clients.Orio_Syn_Ofeilh
58506>>>                // Na Dieykrinistei ti paei pou ??????????????????????????????
58506>>>        
58506>>>                Move (Clients.Xreosh-Clients.Pistosh)   ;                                                to Clients.Ypoloipo
58507>>>                Move (Clients.Plafon-Clients.Ypoloipo)  ;                                                to Clients.Overhead
58508>>>                Saverecord Clients
58509>>>        
58509>>>                Read_Pel_Next:
58509>>>        
58509>>>                Readln Channel 1 sLine
58511>>>            Loop
58512>>>>
58512>>>        
58512>>>        
58512>>>            Clear Clients
58513>>>            Move '99.ZZ' to Clients.Client_Id
58514>>>            Find LE Clients by index.6 // Client_ID
58515>>>>
58515>>>            If (Found) Begin
58517>>>                Get fsgStripCodeFromID Clients.Client_Id to iNum
58518>>>                Reread
58519>>>                Move iNum to Sysrecc.Client_Rec0
58520>>>                Saverecord Sysrecc
58521>>>                Unlock
58522>>>>
58522>>>            End
58522>>>>
58522>>>        
58522>>>            Set Label Of ButtonSub1 to ''
58523>>>        
58523>>>        End_Procedure // Read_Pelates
58524>>>        
58524>>>        
58524>>>        Procedure Read_Erga String asFile
58526>>>            // €¤œ¥á¨«ž«œª ‹œ«˜™¢ž«âª
58526>>>            String  sLine sMatch sClientID
58527>>>            Integer iLathos iInt1
58527>>>            /////////////////////////
58527>>>        
58527>>>            // ‹œ«˜™¢ž«âª §œ›åà¤
58527>>>            Local String  sKodPel sKodErgo sAdd1 sAdd2 sAdd3
58527>>>            Local String  sZonh sExpress sBarel sPlate  sMonada sTomeas
58527>>>            Local String  sZonhDescr sDeop1 sDeop2 sDescr
58527>>>            Number       nAxiaTim
58527>>>            Date    dLastDap dStart dEnd
58527>>>        
58527>>>            /////////////////////////
58527>>>        
58527>>>            Move 0 to iInt1
58528>>>        
58528>>>            Append_Output Channel 9 'C:\Titan_Kinhseis_Error.txt'
58530>>>        
58530>>>            Direct_Input Channel 1 asFile
58532>>>            Readln Channel 1 sLine
58534>>>            While (Not(Seqeof))
58538>>>        
58538>>>                Move (Mid(sLine,05, 01)) to sKodPel
58539>>>                Move (Mid(sLine,05, 06)) to sKodErgo
58540>>>                Move (Mid(sLine,30, 11)) to sAdd1
58541>>>                Move (Mid(sLine,30, 41)) to sAdd2
58542>>>                Move (Mid(sLine,30, 71)) to sAdd3
58543>>>                Move (Mid(sLine,08,101)) to dLastDap
58544>>>                Move (Mid(sLine,02,109)) to sZonh
58545>>>                Move (Mid(sLine,08,111)) to sExpress
58546>>>                Move (Mid(sLine,05,119)) to sBarel
58547>>>                Move (Mid(sLine,10,124)) to sPlate
58548>>>                Move (Mid(sLine,02,134)) to sMonada
58549>>>                Move (Mid(sLine,02,136)) to sTomeas
58550>>>                Move (Mid(sLine,12,138)) to nAxiaTim
58551>>>                Move (Mid(sLine,25,150)) to sZonhDescr
58552>>>                Move (Mid(sLine,30,175)) to sDeop1
58553>>>                Move (Mid(sLine,30,205)) to sDeop2
58554>>>                Move (Mid(sLine,08,235)) to dStart
58555>>>                Move (Mid(sLine,08,243)) to dEnd
58556>>>        
58556>>>                Move (Trim(sKodPel     )) to sKodPel
58557>>>                Move (Trim(sKodErgo    )) to sKodErgo
58558>>>                Move (Trim(sAdd1       )) to sAdd1
58559>>>                Move (Trim(sAdd2       )) to sAdd2
58560>>>                Move (Trim(sAdd3       )) to sAdd3
58561>>>                Move (Trim(sDeop1      )) to sDeop1
58562>>>                Move (Trim(sDeop2      )) to sDeop2
58563>>>                Move (Trim(sZonh       )) to sZonh
58564>>>                Move (Trim(sMonada     )) to sMonada
58565>>>                Move (Trim(sTomeas     )) to sTomeas
58566>>>        
58566>>>                Add 1 to iInt1
58567>>>                Set Label Of ButtonSub1 to (String(iInt1))
58568>>>        
58568>>>                Clear CN
58569>>>                Move (Trim(sKodPel+sKodErgo)) to CN.CN_CodeMatch
58570>>>                Find GE CN By Index.8 // CN_CodeMatch+CN_Code
58571>>>>
58571>>>                If ((Found) And (CN.CN_CodeMatch=Trim(sKodPel+sKodErgo))) ;                    Goto Read_Erg_Next
58574>>>        
58574>>>        
58574>>>                Clear CN
58575>>>        
58575>>>                Lock
58576>>>>
58576>>>        
58576>>>                Move (Sysrecc.CN_Rec0+1)   to CN.CN_Rec0
58577>>>                Move (Sysrecc.CN_Rec0+1)   to Sysrecc.CN_Rec0
58578>>>                Saverecord Sysrecc
58579>>>        
58579>>>                Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                (Trim(String(Sysrecc.CN_Rec0)))))) to CN.CN_Recr
58580>>>        
58580>>>                Get fsgCode_With_Zeroes Sysrecc.CN_Rec0         ;                                        5                       ;                                        SysCurXr.Company_Code   ;                                        SysCurXr.Branch_Code    ;                                                to CN.CN_Code
58581>>>        
58581>>>                Move SysCurXR.Company_Code      to CN.Company_Code
58582>>>                Move SysCurXR.Branch_Code       to CN.Branch_Code
58583>>>                Move SysCurXR.Year_Year         to CN.Year_Year
58584>>>                Move SysCurXR.Beto_Site         to CN.Cn_SiteW
58585>>>                Move 'A'                        to CN.CN_Active
58586>>>        
58586>>>                // Vres thn eggrafh tou client
58586>>>                Clear Clients
58587>>>                move '' to sclientid
58588>>>                append sclientid ((trim(SysCurXr.Company_Code))+'.'+(trim(SysCurXr.Branch_Code))+'.'+(trim(skodpel)))
58589>>>                Move sClientID                  to Clients.Client_Id
58590>>>        
58590>>>        ///        Get fsgCode_With_Zeroes sKodPel                 ;
58590>>>        //                                5                       ;
58590>>>        //                                SysCurXr.Company_Code   ;
58590>>>        //                                SysCurXr.Branch_Code    ;
58590>>>        //                                        to sClientID
58590>>>        //        Move sClientID                  to Clients.Client_Id
58590>>>                Find Eq Clients By Index.6 // Client_ID
58591>>>>
58591>>>        
58591>>>                If (Not(Found)) Begin
58593>>>                    Writeln Channel 9 '„¨š˜     - Record #' (String(iInt1)) '    Client  not found iID=' (Trim(sClientID))
58599>>>                    Goto Read_Erg_Next
58600>>>>
58600>>>                End
58600>>>>
58600>>>        
58600>>>                Move '' to sDescr
58601>>>                Append sDescr (Trim(Clients.Client_Name)) ' (' ;                       (Trim(sAdd1)) ' ' (Trim(sAdd2)) ' ' (Trim(sAdd3))  ')'
58609>>>        
58609>>>                Move (Trim(sDescr))             to Cn.Cn_Descr
58610>>>        
58610>>>                Move sClientID                  to Cn.Client_id
58611>>>                Move Clients.Presp_ID           to Cn.Cn_Presp_ID
58612>>>                Move Clients.Client_Recr        to Cn.Client_Recr
58613>>>                Move Cn.Cn_Rec0                 to CN.Cn_SN
58614>>>                Move Cn.Client_id               to Cn.Cn_clientid
58615>>>        
58615>>>                Move Cn.cn_code                 to CN.CN_RepMatch
58616>>>                Move (Trim(sKodPel+sKodErgo))   to CN.CN_CodeMatch
58617>>>        
58617>>>                Move Cn.Cn_Code                 to Cn.Constraction_ID
58618>>>        
58618>>>                Saverecord CN
58619>>>        
58619>>>                Read_Erg_Next:
58619>>>                Unlock
58620>>>>
58620>>>                Readln Channel 1 sLine
58622>>>            Loop
58623>>>>
58623>>>        
58623>>>            Set Label Of ButtonSub1 to ''
58624>>>        
58624>>>            Close_Output Channel 9
58626>>>        
58626>>>        End_Procedure // Read_Erga
58627>>>        
58627>>>        
58627>>>        Procedure Read_Kinhseis String asFile String asBr
58629>>>            // €¤œ¥á¨«ž«œª ‹œ«˜™¢ž«âª
58629>>>            String  sLine   sClientID sRecr   sError
58630>>>            Integer iLathos iBtypkin  iInt1   iBaxioKat iCmvRec
58630>>>            Integer iError_Object_ID  iRecnum iErr rVal
58630>>>            /////////////////////////
58630>>>        
58630>>>            // ‹œ«˜™¢ž«âª §œ›åà¤
58630>>>            Local String  sKinhsh sArPar sEidAxio sUnused sHmnia sKodPel sKodErg sCN
58630>>>            Integer iKodMon iXondr iKodKin1 iKodKin2 iCtypkin
58630>>>            Number  nAxia
58630>>>            Date    dHmParast dHmAxio
58630>>>            /////////////////////////
58630>>>        
58630>>>            Move 0 to iInt1
58631>>>        
58631>>>            Append_Output Channel 9 'C:\Titan_Kinhseis_Error.txt'
58633>>>        
58633>>>            Set piLathos to 0
58634>>>        
58634>>>            Move '04' to gs_Module_Code
58635>>>        
58635>>>            Direct_Input Channel 1 asFile
58637>>>            Readln Channel 1 sLine
58639>>>            While (Not(Seqeof))
58643>>>                Move (Mid(sLine,30,01)) to sKinhsh
58644>>>                Move (Mid(sLine,10,31)) to sArPar
58645>>>                Move (Mid(sLine,05,41)) to sKodPel
58646>>>                Move (Mid(sLine,05,46)) to sKodErg
58647>>>                Move (Mid(sLine,02,51)) to iKodMon
58648>>>                Move (Mid(sLine,01,53)) to iXondr
58649>>>                Move (Mid(sLine,08,54)) to dHmParast
58650>>>                Move (Mid(sLine,10,62)) to sEidAxio
58651>>>                Move (Mid(sLine,08,72)) to dHmAxio
58652>>>                Move (Mid(sLine,12,80)) to nAxia
58653>>>                Move (Mid(sLine,02,92)) to iKodKin1
58654>>>                Move (Mid(sLine,02,94)) to iKodKin2
58655>>>        
58655>>>                Add 1 to iInt1
58656>>>                Set Label Of ButtonSub1 to (String(iInt1))
58657>>>        
58657>>>        
58657>>>                BEGIN_TRANSACTION
58658>>>                move Error_Object_ID to iError_Object_ID
58659>>>        
58659>>>        
58659>>>                Send Clear to Ctypkin_DD
58660>>>                Send Clear to Areas_DD
58661>>>                Send Clear to Btypkin_DD
58662>>>                Send Clear to Baxiokat_DD
58663>>>                Send Clear to Barticl_DD
58664>>>                Send Clear to Bsum_DD
58665>>>                Send Clear to Baxio_DD
58666>>>                Send Clear to Clients_DD
58667>>>                Send Clear to Cn_DD
58668>>>                Send Clear to Tperga_DD
58669>>>                Send Clear to Bmove_DD
58670>>>                Send Clear to Cmoves_DD
58671>>>                Send Clear to Btnordh_DD
58672>>>                Send Clear to Btnordd_DD
58673>>>        
58673>>>        
58673>>>        
58673>>>               // Mono Kinhseis me kodiko1=09 Plhromh Pelatou)
58673>>>               If (iKodKin1=9) Begin
58675>>>                        If (iKodKin2=90)   Move 103 to iBtypkin
58678>>>                   Else If (iKodKin2=91)   Move 101 to iBtypkin
58682>>>                   Else If (iKodKin2=92)   Move 100 to iBtypkin
58686>>>                   Else If (iKodKin2=93)   Move 100 to iBtypkin
58690>>>                   Else If (iKodKin2=94)   Move 100 to iBtypkin
58694>>>        
58694>>>                   Move iBtypkin               to btypkin.Btypkin_Code
58695>>>                   Send Find to Btypkin_DD Eq 1
58696>>>                   If (Not(Found)) Begin
58698>>>                       Set piLathos to 7000
58699>>>                       Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Btypkin not found iBtypkin=' (String(iBtypkin))
58705>>>                       Abort_Transaction
58706>>>                       Goto Read_Next_Kinhsh
58707>>>>
58707>>>                   End
58707>>>>
58707>>>        
58707>>>        
58707>>>                   move '' to sclientid
58708>>>                   append sclientid ((trim(SysCurXr.Company_Code))+'.'+(trim(asBr))+'.'+(trim(skodpel)))
58709>>>                   Move sClientID                  to Clients.Client_Id
58710>>>         //          Get fsgCode_With_Zeroes sKodPel                 ;
58710>>>         //                                  5                       ;
58710>>>        //                                   SysCurXr.Company_Code   ;
58710>>>        //                                   SysCurXr.Branch_Code    ;
58710>>>        //                                           to sClientID
58710>>>        
58710>>>        //           Move sClientID                  to Clients.Client_Id
58710>>>                   Find Eq Clients By Index.6 // Client_ID
58711>>>>
58711>>>                   If (NOT(Found)) Begin
58713>>>                       Set piLathos to 7001
58714>>>                       Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Client not found ID= ' (Trim(sClientID))
58720>>>                       Abort_Transaction
58721>>>                       Goto Read_Next_Kinhsh
58722>>>>
58722>>>                   End
58722>>>>
58722>>>        
58722>>>                   Set Field_Changed_Value Of Barticl_DD Field Barticl.Barticl_Hmnia    to dHmParast
58723>>>                   Set Field_Changed_Value Of Barticl_DD Field Barticl.Barticl_Code1    to Clients.Client_ID
58724>>>                   Set Field_Changed_Value Of Barticl_DD Field Barticl.Barticl_Epon1    to Clients.Client_Name
58725>>>                   Set Field_Changed_Value Of Barticl_DD Field Barticl.Barticl_Aitiol   to (Trim(sArPar))
58726>>>                   Set Field_Changed_Value Of Barticl_DD Field Barticl.Barticl_M_Code   to '04'
58727>>>        
58727>>>                   Move (Trim(sKodPel+sKodErg)) to CN.CN_CodeMatch
58728>>>                   Find GE CN By Index.8 // CN_CodeMatch+CN_Code
58729>>>>
58729>>>                   If ((Found) And (CN.CN_CodeMatch=Trim(sKodPel+sKodErg))) ;                       Set Field_Changed_Value Of Barticl_DD Field Barticl.CN_Code to Cn.CN_Code
58732>>>        
58732>>>                   Send Request_Save to Barticl_DD
58733>>>        
58733>>>                   Send Clear to Baxiokat_DD
58734>>>                   Send Clear to Baxio_DD
58735>>>                   Send Clear to Bmove_DD
58736>>>        
58736>>>                        If (iKodKin2=90)   Move 99 to iBaxioKat
58739>>>                   Else If (iKodKin2=91)   Move  2 to iBaxioKat
58743>>>                   Else If (iKodKin2=92)   Move  1 to iBaxioKat
58747>>>                   Else If (iKodKin2=93)   Move  1 to iBaxioKat
58751>>>                   Else If (iKodKin2=94)   Move  1 to iBaxioKat
58755>>>        
58755>>>                   Move iBaxioKat  to BaxioKat.Baxiokat_Code
58756>>>                   Send Find       to Baxiokat_DD Eq 1
58757>>>                   If (Not(Found)) Begin
58759>>>                       Set piLathos to 7002
58760>>>                       Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Baxiokat not found ID= ' (String(iBaxioKat))
58766>>>                       Abort_Transaction
58767>>>                       Goto Read_Next_Kinhsh
58768>>>>
58768>>>                   End
58768>>>>
58768>>>        
58768>>>                   Set Field_Changed_Value Of Baxio_DD Field Baxio.Baxio_HmniaL    to dHmAxio
58769>>>                   Set Field_Changed_Value Of Baxio_DD Field Baxio.Baxio_C_Code2   to 'EUR'
58770>>>                   Set Field_Changed_Value Of Baxio_DD Field Baxio.Baxio_V2        to nAxia
58771>>>                   Set Field_Changed_Value Of Baxio_DD Field Baxio.Baxio_Ekdoths   to Clients.Client_ID
58772>>>                   Set Field_Changed_Value Of Baxio_DD Field Baxio.Baxio_EkdothsE  to Clients.Client_Name
58773>>>        
58773>>>                   Send Request_Save to Bmove_DD
58774>>>        
58774>>>                   Get Field_Current_Value Of Barticl_DD Field Barticl.Barticl_Recr to sRecr
58775>>>                   Get Field_Current_Value Of Barticl_DD Field Barticl.Recnum       to iRecnum
58776>>>        
58776>>>                   If ((iRecnum) And (sRecr<>'')) Begin
58778>>>                       Set psModule        Of (bpEnCmv3(Self))     to '04'
58779>>>                       Set psBarticleRecr  Of (bpEnCmv3(Self))     to sRecr
58780>>>                       Set piBarticleRecn  Of (bpEnCmv3(Self))     to iRecnum
58781>>>                       Send DoProcess                              to (bpEnCmv3(Self))
58782>>>                       If (Wait(bpEnCmv3(Self))) Send Deactivate   to (Wait(bpEnCmv3(Self)))
58785>>>                   End
58785>>>>
58785>>>               End
58785>>>>
58785>>>               Else Begin
58786>>>                    If (iKodKin1=2) Begin
58788>>>                        // Aytomath Timologhsh
58788>>>                        If (iKodkin2=1) Begin
58790>>>                            // Loipes xreoseis lianikhs
58790>>>                            Move 119 to iCtypkin
58791>>>                        End
58791>>>>
58791>>>                        Else If (iKodkin2=2) Begin
58794>>>                            // Loipes xreoseis xondrikhs
58794>>>                            Move 116 to iCtypkin
58795>>>                        End
58795>>>>
58795>>>                        Else Begin
58796>>>                            Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Kinhsh not found iKodKin2=' (String(iKodKin2))
58802>>>                            Abort_Transaction
58803>>>                            Goto Read_Next_Kinhsh
58804>>>>
58804>>>                        End
58804>>>>
58804>>>                    End
58804>>>>
58804>>>                    Else If (iKodKin1=4) Begin
58807>>>                        // Ap' eytheias -timologhsh
58807>>>                        If (iKodkin2=1) Begin
58809>>>                            // Loipes xreoseis lianikhs
58809>>>                            Move 119 to iCtypkin
58810>>>                        End
58810>>>>
58810>>>                        Else If (iKodkin2=2) Begin
58813>>>                            // Loipes xreoseis xondrikhs
58813>>>                            Move 116 to iCtypkin
58814>>>                        End
58814>>>>
58814>>>                        Else Begin
58815>>>                            Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Kinhsh not found iKodKin2=' (String(iKodKin2))
58821>>>                            Abort_Transaction
58822>>>                            Goto Read_Next_Kinhsh
58823>>>>
58823>>>                        End
58823>>>>
58823>>>                    End
58823>>>>
58823>>>                    Else If (iKodKin1=5) Begin
58826>>>                        // Pistotiko timologio
58826>>>                        If (iKodkin2=3) Begin
58828>>>                            // Epistrofh lianikhs polhshs pistotiko
58828>>>                            Move 121 to iCtypkin
58829>>>                        End
58829>>>>
58829>>>                        Else If (iKodkin2=4) Begin
58832>>>                            // Pistotiko timologio xondrikhs
58832>>>                            Move 121 to iCtypkin
58833>>>                        End
58833>>>>
58833>>>                        Else Begin
58834>>>                            Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Kinhsh not found iKodKin2=' (String(iKodKin2))
58840>>>                            Abort_Transaction
58841>>>                            Goto Read_Next_Kinhsh
58842>>>>
58842>>>                        End
58842>>>>
58842>>>                    End
58842>>>>
58842>>>                    Else If (iKodKin1=8) Begin
58845>>>                        // Flat kinhseis pou mexri tora pernagane
58845>>>                        // san timologia (ara symmetexan sthn MYF gia paradeigma eno
58845>>>                        // den tha eprepe) eno htan xeres xreoseis h pistoseislogo
58845>>>                        // kleisimatos kartellas p.x.
58845>>>                        If (iKodkin2=1) Begin
58847>>>                            // Genikh Xreostikh
58847>>>                            Move 103 to iCtypkin
58848>>>                        End
58848>>>>
58848>>>                        Else If (iKodkin2=2) Begin
58851>>>                            // Genikh Pistotikh
58851>>>                            Move 104 to iCtypkin
58852>>>                        End
58852>>>>
58852>>>                        Else Begin
58853>>>                            Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Kinhsh not found iKodKin2=' (String(iKodKin2))
58859>>>                            Abort_Transaction
58860>>>                            Goto Read_Next_Kinhsh
58861>>>>
58861>>>                        End
58861>>>>
58861>>>                    End
58861>>>>
58861>>>                    Else Begin
58862>>>                        Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Kinhsh not found iKodKin1=' (String(iKodKin1))
58868>>>                        Abort_Transaction
58869>>>                        Goto Read_Next_Kinhsh
58870>>>>
58870>>>                    End
58870>>>>
58870>>>        
58870>>>        
58870>>>                    Move '' to sCN
58871>>>                    Clear CN
58872>>>                    Move (Trim(sKodPel+sKodErg)) to CN.CN_CodeMatch
58873>>>                    Find GE CN By Index.8 // CN_CodeMatch+CN_Code
58874>>>>
58874>>>                    If ((Found) And (CN.CN_CodeMatch=Trim(sKodPel+sKodErg))) ;                        Move (Trim(CN.CN_Code)) to sCN
58877>>>        
58877>>>        
58877>>>                    Send Clear to Cmoves_DD
58878>>>                    move '' to sclientid
58879>>>                    append sclientid ((trim(SysCurXr.Company_Code))+'.'+(trim(asBr))+'.'+(trim(skodpel)))
58880>>>                    Move sClientID                  to Clients.Client_Id
58881>>>        //            Get fsgCode_With_Zeroes sKodPel                 ;
58881>>>        //                                    5                       ;
58881>>>        //                                    SysCurXr.Company_Code   ;
58881>>>        //                                    SysCurXr.Branch_Code    ;
58881>>>        //                                            to sClientID
58881>>>        //
58881>>>        //            Move sClientID                  to Clients.Client_Id
58881>>>                    Send Find to Clients_DD Eq 6 // Client_ID
58882>>>                    If (NOT(Found)) Begin
58884>>>                        Set piLathos to 7004
58885>>>                        Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Client not found ID= ' (Trim(sClientID))
58891>>>                        Abort_Transaction
58892>>>                        Goto Read_Next_Kinhsh
58893>>>>
58893>>>                    End
58893>>>>
58893>>>        
58893>>>                    Move iCtypkin               to Ctypkin.Ctypkin_Code
58894>>>                    Send Find to Ctypkin_DD Eq 1
58895>>>                    If (Not(Found)) Begin
58897>>>                        Set piLathos to 7003
58898>>>                        Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Ctypkin not found iCtypkin=' (String(iCtypkin))
58904>>>                        Abort_Transaction
58905>>>                        Goto Read_Next_Kinhsh
58906>>>>
58906>>>                    End
58906>>>>
58906>>>        
58906>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_Hmnia      to dHmParast
58907>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_M_Code     to '01'
58908>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Module_From       to '01'
58909>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_axia       to nAxia
58910>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_par        to (Trim(sArPar))
58911>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_sc_code2   to 'EUR'
58912>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cn_code           to sCN
58913>>>        
58913>>>        //                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.enhm_ofeilh       to '1'
58913>>>        //                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Enhm_Ypol_Pel     to '1'
58913>>>        //                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Enhm_Hmnies_Pel   to '1'
58913>>>        
58913>>>                    Send Request_Save to Cmoves_DD
58914>>>        
58914>>>                    Get Field_Current_Value Of Cmoves_DD Field Cmoves.Recnum to iCmvRec
58915>>>        
58915>>>                    If (iCmvRec) Begin
58917>>>        //                        Get Compute_all_Fields iCmvRec 1 to rVal
58917>>>        //                        If (rVal) Begin
58917>>>        //                                 If (rVal=1) Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Ctypkin not found in Compute_all_Fields'
58917>>>        //                            Else If (rVal=2) Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Client  not found in Compute_all_Fields'
58917>>>        //                            Else If (rVal=3) Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Nomisma not found in Compute_all_Fields'
58917>>>        //                            Else If (rVal=4) Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Client  not found in Compute_all_Fields'
58917>>>        //                            Else If (rVal=5) Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Cmoves  not found in Compute_all_Fields'
58917>>>        //                            Abort_Transaction
58917>>>        //                            Goto Read_Next_Kinhsh
58917>>>        //                        End
58917>>>                    End
58917>>>>
58917>>>                    Else Begin
58918>>>                        Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Cmoves repositioning not found'
58923>>>                        Abort_Transaction
58924>>>                        Goto Read_Next_Kinhsh
58925>>>>
58925>>>                    End
58925>>>>
58925>>>        
58925>>>        
58925>>>               End // If iKodkin1=9
58925>>>>
58925>>>        
58925>>>             END_TRANSACTION
58926>>>        
58926>>>             Unlock
58927>>>>
58927>>>        
58927>>>               Move (Err) to iErr
58928>>>               If (iErr) Begin
58930>>>                    Get Error_Text iErr to sError
58931>>>                    Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    ¨¦™¢ž£˜ ˜§¦ « ª ¡¢á©œ ª= ' (String(iErr)) '     ' (Trim(sError))
58939>>>                    Unlock
58940>>>>
58940>>>                    Close_Output Channel 9
58942>>>                    Procedure_Return
58943>>>               End
58943>>>>
58943>>>        
58943>>>               Read_Next_Kinhsh:
58943>>>               move iError_Object_ID to Error_Object_ID
58944>>>        
58944>>>               Readln Channel 1 sLine
58946>>>            Loop
58947>>>>
58947>>>        
58947>>>            Set Label Of ButtonSub1 to ''
58948>>>        
58948>>>                 If (piLathos(Self)=70000) Send Stop_Box 'Btypkin Not found'  ('# '+(String(iInt1)))
58951>>>            Else If (piLathos(Self)=70001) Send Stop_Box 'Client Not found'   ('# '+(String(iInt1)))
58955>>>            Else If (piLathos(Self)=70002) Send Stop_Box 'Baxiokat Not found' ('# '+(String(iInt1)))
58959>>>        
58959>>>        
58959>>>            Close_Output Channel 9
58961>>>        
58961>>>        
58961>>>        End_Procedure // Read_Kinhseis
58962>>>        
58962>>>        
58962>>>        
58962>>>        
58962>>>        
58962>>>        
58962>>>        
58962>>>        
58962>>>        //AB-StoreEnd
58962>>>
58962>>>    End_Object    // ButtonSub1
58963>>>
58963>>>    Object TextBoxSub1 is a TextBoxSub
58965>>>        Set Label to "„§ ¢¦šã ˜¨®œå¦¬"
58966>>>        Set Location to 7 5
58967>>>        Set Size to 10 55
58968>>>    End_Object    // TextBoxSub1
58969>>>
58969>>>    Object RadioGroupSub1 is a RadioGroupSub
58971>>>        Set Size to 89 107
58972>>>        Set Location to 62 170
58973>>>        Object Radio1 is a RadioSub
58975>>>            Set Label to "“§œçŸ¬¤¦  ¢ž¨à£é¤"
58976>>>            Set Size to 10 95
58977>>>            Set Location to 10 5
58978>>>        End_Object    // Radio1
58979>>>
58979>>>        Object Radio2 is a RadioSub
58981>>>            Set Label to "œ¢á«œª"
58982>>>            Set Size to 10 95
58983>>>            Set Location to 25 5
58984>>>        End_Object    // Radio2
58985>>>
58985>>>        Object Radio3 is a RadioSub
58987>>>            Set Label to "„¨š˜"
58988>>>            Set Size to 10 95
58989>>>            Set Location to 40 5
58990>>>        End_Object    // Radio3
58991>>>
58991>>>        Object Radio1 is a RadioSub
58993>>>            Set Label to "ƒ„Ž"
58994>>>            Set Size to 10 95
58995>>>            Set Location to 57 5
58996>>>        End_Object    // Radio1
58997>>>
58997>>>        Object Radio2 is a RadioSub
58999>>>            Set Label to "‰ ¤ã©œ ª"
59000>>>            Set Size to 10 95
59001>>>            Set Location to 73 5
59002>>>        End_Object    // Radio2
59003>>>
59003>>>
59003>>>        //AB-StoreStart
59003>>>        
59003>>>        Procedure Notify_Select_State integer iToItem integer iFromItem
59005>>>            Set piWhat to iToItem
59006>>>            Set Enabled_State Of frmBranch to (iToItem=4)
59007>>>        End_Procedure
59008>>>        
59008>>>        // If you set Current_radio you must set this after the
59008>>>        // radio objects have been created AND after Notify_select_State has been
59008>>>        // created. i.e. Set in bottom-code at end!!
59008>>>        //Set Current_Radio to 0
59008>>>        
59008>>>        
59008>>>        
59008>>>        //AB-StoreEnd
59008>>>
59008>>>    End_Object    // RadioGroupSub1
59009>>>
59009>>>    Object TextBoxSub2 is a TextBoxSub
59011>>>        Set Label to "ƒé©«œ ¬§¦¡˜«˜©«ž£˜ ©«¦ ¦§¦å¦ ¡á¤˜«œ Login š ˜ ¤˜ œ ©ášœ«œ «¦¬ª œ¢á«œª"
59012>>>        Set Location to 24 119
59013>>>        Set Size to 18 207
59014>>>        Set Justification_Mode to jMode_Center
59015>>>    End_Object    // TextBoxSub2
59016>>>
59016>>>    Object oOpenFile is a OpenDialog
59018>>>        Set Location to 2 407
59019>>>
59019>>>        //AB-StoreStart
59019>>>        Set Filter_String   to 'Text Files|*.txt|All Files|*.*'
59020>>>        Set Initial_Folder  to 'C:\VDF6\Develop\Empor'
59021>>>        Set Filter_Index    to 1
59022>>>        
59022>>>        //AB-StoreEnd
59022>>>
59022>>>    End_Object    // oOpenFile
59023>>>
59023>>>
59023>>>    //AB-StoreStart
59023>>>                                                    
59023>>>                                                    
59023>>>                                                    
59023>>>                                                    
59023>>>                                                    
59023>>>                                                    
59023>>>    //AB-StoreEnd
59023>>>
59023>>>End_Object    // tAxioamal
59024>>>
59024>>>
59024>>>//AB-StoreStart
59024>>>                    
59024>>>                    
59024>>>                    
59024>>>//AB-StoreEnd
59024>>>
59024>>>//AB/ End_Object    // prj
59024>
59024>        //AB-ClientStoreStart
59024>        
59024>        
59024>        
59024>        //AB-ClientStoreEnd
59024>
59024>
59024>    End_Object  // Client_Area
59025>    
59025>    On_Key Key_Ctrl+Key_1 Send Activate_tAxioamal To Client_Area
59026>    
59026>    Use DFStdSbr.pkg //  Status-Bar object.
INCLUDING FILE: DFSTDSBR.PKG
59026>>>// 07/23/96 JJT - New Class names
59026>>>// Very prototype global status bar
59026>>>//
59026>>>Use dfMainSt.pkg
INCLUDING FILE: DFMAINST.PKG
59026>>>>>// 07/23/96 JJT - New Class names
59026>>>>>Use dfAstbar.pkg
59026>>>>>
59026>>>>>Class StatusBar is a AppStatusBar
59027>>>>>
59027>>>>>    Procedure Construct_Object
59028>>>>>       Forward Send Construct_Object
59030>>>>>       //
59030>>>>>       Send Add_Item 350  ''     // micro-help
59031>>>>>       Send Add_Item  40  'View:'
59032>>>>>       Set Item_Display_Style To sbNORMAL
59033>>>>>       Send Add_Item 200  ''     // view name
59034>>>>>       Send Add_Item   0  ''     // spring 'normal' to end
59035>>>>>       Set Item_Display_Style To sbNORMAL
59036>>>>>    End_Procedure // Construct_Object
59037>>>>>
59037>>>>>    Procedure Show_View_Name String sName
59038>>>>>        Set Value item 2 to sName
59039>>>>>    End_Procedure
59040>>>>>
59040>>>>>End_Class
59041>>>
59041>>>If (Wait(Self)) Send Deactivate to (Wait(Self))
59044>>>
59044>>>Object oStatusBarSub  is a StatusBar
59046>>>    Use DFTimer // DfTimer Manager Must Have a WindowHandle
59046>>>    
59046>>>    Property Integer piStdPanes Public (PaneCount(Self))
59048>>>    
59048>>>    //Set Value     Item 1 to (ToANSI("„§ ¢¦šã:"))
59048>>>    Set PaneWidth item 1 to 50
59049>>>    
59049>>>    Send AddPane 55  ""        sbLOWERED
59050>>>    Send AddPane 70  ""        sbLOWERED
59051>>>    Send AddPane 55  ""        sbLOWERED
59052>>>    
59052>>>    Procedure pTimer
59054>>>        String lsDay lsHour lsHH lsMM lsSS
59055>>>        Integer liStdPanes lbState
59055>>>    
59055>>>        Get piStdPanes to liStdPanes
59056>>>        Sysdate lsDay lsHH lsMM lsSS
59060>>>        If (Length(lsHH)=1) Insert "0" In lsHH At 1
59064>>>        If (Length(lsMM)=1) Insert "0" In lsMM At 1
59068>>>        If (Length(lsSS)=1) Insert "0" In lsSS At 1
59072>>>        Move (lsHH+":"+lsMM+":"+lsSS) to lsHour
59073>>>        Get Simple_state to lbState
59074>>>        If  Not (lbState) Begin
59076>>>            Set Value Item liStdPanes     to lsHour
59077>>>            Set Value Item (liStdPanes+1) to lsDay
59078>>>        End
59078>>>>
59078>>>    
59078>>>    End_Procedure // pTimer
59079>>>    
59079>>>    
59079>>>    Object oTimerObj Is A DFTimer
59081>>>    
59081>>>        Set Timeout to 1000
59082>>>        Set Timer_Active_State to TRUE
59083>>>        Set Timer_Object to (oStatusBarSub(Current_Object))
59084>>>        Set Timer_Message to pTimer
59085>>>    
59085>>>    End_Object // oTimerOdj
59086>>>End_Object // oStatusBar
59087>>>
59087>>>
59087>
59087>    //AB-PanelStoreStart
59087>    Use StdAbout.pkg // Standard "About" package.
INCLUDING FILE: STDABOUT.PKG
59087>>>//************************************************************************
59087>>>// Confidential Trade Secret.
59087>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
59087>>>// as an unpublished work.  All rights reserved.
59087>>>// DataFlex is a registered trademark of Data Access Corporation.
59087>>>//
59087>>>//************************************************************************
59087>>>//************************************************************************
59087>>>//
59087>>>// $File name  : StdAbout.pkg
59087>>>// $File title : Standard about object package for VDF
59087>>>// Notice      :
59087>>>// $Author(s)  : John Tuohy
59087>>>//
59087>>>// $Rev History
59087>>>//
59087>>>// JT 06/27/97   File created
59087>>>//************************************************************************
59087>>>
59087>>>// This provides a quick and simple way to create an about package for a program.
59087>>>// You need to create a message inside you client area called Activate_About.
59087>>>// Within this message you should send the message DoAbout passing needed
59087>>>// string information.
59087>>>//
59087>>>//       Procedure Activate_About
59087>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
59087>>>//       End_Procedure
59087>>>//    where: sTitle =     Name of application. If none provided, uses caption
59087>>>//                        bar title
59087>>>//           sVersion   = Version Line. If none provided, will be blank
59087>>>//           sCopyRight = Copyright Line. If none provided, will be blank
59087>>>//           sAuthor    = Author name, blank if none provided
59087>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
59087>>>//                        is used.
59087>>>// It is expected that you will place this in your own object package. For
59087>>>// example an order about package may look like this:
59087>>>//
59087>>>//   // OrderAbout.pkg
59087>>>//   Use StdAbout.pkg
59087>>>//   Procedure Activate_About
59087>>>//      Local String sTitle sCopyright sVersion sAuthor
59087>>>//      Move "My Order Entry System" to sTitle
59087>>>//      Move "Version 2.1" to sVersion
59087>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
59087>>>//      Move "John Smith"  to sAuthor
59087>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
59087>>>//   end_procedure
59087>>>//   // end of file.
59087>>>
59087>>>Use DfAbout.pkg
INCLUDING FILE: DFABOUT.PKG
59087>>>>>//************************************************************************
59087>>>>>// Confidential Trade Secret.
59087>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
59087>>>>>// as an unpublished work.  All rights reserved.
59087>>>>>// DataFlex is a registered trademark of Data Access Corporation.
59087>>>>>//
59087>>>>>//************************************************************************
59087>>>>>//************************************************************************
59087>>>>>//
59087>>>>>// $File name  : DfAbout.pkg
59087>>>>>// $File title : About class support
59087>>>>>// Notice      :
59087>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
59087>>>>>//
59087>>>>>// $Rev History
59087>>>>>//
59087>>>>>// JJT 11/5/98    Added version information
59087>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
59087>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
59087>>>>>//                workspace package.
59087>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
59087>>>>>//                class can create this object.
59087>>>>>//                Cleaned up the interface (used correct classes and messages)
59087>>>>>//                Added workspace reporting support to sys-info.
59087>>>>>//                Turned off wrapping in the sys-info editor.
59087>>>>>// KR  ??/??/96   File created
59087>>>>>//************************************************************************
59087>>>>>Use windows.pkg
59087>>>>>Use DFbitmap.pkg
59087>>>>>
59087>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
59088>>>>>
59088>>>>>//****************************************************************************
59088>>>>>// $Module type: FUNCTION
59088>>>>>// $Module name: Network_User_Name
59088>>>>>// $Author     : AK/VOO/KCR
59088>>>>>// Created     : 24-09-96 @ 19:17
59088>>>>>//
59088>>>>>// Description
59088>>>>>//    This function reads the current username of windows and returns that
59088>>>>>//    name or an text unknown user
59088>>>>>//
59088>>>>>// $Rev History
59088>>>>>//    24-09-96  Module header created
59088>>>>>//****************************************************************************
59088>>>>>Function Network_User_Name Returns String
59090>>>>>    Local String sName sLength
59091>>>>>    Local Pointer lpName_Addr lpLength_Addr
59091>>>>>    Local Integer iRetval
59091>>>>>
59091>>>>>    Movestr (Repeat (Character (0), 255)) To sName
59092>>>>>>
59092>>>>>    GetAddress Of sName To lpName_Addr
59093>>>>>    Movestr (DwordToBytes (255)) To sLength
59094>>>>>>
59094>>>>>    GetAddress Of sLength To lpLength_Addr
59095>>>>>
59095>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
59096>>>>>>
59096>>>>>
59096>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
59099>>>>>    Else Function_Return "User Unknown"
59101>>>>>End_Function // Network_User_Name
59102>>>>>
59102>>>>>Type MEMORYSTATUS
59102>>>>>   Field MEMORYSTATUS.dwLength         As Dword // sizeof(MEMORYSTATUS)
59102>>>>>   Field MEMORYSTATUS.dwMemoryLoad     As Dword // percent of memory in use
59102>>>>>   Field MEMORYSTATUS.dwTotalPhys      As Dword // bytes of physical memory
59102>>>>>   Field MEMORYSTATUS.dwAvailPhys      As Dword // free physical memory bytes
59102>>>>>   Field MEMORYSTATUS.dwTotalPageFile  As Dword // bytes of paging file
59102>>>>>   Field MEMORYSTATUS.dwAvailPageFile  As Dword // free bytes of paging file
59102>>>>>   Field MEMORYSTATUS.dwTotalVirtual   As Dword // user bytes of address space
59102>>>>>   Field MEMORYSTATUS.dwAvailVirtual   As Dword // free user bytes
59102>>>>>End_Type // MEMORYSTATUS
59102>>>>>
59102>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
59103>>>>>
59103>>>>>// If a global workspace object exists it will use this variable to store
59103>>>>>// its object id.
59103>>>>>
59103>>>>>Class SysinfoDisplay Is An Edit
59104>>>>>    Procedure Construct_Object
59105>>>>>        forward send construct_object
59107>>>>>
59107>>>>>        Set Location To 6 6
59108>>>>>        Set Size To 110 255
59109>>>>>        Set Read_Only_State To True
59110>>>>>        Set wrap_state to False
59111>>>>>    end_Procedure
59112>>>>>
59112>>>>>    //****************************************************************************
59112>>>>>    // $Module type: PROCEDURE
59112>>>>>    // $Module name: Add_Line
59112>>>>>    // $Author     : VOO
59112>>>>>    // Created     : 06-10-96 @ 15:23
59112>>>>>    //
59112>>>>>    // Description
59112>>>>>    //    This method will add a line to this edit object, it should go simpler
59112>>>>>    //    but it seems to be done this way.
59112>>>>>    //
59112>>>>>    // $Rev History
59112>>>>>    //    06-10-96  Module header created
59112>>>>>    //****************************************************************************
59112>>>>>    Procedure Add_Line String sVal
59113>>>>>        Local Integer iLine
59114>>>>>
59114>>>>>        Moveint (Line_Count (Current_Object)) To iLine
59115>>>>>>
59115>>>>>        If (iLine = 1 And Changed_State (Current_Object) = False) Moveint 0 To iLine
59118>>>>>        Set Value Item iLine To sVal
59119>>>>>    End_Procedure // Add_Line
59120>>>>>
59120>>>>>    //****************************************************************************
59120>>>>>    // $Module type: PROCEDURE
59120>>>>>    // $Module name: Show_Current_Directory
59120>>>>>    // $Author     : VOO
59120>>>>>    // Created     : 06-10-96 @ 15:24
59120>>>>>    //
59120>>>>>    // Description
59120>>>>>    //    This method will show the name of the current directory in the system
59120>>>>>    //    information box
59120>>>>>    //
59120>>>>>    // $Rev History
59120>>>>>    //    06-10-96  Module header created
59120>>>>>    //****************************************************************************
59120>>>>>    Procedure Show_Current_Directory
59121>>>>>        Local String sDir
59122>>>>>
59122>>>>>        Get_Current_Directory To sDir
59123>>>>>        Send Add_Line ("Current Directory: " + sDir)
59124>>>>>    End_Procedure // Show_Current_Directory
59125>>>>>
59125>>>>>    Procedure Show_Windows_Directory
59126>>>>>        Local String sWindir
59127>>>>>
59127>>>>>        Get_Windows_Directory To sWindir
59128>>>>>        Send Add_Line ("Windows Directory: " * sWindir)
59129>>>>>    End_Procedure // Show_Windows_Directory
59130>>>>>
59130>>>>>    Procedure Show_Current_User
59131>>>>>        Send Add_Line ("Network User Name: " * Network_User_Name (Current_Object))
59132>>>>>    End_Procedure // Show_Current_User
59133>>>>>
59133>>>>>    Procedure Show_Number_Format
59134>>>>>        Local Integer iFormat
59135>>>>>
59135>>>>>        Get_Attribute Df_Thousands_Separator To iFormat
59138>>>>>        Send Add_Line ('Thousands Separator: "' - Character (iFormat) - '" (' - String (iFormat) - ')')
59139>>>>>        Get_Number_Format To iFormat
59140>>>>>        Send Add_Line ('Decimal Separator: "' - If (iFormat = 0, '.', ',') - '"')
59141>>>>>    End_Procedure // Show_Number_Format
59142>>>>>
59142>>>>>    Procedure Show_Filelist_Name
59143>>>>>        Local String sFilename
59144>>>>>
59144>>>>>        Get_Attribute Df_Filelist_Name To sFilename
59147>>>>>        Send Add_Line ("Current Filelist: " * sFilename)
59148>>>>>    End_Procedure // Show_Filelist_Name
59149>>>>>
59149>>>>>    Procedure Show_Lock_Delay
59150>>>>>        Local Integer iLockdelay
59151>>>>>
59151>>>>>        Get_Attribute Df_Lock_Delay To iLockdelay
59154>>>>>        Send Add_Line ("Database Locking Delay: " * String (iLockdelay) * "Milliseconds")
59155>>>>>    End_Procedure // Show_Lock_Delay
59156>>>>>
59156>>>>>    Procedure Show_Lock_Timeout
59157>>>>>        Local Integer iLockTimeout
59158>>>>>
59158>>>>>        Get_Attribute Df_Lock_Timeout To iLockTimeout
59161>>>>>        Send Add_Line ("Database Locking Timeout: " * String (iLockTimeout) * "Milliseconds")
59162>>>>>    End_Procedure // Show_Lock_Timeout
59163>>>>>
59163>>>>>    Procedure Show_Screen_Size
59164>>>>>        Local Integer iYscreensize iXscreensize
59165>>>>>
59165>>>>>        Moveint (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
59166>>>>>>
59166>>>>>        Moveint (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
59167>>>>>>
59167>>>>>
59167>>>>>        Send Add_Line ("Video Resolution: " * String (iXscreensize) * "by" * String (iYscreensize))
59168>>>>>    End_Procedure // Show_Screen_Size
59169>>>>>
59169>>>>>    Procedure Show_Page_Size
59170>>>>>        Send Add_Line ("Page End: " * String (Pageend) * "Form Feed: " * String (Pagefeed))
59171>>>>>    End_procedure
59172>>>>>
59172>>>>>    Procedure Show_Date
59173>>>>>        Local Date dToday
59174>>>>>
59174>>>>>        Sysdate4 dToday
59175>>>>>        Send Add_Line ("Current System Date: " * String (dToday))
59176>>>>>    End_procedure // Show_Date
59177>>>>>
59177>>>>>    Procedure Show_Date_Format
59178>>>>>        Local Integer iDateFormat
59179>>>>>        Local String sDateFormat
59179>>>>>
59179>>>>>        Get_Attribute Df_Date_Format To iDateFormat
59182>>>>>        if iDateFormat Eq DF_DATE_USA ;            Movestr "USA" To sDateFormat
59185>>>>>        else if iDateformat Eq DF_DATE_EUROPEAN ;            Movestr "European" To sDateFormat
59189>>>>>        else if iDateformat Eq DF_DATE_MILITARY ;            Movestr "Military" To sDateFormat
59193>>>>>        else ;            Movestr "Unknown Date Type" To sDateFormat
59195>>>>>        Send Add_Line ("Date Format: " * sDateformat)
59196>>>>>    End_Procedure // Show_Date_Format
59197>>>>>
59197>>>>>    Procedure Show_Memavail
59198>>>>>        Local Integer iMem
59199>>>>>
59199>>>>>        Memory iMem
59200>>>>>>
59200>>>>>        Send Add_Line ("Available Memory: " * String (iMem))
59201>>>>>    End_Procedure // Show_Memavail
59202>>>>>
59202>>>>>    Procedure Show_Systemresources
59203>>>>>        Local String sMemoryStatus
59204>>>>>        Local Pointer lpsMemoryStatus
59204>>>>>        Local Integer iVoid
59204>>>>>        Local Dword dwMemoryLoad dwTotalPhys dwAvailPhys dwTotalPageFile dwAvailPageFile dwTotalVirtual dwAvailVirtual
59204>>>>>
59204>>>>>        ZeroType MEMORYSTATUS To sMemoryStatus
59205>>>>>        GetAddress Of sMemoryStatus To lpsMemoryStatus
59206>>>>>
59206>>>>>        Moveint (GlobalMemoryStatus (lpsMemoryStatus)) To iVoid
59207>>>>>>
59207>>>>>
59207>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwMemoryLoad    To dwMemoryLoad
59208>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPhys     To dwTotalPhys
59209>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPhys     To dwAvailPhys
59210>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPageFile To dwTotalPageFile
59211>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPageFile To dwAvailPageFile
59212>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalVirtual  To dwTotalVirtual
59213>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailVirtual  To dwAvailVirtual
59214>>>>>
59214>>>>>        Send Add_Line ("Current memory utilization:" * String (dwMemoryLoad))
59215>>>>>        Send Add_Line ("Percentage available physical memory:" * String (dwAvailPhys / dwTotalPhys * 100.0) - "%")
59216>>>>>        Send Add_Line ("Percentage available pagefile space:" * String (dwAvailPageFile / dwTotalPageFile * 100.0) - "%")
59217>>>>>        Send Add_Line ("Percentage available virtual memory:" * String (dwAvailVirtual / dwTotalVirtual * 100.0) - "%")
59218>>>>>    End_Procedure // Show_Systemresources
59219>>>>>
59219>>>>>    Procedure Show_Registration
59220>>>>>        Local String sRegName
59221>>>>>        Local Integer iSN
59221>>>>>        Registration sRegName iSN
59222>>>>>>
59222>>>>>
59222>>>>>        Send Add_Line ("Serial# : " + (String(iSN)))
59223>>>>>        Send Add_Line ("Reg Name: " + sRegName)
59224>>>>>
59224>>>>>    End_Procedure // Show_Current_Directory
59225>>>>>
59225>>>>>
59225>>>>>
59225>>>>>    //****************************************************************************
59225>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
59225>>>>>    // to the workspace object passing the an object and message to send back
59225>>>>>    // to this object. It is expected that the workspace object will send this
59225>>>>>    // message for every line of information it wants displayed (passing the
59225>>>>>    // information to be displayed
59225>>>>>    //****************************************************************************
59225>>>>>    register_procedure EnumerateWorkspaceData integer hObjId integer hmMessId
59225>>>>>    Procedure Show_WorkspaceInformation
59226>>>>>        If ghoWorkspace ;            Send EnumerateWorkspaceData to ghoWorkspace Current_object Msg_add_Line
59229>>>>>    End_Procedure
59230>>>>>
59230>>>>>    Function VersionStr integer iVer integer iRev integer iBld Returns string
59231>>>>>        Function_Return (string(iVer)-"."-string(iRev)-"."-string(iBld))
59232>>>>>    End_Function
59233>>>>>
59233>>>>>    Procedure Show_Versions
59234>>>>>        local integer iVersion iRevision iBuild
59235>>>>>        Version_information iVersion iRevision iBuild
59237>>>>>        Send Add_Line ("Runtime Version:" * VersionStr(self,iVersion,iRevision,iBuild) )
59238>>>>>        Send Add_Line ("Package Version:" * VersionStr(self,PKG_VERSION, PKG_REVISION, PKG_BUILD) )
59239>>>>>        Send Add_Line ("FMAC Version:"    * VersionStr(self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) )
59240>>>>>    End_Procedure
59241>>>>>
59241>>>>>
59241>>>>>    //***
59241>>>>>    //*** BW
59241>>>>>    //*** Procedure: Show_Drivers
59241>>>>>    //*** Purpose  : Show loaed database drivers
59241>>>>>    //***
59241>>>>>
59241>>>>>    Procedure Show_Drivers
59242>>>>>        Local String  Current_drvr
59243>>>>>        Local String  Loadeddrvrs
59243>>>>>        Local Integer Number_of_drvrs
59243>>>>>        Local Integer Count
59243>>>>>
59243>>>>>        Move "" To Loadeddrvrs
59244>>>>>        Get_attribute DF_NUMBER_DRIVERS To Number_of_drvrs
59247>>>>>        For Count From 1 To Number_of_drvrs
59253>>>>>>
59253>>>>>            Get_attribute DF_DRIVER_NAME Of Count To Current_drvr
59256>>>>>            If (Loadeddrvrs <> "") ;                Move (Append(Loadeddrvrs, ", ")) To Loadeddrvrs
59259>>>>>            Move (Append(Loadeddrvrs, Current_drvr)) To Loadeddrvrs
59260>>>>>        Loop
59261>>>>>>
59261>>>>>        Send Add_Line ("Database driver(s):" * Loadeddrvrs)
59262>>>>>    End_Procedure // Show_Drivers
59263>>>>>
59263>>>>>    //****************************************************************************
59263>>>>>    // $Module type: PROCEDURE
59263>>>>>    // $Module name: Add_Focus
59263>>>>>    // $Author     : VOO
59263>>>>>    // Created     : 24-09-96 @ 19:43
59263>>>>>    //
59263>>>>>    // Description
59263>>>>>    //    During activation we will remove the old information and add the newly
59263>>>>>    //    found systeminformation
59263>>>>>    //
59263>>>>>    // $Rev History
59263>>>>>    //    24-09-96  Module header created
59263>>>>>    //****************************************************************************
59263>>>>>    Procedure Add_Focus Integer hoRoot
59264>>>>>        Forward Send Add_Focus hoRoot
59266>>>>>
59266>>>>>        Send Delete_Data
59267>>>>>        Set Changed_State To False
59268>>>>>        Set Read_Only_State To True
59269>>>>>        Send Show_WorkSpaceInformation // added to show WS info
59270>>>>>        SEnd Show_Drivers
59271>>>>>        Send Show_Current_User
59272>>>>>        Send Show_Windows_Directory
59273>>>>>        Send Show_Current_Directory
59274>>>>>        Send Show_Filelist_Name
59275>>>>>        Send Show_Versions
59276>>>>>        Send Show_Memavail
59277>>>>>        Send Show_Screen_Size
59278>>>>>        Send Show_Page_Size
59279>>>>>        Send Show_Number_Format
59280>>>>>        Send Show_Date_Format
59281>>>>>        Send Show_Lock_Delay
59282>>>>>        Send Show_Lock_Timeout
59283>>>>>        Send Show_Date
59284>>>>>        Send Show_Systemresources
59285>>>>>        Send Show_Registration
59286>>>>>    End_Procedure // Show_All_Info
59287>>>>>
59287>>>>>End_Class // SysinfoDisplay
59288>>>>>
59288>>>>>
59288>>>>>//****************************************************************************
59288>>>>>// $Module type: OBJECT
59288>>>>>// $Module name: Sysinfo_Dialog
59288>>>>>// $Author     : VOO
59288>>>>>// Created     : 24-09-96 @ 18:47
59288>>>>>//
59288>>>>>// Description
59288>>>>>//    This object shows the systeminformation on the screen
59288>>>>>//
59288>>>>>// $Rev History
59288>>>>>//    24-09-96  Module header created
59288>>>>>//****************************************************************************
59288>>>>>Class SysInfoDialog Is A ModalPanel
59289>>>>>    Procedure Construct_Object
59290>>>>>        forward send construct_object
59292>>>>>
59292>>>>>        Set Caption_Bar To True
59293>>>>>        Set Sysmenu_Icon To True
59294>>>>>        Set Label To "System Information"
59295>>>>>        Set Size To 152 270
59296>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
59297>>>>>        Set Minimize_Icon To False
59298>>>>>        Set Maximize_Icon To False
59299>>>>>        Set Border_Style To Border_Dialog
59300>>>>>
59300>>>>>        Object Sysinfo_Display Is A SysInfoDisplay
59302>>>>>        End_Object
59303>>>>>
59303>>>>>        Object Close_Button Is A Button
59305>>>>>            Set Label to "&Close"
59306>>>>>            Set Location To 120 212
59307>>>>>            Set Message item 0 to msg_Close_Panel
59308>>>>>            Set default_action_button to current_object
59309>>>>>        End_Object // Close_Button
59310>>>>>
59310>>>>>        On_Key Kcancel       Send Close_Panel
59311>>>>>        On_Key Key_Alt+Key_C Send Close_Panel
59312>>>>>    End_procedure
59313>>>>>
59313>>>>>End_Class // SysinfoDialog
59314>>>>>
59314>>>>>// Purpose:
59314>>>>>//
59314>>>>>// Ken Ross 12/17/96 5:16PM
59314>>>>>//
59314>>>>>Class AboutDialog Is A ModalPanel
59315>>>>>
59315>>>>>    Procedure construct_object
59316>>>>>        String sVdfRootDir
59317>>>>>        forward send construct_object
59319>>>>>        Set Label to "About..."
59320>>>>>        Set Size to 100 217
59321>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
59322>>>>>
59322>>>>>        Object SysInfo_Dialog is a SysInfoDialog
59324>>>>>        End_Object
59325>>>>>
59325>>>>>        Object oBox is a Container3d
59327>>>>>            Set Border_Style to Border_StaticEdge
59328>>>>>            Set Size to 63 202
59329>>>>>            Set Location to 4 5
59330>>>>>
59330>>>>>            Object AboutGraphic is a BitmapContainer
59332>>>>>                Set Border_Style to Border_None
59333>>>>>                Set Bitmap_Style to Bitmap_Center
59334>>>>>                Set Size to 48 48
59335>>>>>                Set Location to 7 2
59336>>>>>            End_Object    // AboutGraphic
59337>>>>>
59337>>>>>            Object ProductName is a TextBox
59339>>>>>                Set label to "ProductName"
59340>>>>>                Set Size to 10 45
59341>>>>>                Set Location to 8 53
59342>>>>>            End_Object    // ProductName
59343>>>>>
59343>>>>>            Object Version is a TextBox
59345>>>>>                Set label to "Version"
59346>>>>>                Set Size to 10 25
59347>>>>>                Set Location to 21 53
59348>>>>>            End_Object    // Version
59349>>>>>
59349>>>>>            Object Copyright is a TextBox
59351>>>>>                Set label to "Copyright"
59352>>>>>                Set Size to 10 31
59353>>>>>                Set Location to 34 53
59354>>>>>            End_Object    // Copyright
59355>>>>>
59355>>>>>            Object Author is a TextBox
59357>>>>>                Set label to "Author"
59358>>>>>                Set Size to 10 22
59359>>>>>                Set Location to 46 53
59360>>>>>            End_Object    // Author
59361>>>>>
59361>>>>>        End_Object    // oBox
59362>>>>>
59362>>>>>        Object OK_bn is a Button
59364>>>>>            On_Item "&OK" Send Close_Panel
59365>>>>>            Set Size to 14 50
59366>>>>>            Set Location to 71 157
59367>>>>>        End_Object    // OK_bn
59368>>>>>
59368>>>>>        Object SysInfo_bn is a Button
59370>>>>>            On_Item "&System Info" Send Show_Sysinfo
59371>>>>>            Set Size to 14 50
59372>>>>>            Set Location to 71 101
59373>>>>>        End_Object    // SysInfo_bn
59374>>>>>
59374>>>>>        On_Key Kcancel Send KeyAction to (Ok_bn(Current_Object))
59375>>>>>        On_Key Key_Alt+Key_O Send KeyAction to (Ok_bn(Current_Object))
59376>>>>>        On_Key Key_Alt+Key_S Send KeyAction to (SysInfo_bn(Current_Object))
59377>>>>>
59377>>>>>        Get_Profile_String "Defaults" "VdfRootDir" To sVdfRootDir
59380>>>>>        Set logo to (sVdfRootDir +"\Bitmaps\DacAbout.bmp")  // square bitmaps of 42x42 work best
59381>>>>>
59381>>>>>    End_Procedure
59382>>>>>
59382>>>>>    Procedure set productname string sval
59383>>>>>        set label of (productname(oBox(current_object))) to sval
59384>>>>>    End_Procedure
59385>>>>>
59385>>>>>    Procedure set version string sval
59386>>>>>        set label of (version(oBox(current_object))) to sval
59387>>>>>    End_Procedure
59388>>>>>
59388>>>>>    Procedure set copyright string sval
59389>>>>>        set label of (copyright(oBox(current_object))) to sval
59390>>>>>    End_Procedure
59391>>>>>
59391>>>>>    Procedure set author string sval
59392>>>>>        set label of (author(oBox(current_object))) to sval
59393>>>>>    End_Procedure
59394>>>>>
59394>>>>>    // square bitmaps of 42x42 work best
59394>>>>>    //
59394>>>>>    Procedure set logo string sval
59395>>>>>        set bitmap of (aboutgraphic(oBox(current_object))) to sval
59396>>>>>    End_Procedure
59397>>>>>
59397>>>>>    Procedure Show_Sysinfo
59398>>>>>        Send Popup_Modal To (Sysinfo_Dialog(Current_Object))
59399>>>>>    End_Procedure // Show_Sysinfo
59400>>>>>
59400>>>>>End_Class
59401>>>>>
59401>>>>>
59401>>>>>//Object About_Dialog is an AboutDialog
59401>>>>>//    set productname to "Visual DataFlex"
59401>>>>>//    set version to "version 4.0"
59401>>>>>//    set copyright to "Copyright 1997 Data Access Corporation"
59401>>>>>//    set author to ""
59401>>>>>//    set logo to "ablogo.bmp"  // square bitmaps of 42x42 work best
59401>>>>>//End_Object
59401>>>>>
59401>>>>>//Procedure Activate_About
59401>>>>>//   Send Popup_Modal To (About_Dialog (Current_Object))
59401>>>>>//End_Procedure
59401>>>
59401>>>// *************************************************************************
59401>>>//  Public message. This is the default message. It is expected that you will
59401>>>//   create your own message to override this
59401>>>// *************************************************************************
59401>>>
59401>>>Procedure Activate_About
59403>>>   Send DoAbout "" "" "" "" "" ""
59404>>>End_Procedure
59405>>>
59405>>>// *************************************************************************
59405>>>//  Public message. It is expected that you will send this message (most
59405>>>//  likely from Activate_About. This creates an about object, activates it
59405>>>//  and destroys it when done. It is not exepected that you will augment this.
59405>>>// *************************************************************************
59405>>>
59405>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
59407>>>        Local integer hoObj hoMain
59408>>>
59408>>>        // create object
59408>>>        Object About is an AboutDialog
59410>>>            // if no title passed use the label of the main panel
59410>>>            // (if a main panel exists).
59410>>>            if sTitle     eq '' Begin
59412>>>                Get Main_Window to hoMain
59413>>>                if hoMain Get Label of hoMain to sTitle
59416>>>            end
59416>>>>
59416>>>            set productname to sTitle
59417>>>            set version     to sVersion
59418>>>            set copyright   to sCopyRight
59419>>>            set author      to sAuthor
59420>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
59423>>>            Move Current_Object to hoObj // object Id
59424>>>        End_Object
59425>>>        Send Popup to hoObj    // popup the about object
59426>>>        Send Request_Destroy_Object to hoObj // when done, it will be destroyed
59427>>>End_procedure
59428>    //AB-PanelStoreEnd
59428>
59428>
59428>End_Object
59429>
59429>
59429>//AB-StoreStart
59429>
59429>Start_UI
59430>
59430>
59430>
59430>
59430>//AB-StoreEnd
59430>
59430>
Summary
Memory Available: 2147483647
Total Errors   : 0
Total Symbols  : 28739
Total Resources: 0
Total Commands : 59429
Total Windows  : 52
Total Pages    : 12
Static Data    : 421793
Message area   : 359379
Total Blocks   : 19220
