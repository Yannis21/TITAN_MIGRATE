//AB/ Project vwMyf
//AB/     Object prj is a View_Project
//AB/         Set ProjectName to "vwMyf"
//AB/         Set ProjectFileName to "vwMyf.VW"
//AB/         Set GenerateFileName to "NONAME"

// Project Object Structure
//   vwMyf is a dbViewSubS
//     Company_DD is a DataDictionary
//     Branch_DD is a DataDictionary
//     Tmpmyf_DD is a DataDictionary
//     Tmpmyfa_DD is a DataDictionary
//     frmEtosMyf is a FormSub
//     Branch_Branch_Name is a dbFormSub
//     btnMakeTemp is a ButtonSub
//     chk1 is a CheckBoxSub
//     btnMakeAscii is a ButtonSub
//     frmMessage is a ButtonSub
//     dbTabDialogSView1 is a dbTabDialogSView
//       dbTabView1 is a dbTabView
//         Tmpmyf_DD is a DataDictionary
//         Tmpmyf_Myf_year is a dbFormSub
//         Tmpmyf_R1_Doy is a dbFormSub
//         Tmpmyf_R1_Ar_Fakel is a dbFormSub
//         Tmpmyf_R1_Eponymia is a dbFormSub
//         Tmpmyf_R1_Afm is a dbFormSub
//         Tmpmyf_R1_Antikeimeno is a dbFormSub
//         Tmpmyf_R1_Polh is a dbFormSub
//         Tmpmyf_R1_Odos is a dbFormSub
//         Tmpmyf_R1_Arithmos is a dbFormSub
//         Tmpmyf_R1_Tk is a dbFormSub
//         Tmpmyf_R1_Thlefono is a dbFormSub
//         Tmpmyf_R1_Fax is a dbFormSub
//         Tmpmyf_R1_Email is a dbFormSub
//         Tmpmyf_R1_Eidos is a dbFormSub
//         dHmniaPrev is a cSyDateForm
//         TextBoxSub17 is a TextBoxSub
//         LineControlSub1 is a LineControlSub
//         LineControlSub2 is a LineControlSub
//       dbTabView2 is a dbTabView
//         tmpMyf_DD2 is a tmpMyf_DataDictionary
//         Tmpmyf_DD is a DataDictionary
//         tmpMyf_ is a dbGridSub
//         tmpMyf_Rs_Plhthos is a dbFormSub
//         TextBoxSub1 is a TextBoxSub
//         TextBoxSub2 is a TextBoxSub
//         tmpMyf_Rs_axia is a dbFormSub
//       dbTabView3 is a dbTabView
//         tmpMyf_DD2 is a tmpMyf_DataDictionary
//         Tmpmyf_DD is a DataDictionary
//         tmpMyf_ is a dbGridSub
//         TextBoxSub3 is a TextBoxSub
//         TextBoxSub4 is a TextBoxSub
//         tmpMyf_Rs_Plhthos is a dbFormSub
//         tmpMyf_Rs_axia is a dbFormSub
//       dbTabView4 is a dbTabView
//         tmpMyf_DD2 is a tmpMyf_DataDictionary
//         Tmpmyf_DD is a DataDictionary
//         tmpMyf_ is a dbGridSub
//         tmpMyf_Rs_Plhthos is a dbFormSub
//         TextBoxSub5 is a TextBoxSub
//         TextBoxSub6 is a TextBoxSub
//         tmpMyf_Rs_axia is a dbFormSub
//       dbTabView5 is a dbTabView
//         tmpMyf_DD2 is a tmpMyf_DataDictionary
//         Tmpmyf_DD is a DataDictionary
//         tmpMyf_ is a dbGridSub
//         TextBoxSub7 is a TextBoxSub
//         TextBoxSub8 is a TextBoxSub
//         tmpMyf_Rs_Plhthos is a dbFormSub
//         tmpMyf_Rs_axia is a dbFormSub
//       dbTabView6 is a dbTabView
//         tmpMyf_DD2 is a tmpMyf_DataDictionary
//         Tmpmyf_DD is a DataDictionary
//         tmpMyf_ is a dbGridSub
//         tmpMyf_Rs_Plhthos is a dbFormSub
//         TextBoxSub9 is a TextBoxSub
//         TextBoxSub10 is a TextBoxSub
//         tmpMyf_Rs_axia is a dbFormSub
//       dbTabView7 is a dbTabView
//         tmpMyf_DD2 is a tmpMyf_DataDictionary
//         Tmpmyf_DD is a DataDictionary
//         tmpMyf_ is a dbGridSub
//         TextBoxSub11 is a TextBoxSub
//         TextBoxSub12 is a TextBoxSub
//         tmpMyf_Rs_Plhthos is a dbFormSub
//         tmpMyf_Rs_axia is a dbFormSub
//       dbTabView8 is a dbTabView
//         tmpMyf_DD2 is a tmpMyf_DataDictionary
//         Tmpmyf_DD is a DataDictionary
//         tmpMyf_ is a dbGridSub
//         tmpMyf_Rs_Plhthos is a dbFormSub
//         TextBoxSub13 is a TextBoxSub
//         TextBoxSub14 is a TextBoxSub
//         tmpMyf_Rs_axia is a dbFormSub
//       dbTabView9 is a dbTabView
//         tmpMyf_DD2 is a tmpMyf_DataDictionary
//         Tmpmyf_DD is a DataDictionary
//         tmpMyf_ is a dbGridSub
//         TextBoxSub15 is a TextBoxSub
//         TextBoxSub16 is a TextBoxSub
//         tmpMyf_Rs_Plhthos is a dbFormSub
//         tmpMyf_Rs_axia is a dbFormSub
//     btnPrint is a ButtonSub
//     btnPrint2 is a ButtonSub
//     btnMakeAscii is a ButtonSub
//     Rpt1_Report is a CrystalReportSubSQL
//     Rpt2_Report is a CrystalReportSubSQL

// Register all objects
Register_Object Branch_Branch_Name
Register_Object Branch_DD
Register_Object btnMakeAscii
Register_Object btnMakeTemp
Register_Object btnPrint
Register_Object btnPrint2
Register_Object Company_DD
Register_Object chk1
Register_Object dbTabDialogSView1
Register_Object dbTabView1
Register_Object dbTabView2
Register_Object dbTabView3
Register_Object dbTabView4
Register_Object dbTabView5
Register_Object dbTabView6
Register_Object dbTabView7
Register_Object dbTabView8
Register_Object dbTabView9
Register_Object dHmniaPrev
Register_Object frmEtosMyf
Register_Object frmMessage
Register_Object LineControlSub1
Register_Object LineControlSub2
Register_Object Rpt1_Report
Register_Object Rpt2_Report
Register_Object TextBoxSub1
Register_Object TextBoxSub10
Register_Object TextBoxSub11
Register_Object TextBoxSub12
Register_Object TextBoxSub13
Register_Object TextBoxSub14
Register_Object TextBoxSub15
Register_Object TextBoxSub16
Register_Object TextBoxSub17
Register_Object TextBoxSub2
Register_Object TextBoxSub3
Register_Object TextBoxSub4
Register_Object TextBoxSub5
Register_Object TextBoxSub6
Register_Object TextBoxSub7
Register_Object TextBoxSub8
Register_Object TextBoxSub9
Register_Object Tmpmyf_DD
Register_Object Tmpmyf_Myf_year
Register_Object Tmpmyf_R1_Afm
Register_Object Tmpmyf_R1_Antikeimeno
Register_Object Tmpmyf_R1_Ar_Fakel
Register_Object Tmpmyf_R1_Arithmos
Register_Object Tmpmyf_R1_Doy
Register_Object Tmpmyf_R1_Eidos
Register_Object Tmpmyf_R1_Email
Register_Object Tmpmyf_R1_Eponymia
Register_Object Tmpmyf_R1_Fax
Register_Object Tmpmyf_R1_Odos
Register_Object Tmpmyf_R1_Polh
Register_Object Tmpmyf_R1_Thlefono
Register_Object Tmpmyf_R1_Tk
Register_Object Tmpmyfa_DD
Register_Object tmpMyf_
Register_Object tmpMyf_DD2
Register_Object tmpMyf_Rs_axia
Register_Object tmpMyf_Rs_Plhthos
Register_Object vwMyf


//AB/     AppBuild VIEW


    //AB-StoreTopStart
    
    Open SyscurXR
    Open syscurXr
    Open Clients
    Open Psxetika
    Open Cities
    Open Ptyppar
    Open Particle
    Open ParticlL
    Open Ptyppar
    Use Keimeno.dg
    Use For_All
    
    //AB-StoreTopEnd

    //AB-IgnoreStart

    Use dbView.Sub
    Use DFAllEnt.pkg
    Use Form.Sub
    Use dbForm.Sub
    Use Button.Sub
    Use Chkbox.Sub
    Use cSyDateForm.Pkg
    Use Txtbox.Sub
    Use Line.Sub
    Use dbGrid.Sub

    Use COMPANY.DD
    Use BRANCH.DD
    Use tmpMyf.DD
    Use tmpMyfA.DD
    
    //AB-IgnoreEnd

    ACTIVATE_VIEW Activate_vwMyf FOR vwMyf

    Object vwMyf is a dbViewSubS

        //AB-StoreTopStart
        
        Property Integer    piSelection Public 0
        Property Integer    piOrderBy   Public 0
        Property Date       pdHmniaApo  Public ''
        Property Date       pdHmniaEos  Public ''
        Property Integer    piEnop      Public 1
        Property Integer    piMyfYear       Public 0
        Property Integer    piLathi         Public 0
        Property Integer    piStamata       Public 0
        Property Number     pnAxiaKan       Public 0
        Property Number     pnAxiaDhm       Public 0
        Property Number     pnAxiaTotal     Public 0
        Property Number     piPlhthosKan    Public 0
        Property Number     piPlhthosDhm    Public 0
        Property Number     piPlhthosTotal  Public 0
        Property String     psBranch        Public ''
        
        
        Function Check_Afm_Local String Afm_Num Returns Integer
            Integer iii Num1 Num2
        
            Move (Trim(Afm_Num)) To Afm_Num
        
            For iii From 1 To (Length(Trim(Afm_Num)))
                If Not (Mid(Afm_Num,1,iii)) In  "0123456789" Function_Return 3
            Loop
        
            Move (Right(Afm_Num,1)) to Num2
        
            If (Length(Afm_Num)<>9) Function_Return 2
        
            Move 0 to Num1
        
            For iii From 1 to 8
                Add ((Mid(Afm_Num,1,iii)) * (2 ^ (9 - iii))) to Num1
            Loop
        
            Move (Mod(Num1,11)) to Num1
            If (Num1=10) Move 0 to Num1
        
            If (Num1=Num2)  Function_Return 0
            Else            Function_Return 1
        End_Function
        
        Function Validate_AFM2 String asAFM Returns Integer
            Function_Return (Check_AFM_Local(Self,asAFM))
        End_Function
        
        
        Function fiEinaiAkyromeno String asRecr returns Integer
            String  sStr sStr1
            Integer isFound
            Move '' to sStr
        
            Move 0 to isFound
        
            Clear Psxetika
            Move asRecr to Psxetika.Partl_Recr
            Find Gt Psxetika By Index.4
            While ((Found) And (Psxetika.Partl_Recr=asRecr))
                Move Psxetika.Psx_Partl_Recr to sStr
                Find Gt Psxetika By Index.4
            Loop
            // Kratame to teleytaio giati theoroume pos to recr tou parastatikou akyroshs
            // tha einai to teleytaio (1.DAP / 2.TIM / 3.EAS-TIM)
        
            // Epanatopothethsh
            Clear Particle
            Move (Trim(asRecr)) to Particle.Partl_Recr
            Find Eq Particle By Index.2
        
            Clear ParticlL
            Move (Trim(sStr)) to ParticlL.Partl_Recr
            Find Eq ParticlL By Index.2
            If (Found) Begin
                Clear PtypparL
                Move (Trim(ParticlL.Ptyppar_Recr))  to PtypparL.Ptyppar_Recr
                Find Eq PtypparL By Index.2
                If (Found) Begin
                    Move (Trim(PtypparL.Sub)) to sStr1
                    Function_Return (Trim(sStr1)='1')
                End
            End
            Function_Return 0
        End_Function
        
        //‚ ˜ ¤˜ £§¦¨¦ç£œ ¤˜ Ÿ¬£æ£˜©«œ «  šå¤œ«˜  ¡˜  §éª
        /////////////////////////////////////////////////////////////////////////
        ///// ¨ ©£¦å «à¤ '’ç§à¤ record' §¦¬ Ÿ˜ ®¨© £¦§¦ ã©œ  «¦ §¨æš¨˜££˜ /////
        ///// ¡˜  §œ¨ š¨˜­ «ª ¢¦š ¡ãª ¡˜  «¦¬ ®œ ¨ ©£¦ç ˜¬«é¤ «à¤ record  /////
        /////////////////////////////////////////////////////////////////////////
        // Typos 0 =    1 £æ¤¦ œšš¨˜­ã  ¦§¦å˜ ›£ ¦¬¨šœå«˜ 
        //              ©«¤ ¦¨ ©« ¡¦§¦å© & œ¥˜šàšã ©œ ASCII
        // Typos 1 =    1 £æ¤¦ œšš¨˜­ã £œ «˜ œ«˜ ¨ ¡á ©«¦ ®œå˜
        //              ƒ£ ¦¬¨šœå«˜  ˜§¦ «¤ function fiMake_Record_1
        //////////////////////////////////////////////////////////////////////////////////////////////////////
        /////////// „›à Š„‘ ¦  œšš¨˜­âª šå¤¦¤«˜  £œ module '01' /////////////////////
        /////////////////////////////////////////////////////////////////////////////////////////////////////
        // Typos 2 =    ¦¢¢âª œšš¨˜­âª «ç§¦¬ 2 ˜§¦ « ª §à¢ã©œ ª
        //              ˜Ÿ¨¦ ©« ¡á ˜¤˜ §œ¢á«. ‘«¦ ©«á› ¦ ˜¬«æ ƒ„Œ ¥â¨¦¬£œ ˜¡æ£˜
        //              ˜¤ Ÿ˜ §¨¦¡ç¯œ  ¦ §œ¢á«ª ®¨œà©« ¡æª ã § ©«à« ¡æª. ’¦ ¥â¨¦¬£œ
        //              £æ¤¦ ©«¦ «â¢¦ª ˜¬«¦ç «ª œ§œ¥œ¨š˜©å˜ª.
        //              ƒ£ ¦¬¨š¦ç¤«˜  ˜§¦ «¤ function fiMake_Record_2,  ¦§¦å˜
        //              §˜¨á¢¢¢˜ ­« á®¤œ  ¡˜  « ª œšš¨˜­âª «ç§¦¬ 12 §¦¬ œå¤˜ 
        //              š ˜ §œ¢á«œª ®˜¨˜¡«¨ ©£â¤¦  ©˜¤ ƒ£æ© ¦ €Œ„“ €”‹.
        //              €¬«¦å ¦  §œ¢á«œª ˜Ÿ¨¦å¦¬¤ ‹Œ «¤ ˜¥å˜ «à¤ « £¦¢¦šåà¤ «¦¬ª
        //              ¡˜  ¦®  «¦ §¢ãŸ¦ª «à¤ §˜¨˜©«˜« ¡é¤ «¦¬ª.
        //              ‘«¦ «â¢¦ª «ª › ˜› ¡˜©å˜ª šå¤œ«˜  › ˜®à¨ ©£æª ®¨œà©« ¡é¤
        //              ¡˜  § ©«à« ¡é¤ §œ¢˜«é¤, æ§àª œ§å©ª ¡˜  ®¨œà©« ¡é¤ ã
        //              § ©«à« ¡é¤ ƒ£¦©å¦¬, €ŠŠ€…Œ’€‘ §¨æ©£¦ ©«¦¤ ã›
        //              ›£ ¦¬¨š£â¤¦ «ç§¦ record («¦ 2 šå¤œ«˜  -2 & «¦ 12 šå¤œ«˜  -12).
        // Typos 3 =    1 £æ¤¦ œšš¨˜­ã £œ «˜ ‘ç¤¦¢˜ §à¢ã©œà¤ •„—‘’ˆ‰—Œ §œ¢˜«é¤
        //               ¦§¦å˜ ƒ„Œ §œ¨ â®œ  «˜ ©ç¤¦¢˜ •¨œà©« ¡é¤ ƒ£¦©å¦¬
        //              ƒ£ ¦¬¨šœå«˜  ˜§¦ «¤ function fiMake_Record_3
        //              „§å©ª  å› ˜ function ›£ ¦¬¨šœå :
        //              ˜) 1 œšš¨˜­ã «ç§¦¬ -3  £œ «˜ ©ç¤¦¢˜ ©«¦¬ª  ©«à« ¡¦çª §œ¢á«œª.
        //              ™) 1 œšš¨˜­ã «ç§¦¬  13 £œ «˜ ©ç¤¦¢˜ ©«¦¬ª •¨œà©« ¡¦çª ƒ£¦©å¦¬.
        //              š) 1 œšš¨˜­ã «ç§¦¬ -13 £œ «˜ ©ç¤¦¢˜ ©«¦¬ª  ©«à« ¡¦çª ƒ£¦©å¦¬.
        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        /////////// €§¦ œ›à ¡˜  ¡á«à Š„‘ ¦  œšš¨˜­âª šå¤¦¤«˜  £œ module '02' /////////////////////
        ///////////         £œ «¦¬ª å› ¦¬ª æ£àª ¡à› ¡¦çª '’ç§à¤ œšš¨˜­é¤            /////////////////////
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        // Typos 4 =    ¦¢¢âª œšš¨˜­âª «ç§¦¬ 2 ˜§¦ « ª ˜š¦¨âª
        //              ˜Ÿ¨¦ ©« ¡á ˜¤˜ §¨¦£Ÿœ¬«ã. ‘«¦ ©«á› ¦ ˜¬«æ ƒ„Œ ¥â¨¦¬£œ ˜¡æ£˜
        //              ˜¤ Ÿ˜ §¨¦¡ç¯œ  ¦ §¨¦£Ÿœ¬«ãª ®¨œà©« ¡æª ã § ©«à« ¡æª.
        //              ’¦ ¥â¨¦¬£œ £æ¤¦ ©«¦ «â¢¦ª ˜¬«¦ç «ª œ§œ¥œ¨š˜©å˜ª.
        //              ƒ£ ¦¬¨š¦ç¤«˜  ˜§¦ «¤ function fiMake_Record_4,  ¦§¦å˜
        //              §˜¨á¢¢¢˜ ­« á®¤œ  ¡˜  « ª œšš¨˜­âª «ç§¦¬ 12 §¦¬ œå¤˜ 
        //              š ˜ §¨¦£Ÿœ¬«âª ®˜¨˜¡«¨ ©£â¤¦  ©˜¤ ƒ£æ© ¦ €Œ„“ €”‹.
        //              €¬«¦å ¦  §¨¦£Ÿœ¬«âª ˜Ÿ¨¦å¦¬¤ ‹Œ «¤ ˜¥å˜ «à¤ « £¦¢¦šåà¤
        //              «¦¬ª ¡˜  ¦®  «¦ §¢ãŸ¦ª «à¤ §˜¨˜©«˜« ¡é¤ «¦¬ª.
        //              ‘«¦ «â¢¦ª «ª › ˜› ¡˜©å˜ª šå¤œ«˜  › ˜®à¨ ©£æª ®¨œà©« ¡é¤
        //              ¡˜  § ©«à« ¡é¤ §¨¦£Ÿœ¬«âª, æ§àª œ§å©ª ¡˜  ®¨œà©« ¡é¤ ã
        //              § ©«à« ¡é¤ ƒ£¦©å¦¬, €ŠŠ€…Œ’€‘ §¨æ©£¦ ©«¦¤ ã›
        //              ›£ ¦¬¨š£â¤¦ «ç§¦ record («¦ 2 šå¤œ«˜  -2 & «¦ 12 šå¤œ«˜ -12).
        // Typos 5 =    1 £æ¤¦ œšš¨˜­ã £œ «˜ ‘ç¤¦¢˜ €š¦¨é¤ •„—‘’ˆ‰—Œ §¨¦£Ÿœ¬«é¤
        //               ¦§¦å˜ ƒ„Œ §œ¨ â®œ  «˜ ©ç¤¦¢˜  ©«à« ¡é¤ ƒ£¦©å¦¬
        //              ƒ£ ¦¬¨šœå«˜  ˜§¦ «¤ function fiMake_Record_5.
        //              „§å©ª  å› ˜ function ›£ ¦¬¨šœå :
        //              ˜) 1 œšš¨˜­ã «ç§¦¬ -3  £œ «˜ ©ç¤¦¢˜ ©«¦¬ª  ©«à« ¡¦çª §¨¦£Ÿœ¬«âª.
        //              ™) 1 œšš¨˜­ã «ç§¦¬  13 £œ «˜ ©ç¤¦¢˜ ©«¦¬ª •¨œà©« ¡¦çª ƒ£¦©å¦¬.
        //              š) 1 œšš¨˜­ã «ç§¦¬ -13 £œ «˜ ©ç¤¦¢˜ ©«¦¬ª  ©«à« ¡¦çª ƒ£¦©å¦¬.
        
        Function fiMake_Record_1 Returns Integer
            Integer iMyfYear iInt iPos
            String  sOdos sArithmos sAddr
        
            Clear Branch
            Move SyscurXr.Company_Code  to Branch.Company_Code
            Move SyscurXr.Branch_Code   to Branch.Branch_Code
            Find Eq Branch By Index.1
            Relate Branch
        
            Clear tmpMyf
            Move SyscurXr.Company_Code  to tmpMyf.Company_Code
            Move SyscurXr.Branch_Code   to tmpMyf.Branch_Code
            Move (piMyfYear(Self))      to tmpMyf.Myf_Year
            Move ''                     to tmpMyf.Module
            Move  1                     to tmpMyf.Typos_Record
        
            Move Branch.Branch_DOY      to tmpMyf.R1_Doy
            //Move Branch.??????????      to tmpMyf.R1_Ar_Fakel
            Move Company.Company_Name   to tmpMyf.R1_Eponymia
            Move Branch.Branch_AFM      to tmpMyf.R1_Afm
            Move (gsfCode_Mast('JOB',Branch.Branch_J_Code)) ;
                                        to tmpMyf.R1_Antikeimeno
            Move Branch.Branch_Poli     to tmpMyf.R1_Polh
        
            Move Branch.Branch_Addr     to sAddr
            Move (Trim(sAddr))          to sAddr
            For iInt From 1 to (Length(sAddr))
                If (Mid(sAddr,1,iInt)=' ') Move iInt to iPos
            Loop
            If (iPos) Begin
                Move (Left(sAddr,(iPos-1)))                 to sOdos
                Move (Right(sAddr,(Length(sAddr)-iPos)))    to sArithmos
            End
            Else Move (Trim(sAddr)) to sOdos
        
            Move (Trim(sOdos))          to tmpMyf.R1_Odos
            Move (Trim(sArithmos))      to tmpMyf.R1_Arithmos
            Move Branch.Branch_TK       to tmpMyf.R1_TK
            Move (Replaces(' ',tmpMyf.R1_TK,'')) ;
                                        to tmpMyf.R1_TK
            Move Branch.Branch_Tel      to tmpMyf.R1_Thlefono
            Move Branch.Branch_Fax      to tmpMyf.R1_Fax
            Move Branch.Branch_Email    to tmpMyf.R1_Email
            Move '„'                    to tmpMyf.R1_Eidos // ???????
        
            Move 1 to tmpMyf.aa
            Saverecord tmpMyf
        
            Function_Return 1
        End_Function
        
        Function fiMake_Record_2 Returns Integer
            Integer iInt iPos iPlhthosKan iPlhthosDhm iPlhthosTotal isOK isAkyro
            String  sAddr sArithmos sOdos sPar
            Number  nPoso nAxiaKan nAxiaDhm nAxiaTotal nNum
            Date    dHmniaApo dHmniaEos
            Move 0 to nNum
        
            Set piStamata   to 0
            Set piLathi     to 0
        
            //////////////////////////////////////////////////////////////
            // 30/09/2005 Beltiosh tou kodika gia ton elegxo ton duplicate
            //////////////////////////////////////////////////////////////
        
            Send Ignore_Error to Error_Info_Object 28 // Apenergopoioume to Error 28 'Duplicate....'
        
            Direct_Output Channel 7 "C:\ErrMyf2.log"
            Writeln Channel 7 '--------------------------------------------'
            Writeln Channel 7 '‘­á¢£˜«˜ œ¢˜«é¤'
            Writeln Channel 7 '--------------------------------------------'
            //////////////////////////////////////////////////////////////
        
            Clear Ptyppar
            Find Gt Ptyppar.Recnum
            While (Found)
                // Ptyppar_Year_Recr=1  Thetika     sth MYF
                // Ptyppar_Year_Recr=2  Arnhtika    sth MYF
                If (((Trim(Ptyppar.Year_Recr)='1') Or (Trim(Ptyppar.Year_Recr)='2')) And (Ptyppar.Ptyppar_Module='01')) Begin
        
                    If (psBranch(Self)<>'') Begin
                        Clear Particle
                        Move SyscurXr.Company_Code  to Particle.Company_Code
                        Move (psBranch(Self))       to Particle.Branch_Code
                        Move (piMyfYear(Self))      to Particle.Year_Year
                        Move '01'                   to Particle.Partl_Module
                        Move Ptyppar.Ptyppar_Recr   to Particle.Ptyppar_Recr
                        Find Gt Particle By Index.12
                        While ((Found) And (Particle.Company_Code=SyscurXr.Company_Code) And (Particle.Branch_Code=(psBranch(Self))) And ;
                                           (Particle.Year_Year=(piMyfYear(Self))) And (Particle.Partl_Module='01') And (Particle.Ptyppar_Recr=Ptyppar.Ptyppar_Recr))
        
                            Set Label Of frmMessage to ('à¢ã©œ ª '+Trim(Ptyppar.Ptyppar_ABREV)+' '+String(Particle.Recnum))
        
                            If ((Particle.Partl_Totamad>Sysfile.Orio_Myf) And (Particle.Partl_No>0)) Begin
        
                                // Ta akyrotika den symetexoun sthn MYF ex orismou apo to ptyppar tous
                                // Ta timologio & ta Pistotika prepei na elgxontai etsi oste ta psxetika tous
                                // NA MHN einai akyrotika
                                Get fiEinaiAkyromeno Particle.Partl_Recr to isAkyro
        
                                If (NOT(isAkyro)) Begin
        
                                    Clear Clients
                                    Move Particle.Client_ID to Clients.Client_ID
                                    Find Eq Clients By Index.6
                                    If (Not(Found)) Begin
                                        Pause 24 00 '‹œš ©«¦ §¨æ™¢£˜'
                                        Function_Return -100
                                    End
                                    ///////
        
                                    //////////////////////////////////////////////////////////////
                                    // 30/09/2005 Beltiosh tou kodika gia ton elegxo ton duplicate
                                    ////////////////////// START /////////////////////////////////
        
                                    If (piEnop(Self)=0) Begin
                                        Clear tmpMyf
                                        Move (piMyfYear(Self))      to tmpMyf.Myf_Year
                                        Move '01'                   to tmpMyf.Module
                                        // An einai pelaths Dhmosiou xoris afm tote
                                        // DEN kanei eggrafh typou 2 alla eggrafh typoy 12
                                        If (Clients.Custprom_Code='1') ;
                                             Move 12                to tmpMyf.Typos_Record
                                        Else Move  2                to tmpMyf.Typos_Record
        
                                        Move Clients.Client_Afm     to tmpMyf.Afm
                                        Find Eq tmpMyf By Index.6
                                        If ((Found) And (Clients.Client_ID<>tmpMyf.Client_ID)) Begin
                                            Set piLathi to (piLathi(Self)+1)
                                            Write   Channel 7 '”¦¨â˜ª: ' (Trim(Clients.Client_ID)) '      '
                                            Write   Channel 7 (Trim(Clients.Client_Name))
                                            Write   Channel 7 '  ’¦ €”‹ «¦¬ => ' (Trim(Clients.Client_Afm)) ' <= œ£­˜¤åœ«˜  œ§å©ª ©«¦¤ ­¦¨â˜  ' (Trim(tmpMyf.Client_ID)) '    '
                                            Write   Channel 7 (Trim(tmpMyf.Client_Name))
                                            Writeln Channel 7
                                            Break
                                        End
                                    End
        
                                    //////////////////////////////////////////////////////////////
                                    // 30/09/2005 Beltiosh tou kodika gia ton elegxo ton duplicate
                                    /////////////////////// END //////////////////////////////////
        
                                    Clear tmpMyf
                                    Lock
                                    Move (piMyfYear(Self))      to tmpMyf.Myf_Year
                                    Move '01'                   to tmpMyf.Module
                                    // An einai pelaths Dhmosiou xoris afm tote
                                    // DEN kanei eggrafh typou 2 alla eggrafh typoy 12
                                    If (Clients.Custprom_Code='1') ;
                                         Move 12                to tmpMyf.Typos_Record
                                    Else Move  2                to tmpMyf.Typos_Record
            //                            Move Cmoves.Client_ID       to tmpMyf.Client_ID
            //                            Find Eq tmpMyf By Index.2
                                    If ((Check_Afm_Local(Self,Clients.Client_AFM)<>0) And (piEnop(Self)=0)) Begin
                                        Move Particle.Client_ID     to tmpMyf.Client_ID
                                        Find Eq tmpMyf By Index.2
                                        Move Particle.Client_ID     to tmpMyf.AFM
                                    End
                                    Else Begin
                                        Move Clients.Client_AFM     to tmpMyf.AFM
                                        Find Eq tmpMyf By Index.6
                                        Move Particle.Client_ID     to tmpMyf.Client_ID
                                    End
        
                                    If (Clients.Custprom_Code='1') ;
                                         Move 12                to tmpMyf.Typos_Record
                                    Else Move  2                to tmpMyf.Typos_Record
        
                                    Move SyscurXr.Company_Code              to tmpMyf.Company_Code
                                    Move (psBranch(Self))                   to tmpMyf.Branch_Code
                                    Move Clients.Client_AFM                 to tmpMyf.AFM
                                    Move Clients.Client_ID                  to tmpMyf.Client_ID
                                    Move Clients.Client_Name                to tmpMyf.Client_Name
                                    Move (gsfCode_Mast('JOB',Clients.Client_Job)) ;
                                                                            to tmpMyf.Job
                                    If (Clients.Custprom_Recr='1') Move '1' to tmpMyf.Ypoxreos
                                    Else                           Move '0' to tmpMyf.Ypoxreos
        
                                    Add 1                                   to tmpMyf.Plhthos
        
                                    If (Trim(Ptyppar.Year_Recr)='2') ;
                                         Add (Particle.Partl_Totamad*(-1))  to tmpMyf.Axia
                                    Else Add  Particle.Partl_Totamad        to tmpMyf.Axia
        
                                    Clear Cities
                                    Move Clients.Client_City_ID to Cities.City_ID
                                    Find Eq Cities By Index.1
                                    Move Cities.City_Descr      to tmpMyf.Polh
        
                                    Move Clients.Client_Address to sAddr
                                    Move (Trim(sAddr))          to sAddr
                                    For iInt From 1 to (Length(sAddr))
                                        If (Mid(sAddr,1,iInt)=' ') Move iInt to iPos
                                    Loop
                                    If (iPos) Begin
                                        Move (Left(sAddr,(iPos-1)))                 to sOdos
                                        Move (Right(sAddr,(Length(sAddr)-iPos)))    to sArithmos
                                    End
                                    Else Move (Trim(sAddr))     to sOdos
        
                                    Move (Trim(sOdos))          to tmpMyf.Odos
                                    Move (Trim(sArithmos))      to tmpMyf.Arithmos
                                    Move Clients.Client_ZipCode to tmpMyf.TK
                                    Move (Replaces(' ',tmpMyf.TK,'')) ;
                                                                to tmpMyf.TK
        
                                    If (Clients.Custprom_Code='1') ;
                                         Move 6                 to tmpMyf.AA
                                    Else Move 2                 to tmpMyf.AA
        
                                    Get Validate_AFM2 tmpMyf.AFM  to isOK
                                    Move isOK to tmpMyf.Wrong_AFM
        
                                    Saverecord tmpMyf
                                    Unlock
        
                                End //if (Not(isAkyro))
                            End
                            Find Gt Particle By Index.12
                        Loop
                    End
                    Else Begin
                        Clear Particle
                        Move SyscurXr.Company_Code  to Particle.Company_Code
                        Move (piMyfYear(Self))      to Particle.Year_Year
                        Move '01'                   to Particle.Partl_Module
                        Move Ptyppar.Ptyppar_Recr   to Particle.Ptyppar_Recr
                        Find Gt Particle By 16
                        While ((Found) And (Particle.Company_Code=SyscurXr.Company_Code) And ;
                                           (Particle.Year_Year=(piMyfYear(Self))) And (Particle.Partl_Module='01') And (Particle.Ptyppar_Recr=Ptyppar.Ptyppar_Recr))
        
                            Set Label Of frmMessage to ('à¢ã©œ ª '+Trim(Ptyppar.Ptyppar_ABREV)+' '+String(Particle.Recnum))
        
                            Get fiEinaiAkyromeno Particle.Partl_Recr to isAkyro
                            If (NOT(isAkyro)) Begin
        
                                If ((Particle.Partl_Totamad>Sysfile.Orio_Myf) And (Particle.Partl_No>0)) Begin
        
                                    Clear Clients
                                    Move Particle.Client_ID to Clients.Client_ID
                                    Find Eq Clients By Index.6
                                    If (Not(Found)) Begin
                                        Pause 24 00 '‹œš ©«¦ §¨æ™¢£˜'
                                        Function_Return -100
                                    End
                                    ///////
        
                                    //////////////////////////////////////////////////////////////
                                    // 30/09/2005 Beltiosh tou kodika gia ton elegxo ton duplicate
                                    ////////////////////// START /////////////////////////////////
                                    If (piEnop(Self)=0) Begin
                                        Clear tmpMyf
                                        Move (piMyfYear(Self))      to tmpMyf.Myf_Year
                                        Move '01'                   to tmpMyf.Module
                                        // An einai pelaths Dhmosiou xoris afm tote
                                        // DEN kanei eggrafh typou 2 alla eggrafh typoy 12
                                        If (Clients.Custprom_Code='1') ;
                                             Move 12                to tmpMyf.Typos_Record
                                        Else Move  2                to tmpMyf.Typos_Record
                                        Move Clients.Client_Afm     to tmpMyf.Afm
                                        Find Eq tmpMyf By Index.6
                                        If ((Found) And (Clients.Client_ID<>tmpMyf.Client_ID)) Begin
                                            Set piLathi to (piLathi(Self)+1)
                                            Write   Channel 7 '”¦¨â˜ª: ' (Trim(Clients.Client_ID)) '      '
                                            Write   Channel 7 (Trim(Clients.Client_Name))
                                            Write   Channel 7 '  ’¦ €”‹ «¦¬ => ' (Trim(Clients.Client_Afm)) ' <= œ£­˜¤åœ«˜  œ§å©ª ©«¦¤ ­¦¨â˜  ' (Trim(tmpMyf.Client_ID)) '    '
                                            Write   Channel 7 (Trim(tmpMyf.Client_Name))
                                            Writeln Channel 7
                                            Break
                                        End
                                    End
                                    //////////////////////////////////////////////////////////////
                                    // 30/09/2005 Beltiosh tou kodika gia ton elegxo ton duplicate
                                    /////////////////////// END //////////////////////////////////
        
        
                                    Clear tmpMyf
                                    Lock
                                    Move (piMyfYear(Self))      to tmpMyf.Myf_Year
                                    Move '01'                   to tmpMyf.Module
                                    // An einai pelaths Dhmosiou xoris afm tote
                                    // DEN kanei eggrafh typou 2 alla eggrafh typoy 12
                                    If (Clients.Custprom_Code='1') ;
                                         Move 12                to tmpMyf.Typos_Record
                                    Else Move  2                to tmpMyf.Typos_Record
        
                                    //Move Particle.Client_ID     to tmpMyf.Client_ID
                                    //Find Eq tmpMyf By Index.2
                                    // jsjsjs 15/09/2004 allagh gia enopoihsh pollaplon afm
                                    If ((Check_Afm_Local(Self,Clients.Client_AFM)<>0) And ;
                                        (piEnop(Self)=0)) Begin
                                        Move Particle.Client_ID     to tmpMyf.Client_ID
                                        Find Eq tmpMyf By Index.2
                                        Move Particle.Client_ID     to tmpMyf.AFM
                                    End
                                    Else Begin
                                        Move Clients.Client_AFM     to tmpMyf.AFM
                                        Find Eq tmpMyf By Index.6
                                        Move Particle.Client_ID     to tmpMyf.Client_ID
                                    End
        
                                    If (Clients.Custprom_Code='1') ;
                                         Move 12                to tmpMyf.Typos_Record
                                    Else Move  2                to tmpMyf.Typos_Record
        
                                    Move SyscurXr.Company_Code              to tmpMyf.Company_Code
                                    Move (psBranch(Self))                   to tmpMyf.Branch_Code
                                    Move Clients.Client_AFM                 to tmpMyf.AFM
                                    Move Clients.Client_ID                  to tmpMyf.Client_ID
                                    Move Clients.Client_Name                to tmpMyf.Client_Name
                                    Move (gsfCode_Mast('JOB',Clients.Client_Job)) ;
                                                                            to tmpMyf.Job
                                    If (Clients.Custprom_Recr='1') Move '1' to tmpMyf.Ypoxreos
                                    Else                           Move '0' to tmpMyf.Ypoxreos
        
                                    Add 1                                   to tmpMyf.Plhthos
        
                                    If (Trim(Ptyppar.Year_Recr)='2') ;
                                         Add (Particle.Partl_Totamad*(-1))  to tmpMyf.Axia
                                    Else Add  Particle.Partl_Totamad        to tmpMyf.Axia
        
                                    Clear Cities
                                    Move Clients.Client_City_ID to Cities.City_ID
                                    Find Eq Cities By Index.1
                                    Move Cities.City_Descr      to tmpMyf.Polh
        
                                    Move Clients.Client_Address to sAddr
                                    Move (Trim(sAddr))          to sAddr
                                    For iInt From 1 to (Length(sAddr))
                                        If (Mid(sAddr,1,iInt)=' ') Move iInt to iPos
                                    Loop
                                    If (iPos) Begin
                                        Move (Left(sAddr,(iPos-1)))                 to sOdos
                                        Move (Right(sAddr,(Length(sAddr)-iPos)))    to sArithmos
                                    End
                                    Else Move (Trim(sAddr))     to sOdos
        
                                    Move (Trim(sOdos))          to tmpMyf.Odos
                                    Move (Trim(sArithmos))      to tmpMyf.Arithmos
                                    Move Clients.Client_ZipCode to tmpMyf.TK
                                    Move (Replaces(' ',tmpMyf.TK,'')) ;
                                                                to tmpMyf.TK
        
                                    //Move 2                      to tmpMyf.AA
        
                                    If (Clients.Custprom_Code='1') ;
                                         Move 6                 to tmpMyf.AA
                                    Else Move 2                 to tmpMyf.AA
        
                                    Get Validate_AFM2 tmpMyf.AFM  to isOK
                                    Move isOK to tmpMyf.Wrong_AFM
        
                                    Saverecord tmpMyf
        
                                    Unlock
                                End
                            End // If Not isAkyro
                            Find Gt Particle By 16
                        Loop
                    End
                End
        
                Find Gt Ptyppar.Recnum
            Loop
        
            //////////////////////////////////////////////////////////////
            // 30/09/2005 Beltiosh tou kodika gia ton elegxo ton duplicate
            //////////////////////////////////////////////////////////////
            Send Trap_Error to Error_Info_Object 28 // Energopoioume to Error 28 'Duplicate....'
        
            Close_Output Channel 7
            If (piLathi(Self)>0) Begin
                Set piStamata to 1
                Send Rebuild_All_Constraints
                Send Stop_Box '‡˜ œ£­˜¤å©à «é¨˜ «¤ ¢å©«˜ £œ §¨¦™¢ã£˜«˜ €”‹.\n† › ˜› ¡˜©å˜ Ÿ˜ «œ¨£˜« ©«œå œ›é' '‘­á¢£˜ 8000'
                Send Deixe_Ta_Lathi "C:\ErrMyf2.log"
                Procedure_Return
            End
            Else Begin
                Set piStamata to 0
                EraseFile "C:\ErrMyf2.log"
            End
            //////////////////////////////////////////////////////////////
        
        
            //
            // 08/09/2004
            //
            // Prosthikh kodika pou tha psaxnei ta cmoves me hard coded ctypkin gia
            // na prosthesei eggrafes pou eginan sta cmoves apografika gia tis kinhseis
            // pou proerxontai apo betogest kai pou eginan PRIN xekinhsei h timologhsh meso
            // parastatikon tou betolink enterprise (px sthn thessalonikh xekinhse h timologhsh
            // 01/06/2003, alla yparxoun kiniseis timologion kai pistotikon san flat cmoves kai
            // pou proerxontai apo ta timologia 02/01/2003 - 31/05/2003 tou betogest
            Integer iY
            Move (piMyfYear(Self)) to iY
            Get Value Of (dHmniaPrev(dbTabView1(dbTabDialogSView1(vwMyf(Self))))) Item 0 to dHmniaEos
            Set pdHmniaEos to dHmniaEos
            //Showln 'dHmniaEos=' dHmniaEos
            If (dHmniaEos<>'') Begin
                Set pdHmniaApo to (DateCompose(01,01,iY))
                //Showln 'pdHmniaApo=' (pdHmniaApo(Self)) '     dHmniaEos=' dHmniaEos
                Clear Cmoves
                Move (pdHmniaApo(Self)) to Cmoves.Cmoves_Hmnia
                Find GE Cmoves By Index.3
                While ((Found) And (Cmoves.Cmoves_Hmnia<pdHmniaEos(Self)))
                    Set Label Of frmMessage to ('€§¦ Betogest '+String(Cmoves.Recnum))
        
                    //Showln ' Searching Cmoves  OK'
                    If ((Cmoves.Ctypkin_Code='116') Or (Cmoves.Ctypkin_Code='121') Or (Cmoves.Ctypkin_Code='122')) Begin
        
                        //Showln ' Cmoves.Ctypkin_Code  OK'
                        If ( (psBranch(Self)='') Or (Cmoves.Branch_Code=psBranch(Self)) ) Begin
        
                            //Showln ' Branch  OK INSIDE LOOP'
        
        
                            Clear Clients
                            Move Cmoves.Client_ID to Clients.CLient_ID
                            Find Eq Clients By Index.6
                            If (NOT(Found)) Begin
                                Send Stop_Box ('ƒœ¤ ™¨âŸ¡œ ¦ §œ¢á«ª '+Trim(Clients.Client_ID)+'\n† › ˜› ¡˜©å˜ › ˜¡æ§«œ«˜ ') '‘­á¢£˜ 1500'
                                Procedure_Return
        
                                Clear tmpMyf
                                Lock
                                Move (piMyfYear(Self))      to tmpMyf.Myf_Year
                                Move '01'                   to tmpMyf.Module
                                // An einai pelaths Dhmosiou xoris afm tote
                                // DEN kanei eggrafh typou 2 alla eggrafh typoy 12
                                If (Clients.Custprom_Code='1') ;
                                     Move 12                to tmpMyf.Typos_Record
                                Else Move  2                to tmpMyf.Typos_Record
        
                                Move Cmoves.Client_ID       to tmpMyf.Client_ID
                                Find Eq tmpMyf By Index.2
                                //If (Found) Showln 'tmpmyf record found OK'
                                //Else        Showln 'tmpmyf record NOT FOUND'
                                Move SyscurXr.Company_Code              to tmpMyf.Company_Code
                                Move (psBranch(Self))                   to tmpMyf.Branch_Code
                                Move Clients.Client_AFM                 to tmpMyf.AFM
                                Move Clients.Client_ID                  to tmpMyf.Client_ID
                                Move Clients.Client_Name                to tmpMyf.Client_Name
                                Move (gsfCode_Mast('JOB',Clients.Client_Job)) ;
                                                                        to tmpMyf.Job
                                If (Clients.Custprom_Recr='1') Move '1' to tmpMyf.Ypoxreos
                                Else                           Move '0' to tmpMyf.Ypoxreos
        
                                Add 1                                   to tmpMyf.Plhthos
                                Add Cmoves.Cmove_TotamAd0               to tmpMyf.Axia
        
                                Clear Cities
                                Move Clients.Client_City_ID to Cities.City_ID
                                Find Eq Cities By Index.1
                                Move Cities.City_Descr      to tmpMyf.Polh
        
                                Move Clients.Client_Address to sAddr
                                Move (Trim(sAddr))          to sAddr
                                For iInt From 1 to (Length(sAddr))
                                    If (Mid(sAddr,1,iInt)=' ') Move iInt to iPos
                                Loop
                                If (iPos) Begin
                                    Move (Left(sAddr,(iPos-1)))                 to sOdos
                                    Move (Right(sAddr,(Length(sAddr)-iPos)))    to sArithmos
                                End
                                Else Move (Trim(sAddr))     to sOdos
        
                                Move (Trim(sOdos))          to tmpMyf.Odos
                                Move (Trim(sArithmos))      to tmpMyf.Arithmos
                                Move Clients.Client_ZipCode to tmpMyf.TK
                                Move (Replaces(' ',tmpMyf.TK,'')) ;
                                                            to tmpMyf.TK
        
                                If (Clients.Custprom_Code='1') ;
                                     Move 6                 to tmpMyf.AA
                                Else Move 2                 to tmpMyf.AA
        
                                Get Validate_AFM2 tmpMyf.AFM  to isOK
                                Move isOK to tmpMyf.Wrong_AFM
        
                                Saverecord tmpMyf
        
                                //Showln 'SAVING RECORD'
        
                                Unlock
                            End
                        End
                    End
                    Find Gt Cmoves By Index.3
                Loop
            End
            //
            // 08/09/2004
            //
        
        
            // Metatroph tou typou tou record gia Pelates pistotikous Kanonikous apo 2 se -2
            Clear tmpMyf
            Lock
            Move (piMyfYear(Self))  to tmpMyf.Myf_Year
            Move '01'               to tmpMyf.Module
            Move 2                  to tmpMyf.Typos_Record
            Find Gt tmpMyf By Index.2
            While ((Found) And (tmpMyf.Myf_Year=piMyfYear(Self))    And ;
                               (tmpMyf.Module='01')                 And ;
                               (tmpMyf.Typos_Record=2))
        
                If (tmpMyf.Axia<0) Begin
                    Clear tmpMyfA
                    Move tmpMyf.COMPANY_CODE        to tmpMyfA.COMPANY_CODE
                    Move tmpMyf.BRANCH_CODE         to tmpMyfA.BRANCH_CODE
                    Move tmpMyf.MYF_YEAR            to tmpMyfA.MYF_YEAR
                    Move tmpMyf.MODULE              to tmpMyfA.MODULE
                    Move -2                         to tmpMyfA.Typos_Record
                    Move tmpMyf.AA                  to tmpMyfA.AA
                    Move tmpMyf.AFM                 to tmpMyfA.AFM
                    Move tmpMyf.CLIENT_ID           to tmpMyfA.CLIENT_ID
                    Move tmpMyf.CLIENT_NAME         to tmpMyfA.CLIENT_NAME
                    Move tmpMyf.JOB                 to tmpMyfA.JOB
                    Move tmpMyf.YPOXREOS            to tmpMyfA.YPOXREOS
                    Move tmpMyf.POLH                to tmpMyfA.POLH
                    Move tmpMyf.ODOS                to tmpMyfA.ODOS
                    Move tmpMyf.ARITHMOS            to tmpMyfA.ARITHMOS
                    Move tmpMyf.TK                  to tmpMyfA.TK
                    Move tmpMyf.PLHTHOS             to tmpMyfA.PLHTHOS
                    Move (tmpMyf.AXIA*(-1))         to tmpMyfA.AXIA
                    Move tmpMyf.AGROTHS             to tmpMyfA.AGROTHS
                    Move tmpMyf.DHMOSIO_ANEY        to tmpMyfA.DHMOSIO_ANEY
                    Move tmpMyf.R1_DOY              to tmpMyfA.R1_DOY
                    Move tmpMyf.R1_AR_FAKEL         to tmpMyfA.R1_AR_FAKEL
                    Move tmpMyf.R1_EPONYMIA         to tmpMyfA.R1_EPONYMIA
                    Move tmpMyf.R1_AFM              to tmpMyfA.R1_AFM
                    Move tmpMyf.R1_ANTIKEIMENO      to tmpMyfA.R1_ANTIKEIMENO
                    Move tmpMyf.R1_POLH             to tmpMyfA.R1_POLH
                    Move tmpMyf.R1_ODOS             to tmpMyfA.R1_ODOS
                    Move tmpMyf.R1_ARITHMOS         to tmpMyfA.R1_ARITHMOS
                    Move tmpMyf.R1_TK               to tmpMyfA.R1_TK
                    Move tmpMyf.R1_THLEFONO         to tmpMyfA.R1_THLEFONO
                    Move tmpMyf.R1_FAX              to tmpMyfA.R1_FAX
                    Move tmpMyf.R1_EMAIL            to tmpMyfA.R1_EMAIL
                    Move tmpMyf.R1_EIDOS            to tmpMyfA.R1_EIDOS
                    Move tmpMyf.S_PLHTHOS_KAN       to tmpMyfA.S_PLHTHOS_KAN
                    Move tmpMyf.S_PLHTHOS_DHM       to tmpMyfA.S_PLHTHOS_DHM
                    Move tmpMyf.S_PLHTHOS_TOTAL     to tmpMyfA.S_PLHTHOS_TOTAL
                    If (tmpMyf.S_AXIA_KAN<0) ;
                         Move (tmpMyf.S_AXIA_KAN*(-1))  to tmpMyfA.S_AXIA_KAN
                    Else Move tmpMyf.S_AXIA_KAN         to tmpMyfA.S_AXIA_KAN
                    If (tmpMyf.S_AXIA_DHM<0) ;
                         Move (tmpMyf.S_AXIA_DHM*(-1))  to tmpMyfA.S_AXIA_DHM
                    Else Move tmpMyf.S_AXIA_DHM         to tmpMyfA.S_AXIA_DHM
                    If (tmpMyf.S_AXIA_Total<0) ;
                         Move (tmpMyf.S_AXIA_Total*(-1)) to tmpMyfA.S_AXIA_Total
                    Else Move tmpMyf.S_AXIA_Total        to tmpMyfA.S_AXIA_Total
        
        
                    Move 4 to tmpMyfA.aa
        
                    Saverecord tmpMyfA
                    Delete tmpMyf
                End
                Find Gt tmpMyf By Index.2
            Loop
            Unlock
        
            // Metatroph tou typou tou record gia Pelates pistotikous Dhmosiou apo 12 se -12
            Clear tmpMyf
            Lock
            Move (piMyfYear(Self))  to tmpMyf.Myf_Year
            Move '01'               to tmpMyf.Module
            Move 12                 to tmpMyf.Typos_Record
            Find Gt tmpMyf By Index.2
            While ((Found) And (tmpMyf.Myf_Year=piMyfYear(Self))    And ;
                               (tmpMyf.Module='01')                 And ;
                               (tmpMyf.Typos_Record=12))
                If (tmpMyf.Axia<0) Begin
                    Clear tmpMyfA
                    Move tmpMyf.COMPANY_CODE     to tmpMyfA.COMPANY_CODE
                    Move tmpMyf.BRANCH_CODE      to tmpMyfA.BRANCH_CODE
                    Move tmpMyf.MYF_YEAR         to tmpMyfA.MYF_YEAR
                    Move tmpMyf.MODULE           to tmpMyfA.MODULE
                    Move -12                     to tmpMyfA.Typos_Record
                    Move tmpMyf.AA               to tmpMyfA.AA
                    Move tmpMyf.AFM              to tmpMyfA.AFM
                    Move tmpMyf.CLIENT_ID        to tmpMyfA.CLIENT_ID
                    Move tmpMyf.CLIENT_NAME      to tmpMyfA.CLIENT_NAME
                    Move tmpMyf.JOB              to tmpMyfA.JOB
                    Move tmpMyf.YPOXREOS         to tmpMyfA.YPOXREOS
                    Move tmpMyf.POLH             to tmpMyfA.POLH
                    Move tmpMyf.ODOS             to tmpMyfA.ODOS
                    Move tmpMyf.ARITHMOS         to tmpMyfA.ARITHMOS
                    Move tmpMyf.TK               to tmpMyfA.TK
                    Move tmpMyf.PLHTHOS          to tmpMyfA.PLHTHOS
                    Move (tmpMyf.AXIA*(-1))      to tmpMyfA.AXIA
                    Move tmpMyf.AGROTHS          to tmpMyfA.AGROTHS
                    Move tmpMyf.DHMOSIO_ANEY     to tmpMyfA.DHMOSIO_ANEY
                    Move tmpMyf.R1_DOY           to tmpMyfA.R1_DOY
                    Move tmpMyf.R1_AR_FAKEL      to tmpMyfA.R1_AR_FAKEL
                    Move tmpMyf.R1_EPONYMIA      to tmpMyfA.R1_EPONYMIA
                    Move tmpMyf.R1_AFM           to tmpMyfA.R1_AFM
                    Move tmpMyf.R1_ANTIKEIMENO   to tmpMyfA.R1_ANTIKEIMENO
                    Move tmpMyf.R1_POLH          to tmpMyfA.R1_POLH
                    Move tmpMyf.R1_ODOS          to tmpMyfA.R1_ODOS
                    Move tmpMyf.R1_ARITHMOS      to tmpMyfA.R1_ARITHMOS
                    Move tmpMyf.R1_TK            to tmpMyfA.R1_TK
                    Move tmpMyf.R1_THLEFONO      to tmpMyfA.R1_THLEFONO
                    Move tmpMyf.R1_FAX           to tmpMyfA.R1_FAX
                    Move tmpMyf.R1_EMAIL         to tmpMyfA.R1_EMAIL
                    Move tmpMyf.R1_EIDOS         to tmpMyfA.R1_EIDOS
                    Move tmpMyf.S_PLHTHOS_KAN    to tmpMyfA.S_PLHTHOS_KAN
                    Move tmpMyf.S_PLHTHOS_DHM    to tmpMyfA.S_PLHTHOS_DHM
                    Move tmpMyf.S_PLHTHOS_TOTAL  to tmpMyfA.S_PLHTHOS_TOTAL
                    If (tmpMyf.S_AXIA_KAN<0) ;
                         Move (tmpMyf.S_AXIA_KAN*(-1))  to tmpMyfA.S_AXIA_KAN
                    Else Move tmpMyf.S_AXIA_KAN         to tmpMyfA.S_AXIA_KAN
                    If (tmpMyf.S_AXIA_DHM<0) ;
                         Move (tmpMyf.S_AXIA_DHM*(-1))  to tmpMyfA.S_AXIA_DHM
                    Else Move tmpMyf.S_AXIA_DHM         to tmpMyfA.S_AXIA_DHM
                    If (tmpMyf.S_AXIA_Total<0) ;
                         Move (tmpMyf.S_AXIA_Total*(-1)) to tmpMyfA.S_AXIA_Total
                    Else Move tmpMyf.S_AXIA_Total        to tmpMyfA.S_AXIA_Total
        
                    Move 8 to tmpMyfA.aa
        
                    Saverecord tmpMyfA
                    Delete tmpMyf
                End
                Find Gt tmpMyf By Index.2
            Loop
            Unlock
            Function_Return 1
        End_Function
        
        Function fiMake_Record_3 Returns Integer
            Integer iInt iPos iPlhthosKan iPlhthosDhm iPlhthosTotal isOK
            String  sAddr sArithmos sOdos
            Number  nPoso nAxiaKan nAxiaDhm nAxiaTotal
        
            // Dhmioyrgia olon ton synolon me nea record typou:
            //   3 Synola Polhseis Xreostikes Kanonikoi
            //  -3 Synola Polhseis Pistotikes Kanonikoi
            //  13 Synola Polhseis Xreostikes Dhmosiou
            // -13 Synola Polhseis Pistotikes Dhmosiou
            //  Š€ ‹„ MODULE '01'
        
            // Prota Diagrafoume ta mona records me tis eggrafes ton synolon
            // epeidh ta synola epanadhmiourgountai
            Clear tmpMyf
            Move (piMyfYear(Self))  to tmpMyf.Myf_Year
            Move '01'               to tmpMyf.Module
            Move  3                 to tmpMyf.Typos_Record
            Find Eq tmpMyf By Index.2
            If (Found) Delete tmpMyf
        
            Clear tmpMyf
            Move (piMyfYear(Self))  to tmpMyf.Myf_Year
            Move '01'               to tmpMyf.Module
            Move  -3                to tmpMyf.Typos_Record
            Find Eq tmpMyf By Index.2
            If (Found) Delete tmpMyf
        
            Clear tmpMyf
            Move (piMyfYear(Self))  to tmpMyf.Myf_Year
            Move '01'               to tmpMyf.Module
            Move  13                to tmpMyf.Typos_Record
            Find Eq tmpMyf By Index.2
            If (Found) Delete tmpMyf
        
            Clear tmpMyf
            Move (piMyfYear(Self))  to tmpMyf.Myf_Year
            Move '01'               to tmpMyf.Module
            Move  -13               to tmpMyf.Typos_Record
            Find Eq tmpMyf By Index.2
            If (Found) Delete tmpMyf
        
            // Synola Dhmosiou Pelates Xreost apo eggrafes typou 12 ==> Synola se eggrafh typou 13
            Move 0 to iPlhthosKan
            Move 0 to iPlhthosDhm
            Move 0 to iPlhthosTotal
            Move 0 to nAxiaKan
            Move 0 to nAxiaDhm
            Move 0 to nAxiaTotal
        
            /// ¨¦©Ÿœ© ˜¥å˜ª ¡˜  §¢ãŸ¦ª œšš¨˜­é¤ «ç§¦¬ 12 & module '01' ==> à¢©œ ª ƒ£¦© ¦
            /// ¡˜  ›£ ¦¬¨šå˜ £ ˜ª œšš¨˜­ª 13 '01'
            Clear tmpMyf
            Move (piMyfYear(Self))  to tmpMyf.Myf_Year
            Move '01'               to tmpMyf.Module
            Move 12                 to tmpMyf.Typos_Record
            Find Gt tmpMyf By Index.2
            While ((Found) And (tmpMyf.Myf_Year=piMyfYear(Self))    And ;
                               (tmpMyf.Module='01')                 And ;
                               (tmpMyf.Typos_Record=12))
                Add tmpMyf.Plhthos  to iPlhthosDhm
                Add tmpMyf.Axia     to nAxiaDhm
                Find Gt tmpMyf By Index.2
            Loop
        
            If (nAxiaDhm) Begin
                Clear tmpMyf
                Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                Move '01'               to tmpMyf.Module
                Move 13                 to tmpMyf.Typos_Record
                Move iPlhthosDhm        to tmpMyf.S_Plhthos_Dhm
                Move nAxiaDhm           to tmpMyf.S_Axia_Dhm
                Move 7                  to tmpMyf.AA
        
                Move iPlhthosDhm        to tmpMyf.Plhthos
                Move nAxiaDhm           to tmpMyf.Axia
        
                Saverecord tmpMyf
            End
        
            /// ¨¦©Ÿœ© ˜¥å˜ª ¡˜  §¢ãŸ¦ª œšš¨˜­é¤ «ç§¦¬ 2 & module '01' ==> à¢©œ ª ‰˜¤¦¤ ¡¦å §œ¢á«œª
            /// ¡˜  ›£ ¦¬¨šå˜ £ ˜ª œšš¨˜­ª 3 '01'.
            Clear tmpMyf
            Move (piMyfYear(Self))  to tmpMyf.Myf_Year
            Move '01'               to tmpMyf.Module
            Move 2                  to tmpMyf.Typos_Record
            Find Gt tmpMyf By Index.2
            While ((Found) And (tmpMyf.Myf_Year=piMyfYear(Self))    And ;
                               (tmpMyf.Module='01')                 And ;
                               (tmpMyf.Typos_Record=2))
                Add tmpMyf.Plhthos  to iPlhthosKan
                Add tmpMyf.Axia     to nAxiaKan
                Find Gt tmpMyf By Index.2
            Loop
        
            If (iPlhthosKan) Begin
                Clear tmpMyf
                Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                Move '01'               to tmpMyf.Module
                Move 3                  to tmpMyf.Typos_Record
                Move iPlhthosKan        to tmpMyf.S_Plhthos_Kan
                Move iPlhthosDhm        to tmpMyf.S_Plhthos_Dhm
                Move (iPlhthosKan+iPlhthosDhm) ;
                                        to tmpMyf.S_Plhthos_Total
                If (nAxiaKan<0) ;
                     Move (nAxiaKan*(-1))   to tmpMyf.S_Axia_Kan
                Else Move nAxiaKan          to tmpMyf.S_Axia_Kan
                If (nAxiaDhm<0) ;
                     Move (nAxiaDhm*(-1))   to tmpMyf.S_Axia_Dhm
                Else Move nAxiaDhm          to tmpMyf.S_Axia_Dhm
                Move (tmpMyf.S_Axia_Kan+tmpMyf.S_Axia_Dhm) ;
                                            to tmpMyf.S_Axia_Total
        
                Move iPlhthosKan        to tmpMyf.Plhthos
                Move nAxiaKan           to tmpMyf.Axia
        
                Move 3 to tmpMyf.aa
        
                Saverecord tmpMyf
            End
        
        /// ¨¦©Ÿœ© ˜¥å˜ª ¡˜  §¢ãŸ¦ª œšš¨˜­é¤ «ç§¦¬ -12 & module '01' ==> à¢©œ ª  ©«à« ¡œª ƒ£¦© ¦
        /// ¡˜  ›£ ¦¬¨šå˜ £ ˜ª œšš¨˜­ª -13 '01'
            Move 0 to iPlhthosKan
            Move 0 to iPlhthosDhm
            Move 0 to iPlhthosTotal
            Move 0 to nAxiaKan
            Move 0 to nAxiaDhm
            Move 0 to nAxiaTotal
        
            Clear tmpMyf
            Move (piMyfYear(Self))  to tmpMyf.Myf_Year
            Move '01'               to tmpMyf.Module
            Move -12                to tmpMyf.Typos_Record
            Find Gt tmpMyf By Index.2
            While ((Found) And (tmpMyf.Myf_Year=piMyfYear(Self))    And ;
                               (tmpMyf.Module='01')                 And ;
                               (tmpMyf.Typos_Record=(-12)))
                Add tmpMyf.Plhthos  to iPlhthosDhm
                Add tmpMyf.Axia     to nAxiaDhm
                Find Gt tmpMyf By Index.2
            Loop
            If (iPlhthosDhm) Begin
                Clear tmpMyf
                Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                Move '01'               to tmpMyf.Module
                Move -13                to tmpMyf.Typos_Record
                Move iPlhthosDhm        to tmpMyf.S_Plhthos_Dhm
                Move nAxiaDhm           to tmpMyf.S_Axia_Dhm
        
                Move iPlhthosDhm        to tmpMyf.Plhthos
                Move nAxiaDhm           to tmpMyf.Axia
        
        
                Move 9 to tmpMyf.aa
                Saverecord tmpMyf
            End
        
         /// ¨¦©Ÿœ© ˜¥å˜ª ¡˜  §¢ãŸ¦ª œšš¨˜­é¤ «ç§¦¬ -2 & module '01' ==> à¢©œ ª  ©«à« ¡œª ‰˜¤¦¤ ¡¦ 
         /// ¡˜  ›£ ¦¬¨šå˜ £ ˜ª œšš¨˜­ª -3 '01'
            Clear tmpMyf
            Move (piMyfYear(Self))  to tmpMyf.Myf_Year
            Move '01'               to tmpMyf.Module
            Move -2                 to tmpMyf.Typos_Record
            Find Gt tmpMyf By Index.2
            While ((Found) And (tmpMyf.Myf_Year=piMyfYear(Self))    And ;
                               (tmpMyf.Module='01')                 And ;
                               (tmpMyf.Typos_Record=(-2)))
                Add tmpMyf.Plhthos  to iPlhthosKan
                Add tmpMyf.Axia     to nAxiaKan
                Find Gt tmpMyf By Index.2
            Loop
        
            If (iPlhthosKan) Begin
                Clear tmpMyf
                Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                Move '01'               to tmpMyf.Module
                Move -3                 to tmpMyf.Typos_Record
                Move iPlhthosKan        to tmpMyf.S_Plhthos_Kan
                Move iPlhthosDhm        to tmpMyf.S_Plhthos_Dhm
                Move (iPlhthosKan+iPlhthosDhm) ;
                                        to tmpMyf.S_Plhthos_Total
                If (nAxiaKan<0) ;
                     Move (nAxiaKan*(-1))   to tmpMyf.S_Axia_Kan
                Else Move nAxiaKan          to tmpMyf.S_Axia_Kan
                If (nAxiaDhm<0) ;
                     Move (nAxiaDhm*(-1))   to tmpMyf.S_Axia_Dhm
                Else Move nAxiaDhm          to tmpMyf.S_Axia_Dhm
                Move (tmpMyf.S_Axia_Kan+tmpMyf.S_Axia_Dhm) ;
                                            to tmpMyf.S_Axia_Total
        
                Move iPlhthosKan        to tmpMyf.Plhthos
                Move nAxiaKan           to tmpMyf.Axia
        
                Move 5 to tmpMyf.aa
                Saverecord tmpMyf
            End
        
            Function_Return 1
        End_Function
        
        
        /////////////////////// MYF PROMHTHEYTES ///////////////
        Function fiMake_Record_4 Returns Integer
            Integer iInt iPos iPlhthosKan iPlhthosDhm iPlhthosTotal isOK isakyro
            String  sAddr sArithmos sOdos
            Number  nPoso nAxiaKan nAxiaDhm nAxiaTotal
        
            Clear Ptyppar
            Find Gt Ptyppar.Recnum
            While (Found)
                // Ptyppar_Year_Recr=1  Thetika     sth MYF
                // Ptyppar_Year_Recr=2  Arnhtika    sth MYF
                If (((Trim(Ptyppar.Year_Recr)='1') Or (Trim(Ptyppar.Year_Recr)='2')) And (Ptyppar.Ptyppar_Module='02')) Begin
        
                    If (psBranch(Self)<>'') Begin
                        Clear Particle
                        Move SyscurXr.Company_Code  to Particle.Company_Code
                        Move (psBranch(Self))       to Particle.Branch_Code
                        Move (piMyfYear(Self))      to Particle.Year_Year
                        Move '02'                   to Particle.Partl_Module
                        Move Ptyppar.Ptyppar_Recr   to Particle.Ptyppar_Recr
                        Find Gt Particle By Index.12
                        While ((Found) And (Particle.Company_Code=SyscurXr.Company_Code) And (Particle.Branch_Code=(psBranch(Self))) And ;
                                           (Particle.Year_Year=(piMyfYear(Self))) And (Particle.Partl_Module='02') And (Particle.Ptyppar_Recr=Ptyppar.Ptyppar_Recr))
        
                            Set Label Of frmMessage to ('€š¦¨âª '+Trim(Ptyppar.Ptyppar_Descr)+' '+String(Particle.Recnum))
        
                            If ((Particle.Partl_Totamad>Sysfile.Orio_Myf) And (Particle.Partl_No>0)) Begin
        
                                Get fiEinaiAkyromeno Particle.Partl_Recr to isAkyro
                                If (NOT(isAkyro)) Begin
        
                                    Clear Clients
                                    Move Particle.Client_ID to Clients.Client_ID
                                    Find Eq Clients By Index.6
                                    If (Not(Found)) Begin
                                        Pause 24 00 '‹œš ©«¦ §¨æ™¢£˜'
                                        Function_Return -100
                                    End
                                    ///////
                                    Clear tmpMyf
                                    Lock
                                    Move (piMyfYear(Self))      to tmpMyf.Myf_Year
                                    Move '02'                   to tmpMyf.Module
                                    // An einai pelaths Dhmosiou xoris afm tote
                                    // DEN kanei eggrafh typou 2 alla eggrafh typoy 12
                                    If (Clients.Custprom_Code='1') ;
                                         Move 14                to tmpMyf.Typos_Record
                                    Else Move  4                to tmpMyf.Typos_Record
        
                                    //Move Particle.Client_ID     to tmpMyf.Client_ID
                                    //Find Eq tmpMyf By Index.2
                                    // jsjsjs 15/09/2004 allagh gia enopoihsh pollaplon afm
                                    If ((Check_Afm_Local(Self,Clients.Client_AFM)<>0) And ;
                                        (piEnop(Self)=0)) Begin
                                        Move Particle.Client_ID     to tmpMyf.Client_ID
                                        Find Eq tmpMyf By Index.2
                                        Move Particle.Client_ID     to tmpMyf.AFM
                                    End
                                    Else Begin
                                        Move Clients.Client_AFM     to tmpMyf.AFM
                                        Find Eq tmpMyf By Index.6
                                        Move Particle.Client_ID     to tmpMyf.Client_ID
                                    End
        
                                    If (Clients.Custprom_Code='1') ;
                                         Move 14                to tmpMyf.Typos_Record
                                    Else Move  4                to tmpMyf.Typos_Record
        
                                    Move SyscurXr.Company_Code              to tmpMyf.Company_Code
                                    Move (psBranch(Self))                   to tmpMyf.Branch_Code
                                    Move Clients.Client_AFM                 to tmpMyf.AFM
                                    Move Clients.Client_ID                  to tmpMyf.Client_ID
                                    Move Clients.Client_Name                to tmpMyf.Client_Name
                                    Move (gsfCode_Mast('JOB',Clients.Client_Job)) ;
                                                                            to tmpMyf.Job
                                    If (Clients.Custprom_Recr='1') Move '1' to tmpMyf.Ypoxreos
                                    Else                           Move '0' to tmpMyf.Ypoxreos
        
                                    Add 1                                   to tmpMyf.Plhthos
        
                                    If (Trim(Ptyppar.Year_Recr)='2') ;
                                         Add (Particle.Partl_Totamad*(-1))  to tmpMyf.Axia
                                    Else Add  Particle.Partl_Totamad        to tmpMyf.Axia
        
                                    Clear Cities
                                    Move Clients.Client_City_ID to Cities.City_ID
                                    Find Eq Cities By Index.1
                                    Move Cities.City_Descr      to tmpMyf.Polh
        
                                    Move Clients.Client_Address to sAddr
                                    Move (Trim(sAddr))          to sAddr
                                    For iInt From 1 to (Length(sAddr))
                                        If (Mid(sAddr,1,iInt)=' ') Move iInt to iPos
                                    Loop
                                    If (iPos) Begin
                                        Move (Left(sAddr,(iPos-1)))                 to sOdos
                                        Move (Right(sAddr,(Length(sAddr)-iPos)))    to sArithmos
                                    End
                                    Else Move (Trim(sAddr))     to sOdos
        
                                    Move (Trim(sOdos))          to tmpMyf.Odos
                                    Move (Trim(sArithmos))      to tmpMyf.Arithmos
                                    Move Clients.Client_ZipCode to tmpMyf.TK
                                    Move (Replaces(' ',tmpMyf.TK,'')) ;
                                                                to tmpMyf.TK
        
                                    Get Validate_AFM2 tmpMyf.AFM  to isOK
                                    Move isOK to tmpMyf.Wrong_AFM
        
                                    Saverecord tmpMyf
                                    Unlock
        
                                End
                            End
                            Find Gt Particle By Index.12
                        Loop
                    End
                    Else Begin
                        Clear Particle
                        Move SyscurXr.Company_Code  to Particle.Company_Code
                        Move (piMyfYear(Self))      to Particle.Year_Year
                        Move '02'                   to Particle.Partl_Module
                        Move Ptyppar.Ptyppar_Recr   to Particle.Ptyppar_Recr
                        Find Gt Particle By 16
                        While ((Found) And (Particle.Company_Code=SyscurXr.Company_Code) And ;
                                           (Particle.Year_Year=(piMyfYear(Self))) And (Particle.Partl_Module='02') And (Particle.Ptyppar_Recr=Ptyppar.Ptyppar_Recr))
        
                            Set Label Of frmMessage to ('€š¦¨âª '+Trim(Ptyppar.Ptyppar_Descr)+' '+String(Particle.Recnum))
        
                            If ((Particle.Partl_Totamad>Sysfile.Orio_Myf) And (Particle.Partl_No>0)) Begin
        
        
                                Get fiEinaiAkyromeno Particle.Partl_Recr to isAkyro
                                If (NOT(isAkyro)) Begin
        
        
                                    Clear Clients
                                    Move Particle.Client_ID to Clients.Client_ID
                                    Find Eq Clients By Index.6
                                    If (Not(Found)) Begin
                                        Pause 24 00 '‹œš ©«¦ §¨æ™¢£˜'
                                        Function_Return -100
                                    End
                                    ///////
                                    Clear tmpMyf
                                    Lock
                                    Move (piMyfYear(Self))      to tmpMyf.Myf_Year
                                    Move '02'                   to tmpMyf.Module
                                    // An einai pelaths Dhmosiou xoris afm tote
                                    // DEN kanei eggrafh typou 2 alla eggrafh typoy 12
                                    If (Clients.Custprom_Code='1') ;
                                         Move 14                to tmpMyf.Typos_Record
                                    Else Move  4                to tmpMyf.Typos_Record
        
                                    //Move Particle.Client_ID     to tmpMyf.Client_ID
                                    //Find Eq tmpMyf By Index.2
                                    // jsjsjs 15/09/2004 allagh gia enopoihsh pollaplon afm
                                    If ((Check_Afm_Local(Self,Clients.Client_AFM)<>0) And ;
                                        (piEnop(Self)=0)) Begin
                                        Move Particle.Client_ID     to tmpMyf.Client_ID
                                        Find Eq tmpMyf By Index.2
                                        Move Particle.Client_ID     to tmpMyf.AFM
                                    End
                                    Else Begin
                                        Move Clients.Client_AFM     to tmpMyf.AFM
                                        Find Eq tmpMyf By Index.6
                                        Move Particle.Client_ID     to tmpMyf.Client_ID
                                    End
        
                                    If (Clients.Custprom_Code='1') ;
                                         Move 14                to tmpMyf.Typos_Record
                                    Else Move  4                to tmpMyf.Typos_Record
                                    Move SyscurXr.Company_Code              to tmpMyf.Company_Code
                                    Move (psBranch(Self))                   to tmpMyf.Branch_Code
                                    Move Clients.Client_AFM                 to tmpMyf.AFM
                                    Move Clients.Client_ID                  to tmpMyf.Client_ID
                                    Move Clients.Client_Name                to tmpMyf.Client_Name
                                    Move (gsfCode_Mast('JOB',Clients.Client_Job)) ;
                                                                            to tmpMyf.Job
                                    If (Clients.Custprom_Recr='1') Move '1' to tmpMyf.Ypoxreos
                                    Else                           Move '0' to tmpMyf.Ypoxreos
        
                                    Add 1                                   to tmpMyf.Plhthos
        
                                    If (Trim(Ptyppar.Year_Recr)='2') ;
                                         Add (Particle.Partl_Totamad*(-1))  to tmpMyf.Axia
                                    Else Add  Particle.Partl_Totamad        to tmpMyf.Axia
        
                                    Clear Cities
                                    Move Clients.Client_City_ID to Cities.City_ID
                                    Find Eq Cities By Index.1
                                    Move Cities.City_Descr      to tmpMyf.Polh
        
                                    Move Clients.Client_Address to sAddr
                                    Move (Trim(sAddr))          to sAddr
                                    For iInt From 1 to (Length(sAddr))
                                        If (Mid(sAddr,1,iInt)=' ') Move iInt to iPos
                                    Loop
                                    If (iPos) Begin
                                        Move (Left(sAddr,(iPos-1)))                 to sOdos
                                        Move (Right(sAddr,(Length(sAddr)-iPos)))    to sArithmos
                                    End
                                    Else Move (Trim(sAddr))     to sOdos
        
                                    Move (Trim(sOdos))          to tmpMyf.Odos
                                    Move (Trim(sArithmos))      to tmpMyf.Arithmos
                                    Move Clients.Client_ZipCode to tmpMyf.TK
                                    Move (Replaces(' ',tmpMyf.TK,'')) ;
                                                                to tmpMyf.TK
        
                                    Get Validate_AFM2 tmpMyf.AFM  to isOK
                                    Move isOK to tmpMyf.Wrong_AFM
        
                                    Saverecord tmpMyf
                                    Unlock
                                End
                            End
                            Find Gt Particle By 16
                        Loop
                    End
                End
                Find Gt Ptyppar.Recnum
            Loop
        
            // Metatroph tou typou tou record gia promhtheytes pistotikous Kanonikous apo 4 se -4
            Clear tmpMyf
            Lock
            Move (piMyfYear(Self))  to tmpMyf.Myf_Year
            Move '02'               to tmpMyf.Module
            Move 4                  to tmpMyf.Typos_Record
            Find Gt tmpMyf By Index.2
            While ((Found) And (tmpMyf.Myf_Year=piMyfYear(Self))    And ;
                               (tmpMyf.Module='02')                 And ;
                               (tmpMyf.Typos_Record=4))
                If (tmpMyf.Axia<0) Begin
                    Clear tmpMyfA
                    Move tmpMyf.COMPANY_CODE     to tmpMyfA.COMPANY_CODE
                    Move tmpMyf.BRANCH_CODE      to tmpMyfA.BRANCH_CODE
                    Move tmpMyf.MYF_YEAR         to tmpMyfA.MYF_YEAR
                    Move tmpMyf.MODULE           to tmpMyfA.MODULE
                    Move -4                      to tmpMyfA.Typos_Record
                    Move tmpMyf.AA               to tmpMyfA.AA
                    Move tmpMyf.AFM              to tmpMyfA.AFM
                    Move tmpMyf.CLIENT_ID        to tmpMyfA.CLIENT_ID
                    Move tmpMyf.CLIENT_NAME      to tmpMyfA.CLIENT_NAME
                    Move tmpMyf.JOB              to tmpMyfA.JOB
                    Move tmpMyf.YPOXREOS         to tmpMyfA.YPOXREOS
                    Move tmpMyf.POLH             to tmpMyfA.POLH
                    Move tmpMyf.ODOS             to tmpMyfA.ODOS
                    Move tmpMyf.ARITHMOS         to tmpMyfA.ARITHMOS
                    Move tmpMyf.TK               to tmpMyfA.TK
                    Move tmpMyf.PLHTHOS          to tmpMyfA.PLHTHOS
                    Move (tmpMyf.AXIA*(-1))      to tmpMyfA.AXIA
                    Move tmpMyf.AGROTHS          to tmpMyfA.AGROTHS
                    Move tmpMyf.DHMOSIO_ANEY     to tmpMyfA.DHMOSIO_ANEY
                    Move tmpMyf.R1_DOY           to tmpMyfA.R1_DOY
                    Move tmpMyf.R1_AR_FAKEL      to tmpMyfA.R1_AR_FAKEL
                    Move tmpMyf.R1_EPONYMIA      to tmpMyfA.R1_EPONYMIA
                    Move tmpMyf.R1_AFM           to tmpMyfA.R1_AFM
                    Move tmpMyf.R1_ANTIKEIMENO   to tmpMyfA.R1_ANTIKEIMENO
                    Move tmpMyf.R1_POLH          to tmpMyfA.R1_POLH
                    Move tmpMyf.R1_ODOS          to tmpMyfA.R1_ODOS
                    Move tmpMyf.R1_ARITHMOS      to tmpMyfA.R1_ARITHMOS
                    Move tmpMyf.R1_TK            to tmpMyfA.R1_TK
                    Move tmpMyf.R1_THLEFONO      to tmpMyfA.R1_THLEFONO
                    Move tmpMyf.R1_FAX           to tmpMyfA.R1_FAX
                    Move tmpMyf.R1_EMAIL         to tmpMyfA.R1_EMAIL
                    Move tmpMyf.R1_EIDOS         to tmpMyfA.R1_EIDOS
                    Move tmpMyf.S_PLHTHOS_KAN    to tmpMyfA.S_PLHTHOS_KAN
                    Move tmpMyf.S_PLHTHOS_DHM    to tmpMyfA.S_PLHTHOS_DHM
                    Move tmpMyf.S_PLHTHOS_TOTAL  to tmpMyfA.S_PLHTHOS_TOTAL
                    If (tmpMyf.S_AXIA_KAN<0) ;
                         Move (tmpMyf.S_AXIA_KAN*(-1))  to tmpMyfA.S_AXIA_KAN
                    Else Move tmpMyf.S_AXIA_KAN         to tmpMyfA.S_AXIA_KAN
                    If (tmpMyf.S_AXIA_DHM<0) ;
                         Move (tmpMyf.S_AXIA_DHM*(-1))  to tmpMyfA.S_AXIA_DHM
                    Else Move tmpMyf.S_AXIA_DHM         to tmpMyfA.S_AXIA_DHM
                    If (tmpMyf.S_AXIA_Total<0) ;
                         Move (tmpMyf.S_AXIA_Total*(-1)) to tmpMyfA.S_AXIA_Total
                    Else Move tmpMyf.S_AXIA_Total        to tmpMyfA.S_AXIA_Total
                    Saverecord tmpMyfA
                    Delete tmpMyf
                End
                Find Gt tmpMyf By Index.2
            Loop
            Unlock
        
            // Metatroph tou typou tou record gia promhtheytes pistotikous Dhmosiou apo 14 se -14
            Clear tmpMyf
            Lock
            Move (piMyfYear(Self))  to tmpMyf.Myf_Year
            Move '02'               to tmpMyf.Module
            Move 14                 to tmpMyf.Typos_Record
            Find Gt tmpMyf By Index.2
            While ((Found) And (tmpMyf.Myf_Year=piMyfYear(Self))    And ;
                               (tmpMyf.Module='02')                 And ;
                               (tmpMyf.Typos_Record=14))
                If (tmpMyf.Axia<0) Begin
                    Clear tmpMyfA
                    Move tmpMyf.COMPANY_CODE     to tmpMyfA.COMPANY_CODE
                    Move tmpMyf.BRANCH_CODE      to tmpMyfA.BRANCH_CODE
                    Move tmpMyf.MYF_YEAR         to tmpMyfA.MYF_YEAR
                    Move tmpMyf.MODULE           to tmpMyfA.MODULE
                    Move -14                     to tmpMyfA.Typos_Record
                    Move tmpMyf.AA               to tmpMyfA.AA
                    Move tmpMyf.AFM              to tmpMyfA.AFM
                    Move tmpMyf.CLIENT_ID        to tmpMyfA.CLIENT_ID
                    Move tmpMyf.CLIENT_NAME      to tmpMyfA.CLIENT_NAME
                    Move tmpMyf.JOB              to tmpMyfA.JOB
                    Move tmpMyf.YPOXREOS         to tmpMyfA.YPOXREOS
                    Move tmpMyf.POLH             to tmpMyfA.POLH
                    Move tmpMyf.ODOS             to tmpMyfA.ODOS
                    Move tmpMyf.ARITHMOS         to tmpMyfA.ARITHMOS
                    Move tmpMyf.TK               to tmpMyfA.TK
                    Move tmpMyf.PLHTHOS          to tmpMyfA.PLHTHOS
                    Move (tmpMyf.AXIA*(-1))      to tmpMyfA.AXIA
                    Move tmpMyf.AGROTHS          to tmpMyfA.AGROTHS
                    Move tmpMyf.DHMOSIO_ANEY     to tmpMyfA.DHMOSIO_ANEY
                    Move tmpMyf.R1_DOY           to tmpMyfA.R1_DOY
                    Move tmpMyf.R1_AR_FAKEL      to tmpMyfA.R1_AR_FAKEL
                    Move tmpMyf.R1_EPONYMIA      to tmpMyfA.R1_EPONYMIA
                    Move tmpMyf.R1_AFM           to tmpMyfA.R1_AFM
                    Move tmpMyf.R1_ANTIKEIMENO   to tmpMyfA.R1_ANTIKEIMENO
                    Move tmpMyf.R1_POLH          to tmpMyfA.R1_POLH
                    Move tmpMyf.R1_ODOS          to tmpMyfA.R1_ODOS
                    Move tmpMyf.R1_ARITHMOS      to tmpMyfA.R1_ARITHMOS
                    Move tmpMyf.R1_TK            to tmpMyfA.R1_TK
                    Move tmpMyf.R1_THLEFONO      to tmpMyfA.R1_THLEFONO
                    Move tmpMyf.R1_FAX           to tmpMyfA.R1_FAX
                    Move tmpMyf.R1_EMAIL         to tmpMyfA.R1_EMAIL
                    Move tmpMyf.R1_EIDOS         to tmpMyfA.R1_EIDOS
                    Move tmpMyf.S_PLHTHOS_KAN    to tmpMyfA.S_PLHTHOS_KAN
                    Move tmpMyf.S_PLHTHOS_DHM    to tmpMyfA.S_PLHTHOS_DHM
                    Move tmpMyf.S_PLHTHOS_TOTAL  to tmpMyfA.S_PLHTHOS_TOTAL
                    If (tmpMyf.S_AXIA_KAN<0) ;
                         Move (tmpMyf.S_AXIA_KAN*(-1))  to tmpMyfA.S_AXIA_KAN
                    Else Move tmpMyf.S_AXIA_KAN         to tmpMyfA.S_AXIA_KAN
                    If (tmpMyf.S_AXIA_DHM<0) ;
                         Move (tmpMyf.S_AXIA_DHM*(-1))  to tmpMyfA.S_AXIA_DHM
                    Else Move tmpMyf.S_AXIA_DHM         to tmpMyfA.S_AXIA_DHM
                    If (tmpMyf.S_AXIA_Total<0) ;
                         Move (tmpMyf.S_AXIA_Total*(-1)) to tmpMyfA.S_AXIA_Total
                    Else Move tmpMyf.S_AXIA_Total        to tmpMyfA.S_AXIA_Total
                    Saverecord tmpMyfA
                    Delete tmpMyf
                End
                Find Gt tmpMyf By Index.2
            Loop
            Unlock
            Function_Return 1
        End_Function
        
        
        Function fiMake_Record_5 Returns Integer
            Integer iInt iPos iPlhthosKan iPlhthosDhm iPlhthosTotal isOK
            String  sAddr sArithmos sOdos
            Number  nPoso nAxiaKan nAxiaDhm nAxiaTotal
        
            // Dhmioyrgia olon ton synolon me nea record typou:
            //   5 Synola Agores Xreostikes Kanonikoi
            //  -5 Synola Agores Pistotikes Kanonikoi
            //  15 Synola Agores Xreostikes Dhmosiou
            // -15 Synola Agores Pistotikes Dhmosiou
            //  Š€ ‹„ MODULE '02'
        
        
            // Prota Diagrafoume ta mona records me tis eggrafes ton synolon
            // epeidh ta synola epanadhmiourgountai
            Clear tmpMyf
            Move (piMyfYear(Self))  to tmpMyf.Myf_Year
            Move '02'               to tmpMyf.Module
            Move  5                 to tmpMyf.Typos_Record
            Find Eq tmpMyf By Index.2
            If (Found) Delete tmpMyf
        
            Clear tmpMyf
            Move (piMyfYear(Self))  to tmpMyf.Myf_Year
            Move '02'               to tmpMyf.Module
            Move  -5                to tmpMyf.Typos_Record
            Find Eq tmpMyf By Index.2
            If (Found) Delete tmpMyf
        
            Clear tmpMyf
            Move (piMyfYear(Self))  to tmpMyf.Myf_Year
            Move '02'               to tmpMyf.Module
            Move  15                to tmpMyf.Typos_Record
            Find Eq tmpMyf By Index.2
            If (Found) Delete tmpMyf
        
            Clear tmpMyf
            Move (piMyfYear(Self))  to tmpMyf.Myf_Year
            Move '02'               to tmpMyf.Module
            Move  -15               to tmpMyf.Typos_Record
            Find Eq tmpMyf By Index.2
            If (Found) Delete tmpMyf
        
        
            // Synola Dhmosiou Promht Xreost apo eggrafes typou 14 ==> Synola se eggrafh typou 15
            Move 0 to iPlhthosKan
            Move 0 to iPlhthosDhm
            Move 0 to iPlhthosTotal
            Move 0 to nAxiaKan
            Move 0 to nAxiaDhm
            Move 0 to nAxiaTotal
            Clear tmpMyf
            Move (piMyfYear(Self))  to tmpMyf.Myf_Year
            Move '02'               to tmpMyf.Module
            Move 14                 to tmpMyf.Typos_Record
            Find Gt tmpMyf By Index.2
            While ((Found) And (tmpMyf.Myf_Year=piMyfYear(Self))    And ;
                               (tmpMyf.Module='02')                 And ;
                               (tmpMyf.Typos_Record=14))
                Add tmpMyf.Plhthos  to iPlhthosDhm
                Add tmpMyf.Axia     to nAxiaDhm
                Find Gt tmpMyf By Index.2
            Loop
            If (nAxiaDhm) Begin
                Clear tmpMyf
                Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                Move '02'               to tmpMyf.Module
                Move 15                 to tmpMyf.Typos_Record
                Move iPlhthosDhm        to tmpMyf.S_Plhthos_Dhm
                Move nAxiaDhm           to tmpMyf.S_Axia_Dhm
                Saverecord tmpMyf
            End
        
            // Synola Kanonikoi Promht Xreost apo eggrafes typou 4 ==> Synola se eggrafh typou 5
            Clear tmpMyf
            Move (piMyfYear(Self))  to tmpMyf.Myf_Year
            Move '02'               to tmpMyf.Module
            Move 4                  to tmpMyf.Typos_Record
            Find Gt tmpMyf By Index.2
            While ((Found) And (tmpMyf.Myf_Year=piMyfYear(Self))    And ;
                               (tmpMyf.Module='02')                 And ;
                               (tmpMyf.Typos_Record=4))
                Add tmpMyf.Plhthos  to iPlhthosKan
                Add tmpMyf.Axia     to nAxiaKan
                Find Gt tmpMyf By Index.2
            Loop
            If (iPlhthosKan) Begin
                Clear tmpMyf
                Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                Move '02'               to tmpMyf.Module
                Move 5                  to tmpMyf.Typos_Record
                Move iPlhthosKan        to tmpMyf.S_Plhthos_Kan
                Move iPlhthosDhm        to tmpMyf.S_Plhthos_Dhm
                Move (iPlhthosKan+iPlhthosDhm) ;
                                        to tmpMyf.S_Plhthos_Total
                If (nAxiaKan<0) ;
                     Move (nAxiaKan*(-1))   to tmpMyf.S_Axia_Kan
                Else Move nAxiaKan          to tmpMyf.S_Axia_Kan
                If (nAxiaDhm<0) ;
                     Move (nAxiaDhm*(-1))   to tmpMyf.S_Axia_Dhm
                Else Move nAxiaDhm          to tmpMyf.S_Axia_Dhm
                Move (tmpMyf.S_Axia_Kan+tmpMyf.S_Axia_Dhm) ;
                                            to tmpMyf.S_Axia_Total
                Saverecord tmpMyf
            End
        
        
            // Synola Dhmosiou Promht pist apo eggrafes typou -14 ==> Synola se eggrafh typou -15
            Move 0 to iPlhthosKan
            Move 0 to iPlhthosDhm
            Move 0 to iPlhthosTotal
            Move 0 to nAxiaKan
            Move 0 to nAxiaDhm
            Move 0 to nAxiaTotal
            Clear tmpMyf
            Move (piMyfYear(Self))  to tmpMyf.Myf_Year
            Move '02'               to tmpMyf.Module
            Move -14                to tmpMyf.Typos_Record
            Find Gt tmpMyf By Index.2
            While ((Found) And (tmpMyf.Myf_Year=piMyfYear(Self))    And ;
                               (tmpMyf.Module='02')                 And ;
                               (tmpMyf.Typos_Record=(-14)))
                Add tmpMyf.Plhthos  to iPlhthosDhm
                Add tmpMyf.Axia     to nAxiaDhm
                Find Gt tmpMyf By Index.2
            Loop
            If (iPlhthosDhm) Begin
                Clear tmpMyf
                Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                Move '02'               to tmpMyf.Module
                Move -15                to tmpMyf.Typos_Record
                Move iPlhthosDhm        to tmpMyf.S_Plhthos_Dhm
                Move nAxiaDhm           to tmpMyf.S_Axia_Dhm
                Saverecord tmpMyf
            End
        
            // Synola Kanonikoi Promht Pist apo eggrafes typou -4 ==> Synola se eggrafh typou -5
            Clear tmpMyf
            Move (piMyfYear(Self))  to tmpMyf.Myf_Year
            Move '02'               to tmpMyf.Module
            Move -4                 to tmpMyf.Typos_Record
            Find Gt tmpMyf By Index.2
            While ((Found) And (tmpMyf.Myf_Year=piMyfYear(Self))    And ;
                               (tmpMyf.Module='02')                 And ;
                               (tmpMyf.Typos_Record=(-4)))
                Add tmpMyf.Plhthos  to iPlhthosKan
                Add tmpMyf.Axia     to nAxiaKan
                Find Gt tmpMyf By Index.2
            Loop
            If (iPlhthosKan) Begin
                Clear tmpMyf
                Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                Move '02'               to tmpMyf.Module
                Move -5                 to tmpMyf.Typos_Record
                Move iPlhthosKan        to tmpMyf.S_Plhthos_Kan
                Move iPlhthosDhm        to tmpMyf.S_Plhthos_Dhm
                Move (iPlhthosKan+iPlhthosDhm) ;
                                        to tmpMyf.S_Plhthos_Total
                If (nAxiaKan<0) ;
                     Move (nAxiaKan*(-1))   to tmpMyf.S_Axia_Kan
                Else Move nAxiaKan          to tmpMyf.S_Axia_Kan
                If (nAxiaDhm<0) ;
                     Move (nAxiaDhm*(-1))   to tmpMyf.S_Axia_Dhm
                Else Move nAxiaDhm          to tmpMyf.S_Axia_Dhm
                Move (tmpMyf.S_Axia_Kan+tmpMyf.S_Axia_Dhm) ;
                                            to tmpMyf.S_Axia_Total
                Saverecord tmpMyf
            End
            Function_Return 1
        End_Function
        
        ////////////////////////////////////////////////////////////////////////
        // Ypoxreotika Validation se kathe typou record opos orizei o kodikas //
        ////////////////////////////////////////////////////////////////////////
        Function Validate_R1_Eidos Returns Integer
            Integer rVal iYear
            If (tmpMyf.R1_Eidos='') Begin
                    Set piLathi to (piLathi(Self)+1)
                    Writeln Channel 7 'Šœå§œ  «¦ œå›¦ª œš¡˜«á©«˜©ª «ª œ«˜ ¨å˜ª'
                    Function_Return 0
            End
            Function_Return 1
        End_Function
        
        Function Validate_R1_Fax Returns Integer
            Integer rVal iYear
            If (tmpMyf.R1_Fax='') Begin
                    Set piLathi to (piLathi(Self)+1)
                    Writeln Channel 7 'Šœå§œ  «¦ Fax «ª œ«˜ ¨å˜ª'
                    Function_Return 0
            End
            Function_Return 1
        End_Function
        
        Function Validate_R1_Thlefono Returns Integer
            Integer rVal iYear
            If (tmpMyf.R1_Thlefono='') Begin
                    Set piLathi to (piLathi(Self)+1)
                    Writeln Channel 7 'Šœå§œ  «¦ «¢â­à¤¦ «ª œ«˜ ¨å˜ª'
                    Function_Return 0
            End
            Function_Return 1
        End_Function
        
        Function Validate_R1_TK Returns Integer
            Integer rVal iYear
            If (tmpMyf.R1_TK='') Begin
                    Set piLathi to (piLathi(Self)+1)
                    Writeln Channel 7 'Šœå§œ  ¦ ’˜®. ‰à› ¡æª ©«¤ › œçŸ¬¤© «ª œ«˜ ¨å˜ª'
                    Function_Return 0
            End
            Else If (Length(Trim(tmpMyf.R1_TK))<>5) Begin
                    Set piLathi to (piLathi(Self)+1)
                    Writeln Channel 7 'O ’˜®. ‰à› ¡æª ©«¤ › œçŸ¬¤© «ª œ«˜ ¨å˜ª ›œ¤ œå¤˜  5¯ã­ ¦ª'
                    Function_Return 0
            End
            Function_Return 1
        End_Function
        
        Function Validate_R1_Arithmos Returns Integer
            Integer rVal iYear
            If (tmpMyf.R1_Arithmos='') Begin
                    Set piLathi to (piLathi(Self)+1)
                    Writeln Channel 7 'Šœå§œ  ¦ ˜¨ Ÿ£æª ©«¤ › œçŸ¬¤© «ª œ«˜ ¨å˜ª'
                    Function_Return 0
            End
            Function_Return 1
        End_Function
        
        Function Validate_R1_Odos Returns Integer
            Integer rVal iYear
            If (tmpMyf.R1_Odos='') Begin
                    Set piLathi to (piLathi(Self)+1)
                    Writeln Channel 7 'Šœå§œ   ¦›æª ©«¤ › œçŸ¬¤© «ª œ«˜ ¨å˜ª'
                    Function_Return 0
            End
            Function_Return 1
        End_Function
        
        Function Validate_R1_Polh Returns Integer
            Integer rVal iYear
            If (tmpMyf.R1_Polh='') Begin
                    Set piLathi to (piLathi(Self)+1)
                    Writeln Channel 7 'Šœå§œ   §æ¢ ©«¤ › œçŸ¬¤© «ª œ«˜ ¨å˜ª'
                    Function_Return 0
            End
            Function_Return 1
        End_Function
        
        Function Validate_R1_Antikeimeno Returns Integer
            Integer rVal iYear
            If (tmpMyf.R1_Antikeimeno='') Begin
                    Set piLathi to (piLathi(Self)+1)
                    Writeln Channel 7 'Šœå§œ  «¦ ˜¤« ¡œå£œ¤¦ «ª œ«˜ ¨å˜ª'
                    Function_Return 0
            End
            Function_Return 1
        End_Function
        
        Function Validate_R1_Eponymia Returns Integer
            Integer rVal iYear
            If (tmpMyf.R1_Eponymia='') Begin
                    Set piLathi to (piLathi(Self)+1)
                    Writeln Channel 7 'Šœå§œ   œ§à¤¬£å˜ «ª œ«˜ ¨å˜ª'
                    Function_Return 0
            End
            Function_Return 1
        End_Function
        
        Function Validate_R1_Year Returns Integer
            Integer rVal iYear
            // Theoroume pos h MYF pou ekdidoume afora eite to trexon etos
            // eite to prohgoumeno se sxesh me to login pou exoume kanei.
            If  (tmpMyf.Myf_Year<>piMyfYear(Self)) Begin
                    Set piLathi to (piLathi(Self)+1)
                    Writeln Channel 7 '’¦ â«¦ª ¬§¦™¦¢ãª œå¤˜  ¢˜¤Ÿ˜©£â¤¦'
                    Function_Return 0
            End
            Function_Return 1
        End_Function
        
        Function Validate_R1_DOY Returns Integer
            Integer rVal iDOY
            // Elegxos gia tetrapsifio kodiko DOY
            If ((tmpMyf.R1_DOY<1000) Or (tmpMyf.R1_DOY>9999)) Begin
                Set piLathi to (piLathi(Self)+1)
                Writeln Channel 7 ' ¡à› ¡æª ƒ“ ›œ¤ œå¤˜  «œ«¨˜¯ã­ ¦ª'
                Function_Return 0
            End
            // Elegxos gia yparkto kodiko DOY
            Clear Codemast
            Move 'DOY'          to Codemast.Type
            Move  tmpMyf.R1_DOY to Codemast.Code
            Find Eq Codemast By Index.1
            If (Not(Found)) Begin
                Set piLathi to (piLathi(Self)+1)
                Writeln Channel 7 ' ¡à› ¡æª ƒ“ œå¤˜  ˜¤ç§˜¨¡«¦ª'
                Function_Return 0
            End
            Function_Return 1
        End_Function
        
        Function Validate_AFM String asAFM String asPel Returns Integer
            Integer rVal iCheck
            // Elegxos gia sosto AFM
            Move (Check_AFM(asAFM)) to iCheck
            If (iCheck=1) Begin
                Set piLathi to (piLathi(Self)+1)
                Write   Channel 7 '’¦ €”‹ «¦¬ '
                Write   Channel 7 (Trim(asPel)+' ')
                Write   Channel 7 'œå¤˜  ¢˜¤Ÿ˜©£â¤¦'
                Writeln Channel 7
                Function_Return 0
            End
            Else If (iCheck=2) Begin
                Set piLathi to (piLathi(Self)+1)
                Write   Channel 7 '’¦ €”‹ «¦¬ '
                Write   Channel 7 (Trim(asPel)+' ')
                Writeln Channel 7 '›œ¤ œå¤˜  9 ¯ã­ ¦'
                Function_Return 0
            End
            Else If (iCheck=3) Begin
                Set piLathi to (piLathi(Self)+1)
                Write   Channel 7 '’¦ €”‹ «¦¬ '
                Write   Channel 7 (Trim(asPel)+' ')
                Writeln Channel 7 '§œ¨ â®œ  £ ˜§¦›œ¡«¦çª ®˜¨˜¡«ã¨œª'
                Function_Return 0
            End
            Function_Return 1
        End_Function
        
        Function Validate_Mh_Ypoxreos_AFM Returns Integer
            If (tmpMyf.AFM='') Begin
                Set piLathi to (piLathi(Self)+1)
                Write   Channel 7 '’¦ €”‹ «¦¬ ‹ ¬§æ®¨œ¦¬ §œ¢á« '
                Write   Channel 7 (Trim(tmpMyf.Client_Name)+' ')
                Write   Channel 7 'œå¤˜  ¡œ¤æ. ‘¬£§¢¨é©«œ €”‹ ã €.’.'
                Writeln Channel 7
                Function_Return 0
            End
            Else Function_Return 1
        End_Function
        
        Function Validate_Ypoxreos Returns Integer
            If ((tmpMyf.Ypoxreos<>0) And (tmpMyf.Ypoxreos<>1)) Begin
                Set piLathi to (piLathi(Self)+1)
                Write   Channel 7 '† â¤›œ ¥ ¬§æ®¨œ¦¬ š ˜ «¦¤ §œ¢á« '
                Write   Channel 7 (Trim(tmpMyf.Client_Name)+' ')
                Write   Channel 7 '§¨â§œ  ¤˜ œå¤˜  0 ã 1'
                Writeln Channel 7
                Function_Return 0
            End
            Else Function_Return 1
        End_Function
        
        Function Validate_Polh Returns Integer
            If (tmpMyf.Polh='') Begin
                Set piLathi to (piLathi(Self)+1)
                Write   Channel 7 '† §æ¢ «¦¬ §œ¢á« '
                Write   Channel 7 (Trim(tmpMyf.Client_Name)+' ')
                Write   Channel 7 'œå¤˜  ¡œ¤ã'
                Writeln Channel 7
                Function_Return 0
            End
            Else Function_Return 1
        End_Function
        
        Function Validate_Odos Returns Integer
            If (tmpMyf.Odos='') Begin
                Set piLathi to (piLathi(Self)+1)
                Write   Channel 7 '† ¦›æª «¦¬ §œ¢á« '
                Write   Channel 7 (Trim(tmpMyf.Client_Name)+' ')
                Write   Channel 7 'œå¤˜  ¡œ¤ã'
                Writeln Channel 7
                Function_Return 0
            End
            Else Function_Return 1
        End_Function
        
        Function Validate_Plhthos Returns Integer
            If (tmpMyf.Plhthos=0) Begin
                Set piLathi to (piLathi(Self)+1)
                Write   Channel 7 '’¦ §¢ãŸ¦ª «à¤ « £¦¢¦šåà¤ «¦¬ §œ¢á« '
                Write   Channel 7 (Trim(tmpMyf.Client_Name)+' ')
                Write   Channel 7 '§¨¦¡ç§«œ  £›œ¤ ¡æ'
                Writeln Channel 7
                Function_Return 0
            End
            Else Function_Return 1
        End_Function
        
        //AB-StoreTopEnd

        Set Label to "“§¦¢¦š ©£æª ‹.“.”"
        Set Size to 290 527
        Set Location to 2 4

        //AB-DDOStart

        Object Company_DD is a Company_DataDictionary
        End_Object    // Company_DD

        Object Branch_DD is a Branch_DataDictionary
            Set DDO_Server to (Company_DD(self))
        End_Object    // Branch_DD

        Object Tmpmyf_DD is a tmpMyf_DataDictionary
        End_Object    // Tmpmyf_DD

        Object Tmpmyfa_DD is a tmpMyfA_DataDictionary
        End_Object    // Tmpmyfa_DD

        Set Main_DD to (Branch_DD(self))
        Set Server to (Branch_DD(self))

        //AB-DDOEnd

        Object frmEtosMyf is a FormSub
            Set Label to "„«¦ª"
            Set Size to 13 38
            Set Location to 4 27
            Set Label_Col_Offset to 3
            Set Label_Justification_Mode to jMode_Right
            Set Form_TypeFace Item 0 to "MS Sans Serif"

            //AB-StoreStart
            
            Procedure OnChange
                Integer iYear
                Get Value Item 0 to iYear
                Set piMyfYear to iYear
                Send Rebuild_All_Constraints
            End_Procedure
            
            
            
            //AB-StoreEnd

        End_Object    // frmEtosMyf

        Object Branch_Branch_Name is a dbFormSub
            Entry_Item Branch.Branch_name
            Set Label to "“§¦¡/£˜"
            Set Size to 13 90
            Set Location to 4 103
            Set Label_Col_Offset to 3
            Set Label_Justification_Mode to jMode_Right
            Set Form_TypeFace Item 0 to "MS Sans Serif"

            //AB-StoreStart
            
            Procedure Request_Clear
                Send Clear to Branch_DD
            End_Procedure
            
            Procedure Request_Clear_All
                Send Clear to Branch_DD
            End_Procedure
            
            Procedure Key Integer iKey
                Integer iRetVal
                Forward Send Key iKey
                If (iKey=277) Begin
                    Send Clear to Branch_DD
                End
            End_Procedure
            
            Set Prompt_Object to (sl002(Self))
            
            Procedure Prompt_CallBack Integer hPrompt
                Set psFragmaCompanyCode of hPrompt to SyscurXr.Company_Code
            End_Procedure
            
            
            //AB-StoreEnd

        End_Object    // Branch_Branch_Name

        Object btnMakeTemp is a ButtonSub

            //AB-StoreTopStart
            
            //AB-StoreTopEnd

            Set Bitmap to "Slist.bmp"
            Set Size to 22 25
            Set Location to 0 197
            Set Form_TypeFace Item 0 to "MS Sans Serif"

            //AB-StoreStart
            
            Set TooltipValue to '“§¦¢¦š ©£æª ‹.“.”.'
            
            Procedure OnClick
                Integer iYes isOK1 isOK2 isOK3 isOK4 isOK5 iMyfYear iYear iEnop
                String  sBranch
                Date    dHmniaEos
            
                Get Value Of frmEtosMyf Item 0  to iMyfYear
                Set piMyfYear                   to iMyfYear
            
                Get Checked_State of chk1       to iEnop
                Set piEnop to iEnop
            
                Get Field_Current_Value Of Branch_DD Field Branch.Branch_Code to sBranch
                Set psBranch to sBranch
            
                Get Value Of (dHmniaPrev(dbTabView1(dbTabDialogSView1(vwMyf(Self))))) Item 0 to dHmniaEos
                If (dHmniaEos<>'') Begin
                    Move (TheYearSegment(dHmniaEos)) to iYear
                    If (iYear<>iMyfYear) Begin
                        Send Stop_Box 'ƒœ¤ ©¬£­à¤œå «¦ â«¦ª «ª £œ¨¦£¤å˜ª\n«à¤ §˜¨˜©«˜« ¡é¤ §¨¦œ¨®æ£œ¤˜ ˜§¦ betogest\n£œ «¦ â«¦ª «ª ‹“”' '‘­á¢£˜ 3000'
                        Procedure_Return
                    End
                End
            
                Get YesNo_Box 'Œ˜ £›œ¤å©à «¦ ˜¨®œå¦ ‹“” ¡˜  ¤˜ ¥˜¤˜«¨â¥¦¬¤ ¦  ¬§¦¢¦š ©£¦å ?' to iYes
                If (iYes=MBR_NO) Procedure_Return
            
                for_all tmpMyf by Recnum
                    do
                        Set Label Of frmMessage to ('‹›œ¤ ©£æª ˜¨®œå¦¬  '+String(tmpmyf.Recnum))
                        Delete tmpMyf
                end_for_all
            
                Set Label Of frmMessage to ''
            
            
                Send ChangeAllFileModes                                DF_Filemode_ReadOnly
                Set_Attribute DF_File_Mode Of tmpMyf.File_Number    to DF_Filemode_Default
                Set_Attribute DF_File_Mode Of tmpMyfA.File_Number   to DF_Filemode_Default
            
                Set piStamata   to 0
                Set piLathi     to 0
            
                Get fiMake_Record_1 to isOK1
                Get fiMake_Record_2 to isOK2
                If (piStamata(Self)=1) Begin
                    Send ChangeAllFileModes DF_Filemode_Default
                    Procedure_Return
                End
                Get fiMake_Record_3 to isOK3
                Get fiMake_Record_4 to isOK4
                Get fiMake_Record_5 to isOK5
            
                Send ChangeAllFileModes DF_Filemode_Default
            
                Send Rebuild_All_Constraints
                Send Info_Box '  œšš¨˜­âª ¦¢¦¡¢¨éŸ¡˜¤' '¢¨¦­¦¨å˜'
                Set Label Of frmMessage to ''
            End_Procedure // OnClick
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            //AB-StoreEnd

        End_Object    // btnMakeTemp

        Object chk1 is a CheckBoxSub

            //AB-StoreTopStart
            
            //AB-StoreTopEnd

            Set Label to "„¤¦§¦å© €”‹"
            Set Size to 10 69
            Set Location to 0 389
            Set Checked_State to TRUE
            Set Focus_Mode to Pointer_Only

            //AB-StoreStart
            
            Set Checked_State to True
            
            
            
            //AB-StoreEnd

        End_Object    // chk1

        Object btnMakeAscii is a ButtonSub

            //AB-StoreTopStart
            
            //AB-StoreTopEnd

            Set Bitmap to "Chkmrk.bmp"
            Set Size to 22 25
            Set Location to 0 274
            Set Focus_Mode to Pointer_Only
            Set Form_TypeFace Item 0 to "MS Sans Serif"

            //AB-StoreStart
            
            Set TooltipValue to '¨ ©« ¡¦§¦å© ¡˜  œ¥˜šàšã ‹.“.”. ©œ ˜¨®œå˜'
            
            Procedure Make_Ascii_Files_Pistotika
                Integer iCount iErrorObjID
                Date    dHmnia
                String  sHmnia sKeno
                Number  nAxiaDhmosiou
                Sysdate dHmnia
                Move dHmnia to sHmnia
            
                // Prota Ftiaxnoume to arxeio IL01.PIS  gia tous pistotikous
                Direct_Output Channel 9 'C:\IL01.PIS'
                // Ftiaxnoume to record typou 0
                Write   Channel 9 0
                Write   Channel 9 'IL01.PIS'
                Write   Channel 9 (Right(sHmnia,4))
                Write   Channel 9 (Mid(sHmnia,2,4))
                Write   Channel 9 (Left(sHmnia,2))
                Move (Repeat(" ", 133)) to sKeno
                Write   Channel 9 sKeno
                Writeln Channel 9
                // Ftiaxnoume to record typou 1
                Clear tmpMyf
                Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                Move 1                  to tmpMyf.Typos_Record
                Find GT tmpMyf By Index.1
                If (NOT((Found) And (tmpMyf.Typos_Record=1) And (tmpMyf.Myf_Year=(piMyfYear(Self))))) Error 2001 'ƒœ¤ ™¨âŸ¡œ  œšš¨˜­ã «ç§¦¬ 1'
                Write   Channel 9 1
                Write   Channel 9                  tmpMyf.Myf_Year
                Write   Channel 9                  tmpMyf.R1_Doy
                Write   Channel 9 (Sfi_All_Numbers(tmpMyf.R1_Ar_Fakel   , 6,0))
                Write   Channel 9 (Pad            (tmpMyf.R1_Eponymia   ,18  ))
                Write   Channel 9 (Trim           (tmpMyf.R1_Afm             ))
                Write   Channel 9 (Pad            (tmpMyf.R1_Antikeimeno,16  ))
                Write   Channel 9 (Pad            (tmpMyf.R1_Polh       ,10  ))
                Write   Channel 9 (Pad            (tmpMyf.R1_Odos       ,16  ))
                Write   Channel 9 (Pad            (tmpMyf.R1_Arithmos   , 3  ))
                Write   Channel 9 (Pad            (tmpMyf.R1_TK         , 5  ))
                Write   Channel 9 (Pad            (tmpMyf.R1_Thlefono   ,10  ))
                Write   Channel 9 (Pad            (tmpMyf.R1_Fax        ,10  ))
                Write   Channel 9 (Pad            (tmpMyf.R1_Email      ,34  ))
                Write   Channel 9 (Pad            (tmpMyf.R1_Eidos      , 4  ))
                Writeln Channel 9
                // Ftiaxnoume ta record typou 2 (-2 gia mas) PISTOTIKOI PELATES
                Move 0 to iCount
                Clear tmpMyf
                Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                Move -2                 to tmpMyf.Typos_Record
                Move '01'               to tmpMyf.Module
                Find GT tmpMyf By Index.1
                While ((Found) And (tmpMyf.Myf_Year=piMyfYear(Self)) And (tmpMyf.Typos_Record=(-2)) And (tmpMyf.Module='01'))
                    Add 1 to iCount
                    Write   Channel 9 2
                    Write   Channel 9 (Sfi_All_Numbers(iCount            , 5,0))
                    Write   Channel 9 (Trim           (tmpMyf.Afm             ))
                    Write   Channel 9 (Pad            (tmpMyf.Client_Name,27  ))
                    Write   Channel 9 (Pad            (tmpMyf.Job        ,15  ))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Ypoxreos   , 1,0))
                    Write   Channel 9 (Pad            (tmpMyf.Polh       ,10  ))
                    Write   Channel 9 (Pad            (tmpMyf.Odos       ,16  ))
                    Write   Channel 9 (Pad            (tmpMyf.Arithmos   , 3  ))
                    Write   Channel 9 (Pad            (tmpMyf.TK         , 5  ))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Plhthos    , 7,0))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Axia      ,14,2))
                    Move (Repeat(" ", 35)) to sKeno
                    Write   Channel 9 sKeno
                    Writeln Channel 9
                    Find GT tmpMyf By Index.1
                Loop
                // Ftiaxnoume ta record typou 3 (-3 gia mas) SYNOLA PISTOTIKON
                // Mono ean yparxoun records typou 2 (-2 š ˜ £˜ª)
                // Periexoun KAI ta synola se axia tou dhmosiou
                If (iCount>0) Begin
                    Clear tmpMyf
                    Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                    Move -3                 to tmpMyf.Typos_Record
                    Move '01'               to tmpMyf.Module
                    Find GT tmpMyf By Index.1
                    If ((Found) And (tmpMyf.Myf_Year=piMyfYear(Self)) And (tmpMyf.Typos_Record=(-3)) And (tmpMyf.Module='01')) Begin
            
                        Write   Channel 9 3
                        Write   Channel 9                 ' '
                        Write   Channel 9                 '0000000000000000'
                        Write   Channel 9                 ' '
                        Write   Channel 9                 '0000000000000000'
                        Write   Channel 9 (Sfi_All_Numbers(tmpMyf.S_Plhthos_Total ,16,0))
                        Write   Channel 9 (Sfi_All_Numbers(tmpMyf.S_Axia_Total    ,14,2))
                        Move (Repeat(" ", 83)) to sKeno
                        Write   Channel 9 sKeno
                        Writeln Channel 9
            
            // ALLAGH TON GRAMMON SYNOLON 15/10/2007
            //                    Write   Channel 9 3
            //                    Write   Channel 9                 '999999011'
            //                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.S_Axia_Dhm    ,14,2))
            //                    Write   Channel 9                 '999999999'
            //                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.S_Plhthos_Kan , 6,0))
            //                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.S_Axia_Total    ,14,2))
            //                    Move (Repeat(" ", 83)) to sKeno
            //                    Write   Channel 9 sKeno
            //                    Writeln Channel 9
            // ALLAGH TON GRAMMON SYNOLON 15/10/2007
            
                    End
                    Else Error 2002 'ƒœ¤ ™¨âŸ¡˜¤ «˜ ©ç¤¦¢˜  ©«à« ¡á à¢ã©œà¤'
                End
            
                // Ftiaxnoume ta record typou 4 (-2 š ˜ £˜ª £œ module '02') PISTOTIKA AGORON
                Move 0 to iCount
                Clear tmpMyf
                Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                Move -4                 to tmpMyf.Typos_Record
                Move '02'               to tmpMyf.Module
                Find GT tmpMyf By Index.1
                While ((Found) And (tmpMyf.Myf_Year=piMyfYear(Self)) And (tmpMyf.Typos_Record=(-4)) And (tmpMyf.Module='02'))
                    Add 1 to iCount
                    Write   Channel 9 4
                    Write   Channel 9 (Sfi_All_Numbers(iCount            , 5,0))
                    Write   Channel 9 (Trim           (tmpMyf.Afm             ))
                    Write   Channel 9 (Pad            (tmpMyf.Client_Name,27  ))
                    Write   Channel 9 (Pad            (tmpMyf.Job        ,15  ))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Ypoxreos   , 1,0))
                    Write   Channel 9 (Pad            (tmpMyf.Polh       ,10  ))
                    Write   Channel 9 (Pad            (tmpMyf.Odos       ,16  ))
                    Write   Channel 9 (Pad            (tmpMyf.Arithmos   , 3  ))
                    Write   Channel 9 (Pad            (tmpMyf.TK         , 5  ))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Plhthos    , 7,0))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Axia       ,14,2))
                    Move (Repeat(" ", 35)) to sKeno
                    Write   Channel 9 sKeno
                    Writeln Channel 9
                    Find GT tmpMyf By Index.1
                Loop
                // Ftiaxnoume ta record typou 5 (-3 gia mas me module '02') SYNOLA PISTOTIKA AGORON
                // Mono ean yparxoun records typou -2 me module '02'
                If (iCount>0) Begin
                    Clear tmpMyf
                    Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                    Move -5                 to tmpMyf.Typos_Record
                    Move '02'               to tmpMyf.Module
                    Find GT tmpMyf By Index.1
                    If ((Found) And (tmpMyf.Myf_Year=piMyfYear(Self)) And (tmpMyf.Typos_Record=(-5)) And (tmpMyf.Module='02')) Begin
                        Write   Channel 9 5
                        Write   Channel 9                 '                  '
                        Write   Channel 9                 '0000000000000000'
                        Write   Channel 9 (Sfi_All_Numbers(tmpMyf.S_Plhthos_Total ,16,0))
                        Write   Channel 9 (Sfi_All_Numbers(tmpMyf.S_Axia_Total    ,14,2))
                        Move (Repeat(" ", 83)) to sKeno
                        Write   Channel 9 sKeno
                        Writeln Channel 9
            
            // ALLAGH TON GRAMMON SYNOLON 15/10/2007
            //                    Write   Channel 9 5
            //                    Write   Channel 9                 '999999011'
            //                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.S_Axia_Dhm    ,14,2))
            //                    Write   Channel 9                 '999999999'
            //                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.S_Plhthos_Kan , 6,0))
            //                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.S_Axia_Total  ,14,2))
            //                    Move (Repeat(" ", 83)) to sKeno
            //                    Write   Channel 9 sKeno
            //                    Writeln Channel 9
            // ALLAGH TON GRAMMON SYNOLON 15/10/2007
                    End
                    Else Error 2003 'ƒœ¤ ™¨âŸ¡˜¤ «˜ ©ç¤¦¢˜  ©«à« ¡á €š¦¨é¤'
                End
            
                Close_Output Channel 9
            
                Direct_Input Channel 7 "C:\IL01.PIS"
                If (Seqeof) Begin
                    Close_Input Channel 7
                    Error 9999
                End
            
            End_Procedure
            
            Procedure Make_Ascii_Files_Xreostika
                Integer iCount iErrorObjID iYpokat
                Date    dHmnia
                String  sHmnia sKeno sLine2 sLine
                Sysdate dHmnia
                Move dHmnia to sHmnia
            
                // Prota Ftiaxnoume to arxeio IL01  gia tous xreostikous
                Direct_Output Channel 9 'C:\IL01'
                // Ftiaxnoume to record typou 0
                Write   Channel 9 0
                Write   Channel 9 'IL01    '
                Write   Channel 9 (Right(sHmnia,4))
                Write   Channel 9 (Mid(sHmnia,2,4))
                Write   Channel 9 (Left(sHmnia,2))
                Move (Repeat(" ", 133)) to sKeno
                Write   Channel 9 sKeno
                Writeln Channel 9
                // Ftiaxnoume to record typou 1
                Clear tmpMyf
                Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                Move 1                  to tmpMyf.Typos_Record
                Find GT tmpMyf By Index.1
                If (NOT((Found) And (tmpMyf.Typos_Record=1) And (tmpMyf.Myf_Year=(piMyfYear(Self))))) Error 1001 'ƒœ¤ ™¨âŸ¡œ  œšš¨˜­ã «ç§¦¬ 1'
                Write   Channel 9 1
                Write   Channel 9                  tmpMyf.Myf_Year
                Write   Channel 9                  tmpMyf.R1_Doy
                Write   Channel 9 (Sfi_All_Numbers(tmpMyf.R1_Ar_Fakel   , 6,0))
                Write   Channel 9 (Left           (tmpMyf.R1_Eponymia   ,18  ))
                Write   Channel 9 (Trim           (tmpMyf.R1_Afm             ))
                Write   Channel 9 (Left           (tmpMyf.R1_Antikeimeno,16  ))
                Write   Channel 9 (Left           (tmpMyf.R1_Polh       ,10  ))
                Write   Channel 9 (Left           (tmpMyf.R1_Odos       ,16  ))
                Write   Channel 9 (Left           (tmpMyf.R1_Arithmos   , 3  ))
                Write   Channel 9 (Left           (tmpMyf.R1_TK         , 5  ))
                Write   Channel 9 (Left           (tmpMyf.R1_Thlefono   ,10  ))
                Write   Channel 9 (Left           (tmpMyf.R1_Fax        ,10  ))
                Write   Channel 9 (Left           (tmpMyf.R1_Email      ,34  ))
                Write   Channel 9 (Left           (tmpMyf.R1_Eidos      , 4  ))
                Writeln Channel 9
                // Ftiaxnoume ta record typou 2 XREOSTIKA POLHSEON
                Move 0 to iCount
                Clear tmpMyf
                Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                Move 2                  to tmpMyf.Typos_Record
                Move '01'               to tmpMyf.Module
                Find GT tmpMyf By Index.1
                While ((Found) And (tmpMyf.Myf_Year=piMyfYear(Self)) And (tmpMyf.Typos_Record=2) And (tmpMyf.Module='01'))
                    Add 1 to iCount
                    Write   Channel 9 2
                    Write   Channel 9 (Sfi_All_Numbers(iCount            , 5,0))
                    Write   Channel 9 (Left           (tmpMyf.Afm        , 9  ))
                    Write   Channel 9 (Left           (tmpMyf.Client_Name,27  ))
                    Write   Channel 9 (Left           (tmpMyf.Job        ,15  ))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Ypoxreos   , 1,0))
                    Write   Channel 9 (Left           (tmpMyf.Polh       ,10  ))
                    Write   Channel 9 (Left           (tmpMyf.Odos       ,16  ))
                    Write   Channel 9 (Left           (tmpMyf.Arithmos   , 3  ))
                    Write   Channel 9 (Left           (tmpMyf.TK         , 5  ))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Plhthos    , 7,0))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Axia       ,14,2))
                    Move (Repeat(" ", 35)) to sKeno
                    Write   Channel 9 sKeno
                    Writeln Channel 9
                    Find GT tmpMyf By Index.1
                Loop
                // Ftiaxnoume ta record typou 3 SYNOLA XREOSTIKA POLHSEON
                // Mono ean yparxoun records typou 2
                If (iCount>0) Begin
                    Clear tmpMyf
                    Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                    Move 3                  to tmpMyf.Typos_Record
                    Move '01'               to tmpMyf.Module
                    Find GT tmpMyf By Index.1
                    If ((Found) And (tmpMyf.Myf_Year=piMyfYear(Self)) And (tmpMyf.Typos_Record=3) And (tmpMyf.Module='01')) Begin
            
                        Write   Channel 9 3
                        Write   Channel 9                 ' '
                        Write   Channel 9                 '0000000000000000'
                        Write   Channel 9                 ' '
                        Write   Channel 9                 '0000000000000000'
                        Write   Channel 9 (Sfi_All_Numbers(tmpMyf.S_Plhthos_Total ,16,0))
                        Write   Channel 9 (Sfi_All_Numbers(tmpMyf.S_Axia_Total    ,14,2))
                        Move (Repeat(" ", 83)) to sKeno
                        Write   Channel 9 sKeno
                        Writeln Channel 9
            
            // ALLAGH TON GRAMMON SYNOLON 15/10/2007
            //                    Write   Channel 9 3
            //                    Write   Channel 9                 '999999011'
            //                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.S_Axia_Dhm    ,14,2))
            //                    Write   Channel 9                 '999999999'
            //                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.S_Plhthos_Kan ,16,0))
            //                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.S_Axia_Total  ,14,2))
            //                    Move (Repeat(" ", 83)) to sKeno
            //                    Write   Channel 9 sKeno
            //                    Writeln Channel 9
            // ALLAGH TON GRAMMON SYNOLON 15/10/2007
            
                    End
                    Else Error 1002 'ƒœ¤ ™¨âŸ¡˜¤ «˜ ©ç¤¦¢˜ à¢ã©œà¤'
                End
            
                // Ftiaxnoume ta record typou 4 XREOSTIKA AGORON
                Move 0 to iCount
                Clear tmpMyf
                Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                Move 4                  to tmpMyf.Typos_Record
                Move '02'               to tmpMyf.Module
                Find GT tmpMyf By Index.1
                While ((Found) And (tmpMyf.Myf_Year=piMyfYear(Self)) And (tmpMyf.Typos_Record=4) And (tmpMyf.Module='02'))
                    Add 1 to iCount
                    Write   Channel 9 4
                    Write   Channel 9 (Sfi_All_Numbers(iCount            , 5,0))
                    Write   Channel 9 (Trim           (tmpMyf.Afm             ))
                    Write   Channel 9 (Pad            (tmpMyf.Client_Name,27  ))
                    Write   Channel 9 (Pad            (tmpMyf.Job        ,15  ))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Ypoxreos   , 1,0))
                    Write   Channel 9 (Pad            (tmpMyf.Polh       ,10  ))
                    Write   Channel 9 (Pad            (tmpMyf.Odos       ,16  ))
                    Write   Channel 9 (Pad            (tmpMyf.Arithmos   , 3  ))
                    Write   Channel 9 (Pad            (tmpMyf.TK         , 5  ))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Plhthos    , 7,0))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Axia       ,14,2))
                    Move (Repeat(" ", 35)) to sKeno
                    Write   Channel 9 sKeno
                    Writeln Channel 9
                    Find GT tmpMyf By Index.1
                Loop
                // Ftiaxnoume ta record typou 5 SYNOLA XREOSTIKA AGORON
                // Mono ean yparxoun records typou 4
                If (iCount>0) Begin
                    Clear tmpMyf
                    Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                    Move 5                  to tmpMyf.Typos_Record
                    Move '02'               to tmpMyf.Module
                    Find GT tmpMyf By Index.1
                    If ((Found) And (tmpMyf.Myf_Year=piMyfYear(Self)) And (tmpMyf.Typos_Record=5) And (tmpMyf.Module='02')) Begin
                        Write   Channel 9 5
                        Write   Channel 9                 '                  '
                        Write   Channel 9                 '0000000000000000'
                        Write   Channel 9 (Sfi_All_Numbers(tmpMyf.S_Plhthos_Total ,16,0))
                        Write   Channel 9 (Sfi_All_Numbers(tmpMyf.S_Axia_Total    ,14,2))
                        Move (Repeat(" ", 83)) to sKeno
                        Write   Channel 9 sKeno
                        Writeln Channel 9
            
            
            // ALLAGH TON GRAMMON SYNOLON 15/10/2007
            //                    Write   Channel 9 5
            //                    Write   Channel 9                 '999999011'
            //                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.S_Axia_Dhm    ,14,2))
            //                    Write   Channel 9                 '999999999'
            //                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.S_Plhthos_Kan ,16,0))
            //                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.S_Axia_Total  ,14,2))
            //                    Move (Repeat(" ", 83)) to sKeno
            //                    Write   Channel 9 sKeno
            //                    Writeln Channel 9
            // ALLAGH TON GRAMMON SYNOLON 15/10/2007
            
            
                    End
                    Else Error 1003 'ƒœ¤ ™¨âŸ¡˜¤ «˜ ©ç¤¦¢˜ €š¦¨é¤'
                End
            
                Close_Output Channel 9
            
                Direct_Input Channel 7 "C:\IL01"
                If (Seqeof) Begin
                    Close_Input Channel 7
                    Error 9999
                End
            
            //  Telika DEN thelei convert se elot
            //  Einai OK me 437
            //    // 6. Convert file to ELOT
            //    Direct_Output Channel 9 "C:\IL01ELOT"
            //    Repeat
            //        Readln Channel 7        sLine
            //        Move (ToAnsi(sLine)) to sLine2
            //        Writeln Channel 9       sLine2
            //    Until (Seqeof)
            //    Close_Input  Channel 7
            //    Close_Output Channel 9
            //    CopyFile "C:\IL01ELOT" to "C:\IL01"
            //    //Renamefile "C:\IL01ELOT" to "C:\IL01"
            
            End_Procedure
            
            Procedure OnClick
                Integer isOK  iPlhthosKan iPlhthosDhm iPlhthosTotal iYes iErrorObjID
                Number  nAxiaKan nAxiaDhm nAxiaTotal
            
                //////////////////////////////////////////////////
                // „¢œš®¦ª œšš¨˜­ãª «ç§¦¬ 1 - ‘«¦ ®œå˜ “§æ®¨œ¦¬ //
                //////////////////////////////////////////////////
                Clear tmpMyf
                Move (piMyfYear(Self))     to tmpMyf.Myf_Year
                Move ''                    to tmpMyf.Module
                Move 1                     to tmpMyf.Typos_Record
                Move ''                    to tmpMyf.Client_ID
                Find Eq tmpMyf By Index.2
                If (Not(Found)) Begin
                    Send Stop_Box 'ƒœ¤ ™¨å©¡à œšš¨˜­ã £œ ©«¦ ®œå˜ œ«˜ ¨å˜ª' '‘­á¢£˜ 777'
                    Procedure_Return
                End
            
                Set piLathi             to 0
            
                Direct_Output Channel 7 "C:\ErrMyf.log"
                Writeln Channel 7 '----------------------------'
                Writeln Channel 7 '‘­á¢£˜ ©«˜ ‘«¦ ®œå˜ „«˜ ¨å˜ª'
                Writeln Channel 7 '                            '
                Get Validate_R1_Eidos                               to isOk
                Get Validate_R1_Fax                                 to isOk
                Get Validate_R1_Thlefono                            to isOk
                Get Validate_R1_TK                                  to isOk
                Get Validate_R1_Arithmos                            to isOk
                Get Validate_R1_Odos                                to isOk
                Get Validate_R1_Polh                                to isOk
                Get Validate_R1_Antikeimeno                         to isOk
                Get Validate_R1_Eponymia                            to isOk
                Get Validate_R1_Year                                to isOK
                Get Validate_R1_DOY                                 to isOK
                Get Validate_AFM  tmpMyf.R1_AFM  tmpMyf.R1_Eponymia to isOK
            
                ////////////////////////////////////////////////////////////////////////
                // „¢œš®¦ª œšš¨˜­é¤ «ç§¦¬ 2 - à¢ã©œà¤ ¡˜  3 ‘¬¤æ¢à¤ KANONIKOI PELATES//
                ////////////////////////////////////////////////////////////////////////
                Writeln Channel 7 '--------------------------------------------'
                Writeln Channel 7 '‘­á¢£˜«˜ ©« ª „šš¨˜­âª à¢ã©œà¤ (•¨œà©« ¡âª)'
                Writeln Channel 7 '                                            '
            
                Move 0 to iPlhthosKan
                Move 0 to iPlhthosDhm
                Move 0 to iPlhthosTotal
                Move 0 to nAxiaKan
                Move 0 to nAxiaDhm
                Move 0 to nAxiaTotal
            
                // Mazepse polhseis se kanonikous pelates
                Clear tmpMyf
                Lock
                Move (piMyfYear(Self))     to tmpMyf.Myf_Year
                Move '01'                  to tmpMyf.Module
                Move 2                     to tmpMyf.Typos_Record
                Find GT tmpMyf By Index.2
                While ((Found) And (tmpMyf.Myf_Year    =(piMyfYear(Self)))      And ;
                                   (tmpMyf.Module      ='01')                   And ;
                                   (tmpMyf.Typos_Record=2))
                    Set Label Of frmMessage to (Trim(tmpMyf.Client_Name))
            
                    Add tmpMyf.Plhthos  to iPlhthosKan
                    Add tmpMyf.Axia     to nAxiaKan
            
                    If (tmpMyf.Ypoxreos=0) Get Validate_Afm tmpMyf.AFM tmpMyf.Client_Name   to isOk
                    Else                   Get Validate_Mh_Ypoxreos_AFM                     to isOk
                    Get Validate_Ypoxreos   to isOk
                    Get Validate_Polh       to isOk
                    Get Validate_Odos       to isOk
                    //Get Validate_Arithmos   to isOk
                    //Get Validate_TK         to isOk
                    Get Validate_Plhthos    to isOk
            
                    Find GT tmpMyf By Index.2
                Loop
                Unlock
            
                // Elegxos me ta synola mono an exei eggrafes typou 2
                If (iPlhthosKan) Begin
                    Clear tmpMyf
                    Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                    Move '01'               to tmpMyf.Module
                    Move 3                  to tmpMyf.Typos_Record
                    Move ''                 to tmpMyf.Client_ID
                    Find Eq tmpMyf By Index.2
                    If (Not(Found)) Begin
                        Writeln Channel 7 'ƒœ¤ ¨âŸ¡˜¤ ‘ç¤¦¢˜ à¢ã©œà¤ (•¨œà©« ¡á)'
                        Set piLathi to (piLathi(Self)+1)
                    End
                    Else If ((iPlhthosKan<>tmpMyf.S_Plhthos_Kan) Or (nAxiaKan<>tmpMyf.S_Axia_Kan)) Begin
                        Writeln Channel 7 '‘­á¢£˜ ©«˜ ‘ç¤¦¢˜ à¢ã©œà¤ (•¨œà©« ¡á)'
                        Set piLathi to (piLathi(Self)+1)
                        If (nAxiaKan<>tmpMyf.S_Axia_Kan) Begin
                            Write   Channel 7 '„£­˜¤åœ«˜  £ ˜ › ˜­¦¨á '
                            Write   Channel 7 (String(nAxiaKan-tmpMyf.S_Axia_Kan))
                            Write   Channel 7 ' „¬¨é ©«¤ ˜¥å˜ «à¤ « £¦¢¦šåà¤. ˜¨˜¡˜¢é œ¢âš¥«œ «¦.'
                            Writeln Channel 7
                        End
                        If (tmpMyf.S_Plhthos_Kan<>iPlhthosKan) Begin
                            Write   Channel 7 '„£­˜¤åœ«˜  £ ˜ §¦©¦« ¡ã › ˜­¦¨á '
                            Write   Channel 7 (String(iPlhthosKan-tmpMyf.S_Plhthos_Kan))
                            Write   Channel 7 ' « £¦¢¦šåà¤. ˜¨˜¡˜¢é œ¢âš¥«œ «¦.'
                            Writeln Channel 7
                        End
                    End
                End
            
                //////////////////////////////////////////////////////////////////
                // „¢œš®¦ª œšš¨˜­é¤ «ç§¦¬ 12 - à¢ã©œà¤ ¡˜  13 ‘¬¤æ¢à¤ DHMOSIOU //
                //////////////////////////////////////////////////////////////////
                Writeln Channel 7 '-----------------------------------------------------'
                Writeln Channel 7 '‘­á¢£˜«˜ ©« ª „šš¨˜­âª à¢ã©œà¤ (•¨œà©« ¡âª) ƒ†‹‘ˆ“'
                Writeln Channel 7 '                                                     '
            
                Move 0 to iPlhthosKan
                Move 0 to iPlhthosDhm
                Move 0 to iPlhthosTotal
                Move 0 to nAxiaKan
                Move 0 to nAxiaDhm
                Move 0 to nAxiaTotal
            
                // Mazepse polhseis se pelates dhmosiou
                Clear tmpMyf
                Lock
                Move (piMyfYear(Self))     to tmpMyf.Myf_Year
                Move '01'                  to tmpMyf.Module
                Move 12                    to tmpMyf.Typos_Record
                Find GT tmpMyf By Index.2
                While ((Found) And (tmpMyf.Myf_Year    =(piMyfYear(Self)))      And ;
                                   (tmpMyf.Module      ='01')                   And ;
                                   (tmpMyf.Typos_Record=12))
                    Set Label Of frmMessage to (Trim(tmpMyf.Client_Name))
            
                    Add tmpMyf.Plhthos  to iPlhthosDhm
                    Add tmpMyf.Axia     to nAxiaDhm
            
            //        If (tmpMyf.Ypoxreos=0) Get Validate_Afm tmpMyf.AFM tmpMyf.Client_Name   to isOk
            //        Else                   Get Validate_Mh_Ypoxreos_AFM                     to isOk
                    Get Validate_Ypoxreos   to isOk
                    Get Validate_Polh       to isOk
                    Get Validate_Odos       to isOk
                    //Get Validate_Arithmos   to isOk
                    //Get Validate_TK         to isOk
                    Get Validate_Plhthos    to isOk
                    Find GT tmpMyf By Index.2
                Loop
                Unlock
                // Elegxos me ta synola mono an yparxoun eggrafes typou 12
                If (iPlhthosDhm) Begin
                    Clear tmpMyf
                    Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                    Move '01'               to tmpMyf.Module
                    Move 13                 to tmpMyf.Typos_Record
                    Move ''                 to tmpMyf.Client_ID
                    Find Eq tmpMyf By Index.2
                    If (Not(Found)) Begin
                        Writeln Channel 7 'ƒœ¤ ¨âŸ¡˜¤ ‘ç¤¦¢˜ à¢ã©œà¤ (•¨œà©« ¡á) ƒ†‹‘ˆ“'
                        Set piLathi to (piLathi(Self)+1)
                    End
                    Else If ((iPlhthosDhm<>tmpMyf.S_Plhthos_Dhm) Or (nAxiaDhm<>tmpMyf.S_Axia_Dhm)) Begin
                        Writeln Channel 7 '‘­á¢£˜ ©«˜ ‘ç¤¦¢˜ à¢ã©œà¤ (•¨œà©« ¡á) ƒ†‹‘ˆ“'
                        Set piLathi to (piLathi(Self)+1)
                        If (nAxiaDhm<>tmpMyf.S_Axia_Dhm) Begin
                            Write   Channel 7 '„£­˜¤åœ«˜  £ ˜ › ˜­¦¨á '
                            Write   Channel 7 (String(nAxiaDhm-tmpMyf.S_Axia_Dhm))
                            Write   Channel 7 ' „¬¨é ©«¤ ˜¥å˜ «à¤ « £¦¢¦šåà¤. ˜¨˜¡˜¢é œ¢âš¥«œ «¦.'
                            Writeln Channel 7
                        End
                        If (tmpMyf.S_Plhthos_Dhm<>iPlhthosDhm) Begin
                            Write   Channel 7 '„£­˜¤åœ«˜  £ ˜ §¦©¦« ¡ã › ˜­¦¨á '
                            Write   Channel 7 (String(iPlhthosDhm-tmpMyf.S_Plhthos_Dhm))
                            Write   Channel 7 ' « £¦¢¦šåà¤. ˜¨˜¡˜¢é œ¢âš¥«œ «¦.'
                            Writeln Channel 7
                        End
                    End
                End
            
            
                ////////////////////////////////////////////////////
                // „¢œš®¦ª œšš¨˜­é¤ «ç§¦¬ 4 - €š¦¨é¤ ¡˜  5 ‘¬¤æ¢à¤//
                ////////////////////////////////////////////////////
                Writeln Channel 7 '------------------------------------------'
                Writeln Channel 7 '‘­á¢£˜«˜ ©« ª œšš¨˜­âª €š¦¨é¤ (•¨œà©« ¡âª)'
                Writeln Channel 7 '                                          '
            
                Move 0 to iPlhthosKan
                Move 0 to iPlhthosDhm
                Move 0 to iPlhthosTotal
                Move 0 to nAxiaKan
                Move 0 to nAxiaDhm
                Move 0 to nAxiaTotal
            
                // Mazepse prota Agores apo kanonikous promhtheytes
                Clear tmpMyf
                Lock
                Move (piMyfYear(Self))     to tmpMyf.Myf_Year
                Move '02'                  to tmpMyf.Module
                Move 4                     to tmpMyf.Typos_Record
                Find GT tmpMyf By Index.2
                While ((Found) And (tmpMyf.Myf_Year    =(piMyfYear(Self)))      And ;
                                   (tmpMyf.Module      ='02')                   And ;
                                   (tmpMyf.Typos_Record=4))
                    Set Label Of frmMessage to (Trim(tmpMyf.Client_Name))
                    Add tmpMyf.Plhthos  to iPlhthosKan
                    Add tmpMyf.Axia     to nAxiaKan
                    If (tmpMyf.Ypoxreos=0) Get Validate_Afm tmpMyf.AFM tmpMyf.Client_Name to isOk
                    Else                   Get Validate_Mh_Ypoxreos_AFM to isOk
                    Get Validate_Ypoxreos to isOk
                    Get Validate_Polh       to isOk
                    Get Validate_Odos       to isOk
                    //Get Validate_Arithmos   to isOk
                    //Get Validate_TK         to isOk
                    Get Validate_Plhthos    to isOk
            
                    Find GT tmpMyf By Index.2
                Loop
                Unlock
                // Elegxos me ta synola mono an yparxoun eggrafes typou 12
                If (iPlhthosKan) Begin
                    Clear tmpMyf
                    Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                    Move '02'               to tmpMyf.Module
                    Move 5                  to tmpMyf.Typos_Record
                    Move ''                 to tmpMyf.Client_ID
                    Find Eq tmpMyf By Index.2
                    If (Not(Found)) Begin
                        Writeln Channel 7 'ƒœ¤ ¨âŸ¡˜¤ ‘ç¤¦¢˜ €š¦¨é¤ (•¨œà©« ¡á)'
                        Set piLathi to (piLathi(Self)+1)
                    End
                    Else If ((iPlhthosKan<>tmpMyf.S_Plhthos_Kan) Or (nAxiakan<>tmpMyf.S_Axia_Kan)) Begin
                        Writeln Channel 7 '‘­á¢£˜ ©«˜ ‘ç¤¦¢˜ €š¦¨é¤ (•¨œà©« ¡á)'
                        Set piLathi to (piLathi(Self)+1)
                        If (nAxiaKan<>tmpMyf.S_Axia_kan) Begin
                            Write   Channel 7 '„£­˜¤åœ«˜  £ ˜ › ˜­¦¨á '
                            Write   Channel 7 (String(nAxiaKan-tmpMyf.S_Axia_Total))
                            Write   Channel 7 ' „¬¨é ©«¤ ˜¥å˜ «à¤ « £¦¢¦šåà¤. ˜¨˜¡˜¢é œ¢âš¥«œ «¦.'
                            Writeln Channel 7
                        End
                        If (tmpMyf.S_Plhthos_kan<>iPlhthoskan) Begin
                            Write   Channel 7 '„£­˜¤åœ«˜  £ ˜ §¦©¦« ¡ã › ˜­¦¨á '
                            Write   Channel 7 (String(iPlhthosKan-tmpMyf.S_Plhthos_Kan))
                            Write   Channel 7 ' « £¦¢¦šåà¤. ˜¨˜¡˜¢é œ¢âš¥«œ «¦.'
                            Writeln Channel 7
                        End
                    End
                End
            
                /////////////////////////////////////////////////////////////
                // „¢œš®¦ª œšš¨˜­é¤ «ç§¦¬ 4 - €š¦¨é¤ ¡˜  5 ‘¬¤æ¢à¤ ƒ†‹‘ˆ“//
                /////////////////////////////////////////////////////////////
                Writeln Channel 7 '---------------------------------------------------'
                Writeln Channel 7 '‘­á¢£˜«˜ ©« ª œšš¨˜­âª €š¦¨é¤ (•¨œà©« ¡âª) ƒ†‹‘ˆ“'
                Writeln Channel 7 '                                                   '
            
                Move 0 to iPlhthosKan
                Move 0 to iPlhthosDhm
                Move 0 to iPlhthosTotal
                Move 0 to nAxiaKan
                Move 0 to nAxiaDhm
                Move 0 to nAxiaTotal
            
                // Mazepse prota Agores apo kanonikous promhtheytes
                Clear tmpMyf
                Lock
                Move (piMyfYear(Self))     to tmpMyf.Myf_Year
                Move '02'                  to tmpMyf.Module
                Move 14                    to tmpMyf.Typos_Record
                Find GT tmpMyf By Index.2
                While ((Found) And (tmpMyf.Myf_Year    =(piMyfYear(Self)))      And ;
                                   (tmpMyf.Module      ='02')                   And ;
                                   (tmpMyf.Typos_Record=14))
                    Set Label Of frmMessage to (Trim(tmpMyf.Client_Name))
                    Add tmpMyf.Plhthos  to iPlhthosDhm
                    Add tmpMyf.Axia     to nAxiaDhm
            //        If (tmpMyf.Ypoxreos=0) Get Validate_Afm tmpMyf.AFM tmpMyf.Client_Name to isOk
            //        Else                   Get Validate_Mh_Ypoxreos_AFM to isOk
                    Get Validate_Ypoxreos to isOk
                    Get Validate_Polh       to isOk
                    Get Validate_Odos       to isOk
                    //Get Validate_Arithmos   to isOk
                    //Get Validate_TK         to isOk
                    Get Validate_Plhthos    to isOk
                    Find GT tmpMyf By Index.2
                Loop
                Unlock
                // Elegxos me ta synola mono an yparxoun eggrafes typou 12
                If (iPlhthosDhm) Begin
                    Clear tmpMyf
                    Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                    Move '02'               to tmpMyf.Module
                    Move 15                 to tmpMyf.Typos_Record
                    Move ''                 to tmpMyf.Client_ID
                    Find Eq tmpMyf By Index.2
                    If (Not(Found)) Begin
                        Writeln Channel 7 'ƒœ¤ ¨âŸ¡˜¤ ‘ç¤¦¢˜ €š¦¨é¤ (•¨œà©« ¡á) ƒ†‹‘ˆ“'
                        Set piLathi to (piLathi(Self)+1)
                    End
                    Else If ((iPlhthosDhm<>tmpMyf.S_Plhthos_Dhm) Or (nAxiaDhm<>tmpMyf.S_Axia_Dhm)) Begin
                        Writeln Channel 7 '‘­á¢£˜ ©«˜ ‘ç¤¦¢˜ €š¦¨é¤ (•¨œà©« ¡á) ƒ†‹‘ˆ“'
                        Set piLathi to (piLathi(Self)+1)
                        If (nAxiaDhm<>tmpMyf.S_Axia_Dhm) Begin
                            Write   Channel 7 '„£­˜¤åœ«˜  £ ˜ › ˜­¦¨á '
                            Write   Channel 7 (String(nAxiaDhm-tmpMyf.S_Axia_Dhm))
                            Write   Channel 7 ' „¬¨é ©«¤ ˜¥å˜ «à¤ « £¦¢¦šåà¤. ˜¨˜¡˜¢é œ¢âš¥«œ «¦.'
                            Writeln Channel 7
                        End
                        If (tmpMyf.S_Plhthos_Dhm<>iPlhthosDhm) Begin
                            Write   Channel 7 '„£­˜¤åœ«˜  £ ˜ §¦©¦« ¡ã › ˜­¦¨á '
                            Write   Channel 7 (String(iPlhthosDhm-tmpMyf.S_Plhthos_Dhm))
                            Write   Channel 7 ' « £¦¢¦šåà¤. ˜¨˜¡˜¢é œ¢âš¥«œ «¦.'
                            Writeln Channel 7
                        End
                    End
                End
            
            ////////////////////////////////////////////////////
            ////////////////// ˆ‘’—’ˆ‰€ ///////////////////////
            ////////////////////////////////////////////////////
            
            
                //////////////////////////////////////////////////////////////////////////
                // „¢œš®¦ª œšš¨˜­é¤ «ç§¦¬ -2 - à¢ã©œà¤ ¡˜  -3 ‘¬¤æ¢à¤ KANONIKOI PELATES//
                //////////////////////////////////////////////////////////////////////////
                Writeln Channel 7 '--------------------------------------------'
                Writeln Channel 7 '‘­á¢£˜«˜ ©« ª „šš¨˜­âª à¢ã©œà¤ ( ©«à« ¡âª)'
                Writeln Channel 7 '                                            '
            
                Move 0 to iPlhthosKan
                Move 0 to iPlhthosDhm
                Move 0 to iPlhthosTotal
                Move 0 to nAxiaKan
                Move 0 to nAxiaDhm
                Move 0 to nAxiaTotal
            
                // Mazepse polhseis se kanonikous pelates
                Clear tmpMyf
                Lock
                Move (piMyfYear(Self))     to tmpMyf.Myf_Year
                Move '01'                  to tmpMyf.Module
                Move -2                    to tmpMyf.Typos_Record
                Find GT tmpMyf By Index.2
                While ((Found) And (tmpMyf.Myf_Year    =(piMyfYear(Self)))      And ;
                                   (tmpMyf.Module      ='01')                   And ;
                                   (tmpMyf.Typos_Record=-2))
                    Set Label Of frmMessage to (Trim(tmpMyf.Client_Name))
            
                    Add tmpMyf.Plhthos  to iPlhthosKan
                    Add tmpMyf.Axia     to nAxiaKan
            
                    If (tmpMyf.Ypoxreos=0) Get Validate_Afm tmpMyf.AFM tmpMyf.Client_Name   to isOk
                    Else                   Get Validate_Mh_Ypoxreos_AFM                     to isOk
                    Get Validate_Ypoxreos   to isOk
                    Get Validate_Polh       to isOk
                    Get Validate_Odos       to isOk
                    //Get Validate_Arithmos   to isOk
                    //Get Validate_TK         to isOk
                    Get Validate_Plhthos    to isOk
            
                    Find GT tmpMyf By Index.2
                Loop
                Unlock
            
                // Elegxos me ta synola mono an exei eggrafes typou -2
                If (iPlhthosKan) Begin
                    Clear tmpMyf
                    Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                    Move '01'               to tmpMyf.Module
                    Move -3                 to tmpMyf.Typos_Record
                    Move ''                 to tmpMyf.Client_ID
                    Find Eq tmpMyf By Index.2
                    If (Not(Found)) Begin
                        Writeln Channel 7 'ƒœ¤ ¨âŸ¡˜¤ ‘ç¤¦¢˜ à¢ã©œà¤ ( ©«à« ¡á)'
                        Set piLathi to (piLathi(Self)+1)
                    End
                    Else If ((iPlhthosKan<>tmpMyf.S_Plhthos_Kan) Or (nAxiaKan<>tmpMyf.S_Axia_Kan)) Begin
                        Writeln Channel 7 '‘­á¢£˜ ©«˜ ‘ç¤¦¢˜ à¢ã©œà¤ ( ©«à« ¡á)'
                        Set piLathi to (piLathi(Self)+1)
                        If (nAxiaKan<>tmpMyf.S_Axia_Kan) Begin
                            Write   Channel 7 '„£­˜¤åœ«˜  £ ˜ › ˜­¦¨á '
                            Write   Channel 7 (String(nAxiaKan-tmpMyf.S_Axia_Kan))
                            Write   Channel 7 ' „¬¨é ©«¤ ˜¥å˜ «à¤ « £¦¢¦šåà¤. ˜¨˜¡˜¢é œ¢âš¥«œ «¦.'
                            Writeln Channel 7
                        End
                        If (tmpMyf.S_Plhthos_Kan<>iPlhthosKan) Begin
                            Write   Channel 7 '„£­˜¤åœ«˜  £ ˜ §¦©¦« ¡ã › ˜­¦¨á '
                            Write   Channel 7 (String(iPlhthosKan-tmpMyf.S_Plhthos_Kan))
                            Write   Channel 7 ' « £¦¢¦šåà¤. ˜¨˜¡˜¢é œ¢âš¥«œ «¦.'
                            Writeln Channel 7
                        End
                    End
                End
            
                ////////////////////////////////////////////////////////////////////
                // „¢œš®¦ª œšš¨˜­é¤ «ç§¦¬ -12 - à¢ã©œà¤ ¡˜  -13 ‘¬¤æ¢à¤ DHMOSIOU //
                ////////////////////////////////////////////////////////////////////
                Writeln Channel 7 '-----------------------------------------------------'
                Writeln Channel 7 '‘­á¢£˜«˜ ©« ª „šš¨˜­âª à¢ã©œà¤ ( ©«à« ¡âª) ƒ†‹‘ˆ“'
                Writeln Channel 7 '                                                     '
            
                Move 0 to iPlhthosKan
                Move 0 to iPlhthosDhm
                Move 0 to iPlhthosTotal
                Move 0 to nAxiaKan
                Move 0 to nAxiaDhm
                Move 0 to nAxiaTotal
            
                // Mazepse polhseis se pelates dhmosiou
                Clear tmpMyf
                Lock
                Move (piMyfYear(Self))     to tmpMyf.Myf_Year
                Move '01'                  to tmpMyf.Module
                Move -12                   to tmpMyf.Typos_Record
                Find GT tmpMyf By Index.2
                While ((Found) And (tmpMyf.Myf_Year    =(piMyfYear(Self)))      And ;
                                   (tmpMyf.Module      ='01')                   And ;
                                   (tmpMyf.Typos_Record=(-12)))
                    Set Label Of frmMessage to (Trim(tmpMyf.Client_Name))
            
                    Add tmpMyf.Plhthos  to iPlhthosDhm
                    Add tmpMyf.Axia     to nAxiaDhm
            
            //        If (tmpMyf.Ypoxreos=0) Get Validate_Afm tmpMyf.AFM tmpMyf.Client_Name   to isOk
            //        Else                   Get Validate_Mh_Ypoxreos_AFM                     to isOk
                    Get Validate_Ypoxreos   to isOk
                    Get Validate_Polh       to isOk
                    Get Validate_Odos       to isOk
                    //Get Validate_Arithmos   to isOk
                    //Get Validate_TK         to isOk
                    Get Validate_Plhthos    to isOk
                    Find GT tmpMyf By Index.2
                Loop
                Unlock
                // Elegxos me ta synola mono an yparxoun eggrafes typou 12
                If (iPlhthosDhm) Begin
                    Clear tmpMyf
                    Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                    Move '01'               to tmpMyf.Module
                    Move -13                to tmpMyf.Typos_Record
                    Move ''                 to tmpMyf.Client_ID
                    Find Eq tmpMyf By Index.2
                    If (Not(Found)) Begin
                        Writeln Channel 7 'ƒœ¤ ¨âŸ¡˜¤ ‘ç¤¦¢˜ à¢ã©œà¤ ( ©«à« ¡á) ƒ†‹‘ˆ“'
                        Set piLathi to (piLathi(Self)+1)
                    End
                    Else If ((iPlhthosDhm<>tmpMyf.S_Plhthos_Dhm) Or (nAxiaDhm<>tmpMyf.S_Axia_Dhm)) Begin
                        Writeln Channel 7 '‘­á¢£˜ ©«˜ ‘ç¤¦¢˜ à¢ã©œà¤ ( ©«à« ¡á) ƒ†‹‘ˆ“'
                        Set piLathi to (piLathi(Self)+1)
                        If (nAxiaDhm<>tmpMyf.S_Axia_Dhm) Begin
                            Write   Channel 7 '„£­˜¤åœ«˜  £ ˜ › ˜­¦¨á '
                            Write   Channel 7 (String(nAxiaDhm-tmpMyf.S_Axia_Dhm))
                            Write   Channel 7 ' „¬¨é ©«¤ ˜¥å˜ «à¤ « £¦¢¦šåà¤. ˜¨˜¡˜¢é œ¢âš¥«œ «¦.'
                            Writeln Channel 7
                        End
                        If (tmpMyf.S_Plhthos_Dhm<>iPlhthosDhm) Begin
                            Write   Channel 7 '„£­˜¤åœ«˜  £ ˜ §¦©¦« ¡ã › ˜­¦¨á '
                            Write   Channel 7 (String(iPlhthosDhm-tmpMyf.S_Plhthos_Dhm))
                            Write   Channel 7 ' « £¦¢¦šåà¤. ˜¨˜¡˜¢é œ¢âš¥«œ «¦.'
                            Writeln Channel 7
                        End
                    End
                End
            
            
                //////////////////////////////////////////////////////
                // „¢œš®¦ª œšš¨˜­é¤ «ç§¦¬ -4 - €š¦¨é¤ ¡˜  -5 ‘¬¤æ¢à¤//
                //////////////////////////////////////////////////////
                Writeln Channel 7 '------------------------------------------'
                Writeln Channel 7 '‘­á¢£˜«˜ ©« ª œšš¨˜­âª €š¦¨é¤ ( ©«à« ¡âª)'
                Writeln Channel 7 '                                          '
            
                Move 0 to iPlhthosKan
                Move 0 to iPlhthosDhm
                Move 0 to iPlhthosTotal
                Move 0 to nAxiaKan
                Move 0 to nAxiaDhm
                Move 0 to nAxiaTotal
            
                // Mazepse prota Agores apo kanonikous promhtheytes
                Clear tmpMyf
                Lock
                Move (piMyfYear(Self))     to tmpMyf.Myf_Year
                Move '02'                  to tmpMyf.Module
                Move -4                    to tmpMyf.Typos_Record
                Find GT tmpMyf By Index.2
                While ((Found) And (tmpMyf.Myf_Year    =(piMyfYear(Self)))      And ;
                                   (tmpMyf.Module      ='02')                   And ;
                                   (tmpMyf.Typos_Record=(-4)))
                    Set Label Of frmMessage to (Trim(tmpMyf.Client_Name))
                    Add tmpMyf.Plhthos  to iPlhthosKan
                    Add tmpMyf.Axia     to nAxiaKan
                    If (tmpMyf.Ypoxreos=0) Get Validate_Afm tmpMyf.AFM tmpMyf.Client_Name to isOk
                    Else                   Get Validate_Mh_Ypoxreos_AFM to isOk
                    Get Validate_Ypoxreos to isOk
                    Get Validate_Polh       to isOk
                    Get Validate_Odos       to isOk
                    //Get Validate_Arithmos   to isOk
                    //Get Validate_TK         to isOk
                    Get Validate_Plhthos    to isOk
            
                    Find GT tmpMyf By Index.2
                Loop
                Unlock
                // Elegxos me ta synola mono an yparxoun eggrafes typou -12
                If (iPlhthosKan) Begin
                    Clear tmpMyf
                    Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                    Move '02'               to tmpMyf.Module
                    Move -5                 to tmpMyf.Typos_Record
                    Move ''                 to tmpMyf.Client_ID
                    Find Eq tmpMyf By Index.2
                    If (Not(Found)) Begin
                        Writeln Channel 7 'ƒœ¤ ¨âŸ¡˜¤ ‘ç¤¦¢˜ €š¦¨é¤ (•¨œà©« ¡á)'
                        Set piLathi to (piLathi(Self)+1)
                    End
                    If ((iPlhthosKan<>tmpMyf.S_Plhthos_Kan) Or (nAxiakan<>tmpMyf.S_Axia_Kan)) Begin
                        Writeln Channel 7 '‘­á¢£˜ ©«˜ ‘ç¤¦¢˜ €š¦¨é¤ ( ©«à« ¡á)'
                        Set piLathi to (piLathi(Self)+1)
                        If (nAxiaKan<>tmpMyf.S_Axia_kan) Begin
                            Write   Channel 7 '„£­˜¤åœ«˜  £ ˜ › ˜­¦¨á '
                            Write   Channel 7 (String(nAxiaKan-tmpMyf.S_Axia_Total))
                            Write   Channel 7 ' „¬¨é ©«¤ ˜¥å˜ «à¤ « £¦¢¦šåà¤. ˜¨˜¡˜¢é œ¢âš¥«œ «¦.'
                            Writeln Channel 7
                        End
                        If (tmpMyf.S_Plhthos_kan<>iPlhthoskan) Begin
                            Write   Channel 7 '„£­˜¤åœ«˜  £ ˜ §¦©¦« ¡ã › ˜­¦¨á '
                            Write   Channel 7 (String(iPlhthosKan-tmpMyf.S_Plhthos_Kan))
                            Write   Channel 7 ' « £¦¢¦šåà¤. ˜¨˜¡˜¢é œ¢âš¥«œ «¦.'
                            Writeln Channel 7
                        End
                    End
                End
            
                ///////////////////////////////////////////////////////////////
                // „¢œš®¦ª œšš¨˜­é¤ «ç§¦¬ -4 - €š¦¨é¤ ¡˜  -5 ‘¬¤æ¢à¤ ƒ†‹‘ˆ“//
                ///////////////////////////////////////////////////////////////
                Writeln Channel 7 '---------------------------------------------------'
                Writeln Channel 7 '‘­á¢£˜«˜ ©« ª œšš¨˜­âª €š¦¨é¤ ( ©«à« ¡âª) ƒ†‹‘ˆ“'
                Writeln Channel 7 '                                                   '
            
                Move 0 to iPlhthosKan
                Move 0 to iPlhthosDhm
                Move 0 to iPlhthosTotal
                Move 0 to nAxiaKan
                Move 0 to nAxiaDhm
                Move 0 to nAxiaTotal
            
                // Mazepse prota Agores apo kanonikous promhtheytes
                Clear tmpMyf
                Lock
                Move (piMyfYear(Self))     to tmpMyf.Myf_Year
                Move '02'                  to tmpMyf.Module
                Move -14                   to tmpMyf.Typos_Record
                Find GT tmpMyf By Index.2
                While ((Found) And (tmpMyf.Myf_Year    =(piMyfYear(Self)))      And ;
                                   (tmpMyf.Module      ='02')                   And ;
                                   (tmpMyf.Typos_Record=(-14)))
                    Set Label Of frmMessage to (Trim(tmpMyf.Client_Name))
                    Add tmpMyf.Plhthos  to iPlhthosDhm
                    Add tmpMyf.Axia     to nAxiaDhm
            //        If (tmpMyf.Ypoxreos=0) Get Validate_Afm tmpMyf.AFM tmpMyf.Client_Name to isOk
            //        Else                   Get Validate_Mh_Ypoxreos_AFM to isOk
                    Get Validate_Ypoxreos to isOk
                    Get Validate_Polh       to isOk
                    Get Validate_Odos       to isOk
                    //Get Validate_Arithmos   to isOk
                    //Get Validate_TK         to isOk
                    Get Validate_Plhthos    to isOk
                    Find GT tmpMyf By Index.2
                Loop
                Unlock
                // Elegxos me ta synola mono an yparxoun eggrafes typou -12
                If (iPlhthosDhm) Begin
                    Clear tmpMyf
                    Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                    Move '02'               to tmpMyf.Module
                    Move -15                to tmpMyf.Typos_Record
                    Move ''                 to tmpMyf.Client_ID
                    Find Eq tmpMyf By Index.2
                    If (Not(Found)) Begin
                        Writeln Channel 7 'ƒœ¤ ¨âŸ¡˜¤ ‘ç¤¦¢˜ €š¦¨é¤ ( ©«à« ¡á) ƒ†‹‘ˆ“'
                        Set piLathi to (piLathi(Self)+1)
                    End
                    If ((iPlhthosDhm<>tmpMyf.S_Plhthos_Dhm) Or (nAxiaDhm<>tmpMyf.S_Axia_Dhm)) Begin
                        Writeln Channel 7 '‘­á¢£˜ ©«˜ ‘ç¤¦¢˜ €š¦¨é¤ ( ©«à« ¡á) ƒ†‹‘ˆ“'
                        Set piLathi to (piLathi(Self)+1)
                        If (nAxiaDhm<>tmpMyf.S_Axia_Dhm) Begin
                            Write   Channel 7 '„£­˜¤åœ«˜  £ ˜ › ˜­¦¨á '
                            Write   Channel 7 (String(nAxiaDhm-tmpMyf.S_Axia_Dhm))
                            Write   Channel 7 ' „¬¨é ©«¤ ˜¥å˜ «à¤ « £¦¢¦šåà¤. ˜¨˜¡˜¢é œ¢âš¥«œ «¦.'
                            Writeln Channel 7
                        End
                        If (tmpMyf.S_Plhthos_Dhm<>iPlhthosDhm) Begin
                            Write   Channel 7 '„£­˜¤åœ«˜  £ ˜ §¦©¦« ¡ã › ˜­¦¨á '
                            Write   Channel 7 (String(iPlhthosDhm-tmpMyf.S_Plhthos_Dhm))
                            Write   Channel 7 ' « £¦¢¦šåà¤. ˜¨˜¡˜¢é œ¢âš¥«œ «¦.'
                            Writeln Channel 7
                        End
                    End
                End
            ////////////////////////////////////////////////////
            
                Close_Output Channel 7
            
                Set Label Of frmMessage to ''
            
                If (piLathi(Self)<>0) Begin
                    Send Deixe_Ta_Lathi "C:\ErrMyf.log"
                End
                Else Begin
                    EraseFile "C:\ErrMyf.log"
                    Get YesNo_Box '  œšš¨˜­âª œå¤˜  ©à©«âª.\nŒ˜ §¨¦®à¨ã©à ©«¤ ›£ ¦¬¨šå˜ «à¤ ˜¨®œåà¤' to iYes
                    If (iYes=MBR_NO) Procedure_Return
                    BEGIN_TRANSACTION
                        Move Error_Object_ID to iErrorObjID
                        Send Make_Ascii_Files_Xreostika
                        Send Make_Ascii_Files_Pistotika
                    END_TRANSACTION
                    Unlock
                    Move iErrorObjID to Error_Object_ID
                End
                Send Rebuild_All_Constraints
            End_Procedure
            
            
            
            
            //AB-StoreEnd

        End_Object    // btnMakeAscii

        Object frmMessage is a ButtonSub
            Set Size to 12 169
            Set Location to 10 350
            Set Border_Style to Border_StaticEdge
            Set Focus_Mode to NonFocusable
            Set Form_TypeFace Item 0 to "MS Sans Serif"

            //AB-StoreStart
            Procedure OnClick
            
            End_Procedure // OnClick
            //AB-StoreEnd

        End_Object    // frmMessage

        Object dbTabDialogSView1 is a dbTabDialogViewSubS
            Set Size to 254 518
            Set Location to 22 3
            Object dbTabView1 is a dbTabView
                Set Label to "dbTabView1"

                //AB-DDOStart

                Object Tmpmyf_DD is a tmpMyf_DataDictionary

                    //AB-StoreStart
                                                                                                                                                                                                                                                                                                                                                                                                                                
                    Procedure OnConstrain
                        Set Ordering to 1
                        Forward Send OnConstrain
                        Constrain tmpMyf.Myf_Year       Eq (piMyfYear(Self))
                        Constrain tmpMyf.Typos_Record   Eq 1
                    End_Procedure
                    
                    Procedure Save_Main_File
                        Integer isOK
                        Get Validate_AFM2 tmpMyf.AFM  to isOK
                        Move isOK to tmpMyf.Wrong_AFM
                        Forward Send Save_Main_File
                    End_Procedure   // Save_Main_File
                    
                    
                    
                    
                    //AB-StoreEnd

                End_Object    // Tmpmyf_DD

                Set Main_DD to (Tmpmyf_DD(self))
                Set Server to (Tmpmyf_DD(self))

                //AB-DDOEnd

                Object Tmpmyf_Myf_year is a dbFormSub
                    Entry_Item Tmpmyf.Myf_year
                    Set Label to "„«¦ª"
                    Set Size to 13 30
                    Set Location to 16 95
                    Set Label_Col_Offset to 5
                    Set Label_Justification_Mode to jMode_Right
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                End_Object    // Tmpmyf_Myf_year

                Object Tmpmyf_R1_Doy is a dbFormSub
                    Entry_Item Tmpmyf.R1_doy
                    Set Label to "ƒ“"
                    Set Size to 13 30
                    Set Location to 31 95
                    Set Label_Col_Offset to 5
                    Set Label_Justification_Mode to jMode_Right
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                End_Object    // Tmpmyf_R1_Doy

                Object Tmpmyf_R1_Ar_Fakel is a dbFormSub
                    Entry_Item Tmpmyf.R1_ar_fakel
                    Set Label to "€¨. ”˜¡â¢¢¦¬"
                    Set Size to 13 42
                    Set Location to 46 95
                    Set Label_Col_Offset to 5
                    Set Label_Justification_Mode to jMode_Right
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                End_Object    // Tmpmyf_R1_Ar_Fakel

                Object Tmpmyf_R1_Eponymia is a dbFormSub
                    Entry_Item Tmpmyf.R1_eponymia
                    Set Label to "„§à¤¬£å˜"
                    Set Size to 13 114
                    Set Location to 60 95
                    Set Label_Col_Offset to 5
                    Set Label_Justification_Mode to jMode_Right
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                End_Object    // Tmpmyf_R1_Eponymia

                Object Tmpmyf_R1_Afm is a dbFormSub
                    Entry_Item Tmpmyf.R1_afm
                    Set Label to "€”‹"
                    Set Size to 13 60
                    Set Location to 74 95
                    Set Label_Col_Offset to 5
                    Set Label_Justification_Mode to jMode_Right
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                End_Object    // Tmpmyf_R1_Afm

                Object Tmpmyf_R1_Antikeimeno is a dbFormSub
                    Entry_Item Tmpmyf.R1_antikeimeno
                    Set Label to "€¤« ¡œå£œ¤¦"
                    Set Size to 13 102
                    Set Location to 89 95
                    Set Label_Col_Offset to 5
                    Set Label_Justification_Mode to jMode_Right
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                End_Object    // Tmpmyf_R1_Antikeimeno

                Object Tmpmyf_R1_Polh is a dbFormSub
                    Entry_Item Tmpmyf.R1_polh
                    Set Label to "æ¢"
                    Set Size to 13 66
                    Set Location to 103 95
                    Set Label_Col_Offset to 5
                    Set Label_Justification_Mode to jMode_Right
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                End_Object    // Tmpmyf_R1_Polh

                Object Tmpmyf_R1_Odos is a dbFormSub
                    Entry_Item Tmpmyf.R1_odos
                    Set Label to "›æª"
                    Set Size to 13 102
                    Set Location to 118 95
                    Set Label_Col_Offset to 5
                    Set Label_Justification_Mode to jMode_Right
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                End_Object    // Tmpmyf_R1_Odos

                Object Tmpmyf_R1_Arithmos is a dbFormSub
                    Entry_Item Tmpmyf.R1_arithmos
                    Set Label to "€¨ Ÿ£æª"
                    Set Size to 13 27
                    Set Location to 132 95
                    Set Label_Col_Offset to 5
                    Set Label_Justification_Mode to jMode_Right
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                End_Object    // Tmpmyf_R1_Arithmos

                Object Tmpmyf_R1_Tk is a dbFormSub
                    Entry_Item Tmpmyf.R1_tk
                    Set Label to "’‰"
                    Set Size to 13 36
                    Set Location to 146 95
                    Set Label_Col_Offset to 5
                    Set Label_Justification_Mode to jMode_Right
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                End_Object    // Tmpmyf_R1_Tk

                Object Tmpmyf_R1_Thlefono is a dbFormSub
                    Entry_Item Tmpmyf.R1_thlefono
                    Set Label to "’¢â­à¤¦"
                    Set Size to 13 66
                    Set Location to 161 95
                    Set Label_Col_Offset to 5
                    Set Label_Justification_Mode to jMode_Right
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                End_Object    // Tmpmyf_R1_Thlefono

                Object Tmpmyf_R1_Fax is a dbFormSub
                    Entry_Item Tmpmyf.R1_fax
                    Set Label to "”˜¥"
                    Set Size to 13 66
                    Set Location to 175 95
                    Set Label_Col_Offset to 5
                    Set Label_Justification_Mode to jMode_Right
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                End_Object    // Tmpmyf_R1_Fax

                Object Tmpmyf_R1_Email is a dbFormSub
                    Entry_Item Tmpmyf.R1_email
                    Set Label to "Email"
                    Set Size to 13 210
                    Set Location to 190 95
                    Set Label_Col_Offset to 5
                    Set Label_Justification_Mode to jMode_Right
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                End_Object    // Tmpmyf_R1_Email

                Object Tmpmyf_R1_Eidos is a dbFormSub
                    Entry_Item Tmpmyf.R1_eidos
                    Set Label to "„å›¦ª"
                    Set Size to 13 34
                    Set Location to 204 95
                    Set Label_Col_Offset to 5
                    Set Label_Justification_Mode to jMode_Right
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                End_Object    // Tmpmyf_R1_Eidos

                Object dHmniaPrev is a cSyDateForm
                    Set Size to 13 66
                    Set Location to 44 434
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to jMode_Right
                    Set Form_Mask Item 0 to "dd/MM/yyyy"
                    Set Form_TypeFace Item 0 to "MS Sans Serif"

                    //AB-StoreStart
                                                                                                                                                                                                                                                                                                                                                                                                                                
                    //AB-StoreEnd

                End_Object    // dHmniaPrev

                Object TextBoxSub17 is a TextBoxSub
                    Set Label to "†£œ¨/¤å˜ â¤˜¨¥ª ’ £¦¢æš©ª PROTEM"
                    Set Location to 13 431
                    Set Size to 25 70
                    Set Justification_Mode to jMode_Center
                    Set TypeFace to "MS Sans Serif"
                End_Object    // TextBoxSub17

                Object LineControlSub1 is a LineControlSub
                    Set Horizontal_State to FALSE
                    Set Size to 77 2
                    Set Location to 2 420
                End_Object    // LineControlSub1

                Object LineControlSub2 is a LineControlSub
                    Set Size to 2 91
                    Set Location to 79 420
                End_Object    // LineControlSub2


                //AB-StoreStart
                                                                                                                                                                                                                                                                                                                                
                Set Label to '„«˜ ¨å˜'
                
                
                //AB-StoreEnd

            End_Object    // dbTabView1

            Object dbTabView2 is a dbTabView

                //AB-StoreTopStart
                                                                                                                                                                                                                                                                                                                                
                Object tmpMyf_DD2 is a tmpMyf_DataDictionary
                    Procedure OnConstrain
                        Set Ordering to 1
                        Forward Send OnConstrain
                        Constrain tmpMyf.Myf_Year       Eq (piMyfYear(Self))
                        Constrain tmpMyf.Typos_Record   Eq 3
                        Constrain tmpMyf.Module         Eq '01'
                    End_Procedure
                End_Object
                
                //AB-StoreTopEnd

                Set Label to "dbTabView2"

                //AB-DDOStart

                Object Tmpmyf_DD is a tmpMyf_DataDictionary

                    //AB-StoreTopStart
                                    
                    //AB-StoreTopEnd


                    //AB-StoreStart
                                    
                    Procedure OnConstrain
                        Set Ordering to 1
                        Forward Send OnConstrain
                        Constrain tmpMyf.Myf_Year       Eq (piMyfYear(Self))
                        Constrain tmpMyf.Typos_Record   Eq 2
                        Constrain tmpMyf.Module         Eq '01'
                    End_Procedure
                    
                    procedure update
                        forward  send update
                        Move SyscurXr.Company_Code              to tmpMyf.Company_Code
                        Move (psBranch(Self))                   to tmpMyf.Branch_Code
                        move  (piMyfYear(Self)) to  tmpMyf.Myf_Year
                        move 2 to  tmpMyf.Typos_Record
                        move '01' to tmpMyf.Module
                    end_procedure
                    
                    Procedure Save_Main_File
                        Integer isOK
                        Get Validate_AFM2 tmpMyf.AFM  to isOK
                        Move isOK to tmpMyf.Wrong_AFM
                        Forward Send Save_Main_File
                    End_Procedure   // Save_Main_File
                    
                    Procedure Request_Save000
                        Integer isOK3
                        Forward Send Request_Save
                        Send ChangeAllFileModes                                DF_Filemode_ReadOnly
                        Set_Attribute DF_File_Mode Of tmpMyf.File_Number    to DF_Filemode_Default
                        Set_Attribute DF_File_Mode Of tmpMyfA.File_Number   to DF_Filemode_Default
                        Get fiMake_Record_3 to isOK3
                        Send ChangeAllFileModes DF_Filemode_Default
                        Send Rebuild_All_Constraints
                        Send Clear to Branch_DD
                    End_Procedure
                    
                    Procedure Request_Delete
                        Integer isOK3 iYes
                        Get YesNo_Box '€¤ › ˜š¨á¯œ«œ «¤ š¨˜££ã, Ÿ˜ §¨â§œ  ¤˜ ¥˜¤˜«¨â¥œ«œ\n«¦¬ª ¬§¦š ©£¦çª ©œ §œ¨å§«à© ¢áŸ¦¬ª\nŒ˜ › ˜š¨˜­œå  œšš¨˜­ã ?' to iYes
                        If (iYes=MBR_NO) Procedure_Return
                        Forward Send Request_Delete
                        Get YesNo_Box 'Œ˜ œ§˜¤˜¬§¦¢¦š ©«¦ç¤ «˜ ©ç¤¦¢˜ ?' to iYes
                        If (iYes=MBR_YES) begin
                            Send ChangeAllFileModes                                DF_Filemode_ReadOnly
                            Set_Attribute DF_File_Mode Of tmpMyf.File_Number    to DF_Filemode_Default
                            Set_Attribute DF_File_Mode Of tmpMyfA.File_Number   to DF_Filemode_Default
                            Get fiMake_Record_3 to isOK3
                            Send ChangeAllFileModes DF_Filemode_Default
                        End
                        Send Rebuild_All_Constraints
                        Send Clear to Branch_DD
                    End_Procedure
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    //AB-StoreEnd

                End_Object    // Tmpmyf_DD

                Set Main_DD to (Tmpmyf_DD(self))
                Set Server to (Tmpmyf_DD(self))

                //AB-DDOEnd

                Object tmpMyf_ is a dbGridSub
                    Set Main_File to Tmpmyf.File_Number
                    Set Ordering to 1
                    Set Size to 190 505
                    Set Location to 2 3
                    Set Wrap_State to TRUE

                    Begin_Row
                        Entry_Item Tmpmyf.Aa
                        Entry_Item Tmpmyf.Afm
                        Entry_Item Tmpmyf.Client_id
                        Entry_Item Tmpmyf.Client_name
                        Entry_Item Tmpmyf.Job
                        Entry_Item Tmpmyf.Ypoxreos
                        Entry_Item Tmpmyf.Polh
                        Entry_Item Tmpmyf.Odos
                        Entry_Item Tmpmyf.Arithmos
                        Entry_Item Tmpmyf.Tk
                        Entry_Item Tmpmyf.Plhthos
                        Entry_Item Tmpmyf.Axia
                    End_Row

                    Set Form_Width    item 0 to 24
                    Set Header_Label  item 0 to "˜/˜"
                    
                    Set Form_Width    item 1 to 45
                    Set Header_Label  item 1 to "€”‹"
                    
                    Set Form_Width    item 2 to 55
                    Set Header_Label  item 2 to "‰à›"
                    
                    Set Form_Width    item 3 to 69
                    Set Header_Label  item 3 to "œ¢á«ª"
                    
                    Set Form_Width    item 4 to 51
                    Set Header_Label  item 4 to "„§áššœ¢£˜"
                    
                    Set Form_Width    item 5 to 14
                    Set Header_Label  item 5 to "“"
                    Set Column_Checkbox_State  item 5 to True
                    
                    Set Form_Width    item 6 to 42
                    Set Header_Label  item 6 to "æ¢"
                    
                    Set Form_Width    item 7 to 37
                    Set Header_Label  item 7 to "›æª"
                    
                    Set Form_Width    item 8 to 29
                    Set Header_Label  item 8 to "€¨ Ÿ"
                    
                    Set Form_Width    item 9 to 32
                    Set Header_Label  item 9 to "’‰"
                    
                    Set Form_Width    item 10 to 42
                    Set Header_Label  item 10 to "¢ãŸ¦ª"
                    
                    Set Form_Width    item 11 to 60
                    Set Header_Label  item 11 to "€¥å˜"
                    

                    //AB-StoreStart
                                                                    
                    Set Numeric_Mask    Item 11 to 14 2 ' ,*'
                    
                    //Set Column_Option Item  0 to NoEnter True
                    //Set Column_Option Item  2 to NoEnter True
                    //Set Column_Option Item  3 to NoEnter True
                    //Set Column_Option Item 10 to NoEnter True
                    //Set Column_Option Item 11 to NoEnter True
                    
                    
                    //Set Header_Tooltip Item 1 to '¥¡asdsadsd ˜›©˜©›˜©› ˜©›© ˜©››˜©˜©›˜©› ©››­©š¨š› «ªœ¨ ªœ¨ ›­š©›š©›'
                    
                    
                    
                    
                    
                    
                    
                    
                    //AB-StoreEnd

                End_Object    // tmpMyf_

                Object tmpMyf_Rs_Plhthos is a dbFormSub
                    Entry_Item Tmpmyf.S_plhthos_kan
                    Set Size to 13 59
                    Set Location to 220 351
                    Set Color to clBtnFace
                    Set TextColor to clRed
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to jMode_Right
                    Set Enabled_State to FALSE
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                    Set Item_Shadow_State Item 0 to TRUE
                    Set Shadow_State Item 0 to TRUE

                    //AB-StoreStart
                    Set Server to (tmpMyf_DD2(Self))
                    
                    //AB-StoreEnd

                End_Object    // tmpMyf_Rs_Plhthos

                Object TextBoxSub1 is a TextBoxSub
                    Set Label to "¢ãŸ¦ª ˜¨˜©«˜« ¡é¤"
                    Set Location to 201 353
                    Set Size to 18 55
                    Set Justification_Mode to jMode_Center
                    Set TypeFace to "MS Sans Serif"
                End_Object    // TextBoxSub1

                Object TextBoxSub2 is a TextBoxSub
                    Set Label to "€¥å˜ ’ £¦¢¦šåà¤"
                    Set Location to 201 435
                    Set Size to 17 47
                    Set Justification_Mode to jMode_Center
                    Set TypeFace to "MS Sans Serif"
                End_Object    // TextBoxSub2

                Object tmpMyf_Rs_axia is a dbFormSub
                    Entry_Item Tmpmyf.S_axia_kan
                    Set Size to 13 73
                    Set Location to 220 424
                    Set Color to clBtnFace
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to jMode_Right
                    Set Enabled_State to FALSE
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                    Set Item_Shadow_State Item 0 to TRUE
                    Set Shadow_State Item 0 to TRUE

                    //AB-StoreStart
                                                                                                                                                                                                                                                                                                                                                                                                                                
                    Set Numeric_Mask    Item 0 to 14 2 ' ,*'
                    
                    Set Server to (tmpMyf_DD2(Self))
                    
                    //AB-StoreEnd

                End_Object    // tmpMyf_Rs_axia


                //AB-StoreStart
                                                                                                                                                                                                                                                                                                                                
                Set Label to 'œ¢. •¨/¡¦å'
                
                
                
                //AB-StoreEnd

            End_Object    // dbTabView2

            Object dbTabView3 is a dbTabView

                //AB-StoreTopStart
                                                                                                                                                                                                                                                                                                                                
                Object tmpMyf_DD2 is a tmpMyf_DataDictionary
                    Procedure OnConstrain
                        Set Ordering to 1
                        Forward Send OnConstrain
                        Constrain tmpMyf.Myf_Year       Eq (piMyfYear(Self))
                        Constrain tmpMyf.Typos_Record   Eq (-3)
                        Constrain tmpMyf.Module         Eq '01'
                    End_Procedure
                End_Object
                
                //AB-StoreTopEnd

                Set Label to "dbTabView3"

                //AB-DDOStart

                Object Tmpmyf_DD is a tmpMyf_DataDictionary

                    //AB-StoreStart
                                                    
                    Procedure OnConstrain
                        Set Ordering to 1
                        Forward Send OnConstrain
                        Constrain tmpMyf.Myf_Year       Eq (piMyfYear(Self))
                        Constrain tmpMyf.Typos_Record   Eq (-2)
                        Constrain tmpMyf.Module         Eq '01'
                    End_Procedure
                    
                    procedure update
                        forward  send update
                    
                        Move SyscurXr.Company_Code              to tmpMyf.Company_Code
                        Move (psBranch(Self))                   to tmpMyf.Branch_Code
                        move  (piMyfYear(Self)) to  tmpMyf.Myf_Year
                        move -2 to  tmpMyf.Typos_Record
                        move '01' to tmpMyf.Module
                    end_procedure
                    
                    Procedure Request_Save000
                        Integer isOK3
                        Forward Send Request_Save
                        Send ChangeAllFileModes                                DF_Filemode_ReadOnly
                        Set_Attribute DF_File_Mode Of tmpMyf.File_Number    to DF_Filemode_Default
                        Set_Attribute DF_File_Mode Of tmpMyfA.File_Number   to DF_Filemode_Default
                        Get fiMake_Record_3 to isOK3
                        Send ChangeAllFileModes DF_Filemode_Default
                        Send Rebuild_All_Constraints
                        Send Clear to Branch_DD
                    End_Procedure
                    
                    Procedure Request_Delete
                        Integer isOK3 iYes
                        Get YesNo_Box '€¤ › ˜š¨á¯œ«œ «¤ š¨˜££ã, Ÿ˜ §¨â§œ  ¤˜ ¥˜¤˜«¨â¥œ«œ\n«¦¬ª ¬§¦š ©£¦çª ©œ §œ¨å§«à© ¢áŸ¦¬ª\nŒ˜ › ˜š¨˜­œå  œšš¨˜­ã ?' to iYes
                        If (iYes=MBR_NO) Procedure_Return
                        Forward Send Request_Delete
                    
                        Get YesNo_Box 'Œ˜ œ§˜¤˜¬§¦¢¦š ©«¦ç¤ «˜ ©ç¤¦¢˜ ?' to iYes
                        If (iYes=MBR_yes) begin
                            Send ChangeAllFileModes                                DF_Filemode_ReadOnly
                            Set_Attribute DF_File_Mode Of tmpMyf.File_Number    to DF_Filemode_Default
                            Set_Attribute DF_File_Mode Of tmpMyfA.File_Number   to DF_Filemode_Default
                            Get fiMake_Record_3 to isOK3
                            Send ChangeAllFileModes DF_Filemode_Default
                        End
                        Send Rebuild_All_Constraints
                        Send Clear to Branch_DD
                    End_Procedure
                    
                    
                    Procedure Save_Main_File
                        Integer isOK
                        Get Validate_AFM2 tmpMyf.AFM  to isOK
                        Move isOK to tmpMyf.Wrong_AFM
                        Forward Send Save_Main_File
                    End_Procedure   // Save_Main_File
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    //AB-StoreEnd

                End_Object    // Tmpmyf_DD

                Set Main_DD to (Tmpmyf_DD(self))
                Set Server to (Tmpmyf_DD(self))

                //AB-DDOEnd

                Object tmpMyf_ is a dbGridSub
                    Set Main_File to Tmpmyf.File_Number
                    Set Ordering to 1
                    Set Size to 190 505
                    Set Location to 2 3
                    Set Wrap_State to TRUE

                    Begin_Row
                        Entry_Item Tmpmyf.Aa
                        Entry_Item Tmpmyf.Afm
                        Entry_Item Tmpmyf.Client_id
                        Entry_Item Tmpmyf.Client_name
                        Entry_Item Tmpmyf.Job
                        Entry_Item Tmpmyf.Ypoxreos
                        Entry_Item Tmpmyf.Polh
                        Entry_Item Tmpmyf.Odos
                        Entry_Item Tmpmyf.Arithmos
                        Entry_Item Tmpmyf.Tk
                        Entry_Item Tmpmyf.Plhthos
                        Entry_Item Tmpmyf.Axia
                    End_Row

                    Set Form_Width    item 0 to 24
                    Set Header_Label  item 0 to "˜/˜"
                    
                    Set Form_Width    item 1 to 45
                    Set Header_Label  item 1 to "€”‹"
                    
                    Set Form_Width    item 2 to 55
                    Set Header_Label  item 2 to "‰à›"
                    
                    Set Form_Width    item 3 to 69
                    Set Header_Label  item 3 to "¨¦£/«ãª"
                    
                    Set Form_Width    item 4 to 51
                    Set Header_Label  item 4 to "„§áššœ¢£˜"
                    
                    Set Form_Width    item 5 to 14
                    Set Header_Label  item 5 to "“"
                    Set Column_Checkbox_State  item 5 to True
                    
                    Set Form_Width    item 6 to 42
                    Set Header_Label  item 6 to "æ¢"
                    
                    Set Form_Width    item 7 to 37
                    Set Header_Label  item 7 to "›æª"
                    
                    Set Form_Width    item 8 to 29
                    Set Header_Label  item 8 to "€¨ Ÿ"
                    
                    Set Form_Width    item 9 to 32
                    Set Header_Label  item 9 to "’‰"
                    
                    Set Form_Width    item 10 to 42
                    Set Header_Label  item 10 to "¢ãŸ¦ª"
                    
                    Set Form_Width    item 11 to 61
                    Set Header_Label  item 11 to "€¥å˜"
                    

                    //AB-StoreStart
                                                                    
                                                                    
                    Set Numeric_Mask    Item 11 to 14 2 ' ,*'
                    
                    //Set Column_Option Item  0 to NoEnter True
                    //Set Column_Option Item  2 to NoEnter True
                    //Set Column_Option Item  3 to NoEnter True
                    //Set Column_Option Item 10 to NoEnter True
                    //Set Column_Option Item 11 to NoEnter True
                    
                    
                    
                    
                    
                    
                    //AB-StoreEnd

                End_Object    // tmpMyf_

                Object TextBoxSub3 is a TextBoxSub
                    Set Label to "¢ãŸ¦ª ˜¨˜©«˜« ¡é¤"
                    Set Location to 201 353
                    Set Size to 18 55
                    Set Justification_Mode to jMode_Center
                    Set TypeFace to "MS Sans Serif"
                End_Object    // TextBoxSub3

                Object TextBoxSub4 is a TextBoxSub
                    Set Label to "€¥å˜ ’ £¦¢¦šåà¤"
                    Set Location to 201 435
                    Set Size to 17 47
                    Set Justification_Mode to jMode_Center
                    Set TypeFace to "MS Sans Serif"
                End_Object    // TextBoxSub4

                Object tmpMyf_Rs_Plhthos is a dbFormSub
                    Entry_Item Tmpmyf.S_plhthos_kan
                    Set Size to 13 59
                    Set Location to 220 351
                    Set Color to clBtnFace
                    Set TextColor to clRed
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to jMode_Right
                    Set Enabled_State to FALSE
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                    Set Item_Shadow_State Item 0 to TRUE
                    Set Shadow_State Item 0 to TRUE

                    //AB-StoreStart
                    Set Server to (tmpMyf_DD2(Self))
                    
                    //AB-StoreEnd

                End_Object    // tmpMyf_Rs_Plhthos

                Object tmpMyf_Rs_axia is a dbFormSub
                    Entry_Item Tmpmyf.S_axia_kan
                    Set Size to 13 73
                    Set Location to 220 424
                    Set Color to clBtnFace
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to jMode_Right
                    Set Enabled_State to FALSE
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                    Set Item_Shadow_State Item 0 to TRUE
                    Set Shadow_State Item 0 to TRUE

                    //AB-StoreStart
                                                                                                                                                                                                                                                                                                                                                                                                                                
                    Set Numeric_Mask    Item 0 to 14 2 ' ,*'
                    
                    Set Server to (tmpMyf_DD2(Self))
                    
                    //AB-StoreEnd

                End_Object    // tmpMyf_Rs_axia


                //AB-StoreStart
                                                                                                                                                                                                                                                                                                                                
                Set Label to 'œ¢. ©/¡¦å'
                
                
                
                
                
                //AB-StoreEnd

            End_Object    // dbTabView3

            Object dbTabView4 is a dbTabView

                //AB-StoreTopStart
                                                                                                                                                                                                                                                                                                                                
                Object tmpMyf_DD2 is a tmpMyf_DataDictionary
                    Procedure OnConstrain
                        Set Ordering to 1
                        Forward Send OnConstrain
                        Constrain tmpMyf.Myf_Year       Eq (piMyfYear(Self))
                        Constrain tmpMyf.Typos_Record   Eq 13
                        Constrain tmpMyf.Module         Eq '01'
                    End_Procedure
                End_Object
                
                //AB-StoreTopEnd

                Set Label to "dbTabView4"

                //AB-DDOStart

                Object Tmpmyf_DD is a tmpMyf_DataDictionary

                    //AB-StoreStart
                                                    
                    Procedure OnConstrain
                        Set Ordering to 1
                        Forward Send OnConstrain
                        Constrain tmpMyf.Myf_Year       Eq (piMyfYear(Self))
                        Constrain tmpMyf.Typos_Record   Eq 12
                        Constrain tmpMyf.Module         Eq '01'
                    End_Procedure
                    
                    procedure update
                        forward  send update
                        Move SyscurXr.Company_Code              to tmpMyf.Company_Code
                        Move (psBranch(Self))                   to tmpMyf.Branch_Code
                        move  (piMyfYear(Self)) to  tmpMyf.Myf_Year
                        move 12 to  tmpMyf.Typos_Record
                        move '01' to tmpMyf.Module
                    end_procedure
                    
                    Procedure Request_Save000
                        Integer isOK3
                        Forward Send Request_Save
                        Send ChangeAllFileModes                                DF_Filemode_ReadOnly
                        Set_Attribute DF_File_Mode Of tmpMyf.File_Number    to DF_Filemode_Default
                        Set_Attribute DF_File_Mode Of tmpMyfA.File_Number   to DF_Filemode_Default
                        Get fiMake_Record_3 to isOK3
                        Send ChangeAllFileModes DF_Filemode_Default
                        Send Rebuild_All_Constraints
                        Send Clear to Branch_DD
                    End_Procedure
                    
                    Procedure Request_Delete
                        Integer isOK3 iYes
                        Get YesNo_Box '€¤ › ˜š¨á¯œ«œ «¤ š¨˜££ã, Ÿ˜ §¨â§œ  ¤˜ ¥˜¤˜«¨â¥œ«œ\n«¦¬ª ¬§¦š ©£¦çª ©œ §œ¨å§«à© ¢áŸ¦¬ª\nŒ˜ › ˜š¨˜­œå  œšš¨˜­ã ?' to iYes
                        If (iYes=MBR_NO) Procedure_Return
                        Forward Send Request_Delete
                        Get YesNo_Box 'Œ˜ œ§˜¤˜¬§¦¢¦š ©«¦ç¤ «˜ ©ç¤¦¢˜ ?' to iYes
                        If (iYes=MBR_yes) begin
                            Send ChangeAllFileModes                                DF_Filemode_ReadOnly
                            Set_Attribute DF_File_Mode Of tmpMyf.File_Number    to DF_Filemode_Default
                            Set_Attribute DF_File_Mode Of tmpMyfA.File_Number   to DF_Filemode_Default
                            Get fiMake_Record_3 to isOK3
                            Send ChangeAllFileModes DF_Filemode_Default
                        End
                        Send Rebuild_All_Constraints
                        Send Clear to Branch_DD
                    End_Procedure
                    
                    
                    
                    
                    
                    
                    
                    //AB-StoreEnd

                End_Object    // Tmpmyf_DD

                Set Main_DD to (Tmpmyf_DD(self))
                Set Server to (Tmpmyf_DD(self))

                //AB-DDOEnd

                Object tmpMyf_ is a dbGridSub
                    Set Main_File to Tmpmyf.File_Number
                    Set Ordering to 1
                    Set Size to 190 505
                    Set Location to 2 3
                    Set Wrap_State to TRUE

                    Begin_Row
                        Entry_Item Tmpmyf.Aa
                        Entry_Item Tmpmyf.Afm
                        Entry_Item Tmpmyf.Client_id
                        Entry_Item Tmpmyf.Client_name
                        Entry_Item Tmpmyf.Job
                        Entry_Item Tmpmyf.Ypoxreos
                        Entry_Item Tmpmyf.Polh
                        Entry_Item Tmpmyf.Odos
                        Entry_Item Tmpmyf.Arithmos
                        Entry_Item Tmpmyf.Tk
                        Entry_Item Tmpmyf.Plhthos
                        Entry_Item Tmpmyf.Axia
                    End_Row

                    Set Form_Width    item 0 to 24
                    Set Header_Label  item 0 to "˜/˜"
                    
                    Set Form_Width    item 1 to 45
                    Set Header_Label  item 1 to "€”‹"
                    
                    Set Form_Width    item 2 to 55
                    Set Header_Label  item 2 to "‰à›"
                    
                    Set Form_Width    item 3 to 69
                    Set Header_Label  item 3 to "œ¢á«ª"
                    
                    Set Form_Width    item 4 to 51
                    Set Header_Label  item 4 to "„§áššœ¢£˜"
                    
                    Set Form_Width    item 5 to 14
                    Set Header_Label  item 5 to "“"
                    Set Column_Checkbox_State  item 5 to True
                    
                    Set Form_Width    item 6 to 42
                    Set Header_Label  item 6 to "æ¢"
                    
                    Set Form_Width    item 7 to 37
                    Set Header_Label  item 7 to "›æª"
                    
                    Set Form_Width    item 8 to 29
                    Set Header_Label  item 8 to "€¨ Ÿ"
                    
                    Set Form_Width    item 9 to 32
                    Set Header_Label  item 9 to "’‰"
                    
                    Set Form_Width    item 10 to 42
                    Set Header_Label  item 10 to "¢ãŸ¦ª"
                    
                    Set Form_Width    item 11 to 60
                    Set Header_Label  item 11 to "€¥å˜"
                    

                    //AB-StoreStart
                                                                    
                    Set Numeric_Mask    Item 11 to 14 2 ' ,*'
                    
                    //Set Column_Option Item  0 to NoEnter True
                    //Set Column_Option Item  2 to NoEnter True
                    //Set Column_Option Item  3 to NoEnter True
                    //Set Column_Option Item 10 to NoEnter True
                    //Set Column_Option Item 11 to NoEnter True
                    
                    
                    //Set Header_Tooltip Item 1 to '¥¡asdsadsd ˜›©˜©›˜©› ˜©›© ˜©››˜©˜©›˜©› ©››­©š¨š› «ªœ¨ ªœ¨ ›­š©›š©›'
                    
                    
                    
                    
                    
                    
                    
                    
                    //AB-StoreEnd

                End_Object    // tmpMyf_

                Object tmpMyf_Rs_Plhthos is a dbFormSub
                    Entry_Item Tmpmyf.S_plhthos_dhm
                    Set Size to 13 59
                    Set Location to 220 351
                    Set Color to clBtnFace
                    Set TextColor to clRed
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to jMode_Right
                    Set Enabled_State to FALSE
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                    Set Item_Shadow_State Item 0 to TRUE
                    Set Shadow_State Item 0 to TRUE

                    //AB-StoreStart
                    Set Server to (tmpMyf_DD2(Self))
                    
                    //AB-StoreEnd

                End_Object    // tmpMyf_Rs_Plhthos

                Object TextBoxSub5 is a TextBoxSub
                    Set Label to "¢ãŸ¦ª ˜¨˜©«˜« ¡é¤"
                    Set Location to 201 353
                    Set Size to 18 55
                    Set Justification_Mode to jMode_Center
                    Set TypeFace to "MS Sans Serif"
                End_Object    // TextBoxSub5

                Object TextBoxSub6 is a TextBoxSub
                    Set Label to "€¥å˜ ’ £¦¢¦šåà¤"
                    Set Location to 201 435
                    Set Size to 17 47
                    Set Justification_Mode to jMode_Center
                    Set TypeFace to "MS Sans Serif"
                End_Object    // TextBoxSub6

                Object tmpMyf_Rs_axia is a dbFormSub
                    Entry_Item Tmpmyf.S_axia_dhm
                    Set Size to 13 73
                    Set Location to 220 424
                    Set Color to clBtnFace
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to jMode_Right
                    Set Enabled_State to FALSE
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                    Set Item_Shadow_State Item 0 to TRUE
                    Set Shadow_State Item 0 to TRUE

                    //AB-StoreStart
                                                                                                                                                                                                                                                                                                                                                                                                                                
                    Set Numeric_Mask    Item 0 to 14 2 ' ,*'
                    
                    Set Server to (tmpMyf_DD2(Self))
                    
                    //AB-StoreEnd

                End_Object    // tmpMyf_Rs_axia


                //AB-StoreStart
                                                                                                                                                                                                                                                                                                                                
                Set Label to 'œ¢.•¨/¡¦å ƒ£'
                
                
                //AB-StoreEnd

            End_Object    // dbTabView4

            Object dbTabView5 is a dbTabView

                //AB-StoreTopStart
                                                                                                                                                                                                                                                                                                                                
                Object tmpMyf_DD2 is a tmpMyf_DataDictionary
                    Procedure OnConstrain
                        Set Ordering to 1
                        Forward Send OnConstrain
                        Constrain tmpMyf.Myf_Year       Eq (piMyfYear(Self))
                        Constrain tmpMyf.Typos_Record   Eq (-13)
                        Constrain tmpMyf.Module         Eq '01'
                    End_Procedure
                End_Object
                
                //AB-StoreTopEnd

                Set Label to "dbTabView5"

                //AB-DDOStart

                Object Tmpmyf_DD is a tmpMyf_DataDictionary

                    //AB-StoreStart
                                                    
                    Procedure OnConstrain
                        Set Ordering to 1
                        Forward Send OnConstrain
                        Constrain tmpMyf.Myf_Year       Eq (piMyfYear(Self))
                        Constrain tmpMyf.Typos_Record   Eq (-12)
                        Constrain tmpMyf.Module         Eq '01'
                    End_Procedure
                    
                    procedure update
                        forward  send update
                        Move SyscurXr.Company_Code              to tmpMyf.Company_Code
                        Move (psBranch(Self))                   to tmpMyf.Branch_Code
                        move  (piMyfYear(Self)) to  tmpMyf.Myf_Year
                        move -12 to  tmpMyf.Typos_Record
                        move '01' to tmpMyf.Module
                    end_procedure
                    
                    Procedure Request_Save000
                        Integer isOK3
                        Forward Send Request_Save
                        Send ChangeAllFileModes                                DF_Filemode_ReadOnly
                        Set_Attribute DF_File_Mode Of tmpMyf.File_Number    to DF_Filemode_Default
                        Set_Attribute DF_File_Mode Of tmpMyfA.File_Number   to DF_Filemode_Default
                        Get fiMake_Record_3 to isOK3
                        Send ChangeAllFileModes DF_Filemode_Default
                        Send Rebuild_All_Constraints
                        Send Clear to Branch_DD
                    End_Procedure
                    
                    Procedure Request_Delete
                        Integer isOK3 iYes
                        Get YesNo_Box '€¤ › ˜š¨á¯œ«œ «¤ š¨˜££ã, Ÿ˜ §¨â§œ  ¤˜ ¥˜¤˜«¨â¥œ«œ\n«¦¬ª ¬§¦š ©£¦çª ©œ §œ¨å§«à© ¢áŸ¦¬ª\nŒ˜ › ˜š¨˜­œå  œšš¨˜­ã ?' to iYes
                        If (iYes=MBR_NO) Procedure_Return
                        Forward Send Request_Delete
                        Get YesNo_Box 'Œ˜ œ§˜¤˜¬§¦¢¦š ©«¦ç¤ «˜ ©ç¤¦¢˜ ?' to iYes
                        If (iYes=MBR_yes) begin
                            Send ChangeAllFileModes                                DF_Filemode_ReadOnly
                            Set_Attribute DF_File_Mode Of tmpMyf.File_Number    to DF_Filemode_Default
                            Set_Attribute DF_File_Mode Of tmpMyfA.File_Number   to DF_Filemode_Default
                            Get fiMake_Record_3 to isOK3
                            Send ChangeAllFileModes DF_Filemode_Default
                        End
                        Send Rebuild_All_Constraints
                        Send Clear to Branch_DD
                    End_Procedure
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    //AB-StoreEnd

                End_Object    // Tmpmyf_DD

                Set Main_DD to (Tmpmyf_DD(self))
                Set Server to (Tmpmyf_DD(self))

                //AB-DDOEnd

                Object tmpMyf_ is a dbGridSub
                    Set Main_File to Tmpmyf.File_Number
                    Set Ordering to 1
                    Set Size to 190 505
                    Set Location to 2 3
                    Set Wrap_State to TRUE

                    Begin_Row
                        Entry_Item Tmpmyf.Aa
                        Entry_Item Tmpmyf.Afm
                        Entry_Item Tmpmyf.Client_id
                        Entry_Item Tmpmyf.Client_name
                        Entry_Item Tmpmyf.Job
                        Entry_Item Tmpmyf.Ypoxreos
                        Entry_Item Tmpmyf.Polh
                        Entry_Item Tmpmyf.Odos
                        Entry_Item Tmpmyf.Arithmos
                        Entry_Item Tmpmyf.Tk
                        Entry_Item Tmpmyf.Plhthos
                        Entry_Item Tmpmyf.Axia
                    End_Row

                    Set Form_Width    item 0 to 24
                    Set Header_Label  item 0 to "˜/˜"
                    
                    Set Form_Width    item 1 to 45
                    Set Header_Label  item 1 to "€”‹"
                    
                    Set Form_Width    item 2 to 55
                    Set Header_Label  item 2 to "‰à›"
                    
                    Set Form_Width    item 3 to 69
                    Set Header_Label  item 3 to "¨¦£/«ãª"
                    
                    Set Form_Width    item 4 to 51
                    Set Header_Label  item 4 to "„§áššœ¢£˜"
                    
                    Set Form_Width    item 5 to 14
                    Set Header_Label  item 5 to "“"
                    Set Column_Checkbox_State  item 5 to True
                    
                    Set Form_Width    item 6 to 42
                    Set Header_Label  item 6 to "æ¢"
                    
                    Set Form_Width    item 7 to 37
                    Set Header_Label  item 7 to "›æª"
                    
                    Set Form_Width    item 8 to 29
                    Set Header_Label  item 8 to "€¨ Ÿ"
                    
                    Set Form_Width    item 9 to 32
                    Set Header_Label  item 9 to "’‰"
                    
                    Set Form_Width    item 10 to 42
                    Set Header_Label  item 10 to "¢ãŸ¦ª"
                    
                    Set Form_Width    item 11 to 61
                    Set Header_Label  item 11 to "€¥å˜"
                    

                    //AB-StoreStart
                                                                    
                                                                    
                    Set Numeric_Mask    Item 11 to 14 2 ' ,*'
                    
                    //Set Column_Option Item  0 to NoEnter True
                    //Set Column_Option Item  2 to NoEnter True
                    //Set Column_Option Item  3 to NoEnter True
                    //Set Column_Option Item 10 to NoEnter True
                    //Set Column_Option Item 11 to NoEnter True
                    
                    
                    
                    
                    
                    
                    //AB-StoreEnd

                End_Object    // tmpMyf_

                Object TextBoxSub7 is a TextBoxSub
                    Set Label to "¢ãŸ¦ª ˜¨˜©«˜« ¡é¤"
                    Set Location to 201 353
                    Set Size to 18 55
                    Set Justification_Mode to jMode_Center
                    Set TypeFace to "MS Sans Serif"
                End_Object    // TextBoxSub7

                Object TextBoxSub8 is a TextBoxSub
                    Set Label to "€¥å˜ ’ £¦¢¦šåà¤"
                    Set Location to 201 435
                    Set Size to 17 47
                    Set Justification_Mode to jMode_Center
                    Set TypeFace to "MS Sans Serif"
                End_Object    // TextBoxSub8

                Object tmpMyf_Rs_Plhthos is a dbFormSub
                    Entry_Item Tmpmyf.S_plhthos_dhm
                    Set Size to 13 59
                    Set Location to 220 351
                    Set Color to clBtnFace
                    Set TextColor to clRed
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to jMode_Right
                    Set Enabled_State to FALSE
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                    Set Item_Shadow_State Item 0 to TRUE
                    Set Shadow_State Item 0 to TRUE

                    //AB-StoreStart
                    Set Server to (tmpMyf_DD2(Self))
                    
                    //AB-StoreEnd

                End_Object    // tmpMyf_Rs_Plhthos

                Object tmpMyf_Rs_axia is a dbFormSub
                    Entry_Item Tmpmyf.S_axia_dhm
                    Set Size to 13 73
                    Set Location to 220 424
                    Set Color to clBtnFace
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to jMode_Right
                    Set Enabled_State to FALSE
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                    Set Item_Shadow_State Item 0 to TRUE
                    Set Shadow_State Item 0 to TRUE

                    //AB-StoreStart
                                                                                                                                                                                                                                                                                                                                                                                                                                
                    Set Numeric_Mask    Item 0 to 14 2 ' ,*'
                    
                    Set Server to (tmpMyf_DD2(Self))
                    
                    //AB-StoreEnd

                End_Object    // tmpMyf_Rs_axia


                //AB-StoreStart
                                                                                                                                                                                                                                                                                                                                
                Set Label to 'œ¢. ©/¡¦å ƒ£.'
                
                
                //AB-StoreEnd

            End_Object    // dbTabView5

            Object dbTabView6 is a dbTabView

                //AB-StoreTopStart
                                                                                                                                                                                                                                                                                                                                
                Object tmpMyf_DD2 is a tmpMyf_DataDictionary
                    Procedure OnConstrain
                        Set Ordering to 1
                        Forward Send OnConstrain
                        Constrain tmpMyf.Myf_Year       Eq (piMyfYear(Self))
                        Constrain tmpMyf.Typos_Record   Eq 5
                        Constrain tmpMyf.Module         Eq '02'
                    End_Procedure
                End_Object
                
                //AB-StoreTopEnd

                Set Label to "dbTabView6"

                //AB-DDOStart

                Object Tmpmyf_DD is a tmpMyf_DataDictionary

                    //AB-StoreStart
                                                    
                    Procedure OnConstrain
                        Set Ordering to 1
                        Forward Send OnConstrain
                        Constrain tmpMyf.Myf_Year       Eq (piMyfYear(Self))
                        Constrain tmpMyf.Typos_Record   Eq 4
                        Constrain tmpMyf.Module         Eq '02'
                    End_Procedure
                    
                    procedure update
                        forward  send update
                        Move SyscurXr.Company_Code              to tmpMyf.Company_Code
                        Move (psBranch(Self))                   to tmpMyf.Branch_Code
                        move  (piMyfYear(Self)) to  tmpMyf.Myf_Year
                        move 4 to  tmpMyf.Typos_Record
                        move '02' to tmpMyf.Module
                    end_procedure
                    
                    
                    Procedure Save_Main_File
                        Integer isOK
                        Get Validate_AFM2 tmpMyf.AFM  to isOK
                        Move isOK to tmpMyf.Wrong_AFM
                        Forward Send Save_Main_File
                    End_Procedure   // Save_Main_File
                    
                    
                    Procedure Request_Save000
                        Integer isOK5
                        Forward Send Request_Save
                        Send ChangeAllFileModes                                DF_Filemode_ReadOnly
                        Set_Attribute DF_File_Mode Of tmpMyf.File_Number    to DF_Filemode_Default
                        Set_Attribute DF_File_Mode Of tmpMyfA.File_Number   to DF_Filemode_Default
                        Get fiMake_Record_5 to isOK5
                        Send ChangeAllFileModes DF_Filemode_Default
                        Send Rebuild_All_Constraints
                        Send Clear to Branch_DD
                    End_Procedure
                    
                    Procedure Request_Delete
                        Integer isOK5 iYes
                        Get YesNo_Box '€¤ › ˜š¨á¯œ«œ «¤ š¨˜££ã, Ÿ˜ §¨â§œ  ¤˜ ¥˜¤˜«¨â¥œ«œ\n«¦¬ª ¬§¦š ©£¦çª ©œ §œ¨å§«à© ¢áŸ¦¬ª\nŒ˜ › ˜š¨˜­œå  œšš¨˜­ã ?' to iYes
                        If (iYes=MBR_NO) Procedure_Return
                        Forward Send Request_Delete
                        Get YesNo_Box 'Œ˜ œ§˜¤˜¬§¦¢¦š ©«¦ç¤ «˜ ©ç¤¦¢˜ ?' to iYes
                        If (iYes=MBR_yes) begin
                            Send ChangeAllFileModes                                DF_Filemode_ReadOnly
                            Set_Attribute DF_File_Mode Of tmpMyf.File_Number    to DF_Filemode_Default
                            Set_Attribute DF_File_Mode Of tmpMyfA.File_Number   to DF_Filemode_Default
                            Get fiMake_Record_5 to isOK5
                            Send ChangeAllFileModes DF_Filemode_Default
                        End
                        Send Rebuild_All_Constraints
                        Send Clear to Branch_DD
                    End_Procedure
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    //AB-StoreEnd

                End_Object    // Tmpmyf_DD

                Set Main_DD to (Tmpmyf_DD(self))
                Set Server to (Tmpmyf_DD(self))

                //AB-DDOEnd

                Object tmpMyf_ is a dbGridSub
                    Set Main_File to Tmpmyf.File_Number
                    Set Ordering to 1
                    Set Size to 190 505
                    Set Location to 2 3
                    Set Wrap_State to TRUE

                    Begin_Row
                        Entry_Item Tmpmyf.Aa
                        Entry_Item Tmpmyf.Afm
                        Entry_Item Tmpmyf.Client_id
                        Entry_Item Tmpmyf.Client_name
                        Entry_Item Tmpmyf.Job
                        Entry_Item Tmpmyf.Ypoxreos
                        Entry_Item Tmpmyf.Polh
                        Entry_Item Tmpmyf.Odos
                        Entry_Item Tmpmyf.Arithmos
                        Entry_Item Tmpmyf.Tk
                        Entry_Item Tmpmyf.Plhthos
                        Entry_Item Tmpmyf.Axia
                    End_Row

                    Set Form_Width    item 0 to 24
                    Set Header_Label  item 0 to "˜/˜"
                    
                    Set Form_Width    item 1 to 45
                    Set Header_Label  item 1 to "€”‹"
                    
                    Set Form_Width    item 2 to 55
                    Set Header_Label  item 2 to "‰à›"
                    
                    Set Form_Width    item 3 to 69
                    Set Header_Label  item 3 to "œ¢á«ª"
                    
                    Set Form_Width    item 4 to 51
                    Set Header_Label  item 4 to "„§áššœ¢£˜"
                    
                    Set Form_Width    item 5 to 14
                    Set Header_Label  item 5 to "“"
                    Set Column_Checkbox_State  item 5 to True
                    
                    Set Form_Width    item 6 to 42
                    Set Header_Label  item 6 to "æ¢"
                    
                    Set Form_Width    item 7 to 37
                    Set Header_Label  item 7 to "›æª"
                    
                    Set Form_Width    item 8 to 29
                    Set Header_Label  item 8 to "€¨ Ÿ"
                    
                    Set Form_Width    item 9 to 32
                    Set Header_Label  item 9 to "’‰"
                    
                    Set Form_Width    item 10 to 42
                    Set Header_Label  item 10 to "¢ãŸ¦ª"
                    
                    Set Form_Width    item 11 to 60
                    Set Header_Label  item 11 to "€¥å˜"
                    

                    //AB-StoreStart
                                                                    
                    Set Numeric_Mask    Item 11 to 14 2 ' ,*'
                    
                    //Set Column_Option Item  0 to NoEnter True
                    //Set Column_Option Item  2 to NoEnter True
                    //Set Column_Option Item  3 to NoEnter True
                    //Set Column_Option Item 10 to NoEnter True
                    //Set Column_Option Item 11 to NoEnter True
                    
                    
                    //Set Header_Tooltip Item 1 to '¥¡asdsadsd ˜›©˜©›˜©› ˜©›© ˜©››˜©˜©›˜©› ©››­©š¨š› «ªœ¨ ªœ¨ ›­š©›š©›'
                    
                    
                    
                    
                    
                    
                    
                    
                    //AB-StoreEnd

                End_Object    // tmpMyf_

                Object tmpMyf_Rs_Plhthos is a dbFormSub
                    Entry_Item Tmpmyf.S_plhthos_kan
                    Set Size to 13 59
                    Set Location to 220 351
                    Set Color to clBtnFace
                    Set TextColor to clRed
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to jMode_Right
                    Set Enabled_State to FALSE
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                    Set Item_Shadow_State Item 0 to TRUE
                    Set Shadow_State Item 0 to TRUE

                    //AB-StoreStart
                    Set Server to (tmpMyf_DD2(Self))
                    
                    //AB-StoreEnd

                End_Object    // tmpMyf_Rs_Plhthos

                Object TextBoxSub9 is a TextBoxSub
                    Set Label to "¢ãŸ¦ª ˜¨˜©«˜« ¡é¤"
                    Set Location to 201 353
                    Set Size to 18 55
                    Set Justification_Mode to jMode_Center
                    Set TypeFace to "MS Sans Serif"
                End_Object    // TextBoxSub9

                Object TextBoxSub10 is a TextBoxSub
                    Set Label to "€¥å˜ ’ £¦¢¦šåà¤"
                    Set Location to 201 435
                    Set Size to 17 47
                    Set Justification_Mode to jMode_Center
                    Set TypeFace to "MS Sans Serif"
                End_Object    // TextBoxSub10

                Object tmpMyf_Rs_axia is a dbFormSub
                    Entry_Item Tmpmyf.S_axia_kan
                    Set Size to 13 73
                    Set Location to 220 424
                    Set Color to clBtnFace
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to jMode_Right
                    Set Enabled_State to FALSE
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                    Set Item_Shadow_State Item 0 to TRUE
                    Set Shadow_State Item 0 to TRUE

                    //AB-StoreStart
                                                                                                                                                                                                                                                                                                                                                                                                                                
                    Set Numeric_Mask    Item 0 to 14 2 ' ,*'
                    
                    Set Server to (tmpMyf_DD2(Self))
                    
                    //AB-StoreEnd

                End_Object    // tmpMyf_Rs_axia


                //AB-StoreStart
                                                                                                                                                                                                                                                                                                                                
                Set Label to '¨¦£. •¨/¡¦å'
                
                Procedure Save_Main_File
                    Integer isOK
                    Get Validate_AFM2 tmpMyf.AFM  to isOK
                    Move isOK to tmpMyf.Wrong_AFM
                    Forward Send Save_Main_File
                End_Procedure   // Save_Main_File
                
                
                //AB-StoreEnd

            End_Object    // dbTabView6

            Object dbTabView7 is a dbTabView

                //AB-StoreTopStart
                                                                                                                                                                                                                                                                                                                                
                Object tmpMyf_DD2 is a tmpMyf_DataDictionary
                    Procedure OnConstrain
                        Set Ordering to 1
                        Forward Send OnConstrain
                        Constrain tmpMyf.Myf_Year       Eq (piMyfYear(Self))
                        Constrain tmpMyf.Typos_Record   Eq (-5)
                        Constrain tmpMyf.Module         Eq '02'
                    End_Procedure
                End_Object
                
                //AB-StoreTopEnd

                Set Label to "dbTabView7"

                //AB-DDOStart

                Object Tmpmyf_DD is a tmpMyf_DataDictionary

                    //AB-StoreStart
                                                    
                    Procedure OnConstrain
                        Set Ordering to 1
                        Forward Send OnConstrain
                        Constrain tmpMyf.Myf_Year       Eq (piMyfYear(Self))
                        Constrain tmpMyf.Typos_Record   Eq (-4)
                        Constrain tmpMyf.Module         Eq '02'
                    End_Procedure
                    
                    procedure update
                        forward  send update
                        Move SyscurXr.Company_Code              to tmpMyf.Company_Code
                        Move (psBranch(Self))                   to tmpMyf.Branch_Code
                        move  (piMyfYear(Self)) to  tmpMyf.Myf_Year
                        move -4 to  tmpMyf.Typos_Record
                        move '02' to tmpMyf.Module
                    end_procedure
                    
                    
                    Procedure Save_Main_File
                        Integer isOK
                        Get Validate_AFM2 tmpMyf.AFM  to isOK
                        Move isOK to tmpMyf.Wrong_AFM
                        Forward Send Save_Main_File
                    End_Procedure   // Save_Main_File
                    
                    Procedure Request_Save000
                        Integer isOK5
                        Forward Send Request_Save
                        Send ChangeAllFileModes                                DF_Filemode_ReadOnly
                        Set_Attribute DF_File_Mode Of tmpMyf.File_Number    to DF_Filemode_Default
                        Set_Attribute DF_File_Mode Of tmpMyfA.File_Number   to DF_Filemode_Default
                        Get fiMake_Record_5 to isOK5
                        Send ChangeAllFileModes DF_Filemode_Default
                        Send Rebuild_All_Constraints
                        Send Clear to Branch_DD
                    End_Procedure
                    
                    Procedure Request_Delete
                        Integer isOK5 iYes
                        Get YesNo_Box '€¤ › ˜š¨á¯œ«œ «¤ š¨˜££ã, Ÿ˜ §¨â§œ  ¤˜ ¥˜¤˜«¨â¥œ«œ\n«¦¬ª ¬§¦š ©£¦çª ©œ §œ¨å§«à© ¢áŸ¦¬ª\nŒ˜ › ˜š¨˜­œå  œšš¨˜­ã ?' to iYes
                        If (iYes=MBR_NO) Procedure_Return
                        Forward Send Request_Delete
                        Get YesNo_Box 'Œ˜ œ§˜¤˜¬§¦¢¦š ©«¦ç¤ «˜ ©ç¤¦¢˜ ?' to iYes
                        If (iYes=MBR_yes) begin
                            Send ChangeAllFileModes                                DF_Filemode_ReadOnly
                            Set_Attribute DF_File_Mode Of tmpMyf.File_Number    to DF_Filemode_Default
                            Set_Attribute DF_File_Mode Of tmpMyfA.File_Number   to DF_Filemode_Default
                            Get fiMake_Record_5 to isOK5
                            Send ChangeAllFileModes DF_Filemode_Default
                        End
                        Send Rebuild_All_Constraints
                        Send Clear to Branch_DD
                    End_Procedure
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    //AB-StoreEnd

                End_Object    // Tmpmyf_DD

                Set Main_DD to (Tmpmyf_DD(self))
                Set Server to (Tmpmyf_DD(self))

                //AB-DDOEnd

                Object tmpMyf_ is a dbGridSub
                    Set Main_File to Tmpmyf.File_Number
                    Set Ordering to 1
                    Set Size to 190 505
                    Set Location to 2 3
                    Set Wrap_State to TRUE

                    Begin_Row
                        Entry_Item Tmpmyf.Aa
                        Entry_Item Tmpmyf.Afm
                        Entry_Item Tmpmyf.Client_id
                        Entry_Item Tmpmyf.Client_name
                        Entry_Item Tmpmyf.Job
                        Entry_Item Tmpmyf.Ypoxreos
                        Entry_Item Tmpmyf.Polh
                        Entry_Item Tmpmyf.Odos
                        Entry_Item Tmpmyf.Arithmos
                        Entry_Item Tmpmyf.Tk
                        Entry_Item Tmpmyf.Plhthos
                        Entry_Item Tmpmyf.Axia
                    End_Row

                    Set Form_Width    item 0 to 24
                    Set Header_Label  item 0 to "˜/˜"
                    
                    Set Form_Width    item 1 to 45
                    Set Header_Label  item 1 to "€”‹"
                    
                    Set Form_Width    item 2 to 55
                    Set Header_Label  item 2 to "‰à›"
                    
                    Set Form_Width    item 3 to 69
                    Set Header_Label  item 3 to "¨¦£/«ãª"
                    
                    Set Form_Width    item 4 to 51
                    Set Header_Label  item 4 to "„§áššœ¢£˜"
                    
                    Set Form_Width    item 5 to 14
                    Set Header_Label  item 5 to "“"
                    Set Column_Checkbox_State  item 5 to True
                    
                    Set Form_Width    item 6 to 42
                    Set Header_Label  item 6 to "æ¢"
                    
                    Set Form_Width    item 7 to 37
                    Set Header_Label  item 7 to "›æª"
                    
                    Set Form_Width    item 8 to 29
                    Set Header_Label  item 8 to "€¨ Ÿ"
                    
                    Set Form_Width    item 9 to 32
                    Set Header_Label  item 9 to "’‰"
                    
                    Set Form_Width    item 10 to 42
                    Set Header_Label  item 10 to "¢ãŸ¦ª"
                    
                    Set Form_Width    item 11 to 61
                    Set Header_Label  item 11 to "€¥å˜"
                    

                    //AB-StoreStart
                                                                    
                                                                    
                    Set Numeric_Mask    Item 11 to 14 2 ' ,*'
                    
                    //Set Column_Option Item  0 to NoEnter True
                    //Set Column_Option Item  2 to NoEnter True
                    //Set Column_Option Item  3 to NoEnter True
                    //Set Column_Option Item 10 to NoEnter True
                    //Set Column_Option Item 11 to NoEnter True
                    
                    
                    
                    
                    
                    
                    //AB-StoreEnd

                End_Object    // tmpMyf_

                Object TextBoxSub11 is a TextBoxSub
                    Set Label to "¢ãŸ¦ª ˜¨˜©«˜« ¡é¤"
                    Set Location to 201 353
                    Set Size to 18 55
                    Set Justification_Mode to jMode_Center
                    Set TypeFace to "MS Sans Serif"
                End_Object    // TextBoxSub11

                Object TextBoxSub12 is a TextBoxSub
                    Set Label to "€¥å˜ ’ £¦¢¦šåà¤"
                    Set Location to 201 435
                    Set Size to 17 47
                    Set Justification_Mode to jMode_Center
                    Set TypeFace to "MS Sans Serif"
                End_Object    // TextBoxSub12

                Object tmpMyf_Rs_Plhthos is a dbFormSub
                    Entry_Item Tmpmyf.S_plhthos_kan
                    Set Size to 13 59
                    Set Location to 220 351
                    Set Color to clBtnFace
                    Set TextColor to clRed
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to jMode_Right
                    Set Enabled_State to FALSE
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                    Set Item_Shadow_State Item 0 to TRUE
                    Set Shadow_State Item 0 to TRUE

                    //AB-StoreStart
                    Set Server to (tmpMyf_DD2(Self))
                    
                    //AB-StoreEnd

                End_Object    // tmpMyf_Rs_Plhthos

                Object tmpMyf_Rs_axia is a dbFormSub
                    Entry_Item Tmpmyf.S_axia_kan
                    Set Size to 13 73
                    Set Location to 220 425
                    Set Color to clBtnFace
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to jMode_Right
                    Set Enabled_State to FALSE
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                    Set Item_Shadow_State Item 0 to TRUE
                    Set Shadow_State Item 0 to TRUE

                    //AB-StoreStart
                                                                                                                                                                                                                                                                                                                                                                                                                                
                    Set Numeric_Mask    Item 0 to 14 2 ' ,*'
                    
                    Set Server to (tmpMyf_DD2(Self))
                    
                    //AB-StoreEnd

                End_Object    // tmpMyf_Rs_axia


                //AB-StoreStart
                                                                                                                                                                                                                                                                                                                                
                Set Label to '¨¦£. ©/¡¦å'
                
                
                
                
                
                //AB-StoreEnd

            End_Object    // dbTabView7

            Object dbTabView8 is a dbTabView

                //AB-StoreTopStart
                                                                                                                                                                                                                                                                                                                                
                Object tmpMyf_DD2 is a tmpMyf_DataDictionary
                    Procedure OnConstrain
                        Set Ordering to 1
                        Forward Send OnConstrain
                        Constrain tmpMyf.Myf_Year       Eq (piMyfYear(Self))
                        Constrain tmpMyf.Typos_Record   Eq 15
                        Constrain tmpMyf.Module         Eq '02'
                    End_Procedure
                End_Object
                
                //AB-StoreTopEnd

                Set Label to "dbTabView8"

                //AB-DDOStart

                Object Tmpmyf_DD is a tmpMyf_DataDictionary

                    //AB-StoreStart
                                                    
                    Procedure OnConstrain
                        Set Ordering to 1
                        Forward Send OnConstrain
                        Constrain tmpMyf.Myf_Year       Eq (piMyfYear(Self))
                        Constrain tmpMyf.Typos_Record   Eq 14
                        Constrain tmpMyf.Module         Eq '02'
                    End_Procedure
                    
                    procedure update
                        forward  send update
                        Move SyscurXr.Company_Code              to tmpMyf.Company_Code
                        Move (psBranch(Self))                   to tmpMyf.Branch_Code
                        move  (piMyfYear(Self)) to  tmpMyf.Myf_Year
                        move 14 to  tmpMyf.Typos_Record
                        move '02' to tmpMyf.Module
                    end_procedure
                    
                    Procedure Request_Save000
                        Integer isOK5
                        Forward Send Request_Save
                        Send ChangeAllFileModes                                DF_Filemode_ReadOnly
                        Set_Attribute DF_File_Mode Of tmpMyf.File_Number    to DF_Filemode_Default
                        Set_Attribute DF_File_Mode Of tmpMyfA.File_Number   to DF_Filemode_Default
                        Get fiMake_Record_5 to isOK5
                        Send ChangeAllFileModes DF_Filemode_Default
                        Send Rebuild_All_Constraints
                        Send Clear to Branch_DD
                    End_Procedure
                    
                    Procedure Request_Delete
                        Integer isOK5 iYes
                        Get YesNo_Box '€¤ › ˜š¨á¯œ«œ «¤ š¨˜££ã, Ÿ˜ §¨â§œ  ¤˜ ¥˜¤˜«¨â¥œ«œ\n«¦¬ª ¬§¦š ©£¦çª ©œ §œ¨å§«à© ¢áŸ¦¬ª\nŒ˜ › ˜š¨˜­œå  œšš¨˜­ã ?' to iYes
                        If (iYes=MBR_NO) Procedure_Return
                        Forward Send Request_Delete
                        Get YesNo_Box 'Œ˜ œ§˜¤˜¬§¦¢¦š ©«¦ç¤ «˜ ©ç¤¦¢˜ ?' to iYes
                        If (iYes=MBR_yes) begin
                            Send ChangeAllFileModes                                DF_Filemode_ReadOnly
                            Set_Attribute DF_File_Mode Of tmpMyf.File_Number    to DF_Filemode_Default
                            Set_Attribute DF_File_Mode Of tmpMyfA.File_Number   to DF_Filemode_Default
                            Get fiMake_Record_5 to isOK5
                            Send ChangeAllFileModes DF_Filemode_Default
                        End
                        Send Rebuild_All_Constraints
                        Send Clear to Branch_DD
                    End_Procedure
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    //AB-StoreEnd

                End_Object    // Tmpmyf_DD

                Set Main_DD to (Tmpmyf_DD(self))
                Set Server to (Tmpmyf_DD(self))

                //AB-DDOEnd

                Object tmpMyf_ is a dbGridSub
                    Set Main_File to Tmpmyf.File_Number
                    Set Ordering to 1
                    Set Size to 190 505
                    Set Location to 2 3
                    Set Wrap_State to TRUE

                    Begin_Row
                        Entry_Item Tmpmyf.Aa
                        Entry_Item Tmpmyf.Afm
                        Entry_Item Tmpmyf.Client_id
                        Entry_Item Tmpmyf.Client_name
                        Entry_Item Tmpmyf.Job
                        Entry_Item Tmpmyf.Ypoxreos
                        Entry_Item Tmpmyf.Polh
                        Entry_Item Tmpmyf.Odos
                        Entry_Item Tmpmyf.Arithmos
                        Entry_Item Tmpmyf.Tk
                        Entry_Item Tmpmyf.Plhthos
                        Entry_Item Tmpmyf.Axia
                    End_Row

                    Set Form_Width    item 0 to 24
                    Set Header_Label  item 0 to "˜/˜"
                    
                    Set Form_Width    item 1 to 45
                    Set Header_Label  item 1 to "€”‹"
                    
                    Set Form_Width    item 2 to 55
                    Set Header_Label  item 2 to "‰à›"
                    
                    Set Form_Width    item 3 to 69
                    Set Header_Label  item 3 to "œ¢á«ª"
                    
                    Set Form_Width    item 4 to 51
                    Set Header_Label  item 4 to "„§áššœ¢£˜"
                    
                    Set Form_Width    item 5 to 14
                    Set Header_Label  item 5 to "“"
                    Set Column_Checkbox_State  item 5 to True
                    
                    Set Form_Width    item 6 to 42
                    Set Header_Label  item 6 to "æ¢"
                    
                    Set Form_Width    item 7 to 37
                    Set Header_Label  item 7 to "›æª"
                    
                    Set Form_Width    item 8 to 29
                    Set Header_Label  item 8 to "€¨ Ÿ"
                    
                    Set Form_Width    item 9 to 32
                    Set Header_Label  item 9 to "’‰"
                    
                    Set Form_Width    item 10 to 42
                    Set Header_Label  item 10 to "¢ãŸ¦ª"
                    
                    Set Form_Width    item 11 to 60
                    Set Header_Label  item 11 to "€¥å˜"
                    

                    //AB-StoreStart
                                                                    
                    Set Numeric_Mask    Item 11 to 14 2 ' ,*'
                    
                    //Set Column_Option Item  0 to NoEnter True
                    //Set Column_Option Item  2 to NoEnter True
                    //Set Column_Option Item  3 to NoEnter True
                    //Set Column_Option Item 10 to NoEnter True
                    //Set Column_Option Item 11 to NoEnter True
                    
                    
                    //Set Header_Tooltip Item 1 to '¥¡asdsadsd ˜›©˜©›˜©› ˜©›© ˜©››˜©˜©›˜©› ©››­©š¨š› «ªœ¨ ªœ¨ ›­š©›š©›'
                    
                    
                    
                    
                    
                    
                    
                    
                    //AB-StoreEnd

                End_Object    // tmpMyf_

                Object tmpMyf_Rs_Plhthos is a dbFormSub
                    Entry_Item Tmpmyf.S_plhthos_dhm
                    Set Size to 13 59
                    Set Location to 220 351
                    Set Color to clBtnFace
                    Set TextColor to clRed
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to jMode_Right
                    Set Enabled_State to FALSE
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                    Set Item_Shadow_State Item 0 to TRUE
                    Set Shadow_State Item 0 to TRUE

                    //AB-StoreStart
                    Set Server to (tmpMyf_DD2(Self))
                    
                    //AB-StoreEnd

                End_Object    // tmpMyf_Rs_Plhthos

                Object TextBoxSub13 is a TextBoxSub
                    Set Label to "¢ãŸ¦ª ˜¨˜©«˜« ¡é¤"
                    Set Location to 201 353
                    Set Size to 18 55
                    Set Justification_Mode to jMode_Center
                    Set TypeFace to "MS Sans Serif"
                End_Object    // TextBoxSub13

                Object TextBoxSub14 is a TextBoxSub
                    Set Label to "€¥å˜ ’ £¦¢¦šåà¤"
                    Set Location to 201 435
                    Set Size to 17 47
                    Set Justification_Mode to jMode_Center
                    Set TypeFace to "MS Sans Serif"
                End_Object    // TextBoxSub14

                Object tmpMyf_Rs_axia is a dbFormSub
                    Entry_Item Tmpmyf.S_axia_dhm
                    Set Size to 13 73
                    Set Location to 220 424
                    Set Color to clBtnFace
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to jMode_Right
                    Set Enabled_State to FALSE
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                    Set Item_Shadow_State Item 0 to TRUE
                    Set Shadow_State Item 0 to TRUE

                    //AB-StoreStart
                                                                                                                                                                                                                                                                                                                                                                                                                                
                    Set Numeric_Mask    Item 0 to 14 2 ' ,*'
                    
                    Set Server to (tmpMyf_DD2(Self))
                    
                    //AB-StoreEnd

                End_Object    // tmpMyf_Rs_axia


                //AB-StoreStart
                                                                                                                                                                                                                                                                                                                                
                Set Label to '¨¦£.•¨/¡¦å ƒ£'
                
                
                
                
                
                
                
                //AB-StoreEnd

            End_Object    // dbTabView8

            Object dbTabView9 is a dbTabView

                //AB-StoreTopStart
                                                                                                                                                                                                                                                                                                                                
                Object tmpMyf_DD2 is a tmpMyf_DataDictionary
                    Procedure OnConstrain
                        Set Ordering to 1
                        Forward Send OnConstrain
                        Constrain tmpMyf.Myf_Year       Eq (piMyfYear(Self))
                        Constrain tmpMyf.Typos_Record   Eq (-15)
                        Constrain tmpMyf.Module         Eq '02'
                    End_Procedure
                End_Object
                
                //AB-StoreTopEnd

                Set Label to "dbTabView9"

                //AB-DDOStart

                Object Tmpmyf_DD is a tmpMyf_DataDictionary

                    //AB-StoreStart
                                                    
                    Procedure OnConstrain
                        Set Ordering to 1
                        Forward Send OnConstrain
                        Constrain tmpMyf.Myf_Year       Eq (piMyfYear(Self))
                        Constrain tmpMyf.Typos_Record   Eq (-14)
                        Constrain tmpMyf.Module         Eq '02'
                    End_Procedure
                    
                    procedure update
                        forward  send update
                        Move SyscurXr.Company_Code              to tmpMyf.Company_Code
                        Move (psBranch(Self))                   to tmpMyf.Branch_Code
                        move  (piMyfYear(Self)) to  tmpMyf.Myf_Year
                        move -14 to  tmpMyf.Typos_Record
                        move '02' to tmpMyf.Module
                    end_procedure
                    
                    Procedure Request_Save000
                        Integer isOK5
                        Forward Send Request_Save
                        Send ChangeAllFileModes                                DF_Filemode_ReadOnly
                        Set_Attribute DF_File_Mode Of tmpMyf.File_Number    to DF_Filemode_Default
                        Set_Attribute DF_File_Mode Of tmpMyfA.File_Number   to DF_Filemode_Default
                        Get fiMake_Record_5 to isOK5
                        Send ChangeAllFileModes DF_Filemode_Default
                        Send Rebuild_All_Constraints
                        Send Clear to Branch_DD
                    End_Procedure
                    
                    Procedure Request_Delete
                        Integer isOK5 iYes
                        Get YesNo_Box '€¤ › ˜š¨á¯œ«œ «¤ š¨˜££ã, Ÿ˜ §¨â§œ  ¤˜ ¥˜¤˜«¨â¥œ«œ\n«¦¬ª ¬§¦š ©£¦çª ©œ §œ¨å§«à© ¢áŸ¦¬ª\nŒ˜ › ˜š¨˜­œå  œšš¨˜­ã ?' to iYes
                        If (iYes=MBR_NO) Procedure_Return
                        Forward Send Request_Delete
                        Get YesNo_Box 'Œ˜ œ§˜¤˜¬§¦¢¦š ©«¦ç¤ «˜ ©ç¤¦¢˜ ?' to iYes
                        If (iYes=MBR_yes) begin
                            Send ChangeAllFileModes                                DF_Filemode_ReadOnly
                            Set_Attribute DF_File_Mode Of tmpMyf.File_Number    to DF_Filemode_Default
                            Set_Attribute DF_File_Mode Of tmpMyfA.File_Number   to DF_Filemode_Default
                            Get fiMake_Record_5 to isOK5
                            Send ChangeAllFileModes DF_Filemode_Default
                        End
                        Send Rebuild_All_Constraints
                        Send Clear to Branch_DD
                    End_Procedure
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    //AB-StoreEnd

                End_Object    // Tmpmyf_DD

                Set Main_DD to (Tmpmyf_DD(self))
                Set Server to (Tmpmyf_DD(self))

                //AB-DDOEnd

                Object tmpMyf_ is a dbGridSub
                    Set Main_File to Tmpmyf.File_Number
                    Set Ordering to 1
                    Set Size to 190 505
                    Set Location to 2 3
                    Set Wrap_State to TRUE

                    Begin_Row
                        Entry_Item Tmpmyf.Aa
                        Entry_Item Tmpmyf.Afm
                        Entry_Item Tmpmyf.Client_id
                        Entry_Item Tmpmyf.Client_name
                        Entry_Item Tmpmyf.Job
                        Entry_Item Tmpmyf.Ypoxreos
                        Entry_Item Tmpmyf.Polh
                        Entry_Item Tmpmyf.Odos
                        Entry_Item Tmpmyf.Arithmos
                        Entry_Item Tmpmyf.Tk
                        Entry_Item Tmpmyf.Plhthos
                        Entry_Item Tmpmyf.Axia
                    End_Row

                    Set Form_Width    item 0 to 24
                    Set Header_Label  item 0 to "˜/˜"
                    
                    Set Form_Width    item 1 to 45
                    Set Header_Label  item 1 to "€”‹"
                    
                    Set Form_Width    item 2 to 55
                    Set Header_Label  item 2 to "‰à›"
                    
                    Set Form_Width    item 3 to 69
                    Set Header_Label  item 3 to "¨¦£/«ãª"
                    
                    Set Form_Width    item 4 to 51
                    Set Header_Label  item 4 to "„§áššœ¢£˜"
                    
                    Set Form_Width    item 5 to 14
                    Set Header_Label  item 5 to "“"
                    Set Column_Checkbox_State  item 5 to True
                    
                    Set Form_Width    item 6 to 42
                    Set Header_Label  item 6 to "æ¢"
                    
                    Set Form_Width    item 7 to 37
                    Set Header_Label  item 7 to "›æª"
                    
                    Set Form_Width    item 8 to 29
                    Set Header_Label  item 8 to "€¨ Ÿ"
                    
                    Set Form_Width    item 9 to 32
                    Set Header_Label  item 9 to "’‰"
                    
                    Set Form_Width    item 10 to 42
                    Set Header_Label  item 10 to "¢ãŸ¦ª"
                    
                    Set Form_Width    item 11 to 61
                    Set Header_Label  item 11 to "€¥å˜"
                    

                    //AB-StoreStart
                                                                    
                                                                    
                    Set Numeric_Mask    Item 11 to 14 2 ' ,*'
                    
                    //Set Column_Option Item  0 to NoEnter True
                    //Set Column_Option Item  2 to NoEnter True
                    //Set Column_Option Item  3 to NoEnter True
                    //Set Column_Option Item 10 to NoEnter True
                    //Set Column_Option Item 11 to NoEnter True
                    
                    
                    
                    
                    
                    
                    //AB-StoreEnd

                End_Object    // tmpMyf_

                Object TextBoxSub15 is a TextBoxSub
                    Set Label to "¢ãŸ¦ª ˜¨˜©«˜« ¡é¤"
                    Set Location to 201 353
                    Set Size to 18 55
                    Set Justification_Mode to jMode_Center
                    Set TypeFace to "MS Sans Serif"
                End_Object    // TextBoxSub15

                Object TextBoxSub16 is a TextBoxSub
                    Set Label to "€¥å˜ ’ £¦¢¦šåà¤"
                    Set Location to 201 435
                    Set Size to 17 47
                    Set Justification_Mode to jMode_Center
                    Set TypeFace to "MS Sans Serif"
                End_Object    // TextBoxSub16

                Object tmpMyf_Rs_Plhthos is a dbFormSub
                    Entry_Item Tmpmyf.S_plhthos_dhm
                    Set Size to 13 59
                    Set Location to 220 351
                    Set Color to clBtnFace
                    Set TextColor to clRed
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to jMode_Right
                    Set Enabled_State to FALSE
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                    Set Item_Shadow_State Item 0 to TRUE
                    Set Shadow_State Item 0 to TRUE

                    //AB-StoreStart
                    Set Server to (tmpMyf_DD2(Self))
                    
                    //AB-StoreEnd

                End_Object    // tmpMyf_Rs_Plhthos

                Object tmpMyf_Rs_axia is a dbFormSub
                    Entry_Item Tmpmyf.S_axia_dhm
                    Set Size to 13 73
                    Set Location to 220 424
                    Set Color to clBtnFace
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to jMode_Right
                    Set Enabled_State to FALSE
                    Set Form_TypeFace Item 0 to "MS Sans Serif"
                    Set Item_Shadow_State Item 0 to TRUE
                    Set Shadow_State Item 0 to TRUE

                    //AB-StoreStart
                                                                                                                                                                                                                                                                                                                                                                                                                                
                    Set Numeric_Mask    Item 0 to 14 2 ' ,*'
                    
                    Set Server to (tmpMyf_DD2(Self))
                    
                    //AB-StoreEnd

                End_Object    // tmpMyf_Rs_axia


                //AB-StoreStart
                                                                                                                                                                                                                                                                                                                                
                Set Label to '¨¦£. ©/¡¦å ƒ£.'
                
                
                
                
                
                
                //AB-StoreEnd

            End_Object    // dbTabView9

        End_Object    // dbTabDialogSView1

        Object btnPrint is a ButtonSub

            //AB-StoreTopStart
                                                                                                                                                                                                                                
            //AB-StoreTopEnd

            Set Bitmap to "printer1.bmp"
            Set Size to 22 25
            Set Location to 0 248
            Set Focus_Mode to Pointer_Only
            Set Form_TypeFace Item 0 to "MS Sans Serif"

            //AB-StoreStart
                                                                                                                                                                                                                                
            Set TooltipValue to '„¡«ç§à© „¢âš®¦¬ ‹.“.”.'
            
            Procedure OnClick
                Send RunRpt1Report to (Rpt1_Report(Self))
            End_Procedure // OnClick
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            //AB-StoreEnd

        End_Object    // btnPrint

        Object btnPrint2 is a ButtonSub

            //AB-StoreTopStart
                                                                                                                                                                                                                                
            //AB-StoreTopEnd

            Set Bitmap to "PRINTER.BMP"
            Set Size to 22 25
            Set Location to 0 222
            Set Focus_Mode to Pointer_Only
            Set Form_TypeFace Item 0 to "MS Sans Serif"

            //AB-StoreStart
                                                                                                                                                                                                                                
            Set TooltipValue to '„¡«ç§à© „¢âš®¦¬ €”‹ ”¦¨âà¤'
            
            Procedure OnClick
                Send RunRpt1Report2 to (Rpt2_Report(Self))
            End_Procedure // OnClick
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            //AB-StoreEnd

        End_Object    // btnPrint2

        Object btnMakeAscii is a ButtonSub

            //AB-StoreTopStart
                                            
            //AB-StoreTopEnd

            Set Bitmap to "Aggel0.bmp"
            Set Size to 22 25
            Set Location to 0 302
            Set Focus_Mode to Pointer_Only
            Set Form_TypeFace Item 0 to "MS Sans Serif"

            //AB-StoreStart
                                            
            Set TooltipValue to '„¥˜šàšã ‹.“.”. ©œ ˜¨®œå˜ š ˜ ¤˜ œ ©˜®Ÿ¦ç¤ ©œ á¢¢¦ ¬§¦¡˜«á©«£˜'
            
            Procedure Make_Ascii_Files
                Integer iCount iErrorObjID
                Date    dHmnia
                String  sHmnia sKeno sMess
                Number  nAxiaDhmosiou
                Sysdate dHmnia
                Move dHmnia to sHmnia
            
                // Ftiaxnoume prota to ascii arxeio MYFYPOK.PIS
                // pou periexei mono tis analytikes eggrafes gia pistotikous pelates,
                // promhtheytes, kanonikous kai dhmosiou, me kodiko sto 1o psifio os exhs :
                // Kodikos 1 = (Typos record sto tmpmyf=  -2  Pistotikoi Pelates Kanonikoi
                // Kodikos 2 = (Typos record sto tmpmyf=  -4  Pistotikoi Promhtheytes Kanonikoi
                // Kodikos 3 = (Typos record sto tmpmyf= -12  Pistotikoi Pelates Dhmosiou
                // Kodikos 4 = (Typos record sto tmpmyf= -14  Pistotikoi Promhtheytes Dhmosiou
                // O kodikos einai to proto pedio pou kanoume Write channel...., gia na xeroume
                // ti eggrafes diavazoume sto 2o paso pou tha diavasoume ayto to arxeio
                // kai na grapsoume sto tmpmyf gia na eisaxthoun.
            
                Direct_Output Channel 9 'C:\MYFYPOK.PIS'
            
                // Ftiaxnoume ta record typou -2 PISTOTIKOI PELATES KANONIKOI
                Move 0 to iCount
                Clear tmpMyf
                Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                Move -2                 to tmpMyf.Typos_Record
                Move '01'               to tmpMyf.Module
                Find GT tmpMyf By Index.1
                While ((Found) And (tmpMyf.Myf_Year=piMyfYear(Self)) And (tmpMyf.Typos_Record=(-2)) And (tmpMyf.Module='01'))
                    Add 1 to iCount
                    Write   Channel 9 1
                    Write   Channel 9 (Sfi_All_Numbers(iCount            , 5,0))
                    Write   Channel 9 (Trim           (tmpMyf.Afm             ))
                    Write   Channel 9 (Pad            (tmpMyf.Client_Name,27  ))
                    Write   Channel 9 (Pad            (tmpMyf.Job        ,15  ))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Ypoxreos   , 1,0))
                    Write   Channel 9 (Pad            (tmpMyf.Polh       ,10  ))
                    Write   Channel 9 (Pad            (tmpMyf.Odos       ,16  ))
                    Write   Channel 9 (Pad            (tmpMyf.Arithmos   , 3  ))
                    Write   Channel 9 (Pad            (tmpMyf.TK         , 5  ))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Plhthos    , 7,0))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Axia       ,14,2))
                    Write   Channel 9 (Pad            (tmpMyf.Client_ID  ,20  ))
                    Writeln Channel 9
                    Find GT tmpMyf By Index.1
                Loop
                // Ftiaxnoume ta record typou -4 PISTOTIKOI PROMHTHEYTES KANONIKOI
                Move 0 to iCount
                Clear tmpMyf
                Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                Move -4                 to tmpMyf.Typos_Record
                Move '02'               to tmpMyf.Module
                Find GT tmpMyf By Index.1
                While ((Found) And (tmpMyf.Myf_Year=piMyfYear(Self)) And (tmpMyf.Typos_Record=(-4)) And (tmpMyf.Module='02'))
                    Add 1 to iCount
                    Write   Channel 9 2
                    Write   Channel 9 (Sfi_All_Numbers(iCount            , 5,0))
                    Write   Channel 9 (Trim           (tmpMyf.Afm             ))
                    Write   Channel 9 (Pad            (tmpMyf.Client_Name,27  ))
                    Write   Channel 9 (Pad            (tmpMyf.Job        ,15  ))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Ypoxreos   , 1,0))
                    Write   Channel 9 (Pad            (tmpMyf.Polh       ,10  ))
                    Write   Channel 9 (Pad            (tmpMyf.Odos       ,16  ))
                    Write   Channel 9 (Pad            (tmpMyf.Arithmos   , 3  ))
                    Write   Channel 9 (Pad            (tmpMyf.TK         , 5  ))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Plhthos    , 7,0))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Axia       ,14,2))
                    Write   Channel 9 (Pad            (tmpMyf.Client_ID  ,20  ))
                    Writeln Channel 9
                    Find GT tmpMyf By Index.1
                Loop
                // Ftiaxnoume ta record typou -12 PISTOTIKOI PELATES DHMOSIOY
                Move 0 to iCount
                Clear tmpMyf
                Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                Move -12                to tmpMyf.Typos_Record
                Move '01'               to tmpMyf.Module
                Find GT tmpMyf By Index.1
                While ((Found) And (tmpMyf.Myf_Year=piMyfYear(Self)) And (tmpMyf.Typos_Record=(-12)) And (tmpMyf.Module='01'))
                    Add 1 to iCount
                    Write   Channel 9 3
                    Write   Channel 9 (Sfi_All_Numbers(iCount            , 5,0))
                    Write   Channel 9 (Trim           (tmpMyf.Afm             ))
                    Write   Channel 9 (Pad            (tmpMyf.Client_Name,27  ))
                    Write   Channel 9 (Pad            (tmpMyf.Job        ,15  ))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Ypoxreos   , 1,0))
                    Write   Channel 9 (Pad            (tmpMyf.Polh       ,10  ))
                    Write   Channel 9 (Pad            (tmpMyf.Odos       ,16  ))
                    Write   Channel 9 (Pad            (tmpMyf.Arithmos   , 3  ))
                    Write   Channel 9 (Pad            (tmpMyf.TK         , 5  ))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Plhthos    , 7,0))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Axia      ,14,2))
                    Write   Channel 9 (Pad            (tmpMyf.Client_ID  ,20  ))
                    Writeln Channel 9
                    Find GT tmpMyf By Index.1
                Loop
                // Ftiaxnoume ta record typou -14 PISTOTIKOI PROMHTHEYTES DHMOSIOY
                Move 0 to iCount
                Clear tmpMyf
                Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                Move -14                to tmpMyf.Typos_Record
                Move '02'               to tmpMyf.Module
                Find GT tmpMyf By Index.1
                While ((Found) And (tmpMyf.Myf_Year=piMyfYear(Self)) And (tmpMyf.Typos_Record=(-14)) And (tmpMyf.Module='02'))
                    Add 1 to iCount
                    Write   Channel 9 4
                    Write   Channel 9 (Sfi_All_Numbers(iCount            , 5,0))
                    Write   Channel 9 (Trim           (tmpMyf.Afm             ))
                    Write   Channel 9 (Pad            (tmpMyf.Client_Name,27  ))
                    Write   Channel 9 (Pad            (tmpMyf.Job        ,15  ))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Ypoxreos   , 1,0))
                    Write   Channel 9 (Pad            (tmpMyf.Polh       ,10  ))
                    Write   Channel 9 (Pad            (tmpMyf.Odos       ,16  ))
                    Write   Channel 9 (Pad            (tmpMyf.Arithmos   , 3  ))
                    Write   Channel 9 (Pad            (tmpMyf.TK         , 5  ))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Plhthos    , 7,0))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Axia       ,14,2))
                    Write   Channel 9 (Pad            (tmpMyf.Client_ID  ,20  ))
                    Writeln Channel 9
                    Find GT tmpMyf By Index.1
                Loop
                Close_Output Channel 9
            ///////////////////////////////////////////////////////////////////////////////////////////////
            ///////////////////////////////////////////////////////////////////////////////////////////////
            
                // Ftiaxnoume meta to ascii arxeio MYFYPOK
                // pou periexei mono tis analytikes eggrafes gia xreostikous pelates,
                // promhtheytes, kanonikous kai dhmosiou, me kodiko sto 1o psifio os exhs :
            
                // Kodikos 1 = (Typos record sto tmpmyf= 2  Xreostikoi Pelates Kanonikoi
                // Kodikos 2 = (Typos record sto tmpmyf= 4  Xreostikoi Promhtheytes Kanonikoi
                // Kodikos 3 = (Typos record sto tmpmyf=12  Xreostikoi Pelates Dhmosiou
                // Kodikos 4 = (Typos record sto tmpmyf=14  Xreostikoi Promhtheytes Dhmosiou
            
                Direct_Output Channel 9 'C:\MYFYPOK'
            
                // Ftiaxnoume ta record typou 2 XREOSTIKOI PELATES KANONIKOI
                Move 0 to iCount
                Clear tmpMyf
                Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                Move 2                  to tmpMyf.Typos_Record
                Move '01'               to tmpMyf.Module
                Find GT tmpMyf By Index.1
                While ((Found) And (tmpMyf.Myf_Year=piMyfYear(Self)) And (tmpMyf.Typos_Record=2) And (tmpMyf.Module='01'))
                    Add 1 to iCount
                    Write   Channel 9 1
                    Write   Channel 9 (Sfi_All_Numbers(iCount            , 5,0))
                    Write   Channel 9 (Trim           (tmpMyf.Afm             ))
                    Write   Channel 9 (Pad            (tmpMyf.Client_Name,27  ))
                    Write   Channel 9 (Pad            (tmpMyf.Job        ,15  ))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Ypoxreos   , 1,0))
                    Write   Channel 9 (Pad            (tmpMyf.Polh       ,10  ))
                    Write   Channel 9 (Pad            (tmpMyf.Odos       ,16  ))
                    Write   Channel 9 (Pad            (tmpMyf.Arithmos   , 3  ))
                    Write   Channel 9 (Pad            (tmpMyf.TK         , 5  ))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Plhthos    , 7,0))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Axia      ,14,2))
                    Write   Channel 9 (Pad            (tmpMyf.Client_ID  ,20  ))
                    Writeln Channel 9
                    Find GT tmpMyf By Index.1
                Loop
                // Ftiaxnoume ta record typou 4 XREOSTIKOI PROMHTHEYTES KANONIKOI
                Move 0 to iCount
                Clear tmpMyf
                Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                Move 4                  to tmpMyf.Typos_Record
                Move '02'               to tmpMyf.Module
                Find GT tmpMyf By Index.1
                While ((Found) And (tmpMyf.Myf_Year=piMyfYear(Self)) And (tmpMyf.Typos_Record=4) And (tmpMyf.Module='02'))
                    Add 1 to iCount
                    Write   Channel 9 2
                    Write   Channel 9 (Sfi_All_Numbers(iCount            , 5,0))
                    Write   Channel 9 (Trim           (tmpMyf.Afm             ))
                    Write   Channel 9 (Pad            (tmpMyf.Client_Name,27  ))
                    Write   Channel 9 (Pad            (tmpMyf.Job        ,15  ))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Ypoxreos   , 1,0))
                    Write   Channel 9 (Pad            (tmpMyf.Polh       ,10  ))
                    Write   Channel 9 (Pad            (tmpMyf.Odos       ,16  ))
                    Write   Channel 9 (Pad            (tmpMyf.Arithmos   , 3  ))
                    Write   Channel 9 (Pad            (tmpMyf.TK         , 5  ))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Plhthos    , 7,0))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Axia       ,14,2))
                    Write   Channel 9 (Pad            (tmpMyf.Client_ID  ,20  ))
                    Writeln Channel 9
                    Find GT tmpMyf By Index.1
                Loop
                // Ftiaxnoume ta record typou 12 XREOSTIKOI PELATES DHMOSIOY
                Move 0 to iCount
                Clear tmpMyf
                Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                Move 12                 to tmpMyf.Typos_Record
                Move '01'               to tmpMyf.Module
                Find GT tmpMyf By Index.1
                While ((Found) And (tmpMyf.Myf_Year=piMyfYear(Self)) And (tmpMyf.Typos_Record=12) And (tmpMyf.Module='01'))
                    Add 1 to iCount
                    Write   Channel 9 3
                    Write   Channel 9 (Sfi_All_Numbers(iCount            , 5,0))
                    Write   Channel 9 (Trim           (tmpMyf.Afm             ))
                    Write   Channel 9 (Pad            (tmpMyf.Client_Name,27  ))
                    Write   Channel 9 (Pad            (tmpMyf.Job        ,15  ))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Ypoxreos   , 1,0))
                    Write   Channel 9 (Pad            (tmpMyf.Polh       ,10  ))
                    Write   Channel 9 (Pad            (tmpMyf.Odos       ,16  ))
                    Write   Channel 9 (Pad            (tmpMyf.Arithmos   , 3  ))
                    Write   Channel 9 (Pad            (tmpMyf.TK         , 5  ))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Plhthos    , 7,0))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Axia      ,14,2))
                    Write   Channel 9 (Pad            (tmpMyf.Client_ID  ,20  ))
                    Writeln Channel 9
                    Find GT tmpMyf By Index.1
                Loop
                // Ftiaxnoume ta record typou 14 XREOSTIKOI PROMHTHEYTES DHMOSIOY
                Move 0 to iCount
                Clear tmpMyf
                Move (piMyfYear(Self))  to tmpMyf.Myf_Year
                Move 14                 to tmpMyf.Typos_Record
                Move '02'               to tmpMyf.Module
                Find GT tmpMyf By Index.1
                While ((Found) And (tmpMyf.Myf_Year=piMyfYear(Self)) And (tmpMyf.Typos_Record=14) And (tmpMyf.Module='02'))
                    Add 1 to iCount
                    Write   Channel 9 4
                    Write   Channel 9 (Sfi_All_Numbers(iCount            , 5,0))
                    Write   Channel 9 (Trim           (tmpMyf.Afm             ))
                    Write   Channel 9 (Pad            (tmpMyf.Client_Name,27  ))
                    Write   Channel 9 (Pad            (tmpMyf.Job        ,15  ))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Ypoxreos   , 1,0))
                    Write   Channel 9 (Pad            (tmpMyf.Polh       ,10  ))
                    Write   Channel 9 (Pad            (tmpMyf.Odos       ,16  ))
                    Write   Channel 9 (Pad            (tmpMyf.Arithmos   , 3  ))
                    Write   Channel 9 (Pad            (tmpMyf.TK         , 5  ))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Plhthos    , 7,0))
                    Write   Channel 9 (Sfi_All_Numbers(tmpMyf.Axia       ,14,2))
                    Write   Channel 9 (Pad            (tmpMyf.Client_ID  ,20  ))
                    Writeln Channel 9
                    Find GT tmpMyf By Index.1
                Loop
                Close_Output Channel 9
            End_Procedure
            
            Procedure OnClick
                Integer isOK  iPlhthosKan iPlhthosDhm iPlhthosTotal iYes iErrorObjID
                Number  nAxiaKan nAxiaDhm nAxiaTotal
                String sMess
                BEGIN_TRANSACTION
                    Move Error_Object_ID to iErrorObjID
                    Send Make_Ascii_Files
                END_TRANSACTION
                Unlock
                Move iErrorObjID to Error_Object_ID
                Move '' to sMess
                Append sMess '† › ˜› ¡˜©å˜ ¦¢¦¡¢¨éŸ¡œ.' '\n'
                Append sMess '‡˜ ™¨œå«œ «˜ ˜¨®œå˜ MYFYPOKAT ¡˜  MYFYPOKAT.PIS' '\n'
                Append sMess '©«¦¤ ™˜© ¡æ ¡˜«á¢¦š¦ «¦¬ ›å©¡¦¬ ©˜ª -> C:\'
                Send Info_Box sMess '¢¨¦­¦¨å˜'
            End_Procedure
            
            
            
            
            
            
            
            //AB-StoreEnd

        End_Object    // btnMakeAscii


        //AB-StoreStart
                            
        Set Verify_Data_Loss_Msg TO Get_No_Confirmation
        Set Verify_Delete_Msg    TO Get_No_Confirmation
        Set Verify_Save_Msg      TO Get_No_Confirmation
        Set Verify_Exit_Msg      TO Get_No_confirmation
        
        
        Procedure Rebuild_All_Constraints
            Send Rebuild_Constraints    to (tmpMyf_DD (dbTabView1(dbTabDialogSView1(Self))))
            Send Rebuild_Constraints    to (tmpMyf_DD (dbTabView2(dbTabDialogSView1(Self))))
            Send Rebuild_Constraints    to (tmpMyf_DD (dbTabView3(dbTabDialogSView1(Self))))
            Send Rebuild_Constraints    to (tmpMyf_DD (dbTabView4(dbTabDialogSView1(Self))))
            Send Rebuild_Constraints    to (tmpMyf_DD (dbTabView5(dbTabDialogSView1(Self))))
            Send Rebuild_Constraints    to (tmpMyf_DD (dbTabView6(dbTabDialogSView1(Self))))
            Send Rebuild_Constraints    to (tmpMyf_DD (dbTabView7(dbTabDialogSView1(Self))))
            Send Rebuild_Constraints    to (tmpMyf_DD (dbTabView8(dbTabDialogSView1(Self))))
            Send Rebuild_Constraints    to (tmpMyf_DD (dbTabView9(dbTabDialogSView1(Self))))
        
            Send Rebuild_Constraints    to (tmpMyf_DD2(dbTabView2(dbTabDialogSView1(Self))))
            Send Rebuild_Constraints    to (tmpMyf_DD2(dbTabView3(dbTabDialogSView1(Self))))
            Send Rebuild_Constraints    to (tmpMyf_DD2(dbTabView4(dbTabDialogSView1(Self))))
            Send Rebuild_Constraints    to (tmpMyf_DD2(dbTabView5(dbTabDialogSView1(Self))))
            Send Rebuild_Constraints    to (tmpMyf_DD2(dbTabView6(dbTabDialogSView1(Self))))
            Send Rebuild_Constraints    to (tmpMyf_DD2(dbTabView7(dbTabDialogSView1(Self))))
            Send Rebuild_Constraints    to (tmpMyf_DD2(dbTabView8(dbTabDialogSView1(Self))))
            Send Rebuild_Constraints    to (tmpMyf_DD2(dbTabView9(dbTabDialogSView1(Self))))
        
            Send Beginning_Of_Data      to (tmpMyf_   (dbTabView2(dbTabDialogSView1(Self))))
            Send Beginning_Of_Data      to (tmpMyf_   (dbTabView3(dbTabDialogSView1(Self))))
            Send Beginning_Of_Data      to (tmpMyf_   (dbTabView4(dbTabDialogSView1(Self))))
            Send Beginning_Of_Data      to (tmpMyf_   (dbTabView5(dbTabDialogSView1(Self))))
            Send Beginning_Of_Data      to (tmpMyf_   (dbTabView6(dbTabDialogSView1(Self))))
            Send Beginning_Of_Data      to (tmpMyf_   (dbTabView7(dbTabDialogSView1(Self))))
            Send Beginning_Of_Data      to (tmpMyf_   (dbTabView8(dbTabDialogSView1(Self))))
            Send Beginning_Of_Data      to (tmpMyf_   (dbTabView9(dbTabDialogSView1(Self))))
        
            Send Find to (tmpMyf_DD (dbTabView1(dbTabDialogSView1(Self)))) First_Record 1
            Send Find to (tmpMyf_DD2(dbTabView2(dbTabDialogSView1(Self)))) First_Record 1
            Send Find to (tmpMyf_DD2(dbTabView3(dbTabDialogSView1(Self)))) First_Record 1
            Send Find to (tmpMyf_DD2(dbTabView4(dbTabDialogSView1(Self)))) First_Record 1
            Send Find to (tmpMyf_DD2(dbTabView5(dbTabDialogSView1(Self)))) First_Record 1
            Send Find to (tmpMyf_DD2(dbTabView6(dbTabDialogSView1(Self)))) First_Record 1
            Send Find to (tmpMyf_DD2(dbTabView7(dbTabDialogSView1(Self)))) First_Record 1
            Send Find to (tmpMyf_DD2(dbTabView8(dbTabDialogSView1(Self)))) First_Record 1
            Send Find to (tmpMyf_DD2(dbTabView9(dbTabDialogSView1(Self)))) First_Record 1
        End_Procedure
        
        Procedure Activate_View Returns Integer
            Integer rVal iYear isOK
            Set Value Of frmEtosMyf Item 0 to (SyscurXr.Year_Year-1)
            Set piMyfYear to (SyscurXr.Year_Year-1)
            Forward Get Msg_Activate_View to rVal
            Send ChangeAllFileModes                                DF_Filemode_ReadOnly
            Set_Attribute DF_File_Mode Of tmpMyf.File_Number    to DF_Filemode_Default
            Set_Attribute DF_File_Mode Of tmpMyfA.File_Number   to DF_Filemode_Default
            Get fiMake_Record_3 to isOK
            Get fiMake_Record_5 to isOK
            Send ChangeAllFileModes DF_Filemode_Default
            Send Activate to frmEtosMyf
            Send Rebuild_All_Constraints
            Send Clear to Branch_DD
            Procedure_Return rVal
        End_Procedure
        
        Procedure Deixe_Ta_Lathi String asFile
            Integer liLathi
            Set piLathi to 0
            send Delete_Data to (EditSub1(Keimeno(Self)))
            send read to (EditSub1(Keimeno(Self))) (Trim(asFile))
            Send popup to (Keimeno(Self))
        End_Procedure
        
        
        Object Rpt1_Report is a CrystalReportSubSQL
        
            Property Integer ReportReady Public False
        
            //***
            //*** Procedure: RunRpt1Report
            //*** Purpose  : Run the Rpt1 report
            //***
        
            Procedure RunRpt1Report
                //*** We will be busy, change the cursor
                Send Cursor_Wait To (Cursor_Control(Self))
        
                Set Output_Destination  To PRINT_TO_WINDOW
        
                //*** Run the report
                Send Run_report
        
                //*** We are ready, change the cursor
                Send Cursor_Ready To (Cursor_Control(Self))
        
                //*** Report you are finsihed for those seetings that do not use the
                //*** screen
                If (ReportReady(Self)) ;
                    Send Info_box "’¦ report œå¤˜  â«¦ £¦." "¢¨¦­¦¨å˜"
            End_procedure // RunRpt1Report
        
        //***************** Predefined Procedures and Functions Section **************
        
            Set Report_Name to "Myf.rpt"
            Set Report_View_id To (Parent(Self))
        
            set WindowStyle to (WS_VISIBLE ior WS_THICKFRAME ior ;
                                WS_SYSMENU ior WS_MAXIMIZEBOX ior ;
                                WS_MINIMIZEBOX ior WS_MAXIMIZE)
        
             Procedure OnStartPrinting
                String  FileName
                Integer FileType Destination
        
                If Destination EQ WQL_PRINT_TO_WINDOW ;
                    Set ReportReady To False
                Else ;
                    Set ReportReady To True
        
             End_procedure // OnStartPrinting
        
             Procedure OnStopPrinting
                  Set ZoomPreviewWindow to PE_ZOOM_FULL_SIZE
             End_procedure // OnStopPrinting
        
        End_Object // Rpt1_Report
        
        
        
        Object Rpt2_Report is a CrystalReportSubSQL
        
            Property Integer ReportReady Public False
        
            //***
            //*** Procedure: RunRpt1Report
            //*** Purpose  : Run the Rpt2 report
            //***
        
            Procedure RunRpt1Report2
                //*** We will be busy, change the cursor
                Send Cursor_Wait To (Cursor_Control(Self))
        
                Set Output_Destination  To PRINT_TO_WINDOW
        
                //*** Run the report
                Send Run_report
        
                //*** We are ready, change the cursor
                Send Cursor_Ready To (Cursor_Control(Self))
        
                //*** Report you are finsihed for those seetings that do not use the
                //*** screen
                If (ReportReady(Self)) ;
                    Send Info_box "’¦ report œå¤˜  â«¦ £¦." "¢¨¦­¦¨å˜"
            End_procedure // RunRpt1Report
        
        //***************** Predefined Procedures and Functions Section **************
        
            Set Report_Name to "MyfAfm.rpt"
            Set Report_View_id To (Parent(Self))
        
            set WindowStyle to (WS_VISIBLE ior WS_THICKFRAME ior ;
                                WS_SYSMENU ior WS_MAXIMIZEBOX ior ;
                                WS_MINIMIZEBOX ior WS_MAXIMIZE)
        
             Procedure OnStartPrinting
                String  FileName
                Integer FileType Destination
        
                If Destination EQ WQL_PRINT_TO_WINDOW ;
                    Set ReportReady To False
                Else ;
                    Set ReportReady To True
        
             End_procedure // OnStartPrinting
        
             Procedure OnStopPrinting
                  Set ZoomPreviewWindow to PE_ZOOM_FULL_SIZE
             End_procedure // OnStopPrinting
        
        End_Object // Rpt2_Report
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        //AB-StoreEnd

    End_Object    // vwMyf


    //AB-StoreStart
                                
                                
    Open PtypparL
    
    
    
    //AB-StoreEnd

//AB/     End_Object    // prj
