//AB/ Project r18_3b:polhseis/pelath
//AB/     Object prj is a Report_Project
//AB/         Set ProjectName to "r18_3b:polhseis/pelath"
//AB/         Set ProjectFileName to "r18_3b.RV"

// Project Object Structure
//   r18_3b is a ReportViewSub
//     SortOrderGroup is a RadioGroup
//       NumberSortRadio is a Radio
//       NameSortRadio is a Radio
//     GroupSub1 is a GroupSub
//       cust_from is a Form
//       cust_to is a FormSub
//       F_CODE_APO is a FormSub
//       F_CODE_EOS is a FormSub
//       TextBoxSub1 is a TextBoxSub
//       TextBoxSub2 is a TextBoxSub
//       Textbox6 is a Textbox
//       TextBoxSub27 is a TextBoxSub
//       FormSub3 is a FormSub
//       FormSub4 is a FormSub
//       FormSub5 is a FormSub
//       FormSub6 is a FormSub
//     GroupSub3 is a GroupSub
//       F_ONO_APO is a FormSub
//       F_ONO_EOS is a FormSub
//       Textbox1 is a Textbox
//       Textbox2 is a Textbox
//     GroupSub4 is a GroupSub
//       F_HME_APO is a FormSub
//       F_HME_EOS is a FormSub
//       Textbox3 is a Textbox
//       Textbox4 is a Textbox
//     DestRadio is a RadioGroup
//       WindowRadio is a Radio
//       PrinterRadio is a Radio
//     dbRadioGroupSub1 is a dbRadioGroupSub
//       Radio1 is a RadioSub
//       Radio2 is a RadioSub
//       Radio3 is a RadioSub
//     ButtonSub1 is a Button
//     ButtonSub2 is a ButtonSub
//     LineControlSub1 is a LineControlSub
//     GroupSub5 is a GroupSub
//       FormSub7 is a FormSub
//       FormSub8 is a FormSub
//     polhseis_BasicReport is a BasicReport
//       Company_DD is a Company_DataDictionary
//       Branch_DD is a Branch_DataDictionary
//       Year_DD is a Year_DataDictionary
//       Ctypkin_DD is a Ctypkin_DataDictionary
//       Wtypkin_DD is a Wtypkin_DataDictionary
//       Ptyppar_DD is a Ptyppar_DataDictionary
//       Pseira_DD is a Pseira_DataDictionary
//       Clients_DD is a Clients_DataDictionary
//       Particle_DD is a Particle_DataDictionary
//       Wapokat_DD is a Wapokat_DataDictionary
//       Wapomast_DD is a Wapomast_DataDictionary
//       Wax_DD is a Wax_DataDictionary
//       Units_DD is a Units_DataDictionary
//       Witemkat_DD is a Witemkat_DataDictionary
//       Item_DD is a Item_DataDictionary
//       Witemx_DD is a Witemx_DataDictionary
//       Hmgiow_DD is a Hmgiow_DataDictionary
//       Hmwtyp_DD is a Hmwtyp_DataDictionary
//       Wcmoves_DD is a Wcmoves_DataDictionary
//       Syscurxr_DD is a Syscurxr_DataDictionary
//       Cn_DD is a Cn_DataDictionary

// Register all objects
Register_Object Branch_DD
Register_Object ButtonSub1
Register_Object ButtonSub2
Register_Object Clients_DD
Register_Object Cn_DD
Register_Object Company_DD
Register_Object Ctypkin_DD
Register_Object cust_from
Register_Object cust_to
Register_Object DestRadio
Register_Object dbRadioGroupSub1
Register_Object F_CODE_APO
Register_Object F_CODE_EOS
Register_Object F_HME_APO
Register_Object F_HME_EOS
Register_Object F_ONO_APO
Register_Object F_ONO_EOS
Register_Object FormSub3
Register_Object FormSub4
Register_Object FormSub5
Register_Object FormSub6
Register_Object FormSub7
Register_Object FormSub8
Register_Object GroupSub1
Register_Object GroupSub3
Register_Object GroupSub4
Register_Object GroupSub5
Register_Object Hmgiow_DD
Register_Object Hmwtyp_DD
Register_Object Item_DD
Register_Object LineControlSub1
Register_Object NameSortRadio
Register_Object NumberSortRadio
Register_Object Particle_DD
Register_Object PrinterRadio
Register_Object Pseira_DD
Register_Object Ptyppar_DD
Register_Object polhseis_BasicReport
Register_Object Radio1
Register_Object Radio2
Register_Object Radio3
Register_Object r18_3b
Register_Object SortOrderGroup
Register_Object Syscurxr_DD
Register_Object TextBoxSub1
Register_Object TextBoxSub2
Register_Object TextBoxSub27
Register_Object Textbox1
Register_Object Textbox2
Register_Object Textbox3
Register_Object Textbox4
Register_Object Textbox6
Register_Object Units_DD
Register_Object Wapokat_DD
Register_Object Wapomast_DD
Register_Object Wax_DD
Register_Object Wcmoves_DD
Register_Object WindowRadio
Register_Object Witemkat_DD
Register_Object Witemx_DD
Register_Object Wtypkin_DD
Register_Object Year_DD


//AB/     Report View


    //AB-StoreTopStart
    Use dfallrpt
    use company.dd
    use branch.dd
    use year.dd
    Use ctypkin.dd
    use wtypkin.dd
    use ptyppar.dd
    use pseira.dd
    use particle.dd
    use wapokat.dd
    use wapomast.dd
    use wax.dd
    use units.dd
    use witemkat.dd
    use item.dd
    use witemx.dd
    use cn.dd
    Use pmoves.dd
    Use syscurxr.dd
    use rvir18_3b.pkg
    open clients
    Use Hmgiow.dd
    Use Hmwtyp.dd
    use hmgiow.sl
    //AB-StoreTopEnd

    //AB-IgnoreStart

    Use Rptvw.Sub
    Use DFAllEnt.pkg
    Use Group.Sub
    Use Form.Sub
    Use Txtbox.Sub
    Use dbRgroup.Sub
    Use Radio.Sub
    Use Button.Sub
    Use Line.Sub

    //AB-IgnoreEnd

    ACTIVATE_VIEW Activate_r18_3b FOR r18_3b

    Object r18_3b is a ReportViewSub

        //AB-StoreTopStart
        Property Integer Sort_IndexR18_3 Public 1
        property string psdatetor18_3##
        property string psdatefromr18_3##
        property string pscustfromr18_3##
        property string pscusttor18_3##
        property string psitemfromr18_3##
        property string psitemtor18_3##
        property string psctypkinfromr18_3##
        property string psctypkintor18_3##
        property integer pisubr18_3## public 0
        property integer epilr18_3## public 0
        property number pqty## public 0
        property number pekp## public 0
        property number pfpa## public 0
        property number ppay## public 0
        Property String psModule Public ''
        property integer pihmgio public ''
        //AB-StoreTopEnd

        Set Label to "è‡¢„©ú†™ Ñ†õÈ§ âò´· èú¢·´û (Basic Report)"
        Set Size to 282 293
        Set Location to 1 5

        //AB-DDOStart


        //AB-DDOEnd

        Object SortOrderGroup is a RadioGroup

            //AB-StoreTopStart
                                                                                                                                                        
            //AB-StoreTopEnd

            Set Label to "â®†´„®†¶ íò•†§Ê£û©û™"
            Set Size to 54 93
            Set Location to 154 3
            Object NumberSortRadio is a Radio
                Set Label to "âò´· â‡õ†°Ê î¶®‚ò"
                Set Size to 10 85
                Set Location to 12 4
            End_Object    // NumberSortRadio

            Object NameSortRadio is a Radio
                Set Label to "âò´· Ñß‡§¨£Âò"
                Set Size to 10 71
                Set Location to 24 4

                //AB-StoreStart
                set enabled_state to false
                
                //AB-StoreEnd

            End_Object    // NameSortRadio


            //AB-StoreStart
            Procedure Notify_Select_State  Integer iNewItem  Integer iOldItem
                Forward Send Notify_Select_State  iNewItem  iOldItem
                Set Sort_IndexR18_3  To (iNewItem + 1)
            End_Procedure
            
            
            
            //AB-StoreEnd

        End_Object    // SortOrderGroup

        Object GroupSub1 is a GroupSub
            Set Label to "Ñß†¢¶ö„ î¶®‚ò -ÑÂõ¶¨™"
            Set Size to 71 283
            Set Location to 1 1
            Object cust_from is a Form
                Set Size to 13 70
                Set Location to 12 61
                Set Label_Justification_Mode to jMode_Right
                Set Form_DataType to ascii_window
                Set Prompt_Button_Mode to pb_PromptOn

                //AB-StoreStart
                Set Prompt_Object to (sl100(Current_object))
                Procedure Prompt_Callback integer hPrompt
                    set Export_Column of hPrompt to 0
                    Set Initial_Column of hPrompt to 0
                end_procedure
                
                
                procedure onchange
                    string sclient
                    get value item 0 to sclient
                    Move (fsclient(Self,sclient)) to sclient
                    set value of (formsub3(self)) to sclient
                end_procedure
                
                procedure prompt
                    Set psModule Of (sl100(Self)) to (psModule(Self))
                    Forward Send Prompt
                end_procedure
                
                
                //AB-StoreEnd

            End_Object    // cust_from

            Object cust_to is a FormSub
                Set Size to 13 70
                Set Location to 26 61
                Set Label_Col_Offset to 2
                Set Prompt_Button_Mode to pb_PromptOn
                Set Form_TypeFace Item 0 to "MS Sans Serif"

                //AB-StoreStart
                Set Prompt_Object to (sl100(Current_object))
                Procedure Prompt_Callback integer hPrompt
                    set Export_Column of hPrompt to 0
                    Set Initial_Column of hPrompt to 0
                end_procedure
                procedure onchange
                    string sclient
                    get value item 0 to sclient
                    Move (fsclient(Self,sclient)) to sclient
                    set value of (formsub4(self)) to sclient
                end_procedure
                
                procedure prompt
                    Set psModule Of (sl100(Self)) to (psModule(Self))
                    Forward Send Prompt
                end_procedure
                
                //AB-StoreEnd

            End_Object    // cust_to

            Object F_CODE_APO is a FormSub

                //AB-StoreTopStart
                                                                                                                                                                                                                        
                //AB-StoreTopEnd

                Set Size to 13 70
                Set Location to 41 61
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
                Set Prompt_Button_Mode to pb_PromptOn
                Set Form_TypeFace Item 0 to "MS Sans Serif"

                //AB-StoreStart
                                                                                                                                                                                                                        
                Set Prompt_Object to (SL22s(Current_object))
                Procedure Prompt_Callback integer hPrompt
                    set Export_Column of hPrompt to 0
                    Set Initial_Column of hPrompt to 0
                end_procedure
                
                procedure onchange
                    string witem sdescr
                    get value item 0 to witem
                    move (fsitem(self,witem)) to sdescr
                    set value of (formsub5(self)) to sdescr
                end_procedure
                
                
                
                
                
                //AB-StoreEnd

            End_Object    // F_CODE_APO

            Object F_CODE_EOS is a FormSub

                //AB-StoreTopStart
                                                                                                                                                                                                                        
                //AB-StoreTopEnd

                Set Size to 13 70
                Set Location to 55 61
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
                Set Prompt_Button_Mode to pb_PromptOn
                Set Form_TypeFace Item 0 to "MS Sans Serif"

                //AB-StoreStart
                                                                                                                                                                                                                        
                Set Prompt_Object to (SL22s(Current_object))
                Procedure Prompt_Callback integer hPrompt
                    set Export_Column of hPrompt to 0
                    Set Initial_Column of hPrompt to 0
                end_procedure
                
                
                procedure onchange
                    string witem sdescr
                    get value item 0 to witem
                    move (fsitem(self,witem)) to sdescr
                    set value of (formsub6(self)) to sdescr
                end_procedure
                
                
                
                
                //AB-StoreEnd

            End_Object    // F_CODE_EOS

            Object TextBoxSub1 is a TextBoxSub
                Set Label to "ÑÂõ¶™ ÄßÊ"
                Set Auto_Size_State to FALSE
                Set FontSize to 4 0
                Set Location to 42 5
                Set Size to 10 44
                Set TypeFace to "MS Sans Serif"
                Set Enabled_State to TRUE
            End_Object    // TextBoxSub1

            Object TextBoxSub2 is a TextBoxSub
                Set Label to "ÑÂõ¶™ ÑÈ™"
                Set Auto_Size_State to FALSE
                Set FontSize to 4 0
                Set Location to 55 5
                Set Size to 13 47
                Set TypeFace to "MS Sans Serif"
                Set Enabled_State to TRUE
            End_Object    // TextBoxSub2

            Object Textbox6 is a Textbox
                Set Label to "î¶®‚ò™  ÄßÊ"
                Set Location to 12 4
                Set Size to 10 50
                Set TypeFace to "MS Sans Serif"
            End_Object    // Textbox6

            Object TextBoxSub27 is a TextBoxSub
                Set Label to "î¶®‚ò™  ÑÈ™"
                Set Location to 28 4
                Set Size to 10 46
                Set TypeFace to "MS Sans Serif"
            End_Object    // TextBoxSub27

            Object FormSub3 is a FormSub
                Set Size to 13 140
                Set Location to 12 136
                Set Label_Col_Offset to 2
                Set Form_TypeFace Item 0 to "MS Sans Serif"

                //AB-StoreStart
                set enabled_state to false
                //AB-StoreEnd

            End_Object    // FormSub3

            Object FormSub4 is a FormSub
                Set Size to 13 140
                Set Location to 26 136
                Set Label_Col_Offset to 2
                Set Form_TypeFace Item 0 to "MS Sans Serif"

                //AB-StoreStart
                set enabled_state to false
                //AB-StoreEnd

            End_Object    // FormSub4

            Object FormSub5 is a FormSub
                Set Size to 13 140
                Set Location to 41 136
                Set Label_Col_Offset to 2
                Set Form_TypeFace Item 0 to "MS Sans Serif"

                //AB-StoreStart
                set enabled_state to false
                //AB-StoreEnd

            End_Object    // FormSub5

            Object FormSub6 is a FormSub
                Set Size to 13 140
                Set Location to 55 136
                Set Label_Col_Offset to 2
                Set Form_TypeFace Item 0 to "MS Sans Serif"

                //AB-StoreStart
                set enabled_state to false
                //AB-StoreEnd

            End_Object    // FormSub6


            //AB-StoreStart
                                                                                                                                                        
                                                                                                                                                        
                                                                                                                                                        
                                                                                                                                                        
                                                                                                                                                        
                                                                                                                                                        
                                                                                                                                                        
                                                                                                                                                        
            //AB-StoreEnd

        End_Object    // GroupSub1

        Object GroupSub3 is a GroupSub
            Set Label to "Ñß†¢¶ö„ Ñß‡§¨£Âò™ èú¢ò´È§"
            Set Size to 40 283
            Set Location to 44 1
            Set Visible_State to FALSE
            Object F_ONO_APO is a FormSub
                Set Size to 13 211
                Set Location to 9 60
                Set Color to clBtnFace
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
                Set Prompt_Button_Mode to pb_PromptOn
                Set Enabled_State to FALSE
                Set Form_TypeFace Item 0 to "MS Sans Serif"
                Set Implicit_Shadow_State to TRUE
                Set Item_Shadow_State Item 0 to TRUE
                Set Shadow_State Item 0 to TRUE

                //AB-StoreStart
                                                                                                                                                                                                                        
                                                                                                                                                                                                                        
                                                                                                                                                                                                                        
                                                                                                                                                                                                                        
                                                                                                                                                                                                                        
                                                                                                                                                                                                                        
                                                                                                                                                                                                                        
                                                                                                                                                                                                                        
                                                                                                                                                                                                                        
                                                                                                                                                                                                                        
                                                                                                                                                                                                                        
                                                                                                                                                                                                                        
                //AB-StoreEnd

            End_Object    // F_ONO_APO

            Object F_ONO_EOS is a FormSub
                Set Size to 13 211
                Set Location to 24 60
                Set Color to clBtnFace
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
                Set Prompt_Button_Mode to pb_PromptOn
                Set Enabled_State to FALSE
                Set Form_TypeFace Item 0 to "MS Sans Serif"
                Set Implicit_Shadow_State to TRUE
                Set Item_Shadow_State Item 0 to TRUE
                Set Shadow_State Item 0 to TRUE

                //AB-StoreStart
                                                                                                                                                                                                                        
                                                                                                                                                                                                                        
                                                                                                                                                                                                                        
                                                                                                                                                                                                                        
                                                                                                                                                                                                                        
                                                                                                                                                                                                                        
                                                                                                                                                                                                                        
                                                                                                                                                                                                                        
                                                                                                                                                                                                                        
                                                                                                                                                                                                                        
                                                                                                                                                                                                                        
                //AB-StoreEnd

            End_Object    // F_ONO_EOS

            Object Textbox1 is a Textbox
                Set Label to "ÄßÊ é§¶£ò©Âò :"
                Set Location to 10 5
                Set Size to 10 53
                Set TypeFace to "MS Sans Serif"
            End_Object    // Textbox1

            Object Textbox2 is a Textbox
                Set Label to "ÑÈ™ é§¶£ò©Âò :"
                Set Location to 25 4
                Set Size to 10 53
                Set TypeFace to "MS Sans Serif"
            End_Object    // Textbox2


            //AB-StoreStart
                                                                                                                                                        
                                                                                                                                                        
                                                                                                                                                        
                                                                                                                                                        
                                                                                                                                                        
                                                                                                                                                        
                                                                                                                                                        
                                                                                                                                                        
                                                                                                                                                        
                                                                                                                                                        
                                                                                                                                                        
            //AB-StoreEnd

        End_Object    // GroupSub3

        Object GroupSub4 is a GroupSub
            Set Label to "Ñß†¢¶ö„ Ü£ú®/§Âò™ â†§„©ú‡§"
            Set Size to 49 283
            Set Location to 74 1
            Object F_HME_APO is a FormSub
                Set Size to 13 68
                Set Location to 8 60
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
                Set Form_Datatype Item 0 to Mask_Date_Window
                Set Prompt_Button_Mode to pb_PromptOn
                Set Form_Mask Item 0 to "d/M/yyyy"
                Set Form_TypeFace Item 0 to "MS Sans Serif"

                //AB-StoreStart
                set prompt_object to (ocalendar(self))
                
                
                
                
                
                //AB-StoreEnd

            End_Object    // F_HME_APO

            Object F_HME_EOS is a FormSub
                Set Size to 13 68
                Set Location to 24 60
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
                Set Form_Datatype Item 0 to Mask_Date_Window
                Set Prompt_Button_Mode to pb_PromptOn
                Set Form_Mask Item 0 to "d/M/yyyy"
                Set Form_TypeFace Item 0 to "MS Sans Serif"

                //AB-StoreStart
                set prompt_object to (ocalendar(self))
                
                
                
                
                
                //AB-StoreEnd

            End_Object    // F_HME_EOS

            Object Textbox3 is a Textbox
                Set Label to "ÄßÊ Ü£/§Âò :"
                Set Location to 10 6
                Set Size to 10 47
                Set TypeFace to "MS Sans Serif"
            End_Object    // Textbox3

            Object Textbox4 is a Textbox
                Set Label to "Ñ‡™ Ü£§Âò  :"
                Set Location to 24 5
                Set Size to 12 45
                Set TypeFace to "MS Sans Serif"
            End_Object    // Textbox4


            //AB-StoreStart
                                                                                                                                                        
                                                                                                                                                        
                                                                                                                                                        
                                                                                                                                                        
                                                                                                                                                        
                                                                                                                                                        
                                                                                                                                                        
                                                                                                                                                        
                                                                                                                                                        
                                                                                                                                                        
                                                                                                                                                        
                                                                                                                                                        
                                                                                                                                                        
                                                                                                                                                        
                                                                                                                                                        
            //AB-StoreEnd

        End_Object    // GroupSub4

        Object DestRadio is a RadioGroup

            //AB-StoreTopStart
                                                                                                                                                        
            //AB-StoreTopEnd

            Set Label to "Ñ°´Á&ß‡©û"
            Set Size to 49 49
            Set Location to 215 0
            Object WindowRadio is a Radio
                Set Size to 13 30
                Set Location to 12 12
                Set Bitmap to "screen4.bmp"
            End_Object    // WindowRadio

            Object PrinterRadio is a Radio
                Set Size to 10 31
                Set Location to 30 12
                Set Bitmap to "PRINT_M1.BMP"
            End_Object    // PrinterRadio


            //AB-StoreStart
                                                                                                                                                        
            //***
            //*** Procedure: Notify_Select_state
            //*** Purpose  : Augemented to setup the output destination of the WinQL
            //***            report. The procedure is sent when the user changes the
            //***            selection.
            //***
            
            Procedure Notify_Select_State  Integer iNewItem  Integer iOldItem
                Forward Send Notify_Select_State  iNewItem  iOldItem
                If iNewItem Eq 0 ;
                    Set Output_Device_Mode To WQL_PRINT_TO_WINDOW
                Else If iNewItem Eq 1;
                    Set Output_Device_Mode To WQL_PRINT_TO_PRINTER
            
            End_Procedure
            
            
            
            //AB-StoreEnd

        End_Object    // DestRadio

        Object dbRadioGroupSub1 is a dbRadioGroupSub
            Set Size to 55 64
            Set Location to 154 99
            Object Radio1 is a RadioSub
                Set Label to "åÊ£†©£ò 1"
                Set Size to 10 46
                Set Location to 10 5

                //AB-StoreStart
                set label to syscurxr.c_code0
                
                //AB-StoreEnd

            End_Object    // Radio1

            Object Radio2 is a RadioSub
                Set Label to "åÊ£†©£ò 2"
                Set Size to 10 46
                Set Location to 25 5

                //AB-StoreStart
                set label to syscurxr.c_code00
                set enabled_state to false
                
                
                //AB-StoreEnd

            End_Object    // Radio2

            Object Radio3 is a RadioSub
                Set Label to "åÊ£†©£ò 3"
                Set Size to 10 46
                Set Location to 40 5

                //AB-StoreStart
                set label to syscurxr.c_coder
                set enabled_state to false
                
                
                
                
                //AB-StoreEnd

            End_Object    // Radio3


            //AB-StoreStart
            Procedure Notify_Select_State  Integer iNewItem  Integer iOldItem
                Forward Send Notify_Select_State  iNewItem  iOldItem
                If iNewItem Eq 0 ;
                    Set epilr18_3## to 1
                Else If iNewItem Eq 1;
                    Set epilr18_3## to 2
                Else If iNewitem Eq 2 ;
                    Set epilr18_3## to 3
            End_Procedure
            
            
            
            
            
            
            
            //AB-StoreEnd

        End_Object    // dbRadioGroupSub1

        Object ButtonSub1 is a Button

            //AB-StoreTopStart
                                                                                                            
            //AB-StoreTopEnd

            Set Bitmap to "RUNPROG.BMP"
            Set Size to 18 28
            Set Location to 220 55

            //AB-StoreStart
            Procedure OnClick
                string dateapo## dateeos## msgstr
                integer listatus## ihmgio
                move 0 to listatus##
            
                Get value of (formsub7(GroupSub5(Self)))   item 0 to ihmgio
                if (ihmgio = 0) begin
                      move "" to msgstr
                      move 1 to listatus##
                      move "ë≠·¢£ò !! É‚§ Ñß†¢‚•ò´ú Ü£ú®¶¢Êö†¶ !!" to msgstr
                      error 999 msgstr
                end
                Get value of (f_hme_apo(GroupSub4(Self)))    item 0 to dateapo##
                Get value of (f_hme_eos(GroupSub4(Self)))    item 0 to dateeos##
                     if (dateapo## ne "") begin
                       if ((dateapo## < syscurxr.year_xrhshfrom) or (dateapo## > syscurxr.year_xrhshto)) begin
                          move "" to msgstr
                          move 1 to listatus##
                          move "Ü£/§Âú™ Ñß†¢¶ö„™ Ñ°´Ê™ é®Â‡§ ï®„©û™" to msgstr
                          error 999 msgstr
            
                       end
                     end
            
                      if (dateeos## ne "") begin
                       if ((dateeos## < syscurxr.year_xrhshfrom) or (dateeos## > syscurxr.year_xrhshto)) begin
                          move "" to msgstr
                           move 1 to listatus##
                          move "Ü£/§Âú™ Ñß†¢¶ö„™ Ñ°´Ê™ é®Â‡§ ï®„©û™" to msgstr
                          error 999 msgstr
                       end
                      end
               if (listatus## = 0) begin
                     Send startreport
               end
            
            End_Procedure
            
            
            //AB-StoreEnd

        End_Object    // ButtonSub1

        Object ButtonSub2 is a ButtonSub

            //AB-StoreTopStart
                                                                                                                                                        
            //AB-StoreTopEnd

            Set Bitmap to "CANCEL.BMP"
            Set Size to 18 28
            Set Location to 245 55
            Set Form_TypeFace Item 0 to "MS Sans Serif"

            //AB-StoreStart
            Procedure OnClick
                Send Request_Cancel
            End_Procedure
            
            
            
            
            //AB-StoreEnd

        End_Object    // ButtonSub2

        Object LineControlSub1 is a LineControlSub
            Set Line_Style to lnSINGLE
            Set Size to 4 306
            Set Location to 212 -2
        End_Object    // LineControlSub1

        Object GroupSub5 is a GroupSub
            Set Label to "Ñß†¢¶ö„ Ü£ú®¶¢¶öÂ¶¨"
            Set Size to 29 279
            Set Location to 124 3
            Object FormSub7 is a FormSub
                Set Size to 13 47
                Set Location to 9 93
                Set Label_Col_Offset to 2
                Set Prompt_Button_Mode to pb_PromptOn
                Set Form_TypeFace Item 0 to "MS Sans Serif"

                //AB-StoreStart
                Set Prompt_Object to (hmgiow(Current_object))
                Set Numeric_Mask Item 0 to 2 0 '*, '
                Procedure Prompt
                    Forward Send prompt
                End_procedure
                
                Procedure Prompt_Callback integer hPrompt
                    set Export_Column of hPrompt    to    0
                    Set Initial_Column of hPrompt   to    0
                end_procedure
                
                procedure onchange
                    string whmgio
                    get value item 0 to whmgio
                    move whmgio to hmgiow.hmgiow_code
                    find eq hmgiow by index.1
                    if (found);
                        set value of (formsub8(self)) to hmgiow.hmgiow_descr
                    else;
                        set value of (formsub8(self)) to ''
                end_procedure
                
                
                
                
                
                
                
                
                
                
                
                //AB-StoreEnd

            End_Object    // FormSub7

            Object FormSub8 is a FormSub
                Set Size to 13 133
                Set Location to 9 143
                Set Label_Col_Offset to 2
                Set Form_TypeFace Item 0 to "MS Sans Serif"

                //AB-StoreStart
                set enabled_state to false
                //AB-StoreEnd

            End_Object    // FormSub8

        End_Object    // GroupSub5


        //AB-StoreStart
        Procedure Activate_View Returns Integer
            String sStr sModule StrDisp
            Integer rVal
            set value of (f_hme_apo(groupsub4(current_object))) to syscurxr.year_xrhshfrom
            set value of (f_hme_eos(groupsub4(current_object))) to syscurxr.year_xrhshto
            Forward Get Msg_Activate_View to rVal
        
            Get psMenuModule  Of Main_Menu  to sModule
            Set psModule                    to sModule
        
            // â‡õ†°ò™ ß¶¨ ò≠¶®ò ´¶ constrain ´‡§ ©´¶†Æú†‡§ ´¶¨ view ¶ß‡™ ßò®ò©´ò´†°·
            // û °†§„©ú†™ ß¶¨ èêÑèÑà §ò úÂ§ò† constrain ò§ò¢¶öò £ú ´¶ °Á°¢‡£ò òß¶
            // ´¶ ¶ß¶†¶ °ò¢úÂ´ò† ´¶ view. è.ï. ò§ °¢ûüúÂ òß¶ è‡¢„©ú†™/èú¢·´ú™ §ò £û§
            // ≠òÂ§¶§´ò† ©´ò ßò®ò©´ò´†°· ´ò ctypkin Äö¶®È§ °¢ß....
        
        
            if (smodule = "01") begin
                 Set Label Of r18_3b to "è‡¢„©ú†™ Ñ†õÈ§ Ä§· èú¢·´û"
            end
             if (smodule = "02") begin
                 Set Label Of r18_3b to "Äö¶®‚™ Ñ†õÈ§ Ä§· è®¶£ûüú¨´„"
             end
            if (psmodule(self) = "01");
                 Set Report_Title of (polhseis_BasicReport(self)) to  "è‡¢„©ú†™ Ñ†õÈ§ Ä§· èú¢·´û         "
            if (psmodule(self) = "02");
                 Set Report_Title of (polhseis_BasicReport(self)) to  "Äö¶®‚™ Ñ†õÈ§ Ä§· è®¶£ûüú¨´„                    "
        
             procedure_return
        End_Procedure
        
        Procedure StartReport
            Integer iOutputDevice
            String  FileName
            string lsdatetor18_3##
            string lsdatefromr18_3##
            string lsctypkinfromr18_3##
            string lsctypkintor18_3##
            string lscustfromr18_3##
            string lscusttor18_3##
            string lsitemfromr18_3##
            string lsitemtor18_3##
            integer lizeror18_3##
            integer epil## iihmgio
            string datehh## datemm## dateyy## dateapo## dateeos##
            Get Output_Device_Mode To iOutputDevice
            If iOutputDevice EQ PRINT_TO_WINDOW Begin
               Make_Temp_File "TXT" FileName
               Move (".\" - FileName)  To FileName
               Set Output_Device_Name  To FileName
            End
            Else ;
            Set Output_Device_Name  To "Lpt1:"
        
           // Collection Of selection Criteria from VIEW
           Get value of (cust_from(GroupSub1(Self)))    item 0 to lscustfromr18_3##
           Get value of (cust_to(GroupSub1(Self)))      item 0 to lscusttor18_3##
           Get value of (f_code_apo(GroupSub1(Self)))   item 0 to lsitemfromr18_3##
           Get value of (f_code_eos(GroupSub1(Self)))   item 0 to lsitemtor18_3##
           Get value of (f_hme_apo(GroupSub4(Self)))    item 0 to lsDatefromr18_3##
           Get value of (f_hme_eos(GroupSub4(Self)))    item 0 to lsDatetor18_3##
           Get value of (FormSub7(GroupSub5(Self)))     item 0 to iiHmgio
           set pscustfromr18_3##    to lscustfromr18_3##
           set pscusttor18_3##      to lscusttor18_3##
           set psitemfromr18_3##    to lsitemfromr18_3##
           set psitemtor18_3##      to lsitemtor18_3##
           set pihmgio              to iihmgio
           get epilr18_3## to epil##
           move lsdatetor18_3## to dateeos##
           move lsdatefromr18_3## to dateapo##
           if (dateeos## eq 0) begin
             move 31 to datehh##
             move 12 to datemm##
             move syscurxr.year_year to dateyy##
             Append dateeos## datehh##
             append dateeos## datemm##
             append dateeos## dateyy##
            end
        
            if (dateapo## eq 0) begin
              move 01 to datehh##
              move 01 to datemm##
              move syscurxr.year_year to dateyy##
              append dateapo## datehh##
              append dateapo## "/"
              append dateapo## datemm##
              append dateapo## "/"
              append dateapo## dateyy##
           end
           set psdatefromr18_3##    to dateapo##
           set psdatetor18_3##      to dateeos##
        //   ------------------------------------------------------------------------------
           Send Run_Report
           If iOutputDevice EQ PRINT_TO_WINDOW Begin
               RunProgram background "notepad" FileName
               EraseFile FileName
            End
        End_Procedure
        
        
        Object polhseis_BasicReport is a BasicReport
        
        
                Object Company_DD is a Company_DataDictionary
                End_Object    // Company_DD
        
                Object Branch_DD is a Branch_DataDictionary
                    Set DDO_Server to (Company_DD(self))
                End_Object    // Branch_DD
        
                Object Year_DD is a Year_DataDictionary
                    Set DDO_Server to (Branch_DD(self))
                End_Object    // Year_DD
        
                Object Ctypkin_DD is a Ctypkin_DataDictionary
                End_Object    // Ctypkin_DD
        
                Object Wtypkin_DD is a Wtypkin_DataDictionary
                End_Object    // Wtypkin_DD
        
                Object Ptyppar_DD is a Ptyppar_DataDictionary
                 Set DDO_Server to (Ctypkin_DD(self))
                 Set DDO_Server to (Wtypkin_DD(self))
                End_Object    // Ptyppar_DD
        
                Object Pseira_DD is a Pseira_DataDictionary
                    Set DDO_Server to (Ptyppar_DD(self))
                end_object
        
                Object Clients_DD is a Clients_DataDictionary
                End_Object    // Clients_DD
        
                Object Particle_DD is a Particle_DataDictionary
                     Set DDO_Server to (Clients_DD(self))
                     Set DDO_Server to (Ptyppar_DD(self))
                end_object
        
                Object Wapokat_DD is a Wapokat_DataDictionary
                End_Object    // Wapokat_DD
        
                Object Wapomast_DD is a Wapomast_DataDictionary
                  Set DDO_Server to (Wapokat_DD(self))
                End_Object    // Wapomast_DD
        
                Object Wax_DD is a Wax_DataDictionary
                  Set DDO_Server to (Wapomast_DD(self))
                End_Object    // Wax_DD
        
                Object Units_DD is a Units_DataDictionary
                End_Object    // Units_DD
        
                Object Witemkat_DD is a Witemkat_DataDictionary
                End_Object    // Witemkat_DD
        
                Object Item_DD is a Item_DataDictionary
                  Set DDO_Server to (Units_DD(self))
                  Set DDO_Server to (Witemkat_DD(self))
                End_Object    // Item_DD
        
                Object Witemx_DD is a Witemx_DataDictionary
                  Set DDO_Server to (Item_DD(self))
                End_Object    // Witemx_DD
        
                Object Hmgiow_DD is a Hmgiow_DataDictionary
                End_Object    // Hmgiow_DD
        
                Object Hmwtyp_DD is a Hmwtyp_DataDictionary
                    Set DDO_Server to (wtypkin_DD(Self))
                    Set DDO_Server to (Hmgiow_DD(Self))
                    Begin_Constraints
                        Integer iHmgio
                        get piHmgio    to iHmgio
                        if iHmgio ne 0 Constrain Hmwtyp.Hmgiow_code eq iHmgio
                    End_Constraints
                End_Object    // HmCtyp_DD
        
        
                Object Wcmoves_DD is a Wcmoves_DataDictionary
                    property string psrecr public ''
                    Set DDO_Server to (Wax_DD(self))
                    Set DDO_Server to (Wtypkin_DD(self))
                    Set DDO_Server to (Witemx_DD(self))
                  Function fiMasKanei Returns Integer
                        Integer rVal
                        If Wcmoves.Wtypkin_Recr In (psRecr(Self)) Move 1 to rVal
                        Else Move 0 to rval
                        Function_Return rVal
                   End_Function
                   begin_constraints
                     string lscustfromr18_3## lscusttor18_3## lsdatetor18_3##
                     string lsitemfromr18_3## lsitemtor18_3## smodule
                     get psmodule to smodule
                     get psdatetor18_3##       to lsdatetor18_3##
                     get pscustfromr18_3##     to lscustfromr18_3##
                     get pscusttor18_3##       to lscusttor18_3##
                     get psitemfromr18_3##     to lsitemfromr18_3##
                     get psitemtor18_3##       to lsitemtor18_3##
                     Constrain wcmoves.company_code eq syscurxr.company_code
                     Constrain wcmoves.branch_code  eq syscurxr.branch_code
                     Constrain wcmoves.year_year    eq syscurxr.year_year
                     if lscustfromr18_3##    ne "" Constrain wcmoves.client_id ge lscustfromr18_3##
                     if lscusttor18_3##      ne "" Constrain wcmoves.client_id le lscusttor18_3##
                     if lsitemfromr18_3##    ne "" Constrain wcmoves.witemx_code ge lsitemfromr18_3##
                     if lsitemtor18_3##      ne "" Constrain wcmoves.witemx_code le lsitemtor18_3##
                     if lsdatetor18_3##      ne "" Constrain wcmoves.wcmove_hmnia le lsdatetor18_3##
                     constrain wcmoves.module_from  eq smodule
                     Constrain wcmoves as (fimaskanei(Self)=1)
        
                   end_constraints
        
        
                End_Object    // wcmoves_DD
        
        
                Object Syscurxr_DD is a Syscurxr_DataDictionary
                End_Object    // Syscurxr_DD
        
                Object Cn_DD is a Cn_DataDictionary
                  Set DDO_Server to (Clients_DD(self))
                End_Object    // cn_DD
        
        
        
        
            Set Server To (wcmoves_DD(Current_Object))
            Report_Index By Index.13
            report_breaks  wcmoves.company_code wcmoves.branch_code wcmoves.year_year wcmoves.client_id Wcmoves.witemx_code
        
            Function Starting_Main_Report Returns Integer
              Local Integer iRetVal iindexr18_3
              local string sstr
              move '' to sstr
              Forward Get Starting_Main_Report to iRetval
              set page_end to 60
              set page_feed  to 66
              Send Rebuild_Constraints to Hmwtyp_DD
        
              Send Find to Hmwtyp_dd First_Record 1
              While (Found)
                    Append sStr Hmwtyp.wtypkin_recr ','
                    Send Find to Hmwtyp_dd Next_Record 1
              Loop
              Set psRecr of Wcmoves_DD to sStr
        
              Send Rebuild_Constraints to wCmoves_DD
              Send Find to (wcmoves_dd(self)) First_Record 13
              Report_Index BY 13
           End_Function
        
           Procedure_Section Page_Top as Headerr18_3
              Local Integer iPage epil##
              string smodule
              date ddate
              sysdate4 ddate
              get epilr18_3## to epil##
              get psmodule to smodule
              move syscurxr.company_name  to headerr18_3.1
              move syscurxr.branch_name   to headerr18_3.2
              move syscurxr.year_year     to headerr18_3.3
              Get Page_Count to headerr18_3.4
              if (smodule = "01" ) begin
                 move "è ó ä Ü ë Ñ à ë  è Ñ ä Ä í ó å  â Ä í Ä  èÑäÄíÜ/ÑàÉéë " to headerr18_3.5
              end
              if (smodule = "02" ) begin
                 move "Ä Ç é ê Ñ ë  è ê é ã Ü á Ñ ì í ó å  âÄíÄ èêéãÜáÑìíÜ/ÑàÉéë" to headerr18_3.5
              end
              Case Begin
                    Case (epil## = 1)
                      print syscurxr.c_code0 to headerr18_3.6
                      Case Break
        
                    Case (epil## = 2)
                      print syscurxr.c_code00 to headerr18_3.6
                      Case Break
                    Case (epil## = 3)
                      print syscurxr.c_coder to headerr18_3.6
                     Case Break
        
              Case End
        
              print hmgiow.hmgiow_descr to headerr18_3.7
              print ddate to headerr18_3.8
              get psdatefromr18_3## to headerr18_3.9
              get psdatetor18_3##   to headerr18_3.10
              OutPut_PageCheck
           End_Procedure
        
           Procedure_Section SubHeader1 as Subheaderr18_31
           end_procedure
        
           Procedure_Section SubHeader2 as Subheaderr18_32
           end_procedure
        
           Procedure_Section SubHeader3 as Subheaderr18_33
           end_procedure
        
           Procedure_Section SubHeader4 as Subheaderr18_3
               print wcmoves.client_id to subheaderr18_3.1
               clear clients
               move  wcmoves.client_recr to clients.client_recr
               find eq clients by index.2
               print clients.client_name to subheaderr18_3.2
               output_pagecheck
           end_procedure
        
           Procedure_Section SubHeader5 as Subheaderr18_3a
               print witemx.witemx_code to subheaderr18_3a.1
               print witemx.witemx_descr to subheaderr18_3a.2
               output_pagecheck
           end_procedure
        
           Procedure_Section  Body as Bodyr18_3
               number qty## ekp## fpa## pay## fnum## iabs
               integer lisub## epil##
               string lsdatefromr18_3## lsdatetor18_3## smodule
               get psdatefromr18_3## to lsdatefromr18_3##
               get psdatetor18_3##   to lsdatetor18_3##
               get epilr18_3## to epil##
               get psmodule to smodule
               send update_status ('î¶®‚ò™' + ":" + string(wcmoves.client_id))
               if (wcmoves.wcmove_hmnia lt lsdatefromr18_3##) begin
                   get pqty## to qty##
                   get pekp## to ekp##
                   get pfpa## to fpa##
                   get ppay## to pay##
                   add Wcmoves.wcmove_qty to qty##
                   add wcmoves.wcmov_discam0 to ekp##
                   add wcmoves.wcmov_vatam0 to fpa##
                   if (smodule='01') add wcmoves.wcmove_p0 to fnum##
                   else if (smodule='02') add wcmoves.wcmove_x0 to fnum##
                   add fnum## to pay##
                   set pqty## to qty##
                   set pekp## to ekp##
                   set pfpa## to fpa##
                   set ppay## to pay##
               end
               else begin
                  get pisubr18_3## to lisub##
                  add 1 to lisub##
                  set pisubr18_3## to lisub##
                  if (lisub## eq 1) begin
        
        
                    get pqty## to qty##
                    get pekp## to ekp##
                    get pfpa## to fpa##
                    get ppay## to pay##
                    print "" to bodyr18_3.1
                    print "" to bodyr18_3.2
                    move "Ñ° ãú´ò≠¶®·™" to bodyr18_3.3
                    print qty## to bodyr18_3.4
                    print 0     to bodyr18_3.5
                    print ekp## to bodyr18_3.6
                    print fpa## to bodyr18_3.7
                    print pay## to bodyr18_3.8
                    output_pagecheck
        
                 end
                 else
        
                    get pqty## to qty##
                    get pekp## to ekp##
                    get pfpa## to fpa##
                    get ppay## to pay##
                     print wcmoves.wcmove_hmnia to bodyr18_3.1
                     print wtypkin.wtypkin_descr to bodyr18_3.2
                     print wcmoves.wcmove_par to bodyr18_3.3
                     print wcmoves.wcmove_qty to bodyr18_3.4
                     print wcmoves.unit_price0 to bodyr18_3.5
                     print wcmoves.wcmov_discam0 to bodyr18_3.6
                     print wcmoves.wcmov_vatam0 to bodyr18_3.7
                     if (smodule='01') move wcmoves.wcmove_p0 to fnum##
                     else if (smodule='02') move wcmoves.wcmove_x0 to fnum##
                     print fnum##  to bodyr18_3.8
                     calc (wcmoves.wcmove_qty + qty##) to qty##
                     calc (wcmoves.wcmov_discam0 + ekp##) to ekp##
                     calc (wcmoves.wcmov_vatam0 + fpa##) to fpa##
                     if (smodule='01') add wcmoves.wcmove_p0 to fnum##
                     else if (smodule='02') add wcmoves.wcmove_x0 to fnum##
                     calc (fnum## + pay##) to pay##
                     output_pagecheck
                     set pqty## to qty##
                     set pekp## to ekp##
                     set pfpa## to fpa##
                     set ppay## to pay##
        
               end
        
           End_Procedure
        
           Procedure_Section  subtotal5 as subtotalr18_3a
               string integer lisub## epil##
               number qty## ekp## fpa## pay##
               get pisubr18_3## to lisub##
               get epilr18_3## to epil##
               if (lisub## eq 0) begin
        
                   get pqty## to qty##
                   get pekp## to ekp##
                   get pfpa## to fpa##
                   get ppay## to pay##
                   print qty## to SubtotalR18_3a.1
                   print ekp## to SubtotalR18_3a.2
                   print fpa## to SubtotalR18_3a.3
                   print pay## to SubtotalR18_3a.4
        
        
               end
               if (lisub## ne 0) begin
        
                   subtotal bodyr18_3.4 to SubtotalR18_3a.1
                   subtotal bodyr18_3.6 to SubtotalR18_3a.2
                   subtotal bodyr18_3.7 to SubtotalR18_3a.3
                   subtotal bodyr18_3.8 to SubtotalR18_3a.4
        
               end
               set pisubr18_3## to 0
               set pqty## to 0
               set pekp## to 0
               set pfpa## to 0
               set ppay## to 0
               output_pagecheck
           end_Procedure
        
           Procedure_Section  subtotal4 as subtotalr18_3
                  subtotal subtotalr18_3a.1 to SubtotalR18_3.1
                  subtotal subtotalr18_3a.2 to SubtotalR18_3.2
                  subtotal subtotalr18_3a.3 to SubtotalR18_3.3
                  subtotal subtotalr18_3a.4 to SubtotalR18_3.4
                  output_pagecheck
           end_Procedure
        
        
        
           Procedure_Section  subtotal3 as subtotalr18_33
           End_Procedure
        
           Procedure_Section  subtotal2 as subtotalr18_32
           End_Procedure
        
           Procedure_Section  subtotal1 as subtotalr18_31
           End_Procedure
        
        
        
           Procedure_Section  total as totalr18_3
                 subtotal SubtotalR18_3.1 to totalr18_3.1
                 subtotal SubtotalR18_3.2 to totalr18_3.2
                 subtotal SubtotalR18_3.3 to totalr18_3.3
                 subtotal SubtotalR18_3.4 to totalr18_3.4
                // print 'E'
                 output_pagecheck
           end_Procedure
        
           Procedure_Section Page_Bottom as Footerr18_3
           End_Procedure
        
           Procedure Ending_Report
               blankform subtotalr18_3a.1 thru subtotalr18_3a.4
               blankform subtotalr18_3.1 thru subtotalr18_3.4
               blankform totalr18_3.1    thru totalr18_3.4
           End_Procedure
        
        
        End_Object
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        //AB-StoreEnd

    End_Object    // r18_3b


    //AB-StoreStart
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
    //AB-StoreEnd

//AB/     End_Object    // prj
