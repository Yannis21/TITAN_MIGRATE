Compiling Program: L:\VDF6\Develop\Empor\AppSrc\#testjs.src
Memory Available: 2147483647
1>Use AllEntSc
Using pre-compiled package ALLENTSC
INCLUDING FILE: ALLENTSC.PKI
30333>
30333>Register_Object Client_Area
30333>
30333>//AB-StoreTopStart
30333>Use Workspc.pkg
30333>
30333>//  Set date attributes as needed
30333>Set_Date_Attribute sysdate4_State to (TRUE)
30334>Set_Date_Attribute Date4_State    to (TRUE)
30335>Set_Date_Attribute epoch_value    to 30
30336>
30336>Object ProgramWorkspace is a WorkspaceSub
30338>    Set WorkspaceName to CURRENT$WORKSPACE
30339>    Set kEnter_Next_State to True
30340>//    Set ModuleName    to 'ProgramName' // Special module name.
30340>//    Set HelpName      to 'HelpName.hlp'// Please provide the name of your Windows help file.
30340>End_Object
30341>
30341>Use Help_Ids.inc // Developer should provide this file of help context links.
INCLUDING FILE: HELP_IDS.INC
30341>>>// Help_ids.inc
30341>>>//
30341>>>// Context ids for the order entry system. This uses
30341>>>// help file ordentry.hlp.
30341>>>//
30341>>>// This is a sample version. YOU must supply
30341>>>// the ID values
30341>>>
30341>>>//  Generic Context Ids
30341>>>//
30341>>>
30341>>>// It is expected that file-names ids will be the same as their
30341>>>// filenumber.
30341>>>
30341>>>
30341>>>//  View and selection-list specific context ids
30341>>>//
30341>>>//..........add view, object, selection-list ids here....
30341>Use Std_Help.pkg
INCLUDING FILE: STD_HELP.PKG
30341>>>// STD_HELP.PKG
30341>>>//
30341>>>// Global Help Object
30341>>>//
30341>>>//  Creates all Help Support required to access WINDOWs help system
30341>>>//  with DataFlex. Creates a global object named Help_Object.
30341>>>//
30341>>>//  9/19/97 JJT - Modified to define stadnard help Ids if they are undefined
30341>>>
30341>>>use DFHlpSys // Context Sensitive Help Support
30341>>>
30341>>>
30341>>>// This file needs to be provided by the developer. It will contain
30341>>>// symbolic replacements for the ID integer values used to access the
30341>>>// the windows help file's topics.
30341>>>//
30341>>>use Help_ids.inc
30341>>>
30341>>>// If the following are not defined in help_ids.inc,
30341>>>//  create default 0 values for them
30341>>>Define GeneralHelpId    for    0
30341>>>Define KeysHelpId       for    0
30341>>>Define FileHelpId       for    0
30341>>>Define ErrorHelpId      for    0  // probably not used in VDF
30341>>>Define IndexHelpId      for    0  // probably not used in VDF
30341>>>
30341>>>object Help_Object is a HelpSystem // global help object
30343>>>
30343>>>   Set Help_Id_General to GeneralHelpId    // these should all be defined
30344>>>   Set Help_Id_Index   to IndexHelpId      // in help_ids.inc.
30345>>>   Set Help_Id_Keys    to KeysHelpId       //
30346>>>   Set Help_Id_Files   to FileHelpId       //
30347>>>   Set Help_Id_Errors  to ErrorHelpId      //
30348>>>
30348>>>end_object
30349>
30349>Use WinQlSQL.Sub
INCLUDING FILE: WINQLSQL.SUB
30349>>>Use CrystalReport.pkg
30349>>>
30349>>>Define PE_SUBREPORT_NAME_LEN       for 128
30349>>>
30349>>>Type PESubreportInfo
30349>>>  Field PESubreportInfo.structSize as Word
30349>>>  Field PESubreportInfo.name       as Char PE_SUBREPORT_NAME_LEN
30349>>>  Field PESubreportInfo.NLinks     as Short
30349>>>  Field PESubreportInfo.IsOnDemand as Short
30349>>>End_Type // PESubreportInfo
30349>>>
30349>>>
30349>>>External_Function PEGetNSections "PEGetNSections" CRPE32.DLL ;  Integer printJob ;  Returns Integer
30350>>>
30350>>>External_Function PEGetSectionCode "PEGetSectionCode" CRPE32.DLL ;  Integer printJob ;  Integer sectionN ;  Returns Integer
30351>>>
30351>>>External_Function PECloseSubreport "PECloseSubreport" CRPE32.DLL ;  Integer printJob ;  Returns Integer
30352>>>
30352>>>External_Function PEGetNSubreportsInSection "PEGetNSubreportsInSection" CRPE32.DLL ;  Integer printJob ;  Integer sectionCode ;  Returns Integer
30353>>>
30353>>>External_Function PEGetNthSubreportInSection "PEGetNthSubreportInSection" CRPE32.DLL ;  Integer printJob ;  Integer sectionCode ;  Integer subreportN ;  Returns Integer
30354>>>
30354>>>External_Function PEGetSubreportInfo "PEGetSubreportInfo" CRPE32.DLL ;  Integer printJob ;  Integer subreportHandle ;  Pointer subreportInfo ;  Returns Integer
30355>>>
30355>>>External_Function PEOpenSubreport "PEOpenSubreport" CRPE32.DLL ;  Integer parentJob ;  Pointer subreportName ;  Returns Integer
30356>>>
30356>>>
30356>>>Type PEWindowOptions
30356>>>  Field PEWindowOptions.StructSize As Word
30356>>>  Field PEWindowOptions.hasGroupTree As Word
30356>>>  Field PEWindowOptions.canDrillDown As Word
30356>>>  Field PEWindowOptions.hasNavigationControls As Word
30356>>>  Field PEWindowOptions.hasCancelButton As Word
30356>>>  Field PEWindowOptions.hasPrintButton As Word
30356>>>  Field PEWindowOptions.hasExportButton As Word
30356>>>  Field PEWindowOptions.hasZoomControl As Word
30356>>>  Field PEWindowOptions.hasCloseButton As Word
30356>>>  Field PEWindowOptions.hasProgressControls As Word
30356>>>  Field PEWindowOptions.hasSearchButton As Word
30356>>>  Field PEWindowOptions.hasPrintSetupButton As Word
30356>>>  Field PEWindowOptions.hasRefreshButton As Word
30356>>>End_Type // PEWindowOptions
30356>>>
30356>>>External_Function32 PESetWindowOptions "PESetWindowOptions" CRPE32.DLL ;  Integer printJob pointer Options Returns Integer
30357>>>
30357>>>Class CrystalReportSubSQL Is A CrystalReport
30358>>>
30358>>>    Procedure Construct_Object
30359>>>        Forward send Construct_Object
30361>>>        // Everything on except hasGroupTree by default
30361>>>        property integer hasGroupTree 0
30362>>>        property integer canDrillDown 1
30363>>>        property integer hasNavigationControls 1
30364>>>        property integer hasCancelButton 1
30365>>>        property integer hasPrintButton 1
30366>>>        property integer hasExportButton 1
30367>>>        property integer hasZoomControl 1
30368>>>        property integer hasCloseButton 1
30369>>>        property integer hasProgressControls 1
30370>>>        property integer hasSearchButton 1
30371>>>        property integer hasPrintSetupButton 1
30372>>>        property integer hasRefreshButton 1
30373>>>
30373>>>        Set WindowStyle To (WS_MAXIMIZE iOr WS_OVERLAPPEDWINDOW)
30374>>>    End_Procedure // Construct_Object
30375>>>
30375>>>    Procedure OutputToWindow String sTitle Integer iLeft Integer iTop Integer iWidth Integer iHeight Integer iStyle Handle hParent
30376>>>        Integer iPrintJob iResult
30377>>>        String sPEWindowOptions
30377>>>        Pointer pPeWindowOptions
30377>>>
30377>>>        Get PrintJob To iPrintJob
30378>>>        FillType PEWindowOptions with 0     to sPEWindowOptions
30379>>>        put PEWindowOptions_Size            to sPEWindowOptions at PEWindowOptions.StructSize
30380>>>        put (hasGroupTree(self))            to sPEWindowOptions at PEWindowOptions.hasGroupTree
30381>>>        put (canDrillDown(self))            to sPEWindowOptions at PEWindowOptions.canDrillDown
30382>>>        put (hasNavigationControls(self))   to sPEWindowOptions at PEWindowOptions.hasNavigationControls
30383>>>        put (hasCancelButton(self))         to sPEWindowOptions at PEWindowOptions.hasCancelButton
30384>>>        put (hasPrintButton(self))          to sPEWindowOptions at PEWindowOptions.hasPrintButton
30385>>>        put (hasExportButton(self))         to sPEWindowOptions at PEWindowOptions.hasExportButton
30386>>>        put (hasZoomControl(self))          to sPEWindowOptions at PEWindowOptions.hasZoomControl
30387>>>        put (hasCloseButton(self))          to sPEWindowOptions at PEWindowOptions.hasCloseButton
30388>>>        put (hasProgressControls(self))     to sPEWindowOptions at PEWindowOptions.hasProgressControls
30389>>>        put (hasSearchButton(self))         to sPEWindowOptions at PEWindowOptions.hasSearchButton
30390>>>        put (hasPrintSetupButton(self))     to sPEWindowOptions at PEWindowOptions.hasPrintSetupButton
30391>>>        put (hasRefreshButton(self))        to sPEWindowOptions at PEWindowOptions.hasrefreshButton
30392>>>        GetAddress of sPEWindowOptions      to pPEWindowOptions
30393>>>        Move (PESetWindowOptions(iPrintJob, pPEWindowOptions)) to iResult
30394>>>        Forward Send OutputToWindow sTitle iLeft iTop iWidth iHeight iStyle hParent
30396>>>    End_Procedure // OutputToWindow
30397>>>
30397>>>    Procedure Set TmpFileDir String aDir
30398>>>        String lsCurrWspc lsDir
30399>>>
30399>>>//        If (ghoWorkSpace <> 0) Begin
30399>>>//            Get WorkSpaceName of ghoWorkSpace to lsCurrWspc
30399>>>//            Insert "WorkSpaces\" in lsCurrWspc at 1
30399>>>//            Get_Profile_String lsCurrWspc aDir to lsDir
30399>>>//            Set Report_Data_Path to lsDir
30399>>>//        End
30399>>>    End_Procedure
30400>>>
30400>>>    Procedure DoWinQLReport
30401>>>        // This can be used when reports must be able to run in different data directories
30401>>>        Set TmpFileDir to "TmpFileDir"
30402>>>        Forward Send DoWinQLReport
30404>>>    End_Procedure
30405>>>
30405>>>
30405>>>  Function NSections Returns Integer
30406>>>    Integer iPrintJob iResult
30407>>>
30407>>>    Get PrintJob To iPrintJob
30408>>>    Move (PEGetNSections(iPrintJob)) To iResult
30409>>>    Move (Low(iResult)) To iResult
30410>>>    Function_Return iResult
30411>>>  End_Function // NSections
30412>>>
30412>>>  Function SectionCode Integer iSectionN Returns Integer
30413>>>    Integer iPrintJob iResult
30414>>>
30414>>>    Get PrintJob To iPrintJob
30415>>>    Move (PEGetSectionCode(iPrintJob,iSectionN)) To iResult
30416>>>    Move (Low(iResult)) To iResult
30417>>>    Function_Return iResult
30418>>>  End_Function // SectionCode
30419>>>
30419>>>  Function CloseSubreport Integer iSubreport Returns Integer
30420>>>    Integer iResult
30421>>>
30421>>>    Move (PECloseSubreport(iSubreport)) To iResult
30422>>>    Function_Return iResult
30423>>>  End_Function // CloseSubreport
30424>>>
30424>>>  Function NSubreportsInSection Integer iSectionCode Returns Integer
30425>>>    Integer iPrintJob iResult
30426>>>
30426>>>    Get PrintJob To iPrintJob
30427>>>    Move (PEGetNSubreportsInSection(iPrintJob,iSectionCode)) To iResult
30428>>>    Move (Low(iResult)) To iResult
30429>>>    Function_Return iResult
30430>>>  End_Function // nSubreportsInSection
30431>>>
30431>>>  Function NthSubreportInSection Integer iSectionCode Integer iSubreportN Returns Integer
30432>>>    Integer iPrintJob iResult
30433>>>
30433>>>    Get PrintJob To iPrintJob
30434>>>    Move (PEGetNthSubreportInSection(iPrintJob,iSectionCode,iSubreportN)) To iResult
30435>>>    Function_Return iResult
30436>>>  End_Function // NthSubreportInSection
30437>>>
30437>>>  Function SubreportName Integer iSubreportHandle Returns String
30438>>>    String sPESubreportInfo sResult
30439>>>    Pointer pPESubreportInfo
30439>>>    Integer iPrintJob iResult
30439>>>
30439>>>    ZeroType PESubreportInfo To sPESubreportInfo
30440>>>    Put PESubreportInfo_Size To sPESubreportInfo at PESubreportInfo.structSize
30441>>>    GetAddress Of sPESubreportInfo to pPESubreportInfo
30442>>>
30442>>>    Get PrintJob To iPrintJob
30443>>>    Move (PEGetsubreportInfo(iPrintJob,iSubreportHandle,pPESubreportInfo)) To iResult
30444>>>    If iResult GetBuff_String From sPESubreportInfo at PESubreportInfo.name To sResult
30447>>>    Function_Return (ToOEM(sResult))
30448>>>  End_Function // SubreportName
30449>>>
30449>>>  Function SubreportNLinks Integer iSubreportHandle Returns Integer
30450>>>    String sPESubreportInfo
30451>>>    Pointer pPESubreportInfo
30451>>>    Integer iPrintJob iResult
30451>>>
30451>>>    ZeroType PESubreportInfo To sPESubreportInfo
30452>>>    Put PESubreportInfo_Size To sPESubreportInfo at PESubreportInfo.structSize
30453>>>    GetAddress Of sPESubreportInfo to pPESubreportInfo
30454>>>
30454>>>    Get PrintJob To iPrintJob
30455>>>    Move (PEGetsubreportInfo(iPrintJob,iSubreportHandle,pPESubreportInfo)) To iResult
30456>>>    If iResult GetBuff From sPESubreportInfo at PESubreportInfo.NLinks To iResult
30459>>>    Function_Return iResult
30460>>>  End_Function // SubreportNLinks
30461>>>
30461>>>  Function SubreportIsOnDemand Integer iSubreportHandle Returns Integer
30462>>>    String sPESubreportInfo
30463>>>    Pointer pPESubreportInfo
30463>>>    Integer iPrintJob iResult
30463>>>
30463>>>    ZeroType PESubreportInfo To sPESubreportInfo
30464>>>    Put PESubreportInfo_Size To sPESubreportInfo at PESubreportInfo.structSize
30465>>>    GetAddress Of sPESubreportInfo to pPESubreportInfo
30466>>>
30466>>>    Get PrintJob To iPrintJob
30467>>>    Move (PEGetsubreportInfo(iPrintJob,iSubreportHandle,pPESubreportInfo)) To iResult
30468>>>    If iResult GetBuff From sPESubreportInfo at PESubreportInfo.IsOnDemand To iResult
30471>>>    Function_Return iResult
30472>>>  End_Function // SubreportIsOnDemand
30473>>>
30473>>>  Function OpenSubReport String sSubreport Returns Integer
30474>>>    Integer iPrintJob iResult
30475>>>    Pointer pSubreport
30475>>>
30475>>>    Get PrintJob To iPrintJob
30476>>>    GetAddress Of sSubreport To pSubreport
30477>>>    Move (PEOpenSubreport(iPrintJob,pSubreport)) To iResult
30478>>>    Move (Low(iResult)) To iResult
30479>>>    Function_Return iResult
30480>>>  End_Function // OpenSubReport
30481>>>
30481>>>  Function NTablesInSubreport Integer iSubreportHandle Returns Integer
30482>>>    Local Integer iResult
30483>>>
30483>>>    Move (PEGetNTables(iSubreportHandle)) To iResult
30484>>>    Move (Low(iResult)) To iResult
30485>>>    Function_Return iResult
30486>>>  End_Function // NTablesInSubreport
30487>>>
30487>>>  Function NthTableLocationInSubreport Integer iSubreportHandle Integer iTableN Returns String
30488>>>    Local String sPETableLocation sReturn
30489>>>    Local Pointer pPETableLocation
30489>>>    Local Integer iResult
30489>>>
30489>>>    FillType PETableLocation With 0 To sPETableLocation
30490>>>    Put PETableLocation_Size To sPETableLocation At PETableLocation.StructSize
30491>>>    GetAddress Of sPETableLocation To pPETableLocation
30492>>>    Move (PEGetNthTableLocation(iSubreportHandle,iTableN,pPETableLocation)) To iResult
30493>>>    If iResult GetBuff_String From sPETableLocation At PETableLocation.Location To sReturn
30496>>>    Function_Return (ToOEM(sReturn))
30497>>>  End_Function // NthTableLocationInSubreport
30498>>>
30498>>>  Procedure Set NthTableLocationInSubreport Integer iSubreportHandle Integer iTableN String sLocation
30499>>>    Local String sPETableLocation
30500>>>    Local Pointer pPETableLocation
30500>>>    Local Integer iResult
30500>>>
30500>>>    Move (ToANSI(sLocation+Character(0))) To sLocation
30501>>>    FillType PETableLocation With 0 To sPETableLocation
30502>>>    Put PETableLocation_Size To sPETableLocation At PETableLocation.StructSize
30503>>>    Put_String sLocation To sPETableLocation At PETableLocation.Location
30504>>>    GetAddress Of sPETableLocation To pPETableLocation
30505>>>    Move (PESetNthTableLocation(iSubreportHandle,iTableN,pPETableLocation)) To iResult
30506>>>  End_Procedure // Set NthTableLocationInSubreport
30507>>>
30507>>>
30507>>>    // This hook procedure is called after the print job has been opened.
30507>>>    Procedure OnInitializeReport
30508>>>    ////// SOS Na ginei xana OnInitializeReport ///////////
30508>>>
30508>>>        Integer iTables iMax iCount iType
30509>>>        String  sLocation sLocation2 sPath DirSep
30509>>>        String  sNewPath sNewLocation sDataPath sMyLocation
30509>>>
30509>>>        Integer lnSections lnSubreports lnTables iPrintJob iPath
30509>>>        Integer iSection iCode iSubreport iTable iNumPaths bExists
30509>>>        Handle hSubreport
30509>>>        String sTable sSubreport sTempFilePath
30509>>>        Boolean bCheckforTempfile bTemp
30509>>>
30509>>>        //Forward Send OnInitializeReport
30509>>>
30509>>>        Open Company
INCLUDING FILE: COMPANY.FD
30511>>>        Open Syscurxr
INCLUDING FILE: SYSCURXR.FD
30513>>>
30513>>>        Clear Company
30514>>>        Move SyscurXr.Company_Code to Company.Company_Code
30515>>>        Find Eq Company By Index.1
30516>>>>
30516>>>
30516>>>        If ((Found) And (Company.Company_C_CodeR='')) Procedure_Return
30519>>>        String  sActualSQL
30519>>>        String  sActualTemp
30519>>>        String  sOldSQL
30519>>>        String  sOldTemp
30519>>>        String  sServerName
30519>>>        String  sDatabaseName
30519>>>        String  sUserID
30519>>>
30519>>>        Move Company.Company_C_CodeR    to sServerName          // ODBC sto 1o pedio
30520>>>        Move Company.Company_C_CodER    to sActualSQL           // Database sto 2o pedio
30521>>>        Move Company.Company_C_CodER    to sDatabaseName        // Database sto 2o pedio
30522>>>
30522>>>        Move 'SMS'              to sOldSQL
30523>>>        Move 'C:\Dns_tmp\'      to sOldTemp
30524>>>
30524>>>
30524>>>        Move 'C:\Dns_tmp\'      to sActualTemp
30525>>>
30525>>>        Move (Trim(sActualSQL   )) to sActualSQL
30526>>>        Move (Trim(sActualTemp  )) to sActualTemp
30527>>>        Move (Trim(sOldSQL      )) to sOldSQL
30528>>>        Move (Trim(sOldTemp     )) to sOldTemp
30529>>>        Move (Trim(sServerName  )) to sServerName
30530>>>        Move (Trim(sDatabaseName)) to sDatabaseName
30531>>>        Move (Trim(sUserID      )) to sUserID
30532>>>
30532>>>        Move (Sysconf(SYSCONF_DIR_SEPARATOR)) To DirSep
30533>>>
30533>>>        Get NTables To iMax
30534>>>        Decrement iMax
30535>>>        Get Report_Data_Path                                    To sPath
30536>>>        If Not (Right(sPath,1)) Eq DirSep Move (sPath-DirSep)   To sPath
30539>>>        For iCount From 0 To iMax
30545>>>>
30545>>>            Get NthTableLocation iCount         To sLocation
30546>>>            Get Report_Base_File_Name sLocation To sLocation2
30547>>>            Get NthTableDBType           iCount to iType
30548>>>
30548>>>            // An einai type 1 topiko
30548>>>            //               2=SQL
30548>>>            If (iType=2) Begin
30550>>>                If (sLocation contains sOldSQL) Begin
30552>>>                    Move (Replace(sOldSQL,sLocation,sActualSQL))    to sLocation
30553>>>                    Set NthTableLocation iCount                     to (Trim(sLocation))
30554>>>                End
30554>>>>
30554>>>            End
30554>>>>
30554>>>            Else If (iType=1) Begin
30557>>>                If (sLocation contains sOldTemp) Begin
30559>>>                    Move (Replace(sOldTemp,sLocation,sActualTemp))  to sLocation
30560>>>                    Set NthTableLocation iCount                     to (Trim(sLocation))
30561>>>                End
30561>>>>
30561>>>            End
30561>>>>
30561>>>            Set nthTableLogOnServerName     iCount to sServerName     0
30562>>>            Set nthTableLogOnDataBaseName   iCount to sDatabaseName   0
30563>>>            Set nthTableLogOnUserID         iCount to sUserID         0 // 'sa'     0
30564>>>        Loop // For iCount From 0 To iMax
30565>>>>
30565>>>
30565>>>        // Set the location of the tables for the subreports
30565>>>        Get NSections To lnSections
30566>>>        For iSection From 0 To (lnSections-1)
30572>>>>
30572>>>            Get SectionCode iSection To iCode
30573>>>            Get NSubreportsInSection iCode To lnSubreports
30574>>>            For iSubreport From 0 To (lnSubreports-1)
30580>>>>
30580>>>                Get NthSubreportInSection iCode iSubreport To hSubreport
30581>>>                Get SubreportName hSubreport To sSubreport
30582>>>                Get OpenSubreport sSubreport To iPrintJob
30583>>>                Get NTablesInSubreport iPrintJob To lnTables
30584>>>                For iTable From 0 To (lnTables-1)
30590>>>>
30590>>>                    Get NthTableLocationInSubreport iPrintJob iTable To sTable
30591>>>                    If (sTable contains sOldSQL) Begin
30593>>>                            Move '' to sLocation
30594>>>                            Move (Replace(sOldSQL,sTable,sActualSQL)) to sLocation
30595>>>                            Set NthTableLocationInSubreport iPrintJob iTable To (Trim(sLocation))
30596>>>                            Set nthTableLogOnServerName     iTable to sServerName     0
30597>>>                            Set nthTableLogOnDataBaseName   iTable to sDatabaseName   0
30598>>>                            Set nthTableLogOnUserID         iTable to sUserID         0 // 'sa'     0
30599>>>                    End
30599>>>>
30599>>>                Loop // For iTable From 0 To nTables
30600>>>>
30600>>>            Loop // For iSubreport From 0 To nSubreports
30601>>>>
30601>>>        Loop // For iSection From 0 To (iSections-1)
30602>>>>
30602>>>
30602>>>    End_Procedure // OnInitializeReport
30603>>>
30603>>>
30603>>>    // This hook procedure is called just before a print job is closed.
30603>>>    Procedure OnDeInitializeReport
30604>>>        Forward Send OnDEInitializeReport
30606>>>    End_Procedure // OnDeInitializeReport
30607>>>
30607>>>    // This hook procedure is called just before a the print job is started.
30607>>>    Procedure OnStartPrinting
30608>>>        Forward Send OnStartPrinting
30610>>>    End_Procedure // OnStartPrinting
30611>>>
30611>>>    // This hook procedure is called just after a print job has finished.
30611>>>    Procedure OnStopPrinting
30612>>>        Forward Send OnStopPrinting
30614>>>    End_Procedure // OnStopPrinting
30615>>>End_Class // CrystalReportSubSQL
30616>>>
30616>Integer giWait_Obj
30616>
30616>// General Functions-Procedures and Variables
30616>Use Globals.Inc
INCLUDING FILE: GLOBALS.INC
30616>>>
30616>>>        String  gs_Selected_Company_Code
30616>>>        String  gs_Selected_Branch_Code
30616>>>        Integer gi_Selected_Year
30616>>>        String gs_Selected_Year_Recr
30616>>>        String  gs_Module_Code
30616>>>
30616>>>
30616>>>//Open Currency
30616>>>//Function CurrDigits Global String asCurr Returns Integer
30616>>>//    Integer liDecX
30616>>>//    Clear Currency
30616>>>//    move asCurr to Currency.Currency_C_Code
30616>>>//    Find Eq Currency By Index.1
30616>>>//    move Currency.Currency_Dec to liDecX
30616>>>//    Function_Return liDecX
30616>>>//End_Function // CurrDigits
30616>>>
30616>>>Open Nomisma
INCLUDING FILE: NOMISMA.FD
30618>>>Open SysCurXr
30620>>>
30620>>>Function fiDekadika_Nomismatos Global String asNomisma Returns Integer
30621>>>    Move (Trim(asNomisma)) to asNomisma
30622>>>    Clear Nomisma
30623>>>    If ( asNomisma<>'' ) Move asNomisma         to Nomisma.Nomisma_Code
30626>>>    Else                 Move SysCurXr.C_Code0  to Nomisma.Nomisma_Code
30628>>>    Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
30629>>>>
30629>>>    Function_Return Nomisma.Dekadika
30630>>>End_Function //
30631>>>
30631>>>Function fsgCode_W_Zeroes Global Integer aiCode Integer aiPlaces Returns String
30632>>>    String rVal
30633>>>    Integer iLength iInt
30633>>>    Move aiCode to rVal
30634>>>    Move (trim(rVal)) to rVal
30635>>>    For iInt From 1 to (aiPlaces-(Length(rVal)))
30641>>>>
30641>>>        Move (Insert('0',rVal,1)) to rVal
30642>>>    Loop
30643>>>>
30643>>>    Function_Return rVal
30644>>>End_Function
30645>>>
30645>>>Function fsgCode_n_Zeroes Global number aiCode Integer aiPlaces Returns String
30646>>>    String rVal
30647>>>    Integer iLength iInt ipos
30647>>>    Move aiCode to rVal
30648>>>    Move (trim(rVal)) to rVal
30649>>>    MOVE (aiPlaces-(Length(rVal))) to ipos
30650>>>    For iInt From 1 to ipos
30656>>>>
30656>>>        Move (Insert('0',rVal,1)) to rVal
30657>>>    Loop
30658>>>>
30658>>>    Function_Return rVal
30659>>>End_Function
30660>>>
30660>>>
30660>>>Open Year
INCLUDING FILE: YEAR.FD
30662>>>Procedure EnumDDsForRebuildConstrain for DataDictionary integer aiMsg integer ahId
30663>>>    Send aiMsg to Self
30664>>>End_Procedure
30665>>>
30665>>>Procedure DoRefindYear for baseclass Integer aiPanel Integer aiYearDD
30666>>>    Integer liChanged
30667>>>
30667>>>    If ((aiYearDD = 0) or (Main_File(aiYearDD)<>Year.File_Number)) ;        Procedure_Return (Message_Box("Invalid Year_DD","Developer's Warning",MB_OK,MB_ICONWARNING))
30670>>>    If (Not(Current_Record(aiYearDD))) Begin
30672>>>        Get Should_Save of aiPanel to liChanged
30673>>>        Send Clear to aiYearDD
30674>>>        Move gs_Selected_Company_Code to Year.Company_Code
30675>>>        Move gs_Selected_Branch_Code  to Year.Branch_Code
30676>>>        Move gi_Selected_Year         to Year.Year_Year
30677>>>        Send Find to aiYearDD Eq 1 //Year.Index.1 - company_code+ranch_code+year_year
30678>>>        If (Not(liChanged)) Set Changed_State of aiPanel to False
30681>>>    End
30681>>>>
30681>>>End_Procedure
30682>>>
30682>>>Procedure RebuildConstrainIfYearChanged for baseclass Integer aiPanel String asCurrentYearRecr Integer aiYearDDId
30683>>>    Integer liSrvr
30684>>>    String  lsCurrentYearRecr
30684>>>
30684>>>    If (asCurrentYearRecr <> gs_Selected_Year_Recr) Begin
30686>>>        Broadcast Send EnumDDsForRebuildConstrain to aiPanel msg_Rebuild_Constraints Self
30688>>>    End
30688>>>>
30688>>>    Send DoRefindYear aiPanel aiYearDDId //(Year_DD(Self))
30689>>>    Get Server of aiPanel to liSrvr
30690>>>    // Respects Default values
30690>>>    If (liSrvr) If (Not(Current_Record(liSrvr))) Send Request_Clear to aiPanel
30695>>>End_Procedure
30696>>>
30696>>>//                                       ’¦ View            Property «¦¬ View             ’¦ Year DDO «¦¬ View
30696>>>//                                                          Holds the current year rec0
30696>>>// ‰¢ã©ž : Send RbldConstrIfYearChanged (Gplan_Test(Self))  (psCurrentYearRecr(Self))     (Year_DD(Self))
30696>>>
30696>>>
30696>>>Function fiRefindYear Global Returns Integer
30697>>>    Clear Year
30698>>>    Move gs_Selected_Company_Code to Year.Company_Code
30699>>>    Move gs_Selected_Branch_Code  to Year.Branch_Code
30700>>>    Move gi_Selected_Year         to Year.Year_Year
30701>>>    Find eq Year by Index.1 //company_code+ranch_code+year_year
30702>>>>
30702>>>    Function_Return (Found = 0)
30703>>>End_Function //fiRefindYear
30704>>>
30704>>>Procedure DoRunApplication for Baseclass String sAppName
30705>>>    string sRuntime  lsStr
30706>>>
30706>>>    Append lsStr 'C:\Dns.bat ' sAppName
30708>>>    RunProgram Wait  lsStr
30709>>>
30709>>>//    get_profile_string "defaults" "VDFBinDir" to sRuntime
30709>>>//    append sRuntime "\dfrun " sAppName
30709>>>    Append sRuntime 'C:\Program Files\Accessories\WORDPAD.EXE ' sAppName
30711>>>    runprogram background sRuntime
30712>>>End_procedure // DoRunApplication
30713>>>
30713>>>// Run the Editor
30713>>>Procedure DoRunEditor for Baseclass String asFile
30714>>>    string sRunPath lsWspcName
30715>>>    Move (WorkspaceName(ProgramWorkspace(Self))) to lsWspcName
30716>>>    get_profile_string ("workspaces\"+lsWspcName) "programpath" to sRunPath
30719>>>    //append sRunPath "\Editor "  asFile //// js 15/03/2002 " " lsWspcName
30719>>>    Move (Replace('.',asFile,'')) to asFile
30720>>>    append sRunPath asFile //// js 15/03/2002 " " lsWspcName
30721>>>    send DoRunApplication sRunPath
30722>>>End_Procedure // DoRunEditor
30723>>>
30723>>>//--------------------------------------
30723>>>
30723>>>//start of global functions and procedures
30723>>>
30723>>>
30723>>>//®¨ž© £¦§¦ œå«˜  ˜§æ: ˜) gmoves.dd    :private.update_gmhnes_ghmnies
30723>>>Function gsfFind_Previous Global String lsCode;                                 String lsDelimiter;                                 Returns String
30724>>>         String  lsTemp_Code1 lsTemp_Code2
30725>>>         Integer liCounter
30725>>>
30725>>>         //1.˜­˜å¨œ©ž ¡œ¤é¤
30725>>>         Move (Trim(lsCode)) to lsCode                                  //§® 30.12.345
30726>>>
30726>>>         //2.˜¤« ©«¨¦­ã
30726>>>         For liCounter From 1 to (Length(lsCode))
30732>>>>
30732>>>             Move (Insert(;                           (Mid(lsCode,1,liCounter)),;                           lsTemp_Code1,;                           1;                         )) to lsTemp_Code1                             //§® 543.21.03
30733>>>         Loop
30734>>>>
30734>>>
30734>>>         //3.˜­˜å¨œ©ž ¡œ¤é¤ (›â¤ ®¨œ áœ«˜ , safety only)
30734>>>         Move (Trim(lsTemp_Code1)) to lsTemp_Code1
30735>>>
30735>>>         //4.§˜å¨¤à £æ¤¦ «¦ ›œ¥ æ £â¨¦ª «¦¬ ˜¤«å©«¨¦­¦¬, £œ«á «¦ §¨é«¦ delimiter
30735>>>         Move (Right(;                      lsTemp_Code1,;                      ((Length(lsTemp_Code1))-((Pos(lsDelimiter,lsTemp_Code1))));                    )) to lsTemp_Code1                                  // §® 21.03
30736>>>
30736>>>         //5.¥˜¤á ˜¤« ©«¨¦­ã «¦¬ ˜¤«å©«¨¦­¦¬
30736>>>         For liCounter from 1 to (Length(lsTemp_Code1))
30742>>>>
30742>>>             Move (Insert(;                           (Mid(lsTemp_Code1,1,liCounter)),;                           lsTemp_Code2,;                           1;                         )) to lsTemp_Code2                             //§® 30.12
30743>>>         Loop
30744>>>>
30744>>>
30744>>>         Function_Return (Trim(lsTemp_Code2))
30745>>>End_Function //gsffind_previous
30746>>>
30746>>>
30746>>>Function gifSystem_Check Returns Integer
30747>>>         Integer liF_Gtypkins liF_Garicls liF_Gmoves liF_Gplans liF_Gmhnes liF_Ghmnies
30748>>>         Integer liS_Gtypkins liS_Garicls liS_Gmoves liS_Gplans liS_Gmhnes liS_Ghmnies
30748>>>//       Clear Company
30748>>>//       Find Gt Company.Recnum
30748>>>//       While (Found = 1)
30748>>>//             Add Company.Company_NumGtypkin to liS_Gtypkins § Ÿ˜¤é© ©«¦ sysfile ¤˜ «˜ ¡˜¨˜«áà ˜¬«á
30748>>>//             Add Company.Company_NumGarticl to liS_Garticls
30748>>>//             Add Company.Company_NumGmoves  to liS_Gmoves
30748>>>//             //d Company.Company_NumGtypkin to liS_Gtypkins
30748>>>//             Add Company.Company_NumGplan   to liS_GPlans
30748>>>//             Add Company.Company_NumGmhnes  to liS_Gmhnes
30748>>>//             Add Company.Company_NumGhmnies to liS_Ghmnies
30748>>>//             Find Gt Company.Recnum
30748>>>//       Loop
30748>>>//
30748>>>//       Get_Attribute {attribute} [of {file-handle} ;
30748>>>//                        [{field-num} | {index-num} [{segment-num}]]] ;
30748>>>//                        To {variable}
30748>>>//
30748>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30748>>>//       Get_Attribute DF_FILE_RECORDS_USED of Garticl.File_Number to liF_Garticls
30748>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmoves.File_Number  to liF_Gmoves
30748>>>//       //t_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30748>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gplan.File_Number   to liF_Gplans
30748>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmhnes.File_Number  to liF_Gmhnes
30748>>>//       Get_Attribute DF_FILE_RECORDS_USED of Ghmnies.File_Number to liF_Ghmnies
30748>>>//
30748>>>
30748>>>//       //â¢œš®¦ª DF_FILE_MAX_RECORDS+ £œ records used
30748>>>
30748>>>//       //â¢œš®¦ª last rec0 = sysrec rec0
30748>>>
30748>>>    Function_Return 0
30749>>>End_Function //gifSystem_Check
30750>>>
30750>>>/////////////////////////////////////////////////////////////////
30750>>>//‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª, £œ ž ®à¨åª ›œ¡˜› ¡á  JS
30750>>>Function Sfi_All_Numbers Global Number anValue Integer aiLengthAkeraios Integer aiLengthDekadika Returns String
30751>>>
30751>>>    String  lsRetval lsValue lsAkeraios lsDekadika
30752>>>    Integer liInt liInteger iTimes iStart
30752>>>    Number  lnDecimals
30752>>>
30752>>>    Move (Integer(anValue))                                         to liInteger
30753>>>    Move (Round(AnValue-(Integer(anValue))*(10^aiLengthDekadika)))  to lnDecimals
30754>>>
30754>>>    Move liInteger              to lsAkeraios
30755>>>    Move lnDecimals             to lsDekadika
30756>>>    Move (Trim(lsAkeraios))     to lsAkeraios
30757>>>    Move (Trim(lsDekadika))     to lsDekadika
30758>>>
30758>>>    Move (Length(lsAkeraios)) to iStart
30759>>>    For iTimes From iStart to (aiLengthAkeraios-1)
30765>>>>
30765>>>        Insert "0" in lsAkeraios at 1
30767>>>    Loop
30768>>>>
30768>>>    Move (Trim(lsAkeraios)) to lsAkeraios
30769>>>
30769>>>    Move (Length(lsDekadika)) to iStart
30770>>>    For iTimes From iStart to (aiLengthDekadika-1)
30776>>>>
30776>>>        Move (Append(lsDekadika,"0")) to lsDekadika
30777>>>    Loop
30778>>>>
30778>>>    Move (Trim(lsDekadika)) to lsDekadika
30779>>>
30779>>>    If (aiLengthDekadika=0) Move '' to lsDekadika
30782>>>    Move '' to lsRetVal
30783>>>    Move (Pad((lsAkeraios-lsDekadika),(aiLengthAkeraios+aiLengthDekadika))) to lsRetval
30784>>>    Function_Return lsRetval
30785>>>End_Function //sfi_All_Numbers  ‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª
30786>>>              //                 £œ ž ®à¨åª ›œ¡˜› ¡á (JS)
30786>>>
30786>>>Open Codemast
30788>>>
30788>>>
30788>>>Function gsfCode_Mast Global String lsType String lsValue Returns String
30789>>>         Clear Codemast
30790>>>         Move lsType  to Codemast.Type
30791>>>         Move lsValue to Codemast.Code
30792>>>         Find Eq Codemast by Index.1 //type+code
30793>>>>
30793>>>         Function_Return Codemast.Description
30794>>>End_Function //code_mast
30795>>>
30795>>>
30795>>>Open Branch
INCLUDING FILE: BRANCH.FD
30797>>>Function fsgCode_With_Zeroes Global Integer aiCode    ;                                    Integer aiPlaces  ;                                    String asCompany  ;                                    String asBranch   ;                               Returns String
30798>>>    String rVal
30799>>>    Integer iInt
30799>>>    Clear Branch
30800>>>    Move asCompany  to Branch.Company_Code
30801>>>    Move asBranch   to Branch.Branch_Code
30802>>>    Find Eq Branch by Index.1
30803>>>>
30803>>>    If (Trim(Branch.Tomeas_Code)<>'') Move (Trim(Branch.Tomeas_Code)) to asBranch
30806>>>    Move (Trim(asCompany))  to asCompany
30807>>>    Move (Trim(asBranch))   to asBranch
30808>>>    If (Length(asCompany)=1) Insert '0' In asCompany At 1
30812>>>    If (Length(asBranch) =1) Insert '0' In asBranch  At 1
30816>>>    Move ''                                           to rVal
30817>>>    Move (Sfi_All_Numbers(aiCode,aiPlaces,0))         to rVal
30818>>>    Move (Append((asCompany+'.'+asBranch+'.'),rVal))  to rVal
30819>>>    Move (Trim(rVal))                                 to rVal
30820>>>    Function_Return rVal
30821>>>End_Function
30822>>>
30822>>>Function fsgStripCodeFromID Global String asID Returns Integer
30823>>>      Integer iLen iPos iInt
30824>>>      If (Trim(asID)='') Function_Return 0
30827>>>      Move (Trim  (asID)) to asID
30828>>>      Move (Length(asID)) to iLen
30829>>>      For iInt From 1     to iLen
30835>>>>
30835>>>          If (Mid(asID,1,iInt)='.') Move iInt to iPos
30838>>>      Loop
30839>>>>
30839>>>      Function_Return (Right(asID,(iLen-iPos)))
30840>>>End_Function
30841>>>
30841>>>Function fsCityDescr Global Integer aiCityID Returns String
30842>>>    String rVal
30843>>>    Open Cities
INCLUDING FILE: CITIES.FD
30845>>>    Clear Cities
30846>>>    Move aiCityID to Cities.City_ID
30847>>>    Find Eq Cities By Index.1
30848>>>>
30848>>>    If (Found=1) Move Cities.City_descr to rVal
30851>>>    Else         Move '' to rVal
30853>>>    Function_Return rVal
30854>>>End_Function
30855>>>
30855>>>Function fiTownIDFromCity Global Integer aiCityID Returns Integer
30856>>>    Open Cities
30858>>>    Clear Cities
30859>>>    Move aiCityID to Cities.City_ID
30860>>>    Find Eq Cities By Index.1
30861>>>>
30861>>>    Function_Return Cities.Town_ID
30862>>>End_Function
30863>>>
30863>>>Function fiCountryIDFromTown Global Integer aiTownID Returns Integer
30864>>>    Open Towns
INCLUDING FILE: TOWNS.FD
30866>>>    Clear Towns
30867>>>    Move aiTownID to Towns.Town_ID
30868>>>    Find Eq Towns By Index.1
30869>>>>
30869>>>    Function_Return Towns.Country_ID
30870>>>End_Function
30871>>>
30871>>>Function fsTownDescr Global Integer aiTownID Returns String
30872>>>    String rVal
30873>>>    Open Towns
30875>>>    Clear Towns
30876>>>    Move aiTownID to Towns.Town_ID
30877>>>    Find Eq Towns By Index.1
30878>>>>
30878>>>    If (Found=1) Move Towns.Town_descr to rVal
30881>>>    Else         Move '' to rVal
30883>>>    Function_Return rVal
30884>>>End_Function
30885>>>
30885>>>Function fsCountryDescr Global Integer aiCountryID Returns String
30886>>>    String rVal
30887>>>    Open Country
INCLUDING FILE: COUNTRY.FD
30889>>>    Clear Country
30890>>>    Move aiCountryID to Country.Country_ID
30891>>>    Find Eq Country By Index.1
30892>>>>
30892>>>    If (Found=1) Move Country.Country_descr to rVal
30895>>>    Else         Move '' to rVal
30897>>>    Function_Return rVal
30898>>>End_Function
30899>>>
30899>>>Function fsAreaDescr Global Integer aiAreaID Returns String
30900>>>    String rVal
30901>>>    Open Areas
INCLUDING FILE: AREAS.FD
30903>>>    Clear Areas
30904>>>    Move aiAreaID to Areas.Area_ID
30905>>>    Find Eq Areas By Index.1
30906>>>>
30906>>>    If (Found=1) Move Areas.Area_descr to rVal
30909>>>    Else         Move '' to rVal
30911>>>    Function_Return rVal
30912>>>End_Function
30913>>>
30913>>>Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
30914>>>    Local String rVal lsTmp lsOO lsLL
30915>>>    Local Number lnOO lnLL
30915>>>
30915>>>    Move '' to lsOO
30916>>>    Move '' to lsLL
30917>>>    Move '' to rVal
30918>>>
30918>>>    Move (Integer(anTime))                              to lnOO
30919>>>
30919>>>    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
30920>>>
30920>>>    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
30923>>>    Else         Move (String(lnOO))                    to lsOO
30925>>>    Move (Trim(lsOO))                                   to lsOO
30926>>>
30926>>>    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
30929>>>    Else         Move (String(lnLL))                    to lsLL
30931>>>    Move (Trim(lsLL))                                   to lsLL
30932>>>
30932>>>    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
30933>>>
30933>>>    Move (Trim(rVal)) to rVal
30934>>>
30934>>>    Function_Return rVal
30935>>>End_Function
30936>>>
30936>>>Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
30937>>>    Local Number rVal nOres nLepta
30938>>>    Move (Integer(aiMinutes/60))    to nOres
30939>>>    Move (    Mod(aiMinutes,60))    to nLepta
30940>>>    Move (nOres+(nLepta/100))       to rVal
30941>>>    Function_Return rVal
30942>>>End_Function
30943>>>
30943>>>Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
30944>>>    Local Integer rVal
30945>>>    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
30946>>>    Function_Return rVal
30947>>>End_Function
30948>>>
30948>>>Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;                                                                    Number anEndTime    ;                                                                    Returns Integer
30949>>>    Local Integer rVal iMinStart iMinEnd
30950>>>
30950>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30953>>>
30953>>>    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
30954>>>    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
30955>>>    Move (iMinEnd-iMinStart)                                                     to rVal
30956>>>    Function_Return rVal
30957>>>End_Function
30958>>>
30958>>>
30958>>>Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;                                                                Number anEndTime    ;                                                                Returns Number
30959>>>    Local Integer iTmp
30960>>>    Local Number  rVal
30960>>>
30960>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30963>>>
30963>>>    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
30964>>>    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
30965>>>    Function_Return rVal
30966>>>End_Function
30967>>>
30967>>>
30967>>>Open WitemCL
INCLUDING FILE: WITEMCL.FD
30969>>>Open WitemCld
INCLUDING FILE: WITEMCLD.FD
30971>>>Open WitemxT
INCLUDING FILE: WITEMXT.FD
30973>>>
30973>>>Function fnTeleytaiaTimhAgoras String asPromCode String asItemCode  ;                               Date   adHmnia    Number anQty       ;                               Returns Number
30974>>>  Integer iExodos
30975>>>  Number nPoso nPct
30975>>>  Move 0 to nPoso
30976>>>  Move 0 to nPct
30977>>>  Move 0 to iExodos
30978>>>
30978>>>  Move (Trim(asItemCode)) to asItemCode
30979>>>  Move (Trim(asPromCode)) to asPromCode
30980>>>
30980>>>  // 1.Anazhthsh sto arxeio Witemcld
30980>>>  Clear Witemcld
30981>>>  Move asItemCode to Witemcld.Item_Code
30982>>>  Move asPromCode to Witemcld.Client_Code
30983>>>  Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30984>>>>
30984>>>  While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;                       (Witemcld.Client_Code= asPromCode) And ;                       (iExodos=0))
30988>>>      If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
30990>>>          Move 1 to iExodos
30991>>>               If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
30994>>>          Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
30998>>>      End
30998>>>>
30998>>>      Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30999>>>>
30999>>>  Loop
31000>>>>
31000>>>  If (iExodos) Begin
31002>>>      If (nPoso) Function_Return nPoso
31005>>>      Else Function_Return nPct
31007>>>  End
31007>>>>
31007>>>
31007>>>  // 2.Anazhthsh sto arxeio Witemcl
31007>>>  Clear WitemCL
31008>>>  Move (Trim(asPromCode)) to WitemCL.Client_Code
31009>>>  Move (Trim(asItemCode)) to WitemCL.Item_Code
31010>>>  Find Eq WitemCL By Index.1
31011>>>>
31011>>>  If (Found=1) Function_Return WitemCL.Client_Price
31014>>>
31014>>>  Function_Return 0
31015>>>End_Function
31016>>>
31016>>>
31016>>>Open BtnOrdd
INCLUDING FILE: BTNORDD.FD
31018>>>
31018>>>Function fnTeleytaiaTimhPolhshs String asWitemxRecr String asClientID ;                                String asWitemxCode Date   adHmnia    ;                                String asItemCode   Number anQty      ;                                String asCNCode     Returns Number
31019>>>
31019>>>  Integer iExodos iCheckDeop
31020>>>  Number nPoso nPct
31020>>>
31020>>>  Move (Num_Arguments=7) to iCheckDeop
31021>>>
31021>>>  Move 0 to nPoso
31022>>>  Move 0 to nPct
31023>>>  Move 0 to iExodos
31024>>>
31024>>>  Move (Trim(asItemCode))                 to asItemCode
31025>>>  Move (Trim(asClientID))                 to asClientID
31026>>>  Move (Trim(asWitemxRecr))               to asWitemxRecr
31027>>>  Move (Trim(asWitemxCode))               to asWitemxCode
31028>>>  If (iCheckDeop) Move (Trim(asCNCode))   to asCNCode
31031>>>
31031>>>  // 1. Anazhthsh apo DEOP ef' oson yparxei kodikos ergou
31031>>>  If (iCheckDeop) Begin
31033>>>      Clear btnordd
31034>>>      Move asClientID   to btnordd.vclient_id
31035>>>      Move asCNCode     to btnordd.vcn_code
31036>>>      Move asWitemxCode to btnordd.vitem
31037>>>      Move 0            to btnordd.vactive
31038>>>      Move adHmnia      to btnordd.arxh_date
31039>>>      Find LE btnordd by index.4//client_id+cn_code+item+arxh_date
31040>>>>
31040>>>      If ((found=1) and (asWitemxCode=btnordd.vitem)    and (adHmnia>=btnordd.arxh_date) ;                    and (adHmnia<=btnordd.deop_date)    and (btnordd.vactive=0)          ;                    and (asCNCode=btnordd.vcn_code)) begin
31042>>>          move btnordd.vprice to nPoso
31043>>>          If (nPoso) Function_Return nPoso
31046>>>      End
31046>>>>
31046>>>  End
31046>>>>
31046>>>  // 19-03-2007 Tolhs na pernei times mono an brei apo deop
31046>>>  // 2.Anazhthsh sto arxeio Witemcld (Timokatalogos Pelath/Eidous)
31046>>> // Clear Witemcld
31046>>> // Move asItemCode to Witemcld.Item_Code
31046>>> // Move asClientID to Witemcld.Client_Code
31046>>> // Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
31046>>> // While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;
31046>>> //                      (Witemcld.Client_Code= asClientID) And ;
31046>>> //                      (iExodos=0))
31046>>> //     If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
31046>>> //         Move 1 to iExodos
31046>>> //              If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
31046>>> //         Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
31046>>> //     End
31046>>> //     Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
31046>>> // Loop
31046>>> // If (iExodos) Begin
31046>>> //     If (nPoso) Function_Return nPoso
31046>>> //     Else Function_Return nPct
31046>>> // End
31046>>>
31046>>>
31046>>>  // 3.Anazhthsh sto arxeio Witemxt (Timokatalogos Eidous)
31046>>>  //Clear Witemxt
31046>>>  //Move SysCurXr.Company_Code  to Witemxt.Company_Code
31046>>>  //Move SysCurXr.Branch_Code   to Witemxt.Branch_Code
31046>>>  //Move SysCurXr.Year_Year     to Witemxt.Year_Year
31046>>>  //Move asWitemxRecr           to Witemxt.Witemx_Recr
31046>>>  //Find Gt Witemxt By Index.1 // Witemxt:Index.1
31046>>>  //While ((Found=1) And (Witemxt.Company_Code = SysCurXr.Company_Code) And ;
31046>>>  //                     (Witemxt.Branch_Code  = SysCurXr.Branch_Code ) And ;
31046>>>  //                     (Witemxt.Year_Year    = SysCurXr.Year_Year   ) And ;
31046>>>  //                     (Witemxt.Witemx_Recr  = asWitemxRecr         ) And ;
31046>>>  //                     (iExodos=0))
31046>>>  //    If ((adHmnia>=Witemxt.Value_Date) And (anQty<=Witemxt.Qty)) Begin
31046>>>  //        Move 1 to iExodos
31046>>>  //             If (Witemxt.Axia0 <>0) Move  Witemxt.Axia0         to nPoso
31046>>>  //        Else If (Witemxt.PcDisc<>0) Move (Witemxt.PcDisc*(-1))  to nPct
31046>>>  //    End
31046>>>  //    Find Gt Witemxt By Index.1 // Witemxt:Index.1
31046>>>  //Loop
31046>>>  //If (iExodos) Begin
31046>>>  //    If (nPoso) Function_Return nPoso
31046>>>  //    Else Function_Return nPct
31046>>>  //End
31046>>>
31046>>>
31046>>>  // 4.Anazhthsh sto arxeio Witemcl (Teleytaia Timh Agoras)
31046>>>  //Clear WitemCL
31046>>>  //Move (Trim(asClientID)) to WitemCL.Client_Code
31046>>>  //Move (Trim(asItemCode)) to WitemCL.Item_Code
31046>>>  //Find Eq WitemCL By Index.1
31046>>>  //If (Found=1) Function_Return WitemCL.Client_Price
31046>>>
31046>>>  Function_Return 0
31047>>>End_Function
31048>>>
31048>>>Function fsStripTextFieldFromEnter Global String asStr Returns String
31049>>>    String sEnter
31050>>>    Move '' to sEnter
31051>>>    Move (Trim(asStr)) to asStr
31052>>>    Append sEnter (Character(13)) (Character(10))
31054>>>    Move (Replaces(sEnter,asStr,' ')) to asStr
31055>>>    Function_return (Trim(asStr))
31056>>>End_function
31057>>>
31057>>>
31057>>>//end   of global functions and procedures
31057>>>Use Wait.DG
INCLUDING FILE: WAIT.DG
31057>>>>>USE AllEntSc
31057>>>>>
31057>>>>>//AB-IgnoreEnd
31057>>>>>
31057>>>>>
31057>>>>>//AB-IgnoreEnd
31057>>>>>
31057>>>>>Object Wait is a ModalPanelSub
31059>>>>>
31059>>>>>    //AB-StoreTopStart
31059>>>>>
31059>>>>>    // How to Use It
31059>>>>>    // Get the maximum position of the bar
31059>>>>>    // Move (Bar_Maximum_position(Wait(self))) to iMax
31059>>>>>    //
31059>>>>>    // Set the maximum position of the bar
31059>>>>>    // Set Bar_Maximum_position of (Wait(self)) to iMax
31059>>>>>    //
31059>>>>>    // Start Bar Progress from beginning
31059>>>>>    // Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
31059>>>>>    //
31059>>>>>    // End Bar Progress
31059>>>>>    // Send Bar_Current_Position to (Wait(Self)) iMax iMax iMax False
31059>>>>>    //
31059>>>>>    // Update Bar Progress
31059>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax True OR
31059>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax False
31059>>>>>    // When you want the update to be done for every i (this is slower)
31059>>>>>    // Where i=Counter's current value, icounter=Counter's Max Value and iMax=Bar Max Position
31059>>>>>    //
31059>>>>>    // Display Buttons on the object
31059>>>>>    // Set Button_State of (Wait(Self)) to False/True
31059>>>>>    // If the Progress Bar gets initialized without buttons, it MUST be Deactivated
31059>>>>>    //
31059>>>>>    // Initialization of the Progress Bar
31059>>>>>    // Send Popup to (Wait(Self))
31059>>>>>    //
31059>>>>>    // Deactivation of the Progress Bar
31059>>>>>    // Send Deactivate to (Wait(Self))
31059>>>>>    //
31059>>>>>    // Message during the process
31059>>>>>    // Set Wait_Message of (Wait(Self)) to "Now Processing..."
31059>>>>>    //
31059>>>>>    // Extra Info for button "Info >>"
31059>>>>>    // Send Wait_Details to (Wait(Self)) sFile sDetail bInitData
31059>>>>>    // If sFile<>'' then reads the contents of the file
31059>>>>>    // Else Fills the Edit with the string of sDetail
31059>>>>>    // If bInitData is True then the edit object is cleared first else extra info is appended
31059>>>>>    //
31059>>>>>    // Remarks instead of Progress Bar
31059>>>>>    // Set Button_State of (Wait(Self))     to False
31059>>>>>    // Set BarVisibleState of (Wait(Self))  to 'Remarks' False
31059>>>>>    // Update During Process
31059>>>>>    // Send UpdateWait to (Wait(Self)) 'Remarks'
31059>>>>>
31059>>>>>    //AB-StoreTopEnd
31059>>>>>
31059>>>>>    Set Exit_Application_Local_State to FALSE
31060>>>>>    Set Modal_State to FALSE
31061>>>>>    Set Popup_State to TRUE
31062>>>>>    Set Border_Style to Border_Thick
31063>>>>>    Set Minimize_Icon to FALSE
31064>>>>>    Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
31065>>>>>    Set Size to 138 256
31066>>>>>
31066>>>>>    //AB-DDOStart
31066>>>>>
31066>>>>>
31066>>>>>    //AB-DDOEnd
31066>>>>>
31066>>>>>    Object WaitBar is a ProgressBarSub
31068>>>>>
31068>>>>>        //AB-StoreTopStart
31068>>>>>
31068>>>>>        //AB-StoreTopEnd
31068>>>>>
31068>>>>>        Set Size to 21 243
31069>>>>>        Set Location to 7 4
31070>>>>>
31070>>>>>        //AB-StoreStart
31070>>>>>        Send DoRegSize  self smTopRight
31071>>>>>        //AB-StoreEnd
31071>>>>>
31071>>>>>    End_Object
31072>>>>>
31072>>>>>    Object WaitText is a TextBoxSub
31074>>>>>
31074>>>>>        //AB-StoreTopStart
31074>>>>>
31074>>>>>        //AB-StoreTopEnd
31074>>>>>
31074>>>>>        Set Enabled_State to TRUE
31075>>>>>        Set Label to "Processing"
31076>>>>>        Set FontSize to 4 0
31077>>>>>        Set Size to 10 81
31078>>>>>        Set Location to 36 5
31079>>>>>
31079>>>>>        //AB-StoreStart
31079>>>>>
31079>>>>>        //AB-StoreEnd
31079>>>>>
31079>>>>>    End_Object
31080>>>>>
31080>>>>>    Object bnCancel is a ButtonSub
31082>>>>>
31082>>>>>        //AB-StoreTopStart
31082>>>>>
31082>>>>>        //AB-StoreTopEnd
31082>>>>>
31082>>>>>        Set Default_State to TRUE
31083>>>>>        Set Label to "OK"
31084>>>>>        Set Location to 34 143
31085>>>>>
31085>>>>>        //AB-StoreStart
31085>>>>>
31085>>>>>        Procedure OnClick
31087>>>>>             Send Deactivate to (Wait(Self))
31088>>>>>        End_Procedure
31089>>>>>
31089>>>>>        Send DoRegAlign self amTopRight
31090>>>>>        //AB-StoreEnd
31090>>>>>
31090>>>>>    End_Object
31091>>>>>
31091>>>>>    Object bnDetail is a ButtonSub
31093>>>>>
31093>>>>>        //AB-StoreTopStart
31093>>>>>
31093>>>>>        //AB-StoreTopEnd
31093>>>>>
31093>>>>>        Set Focus_Mode to Pointer_Only
31094>>>>>        Set Label to "Info >>"
31095>>>>>        Set Location to 34 197
31096>>>>>
31096>>>>>        //AB-StoreStart
31096>>>>>
31096>>>>>        Procedure OnClick
31098>>>>>            Delegate Send Show_Details False
31100>>>>>        End_Procedure
31101>>>>>
31101>>>>>        Send DoRegAlign self amTopRight
31102>>>>>        //AB-StoreEnd
31102>>>>>
31102>>>>>    End_Object
31103>>>>>
31103>>>>>    Object LineControlSub1 is a LineControlSub
31105>>>>>
31105>>>>>        //AB-StoreTopStart
31105>>>>>
31105>>>>>        //AB-StoreTopEnd
31105>>>>>
31105>>>>>        Set Size to 2 243
31106>>>>>        Set Location to 54 4
31107>>>>>
31107>>>>>        //AB-StoreStart
31107>>>>>
31107>>>>>        Send DoRegSize  self smTopRight
31108>>>>>        //AB-StoreEnd
31108>>>>>
31108>>>>>    End_Object
31109>>>>>
31109>>>>>    Object WaitEdit is a editSub
31111>>>>>
31111>>>>>        //AB-StoreTopStart
31111>>>>>
31111>>>>>        //AB-StoreTopEnd
31111>>>>>
31111>>>>>        Set Enabled_State to FALSE
31112>>>>>        Set Read_Only_State to TRUE
31113>>>>>        Set Size to 58 243
31114>>>>>        Set Location to 60 4
31115>>>>>        Set Color to clWhite
31116>>>>>
31116>>>>>        //AB-StoreStart
31116>>>>>
31116>>>>>        Send DoRegSize Self amBottomRight
31117>>>>>        Delegate Set Size to 66 256
31119>>>>>
31119>>>>>        //AB-StoreEnd
31119>>>>>
31119>>>>>    End_Object
31120>>>>>
31120>>>>>    Object oTxtAntiBar is a TextBoxSub
31122>>>>>        Set Enabled_State to TRUE
31123>>>>>        Set Visible_State to FALSE
31124>>>>>        Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
31125>>>>>        Set Justification_Mode to (jMode_Center IOR jMode_VCenter)
31126>>>>>        Set Auto_Size_State to FALSE
31127>>>>>        Set FontWeight to 600
31128>>>>>        Set FontSize to 4 0
31129>>>>>        Set Size to 10 209
31130>>>>>        Set Location to 10 4
31131>>>>>        Set TextColor to clNavy
31132>>>>>    End_Object
31133>>>>>
31133>>>>>
31133>>>>>    //AB-StoreStart
31133>>>>>    Property Integer piWaitSize  Public (Size(Self))
31135>>>>>    Property Integer piPrevSize  Public (Size(Self))
31137>>>>>    Property Integer piState     Public False
31139>>>>>
31139>>>>>    Set Locate_Mode to Center_On_Screen
31140>>>>>    Set Destroy_Object_State to True
31141>>>>>
31141>>>>>    Procedure Show_Details Integer bAlways
31143>>>>>        Local Integer liOriSize liSize hiSize hiOriSize lowSize bState
31144>>>>>        Local String sLabel
31144>>>>>        Get Size                to liSize
31145>>>>>        Get piState             to bState
31146>>>>>        Get piWaitSize          to liOriSize
31147>>>>>        Move (Hi(liSize))       to hiSize
31148>>>>>        Move (Low(liSize))      to lowSize
31149>>>>>        Move (Hi(liOriSize))    to hiOriSize
31150>>>>>        If (bAlways) Begin
31152>>>>>            Set piState         to False
31153>>>>>            Move 0              to bState
31154>>>>>        End
31154>>>>>>
31154>>>>>        If bState Begin
31156>>>>>             Set Size to hiOriSize lowSize
31157>>>>>             Set Label of (bnDetail(Self)) to "Info >>"
31158>>>>>        End
31158>>>>>>
31158>>>>>        Else Begin
31159>>>>>             Set Size to 138 lowSize
31160>>>>>             Set Label of (bnDetail(Self)) to "<< Info"
31161>>>>>        End
31161>>>>>>
31161>>>>>        Set piState to (1-bState)
31162>>>>>    End_Procedure
31163>>>>>
31163>>>>>    Procedure Bar_Current_Position Integer iCount Integer iOccurances Integer iMaximum Integer bState
31165>>>>>       If (bState) Begin
31167>>>>>         If (Mod(iCount,(iCount*((Number(iMaximum))/(Number(iOccurances)))))=0) ;            Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
31170>>>>>       End
31170>>>>>>
31170>>>>>       Else Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
31172>>>>>    End_Procedure
31173>>>>>
31173>>>>>    Procedure DoInitialize_WaitBar
31175>>>>>        Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
31176>>>>>    End_Procedure
31177>>>>>
31177>>>>>    Procedure DoTerminate_WaitBar
31179>>>>>        Local Integer iMax
31180>>>>>        Get Maximum_position of (WaitBar(Self)) to iMax
31181>>>>>        Send Bar_Current_Position to (Wait(Self)) iMax iMax Imax False
31182>>>>>    End_Procedure
31183>>>>>
31183>>>>>    Procedure Set Bar_Maximum_Position Integer iMaximum
31185>>>>>         Set Maximum_position of (WaitBar(Self)) to iMaximum
31186>>>>>    End_Procedure
31187>>>>>
31187>>>>>    Function Bar_Maximum_Position Returns Integer
31189>>>>>        Function_Return (Maximum_position(WaitBar(Self)))
31190>>>>>    End_Function
31191>>>>>
31191>>>>>    Procedure Set Bar_Minimum_Position Integer iMinimum
31193>>>>>         Set Minimum_position of (WaitBar(Self)) to iMinimum
31194>>>>>    End_Procedure
31195>>>>>
31195>>>>>    Function Bar_Minimum_Position Returns Integer
31197>>>>>        Function_Return (Minimum_position(WaitBar(Self)))
31198>>>>>    End_Function
31199>>>>>
31199>>>>>    Procedure Set Bar_Step_Value Integer iStep
31201>>>>>         Set Step_Value of (WaitBar(Self)) to iStep
31202>>>>>    End_Procedure
31203>>>>>
31203>>>>>    Function Bar_Step_Value Returns Integer
31205>>>>>        Function_Return (Step_Value(WaitBar(Self)))
31206>>>>>    End_Function
31207>>>>>
31207>>>>>    Procedure Set Wait_Message String sMessage
31209>>>>>        Set Value of (WaitText(Self)) to sMessage
31210>>>>>    End_Procedure
31211>>>>>
31211>>>>>    Procedure Wait_Details String sFile String sDetail Integer bInitData
31213>>>>>        Local Integer liEditId
31214>>>>>        Move (WaitEdit(Self)) to liEditId
31215>>>>>        If bInitData Send Delete_Data to liEditId
31218>>>>>        If sFile ne "" Begin
31220>>>>>           Send Read to liEditId sFile
31221>>>>>           Send Beginning_Of_Data to liEditId
31222>>>>>        End
31222>>>>>>
31222>>>>>        Else Begin
31223>>>>>           Send Insert to liEditId sDetail
31224>>>>>        End
31224>>>>>>
31224>>>>>    End_Procedure
31225>>>>>
31225>>>>>    Procedure OnResize
31227>>>>>        Local Integer liSize liHiSize liPrevSize liHiPrevSize bState liHiLoc liLoc
31228>>>>>        Get Size to liPrevSize
31229>>>>>        Move (Hi(liPrevSize)) to liHiPrevSize
31230>>>>>        Forward Send OnResize
31232>>>>>        Get Location of (WaitEdit(Self)) to liLoc
31233>>>>>        Move (Hi(liLoc)) to liHiLoc
31234>>>>>        Get piState to bState
31235>>>>>        Get Size to liSize
31236>>>>>        Move (Hi(liSize)) to liHiSize
31237>>>>>        If (liHiSize > (liHiLoc +30)) Begin
31239>>>>>            Set Value of (bnDetail(Self)) to "<< Info"
31240>>>>>            If (liHiPrevSize <= (liHiLoc +30)) Set piState to (1-bState)
31243>>>>>        End
31243>>>>>>
31243>>>>>        Else Begin
31244>>>>>            Set Value of (bnDetail(Self)) to "Info >>"
31245>>>>>            If (liHiPrevSize > (liHiLoc +30)) Set piState to (1-bState)
31248>>>>>        End
31248>>>>>>
31248>>>>>    End_Procedure
31249>>>>>
31249>>>>>    Procedure Set Button_State Integer bState
31251>>>>>        If bState Begin
31253>>>>>            Set Caption_Bar to True
31254>>>>>            Set Size to 66 256
31255>>>>>        End
31255>>>>>>
31255>>>>>        Else Begin
31256>>>>>            Set Caption_Bar to False
31257>>>>>            Set Size to 38 256
31258>>>>>        End
31258>>>>>>
31258>>>>>    End_Procedure
31259>>>>>
31259>>>>>    Procedure Set BarVisibleState String sMsg Integer bState
31261>>>>>        Set Visible_State of (oTxtAntiBar(Self)) to (bState = 0)
31262>>>>>        Set Visible_State of (WaitBar(Self))     to (bState = 1)
31263>>>>>        If (bState = 0) Begin
31265>>>>>            Set Size to 24 256
31266>>>>>            Set Location of (oTxtAntiBar(Self)) to 6 5
31267>>>>>        End
31267>>>>>>
31267>>>>>        If sMsg ne "" Set Value of (oTxtAntiBar(Self)) to sMsg
31270>>>>>    End_Procedure
31271>>>>>
31271>>>>>    Procedure Deactivating integer search_mode Returns Integer
31273>>>>>        local integer rval
31274>>>>>        Forward Get MSG_Deactivating search_mode to rval
31276>>>>>        Set Modal_State of (Wait(Self)) to False
31277>>>>>        Set BarVisibleState of (Wait(Self)) to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..." True
31278>>>>>        Procedure_Return rval
31279>>>>>    End_Procedure
31280>>>>>
31280>>>>>    Procedure UpdateWait String sMsg
31282>>>>>        Set Value of (oTxtAntiBar(Self)) to sMsg
31283>>>>>    End_Procedure
31284>>>>>
31284>>>>>
31284>>>>>    Procedure Set Horizontal_Justification Integer aiMode
31286>>>>>        Set Justification_Mode of oTxtAntiBar to (jMode_VCenter IOR aiMode)
31287>>>>>    End_Procedure
31288>>>>>
31288>>>>>
31288>>>>>
31288>>>>>
31288>>>>>
31288>>>>>
31288>>>>>    //AB-StoreEnd
31288>>>>>
31288>>>>>End_Object
31289>>>>>
31289>>>>>
31289>>>>>//AB-StoreStart
31289>>>>>
31289>>>>>//AB-StoreEnd
31289>>>>>
31289>>>>>//AB/ End_Object    // prj
31289>>>
31289>Use Calendar.sl
INCLUDING FILE: CALENDAR.SL
31289>>>//AB/ Project Calendar
31289>>>//AB/ Object prj is a Lookup_Project
31289>>>//AB/     Set ProjectName to "Calendar"
31289>>>//AB/     Set ProjectFileName to "Calendar.sl"
31289>>>
31289>>>// Project Object Structure
31289>>>//   oCalendar is a dbModalPanel
31289>>>//     Container3d1 is a Container3d
31289>>>//       Grid2 is a Grid
31289>>>//       Textbox2 is a Textbox
31289>>>//       Textbox3 is a Textbox
31289>>>//       Textbox4 is a Textbox
31289>>>//       Textbox5 is a Textbox
31289>>>//       Textbox6 is a Textbox
31289>>>//       Textbox7 is a Textbox
31289>>>//       Textbox8 is a Textbox
31289>>>//       LineControl1 is a LineControl
31289>>>//       Container3d2 is a Container3d
31289>>>//         oRght is a BitmapContainer
31289>>>//         oLeft is a BitmapContainer
31289>>>//         oMonth is a Textbox
31289>>>//           oSelectMonth is a FloatingPopupMenu
31289>>>//         oYear is a Textbox
31289>>>//         oSelectYear is a Form
31289>>>//     BitmapContainer3 is a BitmapContainer
31289>>>//     oToday is a Textbox
31289>>>
31289>>>// Register all objects
31289>>>Register_Object BitmapContainer3
31289>>>Register_Object Container3d1
31289>>>Register_Object Container3d2
31289>>>Register_Object Grid2
31289>>>Register_Object LineControl1
31289>>>Register_Object oCalendar
31289>>>Register_Object oLeft
31289>>>Register_Object oMonth
31289>>>Register_Object oRght
31289>>>Register_Object oSelectMonth
31289>>>Register_Object oSelectYear
31289>>>Register_Object oToday
31289>>>Register_Object oYear
31289>>>Register_Object Textbox2
31289>>>Register_Object Textbox3
31289>>>Register_Object Textbox4
31289>>>Register_Object Textbox5
31289>>>Register_Object Textbox6
31289>>>Register_Object Textbox7
31289>>>Register_Object Textbox8
31289>>>
31289>>>
31289>>>
31289>>>//AB-StoreTopStart
31289>>>Use dates.utl
INCLUDING FILE: DATES.UTL
31289>>>>>// **********************************************************************
31289>>>>>// Use Dates.utl    // Date manipulation for VDF and DF3.1
31289>>>>>//
31289>>>>>// by Sture Andersen (sa1@vd.dk)
31289>>>>>//
31289>>>>>// The file contains a number of global functions for manipulating
31289>>>>>// dates. The package may be used with DataFlex 3.1 and Visual DataFlex.
31289>>>>>// This package is public domain.
31289>>>>>//
31289>>>>>// The package file is accompanied by a Word document (dfutil.doc)
31289>>>>>// listing the functions and their use.
31289>>>>>//
31289>>>>>//
31289>>>>>// Create: Fri  06-06-1997 - Merger of s_utl020, 021, 022, 023, 024, 025.
31289>>>>>// Update: Thu  26-06-1997 - Fixes for strange behavior when date4_state is set.
31289>>>>>//                         - Addition of popup_calendar to VDF.
31289>>>>>//         Sun  29-06-1997 - Character mode popup calender.
31289>>>>>//         Fri  04-07-1997 - Function WeekToDate added.
31289>>>>>//         Thu  10-07-1997 - Fixes.
31289>>>>>//         Mon  11-08-1997 - WeekToDate fixed.
31289>>>>>//         Sun  24-08-1997 - Character mode popup calender finished.
31289>>>>>//         Mon  15-12-1997 - Procedure Request_Popup_Calendar added.
31289>>>>>//         Mon  29-12-1997 - Procedures ItemYear2to4, ItemDate2to4 and
31289>>>>>//                           ItemSysdate added.
31289>>>>>//         Mon  29-12-1997 - Procedures FieldYear2to4, FieldDate2to4 and
31289>>>>>//                           FieldSysdate added.
31289>>>>>//         Sun  01-02-1998 - Functions Module_Compile_Date and
31289>>>>>//                           Module_Compile_Time added.
31289>>>>>//         Wed  25-02-1998 - Request_Popup in calendar object now only
31289>>>>>//                           responds if entry_state of the calling object
31289>>>>>//                           is true (VDF version). (No apparent effect)
31289>>>>>//         Sat  28-03-1998 - Added the following functions:
31289>>>>>//                             TS_SysTime      TS_ExtractDate
31289>>>>>//                             TS_ExtractTime  TS_ConvertToString
31289>>>>>//         Tue  26-05-1998 - Procedure TS_UI_Update added
31289>>>>>//         Sat  01-08-1998 - mask_date_window taken into account
31289>>>>>//         Mon  10-08-1998 - Functions Module_Start_Date and
31289>>>>>//                           Module_Start_Time added.
31289>>>>>//         Wed  02-09-1998 - Parameter for Module_Start_Date removed
31289>>>>>//         Mon  12-10-1998 - Portuguese added
31289>>>>>//         Wed  04-11-1998 - TS_TimeEstimator class added
31289>>>>>//         Tue  29-12-1998 - Function DateAsString added
31289>>>>>//         Wed  13-01-1999 - Function DateWeekNumber changed according to
31289>>>>>//                           Kjetil Johanson
31289>>>>>//         Mon  18-01-1999 - Function DateWeekNumber changed according to
31289>>>>>//                           Kjetil Johanson (again)
31289>>>>>//         Tue  19-01-1999 - Changed procedure names in TS_TimeEstimator
31289>>>>>//                           class (Continue->TS_Continue and Pause->
31289>>>>>//                           TS_Pause)
31289>>>>>//         Thu  21-01-1999 - Procedures DateFormatAsString and DateFormatName
31289>>>>>//                           added.
31289>>>>>//                         - Procedures DateCurrentSeparator and
31289>>>>>//                           DateCurrentFormat added.
31289>>>>>//         Tue  13-04-1999 - Julian constants added: Jan1st1900, Jan1st2000
31289>>>>>//                           Jan1st1000 and Jan1st100
31289>>>>>//         Mon  26-04-1999 - Changed procedure FieldYear2to4 and ItemYear2to4
31289>>>>>//                           to trap 3 digit years.
31289>>>>>//         Wed  27-04-1999 - Changed Dutch abbriviated day names (to 2 characters)
31289>>>>>//         Sun  02-05-1999 - Added function TS_Compose2
31289>>>>>//                         - Fixed error in TS_ConvertToString
31289>>>>>//         Tue  01-06-1999 - Added procedure popup_no_export to calendar.
31289>>>>>//         Thu  15-06-1999 - Fixed Date4to2 function and exporting dates
31289>>>>>//                           from the calendar to forms with no form_margin.
31289>>>>>//         Tue  07-09-1999 - Added function DateAsText
31289>>>>>//         Wed  27-10-1999 - Temporary fix for Module_Compile_Date function
31289>>>>>//                           in combination with y2k.
31289>>>>>//         Wed  19-12-1999 - Function StringToDate added.
31289>>>>>//                         - Existing function DateAsString renamed to
31289>>>>>//                           DateToString.
31289>>>>>//         Mon  03-01-2000 - Fix for VDF4. Popup calendar on empty date field
31289>>>>>//                           would result in seeding the calendar on year 100.
31289>>>>>//                           This error was caused by the fact that VDF 4
31289>>>>>//                           ignores SYSDATE4_STATE such that the sysdate
31289>>>>>//                           command returns 03-01-100
31289>>>>>//         Wed  01-02-2000 - Define instead of #REPLACE
31289>>>>>//         Wed  23-08-2000 - Function TS_Module_Compile_Time added
31289>>>>>//
31289>>>>>// NOTE:  There is language dependent string constants in this file.
31289>>>>>//        Currently there are sections for dutch, english, danish, swedish,
31289>>>>>//        norwegian, spanish, german and portuguese
31289>>>>>//
31289>>>>>//        These sections may be identified by searching the symbol LNG_DEFAULT
31289>>>>>//
31289>>>>>// ***********************************************************************
31289>>>>>
31289>>>>>Use ui
31289>>>>>Use Language    // Set default languange if not set by compiler command line
INCLUDING FILE: LANGUAGE.PKG
31289>>>>>>>// Use Language     // Default language setup
31289>>>>>>>// Sets default languange if not set by compiler command line
31289>>>>>>>
31289>>>>>>>define lng_dutch      for 131
31289>>>>>>>define lng_french     for 133 // NOT TRANSLATED. DO NOT SELECT!
31289>>>>>>>define lng_spanish    for 134
31289>>>>>>>define lng_italian    for 139 // NOT TRANSLATED. DO NOT SELECT!
31289>>>>>>>define lng_english    for 144
31289>>>>>>>define lng_danish     for 145
31289>>>>>>>define lng_swedish    for 146
31289>>>>>>>define lng_norwegian  for 147
31289>>>>>>>define lng_Greek    for 148
31289>>>>>>>define lng_german     for 149
31289>>>>>>>define lng_portuguese for 155
31289>>>>>>>define lng_papiamentu for 199 // NOT TRANSLATED. DO NOT SELECT!
31289>>>>>>>
31289>>>>>>>
31289>>>>>>>define lng_default for !@
31289>>>>>>>
31289>>>>>>>  define _LANGUAGE_ for $ENGLISH$
31289>>>>>>>
#REM LANGUAGE SET BY LANGUAGE.PKG: $ENGLISH$
31289>>>>>Use Seq_Chnl    // Defines global sequential device management operations (DAC)
31289>>>>>Use Macros.utl  // Various macros (DESKTOP_SECTION)
INCLUDING FILE: MACROS.UTL
31289>>>>>>>// Use Macros.utl   // Various macros (FOR_EX...)
31289>>>>>>>
31289>>>>>>>//  FOR_EX (extended FOR command)
31289>>>>>>>//  -----------------------------
31289>>>>>>>//> The FOR_EX command is exactly like the standard FOR command except
31289>>>>>>>//> that it will allow you to use keyword "DOWN_TO" instead of "TO" if
31289>>>>>>>//> you need to do a decremental loop.
31289>>>>>>>
31289>>>>>>>
31289>>>>>>>//  DESKTOP_SECTION
31289>>>>>>>//  ---------------
31289>>>>>>>//> The DESKTOP_SECTION/END_DESKTOP_SECTION commands will make a sequence of
31289>>>>>>>//> code compile (or rather instantiate) as if it was situated on the DESKTOP
31289>>>>>>>//> even when it isn't. DESKTOP_SECTION's may not be nested.
31289>>>>>>>
31289>>>>>>>
31289>>>>>>>
31289>>>>>
31289>>>>>// Switches
31289>>>>>
31289>>>>>define DATES_INCLUDE_POPUP for 1   // If set to 0 the popup calendar will not be included
31289>>>>>define DATES_DF31B_EPOCH   for 40  // DF3.1b didn't have an epoch setting. Therefore this symbol defines the epoch value for that version.
31289>>>>>
31289>>>>> define t.calendar.year           for "Year"
31289>>>>> define t.calendar.month          for "Month"
31289>>>>> define t.calendar.day            for "Day"
31289>>>>> define t.calendar.week           for "Wk."
31289>>>>> define t.calendar.calendar_popup for "Calendar Popup"
31289>>>>> define t.calendar.Monday         for "Monday"
31289>>>>> define t.calendar.Tuesday        for "Tuesday"
31289>>>>> define t.calendar.Wednesday      for "Wednesday"
31289>>>>> define t.calendar.Thursday       for "Thursday"
31289>>>>> define t.calendar.Friday         for "Friday"
31289>>>>> define t.calendar.Saturday       for "Saturday"
31289>>>>> define t.calendar.Sunday         for "Sunday"
31289>>>>> define t.calendar.January        for "January"
31289>>>>> define t.calendar.February       for "February"
31289>>>>> define t.calendar.March          for "March"
31289>>>>> define t.calendar.April          for "April"
31289>>>>> define t.calendar.May            for "May"
31289>>>>> define t.calendar.June           for "June"
31289>>>>> define t.calendar.July           for "July"
31289>>>>> define t.calendar.August         for "August"
31289>>>>> define t.calendar.September      for "September"
31289>>>>> define t.calendar.October        for "October"
31289>>>>> define t.calendar.November       for "November"
31289>>>>> define t.calendar.December       for "December"
31289>>>>> define t.calendar.ok             for "OK"
31289>>>>> define t.calendar.Cancel         for "Cancel"
31289>>>>> define t.calendar.Activate       for "Activate popup calendar (Ctrl+D)"
31289>>>>>
31289>>>>>define LargestPossibleDate for 913490 // December 31st 2500
31289>>>>>define Jan1st1900          for 693975
31289>>>>>define Jan1st2000          for 730500
31289>>>>>define Jan1st1000          for 365250
31289>>>>>define Jan1st105           for 38352
31289>>>>>define Jan1st100           for 36525
31289>>>>>
31289>>>>>enumeration_list // Date Segments
31289>>>>>  define DS_DAY
31289>>>>>  define DS_WEEK
31289>>>>>  define DS_MONTH
31289>>>>>  define DS_YEAR
31289>>>>>end_enumeration_list
31289>>>>>
31289>>>>>integer Dates$Year Dates$Month Dates$Day // internal use
31289>>>>>
31289>>>>>procedure DateDecompose global date date# //very internal!!
31290>>>>>  local integer pos1# pos2# format#
31291>>>>>  local string str# sep#
31291>>>>>  get_attribute DF_DATE_FORMAT to format#
31294>>>>>  get_attribute DF_DATE_SEPARATOR to pos1# // overload
31297>>>>>  character pos1# to sep#                  // end overload
31298>>>>>>
31298>>>>>  move date# to str#
31299>>>>>  replace sep# in str# with "$"
31301>>>>>  move strmark to pos1#
31302>>>>>  if [found] begin
31304>>>>>    replace sep# in str# with "$"
31306>>>>>    move strmark to pos2#
31307>>>>>  end
31307>>>>>>
31307>>>>>  else begin
31308>>>>>    move 0 to Dates$Year
31309>>>>>    move 0 to Dates$Month
31310>>>>>    move 0 to Dates$Day
31311>>>>>  end
31311>>>>>>
31311>>>>>  [ found] begin
31313>>>>>>
31313>>>>>    if format# eq DF_DATE_EUROPEAN ;          left str# to Dates$Day    (pos1#-1)
31317>>>>>    if format# eq DF_DATE_USA begin
31319>>>>>          mid  str# to Dates$Day    (pos2#-pos1#-1) (pos1#+1)
31322>>>>>>
31322>>>>>          left str# to Dates$Month  (pos1#-1)
31324>>>>>>
31324>>>>>    end
31324>>>>>>
31324>>>>>    else  mid  str# to Dates$Month  (pos2#-pos1#-1) (pos1#+1)
31328>>>>>
31328>>>>>    if format# eq DF_DATE_MILITARY begin
31330>>>>>          mid  str# to Dates$Day  2 (pos2#+1)
31333>>>>>>
31333>>>>>          left str# to Dates$Year   (pos1#-1)
31335>>>>>>
31335>>>>>    end
31335>>>>>>
31335>>>>>    else  mid  str# to Dates$Year 4 (pos2#+1)
31339>>>>>  end
31339>>>>>>
31339>>>>>end_procedure
31340>>>>>
31340>>>>>function DateCompose global integer day# integer month# integer year# returns date
31341>>>>>  local integer format#
31342>>>>>  local date date#
31342>>>>>  local string sep#
31342>>>>>  ifnot (day#*month#*year#) function_return 0
31345>>>>>  get_attribute DF_DATE_SEPARATOR to format# // overload
31348>>>>>  character format# to sep#                  // end overload
31349>>>>>>
31349>>>>>  get_attribute DF_DATE_FORMAT to format#
31352>>>>>  if day# gt 28 begin
31354>>>>>    if format# eq DF_DATE_EUROPEAN move (date(string(day#)+sep#+string(month#)+sep#+string(year#))) to date# // DMY
31357>>>>>    if format# eq DF_DATE_USA      move (date(string(month#)+sep#+string(day#)+sep#+string(year#))) to date# // MDY
31360>>>>>    if format# eq DF_DATE_MILITARY move (date(string(year#)+sep#+string(month#)+sep#+string(day#))) to date# // YMD
31363>>>>>    send DateDecompose date#
31364>>>>>    if Dates$Month ne month# move (day#-Dates$Day) to day#
31367>>>>>  end
31367>>>>>>
31367>>>>>  if format# eq DF_DATE_EUROPEAN function_return (date(string(day#)+sep#+string(month#)+sep#+string(year#))) // DMY
31370>>>>>  if format# eq DF_DATE_USA function_return (date(string(month#)+sep#+string(day#)+sep#+string(year#))) // MDY
31373>>>>>  function_return (date(string(year#)+sep#+string(month#)+sep#+string(day#))) // YMD
31374>>>>>end_function
31375>>>>>
31375>>>>>function DateFormatName global integer format# returns string
31376>>>>>  if format# eq DF_DATE_EUROPEAN function_return "European"
31379>>>>>  if format# eq DF_DATE_USA      function_return "United States"
31382>>>>>  if format# eq DF_DATE_MILITARY function_return "Military"
31385>>>>>end_function
31386>>>>>
31386>>>>>function DateCurrentSeparator global returns string
31387>>>>>  local integer rval#
31388>>>>>  get_attribute DF_DATE_SEPARATOR to rval#
31391>>>>>  function_return (character(rval#))
31392>>>>>end_function
31393>>>>>
31393>>>>>function DateCurrentFormat global returns integer
31394>>>>>  local integer rval#
31395>>>>>  get_attribute DF_DATE_FORMAT to rval#
31398>>>>>  function_return rval#
31399>>>>>end_function
31400>>>>>
31400>>>>>function DateFormatAsString global integer format# integer long# string sep# returns string
31401>>>>>  local string rval# letter#
31402>>>>>  if format# eq DF_DATE_EUROPEAN move "3342241111" to rval#
31405>>>>>  if format# eq DF_DATE_USA      move "2243341111" to rval#
31408>>>>>  if format# eq DF_DATE_MILITARY move "1111422433" to rval#
31411>>>>>  left t.calendar.year to letter# 1
31413>>>>>>
31413>>>>>  replace "1" in rval# with letter#
31415>>>>>  replace "1" in rval# with letter#
31417>>>>>  ifnot long# move "" to letter#
31420>>>>>  move (replaces("1",rval#,letter#)) to rval#
31421>>>>>  move (replaces("2",rval#,left(t.calendar.month,1))) to rval#
31422>>>>>  move (replaces("3",rval#,left(t.calendar.day,1))) to rval#
31423>>>>>  if sep# eq "" begin
31425>>>>>    get_attribute DF_DATE_SEPARATOR to format#
31428>>>>>    character format# to sep#
31429>>>>>>
31429>>>>>  end
31429>>>>>>
31429>>>>>  move (replaces("4",rval#,sep#)) to rval#
31430>>>>>  function_return rval#
31431>>>>>end_function
31432>>>>>
31432>>>>>function StringToDate global string date# integer format# integer four_digit_year# string sep# returns date
31433>>>>>  local integer sep_len# day# month# year#
31434>>>>>  move (length(sep#)) to sep_len#
31435>>>>>  if four_digit_year# move 4 to four_digit_year#
31438>>>>>  else move 2 to four_digit_year#
31440>>>>>  if format# eq DF_DATE_EUROPEAN begin // DMY
31442>>>>>    move (mid(date#,2,1)) to day#
31443>>>>>    move (mid(date#,2,3+sep_len#)) to month#
31444>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31445>>>>>  end
31445>>>>>>
31445>>>>>  if format# eq DF_DATE_USA begin // MDY
31447>>>>>    move (mid(date#,2,1)) to month#
31448>>>>>    move (mid(date#,2,3+sep_len#)) to year#
31449>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31450>>>>>  end
31450>>>>>>
31450>>>>>  if format# eq DF_DATE_MILITARY begin // YMD
31452>>>>>    move (mid(date#,four_digit_year#,1)) to year#
31453>>>>>    move (mid(date#,2,1+four_digit_year#+sep_len#)) to month#
31454>>>>>    move (mid(date#,2,3+four_digit_year#+sep_len#+sep_len#)) to day#
31455>>>>>  end
31455>>>>>>
31455>>>>>  function_return (DateCompose(day#,month#,year#))
31456>>>>>end_function
31457>>>>>
31457>>>>>function DateToString global date date# integer format# integer four_digit_year# string sep# returns string
31458>>>>>  local string rval# day# month# year#
31459>>>>>  get Date2to4 date# to date#
31460>>>>>  if (integer(date#)) begin
31462>>>>>    send DateDecompose date#
31463>>>>>    move Dates$Day to day#
31464>>>>>    if Dates$Day lt 10 insert "0" in day# at 1
31468>>>>>    move Dates$Month to month#
31469>>>>>    if Dates$Month lt 10 insert "0" in month# at 1
31473>>>>>    move Dates$Year to year#
31474>>>>>    ifnot four_digit_year# move (right(year#,2)) to year#
31477>>>>>    if format# eq DF_DATE_EUROPEAN move (day#+sep#+month#+sep#+year#) to rval# // DMY
31480>>>>>    if format# eq DF_DATE_USA      move (month#+sep#+day#+sep#+year#) to rval# // MDY
31483>>>>>    if format# eq DF_DATE_MILITARY move (year#+sep#+month#+sep#+day#) to rval# // YMD
31486>>>>>  end
31486>>>>>>
31486>>>>>  function_return rval#
31487>>>>>end_function
31488>>>>>
31488>>>>>// Function DateAsString is only here for compatibility with earlier versions.
31488>>>>>// Use function DateToString instead.
31488>>>>>function DateAsString global date date# integer format# integer four_digit_year# string sep# returns string
31489>>>>>  function_return (DateToString(date#,format#,four_digit_year#,sep#))
31490>>>>>end_function
31491>>>>>
31491>>>>>function DateIncrement global date date# integer segment# integer amount# returns date
31492>>>>>  if (date#=0) function_return 0
31495>>>>>  if segment# eq DS_WEEK function_return (date#+(amount#*7)) //weeks
31498>>>>>  if (segment#<>DS_DAY) begin // months or years
31500>>>>>    send DateDecompose date#
31501>>>>>    if segment# eq DS_MONTH begin //months
31503>>>>>      move (Dates$Month+amount#) to Dates$Month
31504>>>>>      if amount# ge 0 function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-1)/12)*12),Dates$Year+((Dates$Month-1)/12)))
31507>>>>>      function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-12)/12)*12),Dates$Year+((Dates$Month-12)/12)))
31508>>>>>    end //years:
31508>>>>>>
31508>>>>>    if segment# eq DS_YEAR function_return (DateCompose(Dates$Day,Dates$Month,Dates$Year+amount#))
31511>>>>>  end
31511>>>>>>
31511>>>>>  else function_return (date#+amount#) //days
31513>>>>>end_function
31514>>>>>
31514>>>>>function DateSegment global date date# integer segment# returns integer
31515>>>>>  send DateDecompose date#
31516>>>>>  if segment# eq DS_DAY   function_return Dates$Day
31519>>>>>  if segment# eq DS_MONTH function_return Dates$Month
31522>>>>>  if segment# eq DS_YEAR  function_return Dates$Year
31525>>>>>end_function
31526>>>>>
31526>>>>>function DateToInteger global date date# returns integer
31527>>>>>  send DateDecompose date#
31528>>>>>  function_return (Dates$Year*100+Dates$Month*100+Dates$Day)
31529>>>>>end_function
31530>>>>>
31530>>>>>function FirstDayInMonth global date date# returns date
31531>>>>>  local integer month# year#
31532>>>>>  move (DateSegment(date#,DS_MONTH)) to month#
31533>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31534>>>>>  function_return (DateCompose(1,month#,year#))
31535>>>>>end_function
31536>>>>>
31536>>>>>function LastDayInMonth global date date# returns date
31537>>>>>  move (DateIncrement(date#,DS_MONTH,1)) to date#
31538>>>>>  function_return (FirstDayInMonth(date#)-1)
31539>>>>>end_function
31540>>>>>
31540>>>>>function FirstDayInYear global date date# returns date
31541>>>>>  local integer year#
31542>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31543>>>>>  function_return (DateCompose(1,1,year#))
31544>>>>>end_function
31545>>>>>
31545>>>>>function LastDayInYear global date date# returns date
31546>>>>>  move (DateIncrement(date#,DS_YEAR,1)) to date#
31547>>>>>  function_return (FirstDayInYear(date#)-1)
31548>>>>>end_function
31549>>>>>
31549>>>>>// Prior to 18/1-99 version of DateWeekNumber
31549>>>>>//function DateWeekNumber global date date# returns integer
31549>>>>>//  local integer week# first_wd# day_of_year# year#
31549>>>>>//  if (date#=0) function_return 0
31549>>>>>//  get Date2to4 date# to date#
31549>>>>>//  move (DateSegment(date#,DS_YEAR)) to year#
31549>>>>>//  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31549>>>>>//  move (date#-FirstDayInYear(date#)) to day_of_year#
31549>>>>>//  move (day_of_year#-1-7+first_wd#) to day_of_year#
31549>>>>>//  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31549>>>>>//  else move 0 to week#
31549>>>>>//  if first_wd# le 4 increment week#
31549>>>>>//  if week# gt 52 begin
31549>>>>>//    move 1 to week#
31549>>>>>//    if first_wd# eq 4 move 53 to week#
31549>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31549>>>>>//  end
31549>>>>>//  if week# eq 0 begin
31549>>>>>//    //get DateWeekNumber (DateIncrement(date#,DS_YEAR,-1)) to first_wd# // Original line
31549>>>>>//    get DateDayNumber  (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#ÿ // changed line
31549>>>>>//    move 52 to week#
31549>>>>>//    if first_wd# eq 4 move 53 to week#
31549>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31549>>>>>//  end
31549>>>>>//  function_return week#
31549>>>>>//end_function
31549>>>>>
31549>>>>>function DateWeekNumber global date date# returns integer
31550>>>>>  local integer week# first_wd# day_of_year# year# wd#
31551>>>>>  if (date#=0) function_return 0
31554>>>>>  get Date2to4 date# to date#
31555>>>>>  // Leap-year test for actual or previous year
31555>>>>>  // Year# only used for selection between 52 and
31555>>>>>  // Therefore get year# from the first day of actual week
31555>>>>>  get DateDayNumber date# to wd#
31556>>>>>  move (DateSegment(date#-wd#+1,DS_YEAR)) to year#
31557>>>>>
31557>>>>>  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31558>>>>>  move (date#-FirstDayInYear(date#)) to day_of_year#
31559>>>>>  move (day_of_year#-1-7+first_wd#) to day_of_year#
31560>>>>>  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31563>>>>>  else move 0 to week#
31565>>>>>  if first_wd# le 4 increment week#
31568>>>>>  if week# gt 52 begin
31570>>>>>    move 1 to week#
31571>>>>>    if first_wd# eq 4 move 53 to week#
31574>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31581>>>>>  end
31581>>>>>>
31581>>>>>  if week# eq 0 begin
31583>>>>>    // Week 52 or 53
31583>>>>>    get DateDayNumber (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#
31584>>>>>    move 52 to week#
31585>>>>>    if first_wd# eq 4 move 53 to week#
31588>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31595>>>>>  end
31595>>>>>>
31595>>>>>  function_return week#
31596>>>>>end_function
31597>>>>>
31597>>>>>function DayName global integer int# returns string
31598>>>>>  if int# eq 1 function_return t.calendar.Monday
31601>>>>>  if int# eq 2 function_return t.calendar.Tuesday
31604>>>>>  if int# eq 3 function_return t.calendar.Wednesday
31607>>>>>  if int# eq 4 function_return t.calendar.Thursday
31610>>>>>  if int# eq 5 function_return t.calendar.Friday
31613>>>>>  if int# eq 6 function_return t.calendar.Saturday
31616>>>>>  if int# eq 7 function_return t.calendar.Sunday
31619>>>>>  function_return ""
31620>>>>>end_function
31621>>>>>
31621>>>>>function DateDayNumber global date date# returns integer
31622>>>>>  local integer rval# // 1=Monday, ... , 7=Sunday
31623>>>>>  get Date2to4 date# to date#
31624>>>>>  move date# to rval#
31625>>>>>  if rval# begin
31627>>>>>    if rval# gt 693975 move (rval#-2) to rval#
31630>>>>>    move (rval#-((rval#/7)*7)) to rval#
31631>>>>>    if rval# eq 0 move 7 to rval#
31634>>>>>  end
31634>>>>>>
31634>>>>>  function_return rval#
31635>>>>>end_function
31636>>>>>
31636>>>>>function DateDayName global date date# returns string
31637>>>>>  function_return (DayName(DateDayNumber(date#)))
31638>>>>>end_function
31639>>>>>
31639>>>>>function YearMaxWeek global integer year# returns integer
31640>>>>>  local integer wk1# wk2#
31641>>>>>  get DateWeekNumber (DateCompose(31,12,year#)) to wk1#
31642>>>>>  get DateWeekNumber (DateCompose(24,12,year#)) to wk2#
31643>>>>>  function_return (wk1# max wk2#)
31644>>>>>end_function
31645>>>>>
31645>>>>>function WeekToDate global integer year# integer week# returns date
31646>>>>>  local date date#
31647>>>>>  move (DateCompose(1,1,year#)) to date#
31648>>>>>  if (DateWeekNumber(date#)) ne 1 move (date#+7) to date# // week 52 or 53
31651>>>>>  move (date#-DateDayNumber(date#)+1) to date# // Now it's a Monday
31652>>>>>  function_return (week#-1*7+date#)
31653>>>>>end_function
31654>>>>>
31654>>>>>function MonthName global integer int# returns string
31655>>>>>  if int# eq  1 function_return t.calendar.January
31658>>>>>  if int# eq  2 function_return t.calendar.February
31661>>>>>  if int# eq  3 function_return t.calendar.March
31664>>>>>  if int# eq  4 function_return t.calendar.April
31667>>>>>  if int# eq  5 function_return t.calendar.May
31670>>>>>  if int# eq  6 function_return t.calendar.June
31673>>>>>  if int# eq  7 function_return t.calendar.July
31676>>>>>  if int# eq  8 function_return t.calendar.August
31679>>>>>  if int# eq  9 function_return t.calendar.September
31682>>>>>  if int# eq 10 function_return t.calendar.October
31685>>>>>  if int# eq 11 function_return t.calendar.November
31688>>>>>  if int# eq 12 function_return t.calendar.December
31691>>>>>  function_return ""
31692>>>>>end_function
31693>>>>>
31693>>>>>function DateMonthName global date date# returns string
31694>>>>>  function_return (MonthName(DateSegment(date#,DS_MONTH)))
31695>>>>>end_function
31696>>>>>
31696>>>>>function DateAsText global date date# string format# returns string
31697>>>>>  if date# eq 0 function_return ""
31700>>>>>  move (replace("#DN",format#,DateDayName(date#)))                  to format#
31701>>>>>  move (replace("#MN",format#,DateMonthName(date#)))                to format#
31702>>>>>  move (replace("#D" ,format#,string(DateSegment(date#,DS_DAY))))   to format#
31703>>>>>  move (replace("#Y" ,format#,string(DateSegment(date#,DS_YEAR))))  to format#
31704>>>>>  move (replace("#M" ,format#,string(DateSegment(date#,DS_MONTH)))) to format#
31705>>>>>  function_return format#
31706>>>>>end_function
31707>>>>>
31707>>>>>function Year2to4 global integer year# returns integer
31708>>>>>  local integer epoch_value#
31709>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31710>>>>>  if year# lt 100 begin
31712>>>>>    if year# gt epoch_value# function_return (year#+1900)
31715>>>>>    function_return (year#+2000)
31716>>>>>  end
31716>>>>>>
31716>>>>>  function_return year# // No conversion done!
31717>>>>>end_function
31718>>>>>
31718>>>>>function Date2to4 global date date# returns date
31719>>>>>  local integer epoch_value#
31720>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31721>>>>>  if date# gt 0 begin // Only if there is a date to convert
31723>>>>>    if (DateSegment(date#,DS_YEAR)) lt 105 begin
31725>>>>>      if Dates$Year gt epoch_value# function_return (DateIncrement(date#,DS_YEAR,1900))
31728>>>>>      function_return (DateIncrement(date#,DS_YEAR,2000))
31729>>>>>    end
31729>>>>>>
31729>>>>>    function_return date# // No conversion done!
31730>>>>>  end
31730>>>>>>
31730>>>>>end_function
31731>>>>>
31731>>>>>function Date4to2 global date date# returns date
31732>>>>>  local integer epoch_value# year#
31733>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31734>>>>>  if date# gt 0 begin // Only if there is a date to convert
31736>>>>>    move (DateSegment(date#,DS_YEAR)) to year#
31737>>>>>    if year# ge 100 begin // Only then conversion is needed!
31739>>>>>      if (year#>=(1900+epoch_value#) and year#<(2000+epoch_value#)) begin
31741>>>>>        if year# lt 2000 function_return (DateIncrement(date#,DS_YEAR,-1900))
31744>>>>>        else             function_return (DateIncrement(date#,DS_YEAR,-2000))
31746>>>>>      end
31746>>>>>>
31746>>>>>      else error 301 "Date is out of epoch range"
31748>>>>>    end
31748>>>>>>
31748>>>>>  end
31748>>>>>>
31748>>>>>  function_return date# // No conversion done!
31749>>>>>end_function
31750>>>>>
31750>>>>>function dSysDate global returns date
31751>>>>>  local date date#
31752>>>>>  sysdate4 date#
31753>>>>>  function_return date#
31754>>>>>end_function
31755>>>>>
31755>>>>>function iSysYear global returns integer
31756>>>>>  local date date#
31757>>>>>  sysdate4 date#
31758>>>>>  function_return (DateSegment(date#,DS_YEAR))
31759>>>>>end_function
31760>>>>>
31760>>>>>procedure ItemSysdate for desktop integer itm#
31761>>>>>  local date date#
31762>>>>>  get value item itm# to date#
31763>>>>>  if date# eq 0 begin
31765>>>>>    sysdate4 date#
31766>>>>>    set changed_value item itm# to date#
31767>>>>>  end
31767>>>>>>
31767>>>>>end_procedure
31768>>>>>
31768>>>>>procedure ItemDate2to4 for desktop integer itm#
31769>>>>>  local integer year#
31770>>>>>  local date date# new_date#
31770>>>>>  get value item itm# to date#
31771>>>>>
31771>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31772>>>>>  if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31775>>>>>  else move date# to new_date#
31777>>>>>
31777>>>>>  move (Date2to4(new_date#)) to new_date#
31778>>>>>  move (DateSegment(new_date#,3)) to year#
31779>>>>>  if (year#>99 and year#<1000) begin
31781>>>>>    error 15 // Illegal entry in this window
31782>>>>>>
31782>>>>>    procedure_return 1
31783>>>>>  end
31783>>>>>>
31783>>>>>  if new_date# ne date# set value item itm# to new_date#
31786>>>>>end_procedure
31787>>>>>
31787>>>>>procedure ItemYear2to4 for desktop integer itm#
31788>>>>>  local integer year# new_year#
31789>>>>>  get value item itm# to year#
31790>>>>>  if (year#>99 and year#<1000) begin
31792>>>>>    error 15 // Illegal entry in this window
31793>>>>>>
31793>>>>>    procedure_return 1
31794>>>>>  end
31794>>>>>>
31794>>>>>  move (Year2to4(year#)) to new_year#
31795>>>>>  if new_year# ne year# set value item itm# to new_year#
31798>>>>>end_procedure
31799>>>>>
31799>>>>> procedure FieldSysdate for DataDictionary integer fld#
31800>>>>>   local date date#
31801>>>>>   get field_current_value fld# to date#
31802>>>>>   if date# eq 0 begin
31804>>>>>     sysdate4 date#
31805>>>>>     set field_changed_value fld# to date#
31806>>>>>   end
31806>>>>>>
31806>>>>> end_procedure
31807>>>>>
31807>>>>> procedure FieldDate2to4 for DataDictionary integer fld#
31808>>>>>   local integer year#
31809>>>>>   local date date# new_date#
31809>>>>>   get field_current_value fld# to date#
31810>>>>>
31810>>>>>   move (DateSegment(date#,DS_YEAR)) to year#
31811>>>>>   if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31814>>>>>   else move date# to new_date#
31816>>>>>
31816>>>>>   move (Date2to4(new_date#)) to new_date#
31817>>>>>   move (DateSegment(new_date#,3)) to year#
31818>>>>>   if (year#>99 and year# <=999) begin
31820>>>>>     error 15 // Illegal entry in this window
31821>>>>>>
31821>>>>>     procedure_return 1
31822>>>>>   end
31822>>>>>>
31822>>>>>   if new_date# ne date# set field_changed_value fld# to new_date#
31825>>>>> end_procedure
31826>>>>>
31826>>>>> procedure FieldYear2to4 for DataDictionary integer fld#
31827>>>>>   local integer year# new_year# changed#
31828>>>>>   get field_current_value fld# to year#
31829>>>>>   get field_changed_state fld# to changed#
31830>>>>>   if changed# begin
31832>>>>>     if (year#>99 and year#<1000) begin
31834>>>>>       error 15 // Illegal entry in this window
31835>>>>>>
31835>>>>>       procedure_return 1
31836>>>>>     end
31836>>>>>>
31836>>>>>     move (Year2to4(year#)) to new_year#
31837>>>>>     if new_year# ne year# set field_changed_value fld# to new_year#
31840>>>>>   end
31840>>>>>>
31840>>>>> end_procedure
31841>>>>>
31841>>>>> function SysDate global returns date
31842>>>>>   function_return (dSysDate())
31843>>>>> end_function
31844>>>>>
31844>>>>>function sSysTime global returns string
31845>>>>>  local integer h# m# s#
31846>>>>>  sysdate4 h# h# m# s#
31850>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31851>>>>>end_function
31852>>>>>
31852>>>>>function TS_SysTime global returns number
31853>>>>>  local integer d# h# m# s#
31854>>>>>  sysdate4 d# h# m# s#
31858>>>>>  function_return (d#*24.0+h#*60+m#*60+s#)
31859>>>>>end_function
31860>>>>>
31860>>>>>//> This function returns a TS value composed from the date and time
31860>>>>>//> passed to it. Note that the time variable must be of the format
31860>>>>>//> "hh:mm:ss".
31860>>>>>function TS_Compose global date date# string time# returns number
31861>>>>>  local integer h# m# s#
31862>>>>>  left time# to h# 2
31864>>>>>>
31864>>>>>  mid time# to m# 2 4
31867>>>>>>
31867>>>>>  mid time# to s# 2 7
31870>>>>>>
31870>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31871>>>>>end_function
31872>>>>>
31872>>>>>function TS_Compose2 global date date# integer h# integer m# integer s# returns number
31873>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31874>>>>>end_function
31875>>>>>
31875>>>>>function TS_ExtractDate global number time# returns date
31876>>>>>  function_return (time#/86400) // 86400=24*60*60
31877>>>>>end_function
31878>>>>>
31878>>>>>function TS_ExtractTime global number time# returns string
31879>>>>>  local integer h# m# s#
31880>>>>>  move (time#-(86400.0*integer(TS_ExtractDate(time#)))) to s#
31881>>>>>  move (s#/3600) to h#
31882>>>>>  move (s#-(h#*3600)) to s#
31883>>>>>  move (s#/60) to m#
31884>>>>>  move (s#-(m#*60)) to s#
31885>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31886>>>>>end_function
31887>>>>>
31887>>>>>function TS_ConvertToString global number time# returns string
31888>>>>>  local date d#
31889>>>>>  move (TS_ExtractDate(time#)) to d#
31890>>>>>  if (integer(d#)) function_return (string(d#)+" "+TS_ExtractTime(time#))
31893>>>>>  else function_return (TS_ExtractTime(time#))
31895>>>>>end_function
31896>>>>>
31896>>>>>function TS_ConvertToStringNoDate global number ts# returns string
31897>>>>>  local integer h# m#
31898>>>>>  move (ts#/3600) to h#
31899>>>>>  move (ts#-(h#*3600)) to ts#
31900>>>>>  move (ts#/60) to m#
31901>>>>>  move (ts#-(m#*60)) to ts#
31902>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(ts#<10,"0","")+string(ts#))
31903>>>>>end_function
31904>>>>>
31904>>>>>// This procedure is used when a TS-variable must be displayed on screen.
31904>>>>>procedure TS_UI_Update global number TS# integer obj1# integer itm1# integer tmp_obj2# integer tmp_itm2#
31905>>>>>  local integer obj2# itm2#
31906>>>>>  if num_arguments gt 3 begin
31908>>>>>    move tmp_obj2# to obj2#
31909>>>>>    move tmp_itm2# to itm2#
31910>>>>>  end
31910>>>>>>
31910>>>>>  else begin
31911>>>>>    move obj1# to obj2#
31912>>>>>    move (itm1#+1) to itm2#
31913>>>>>  end
31913>>>>>>
31913>>>>>  set value of obj1# item itm1# to (TS_ExtractDate(TS#))
31914>>>>>  set value of obj2# item itm2# to (TS_ExtractTime(TS#))
31915>>>>>end_procedure
31916>>>>>
31916>>>>>class TS_TimeEstimator is an array
31917>>>>>  procedure construct_object
31918>>>>>    forward send construct_object
31920>>>>>    set delegation_mode to delegate_to_parent
31921>>>>>    property number  pnTotal   public 0 // Seconds needed to run the loop.
31922>>>>>    property number  pnElapsed public 0 // Seconds elapsed so far.
31923>>>>>    property number  pnLeft    public 0 // Number of seconds left
31924>>>>>    property number  pnStart   public 0
31925>>>>>    property number  pnPause   public 0
31926>>>>>    property number  pnPercent public 0
31927>>>>>    property integer piMin     public 0
31928>>>>>    property integer piMax     public 0
31929>>>>>  end_procedure
31930>>>>>
31930>>>>>  procedure TS_Start integer min# integer max#
31931>>>>>    set piMin to min#
31932>>>>>    set piMax to max#
31933>>>>>    set pnStart to (TS_SysTime())
31934>>>>>    set pnElapsed to 0
31935>>>>>    set pnPercent to 0
31936>>>>>  end_procedure
31937>>>>>
31937>>>>>  procedure TS_Calculate integer pos#
31938>>>>>    local integer min# max#
31939>>>>>    get piMin to min#
31940>>>>>    get piMax to max#
31941>>>>>    set pnElapsed to (TS_SysTime()-pnStart(current_object))
31942>>>>>    set pnTotal   to (pnElapsed(current_object)*(max#-min#)/number(pos#-min#))
31943>>>>>    set pnLeft    to (pnTotal(current_object)-pnElapsed(current_object))
31944>>>>>    set pnPercent to (100.0*(pos#-min#)/(max#-min#))
31945>>>>>  end_procedure
31946>>>>>
31946>>>>>  procedure TS_Pause
31947>>>>>    set pnPause to (TS_SysTime())
31948>>>>>  end_procedure
31949>>>>>
31949>>>>>  procedure TS_Continue
31950>>>>>    set pnStart to (pnStart(current_object)+TS_SysTime()-pnPause(current_object))
31951>>>>>  end_procedure
31952>>>>>end_class
31953>>>>>
31953>>>>>function TS_Module_Compile_Time global string path# returns number
31954>>>>>  local integer pos# day# month# year# seqeof# ch#
31955>>>>>  local string date# str# time#
31955>>>>>  move path# to str#
31956>>>>>  if str# ne "" begin
31958>>>>>    get Seq_New_Channel to ch#   // This method and Seq_Release_Channel are
31959>>>>>    send Seq_Release_Channel ch# // We only need it for a second
31960>>>>>      direct_input channel ch# (trim(str#)+".vd6") // VDF 6
31962>>>>>      [seqeof] direct_input channel ch# (trim(str#)+".vd5") // VDF 5
31964>>>>>    [ seqeof] move 1 to seqeof#
31965>>>>>    [~seqeof] move 0 to seqeof#
31966>>>>>    [~seqeof] readln str#
31967>>>>>    close_input channel ch#
31969>>>>>  end
31969>>>>>>
31969>>>>>  if seqeof# function_return 0
31972>>>>>  pos "," in str# to pos#
31974>>>>>>
31974>>>>>  move (mid(str#,18,pos#+2)) to str#
31975>>>>>  move (integer(mid(str#,2,4))) to day#
31976>>>>>  move (integer(mid(str#,2,1))) to month#
31977>>>>>  move (integer(mid(str#,2,7))) to year#
31978>>>>>  if year# eq 10 begin
31980>>>>>    move (integer(mid(str#,3,7))+1900) to year#
31981>>>>>    move (mid(str#,8,11)) to str#
31982>>>>>  end
31982>>>>>>
31982>>>>>  else move (mid(str#,8,10)) to str#
31984>>>>>  move (DateCompose(day#,month#,year#)) to date#
31985>>>>>  move (Date2to4(date#)) to date#
31986>>>>>  pos ":" in str# to pos#
31988>>>>>>
31988>>>>>  function_return (TS_Compose(date#,mid(str#,8,pos#-2)))
31989>>>>>end_function
31990>>>>>
31990>>>>>string Dates$Module_Compile_Time
31990>>>>>move "" to Dates$Module_Compile_Time
31991>>>>>
31991>>>>>function Module_Compile_Date global returns date
31992>>>>>  local number ts#
31993>>>>>  local string str#
31993>>>>>  get module_name to str# // 'module_name' is most likely the name of the .flx file.
31994>>>>>  get TS_Module_Compile_Time str# to ts#
31995>>>>>  move (TS_ExtractTime(ts#)) to Dates$Module_Compile_Time
31996>>>>>  function_return (TS_ExtractDate(ts#))
31997>>>>>end_function
31998>>>>>
31998>>>>>function Module_Compile_Time global returns string
31999>>>>>  local date grb#
32000>>>>>  // Module_Compile_Date must be called before this one!
32000>>>>>  if Dates$Module_Compile_Time eq "" move (Module_Compile_Date()) to grb#
32003>>>>>  function_return Dates$Module_Compile_Time
32004>>>>>end_function
32005>>>>>
32005>>>>>date   Dates$ModuleStartDate
32005>>>>>string Dates$ModuleStartTime 8
32005>>>>>move (dSysDate()) to Dates$ModuleStartDate
32006>>>>>move (sSysTime()) to Dates$ModuleStartTime
32007>>>>>
32007>>>>>function Module_Start_Date global returns date
32008>>>>>  function_return Dates$ModuleStartDate
32009>>>>>end_function
32010>>>>>
32010>>>>>function Module_Start_Time global returns string
32011>>>>>  function_return Dates$ModuleStartTime
32012>>>>>end_function
32013>>>>>
32013>>>>> register_procedure NotifyPopupCalendarChange date date#
32013>>>>> register_procedure NotifyPopupCalendarSelect date date#
32013>>>>>  use dfAllent
32013>>>>>  class calendar.textbox is a textbox
32014>>>>>    procedure construct_object
32015>>>>>      forward send construct_object
32017>>>>>      Set Auto_Size_State To False
32018>>>>>      Set Justification_Mode To (jMode_vCenter+jMode_Center)
32019>>>>>    end_procedure
32020>>>>>  end_class
32021>>>>>
32021>>>>>  register_object btn1
32021>>>>>  register_object btn6
32021>>>>>
32021>>>>>  class calendar.button is a button
32022>>>>>
32022>>>>>    procedure construct_object
32023>>>>>      forward send construct_object
32025>>>>>      set size to 15 18
32026>>>>>      on_key kleftarrow   send prev_day
32027>>>>>      on_key krightarrow  send next_day
32028>>>>>      on_key kuparrow     send prev_week
32029>>>>>      on_key kdownarrow   send next_week
32030>>>>>      property date p_assigned_date public 0
32031>>>>>    end_procedure
32032>>>>>
32032>>>>>    procedure switch // This makes all 42 buttons act as if they are one focus
32033>>>>>      send activate to (btn1(current_object))
32034>>>>>    end_procedure
32035>>>>>    procedure switch_back
32036>>>>>      send activate to (btn6(current_object))
32037>>>>>    end_procedure
32038>>>>>
32038>>>>>    procedure mouse_down
32039>>>>>      local integer current_object#
32040>>>>>      forward send mouse_down
32042>>>>>      move current_object to current_object#
32043>>>>>      delegate set p_current_date to (p_assigned_date(current_object#))
32045>>>>>    end_procedure
32046>>>>>  end_class
32047>>>>>
32047>>>>>  desktop_section
32053>>>>>    object popup_calendar is a ModalPanel
32055>>>>>      set size to 160 250
32056>>>>>      property date    p_current_date  public 0
32058>>>>>      property integer p_current_year  public -1
32060>>>>>      property integer p_current_month public -1
32062>>>>>      property integer pExportState    public 1
32064>>>>>
32064>>>>>      on_key key_ctrl+key_pgup send prev_year
32065>>>>>      on_key key_ctrl+key_pgdn send next_year
32066>>>>>      on_key          key_pgup send prev_month
32067>>>>>      on_key          key_pgdn send next_month
32068>>>>>      on_key key_ctrl+key_d    send go_today
32069>>>>>      on_key kcancel           send cancel
32070>>>>>
32070>>>>>      object cont3d is a container3d
32072>>>>>        set location to 5 5
32073>>>>>        set size to 120 237
32074>>>>>        object textbox_year is a calendar.textbox
32076>>>>>          set location to 5 5
32077>>>>>          set size to 15 30
32078>>>>>          set border_style to border_staticedge
32079>>>>>          procedure display
32081>>>>>            set value to (p_current_year(current_object))
32082>>>>>          end_procedure
32083>>>>>        end_object
32084>>>>>        object dayname_header is a container3d
32086>>>>>          set location to 5 39
32087>>>>>          set size to 15 126
32088>>>>>          set border_style to border_staticedge
32089>>>>>          procedure initialize
32091>>>>>            local integer itm#
32092>>>>>            for itm# from 0 to 6
32098>>>>>>
32098>>>>>              object txt is a calendar.textbox
32100>>>>>                set size to 12 17
32101>>>>>                set location to 0 (itm#*17.6+1)
32102>>>>>                 set value to (left(DayName(itm#+1),3))
32103>>>>>              end_object
32104>>>>>            loop
32105>>>>>>
32105>>>>>          end_procedure
32106>>>>>          send initialize
32107>>>>>        end_object
32108>>>>>        object weeknumber_header is a container3d
32110>>>>>          set location to 24 5
32111>>>>>          set size     to 89 30
32112>>>>>          set border_style to border_staticedge
32113>>>>>          object obj_id_array is an array
32115>>>>>          end_object
32116>>>>>          procedure initialize
32118>>>>>            local integer itm# obj#
32119>>>>>            move (obj_id_array(current_object)) to obj#
32120>>>>>            for itm# from 0 to 5
32126>>>>>>
32126>>>>>              object txt is a textbox
32128>>>>>                set size to 15 30
32129>>>>>                set location to (itm#*15+1) 1
32130>>>>>                set value of obj# item (item_count(obj#)) to current_object
32131>>>>>              end_object
32132>>>>>            loop
32133>>>>>>
32133>>>>>          end_procedure
32134>>>>>          procedure display
32136>>>>>            local integer itm# obj#
32137>>>>>            local date date# last_date#
32137>>>>>            move (obj_id_array(current_object)) to obj#
32138>>>>>            get p_current_date to date#
32139>>>>>            move (FirstDayInMonth(date#)) to date#
32140>>>>>            move (LastDayInMonth(date#)) to last_date#
32141>>>>>            move (date#-DateDayNumber(date#)+1) to date#
32142>>>>>            for itm# from 0 to 5
32148>>>>>>
32148>>>>>              if (itm#*7+date#) le last_date# ;                set value of (integer(value(obj#,itm#))) to (t.calendar.week*string(DateWeekNumber(itm#*7+date#)))
32151>>>>>              else set value of (integer(value(obj#,itm#))) to ""
32153>>>>>            loop
32154>>>>>>
32154>>>>>          end_procedure
32155>>>>>          send initialize
32156>>>>>        end_object
32157>>>>>        object days_grid is a container3d
32159>>>>>          set location to 23 39
32160>>>>>          set size     to 100 127
32161>>>>>          set border_style to border_none
32162>>>>>          object btn_array is an array
32164>>>>>          end_object
32165>>>>>          procedure initialize
32167>>>>>            local integer row# col# button_array#
32168>>>>>            move (btn_array(current_object)) to button_array#
32169>>>>>            for row# from 0 to 5
32175>>>>>>
32175>>>>>              for col# from 0 to 6
32181>>>>>>
32181>>>>>                object btn is a calendar.button
32183>>>>>                  set location to (row#*15) (col#*18)
32184>>>>>                  set value of button_array# item (item_count(button_array#)) to current_object
32185>>>>>                  on_item "" send move_value_out_ok
32186>>>>>                end_object
32187>>>>>              loop
32188>>>>>>
32188>>>>>            loop
32189>>>>>>
32189>>>>>          end_procedure
32190>>>>>          send initialize
32191>>>>>
32191>>>>>          procedure display.iii integer itm# integer day# integer activate#
32193>>>>>            local integer obj# current_day#
32194>>>>>            move (integer(value(btn_array(current_object),itm#))) to obj#
32195>>>>>            move (DateSegment(p_current_date(current_object),DS_DAY)) to current_day#
32196>>>>>            if activate# begin
32198>>>>>              if day# eq current_day# send activate to obj#
32201>>>>>            end
32201>>>>>>
32201>>>>>            else begin
32202>>>>>              if day# begin
32204>>>>>                set value of obj# to day#
32205>>>>>                set visible_state of obj# to true
32206>>>>>                set p_assigned_date of obj# to (DateCompose(day#,p_current_month(current_object),p_current_year(current_object)))
32207>>>>>              end
32207>>>>>>
32207>>>>>              else set visible_state of obj# to false
32209>>>>>            end
32209>>>>>>
32209>>>>>          end_procedure
32210>>>>>
32210>>>>>          procedure display integer activate#
32212>>>>>            local integer first_item# last_item# itm# day# date#
32213>>>>>            get p_current_date to date#
32214>>>>>            move (FirstDayInMonth(date#)) to date#
32215>>>>>            move (DateDayNumber(date#)-1) to first_item#
32216>>>>>            move (LastDayInMonth(date#)-date#+first_item#) to last_item#
32217>>>>>            ifnot activate# begin
32219>>>>>              for itm# from 0 to (first_item#-1)
32225>>>>>>
32225>>>>>                send display.iii itm# 0 0
32226>>>>>              loop
32227>>>>>>
32227>>>>>            end
32227>>>>>>
32227>>>>>            move 1 to day#
32228>>>>>            for itm# from first_item# to last_item#
32234>>>>>>
32234>>>>>              send display.iii itm# day# activate#
32235>>>>>              increment day#
32236>>>>>            loop
32237>>>>>>
32237>>>>>            ifnot activate# begin
32239>>>>>              for itm# from (last_item#+1) to 41
32245>>>>>>
32245>>>>>                send display.iii itm# 0 0
32246>>>>>              loop
32247>>>>>>
32247>>>>>            end
32247>>>>>>
32247>>>>>          end_procedure
32248>>>>>        end_object
32249>>>>>        object txt_month is a calendar.textbox
32251>>>>>          set size to 12 27
32252>>>>>          set location to 25 185
32253>>>>>          set value to t.calendar.month
32254>>>>>        end_object
32255>>>>>        object btn1 is a button
32257>>>>>          set size to 12 12
32258>>>>>          set location to 40 185
32259>>>>>          on_item "" send prev_month
32260>>>>>          set bitmap to "prev.bmp"
32261>>>>>          procedure switch_back
32263>>>>>            send display_main
32264>>>>>          end_procedure
32265>>>>>        end_object
32266>>>>>        object btn2 is a button
32268>>>>>          set size to 12 12
32269>>>>>          set location to 40 200
32270>>>>>          on_item "" send next_month
32271>>>>>          set bitmap to "next.bmp"
32272>>>>>        end_object
32273>>>>>        object txt_year is a calendar.textbox
32275>>>>>          set size to 12 27
32276>>>>>          set location to 70 185
32277>>>>>          set value to t.calendar.year
32278>>>>>        end_object
32279>>>>>        object btn3 is a button
32281>>>>>          set size to 12 12
32282>>>>>          set location to 85 185
32283>>>>>          on_item "" send prev_year
32284>>>>>          set bitmap to "prev.bmp"
32285>>>>>        end_object
32286>>>>>        object btn4 is a button
32288>>>>>          set size to 12 12
32289>>>>>          set location to 85 200
32290>>>>>          on_item "" send next_year
32291>>>>>          set bitmap to "next.bmp"
32292>>>>>        end_object
32293>>>>>      end_object
32294>>>>>      object btn5 is a button
32296>>>>>        set size to 14 60
32297>>>>>        set location to 129 115
32298>>>>>        on_item t.calendar.ok send move_value_out_ok
32299>>>>>      end_object
32300>>>>>      object btn6 is a button
32302>>>>>        set size to 14 60
32303>>>>>        set location to 129 182
32304>>>>>        on_item t.calendar.cancel send cancel
32305>>>>>        procedure switch
32307>>>>>          send display_main
32308>>>>>        end_procedure
32309>>>>>      end_object
32310>>>>>      procedure next_year
32312>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32313>>>>>        send display_main
32314>>>>>      end_procedure
32315>>>>>      procedure prev_year
32317>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32318>>>>>        send display_main
32319>>>>>      end_procedure
32320>>>>>      procedure next_month
32322>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32323>>>>>        send display_main
32324>>>>>      end_procedure
32325>>>>>      procedure prev_month
32327>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32328>>>>>        send display_main
32329>>>>>      end_procedure
32330>>>>>      procedure next_week
32332>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,1))
32333>>>>>        send display_main
32334>>>>>      end_procedure
32335>>>>>      procedure prev_week
32337>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,-1))
32338>>>>>        send display_main
32339>>>>>      end_procedure
32340>>>>>      procedure next_day
32342>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,1))
32343>>>>>        send display_main
32344>>>>>      end_procedure
32345>>>>>      procedure prev_day
32347>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,-1))
32348>>>>>        send display_main
32349>>>>>      end_procedure
32350>>>>>      procedure go_today
32352>>>>>        local date date#
32353>>>>>        sysdate4 date#
32354>>>>>        set p_current_date to date#
32355>>>>>        send display_main
32356>>>>>      end_procedure
32357>>>>>      property integer invoking_object_id public 0
32359>>>>>      procedure OnChange date date#
32361>>>>>        local integer focus# dm#
32362>>>>>        get invoking_object_id to focus#
32363>>>>>        if focus# gt desktop begin
32365>>>>>          get delegation_mode of focus# to dm#
32366>>>>>          set delegation_mode of focus# to no_delegate_or_error
32367>>>>>          send NotifyPopupCalendarChange to focus# date#
32368>>>>>          set delegation_mode of focus# to dm#
32369>>>>>        end
32369>>>>>>
32369>>>>>      end_procedure
32370>>>>>      procedure display
32372>>>>>        local integer date# month# year#
32373>>>>>        get p_current_date to date#
32374>>>>>        send OnChange date#
32375>>>>>        move (DateSegment(date#,DS_YEAR)) to year#
32376>>>>>        move (DateSegment(date#,DS_MONTH)) to month#
32377>>>>>        if (p_current_year(current_object)<>year# or p_current_month(current_object)<>month#) begin
32379>>>>>          set p_current_year to year#
32380>>>>>          set p_current_month to month#
32381>>>>>          set value to (t.calendar.calendar_popup+", "+MonthName(month#))
32382>>>>>          send display to (textbox_year(cont3d(current_object)))
32383>>>>>          send display to (weeknumber_header(cont3d(current_object)))
32384>>>>>          send display to (days_grid(cont3d(current_object))) 0
32385>>>>>        end
32385>>>>>>
32385>>>>>      end_procedure
32386>>>>>      procedure display_main
32388>>>>>        send display
32389>>>>>        send display to (days_grid(cont3d(current_object))) 1
32390>>>>>      end_procedure
32391>>>>>      procedure popup_no_export
32393>>>>>        set pExportState to false
32394>>>>>        send popup
32395>>>>>        set pExportState to true
32396>>>>>      end_procedure
32397>>>>>
32397>>>>>      procedure popup_group
32399>>>>>        local integer focus#
32400>>>>>        local date date#
32400>>>>>        move (focus(desktop)) to focus#
32401>>>>>        set invoking_object_id to focus#
32402>>>>>        get value of focus# item current to date#
32403>>>>>        ifnot (integer(date#)) move (dSysdate()) to date#
32406>>>>>        move (Date2to4(date#)) to date#
32407>>>>>        set p_current_date to date#
32408>>>>>        send display
32409>>>>>        forward send popup_group
32411>>>>>        send display to (days_grid(cont3d(current_object))) 1
32412>>>>>      end_procedure
32413>>>>>
32413>>>>>      procedure move_value_out
32415>>>>>        local integer focus# dm# margin# datatype#
32416>>>>>        if (pExportState(current_object)) begin
32418>>>>>          get invoking_object_id to focus#
32419>>>>>          if focus# gt desktop begin
32421>>>>>            get delegation_mode of focus# to dm#
32422>>>>>            set delegation_mode of focus# to no_delegate_or_error
32423>>>>>            send NotifyPopupCalendarSelect to focus# (p_current_date(current_object))
32424>>>>>            get form_margin of focus# item current to margin#
32425>>>>>            get form_datatype of focus# item current to datatype#
32426>>>>>            set delegation_mode of focus# to dm#
32427>>>>>            if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to (p_current_date(current_object))
32430>>>>>            else             set value of focus# item current to (Date4to2(p_current_date(current_object)))
32432>>>>>            set item_changed_state of focus# item current to true
32433>>>>>          end
32433>>>>>>
32433>>>>>        end
32433>>>>>>
32433>>>>>      end_procedure
32434>>>>>
32434>>>>>      procedure move_value_out_ok
32436>>>>>        send move_value_out
32437>>>>>        send deactivate
32438>>>>>      end_procedure
32439>>>>>
32439>>>>>      procedure request_popup
32441>>>>>        local integer focus# type# dm#
32442>>>>>        move (focus(desktop)) to focus#
32443>>>>>        if focus# gt desktop begin
32445>>>>>          get delegation_mode of focus# to dm#
32446>>>>>          set delegation_mode of focus# to no_delegate_or_error
32447>>>>>          get form_datatype of focus# item current to type#
32448>>>>>          if (type#=date_window or type#=mask_date_window) send popup
32451>>>>>          set delegation_mode of focus# to dm#
32452>>>>>        end
32452>>>>>>
32452>>>>>      end_procedure
32453>>>>>    end_object
32454>>>>>  end_desktop_section
32456>>>>>  // If the procedure below was not defined "for BaseClass" its symbolic
32456>>>>>  // substitute would become negative (because located on the desktop). This
32456>>>>>  // would result in the toolbar object not being able to handle it. Therefore:
32456>>>>>  procedure request_popup_calendar for BaseClass
32457>>>>>    send request_popup to (popup_calendar(current_object))
32458>>>>>  end_procedure
32459>>>>>  procedure popup_calendar_no_export
32460>>>>>    send popup_no_export to (popup_calendar(current_object))
32461>>>>>  end_procedure
32462>>>>>  register_procedure Add_Toolbar_Button_Bitmap string bmp# string Tip# string StHlp# integer msg# integer obj#
32462>>>>>  procedure Add_Calendar_tbButton integer oTb#
32463>>>>>    send Add_Toolbar_Button_Bitmap to oTb# "DfCalend.bmp" t.calendar.calendar_popup t.calendar.Activate msg_request_popup_calendar
32464>>>>>  end_procedure
32465>>>>> function s.calendar returns integer // Backwards compatible!!
32466>>>>>   function_return (popup_calendar(current_object))
32467>>>>> end_function
32468>>>>>
32468>>>>>// Karl,
32468>>>>>// Structure is as follows,
32468>>>>>//
32468>>>>>// //put this code in the top portion of the view code or in the program
32468>>>>>// code.
32468>>>>>//
32468>>>>>// Type SystemTime
32468>>>>>//   field SystemTime.iYear As Word
32468>>>>>//   field SystemTime.iMonth As Word
32468>>>>>//   field SystemTime.iDayOfWeek As Word
32468>>>>>//   field SystemTime.iDay As Word
32468>>>>>//   field SystemTime.iHour As Word
32468>>>>>//   field SystemTime.iMinute As Word
32468>>>>>//   field SystemTime.iSecond As Word
32468>>>>>//   field SystemTime.iMilliseconds As Word
32468>>>>>// End_Type
32468>>>>>//
32468>>>>>// external_function GetSystemTime "GetSystemTime" kernel32.dll Pointer lpGST Returns VOID_TYPE
32468>>>>>//
32468>>>>>// //put this code in an onClick or wherever
32468>>>>>// procedure onclick
32468>>>>>//   local integer iRetVal
32468>>>>>//   local string TimeData
32468>>>>>//   local pointer GST
32468>>>>>//
32468>>>>>//   ZeroType SystemTime to TimeData
32468>>>>>//   getAddress from TimeData to GST
32468>>>>>//
32468>>>>>//   move (GetSystemTime(GST)) to iRetVal
32468>>>>>// end_procedure
32468>>>>>//
32468>>>>>// To extract the data from the Structure after calling the function use
32468>>>>>// the getbuff command as follows:
32468>>>>>//
32468>>>>>// getbuff from TimeData as SystemTime.IVAL to var
32468>>>>>//
32468>>>>>// where IVAL is one of the vars such as iYear or iDay, etc.
32468>>>>>//
32468>>>>>// OLIVER NELSON
32468>>>>>//
32468>>>>>//
32468>>>
32468>>>//AB-StoreTopEnd
32468>>>
32468>>>//AB-IgnoreStart
32468>>>
32468>>>Use DFAllEnt.pkg
32468>>>
32468>>>
32468>>>//AB-IgnoreEnd
32468>>>
32468>>>CD_Popup_Object oCalendar is a dbModalPanel
32487>>>
32487>>>    //AB-StoreTopStart
32487>>>    on_key kcancel           send cancel
32488>>>    //AB-StoreTopEnd
32488>>>
32488>>>    Set Border_Style to Border_Normal
32489>>>    Set Caption_Bar to FALSE
32490>>>    Set Label to "Ÿ­¢ àì, 2001"
32491>>>    Set Size to 98 123
32492>>>    Set Location to 10 22
32493>>>    Set Color to clWhite
32494>>>
32494>>>    //AB-DDOStart
32494>>>
32494>>>
32494>>>    //AB-DDOEnd
32494>>>
32494>>>    Object Container3d1 is a Container3d
32496>>>        Set Size to 88 135
32497>>>        Set Location to -2 -1
32498>>>        Set Color to clWhite
32499>>>        Set Border_Style to Border_None
32500>>>        Object Grid2 is a Grid
32502>>>
32502>>>            //AB-StoreTopStart
32502>>>            property date    p_current_date     public 0
32504>>>            property integer p_current_year     public -1
32506>>>            property integer p_current_month    public -1
32508>>>            property integer p_selected_day     public -1
32510>>>            property integer pExportState       public 1
32512>>>            property integer invoking_object_id public 0
32514>>>            
32514>>>            Set Border_Style To BORDER_NONE
32515>>>            Set header_visible_state To False
32516>>>            set select_mode to no_select
32517>>>            Set Gridline_mode To GRID_VISIBLE_NONE
32518>>>            
32518>>>            on_key Key_F1 Send Help
32519>>>            on_key key_ctrl+key_pgup send prev_year
32520>>>            on_key key_ctrl+key_pgdn send next_year
32521>>>            on_key          key_pgup send prev_month
32522>>>            on_key          key_pgdn send next_month
32523>>>            on_key key_enter         send move_value_out
32524>>>            on_key key_ctrl+key_d    send go_today
32525>>>            
32525>>>            //AB-StoreTopEnd
32525>>>
32525>>>            Set Color to clWhite
32526>>>            Set CurrentCellColor to clWhite
32527>>>            Set CurrentCellTextColor to clWhite
32528>>>            Set Size to 61 145
32529>>>            Set Location to 30 1
32530>>>            Set Resize_Column_state to FALSE
32531>>>
32531>>>            Set Line_Width to 7 0
32532>>>
32532>>>            Set Form_Width    item 0 to 18
32533>>>            Set Header_Label  item 0 to "­"
32534>>>            
32534>>>            Set Form_Width    item 1 to 18
32535>>>            Set Header_Label  item 1 to "‚â"
32536>>>            
32536>>>            Set Form_Width    item 2 to 18
32537>>>            Set Header_Label  item 2 to "‘à"
32538>>>            
32538>>>            Set Form_Width    item 3 to 18
32539>>>            Set Header_Label  item 3 to "—â"
32540>>>            
32540>>>            Set Form_Width    item 4 to 18
32541>>>            Set Header_Label  item 4 to "â"
32542>>>            
32542>>>            Set Form_Width    item 5 to 18
32543>>>            Set Header_Label  item 5 to "‘¡"
32544>>>            
32544>>>            Set Form_Width    item 6 to 18
32545>>>            Set Header_Label  item 6 to "‚á"
32546>>>            
32546>>>
32546>>>            //AB-StoreStart
32546>>>            
32546>>>            procedure go_today
32548>>>                Date date#
32549>>>                sysdate4 date#
32550>>>                set p_current_date to date#
32551>>>                Send Update_Calendar
32552>>>            end_procedure
32553>>>            
32553>>>            procedure next_month
32555>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32556>>>                Send Update_Calendar
32557>>>            end_procedure
32558>>>            
32558>>>            procedure prev_month
32560>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32561>>>                Send Update_Calendar
32562>>>            end_procedure
32563>>>            
32563>>>            procedure next_year
32565>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32566>>>                Send Update_Calendar
32567>>>            end_procedure
32568>>>            
32568>>>            procedure prev_year
32570>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32571>>>                Send Update_Calendar
32572>>>            end_procedure
32573>>>            
32573>>>            Procedure Activate
32575>>>                Date date#
32576>>>                Forward Send Activate
32578>>>                Set current_item to (p_selected_day(Self))
32579>>>            End_Procedure
32580>>>            
32580>>>            Procedure Update_Calendar
32582>>>                Set Dynamic_Update_State To False
32583>>>                send Fill_List
32584>>>                Set Dynamic_Update_State To True
32585>>>                // Send Update_Label
32585>>>                Set current_item to (p_selected_day(Self))
32586>>>                Send Date_Changing to (oYear(Container3d2(self)))
32587>>>                Send Date_Changing to (oMonth(Container3d2(self)))
32588>>>            End_Procedure
32589>>>            
32589>>>            Procedure Fill_List
32591>>>                Integer iFor prevdate# date# first_item# last_item# day# prev_last# nextdate# next_first#
32592>>>                Integer cur_year# cur_month# cur_day# sel_month# sel_day# sel_year#
32592>>>                Date dToday
32592>>>                Send Delete_Data
32593>>>            
32593>>>                Get p_current_date to date#
32594>>>            
32594>>>                SysDate4 dToday
32595>>>                move (DateSegment(dToday,DS_DAY)) to cur_day#
32596>>>                move (DateSegment(dToday,DS_MONTH)) to cur_month#
32597>>>                move (DateSegment(dToday,DS_YEAR)) to cur_year#
32598>>>            
32598>>>                move (DateSegment(date#,DS_DAY)) to sel_day#
32599>>>                move (DateSegment(date#,DS_MONTH)) to sel_month#
32600>>>                move (DateSegment(date#,DS_YEAR)) to sel_year#
32601>>>                Set p_current_month To sel_month#
32602>>>                Set p_current_year To sel_year#
32603>>>            
32603>>>                move (FirstDayInMonth(date#)) to date#
32604>>>                move (DateDayNumber(date#)-1) to first_item#
32605>>>                move (LastDayInMonth(date#)-date#+first_item#) to last_item#
32606>>>                move (DateIncrement(date#,DS_Month,-1)) To prevdate#
32607>>>                move (DateSegment((LastDayInMonth(prevdate#)),DS_DAY)) to prev_last#
32608>>>            
32608>>>                If (first_item# > 0) Begin
32610>>>                    Move (first_item#-1) to day#
32611>>>                    For iFor from 0 to (first_item#-1)
32617>>>>
32617>>>                        Send Add_Item msg_move_value_out (prev_last#-day#)
32618>>>                        Set Entry_State Item iFor To False
32619>>>                        Set ItemTextColor Item iFor To clGray
32620>>>                        Decrement day#
32621>>>                    Loop
32622>>>>
32622>>>                End
32622>>>>
32622>>>            
32622>>>                Move 1 To day#
32623>>>                For iFor from first_item# to last_item#
32629>>>>
32629>>>                    Send Add_Item Msg_Move_Value_Out day#
32630>>>                    Set Entry_State Item iFor To False
32631>>>                    If ((cur_month# eq sel_month#)and(cur_year# eq sel_year#)and(Day# eq cur_day#)) Set Form_Bitmap Item iFor To "cdate.bmp"
32634>>>                    If Day# eq sel_day# Set p_selected_day To iFor
32637>>>                    Set Form_justification_mode Item iFor To FORM_DISPLAYRIGHT
32638>>>                    Set form_datatype item iFor To mask_numeric_window
32639>>>                    Set form_Mask item iFor To "## "
32640>>>                    Increment day#
32641>>>                Loop
32642>>>>
32642>>>            
32642>>>                move (DateIncrement(date#,DS_Month,1)) To nextdate#
32643>>>                move (DateSegment((LastDayInMonth(nextdate#)),DS_DAY)) to next_first#
32644>>>            
32644>>>                If (last_item# < 41) Begin
32646>>>                    Move 1 to day#
32647>>>                    For iFor from (last_item#+1) to 41
32653>>>>
32653>>>                        Send Add_Item msg_move_value_out day#
32654>>>                        Set Entry_State Item iFor To False
32655>>>                        Set ItemTextColor Item iFor To clGray
32656>>>                        Increment day#
32657>>>                    Loop
32658>>>>
32658>>>                End
32658>>>>
32658>>>            
32658>>>            End_Procedure
32659>>>            
32659>>>            Procedure Help
32661>>>                Send Info_Box ("<Up>, <Dn>, <Lft>, <Rgt> - select date.\n<PgUp>, <PgDn> - select month.\n<Ctrl>+<D> - set current date.\n<Ctrl>+<PgUp>, <PgDn> - Select year.\n\n(c) 2001, SCR. Special thanks to Sture Andersen.") ("Help on Calendar")
32662>>>            End_Procedure
32663>>>            
32663>>>            procedure mouse_click integer window integer char_pos
32665>>>                Send Move_Value_Out
32666>>>                forward send mouse_click window char_pos
32668>>>            end_procedure
32669>>>            
32669>>>            Procedure Move_Value_Out
32671>>>                Integer iYear iMonth iDay iItm
32672>>>                Date Date# next_date# prev_date#
32672>>>                Get Current_Item To iItm
32673>>>                If (pExportState(Self)) Begin
32675>>>                    Get Value Item iItm To iDay
32676>>>                    Get p_current_month to iMonth
32677>>>                    Get p_current_year  to iYear
32678>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32679>>>            
32679>>>                    If ((iItm>27)and(iDay<15)) Begin
32681>>>                        Move (DateCompose(1,iMonth,iYear)) To next_date#
32682>>>                        move (DateIncrement(next_date#,DS_Month,1)) To next_date#
32683>>>                        move (DateSegment(next_date#,DS_MONTH)) to iMonth
32684>>>                        move (DateSegment(next_date#,DS_YEAR)) to iYear
32685>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32686>>>                    End
32686>>>>
32686>>>                    If ((iItm<7)and(iDay>20)) Begin
32688>>>                        Move (DateCompose(1,iMonth,iYear)) To prev_date#
32689>>>                        move (DateIncrement(prev_date#,DS_Month,-1)) To prev_date#
32690>>>                        move (DateSegment(prev_date#,DS_MONTH)) to iMonth
32691>>>                        move (DateSegment(prev_date#,DS_YEAR)) to iYear
32692>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32693>>>                    End
32693>>>>
32693>>>            
32693>>>                    Send Export_Date date#
32694>>>                End
32694>>>>
32694>>>            End_Procedure
32695>>>            
32695>>>            Procedure Export_Date date date#
32697>>>                local integer focus# dm# margin# datatype#
32698>>>                get invoking_object_id to focus#
32699>>>            
32699>>>                if focus# gt desktop begin
32701>>>                     get delegation_mode of focus# to dm#
32702>>>                     set delegation_mode of focus# to no_delegate_or_error
32703>>>                     get form_margin of focus# item current to margin#
32704>>>                     get form_datatype of focus# item current to datatype#
32705>>>                     set delegation_mode of focus# to dm#
32706>>>                     if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to date#
32709>>>                     else             set value of focus# item current to (Date4to2(date#))
32711>>>                     set item_changed_state of focus# item current to true
32712>>>                end
32712>>>>
32712>>>                Send Close_Calendar
32713>>>            End_Procedure
32714>>>            //AB-StoreEnd
32714>>>
32714>>>        End_Object    // Grid2
32715>>>
32715>>>        Object Textbox2 is a Textbox
32717>>>            Set Label to "­"
32718>>>            Set Auto_Size_State to FALSE
32719>>>            Set Transparent_State to TRUE
32720>>>            Set Color to clWhite
32721>>>            Set TextColor to clNavy
32722>>>            Set Location to 19 4
32723>>>            Set Size to 10 15
32724>>>
32724>>>            //AB-StoreStart
32724>>>                                        
32724>>>            Set Label To (left(t.calendar.Monday,2))
32725>>>            //AB-StoreEnd
32725>>>
32725>>>        End_Object    // Textbox2
32726>>>
32726>>>        Object Textbox3 is a Textbox
32728>>>            Set Label to "‚â"
32729>>>            Set Auto_Size_State to FALSE
32730>>>            Set Transparent_State to TRUE
32731>>>            Set Color to clWhite
32732>>>            Set TextColor to clNavy
32733>>>            Set Location to 19 22
32734>>>            Set Size to 10 12
32735>>>
32735>>>            //AB-StoreStart
32735>>>                                        
32735>>>            Set Label To (left(t.calendar.Tuesday,2))
32736>>>            //AB-StoreEnd
32736>>>
32736>>>        End_Object    // Textbox3
32737>>>
32737>>>        Object Textbox4 is a Textbox
32739>>>            Set Label to "‘à"
32740>>>            Set Auto_Size_State to FALSE
32741>>>            Set Transparent_State to TRUE
32742>>>            Set Color to clWhite
32743>>>            Set TextColor to clNavy
32744>>>            Set Location to 19 39
32745>>>            Set Size to 10 15
32746>>>
32746>>>            //AB-StoreStart
32746>>>                                        
32746>>>            Set Label To (left(t.calendar.Wednesday,2))
32747>>>            //AB-StoreEnd
32747>>>
32747>>>        End_Object    // Textbox4
32748>>>
32748>>>        Object Textbox5 is a Textbox
32750>>>            Set Label to "—â"
32751>>>            Set Auto_Size_State to FALSE
32752>>>            Set Transparent_State to TRUE
32753>>>            Set Color to clWhite
32754>>>            Set TextColor to clNavy
32755>>>            Set Location to 19 57
32756>>>            Set Size to 10 17
32757>>>
32757>>>            //AB-StoreStart
32757>>>                                        
32757>>>            Set Label To (left(t.calendar.Thursday,2))
32758>>>            //AB-StoreEnd
32758>>>
32758>>>        End_Object    // Textbox5
32759>>>
32759>>>        Object Textbox6 is a Textbox
32761>>>            Set Label to "â"
32762>>>            Set Auto_Size_State to FALSE
32763>>>            Set Transparent_State to TRUE
32764>>>            Set Color to clWhite
32765>>>            Set TextColor to clNavy
32766>>>            Set Location to 19 76
32767>>>            Set Size to 10 17
32768>>>
32768>>>            //AB-StoreStart
32768>>>                                        
32768>>>            Set Label To (left(t.calendar.Friday,2))
32769>>>            //AB-StoreEnd
32769>>>
32769>>>        End_Object    // Textbox6
32770>>>
32770>>>        Object Textbox7 is a Textbox
32772>>>            Set Label to "‘¡"
32773>>>            Set Auto_Size_State to FALSE
32774>>>            Set Transparent_State to TRUE
32775>>>            Set Color to clWhite
32776>>>            Set TextColor to clNavy
32777>>>            Set Location to 19 91
32778>>>            Set Size to 10 18
32779>>>
32779>>>            //AB-StoreStart
32779>>>                                        
32779>>>            Set Label To (left(t.calendar.Saturday,2))
32780>>>            //AB-StoreEnd
32780>>>
32780>>>        End_Object    // Textbox7
32781>>>
32781>>>        Object Textbox8 is a Textbox
32783>>>            Set Label to "‚á"
32784>>>            Set Auto_Size_State to FALSE
32785>>>            Set Transparent_State to TRUE
32786>>>            Set Color to clWhite
32787>>>            Set TextColor to clNavy
32788>>>            Set Location to 19 109
32789>>>            Set Size to 10 17
32790>>>
32790>>>            //AB-StoreStart
32790>>>                                        
32790>>>            Set Label To (left(t.calendar.Sunday,2))
32791>>>            //AB-StoreEnd
32791>>>
32791>>>        End_Object    // Textbox8
32792>>>
32792>>>        Object LineControl1 is a LineControl
32794>>>            Set Line_Style to lnSINGLE
32795>>>            Set Size to 1 116
32796>>>            Set Location to 28 4
32797>>>
32797>>>            //AB-StoreStart
32797>>>                                        
32797>>>            //AB-StoreEnd
32797>>>
32797>>>        End_Object    // LineControl1
32798>>>
32798>>>        Object Container3d2 is a Container3d
32800>>>            Set Size to 18 131
32801>>>            Set Location to 1 1
32802>>>            Set Color to clNavy
32803>>>            Set Border_Style to Border_None
32804>>>            Object oRght is a BitmapContainer
32806>>>                Set Size to 10 14
32807>>>                Set Location to 4 105
32808>>>                Set Bitmap to "rght.bmp"
32809>>>                Set Border_Style to Border_None
32810>>>
32810>>>                //AB-StoreStart
32810>>>                Procedure Mouse_Down
32812>>>                    Send Next_Month to Grid2
32813>>>                End_Procedure
32814>>>                //AB-StoreEnd
32814>>>
32814>>>            End_Object    // oRght
32815>>>
32815>>>            Object oLeft is a BitmapContainer
32817>>>                Set Size to 10 14
32818>>>                Set Location to 4 3
32819>>>                Set Bitmap to "lft.bmp"
32820>>>                Set Border_Style to Border_None
32821>>>
32821>>>                //AB-StoreStart
32821>>>                Procedure Mouse_Down
32823>>>                    Send Prev_Month to Grid2
32824>>>                End_Procedure
32825>>>                //AB-StoreEnd
32825>>>
32825>>>            End_Object    // oLeft
32826>>>
32826>>>            Object oMonth is a Textbox
32828>>>
32828>>>                //AB-StoreTopStart
32828>>>                Property integer piSelected_Month public 0
32830>>>                //AB-StoreTopEnd
32830>>>
32830>>>                Set Label to "January"
32831>>>                Set Auto_Size_State to FALSE
32832>>>                Set Transparent_State to TRUE
32833>>>                Set Color to clWhite
32834>>>                Set TextColor to clWhite
32835>>>                Set Location to 4 23
32836>>>                Set Size to 10 43
32837>>>                Set FontWeight to 800
32838>>>                Set Justification_Mode to jMode_Center
32839>>>
32839>>>                //AB-StoreStart
32839>>>                                    
32839>>>                Procedure Mouse_Down
32841>>>                    Integer iState
32842>>>                    Get Visible_State of oSelectYear to iState
32843>>>                    If (iState) Send OnKillFocus to oSelectYear
32846>>>                    Send Popup to oSelectMonth
32847>>>                End_Procedure
32848>>>                
32848>>>                Procedure pSelectJan
32850>>>                    Set Label to t.calendar.january
32851>>>                    Set piSelected_Month to 1
32852>>>                    Send Adjust_Calendar
32853>>>                End_Procedure
32854>>>                Procedure pSelectFeb
32856>>>                    Set Label to t.calendar.february
32857>>>                    Set piSelected_Month to 2
32858>>>                    Send Adjust_Calendar
32859>>>                End_Procedure
32860>>>                Procedure pSelectMar
32862>>>                    Set Label to t.calendar.march
32863>>>                    Set piSelected_Month to 3
32864>>>                    Send Adjust_Calendar
32865>>>                End_Procedure
32866>>>                Procedure pSelectApr
32868>>>                    Set Label to t.calendar.april
32869>>>                    Set piSelected_Month to 4
32870>>>                    Send Adjust_Calendar
32871>>>                End_Procedure
32872>>>                Procedure pSelectMay
32874>>>                    Set Label to t.calendar.may
32875>>>                    Set piSelected_Month to 5
32876>>>                    Send Adjust_Calendar
32877>>>                End_Procedure
32878>>>                Procedure pSelectJun
32880>>>                    Set Label to t.calendar.june
32881>>>                    Set piSelected_Month to 6
32882>>>                    Send Adjust_Calendar
32883>>>                End_Procedure
32884>>>                Procedure pSelectJul
32886>>>                    Set Label to t.calendar.july
32887>>>                    Set piSelected_Month to 7
32888>>>                    Send Adjust_Calendar
32889>>>                End_Procedure
32890>>>                Procedure pSelectAug
32892>>>                    Set Label to t.calendar.august
32893>>>                    Set piSelected_Month to 8
32894>>>                    Send Adjust_Calendar
32895>>>                End_Procedure
32896>>>                Procedure pSelectSep
32898>>>                    Set Label to t.calendar.september
32899>>>                    Set piSelected_Month to 9
32900>>>                    Send Adjust_Calendar
32901>>>                End_Procedure
32902>>>                Procedure pSelectOct
32904>>>                    Set Label to t.calendar.october
32905>>>                    Set piSelected_Month to 10
32906>>>                    Send Adjust_Calendar
32907>>>                End_Procedure
32908>>>                Procedure pSelectNov
32910>>>                    Set Label to t.calendar.november
32911>>>                    Set piSelected_Month to 11
32912>>>                    Send Adjust_Calendar
32913>>>                End_Procedure
32914>>>                Procedure pSelectDec
32916>>>                    Set Label to t.calendar.december
32917>>>                    Set piSelected_Month to 12
32918>>>                    Send Adjust_Calendar
32919>>>                End_Procedure
32920>>>                
32920>>>                Object oSelectMonth is a FloatingPopupMenu
32922>>>                    Send Add_Item msg_pSelectJan t.calendar.january
32923>>>                    Send Add_Item msg_pSelectFeb t.calendar.february
32924>>>                    Send Add_Item msg_pSelectMar t.calendar.march
32925>>>                    Send Add_Item msg_pSelectApr t.calendar.april
32926>>>                    Send Add_Item msg_pSelectMay t.calendar.may
32927>>>                    Send Add_Item msg_pSelectJun t.calendar.june
32928>>>                    Send Add_Item msg_pSelectJul t.calendar.july
32929>>>                    Send Add_Item msg_pSelectAug t.calendar.august
32930>>>                    Send Add_Item msg_pSelectSep t.calendar.september
32931>>>                    Send Add_Item msg_pSelectOct t.calendar.october
32932>>>                    Send Add_Item msg_pSelectNov t.calendar.november
32933>>>                    Send Add_Item msg_pSelectDec t.calendar.december
32934>>>                End_Object
32935>>>                
32935>>>                Procedure Adjust_Calendar
32937>>>                    Date date#
32938>>>                    Integer iDay iMonth iYear iItm
32938>>>                    Set Visible_State to false
32939>>>                    Set Visible_State to true
32940>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
32941>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
32942>>>                    Get piSelected_Month to iMonth
32943>>>                    Get Label of oYear to iYear
32944>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32945>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
32946>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
32947>>>                End_Procedure
32948>>>                
32948>>>                Procedure Activating
32950>>>                    Forward Send Activating
32952>>>                    Send Date_Changing
32953>>>                End_Procedure
32954>>>                
32954>>>                Procedure Date_Changing
32956>>>                    Set Visible_State to false
32957>>>                    Set Label to (MonthName(p_current_Month(Grid2(Container3D1(Self)))))
32958>>>                    Set piSelected_Month to (p_current_Month(Grid2(Container3D1(Self))))
32959>>>                    Set Visible_State to true
32960>>>                End_Procedure
32961>>>                
32961>>>                
32961>>>                //AB-StoreEnd
32961>>>
32961>>>            End_Object    // oMonth
32962>>>
32962>>>            Object oYear is a Textbox
32964>>>                Set Label to "2001"
32965>>>                Set Transparent_State to TRUE
32966>>>                Set Color to clWhite
32967>>>                Set TextColor to clWhite
32968>>>                Set Location to 4 77
32969>>>                Set Size to 10 18
32970>>>                Set FontWeight to 800
32971>>>
32971>>>                //AB-StoreStart
32971>>>                                                    
32971>>>                Procedure Mouse_Down
32973>>>                    String sVal
32974>>>                    Get Label to sVal
32975>>>                    Set Value of oSelectYear item 0 to sVal
32976>>>                    Set Visible_State of oSelectYear to True
32977>>>                    Send Activate to (oSelectYear(Self))
32978>>>                End_Procedure
32979>>>                
32979>>>                Procedure Activating
32981>>>                    Forward Send Activating
32983>>>                    Send Date_Changing
32984>>>                End_Procedure
32985>>>                
32985>>>                Procedure Date_Changing
32987>>>                    Set Visible_State to false
32988>>>                    Set Label to (String(p_current_Year(Grid2(Container3D1(Self)))))
32989>>>                    Set Visible_State to true
32990>>>                End_Procedure
32991>>>                //AB-StoreEnd
32991>>>
32991>>>            End_Object    // oYear
32992>>>
32992>>>            Object oSelectYear is a Form
32994>>>
32994>>>                //AB-StoreTopStart
32994>>>                Set Visible_State To False
32995>>>                //AB-StoreTopEnd
32995>>>
32995>>>                Set Size to 10 24
32996>>>                Set Location to 4 75
32997>>>                Set Color to clWhite
32998>>>                Set TextColor to clNavy
32999>>>                Set Form_Border Item 0 to Border_Normal
33000>>>
33000>>>                //AB-StoreStart
33000>>>                                                    
33000>>>                On_Key Key_Enter Send OnKillFocus
33001>>>                On_Key Key_Escape Send OnKillFocus
33002>>>                
33002>>>                Procedure SetFontWeight
33004>>>                    Set Form_FontWeight item 0 to 800
33005>>>                End_Procedure
33006>>>                
33006>>>                Procedure OnKillFocus
33008>>>                    String sVal
33009>>>                    Integer iMonth iDay iYear iItm
33009>>>                    Date date#
33009>>>                    Get Value item 0 to sVal
33010>>>                    Set Visible_State of oYear to false
33011>>>                    Set Label of oYear to sVal
33012>>>                    Set Visible_State of oYear to true
33013>>>                    Set Visible_State to false
33014>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
33015>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
33016>>>                    Get piSelected_Month of oMonth to iMonth
33017>>>                    Get Value item 0 to iYear
33018>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
33019>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
33020>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
33021>>>                End_Procedure
33022>>>                
33022>>>                Send SetFontWeight
33023>>>                //AB-StoreEnd
33023>>>
33023>>>            End_Object    // oSelectYear
33024>>>
33024>>>
33024>>>            //AB-StoreStart
33024>>>                            
33024>>>            Procedure Mouse_Down
33026>>>                Integer iState
33027>>>                Get Visible_State of oSelectYear to iState
33028>>>                If (iState) Send OnKillFocus to oSelectYear
33031>>>            End_Procedure
33032>>>            
33032>>>            //AB-StoreEnd
33032>>>
33032>>>        End_Object    // Container3d2
33033>>>
33033>>>
33033>>>        //AB-StoreStart
33033>>>                            
33033>>>        //AB-StoreEnd
33033>>>
33033>>>    End_Object    // Container3d1
33034>>>
33034>>>    Object BitmapContainer3 is a BitmapContainer
33036>>>        Set Size to 9 19
33037>>>        Set Location to 88 3
33038>>>        Set Color to clWhite
33039>>>        Set Bitmap to "cdate.bmp"
33040>>>        Set Border_Style to Border_None
33041>>>
33041>>>        //AB-StoreStart
33041>>>        Procedure Mouse_Down
33043>>>            Send go_today to (Grid2(Container3d1(Self)))
33044>>>            Send Adjust_Label to oToday
33045>>>        End_Procedure
33046>>>        //AB-StoreEnd
33046>>>
33046>>>    End_Object    // BitmapContainer3
33047>>>
33047>>>    Object oToday is a Textbox
33049>>>        Set Label to "Today: 01.01.2001"
33050>>>        Set Auto_Size_State to FALSE
33051>>>        Set Color to clWhite
33052>>>        Set Location to 88 22
33053>>>        Set Size to 8 73
33054>>>        Set FontWeight to 800
33055>>>
33055>>>        //AB-StoreStart
33055>>>        Procedure Mouse_Down
33057>>>            Send go_today to (Grid2(Container3d1(Self)))
33058>>>            Send Adjust_Label
33059>>>        End_Procedure
33060>>>        
33060>>>        Procedure Adjust_Label
33062>>>            date date#
33063>>>            SysDate4 date#
33064>>>            Set Visible_State To false
33065>>>            Set Label         to (t.calendar.today+": "+String(date#))
33066>>>            Set Visible_State To true
33067>>>        End_Procedure
33068>>>        
33068>>>        Procedure Activating
33070>>>            Forward Send Activating
33072>>>            Send Adjust_Label
33073>>>        End_Procedure
33074>>>        //AB-StoreEnd
33074>>>
33074>>>    End_Object    // oToday
33075>>>
33075>>>
33075>>>    //AB-StoreStart
33075>>>                
33075>>>    procedure popup
33077>>>        local integer focus# icItm iYear iMonth
33078>>>        local date date#
33078>>>        move (focus(desktop)) to focus#
33079>>>        set invoking_object_id of (Grid2(Container3d1(self))) to focus#
33080>>>        get value of focus# item current to date#
33081>>>        ifnot (integer(date#)) sysdate date#
33084>>>        move (Date2to4(date#)) to date#
33085>>>        set p_current_date of (Grid2(Container3d1(self))) to date#
33086>>>        send fill_list to (Grid2(Container3d1(self)))
33087>>>        move (DateSegment(date#,DS_YEAR)) to iYear
33088>>>        move (DateSegment(date#,DS_MONTH)) to iMonth
33089>>>        Set Label To (MonthName(iMonth)+', '+String(iYear))
33090>>>        forward send popup
33092>>>    end_procedure
33093>>>    
33093>>>    Procedure Close_Calendar
33095>>>        Send Exit
33096>>>    End_Procedure
33097>>>    //AB-StoreEnd
33097>>>
33097>>>CD_End_Object    // oCalendar
33099>>>>
33099>>>
33099>>>
33099>>>//AB-StoreStart
33099>>>    
33099>>>    
33099>>>//AB-StoreEnd
33099>>>
33099>>>//AB/ End_Object    // prj
33099>Use Dates.Utl
33099>Use Roundfn.Fnc
INCLUDING FILE: ROUNDFN.FNC
33099>>>// ===========================================================================
33099>>>//
33099>>>// The ROUND_NUMBER global function has been designed to return the rounded
33099>>>// value of a given 'numeric' argument at a specified rounding precision.
33099>>>//
33099>>>// ---------------------------------------------------------------------------
33099>>>// This version dispenses with the use of powers (10 ^ n) to perform the
33099>>>// necessary calculations.  It uses a string handling technique instead.
33099>>>// ---------------------------------------------------------------------------
33099>>>//
33099>>>// The function requires two arguments, as follows:-
33099>>>//
33099>>>// (a) The numeric value to be rounded, where the range of valid values is
33099>>>//     +/- 99,999,999,999,999.99999999.
33099>>>//
33099>>>// (b) The rounding precision required.  This must be an integer value in the
33099>>>//     range -13 to +8.  If a value outside this range is used, the nearest
33099>>>//     threshold value is substituted.
33099>>>//
33099>>>//     Values in the range +1 to +7 perform rounding on the decimal part of
33099>>>//     the number.  A value of +8 will perform no rounding at all.  A zero
33099>>>//     value will round to the nearest whole number.  Values -1 to -13 will
33099>>>//     round progressively to the left of the decimal point (a frequent
33099>>>//     requirement in financial reporting).
33099>>>//
33099>>>// If the result of the rounding produces a value outside the valid numeric
33099>>>// range (+/- 99,999,999,999,999.99999999) then a zero value is returned.
33099>>>//
33099>>>// Assumptions:-  The only assumptions made have been that the range of
33099>>>// numeric values and the limit of eight decimal places are unlikely to change
33099>>>// in the forseeable future.
33099>>>//
33099>>>// Examples:-
33099>>>//
33099>>>//  1st Argument      2nd Argument   Return Value
33099>>>//  ------------      ------------   ------------
33099>>>//  123456.87654321         8         123456.87654321
33099>>>//  123456.87654321         2         123456.88
33099>>>// -123456.87654321         2        -123456.88
33099>>>//  123456.98765432         0         123457
33099>>>// -123456.98765432        -1        -123460
33099>>>//  123456.98765432        -2         123500
33099>>>//  123456.98765432        -3         123000
33099>>>//  987654                 -4         990000
33099>>>//  987654                 -5        1000000
33099>>>//  987654                 -6        1000000
33099>>>//  987654                 -7              0
33099>>>//
33099>>>// ===========================================================================
33099>>>
33099>>>
33099>>>Function Round_Number GLOBAL number nVal integer iRnd returns Number
33100>>>
33100>>>  Local Number nAdj
33101>>>
33101>>>  Move 10000000000000 to nAdj
33102>>>
33102>>>  // If the rounding precision falls in the range 0 to 8, then return:-
33102>>>
33102>>>  If (iRnd >= 0) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 / (Number(Left(nAdj, ((iRnd + 1) ;      min 9)))) + nVal / (Number(Left(nAdj, (9 - (iRnd min 8))))) ;        * (Number(Left(nAdj, (9 - (iRnd min 8))))))
33105>>>
33105>>>  // Else, where the rounding precision is in the range -1 to -5, return:-
33105>>>
33105>>>  If (iRnd >= -5) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(Left(nAdj, (Abs(iRnd) + 9)))) ;        * (Number(Left(nAdj, (Abs(iRnd) + 9)))))
33108>>>
33108>>>  // Else, where the rounding precision is in the range -6 to -13, return:-
33108>>>
33108>>>  Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(nAdj)) / (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))) ;        * (Number(nAdj)) * (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))))
33109>>>
33109>>>End_Function
33110>Use Connect.Dg
INCLUDING FILE: CONNECT.DG
33110>>>//AB/ Project Connect
33110>>>//AB/ Object prj is a Dialog_Project
33110>>>//AB/     Set ProjectName to "Connect"
33110>>>//AB/     Set ProjectFileName to "Connect.dg"
33110>>>
33110>>>// Project Object Structure
33110>>>//   Connect is a BasicPanelSub
33110>>>//     BitmapContainer1 is a BitmapContainerSub
33110>>>//     Textbox5 is a TextBoxSub
33110>>>//     ComboForm2 is a ComboFormSub
33110>>>//     Textbox6 is a TextBoxSub
33110>>>//     Form4 is a FormSub
33110>>>//     Textbox7 is a TextBoxSub
33110>>>//     Form5 is a FormSub
33110>>>//     Textbox8 is a TextBoxSub
33110>>>//     Form6 is a FormSub
33110>>>//     CheckBox1 is a CheckBoxSub
33110>>>//     oOK_bn is a ButtonSub
33110>>>//     oCancel_bn is a ButtonSub
33110>>>
33110>>>// Register all objects
33110>>>Register_Object BitmapContainer1
33110>>>Register_Object CheckBox1
33110>>>Register_Object ComboForm2
33110>>>Register_Object Connect
33110>>>Register_Object Form4
33110>>>Register_Object Form5
33110>>>Register_Object Form6
33110>>>Register_Object oCancel_bn
33110>>>Register_Object oOK_bn
33110>>>Register_Object Textbox5
33110>>>Register_Object Textbox6
33110>>>Register_Object Textbox7
33110>>>Register_Object Textbox8
33110>>>
33110>>>
33110>>>
33110>>>//AB-StoreTopStart
33110>>>
33110>>>///#INCLUDE
33110>>>Use mertech.inc
INCLUDING FILE: MERTECH.INC
33110>>>>>USE UI
33110>>>>>
#REM -----------------------------------------------
#REM MERTECH DATA SYSTEMS INC. - WWW.MERTECHDATA.COM
#REM MERTECH.INC VERSION 2.1.9
#REM -----------------------------------------------
33110>>>>>
33110>>>>>
33110>>>>>
33110>>>>>
33110>>>>>
33110>>>>>//
33110>>>>>//
33110>>>>>//
33110>>>>>//
33110>>>>>//
33110>>>>>//-----------------------------------------------
33110>>>>>// SELECT_COLUMNS_FIND <FILE> <START> THRU <END>
33110>>>>>// SELECT_COLUMNS_FIND <FILE> <FIELD>
33110>>>>>// This command will issue a properly commands to define the FETCH attribute status
33110>>>>>// for file fields.
33110>>>>>//
33110>>>>>//------------------------------------------------------------------------------
33110>>>>>// RESET_FETCH_FIELDS <FILE NAME>|<FILE NUMBER> <DF_FETCH_TRUE>|<DF_FETCH_FALSE>
33110>>>>>//
33110>>>>>//
33110>>>>>//-----------------------------
33110>>>>>// SQL_FOR_ONEROW <file number>
33110>>>>>//
33110>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get just
33110>>>>>// one ROW for each DataFlex FIND command issued
33110>>>>>// In this case the DBMS optimizer will generate a query with just one row
33110>>>>>//
33110>>>>>//
33110>>>>>//-------------------------------------------------------------------------------
33110>>>>>// SQL_FOR_SET <file number> MAXROWS <number of rows> CACHE|NOCACHE <return code>
33110>>>>>//
33110>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get a SET of rows.
33110>>>>>// In this case the DBMS optimizer will generate a query with <number of rows> Rows.
33110>>>>>// if CACHE is passed as argument, all these rows will be transfered to ORAFlex and then it will
33110>>>>>// save them in a local CACHE buffer. Just the FIND GT and FIND LT will get local cache.
33110>>>>>// Otherwise, i.e NOCACHE,  ORAFLex won't create a local cache.
33110>>>>>//
33110>>>>>//
33110>>>>>//---------------
33110>>>>>// SQL_SET <stmt>
33110>>>>>//
33110>>>>>//-----------------------------------------
33110>>>>>// SQL_APPEND <stmt1> <stmt2> .... <stmtn>
33110>>>>>//
33110>>>>>//------------
33110>>>>>// SQL_EXECUTE
33110>>>>>//
33110>>>>>//----------------------------------------------------------------------
33110>>>>>// LOCK_TABLE [<FILE NAME>|<FILE NUMBER> <FILE NAME>|<FILE NUMBER> ....]
33110>>>>>//
33110>>>>>// LOCK_TABLE will lock the entire table specified as an argument
33110>>>>>// This command will start a new transaction if it still wasn't done.
33110>>>>>// LOCK_TABLE won't lock the other opened tables or the current rows present
33110>>>>>// in their buffers it will be necessary issue a REREAD command to Lock the current
33110>>>>>// rows and then atualize their buffers
33110>>>>>//
33110>>>>>//
33110>>>>>//-------------------------------------------
33110>>>>>// SQL_CHECK_TABLE <SCHEMA NAME> <TABLE NAME>
33110>>>>>//
33110>>>>>//-------------------------------
33110>>>>>// CREATE_TD_FILE  DFTRUE|DFFALSE
33110>>>>>// SET A GLOBAL ATTRIBUTE TO CREATE THE TD FILE AFTER CLOSING AN OPENED FILE
33110>>>>>//
33110>>>>>//-------------------------------------------------
33110>>>>>// OPEN_INT <DATAFLEX FILE NAME>
33110>>>>>// OPEN_INT <PHYSICAL NAME> AS <DATAFLEX FILE NAME>
33110>>>>>//
33110>>>>>// OPEN_INT will check if the OPEN done is an OPEN AS. IF it's true, OPEN_INT
33110>>>>>// will try to open an intermediate file, if there is one. Otherwise OPEN_INT
33110>>>>>// will issue a OPEN command
33110>>>>>// OPEN_INT must be inserted into FMAC file instead OPEN COMMAND
33110>>>>>//
33110>>>>>//=========================================================================================================
33110>>>>>// SELECT STUFFS
33110>>>>>//--------------
33110>>>>>// SQL_SET_STMT OF FILENAME|FILENUMBER TO <STATMENT1>
33110>>>>>//
33110>>>>>// SQL_APPEND_ OF FILENAME|FILENUMBER TO <STATMENT1> <STATMENT2> ... <STATMENTn>
33110>>>>>//
33110>>>>>//
33110>>>>>// SQL_APPEND_UPDCOL_STMT OF FILENAME|FILENUMBER VALUE EXPRESSION WITH FIELD1 FIELD2 ... FIELDN
33110>>>>>//
33110>>>>>// SQL_PREPARE_STMT OF FILENAME|FILENUMBER
33110>>>>>//
33110>>>>>// SQL_BIND_COLUMN [FILENAME|FILENUMBER] [FIELDNAME|FIELDNUMBER]
33110>>>>>//
33110>>>>>// SQL_BINDCOLUMNS_STMT OF FILENAME|FILENUMBER TO <COLUMN1> <COLUMN2> ... <COLUMNn>
33110>>>>>//
33110>>>>>// SQL_EXECUTE_STMT OF FILENAME|FILENUMBER
33110>>>>>//
33110>>>>>// SQL_COMMIT_STMT
33110>>>>>//
33110>>>>>// SQL_ROLLBACK_STMT
33110>>>>>//
33110>>>>>// SQL_FETCH_NEXT_ROW OF FILENAME|FILENUMBER
33110>>>>>//
33110>>>>>//
33110>>>>>//
33110>>>>>//
33110>>>>>// CALL_STORED_PROCEDURE will call a stored procedure passing arguments
33110>>>>>//
33110>>>>>// FORMAT TO USE : CALL_STORED_PROCEDURE <STORED_PROC_NAME> [PASSING <ARG1> <ARG2> ....<ARGn>]
33110>>>>>//
33110>>>>>//
33110>>>>>//---------------------------------------------------------------------------------------------
33110>>>>>// CALL_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
33110>>>>>// CALL_STORED_FUNCTION will call an Oracle stored function passing arguments
33110>>>>>//
33110>>>>>//---------------------------
33110>>>>>// SQL_TEXT_MESSAGE <MESSAGE>
33110>>>>>// Writes a message inside driver log trace file if this is activated
33110>>>>>//
33110>>>>>//-----------------------------------------------------
33110>>>>>// OUTPUT_INT_FILE FOR <FILE NUMBER> TO <INT FILE NAME>
33110>>>>>// Generating the INT file
33110>>>>>//
33110>>>>>// -----------------------
33110>>>>>// SQL_ERROR_MESSAGE <VAR>
33110>>>>>// SQL_ERROR_MESSAGE retrieve the native error message issued by server for error number 25000
33110>>>>>
33110>>>>>
33110>>>>>//=======================================================================================
33110>>>>>// SQLFlex Commands
33110>>>>>//-----------------
33110>>>>>//
33110>>>>>//-----------------------
33110>>>>>// SQLFlex_REVISION <VAR>
33110>>>>>// Retrieves SQLFlex revision
33110>>>>>//
33110>>>>>//-------------------------------------
33110>>>>>// SET_DATABASE_NAME TO <DATABASE NAME>
33110>>>>>// Sets current database
33110>>>>>//
33110>>>>>//---------------------------
33110>>>>>// GET_DATABASE_NAME TO <VAR>
33110>>>>>// Gets name of current database
33110>>>>>//
33110>>>>>//----------------------------------
33110>>>>>// SET_SCHEMA_NAME TO <SCHEMA NAME>
33110>>>>>// Sets current schema name
33110>>>>>//
33110>>>>>//-------------------------
33110>>>>>// GET_SCHEMA_NAME TO <VAR>
33110>>>>>// Gets current schema name
33110>>>>>//
33110>>>>>//--------------------------------
33110>>>>>// SQL_USEDATABASE <DATABASE NAME>
33110>>>>>// Specifies the current Database
33110>>>>>//
33110>>>>>//----------------------------
33110>>>>>// SET_CURRENT_SERVER TO <VAR>
33110>>>>>// Set the current logged server
33110>>>>>//
33110>>>>>//----------------------------
33110>>>>>// GET_CURRENT_SERVER TO <VAR>
33110>>>>>// Retrieves the current logged server
33110>>>>>//
33110>>>>>//-----------------------------
33110>>>>>// SET_HOST_NAME TO <HOST NAME>
33110>>>>>// Defines current host name
33110>>>>>//
33110>>>>>//-----------------------
33110>>>>>// GET_HOST_NAME TO <VAR>
33110>>>>>// Retrieves the current host name
33110>>>>>//
33110>>>>>//---------------------------------------------------------------
33110>>>>>// LOGIN_SQLFLEX <SERVER NAME> <USER NAME> <PASSWORD> <HOST NAME>
33110>>>>>// Specifies host name during login process
33110>>>>>//
33110>>>>>// SQL_CANCEL_QUERY_STMT
33110>>>>>//
33110>>>>>//========================================
33110>>>>>// SQL SERVER Stored Procedure Call engine
33110>>>>>//----------------------------------------
33110>>>>>//
33110>>>>>//
33110>>>>>
33110>>>>>//
33110>>>>>//--------------------------------------------------------------------------------------------------------------
33110>>>>>// CALL_SQLSERVER_PROCEDURE <procedure name> PASSING <VALUE1|VARIABLE1> [SQLOUT] <VALUE2|VARIABLE2> [SQLOUT] ...
33110>>>>>//
33110>>>>>// Executes a stored procedure. SQLOUT will be used to indicate that the stored procedure
33110>>>>>// returns a parameter. The matching parameter in the stored proceudre must have been created with
33110>>>>>// the keyword OUTPUT. Call all procedures that doesn't returns any query with this syntax
33110>>>>>//
33110>>>>>//
33110>>>>>//
33110>>>>>//-----------------------------------------------------------------------------
33110>>>>>
33110>>>>>
33110>>>>>//=============================================================================
33110>>>>>// ORAFlex Commands
33110>>>>>//-----------------
33110>>>>>//----------------------------
33110>>>>>// ORAFlex_REVISION <VARIABLE>
33110>>>>>// Retrieves ORAFlex revision
33110>>>>>//
33110>>>>>//---------------------------------
33110>>>>>// KEEP_FILES_OPEN OF <SERVER NAME>
33110>>>>>// Keeps all files opened even during a LOGOUT
33110>>>>>//
33110>>>>>//-----------------------------------------------
33110>>>>>// SET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
33110>>>>>// Defines the maximum number of cursors that ORAFlex will be allowed for using
33110>>>>>//
33110>>>>>//-----------------------------------------------
33110>>>>>// GET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
33110>>>>>// Retrieves the maximum number of cursors allowed for ORAFlex use
33110>>>>>//
33110>>>>>//---------------------------------------------
33110>>>>>// GET_OPENED_CURSORS OF <SERVER NAME> TO <VAR>
33110>>>>>// Retrieves the number of opened cursors
33110>>>>>//
33110>>>>>//-----------------------------------------------
33110>>>>>// ACTIVATE_TIME_STAMP OF <SERVER NAME> TO ON|OFF
33110>>>>>// Activates Time stamp for date columns
33110>>>>>//
33110>>>>>//----------------------------------------------------------------------------------------------------
33110>>>>>// CALL_ORACLE_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
33110>>>>>// CALL_ORACLE_STORED_FUNCTION will call an Oracle stored function passing arguments
33110>>>>>//
33110>>>>>//-----------------------------------------------------------------------------
33110>>>>>
33110>>>>>//=============================================================================
33110>>>>>// BUFFER save stuffs
33110>>>>>//-------------------
33110>>>>>
33110>>>>>//-------------------------------------------------------
33110>>>>>// SQL_SAVE_BUFFER_BEGIN OF <FILE NUMBER> TO <CACHE SIZE>
33110>>>>>// Initialize the BUFFER buffer
33110>>>>>//
33110>>>>>//---------------------------------
33110>>>>>// SQL_SAVE_BUFFER OF <FILE NUMBER>
33110>>>>>// Moves field buffer values to cache buffer
33110>>>>>//-------------------------------------
33110>>>>>// SQL_SAVE_BUFFER_END OF <FILE NUMBER>
33110>>>>>// Save rows that remains in cache
33110>>>>>//-----------------------------------------------------------------------------
33110>>>>>
33110>>>
33110>>>//AB-StoreTopEnd
33110>>>
33110>>>//AB-IgnoreStart
33110>>>
33110>>>Use Panel.Sub
33110>>>Use Bitmap.Sub
33110>>>Use Txtbox.Sub
33110>>>Use Cmbfrm.Sub
33110>>>Use Form.Sub
33110>>>Use Chkbox.Sub
33110>>>Use Button.Sub
33110>>>
33110>>>
33110>>>//AB-IgnoreEnd
33110>>>
33110>>>Object Connect is a BasicPanelSub
33112>>>
33112>>>    //AB-StoreTopStart
33112>>>
33112>>>    //AB-StoreTopEnd
33112>>>
33112>>>    Set Sysmenu_Icon to FALSE
33113>>>    Set Minimize_Icon to FALSE
33114>>>    Set Label to "Login"
33115>>>    Set Size to 105 230
33116>>>    Set Location to 20 37
33117>>>
33117>>>    //AB-DDOStart
33117>>>
33117>>>
33117>>>    //AB-DDOEnd
33117>>>
33117>>>    Object BitmapContainer1 is a BitmapContainerSub
33119>>>        Set Size to 21 23
33120>>>        Set Location to 4 4
33121>>>        Set Bitmap to "Login1.bmp"
33122>>>        Set Border_Style to Border_None
33123>>>        Set Bitmap_Style to Bitmap_Center
33124>>>        Set Dialog_Caption to "Select a bitmap file"
33125>>>
33125>>>        //AB-StoreStart
33125>>>
33125>>>
33125>>>
33125>>>
33125>>>        //AB-StoreEnd
33125>>>
33125>>>    End_Object    // BitmapContainer1
33126>>>
33126>>>    Object Textbox5 is a TextBoxSub
33128>>>        Set Label to "Driver:"
33129>>>        Set FontSize to 4 0
33130>>>        Set Location to 6 34
33131>>>        Set Size to 13 40
33132>>>        Set TypeFace to "MS Sans Serif"
33133>>>        Set Enabled_State to TRUE
33134>>>    End_Object    // Textbox5
33135>>>
33135>>>    Object ComboForm2 is a ComboFormSub
33137>>>
33137>>>        //AB-StoreTopStart
33137>>>
33137>>>        Set CapsLock_State to True
33138>>>
33138>>>        //AB-StoreTopEnd
33138>>>
33138>>>        Set Size to 13 85
33139>>>        Set Location to 6 76
33140>>>        Set Label_Col_Offset to 2
33141>>>        Set Label_Justification_Mode to jMode_Right
33142>>>
33142>>>        //AB-StoreStart
33142>>>        Procedure Combo_Fill_List
33144>>>                Local String Availdrv## TempDrv##
33145>>>                Local Integer HowMany i p1## p2##
33145>>>
33145>>>                get_profile_string "WorkSpaces" "CurrentWorkspace" to AvailDrv##
33148>>>                If AvailDrv## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to AvailDrv##
33151>>>                insert "WorkSpaces\" in AvailDrv## at 1
33153>>>                get_profile_string AvailDrv## "AvailableDrivers" to AvailDrv##
33156>>>
33156>>>                Move Availdrv## to Tempdrv##
33157>>>                Repeat
33157>>>>
33157>>>                    Replace "|" in Tempdrv## With ""
33159>>>                    [Found] Increment HowMany
33160>>>                Until [Finderr]
33162>>>
33162>>>                Send Combo_add_Item ""
33163>>>
33163>>>                If HowMany lt 1 Begin
33165>>>                    If Availdrv## ne "" Send Combo_Add_Item (UpperCase(Availdrv##))
33168>>>                End
33168>>>>
33168>>>                Else Begin
33169>>>                    For i From 0 to HowMany
33175>>>>
33175>>>                        If i eq 0 Move 1 to p1##
33178>>>                        Else Begin
33179>>>                            Move ((Pos("|",Availdrv##))+1) to p1##
33180>>>                            Replace "|" in Availdrv## With ","
33182>>>                        End
33182>>>>
33182>>>                        Move ((Pos("|",Availdrv##))) to p2##
33183>>>                        Send Combo_Add_Item (UpperCase(Mid(Availdrv##,(p2##-p1##),p1##)))
33184>>>                    Loop
33185>>>>
33185>>>                End
33185>>>>
33185>>>        End_Procedure
33186>>>
33186>>>        Set Allow_Blank_state to True
33187>>>
33187>>>
33187>>>
33187>>>        //AB-StoreEnd
33187>>>
33187>>>    End_Object    // ComboForm2
33188>>>
33188>>>    Object Textbox6 is a TextBoxSub
33190>>>        Set Label to "Server:"
33191>>>        Set FontSize to 4 0
33192>>>        Set Location to 22 34
33193>>>        Set Size to 13 40
33194>>>        Set TypeFace to "MS Sans Serif"
33195>>>        Set Enabled_State to TRUE
33196>>>    End_Object    // Textbox6
33197>>>
33197>>>    Object Form4 is a FormSub
33199>>>        Set Size to 13 93
33200>>>        Set Location to 22 76
33201>>>        Set Label_Col_Offset to 2
33202>>>        Set Label_Justification_Mode to jMode_Right
33203>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33204>>>    End_Object    // Form4
33205>>>
33205>>>    Object Textbox7 is a TextBoxSub
33207>>>        Set Label to "User Name:"
33208>>>        Set FontSize to 4 0
33209>>>        Set Location to 38 34
33210>>>        Set Size to 13 40
33211>>>        Set TypeFace to "MS Sans Serif"
33212>>>        Set Enabled_State to TRUE
33213>>>    End_Object    // Textbox7
33214>>>
33214>>>    Object Form5 is a FormSub
33216>>>        Set Size to 13 93
33217>>>        Set Location to 38 76
33218>>>        Set Label_Col_Offset to 2
33219>>>        Set Label_Justification_Mode to jMode_Right
33220>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33221>>>    End_Object    // Form5
33222>>>
33222>>>    Object Textbox8 is a TextBoxSub
33224>>>        Set Label to "Password:"
33225>>>        Set FontSize to 4 0
33226>>>        Set Location to 54 34
33227>>>        Set Size to 13 40
33228>>>        Set TypeFace to "MS Sans Serif"
33229>>>        Set Enabled_State to TRUE
33230>>>    End_Object    // Textbox8
33231>>>
33231>>>    Object Form6 is a FormSub
33233>>>        Set Size to 13 93
33234>>>        Set Location to 54 76
33235>>>        Set Label_Col_Offset to 2
33236>>>        Set Label_Justification_Mode to jMode_Right
33237>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33238>>>
33238>>>        //AB-StoreStart
33238>>>        Set Password_State Item 0 to True
33239>>>
33239>>>        //AB-StoreEnd
33239>>>
33239>>>    End_Object    // Form6
33240>>>
33240>>>    Object CheckBox1 is a CheckBoxSub
33242>>>        Set Label to "Save Password"
33243>>>        Set Size to 10 66
33244>>>        Set Location to 73 76
33245>>>        Set Status_Help to "Remember The Password at Next Login"
33246>>>    End_Object    // CheckBox1
33247>>>
33247>>>    Object oOK_bn is a ButtonSub
33249>>>        Set Label to "Co&nnect"
33250>>>        Set Default_State to TRUE
33251>>>        Set Bitmap to "mcr.bmp"
33252>>>        Set Size to 28 33
33253>>>        Set Location to 9 184
33254>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33255>>>
33255>>>        //AB-StoreStart
33255>>>        Procedure OnClick
33257>>>            Set LoginOk to True
33258>>>            Send Stop_Modal_ui
33259>>>        End_Procedure
33260>>>        Set Status_Help to "Connect"
33261>>>        //AB-StoreEnd
33261>>>
33261>>>    End_Object    // oOK_bn
33262>>>
33262>>>    Object oCancel_bn is a ButtonSub
33264>>>        Set Label to "&Cancel"
33265>>>        Set Bitmap to "exit2.bmp"
33266>>>        Set Size to 28 32
33267>>>        Set Location to 39 184
33268>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33269>>>
33269>>>        //AB-StoreStart
33269>>>
33269>>>        ON_KEY KENTER SEND Exit_Application to (Connect(Current_Object))
33270>>>
33270>>>        Procedure OnClick
33272>>>            Set LoginOk to False
33273>>>            Send Exit_Application to (Connect(Current_Object))
33274>>>        End_Procedure
33275>>>
33275>>>        Set Status_Help to "Close Application"
33276>>>
33276>>>
33276>>>        //AB-StoreEnd
33276>>>
33276>>>    End_Object    // oCancel_bn
33277>>>
33277>>>
33277>>>    //AB-StoreStart
33277>>>
33277>>>    Set Modal_State to True
33278>>>
33278>>>    // Now is WorkspaceAware
33278>>>
33278>>>    ON_KEY KENTER SEND OnClick to (oOk_bn(Current_Object))
33279>>>    ON_KEY KSAVE_RECORD SEND OK
33280>>>    ON_KEY KCANCEL SEND EXIT_APPLICATION
33281>>>    ON_KEY KCLOSE_PANEL SEND EXIT_APPLICATION
33282>>>
33282>>>    Set Locate_Mode to Center_On_Screen
33283>>>    Set Exit_Application_Local_State to False
33284>>>    Set Exit_MSG to Exit
33285>>>    Set Description_State to True
33286>>>
33286>>>    Property Integer LoginOk public false
33288>>>
33288>>>    External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;        Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
33289>>>
33289>>>    Function Network_User_Name Returns String
33291>>>        Local String sName sLength
33292>>>        Local Pointer lpName_Addr lpLength_Addr
33292>>>        Local Integer iRetval
33292>>>
33292>>>        Movestr (Repeat (Character (0), 255)) To sName
33293>>>>
33293>>>        GetAddress Of sName To lpName_Addr
33294>>>        Movestr (DwordToBytes (255)) To sLength
33295>>>>
33295>>>        GetAddress Of sLength To lpLength_Addr
33296>>>
33296>>>        Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
33297>>>>
33297>>>
33297>>>        If iRetval Eq 0 Function_Return (CString (sName))
33300>>>        Else Function_Return "User Unknown"
33302>>>    End_Function // Network_User_Name
33303>>>
33303>>>    Function fsCrypto String lsWay String lsOld Returns String
33305>>>        Local String lsNew lsTemp
33306>>>        Local Integer liCount
33306>>>           For liCount From 1 to (Length(lsOld))
33312>>>>
33312>>>               Mid lsOld to lsTemp 1 liCount
33315>>>>
33315>>>               If ((Uppercase(lsWay)) eq 'FORWARD') Begin
33317>>>               If ((Ascii(lsTemp) = 255)) Move (Character(32)) to lsTemp
33320>>>               Else Move (Character(Ascii(lsTemp)+1)) to lsTemp
33322>>>               End
33322>>>>
33322>>>               Else Begin
33323>>>                   If ((Uppercase(lsWay)) eq 'BACKWARD') Begin
33325>>>                       If ((Ascii(lsTemp) = 32)) Move (Character(255)) to lsTemp
33328>>>                       Else Move (Character(Ascii(lsTemp)-1)) to lsTemp
33330>>>                   End
33330>>>>
33330>>>               End
33330>>>>
33330>>>               Append lsNew lsTemp
33331>>>           Loop
33332>>>>
33332>>>        Function_Return (lsNew)
33333>>>    End_Function
33334>>>
33334>>>    Procedure Activating
33336>>>        Local String LoginDriver## LoginServer## LoginUserid## LoginPassword##
33337>>>        Local String LastLogin## LoginSeq##
33337>>>        Local Integer SavePassword##
33337>>>
33337>>>        Forward Send Activating
33339>>>
33339>>>        get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
33342>>>        If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
33345>>>        insert "WorkSpaces\" in LastLogin## at 1
33347>>>        Append LastLogin## "\" (Module_Name(Self)) "\LastLogin"
33350>>>        get_profile_string LastLogin## "LoginDriver" to LoginSeq##
33353>>>
33353>>>        If "|" in LoginSeq## move (left(LoginSeq##,(pos("|",LoginSeq##) -1))) to LoginDriver##
33356>>>        Else Move LoginSeq## to LoginDriver##
33358>>>        get_profile_string LastLogin## "LoginServer"  to LoginServer##
33361>>>        get_profile_string LastLogin## "LoginUserId"  to LoginUserId##
33364>>>        get_profile_string LastLogin## "SavePassword" to SavePassword##
33367>>>        If LoginUserId## eq "" Move (Network_User_Name(Current_Object)) to LoginUserId##
33370>>>
33370>>>        If (((UpperCase(LoginDriver##)) eq "DATAFLEX") or (LoginDriver## eq "")) Begin
33372>>>                Set Value of (ComboForm2(Current_Object)) Item 0 to ""
33373>>>                Set Value of (Form4(Current_Object))      Item 0 to ""
33374>>>        End
33374>>>>
33374>>>        Else Begin
33375>>>            Set Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
33376>>>            Set Value of (Form4(Current_Object))      Item 0 to LoginServer##
33377>>>        End
33377>>>>
33377>>>        Set Value of (Form5(Current_Object))      Item 0 to LoginUserID##
33378>>>        Set Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
33379>>>        If (SavePassword##) Begin
33381>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33382>>>            get_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to LoginPassword##
33386>>>            Set Value of (Form6(Current_Object))      Item 0 to (fsCrypto(Self,"backward",LoginPassword##))
33387>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33388>>>        End
33388>>>>
33388>>>    End_Procedure
33389>>>
33389>>>    Function LoginUser Returns Integer
33391>>>        Integer SavePassword## Size## PasswordOk
33392>>>        String LoginDriver## LoginServer## LoginUserid## LoginPassword## LoginSeq## LastLogin##
33392>>>        String lsLoginDate lsHH lsMM lsSS sDepartment
33392>>>        Integer liOpenCursors
33392>>>
33392>>>        Send Popup_Modal
33393>>>
33393>>>        Get Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
33394>>>        Get Value of (Form4(Current_Object))      Item 0 to LoginServer##
33395>>>        Get Value of (Form5(Current_Object))      Item 0 to LoginUserID##
33396>>>        Get Value of (Form6(Current_Object))      Item 0 to LoginPassword##
33397>>>        Get Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
33398>>>        Set Value of (Form6(Current_Object))      Item 0 to ""
33399>>>
33399>>>    //tolis 03/02/2004
33399>>>        If ((LoginDriver## <> "") and (UpperCase(LoginDriver##)<>"DATAFLEX"))  begin
33401>>>    //        send ignore_error to (error_info_object(current_object)) 25000
33401>>>    //        send ignore_error to (error_info_object(current_object)) 4255
33401>>>    //        send ignore_error to (error_info_object(current_object)) 12293
33401>>>    //        login LoginServer## LoginUserId## LoginPassword## LoginDriver##
33401>>>    //        send trap_error to (error_info_object(current_object)) 25000
33401>>>    //        send trap_error to (error_info_object(current_object)) 4255
33401>>>    //        send trap_error to (error_info_object(current_object)) 12293
33401>>>    //        If LastErr eq 25000 Begin
33401>>>    //            Error LastErr "Invalid Login Information"
33401>>>    //            Set LoginOk to False
33401>>>    //            Send Exit_Application
33401>>>    //        End
33401>>>    //        If LastErr eq 4255 Begin
33401>>>    //            Error LastErr "Invalid Driver Name"
33401>>>    //            Set LoginOk to False
33401>>>    //            Send Exit_Application
33401>>>    //        End
33401>>>    //        If LastErr eq 12293 Begin
33401>>>    //            Error LastErr "(IBM CLI)Database alias name or Database name not found"
33401>>>    //            Set LoginOk to False
33401>>>    //           Send Exit_Application
33401>>>    //      End
33401>>>            Set LoginOk to True
33402>>>    //        If (UpperCase(LoginDriver##) = "ORA_DRV") Begin
33402>>>    //            GET_MAX_OPEN_CURSORS of LoginServer## to liOpenCursors
33402>>>    //            If (liOpenCursors <> 0) SET_MAX_OPEN_CURSORS of LoginServer## to (liOpenCursors+2)
33402>>>    //        End
33402>>>        End
33402>>>>
33402>>>        Else Begin
33403>>>            Set LoginOk to True
33404>>>            Open "Users" as Users
INCLUDING FILE: USERS.FD
33406>>>            Move "DATAFLEX" To LoginDriver##
33407>>>            Move "" to LoginServer##
33408>>>            File_Size Users to Size##
33411>>>            If Size## ne 0 Begin
33413>>>                 Clear Users
33414>>>                 Move LoginUSerId##   to Users.Login_Id
33415>>>                 Find eq Users by Index.1
33416>>>>
33416>>>                 [Finderr] Begin
33418>>>>
33418>>>                    Error 25000 "Unknown User"
33419>>>>
33419>>>                    Set LoginOk to False
33420>>>                    Get LoginOk to PasswordOk
33421>>>                    Function_Return PasswordOk
33422>>>                 End
33422>>>>
33422>>>                 [Found] Begin
33424>>>>
33424>>>                    If (LoginPassword## ne Users.Password) Begin
33426>>>                        Error 25000 "Invalid Password"
33427>>>>
33427>>>                        Set LoginOk to False
33428>>>                        Get LoginOk to PasswordOk
33429>>>                        Function_Return PasswordOk
33430>>>                    End
33430>>>>
33430>>>                    Else Move Users.Departm_Code to sDepartment
33432>>>                    Move (Trim(sDepartment)) to sDepartment
33433>>>                 End
33433>>>>
33433>>>            End
33433>>>>
33433>>>            Close Users
33434>>>
33434>>>
33434>>>    //            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33434>>>    //            Integer bFileExists
33434>>>    //            Get Get_File_Exists  "C:\AutLogIn.txt" To bFileExists
33434>>>    //            If (NOT(bFileExists)) Begin
33434>>>
33434>>>    //                Get Get_File_Exists  "C:\UsrLogin.txt" To bFileExists
33434>>>    //                If (bFileExists) Begin
33434>>>
33434>>>    ////                        If Size## ne 0 Begin
33434>>>
33434>>>    //                            Local String ss1 ss2 ss3 ss4
33434>>>    //                            Local String dd1 dd2 dd3 dd4
33434>>>    //                            Move '' to dd1
33434>>>    //                            Move '' to dd2
33434>>>    //                            Move '' to dd3
33434>>>    //                            Move '' to dd4
33434>>>
33434>>>    //                            Direct_Input Channel 8 "C:\UsrLogin.txt"
33434>>>    //                            Readln Channel 8 ss1 ss2 ss3 ss4
33434>>>    //                            While (Not(Seqeof))
33434>>>    //                                Move (Trim(ss1)) to ss1
33434>>>    //                                Move (Trim(ss2)) to ss2
33434>>>    //                                Move (Trim(ss3)) to ss3
33434>>>    //                                Move (Trim(ss4)) to ss4
33434>>>    //                                Append dd1 '"' ss1 '"'
33434>>>    //                                Append dd2 '"' ss2 '"'
33434>>>    //                                Append dd3 '"' ss3 '"'
33434>>>    //                                Append dd4 '"' ss4 '"'
33434>>>    //                                Login dd1 dd2 dd3 dd4
33434>>>    //                                Readln Channel 8 ss1 ss2 ss3 ss4
33434>>>    //                            Loop
33434>>>
33434>>>
33434>>>    ////                            // Only Filmnet Users Log on to SQL
33434>>>    ////                            If (sDepartment='FILMNET') Begin
33434>>>    ////                                ////// 20/06/2001 js Allagh apo Oracle se SQL server
33434>>>    ////                                ////// login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33434>>>    ////                                login '192.168.128.5'   'sa'    ''   'SQL_DRV'
33434>>>    ////                                login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33434>>>    ////                            End
33434>>>    ////                            Else login '192.168.128.5'      'sa'    ''   'SQL_DRV'
33434>>>    ////                            //Else login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33434>>>
33434>>>    ////                        End
33434>>>    ////                        Else Begin
33434>>>    ////                            ////// 20/06/2001 js Allagh apo Oracle se SQL server
33434>>>    ////                            ///// login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33434>>>    ////                            login '192.168.128.5'       'sa'    ''   'SQL_DRV'
33434>>>    ////                            //login '192.168.128.5'   'EPGDNS'    'DNS'   'SQL_DRV'
33434>>>    ////                            login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33434>>>    ////                        End
33434>>>
33434>>>
33434>>>    //                End
33434>>>
33434>>>    //            End
33434>>>    //            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33434>>>
33434>>>
33434>>>
33434>>>            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33434>>>            //*Integer bFileExists
33434>>>            //*Get Get_File_Exists  "C:\AutLogIn.txt" To bFileExists
33434>>>            //*If (NOT(bFileExists)) Begin
33434>>>            //*    If Size## ne 0 Begin
33434>>>            //*        // Only Filmnet Users Log on to SQL
33434>>>            //*        If (sDepartment='FILMNET') Begin
33434>>>            //*            login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33434>>>            //*            login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33434>>>            //*        End
33434>>>            //*        Else login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33434>>>            //*    End
33434>>>            //*    Else Begin
33434>>>            //*        login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33434>>>            //*        login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33434>>>            //*    End
33434>>>            //*
33434>>>            //*End
33434>>>            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33434>>>
33434>>>
33434>>>
33434>>>        End
33434>>>>
33434>>>
33434>>>        Open Users
33436>>>        //Open "Users" as Users
33436>>>        File_Size Users to Size##
33439>>>        If Size## ne 0 Begin
33441>>>             Clear Users
33442>>>             Move LoginUSerId##   to Users.Login_Id
33443>>>             Find eq Users by Index.1
33444>>>>
33444>>>             [Finderr] Begin
33446>>>>
33446>>>                Error 25000 "Unknown User"
33447>>>>
33447>>>                Set LoginOk to False
33448>>>                Get LoginOk to PasswordOk
33449>>>                Function_Return PasswordOk
33450>>>             End
33450>>>>
33450>>>             [Found] Begin
33452>>>>
33452>>>                If (LoginPassword## ne Users.Password) Begin
33454>>>                    Error 25000 "Invalid Password"
33455>>>>
33455>>>                    Set LoginOk to False
33456>>>                    Get LoginOk to PasswordOk
33457>>>                    Function_Return PasswordOk
33458>>>                End
33458>>>>
33458>>>                Else Move Users.Departm_Code to sDepartment
33460>>>                Move (Trim(sDepartment)) to sDepartment
33461>>>             End
33461>>>>
33461>>>        End
33461>>>>
33461>>>        Close Users
33462>>>
33462>>>        Get LoginOk to PasswordOk
33463>>>        Sysdate lsLoginDate lsHH lsMM lsSS
33467>>>        get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
33470>>>        If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
33473>>>        insert "WorkSpaces\" in LastLogin## at 1
33475>>>        get_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
33478>>>        If ((LoginDriver## ne "") and ((UpperCase(LoginDriver##)) ne "DATAFLEX")) Begin
33480>>>           If Not LoginDriver## in LoginSeq## Begin
33482>>>                 If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
33485>>>                 Else Move (LoginSeq##+"|"+LoginDriver##) to LoginSeq##
33487>>>                 set_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
33490>>>           End
33490>>>>
33490>>>        End
33490>>>>
33490>>>        Append LastLogin## "\" (Module_Name(Self))
33492>>>        Append LastLogin## "\LastLogin"
33493>>>        get_profile_string LastLogin## "LoginDriver" to LoginSeq##
33496>>>
33496>>>        If "|" in LoginSeq## Begin
33498>>>            If ((left(LoginSeq##,(pos("|",LoginSeq##) -1))) ne LoginDriver##) Insert (LoginDriver##+"|") in LoginSeq## at 1
33502>>>        End
33502>>>>
33502>>>        Else Begin
33503>>>            If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
33506>>>            Else If LoginSeq## ne LoginDriver## Insert (LoginDriver##+"|") in LoginSeq## at 1
33511>>>        End
33511>>>>
33511>>>        Left LoginSeq## to LoginSeq## 250
33513>>>>
33513>>>        set_profile_string LastLogin## "LoginDriver" to (UpperCase(LoginSeq##))
33516>>>        set_profile_string LastLogin## "LoginServer" to LoginServer##
33519>>>        set_profile_string LastLogin## "LoginUserId" to LoginUserId##
33522>>>        set_profile_string LastLogin## "SavePassword" to SavePassword##
33525>>>        If lsHH lt 10 Insert 0 in lsHH at 1
33529>>>        If lsMM lt 10 Insert 0 in lsMM at 1
33533>>>        If lsSS lt 10 Insert 0 in lsSS at 1
33537>>>        Append lsLoginDate " - " lsHH ":" lsMM ":" lsSS
33543>>>        set_profile_string LastLogin## "LoginTime" to lsLoginDate
33546>>>        If (SavePassword##) Begin
33548>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33549>>>            set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to (fsCrypto(Self,"forward",LoginPassword##))
33552>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33553>>>        End
33553>>>>
33553>>>        Else Begin
33554>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33555>>>            set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to ""
33558>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33559>>>        End
33559>>>>
33559>>>
33559>>>        Function_Return PasswordOk
33560>>>    End_Function
33561>>>
33561>>>    Procedure Login For Desktop
33562>>>        Local Integer LoginPassword##
33563>>>        Get LoginUser of (Connect(Current_Object)) to LoginPassword##
33564>>>        If Not LoginPassword## Send Exit_Application
33567>>>    End_Procedure
33568>>>
33568>>>    Function CheckLogin For Desktop Returns Integer
33569>>>        Local Integer LoginPassword##
33570>>>        Get LoginUser of (Connect(Current_Object)) to LoginPassword##
33571>>>        Function_Return LoginPassword##
33572>>>    End_Function
33573>>>
33573>>>
33573>>>
33573>>>
33573>>>
33573>>>
33573>>>    //AB-StoreEnd
33573>>>
33573>>>End_Object    // Connect
33574>>>
33574>>>
33574>>>//AB-StoreStart
33574>>>
33574>>>
33574>>>
33574>>>//AB-StoreEnd
33574>>>
33574>>>//AB/ End_Object    // prj
33574>use checkafm.pkg
INCLUDING FILE: CHECKAFM.PKG
33574>>>
33574>>>
33574>>>Function Check_Afm Global String Afm_Num Returns Integer
33575>>>    Integer iii Num1 Num2
33576>>>
33576>>>    Move (Trim(Afm_Num)) To Afm_Num
33577>>>
33577>>>    For iii From 1 To (Length(Trim(Afm_Num)))
33583>>>>
33583>>>        If Not (Mid(Afm_Num,1,iii)) In  "0123456789" Function_Return 3
33586>>>    Loop
33587>>>>
33587>>>
33587>>>    Move (Right(Afm_Num,1)) to Num2
33588>>>
33588>>>    If (Length(Afm_Num)<>9) Function_Return 2
33591>>>
33591>>>    Move 0 to Num1
33592>>>
33592>>>    For iii From 1 to 8
33598>>>>
33598>>>        Add ((Mid(Afm_Num,1,iii)) * (2 ^ (9 - iii))) to Num1
33599>>>    Loop
33600>>>>
33600>>>
33600>>>    Move (Mod(Num1,11)) to Num1
33601>>>    If (Num1=10) Move 0 to Num1
33604>>>
33604>>>    If (Num1=Num2)  Function_Return 0
33607>>>    Else            Function_Return 1
33609>>>End_Function
33610>>>
33610>use checklog.pkg
INCLUDING FILE: CHECKLOG.PKG
33610>>>open syscurgl
INCLUDING FILE: SYSCURGL.FD
33612>>>open syscurxr
33614>>>open gplan
INCLUDING FILE: GPLAN.FD
33616>>>//open gplanl
33616>>>open iteml
INCLUDING FILE: ITEML.FD
33618>>>open cn
INCLUDING FILE: CN.FD
33620>>>open payresp
INCLUDING FILE: PAYRESP.FD
33622>>>open salesmen
INCLUDING FILE: SALESMEN.FD
33624>>>open mhxanik
INCLUDING FILE: MHXANIK.FD
33626>>>open constrct
INCLUDING FILE: CONSTRCT.FD
33628>>>open clients
INCLUDING FILE: CLIENTS.FD
33630>>>open wtypkin
INCLUDING FILE: WTYPKIN.FD
33632>>>open wax
INCLUDING FILE: WAX.FD
33634>>>Function Check_log Global String slog Returns Integer
33635>>>    clear gplan
33636>>>    move syscurxr.company_code to gplan.company_code
33637>>>    move syscurxr.branch_code  to gplan.branch_code
33638>>>    move syscurxr.year_year    to gplan.year_year
33639>>>    move slog                  to gplan.gplan_code
33640>>>    find eq gplan by index.1
33641>>>>
33641>>>    if (found=1) function_return 0
33644>>>    else         function_return 1
33646>>>
33646>>>End_Function
33647>>>
33647>>>Function Check_last Global String slog Returns Integer
33648>>>    clear gplan
33649>>>    move syscurxr.company_code to gplan.company_code
33650>>>    move syscurxr.branch_code  to gplan.branch_code
33651>>>    move syscurxr.year_year    to gplan.year_year
33652>>>    move slog                  to gplan.gplan_code
33653>>>    find eq gplan by index.1
33654>>>>
33654>>>    if ((found=1) and (Gplan.Gplan_Yn_Last = 1)) Function_Return 0
33657>>>    else                                         Function_return 1
33659>>>
33659>>>End_Function
33660>>>
33660>>>Function fsgplandescr String slog Returns string
33661>>>    clear gplan
33662>>>    move syscurgl.company_code to gplan.company_code
33663>>>    move syscurgl.branch_code  to gplan.branch_code
33664>>>    move syscurgl.year_year    to gplan.year_year
33665>>>    move slog                  to gplan.gplan_code
33666>>>    find eq gplan by index.1
33667>>>>
33667>>>    if (found=1) function_return gplan.gplan_descr1
33670>>>    else         function_return ''
33672>>>
33672>>>End_Function
33673>>>
33673>>>//Function fsgplanperi String slog Returns string
33673>>>//    string sdescr
33673>>>//    clear gplanl
33673>>>//    move syscurgl.company_code to  gplanl.company_code
33673>>>//    move syscurgl.branch_code  to  gplanl.branch_code
33673>>>//    move slog                  to  gplanl.gplan_code
33673>>>//    find eq gplanl by index.1
33673>>>//    if (found=1) begin
33673>>>//        move gplanl.gplan_descr1 to sdescr
33673>>>//        function_return sdescr
33673>>>//    end
33673>>>//    else         function_return ''
33673>>>//End_Function
33673>>>
33673>>>
33673>>>
33673>>>Function fsclient string code Returns string
33674>>>    string name
33675>>>    clear clients
33676>>>    move code to clients.client_id
33677>>>    find eq clients by index.6
33678>>>>
33678>>>    if (found) move clients.client_name to name
33681>>>    else       move '' to name
33683>>>    function_return name
33684>>>end_Function
33685>>>
33685>>>Function fspayresp string code Returns string
33686>>>    string name
33687>>>    clear payresp
33688>>>    move code to payresp.presp_id
33689>>>    find eq payresp by index.7
33690>>>>
33690>>>    if (found) move payresp.presp_name to name
33693>>>    else       move '' to name
33695>>>    function_return name
33696>>>end_Function
33697>>>
33697>>>Function fssalesmen string code Returns string
33698>>>    string name
33699>>>    clear salesmen
33700>>>    move code to salesmen.sls_id
33701>>>    find eq salesmen by index.4
33702>>>>
33702>>>    if (found) move salesmen.sls_name to name
33705>>>    else       move '' to name
33707>>>    function_return name
33708>>>end_Function
33709>>>
33709>>>Function fsconstrct string code Returns string
33710>>>    string name
33711>>>    clear constrct
33712>>>    move code to constrct.cnt_id
33713>>>    find eq constrct by index.5
33714>>>>
33714>>>    if (found) move constrct.cnt_name to name
33717>>>    else       move '' to name
33719>>>    function_return name
33720>>>end_Function
33721>>>
33721>>>Function fsmhxanik string code Returns string
33722>>>    string name
33723>>>    clear mhxanik
33724>>>    move code to mhxanik.mhx_id
33725>>>    find eq mhxanik by index.4
33726>>>>
33726>>>    if (found) move mhxanik.mhx_name to name
33729>>>    else       move '' to name
33731>>>    function_return name
33732>>>end_Function
33733>>>
33733>>>
33733>>>Function fsptyppar string code Returns string
33734>>>    string sdescr
33735>>>    clear ptypparl
INCLUDING FILE: PTYPPARL.FD
33736>>>    move syscurxr.company_code to ptypparl.company_code
33737>>>    move syscurxr.branch_code  to ptypparl.branch_code
33738>>> //   move syscurxr.year_year    to ptypparl.year_year
33738>>>    move code                  to ptypparl.ptyppar_code
33739>>>    find eq ptypparl by index.1
33740>>>>
33740>>>    move ptypparl.ptyppar_descr to sdescr
33741>>>    function_return sdescr
33742>>>end_Function
33743>>>
33743>>>Function fsgplan string code Returns string
33744>>>    string sdescr
33745>>>    clear gplan
33746>>>    move syscurxr.company_code to gplan.company_code
33747>>>    move syscurxr.branch_code  to gplan.branch_code
33748>>>    move syscurxr.year_year    to gplan.year_year
33749>>>    move code                  to gplan.gplan_code
33750>>>    find eq gplan by index.1
33751>>>>
33751>>>    move gplan.gplan_descr1    to sdescr
33752>>>    function_return sdescr
33753>>>end_Function
33754>>>
33754>>>Function fsitem string scode Returns string
33755>>>    clear iteml
33756>>>    move scode to iteml.item_code
33757>>>    find eq iteml by index.5
33758>>>>
33758>>>    function_return iteml.item_descr
33759>>>end_Function
33760>>>
33760>>>Function fswax string srecr Returns string
33761>>>    clear wax
33762>>>    move srecr to wax.wax_recr
33763>>>    find eq wax by index.2
33764>>>>
33764>>>    function_return wax.wax_descr
33765>>>end_Function
33766>>>
33766>>>
33766>>>Function fswitemx string code Returns string
33767>>>    string name
33768>>>    clear witemx
INCLUDING FILE: WITEMX.FD
33769>>>    move syscurxr.company_code to witemx.company_code
33770>>>    move syscurxr.branch_code  to witemx.branch_code
33771>>>    move syscurxr.year_year    to witemx.year_year
33772>>>    move code to witemx.witemx_code
33773>>>    find eq witemx by index.5
33774>>>>
33774>>>    move witemx.witemx_descr to name
33775>>>    function_return name
33776>>>end_Function
33777>>>
33777>>>Function fsCNDescr String asItem Returns String
33778>>>    Clear CN
33779>>>    move asItem to CN.CN_Code
33780>>>    Find Eq CN by Index.5
33781>>>>
33781>>>    Function_Return CN.CN_Descr
33782>>>End_Function
33783>>>
33783>>>Function fswtypkin String askin Returns String
33784>>>    Clear Wtypkin
33785>>>    move askin to Wtypkin.wtypkin_code
33786>>>    Find Eq wtypkin by Index.1
33787>>>>
33787>>>    Function_Return Wtypkin.wtypkin_descr
33788>>>End_Function
33789>>>
33789>>>Function FindGtypkinDescr Integer aiCode Returns String
33790>>>    String lsDescr
33791>>>    Clear Gtypkin
INCLUDING FILE: GTYPKIN.FD
33792>>>    Move syscurxr.company_code    to Gtypkin.Company_Code
33793>>>    Move syscurxr.Branch_Code     to Gtypkin.Branch_Code
33794>>>    Move syscurxr.Year_year       to Gtypkin.Year_Year
33795>>>    Move aiCode                   to Gtypkin.Gtypkin_Code
33796>>>    Find eq Gtypkin by Index.1
33797>>>>
33797>>>    [Found] Move Gtypkin.Gtypkin_Descr to lsDescr
33798>>>    Function_Return lsDescr
33799>>>End_Function // FindGtypkinDescr
33800>>>
33800>>>Function FindBtypkinDescr Integer aiCode Returns String
33801>>>    String lsDescr
33802>>>    Clear Btypkin
INCLUDING FILE: BTYPKIN.FD
33803>>>    Move syscurxr.company_code    to Btypkin.Company_Code
33804>>>    Move syscurxr.Branch_Code     to Btypkin.Branch_Code
33805>>>    Move syscurxr.Year_year       to Btypkin.Year_Year
33806>>>    Move aiCode                   to Btypkin.btypkin_Code
33807>>>    Find eq Btypkin by Index.1
33808>>>>
33808>>>    [Found] Move Btypkin.Btypkin_Descr to lsDescr
33809>>>    Function_Return lsDescr
33810>>>End_Function // FindGtypkinDescr
33811>>>
33811>>>
33811>Send Login
33812>
33812>Use Xrhsh.pkg
INCLUDING FILE: XRHSH.PKG
33812>>>//------------------------------
33812>>>Use SelectXr.Dg
INCLUDING FILE: SELECTXR.DG
33812>>>>>//AB/ Project Select / Change Xrhsh
33812>>>>>//AB/ Object prj is a Dialog_Project
33812>>>>>//AB/     Set ProjectName to "Select / Change Xrhsh"
33812>>>>>//AB/     Set ProjectFileName to "SelectXR.DG"
33812>>>>>
33812>>>>>// Project Object Structure
33812>>>>>//   oSelectYear is a dbModalPanelSub
33812>>>>>//     Company_DD is a DataDictionary
33812>>>>>//     Branch_DD is a DataDictionary
33812>>>>>//     Year_DD is a DataDictionary
33812>>>>>//     Company_Company_Code is a dbFormSub
33812>>>>>//     Company_Company_Name is a dbFormSub
33812>>>>>//     Branch_Branch_Code is a dbFormSub
33812>>>>>//     Branch_Branch_Name is a dbFormSub
33812>>>>>//     Year_Year_Year is a dbFormSub
33812>>>>>//     Year_Year_Descr is a dbFormSub
33812>>>>>//     Year_Year_Entrydate is a dbFormSub
33812>>>>>//     oOk_bn is a ButtonSub
33812>>>>>//     oCancel_bn is a ButtonSub
33812>>>>>//     otxtCompany is a TextBoxSub
33812>>>>>//     otxtBranch is a TextBoxSub
33812>>>>>//     otxtYear is a TextBoxSub
33812>>>>>//     otxtWorkingDay is a TextBoxSub
33812>>>>>//     otxtWorkingDay is a TextBoxSub
33812>>>>>//     chkxr is a CheckBoxSub
33812>>>>>
33812>>>>>// Register all objects
33812>>>>>Register_Object Branch_Branch_Code
33812>>>>>Register_Object Branch_Branch_Name
33812>>>>>Register_Object Branch_DD
33812>>>>>Register_Object Company_Company_Code
33812>>>>>Register_Object Company_Company_Name
33812>>>>>Register_Object Company_DD
33812>>>>>Register_Object chkxr
33812>>>>>Register_Object oCancel_bn
33812>>>>>Register_Object oOk_bn
33812>>>>>Register_Object oSelectYear
33812>>>>>Register_Object otxtBranch
33812>>>>>Register_Object otxtCompany
33812>>>>>Register_Object otxtWorkingDay
33812>>>>>Register_Object otxtYear
33812>>>>>Register_Object Year_DD
33812>>>>>Register_Object Year_Year_Descr
33812>>>>>Register_Object Year_Year_Entrydate
33812>>>>>Register_Object Year_Year_Year
33812>>>>>
33812>>>>>
33812>>>>>
33812>>>>>//AB-StoreTopStart
33812>>>>>
33812>>>>>
33812>>>>>
33812>>>>>
33812>>>>>       String  gs_selected_beto_site
33812>>>>>
33812>>>>>Open SysCurXR
33814>>>>>Open Nomisma
33816>>>>>
33816>>>>>//AB-StoreTopEnd
33816>>>>>
33816>>>>>//AB-IgnoreStart
33816>>>>>
33816>>>>>Use DFAllEnt.pkg
33816>>>>>Use dbForm.Sub
33816>>>>>Use Button.Sub
33816>>>>>Use Txtbox.Sub
33816>>>>>Use Chkbox.Sub
33816>>>>>
33816>>>>>
33816>>>>>Use COMPANY.DD
INCLUDING FILE: COMPANY.DD
33816>>>>>>>//DDB-FileStart
33816>>>>>>>//DDB-HeaderStart
33816>>>>>>>
33816>>>>>>>// File Name : COMPANY.DD
33816>>>>>>>// Class Name: Company_DataDictionary
33816>>>>>>>// Revision  : 64
33816>>>>>>>// Version   : 2
33816>>>>>>>
33816>>>>>>>Use  Windows           // Basic Definitions
33816>>>>>>>Use  DataDict          // DataDictionary Class Definition
33816>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
33816>>>>>>>
33816>>>>>>>Open Company
33818>>>>>>>Open Branch
33820>>>>>>>
33820>>>>>>>//DDB-HeaderEnd
33820>>>>>>>//DDB-ValidationStart
33820>>>>>>>
33820>>>>>>>Register_Object Company_Company_Doy_VT
33820>>>>>>>Register_Object Company_Company_J_Code_VT
33820>>>>>>>
33820>>>>>>>Object Company_Company_Doy_VT  is a CodeValidationTable
33822>>>>>>>    Set Type_Value        To "DOY"
33823>>>>>>>    Set Allow_Blank_State To TRUE
33824>>>>>>>    //DDB-ValidationCustomStart
33824>>>>>>>    //DDB-ValidationCustomEnd
33824>>>>>>>End_Object   // Company_Company_Doy_VT
33825>>>>>>>
33825>>>>>>>Object Company_Company_J_Code_VT  is a CodeValidationTable
33827>>>>>>>    Set Type_Value        To "JOB"
33828>>>>>>>    Set Allow_Blank_State To TRUE
33829>>>>>>>    //DDB-ValidationCustomStart
33829>>>>>>>    //DDB-ValidationCustomEnd
33829>>>>>>>End_Object   // Company_Company_J_Code_VT
33830>>>>>>>//DDB-ValidationEnd
33830>>>>>>>//DDB-SelectionStart
33830>>>>>>>//DDB/ ExternalSelectionList sl001  sl001.sl
33830>>>>>>>Register_Object sl001
33830>>>>>>>//DDB-SelectionEnd
33830>>>>>>> 
33830>>>>>>>Class Company_DataDictionary  is a DataDictionary
33831>>>>>>> 
33831>>>>>>>    // Update:
33831>>>>>>> 
33831>>>>>>>    Procedure Update
33832>>>>>>>        Forward Send Update
33834>>>>>>>        move 'DOY' to company.doy_type
33835>>>>>>>        move 'JOB' to company.jcode_type 
33836>>>>>>>        // Insert Code Here
33836>>>>>>>    End_Procedure   // Update
33837>>>>>>> 
33837>>>>>>>
33837>>>>>>>    // Operation_Not_Allowed:
33837>>>>>>>
33837>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
33838>>>>>>>        // Insert Code Here
33838>>>>>>>        Case Begin
33838>>>>>>>             Case (iError_Num = 1001)
33840>>>>>>>                  Error 1001 "DDC 051:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª „«˜ ¨œå˜ª!\n\n‰œ¤æª ‰à› ¡æª"
33841>>>>>>>>
33841>>>>>>>             Case Break
33842>>>>>>>
33842>>>>>>>             Case Else
33842>>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
33844>>>>>>>        Case End
33844>>>>>>>    End_Procedure   // Operation_Not_Allowed
33845>>>>>>>
33845>>>>>>>
33845>>>>>>>    // Validate_Save:
33845>>>>>>>
33845>>>>>>>    Function Validate_Save  Returns Integer
33846>>>>>>>        Local Integer iReturnVal
33847>>>>>>>        Forward Get Validate_Save  To iReturnVal
33849>>>>>>>        If (Not(iReturnVal)) Begin
33851>>>>>>>            // Insert Code Here
33851>>>>>>>            If (Company.Company_Code="") Send Operation_Not_Allowed 1001
33854>>>>>>>        End
33854>>>>>>>>
33854>>>>>>>        Function_Return iReturnVal
33855>>>>>>>    End_Function   // Validate_Save
33856>>>>>>>
33856>>>>>>>
33856>>>>>>>    // Define_Fields:
33856>>>>>>>    // This procedure is used to set up all data-dictionary rules.
33856>>>>>>>
33856>>>>>>>    Procedure Define_Fields
33857>>>>>>>        Forward Send Define_Fields
33859>>>>>>>        //DDB-Generated-Code-Location
33859>>>>>>>        //DDB-DefineFieldStart
33859>>>>>>>
33859>>>>>>>        Set Main_File            To Company.File_Number
33860>>>>>>>        Set Cascade_Delete_State To FALSE
33861>>>>>>>
33861>>>>>>>
33861>>>>>>>        // Child (Client) file structure................
33861>>>>>>>        Send Add_Client_File  Branch.File_Number
33862>>>>>>>
33862>>>>>>>        // Field-based properties.......................
33862>>>>>>>
33862>>>>>>>        // Company.Company_Code
33862>>>>>>>        Set Field_Options          Field Company.Company_Code To DD_AUTOFIND   
33863>>>>>>>        Set Field_Prompt_Object    Field Company.Company_Code To (sl001(Self))
33864>>>>>>>
33864>>>>>>>        // Company.Company_Name
33864>>>>>>>        Set Field_Options          Field Company.Company_Name To DD_REQUIRED   
33865>>>>>>>        Set Field_Prompt_Object    Field Company.Company_Name To (sl001(Self))
33866>>>>>>>
33866>>>>>>>        // Company.Company_Afm
33866>>>>>>>        Set Field_Options          Field Company.Company_Afm To DD_AUTOFIND   
33867>>>>>>>
33867>>>>>>>        // Company.Company_Addr
33867>>>>>>>
33867>>>>>>>        // Company.Company_Tk
33867>>>>>>>
33867>>>>>>>        // Company.Company_Poli
33867>>>>>>>
33867>>>>>>>        // Company.Company_Doy
33867>>>>>>>        Set Field_Value_Table      Field Company.Company_Doy To (Company_Company_Doy_VT(Self))
33868>>>>>>>
33868>>>>>>>        // Company.Company_J_Code
33868>>>>>>>        Set Field_Value_Table      Field Company.Company_J_Code To (Company_Company_J_Code_VT(Self))
33869>>>>>>>
33869>>>>>>>        // Company.Company_C_Code0
33869>>>>>>>
33869>>>>>>>        // Company.Company_C_Cod00
33869>>>>>>>
33869>>>>>>>        // Company.Company_C_Coder
33869>>>>>>>
33869>>>>>>>        // Company.Company_Tel
33869>>>>>>>
33869>>>>>>>        // Company.Company_Fax
33869>>>>>>>
33869>>>>>>>        // Company.Company_Email
33869>>>>>>>
33869>>>>>>>        // Company.Company_Resp
33869>>>>>>>
33869>>>>>>>        // Company.Company_Bitmap
33869>>>>>>>
33869>>>>>>>        // Company.Beto_Site
33869>>>>>>>
33869>>>>>>>        // Company.Logo
33869>>>>>>>
33869>>>>>>>        // Company.Doy_Type
33869>>>>>>>
33869>>>>>>>        // Company.Jcode_Type
33869>>>>>>>
33869>>>>>>>        // Company.Sap_Code
33869>>>>>>>
33869>>>>>>>        // Company.Sap_Path
33869>>>>>>>
33869>>>>>>>        //DDB-DefineFieldEnd
33869>>>>>>>    End_Procedure    // Define_Fields
33870>>>>>>>
33870>>>>>>>    // Field_Defaults:
33870>>>>>>>    // This procedure is used to establish default field values.
33870>>>>>>>
33870>>>>>>>    Procedure Field_Defaults
33871>>>>>>>        Forward Send Field_Defaults
33873>>>>>>>        //DDB-Generated-Code-Location
33873>>>>>>>        //DDB-FieldDefaultStart
33873>>>>>>>        //DDB-FieldDefaultEnd
33873>>>>>>>    End_Procedure    // Field_Defaults
33874>>>>>>>End_Class    // Company_DataDictionary
33875>>>>>>>
33875>>>>>>>//DDB-Selection-pkg-Start
33875>>>>>>>
33875>>>>>>>Use sl001.sl         // sl001
INCLUDING FILE: SL001.SL
33875>>>>>>>>>//AB/ Project sl001 : Etairies
33875>>>>>>>>>//AB/     Object prj is a Lookup_Project
33875>>>>>>>>>//AB/         Set ProjectName to "sl001 : Etairies"
33875>>>>>>>>>//AB/         Set ProjectFileName to "sl001.SL"
33875>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
33875>>>>>>>>>
33875>>>>>>>>>// Project Object Structure
33875>>>>>>>>>//   sl001 is a dbModalPanel
33875>>>>>>>>>//     Company_DD is a DataDictionary
33875>>>>>>>>>//     oSelList is a dbList
33875>>>>>>>>>//     oOK_bn is a ButtonSub
33875>>>>>>>>>//     oCancel_bn is a ButtonSub
33875>>>>>>>>>//     oSearch_bn is a ButtonSub
33875>>>>>>>>>
33875>>>>>>>>>// Register all objects
33875>>>>>>>>>Register_Object Company_DD
33875>>>>>>>>>Register_Object oCancel_bn
33875>>>>>>>>>Register_Object oOK_bn
33875>>>>>>>>>Register_Object oSearch_bn
33875>>>>>>>>>Register_Object oSelList
33875>>>>>>>>>Register_Object sl001
33875>>>>>>>>>
33875>>>>>>>>>
33875>>>>>>>>>    //AB-IgnoreStart
33875>>>>>>>>>
33875>>>>>>>>>    Use DFAllEnt.pkg
33875>>>>>>>>>    Use Button.Sub
33875>>>>>>>>>
33875>>>>>>>>>
33875>>>>>>>>>    Use COMPANY.DD
33875>>>>>>>>>    
33875>>>>>>>>>    //AB-IgnoreEnd
33875>>>>>>>>>
33875>>>>>>>>>    CD_Popup_Object sl001 is a dbModalPanel
33894>>>>>>>>>        Set Label to "„«˜ ¨åœª"
33895>>>>>>>>>        Set Size to 148 297
33896>>>>>>>>>        Set Location to 12 27
33897>>>>>>>>>
33897>>>>>>>>>        //AB-DDOStart
33897>>>>>>>>>
33897>>>>>>>>>        Object Company_DD is a Company_DataDictionary
33899>>>>>>>>>        End_Object    // Company_DD
33900>>>>>>>>>
33900>>>>>>>>>        Set Main_DD to (Company_DD(self))
33901>>>>>>>>>        Set Server to (Company_DD(self))
33902>>>>>>>>>
33902>>>>>>>>>        //AB-DDOEnd
33902>>>>>>>>>
33902>>>>>>>>>        Object oSelList is a dbList
33904>>>>>>>>>            Set Main_File to Company.File_Number
33905>>>>>>>>>            Set Size to 105 280
33906>>>>>>>>>            Set Location to 6 6
33907>>>>>>>>>
33907>>>>>>>>>            Begin_Row
33910>>>>>>>>>                Entry_Item Company.Company_code
33911>>>>>>>>>                Entry_Item Company.Company_name
33912>>>>>>>>>                Entry_Item Company.Company_afm
33913>>>>>>>>>            End_Row
33918>>>>>>>>>
33918>>>>>>>>>            Set Form_Width    item 0 to 42
33919>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
33920>>>>>>>>>            
33920>>>>>>>>>            Set Form_Width    item 1 to 150
33921>>>>>>>>>            Set Header_Label  item 1 to "„§à¤¬£å˜"
33922>>>>>>>>>            
33922>>>>>>>>>            Set Form_Width    item 2 to 80
33923>>>>>>>>>            Set Header_Label  item 2 to "€.”.‹"
33924>>>>>>>>>            
33924>>>>>>>>>        End_Object    // oSelList
33925>>>>>>>>>
33925>>>>>>>>>        Object oOK_bn is a ButtonSub
33927>>>>>>>>>            Set Label to "&„§ ¢¦šã"
33928>>>>>>>>>            Set Location to 115 126
33929>>>>>>>>>
33929>>>>>>>>>            //AB-StoreStart
33929>>>>>>>>>            Procedure OnClick
33931>>>>>>>>>                Send OK To (oSelList(current_object))
33932>>>>>>>>>            End_Procedure
33933>>>>>>>>>            //AB-StoreEnd
33933>>>>>>>>>
33933>>>>>>>>>        End_Object    // oOK_bn
33934>>>>>>>>>
33934>>>>>>>>>        Object oCancel_bn is a ButtonSub
33936>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
33937>>>>>>>>>            Set Location to 115 181
33938>>>>>>>>>
33938>>>>>>>>>            //AB-StoreStart
33938>>>>>>>>>            Procedure OnClick
33940>>>>>>>>>                Send Cancel To (oSelList(current_object))
33941>>>>>>>>>            End_Procedure
33942>>>>>>>>>            //AB-StoreEnd
33942>>>>>>>>>
33942>>>>>>>>>        End_Object    // oCancel_bn
33943>>>>>>>>>
33943>>>>>>>>>        Object oSearch_bn is a ButtonSub
33945>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
33946>>>>>>>>>            Set Location to 115 236
33947>>>>>>>>>
33947>>>>>>>>>            //AB-StoreStart
33947>>>>>>>>>            Procedure OnClick
33949>>>>>>>>>                Send Search To (oSelList(current_object))
33950>>>>>>>>>            End_Procedure
33951>>>>>>>>>            //AB-StoreEnd
33951>>>>>>>>>
33951>>>>>>>>>        End_Object    // oSearch_bn
33952>>>>>>>>>
33952>>>>>>>>>
33952>>>>>>>>>        //AB-StoreStart
33952>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To oOk_bn
33953>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To oCancel_bn
33954>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To oSearch_bn
33955>>>>>>>>>        //AB-StoreEnd
33955>>>>>>>>>
33955>>>>>>>>>    CD_End_Object    // sl001
33957>>>>>>>>>>
33957>>>>>>>>>
33957>>>>>>>>>//AB/     End_Object    // prj
33957>>>>>>>
33957>>>>>>>//DDB-Selection-pkg-End
33957>>>>>>>//DDB-FileEnd
33957>>>>>Use BRANCH.DD
INCLUDING FILE: BRANCH.DD
33957>>>>>>>//DDB-FileStart
33957>>>>>>>//DDB-HeaderStart
33957>>>>>>>
33957>>>>>>>// File Name : BRANCH.DD
33957>>>>>>>// Class Name: Branch_DataDictionary
33957>>>>>>>// Revision  : 96
33957>>>>>>>// Version   : 2
33957>>>>>>>
33957>>>>>>>Use  Windows           // Basic Definitions
33957>>>>>>>Use  DataDict          // DataDictionary Class Definition
33957>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
33957>>>>>>>
33957>>>>>>>Open Branch
33959>>>>>>>Open Year
33961>>>>>>>Open Brzones
INCLUDING FILE: BRZONES.FD
33963>>>>>>>Open Tpbranch
INCLUDING FILE: TPBRANCH.FD
33965>>>>>>>Open Company
33967>>>>>>>Open Sysrecg
INCLUDING FILE: SYSRECG.FD
33969>>>>>>>
33969>>>>>>>//DDB-HeaderEnd
33969>>>>>>>//DDB-ValidationStart
33969>>>>>>>
33969>>>>>>>Register_Object Branch_Branch_Doy_VT
33969>>>>>>>Register_Object Branch_Branch_C_Code0_VT
33969>>>>>>>
33969>>>>>>>Object Branch_Branch_Doy_VT  is a CodeValidationTable
33971>>>>>>>    Set Type_Value        To "DOY"
33972>>>>>>>    Set Validate_State    To FALSE
33973>>>>>>>    Set Allow_Blank_State To TRUE
33974>>>>>>>    //DDB-ValidationCustomStart
33974>>>>>>>    //DDB-ValidationCustomEnd
33974>>>>>>>End_Object   // Branch_Branch_Doy_VT
33975>>>>>>>
33975>>>>>>>Object Branch_Branch_C_Code0_VT  is a CodeValidationTable
33977>>>>>>>    Set Type_Value        To ""
33978>>>>>>>    Set Allow_Blank_State To TRUE
33979>>>>>>>    //DDB-ValidationCustomStart
33979>>>>>>>    //DDB-ValidationCustomEnd
33979>>>>>>>End_Object   // Branch_Branch_C_Code0_VT
33980>>>>>>>//DDB-ValidationEnd
33980>>>>>>>//DDB-SelectionStart
33980>>>>>>>//DDB/ ExternalSelectionList SL002  Sl002.sl
33980>>>>>>>Register_Object SL002
33980>>>>>>>//DDB-SelectionEnd
33980>>>>>>>
33980>>>>>>>Class Branch_DataDictionary  is a DataDictionary
33981>>>>>>> 
33981>>>>>>>    Procedure Save_Main_File
33982>>>>>>>        Forward Send Save_Main_File
33984>>>>>>>        // Insert Code Here
33984>>>>>>>    End_Procedure   // Save_Main_File
33985>>>>>>> 
33985>>>>>>>    Procedure Creating
33986>>>>>>>        Forward Send Creating
33988>>>>>>>        // Insert Code Here
33988>>>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Branch.Branch_Rec0)))))) to Branch.Branch_Recr
33989>>>>>>>    End_Procedure   // Creating
33990>>>>>>>
33990>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
33991>>>>>>>        // Insert Code Here
33991>>>>>>>        Case Begin
33991>>>>>>>             Case (iError_Num = 1001)
33993>>>>>>>                  Error 1001 "DDC 002:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
33994>>>>>>>>
33994>>>>>>>             Case Break
33995>>>>>>>
33995>>>>>>>             Case Else
33995>>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
33997>>>>>>>        Case End
33997>>>>>>>    End_Procedure   // Operation_Not_Allowed
33998>>>>>>>
33998>>>>>>>
33998>>>>>>>    // Validate_Save:
33998>>>>>>>
33998>>>>>>>    Function Validate_Save  Returns Integer
33999>>>>>>>        Local Integer iReturnVal
34000>>>>>>>        Forward Get Validate_Save  To iReturnVal
34002>>>>>>>        If (Not(iReturnVal)) Begin
34004>>>>>>>            // Insert Code Here
34004>>>>>>>            If (Branch.Branch_Code="") Send Operation_Not_Allowed 1001
34007>>>>>>>        End
34007>>>>>>>>
34007>>>>>>>        Function_Return iReturnVal
34008>>>>>>>    End_Function   // Validate_Save
34009>>>>>>>
34009>>>>>>>
34009>>>>>>>    // Define_Fields:
34009>>>>>>>    // This procedure is used to set up all data-dictionary rules.
34009>>>>>>>
34009>>>>>>>    Procedure Define_Fields
34010>>>>>>>        Forward Send Define_Fields
34012>>>>>>>        //DDB-Generated-Code-Location
34012>>>>>>>        //DDB-DefineFieldStart
34012>>>>>>>
34012>>>>>>>        Set Main_File            To Branch.File_Number
34013>>>>>>>        Set Cascade_Delete_State To FALSE
34014>>>>>>>
34014>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
34015>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOENTER     DD_FINDREQ    
34016>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
34017>>>>>>>
34017>>>>>>>        // Child (Client) file structure................
34017>>>>>>>        Send Add_Client_File  Year.File_Number
34018>>>>>>>        Send Add_Client_File  Brzones.File_Number
34019>>>>>>>        Send Add_Client_File  Tpbranch.File_Number
34020>>>>>>>
34020>>>>>>>        // Parent (Server) file structure...............
34020>>>>>>>        Send Add_Server_File  Company.File_Number
34021>>>>>>>
34021>>>>>>>        // External (System) file structure.............
34021>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
34022>>>>>>>
34022>>>>>>>        Define_Auto_Increment  Sysrecg.Branch_Rec0  To Branch.Branch_Rec0
34025>>>>>>>
34025>>>>>>>        // Field-based properties.......................
34025>>>>>>>
34025>>>>>>>        // Branch.Company_Code
34025>>>>>>>
34025>>>>>>>        // Branch.Branch_Code
34025>>>>>>>        Set Field_Options          Field Branch.Branch_Code To DD_AUTOFIND   
34026>>>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Code To (SL002(Self))
34027>>>>>>>        Set Key_Field_State        Field Branch.Branch_Code To TRUE
34028>>>>>>>
34028>>>>>>>        // Branch.Branch_Rec0
34028>>>>>>>
34028>>>>>>>        // Branch.Branch_Recr
34028>>>>>>>
34028>>>>>>>        // Branch.Branch_Name
34028>>>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Name To (SL002(Self))
34029>>>>>>>
34029>>>>>>>        // Branch.Branch_Afm
34029>>>>>>>
34029>>>>>>>        // Branch.Branch_Addr
34029>>>>>>>
34029>>>>>>>        // Branch.Branch_Tk
34029>>>>>>>
34029>>>>>>>        // Branch.Branch_Poli
34029>>>>>>>
34029>>>>>>>        // Branch.Branch_Doy
34029>>>>>>>        Set Field_Value_Table      Field Branch.Branch_Doy To (Branch_Branch_Doy_VT(Self))
34030>>>>>>>
34030>>>>>>>        // Branch.Branch_J_Code
34030>>>>>>>
34030>>>>>>>        // Branch.Branch_C_Code0
34030>>>>>>>        Set Field_Value_Table      Field Branch.Branch_C_Code0 To (Branch_Branch_C_Code0_VT(Self))
34031>>>>>>>
34031>>>>>>>        // Branch.Branch_C_Code00
34031>>>>>>>
34031>>>>>>>        // Branch.Branch_C_Coder
34031>>>>>>>
34031>>>>>>>        // Branch.Branch_Tel
34031>>>>>>>
34031>>>>>>>        // Branch.Branch_Fax
34031>>>>>>>
34031>>>>>>>        // Branch.Branch_Email
34031>>>>>>>
34031>>>>>>>        // Branch.Branch_Resp
34031>>>>>>>
34031>>>>>>>        // Branch.Branch_Bitmap
34031>>>>>>>
34031>>>>>>>        // Branch.Branch_Site
34031>>>>>>>
34031>>>>>>>        // Branch.Branch_Apoth
34031>>>>>>>
34031>>>>>>>        // Branch.Beto_Site
34031>>>>>>>
34031>>>>>>>        // Branch.Path_Exp
34031>>>>>>>
34031>>>>>>>        // Branch.Exp_Txtname
34031>>>>>>>
34031>>>>>>>        // Branch.Send_Phone
34031>>>>>>>
34031>>>>>>>        // Branch.Send_Path_Files
34031>>>>>>>
34031>>>>>>>        // Branch.Send_Path_Conf
34031>>>>>>>
34031>>>>>>>        // Branch.Tomeas_Code
34031>>>>>>>
34031>>>>>>>        // Branch.Ftp_Sec_Retry
34031>>>>>>>
34031>>>>>>>        // Branch.Ftp_Sec_Exit
34031>>>>>>>
34031>>>>>>>        // Branch.Ras_Name
34031>>>>>>>
34031>>>>>>>        // Branch.Ras_Passw
34031>>>>>>>
34031>>>>>>>        // Branch.Ras_Domain
34031>>>>>>>
34031>>>>>>>        // Branch.Last_Hmnia_Ekt
34031>>>>>>>
34031>>>>>>>        // Branch.Deop_Logo
34031>>>>>>>
34031>>>>>>>        // Branch.Entolh
34031>>>>>>>
34031>>>>>>>        // Branch.Paragogh
34031>>>>>>>
34031>>>>>>>        // Branch.Locked_Until
34031>>>>>>>
34031>>>>>>>        // Branch.Sap_Code
34031>>>>>>>
34031>>>>>>>        // Branch.Perioxh
34031>>>>>>>
34031>>>>>>>        // Branch.Egkatastash
34031>>>>>>>
34031>>>>>>>        // Branch.Date_Locked
34031>>>>>>>        Set Field_Mask_Type        Field Branch.Date_Locked To MASK_DATE_WINDOW
34032>>>>>>>
34032>>>>>>>        // Branch.Ypokat1
34032>>>>>>>
34032>>>>>>>        // Branch.Ypokat1a
34032>>>>>>>
34032>>>>>>>        // Branch.Ypokat2
34032>>>>>>>
34032>>>>>>>        // Branch.Edra1
34032>>>>>>>
34032>>>>>>>        // Branch.Edra1a
34032>>>>>>>
34032>>>>>>>        // Branch.Edra2
34032>>>>>>>
34032>>>>>>>        //DDB-DefineFieldEnd
34032>>>>>>>    End_Procedure    // Define_Fields
34033>>>>>>>
34033>>>>>>>    // Field_Defaults:
34033>>>>>>>    // This procedure is used to establish default field values.
34033>>>>>>>
34033>>>>>>>    Procedure Field_Defaults
34034>>>>>>>        Forward Send Field_Defaults
34036>>>>>>>        //DDB-Generated-Code-Location
34036>>>>>>>        //DDB-FieldDefaultStart
34036>>>>>>>        //DDB-FieldDefaultEnd
34036>>>>>>>    End_Procedure    // Field_Defaults
34037>>>>>>>End_Class    // Branch_DataDictionary
34038>>>>>>>
34038>>>>>>>//DDB-Selection-pkg-Start
34038>>>>>>>
34038>>>>>>>Use Sl002.sl         // SL002
INCLUDING FILE: SL002.SL
34038>>>>>>>>>//AB/ Project SL002:Branch
34038>>>>>>>>>//AB/ Object prj is a Lookup_Project
34038>>>>>>>>>//AB/     Set ProjectName to "SL002:Branch"
34038>>>>>>>>>//AB/     Set ProjectFileName to "Sl002.sl"
34038>>>>>>>>>
34038>>>>>>>>>// Project Object Structure
34038>>>>>>>>>//   SL002 is a dbModalPanelSub
34038>>>>>>>>>//     Company_DD is a DataDictionary
34038>>>>>>>>>//     Branch_DD is a DataDictionary
34038>>>>>>>>>//     oSelList is a dbListSub
34038>>>>>>>>>//     oOK_bn is a ButtonSub
34038>>>>>>>>>//     oCancel_bn is a ButtonSub
34038>>>>>>>>>//     oSearch_bn is a ButtonSub
34038>>>>>>>>>
34038>>>>>>>>>// Register all objects
34038>>>>>>>>>Register_Object Branch_DD
34038>>>>>>>>>Register_Object Company_DD
34038>>>>>>>>>Register_Object oCancel_bn
34038>>>>>>>>>Register_Object oOK_bn
34038>>>>>>>>>Register_Object oSearch_bn
34038>>>>>>>>>Register_Object oSelList
34038>>>>>>>>>Register_Object SL002
34038>>>>>>>>>
34038>>>>>>>>>
34038>>>>>>>>>//AB-IgnoreStart
34038>>>>>>>>>
34038>>>>>>>>>Use DFAllEnt.pkg
34038>>>>>>>>>Use dbList.Sub
34038>>>>>>>>>Use Button.Sub
34038>>>>>>>>>
34038>>>>>>>>>
34038>>>>>>>>>Use COMPANY.DD
34038>>>>>>>>>Use BRANCH.DD
34038>>>>>>>>>
34038>>>>>>>>>//AB-IgnoreEnd
34038>>>>>>>>>
34038>>>>>>>>>Object SL002 is a dbModalPanelSub
34040>>>>>>>>>
34040>>>>>>>>>    //AB-StoreTopStart
34040>>>>>>>>>    Property String psFragmaCompanyCode  ""
34042>>>>>>>>>    
34042>>>>>>>>>    //AB-StoreTopEnd
34042>>>>>>>>>
34042>>>>>>>>>    Set Minimize_Icon to FALSE
34043>>>>>>>>>    Set Label to "“§¦¡˜«˜©«ã£˜«˜"
34044>>>>>>>>>    Set Size to 146 430
34045>>>>>>>>>    Set Location to 4 5
34046>>>>>>>>>    Set Exit_Application_Local_State to FALSE
34047>>>>>>>>>    Set Modal_State to FALSE
34048>>>>>>>>>
34048>>>>>>>>>    //AB-DDOStart
34048>>>>>>>>>
34048>>>>>>>>>    Object Company_DD is a Company_DataDictionary
34050>>>>>>>>>    End_Object    // Company_DD
34051>>>>>>>>>
34051>>>>>>>>>    Object Branch_DD is a Branch_DataDictionary
34053>>>>>>>>>        Set DDO_Server to (Company_DD(self))
34054>>>>>>>>>
34054>>>>>>>>>        //AB-StoreStart
34054>>>>>>>>>        Procedure OnConstrain
34056>>>>>>>>>             String lsCompanyCode
34057>>>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
34058>>>>>>>>>             If (lsCompanyCode <> "") Constrain Branch.Company_code eq lsCompanyCode
34062>>>>>>>>>        End_Procedure // OnConstrain
34063>>>>>>>>>        
34063>>>>>>>>>        
34063>>>>>>>>>        
34063>>>>>>>>>        //AB-StoreEnd
34063>>>>>>>>>
34063>>>>>>>>>    End_Object    // Branch_DD
34064>>>>>>>>>
34064>>>>>>>>>    Set Main_DD to (Branch_DD(self))
34065>>>>>>>>>    Set Server to (Branch_DD(self))
34066>>>>>>>>>
34066>>>>>>>>>    //AB-DDOEnd
34066>>>>>>>>>
34066>>>>>>>>>    Object oSelList is a dbListSub
34068>>>>>>>>>        Set Main_File to Branch.File_Number
34069>>>>>>>>>        Set Size to 105 415
34070>>>>>>>>>        Set Location to 6 6
34071>>>>>>>>>
34071>>>>>>>>>        Begin_Row
34074>>>>>>>>>            Entry_Item Branch.Branch_code
34075>>>>>>>>>            Entry_Item Branch.Branch_name
34076>>>>>>>>>            Entry_Item Company.Company_code
34077>>>>>>>>>            Entry_Item Company.Company_name
34078>>>>>>>>>            Entry_Item Branch.Beto_site
34079>>>>>>>>>            Entry_Item Branch.Branch_recr
34080>>>>>>>>>        End_Row
34085>>>>>>>>>
34085>>>>>>>>>        Set Form_Width    item 0 to 60
34086>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
34087>>>>>>>>>        
34087>>>>>>>>>        Set Form_Width    item 1 to 128
34088>>>>>>>>>        Set Header_Label  item 1 to "Ž¤¦£˜"
34089>>>>>>>>>        
34089>>>>>>>>>        Set Form_Width    item 2 to 69
34090>>>>>>>>>        Set Header_Label  item 2 to "‰à› ¡æª „«˜ ¨å˜ª"
34091>>>>>>>>>        
34091>>>>>>>>>        Set Form_Width    item 3 to 109
34092>>>>>>>>>        Set Header_Label  item 3 to "Ž¤¦£˜ „«˜ ¨å˜ª"
34093>>>>>>>>>        
34093>>>>>>>>>        Set Form_Width    item 4 to 42
34094>>>>>>>>>        Set Header_Label  item 4 to "Site"
34095>>>>>>>>>        
34095>>>>>>>>>        Set Form_Width    item 5 to 0
34096>>>>>>>>>        Set Header_Label  item 5 to ""
34097>>>>>>>>>        
34097>>>>>>>>>
34097>>>>>>>>>        //AB-StoreStart
34097>>>>>>>>>                
34097>>>>>>>>>        Property String psStoreFragmaCompanyCode  ""
34099>>>>>>>>>        
34099>>>>>>>>>        Procedure Store_Defaults
34101>>>>>>>>>            forward send Store_Defaults
34103>>>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
34104>>>>>>>>>        end_Procedure // Store_Defaults
34105>>>>>>>>>        
34105>>>>>>>>>        Procedure Restore_Defaults
34107>>>>>>>>>            forward send Restore_Defaults
34109>>>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
34110>>>>>>>>>        end_Procedure // Restore_Defaults
34111>>>>>>>>>        
34111>>>>>>>>>        Procedure Activating
34113>>>>>>>>>            Forward Send Activating
34115>>>>>>>>>            Send Rebuild_Constraints to (Branch_DD(self))
34116>>>>>>>>>        End_Procedure // Activating
34117>>>>>>>>>        
34117>>>>>>>>>        Set Column_Options Item 5 to NoEnter True
34118>>>>>>>>>        
34118>>>>>>>>>        
34118>>>>>>>>>        //AB-StoreEnd
34118>>>>>>>>>
34118>>>>>>>>>    End_Object    // oSelList
34119>>>>>>>>>
34119>>>>>>>>>    Object oOK_bn is a ButtonSub
34121>>>>>>>>>        Set Label to "&„§ ¢¦šã"
34122>>>>>>>>>        Set Location to 112 262
34123>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34124>>>>>>>>>
34124>>>>>>>>>        //AB-StoreStart
34124>>>>>>>>>        Procedure OnClick
34126>>>>>>>>>            Send OK To (oSelList(current_object))
34127>>>>>>>>>        End_Procedure
34128>>>>>>>>>        //AB-StoreEnd
34128>>>>>>>>>
34128>>>>>>>>>    End_Object    // oOK_bn
34129>>>>>>>>>
34129>>>>>>>>>    Object oCancel_bn is a ButtonSub
34131>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
34132>>>>>>>>>        Set Location to 112 317
34133>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34134>>>>>>>>>
34134>>>>>>>>>        //AB-StoreStart
34134>>>>>>>>>        Procedure OnClick
34136>>>>>>>>>            Send Cancel To (oSelList(current_object))
34137>>>>>>>>>        End_Procedure
34138>>>>>>>>>        //AB-StoreEnd
34138>>>>>>>>>
34138>>>>>>>>>    End_Object    // oCancel_bn
34139>>>>>>>>>
34139>>>>>>>>>    Object oSearch_bn is a ButtonSub
34141>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
34142>>>>>>>>>        Set Location to 112 372
34143>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34144>>>>>>>>>
34144>>>>>>>>>        //AB-StoreStart
34144>>>>>>>>>        Procedure OnClick
34146>>>>>>>>>            Send Search To (oSelList(current_object))
34147>>>>>>>>>        End_Procedure
34148>>>>>>>>>        //AB-StoreEnd
34148>>>>>>>>>
34148>>>>>>>>>    End_Object    // oSearch_bn
34149>>>>>>>>>
34149>>>>>>>>>
34149>>>>>>>>>    //AB-StoreStart
34149>>>>>>>>>    
34149>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
34150>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
34151>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
34152>>>>>>>>>    
34152>>>>>>>>>    
34152>>>>>>>>>    
34152>>>>>>>>>    //AB-StoreEnd
34152>>>>>>>>>
34152>>>>>>>>>End_Object    // SL002
34153>>>>>>>>>
34153>>>>>>>>>//AB/ End_Object    // prj
34153>>>>>>>
34153>>>>>>>//DDB-Selection-pkg-End
34153>>>>>>>//DDB-FileEnd
34153>>>>>Use YEAR.DD
INCLUDING FILE: YEAR.DD
34153>>>>>>>//DDB-FileStart
34153>>>>>>>//DDB-HeaderStart
34153>>>>>>>
34153>>>>>>>// File Name : YEAR.DD
34153>>>>>>>// Class Name: Year_DataDictionary
34153>>>>>>>// Revision  : 119
34153>>>>>>>// Version   : 2
34153>>>>>>>
34153>>>>>>>Use  Windows           // Basic Definitions
34153>>>>>>>Use  DataDict          // DataDictionary Class Definition
34153>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
34153>>>>>>>
34153>>>>>>>Open Year
34155>>>>>>>Open Branch
34157>>>>>>>Open Syscurxr
34159>>>>>>>
34159>>>>>>>//DDB-HeaderEnd
34159>>>>>>>//DDB-ValidationStart
34159>>>>>>>
34159>>>>>>>Register_Object Year_Year_C_Code0_VT1
34159>>>>>>>Register_Object Year_Year_C_Code00_VT1
34159>>>>>>>Register_Object Year_Year_C_Coder_VT1
34159>>>>>>>
34159>>>>>>>Object Year_Year_C_Code0_VT1  is a CodeValidationTable
34161>>>>>>>    Set Type_Value        To "CURRENCY"
34162>>>>>>>    //DDB-ValidationCustomStart
34162>>>>>>>    //DDB-ValidationCustomEnd
34162>>>>>>>End_Object   // Year_Year_C_Code0_VT1
34163>>>>>>>
34163>>>>>>>Object Year_Year_C_Code00_VT1  is a CodeValidationTable
34165>>>>>>>    Set Type_Value        To "CURRENCY"
34166>>>>>>>    //DDB-ValidationCustomStart
34166>>>>>>>    //DDB-ValidationCustomEnd
34166>>>>>>>End_Object   // Year_Year_C_Code00_VT1
34167>>>>>>>
34167>>>>>>>Object Year_Year_C_Coder_VT1  is a CodeValidationTable
34169>>>>>>>    Set Type_Value        To "CURRENCY"
34170>>>>>>>    //DDB-ValidationCustomStart
34170>>>>>>>    //DDB-ValidationCustomEnd
34170>>>>>>>End_Object   // Year_Year_C_Coder_VT1
34171>>>>>>>//DDB-ValidationEnd
34171>>>>>>>//DDB-SelectionStart
34171>>>>>>>//DDB/ ExternalSelectionList SL003  Sl003.sl
34171>>>>>>>Register_Object SL003
34171>>>>>>>//DDB-SelectionEnd
34171>>>>>>>            
34171>>>>>>>Class Year_DataDictionary  is a DataDictionary
34172>>>>>>>    
34172>>>>>>>    Procedure Creating
34173>>>>>>>        Forward Send Creating
34175>>>>>>>        // Insert Code Here
34175>>>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Year.Year_Year)))))) to Year.Year_Recr
34176>>>>>>>    End_Procedure   // Creating
34177>>>>>>>
34177>>>>>>>
34177>>>>>>>    // Operation_Not_Allowed:
34177>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
34178>>>>>>>        // Insert Code Here
34178>>>>>>>        Case Begin    
34178>>>>>>>             Case (iError_Num = 1001)
34180>>>>>>>                  Error 1001 "DDC 053:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
34181>>>>>>>>
34181>>>>>>>             Case Break
34182>>>>>>>             Case (iError_Num=1002)
34185>>>>>>>                Error 1002 "DDC 053:Branch Site ¡˜«œ™˜å¤œ  ©«¦ Year ¡œ¤æ"
34186>>>>>>>>
34186>>>>>>>             Case Break
34187>>>>>>>             Case (iError_Num=1003)
34190>>>>>>>                Error 1003 "DDC 053:Company Code=0"
34191>>>>>>>>
34191>>>>>>>             Case Break
34192>>>>>>>             Case (iError_Num=1004)
34195>>>>>>>                Error 1004 "DDC 053:Branch Code=0"
34196>>>>>>>>
34196>>>>>>>             Case Break
34197>>>>>>>             Case Else
34197>>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
34199>>>>>>>        Case End
34199>>>>>>>    End_Procedure   // Operation_Not_Allowed
34200>>>>>>>
34200>>>>>>>
34200>>>>>>>    // Update:
34200>>>>>>>    // Use this message to effect changes in related-to files. The
34200>>>>>>>    // Backout message should be designed to reverse the effects of this
34200>>>>>>>    // message. It is invoked while the database is locked.
34200>>>>>>>
34200>>>>>>>    Procedure Update
34201>>>>>>>        Forward Send Update
34203>>>>>>>        // Insert Code Here
34203>>>>>>>        Move Company.Company_Code   to Year.Company_Code
34204>>>>>>>        Move Branch.Branch_Code     to Year.Branch_Code
34205>>>>>>>        move branch.beto_site       to year.beto_site
34206>>>>>>>
34206>>>>>>>        //sos:parametrika apo sysfile?
34206>>>>>>>       
34206>>>>>>>       // If ((Year.Year_EntryDate-14) < Year.Year_XrhshFrom) Begin
34206>>>>>>>       //     Move Year.Year_XrhshFrom to Year.Year_OpenFrom
34206>>>>>>>       // End
34206>>>>>>>       // Else Begin
34206>>>>>>>       //     Move (Year.Year_EntryDate-14) to Year.Year_OpenFrom
34206>>>>>>>       // End
34206>>>>>>>      //  Move Year.Year_EntryDate      to Year.Year_OpenTo
34206>>>>>>>    End_Procedure   // Update
34207>>>>>>>
34207>>>>>>>    // Validate_Save:
34207>>>>>>>
34207>>>>>>>    Function Validate_Save  Returns Integer
34208>>>>>>>        Local Integer iReturnVal
34209>>>>>>>        Forward Get Validate_Save  To iReturnVal
34211>>>>>>>        If (Not(iReturnVal)) Begin
34213>>>>>>>                 If (Year.Year_Year   = 0) Send Operation_Not_Allowed 1001
34216>>>>>>>            Else If (Year.Company_Code='') Send Operation_Not_Allowed 1003
34220>>>>>>>            Else If (Year.Branch_Code ='') Send Operation_Not_Allowed 1004
34224>>>>>>>        End
34224>>>>>>>>
34224>>>>>>>        Function_Return iReturnVal
34225>>>>>>>    End_Function   // Validate_Save
34226>>>>>>>
34226>>>>>>>
34226>>>>>>>    // Define_Fields:
34226>>>>>>>    // This procedure is used to set up all data-dictionary rules.
34226>>>>>>>
34226>>>>>>>    Procedure Define_Fields
34227>>>>>>>        Forward Send Define_Fields
34229>>>>>>>        //DDB-Generated-Code-Location
34229>>>>>>>        //DDB-DefineFieldStart
34229>>>>>>>
34229>>>>>>>        Set Main_File            To Year.File_Number
34230>>>>>>>        Set Cascade_Delete_State To FALSE
34231>>>>>>>
34231>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
34232>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
34233>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
34234>>>>>>>
34234>>>>>>>        // Parent (Server) file structure...............
34234>>>>>>>        Send Add_Server_File  Branch.File_Number
34235>>>>>>>
34235>>>>>>>        // External (System) file structure.............
34235>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
34236>>>>>>>
34236>>>>>>>        // Field-based properties.......................
34236>>>>>>>
34236>>>>>>>        // Year.Company_Code
34236>>>>>>>
34236>>>>>>>        // Year.Branch_Code
34236>>>>>>>
34236>>>>>>>        // Year.Year_Year
34236>>>>>>>        Set Field_Options          Field Year.Year_Year To DD_AUTOFIND    DD_REQUIRED   
34237>>>>>>>        Set Field_Prompt_Object    Field Year.Year_Year To (SL003(Self))
34238>>>>>>>        Set Key_Field_State        Field Year.Year_Year To TRUE
34239>>>>>>>
34239>>>>>>>        // Year.Year_Recr
34239>>>>>>>        Set Field_Prompt_Object    Field Year.Year_Recr To (SL003(Self))
34240>>>>>>>
34240>>>>>>>        // Year.Branch_Recr
34240>>>>>>>
34240>>>>>>>        // Year.Year_Descr
34240>>>>>>>
34240>>>>>>>        // Year.Year_Isolfrom
34240>>>>>>>
34240>>>>>>>        // Year.Year_Isolto
34240>>>>>>>
34240>>>>>>>        // Year.Year_Openfrom
34240>>>>>>>
34240>>>>>>>        // Year.Year_Opento
34240>>>>>>>
34240>>>>>>>        // Year.Year_Entrydate
34240>>>>>>>
34240>>>>>>>        // Year.Year_Dateaa
34240>>>>>>>
34240>>>>>>>        // Year.Year_Xrhshfrom
34240>>>>>>>
34240>>>>>>>        // Year.Year_Xrhshto
34240>>>>>>>
34240>>>>>>>        // Year.Year_Myflimit
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numgtypkin
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numgarticl
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numgmove
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numgplan
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numgformat
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numgthaa
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numgopen
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numbtypkin
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numbaxio
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numbarticl
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numbmove
34240>>>>>>>
34240>>>>>>>        // Year.Year_Delimiter
34240>>>>>>>
34240>>>>>>>        // Year.Year_Printer
34240>>>>>>>
34240>>>>>>>        // Year.Year_Valid_Char
34240>>>>>>>
34240>>>>>>>        // Year.Year_C_Code0
34240>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0 To "dbComboFormSub"
34241>>>>>>>        Set Field_Value_Table      Field Year.Year_C_Code0 To (Year_Year_C_Code0_VT1(Self))
34242>>>>>>>
34242>>>>>>>        // Year.Year_C_Code00
34242>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00 To "dbComboFormSub"
34243>>>>>>>        Set Field_Value_Table      Field Year.Year_C_Code00 To (Year_Year_C_Code00_VT1(Self))
34244>>>>>>>
34244>>>>>>>        // Year.Year_C_Coder
34244>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder To "dbComboFormSub"
34245>>>>>>>        Set Field_Value_Table      Field Year.Year_C_Coder To (Year_Year_C_Coder_VT1(Self))
34246>>>>>>>
34246>>>>>>>        // Year.Beto_Site
34246>>>>>>>
34246>>>>>>>        // Year.Clients_Plafon
34246>>>>>>>
34246>>>>>>>        // Year.Payresp_Plafon
34246>>>>>>>
34246>>>>>>>        // Year.Clients_Ofeilh
34246>>>>>>>
34246>>>>>>>        // Year.Payresp_Ofeilh
34246>>>>>>>
34246>>>>>>>        // Year.Working
34246>>>>>>>
34246>>>>>>>        //DDB-DefineFieldEnd
34246>>>>>>>
34246>>>>>>>        Set Main_File            To Year.File_Number
34247>>>>>>>        Set Cascade_Delete_State To FALSE
34248>>>>>>>
34248>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
34249>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
34250>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
34251>>>>>>>
34251>>>>>>>        // Child (Client) file structure................
34251>>>>>>>
34251>>>>>>>        // Parent (Server) file structure...............
34251>>>>>>>        Send Add_Server_File  Branch.File_Number
34252>>>>>>>
34252>>>>>>>        // Field-based properties.......................
34252>>>>>>>
34252>>>>>>>        // Year.Company_Code
34252>>>>>>>
34252>>>>>>>        // Year.Branch_Code
34252>>>>>>>
34252>>>>>>>        // Year.Year_Year
34252>>>>>>>        Set Field_Label_Long       Field Year.Year_Year           To "•¨ã©ž"
34253>>>>>>>        Set Field_Label_Short      Field Year.Year_Year           To "•¨ã©ž"
34254>>>>>>>        Set Field_Options          Field Year.Year_Year           To DD_REQUIRED
34255>>>>>>>        //Set Field_Prompt_Object    Field Year.Year_Year           To (SL053(Self))
34255>>>>>>>
34255>>>>>>>        // Year.Year_Descr
34255>>>>>>>        Set Field_Label_Long       Field Year.Year_Descr          To "œ¨ š¨˜­ã •¨ã©žª"
34256>>>>>>>        Set Field_Label_Short      Field Year.Year_Descr          To "œ¨.•¨ã©žª"
34257>>>>>>>
34257>>>>>>>        // Year.Year_C_Code0
34257>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0        To "dbComboForm"
34258>>>>>>>        Set Field_Label_Long       Field Year.Year_C_Code0        To "‰ç¨ ¦ Œæ£ ©£˜"
34259>>>>>>>        Set Field_Label_Short      Field Year.Year_C_Code0        To "‰¬¨.Œ¦£ ©£˜"
34260>>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code0        To (Year_Year_C_Code0_VT(Self))
34260>>>>>>>
34260>>>>>>>        // Year.Year_C_Code00
34260>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00       To "dbComboForm"
34261>>>>>>>        Set Field_Label_Long       Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
34262>>>>>>>        Set Field_Label_Short      Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
34263>>>>>>>        //Set Field_Options          Field Year.Year_C_Code00       To DD_REQUIRED
34263>>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code00       To (Year_Year_C_Code1_VT(Self))
34263>>>>>>>
34263>>>>>>>        // Year.Year_C_Coder
34263>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder        To "dbComboForm"
34264>>>>>>>        Set Field_Label_Long       Field Year.Year_C_Coder        To "Œæ£ ©£˜ REPORTING"
34265>>>>>>>        Set Field_Label_Short      Field Year.Year_C_Coder        To "Œæ£ ©£˜ REP"
34266>>>>>>>        //Set Field_Options          Field Year.Year_C_Coder        To DD_REQUIRED
34266>>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Coder        To (Year_Year_C_Coder_VT(Self))
34266>>>>>>>
34266>>>>>>>        // Year.Year_Isolfrom
34266>>>>>>>        Set Field_Label_Long       Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
34267>>>>>>>        Set Field_Label_Short      Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
34268>>>>>>>
34268>>>>>>>        // Year.Year_Isolto
34268>>>>>>>        Set Field_Label_Long       Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
34269>>>>>>>        Set Field_Label_Short      Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
34270>>>>>>>
34270>>>>>>>        // Year.Year_Openfrom
34270>>>>>>>        Set Field_Label_Long       Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
34271>>>>>>>        Set Field_Label_Short      Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
34272>>>>>>>
34272>>>>>>>        // Year.Year_Opento
34272>>>>>>>        Set Field_Label_Long       Field Year.Year_Opento         To "„šš¨˜­âª „àª"
34273>>>>>>>        Set Field_Label_Short      Field Year.Year_Opento         To "„šš¨˜­âª „àª"
34274>>>>>>>
34274>>>>>>>        // Year.Year_Entrydate
34274>>>>>>>        Set Field_Label_Long       Field Year.Year_Entrydate      To "†£œ¨¦£ž¤å˜ „¨š˜©å˜ª"
34275>>>>>>>        Set Field_Label_Short      Field Year.Year_Entrydate      To "†£/¤å˜ „¨š˜©å˜ª"
34276>>>>>>>
34276>>>>>>>        // Year.Year_Dateaa
34276>>>>>>>
34276>>>>>>>        // Year.Year_Xrhshfrom
34276>>>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
34277>>>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
34278>>>>>>>
34278>>>>>>>        // Year.Year_Xrhshto
34278>>>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
34279>>>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
34280>>>>>>>
34280>>>>>>>        // Year.Year_Myflimit
34280>>>>>>>        Set Field_Label_Long       Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
34281>>>>>>>        Set Field_Label_Short      Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
34282>>>>>>>
34282>>>>>>>        // Year.Year_Numgtypkin
34282>>>>>>>        Set Field_Options          Field Year.Year_Numgtypkin     To DD_DISPLAYONLY
34283>>>>>>>
34283>>>>>>>        // Year.Year_Numgarticl
34283>>>>>>>        Set Field_Options          Field Year.Year_Numgarticl     To DD_DISPLAYONLY
34284>>>>>>>
34284>>>>>>>        // Year.Year_Numgmove
34284>>>>>>>        Set Field_Options          Field Year.Year_Numgmove       To DD_DISPLAYONLY
34285>>>>>>>
34285>>>>>>>        // Year.Year_Numgplan
34285>>>>>>>        Set Field_Options          Field Year.Year_Numgplan       To DD_DISPLAYONLY
34286>>>>>>>
34286>>>>>>>        // Year.Year_Numgformat
34286>>>>>>>        Set Field_Options          Field Year.Year_Numgformat     To DD_DISPLAYONLY
34287>>>>>>>
34287>>>>>>>        // Year.Year_Numgthaa
34287>>>>>>>        Set Field_Options          Field Year.Year_Numgthaa       To DD_DISPLAYONLY
34288>>>>>>>
34288>>>>>>>        // Year.Year_Numgopen
34288>>>>>>>        Set Field_Options          Field Year.Year_Numgopen       To DD_DISPLAYONLY
34289>>>>>>>
34289>>>>>>>        // Year.Year_Numbaxio
34289>>>>>>>        Set Field_Options          Field Year.Year_Numbaxio       To DD_DISPLAYONLY
34290>>>>>>>
34290>>>>>>>        // Year.Year_Numbarticl
34290>>>>>>>        Set Field_Options          Field Year.Year_Numbarticl     To DD_DISPLAYONLY
34291>>>>>>>
34291>>>>>>>        // Year.Year_Numbmove
34291>>>>>>>        Set Field_Options          Field Year.Year_Numbmove       To DD_DISPLAYONLY
34292>>>>>>>
34292>>>>>>>        // Year.Year_Delimiter
34292>>>>>>>        Set Status_Help            Field Year.Year_Delimiter      To "ƒ ˜®à¨ ©« ¡æ š ˜ «¦ Š‘ «žª •¨ã©œàª"
34293>>>>>>>
34293>>>>>>>        // Year.Year_Printer
34293>>>>>>>
34293>>>>>>>        // Year.Year_Valid_Char
34293>>>>>>>
34293>>>>>>>    End_Procedure    // Define_Fields
34294>>>>>>>
34294>>>>>>>    // Field_Defaults:
34294>>>>>>>    // This procedure is used to establish default field values.
34294>>>>>>>
34294>>>>>>>    Procedure Field_Defaults
34295>>>>>>>        Forward Send Field_Defaults
34297>>>>>>>        //DDB-Generated-Code-Location
34297>>>>>>>        //DDB-FieldDefaultStart
34297>>>>>>>        //DDB-FieldDefaultEnd
34297>>>>>>>        Set Field_Changed_Value   Field Year.Year_Delimiter      To "."
34298>>>>>>>        Set Field_Changed_Value   Field Year.Year_Printer        To "LPT1:"
34299>>>>>>>        Set Field_Changed_Value   Field Year.Year_Valid_Char     To "1234567890"
34300>>>>>>>    End_Procedure    // Field_Defaults
34301>>>>>>>
34301>>>>>>>End_Class    // Year_DataDictionary
34302>>>>>>>//DDB-Selection-pkg-Start
34302>>>>>>>
34302>>>>>>>Use Sl003.sl         // SL003
INCLUDING FILE: SL003.SL
34302>>>>>>>>>//AB/ Project SL003:Year
34302>>>>>>>>>//AB/ Object prj is a Lookup_Project
34302>>>>>>>>>//AB/     Set ProjectName to "SL003:Year"
34302>>>>>>>>>//AB/     Set ProjectFileName to "Sl003.sl"
34302>>>>>>>>>
34302>>>>>>>>>// Project Object Structure
34302>>>>>>>>>//   SL003 is a dbModalPanelSub
34302>>>>>>>>>//     Company_DD is a DataDictionary
34302>>>>>>>>>//     Branch_DD is a DataDictionary
34302>>>>>>>>>//     Year_DD is a DataDictionary
34302>>>>>>>>>//     oSelList is a dbListSub
34302>>>>>>>>>//     oOK_bn is a ButtonSub
34302>>>>>>>>>//     oCancel_bn is a ButtonSub
34302>>>>>>>>>//     oSearch_bn is a ButtonSub
34302>>>>>>>>>
34302>>>>>>>>>// Register all objects
34302>>>>>>>>>Register_Object Branch_DD
34302>>>>>>>>>Register_Object Company_DD
34302>>>>>>>>>Register_Object oCancel_bn
34302>>>>>>>>>Register_Object oOK_bn
34302>>>>>>>>>Register_Object oSearch_bn
34302>>>>>>>>>Register_Object oSelList
34302>>>>>>>>>Register_Object SL003
34302>>>>>>>>>Register_Object Year_DD
34302>>>>>>>>>
34302>>>>>>>>>
34302>>>>>>>>>//AB-IgnoreStart
34302>>>>>>>>>
34302>>>>>>>>>Use DFAllEnt.pkg
34302>>>>>>>>>Use dbList.Sub
34302>>>>>>>>>Use Button.Sub
34302>>>>>>>>>
34302>>>>>>>>>
34302>>>>>>>>>Use COMPANY.DD
34302>>>>>>>>>Use BRANCH.DD
34302>>>>>>>>>Use YEAR.DD
34302>>>>>>>>>
34302>>>>>>>>>//AB-IgnoreEnd
34302>>>>>>>>>
34302>>>>>>>>>CD_Popup_Object SL003 is a dbModalPanelSub
34321>>>>>>>>>
34321>>>>>>>>>    //AB-StoreTopStart
34321>>>>>>>>>    Property String psFragmaCompanyCode  ""
34323>>>>>>>>>    Property String psFragmaBranchCode   ""
34325>>>>>>>>>    property integer pifragmaactive public 0
34327>>>>>>>>>    //AB-StoreTopEnd
34327>>>>>>>>>
34327>>>>>>>>>    Set Minimize_Icon to FALSE
34328>>>>>>>>>    Set Label to "•¨ã©œ ª"
34329>>>>>>>>>    Set Size to 149 449
34330>>>>>>>>>    Set Location to 4 7
34331>>>>>>>>>    Set Exit_Application_Local_State to FALSE
34332>>>>>>>>>    Set Modal_State to FALSE
34333>>>>>>>>>
34333>>>>>>>>>    //AB-DDOStart
34333>>>>>>>>>
34333>>>>>>>>>    Object Company_DD is a Company_DataDictionary
34335>>>>>>>>>    End_Object    // Company_DD
34336>>>>>>>>>
34336>>>>>>>>>    Object Branch_DD is a Branch_DataDictionary
34338>>>>>>>>>        Set DDO_Server to (Company_DD(self))
34339>>>>>>>>>    End_Object    // Branch_DD
34340>>>>>>>>>
34340>>>>>>>>>    Object Year_DD is a Year_DataDictionary
34342>>>>>>>>>        Set DDO_Server to (Branch_DD(self))
34343>>>>>>>>>
34343>>>>>>>>>        //AB-StoreStart
34343>>>>>>>>>        Procedure OnConstrain
34345>>>>>>>>>             String lsCompanyCode lsBranchCode
34346>>>>>>>>>             integer iactive
34346>>>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
34347>>>>>>>>>             get pifragmaactive to iactive
34348>>>>>>>>>             If (lsCompanyCode <> "") Begin
34350>>>>>>>>>                Get psFragmaBranchCode  to lsBranchCode
34351>>>>>>>>>                Constrain Year.Company_Code eq lsCompanyCode
34353>>>>>>>>>                If (lsBranchCode <> "") Constrain Year.Branch_code eq lsBranchCode
34357>>>>>>>>>             End
34357>>>>>>>>>>
34357>>>>>>>>>             if (iactive = 0) constrain year.working ne 1
34361>>>>>>>>>        End_Procedure // OnConstrain
34362>>>>>>>>>        
34362>>>>>>>>>        
34362>>>>>>>>>        
34362>>>>>>>>>        
34362>>>>>>>>>        
34362>>>>>>>>>        //AB-StoreEnd
34362>>>>>>>>>
34362>>>>>>>>>    End_Object    // Year_DD
34363>>>>>>>>>
34363>>>>>>>>>    Set Main_DD to (Year_DD(self))
34364>>>>>>>>>    Set Server to (Year_DD(self))
34365>>>>>>>>>
34365>>>>>>>>>    //AB-DDOEnd
34365>>>>>>>>>
34365>>>>>>>>>    Object oSelList is a dbListSub
34367>>>>>>>>>        Set Main_File to Year.File_Number
34368>>>>>>>>>        Set Size to 105 433
34369>>>>>>>>>        Set Location to 6 6
34370>>>>>>>>>
34370>>>>>>>>>        Begin_Row
34373>>>>>>>>>            Entry_Item Year.Year_year
34374>>>>>>>>>            Entry_Item Company.Company_code
34375>>>>>>>>>            Entry_Item Company.Company_name
34376>>>>>>>>>            Entry_Item Branch.Branch_code
34377>>>>>>>>>            Entry_Item Branch.Branch_name
34378>>>>>>>>>        End_Row
34383>>>>>>>>>
34383>>>>>>>>>        Set Form_Width    item 0 to 36
34384>>>>>>>>>        Set Header_Label  item 0 to "•¨ã©ž :          "
34385>>>>>>>>>        
34385>>>>>>>>>        Set Form_Width    item 1 to 71
34386>>>>>>>>>        Set Header_Label  item 1 to "‰à› ¡æª „«˜ ¨å˜ª"
34387>>>>>>>>>        
34387>>>>>>>>>        Set Form_Width    item 2 to 136
34388>>>>>>>>>        Set Header_Label  item 2 to "Ž¤¦£˜ „«˜ ¨å˜ª"
34389>>>>>>>>>        
34389>>>>>>>>>        Set Form_Width    item 3 to 73
34390>>>>>>>>>        Set Header_Label  item 3 to "‰à› ¡æª “§¦¡/«¦ª"
34391>>>>>>>>>        
34391>>>>>>>>>        Set Form_Width    item 4 to 109
34392>>>>>>>>>        Set Header_Label  item 4 to "Ž¤¦£˜ “§¦¡/«¦ª"
34393>>>>>>>>>        
34393>>>>>>>>>
34393>>>>>>>>>        //AB-StoreStart
34393>>>>>>>>>                                                
34393>>>>>>>>>        Property String psStoreFragmaCompanyCode  ""
34395>>>>>>>>>        Property String psStoreFragmaBranchCode   ""
34397>>>>>>>>>        
34397>>>>>>>>>        Procedure Store_Defaults
34399>>>>>>>>>            forward send Store_Defaults
34401>>>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
34402>>>>>>>>>            Set psStoreFragmaBranchCode  to (psFragmaBranchCode(Self))
34403>>>>>>>>>        end_Procedure // Store_Defaults
34404>>>>>>>>>        
34404>>>>>>>>>        Procedure Restore_Defaults
34406>>>>>>>>>            forward send Restore_Defaults
34408>>>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
34409>>>>>>>>>            Set psFragmaBranchCode  to (psStoreFragmaBranchCode(self))
34410>>>>>>>>>        end_Procedure // Restore_Defaults
34411>>>>>>>>>        
34411>>>>>>>>>        Procedure Activating
34413>>>>>>>>>            Forward Send Activating
34415>>>>>>>>>            Send Rebuild_Constraints to (Year_DD(self))
34416>>>>>>>>>        End_Procedure // Activating
34417>>>>>>>>>        
34417>>>>>>>>>        
34417>>>>>>>>>        
34417>>>>>>>>>        //AB-StoreEnd
34417>>>>>>>>>
34417>>>>>>>>>    End_Object    // oSelList
34418>>>>>>>>>
34418>>>>>>>>>    Object oOK_bn is a ButtonSub
34420>>>>>>>>>        Set Label to "&„§ ¢¦šã"
34421>>>>>>>>>        Set Location to 112 280
34422>>>>>>>>>
34422>>>>>>>>>        //AB-StoreStart
34422>>>>>>>>>        Procedure OnClick
34424>>>>>>>>>            Send OK To (oSelList(current_object))
34425>>>>>>>>>        End_Procedure
34426>>>>>>>>>        //AB-StoreEnd
34426>>>>>>>>>
34426>>>>>>>>>    End_Object    // oOK_bn
34427>>>>>>>>>
34427>>>>>>>>>    Object oCancel_bn is a ButtonSub
34429>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
34430>>>>>>>>>        Set Location to 112 335
34431>>>>>>>>>
34431>>>>>>>>>        //AB-StoreStart
34431>>>>>>>>>        Procedure OnClick
34433>>>>>>>>>            Send Cancel To (oSelList(current_object))
34434>>>>>>>>>        End_Procedure
34435>>>>>>>>>        //AB-StoreEnd
34435>>>>>>>>>
34435>>>>>>>>>    End_Object    // oCancel_bn
34436>>>>>>>>>
34436>>>>>>>>>    Object oSearch_bn is a ButtonSub
34438>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
34439>>>>>>>>>        Set Location to 112 390
34440>>>>>>>>>
34440>>>>>>>>>        //AB-StoreStart
34440>>>>>>>>>        Procedure OnClick
34442>>>>>>>>>            Send Search To (oSelList(current_object))
34443>>>>>>>>>        End_Procedure
34444>>>>>>>>>        //AB-StoreEnd
34444>>>>>>>>>
34444>>>>>>>>>    End_Object    // oSearch_bn
34445>>>>>>>>>
34445>>>>>>>>>
34445>>>>>>>>>    //AB-StoreStart
34445>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
34446>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
34447>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
34448>>>>>>>>>    
34448>>>>>>>>>    
34448>>>>>>>>>    
34448>>>>>>>>>    //AB-StoreEnd
34448>>>>>>>>>
34448>>>>>>>>>CD_End_Object    // SL003
34450>>>>>>>>>>
34450>>>>>>>>>
34450>>>>>>>>>//AB/ End_Object    // prj
34450>>>>>>>
34450>>>>>>>//DDB-Selection-pkg-End
34450>>>>>>>//DDB-FileEnd
34450>>>>>
34450>>>>>//AB-IgnoreEnd
34450>>>>>
34450>>>>>Object oSelectYear is a dbModalPanelSub
34452>>>>>
34452>>>>>    //AB-StoreTopStart
34452>>>>>    
34452>>>>>    Property String  psSelectedYearRecr  ''
34454>>>>>    Property Integer piChangeState False
34456>>>>>    
34456>>>>>    //AB-StoreTopEnd
34456>>>>>
34456>>>>>    Set Minimize_Icon to FALSE
34457>>>>>    Set Label to "„§ ¢¦šã „«˜ ¨œå˜ª - “§¦¡˜«˜©«ã£˜«¦ª - •¨ã©žª"
34458>>>>>    Set Size to 111 372
34459>>>>>    Set Location to 60 40
34460>>>>>    Set Color to 12232306
34461>>>>>
34461>>>>>    //AB-DDOStart
34461>>>>>
34461>>>>>    Object Company_DD is a Company_DataDictionary
34463>>>>>
34463>>>>>        //AB-StoreStart
34463>>>>>        Set Foreign_Field_Options DD_KEYFIELD                   to DD_Clear_Field_Options DD_FindReq
34464>>>>>        Set Foreign_Field_Options DD_INDEXFIELD                 to DD_Clear_Field_Options DD_FindReq
34465>>>>>        Set Foreign_Field_Options Field Company.Company_Name    to DD_DisplayOnly
34466>>>>>        
34466>>>>>        
34466>>>>>        
34466>>>>>        //AB-StoreEnd
34466>>>>>
34466>>>>>    End_Object    // Company_DD
34467>>>>>
34467>>>>>    Object Branch_DD is a Branch_DataDictionary
34469>>>>>        Set DDO_Server to (Company_DD(self))
34470>>>>>
34470>>>>>        //AB-StoreStart
34470>>>>>        Set Foreign_Field_Options DD_KEYFIELD   to DD_Clear_Field_Options DD_FindReq
34471>>>>>        Set Foreign_Field_Options DD_INDEXFIELD to DD_Clear_Field_Options DD_FindReq
34472>>>>>        
34472>>>>>        Set Foreign_Field_Options DD_KEYFIELD   to DD_AutoFind_GE
34473>>>>>        Set Foreign_Field_Options DD_INDEXFIELD to DD_AutoFind_GE
34474>>>>>        
34474>>>>>        Set Foreign_Field_Options Field Branch.Branch_Name to DD_DisplayOnly
34475>>>>>        //AB-StoreEnd
34475>>>>>
34475>>>>>    End_Object    // Branch_DD
34476>>>>>
34476>>>>>    Object Year_DD is a Year_DataDictionary
34478>>>>>        Set DDO_Server to (Branch_DD(self))
34479>>>>>
34479>>>>>        //AB-StoreStart
34479>>>>>        
34479>>>>>        Set Field_Options Field Year.Year_Descr to DD_DisplayOnly
34480>>>>>        Set Field_Options Field Year.Year_Year to DD_AutoFind_GE
34481>>>>>        
34481>>>>>        Function Validate_Delete Returns Integer
34483>>>>>            Function_Return 1
34484>>>>>        End_Function
34485>>>>>        
34485>>>>>        //AB-StoreEnd
34485>>>>>
34485>>>>>    End_Object    // Year_DD
34486>>>>>
34486>>>>>    Set Main_DD to (Year_DD(self))
34487>>>>>    Set Server to (Year_DD(self))
34488>>>>>
34488>>>>>    //AB-DDOEnd
34488>>>>>
34488>>>>>    Object Company_Company_Code is a dbFormSub
34490>>>>>        Entry_Item Company.Company_code
34491>>>>>        Set Size to 13 71
34492>>>>>        Set Location to 9 112
34493>>>>>        Set Color to 12232306
34494>>>>>        Set Label_Col_Offset to 2
34495>>>>>        Set Label_Justification_Mode to jMode_Right
34496>>>>>        Set Prompt_Button_Mode to pb_PromptOn
34497>>>>>        Set Auto_Clear_Deo_State to FALSE
34498>>>>>        Set Enabled_State to FALSE
34499>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34500>>>>>        Set Item_Shadow_State Item 0 to TRUE
34501>>>>>        Set Shadow_State Item 0 to TRUE
34502>>>>>
34502>>>>>        //AB-StoreStart
34502>>>>>        
34502>>>>>        Set Prompt_Object to (sl001(Self))
34503>>>>>        
34503>>>>>        
34503>>>>>        //AB-StoreEnd
34503>>>>>
34503>>>>>    End_Object    // Company_Company_Code
34504>>>>>
34504>>>>>    Object Company_Company_Name is a dbFormSub
34506>>>>>        Entry_Item Company.Company_name
34507>>>>>        Set Size to 13 168
34508>>>>>        Set Location to 9 188
34509>>>>>        Set Color to 12232306
34510>>>>>        Set Label_Col_Offset to 2
34511>>>>>        Set Label_Justification_Mode to jMode_Right
34512>>>>>        Set Enabled_State to FALSE
34513>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34514>>>>>        Set Item_Shadow_State Item 0 to TRUE
34515>>>>>        Set Shadow_State Item 0 to TRUE
34516>>>>>
34516>>>>>        //AB-StoreStart
34516>>>>>        
34516>>>>>        //AB-StoreEnd
34516>>>>>
34516>>>>>    End_Object    // Company_Company_Name
34517>>>>>
34517>>>>>    Object Branch_Branch_Code is a dbFormSub
34519>>>>>        Entry_Item Branch.Branch_code
34520>>>>>        Set Size to 13 71
34521>>>>>        Set Location to 23 112
34522>>>>>        Set Color to 12232306
34523>>>>>        Set Label_Col_Offset to 2
34524>>>>>        Set Label_Justification_Mode to jMode_Right
34525>>>>>        Set Prompt_Button_Mode to pb_PromptOn
34526>>>>>        Set Auto_Clear_Deo_State to FALSE
34527>>>>>        Set Enabled_State to FALSE
34528>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34529>>>>>        Set Item_Shadow_State Item 0 to TRUE
34530>>>>>        Set Shadow_State Item 0 to TRUE
34531>>>>>
34531>>>>>        //AB-StoreStart
34531>>>>>        Set Prompt_Object to (sl002(Self))
34532>>>>>        
34532>>>>>        Procedure Prompt_CallBack Integer hPrompt
34534>>>>>            string lsCompanyCode
34535>>>>>            Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
34536>>>>>            Set psFragmaCompanyCode of hPrompt to lsCompanyCode
34537>>>>>        End_Procedure
34538>>>>>        
34538>>>>>        
34538>>>>>        
34538>>>>>        
34538>>>>>        //AB-StoreEnd
34538>>>>>
34538>>>>>    End_Object    // Branch_Branch_Code
34539>>>>>
34539>>>>>    Object Branch_Branch_Name is a dbFormSub
34541>>>>>        Entry_Item Branch.Branch_name
34542>>>>>        Set Size to 13 168
34543>>>>>        Set Location to 23 188
34544>>>>>        Set Color to 12232306
34545>>>>>        Set Label_Justification_Mode to jMode_Right
34546>>>>>        Set Enabled_State to FALSE
34547>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34548>>>>>        Set Item_Shadow_State Item 0 to TRUE
34549>>>>>        Set Shadow_State Item 0 to TRUE
34550>>>>>
34550>>>>>        //AB-StoreStart
34550>>>>>        
34550>>>>>        
34550>>>>>        //AB-StoreEnd
34550>>>>>
34550>>>>>    End_Object    // Branch_Branch_Name
34551>>>>>
34551>>>>>    Object Year_Year_Year is a dbFormSub
34553>>>>>        Entry_Item Year.Year_year
34554>>>>>        Set Size to 13 71
34555>>>>>        Set Location to 37 112
34556>>>>>        Set Label_Col_Offset to 2
34557>>>>>        Set Label_Justification_Mode to jMode_Right
34558>>>>>        Set Prompt_Button_Mode to pb_PromptOn
34559>>>>>        Set Auto_Clear_Deo_State to FALSE
34560>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34561>>>>>
34561>>>>>        //AB-StoreStart
34561>>>>>        Set Prompt_Object to (sl003(Self))
34562>>>>>        
34562>>>>>        Procedure Prompt_CallBack Integer hPrompt
34564>>>>>            String lsCompanyCode lsBranchCode
34565>>>>>            integer icheck
34565>>>>>            get checked_state of (chkxr(self)) to icheck
34566>>>>>            Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
34567>>>>>            Get Field_Current_Value of Branch_DD  Field Branch.Branch_Code   to lsBranchCode
34568>>>>>            Set psFragmaCompanyCode of hPrompt to lsCompanyCode
34569>>>>>            Set psFragmaBranchCode  of hPrompt to lsBranchCode
34570>>>>>            set pifragmaactive      of hPrompt to icheck
34571>>>>>        End_Procedure
34572>>>>>        
34572>>>>>        
34572>>>>>        
34572>>>>>        
34572>>>>>        
34572>>>>>        
34572>>>>>        //AB-StoreEnd
34572>>>>>
34572>>>>>    End_Object    // Year_Year_Year
34573>>>>>
34573>>>>>    Object Year_Year_Descr is a dbFormSub
34575>>>>>        Entry_Item Year.Year_descr
34576>>>>>        Set Size to 13 168
34577>>>>>        Set Location to 37 188
34578>>>>>        Set Color to 12232306
34579>>>>>        Set Label_Col_Offset to 2
34580>>>>>        Set Label_Justification_Mode to jMode_Right
34581>>>>>        Set Enabled_State to FALSE
34582>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34583>>>>>        Set Item_Shadow_State Item 0 to TRUE
34584>>>>>        Set Shadow_State Item 0 to TRUE
34585>>>>>
34585>>>>>        //AB-StoreStart
34585>>>>>        
34585>>>>>        //AB-StoreEnd
34585>>>>>
34585>>>>>    End_Object    // Year_Year_Descr
34586>>>>>
34586>>>>>    Object Year_Year_Entrydate is a dbFormSub
34588>>>>>        Entry_Item Year.Year_entrydate
34589>>>>>        Set Size to 13 71
34590>>>>>        Set Location to 52 112
34591>>>>>        Set Label_Col_Offset to 2
34592>>>>>        Set Label_Justification_Mode to jMode_Right
34593>>>>>        Set Auto_Clear_Deo_State to FALSE
34594>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34595>>>>>    End_Object    // Year_Year_Entrydate
34596>>>>>
34596>>>>>    Object oOk_bn is a ButtonSub
34598>>>>>        Set Label to "€§¦›¦®ã (F2)"
34599>>>>>        Set Size to 17 54
34600>>>>>        Set Location to 74 188
34601>>>>>        Set Form_FontHeight Item 0 to 14
34602>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34603>>>>>
34603>>>>>        //AB-StoreStart
34603>>>>>        
34603>>>>>        Procedure OnClick
34605>>>>>            Delegate Send AcceptTheValues
34607>>>>>        End_Procedure
34608>>>>>        
34608>>>>>        
34608>>>>>        
34608>>>>>        
34608>>>>>        //AB-StoreEnd
34608>>>>>
34608>>>>>    End_Object    // oOk_bn
34609>>>>>
34609>>>>>    Object oCancel_bn is a ButtonSub
34611>>>>>        Set Label to "„¥¦›¦ª "
34612>>>>>        Set Size to 17 54
34613>>>>>        Set Location to 74 302
34614>>>>>        Set Form_FontHeight Item 0 to 14
34615>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34616>>>>>
34616>>>>>        //AB-StoreStart
34616>>>>>        
34616>>>>>        Procedure OnClick
34618>>>>>           Send Exit_Application to oSelectYear
34619>>>>>        End_Procedure
34620>>>>>        
34620>>>>>        
34620>>>>>        
34620>>>>>        //AB-StoreEnd
34620>>>>>
34620>>>>>    End_Object    // oCancel_bn
34621>>>>>
34621>>>>>    Object otxtCompany is a TextBoxSub
34623>>>>>        Set Label to "„«˜ ¨œå˜"
34624>>>>>        Set Auto_Size_State to FALSE
34625>>>>>        Set Color to 12232306
34626>>>>>        Set FontSize to 14 8
34627>>>>>        Set Location to 9 10
34628>>>>>        Set Size to 10 35
34629>>>>>        Set FontWeight to 600
34630>>>>>        Set TypeFace to "MS Sans Serif"
34631>>>>>        Set Enabled_State to TRUE
34632>>>>>    End_Object    // otxtCompany
34633>>>>>
34633>>>>>    Object otxtBranch is a TextBoxSub
34635>>>>>        Set Label to "“§¦¡˜«˜©«ã£˜«˜"
34636>>>>>        Set Auto_Size_State to FALSE
34637>>>>>        Set Color to 12232306
34638>>>>>        Set FontSize to 14 8
34639>>>>>        Set Location to 23 10
34640>>>>>        Set Size to 10 63
34641>>>>>        Set FontWeight to 600
34642>>>>>        Set TypeFace to "MS Sans Serif"
34643>>>>>        Set Enabled_State to TRUE
34644>>>>>    End_Object    // otxtBranch
34645>>>>>
34645>>>>>    Object otxtYear is a TextBoxSub
34647>>>>>        Set Label to "•¨ã©ž :          "
34648>>>>>        Set Auto_Size_State to FALSE
34649>>>>>        Set Color to 12232306
34650>>>>>        Set FontSize to 14 8
34651>>>>>        Set Location to 38 10
34652>>>>>        Set Size to 10 40
34653>>>>>        Set FontWeight to 600
34654>>>>>        Set TypeFace to "MS Sans Serif"
34655>>>>>        Set Enabled_State to TRUE
34656>>>>>    End_Object    // otxtYear
34657>>>>>
34657>>>>>    Object otxtWorkingDay is a TextBoxSub
34659>>>>>        Set Label to "†£/¤å˜ „¨š˜©å˜ª"
34660>>>>>        Set Auto_Size_State to FALSE
34661>>>>>        Set Color to 12232306
34662>>>>>        Set FontSize to 14 8
34663>>>>>        Set Location to 52 10
34664>>>>>        Set Size to 10 63
34665>>>>>        Set FontWeight to 600
34666>>>>>        Set TypeFace to "MS Sans Serif"
34667>>>>>        Set Enabled_State to TRUE
34668>>>>>    End_Object    // otxtWorkingDay
34669>>>>>
34669>>>>>    Object otxtWorkingDay is a TextBoxSub
34671>>>>>        Set Label to "Ž¢œª ¦  ®¨ã©œ ª"
34672>>>>>        Set Auto_Size_State to FALSE
34673>>>>>        Set Color to 12232306
34674>>>>>        Set FontSize to 14 8
34675>>>>>        Set Location to 79 9
34676>>>>>        Set Size to 10 63
34677>>>>>        Set FontWeight to 600
34678>>>>>        Set TypeFace to "MS Sans Serif"
34679>>>>>        Set Enabled_State to TRUE
34680>>>>>    End_Object    // otxtWorkingDay
34681>>>>>
34681>>>>>    Object chkxr is a CheckBoxSub
34683>>>>>        Set Size to 13 22
34684>>>>>        Set Location to 79 113
34685>>>>>        Set Color to 12232306
34686>>>>>    End_Object    // chkxr
34687>>>>>
34687>>>>>
34687>>>>>    //AB-StoreStart
34687>>>>>    
34687>>>>>    On_Key Key_Ctrl+Key_X Send None
34688>>>>>    On_Key Key_Alt+Key_X  Send None
34689>>>>>    
34689>>>>>    Function ifSelect_Xrhsh Returns String
34691>>>>>        String  lsRecord_id
34692>>>>>        Set psSelectedYearRecr to gs_Selected_Year_Recr
34693>>>>>        send popup_modal
34694>>>>>        Get psSelectedYearRecr to lsRecord_id
34695>>>>>        Function_return lsRecord_Id
34696>>>>>    End_Function
34697>>>>>    
34697>>>>>    Procedure AcceptTheValues
34699>>>>>        Integer iRetVal liYearDD liCompanyDD liBranchDD
34700>>>>>        String ldcheck lsYearRecr lsSite sCname sBname sYname sNom1 sNom2 sNom3
34700>>>>>        Date ldYearXrhsh_From ldYearXrhsh_To
34700>>>>>        Move Year_DD to liYearDD
34701>>>>>        Get Field_Current_Value of liYearDD Field Year.Year_EntryDate to ldcheck
34702>>>>>        if (ldcheck = "") ;            Get Message_Box "ƒœ¤ œ§ ¢â¥˜«œ ©à©«ã ž£œ¨¦£ž¤å˜." "¨¦©¦®ã" MB_OK MB_ICONWARNING to iRetVal
34705>>>>>        else begin
34706>>>>>            Get Field_Current_Value of liYearDD Field Year.Year_XrhshFrom   to ldYearXrhsh_From
34707>>>>>            Get Field_Current_Value of liYearDD Field Year.Year_XrhshTo     to ldYearXrhsh_To
34708>>>>>            if ((ldcheck < ldYearXrhsh_From) or (ldcheck > ldYearXrhsh_To)) ;                Get Message_Box "†£œ¨/¤å˜ œ¡«éª ¦¨åà¤" "¨¦©¦®ã" MB_OK MB_ICONWARNING to iRetVal
34711>>>>>            else begin
34712>>>>>                Move Company_DD to liCompanyDD
34713>>>>>                Move Branch_DD  to liBranchDD
34714>>>>>                Move Year_DD    to liYearDD
34715>>>>>                send Request_Save to liYearDD
34716>>>>>                Get Field_Current_Value of liCompanyDD Field Company.Company_Code to gs_Selected_Company_Code
34717>>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Branch_Code   to gs_Selected_Branch_Code
34718>>>>>    
34718>>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Beto_Site   to gs_Selected_Beto_Site
34719>>>>>    
34719>>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Branch_Site   to lsSite
34720>>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_Year       to gi_Selected_Year
34721>>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_Recr       to lsYearRecr
34722>>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_C_Code0    to sNom1
34723>>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_C_Code00   to sNom2
34724>>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_C_CodeR    to sNom3
34725>>>>>    
34725>>>>>                Get Field_Current_Value of liCompanyDD Field Company.Company_Name to sCname
34726>>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Branch_name   to sBname
34727>>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_Descr      to sYname
34728>>>>>    
34728>>>>>    
34728>>>>>                Local String    sCode
34728>>>>>                Local Integer   iBreak
34728>>>>>                Move 0 to iBreak
34729>>>>>                Clear Nomisma
34730>>>>>                Find Gt Nomisma.Recnum
34731>>>>>>
34731>>>>>                While ((Found=1) And (iBreak=0))
34735>>>>>                    If (Nomisma.Einai_Euro='1') Begin
34737>>>>>                        Move 1 to iBreak
34738>>>>>                        Move Nomisma.Nomisma_Code to sCode
34739>>>>>                    End
34739>>>>>>
34739>>>>>                    If (Not(iBreak)) Find Gt Nomisma.Recnum
34742>>>>>                Loop
34743>>>>>>
34743>>>>>                Move (Trim(sCode)) to sCode
34744>>>>>    
34744>>>>>    
34744>>>>>                Reread SysCurXR
34748>>>>>                Move gs_Selected_Company_Code   to SysCurXR.Company_Code
34749>>>>>                Move gs_Selected_beto_site      to SysCurXR.beto_site
34750>>>>>                Move gs_Selected_Branch_Code    to SysCurXR.Branch_Code
34751>>>>>                Move gi_Selected_Year           to SysCurXR.Year_Year
34752>>>>>                Move lsYearRecr                 to SysCurXR.Year_Recr
34753>>>>>                Move lsSite                     to SysCurXR.Branch_Site
34754>>>>>    
34754>>>>>                Move sCname                     to SysCurXR.Company_Name
34755>>>>>                Move sBname                     to SysCurXR.Branch_Name
34756>>>>>                Move sYname                     to SysCurXR.Year_Descr
34757>>>>>    
34757>>>>>                Move ldYearXrhsh_From           to SysCurXr.Year_XrhshFrom
34758>>>>>                Move ldYearXrhsh_To             to SysCurXr.Year_XrhshTo
34759>>>>>    
34759>>>>>                Move  (Trim(sNom1))             to SysCurXR.C_Code0
34760>>>>>                Move  (Trim(sNom2))             to SysCurXR.C_Code00
34761>>>>>                Move  (Trim(sNom3))             to SysCurXR.C_CodeR
34762>>>>>    
34762>>>>>                Move sCode                      to SysCurXR.Euro_Code
34763>>>>>    
34763>>>>>                Saverecord SysCurXR
34764>>>>>                Unlock
34765>>>>>>
34765>>>>>    
34765>>>>>                Move lsYearRecr                 to gs_Selected_Year_Recr
34766>>>>>                Set psSelectedYearRecr          to lsYearRecr
34767>>>>>    
34767>>>>>                Send Stop_Modal_ui
34768>>>>>    
34768>>>>>                Set kEnter_Next_State of ghoWorkSpace to TRUE
34769>>>>>            End
34769>>>>>>
34769>>>>>        end
34769>>>>>>
34769>>>>>    End_Procedure
34770>>>>>    
34770>>>>>    Set Locate_Mode to Center_On_Screen
34771>>>>>    
34771>>>>>    On_Key KCancel      Send KeyAction to (oCancel_Bn(Self))
34772>>>>>    On_Key KClose_Panel Send KeyAction to (oCancel_Bn(Self))
34773>>>>>    On_Key Ksave_record send KeyAction to (oOK_Bn(Self))
34774>>>>>    
34774>>>>>    On_Key Key_alt+Key_A send KeyAction to (oOK_Bn(Self))
34775>>>>>    On_Key Key_alt+Key_Q send KeyAction to (oCancel_Bn(Self))
34776>>>>>    
34776>>>>>    
34776>>>>>    
34776>>>>>    
34776>>>>>    
34776>>>>>    
34776>>>>>    
34776>>>>>    //AB-StoreEnd
34776>>>>>
34776>>>>>End_Object    // oSelectYear
34777>>>>>
34777>>>>>
34777>>>>>//AB-StoreStart
34777>>>>>
34777>>>>>
34777>>>>>//AB-StoreEnd
34777>>>>>
34777>>>>>//AB/ End_Object    // prj
34777>>>
34777>>>Procedure Epelexe_Xrhsh
34778>>>    Integer liCompanyDD liBranchDD liYearDD liYear liModalId
34779>>>    String lsCompany lsBranch lsWhatXrhsh
34779>>>    Move oSelectYear to liModalId
34780>>>    Get ifSelect_Xrhsh Of liModalId to lsWhatXrhsh
34781>>>    if (Trim(lsWhatXrhsh)='') Send Exit_Application
34784>>>End_Procedure
34785>>>
34785>>>Procedure Allaxe_Xrhsh
34786>>>    Integer rVal liModalId iID
34787>>>    If (Close_All_Views(Self,True)=0) Begin
34789>>>        Move oSelectYear to liModalId
34790>>>        Send Epelexe_Xrhsh
34791>>>    End
34791>>>>
34791>>>End_Procedure
34792>>>
34792>>>On_Key Key_Ctrl+Key_X Send Allaxe_Xrhsh
34793>>>On_Key Key_Alt+Key_X  Send Allaxe_Xrhsh
34794>>>
34794>>>Send Epelexe_Xrhsh
34795>>>//------------------------------
34795>>>
34795>//Send Epelexe_Xrhsh
34795>
34795>Use Menu_Sec.Sub
INCLUDING FILE: MENU_SEC.SUB
34795>>>
34795>>>Use Idiotht.pkg
INCLUDING FILE: IDIOTHT.PKG
34795>>>>>
34795>>>>>Open Users
34797>>>>>Open UserGrps
INCLUDING FILE: USERGRPS.FD
34799>>>>>Open Pedia
INCLUDING FILE: PEDIA.FD
34801>>>>>Open Arxeia
INCLUDING FILE: ARXEIA.FD
34803>>>>>Open GrpPedia
INCLUDING FILE: GRPPEDIA.FD
34805>>>>>Open GrpPed0
INCLUDING FILE: GRPPED0.FD
34807>>>>>Open GrpArx
INCLUDING FILE: GRPARX.FD
34809>>>>>Open GrpArx0
INCLUDING FILE: GRPARX0.FD
34811>>>>>Open ViewFlds
INCLUDING FILE: VIEWFLDS.FD
34813>>>>>Open Oth
INCLUDING FILE: OTH.FD
34815>>>>>Open GrpOth
INCLUDING FILE: GRPOTH.FD
34817>>>>>Open GrpOth0
INCLUDING FILE: GRPOTH0.FD
34819>>>>>Open Departm
INCLUDING FILE: DEPARTM.FD
34821>>>>>
34821>>>>>
34821>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
34822>>>>>
34822>>>>>Function Network_User_Name Returns String
34823>>>>>    Local String sName sLength
34824>>>>>    Local Pointer lpName_Addr lpLength_Addr
34824>>>>>    Local Integer iRetval
34824>>>>>    Movestr (Repeat (Character (0), 255)) To sName
34825>>>>>>
34825>>>>>    GetAddress Of sName To lpName_Addr
34826>>>>>    Movestr (DwordToBytes (255)) To sLength
34827>>>>>>
34827>>>>>    GetAddress Of sLength To lpLength_Addr
34828>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
34829>>>>>>
34829>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
34832>>>>>    Else Function_Return "User Unknown"
34834>>>>>End_Function // Network_User_Name
34835>>>>>
34835>>>>>Function fsGetOfficePath Global Returns String
34836>>>>>    String sRegistryKeyPath sRegOfficePath
34837>>>>>    Set_Registry_Root                                                   to HKEY_LOCAL_MACHINE "Software"
34838>>>>>    Move "Microsoft\Office\9.0\Word"                                    to sRegistryKeyPath
34839>>>>>    Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path"    to sRegOfficePath
34843>>>>>    Move (Trim(sRegOfficePath))                                         to sRegOfficePath
34844>>>>>    If (sRegOfficePath='') Begin
34846>>>>>        Move "Microsoft\Office\8.0\Word"                                to sRegistryKeyPath
34847>>>>>        Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34851>>>>>        Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34852>>>>>        If (sRegOfficePath='') Begin
34854>>>>>            Move "Microsoft\Office\7.0\Word"                             to sRegistryKeyPath
34855>>>>>            Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34859>>>>>            Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34860>>>>>            If (sRegOfficePath='') Begin
34862>>>>>                Move "Microsoft\Office\10.0\Word"                                to sRegistryKeyPath
34863>>>>>                Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34867>>>>>                Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34868>>>>>            End
34868>>>>>>
34868>>>>>        End
34868>>>>>>
34868>>>>>    End
34868>>>>>>
34868>>>>>    Function_Return sRegOfficePath
34869>>>>>End_Procedure
34870>>>>>
34870>>>>>
34870>>>>>Function fsGetLastDir Global Returns String
34871>>>>>    String sRegistryKeyPath sRegDir sUserName
34872>>>>>    Get Network_User_Name to sUserName
34873>>>>>
34873>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
34876>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
34879>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
34881>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
34883>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
34884>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
34885>>>>>    Get_profile_string sRegistryKeyPath "Path" to sRegDir
34888>>>>>    Function_Return sRegDir
34889>>>>>End_Procedure
34890>>>>>
34890>>>>>Function fiPutLastDir Global String asDirectory Returns Integer
34891>>>>>    String sRegistryKeyPath sRegDir sUserName
34892>>>>>    Get Network_User_Name to sUserName
34893>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
34896>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
34899>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
34901>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
34903>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
34904>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
34905>>>>>    Set_profile_string sRegistryKeyPath "Path" to asDirectory
34908>>>>>    Function_Return 0
34909>>>>>End_Procedure
34910>>>>>
34910>>>>>
34910>>>>>Function fsVresExt Global String asFileName Returns String
34911>>>>>    String rVal
34912>>>>>    Integer iPos iLen
34912>>>>>    Move (UpperCase(asFileName)) to asFileName
34913>>>>>    Move (Trim(asFileName)) to asFileName
34914>>>>>    Move 0 to iPos
34915>>>>>    For iLen from 1 to (length(asFileName))
34921>>>>>>
34921>>>>>        If (Mid(asFileName,1,iLen)='.') Move iLen to iPos
34924>>>>>    Loop
34925>>>>>>
34925>>>>>    If (Not(iPos)) Function_Return ''
34928>>>>>    Move (Right(asFileName,(Length(asFileName)-iPos))) to rVal
34929>>>>>    Move (Trim(rVal)) to rVal
34930>>>>>    Function_Return rVal
34931>>>>>End_Function
34932>>>>>
34932>>>>>
34932>>>>>Function fiScreenFieldStatus Global String asViewName String asDbFormName Returns Integer
34933>>>>>    Integer rVal iUser iGroup
34934>>>>>    String  sUser sRecr
34934>>>>>    Move (Trim(asViewName))     to asViewName
34935>>>>>    Move (Trim(asDbFormName))   to asDbFormName
34936>>>>>
34936>>>>>    If ((asViewName<>'') And (asDbFormName<>'')) Begin
34938>>>>>        Get fsLoginUserID to sUser
34939>>>>>        Clear Users
34940>>>>>        Move sUser        to Users.Login_ID
34941>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
34942>>>>>>
34942>>>>>        If (Found=1) Begin
34944>>>>>            Move Users.User_ID  to iUser
34945>>>>>            Move Users.Grp_ID   to iGroup
34946>>>>>            Clear GrpOth
34947>>>>>            Move iUser          to GrpOth.User_ID
34948>>>>>            Move asViewName     to GrpOth.View_Name
34949>>>>>            Move asDbFormName   to GrpOth.Scr_Field_Name
34950>>>>>            Find eq GrpOth by Index.2 // GrpOth:Index.2:User_ID+View_Name+Scr_Field_Name
34951>>>>>>
34951>>>>>            If (Found=1) Begin
34953>>>>>                // rVal=1 ==> NO READ ALLOWED
34953>>>>>                // rVal=2 ==> NO EDIT BUT CAN COPY
34953>>>>>                // rVal=3 ==> NO EDIT AND NO COPY
34953>>>>>                If (GrpOth.Allow_Read <>'1') Move 1 to rVal
34956>>>>>                Else Begin
34957>>>>>                    If (GrpOth.Allow_Change<>'1') Begin
34959>>>>>                        If (GrpOth.Allow_Copy<>'1') Move 3 to rVal
34962>>>>>                        Else                        Move 2 to rVal
34964>>>>>                    End
34964>>>>>>
34964>>>>>                End
34964>>>>>>
34964>>>>>            End
34964>>>>>>
34964>>>>>            Else Begin
34965>>>>>                Clear GrpOth0
34966>>>>>                Move iGroup         to GrpOth0.Group_ID
34967>>>>>                Move asViewName     to GrpOth0.View_Name
34968>>>>>                Move asDbFormName   to GrpOth0.Scr_Field_Name
34969>>>>>
34969>>>>>                Find eq GrpOth0 by Index.2 // GrpOth0:Index.2:Group_ID+View_Name+Scr_Field_Name
34970>>>>>>
34970>>>>>                If (Found=1) Begin
34972>>>>>                    // rVal=1 ==> NO READ ALLOWED
34972>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
34972>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
34972>>>>>                    If (GrpOth0.Allow_Read <>'1') Move 1 to rVal
34975>>>>>                    Else Begin
34976>>>>>                        If (GrpOth0.Allow_Change<>'1') Begin
34978>>>>>                            If (GrpOth0.Allow_Copy<>'1') Move 3 to rVal
34981>>>>>                            Else                         Move 2 to rVal
34983>>>>>                        End
34983>>>>>>
34983>>>>>                    End
34983>>>>>>
34983>>>>>                End
34983>>>>>>
34983>>>>>                Else Move 0 to rVal
34985>>>>>            End
34985>>>>>>
34985>>>>>        End
34985>>>>>>
34985>>>>>        Else Move 0 to rVal
34987>>>>>    End
34987>>>>>>
34987>>>>>    Function_Return rVal
34988>>>>>End_Function
34989>>>>>
34989>>>>>Function fiFieldStatus Global Integer aiFileNumber Integer aiFieldNumber Returns Integer
34990>>>>>    Integer rVal iUser iGroup
34991>>>>>    String  sUser sRecr
34991>>>>>    If ((aiFileNumber) And (aiFieldNumber)) Begin
34993>>>>>        Get fsLoginUserID to sUser
34994>>>>>        Clear Users
34995>>>>>        Move sUser        to Users.Login_ID
34996>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
34997>>>>>>
34997>>>>>        If (Found=1) Begin
34999>>>>>            Move Users.User_ID  to iUser
35000>>>>>            Move Users.Grp_ID   to iGroup
35001>>>>>            Clear Pedia
35002>>>>>            Move aiFileNumber  to Pedia.Arxeio_ID
35003>>>>>            Move aiFieldNumber to Pedia.Pedio_Number
35004>>>>>            Find eq Pedia By Index.1 // Pedia:Index.1:Arxeio_ID+Pedio_Number
35005>>>>>>
35005>>>>>            If (Found=1) Begin
35007>>>>>                Move (Trim(Pedia.Pedio_Recr))   to sRecr
35008>>>>>                // Find Combination User/File/Field in GRPPEDIA
35008>>>>>                Clear GrpPedia
35009>>>>>                Move iUser                      to GrpPedia.User_ID
35010>>>>>                Move (Trim(sRecr))              to GrpPedia.Pedio_Recr
35011>>>>>                Find eq GrpPedia by Index.4 // GrpPedia:Index.4:Pedio_Recr + User_ID
35012>>>>>>
35012>>>>>                If (Found=1) Begin
35014>>>>>                    // rVal=1 ==> NO READ ALLOWED
35014>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
35014>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
35014>>>>>                    If (GrpPedia.Allow_Read <>'1') Move 1 to rVal
35017>>>>>                    Else Begin
35018>>>>>                        If (GrpPedia.Allow_Change<>'1') Begin
35020>>>>>                            If (GrpPedia.Allow_Copy<>'1')   Move 3 to rVal
35023>>>>>                            Else                            Move 2 to rVal
35025>>>>>                        End
35025>>>>>>
35025>>>>>                    End
35025>>>>>>
35025>>>>>                End
35025>>>>>>
35025>>>>>                Else Begin
35026>>>>>                    // Find Combination UserGrps/File/Field in GRPPED0
35026>>>>>                    Clear GrpPed0
35027>>>>>                    Move iGroup         to GrpPed0.Group_ID
35028>>>>>                    Move (Trim(sRecr))  to GrpPed0.Pedio_Recr
35029>>>>>                    Find eq GrpPed0 by Index.4 // GrpPed0:Index.4:Pedio_Recr + Group_ID
35030>>>>>>
35030>>>>>                    If (Found=1) Begin
35032>>>>>                        // rVal=1 ==> NO READ ALLOWED
35032>>>>>                        // rVal=2 ==> NO EDIT BUT CAN COPY
35032>>>>>                        // rVal=3 ==> NO EDIT AND NO COPY
35032>>>>>                        If (GrpPed0.Allow_Read <>'1') Move 1 to rVal
35035>>>>>                        Else Begin
35036>>>>>                            If (GrpPed0.Allow_Change<>'1') Begin
35038>>>>>                                If (GrpPed0.Allow_Copy<>'1')   Move 3 to rVal
35041>>>>>                                Else                           Move 2 to rVal
35043>>>>>                            End
35043>>>>>>
35043>>>>>                        End
35043>>>>>>
35043>>>>>                    End
35043>>>>>>
35043>>>>>                End
35043>>>>>>
35043>>>>>            End
35043>>>>>>
35043>>>>>            Else Begin
35044>>>>>                Move 0 to rVal
35045>>>>>            End
35045>>>>>>
35045>>>>>        End
35045>>>>>>
35045>>>>>        Else Begin
35046>>>>>            Move 0 to rVal
35047>>>>>        End
35047>>>>>>
35047>>>>>    End
35047>>>>>>
35047>>>>>    Function_Return rVal
35048>>>>>End_Function
35049>>>>>
35049>>>>>Function fsReturnFileFromPath Global String asFullPath Returns String
35050>>>>>    String rVal lsDirSep
35051>>>>>    Integer iPos iMet iLen iCnt
35051>>>>>    Move (Trim(asFullPath))                 To rVal
35052>>>>>    Move (Sysconf(SYSCONF_DIR_SEPARATOR))   To lsDirSep
35053>>>>>    If (rVal Contains lsDirSep) Begin
35055>>>>>        Move (Length(rVal)) to iLen
35056>>>>>        Move iLen to iCnt
35057>>>>>        While iCnt Gt 0
35061>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Begin
35063>>>>>                If (iCnt=iLen) Function_Return asFullPath
35066>>>>>                Else Function_Return (Right(rVal,(iLen-iCnt)))
35068>>>>>            End
35068>>>>>>
35068>>>>>            Decrement iCnt
35069>>>>>        End // While iCnt Gt 0
35070>>>>>>
35070>>>>>    End
35070>>>>>>
35070>>>>>    Else  Function_Return (Trim(asFullPath))
35072>>>>>    Function_Return rVal
35073>>>>>End_Function
35074>>>>>
35074>>>>>Function fsReturnDirectoriesFromPath Global String asFullPath Returns String
35075>>>>>    String rVal lsDirSep
35076>>>>>    Integer iPos iMet iLen iCnt
35076>>>>>    Move (Trim(asFullPath))                 To rVal
35077>>>>>    Move (Sysconf(SYSCOnF_DIR_SEPARATOR))   To lsDirSep
35078>>>>>    If (rVal Contains lsDirSep) Begin
35080>>>>>        Move (Length(rVal)) to iLen
35081>>>>>        Move iLen to iCnt
35082>>>>>        While iCnt Gt 0
35086>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Function_Return (Left(rVal,iCnt))
35089>>>>>            Decrement iCnt
35090>>>>>        End // While iCnt Gt 0
35091>>>>>>
35091>>>>>    End
35091>>>>>>
35091>>>>>    Function_Return rVal
35092>>>>>End_Function
35093>>>>>
35093>>>>>//Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
35093>>>>>//    Local String rVal lsTmp lsOO lsLL
35093>>>>>//    Local Number lnOO lnLL
35093>>>>>
35093>>>>>//    Move '' to lsOO
35093>>>>>//    Move '' to lsLL
35093>>>>>//    Move '' to rVal
35093>>>>>
35093>>>>>//    Move (Integer(anTime))                              to lnOO
35093>>>>>//    ////////////////////////////////////////////
35093>>>>>//    // sos sos sos jsjsjsjsjs yannis 30/03/2000
35093>>>>>//    //If ((lnOO=24) and (lnll=0)) Move 0 to lnOO
35093>>>>>//    ////////////////////////////////////////////
35093>>>>>
35093>>>>>//    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
35093>>>>>
35093>>>>>//    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
35093>>>>>//    Else         Move (String(lnOO))                    to lsOO
35093>>>>>//    Move (Trim(lsOO))                                   to lsOO
35093>>>>>
35093>>>>>//    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
35093>>>>>//    Else         Move (String(lnLL))                    to lsLL
35093>>>>>//    Move (Trim(lsLL))                                   to lsLL
35093>>>>>
35093>>>>>//    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
35093>>>>>
35093>>>>>//    Move (Trim(rVal)) to rVal
35093>>>>>
35093>>>>>//    Function_Return rVal
35093>>>>>//End_Function
35093>>>>>
35093>>>>>//Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
35093>>>>>//    Local Number rVal nOres nLepta
35093>>>>>//    Move (Integer(aiMinutes/60))    to nOres
35093>>>>>//    Move (    Mod(aiMinutes,60))    to nLepta
35093>>>>>//    Move (nOres+(nLepta/100))       to rVal
35093>>>>>//    Function_Return rVal
35093>>>>>//End_Function
35093>>>>>
35093>>>>>//Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
35093>>>>>//    Local Integer rVal
35093>>>>>//    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
35093>>>>>//    Function_Return rVal
35093>>>>>//End_Function
35093>>>>>
35093>>>>>//Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;
35093>>>>>//                                                                    Number anEndTime    ;
35093>>>>>//                                                                    Returns Integer
35093>>>>>//    Local Integer rVal iMinStart iMinEnd
35093>>>>>
35093>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
35093>>>>>
35093>>>>>//    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
35093>>>>>//    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
35093>>>>>//    Move (iMinEnd-iMinStart)                                                     to rVal
35093>>>>>//    Function_Return rVal
35093>>>>>//End_Function
35093>>>>>
35093>>>>>
35093>>>>>//Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;
35093>>>>>//                                                                Number anEndTime    ;
35093>>>>>//                                                                Returns Number
35093>>>>>//    Local Integer iTmp
35093>>>>>//    Local Number  rVal
35093>>>>>
35093>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
35093>>>>>
35093>>>>>//    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
35093>>>>>//    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
35093>>>>>//    Function_Return rVal
35093>>>>>//End_Function
35093>>>>>
35093>>>>>
35093>>>>>Function fsLoginUserID Global Returns String
35094>>>>>    Local String LastLogin# LoginUserid#
35095>>>>>    get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin#
35098>>>>>    If LastLogin# eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin#
35101>>>>>    insert "WorkSpaces\" in LastLogin# at 1
35103>>>>>    Append LastLogin# "\" (Module_Name(Self)) "\LastLogin"
35106>>>>>    get_profile_string LastLogin# "LoginUserId"  to LoginUserId#
35109>>>>>    Trim LoginUserID# to LoginUserID#
35110>>>>>>
35110>>>>>    If LoginUserId# eq "" Move (Network_User_Name(Current_Object)) to LoginUserId#
35113>>>>>    Function_Return LoginUserID#
35114>>>>>End_Function
35115>>>>>
35115>>>>>Function fiWriteRegistryLastSDFPath Global String asLastPath Returns Integer
35116>>>>>    Integer rVal
35117>>>>>    String  lsCurrentWksp
35117>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35120>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35123>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35125>>>>>    // Œœ¦ ¡¢œ ›   - Last_SDF_Path -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
35125>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
35125>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
35128>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
35131>>>>>    Function_Return rVal
35132>>>>>End_Function
35133>>>>>
35133>>>>>
35133>>>>>Function fsReadRegistryLastSDFPath Global Returns String
35134>>>>>    String rVal lsCurrentWksp
35135>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35138>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35141>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35143>>>>>    // Œœ¦ ¡¢œ ›   - LastParastUsed -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
35143>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
35143>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
35146>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
35149>>>>>    Function_Return (Trim(rVal))
35150>>>>>End_Function
35151>>>>>
35151>>>>>
35151>>>>>Function fiWriteRegistryLastMCryptPath Global String asLastPath Returns Integer
35152>>>>>    Integer rVal
35153>>>>>    String  lsCurrentWksp
35153>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35156>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35159>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35161>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
35164>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
35167>>>>>    Function_Return rVal
35168>>>>>End_Function
35169>>>>>
35169>>>>>
35169>>>>>Function fsReadRegistryLastMCryptPath Global Returns String
35170>>>>>    String rVal lsCurrentWksp
35171>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35174>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35177>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35179>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
35182>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
35185>>>>>    Function_Return (Trim(rVal))
35186>>>>>End_Function
35187>>>>>
35187>>>>>Function fiWriteRegistryLastWEBPath Global String asLastPath Returns Integer
35188>>>>>    Integer rVal
35189>>>>>    String  lsCurrentWksp
35189>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35192>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35195>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35197>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
35200>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
35203>>>>>    Function_Return rVal
35204>>>>>End_Function
35205>>>>>
35205>>>>>
35205>>>>>Function fsReadRegistryLastWEBPath Global Returns String
35206>>>>>    String rVal lsCurrentWksp
35207>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35210>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35213>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35215>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
35218>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
35221>>>>>    Function_Return (Trim(rVal))
35222>>>>>End_Function
35223>>>>>
35223>>>>>Function fsReadRegistryFEMRootDir Global Returns String
35224>>>>>    String rVal lsCurrentWksp
35225>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35228>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35231>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35233>>>>>    Append lsCurrentWksp "\FEM"
35234>>>>>    Get_Profile_String lsCurrentWksp "RootDir"  to rVal
35237>>>>>    Function_Return (Trim(rVal))
35238>>>>>End_Function
35239>>>>>
35239>>>>>Function fsReadRegistryFEMDevicePath Global Returns String
35240>>>>>    String rVal lsCurrentWksp
35241>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35244>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35247>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35249>>>>>    Append lsCurrentWksp "\FEM"
35250>>>>>    Get_Profile_String lsCurrentWksp "DevicePath"  to rVal
35253>>>>>    Function_Return (Trim(rVal))
35254>>>>>End_Function
35255>>>>>
35255>>>>>Function fiWriteRegistryFEMRootDir Global Returns Integer
35256>>>>>    Integer rVal
35257>>>>>    String  lsCurrentWksp
35257>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35260>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35263>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35265>>>>>    Append lsCurrentWksp "\FEM"
35266>>>>>    Set_Profile_String lsCurrentWksp "RootDir"  to "C:\FEM_ROOT\"
35269>>>>>    Function_Return rVal
35270>>>>>End_Function
35271>>>>>
35271>>>>>Function fiWriteRegistryFEMDevicePath Global Returns Integer
35272>>>>>    Integer rVal
35273>>>>>    String  lsCurrentWksp
35273>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35276>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35279>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35281>>>>>    Append lsCurrentWksp "\FEM"
35282>>>>>    Set_Profile_String lsCurrentWksp "DevicePath"  to "C:\FEM_ROOT\Device_File1.dat"
35285>>>>>    Function_Return rVal
35286>>>>>End_Function
35287>>>>>
35287>>>>>
35287>>>>>
35287>>>>>
35287>>>>>
35287>>>>>Function fig_Is_Admin Global Returns Integer
35288>>>>>    String sUser
35289>>>>>    Integer rVal
35289>>>>>    Get fsLoginUserID to sUser
35290>>>>>    Move (trim(sUser)) to sUser
35291>>>>>    Clear Users
35292>>>>>    Move sUser to Users.Login_ID
35293>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35294>>>>>>
35294>>>>>    Move Users.Admin_Rights to rVal
35295>>>>>    Function_Return rVal
35296>>>>>End_Function
35297>>>>>
35297>>>>>Function fig_The_User_Group Global Returns Integer
35298>>>>>    String sUser
35299>>>>>    Get fsLoginUserID   to sUser
35300>>>>>    Move (trim(sUser))  to sUser
35301>>>>>    Clear Users
35302>>>>>    Move sUser          to Users.Login_ID
35303>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35304>>>>>>
35304>>>>>    Clear UserGrps
35305>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
35306>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
35307>>>>>>
35307>>>>>    Function_Return UserGrps.Grp_ID
35308>>>>>End_Function
35309>>>>>
35309>>>>>Function fsg_The_User_Department Global Returns String
35310>>>>>    String sUser
35311>>>>>    Get fsLoginUserID   to sUser
35312>>>>>    Move (trim(sUser))  to sUser
35313>>>>>    Clear Users
35314>>>>>    Move sUser          to Users.Login_ID
35315>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35316>>>>>>
35316>>>>>    Clear Departm
35317>>>>>    Move Users.Departm_Code   to Departm.Code
35318>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
35319>>>>>>
35319>>>>>    Function_Return Departm.Code
35320>>>>>End_Function
35321>>>>>
35321>>>>>
35321>>>>>Function fig_Is_Specific_Admin Global String asUser Returns Integer
35322>>>>>    Integer rVal
35323>>>>>    Move (trim(asUser)) to asUser
35324>>>>>    Clear Users
35325>>>>>    Move asUser to Users.Login_ID
35326>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35327>>>>>>
35327>>>>>    Move Users.Admin_Rights to rVal
35328>>>>>    Function_Return rVal
35329>>>>>End_Function
35330>>>>>
35330>>>>>Function fig_The_Specific_User_Group Global String asUser Returns Integer
35331>>>>>    Move (trim(asUser))  to asUser
35332>>>>>    Clear Users
35333>>>>>    Move asUser          to Users.Login_ID
35334>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35335>>>>>>
35335>>>>>    Clear UserGrps
35336>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
35337>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
35338>>>>>>
35338>>>>>    Function_Return UserGrps.Grp_ID
35339>>>>>End_Function
35340>>>>>
35340>>>>>Function fsg_The_Specific_User_Department Global String asUser Returns String
35341>>>>>    Move (trim(asUser))  to asUser
35342>>>>>    Clear Users
35343>>>>>    Move asUser          to Users.Login_ID
35344>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35345>>>>>>
35345>>>>>    Clear Departm
35346>>>>>    Move Users.Departm_Code   to Departm.Code
35347>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
35348>>>>>>
35348>>>>>    Function_Return Departm.Code
35349>>>>>End_Function
35350>>>>>
35350>>>>>
35350>>>
35350>>>Class ViewPopupMenu_Sec Is A ViewPopupMenu
35351>>>
35351>>>    Open Sysfile
INCLUDING FILE: SYSFILE.FD
35353>>>    Open Users
35355>>>    Open Views
INCLUDING FILE: VIEWS.FD
35357>>>    Open GrpViews
INCLUDING FILE: GRPVIEWS.FD
35359>>>    Open GrpView0
INCLUDING FILE: GRPVIEW0.FD
35361>>>    Open Arxeia
35363>>>    Open GrpArx
35365>>>
35365>>>    Function Find_User_Rights_In_Class String asView Returns Integer
35366>>>        String  lsView lsLogin
35367>>>        Integer liUser  liViews iGroup
35367>>>
35367>>>        Move (fsLoginUserID())      to lsLogin
35368>>>        Move (Trim(ToOEM(asView)))  to lsView
35369>>>
35369>>>        //////  /////////////////////////////////////
35369>>>        Clear Users
35370>>>        Move lsLogin    to Users.Login_ID
35371>>>
35371>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
35372>>>>
35372>>>        If (Found=1)  Begin
35374>>>            Move Users.User_ID  to liUser
35375>>>            Move Users.Grp_ID   to iGroup
35376>>>        End
35376>>>>
35376>>>        Else Function_Return 0
35378>>>
35378>>>        Clear Views
35379>>>        Move (Trim(lsView)) to Views.Menu_Name
35380>>>        Find eq Views by Index.2 // Views:Index.2:Views.Menu_Name
35381>>>>
35381>>>        If (Found=1) Begin
35383>>>            Move Views.View_ID to liViews
35384>>>            Clear GrpViews
35385>>>            Move liUser    to GrpViews.User_ID
35386>>>            Move liViews   to GrpViews.View_ID
35387>>>            Find Eq GrpViews by Index.1 // GrpViews:Index.1:GrpViews.User_ID+GrpViews.View_ID
35388>>>>
35388>>>            If (Found=1) Begin // And (liUser=GrpViews.User_ID) And (liViews=GrpViews.View_ID)) Begin
35390>>>                Function_Return (GrpViews.Allow_Read<>'1')
35391>>>            End
35391>>>>
35391>>>            Else Begin
35392>>>                Clear GrpView0
35393>>>                Move iGroup    to GrpView0.Group_ID
35394>>>                Move liViews   to GrpView0.View_ID
35395>>>                Find eq GrpView0 by Index.1 // GrpView0:Index.1:Group_ID+View_ID
35396>>>>
35396>>>                If (Found=1) Begin
35398>>>                    Function_Return (GrpView0.Allow_Read<>'1')
35399>>>                End
35399>>>>
35399>>>                Else         Function_Return 0
35401>>>            End
35401>>>>
35401>>>        End
35401>>>>
35401>>>        Else Function_Return 0
35403>>>    End_Function
35404>>>
35404>>>//    Procedure Enhmerose_Views_File_In_Class
35404>>>//        Integer liCount liInt liLastNo
35404>>>//        String lsStr
35404>>>//        Get Item_Count to liCount
35404>>>//        // find last view_id
35404>>>//        Clear Views
35404>>>//        Move 9999 to Views.View_ID
35404>>>//        Find lt Views by index.1 // view_id
35404>>>//        If (Found=1)    Move Views.View_ID  to liLastNo
35404>>>//        Else            Move 0              to liLastNo
35404>>>//        For liInt From 0 to (liCount-1)
35404>>>//            Get Value item liInt to lsStr
35404>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
35404>>>//            //Move (Trim(lsStr)) to lsStr
35404>>>//            If (lsStr<>'') Begin
35404>>>//                Clear Views
35404>>>//                Move lsStr to Views.Menu_Name
35404>>>//                Find eq Views by index.2 // Views.Menu_Name
35404>>>//                If (NOT(Found)) Begin
35404>>>//                    Add 1 to liLastNo
35404>>>//                    Move liLastNo to Views.View_ID
35404>>>//                    Saverecord Views
35404>>>//                End
35404>>>//            End
35404>>>//        Loop
35404>>>//        For liInt From 0 to (liCount-1)
35404>>>//            Get Value item liInt to lsStr
35404>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
35404>>>//            //Move (Trim(lsStr)) to lsStr
35404>>>//            If (lsStr<>'') Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
35404>>>//        Loop
35404>>>//    End_procedure
35404>>>
35404>>>    Procedure OnInitMenu
35405>>>        Integer liCount liInt liLastNo
35406>>>        String lsStr
35406>>>
35406>>>        Get Item_Count to liCount
35407>>>
35407>>>        // find last view_id
35407>>>        Clear Views
35408>>>        Move 9999 to Views.View_ID
35409>>>        Find lt Views by index.1 // view_id
35410>>>>
35410>>>        If (Found=1)    Move Views.View_ID  to liLastNo
35413>>>        Else            Move 0              to liLastNo
35415>>>        For liInt From 0 to (liCount-1)
35421>>>>
35421>>>            Get Value item liInt to lsStr
35422>>>            Move (Trim(lsStr)) to lsStr
35423>>>            If ((lsStr<>'') and (Length(lsStr)>2)) Begin
35425>>>                Clear Views
35426>>>                Move (ToOEM(lsStr)) to Views.Menu_Name
35427>>>                Find eq Views by index.2 // Views.Menu_Name
35428>>>>
35428>>>                If (NOT(Found)) Begin
35430>>>                    Add 1 to liLastNo
35431>>>                    Move liLastNo to Views.View_ID
35432>>>                    //Move (ToOEM(lsStr)) to Views.Menu_Name
35432>>>                    Saverecord Views
35433>>>                End
35433>>>>
35433>>>            End
35433>>>>
35433>>>        Loop
35434>>>>
35434>>>        For liInt From 0 to (liCount-1)
35440>>>>
35440>>>            Get Value item liInt to lsStr
35441>>>            Move (Trim(lsStr)) to lsStr
35442>>>            Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
35443>>>        Loop
35444>>>>
35444>>>
35444>>>    End_procedure
35445>>>
35445>>>//    Procedure End_Construct_Object
35445>>>//        Forward Send End_Construct_Object
35445>>>//        Send Enhmerose_Views_File_In_Class
35445>>>//    End_Procedure
35445>>>
35445>>>End_Class //ButtonSub
35446>>>
35446>>>
35446>Use DD_Sec.Sub
INCLUDING FILE: DD_SEC.SUB
35446>>>
35446>>>Open Sysfile
35448>>>Open UserGrps
35450>>>Open Users
35452>>>Open Views
35454>>>Open GrpViews
35456>>>Open Arxeia
35458>>>Open GrpArx
35460>>>Open GrpArx0
35462>>>Open GrpView0
35464>>>
35464>>>Use DD.Sub
35464>>>
35464>>>Class Datadictionary_Sec  Is A DatadictionarySub
35465>>>
35465>>>
35465>>>    Procedure Construct_Object
35466>>>        Forward Send Construct_Object
35468>>>        Property Integer cpiUpdate              0
35469>>>        Property Integer cpiBackout             0
35470>>>        Property Integer cpiEditing             0
35471>>>        Property Integer cpiFileNumber          0
35472>>>        Property String  cpsFileName            ''
35473>>>        Property String  cpsLoginID             ''
35474>>>        Property Integer cpiCannot_Read         0
35475>>>        Property Integer cpiCannot_Create       0
35476>>>        Property Integer cpiCannot_Delete       0
35477>>>        Property Integer cpiCannot_Edit         0
35478>>>        Property Integer piFN                   0
35479>>>    End_Procedure
35480>>>
35480>>>//    Procedure Save_Main_File
35480>>>//        If (Operation_Origin<>Self) Begin
35480>>>//            If Indirect_File.Recnum Eq 0 Procedure_Return
35480>>>//        End
35480>>>//        Forward Send Save_Main_File
35480>>>//    End_Procedure
35480>>>
35480>>>
35480>>>
35480>>>    Function Validate_Save Returns Integer
35481>>>        Integer rVal
35482>>>        Forward Get Validate_Save to rVal
35484>>>        If (Not(rVal)) Begin
35486>>>            Get cpiCannot_Read to rVal
35487>>>            If (Not(rVal)) Begin
35489>>>                Set cpiEditing to ((cpiBackout(Self)=1) and (cpiUpdate(Self)=1))
35490>>>                If (cpiEditing(Self)=1) Get cpiCannot_Edit      to rVal
35493>>>                Else                    Get cpiCannot_Create    to rVal
35495>>>            End
35495>>>>
35495>>>            If (rVal) Send Operation_Not_Allowed rVal
35498>>>        End
35498>>>>
35498>>>        Function_Return rVal
35499>>>    End_Function
35500>>>
35500>>>    Function Validate_Delete Returns Integer
35501>>>        Integer rVal
35502>>>        Forward Get Validate_Delete to rVal
35504>>>        If (Not(rVal)) Begin
35506>>>            Get cpiCannot_Read to rVal
35507>>>            If (Not(rVal)) Get cpiCannot_Delete to rVal
35510>>>            If (rVal) Send Operation_Not_Allowed rVal
35513>>>        End
35513>>>>
35513>>>        Function_Return rVal
35514>>>    End_Function
35515>>>
35515>>>    Procedure End_Construct_Object
35516>>>        Integer liSrv rVal
35517>>>        String lsStr
35517>>>        Forward Send End_Construct_Object
35519>>>        Get Main_File                                   To liSrv
35520>>>        Set cpiFileNumber                               To liSrv
35521>>>        Get_Attribute DF_FILE_PHYSICAL_NAME Of liSrv    To lsStr
35524>>>        Set cpsFileName                                 To (Trim(Uppercase(lsStr)))
35525>>>        Set cpsLoginID                                  To (fsLoginUserID())
35526>>>        Send Find_User_Rights
35527>>>        Set piFN to lisrv
35528>>>    End_Procedure
35529>>>
35529>>>    Procedure Find_User_Rights
35530>>>        String lsArxeio lsLogin
35531>>>        Integer liUser liArxeio iGroup
35531>>>
35531>>>        Get cpiFileNumber   to liArxeio
35532>>>        Get cpsFileName     to lsArxeio
35533>>>        Get cpsLoginID      to lsLogin
35534>>>
35534>>>        Clear Users
35535>>>        Move lsLogin    to Users.Login_ID
35536>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
35537>>>>
35537>>>        If (Found=1)  Begin
35539>>>            Move Users.User_ID  to liUser
35540>>>            Move Users.Grp_ID   to iGroup
35541>>>        End
35541>>>>
35541>>>        //Else Send Operation_Not_Allowed 9999
35541>>>
35541>>>        Clear Arxeia
35542>>>
35542>>>        Move liArxeio to Arxeia.Arxeio_ID
35543>>>        Find eq Arxeia by Index.1 // Arxeia:Index.1:Arxeia.Arxeio_ID
35544>>>>
35544>>>
35544>>>        If (Found=1) Begin
35546>>>            Move Arxeia.Arxeio_ID to liArxeio
35547>>>
35547>>>            Clear GrpArx
35548>>>            Move liUser     to GrpArx.User_ID
35549>>>            Move liArxeio   to GrpArx.Arxeio_ID
35550>>>            Find eq GrpArx by Index.1 // GrpArx:Index.1:GrpArx.User_ID+GrpArx.Arxeio_ID
35551>>>>
35551>>>            If (Found=1) Begin
35553>>>               If (GrpArx.Allow_Read  ='1') Set cpiCannot_Read   to 0
35556>>>               Else                         Set cpiCannot_Read   to 10003
35558>>>               If (GrpArx.Allow_Create='1') Set cpiCannot_Create to 0
35561>>>               Else                         Set cpiCannot_Create to 10000
35563>>>               If (GrpArx.Allow_Change='1') Set cpiCannot_Edit   to 0
35566>>>               Else                         Set cpiCannot_Edit   to 10001
35568>>>               If (GrpArx.Allow_Delete='1') Set cpiCannot_Delete to 0
35571>>>               Else                         Set cpiCannot_Delete to 10002
35573>>>            End
35573>>>>
35573>>>            Else Begin
35574>>>                Clear GrpArx0
35575>>>                Move iGroup   to GrpArx0.Group_ID
35576>>>                Move liArxeio to GrpArx0.Arxeio_ID
35577>>>                Find eq GrpArx0 by Index.1 // GrpArx0:Index.1:Group_ID+Arxeio_ID
35578>>>>
35578>>>                If (Found=1) Begin
35580>>>                    If (GrpArx0.Allow_Read  ='1')   Set cpiCannot_Read   to 0
35583>>>                    Else                            Set cpiCannot_Read   to 20003
35585>>>                    If (GrpArx0.Allow_Create='1')   Set cpiCannot_Create to 0
35588>>>                    Else                            Set cpiCannot_Create to 20000
35590>>>                    If (GrpArx0.Allow_Change='1')   Set cpiCannot_Edit   to 0
35593>>>                    Else                            Set cpiCannot_Edit   to 20001
35595>>>                    If (GrpArx0.Allow_Delete='1')   Set cpiCannot_Delete to 0
35598>>>                    Else                            Set cpiCannot_Delete to 20002
35600>>>                End
35600>>>>
35600>>>                Else Begin
35601>>>                    Set cpiCannot_Read   to 0
35602>>>                    Set cpiCannot_Edit   to 0
35603>>>                    Set cpiCannot_Create to 0
35604>>>                    Set cpiCannot_Delete to 0
35605>>>                End
35605>>>>
35605>>>            End
35605>>>>
35605>>>        End
35605>>>>
35605>>>        Else Begin
35606>>>            // €¤ ›œ¤ ™¨œŸœ  «¦ ˜¨®œ ¦ «¦«œ Ÿœà¨¦¬£œ ¦«  ¦ ®¨ž©«žª œ®œ  §¨¦©™˜©ž ©'˜¬«¦
35606>>>            Set cpiCannot_Read   to 0
35607>>>            Set cpiCannot_Edit   to 0
35608>>>            Set cpiCannot_Create to 0
35609>>>            Set cpiCannot_Delete to 0
35610>>>        End
35610>>>>
35610>>>    End_Procedure
35611>>>
35611>>>    Procedure Clear_main_file
35612>>>        Forward Send Clear_main_file
35614>>>        Set cpiBackout to 0
35615>>>        Set cpiUpdate  to 0
35616>>>    End_Procedure
35617>>>
35617>>>    Procedure Update
35618>>>        Forward Send Update
35620>>>        Set cpiUpdate to 1
35621>>>    End_Procedure
35622>>>
35622>>>    Procedure Backout
35623>>>        Forward Send Backout
35625>>>        Set cpiBackout to 1
35626>>>    End_Procedure
35627>>>
35627>>>    Procedure OnConstrain
35628>>>        Integer rVal liSrv
35629>>>        Forward Send OnConstrain
35631>>>        Get cpiFileNumber  To liSrv
35632>>>        Move liSrv         To Filenumber
35633>>>        Get cpiCannot_Read to rVal
35634>>>        If (rVal) Constrain Indirect_File.Recnum eq 0
35638>>>    End_Procedure
35639>>>
35639>>>    Procedure Operation_Not_Allowed  Integer iError_Num
35640>>>        String sLektiko
35641>>>        Move '' to sLektiko
35642>>>
35642>>>             If iError_Num eq 10000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
35645>>>        Else If iError_Num eq 10001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Users permissions. Check with your Administrator"    to sLektiko
35649>>>        Else If iError_Num eq 10002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
35653>>>        Else If iError_Num eq 10003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
35657>>>        Else If iError_Num eq 20000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
35661>>>        Else If iError_Num eq 20001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Group permissions. Check with your Administrator"    to sLektiko
35665>>>        Else If iError_Num eq 20002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
35669>>>        Else If iError_Num eq 20003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
35673>>>        Else If iError_Num eq  9999 Move "Unknown User in Users File"                                                                                    to sLektiko
35677>>>        Else If iError_Num eq 20101 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Change its Data"                 to sLektiko
35681>>>        Else If iError_Num eq 20102 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Delete It"                       to sLektiko
35685>>>        Append sLektiko '\nFile = ' (String(cpiFileNumber(Self))) ' - ' (CpsFileName(Self))
35689>>>
35689>>>             If iError_Num eq 10000 Error 10000 sLektiko
35692>>>        Else If iError_Num eq 10001 Error 10001 sLektiko
35696>>>        Else If iError_Num eq 10002 Error 10002 sLektiko
35700>>>        Else If iError_Num eq 10003 Error 10003 sLektiko
35704>>>        Else If iError_Num eq 20000 Error 20000 sLektiko
35708>>>        Else If iError_Num eq 20001 Error 20001 sLektiko
35712>>>        Else If iError_Num eq 20002 Error 20002 sLektiko
35716>>>        Else If iError_Num eq 20003 Error 20003 sLektiko
35720>>>        Else If iError_Num eq  9999 Error  9999 sLektiko
35724>>>        Else If iError_Num eq 20101 Error 20101 sLektiko
35728>>>        Else If iError_Num eq 20102 Error 20102 sLektiko
35732>>>
35732>>>        Else Forward Send Operation_Not_Allowed  iError_Num
35735>>>    End_Procedure   // Operation_Not_Allowed
35736>>>
35736>>>
35736>>>End_Class //Datadictionary_Sec
35737>
35737>
35737>//AB-StoreTopEnd
35737>
35737>
35737>Object Main is a PanelSub
35739>
35739>    //AB-PanelStoreTopStart
35739>    
35739>    
35739>    //AB-PanelStoreTopEnd
35739>
35739>    Set Label To "js for test"
35740>    Use emporiko.mn //  Menu package.
INCLUDING FILE: EMPORIKO.MN
35740>>>
35740>>>Use Menu_Sec.Sub
35740>>>DFCreate_Menu Main_Menu        
35743>>>
35743>>>Property String psMenuModule Public ''           
35745>>>  
35745>>>///  #INCLUDE File_pm.inc
35745>>>  
35745>>>//*********************************************************************************
35745>>>//================================================================
35745>>>  dfcreate_menu "œ¢á«œª" cust_popupmenu is a viewpopupmenu
35749>>>
35749>>>//   on_item "EnhPumps"                               send activate_EnhPumps
35749>>>
35749>>>//   on_item "EnhFpa"                               send activate_EnhFpa
35749>>>//   on_item "SAP"                               send activate_Sap1
35749>>>//   on_item "EnhSlsID"                               send activate_EnhSlsID
35749>>>   on_item "FTPVIEW"                               send activate_FTPVIEW
35750>>>//   on_item "FtpRdisk"                               send activate_FtpRdisk
35750>>>
35750>>>//   on_item "‹ž«¨é¦ œ¢˜«é¤"                               send activate_vwclients
35750>>>//dfcreate_menu "„¨š˜ " helpcn_popupmenu is a viewpopupmenu_Sec
35750>>>//    on_item "‹ž«¨é¦ „¨šà¤"                                 send activate_v041
35750>>>//    on_item "ˆ©¦çš ¦ „¨šà¤"                       send activate_r41_2
35750>>>//    on_item "€¨®œå¦ „¨šà¤ - œ¢˜«é¤"                       send activate_cn
35750>>>//      on_item "ƒ.„.Ž.  œ¢˜«é¤ - „¨šà¤"                    send activate_v193
35750>>>//      on_item "†£œ¨ã© ˜ ƒœ¢«å˜ ˜¨¨˜ššœ¢ é¤"               send activate_vw051
35750>>>//    On_Item ""                                            Send NONE
35750>>>//    on_item "€¤˜§¨¦©˜¨£¦šã « £é¤ ƒ.„.Ž.  "                    send activate_v193c
35750>>>//   on_item "€¢¢˜šã ¡˜«á©«˜©žª ƒ.„.Ž.  "                    send activate_v193d
35750>>>//    on_item '„¡«ç§à©ž ’ £¦¡˜«˜¢æšà¤ ™á©ž œ§ ¢œš£â¤à¤ ¡¨ «ž¨åà¤'      send activate_r193
35750>>>//    on_item "¨¦š¨˜££˜« ©£æª"                           send activate_vw062
35750>>> 
35750>>> //   on_item "’ £¦¡˜«á¢¦š¦  œ¢˜«é¤ - „¨šà¤"                send activate_vtimolc
35750>>>//    On_Item ""                                             Send NONE
35750>>>//     on_item "‰˜¨«â¢œª œ¢˜«é¤ - „¨šà¤"   send activate_r100_3
35750>>>//     on_item "‰˜«á©«˜©ž €§¦Ÿœ£˜« ¡¦ç"                     send activate_r100_a
35750>>>//     ON_item "‰˜«á©«˜©ž à¢ã©œà¤ F.O.T."                  send activate_r41_1
35750>>>//    END_PULL_DOWN     
35750>>>// dfcreate_menu "“§œçŸ¬¤¦  ‘¬¤˜¢¢˜šé¤ " helppayresp_popupmenu is a ViewPopupMenu_Sec
35750>>>//    on_item "‹ž«¨é¦ “§œçŸ¬¤à¤ ‘¬¤˜¢¢˜šé¤"               send activate_v111
35750>>> //    On_Item ""                                          Send NONE
35750>>> //    on_item "„¡«ç§à©ž “§œçŸ¬¤à¤ ‘¬¤˜¢¢˜šé¤ "             send activate_r111_0
35750>>>//     On_Item "„¡«ç§à©ž ‰ ¤ã©œà¤ ˜¤á “§œçŸ¬¤¦ ¢ž¨à£é¤ "   Send Activate_r111_1
35750>>>//     On_Item "„¡«ç§à©ž ¡ ¤ã©œà¤ ë¨šà¤ ˜¤á “§œçŸ¬¤¦ ¢ž¨à£é¤ "      Send Activate_r111_2
35750>>>//     On_Item "„¡«ç§à©ž œ¢˜«é¤ ˜¤á “§œçŸ¬¤¦ ¢ž¨à£é¤ "    Send Activate_r111_3
35750>>>//     On_Item "‰˜¨«â¢œª “§œçŸ¬¤à¤ ¢ž¨à£é¤ - ë¨šà¤ "       Send Activate_r111_4
35750>>>//     on_item "à¢ã©œ ª “§œçŸ¬¤à¤ ¢ž¨à£é¤ - ë¨šà¤ "       send activate_r111_5
35750>>>// END_PULL_DOWN
35750>>>//   On_Item ""                                             Send NONE
35750>>>//   on_item "‰ ¤ã©œ ª œ¢˜«é¤        "                     send activate_vwcmoves
35750>>>//     on_item "‹ž«¨é¦ “§¦¯ã­ à¤ œ¢˜«é¤ - ¨¦©­¦¨é¤"         send activate_v91
35750>>>//     on_item "„¡«ç§à©ž ¨¦©­¦¨é¤ “§¦¯ã­ à¤ œ¢˜«é¤ "        send activate_r91_2
35750>>>//   on_item "’ £¦¡˜«á¢¦š¦  œ¢˜«é¤"                        send activate_Vwtimol
35750>>>//     DFCreate_Menu "Open Items" openitems_PopupMenu IS A ViewPopupMenu
35750>>>//     on_item "AGING"        send activate_r6_5
35750>>>//     on_item ""             send None
35750>>>
35750>>>// jsjs
35750>>>//    On_Item "Copen"                     Send Activate_Copen
35750>>>//    On_Item "tOpItem"                   Send Activate_tOpItem
35750>>>//    On_Item "tOpItDel"                  Send Activate_tOpItDel
35750>>>//    On_Item ""                          Send None
35750>>>//    On_Item "EnhCmvs"                   Send Activate_EnhCmvs
35750>>>//    On_Item ""                          Send None
35750>>>//    On_Item "FixIT"                   Send Activate_FixIT
35750>>>
35750>>>
35750>>>//      On_Item "„¡«ç§à©ž €©¬©®â« ©«à¤-‘¬©®œ« ©£â¤à¤ ˜¨˜©«˜« ¡é¤ / œ¢á«ž" Send activate_r9_1
35750>>>//      On_Item "„¡«ç§à©ž „¡¡¨œ£é¤ ˜¨˜©«˜« ¡é¤ / œ¢á«ž - „¨š¦"       Send activate_r9_2
35750>>>//     END_PULL_DOWN
35750>>>
35750>>>//   On_Item ""                                             Send NONE
35750>>>//   on_item "‰˜¨«â¢˜ œ¢˜«é¤"                              send activate_vwkartel
35750>>>//   On_Item ""                                             Send NONE
35750>>>//   dfcreate_menu "„¡«¬§é©œ ª" printcust_popupmenu is a viewpopupmenu
35750>>>//      On_Item "„¡«ç§à©ž €¨®œå¦¬ œ¢˜«é¤"                   Send activate_r100_0
35750>>>//      On_Item "„¡«ç§à©ž œ¢˜«é¤ ®à¨åª „šš¬ž« ¡ã"           Send activate_r100_E
35750>>>//     on_item "HPAL"        send activate_HPAL
35750>>>//     on_item ""             send None
35750>>>//      on_item "‰˜¨«â¢œª œ¢˜«é¤       "           send activate_r6_1hm
35750>>>//     on_item "‰ ¤ã©œ ª œ¢˜«é¤ (Basic)"                   send activate_r6_1b
35750>>>//     on_item "à¢ã©œ ª „ ›é¤ / „å›¦ª"                     send activate_r18_1
35750>>>//     on_item "à¢ã©œ ª „ ›é¤ / „å›¦ª (Basic)"             send activate_r18_1b
35750>>>//     on_item "à¢ã©œ ª €¤á œ¢á«ž"                          send activate_r18_3
35750>>>//     on_item "à¢ã©œ ª ‰˜«á œ¢á«ž Ž£˜›¦§¦ ž£â¤˜"         send activate_r18_5
35750>>>//     on_item "à¢ã©œ ª ‰˜«á œ¢á«ž (Basic)"               send activate_r18_3b
35750>>>//     on_item "‘¬š¡œ¤«¨à« ¡âª à¢ã©œ ª ‰˜«á œ¢á«ž - ‹ã¤˜" send activate_r18_4
35750>>>//     on_item "‘¬š¡œ¤«¨à« ¡âª à¢ã©œ ª „ ›é¤ / ‰˜«á ‹ã¤˜"  send activate_r18_2
35750>>>//     On_Item ""                                           Send NONE
35750>>>//     On_Item "“§æ¢¦ §˜ œ¢˜«é¤ €¤á ‹ã¤˜"                  Send activate_r6_3
35750>>>//     On_Item "‘¬š¡œ¤«¨à« ¡á ¬§æ¢¦ §˜ œ¢˜«é¤"            Send activate_r6_3a
35750>>>//     On_Item "„¤ž¢ ¡åà©ž “§¦¢¦å§à¤ œ¢˜«é¤"               Send activate_r6_5
35750>>>//     On_Item ""                                           Send NONE
35750>>>//     on_item "ˆ©¦çš ¦ œ¢˜«é¤ "                          send activate_r6_2
35750>>>//     on_item "ˆ©¦çš ¦ œ¢˜«é¤ (Basic)"                   send activate_r6_2b
35750>>>//     On_Item "‰¬¡¢¦­¦¨ ˜¡ã ’˜®ç«ž«˜ œ¢˜«é¤"              Send activate_r100_1
35750>>>//       On_Item "‰˜«á©«˜©ž ˜¨˜¢˜™é¤ œ¢˜«é¤"              Send activate_r100_34
35750>>>//     On_Item "‰˜«á©«˜©ž œ¢˜«é¤ ‹â “§â¨™˜©ž ¢˜­æ¤"       Send activate_r100_2
35750>>>//     On_Item ""                                           Send NONE
35750>>>//    On_Item "•¨¦¤¦› áš¨˜££˜ „ ©§¨á¥œà¤"                  Send activate_r70_0
35750>>>//      On_Item "‘¬š¡¨ « ¡âª ¡˜«˜©«á©œ ª à¢ã©œà¤"           Send activate_r100s
35750>>>//     dfcreate_menu "Š¦š ©« ¡âª" printpel2_popupmenu is a viewpopupmenu
35750>>>//     on_item "‰˜¨«â¢¢œª œ¢˜«é¤ (H)"                    send activate_r6_1c
35750>>>//     on_item "†£œ¨¦¢¦š ˜¡âª ‰ ¤ã©œ ª œ¢˜«é¤ (H)"       send activate_r6_4g
35750>>>//     END_PULL_DOWN
35750>>>//  END_PULL_DOWN
35750>>>//  DFCreate_Menu "" HelpCust1_PopupMenu IS A ViewPopupMenu
35750>>>//    On_Item ""                                            Send NONE
35750>>> 
35750>>>//
35750>>>//  dfcreate_menu "¦žŸž« ¡á " helpcust_popupmenu is a viewpopupmenu
35750>>>//    on_item "‰ ¤ã©œ ª ˜¨˜©«˜« ¡é¤"                       send activate_vwcytpkin
35750>>>//    on_item "˜¨á£œ«¨¦  ‰ ¤ã©œà¤ ˜¨˜©«˜« ¡é¤"            send activate_cflagkin
35750>>>//    on_item "„¡«ç§à©ž Flags ‰ ¤ã©œà¤"                     send activate_r7_0
35750>>>//    On_Item ""                                            Send NONE
35750>>>//    on_item "˜¨˜©«˜« ¡á - ‘œ ¨âª"                                 send activate_ptyppar
35750>>>//    on_item "‹œ«˜©®.˜¨˜©«˜« ¡é¤ ©œ"                      send activate_ptypmet
35750>>>//    on_item "‘œ ¨âª"                                      send activate_pseira
35750>>>//    On_Item ""                                            Send NONE
35750>>>//    on_item "Ž¨ ©£æª †£œ¨¦¢¦šåà¤"                         send activate_hmgio
35750>>>//     on_item "‹œ«˜­¦¨á “§¦¢¦å§à¤ œ¢˜«é¤"                  send activate_rmetafyp
35750>>>//  END_PULL_DOWN
35750>>>  Procedure OnInitMenu
35752>>>     Forward Send OnInitMenu
35754>>>     Set psMenuModule to '01'
35755>>>     Move '01' to gs_Module_Code
35756>>>  End_Procedure
35757>>>  END_PULL_DOWN
35759>>>////================================================================
35759>>>  dfcreate_menu " — Š † ‘ „ ˆ ‘ " sales_popupmenu is a viewpopupmenu
35763>>>//    on_item "ƒ ˜®œå¨ ©ž ˜¨˜©«˜« ¡é¤ é¢ž©žª"             send activate_particle
35763>>>//    on_item "„¡«ç§à©ž ¡˜«á©«˜©žª §˜¨˜©«˜« ¡é¤" send activate_r14
35763>>>//    on_item "ƒ ˜®œå¨ž©ž œ¡¡¨œ£é¤ §˜¨˜©«˜« ¡é¤"        send activate_v14_1
35763>>>//    on_item "‹˜ ¡æª â¢œš®¦ª ¡˜  ¦¨ ©« ¡ã œ¡«ç§à©ž §˜¨˜©«˜« ¡é¤ "  send activate_v14a
35763>>>      //    On_Item ""                                            Send NONE
35763>>>//   on_item "ƒ ˜®œå¨ž©ž „¡¡¨œ£é¤ ˜¨˜©«˜« ¡é¤ ˜§æ Betolink "        send activate_v192
35763>>>//   on_item "‹œ«˜©®ž£˜« ©£æª ˜¨˜©«˜« ¡é¤"                send activate_v014
35763>>>//    On_Item "„¡«ç§à©ž „¡¡¨œ£é¤ ˜¨˜©«˜« ¡é¤ œ¢˜«é¤"       Send Activate_r9_3
35763>>>//    on_item '' send none
35763>>> //   dfcreate_menu "ƒ ˜®œå¨ž©ž ˜¨˜ššœ¢ é¤ œ¢˜«é¤" orders1_popupmenu is a viewpopupmenu
35763>>> //   on_item "‹ž«¨é¦ œ¢˜«é¤"                               send activate_vwclients
35763>>> //   On_Item "ƒ ˜®œå¨ž©ž ‚œ¤ ¡ãª ˜¨˜ššœ¢å˜ª"           Send Activate_v94
35763>>>//    on_item "ƒ ˜®œå¨ž©ž ˜¨˜ššœ¢ é¤ €¤á œ¢á«ž"    send activate_v94_1
35763>>>//    on_item "„¡«ç§à©ž ‰˜«á©«˜©žª ˜¨˜ššœ¢ é¤ €¤á œ¢á«ž"    send activate_r94_3
35763>>>//   end_pull_down
35763>>>                          
35763>>>    Procedure OnInitMenu
35765>>>       Forward Send OnInitMenu
35767>>>       Set psMenuModule to '01'
35768>>>       Move '01' to gs_Module_Code
35769>>>    End_Procedure
35770>>>  END_PULL_DOWN // Polhseis
35772>>>//
35772>>>////================================================================
35772>>>//
35772>>>  dfcreate_menu "¨¦£žŸœ¬«âª" prom_popupmenu is a viewpopupmenu
35776>>>//    on_item "‹ž«¨é¦ ¨¦£žŸœ¬«é¤"                          send activate_vwclients
35776>>>//    On_Item ""                                            Send NONE
35776>>>//    on_item "‰ ¤ã©œ ª ¨¦£žŸœ¬«é¤    "                    send activate_vwcmoves
35776>>>//      On_Item ""                                            Send NONE
35776>>>//      on_item "‰˜¨«â¢¢˜ ¨¦£žŸœ¬«é¤"                        send activate_vwkartel
35776>>>//        on_item "’ £¦¡˜«á¢¦š¦  ¨¦£žŸœ¬«é¤"                   send activate_Vwtimol
35776>>>//      On_Item ""                                            Send NONE
35776>>>//    dfcreate_menu "„¡«¬§é©œ ª" printprom_popupmenu is a viewpopupmenu
35776>>>//      On_Item "„¡«ç§à©ž €¨®œå¦¬ ¨¦£žŸœ¬«é¤"              Send activate_r100_0
35776>>>//      on_item "‰˜¨«â¢œª ¨¦£žŸœ¬«é¤    "                  send activate_r6_1hm
35776>>>//      on_item "‰˜¨«â¢œª œ¢˜«é¤    "                send activate_r6_1hm
35776>>>//      on_item "‰ ¤ã©œ ª ¨¦£žŸœ¬«é¤ (Basic)"              send activate_r6_1b
35776>>>//      on_item "€š¦¨âª „ ›é¤ / „å›¦ª"                      send activate_r18_1
35776>>>//      on_item "€š¦¨âª „ ›é¤ / „å›¦ª (Basic)"              send activate_r18_1b
35776>>>//        on_item "€š¦¨âª €¤á ¨¦£žŸœ¬«ã"                    send activate_r18_3
35776>>>//      on_item "€š¦¨âª ‰˜«á ¨¦£žŸœ¬«ã (Basic)"            send activate_r18_3b
35776>>>//        on_item "€š¦¨âª €¤á ¨¦£žŸœ¬«ã Ž£˜›¦§¦ ž£â¤˜"      send activate_r18_5
35776>>>//      On_Item "‘¬š¡œ¤«¨à« ¡âª €š¦¨âª / ¨¦£žŸœ¬«ã-‹ã¤˜"   Send activate_r18_4
35776>>>//      on_item "‘¬š¡œ¤«¨à« ¡âª €š¦¨âª „ ›é¤ ‰˜«á ‹ã¤˜"     send activate_r18_2
35776>>>//      On_Item ""                                          Send NONE
35776>>>//      On_Item "“§æ¢¦ §˜ ¨¦£žŸœ¬«é¤ €¤á ‹ã¤˜"             Send activate_r6_3
35776>>>//      On_Item "„¤ž¢ ¡åà©ž “§¦¢¦å§à¤ ¨¦£žŸœ¬«é¤"          Send activate_r6_5
35776>>>//      On_Item "‘¬š¡œ¤«¨à« ¡á ¬§æ¢¦ §˜ ¨¦£žŸœ¬«é¤"         Send activate_r6_3a
35776>>>//      On_Item ""                                          Send NONE
35776>>>//      on_item "ˆ©¦çš ¦ ¨¦£žŸœ¬«é¤"                      send activate_r6_2
35776>>>//      on_item "ˆ©¦çš ¦ ¨¦£žŸœ¬«é¤ (Basic)"              send activate_r6_2b
35776>>>//      On_Item "‰˜«á©«˜©ž ˜¨˜¢˜™é¤ ¨¦£žŸœ¬«é¤"         Send activate_r100_34
35776>>>//      On_Item "‘¬©®â« ©ž „ ›é¤ / ¨¦£žŸœ¬«ã"              Send activate_r186_0
35776>>>//      On_Item "‘¬©®â« ©ž „ ›é¤ €¤á „å›¦ª/¨¦£žŸœ¬«ã"      Send activate_r186_1
35776>>>//      On_Item ""                                          Send NONE
35776>>>//     On_Item "‘¬š¡¨ « ¡ã ¡˜«á©«˜©ž €š¦¨é¤ "             Send activate_r100s
35776>>>//     On_Item "•¨¦¤¦› áš¨˜££˜ ¢ž¨à£é¤"                   Send activate_r70_0
35776>>>//      dfcreate_menu "Š¦š ©« ¡âª" printprom2_popupmenu is a viewpopupmenu
35776>>>//        on_item "‰˜¨«â¢¢œª ¨¦£žŸœ¬«é¤ (H)"               send activate_r6_1c
35776>>>//        on_item "†£œ¨¦¢¦š ˜¡âª ‰ ¤ã©œ ª ¨¦£žŸœ¬«é¤ (H)"  send activate_r6_4g
35776>>>//      END_PULL_DOWN
35776>>>//    END_PULL_DOWN
35776>>>//    dfcreate_menu "¦žŸž« ¡á " helpprom_popupmenu is a viewpopupmenu
35776>>>//       on_item "‹œ«˜­¦¨á “§¦¢¦å§à¤ ¨¦£žŸœ¬«é¤"            send activate_rmetafyp
35776>>>//      on_item "‰ ¤ã©œ ª ˜¨˜©«˜« ¡é¤"                     send activate_vwcytpkin
35776>>>//      on_item "˜¨á£œ«¨¦  ‰ ¤ã©œà¤ ˜¨˜©«˜« ¡é¤"          send activate_cflagkin
35776>>>//      On_Item ""                                          Send NONE
35776>>>//      on_item "˜¨˜©«˜« ¡á"                               send activate_ptyppar
35776>>>//       on_item "‹œ«˜©®.˜¨˜©«˜« ¡é¤ ©œ"                      send activate_ptypmet
35776>>>//       On_Item ""                                          Send NONE
35776>>>//      on_item "Ž¨ ©£æª †£œ¨¦¢¦šåà¤"                       send activate_hmgio
35776>>>//    END_PULL_DOWN
35776>>>    
35776>>>    Procedure OnInitMenu
35778>>>       Forward Send OnInitMenu
35780>>>       Set psMenuModule to '02'
35781>>>       Move '02' to gs_Module_Code
35782>>>    End_Procedure
35783>>>    
35783>>>  END_PULL_DOWN
35785>>>//
35785>>>  dfcreate_menu "€ ‚ Ž  „ ‘ " purchase_popupmenu is a viewpopupmenu
35789>>>//    on_item "ƒ ˜®œå¨ ©ž ˜¨˜©«˜« ¡é¤ €š¦¨é¤"     send activate_particle
35789>>>//    On_Item ""                                            Send NONE
35789>>>//    on_item "‰¦©«¦¢æšž©ž"                        send activate_vwKostol
35789>>>//    On_Item ""                                            Send NONE
35789>>>//    On_Item "‰˜«žš¦¨åœª „¥æ›à¤"                  Send Activate_V176
35789>>>//    on_item "ƒ ˜®œå¨ž©ž œ¡¡¨œ£é¤ §˜¨˜©«˜« ¡é¤"            send activate_v14_1
35789>>>//    On_Item ""                                            Send NONE
35789>>>//   on_item "ƒ ˜®œå¨ž©ž „¡¡¨œ£é¤ ˜¨˜©«˜« ¡é¤ ˜§æ Betolink "        send activate_v192
35789>>>//    On_Item "„¡«ç§à©ž „¡¡¨œ£é¤ ˜¨˜©«˜« ¡é¤ ¨¦£žŸœ¬«é¤"   Send Activate_r9_3
35789>>>//    on_item "‹œ«˜©®ž£˜« ©£æª ˜¨˜©«˜« ¡é¤"                send activate_v014
35789>>>//    dfcreate_menu "ƒ ˜®œå¨ž©ž ˜¨˜ššœ¢ é¤ " orders1_popupmenu is a viewpopupmenu
35789>>>//       On_Item "ƒ ˜®œå¨ž©ž ‚œ¤ ¡ãª ˜¨˜ššœ¢å˜ª"           Send Activate_v94
35789>>>//      on_item "ƒ ˜®œå¨ž©ž ˜¨˜ššœ¢ é¤ €¤á ¨¦£žŸœ¬«ã"    send activate_v94_1
35789>>>//       on_item "„¡«ç§à©ž ‰˜«á©«˜©žª ˜¨˜ššœ¢ é¤ €¤á ¨¦£žŸœ¬«ã"    send activate_r94_3
35789>>>//    end_pull_down
35789>>>    Procedure OnInitMenu
35791>>>       Forward Send OnInitMenu
35793>>>       Set psMenuModule to '02'
35794>>>       Move '02' to gs_Module_Code
35795>>>    End_Procedure
35796>>>  END_PULL_DOWN
35798>>>
35798>>>  dfcreate_menu "€§¦Ÿã¡œª" stores_popupmenu is a viewpopupmenu
35802>>>//   on_item "‰˜«˜®é¨ž©ž „ ›é¤"                            send activate_item
35802>>>//   On_Item "‰˜¨«â¢œª „ ›é¤"                              Send Activate_v017a
35802>>>//   On_Item "‰˜¨«â¢œª „ ›é¤"                              Send Activate_v17x
35802>>>  
35802>>>//   On_Item ""                                            Send NONE
35802>>>//    on_item "‰ ¤ã©œ ª  „ ›é¤"                             send activate_KinApoth
35802>>>//    on_item "‘¬©®œ«å©œ ª „ ›é¤ €§¦Ÿã¡žª"                    send Popup_Dialog_dg186 //activate_dg186
35802>>>//       on_item "ƒ ˜¡å¤ž©ž œ ›é¤ (‘)"               send activate_V182 
35802>>>   
35802>>>    
35802>>>//    dfcreate_menu "„¤«¦¢âª ˜¨˜šàšãª" ent_popupmenu is a viewpopupmenu
35802>>>//      on_item "‹˜ ¡ã › ˜¡å¤ž©ž œ ›é¤"               send activate_V182s 
35802>>>//      on_item "‰˜«˜®é¨ž©ž „¤«¦¢é¤ ˜¨˜šàšãª"              send activate_v185
35802>>>     
35802>>>//      On_Item "„¡«ç§à©ž „¤«¦¢é¤ ˜¨˜šàšãª"                Send activate_r185_0
35802>>>//   //    On_Item "˜¨˜šàšâª-€¤˜¢é©œ ª „ ›é¤ €§æ ‘ç¤Ÿœ©ž/€§¦©ç¤Ÿœ©ž" Send activate_r185_1
35802>>>//  END_PULL_DOWN
35802>>>//    dfcreate_menu "„¡«¬§é©œ ª" printapoth_popupmenu is a viewpopupmenu
35802>>>//      on_item "„¡«ç§à©ž €¨®œå¦¬ „ ›é¤"                    send activate_r26_3
35802>>>//      on_item "„¡«¬§é©œ ª †£œ¨¦¢¦šåà¤"                    send activate_r22_1
35802>>>//      on_item "„¡«¬§é©œ ª ‰ ¤ã©œà¤ €§¦Ÿž¡é¤"              send activate_r26_6
35802>>>//      on_item "„¡«¬§é©ž ˆ©¦¬šå¦¬ €§¦Ÿã¡žª"               send activate_r26_1
35802>>>//      on_item "„¡«¬§é©ž ˆ©¦¬šå¦¬ €§¦Ÿã¡žª (‡œà¨ž£â¤¦)"   send activate_r26_1b
35802>>>//      on_item "„¡«¬§é©ž ‰˜¨«â¢˜ª „å›¦¬ª"                  send activate_r17_2
35802>>>//        on_item "„¡«¬§é©ž €§¦Ÿœ£á«à¤ €§¦Ÿã¡žª"              send activate_V15
35802>>>//       On_Item "‰¬¡¢¦­¦¨ ˜¡ã ’˜®ç«ž«˜ „ ›é¤"               Send Activate_r26_2
35802>>>//         On_Item "¨¦š¨˜££˜« ©£æª ˜¨˜ššœ¢å˜ª „ ›é¤"        Send Activate_r26_4
35802>>>//      On_Item ""                                          Send NONE
35802>>>//      on_item "Ž¨ ©£æª †£œ¨¦¢¦šåà¤ €§¦Ÿã¡žª"              send activate_hmgiow
35802>>>//        on_item "„¡«ç§à©ž €§¦š¨˜­ãª"                    send activate_r22_2
35802>>>//    END_PULL_DOWN
35802>>>    dfcreate_menu "¦žŸž« ¡á " helpapoth_popupmenu is a viewpopupmenu
35806>>>//      on_item "ƒ ˜®œå¨ž©ž €§¦Ÿž¡é¤"                         send activate_wax
35806>>>//      On_Item ""                                          Send NONE
35806>>>//      on_item "‹¦¤á›œª ‹â«¨ž©žª"                          send activate_units
35806>>>//        on_item "‰˜«žš¦¨åœª ”..€"                          send activate_fpa
35806>>>//      on_item "‰˜«žš¦¨åœª „ ›é¤"                          send activate_witemkat
35806>>>//      On_Item ""                                          Send NONE
35806>>>//      on_item "’ç§¦  §˜¨˜©«˜« ¡é¤"                        send activate_vwcytpkin
35806>>>//      on_item "‰ ¤ã©œ ª ˜¨˜©«˜« ¡é¤"                     send activate_wtypkin
35806>>>//      on_item "˜¨á£œ«¨¦  ‰ ¤ã©œà¤ ˜¨˜©«˜« ¡é¤"          send activate_wflagkin
35806>>>//      on_item "„¡«ç§à©ž Flags ‰ ¤ã©œà¤ €§¦Ÿã¡žª"          send activate_r29_0
35806>>>//        on_item "ƒž£ ¦¬¨šå˜ ‰ ¤ã©œà¤ €§¦š¨˜­ãª"             send activate_r17_1
35806>>>    END_PULL_DOWN
35808>>>
35808>>>    Procedure OnInitMenu
35810>>>       Forward Send OnInitMenu
35812>>>       Set psMenuModule to '03'
35813>>>       Move '03' to gs_Module_Code
35814>>>    End_Procedure
35815>>>    
35815>>>    
35815>>>
35815>>> // END_PULL_DOWN // Apothikes
35815>>>
35815>>>//  dfcreate_menu "¦žŸž« ¡á " constr_popupmenu is a viewpopupmenu
35815>>>//      on_item "‹ž«¨é¦ „¨š¦¢á™à¤"                          send activate_v109
35815>>> //   dfcreate_menu "„¨š¦¢á™¦  " helpconstr_popupmenu is a viewpopupmenu
35815>>>//      on_item "‹ž«¨é¦ „¨š¦¢á™à¤"                          send activate_v109
35815>>>//      On_Item ""                                          Send NONE
35815>>> //     on_item "„¡«ç§à©ž „¨š¦¢á™à¤"                        send activate_r109_0
35815>>>//      On_Item "„¡«ç§à©ž ‰ ¤ã©œà¤ €¤á „¨š¦¢á™¦"            Send Activate_r109_1
35815>>>//      On_Item "„¡«ç§à©ž „¨šà¤ €¤á „¨š¦¢á™¦"               Send Activate_r109_2
35815>>>//      on_item "‰˜¨«â¢œª „¨š¦¢á™à¤ - „¨šà¤"                send activate_r109_2
35815>>>//    END_PULL_DOWN
35815>>>//    dfcreate_menu "à¢ž«âª" helpsales_popupmenu is a viewpopupmenu
35815>>>//      on_item "‹ž«¨é¦ à¢ž«é¤"                            send activate_v108
35815>>>//      On_Item ""                                          Send NONE
35815>>>//      on_item "„¡«ç§à©ž à¢ž«é¤"                          send activate_r108_0
35815>>>//      on_item "„¡«ç§à©ž Œâà¤ œ¢˜«é¤ €¤á à¢ž«ã"          send activate_r108_3
35815>>>//      On_Item "„¡«ç§à©ž ‰ ¤ã©œà¤ €¤á à¢ž«ã"              Send Activate_r108_1
35815>>>//      On_Item "„¡«ç§à©ž ‘¬š¡œ¤«¨à« ¡é¤ à¢ã©œà¤ ˜¤á à¢ž«ã" Send Activate_r108_4
35815>>>//      On_Item "„¡«ç§à©ž ¨¦¬§¦¢¦š ©« ¡é¤ à¢ã©œà¤" Send Activate_r108_6
35815>>>//      On_Item "„¡«ç§à©ž ¨¦¬§¦¢¦š ©« ¡é¤ à¢ã©œà¤ „¨šà¤" Send Activate_r108_10
35815>>>//      On_Item "‰˜¨«â¢œª à¢ž«é¤ - „¨šà¤ "                 Send Activate_r108_2
35815>>>//    END_PULL_DOWN
35815>>>//    dfcreate_menu "‹ž®˜¤ ¡¦å" helpmhxa_popupmenu is a viewpopupmenu
35815>>>//     on_item "‹ž«¨é¦ ‹ž®˜¤ ¡é¤"                          send activate_v055
35815>>>//      On_Item ""                                          Send NONE
35815>>> //     On_Item "„¡«ç§à©ž ‹ž®˜¤ ¡é¤"                        Send activate_r55_0
35815>>>//      On_Item "„¡«ç§à©ž ‰ ¤ã©œà¤ €¤á ‹ž®˜¤ ¡æ"            Send Activate_r55_1
35815>>>//      On_Item "„¡«ç§à©ž „¨šà¤ €¤á ‹ž®˜¤ ¡æ"               Send Activate_r55_2
35815>>>//    END_PULL_DOWN
35815>>>//    DFCreate_Menu "„¨š˜" Helpcn_PopupMenu IS A ViewPopupMenu
35815>>>//    On_Item "„¡«ç§à©ž „¨šà¤ €¤á œ¢á«ž"                 Send Activate_r41_0
35815>>>//    END_PULL_DOWN
35815>>>//    On_Item ""                                            Send NONE
35815>>>//    On_Item "€¨®œå¦ •à¨é¤"                                Send Activate_v058 
35815>>>//    On_Item "€¨®œå¦ œ¨ ¦®é¤"                             Send Activate_v197
35815>>>//    On_Item "€¨®œå¦ Œ¦£é¤"                                Send Activate_v057
35815>>>//    On_Item "€¨®œå¦ æ¢œà¤"                               Send Activate_v198 
35815>>>//    On_Item "€¨®œå¦ …à¤é¤"                                Send Activate_v064 
35815>>>//    On_Item "“§¦¡˜«˜©«ã£˜«˜ - …é¤œª/’¨æ§¦  ¢ž¨à£ãª"                        Send Activate_v065 
35815>>>//    On_Item ""                                            Send NONE
35815>>>//    dfcreate_menu "€¨®œå¦ Ž›žšé¤" driver_popupmenu is a viewpopupmenu
35815>>>//      on_item "‰˜«˜®é¨ž©ž Ž›žšé¤"                         send activate_v052
35815>>>//      On_Item ""                                          Send NONE
35815>>>//      on_item "„¡«ç§à©ž Ž›žšé¤"                           send activate_r052_0
35815>>>//    END_PULL_DOWN
35815>>>//    dfcreate_menu "€¨®œå¦ Ž®ž£á«à¤" cars_popupmenu is a viewpopupmenu
35815>>>//      on_item "‰˜«˜®é¨ž©ž Ž®ž£á«à¤"                       send activate_v054
35815>>>//      On_Item ""                                          Send NONE
35815>>>//      on_item "„¡«ç§à©ž Ž®ž£á«à¤"                         send activate_r54_0
35815>>>//      on_item "„¡«ç§à©ž ‰ ¤ã©œà¤ Ž®ž£á«à¤"                send activate_r54_1
35815>>>//    END_PULL_DOWN
35815>>>//    dfcreate_menu "€¨®œå¦ €¤«¢ é¤" pumps_popupmenu is a viewpopupmenu
35815>>>//      on_item "‰˜«˜®é¨ž©ž €¤«¢ é¤"                        send activate_v053
35815>>>//      On_Item ""                                          Send NONE
35815>>>//      on_item "„¡«ç§à©ž €¤«¢ é¤"                          send activate_r53_0
35815>>>//      on_item "„¡«ç§à©ž ‰ ¤ã©œà¤ €¤«¢ é¤"                  send activate_r53_1
35815>>>//    END_PULL_DOWN
35815>>>  END_PULL_DOWN
35817>>>//
35817>>>  dfcreate_menu "€¥ æš¨˜­˜" axio_popupmenu is a viewpopupmenu
35821>>>//    on_item "Gefyres Karapanos"                       send activate_GefKarap
35821>>>//    on_item "taxio"                       send activate_taxio
35821>>>//    on_item "Rypol"                       send activate_Rypol
35821>>>//    on_item "ƒ ˜®œå¨ ©ž €¥ ¦š¨á­à¤"                       send activate_vw037
35821>>>//    On_Item ""                                            Send NONE
35821>>>//   on_item "‰ ¤ã©œ ª  €¥ ¦š¨á­à¤"                        send activate_v036
35821>>>//   on_item '†£œ¨¦¢æš ¦ „ ©§¨á¥œà¤'            send activate_r36a
35821>>>//   on_item 'Šž¥ á¨ ¦ €¥ ¦š¨á­à¤'               send activate_r36b  
35821>>>//   on_item 'Šž¥ á¨ ¦ €¥ ¦š¨á­à¤ ‘¬š¡.'         send activate_r36eja
35821>>>//      on_item "‹˜ ¡ã „¥æ­¢ž©ž €¥ ¦š¨á­à¤"                send activate_axioexofl
35821>>>//    On_Item ""                                            Send NONE
35821>>>//    dfcreate_menu "„¡«¬§é©œ ª" printaxio_popupmenu is a viewpopupmenu
35821>>>//     on_item "„¡«ç§à©ž €¥ ¦š¨á­à¤"                       send activate_rv037C 
35821>>>//      on_item "„¡«ç§à©ž †£œ¨¦¢¦šå¦¬ €¥ ¦š¨á­à¤"          send activate_r044 
35821>>>//    END_PULL_DOWN
35821>>>    dfcreate_menu "¦žŸž« ¡á " helpaxio_popupmenu is a viewpopupmenu 
35825>>>//      on_item "’ç§¦  €¥ ¦š¨á­à¤"                          send activate_v034 
35825>>>//      on_item "ƒâ©£œ¬©ž €¥ ¦š¨á­à¤"                        send activate_axiored
35825>>>//      on_item "‰ ¤ã©œ ª ˜¥ ¦š¨á­à¤ ©ç¤›œ©ž £œ ‚.Š"        send activate_v031 
35825>>>      //On_Item ""                                          Send NONE
35825>>>//     on_item "Š¦š ©« ¡¦§¦åž©ž / €¡ç¨à©ž ˜¨˜©«˜« ¡é¤ €¥ ¦š¨á­à¤"    send activate_V21b
35825>>>//      on_item "Status €¥ ¦š¨á­à¤"                        send activate_axiostat
35825>>>////      on_item "’¬§¦  §˜¨˜©«˜« ¡é¤"                        send activate_vwcytpkin 
35825>>>//      on_item "‰ ¤ã©œ ª ˜¨˜©«˜« ¡é¤"                     send activate_cflagkin 
35825>>>//      on_item "˜¨˜©«˜« ¡á"                               send activate_ptyppar 
35825>>>//        on_item "Ž¨ ©£æª ‹ ¡«é¤ †£œ¨¦¢¦šåà¤"                send activate_hmgio
35825>>>    END_PULL_DOWN
35827>>>    
35827>>>    Procedure OnInitMenu
35829>>>       Forward Send OnInitMenu
35831>>>       Set psMenuModule to '04'
35832>>>       Move '04' to gs_Module_Code
35833>>>    End_Procedure
35834>>> END_PULL_DOWN
35836>>>
35836>>>//    on_item "áš ˜"                               send run_pagia 
35836>>>//
35836>>>  DFCreate_Menu "System Maintenance " Sysmain_PopupMenu IS A ViewPopupMenu
35840>>>//      on_item "„«˜ ¨œåœª-“§¦¡˜«-•¨ã©œ ª"                    send activate_v3 
35840>>>//    On_Item ""                                            Send NONE
35840>>>//      on_item "ƒ ˜®œå¨ ©ž „©à«œ¨ ¡é¤  ¤á¡à¤"               send activate_types_maint 
35840>>>//      on_item "ƒ ˜®œå¨ ©ž ‘«˜Ÿœ¨é¤ ‘¬©«ã£˜«¦ª"              send activate_V00 
35840>>>//      on_item "ƒ ˜®œå¨ ©ž „¡«¬§é©œà¤ "              send activate_Vrep 
35840>>>//      on_item "‚â­¬¨˜ ¡ ¤ã©œà¤ §œ¢˜«é¤ + §˜¨˜©«˜« ¡é¤ §é¢ž©žª" send activate_VWEXPORT
35840>>>//      on_item "Ž¨ ©£æª †£œ¨¦¢¦šåà¤"                         send activate_hmgio
35840>>>//    on_item "Œ¦£å©£˜«˜"                                   send activate_nomism  // nomismata 
35840>>>//    on_item "ˆ©¦« £åœª"                                   send activate_nomisot // isotimies 
35840>>>//      On_Item "‰˜«žš¦¨åœª ”..€ "                           Send activate_fpa
35840>>>//  //  on_item "ƒ ˜› ¡˜©åœª ‹œ«˜š¢é«ž©žª"                    send activate_translat 
35840>>>//  //  on_item "€¤« ©«¦å® ©ž Šœ¡« ¡é¤"                       send activate_transla2 
35840>>>//    on_item "€¨®œå¦ ƒŽ“ ˜§¦ Betolink"                     send activate_EnhDoy
35840>>>//    on_item "„¤ž£â¨à©ž ‹œ©¦‘«˜Ÿ£ ¡é¤"                     send activate_EnhMeso
35840>>>//     on_item "‘¬©®â« ©ž ˜¨˜©«˜« ¡é¤ „£§¦¨ ¡¦ç £œ ‚.Š¦š ©« ¡ã"    send activate_V21
35840>>>//     on_item "Š¦š ©« ¡¦§¦åž©ž §˜¨˜©«˜« ¡é¤ - ¡ ¤ã©œà¤ œ£§¦¨ ¡¦ç"    send activate_Vlogik 
35840>>>
35840>>>//      on_item "Š¦š ©« ¡¦§¦åž©ž €¥ ¦š¨á­à¤ "    send activate_V30
35840>>>     dfcreate_menu "ƒ ˜®œå¨ž©ž ˜šåà¤" pagia_popupmenu is a viewpopupmenu
35844>>>//       on_item "‰˜«žš¦¨åœª ˜šåà¤"                            send activate_v80
35844>>>//       on_item "‰ ¤ã©œ ª §˜šåà¤ - ¡ ¤ã©œ ª ©«ž¤ ‚.Š"          send activate_v82
35844>>>//       on_item "‹ž«¨é¦ ˜šåà¤"                                send activate_v83
35844>>>//       on_item "Ž¨ ©« ¡¦§¦åž©ž œšš¨˜­é¤ ‚â­¬¨˜ £œ ‚.Š"        send activate_Vgl
35844>>>//       on_item "ƒž£ ¦¬¨šå˜ ‰ ¤ã©œà¤ ˜šåà¤"                   send activate_r83_1
35844>>>//       On_Item ""                                             Send NONE
35844>>> //      on_item "„¡«ç§à©ž ˜šåà¤"                              send activate_r83_2
35844>>> //      on_item "„¡«ç§à©ž ¨¦®œå¨¦¬ ‹ž«¨é¦¬ €§¦©™â©œà¤ ˜šåà¤" send activate_r83_3
35844>>> //      on_item "„¡«ç§à©ž ¨¦¬§¦¢¦š ©£¦ç €§¦©™â©œà¤ ˜šåà¤"    send activate_r83_4
35844>>>    END_PULL_DOWN
35846>>> 
35846>>>  END_PULL_DOWN
35848>>>
35848>>>//  dfcreate_menu "ƒ ˜®œå¨ž©ž ˜šåà¤" pagia_popupmenu is a viewpopupmenu
35848>>>
35848>>>//       on_item "‰˜«žš¦¨åœª ˜šåà¤"                            send activate_v80
35848>>>//       on_item "‰à› ¡¦å ‰ ¤ã©œà¤ ‘«ž¤ ‚.Š"                    send activate_v82
35848>>>//       on_item "‹ž«¨é¦ ˜šåà¤"                                send activate_v83
35848>>>//       on_item "ƒž£ ¦¬¨šå˜ ‰ ¤ã©œà¤ ˜šåà¤"                   send activate_r83_1
35848>>>//       on_item "„¡«ç§à©ž ˜šåà¤"                              send activate_r83_2
35848>>>//       on_item "„¡«ç§à©ž ¨¦®œå¨¦¬ ‹ž«¨é¦¬ €§¦©™â©œà¤ ˜šåà¤" send activate_r83_3
35848>>>//       on_item "„¡«ç§à©ž ¨¦¬§¦¢¦š ©£¦ç €§¦©™â©œà¤ ˜šåà¤"    send activate_r83_4
35848>>>
35848>>>      
35848>>>//  END_PULL_DOWN
35848>>>//================================================================
35848>>>//   DFCreate_Menu "Security / User Rights" Security00 IS A ViewPopupMenu_Sec
35848>>>//
35848>>>//        on_item "Group Of Users Rights Per File/Field"          Send Activate_GrpPed00
35848>>>//        on_item "Users Rights Per File/Field"                   Send Activate_GrpPedia
35848>>>//
35848>>>//        On_Item ''                                              Send None
35848>>>//
35848>>>//        on_item "Group Of Users Rights Per Menu Item - View"    Send Activate_GrpView0
35848>>>//        on_item "Users Rights Per Menu Item - View"             Send Activate_GrpViews
35848>>>//
35848>>>//        On_Item ''                                              Send None
35848>>>//
35848>>>//        on_item "Group Of Users Rights Per Screen Field - View" Send Activate_GrpOth0
35848>>>//        on_item "Users Rights Per Screen Field - View"          Send Activate_GrpOth
35848>>>//
35848>>>//        On_Item ''                                              Send None
35848>>>//
35848>>>//        on_item "Users"                                         Send Activate_Users
35848>>>//        on_item "Users Groups"                                  Send Activate_UserGrps
35848>>>//        on_item "Users Departments"                             Send Activate_Departm
35848>>>//
35848>>>//        On_Item ''                                              Send None
35848>>>//
35848>>>//        on_item "Views / Screen Fields"                         Send Activate_Oth
35848>>>//        On_Item ''                                              Send None
35848>>>//        on_item "Views"                                         Send Activate_Views
35848>>>//        on_item "Files"                                         Send Activate_Arxeia
35848>>>//        on_item "Fields"                                        Send Activate_Pedia
35848>>>//
35848>>>//    End_Pull_Down // Security
35848>>>//    Set Status_Help To ""
35848>>>//
35848>>>//  //MNB-StoreStart
35848>>>//
35848>>>//  //MNB-StoreEnd
35848>>>//
35848>>>//    Open Sysfile
35848>>>//    //Open Sysrec
35848>>>//    Open Users
35848>>>//    Open UserGrps
35848>>>//    Open Pedia
35848>>>//    Open Views
35848>>>//    Open GrpViews
35848>>>//    Open GrpView0
35848>>>//    Open Arxeia
35848>>>//    Open GrpArx
35848>>>//    Open GrpArx0
35848>>>//    Open GrpOth
35848>>>//    Open GrpOth0
35848>>>//    Open Oth
35848>>>//
35848>>>//    Procedure Check_Rights_On_User_Administration
35848>>>//        Local integer iCount
35848>>>//        Local String lsUser
35848>>>//        Get Item_Count to iCount
35848>>>//        // ?? ????? ?? ?????œ??ÿ ?? ?ÿ??ÿ????? ?? ?œ??ÿ ˜??? ?? ??ê????ÿ?
35848>>>//        Get fsLoginUserID to lsUser
35848>>>//        Move (trim(lsUser)) to lsUser
35848>>>//        Clear Users
35848>>>//        Move lsUser to Users.Login_ID
35848>>>//        Find eq Users By Index.1 // Users:Index.1:Login_ID
35848>>>//        Set Shadow_State item (iCount-1) to (Users.Admin_Rights<>'1')
35848>>>//    End_Procedure
35848>>>//
35848>>>//    Procedure Activate
35848>>>//        Forward Send Activate
35848>>>//        Send Check_Rights_On_User_Administration
35848>>>//        Send Enhmerose_Views_File
35848>>>//        Send Enhmerose_Arxeia_File
35848>>>//    End_Procedure
35848>>>//
35848>>>//    Procedure OnInitMenu
35848>>>//        Forward Send OnInitMenu
35848>>>//        Send Check_Rights_On_User_Administration
35848>>>//        Send Enhmerose_Views_File
35848>>>//    End_Procedure
35848>>>//
35848>>>//
35848>>>//
35848>>>////================================================================
35848>>>  End_Menu // Main_Menu
35850>>>  procedure run_pagia
35852>>>    chain wait 'C:\Vdf6\Develop\Pagia\Programs\test'
35853>>>  end_procedure
35854>>>  
35854>>>    
35854>>> //   Procedure Popup_Dialog_dg186
35854>>> //       Send popup to (dg186(Self))
35854>>> //   End_Procedure
35854>>>
35854>>>
35854>>>//
35854>>>////
35854>>>//Procedure Enhmerose_Views_File
35854>>>//    Integer liCount liInt liLastNo iMax
35854>>>//    String lsStr
35854>>>//    Get Item_Count Of Main_Menu to liCount
35854>>>//    Clear Views
35854>>>//    Move 9999 to Views.View_ID
35854>>>//    Find lt Views by index.1 // view_id
35854>>>//    If (Found=1)    Move Views.View_ID  to liLastNo
35854>>>//    Else            Move 0              to liLastNo
35854>>>//    // ?? ?ÿ????ÿ??ÿ?˜ ?? ???? ??ÿ????? ?? ??? ?????????
35854>>>//    // ??? ?ÿ??? ??ÿ ?? ??ê????ÿ? menu ??? security ??
35854>>>//    // ??ÿ? ?????ÿ????ÿ ?? ?? password ??? login
35854>>>//    // ?ÿ ???? ??ÿ ?? ??ÿ? ?ÿ??ÿ licount-2
35854>>>////
35854>>>//    For liInt From 0 to (liCount-2) // ?? 2 ?ÿ? ?? ??? ???ÿ ?? ??ê????ÿ? ?? ?ÿ??ÿ ?? security
35854>>>//        Get Value of Main_Menu item liInt to lsStr
35854>>>//        Move (Trim(lsStr)) to lsStr
35854>>>//        If ((lsStr<>'') and (Length(lsStr)>2)) Begin
35854>>>//            Clear Views
35854>>>//            Move lsStr to Views.Menu_Name
35854>>>//            Find eq Views by index.2 // Views.Menu_Name
35854>>>//            If (NOT(Found)) Begin
35854>>>//                Move lsStr to Views.Menu_Name
35854>>>//                If (Trim(Views.Menu_Name)<>'') Begin
35854>>>//                    Add 1 to liLastNo
35854>>>//                    Move liLastNo to Views.View_ID
35854>>>//                    Saverecord Views
35854>>>//                End
35854>>>//            End
35854>>>//        End
35854>>>//    Loop
35854>>>////
35854>>>//End_Procedure
35854>>>////
35854>>>//Procedure Enhmerose_Pedia_File Integer aiFileNumber
35854>>>//    Integer iFields iInt iField_Number
35854>>>//    Integer iField_Length iField_Type  iField_Precision
35854>>>//    String  sField_Name
35854>>>//    Get_Attribute DF_FILE_NUMBER_FIELDS Of aiFileNumber to iFields
35854>>>////
35854>>>//    For iInt From 1 to iFields // To recnum (0) ektos
35854>>>//        Get_Attribute DF_FIELD_NUMBER    Of aiFileNumber iInt to iField_Number
35854>>>//        Get_Attribute DF_FIELD_LENGTH    Of aiFileNumber iInt to iField_Length
35854>>>//        Get_Attribute DF_FIELD_NAME      Of aiFileNumber iInt to sField_Name
35854>>>//        Get_Attribute DF_FIELD_PRECISION Of aiFileNumber iInt to iField_Precision
35854>>>//        Get_Attribute DF_FIELD_TYPE      Of aiFileNumber iInt to iField_Type
35854>>>//        Clear Pedia
35854>>>//        Move aiFileNumber   to Pedia.Arxeio_ID
35854>>>//        Move iField_Number  to Pedia.Pedio_Number
35854>>>//        Find eq Pedia By Index.1 //Pedia:Index.1:Arxeio_ID+Pedio_Number
35854>>>//        If (Not(Found)) Begin
35854>>>//            Move iField_Length      to Pedia.Pedio_Length
35854>>>//            Move sField_Name        to Pedia.Pedio_Name
35854>>>//            Move iField_Precision   to Pedia.Pedio_Precision
35854>>>//            Move iField_Type        to Pedia.Pedio_Type
35854>>>//            Move (Trim((String(Pedia.Arxeio_ID))-(String(Pedia.Pedio_Number)))) to ;
35854>>>//            Pedia.Pedio_Recr
35854>>>//            Saverecord Pedia
35854>>>//        End
35854>>>//    Loop
35854>>>//End_Procedure
35854>>>////
35854>>>//Procedure Enhmerose_Arxeia_File
35854>>>//    Local Integer File# Open# File_Number# liInt iMax iWait
35854>>>//    Local String Physicalname# Display_Name#
35854>>>//    Move 0 To File#
35854>>>////
35854>>>////    Move (Wait(Self)) to iWait
35854>>>////    Set Button_State of iWait to False
35854>>>////    Set BarVisibleState of iWait to ("Checking File System Integrity. Current File=>" + (String(File_Number#))) False
35854>>>////    Send Popup      to iWait
35854>>>////
35854>>>//    Repeat
35854>>>//      Get_Attribute Df_File_Next_Opened Of File# To File#
35854>>>//      If File# Begin
35854>>>//        Get_Attribute Df_File_Number Of File# To File_Number#
35854>>>//        // ?? ?ÿ????? ????ÿ? ??ÿ?????ÿ ?? File number >= 50 ??? filelist
35854>>>//        // ??ÿ <=199
35854>>>//        If  ( (File_Number#=3)  Or ((File_Number#>49) and (File_Number#<200))) Begin
35854>>>//            Get_Attribute Df_File_Physical_Name Of File# To Physicalname#
35854>>>//            Get_Attribute DF_FILE_DISPLAY_NAME  Of File# To Display_Name#
35854>>>//            Move (UpperCase(Physicalname#)) to Physicalname#
35854>>>////
35854>>>////            Send UpdateWait to iWait  ("Checking File System Integrity. Current File=>" + (String(File_Number#)))
35854>>>////
35854>>>//            Clear Arxeia
35854>>>//            Move File_Number# to Arxeia.Arxeio_ID
35854>>>//            Find eq Arxeia By Index.1 // Arxeio_ID
35854>>>//            If (NOT(Found)) Begin
35854>>>//                Move Physicalname#  to Arxeia.Arxeio_Name
35854>>>//                Move Display_name#  to Arxeia.Access_Name
35854>>>//                Saverecord Arxeia
35854>>>//            End
35854>>>////
35854>>>//            If (File_Number#) Send Enhmerose_Pedia_File File_Number#
35854>>>////
35854>>>//        End
35854>>>//      End
35854>>>//    Until File# Eq 0
35854>>>////    Send Deactivate to iWait
35854>>>//End_Procedure
35854>>>  
35854>>>Register_Object Client_Area
35854>>>
35854>    
35854>    Use DFStdBtn.pkg //  Tool-Bar object.
INCLUDING FILE: DFSTDBTN.PKG
35854>>>// 07/23/96 JJT - New Class names
35854>>>// 10/03/97 KCR - removed leading separator
35854>>>
35854>>>Use DFMainBt  // dfMain_ButtonBar
INCLUDING FILE: DFMAINBT.PKG
35854>>>>>//-------------------------------------------------------------------------
35854>>>>>// DFMainBt.pkg - DfMain_ButtonBar class
35854>>>>>//
35854>>>>>//
35854>>>>>// 07/23/96 JJT - New Class names
35854>>>>>//-------------------------------------------------------------------------
35854>>>>>
35854>>>>>Use DfPanel // dfapp_buttonbar
35854>>>>>
35854>>>>>Class ToolBar is a AppToolBar
35855>>>>>
35855>>>>>    Function Is_Function Integer MsgId Integer ObjId Integer DelegateFg Returns Integer
35856>>>>>      Local integer rval MainObj#
35857>>>>>      Get Main_Panel_id to MainObj#
35858>>>>>      If (ObjId>Desktop AND MainObj#) ;         Get Is_Function of MainObj# MsgId ObjId DelegateFg to rVal
35861>>>>>      Function_Return rVal
35862>>>>>    End_Function
35863>>>>>
35863>>>>>    Procedure Redirect_Button_Message integer Itm
35864>>>>>         Local integer Msg# Aux# rval Understood
35865>>>>>         If (Shadow_State(Current_Object,itm)) Procedure_Return
35868>>>>>         Get Message   item itm  to Msg#
35869>>>>>         Get Aux_Value item itm  to Aux#
35870>>>>>         If Msg# Begin
35872>>>>>           If Aux# eq 0 Begin
35874>>>>>              Get Focus to Aux#
35875>>>>>              Get Is_Function Get_DEO_Object Aux# TRUE to Understood
35876>>>>>              If Not Understood Move 0 to Aux#
35879>>>>>           End
35879>>>>>>
35879>>>>>           If Aux# Get Msg# of Aux# to rval
35882>>>>>           Procedure_return rval
35883>>>>>         end
35883>>>>>>
35883>>>>>    End_Procedure // Redirect_Message
35884>>>>>
35884>>>>>End_Class
35885>>>>>
35885>>>>>
35885>>>
35885>>>//  Button bar object.
35885>>>//
35885>>>Object Tool_Bar is a ToolBar
35887>>>
35887>>>    Send ImageList_Add 'bgn.bmp'   // 0
35888>>>    Send ImageList_Add 'end.bmp'   // 1
35889>>>    Send ImageList_Add 'next.bmp'  // 2
35890>>>    Send ImageList_Add 'prev.bmp'  // 3
35891>>>    Send ImageList_Add 'clr.bmp'   // 4
35892>>>    Send ImageList_Add 'clra.bmp'  // 5
35893>>>
35893>>>    send Add_button (ico_user+0) msg_beginning_of_data
35894>>>    Send Add_ToolTip "Beginning of file"
35895>>>    Set  Status_Help To 'Find the First record (Ctrl+Home)'
35896>>>
35896>>>    send Add_button (ico_user+3) msg_find_previous
35897>>>    Send Add_ToolTip "Find Previous"
35898>>>    Set  Status_Help To 'Find the Previous record (F7)'
35899>>>
35899>>>    send Add_button (ico_user+2) msg_find_next
35900>>>    Send Add_ToolTip "Find Next"
35901>>>    Set  Status_Help To 'Find the Next record (F8)'
35902>>>
35902>>>    send Add_button (ico_user+1) msg_end_of_data
35903>>>    Send Add_ToolTip "End of File"
35904>>>    Set  Status_Help To 'Find the Last record (Ctrl+End)'
35905>>>
35905>>>    send Add_space
35906>>>
35906>>>    send Add_button ico_std_find msg_prompt
35907>>>    Send Add_ToolTip "Prompt"
35908>>>    Set  Status_Help To 'Show available selections (F4)'
35909>>>
35909>>>    send Add_button (ico_user+4) msg_request_clear
35910>>>    Send Add_ToolTip "Clear"
35911>>>    Set  Status_Help To 'Clear current record / Add a new record (F5)'
35912>>>
35912>>>    send Add_button (ico_user+5) msg_request_clear_all
35913>>>    Send Add_ToolTip "Clear All"
35914>>>    Set  Status_Help To 'Clear all data from view (Ctrl+F5)'
35915>>>
35915>>>    send Add_space
35916>>>
35916>>>    send Add_button ico_std_filesave msg_request_save
35917>>>    Send Add_ToolTip "Save"
35918>>>    Set  Status_Help To 'Save the current record (F2)'
35919>>>
35919>>>    send Add_button ico_std_delete msg_request_delete
35920>>>    Send Add_ToolTip "Delete"
35921>>>    Set  Status_Help To 'Delete the current record (Shift+F2)'
35922>>>
35922>>>    send Add_space
35923>>>
35923>>>    send Add_button ico_std_cut msg_cut
35924>>>    Send Add_ToolTip "Cut"
35925>>>    Set  Status_Help to "Cuts the selection and puts it on the Clipboard"
35926>>>
35926>>>    send Add_button ico_std_copy msg_copy
35927>>>    Send Add_ToolTip "Copy"
35928>>>    Set  Status_Help to "Copies the selection and puts it on the Clipboard"
35929>>>
35929>>>    send Add_button ico_std_paste msg_paste
35930>>>    Send Add_ToolTip "Paste"
35931>>>    Set  Status_Help to "Inserts Clipboard contents"
35932>>>
35932>>>End_Object
35933>>>
35933>    
35933>    Object Client_Area is a AppClientAreaSub
35935>
35935>        //AB-ClientStoreTopStart
35935>        // Ž‘Ž•† ‚„Œˆ‰„‘ ‹„’€Š†’„‘ //
35935>        String Plhktro_BIP  Plhktro_Esc  Plhktro_N11  Plhktro_N00  Plhktro_FS  Plhktro_AAA  Plhktro_DSI
35935>        String Plhktro_SO   Plhktro_DC4     //expanded for 1 line
35935>        String Plhktro_SI   Plhktro_DC2     //condesed
35935>        String Plhktro_PAV                  //underline
35935>        String Plhktro_EEE  Plhktro_FFF     //emphasized
35935>        String Plhktro_GGG  Plhktro_HHH     //double strike
35935>        String Plhktro_WWW                  //expanded
35935>        string Plhktro_Q Plhktro_160
35935>        Integer giViewID
35935>        String  gsViewName
35935>        // Ž‘Ž•† ‚„Œˆ‰„‘ ‹„’€Š†’„‘ //
35935>        
35935>        Open Sysfile
35937>        Open Sysrec
INCLUDING FILE: SYSREC.FD
35939>        
35939>        //Use dbViews.Sub
35939>        //Use dbForms.Sub
35939>        
35939>        //Use GrpPed00.vw
35939>        //Use GrpPedia.vw
35939>        //Use GrpView0.vw
35939>        //Use GrpViews.vw
35939>        //Use GrpOth0.vw
35939>        //Use GrpOth.vw
35939>        //Use Users.vw
35939>        //Use UserGrps.vw
35939>        //Use Departm.vw
35939>        //Use Othon.vw
35939>        //Use Views.vw
35939>        //Use Arxeia.vw
35939>        //Use Pedia.vw
35939>        //Use Viewflds.vw
35939>        
35939>        //Use Cflagkin.vw
35939>        //Use Wflagkin.vw
35939>        
35939>        Use Listes
INCLUDING FILE: LISTES.PKG
35939>>>Use Wax.sl
INCLUDING FILE: WAX.SL
35939>>>>>//AB/ Project Wax:Lookup Apothikhs
35939>>>>>//AB/ Object prj is a Lookup_Project
35939>>>>>//AB/     Set ProjectName to "Wax:Lookup Apothikhs"
35939>>>>>//AB/     Set ProjectFileName to "Wax.SL"
35939>>>>>//AB/     Set GenerateFileName to "NONAME"
35939>>>>>
35939>>>>>// Project Object Structure
35939>>>>>//   Wax is a dbModalPanelSub
35939>>>>>//     Wapokat_DD is a DataDictionary
35939>>>>>//     Wapomast_DD is a DataDictionary
35939>>>>>//     Wax_DD is a DataDictionary
35939>>>>>//     oSelList is a dbListSub
35939>>>>>//     oOK_bn is a ButtonSub
35939>>>>>//     oCancel_bn is a ButtonSub
35939>>>>>//     oSearch_bn is a ButtonSub
35939>>>>>
35939>>>>>// Register all objects
35939>>>>>Register_Object oCancel_bn
35939>>>>>Register_Object oOK_bn
35939>>>>>Register_Object oSearch_bn
35939>>>>>Register_Object oSelList
35939>>>>>Register_Object Wapokat_DD
35939>>>>>Register_Object Wapomast_DD
35939>>>>>Register_Object Wax
35939>>>>>Register_Object Wax_DD
35939>>>>>
35939>>>>>
35939>>>>>//AB-IgnoreStart
35939>>>>>
35939>>>>>Use DFAllEnt.pkg
35939>>>>>Use dbList.Sub
35939>>>>>Use Button.Sub
35939>>>>>
35939>>>>>
35939>>>>>Use WAPOKAT.DD
INCLUDING FILE: WAPOKAT.DD
35939>>>>>>>//DDB-FileStart
35939>>>>>>>//DDB-HeaderStart
35939>>>>>>>
35939>>>>>>>// File Name : WAPOKAT.DD
35939>>>>>>>// Class Name: Wapokat_DataDictionary
35939>>>>>>>// Revision  : 21
35939>>>>>>>// Version   : 2
35939>>>>>>>
35939>>>>>>>Use  Windows           // Basic Definitions
35939>>>>>>>Use  DataDict          // DataDictionary Class Definition
35939>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
35939>>>>>>>
35939>>>>>>>Open Wapokat
INCLUDING FILE: WAPOKAT.FD
35941>>>>>>>Open Wapomast
INCLUDING FILE: WAPOMAST.FD
35943>>>>>>>Open Sysrecw
INCLUDING FILE: SYSRECW.FD
35945>>>>>>>Open Syscurxr
35947>>>>>>>
35947>>>>>>>//DDB-HeaderEnd
35947>>>>>>>//DDB-SelectionStart
35947>>>>>>>//DDB/ ExternalSelectionList sl022  sl022.SL
35947>>>>>>>Register_Object sl022
35947>>>>>>>//DDB-SelectionEnd
35947>>>>>>>
35947>>>>>>>Class Wapokat_DataDictionary  is a DataDictionary
35948>>>>>>>
35948>>>>>>>    // Update:
35948>>>>>>>    Procedure Update
35949>>>>>>>        Forward Send Update
35951>>>>>>>        // Insert Code Here
35951>>>>>>>//        Move SysCurXR.Company_Code   to Wapokat.Company_Code
35951>>>>>>>//        Move SysCurXR.Branch_Code     to Wapokat.Branch_Code
35951>>>>>>>//        Move SysCurXR.Year_Year         to Wapokat.Year_Year
35951>>>>>>>    End_Procedure   // Update
35952>>>>>>> 
35952>>>>>>>     Procedure Creating
35953>>>>>>>        Forward Send Creating
35955>>>>>>>        // Insert Code Here
35955>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wapokat.Wapokat_Rec0)))))) to Wapokat.Wapokat_Recr
35956>>>>>>>    End_Procedure   // Creating
35957>>>>>>>
35957>>>>>>>
35957>>>>>>>    // Define_Fields:
35957>>>>>>>    // This procedure is used to set up all data-dictionary rules.
35957>>>>>>>
35957>>>>>>>    Procedure Define_Fields
35958>>>>>>>        Forward Send Define_Fields
35960>>>>>>>        //DDB-Generated-Code-Location
35960>>>>>>>        //DDB-DefineFieldStart
35960>>>>>>>
35960>>>>>>>        Set Main_File            To Wapokat.File_Number
35961>>>>>>>        Set Cascade_Delete_State To FALSE
35962>>>>>>>
35962>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
35963>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
35964>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
35965>>>>>>>
35965>>>>>>>        // Child (Client) file structure................
35965>>>>>>>        Send Add_Client_File  Wapomast.File_Number
35966>>>>>>>
35966>>>>>>>        // External (System) file structure.............
35966>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
35967>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
35968>>>>>>>
35968>>>>>>>        Define_Auto_Increment  Sysrecw.Wapokat_Rec0  To Wapokat.Wapokat_Rec0
35971>>>>>>>
35971>>>>>>>        // Field-based properties.......................
35971>>>>>>>
35971>>>>>>>        // Wapokat.Wapokat_Code
35971>>>>>>>        Set Field_Options          Field Wapokat.Wapokat_Code To DD_AUTOFIND   
35972>>>>>>>        Set Field_Prompt_Object    Field Wapokat.Wapokat_Code To (sl022(Self))
35973>>>>>>>
35973>>>>>>>        // Wapokat.Wapokat_Rec0
35973>>>>>>>        Set Field_Options          Field Wapokat.Wapokat_Rec0 To DD_AUTOFIND   
35974>>>>>>>
35974>>>>>>>        // Wapokat.Wapokat_Descr
35974>>>>>>>        Set Field_Prompt_Object    Field Wapokat.Wapokat_Descr To (sl022(Self))
35975>>>>>>>
35975>>>>>>>        // Wapokat.Wapokat_Recr
35975>>>>>>>        Set Field_Options          Field Wapokat.Wapokat_Recr To DD_AUTOFIND   
35976>>>>>>>
35976>>>>>>>        // Wapokat.Enhm_Sap
35976>>>>>>>
35976>>>>>>>        // Wapokat.Sap_Descr
35976>>>>>>>
35976>>>>>>>        // Wapokat.Gl
35976>>>>>>>
35976>>>>>>>        // Wapokat.Glzz
35976>>>>>>>
35976>>>>>>>        // Wapokat.Oximm1
35976>>>>>>>
35976>>>>>>>        //DDB-DefineFieldEnd
35976>>>>>>>    End_Procedure    // Define_Fields
35977>>>>>>>
35977>>>>>>>    // Field_Defaults:
35977>>>>>>>    // This procedure is used to establish default field values.
35977>>>>>>>
35977>>>>>>>    Procedure Field_Defaults
35978>>>>>>>        Forward Send Field_Defaults
35980>>>>>>>        //DDB-Generated-Code-Location
35980>>>>>>>        //DDB-FieldDefaultStart
35980>>>>>>>        //DDB-FieldDefaultEnd
35980>>>>>>>    End_Procedure    // Field_Defaults
35981>>>>>>>
35981>>>>>>>End_Class    // Wapokat_DataDictionary
35982>>>>>>>//DDB-Selection-pkg-Start
35982>>>>>>>
35982>>>>>>>Use sl022.SL         // sl022
INCLUDING FILE: SL022.SL
35982>>>>>>>>>//AB/ Project sl022:kathg-apothkon
35982>>>>>>>>>//AB/ Object prj is a Lookup_Project
35982>>>>>>>>>//AB/     Set ProjectName to "sl022:kathg-apothkon"
35982>>>>>>>>>//AB/     Set ProjectFileName to "sl022.SL"
35982>>>>>>>>>
35982>>>>>>>>>// Project Object Structure
35982>>>>>>>>>//   sl022 is a dbModalPanelSub
35982>>>>>>>>>//     Wapokat_DD is a DataDictionary
35982>>>>>>>>>//     oSelList is a dbListSub
35982>>>>>>>>>//     oOK_bn is a ButtonSub
35982>>>>>>>>>//     oCancel_bn is a ButtonSub
35982>>>>>>>>>//     oSearch_bn is a ButtonSub
35982>>>>>>>>>
35982>>>>>>>>>// Register all objects
35982>>>>>>>>>Register_Object oCancel_bn
35982>>>>>>>>>Register_Object oOK_bn
35982>>>>>>>>>Register_Object oSearch_bn
35982>>>>>>>>>Register_Object oSelList
35982>>>>>>>>>Register_Object sl022
35982>>>>>>>>>Register_Object Wapokat_DD
35982>>>>>>>>>
35982>>>>>>>>>
35982>>>>>>>>>//AB-IgnoreStart
35982>>>>>>>>>
35982>>>>>>>>>Use DFAllEnt.pkg
35982>>>>>>>>>Use dbList.Sub
35982>>>>>>>>>Use Button.Sub
35982>>>>>>>>>
35982>>>>>>>>>
35982>>>>>>>>>Use WAPOKAT.DD
35982>>>>>>>>>
35982>>>>>>>>>//AB-IgnoreEnd
35982>>>>>>>>>
35982>>>>>>>>>CD_Popup_Object sl022 is a dbModalPanelSub
36001>>>>>>>>>    set label to "‰˜«žš¦¨åœª €§¦Ÿž¡é¤" 
36002>>>>>>>>>    Set Size to 148 297
36003>>>>>>>>>    Set Location to 12 19
36004>>>>>>>>>    Set Exit_Application_Local_State to FALSE
36005>>>>>>>>>    Set Modal_State to FALSE
36006>>>>>>>>>
36006>>>>>>>>>    //AB-DDOStart
36006>>>>>>>>>
36006>>>>>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
36008>>>>>>>>>    End_Object    // Wapokat_DD
36009>>>>>>>>>
36009>>>>>>>>>    Set Main_DD to (Wapokat_DD(self))
36010>>>>>>>>>    Set Server to (Wapokat_DD(self))
36011>>>>>>>>>
36011>>>>>>>>>    //AB-DDOEnd
36011>>>>>>>>>
36011>>>>>>>>>    Object oSelList is a dbListSub
36013>>>>>>>>>        Set Main_File to Wapokat.File_Number
36014>>>>>>>>>        Set Size to 105 280
36015>>>>>>>>>        Set Location to 6 6
36016>>>>>>>>>
36016>>>>>>>>>        Begin_Row
36019>>>>>>>>>            Entry_Item Wapokat.Wapokat_code
36020>>>>>>>>>            Entry_Item Wapokat.Wapokat_descr
36021>>>>>>>>>        End_Row
36026>>>>>>>>>
36026>>>>>>>>>        Set Form_Width    item 0 to 42
36027>>>>>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
36028>>>>>>>>>        
36028>>>>>>>>>        Set Form_Width    item 1 to 228
36029>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
36030>>>>>>>>>        
36030>>>>>>>>>    End_Object    // oSelList
36031>>>>>>>>>
36031>>>>>>>>>    Object oOK_bn is a ButtonSub
36033>>>>>>>>>        set label to "&„§ ¢¦šã" 
36034>>>>>>>>>        Set Location to 115 126
36035>>>>>>>>>
36035>>>>>>>>>        //AB-StoreStart
36035>>>>>>>>>        Procedure OnClick
36037>>>>>>>>>            Send OK To (oSelList(current_object))
36038>>>>>>>>>        End_Procedure
36039>>>>>>>>>        //AB-StoreEnd
36039>>>>>>>>>
36039>>>>>>>>>    End_Object    // oOK_bn
36040>>>>>>>>>
36040>>>>>>>>>    Object oCancel_bn is a ButtonSub
36042>>>>>>>>>        set label to "&€¡ç¨à©ž" 
36043>>>>>>>>>        Set Location to 115 181
36044>>>>>>>>>
36044>>>>>>>>>        //AB-StoreStart
36044>>>>>>>>>        Procedure OnClick
36046>>>>>>>>>            Send Cancel To (oSelList(current_object))
36047>>>>>>>>>        End_Procedure
36048>>>>>>>>>        //AB-StoreEnd
36048>>>>>>>>>
36048>>>>>>>>>    End_Object    // oCancel_bn
36049>>>>>>>>>
36049>>>>>>>>>    Object oSearch_bn is a ButtonSub
36051>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
36052>>>>>>>>>        Set Location to 115 236
36053>>>>>>>>>
36053>>>>>>>>>        //AB-StoreStart
36053>>>>>>>>>        Procedure OnClick
36055>>>>>>>>>            Send Search To (oSelList(current_object))
36056>>>>>>>>>        End_Procedure
36057>>>>>>>>>        //AB-StoreEnd
36057>>>>>>>>>
36057>>>>>>>>>    End_Object    // oSearch_bn
36058>>>>>>>>>
36058>>>>>>>>>
36058>>>>>>>>>    //AB-StoreStart
36058>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
36059>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
36060>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
36061>>>>>>>>>    //AB-StoreEnd
36061>>>>>>>>>
36061>>>>>>>>>CD_End_Object    // sl022
36063>>>>>>>>>>
36063>>>>>>>>>
36063>>>>>>>>>//AB/ End_Object    // prj
36063>>>>>>>
36063>>>>>>>//DDB-Selection-pkg-End
36063>>>>>>>//DDB-FileEnd
36063>>>>>Use WAPOMAST.DD
INCLUDING FILE: WAPOMAST.DD
36063>>>>>>>//DDB-FileStart
36063>>>>>>>//DDB-HeaderStart
36063>>>>>>>
36063>>>>>>>// File Name : WAPOMAST.DD
36063>>>>>>>// Class Name: Wapomast_DataDictionary
36063>>>>>>>// Revision  : 13
36063>>>>>>>// Version   : 2
36063>>>>>>>
36063>>>>>>>Use  Windows           // Basic Definitions
36063>>>>>>>Use  DataDict          // DataDictionary Class Definition
36063>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
36063>>>>>>>
36063>>>>>>>Open Wapomast
36065>>>>>>>Open Wax
36067>>>>>>>Open Wapokat
36069>>>>>>>Open Sysrecw
36071>>>>>>>
36071>>>>>>>//DDB-HeaderEnd
36071>>>>>>>//DDB-SelectionStart
36071>>>>>>>//DDB/ ExternalSelectionList sl023  sl023.SL
36071>>>>>>>Register_Object sl023
36071>>>>>>>//DDB-SelectionEnd
36071>>>>>>>
36071>>>>>>>Class Wapomast_DataDictionary  is a DataDictionary
36072>>>>>>>    // Update:
36072>>>>>>>    Procedure Update
36073>>>>>>>        Forward Send Update
36075>>>>>>>        // Insert Code Here
36075>>>>>>>//        Move SysCurXR.Company_Code   to Wapomast.Company_Code
36075>>>>>>>//        Move SysCurXR.Branch_Code     to Wapomast.Branch_Code
36075>>>>>>>//        Move SysCurXR.Year_Year         to Wapomast.Year_Year
36075>>>>>>>        Move Wapokat.Wapokat_Code   to Wapomast.Wapokat_Code
36076>>>>>>>    End_Procedure   // Update
36077>>>>>>> 
36077>>>>>>>     Procedure Creating
36078>>>>>>>        Forward Send Creating
36080>>>>>>>        // Insert Code Here
36080>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wapomast.Wapomast_Rec0)))))) to Wapomast.Wapomast_Recr
36081>>>>>>>    End_Procedure   // Creating
36082>>>>>>>
36082>>>>>>>
36082>>>>>>>    // Define_Fields:
36082>>>>>>>    // This procedure is used to set up all data-dictionary rules.
36082>>>>>>>
36082>>>>>>>    Procedure Define_Fields
36083>>>>>>>        Forward Send Define_Fields
36085>>>>>>>        //DDB-Generated-Code-Location
36085>>>>>>>        //DDB-DefineFieldStart
36085>>>>>>>
36085>>>>>>>        Set Main_File            To Wapomast.File_Number
36086>>>>>>>        Set Cascade_Delete_State To FALSE
36087>>>>>>>
36087>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
36088>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
36089>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
36090>>>>>>>
36090>>>>>>>        // Child (Client) file structure................
36090>>>>>>>        Send Add_Client_File  Wax.File_Number
36091>>>>>>>
36091>>>>>>>        // Parent (Server) file structure...............
36091>>>>>>>        Send Add_Server_File  Wapokat.File_Number
36092>>>>>>>
36092>>>>>>>        // External (System) file structure.............
36092>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
36093>>>>>>>
36093>>>>>>>        Define_Auto_Increment  Sysrecw.Wapomast_Rec0  To Wapomast.Wapomast_Rec0
36096>>>>>>>
36096>>>>>>>        // Field-based properties.......................
36096>>>>>>>
36096>>>>>>>        // Wapomast.Wapokat_Code
36096>>>>>>>
36096>>>>>>>        // Wapomast.Wapokat_Recr
36096>>>>>>>
36096>>>>>>>        // Wapomast.Wapomast_Code
36096>>>>>>>        Set Field_Options          Field Wapomast.Wapomast_Code To DD_AUTOFIND   
36097>>>>>>>        Set Field_Prompt_Object    Field Wapomast.Wapomast_Code To (sl023(Self))
36098>>>>>>>
36098>>>>>>>        // Wapomast.Wapomast_Rec0
36098>>>>>>>        Set Field_Options          Field Wapomast.Wapomast_Rec0 To DD_AUTOFIND   
36099>>>>>>>
36099>>>>>>>        // Wapomast.Wapomast_Descr
36099>>>>>>>        Set Field_Prompt_Object    Field Wapomast.Wapomast_Descr To (sl023(Self))
36100>>>>>>>
36100>>>>>>>        // Wapomast.Wapomast_Recr
36100>>>>>>>        Set Field_Options          Field Wapomast.Wapomast_Recr To DD_AUTOFIND   
36101>>>>>>>
36101>>>>>>>        //DDB-DefineFieldEnd
36101>>>>>>>    End_Procedure    // Define_Fields
36102>>>>>>>
36102>>>>>>>    // Field_Defaults:
36102>>>>>>>    // This procedure is used to establish default field values.
36102>>>>>>>
36102>>>>>>>    Procedure Field_Defaults
36103>>>>>>>        Forward Send Field_Defaults
36105>>>>>>>        //DDB-Generated-Code-Location
36105>>>>>>>        //DDB-FieldDefaultStart
36105>>>>>>>        //DDB-FieldDefaultEnd
36105>>>>>>>    End_Procedure    // Field_Defaults
36106>>>>>>>
36106>>>>>>>End_Class    // Wapomast_DataDictionary
36107>>>>>>>//DDB-Selection-pkg-Start
36107>>>>>>>
36107>>>>>>>Use sl023.SL         // sl023
INCLUDING FILE: SL023.SL
36107>>>>>>>>>//AB/ Project sl023:apothkes
36107>>>>>>>>>//AB/ Object prj is a Lookup_Project
36107>>>>>>>>>//AB/     Set ProjectName to "sl023:apothkes"
36107>>>>>>>>>//AB/     Set ProjectFileName to "sl023.SL"
36107>>>>>>>>>
36107>>>>>>>>>// Project Object Structure
36107>>>>>>>>>//   sl023 is a dbModalPanelSub
36107>>>>>>>>>//     Wapokat_DD is a DataDictionary
36107>>>>>>>>>//     Wapomast_DD is a DataDictionary
36107>>>>>>>>>//     oSelList is a dbListSub
36107>>>>>>>>>//     oOK_bn is a ButtonSub
36107>>>>>>>>>//     oCancel_bn is a ButtonSub
36107>>>>>>>>>//     oSearch_bn is a ButtonSub
36107>>>>>>>>>
36107>>>>>>>>>// Register all objects
36107>>>>>>>>>Register_Object oCancel_bn
36107>>>>>>>>>Register_Object oOK_bn
36107>>>>>>>>>Register_Object oSearch_bn
36107>>>>>>>>>Register_Object oSelList
36107>>>>>>>>>Register_Object sl023
36107>>>>>>>>>Register_Object Wapokat_DD
36107>>>>>>>>>Register_Object Wapomast_DD
36107>>>>>>>>>
36107>>>>>>>>>
36107>>>>>>>>>//AB-IgnoreStart
36107>>>>>>>>>
36107>>>>>>>>>Use DFAllEnt.pkg
36107>>>>>>>>>Use dbList.Sub
36107>>>>>>>>>Use Button.Sub
36107>>>>>>>>>
36107>>>>>>>>>
36107>>>>>>>>>Use WAPOKAT.DD
36107>>>>>>>>>Use WAPOMAST.DD
36107>>>>>>>>>
36107>>>>>>>>>//AB-IgnoreEnd
36107>>>>>>>>>
36107>>>>>>>>>Object sl023 is a dbModalPanelSub
36109>>>>>>>>>
36109>>>>>>>>>    //AB-StoreTopStart
36109>>>>>>>>>    property string psapokat public ''
36111>>>>>>>>>    //AB-StoreTopEnd
36111>>>>>>>>>
36111>>>>>>>>>    Set Label to "€§¦Ÿã¡œª"
36112>>>>>>>>>    Set Size to 126 260
36113>>>>>>>>>    Set Location to 4 19
36114>>>>>>>>>    Set Exit_Application_Local_State to FALSE
36115>>>>>>>>>    Set Modal_State to FALSE
36116>>>>>>>>>
36116>>>>>>>>>    //AB-DDOStart
36116>>>>>>>>>
36116>>>>>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
36118>>>>>>>>>    End_Object    // Wapokat_DD
36119>>>>>>>>>
36119>>>>>>>>>    Object Wapomast_DD is a Wapomast_DataDictionary
36121>>>>>>>>>        Set DDO_Server to (Wapokat_DD(self))
36122>>>>>>>>>
36122>>>>>>>>>        //AB-StoreStart
36122>>>>>>>>>        
36122>>>>>>>>>        begin_constraints
36124>>>>>>>>>          if (psapokat(self) <> '') constrain wapomast.wapokat_code eq (psapokat(self))
36128>>>>>>>>>        
36128>>>>>>>>>        end_constraints
36131>>>>>>>>>        
36131>>>>>>>>>        //AB-StoreEnd
36131>>>>>>>>>
36131>>>>>>>>>    End_Object    // Wapomast_DD
36132>>>>>>>>>
36132>>>>>>>>>    Set Main_DD to (Wapomast_DD(self))
36133>>>>>>>>>    Set Server to (Wapomast_DD(self))
36134>>>>>>>>>
36134>>>>>>>>>    //AB-DDOEnd
36134>>>>>>>>>
36134>>>>>>>>>    Object oSelList is a dbListSub
36136>>>>>>>>>        Set Main_File to Wapomast.File_Number
36137>>>>>>>>>        Set Server to (Wapokat_DD(self))
36138>>>>>>>>>        Set Size to 89 240
36139>>>>>>>>>        Set Location to 6 6
36140>>>>>>>>>
36140>>>>>>>>>        Begin_Row
36143>>>>>>>>>            Entry_Item Wapomast.Wapomast_code
36144>>>>>>>>>            Entry_Item Wapomast.Wapomast_descr
36145>>>>>>>>>        End_Row
36150>>>>>>>>>
36150>>>>>>>>>        Set Form_Width    item 0 to 70
36151>>>>>>>>>        Set Header_Label  item 0 to "€§¦Ÿã¡ž      :"
36152>>>>>>>>>        
36152>>>>>>>>>        Set Form_Width    item 1 to 160
36153>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
36154>>>>>>>>>        
36154>>>>>>>>>
36154>>>>>>>>>        //AB-StoreStart
36154>>>>>>>>>                    
36154>>>>>>>>>                    
36154>>>>>>>>>        //AB-StoreEnd
36154>>>>>>>>>
36154>>>>>>>>>    End_Object    // oSelList
36155>>>>>>>>>
36155>>>>>>>>>    Object oOK_bn is a ButtonSub
36157>>>>>>>>>        Set Label to "&„§ ¢¦šã"
36158>>>>>>>>>        Set Location to 92 81
36159>>>>>>>>>
36159>>>>>>>>>        //AB-StoreStart
36159>>>>>>>>>        Procedure OnClick
36161>>>>>>>>>            Send OK To (oSelList(current_object))
36162>>>>>>>>>        End_Procedure
36163>>>>>>>>>        //AB-StoreEnd
36163>>>>>>>>>
36163>>>>>>>>>    End_Object    // oOK_bn
36164>>>>>>>>>
36164>>>>>>>>>    Object oCancel_bn is a ButtonSub
36166>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
36167>>>>>>>>>        Set Location to 92 135
36168>>>>>>>>>
36168>>>>>>>>>        //AB-StoreStart
36168>>>>>>>>>        Procedure OnClick
36170>>>>>>>>>            Send Cancel To (oSelList(current_object))
36171>>>>>>>>>        End_Procedure
36172>>>>>>>>>        //AB-StoreEnd
36172>>>>>>>>>
36172>>>>>>>>>    End_Object    // oCancel_bn
36173>>>>>>>>>
36173>>>>>>>>>    Object oSearch_bn is a ButtonSub
36175>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
36176>>>>>>>>>        Set Location to 92 191
36177>>>>>>>>>
36177>>>>>>>>>        //AB-StoreStart
36177>>>>>>>>>        Procedure OnClick
36179>>>>>>>>>            Send Search To (oSelList(current_object))
36180>>>>>>>>>        End_Procedure
36181>>>>>>>>>        //AB-StoreEnd
36181>>>>>>>>>
36181>>>>>>>>>    End_Object    // oSearch_bn
36182>>>>>>>>>
36182>>>>>>>>>
36182>>>>>>>>>    //AB-StoreStart
36182>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
36183>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
36184>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
36185>>>>>>>>>    
36185>>>>>>>>>    procedure activate
36187>>>>>>>>>        send rebuild_constraints to wapomast_dd
36188>>>>>>>>>        send beginning_of_data to osellist true
36189>>>>>>>>>        forward send activate
36191>>>>>>>>>    end_procedure
36192>>>>>>>>>    
36192>>>>>>>>>    
36192>>>>>>>>>    //AB-StoreEnd
36192>>>>>>>>>
36192>>>>>>>>>End_Object    // sl023
36193>>>>>>>>>
36193>>>>>>>>>//AB/ End_Object    // prj
36193>>>>>>>
36193>>>>>>>//DDB-Selection-pkg-End
36193>>>>>>>//DDB-FileEnd
36193>>>>>Use WAX.DD
INCLUDING FILE: WAX.DD
36193>>>>>>>//DDB-FileStart
36193>>>>>>>//DDB-HeaderStart
36193>>>>>>>
36193>>>>>>>// File Name : WAX.DD
36193>>>>>>>// Class Name: Wax_DataDictionary
36193>>>>>>>// Revision  : 39
36193>>>>>>>// Version   : 2
36193>>>>>>>
36193>>>>>>>Use  Windows           // Basic Definitions
36193>>>>>>>Use  DataDict          // DataDictionary Class Definition
36193>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
36193>>>>>>>
36193>>>>>>>Open Wax
36195>>>>>>>Open Pmoves
INCLUDING FILE: PMOVES.FD
36197>>>>>>>Open Wcmoves
INCLUDING FILE: WCMOVES.FD
36199>>>>>>>Open Wam
INCLUDING FILE: WAM.FD
36201>>>>>>>Open Pmovesl
INCLUDING FILE: PMOVESL.FD
36203>>>>>>>Open Wapomast
36205>>>>>>>Open Sysrecw
36207>>>>>>>Open Syscurxr
36209>>>>>>>
36209>>>>>>>//DDB-HeaderEnd
36209>>>>>>>//DDB-SelectionStart
36209>>>>>>>//DDB/ ExternalSelectionList Wax  Wax.SL
36209>>>>>>>Register_Object Wax
36209>>>>>>>//DDB-SelectionEnd
36209>>>>>>>
36209>>>>>>>Open Units
INCLUDING FILE: UNITS.FD
36211>>>>>>>Open Wapokat
36213>>>>>>>Open WitemKat
INCLUDING FILE: WITEMKAT.FD
36215>>>>>>>
36215>>>>>>>Class Wax_DataDictionary  is a DataDictionary_Sec
36216>>>>>>>
36216>>>>>>>    Procedure Construct_Object
36217>>>>>>>        Forward Send Construct_Object
36219>>>>>>>        Property Integer piMustNOTConstrain Public 0
36220>>>>>>>    End_Procedure //construct_object
36221>>>>>>>
36221>>>>>>>    Procedure OnConstrain
36222>>>>>>>        Forward Send OnConstrain
36224>>>>>>>        If (piMustNOTConstrain(Self)) Begin
36226>>>>>>>        End
36226>>>>>>>>
36226>>>>>>>        Else Begin
36227>>>>>>>            Constrain Wax.Company_Code  eq SysCurXR.Company_Code
36229>>>>>>>            Constrain Wax.Branch_Code   eq SysCurXR.Branch_Code
36231>>>>>>>            Constrain Wax.Year_Year     eq SysCurXR.Year_Year
36233>>>>>>>        End
36233>>>>>>>>
36233>>>>>>>    End_Procedure
36234>>>>>>>
36234>>>>>>>
36234>>>>>>>    // Update:
36234>>>>>>>    Procedure Update
36235>>>>>>>        Forward Send Update
36237>>>>>>>        // Insert Code Here
36237>>>>>>>        Move SysCurXR.Company_Code  to Wax.Company_Code
36238>>>>>>>        Move SysCurXR.Branch_Code   to Wax.Branch_Code
36239>>>>>>>        Move SysCurXR.Year_Year     to Wax.Year_Year
36240>>>>>>>        Move SysCurXR.Year_Recr     to Wax.Year_Recr
36241>>>>>>>        Move Wapokat.Wapokat_Code   to Wax.Wapokat_Code
36242>>>>>>>        Move Wapomast.Wapomast_Code to Wax.Wapomast_Code
36243>>>>>>>    End_Procedure   // Update
36244>>>>>>>
36244>>>>>>>     Procedure Creating
36245>>>>>>>        Forward Send Creating
36247>>>>>>>        // Insert Code Here
36247>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wax.Wax_Rec0)))))) to Wax.Wax_Recr
36248>>>>>>>    End_Procedure   // Creating
36249>>>>>>>
36249>>>>>>>
36249>>>>>>>
36249>>>>>>>    // Define_Fields:
36249>>>>>>>    // This procedure is used to set up all data-dictionary rules.
36249>>>>>>>
36249>>>>>>>    Procedure Define_Fields
36250>>>>>>>        Forward Send Define_Fields
36252>>>>>>>        //DDB-Generated-Code-Location
36252>>>>>>>        //DDB-DefineFieldStart
36252>>>>>>>
36252>>>>>>>        Set Main_File            To Wax.File_Number
36253>>>>>>>        Set Cascade_Delete_State To FALSE
36254>>>>>>>
36254>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
36255>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
36256>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
36257>>>>>>>
36257>>>>>>>        // Child (Client) file structure................
36257>>>>>>>        Send Add_Client_File  Pmoves.File_Number
36258>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
36259>>>>>>>        Send Add_Client_File  Wam.File_Number
36260>>>>>>>        Send Add_Client_File  Pmovesl.File_Number
36261>>>>>>>
36261>>>>>>>        // Parent (Server) file structure...............
36261>>>>>>>        Send Add_Server_File  Wapomast.File_Number
36262>>>>>>>
36262>>>>>>>        // External (System) file structure.............
36262>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
36263>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
36264>>>>>>>
36264>>>>>>>        Define_Auto_Increment  Sysrecw.Wax_Rec0  To Wax.Wax_Rec0
36267>>>>>>>
36267>>>>>>>        // Field-based properties.......................
36267>>>>>>>
36267>>>>>>>        // Wax.Company_Code
36267>>>>>>>
36267>>>>>>>        // Wax.Branch_Code
36267>>>>>>>
36267>>>>>>>        // Wax.Year_Year
36267>>>>>>>
36267>>>>>>>        // Wax.Wapokat_Code
36267>>>>>>>
36267>>>>>>>        // Wax.Wapomast_Code
36267>>>>>>>
36267>>>>>>>        // Wax.Wax_Code
36267>>>>>>>        Set Field_Options          Field Wax.Wax_Code To DD_AUTOFIND   
36268>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Code To (Wax(Self))
36269>>>>>>>
36269>>>>>>>        // Wax.Year_Recr
36269>>>>>>>
36269>>>>>>>        // Wax.Wapomast_Recr
36269>>>>>>>
36269>>>>>>>        // Wax.Wax_Rec0
36269>>>>>>>        Set Field_Options          Field Wax.Wax_Rec0 To DD_AUTOFIND   
36270>>>>>>>
36270>>>>>>>        // Wax.Wax_Recr
36270>>>>>>>        Set Field_Options          Field Wax.Wax_Recr To DD_AUTOFIND   
36271>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Recr To (Wax(Self))
36272>>>>>>>
36272>>>>>>>        // Wax.Wax_Descr
36272>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Descr To (Wax(Self))
36273>>>>>>>
36273>>>>>>>        //DDB-DefineFieldEnd
36273>>>>>>>    End_Procedure    // Define_Fields
36274>>>>>>>
36274>>>>>>>    // Field_Defaults:
36274>>>>>>>    // This procedure is used to establish default field values.
36274>>>>>>>
36274>>>>>>>    Procedure Field_Defaults
36275>>>>>>>        Forward Send Field_Defaults
36277>>>>>>>        //DDB-Generated-Code-Location
36277>>>>>>>        //DDB-FieldDefaultStart
36277>>>>>>>        //DDB-FieldDefaultEnd
36277>>>>>>>    End_Procedure    // Field_Defaults
36278>>>>>>>
36278>>>>>>>End_Class    // Wax_DataDictionary
36279>>>>>>>//DDB-Selection-pkg-Start
36279>>>>>>>
36279>>>>>>>Use Wax.SL           // Wax
36279>>>>>>>
36279>>>>>>>//DDB-Selection-pkg-End
36279>>>>>>>//DDB-FileEnd
36279>>>>>
36279>>>>>//AB-IgnoreEnd
36279>>>>>
36279>>>>>Object Wax is a dbModalPanelSub
36281>>>>>
36281>>>>>    //AB-StoreTopStart
36281>>>>>                                    
36281>>>>>    Property Integer    piMustConstrain Public  0
36283>>>>>    Property Integer    piYear          Public  0
36285>>>>>    Property String     psCompany       Public ''
36287>>>>>    Property String     psBranch        Public ''
36289>>>>>    Property String     psWapokat       Public ''
36291>>>>>    
36291>>>>>    //AB-StoreTopEnd
36291>>>>>
36291>>>>>    Set Label to "‰˜«á¢¦š¦ª €§¦Ÿž¡é¤"
36292>>>>>    Set Size to 148 355
36293>>>>>    Set Location to 8 21
36294>>>>>    Set Exit_Application_Local_State to FALSE
36295>>>>>    Set Modal_State to FALSE
36296>>>>>
36296>>>>>    //AB-DDOStart
36296>>>>>
36296>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
36298>>>>>    End_Object    // Wapokat_DD
36299>>>>>
36299>>>>>    Object Wapomast_DD is a Wapomast_DataDictionary
36301>>>>>        Set DDO_Server to (Wapokat_DD(self))
36302>>>>>    End_Object    // Wapomast_DD
36303>>>>>
36303>>>>>    Object Wax_DD is a Wax_DataDictionary
36305>>>>>        Set DDO_Server to (Wapomast_DD(self))
36306>>>>>
36306>>>>>        //AB-StoreStart
36306>>>>>        
36306>>>>>        Begin_Constraints
36308>>>>>            Integer iMustConstrain iYear
36309>>>>>            String  sCompany sBranch sWapokat
36309>>>>>            Get piMustConstrain to iMustConstrain
36310>>>>>            If (iMustConstrain) Begin
36312>>>>>                Get piYear     to  iYear
36313>>>>>                Get psCompany  to  sCompany
36314>>>>>                Get psBranch   to  sBranch
36315>>>>>                Get psWapokat  to  sWapokat
36316>>>>>                If (sCompany<>'') Begin
36318>>>>>                    Constrain Wax.Company_Code eq sCompany
36320>>>>>                    If (sBranch<>'') Begin
36322>>>>>                        Constrain Wax.Branch_Code eq sBranch
36324>>>>>                        If (iYear<>0) Begin
36326>>>>>                            Constrain Wax.Year_Year eq iYear
36328>>>>>                            If (sWapokat<>'') Begin
36330>>>>>                                Constrain Wax.Wapokat_Code eq sWapokat
36332>>>>>                            End
36332>>>>>>
36332>>>>>                        End
36332>>>>>>
36332>>>>>                    End
36332>>>>>>
36332>>>>>                End
36332>>>>>>
36332>>>>>            End
36332>>>>>>
36332>>>>>        End_Constraints
36335>>>>>        
36335>>>>>        
36335>>>>>        
36335>>>>>        
36335>>>>>        
36335>>>>>        
36335>>>>>        //AB-StoreEnd
36335>>>>>
36335>>>>>    End_Object    // Wax_DD
36336>>>>>
36336>>>>>    Set Main_DD to (Wax_DD(self))
36337>>>>>    Set Server to (Wax_DD(self))
36338>>>>>
36338>>>>>    //AB-DDOEnd
36338>>>>>
36338>>>>>    Object oSelList is a dbListSub
36340>>>>>        Set Main_File to Wax.File_Number
36341>>>>>        Set Size to 105 340
36342>>>>>        Set Location to 5 6
36343>>>>>
36343>>>>>        Begin_Row
36346>>>>>            Entry_Item Wax.Wax_recr
36347>>>>>            Entry_Item Wax.Wax_code
36348>>>>>            Entry_Item Wax.Wax_descr
36349>>>>>        End_Row
36354>>>>>
36354>>>>>        Set Form_Width    item 0 to 33
36355>>>>>        Set Header_Label  item 0 to "Recr"
36356>>>>>        
36356>>>>>        Set Form_Width    item 1 to 80
36357>>>>>        Set Header_Label  item 1 to "‰à› ¡æª"
36358>>>>>        
36358>>>>>        Set Form_Width    item 2 to 219
36359>>>>>        Set Header_Label  item 2 to "œ¨ š¨˜­ã"
36360>>>>>        
36360>>>>>
36360>>>>>        //AB-StoreStart
36360>>>>>        
36360>>>>>        Procedure Activate
36362>>>>>            Send Rebuild_Constraints to Wax_DD
36363>>>>>            Send Beginning_Of_Data to oSelList True
36364>>>>>            Forward Send Activate
36366>>>>>        End_procedure
36367>>>>>        
36367>>>>>        //AB-StoreEnd
36367>>>>>
36367>>>>>    End_Object    // oSelList
36368>>>>>
36368>>>>>    Object oOK_bn is a ButtonSub
36370>>>>>        Set Label to "&„§ ¢¦šã"
36371>>>>>        Set Location to 113 186
36372>>>>>
36372>>>>>        //AB-StoreStart
36372>>>>>        Procedure OnClick
36374>>>>>            Send OK To (oSelList(current_object))
36375>>>>>        End_Procedure
36376>>>>>        //AB-StoreEnd
36376>>>>>
36376>>>>>    End_Object    // oOK_bn
36377>>>>>
36377>>>>>    Object oCancel_bn is a ButtonSub
36379>>>>>        Set Label to "&€¡ç¨à©ž"
36380>>>>>        Set Location to 113 241
36381>>>>>
36381>>>>>        //AB-StoreStart
36381>>>>>        Procedure OnClick
36383>>>>>            Send Cancel To (oSelList(current_object))
36384>>>>>        End_Procedure
36385>>>>>        //AB-StoreEnd
36385>>>>>
36385>>>>>    End_Object    // oCancel_bn
36386>>>>>
36386>>>>>    Object oSearch_bn is a ButtonSub
36388>>>>>        Set Label to "€&¤˜ã«ž©ž"
36389>>>>>        Set Location to 113 296
36390>>>>>
36390>>>>>        //AB-StoreStart
36390>>>>>        Procedure OnClick
36392>>>>>            Send Search To (oSelList(current_object))
36393>>>>>        End_Procedure
36394>>>>>        //AB-StoreEnd
36394>>>>>
36394>>>>>    End_Object    // oSearch_bn
36395>>>>>
36395>>>>>
36395>>>>>    //AB-StoreStart
36395>>>>>                                    
36395>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
36396>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
36397>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
36398>>>>>    
36398>>>>>    
36398>>>>>    
36398>>>>>    
36398>>>>>    
36398>>>>>    
36398>>>>>    //AB-StoreEnd
36398>>>>>
36398>>>>>End_Object    // Wax
36399>>>>>
36399>>>>>//AB/ End_Object    // prj
36399>>>Use sl001.sl
36399>>>Use sl002.sl
36399>>>Use sl003.sl
36399>>>Use sl006.sl
INCLUDING FILE: SL006.SL
36399>>>>>//AB/ Project sl006:Cmoves lookup
36399>>>>>//AB/ Object prj is a Lookup_Project
36399>>>>>//AB/     Set ProjectName to "sl006:Cmoves lookup"
36399>>>>>//AB/     Set ProjectFileName to "sl006.SL"
36399>>>>>//AB/     Set GenerateFileName to "NONAME"
36399>>>>>
36399>>>>>// Project Object Structure
36399>>>>>//   sl006 is a dbModalPanelSub
36399>>>>>//     Ctypkin_DD is a DataDictionary
36399>>>>>//     Clients_DD is a DataDictionary
36399>>>>>//     Cmoves_DD is a DataDictionary
36399>>>>>//     oSelList is a dbListSub
36399>>>>>//     oOK_bn is a ButtonSub
36399>>>>>//     oCancel_bn is a ButtonSub
36399>>>>>//     oSearch_bn is a ButtonSub
36399>>>>>//     Cmoves_Axia_Pros_Sysx is a dbFormSub
36399>>>>>//     Cmoves_Axia_Sysxet is a dbFormSub
36399>>>>>//     Cmoves_Axia_Ypol_Sysx is a dbFormSub
36399>>>>>//     TextBoxSub1 is a TextBoxSub
36399>>>>>//     TextBoxSub2 is a TextBoxSub
36399>>>>>//     TextBoxSub3 is a TextBoxSub
36399>>>>>//     RadioGroupSub2 is a RadioGroupSub
36399>>>>>//       Radio4 is a RadioSub
36399>>>>>//       Radio5 is a RadioSub
36399>>>>>//       Radio6 is a RadioSub
36399>>>>>
36399>>>>>// Register all objects
36399>>>>>Register_Object Clients_DD
36399>>>>>Register_Object Cmoves_Axia_Pros_Sysx
36399>>>>>Register_Object Cmoves_Axia_Sysxet
36399>>>>>Register_Object Cmoves_Axia_Ypol_Sysx
36399>>>>>Register_Object Cmoves_DD
36399>>>>>Register_Object Ctypkin_DD
36399>>>>>Register_Object oCancel_bn
36399>>>>>Register_Object oOK_bn
36399>>>>>Register_Object oSearch_bn
36399>>>>>Register_Object oSelList
36399>>>>>Register_Object Radio4
36399>>>>>Register_Object Radio5
36399>>>>>Register_Object Radio6
36399>>>>>Register_Object RadioGroupSub2
36399>>>>>Register_Object sl006
36399>>>>>Register_Object TextBoxSub1
36399>>>>>Register_Object TextBoxSub2
36399>>>>>Register_Object TextBoxSub3
36399>>>>>
36399>>>>>
36399>>>>>//AB-IgnoreStart
36399>>>>>
36399>>>>>Use DFAllEnt.pkg
36399>>>>>Use dbList.Sub
36399>>>>>Use Button.Sub
36399>>>>>Use dbForm.Sub
36399>>>>>Use Txtbox.Sub
36399>>>>>Use Rgroup.Sub
36399>>>>>Use Radio.Sub
36399>>>>>
36399>>>>>
36399>>>>>Use CTYPKIN.DD
INCLUDING FILE: CTYPKIN.DD
36399>>>>>>>//DDB-FileStart
36399>>>>>>>//DDB-HeaderStart
36399>>>>>>>
36399>>>>>>>// File Name : CTYPKIN.DD
36399>>>>>>>// Class Name: Ctypkin_DataDictionary
36399>>>>>>>// Revision  : 70
36399>>>>>>>// Version   : 2
36399>>>>>>>
36399>>>>>>>Use  Windows           // Basic Definitions
36399>>>>>>>Use  DataDict          // DataDictionary Class Definition
36399>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
36399>>>>>>>
36399>>>>>>>Open Ctypkin
INCLUDING FILE: CTYPKIN.FD
36401>>>>>>>Open Cmoves
INCLUDING FILE: CMOVES.FD
36403>>>>>>>Open Cflagkin
INCLUDING FILE: CFLAGKIN.FD
36405>>>>>>>Open Ptypparl
36407>>>>>>>Open Ptyppar
INCLUDING FILE: PTYPPAR.FD
36409>>>>>>>Open Hmctyp
INCLUDING FILE: HMCTYP.FD
36411>>>>>>>Open Cmovesa
INCLUDING FILE: CMOVESA.FD
36413>>>>>>>Open Sysrecc
INCLUDING FILE: SYSRECC.FD
36415>>>>>>>Open Syscurxr
36417>>>>>>>
36417>>>>>>>//DDB-HeaderEnd
36417>>>>>>>//DDB-ValidationStart
36417>>>>>>>
36417>>>>>>>Register_Object Ctypkin_Ctypkin_Module_VT
36417>>>>>>>
36417>>>>>>>Object Ctypkin_Ctypkin_Module_VT  is a CodeValidationTable
36419>>>>>>>    Set Type_Value        To "MODULE"
36420>>>>>>>    //DDB-ValidationCustomStart
36420>>>>>>>    //DDB-ValidationCustomEnd
36420>>>>>>>End_Object   // Ctypkin_Ctypkin_Module_VT
36421>>>>>>>//DDB-ValidationEnd
36421>>>>>>>//DDB-SelectionStart
36421>>>>>>>//DDB/ ExternalSelectionList sl007  sl007.SL
36421>>>>>>>Register_Object sl007
36421>>>>>>>//DDB-SelectionEnd
36421>>>>>>>
36421>>>>>>>Class Ctypkin_DataDictionary  is a DataDictionary
36422>>>>>>>         
36422>>>>>>>    Procedure Construct_Object
36423>>>>>>>        Forward Send Construct_Object
36425>>>>>>>        Property Integer piMustNOTConstrain Public 0
36426>>>>>>>    End_Procedure
36427>>>>>>>
36427>>>>>>>    Procedure Save_Main_File
36428>>>>>>>        If (Operation_Origin<>Self) Begin
36430>>>>>>>            If Ctypkin.Recnum Eq 0 Procedure_Return
36433>>>>>>>        End
36433>>>>>>>>
36433>>>>>>>        Forward Send Save_Main_File
36435>>>>>>>    End_Procedure
36436>>>>>>>
36436>>>>>>>     Procedure Creating
36437>>>>>>>        Forward Send Creating
36439>>>>>>>        // Insert Code Here
36439>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Ctypkin.Ctypkin_Rec0)))))) to Ctypkin.Ctypkin_Recr
36440>>>>>>>    End_Procedure   // Creating
36441>>>>>>>
36441>>>>>>>
36441>>>>>>>    // Define_Fields:
36441>>>>>>>    // This procedure is used to set up all data-dictionary rules.
36441>>>>>>>
36441>>>>>>>    Procedure Define_Fields
36442>>>>>>>        Forward Send Define_Fields
36444>>>>>>>        //DDB-Generated-Code-Location
36444>>>>>>>        //DDB-DefineFieldStart
36444>>>>>>>
36444>>>>>>>        Set Main_File            To Ctypkin.File_Number
36445>>>>>>>        Set Cascade_Delete_State To FALSE
36446>>>>>>>
36446>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
36447>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
36448>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
36449>>>>>>>
36449>>>>>>>        // Child (Client) file structure................
36449>>>>>>>        Send Add_Client_File  Cmoves.File_Number
36450>>>>>>>        Send Add_Client_File  Cflagkin.File_Number
36451>>>>>>>        Send Add_Client_File  Ptypparl.File_Number
36452>>>>>>>        Send Add_Client_File  Ptyppar.File_Number
36453>>>>>>>        Send Add_Client_File  Hmctyp.File_Number
36454>>>>>>>        Send Add_Client_File  Cmovesa.File_Number
36455>>>>>>>
36455>>>>>>>        // External (System) file structure.............
36455>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
36456>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
36457>>>>>>>
36457>>>>>>>        Define_Auto_Increment  Sysrecc.Ctypkin_Rec0  To Ctypkin.Ctypkin_Rec0
36460>>>>>>>
36460>>>>>>>        // Field-based properties.......................
36460>>>>>>>
36460>>>>>>>        // Ctypkin.Company_Code
36460>>>>>>>
36460>>>>>>>        // Ctypkin.Branch_Code
36460>>>>>>>
36460>>>>>>>        // Ctypkin.Year_Year
36460>>>>>>>
36460>>>>>>>        // Ctypkin.Ctypkin_Code
36460>>>>>>>        Set Field_Options          Field Ctypkin.Ctypkin_Code To DD_AUTOFIND   
36461>>>>>>>        Set Field_Prompt_Object    Field Ctypkin.Ctypkin_Code To (sl007(Self))
36462>>>>>>>        Set Key_Field_State        Field Ctypkin.Ctypkin_Code To TRUE
36463>>>>>>>
36463>>>>>>>        // Ctypkin.Ctypkin_Rec0
36463>>>>>>>
36463>>>>>>>        // Ctypkin.Ctypkin_Recr
36463>>>>>>>
36463>>>>>>>        // Ctypkin.Year_Recr
36463>>>>>>>
36463>>>>>>>        // Ctypkin.Ctypkin_Descr
36463>>>>>>>        Set Field_Prompt_Object    Field Ctypkin.Ctypkin_Descr To (sl007(Self))
36464>>>>>>>
36464>>>>>>>        // Ctypkin.Ctypkin_Anti
36464>>>>>>>
36464>>>>>>>        // Ctypkin.Ctypkin_Flags
36464>>>>>>>
36464>>>>>>>        // Ctypkin.Ctypkin_Module
36464>>>>>>>        Set Field_Value_Table      Field Ctypkin.Ctypkin_Module To (Ctypkin_Ctypkin_Module_VT(Self))
36465>>>>>>>
36465>>>>>>>        // Ctypkin.Open_Item
36465>>>>>>>
36465>>>>>>>        // Ctypkin.Check_Overhead
36465>>>>>>>
36465>>>>>>>        // Ctypkin.Max_Days_Sx_Par
36465>>>>>>>
36465>>>>>>>        // Ctypkin.Singular
36465>>>>>>>
36465>>>>>>>        // Ctypkin.Sub
36465>>>>>>>
36465>>>>>>>        // Ctypkin.Subreport
36465>>>>>>>
36465>>>>>>>        //DDB-DefineFieldEnd
36465>>>>>>>    End_Procedure    // Define_Fields
36466>>>>>>>
36466>>>>>>>    // Field_Defaults:
36466>>>>>>>    // This procedure is used to establish default field values.
36466>>>>>>>
36466>>>>>>>    Procedure Field_Defaults
36467>>>>>>>        Forward Send Field_Defaults
36469>>>>>>>        //DDB-Generated-Code-Location
36469>>>>>>>        //DDB-FieldDefaultStart
36469>>>>>>>        //DDB-FieldDefaultEnd
36469>>>>>>>    End_Procedure    // Field_Defaults
36470>>>>>>>
36470>>>>>>>End_Class    // Ctypkin_DataDictionary
36471>>>>>>>//DDB-Selection-pkg-Start
36471>>>>>>>
36471>>>>>>>Use sl007.SL         // sl007
INCLUDING FILE: SL007.SL
36471>>>>>>>>>//AB/ Project Ctypkin : sl007
36471>>>>>>>>>//AB/ Object prj is a Lookup_Project
36471>>>>>>>>>//AB/     Set ProjectName to "Ctypkin : sl007"
36471>>>>>>>>>//AB/     Set ProjectFileName to "sl007.SL"
36471>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
36471>>>>>>>>>
36471>>>>>>>>>// Project Object Structure
36471>>>>>>>>>//   sl007 is a dbModalPanelSub
36471>>>>>>>>>//     Ctypkin_DD is a DataDictionary
36471>>>>>>>>>//     oSelList is a dbListSub
36471>>>>>>>>>//     oOK_bn is a ButtonSub
36471>>>>>>>>>//     oCancel_bn is a ButtonSub
36471>>>>>>>>>//     oSearch_bn is a ButtonSub
36471>>>>>>>>>
36471>>>>>>>>>// Register all objects
36471>>>>>>>>>Register_Object Ctypkin_DD
36471>>>>>>>>>Register_Object oCancel_bn
36471>>>>>>>>>Register_Object oOK_bn
36471>>>>>>>>>Register_Object oSearch_bn
36471>>>>>>>>>Register_Object oSelList
36471>>>>>>>>>Register_Object sl007
36471>>>>>>>>>
36471>>>>>>>>>
36471>>>>>>>>>//AB-IgnoreStart
36471>>>>>>>>>
36471>>>>>>>>>Use DFAllEnt.pkg
36471>>>>>>>>>Use dbList.Sub
36471>>>>>>>>>Use Button.Sub
36471>>>>>>>>>
36471>>>>>>>>>
36471>>>>>>>>>Use CTYPKIN.DD
36471>>>>>>>>>
36471>>>>>>>>>//AB-IgnoreEnd
36471>>>>>>>>>
36471>>>>>>>>>Object sl007 is a dbModalPanelSub
36473>>>>>>>>>
36473>>>>>>>>>    //AB-StoreTopStart
36473>>>>>>>>>    Property String psModule Public ''
36475>>>>>>>>>    
36475>>>>>>>>>    //AB-StoreTopEnd
36475>>>>>>>>>
36475>>>>>>>>>    Set Label to "‰ ¤ã©œ ª    "
36476>>>>>>>>>    Set Size to 148 350
36477>>>>>>>>>    Set Location to 4 7
36478>>>>>>>>>    Set Exit_Application_Local_State to FALSE
36479>>>>>>>>>    Set Modal_State to FALSE
36480>>>>>>>>>
36480>>>>>>>>>    //AB-DDOStart
36480>>>>>>>>>
36480>>>>>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
36482>>>>>>>>>
36482>>>>>>>>>        //AB-StoreStart
36482>>>>>>>>>                                
36482>>>>>>>>>        Begin_Constraints
36484>>>>>>>>>            If (psModule(sl007(Self))<>'') Constrain Ctypkin.Ctypkin_Module eq (psModule(sl007(Self)))
36488>>>>>>>>>        End_Constraints
36491>>>>>>>>>        
36491>>>>>>>>>        
36491>>>>>>>>>        
36491>>>>>>>>>        
36491>>>>>>>>>        //AB-StoreEnd
36491>>>>>>>>>
36491>>>>>>>>>    End_Object    // Ctypkin_DD
36492>>>>>>>>>
36492>>>>>>>>>    Set Main_DD to (Ctypkin_DD(self))
36493>>>>>>>>>    Set Server to (Ctypkin_DD(self))
36494>>>>>>>>>
36494>>>>>>>>>    //AB-DDOEnd
36494>>>>>>>>>
36494>>>>>>>>>    Object oSelList is a dbListSub
36496>>>>>>>>>        Set Main_File to Ctypkin.File_Number
36497>>>>>>>>>        Set Size to 105 335
36498>>>>>>>>>        Set Location to 6 6
36499>>>>>>>>>
36499>>>>>>>>>        Begin_Row
36502>>>>>>>>>            Entry_Item Ctypkin.Ctypkin_code
36503>>>>>>>>>            Entry_Item Ctypkin.Ctypkin_descr
36504>>>>>>>>>        End_Row
36509>>>>>>>>>
36509>>>>>>>>>        Set Form_Width    item 0 to 71
36510>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª ‰ ¤ã©œàª"
36511>>>>>>>>>        
36511>>>>>>>>>        Set Form_Width    item 1 to 255
36512>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã ‰ ¤ã©œàª"
36513>>>>>>>>>        
36513>>>>>>>>>
36513>>>>>>>>>        //AB-StoreStart
36513>>>>>>>>>                    
36513>>>>>>>>>                    
36513>>>>>>>>>        Procedure Activate
36515>>>>>>>>>            Forward Send Activate
36517>>>>>>>>>            Send Beginning_Of_Data to oSelList True
36518>>>>>>>>>        End_Procedure
36519>>>>>>>>>        
36519>>>>>>>>>        
36519>>>>>>>>>        
36519>>>>>>>>>        
36519>>>>>>>>>        //AB-StoreEnd
36519>>>>>>>>>
36519>>>>>>>>>    End_Object    // oSelList
36520>>>>>>>>>
36520>>>>>>>>>    Object oOK_bn is a ButtonSub
36522>>>>>>>>>        Set Label to "&„§ ¢¦šã"
36523>>>>>>>>>        Set Location to 113 171
36524>>>>>>>>>
36524>>>>>>>>>        //AB-StoreStart
36524>>>>>>>>>        Procedure OnClick
36526>>>>>>>>>            Send OK To (oSelList(current_object))
36527>>>>>>>>>        End_Procedure
36528>>>>>>>>>        //AB-StoreEnd
36528>>>>>>>>>
36528>>>>>>>>>    End_Object    // oOK_bn
36529>>>>>>>>>
36529>>>>>>>>>    Object oCancel_bn is a ButtonSub
36531>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
36532>>>>>>>>>        Set Location to 113 226
36533>>>>>>>>>
36533>>>>>>>>>        //AB-StoreStart
36533>>>>>>>>>        Procedure OnClick
36535>>>>>>>>>            Send Cancel To (oSelList(current_object))
36536>>>>>>>>>        End_Procedure
36537>>>>>>>>>        //AB-StoreEnd
36537>>>>>>>>>
36537>>>>>>>>>    End_Object    // oCancel_bn
36538>>>>>>>>>
36538>>>>>>>>>    Object oSearch_bn is a ButtonSub
36540>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
36541>>>>>>>>>        Set Location to 113 281
36542>>>>>>>>>
36542>>>>>>>>>        //AB-StoreStart
36542>>>>>>>>>        Procedure OnClick
36544>>>>>>>>>            Send Search To (oSelList(current_object))
36545>>>>>>>>>        End_Procedure
36546>>>>>>>>>        //AB-StoreEnd
36546>>>>>>>>>
36546>>>>>>>>>    End_Object    // oSearch_bn
36547>>>>>>>>>
36547>>>>>>>>>
36547>>>>>>>>>    //AB-StoreStart
36547>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
36548>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
36549>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
36550>>>>>>>>>    
36550>>>>>>>>>    Procedure Activate Returns Integer
36552>>>>>>>>>        Integer rVal
36553>>>>>>>>>        Send Rebuild_Constraints to Ctypkin_DD
36554>>>>>>>>>        Forward Get Msg_Activate to rVal
36556>>>>>>>>>        Procedure_Return rVal
36557>>>>>>>>>    End_Procedure
36558>>>>>>>>>    
36558>>>>>>>>>    //AB-StoreEnd
36558>>>>>>>>>
36558>>>>>>>>>End_Object    // sl007
36559>>>>>>>>>
36559>>>>>>>>>//AB/ End_Object    // prj
36559>>>>>>>
36559>>>>>>>//DDB-Selection-pkg-End
36559>>>>>>>//DDB-FileEnd
36559>>>>>Use CLIENTS.DD
INCLUDING FILE: CLIENTS.DD
36559>>>>>>>//DDB-FileStart
36559>>>>>>>//DDB-HeaderStart
36559>>>>>>>
36559>>>>>>>// File Name : CLIENTS.DD
36559>>>>>>>// Class Name: Clients_DataDictionary
36559>>>>>>>// Revision  : 241
36559>>>>>>>// Version   : 2
36559>>>>>>>
36559>>>>>>>Use  Windows           // Basic Definitions
36559>>>>>>>Use  DataDict          // DataDictionary Class Definition
36559>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
36559>>>>>>>
36559>>>>>>>Open Clients
36561>>>>>>>Open Cmoves
36563>>>>>>>Open Particle
INCLUDING FILE: PARTICLE.FD
36565>>>>>>>Open Cmovesa
36567>>>>>>>Open Cn
36569>>>>>>>Open Particll
INCLUDING FILE: PARTICLL.FD
36571>>>>>>>Open Clnbank
INCLUDING FILE: CLNBANK.FD
36573>>>>>>>Open Tpclient
INCLUDING FILE: TPCLIENT.FD
36575>>>>>>>Open Clorder
INCLUDING FILE: CLORDER.FD
36577>>>>>>>Open Clitem
INCLUDING FILE: CLITEM.FD
36579>>>>>>>Open Cities
36581>>>>>>>Open Areas
36583>>>>>>>Open Payresp
36585>>>>>>>Open Syscurxr
36587>>>>>>>Open Sysrecc
36589>>>>>>>Open Ptypparl
36591>>>>>>>Open Gmove
INCLUDING FILE: GMOVE.FD
36593>>>>>>>Open Sysrecg
36595>>>>>>>
36595>>>>>>>//DDB-HeaderEnd
36595>>>>>>>//DDB-ValidationStart
36595>>>>>>>
36595>>>>>>>Register_Object Clients_Client_Doy_VT
36595>>>>>>>Register_Object Clients_Client_Job_VT
36595>>>>>>>Register_Object Clients_Client_Categfpa_VT
36595>>>>>>>Register_Object Clients_Client_Catjob_VT1
36595>>>>>>>Register_Object Clients_Client_Idiot_VT
36595>>>>>>>Register_Object Clients_Feregios_VT
36595>>>>>>>
36595>>>>>>>Object Clients_Client_Doy_VT  is a CodeValidationTable
36597>>>>>>>    Set Type_Value        To "DOY"
36598>>>>>>>    Set Validate_State    To FALSE
36599>>>>>>>    Set Allow_Blank_State To TRUE
36600>>>>>>>    Set Table_Title       To "ƒ.Ž.“"
36601>>>>>>>    //DDB-ValidationCustomStart
36601>>>>>>>    //DDB-ValidationCustomEnd
36601>>>>>>>End_Object   // Clients_Client_Doy_VT
36602>>>>>>>
36602>>>>>>>Object Clients_Client_Job_VT  is a CodeValidationTable
36604>>>>>>>    Set Type_Value        To "JOB"
36605>>>>>>>    Set Validate_State    To FALSE
36606>>>>>>>    Set Allow_Blank_State To TRUE
36607>>>>>>>    Set Table_Title       To "„§˜ššâ¢£˜«˜"
36608>>>>>>>    //DDB-ValidationCustomStart
36608>>>>>>>    //DDB-ValidationCustomEnd
36608>>>>>>>End_Object   // Clients_Client_Job_VT
36609>>>>>>>
36609>>>>>>>Object Clients_Client_Categfpa_VT  is a CodeValidationTable
36611>>>>>>>    Set Type_Value        To "VAT_STATUS"
36612>>>>>>>    Set Validate_State    To FALSE
36613>>>>>>>    Set Allow_Blank_State To TRUE
36614>>>>>>>    //DDB-ValidationCustomStart
36614>>>>>>>    //DDB-ValidationCustomEnd
36614>>>>>>>End_Object   // Clients_Client_Categfpa_VT
36615>>>>>>>
36615>>>>>>>Object Clients_Client_Catjob_VT1  is a CodeValidationTable
36617>>>>>>>    Set Type_Value        To "JOB"
36618>>>>>>>    Set Validate_State    To FALSE
36619>>>>>>>    Set Allow_Blank_State To TRUE
36620>>>>>>>    //DDB-ValidationCustomStart
36620>>>>>>>    //DDB-ValidationCustomEnd
36620>>>>>>>End_Object   // Clients_Client_Catjob_VT1
36621>>>>>>>
36621>>>>>>>Object Clients_Client_Idiot_VT  is a CodeValidationTable
36623>>>>>>>    Set Type_Value        To "IDIOT"
36624>>>>>>>    Set Validate_State    To FALSE
36625>>>>>>>    Set Allow_Blank_State To TRUE
36626>>>>>>>    Set Table_Title       To "€¨®œå¦ ˆ› ¦«ã«à¤"
36627>>>>>>>    //DDB-ValidationCustomStart
36627>>>>>>>    //DDB-ValidationCustomEnd
36627>>>>>>>End_Object   // Clients_Client_Idiot_VT
36628>>>>>>>
36628>>>>>>>Object Clients_Feregios_VT  is a CodeValidationTable
36630>>>>>>>    Set Type_Value        To "FEREGIOS"
36631>>>>>>>    Set Allow_Blank_State To TRUE
36632>>>>>>>    Set Table_Title       To "ƒœå¡«œª ”œ¨œšš¬æ«ž«˜ª ”¦¨âà¤"
36633>>>>>>>    //DDB-ValidationCustomStart
36633>>>>>>>    //DDB-ValidationCustomEnd
36633>>>>>>>End_Object   // Clients_Feregios_VT
36634>>>>>>>//DDB-ValidationEnd
36634>>>>>>>//DDB-SelectionStart
36634>>>>>>>//DDB/ ExternalSelectionList sl100  sl100.SL
36634>>>>>>>Register_Object sl100
36634>>>>>>>//DDB-SelectionEnd
36634>>>>>>>Open Sysfile
36636>>>>>>>open year
36638>>>>>>>
36638>>>>>>>Class Clients_DataDictionary  is a DataDictionary_Sec
36639>>>>>>>
36639>>>>>>>    Procedure Construct_Object
36640>>>>>>>        Forward Send Construct_Object
36642>>>>>>>        Property Integer piMustNOTConstrain Public 0
36643>>>>>>>        Property Integer piCheckPlaf        Public 0
36644>>>>>>>        //------------------------------------------------
36644>>>>>>>        // Properties gia na kraththoun oi palies times
36644>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio
36644>>>>>>>        // einai 1     js 03/12/2007
36644>>>>>>>        //------------------------------------------------
36644>>>>>>>        Property Integer piCreateNew            Public  0
36645>>>>>>>        Property String  psAud_Old_Pelaths      Public ""
36646>>>>>>>        Property String  psAud_Old_PelathsN     Public ""
36647>>>>>>>        Property String  psAud_Old_AFM          Public ""
36648>>>>>>>        Property String  psAud_Old_DOY          Public ""
36649>>>>>>>        Property String  psAud_Old_DOYN         Public ""
36650>>>>>>>        Property Integer piAud_Old_HPAL         Public  0
36651>>>>>>>        Property Integer piAud_Old_HPSO         Public  0
36652>>>>>>>        Property String  psAud_Old_PartlRecr    Public ""
36653>>>>>>>        Property String  psAud_Old_PmsRecr      Public ""
36654>>>>>>>        //------------------------------------------------
36654>>>>>>>
36654>>>>>>>    End_Procedure
36655>>>>>>>
36655>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
36656>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
36658>>>>>>>        //------------------------------------------------
36658>>>>>>>        // Properties gia na kraththoun oi palies times
36658>>>>>>>        // ton pedion js 03/12/2007
36658>>>>>>>        //------------------------------------------------
36658>>>>>>>        Set psAud_Old_Pelaths      to Clients.Client_ID
36659>>>>>>>        Set psAud_Old_PelathsN     to Clients.Client_Name
36660>>>>>>>        Set psAud_Old_AFM          to Clients.Client_AFM
36661>>>>>>>        Set psAud_Old_DOY          to Clients.Client_Doy
36662>>>>>>>        Set psAud_Old_DOYN         to (gsfCode_Mast("DOY",Clients.Client_Doy))
36663>>>>>>>        Set piAud_Old_HPAL         to Clients.HPAL
36664>>>>>>>        Set piAud_Old_HPSO         to Clients.HPSO
36665>>>>>>>        Set psAud_Old_PartlRecr    to Clients.Client_Recr
36666>>>>>>>        Set psAud_Old_PmsRecr      to Clients.Client_Recr
36667>>>>>>>        //------------------------------------------------
36667>>>>>>>     End_Procedure   // New_Current_Record
36668>>>>>>>
36668>>>>>>>
36668>>>>>>>    // Backout:
36668>>>>>>>    Procedure Backout
36669>>>>>>>        Forward Send Backout
36671>>>>>>>        // Insert Code Here
36671>>>>>>>    End_Procedure   // Backout
36672>>>>>>>
36672>>>>>>>    Procedure Delete_Main_File
36673>>>>>>>        //---------------------------------------------
36673>>>>>>>        // Auditing / Katagrafh allagon
36673>>>>>>>        String  sUser sText sTime sMin sHour sSec
36674>>>>>>>        Date    dDate  Shmer
36674>>>>>>>        Integer iMin iHour iSec iLen
36674>>>>>>>        Sysdate dDate iHour iMin iSec
36678>>>>>>>        Move iHour  to sHour
36679>>>>>>>        Move iMin   to sMin
36680>>>>>>>        Move iSec   to sSec
36681>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
36685>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
36689>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
36693>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
36694>>>>>>>
36694>>>>>>>        // Auditing / Diagrafh
36694>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
36696>>>>>>>            Get fsLoginUserID to sUser
36697>>>>>>>            clear gmove
36698>>>>>>>            move syscurxr.company_code  to gmove.company_code
36699>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
36700>>>>>>>            move syscurxr.year_year     to gmove.year_year
36701>>>>>>>            move  2                     to gmove.gtypkin_code// Apo Clients
36702>>>>>>>            move ddate                  to gmove.garticl_hmnia
36703>>>>>>>            move suser                  to gmove.gplan_code
36704>>>>>>>            move Clients.Client_Recr    to gmove.garticl_recr
36705>>>>>>>            reread sysrecg
36709>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
36710>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
36711>>>>>>>            saverecord sysrecg
36712>>>>>>>            unlock
36713>>>>>>>>
36713>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
36714>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
36715>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs
36716>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
36717>>>>>>>
36717>>>>>>>            Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
36718>>>>>>>            Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
36719>>>>>>>            Move (psAud_Old_AFM      (Self))    to Gmove.Prev_AFM
36720>>>>>>>            Move (psAud_Old_DOY      (Self))    to Gmove.Prev_Doy
36721>>>>>>>            Move (psAud_Old_DOYN     (Self))    to Gmove.Txt3
36722>>>>>>>            Move (piAud_Old_HPAL     (Self))    to Gmove.Prev_Stoxos1
36723>>>>>>>            Move (piAud_Old_HPSO     (Self))    to Gmove.Prev_Stoxos2
36724>>>>>>>
36724>>>>>>>
36724>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª œ¢á«ž"     to gmove.gmove_aitiol
36725>>>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
36726>>>>>>>            saverecord gmove
36727>>>>>>>        End
36727>>>>>>>>
36727>>>>>>>
36727>>>>>>>        Forward Send Delete_Main_File
36729>>>>>>>
36729>>>>>>>    End_Procedure
36730>>>>>>>
36730>>>>>>>
36730>>>>>>>    Procedure Update
36731>>>>>>>        Forward Send Update
36733>>>>>>>        // Insert Code Here
36733>>>>>>>        Move SysCurXR.Company_Code  to Clients.Company_Code
36734>>>>>>>        Move SysCurXR.Branch_Code   to Clients.Branch_Code
36735>>>>>>>        Move SysCurXR.Year_Year     to Clients.Year_Year
36736>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
36736>>>>>>>        Move (Clients.Xreosh-Clients.Pistosh)   to Clients.Ypoloipo
36737>>>>>>>        Move (Clients.Plafon-Clients.Ypoloipo)  to Clients.Overhead
36738>>>>>>>
36738>>>>>>>        //Move Clients.Client_Address     to Clients.Client_LastUpd
36738>>>>>>>
36738>>>>>>>        //betolink
36738>>>>>>>        Move SysCurXR.Beto_Site      to Clients.Client_SiteW
36739>>>>>>>        Move Clients.Client_Rec0     to Clients.Client_SN
36740>>>>>>>        Move Clients.Client_id       to Clients.Client_Repm
36741>>>>>>>        Move Clients.Company_Code    to Clients.CLIENT_COMPANY
36742>>>>>>>        Move Clients.Client_id       to Clients.Client_RepMatch
36743>>>>>>>     //   Move (gsfCode_Mast('JOB',Clients.Client_CatJob)) to Clients.Client_Job             
36743>>>>>>>     
36743>>>>>>>     
36743>>>>>>>        //---------------------------------------------
36743>>>>>>>        // Auditing / Katagrafh allagon
36743>>>>>>>        String  sUser sText sTime sMin sHour sSec
36744>>>>>>>        Date    dDate  Shmer 
36744>>>>>>>        Integer iMin iHour iSec iLen
36744>>>>>>>        Sysdate dDate iHour iMin iSec 
36748>>>>>>>        Move iHour  to sHour
36749>>>>>>>        Move iMin   to sMin
36750>>>>>>>        Move iSec   to sSec
36751>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
36755>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
36759>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
36763>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
36764>>>>>>>        
36764>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
36764>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
36766>>>>>>>            Get fsLoginUserID to sUser
36767>>>>>>>            If (piCreateNew(Self)=1) Begin
36769>>>>>>>                clear gmove
36770>>>>>>>                move syscurxr.company_code  to gmove.company_code
36771>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
36772>>>>>>>                move syscurxr.year_year     to gmove.year_year
36773>>>>>>>                move  2                     to gmove.gtypkin_code// Apo Clients
36774>>>>>>>                move ddate                  to gmove.garticl_hmnia
36775>>>>>>>                move suser                  to gmove.gplan_code
36776>>>>>>>                move Clients.Client_Recr    to gmove.garticl_recr
36777>>>>>>>                reread sysrecg
36781>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
36782>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
36783>>>>>>>                saverecord sysrecg
36784>>>>>>>                unlock
36785>>>>>>>>
36785>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
36786>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
36787>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
36788>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
36789>>>>>>>                Move Clients.Client_ID              to Gmove.Cur_ID
36790>>>>>>>                Move Clients.CLient_Name            to Gmove.Cur_Name
36791>>>>>>>                Move Clients.Client_Recr            to Gmove.Partl_Recr 
36792>>>>>>>                Move Clients.Client_Recr            to Gmove.Pms_Recr  
36793>>>>>>>                Move Clients.Client_AFM             to Gmove.Cur_AFM
36794>>>>>>>                Move Clients.Client_DOY             to Gmove.Cur_DOY
36795>>>>>>>                Move (gsfCode_Mast("DOY",Clients.Client_Doy)) to Gmove.Txt4
36796>>>>>>>                Move Clients.HPAL                   to Gmove.Prev_Stoxos1
36797>>>>>>>                Move Clients.HPSO                   to Gmove.Prev_Stoxos2
36798>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â¦¬ œ¢á«ž"       to Gmove.Gmove_Aitiol
36799>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs
36800>>>>>>>                saverecord gmove
36801>>>>>>>                Set piCreateNew to 0
36802>>>>>>>            End
36802>>>>>>>>
36802>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
36805>>>>>>>                Integer isChanged
36805>>>>>>>                Move 0 to isChanged
36806>>>>>>>                
36806>>>>>>>                     If (psAud_Old_Pelaths  (Self)<>Clients.Client_ID   ) Move 1 to isChanged
36809>>>>>>>                Else If (psAud_Old_PelathsN (Self)<>Clients.Client_Name ) Move 1 to isChanged
36813>>>>>>>                Else If (psAud_Old_AFM      (Self)<>Clients.Client_AFM  ) Move 1 to isChanged
36817>>>>>>>                Else If (psAud_Old_DOY      (Self)<>Clients.Client_DOY  ) Move 1 to isChanged
36821>>>>>>>                Else If (piAud_Old_HPAL     (Self)<>Clients.HPAL        ) Move 1 to isChanged
36825>>>>>>>                Else If (piAud_Old_HPSO     (Self)<>Clients.HPSO        ) Move 1 to isChanged
36829>>>>>>>                
36829>>>>>>>                If (isChanged>0) Begin  
36831>>>>>>>                    clear gmove
36832>>>>>>>                    move syscurxr.company_code  to gmove.company_code
36833>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
36834>>>>>>>                    move syscurxr.year_year     to gmove.year_year
36835>>>>>>>                    move  2                     to gmove.gtypkin_code// Apo Clients
36836>>>>>>>                    move ddate                  to gmove.garticl_hmnia
36837>>>>>>>                    move suser                  to gmove.gplan_code
36838>>>>>>>                    move Clients.Client_Recr    to gmove.garticl_recr
36839>>>>>>>                    reread sysrecg
36843>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
36844>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
36845>>>>>>>                    saverecord sysrecg
36846>>>>>>>                    unlock
36847>>>>>>>>
36847>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
36848>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
36849>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
36850>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
36851>>>>>>>                    Move Clients.Client_Recr            to Gmove.Partl_Recr 
36852>>>>>>>                    Move Clients.Client_Recr            to Gmove.Pms_Recr  
36853>>>>>>>                    //--
36853>>>>>>>                    Move Clients.Client_ID              to Gmove.Cur_ID
36854>>>>>>>                    Move Clients.CLient_Name            to Gmove.Cur_Name
36855>>>>>>>                    Move Clients.Client_AFM             to Gmove.Cur_AFM
36856>>>>>>>                    Move Clients.Client_DOY             to Gmove.Cur_DOY
36857>>>>>>>                    Move (gsfCode_Mast("DOY",Clients.Client_Doy)) to Gmove.Txt4
36858>>>>>>>                    Move Clients.HPAL                   to Gmove.Cur_Stoxos1
36859>>>>>>>                    Move Clients.HPSO                   to Gmove.Cur_Stoxos2
36860>>>>>>>                    //--
36860>>>>>>>                    Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
36861>>>>>>>                    Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
36862>>>>>>>                    Move (psAud_Old_AFM      (Self))    to Gmove.Prev_AFM
36863>>>>>>>                    Move (psAud_Old_DOY      (Self))    to Gmove.Prev_Doy 
36864>>>>>>>                    Move (psAud_Old_DOYN     (Self))    to Gmove.Txt3
36865>>>>>>>                    Move (piAud_Old_HPAL     (Self))    to Gmove.Prev_Stoxos1
36866>>>>>>>                    Move (piAud_Old_HPSO     (Self))    to Gmove.Prev_Stoxos2
36867>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª œ¢á«ž"     to gmove.gmove_aitiol
36868>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
36869>>>>>>>                    saverecord gmove
36870>>>>>>>                    Set piCreateNew to 0
36871>>>>>>>                End
36871>>>>>>>>
36871>>>>>>>            End
36871>>>>>>>>
36871>>>>>>>        End
36871>>>>>>>>
36871>>>>>>>
36871>>>>>>>     
36871>>>>>>>    End_Procedure   // Update
36872>>>>>>>
36872>>>>>>>
36872>>>>>>>    Procedure Creating
36873>>>>>>>        date ddate iYes
36874>>>>>>>        Forward Send Creating
36876>>>>>>>        // Insert Code Here
36876>>>>>>>
36876>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Clients.Client_Rec0))))));                                    to Clients.Client_Recr
36877>>>>>>>        Move '1'                    to Clients.Client_Active
36878>>>>>>>        get fsgCode_With_Zeroes Clients.Client_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to Clients.Client_ID
36879>>>>>>>        sysdate4 ddate
36880>>>>>>>        move ddate                  to Clients.Client_Hmnia    
36881>>>>>>>        Set piCreateNew to 1
36882>>>>>>>    End_Procedure   // Creating
36883>>>>>>>
36883>>>>>>>    Function Validate_Save  Returns Integer
36884>>>>>>>        Integer iReturnVal iCheck iYes
36885>>>>>>>        Forward Get Validate_Save  To iReturnVal
36887>>>>>>>        If (Not(iReturnVal)) Begin
36889>>>>>>>
36889>>>>>>>            If (clients.is_eksoter <> '1') begin
36891>>>>>>>                If (Clients.Is_Xondr='1') Begin
36893>>>>>>>                    If (Sysfile.Check_Afm=1) Begin
36895>>>>>>>                        Move (Check_AFM(Clients.Client_Afm)) to iCheck
36896>>>>>>>                        If (iCheck) Begin
36898>>>>>>>                                 If (iCheck=1) Move 4001 to iReturnVal
36901>>>>>>>                            Else If (iCheck=2) Move 4002 to iReturnVal
36905>>>>>>>                            Else If (iCheck=3) Move 4003 to iReturnVal
36909>>>>>>>                        End
36909>>>>>>>>
36909>>>>>>>                    End
36909>>>>>>>>
36909>>>>>>>                End
36909>>>>>>>>
36909>>>>>>>            End
36909>>>>>>>>
36909>>>>>>>
36909>>>>>>>            If (piCheckPlaf(Self)=1) Begin
36911>>>>>>>                If ((Clients.Plafon>0) And ((Clients.Ypoloipo+Clients.Posa_Apo_Dap)>Clients.Plafon)) Begin
36913>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4000 Clients' to iYes
36914>>>>>>>                    If (iYes=MBR_NO) Error 4004 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž' //Move 4004 to iReturnVal
36917>>>>>>>                End
36917>>>>>>>>
36917>>>>>>>                Else If ((PayResp.Plafon<>0) And (PayResp.Plafon<=PayResp.Synolikh_Ofeilh)) Begin
36920>>>>>>>                    Get YesNo_Box 'Ž ¬§œçŸ¬¤¦ª §¢ž¨à£ãª ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž\nŒ˜ ©¬¤œ®å©à ©«ž¤ ›ž£ ¦¬¨šå˜ œšš¨˜­ãª §œ¢á«ž;' to iYes
36921>>>>>>>                    If (iYes=MBR_NO) Error 4005 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
36924>>>>>>>                End
36924>>>>>>>>
36924>>>>>>>                Else If ((Clients.Orio_Syn_Ofeilh>0) And (Clients.Synolikh_Ofeilh>Clients.Orio_Syn_Ofeilh)) Begin
36927>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4001 Clients' to iYes
36928>>>>>>>                    If (iYes=MBR_NO) Error 4005 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
36931>>>>>>>                End
36931>>>>>>>>
36931>>>>>>>                Else If ((Clients.Orio_Syn_Ofeilh>0) And (PayResp.Orio_Syn_Ofeilh>0) And (Clients.Synolikh_Ofeilh>Payresp.Orio_Syn_Ofeilh)) Begin
36934>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4002 Clients' to iYes
36935>>>>>>>                    If (iYes=MBR_NO) Error 4006 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'   //Move 4006 to iReturnVal
36938>>>>>>>                End
36938>>>>>>>>
36938>>>>>>>                If ((Clients.Plafon>0) And ((Clients.Ypoloipo+Clients.Posa_Apo_Parag)>Clients.Plafon)) Begin
36940>>>>>>>                    Send Info_Box '’˜ §¦©á «à¤ ž£œ¨ž©åà¤ §˜¨˜ššœ¢ é¤\n¬§œ¨™˜å¤¦¬¤ «¦ › ˜Ÿâ© £¦ ¬§æ¢¦ §¦\n™á©ž §¢˜­æ¤ «¦¬ §œ¢á«ž' '¨¦©¦®ã !!!'
36941>>>>>>>                End
36941>>>>>>>>
36941>>>>>>>            End
36941>>>>>>>>
36941>>>>>>>
36941>>>>>>>            If (iReturnVal) Begin
36943>>>>>>>                Send Operation_Not_Allowed iReturnVal
36944>>>>>>>            End
36944>>>>>>>>
36944>>>>>>>        End
36944>>>>>>>>
36944>>>>>>>        Function_Return iReturnVal
36945>>>>>>>    End_Function   // Validate_Save
36946>>>>>>>
36946>>>>>>>
36946>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
36947>>>>>>>        String lsError_Message
36948>>>>>>>
36948>>>>>>>        Case Begin
36948>>>>>>>            Case (iError_Num = 4001)
36950>>>>>>>                Move "DDC 100: Š˜¤Ÿ˜©£â¤¦ €”‹ œ¢á«ž" ;                    to lsError_Message
36951>>>>>>>              Case Break
36952>>>>>>>            Case (iError_Num = 4002)
36955>>>>>>>                Move "DDC 100: ’¦ €”‹ œ¢á«ž ›œ¤ œå¤˜  9 ¯ã­ ¦" ;                    to lsError_Message
36956>>>>>>>              Case Break
36957>>>>>>>            Case (iError_Num = 4003)
36960>>>>>>>                Move "DDC 100: €¡˜«á¢¢ž¢¦ª ®˜¨˜¡«ã¨˜ª ©«¦ €”‹ œ¢á«ž" ;                    to lsError_Message
36961>>>>>>>              Case Break
36962>>>>>>>            Case (iError_Num = 4004)
36965>>>>>>>                Move "DDC 100: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ §œ¢á«ž" ;                    to lsError_Message
36966>>>>>>>              Case Break
36967>>>>>>>            Case (iError_Num = 4005)
36970>>>>>>>                Move "DDC 100: † ©¬¤¦¢ ¡ã ¦­œ ¢ã ¬§œ¨™˜å¤œ \n«¦ æ¨ ¦ ©¬¤¦¢ ¡ãª ¦­œ ¢ãª" ;                    to lsError_Message
36971>>>>>>>              Case Break
36972>>>>>>>            Case (iError_Num = 4006)
36975>>>>>>>                Move "DDC 100: † ©¬¤¦¢ ¡ã ¦­œ ¢ã ¬§œ¨™˜å¤œ \n«¦ æ¨ ¦ ©¬¤¦¢ ¡ãª ¦­œ ¢ãª «¦¬ “§œ¬Ÿç¤¦¬" ;                    to lsError_Message
36976>>>>>>>              Case Break
36977>>>>>>>
36977>>>>>>>            Case Else
36977>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
36979>>>>>>>        Case End
36979>>>>>>>
36979>>>>>>>        Error iError_Num lsError_Message
36980>>>>>>>>
36980>>>>>>>    End_Procedure // operation_not_allowed
36981>>>>>>>
36981>>>>>>>
36981>>>>>>>    // Define_Fields:
36981>>>>>>>    // This procedure is used to set up all data-dictionary rules.
36981>>>>>>>
36981>>>>>>>    Procedure Define_Fields
36982>>>>>>>        Forward Send Define_Fields
36984>>>>>>>        //DDB-Generated-Code-Location
36984>>>>>>>        //DDB-DefineFieldStart
36984>>>>>>>
36984>>>>>>>        Set Main_File            To Clients.File_Number
36985>>>>>>>        Set Cascade_Delete_State To FALSE
36986>>>>>>>
36986>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
36987>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
36988>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
36989>>>>>>>
36989>>>>>>>        // Child (Client) file structure................
36989>>>>>>>        Send Add_Client_File  Cmoves.File_Number
36990>>>>>>>        Send Add_Client_File  Particle.File_Number
36991>>>>>>>        Send Add_Client_File  Cmovesa.File_Number
36992>>>>>>>        Send Add_Client_File  Cn.File_Number
36993>>>>>>>        Send Add_Client_File  Particll.File_Number
36994>>>>>>>        Send Add_Client_File  Clnbank.File_Number
36995>>>>>>>        Send Add_Client_File  Tpclient.File_Number
36996>>>>>>>        Send Add_Client_File  Clorder.File_Number
36997>>>>>>>        Send Add_Client_File  Clitem.File_Number
36998>>>>>>>
36998>>>>>>>        // Parent (Server) file structure...............
36998>>>>>>>        Send Add_Server_File  Cities.File_Number
36999>>>>>>>        Send Add_Server_File  Areas.File_Number
37000>>>>>>>        Send Add_Server_File  Payresp.File_Number
37001>>>>>>>
37001>>>>>>>        // External (System) file structure.............
37001>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
37002>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
37003>>>>>>>        Send Add_System_File  Ptypparl.File_Number  DD_LOCK_ON_ALL
37004>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
37005>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
37006>>>>>>>
37006>>>>>>>        Define_Auto_Increment  Sysrecc.Client_Rec0  To Clients.Client_Rec0
37009>>>>>>>
37009>>>>>>>        // Field-based properties.......................
37009>>>>>>>
37009>>>>>>>        // Clients.Company_Code
37009>>>>>>>
37009>>>>>>>        // Clients.Branch_Code
37009>>>>>>>
37009>>>>>>>        // Clients.Year_Year
37009>>>>>>>
37009>>>>>>>        // Clients.Custprom_Code
37009>>>>>>>
37009>>>>>>>        // Clients.Client_Id
37009>>>>>>>        Set Field_Options          Field Clients.Client_Id To DD_AUTOFIND    DD_NOPUT      
37010>>>>>>>        Set Field_Prompt_Object    Field Clients.Client_Id To (sl100(Self))
37011>>>>>>>        Set Key_Field_State        Field Clients.Client_Id To TRUE
37012>>>>>>>
37012>>>>>>>        // Clients.Client_Name
37012>>>>>>>        Set Field_Prompt_Object    Field Clients.Client_Name To (sl100(Self))
37013>>>>>>>
37013>>>>>>>        // Clients.Client_Afm
37013>>>>>>>        Set Field_Options          Field Clients.Client_Afm To DD_AUTOFIND   
37014>>>>>>>
37014>>>>>>>        // Clients.Client_Rec0
37014>>>>>>>        Set Field_Options          Field Clients.Client_Rec0 To DD_AUTOFIND   
37015>>>>>>>
37015>>>>>>>        // Clients.Custprom_Recr
37015>>>>>>>
37015>>>>>>>        // Clients.Client_Recr
37015>>>>>>>        Set Field_Options          Field Clients.Client_Recr To DD_AUTOFIND   
37016>>>>>>>
37016>>>>>>>        // Clients.Last_Xreosh
37016>>>>>>>
37016>>>>>>>        // Clients.Last_Pistosh
37016>>>>>>>
37016>>>>>>>        // Clients.Last_Order
37016>>>>>>>        Set Field_Class_Name       Field Clients.Last_Order To "dbComboFormSub"
37017>>>>>>>
37017>>>>>>>        // Clients.Client_Doy
37017>>>>>>>        Set Field_Value_Table      Field Clients.Client_Doy To (Clients_Client_Doy_VT(Self))
37018>>>>>>>
37018>>>>>>>        // Clients.Client_Address
37018>>>>>>>
37018>>>>>>>        // Clients.Client_City_Id
37018>>>>>>>
37018>>>>>>>        // Clients.Client_Area
37018>>>>>>>
37018>>>>>>>        // Clients.Client_Job
37018>>>>>>>        Set Field_Value_Table      Field Clients.Client_Job To (Clients_Client_Job_VT(Self))
37019>>>>>>>
37019>>>>>>>        // Clients.Client_Respons
37019>>>>>>>
37019>>>>>>>        // Clients.Client_Zipcode
37019>>>>>>>
37019>>>>>>>        // Clients.Client_Phone
37019>>>>>>>
37019>>>>>>>        // Clients.Client_Fax
37019>>>>>>>
37019>>>>>>>        // Clients.Client_Mobile
37019>>>>>>>
37019>>>>>>>        // Clients.Client_Aoh
37019>>>>>>>
37019>>>>>>>        // Clients.Client_Email
37019>>>>>>>
37019>>>>>>>        // Clients.Client_Class
37019>>>>>>>
37019>>>>>>>        // Clients.Client_Details
37019>>>>>>>
37019>>>>>>>        // Clients.Client_Sitew
37019>>>>>>>
37019>>>>>>>        // Clients.Client_Codem
37019>>>>>>>
37019>>>>>>>        // Clients.Client_Categfpa
37019>>>>>>>        Set Field_Value_Table      Field Clients.Client_Categfpa To (Clients_Client_Categfpa_VT(Self))
37020>>>>>>>
37020>>>>>>>        // Clients.Client_Fpa
37020>>>>>>>
37020>>>>>>>        // Clients.Client_Public
37020>>>>>>>
37020>>>>>>>        // Clients.Client_Sn
37020>>>>>>>
37020>>>>>>>        // Clients.Client_Repm
37020>>>>>>>
37020>>>>>>>        // Clients.Client_Active
37020>>>>>>>
37020>>>>>>>        // Clients.Client_Reported
37020>>>>>>>
37020>>>>>>>        // Clients.Client_Pelprom
37020>>>>>>>
37020>>>>>>>        // Clients.Client_Lastupd
37020>>>>>>>
37020>>>>>>>        // Clients.Client_Markexp
37020>>>>>>>
37020>>>>>>>        // Clients.Client_Catjob
37020>>>>>>>        Set Field_Value_Table      Field Clients.Client_Catjob To (Clients_Client_Catjob_VT1(Self))
37021>>>>>>>
37021>>>>>>>        // Clients.Is_Promhtheyths
37021>>>>>>>
37021>>>>>>>        // Clients.Xreosh
37021>>>>>>>
37021>>>>>>>        // Clients.Pistosh
37021>>>>>>>
37021>>>>>>>        // Clients.Ypoloipo
37021>>>>>>>
37021>>>>>>>        // Clients.Plafon
37021>>>>>>>
37021>>>>>>>        // Clients.Overhead
37021>>>>>>>
37021>>>>>>>        // Clients.Client_Company
37021>>>>>>>
37021>>>>>>>        // Clients.Client_Repmatch
37021>>>>>>>
37021>>>>>>>        // Clients.Client_Hmnia
37021>>>>>>>
37021>>>>>>>        // Clients.Client_Presp
37021>>>>>>>
37021>>>>>>>        // Clients.Client_Locked
37021>>>>>>>
37021>>>>>>>        // Clients.Synolikh_Ofeilh
37021>>>>>>>
37021>>>>>>>        // Clients.Client_Idiot
37021>>>>>>>        Set Field_Value_Table      Field Clients.Client_Idiot To (Clients_Client_Idiot_VT(Self))
37022>>>>>>>
37022>>>>>>>        // Clients.Client_Add_No
37022>>>>>>>
37022>>>>>>>        // Clients.Client_Nomos
37022>>>>>>>
37022>>>>>>>        // Clients.Client_Xora
37022>>>>>>>
37022>>>>>>>        // Clients.Polh_Recr
37022>>>>>>>
37022>>>>>>>        // Clients.Presp_Id
37022>>>>>>>
37022>>>>>>>        // Clients.Sum_Pct_Tpcl
37022>>>>>>>
37022>>>>>>>        // Clients.Is_Client
37022>>>>>>>
37022>>>>>>>        // Clients.Sysxetish
37022>>>>>>>
37022>>>>>>>        // Clients.Poso_Se_Apait
37022>>>>>>>
37022>>>>>>>        // Clients.Client_Glcode
37022>>>>>>>
37022>>>>>>>        // Clients.Is_Eksoter
37022>>>>>>>
37022>>>>>>>        // Clients.Is_Xondr
37022>>>>>>>
37022>>>>>>>        // Clients.Orio_Syn_Ofeilh
37022>>>>>>>
37022>>>>>>>        // Clients.Posa_Apo_Dap
37022>>>>>>>
37022>>>>>>>        // Clients.Client_Doybtm
37022>>>>>>>
37022>>>>>>>        // Clients.Posa_Apo_Parag
37022>>>>>>>
37022>>>>>>>        // Clients.Client_Ptyppar
37022>>>>>>>
37022>>>>>>>        // Clients.Client_Seira
37022>>>>>>>
37022>>>>>>>        // Clients.Hpso
37022>>>>>>>
37022>>>>>>>        // Clients.Hpal
37022>>>>>>>
37022>>>>>>>        // Clients.Feregios
37022>>>>>>>        Set Field_Value_Table      Field Clients.Feregios To (Clients_Feregios_VT(Self))
37023>>>>>>>
37023>>>>>>>        // Clients.Diakin
37023>>>>>>>
37023>>>>>>>        // Clients.Status
37023>>>>>>>
37023>>>>>>>        // Clients.Anal
37023>>>>>>>
37023>>>>>>>        // Clients.Endoomil
37023>>>>>>>
37023>>>>>>>        // Clients.Npdd
37023>>>>>>>
37023>>>>>>>        // Clients.Sap_Hmnia
37023>>>>>>>
37023>>>>>>>        //DDB-DefineFieldEnd
37023>>>>>>>    End_Procedure    // Define_Fields
37024>>>>>>>
37024>>>>>>>    // Field_Defaults:
37024>>>>>>>    // This procedure is used to establish default field values.
37024>>>>>>>
37024>>>>>>>    Procedure Field_Defaults
37025>>>>>>>        Forward Send Field_Defaults
37027>>>>>>>        //DDB-Generated-Code-Location
37027>>>>>>>        //DDB-FieldDefaultStart
37027>>>>>>>        Set Field_Changed_Value   Field Clients.Client_Doy To "0"
37028>>>>>>>        //DDB-FieldDefaultEnd
37028>>>>>>>    End_Procedure    // Field_Defaults
37029>>>>>>>
37029>>>>>>>End_Class    // Clients_DataDictionary
37030>>>>>>>//DDB-Selection-pkg-Start
37030>>>>>>>
37030>>>>>>>Use sl100.SL         // sl100
INCLUDING FILE: SL100.SL
37030>>>>>>>>>//AB/ Project SL100:PELATES
37030>>>>>>>>>//AB/     Object prj is a Lookup_Project
37030>>>>>>>>>//AB/         Set ProjectName to "SL100:PELATES"
37030>>>>>>>>>//AB/         Set ProjectFileName to "SL100.SL"
37030>>>>>>>>>
37030>>>>>>>>>// Project Object Structure
37030>>>>>>>>>//   sl100 is a dbModalPanelSub
37030>>>>>>>>>//     Clients_DD is a DataDictionary
37030>>>>>>>>>//     oSelList is a dbListSub
37030>>>>>>>>>//     oOK_bn is a ButtonSub
37030>>>>>>>>>//     oCancel_bn is a ButtonSub
37030>>>>>>>>>//     oSearch_bn is a ButtonSub
37030>>>>>>>>>
37030>>>>>>>>>// Register all objects
37030>>>>>>>>>Register_Object Clients_DD
37030>>>>>>>>>Register_Object oCancel_bn
37030>>>>>>>>>Register_Object oOK_bn
37030>>>>>>>>>Register_Object oSearch_bn
37030>>>>>>>>>Register_Object oSelList
37030>>>>>>>>>Register_Object sl100
37030>>>>>>>>>
37030>>>>>>>>>
37030>>>>>>>>>    //AB-IgnoreStart
37030>>>>>>>>>
37030>>>>>>>>>    Use DFAllEnt.pkg
37030>>>>>>>>>    Use dbList.Sub
37030>>>>>>>>>    Use Button.Sub
37030>>>>>>>>>
37030>>>>>>>>>
37030>>>>>>>>>    Use CLIENTS.DD
37030>>>>>>>>>    
37030>>>>>>>>>    //AB-IgnoreEnd
37030>>>>>>>>>
37030>>>>>>>>>    Object sl100 is a dbModalPanelSub
37032>>>>>>>>>
37032>>>>>>>>>        //AB-StoreTopStart
37032>>>>>>>>>                
37032>>>>>>>>>        Property String     FragmaClient        Public ''
37034>>>>>>>>>        Property String     psIsPromhtheyths    Public ''
37036>>>>>>>>>        Property Integer    piMustConstrain     Public  0
37038>>>>>>>>>        Property String     psModule            Public ''
37040>>>>>>>>>        
37040>>>>>>>>>        //AB-StoreTopEnd
37040>>>>>>>>>
37040>>>>>>>>>        Set Label to "(Xlate(Label(Self)))"
37041>>>>>>>>>        Set Size to 252 509
37042>>>>>>>>>        Set Location to 4 5
37043>>>>>>>>>
37043>>>>>>>>>        //AB-DDOStart
37043>>>>>>>>>
37043>>>>>>>>>        Object Clients_DD is a Clients_DataDictionary
37045>>>>>>>>>
37045>>>>>>>>>            //AB-StoreTopStart
37045>>>>>>>>>                                                        
37045>>>>>>>>>            //AB-StoreTopEnd
37045>>>>>>>>>
37045>>>>>>>>>
37045>>>>>>>>>            //AB-StoreStart
37045>>>>>>>>>                                                        
37045>>>>>>>>>            Begin_Constraints
37047>>>>>>>>>                     If (psModule(Self)='01') BEGIN
37049>>>>>>>>>                        Constrain Clients.is_Client        Eq '1'
37051>>>>>>>>>                     end
37051>>>>>>>>>>
37051>>>>>>>>>                     Else If (psModule(Self)='02') begin
37054>>>>>>>>>                        Constrain Clients.is_Promhtheyths  Eq '1'
37056>>>>>>>>>                     end
37056>>>>>>>>>>
37056>>>>>>>>>            End_Constraints
37059>>>>>>>>>            
37059>>>>>>>>>            
37059>>>>>>>>>            
37059>>>>>>>>>            
37059>>>>>>>>>            
37059>>>>>>>>>            //AB-StoreEnd
37059>>>>>>>>>
37059>>>>>>>>>        End_Object    // Clients_DD
37060>>>>>>>>>
37060>>>>>>>>>        Set Main_DD to (Clients_DD(self))
37061>>>>>>>>>        Set Server to (Clients_DD(self))
37062>>>>>>>>>
37062>>>>>>>>>        //AB-DDOEnd
37062>>>>>>>>>
37062>>>>>>>>>        Object oSelList is a dbListSub
37064>>>>>>>>>            Set Main_File to Clients.File_Number
37065>>>>>>>>>            Set Size to 204 496
37066>>>>>>>>>            Set Location to 7 5
37067>>>>>>>>>            Set Auto_Index_State to FALSE
37068>>>>>>>>>
37068>>>>>>>>>            Begin_Row
37071>>>>>>>>>                Entry_Item Clients.Client_id
37072>>>>>>>>>                Entry_Item Clients.Client_name
37073>>>>>>>>>                Entry_Item Clients.Client_afm
37074>>>>>>>>>                Entry_Item Clients.Last_xreosh
37075>>>>>>>>>                Entry_Item Clients.Last_pistosh
37076>>>>>>>>>                Entry_Item Clients.Client_codem
37077>>>>>>>>>                Entry_Item Clients.Is_client
37078>>>>>>>>>                Entry_Item Clients.Is_promhtheyths
37079>>>>>>>>>            End_Row
37084>>>>>>>>>
37084>>>>>>>>>            Set Form_Width    item 0 to 64
37085>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
37086>>>>>>>>>            
37086>>>>>>>>>            Set Form_Width    item 1 to 133
37087>>>>>>>>>            Set Header_Label  item 1 to "„§à¤¬£å˜"
37088>>>>>>>>>            
37088>>>>>>>>>            Set Form_Width    item 2 to 62
37089>>>>>>>>>            Set Header_Label  item 2 to "€”‹"
37090>>>>>>>>>            
37090>>>>>>>>>            Set Form_Width    item 3 to 60
37091>>>>>>>>>            Set Header_Label  item 3 to "’œ¢. •¨âà©ž"
37092>>>>>>>>>            
37092>>>>>>>>>            Set Form_Width    item 4 to 60
37093>>>>>>>>>            Set Header_Label  item 4 to "’œ¢. å©«à©ž"
37094>>>>>>>>>            
37094>>>>>>>>>            Set Form_Width    item 5 to 59
37095>>>>>>>>>            Set Header_Label  item 5 to "‰à›.‘ç¤›œ©žª"
37096>>>>>>>>>            
37096>>>>>>>>>            Set Form_Width    item 6 to 26
37097>>>>>>>>>            Set Header_Label  item 6 to "œ¢"
37098>>>>>>>>>            Set Column_Checkbox_State  item 6 to True
37099>>>>>>>>>            
37099>>>>>>>>>            Set Form_Width    item 7 to 26
37100>>>>>>>>>            Set Header_Label  item 7 to "¨¦£"
37101>>>>>>>>>            Set Column_Checkbox_State  item 7 to True
37102>>>>>>>>>            
37102>>>>>>>>>
37102>>>>>>>>>            //AB-StoreStart
37102>>>>>>>>>                                                                                
37102>>>>>>>>>            //Property String StoreFragmaClient   Public ''
37102>>>>>>>>>            //Property String StorePsModule       Public ''
37102>>>>>>>>>            
37102>>>>>>>>>            //Procedure Store_Defaults
37102>>>>>>>>>            //    Forward Send Store_Defaults
37102>>>>>>>>>            //    Set StoreFragmaClient   to (FragmaClient(Self))
37102>>>>>>>>>            //    Set StorePsModule       to (psModule    (Self))
37102>>>>>>>>>            //End_Procedure
37102>>>>>>>>>            
37102>>>>>>>>>            //Procedure ReStore_Defaults
37102>>>>>>>>>            //    Forward Send ReStore_Defaults
37102>>>>>>>>>            //    Set FragmaClient to (StoreFragmaClient(Self))
37102>>>>>>>>>            //    Set psModule     to (StorePsModule    (Self))
37102>>>>>>>>>            //End_Procedure
37102>>>>>>>>>            
37102>>>>>>>>>            Set Column_Option Item 6 to NoEnter True
37103>>>>>>>>>            Set Column_Option Item 7 to NoEnter True
37104>>>>>>>>>            
37104>>>>>>>>>            Procedure Activating
37106>>>>>>>>>                Forward Send Activating
37108>>>>>>>>>                Set Auto_Index_State to True
37109>>>>>>>>>            End_Procedure
37110>>>>>>>>>            
37110>>>>>>>>>            Procedure Activate
37112>>>>>>>>>                Send Rebuild_Constraints    to Clients_DD
37113>>>>>>>>>                If (FragmaClient(Self)<>'') Begin
37115>>>>>>>>>                    Clear Clients
37116>>>>>>>>>                    Move (FragmaClient(Self)) to Clients.Client_ID
37117>>>>>>>>>                    Find Eq Clients By Index.6
37118>>>>>>>>>>
37118>>>>>>>>>                    If (Found) Send Request_Find to Clients_DD Eq Clients.File_Number 6
37121>>>>>>>>>                End
37121>>>>>>>>>>
37121>>>>>>>>>                Forward Send Activate
37123>>>>>>>>>            End_procedure
37124>>>>>>>>>            
37124>>>>>>>>>            
37124>>>>>>>>>            
37124>>>>>>>>>            
37124>>>>>>>>>            //AB-StoreEnd
37124>>>>>>>>>
37124>>>>>>>>>        End_Object    // oSelList
37125>>>>>>>>>
37125>>>>>>>>>        Object oOK_bn is a ButtonSub
37127>>>>>>>>>            Set Label to "&„§ ¢¦šã"
37128>>>>>>>>>            Set Location to 218 341
37129>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
37130>>>>>>>>>
37130>>>>>>>>>            //AB-StoreStart
37130>>>>>>>>>            Procedure OnClick
37132>>>>>>>>>                Send OK To (oSelList(current_object))
37133>>>>>>>>>            End_Procedure
37134>>>>>>>>>            //AB-StoreEnd
37134>>>>>>>>>
37134>>>>>>>>>        End_Object    // oOK_bn
37135>>>>>>>>>
37135>>>>>>>>>        Object oCancel_bn is a ButtonSub
37137>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
37138>>>>>>>>>            Set Location to 218 396
37139>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
37140>>>>>>>>>
37140>>>>>>>>>            //AB-StoreStart
37140>>>>>>>>>            Procedure OnClick
37142>>>>>>>>>                Send Cancel To (oSelList(current_object))
37143>>>>>>>>>            End_Procedure
37144>>>>>>>>>            //AB-StoreEnd
37144>>>>>>>>>
37144>>>>>>>>>        End_Object    // oCancel_bn
37145>>>>>>>>>
37145>>>>>>>>>        Object oSearch_bn is a ButtonSub
37147>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
37148>>>>>>>>>            Set Location to 218 451
37149>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
37150>>>>>>>>>
37150>>>>>>>>>            //AB-StoreStart
37150>>>>>>>>>            Procedure OnClick
37152>>>>>>>>>                Send Search To (oSelList(current_object))
37153>>>>>>>>>            End_Procedure
37154>>>>>>>>>            //AB-StoreEnd
37154>>>>>>>>>
37154>>>>>>>>>        End_Object    // oSearch_bn
37155>>>>>>>>>
37155>>>>>>>>>
37155>>>>>>>>>        //AB-StoreStart
37155>>>>>>>>>                
37155>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
37156>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
37157>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
37158>>>>>>>>>        
37158>>>>>>>>>        Set Modal_State to True
37159>>>>>>>>>        Set Locate_Mode to Center_On_Screen
37160>>>>>>>>>        
37160>>>>>>>>>        
37160>>>>>>>>>        Procedure Activating Returns Integer
37162>>>>>>>>>            Integer rVal
37163>>>>>>>>>            Forward Get Msg_Activating to rVal
37165>>>>>>>>>                 if (psmodule(self)='01') set label of sl100 to '‰˜«á¢¦š¦ª œ¢˜«é¤'
37168>>>>>>>>>            else if (psmodule(self)='02') set label of sl100 to '‰˜«á¢¦š¦ª ¨¦£žŸœ¬«é¤'
37172>>>>>>>>>            Procedure_Return rVal
37173>>>>>>>>>        End_procedure
37174>>>>>>>>>        
37174>>>>>>>>>        
37174>>>>>>>>>        
37174>>>>>>>>>        
37174>>>>>>>>>        
37174>>>>>>>>>        
37174>>>>>>>>>        
37174>>>>>>>>>        
37174>>>>>>>>>        
37174>>>>>>>>>        //AB-StoreEnd
37174>>>>>>>>>
37174>>>>>>>>>    End_Object    // sl100
37175>>>>>>>>>
37175>>>>>>>>>//AB/     End_Object    // prj
37175>>>>>>>
37175>>>>>>>//DDB-Selection-pkg-End
37175>>>>>>>//DDB-FileEnd
37175>>>>>Use CMOVES.DD
INCLUDING FILE: CMOVES.DD
37175>>>>>>>//DDB-FileStart
37175>>>>>>>//DDB-HeaderStart
37175>>>>>>>
37175>>>>>>>// File Name : CMOVES.DD
37175>>>>>>>// Class Name: Cmoves_DataDictionary
37175>>>>>>>// Revision  : 149
37175>>>>>>>// Version   : 2
37175>>>>>>>
37175>>>>>>>Use  Windows           // Basic Definitions
37175>>>>>>>Use  DataDict          // DataDictionary Class Definition
37175>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
37175>>>>>>>
37175>>>>>>>Open Cmoves
37177>>>>>>>Open Copen
INCLUDING FILE: COPEN.FD
37179>>>>>>>Open Ctypkin
37181>>>>>>>Open Clients
37183>>>>>>>Open Sysrecc
37185>>>>>>>Open Syscurxr
37187>>>>>>>
37187>>>>>>>//DDB-HeaderEnd
37187>>>>>>>//DDB-SelectionStart
37187>>>>>>>//DDB/ ExternalSelectionList sl006  sl006.SL
37187>>>>>>>//DDB/ ExternalSelectionList slNomism  slnomism.sl
37187>>>>>>>//DDB/ ExternalSelectionList sl041  sl041.SL
37187>>>>>>>Register_Object sl006
37187>>>>>>>Register_Object slNomism
37187>>>>>>>Register_Object sl041
37187>>>>>>>//DDB-SelectionEnd
37187>>>>>>> 
37187>>>>>>>Use Payresp.DD
INCLUDING FILE: PAYRESP.DD
37187>>>>>>>>>//DDB-FileStart
37187>>>>>>>>>//DDB-HeaderStart
37187>>>>>>>>>
37187>>>>>>>>>// File Name : PAYRESP.DD
37187>>>>>>>>>// Class Name: Payresp_DataDictionary
37187>>>>>>>>>// Revision  : 82
37187>>>>>>>>>// Version   : 2
37187>>>>>>>>>
37187>>>>>>>>>Use  Windows           // Basic Definitions
37187>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
37187>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
37187>>>>>>>>>
37187>>>>>>>>>Open Payresp
37189>>>>>>>>>Open Prspbank
INCLUDING FILE: PRSPBANK.FD
37191>>>>>>>>>Open Tppresp
INCLUDING FILE: TPPRESP.FD
37193>>>>>>>>>Open Clients
37195>>>>>>>>>Open Sysrecc
37197>>>>>>>>>Open Gmove
37199>>>>>>>>>Open Sysrecg
37201>>>>>>>>>
37201>>>>>>>>>//DDB-HeaderEnd
37201>>>>>>>>>//DDB-ValidationStart
37201>>>>>>>>>
37201>>>>>>>>>Register_Object Payresp_Presp_Doy_VT
37201>>>>>>>>>Register_Object Payresp_Presp_Categfpa_VT
37201>>>>>>>>>Register_Object Payresp_Feregios_VT
37201>>>>>>>>>
37201>>>>>>>>>Object Payresp_Presp_Doy_VT  is a CodeValidationTable
37203>>>>>>>>>    Set Type_Value        To "DOY"
37204>>>>>>>>>    Set Allow_Blank_State To TRUE
37205>>>>>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
37206>>>>>>>>>    //DDB-ValidationCustomStart
37206>>>>>>>>>    //DDB-ValidationCustomEnd
37206>>>>>>>>>End_Object   // Payresp_Presp_Doy_VT
37207>>>>>>>>>
37207>>>>>>>>>Object Payresp_Presp_Categfpa_VT  is a CodeValidationTable
37209>>>>>>>>>    Set Type_Value        To "VAT_STATUS"
37210>>>>>>>>>    Set Validate_State    To FALSE
37211>>>>>>>>>    Set Allow_Blank_State To TRUE
37212>>>>>>>>>    //DDB-ValidationCustomStart
37212>>>>>>>>>    //DDB-ValidationCustomEnd
37212>>>>>>>>>End_Object   // Payresp_Presp_Categfpa_VT
37213>>>>>>>>>
37213>>>>>>>>>Object Payresp_Feregios_VT  is a CodeValidationTable
37215>>>>>>>>>    Set Type_Value        To "FEREGIOS"
37216>>>>>>>>>    Set Allow_Blank_State To TRUE
37217>>>>>>>>>    Set Table_Title       To "ƒœå¡«œª ”œ¨œšš¬æ«ž«˜ª ”¦¨âà¤"
37218>>>>>>>>>    //DDB-ValidationCustomStart
37218>>>>>>>>>    //DDB-ValidationCustomEnd
37218>>>>>>>>>End_Object   // Payresp_Feregios_VT
37219>>>>>>>>>//DDB-ValidationEnd
37219>>>>>>>>>//DDB-SelectionStart
37219>>>>>>>>>//DDB/ ExternalSelectionList sl111  sl111.SL
37219>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
37219>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
37219>>>>>>>>>Register_Object sl111
37219>>>>>>>>>Register_Object sl198
37219>>>>>>>>>Register_Object sl197
37219>>>>>>>>>//DDB-SelectionEnd
37219>>>>>>>>>
37219>>>>>>>>>Open Year
37221>>>>>>>>>
37221>>>>>>>>>Class Payresp_DataDictionary  is a DataDictionary_Sec
37222>>>>>>>>>
37222>>>>>>>>>    Procedure Construct_Object
37223>>>>>>>>>        Forward Send Construct_Object
37225>>>>>>>>>        Property Integer piCheckPlaf        Public 0
37226>>>>>>>>>        //------------------------------------------------
37226>>>>>>>>>        // Properties gia na kraththoun oi palies times
37226>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio
37226>>>>>>>>>        // einai 1     js 03/12/2007
37226>>>>>>>>>        //------------------------------------------------
37226>>>>>>>>>        Property Integer piCreateNew            Public  0
37227>>>>>>>>>        Property String  psAud_Old_Pelaths      Public ""
37228>>>>>>>>>        Property String  psAud_Old_PelathsN     Public ""
37229>>>>>>>>>        Property String  psAud_Old_AFM          Public ""
37230>>>>>>>>>        Property String  psAud_Old_DOY          Public ""
37231>>>>>>>>>        Property String  psAud_Old_DOYN         Public ""
37232>>>>>>>>>        Property Integer piAud_Old_HPAL         Public  0
37233>>>>>>>>>        Property Integer piAud_Old_HPSO         Public  0
37234>>>>>>>>>        Property String  psAud_Old_PartlRecr    Public ""
37235>>>>>>>>>        Property String  psAud_Old_PmsRecr      Public ""
37236>>>>>>>>>        //------------------------------------------------
37236>>>>>>>>>
37236>>>>>>>>>    End_procedure
37237>>>>>>>>>
37237>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
37238>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
37240>>>>>>>>>        //------------------------------------------------
37240>>>>>>>>>        // Properties gia na kraththoun oi palies times
37240>>>>>>>>>        // ton pedion js 03/12/2007
37240>>>>>>>>>        //------------------------------------------------
37240>>>>>>>>>        Set psAud_Old_Pelaths      to Payresp.Presp_ID
37241>>>>>>>>>        Set psAud_Old_PelathsN     to Payresp.Presp_Name
37242>>>>>>>>>        Set psAud_Old_AFM          to Payresp.Presp_AFM
37243>>>>>>>>>        Set psAud_Old_DOY          to Payresp.Presp_Doy
37244>>>>>>>>>        Set psAud_Old_DOYN         to (gsfCode_Mast("DOY",Payresp.Presp_Doy))
37245>>>>>>>>>        Set piAud_Old_HPAL         to Payresp.Stoxos_IPAL
37246>>>>>>>>>        Set piAud_Old_HPSO         to Payresp.Stoxos_IPSO
37247>>>>>>>>>        Set psAud_Old_PartlRecr    to Payresp.Presp_Recr
37248>>>>>>>>>        Set psAud_Old_PmsRecr      to Payresp.Presp_Recr
37249>>>>>>>>>        //------------------------------------------------
37249>>>>>>>>>     End_Procedure   // New_Current_Record
37250>>>>>>>>>
37250>>>>>>>>>    Procedure Delete_Main_File
37251>>>>>>>>>        //---------------------------------------------
37251>>>>>>>>>        // Auditing / Katagrafh allagon
37251>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
37252>>>>>>>>>        Date    dDate  Shmer
37252>>>>>>>>>        Integer iMin iHour iSec iLen
37252>>>>>>>>>        Sysdate dDate iHour iMin iSec
37256>>>>>>>>>        Move iHour  to sHour
37257>>>>>>>>>        Move iMin   to sMin
37258>>>>>>>>>        Move iSec   to sSec
37259>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
37263>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
37267>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
37271>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
37272>>>>>>>>>
37272>>>>>>>>>        // Auditing / Diagrafh
37272>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
37274>>>>>>>>>            Get fsLoginUserID to sUser
37275>>>>>>>>>            clear gmove
37276>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
37277>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
37278>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
37279>>>>>>>>>            move  3                     to gmove.gtypkin_code// Apo Clients
37280>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
37281>>>>>>>>>            move suser                  to gmove.gplan_code
37282>>>>>>>>>            move Payresp.Presp_Recr    to gmove.garticl_recr
37283>>>>>>>>>            reread sysrecg
37287>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
37288>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
37289>>>>>>>>>            saverecord sysrecg
37290>>>>>>>>>            unlock
37291>>>>>>>>>>
37291>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
37292>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
37293>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs
37294>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
37295>>>>>>>>>
37295>>>>>>>>>            Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
37296>>>>>>>>>            Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
37297>>>>>>>>>            Move (psAud_Old_AFM      (Self))    to Gmove.Prev_AFM
37298>>>>>>>>>            Move (psAud_Old_DOY      (Self))    to Gmove.Prev_Doy
37299>>>>>>>>>            Move (psAud_Old_DOYN     (Self))    to Gmove.Txt3
37300>>>>>>>>>            Move (piAud_Old_HPAL     (Self))    to Gmove.Prev_Stoxos1
37301>>>>>>>>>            Move (piAud_Old_HPSO     (Self))    to Gmove.Prev_Stoxos2
37302>>>>>>>>>
37302>>>>>>>>>
37302>>>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª “§œ¬Ÿç¤¦¬ ¢ž¨à£é¤"     to gmove.gmove_aitiol
37303>>>>>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
37304>>>>>>>>>            saverecord gmove
37305>>>>>>>>>        End
37305>>>>>>>>>>
37305>>>>>>>>>        Forward Send Delete_Main_File
37307>>>>>>>>>
37307>>>>>>>>>    End_Procedure
37308>>>>>>>>>
37308>>>>>>>>>    Procedure Update
37309>>>>>>>>>        Forward Send Update
37311>>>>>>>>>        Move SysCurXR.Company_Code  to payresp.Company_Code
37312>>>>>>>>>        Move SysCurXR.Branch_Code   to payresp.Branch_Code
37313>>>>>>>>>        Move SysCurXR.Year_Year     to payresp.Year_Year
37314>>>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
37314>>>>>>>>>        Move (payresp.Xreosh-payresp.Pistosh)   to payresp.Ypoloipo
37315>>>>>>>>>        Move (payresp.Plafon-payresp.ypoloipo)  to payresp.Overhead
37316>>>>>>>>>
37316>>>>>>>>>        //betolink
37316>>>>>>>>>        Move SysCurXR.Beto_Site      to payresp.presp_SiteW
37317>>>>>>>>>        Move payresp.presp_Rec0      to payresp.presp_SN
37318>>>>>>>>>        Move payresp.presp_id        to payresp.presp_Repm
37319>>>>>>>>>
37319>>>>>>>>>        //---------------------------------------------
37319>>>>>>>>>        // Auditing / Katagrafh allagon
37319>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
37320>>>>>>>>>        Date    dDate  Shmer
37320>>>>>>>>>        Integer iMin iHour iSec iLen
37320>>>>>>>>>        Sysdate dDate iHour iMin iSec
37324>>>>>>>>>        Move iHour  to sHour
37325>>>>>>>>>        Move iMin   to sMin
37326>>>>>>>>>        Move iSec   to sSec
37327>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
37331>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
37335>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
37339>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
37340>>>>>>>>>
37340>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
37340>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
37342>>>>>>>>>            Get fsLoginUserID to sUser
37343>>>>>>>>>            If (piCreateNew(Self)=1) Begin
37345>>>>>>>>>                clear gmove
37346>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
37347>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
37348>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
37349>>>>>>>>>                move  3                     to gmove.gtypkin_code// Apo Clients
37350>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
37351>>>>>>>>>                move suser                  to gmove.gplan_code
37352>>>>>>>>>                move Payresp.Presp_Recr     to gmove.garticl_recr
37353>>>>>>>>>                reread sysrecg
37357>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
37358>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
37359>>>>>>>>>                saverecord sysrecg
37360>>>>>>>>>                unlock
37361>>>>>>>>>>
37361>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
37362>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
37363>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
37364>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
37365>>>>>>>>>                Move Payresp.Presp_ID               to Gmove.Cur_ID
37366>>>>>>>>>                Move Payresp.Presp_Name             to Gmove.Cur_Name
37367>>>>>>>>>                Move Payresp.Presp_Recr             to Gmove.Partl_Recr 
37368>>>>>>>>>                Move Payresp.Presp_Recr             to Gmove.Pms_Recr          
37369>>>>>>>>>                Move Payresp.Presp_AFM              to Gmove.Cur_AFM
37370>>>>>>>>>                Move Payresp.Presp_DOY              to Gmove.Cur_DOY
37371>>>>>>>>>                Move (gsfCode_Mast("DOY",Payresp.Presp_Doy)) to Gmove.Txt4
37372>>>>>>>>>                Move Payresp.Stoxos_IPAL            to Gmove.Prev_Stoxos1
37373>>>>>>>>>                Move Payresp.Stoxos_IPSO            to Gmove.Prev_Stoxos2
37374>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â¦¬ “§œ¬Ÿç¤¦¬ ¢ž¨à£é¤" to Gmove.Gmove_Aitiol
37375>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs
37376>>>>>>>>>                saverecord gmove
37377>>>>>>>>>                Set piCreateNew to 0
37378>>>>>>>>>            End
37378>>>>>>>>>>
37378>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
37381>>>>>>>>>                Integer isChanged
37381>>>>>>>>>                Move 0 to isChanged
37382>>>>>>>>>                
37382>>>>>>>>>                     If (psAud_Old_Pelaths  (Self)<>Payresp.Presp_ID   ) Move 1 to isChanged
37385>>>>>>>>>                Else If (psAud_Old_PelathsN (Self)<>Payresp.Presp_Name ) Move 1 to isChanged
37389>>>>>>>>>                Else If (psAud_Old_AFM      (Self)<>Payresp.Presp_AFM  ) Move 1 to isChanged
37393>>>>>>>>>                Else If (psAud_Old_DOY      (Self)<>Payresp.Presp_DOY  ) Move 1 to isChanged
37397>>>>>>>>>                Else If (piAud_Old_HPAL     (Self)<>Payresp.Stoxos_IPAL) Move 1 to isChanged
37401>>>>>>>>>                Else If (piAud_Old_HPSO     (Self)<>Payresp.Stoxos_IPSO) Move 1 to isChanged
37405>>>>>>>>>                
37405>>>>>>>>>                If (isChanged>0) Begin  
37407>>>>>>>>>                    clear gmove
37408>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
37409>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
37410>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
37411>>>>>>>>>                    move  3                     to gmove.gtypkin_code// Apo Clients
37412>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
37413>>>>>>>>>                    move suser                  to gmove.gplan_code
37414>>>>>>>>>                    move Payresp.Presp_Recr    to gmove.garticl_recr
37415>>>>>>>>>                    reread sysrecg
37419>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
37420>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
37421>>>>>>>>>                    saverecord sysrecg
37422>>>>>>>>>                    unlock
37423>>>>>>>>>>
37423>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
37424>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
37425>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
37426>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
37427>>>>>>>>>                    Move Payresp.Presp_Recr             to Gmove.Partl_Recr 
37428>>>>>>>>>                    Move Payresp.Presp_Recr             to Gmove.Pms_Recr          
37429>>>>>>>>>                    //--
37429>>>>>>>>>                    Move Payresp.Presp_ID               to Gmove.Cur_ID
37430>>>>>>>>>                    Move Payresp.Presp_Name             to Gmove.Cur_Name
37431>>>>>>>>>                    Move Payresp.Presp_AFM              to Gmove.Cur_AFM
37432>>>>>>>>>                    Move Payresp.Presp_DOY              to Gmove.Cur_DOY
37433>>>>>>>>>                    Move (gsfCode_Mast("DOY",Payresp.Presp_Doy)) to Gmove.Txt4
37434>>>>>>>>>                    Move Payresp.Stoxos_IPAL            to Gmove.Prev_Stoxos1
37435>>>>>>>>>                    Move Payresp.Stoxos_IPSO            to Gmove.Prev_Stoxos2
37436>>>>>>>>>                    //--
37436>>>>>>>>>                    Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
37437>>>>>>>>>                    Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
37438>>>>>>>>>                    Move (psAud_Old_AFM      (Self))    to Gmove.Prev_AFM
37439>>>>>>>>>                    Move (psAud_Old_DOY      (Self))    to Gmove.Prev_Doy 
37440>>>>>>>>>                    Move (psAud_Old_DOYN     (Self))    to Gmove.Txt3
37441>>>>>>>>>                    Move (piAud_Old_HPAL     (Self))    to Gmove.Prev_Stoxos1
37442>>>>>>>>>                    Move (piAud_Old_HPSO     (Self))    to Gmove.Prev_Stoxos2
37443>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª “§œ¬Ÿç¤¦¬ ¢ž¨à£é¤"  to gmove.gmove_aitiol
37444>>>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
37445>>>>>>>>>                    saverecord gmove
37446>>>>>>>>>                    Set piCreateNew to 0
37447>>>>>>>>>                End
37447>>>>>>>>>>
37447>>>>>>>>>            End
37447>>>>>>>>>>
37447>>>>>>>>>        End
37447>>>>>>>>>>
37447>>>>>>>>>
37447>>>>>>>>>    End_Procedure   // Update
37448>>>>>>>>>
37448>>>>>>>>>     Procedure Creating
37449>>>>>>>>>        Forward Send Creating
37451>>>>>>>>>        // Insert Code Here
37451>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(payresp.presp_Rec0))))));                                    to payresp.presp_Recr
37452>>>>>>>>>        Move '1'                    to payresp.presp_Active
37453>>>>>>>>>        get fsgCode_With_Zeroes payresp.presp_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to payresp.presp_ID
37454>>>>>>>>>        clear year
37455>>>>>>>>>        move syscurxr.branch_code   to year.branch_code
37456>>>>>>>>>        move syscurxr.company_code  to year.company_code
37457>>>>>>>>>        move syscurxr.year_year     to YEAR.year_year
37458>>>>>>>>>        find eq year by index.1
37459>>>>>>>>>>
37459>>>>>>>>>        if (found=1) begin
37461>>>>>>>>>            move year.payresp_plafon to payresp.plafon
37462>>>>>>>>>            move year.payresp_ofeilh to payresp.orio_syn_ofeilh
37463>>>>>>>>>        end
37463>>>>>>>>>>
37463>>>>>>>>>        Set piCreateNew to 1
37464>>>>>>>>>    End_Procedure   // Creating
37465>>>>>>>>>
37465>>>>>>>>>   Function Validate_Save  Returns Integer
37466>>>>>>>>>        Integer iReturnVal iCheck iYes
37467>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
37469>>>>>>>>>        If (Not(iReturnVal)) Begin
37471>>>>>>>>>
37471>>>>>>>>>            If (Sysfile.Check_Afm=1) Begin
37473>>>>>>>>>                Move (Check_AFM(payresp.presp_Afm)) to iCheck
37474>>>>>>>>>                If (iCheck) Begin
37476>>>>>>>>>                         If (iCheck=1) Move 4001 to iReturnVal
37479>>>>>>>>>                    Else If (iCheck=2) Move 4002 to iReturnVal
37483>>>>>>>>>                    Else If (iCheck=3) Move 4003 to iReturnVal
37487>>>>>>>>>                End
37487>>>>>>>>>>
37487>>>>>>>>>            End
37487>>>>>>>>>>
37487>>>>>>>>>
37487>>>>>>>>>           If (piCheckPlaf(Self)=1) Begin
37489>>>>>>>>>                If ((PayResp.Plafon>0) And ((PayResp.Ypoloipo+PayResp.Posa_Apo_Dap)>PayResp.Plafon)) Begin
37491>>>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 5000 Payresp'  to iYes
37492>>>>>>>>>                        If (iYes=MBR_NO) Error 4004 'DDC111: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4004 to iReturnVal
37495>>>>>>>>>                End
37495>>>>>>>>>>
37495>>>>>>>>>                Else If ((PayResp.Orio_Syn_Ofeilh>0) And (PayResp.Synolikh_Ofeilh>PayResp.Orio_Syn_Ofeilh)) Begin
37498>>>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 5001 Payresp' to iYes
37499>>>>>>>>>                        If (iYes=MBR_NO) Error 4005 'DDC111: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
37502>>>>>>>>>                End
37502>>>>>>>>>>
37502>>>>>>>>>           End
37502>>>>>>>>>>
37502>>>>>>>>>        If (iReturnVal) Send Operation_Not_Allowed iReturnVal
37505>>>>>>>>>        End
37505>>>>>>>>>>
37505>>>>>>>>>        Function_Return iReturnVal
37506>>>>>>>>>    End_Function   // Validate_Save
37507>>>>>>>>>
37507>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
37508>>>>>>>>>        String lsError_Message
37509>>>>>>>>>        Case Begin
37509>>>>>>>>>            Case (iError_Num = 4001)
37511>>>>>>>>>                Move "DDC 100: Š˜¤Ÿ˜©£â¤¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤" to lsError_Message
37512>>>>>>>>>              Case Break
37513>>>>>>>>>            Case (iError_Num = 4002)
37516>>>>>>>>>                Move "DDC 100: ’¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤ ›œ¤ œå¤˜  9 ¯ã­ ¦" to lsError_Message
37517>>>>>>>>>              Case Break
37518>>>>>>>>>            Case (iError_Num = 4003)
37521>>>>>>>>>                Move "DDC 100: €¡˜«á¢¢ž¢¦ª ®˜¨˜¡«ã¨˜ª ©«¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤ " to lsError_Message
37522>>>>>>>>>              Case Break
37523>>>>>>>>>            Case (iError_Num = 4004)
37526>>>>>>>>>                Move "DDC 100: „š ¤œ ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç" to lsError_Message
37527>>>>>>>>>              Case Break
37528>>>>>>>>>            Case (iError_Num = 4005)
37531>>>>>>>>>                Move "DDC 100: „š ¤œ ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª" to lsError_Message
37532>>>>>>>>>              Case Break
37533>>>>>>>>>            Case Else
37533>>>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
37535>>>>>>>>>        Case End
37535>>>>>>>>>        Error iError_Num lsError_Message
37536>>>>>>>>>>
37536>>>>>>>>>    End_Procedure // operation_not_allowed
37537>>>>>>>>>
37537>>>>>>>>>
37537>>>>>>>>>
37537>>>>>>>>>    Procedure Define_Fields
37538>>>>>>>>>        Forward Send Define_Fields
37540>>>>>>>>>        //DDB-Generated-Code-Location
37540>>>>>>>>>        //DDB-DefineFieldStart
37540>>>>>>>>>
37540>>>>>>>>>        Set Main_File            To Payresp.File_Number
37541>>>>>>>>>        Set Cascade_Delete_State To FALSE
37542>>>>>>>>>
37542>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
37543>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
37544>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
37545>>>>>>>>>
37545>>>>>>>>>        // Child (Client) file structure................
37545>>>>>>>>>        Send Add_Client_File  Prspbank.File_Number
37546>>>>>>>>>        Send Add_Client_File  Tppresp.File_Number
37547>>>>>>>>>        Send Add_Client_File  Clients.File_Number
37548>>>>>>>>>
37548>>>>>>>>>        // External (System) file structure.............
37548>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
37549>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
37550>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
37551>>>>>>>>>
37551>>>>>>>>>        Define_Auto_Increment  Sysrecc.Payresp_Rec0  To Payresp.Presp_Rec0
37554>>>>>>>>>
37554>>>>>>>>>        // Field-based properties.......................
37554>>>>>>>>>
37554>>>>>>>>>        // Payresp.Company_Code
37554>>>>>>>>>
37554>>>>>>>>>        // Payresp.Branch_Code
37554>>>>>>>>>
37554>>>>>>>>>        // Payresp.Year_Year
37554>>>>>>>>>
37554>>>>>>>>>        // Payresp.Custprom_Code
37554>>>>>>>>>
37554>>>>>>>>>        // Payresp.Presp_Id
37554>>>>>>>>>        Set Field_Options          Field Payresp.Presp_Id To DD_AUTOFIND    DD_NOPUT      
37555>>>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Id To (sl111(Self))
37556>>>>>>>>>        Set Key_Field_State        Field Payresp.Presp_Id To TRUE
37557>>>>>>>>>
37557>>>>>>>>>        // Payresp.Presp_Name
37557>>>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Name To (sl111(Self))
37558>>>>>>>>>
37558>>>>>>>>>        // Payresp.Presp_Afm
37558>>>>>>>>>
37558>>>>>>>>>        // Payresp.Presp_Rec0
37558>>>>>>>>>
37558>>>>>>>>>        // Payresp.Custprom_Recr
37558>>>>>>>>>
37558>>>>>>>>>        // Payresp.Presp_Recr
37558>>>>>>>>>
37558>>>>>>>>>        // Payresp.Last_Xreosh
37558>>>>>>>>>
37558>>>>>>>>>        // Payresp.Last_Pistosh
37558>>>>>>>>>
37558>>>>>>>>>        // Payresp.Last_Order
37558>>>>>>>>>
37558>>>>>>>>>        // Payresp.Presp_Doy
37558>>>>>>>>>        Set Field_Value_Table      Field Payresp.Presp_Doy To (Payresp_Presp_Doy_VT(Self))
37559>>>>>>>>>
37559>>>>>>>>>        // Payresp.Presp_Address
37559>>>>>>>>>
37559>>>>>>>>>        // Payresp.Presp_City_Id
37559>>>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_City_Id To (sl198(Self))
37560>>>>>>>>>
37560>>>>>>>>>        // Payresp.Presp_Area
37560>>>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Area To (sl197(Self))
37561>>>>>>>>>
37561>>>>>>>>>        // Payresp.Presp_Job
37561>>>>>>>>>
37561>>>>>>>>>        // Payresp.Presp_Respons
37561>>>>>>>>>
37561>>>>>>>>>        // Payresp.Presp_Zipcode
37561>>>>>>>>>
37561>>>>>>>>>        // Payresp.Presp_Phone
37561>>>>>>>>>
37561>>>>>>>>>        // Payresp.Presp_Fax
37561>>>>>>>>>
37561>>>>>>>>>        // Payresp.Presp_Mobile
37561>>>>>>>>>
37561>>>>>>>>>        // Payresp.Presp_Aoh
37561>>>>>>>>>
37561>>>>>>>>>        // Payresp.Presp_Email
37561>>>>>>>>>
37561>>>>>>>>>        // Payresp.Presp_Class
37561>>>>>>>>>
37561>>>>>>>>>        // Payresp.Presp_Details
37561>>>>>>>>>
37561>>>>>>>>>        // Payresp.Presp_Sitew
37561>>>>>>>>>
37561>>>>>>>>>        // Payresp.Presp_Codem
37561>>>>>>>>>
37561>>>>>>>>>        // Payresp.Presp_Categfpa
37561>>>>>>>>>        Set Field_Value_Table      Field Payresp.Presp_Categfpa To (Payresp_Presp_Categfpa_VT(Self))
37562>>>>>>>>>
37562>>>>>>>>>        // Payresp.Presp_Fpa
37562>>>>>>>>>
37562>>>>>>>>>        // Payresp.Presp_Public
37562>>>>>>>>>
37562>>>>>>>>>        // Payresp.Presp_Sn
37562>>>>>>>>>
37562>>>>>>>>>        // Payresp.Presp_Repm
37562>>>>>>>>>
37562>>>>>>>>>        // Payresp.Presp_Active
37562>>>>>>>>>
37562>>>>>>>>>        // Payresp.Presp_Reported
37562>>>>>>>>>
37562>>>>>>>>>        // Payresp.Presp_Pelprom
37562>>>>>>>>>
37562>>>>>>>>>        // Payresp.Presp_Lastupd
37562>>>>>>>>>
37562>>>>>>>>>        // Payresp.Presp_Markexp
37562>>>>>>>>>
37562>>>>>>>>>        // Payresp.Presp_Catjob
37562>>>>>>>>>
37562>>>>>>>>>        // Payresp.Is_Promhtheyths
37562>>>>>>>>>
37562>>>>>>>>>        // Payresp.Xreosh
37562>>>>>>>>>
37562>>>>>>>>>        // Payresp.Pistosh
37562>>>>>>>>>
37562>>>>>>>>>        // Payresp.Ypoloipo
37562>>>>>>>>>
37562>>>>>>>>>        // Payresp.Plafon
37562>>>>>>>>>
37562>>>>>>>>>        // Payresp.Overhead
37562>>>>>>>>>
37562>>>>>>>>>        // Payresp.Presp_Add_No
37562>>>>>>>>>
37562>>>>>>>>>        // Payresp.Presp_Nomos
37562>>>>>>>>>
37562>>>>>>>>>        // Payresp.Presp_Xora
37562>>>>>>>>>
37562>>>>>>>>>        // Payresp.Polh_Recr
37562>>>>>>>>>
37562>>>>>>>>>        // Payresp.Synolikh_Ofeilh
37562>>>>>>>>>
37562>>>>>>>>>        // Payresp.Stoxos_Ipal
37562>>>>>>>>>
37562>>>>>>>>>        // Payresp.Stoxos_Ipso
37562>>>>>>>>>
37562>>>>>>>>>        // Payresp.Poso_Se_Apait
37562>>>>>>>>>
37562>>>>>>>>>        // Payresp.Orio_Syn_Ofeilh
37562>>>>>>>>>
37562>>>>>>>>>        // Payresp.Posa_Apo_Dap
37562>>>>>>>>>
37562>>>>>>>>>        // Payresp.Feregios
37562>>>>>>>>>        Set Field_Value_Table      Field Payresp.Feregios To (Payresp_Feregios_VT(Self))
37563>>>>>>>>>
37563>>>>>>>>>        //DDB-DefineFieldEnd
37563>>>>>>>>>    End_Procedure    // Define_Fields
37564>>>>>>>>>
37564>>>>>>>>>    // Field_Defaults:
37564>>>>>>>>>    // This procedure is used to establish default field values.
37564>>>>>>>>>
37564>>>>>>>>>    Procedure Field_Defaults
37565>>>>>>>>>        Forward Send Field_Defaults
37567>>>>>>>>>        //DDB-Generated-Code-Location
37567>>>>>>>>>        //DDB-FieldDefaultStart
37567>>>>>>>>>        Set Field_Changed_Value   Field Payresp.Presp_Doy To "0"
37568>>>>>>>>>        //DDB-FieldDefaultEnd
37568>>>>>>>>>    End_Procedure    // Field_Defaults
37569>>>>>>>>>
37569>>>>>>>>>End_Class    // Payresp_DataDictionary
37570>>>>>>>>>//DDB-Selection-pkg-Start
37570>>>>>>>>>
37570>>>>>>>>>Use sl111.SL         // sl111
INCLUDING FILE: SL111.SL
37570>>>>>>>>>>>//AB/ Project sl111
37570>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
37570>>>>>>>>>>>//AB/     Set ProjectName to "sl111"
37570>>>>>>>>>>>//AB/     Set ProjectFileName to "sl111.SL"
37570>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
37570>>>>>>>>>>>
37570>>>>>>>>>>>// Project Object Structure
37570>>>>>>>>>>>//   sl111 is a dbModalPanelSub
37570>>>>>>>>>>>//     Payresp_DD is a DataDictionary
37570>>>>>>>>>>>//     oSelList is a dbListSub
37570>>>>>>>>>>>//     oOK_bn is a ButtonSub
37570>>>>>>>>>>>//     oCancel_bn is a ButtonSub
37570>>>>>>>>>>>//     oSearch_bn is a ButtonSub
37570>>>>>>>>>>>
37570>>>>>>>>>>>// Register all objects
37570>>>>>>>>>>>Register_Object oCancel_bn
37570>>>>>>>>>>>Register_Object oOK_bn
37570>>>>>>>>>>>Register_Object oSearch_bn
37570>>>>>>>>>>>Register_Object oSelList
37570>>>>>>>>>>>Register_Object Payresp_DD
37570>>>>>>>>>>>Register_Object sl111
37570>>>>>>>>>>>
37570>>>>>>>>>>>
37570>>>>>>>>>>>//AB-IgnoreStart
37570>>>>>>>>>>>
37570>>>>>>>>>>>Use DFAllEnt.pkg
37570>>>>>>>>>>>Use dbList.Sub
37570>>>>>>>>>>>Use Button.Sub
37570>>>>>>>>>>>
37570>>>>>>>>>>>
37570>>>>>>>>>>>Use PAYRESP.DD
37570>>>>>>>>>>>
37570>>>>>>>>>>>//AB-IgnoreEnd
37570>>>>>>>>>>>
37570>>>>>>>>>>>Object sl111 is a dbModalPanelSub
37572>>>>>>>>>>>    Set Label to "“§œçŸ¬¤¦  ¢ž¨à£é¤ "
37573>>>>>>>>>>>    Set Size to 148 443
37574>>>>>>>>>>>    Set Location to 4 5
37575>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
37576>>>>>>>>>>>    Set Modal_State to FALSE
37577>>>>>>>>>>>
37577>>>>>>>>>>>    //AB-DDOStart
37577>>>>>>>>>>>
37577>>>>>>>>>>>    Object Payresp_DD is a Payresp_DataDictionary
37579>>>>>>>>>>>    End_Object    // Payresp_DD
37580>>>>>>>>>>>
37580>>>>>>>>>>>    Set Main_DD to (Payresp_DD(self))
37581>>>>>>>>>>>    Set Server to (Payresp_DD(self))
37582>>>>>>>>>>>
37582>>>>>>>>>>>    //AB-DDOEnd
37582>>>>>>>>>>>
37582>>>>>>>>>>>    Object oSelList is a dbListSub
37584>>>>>>>>>>>        Set Main_File to Payresp.File_Number
37585>>>>>>>>>>>        Set Size to 105 430
37586>>>>>>>>>>>        Set Location to 6 6
37587>>>>>>>>>>>
37587>>>>>>>>>>>        Begin_Row
37590>>>>>>>>>>>            Entry_Item Payresp.Presp_id
37591>>>>>>>>>>>            Entry_Item Payresp.Presp_name
37592>>>>>>>>>>>            Entry_Item Payresp.Presp_afm
37593>>>>>>>>>>>            Entry_Item Payresp.Presp_address
37594>>>>>>>>>>>            Entry_Item Payresp.Presp_phone
37595>>>>>>>>>>>        End_Row
37600>>>>>>>>>>>
37600>>>>>>>>>>>        Set Form_Width    item 0 to 60
37601>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
37602>>>>>>>>>>>        
37602>>>>>>>>>>>        Set Form_Width    item 1 to 106
37603>>>>>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
37604>>>>>>>>>>>        
37604>>>>>>>>>>>        Set Form_Width    item 2 to 60
37605>>>>>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
37606>>>>>>>>>>>        
37606>>>>>>>>>>>        Set Form_Width    item 3 to 135
37607>>>>>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
37608>>>>>>>>>>>        
37608>>>>>>>>>>>        Set Form_Width    item 4 to 60
37609>>>>>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
37610>>>>>>>>>>>        
37610>>>>>>>>>>>    End_Object    // oSelList
37611>>>>>>>>>>>
37611>>>>>>>>>>>    Object oOK_bn is a ButtonSub
37613>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
37614>>>>>>>>>>>        Set Location to 113 277
37615>>>>>>>>>>>
37615>>>>>>>>>>>        //AB-StoreStart
37615>>>>>>>>>>>        Procedure OnClick
37617>>>>>>>>>>>            Send OK To (oSelList(current_object))
37618>>>>>>>>>>>        End_Procedure
37619>>>>>>>>>>>        //AB-StoreEnd
37619>>>>>>>>>>>
37619>>>>>>>>>>>    End_Object    // oOK_bn
37620>>>>>>>>>>>
37620>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
37622>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
37623>>>>>>>>>>>        Set Location to 113 332
37624>>>>>>>>>>>
37624>>>>>>>>>>>        //AB-StoreStart
37624>>>>>>>>>>>        Procedure OnClick
37626>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
37627>>>>>>>>>>>        End_Procedure
37628>>>>>>>>>>>        //AB-StoreEnd
37628>>>>>>>>>>>
37628>>>>>>>>>>>    End_Object    // oCancel_bn
37629>>>>>>>>>>>
37629>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
37631>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
37632>>>>>>>>>>>        Set Location to 113 387
37633>>>>>>>>>>>
37633>>>>>>>>>>>        //AB-StoreStart
37633>>>>>>>>>>>        Procedure OnClick
37635>>>>>>>>>>>            Send Search To (oSelList(current_object))
37636>>>>>>>>>>>        End_Procedure
37637>>>>>>>>>>>        //AB-StoreEnd
37637>>>>>>>>>>>
37637>>>>>>>>>>>    End_Object    // oSearch_bn
37638>>>>>>>>>>>
37638>>>>>>>>>>>
37638>>>>>>>>>>>    //AB-StoreStart
37638>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
37639>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
37640>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
37641>>>>>>>>>>>    //AB-StoreEnd
37641>>>>>>>>>>>
37641>>>>>>>>>>>End_Object    // sl111
37642>>>>>>>>>>>
37642>>>>>>>>>>>//AB/ End_Object    // prj
37642>>>>>>>>>Use sl198.sl         // sl198
INCLUDING FILE: SL198.SL
37642>>>>>>>>>>>//AB/ Project sl198:cities
37642>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
37642>>>>>>>>>>>//AB/     Set ProjectName to "sl198:cities"
37642>>>>>>>>>>>//AB/     Set ProjectFileName to "sl198.SL"
37642>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
37642>>>>>>>>>>>
37642>>>>>>>>>>>// Project Object Structure
37642>>>>>>>>>>>//   sl198 is a dbModalPanelSub
37642>>>>>>>>>>>//     Cities_DD is a DataDictionary
37642>>>>>>>>>>>//     oSelList is a dbListSub
37642>>>>>>>>>>>//     oOK_bn is a ButtonSub
37642>>>>>>>>>>>//     oCancel_bn is a ButtonSub
37642>>>>>>>>>>>//     oSearch_bn is a ButtonSub
37642>>>>>>>>>>>
37642>>>>>>>>>>>// Register all objects
37642>>>>>>>>>>>Register_Object Cities_DD
37642>>>>>>>>>>>Register_Object oCancel_bn
37642>>>>>>>>>>>Register_Object oOK_bn
37642>>>>>>>>>>>Register_Object oSearch_bn
37642>>>>>>>>>>>Register_Object oSelList
37642>>>>>>>>>>>Register_Object sl198
37642>>>>>>>>>>>
37642>>>>>>>>>>>
37642>>>>>>>>>>>//AB-IgnoreStart
37642>>>>>>>>>>>
37642>>>>>>>>>>>Use DFAllEnt.pkg
37642>>>>>>>>>>>Use dbList.Sub
37642>>>>>>>>>>>Use Button.Sub
37642>>>>>>>>>>>
37642>>>>>>>>>>>
37642>>>>>>>>>>>Use CITIES.DD
INCLUDING FILE: CITIES.DD
37642>>>>>>>>>>>>>//DDB-FileStart
37642>>>>>>>>>>>>>//DDB-HeaderStart
37642>>>>>>>>>>>>>
37642>>>>>>>>>>>>>// File Name : CITIES.DD
37642>>>>>>>>>>>>>// Class Name: Cities_DataDictionary
37642>>>>>>>>>>>>>// Revision  : 14
37642>>>>>>>>>>>>>// Version   : 2
37642>>>>>>>>>>>>>
37642>>>>>>>>>>>>>Use  Windows           // Basic Definitions
37642>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
37642>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
37642>>>>>>>>>>>>>
37642>>>>>>>>>>>>>Open Cities
37644>>>>>>>>>>>>>Open Clients
37646>>>>>>>>>>>>>Open Towns
37648>>>>>>>>>>>>>
37648>>>>>>>>>>>>>//DDB-HeaderEnd
37648>>>>>>>>>>>>>//DDB-SelectionStart
37648>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.SL
37648>>>>>>>>>>>>>Register_Object sl198
37648>>>>>>>>>>>>>//DDB-SelectionEnd
37648>>>>>>>>>>>>>
37648>>>>>>>>>>>>>Class Cities_DataDictionary  is a DataDictionary_Sec
37649>>>>>>>>>>>>>
37649>>>>>>>>>>>>>    // Define_Fields:
37649>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
37649>>>>>>>>>>>>>
37649>>>>>>>>>>>>>    Procedure Define_Fields
37650>>>>>>>>>>>>>        Forward Send Define_Fields
37652>>>>>>>>>>>>>        //DDB-Generated-Code-Location
37652>>>>>>>>>>>>>        //DDB-DefineFieldStart
37652>>>>>>>>>>>>>
37652>>>>>>>>>>>>>        Set Main_File            To Cities.File_Number
37653>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
37654>>>>>>>>>>>>>
37654>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
37655>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
37656>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
37657>>>>>>>>>>>>>
37657>>>>>>>>>>>>>        // Child (Client) file structure................
37657>>>>>>>>>>>>>        Send Add_Client_File  Clients.File_Number
37658>>>>>>>>>>>>>
37658>>>>>>>>>>>>>        // Parent (Server) file structure...............
37658>>>>>>>>>>>>>        Send Add_Server_File  Towns.File_Number
37659>>>>>>>>>>>>>
37659>>>>>>>>>>>>>        // Field-based properties.......................
37659>>>>>>>>>>>>>
37659>>>>>>>>>>>>>        // Cities.City_Id
37659>>>>>>>>>>>>>        Set Field_Options          Field Cities.City_Id To DD_AUTOFIND   
37660>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cities.City_Id To (sl198(Self))
37661>>>>>>>>>>>>>        Set Key_Field_State        Field Cities.City_Id To TRUE
37662>>>>>>>>>>>>>
37662>>>>>>>>>>>>>        // Cities.City_Descr
37662>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cities.City_Descr To (sl198(Self))
37663>>>>>>>>>>>>>
37663>>>>>>>>>>>>>        // Cities.Town_Id
37663>>>>>>>>>>>>>
37663>>>>>>>>>>>>>        //DDB-DefineFieldEnd
37663>>>>>>>>>>>>>    End_Procedure    // Define_Fields
37664>>>>>>>>>>>>>
37664>>>>>>>>>>>>>    // Field_Defaults:
37664>>>>>>>>>>>>>    // This procedure is used to establish default field values.
37664>>>>>>>>>>>>>
37664>>>>>>>>>>>>>    Procedure Field_Defaults
37665>>>>>>>>>>>>>        Forward Send Field_Defaults
37667>>>>>>>>>>>>>        //DDB-Generated-Code-Location
37667>>>>>>>>>>>>>        //DDB-FieldDefaultStart
37667>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
37667>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
37668>>>>>>>>>>>>>
37668>>>>>>>>>>>>>End_Class    // Cities_DataDictionary
37669>>>>>>>>>>>>>//DDB-Selection-pkg-Start
37669>>>>>>>>>>>>>
37669>>>>>>>>>>>>>Use sl198.SL         // sl198
37669>>>>>>>>>>>>>
37669>>>>>>>>>>>>>//DDB-Selection-pkg-End
37669>>>>>>>>>>>>>//DDB-FileEnd
37669>>>>>>>>>>>
37669>>>>>>>>>>>//AB-IgnoreEnd
37669>>>>>>>>>>>
37669>>>>>>>>>>>Object sl198 is a dbModalPanelSub
37671>>>>>>>>>>>    Set Label to "€¨®œå¦ æ¢œà¤"
37672>>>>>>>>>>>    Set Size to 148 297
37673>>>>>>>>>>>    Set Location to 4 5
37674>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
37675>>>>>>>>>>>    Set Modal_State to FALSE
37676>>>>>>>>>>>
37676>>>>>>>>>>>    //AB-DDOStart
37676>>>>>>>>>>>
37676>>>>>>>>>>>    Object Cities_DD is a Cities_DataDictionary
37678>>>>>>>>>>>
37678>>>>>>>>>>>        //AB-StoreStart
37678>>>>>>>>>>>                
37678>>>>>>>>>>>                
37678>>>>>>>>>>>        //AB-StoreEnd
37678>>>>>>>>>>>
37678>>>>>>>>>>>    End_Object    // Cities_DD
37679>>>>>>>>>>>
37679>>>>>>>>>>>    Set Main_DD to (Cities_DD(self))
37680>>>>>>>>>>>    Set Server to (Cities_DD(self))
37681>>>>>>>>>>>
37681>>>>>>>>>>>    //AB-DDOEnd
37681>>>>>>>>>>>
37681>>>>>>>>>>>    Object oSelList is a dbListSub
37683>>>>>>>>>>>        Set Main_File to Cities.File_Number
37684>>>>>>>>>>>        Set Size to 105 280
37685>>>>>>>>>>>        Set Location to 6 6
37686>>>>>>>>>>>
37686>>>>>>>>>>>        Begin_Row
37689>>>>>>>>>>>            Entry_Item Cities.City_id
37690>>>>>>>>>>>            Entry_Item Cities.City_descr
37691>>>>>>>>>>>        End_Row
37696>>>>>>>>>>>
37696>>>>>>>>>>>        Set Form_Width    item 0 to 50
37697>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
37698>>>>>>>>>>>        
37698>>>>>>>>>>>        Set Form_Width    item 1 to 221
37699>>>>>>>>>>>        Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
37700>>>>>>>>>>>        
37700>>>>>>>>>>>
37700>>>>>>>>>>>        //AB-StoreStart
37700>>>>>>>>>>>        
37700>>>>>>>>>>>        Set Column_Option Item 0 to NoEnter True
37701>>>>>>>>>>>        
37701>>>>>>>>>>>        
37701>>>>>>>>>>>        
37701>>>>>>>>>>>        
37701>>>>>>>>>>>        
37701>>>>>>>>>>>        //AB-StoreEnd
37701>>>>>>>>>>>
37701>>>>>>>>>>>    End_Object    // oSelList
37702>>>>>>>>>>>
37702>>>>>>>>>>>    Object oOK_bn is a ButtonSub
37704>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
37705>>>>>>>>>>>        Set Location to 115 126
37706>>>>>>>>>>>
37706>>>>>>>>>>>        //AB-StoreStart
37706>>>>>>>>>>>        Procedure OnClick
37708>>>>>>>>>>>            Send OK To (oSelList(current_object))
37709>>>>>>>>>>>        End_Procedure
37710>>>>>>>>>>>        //AB-StoreEnd
37710>>>>>>>>>>>
37710>>>>>>>>>>>    End_Object    // oOK_bn
37711>>>>>>>>>>>
37711>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
37713>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
37714>>>>>>>>>>>        Set Location to 115 181
37715>>>>>>>>>>>
37715>>>>>>>>>>>        //AB-StoreStart
37715>>>>>>>>>>>        Procedure OnClick
37717>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
37718>>>>>>>>>>>        End_Procedure
37719>>>>>>>>>>>        //AB-StoreEnd
37719>>>>>>>>>>>
37719>>>>>>>>>>>    End_Object    // oCancel_bn
37720>>>>>>>>>>>
37720>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
37722>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
37723>>>>>>>>>>>        Set Location to 115 236
37724>>>>>>>>>>>
37724>>>>>>>>>>>        //AB-StoreStart
37724>>>>>>>>>>>        Procedure OnClick
37726>>>>>>>>>>>            Send Search To (oSelList(current_object))
37727>>>>>>>>>>>        End_Procedure
37728>>>>>>>>>>>        //AB-StoreEnd
37728>>>>>>>>>>>
37728>>>>>>>>>>>    End_Object    // oSearch_bn
37729>>>>>>>>>>>
37729>>>>>>>>>>>
37729>>>>>>>>>>>    //AB-StoreStart
37729>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
37730>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
37731>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
37732>>>>>>>>>>>    //AB-StoreEnd
37732>>>>>>>>>>>
37732>>>>>>>>>>>End_Object    // sl198
37733>>>>>>>>>>>
37733>>>>>>>>>>>//AB/ End_Object    // prj
37733>>>>>>>>>Use sl197.SL         // sl197
INCLUDING FILE: SL197.SL
37733>>>>>>>>>>>//AB/ Project sl197:areas
37733>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
37733>>>>>>>>>>>//AB/         Set ProjectName to "sl197:areas"
37733>>>>>>>>>>>//AB/         Set ProjectFileName to "sl197.SL"
37733>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
37733>>>>>>>>>>>
37733>>>>>>>>>>>// Project Object Structure
37733>>>>>>>>>>>//   sl197 is a dbModalPanelSub
37733>>>>>>>>>>>//     Areas_DD is a DataDictionary
37733>>>>>>>>>>>//     oSelList is a dbListSub
37733>>>>>>>>>>>//     oOK_bn is a ButtonSub
37733>>>>>>>>>>>//     oCancel_bn is a ButtonSub
37733>>>>>>>>>>>//     oSearch_bn is a ButtonSub
37733>>>>>>>>>>>
37733>>>>>>>>>>>// Register all objects
37733>>>>>>>>>>>Register_Object Areas_DD
37733>>>>>>>>>>>Register_Object oCancel_bn
37733>>>>>>>>>>>Register_Object oOK_bn
37733>>>>>>>>>>>Register_Object oSearch_bn
37733>>>>>>>>>>>Register_Object oSelList
37733>>>>>>>>>>>Register_Object sl197
37733>>>>>>>>>>>
37733>>>>>>>>>>>
37733>>>>>>>>>>>    //AB-IgnoreStart
37733>>>>>>>>>>>
37733>>>>>>>>>>>    Use DFAllEnt.pkg
37733>>>>>>>>>>>    Use dbList.Sub
37733>>>>>>>>>>>    Use Button.Sub
37733>>>>>>>>>>>
37733>>>>>>>>>>>
37733>>>>>>>>>>>    Use AREAS.DD
INCLUDING FILE: AREAS.DD
37733>>>>>>>>>>>>>//DDB-FileStart
37733>>>>>>>>>>>>>//DDB-HeaderStart
37733>>>>>>>>>>>>>
37733>>>>>>>>>>>>>// File Name : AREAS.DD
37733>>>>>>>>>>>>>// Class Name: Areas_DataDictionary
37733>>>>>>>>>>>>>// Revision  : 8
37733>>>>>>>>>>>>>// Version   : 2
37733>>>>>>>>>>>>>
37733>>>>>>>>>>>>>Use  Windows           // Basic Definitions
37733>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
37733>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
37733>>>>>>>>>>>>>
37733>>>>>>>>>>>>>Open Areas
37735>>>>>>>>>>>>>Open Clients
37737>>>>>>>>>>>>>
37737>>>>>>>>>>>>>//DDB-HeaderEnd
37737>>>>>>>>>>>>>//DDB-SelectionStart
37737>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
37737>>>>>>>>>>>>>Register_Object sl197
37737>>>>>>>>>>>>>//DDB-SelectionEnd
37737>>>>>>>>>>>>>
37737>>>>>>>>>>>>>Class Areas_DataDictionary  is a DataDictionary_Sec
37738>>>>>>>>>>>>>
37738>>>>>>>>>>>>>    // Define_Fields:
37738>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
37738>>>>>>>>>>>>>
37738>>>>>>>>>>>>>    Procedure Define_Fields
37739>>>>>>>>>>>>>        Forward Send Define_Fields
37741>>>>>>>>>>>>>        //DDB-Generated-Code-Location
37741>>>>>>>>>>>>>        //DDB-DefineFieldStart
37741>>>>>>>>>>>>>
37741>>>>>>>>>>>>>        Set Main_File            To Areas.File_Number
37742>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
37743>>>>>>>>>>>>>
37743>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
37744>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
37745>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
37746>>>>>>>>>>>>>
37746>>>>>>>>>>>>>        // Child (Client) file structure................
37746>>>>>>>>>>>>>        Send Add_Client_File  Clients.File_Number
37747>>>>>>>>>>>>>
37747>>>>>>>>>>>>>        // Field-based properties.......................
37747>>>>>>>>>>>>>
37747>>>>>>>>>>>>>        // Areas.Area_Id
37747>>>>>>>>>>>>>        Set Field_Options          Field Areas.Area_Id To DD_AUTOFIND   
37748>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Areas.Area_Id To (sl197(Self))
37749>>>>>>>>>>>>>
37749>>>>>>>>>>>>>        // Areas.Area_Descr
37749>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Areas.Area_Descr To (sl197(Self))
37750>>>>>>>>>>>>>
37750>>>>>>>>>>>>>        // Areas.Area_Site
37750>>>>>>>>>>>>>
37750>>>>>>>>>>>>>        //DDB-DefineFieldEnd
37750>>>>>>>>>>>>>    End_Procedure    // Define_Fields
37751>>>>>>>>>>>>>
37751>>>>>>>>>>>>>    // Field_Defaults:
37751>>>>>>>>>>>>>    // This procedure is used to establish default field values.
37751>>>>>>>>>>>>>
37751>>>>>>>>>>>>>    Procedure Field_Defaults
37752>>>>>>>>>>>>>        Forward Send Field_Defaults
37754>>>>>>>>>>>>>        //DDB-Generated-Code-Location
37754>>>>>>>>>>>>>        //DDB-FieldDefaultStart
37754>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
37754>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
37755>>>>>>>>>>>>>
37755>>>>>>>>>>>>>End_Class    // Areas_DataDictionary
37756>>>>>>>>>>>>>//DDB-Selection-pkg-Start
37756>>>>>>>>>>>>>
37756>>>>>>>>>>>>>Use sl197.SL         // sl197
37756>>>>>>>>>>>>>
37756>>>>>>>>>>>>>//DDB-Selection-pkg-End
37756>>>>>>>>>>>>>//DDB-FileEnd
37756>>>>>>>>>>>    
37756>>>>>>>>>>>    //AB-IgnoreEnd
37756>>>>>>>>>>>
37756>>>>>>>>>>>    Object sl197 is a dbModalPanelSub
37758>>>>>>>>>>>
37758>>>>>>>>>>>        //AB-StoreTopStart
37758>>>>>>>>>>>                    
37758>>>>>>>>>>>        //AB-StoreTopEnd
37758>>>>>>>>>>>
37758>>>>>>>>>>>        Set Label to "€¨®œå¦ œ¨ ¦®é¤"
37759>>>>>>>>>>>        Set Size to 148 297
37760>>>>>>>>>>>        Set Location to 4 5
37761>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
37762>>>>>>>>>>>        Set Modal_State to FALSE
37763>>>>>>>>>>>
37763>>>>>>>>>>>        //AB-DDOStart
37763>>>>>>>>>>>
37763>>>>>>>>>>>        Object Areas_DD is a Areas_DataDictionary
37765>>>>>>>>>>>
37765>>>>>>>>>>>            //AB-StoreStart
37765>>>>>>>>>>>                                    
37765>>>>>>>>>>>            //AB-StoreEnd
37765>>>>>>>>>>>
37765>>>>>>>>>>>        End_Object    // Areas_DD
37766>>>>>>>>>>>
37766>>>>>>>>>>>        Set Main_DD to (Areas_DD(self))
37767>>>>>>>>>>>        Set Server to (Areas_DD(self))
37768>>>>>>>>>>>
37768>>>>>>>>>>>        //AB-DDOEnd
37768>>>>>>>>>>>
37768>>>>>>>>>>>        Object oSelList is a dbListSub
37770>>>>>>>>>>>            Set Main_File to Areas.File_Number
37771>>>>>>>>>>>            Set Ordering to 2
37772>>>>>>>>>>>            Set Size to 105 280
37773>>>>>>>>>>>            Set Location to 5 5
37774>>>>>>>>>>>            Set Export_Item_State to TRUE
37775>>>>>>>>>>>
37775>>>>>>>>>>>            Begin_Row
37778>>>>>>>>>>>                Entry_Item Areas.Area_id
37779>>>>>>>>>>>                Entry_Item Areas.Area_descr
37780>>>>>>>>>>>                Entry_Item Areas.Area_site
37781>>>>>>>>>>>            End_Row
37786>>>>>>>>>>>
37786>>>>>>>>>>>            Set Form_Width    item 0 to 45
37787>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
37788>>>>>>>>>>>            
37788>>>>>>>>>>>            Set Form_Width    item 1 to 192
37789>>>>>>>>>>>            Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
37790>>>>>>>>>>>            
37790>>>>>>>>>>>            Set Form_Width    item 2 to 35
37791>>>>>>>>>>>            Set Header_Label  item 2 to "’¦£â˜ª"
37792>>>>>>>>>>>            
37792>>>>>>>>>>>
37792>>>>>>>>>>>            //AB-StoreStart
37792>>>>>>>>>>>            
37792>>>>>>>>>>>            Set Column_Option Item 0 to NoEnter True
37793>>>>>>>>>>>            
37793>>>>>>>>>>>            
37793>>>>>>>>>>>            //AB-StoreEnd
37793>>>>>>>>>>>
37793>>>>>>>>>>>        End_Object    // oSelList
37794>>>>>>>>>>>
37794>>>>>>>>>>>        Object oOK_bn is a ButtonSub
37796>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
37797>>>>>>>>>>>            Set Location to 115 126
37798>>>>>>>>>>>
37798>>>>>>>>>>>            //AB-StoreStart
37798>>>>>>>>>>>            Procedure OnClick
37800>>>>>>>>>>>                Send OK To (oSelList(current_object))
37801>>>>>>>>>>>            End_Procedure
37802>>>>>>>>>>>            //AB-StoreEnd
37802>>>>>>>>>>>
37802>>>>>>>>>>>        End_Object    // oOK_bn
37803>>>>>>>>>>>
37803>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
37805>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
37806>>>>>>>>>>>            Set Location to 115 181
37807>>>>>>>>>>>
37807>>>>>>>>>>>            //AB-StoreStart
37807>>>>>>>>>>>            Procedure OnClick
37809>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
37810>>>>>>>>>>>            End_Procedure
37811>>>>>>>>>>>            //AB-StoreEnd
37811>>>>>>>>>>>
37811>>>>>>>>>>>        End_Object    // oCancel_bn
37812>>>>>>>>>>>
37812>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
37814>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
37815>>>>>>>>>>>            Set Location to 115 236
37816>>>>>>>>>>>
37816>>>>>>>>>>>            //AB-StoreStart
37816>>>>>>>>>>>            Procedure OnClick
37818>>>>>>>>>>>                Send Search To (oSelList(current_object))
37819>>>>>>>>>>>            End_Procedure
37820>>>>>>>>>>>            //AB-StoreEnd
37820>>>>>>>>>>>
37820>>>>>>>>>>>        End_Object    // oSearch_bn
37821>>>>>>>>>>>
37821>>>>>>>>>>>
37821>>>>>>>>>>>        //AB-StoreStart
37821>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
37822>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
37823>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
37824>>>>>>>>>>>        
37824>>>>>>>>>>>        
37824>>>>>>>>>>>        
37824>>>>>>>>>>>        
37824>>>>>>>>>>>        
37824>>>>>>>>>>>        //AB-StoreEnd
37824>>>>>>>>>>>
37824>>>>>>>>>>>    End_Object    // sl197
37825>>>>>>>>>>>
37825>>>>>>>>>>>//AB/     End_Object    // prj
37825>>>>>>>>>
37825>>>>>>>>>//DDB-Selection-pkg-End
37825>>>>>>>>>//DDB-FileEnd
37825>>>>>>>//Use PmsSxet.DD
37825>>>>>>>
37825>>>>>>>Class Cmoves_DataDictionary  is a DataDictionary
37826>>>>>>>
37826>>>>>>>    Procedure Construct_Object
37827>>>>>>>        Forward Send Construct_Object
37829>>>>>>>        Property Integer piFromBP           Public 0
37830>>>>>>>        Property Integer piNotMoveSyscurXr  Public 0   
37831>>>>>>>        Property Integer piFromSysxet       Public 0   
37832>>>>>>>        Property Integer piFromxrhsh        Public 0  //œ¤›œ ¥ž ¦«  œ¨®œ«˜  ˜§¦ £œ«˜­¦¨á ¬§¦¢¦å§à¤
37833>>>>>>>    End_Procedure
37834>>>>>>>
37834>>>>>>>    Function Validate_Save  Returns Integer
37835>>>>>>>        Integer iReturnVal iOpen_Items iCheck ifromxrhsh iYes
37836>>>>>>>        String sModule
37836>>>>>>>        get pifromxrhsh to ifromxrhsh
37837>>>>>>>        Forward Get Validate_Save  To iReturnVal
37839>>>>>>>        If (Not(iReturnVal)) Begin
37841>>>>>>>            if (cmoves.cmoves_recr='')  Send Operation_Not_Allowed 3263
37844>>>>>>>            Clear Branch
37845>>>>>>>            Move SyscurXr.Company_Code  to Branch.Company_Code
37846>>>>>>>            Move SyscurXr.Branch_Code   to Branch.Branch_Code
37847>>>>>>>            Find Eq Branch By Index.1
37848>>>>>>>>
37848>>>>>>>            If (Not(Found)) Move 6666 to iReturnVal
37851>>>>>>>            Else If ((Branch.Locked_Until<>'') And (Cmoves.Cmoves_Hmnia<=Branch.Locked_Until)) Move 6667 to iReturnVal
37855>>>>>>>            
37855>>>>>>>            If (Cmoves.Axia_Ypol_Sysx<0) Begin
37857>>>>>>>                Move 10101 to iReturnVal
37858>>>>>>>            End
37858>>>>>>>>
37858>>>>>>>            Else Begin
37859>>>>>>>                
37859>>>>>>>                Move Ctypkin.Check_Overhead to iCheck
37860>>>>>>>                If (iCheck) Begin
37862>>>>>>>                    If ((Clients.Plafon>0) And (Clients.Overhead<0) And (Sysfile.Over_Overhead<>'1')) Begin
37864>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 3000 Cmoves' to iYes
37865>>>>>>>                        If (iYes=MBR_NO) Move 11170 to iReturnVal
37868>>>>>>>                    End
37868>>>>>>>>
37868>>>>>>>                    Else If ((PayResp.Plafon>0) And (PayResp.Overhead<0) And (Sysfile.Over_Overhead<>'1')) Begin
37871>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 3001 Cmoves' to iYes
37872>>>>>>>                        If (iYes=MBR_NO) Move 11171 to iReturnVal
37875>>>>>>>                    End
37875>>>>>>>>
37875>>>>>>>                End
37875>>>>>>>>
37875>>>>>>>                
37875>>>>>>>                If (iReturnVal) Send Operation_Not_Allowed iReturnVal
37878>>>>>>>                
37878>>>>>>>                If ((Cmoves.Prn_Theor='1') And (piFromBP(Self)<>1)) Move 22278 to iReturnVal
37881>>>>>>>                Else If ((Clients.Client_Locked='1') And (piFromBP(Self)<>1)) Move 11172 to iReturnVal
37885>>>>>>>                
37885>>>>>>>                // ˜¤ œ¨®œ«˜  ˜§¦ £œ«˜­¦¨á ¬§¦¢¦å§à¤ £ž¤ «¦¤ ¡¦™œ ª ã ˜§¦ open items (©¬©®œ« ©œ ª)
37885>>>>>>>                Else If ((Cmoves.Cmoves_Hmnia<syscurxr.Year_Xrhshfrom and ifromxrhsh<>1 And (piFromSysxet(Self)<>1)) Or ;                         (Cmoves.Cmoves_Hmnia>Syscurxr.Year_Xrhshto and ifromxrhsh<>1 And (piFromSysxet(Self)<>1))) Move 22277 to iReturnVal
37889>>>>>>>                Else Begin
37890>>>>>>>                    If (Cmoves.Module_From='') Move 22250 to iReturnVal
37893>>>>>>>                    Else Begin
37894>>>>>>>                        If (piFromBP(Self)<>1) Begin // €¤ ›œ¤ §¨¦œ¨®œ«˜  ˜§¦ « ª 2 Business Process
37896>>>>>>>                            If (Cmoves.Module_From<>gs_Module_Code) Move 22288 to iReturnVal
37899>>>>>>>                            Else If (Cmoves.Recnum<>0) Begin // €¤ ›œ¤ ¡˜¤œ  create ¤œ˜ œšš¨˜­ž
37902>>>>>>>                                If (Cmoves.Barticl_Recr<>'') Move 22284 to iReturnVal
37905>>>>>>>                                Else If (Cmoves.Partl_Recr  <>'') Begin
37908>>>>>>>                                    If (Cmoves.Module_From='01') Move 22283 to iReturnVal
37911>>>>>>>                                    Else If (Cmoves.Module_From='02') Move 22282 to iReturnVal
37915>>>>>>>                                End
37915>>>>>>>>
37915>>>>>>>                            End
37915>>>>>>>>
37915>>>>>>>                        End
37915>>>>>>>>
37915>>>>>>>                    End
37915>>>>>>>>
37915>>>>>>>                End
37915>>>>>>>>
37915>>>>>>>            End
37915>>>>>>>>
37915>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
37918>>>>>>>        End
37918>>>>>>>>
37918>>>>>>>        Function_Return iReturnVal
37919>>>>>>>    End_Function   // Validate_Save
37920>>>>>>>
37920>>>>>>>    Function Validate_Delete  Returns Integer
37921>>>>>>>        Integer iReturnVal
37922>>>>>>>        String sModule
37922>>>>>>>        Forward Get Validate_Delete  To iReturnVal
37924>>>>>>>        If (Not(iReturnVal)) Begin
37926>>>>>>>
37926>>>>>>>            Clear Branch
37927>>>>>>>            Move SyscurXr.Company_Code  to Branch.Company_Code
37928>>>>>>>            Move SyscurXr.Branch_Code   to Branch.Branch_Code
37929>>>>>>>            Find Eq Branch By Index.1
37930>>>>>>>>
37930>>>>>>>            If (Not(Found)) Move 6668 to iReturnVal
37933>>>>>>>            Else If ((Branch.Locked_Until<>'') And (Cmoves.Cmoves_Hmnia<=Branch.Locked_Until)) Move 6669 to iReturnVal
37937>>>>>>>            
37937>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
37940>>>>>>>            
37940>>>>>>>            If (Cmoves.Prn_Theor='1') Move 22279 to iReturnVal
37943>>>>>>>            Else If (piFromBP(Self)<>1) Begin
37946>>>>>>>                If (Cmoves.Module_From<>gs_Module_Code) Move 22289 to iReturnVal
37949>>>>>>>                Else Begin
37950>>>>>>>                    If (Cmoves.Barticl_Recr<>'') Move 22287 to iReturnVal
37953>>>>>>>                    Else If (Cmoves.Partl_Recr  <>'') Begin
37956>>>>>>>                        If (Cmoves.Module_From='01') Move 22286 to iReturnVal
37959>>>>>>>                        Else If (Cmoves.Module_From='02') Move 22285 to iReturnVal
37963>>>>>>>                    End
37963>>>>>>>>
37963>>>>>>>                End
37963>>>>>>>>
37963>>>>>>>            End
37963>>>>>>>>
37963>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
37966>>>>>>>        End
37966>>>>>>>>
37966>>>>>>>        Function_Return iReturnVal
37967>>>>>>>    End_Function   // Validate_Delete
37968>>>>>>>
37968>>>>>>>    Procedure Save_Main_File
37969>>>>>>>        If (Operation_Origin<>Self) Begin
37971>>>>>>>            If Cmoves.Recnum Eq 0 Procedure_Return
37974>>>>>>>        End
37974>>>>>>>>
37974>>>>>>>        If (Cmoves.Cn_Code<>'') Begin
37976>>>>>>>            Clear Cn
37977>>>>>>>            Move Cmoves.Cn_Code to Cn.Cn_Code
37978>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
37979>>>>>>>>
37979>>>>>>>            Move Cn.Cn_Sls_ID      to Cmoves.Sls_ID
37980>>>>>>>            Move cn.Mhxanik_id     to Cmoves.Mhxanik_Id
37981>>>>>>>            Move Cn.CN_Cnt_ID      to Cmoves.Cnt_ID
37982>>>>>>>            Move Cn.Cn_Recr        to Cmoves.Cn_Recr
37983>>>>>>>        End
37983>>>>>>>>
37983>>>>>>>        Else Begin
37984>>>>>>>            Move ''     to Cmoves.Sls_ID
37985>>>>>>>            Move ''     to Cmoves.Cnt_ID
37986>>>>>>>            Move ''     to Cmoves.Cn_Recr
37987>>>>>>>            Move ''     to Cmoves.Mhxanik_id
37988>>>>>>>        End
37988>>>>>>>>
37988>>>>>>>        Forward Send Save_Main_File
37990>>>>>>>    End_Procedure   // Save_Main_File
37991>>>>>>>
37991>>>>>>>
37991>>>>>>>    Procedure Update
37992>>>>>>>        String sNomisma
37993>>>>>>>        Forward Send Update
37995>>>>>>>        
37995>>>>>>>        If (piNotMoveSyscurXr(Self)=0) Begin
37997>>>>>>>            Move SysCurXR.Company_Code      to Cmoves.Company_Code
37998>>>>>>>            Move SysCurXR.Branch_Code       to Cmoves.Branch_Code
37999>>>>>>>        End
37999>>>>>>>>
37999>>>>>>>        
37999>>>>>>>        //˜¤ šå¤œ«˜  £œ«˜­¦¨á ¬§¦¢¦å§à¤
37999>>>>>>>        if (pifromxrhsh(self)=1)            Move (SysCurXR.Year_Year+1) to Cmoves.Year_Year
38002>>>>>>>        else If (piNotMoveSyscurXr(Self)=0) Move SysCurXR.Year_Year     to Cmoves.Year_Year
38006>>>>>>>        
38006>>>>>>>        //Move Custprom.Custprom_Code to Cmoves.Custprom_Code
38006>>>>>>>        Move Clients.Client_ID          to Cmoves.Client_ID
38007>>>>>>>        Move Clients.Client_Name        to Cmoves.Client_Name
38008>>>>>>>        Move Ctypkin.Ctypkin_Descr      to Cmoves.Ctypkin_Descr
38009>>>>>>>
38009>>>>>>>        // js 28/03/2002 Gia na mhn allazei sta Copen me to Ctypkin tou CmovesA
38009>>>>>>>        If (Cmoves.Ctypkin_Code='') ;            Move Ctypkin.Ctypkin_Code   to Cmoves.Ctypkin_Code
38012>>>>>>>
38012>>>>>>>
38012>>>>>>>        Move payresp.presp_ID           to Cmoves.Presp_ID
38013>>>>>>>
38013>>>>>>>        ///an enhmeronei synolikh ofeilh pelath
38013>>>>>>>        if (Cmoves.enhm_ofeilh='1') begin
38015>>>>>>>            Add (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) to Clients.Synolikh_ofeilh
38016>>>>>>>            Add (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) to Payresp.Synolikh_ofeilh
38017>>>>>>>        end
38017>>>>>>>>
38017>>>>>>>
38017>>>>>>>        If (Cmoves.Enhm_Ypol_Pel='1') Begin
38019>>>>>>>            If (Cmoves.Cmoves_x0<>0) Begin
38021>>>>>>>                Add Cmoves.Cmoves_x0 to Clients.Xreosh
38022>>>>>>>                Add Cmoves.Cmoves_x0 to PayResp.Xreosh
38023>>>>>>>            End
38023>>>>>>>>
38023>>>>>>>            Else If (Cmoves.Cmoves_p0<>0) Begin
38026>>>>>>>                Add Cmoves.Cmoves_p0 to Clients.Pistosh
38027>>>>>>>                Add Cmoves.Cmoves_p0 to PayResp.Pistosh
38028>>>>>>>            End
38028>>>>>>>>
38028>>>>>>>            if ((clients.client_ptyppar='113') and (clients.client_public<>1)) begin
38030>>>>>>>                move 1 to clients.client_public  
38031>>>>>>>                Move '01/01/1753'   to Clients.SAP_Hmnia
38032>>>>>>>                move '' to clients.status
38033>>>>>>>            end     
38033>>>>>>>>
38033>>>>>>>        End
38033>>>>>>>>
38033>>>>>>>        If (Cmoves.Enhm_Hmnies_Pel='1') Begin
38035>>>>>>>            If (Cmoves.Cmoves_x0<>0) Begin
38037>>>>>>>                Move Cmoves.Cmoves_Hmnia   to Clients.Last_Xreosh
38038>>>>>>>                Move Cmoves.Cmoves_Hmnia   to PayResp.Last_Xreosh
38039>>>>>>>            End
38039>>>>>>>>
38039>>>>>>>            Else If (Cmoves.Cmoves_p0<>0) Begin
38042>>>>>>>                Move Cmoves.Cmoves_Hmnia   to Clients.Last_Pistosh
38043>>>>>>>                Move Cmoves.Cmoves_Hmnia   to PayResp.Last_Pistosh
38044>>>>>>>            End
38044>>>>>>>>
38044>>>>>>>            if ((clients.client_ptyppar='113') and (clients.client_public<>1)) begin 
38046>>>>>>>                move 1 to clients.client_public
38047>>>>>>>                move '' to clients.status  
38048>>>>>>>                Move '01/01/1753'   to Clients.SAP_Hmnia
38049>>>>>>>            end 
38049>>>>>>>>
38049>>>>>>>        End
38049>>>>>>>>
38049>>>>>>>
38049>>>>>>>             If ((Cmoves.Cmoves_M_Code='') And (Cmoves.Module_From  <>'')) Move Cmoves.Module_From     to Cmoves.Cmoves_M_Code
38052>>>>>>>        Else If ((Cmoves.Module_From  ='') And (Cmoves.Cmoves_M_Code<>'')) Move Cmoves.Cmoves_M_Code   to Cmoves.Module_From
38056>>>>>>>
38056>>>>>>>        If (Ctypkin.Open_Item='1') Move (Cmoves.Axia_Pros_Sysx-Cmoves.Axia_Sysxet) to Cmoves.Axia_Ypol_Sysx
38059>>>>>>>        Else Begin
38060>>>>>>>            Move 0 to Cmoves.Axia_Pros_Sysx
38061>>>>>>>            Move 0 to Cmoves.Axia_Sysxet
38062>>>>>>>            Move 0 to Cmoves.Axia_Ypol_Sysx
38063>>>>>>>        End
38063>>>>>>>>
38063>>>>>>>
38063>>>>>>>        // js 23/01/2002
38063>>>>>>>        // Enhmerosh Pediou Flag_Ypol to opoio antiprosopeyei
38063>>>>>>>        // to an h eggrafh exei diathesimo ypoloipo pros sysxetish
38063>>>>>>>        Move (Cmoves.Axia_Ypol_Sysx<>0) to Cmoves.Flag_Ypol
38064>>>>>>>
38064>>>>>>>        // js 23/01/2002
38064>>>>>>>        // Enhmerosh Pediou Flag_Open to opoio antiprosopeyei
38064>>>>>>>        // an einai xreosh=1, pistosh=2, arnhtikh xreosh=2 arnhtikh Pistosh=1
38064>>>>>>>        // gia na emfanizei ta antistrofa sto copen
38064>>>>>>>        If (Ctypkin.Open_Item='1') Begin
38066>>>>>>>            If ((Cmoves.Cmoves_X0<>0) And ((Cmoves.Cmoves_P0=0))) Begin
38068>>>>>>>                Move 1                          to Cmoves.Flag_Copen
38069>>>>>>>                If (Cmoves.Cmoves_X0<0) Move 2  to Cmoves.Flag_Copen
38072>>>>>>>            End
38072>>>>>>>>
38072>>>>>>>            Else If ((Cmoves.Cmoves_P0<>0) And ((Cmoves.Cmoves_X0=0))) Begin
38075>>>>>>>                Move 2                          to Cmoves.Flag_Copen
38076>>>>>>>                If (Cmoves.Cmoves_P0<0) Move 1  to Cmoves.Flag_Copen
38079>>>>>>>            End
38079>>>>>>>>
38079>>>>>>>            Else Move 0 to Cmoves.Flag_Copen
38081>>>>>>>        End
38081>>>>>>>>
38081>>>>>>>        Else Move 0 to Cmoves.Flag_Copen
38083>>>>>>>    End_Procedure   // Update
38084>>>>>>>
38084>>>>>>>    Procedure Backout
38085>>>>>>>        Forward Send Backout
38087>>>>>>>
38087>>>>>>>        if (Cmoves.enhm_ofeilh='1') begin
38089>>>>>>>            sub (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) from Clients.Synolikh_ofeilh
38090>>>>>>>            sub (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) from Payresp.Synolikh_ofeilh
38091>>>>>>>        end
38091>>>>>>>>
38091>>>>>>>
38091>>>>>>>//        if (Cmoves.enhm_ofeilh='2') begin
38091>>>>>>>//            sub ((Cmoves.Cmoves_x0-Cmoves.cmoves_p0)*-1) from Clients.Synolikh_ofeilh
38091>>>>>>>//            sub ((Cmoves.Cmoves_x0-Cmoves.cmoves_p0)*-1) from Payresp.Synolikh_ofeilh
38091>>>>>>>//        end
38091>>>>>>>
38091>>>>>>>        If (Cmoves.Enhm_Ypol_Pel='1') Begin
38093>>>>>>>            If (Cmoves.Cmoves_x0<>0) Begin
38095>>>>>>>                Sub Cmoves.Cmoves_x0 From Clients.Xreosh
38096>>>>>>>                Sub Cmoves.Cmoves_x0 From PayResp.Xreosh
38097>>>>>>>            End
38097>>>>>>>>
38097>>>>>>>            Else If (Cmoves.Cmoves_p0<>0) Begin
38100>>>>>>>                Sub Cmoves.Cmoves_p0 From Clients.Pistosh
38101>>>>>>>                Sub Cmoves.Cmoves_p0 From PayResp.Pistosh
38102>>>>>>>            End
38102>>>>>>>>
38102>>>>>>>        End
38102>>>>>>>>
38102>>>>>>>    End_Procedure
38103>>>>>>>
38103>>>>>>>    Procedure Creating
38104>>>>>>>        Forward Send Creating
38106>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Cmoves.Cmoves_Rec0)))))) to Cmoves.Cmoves_Recr
38107>>>>>>>
38107>>>>>>>        //If ((Cmoves.Module_From='' ) Or (piFromBP(Self)<>1)) Move gs_Module_Code to Cmoves.Module_From
38107>>>>>>>
38107>>>>>>>        If (Ctypkin.Open_Item ='1') Begin
38109>>>>>>>                 If (Cmoves.Cmoves_x0<>0) Move (Abs(Cmoves.Cmoves_x0)) to Cmoves.Axia_Pros_Sysx
38112>>>>>>>            Else If (Cmoves.Cmoves_p0<>0) Move (Abs(Cmoves.Cmoves_p0)) to Cmoves.Axia_Pros_Sysx
38116>>>>>>>        End
38116>>>>>>>>
38116>>>>>>>    End_Procedure   // Creating
38117>>>>>>>
38117>>>>>>>
38117>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
38118>>>>>>>        String lsError_Message
38119>>>>>>>
38119>>>>>>>        Case Begin
38119>>>>>>>            
38119>>>>>>>            Case (iError_Num = 3263)
38121>>>>>>>                Move "DDC 006: ‘­á¢£˜ 6666 €›ç¤˜«ž ž œšš¨˜­ž!\n‰œ¤æ Cmoverecr!! Protem !!" to lsError_Message
38122>>>>>>>            Case Break
38123>>>>>>>            
38123>>>>>>>            Case (iError_Num = 6666)
38126>>>>>>>                Move "DDC 006: ‘­á¢£˜ 6666 €›ç¤˜«ž ž œšš¨˜­ž!\nƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ ¬§¦¡˜«˜©«ž£á«à¤" to lsError_Message
38127>>>>>>>            Case Break
38128>>>>>>>
38128>>>>>>>            Case (iError_Num = 6667)
38131>>>>>>>                Move "DDC 006: ‘­á¢£˜ 6667 €›ç¤˜«ž ž œšš¨˜­ž!\n†£/¤å˜ ¡å¤ž©žª §¨¦šœ¤â©«œ¨ž ž£/¤å˜ª ¡¢œ ›é£˜«¦ª" to lsError_Message
38132>>>>>>>            Case Break
38133>>>>>>>
38133>>>>>>>            Case (iError_Num = 6668)
38136>>>>>>>                Move "DDC 006: ‘­á¢£˜ 6668 €›ç¤˜«ž ž › ˜š¨˜­ã!\nƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ ¬§¦¡˜«˜©«ž£á«à¤" to lsError_Message
38137>>>>>>>            Case Break
38138>>>>>>>
38138>>>>>>>            Case (iError_Num = 6669)
38141>>>>>>>                Move "DDC 006: ‘­á¢£˜ 6669 €›ç¤˜«ž ž › ˜š¨˜­ã!\n†£/¤å˜ ¡å¤ž©žª §¨¦šœ¤â©«œ¨ž ž£/¤å˜ª ¡¢œ ›é£˜«¦ª" to lsError_Message
38142>>>>>>>            Case Break
38143>>>>>>>
38143>>>>>>>            Case (iError_Num = 22277)
38146>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n†£œ¨¦£ž¤åœª œ¡«æª ¦¨åà¤ ®¨ã©žª" to lsError_Message
38147>>>>>>>            Case Break
38148>>>>>>>
38148>>>>>>>            Case (iError_Num = 22278)
38151>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ã!\n\„®œ  «¬§àŸœ  Ÿœà¨ž£â¤¦" to lsError_Message
38152>>>>>>>            Case Break
38153>>>>>>>
38153>>>>>>>            Case (iError_Num = 22279)
38156>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\„®œ  «¬§àŸœ  Ÿœà¨ž£â¤¦" to lsError_Message
38157>>>>>>>            Case Break
38158>>>>>>>
38158>>>>>>>            Case (iError_Num = 11170)
38161>>>>>>>                Move "DDC 006:’¦ § ©«à« ¡æ æ¨ ¦ «¦¬ ­¦¨â˜ â®œ  œ¥˜¤«¢žŸœå" to lsError_Message
38162>>>>>>>            Case Break
38163>>>>>>>
38163>>>>>>>            Case (iError_Num = 11171)
38166>>>>>>>                Move "DDC 006:’¦ § ©«à« ¡æ æ¨ ¦ «¦¬ “§. ¢ž¨à£é¤ â®œ  œ¥˜¤«¢žŸœå" to lsError_Message
38167>>>>>>>            Case Break
38168>>>>>>>
38168>>>>>>>            Case (iError_Num = 11172)
38171>>>>>>>                Move "DDC 006:Ž ­¦¨â˜ª œå¤˜  ¡¢œ ›à£â¤¦ª ¢æšà § ©«à« ¡¦ç ¦¨å¦¬" to lsError_Message
38172>>>>>>>            Case Break
38173>>>>>>>
38173>>>>>>>            Case (iError_Num = 22288)
38176>>>>>>>                Clear Codemast
38177>>>>>>>                Move "MODULE" to Codemast.Type
38178>>>>>>>                Move Cmoves.Module_From to Codemast.Code
38179>>>>>>>                Find Eq Codemast by Index.1 //type+code
38180>>>>>>>>
38180>>>>>>>                Move ("DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n(† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ "+;                (Trim(Codemast.Description))+" )") to lsError_Message
38181>>>>>>>            Case Break
38182>>>>>>>
38182>>>>>>>            Case (iError_Num = 22250)
38185>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n’¦ ¡ç¡¢à£˜ (Module) «žª œšš¨˜­ãª œå¤˜  ¡œ¤æ" to lsError_Message
38186>>>>>>>            Case Break
38187>>>>>>>
38187>>>>>>>            Case (iError_Num = 22284)
38190>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ «˜ €¥ æš¨˜­˜" to lsError_Message
38191>>>>>>>            Case Break
38192>>>>>>>            Case (iError_Num = 22283)
38195>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ « ª à¢ã©œ ª" to lsError_Message
38196>>>>>>>            Case Break
38197>>>>>>>            Case (iError_Num = 22282)
38200>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ « ª €š¦¨âª" to lsError_Message
38201>>>>>>>            Case Break
38202>>>>>>>
38202>>>>>>>            //˜§æ validate delete
38202>>>>>>>            Case (iError_Num = 22289)
38205>>>>>>>                Clear Codemast
38206>>>>>>>                Move "MODULE" to Codemast.Type
38207>>>>>>>                Move Cmoves.Module_From to Codemast.Code
38208>>>>>>>                Find Eq Codemast by Index.1 //type+code
38209>>>>>>>>
38209>>>>>>>                Move ("DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n(† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ "+;                (Trim(Codemast.Description))+" )") to lsError_Message
38210>>>>>>>            Case Break
38211>>>>>>>
38211>>>>>>>            Case (iError_Num = 22287)
38214>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ «˜ €¥ æš¨˜­˜" to lsError_Message
38215>>>>>>>            Case Break
38216>>>>>>>            Case (iError_Num = 22286)
38219>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ « ª à¢ã©œ ª" to lsError_Message
38220>>>>>>>            Case Break
38221>>>>>>>            Case (iError_Num = 22285)
38224>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ « ª €š¦¨âª" to lsError_Message
38225>>>>>>>            Case Break
38226>>>>>>>
38226>>>>>>>            //â¢œš®¦  open items
38226>>>>>>>            Case (iError_Num = 10101)
38229>>>>>>>                Move ("DDC 006:€¡˜«á¢¢ž¢ž „šš¨˜­ã.\n\n"+;                "’¦ ©¬©®œ« ©£â¤¦ §¦©æ œå¤˜  £œš˜¢ç«œ¨¦\n˜§¦ «¦ ˜¨® ¡á › ˜Ÿâ© £¦ §¨¦ª ©¬©®â« ©ž");                to lsError_Message
38230>>>>>>>            Case Break
38231>>>>>>>
38231>>>>>>>            Case Else
38231>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
38233>>>>>>>        Case End
38233>>>>>>>
38233>>>>>>>        Error iError_Num lsError_Message
38234>>>>>>>>
38234>>>>>>>    End_Procedure // operation_not_allowed
38235>>>>>>>
38235>>>>>>>
38235>>>>>>>    // Define_Fields:
38235>>>>>>>    // This procedure is used to set up all data-dictionary rules.
38235>>>>>>>
38235>>>>>>>    Procedure Define_Fields
38236>>>>>>>        Forward Send Define_Fields
38238>>>>>>>        //DDB-Generated-Code-Location
38238>>>>>>>        //DDB-DefineFieldStart
38238>>>>>>>
38238>>>>>>>        Set Main_File            To Cmoves.File_Number
38239>>>>>>>        Set Cascade_Delete_State To FALSE
38240>>>>>>>
38240>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
38241>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
38242>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38243>>>>>>>
38243>>>>>>>        // Child (Client) file structure................
38243>>>>>>>        Send Add_Client_File  Copen.File_Number
38244>>>>>>>
38244>>>>>>>        // Parent (Server) file structure...............
38244>>>>>>>        Send Add_Server_File  Ctypkin.File_Number
38245>>>>>>>        Send Add_Server_File  Clients.File_Number
38246>>>>>>>
38246>>>>>>>        // External (System) file structure.............
38246>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_NEW_SAVE_DELETE
38247>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
38248>>>>>>>
38248>>>>>>>        Define_Auto_Increment  Sysrecc.Cmoves_Rec0  To Cmoves.Cmoves_Rec0
38251>>>>>>>
38251>>>>>>>        // Field-based properties.......................
38251>>>>>>>
38251>>>>>>>        // Cmoves.Company_Code
38251>>>>>>>
38251>>>>>>>        // Cmoves.Branch_Code
38251>>>>>>>
38251>>>>>>>        // Cmoves.Year_Year
38251>>>>>>>
38251>>>>>>>        // Cmoves.Custprom_Code
38251>>>>>>>
38251>>>>>>>        // Cmoves.Client_Id
38251>>>>>>>
38251>>>>>>>        // Cmoves.Ctypkin_Code
38251>>>>>>>
38251>>>>>>>        // Cmoves.Cmoves_Recr
38251>>>>>>>
38251>>>>>>>        // Cmoves.Cmoves_Rec0
38251>>>>>>>        Set Field_Options          Field Cmoves.Cmoves_Rec0 To DD_AUTOFIND   
38252>>>>>>>        Set Field_Prompt_Object    Field Cmoves.Cmoves_Rec0 To (sl006(Self))
38253>>>>>>>
38253>>>>>>>        // Cmoves.Cmoves_Hmnia
38253>>>>>>>        Set Field_Prompt_Object    Field Cmoves.Cmoves_Hmnia To (sl006(Self))
38254>>>>>>>
38254>>>>>>>        // Cmoves.Ctypkin_Recr
38254>>>>>>>
38254>>>>>>>        // Cmoves.Cmoves_Par
38254>>>>>>>
38254>>>>>>>        // Cmoves.Partl_Recr
38254>>>>>>>        //DDB/ Comment_Short       Field Cmoves.Partl_Recr To "‘¬¤›œ©ž record £œ ¡ç¡¢à£˜ à¢ã©œà¤"
38254>>>>>>>
38254>>>>>>>        // Cmoves.Cmoves_Axia
38254>>>>>>>
38254>>>>>>>        // Cmoves.Cmoves_X0
38254>>>>>>>
38254>>>>>>>        // Cmoves.Cmoves_P0
38254>>>>>>>
38254>>>>>>>        // Cmoves.Cmoves_X00
38254>>>>>>>
38254>>>>>>>        // Cmoves.Cmoves_P00
38254>>>>>>>
38254>>>>>>>        // Cmoves.Cmoves_X1
38254>>>>>>>
38254>>>>>>>        // Cmoves.Cmoves_P1
38254>>>>>>>
38254>>>>>>>        // Cmoves.Cmoves_X2
38254>>>>>>>
38254>>>>>>>        // Cmoves.Cmoves_P2
38254>>>>>>>
38254>>>>>>>        // Cmoves.Cmoves_Dlixis
38254>>>>>>>
38254>>>>>>>        // Cmoves.Cmoves_A_Code
38254>>>>>>>
38254>>>>>>>        // Cmoves.Cmoves_Status_E
38254>>>>>>>
38254>>>>>>>        // Cmoves.Cmoves_Status_A
38254>>>>>>>
38254>>>>>>>        // Cmoves.Cmoves_S0
38254>>>>>>>
38254>>>>>>>        // Cmoves.Cmoves_Ys0
38254>>>>>>>
38254>>>>>>>        // Cmoves.Cmoves_S1
38254>>>>>>>
38254>>>>>>>        // Cmoves.Cmoves_Ys1
38254>>>>>>>
38254>>>>>>>        // Cmoves.Cmoves_S2
38254>>>>>>>
38254>>>>>>>        // Cmoves.Cmoves_Ys2
38254>>>>>>>
38254>>>>>>>        // Cmoves.Cmoves_Sc_Code2
38254>>>>>>>        Set Field_Prompt_Object    Field Cmoves.Cmoves_Sc_Code2 To (slNomism(Self))
38255>>>>>>>
38255>>>>>>>        // Cmoves.Cmoves_Open
38255>>>>>>>
38255>>>>>>>        // Cmoves.Cmoves_Aopen
38255>>>>>>>
38255>>>>>>>        // Cmoves.Cmoves_M_Code
38255>>>>>>>
38255>>>>>>>        // Cmoves.Cmoves_Yn_Myf
38255>>>>>>>
38255>>>>>>>        // Cmoves.Cmoves_Myf_Axia
38255>>>>>>>
38255>>>>>>>        // Cmoves.Cmoves_Kk
38255>>>>>>>
38255>>>>>>>        // Cmoves.Cmoves_C_Code2
38255>>>>>>>
38255>>>>>>>        // Cmoves.Cn_Code
38255>>>>>>>        Set Field_Prompt_Object    Field Cmoves.Cn_Code To (sl041(Self))
38256>>>>>>>
38256>>>>>>>        // Cmoves.Client_Recr
38256>>>>>>>
38256>>>>>>>        // Cmoves.Barticl_Recr
38256>>>>>>>
38256>>>>>>>        // Cmoves.Cmoves_Qty
38256>>>>>>>
38256>>>>>>>        // Cmoves.Cmove_Totambd0
38256>>>>>>>
38256>>>>>>>        // Cmoves.Cmove_Discam0
38256>>>>>>>
38256>>>>>>>        // Cmoves.Cmove_Totamad0
38256>>>>>>>
38256>>>>>>>        // Cmoves.Cmove_Vatam0
38256>>>>>>>
38256>>>>>>>        // Cmoves.Cmove_Extra0
38256>>>>>>>
38256>>>>>>>        // Cmoves.Cmove_Totambd00
38256>>>>>>>
38256>>>>>>>        // Cmoves.Cmove_Discam00
38256>>>>>>>
38256>>>>>>>        // Cmoves.Cmove_Totamad00
38256>>>>>>>
38256>>>>>>>        // Cmoves.Cmove_Vatam00
38256>>>>>>>
38256>>>>>>>        // Cmoves.Cmove_Extra00
38256>>>>>>>
38256>>>>>>>        // Cmoves.Cmove_Totambd1
38256>>>>>>>
38256>>>>>>>        // Cmoves.Cmove_Discam1
38256>>>>>>>
38256>>>>>>>        // Cmoves.Cmove_Totamad1
38256>>>>>>>
38256>>>>>>>        // Cmoves.Cmove_Vatam1
38256>>>>>>>
38256>>>>>>>        // Cmoves.Cmove_Extra1
38256>>>>>>>
38256>>>>>>>        // Cmoves.Module_From
38256>>>>>>>
38256>>>>>>>        // Cmoves.Parast_Abrev
38256>>>>>>>
38256>>>>>>>        // Cmoves.Enhm_Ypol_Pel
38256>>>>>>>
38256>>>>>>>        // Cmoves.Enhm_Hmnies_Pel
38256>>>>>>>
38256>>>>>>>        // Cmoves.Sls_Id
38256>>>>>>>
38256>>>>>>>        // Cmoves.Presp_Id
38256>>>>>>>
38256>>>>>>>        // Cmoves.Cnt_Id
38256>>>>>>>
38256>>>>>>>        // Cmoves.Cmoves_Open_Sx0
38256>>>>>>>
38256>>>>>>>        // Cmoves.Cmoves_Open_Sp0
38256>>>>>>>
38256>>>>>>>        // Cmoves.Cmoves_Open_Yx0
38256>>>>>>>
38256>>>>>>>        // Cmoves.Cmoves_Open_Yp0
38256>>>>>>>
38256>>>>>>>        // Cmoves.Cmoves_Open_Sx1
38256>>>>>>>
38256>>>>>>>        // Cmoves.Cmoves_Open_Sp1
38256>>>>>>>
38256>>>>>>>        // Cmoves.Cmoves_Open_Sx2
38256>>>>>>>
38256>>>>>>>        // Cmoves.Cmoves_Open_Sp2
38256>>>>>>>
38256>>>>>>>        // Cmoves.Cmoves_Topen
38256>>>>>>>
38256>>>>>>>        // Cmoves.Cn_Recr
38256>>>>>>>
38256>>>>>>>        // Cmoves.Axia_Pros_Sysx
38256>>>>>>>
38256>>>>>>>        // Cmoves.Axia_Sysxet
38256>>>>>>>
38256>>>>>>>        // Cmoves.Axia_Ypol_Sysx
38256>>>>>>>
38256>>>>>>>        // Cmoves.Axia_Pros_Sys00
38256>>>>>>>
38256>>>>>>>        // Cmoves.Axia_Sysxet00
38256>>>>>>>
38256>>>>>>>        // Cmoves.Axia_Ypol_Sys00
38256>>>>>>>
38256>>>>>>>        // Cmoves.Axia_Pros_Sysr
38256>>>>>>>
38256>>>>>>>        // Cmoves.Axia_Sysxetr
38256>>>>>>>
38256>>>>>>>        // Cmoves.Axia_Ypol_Sysr
38256>>>>>>>
38256>>>>>>>        // Cmoves.Mhxanik_Id
38256>>>>>>>
38256>>>>>>>        // Cmoves.Prn_Theor
38256>>>>>>>
38256>>>>>>>        // Cmoves.Is_Closed
38256>>>>>>>
38256>>>>>>>        // Cmoves.Flag_Copen
38256>>>>>>>
38256>>>>>>>        // Cmoves.Flag_Ypol
38256>>>>>>>
38256>>>>>>>        // Cmoves.Ctypkin_Descr
38256>>>>>>>
38256>>>>>>>        // Cmoves.Client_Name
38256>>>>>>>
38256>>>>>>>        // Cmoves.Enhm_Ofeilh
38256>>>>>>>
38256>>>>>>>        // Cmoves.Sap_Hmnia
38256>>>>>>>
38256>>>>>>>        //DDB-DefineFieldEnd
38256>>>>>>>    End_Procedure    // Define_Fields
38257>>>>>>>
38257>>>>>>>    // Field_Defaults:
38257>>>>>>>    // This procedure is used to establish default field values.
38257>>>>>>>
38257>>>>>>>    Procedure Field_Defaults
38258>>>>>>>        Forward Send Field_Defaults
38260>>>>>>>        //DDB-Generated-Code-Location
38260>>>>>>>        //DDB-FieldDefaultStart
38260>>>>>>>        //DDB-FieldDefaultEnd
38260>>>>>>>    End_Procedure    // Field_Defaults
38261>>>>>>>
38261>>>>>>>End_Class    // Cmoves_DataDictionary
38262>>>>>>>//DDB-Selection-pkg-Start
38262>>>>>>>
38262>>>>>>>Use sl006.SL         // sl006
38262>>>>>>>Use slnomism.sl      // slNomism
INCLUDING FILE: SLNOMISM.SL
38262>>>>>>>>>//AB/ Project slNomism
38262>>>>>>>>>//AB/ Object prj is a Lookup_Project
38262>>>>>>>>>//AB/     Set ProjectName to "slNomism"
38262>>>>>>>>>//AB/     Set ProjectFileName to "slNomism.SL"
38262>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
38262>>>>>>>>>
38262>>>>>>>>>// Project Object Structure
38262>>>>>>>>>//   slNomism is a dbModalPanelSub
38262>>>>>>>>>//     Nomisma_DD is a DataDictionary
38262>>>>>>>>>//     oSelList is a dbListSub
38262>>>>>>>>>//     oOK_bn is a ButtonSub
38262>>>>>>>>>//     oSearch_bn is a ButtonSub
38262>>>>>>>>>
38262>>>>>>>>>// Register all objects
38262>>>>>>>>>Register_Object Nomisma_DD
38262>>>>>>>>>Register_Object oOK_bn
38262>>>>>>>>>Register_Object oSearch_bn
38262>>>>>>>>>Register_Object oSelList
38262>>>>>>>>>Register_Object slNomism
38262>>>>>>>>>
38262>>>>>>>>>
38262>>>>>>>>>//AB-IgnoreStart
38262>>>>>>>>>
38262>>>>>>>>>Use DFAllEnt.pkg
38262>>>>>>>>>Use dbList.Sub
38262>>>>>>>>>Use Button.Sub
38262>>>>>>>>>
38262>>>>>>>>>
38262>>>>>>>>>Use NOMISMA.DD
INCLUDING FILE: NOMISMA.DD
38262>>>>>>>>>>>//DDB-FileStart
38262>>>>>>>>>>>//DDB-HeaderStart
38262>>>>>>>>>>>
38262>>>>>>>>>>>// File Name : NOMISMA.DD
38262>>>>>>>>>>>// Class Name: Nomisma_DataDictionary
38262>>>>>>>>>>>// Revision  : 52
38262>>>>>>>>>>>// Version   : 2
38262>>>>>>>>>>>
38262>>>>>>>>>>>Use  Windows           // Basic Definitions
38262>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
38262>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38262>>>>>>>>>>>
38262>>>>>>>>>>>Open Nomisma
38264>>>>>>>>>>>Open Isotimia
INCLUDING FILE: ISOTIMIA.FD
38266>>>>>>>>>>>Open Particle
38268>>>>>>>>>>>
38268>>>>>>>>>>>//DDB-HeaderEnd
38268>>>>>>>>>>>//DDB-ValidationStart
38268>>>>>>>>>>>
38268>>>>>>>>>>>Register_Object Nomisma_Nomisma_Type_VT
38268>>>>>>>>>>>Register_Object Nomisma_Nomisma_Sign0_VT
38268>>>>>>>>>>>Register_Object Nomisma_Nomisma_Sign00_VT
38268>>>>>>>>>>>Register_Object Nomisma_Nomisma_Signr_VT
38268>>>>>>>>>>>
38268>>>>>>>>>>>Object Nomisma_Nomisma_Type_VT  is a DescriptionValidationTable
38270>>>>>>>>>>>
38270>>>>>>>>>>>    Procedure Fill_List
38272>>>>>>>>>>>        Forward Send Fill_List
38274>>>>>>>>>>>        Send Add_Table_Value  "1"  "Book1"
38275>>>>>>>>>>>        Send Add_Table_Value  "2"  "Book2"
38276>>>>>>>>>>>        Send Add_Table_Value  "3"  "Reporting"
38277>>>>>>>>>>>        Send Add_Table_Value  "0"  "Other"
38278>>>>>>>>>>>    End_Procedure    // Fill_List
38279>>>>>>>>>>>    //DDB-ValidationCustomStart
38279>>>>>>>>>>>    //DDB-ValidationCustomEnd
38279>>>>>>>>>>>End_Object   // Nomisma_Nomisma_Type_VT
38280>>>>>>>>>>>
38280>>>>>>>>>>>Object Nomisma_Nomisma_Sign0_VT  is a DescriptionValidationTable
38282>>>>>>>>>>>
38282>>>>>>>>>>>    Procedure Fill_List
38284>>>>>>>>>>>        Forward Send Fill_List
38286>>>>>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
38287>>>>>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
38288>>>>>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨œ¯ £¦"
38289>>>>>>>>>>>    End_Procedure    // Fill_List
38290>>>>>>>>>>>    //DDB-ValidationCustomStart
38290>>>>>>>>>>>    //DDB-ValidationCustomEnd
38290>>>>>>>>>>>End_Object   // Nomisma_Nomisma_Sign0_VT
38291>>>>>>>>>>>
38291>>>>>>>>>>>Object Nomisma_Nomisma_Sign00_VT  is a DescriptionValidationTable
38293>>>>>>>>>>>
38293>>>>>>>>>>>    Procedure Fill_List
38295>>>>>>>>>>>        Forward Send Fill_List
38297>>>>>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
38298>>>>>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
38299>>>>>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨â¯ £¦"
38300>>>>>>>>>>>    End_Procedure    // Fill_List
38301>>>>>>>>>>>    //DDB-ValidationCustomStart
38301>>>>>>>>>>>    //DDB-ValidationCustomEnd
38301>>>>>>>>>>>End_Object   // Nomisma_Nomisma_Sign00_VT
38302>>>>>>>>>>>
38302>>>>>>>>>>>Object Nomisma_Nomisma_Signr_VT  is a DescriptionValidationTable
38304>>>>>>>>>>>
38304>>>>>>>>>>>    Procedure Fill_List
38306>>>>>>>>>>>        Forward Send Fill_List
38308>>>>>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
38309>>>>>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
38310>>>>>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨â¯ £¦"
38311>>>>>>>>>>>    End_Procedure    // Fill_List
38312>>>>>>>>>>>    //DDB-ValidationCustomStart
38312>>>>>>>>>>>    //DDB-ValidationCustomEnd
38312>>>>>>>>>>>End_Object   // Nomisma_Nomisma_Signr_VT
38313>>>>>>>>>>>//DDB-ValidationEnd
38313>>>>>>>>>>>//DDB-SelectionStart
38313>>>>>>>>>>>//DDB/ ExternalSelectionList sl059  sl059.sl
38313>>>>>>>>>>>Register_Object sl059
38313>>>>>>>>>>>//DDB-SelectionEnd
38313>>>>>>>>>>>
38313>>>>>>>>>>>Class Nomisma_DataDictionary  is a DataDictionary_Sec
38314>>>>>>>>>>>
38314>>>>>>>>>>>    Procedure Construct_Object
38315>>>>>>>>>>>        Forward Send Construct_Object
38317>>>>>>>>>>>        Property String psOldCode Public ''
38318>>>>>>>>>>>    End_procedure
38319>>>>>>>>>>>
38319>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
38320>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
38322>>>>>>>>>>>        Set psOldCode to Nomisma.Nomisma_Code
38323>>>>>>>>>>>    End_Procedure   // New_Current_Record
38324>>>>>>>>>>>
38324>>>>>>>>>>>    Procedure Save_Main_File
38325>>>>>>>>>>>        If ((Operation_Origin<>Self) And;             (Nomisma.Recnum=0)) Procedure_Return
38328>>>>>>>>>>>        Forward Send Save_Main_File
38330>>>>>>>>>>>    End_Procedure   // Save_Main_File
38331>>>>>>>>>>>
38331>>>>>>>>>>>    Function Validate_Save  Returns Integer
38332>>>>>>>>>>>        Local Integer iReturnVal 
38333>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
38335>>>>>>>>>>>        If (Not(iReturnVal)) ;            Begin
38337>>>>>>>>>>>                     If  Nomisma.nomisma_Code eq ''                 Move 6220 to iReturnVal
38340>>>>>>>>>>>                Else If (Nomisma.Nomisma_Code <>(psOldCode(Self)) And ;                         (psOldCode(Self)<>''))  Move 6030 to iReturnVal
38344>>>>>>>>>>>                if iReturnVal Send Operation_Not_Allowed iReturnVal
38347>>>>>>>>>>>            End
38347>>>>>>>>>>>>
38347>>>>>>>>>>>        Function_Return iReturnVal
38348>>>>>>>>>>>    End_Function   // Validate_Save
38349>>>>>>>>>>>
38349>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
38350>>>>>>>>>>>             if iError_num eq 6220 error 6220 "Œ¦£ ©£˜«˜ => ‰à› ¡æª ¡œ¤æª "
38353>>>>>>>>>>>        Else if iError_num eq 6030 error 6030 "„§ ¢â¥«œ ¤æ£ ©£˜ ˜§¦ «ž¤ ¢å©«˜ £œ (F4)\nž §˜«ã©«œ §¨é«˜ F5 ©«¦ ž›ž ¬§á¨®¦¤\nà©«œ ¤˜ ¡˜Ÿ˜¨å©œ  ž ˜¨® ¡ã «¦¬ « £ã\n§¨å¤ œ§ ¢â¥œ«œ á¢¢¦"
38357>>>>>>>>>>>        //Else if iError_num eq 6030 error 6030 "ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ©«¦ ¡à› ¡æ ¤¦£å©£˜«¦ª"
38357>>>>>>>>>>>        else Forward Send Operation_Not_Allowed  iError_Num
38360>>>>>>>>>>>    End_Procedure   // Operation_Not_Allowed
38361>>>>>>>>>>>
38361>>>>>>>>>>>    Procedure Update
38362>>>>>>>>>>>        Forward Send Update
38364>>>>>>>>>>>        // Insert Code Here
38364>>>>>>>>>>>        SYSDATE NOMISMA.LUP
38365>>>>>>>>>>>    End_Procedure   // Update
38366>>>>>>>>>>>
38366>>>>>>>>>>>    Procedure Creating
38367>>>>>>>>>>>        Forward Send Creating
38369>>>>>>>>>>>        // Insert Code Here
38369>>>>>>>>>>>        SYSDATE NOMISMA.FUP
38370>>>>>>>>>>>    End_Procedure   // Creating
38371>>>>>>>>>>>
38371>>>>>>>>>>>    // Define_Fields:
38371>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
38371>>>>>>>>>>>
38371>>>>>>>>>>>    Procedure Define_Fields
38372>>>>>>>>>>>        Forward Send Define_Fields
38374>>>>>>>>>>>        //DDB-Generated-Code-Location
38374>>>>>>>>>>>        //DDB-DefineFieldStart
38374>>>>>>>>>>>
38374>>>>>>>>>>>        Set Main_File            To Nomisma.File_Number
38375>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
38376>>>>>>>>>>>
38376>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
38377>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
38378>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38379>>>>>>>>>>>
38379>>>>>>>>>>>        // Child (Client) file structure................
38379>>>>>>>>>>>        Send Add_Client_File  Isotimia.File_Number
38380>>>>>>>>>>>        Send Add_Client_File  Particle.File_Number
38381>>>>>>>>>>>
38381>>>>>>>>>>>        // Field-based properties.......................
38381>>>>>>>>>>>
38381>>>>>>>>>>>        // Nomisma.Nomisma_Code
38381>>>>>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Code To DD_AUTOFIND    DD_CAPSLOCK   
38382>>>>>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Code To (sl059(Self))
38383>>>>>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Code To TRUE
38384>>>>>>>>>>>
38384>>>>>>>>>>>        // Nomisma.Nomisma_Descr
38384>>>>>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Descr To DD_CAPSLOCK   
38385>>>>>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Descr To (sl059(Self))
38386>>>>>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Descr To TRUE
38387>>>>>>>>>>>
38387>>>>>>>>>>>        // Nomisma.Nomisma_Short
38387>>>>>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Short To DD_CAPSLOCK   
38388>>>>>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Short To (sl059(Self))
38389>>>>>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Short To TRUE
38390>>>>>>>>>>>
38390>>>>>>>>>>>        // Nomisma.Dekadika
38390>>>>>>>>>>>
38390>>>>>>>>>>>        // Nomisma.Fup
38390>>>>>>>>>>>
38390>>>>>>>>>>>        // Nomisma.Lup
38390>>>>>>>>>>>
38390>>>>>>>>>>>        // Nomisma.Euro_Zone
38390>>>>>>>>>>>
38390>>>>>>>>>>>        // Nomisma.Einai_Drx
38390>>>>>>>>>>>
38390>>>>>>>>>>>        // Nomisma.Einai_Euro
38390>>>>>>>>>>>
38390>>>>>>>>>>>        // Nomisma.Monades
38390>>>>>>>>>>>
38390>>>>>>>>>>>        // Nomisma.Kl_Isot_Euro
38390>>>>>>>>>>>
38390>>>>>>>>>>>        // Nomisma.Nomisma_Type
38390>>>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Type To (Nomisma_Nomisma_Type_VT(Self))
38391>>>>>>>>>>>
38391>>>>>>>>>>>        // Nomisma.Nomisma_Sign0
38391>>>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Sign0 To (Nomisma_Nomisma_Sign0_VT(Self))
38392>>>>>>>>>>>
38392>>>>>>>>>>>        // Nomisma.Nomisma_Sign00
38392>>>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Sign00 To (Nomisma_Nomisma_Sign00_VT(Self))
38393>>>>>>>>>>>
38393>>>>>>>>>>>        // Nomisma.Nomisma_Signr
38393>>>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Signr To (Nomisma_Nomisma_Signr_VT(Self))
38394>>>>>>>>>>>
38394>>>>>>>>>>>        //DDB-DefineFieldEnd
38394>>>>>>>>>>>    End_Procedure    // Define_Fields
38395>>>>>>>>>>>
38395>>>>>>>>>>>    // Field_Defaults:
38395>>>>>>>>>>>    // This procedure is used to establish default field values.
38395>>>>>>>>>>>
38395>>>>>>>>>>>    Procedure Field_Defaults
38396>>>>>>>>>>>        Forward Send Field_Defaults
38398>>>>>>>>>>>        //DDB-Generated-Code-Location
38398>>>>>>>>>>>        //DDB-FieldDefaultStart
38398>>>>>>>>>>>        //DDB-FieldDefaultEnd
38398>>>>>>>>>>>    End_Procedure    // Field_Defaults
38399>>>>>>>>>>>
38399>>>>>>>>>>>End_Class    // Nomisma_DataDictionary
38400>>>>>>>>>>>//DDB-Selection-pkg-Start
38400>>>>>>>>>>>
38400>>>>>>>>>>>Use sl059.sl         // sl059
INCLUDING FILE: SL059.SL
38400>>>>>>>>>>>>>//AB/ Project sl059
38400>>>>>>>>>>>>>//AB/     Object prj is a LOOKUP_Project
38400>>>>>>>>>>>>>//AB/         Set ProjectName to "sl059"
38400>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl059.SL"
38400>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
38400>>>>>>>>>>>>>
38400>>>>>>>>>>>>>    //AB-IgnoreStart
38400>>>>>>>>>>>>>
38400>>>>>>>>>>>>>
38400>>>>>>>>>>>>>
38400>>>>>>>>>>>>>
38400>>>>>>>>>>>>>    Use NOMISMA.DD
38400>>>>>>>>>>>>>
38400>>>>>>>>>>>>>    //AB-IgnoreEnd
38400>>>>>>>>>>>>>
38400>>>>>>>>>>>>>    CD_Popup_Object sl059 is a dbModalPanelSub
38419>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
38420>>>>>>>>>>>>>        Set Modal_State to FALSE
38421>>>>>>>>>>>>>        Set Popup_State to FALSE
38422>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
38423>>>>>>>>>>>>>        set label to "Œ¦£å©£˜«˜" 
38424>>>>>>>>>>>>>        Set Size to 148 295
38425>>>>>>>>>>>>>        Set Location to 4 5
38426>>>>>>>>>>>>>
38426>>>>>>>>>>>>>        //AB-DDOStart
38426>>>>>>>>>>>>>
38426>>>>>>>>>>>>>        Object Nomisma_DD is a Nomisma_DataDictionary
38428>>>>>>>>>>>>>        End_Object    // Nomisma_DD
38429>>>>>>>>>>>>>
38429>>>>>>>>>>>>>        Set Main_DD to (Nomisma_DD(Current_Object))
38430>>>>>>>>>>>>>        Set Server to (Nomisma_DD(Current_Object))
38431>>>>>>>>>>>>>
38431>>>>>>>>>>>>>        //AB-DDOEnd
38431>>>>>>>>>>>>>
38431>>>>>>>>>>>>>        Object oSelList is a dbListSub
38433>>>>>>>>>>>>>            Set Main_File to Nomisma.File_Number
38434>>>>>>>>>>>>>            Set Size to 105 278
38435>>>>>>>>>>>>>            Set Location to 6 6
38436>>>>>>>>>>>>>
38436>>>>>>>>>>>>>            Begin_Row
38439>>>>>>>>>>>>>                Entry_Item Nomisma.Nomisma_code
38440>>>>>>>>>>>>>                Entry_Item Nomisma.Nomisma_descr
38441>>>>>>>>>>>>>                Entry_Item Nomisma.Nomisma_short
38442>>>>>>>>>>>>>                Entry_Item Nomisma.Dekadika
38443>>>>>>>>>>>>>            End_Row
38448>>>>>>>>>>>>>
38448>>>>>>>>>>>>>            Set Form_Width    item 0 to 45
38449>>>>>>>>>>>>>            set header_label  item 0 to "‰à› ¡¦ª" 
38450>>>>>>>>>>>>>
38450>>>>>>>>>>>>>            Set Form_Width    item 1 to 115
38451>>>>>>>>>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
38452>>>>>>>>>>>>>
38452>>>>>>>>>>>>>            Set Form_Width    item 2 to 58
38453>>>>>>>>>>>>>            set header_label  item 2 to "‘ç¤«¦£ž" 
38454>>>>>>>>>>>>>
38454>>>>>>>>>>>>>            Set Form_Width    item 3 to 54
38455>>>>>>>>>>>>>            set header_label  item 3 to "ƒœ¡˜› ¡á" 
38456>>>>>>>>>>>>>
38456>>>>>>>>>>>>>        End_Object    // oSelList
38457>>>>>>>>>>>>>
38457>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
38459>>>>>>>>>>>>>            set label to "&„§ ¢¦šã" 
38460>>>>>>>>>>>>>            Set Location to 113 124
38461>>>>>>>>>>>>>
38461>>>>>>>>>>>>>            //AB-StoreStart
38461>>>>>>>>>>>>>            Procedure OnClick
38463>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
38464>>>>>>>>>>>>>            End_Procedure
38465>>>>>>>>>>>>>            //AB-StoreEnd
38465>>>>>>>>>>>>>
38465>>>>>>>>>>>>>        End_Object    // oOK_bn
38466>>>>>>>>>>>>>
38466>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
38468>>>>>>>>>>>>>            set label to "&€¡ç¨à©ž" 
38469>>>>>>>>>>>>>            Set Location to 113 179
38470>>>>>>>>>>>>>
38470>>>>>>>>>>>>>            //AB-StoreStart
38470>>>>>>>>>>>>>            Procedure OnClick
38472>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
38473>>>>>>>>>>>>>            End_Procedure
38474>>>>>>>>>>>>>            //AB-StoreEnd
38474>>>>>>>>>>>>>
38474>>>>>>>>>>>>>        End_Object    // oCancel_bn
38475>>>>>>>>>>>>>
38475>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
38477>>>>>>>>>>>>>            set label to "€&¤˜ã«ž©ž" 
38478>>>>>>>>>>>>>            Set Location to 113 234
38479>>>>>>>>>>>>>
38479>>>>>>>>>>>>>            //AB-StoreStart
38479>>>>>>>>>>>>>            Procedure OnClick
38481>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
38482>>>>>>>>>>>>>            End_Procedure
38483>>>>>>>>>>>>>            //AB-StoreEnd
38483>>>>>>>>>>>>>
38483>>>>>>>>>>>>>        End_Object    // oSearch_bn
38484>>>>>>>>>>>>>
38484>>>>>>>>>>>>>
38484>>>>>>>>>>>>>        //AB-StoreStart
38484>>>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
38485>>>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
38486>>>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
38487>>>>>>>>>>>>>        //AB-StoreEnd
38487>>>>>>>>>>>>>
38487>>>>>>>>>>>>>    CD_End_Object    // sl059
38489>>>>>>>>>>>>>>
38489>>>>>>>>>>>>>
38489>>>>>>>>>>>>>//AB/     End_Object    // prj
38489>>>>>>>>>>>
38489>>>>>>>>>>>//DDB-Selection-pkg-End
38489>>>>>>>>>>>//DDB-FileEnd
38489>>>>>>>>>
38489>>>>>>>>>//AB-IgnoreEnd
38489>>>>>>>>>
38489>>>>>>>>>Object slNomism is a dbModalPanelSub
38491>>>>>>>>>
38491>>>>>>>>>    //AB-StoreTopStart
38491>>>>>>>>>    
38491>>>>>>>>>    
38491>>>>>>>>>    
38491>>>>>>>>>    //AB-StoreTopEnd
38491>>>>>>>>>
38491>>>>>>>>>    Set Label to "Œ¦£å©£˜«˜"
38492>>>>>>>>>    Set Size to 175 397
38493>>>>>>>>>    Set Location to 5 7
38494>>>>>>>>>    Set Exit_Application_Local_State to FALSE
38495>>>>>>>>>    Set Modal_State to FALSE
38496>>>>>>>>>
38496>>>>>>>>>    //AB-DDOStart
38496>>>>>>>>>
38496>>>>>>>>>    Object Nomisma_DD is a Nomisma_DataDictionary
38498>>>>>>>>>    End_Object    // Nomisma_DD
38499>>>>>>>>>
38499>>>>>>>>>    Set Main_DD to (Nomisma_DD(self))
38500>>>>>>>>>    Set Server to (Nomisma_DD(self))
38501>>>>>>>>>
38501>>>>>>>>>    //AB-DDOEnd
38501>>>>>>>>>
38501>>>>>>>>>    Object oSelList is a dbListSub
38503>>>>>>>>>        Set Main_File to Nomisma.File_Number
38504>>>>>>>>>        Set Size to 130 382
38505>>>>>>>>>        Set Location to 6 6
38506>>>>>>>>>
38506>>>>>>>>>        Begin_Row
38509>>>>>>>>>            Entry_Item Nomisma.Nomisma_code
38510>>>>>>>>>            Entry_Item Nomisma.Nomisma_descr
38511>>>>>>>>>            Entry_Item Nomisma.Dekadika
38512>>>>>>>>>            Entry_Item Nomisma.Euro_zone
38513>>>>>>>>>            Entry_Item Nomisma.Einai_drx
38514>>>>>>>>>            Entry_Item Nomisma.Einai_euro
38515>>>>>>>>>        End_Row
38520>>>>>>>>>
38520>>>>>>>>>        Set Form_Width    item 0 to 49
38521>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
38522>>>>>>>>>        
38522>>>>>>>>>        Set Form_Width    item 1 to 115
38523>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
38524>>>>>>>>>        
38524>>>>>>>>>        Set Form_Width    item 2 to 47
38525>>>>>>>>>        Set Header_Label  item 2 to "ƒœ¡˜› ¡á"
38526>>>>>>>>>        
38526>>>>>>>>>        Set Form_Width    item 3 to 55
38527>>>>>>>>>        Set Header_Label  item 3 to "…é¤ž EURO"
38528>>>>>>>>>        Set Column_Checkbox_State  item 3 to True
38529>>>>>>>>>        
38529>>>>>>>>>        Set Form_Width    item 4 to 55
38530>>>>>>>>>        Set Header_Label  item 4 to "„å¤˜  ƒ•"
38531>>>>>>>>>        Set Column_Checkbox_State  item 4 to True
38532>>>>>>>>>        
38532>>>>>>>>>        Set Form_Width    item 5 to 55
38533>>>>>>>>>        Set Header_Label  item 5 to "„å¤˜  „¬¨é"
38534>>>>>>>>>        Set Column_Checkbox_State  item 5 to True
38535>>>>>>>>>        
38535>>>>>>>>>
38535>>>>>>>>>        //AB-StoreStart
38535>>>>>>>>>        
38535>>>>>>>>>        //AB-StoreEnd
38535>>>>>>>>>
38535>>>>>>>>>    End_Object    // oSelList
38536>>>>>>>>>
38536>>>>>>>>>    Object oOK_bn is a ButtonSub
38538>>>>>>>>>        Set Label to "&„§ ¢¦šã"
38539>>>>>>>>>        Set Location to 140 279
38540>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
38541>>>>>>>>>
38541>>>>>>>>>        //AB-StoreStart
38541>>>>>>>>>        Procedure OnClick
38543>>>>>>>>>            Send OK To (oSelList(current_object))
38544>>>>>>>>>        End_Procedure
38545>>>>>>>>>        //AB-StoreEnd
38545>>>>>>>>>
38545>>>>>>>>>    End_Object    // oOK_bn
38546>>>>>>>>>
38546>>>>>>>>>    Object oSearch_bn is a ButtonSub
38548>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
38549>>>>>>>>>        Set Location to 140 339
38550>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
38551>>>>>>>>>
38551>>>>>>>>>        //AB-StoreStart
38551>>>>>>>>>        
38551>>>>>>>>>        Procedure OnClick
38553>>>>>>>>>            Send Search To (oSelList(current_object))
38554>>>>>>>>>        End_Procedure
38555>>>>>>>>>        
38555>>>>>>>>>        
38555>>>>>>>>>        Set Visible_State to False
38556>>>>>>>>>        Set Enabled_State to False
38557>>>>>>>>>        //AB-StoreEnd
38557>>>>>>>>>
38557>>>>>>>>>    End_Object    // oSearch_bn
38558>>>>>>>>>
38558>>>>>>>>>
38558>>>>>>>>>    //AB-StoreStart
38558>>>>>>>>>    
38558>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
38559>>>>>>>>>    
38559>>>>>>>>>    On_Key Key_Alt+Key_s Send KeyAction To (oSearch_bn(current_object))
38560>>>>>>>>>    
38560>>>>>>>>>    
38560>>>>>>>>>    
38560>>>>>>>>>    
38560>>>>>>>>>    //AB-StoreEnd
38560>>>>>>>>>
38560>>>>>>>>>End_Object    // slNomism
38561>>>>>>>>>
38561>>>>>>>>>//AB/ End_Object    // prj
38561>>>>>>>Use sl041.SL         // sl041
INCLUDING FILE: SL041.SL
38561>>>>>>>>>//AB/ Project CN : sl041
38561>>>>>>>>>//AB/     Object prj is a Lookup_Project
38561>>>>>>>>>//AB/         Set ProjectName to "CN : sl041"
38561>>>>>>>>>//AB/         Set ProjectFileName to "sl041.SL"
38561>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
38561>>>>>>>>>
38561>>>>>>>>>// Project Object Structure
38561>>>>>>>>>//   sl041 is a dbModalPanelSub
38561>>>>>>>>>//     Clients_DD is a DataDictionary
38561>>>>>>>>>//     Cn_DD is a DataDictionary
38561>>>>>>>>>//     oSelList is a dbListSub
38561>>>>>>>>>//     oOK_bn is a ButtonSub
38561>>>>>>>>>//     oCancel_bn is a ButtonSub
38561>>>>>>>>>//     oSearch_bn is a ButtonSub
38561>>>>>>>>>
38561>>>>>>>>>// Register all objects
38561>>>>>>>>>Register_Object Clients_DD
38561>>>>>>>>>Register_Object Cn_DD
38561>>>>>>>>>Register_Object oCancel_bn
38561>>>>>>>>>Register_Object oOK_bn
38561>>>>>>>>>Register_Object oSearch_bn
38561>>>>>>>>>Register_Object oSelList
38561>>>>>>>>>Register_Object sl041
38561>>>>>>>>>
38561>>>>>>>>>
38561>>>>>>>>>    //AB-IgnoreStart
38561>>>>>>>>>
38561>>>>>>>>>    Use DFAllEnt.pkg
38561>>>>>>>>>    Use dbList.Sub
38561>>>>>>>>>    Use Button.Sub
38561>>>>>>>>>
38561>>>>>>>>>
38561>>>>>>>>>    Use CLIENTS.DD
38561>>>>>>>>>    Use CN.DD
INCLUDING FILE: CN.DD
38561>>>>>>>>>>>//DDB-FileStart
38561>>>>>>>>>>>//DDB-HeaderStart
38561>>>>>>>>>>>
38561>>>>>>>>>>>// File Name : CN.DD
38561>>>>>>>>>>>// Class Name: Cn_DataDictionary
38561>>>>>>>>>>>// Revision  : 99
38561>>>>>>>>>>>// Version   : 2
38561>>>>>>>>>>>
38561>>>>>>>>>>>Use  Windows           // Basic Definitions
38561>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
38561>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38561>>>>>>>>>>>
38561>>>>>>>>>>>Open Cn
38563>>>>>>>>>>>Open Cnzones
INCLUDING FILE: CNZONES.FD
38565>>>>>>>>>>>Open Tperga
INCLUDING FILE: TPERGA.FD
38567>>>>>>>>>>>Open Btnordh
INCLUDING FILE: BTNORDH.FD
38569>>>>>>>>>>>Open Dorderh
INCLUDING FILE: DORDERH.FD
38571>>>>>>>>>>>Open Clients
38573>>>>>>>>>>>Open Salesmen
38575>>>>>>>>>>>Open Mhxanik
38577>>>>>>>>>>>Open Constrct
38579>>>>>>>>>>>Open Sysrecc
38581>>>>>>>>>>>Open Syscurxr
38583>>>>>>>>>>>Open Gmove
38585>>>>>>>>>>>Open Sysrecg
38587>>>>>>>>>>>
38587>>>>>>>>>>>//DDB-HeaderEnd
38587>>>>>>>>>>>//DDB-ValidationStart
38587>>>>>>>>>>>
38587>>>>>>>>>>>Register_Object Cn_Cn_Categfpa_VT1
38587>>>>>>>>>>>Register_Object Cn_Tropos_Metaf_VT
38587>>>>>>>>>>>Register_Object Cn_Eidos_Cn_VT
38587>>>>>>>>>>>Register_Object Cn_Yesno_VT
38587>>>>>>>>>>>
38587>>>>>>>>>>>Object Cn_Cn_Categfpa_VT1  is a CodeValidationTable
38589>>>>>>>>>>>    Set Type_Value        To "VAT_STATUS"
38590>>>>>>>>>>>    Set Validate_State    To FALSE
38591>>>>>>>>>>>    Set Allow_Blank_State To TRUE
38592>>>>>>>>>>>    //DDB-ValidationCustomStart
38592>>>>>>>>>>>    //DDB-ValidationCustomEnd
38592>>>>>>>>>>>End_Object   // Cn_Cn_Categfpa_VT1
38593>>>>>>>>>>>
38593>>>>>>>>>>>Object Cn_Tropos_Metaf_VT  is a CodeValidationTable
38595>>>>>>>>>>>    Set Type_Value        To "FORTOSH"
38596>>>>>>>>>>>    Set Allow_Blank_State To TRUE
38597>>>>>>>>>>>    Set Table_Title       To "’¨æ§¦  ‹œ«˜­¦¨áª"
38598>>>>>>>>>>>    //DDB-ValidationCustomStart
38598>>>>>>>>>>>    //DDB-ValidationCustomEnd
38598>>>>>>>>>>>End_Object   // Cn_Tropos_Metaf_VT
38599>>>>>>>>>>>
38599>>>>>>>>>>>Object Cn_Eidos_Cn_VT  is a CodeValidationTable
38601>>>>>>>>>>>    Set Type_Value        To "EIDOSCN"
38602>>>>>>>>>>>    Set Allow_Blank_State To TRUE
38603>>>>>>>>>>>    Set Table_Title       To "„å›¦ª „¨š¦¬"
38604>>>>>>>>>>>    //DDB-ValidationCustomStart
38604>>>>>>>>>>>    //DDB-ValidationCustomEnd
38604>>>>>>>>>>>End_Object   // Cn_Eidos_Cn_VT
38605>>>>>>>>>>>
38605>>>>>>>>>>>Object Cn_Yesno_VT  is a CodeValidationTable
38607>>>>>>>>>>>    Set Type_Value        To "YESNO"
38608>>>>>>>>>>>    Set Allow_Blank_State To TRUE
38609>>>>>>>>>>>    //DDB-ValidationCustomStart
38609>>>>>>>>>>>    //DDB-ValidationCustomEnd
38609>>>>>>>>>>>End_Object   // Cn_Yesno_VT
38610>>>>>>>>>>>//DDB-ValidationEnd
38610>>>>>>>>>>>//DDB-SelectionStart
38610>>>>>>>>>>>//DDB/ ExternalSelectionList sl041  sl041.sl
38610>>>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
38610>>>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
38610>>>>>>>>>>>Register_Object sl041
38610>>>>>>>>>>>Register_Object sl198
38610>>>>>>>>>>>Register_Object sl197
38610>>>>>>>>>>>//DDB-SelectionEnd
38610>>>>>>>>>>>
38610>>>>>>>>>>>Class Cn_DataDictionary  is a DataDictionary_Sec
38611>>>>>>>>>>>
38611>>>>>>>>>>>
38611>>>>>>>>>>>    Procedure Construct_Object
38612>>>>>>>>>>>        Forward Send Construct_Object
38614>>>>>>>>>>>        //------------------------------------------------
38614>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
38614>>>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
38614>>>>>>>>>>>        // einai 1     js 03/12/2007
38614>>>>>>>>>>>        //------------------------------------------------  
38614>>>>>>>>>>>        Property Integer piCreateNew            Public  0
38615>>>>>>>>>>>        Property String  psAud_Old_CN           Public ""
38616>>>>>>>>>>>        Property String  psAud_Old_CNAdd        Public ""
38617>>>>>>>>>>>        Property String  psAud_Old_Chem         Public ""
38618>>>>>>>>>>>        Property String  psAud_Old_CNRecr       Public ""
38619>>>>>>>>>>>        //------------------------------------------------
38619>>>>>>>>>>>
38619>>>>>>>>>>>    End_procedure
38620>>>>>>>>>>>
38620>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
38621>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
38623>>>>>>>>>>>        //------------------------------------------------
38623>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
38623>>>>>>>>>>>        // ton pedion js 03/12/2007
38623>>>>>>>>>>>        //------------------------------------------------
38623>>>>>>>>>>>        Set psAud_Old_CN           to CN.CN_Code
38624>>>>>>>>>>>        Set psAud_Old_CNAdd        to CN.CN_Descr
38625>>>>>>>>>>>        Set psAud_Old_Chem         to CN.CN_VTicket
38626>>>>>>>>>>>        Set psAud_Old_CNRecr       to CN.CN_Recr
38627>>>>>>>>>>>        //------------------------------------------------
38627>>>>>>>>>>>     End_Procedure   // New_Current_Record
38628>>>>>>>>>>>
38628>>>>>>>>>>>    Procedure Delete_Main_File
38629>>>>>>>>>>>        //---------------------------------------------
38629>>>>>>>>>>>        // Auditing / Katagrafh allagon
38629>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
38630>>>>>>>>>>>        Date    dDate  Shmer 
38630>>>>>>>>>>>        Integer iMin iHour iSec iLen
38630>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
38634>>>>>>>>>>>        Move iHour  to sHour
38635>>>>>>>>>>>        Move iMin   to sMin
38636>>>>>>>>>>>        Move iSec   to sSec
38637>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
38641>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
38645>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
38649>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
38650>>>>>>>>>>>        
38650>>>>>>>>>>>        // Auditing / Diagrafh 
38650>>>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
38652>>>>>>>>>>>            Get fsLoginUserID to sUser
38653>>>>>>>>>>>            clear gmove
38654>>>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
38655>>>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
38656>>>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
38657>>>>>>>>>>>            move  4                     to gmove.gtypkin_code// Apo Clients
38658>>>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
38659>>>>>>>>>>>            move suser                  to gmove.gplan_code
38660>>>>>>>>>>>            move CN.CN_Recr             to gmove.garticl_recr
38661>>>>>>>>>>>            reread sysrecg
38665>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
38666>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
38667>>>>>>>>>>>            saverecord sysrecg
38668>>>>>>>>>>>            unlock
38669>>>>>>>>>>>>
38669>>>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
38670>>>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
38671>>>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
38672>>>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
38673>>>>>>>>>>>            
38673>>>>>>>>>>>            Move CN.CN_Recr                     to Gmove.Partl_Recr          
38674>>>>>>>>>>>            Move CN.CN_Recr                     to Gmove.Pms_Recr          
38675>>>>>>>>>>>
38675>>>>>>>>>>>            Move (psAud_Old_CN    (Self))       to Gmove.Prev_CN
38676>>>>>>>>>>>            Move (psAud_Old_CNAdd (Self))       to Gmove.Prev_CN_Addr
38677>>>>>>>>>>>            Move (psAud_Old_Chem  (Self))       to Gmove.Prev_CN_Prosth
38678>>>>>>>>>>>
38678>>>>>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª ë¨š¦¬"      to gmove.gmove_aitiol
38679>>>>>>>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
38680>>>>>>>>>>>            saverecord gmove
38681>>>>>>>>>>>        End
38681>>>>>>>>>>>>
38681>>>>>>>>>>>        Forward Send Delete_Main_File
38683>>>>>>>>>>>
38683>>>>>>>>>>>    End_Procedure
38684>>>>>>>>>>>
38684>>>>>>>>>>>    Procedure Update
38685>>>>>>>>>>>        Forward Send Update
38687>>>>>>>>>>>        // Insert Code Here
38687>>>>>>>>>>>        Move SysCurXR.Company_Code  to CN.Company_Code
38688>>>>>>>>>>>        Move SysCurXR.Branch_Code   to CN.Branch_Code
38689>>>>>>>>>>>        Move SysCurXR.Year_Year     to CN.Year_Year
38690>>>>>>>>>>>        //Move Custprom.Custprom_Code to CN.Custprom_Code
38690>>>>>>>>>>>        Move Clients.Client_ID      to CN.Client_ID
38691>>>>>>>>>>>
38691>>>>>>>>>>>        Move SysCurXR.Beto_Site      to CN.Cn_SiteW
38692>>>>>>>>>>>        Move Cn.Cn_Rec0              to CN.Cn_SN
38693>>>>>>>>>>>        Move Cn.Client_id            to Cn.Cn_clientid
38694>>>>>>>>>>>        Move Cn.cn_code              to Cn.Cn_Repmatch
38695>>>>>>>>>>>        Move Cn.Cn_Code              to Cn.Constraction_ID
38696>>>>>>>>>>>        Move PayResp.Presp_ID        to Cn.Cn_Presp_ID
38697>>>>>>>>>>>        Move Salesmen.Sls_ID         to Cn.Cn_Sls_ID
38698>>>>>>>>>>>        Move Constrct.Cnt_ID         to Cn.Cn_Cnt_ID
38699>>>>>>>>>>>        Move mhxanik.mhx_id          to Cn.mhxanik_ID
38700>>>>>>>>>>>
38700>>>>>>>>>>>        //---------------------------------------------
38700>>>>>>>>>>>        // Auditing / Katagrafh allagon
38700>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
38701>>>>>>>>>>>        Date    dDate  Shmer 
38701>>>>>>>>>>>        Integer iMin iHour iSec iLen
38701>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
38705>>>>>>>>>>>        Move iHour  to sHour
38706>>>>>>>>>>>        Move iMin   to sMin
38707>>>>>>>>>>>        Move iSec   to sSec
38708>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
38712>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
38716>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
38720>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
38721>>>>>>>>>>>        
38721>>>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
38721>>>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
38723>>>>>>>>>>>            Get fsLoginUserID to sUser
38724>>>>>>>>>>>            If (piCreateNew(Self)=1) Begin
38726>>>>>>>>>>>                clear gmove
38727>>>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
38728>>>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
38729>>>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
38730>>>>>>>>>>>                move  4                     to gmove.gtypkin_code// Apo Clients
38731>>>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
38732>>>>>>>>>>>                move suser                  to gmove.gplan_code
38733>>>>>>>>>>>                move CN.CN_Recr             to gmove.garticl_recr
38734>>>>>>>>>>>                reread sysrecg
38738>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
38739>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
38740>>>>>>>>>>>                saverecord sysrecg
38741>>>>>>>>>>>                unlock
38742>>>>>>>>>>>>
38742>>>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
38743>>>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
38744>>>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
38745>>>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
38746>>>>>>>>>>>
38746>>>>>>>>>>>                Move CN.CN_Recr                 to Gmove.Partl_Recr          
38747>>>>>>>>>>>                Move CN.CN_Recr                 to Gmove.Pms_Recr          
38748>>>>>>>>>>>
38748>>>>>>>>>>>                Move CN.CN_Code                 to Gmove.Cur_CN
38749>>>>>>>>>>>                Move CN.CN_Descr                to Gmove.Cur_CN_Addr
38750>>>>>>>>>>>                Move CN.CN_VTicket              to Gmove.Cur_CN_Prosth
38751>>>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â¦¬ ë¨š¦¬"    to Gmove.Gmove_Aitiol
38752>>>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs  
38753>>>>>>>>>>>                saverecord gmove
38754>>>>>>>>>>>                Set piCreateNew to 0
38755>>>>>>>>>>>            End
38755>>>>>>>>>>>>
38755>>>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
38758>>>>>>>>>>>                Integer isChanged
38758>>>>>>>>>>>                Move 0 to isChanged
38759>>>>>>>>>>>                
38759>>>>>>>>>>>                     If (psAud_Old_CN   (Self)<>CN.CN_Code   ) Move 1 to isChanged
38762>>>>>>>>>>>                Else If (psAud_Old_CNAdd(Self)<>CN.CN_Descr  ) Move 1 to isChanged
38766>>>>>>>>>>>                Else If (psAud_Old_Chem (Self)<>CN.CN_VTicket) Move 1 to isChanged
38770>>>>>>>>>>>                
38770>>>>>>>>>>>                If (isChanged>0) Begin  
38772>>>>>>>>>>>                    clear gmove
38773>>>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
38774>>>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
38775>>>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
38776>>>>>>>>>>>                    move  4                     to gmove.gtypkin_code// Apo Clients
38777>>>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
38778>>>>>>>>>>>                    move suser                  to gmove.gplan_code
38779>>>>>>>>>>>                    move Payresp.Presp_Recr    to gmove.garticl_recr
38780>>>>>>>>>>>                    reread sysrecg
38784>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
38785>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
38786>>>>>>>>>>>                    saverecord sysrecg
38787>>>>>>>>>>>                    unlock
38788>>>>>>>>>>>>
38788>>>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
38789>>>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
38790>>>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
38791>>>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
38792>>>>>>>>>>>                    Move CN.CN_Recr                     to Gmove.Partl_Recr          
38793>>>>>>>>>>>                    Move CN.CN_Recr                     to Gmove.Pms_Recr          
38794>>>>>>>>>>>                    //--                                
38794>>>>>>>>>>>                    Move CN.CN_Code                     to Gmove.Cur_CN
38795>>>>>>>>>>>                    Move CN.CN_Descr                    to Gmove.Cur_CN_Addr
38796>>>>>>>>>>>                    Move CN.CN_VTicket                  to Gmove.Cur_CN_Prosth
38797>>>>>>>>>>>                    //--
38797>>>>>>>>>>>                    Move (psAud_Old_CN    (Self))       to Gmove.Prev_CN
38798>>>>>>>>>>>                    Move (psAud_Old_CNAdd (Self))       to Gmove.Prev_CN_Addr
38799>>>>>>>>>>>                    Move (psAud_Old_Chem  (Self))       to Gmove.Prev_CN_Prosth
38800>>>>>>>>>>>
38800>>>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª ë¨š¦¬"      to gmove.gmove_aitiol
38801>>>>>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
38802>>>>>>>>>>>                    saverecord gmove
38803>>>>>>>>>>>                    Set piCreateNew to 0
38804>>>>>>>>>>>                End
38804>>>>>>>>>>>>
38804>>>>>>>>>>>            End
38804>>>>>>>>>>>>
38804>>>>>>>>>>>        End
38804>>>>>>>>>>>>
38804>>>>>>>>>>>
38804>>>>>>>>>>>
38804>>>>>>>>>>>    End_Procedure   // Update
38805>>>>>>>>>>>
38805>>>>>>>>>>>     Procedure Creating
38806>>>>>>>>>>>        Forward Send Creating
38808>>>>>>>>>>>        // Insert Code Here
38808>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(CN.CN_Rec0)))))) to CN.CN_Recr
38809>>>>>>>>>>>        Get fsgCode_With_Zeroes CN.CN_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to CN.CN_Code
38810>>>>>>>>>>>        Set piCreateNew to 1
38811>>>>>>>>>>>    End_Procedure   // Creating
38812>>>>>>>>>>>
38812>>>>>>>>>>>
38812>>>>>>>>>>>
38812>>>>>>>>>>>    // Define_Fields:
38812>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
38812>>>>>>>>>>>
38812>>>>>>>>>>>    Procedure Define_Fields
38813>>>>>>>>>>>        Forward Send Define_Fields
38815>>>>>>>>>>>        //DDB-Generated-Code-Location
38815>>>>>>>>>>>        //DDB-DefineFieldStart
38815>>>>>>>>>>>
38815>>>>>>>>>>>        Set Main_File            To Cn.File_Number
38816>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
38817>>>>>>>>>>>
38817>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
38818>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
38819>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38820>>>>>>>>>>>
38820>>>>>>>>>>>        // Child (Client) file structure................
38820>>>>>>>>>>>        Send Add_Client_File  Cnzones.File_Number
38821>>>>>>>>>>>        Send Add_Client_File  Tperga.File_Number
38822>>>>>>>>>>>        Send Add_Client_File  Btnordh.File_Number
38823>>>>>>>>>>>        Send Add_Client_File  Dorderh.File_Number
38824>>>>>>>>>>>
38824>>>>>>>>>>>        // Parent (Server) file structure...............
38824>>>>>>>>>>>        Send Add_Server_File  Clients.File_Number
38825>>>>>>>>>>>        Send Add_Server_File  Salesmen.File_Number
38826>>>>>>>>>>>        Send Add_Server_File  Mhxanik.File_Number
38827>>>>>>>>>>>        Send Add_Server_File  Constrct.File_Number
38828>>>>>>>>>>>
38828>>>>>>>>>>>        // External (System) file structure.............
38828>>>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
38829>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
38830>>>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
38831>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
38832>>>>>>>>>>>
38832>>>>>>>>>>>        Define_Auto_Increment  Sysrecc.Cn_Rec0  To Cn.Cn_Rec0
38835>>>>>>>>>>>
38835>>>>>>>>>>>        // Field-based properties.......................
38835>>>>>>>>>>>
38835>>>>>>>>>>>        // Cn.Company_Code
38835>>>>>>>>>>>
38835>>>>>>>>>>>        // Cn.Branch_Code
38835>>>>>>>>>>>
38835>>>>>>>>>>>        // Cn.Year_Year
38835>>>>>>>>>>>
38835>>>>>>>>>>>        // Cn.Custprom_Code
38835>>>>>>>>>>>
38835>>>>>>>>>>>        // Cn.Client_Id
38835>>>>>>>>>>>
38835>>>>>>>>>>>        // Cn.Cn_Code
38835>>>>>>>>>>>        Set Field_Options          Field Cn.Cn_Code To DD_AUTOFIND    DD_NOPUT      
38836>>>>>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_Code To (sl041(Self))
38837>>>>>>>>>>>        Set Key_Field_State        Field Cn.Cn_Code To TRUE
38838>>>>>>>>>>>
38838>>>>>>>>>>>        // Cn.Client_Recr
38838>>>>>>>>>>>
38838>>>>>>>>>>>        // Cn.Cn_Rec0
38838>>>>>>>>>>>
38838>>>>>>>>>>>        // Cn.Cn_Recr
38838>>>>>>>>>>>
38838>>>>>>>>>>>        // Cn.Cn_Descr
38838>>>>>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_Descr To (sl041(Self))
38839>>>>>>>>>>>
38839>>>>>>>>>>>        // Cn.Cn_Address
38839>>>>>>>>>>>
38839>>>>>>>>>>>        // Cn.Cn_Zipcode
38839>>>>>>>>>>>
38839>>>>>>>>>>>        // Cn.Cn_City
38839>>>>>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_City To (sl198(Self))
38840>>>>>>>>>>>
38840>>>>>>>>>>>        // Cn.Cn_Area
38840>>>>>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_Area To (sl197(Self))
38841>>>>>>>>>>>
38841>>>>>>>>>>>        // Cn.Cn_License
38841>>>>>>>>>>>
38841>>>>>>>>>>>        // Cn.Cn_Responsible
38841>>>>>>>>>>>
38841>>>>>>>>>>>        // Cn.Cn_Cnt_Recr
38841>>>>>>>>>>>
38841>>>>>>>>>>>        // Cn.Cn_Cnt_Id
38841>>>>>>>>>>>
38841>>>>>>>>>>>        // Cn.Cn_Phone
38841>>>>>>>>>>>
38841>>>>>>>>>>>        // Cn.Cn_Zone
38841>>>>>>>>>>>
38841>>>>>>>>>>>        // Cn.Cn_Sls_Recr
38841>>>>>>>>>>>
38841>>>>>>>>>>>        // Cn.Cn_Sls_Id
38841>>>>>>>>>>>
38841>>>>>>>>>>>        // Cn.Cn_Details
38841>>>>>>>>>>>
38841>>>>>>>>>>>        // Cn.Cn_Distance
38841>>>>>>>>>>>
38841>>>>>>>>>>>        // Cn.Cn_Pump
38841>>>>>>>>>>>
38841>>>>>>>>>>>        // Cn.Cn_Pumplicense
38841>>>>>>>>>>>
38841>>>>>>>>>>>        // Cn.Cn_Totalstats
38841>>>>>>>>>>>
38841>>>>>>>>>>>        // Cn.Cn_Analstats
38841>>>>>>>>>>>
38841>>>>>>>>>>>        // Cn.Cn_Coated
38841>>>>>>>>>>>
38841>>>>>>>>>>>        // Cn.Cn_Sitew
38841>>>>>>>>>>>
38841>>>>>>>>>>>        // Cn.Cn_Clientmatch
38841>>>>>>>>>>>
38841>>>>>>>>>>>        // Cn.Cn_Codematch
38841>>>>>>>>>>>
38841>>>>>>>>>>>        // Cn.Cn_Pumpid
38841>>>>>>>>>>>
38841>>>>>>>>>>>        // Cn.Cn_Clientid
38841>>>>>>>>>>>
38841>>>>>>>>>>>        // Cn.Cn_Sn
38841>>>>>>>>>>>
38841>>>>>>>>>>>        // Cn.Cn_Repmatch
38841>>>>>>>>>>>
38841>>>>>>>>>>>        // Cn.Cn_Active
38841>>>>>>>>>>>        Set Field_Checkbox_Values  Field Cn.Cn_Active To "A"  "F"
38842>>>>>>>>>>>
38842>>>>>>>>>>>        // Cn.Cn_Reported
38842>>>>>>>>>>>
38842>>>>>>>>>>>        // Cn.Cn_Lastupdated
38842>>>>>>>>>>>
38842>>>>>>>>>>>        // Cn.Cn_Markexp
38842>>>>>>>>>>>
38842>>>>>>>>>>>        // Cn.Cn_Vdetails
38842>>>>>>>>>>>
38842>>>>>>>>>>>        // Cn.Cn_Vticket
38842>>>>>>>>>>>
38842>>>>>>>>>>>        // Cn.Constraction_Id
38842>>>>>>>>>>>
38842>>>>>>>>>>>        // Cn.Cn_Presp_Id
38842>>>>>>>>>>>
38842>>>>>>>>>>>        // Cn.Cn_Presp_Recr
38842>>>>>>>>>>>
38842>>>>>>>>>>>        // Cn.Cn_Add_No
38842>>>>>>>>>>>
38842>>>>>>>>>>>        // Cn.Cn_Nomos
38842>>>>>>>>>>>
38842>>>>>>>>>>>        // Cn.Cn_Xora
38842>>>>>>>>>>>
38842>>>>>>>>>>>        // Cn.Polh_Recr
38842>>>>>>>>>>>
38842>>>>>>>>>>>        // Cn.Lic_Number
38842>>>>>>>>>>>
38842>>>>>>>>>>>        // Cn.Lic_Date
38842>>>>>>>>>>>        Set Field_Mask_Type        Field Cn.Lic_Date To MASK_DATE_WINDOW
38843>>>>>>>>>>>
38843>>>>>>>>>>>        // Cn.Lic_Lixi
38843>>>>>>>>>>>        Set Field_Mask_Type        Field Cn.Lic_Lixi To MASK_DATE_WINDOW
38844>>>>>>>>>>>
38844>>>>>>>>>>>        // Cn.Lic_Auth
38844>>>>>>>>>>>
38844>>>>>>>>>>>        // Cn.Cn_Start_Date
38844>>>>>>>>>>>        Set Field_Mask_Type        Field Cn.Cn_Start_Date To MASK_DATE_WINDOW
38845>>>>>>>>>>>
38845>>>>>>>>>>>        // Cn.Cn_End_Date
38845>>>>>>>>>>>        Set Field_Mask_Type        Field Cn.Cn_End_Date To MASK_DATE_WINDOW
38846>>>>>>>>>>>
38846>>>>>>>>>>>        // Cn.Cn_Categfpa
38846>>>>>>>>>>>        Set Field_Value_Table      Field Cn.Cn_Categfpa To (Cn_Cn_Categfpa_VT1(Self))
38847>>>>>>>>>>>
38847>>>>>>>>>>>        // Cn.Cn_Tpay
38847>>>>>>>>>>>
38847>>>>>>>>>>>        // Cn.Mhxanik_Id
38847>>>>>>>>>>>
38847>>>>>>>>>>>        // Cn.Sum_Pct_Tper
38847>>>>>>>>>>>
38847>>>>>>>>>>>        // Cn.Cn_M3
38847>>>>>>>>>>>
38847>>>>>>>>>>>        // Cn.Aa_Deop
38847>>>>>>>>>>>
38847>>>>>>>>>>>        // Cn.Hm_Tel_Fortio
38847>>>>>>>>>>>        Set Field_Mask_Type        Field Cn.Hm_Tel_Fortio To MASK_DATE_WINDOW
38848>>>>>>>>>>>
38848>>>>>>>>>>>        // Cn.Tel_Fortio_No
38848>>>>>>>>>>>
38848>>>>>>>>>>>        // Cn.Tropos_Metaf
38848>>>>>>>>>>>        Set Field_Value_Table      Field Cn.Tropos_Metaf To (Cn_Tropos_Metaf_VT(Self))
38849>>>>>>>>>>>
38849>>>>>>>>>>>        // Cn.Eidos_Cn
38849>>>>>>>>>>>        Set Field_Value_Table      Field Cn.Eidos_Cn To (Cn_Eidos_Cn_VT(Self))
38850>>>>>>>>>>>
38850>>>>>>>>>>>        // Cn.Polhths_Constr
38850>>>>>>>>>>>
38850>>>>>>>>>>>        // Cn.Polhths_Mhx
38850>>>>>>>>>>>
38850>>>>>>>>>>>        // Cn.Hm_Prot_Fortio
38850>>>>>>>>>>>        Set Field_Mask_Type        Field Cn.Hm_Prot_Fortio To MASK_DATE_WINDOW
38851>>>>>>>>>>>
38851>>>>>>>>>>>        // Cn.Mesoskyklos
38851>>>>>>>>>>>
38851>>>>>>>>>>>        // Cn.Diodia
38851>>>>>>>>>>>
38851>>>>>>>>>>>        // Cn.Yesno
38851>>>>>>>>>>>        Set Field_Value_Table      Field Cn.Yesno To (Cn_Yesno_VT(Self))
38852>>>>>>>>>>>
38852>>>>>>>>>>>        // Cn.Dateeggy
38852>>>>>>>>>>>        Set Field_Mask_Type        Field Cn.Dateeggy To MASK_DATE_WINDOW
38853>>>>>>>>>>>
38853>>>>>>>>>>>        // Cn.Cn_Branch
38853>>>>>>>>>>>
38853>>>>>>>>>>>        // Cn.Cn_Exfd1
38853>>>>>>>>>>>
38853>>>>>>>>>>>        // Cn.Cn_Exfd2
38853>>>>>>>>>>>
38853>>>>>>>>>>>        // Cn.Cn_Exfd3
38853>>>>>>>>>>>
38853>>>>>>>>>>>        // Cn.Cn_Exfd4
38853>>>>>>>>>>>
38853>>>>>>>>>>>        // Cn.Cn_Exfd5
38853>>>>>>>>>>>
38853>>>>>>>>>>>        // Cn.Cn_Exfd6
38853>>>>>>>>>>>
38853>>>>>>>>>>>        //DDB-DefineFieldEnd
38853>>>>>>>>>>>    End_Procedure    // Define_Fields
38854>>>>>>>>>>>
38854>>>>>>>>>>>    // Field_Defaults:
38854>>>>>>>>>>>    // This procedure is used to establish default field values.
38854>>>>>>>>>>>          
38854>>>>>>>>>>>    Procedure Field_Defaults
38855>>>>>>>>>>>        Forward Send Field_Defaults
38857>>>>>>>>>>>        //DDB-Generated-Code-Location
38857>>>>>>>>>>>        //DDB-FieldDefaultStart
38857>>>>>>>>>>>        Set Field_Changed_Value   Field Cn.Cn_Active To "A"
38858>>>>>>>>>>>        //DDB-FieldDefaultEnd
38858>>>>>>>>>>>    End_Procedure    // Field_Defaults
38859>>>>>>>>>>>
38859>>>>>>>>>>>End_Class    // Cn_DataDictionary
38860>>>>>>>>>>>//DDB-Selection-pkg-Start
38860>>>>>>>>>>>
38860>>>>>>>>>>>Use sl041.sl         // sl041
38860>>>>>>>>>>>Use sl198.sl         // sl198
38860>>>>>>>>>>>Use sl197.SL         // sl197
38860>>>>>>>>>>>
38860>>>>>>>>>>>//DDB-Selection-pkg-End
38860>>>>>>>>>>>//DDB-FileEnd
38860>>>>>>>>>    
38860>>>>>>>>>    //AB-IgnoreEnd
38860>>>>>>>>>
38860>>>>>>>>>    Object sl041 is a dbModalPanelSub
38862>>>>>>>>>
38862>>>>>>>>>        //AB-StoreTopStart
38862>>>>>>>>>        Property String FragmaClient_ID Public ''
38864>>>>>>>>>        
38864>>>>>>>>>        //AB-StoreTopEnd
38864>>>>>>>>>
38864>>>>>>>>>        Set Label to "„§ ¢¦šã „¨šà¤"
38865>>>>>>>>>        Set Size to 249 500
38866>>>>>>>>>        Set Location to 2 6
38867>>>>>>>>>        Set Exit_Application_Local_State to FALSE
38868>>>>>>>>>        Set Modal_State to FALSE
38869>>>>>>>>>
38869>>>>>>>>>        //AB-DDOStart
38869>>>>>>>>>
38869>>>>>>>>>        Object Clients_DD is a Clients_DataDictionary
38871>>>>>>>>>
38871>>>>>>>>>            //AB-StoreStart
38871>>>>>>>>>                                                                                                                                                                                                                                                    
38871>>>>>>>>>                                                                                                                                                                                                                                                    
38871>>>>>>>>>                                                                                                                                                                                                                                                    
38871>>>>>>>>>            //AB-StoreEnd
38871>>>>>>>>>
38871>>>>>>>>>        End_Object    // Clients_DD
38872>>>>>>>>>
38872>>>>>>>>>        Object Cn_DD is a Cn_DataDictionary
38874>>>>>>>>>            Set DDO_Server to (Clients_DD(self))
38875>>>>>>>>>
38875>>>>>>>>>            //AB-StoreStart
38875>>>>>>>>>                                                        
38875>>>>>>>>>            Begin_Constraints
38877>>>>>>>>>                String sID
38878>>>>>>>>>                Get FragmaClient_ID to sID
38879>>>>>>>>>                If (sID<>'') begin
38881>>>>>>>>>                    set ordering to 4
38882>>>>>>>>>                    Constrain CN.Client_ID eq sID
38884>>>>>>>>>                end
38884>>>>>>>>>>
38884>>>>>>>>>                ELSE SET ORDERING TO -1
38886>>>>>>>>>            End_Constraints
38889>>>>>>>>>            
38889>>>>>>>>>            
38889>>>>>>>>>            
38889>>>>>>>>>            
38889>>>>>>>>>            
38889>>>>>>>>>            
38889>>>>>>>>>            
38889>>>>>>>>>            
38889>>>>>>>>>            
38889>>>>>>>>>            
38889>>>>>>>>>            
38889>>>>>>>>>            
38889>>>>>>>>>            
38889>>>>>>>>>            
38889>>>>>>>>>            
38889>>>>>>>>>            //AB-StoreEnd
38889>>>>>>>>>
38889>>>>>>>>>        End_Object    // Cn_DD
38890>>>>>>>>>
38890>>>>>>>>>        Set Main_DD to (Cn_DD(self))
38891>>>>>>>>>        Set Server to (Cn_DD(self))
38892>>>>>>>>>
38892>>>>>>>>>        //AB-DDOEnd
38892>>>>>>>>>
38892>>>>>>>>>        Object oSelList is a dbListSub
38894>>>>>>>>>            Set Main_File to Cn.File_Number
38895>>>>>>>>>            Set Ordering to 4
38896>>>>>>>>>            Set Size to 209 481
38897>>>>>>>>>            Set Location to 6 6
38898>>>>>>>>>            Set Auto_Index_State to FALSE
38899>>>>>>>>>
38899>>>>>>>>>            Begin_Row
38902>>>>>>>>>                Entry_Item Cn.Cn_code
38903>>>>>>>>>                Entry_Item Cn.Cn_descr
38904>>>>>>>>>                Entry_Item Cn.Client_id
38905>>>>>>>>>                Entry_Item Clients.Client_name
38906>>>>>>>>>                Entry_Item Cn.Cn_active
38907>>>>>>>>>            End_Row
38912>>>>>>>>>
38912>>>>>>>>>            Set Form_Width    item 0 to 62
38913>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª „¨š¦¬"
38914>>>>>>>>>            
38914>>>>>>>>>            Set Form_Width    item 1 to 185
38915>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã „¨š¦¬"
38916>>>>>>>>>            
38916>>>>>>>>>            Set Form_Width    item 2 to 60
38917>>>>>>>>>            Set Header_Label  item 2 to "‰à›.œ¢á«ž"
38918>>>>>>>>>            
38918>>>>>>>>>            Set Form_Width    item 3 to 123
38919>>>>>>>>>            Set Header_Label  item 3 to "„§à¤¬£å˜ œ¢á«ž"
38920>>>>>>>>>            
38920>>>>>>>>>            Set Form_Width    item 4 to 44
38921>>>>>>>>>            Set Header_Label  item 4 to "‘œ „¥â¢ ¥ž"
38922>>>>>>>>>            Set Column_Checkbox_State  item 4 to True
38923>>>>>>>>>            
38923>>>>>>>>>
38923>>>>>>>>>            //AB-StoreStart
38923>>>>>>>>>                                                        
38923>>>>>>>>>            Property String StoreFragmaClient_ID Public ''
38925>>>>>>>>>            
38925>>>>>>>>>            Procedure Store_Defaults
38927>>>>>>>>>                   Forward Send Store_Defaults
38929>>>>>>>>>                   Set StoreFragmaClient_ID to (FragmaClient_ID(Self))
38930>>>>>>>>>            End_Procedure
38931>>>>>>>>>            
38931>>>>>>>>>            Procedure ReStore_Defaults
38933>>>>>>>>>                   Forward Send ReStore_Defaults
38935>>>>>>>>>                   Set FragmaClient_ID to (StoreFragmaClient_ID(Self))
38936>>>>>>>>>            End_Procedure
38937>>>>>>>>>            
38937>>>>>>>>>            Procedure Activating Returns Integer
38939>>>>>>>>>                Integer rVal
38940>>>>>>>>>                Forward Get Msg_Activating to rVal
38942>>>>>>>>>                set auto_index_state to true
38943>>>>>>>>>                SET ORDERING TO -1
38944>>>>>>>>>                Procedure_Return rVal
38945>>>>>>>>>            End_Procedure
38946>>>>>>>>>            
38946>>>>>>>>>            
38946>>>>>>>>>            
38946>>>>>>>>>            
38946>>>>>>>>>            
38946>>>>>>>>>            
38946>>>>>>>>>            
38946>>>>>>>>>            
38946>>>>>>>>>            
38946>>>>>>>>>            
38946>>>>>>>>>            
38946>>>>>>>>>            
38946>>>>>>>>>            
38946>>>>>>>>>            
38946>>>>>>>>>            
38946>>>>>>>>>            
38946>>>>>>>>>            
38946>>>>>>>>>            
38946>>>>>>>>>            //AB-StoreEnd
38946>>>>>>>>>
38946>>>>>>>>>        End_Object    // oSelList
38947>>>>>>>>>
38947>>>>>>>>>        Object oOK_bn is a ButtonSub
38949>>>>>>>>>            Set Label to "&„§ ¢¦šã"
38950>>>>>>>>>            Set Location to 219 327
38951>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38952>>>>>>>>>
38952>>>>>>>>>            //AB-StoreStart
38952>>>>>>>>>            Procedure OnClick
38954>>>>>>>>>                Send OK To (oSelList(current_object))
38955>>>>>>>>>            End_Procedure
38956>>>>>>>>>            //AB-StoreEnd
38956>>>>>>>>>
38956>>>>>>>>>        End_Object    // oOK_bn
38957>>>>>>>>>
38957>>>>>>>>>        Object oCancel_bn is a ButtonSub
38959>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
38960>>>>>>>>>            Set Location to 219 383
38961>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38962>>>>>>>>>
38962>>>>>>>>>            //AB-StoreStart
38962>>>>>>>>>            Procedure OnClick
38964>>>>>>>>>                Send Cancel To (oSelList(current_object))
38965>>>>>>>>>            End_Procedure
38966>>>>>>>>>            //AB-StoreEnd
38966>>>>>>>>>
38966>>>>>>>>>        End_Object    // oCancel_bn
38967>>>>>>>>>
38967>>>>>>>>>        Object oSearch_bn is a ButtonSub
38969>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
38970>>>>>>>>>            Set Location to 219 437
38971>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38972>>>>>>>>>
38972>>>>>>>>>            //AB-StoreStart
38972>>>>>>>>>            Procedure OnClick
38974>>>>>>>>>                Send Search To (oSelList(current_object))
38975>>>>>>>>>            End_Procedure
38976>>>>>>>>>            //AB-StoreEnd
38976>>>>>>>>>
38976>>>>>>>>>        End_Object    // oSearch_bn
38977>>>>>>>>>
38977>>>>>>>>>
38977>>>>>>>>>        //AB-StoreStart
38977>>>>>>>>>        
38977>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
38978>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
38979>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
38980>>>>>>>>>        
38980>>>>>>>>>        Set Modal_State to True
38981>>>>>>>>>        
38981>>>>>>>>>        Procedure Activating Returns Integer
38983>>>>>>>>>            Integer rVal
38984>>>>>>>>>            Forward Get Msg_Activating to rVal
38986>>>>>>>>>            Send Rebuild_Constraints to (CN_DD(Self))
38987>>>>>>>>>            Send Beginning_Of_Data to oSelList
38988>>>>>>>>>            Procedure_Return rVal
38989>>>>>>>>>        End_Procedure
38990>>>>>>>>>        
38990>>>>>>>>>        procedure page integer pagemode
38992>>>>>>>>>            forward send page pagemode
38994>>>>>>>>>            set location to 40,40
38995>>>>>>>>>        end_procedure
38996>>>>>>>>>        
38996>>>>>>>>>        
38996>>>>>>>>>        
38996>>>>>>>>>        
38996>>>>>>>>>        
38996>>>>>>>>>        
38996>>>>>>>>>        
38996>>>>>>>>>        
38996>>>>>>>>>        
38996>>>>>>>>>        
38996>>>>>>>>>        
38996>>>>>>>>>        
38996>>>>>>>>>        
38996>>>>>>>>>        
38996>>>>>>>>>        
38996>>>>>>>>>        
38996>>>>>>>>>        
38996>>>>>>>>>        
38996>>>>>>>>>        
38996>>>>>>>>>        //AB-StoreEnd
38996>>>>>>>>>
38996>>>>>>>>>    End_Object    // sl041
38997>>>>>>>>>
38997>>>>>>>>>//AB/     End_Object    // prj
38997>>>>>>>
38997>>>>>>>//DDB-Selection-pkg-End
38997>>>>>>>//DDB-FileEnd
38997>>>>>
38997>>>>>//AB-IgnoreEnd
38997>>>>>
38997>>>>>Object sl006 is a dbModalPanelSub
38999>>>>>
38999>>>>>    //AB-StoreTopStart
38999>>>>>                                        
38999>>>>>    Property String     psModule    Public ''
39001>>>>>    Property String     psClientID  Public ''
39003>>>>>    Property Date       pdApo       public ''
39005>>>>>    Property Date       pdEos       public ''
39007>>>>>    Property Integer    piXr_Or_Pi  public  0
39009>>>>>    Property Integer    piWhat      public  0
39011>>>>>    
39011>>>>>    //AB-StoreTopEnd
39011>>>>>
39011>>>>>    Set Label to "‰ ¤ã©œ ª ”¦¨âà¤"
39012>>>>>    Set Size to 270 519
39013>>>>>    Set Location to 5 7
39014>>>>>    Set Exit_Application_Local_State to FALSE
39015>>>>>    Set Modal_State to FALSE
39016>>>>>
39016>>>>>    //AB-DDOStart
39016>>>>>
39016>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
39018>>>>>    End_Object    // Ctypkin_DD
39019>>>>>
39019>>>>>    Object Clients_DD is a Clients_DataDictionary
39021>>>>>    End_Object    // Clients_DD
39022>>>>>
39022>>>>>    Object Cmoves_DD is a Cmoves_DataDictionary
39024>>>>>        Set DDO_Server to (Ctypkin_DD(self))
39025>>>>>        Set DDO_Server to (Clients_DD(self))
39026>>>>>
39026>>>>>        //AB-StoreStart
39026>>>>>        
39026>>>>>        Begin_Constraints
39028>>>>>        
39028>>>>>            Constrain Cmoves.Company_Code   Eq SyscurXr.Company_Code
39030>>>>>            Constrain Cmoves.Year_Year      Eq SyscurXr.Year_Year
39032>>>>>        
39032>>>>>            If (psClientID(Self)<>'')   Constrain Cmoves.Client_ID      Eq (psClientID(Self))
39036>>>>>            If (pdApo(Self)<>'')        Constrain Cmoves.Cmoves_Hmnia   Ge (pdApo(Self))
39040>>>>>            If (pdEos(Self)<>'')        Constrain Cmoves.Cmoves_Hmnia   Le (pdEos(Self))
39044>>>>>        
39044>>>>>            Constrain Cmoves.Module_From    Eq (psModule(Self))
39046>>>>>        
39046>>>>>                 If (piWhat(Self)=1) Constrain Cmoves.Flag_Ypol Eq 1
39050>>>>>            Else If (piWhat(Self)=2) Constrain Cmoves.Flag_Ypol Eq 0
39055>>>>>        
39055>>>>>        End_Constraints
39058>>>>>        
39058>>>>>        
39058>>>>>        
39058>>>>>        
39058>>>>>        
39058>>>>>        
39058>>>>>        
39058>>>>>        
39058>>>>>        
39058>>>>>        
39058>>>>>        
39058>>>>>        
39058>>>>>        
39058>>>>>        
39058>>>>>        
39058>>>>>        
39058>>>>>        
39058>>>>>        
39058>>>>>        
39058>>>>>        
39058>>>>>        
39058>>>>>        
39058>>>>>        
39058>>>>>        
39058>>>>>        
39058>>>>>        
39058>>>>>        //AB-StoreEnd
39058>>>>>
39058>>>>>    End_Object    // Cmoves_DD
39059>>>>>
39059>>>>>    Set Main_DD to (Cmoves_DD(self))
39060>>>>>    Set Server to (Cmoves_DD(self))
39061>>>>>
39061>>>>>    //AB-DDOEnd
39061>>>>>
39061>>>>>    Object oSelList is a dbListSub
39063>>>>>
39063>>>>>        //AB-StoreTopStart
39063>>>>>                                                                                                                                                                                                                                                                                                                            
39063>>>>>        //AB-StoreTopEnd
39063>>>>>
39063>>>>>        Set Main_File to Cmoves.File_Number
39064>>>>>        Set Ordering to 4
39065>>>>>        Set Size to 199 505
39066>>>>>        Set Location to 31 7
39067>>>>>        Set Auto_Index_State to FALSE
39068>>>>>
39068>>>>>        Begin_Row
39071>>>>>            Entry_Item Cmoves.Cmoves_hmnia
39072>>>>>            Entry_Item Cmoves.Cmoves_par
39073>>>>>            Entry_Item Ctypkin.Ctypkin_descr
39074>>>>>            Entry_Item Clients.Client_name
39075>>>>>            Entry_Item Cmoves.Cmoves_axia
39076>>>>>            Entry_Item Cmoves.Cmoves_sc_code2
39077>>>>>            Entry_Item Cmoves.Branch_code
39078>>>>>        End_Row
39083>>>>>
39083>>>>>        Set Form_Width    item 0 to 57
39084>>>>>        Set Header_Label  item 0 to "†£œ¨/¤å˜"
39085>>>>>        
39085>>>>>        Set Form_Width    item 1 to 121
39086>>>>>        Set Header_Label  item 1 to "€ « ¦¢¦šå˜"
39087>>>>>        
39087>>>>>        Set Form_Width    item 2 to 65
39088>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž"
39089>>>>>        
39089>>>>>        Set Form_Width    item 3 to 107
39090>>>>>        Set Header_Label  item 3 to "‘¬¤˜¢¢˜©æ£œ¤¦ª"
39091>>>>>        
39091>>>>>        Set Form_Width    item 4 to 63
39092>>>>>        Set Header_Label  item 4 to " €¥å˜"
39093>>>>>        
39093>>>>>        Set Form_Width    item 5 to 42
39094>>>>>        Set Header_Label  item 5 to "Œæ£ ©£˜"
39095>>>>>        
39095>>>>>        Set Form_Width    item 6 to 45
39096>>>>>        Set Header_Label  item 6 to "“§¦¡/£˜"
39097>>>>>        
39097>>>>>
39097>>>>>        //AB-StoreStart
39097>>>>>                                                                                                                                                                                                                                                                                                                            
39097>>>>>        Procedure End_Construct_Object
39099>>>>>            String  sNom
39100>>>>>            Integer iDecs
39100>>>>>            Forward Send End_Construct_Object
39102>>>>>            Move SysCurxr.C_Code0 to sNom
39103>>>>>            Clear Nomisma
39104>>>>>            Move sNom to Nomisma.Nomisma_Code
39105>>>>>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
39106>>>>>>
39106>>>>>            If (Found=1)    Move Nomisma.Dekadika to iDecs
39109>>>>>            Else            Move 0 to iDecs
39111>>>>>        
39111>>>>>            // Ž¨ ¦¬£œ §àª ˜¤ «¦ ™˜© ¡æ ¤¦£ ©£˜ ®¨ã©žª ƒ„Œ œ®œ  ›œ¡˜› ¡á
39111>>>>>            // «æ«œ œ¥' ¦¨ ©£¦ç ™á¦¬£œ œ£œ ª 2
39111>>>>>            If (iDecs=0) Move 2 to iDecs
39114>>>>>            //
39114>>>>>        
39114>>>>>            Set Points          Item 4 to       iDecs
39115>>>>>            Set Numeric_Mask    Item 4 to 14    iDecs '*, '
39116>>>>>        End_Procedure
39117>>>>>        
39117>>>>>        
39117>>>>>        
39117>>>>>        
39117>>>>>        
39117>>>>>        //AB-StoreEnd
39117>>>>>
39117>>>>>    End_Object    // oSelList
39118>>>>>
39118>>>>>    Object oOK_bn is a ButtonSub
39120>>>>>        Set Label to "&„§ ¢¦šã"
39121>>>>>        Set Location to 236 350
39122>>>>>
39122>>>>>        //AB-StoreStart
39122>>>>>        Procedure OnClick
39124>>>>>            Send OK To (oSelList(current_object))
39125>>>>>        End_Procedure
39126>>>>>        //AB-StoreEnd
39126>>>>>
39126>>>>>    End_Object    // oOK_bn
39127>>>>>
39127>>>>>    Object oCancel_bn is a ButtonSub
39129>>>>>        Set Label to "&€¡ç¨à©ž"
39130>>>>>        Set Location to 236 404
39131>>>>>
39131>>>>>        //AB-StoreStart
39131>>>>>        Procedure OnClick
39133>>>>>            Send Cancel To (oSelList(current_object))
39134>>>>>        End_Procedure
39135>>>>>        //AB-StoreEnd
39135>>>>>
39135>>>>>    End_Object    // oCancel_bn
39136>>>>>
39136>>>>>    Object oSearch_bn is a ButtonSub
39138>>>>>        Set Label to "€&¤˜ã«ž©ž"
39139>>>>>        Set Location to 236 460
39140>>>>>
39140>>>>>        //AB-StoreStart
39140>>>>>        Procedure OnClick
39142>>>>>            Send Search To (oSelList(current_object))
39143>>>>>        End_Procedure
39144>>>>>        //AB-StoreEnd
39144>>>>>
39144>>>>>    End_Object    // oSearch_bn
39145>>>>>
39145>>>>>    Object Cmoves_Axia_Pros_Sysx is a dbFormSub
39147>>>>>        Entry_Item Cmoves.Axia_pros_sysx
39148>>>>>        Set Size to 13 54
39149>>>>>        Set Location to 236 24
39150>>>>>        Set Color to clBtnFace
39151>>>>>        Set Label_Col_Offset to 2
39152>>>>>        Set Label_Justification_Mode to jMode_Right
39153>>>>>        Set Enabled_State to FALSE
39154>>>>>        Set Item_Shadow_State Item 0 to TRUE
39155>>>>>        Set Shadow_State Item 0 to TRUE
39156>>>>>
39156>>>>>        //AB-StoreStart
39156>>>>>        Set points item 0 to 2
39157>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
39158>>>>>        
39158>>>>>        //AB-StoreEnd
39158>>>>>
39158>>>>>    End_Object    // Cmoves_Axia_Pros_Sysx
39159>>>>>
39159>>>>>    Object Cmoves_Axia_Sysxet is a dbFormSub
39161>>>>>        Entry_Item Cmoves.Axia_sysxet
39162>>>>>        Set Size to 13 54
39163>>>>>        Set Location to 236 140
39164>>>>>        Set Color to clBtnFace
39165>>>>>        Set Label_Col_Offset to 2
39166>>>>>        Set Label_Justification_Mode to jMode_Right
39167>>>>>        Set Enabled_State to FALSE
39168>>>>>        Set Item_Shadow_State Item 0 to TRUE
39169>>>>>        Set Shadow_State Item 0 to TRUE
39170>>>>>
39170>>>>>        //AB-StoreStart
39170>>>>>        Set points item 0 to 2
39171>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
39172>>>>>        
39172>>>>>        //AB-StoreEnd
39172>>>>>
39172>>>>>    End_Object    // Cmoves_Axia_Sysxet
39173>>>>>
39173>>>>>    Object Cmoves_Axia_Ypol_Sysx is a dbFormSub
39175>>>>>        Entry_Item Cmoves.Axia_ypol_sysx
39176>>>>>        Set Size to 13 54
39177>>>>>        Set Location to 236 248
39178>>>>>        Set Color to clBtnFace
39179>>>>>        Set Label_Col_Offset to 2
39180>>>>>        Set Label_Justification_Mode to jMode_Right
39181>>>>>        Set Enabled_State to FALSE
39182>>>>>        Set Item_Shadow_State Item 0 to TRUE
39183>>>>>        Set Shadow_State Item 0 to TRUE
39184>>>>>
39184>>>>>        //AB-StoreStart
39184>>>>>                                                                                                    
39184>>>>>        Set points item 0 to 2
39185>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
39186>>>>>        
39186>>>>>        //AB-StoreEnd
39186>>>>>
39186>>>>>    End_Object    // Cmoves_Axia_Ypol_Sysx
39187>>>>>
39187>>>>>    Object TextBoxSub1 is a TextBoxSub
39189>>>>>        Set Label to "€¥å˜"
39190>>>>>        Set Location to 238 7
39191>>>>>        Set Size to 10 15
39192>>>>>    End_Object    // TextBoxSub1
39193>>>>>
39193>>>>>    Object TextBoxSub2 is a TextBoxSub
39195>>>>>        Set Label to "‘¬©®œ« ©£â¤ž"
39196>>>>>        Set Location to 238 89
39197>>>>>        Set Size to 10 49
39198>>>>>    End_Object    // TextBoxSub2
39199>>>>>
39199>>>>>    Object TextBoxSub3 is a TextBoxSub
39201>>>>>        Set Label to "ƒ ˜Ÿâ© £ž"
39202>>>>>        Set Location to 238 210
39203>>>>>        Set Size to 10 35
39204>>>>>    End_Object    // TextBoxSub3
39205>>>>>
39205>>>>>    Object RadioGroupSub2 is a RadioGroupSub
39207>>>>>        Set Label to "„§ ¢¦šã ‰ ¤ã©œà¤"
39208>>>>>        Set Size to 24 497
39209>>>>>        Set Location to 3 9
39210>>>>>        Object Radio4 is a RadioSub
39212>>>>>            Set Label to "Ž¢œª"
39213>>>>>            Set Size to 10 37
39214>>>>>            Set Location to 10 97
39215>>>>>        End_Object    // Radio4
39216>>>>>
39216>>>>>        Object Radio5 is a RadioSub
39218>>>>>            Set Label to "‹œ ¬§æ¢¦ §¦ ©¬©®â« ©žª"
39219>>>>>            Set Size to 10 97
39220>>>>>            Set Location to 10 167
39221>>>>>        End_Object    // Radio5
39222>>>>>
39222>>>>>        Object Radio6 is a RadioSub
39224>>>>>            Set Label to "•à¨åª ¬§æ¢¦ §¦ ©¬©®â« ©žª"
39225>>>>>            Set Size to 10 111
39226>>>>>            Set Location to 10 278
39227>>>>>        End_Object    // Radio6
39228>>>>>
39228>>>>>
39228>>>>>        //AB-StoreStart
39228>>>>>                                                                                        
39228>>>>>        Procedure Notify_Select_State integer iToItem integer iFromItem
39230>>>>>            Set piWhat to iToItem
39231>>>>>            Send Rebuild_Constraints to Cmoves_DD
39232>>>>>            Send Beginning_Of_Data To oSelList True
39233>>>>>        End_Procedure
39234>>>>>        
39234>>>>>        Set Current_Radio to 1
39235>>>>>        
39235>>>>>        
39235>>>>>        
39235>>>>>        
39235>>>>>        //AB-StoreEnd
39235>>>>>
39235>>>>>    End_Object    // RadioGroupSub2
39236>>>>>
39236>>>>>
39236>>>>>    //AB-StoreStart
39236>>>>>                                        
39236>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39237>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39238>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39239>>>>>    
39239>>>>>    Set Modal_State to True
39240>>>>>    
39240>>>>>    Procedure Activate
39242>>>>>        String  sNom
39243>>>>>        Integer iDecs rVal
39243>>>>>        Set piWhat to 1
39244>>>>>        Set Current_Radio Of RadioGroupSub2 to 1
39245>>>>>        Forward Send Activate
39247>>>>>        Send Rebuild_Constraints        to Cmoves_DD
39248>>>>>        Send Beginning_Of_Data          to oSelList True
39249>>>>>    End_procedure
39250>>>>>    
39250>>>>>    
39250>>>>>    
39250>>>>>    
39250>>>>>    
39250>>>>>    
39250>>>>>    
39250>>>>>    
39250>>>>>    
39250>>>>>    
39250>>>>>    
39250>>>>>    
39250>>>>>    
39250>>>>>    
39250>>>>>    
39250>>>>>    
39250>>>>>    
39250>>>>>    
39250>>>>>    
39250>>>>>    
39250>>>>>    
39250>>>>>    
39250>>>>>    
39250>>>>>    
39250>>>>>    
39250>>>>>    
39250>>>>>    //AB-StoreEnd
39250>>>>>
39250>>>>>End_Object    // sl006
39251>>>>>
39251>>>>>//AB/ End_Object    // prj
39251>>>Use sl007.sl
39251>>>Use sl007r.sl
INCLUDING FILE: SL007R.SL
39251>>>>>//AB/ Project sl007r:Ctypkin lookup with RecR 1st Col
39251>>>>>//AB/     Object prj is a Lookup_Project
39251>>>>>//AB/         Set ProjectName to "sl007r:Ctypkin lookup with RecR 1st Col"
39251>>>>>//AB/         Set ProjectFileName to "sl007r.SL"
39251>>>>>//AB/         Set GenerateFileName to "NONAME"
39251>>>>>
39251>>>>>// Project Object Structure
39251>>>>>//   sl007r is a dbModalPanelSub
39251>>>>>//     Ctypkin_DD is a DataDictionary
39251>>>>>//     oSelList is a dbListSub
39251>>>>>//     oOK_bn is a ButtonSub
39251>>>>>//     oCancel_bn is a ButtonSub
39251>>>>>//     oSearch_bn is a ButtonSub
39251>>>>>
39251>>>>>// Register all objects
39251>>>>>Register_Object Ctypkin_DD
39251>>>>>Register_Object oCancel_bn
39251>>>>>Register_Object oOK_bn
39251>>>>>Register_Object oSearch_bn
39251>>>>>Register_Object oSelList
39251>>>>>Register_Object sl007r
39251>>>>>
39251>>>>>
39251>>>>>    //AB-IgnoreStart
39251>>>>>
39251>>>>>    Use DFAllEnt.pkg
39251>>>>>    Use dbList.Sub
39251>>>>>    Use Button.Sub
39251>>>>>
39251>>>>>
39251>>>>>    Use CTYPKIN.DD
39251>>>>>    
39251>>>>>    //AB-IgnoreEnd
39251>>>>>
39251>>>>>    CD_Popup_Object sl007r is a dbModalPanelSub
39270>>>>>        Set Label to "Ctypkin"
39271>>>>>        Set Size to 148 480
39272>>>>>        Set Location to 12 16
39273>>>>>        Set Exit_Application_Local_State to FALSE
39274>>>>>        Set Modal_State to FALSE
39275>>>>>
39275>>>>>        //AB-DDOStart
39275>>>>>
39275>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
39277>>>>>        End_Object    // Ctypkin_DD
39278>>>>>
39278>>>>>        Set Main_DD to (Ctypkin_DD(self))
39279>>>>>        Set Server to (Ctypkin_DD(self))
39280>>>>>
39280>>>>>        //AB-DDOEnd
39280>>>>>
39280>>>>>        Object oSelList is a dbListSub
39282>>>>>            Set Main_File to Ctypkin.File_Number
39283>>>>>            Set Size to 105 465
39284>>>>>            Set Location to 6 6
39285>>>>>
39285>>>>>            Begin_Row
39288>>>>>                Entry_Item Ctypkin.Ctypkin_recr
39289>>>>>                Entry_Item Ctypkin.Ctypkin_code
39290>>>>>                Entry_Item Ctypkin.Ctypkin_descr
39291>>>>>                Entry_Item Ctypkin.Ctypkin_anti
39292>>>>>            End_Row
39297>>>>>
39297>>>>>            Set Form_Width    item 0 to 72
39298>>>>>            Set Header_Label  item 0 to "RecR"
39299>>>>>            
39299>>>>>            Set Form_Width    item 1 to 58
39300>>>>>            Set Header_Label  item 1 to "Ctypkin code"
39301>>>>>            
39301>>>>>            Set Form_Width    item 2 to 209
39302>>>>>            Set Header_Label  item 2 to "Ctypkin descr"
39303>>>>>            
39303>>>>>            Set Form_Width    item 3 to 120
39304>>>>>            Set Header_Label  item 3 to "Ctypkin anti"
39305>>>>>            
39305>>>>>
39305>>>>>            //AB-StoreStart
39305>>>>>            
39305>>>>>            Set Column_Option Item 0 to Noenter True
39306>>>>>            
39306>>>>>            //AB-StoreEnd
39306>>>>>
39306>>>>>        End_Object    // oSelList
39307>>>>>
39307>>>>>        Object oOK_bn is a ButtonSub
39309>>>>>            set label to "&„§ ¢¦šã" 
39310>>>>>            Set Location to 114 312
39311>>>>>
39311>>>>>            //AB-StoreStart
39311>>>>>            Procedure OnClick
39313>>>>>                Send OK To (oSelList(current_object))
39314>>>>>            End_Procedure
39315>>>>>            //AB-StoreEnd
39315>>>>>
39315>>>>>        End_Object    // oOK_bn
39316>>>>>
39316>>>>>        Object oCancel_bn is a ButtonSub
39318>>>>>            set label to "&€¡ç¨à©ž" 
39319>>>>>            Set Location to 114 367
39320>>>>>
39320>>>>>            //AB-StoreStart
39320>>>>>            Procedure OnClick
39322>>>>>                Send Cancel To (oSelList(current_object))
39323>>>>>            End_Procedure
39324>>>>>            //AB-StoreEnd
39324>>>>>
39324>>>>>        End_Object    // oCancel_bn
39325>>>>>
39325>>>>>        Object oSearch_bn is a ButtonSub
39327>>>>>            set label to "€&¤˜ã«ž©ž" 
39328>>>>>            Set Location to 114 422
39329>>>>>
39329>>>>>            //AB-StoreStart
39329>>>>>            Procedure OnClick
39331>>>>>                Send Search To (oSelList(current_object))
39332>>>>>            End_Procedure
39333>>>>>            //AB-StoreEnd
39333>>>>>
39333>>>>>        End_Object    // oSearch_bn
39334>>>>>
39334>>>>>
39334>>>>>        //AB-StoreStart
39334>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39335>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39336>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39337>>>>>        //AB-StoreEnd
39337>>>>>
39337>>>>>    CD_End_Object    // sl007r
39339>>>>>>
39339>>>>>
39339>>>>>//AB/     End_Object    // prj
39339>>>Use sl012.sl
INCLUDING FILE: SL012.SL
39339>>>>>//AB/ Project sl012 : Ptyppar
39339>>>>>//AB/ Object prj is a Lookup_Project
39339>>>>>//AB/     Set ProjectName to "sl012 : Ptyppar"
39339>>>>>//AB/     Set ProjectFileName to "sl012.SL"
39339>>>>>//AB/     Set GenerateFileName to "NONAME"
39339>>>>>
39339>>>>>// Project Object Structure
39339>>>>>//   sl012 is a dbModalPanelSub
39339>>>>>//     Ctypkin_DD is a DataDictionary
39339>>>>>//     Wtypkin_DD is a DataDictionary
39339>>>>>//     Ptyppar_DD is a DataDictionary
39339>>>>>//     oSelList is a dbListSub
39339>>>>>//     oOK_bn is a ButtonSub
39339>>>>>//     oCancel_bn is a ButtonSub
39339>>>>>//     oSearch_bn is a ButtonSub
39339>>>>>
39339>>>>>// Register all objects
39339>>>>>Register_Object Ctypkin_DD
39339>>>>>Register_Object oCancel_bn
39339>>>>>Register_Object oOK_bn
39339>>>>>Register_Object oSearch_bn
39339>>>>>Register_Object oSelList
39339>>>>>Register_Object Ptyppar_DD
39339>>>>>Register_Object sl012
39339>>>>>Register_Object Wtypkin_DD
39339>>>>>
39339>>>>>
39339>>>>>//AB-IgnoreStart
39339>>>>>
39339>>>>>Use DFAllEnt.pkg
39339>>>>>Use dbList.Sub
39339>>>>>Use Button.Sub
39339>>>>>
39339>>>>>
39339>>>>>Use CTYPKIN.DD
39339>>>>>Use WTYPKIN.DD
INCLUDING FILE: WTYPKIN.DD
39339>>>>>>>//DDB-FileStart
39339>>>>>>>//DDB-HeaderStart
39339>>>>>>>
39339>>>>>>>// File Name : WTYPKIN.DD
39339>>>>>>>// Class Name: Wtypkin_DataDictionary
39339>>>>>>>// Revision  : 49
39339>>>>>>>// Version   : 2
39339>>>>>>>
39339>>>>>>>Use  Windows           // Basic Definitions
39339>>>>>>>Use  DataDict          // DataDictionary Class Definition
39339>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39339>>>>>>>
39339>>>>>>>Open Wtypkin
39341>>>>>>>Open Ptyppar
39343>>>>>>>Open Wcmoves
39345>>>>>>>Open Hmwtyp
INCLUDING FILE: HMWTYP.FD
39347>>>>>>>Open Wflagkin
INCLUDING FILE: WFLAGKIN.FD
39349>>>>>>>Open Sysrecw
39351>>>>>>>Open Syscurxr
39353>>>>>>>
39353>>>>>>>//DDB-HeaderEnd
39353>>>>>>>//DDB-ValidationStart
39353>>>>>>>
39353>>>>>>>Register_Object Wtypkin_Wtypkin_Module_VT
39353>>>>>>>
39353>>>>>>>Object Wtypkin_Wtypkin_Module_VT  is a CodeValidationTable
39355>>>>>>>    Set Type_Value        To "MODULE"
39356>>>>>>>    //DDB-ValidationCustomStart
39356>>>>>>>    //DDB-ValidationCustomEnd
39356>>>>>>>End_Object   // Wtypkin_Wtypkin_Module_VT
39357>>>>>>>//DDB-ValidationEnd
39357>>>>>>>//DDB-SelectionStart
39357>>>>>>>//DDB/ ExternalSelectionList sl029a  sl029a.SL
39357>>>>>>>Register_Object sl029a
39357>>>>>>>//DDB-SelectionEnd
39357>>>>>>>
39357>>>>>>>Class Wtypkin_DataDictionary  is a DataDictionary
39358>>>>>>>               
39358>>>>>>>    Procedure Construct_Object
39359>>>>>>>        Forward Send Construct_Object
39361>>>>>>>        Property Integer piMustNOTConstrain Public 0
39362>>>>>>>    End_Procedure
39363>>>>>>>
39363>>>>>>>    Procedure Save_Main_File
39364>>>>>>>        If (Operation_Origin<>Self) Begin
39366>>>>>>>            If Wtypkin.Recnum Eq 0 Procedure_Return
39369>>>>>>>        End
39369>>>>>>>>
39369>>>>>>>        Forward Send Save_Main_File
39371>>>>>>>    End_Procedure
39372>>>>>>>
39372>>>>>>>
39372>>>>>>>     Procedure Creating
39373>>>>>>>        Forward Send Creating
39375>>>>>>>        // Insert Code Here
39375>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wtypkin.Wtypkin_Rec0)))))) to Wtypkin.Wtypkin_Recr
39376>>>>>>>    End_Procedure   // Creating
39377>>>>>>>
39377>>>>>>>    // Define_Fields:
39377>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39377>>>>>>>
39377>>>>>>>    Procedure Define_Fields
39378>>>>>>>        Forward Send Define_Fields
39380>>>>>>>        //DDB-Generated-Code-Location
39380>>>>>>>        //DDB-DefineFieldStart
39380>>>>>>>
39380>>>>>>>        Set Main_File            To Wtypkin.File_Number
39381>>>>>>>        Set Cascade_Delete_State To FALSE
39382>>>>>>>
39382>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39383>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39384>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39385>>>>>>>
39385>>>>>>>        // Child (Client) file structure................
39385>>>>>>>        Send Add_Client_File  Ptyppar.File_Number
39386>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
39387>>>>>>>        Send Add_Client_File  Hmwtyp.File_Number
39388>>>>>>>        Send Add_Client_File  Wflagkin.File_Number
39389>>>>>>>
39389>>>>>>>        // External (System) file structure.............
39389>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
39390>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
39391>>>>>>>
39391>>>>>>>        Define_Auto_Increment  Sysrecw.Wtypkin_Rec0  To Wtypkin.Wtypkin_Rec0
39394>>>>>>>
39394>>>>>>>        // Field-based properties.......................
39394>>>>>>>
39394>>>>>>>        // Wtypkin.Company_Code
39394>>>>>>>
39394>>>>>>>        // Wtypkin.Branch_Code
39394>>>>>>>
39394>>>>>>>        // Wtypkin.Year_Year
39394>>>>>>>
39394>>>>>>>        // Wtypkin.Wtypkin_Code
39394>>>>>>>        Set Field_Options          Field Wtypkin.Wtypkin_Code To DD_AUTOFIND   
39395>>>>>>>        Set Field_Prompt_Object    Field Wtypkin.Wtypkin_Code To (sl029a(Self))
39396>>>>>>>        Set Key_Field_State        Field Wtypkin.Wtypkin_Code To TRUE
39397>>>>>>>
39397>>>>>>>        // Wtypkin.Wtypkin_Rec0
39397>>>>>>>        Set Field_Options          Field Wtypkin.Wtypkin_Rec0 To DD_AUTOFIND   
39398>>>>>>>
39398>>>>>>>        // Wtypkin.Wtypkin_Recr
39398>>>>>>>
39398>>>>>>>        // Wtypkin.Year_Recr
39398>>>>>>>
39398>>>>>>>        // Wtypkin.Wtypkin_Descr
39398>>>>>>>        Set Field_Prompt_Object    Field Wtypkin.Wtypkin_Descr To (sl029a(Self))
39399>>>>>>>
39399>>>>>>>        // Wtypkin.Wtypkin_Anti
39399>>>>>>>
39399>>>>>>>        // Wtypkin.Wtypkin_Module
39399>>>>>>>        Set Field_Value_Table      Field Wtypkin.Wtypkin_Module To (Wtypkin_Wtypkin_Module_VT(Self))
39400>>>>>>>
39400>>>>>>>        // Wtypkin.Max_Days_Sx_Par
39400>>>>>>>
39400>>>>>>>        //DDB-DefineFieldEnd
39400>>>>>>>    End_Procedure    // Define_Fields
39401>>>>>>>
39401>>>>>>>    // Field_Defaults:
39401>>>>>>>    // This procedure is used to establish default field values.
39401>>>>>>>
39401>>>>>>>    Procedure Field_Defaults
39402>>>>>>>        Forward Send Field_Defaults
39404>>>>>>>        //DDB-Generated-Code-Location
39404>>>>>>>        //DDB-FieldDefaultStart
39404>>>>>>>        //DDB-FieldDefaultEnd
39404>>>>>>>    End_Procedure    // Field_Defaults
39405>>>>>>>
39405>>>>>>>End_Class    // Wtypkin_DataDictionary
39406>>>>>>>//DDB-Selection-pkg-Start
39406>>>>>>>
39406>>>>>>>Use sl029a.SL        // sl029a
INCLUDING FILE: SL029A.SL
39406>>>>>>>>>//AB/ Project sl029a:wtypkin
39406>>>>>>>>>//AB/     Object prj is a Lookup_Project
39406>>>>>>>>>//AB/         Set ProjectName to "sl029a:wtypkin"
39406>>>>>>>>>//AB/         Set ProjectFileName to "sl029a.SL"
39406>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
39406>>>>>>>>>
39406>>>>>>>>>// Project Object Structure
39406>>>>>>>>>//   sl029a is a dbModalPanelSub
39406>>>>>>>>>//     Wtypkin_DD is a DataDictionary
39406>>>>>>>>>//     oSelList is a dbListSub
39406>>>>>>>>>//     oOK_bn is a ButtonSub
39406>>>>>>>>>//     oCancel_bn is a ButtonSub
39406>>>>>>>>>//     oSearch_bn is a ButtonSub
39406>>>>>>>>>
39406>>>>>>>>>// Register all objects
39406>>>>>>>>>Register_Object oCancel_bn
39406>>>>>>>>>Register_Object oOK_bn
39406>>>>>>>>>Register_Object oSearch_bn
39406>>>>>>>>>Register_Object oSelList
39406>>>>>>>>>Register_Object sl029a
39406>>>>>>>>>Register_Object Wtypkin_DD
39406>>>>>>>>>
39406>>>>>>>>>
39406>>>>>>>>>    //AB-IgnoreStart
39406>>>>>>>>>
39406>>>>>>>>>    Use DFAllEnt.pkg
39406>>>>>>>>>    Use dbList.Sub
39406>>>>>>>>>    Use Button.Sub
39406>>>>>>>>>
39406>>>>>>>>>
39406>>>>>>>>>    Use WTYPKIN.DD
39406>>>>>>>>>    
39406>>>>>>>>>    //AB-IgnoreEnd
39406>>>>>>>>>
39406>>>>>>>>>    Object sl029a is a dbModalPanelSub
39408>>>>>>>>>        set label to "Ž¨ ©£æª ‰ ¤ã©œà¤ €§¦Ÿã¡žª" 
39409>>>>>>>>>        Set Size to 148 297
39410>>>>>>>>>        Set Location to 4 5
39411>>>>>>>>>        Set Exit_Application_Local_State to FALSE
39412>>>>>>>>>        Set Modal_State to FALSE
39413>>>>>>>>>
39413>>>>>>>>>        //AB-DDOStart
39413>>>>>>>>>
39413>>>>>>>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
39415>>>>>>>>>        End_Object    // Wtypkin_DD
39416>>>>>>>>>
39416>>>>>>>>>        Set Main_DD to (Wtypkin_DD(self))
39417>>>>>>>>>        Set Server to (Wtypkin_DD(self))
39418>>>>>>>>>
39418>>>>>>>>>        //AB-DDOEnd
39418>>>>>>>>>
39418>>>>>>>>>        Object oSelList is a dbListSub
39420>>>>>>>>>            Set Main_File to Wtypkin.File_Number
39421>>>>>>>>>            Set Size to 105 280
39422>>>>>>>>>            Set Location to 6 6
39423>>>>>>>>>
39423>>>>>>>>>            Begin_Row
39426>>>>>>>>>                Entry_Item Wtypkin.Wtypkin_code
39427>>>>>>>>>                Entry_Item Wtypkin.Wtypkin_descr
39428>>>>>>>>>            End_Row
39433>>>>>>>>>
39433>>>>>>>>>            Set Form_Width    item 0 to 60
39434>>>>>>>>>            set header_label  item 0 to "‰à› ¡¦ª" 
39435>>>>>>>>>            
39435>>>>>>>>>            Set Form_Width    item 1 to 212
39436>>>>>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
39437>>>>>>>>>            
39437>>>>>>>>>        End_Object    // oSelList
39438>>>>>>>>>
39438>>>>>>>>>        Object oOK_bn is a ButtonSub
39440>>>>>>>>>            set label to "&„§ ¢¦šã" 
39441>>>>>>>>>            Set Location to 115 126
39442>>>>>>>>>
39442>>>>>>>>>            //AB-StoreStart
39442>>>>>>>>>            Procedure OnClick
39444>>>>>>>>>                Send OK To (oSelList(current_object))
39445>>>>>>>>>            End_Procedure
39446>>>>>>>>>            //AB-StoreEnd
39446>>>>>>>>>
39446>>>>>>>>>        End_Object    // oOK_bn
39447>>>>>>>>>
39447>>>>>>>>>        Object oCancel_bn is a ButtonSub
39449>>>>>>>>>            set label to "&€¡ç¨à©ž" 
39450>>>>>>>>>            Set Location to 115 181
39451>>>>>>>>>
39451>>>>>>>>>            //AB-StoreStart
39451>>>>>>>>>            Procedure OnClick
39453>>>>>>>>>                Send Cancel To (oSelList(current_object))
39454>>>>>>>>>            End_Procedure
39455>>>>>>>>>            //AB-StoreEnd
39455>>>>>>>>>
39455>>>>>>>>>        End_Object    // oCancel_bn
39456>>>>>>>>>
39456>>>>>>>>>        Object oSearch_bn is a ButtonSub
39458>>>>>>>>>            set label to "€&¤˜ã«ž©ž" 
39459>>>>>>>>>            Set Location to 115 236
39460>>>>>>>>>
39460>>>>>>>>>            //AB-StoreStart
39460>>>>>>>>>            Procedure OnClick
39462>>>>>>>>>                Send Search To (oSelList(current_object))
39463>>>>>>>>>            End_Procedure
39464>>>>>>>>>            //AB-StoreEnd
39464>>>>>>>>>
39464>>>>>>>>>        End_Object    // oSearch_bn
39465>>>>>>>>>
39465>>>>>>>>>
39465>>>>>>>>>        //AB-StoreStart
39465>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39466>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39467>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39468>>>>>>>>>        //AB-StoreEnd
39468>>>>>>>>>
39468>>>>>>>>>    End_Object    // sl029a
39469>>>>>>>>>
39469>>>>>>>>>//AB/     End_Object    // prj
39469>>>>>>>
39469>>>>>>>//DDB-Selection-pkg-End
39469>>>>>>>//DDB-FileEnd
39469>>>>>Use PTYPPAR.DD
INCLUDING FILE: PTYPPAR.DD
39469>>>>>>>//DDB-FileStart
39469>>>>>>>//DDB-HeaderStart
39469>>>>>>>
39469>>>>>>>// File Name : PTYPPAR.DD
39469>>>>>>>// Class Name: Ptyppar_DataDictionary
39469>>>>>>>// Revision  : 88
39469>>>>>>>// Version   : 2
39469>>>>>>>
39469>>>>>>>Use  Windows           // Basic Definitions
39469>>>>>>>Use  DataDict          // DataDictionary Class Definition
39469>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39469>>>>>>>
39469>>>>>>>Open Ptyppar
39471>>>>>>>Open Particle
39473>>>>>>>Open Pseira
INCLUDING FILE: PSEIRA.FD
39475>>>>>>>Open Ptypmet
INCLUDING FILE: PTYPMET.FD
39477>>>>>>>Open Ptypparh
INCLUDING FILE: PTYPPARH.FD
39479>>>>>>>Open Ctypkin
39481>>>>>>>Open Wtypkin
39483>>>>>>>Open Sysrecp
INCLUDING FILE: SYSRECP.FD
39485>>>>>>>Open Syscurxr
39487>>>>>>>
39487>>>>>>>//DDB-HeaderEnd
39487>>>>>>>//DDB-ValidationStart
39487>>>>>>>
39487>>>>>>>Register_Object Ptyppar_Year_Recr_VT
39487>>>>>>>Register_Object Ptyppar_Ptyppar_Is_What_VT
39487>>>>>>>Register_Object Ptyppar_Ptyppar_Module_VT
39487>>>>>>>Register_Object Ptyppar_Ti_Typonei_Pms_VT1
39487>>>>>>>
39487>>>>>>>Object Ptyppar_Year_Recr_VT  is a DescriptionValidationTable
39489>>>>>>>    Set Allow_Blank_State To TRUE
39490>>>>>>>
39490>>>>>>>    Procedure Fill_List
39492>>>>>>>        Forward Send Fill_List
39494>>>>>>>        Send Add_Table_Value  ""  "ƒœ¤ ‘¬££œ«â®œ "
39495>>>>>>>        Send Add_Table_Value  "1"  "¨¦©Ÿœ« ¡á"
39496>>>>>>>        Send Add_Table_Value  "2"  "€­˜ ¨œ« ¡á"
39497>>>>>>>    End_Procedure    // Fill_List
39498>>>>>>>    //DDB-ValidationCustomStart
39498>>>>>>>    //DDB-ValidationCustomEnd
39498>>>>>>>End_Object   // Ptyppar_Year_Recr_VT
39499>>>>>>>
39499>>>>>>>Object Ptyppar_Ptyppar_Is_What_VT  is a DescriptionValidationTable
39501>>>>>>>
39501>>>>>>>    Procedure Fill_List
39503>>>>>>>        Forward Send Fill_List
39505>>>>>>>        Send Add_Table_Value  "1"  "€š¦¨á"
39506>>>>>>>        Send Add_Table_Value  "2"  "é¢ž©ž"
39507>>>>>>>        Send Add_Table_Value  "3"  "€ŠŠŽ"
39508>>>>>>>    End_Procedure    // Fill_List
39509>>>>>>>    //DDB-ValidationCustomStart
39509>>>>>>>    //DDB-ValidationCustomEnd
39509>>>>>>>End_Object   // Ptyppar_Ptyppar_Is_What_VT
39510>>>>>>>
39510>>>>>>>Object Ptyppar_Ptyppar_Module_VT  is a CodeValidationTable
39512>>>>>>>    Set Type_Value        To "MODULE"
39513>>>>>>>    Set Allow_Blank_State To TRUE
39514>>>>>>>    //DDB-ValidationCustomStart
39514>>>>>>>    //DDB-ValidationCustomEnd
39514>>>>>>>End_Object   // Ptyppar_Ptyppar_Module_VT
39515>>>>>>>
39515>>>>>>>Object Ptyppar_Ti_Typonei_Pms_VT1  is a DescriptionValidationTable
39517>>>>>>>    Set Allow_Blank_State To TRUE
39518>>>>>>>
39518>>>>>>>    Procedure Fill_List
39520>>>>>>>        Forward Send Fill_List
39522>>>>>>>        Send Add_Table_Value  ""  "¦©æ«ž«œª ¡˜  €¥åœª"
39523>>>>>>>        Send Add_Table_Value  "1"  "¦©æ«ž«œª"
39524>>>>>>>        Send Add_Table_Value  "2"  "€¥åœª"
39525>>>>>>>    End_Procedure    // Fill_List
39526>>>>>>>    //DDB-ValidationCustomStart
39526>>>>>>>    //DDB-ValidationCustomEnd
39526>>>>>>>End_Object   // Ptyppar_Ti_Typonei_Pms_VT1
39527>>>>>>>//DDB-ValidationEnd
39527>>>>>>>//DDB-SelectionStart
39527>>>>>>>//DDB/ ExternalSelectionList sl012  sl012.SL
39527>>>>>>>Register_Object sl012
39527>>>>>>>//DDB-SelectionEnd
39527>>>>>>>
39527>>>>>>>Class Ptyppar_DataDictionary  is a DataDictionary_Sec
39528>>>>>>>
39528>>>>>>>    Procedure Construct_Object
39529>>>>>>>        Forward Send Construct_Object
39531>>>>>>>        Property Integer piMustNOTConstrain Public 0
39532>>>>>>>        Property Integer piOldCtypkin       Public 0
39533>>>>>>>        Property Integer piOldWtypkin       Public 0
39534>>>>>>>    End_Procedure
39535>>>>>>>
39535>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
39536>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
39538>>>>>>>        Set piOldCtypkin to Ctypkin.Ctypkin_Code
39539>>>>>>>        Set piOldWtypkin to Wtypkin.Wtypkin_Code
39540>>>>>>>    End_Procedure   // New_Current_Record
39541>>>>>>>
39541>>>>>>>    Procedure OnConstrain
39542>>>>>>>        If (piMustNotConstrain(Self)=0) Begin
39544>>>>>>>            Constrain Ptyppar.Company_Code  eq SysCurXR.Company_Code
39546>>>>>>>            Constrain Ptyppar.Branch_Code   eq SysCurXR.Branch_Code
39548>>>>>>>        End
39548>>>>>>>>
39548>>>>>>>    End_Procedure
39549>>>>>>>
39549>>>>>>>    Procedure Clear_Main_File
39550>>>>>>>        Forward Send Clear_Main_File
39552>>>>>>>        Set piOldCtypkin to 0
39553>>>>>>>        Set piOldWtypkin to 0
39554>>>>>>>    End_Procedure
39555>>>>>>>
39555>>>>>>>    Procedure Save_Main_File
39556>>>>>>>        Integer isAdmin iYes
39557>>>>>>>        String  sStr
39557>>>>>>>        Get fig_Is_Admin to isAdmin
39558>>>>>>>
39558>>>>>>>        If (Operation_Origin<>Self) Begin
39560>>>>>>>            If Ptyppar.Recnum Eq 0 Procedure_Return
39563>>>>>>>        End
39563>>>>>>>>
39563>>>>>>>
39563>>>>>>>        If (Operation_Origin=Self) Begin
39565>>>>>>>            If ((piOldCtypkin(Self)<>0) And (piOldCtypkin(Self)<>Ctypkin.Ctypkin_Code)) Begin
39567>>>>>>>                If (Not(isAdmin)) Error 1001 'ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ¡å¤ž©žª §œ¢á«ž'
39570>>>>>>>                Else Begin
39571>>>>>>>                    Move '' to sStr
39572>>>>>>>                    Append sStr '€¤ ˜¢¢á¥œ«œ ¡å¤ž©ž, £§¦¨œå ¤˜ œ§ž¨œá©œ  ã›ž ¡˜«˜®à¨ž£â¤˜ §˜¨˜©«˜« ¡á\n «˜ ¦§¦å˜ â®¦¬¤ ­« ˜®«œå £œ « ª §˜¢ âª ¡ ¤ã©œ ª §¦¬ «é¨˜ ˜¢¢áœ«œ\n„å©«œ ™â™˜ ¦  §àª Ÿâ¢œ«œ ¤˜ ©¬¤œ®å©à ?'
39573>>>>>>>                    Get YesNo_Box sStr to iYes
39574>>>>>>>                    If (iYes=MBR_NO) Error 1000 '€¡¬¨éŸž¡œ ž › ˜› ¡˜©å˜ ˜¢¢˜šãª ˜§¦ «¦¤ ®¨ã©«ž'
39577>>>>>>>                End
39577>>>>>>>>
39577>>>>>>>            End // If ((piOldCtypkin(Self)<>0) And (piOldCtypkin(Self)<>Ctypkin.Ctypkin_Code))
39577>>>>>>>>
39577>>>>>>>            If ((piOldWtypkin(Self)<>0) And (piOldWtypkin(Self)<>Wtypkin.Wtypkin_Code)) Begin
39579>>>>>>>                If (Not(isAdmin)) Error 1002 'ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ¡å¤ž©žª ˜§¦Ÿã¡žª'
39582>>>>>>>                Else Begin
39583>>>>>>>                    Move '' to sStr
39584>>>>>>>                    Append sStr '€¤ ˜¢¢á¥œ«œ ¡å¤ž©ž, £§¦¨œå ¤˜ œ§ž¨œá©œ  ã›ž ¡˜«˜®à¨ž£â¤˜ §˜¨˜©«˜« ¡á\n «˜ ¦§¦å˜ â®¦¬¤ ­« ˜®«œå £œ « ª §˜¢ âª ¡ ¤ã©œ ª §¦¬ «é¨˜ ˜¢¢áœ«œ\n„å©«œ ™â™˜ ¦  §àª Ÿâ¢œ«œ ¤˜ ©¬¤œ®å©à ?'
39585>>>>>>>                    Get YesNo_Box sStr to iYes
39586>>>>>>>                    If (iYes=MBR_NO) Error 1000 '€¡¬¨éŸž¡œ ž › ˜› ¡˜©å˜ ˜¢¢˜šãª ˜§¦ «¦¤ ®¨ã©«ž'
39589>>>>>>>                End
39589>>>>>>>>
39589>>>>>>>            End // ((piOldWtypkin(Self)<>0) And (piOldWtypkin(Self)<>Wtypkin.Wtypkin_Code))
39589>>>>>>>>
39589>>>>>>>        End // If (Operation_Origin=Self)
39589>>>>>>>>
39589>>>>>>>        Forward Send Save_Main_File
39591>>>>>>>    End_Procedure // Save_Main_File
39592>>>>>>>
39592>>>>>>>
39592>>>>>>>    Procedure Update
39593>>>>>>>        Forward Send Update
39595>>>>>>>        // Insert Code Here
39595>>>>>>>//        If (piMustNotConstrain(Self)=0) Begin
39595>>>>>>>            Move SysCurXR.Company_Code  to Ptyppar.Company_Code
39596>>>>>>>            Move SysCurXR.Branch_Code   to Ptyppar.Branch_Code
39597>>>>>>>//        end
39597>>>>>>>//        Move SysCurXR.Year_Year     to Ptyppar.Year_Year
39597>>>>>>>//        Move SysCurXR.Year_Recr     to Ptyppar.Year_Recr
39597>>>>>>>        Move Ctypkin.Ctypkin_Code   to Ptyppar.Ctypkin_Code
39598>>>>>>>        Move Wtypkin.Wtypkin_Code   to Ptyppar.Wtypkin_Code
39599>>>>>>>        if (ptyppar.sysxet_ptyppar='');            move '' to ptyppar.sysx_ptyp_recr
39602>>>>>>>    End_Procedure   // Update
39603>>>>>>>
39603>>>>>>>    Procedure Creating
39604>>>>>>>        Forward Send Creating
39606>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Ptyppar.Ptyppar_Rec0)))))) to Ptyppar.Ptyppar_Recr
39607>>>>>>>    End_Procedure   // Creating
39608>>>>>>>
39608>>>>>>>
39608>>>>>>>    // Define_Fields:
39608>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39608>>>>>>>    Procedure Define_Fields
39609>>>>>>>        Forward Send Define_Fields
39611>>>>>>>        //DDB-Generated-Code-Location
39611>>>>>>>        //DDB-DefineFieldStart
39611>>>>>>>
39611>>>>>>>        Set Main_File            To Ptyppar.File_Number
39612>>>>>>>        Set Cascade_Delete_State To FALSE
39613>>>>>>>
39613>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
39614>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
39615>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39616>>>>>>>
39616>>>>>>>        // Child (Client) file structure................
39616>>>>>>>        Send Add_Client_File  Particle.File_Number
39617>>>>>>>        Send Add_Client_File  Pseira.File_Number
39618>>>>>>>        Send Add_Client_File  Ptypmet.File_Number
39619>>>>>>>        Send Add_Client_File  Ptypparh.File_Number
39620>>>>>>>
39620>>>>>>>        // Parent (Server) file structure...............
39620>>>>>>>        Send Add_Server_File  Ctypkin.File_Number
39621>>>>>>>        Send Add_Server_File  Wtypkin.File_Number
39622>>>>>>>
39622>>>>>>>        // External (System) file structure.............
39622>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
39623>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
39624>>>>>>>
39624>>>>>>>        Define_Auto_Increment  Sysrecp.Ptyppar_Rec0  To Ptyppar.Ptyppar_Rec0
39627>>>>>>>
39627>>>>>>>        // Field-based properties.......................
39627>>>>>>>
39627>>>>>>>        // Ptyppar.Company_Code
39627>>>>>>>
39627>>>>>>>        // Ptyppar.Branch_Code
39627>>>>>>>
39627>>>>>>>        // Ptyppar.Year_Year
39627>>>>>>>
39627>>>>>>>        // Ptyppar.Ctypkin_Code
39627>>>>>>>
39627>>>>>>>        // Ptyppar.Wtypkin_Code
39627>>>>>>>
39627>>>>>>>        // Ptyppar.Year_Recr
39627>>>>>>>        Set Field_Value_Table      Field Ptyppar.Year_Recr To (Ptyppar_Year_Recr_VT(Self))
39628>>>>>>>
39628>>>>>>>        // Ptyppar.Ctypkin_Recr
39628>>>>>>>
39628>>>>>>>        // Ptyppar.Wtypkin_Recr
39628>>>>>>>
39628>>>>>>>        // Ptyppar.Ptyppar_Code
39628>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Code To DD_AUTOFIND
39629>>>>>>>        Set Field_Prompt_Object    Field Ptyppar.Ptyppar_Code To (sl012(Self))
39630>>>>>>>        Set Key_Field_State        Field Ptyppar.Ptyppar_Code To TRUE
39631>>>>>>>
39631>>>>>>>        // Ptyppar.Ptyppar_Rec0
39631>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Rec0 To DD_AUTOFIND
39632>>>>>>>
39632>>>>>>>        // Ptyppar.Ptyppar_Descr
39632>>>>>>>        Set Field_Prompt_Object    Field Ptyppar.Ptyppar_Descr To (sl012(Self))
39633>>>>>>>
39633>>>>>>>        // Ptyppar.Ptyppar_Recr
39633>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Recr To DD_AUTOFIND
39634>>>>>>>
39634>>>>>>>        // Ptyppar.Ptyppar_Is_What
39634>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ptyppar_Is_What To (Ptyppar_Ptyppar_Is_What_VT(Self))
39635>>>>>>>
39635>>>>>>>        // Ptyppar.Ptyppar_Module
39635>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ptyppar_Module To (Ptyppar_Ptyppar_Module_VT(Self))
39636>>>>>>>
39636>>>>>>>        // Ptyppar.Ptyppar_Abrev
39636>>>>>>>
39636>>>>>>>        // Ptyppar.Ftiaxnei_Tpay
39636>>>>>>>        Set Field_Class_Name       Field Ptyppar.Ftiaxnei_Tpay To "dbCheckBoxsub"
39637>>>>>>>
39637>>>>>>>        // Ptyppar.Ti_Typonei_Pms
39637>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ti_Typonei_Pms To (Ptyppar_Ti_Typonei_Pms_VT1(Self))
39638>>>>>>>
39638>>>>>>>        // Ptyppar.Einai_Paroxh_Yp
39638>>>>>>>        Set Field_Checkbox_Values  Field Ptyppar.Einai_Paroxh_Yp To "1"  "0"
39639>>>>>>>        Set Field_Class_Name       Field Ptyppar.Einai_Paroxh_Yp To "dbCheckBoxsub"
39640>>>>>>>
39640>>>>>>>        // Ptyppar.Gtypkin_Code
39640>>>>>>>
39640>>>>>>>        // Ptyppar.Sysxet_Ptyppar
39640>>>>>>>
39640>>>>>>>        // Ptyppar.Sysx_Ptyp_Recr
39640>>>>>>>
39640>>>>>>>        // Ptyppar.Check_Posa_Plaf
39640>>>>>>>
39640>>>>>>>        // Ptyppar.Singular
39640>>>>>>>
39640>>>>>>>        // Ptyppar.Sub
39640>>>>>>>
39640>>>>>>>        // Ptyppar.Constrain
39640>>>>>>>
39640>>>>>>>        // Ptyppar.Label
39640>>>>>>>
39640>>>>>>>        // Ptyppar.Label1
39640>>>>>>>
39640>>>>>>>        // Ptyppar.Sap
39640>>>>>>>
39640>>>>>>>        // Ptyppar.Is_Xondr
39640>>>>>>>
39640>>>>>>>        //DDB-DefineFieldEnd
39640>>>>>>>    End_Procedure    // Define_Fields
39641>>>>>>>
39641>>>>>>>    // Field_Defaults:
39641>>>>>>>    // This procedure is used to establish default field values.
39641>>>>>>>
39641>>>>>>>    Procedure Field_Defaults
39642>>>>>>>        Forward Send Field_Defaults
39644>>>>>>>        //DDB-Generated-Code-Location
39644>>>>>>>        //DDB-FieldDefaultStart
39644>>>>>>>        Set Field_Changed_Value   Field Ptyppar.Ftiaxnei_Tpay To "1"
39645>>>>>>>        Set Field_Changed_Value   Field Ptyppar.Einai_Paroxh_Yp To 0
39646>>>>>>>        //DDB-FieldDefaultEnd
39646>>>>>>>    End_Procedure    // Field_Defaults
39647>>>>>>>
39647>>>>>>>End_Class    // Ptyppar_DataDictionary
39648>>>>>>>//DDB-Selection-pkg-Start
39648>>>>>>>
39648>>>>>>>Use sl012.SL         // sl012
39648>>>>>>>
39648>>>>>>>//DDB-Selection-pkg-End
39648>>>>>>>//DDB-FileEnd
39648>>>>>
39648>>>>>//AB-IgnoreEnd
39648>>>>>
39648>>>>>Object sl012 is a dbModalPanelSub
39650>>>>>
39650>>>>>    //AB-StoreTopStart
39650>>>>>    Property String psModule Public ''
39652>>>>>    Property integer pifromclient Public 0
39654>>>>>    
39654>>>>>    //AB-StoreTopEnd
39654>>>>>
39654>>>>>    Set Label to "’ç§¦  §˜¨˜©«˜« ¡é¤"
39655>>>>>    Set Size to 203 490
39656>>>>>    Set Location to 4 4
39657>>>>>    Set Exit_Application_Local_State to FALSE
39658>>>>>    Set Modal_State to FALSE
39659>>>>>
39659>>>>>    //AB-DDOStart
39659>>>>>
39659>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
39661>>>>>    End_Object    // Ctypkin_DD
39662>>>>>
39662>>>>>    Object Wtypkin_DD is a Wtypkin_DataDictionary
39664>>>>>    End_Object    // Wtypkin_DD
39665>>>>>
39665>>>>>    Object Ptyppar_DD is a Ptyppar_DataDictionary
39667>>>>>        Set DDO_Server to (Ctypkin_DD(self))
39668>>>>>        Set DDO_Server to (Wtypkin_DD(self))
39669>>>>>
39669>>>>>        //AB-StoreStart
39669>>>>>        
39669>>>>>        Procedure OnConstrain
39671>>>>>            Forward Send OnConstrain
39673>>>>>            If (psModule(Self)<>'') Begin
39675>>>>>                Constrain Ptyppar.Ptyppar_Module eq (psModule(Self))
39677>>>>>            End
39677>>>>>>
39677>>>>>            If (pifromclient(self)=1) Begin
39679>>>>>                Constrain Ptyppar.constrain eq '1'
39681>>>>>            End
39681>>>>>>
39681>>>>>        End_Procedure
39682>>>>>        
39682>>>>>        
39682>>>>>        
39682>>>>>        
39682>>>>>        //AB-StoreEnd
39682>>>>>
39682>>>>>    End_Object    // Ptyppar_DD
39683>>>>>
39683>>>>>    Set Main_DD to (Ptyppar_DD(self))
39684>>>>>    Set Server to (Ptyppar_DD(self))
39685>>>>>
39685>>>>>    //AB-DDOEnd
39685>>>>>
39685>>>>>    Object oSelList is a dbListSub
39687>>>>>        Set Main_File to Ptyppar.File_Number
39688>>>>>        Set Size to 161 474
39689>>>>>        Set Location to 6 6
39690>>>>>
39690>>>>>        Begin_Row
39693>>>>>            Entry_Item Ptyppar.Ptyppar_code
39694>>>>>            Entry_Item Ptyppar.Ptyppar_descr
39695>>>>>            Entry_Item Ctypkin.Ctypkin_descr
39696>>>>>            Entry_Item Wtypkin.Wtypkin_descr
39697>>>>>        End_Row
39702>>>>>
39702>>>>>        Set Form_Width    item 0 to 77
39703>>>>>        Set Header_Label  item 0 to "‰à›. ˜¨˜©«˜« ¡¦ç"
39704>>>>>        
39704>>>>>        Set Form_Width    item 1 to 125
39705>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
39706>>>>>        
39706>>>>>        Set Form_Width    item 2 to 137
39707>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž"
39708>>>>>        
39708>>>>>        Set Form_Width    item 3 to 129
39709>>>>>        Set Header_Label  item 3 to "‰å¤ž©ž €§¦Ÿã¡žª"
39710>>>>>        
39710>>>>>
39710>>>>>        //AB-StoreStart
39710>>>>>        
39710>>>>>        Procedure Activate
39712>>>>>            Forward Send Activate
39714>>>>>            Send Rebuild_Constraints to Ptyppar_DD
39715>>>>>            Send Beginning_Of_Data to oSelList True
39716>>>>>        End_Procedure
39717>>>>>        
39717>>>>>        //AB-StoreEnd
39717>>>>>
39717>>>>>    End_Object    // oSelList
39718>>>>>
39718>>>>>    Object oOK_bn is a ButtonSub
39720>>>>>        Set Label to "&„§ ¢¦šã"
39721>>>>>        Set Location to 171 323
39722>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
39723>>>>>
39723>>>>>        //AB-StoreStart
39723>>>>>        Procedure OnClick
39725>>>>>            Send OK To (oSelList(current_object))
39726>>>>>        End_Procedure
39727>>>>>        //AB-StoreEnd
39727>>>>>
39727>>>>>    End_Object    // oOK_bn
39728>>>>>
39728>>>>>    Object oCancel_bn is a ButtonSub
39730>>>>>        Set Label to "&€¡ç¨à©ž"
39731>>>>>        Set Location to 171 377
39732>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
39733>>>>>
39733>>>>>        //AB-StoreStart
39733>>>>>        Procedure OnClick
39735>>>>>            Send Cancel To (oSelList(current_object))
39736>>>>>        End_Procedure
39737>>>>>        //AB-StoreEnd
39737>>>>>
39737>>>>>    End_Object    // oCancel_bn
39738>>>>>
39738>>>>>    Object oSearch_bn is a ButtonSub
39740>>>>>        Set Label to "€&¤˜ã«ž©ž"
39741>>>>>        Set Location to 171 433
39742>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
39743>>>>>
39743>>>>>        //AB-StoreStart
39743>>>>>        Procedure OnClick
39745>>>>>            Send Search To (oSelList(current_object))
39746>>>>>        End_Procedure
39747>>>>>        //AB-StoreEnd
39747>>>>>
39747>>>>>    End_Object    // oSearch_bn
39748>>>>>
39748>>>>>
39748>>>>>    //AB-StoreStart
39748>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39749>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39750>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39751>>>>>    
39751>>>>>    
39751>>>>>    //AB-StoreEnd
39751>>>>>
39751>>>>>End_Object    // sl012
39752>>>>>
39752>>>>>//AB/ End_Object    // prj
39752>>>Use sl013.sl
INCLUDING FILE: SL013.SL
39752>>>>>//AB/ Project sl013:SeiraP
39752>>>>>//AB/     Object prj is a Lookup_Project
39752>>>>>//AB/         Set ProjectName to "sl013:SeiraP"
39752>>>>>//AB/         Set ProjectFileName to "sl013.SL"
39752>>>>>//AB/         Set GenerateFileName to "NONAME"
39752>>>>>
39752>>>>>// Project Object Structure
39752>>>>>//   sl013 is a dbModalPanelSub
39752>>>>>//     Ctypkin_DD is a DataDictionary
39752>>>>>//     Wtypkin_DD is a DataDictionary
39752>>>>>//     Ptyppar_DD is a DataDictionary
39752>>>>>//     Pseira_DD is a DataDictionary
39752>>>>>//     oSelList is a dbListSub
39752>>>>>//     oOK_bn is a ButtonSub
39752>>>>>//     oCancel_bn is a ButtonSub
39752>>>>>//     oSearch_bn is a ButtonSub
39752>>>>>
39752>>>>>// Register all objects
39752>>>>>Register_Object Ctypkin_DD
39752>>>>>Register_Object oCancel_bn
39752>>>>>Register_Object oOK_bn
39752>>>>>Register_Object oSearch_bn
39752>>>>>Register_Object oSelList
39752>>>>>Register_Object Pseira_DD
39752>>>>>Register_Object Ptyppar_DD
39752>>>>>Register_Object sl013
39752>>>>>Register_Object Wtypkin_DD
39752>>>>>
39752>>>>>
39752>>>>>    //AB-IgnoreStart
39752>>>>>
39752>>>>>    Use DFAllEnt.pkg
39752>>>>>    Use dbList.Sub
39752>>>>>    Use Button.Sub
39752>>>>>
39752>>>>>
39752>>>>>    Use CTYPKIN.DD
39752>>>>>    Use WTYPKIN.DD
39752>>>>>    Use PTYPPAR.DD
39752>>>>>    Use PSEIRA.DD
INCLUDING FILE: PSEIRA.DD
39752>>>>>>>//DDB-FileStart
39752>>>>>>>//DDB-HeaderStart
39752>>>>>>>
39752>>>>>>>// File Name : PSEIRA.DD
39752>>>>>>>// Class Name: Pseira_DataDictionary
39752>>>>>>>// Revision  : 34
39752>>>>>>>// Version   : 2
39752>>>>>>>
39752>>>>>>>Use  Windows           // Basic Definitions
39752>>>>>>>Use  DataDict          // DataDictionary Class Definition
39752>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39752>>>>>>>
39752>>>>>>>Open Pseira
39754>>>>>>>Open Ptyppar
39756>>>>>>>Open Sysrecp
39758>>>>>>>Open Syscurxr
39760>>>>>>>
39760>>>>>>>//DDB-HeaderEnd
39760>>>>>>>//DDB-SelectionStart
39760>>>>>>>//DDB/ ExternalSelectionList sl013  sl013.SL
39760>>>>>>>Register_Object sl013
39760>>>>>>>//DDB-SelectionEnd
39760>>>>>>>
39760>>>>>>>Class Pseira_DataDictionary  is a DataDictionary
39761>>>>>>>
39761>>>>>>>    Procedure Save_Main_File
39762>>>>>>>        If (Operation_Origin<>Self) Begin
39764>>>>>>>            If Pseira.Recnum Eq 0 Procedure_Return
39767>>>>>>>        End
39767>>>>>>>>
39767>>>>>>>        Forward Send Save_Main_File
39769>>>>>>>    End_Procedure
39770>>>>>>>
39770>>>>>>>    Procedure Update
39771>>>>>>>        Forward Send Update
39773>>>>>>>        // Insert Code Here
39773>>>>>>>        Move SysCurXR.Company_Code  to Pseira.Company_Code
39774>>>>>>>        Move SysCurXR.Branch_Code   to Pseira.Branch_Code
39775>>>>>>>        Move SysCurXR.Year_Year     to Pseira.Year_Year
39776>>>>>>>        Move Ctypkin.Ctypkin_Code   to Pseira.Ctypkin_Code
39777>>>>>>>        Move Wtypkin.Wtypkin_Code   to Pseira.Wtypkin_Code
39778>>>>>>>        Move Ptyppar.Ptyppar_Code   to Pseira.Ptyppar_Code
39779>>>>>>>    End_Procedure   // Update
39780>>>>>>>
39780>>>>>>>
39780>>>>>>>     Procedure Creating
39781>>>>>>>        Forward Send Creating
39783>>>>>>>        // Insert Code Here
39783>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Pseira.Pseira_Rec0)))))) to Pseira.Pseira_Recr
39784>>>>>>>    End_Procedure   // Creating
39785>>>>>>>
39785>>>>>>>
39785>>>>>>>    // Define_Fields:
39785>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39785>>>>>>>
39785>>>>>>>    Procedure Define_Fields
39786>>>>>>>        Forward Send Define_Fields
39788>>>>>>>        //DDB-Generated-Code-Location
39788>>>>>>>        //DDB-DefineFieldStart
39788>>>>>>>
39788>>>>>>>        Set Main_File            To Pseira.File_Number
39789>>>>>>>        Set Cascade_Delete_State To FALSE
39790>>>>>>>
39790>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39791>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39792>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39793>>>>>>>
39793>>>>>>>        // Parent (Server) file structure...............
39793>>>>>>>        Send Add_Server_File  Ptyppar.File_Number
39794>>>>>>>
39794>>>>>>>        // External (System) file structure.............
39794>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
39795>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
39796>>>>>>>
39796>>>>>>>        Define_Auto_Increment  Sysrecp.Pseira_Rec0  To Pseira.Pseira_Rec0
39799>>>>>>>
39799>>>>>>>        // Field-based properties.......................
39799>>>>>>>
39799>>>>>>>        // Pseira.Company_Code
39799>>>>>>>
39799>>>>>>>        // Pseira.Branch_Code
39799>>>>>>>
39799>>>>>>>        // Pseira.Year_Year
39799>>>>>>>
39799>>>>>>>        // Pseira.Ctypkin_Code
39799>>>>>>>
39799>>>>>>>        // Pseira.Wtypkin_Code
39799>>>>>>>
39799>>>>>>>        // Pseira.Ptyppar_Code
39799>>>>>>>
39799>>>>>>>        // Pseira.Ptyppar_Recr
39799>>>>>>>
39799>>>>>>>        // Pseira.Pseira_Seira
39799>>>>>>>        Set Field_Options          Field Pseira.Pseira_Seira To DD_AUTOFIND   
39800>>>>>>>        Set Field_Prompt_Object    Field Pseira.Pseira_Seira To (sl013(Self))
39801>>>>>>>
39801>>>>>>>        // Pseira.Pseira_Rec0
39801>>>>>>>        Set Field_Options          Field Pseira.Pseira_Rec0 To DD_AUTOFIND   
39802>>>>>>>        Set Field_Prompt_Object    Field Pseira.Pseira_Rec0 To (sl013(Self))
39803>>>>>>>
39803>>>>>>>        // Pseira.Pseira_Recr
39803>>>>>>>        Set Field_Options          Field Pseira.Pseira_Recr To DD_AUTOFIND   
39804>>>>>>>        Set Field_Prompt_Object    Field Pseira.Pseira_Recr To (sl013(Self))
39805>>>>>>>
39805>>>>>>>        // Pseira.Pseira_Printer
39805>>>>>>>
39805>>>>>>>        // Pseira.Pseira_Form
39805>>>>>>>
39805>>>>>>>        // Pseira.Pseira_Autonum
39805>>>>>>>
39805>>>>>>>        // Pseira.Autonum_Plus
39805>>>>>>>
39805>>>>>>>        // Pseira.Autonum_Minus
39805>>>>>>>
39805>>>>>>>        // Pseira.Auto_Plus_Last
39805>>>>>>>
39805>>>>>>>        //DDB-DefineFieldEnd
39805>>>>>>>    End_Procedure    // Define_Fields
39806>>>>>>>
39806>>>>>>>    // Field_Defaults:
39806>>>>>>>    // This procedure is used to establish default field values.
39806>>>>>>>
39806>>>>>>>    Procedure Field_Defaults
39807>>>>>>>        Forward Send Field_Defaults
39809>>>>>>>        //DDB-Generated-Code-Location
39809>>>>>>>        //DDB-FieldDefaultStart
39809>>>>>>>        //DDB-FieldDefaultEnd
39809>>>>>>>    End_Procedure    // Field_Defaults
39810>>>>>>>
39810>>>>>>>End_Class    // Pseira_DataDictionary
39811>>>>>>>//DDB-Selection-pkg-Start
39811>>>>>>>
39811>>>>>>>Use sl013.SL         // sl013
39811>>>>>>>
39811>>>>>>>//DDB-Selection-pkg-End
39811>>>>>>>//DDB-FileEnd
39811>>>>>    
39811>>>>>    //AB-IgnoreEnd
39811>>>>>
39811>>>>>    Object sl013 is a dbModalPanelSub
39813>>>>>
39813>>>>>        //AB-StoreTopStart
39813>>>>>        Property String FragmaPtyppar_Recr Public ''
39815>>>>>        
39815>>>>>        //AB-StoreTopEnd
39815>>>>>
39815>>>>>        Set Label to "‰˜«á¢¦š¦ª ‘œ ¨é¤"
39816>>>>>        Set Size to 148 214
39817>>>>>        Set Location to 1 7
39818>>>>>        Set Exit_Application_Local_State to FALSE
39819>>>>>        Set Modal_State to FALSE
39820>>>>>
39820>>>>>        //AB-DDOStart
39820>>>>>
39820>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
39822>>>>>        End_Object    // Ctypkin_DD
39823>>>>>
39823>>>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
39825>>>>>        End_Object    // Wtypkin_DD
39826>>>>>
39826>>>>>        Object Ptyppar_DD is a Ptyppar_DataDictionary
39828>>>>>            Set DDO_Server to (Ctypkin_DD(self))
39829>>>>>            Set DDO_Server to (Wtypkin_DD(self))
39830>>>>>        End_Object    // Ptyppar_DD
39831>>>>>
39831>>>>>        Object Pseira_DD is a Pseira_DataDictionary
39833>>>>>            Set DDO_Server to (Ptyppar_DD(self))
39834>>>>>
39834>>>>>            //AB-StoreStart
39834>>>>>            Procedure OnConstrain
39836>>>>>                String sID
39837>>>>>                Forward Send OnConstrain
39839>>>>>                Get FragmaPtyppar_Recr to sID
39840>>>>>                Move (trim(sID)) to sID
39841>>>>>                If (sID<>'') Constrain Pseira.Ptyppar_Recr eq sID
39845>>>>>            End_procedure
39846>>>>>            
39846>>>>>            //AB-StoreEnd
39846>>>>>
39846>>>>>        End_Object    // Pseira_DD
39847>>>>>
39847>>>>>        Set Main_DD to (Pseira_DD(self))
39848>>>>>        Set Server to (Pseira_DD(self))
39849>>>>>
39849>>>>>        //AB-DDOEnd
39849>>>>>
39849>>>>>        Object oSelList is a dbListSub
39851>>>>>            Set Main_File to Pseira.File_Number
39852>>>>>            Set Size to 105 197
39853>>>>>            Set Location to 6 6
39854>>>>>
39854>>>>>            Begin_Row
39857>>>>>                Entry_Item Pseira.Pseira_seira
39858>>>>>                Entry_Item Pseira.Pseira_printer
39859>>>>>                Entry_Item Pseira.Pseira_autonum
39860>>>>>            End_Row
39865>>>>>
39865>>>>>            Set Form_Width    item 0 to 40
39866>>>>>            Set Header_Label  item 0 to "‘œ ¨á"
39867>>>>>            
39867>>>>>            Set Form_Width    item 1 to 135
39868>>>>>            Set Header_Label  item 1 to "„¡«¬§à«ãª"
39869>>>>>            
39869>>>>>            Set Form_Width    item 2 to 16
39870>>>>>            Set Header_Label  item 2 to "Autonum"
39871>>>>>            Set Column_Checkbox_State  item 2 to True
39872>>>>>            
39872>>>>>
39872>>>>>            //AB-StoreStart
39872>>>>>                    
39872>>>>>            Property String StoreFragmaPtyppar_Recr Public ''
39874>>>>>            
39874>>>>>            Procedure Store_Defaults
39876>>>>>                   Forward Send Store_Defaults
39878>>>>>                   Set StoreFragmaPtyppar_Recr to (FragmaPtyppar_Recr(Self))
39879>>>>>            End_Procedure
39880>>>>>            
39880>>>>>            Procedure ReStore_Defaults
39882>>>>>                   Forward Send ReStore_Defaults
39884>>>>>                   Set FragmaPtyppar_Recr to (StoreFragmaPtyppar_Recr(Self))
39885>>>>>            End_Procedure
39886>>>>>            
39886>>>>>            Procedure Activating
39888>>>>>                Forward Send Activating
39890>>>>>                Send Rebuild_Constraints to (Pseira_DD(Self))
39891>>>>>            End_Procedure
39892>>>>>            
39892>>>>>            
39892>>>>>            //AB-StoreEnd
39892>>>>>
39892>>>>>        End_Object    // oSelList
39893>>>>>
39893>>>>>        Object oOK_bn is a ButtonSub
39895>>>>>            Set Label to "&„§ ¢¦šã"
39896>>>>>            Set Location to 114 42
39897>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39898>>>>>
39898>>>>>            //AB-StoreStart
39898>>>>>            Procedure OnClick
39900>>>>>                Send OK To (oSelList(current_object))
39901>>>>>            End_Procedure
39902>>>>>            //AB-StoreEnd
39902>>>>>
39902>>>>>        End_Object    // oOK_bn
39903>>>>>
39903>>>>>        Object oCancel_bn is a ButtonSub
39905>>>>>            Set Label to "&€¡ç¨à©ž"
39906>>>>>            Set Location to 114 98
39907>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39908>>>>>
39908>>>>>            //AB-StoreStart
39908>>>>>            Procedure OnClick
39910>>>>>                Send Cancel To (oSelList(current_object))
39911>>>>>            End_Procedure
39912>>>>>            //AB-StoreEnd
39912>>>>>
39912>>>>>        End_Object    // oCancel_bn
39913>>>>>
39913>>>>>        Object oSearch_bn is a ButtonSub
39915>>>>>            Set Label to "€&¤˜ã«ž©ž"
39916>>>>>            Set Location to 114 153
39917>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39918>>>>>
39918>>>>>            //AB-StoreStart
39918>>>>>            Procedure OnClick
39920>>>>>                Send Search To (oSelList(current_object))
39921>>>>>            End_Procedure
39922>>>>>            //AB-StoreEnd
39922>>>>>
39922>>>>>        End_Object    // oSearch_bn
39923>>>>>
39923>>>>>
39923>>>>>        //AB-StoreStart
39923>>>>>            
39923>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39924>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39925>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39926>>>>>        
39926>>>>>        
39926>>>>>        
39926>>>>>        
39926>>>>>        
39926>>>>>        
39926>>>>>        
39926>>>>>        
39926>>>>>        //AB-StoreEnd
39926>>>>>
39926>>>>>    End_Object    // sl013
39927>>>>>
39927>>>>>//AB/     End_Object    // prj
39927>>>Use sl013b.sl
INCLUDING FILE: SL013B.SL
39927>>>>>//AB/ Project sl013b : Pseira
39927>>>>>//AB/ Object prj is a Lookup_Project
39927>>>>>//AB/     Set ProjectName to "sl013b : Pseira"
39927>>>>>//AB/     Set ProjectFileName to "sl013b.SL"
39927>>>>>//AB/     Set GenerateFileName to "NONAME"
39927>>>>>
39927>>>>>// Project Object Structure
39927>>>>>//   sl013b is a dbModalPanelSub
39927>>>>>//     Ctypkin_DD is a DataDictionary
39927>>>>>//     Wtypkin_DD is a DataDictionary
39927>>>>>//     Ptyppar_DD is a DataDictionary
39927>>>>>//     Pseira_DD is a DataDictionary
39927>>>>>//     oSelList is a dbListSub
39927>>>>>//     oOK_bn is a ButtonSub
39927>>>>>//     oCancel_bn is a ButtonSub
39927>>>>>//     oSearch_bn is a ButtonSub
39927>>>>>
39927>>>>>// Register all objects
39927>>>>>Register_Object Ctypkin_DD
39927>>>>>Register_Object oCancel_bn
39927>>>>>Register_Object oOK_bn
39927>>>>>Register_Object oSearch_bn
39927>>>>>Register_Object oSelList
39927>>>>>Register_Object Pseira_DD
39927>>>>>Register_Object Ptyppar_DD
39927>>>>>Register_Object sl013b
39927>>>>>Register_Object Wtypkin_DD
39927>>>>>
39927>>>>>
39927>>>>>//AB-IgnoreStart
39927>>>>>
39927>>>>>Use DFAllEnt.pkg
39927>>>>>Use dbList.Sub
39927>>>>>Use Button.Sub
39927>>>>>
39927>>>>>
39927>>>>>Use CTYPKIN.DD
39927>>>>>Use WTYPKIN.DD
39927>>>>>Use PTYPPAR.DD
39927>>>>>Use PSEIRA.DD
39927>>>>>
39927>>>>>//AB-IgnoreEnd
39927>>>>>
39927>>>>>Object sl013b is a dbModalPanelSub
39929>>>>>    set label to "‘œ ¨œª §˜¨˜©«˜« ¡é¤ §é¢ž©žª" 
39930>>>>>    Set Size to 148 297
39931>>>>>    Set Location to 4 4
39932>>>>>    Set Exit_Application_Local_State to FALSE
39933>>>>>    Set Modal_State to FALSE
39934>>>>>
39934>>>>>    //AB-DDOStart
39934>>>>>
39934>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
39936>>>>>    End_Object    // Ctypkin_DD
39937>>>>>
39937>>>>>    Object Wtypkin_DD is a Wtypkin_DataDictionary
39939>>>>>    End_Object    // Wtypkin_DD
39940>>>>>
39940>>>>>    Object Ptyppar_DD is a Ptyppar_DataDictionary
39942>>>>>        Set DDO_Server to (Ctypkin_DD(self))
39943>>>>>        Set DDO_Server to (Wtypkin_DD(self))
39944>>>>>    End_Object    // Ptyppar_DD
39945>>>>>
39945>>>>>    Object Pseira_DD is a Pseira_DataDictionary
39947>>>>>        Set DDO_Server to (Ptyppar_DD(self))
39948>>>>>    End_Object    // Pseira_DD
39949>>>>>
39949>>>>>    Set Main_DD to (Pseira_DD(self))
39950>>>>>    Set Server to (Pseira_DD(self))
39951>>>>>
39951>>>>>    //AB-DDOEnd
39951>>>>>
39951>>>>>    Object oSelList is a dbListSub
39953>>>>>        Set Main_File to Pseira.File_Number
39954>>>>>        Set Size to 105 280
39955>>>>>        Set Location to 6 6
39956>>>>>
39956>>>>>        Begin_Row
39959>>>>>            Entry_Item Pseira.Pseira_seira
39960>>>>>        End_Row
39965>>>>>
39965>>>>>        Set Form_Width    item 0 to 270
39966>>>>>        set header_label  item 0 to "‘œ ¨˜" 
39967>>>>>        
39967>>>>>    End_Object    // oSelList
39968>>>>>
39968>>>>>    Object oOK_bn is a ButtonSub
39970>>>>>        set label to "&„§ ¢¦šã" 
39971>>>>>        Set Location to 115 126
39972>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
39973>>>>>
39973>>>>>        //AB-StoreStart
39973>>>>>        Procedure OnClick
39975>>>>>            Send OK To (oSelList(current_object))
39976>>>>>        End_Procedure
39977>>>>>        //AB-StoreEnd
39977>>>>>
39977>>>>>    End_Object    // oOK_bn
39978>>>>>
39978>>>>>    Object oCancel_bn is a ButtonSub
39980>>>>>        set label to "&€¡ç¨à©ž" 
39981>>>>>        Set Location to 115 181
39982>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
39983>>>>>
39983>>>>>        //AB-StoreStart
39983>>>>>        Procedure OnClick
39985>>>>>            Send Cancel To (oSelList(current_object))
39986>>>>>        End_Procedure
39987>>>>>        //AB-StoreEnd
39987>>>>>
39987>>>>>    End_Object    // oCancel_bn
39988>>>>>
39988>>>>>    Object oSearch_bn is a ButtonSub
39990>>>>>        set label to "€&¤˜ã«ž©ž" 
39991>>>>>        Set Location to 115 236
39992>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
39993>>>>>
39993>>>>>        //AB-StoreStart
39993>>>>>        Procedure OnClick
39995>>>>>            Send Search To (oSelList(current_object))
39996>>>>>        End_Procedure
39997>>>>>        //AB-StoreEnd
39997>>>>>
39997>>>>>    End_Object    // oSearch_bn
39998>>>>>
39998>>>>>
39998>>>>>    //AB-StoreStart
39998>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39999>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
40000>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
40001>>>>>    //AB-StoreEnd
40001>>>>>
40001>>>>>End_Object    // sl013b
40002>>>>>
40002>>>>>//AB/ End_Object    // prj
40002>>>Use sl014.sl
INCLUDING FILE: SL014.SL
40002>>>>>//AB/ Project sl014:Particle Lookup
40002>>>>>//AB/ Object prj is a Lookup_Project
40002>>>>>//AB/     Set ProjectName to "sl014:Particle Lookup"
40002>>>>>//AB/     Set ProjectFileName to "sl014.SL"
40002>>>>>//AB/     Set GenerateFileName to "NONAME"
40002>>>>>
40002>>>>>// Project Object Structure
40002>>>>>//   sl014 is a dbModalPanelSub
40002>>>>>//     Ctypkin_DD is a DataDictionary
40002>>>>>//     Wtypkin_DD is a DataDictionary
40002>>>>>//     Ptyppar_DD is a DataDictionary
40002>>>>>//     Clients_DD is a DataDictionary
40002>>>>>//     Nomisma_DD is a DataDictionary
40002>>>>>//     Particle_DD is a DataDictionary
40002>>>>>//     oSelList is a dbListSub
40002>>>>>//     cSyDateForm1 is a cSyDateForm
40002>>>>>//     FormSub1 is a FormSub
40002>>>>>//     FormSub3 is a FormSub
40002>>>>>//     FormSub2 is a FormSub
40002>>>>>//     FormSub4 is a FormSub
40002>>>>>//     FormSub5 is a FormSub
40002>>>>>//     TextBoxSub1 is a TextBoxSub
40002>>>>>//     TextBoxSub2 is a TextBoxSub
40002>>>>>//     TextBoxSub3 is a TextBoxSub
40002>>>>>//     ButtonSub1 is a ButtonSub
40002>>>>>//     oOk_bn is a ButtonSub
40002>>>>>//     oSearch_bn is a ButtonSub
40002>>>>>//     TextBoxSub4 is a TextBoxSub
40002>>>>>
40002>>>>>// Register all objects
40002>>>>>Register_Object ButtonSub1
40002>>>>>Register_Object Clients_DD
40002>>>>>Register_Object Ctypkin_DD
40002>>>>>Register_Object cSyDateForm1
40002>>>>>Register_Object FormSub1
40002>>>>>Register_Object FormSub2
40002>>>>>Register_Object FormSub3
40002>>>>>Register_Object FormSub4
40002>>>>>Register_Object FormSub5
40002>>>>>Register_Object Nomisma_DD
40002>>>>>Register_Object oOk_bn
40002>>>>>Register_Object oSearch_bn
40002>>>>>Register_Object oSelList
40002>>>>>Register_Object Particle_DD
40002>>>>>Register_Object Ptyppar_DD
40002>>>>>Register_Object sl014
40002>>>>>Register_Object TextBoxSub1
40002>>>>>Register_Object TextBoxSub2
40002>>>>>Register_Object TextBoxSub3
40002>>>>>Register_Object TextBoxSub4
40002>>>>>Register_Object Wtypkin_DD
40002>>>>>
40002>>>>>
40002>>>>>
40002>>>>>//AB-StoreTopStart
40002>>>>>            
40002>>>>>Open PtypparL
40004>>>>>
40004>>>>>Use sl100.sl
40004>>>>>Use sl012.sl
40004>>>>>
40004>>>>>//AB-StoreTopEnd
40004>>>>>
40004>>>>>//AB-IgnoreStart
40004>>>>>
40004>>>>>Use DFAllEnt.pkg
40004>>>>>Use dbList.Sub
40004>>>>>Use cSyDateForm.Pkg
INCLUDING FILE: CSYDATEFORM.PKG
40004>>>>>>>Use cSyDateIntelliMix.pkg
INCLUDING FILE: CSYDATEINTELLIMIX.PKG
40004>>>>>>>>>Use cOutlook.Sl // Needed for date prompt.
INCLUDING FILE: COUTLOOK.SL
40004>>>>>>>>>>>//AB/ Project Calendar Outlook
40004>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
40004>>>>>>>>>>>//AB/         Set ProjectName to "Calendar Outlook"
40004>>>>>>>>>>>//AB/         Set ProjectFileName to "coutlook.sl"
40004>>>>>>>>>>>
40004>>>>>>>>>>>// Project Object Structure
40004>>>>>>>>>>>//   oCalendar is a BasicPanelSub
40004>>>>>>>>>>>//     Container3d1 is a Container3d
40004>>>>>>>>>>>//       Grid2 is a Grid
40004>>>>>>>>>>>//         cOutlookFloatingMenu is a FloatingPopupMenu
40004>>>>>>>>>>>//       Textbox2 is a Textbox
40004>>>>>>>>>>>//       Textbox3 is a Textbox
40004>>>>>>>>>>>//       Textbox4 is a Textbox
40004>>>>>>>>>>>//       Textbox5 is a Textbox
40004>>>>>>>>>>>//       Textbox6 is a Textbox
40004>>>>>>>>>>>//       Textbox7 is a Textbox
40004>>>>>>>>>>>//       Textbox8 is a Textbox
40004>>>>>>>>>>>//       LineControl1 is a LineControl
40004>>>>>>>>>>>//       Container3d2 is a Container3d
40004>>>>>>>>>>>//         oRght is a BitmapContainer
40004>>>>>>>>>>>//         oLeft is a BitmapContainer
40004>>>>>>>>>>>//         oMonth is a Textbox
40004>>>>>>>>>>>//           oSelectMonth is a FloatingPopupMenu
40004>>>>>>>>>>>//         oCalendarYear is a Textbox
40004>>>>>>>>>>>//         oSelectCalendarYear is a Form
40004>>>>>>>>>>>//     BitmapContainer3 is a BitmapContainer
40004>>>>>>>>>>>//     oToday is a Textbox
40004>>>>>>>>>>>//     oCloseCalendar_bn is a BitmapContainer
40004>>>>>>>>>>>//     Help_Container is a Container3d
40004>>>>>>>>>>>//       Help_Info is a Edit
40004>>>>>>>>>>>//         HelpFloatingMenu is a FloatingPopupMenu
40004>>>>>>>>>>>
40004>>>>>>>>>>>// Register all objects
40004>>>>>>>>>>>Register_Object BitmapContainer3
40004>>>>>>>>>>>Register_Object Container3d1
40004>>>>>>>>>>>Register_Object Container3d2
40004>>>>>>>>>>>Register_Object cOutlookFloatingMenu
40004>>>>>>>>>>>Register_Object Grid2
40004>>>>>>>>>>>Register_Object Help_Container
40004>>>>>>>>>>>Register_Object Help_Info
40004>>>>>>>>>>>Register_Object HelpFloatingMenu
40004>>>>>>>>>>>Register_Object LineControl1
40004>>>>>>>>>>>Register_Object oCalendar
40004>>>>>>>>>>>Register_Object oCalendarYear
40004>>>>>>>>>>>Register_Object oCloseCalendar_bn
40004>>>>>>>>>>>Register_Object oLeft
40004>>>>>>>>>>>Register_Object oMonth
40004>>>>>>>>>>>Register_Object oRght
40004>>>>>>>>>>>Register_Object oSelectCalendarYear
40004>>>>>>>>>>>Register_Object oSelectMonth
40004>>>>>>>>>>>Register_Object oToday
40004>>>>>>>>>>>Register_Object Textbox2
40004>>>>>>>>>>>Register_Object Textbox3
40004>>>>>>>>>>>Register_Object Textbox4
40004>>>>>>>>>>>Register_Object Textbox5
40004>>>>>>>>>>>Register_Object Textbox6
40004>>>>>>>>>>>Register_Object Textbox7
40004>>>>>>>>>>>Register_Object Textbox8
40004>>>>>>>>>>>
40004>>>>>>>>>>>
40004>>>>>>>>>>>
40004>>>>>>>>>>>    //AB-StoreTopStart
40004>>>>>>>>>>>    Use dates.utl
40004>>>>>>>>>>>
40004>>>>>>>>>>>
40004>>>>>>>>>>>    //AB-StoreTopEnd
40004>>>>>>>>>>>
40004>>>>>>>>>>>    //AB-IgnoreStart
40004>>>>>>>>>>>
40004>>>>>>>>>>>    Use Panel.Sub
40004>>>>>>>>>>>    Use DFAllEnt.pkg
40004>>>>>>>>>>>
40004>>>>>>>>>>>
40004>>>>>>>>>>>
40004>>>>>>>>>>>    //AB-IgnoreEnd
40004>>>>>>>>>>>
40004>>>>>>>>>>>    Object oCalendar is a BasicPanelSub
40006>>>>>>>>>>>        Set Border_Style to Border_Normal
40007>>>>>>>>>>>        Set Caption_Bar to FALSE
40008>>>>>>>>>>>        Set Label to "January, 2001"
40009>>>>>>>>>>>        Set Size to 98 123
40010>>>>>>>>>>>        Set Location to 10 22
40011>>>>>>>>>>>        Set Color to clWhite
40012>>>>>>>>>>>        Set Exit_Application_Local_State to TRUE
40013>>>>>>>>>>>        Set Popup_State to TRUE
40014>>>>>>>>>>>
40014>>>>>>>>>>>        //AB-DDOStart
40014>>>>>>>>>>>
40014>>>>>>>>>>>
40014>>>>>>>>>>>        //AB-DDOEnd
40014>>>>>>>>>>>
40014>>>>>>>>>>>        Object Container3d1 is a Container3d
40016>>>>>>>>>>>            Set Size to 88 135
40017>>>>>>>>>>>            Set Location to -2 -1
40018>>>>>>>>>>>            Set Color to clWhite
40019>>>>>>>>>>>            Set Border_Style to Border_None
40020>>>>>>>>>>>            Object Grid2 is a Grid
40022>>>>>>>>>>>
40022>>>>>>>>>>>                //AB-StoreTopStart
40022>>>>>>>>>>>                property date    p_current_date     0
40024>>>>>>>>>>>                property integer p_current_year     -1
40026>>>>>>>>>>>                property integer p_current_month    -1
40028>>>>>>>>>>>                property integer p_selected_day     -1
40030>>>>>>>>>>>                property integer pExportState       1
40032>>>>>>>>>>>                property integer invoking_object_id 0
40034>>>>>>>>>>>                Property integer piCurrentDayItem   -1
40036>>>>>>>>>>>
40036>>>>>>>>>>>                Set Border_Style To BORDER_NONE
40037>>>>>>>>>>>                Set header_visible_state To False
40038>>>>>>>>>>>                set select_mode to no_select
40039>>>>>>>>>>>                Set Gridline_mode To GRID_VISIBLE_NONE
40040>>>>>>>>>>>
40040>>>>>>>>>>>                on_key Key_F1 Send Help
40041>>>>>>>>>>>                on_key key_ctrl+key_pgup send prev_year
40042>>>>>>>>>>>                on_key key_ctrl+key_pgdn send next_year
40043>>>>>>>>>>>                on_key          key_pgup send prev_month
40044>>>>>>>>>>>                on_key          key_pgdn send next_month
40045>>>>>>>>>>>                on_key key_enter         send move_value_out
40046>>>>>>>>>>>                on_key key_ctrl+key_d    send go_today
40047>>>>>>>>>>>                on_key key_ctrl+key_y    send Change_Year
40048>>>>>>>>>>>
40048>>>>>>>>>>>                //AB-StoreTopEnd
40048>>>>>>>>>>>
40048>>>>>>>>>>>                Set Color to clWhite
40049>>>>>>>>>>>                Set CurrentCellColor to clWhite
40050>>>>>>>>>>>                Set CurrentCellTextColor to clWhite
40051>>>>>>>>>>>                Set Size to 61 145
40052>>>>>>>>>>>                Set Location to 30 1
40053>>>>>>>>>>>                Set Resize_Column_state to FALSE
40054>>>>>>>>>>>
40054>>>>>>>>>>>                Set Line_Width to 7 0
40055>>>>>>>>>>>
40055>>>>>>>>>>>                Set Form_Width    item 0 to 18
40056>>>>>>>>>>>                Set Header_Label  item 0 to "Mo"
40057>>>>>>>>>>>
40057>>>>>>>>>>>                Set Form_Width    item 1 to 18
40058>>>>>>>>>>>                Set Header_Label  item 1 to "Tu"
40059>>>>>>>>>>>
40059>>>>>>>>>>>                Set Form_Width    item 2 to 18
40060>>>>>>>>>>>                Set Header_Label  item 2 to "We"
40061>>>>>>>>>>>
40061>>>>>>>>>>>                Set Form_Width    item 3 to 18
40062>>>>>>>>>>>                Set Header_Label  item 3 to "Th"
40063>>>>>>>>>>>
40063>>>>>>>>>>>                Set Form_Width    item 4 to 18
40064>>>>>>>>>>>                Set Header_Label  item 4 to "Fr"
40065>>>>>>>>>>>
40065>>>>>>>>>>>                Set Form_Width    item 5 to 18
40066>>>>>>>>>>>                Set Header_Label  item 5 to "Sa"
40067>>>>>>>>>>>
40067>>>>>>>>>>>                Set Form_Width    item 6 to 18
40068>>>>>>>>>>>                Set Header_Label  item 6 to "Su"
40069>>>>>>>>>>>
40069>>>>>>>>>>>
40069>>>>>>>>>>>                //AB-StoreStart
40069>>>>>>>>>>>
40069>>>>>>>>>>>                Procedure Change_Year
40071>>>>>>>>>>>                    Send Mouse_Down to (oCalendarYear(Container3d2(Self)))
40072>>>>>>>>>>>                End_Procedure // Change_Year
40073>>>>>>>>>>>
40073>>>>>>>>>>>                procedure go_today
40075>>>>>>>>>>>                    Date date#
40076>>>>>>>>>>>                    sysdate4 date#
40077>>>>>>>>>>>                    set p_current_date to date#
40078>>>>>>>>>>>                    Send Update_Calendar
40079>>>>>>>>>>>                end_procedure
40080>>>>>>>>>>>
40080>>>>>>>>>>>                procedure next_month
40082>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
40083>>>>>>>>>>>                    Send Update_Calendar
40084>>>>>>>>>>>                end_procedure
40085>>>>>>>>>>>
40085>>>>>>>>>>>                procedure prev_month
40087>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
40088>>>>>>>>>>>                    Send Update_Calendar
40089>>>>>>>>>>>                end_procedure
40090>>>>>>>>>>>
40090>>>>>>>>>>>                procedure next_year
40092>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
40093>>>>>>>>>>>                    Send Update_Calendar
40094>>>>>>>>>>>                end_procedure
40095>>>>>>>>>>>
40095>>>>>>>>>>>                procedure prev_year
40097>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
40098>>>>>>>>>>>                    Send Update_Calendar
40099>>>>>>>>>>>                end_procedure
40100>>>>>>>>>>>
40100>>>>>>>>>>>                Procedure Activate
40102>>>>>>>>>>>                    Date date#
40103>>>>>>>>>>>                    Forward Send Activate
40105>>>>>>>>>>>                    Set current_item to (p_selected_day(Self))
40106>>>>>>>>>>>                End_Procedure
40107>>>>>>>>>>>
40107>>>>>>>>>>>                Procedure Update_Calendar
40109>>>>>>>>>>>                    Set Dynamic_Update_State To False
40110>>>>>>>>>>>                    send Fill_List
40111>>>>>>>>>>>                    Set Dynamic_Update_State To True
40112>>>>>>>>>>>                    // Send Update_Label
40112>>>>>>>>>>>                    Set current_item to (p_selected_day(Self))
40113>>>>>>>>>>>                    Send Date_Changing to (oCalendarYear(Container3d2(self)))
40114>>>>>>>>>>>                    Send Date_Changing to (oMonth(Container3d2(self)))
40115>>>>>>>>>>>                End_Procedure
40116>>>>>>>>>>>
40116>>>>>>>>>>>                Procedure Fill_List
40118>>>>>>>>>>>                    Integer iFor prevdate# date# first_item# last_item# day# prev_last# nextdate# next_first#
40119>>>>>>>>>>>                    Integer cur_year# cur_month# cur_day# sel_month# sel_day# sel_year#
40119>>>>>>>>>>>                    Date dToday
40119>>>>>>>>>>>                    Send Delete_Data
40120>>>>>>>>>>>
40120>>>>>>>>>>>                    Get p_current_date to date#
40121>>>>>>>>>>>
40121>>>>>>>>>>>                    SysDate4 dToday
40122>>>>>>>>>>>                    move (DateSegment(dToday,DS_DAY)) to cur_day#
40123>>>>>>>>>>>                    move (DateSegment(dToday,DS_MONTH)) to cur_month#
40124>>>>>>>>>>>                    move (DateSegment(dToday,DS_YEAR)) to cur_year#
40125>>>>>>>>>>>
40125>>>>>>>>>>>                    move (DateSegment(date#,DS_DAY)) to sel_day#
40126>>>>>>>>>>>                    move (DateSegment(date#,DS_MONTH)) to sel_month#
40127>>>>>>>>>>>                    move (DateSegment(date#,DS_YEAR)) to sel_year#
40128>>>>>>>>>>>                    Set p_current_month To sel_month#
40129>>>>>>>>>>>                    Set p_current_year To sel_year#
40130>>>>>>>>>>>
40130>>>>>>>>>>>                    move (FirstDayInMonth(date#)) to date#
40131>>>>>>>>>>>                    move (DateDayNumber(date#)-1) to first_item#
40132>>>>>>>>>>>                    move (LastDayInMonth(date#)-date#+first_item#) to last_item#
40133>>>>>>>>>>>                    move (DateIncrement(date#,DS_Month,-1)) To prevdate#
40134>>>>>>>>>>>                    move (DateSegment((LastDayInMonth(prevdate#)),DS_DAY)) to prev_last#
40135>>>>>>>>>>>
40135>>>>>>>>>>>                    If (first_item# > 0) Begin
40137>>>>>>>>>>>                        Move (first_item#-1) to day#
40138>>>>>>>>>>>                        For iFor from 0 to (first_item#-1)
40144>>>>>>>>>>>>
40144>>>>>>>>>>>                            Send Add_Item msg_move_value_out (prev_last#-day#)
40145>>>>>>>>>>>                            Set Entry_State Item iFor To False
40146>>>>>>>>>>>                            Set ItemTextColor Item iFor To clGray
40147>>>>>>>>>>>                            Decrement day#
40148>>>>>>>>>>>                        Loop
40149>>>>>>>>>>>>
40149>>>>>>>>>>>                    End
40149>>>>>>>>>>>>
40149>>>>>>>>>>>
40149>>>>>>>>>>>                    Move 1 To day#
40150>>>>>>>>>>>                    For iFor from first_item# to last_item#
40156>>>>>>>>>>>>
40156>>>>>>>>>>>                        Send Add_Item Msg_Move_Value_Out day#
40157>>>>>>>>>>>                        Set Entry_State Item iFor To False
40158>>>>>>>>>>>                        If ((cur_month# eq sel_month#)and(cur_year# eq sel_year#)and(Day# eq cur_day#)) Begin
40160>>>>>>>>>>>                            Set Form_Bitmap Item iFor To "cdate.bmp"
40161>>>>>>>>>>>                            Set piCurrentDayItem to iFor
40162>>>>>>>>>>>                        End
40162>>>>>>>>>>>>
40162>>>>>>>>>>>                        If Day# eq sel_day# Set p_selected_day To iFor
40165>>>>>>>>>>>                        Set Form_justification_mode Item iFor To FORM_DISPLAYRIGHT
40166>>>>>>>>>>>                        Set form_datatype item iFor To mask_numeric_window
40167>>>>>>>>>>>                        Set form_Mask item iFor To "## "
40168>>>>>>>>>>>                        Increment day#
40169>>>>>>>>>>>                    Loop
40170>>>>>>>>>>>>
40170>>>>>>>>>>>
40170>>>>>>>>>>>                    move (DateIncrement(date#,DS_Month,1)) To nextdate#
40171>>>>>>>>>>>                    move (DateSegment((LastDayInMonth(nextdate#)),DS_DAY)) to next_first#
40172>>>>>>>>>>>
40172>>>>>>>>>>>                    If (last_item# < 41) Begin
40174>>>>>>>>>>>                        Move 1 to day#
40175>>>>>>>>>>>                        For iFor from (last_item#+1) to 41
40181>>>>>>>>>>>>
40181>>>>>>>>>>>                            Send Add_Item msg_move_value_out day#
40182>>>>>>>>>>>                            Set Entry_State Item iFor To False
40183>>>>>>>>>>>                            Set ItemTextColor Item iFor To clGray
40184>>>>>>>>>>>                            Increment day#
40185>>>>>>>>>>>                        Loop
40186>>>>>>>>>>>>
40186>>>>>>>>>>>                    End
40186>>>>>>>>>>>>
40186>>>>>>>>>>>
40186>>>>>>>>>>>                End_Procedure
40187>>>>>>>>>>>
40187>>>>>>>>>>>                Procedure Help
40189>>>>>>>>>>>                    //Send Info_Box ("<Up>, <Dn>, <Lft>, <Rgt> - select date.\n<PgUp>, <PgDn> - select month.\n<Ctrl>+<D> - set current date.\n<Ctrl>+<Y> - select year.\n<Ctrl>+<PgUp>, <PgDn> - Select year.") ("Help on Calendar")
40189>>>>>>>>>>>                    Set Visible_State of Help_Container to True
40190>>>>>>>>>>>                    Set Enabled_State of Help_Container to True
40191>>>>>>>>>>>                    Send Activate to Help_Container
40192>>>>>>>>>>>                End_Procedure
40193>>>>>>>>>>>
40193>>>>>>>>>>>                procedure mouse_click integer window integer char_pos
40195>>>>>>>>>>>                    Send Move_Value_Out
40196>>>>>>>>>>>                    forward send mouse_click window char_pos
40198>>>>>>>>>>>                end_procedure
40199>>>>>>>>>>>
40199>>>>>>>>>>>                Procedure Move_Value_Out
40201>>>>>>>>>>>                    Integer iYear iMonth iDay iItm
40202>>>>>>>>>>>                    Date Date# next_date# prev_date#
40202>>>>>>>>>>>                    Get Current_Item To iItm
40203>>>>>>>>>>>                    If (pExportState(Self)) Begin
40205>>>>>>>>>>>                        Get Value Item iItm To iDay
40206>>>>>>>>>>>                        Get p_current_month to iMonth
40207>>>>>>>>>>>                        Get p_current_year  to iYear
40208>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
40209>>>>>>>>>>>
40209>>>>>>>>>>>                        If ((iItm>27)and(iDay<15)) Begin
40211>>>>>>>>>>>                            Move (DateCompose(1,iMonth,iYear)) To next_date#
40212>>>>>>>>>>>                            move (DateIncrement(next_date#,DS_Month,1)) To next_date#
40213>>>>>>>>>>>                            move (DateSegment(next_date#,DS_MONTH)) to iMonth
40214>>>>>>>>>>>                            move (DateSegment(next_date#,DS_YEAR)) to iYear
40215>>>>>>>>>>>                            move (DateCompose(iDay,iMonth,iYear)) to date#
40216>>>>>>>>>>>                        End
40216>>>>>>>>>>>>
40216>>>>>>>>>>>                        If ((iItm<7)and(iDay>20)) Begin
40218>>>>>>>>>>>                            Move (DateCompose(1,iMonth,iYear)) To prev_date#
40219>>>>>>>>>>>                            move (DateIncrement(prev_date#,DS_Month,-1)) To prev_date#
40220>>>>>>>>>>>                            move (DateSegment(prev_date#,DS_MONTH)) to iMonth
40221>>>>>>>>>>>                            move (DateSegment(prev_date#,DS_YEAR)) to iYear
40222>>>>>>>>>>>                            move (DateCompose(iDay,iMonth,iYear)) to date#
40223>>>>>>>>>>>                        End
40223>>>>>>>>>>>>
40223>>>>>>>>>>>
40223>>>>>>>>>>>                        Send Export_Date date#
40224>>>>>>>>>>>                    End
40224>>>>>>>>>>>>
40224>>>>>>>>>>>                End_Procedure
40225>>>>>>>>>>>
40225>>>>>>>>>>>                Procedure Export_Date date date#
40227>>>>>>>>>>>                    local integer focus# dm# margin# datatype#
40228>>>>>>>>>>>                    get invoking_object_id to focus#
40229>>>>>>>>>>>
40229>>>>>>>>>>>                    if focus# gt desktop begin
40231>>>>>>>>>>>                         get delegation_mode of focus# to dm#
40232>>>>>>>>>>>                         set delegation_mode of focus# to no_delegate_or_error
40233>>>>>>>>>>>                         get form_margin of focus# item current to margin#
40234>>>>>>>>>>>                         get form_datatype of focus# item current to datatype#
40235>>>>>>>>>>>                         set delegation_mode of focus# to dm#
40236>>>>>>>>>>>                         if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to date#
40239>>>>>>>>>>>                         else             set value of focus# item current to (Date4to2(date#))
40241>>>>>>>>>>>                         set item_changed_state of focus# item current to true
40242>>>>>>>>>>>                    end
40242>>>>>>>>>>>>
40242>>>>>>>>>>>                    Send Close_Calendar
40243>>>>>>>>>>>                End_Procedure
40244>>>>>>>>>>>
40244>>>>>>>>>>>                Object cOutlookFloatingMenu is a FloatingPopupMenu
40246>>>>>>>>>>>
40246>>>>>>>>>>>                    Procedure Close_Calendar
40248>>>>>>>>>>>                        Send Close_Calendar to (oCalendar(Self))
40249>>>>>>>>>>>                    End_Procedure // Close_Calendar
40250>>>>>>>>>>>
40250>>>>>>>>>>>                    Send Add_item msg_go_today         t.calendar.today
40251>>>>>>>>>>>                    Send Add_item msg_None             ""
40252>>>>>>>>>>>                    Send Add_Item msg_prev_year        t.calendar.PrevYear
40253>>>>>>>>>>>                    Send Add_Item msg_next_year        t.calendar.NextYear
40254>>>>>>>>>>>                    Send Add_Item msg_prev_month       t.calendar.PrevMonth
40255>>>>>>>>>>>                    Send Add_Item msg_next_month       t.calendar.NextMonth
40256>>>>>>>>>>>                    Send Add_item msg_None             ""
40257>>>>>>>>>>>                    Send Add_Item msg_move_value_out   t.calendar.Select
40258>>>>>>>>>>>                    Send Add_item msg_None             ""
40259>>>>>>>>>>>                    Send Add_item msg_Close_Calendar   t.calendar.Cancel
40260>>>>>>>>>>>                End_Object // cOutlookFloatingMenu
40261>>>>>>>>>>>
40261>>>>>>>>>>>                Set floating_menu_object to (cOutlookFloatingMenu(Self))
40262>>>>>>>>>>>
40262>>>>>>>>>>>                procedure item_change integer fromi integer toi returns integer
40264>>>>>>>>>>>                    Integer new_item liMonth
40265>>>>>>>>>>>                    Date    ldSysdate
40265>>>>>>>>>>>                    forward get msg_item_change fromi toi to new_item
40267>>>>>>>>>>>                    If (Focus(Desktop) = Self) Begin
40269>>>>>>>>>>>                        If (new_item >= 0) Begin
40271>>>>>>>>>>>                            Sysdate4 ldSysdate
40272>>>>>>>>>>>                            Move (TheMonthSegment(ldSysdate)) to liMonth
40273>>>>>>>>>>>                            If ((p_current_month(Self) = liMonth) and (piCurrentDayItem(Self) = fromi)) Set Form_Bitmap Item fromi to "Cdate.bmp"
40276>>>>>>>>>>>                            Else Set Form_Bitmap Item fromi to ""
40278>>>>>>>>>>>                            If (((p_current_month(Self) = liMonth) and (piCurrentDayItem(Self) <> new_item)) or;                                 (p_current_month(Self) <> liMonth)) Set Form_Bitmap Item new_item   to "Cdate1.bmp"
40281>>>>>>>>>>>                        End
40281>>>>>>>>>>>>
40281>>>>>>>>>>>                    End
40281>>>>>>>>>>>>
40281>>>>>>>>>>>                    procedure_return new_item
40282>>>>>>>>>>>                End_Procedure // Current_Item
40283>>>>>>>>>>>
40283>>>>>>>>>>>
40283>>>>>>>>>>>
40283>>>>>>>>>>>                //AB-StoreEnd
40283>>>>>>>>>>>
40283>>>>>>>>>>>            End_Object    // Grid2
40284>>>>>>>>>>>
40284>>>>>>>>>>>            Object Textbox2 is a Textbox
40286>>>>>>>>>>>                Set Label to "Mo"
40287>>>>>>>>>>>                Set Auto_Size_State to FALSE
40288>>>>>>>>>>>                Set Transparent_State to TRUE
40289>>>>>>>>>>>                Set Color to clWhite
40290>>>>>>>>>>>                Set TextColor to clNavy
40291>>>>>>>>>>>                Set Location to 19 4
40292>>>>>>>>>>>                Set Size to 10 15
40293>>>>>>>>>>>
40293>>>>>>>>>>>                //AB-StoreStart
40293>>>>>>>>>>>
40293>>>>>>>>>>>                Set Label To (left(t.calendar.Monday,2))
40294>>>>>>>>>>>                //AB-StoreEnd
40294>>>>>>>>>>>
40294>>>>>>>>>>>            End_Object    // Textbox2
40295>>>>>>>>>>>
40295>>>>>>>>>>>            Object Textbox3 is a Textbox
40297>>>>>>>>>>>                Set Label to "Tu"
40298>>>>>>>>>>>                Set Auto_Size_State to FALSE
40299>>>>>>>>>>>                Set Transparent_State to TRUE
40300>>>>>>>>>>>                Set Color to clWhite
40301>>>>>>>>>>>                Set TextColor to clNavy
40302>>>>>>>>>>>                Set Location to 19 22
40303>>>>>>>>>>>                Set Size to 10 12
40304>>>>>>>>>>>
40304>>>>>>>>>>>                //AB-StoreStart
40304>>>>>>>>>>>
40304>>>>>>>>>>>                Set Label To (left(t.calendar.Tuesday,2))
40305>>>>>>>>>>>                //AB-StoreEnd
40305>>>>>>>>>>>
40305>>>>>>>>>>>            End_Object    // Textbox3
40306>>>>>>>>>>>
40306>>>>>>>>>>>            Object Textbox4 is a Textbox
40308>>>>>>>>>>>                Set Label to "We"
40309>>>>>>>>>>>                Set Auto_Size_State to FALSE
40310>>>>>>>>>>>                Set Transparent_State to TRUE
40311>>>>>>>>>>>                Set Color to clWhite
40312>>>>>>>>>>>                Set TextColor to clNavy
40313>>>>>>>>>>>                Set Location to 19 39
40314>>>>>>>>>>>                Set Size to 10 15
40315>>>>>>>>>>>
40315>>>>>>>>>>>                //AB-StoreStart
40315>>>>>>>>>>>
40315>>>>>>>>>>>                Set Label To (left(t.calendar.Wednesday,2))
40316>>>>>>>>>>>                //AB-StoreEnd
40316>>>>>>>>>>>
40316>>>>>>>>>>>            End_Object    // Textbox4
40317>>>>>>>>>>>
40317>>>>>>>>>>>            Object Textbox5 is a Textbox
40319>>>>>>>>>>>                Set Label to "Th"
40320>>>>>>>>>>>                Set Auto_Size_State to FALSE
40321>>>>>>>>>>>                Set Transparent_State to TRUE
40322>>>>>>>>>>>                Set Color to clWhite
40323>>>>>>>>>>>                Set TextColor to clNavy
40324>>>>>>>>>>>                Set Location to 19 57
40325>>>>>>>>>>>                Set Size to 10 17
40326>>>>>>>>>>>
40326>>>>>>>>>>>                //AB-StoreStart
40326>>>>>>>>>>>
40326>>>>>>>>>>>                Set Label To (left(t.calendar.Thursday,2))
40327>>>>>>>>>>>                //AB-StoreEnd
40327>>>>>>>>>>>
40327>>>>>>>>>>>            End_Object    // Textbox5
40328>>>>>>>>>>>
40328>>>>>>>>>>>            Object Textbox6 is a Textbox
40330>>>>>>>>>>>                Set Label to "Fr"
40331>>>>>>>>>>>                Set Auto_Size_State to FALSE
40332>>>>>>>>>>>                Set Transparent_State to TRUE
40333>>>>>>>>>>>                Set Color to clWhite
40334>>>>>>>>>>>                Set TextColor to clNavy
40335>>>>>>>>>>>                Set Location to 19 76
40336>>>>>>>>>>>                Set Size to 10 17
40337>>>>>>>>>>>
40337>>>>>>>>>>>                //AB-StoreStart
40337>>>>>>>>>>>
40337>>>>>>>>>>>                Set Label To (left(t.calendar.Friday,2))
40338>>>>>>>>>>>                //AB-StoreEnd
40338>>>>>>>>>>>
40338>>>>>>>>>>>            End_Object    // Textbox6
40339>>>>>>>>>>>
40339>>>>>>>>>>>            Object Textbox7 is a Textbox
40341>>>>>>>>>>>                Set Label to "Sa"
40342>>>>>>>>>>>                Set Auto_Size_State to FALSE
40343>>>>>>>>>>>                Set Transparent_State to TRUE
40344>>>>>>>>>>>                Set Color to clWhite
40345>>>>>>>>>>>                Set TextColor to clNavy
40346>>>>>>>>>>>                Set Location to 19 91
40347>>>>>>>>>>>                Set Size to 10 18
40348>>>>>>>>>>>
40348>>>>>>>>>>>                //AB-StoreStart
40348>>>>>>>>>>>
40348>>>>>>>>>>>                Set Label To (left(t.calendar.Saturday,2))
40349>>>>>>>>>>>                //AB-StoreEnd
40349>>>>>>>>>>>
40349>>>>>>>>>>>            End_Object    // Textbox7
40350>>>>>>>>>>>
40350>>>>>>>>>>>            Object Textbox8 is a Textbox
40352>>>>>>>>>>>                Set Label to "Su"
40353>>>>>>>>>>>                Set Auto_Size_State to FALSE
40354>>>>>>>>>>>                Set Transparent_State to TRUE
40355>>>>>>>>>>>                Set Color to clWhite
40356>>>>>>>>>>>                Set TextColor to clNavy
40357>>>>>>>>>>>                Set Location to 19 109
40358>>>>>>>>>>>                Set Size to 10 17
40359>>>>>>>>>>>
40359>>>>>>>>>>>                //AB-StoreStart
40359>>>>>>>>>>>
40359>>>>>>>>>>>                Set Label To (left(t.calendar.Sunday,2))
40360>>>>>>>>>>>                //AB-StoreEnd
40360>>>>>>>>>>>
40360>>>>>>>>>>>            End_Object    // Textbox8
40361>>>>>>>>>>>
40361>>>>>>>>>>>            Object LineControl1 is a LineControl
40363>>>>>>>>>>>                Set Line_Style to lnSINGLE
40364>>>>>>>>>>>                Set Size to 1 116
40365>>>>>>>>>>>                Set Location to 28 4
40366>>>>>>>>>>>
40366>>>>>>>>>>>                //AB-StoreStart
40366>>>>>>>>>>>
40366>>>>>>>>>>>                //AB-StoreEnd
40366>>>>>>>>>>>
40366>>>>>>>>>>>            End_Object    // LineControl1
40367>>>>>>>>>>>
40367>>>>>>>>>>>            Object Container3d2 is a Container3d
40369>>>>>>>>>>>                Set Size to 18 131
40370>>>>>>>>>>>                Set Location to 1 1
40371>>>>>>>>>>>                Set Color to clNavy
40372>>>>>>>>>>>                Set Border_Style to Border_None
40373>>>>>>>>>>>                Object oRght is a BitmapContainer
40375>>>>>>>>>>>                    Set Size to 10 14
40376>>>>>>>>>>>                    Set Location to 4 105
40377>>>>>>>>>>>                    Set Bitmap to "rght.bmp"
40378>>>>>>>>>>>                    Set Border_Style to Border_None
40379>>>>>>>>>>>
40379>>>>>>>>>>>                    //AB-StoreStart
40379>>>>>>>>>>>                    Procedure Mouse_Down
40381>>>>>>>>>>>                        Send Next_Month to Grid2
40382>>>>>>>>>>>                    End_Procedure
40383>>>>>>>>>>>                    //AB-StoreEnd
40383>>>>>>>>>>>
40383>>>>>>>>>>>                End_Object    // oRght
40384>>>>>>>>>>>
40384>>>>>>>>>>>                Object oLeft is a BitmapContainer
40386>>>>>>>>>>>                    Set Size to 10 14
40387>>>>>>>>>>>                    Set Location to 4 3
40388>>>>>>>>>>>                    Set Bitmap to "lft.bmp"
40389>>>>>>>>>>>                    Set Border_Style to Border_None
40390>>>>>>>>>>>
40390>>>>>>>>>>>                    //AB-StoreStart
40390>>>>>>>>>>>                    Procedure Mouse_Down
40392>>>>>>>>>>>                        Send Prev_Month to Grid2
40393>>>>>>>>>>>                    End_Procedure
40394>>>>>>>>>>>                    //AB-StoreEnd
40394>>>>>>>>>>>
40394>>>>>>>>>>>                End_Object    // oLeft
40395>>>>>>>>>>>
40395>>>>>>>>>>>                Object oMonth is a Textbox
40397>>>>>>>>>>>
40397>>>>>>>>>>>                    //AB-StoreTopStart
40397>>>>>>>>>>>                    Property integer piSelected_Month public 0
40399>>>>>>>>>>>                    //AB-StoreTopEnd
40399>>>>>>>>>>>
40399>>>>>>>>>>>                    Set Label to "January"
40400>>>>>>>>>>>                    Set Auto_Size_State to FALSE
40401>>>>>>>>>>>                    Set Transparent_State to TRUE
40402>>>>>>>>>>>                    Set Color to clWhite
40403>>>>>>>>>>>                    Set TextColor to clWhite
40404>>>>>>>>>>>                    Set Location to 4 19
40405>>>>>>>>>>>                    Set Size to 10 46
40406>>>>>>>>>>>                    Set FontWeight to 800
40407>>>>>>>>>>>                    Set Justification_Mode to jMode_Center
40408>>>>>>>>>>>
40408>>>>>>>>>>>                    //AB-StoreStart
40408>>>>>>>>>>>
40408>>>>>>>>>>>                    Procedure Mouse_Down
40410>>>>>>>>>>>                        Integer iState
40411>>>>>>>>>>>                        Get Visible_State of oSelectCalendarYear to iState
40412>>>>>>>>>>>                        If (iState) Send OnKillFocus to oSelectCalendarYear
40415>>>>>>>>>>>                        Send Popup to oSelectMonth
40416>>>>>>>>>>>                    End_Procedure
40417>>>>>>>>>>>
40417>>>>>>>>>>>                    Procedure pSelectJan
40419>>>>>>>>>>>                        Set Label to t.calendar.january
40420>>>>>>>>>>>                        Set piSelected_Month to 1
40421>>>>>>>>>>>                        Send Adjust_Calendar
40422>>>>>>>>>>>                    End_Procedure
40423>>>>>>>>>>>                    Procedure pSelectFeb
40425>>>>>>>>>>>                        Set Label to t.calendar.february
40426>>>>>>>>>>>                        Set piSelected_Month to 2
40427>>>>>>>>>>>                        Send Adjust_Calendar
40428>>>>>>>>>>>                    End_Procedure
40429>>>>>>>>>>>                    Procedure pSelectMar
40431>>>>>>>>>>>                        Set Label to t.calendar.march
40432>>>>>>>>>>>                        Set piSelected_Month to 3
40433>>>>>>>>>>>                        Send Adjust_Calendar
40434>>>>>>>>>>>                    End_Procedure
40435>>>>>>>>>>>                    Procedure pSelectApr
40437>>>>>>>>>>>                        Set Label to t.calendar.april
40438>>>>>>>>>>>                        Set piSelected_Month to 4
40439>>>>>>>>>>>                        Send Adjust_Calendar
40440>>>>>>>>>>>                    End_Procedure
40441>>>>>>>>>>>                    Procedure pSelectMay
40443>>>>>>>>>>>                        Set Label to t.calendar.may
40444>>>>>>>>>>>                        Set piSelected_Month to 5
40445>>>>>>>>>>>                        Send Adjust_Calendar
40446>>>>>>>>>>>                    End_Procedure
40447>>>>>>>>>>>                    Procedure pSelectJun
40449>>>>>>>>>>>                        Set Label to t.calendar.june
40450>>>>>>>>>>>                        Set piSelected_Month to 6
40451>>>>>>>>>>>                        Send Adjust_Calendar
40452>>>>>>>>>>>                    End_Procedure
40453>>>>>>>>>>>                    Procedure pSelectJul
40455>>>>>>>>>>>                        Set Label to t.calendar.july
40456>>>>>>>>>>>                        Set piSelected_Month to 7
40457>>>>>>>>>>>                        Send Adjust_Calendar
40458>>>>>>>>>>>                    End_Procedure
40459>>>>>>>>>>>                    Procedure pSelectAug
40461>>>>>>>>>>>                        Set Label to t.calendar.august
40462>>>>>>>>>>>                        Set piSelected_Month to 8
40463>>>>>>>>>>>                        Send Adjust_Calendar
40464>>>>>>>>>>>                    End_Procedure
40465>>>>>>>>>>>                    Procedure pSelectSep
40467>>>>>>>>>>>                        Set Label to t.calendar.september
40468>>>>>>>>>>>                        Set piSelected_Month to 9
40469>>>>>>>>>>>                        Send Adjust_Calendar
40470>>>>>>>>>>>                    End_Procedure
40471>>>>>>>>>>>                    Procedure pSelectOct
40473>>>>>>>>>>>                        Set Label to t.calendar.october
40474>>>>>>>>>>>                        Set piSelected_Month to 10
40475>>>>>>>>>>>                        Send Adjust_Calendar
40476>>>>>>>>>>>                    End_Procedure
40477>>>>>>>>>>>                    Procedure pSelectNov
40479>>>>>>>>>>>                        Set Label to t.calendar.november
40480>>>>>>>>>>>                        Set piSelected_Month to 11
40481>>>>>>>>>>>                        Send Adjust_Calendar
40482>>>>>>>>>>>                    End_Procedure
40483>>>>>>>>>>>                    Procedure pSelectDec
40485>>>>>>>>>>>                        Set Label to t.calendar.december
40486>>>>>>>>>>>                        Set piSelected_Month to 12
40487>>>>>>>>>>>                        Send Adjust_Calendar
40488>>>>>>>>>>>                    End_Procedure
40489>>>>>>>>>>>
40489>>>>>>>>>>>                    Object oSelectMonth is a FloatingPopupMenu
40491>>>>>>>>>>>                        Send Add_Item msg_pSelectJan t.calendar.january
40492>>>>>>>>>>>                        Send Add_Item msg_pSelectFeb t.calendar.february
40493>>>>>>>>>>>                        Send Add_Item msg_pSelectMar t.calendar.march
40494>>>>>>>>>>>                        Send Add_Item msg_pSelectApr t.calendar.april
40495>>>>>>>>>>>                        Send Add_Item msg_pSelectMay t.calendar.may
40496>>>>>>>>>>>                        Send Add_Item msg_pSelectJun t.calendar.june
40497>>>>>>>>>>>                        Send Add_Item msg_pSelectJul t.calendar.july
40498>>>>>>>>>>>                        Send Add_Item msg_pSelectAug t.calendar.august
40499>>>>>>>>>>>                        Send Add_Item msg_pSelectSep t.calendar.september
40500>>>>>>>>>>>                        Send Add_Item msg_pSelectOct t.calendar.october
40501>>>>>>>>>>>                        Send Add_Item msg_pSelectNov t.calendar.november
40502>>>>>>>>>>>                        Send Add_Item msg_pSelectDec t.calendar.december
40503>>>>>>>>>>>                    End_Object
40504>>>>>>>>>>>
40504>>>>>>>>>>>                    Procedure Adjust_Calendar
40506>>>>>>>>>>>                        Date date#
40507>>>>>>>>>>>                        Integer iDay iMonth iYear iItm
40507>>>>>>>>>>>                        Set Visible_State to false
40508>>>>>>>>>>>                        Set Visible_State to true
40509>>>>>>>>>>>                        Get Current_Item of (Grid2(Container3D1(Self))) to iItm
40510>>>>>>>>>>>                        Get value of (Grid2(Container3D1(Self))) item iItm to iDay
40511>>>>>>>>>>>                        Get piSelected_Month to iMonth
40512>>>>>>>>>>>                        Get Label of oCalendarYear to iYear
40513>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
40514>>>>>>>>>>>                        Set p_current_date of (Grid2(Container3D1(Self))) to date#
40515>>>>>>>>>>>                        Send Update_Calendar to (Grid2(Container3D1(Self)))
40516>>>>>>>>>>>                    End_Procedure
40517>>>>>>>>>>>
40517>>>>>>>>>>>                    Procedure Activating
40519>>>>>>>>>>>                        Forward Send Activating
40521>>>>>>>>>>>                        Send Date_Changing
40522>>>>>>>>>>>                    End_Procedure
40523>>>>>>>>>>>
40523>>>>>>>>>>>                    Procedure Date_Changing
40525>>>>>>>>>>>                        Set Visible_State to false
40526>>>>>>>>>>>                        Set Label to (MonthName(p_current_Month(Grid2(Container3D1(Self)))))
40527>>>>>>>>>>>                        Set piSelected_Month to (p_current_Month(Grid2(Container3D1(Self))))
40528>>>>>>>>>>>                        Set Visible_State to true
40529>>>>>>>>>>>                    End_Procedure
40530>>>>>>>>>>>
40530>>>>>>>>>>>
40530>>>>>>>>>>>
40530>>>>>>>>>>>                    //AB-StoreEnd
40530>>>>>>>>>>>
40530>>>>>>>>>>>                End_Object    // oMonth
40531>>>>>>>>>>>
40531>>>>>>>>>>>                Object oCalendarYear is a Textbox
40533>>>>>>>>>>>                    Set Label to "2001"
40534>>>>>>>>>>>                    Set Transparent_State to TRUE
40535>>>>>>>>>>>                    Set Color to clWhite
40536>>>>>>>>>>>                    Set TextColor to clWhite
40537>>>>>>>>>>>                    Set Location to 4 77
40538>>>>>>>>>>>                    Set Size to 10 18
40539>>>>>>>>>>>                    Set FontWeight to 800
40540>>>>>>>>>>>
40540>>>>>>>>>>>                    //AB-StoreStart
40540>>>>>>>>>>>
40540>>>>>>>>>>>                    Procedure Mouse_Down
40542>>>>>>>>>>>                        String sVal
40543>>>>>>>>>>>                        Get Label to sVal
40544>>>>>>>>>>>                        Set Value of oSelectCalendarYear item 0 to sVal
40545>>>>>>>>>>>                        Set Visible_State of oSelectCalendarYear to True
40546>>>>>>>>>>>                        Send Activate to (oSelectCalendarYear(Self))
40547>>>>>>>>>>>                    End_Procedure
40548>>>>>>>>>>>
40548>>>>>>>>>>>                    Procedure Activating
40550>>>>>>>>>>>                        Forward Send Activating
40552>>>>>>>>>>>                        Send Date_Changing
40553>>>>>>>>>>>                    End_Procedure
40554>>>>>>>>>>>
40554>>>>>>>>>>>                    Procedure Date_Changing
40556>>>>>>>>>>>                        Set Visible_State to false
40557>>>>>>>>>>>                        Set Label to (String(p_current_Year(Grid2(Container3D1(Self)))))
40558>>>>>>>>>>>                        Set Visible_State to true
40559>>>>>>>>>>>                    End_Procedure
40560>>>>>>>>>>>
40560>>>>>>>>>>>                    //AB-StoreEnd
40560>>>>>>>>>>>
40560>>>>>>>>>>>                End_Object    // oCalendarYear
40561>>>>>>>>>>>
40561>>>>>>>>>>>                Object oSelectCalendarYear is a Form
40563>>>>>>>>>>>
40563>>>>>>>>>>>                    //AB-StoreTopStart
40563>>>>>>>>>>>                    Set Visible_State To False
40564>>>>>>>>>>>                    //AB-StoreTopEnd
40564>>>>>>>>>>>
40564>>>>>>>>>>>                    Set Size to 10 24
40565>>>>>>>>>>>                    Set Location to 4 75
40566>>>>>>>>>>>                    Set Color to clWhite
40567>>>>>>>>>>>                    Set TextColor to clNavy
40568>>>>>>>>>>>                    Set Form_Border Item 0 to Border_Normal
40569>>>>>>>>>>>
40569>>>>>>>>>>>                    //AB-StoreStart
40569>>>>>>>>>>>
40569>>>>>>>>>>>                    On_Key Key_Enter Send OnKillFocus
40570>>>>>>>>>>>                    On_Key Key_Escape Send OnKillFocus
40571>>>>>>>>>>>
40571>>>>>>>>>>>                    Procedure SetFontWeight
40573>>>>>>>>>>>                        Set Form_FontWeight item 0 to 800
40574>>>>>>>>>>>                    End_Procedure
40575>>>>>>>>>>>
40575>>>>>>>>>>>                    Procedure OnKillFocus
40577>>>>>>>>>>>                        String sVal
40578>>>>>>>>>>>                        Integer iMonth iDay iYear iItm
40578>>>>>>>>>>>                        Date date#
40578>>>>>>>>>>>                        Get Value item 0 to sVal
40579>>>>>>>>>>>                        Set Visible_State of oCalendarYear to false
40580>>>>>>>>>>>                        Set Label of oCalendarYear to sVal
40581>>>>>>>>>>>                        Set Visible_State of oCalendarYear to true
40582>>>>>>>>>>>                        Set Visible_State to false
40583>>>>>>>>>>>                        Get Current_Item of (Grid2(Container3D1(Self))) to iItm
40584>>>>>>>>>>>                        Get value of (Grid2(Container3D1(Self))) item iItm to iDay
40585>>>>>>>>>>>                        Get piSelected_Month of oMonth to iMonth
40586>>>>>>>>>>>                        Get Value item 0 to iYear
40587>>>>>>>>>>>                        If (iYear = 0) Move 2000 to iYear
40590>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
40591>>>>>>>>>>>                        Set p_current_date of (Grid2(Container3D1(Self))) to date#
40592>>>>>>>>>>>                        Send Update_Calendar to (Grid2(Container3D1(Self)))
40593>>>>>>>>>>>                        Send Activate        to (Grid2(Container3D1(Self)))
40594>>>>>>>>>>>                    End_Procedure
40595>>>>>>>>>>>
40595>>>>>>>>>>>                    Send SetFontWeight
40596>>>>>>>>>>>
40596>>>>>>>>>>>
40596>>>>>>>>>>>
40596>>>>>>>>>>>                    //AB-StoreEnd
40596>>>>>>>>>>>
40596>>>>>>>>>>>                End_Object    // oSelectCalendarYear
40597>>>>>>>>>>>
40597>>>>>>>>>>>
40597>>>>>>>>>>>                //AB-StoreStart
40597>>>>>>>>>>>
40597>>>>>>>>>>>                Procedure Mouse_Down
40599>>>>>>>>>>>                    Integer iState
40600>>>>>>>>>>>                    Get Visible_State of oSelectCalendarYear to iState
40601>>>>>>>>>>>                    If (iState) Send OnKillFocus to oSelectCalendarYear
40604>>>>>>>>>>>                End_Procedure
40605>>>>>>>>>>>
40605>>>>>>>>>>>
40605>>>>>>>>>>>                //AB-StoreEnd
40605>>>>>>>>>>>
40605>>>>>>>>>>>            End_Object    // Container3d2
40606>>>>>>>>>>>
40606>>>>>>>>>>>
40606>>>>>>>>>>>            //AB-StoreStart
40606>>>>>>>>>>>
40606>>>>>>>>>>>
40606>>>>>>>>>>>            //AB-StoreEnd
40606>>>>>>>>>>>
40606>>>>>>>>>>>        End_Object    // Container3d1
40607>>>>>>>>>>>
40607>>>>>>>>>>>        Object BitmapContainer3 is a BitmapContainer
40609>>>>>>>>>>>            Set Size to 9 19
40610>>>>>>>>>>>            Set Location to 88 3
40611>>>>>>>>>>>            Set Color to clWhite
40612>>>>>>>>>>>            Set Bitmap to "cdate.bmp"
40613>>>>>>>>>>>            Set Border_Style to Border_None
40614>>>>>>>>>>>
40614>>>>>>>>>>>            //AB-StoreStart
40614>>>>>>>>>>>            Procedure Mouse_Down
40616>>>>>>>>>>>                Send go_today to (Grid2(Container3d1(Self)))
40617>>>>>>>>>>>                Send Adjust_Label to oToday
40618>>>>>>>>>>>            End_Procedure
40619>>>>>>>>>>>            //AB-StoreEnd
40619>>>>>>>>>>>
40619>>>>>>>>>>>        End_Object    // BitmapContainer3
40620>>>>>>>>>>>
40620>>>>>>>>>>>        Object oToday is a Textbox
40622>>>>>>>>>>>            Set Label to "Today: 01.01.2001"
40623>>>>>>>>>>>            Set Auto_Size_State to FALSE
40624>>>>>>>>>>>            Set Color to clWhite
40625>>>>>>>>>>>            Set Location to 88 22
40626>>>>>>>>>>>            Set Size to 8 70
40627>>>>>>>>>>>            Set FontWeight to 800
40628>>>>>>>>>>>
40628>>>>>>>>>>>            //AB-StoreStart
40628>>>>>>>>>>>            Procedure Mouse_Down
40630>>>>>>>>>>>                Send go_today to (Grid2(Container3d1(Self)))
40631>>>>>>>>>>>                Send Adjust_Label
40632>>>>>>>>>>>            End_Procedure
40633>>>>>>>>>>>
40633>>>>>>>>>>>            Procedure Adjust_Label
40635>>>>>>>>>>>                date date#
40636>>>>>>>>>>>                SysDate4 date#
40637>>>>>>>>>>>                Set Visible_State To false
40638>>>>>>>>>>>                Set Label         to (t.calendar.today+": "+String(date#))
40639>>>>>>>>>>>                Set Visible_State To true
40640>>>>>>>>>>>            End_Procedure
40641>>>>>>>>>>>
40641>>>>>>>>>>>            Procedure Activating
40643>>>>>>>>>>>                Forward Send Activating
40645>>>>>>>>>>>                Send Adjust_Label
40646>>>>>>>>>>>            End_Procedure
40647>>>>>>>>>>>            //AB-StoreEnd
40647>>>>>>>>>>>
40647>>>>>>>>>>>        End_Object    // oToday
40648>>>>>>>>>>>
40648>>>>>>>>>>>        Object oCloseCalendar_bn is a BitmapContainer
40650>>>>>>>>>>>            Set Size to 9 10
40651>>>>>>>>>>>            Set Location to 88 112
40652>>>>>>>>>>>            Set Bitmap to "Cdate1.bmp"
40653>>>>>>>>>>>            Set Bitmap_Style to Bitmap_Center
40654>>>>>>>>>>>
40654>>>>>>>>>>>            //AB-StoreStart
40654>>>>>>>>>>>
40654>>>>>>>>>>>            Procedure Mouse_Up
40656>>>>>>>>>>>                Send Close_Calendar
40657>>>>>>>>>>>            End_Procedure // Mouse_Up
40658>>>>>>>>>>>
40658>>>>>>>>>>>
40658>>>>>>>>>>>
40658>>>>>>>>>>>
40658>>>>>>>>>>>            //AB-StoreEnd
40658>>>>>>>>>>>
40658>>>>>>>>>>>        End_Object    // oCloseCalendar_bn
40659>>>>>>>>>>>
40659>>>>>>>>>>>
40659>>>>>>>>>>>        //AB-StoreStart
40659>>>>>>>>>>>
40659>>>>>>>>>>>        Set Block_Mouse_State to True
40660>>>>>>>>>>>        Set Popup_State to True
40661>>>>>>>>>>>        Set Locate_Mode to Popup_Locate
40662>>>>>>>>>>>
40662>>>>>>>>>>>        procedure popup
40664>>>>>>>>>>>            local integer focus# icItm iYear iMonth
40665>>>>>>>>>>>            local date date#
40665>>>>>>>>>>>            move (focus(desktop)) to focus#
40666>>>>>>>>>>>            set invoking_object_id of (Grid2(Container3d1(self))) to focus#
40667>>>>>>>>>>>            get value of focus# item current to date#
40668>>>>>>>>>>>            ifnot (integer(date#)) sysdate date#
40671>>>>>>>>>>>            move (Date2to4(date#)) to date#
40672>>>>>>>>>>>            set p_current_date of (Grid2(Container3d1(self))) to date#
40673>>>>>>>>>>>            send fill_list to (Grid2(Container3d1(self)))
40674>>>>>>>>>>>            move (DateSegment(date#,DS_YEAR)) to iYear
40675>>>>>>>>>>>            move (DateSegment(date#,DS_MONTH)) to iMonth
40676>>>>>>>>>>>            Set Label To (MonthName(iMonth)+', '+String(iYear))
40677>>>>>>>>>>>            forward send popup
40679>>>>>>>>>>>        end_procedure
40680>>>>>>>>>>>
40680>>>>>>>>>>>        Procedure Close_Calendar
40682>>>>>>>>>>>            Send Close_Panel
40683>>>>>>>>>>>        End_Procedure // Close_Calendar
40684>>>>>>>>>>>
40684>>>>>>>>>>>        Object Help_Container is a Container3d
40686>>>>>>>>>>>            Set Location to 0 0
40687>>>>>>>>>>>            Set Size     to 98 122
40688>>>>>>>>>>>            Set Visible_State to False
40689>>>>>>>>>>>            Set Enabled_State to False
40690>>>>>>>>>>>            Set Border_Style to Border_None
40691>>>>>>>>>>>            Set TextColor to clNavy
40692>>>>>>>>>>>
40692>>>>>>>>>>>            Object Help_Info is an Edit
40694>>>>>>>>>>>                Set Location to 0 0
40695>>>>>>>>>>>                Set Size     to 98 122
40696>>>>>>>>>>>                Set read_only_state to true
40697>>>>>>>>>>>                Set Border_Style to Border_None
40698>>>>>>>>>>>                Set scroll_bar_visible_state to False
40699>>>>>>>>>>>                Set FontWeight to 800
40700>>>>>>>>>>>
40700>>>>>>>>>>>                Procedure ReadHelpComments
40702>>>>>>>>>>>                    String lsFile
40703>>>>>>>>>>>
40703>>>>>>>>>>>                    Get_File_Path "Calendar.txt" to lsFile
40704>>>>>>>>>>>                    If (lsFile <> "") Send read lsFile
40707>>>>>>>>>>>                End_Procedure // ReadHelpComments
40708>>>>>>>>>>>
40708>>>>>>>>>>>                Procedure SetComments
40710>>>>>>>>>>>                    Send append_text "Help on Calendar"
40711>>>>>>>>>>>                    Send Insert ""
40712>>>>>>>>>>>                    Send Insert ""
40713>>>>>>>>>>>                    Send append_text "1.<Up>,<Dn>,<Lft>,<Rgt>"
40714>>>>>>>>>>>                    Send Insert ""
40715>>>>>>>>>>>                    Send append_text "  - select date."
40716>>>>>>>>>>>                    Send Insert ""
40717>>>>>>>>>>>                    Send append_text "2.<PgUp>,<PgDn>"
40718>>>>>>>>>>>                    Send Insert ""
40719>>>>>>>>>>>                    Send append_text "  - select month."
40720>>>>>>>>>>>                    Send Insert ""
40721>>>>>>>>>>>                    Send append_text "3.<Ctrl>+<D>"
40722>>>>>>>>>>>                    Send Insert ""
40723>>>>>>>>>>>                    Send append_text "  - set current date."
40724>>>>>>>>>>>                    Send Insert ""
40725>>>>>>>>>>>                    Send append_text "4.<Ctrl>+<Y>"
40726>>>>>>>>>>>                    Send Insert ""
40727>>>>>>>>>>>                    Send append_text "  - Change year."
40728>>>>>>>>>>>                    Send Insert ""
40729>>>>>>>>>>>                    Send append_text "5.<Ctrl>+<PgUp>,<PgDn>"
40730>>>>>>>>>>>                    Send Insert ""
40731>>>>>>>>>>>                    Send append_text "  - Select year."
40732>>>>>>>>>>>                End_procedure // SetComments
40733>>>>>>>>>>>
40733>>>>>>>>>>>                //Send SetComments
40733>>>>>>>>>>>                Set Color     to clWhite
40734>>>>>>>>>>>                Set TextColor to clNavy
40735>>>>>>>>>>>
40735>>>>>>>>>>>                Procedure OnSetFocus
40737>>>>>>>>>>>                    Send ReadHelpComments
40738>>>>>>>>>>>                End_Procedure
40739>>>>>>>>>>>
40739>>>>>>>>>>>                Object HelpFloatingMenu is a FloatingPopupMenu
40741>>>>>>>>>>>
40741>>>>>>>>>>>                    Procedure Close_Help
40743>>>>>>>>>>>                        Send Close_Help to Help_Container
40744>>>>>>>>>>>                    End_Procedure // Close_Calendar
40745>>>>>>>>>>>
40745>>>>>>>>>>>                    Send Add_item msg_Close_Help   t.calendar.Ok
40746>>>>>>>>>>>                End_Object // cOutlookFloatingMenu
40747>>>>>>>>>>>
40747>>>>>>>>>>>                Procedure Mouse_Up2 Integer aiWindow Integer aiChar_Pos
40749>>>>>>>>>>>                    Send Popup to HelpFloatingMenu
40750>>>>>>>>>>>                End_Procedure // Mouse_Up2
40751>>>>>>>>>>>
40751>>>>>>>>>>>            End_Object
40752>>>>>>>>>>>
40752>>>>>>>>>>>            Procedure Close_Help
40754>>>>>>>>>>>                Send Delete_Data to Help_Info
40755>>>>>>>>>>>                Set Visible_State to False
40756>>>>>>>>>>>                Set Enabled_State to False
40757>>>>>>>>>>>                Send Activate to (Grid2(Container3D1(Self)))
40758>>>>>>>>>>>            End_Procedure // Close_Help
40759>>>>>>>>>>>
40759>>>>>>>>>>>            On_Key kCancel Send Close_Help
40760>>>>>>>>>>>            On_Key Key_F1  Send Close_Help
40761>>>>>>>>>>>            On_Key kEnter  Send Close_Help
40762>>>>>>>>>>>        End_Object // Help_Info
40763>>>>>>>>>>>
40763>>>>>>>>>>>        on_key kcancel           send Close_Calendar
40764>>>>>>>>>>>
40764>>>>>>>>>>>
40764>>>>>>>>>>>
40764>>>>>>>>>>>
40764>>>>>>>>>>>
40764>>>>>>>>>>>
40764>>>>>>>>>>>        //AB-StoreEnd
40764>>>>>>>>>>>
40764>>>>>>>>>>>    End_Object    // oCalendar
40765>>>>>>>>>>>
40765>>>>>>>>>>>
40765>>>>>>>>>>>    //AB-StoreStart
40765>>>>>>>>>>>
40765>>>>>>>>>>>    Procedure Request_Popup_cOutlookCalendar for BaseClass
40766>>>>>>>>>>>        Integer focus# type# dm#
40767>>>>>>>>>>>
40767>>>>>>>>>>>        move (focus(desktop)) to focus#
40768>>>>>>>>>>>        if focus# gt desktop begin
40770>>>>>>>>>>>          get delegation_mode of focus# to dm#
40771>>>>>>>>>>>          set delegation_mode of focus# to no_delegate_or_error
40772>>>>>>>>>>>          get form_datatype of focus# item current to type#
40773>>>>>>>>>>>          if (type#=date_window or type#=mask_date_window) send popup to oCalendar
40776>>>>>>>>>>>          set delegation_mode of focus# to dm#
40777>>>>>>>>>>>        end
40777>>>>>>>>>>>>
40777>>>>>>>>>>>    End_Procedure
40778>>>>>>>>>>>
40778>>>>>>>>>>>    On_Key Key_Ctrl+Key_F1 Send Request_Popup_cOutlookCalendar
40779>>>>>>>>>>>    On_Key Key_Ctrl+Key_H  Send Request_Popup_cOutlookCalendar
40780>>>>>>>>>>>
40780>>>>>>>>>>>
40780>>>>>>>>>>>    //AB-StoreEnd
40780>>>>>>>>>>>
40780>>>>>>>>>>>//AB/     End_Object    // prj
40780>>>>>>>>>Use Dates.Utl
40780>>>>>>>>>
40780>>>>>>>>>   Define cStatusHelp       for "F4 = Calendar. T = Today, B = Begin of month, E = End of month."
40780>>>>>>>>>   Define cDateToday        for "T"
40780>>>>>>>>>   Define cDateBeginOfMonth for "B"
40780>>>>>>>>>   Define cDateEndOfMonth   for "E"
40780>>>>>>>>>
40780>>>>>>>>>Class cSyIntelliSense_Date_Mixin is a Message
40781>>>>>>>>>   Procedure DoDefineIntelliSenseDateMixin
40782>>>>>>>>>      Property Date    pdOriginal_Value          Public 0
40783>>>>>>>>>      Property Integer pbIntelliSense_Date_State Public dfTrue
40784>>>>>>>>>      Property Integer pbEnableCalendarPrompt    Public dfTrue
40785>>>>>>>>>      On_Key KUpArrow         Send DoAddOneDay
40786>>>>>>>>>      On_Key KDownArrow       Send DoSubOneDay
40787>>>>>>>>>   End_Procedure // DoDefineIntelliSenseDateMixin
40788>>>>>>>>>
40788>>>>>>>>>   Procedure DoAddOneDay
40789>>>>>>>>>        Integer rVal
40790>>>>>>>>>        Date dHmnia
40790>>>>>>>>>
40790>>>>>>>>>        Get Value Item 0 to dHmnia
40791>>>>>>>>>        Add 1 to dHmnia
40792>>>>>>>>>        Set Value Item 0 to dHmnia
40793>>>>>>>>>    End_Procedure // Add_One_Day
40794>>>>>>>>>
40794>>>>>>>>>    Procedure DoSubOneDay
40795>>>>>>>>>        Integer rVal
40796>>>>>>>>>        Date dHmnia
40796>>>>>>>>>
40796>>>>>>>>>        Get Value Item 0 to dHmnia
40797>>>>>>>>>        Sub 1 to dHmnia
40798>>>>>>>>>        Set Value Item 0 to dHmnia
40799>>>>>>>>>    End_Procedure // Add_One_Day
40800>>>>>>>>>
40800>>>>>>>>>   // **WvA: Augmented to store the current date-value before any changes are made
40800>>>>>>>>>   Procedure Entering returns Integer
40801>>>>>>>>>      Integer iRetVal
40802>>>>>>>>>      Date    dOriginal
40802>>>>>>>>>      Forward Get Msg_Entering to iRetVal
40804>>>>>>>>>      If (iRetVal = 0) Begin
40806>>>>>>>>>         Send DoStoreOriginalDate
40807>>>>>>>>>      End
40807>>>>>>>>>>
40807>>>>>>>>>      Procedure_Return iRetVal
40808>>>>>>>>>   End_Procedure // Entering
40809>>>>>>>>>
40809>>>>>>>>>   //**WvA: This procedure is augmented to see if the user entered a 1 or 2 digit
40809>>>>>>>>>   //       value with the intention to only change the day-part of the current date.
40809>>>>>>>>>   Procedure Next
40810>>>>>>>>>      Send DoIntelliSenseDate
40811>>>>>>>>>      Forward Send Next
40813>>>>>>>>>   End_Procedure // Next
40814>>>>>>>>>
40814>>>>>>>>>   // **WvA: Store the current date-value before any changes are made
40814>>>>>>>>>   Procedure DoStoreOriginalDate
40815>>>>>>>>>      Date    dOriginal
40816>>>>>>>>>      //If (pbIntelliSense_Date_State(Self)) Begin
40816>>>>>>>>>         Get Value Item 0 to dOriginal
40817>>>>>>>>>         Set pdOriginal_Value to dOriginal
40818>>>>>>>>>      //End
40818>>>>>>>>>   End_Procedure // DoStoreOriginalDate
40819>>>>>>>>>
40819>>>>>>>>>   Procedure DoIntelliSenseDate
40820>>>>>>>>>      Integer iCurrent iStored iDaysOffSet iSep iDate_Format bChanged iYear
40821>>>>>>>>>      Date    dCurrent dOriginal
40821>>>>>>>>>      String  sStored  sCurrent sSep sMask
40821>>>>>>>>>
40821>>>>>>>>>      Get Item_Changed_State Item 0 to bChanged
40822>>>>>>>>>      Get pdOriginal_Value to dOriginal
40823>>>>>>>>>      If (pbIntelliSense_Date_State(Self) And (bChanged)) Begin
40825>>>>>>>>>         If (dOriginal Eq 0) Sysdate4 dOriginal
40828>>>>>>>>>
40828>>>>>>>>>         // We need the masked value, because the normal value is corrected by the runtime for
40828>>>>>>>>>         // USA dates.
40828>>>>>>>>>         Get Masked_Value Item 0 to sCurrent // getting a 2 digit entered date to a datavariable results in an error.
40829>>>>>>>>>         Move (Replaces(" ",sCurrent,"")) to sCurrent
40830>>>>>>>>>         Get_Attribute DF_DATE_SEPARATOR to iSep
40833>>>>>>>>>         Move (Character(iSep)) to sSep
40834>>>>>>>>>
40834>>>>>>>>>         // Although the sep value is "/" in the European date format, the mask seperator is "-".
40834>>>>>>>>>         Move (Replaces("-",sCurrent,sSep)) to sCurrent
40835>>>>>>>>>         Move (sSep+sSep) to sMask
40836>>>>>>>>>
40836>>>>>>>>>         // Now check if the user just entered a day or a day and a month.
40836>>>>>>>>>         // Something very special is going on here. We are interpreting a string, so the format
40836>>>>>>>>>         // will always be the same, even for USA or Military dates. "99//" where 9 can be any number
40836>>>>>>>>>         //If ( (length(sCurrent) > 2) And (Right(sCurrent,2) = sMask)  ) Begin
40836>>>>>>>>>         If ((length(sCurrent) <= 4) And (Right(sCurrent,2) = sMask)) Begin
40838>>>>>>>>>            Move (replace(sMask,sCurrent,"")) to sCurrent
40839>>>>>>>>>            Move sCurrent to iCurrent
40840>>>>>>>>>            If ((iCurrent >= 1) And (iCurrent <= 31)) Begin
40842>>>>>>>>>               Get_Attribute DF_DATE_FORMAT to iDate_Format
40845>>>>>>>>>               If (iDate_Format = DF_DATE_USA) Begin
40847>>>>>>>>>                  Move (Mid( String(dOriginal),2,4)) to iDaysOffSet
40848>>>>>>>>>               End
40848>>>>>>>>>>
40848>>>>>>>>>               Else If (iDate_Format = DF_DATE_EUROPEAN) Begin
40851>>>>>>>>>                  Move (Left( String(dOriginal),2 )) to iDaysOffSet
40852>>>>>>>>>               End
40852>>>>>>>>>>
40852>>>>>>>>>               Else If (iDate_Format = DF_DATE_MILITARY) Begin
40855>>>>>>>>>                  Move (Right( String(dOriginal),2 )) to iDaysOffSet
40856>>>>>>>>>               End
40856>>>>>>>>>>
40856>>>>>>>>>               Set Value Item 0 to (Date(dOriginal - iDaysOffSet + iCurrent))
40857>>>>>>>>>            End // Let the runtime handle the error if value not in the range 1..31
40857>>>>>>>>>>
40857>>>>>>>>>         End
40857>>>>>>>>>>
40857>>>>>>>>>         Else If ((length(sCurrent) > 4) And (Right(sCurrent,1) = sSep)) Begin
40860>>>>>>>>>            Get_Attribute DF_DATE_FORMAT to iDate_Format
40863>>>>>>>>>            If ((iDate_Format = DF_DATE_USA) Or (iDate_Format = DF_DATE_EUROPEAN)) Begin
40865>>>>>>>>>               Move (Right(dOriginal,4)) to iYear
40866>>>>>>>>>            End
40866>>>>>>>>>>
40866>>>>>>>>>            Else If (iDate_Format = DF_DATE_MILITARY) Begin
40869>>>>>>>>>               Move (Left(dOriginal,4))  to iYear
40870>>>>>>>>>            End
40870>>>>>>>>>>
40870>>>>>>>>>            Set Value Item 0 to (Date(sCurrent + String(iYear)))
40871>>>>>>>>>         End
40871>>>>>>>>>>
40871>>>>>>>>>      End
40871>>>>>>>>>>
40871>>>>>>>>>   End_Procedure // DoIntelliSenseDate
40872>>>>>>>>>
40872>>>>>>>>>   Procedure Key Integer iKey Returns Integer
40873>>>>>>>>>      Date dToday dTemp
40874>>>>>>>>>      Sysdate4 dToday
40875>>>>>>>>>
40875>>>>>>>>>      If ((Character(iKey) EQ cDateToday) OR (Character(iKey) EQ Lowercase(cDateToday))) Begin
40877>>>>>>>>>         Set Value to dToday
40878>>>>>>>>>      End
40878>>>>>>>>>>
40878>>>>>>>>>      Else If ((Character(iKey) EQ cDateBeginOfMonth) OR (Character(iKey) EQ Lowercase(cDateBeginOfMonth))) Begin
40881>>>>>>>>>         Get FirstDayInMonth dToday to dTemp
40882>>>>>>>>>         Set Value to dTemp
40883>>>>>>>>>      End
40883>>>>>>>>>>
40883>>>>>>>>>      Else If ((Character(iKey) EQ cDateEndOfMonth) OR (Character(iKey) EQ Lowercase(cDateEndOfMonth))) Begin
40886>>>>>>>>>         Get LastDayInMonth dToday to dTemp
40887>>>>>>>>>         Set Value to dTemp
40888>>>>>>>>>      End
40888>>>>>>>>>>
40888>>>>>>>>>      Else Forward Send Key iKey
40891>>>>>>>>>   End_procedure
40892>>>>>>>>>
40892>>>>>>>>>End_Class // cSyIntelliSense_Date_Mixin
40893>>>>>>>
40893>>>>>>>Class cSyDateForm Is A FormSub
40894>>>>>>>   Procedure Construct_Object
40895>>>>>>>      Forward Send Construct_Object
40897>>>>>>>
40897>>>>>>>      Set Prompt_Button_Mode   to PB_PromptOn
40898>>>>>>>      Set Form_Datatype Item 0 to Mask_Date_Window
40899>>>>>>>
40899>>>>>>>      Send DoDefineIntelliSenseDateMixin
40900>>>>>>>
40900>>>>>>>      On_Key kPrompt Send Prompt
40901>>>>>>>
40901>>>>>>>      Set Prompt_Object to (oCalendar(Self))
40902>>>>>>>      Set Status_Help   to cStatusHelp
40903>>>>>>>
40903>>>>>>>   End_Procedure // Construct_Object
40904>>>>>>>
40904>>>>>>>   Import_Class_Protocol cSyIntelliSense_Date_Mixin
40905>>>>>>>
40905>>>>>>>//   Function Form_Datatype Integer iItem Returns Integer
40905>>>>>>>//      Integer iDatatype
40905>>>>>>>//
40905>>>>>>>//      If (iItem = Current) Begin
40905>>>>>>>//         Get Current_Item to iItem
40905>>>>>>>//      End
40905>>>>>>>//
40905>>>>>>>//      Forward Get Form_Datatype Item iItem to iDataType
40905>>>>>>>//
40905>>>>>>>//      Function_Return iDatatype
40905>>>>>>>//   End_Function // Form_Datatype
40905>>>>>>>
40905>>>>>>>End_Class // cSyDateForm
40906>>>>>Use Form.Sub
40906>>>>>Use Txtbox.Sub
40906>>>>>Use Button.Sub
40906>>>>>
40906>>>>>
40906>>>>>Use CTYPKIN.DD
40906>>>>>Use WTYPKIN.DD
40906>>>>>Use PTYPPAR.DD
40906>>>>>Use CLIENTS.DD
40906>>>>>Use NOMISMA.DD
40906>>>>>Use PARTICLE.DD
INCLUDING FILE: PARTICLE.DD
40906>>>>>>>//DDB-FileStart
40906>>>>>>>//DDB-HeaderStart
40906>>>>>>>
40906>>>>>>>// File Name : PARTICLE.DD
40906>>>>>>>// Class Name: Particle_DataDictionary
40906>>>>>>>// Revision  : 266
40906>>>>>>>// Version   : 2
40906>>>>>>>
40906>>>>>>>Use  Windows           // Basic Definitions
40906>>>>>>>Use  DataDict          // DataDictionary Class Definition
40906>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
40906>>>>>>>
40906>>>>>>>Open Particle
40908>>>>>>>Open Pmoves
40910>>>>>>>Open Tparticl
INCLUDING FILE: TPARTICL.FD
40912>>>>>>>Open Partlfpa
INCLUDING FILE: PARTLFPA.FD
40914>>>>>>>Open Pmovesl
40916>>>>>>>Open Psxetika
INCLUDING FILE: PSXETIKA.FD
40918>>>>>>>Open Clients
40920>>>>>>>Open Ptyppar
40922>>>>>>>Open Nomisma
40924>>>>>>>Open Sysrecp
40926>>>>>>>Open Syscurxr
40928>>>>>>>Open Pseira
40930>>>>>>>Open Cn
40932>>>>>>>Open Partlfpa
40934>>>>>>>Open Clorder
40936>>>>>>>Open Clorderd
INCLUDING FILE: CLORDERD.FD
40938>>>>>>>Open Ypoprosf
INCLUDING FILE: YPOPROSF.FD
40940>>>>>>>Open Psxetika
40942>>>>>>>Open Pmoves
40944>>>>>>>Open Gmove
40946>>>>>>>Open Sysrecg
40948>>>>>>>
40948>>>>>>>//DDB-HeaderEnd
40948>>>>>>>//DDB-ValidationStart
40948>>>>>>>
40948>>>>>>>Register_Object Particle_Tropos_Diakin_VT
40948>>>>>>>Register_Object Particle_Skopos_Diakin_VT
40948>>>>>>>Register_Object Particle_Tropos_Plhromhs_VT
40948>>>>>>>
40948>>>>>>>Object Particle_Tropos_Diakin_VT  is a CodeValidationTable
40950>>>>>>>    Set Type_Value        To "SEND_TERMS"
40951>>>>>>>    Set Allow_Blank_State To TRUE
40952>>>>>>>    //DDB-ValidationCustomStart
40952>>>>>>>    //DDB-ValidationCustomEnd
40952>>>>>>>End_Object   // Particle_Tropos_Diakin_VT
40953>>>>>>>
40953>>>>>>>Object Particle_Skopos_Diakin_VT  is a CodeValidationTable
40955>>>>>>>    Set Type_Value        To "SKOPOS"
40956>>>>>>>    Set Allow_Blank_State To TRUE
40957>>>>>>>    //DDB-ValidationCustomStart
40957>>>>>>>    //DDB-ValidationCustomEnd
40957>>>>>>>End_Object   // Particle_Skopos_Diakin_VT
40958>>>>>>>
40958>>>>>>>Object Particle_Tropos_Plhromhs_VT  is a CodeValidationTable
40960>>>>>>>    Set Type_Value        To "PAY_TERMS"
40961>>>>>>>    Set Validate_State    To FALSE
40962>>>>>>>    Set Allow_Blank_State To TRUE
40963>>>>>>>    //DDB-ValidationCustomStart
40963>>>>>>>    //DDB-ValidationCustomEnd
40963>>>>>>>End_Object   // Particle_Tropos_Plhromhs_VT
40964>>>>>>>//DDB-ValidationEnd
40964>>>>>>>//DDB-SelectionStart
40964>>>>>>>//DDB/ ExternalSelectionList sl041  sl041.SL
40964>>>>>>>//DDB/ ExternalSelectionList sl014  sl014.SL
40964>>>>>>>//DDB/ ExternalSelectionList sl054  sl054.SL
40964>>>>>>>//DDB/ ExternalSelectionList sl053  sl053.SL
40964>>>>>>>//DDB/ ExternalSelectionList sl064  sl064.SL
40964>>>>>>>Register_Object sl041
40964>>>>>>>Register_Object sl014
40964>>>>>>>Register_Object sl054
40964>>>>>>>Register_Object sl053
40964>>>>>>>Register_Object sl064
40964>>>>>>>//DDB-SelectionEnd
40964>>>>>>>
40964>>>>>>>//Object oValidateSeira is a FileValidationTable
40964>>>>>>>//    Set Table_Title         to "„§ ¢¦šã ‘œ ¨áª ˜¨˜©«˜« ¡¦ç"
40964>>>>>>>//    Set Main_File           to Pseira.File_Number
40964>>>>>>>//    Set Code_Field          to  8 //Pseira.Pseira_Seira
40964>>>>>>>//    Set Description_Field   to 11 //Pseira.Pseira_Printer
40964>>>>>>>//    Set Ordering            to  1
40964>>>>>>>//    Set Static_State to False
40964>>>>>>>//End_Object
40964>>>>>>>
40964>>>>>>>Open Cars
INCLUDING FILE: CARS.FD
40966>>>>>>>Open Drivers
INCLUDING FILE: DRIVERS.FD
40968>>>>>>>Open Pumps
INCLUDING FILE: PUMPS.FD
40970>>>>>>>Open SysCurXr
40972>>>>>>>
40972>>>>>>>Class Particle_DataDictionary  is a DataDictionary_Sec
40973>>>>>>>
40973>>>>>>>    Function fsVresCNDescr String asCNCode Returns String
40974>>>>>>>        String rVal
40975>>>>>>>        Clear CN
40976>>>>>>>        Move asCNCode            to Cn.Cn_Code
40977>>>>>>>        Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
40978>>>>>>>>
40978>>>>>>>        If (Found) Move (Trim(CN.CN_Descr)) to rVal
40981>>>>>>>        Else Move '' to rVal
40983>>>>>>>        Function_Return rVal
40984>>>>>>>    End_Function
40985>>>>>>>
40985>>>>>>>    Function fsVresAntliaDescr String asOxhmaCode Returns String
40986>>>>>>>        String rVal
40987>>>>>>>        Clear Pumps
40988>>>>>>>        Move SysCurXr.Company_Code  to Pumps.Pump_Company
40989>>>>>>>        Move asOxhmaCode            to Pumps.Pump_ID
40990>>>>>>>        Find Eq Pumps By Index.1 // Pump_Company + Pump_ID
40991>>>>>>>>
40991>>>>>>>        If (Found) Move (Trim(Pumps.Pump_Descr)) to rVal
40994>>>>>>>        Else Move '' to rVal
40996>>>>>>>        Function_Return rVal
40997>>>>>>>    End_Function
40998>>>>>>>
40998>>>>>>>    Function fsVresOxhmaDescr String asOxhmaCode Returns String
40999>>>>>>>        String rVal
41000>>>>>>>        Clear Cars
41001>>>>>>>        Move SysCurXr.Company_Code  to Cars.Car_Company
41002>>>>>>>        Move asOxhmaCode            to Cars.Car_ID
41003>>>>>>>        Find Eq Cars By Index.1 // Car_Company + Car_ID
41004>>>>>>>>
41004>>>>>>>
41004>>>>>>>        If (Found) Move (Trim(Cars.Car_License)) to rVal
41007>>>>>>>        Else Move '' to rVal
41009>>>>>>>        Function_Return rVal
41010>>>>>>>    End_Function
41011>>>>>>>
41011>>>>>>>    Function fsVresDriverCode String asOxhmaCode Returns String
41012>>>>>>>        String rVal
41013>>>>>>>        Clear Cars
41014>>>>>>>        Move SysCurXr.Company_Code  to Cars.Car_Company
41015>>>>>>>        Move asOxhmaCode            to Cars.Car_ID
41016>>>>>>>        Find Eq Cars By Index.1 // Car_Company + Car_ID
41017>>>>>>>>
41017>>>>>>>        If (Found)  Move (Trim(Cars.Car_DriverID)) to rVal
41020>>>>>>>        Else        Move '' to rVal
41022>>>>>>>        Function_Return rVal
41023>>>>>>>    End_Function
41024>>>>>>>
41024>>>>>>>    Function fsVresDriverDescr String asDriverCode Returns String
41025>>>>>>>        String rVal
41026>>>>>>>        Clear Drivers
41027>>>>>>>        Move SysCurXr.Company_Code  to Drivers.Driver_Company
41028>>>>>>>        Move asDriverCode           to Drivers.Driver_ID
41029>>>>>>>        Find Eq Drivers By Index.1 // Driver_Company + Driver_ID
41030>>>>>>>>
41030>>>>>>>        If (Found) Move (Trim(Drivers.Driver_Name)) to rVal
41033>>>>>>>        Else Move '' to rVal
41035>>>>>>>        Function_Return rVal
41036>>>>>>>    End_Function
41037>>>>>>>
41037>>>>>>>    Procedure Construct_Object
41038>>>>>>>        Forward Send Construct_Object
41040>>>>>>>        Property String     psOldCode       Public ''
41041>>>>>>>        Property Integer    piPmovesID      Public  0
41042>>>>>>>        Property String     psOldUserID     Public ''
41043>>>>>>>        Property Integer    piOldSelected   Public  0
41044>>>>>>>        Property Integer    piFromMetasx    Public  0 
41045>>>>>>>        Property Integer    PifromBhma1     Public  0 
41046>>>>>>>        //------------------------------------------------
41046>>>>>>>        // Properties gia na kraththoun oi palies times 
41046>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
41046>>>>>>>        // einai 1     js 03/12/2007
41046>>>>>>>        //------------------------------------------------  
41046>>>>>>>        Property Integer piCreateNew            Public  0
41047>>>>>>>        Property String  psAud_Old_Pelaths      Public ""
41048>>>>>>>        Property String  psAud_Old_PelathsN     Public ""
41049>>>>>>>        Property String  psAud_Old_Ergo         Public ""
41050>>>>>>>        Property String  psAud_Old_ErgoDescr    Public ""
41051>>>>>>>        Property String  psAud_Old_Zonh         Public ""
41052>>>>>>>        Property String  psAud_Old_Antlia       Public ""
41053>>>>>>>        Property String  psAud_Old_Oxhma        Public ""
41054>>>>>>>        Property String  psAud_Old_PartlRecr    Public ""
41055>>>>>>>        Property String  psAud_Old_PmsRecr      Public ""
41056>>>>>>>        Property String  psAud_Old_Module       Public ""
41057>>>>>>>        Property String  psAud_Old_Parast       Public ""
41058>>>>>>>        Property String  psAud_Old_Seira        Public ""
41059>>>>>>>        Property Date    pdAud_Old_Hmnia        Public ""  
41060>>>>>>>        Property Integer piAud_Old_No           Public  0     
41061>>>>>>>        Property String  psAud_Old_Ektyposh     Public "" 
41062>>>>>>>        Property Integer piAud_Old_Timol        Public  0
41063>>>>>>>        Property Date    pdAud_Old_SapHmnia     Public ""
41064>>>>>>>        //------------------------------------------------
41064>>>>>>>    End_procedure
41065>>>>>>> 
41065>>>>>>> 
41065>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
41066>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
41068>>>>>>>        Set psOldCode       to Particle.Nomisma_Code
41069>>>>>>>        Set psOldUserID     to Particle.Partl_ToposF
41070>>>>>>>        Set piOldSelected   to Particle.Partl_Selected
41071>>>>>>>        //------------------------------------------------
41071>>>>>>>        // Properties gia na kraththoun oi palies times 
41071>>>>>>>        // ton pedion js 03/12/2007
41071>>>>>>>        //------------------------------------------------
41071>>>>>>>        Set psAud_Old_Pelaths       to Particle.Client_ID
41072>>>>>>>        Set psAud_Old_PelathsN      to Clients.Client_Name
41073>>>>>>>        Set psAud_Old_Ergo          to Particle.CN_Code     
41074>>>>>>>        Set psAud_Old_ErgoDescr     to (fsVresCNDescr(Self,Particle.CN_Code))
41075>>>>>>>        Set psAud_Old_PartlRecr     to Particle.Partl_Recr 
41076>>>>>>>        Set psAud_Old_PmsRecr       to Particle.Partl_Recr 
41077>>>>>>>        Set psAud_Old_Module        to Particle.Partl_Module
41078>>>>>>>        Set psAud_Old_Zonh          to Particle.Zone_ID
41079>>>>>>>        Set psAud_Old_Antlia        to Particle.Antlia_code
41080>>>>>>>        Set psAud_Old_Oxhma         to Particle.Oxhma_code
41081>>>>>>>        Set psAud_Old_Parast        to Ptyppar.Ptyppar_Code
41082>>>>>>>        Set psAud_Old_Seira         to Particle.Pseira_Seira
41083>>>>>>>        Set pdAud_Old_Hmnia         to Particle.Partl_Hmnia
41084>>>>>>>        Set piAud_Old_No            to Particle.Partl_No    
41085>>>>>>>        Set psAud_Old_Ektyposh      to Particle.Partl_Ektyposh 
41086>>>>>>>        Set piAud_Old_Timol         to Particle.Partl_Timol
41087>>>>>>>        Set pdAud_Old_SapHmnia      to Particle.Sap_hmnia
41088>>>>>>>
41088>>>>>>>        
41088>>>>>>>        //------------------------------------------------
41088>>>>>>>     End_Procedure   // New_Current_Record
41089>>>>>>>
41089>>>>>>>    Procedure Shmera integer iField  Date dDate
41090>>>>>>>        Local Integer Changed
41091>>>>>>>        Get Field_Changed_State iField to Changed
41092>>>>>>>        If (Changed=0 AND dDate =0) Begin
41094>>>>>>>            SysDate4 dDate
41095>>>>>>>            Set Field_Default_Value iField to dDate
41096>>>>>>>        End
41096>>>>>>>>
41096>>>>>>>    End_Procedure   // Shmera
41097>>>>>>>
41097>>>>>>>    Procedure Shmera_Ora integer iField  Number nOra
41098>>>>>>>        Local Integer Changed
41099>>>>>>>        Date dDate
41099>>>>>>>        Number nHour nMin
41099>>>>>>>        Get Field_Changed_State iField to Changed
41100>>>>>>>        If (Changed=0 AND nOra =0) Begin
41102>>>>>>>            SysDate4 dDate nHour nMin
41105>>>>>>>            Set Field_Default_Value iField to (nHour+(nMin/100))
41106>>>>>>>        End
41106>>>>>>>>
41106>>>>>>>    End_Procedure   // Shmera
41107>>>>>>>
41107>>>>>>>    Procedure Shmera_Ora_String integer iField  String asOra
41108>>>>>>>        Local Integer Changed
41109>>>>>>>        Date dDate
41109>>>>>>>        Number nHour nMin nTotal
41109>>>>>>>        String sOra sMin
41109>>>>>>>        Get Field_Changed_State iField to Changed
41110>>>>>>>        If (Changed=0 AND asOra='') Begin
41112>>>>>>>            SysDate4 dDate nHour nMin
41115>>>>>>>            Move (nHour+(nMin/100)) to nTotal
41116>>>>>>>            Set Field_Default_Value iField to (fsConvert_Time_Number_To_String_With_Zeroes(nTotal))
41117>>>>>>>        End
41117>>>>>>>>
41117>>>>>>>    End_Procedure   // Shmera
41118>>>>>>>
41118>>>>>>>    Procedure Save_Main_File
41119>>>>>>>        String  sCodeApo sCodeEos sOldUserID sCurrentUserID
41120>>>>>>>        Integer iBreak iPmoves iSelected iOldSelected
41120>>>>>>>        Number  nPoso nPosoEuro nIsotimia nPosothtaKin
41120>>>>>>>        Date    dHmnia
41120>>>>>>>
41120>>>>>>>        If ((Operation_Origin<>Self) And ;            (Particle.Recnum=0)) Procedure_Return
41123>>>>>>>
41123>>>>>>>        If (Particle.Cn_Code<>'') Begin
41125>>>>>>>            Clear Cn
41126>>>>>>>            Move Particle.Cn_Code   to Cn.Cn_Code
41127>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
41128>>>>>>>>
41128>>>>>>>            If (Found) Begin
41130>>>>>>>                Move Cn.Cn_Sls_ID       to Particle.Sls_ID
41131>>>>>>>                Move Cn.CN_Cnt_ID       to Particle.Cnt_ID
41132>>>>>>>                Move Cn.CN_Recr         to Particle.CN_Recr
41133>>>>>>>            End
41133>>>>>>>>
41133>>>>>>>            Else Begin
41134>>>>>>>                Move ''                 to Particle.Sls_ID
41135>>>>>>>                Move ''                 to Particle.Cnt_ID
41136>>>>>>>                Move ''                 to Particle.CN_Recr
41137>>>>>>>            End
41137>>>>>>>>
41137>>>>>>>        End
41137>>>>>>>>
41137>>>>>>>        Else Begin
41138>>>>>>>            Move ''                 to Particle.Sls_ID
41139>>>>>>>            Move ''                 to Particle.Cnt_ID
41140>>>>>>>            Move ''                 to Particle.CN_Recr
41141>>>>>>>        End
41141>>>>>>>>
41141>>>>>>>
41141>>>>>>>        Move Pmoves.Recnum              to iPmoves
41142>>>>>>>
41142>>>>>>>        Move Particle.Partl_Selected    to iSelected
41143>>>>>>>        Get piOldSelected               to iOldSelected
41144>>>>>>>        Get fsLoginUserID               to sCurrentUserID
41145>>>>>>>        Get psOldUserID                 to sOldUserID
41146>>>>>>>
41146>>>>>>>        ///----- ???????????????  REM 28/12/2010 JS
41146>>>>>>>        //If (Particle.Partl_timol=0) Begin
41146>>>>>>>        //    If (sOldUserID='') Move sCurrentUserID to Particle.Partl_Toposf
41146>>>>>>>        //End
41146>>>>>>>        //Else Begin
41146>>>>>>>        //    Move '' to Particle.Partl_Toposf
41146>>>>>>>        //End
41146>>>>>>>        ///----- ???????????????
41146>>>>>>>
41146>>>>>>>        Move 0 to nPosothtaKin
41147>>>>>>>        If ((piFromMetasx(Self)) Or (iSelected<>iOldSelected))Begin
41149>>>>>>>            If ((Particle.Partl_Toposf=sCurrentUserID) Or (Particle.Partl_Toposf='')) Begin
41151>>>>>>>                If (iSelected) Begin
41153>>>>>>>                    Clear Pmoves
41154>>>>>>>                    Move Particle.Partl_Recr to Pmoves.Partl_Recr
41155>>>>>>>                    Find Gt Pmoves by index.3
41156>>>>>>>>
41156>>>>>>>                    While ((Found=1) And (Pmoves.Partl_Recr=Particle.Partl_Recr))
41160>>>>>>>                            Move Pmoves.PMS_QTY  To Pmoves.Qty_Kinhshs
41161>>>>>>>                            Add  Pmoves.pms_qty  To nPosothtaKin
41162>>>>>>>                        Move 1              to Pmoves.Pms_Selected
41163>>>>>>>                        Saverecord Pmoves
41164>>>>>>>                        Find Gt Pmoves by index.3
41165>>>>>>>>
41165>>>>>>>                    Loop
41166>>>>>>>>
41166>>>>>>>                    Move sCurrentUserID to Particle.Partl_Toposf
41167>>>>>>>                    Move nPosothtaKin   to Particle.Partl_Disctof
41168>>>>>>>                End
41168>>>>>>>>
41168>>>>>>>                Else Begin
41169>>>>>>>                    Clear Pmoves
41170>>>>>>>                    Move Particle.Partl_Recr to Pmoves.Partl_Recr
41171>>>>>>>                    Find Gt Pmoves by index.3
41172>>>>>>>>
41172>>>>>>>                    While ((Found=1) And (Pmoves.Partl_Recr=Particle.Partl_Recr))
41176>>>>>>>                        Move 0 to Pmoves.Qty_Kinhshs
41177>>>>>>>                        Move 0 to Pmoves.Pms_Selected
41178>>>>>>>                        Saverecord Pmoves
41179>>>>>>>                        Find Gt Pmoves by index.3
41180>>>>>>>>
41180>>>>>>>                    Loop
41181>>>>>>>>
41181>>>>>>>                    Move '' to Particle.Partl_Toposf
41182>>>>>>>                    Move  0 To Particle.Partl_Selected
41183>>>>>>>                End
41183>>>>>>>>
41183>>>>>>>
41183>>>>>>>            End
41183>>>>>>>>
41183>>>>>>>            Set piFromMetasx to 0
41184>>>>>>>        End
41184>>>>>>>>
41184>>>>>>>
41184>>>>>>>        Forward Send Save_Main_File
41186>>>>>>>
41186>>>>>>>    End_Procedure   // Save_Main_File
41187>>>>>>>
41187>>>>>>>
41187>>>>>>>    Procedure Calc_The_Totals
41188>>>>>>>        Number nPct nPoso nAxia nTmp
41189>>>>>>>
41189>>>>>>>        Move (Particle.Partl_AMDISCPMS  + ;              Particle.Partl_TotDiscPc)         to Particle.Partl_DiscAm
41190>>>>>>>
41190>>>>>>>        Move (Particle.Partl_TotAmBD    - ;              Particle.Partl_DiscAm)            to Particle.Partl_TotAmAd
41191>>>>>>>
41191>>>>>>>        Move (Particle.Partl_TotAmAd    + ;              Particle.Partl_Extra)             to Particle.Partl_GenAm
41192>>>>>>>
41192>>>>>>>        If ((Particle.Partl_Extra<>0) And (Particle.Partl_ExtraVatP<>0)) Begin
41194>>>>>>>            Move (Round(Particle.Partl_Extra        *;                        Particle.Partl_ExtraVatP    /;                  100))                         to Particle.Partl_ExtraVat
41195>>>>>>>        End
41195>>>>>>>>
41195>>>>>>>
41195>>>>>>>        If ((Particle.Partl_TotDiscPC<>0) And (Particle.Disc_Vat_Pct<>0)) Begin
41197>>>>>>>            Move (Round(Particle.Partl_TotDiscPC    *;                        Particle.Disc_Vat_Pct       /;                  100))                         to Particle.Disc_Vat_Poso
41198>>>>>>>        End
41198>>>>>>>>
41198>>>>>>>
41198>>>>>>>        ////////////////////////////////////////////////////////////////////////
41198>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
41198>>>>>>>        ////////////////////////////////////////////////////////////////////////
41198>>>>>>>        If (Sysfile.Fpa_On_Total=0) Begin
41200>>>>>>>            Move (Particle.Partl_Vatam-Particle.Disc_Vat_Poso+Particle.Partl_ExtraVat) ;                to Particle.Total_Vat_Poso
41201>>>>>>>        End
41201>>>>>>>>
41201>>>>>>>        Else Begin
41202>>>>>>>            If (Particle.Fpa_On_Total<>0) ;                Move (Particle.Fpa_On_Total-Particle.Disc_Vat_Poso+Particle.Partl_ExtraVat) ;                    to Particle.Total_Vat_Poso
41205>>>>>>>            Else ;                Move (Particle.Partl_Vatam-Particle.Disc_Vat_Poso+Particle.Partl_ExtraVat) ;                    to Particle.Total_Vat_Poso
41207>>>>>>>        End
41207>>>>>>>>
41207>>>>>>>        ////////////////////////////////////////////////////////////////////////
41207>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
41207>>>>>>>        ////////////////////////////////////////////////////////////////////////
41207>>>>>>>
41207>>>>>>>        Move (Particle.Partl_GenAm      + ;              Particle.Total_Vat_Poso ) to Particle.Partl_PayAm
41208>>>>>>>
41208>>>>>>>      //  If (Particle.PARTL_TOTTEM>0) Begin
41208>>>>>>>      //      Move (Particle.PARTL_TOTTEM-Particle.Timol_Qty) ;
41208>>>>>>>      //                                      to Particle.Timol_Ypol
41208>>>>>>>      //
41208>>>>>>>      //      Move (Particle.Timol_Ypol=0)    to Particle.Partl_Timol
41208>>>>>>>      //
41208>>>>>>>      //  End
41208>>>>>>>      //  Else Move 0 to Particle.Partl_Timol
41208>>>>>>>
41208>>>>>>>        Move Particle.Partl_TotAmAD  to nAxia
41209>>>>>>>        Move Particle.Parakrat_Pct   to nPct
41210>>>>>>>        Move (Round_Number(((nAxia*nPct)/100),2)) to nTmp
41211>>>>>>>        Move nTmp to Particle.Parakrat_Poso
41212>>>>>>>    End_Procedure
41213>>>>>>>
41213>>>>>>>    Procedure Find_The_Rate
41214>>>>>>>        String  sCode sWhat
41215>>>>>>>        Integer iRateID
41215>>>>>>>        Number nEuro nIsot nRate
41215>>>>>>>        Date dHmnia
41215>>>>>>>        Move Nomisma.Nomisma_Code                   to sCode
41216>>>>>>>        If (Trim(sCode)='') Move SysCurXr.C_Code0   to sCode
41219>>>>>>>        Move Particle.Partl_Hmnia       to dHmnia
41220>>>>>>>        Move Particle.Isotimia          to nIsot
41221>>>>>>>        If (nIsot=0) Begin
41223>>>>>>>            If (dHmnia='') Sysdate dHmnia
41226>>>>>>>            Move (Trim(sCode)) to sCode
41227>>>>>>>            Clear Isotimia
41228>>>>>>>            Move sCode      to Isotimia.Nomisma_Code
41229>>>>>>>            Move (dHmnia+1) to Isotimia.Isotimia_Hmnia
41230>>>>>>>            Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
41231>>>>>>>>
41231>>>>>>>            If (Nomisma.Einai_Drx) Move 1 to Particle.Isotimia
41234>>>>>>>            Else Begin
41235>>>>>>>                Case Begin
41235>>>>>>>                    case (isotimia.poia_metatrepei='€') // Agora
41237>>>>>>>                        Move Isotimia.Isotimia_Agora to Particle.Isotimia
41238>>>>>>>                        Case Break
41239>>>>>>>                    case (isotimia.poia_metatrepei='') // Polhsh
41242>>>>>>>                        Move Isotimia.Isotimia_Polhsh to Particle.Isotimia
41243>>>>>>>                        Case Break
41244>>>>>>>                    Case (Isotimia.Poia_Metatrepei='F') // Fixing
41247>>>>>>>                        Move Isotimia.Isotimia_Fixing to Particle.Isotimia
41248>>>>>>>                        Case Break
41249>>>>>>>                    Case (Isotimia.Poia_Metatrepei='P') // Private
41252>>>>>>>                        Move Isotimia.Isotimia_Privat to Particle.Isotimia
41253>>>>>>>                        Case Break
41254>>>>>>>                Case End
41254>>>>>>>            End
41254>>>>>>>>
41254>>>>>>>        End
41254>>>>>>>>
41254>>>>>>>        Else Begin
41255>>>>>>>            If (dHmnia='') Sysdate      dHmnia
41258>>>>>>>            Move (Trim(sCode))      to  sCode
41259>>>>>>>            Clear Nomisma
41260>>>>>>>            Move sCode              to Nomisma.Nomisma_Code
41261>>>>>>>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
41262>>>>>>>>
41262>>>>>>>            If (Nomisma.Einai_Drx) Move 1 to Particle.Isotimia
41265>>>>>>>        End
41265>>>>>>>>
41265>>>>>>>    End_Procedure
41266>>>>>>>
41266>>>>>>>    Procedure Update
41267>>>>>>>        String  sCodeApo sCodeEos
41268>>>>>>>        String  sCar sCarDescr sDriver sDriverDescr
41268>>>>>>>        Integer iBreak iPmovesID
41268>>>>>>>        Number  nPoso nPosoEuro nIsotimia
41268>>>>>>>        Date    dHmnia
41268>>>>>>>
41268>>>>>>>        Forward Send Update
41270>>>>>>>
41270>>>>>>>        Send Find_The_Rate
41271>>>>>>>
41271>>>>>>>        Move SysCurXR.Company_Code  to Particle.Company_Code
41272>>>>>>>        Move SysCurXR.Branch_Code   to Particle.Branch_Code
41273>>>>>>>        Move SysCurXR.Year_Year     to Particle.Year_Year
41274>>>>>>>        Move Ctypkin.Ctypkin_Code   to Particle.Ctypkin_Code
41275>>>>>>>        Move Wtypkin.Wtypkin_Code   to Particle.Wtypkin_Code
41276>>>>>>>        //Move Custprom.Custprom_Code to Particle.Custprom_Code
41276>>>>>>>        Move Clients.Client_ID      to Particle.Client_ID
41277>>>>>>>        Move Ptyppar.Ptyppar_Code   to Particle.Ptyppar_Code
41278>>>>>>>        Move Ptyppar.Ptyppar_Module to Particle.Partl_Module
41279>>>>>>>        move clients.client_markexp to particle.partl_euro
41280>>>>>>>        Move Payresp.Presp_ID       to Particle.Presp_ID
41281>>>>>>>
41281>>>>>>>        Send Calc_The_Totals
41282>>>>>>>
41282>>>>>>>        Move    Particle.Oxhma_Code             to sCar
41283>>>>>>>        Get     fsVresOxhmaDescr sCar           to Particle.Oxhma_Descr
41284>>>>>>>        Get     fsVresDriverCode sCar           to Particle.Odhgos_Code
41285>>>>>>>        Move    Particle.Odhgos_Code            to sDriver
41286>>>>>>>        Get     fsVresDriverDescr sDriver       to Particle.Odhgos_Name
41287>>>>>>>        Move    Particle.Antlia_Code            to sCar
41288>>>>>>>        Get     fsVresAntliaDescr sCar          to sCarDescr
41289>>>>>>>        Move    sCarDescr                       to Particle.Antlia_Descr
41290>>>>>>>
41290>>>>>>>
41290>>>>>>>        ////////////////////////////////////////////////////////////////////////
41290>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
41290>>>>>>>        ////////////////////////////////////////////////////////////////////////
41290>>>>>>>//        If (Particle.Partl_ExtraVat) Begin
41290>>>>>>>//            Clear PartlFpa
41290>>>>>>>//            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
41290>>>>>>>//            Move Particle.Partl_ExtraVatP   to PartlFpa.Fpa_Pososto
41290>>>>>>>//            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
41290>>>>>>>//            Add Particle.Partl_ExtraVat     to PartlFpa.PartlFpa_Poso
41290>>>>>>>//            Saverecord PartlFpa
41290>>>>>>>//        End
41290>>>>>>>
41290>>>>>>>//        If (Particle.Disc_Vat_Poso) Begin
41290>>>>>>>//            Clear PartlFpa
41290>>>>>>>//            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
41290>>>>>>>//            Move Particle.Disc_Vat_Pct      to PartlFpa.Fpa_Pososto
41290>>>>>>>//            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
41290>>>>>>>//            Add Particle.Disc_Vat_Poso      to PartlFpa.PartlFpa_Poso
41290>>>>>>>//            Saverecord PartlFpa
41290>>>>>>>//        End
41290>>>>>>>        ////////////////////////////////////////////////////////////////////////
41290>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
41290>>>>>>>        ////////////////////////////////////////////////////////////////////////
41290>>>>>>>
41290>>>>>>>        // 01/10/2001 Mphke edo anti gia thn creating gia na kalipsei to problhma
41290>>>>>>>        // pou proekeipte an gia kapoio logo den symplhrvnotan seira kai o arithmos
41290>>>>>>>        // emene 0 eprepe na sbhstoun OLA ta lines kai to idio to parastatiko gia na
41290>>>>>>>        // xanatrexei o kodikas elegxou seiras kai arithmou
41290>>>>>>>        // Tora trexei sthn Update (giati sthn Save_Main_File kanei validation
41290>>>>>>>        // PRIN kai kobei thn eggrafh epeidh o arithmos einai 0
41290>>>>>>>        If ( ((Operation_Origin=Self) Or                 ;             (Operation_Origin=(piPmovesID(Self)))) And  ;             (Particle.Partl_No=0)) Send Kathorise_Thn_Seira
41293>>>>>>>        // 01/10/2001
41293>>>>>>>
41293>>>>>>>
41293>>>>>>>        //---------------------------------------------
41293>>>>>>>        // Auditing / Katagrafh allagon
41293>>>>>>>        //OPERATION_MODE       OPERATION_ORIGIN
41293>>>>>>>            //MODE_WAITING  
41293>>>>>>>            //MODE_FINDING  
41293>>>>>>>            //MODE_CLEARING 
41293>>>>>>>            //MODE_CREATING 
41293>>>>>>>            //MODE_SAVING   
41293>>>>>>>            //MODE_DELETING 
41293>>>>>>>            //MODE_ABORTING 
41293>>>>>>>        String  sUser sText sTime sMin sHour sSec
41293>>>>>>>        Date    dDate  Shmer 
41293>>>>>>>        Integer iMin iHour iSec iLen
41293>>>>>>>        Sysdate dDate iHour iMin iSec 
41297>>>>>>>        Move iHour  to sHour
41298>>>>>>>        Move iMin   to sMin
41299>>>>>>>        Move iSec   to sSec
41300>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
41304>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
41308>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
41312>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
41313>>>>>>>        
41313>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
41313>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
41315>>>>>>>            Get fsLoginUserID to sUser
41316>>>>>>>            If (piCreateNew(Self)=1) Begin
41318>>>>>>>                clear gmove
41319>>>>>>>                move syscurxr.company_code  to gmove.company_code
41320>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
41321>>>>>>>                move syscurxr.year_year     to gmove.year_year
41322>>>>>>>                move  1                     to gmove.gtypkin_code// Apo Parastatika
41323>>>>>>>                move ddate                  to gmove.garticl_hmnia
41324>>>>>>>                move Particle.partl_no      to gmove.garticl_no
41325>>>>>>>                move Particle.CN_Code       to gmove.gplan_recr
41326>>>>>>>                move suser                  to gmove.gplan_code
41327>>>>>>>                move Particle.Partl_Recr    to gmove.garticl_recr
41328>>>>>>>                reread sysrecg
41332>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
41333>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
41334>>>>>>>                saverecord sysrecg
41335>>>>>>>                unlock
41336>>>>>>>>
41336>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                            to Gmove.Gmove_Recr
41337>>>>>>>                Move Particle.Partl_Module          to Gmove.Module
41338>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
41339>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
41340>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
41341>>>>>>>                Move Clients.Client_ID              to Gmove.Cur_ID
41342>>>>>>>                Move Clients.CLient_Name            to Gmove.Cur_Name
41343>>>>>>>                Move Particle.CN_Code               to Gmove.Cur_CN
41344>>>>>>>                Move (fsVresCNDescr(Self,Particle.CN_Code)) ;                                                    to gmove.Cur_CN_Addr 
41345>>>>>>>                Move Particle.Partl_Recr            to Gmove.Partl_Recr 
41346>>>>>>>                Move Particle.Partl_Recr            to Gmove.Pms_Recr  
41347>>>>>>>                Move Particle.Zone_ID               to Gmove.Cur_Zonh
41348>>>>>>>                Move Particle.Antlia_code           to Gmove.Cur_Antlia
41349>>>>>>>                Move Particle.Oxhma_code            to Gmove.Cur_Oxhma       
41350>>>>>>>                Move Ptyppar.Ptyppar_Code           to Gmove.Cur_Parast
41351>>>>>>>                Move Particle.Pseira_Seira          to Gmove.Cur_Seira
41352>>>>>>>                Move Particle.Partl_Hmnia           to Gmove.Cur_Hmnia
41353>>>>>>>                Move "ƒž£ ¦¬¨šå˜ §˜¨˜©«˜« ¡¦ç" to sText
41354>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs
41355>>>>>>>                move (trim(stext))          to gmove.gmove_aitiol
41356>>>>>>>                Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                    to Gmove.Txt1
41357>>>>>>>                saverecord gmove
41358>>>>>>>                Set piCreateNew to 0
41359>>>>>>>            End
41359>>>>>>>>
41359>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
41362>>>>>>>                Integer isChanged
41362>>>>>>>                Move 0 to isChanged
41363>>>>>>>                
41363>>>>>>>                     If ((Trim(psAud_Old_Pelaths (Self))<>Trim(Clients.Client_ID      ))   Or  (Trim(psAud_Old_Ergo    (Self))<>Trim(Particle.CN_Code    ))) Move 1 to isChanged    
41366>>>>>>>                Else If ((Trim(psAud_Old_Zonh    (Self))<>Trim(Particle.Zone_ID       ))   Or  (Trim(psAud_Old_Antlia  (Self))<>Trim(Particle.Antlia_code))) Move 1 to isChanged   
41370>>>>>>>                Else If ((Trim(psAud_Old_Oxhma   (Self))<>Trim(Particle.Oxhma_code    ))   Or  (Trim(psAud_Old_Parast  (Self))<>Trim(Ptyppar.Ptyppar_Code))) Move 1 to isChanged   
41374>>>>>>>                Else If ((Trim(psAud_Old_Seira   (Self))<>Trim(Particle.Pseira_Seira  ))   Or  (Trim(pdAud_Old_Hmnia   (Self))<>Particle.Partl_Hmnia      )) Move 1 to isChanged  
41378>>>>>>>                Else If  (piAud_Old_No           (Self) <>Particle.Partl_No)                                                                                 Move 1 to isChanged
41382>>>>>>>                Else If ((Trim(psAud_Old_Ektyposh(Self))<>Trim(Particle.Partl_Ektyposh))   Or  (piAud_Old_Timol(Self)<>Particle.Partl_Timol               )) Move 1 to isChanged  
41386>>>>>>>                Else If  (pdAud_Old_SapHmnia     (Self) <>Particle.Sap_hmnia) Move 1 to isChanged
41390>>>>>>>
41390>>>>>>>                If (isChanged>0) Begin  
41392>>>>>>>                    clear gmove
41393>>>>>>>                    move syscurxr.company_code  to gmove.company_code
41394>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
41395>>>>>>>                    move syscurxr.year_year     to gmove.year_year
41396>>>>>>>                    move  1                     to gmove.gtypkin_code// Apo Parastatika
41397>>>>>>>                    move ddate                  to gmove.garticl_hmnia
41398>>>>>>>                    move Particle.partl_no      to gmove.garticl_no
41399>>>>>>>                    move Particle.CN_Code       to gmove.gplan_recr
41400>>>>>>>                    move suser                  to gmove.gplan_code
41401>>>>>>>                    move Particle.Partl_Recr    to gmove.garticl_recr
41402>>>>>>>                    reread sysrecg
41406>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
41407>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
41408>>>>>>>                    saverecord sysrecg
41409>>>>>>>                    unlock
41410>>>>>>>>
41410>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
41411>>>>>>>                    Move Particle.Partl_Module          to Gmove.Module
41412>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
41413>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
41414>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
41415>>>>>>>                    //--
41415>>>>>>>                    Move Particle.Partl_Recr            to Gmove.Partl_Recr 
41416>>>>>>>                    Move Particle.Partl_Recr            to Gmove.Pms_Recr  
41417>>>>>>>                    //--
41417>>>>>>>                    Move (Trim(Clients.Client_ID    ))  to Gmove.Cur_ID
41418>>>>>>>                    Move (Trim(Clients.CLient_Name  ))  to Gmove.Cur_Name
41419>>>>>>>                    Move (Trim(Particle.CN_Code     ))  to Gmove.Cur_CN
41420>>>>>>>                    Move (fsVresCNDescr(Self,Particle.CN_Code)) ;                                                        to gmove.Cur_CN_Addr 
41421>>>>>>>                    Move (Trim(Particle.Zone_ID     ))  to Gmove.Cur_Zonh
41422>>>>>>>                    Move (Trim(Particle.Antlia_code ))  to Gmove.Cur_Antlia
41423>>>>>>>                    Move (Trim(Particle.Oxhma_code  ))  to Gmove.Cur_Oxhma       
41424>>>>>>>                    Move (Trim(Ptyppar.Ptyppar_Code ))  to Gmove.Cur_Parast
41425>>>>>>>                    Move (Trim(Particle.Pseira_Seira))  to Gmove.Cur_Seira
41426>>>>>>>                    Move       Particle.Partl_Hmnia     to Gmove.Cur_Hmnia
41427>>>>>>>                    Move       Particle.Partl_No        to Gmove.Cur_No     
41428>>>>>>>                    Move Particle.Sap_hmnia             to Gmove.Date1
41429>>>>>>>                    //--
41429>>>>>>>                    Move (Trim(psAud_Old_Pelaths (Self))) to Gmove.Prev_ID
41430>>>>>>>                    Move (Trim(psAud_Old_PelathsN(Self))) to Gmove.Prev_Name
41431>>>>>>>                    Move (Trim(psAud_Old_Ergo    (Self))) to Gmove.Prev_CN
41432>>>>>>>                    Move (fsVresCNDescr(Self,(psAud_Old_Ergo(Self)))) ;                                                          to gmove.Prev_CN_Addr 
41433>>>>>>>                    Move (Trim(psAud_Old_Zonh    (Self))) to Gmove.Prev_Zonh
41434>>>>>>>                    Move (Trim(psAud_Old_Antlia  (Self))) to Gmove.Prev_Antlia
41435>>>>>>>                    Move (Trim(psAud_Old_Oxhma   (Self))) to Gmove.Prev_Oxhma
41436>>>>>>>                    Move (Trim(psAud_Old_Parast  (Self))) to Gmove.Prev_Parast
41437>>>>>>>                    Move (Trim(psAud_Old_Seira   (Self))) to Gmove.Prev_Seira
41438>>>>>>>                    Move      (pdAud_Old_Hmnia   (Self )) to Gmove.Prev_Hmnia
41439>>>>>>>                    Move      (piAud_Old_No      (Self )) to Gmove.Prev_No
41440>>>>>>>                    Move (pdAud_Old_SapHmnia     (Self )) to gmove.Date2 
41441>>>>>>>                    
41441>>>>>>>                    //--  
41441>>>>>>>                    If ((Trim(psAud_Old_Ektyposh(Self))<>Trim(Particle.Partl_Ektyposh)) Or (piAud_Old_Timol(Self)<>Particle.Partl_Timol) Or ;                        (pdAud_Old_SapHmnia     (Self) <>Particle.Sap_hmnia)) Move "€¤¦ š£˜ ˜¨˜©«˜« ¡¦ç - BACK DOOR"    to sText 
41444>>>>>>>                    Else Move "ƒ æ¨Ÿà©ž ˜¨˜©«˜« ¡¦ç"               to sText 
41446>>>>>>>                    
41446>>>>>>>                    Move "E" to Gmove.Eidos_Metabolhs
41447>>>>>>>                    move (trim(stext))          to gmove.gmove_aitiol
41448>>>>>>>                    Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                        to Gmove.Txt1
41449>>>>>>>                    saverecord gmove
41450>>>>>>>                    Set piCreateNew to 0
41451>>>>>>>                End
41451>>>>>>>>
41451>>>>>>>            End
41451>>>>>>>>
41451>>>>>>>        End
41451>>>>>>>>
41451>>>>>>>
41451>>>>>>>
41451>>>>>>>    End_Procedure   // Update
41452>>>>>>>
41452>>>>>>>    Procedure Delete_Main_File
41453>>>>>>>        //---------------------------------------------
41453>>>>>>>        // Auditing / Katagrafh allagon
41453>>>>>>>        //OPERATION_MODE       OPERATION_ORIGIN
41453>>>>>>>            //MODE_WAITING  
41453>>>>>>>            //MODE_FINDING  
41453>>>>>>>            //MODE_CLEARING 
41453>>>>>>>            //MODE_CREATING 
41453>>>>>>>            //MODE_SAVING   
41453>>>>>>>            //MODE_DELETING 
41453>>>>>>>            //MODE_ABORTING 
41453>>>>>>>        String  sUser sText sTime sMin sHour sSec
41454>>>>>>>        Date    dDate  Shmer 
41454>>>>>>>        Integer iMin iHour iSec iLen
41454>>>>>>>        Sysdate dDate iHour iMin iSec 
41458>>>>>>>        Move iHour  to sHour
41459>>>>>>>        Move iMin   to sMin
41460>>>>>>>        Move iSec   to sSec
41461>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
41465>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
41469>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
41473>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
41474>>>>>>>        
41474>>>>>>>        // Auditing / Diagrafh 
41474>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
41476>>>>>>>            Get fsLoginUserID to sUser
41477>>>>>>>
41477>>>>>>>            clear gmove
41478>>>>>>>            move syscurxr.company_code  to gmove.company_code
41479>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
41480>>>>>>>            move syscurxr.year_year     to gmove.year_year
41481>>>>>>>            move  1                     to gmove.gtypkin_code// Apo Parastatika
41482>>>>>>>            move ddate                  to gmove.garticl_hmnia
41483>>>>>>>            move Particle.partl_no      to gmove.garticl_no
41484>>>>>>>            move Particle.CN_Code       to gmove.gplan_recr
41485>>>>>>>            move suser                  to gmove.gplan_code
41486>>>>>>>            move Particle.Partl_Recr    to gmove.garticl_recr
41487>>>>>>>            reread sysrecg
41491>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
41492>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
41493>>>>>>>            saverecord sysrecg
41494>>>>>>>            unlock
41495>>>>>>>>
41495>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                        to Gmove.Gmove_Recr
41496>>>>>>>
41496>>>>>>>            Move (psAud_Old_Module(Self))       to Gmove.Module
41497>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
41498>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
41499>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
41500>>>>>>>            Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
41501>>>>>>>            Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
41502>>>>>>>            Move (psAud_Old_Ergo     (Self))    to Gmove.Prev_CN
41503>>>>>>>            Move (fsVresCNDescr(Self,(psAud_Old_Ergo(Self)))) ;                                                to gmove.Prev_CN_Addr 
41504>>>>>>>            Move (psAud_Old_PartlRecr(Self))    to Gmove.Partl_Recr 
41505>>>>>>>            Move (psAud_Old_PmsRecr  (Self))    to Gmove.Pms_Recr  
41506>>>>>>>            Move (psAud_Old_Zonh     (Self))    to Gmove.Prev_Zonh
41507>>>>>>>            Move (psAud_Old_Antlia   (Self))    to Gmove.Prev_Antlia
41508>>>>>>>            Move (psAud_Old_Oxhma    (Self))    to Gmove.Prev_Oxhma
41509>>>>>>>            Move (psAud_Old_Parast   (Self))    to Gmove.Prev_Parast
41510>>>>>>>            Move (psAud_Old_Seira    (Self))    to Gmove.Prev_Seira
41511>>>>>>>            Move (pdAud_Old_Hmnia    (Self))    to Gmove.Prev_Hmnia
41512>>>>>>>            Move (piAud_Old_No       (Self))    to Gmove.Prev_No
41513>>>>>>>            Move (pdAud_Old_SapHmnia (Self ))   to gmove.Date2 
41514>>>>>>>            Move "ƒ ˜š¨˜­ã ˜¨˜©«˜« ¡¦ç" to sText
41515>>>>>>>            Move "D" to Gmove.Eidos_Metabolhs
41516>>>>>>>            move (trim(stext))          to gmove.gmove_aitiol
41517>>>>>>>            Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                to Gmove.Txt1
41518>>>>>>>            saverecord gmove
41519>>>>>>>        End
41519>>>>>>>>
41519>>>>>>>
41519>>>>>>>        Forward Send Delete_Main_File
41521>>>>>>>
41521>>>>>>>    End_Procedure
41522>>>>>>>
41522>>>>>>>    Procedure Backout
41523>>>>>>>        Forward Send Backout
41525>>>>>>>        Send Calc_The_Totals
41526>>>>>>>        ////////////////////////////////////////////////////////////////////////
41526>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
41526>>>>>>>        ////////////////////////////////////////////////////////////////////////
41526>>>>>>>//        If (Particle.Partl_ExtraVat) Begin
41526>>>>>>>//            Clear PartlFpa
41526>>>>>>>//            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
41526>>>>>>>//            Move Particle.Partl_ExtraVatP   to PartlFpa.Fpa_Pososto
41526>>>>>>>//            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
41526>>>>>>>//            Sub Particle.Partl_ExtraVat   From PartlFpa.PartlFpa_Poso
41526>>>>>>>//            Saverecord PartlFpa
41526>>>>>>>//            If (PartlFpa.PartlFpa_Poso=0) Delete PartlFpa
41526>>>>>>>//        End
41526>>>>>>>
41526>>>>>>>//        If (Particle.Disc_Vat_Poso) Begin
41526>>>>>>>//            Clear PartlFpa
41526>>>>>>>//            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
41526>>>>>>>//            Move Particle.Disc_Vat_Pct      to PartlFpa.Fpa_Pososto
41526>>>>>>>//            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
41526>>>>>>>//            Sub Particle.Disc_Vat_Poso    From PartlFpa.PartlFpa_Poso
41526>>>>>>>//            Saverecord PartlFpa
41526>>>>>>>//            If (PartlFpa.PartlFpa_Poso=0) Delete PartlFpa
41526>>>>>>>//        End
41526>>>>>>>        ////////////////////////////////////////////////////////////////////////
41526>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
41526>>>>>>>        ////////////////////////////////////////////////////////////////////////
41526>>>>>>>
41526>>>>>>>
41526>>>>>>>    End_Procedure
41527>>>>>>>
41527>>>>>>>    Procedure Kathorise_Thn_Seira
41528>>>>>>>        Integer iNextNo iSeiraRecnum iPtypparRecnum
41529>>>>>>>
41529>>>>>>>//       js 25/04/2002 Prosthikh gia na ypostirixei ektyposh promhtheyton
41529>>>>>>>        If (Ptyppar.Ptyppar_Is_What='2') Begin
41531>>>>>>>            Clear Pseira
41532>>>>>>>            Move SysCurXr.Company_Code  to Pseira.Company_Code
41533>>>>>>>            Move SysCurXr.Branch_Code   to Pseira.Branch_Code
41534>>>>>>>            //Move SysCurXr.Year_Year     to Pseira.Year_Year
41534>>>>>>>            //Move Ctypkin.Ctypkin_Code   to Pseira.Ctypkin_Code
41534>>>>>>>            //Move Wtypkin.Wtypkin_Code   to Pseira.Wtypkin_Code
41534>>>>>>>            Move Ptyppar.Ptyppar_Code   to Pseira.Ptyppar_Code
41535>>>>>>>            Move Particle.Pseira_Seira  to Pseira.Pseira_Seira
41536>>>>>>>            Find eq Pseira By Index.1 // Pseira:Index.1:Company_Code+Branch_Code+Year_Year+;
41537>>>>>>>>
41537>>>>>>>                                    //                Ctypkin_Code+Wtypkin_Code+Ptyppar_Code+Seira_Seira
41537>>>>>>>            If (Found=1) Begin
41539>>>>>>>                // €¤ ž ©œ ¨˜ œ ¤˜  autonum ¡˜  «¦ §˜¨˜©«˜« ¡¦ œ ¤˜  «¬§¦¬ 2 —Š†‘†
41539>>>>>>>                If ((Pseira.Pseira_Autonum  = 1)    And ;                    (Particle.Partl_No      = 0 )) Begin
41541>>>>>>>                    Move (Pseira.Autonum_Minus-1) to iNextNo
41542>>>>>>>                    Move (Pseira.Autonum_Minus-1) to Pseira.Autonum_Minus
41543>>>>>>>                    Saverecord Pseira
41544>>>>>>>                    Move iNextNo to Particle.Partl_No
41545>>>>>>>                End
41545>>>>>>>>
41545>>>>>>>            End
41545>>>>>>>>
41545>>>>>>>        End
41545>>>>>>>>
41545>>>>>>>        Else Begin
41546>>>>>>>//       js 25/04/2002 Prosthikh gia na ypostirixei ektyposh promhtheyton
41546>>>>>>>            If ((Ptyppar.Ptyppar_Is_What='1') And (Trim(Ptyppar.Sysxet_Ptyppar)<>'')) Begin
41548>>>>>>>                Move (Random(-10000000)-1) To Particle.Partl_No
41549>>>>>>>            End
41549>>>>>>>>
41549>>>>>>>        End
41549>>>>>>>>
41549>>>>>>>    End_Procedure
41550>>>>>>>
41550>>>>>>>    Procedure Creating
41551>>>>>>>        Integer iNextNo
41552>>>>>>>        String  sNo sSeira
41552>>>>>>>        Forward Send Creating
41554>>>>>>>        // Insert Code Here
41554>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                         (Trim(String(Particle.Partl_Rec0)))))) to Particle.Partl_Recr
41555>>>>>>>
41555>>>>>>>        If (Particle.Disc_Vat_Pct   =0) Move 21 to Particle.Disc_Vat_Pct
41558>>>>>>>        If (Particle.Partl_ExtraVatP=0) Move 21 to Particle.Partl_ExtraVatP
41561>>>>>>>
41561>>>>>>>        Move Clients.Ypoloipo to Particle.Prohg_Ypol
41562>>>>>>>
41562>>>>>>>        If ((Trim(Ptyppar.Ti_Typonei_Pms)<>'2') And (Trim(Particle.Cn_Code)<>'')) Begin
41564>>>>>>>            Clear Cn
41565>>>>>>>            Move Particle.Cn_Code   to Cn.Cn_Code
41566>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
41567>>>>>>>>
41567>>>>>>>            If (Found) Begin
41569>>>>>>>                Move Particle.Partl_No      to sNo
41570>>>>>>>                Move Particle.Pseira_Seira  to sSeira
41571>>>>>>>                Move (Trim(sNo))            to sNo
41572>>>>>>>                Move (Trim(sSeira))         to sSeira
41573>>>>>>>                if (cn.hm_prot_fortio='')   Move Particle.Partl_Hmnia   to Cn.Hm_prot_Fortio
41576>>>>>>>                Move Particle.Partl_Hmnia   to Cn.Hm_Tel_Fortio
41577>>>>>>>                Move (Trim(sSeira+' '+sNo)) to Cn.Tel_Fortio_No
41578>>>>>>>                Saverecord CN
41579>>>>>>>            End
41579>>>>>>>>
41579>>>>>>>        End 
41579>>>>>>>>
41579>>>>>>>        // sta deltia apostolhs bhma1 den theloyme na ginetai elegxos opos
41579>>>>>>>        // kai sta aytonoma deltia apostolhs
41579>>>>>>>        if (PifromBhma1(self)=0) begin
41581>>>>>>>            if (clients.client_ptyppar='100') begin
41583>>>>>>>                if (ptyppar.is_xondr<>'1');                    error 5716 '‘œ œ¢á«ž •¦¤›¨ ¡ãª ›œ¤ £§¦¨œåª ¤˜ ¡æ¯œ ª ˜¨˜©«˜« ¡æ Š ˜¤ ¡ãª !!' 
41586>>>>>>>            end
41586>>>>>>>>
41586>>>>>>>            else if (clients.client_ptyppar='113') begin 
41589>>>>>>>                if (ptyppar.is_xondr='1');                    error 5717 '‘œ œ¢á«ž Š ˜¤ ¡ãª ›œ¤ £§¦¨œåª ¤˜ ¡æ¯œ ª ˜¨˜©«˜« ¡æ •¦¤›¨ ¡ãª !!' 
41592>>>>>>>            end
41592>>>>>>>>
41592>>>>>>>        End
41592>>>>>>>>
41592>>>>>>>        
41592>>>>>>>        Set piCreateNew to 1
41593>>>>>>>    
41593>>>>>>>    End_Procedure   // Creating
41594>>>>>>>
41594>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
41595>>>>>>>        String sStr
41596>>>>>>>        Move '' to sStr
41597>>>>>>>        Append sStr "DDC 14: ’¦ §˜¨˜©«˜« ¡æ §œ¨ â®œ  œ¤˜ œå›¦ª «¦ ¦§¦å¦\n"
41598>>>>>>>        Append sStr "§˜¨¦¬© áœ  ¡å¤ž©ž §¨¦ª £œ«˜©®ž£˜« ©£æ ˜§¦ «¦¤ ®¨ã©«ž\n"
41599>>>>>>>        Append sStr Particle.Partl_Toposf ". ˜«ã©«œ F5 £œ«˜ «¦ Ž‰"
41601>>>>>>>
41601>>>>>>>             If (iError_Num = 1001) Error 1001 "DDC 14: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ˜¨˜©«˜« ¡¦ç"
41604>>>>>>>        Else If (iError_Num = 1002) Error 1002 "DDC 14: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ”¦¨â˜"
41608>>>>>>>        Else If (iError_Num = 1003) Error 1003 "DDC 14: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã Œ¦£å©£˜«¦ª"
41612>>>>>>>        Else If (iError_Num = 1004) Error 1004 "DDC 14: †£œ¨¦£ž¤å˜ §˜¨˜©«˜« ¡¦ç ¡œ¤ã"
41616>>>>>>>        Else If (iError_Num = 1005) Error 1005 "DDC 14: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
41620>>>>>>>        Else If (iError_Num = 1006) Error 1006 "DDC 14: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
41624>>>>>>>        Else If (iError_Num = 1007) Error 1007 "DDC 14: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
41628>>>>>>>        Else If (iError_Num = 1008) Error 1008 "DDC 14: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
41632>>>>>>>        Else If (iError_Num = 1009) Error 1009 "DDC 14: ƒœ¤ œå¤˜  œ­ ¡«ã ž › ˜š¨˜­ã \n„®œ  ›ž£ ¦¬¨šžŸœå £œ«˜©®ž£˜« ©£â¤¦ §˜¨˜©«˜« ¡æ"
41636>>>>>>>        Else If (iError_Num = 1010) Error 1010 "DDC 14: † é¨˜ §¨â§œ  ¤˜ ›¦Ÿœå\n£œ 2 ¯ž­å˜ š ˜ «ž¤ é¨˜ ¡˜  2 š ˜ «˜ ¢œ§«á"
41640>>>>>>>        Else If (iError_Num = 1011) Error 1011 "DDC 14: †£œ¨¦£ž¤å˜ §¨¦šœ¤â©«œ¨ž «žª «œ¢œ¬«˜å˜ª œ¡«ç§à©žª"
41644>>>>>>>        Else If (iError_Num = 1012) Error 1012 sStr
41648>>>>>>>        Else If (iError_Num = 1055) Error 1055 "DDC 14: †£œ¨¦£ž¤åœª œ¡«æª ¦¨åà¤ ®¨ã©žª"
41652>>>>>>>        Else If (iError_Num = 1060) Error 1060 "DDC 14: ˜¨˜©«˜« ¡æ £œ«˜©®ž£˜« ©£â¤¦.\nƒœ¤ œ§ «¨â§œ«˜  ¦§¦ ˜›ã§¦«œ ˜¢¢˜šã ©«¦ ®œåà¤"
41656>>>>>>>        Else If (iError_Num = 1061) Error 1061 "DDC 14: ˜¨˜©«˜« ¡æ £œ«˜©®ž£˜« ©£â¤¦.\nƒœ¤ œ§ «¨â§œ«˜  ¤˜ › ˜š¨˜­œå"
41660>>>>>>>        Else If (iError_Num = 6040) Error 6040 "DDC 14: ƒœ¤ â®œ  §¨¦©› ¦¨ ©«œå ¡à› ¡æª ¤¦£å©£˜«¦ª"
41664>>>>>>>        Else If (iError_Num = 6050) Error 6050 "DDC 14: Ž œ¢á«žª ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž"
41668>>>>>>>        Else If (iError_Num = 6051) Error 6051 "DDC 14: ’¦ §˜¨˜©«˜« ¡æ ¡ ¤œå ˜¥åœª ˜¢¢á «¦ ©ç¤¦¢¦ «à¤ ˜¥ é¤ «¦¬ œå¤˜  £ž›œ¤ ¡æ"
41672>>>>>>>        Else If (iError_Num = 6060) Error 6060 "DDC 14: Ž “§œçŸ¬¤¦ª ¢ž¨à£é¤ ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž"
41676>>>>>>>        Else If (iError_Num = 1110) Error 1110 "DDC 14: †£/¤å˜ §˜¨˜©«˜« ¡¦ç <= †£/¤å˜ª ¡¢œ ©å£˜«¦ª\nƒœ¤ œ§ «¨â§œ«˜  ¡˜££å˜ «¨¦§¦§¦åž©ž ©«¦ §˜¨˜©«˜« ¡æ"
41680>>>>>>>        Else If (iError_Num = 1065) Error 1065 "DDC 14: Ž €¨ Ÿ£æª «¦¬ §˜¨˜©«˜« ¡¦ç \nƒ„Œ §¨â§œ  ¡˜  ›œ¤ £§¦¨œå ¤˜ œå¤˜  £ž›œ¤ ¡æª"
41684>>>>>>>        Else If (iError_Num = 1099) Error 1099 "DDC 14: ‰˜«žš¦¨å˜ œ¢á«ž › ˜­¦¨œ« ¡ã ¡˜«žš¦¨å˜ª ˜¨˜©«˜« ¡¦ç.\n„¢œš®¦ª ¡˜«žš¦¨å˜ª Š ˜¤ ¡ãª / •¦¤›¨ ¡ãª"
41688>>>>>>>        Else Forward Send Operation_Not_Allowed  iError_Num
41691>>>>>>>    End_Procedure   // Operation_Not_Allowed
41692>>>>>>>
41692>>>>>>>    Function Validate_Save Returns Integer
41693>>>>>>>        Number nqty
41694>>>>>>>        Integer iReturnVal iYes
41694>>>>>>>        String  sCurrentUserID sOldUserID
41694>>>>>>>
41694>>>>>>>        Forward Get Validate_Save  To iReturnVal
41696>>>>>>>
41696>>>>>>>        If (Not(iReturnVal)) Begin
41698>>>>>>>                 If (Ptyppar.Recnum      = 0)   Move 1001 to iReturnVal
41701>>>>>>>            Else If (Clients.Recnum      = 0)   Move 1002 to iReturnVal
41705>>>>>>>            Else If (Nomisma.Recnum      = 0)   Move 1003 to iReturnVal
41709>>>>>>>            Else If (Particle.Partl_Hmnia='')   Move 1004 to iReturnVal
41713>>>>>>>            Else If  Nomisma.nomisma_Code eq '' Move 6040 to iReturnVal
41717>>>>>>>          //  else if (clients.is_xondr ne ptyppar.is_xondr) move 1099 to iReturnVal
41717>>>>>>>            Else Begin
41718>>>>>>>//                If ((Clients.Plafon>0) And (Clients.OverHead<1) And (Sysfile.Over_OverHead<>'1')) Begin
41718>>>>>>>//                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
41718>>>>>>>//                    If (iYes=MBR_NO) Move 6050 to iReturnVal
41718>>>>>>>//                End
41718>>>>>>>//                Else If ((Clients.Plafon>0) And (PayResp.Plafon>0) And (PayResp.OverHead<1) And (Sysfile.Over_OverHead<>'1')) Begin
41718>>>>>>>//                    Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
41718>>>>>>>//                    If (iYes=MBR_NO) Move 6060 to iReturnVal
41718>>>>>>>//                End
41718>>>>>>>//                Else If ((PayResp.Plafon>0) And (PayResp.OverHead<1) And (Sysfile.Over_OverHead<>'1')) begin
41718>>>>>>>//                    Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
41718>>>>>>>//                    If (iYes=MBR_NO) Move 6060 to iReturnVal
41718>>>>>>>//                End
41718>>>>>>>
41718>>>>>>>                If ((Particle.Partl_Hmnia<SYSCURXR.YEAR_XRHSHFROM) Or ;                    (Particle.Partl_Hmnia>SYSCURXR.YEAR_XRHSHTO))     ;                                                Move 1055 to iReturnVal
41721>>>>>>>                Else Begin
41722>>>>>>>                    If (Particle.Partl_Timol=0) Begin
41724>>>>>>>                        Get fsLoginUserID to sCurrentUserID
41725>>>>>>>                        Get psOldUserID   to sOldUserID
41726>>>>>>>                        If (sOldUserID<>'') Begin
41728>>>>>>>                            If (sOldUserID<>sCurrentUserID) Move 1012 to iReturnVal
41731>>>>>>>                        End
41731>>>>>>>>
41731>>>>>>>                        //Else Move sCurrentUserID to Particle.Partl_Toposf
41731>>>>>>>                    End
41731>>>>>>>>
41731>>>>>>>                    //Else Move '' to Particle.Partl_Toposf
41731>>>>>>>                End
41731>>>>>>>>
41731>>>>>>>            End
41731>>>>>>>>
41731>>>>>>>/////////////////////////////////////////////////////////////////////////////
41731>>>>>>>// js 26/08/2002 Erothsh: Pos tha piaso ena parastatiko to opoio kinei
41731>>>>>>>//               axies alla katalhgei na exei geniko synolo 0 (an p.x.
41731>>>>>>>//               ginoun ekptoseis 100%.
41731>>>>>>>//               Apanthsh: To piano edo me ton oro oti den mporei na kopsei
41731>>>>>>>//               timologio m'ena eidos mono to opoio exei ekptosh 100%, opote
41731>>>>>>>//               ef'oson tha yparxoun pano apo ena eidos, to eidos me thn
41731>>>>>>>//               ekptosh prepei na kataxorithei san 2o kai meta.POTE proto
41731>>>>>>>//               giati etsi tha exei 0 to synolo tou parastatikou kai tha
41731>>>>>>>//               varesei to validation.
41731>>>>>>>
41731>>>>>>>// Rem giati sthn fash metasxhmatismou apo DAP se TIM den yparxoun times sto DAP
41731>>>>>>>// opote kai to TIM pou paragetai den exei times (Eno leme pos TIM xoris times den ginetai
41731>>>>>>>// Bebaia edo mporoume na elegxoume epipleon an to paragomeno erxetai apo metasxhmatismo
41731>>>>>>>// opote kai tha to afhname. NA TO DOUME.
41731>>>>>>>//            Else If ((Sysfile.Mhdeniko_Partl=0) And (Ptyppar.Ti_Typonei_Pms<>'1') And ;
41731>>>>>>>//                     (Particle.Partl_Payam=0)   And (Particle.Partl_NoOfLines>0)) ;
41731>>>>>>>//                    Move 6051 to iReturnVal
41731>>>>>>>
41731>>>>>>>/////////////////////////////////////////////////////////////////////////////
41731>>>>>>>
41731>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
41734>>>>>>>        End
41734>>>>>>>>
41734>>>>>>>        Function_Return iReturnVal
41735>>>>>>>    End_Function   // Validate_Save
41736>>>>>>>
41736>>>>>>>
41736>>>>>>>    Function Validate_Delete  Returns Integer
41737>>>>>>>        Integer iReturnVal
41738>>>>>>>        Forward Get Validate_Delete  To iReturnVal
41740>>>>>>>        If (Not(iReturnVal)) Begin
41742>>>>>>>            If (Particle.Partl_Timol = 1) Move 1009 to iReturnVal
41745>>>>>>>            Else If ( (Sysfile.Hm_Kleisimatos<>'') And ;                      (Particle.Partl_Hmnia<=Sysfile.Hm_Kleisimatos) ) ;                     Move 1110 to iReturnVal
41749>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
41752>>>>>>>        End
41752>>>>>>>>
41752>>>>>>>        Function_Return iReturnVal
41753>>>>>>>    End_Function   // Validate_Delete
41754>>>>>>>
41754>>>>>>>
41754>>>>>>>    Procedure Define_Fields
41755>>>>>>>        Forward Send Define_Fields
41757>>>>>>>        //DDB-Generated-Code-Location
41757>>>>>>>        //DDB-DefineFieldStart
41757>>>>>>>
41757>>>>>>>        Set Main_File            To Particle.File_Number
41758>>>>>>>
41758>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41759>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41760>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41761>>>>>>>
41761>>>>>>>        // Child (Client) file structure................
41761>>>>>>>        Send Add_Client_File  Pmoves.File_Number
41762>>>>>>>        Send Add_Client_File  Tparticl.File_Number
41763>>>>>>>        Send Add_Client_File  Partlfpa.File_Number
41764>>>>>>>        Send Add_Client_File  Pmovesl.File_Number
41765>>>>>>>        Send Add_Client_File  Psxetika.File_Number
41766>>>>>>>
41766>>>>>>>        // Parent (Server) file structure...............
41766>>>>>>>        Send Add_Server_File  Clients.File_Number
41767>>>>>>>        Send Add_Server_File  Ptyppar.File_Number
41768>>>>>>>        Send Add_Server_File  Nomisma.File_Number
41769>>>>>>>
41769>>>>>>>        // External (System) file structure.............
41769>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_NEW_SAVE
41770>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
41771>>>>>>>        Send Add_System_File  Pseira.File_Number  DD_LOCK_ON_ALL
41772>>>>>>>        Send Add_System_File  Cn.File_Number  DD_LOCK_ON_ALL
41773>>>>>>>        Send Add_System_File  Partlfpa.File_Number  DD_LOCK_ON_ALL
41774>>>>>>>        Send Add_System_File  Clorder.File_Number  DD_LOCK_ON_ALL
41775>>>>>>>        Send Add_System_File  Clorderd.File_Number  DD_LOCK_ON_ALL
41776>>>>>>>        Send Add_System_File  Ypoprosf.File_Number  DD_LOCK_ON_ALL
41777>>>>>>>        Send Add_System_File  Psxetika.File_Number  DD_LOCK_ON_ALL
41778>>>>>>>        Send Add_System_File  Pmoves.File_Number  DD_LOCK_ON_ALL
41779>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
41780>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
41781>>>>>>>
41781>>>>>>>        Define_Auto_Increment  Sysrecp.Particle_Rec0  To Particle.Partl_Rec0
41784>>>>>>>
41784>>>>>>>        // Field-based properties.......................
41784>>>>>>>
41784>>>>>>>        // Particle.Company_Code
41784>>>>>>>
41784>>>>>>>        // Particle.Branch_Code
41784>>>>>>>
41784>>>>>>>        // Particle.Year_Year
41784>>>>>>>
41784>>>>>>>        // Particle.Ctypkin_Code
41784>>>>>>>
41784>>>>>>>        // Particle.Wtypkin_Code
41784>>>>>>>
41784>>>>>>>        // Particle.Ptyppar_Code
41784>>>>>>>
41784>>>>>>>        // Particle.Pseira_Seira
41784>>>>>>>
41784>>>>>>>        // Particle.Custprom_Code
41784>>>>>>>
41784>>>>>>>        // Particle.Client_Id
41784>>>>>>>
41784>>>>>>>        // Particle.Partl_No
41784>>>>>>>
41784>>>>>>>        // Particle.Cn_Recr
41784>>>>>>>        Set Field_Prompt_Object    Field Particle.Cn_Recr To (sl041(Self))
41785>>>>>>>
41785>>>>>>>        // Particle.Pseira_Recr
41785>>>>>>>
41785>>>>>>>        // Particle.Partl_Hmnia
41785>>>>>>>        Set Field_Entry_msg        Field Particle.Partl_Hmnia To Shmera
41786>>>>>>>        Set Field_Prompt_Object    Field Particle.Partl_Hmnia To (sl014(Self))
41787>>>>>>>
41787>>>>>>>        // Particle.Partl_Rec0
41787>>>>>>>        Set Field_Options          Field Particle.Partl_Rec0 To DD_AUTOFIND   
41788>>>>>>>
41788>>>>>>>        // Particle.Partl_Lastno
41788>>>>>>>
41788>>>>>>>        // Particle.Partl_Tdiakin
41788>>>>>>>
41788>>>>>>>        // Particle.Partl_Car
41788>>>>>>>
41788>>>>>>>        // Particle.Partl_Reldoc
41788>>>>>>>
41788>>>>>>>        // Particle.Partl_Toposf
41788>>>>>>>
41788>>>>>>>        // Particle.Partl_Toposa
41788>>>>>>>
41788>>>>>>>        // Particle.Partl_Troposa
41788>>>>>>>
41788>>>>>>>        // Particle.Partl_Tof
41788>>>>>>>
41788>>>>>>>        // Particle.Partl_Disctof
41788>>>>>>>
41788>>>>>>>        // Particle.Partl_Disccl
41788>>>>>>>
41788>>>>>>>        // Particle.Partl_Autodisc
41788>>>>>>>
41788>>>>>>>        // Particle.Partl_Time
41788>>>>>>>
41788>>>>>>>        // Particle.Partl_Totambd
41788>>>>>>>
41788>>>>>>>        // Particle.Partl_Amdiscpms
41788>>>>>>>
41788>>>>>>>        // Particle.Partl_Totdiscpc
41788>>>>>>>
41788>>>>>>>        // Particle.Partl_Discam
41788>>>>>>>
41788>>>>>>>        // Particle.Partl_Totamad
41788>>>>>>>
41788>>>>>>>        // Particle.Partl_Vatpct
41788>>>>>>>
41788>>>>>>>        // Particle.Partl_Vatam
41788>>>>>>>
41788>>>>>>>        // Particle.Partl_Genam
41788>>>>>>>
41788>>>>>>>        // Particle.Partl_Extra
41788>>>>>>>
41788>>>>>>>        // Particle.Partl_Extravatp
41788>>>>>>>
41788>>>>>>>        // Particle.Partl_Extravat
41788>>>>>>>
41788>>>>>>>        // Particle.Partl_Payam
41788>>>>>>>
41788>>>>>>>        // Particle.Partl_Befypol
41788>>>>>>>
41788>>>>>>>        // Particle.Partl_Currypol
41788>>>>>>>
41788>>>>>>>        // Particle.Partl_Tottem
41788>>>>>>>
41788>>>>>>>        // Particle.Partl_Det
41788>>>>>>>
41788>>>>>>>        // Particle.Partl_Recr
41788>>>>>>>        Set Field_Options          Field Particle.Partl_Recr To DD_AUTOFIND   
41789>>>>>>>        Set Field_Prompt_Object    Field Particle.Partl_Recr To (sl014(Self))
41790>>>>>>>
41790>>>>>>>        // Particle.Cn_Code
41790>>>>>>>        Set Field_Prompt_Object    Field Particle.Cn_Code To (sl041(Self))
41791>>>>>>>
41791>>>>>>>        // Particle.Client_Recr
41791>>>>>>>
41791>>>>>>>        // Particle.Ptyppar_Recr
41791>>>>>>>
41791>>>>>>>        // Particle.Partl_Ekleise
41791>>>>>>>
41791>>>>>>>        // Particle.Partl_Ekl_Recr
41791>>>>>>>
41791>>>>>>>        // Particle.Partl_Ektyposh
41791>>>>>>>
41791>>>>>>>        // Particle.Partl_Akyrosh
41791>>>>>>>
41791>>>>>>>        // Particle.Partl_Akyr_Recr
41791>>>>>>>
41791>>>>>>>        // Particle.Partl_Nooflines
41791>>>>>>>
41791>>>>>>>        // Particle.Cmoves_Recr
41791>>>>>>>
41791>>>>>>>        // Particle.Nomisma_Code
41791>>>>>>>
41791>>>>>>>        // Particle.Isotimia
41791>>>>>>>
41791>>>>>>>        // Particle.Wcmoves_Recr
41791>>>>>>>
41791>>>>>>>        // Particle.Partl_Module
41791>>>>>>>
41791>>>>>>>        // Particle.Partl_Timol
41791>>>>>>>        Set Field_Mask             Field Particle.Partl_Timol To "#"
41792>>>>>>>        Set Field_Mask_Type        Field Particle.Partl_Timol To MASK_NUMERIC_WINDOW
41793>>>>>>>
41793>>>>>>>        // Particle.Partl_Selected
41793>>>>>>>
41793>>>>>>>        // Particle.Partl_Tim_Recr
41793>>>>>>>
41793>>>>>>>        // Particle.Partl_Vsn
41793>>>>>>>
41793>>>>>>>        // Particle.Sls_Id
41793>>>>>>>
41793>>>>>>>        // Particle.Presp_Id
41793>>>>>>>
41793>>>>>>>        // Particle.Cnt_Id
41793>>>>>>>
41793>>>>>>>        // Particle.Topos_Apostolhs
41793>>>>>>>
41793>>>>>>>        // Particle.Tropos_Diakin
41793>>>>>>>        Set Field_Class_Name       Field Particle.Tropos_Diakin To "dbComboFormsub"
41794>>>>>>>        Set Field_Value_Table      Field Particle.Tropos_Diakin To (Particle_Tropos_Diakin_VT(Self))
41795>>>>>>>
41795>>>>>>>        // Particle.Ora_Apostolhs
41795>>>>>>>        Set Field_Entry_msg        Field Particle.Ora_Apostolhs To Shmera_Ora_String
41796>>>>>>>        Set Field_Mask             Field Particle.Ora_Apostolhs To "##:##"
41797>>>>>>>
41797>>>>>>>        // Particle.Skopos_Diakin
41797>>>>>>>        Set Field_Class_Name       Field Particle.Skopos_Diakin To "dbComboFormsub"
41798>>>>>>>        Set Field_Value_Table      Field Particle.Skopos_Diakin To (Particle_Skopos_Diakin_VT(Self))
41799>>>>>>>
41799>>>>>>>        // Particle.Tropos_Plhromhs
41799>>>>>>>        Set Field_Value_Table      Field Particle.Tropos_Plhromhs To (Particle_Tropos_Plhromhs_VT(Self))
41800>>>>>>>
41800>>>>>>>        // Particle.Odhgos_Code
41800>>>>>>>
41800>>>>>>>        // Particle.Odhgos_Name
41800>>>>>>>
41800>>>>>>>        // Particle.Oxhma_Code
41800>>>>>>>        Set Field_Prompt_Object    Field Particle.Oxhma_Code To (sl054(Self))
41801>>>>>>>
41801>>>>>>>        // Particle.Oxhma_Descr
41801>>>>>>>
41801>>>>>>>        // Particle.Antlia_Code
41801>>>>>>>        Set Field_Prompt_Object    Field Particle.Antlia_Code To (sl053(Self))
41802>>>>>>>
41802>>>>>>>        // Particle.Antlia_Descr
41802>>>>>>>
41802>>>>>>>        // Particle.Partl_Euro
41802>>>>>>>
41802>>>>>>>        // Particle.Disc_Vat_Pct
41802>>>>>>>
41802>>>>>>>        // Particle.Disc_Vat_Poso
41802>>>>>>>
41802>>>>>>>        // Particle.Total_Vat_Poso
41802>>>>>>>
41802>>>>>>>        // Particle.Exei_Sxetika
41802>>>>>>>
41802>>>>>>>        // Particle.Aitiol
41802>>>>>>>
41802>>>>>>>        // Particle.Max_Days_Date
41802>>>>>>>
41802>>>>>>>        // Particle.Timol_Qty
41802>>>>>>>
41802>>>>>>>        // Particle.Timol_Ypol
41802>>>>>>>
41802>>>>>>>        // Particle.Epilogh_Ekkrem
41802>>>>>>>
41802>>>>>>>        // Particle.No_Print_Module
41802>>>>>>>        //DDB/ Comment_Short       Field Particle.No_Print_Module To "Œ˜ £ž¤ «¬§é¤œ«˜  (˜§¦ ˜¢¢¦ ¡ç¡¢à£˜ §.®.§˜¨˜š ©œ ¨¦£)"
41802>>>>>>>
41802>>>>>>>        // Particle.Prohg_Ypol
41802>>>>>>>
41802>>>>>>>        // Particle.Trex_Ypol
41802>>>>>>>
41802>>>>>>>        // Particle.Parakrat_Pct
41802>>>>>>>
41802>>>>>>>        // Particle.Parakrat_Poso
41802>>>>>>>
41802>>>>>>>        // Particle.Cms_Parak_Recr
41802>>>>>>>
41802>>>>>>>        // Particle.Enhm_Logik
41802>>>>>>>
41802>>>>>>>        // Particle.Se_Logik
41802>>>>>>>
41802>>>>>>>        // Particle.Akyro
41802>>>>>>>
41802>>>>>>>        // Particle.Zone_Id
41802>>>>>>>        Set Field_Prompt_Object    Field Particle.Zone_Id To (sl064(Self))
41803>>>>>>>
41803>>>>>>>        // Particle.Fpa_On_Total
41803>>>>>>>
41803>>>>>>>        // Particle.Ss_Arithmos
41803>>>>>>>
41803>>>>>>>        // Particle.Sap_Hmnia
41803>>>>>>>        Set Field_Mask_Type        Field Particle.Sap_Hmnia To MASK_DATE_WINDOW
41804>>>>>>>
41804>>>>>>>        //DDB-DefineFieldEnd
41804>>>>>>>    End_Procedure    // Define_Fields
41805>>>>>>>
41805>>>>>>>    Procedure Field_Defaults
41806>>>>>>>        Forward Send Field_Defaults
41808>>>>>>>        //DDB-Generated-Code-Location
41808>>>>>>>        //DDB-FieldDefaultStart
41808>>>>>>>        //DDB-FieldDefaultEnd
41808>>>>>>>        Set Field_Changed_Value Field Particle.Nomisma_Code to SyscurXr.C_Code0
41809>>>>>>>    End_Procedure    // Field_Defaults
41810>>>>>>>
41810>>>>>>>End_Class    // Particle_DataDictionary
41811>>>>>>>//DDB-Selection-pkg-Start
41811>>>>>>>
41811>>>>>>>Use sl041.SL         // sl041
41811>>>>>>>Use sl014.SL         // sl014
41811>>>>>>>Use sl054.SL         // sl054
INCLUDING FILE: SL054.SL
41811>>>>>>>>>//AB/ Project sl054:cars
41811>>>>>>>>>//AB/ Object prj is a Lookup_Project
41811>>>>>>>>>//AB/     Set ProjectName to "sl054:cars"
41811>>>>>>>>>//AB/     Set ProjectFileName to "sl054.SL"
41811>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
41811>>>>>>>>>
41811>>>>>>>>>// Project Object Structure
41811>>>>>>>>>//   sl054 is a dbModalPanelSub
41811>>>>>>>>>//     Cars_DD is a DataDictionary
41811>>>>>>>>>//     oSelList is a dbListSub
41811>>>>>>>>>//     oOK_bn is a ButtonSub
41811>>>>>>>>>//     oCancel_bn is a ButtonSub
41811>>>>>>>>>//     oSearch_bn is a ButtonSub
41811>>>>>>>>>
41811>>>>>>>>>// Register all objects
41811>>>>>>>>>Register_Object Cars_DD
41811>>>>>>>>>Register_Object oCancel_bn
41811>>>>>>>>>Register_Object oOK_bn
41811>>>>>>>>>Register_Object oSearch_bn
41811>>>>>>>>>Register_Object oSelList
41811>>>>>>>>>Register_Object sl054
41811>>>>>>>>>
41811>>>>>>>>>
41811>>>>>>>>>//AB-IgnoreStart
41811>>>>>>>>>
41811>>>>>>>>>Use DFAllEnt.pkg
41811>>>>>>>>>Use dbList.Sub
41811>>>>>>>>>Use Button.Sub
41811>>>>>>>>>
41811>>>>>>>>>
41811>>>>>>>>>Use Cars.DD
INCLUDING FILE: CARS.DD
41811>>>>>>>>>>>//DDB-FileStart
41811>>>>>>>>>>>//DDB-HeaderStart
41811>>>>>>>>>>>
41811>>>>>>>>>>>// File Name : CARS.DD
41811>>>>>>>>>>>// Class Name: Cars_DataDictionary
41811>>>>>>>>>>>// Revision  : 16
41811>>>>>>>>>>>// Version   : 2
41811>>>>>>>>>>>
41811>>>>>>>>>>>Use  Windows           // Basic Definitions
41811>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
41811>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41811>>>>>>>>>>>
41811>>>>>>>>>>>Open Cars
41813>>>>>>>>>>>Open Gmove
41815>>>>>>>>>>>Open Sysrecg
41817>>>>>>>>>>>
41817>>>>>>>>>>>//DDB-HeaderEnd
41817>>>>>>>>>>>//DDB-ValidationStart
41817>>>>>>>>>>>
41817>>>>>>>>>>>Register_Object Cars_Ctype_Id_VT
41817>>>>>>>>>>>
41817>>>>>>>>>>>Object Cars_Ctype_Id_VT  is a CodeValidationTable
41819>>>>>>>>>>>    Set Type_Value        To "PUMPSTYPE"
41820>>>>>>>>>>>    Set Validate_State    To FALSE
41821>>>>>>>>>>>    Set Allow_Blank_State To TRUE
41822>>>>>>>>>>>    //DDB-ValidationCustomStart
41822>>>>>>>>>>>    //DDB-ValidationCustomEnd
41822>>>>>>>>>>>End_Object   // Cars_Ctype_Id_VT
41823>>>>>>>>>>>//DDB-ValidationEnd
41823>>>>>>>>>>>//DDB-SelectionStart
41823>>>>>>>>>>>//DDB/ ExternalSelectionList sl054  sl054.SL
41823>>>>>>>>>>>Register_Object sl054
41823>>>>>>>>>>>//DDB-SelectionEnd
41823>>>>>>>>>>>
41823>>>>>>>>>>>Class Cars_DataDictionary  is a DataDictionary_Sec
41824>>>>>>>>>>>
41824>>>>>>>>>>>
41824>>>>>>>>>>>    Procedure Construct_Object
41825>>>>>>>>>>>        Forward Send Construct_Object
41827>>>>>>>>>>>        //------------------------------------------------
41827>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
41827>>>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
41827>>>>>>>>>>>        // einai 1     js 03/12/2007
41827>>>>>>>>>>>        //------------------------------------------------  
41827>>>>>>>>>>>        Property Integer piCreateNew            Public  0
41828>>>>>>>>>>>        Property Integer piAud_Old_Tare         Public  0
41829>>>>>>>>>>>        Property Number  pnAud_Old_Pagio        Public  0
41830>>>>>>>>>>>        Property String  psAud_Old_CarID        Public ""
41831>>>>>>>>>>>        Property String  psAud_Old_CarLicense   Public ""
41832>>>>>>>>>>>        //------------------------------------------------
41832>>>>>>>>>>>
41832>>>>>>>>>>>    End_procedure
41833>>>>>>>>>>>
41833>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
41834>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
41836>>>>>>>>>>>        //------------------------------------------------
41836>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
41836>>>>>>>>>>>        // ton pedion js 03/12/2007
41836>>>>>>>>>>>        //------------------------------------------------
41836>>>>>>>>>>>        Set piAud_Old_Tare          to Cars.Car_Tare
41837>>>>>>>>>>>        Set pnAud_Old_Pagio         to Cars.Pagio
41838>>>>>>>>>>>        Set psAud_Old_CarID         to Cars.Car_ID
41839>>>>>>>>>>>        Set psAud_Old_CarLicense    to Cars.Car_License
41840>>>>>>>>>>>        //------------------------------------------------
41840>>>>>>>>>>>     End_Procedure   // New_Current_Record
41841>>>>>>>>>>>
41841>>>>>>>>>>>    Procedure Delete_Main_File
41842>>>>>>>>>>>        //---------------------------------------------
41842>>>>>>>>>>>        // Auditing / Katagrafh allagon
41842>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
41843>>>>>>>>>>>        Date    dDate  Shmer 
41843>>>>>>>>>>>        Integer iMin iHour iSec iLen
41843>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
41847>>>>>>>>>>>        Move iHour  to sHour
41848>>>>>>>>>>>        Move iMin   to sMin
41849>>>>>>>>>>>        Move iSec   to sSec
41850>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
41854>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
41858>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
41862>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
41863>>>>>>>>>>>        
41863>>>>>>>>>>>        // Auditing / Diagrafh 
41863>>>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
41865>>>>>>>>>>>            Get fsLoginUserID to sUser
41866>>>>>>>>>>>            clear gmove
41867>>>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
41868>>>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
41869>>>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
41870>>>>>>>>>>>            move  5                     to gmove.gtypkin_code// Apo Clients
41871>>>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
41872>>>>>>>>>>>            move suser                  to gmove.gplan_code
41873>>>>>>>>>>>            move Cars.Car_ID            to gmove.garticl_recr
41874>>>>>>>>>>>            reread sysrecg
41878>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
41879>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
41880>>>>>>>>>>>            saverecord sysrecg
41881>>>>>>>>>>>            unlock
41882>>>>>>>>>>>>
41882>>>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
41883>>>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
41884>>>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
41885>>>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
41886>>>>>>>>>>>            
41886>>>>>>>>>>>            Move Cars.Car_ID                    to Gmove.Partl_Recr          
41887>>>>>>>>>>>            Move Cars.Car_ID                    to Gmove.Pms_Recr          
41888>>>>>>>>>>>
41888>>>>>>>>>>>            Move (piAud_Old_Tare      (Self))   to Gmove.Prev_Ox_Apobaro
41889>>>>>>>>>>>            Move (pnAud_Old_Pagio     (Self))   to Gmove.Prev_Stoxos1
41890>>>>>>>>>>>            Move (psAud_Old_CarID     (Self))   to Gmove.Prev_Oxhma
41891>>>>>>>>>>>            Move (psAud_Old_CarLicense(Self))   to Gmove.Prev_CN_Prosth
41892>>>>>>>>>>>
41892>>>>>>>>>>>
41892>>>>>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª Ž®ã£˜«¦ª"    to gmove.gmove_aitiol
41893>>>>>>>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
41894>>>>>>>>>>>            saverecord gmove
41895>>>>>>>>>>>        End
41895>>>>>>>>>>>>
41895>>>>>>>>>>>        Forward Send Delete_Main_File
41897>>>>>>>>>>>
41897>>>>>>>>>>>    End_Procedure
41898>>>>>>>>>>>
41898>>>>>>>>>>>     Procedure Creating
41899>>>>>>>>>>>        Forward Send Creating
41901>>>>>>>>>>>        Set piCreateNew to 1
41902>>>>>>>>>>>    End_Procedure   // Creating
41903>>>>>>>>>>>
41903>>>>>>>>>>>
41903>>>>>>>>>>>
41903>>>>>>>>>>>
41903>>>>>>>>>>>    // Update:
41903>>>>>>>>>>>    Procedure Update
41904>>>>>>>>>>>        Forward Send Update
41906>>>>>>>>>>>        move syscurxr.company_code  to cars.car_company
41907>>>>>>>>>>>        move syscurxr.beto_site     to cars.car_bsite
41908>>>>>>>>>>>        // Insert Code Here
41908>>>>>>>>>>>        
41908>>>>>>>>>>>        //---------------------------------------------
41908>>>>>>>>>>>        // Auditing / Katagrafh allagon
41908>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
41909>>>>>>>>>>>        Date    dDate  Shmer 
41909>>>>>>>>>>>        Integer iMin iHour iSec iLen
41909>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
41913>>>>>>>>>>>        Move iHour  to sHour
41914>>>>>>>>>>>        Move iMin   to sMin
41915>>>>>>>>>>>        Move iSec   to sSec
41916>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
41920>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
41924>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
41928>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
41929>>>>>>>>>>>        
41929>>>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
41929>>>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
41931>>>>>>>>>>>            Get fsLoginUserID to sUser
41932>>>>>>>>>>>            If (piCreateNew(Self)=1) Begin
41934>>>>>>>>>>>                clear gmove
41935>>>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
41936>>>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
41937>>>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
41938>>>>>>>>>>>                move  5                     to gmove.gtypkin_code// Apo Clients
41939>>>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
41940>>>>>>>>>>>                move suser                  to gmove.gplan_code
41941>>>>>>>>>>>                move Cars.Car_ID            to gmove.garticl_recr
41942>>>>>>>>>>>                reread sysrecg
41946>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
41947>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
41948>>>>>>>>>>>                saverecord sysrecg
41949>>>>>>>>>>>                unlock
41950>>>>>>>>>>>>
41950>>>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
41951>>>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
41952>>>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
41953>>>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
41954>>>>>>>>>>>
41954>>>>>>>>>>>                Move Cars.Car_ID            to Gmove.Partl_Recr          
41955>>>>>>>>>>>                Move Cars.Car_ID            to Gmove.Pms_Recr          
41956>>>>>>>>>>>
41956>>>>>>>>>>>                Move Cars.Car_Tare          to Gmove.Cur_Ox_Apobaro
41957>>>>>>>>>>>                Move Cars.Pagio             to Gmove.Cur_Stoxos1
41958>>>>>>>>>>>                Move Cars.Car_ID            to Gmove.Cur_Oxhma
41959>>>>>>>>>>>                Move Cars.Car_License       to Gmove.Cur_CN_Prosth
41960>>>>>>>>>>>                
41960>>>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â˜ª Ž®ã£˜«¦ª" to Gmove.Gmove_Aitiol
41961>>>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs  
41962>>>>>>>>>>>                saverecord gmove
41963>>>>>>>>>>>                Set piCreateNew to 0
41964>>>>>>>>>>>            End
41964>>>>>>>>>>>>
41964>>>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
41967>>>>>>>>>>>                Integer isChanged
41967>>>>>>>>>>>                Move 0 to isChanged
41968>>>>>>>>>>>                
41968>>>>>>>>>>>                     If (pnAud_Old_Pagio     (Self)<>Cars.Pagio        ) Move 1 to isChanged
41971>>>>>>>>>>>                Else If (piAud_Old_Tare      (Self)<>Cars.Car_Tare     ) Move 1 to isChanged
41975>>>>>>>>>>>                Else If (psAud_Old_CarID     (Self)<>Cars.Car_ID       ) Move 1 to isChanged
41979>>>>>>>>>>>                Else If (psAud_Old_CarLicense(Self)<>Cars.Car_License  ) Move 1 to isChanged
41983>>>>>>>>>>>                
41983>>>>>>>>>>>                If (isChanged>0) Begin  
41985>>>>>>>>>>>                    clear gmove
41986>>>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
41987>>>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
41988>>>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
41989>>>>>>>>>>>                    move  5                     to gmove.gtypkin_code// Apo Clients
41990>>>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
41991>>>>>>>>>>>                    move suser                  to gmove.gplan_code
41992>>>>>>>>>>>                    move Cars.Car_ID          to gmove.garticl_recr
41993>>>>>>>>>>>                    reread sysrecg
41997>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
41998>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
41999>>>>>>>>>>>                    saverecord sysrecg
42000>>>>>>>>>>>                    unlock
42001>>>>>>>>>>>>
42001>>>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
42002>>>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
42003>>>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
42004>>>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
42005>>>>>>>>>>>                    Move Cars.Car_ID                    to Gmove.Partl_Recr          
42006>>>>>>>>>>>                    Move Cars.Car_ID                    to Gmove.Pms_Recr          
42007>>>>>>>>>>>                    //--                                
42007>>>>>>>>>>>                    Move Cars.Car_Tare                  to Gmove.Cur_Ox_Apobaro
42008>>>>>>>>>>>                    Move Cars.Pagio                     to Gmove.Cur_Stoxos1
42009>>>>>>>>>>>                    Move Cars.Car_ID                    to Gmove.Cur_Oxhma
42010>>>>>>>>>>>                    Move Cars.Car_License               to Gmove.Cur_CN_Prosth
42011>>>>>>>>>>>                    //--
42011>>>>>>>>>>>                    Move (piAud_Old_Tare      (Self))   to Gmove.Prev_Ox_Apobaro    
42012>>>>>>>>>>>                    Move (pnAud_Old_Pagio     (Self))   to Gmove.Prev_Stoxos1       
42013>>>>>>>>>>>                    Move (psAud_Old_CarID     (Self))   to Gmove.Prev_Oxhma         
42014>>>>>>>>>>>                    Move (psAud_Old_CarLicense(Self))   to Gmove.Prev_CN_Prosth
42015>>>>>>>>>>>                                                         
42015>>>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª Ž®ã£˜«¦ª"   to gmove.gmove_aitiol
42016>>>>>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
42017>>>>>>>>>>>                    saverecord gmove
42018>>>>>>>>>>>                    Set piCreateNew to 0
42019>>>>>>>>>>>                End
42019>>>>>>>>>>>>
42019>>>>>>>>>>>            End
42019>>>>>>>>>>>>
42019>>>>>>>>>>>        End
42019>>>>>>>>>>>>
42019>>>>>>>>>>>        
42019>>>>>>>>>>>    End_Procedure   // Update
42020>>>>>>>>>>>
42020>>>>>>>>>>>
42020>>>>>>>>>>>    // Define_Fields:
42020>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
42020>>>>>>>>>>>
42020>>>>>>>>>>>    Procedure Define_Fields
42021>>>>>>>>>>>        Forward Send Define_Fields
42023>>>>>>>>>>>        //DDB-Generated-Code-Location
42023>>>>>>>>>>>        //DDB-DefineFieldStart
42023>>>>>>>>>>>
42023>>>>>>>>>>>        Set Main_File            To Cars.File_Number
42024>>>>>>>>>>>
42024>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
42025>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
42026>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
42027>>>>>>>>>>>
42027>>>>>>>>>>>        // External (System) file structure.............
42027>>>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
42028>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
42029>>>>>>>>>>>
42029>>>>>>>>>>>        // Field-based properties.......................
42029>>>>>>>>>>>
42029>>>>>>>>>>>        // Cars.Car_Recnum
42029>>>>>>>>>>>
42029>>>>>>>>>>>        // Cars.Car_Company
42029>>>>>>>>>>>
42029>>>>>>>>>>>        // Cars.Car_Id
42029>>>>>>>>>>>        Set Field_Options          Field Cars.Car_Id To DD_AUTOFIND   
42030>>>>>>>>>>>        Set Field_Prompt_Object    Field Cars.Car_Id To (sl054(Self))
42031>>>>>>>>>>>        Set Key_Field_State        Field Cars.Car_Id To TRUE
42032>>>>>>>>>>>
42032>>>>>>>>>>>        // Cars.Car_Descr
42032>>>>>>>>>>>        Set Field_Prompt_Object    Field Cars.Car_Descr To (sl054(Self))
42033>>>>>>>>>>>
42033>>>>>>>>>>>        // Cars.Car_License
42033>>>>>>>>>>>
42033>>>>>>>>>>>        // Cars.Car_Driverrecn
42033>>>>>>>>>>>
42033>>>>>>>>>>>        // Cars.Car_Details
42033>>>>>>>>>>>
42033>>>>>>>>>>>        // Cars.Car_Maxm3
42033>>>>>>>>>>>
42033>>>>>>>>>>>        // Cars.Car_Sitew
42033>>>>>>>>>>>
42033>>>>>>>>>>>        // Cars.Car_Tare
42033>>>>>>>>>>>
42033>>>>>>>>>>>        // Cars.Car_Codematch
42033>>>>>>>>>>>
42033>>>>>>>>>>>        // Cars.Car_Driverid
42033>>>>>>>>>>>
42033>>>>>>>>>>>        // Cars.Car_Sn
42033>>>>>>>>>>>
42033>>>>>>>>>>>        // Cars.Car_Lastupdated
42033>>>>>>>>>>>
42033>>>>>>>>>>>        // Cars.Car_Markexp
42033>>>>>>>>>>>
42033>>>>>>>>>>>        // Cars.Car_748tare1
42033>>>>>>>>>>>
42033>>>>>>>>>>>        // Cars.Car_748tare2
42033>>>>>>>>>>>
42033>>>>>>>>>>>        // Cars.Car_748sign
42033>>>>>>>>>>>
42033>>>>>>>>>>>        // Cars.Car_Bsite
42033>>>>>>>>>>>
42033>>>>>>>>>>>        // Cars.Ctype_Id
42033>>>>>>>>>>>        Set Field_Class_Name       Field Cars.Ctype_Id To "dbComboFormsub"
42034>>>>>>>>>>>        Set Field_Value_Table      Field Cars.Ctype_Id To (Cars_Ctype_Id_VT(Self))
42035>>>>>>>>>>>
42035>>>>>>>>>>>        // Cars.Pagio
42035>>>>>>>>>>>
42035>>>>>>>>>>>        // Cars.Parakrat
42035>>>>>>>>>>>
42035>>>>>>>>>>>        // Cars.Car_What
42035>>>>>>>>>>>
42035>>>>>>>>>>>        // Cars.Car_Lc
42035>>>>>>>>>>>
42035>>>>>>>>>>>        // Cars.Car_Ln
42035>>>>>>>>>>>
42035>>>>>>>>>>>        //DDB-DefineFieldEnd
42035>>>>>>>>>>>    End_Procedure    // Define_Fields
42036>>>>>>>>>>>
42036>>>>>>>>>>>    // Field_Defaults:
42036>>>>>>>>>>>    // This procedure is used to establish default field values.
42036>>>>>>>>>>>
42036>>>>>>>>>>>    Procedure Field_Defaults
42037>>>>>>>>>>>        Forward Send Field_Defaults
42039>>>>>>>>>>>        //DDB-Generated-Code-Location
42039>>>>>>>>>>>        //DDB-FieldDefaultStart
42039>>>>>>>>>>>        //DDB-FieldDefaultEnd
42039>>>>>>>>>>>    End_Procedure    // Field_Defaults
42040>>>>>>>>>>>
42040>>>>>>>>>>>End_Class    // Cars_DataDictionary
42041>>>>>>>>>>>//DDB-Selection-pkg-Start
42041>>>>>>>>>>>
42041>>>>>>>>>>>Use sl054.SL         // sl054
42041>>>>>>>>>>>
42041>>>>>>>>>>>//DDB-Selection-pkg-End
42041>>>>>>>>>>>//DDB-FileEnd
42041>>>>>>>>>
42041>>>>>>>>>//AB-IgnoreEnd
42041>>>>>>>>>
42041>>>>>>>>>Object sl054 is a dbModalPanelSub
42043>>>>>>>>>    Set Label to "€¨®œå¦ Ž®ž£á«à¤"
42044>>>>>>>>>    Set Size to 148 420
42045>>>>>>>>>    Set Location to 4 5
42046>>>>>>>>>    Set Exit_Application_Local_State to FALSE
42047>>>>>>>>>    Set Modal_State to FALSE
42048>>>>>>>>>
42048>>>>>>>>>    //AB-DDOStart
42048>>>>>>>>>
42048>>>>>>>>>    Object Cars_DD is a Cars_DataDictionary
42050>>>>>>>>>    End_Object    // Cars_DD
42051>>>>>>>>>
42051>>>>>>>>>    Set Main_DD to (Cars_DD(self))
42052>>>>>>>>>    Set Server to (Cars_DD(self))
42053>>>>>>>>>
42053>>>>>>>>>    //AB-DDOEnd
42053>>>>>>>>>
42053>>>>>>>>>    Object oSelList is a dbListSub
42055>>>>>>>>>        Set Main_File to Cars.File_Number
42056>>>>>>>>>        Set Size to 105 403
42057>>>>>>>>>        Set Location to 6 6
42058>>>>>>>>>
42058>>>>>>>>>        Begin_Row
42061>>>>>>>>>            Entry_Item Cars.Car_id
42062>>>>>>>>>            Entry_Item Cars.Car_descr
42063>>>>>>>>>            Entry_Item Cars.Car_license
42064>>>>>>>>>            Entry_Item Cars.Car_maxm3
42065>>>>>>>>>            Entry_Item Cars.Car_driverid
42066>>>>>>>>>        End_Row
42071>>>>>>>>>
42071>>>>>>>>>        Set Form_Width    item 0 to 80
42072>>>>>>>>>        Set Header_Label  item 0 to "‰à›.Ž®ã£˜«¦ª"
42073>>>>>>>>>        
42073>>>>>>>>>        Set Form_Width    item 1 to 120
42074>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
42075>>>>>>>>>        
42075>>>>>>>>>        Set Form_Width    item 2 to 80
42076>>>>>>>>>        Set Header_Label  item 2 to "€¨ Ÿ.‰¬¡¢¦­¦¨å˜ª"
42077>>>>>>>>>        
42077>>>>>>>>>        Set Form_Width    item 3 to 50
42078>>>>>>>>>        Set Header_Label  item 3 to "Max.m3"
42079>>>>>>>>>        
42079>>>>>>>>>        Set Form_Width    item 4 to 65
42080>>>>>>>>>        Set Header_Label  item 4 to "‰à›.Ž›žš¦ç"
42081>>>>>>>>>        
42081>>>>>>>>>    End_Object    // oSelList
42082>>>>>>>>>
42082>>>>>>>>>    Object oOK_bn is a ButtonSub
42084>>>>>>>>>        Set Label to "&„§ ¢¦šã"
42085>>>>>>>>>        Set Location to 114 249
42086>>>>>>>>>
42086>>>>>>>>>        //AB-StoreStart
42086>>>>>>>>>        Procedure OnClick
42088>>>>>>>>>            Send OK To (oSelList(current_object))
42089>>>>>>>>>        End_Procedure
42090>>>>>>>>>        //AB-StoreEnd
42090>>>>>>>>>
42090>>>>>>>>>    End_Object    // oOK_bn
42091>>>>>>>>>
42091>>>>>>>>>    Object oCancel_bn is a ButtonSub
42093>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
42094>>>>>>>>>        Set Location to 114 305
42095>>>>>>>>>
42095>>>>>>>>>        //AB-StoreStart
42095>>>>>>>>>        Procedure OnClick
42097>>>>>>>>>            Send Cancel To (oSelList(current_object))
42098>>>>>>>>>        End_Procedure
42099>>>>>>>>>        //AB-StoreEnd
42099>>>>>>>>>
42099>>>>>>>>>    End_Object    // oCancel_bn
42100>>>>>>>>>
42100>>>>>>>>>    Object oSearch_bn is a ButtonSub
42102>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
42103>>>>>>>>>        Set Location to 114 359
42104>>>>>>>>>
42104>>>>>>>>>        //AB-StoreStart
42104>>>>>>>>>        Procedure OnClick
42106>>>>>>>>>            Send Search To (oSelList(current_object))
42107>>>>>>>>>        End_Procedure
42108>>>>>>>>>        //AB-StoreEnd
42108>>>>>>>>>
42108>>>>>>>>>    End_Object    // oSearch_bn
42109>>>>>>>>>
42109>>>>>>>>>
42109>>>>>>>>>    //AB-StoreStart
42109>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
42110>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
42111>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
42112>>>>>>>>>    //AB-StoreEnd
42112>>>>>>>>>
42112>>>>>>>>>End_Object    // sl054
42113>>>>>>>>>
42113>>>>>>>>>//AB/ End_Object    // prj
42113>>>>>>>Use sl053.SL         // sl053
INCLUDING FILE: SL053.SL
42113>>>>>>>>>//AB/ Project sl053:pumps
42113>>>>>>>>>//AB/ Object prj is a Lookup_Project
42113>>>>>>>>>//AB/     Set ProjectName to "sl053:pumps"
42113>>>>>>>>>//AB/     Set ProjectFileName to "sl053.SL"
42113>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
42113>>>>>>>>>
42113>>>>>>>>>// Project Object Structure
42113>>>>>>>>>//   sl053 is a dbModalPanelSub
42113>>>>>>>>>//     Pumps_DD is a DataDictionary
42113>>>>>>>>>//     oSelList is a dbListSub
42113>>>>>>>>>//     oOK_bn is a ButtonSub
42113>>>>>>>>>//     oCancel_bn is a ButtonSub
42113>>>>>>>>>//     oSearch_bn is a ButtonSub
42113>>>>>>>>>
42113>>>>>>>>>// Register all objects
42113>>>>>>>>>Register_Object oCancel_bn
42113>>>>>>>>>Register_Object oOK_bn
42113>>>>>>>>>Register_Object oSearch_bn
42113>>>>>>>>>Register_Object oSelList
42113>>>>>>>>>Register_Object Pumps_DD
42113>>>>>>>>>Register_Object sl053
42113>>>>>>>>>
42113>>>>>>>>>
42113>>>>>>>>>//AB-IgnoreStart
42113>>>>>>>>>
42113>>>>>>>>>Use DFAllEnt.pkg
42113>>>>>>>>>Use dbList.Sub
42113>>>>>>>>>Use Button.Sub
42113>>>>>>>>>
42113>>>>>>>>>
42113>>>>>>>>>Use Pumps.DD
INCLUDING FILE: PUMPS.DD
42113>>>>>>>>>>>//DDB-FileStart
42113>>>>>>>>>>>//DDB-HeaderStart
42113>>>>>>>>>>>
42113>>>>>>>>>>>// File Name : PUMPS.DD
42113>>>>>>>>>>>// Class Name: Pumps_DataDictionary
42113>>>>>>>>>>>// Revision  : 18
42113>>>>>>>>>>>// Version   : 2
42113>>>>>>>>>>>
42113>>>>>>>>>>>Use  Windows           // Basic Definitions
42113>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
42113>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
42113>>>>>>>>>>>
42113>>>>>>>>>>>Open Pumps
42115>>>>>>>>>>>Open Gmove
42117>>>>>>>>>>>Open Sysrecg
42119>>>>>>>>>>>
42119>>>>>>>>>>>//DDB-HeaderEnd
42119>>>>>>>>>>>//DDB-ValidationStart
42119>>>>>>>>>>>
42119>>>>>>>>>>>Register_Object Pumps_Ctype_Id_VT
42119>>>>>>>>>>>
42119>>>>>>>>>>>Object Pumps_Ctype_Id_VT  is a CodeValidationTable
42121>>>>>>>>>>>    Set Type_Value        To "PUMPSTYPE"
42122>>>>>>>>>>>    Set Validate_State    To FALSE
42123>>>>>>>>>>>    Set Allow_Blank_State To TRUE
42124>>>>>>>>>>>    //DDB-ValidationCustomStart
42124>>>>>>>>>>>    //DDB-ValidationCustomEnd
42124>>>>>>>>>>>End_Object   // Pumps_Ctype_Id_VT
42125>>>>>>>>>>>//DDB-ValidationEnd
42125>>>>>>>>>>>//DDB-SelectionStart
42125>>>>>>>>>>>//DDB/ ExternalSelectionList sl053  sl053.SL
42125>>>>>>>>>>>Register_Object sl053
42125>>>>>>>>>>>//DDB-SelectionEnd
42125>>>>>>>>>>>
42125>>>>>>>>>>>Class Pumps_DataDictionary  is a DataDictionary_Sec
42126>>>>>>>>>>>
42126>>>>>>>>>>>    Procedure Construct_Object
42127>>>>>>>>>>>        Forward Send Construct_Object
42129>>>>>>>>>>>        //------------------------------------------------
42129>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
42129>>>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
42129>>>>>>>>>>>        // einai 1     js 03/12/2007
42129>>>>>>>>>>>        //------------------------------------------------  
42129>>>>>>>>>>>        Property Integer piCreateNew            Public  0
42130>>>>>>>>>>>        Property Number  pnAud_Old_M3           Public  0
42131>>>>>>>>>>>        Property Integer piAud_Old_Pagio        Public  0
42132>>>>>>>>>>>        Property String  psAud_Old_PumpID       Public ""
42133>>>>>>>>>>>        Property String  psAud_Old_License      Public ""
42134>>>>>>>>>>>        //------------------------------------------------
42134>>>>>>>>>>>
42134>>>>>>>>>>>    End_procedure
42135>>>>>>>>>>>
42135>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
42136>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
42138>>>>>>>>>>>        //------------------------------------------------
42138>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
42138>>>>>>>>>>>        // ton pedion js 03/12/2007
42138>>>>>>>>>>>        //------------------------------------------------
42138>>>>>>>>>>>        Set pnAud_Old_M3        to Pumps.PriceM3
42139>>>>>>>>>>>        Set piAud_Old_Pagio     to Pumps.PagioMin
42140>>>>>>>>>>>        Set psAud_Old_PumpID    to Pumps.Pump_ID
42141>>>>>>>>>>>        Set psAud_Old_License   to Pumps.Pump_License
42142>>>>>>>>>>>        //------------------------------------------------
42142>>>>>>>>>>>     End_Procedure   // New_Current_Record
42143>>>>>>>>>>>
42143>>>>>>>>>>>    Procedure Delete_Main_File
42144>>>>>>>>>>>        //---------------------------------------------
42144>>>>>>>>>>>        // Auditing / Katagrafh allagon
42144>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
42145>>>>>>>>>>>        Date    dDate  Shmer 
42145>>>>>>>>>>>        Integer iMin iHour iSec iLen
42145>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
42149>>>>>>>>>>>        Move iHour  to sHour
42150>>>>>>>>>>>        Move iMin   to sMin
42151>>>>>>>>>>>        Move iSec   to sSec
42152>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
42156>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
42160>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
42164>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
42165>>>>>>>>>>>        
42165>>>>>>>>>>>        // Auditing / Diagrafh 
42165>>>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
42167>>>>>>>>>>>            Get fsLoginUserID to sUser
42168>>>>>>>>>>>            clear gmove
42169>>>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
42170>>>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
42171>>>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
42172>>>>>>>>>>>            move  6                     to gmove.gtypkin_code// Apo Clients
42173>>>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
42174>>>>>>>>>>>            move suser                  to gmove.gplan_code
42175>>>>>>>>>>>            move Pumps.Pump_ID          to gmove.garticl_recr
42176>>>>>>>>>>>            reread sysrecg
42180>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
42181>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
42182>>>>>>>>>>>            saverecord sysrecg
42183>>>>>>>>>>>            unlock
42184>>>>>>>>>>>>
42184>>>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
42185>>>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
42186>>>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
42187>>>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
42188>>>>>>>>>>>            
42188>>>>>>>>>>>            Move Pumps.Pump_ID                  to Gmove.Partl_Recr          
42189>>>>>>>>>>>            Move Pumps.Pump_ID                  to Gmove.Pms_Recr          
42190>>>>>>>>>>>
42190>>>>>>>>>>>            Move (pnAud_Old_M3     (Self))      to Gmove.Prev_Ant_Min_M3
42191>>>>>>>>>>>            Move (piAud_Old_Pagio  (Self))      to Gmove.Prev_Stoxos1
42192>>>>>>>>>>>            Move (psAud_Old_License(Self))      to Gmove.Prev_CN_Prosth
42193>>>>>>>>>>>            Move (psAud_Old_PumpID (Self))      to Gmove.Prev_Antlia
42194>>>>>>>>>>>
42194>>>>>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª €¤«¢å˜ª"    to gmove.gmove_aitiol
42195>>>>>>>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
42196>>>>>>>>>>>            saverecord gmove
42197>>>>>>>>>>>        End
42197>>>>>>>>>>>>
42197>>>>>>>>>>>        Forward Send Delete_Main_File
42199>>>>>>>>>>>
42199>>>>>>>>>>>    End_Procedure
42200>>>>>>>>>>>
42200>>>>>>>>>>>     Procedure Creating
42201>>>>>>>>>>>        Forward Send Creating
42203>>>>>>>>>>>        Set piCreateNew to 1
42204>>>>>>>>>>>    End_Procedure   // Creating
42205>>>>>>>>>>>
42205>>>>>>>>>>>
42205>>>>>>>>>>>    // Update:
42205>>>>>>>>>>>    Procedure Update
42206>>>>>>>>>>>        Forward Send Update
42208>>>>>>>>>>>        Move SysCurXR.Company_Code  to Pumps.Pump_Company
42209>>>>>>>>>>>        Move SysCurXR.Beto_Site     to Pumps.Pump_SiteW
42210>>>>>>>>>>>
42210>>>>>>>>>>>
42210>>>>>>>>>>>        //---------------------------------------------
42210>>>>>>>>>>>        // Auditing / Katagrafh allagon
42210>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
42211>>>>>>>>>>>        Date    dDate  Shmer 
42211>>>>>>>>>>>        Integer iMin iHour iSec iLen
42211>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
42215>>>>>>>>>>>        Move iHour  to sHour
42216>>>>>>>>>>>        Move iMin   to sMin
42217>>>>>>>>>>>        Move iSec   to sSec
42218>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
42222>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
42226>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
42230>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
42231>>>>>>>>>>>        
42231>>>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
42231>>>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
42233>>>>>>>>>>>            Get fsLoginUserID to sUser
42234>>>>>>>>>>>            If (piCreateNew(Self)=1) Begin
42236>>>>>>>>>>>                clear gmove
42237>>>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
42238>>>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
42239>>>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
42240>>>>>>>>>>>                move  6                     to gmove.gtypkin_code// Apo Clients
42241>>>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
42242>>>>>>>>>>>                move suser                  to gmove.gplan_code
42243>>>>>>>>>>>                move Pumps.Pump_ID          to gmove.garticl_recr
42244>>>>>>>>>>>                reread sysrecg
42248>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
42249>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
42250>>>>>>>>>>>                saverecord sysrecg
42251>>>>>>>>>>>                unlock
42252>>>>>>>>>>>>
42252>>>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
42253>>>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
42254>>>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
42255>>>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
42256>>>>>>>>>>>
42256>>>>>>>>>>>                Move Pumps.Pump_ID         to Gmove.Partl_Recr          
42257>>>>>>>>>>>                Move Pumps.Pump_ID         to Gmove.Pms_Recr          
42258>>>>>>>>>>>
42258>>>>>>>>>>>                move Pumps.Pump_ID          to gmove.Cur_Antlia
42259>>>>>>>>>>>                Move Pumps.PriceM3          to Gmove.Cur_Stoxos1
42260>>>>>>>>>>>                Move Pumps.PagioMin         to Gmove.Cur_Ant_Min_M3
42261>>>>>>>>>>>                Move Pumps.Pump_License     to Gmove.Cur_CN_Prosth
42262>>>>>>>>>>>
42262>>>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â˜ª €¤«¢å˜ª" to Gmove.Gmove_Aitiol
42263>>>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs  
42264>>>>>>>>>>>                saverecord gmove
42265>>>>>>>>>>>                Set piCreateNew to 0
42266>>>>>>>>>>>            End
42266>>>>>>>>>>>>
42266>>>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
42269>>>>>>>>>>>                Integer isChanged
42269>>>>>>>>>>>                Move 0 to isChanged
42270>>>>>>>>>>>                
42270>>>>>>>>>>>                     If (pnAud_Old_M3      (Self)<>Pumps.PriceM3     ) Move 1 to isChanged
42273>>>>>>>>>>>                Else If (piAud_Old_Pagio   (Self)<>Pumps.PagioMin    ) Move 1 to isChanged
42277>>>>>>>>>>>                Else If (psAud_Old_PumpID  (Self)<>Pumps.Pump_ID     ) Move 1 to isChanged
42281>>>>>>>>>>>                Else If (psAud_Old_License (Self)<>Pumps.Pump_License) Move 1 to isChanged
42285>>>>>>>>>>>
42285>>>>>>>>>>>                If (isChanged>0) Begin  
42287>>>>>>>>>>>                    clear gmove
42288>>>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
42289>>>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
42290>>>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
42291>>>>>>>>>>>                    move  6                     to gmove.gtypkin_code// Apo Clients
42292>>>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
42293>>>>>>>>>>>                    move suser                  to gmove.gplan_code
42294>>>>>>>>>>>                    move Pumps.Pump_ID          to gmove.garticl_recr
42295>>>>>>>>>>>                    reread sysrecg
42299>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
42300>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
42301>>>>>>>>>>>                    saverecord sysrecg
42302>>>>>>>>>>>                    unlock
42303>>>>>>>>>>>>
42303>>>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
42304>>>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
42305>>>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
42306>>>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
42307>>>>>>>>>>>                    Move Pumps.Pump_ID                  to Gmove.Partl_Recr          
42308>>>>>>>>>>>                    Move Pumps.Pump_ID                  to Gmove.Pms_Recr          
42309>>>>>>>>>>>                    //--                                
42309>>>>>>>>>>>                    move Pumps.Pump_ID                  to gmove.Cur_Antlia
42310>>>>>>>>>>>                    Move Pumps.PriceM3                  to Gmove.Cur_Stoxos1
42311>>>>>>>>>>>                    Move Pumps.PagioMin                 to Gmove.Cur_Ant_Min_M3
42312>>>>>>>>>>>                    Move Pumps.Pump_License             to Gmove.Cur_CN_Prosth
42313>>>>>>>>>>>                    //--
42313>>>>>>>>>>>                    Move (pnAud_Old_M3     (Self))      to Gmove.Prev_Stoxos1      
42314>>>>>>>>>>>                    Move (piAud_Old_Pagio  (Self))      to Gmove.Prev_Ant_Min_M3   
42315>>>>>>>>>>>                    Move (psAud_Old_License(Self))      to Gmove.Prev_CN_Prosth
42316>>>>>>>>>>>                    Move (psAud_Old_PumpID (Self))      to Gmove.Prev_Antlia
42317>>>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª €¤«¢å˜ª"    to gmove.gmove_aitiol
42318>>>>>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
42319>>>>>>>>>>>                    saverecord gmove
42320>>>>>>>>>>>                    Set piCreateNew to 0
42321>>>>>>>>>>>                End
42321>>>>>>>>>>>>
42321>>>>>>>>>>>            End
42321>>>>>>>>>>>>
42321>>>>>>>>>>>        End
42321>>>>>>>>>>>>
42321>>>>>>>>>>>
42321>>>>>>>>>>>
42321>>>>>>>>>>>
42321>>>>>>>>>>>    End_Procedure   // Update
42322>>>>>>>>>>>
42322>>>>>>>>>>>
42322>>>>>>>>>>>    // Define_Fields:
42322>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
42322>>>>>>>>>>>
42322>>>>>>>>>>>    Procedure Define_Fields
42323>>>>>>>>>>>        Forward Send Define_Fields
42325>>>>>>>>>>>        //DDB-Generated-Code-Location
42325>>>>>>>>>>>        //DDB-DefineFieldStart
42325>>>>>>>>>>>
42325>>>>>>>>>>>        Set Main_File            To Pumps.File_Number
42326>>>>>>>>>>>
42326>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
42327>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
42328>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
42329>>>>>>>>>>>
42329>>>>>>>>>>>        // External (System) file structure.............
42329>>>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
42330>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
42331>>>>>>>>>>>
42331>>>>>>>>>>>        // Field-based properties.......................
42331>>>>>>>>>>>
42331>>>>>>>>>>>        // Pumps.Pump_Recnum
42331>>>>>>>>>>>
42331>>>>>>>>>>>        // Pumps.Pump_Company
42331>>>>>>>>>>>
42331>>>>>>>>>>>        // Pumps.Pump_Id
42331>>>>>>>>>>>        Set Field_Options          Field Pumps.Pump_Id To DD_AUTOFIND   
42332>>>>>>>>>>>        Set Field_Prompt_Object    Field Pumps.Pump_Id To (sl053(Self))
42333>>>>>>>>>>>        Set Key_Field_State        Field Pumps.Pump_Id To TRUE
42334>>>>>>>>>>>
42334>>>>>>>>>>>        // Pumps.Pump_Descr
42334>>>>>>>>>>>        Set Field_Prompt_Object    Field Pumps.Pump_Descr To (sl053(Self))
42335>>>>>>>>>>>
42335>>>>>>>>>>>        // Pumps.Pump_License
42335>>>>>>>>>>>
42335>>>>>>>>>>>        // Pumps.Pump_Mhkos
42335>>>>>>>>>>>
42335>>>>>>>>>>>        // Pumps.Pump_Mhkosch
42335>>>>>>>>>>>
42335>>>>>>>>>>>        // Pumps.Pump_Codematch
42335>>>>>>>>>>>
42335>>>>>>>>>>>        // Pumps.Pump_Sitew
42335>>>>>>>>>>>
42335>>>>>>>>>>>        // Pumps.Pump_Driver
42335>>>>>>>>>>>
42335>>>>>>>>>>>        // Pumps.Pump_Bsite
42335>>>>>>>>>>>
42335>>>>>>>>>>>        // Pumps.Ctype_Id
42335>>>>>>>>>>>        Set Field_Class_Name       Field Pumps.Ctype_Id To "dbComboFormsub"
42336>>>>>>>>>>>        Set Field_Value_Table      Field Pumps.Ctype_Id To (Pumps_Ctype_Id_VT(Self))
42337>>>>>>>>>>>
42337>>>>>>>>>>>        // Pumps.Pagiomin
42337>>>>>>>>>>>
42337>>>>>>>>>>>        // Pumps.Pricem3
42337>>>>>>>>>>>
42337>>>>>>>>>>>        // Pumps.Parakrat
42337>>>>>>>>>>>
42337>>>>>>>>>>>        // Pumps.Pump_What
42337>>>>>>>>>>>
42337>>>>>>>>>>>        // Pumps.Pump_Lc
42337>>>>>>>>>>>
42337>>>>>>>>>>>        // Pumps.Pump_Ln
42337>>>>>>>>>>>
42337>>>>>>>>>>>        //DDB-DefineFieldEnd
42337>>>>>>>>>>>    End_Procedure    // Define_Fields
42338>>>>>>>>>>>
42338>>>>>>>>>>>    // Field_Defaults:
42338>>>>>>>>>>>    // This procedure is used to establish default field values.
42338>>>>>>>>>>>
42338>>>>>>>>>>>    Procedure Field_Defaults
42339>>>>>>>>>>>        Forward Send Field_Defaults
42341>>>>>>>>>>>        //DDB-Generated-Code-Location
42341>>>>>>>>>>>        //DDB-FieldDefaultStart
42341>>>>>>>>>>>        //DDB-FieldDefaultEnd
42341>>>>>>>>>>>    End_Procedure    // Field_Defaults
42342>>>>>>>>>>>
42342>>>>>>>>>>>End_Class    // Pumps_DataDictionary
42343>>>>>>>>>>>//DDB-Selection-pkg-Start
42343>>>>>>>>>>>
42343>>>>>>>>>>>Use sl053.SL         // sl053
42343>>>>>>>>>>>
42343>>>>>>>>>>>//DDB-Selection-pkg-End
42343>>>>>>>>>>>//DDB-FileEnd
42343>>>>>>>>>
42343>>>>>>>>>//AB-IgnoreEnd
42343>>>>>>>>>
42343>>>>>>>>>Object sl053 is a dbModalPanelSub
42345>>>>>>>>>    Set Label to "€¨®œå¦ €¤«¢ é¤"
42346>>>>>>>>>    Set Size to 148 325
42347>>>>>>>>>    Set Location to 4 5
42348>>>>>>>>>    Set Exit_Application_Local_State to FALSE
42349>>>>>>>>>    Set Modal_State to FALSE
42350>>>>>>>>>
42350>>>>>>>>>    //AB-DDOStart
42350>>>>>>>>>
42350>>>>>>>>>    Object Pumps_DD is a Pumps_DataDictionary
42352>>>>>>>>>    End_Object    // Pumps_DD
42353>>>>>>>>>
42353>>>>>>>>>    Set Main_DD to (Pumps_DD(self))
42354>>>>>>>>>    Set Server to (Pumps_DD(self))
42355>>>>>>>>>
42355>>>>>>>>>    //AB-DDOEnd
42355>>>>>>>>>
42355>>>>>>>>>    Object oSelList is a dbListSub
42357>>>>>>>>>        Set Main_File to Pumps.File_Number
42358>>>>>>>>>        Set Size to 105 309
42359>>>>>>>>>        Set Location to 6 6
42360>>>>>>>>>
42360>>>>>>>>>        Begin_Row
42363>>>>>>>>>            Entry_Item Pumps.Pump_id
42364>>>>>>>>>            Entry_Item Pumps.Pump_descr
42365>>>>>>>>>            Entry_Item Pumps.Pump_license
42366>>>>>>>>>            Entry_Item Pumps.Pump_mhkos
42367>>>>>>>>>        End_Row
42372>>>>>>>>>
42372>>>>>>>>>        Set Form_Width    item 0 to 70
42373>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª €¤«¢å˜ª"
42374>>>>>>>>>        
42374>>>>>>>>>        Set Form_Width    item 1 to 120
42375>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
42376>>>>>>>>>        
42376>>>>>>>>>        Set Form_Width    item 2 to 65
42377>>>>>>>>>        Set Header_Label  item 2 to " ¤˜¡å›˜"
42378>>>>>>>>>        
42378>>>>>>>>>        Set Form_Width    item 3 to 46
42379>>>>>>>>>        Set Header_Label  item 3 to "‹ã¡¦ª"
42380>>>>>>>>>        
42380>>>>>>>>>    End_Object    // oSelList
42381>>>>>>>>>
42381>>>>>>>>>    Object oOK_bn is a ButtonSub
42383>>>>>>>>>        Set Label to "&„§ ¢¦šã"
42384>>>>>>>>>        Set Location to 114 157
42385>>>>>>>>>
42385>>>>>>>>>        //AB-StoreStart
42385>>>>>>>>>        Procedure OnClick
42387>>>>>>>>>            Send OK To (oSelList(current_object))
42388>>>>>>>>>        End_Procedure
42389>>>>>>>>>        //AB-StoreEnd
42389>>>>>>>>>
42389>>>>>>>>>    End_Object    // oOK_bn
42390>>>>>>>>>
42390>>>>>>>>>    Object oCancel_bn is a ButtonSub
42392>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
42393>>>>>>>>>        Set Location to 114 212
42394>>>>>>>>>
42394>>>>>>>>>        //AB-StoreStart
42394>>>>>>>>>        Procedure OnClick
42396>>>>>>>>>            Send Cancel To (oSelList(current_object))
42397>>>>>>>>>        End_Procedure
42398>>>>>>>>>        //AB-StoreEnd
42398>>>>>>>>>
42398>>>>>>>>>    End_Object    // oCancel_bn
42399>>>>>>>>>
42399>>>>>>>>>    Object oSearch_bn is a ButtonSub
42401>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
42402>>>>>>>>>        Set Location to 114 267
42403>>>>>>>>>
42403>>>>>>>>>        //AB-StoreStart
42403>>>>>>>>>        Procedure OnClick
42405>>>>>>>>>            Send Search To (oSelList(current_object))
42406>>>>>>>>>        End_Procedure
42407>>>>>>>>>        //AB-StoreEnd
42407>>>>>>>>>
42407>>>>>>>>>    End_Object    // oSearch_bn
42408>>>>>>>>>
42408>>>>>>>>>
42408>>>>>>>>>    //AB-StoreStart
42408>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
42409>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
42410>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
42411>>>>>>>>>    //AB-StoreEnd
42411>>>>>>>>>
42411>>>>>>>>>End_Object    // sl053
42412>>>>>>>>>
42412>>>>>>>>>//AB/ End_Object    // prj
42412>>>>>>>Use sl064.SL         // sl064
INCLUDING FILE: SL064.SL
42412>>>>>>>>>//AB/ Project sl064 : Zones
42412>>>>>>>>>//AB/ Object prj is a Lookup_Project
42412>>>>>>>>>//AB/     Set ProjectName to "sl064 : Zones"
42412>>>>>>>>>//AB/     Set ProjectFileName to "sl064.SL"
42412>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
42412>>>>>>>>>
42412>>>>>>>>>// Project Object Structure
42412>>>>>>>>>//   sl064 is a dbModalPanelSub
42412>>>>>>>>>//     Zones_DD is a DataDictionary
42412>>>>>>>>>//     oSelList is a dbListSub
42412>>>>>>>>>//     oOK_bn is a ButtonSub
42412>>>>>>>>>//     oCancel_bn is a ButtonSub
42412>>>>>>>>>//     oSearch_bn is a ButtonSub
42412>>>>>>>>>
42412>>>>>>>>>// Register all objects
42412>>>>>>>>>Register_Object oCancel_bn
42412>>>>>>>>>Register_Object oOK_bn
42412>>>>>>>>>Register_Object oSearch_bn
42412>>>>>>>>>Register_Object oSelList
42412>>>>>>>>>Register_Object sl064
42412>>>>>>>>>Register_Object Zones_DD
42412>>>>>>>>>
42412>>>>>>>>>
42412>>>>>>>>>//AB-IgnoreStart
42412>>>>>>>>>
42412>>>>>>>>>Use DFAllEnt.pkg
42412>>>>>>>>>Use dbList.Sub
42412>>>>>>>>>Use Button.Sub
42412>>>>>>>>>
42412>>>>>>>>>
42412>>>>>>>>>Use ZONES.DD
INCLUDING FILE: ZONES.DD
42412>>>>>>>>>>>//DDB-FileStart
42412>>>>>>>>>>>//DDB-HeaderStart
42412>>>>>>>>>>>
42412>>>>>>>>>>>// File Name : ZONES.DD
42412>>>>>>>>>>>// Class Name: Zones_DataDictionary
42412>>>>>>>>>>>// Revision  : 4
42412>>>>>>>>>>>// Version   : 2
42412>>>>>>>>>>>
42412>>>>>>>>>>>Use  Windows           // Basic Definitions
42412>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
42412>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
42412>>>>>>>>>>>
42412>>>>>>>>>>>Open Zones
INCLUDING FILE: ZONES.FD
42414>>>>>>>>>>>Open Brzones
42416>>>>>>>>>>>
42416>>>>>>>>>>>//DDB-HeaderEnd
42416>>>>>>>>>>>//DDB-SelectionStart
42416>>>>>>>>>>>//DDB/ ExternalSelectionList sl064  sl064.SL
42416>>>>>>>>>>>Register_Object sl064
42416>>>>>>>>>>>//DDB-SelectionEnd
42416>>>>>>>>>>>
42416>>>>>>>>>>>Class Zones_DataDictionary  is a DataDictionary_Sec
42417>>>>>>>>>>>
42417>>>>>>>>>>>    // Define_Fields:
42417>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
42417>>>>>>>>>>>
42417>>>>>>>>>>>    Procedure Define_Fields
42418>>>>>>>>>>>        Forward Send Define_Fields
42420>>>>>>>>>>>        //DDB-Generated-Code-Location
42420>>>>>>>>>>>        //DDB-DefineFieldStart
42420>>>>>>>>>>>
42420>>>>>>>>>>>        Set Main_File            To Zones.File_Number
42421>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
42422>>>>>>>>>>>
42422>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
42423>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
42424>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
42425>>>>>>>>>>>
42425>>>>>>>>>>>        // Child (Client) file structure................
42425>>>>>>>>>>>        Send Add_Client_File  Brzones.File_Number
42426>>>>>>>>>>>
42426>>>>>>>>>>>        // Field-based properties.......................
42426>>>>>>>>>>>
42426>>>>>>>>>>>        // Zones.Zone_Id
42426>>>>>>>>>>>        Set Field_Options          Field Zones.Zone_Id To DD_AUTOFIND   
42427>>>>>>>>>>>        Set Field_Prompt_Object    Field Zones.Zone_Id To (sl064(Self))
42428>>>>>>>>>>>        Set Key_Field_State        Field Zones.Zone_Id To TRUE
42429>>>>>>>>>>>
42429>>>>>>>>>>>        // Zones.Zone_Descr
42429>>>>>>>>>>>        Set Field_Prompt_Object    Field Zones.Zone_Descr To (sl064(Self))
42430>>>>>>>>>>>
42430>>>>>>>>>>>        //DDB-DefineFieldEnd
42430>>>>>>>>>>>    End_Procedure    // Define_Fields
42431>>>>>>>>>>>
42431>>>>>>>>>>>    // Field_Defaults:
42431>>>>>>>>>>>    // This procedure is used to establish default field values.
42431>>>>>>>>>>>
42431>>>>>>>>>>>    Procedure Field_Defaults
42432>>>>>>>>>>>        Forward Send Field_Defaults
42434>>>>>>>>>>>        //DDB-Generated-Code-Location
42434>>>>>>>>>>>        //DDB-FieldDefaultStart
42434>>>>>>>>>>>        //DDB-FieldDefaultEnd
42434>>>>>>>>>>>    End_Procedure    // Field_Defaults
42435>>>>>>>>>>>
42435>>>>>>>>>>>End_Class    // Zones_DataDictionary
42436>>>>>>>>>>>//DDB-Selection-pkg-Start
42436>>>>>>>>>>>
42436>>>>>>>>>>>Use sl064.SL         // sl064
42436>>>>>>>>>>>
42436>>>>>>>>>>>//DDB-Selection-pkg-End
42436>>>>>>>>>>>//DDB-FileEnd
42436>>>>>>>>>
42436>>>>>>>>>//AB-IgnoreEnd
42436>>>>>>>>>
42436>>>>>>>>>CD_Popup_Object sl064 is a dbModalPanelSub
42455>>>>>>>>>    Set Label to "…é¤œª"
42456>>>>>>>>>    Set Size to 148 297
42457>>>>>>>>>    Set Location to 4 5
42458>>>>>>>>>    Set Exit_Application_Local_State to FALSE
42459>>>>>>>>>    Set Modal_State to FALSE
42460>>>>>>>>>
42460>>>>>>>>>    //AB-DDOStart
42460>>>>>>>>>
42460>>>>>>>>>    Object Zones_DD is a Zones_DataDictionary
42462>>>>>>>>>    End_Object    // Zones_DD
42463>>>>>>>>>
42463>>>>>>>>>    Set Main_DD to (Zones_DD(self))
42464>>>>>>>>>    Set Server to (Zones_DD(self))
42465>>>>>>>>>
42465>>>>>>>>>    //AB-DDOEnd
42465>>>>>>>>>
42465>>>>>>>>>    Object oSelList is a dbListSub
42467>>>>>>>>>        Set Main_File to Zones.File_Number
42468>>>>>>>>>        Set Size to 105 280
42469>>>>>>>>>        Set Location to 6 6
42470>>>>>>>>>
42470>>>>>>>>>        Begin_Row
42473>>>>>>>>>            Entry_Item Zones.Zone_id
42474>>>>>>>>>            Entry_Item Zones.Zone_descr
42475>>>>>>>>>        End_Row
42480>>>>>>>>>
42480>>>>>>>>>        Set Form_Width    item 0 to 73
42481>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
42482>>>>>>>>>        
42482>>>>>>>>>        Set Form_Width    item 1 to 199
42483>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
42484>>>>>>>>>        
42484>>>>>>>>>    End_Object    // oSelList
42485>>>>>>>>>
42485>>>>>>>>>    Object oOK_bn is a ButtonSub
42487>>>>>>>>>        Set Label to "&„§ ¢¦šã"
42488>>>>>>>>>        Set Location to 115 126
42489>>>>>>>>>
42489>>>>>>>>>        //AB-StoreStart
42489>>>>>>>>>        Procedure OnClick
42491>>>>>>>>>            Send OK To (oSelList(current_object))
42492>>>>>>>>>        End_Procedure
42493>>>>>>>>>        //AB-StoreEnd
42493>>>>>>>>>
42493>>>>>>>>>    End_Object    // oOK_bn
42494>>>>>>>>>
42494>>>>>>>>>    Object oCancel_bn is a ButtonSub
42496>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
42497>>>>>>>>>        Set Location to 115 181
42498>>>>>>>>>
42498>>>>>>>>>        //AB-StoreStart
42498>>>>>>>>>        Procedure OnClick
42500>>>>>>>>>            Send Cancel To (oSelList(current_object))
42501>>>>>>>>>        End_Procedure
42502>>>>>>>>>        //AB-StoreEnd
42502>>>>>>>>>
42502>>>>>>>>>    End_Object    // oCancel_bn
42503>>>>>>>>>
42503>>>>>>>>>    Object oSearch_bn is a ButtonSub
42505>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
42506>>>>>>>>>        Set Location to 115 236
42507>>>>>>>>>
42507>>>>>>>>>        //AB-StoreStart
42507>>>>>>>>>        Procedure OnClick
42509>>>>>>>>>            Send Search To (oSelList(current_object))
42510>>>>>>>>>        End_Procedure
42511>>>>>>>>>        //AB-StoreEnd
42511>>>>>>>>>
42511>>>>>>>>>    End_Object    // oSearch_bn
42512>>>>>>>>>
42512>>>>>>>>>
42512>>>>>>>>>    //AB-StoreStart
42512>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
42513>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
42514>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
42515>>>>>>>>>    //AB-StoreEnd
42515>>>>>>>>>
42515>>>>>>>>>CD_End_Object    // sl064
42517>>>>>>>>>>
42517>>>>>>>>>
42517>>>>>>>>>//AB/ End_Object    // prj
42517>>>>>>>
42517>>>>>>>//DDB-Selection-pkg-End
42517>>>>>>>//DDB-FileEnd
42517>>>>>
42517>>>>>//AB-IgnoreEnd
42517>>>>>
42517>>>>>Object sl014 is a dbModalPanelSub
42519>>>>>
42519>>>>>    //AB-StoreTopStart
42519>>>>>                                
42519>>>>>    Property String psModule        Public ''
42521>>>>>    Property String psClient        Public ''
42523>>>>>    Property String psPtyppar       Public ''
42525>>>>>    Property String psCtypkin       Public ''
42527>>>>>    Property String psWtypkin       Public ''
42529>>>>>    Property String psPtypparRecr   Public ''
42531>>>>>    Property Integer Pino           Public 0
42533>>>>>    Property Date   pdHmnia         Public ''
42535>>>>>    
42535>>>>>    //AB-StoreTopEnd
42535>>>>>
42535>>>>>    Set Label to "˜¨˜©«˜« ¡á"
42536>>>>>    Set Size to 294 523
42537>>>>>    Set Location to 0 3
42538>>>>>    Set Color to 12363657
42539>>>>>    Set Exit_Application_Local_State to FALSE
42540>>>>>    Set Modal_State to FALSE
42541>>>>>
42541>>>>>    //AB-DDOStart
42541>>>>>
42541>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
42543>>>>>    End_Object    // Ctypkin_DD
42544>>>>>
42544>>>>>    Object Wtypkin_DD is a Wtypkin_DataDictionary
42546>>>>>    End_Object    // Wtypkin_DD
42547>>>>>
42547>>>>>    Object Ptyppar_DD is a Ptyppar_DataDictionary
42549>>>>>        Set DDO_Server to (Ctypkin_DD(self))
42550>>>>>        Set DDO_Server to (Wtypkin_DD(self))
42551>>>>>    End_Object    // Ptyppar_DD
42552>>>>>
42552>>>>>    Object Clients_DD is a Clients_DataDictionary
42554>>>>>    End_Object    // Clients_DD
42555>>>>>
42555>>>>>    Object Nomisma_DD is a Nomisma_DataDictionary
42557>>>>>    End_Object    // Nomisma_DD
42558>>>>>
42558>>>>>    Object Particle_DD is a Particle_DataDictionary
42560>>>>>        Set DDO_Server to (Clients_DD(self))
42561>>>>>        Set DDO_Server to (Ptyppar_DD(self))
42562>>>>>        Set DDO_Server to (Nomisma_DD(self))
42563>>>>>
42563>>>>>        //AB-StoreStart
42563>>>>>                                                        
42563>>>>>        Procedure OnConstrain
42565>>>>>            String  sPtyppar sWtypkin sCtypkin sClientID sPtypparRecr
42566>>>>>            Date    dHmnia
42566>>>>>            Integer Ino
42566>>>>>            Get psClient        to sClientID
42567>>>>>            Get psPtyppar       to sPtyppar
42568>>>>>            Get psPtypparRecr   to sPtypparRecr
42569>>>>>            Get psCtypkin       to sCtypkin
42570>>>>>            Get psWtypkin       to sWtypkin
42571>>>>>            Get Value Of cSyDateForm1 Item 0 to dHmnia
42572>>>>>            get Pino            to Ino
42573>>>>>            If (sClientID<>'') Begin
42575>>>>>                If (sPtypparRecr<>'') Begin
42577>>>>>                    Set Ordering to 1
42578>>>>>                    Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
42580>>>>>                    Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
42582>>>>>                    Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
42584>>>>>                    Constrain Particle.CustProm_Code    Eq ''
42586>>>>>                    Constrain Particle.Client_ID        Eq sClientID
42588>>>>>                    Constrain Particle.Ctypkin_Code     Eq sCtypkin
42590>>>>>                    Constrain Particle.Wtypkin_Code     Eq sWtypkin
42592>>>>>                    Constrain Particle.Ptyppar_Code     Eq sPtyppar
42594>>>>>                    If (dHmnia<>'') ;                        Constrain Particle.Partl_Hmnia  Eq dHmnia
42598>>>>>                    If (Ino<>0) ;                        Constrain Particle.Partl_no     Eq Ino
42602>>>>>                End
42602>>>>>>
42602>>>>>                Else Begin
42603>>>>>                    Set Ordering to 13
42604>>>>>                    Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
42606>>>>>                    Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
42608>>>>>                    Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
42610>>>>>                    Constrain Particle.Client_ID        Eq sClientID
42612>>>>>                    If (dHmnia<>'') ;                        Constrain Particle.Partl_Hmnia  Eq dHmnia
42616>>>>>                    If (Ino<>0) ;                        Constrain Particle.Partl_no     Eq Ino
42620>>>>>                End
42620>>>>>>
42620>>>>>            End
42620>>>>>>
42620>>>>>            Else If (sPtypparRecr<>'') Begin
42623>>>>>                Set Ordering to 12
42624>>>>>                Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
42626>>>>>                Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
42628>>>>>                Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
42630>>>>>                Constrain Particle.Partl_Module     Eq (psModule(Self))
42632>>>>>                Constrain Particle.Ptyppar_Recr     Eq sPtypparRecr
42634>>>>>                If (dHmnia<>'') ;                    Constrain Particle.Partl_Hmnia  Eq dHmnia
42638>>>>>                If (Ino<>0) ;                    Constrain Particle.Partl_no     Eq Ino
42642>>>>>            End
42642>>>>>>
42642>>>>>            Else  Begin
42643>>>>>                Set Ordering to 14
42644>>>>>                Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
42646>>>>>                Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
42648>>>>>                Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
42650>>>>>                Constrain Particle.Partl_Module     Eq (psModule(Self))
42652>>>>>                If (dHmnia<>'') ;                    Constrain Particle.Partl_Hmnia  Eq dHmnia
42656>>>>>                If (Ino<>0) ;                    Constrain Particle.Partl_no     Eq Ino
42660>>>>>            End
42660>>>>>>
42660>>>>>        
42660>>>>>        End_Procedure
42661>>>>>        
42661>>>>>        
42661>>>>>        
42661>>>>>        
42661>>>>>        
42661>>>>>        
42661>>>>>        
42661>>>>>        
42661>>>>>        
42661>>>>>        
42661>>>>>        
42661>>>>>        
42661>>>>>        
42661>>>>>        
42661>>>>>        
42661>>>>>        
42661>>>>>        
42661>>>>>        //AB-StoreEnd
42661>>>>>
42661>>>>>    End_Object    // Particle_DD
42662>>>>>
42662>>>>>    Set Main_DD to (Particle_DD(self))
42663>>>>>    Set Server to (Particle_DD(self))
42664>>>>>
42664>>>>>    //AB-DDOEnd
42664>>>>>
42664>>>>>    Object oSelList is a dbListSub
42666>>>>>        Set Main_File to Particle.File_Number
42667>>>>>        Set Size to 208 511
42668>>>>>        Set Location to 6 5
42669>>>>>        Set Auto_Index_State to FALSE
42670>>>>>
42670>>>>>        Begin_Row
42673>>>>>            Entry_Item Particle.Partl_hmnia
42674>>>>>            Entry_Item Ptyppar.Ptyppar_descr
42675>>>>>            Entry_Item Particle.Pseira_seira
42676>>>>>            Entry_Item Particle.Partl_no
42677>>>>>            Entry_Item Clients.Client_id
42678>>>>>            Entry_Item Clients.Client_name
42679>>>>>            Entry_Item Particle.Partl_payam
42680>>>>>            Entry_Item Particle.Partl_ekleise
42681>>>>>        End_Row
42686>>>>>
42686>>>>>        Set Form_Width    item 0 to 55
42687>>>>>        Set Header_Label  item 0 to "†£œ¨/¤å˜"
42688>>>>>        
42688>>>>>        Set Form_Width    item 1 to 100
42689>>>>>        Set Header_Label  item 1 to "˜¨˜©«˜« ¡æ"
42690>>>>>        
42690>>>>>        Set Form_Width    item 2 to 36
42691>>>>>        Set Header_Label  item 2 to "‘œ ¨á"
42692>>>>>        
42692>>>>>        Set Form_Width    item 3 to 55
42693>>>>>        Set Header_Label  item 3 to "€¨ Ÿ£æª"
42694>>>>>        
42694>>>>>        Set Form_Width    item 4 to 57
42695>>>>>        Set Header_Label  item 4 to "‰à› ¡æª"
42696>>>>>        
42696>>>>>        Set Form_Width    item 5 to 140
42697>>>>>        Set Header_Label  item 5 to "œ¢á«žª / ¨¦£žŸœ¬«ãª"
42698>>>>>        
42698>>>>>        Set Form_Width    item 6 to 48
42699>>>>>        Set Header_Label  item 6 to "€¥å˜"
42700>>>>>        
42700>>>>>        Set Form_Width    item 7 to 16
42701>>>>>        Set Header_Label  item 7 to "K"
42702>>>>>        Set Column_Checkbox_State  item 7 to True
42703>>>>>        
42703>>>>>
42703>>>>>        //AB-StoreStart
42703>>>>>        Set Column_Option       Item  1 to NoEnter  True
42704>>>>>        Procedure End_Construct_Object
42706>>>>>            Integer iDecimals
42707>>>>>            Forward Send End_Construct_Object
42709>>>>>            Get fiDekadika_Nomismatos SysCurXr.C_Code0   to    iDecimals
42710>>>>>            Set Points Item 6 to iDecimals
42711>>>>>            Set Numeric_Mask Item 6 to 14 iDecimals ' ,*'
42712>>>>>        End_Procedure
42713>>>>>        
42713>>>>>        
42713>>>>>        Procedure Activate
42715>>>>>            Send Keyaction to ButtonSub1
42716>>>>>            Forward Send Activate
42718>>>>>        End_procedure
42719>>>>>        
42719>>>>>        Procedure Activating
42721>>>>>            Forward Send Activating
42723>>>>>            Set Auto_Index_State to True
42724>>>>>        End_Procedure
42725>>>>>        
42725>>>>>        
42725>>>>>        
42725>>>>>        
42725>>>>>        //AB-StoreEnd
42725>>>>>
42725>>>>>    End_Object    // oSelList
42726>>>>>
42726>>>>>    Object cSyDateForm1 is a cSyDateForm
42728>>>>>        Set Size to 13 85
42729>>>>>        Set Location to 222 54
42730>>>>>        Set Label_Col_Offset to 2
42731>>>>>        Set Label_Justification_Mode to jMode_Right
42732>>>>>        Set Form_Mask Item 0 to "d/M/yyyy"
42733>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42734>>>>>
42734>>>>>        //AB-StoreStart
42734>>>>>                                                                                                        
42734>>>>>        Procedure Key Integer iKey
42736>>>>>            Integer iRetVal
42737>>>>>            Forward Send Key iKey
42739>>>>>            If (iKey=277) Begin
42741>>>>>                Send Clear_Me
42742>>>>>            End
42742>>>>>>
42742>>>>>        End_Procedure
42743>>>>>        
42743>>>>>        Procedure Clear_Me
42745>>>>>            Set Value Item 0 to ''
42746>>>>>            Send KeyAction to ButtonSub1
42747>>>>>        End_Procedure
42748>>>>>        
42748>>>>>        Procedure Exiting00000
42750>>>>>            Forward Send Exiting
42752>>>>>            Send KeyAction to ButtonSub1
42753>>>>>        End_procedure
42754>>>>>        
42754>>>>>        
42754>>>>>        
42754>>>>>        //AB-StoreEnd
42754>>>>>
42754>>>>>    End_Object    // cSyDateForm1
42755>>>>>
42755>>>>>    Object FormSub1 is a FormSub
42757>>>>>        Set Size to 13 85
42758>>>>>        Set Location to 236 54
42759>>>>>        Set Label_Col_Offset to 2
42760>>>>>        Set Prompt_Button_Mode to pb_PromptOn
42761>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42762>>>>>
42762>>>>>        //AB-StoreStart
42762>>>>>                                                                                                
42762>>>>>        Set Prompt_Object to (sl012(Self))
42763>>>>>        
42763>>>>>        Procedure Prompt
42765>>>>>            String sModule
42766>>>>>            Get psModule Of (sl012(Self)) to sModule
42767>>>>>            Set psModule Of (sl012(Self)) to (psModule(Self))
42768>>>>>            Forward Send Prompt
42770>>>>>            Set psModule Of (sl012(Self)) to sModule
42771>>>>>        End_Procedure
42772>>>>>        
42772>>>>>        Procedure OnChange
42774>>>>>            String s1
42775>>>>>            Get Value Item 0 to s1
42776>>>>>            Set Value Of FormSub3 Item 0 to (fsPtyppar(Self,s1))
42777>>>>>            Clear Ptypparl
42778>>>>>            Move Syscurxr.Company_Code  to ptypparl.Company_Code
42779>>>>>            Move Syscurxr.Branch_Code   to ptypparl.Branch_Code
42780>>>>>            Move s1                     to Ptypparl.Ptyppar_Code
42781>>>>>            Find Eq Ptypparl by index.1
42782>>>>>>
42782>>>>>            Set psPtyppar       to s1
42783>>>>>            Set psPtypparRecr   to Ptypparl.Ptyppar_Recr
42784>>>>>            Set psWtypkin       to PtypparL.Wtypkin_Code
42785>>>>>            Set psCtypkin       to PtypparL.Ctypkin_Code
42786>>>>>        End_Procedure
42787>>>>>        
42787>>>>>        
42787>>>>>        
42787>>>>>        
42787>>>>>        
42787>>>>>        
42787>>>>>        
42787>>>>>        //AB-StoreEnd
42787>>>>>
42787>>>>>    End_Object    // FormSub1
42788>>>>>
42788>>>>>    Object FormSub3 is a FormSub
42790>>>>>        Set Size to 13 195
42791>>>>>        Set Location to 236 145
42792>>>>>        Set Color to 12363657
42793>>>>>        Set Label_Col_Offset to 2
42794>>>>>        Set Enabled_State to FALSE
42795>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42796>>>>>        Set Item_Shadow_State Item 0 to TRUE
42797>>>>>        Set Shadow_State Item 0 to TRUE
42798>>>>>    End_Object    // FormSub3
42799>>>>>
42799>>>>>    Object FormSub2 is a FormSub
42801>>>>>        Set Size to 13 85
42802>>>>>        Set Location to 250 54
42803>>>>>        Set Label_Col_Offset to 2
42804>>>>>        Set Prompt_Button_Mode to pb_PromptOn
42805>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42806>>>>>
42806>>>>>        //AB-StoreStart
42806>>>>>                                                                                                
42806>>>>>        Set Prompt_Object to (sl100(Self))
42807>>>>>        
42807>>>>>        Procedure Prompt
42809>>>>>            String sModule
42810>>>>>            Get psModule Of (sl100(Self)) to sModule
42811>>>>>            Set psModule Of (sl100(Self)) to (psModule(Self))
42812>>>>>            Forward Send Prompt
42814>>>>>            Set psModule Of (sl100(Self)) to sModule
42815>>>>>        End_Procedure
42816>>>>>        
42816>>>>>        Procedure OnChange
42818>>>>>            String s1
42819>>>>>            Get Value Item 0 to s1
42820>>>>>            Set Value Of FormSub4 Item 0 to (fsClient(Self,s1))
42821>>>>>            Set psClient to s1
42822>>>>>        End_Procedure
42823>>>>>        
42823>>>>>        
42823>>>>>        
42823>>>>>        
42823>>>>>        
42823>>>>>        
42823>>>>>        
42823>>>>>        //AB-StoreEnd
42823>>>>>
42823>>>>>    End_Object    // FormSub2
42824>>>>>
42824>>>>>    Object FormSub4 is a FormSub
42826>>>>>        Set Size to 13 195
42827>>>>>        Set Location to 250 145
42828>>>>>        Set Color to 12363657
42829>>>>>        Set Label_Col_Offset to 2
42830>>>>>        Set Enabled_State to FALSE
42831>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42832>>>>>        Set Item_Shadow_State Item 0 to TRUE
42833>>>>>        Set Shadow_State Item 0 to TRUE
42834>>>>>    End_Object    // FormSub4
42835>>>>>
42835>>>>>    Object FormSub5 is a FormSub
42837>>>>>        Set Size to 13 85
42838>>>>>        Set Location to 263 54
42839>>>>>        Set Label_Col_Offset to 2
42840>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42841>>>>>
42841>>>>>        //AB-StoreStart
42841>>>>>        Procedure OnChange
42843>>>>>            integer ino
42844>>>>>            Get Value Item 0 to ino
42845>>>>>            Set pino to ino
42846>>>>>        End_Procedure
42847>>>>>        
42847>>>>>        
42847>>>>>        
42847>>>>>        
42847>>>>>        
42847>>>>>        
42847>>>>>        
42847>>>>>        
42847>>>>>        
42847>>>>>        
42847>>>>>        
42847>>>>>        //AB-StoreEnd
42847>>>>>
42847>>>>>    End_Object    // FormSub5
42848>>>>>
42848>>>>>    Object TextBoxSub1 is a TextBoxSub
42850>>>>>        Set Label to "†£œ¨/¤å˜"
42851>>>>>        Set Color to 12363657
42852>>>>>        Set Location to 222 5
42853>>>>>        Set Size to 10 35
42854>>>>>        Set TypeFace to "MS Sans Serif"
42855>>>>>    End_Object    // TextBoxSub1
42856>>>>>
42856>>>>>    Object TextBoxSub2 is a TextBoxSub
42858>>>>>        Set Label to "˜¨˜©«/¡æ"
42859>>>>>        Set Color to 12363657
42860>>>>>        Set Location to 237 4
42861>>>>>        Set Size to 10 41
42862>>>>>        Set TypeFace to "MS Sans Serif"
42863>>>>>    End_Object    // TextBoxSub2
42864>>>>>
42864>>>>>    Object TextBoxSub3 is a TextBoxSub
42866>>>>>        Set Label to "”¦¨â˜ª"
42867>>>>>        Set Color to 12363657
42868>>>>>        Set Location to 252 4
42869>>>>>        Set Size to 10 31
42870>>>>>        Set TypeFace to "MS Sans Serif"
42871>>>>>    End_Object    // TextBoxSub3
42872>>>>>
42872>>>>>    Object ButtonSub1 is a ButtonSub
42874>>>>>        Set Label to "œ¨ æ¨ ©œ"
42875>>>>>        Set Size to 13 50
42876>>>>>        Set Location to 252 355
42877>>>>>        Set Form_FontWeight Item 0 to 600
42878>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42879>>>>>
42879>>>>>        //AB-StoreStart
42879>>>>>                
42879>>>>>        Procedure OnClick
42881>>>>>            Send Rebuild_Constraints to Particle_DD
42882>>>>>            Send Beginning_Of_Data to oSelList True
42883>>>>>        End_Procedure // OnClick
42884>>>>>        
42884>>>>>        
42884>>>>>        
42884>>>>>        
42884>>>>>        
42884>>>>>        //AB-StoreEnd
42884>>>>>
42884>>>>>    End_Object    // ButtonSub1
42885>>>>>
42885>>>>>    Object oOk_bn is a ButtonSub
42887>>>>>
42887>>>>>        //AB-StoreTopStart
42887>>>>>                
42887>>>>>        //AB-StoreTopEnd
42887>>>>>
42887>>>>>        Set Label to "&„§ ¢¦šã"
42888>>>>>        Set Location to 252 412
42889>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42890>>>>>
42890>>>>>        //AB-StoreStart
42890>>>>>                
42890>>>>>        Procedure OnClick
42892>>>>>            Send OK To (oSelList(current_object))
42893>>>>>        End_Procedure
42894>>>>>        
42894>>>>>        //AB-StoreEnd
42894>>>>>
42894>>>>>    End_Object    // oOk_bn
42895>>>>>
42895>>>>>    Object oSearch_bn is a ButtonSub
42897>>>>>        Set Label to "€&¤˜ã«ž©ž"
42898>>>>>        Set Size to 13 50
42899>>>>>        Set Location to 252 466
42900>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42901>>>>>
42901>>>>>        //AB-StoreStart
42901>>>>>        Procedure OnClick
42903>>>>>            Send Search To (oSelList(current_object))
42904>>>>>        End_Procedure
42905>>>>>        //AB-StoreEnd
42905>>>>>
42905>>>>>    End_Object    // oSearch_bn
42906>>>>>
42906>>>>>    Object TextBoxSub4 is a TextBoxSub
42908>>>>>        Set Label to "€¨ Ÿ£æª"
42909>>>>>        Set Color to 12363657
42910>>>>>        Set Location to 265 4
42911>>>>>        Set Size to 10 31
42912>>>>>        Set TypeFace to "MS Sans Serif"
42913>>>>>    End_Object    // TextBoxSub4
42914>>>>>
42914>>>>>
42914>>>>>    //AB-StoreStart
42914>>>>>                                
42914>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
42915>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
42916>>>>>    
42916>>>>>    Set Locate_Mode to Center_On_Screen
42917>>>>>    Set Modal_State to True
42918>>>>>    
42918>>>>>    Procedure Request_Cancel
42920>>>>>        Set Value Of cSyDateForm1 Item 0 to ''
42921>>>>>        Send Clear to Particle_DD
42922>>>>>        Forward Send Request_Cancel
42924>>>>>    End_Procedure
42925>>>>>    
42925>>>>>    
42925>>>>>    
42925>>>>>    
42925>>>>>    
42925>>>>>    
42925>>>>>    
42925>>>>>    
42925>>>>>    
42925>>>>>    
42925>>>>>    
42925>>>>>    
42925>>>>>    
42925>>>>>    
42925>>>>>    
42925>>>>>    
42925>>>>>    
42925>>>>>    
42925>>>>>    
42925>>>>>    
42925>>>>>    //AB-StoreEnd
42925>>>>>
42925>>>>>End_Object    // sl014
42926>>>>>
42926>>>>>
42926>>>>>//AB-StoreStart
42926>>>>>            
42926>>>>>            
42926>>>>>//AB-StoreEnd
42926>>>>>
42926>>>>>//AB/ End_Object    // prj
42926>>>Use sl022.sl
42926>>>Use sl023.sl
42926>>>Use sl024.sl
INCLUDING FILE: SL024.SL
42926>>>>>//AB/ Project sl024:kathgories eidon
42926>>>>>//AB/ Object prj is a Lookup_Project
42926>>>>>//AB/     Set ProjectName to "sl024:kathgories eidon"
42926>>>>>//AB/     Set ProjectFileName to "sl024.SL"
42926>>>>>
42926>>>>>// Project Object Structure
42926>>>>>//   sl024 is a dbModalPanelSub
42926>>>>>//     Witemkat_DD is a DataDictionary
42926>>>>>//     oSelList is a dbListSub
42926>>>>>//     oOK_bn is a ButtonSub
42926>>>>>//     oCancel_bn is a ButtonSub
42926>>>>>//     oSearch_bn is a ButtonSub
42926>>>>>
42926>>>>>// Register all objects
42926>>>>>Register_Object oCancel_bn
42926>>>>>Register_Object oOK_bn
42926>>>>>Register_Object oSearch_bn
42926>>>>>Register_Object oSelList
42926>>>>>Register_Object sl024
42926>>>>>Register_Object Witemkat_DD
42926>>>>>
42926>>>>>
42926>>>>>//AB-IgnoreStart
42926>>>>>
42926>>>>>Use DFAllEnt.pkg
42926>>>>>Use dbList.Sub
42926>>>>>Use Button.Sub
42926>>>>>
42926>>>>>
42926>>>>>Use WITEMKAT.DD
INCLUDING FILE: WITEMKAT.DD
42926>>>>>>>//DDB-FileStart
42926>>>>>>>//DDB-HeaderStart
42926>>>>>>>
42926>>>>>>>// File Name : WITEMKAT.DD
42926>>>>>>>// Class Name: Witemkat_DataDictionary
42926>>>>>>>// Revision  : 26
42926>>>>>>>
42926>>>>>>>Use  Windows           // Basic Definitions
42926>>>>>>>Use  DataDict          // DataDictionary Class Definition
42926>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
42926>>>>>>>
42926>>>>>>>Open Witemkat
42928>>>>>>>Open Item
INCLUDING FILE: ITEM.FD
42930>>>>>>>Open Sysrecw
42932>>>>>>>Open Syscurxr
42934>>>>>>>
42934>>>>>>>//DDB-HeaderEnd
42934>>>>>>>//DDB-SelectionStart
42934>>>>>>>//DDB/ ExternalSelectionList sl024  sl024.SL
42934>>>>>>>Register_Object sl024
42934>>>>>>>//DDB-SelectionEnd
42934>>>>>>>
42934>>>>>>>Class Witemkat_DataDictionary  is a DataDictionary
42935>>>>>>>
42935>>>>>>>     Procedure Creating
42936>>>>>>>        Forward Send Creating
42938>>>>>>>        // Insert Code Here
42938>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(WitemKat.WitemKat_Rec0)))))) to WitemKat.WitemKat_Recr
42939>>>>>>>    End_Procedure   // Creating
42940>>>>>>>   
42940>>>>>>>    Function Validate_Save  Returns Integer
42941>>>>>>>        Local Integer iReturnVal icheck
42942>>>>>>>        Forward Get Validate_Save  To iReturnVal
42944>>>>>>>        If (Not(iReturnVal)) Begin
42946>>>>>>>            // Insert Code Here
42946>>>>>>>//           if (witemkat.codegl <> '') begin
42946>>>>>>>//              Move (Check_log(witemkat.codegl)) to iCheck  
42946>>>>>>>//              if (icheck) Move 24001 to iReturnVal 
42946>>>>>>>//           end
42946>>>>>>>           If (iReturnVal) Send Operation_Not_Allowed iReturnVal
42949>>>>>>>        End
42949>>>>>>>>
42949>>>>>>>        Function_Return iReturnVal
42950>>>>>>>    End_Function   // Validate_Save
42951>>>>>>> 
42951>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
42952>>>>>>>        String lsError_Message
42953>>>>>>>        Case Begin
42953>>>>>>>            Case (iError_Num = 24001)
42955>>>>>>>                Move "DDC 24: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ¡˜«žš¦¨å˜ª œå›¦¬ª" to lsError_Message
42956>>>>>>>              Case Break
42957>>>>>>>            Case Else
42957>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
42959>>>>>>>        Case End
42959>>>>>>>        Error iError_Num lsError_Message
42960>>>>>>>>
42960>>>>>>>    End_Procedure // operation_not_allowed
42961>>>>>>>
42961>>>>>>>
42961>>>>>>>
42961>>>>>>>    // Define_Fields:
42961>>>>>>>    // This procedure is used to set up all data-dictionary rules.
42961>>>>>>>
42961>>>>>>>    Procedure Define_Fields
42962>>>>>>>        Forward Send Define_Fields
42964>>>>>>>        //DDB-Generated-Code-Location
42964>>>>>>>        //DDB-DefineFieldStart
42964>>>>>>>
42964>>>>>>>        Set Main_File            To Witemkat.File_Number
42965>>>>>>>        Set Cascade_Delete_State To FALSE
42966>>>>>>>
42966>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
42967>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
42968>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
42969>>>>>>>
42969>>>>>>>        // Child (Client) file structure................
42969>>>>>>>        Send Add_Client_File  Item.File_Number
42970>>>>>>>
42970>>>>>>>        // External (System) file structure.............
42970>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
42971>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
42972>>>>>>>
42972>>>>>>>        Define_Auto_Increment  Sysrecw.Witemkat_Rec0  To Witemkat.Witemkat_Rec0
42975>>>>>>>
42975>>>>>>>        // Field-based properties.......................
42975>>>>>>>
42975>>>>>>>        // Witemkat.Witemkat_Code  
42975>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Code   To DD_AUTOFIND   
42976>>>>>>>        Set Field_Prompt_Object    Field Witemkat.Witemkat_Code   To (sl024(Self))
42977>>>>>>>
42977>>>>>>>        // Witemkat.Witemkat_Rec0  
42977>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Rec0   To DD_AUTOFIND   
42978>>>>>>>
42978>>>>>>>        // Witemkat.Witemkat_Descr 
42978>>>>>>>        Set Field_Prompt_Object    Field Witemkat.Witemkat_Descr  To (sl024(Self))
42979>>>>>>>
42979>>>>>>>        // Witemkat.Witemkat_Recr  
42979>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Recr   To DD_AUTOFIND   
42980>>>>>>>
42980>>>>>>>        // Witemkat.Codeglpol      
42980>>>>>>>
42980>>>>>>>        // Witemkat.Codeglago      
42980>>>>>>>
42980>>>>>>>        //DDB-DefineFieldEnd
42980>>>>>>>    End_Procedure    // Define_Fields
42981>>>>>>>
42981>>>>>>>    // Field_Defaults:
42981>>>>>>>    // This procedure is used to establish default field values.
42981>>>>>>>
42981>>>>>>>    Procedure Field_Defaults
42982>>>>>>>        Forward Send Field_Defaults
42984>>>>>>>        //DDB-Generated-Code-Location
42984>>>>>>>        //DDB-FieldDefaultStart
42984>>>>>>>        //DDB-FieldDefaultEnd
42984>>>>>>>    End_Procedure    // Field_Defaults
42985>>>>>>>
42985>>>>>>>End_Class    // Witemkat_DataDictionary
42986>>>>>>>//DDB-Selection-pkg-Start
42986>>>>>>>Use sl024.SL         // sl024
42986>>>>>>>//DDB-Selection-pkg-End
42986>>>>>>>//DDB-FileEnd
42986>>>>>
42986>>>>>//AB-IgnoreEnd
42986>>>>>
42986>>>>>Object sl024 is a dbModalPanelSub
42988>>>>>    Set Label to "‰˜«žš¦¨åœª „ ›é¤"
42989>>>>>    Set Size to 217 375
42990>>>>>    Set Location to 4 5
42991>>>>>    Set Exit_Application_Local_State to FALSE
42992>>>>>    Set Modal_State to FALSE
42993>>>>>
42993>>>>>    //AB-DDOStart
42993>>>>>
42993>>>>>    Object Witemkat_DD is a Witemkat_DataDictionary
42995>>>>>    End_Object    // Witemkat_DD
42996>>>>>
42996>>>>>    Set Main_DD to (Witemkat_DD(self))
42997>>>>>    Set Server to (Witemkat_DD(self))
42998>>>>>
42998>>>>>    //AB-DDOEnd
42998>>>>>
42998>>>>>    Object oSelList is a dbListSub
43000>>>>>        Set Main_File to Witemkat.File_Number
43001>>>>>        Set Size to 175 357
43002>>>>>        Set Location to 6 6
43003>>>>>
43003>>>>>        Begin_Row
43006>>>>>            Entry_Item Witemkat.Witemkat_code
43007>>>>>            Entry_Item Witemkat.Witemkat_descr
43008>>>>>        End_Row
43013>>>>>
43013>>>>>        Set Form_Width    item 0 to 124
43014>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
43015>>>>>        
43015>>>>>        Set Form_Width    item 1 to 223
43016>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
43017>>>>>        
43017>>>>>    End_Object    // oSelList
43018>>>>>
43018>>>>>    Object oOK_bn is a ButtonSub
43020>>>>>        Set Label to "&„§ ¢¦šã"
43021>>>>>        Set Location to 186 210
43022>>>>>
43022>>>>>        //AB-StoreStart
43022>>>>>        Procedure OnClick
43024>>>>>            Send OK To (oSelList(current_object))
43025>>>>>        End_Procedure
43026>>>>>        //AB-StoreEnd
43026>>>>>
43026>>>>>    End_Object    // oOK_bn
43027>>>>>
43027>>>>>    Object oCancel_bn is a ButtonSub
43029>>>>>        Set Label to "&€¡ç¨à©ž"
43030>>>>>        Set Location to 186 265
43031>>>>>
43031>>>>>        //AB-StoreStart
43031>>>>>        Procedure OnClick
43033>>>>>            Send Cancel To (oSelList(current_object))
43034>>>>>        End_Procedure
43035>>>>>        //AB-StoreEnd
43035>>>>>
43035>>>>>    End_Object    // oCancel_bn
43036>>>>>
43036>>>>>    Object oSearch_bn is a ButtonSub
43038>>>>>        Set Label to "€&¤˜ã«ž©ž"
43039>>>>>        Set Location to 186 320
43040>>>>>
43040>>>>>        //AB-StoreStart
43040>>>>>        Procedure OnClick
43042>>>>>            Send Search To (oSelList(current_object))
43043>>>>>        End_Procedure
43044>>>>>        //AB-StoreEnd
43044>>>>>
43044>>>>>    End_Object    // oSearch_bn
43045>>>>>
43045>>>>>
43045>>>>>    //AB-StoreStart
43045>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
43046>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
43047>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
43048>>>>>    //AB-StoreEnd
43048>>>>>
43048>>>>>End_Object    // sl024
43049>>>>>
43049>>>>>//AB/ End_Object    // prj
43049>>>Use sl025.sl
INCLUDING FILE: SL025.SL
43049>>>>>//AB/ Project sl025
43049>>>>>//AB/ Object prj is a Lookup_Project
43049>>>>>//AB/     Set ProjectName to "sl025"
43049>>>>>//AB/     Set ProjectFileName to "sl025.SL"
43049>>>>>//AB/     Set GenerateFileName to "NONAME"
43049>>>>>
43049>>>>>// Project Object Structure
43049>>>>>//   sl025 is a dbModalPanelSub
43049>>>>>//     Units_DD is a DataDictionary
43049>>>>>//     oSelList is a dbListSub
43049>>>>>//     oOK_bn is a ButtonSub
43049>>>>>//     oCancel_bn is a ButtonSub
43049>>>>>//     oSearch_bn is a ButtonSub
43049>>>>>
43049>>>>>// Register all objects
43049>>>>>Register_Object oCancel_bn
43049>>>>>Register_Object oOK_bn
43049>>>>>Register_Object oSearch_bn
43049>>>>>Register_Object oSelList
43049>>>>>Register_Object sl025
43049>>>>>Register_Object Units_DD
43049>>>>>
43049>>>>>
43049>>>>>//AB-IgnoreStart
43049>>>>>
43049>>>>>Use DFAllEnt.pkg
43049>>>>>Use dbList.Sub
43049>>>>>Use Button.Sub
43049>>>>>
43049>>>>>
43049>>>>>Use UNITS.DD
INCLUDING FILE: UNITS.DD
43049>>>>>>>//DDB-FileStart
43049>>>>>>>//DDB-HeaderStart
43049>>>>>>>
43049>>>>>>>// File Name : UNITS.DD
43049>>>>>>>// Class Name: Units_DataDictionary
43049>>>>>>>// Revision  : 17
43049>>>>>>>// Version   : 2
43049>>>>>>>
43049>>>>>>>Use  Windows           // Basic Definitions
43049>>>>>>>Use  DataDict          // DataDictionary Class Definition
43049>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43049>>>>>>>
43049>>>>>>>Open Units
43051>>>>>>>Open Item
43053>>>>>>>Open Sysrecw
43055>>>>>>>Open Syscurxr
43057>>>>>>>
43057>>>>>>>//DDB-HeaderEnd
43057>>>>>>>//DDB-SelectionStart
43057>>>>>>>//DDB/ ExternalSelectionList sl025  sl025.SL
43057>>>>>>>Register_Object sl025
43057>>>>>>>//DDB-SelectionEnd
43057>>>>>>>
43057>>>>>>>Class Units_DataDictionary  is a DataDictionary
43058>>>>>>>
43058>>>>>>>    Procedure Save_Main_File
43059>>>>>>>        If (Operation_Origin<>Self) Begin
43061>>>>>>>            If Units.Recnum Eq 0 Procedure_Return
43064>>>>>>>        End
43064>>>>>>>>
43064>>>>>>>        Forward Send Save_Main_File
43066>>>>>>>    End_Procedure
43067>>>>>>>
43067>>>>>>>
43067>>>>>>>     Procedure Creating
43068>>>>>>>        Forward Send Creating
43070>>>>>>>        // Insert Code Here
43070>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Units.Units_Rec0)))))) to Units.Units_Recr
43071>>>>>>>    End_Procedure   // Creating
43072>>>>>>>
43072>>>>>>>
43072>>>>>>>
43072>>>>>>>    // Define_Fields:
43072>>>>>>>    // This procedure is used to set up all data-dictionary rules.
43072>>>>>>>
43072>>>>>>>    Procedure Define_Fields
43073>>>>>>>        Forward Send Define_Fields
43075>>>>>>>        //DDB-Generated-Code-Location
43075>>>>>>>        //DDB-DefineFieldStart
43075>>>>>>>
43075>>>>>>>        Set Main_File            To Units.File_Number
43076>>>>>>>        Set Cascade_Delete_State To FALSE
43077>>>>>>>
43077>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
43078>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
43079>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43080>>>>>>>
43080>>>>>>>        // Child (Client) file structure................
43080>>>>>>>        Send Add_Client_File  Item.File_Number
43081>>>>>>>
43081>>>>>>>        // External (System) file structure.............
43081>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
43082>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
43083>>>>>>>
43083>>>>>>>        Define_Auto_Increment  Sysrecw.Units_Rec0  To Units.Units_Rec0
43086>>>>>>>
43086>>>>>>>        // Field-based properties.......................
43086>>>>>>>
43086>>>>>>>        // Units.Units_Code
43086>>>>>>>        Set Field_Options          Field Units.Units_Code To DD_AUTOFIND   
43087>>>>>>>        Set Field_Prompt_Object    Field Units.Units_Code To (sl025(Self))
43088>>>>>>>
43088>>>>>>>        // Units.Units_Rec0
43088>>>>>>>        Set Field_Options          Field Units.Units_Rec0 To DD_AUTOFIND   
43089>>>>>>>
43089>>>>>>>        // Units.Units_Descr
43089>>>>>>>        Set Field_Prompt_Object    Field Units.Units_Descr To (sl025(Self))
43090>>>>>>>
43090>>>>>>>        // Units.Units_Recr
43090>>>>>>>        Set Field_Options          Field Units.Units_Recr To DD_AUTOFIND   
43091>>>>>>>
43091>>>>>>>        //DDB-DefineFieldEnd
43091>>>>>>>    End_Procedure    // Define_Fields
43092>>>>>>>
43092>>>>>>>    // Field_Defaults:
43092>>>>>>>    // This procedure is used to establish default field values.
43092>>>>>>>
43092>>>>>>>    Procedure Field_Defaults
43093>>>>>>>        Forward Send Field_Defaults
43095>>>>>>>        //DDB-Generated-Code-Location
43095>>>>>>>        //DDB-FieldDefaultStart
43095>>>>>>>        //DDB-FieldDefaultEnd
43095>>>>>>>    End_Procedure    // Field_Defaults
43096>>>>>>>
43096>>>>>>>End_Class    // Units_DataDictionary
43097>>>>>>>//DDB-Selection-pkg-Start
43097>>>>>>>
43097>>>>>>>Use sl025.SL         // sl025
43097>>>>>>>
43097>>>>>>>//DDB-Selection-pkg-End
43097>>>>>>>//DDB-FileEnd
43097>>>>>
43097>>>>>//AB-IgnoreEnd
43097>>>>>
43097>>>>>Object sl025 is a dbModalPanelSub
43099>>>>>    set label to "‹¦¤á›œª ‹â«¨ž©žª" 
43100>>>>>    Set Size to 148 297
43101>>>>>    Set Location to 4 5
43102>>>>>    Set Exit_Application_Local_State to FALSE
43103>>>>>    Set Modal_State to FALSE
43104>>>>>
43104>>>>>    //AB-DDOStart
43104>>>>>
43104>>>>>    Object Units_DD is a Units_DataDictionary
43106>>>>>    End_Object    // Units_DD
43107>>>>>
43107>>>>>    Set Main_DD to (Units_DD(self))
43108>>>>>    Set Server to (Units_DD(self))
43109>>>>>
43109>>>>>    //AB-DDOEnd
43109>>>>>
43109>>>>>    Object oSelList is a dbListSub
43111>>>>>        set main_file to units.file_number 
43112>>>>>        Set Size to 105 280
43113>>>>>        Set Location to 6 6
43114>>>>>
43114>>>>>        Begin_Row
43117>>>>>            entry_item units.units_code 
43118>>>>>            entry_item units.units_descr 
43119>>>>>        End_Row
43124>>>>>
43124>>>>>        Set Form_Width    item 0 to 91
43125>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
43126>>>>>        
43126>>>>>        Set Form_Width    item 1 to 180
43127>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
43128>>>>>        
43128>>>>>    End_Object    // oSelList
43129>>>>>
43129>>>>>    Object oOK_bn is a ButtonSub
43131>>>>>        set label to "&„§ ¢¦šã" 
43132>>>>>        Set Location to 115 126
43133>>>>>
43133>>>>>        //AB-StoreStart
43133>>>>>        Procedure OnClick
43135>>>>>            Send OK To (oSelList(current_object))
43136>>>>>        End_Procedure
43137>>>>>        //AB-StoreEnd
43137>>>>>
43137>>>>>    End_Object    // oOK_bn
43138>>>>>
43138>>>>>    Object oCancel_bn is a ButtonSub
43140>>>>>        set label to "&€¡ç¨à©ž" 
43141>>>>>        Set Location to 115 181
43142>>>>>
43142>>>>>        //AB-StoreStart
43142>>>>>        Procedure OnClick
43144>>>>>            Send Cancel To (oSelList(current_object))
43145>>>>>        End_Procedure
43146>>>>>        //AB-StoreEnd
43146>>>>>
43146>>>>>    End_Object    // oCancel_bn
43147>>>>>
43147>>>>>    Object oSearch_bn is a ButtonSub
43149>>>>>        set label to "€&¤˜ã«ž©ž" 
43150>>>>>        Set Location to 115 236
43151>>>>>
43151>>>>>        //AB-StoreStart
43151>>>>>        Procedure OnClick
43153>>>>>            Send Search To (oSelList(current_object))
43154>>>>>        End_Procedure
43155>>>>>        //AB-StoreEnd
43155>>>>>
43155>>>>>    End_Object    // oSearch_bn
43156>>>>>
43156>>>>>
43156>>>>>    //AB-StoreStart
43156>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
43157>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
43158>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
43159>>>>>    //AB-StoreEnd
43159>>>>>
43159>>>>>End_Object    // sl025
43160>>>>>
43160>>>>>//AB/ End_Object    // prj
43160>>>Use sl026.sl
INCLUDING FILE: SL026.SL
43160>>>>>//AB/ Project sl026:Item
43160>>>>>//AB/     Object prj is a Lookup_Project
43160>>>>>//AB/         Set ProjectName to "sl026:Item"
43160>>>>>//AB/         Set ProjectFileName to "sl026.SL"
43160>>>>>//AB/         Set GenerateFileName to "NONAME"
43160>>>>>
43160>>>>>// Project Object Structure
43160>>>>>//   sl026 is a dbModalPanelSub
43160>>>>>//     Witemkat_DD is a DataDictionary
43160>>>>>//     Units_DD is a DataDictionary
43160>>>>>//     Item_DD is a DataDictionary
43160>>>>>//     oSelList is a dbListSub
43160>>>>>//     oOK_bn is a ButtonSub
43160>>>>>//     oCancel_bn is a ButtonSub
43160>>>>>//     oSearch_bn is a ButtonSub
43160>>>>>
43160>>>>>// Register all objects
43160>>>>>Register_Object Item_DD
43160>>>>>Register_Object oCancel_bn
43160>>>>>Register_Object oOK_bn
43160>>>>>Register_Object oSearch_bn
43160>>>>>Register_Object oSelList
43160>>>>>Register_Object sl026
43160>>>>>Register_Object Units_DD
43160>>>>>Register_Object Witemkat_DD
43160>>>>>
43160>>>>>
43160>>>>>    //AB-IgnoreStart
43160>>>>>
43160>>>>>    Use DFAllEnt.pkg
43160>>>>>    Use dbList.Sub
43160>>>>>    Use Button.Sub
43160>>>>>
43160>>>>>
43160>>>>>    Use WITEMKAT.DD
43160>>>>>    Use UNITS.DD
43160>>>>>    Use ITEM.DD
INCLUDING FILE: ITEM.DD
43160>>>>>>>//DDB-FileStart
43160>>>>>>>//DDB-HeaderStart
43160>>>>>>>
43160>>>>>>>// File Name : ITEM.DD
43160>>>>>>>// Class Name: Item_DataDictionary
43160>>>>>>>// Revision  : 63
43160>>>>>>>// Version   : 2
43160>>>>>>>
43160>>>>>>>Use  Windows           // Basic Definitions
43160>>>>>>>Use  DataDict          // DataDictionary Class Definition
43160>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43160>>>>>>>
43160>>>>>>>Open Item
43162>>>>>>>Open Witemx
43164>>>>>>>Open Witemcl
43166>>>>>>>Open Itemtehn
INCLUDING FILE: ITEMTEHN.FD
43168>>>>>>>Open Units
43170>>>>>>>Open Witemkat
43172>>>>>>>Open Fpa
INCLUDING FILE: FPA.FD
43174>>>>>>>Open Sysrecw
43176>>>>>>>Open Witemx
43178>>>>>>>
43178>>>>>>>//DDB-HeaderEnd
43178>>>>>>>//DDB-ValidationStart
43178>>>>>>>
43178>>>>>>>Register_Object Item_Item_Qual_VT
43178>>>>>>>Register_Object Item_Item_Analysh_VT
43178>>>>>>>
43178>>>>>>>Object Item_Item_Qual_VT  is a CodeValidationTable
43180>>>>>>>    Set Type_Value        To "QUAL"
43181>>>>>>>    Set Validate_State    To FALSE
43182>>>>>>>    Set Allow_Blank_State To TRUE
43183>>>>>>>    //DDB-ValidationCustomStart
43183>>>>>>>    //DDB-ValidationCustomEnd
43183>>>>>>>End_Object   // Item_Item_Qual_VT
43184>>>>>>>
43184>>>>>>>Object Item_Item_Analysh_VT  is a CodeValidationTable
43186>>>>>>>    Set Type_Value        To "ITEMANAL"
43187>>>>>>>    Set Table_Title       To "€¤á¢¬©ž „å›¦¬ª"
43188>>>>>>>    //DDB-ValidationCustomStart
43188>>>>>>>    //DDB-ValidationCustomEnd
43188>>>>>>>End_Object   // Item_Item_Analysh_VT
43189>>>>>>>//DDB-ValidationEnd
43189>>>>>>>//DDB-SelectionStart
43189>>>>>>>//DDB/ ExternalSelectionList SL22s  sl22s.sl
43189>>>>>>>//DDB/ ExternalSelectionList sl022  sl022.SL
43189>>>>>>>Register_Object SL22s
43189>>>>>>>Register_Object sl022
43189>>>>>>>//DDB-SelectionEnd
43189>>>>>>>
43189>>>>>>>Class Item_DataDictionary  is a DataDictionary
43190>>>>>>>
43190>>>>>>>    Procedure Update
43191>>>>>>>        Forward Send Update
43193>>>>>>>        Move Witemkat.Witemkat_Code to Item.Witemkat_Code
43194>>>>>>>        Move Units.Units_Code       to Item.Units_Code
43195>>>>>>>    End_Procedure   // Update
43196>>>>>>>
43196>>>>>>>    Procedure Creating
43197>>>>>>>        Date dHmnia
43198>>>>>>>        Forward Send Creating
43200>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                         (Trim(String(Item.Item_Rec0)))))) to Item.Item_Recr
43201>>>>>>>        
43201>>>>>>>        Clear Branch
43202>>>>>>>        Move SysCurXR.Company_Code    to Branch.Company_Code
43203>>>>>>>        Find Gt Branch By Index.1 
43204>>>>>>>>
43204>>>>>>>        While ((Found=1) And (Branch.Company_Code=SysCurXR.Company_Code))
43208>>>>>>>            Clear Witemx
43209>>>>>>>            Move SysCurXR.Company_Code      to Witemx.Company_Code
43210>>>>>>>            Move Branch.Branch_Code         to Witemx.Branch_Code
43211>>>>>>>            Move SysCurXR.Year_Year         to Witemx.Year_Year
43212>>>>>>>            Move SysCurXR.Year_Year         to Witemx.Witemx_YearDesc
43213>>>>>>>            Move SysCurXR.Year_Recr         to Witemx.Year_Recr
43214>>>>>>>            Move Witemkat.Witemkat_Code     to Witemx.Witemkat_Code
43215>>>>>>>            Move Units.Units_Code           to Witemx.Units_Code
43216>>>>>>>            Move Item.Item_Code             to Witemx.Item_Code
43217>>>>>>>            Move Item.Item_Code             to Witemx.Witemx_Code
43218>>>>>>>            Move Item.Item_Descr            to Witemx.Witemx_Descr
43219>>>>>>>            Move Item.Wapokat_Code          to Witemx.ITEM_APOKAT_COD
43220>>>>>>>            Move Item.link1                 to Witemx.link1
43221>>>>>>>            Move Item.link2                 to Witemx.link2
43222>>>>>>>            Move Item.Item_Recr             to Witemx.Item_Recr
43223>>>>>>>            Move (Sysrecw.Witemx_Rec0+1)    to Witemx.Witemx_Rec0
43224>>>>>>>            Move (Sysrecw.Witemx_Rec0+1)    to Sysrecw.Witemx_Rec0
43225>>>>>>>            Move (Append('',((Trim(SysCurXR.Branch_Site))+;                           (Trim(String(Witemx.Witemx_Rec0)))))) ;                                          to Witemx.Witemx_Recr
43226>>>>>>>            Saverecord Sysrecw
43227>>>>>>>            Saverecord Witemx
43228>>>>>>>            
43228>>>>>>>            Find Gt Branch By Index.1 
43229>>>>>>>>
43229>>>>>>>        Loop
43230>>>>>>>>
43230>>>>>>>    End_Procedure   // Creating
43231>>>>>>>
43231>>>>>>>
43231>>>>>>>    // Define_Fields:
43231>>>>>>>    // This procedure is used to set up all data-dictionary rules.
43231>>>>>>>
43231>>>>>>>    Procedure Define_Fields
43232>>>>>>>        Forward Send Define_Fields
43234>>>>>>>        //DDB-Generated-Code-Location
43234>>>>>>>        //DDB-DefineFieldStart
43234>>>>>>>
43234>>>>>>>        Set Main_File            To Item.File_Number
43235>>>>>>>        Set Cascade_Delete_State To FALSE
43236>>>>>>>
43236>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
43237>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
43238>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43239>>>>>>>
43239>>>>>>>        // Child (Client) file structure................
43239>>>>>>>        Send Add_Client_File  Witemx.File_Number
43240>>>>>>>        Send Add_Client_File  Witemcl.File_Number
43241>>>>>>>        Send Add_Client_File  Itemtehn.File_Number
43242>>>>>>>
43242>>>>>>>        // Parent (Server) file structure...............
43242>>>>>>>        Send Add_Server_File  Units.File_Number
43243>>>>>>>        Send Add_Server_File  Witemkat.File_Number
43244>>>>>>>        Send Add_Server_File  Fpa.File_Number
43245>>>>>>>
43245>>>>>>>        // External (System) file structure.............
43245>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
43246>>>>>>>        Send Add_System_File  Witemx.File_Number  DD_LOCK_ON_ALL
43247>>>>>>>
43247>>>>>>>        Define_Auto_Increment  Sysrecw.Item_Rec0  To Item.Item_Rec0
43250>>>>>>>
43250>>>>>>>        // Field-based properties.......................
43250>>>>>>>
43250>>>>>>>        // Item.Units_Code
43250>>>>>>>
43250>>>>>>>        // Item.Units_Recr
43250>>>>>>>
43250>>>>>>>        // Item.Witemkat_Code
43250>>>>>>>
43250>>>>>>>        // Item.Witemkat_Recr
43250>>>>>>>
43250>>>>>>>        // Item.Item_Code
43250>>>>>>>        Set Field_Options          Field Item.Item_Code To DD_AUTOFIND   
43251>>>>>>>        Set Field_Prompt_Object    Field Item.Item_Code To (SL22s(Self))
43252>>>>>>>        Set Key_Field_State        Field Item.Item_Code To TRUE
43253>>>>>>>
43253>>>>>>>        // Item.Item_Rec0
43253>>>>>>>        Set Field_Options          Field Item.Item_Rec0 To DD_AUTOFIND   
43254>>>>>>>
43254>>>>>>>        // Item.Item_Descr
43254>>>>>>>        Set Field_Prompt_Object    Field Item.Item_Descr To (SL22s(Self))
43255>>>>>>>
43255>>>>>>>        // Item.Item_Recr
43255>>>>>>>        Set Field_Options          Field Item.Item_Recr To DD_AUTOFIND   
43256>>>>>>>
43256>>>>>>>        // Item.Fpa_Pososto
43256>>>>>>>        Set Key_Field_State        Field Item.Fpa_Pososto To TRUE
43257>>>>>>>
43257>>>>>>>        // Item.Item_Qual
43257>>>>>>>        Set Field_Value_Table      Field Item.Item_Qual To (Item_Item_Qual_VT(Self))
43258>>>>>>>
43258>>>>>>>        // Item.Wapokat_Code
43258>>>>>>>        Set Field_Prompt_Object    Field Item.Wapokat_Code To (sl022(Self))
43259>>>>>>>
43259>>>>>>>        // Item.Item_Analysh
43259>>>>>>>        Set Field_Class_Name       Field Item.Item_Analysh To "dbComboFormsub"
43260>>>>>>>        Set Field_Value_Table      Field Item.Item_Analysh To (Item_Item_Analysh_VT(Self))
43261>>>>>>>
43261>>>>>>>        // Item.Item_Orio
43261>>>>>>>
43261>>>>>>>        // Item.Codeglpol
43261>>>>>>>
43261>>>>>>>        // Item.Codeglago
43261>>>>>>>
43261>>>>>>>        // Item.Link1
43261>>>>>>>
43261>>>>>>>        // Item.Link2
43261>>>>>>>
43261>>>>>>>        // Item.Group
43261>>>>>>>
43261>>>>>>>        // Item.Sap
43261>>>>>>>
43261>>>>>>>        //DDB-DefineFieldEnd
43261>>>>>>>    End_Procedure    // Define_Fields
43262>>>>>>>
43262>>>>>>>    // Field_Defaults:
43262>>>>>>>    // This procedure is used to establish default field values.
43262>>>>>>>
43262>>>>>>>    Procedure Field_Defaults
43263>>>>>>>        Forward Send Field_Defaults
43265>>>>>>>        //DDB-Generated-Code-Location
43265>>>>>>>        //DDB-FieldDefaultStart
43265>>>>>>>        Set Field_Changed_Value   Field Item.Item_Analysh To "0"
43266>>>>>>>        //DDB-FieldDefaultEnd
43266>>>>>>>    End_Procedure    // Field_Defaults
43267>>>>>>>
43267>>>>>>>End_Class    // Item_DataDictionary
43268>>>>>>>//DDB-Selection-pkg-Start
43268>>>>>>>
43268>>>>>>>Use sl22s.sl         // SL22s
INCLUDING FILE: SL22S.SL
43268>>>>>>>>>//AB/ Project SL22s:ITEM
43268>>>>>>>>>//AB/ Object prj is a Lookup_Project
43268>>>>>>>>>//AB/     Set ProjectName to "SL22s:ITEM"
43268>>>>>>>>>//AB/     Set ProjectFileName to "sl22s.sl"
43268>>>>>>>>>
43268>>>>>>>>>// Project Object Structure
43268>>>>>>>>>//   SL22s is a dbModalPanel
43268>>>>>>>>>//     Witemkat_DD is a DataDictionary
43268>>>>>>>>>//     Units_DD is a DataDictionary
43268>>>>>>>>>//     Fpa_DD is a DataDictionary
43268>>>>>>>>>//     Item_DD is a DataDictionary
43268>>>>>>>>>//     oSelList is a dbListSub
43268>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
43268>>>>>>>>>//     ocode is a FormSub
43268>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
43268>>>>>>>>>//     operi is a FormSub
43268>>>>>>>>>//     RadioGroupSub1 is a RadioGroupSub
43268>>>>>>>>>//       Radio1 is a RadioSub
43268>>>>>>>>>//       Radio2 is a RadioSub
43268>>>>>>>>>//     ButtonSub1 is a ButtonSub
43268>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
43268>>>>>>>>>//     ocodekat is a FormSub
43268>>>>>>>>>//     oOK_bn is a ButtonSub
43268>>>>>>>>>//     oCancel_bn is a ButtonSub
43268>>>>>>>>>//     oSearch_bn is a ButtonSub
43268>>>>>>>>>
43268>>>>>>>>>// Register all objects
43268>>>>>>>>>Register_Object ButtonSub1
43268>>>>>>>>>Register_Object Fpa_DD
43268>>>>>>>>>Register_Object Item_DD
43268>>>>>>>>>Register_Object oCancel_bn
43268>>>>>>>>>Register_Object ocode
43268>>>>>>>>>Register_Object ocodekat
43268>>>>>>>>>Register_Object oOK_bn
43268>>>>>>>>>Register_Object operi
43268>>>>>>>>>Register_Object oSearch_bn
43268>>>>>>>>>Register_Object oSelList
43268>>>>>>>>>Register_Object Radio1
43268>>>>>>>>>Register_Object Radio2
43268>>>>>>>>>Register_Object RadioGroupSub1
43268>>>>>>>>>Register_Object SL22s
43268>>>>>>>>>Register_Object TextBoxSub1
43268>>>>>>>>>Register_Object TextBoxSub2
43268>>>>>>>>>Register_Object TextBoxSub3
43268>>>>>>>>>Register_Object Units_DD
43268>>>>>>>>>Register_Object Witemkat_DD
43268>>>>>>>>>
43268>>>>>>>>>
43268>>>>>>>>>
43268>>>>>>>>>//AB-StoreTopStart
43268>>>>>>>>>                                
43268>>>>>>>>>                                
43268>>>>>>>>>//AB-StoreTopEnd
43268>>>>>>>>>
43268>>>>>>>>>//AB-IgnoreStart
43268>>>>>>>>>
43268>>>>>>>>>Use DFAllEnt.pkg
43268>>>>>>>>>Use dbList.Sub
43268>>>>>>>>>Use Txtbox.Sub
43268>>>>>>>>>Use Form.Sub
43268>>>>>>>>>Use Rgroup.Sub
43268>>>>>>>>>Use Radio.Sub
43268>>>>>>>>>Use Button.Sub
43268>>>>>>>>>
43268>>>>>>>>>
43268>>>>>>>>>Use WITEMKAT.DD
43268>>>>>>>>>Use UNITS.DD
43268>>>>>>>>>Use FPA.DD
INCLUDING FILE: FPA.DD
43268>>>>>>>>>>>//DDB-FileStart
43268>>>>>>>>>>>//DDB-HeaderStart
43268>>>>>>>>>>>
43268>>>>>>>>>>>// File Name : FPA.DD
43268>>>>>>>>>>>// Class Name: Fpa_DataDictionary
43268>>>>>>>>>>>// Revision  : 34
43268>>>>>>>>>>>// Version   : 2
43268>>>>>>>>>>>
43268>>>>>>>>>>>Use  Windows           // Basic Definitions
43268>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
43268>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43268>>>>>>>>>>>
43268>>>>>>>>>>>Open Fpa
43270>>>>>>>>>>>Open Iteml
43272>>>>>>>>>>>Open Partlfpa
43274>>>>>>>>>>>Open Item
43276>>>>>>>>>>>
43276>>>>>>>>>>>//DDB-HeaderEnd
43276>>>>>>>>>>>//DDB-SelectionStart
43276>>>>>>>>>>>//DDB/ ExternalSelectionList Fpa  Fpa.SL
43276>>>>>>>>>>>//DDB/ ExternalSelectionList sl150  sl150.SL
43276>>>>>>>>>>>Register_Object Fpa
43276>>>>>>>>>>>Register_Object sl150
43276>>>>>>>>>>>//DDB-SelectionEnd
43276>>>>>>>>>>>
43276>>>>>>>>>>>Class Fpa_DataDictionary  is a DataDictionary_Sec
43277>>>>>>>>>>> 
43277>>>>>>>>>>>    // Validate_Save:
43277>>>>>>>>>>> 
43277>>>>>>>>>>>    Function Validate_Save  Returns Integer
43278>>>>>>>>>>>        Local Integer iReturnVal icheck
43279>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
43281>>>>>>>>>>>        If (Not(iReturnVal)) Begin
43283>>>>>>>>>>>            // Insert Code Here
43283>>>>>>>>>>>         //  if (fpa.agora_codegl <> '') begin
43283>>>>>>>>>>>         //     Move (Check_log(fpa.agora_codegl)) to iCheck  
43283>>>>>>>>>>>         //     if (icheck) Move 104001 to iReturnVal 
43283>>>>>>>>>>>         //  end
43283>>>>>>>>>>>         //  if (fpa.polhsh_codegl <> '') begin
43283>>>>>>>>>>>         //     Move (Check_log(fpa.polhsh_codegl)) to iCheck  
43283>>>>>>>>>>>         //     if (icheck) Move 104002 to iReturnVal
43283>>>>>>>>>>>         //  end   
43283>>>>>>>>>>>         //  If (iReturnVal) Send Operation_Not_Allowed iReturnVal
43283>>>>>>>>>>>        End
43283>>>>>>>>>>>>
43283>>>>>>>>>>>        Function_Return iReturnVal
43284>>>>>>>>>>>    End_Function   // Validate_Save
43285>>>>>>>>>>> 
43285>>>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
43286>>>>>>>>>>>        String lsError_Message
43287>>>>>>>>>>>        Case Begin
43287>>>>>>>>>>>            Case (iError_Num = 104001)
43289>>>>>>>>>>>                Move "DDC 104: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ”..€ ˜š¦¨é¤" to lsError_Message
43290>>>>>>>>>>>              Case Break
43291>>>>>>>>>>>            Case (iError_Num = 104002)
43294>>>>>>>>>>>                Move "DDC 104: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ”..€ §à¢ã©œà¤" to lsError_Message
43295>>>>>>>>>>>              Case Break
43296>>>>>>>>>>>            Case Else
43296>>>>>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
43298>>>>>>>>>>>        Case End
43298>>>>>>>>>>>        Error iError_Num lsError_Message
43299>>>>>>>>>>>>
43299>>>>>>>>>>>    End_Procedure // operation_not_allowed
43300>>>>>>>>>>>
43300>>>>>>>>>>>    // Define_Fields:
43300>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
43300>>>>>>>>>>>
43300>>>>>>>>>>>    Procedure Define_Fields
43301>>>>>>>>>>>        Forward Send Define_Fields
43303>>>>>>>>>>>        //DDB-Generated-Code-Location
43303>>>>>>>>>>>        //DDB-DefineFieldStart
43303>>>>>>>>>>>
43303>>>>>>>>>>>        Set Main_File            To Fpa.File_Number
43304>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
43305>>>>>>>>>>>
43305>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
43306>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
43307>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43308>>>>>>>>>>>
43308>>>>>>>>>>>        // Child (Client) file structure................
43308>>>>>>>>>>>        Send Add_Client_File  Iteml.File_Number
43309>>>>>>>>>>>        Send Add_Client_File  Partlfpa.File_Number
43310>>>>>>>>>>>        Send Add_Client_File  Item.File_Number
43311>>>>>>>>>>>
43311>>>>>>>>>>>        // Field-based properties.......................
43311>>>>>>>>>>>
43311>>>>>>>>>>>        // Fpa.Fpa_Pososto
43311>>>>>>>>>>>        Set Field_Options          Field Fpa.Fpa_Pososto To DD_AUTOFIND    DD_REQUIRED   
43312>>>>>>>>>>>        Set Field_Prompt_Object    Field Fpa.Fpa_Pososto To (Fpa(Self))
43313>>>>>>>>>>>        Set Key_Field_State        Field Fpa.Fpa_Pososto To TRUE
43314>>>>>>>>>>>
43314>>>>>>>>>>>        // Fpa.Fpa_Descr
43314>>>>>>>>>>>        Set Field_Options          Field Fpa.Fpa_Descr To DD_AUTOFIND   
43315>>>>>>>>>>>        Set Field_Prompt_Object    Field Fpa.Fpa_Descr To (Fpa(Self))
43316>>>>>>>>>>>
43316>>>>>>>>>>>        // Fpa.Agora_Codegl
43316>>>>>>>>>>>        Set Field_Prompt_Object    Field Fpa.Agora_Codegl To (sl150(Self))
43317>>>>>>>>>>>
43317>>>>>>>>>>>        // Fpa.Polhsh_Codegl
43317>>>>>>>>>>>
43317>>>>>>>>>>>        //DDB-DefineFieldEnd
43317>>>>>>>>>>>    End_Procedure    // Define_Fields
43318>>>>>>>>>>>
43318>>>>>>>>>>>    // Field_Defaults:
43318>>>>>>>>>>>    // This procedure is used to establish default field values.
43318>>>>>>>>>>>
43318>>>>>>>>>>>    Procedure Field_Defaults
43319>>>>>>>>>>>        Forward Send Field_Defaults
43321>>>>>>>>>>>        //DDB-Generated-Code-Location
43321>>>>>>>>>>>        //DDB-FieldDefaultStart
43321>>>>>>>>>>>        //DDB-FieldDefaultEnd
43321>>>>>>>>>>>    End_Procedure    // Field_Defaults
43322>>>>>>>>>>>
43322>>>>>>>>>>>End_Class    // Fpa_DataDictionary
43323>>>>>>>>>>>//DDB-Selection-pkg-Start
43323>>>>>>>>>>>
43323>>>>>>>>>>>Use Fpa.SL           // Fpa
INCLUDING FILE: FPA.SL
43323>>>>>>>>>>>>>//AB/ Project Fpa:Lookup
43323>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
43323>>>>>>>>>>>>>//AB/     Set ProjectName to "Fpa:Lookup"
43323>>>>>>>>>>>>>//AB/     Set ProjectFileName to "Fpa.SL"
43323>>>>>>>>>>>>>
43323>>>>>>>>>>>>>// Project Object Structure
43323>>>>>>>>>>>>>//   Fpa is a dbModalPanelSub
43323>>>>>>>>>>>>>//     Fpa_DD is a DataDictionary
43323>>>>>>>>>>>>>//     oSelList is a dbListSub
43323>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
43323>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
43323>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
43323>>>>>>>>>>>>>
43323>>>>>>>>>>>>>// Register all objects
43323>>>>>>>>>>>>>Register_Object Fpa
43323>>>>>>>>>>>>>Register_Object Fpa_DD
43323>>>>>>>>>>>>>Register_Object oCancel_bn
43323>>>>>>>>>>>>>Register_Object oOK_bn
43323>>>>>>>>>>>>>Register_Object oSearch_bn
43323>>>>>>>>>>>>>Register_Object oSelList
43323>>>>>>>>>>>>>
43323>>>>>>>>>>>>>
43323>>>>>>>>>>>>>//AB-IgnoreStart
43323>>>>>>>>>>>>>
43323>>>>>>>>>>>>>Use DFAllEnt.pkg
43323>>>>>>>>>>>>>Use dbList.Sub
43323>>>>>>>>>>>>>Use Button.Sub
43323>>>>>>>>>>>>>
43323>>>>>>>>>>>>>
43323>>>>>>>>>>>>>Use FPA.DD
43323>>>>>>>>>>>>>
43323>>>>>>>>>>>>>//AB-IgnoreEnd
43323>>>>>>>>>>>>>
43323>>>>>>>>>>>>>CD_Popup_Object Fpa is a dbModalPanelSub
43342>>>>>>>>>>>>>    set label to "¦©¦©«á ”..€." 
43343>>>>>>>>>>>>>    Set Size to 148 181
43344>>>>>>>>>>>>>    Set Location to 4 5
43345>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
43346>>>>>>>>>>>>>    Set Modal_State to FALSE
43347>>>>>>>>>>>>>
43347>>>>>>>>>>>>>    //AB-DDOStart
43347>>>>>>>>>>>>>
43347>>>>>>>>>>>>>    Object Fpa_DD is a Fpa_DataDictionary
43349>>>>>>>>>>>>>    End_Object    // Fpa_DD
43350>>>>>>>>>>>>>
43350>>>>>>>>>>>>>    Set Main_DD to (Fpa_DD(self))
43351>>>>>>>>>>>>>    Set Server to (Fpa_DD(self))
43352>>>>>>>>>>>>>
43352>>>>>>>>>>>>>    //AB-DDOEnd
43352>>>>>>>>>>>>>
43352>>>>>>>>>>>>>    Object oSelList is a dbListSub
43354>>>>>>>>>>>>>        Set Main_File to Fpa.File_Number
43355>>>>>>>>>>>>>        Set Size to 105 165
43356>>>>>>>>>>>>>        Set Location to 6 6
43357>>>>>>>>>>>>>
43357>>>>>>>>>>>>>        Begin_Row
43360>>>>>>>>>>>>>            Entry_Item Fpa.Fpa_pososto
43361>>>>>>>>>>>>>            Entry_Item Fpa.Fpa_descr
43362>>>>>>>>>>>>>        End_Row
43367>>>>>>>>>>>>>
43367>>>>>>>>>>>>>        Set Form_Width    item 0 to 66
43368>>>>>>>>>>>>>        set header_label  item 0 to "% ”€" 
43369>>>>>>>>>>>>>        
43369>>>>>>>>>>>>>        Set Form_Width    item 1 to 90
43370>>>>>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
43371>>>>>>>>>>>>>        
43371>>>>>>>>>>>>>    End_Object    // oSelList
43372>>>>>>>>>>>>>
43372>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
43374>>>>>>>>>>>>>        set label to "&„§ ¢¦šã" 
43375>>>>>>>>>>>>>        Set Size to 14 46
43376>>>>>>>>>>>>>        Set Location to 113 26
43377>>>>>>>>>>>>>
43377>>>>>>>>>>>>>        //AB-StoreStart
43377>>>>>>>>>>>>>        Procedure OnClick
43379>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
43380>>>>>>>>>>>>>        End_Procedure
43381>>>>>>>>>>>>>        //AB-StoreEnd
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>    End_Object    // oOK_bn
43382>>>>>>>>>>>>>
43382>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
43384>>>>>>>>>>>>>        set label to "&€¡ç¨à©ž" 
43385>>>>>>>>>>>>>        Set Size to 14 46
43386>>>>>>>>>>>>>        Set Location to 113 75
43387>>>>>>>>>>>>>
43387>>>>>>>>>>>>>        //AB-StoreStart
43387>>>>>>>>>>>>>        Procedure OnClick
43389>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
43390>>>>>>>>>>>>>        End_Procedure
43391>>>>>>>>>>>>>        //AB-StoreEnd
43391>>>>>>>>>>>>>
43391>>>>>>>>>>>>>    End_Object    // oCancel_bn
43392>>>>>>>>>>>>>
43392>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
43394>>>>>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
43395>>>>>>>>>>>>>        Set Size to 14 46
43396>>>>>>>>>>>>>        Set Location to 113 126
43397>>>>>>>>>>>>>
43397>>>>>>>>>>>>>        //AB-StoreStart
43397>>>>>>>>>>>>>        Procedure OnClick
43399>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
43400>>>>>>>>>>>>>        End_Procedure
43401>>>>>>>>>>>>>        //AB-StoreEnd
43401>>>>>>>>>>>>>
43401>>>>>>>>>>>>>    End_Object    // oSearch_bn
43402>>>>>>>>>>>>>
43402>>>>>>>>>>>>>
43402>>>>>>>>>>>>>    //AB-StoreStart
43402>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
43403>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
43404>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
43405>>>>>>>>>>>>>    //AB-StoreEnd
43405>>>>>>>>>>>>>
43405>>>>>>>>>>>>>CD_End_Object    // Fpa
43407>>>>>>>>>>>>>>
43407>>>>>>>>>>>>>
43407>>>>>>>>>>>>>//AB/ End_Object    // prj
43407>>>>>>>>>>>Use sl150.SL         // sl150
INCLUDING FILE: SL150.SL
43407>>>>>>>>>>>>>//AB/ Project sl150:GL Gplan
43407>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
43407>>>>>>>>>>>>>//AB/         Set ProjectName to "sl150:GL Gplan"
43407>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl150.SL"
43407>>>>>>>>>>>>>
43407>>>>>>>>>>>>>// Project Object Structure
43407>>>>>>>>>>>>>//   sl150 is a dbModalPanelSub
43407>>>>>>>>>>>>>//     Gplan_DD is a DataDictionary
43407>>>>>>>>>>>>>//     oSelList is a dbListSub
43407>>>>>>>>>>>>>//     oOK_bn is a Button
43407>>>>>>>>>>>>>//     oCancel_bn is a Button
43407>>>>>>>>>>>>>//     oSearch_bn is a Button
43407>>>>>>>>>>>>>
43407>>>>>>>>>>>>>// Register all objects
43407>>>>>>>>>>>>>Register_Object Gplan_DD
43407>>>>>>>>>>>>>Register_Object oCancel_bn
43407>>>>>>>>>>>>>Register_Object oOK_bn
43407>>>>>>>>>>>>>Register_Object oSearch_bn
43407>>>>>>>>>>>>>Register_Object oSelList
43407>>>>>>>>>>>>>Register_Object sl150
43407>>>>>>>>>>>>>
43407>>>>>>>>>>>>>
43407>>>>>>>>>>>>>    //AB-IgnoreStart
43407>>>>>>>>>>>>>
43407>>>>>>>>>>>>>    Use DFAllEnt.pkg
43407>>>>>>>>>>>>>    Use dbList.Sub
43407>>>>>>>>>>>>>
43407>>>>>>>>>>>>>
43407>>>>>>>>>>>>>    Use GPLAN.DD
INCLUDING FILE: GPLAN.DD
43407>>>>>>>>>>>>>>>//DDB-FileStart
43407>>>>>>>>>>>>>>>//DDB-HeaderStart
43407>>>>>>>>>>>>>>>
43407>>>>>>>>>>>>>>>// File Name : GPLAN.DD
43407>>>>>>>>>>>>>>>// Class Name: Gplan_DataDictionary
43407>>>>>>>>>>>>>>>// Revision  : 132
43407>>>>>>>>>>>>>>>// Version   : 2
43407>>>>>>>>>>>>>>>
43407>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
43407>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
43407>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43407>>>>>>>>>>>>>>>
43407>>>>>>>>>>>>>>>Open Gplan
43409>>>>>>>>>>>>>>>Open Gmovea
INCLUDING FILE: GMOVEA.FD
43411>>>>>>>>>>>>>>>Open Gplanmod
INCLUDING FILE: GPLANMOD.FD
43413>>>>>>>>>>>>>>>Open Gmhnes
INCLUDING FILE: GMHNES.FD
43415>>>>>>>>>>>>>>>Open Gvatd
INCLUDING FILE: GVATD.FD
43417>>>>>>>>>>>>>>>Open Gpmoves
INCLUDING FILE: GPMOVES.FD
43419>>>>>>>>>>>>>>>Open Sysrecg
43421>>>>>>>>>>>>>>>Open Syscurgl
43423>>>>>>>>>>>>>>>
43423>>>>>>>>>>>>>>>//DDB-HeaderEnd
43423>>>>>>>>>>>>>>>//DDB-ValidationStart
43423>>>>>>>>>>>>>>>
43423>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_O_Code_VT
43423>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Yn_VT
43423>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Xpm_VT
43423>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Doy_VT
43423>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_J_Code_VT
43423>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_C_Code2_VT
43423>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_I_A_Code_VT2
43423>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Myf_Sum_VT
43423>>>>>>>>>>>>>>>
43423>>>>>>>>>>>>>>>Object Gplan_Gplan_O_Code_VT  is a CodeValidationTable
43425>>>>>>>>>>>>>>>    Set Type_Value        To "OMADA"
43426>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
43427>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43427>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43427>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_O_Code_VT
43428>>>>>>>>>>>>>>>
43428>>>>>>>>>>>>>>>Object Gplan_Gplan_Yn_VT  is a CodeValidationTable
43430>>>>>>>>>>>>>>>    Set Type_Value        To "YESNO"
43431>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43431>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43431>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Yn_VT
43432>>>>>>>>>>>>>>>
43432>>>>>>>>>>>>>>>Object Gplan_Gplan_Xpm_VT  is a DescriptionValidationTable
43434>>>>>>>>>>>>>>>
43434>>>>>>>>>>>>>>>    Procedure Fill_List
43436>>>>>>>>>>>>>>>        Forward Send Fill_List
43438>>>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "•¨œ¦ç£œ¤¦ª"
43439>>>>>>>>>>>>>>>        Send Add_Table_Value  "2"  " ©«¦ç£œ¤¦ª"
43440>>>>>>>>>>>>>>>        Send Add_Table_Value  "3"  "‹ ¡«æª"
43441>>>>>>>>>>>>>>>    End_Procedure    // Fill_List
43442>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43442>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43442>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Xpm_VT
43443>>>>>>>>>>>>>>>
43443>>>>>>>>>>>>>>>Object Gplan_Gplan_Doy_VT  is a CodeValidationTable
43445>>>>>>>>>>>>>>>    Set Type_Value        To "DOY"
43446>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
43447>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43447>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43447>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Doy_VT
43448>>>>>>>>>>>>>>>
43448>>>>>>>>>>>>>>>Object Gplan_Gplan_J_Code_VT  is a CodeValidationTable
43450>>>>>>>>>>>>>>>    Set Type_Value        To "JOB"
43451>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
43452>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43452>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43452>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_J_Code_VT
43453>>>>>>>>>>>>>>>
43453>>>>>>>>>>>>>>>Object Gplan_Gplan_C_Code2_VT  is a CodeValidationTable
43455>>>>>>>>>>>>>>>    Set Type_Value        To "CURRENCY"
43456>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
43457>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43457>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43457>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_C_Code2_VT
43458>>>>>>>>>>>>>>>
43458>>>>>>>>>>>>>>>Object Gplan_Gplan_I_A_Code_VT2  is a CodeValidationTable
43460>>>>>>>>>>>>>>>    Set Type_Value        To "AITIOL"
43461>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
43462>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43462>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43462>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_I_A_Code_VT2
43463>>>>>>>>>>>>>>>
43463>>>>>>>>>>>>>>>Object Gplan_Gplan_Myf_Sum_VT  is a CodeValidationTable
43465>>>>>>>>>>>>>>>    Set Type_Value        To "MYF"
43466>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43466>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43466>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Myf_Sum_VT
43467>>>>>>>>>>>>>>>//DDB-ValidationEnd
43467>>>>>>>>>>>>>>>//DDB-SelectionStart
43467>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl150  sl150.sl
43467>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList Gtypkin  Gtypkin.sl
43467>>>>>>>>>>>>>>>Register_Object sl150
43467>>>>>>>>>>>>>>>Register_Object Gtypkin
43467>>>>>>>>>>>>>>>//DDB-SelectionEnd
43467>>>>>>>>>>>>>>>Use arrays.Sub
43467>>>>>>>>>>>>>>>
43467>>>>>>>>>>>>>>>Use Gmovea.dd //®¨œ áœ«˜  ¦§à›ã§¦«œ, › æ«  œå¤˜  alias file ¡˜ 
INCLUDING FILE: GMOVEA.DD
43467>>>>>>>>>>>>>>>>>//DDB-FileStart
43467>>>>>>>>>>>>>>>>>//DDB-HeaderStart
43467>>>>>>>>>>>>>>>>>
43467>>>>>>>>>>>>>>>>>// File Name : GMOVEA.DD
43467>>>>>>>>>>>>>>>>>// Class Name: Gmovea_DataDictionary
43467>>>>>>>>>>>>>>>>>// Revision  : 17
43467>>>>>>>>>>>>>>>>>// Version   : 2
43467>>>>>>>>>>>>>>>>>
43467>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
43467>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
43467>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43467>>>>>>>>>>>>>>>>>
43467>>>>>>>>>>>>>>>>>Open Gmovea
43469>>>>>>>>>>>>>>>>>Open Gopen
INCLUDING FILE: GOPEN.FD
43471>>>>>>>>>>>>>>>>>Open Garticl
INCLUDING FILE: GARTICL.FD
43473>>>>>>>>>>>>>>>>>Open Gplan
43475>>>>>>>>>>>>>>>>>
43475>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
43475>>>>>>>>>>>>>>>>>
43475>>>>>>>>>>>>>>>>>//open master file
43475>>>>>>>>>>>>>>>>>Open Gmove
43477>>>>>>>>>>>>>>>>>
43477>>>>>>>>>>>>>>>>>//define alias-master condition
43477>>>>>>>>>>>>>>>>>Set_Attribute DF_FILE_ALIAS of Gmovea.File_Number to DF_FILE_IS_ALIAS
43480>>>>>>>>>>>>>>>>>Set_Attribute DF_FILE_ALIAS of Gmove.File_Number  to DF_FILE_IS_MASTER
43483>>>>>>>>>>>>>>>>>
43483>>>>>>>>>>>>>>>>>//clear all relationships from the alias file
43483>>>>>>>>>>>>>>>>>Set_Relate Gmovea.Garticl_Recr to |FN0,0
43484>>>>>>>>>>>>>>>>>>
43484>>>>>>>>>>>>>>>>>Set_Relate Gmovea.Gplan_Recr   to |FN0,0
43485>>>>>>>>>>>>>>>>>>
43485>>>>>>>>>>>>>>>>>
43485>>>>>>>>>>>>>>>>>
43485>>>>>>>>>>>>>>>>>Class Gmovea_DataDictionary  is a DataDictionary_Sec
43486>>>>>>>>>>>>>>>>>
43486>>>>>>>>>>>>>>>>>
43486>>>>>>>>>>>>>>>>>      //private
43486>>>>>>>>>>>>>>>>>      //œ¤ž£œ¨é¤œ  «˜ 13 §œ›å˜ open item
43486>>>>>>>>>>>>>>>>>      //¡˜¢œå«˜  ˜§æ update
43486>>>>>>>>>>>>>>>>>      Procedure private.Do_Compute_Open_Itemsa
43487>>>>>>>>>>>>>>>>>                Case Begin
43487>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_X0 > 0) //˜«æ­ ¦ ®¨œà©« ¡æ record
43489>>>>>>>>>>>>>>>>>                          Move "+"                                                 to Gmovea.Gmove_Topen
43490>>>>>>>>>>>>>>>>>                          Move (     Gmovea.Gmove_X0  - Gmovea.Gmove_Open_Sx0) to Gmovea.Gmove_Open_Yx0
43491>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yp0
43492>>>>>>>>>>>>>>>>>                     Case Break
43493>>>>>>>>>>>>>>>>>
43493>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_X0 < 0) //¯œ¬«¦- ®¨œà©« ¡æ record
43496>>>>>>>>>>>>>>>>>                          Move "-"                                                 to Gmovea.Gmove_Topen
43497>>>>>>>>>>>>>>>>>                          Move ((Abs(Gmovea.Gmove_X0))- Gmovea.Gmove_Open_Sp0) to Gmovea.Gmove_Open_Yp0
43498>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yx0
43499>>>>>>>>>>>>>>>>>                     Case Break
43500>>>>>>>>>>>>>>>>>
43500>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_P0 > 0) //˜«æ­ ¦ § ©«à« ¡æ record
43503>>>>>>>>>>>>>>>>>                          Move "-"                                                 to Gmovea.Gmove_Topen
43504>>>>>>>>>>>>>>>>>                          Move (     Gmovea.Gmove_P0  - Gmovea.Gmove_Open_Sp0) to Gmovea.Gmove_Open_Yp0
43505>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yx0
43506>>>>>>>>>>>>>>>>>                     Case Break
43507>>>>>>>>>>>>>>>>>
43507>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_P0 < 0) //¯œç«¦- ®¨œà©« ¡æ record
43510>>>>>>>>>>>>>>>>>                          Move "+"                                                 to Gmovea.Gmove_Topen
43511>>>>>>>>>>>>>>>>>                          Move ((Abs(Gmovea.Gmove_P0))- Gmovea.Gmove_Open_Sx0) to Gmovea.Gmove_Open_Yx0
43512>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yp0
43513>>>>>>>>>>>>>>>>>                     Case Break
43514>>>>>>>>>>>>>>>>>                Case End
43514>>>>>>>>>>>>>>>>>      End_Procedure //private.do_compute_open_itemsa
43515>>>>>>>>>>>>>>>>>
43515>>>>>>>>>>>>>>>>>
43515>>>>>>>>>>>>>>>>>
43515>>>>>>>>>>>>>>>>>      //private
43515>>>>>>>>>>>>>>>>>      //œ¢âš®œ  «˜ 13 §œ›å˜ open item
43515>>>>>>>>>>>>>>>>>      //¡˜¢œå«˜  ˜§æ validate save
43515>>>>>>>>>>>>>>>>>      Function  private.fi_Validate_Open_Itemsa Returns Integer
43516>>>>>>>>>>>>>>>>>
43516>>>>>>>>>>>>>>>>>                 //1101+1102+1103+1104:â¢œš®¦  £ã ˜¨¤ž« ¡é¤ ¬§¦¢¦å§à¤ §¨¦ª ©¬©®â« ©ž ¡˜  ©¬©®œ« ©Ÿâ¤«à¤ §¦©é¤
43516>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 >= 0                       )) Function_Return 1101
43519>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 >= 0                       )) Function_Return 1102
43522>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 >= 0                       )) Function_Return 1103
43525>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 >= 0                       )) Function_Return 1104
43528>>>>>>>>>>>>>>>>>
43528>>>>>>>>>>>>>>>>>                 Case Begin
43528>>>>>>>>>>>>>>>>>                      //1105+1106+1107+1108:â¢œš®¦  š ˜ ˜«æ­ ¦ ®¨œà©« ¡æ record
43528>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_X0 > 0)
43530>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 <=      Gmovea.Gmove_X0  )) Function_Return 1105
43533>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 <=      Gmovea.Gmove_X0  )) Function_Return 1106
43536>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0  = 0                       )) Function_Return 1107
43539>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0  = 0                       )) Function_Return 1108
43542>>>>>>>>>>>>>>>>>                      Case Break
43543>>>>>>>>>>>>>>>>>                      //1109+1110+1111+1112:â¢œš®¦  š ˜ ¯œ¬«¦- ®¨œà©« ¡æ record
43543>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_X0 < 0)
43546>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0  = 0                       )) Function_Return 1109
43549>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0  = 0                       )) Function_Return 1110
43552>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 <= (Abs(Gmovea.Gmove_X0)))) Function_Return 1111
43555>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 <= (Abs(Gmovea.Gmove_X0)))) Function_Return 1112
43558>>>>>>>>>>>>>>>>>                      Case Break
43559>>>>>>>>>>>>>>>>>                      //1113+1114+1115+1116:â¢œš®¦  š ˜ ˜«æ­ ¦ § ©«à« ¡æ record
43559>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_P0 > 0)
43562>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0  = 0                       )) Function_Return 1113
43565>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0  = 0                       )) Function_Return 1114
43568>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 <=      Gmovea.Gmove_P0  )) Function_Return 1115
43571>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 <=      Gmovea.Gmove_P0  )) Function_Return 1116
43574>>>>>>>>>>>>>>>>>                      Case Break
43575>>>>>>>>>>>>>>>>>                      //1117+1118+1119+1120:â¢œš®¦  š ˜ ¯œç«¦- ®¨œà©« ¡æ record
43575>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_P0 < 0)
43578>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 <= (Abs(Gmovea.Gmove_P0)))) Function_Return 1117
43581>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 <= (Abs(Gmovea.Gmove_P0)))) Function_Return 1118
43584>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0  = 0                       )) Function_Return 1119
43587>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0  = 0                       )) Function_Return 1120
43590>>>>>>>>>>>>>>>>>                      Case Break
43591>>>>>>>>>>>>>>>>>                 Case End
43591>>>>>>>>>>>>>>>>>
43591>>>>>>>>>>>>>>>>>                 Function_Return 0 //æ¢˜ ok
43592>>>>>>>>>>>>>>>>>      End_Function //private.fi_validate_open_itemsa
43593>>>>>>>>>>>>>>>>>
43593>>>>>>>>>>>>>>>>>    Procedure Update
43594>>>>>>>>>>>>>>>>>          Send private.Do_Compute_Open_Itemsa
43595>>>>>>>>>>>>>>>>>    End_Procedure //update
43596>>>>>>>>>>>>>>>>>
43596>>>>>>>>>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
43597>>>>>>>>>>>>>>>>>              String lsError_Message
43598>>>>>>>>>>>>>>>>>              Case Begin
43598>>>>>>>>>>>>>>>>>                   //˜§æ validate save
43598>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1101)
43600>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ œå¤˜  ˜¨¤ž« ¡æ !");                        to lsError_Message
43601>>>>>>>>>>>>>>>>>                   Case Break
43602>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1102)
43605>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ œå¤˜  ˜¨¤ž« ¡æ !");                        to lsError_Message
43606>>>>>>>>>>>>>>>>>                   Case Break
43607>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1103)
43610>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª œå¤˜  ˜¨¤ž« ¡ã !");                        to lsError_Message
43611>>>>>>>>>>>>>>>>>                   Case Break
43612>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1104)
43615>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª œå¤˜  ˜¨¤ž« ¡ã !");                        to lsError_Message
43616>>>>>>>>>>>>>>>>>                   Case Break
43617>>>>>>>>>>>>>>>>>                   //---------------------------------------Ÿœ« ¡âª ®¨œé©œ ª-----------------
43617>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1105)
43620>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã ®¨âà©ž !");                        to lsError_Message
43621>>>>>>>>>>>>>>>>>                   Case Break
43622>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1106)
43625>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã ®¨âà©ž !");                        to lsError_Message
43626>>>>>>>>>>>>>>>>>                   Case Break
43627>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1107)
43630>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ !");                        to lsError_Message
43631>>>>>>>>>>>>>>>>>                   Case Break
43632>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1108)
43635>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
43636>>>>>>>>>>>>>>>>>                   Case Break
43637>>>>>>>>>>>>>>>>>                   //---------------------------------------˜¨¤ž« ¡âª ®¨œé©œ ª---------------
43637>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1109)
43640>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ!");                        to lsError_Message
43641>>>>>>>>>>>>>>>>>                   Case Break
43642>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1110)
43645>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
43646>>>>>>>>>>>>>>>>>                   Case Break
43647>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1111)
43650>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª ®¨âà©žª !");                        to lsError_Message
43651>>>>>>>>>>>>>>>>>                   Case Break
43652>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1112)
43655>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª ®¨âà©žª !");                        to lsError_Message
43656>>>>>>>>>>>>>>>>>                   Case Break
43657>>>>>>>>>>>>>>>>>                   //---------------------------------------Ÿœ« ¡âª § ©«é©œ ª----------------
43657>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1113)
43660>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ !");                        to lsError_Message
43661>>>>>>>>>>>>>>>>>                   Case Break
43662>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1114)
43665>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
43666>>>>>>>>>>>>>>>>>                   Case Break
43667>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1115)
43670>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã §å©«à©ž !");                        to lsError_Message
43671>>>>>>>>>>>>>>>>>                   Case Break
43672>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1116)
43675>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã §å©«à©ž !");                        to lsError_Message
43676>>>>>>>>>>>>>>>>>                   Case Break
43677>>>>>>>>>>>>>>>>>                   //---------------------------------------˜¨àž« ¡âª § ©«é©œ ª----------------
43677>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1117)
43680>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ!");                        to lsError_Message
43681>>>>>>>>>>>>>>>>>                   Case Break
43682>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1118)
43685>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
43686>>>>>>>>>>>>>>>>>                   Case Break
43687>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1119)
43690>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª §å©«à©žª !");                        to lsError_Message
43691>>>>>>>>>>>>>>>>>                   Case Break
43692>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1120) //soso ayto den xoraei display stin othoni !
43695>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª §å©«à©žª !");                        to lsError_Message
43696>>>>>>>>>>>>>>>>>                   Case Break
43697>>>>>>>>>>>>>>>>>
43697>>>>>>>>>>>>>>>>>
43697>>>>>>>>>>>>>>>>>                   //˜§æ validate delete
43697>>>>>>>>>>>>>>>>>                   Case (iError_Num = 2001)
43700>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n˜¨˜¡˜¢é ¡˜¢â©˜«œ «ž¤ Solution !");                        to lsError_Message
43701>>>>>>>>>>>>>>>>>                   Case Break
43702>>>>>>>>>>>>>>>>>
43702>>>>>>>>>>>>>>>>>                   Case Else
43702>>>>>>>>>>>>>>>>>                        Forward Send Operation_Not_Allowed iError_Num
43704>>>>>>>>>>>>>>>>>              Case End
43704>>>>>>>>>>>>>>>>>
43704>>>>>>>>>>>>>>>>>              Error iError_Num lsError_Message
43705>>>>>>>>>>>>>>>>>>
43705>>>>>>>>>>>>>>>>>    End_Procedure   //operation_not_allowed
43706>>>>>>>>>>>>>>>>>
43706>>>>>>>>>>>>>>>>>
43706>>>>>>>>>>>>>>>>>    Function Validate_Save Returns Integer
43707>>>>>>>>>>>>>>>>>             Integer iReturnVal liOpen_Itemsa
43708>>>>>>>>>>>>>>>>>             Forward Get Validate_Save to iReturnVal
43710>>>>>>>>>>>>>>>>>
43710>>>>>>>>>>>>>>>>>             If (Not(iReturnVal));             Begin
43712>>>>>>>>>>>>>>>>>             //1101-1120:â¢œš®¦  open item
43712>>>>>>>>>>>>>>>>>              Move (private.fi_Validate_Open_Itemsa(Self)) to liOpen_Itemsa
43713>>>>>>>>>>>>>>>>>              If (liOpen_Itemsa <> 0) Send Operation_Not_Allowed liOpen_Itemsa
43716>>>>>>>>>>>>>>>>>             End //«â¢¦ª ¡é› ¡˜ validation
43716>>>>>>>>>>>>>>>>>>
43716>>>>>>>>>>>>>>>>>
43716>>>>>>>>>>>>>>>>>
43716>>>>>>>>>>>>>>>>>             Function_Return iReturnVal
43717>>>>>>>>>>>>>>>>>    End_Function //validate_save
43718>>>>>>>>>>>>>>>>>
43718>>>>>>>>>>>>>>>>>
43718>>>>>>>>>>>>>>>>>    //2001:«¦ alias Gmovea ›â¤ œ§ «¨â§œ  ‰ € ‹ ˆ €   › ˜š¨˜­ã
43718>>>>>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
43719>>>>>>>>>>>>>>>>>             Send Operation_Not_Allowed 2001 //¢áŸ¦ª «¦¬ ¡é› ¡˜ !!!
43720>>>>>>>>>>>>>>>>>    End_Function //validate_delete
43721>>>>>>>>>>>>>>>>>
43721>>>>>>>>>>>>>>>>>
43721>>>>>>>>>>>>>>>>>    // Define_Fields:
43721>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
43721>>>>>>>>>>>>>>>>>
43721>>>>>>>>>>>>>>>>>    Procedure Define_Fields
43722>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
43724>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43724>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
43724>>>>>>>>>>>>>>>>>
43724>>>>>>>>>>>>>>>>>        Set Main_File            To Gmovea.File_Number
43725>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
43726>>>>>>>>>>>>>>>>>
43726>>>>>>>>>>>>>>>>>
43726>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
43726>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gopen.File_Number
43727>>>>>>>>>>>>>>>>>
43727>>>>>>>>>>>>>>>>>        // Parent (Server) file structure...............
43727>>>>>>>>>>>>>>>>>        Send Add_Server_File  Garticl.File_Number
43728>>>>>>>>>>>>>>>>>        Send Add_Server_File  Gplan.File_Number
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Field-based properties.......................
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Company_Code
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Branch_Code
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Year_Year
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Code
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Garticl_Hmnia
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Garticl_No
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Garticl_Recr
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Recr
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Rec0
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Code
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Aitiol
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X0
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P0
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X0k
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P0k
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X00
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P00
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X00k
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P00k
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X1
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P1
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X2
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P2
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X2k
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P2k
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Xr
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Pr
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Xrk
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Prk
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Dlixis
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_A_Code
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gthhmgio_Code
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Aa
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx0
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp0
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx0
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp0
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx1
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp1
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx1
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp1
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx2
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp2
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx2
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp2
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Sc_Code2
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Aopen
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Topen
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Kk
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gthhmgio_Period
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Yn_Myfp
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Yn_Myfa
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Myf_Sump
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Myf_Suma
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag01
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag02
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag03
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag04
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag05
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag06
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag07
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag08
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag09
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag10
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag11
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag12
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag13
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag14
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag15
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag16
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag17
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag18
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag19
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag20
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Year_Recr
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Recr
43729>>>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
43729>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
43730>>>>>>>>>>>>>>>>>
43730>>>>>>>>>>>>>>>>>    // Field_Defaults:
43730>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
43730>>>>>>>>>>>>>>>>>
43730>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
43731>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
43733>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43733>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
43733>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
43733>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
43734>>>>>>>>>>>>>>>>>End_Class    // Gmovea_DataDictionary
43735>>>>>>>>>>>>>>>>>//DDB-FileEnd
43735>>>>>>>>>>>>>>>              //©«ž¤ begin_transaction §¨¦¡˜¢œå deadlock
43735>>>>>>>>>>>>>>>
43735>>>>>>>>>>>>>>>Class Gplan_DataDictionary  is a DataDictionary_Sec
43736>>>>>>>>>>>>>>>
43736>>>>>>>>>>>>>>>    Procedure Construct_Object
43737>>>>>>>>>>>>>>>        Forward Send Construct_Object
43739>>>>>>>>>>>>>>>        Object oarrayGplan_Aux is a cPinakas
43741>>>>>>>>>>>>>>>        End_Object
43742>>>>>>>>>>>>>>>        Property Integer    pioarray_Gplan_Aux (oarrayGplan_Aux(self))
43743>>>>>>>>>>>>>>>        Property String     psValidChars ""
43744>>>>>>>>>>>>>>>        Property Integer    piMustNOTConstrain Public 0 
43745>>>>>>>>>>>>>>>        Property String     psBranch 
43746>>>>>>>>>>>>>>>    End_Procedure   // Construct_Object
43747>>>>>>>>>>>>>>>
43747>>>>>>>>>>>>>>>    Procedure OnConstrain
43748>>>>>>>>>>>>>>>        Forward Send OnConstrain
43750>>>>>>>>>>>>>>>        If (piMustNOTConstrain(Self)) Begin
43752>>>>>>>>>>>>>>>        End
43752>>>>>>>>>>>>>>>>
43752>>>>>>>>>>>>>>>        Else Begin
43753>>>>>>>>>>>>>>>            Constrain Gplan.Company_Code  eq SysCurGL.Company_Code
43755>>>>>>>>>>>>>>>            Constrain Gplan.Branch_Code   eq SysCurGL.Branch_Code
43757>>>>>>>>>>>>>>>        End
43757>>>>>>>>>>>>>>>>
43757>>>>>>>>>>>>>>>    End_Procedure
43758>>>>>>>>>>>>>>>
43758>>>>>>>>>>>>>>>    Procedure Update
43759>>>>>>>>>>>>>>>        Forward Send Update
43761>>>>>>>>>>>>>>>        // Insert Code Here
43761>>>>>>>>>>>>>>>        Move SysCurGL.Company_Code  to Gplan.Company_Code
43762>>>>>>>>>>>>>>>        Move SysCurGL.Branch_Code   to Gplan.Branch_Code
43763>>>>>>>>>>>>>>>        Move SysCurGL.Year_Year     to Gplan.Year_Year
43764>>>>>>>>>>>>>>>        Move SysCurGL.Year_Recr     to Gplan.Year_Recr
43765>>>>>>>>>>>>>>>    End_Procedure   // Update
43766>>>>>>>>>>>>>>>
43766>>>>>>>>>>>>>>>    Procedure Creating
43767>>>>>>>>>>>>>>>        Forward Send Creating
43769>>>>>>>>>>>>>>>        // Insert Code Here
43769>>>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurGL.Branch_Site))+;                         (Trim(String(Gplan.Gplan_Rec0)))))) to Gplan.Gplan_Recr
43770>>>>>>>>>>>>>>>    End_Procedure   // Creating
43771>>>>>>>>>>>>>>>
43771>>>>>>>>>>>>>>>
43771>>>>>>>>>>>>>>>//////////////////////////////////////
43771>>>>>>>>>>>>>>>//////////////////////////////////////
43771>>>>>>>>>>>>>>>
43771>>>>>>>>>>>>>>>    Function fiCheckValidChars String asGplanCode String asValChars Returns Integer
43772>>>>>>>>>>>>>>>        String lsChar
43773>>>>>>>>>>>>>>>        Integer liLen liCharPos rVal
43773>>>>>>>>>>>>>>>        If (asGplanCode <> "") Begin
43775>>>>>>>>>>>>>>>            Move (Trim(asGplanCode)) to asGplanCode
43776>>>>>>>>>>>>>>>            Move (Length(asGplanCode)) to liLen
43777>>>>>>>>>>>>>>>            For liCharPos From 1 to liLen
43783>>>>>>>>>>>>>>>>
43783>>>>>>>>>>>>>>>               Move (Mid(asGplanCode,1,liCharPos)) to lsChar
43784>>>>>>>>>>>>>>>               If (Not(asValChars contains lsChar)) Begin
43786>>>>>>>>>>>>>>>                    Set psValidChars to asValChars
43787>>>>>>>>>>>>>>>                    Function_Return 1001
43788>>>>>>>>>>>>>>>               End
43788>>>>>>>>>>>>>>>>
43788>>>>>>>>>>>>>>>            Loop
43789>>>>>>>>>>>>>>>>
43789>>>>>>>>>>>>>>>        End
43789>>>>>>>>>>>>>>>>
43789>>>>>>>>>>>>>>>        Function_Return rVal
43790>>>>>>>>>>>>>>>    End_Function // fiCheckValidChars
43791>>>>>>>>>>>>>>>
43791>>>>>>>>>>>>>>>    // private_Do_Restore_Fields:
43791>>>>>>>>>>>>>>>    Procedure private_Do_Restore_Fields for Gplan_DataDictionary
43792>>>>>>>>>>>>>>>        // Insert Code Here
43792>>>>>>>>>>>>>>>        Local Integer lioarray_Gplan_Aux##
43793>>>>>>>>>>>>>>>        Local Integer liFile##
43793>>>>>>>>>>>>>>>        Local Integer liField_Count##
43793>>>>>>>>>>>>>>>        Local Integer liField_Type##
43793>>>>>>>>>>>>>>>        Local Integer liField##
43793>>>>>>>>>>>>>>>
43793>>>>>>>>>>>>>>>        Get pioarray_Gplan_Aux to lioarray_Gplan_Aux##
43794>>>>>>>>>>>>>>>        Get Main_File to liFile##
43795>>>>>>>>>>>>>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of liFile## to liField_Count##
43798>>>>>>>>>>>>>>>
43798>>>>>>>>>>>>>>>
43798>>>>>>>>>>>>>>>        For liField## from 0 to (liField_Count##-1)
43804>>>>>>>>>>>>>>>>
43804>>>>>>>>>>>>>>>            //Get_Attribute DF_FIELD_TYPE of iFile iField to iField_Type
43804>>>>>>>>>>>>>>>            move liField## to Fieldindex
43805>>>>>>>>>>>>>>>            Get Array_Value of lioarray_Gplan_Aux## Item (liField##+1) to Gplan.Company_Code&
43806>>>>>>>>>>>>>>>        Loop
43807>>>>>>>>>>>>>>>>
43807>>>>>>>>>>>>>>>        Send Delete_Data to lioarray_Gplan_Aux##
43808>>>>>>>>>>>>>>>    End_Procedure   // private_Do_Restore_Fields
43809>>>>>>>>>>>>>>>
43809>>>>>>>>>>>>>>>    // private_Do_Keep_Fields:
43809>>>>>>>>>>>>>>>
43809>>>>>>>>>>>>>>>    Procedure private_Do_Keep_Fields for Gplan_DataDictionary
43810>>>>>>>>>>>>>>>        // Insert Code Here
43810>>>>>>>>>>>>>>>        Local Integer lioarray_Gplan_Aux##
43811>>>>>>>>>>>>>>>        Local Integer liFile##
43811>>>>>>>>>>>>>>>        Local Integer liField_Count##
43811>>>>>>>>>>>>>>>        Local Integer liField_Type##
43811>>>>>>>>>>>>>>>        Local Integer liField##
43811>>>>>>>>>>>>>>>
43811>>>>>>>>>>>>>>>        Get pioarray_Gplan_Aux to lioarray_Gplan_Aux##
43812>>>>>>>>>>>>>>>        Get Main_File to liFile##
43813>>>>>>>>>>>>>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of liFile## to liField_Count##
43816>>>>>>>>>>>>>>>
43816>>>>>>>>>>>>>>>        Send Delete_Data to lioarray_Gplan_Aux##
43817>>>>>>>>>>>>>>>        Send Add_Item to lioarray_Gplan_Aux## 0 //sos.sos
43818>>>>>>>>>>>>>>>
43818>>>>>>>>>>>>>>>        For liField## from 0 to (liField_Count##-1)
43824>>>>>>>>>>>>>>>>
43824>>>>>>>>>>>>>>>            //Get_Attribute DF_FIELD_TYPE of iFile iField to iField_Type
43824>>>>>>>>>>>>>>>            move liField## to Fieldindex
43825>>>>>>>>>>>>>>>            Send Add_Item to lioarray_Gplan_Aux## Gplan.Company_Code&
43826>>>>>>>>>>>>>>>        Loop
43827>>>>>>>>>>>>>>>>
43827>>>>>>>>>>>>>>>    End_Procedure   // private_Do_Keep_Fields
43828>>>>>>>>>>>>>>>
43828>>>>>>>>>>>>>>>    // Request_Save:
43828>>>>>>>>>>>>>>>
43828>>>>>>>>>>>>>>>
43828>>>>>>>>>>>>>>>
43828>>>>>>>>>>>>>>>//-----------------------------------------------------------------------------
43828>>>>>>>>>>>>>>>    FUNCTION Compute_Bathmos for Gplan_DataDictionary STRING KODIKOS## RETURNS INTEGER
43829>>>>>>>>>>>>>>>             LOCAL INTEGER BATHMOS##
43830>>>>>>>>>>>>>>>             REPEAT
43830>>>>>>>>>>>>>>>>
43830>>>>>>>>>>>>>>>                   REPLACE "." IN KODIKOS## WITH ""
43832>>>>>>>>>>>>>>>                   [FOUND] INCREMENT BATHMOS##
43833>>>>>>>>>>>>>>>             UNTIL (FINDERR=1)
43835>>>>>>>>>>>>>>>             FUNCTION_RETURN (BATHMOS##+1)
43836>>>>>>>>>>>>>>>    END_FUNCTION //compute_bathmos
43837>>>>>>>>>>>>>>>
43837>>>>>>>>>>>>>>>    FUNCTION Find_Previous for Gplan_DataDictionary STRING LS_CODE1## RETURNS STRING
43838>>>>>>>>>>>>>>>        LOCAL STRING LS_TEMP_CODE1## LS_TEMP_CODE2##
43839>>>>>>>>>>>>>>>        LOCAL INTEGER LI_COUNTER##
43839>>>>>>>>>>>>>>>
43839>>>>>>>>>>>>>>>        FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_CODE1##))
43845>>>>>>>>>>>>>>>>
43845>>>>>>>>>>>>>>>             INSERT (MID(LS_CODE1##,1,LI_COUNTER##)) IN LS_TEMP_CODE1## AT 1
43847>>>>>>>>>>>>>>>        LOOP
43848>>>>>>>>>>>>>>>>
43848>>>>>>>>>>>>>>>        MOVE (RIGHT(LS_TEMP_CODE1##,(LENGTH(LS_TEMP_CODE1##)-(POS(".",LS_TEMP_CODE1##))))) ;             TO LS_TEMP_CODE1##
43849>>>>>>>>>>>>>>>        FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_TEMP_CODE1##))
43855>>>>>>>>>>>>>>>>
43855>>>>>>>>>>>>>>>            INSERT (MID(LS_TEMP_CODE1##,1,LI_COUNTER##)) IN LS_TEMP_CODE2## AT 1
43857>>>>>>>>>>>>>>>        LOOP
43858>>>>>>>>>>>>>>>>
43858>>>>>>>>>>>>>>>        FUNCTION_RETURN LS_TEMP_CODE2##
43859>>>>>>>>>>>>>>>    END_FUNCTION
43860>>>>>>>>>>>>>>>
43860>>>>>>>>>>>>>>>    FUNCTION fiCheck_Format STRING  LS_CODE1##;                            STRING  LS_MASK##;                            INTEGER LI_BATHMOS##;                            RETURNS INTEGER
43861>>>>>>>>>>>>>>>             String  LS_TEMP_CODE1## LS_TEMP_CODE2## LS_MASK2##
43862>>>>>>>>>>>>>>>             Integer LI_COUNTER## LI_BATHMOS1##
43862>>>>>>>>>>>>>>>             Move (Trim(ls_Code1##)) to ls_Code1##
43863>>>>>>>>>>>>>>>             Move (Trim(ls_Mask##))  to ls_Mask##
43864>>>>>>>>>>>>>>>             FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_MASK##))
43870>>>>>>>>>>>>>>>>
43870>>>>>>>>>>>>>>>                  IF ((MID(LS_MASK##,1,LI_COUNTER##)) = ".") INCREMENT LI_BATHMOS1##
43873>>>>>>>>>>>>>>>                  IF (LI_BATHMOS1## < LI_BATHMOS##) ;                  INSERT (MID(LS_MASK##,1,LI_COUNTER##)) IN LS_MASK2## AT LI_COUNTER##
43877>>>>>>>>>>>>>>>             LOOP
43878>>>>>>>>>>>>>>>>
43878>>>>>>>>>>>>>>>             IF (;                  (LENGTH(LS_CODE1##)) <> (LENGTH(LS_MASK2##));                ) FUNCTION_RETURN 1000
43881>>>>>>>>>>>>>>>             FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_MASK2##))
43887>>>>>>>>>>>>>>>>
43887>>>>>>>>>>>>>>>                  IF (;                      ((MID(LS_MASK2##,1,LI_COUNTER##)) = ".") AND;                      ((MID(LS_CODE1##,1,LI_COUNTER##)) <> ".");                     ) FUNCTION_RETURN 1000
43890>>>>>>>>>>>>>>>             LOOP
43891>>>>>>>>>>>>>>>>
43891>>>>>>>>>>>>>>>             FUNCTION_RETURN 0
43892>>>>>>>>>>>>>>>    END_FUNCTION //fiCHECK_FORMAT
43893>>>>>>>>>>>>>>>
43893>>>>>>>>>>>>>>>    Function fiBackward_Check for Gplan_DataDictionary String LsGplanCode_Back integer liBathmos Returns Integer
43894>>>>>>>>>>>>>>>        Integer liGplan_Yn_Last
43895>>>>>>>>>>>>>>>        Number liGplanRecnum
43895>>>>>>>>>>>>>>>        String LsSearch_CodePrevious
43895>>>>>>>>>>>>>>>
43895>>>>>>>>>>>>>>>        if (liBathmos > 1) begin
43897>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>            move (Current_Record(Self)) to liGplanRecnum
43898>>>>>>>>>>>>>>>            move gplan.Gplan_Yn_Last to liGplan_Yn_Last
43899>>>>>>>>>>>>>>>            Send private_Do_Keep_Fields
43900>>>>>>>>>>>>>>>
43900>>>>>>>>>>>>>>>            Move (Find_Previous(self,lsGplanCode_Back)) to lsSearch_CodePrevious
43901>>>>>>>>>>>>>>>
43901>>>>>>>>>>>>>>>            clear Gplan
43902>>>>>>>>>>>>>>>            move gs_Selected_Company_Code  to Gplan.Company_Code
43903>>>>>>>>>>>>>>>            move gs_Selected_Branch_Code   to Gplan.Branch_Code
43904>>>>>>>>>>>>>>>            move gi_Selected_Year          to Gplan.Year_Year
43905>>>>>>>>>>>>>>>            move lsSearch_CodePrevious     to Gplan.Gplan_Code
43906>>>>>>>>>>>>>>>            Find eq Gplan by index.1 // pkid
43907>>>>>>>>>>>>>>>>
43907>>>>>>>>>>>>>>>            If (Found = 0) begin
43909>>>>>>>>>>>>>>>                clear gplan
43910>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
43911>>>>>>>>>>>>>>>                find eq gplan.recnum
43912>>>>>>>>>>>>>>>>
43912>>>>>>>>>>>>>>>                Send private_Do_Restore_Fields
43913>>>>>>>>>>>>>>>                Function_return  7001 //return to fiValidate
43914>>>>>>>>>>>>>>>            end
43914>>>>>>>>>>>>>>>>
43914>>>>>>>>>>>>>>>            else begin
43915>>>>>>>>>>>>>>>               // The  previous logar marked last  and current greater bathmos
43915>>>>>>>>>>>>>>>               if   (Gplan.Gplan_yn_Last = 1) begin
43917>>>>>>>>>>>>>>>                   Send private_Do_Restore_Fields
43918>>>>>>>>>>>>>>>                   Function_return 7003
43919>>>>>>>>>>>>>>>               end
43919>>>>>>>>>>>>>>>>
43919>>>>>>>>>>>>>>>               clear gplan
43920>>>>>>>>>>>>>>>               move liGplanRecnum to gplan.recnum
43921>>>>>>>>>>>>>>>               find eq gplan.recnum
43922>>>>>>>>>>>>>>>>
43922>>>>>>>>>>>>>>>               Send private_Do_Restore_Fields
43923>>>>>>>>>>>>>>>               function_Return 0 //ok
43924>>>>>>>>>>>>>>>            end
43924>>>>>>>>>>>>>>>>
43924>>>>>>>>>>>>>>>        end
43924>>>>>>>>>>>>>>>>
43924>>>>>>>>>>>>>>>        Function_Return 0
43925>>>>>>>>>>>>>>>    End_Function  // fiBackward_Check
43926>>>>>>>>>>>>>>>    //-----------------------------------------------------------------------------
43926>>>>>>>>>>>>>>>
43926>>>>>>>>>>>>>>>
43926>>>>>>>>>>>>>>>    //-----------------------------------------------------------------------------
43926>>>>>>>>>>>>>>>    FUNCTION fiForward_Check for Gplan_DataDictionary STRING LS_GplanCode integer liMode Returns Integer
43927>>>>>>>>>>>>>>>        String lsNext_Anoep
43928>>>>>>>>>>>>>>>        Integer liGplan_Yn_Last
43928>>>>>>>>>>>>>>>        Number liGplanRecnum
43928>>>>>>>>>>>>>>>
43928>>>>>>>>>>>>>>>
43928>>>>>>>>>>>>>>>        //move gplan.recnum to liGplanRecnum
43928>>>>>>>>>>>>>>>        move (Current_Record(Self)) to liGplanRecnum
43929>>>>>>>>>>>>>>>        move gplan.Gplan_Code to lsNext_Anoep
43930>>>>>>>>>>>>>>>        move gplan.Gplan_Yn_Last to liGplan_Yn_Last
43931>>>>>>>>>>>>>>>        Send private_Do_Keep_Fields
43932>>>>>>>>>>>>>>>
43932>>>>>>>>>>>>>>>        if (liGplan_Yn_Last = 1)  begin
43934>>>>>>>>>>>>>>>            find gt gplan by index.1
43935>>>>>>>>>>>>>>>>
43935>>>>>>>>>>>>>>>            if (found = 0) begin
43937>>>>>>>>>>>>>>>                clear gplan
43938>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
43939>>>>>>>>>>>>>>>                find eq gplan.recnum
43940>>>>>>>>>>>>>>>>
43940>>>>>>>>>>>>>>>                Send private_Do_Restore_Fields
43941>>>>>>>>>>>>>>>            end
43941>>>>>>>>>>>>>>>>
43941>>>>>>>>>>>>>>>            else begin
43942>>>>>>>>>>>>>>>                // The Current and the previous logar marked last
43942>>>>>>>>>>>>>>>                if (Gplan.Gplan_Anoep = lsNext_Anoep) begin
43944>>>>>>>>>>>>>>>                    clear gplan
43945>>>>>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
43946>>>>>>>>>>>>>>>                    find eq gplan.recnum
43947>>>>>>>>>>>>>>>>
43947>>>>>>>>>>>>>>>                    Send private_Do_Restore_Fields
43948>>>>>>>>>>>>>>>                    Function_return 7004
43949>>>>>>>>>>>>>>>                end
43949>>>>>>>>>>>>>>>>
43949>>>>>>>>>>>>>>>                else begin
43950>>>>>>>>>>>>>>>                    clear gplan
43951>>>>>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
43952>>>>>>>>>>>>>>>                    find eq gplan.recnum
43953>>>>>>>>>>>>>>>>
43953>>>>>>>>>>>>>>>                    Send private_Do_Restore_Fields
43954>>>>>>>>>>>>>>>                end
43954>>>>>>>>>>>>>>>>
43954>>>>>>>>>>>>>>>            end
43954>>>>>>>>>>>>>>>>
43954>>>>>>>>>>>>>>>        end
43954>>>>>>>>>>>>>>>>
43954>>>>>>>>>>>>>>>
43954>>>>>>>>>>>>>>>        if (liMode = 1) begin
43956>>>>>>>>>>>>>>>            find gt gplan by index.1
43957>>>>>>>>>>>>>>>>
43957>>>>>>>>>>>>>>>            if (Found = 0) begin
43959>>>>>>>>>>>>>>>                clear gplan
43960>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
43961>>>>>>>>>>>>>>>                find eq gplan.recnum
43962>>>>>>>>>>>>>>>>
43962>>>>>>>>>>>>>>>                Send private_Do_Restore_Fields
43963>>>>>>>>>>>>>>>            end
43963>>>>>>>>>>>>>>>>
43963>>>>>>>>>>>>>>>            else begin
43964>>>>>>>>>>>>>>>                if (Gplan.Gplan_Anoep = lsNext_Anoep) begin
43966>>>>>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
43967>>>>>>>>>>>>>>>                    find eq gplan.recnum
43968>>>>>>>>>>>>>>>>
43968>>>>>>>>>>>>>>>                    Send private_Do_Restore_Fields
43969>>>>>>>>>>>>>>>                    Function_return 7010 //called from validate delete
43970>>>>>>>>>>>>>>>                end
43970>>>>>>>>>>>>>>>>
43970>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
43971>>>>>>>>>>>>>>>                find eq gplan.recnum
43972>>>>>>>>>>>>>>>>
43972>>>>>>>>>>>>>>>                //Send private_Do_Restore_Fields
43972>>>>>>>>>>>>>>>            end
43972>>>>>>>>>>>>>>>>
43972>>>>>>>>>>>>>>>        end
43972>>>>>>>>>>>>>>>>
43972>>>>>>>>>>>>>>>        Function_return 0
43973>>>>>>>>>>>>>>>    End_Function // fiForward_Check
43974>>>>>>>>>>>>>>>
43974>>>>>>>>>>>>>>>
43974>>>>>>>>>>>>>>>    Function private_Man_Gplan_Code for Gplan_DataDictionary integer liField## String lsGplan_Code integer liModeGplan Returns Integer
43975>>>>>>>>>>>>>>>
43975>>>>>>>>>>>>>>>        // Insert Code Here
43975>>>>>>>>>>>>>>>        Integer liCounter liPosition liLength liBathmos liRetVal
43976>>>>>>>>>>>>>>>        string lsMask lsCkeckChar lsSearchCode
43976>>>>>>>>>>>>>>>
43976>>>>>>>>>>>>>>>        Trim lsGplan_code to lsGplan_code
43977>>>>>>>>>>>>>>>>
43977>>>>>>>>>>>>>>>        Move lsGplan_Code to lsSearchCode
43978>>>>>>>>>>>>>>>    Search_Again:
43978>>>>>>>>>>>>>>>        clear Gformat
INCLUDING FILE: GFORMAT.FD
43979>>>>>>>>>>>>>>>        move SysCurGL.Company_Code  to Gformat.Company_Code
43980>>>>>>>>>>>>>>>        move SysCurGL.Branch_Code   to Gformat.Branch_Code
43981>>>>>>>>>>>>>>>        move SysCurGL.Year_Year     to Gformat.Year_Year
43982>>>>>>>>>>>>>>>        move lsSearchCode           to Gformat.Gformat_Code
43983>>>>>>>>>>>>>>>        Find eq Gformat by index.1
43984>>>>>>>>>>>>>>>>
43984>>>>>>>>>>>>>>>
43984>>>>>>>>>>>>>>>        if (Found = 1) begin
43986>>>>>>>>>>>>>>>            Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
43987>>>>>>>>>>>>>>>            Move (fiCheck_Format(self,lsGplan_Code,gformat.gformat_mask,liBathmos)) to liRetVal
43988>>>>>>>>>>>>>>>            if (liRetVal = 0) begin
43990>>>>>>>>>>>>>>>                Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
43991>>>>>>>>>>>>>>>                if (liModeGplan = 0) Begin
43993>>>>>>>>>>>>>>>                    if (Not(Current_Record(self))) begin
43995>>>>>>>>>>>>>>>                        set field_default_value field Gplan.gplan_Bathmos to libathmos //from deo
43996>>>>>>>>>>>>>>>                    end
43996>>>>>>>>>>>>>>>>
43996>>>>>>>>>>>>>>>                end
43996>>>>>>>>>>>>>>>>
43996>>>>>>>>>>>>>>>                if (libathmos > 1) begin
43998>>>>>>>>>>>>>>>                    Move (Find_Previous(self,lsGplan_Code)) to lsSearchCode
43999>>>>>>>>>>>>>>>                    if (liModeGplan = 0) Begin
44001>>>>>>>>>>>>>>>                        if (Not(Current_Record(self))) begin
44003>>>>>>>>>>>>>>>                            set field_default_value field Gplan.gplan_Anoep to lsSearchCode //from Deo
44004>>>>>>>>>>>>>>>                        End
44004>>>>>>>>>>>>>>>>
44004>>>>>>>>>>>>>>>                    End
44004>>>>>>>>>>>>>>>>
44004>>>>>>>>>>>>>>>                end
44004>>>>>>>>>>>>>>>>
44004>>>>>>>>>>>>>>>            function_return 0
44005>>>>>>>>>>>>>>>            end
44005>>>>>>>>>>>>>>>>
44005>>>>>>>>>>>>>>>            else begin
44006>>>>>>>>>>>>>>>                function_return 127
44007>>>>>>>>>>>>>>>            end
44007>>>>>>>>>>>>>>>>
44007>>>>>>>>>>>>>>>        end
44007>>>>>>>>>>>>>>>>
44007>>>>>>>>>>>>>>>        else begin
44008>>>>>>>>>>>>>>>            Move (Compute_Bathmos(self,lsSearchCode)) to liBathmos
44009>>>>>>>>>>>>>>>            if ((liBathmos-1) <> 0) begin
44011>>>>>>>>>>>>>>>                Move (Find_Previous(self,lsSearchCode)) to lsSearchCode
44012>>>>>>>>>>>>>>>                Goto Search_Again
44013>>>>>>>>>>>>>>>>
44013>>>>>>>>>>>>>>>            end
44013>>>>>>>>>>>>>>>>
44013>>>>>>>>>>>>>>>            else begin
44014>>>>>>>>>>>>>>>                clear Gformat
44015>>>>>>>>>>>>>>>                move SysCurGL.Company_Code  to Gformat.Company_Code
44016>>>>>>>>>>>>>>>                move SysCurGL.Branch_Code   to Gformat.Branch_Code
44017>>>>>>>>>>>>>>>                move SysCurGL.Year_Year     to Gformat.Year_Year
44018>>>>>>>>>>>>>>>                move "@@"                   to Gformat.Gformat_Code
44019>>>>>>>>>>>>>>>                Find eq Gformat by index.1 // pkid
44020>>>>>>>>>>>>>>>>
44020>>>>>>>>>>>>>>>//* to be a function
44020>>>>>>>>>>>>>>>                Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
44021>>>>>>>>>>>>>>>                Move (fiCheck_Format(self,lsGplan_Code,gformat.gformat_mask,liBathmos)) to liRetVal
44022>>>>>>>>>>>>>>>                if (liRetVal = 0) begin
44024>>>>>>>>>>>>>>>                    Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
44025>>>>>>>>>>>>>>>                    if (liModeGplan = 0) Begin
44027>>>>>>>>>>>>>>>                        if (Not(Current_Record(self))) begin
44029>>>>>>>>>>>>>>>                            set field_default_value field Gplan.gplan_Bathmos to libathmos //from Deo
44030>>>>>>>>>>>>>>>                        end
44030>>>>>>>>>>>>>>>>
44030>>>>>>>>>>>>>>>                    end
44030>>>>>>>>>>>>>>>>
44030>>>>>>>>>>>>>>>                    if (libathmos > 1) begin
44032>>>>>>>>>>>>>>>                        Move (Find_Previous(self,lsGplan_Code)) to lsSearchCode
44033>>>>>>>>>>>>>>>                        if (liModeGplan = 0) Begin
44035>>>>>>>>>>>>>>>                            if (Not(Current_Record(self))) begin
44037>>>>>>>>>>>>>>>                                set field_default_value field Gplan.gplan_Anoep to lsSearchCode //from Deo
44038>>>>>>>>>>>>>>>                            end
44038>>>>>>>>>>>>>>>>
44038>>>>>>>>>>>>>>>                        end
44038>>>>>>>>>>>>>>>>
44038>>>>>>>>>>>>>>>                    end
44038>>>>>>>>>>>>>>>>
44038>>>>>>>>>>>>>>>                function_return 0
44039>>>>>>>>>>>>>>>                end
44039>>>>>>>>>>>>>>>>
44039>>>>>>>>>>>>>>>                else begin
44040>>>>>>>>>>>>>>>                    function_return 127
44041>>>>>>>>>>>>>>>                end
44041>>>>>>>>>>>>>>>>
44041>>>>>>>>>>>>>>>
44041>>>>>>>>>>>>>>>                //* emd to be a function
44041>>>>>>>>>>>>>>>                function_return 0
44042>>>>>>>>>>>>>>>            end
44042>>>>>>>>>>>>>>>>
44042>>>>>>>>>>>>>>>        end
44042>>>>>>>>>>>>>>>>
44042>>>>>>>>>>>>>>>        Function_return 0    //ok
44043>>>>>>>>>>>>>>>    End_Function   // private_Man_Gplan_Code
44044>>>>>>>>>>>>>>>
44044>>>>>>>>>>>>>>>
44044>>>>>>>>>>>>>>>
44044>>>>>>>>>>>>>>>    // fiValidateGplanFields:
44044>>>>>>>>>>>>>>>
44044>>>>>>>>>>>>>>>    Function fiValidateGplanFields for Gplan_DataDictionary integer liField string lsFieldvalue Returns Integer
44045>>>>>>>>>>>>>>>        String  sName lsAnoep lsGplan_Code
44046>>>>>>>>>>>>>>>        Integer iMainFile liGplanRecnum liReturnVal liReturnValb liBathmos1
44046>>>>>>>>>>>>>>>        String lsValidChar lsDelimiter
44046>>>>>>>>>>>>>>>
44046>>>>>>>>>>>>>>>        Get Main_File to iMainFile
44047>>>>>>>>>>>>>>>        Get_Attribute DF_FIELD_NAME of iMainFile liField to sName
44050>>>>>>>>>>>>>>>
44050>>>>>>>>>>>>>>>        If (sName = 'GPLAN_CODE') Begin
44052>>>>>>>>>>>>>>>            move (trim(lsFieldvalue)) to lsFieldvalue //from deo
44053>>>>>>>>>>>>>>>            if (lsFieldvalue <>  "") begin //new
44055>>>>>>>>>>>>>>>                Move SyscurGL.Year_Valid_Char to lsValidChar
44056>>>>>>>>>>>>>>>                Move SyscurGL.Year_Delimiter  to lsDelimiter
44057>>>>>>>>>>>>>>>                Move (fiCheckValidChars(Self,lsFieldvalue,((Trim(lsValidChar))+(Trim(lsDelimiter))))) to liReturnVal
44058>>>>>>>>>>>>>>>                if (liReturnVal = '1001') begin
44060>>>>>>>>>>>>>>>                               error liReturnVal ("‹ž ˜§¦›œ¡«æª ®˜¨˜¡«ã¨˜ª š ˜ ¡à› ¡æ Š.‘ !\n\n€§¦›œ¡«¦å ®˜¨˜¡«ã¨œª : '" + (psValidChars(Self)) + "'")
44061>>>>>>>>>>>>>>>>
44061>>>>>>>>>>>>>>>                               Function_Return liReturnVal
44062>>>>>>>>>>>>>>>                            end
44062>>>>>>>>>>>>>>>>
44062>>>>>>>>>>>>>>>
44062>>>>>>>>>>>>>>>                Move (private_Man_Gplan_Code(self,liField,lsFieldvalue,0)) to liReturnVal
44063>>>>>>>>>>>>>>>                if (lireturnval <> 0) begin
44065>>>>>>>>>>>>>>>                                        error 127 ("ŠáŸ¦ª £¦¨­ã ¡à› ¡¦ç !\n\n"+Gplan.Gplan_Code)
44066>>>>>>>>>>>>>>>>
44066>>>>>>>>>>>>>>>                                        function_return 127
44067>>>>>>>>>>>>>>>                                      end
44067>>>>>>>>>>>>>>>>
44067>>>>>>>>>>>>>>>
44067>>>>>>>>>>>>>>>                get field_current_value field Gplan.gplan_Code to lsGplan_Code
44068>>>>>>>>>>>>>>>                get field_current_value field Gplan.gplan_Bathmos to liBathmos1
44069>>>>>>>>>>>>>>>                get field_current_value field Gplan.gplan_anoep to lsAnoep
44070>>>>>>>>>>>>>>>                Move (fiBackward_Check(self,lsGplan_Code,liBathmos1)) to liReturnValb
44071>>>>>>>>>>>>>>>                if (liReturnValb = '7001') begin
44073>>>>>>>>>>>>>>>                                               error 7001 "ƒœ¤ ¬§á¨®œ  ¦ §œ¨ ¢ž§« ¡æª ™˜Ÿ£æª !"
44074>>>>>>>>>>>>>>>>
44074>>>>>>>>>>>>>>>                                               Function_Return 8001
44075>>>>>>>>>>>>>>>                                            end
44075>>>>>>>>>>>>>>>>
44075>>>>>>>>>>>>>>>                if (liReturnValb = '7002') begin
44077>>>>>>>>>>>>>>>                                               error 7002 "“§á¨®œ  ¡à› ¡æª «œ¢œ¬«˜å¦¬ ™˜Ÿ£¦ç !"
44078>>>>>>>>>>>>>>>>
44078>>>>>>>>>>>>>>>                                               Function_Return 8002
44079>>>>>>>>>>>>>>>                                          end
44079>>>>>>>>>>>>>>>>
44079>>>>>>>>>>>>>>>                if (liReturnValb = '7003') begin
44081>>>>>>>>>>>>>>>                                               error 7003 "Ž §¨¦žš¦ç£œ¤¦ª œå¤˜  «œ¢œ¬«˜å¦¬ ™˜Ÿ£¦ç !"
44082>>>>>>>>>>>>>>>>
44082>>>>>>>>>>>>>>>                                               Function_Return 8003
44083>>>>>>>>>>>>>>>                                          end
44083>>>>>>>>>>>>>>>>
44083>>>>>>>>>>>>>>>
44083>>>>>>>>>>>>>>>                Move (fiForward_Check(self,lsGplan_Code,0)) to liReturnValb
44084>>>>>>>>>>>>>>>                if (liReturnValb = '7004') begin
44086>>>>>>>>>>>>>>>                                               error 7004 "“§á¨®œ  ¦ ˜¤é«œ¨¦ª ™˜Ÿ£æª !"
44087>>>>>>>>>>>>>>>>
44087>>>>>>>>>>>>>>>                                               Function_Return 8004
44088>>>>>>>>>>>>>>>                                            end
44088>>>>>>>>>>>>>>>>
44088>>>>>>>>>>>>>>>
44088>>>>>>>>>>>>>>>            end
44088>>>>>>>>>>>>>>>>
44088>>>>>>>>>>>>>>>            else Function_Return 0  //exit function ok!!!
44090>>>>>>>>>>>>>>>         end
44090>>>>>>>>>>>>>>>>
44090>>>>>>>>>>>>>>>         function_return 0
44091>>>>>>>>>>>>>>>    End_Function   // fiValidateGplanFields
44092>>>>>>>>>>>>>>>
44092>>>>>>>>>>>>>>>
44092>>>>>>>>>>>>>>>//-----------------------------------------------Save Operation ----------------------------------------------------
44092>>>>>>>>>>>>>>>
44092>>>>>>>>>>>>>>>
44092>>>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
44093>>>>>>>>>>>>>>>        //Forward Send Operation_Not_Allowed  iError_Num
44093>>>>>>>>>>>>>>>        // Insert Code Here
44093>>>>>>>>>>>>>>>                 if iError_num eq 127  error 127 ((Trim(Gplan.Gplan_Code))+" Wrong Format !!!! \n\n")
44096>>>>>>>>>>>>>>>            Else if iError_num eq 128  error 128 ("Not a valid Data Entry.  Account is Missing !!!!\n\n"+Gplan.Gplan_Code)
44100>>>>>>>>>>>>>>>            Else if iError_num eq 129  error 129 ("Not a valid Data Entry.  Bathmos is Missing !!!!\n\n"+Gplan.Gplan_Code)
44104>>>>>>>>>>>>>>>            Else if iError_num eq 130  error 130 ("Not a valid Data Entry.  Previews Account is Missing !!!!\n\n"+Gplan.Gplan_Code)
44108>>>>>>>>>>>>>>>            Else if iError_num eq 1100  error 1100 "DDC:150 - ‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
44112>>>>>>>>>>>>>>>            Else if iError_num eq 2100  error 2100 "DDC:150 - ‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
44116>>>>>>>>>>>>>>>            Else if iError_num eq 7001 error 8001 ("Anoep Does not Exist !!!!\n\n"+Gplan.Gplan_Code)
44120>>>>>>>>>>>>>>>            Else if iError_num eq 7002 error 8002 ("Last Exists\n\n!!!! "+Gplan.Gplan_Code)
44124>>>>>>>>>>>>>>>            Else if iError_num eq 7003 error 8003 ("Previous batmos is last  !!!!\n\n"+Gplan.Gplan_Code)
44128>>>>>>>>>>>>>>>            Else if iError_num eq 7004 error 8004 ("Greater bathmos exists  !!!!\n\n"+Gplan.Gplan_Code)
44132>>>>>>>>>>>>>>>            Else if iError_num eq 7010 error 7010 ("Greater bathmos exists  !!!!\n\n"+Gplan.Gplan_Code)
44136>>>>>>>>>>>>>>>            Else if (iError_num = 1001) error 1001 ("‹ž ˜§¦›œ¡«æª ®˜¨˜¡«ã¨˜ª š ˜ ¡à› ¡æ Š.‘ !\n\n€§¦›œ¡«¦å ®˜¨˜¡«ã¨œª : '" + (psValidChars(Self)) + "'")
44140>>>>>>>>>>>>>>>            Else Forward Send Operation_Not_Allowed  iError_Num
44143>>>>>>>>>>>>>>>    End_Procedure
44144>>>>>>>>>>>>>>>
44144>>>>>>>>>>>>>>>
44144>>>>>>>>>>>>>>>    Procedure Clear_From_Bpo
44145>>>>>>>>>>>>>>>        Clear Gplan
44146>>>>>>>>>>>>>>>    End_Procedure
44147>>>>>>>>>>>>>>>
44147>>>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
44148>>>>>>>>>>>>>>>        Local Integer iReturnVal iField##
44149>>>>>>>>>>>>>>>        locaL string lsVal##
44149>>>>>>>>>>>>>>>
44149>>>>>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
44151>>>>>>>>>>>>>>>
44151>>>>>>>>>>>>>>>
44151>>>>>>>>>>>>>>>        If (Not(iReturnVal))Begin
44153>>>>>>>>>>>>>>>        //    If (Not(Current_Record(Self))) Move (fiCheckValidChars(Self,Gplan.Gplan_Code,((Trim(Year.Year_Valid_Char))+(Trim(Year.Year_Delimiter))))) to iReturnVal
44153>>>>>>>>>>>>>>>        //    If (iReturnVal) Send Operation_Not_Allowed iReturnVal
44153>>>>>>>>>>>>>>>            If (Gplan.Gplan_Code    = "") Send Operation_Not_Allowed 128
44156>>>>>>>>>>>>>>>            If (Gplan.Gplan_Bathmos = 0 ) Send Operation_Not_Allowed 129
44159>>>>>>>>>>>>>>>            If (;                 (Gplan.Gplan_Bathmos <> 1) and;                 (Gplan.Gplan_Anoep = "");               ) Send Operation_Not_Allowed 130
44162>>>>>>>>>>>>>>>            For iField## from 4 to 4   // Field number for Starting and Ending pp's ???????
44168>>>>>>>>>>>>>>>>
44168>>>>>>>>>>>>>>>
44168>>>>>>>>>>>>>>>                Move (private_Man_Gplan_Code(self,iField##,Gplan.Gplan_Code,1))     to iReturnVal
44169>>>>>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
44172>>>>>>>>>>>>>>>
44172>>>>>>>>>>>>>>>                Move (fiBACKWARD_CHECK(self,Gplan.Gplan_Code,Gplan.Gplan_Bathmos)) to iReturnVal
44173>>>>>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
44176>>>>>>>>>>>>>>>
44176>>>>>>>>>>>>>>>                Move (fiFORWARD_CHECK(self,Gplan.Gplan_Code,0))                     to iReturnVal
44177>>>>>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
44180>>>>>>>>>>>>>>>
44180>>>>>>>>>>>>>>>            Loop
44181>>>>>>>>>>>>>>>>
44181>>>>>>>>>>>>>>>              //1100:cby = globals
44181>>>>>>>>>>>>>>>              If ( ;                   (Not(Gplan.Company_Code = SysCurGL.Company_Code)) or;                   (Not(Gplan.Branch_Code  = SysCurGL.Branch_Code )) ;                  ) Send Operation_Not_Allowed 1100
44184>>>>>>>>>>>>>>>        End
44184>>>>>>>>>>>>>>>>
44184>>>>>>>>>>>>>>>        Function_Return iReturnVal
44185>>>>>>>>>>>>>>>    End_Function
44186>>>>>>>>>>>>>>>
44186>>>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
44187>>>>>>>>>>>>>>>        Local Integer iReturnVal liReturnValb##
44188>>>>>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
44190>>>>>>>>>>>>>>>
44190>>>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
44192>>>>>>>>>>>>>>>            // Insert Code Here
44192>>>>>>>>>>>>>>>               Move (fiFORWARD_CHECK(Self,Gplan.Gplan_Code,1)) to liReturnValb##
44193>>>>>>>>>>>>>>>               If (liReturnValb##>1) Send Operation_Not_Allowed liReturnValb##
44196>>>>>>>>>>>>>>>              //2100:cby = globals
44196>>>>>>>>>>>>>>>              If ( ;                   (Not(Gplan.Company_Code = SysCurGL.Company_Code)) or;                   (Not(Gplan.Branch_Code  = SysCurGL.Branch_Code )) ;                  ) Send Operation_Not_Allowed 2100
44199>>>>>>>>>>>>>>>        End
44199>>>>>>>>>>>>>>>>
44199>>>>>>>>>>>>>>>
44199>>>>>>>>>>>>>>>        Function_Return iReturnVal
44200>>>>>>>>>>>>>>>    End_Function
44201>>>>>>>>>>>>>>>
44201>>>>>>>>>>>>>>>
44201>>>>>>>>>>>>>>>//    Procedure Update
44201>>>>>>>>>>>>>>>//        Forward Send Update
44201>>>>>>>>>>>>>>>//        // Insert Code Here
44201>>>>>>>>>>>>>>>//        Move Company.Company_Code  to Gplan.Company_Code
44201>>>>>>>>>>>>>>>//        Move Branch.Branch_Code    to Gplan.Branch_Code
44201>>>>>>>>>>>>>>>//        Move Year.Year_Year        to Gplan.Year_Year
44201>>>>>>>>>>>>>>>//        Add 1 to Year.Year_NumGplan //˜¨ Ÿ£æª ¢¦š˜¨ ˜©£é¤ «žª ®¨ã©žª
44201>>>>>>>>>>>>>>>//    End_Procedure   // Update
44201>>>>>>>>>>>>>>>
44201>>>>>>>>>>>>>>>//    Procedure Backout
44201>>>>>>>>>>>>>>>//        Forward Send Backout
44201>>>>>>>>>>>>>>>//        Sub 1 from Year.Year_NumGplan //˜¨ Ÿ£æª ¢¦š˜¨ ˜©£é¤ «žª ®¨ã©žª
44201>>>>>>>>>>>>>>>//    End_Procedure //deleting
44201>>>>>>>>>>>>>>>
44201>>>>>>>>>>>>>>>
44201>>>>>>>>>>>>>>>
44201>>>>>>>>>>>>>>>    // Define_Fields:
44201>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
44201>>>>>>>>>>>>>>>
44201>>>>>>>>>>>>>>>    Procedure Define_Fields
44202>>>>>>>>>>>>>>>        Forward Send Define_Fields
44204>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44204>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
44204>>>>>>>>>>>>>>>
44204>>>>>>>>>>>>>>>        Set Main_File            To Gplan.File_Number
44205>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
44206>>>>>>>>>>>>>>>
44206>>>>>>>>>>>>>>>
44206>>>>>>>>>>>>>>>        // Child (Client) file structure................
44206>>>>>>>>>>>>>>>        Send Add_Client_File  Gmovea.File_Number
44207>>>>>>>>>>>>>>>        Send Add_Client_File  Gplanmod.File_Number
44208>>>>>>>>>>>>>>>        Send Add_Client_File  Gmhnes.File_Number
44209>>>>>>>>>>>>>>>        Send Add_Client_File  Gvatd.File_Number
44210>>>>>>>>>>>>>>>        Send Add_Client_File  Gpmoves.File_Number
44211>>>>>>>>>>>>>>>
44211>>>>>>>>>>>>>>>        // External (System) file structure.............
44211>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
44212>>>>>>>>>>>>>>>        Send Add_System_File  Syscurgl.File_Number  DD_LOCK_ON_ALL
44213>>>>>>>>>>>>>>>
44213>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gplan_Rec0  To Gplan.Gplan_Rec0
44216>>>>>>>>>>>>>>>
44216>>>>>>>>>>>>>>>        // Field-based properties.......................
44216>>>>>>>>>>>>>>>
44216>>>>>>>>>>>>>>>        // Gplan.Company_Code
44216>>>>>>>>>>>>>>>
44216>>>>>>>>>>>>>>>        // Gplan.Branch_Code
44216>>>>>>>>>>>>>>>
44216>>>>>>>>>>>>>>>        // Gplan.Year_Year
44216>>>>>>>>>>>>>>>
44216>>>>>>>>>>>>>>>        // Gplan.Gplan_Code
44216>>>>>>>>>>>>>>>        Set Field_Exit_msg         Field Gplan.Gplan_Code To get_fiValidateGplanFields
44217>>>>>>>>>>>>>>>        Set Field_Options          Field Gplan.Gplan_Code To DD_AUTOFIND    DD_REQUIRED   
44218>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Code To (sl150(Self))
44219>>>>>>>>>>>>>>>
44219>>>>>>>>>>>>>>>        // Gplan.Gplan_Rec0
44219>>>>>>>>>>>>>>>
44219>>>>>>>>>>>>>>>        // Gplan.Year_Recr
44219>>>>>>>>>>>>>>>
44219>>>>>>>>>>>>>>>        // Gplan.Gplan_Descr1
44219>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Descr1 To (sl150(Self))
44220>>>>>>>>>>>>>>>
44220>>>>>>>>>>>>>>>        // Gplan.Gplan_Descr2
44220>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Descr2 To (sl150(Self))
44221>>>>>>>>>>>>>>>
44221>>>>>>>>>>>>>>>        // Gplan.Gplan_Bathmos
44221>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Bathmos To "Calulated"
44221>>>>>>>>>>>>>>>
44221>>>>>>>>>>>>>>>        // Gplan.Gplan_Anoep
44221>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Anoep To "Calulated"
44221>>>>>>>>>>>>>>>
44221>>>>>>>>>>>>>>>        // Gplan.Gplan_O_Code
44221>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_O_Code To "dbComboFormSub"
44222>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_O_Code To (Gplan_Gplan_O_Code_VT(Self))
44223>>>>>>>>>>>>>>>
44223>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Xfer
44223>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Xfer To "dbComboFormSub"
44224>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Xfer To (Gplan_Gplan_Yn_VT(Self))
44225>>>>>>>>>>>>>>>
44225>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Last
44225>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Last To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1013)"
44225>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Last To "dbComboFormSub"
44226>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Last To (Gplan_Gplan_Yn_VT(Self))
44227>>>>>>>>>>>>>>>
44227>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Kin
44227>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Kin To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1014)"
44227>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Kin To "dbComboFormSub"
44228>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Kin To (Gplan_Gplan_Yn_VT(Self))
44229>>>>>>>>>>>>>>>
44229>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Kk
44229>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Kk To "dbComboFormSub"
44230>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Kk To (Gplan_Gplan_Yn_VT(Self))
44231>>>>>>>>>>>>>>>
44231>>>>>>>>>>>>>>>        // Gplan.Gplan_Xpm
44231>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Xpm To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1015+1016)"
44231>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Xpm To "dbComboFormSub"
44232>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Xpm To (Gplan_Gplan_Xpm_VT(Self))
44233>>>>>>>>>>>>>>>
44233>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Xy
44233>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Xy To "•¨ž© £¦§¦ œå«˜  ©«ž¤ private.trexe «¦¬ Gmove (1017)"
44233>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Xy To "dbComboFormSub"
44234>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Xy To (Gplan_Gplan_Yn_VT(Self))
44235>>>>>>>>>>>>>>>
44235>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Py
44235>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Py To "•¨ž© £¦§¦ œå«˜  ©«ž¤ private.trexe «¦¬ Gmove (1018)"
44235>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Py To "dbComboFormSub"
44236>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Py To (Gplan_Gplan_Yn_VT(Self))
44237>>>>>>>>>>>>>>>
44237>>>>>>>>>>>>>>>        // Gplan.Gplan_Fpaent
44237>>>>>>>>>>>>>>>
44237>>>>>>>>>>>>>>>        // Gplan.Gplan_Fpaent_Yn
44237>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Fpaent_Yn To (Gplan_Gplan_Yn_VT(Self))
44238>>>>>>>>>>>>>>>
44238>>>>>>>>>>>>>>>        // Gplan.Gplan_Afm
44238>>>>>>>>>>>>>>>
44238>>>>>>>>>>>>>>>        // Gplan.Gplan_Addr
44238>>>>>>>>>>>>>>>
44238>>>>>>>>>>>>>>>        // Gplan.Gplan_Tk
44238>>>>>>>>>>>>>>>
44238>>>>>>>>>>>>>>>        // Gplan.Gplan_Poli
44238>>>>>>>>>>>>>>>
44238>>>>>>>>>>>>>>>        // Gplan.Gplan_Doy
44238>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Doy To "dbComboFormSub"
44239>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Doy To (Gplan_Gplan_Doy_VT(Self))
44240>>>>>>>>>>>>>>>
44240>>>>>>>>>>>>>>>        // Gplan.Gplan_J_Code
44240>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_J_Code To "dbComboFormSub"
44241>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_J_Code To (Gplan_Gplan_J_Code_VT(Self))
44242>>>>>>>>>>>>>>>
44242>>>>>>>>>>>>>>>        // Gplan.Gplan_C_Code2
44242>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_C_Code2 To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1019)"
44242>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_C_Code2 To "dbComboFormSub"
44243>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_C_Code2 To (Gplan_Gplan_C_Code2_VT(Self))
44244>>>>>>>>>>>>>>>
44244>>>>>>>>>>>>>>>        // Gplan.Gplan_Tel
44244>>>>>>>>>>>>>>>
44244>>>>>>>>>>>>>>>        // Gplan.Gplan_Email
44244>>>>>>>>>>>>>>>
44244>>>>>>>>>>>>>>>        // Gplan.Gplan_Resp
44244>>>>>>>>>>>>>>>
44244>>>>>>>>>>>>>>>        // Gplan.Gplan_Bitmap
44244>>>>>>>>>>>>>>>
44244>>>>>>>>>>>>>>>        // Gplan.Gplan_Rep_Code
44244>>>>>>>>>>>>>>>
44244>>>>>>>>>>>>>>>        // Gplan.Gplan_Rep_Pct
44244>>>>>>>>>>>>>>>
44244>>>>>>>>>>>>>>>        // Gplan.Gplan_I_Xy_Code
44244>>>>>>>>>>>>>>>
44244>>>>>>>>>>>>>>>        // Gplan.Gplan_I_Py_Code
44244>>>>>>>>>>>>>>>
44244>>>>>>>>>>>>>>>        // Gplan.Gplan_I_Ctypkin
44244>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_I_Ctypkin To (Gtypkin(Self))
44245>>>>>>>>>>>>>>>
44245>>>>>>>>>>>>>>>        // Gplan.Gplan_I_A_Code
44245>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_I_A_Code To "dbComboFormSub"
44246>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_I_A_Code To (Gplan_Gplan_I_A_Code_VT2(Self))
44247>>>>>>>>>>>>>>>
44247>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Myfp
44247>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Myfp To "dbComboFormSub"
44248>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Myfp To (Gplan_Gplan_Yn_VT(Self))
44249>>>>>>>>>>>>>>>
44249>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Myfa
44249>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Myfa To "dbComboFormSub"
44250>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Myfa To (Gplan_Gplan_Yn_VT(Self))
44251>>>>>>>>>>>>>>>
44251>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfnump
44251>>>>>>>>>>>>>>>
44251>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfvalp
44251>>>>>>>>>>>>>>>
44251>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfnuma
44251>>>>>>>>>>>>>>>
44251>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfvala
44251>>>>>>>>>>>>>>>
44251>>>>>>>>>>>>>>>        // Gplan.Gplan_Myf_Sump
44251>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Myf_Sump To "‰˜Ÿ¦¨åœ  œá¤ ¦  ®¨œé©œ ª/§ ©«é©œ ª Ÿ˜ ˜Ÿ¨¦ ©«¦ç¤ ©«ž¤ ‹“”"
44251>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Myf_Sump To "dbComboFormSub"
44252>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Myf_Sump To (Gplan_Gplan_Myf_Sum_VT(Self))
44253>>>>>>>>>>>>>>>
44253>>>>>>>>>>>>>>>        // Gplan.Gplan_Myf_Suma
44253>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Myf_Suma To "dbComboFormSub"
44254>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Myf_Suma To (Gplan_Gplan_Myf_Sum_VT(Self))
44255>>>>>>>>>>>>>>>
44255>>>>>>>>>>>>>>>        // Gplan.Gplan_Sx0
44255>>>>>>>>>>>>>>>
44255>>>>>>>>>>>>>>>        // Gplan.Gplan_Sp0
44255>>>>>>>>>>>>>>>
44255>>>>>>>>>>>>>>>        // Gplan.Gplan_Sx00
44255>>>>>>>>>>>>>>>
44255>>>>>>>>>>>>>>>        // Gplan.Gplan_Sp00
44255>>>>>>>>>>>>>>>
44255>>>>>>>>>>>>>>>        // Gplan.Gplan_Sxr
44255>>>>>>>>>>>>>>>
44255>>>>>>>>>>>>>>>        // Gplan.Gplan_Spr
44255>>>>>>>>>>>>>>>
44255>>>>>>>>>>>>>>>        // Gplan.Gplan_Sx2
44255>>>>>>>>>>>>>>>
44255>>>>>>>>>>>>>>>        // Gplan.Gplan_Sp2
44255>>>>>>>>>>>>>>>
44255>>>>>>>>>>>>>>>        // Gplan.Gplan_Gmhnnorec
44255>>>>>>>>>>>>>>>
44255>>>>>>>>>>>>>>>        // Gplan.Gplan_Recr
44255>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Recr To (sl150(Self))
44256>>>>>>>>>>>>>>>
44256>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
44256>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
44257>>>>>>>>>>>>>>>
44257>>>>>>>>>>>>>>>    // Field_Defaults:
44257>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
44257>>>>>>>>>>>>>>>
44257>>>>>>>>>>>>>>>    Procedure Field_Defaults
44258>>>>>>>>>>>>>>>        Forward Send Field_Defaults
44260>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44260>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
44260>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Xfer To 0
44261>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Last To 0
44262>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Kin To 1
44263>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Kk To 0
44264>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Xpm To 3
44265>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Xy To 1
44266>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Py To 1
44267>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Fpaent_Yn To 0
44268>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Rep_Pct To 100
44269>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Myfp To 0
44270>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Myfa To 0
44271>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
44271>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
44272>>>>>>>>>>>>>>>End_Class    // Gplan_DataDictionary
44273>>>>>>>>>>>>>>>
44273>>>>>>>>>>>>>>>
44273>>>>>>>>>>>>>>>
44273>>>>>>>>>>>>>>>
44273>>>>>>>>>>>>>>>
44273>>>>>>>>>>>>>>>
44273>>>>>>>>>>>>>>>
44273>>>>>>>>>>>>>>>
44273>>>>>>>>>>>>>>>
44273>>>>>>>>>>>>>>>
44273>>>>>>>>>>>>>>>
44273>>>>>>>>>>>>>>>
44273>>>>>>>>>>>>>>>
44273>>>>>>>>>>>>>>>
44273>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
44273>>>>>>>>>>>>>>>
44273>>>>>>>>>>>>>>>Use sl150.sl         // sl150
44273>>>>>>>>>>>>>>>Use Gtypkin.sl       // Gtypkin
INCLUDING FILE: GTYPKIN.SL
44273>>>>>>>>>>>>>>>>>//AB/ Project gtypkin:Gtypkin
44273>>>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
44273>>>>>>>>>>>>>>>>>//AB/         Set ProjectName to "gtypkin:Gtypkin"
44273>>>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "gtypkin.SL"
44273>>>>>>>>>>>>>>>>>
44273>>>>>>>>>>>>>>>>>// Project Object Structure
44273>>>>>>>>>>>>>>>>>//   gtypkin is a dbModalPanel
44273>>>>>>>>>>>>>>>>>//     Gthhmgio_DD is a DataDictionary
44273>>>>>>>>>>>>>>>>>//     Gtypkin_DD is a DataDictionary
44273>>>>>>>>>>>>>>>>>//     oSelList is a dbList
44273>>>>>>>>>>>>>>>>>//     oOK_bn is a Button
44273>>>>>>>>>>>>>>>>>//     oCancel_bn is a Button
44273>>>>>>>>>>>>>>>>>//     oSearch_bn is a Button
44273>>>>>>>>>>>>>>>>>
44273>>>>>>>>>>>>>>>>>// Register all objects
44273>>>>>>>>>>>>>>>>>Register_Object Gthhmgio_DD
44273>>>>>>>>>>>>>>>>>Register_Object Gtypkin_DD
44273>>>>>>>>>>>>>>>>>Register_Object gtypkin
44273>>>>>>>>>>>>>>>>>Register_Object oCancel_bn
44273>>>>>>>>>>>>>>>>>Register_Object oOK_bn
44273>>>>>>>>>>>>>>>>>Register_Object oSearch_bn
44273>>>>>>>>>>>>>>>>>Register_Object oSelList
44273>>>>>>>>>>>>>>>>>
44273>>>>>>>>>>>>>>>>>
44273>>>>>>>>>>>>>>>>>    //AB-IgnoreStart
44273>>>>>>>>>>>>>>>>>
44273>>>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
44273>>>>>>>>>>>>>>>>>
44273>>>>>>>>>>>>>>>>>
44273>>>>>>>>>>>>>>>>>    Use GTHHMGIO.DD
INCLUDING FILE: GTHHMGIO.DD
44273>>>>>>>>>>>>>>>>>>>//DDB-FileStart
44273>>>>>>>>>>>>>>>>>>>//DDB-HeaderStart
44273>>>>>>>>>>>>>>>>>>>
44273>>>>>>>>>>>>>>>>>>>// File Name : GTHHMGIO.DD
44273>>>>>>>>>>>>>>>>>>>// Class Name: Gthhmgio_DataDictionary
44273>>>>>>>>>>>>>>>>>>>// Revision  : 33
44273>>>>>>>>>>>>>>>>>>>// Version   : 2
44273>>>>>>>>>>>>>>>>>>>
44273>>>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
44273>>>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
44273>>>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
44273>>>>>>>>>>>>>>>>>>>
44273>>>>>>>>>>>>>>>>>>>Open Gthhmgio
INCLUDING FILE: GTHHMGIO.FD
44275>>>>>>>>>>>>>>>>>>>Open Gtypkin
44277>>>>>>>>>>>>>>>>>>>Open Gthaa
INCLUDING FILE: GTHAA.FD
44279>>>>>>>>>>>>>>>>>>>Open Sysrecg
44281>>>>>>>>>>>>>>>>>>>
44281>>>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
44281>>>>>>>>>>>>>>>>>>>//DDB-ValidationStart
44281>>>>>>>>>>>>>>>>>>>
44281>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio_Gthhmgio_Period_VT
44281>>>>>>>>>>>>>>>>>>>
44281>>>>>>>>>>>>>>>>>>>Object Gthhmgio_Gthhmgio_Period_VT  is a CodeValidationTable
44283>>>>>>>>>>>>>>>>>>>    Set Type_Value        To "PERIOD"
44284>>>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
44284>>>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
44284>>>>>>>>>>>>>>>>>>>End_Object   // Gthhmgio_Gthhmgio_Period_VT
44285>>>>>>>>>>>>>>>>>>>//DDB-ValidationEnd
44285>>>>>>>>>>>>>>>>>>>//DDB-SelectionStart
44285>>>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList Gthhmgio  Gthhmgio.SL
44285>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio
44285>>>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
44285>>>>>>>>>>>>>>>>>>>
44285>>>>>>>>>>>>>>>>>>>Class Gthhmgio_DataDictionary  is a DataDictionary_Sec
44286>>>>>>>>>>>>>>>>>>>
44286>>>>>>>>>>>>>>>>>>>
44286>>>>>>>>>>>>>>>>>>>    // Define_Fields:
44286>>>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
44286>>>>>>>>>>>>>>>>>>>
44286>>>>>>>>>>>>>>>>>>>    Procedure Define_Fields
44287>>>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
44289>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44289>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
44289>>>>>>>>>>>>>>>>>>>
44289>>>>>>>>>>>>>>>>>>>        Set Main_File            To Gthhmgio.File_Number
44290>>>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
44291>>>>>>>>>>>>>>>>>>>
44291>>>>>>>>>>>>>>>>>>>
44291>>>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
44291>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gtypkin.File_Number
44292>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gthaa.File_Number
44293>>>>>>>>>>>>>>>>>>>
44293>>>>>>>>>>>>>>>>>>>        // External (System) file structure.............
44293>>>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
44294>>>>>>>>>>>>>>>>>>>
44294>>>>>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gthhmgio_Rec0  To Gthhmgio.Gthhmgio_Rec0
44297>>>>>>>>>>>>>>>>>>>
44297>>>>>>>>>>>>>>>>>>>        // Field-based properties.......................
44297>>>>>>>>>>>>>>>>>>>
44297>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Code
44297>>>>>>>>>>>>>>>>>>>        Set Field_Options          Field Gthhmgio.Gthhmgio_Code To DD_AUTOFIND   
44298>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gthhmgio.Gthhmgio_Code To (Gthhmgio(Self))
44299>>>>>>>>>>>>>>>>>>>        Set Key_Field_State        Field Gthhmgio.Gthhmgio_Code To TRUE
44300>>>>>>>>>>>>>>>>>>>
44300>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Rec0
44300>>>>>>>>>>>>>>>>>>>
44300>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Descr
44300>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gthhmgio.Gthhmgio_Descr To (Gthhmgio(Self))
44301>>>>>>>>>>>>>>>>>>>
44301>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Period
44301>>>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gthhmgio.Gthhmgio_Period To (Gthhmgio_Gthhmgio_Period_VT(Self))
44302>>>>>>>>>>>>>>>>>>>
44302>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Recr
44302>>>>>>>>>>>>>>>>>>>        Set Field_Options          Field Gthhmgio.Gthhmgio_Recr To DD_AUTOFIND   
44303>>>>>>>>>>>>>>>>>>>        Set Key_Field_State        Field Gthhmgio.Gthhmgio_Recr To TRUE
44304>>>>>>>>>>>>>>>>>>>
44304>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
44304>>>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
44305>>>>>>>>>>>>>>>>>>>
44305>>>>>>>>>>>>>>>>>>>    // Field_Defaults:
44305>>>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
44305>>>>>>>>>>>>>>>>>>>
44305>>>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
44306>>>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
44308>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44308>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
44308>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
44308>>>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
44309>>>>>>>>>>>>>>>>>>>End_Class    // Gthhmgio_DataDictionary
44310>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
44310>>>>>>>>>>>>>>>>>>>
44310>>>>>>>>>>>>>>>>>>>Use Gthhmgio.SL      // Gthhmgio
INCLUDING FILE: GTHHMGIO.SL
44310>>>>>>>>>>>>>>>>>>>>>//AB/ Project Gthhmgio:Gthhmgio
44310>>>>>>>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
44310>>>>>>>>>>>>>>>>>>>>>//AB/         Set ProjectName to "Gthhmgio:Gthhmgio"
44310>>>>>>>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "Gthhmgio.SL"
44310>>>>>>>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
44310>>>>>>>>>>>>>>>>>>>>>
44310>>>>>>>>>>>>>>>>>>>>>// Project Object Structure
44310>>>>>>>>>>>>>>>>>>>>>//   Gthhmgio is a dbModalPanel
44310>>>>>>>>>>>>>>>>>>>>>//     Gthhmgio_DD is a DataDictionary
44310>>>>>>>>>>>>>>>>>>>>>//     oSelList is a dbList
44310>>>>>>>>>>>>>>>>>>>>>//     oOK_bn is a Button
44310>>>>>>>>>>>>>>>>>>>>>//     oCancel_bn is a Button
44310>>>>>>>>>>>>>>>>>>>>>//     oSearch_bn is a Button
44310>>>>>>>>>>>>>>>>>>>>>
44310>>>>>>>>>>>>>>>>>>>>>// Register all objects
44310>>>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio_DD
44310>>>>>>>>>>>>>>>>>>>>>Register_Object oCancel_bn
44310>>>>>>>>>>>>>>>>>>>>>Register_Object oOK_bn
44310>>>>>>>>>>>>>>>>>>>>>Register_Object oSearch_bn
44310>>>>>>>>>>>>>>>>>>>>>Register_Object oSelList
44310>>>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio
44310>>>>>>>>>>>>>>>>>>>>>
44310>>>>>>>>>>>>>>>>>>>>>
44310>>>>>>>>>>>>>>>>>>>>>    //AB-IgnoreStart
44310>>>>>>>>>>>>>>>>>>>>>
44310>>>>>>>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
44310>>>>>>>>>>>>>>>>>>>>>
44310>>>>>>>>>>>>>>>>>>>>>
44310>>>>>>>>>>>>>>>>>>>>>    Use GTHHMGIO.DD
44310>>>>>>>>>>>>>>>>>>>>>
44310>>>>>>>>>>>>>>>>>>>>>    //AB-IgnoreEnd
44310>>>>>>>>>>>>>>>>>>>>>
44310>>>>>>>>>>>>>>>>>>>>>    CD_Popup_Object Gthhmgio is a dbModalPanel
44329>>>>>>>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
44330>>>>>>>>>>>>>>>>>>>>>        Set Label to "Šå©«˜ †£œ¨¦¢¦šåà¤"
44331>>>>>>>>>>>>>>>>>>>>>        Set Size to 148 297
44332>>>>>>>>>>>>>>>>>>>>>        Set Location to 4 5
44333>>>>>>>>>>>>>>>>>>>>>
44333>>>>>>>>>>>>>>>>>>>>>        //AB-DDOStart
44333>>>>>>>>>>>>>>>>>>>>>
44333>>>>>>>>>>>>>>>>>>>>>        Object Gthhmgio_DD is a Gthhmgio_DataDictionary
44335>>>>>>>>>>>>>>>>>>>>>        End_Object    // Gthhmgio_DD
44336>>>>>>>>>>>>>>>>>>>>>
44336>>>>>>>>>>>>>>>>>>>>>        Set Main_DD to (Gthhmgio_DD(self))
44337>>>>>>>>>>>>>>>>>>>>>        Set Server to (Gthhmgio_DD(self))
44338>>>>>>>>>>>>>>>>>>>>>
44338>>>>>>>>>>>>>>>>>>>>>        //AB-DDOEnd
44338>>>>>>>>>>>>>>>>>>>>>
44338>>>>>>>>>>>>>>>>>>>>>        Object oSelList is a dbList
44340>>>>>>>>>>>>>>>>>>>>>            Set Main_File to Gthhmgio.File_Number
44341>>>>>>>>>>>>>>>>>>>>>            Set Size to 105 280
44342>>>>>>>>>>>>>>>>>>>>>            Set Location to 6 6
44343>>>>>>>>>>>>>>>>>>>>>
44343>>>>>>>>>>>>>>>>>>>>>            Begin_Row
44346>>>>>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_code
44347>>>>>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_descr
44348>>>>>>>>>>>>>>>>>>>>>            End_Row
44353>>>>>>>>>>>>>>>>>>>>>
44353>>>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 52
44354>>>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
44355>>>>>>>>>>>>>>>>>>>>>
44355>>>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 220
44356>>>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
44357>>>>>>>>>>>>>>>>>>>>>
44357>>>>>>>>>>>>>>>>>>>>>        End_Object    // oSelList
44358>>>>>>>>>>>>>>>>>>>>>
44358>>>>>>>>>>>>>>>>>>>>>        Object oOK_bn is a Button
44360>>>>>>>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
44361>>>>>>>>>>>>>>>>>>>>>            Set Location to 111 127
44362>>>>>>>>>>>>>>>>>>>>>
44362>>>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
44362>>>>>>>>>>>>>>>>>>>>>            Procedure OnClick
44364>>>>>>>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
44365>>>>>>>>>>>>>>>>>>>>>            End_Procedure
44366>>>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
44366>>>>>>>>>>>>>>>>>>>>>
44366>>>>>>>>>>>>>>>>>>>>>        End_Object    // oOK_bn
44367>>>>>>>>>>>>>>>>>>>>>
44367>>>>>>>>>>>>>>>>>>>>>        Object oCancel_bn is a Button
44369>>>>>>>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
44370>>>>>>>>>>>>>>>>>>>>>            Set Location to 111 181
44371>>>>>>>>>>>>>>>>>>>>>
44371>>>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
44371>>>>>>>>>>>>>>>>>>>>>            Procedure OnClick
44373>>>>>>>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
44374>>>>>>>>>>>>>>>>>>>>>            End_Procedure
44375>>>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
44375>>>>>>>>>>>>>>>>>>>>>
44375>>>>>>>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
44376>>>>>>>>>>>>>>>>>>>>>
44376>>>>>>>>>>>>>>>>>>>>>        Object oSearch_bn is a Button
44378>>>>>>>>>>>>>>>>>>>>>            Set Label to "&€¤˜ã«ž©ž..."
44379>>>>>>>>>>>>>>>>>>>>>            Set Location to 111 237
44380>>>>>>>>>>>>>>>>>>>>>
44380>>>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
44380>>>>>>>>>>>>>>>>>>>>>            Procedure OnClick
44382>>>>>>>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
44383>>>>>>>>>>>>>>>>>>>>>            End_Procedure
44384>>>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
44384>>>>>>>>>>>>>>>>>>>>>
44384>>>>>>>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
44385>>>>>>>>>>>>>>>>>>>>>
44385>>>>>>>>>>>>>>>>>>>>>
44385>>>>>>>>>>>>>>>>>>>>>        //AB-StoreStart
44385>>>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
44386>>>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
44387>>>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
44388>>>>>>>>>>>>>>>>>>>>>        //AB-StoreEnd
44388>>>>>>>>>>>>>>>>>>>>>
44388>>>>>>>>>>>>>>>>>>>>>    CD_End_Object    // Gthhmgio
44390>>>>>>>>>>>>>>>>>>>>>>
44390>>>>>>>>>>>>>>>>>>>>>
44390>>>>>>>>>>>>>>>>>>>>>//AB/     End_Object    // prj
44390>>>>>>>>>>>>>>>>>>>
44390>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
44390>>>>>>>>>>>>>>>>>>>//DDB-FileEnd
44390>>>>>>>>>>>>>>>>>    Use GTYPKIN.DD
INCLUDING FILE: GTYPKIN.DD
44390>>>>>>>>>>>>>>>>>>>//DDB-FileStart
44390>>>>>>>>>>>>>>>>>>>//DDB-HeaderStart
44390>>>>>>>>>>>>>>>>>>>
44390>>>>>>>>>>>>>>>>>>>// File Name : GTYPKIN.DD
44390>>>>>>>>>>>>>>>>>>>// Class Name: Gtypkin_DataDictionary
44390>>>>>>>>>>>>>>>>>>>// Revision  : 45
44390>>>>>>>>>>>>>>>>>>>// Version   : 2
44390>>>>>>>>>>>>>>>>>>>
44390>>>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
44390>>>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
44390>>>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
44390>>>>>>>>>>>>>>>>>>>
44390>>>>>>>>>>>>>>>>>>>Open Gtypkin
44392>>>>>>>>>>>>>>>>>>>Open Garticl
44394>>>>>>>>>>>>>>>>>>>Open Gflagkin
INCLUDING FILE: GFLAGKIN.FD
44396>>>>>>>>>>>>>>>>>>>Open Gparticl
INCLUDING FILE: GPARTICL.FD
44398>>>>>>>>>>>>>>>>>>>Open Gthhmgio
44400>>>>>>>>>>>>>>>>>>>Open Sysrecg
44402>>>>>>>>>>>>>>>>>>>
44402>>>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
44402>>>>>>>>>>>>>>>>>>>//DDB-SelectionStart
44402>>>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList gtypkin  gtypkin.SL
44402>>>>>>>>>>>>>>>>>>>Register_Object gtypkin
44402>>>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
44402>>>>>>>>>>>>>>>>>>>Open SysCurGL
44404>>>>>>>>>>>>>>>>>>>
44404>>>>>>>>>>>>>>>>>>>Class Gtypkin_DataDictionary  is a DataDictionary_Sec
44405>>>>>>>>>>>>>>>>>>>
44405>>>>>>>>>>>>>>>>>>>    Procedure Entry_Order_Date  Integer iField  Date dDate
44406>>>>>>>>>>>>>>>>>>>         // Add a default date if the field is blank
44406>>>>>>>>>>>>>>>>>>>         Integer Changed
44407>>>>>>>>>>>>>>>>>>>         Get Field_Changed_State iField to Changed
44408>>>>>>>>>>>>>>>>>>>         If (Changed=0 AND dDate =0) Begin
44410>>>>>>>>>>>>>>>>>>>             SysDate4 dDate
44411>>>>>>>>>>>>>>>>>>>             Set Field_Default_Value iField to dDate
44412>>>>>>>>>>>>>>>>>>>         End
44412>>>>>>>>>>>>>>>>>>>>
44412>>>>>>>>>>>>>>>>>>>    End_Procedure
44413>>>>>>>>>>>>>>>>>>>
44413>>>>>>>>>>>>>>>>>>>    Procedure Construct_Object
44414>>>>>>>>>>>>>>>>>>>        Forward Send Construct_Object
44416>>>>>>>>>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
44417>>>>>>>>>>>>>>>>>>>        Property Date    pdDefault_Hmnia    Public 0
44418>>>>>>>>>>>>>>>>>>>        Property Integer piRate             Public 0
44419>>>>>>>>>>>>>>>>>>>        Property Integer piGthhmgio_dd      Public 0
44420>>>>>>>>>>>>>>>>>>>    End_Procedure   // Construct_Object
44421>>>>>>>>>>>>>>>>>>>
44421>>>>>>>>>>>>>>>>>>>//    Procedure OnConstrain
44421>>>>>>>>>>>>>>>>>>>//        Forward Send OnConstrain
44421>>>>>>>>>>>>>>>>>>>//        If (piMustNOTConstrain(Self)) Begin
44421>>>>>>>>>>>>>>>>>>>//        End
44421>>>>>>>>>>>>>>>>>>>//        Else Begin
44421>>>>>>>>>>>>>>>>>>>//            Constrain Gtypkin.Company_Code  eq SysCurGL.Company_Code
44421>>>>>>>>>>>>>>>>>>>//            Constrain Gtypkin.Branch_Code   eq SysCurGL.Branch_Code
44421>>>>>>>>>>>>>>>>>>>//            Constrain Gtypkin.Year_Year     eq SysCurGL.Year_Year
44421>>>>>>>>>>>>>>>>>>>//        End
44421>>>>>>>>>>>>>>>>>>>//    End_Procedure
44421>>>>>>>>>>>>>>>>>>>
44421>>>>>>>>>>>>>>>>>>>    Procedure Update
44422>>>>>>>>>>>>>>>>>>>        Forward Send Update
44424>>>>>>>>>>>>>>>>>>>        // Insert Code Here
44424>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Company_Code  to Gtypkin.Company_Code
44425>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Branch_Code   to Gtypkin.Branch_Code
44426>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Year_Year     to Gtypkin.Year_Year
44427>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Year_Recr     to Gtypkin.Year_Recr
44428>>>>>>>>>>>>>>>>>>>        Move Gthhmgio.Gthhmgio_Code to Gtypkin.Gthhmgio_Code
44429>>>>>>>>>>>>>>>>>>>    End_Procedure   // Update
44430>>>>>>>>>>>>>>>>>>>
44430>>>>>>>>>>>>>>>>>>>    Procedure Creating
44431>>>>>>>>>>>>>>>>>>>        Forward Send Creating
44433>>>>>>>>>>>>>>>>>>>        // Insert Code Here
44433>>>>>>>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurGL.Branch_Site))+;                         (Trim(String(Gtypkin.Gtypkin_Rec0)))))) to Gtypkin.Gtypkin_Recr
44434>>>>>>>>>>>>>>>>>>>    End_Procedure   // Creating
44435>>>>>>>>>>>>>>>>>>>
44435>>>>>>>>>>>>>>>>>>>
44435>>>>>>>>>>>>>>>>>>>
44435>>>>>>>>>>>>>>>>>>>//----------------------------------------------------------------------------
44435>>>>>>>>>>>>>>>>>>>
44435>>>>>>>>>>>>>>>>>>>//    Procedure Creating
44435>>>>>>>>>>>>>>>>>>>//              Forward Send Creating
44435>>>>>>>>>>>>>>>>>>>//              Add 1 to Year.Year_NumGtypkin //˜¨ Ÿ£æª «ç§à¤ ¡ ¤ã©œà¤ «žª ®¨ã©žª
44435>>>>>>>>>>>>>>>>>>>//    End_Procedure //creating
44435>>>>>>>>>>>>>>>>>>>//    Procedure Deleting
44435>>>>>>>>>>>>>>>>>>>//              Forward Send Deleting
44435>>>>>>>>>>>>>>>>>>>//              Sub 1 from Year.Year_NumGtypkin //˜¨ Ÿ£æª «ç§à¤ ¡ ¤ã©œà¤ «žª ®¨ã©žª
44435>>>>>>>>>>>>>>>>>>>//    End_Procedure //deleting
44435>>>>>>>>>>>>>>>>>>>
44435>>>>>>>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
44436>>>>>>>>>>>>>>>>>>>        Integer iReturnVal
44437>>>>>>>>>>>>>>>>>>>        Forward Get Validate_Save To iReturnVal
44439>>>>>>>>>>>>>>>>>>>//        If (Not(iReturnVal)) Begin
44439>>>>>>>>>>>>>>>>>>>//            //1100:cby = globals
44439>>>>>>>>>>>>>>>>>>>//            If ( ;
44439>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Company_Code = SysCurGL.Company_Code)) or;
44439>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Branch_Code  = SysCurGL.Branch_Code )) or;
44439>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Year_Year    = SysCurGL.Year_Year   ));
44439>>>>>>>>>>>>>>>>>>>//                ) Send Operation_Not_Allowed 1100
44439>>>>>>>>>>>>>>>>>>>//        End
44439>>>>>>>>>>>>>>>>>>>        Function_Return iReturnVal
44440>>>>>>>>>>>>>>>>>>>    End_Function   //validate_save
44441>>>>>>>>>>>>>>>>>>>
44441>>>>>>>>>>>>>>>>>>>
44441>>>>>>>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
44442>>>>>>>>>>>>>>>>>>>        Integer iReturnVal
44443>>>>>>>>>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
44445>>>>>>>>>>>>>>>>>>>//        If (Not(iReturnVal)) Begin
44445>>>>>>>>>>>>>>>>>>>//            //2100:cby = globals
44445>>>>>>>>>>>>>>>>>>>//            If ( ;
44445>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Company_Code = SysCurGL.Company_Code)) or;
44445>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Branch_Code  = SysCurGL.Branch_Code )) or;
44445>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Year_Year    = SysCurGL.Year_Year   ));
44445>>>>>>>>>>>>>>>>>>>//                ) Send Operation_Not_Allowed 2100
44445>>>>>>>>>>>>>>>>>>>//        End
44445>>>>>>>>>>>>>>>>>>>        Function_Return iReturnVal
44446>>>>>>>>>>>>>>>>>>>    End_Function   // validate_delete
44447>>>>>>>>>>>>>>>>>>>
44447>>>>>>>>>>>>>>>>>>>
44447>>>>>>>>>>>>>>>>>>>
44447>>>>>>>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
44448>>>>>>>>>>>>>>>>>>>              Case Begin
44448>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1100)
44450>>>>>>>>>>>>>>>>>>>                        Error 1100 "DDC 151:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
44451>>>>>>>>>>>>>>>>>>>>
44451>>>>>>>>>>>>>>>>>>>                        Case Break
44452>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 2100)
44455>>>>>>>>>>>>>>>>>>>                        Error 2100 "DDC 151:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
44456>>>>>>>>>>>>>>>>>>>>
44456>>>>>>>>>>>>>>>>>>>                        Case Break
44457>>>>>>>>>>>>>>>>>>>                   Case Else
44457>>>>>>>>>>>>>>>>>>>                        Forward Send Operation_Not_Allowed  iError_Num
44459>>>>>>>>>>>>>>>>>>>              Case End
44459>>>>>>>>>>>>>>>>>>>    End_Procedure   //operation_not_allowed
44460>>>>>>>>>>>>>>>>>>>
44460>>>>>>>>>>>>>>>>>>>
44460>>>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
44461>>>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
44463>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44463>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
44463>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
44463>>>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
44464>>>>>>>>>>>>>>>>>>>
44464>>>>>>>>>>>>>>>>>>>
44464>>>>>>>>>>>>>>>>>>>
44464>>>>>>>>>>>>>>>>>>>    // Define_Fields:
44464>>>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
44464>>>>>>>>>>>>>>>>>>>
44464>>>>>>>>>>>>>>>>>>>    Procedure Define_Fields
44465>>>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
44467>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44467>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
44467>>>>>>>>>>>>>>>>>>>
44467>>>>>>>>>>>>>>>>>>>        Set Main_File            To Gtypkin.File_Number
44468>>>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
44469>>>>>>>>>>>>>>>>>>>
44469>>>>>>>>>>>>>>>>>>>
44469>>>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
44469>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Garticl.File_Number
44470>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gflagkin.File_Number
44471>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gparticl.File_Number
44472>>>>>>>>>>>>>>>>>>>
44472>>>>>>>>>>>>>>>>>>>        // Parent (Server) file structure...............
44472>>>>>>>>>>>>>>>>>>>        Send Add_Server_File  Gthhmgio.File_Number
44473>>>>>>>>>>>>>>>>>>>
44473>>>>>>>>>>>>>>>>>>>        // External (System) file structure.............
44473>>>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
44474>>>>>>>>>>>>>>>>>>>
44474>>>>>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gtypkin_Rec0  To Gtypkin.Gtypkin_Rec0
44477>>>>>>>>>>>>>>>>>>>
44477>>>>>>>>>>>>>>>>>>>        // Field-based properties.......................
44477>>>>>>>>>>>>>>>>>>>
44477>>>>>>>>>>>>>>>>>>>        // Gtypkin.Company_Code
44477>>>>>>>>>>>>>>>>>>>
44477>>>>>>>>>>>>>>>>>>>        // Gtypkin.Branch_Code
44477>>>>>>>>>>>>>>>>>>>
44477>>>>>>>>>>>>>>>>>>>        // Gtypkin.Year_Year
44477>>>>>>>>>>>>>>>>>>>
44477>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Code
44477>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gtypkin.Gtypkin_Code To (gtypkin(Self))
44478>>>>>>>>>>>>>>>>>>>
44478>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Rec0
44478>>>>>>>>>>>>>>>>>>>
44478>>>>>>>>>>>>>>>>>>>        // Gtypkin.Year_Recr
44478>>>>>>>>>>>>>>>>>>>
44478>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gthhmgio_Code
44478>>>>>>>>>>>>>>>>>>>
44478>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gthhmgio_Recr
44478>>>>>>>>>>>>>>>>>>>
44478>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Descr
44478>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gtypkin.Gtypkin_Descr To (gtypkin(Self))
44479>>>>>>>>>>>>>>>>>>>
44479>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Anti
44479>>>>>>>>>>>>>>>>>>>
44479>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Printer
44479>>>>>>>>>>>>>>>>>>>
44479>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Form
44479>>>>>>>>>>>>>>>>>>>
44479>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_L_No
44479>>>>>>>>>>>>>>>>>>>
44479>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_L_Hmnia
44479>>>>>>>>>>>>>>>>>>>
44479>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Seira
44479>>>>>>>>>>>>>>>>>>>
44479>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Abr
44479>>>>>>>>>>>>>>>>>>>
44479>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag01
44479>>>>>>>>>>>>>>>>>>>
44479>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag02
44479>>>>>>>>>>>>>>>>>>>
44479>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag03
44479>>>>>>>>>>>>>>>>>>>
44479>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag04
44479>>>>>>>>>>>>>>>>>>>
44479>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag05
44479>>>>>>>>>>>>>>>>>>>
44479>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag06
44479>>>>>>>>>>>>>>>>>>>
44479>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag07
44479>>>>>>>>>>>>>>>>>>>
44479>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag08
44479>>>>>>>>>>>>>>>>>>>
44479>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag09
44479>>>>>>>>>>>>>>>>>>>
44479>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag10
44479>>>>>>>>>>>>>>>>>>>
44479>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag11
44479>>>>>>>>>>>>>>>>>>>
44479>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag12
44479>>>>>>>>>>>>>>>>>>>
44479>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag13
44479>>>>>>>>>>>>>>>>>>>
44479>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag14
44479>>>>>>>>>>>>>>>>>>>
44479>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag15
44479>>>>>>>>>>>>>>>>>>>
44479>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag16
44479>>>>>>>>>>>>>>>>>>>
44479>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag17
44479>>>>>>>>>>>>>>>>>>>
44479>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag18
44479>>>>>>>>>>>>>>>>>>>
44479>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag19
44479>>>>>>>>>>>>>>>>>>>
44479>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag20
44479>>>>>>>>>>>>>>>>>>>
44479>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Recr
44479>>>>>>>>>>>>>>>>>>>
44479>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
44479>>>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
44480>>>>>>>>>>>>>>>>>>>End_Class    // Gtypkin_DataDictionary
44481>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
44481>>>>>>>>>>>>>>>>>>>
44481>>>>>>>>>>>>>>>>>>>Use gtypkin.SL       // gtypkin
44481>>>>>>>>>>>>>>>>>>>
44481>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
44481>>>>>>>>>>>>>>>>>>>//DDB-FileEnd
44481>>>>>>>>>>>>>>>>>    
44481>>>>>>>>>>>>>>>>>    //AB-IgnoreEnd
44481>>>>>>>>>>>>>>>>>
44481>>>>>>>>>>>>>>>>>    CD_Popup_Object gtypkin is a dbModalPanel
44500>>>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
44501>>>>>>>>>>>>>>>>>        Set Label to "Šå©«˜ ‰ ¤ã©œà¤"
44502>>>>>>>>>>>>>>>>>        Set Size to 171 467
44503>>>>>>>>>>>>>>>>>        Set Location to 4 5
44504>>>>>>>>>>>>>>>>>
44504>>>>>>>>>>>>>>>>>        //AB-DDOStart
44504>>>>>>>>>>>>>>>>>
44504>>>>>>>>>>>>>>>>>        Object Gthhmgio_DD is a Gthhmgio_DataDictionary
44506>>>>>>>>>>>>>>>>>        End_Object    // Gthhmgio_DD
44507>>>>>>>>>>>>>>>>>
44507>>>>>>>>>>>>>>>>>        Object Gtypkin_DD is a Gtypkin_DataDictionary
44509>>>>>>>>>>>>>>>>>            Set DDO_Server to (Gthhmgio_DD(self))
44510>>>>>>>>>>>>>>>>>        End_Object    // Gtypkin_DD
44511>>>>>>>>>>>>>>>>>
44511>>>>>>>>>>>>>>>>>        Set Main_DD to (Gtypkin_DD(self))
44512>>>>>>>>>>>>>>>>>        Set Server to (Gtypkin_DD(self))
44513>>>>>>>>>>>>>>>>>
44513>>>>>>>>>>>>>>>>>        //AB-DDOEnd
44513>>>>>>>>>>>>>>>>>
44513>>>>>>>>>>>>>>>>>        Object oSelList is a dbList
44515>>>>>>>>>>>>>>>>>            Set Main_File to Gtypkin.File_Number
44516>>>>>>>>>>>>>>>>>            Set Size to 132 450
44517>>>>>>>>>>>>>>>>>            Set Location to 6 6
44518>>>>>>>>>>>>>>>>>
44518>>>>>>>>>>>>>>>>>            Begin_Row
44521>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_code
44522>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_descr
44523>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_abr
44524>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_seira
44525>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_code
44526>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_descr
44527>>>>>>>>>>>>>>>>>            End_Row
44532>>>>>>>>>>>>>>>>>
44532>>>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 40
44533>>>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
44534>>>>>>>>>>>>>>>>>            
44534>>>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 150
44535>>>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
44536>>>>>>>>>>>>>>>>>            
44536>>>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 68
44537>>>>>>>>>>>>>>>>>            Set Header_Label  item 2 to "‘¬¤«¦£¦š¨˜­å˜"
44538>>>>>>>>>>>>>>>>>            
44538>>>>>>>>>>>>>>>>>            Set Form_Width    item 3 to 30
44539>>>>>>>>>>>>>>>>>            Set Header_Label  item 3 to "‘œ ¨á"
44540>>>>>>>>>>>>>>>>>            
44540>>>>>>>>>>>>>>>>>            Set Form_Width    item 4 to 55
44541>>>>>>>>>>>>>>>>>            Set Header_Label  item 4 to "‰à› ¡æª †£/š ¦¬"
44542>>>>>>>>>>>>>>>>>            
44542>>>>>>>>>>>>>>>>>            Set Form_Width    item 5 to 99
44543>>>>>>>>>>>>>>>>>            Set Header_Label  item 5 to "œ¨ š¨˜­ã †£/šå¦¬"
44544>>>>>>>>>>>>>>>>>            
44544>>>>>>>>>>>>>>>>>        End_Object    // oSelList
44545>>>>>>>>>>>>>>>>>
44545>>>>>>>>>>>>>>>>>        Object oOK_bn is a Button
44547>>>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
44548>>>>>>>>>>>>>>>>>            Set Location to 140 298
44549>>>>>>>>>>>>>>>>>
44549>>>>>>>>>>>>>>>>>            //AB-StoreStart
44549>>>>>>>>>>>>>>>>>            Procedure OnClick
44551>>>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
44552>>>>>>>>>>>>>>>>>            End_Procedure
44553>>>>>>>>>>>>>>>>>            //AB-StoreEnd
44553>>>>>>>>>>>>>>>>>
44553>>>>>>>>>>>>>>>>>        End_Object    // oOK_bn
44554>>>>>>>>>>>>>>>>>
44554>>>>>>>>>>>>>>>>>        Object oCancel_bn is a Button
44556>>>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
44557>>>>>>>>>>>>>>>>>            Set Location to 140 353
44558>>>>>>>>>>>>>>>>>
44558>>>>>>>>>>>>>>>>>            //AB-StoreStart
44558>>>>>>>>>>>>>>>>>            Procedure OnClick
44560>>>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
44561>>>>>>>>>>>>>>>>>            End_Procedure
44562>>>>>>>>>>>>>>>>>            //AB-StoreEnd
44562>>>>>>>>>>>>>>>>>
44562>>>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
44563>>>>>>>>>>>>>>>>>
44563>>>>>>>>>>>>>>>>>        Object oSearch_bn is a Button
44565>>>>>>>>>>>>>>>>>            Set Label to "&€¤˜ã«ž©ž..."
44566>>>>>>>>>>>>>>>>>            Set Location to 140 408
44567>>>>>>>>>>>>>>>>>
44567>>>>>>>>>>>>>>>>>            //AB-StoreStart
44567>>>>>>>>>>>>>>>>>            Procedure OnClick
44569>>>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
44570>>>>>>>>>>>>>>>>>            End_Procedure
44571>>>>>>>>>>>>>>>>>            //AB-StoreEnd
44571>>>>>>>>>>>>>>>>>
44571>>>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
44572>>>>>>>>>>>>>>>>>
44572>>>>>>>>>>>>>>>>>
44572>>>>>>>>>>>>>>>>>        //AB-StoreStart
44572>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
44573>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
44574>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
44575>>>>>>>>>>>>>>>>>        //AB-StoreEnd
44575>>>>>>>>>>>>>>>>>
44575>>>>>>>>>>>>>>>>>    CD_End_Object    // gtypkin
44577>>>>>>>>>>>>>>>>>>
44577>>>>>>>>>>>>>>>>>
44577>>>>>>>>>>>>>>>>>//AB/     End_Object    // prj
44577>>>>>>>>>>>>>>>
44577>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
44577>>>>>>>>>>>>>>>//DDB-FileEnd
44577>>>>>>>>>>>>>    
44577>>>>>>>>>>>>>    //AB-IgnoreEnd
44577>>>>>>>>>>>>>
44577>>>>>>>>>>>>>    CD_Popup_Object sl150 is a dbModalPanelSub
44596>>>>>>>>>>>>>
44596>>>>>>>>>>>>>        //AB-StoreTopStart
44596>>>>>>>>>>>>>        Property Integer piFragmaLast -1
44598>>>>>>>>>>>>>        Property String  psFragmaFromCode ""
44600>>>>>>>>>>>>>        Property String  psFragmaToCode ""
44602>>>>>>>>>>>>>        
44602>>>>>>>>>>>>>        //AB-StoreTopEnd
44602>>>>>>>>>>>>>
44602>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
44603>>>>>>>>>>>>>        Set Label to "Šå©«˜ Š¦š˜¨ ˜©£é¤"
44604>>>>>>>>>>>>>        Set Size to 204 393
44605>>>>>>>>>>>>>        Set Location to 5 16
44606>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
44607>>>>>>>>>>>>>        Set Modal_State to FALSE
44608>>>>>>>>>>>>>
44608>>>>>>>>>>>>>        //AB-DDOStart
44608>>>>>>>>>>>>>
44608>>>>>>>>>>>>>        Object Gplan_DD is a Gplan_DataDictionary
44610>>>>>>>>>>>>>
44610>>>>>>>>>>>>>            //AB-StoreStart
44610>>>>>>>>>>>>>                        
44610>>>>>>>>>>>>>            Procedure OnConstrain
44612>>>>>>>>>>>>>                Integer liFragmaLast
44613>>>>>>>>>>>>>                String lsFragmaFromCode lsFragmaToCode
44613>>>>>>>>>>>>>                Get piFragmaLast     to liFragmaLast
44614>>>>>>>>>>>>>                Get psFragmaFromCode to lsFragmaFromCode
44615>>>>>>>>>>>>>                Get psFragmaToCode   to lsFragmaToCode
44616>>>>>>>>>>>>>                If (liFragmaLast <> -1)     Constrain Gplan.Gplan_Yn_Last eq liFragmaLast
44620>>>>>>>>>>>>>                If (lsFragmaFromCode <> "") Constrain Gplan.Gplan_Code    ge lsFragmaFromCode
44624>>>>>>>>>>>>>                If (lsFragmaToCode <> "")   Constrain Gplan.Gplan_Code    le lsFragmaToCode
44628>>>>>>>>>>>>>            End_Procedure // OnConstrain
44629>>>>>>>>>>>>>            
44629>>>>>>>>>>>>>            
44629>>>>>>>>>>>>>            //AB-StoreEnd
44629>>>>>>>>>>>>>
44629>>>>>>>>>>>>>        End_Object    // Gplan_DD
44630>>>>>>>>>>>>>
44630>>>>>>>>>>>>>        Set Main_DD to (Gplan_DD(self))
44631>>>>>>>>>>>>>        Set Server to (Gplan_DD(self))
44632>>>>>>>>>>>>>
44632>>>>>>>>>>>>>        //AB-DDOEnd
44632>>>>>>>>>>>>>
44632>>>>>>>>>>>>>        Object oSelList is a dbListSub
44634>>>>>>>>>>>>>            Set Main_File to Gplan.File_Number
44635>>>>>>>>>>>>>            Set Ordering to 3
44636>>>>>>>>>>>>>            Set Size to 164 378
44637>>>>>>>>>>>>>            Set Location to 4 6
44638>>>>>>>>>>>>>
44638>>>>>>>>>>>>>            Begin_Row
44641>>>>>>>>>>>>>                Entry_Item Gplan.Gplan_code
44642>>>>>>>>>>>>>                Entry_Item Gplan.Gplan_descr1
44643>>>>>>>>>>>>>                Entry_Item Gplan.Gplan_bathmos
44644>>>>>>>>>>>>>                Entry_Item Gplan.Gplan_yn_last
44645>>>>>>>>>>>>>            End_Row
44650>>>>>>>>>>>>>
44650>>>>>>>>>>>>>            Set Form_Width    item 0 to 105
44651>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
44652>>>>>>>>>>>>>            
44652>>>>>>>>>>>>>            Set Form_Width    item 1 to 212
44653>>>>>>>>>>>>>            Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
44654>>>>>>>>>>>>>            
44654>>>>>>>>>>>>>            Set Form_Width    item 2 to 34
44655>>>>>>>>>>>>>            Set Header_Label  item 2 to "˜Ÿ£æª"
44656>>>>>>>>>>>>>            
44656>>>>>>>>>>>>>            Set Form_Width    item 3 to 19
44657>>>>>>>>>>>>>            Set Header_Label  item 3 to " ’"
44658>>>>>>>>>>>>>            Set Column_Checkbox_State  item 3 to True
44659>>>>>>>>>>>>>            
44659>>>>>>>>>>>>>
44659>>>>>>>>>>>>>            //AB-StoreStart
44659>>>>>>>>>>>>>                        
44659>>>>>>>>>>>>>            Property String piStoredFragmaLast -1
44661>>>>>>>>>>>>>            Property String psStoredFragmaFromCode ""
44663>>>>>>>>>>>>>            Property String psStoredFragmaToCode ""
44665>>>>>>>>>>>>>            
44665>>>>>>>>>>>>>            Procedure Store_Defaults
44667>>>>>>>>>>>>>                forward send Store_Defaults
44669>>>>>>>>>>>>>                Set piStoredFragmaLast     to (piFragmaLast(Self))
44670>>>>>>>>>>>>>                Set psStoredFragmaFromCode to (psFragmaFromCode(Self))
44671>>>>>>>>>>>>>                Set psStoredFragmaToCode   to (psFragmaToCode(Self))
44672>>>>>>>>>>>>>            end_Procedure // Store_Defaults
44673>>>>>>>>>>>>>            
44673>>>>>>>>>>>>>            Procedure Restore_Defaults
44675>>>>>>>>>>>>>                forward send Restore_Defaults
44677>>>>>>>>>>>>>                Set piFragmaLast     to (piStoredFragmaLast(self))
44678>>>>>>>>>>>>>                Set psFragmaFromCode to (psStoredFragmaFromCode(self))
44679>>>>>>>>>>>>>                Set psFragmaToCode   to (psStoredFragmaToCode(self))
44680>>>>>>>>>>>>>            end_Procedure // Restore_Defaults
44681>>>>>>>>>>>>>            
44681>>>>>>>>>>>>>            Procedure Activating
44683>>>>>>>>>>>>>                Forward Send Activating
44685>>>>>>>>>>>>>                Send Rebuild_Constraints to (Gplan_DD(self))
44686>>>>>>>>>>>>>            End_Procedure // Activating
44687>>>>>>>>>>>>>            
44687>>>>>>>>>>>>>            
44687>>>>>>>>>>>>>            
44687>>>>>>>>>>>>>            
44687>>>>>>>>>>>>>            //AB-StoreEnd
44687>>>>>>>>>>>>>
44687>>>>>>>>>>>>>        End_Object    // oSelList
44688>>>>>>>>>>>>>
44688>>>>>>>>>>>>>        Object oOK_bn is a Button
44690>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
44691>>>>>>>>>>>>>            Set Location to 170 226
44692>>>>>>>>>>>>>
44692>>>>>>>>>>>>>            //AB-StoreStart
44692>>>>>>>>>>>>>            Procedure OnClick
44694>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
44695>>>>>>>>>>>>>            End_Procedure
44696>>>>>>>>>>>>>            //AB-StoreEnd
44696>>>>>>>>>>>>>
44696>>>>>>>>>>>>>        End_Object    // oOK_bn
44697>>>>>>>>>>>>>
44697>>>>>>>>>>>>>        Object oCancel_bn is a Button
44699>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
44700>>>>>>>>>>>>>            Set Location to 170 279
44701>>>>>>>>>>>>>
44701>>>>>>>>>>>>>            //AB-StoreStart
44701>>>>>>>>>>>>>            Procedure OnClick
44703>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
44704>>>>>>>>>>>>>            End_Procedure
44705>>>>>>>>>>>>>            //AB-StoreEnd
44705>>>>>>>>>>>>>
44705>>>>>>>>>>>>>        End_Object    // oCancel_bn
44706>>>>>>>>>>>>>
44706>>>>>>>>>>>>>        Object oSearch_bn is a Button
44708>>>>>>>>>>>>>            Set Label to "&€¤˜ã«ž©ž..."
44709>>>>>>>>>>>>>            Set Location to 170 334
44710>>>>>>>>>>>>>
44710>>>>>>>>>>>>>            //AB-StoreStart
44710>>>>>>>>>>>>>            Procedure OnClick
44712>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
44713>>>>>>>>>>>>>            End_Procedure
44714>>>>>>>>>>>>>            //AB-StoreEnd
44714>>>>>>>>>>>>>
44714>>>>>>>>>>>>>        End_Object    // oSearch_bn
44715>>>>>>>>>>>>>
44715>>>>>>>>>>>>>
44715>>>>>>>>>>>>>        //AB-StoreStart
44715>>>>>>>>>>>>>                
44715>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
44716>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
44717>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
44718>>>>>>>>>>>>>        
44718>>>>>>>>>>>>>        
44718>>>>>>>>>>>>>        
44718>>>>>>>>>>>>>        //AB-StoreEnd
44718>>>>>>>>>>>>>
44718>>>>>>>>>>>>>    CD_End_Object    // sl150
44720>>>>>>>>>>>>>>
44720>>>>>>>>>>>>>
44720>>>>>>>>>>>>>//AB/     End_Object    // prj
44720>>>>>>>>>>>
44720>>>>>>>>>>>//DDB-Selection-pkg-End
44720>>>>>>>>>>>//DDB-FileEnd
44720>>>>>>>>>Use ITEM.DD
44720>>>>>>>>>
44720>>>>>>>>>//AB-IgnoreEnd
44720>>>>>>>>>
44720>>>>>>>>>CD_Popup_Object SL22s is a dbModalPanel
44739>>>>>>>>>
44739>>>>>>>>>    //AB-StoreTopStart
44739>>>>>>>>>    Property String     pscode                  ''
44741>>>>>>>>>    Property String     psperi                  ''
44743>>>>>>>>>    Property Integer    piContains_Or_Starts     0
44745>>>>>>>>>    Property String     pscodekat               ''
44747>>>>>>>>>    
44747>>>>>>>>>    //AB-StoreTopEnd
44747>>>>>>>>>
44747>>>>>>>>>    Set Minimize_Icon to FALSE
44748>>>>>>>>>    Set Label to "€¨®œå¦ „ ›é¤"
44749>>>>>>>>>    Set Size to 270 484
44750>>>>>>>>>    Set Location to 5 7
44751>>>>>>>>>
44751>>>>>>>>>    //AB-DDOStart
44751>>>>>>>>>
44751>>>>>>>>>    Object Witemkat_DD is a Witemkat_DataDictionary
44753>>>>>>>>>    End_Object    // Witemkat_DD
44754>>>>>>>>>
44754>>>>>>>>>    Object Units_DD is a Units_DataDictionary
44756>>>>>>>>>    End_Object    // Units_DD
44757>>>>>>>>>
44757>>>>>>>>>    Object Fpa_DD is a Fpa_DataDictionary
44759>>>>>>>>>    End_Object    // Fpa_DD
44760>>>>>>>>>
44760>>>>>>>>>    Object Item_DD is a Item_DataDictionary
44762>>>>>>>>>
44762>>>>>>>>>        //AB-StoreTopStart
44762>>>>>>>>>        Function fiPeriexei Returns Integer
44764>>>>>>>>>                   String lsperi lscode  lscodekat
44765>>>>>>>>>                   Integer rVal liContains_Or_Starts
44765>>>>>>>>>                   Move 0 to rVal
44766>>>>>>>>>                   Get piContains_Or_Starts to liContains_Or_Starts
44767>>>>>>>>>                   Get psperi to lsperi
44768>>>>>>>>>                   Get pscode to lscode
44769>>>>>>>>>                   Get pscodekat to lscodekat
44770>>>>>>>>>                   Move (Trim(lsperi)) to lsperi
44771>>>>>>>>>                   Move (Trim(lscode)) to lscode
44772>>>>>>>>>              //     Move (Trim(lscodekat)) to lscodekat
44772>>>>>>>>>                   If (liContains_Or_Starts=0) Begin
44774>>>>>>>>>                       If ((Trim(item.item_descr)) Contains lsperi) Begin
44776>>>>>>>>>                           If ((Trim(item.item_code)) Contains lscode) Move 1 to rVal
44779>>>>>>>>>                       End
44779>>>>>>>>>>
44779>>>>>>>>>        
44779>>>>>>>>>                   End
44779>>>>>>>>>>
44779>>>>>>>>>                   Else Begin
44780>>>>>>>>>                       If (Left(item.item_descr,(Length(lsperi)))=lsperi) Begin
44782>>>>>>>>>                           If (Left(item.item_code,(Length(lscode)))=lscode) Move 1 to rVal
44785>>>>>>>>>                       End
44785>>>>>>>>>>
44785>>>>>>>>>        
44785>>>>>>>>>                   End
44785>>>>>>>>>>
44785>>>>>>>>>                   Function_Return rVal
44786>>>>>>>>>               End_Function
44787>>>>>>>>>        
44787>>>>>>>>>               Function fiArxizeiperi Returns Integer
44789>>>>>>>>>                   String lsperi
44790>>>>>>>>>                   Get psperi to lsperi
44791>>>>>>>>>                   Move (Trim(lsperi)) to lsperi
44792>>>>>>>>>                   Function_Return (Left(item.item_descr,(Length(lsperi)))=lsperi)
44793>>>>>>>>>               End_Function
44794>>>>>>>>>        
44794>>>>>>>>>               Function fiArxizeicode Returns Integer
44796>>>>>>>>>                   String lscode lscodekat
44797>>>>>>>>>                   Get pscode to lscode
44798>>>>>>>>>                   Move (Trim(lscode)) to lscode
44799>>>>>>>>>                   Function_Return (Left(item.item_code,(Length(lscode)))=lscode)
44800>>>>>>>>>               End_Function
44801>>>>>>>>>        
44801>>>>>>>>>        //AB-StoreTopEnd
44801>>>>>>>>>
44801>>>>>>>>>        Set DDO_Server to (Units_DD(self))
44802>>>>>>>>>        Set DDO_Server to (Witemkat_DD(self))
44803>>>>>>>>>        Set DDO_Server to (Fpa_DD(self))
44804>>>>>>>>>
44804>>>>>>>>>        //AB-StoreStart
44804>>>>>>>>>        
44804>>>>>>>>>        
44804>>>>>>>>>        
44804>>>>>>>>>        Begin_Constraints
44806>>>>>>>>>           String lsperi lscode lsvalue lstype lscodekat
44807>>>>>>>>>           Integer liContains_Or_Starts
44807>>>>>>>>>         //  Get FragmaItem  to lsValue
44807>>>>>>>>>        
44807>>>>>>>>>               Get psperi  to lsperi
44808>>>>>>>>>               Get pscode  to lscode
44809>>>>>>>>>               Get pscodekat  to lscodekat
44810>>>>>>>>>               Get piContains_Or_Starts to liContains_Or_Starts
44811>>>>>>>>>               Move (Trim(lsperi)) to lsperi
44812>>>>>>>>>               Move (Trim(lscode)) to lscode
44813>>>>>>>>>               Move (Trim(lscodekat)) to lscodekat
44814>>>>>>>>>               If ((lsperi<>'') and (lscode<>'')) begin
44816>>>>>>>>>                    set ordering to 5
44817>>>>>>>>>                    Constrain item as (fiPeriexei(Self)=1)
44818>>>>>>>>>               end
44818>>>>>>>>>>
44818>>>>>>>>>               Else Begin
44819>>>>>>>>>                  If (liContains_Or_Starts=0) Begin
44821>>>>>>>>>                    If (lsperi<>'') begin
44823>>>>>>>>>                        set ordering to 3
44824>>>>>>>>>                        Constrain item.item_descr Contains lsperi
44826>>>>>>>>>                    end
44826>>>>>>>>>>
44826>>>>>>>>>                    Else If (lscode<>'') begin
44829>>>>>>>>>                        set ordering to 5
44830>>>>>>>>>                        Constrain item.item_code Contains lscode
44832>>>>>>>>>                    end
44832>>>>>>>>>>
44832>>>>>>>>>                  End
44832>>>>>>>>>>
44832>>>>>>>>>                  Else Begin
44833>>>>>>>>>                       If (lsperi<>'') begin
44835>>>>>>>>>                            set ordering to 3
44836>>>>>>>>>                            Constrain item as (fiArxizeiperi(Self)=1) //item.item_descr
44837>>>>>>>>>                       end
44837>>>>>>>>>>
44837>>>>>>>>>                       Else If (lscode<>'') begin
44840>>>>>>>>>                            set ordering to 5
44841>>>>>>>>>                            Constrain item as (fiArxizeicode(Self)=1) //item.item_code
44842>>>>>>>>>                       end
44842>>>>>>>>>>
44842>>>>>>>>>                  End
44842>>>>>>>>>>
44842>>>>>>>>>               End
44842>>>>>>>>>>
44842>>>>>>>>>               If (lscodekat<>'') Constrain item.witemkat_code Contains lscodekat
44846>>>>>>>>>               Constrain item.item_orio eq 0
44848>>>>>>>>>        End_Constraints
44851>>>>>>>>>        
44851>>>>>>>>>        
44851>>>>>>>>>        
44851>>>>>>>>>        
44851>>>>>>>>>        
44851>>>>>>>>>        //AB-StoreEnd
44851>>>>>>>>>
44851>>>>>>>>>    End_Object    // Item_DD
44852>>>>>>>>>
44852>>>>>>>>>    Set Main_DD to (Item_DD(self))
44853>>>>>>>>>    Set Server to (Item_DD(self))
44854>>>>>>>>>
44854>>>>>>>>>    //AB-DDOEnd
44854>>>>>>>>>
44854>>>>>>>>>    Object oSelList is a dbListSub
44856>>>>>>>>>        Set Main_File to Item.File_Number
44857>>>>>>>>>        Set Ordering to 5
44858>>>>>>>>>        Set Size to 190 475
44859>>>>>>>>>        Set Location to -1 2
44860>>>>>>>>>        Set Color to 14280447
44861>>>>>>>>>        Set CurrentRowColor to 11783679
44862>>>>>>>>>        Set CurrentCellColor to 11783679
44863>>>>>>>>>        Set Auto_Index_State to FALSE
44864>>>>>>>>>
44864>>>>>>>>>        Begin_Row
44867>>>>>>>>>            Entry_Item Item.Item_code
44868>>>>>>>>>            Entry_Item Item.Item_descr
44869>>>>>>>>>            Entry_Item Item.Witemkat_code
44870>>>>>>>>>            Entry_Item Witemkat.Witemkat_descr
44871>>>>>>>>>            Entry_Item Item.Item_qual
44872>>>>>>>>>            Entry_Item Fpa.Fpa_pososto
44873>>>>>>>>>        End_Row
44878>>>>>>>>>
44878>>>>>>>>>        Set Form_Width    item 0 to 60
44879>>>>>>>>>        Set Header_Label  item 0 to "‰à›. „å›¦¬ª"
44880>>>>>>>>>        
44880>>>>>>>>>        Set Form_Width    item 1 to 140
44881>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
44882>>>>>>>>>        
44882>>>>>>>>>        Set Form_Width    item 2 to 70
44883>>>>>>>>>        Set Header_Label  item 2 to "‰à›. ‰˜«žš¦¨å˜ª"
44884>>>>>>>>>        
44884>>>>>>>>>        Set Form_Width    item 3 to 88
44885>>>>>>>>>        Set Header_Label  item 3 to "œ¨ š¨˜­ã ‰˜«žš."
44886>>>>>>>>>        
44886>>>>>>>>>        Set Form_Width    item 4 to 64
44887>>>>>>>>>        Set Header_Label  item 4 to "¦ æ«ž«˜"
44888>>>>>>>>>        
44888>>>>>>>>>        Set Form_Width    item 5 to 45
44889>>>>>>>>>        Set Header_Label  item 5 to "‰˜«.”..€"
44890>>>>>>>>>        
44890>>>>>>>>>
44890>>>>>>>>>        //AB-StoreStart
44890>>>>>>>>>                    
44890>>>>>>>>>        Property String Store_Fragma_Items public ""
44892>>>>>>>>>        
44892>>>>>>>>>        set export_item_state to true
44893>>>>>>>>>        
44893>>>>>>>>>        Procedure Activating
44895>>>>>>>>>           Forward send Activating
44897>>>>>>>>>           Send Rebuild_Constraints to (Item_DD(Self))
44898>>>>>>>>>        End_Procedure
44899>>>>>>>>>        
44899>>>>>>>>>        Function Child_Exiting Integer iWhere Returns Integer
44901>>>>>>>>>            local integer Rval
44902>>>>>>>>>            Forward get Child_Exiting iWhere  to Rval
44904>>>>>>>>>            set value of (ocode   (self))   to ''
44905>>>>>>>>>            set value of (operi   (self))   to ''
44906>>>>>>>>>            set value of (ocodekat(self))   to ''
44907>>>>>>>>>            set psperi                      to ''
44908>>>>>>>>>            set pscode                      to ''
44909>>>>>>>>>            set pscodekat                   to ''
44910>>>>>>>>>            function_return Rval // if non-zero do not enter
44911>>>>>>>>>        End_function
44912>>>>>>>>>        
44912>>>>>>>>>        
44912>>>>>>>>>        
44912>>>>>>>>>        
44912>>>>>>>>>        
44912>>>>>>>>>        
44912>>>>>>>>>        
44912>>>>>>>>>        
44912>>>>>>>>>        
44912>>>>>>>>>        
44912>>>>>>>>>        
44912>>>>>>>>>        
44912>>>>>>>>>        
44912>>>>>>>>>        
44912>>>>>>>>>        
44912>>>>>>>>>        
44912>>>>>>>>>        
44912>>>>>>>>>        
44912>>>>>>>>>        
44912>>>>>>>>>        
44912>>>>>>>>>        //AB-StoreEnd
44912>>>>>>>>>
44912>>>>>>>>>    End_Object    // oSelList
44913>>>>>>>>>
44913>>>>>>>>>    Object TextBoxSub1 is a TextBoxSub
44915>>>>>>>>>        Set Label to "‘á¨à©ž ‰à› ¡¦ç ‚ á"
44916>>>>>>>>>        Set Auto_Size_State to FALSE
44917>>>>>>>>>        Set Location to 192 6
44918>>>>>>>>>        Set Size to 13 78
44919>>>>>>>>>        Set TypeFace to "MS Sans Serif"
44920>>>>>>>>>    End_Object    // TextBoxSub1
44921>>>>>>>>>
44921>>>>>>>>>    Object ocode is a FormSub
44923>>>>>>>>>        Set Size to 13 197
44924>>>>>>>>>        Set Location to 192 79
44925>>>>>>>>>        Set Label_Col_Offset to 2
44926>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
44927>>>>>>>>>
44927>>>>>>>>>        //AB-StoreStart
44927>>>>>>>>>                                                        
44927>>>>>>>>>        Procedure OnKILLFOCUS
44929>>>>>>>>>            Send KeyAction to ButtonSub1
44930>>>>>>>>>        End_Procedure
44931>>>>>>>>>        
44931>>>>>>>>>        
44931>>>>>>>>>        
44931>>>>>>>>>        
44931>>>>>>>>>        //AB-StoreEnd
44931>>>>>>>>>
44931>>>>>>>>>    End_Object    // ocode
44932>>>>>>>>>
44932>>>>>>>>>    Object TextBoxSub2 is a TextBoxSub
44934>>>>>>>>>        Set Label to "‘á¨à©ž œ¨ š¨˜­ãª "
44935>>>>>>>>>        Set Auto_Size_State to FALSE
44936>>>>>>>>>        Set Location to 207 6
44937>>>>>>>>>        Set Size to 13 83
44938>>>>>>>>>        Set TypeFace to "MS Sans Serif"
44939>>>>>>>>>    End_Object    // TextBoxSub2
44940>>>>>>>>>
44940>>>>>>>>>    Object operi is a FormSub
44942>>>>>>>>>        Set Size to 13 197
44943>>>>>>>>>        Set Location to 207 79
44944>>>>>>>>>        Set Label_Col_Offset to 2
44945>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
44946>>>>>>>>>
44946>>>>>>>>>        //AB-StoreStart
44946>>>>>>>>>                                                        
44946>>>>>>>>>        Procedure OnKILLFOCUS
44948>>>>>>>>>            Send KeyAction to ButtonSub1
44949>>>>>>>>>        End_Procedure
44950>>>>>>>>>        
44950>>>>>>>>>        
44950>>>>>>>>>        
44950>>>>>>>>>        
44950>>>>>>>>>        //AB-StoreEnd
44950>>>>>>>>>
44950>>>>>>>>>    End_Object    // operi
44951>>>>>>>>>
44951>>>>>>>>>    Object RadioGroupSub1 is a RadioGroupSub
44953>>>>>>>>>        Set Size to 32 77
44954>>>>>>>>>        Set Location to 193 277
44955>>>>>>>>>        Object Radio1 is a RadioSub
44957>>>>>>>>>            Set Label to "œ¨ â®œ«˜ "
44958>>>>>>>>>            Set Size to 10 53
44959>>>>>>>>>            Set Location to 7 5
44960>>>>>>>>>        End_Object    // Radio1
44961>>>>>>>>>
44961>>>>>>>>>        Object Radio2 is a RadioSub
44963>>>>>>>>>            Set Label to "€¨®åœ  €§æ"
44964>>>>>>>>>            Set Size to 10 51
44965>>>>>>>>>            Set Location to 21 5
44966>>>>>>>>>        End_Object    // Radio2
44967>>>>>>>>>
44967>>>>>>>>>
44967>>>>>>>>>        //AB-StoreStart
44967>>>>>>>>>                                                        
44967>>>>>>>>>        Procedure Notify_Select_State integer iToItem integer iFromItem
44969>>>>>>>>>            Set piContains_Or_Starts to iToItem
44970>>>>>>>>>            Send KeyAction to ButtonSub1
44971>>>>>>>>>        End_Procedure
44972>>>>>>>>>        
44972>>>>>>>>>        
44972>>>>>>>>>        
44972>>>>>>>>>        
44972>>>>>>>>>        //AB-StoreEnd
44972>>>>>>>>>
44972>>>>>>>>>    End_Object    // RadioGroupSub1
44973>>>>>>>>>
44973>>>>>>>>>    Object ButtonSub1 is a ButtonSub
44975>>>>>>>>>        Set Label to "Search"
44976>>>>>>>>>        Set Size to 28 37
44977>>>>>>>>>        Set Location to 198 357
44978>>>>>>>>>        Set Form_FontWeight Item 0 to 800
44979>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
44980>>>>>>>>>
44980>>>>>>>>>        //AB-StoreStart
44980>>>>>>>>>                                                                                                        
44980>>>>>>>>>        Set Visible_State to False
44981>>>>>>>>>        
44981>>>>>>>>>        Procedure OnClick
44983>>>>>>>>>            Forward Send OnClick
44985>>>>>>>>>            Set pscode  to (Value(ocode(Self),0))
44986>>>>>>>>>            Set psperi  to (Value(operi(Self),0))
44987>>>>>>>>>            Set pscodekat  to (Value(ocodekat(Self),0))
44988>>>>>>>>>            send Rebuild_Constraints    to (item_DD(Self))
44989>>>>>>>>>            Send Beginning_Of_Data      to oSelList True
44990>>>>>>>>>        End_Procedure // OnClick
44991>>>>>>>>>        
44991>>>>>>>>>        
44991>>>>>>>>>        
44991>>>>>>>>>        
44991>>>>>>>>>        
44991>>>>>>>>>        
44991>>>>>>>>>        
44991>>>>>>>>>        
44991>>>>>>>>>        
44991>>>>>>>>>        
44991>>>>>>>>>        
44991>>>>>>>>>        
44991>>>>>>>>>        
44991>>>>>>>>>        //AB-StoreEnd
44991>>>>>>>>>
44991>>>>>>>>>    End_Object    // ButtonSub1
44992>>>>>>>>>
44992>>>>>>>>>    Object TextBoxSub3 is a TextBoxSub
44994>>>>>>>>>        Set Label to "‰à›.‰˜«žš¦¨å˜ª ‚ á"
44995>>>>>>>>>        Set Auto_Size_State to FALSE
44996>>>>>>>>>        Set Location to 221 5
44997>>>>>>>>>        Set Size to 13 78
44998>>>>>>>>>        Set TypeFace to "MS Sans Serif"
44999>>>>>>>>>    End_Object    // TextBoxSub3
45000>>>>>>>>>
45000>>>>>>>>>    Object ocodekat is a FormSub
45002>>>>>>>>>        Set Size to 13 197
45003>>>>>>>>>        Set Location to 221 78
45004>>>>>>>>>        Set Label_Col_Offset to 2
45005>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45006>>>>>>>>>
45006>>>>>>>>>        //AB-StoreStart
45006>>>>>>>>>                                                        
45006>>>>>>>>>        Procedure OnKILLFOCUS
45008>>>>>>>>>           Send KeyAction to ButtonSub1
45009>>>>>>>>>        End_Procedure
45010>>>>>>>>>        
45010>>>>>>>>>        
45010>>>>>>>>>        
45010>>>>>>>>>        //AB-StoreEnd
45010>>>>>>>>>
45010>>>>>>>>>    End_Object    // ocodekat
45011>>>>>>>>>
45011>>>>>>>>>    Object oOK_bn is a ButtonSub
45013>>>>>>>>>        Set Label to "&„§ ¢¦šã"
45014>>>>>>>>>        Set Location to 237 316
45015>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45016>>>>>>>>>
45016>>>>>>>>>        //AB-StoreStart
45016>>>>>>>>>        Procedure OnClick
45018>>>>>>>>>            Send OK To (oSelList(current_object))
45019>>>>>>>>>        End_Procedure
45020>>>>>>>>>        //AB-StoreEnd
45020>>>>>>>>>
45020>>>>>>>>>    End_Object    // oOK_bn
45021>>>>>>>>>
45021>>>>>>>>>    Object oCancel_bn is a ButtonSub
45023>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
45024>>>>>>>>>        Set Location to 237 371
45025>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45026>>>>>>>>>
45026>>>>>>>>>        //AB-StoreStart
45026>>>>>>>>>        Procedure OnClick
45028>>>>>>>>>            Send Cancel To (oSelList(current_object))
45029>>>>>>>>>        End_Procedure
45030>>>>>>>>>        //AB-StoreEnd
45030>>>>>>>>>
45030>>>>>>>>>    End_Object    // oCancel_bn
45031>>>>>>>>>
45031>>>>>>>>>    Object oSearch_bn is a ButtonSub
45033>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
45034>>>>>>>>>        Set Location to 237 426
45035>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45036>>>>>>>>>
45036>>>>>>>>>        //AB-StoreStart
45036>>>>>>>>>        Procedure OnClick
45038>>>>>>>>>            Send Search To (oSelList(current_object))
45039>>>>>>>>>        End_Procedure
45040>>>>>>>>>        //AB-StoreEnd
45040>>>>>>>>>
45040>>>>>>>>>    End_Object    // oSearch_bn
45041>>>>>>>>>
45041>>>>>>>>>
45041>>>>>>>>>    //AB-StoreStart
45041>>>>>>>>>                    
45041>>>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
45042>>>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
45043>>>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
45044>>>>>>>>>    
45044>>>>>>>>>    Set Locate_Mode to Center_On_Screen
45045>>>>>>>>>    
45045>>>>>>>>>    
45045>>>>>>>>>    
45045>>>>>>>>>    
45045>>>>>>>>>    
45045>>>>>>>>>    
45045>>>>>>>>>    
45045>>>>>>>>>    
45045>>>>>>>>>    
45045>>>>>>>>>    
45045>>>>>>>>>    
45045>>>>>>>>>    
45045>>>>>>>>>    //AB-StoreEnd
45045>>>>>>>>>
45045>>>>>>>>>CD_End_Object    // SL22s
45047>>>>>>>>>>
45047>>>>>>>>>
45047>>>>>>>>>
45047>>>>>>>>>//AB-StoreStart
45047>>>>>>>>>                                
45047>>>>>>>>>                                
45047>>>>>>>>>                                
45047>>>>>>>>>                                
45047>>>>>>>>>                                
45047>>>>>>>>>                                
45047>>>>>>>>>                                
45047>>>>>>>>>                                
45047>>>>>>>>>                                
45047>>>>>>>>>                                
45047>>>>>>>>>//AB-StoreEnd
45047>>>>>>>>>
45047>>>>>>>>>//AB/ End_Object    // prj
45047>>>>>>>Use sl022.SL         // sl022
45047>>>>>>>
45047>>>>>>>//DDB-Selection-pkg-End
45047>>>>>>>//DDB-FileEnd
45047>>>>>    
45047>>>>>    //AB-IgnoreEnd
45047>>>>>
45047>>>>>    Object sl026 is a dbModalPanelSub
45049>>>>>        set label to "€¨®œå¦ „ ›é¤" 
45050>>>>>        Set Size to 148 297
45051>>>>>        Set Location to 2 15
45052>>>>>        Set Exit_Application_Local_State to FALSE
45053>>>>>        Set Modal_State to FALSE
45054>>>>>
45054>>>>>        //AB-DDOStart
45054>>>>>
45054>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
45056>>>>>        End_Object    // Witemkat_DD
45057>>>>>
45057>>>>>        Object Units_DD is a Units_DataDictionary
45059>>>>>        End_Object    // Units_DD
45060>>>>>
45060>>>>>        Object Item_DD is a Item_DataDictionary
45062>>>>>            Set DDO_Server to (Units_DD(self))
45063>>>>>            Set DDO_Server to (Witemkat_DD(self))
45064>>>>>        End_Object    // Item_DD
45065>>>>>
45065>>>>>        Set Main_DD to (Item_DD(self))
45066>>>>>        Set Server to (Item_DD(self))
45067>>>>>
45067>>>>>        //AB-DDOEnd
45067>>>>>
45067>>>>>        Object oSelList is a dbListSub
45069>>>>>            Set Main_File to Item.File_Number
45070>>>>>            Set Server to (Units_DD(self))
45071>>>>>            Set Size to 105 280
45072>>>>>            Set Location to 6 6
45073>>>>>
45073>>>>>            Begin_Row
45076>>>>>                Entry_Item Item.Item_code
45077>>>>>                Entry_Item Item.Item_descr
45078>>>>>                Entry_Item Item.Witemkat_code
45079>>>>>                entry_item units.units_descr 
45080>>>>>            End_Row
45085>>>>>
45085>>>>>            Set Form_Width    item 0 to 60
45086>>>>>            set header_label  item 0 to "„ ›¦ª" 
45087>>>>>            
45087>>>>>            Set Form_Width    item 1 to 89
45088>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
45089>>>>>            
45089>>>>>            Set Form_Width    item 2 to 44
45090>>>>>            set header_label  item 2 to "‰˜«žš¦¨å˜   :" 
45091>>>>>            
45091>>>>>            Set Form_Width    item 3 to 79
45092>>>>>            set header_label  item 3 to "‹¦¤.‹â«¨ž©žª" 
45093>>>>>            
45093>>>>>        End_Object    // oSelList
45094>>>>>
45094>>>>>        Object oOK_bn is a ButtonSub
45096>>>>>            set label to "&„§ ¢¦šã" 
45097>>>>>            Set Location to 115 126
45098>>>>>
45098>>>>>            //AB-StoreStart
45098>>>>>            Procedure OnClick
45100>>>>>                Send OK To (oSelList(current_object))
45101>>>>>            End_Procedure
45102>>>>>            //AB-StoreEnd
45102>>>>>
45102>>>>>        End_Object    // oOK_bn
45103>>>>>
45103>>>>>        Object oCancel_bn is a ButtonSub
45105>>>>>            set label to "&€¡ç¨à©ž" 
45106>>>>>            Set Location to 115 181
45107>>>>>
45107>>>>>            //AB-StoreStart
45107>>>>>            Procedure OnClick
45109>>>>>                Send Cancel To (oSelList(current_object))
45110>>>>>            End_Procedure
45111>>>>>            //AB-StoreEnd
45111>>>>>
45111>>>>>        End_Object    // oCancel_bn
45112>>>>>
45112>>>>>        Object oSearch_bn is a ButtonSub
45114>>>>>            set label to "€&¤˜ã«ž©ž" 
45115>>>>>            Set Location to 115 236
45116>>>>>
45116>>>>>            //AB-StoreStart
45116>>>>>            Procedure OnClick
45118>>>>>                Send Search To (oSelList(current_object))
45119>>>>>            End_Procedure
45120>>>>>            //AB-StoreEnd
45120>>>>>
45120>>>>>        End_Object    // oSearch_bn
45121>>>>>
45121>>>>>
45121>>>>>        //AB-StoreStart
45121>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
45122>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
45123>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
45124>>>>>        //AB-StoreEnd
45124>>>>>
45124>>>>>    End_Object    // sl026
45125>>>>>
45125>>>>>//AB/     End_Object    // prj
45125>>>Use sl026a.sl
INCLUDING FILE: SL026A.SL
45125>>>>>//AB/ Project sl026a:item
45125>>>>>//AB/ Object prj is a Lookup_Project
45125>>>>>//AB/     Set ProjectName to "sl026a:item"
45125>>>>>//AB/     Set ProjectFileName to "sl026a.SL"
45125>>>>>//AB/     Set GenerateFileName to "NONAME"
45125>>>>>
45125>>>>>// Project Object Structure
45125>>>>>//   sl026a is a dbModalPanelSub
45125>>>>>//     Witemkat_DD is a DataDictionary
45125>>>>>//     Units_DD is a DataDictionary
45125>>>>>//     Fpa_DD is a DataDictionary
45125>>>>>//     Item_DD is a DataDictionary
45125>>>>>//     oSelList is a dbListSub
45125>>>>>//     oOK_bn is a ButtonSub
45125>>>>>//     oCancel_bn is a ButtonSub
45125>>>>>//     oSearch_bn is a ButtonSub
45125>>>>>
45125>>>>>// Register all objects
45125>>>>>Register_Object Fpa_DD
45125>>>>>Register_Object Item_DD
45125>>>>>Register_Object oCancel_bn
45125>>>>>Register_Object oOK_bn
45125>>>>>Register_Object oSearch_bn
45125>>>>>Register_Object oSelList
45125>>>>>Register_Object sl026a
45125>>>>>Register_Object Units_DD
45125>>>>>Register_Object Witemkat_DD
45125>>>>>
45125>>>>>
45125>>>>>//AB-IgnoreStart
45125>>>>>
45125>>>>>Use DFAllEnt.pkg
45125>>>>>Use dbList.Sub
45125>>>>>Use Button.Sub
45125>>>>>
45125>>>>>
45125>>>>>Use WITEMKAT.DD
45125>>>>>Use UNITS.DD
45125>>>>>Use FPA.DD
45125>>>>>Use ITEM.DD
45125>>>>>
45125>>>>>//AB-IgnoreEnd
45125>>>>>
45125>>>>>Object sl026a is a dbModalPanelSub
45127>>>>>    set label to "„å›ž" 
45128>>>>>    Set Size to 148 372
45129>>>>>    Set Location to 4 5
45130>>>>>    Set Exit_Application_Local_State to FALSE
45131>>>>>    Set Modal_State to FALSE
45132>>>>>
45132>>>>>    //AB-DDOStart
45132>>>>>
45132>>>>>    Object Witemkat_DD is a Witemkat_DataDictionary
45134>>>>>    End_Object    // Witemkat_DD
45135>>>>>
45135>>>>>    Object Units_DD is a Units_DataDictionary
45137>>>>>    End_Object    // Units_DD
45138>>>>>
45138>>>>>    Object Fpa_DD is a Fpa_DataDictionary
45140>>>>>    End_Object    // Fpa_DD
45141>>>>>
45141>>>>>    Object Item_DD is a Item_DataDictionary
45143>>>>>        Set DDO_Server to (Units_DD(self))
45144>>>>>        Set DDO_Server to (Witemkat_DD(self))
45145>>>>>        Set DDO_Server to (Fpa_DD(self))
45146>>>>>    End_Object    // Item_DD
45147>>>>>
45147>>>>>    Set Main_DD to (Item_DD(self))
45148>>>>>    Set Server to (Item_DD(self))
45149>>>>>
45149>>>>>    //AB-DDOEnd
45149>>>>>
45149>>>>>    Object oSelList is a dbListSub
45151>>>>>        Set Main_File to Item.File_Number
45152>>>>>        Set Size to 105 359
45153>>>>>        Set Location to 6 6
45154>>>>>
45154>>>>>        Begin_Row
45157>>>>>            Entry_Item Item.Item_code
45158>>>>>            Entry_Item Item.Item_descr
45159>>>>>            Entry_Item Fpa.Fpa_pososto
45160>>>>>            Entry_Item Item.Item_qual
45161>>>>>        End_Row
45166>>>>>
45166>>>>>        Set Form_Width    item 0 to 70
45167>>>>>        set header_label  item 0 to "‰à› ¡æª „ ›¦¬ª" 
45168>>>>>        
45168>>>>>        Set Form_Width    item 1 to 160
45169>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
45170>>>>>        
45170>>>>>        Set Form_Width    item 2 to 59
45171>>>>>        set header_label  item 2 to "% ”€" 
45172>>>>>        
45172>>>>>        Set Form_Width    item 3 to 62
45173>>>>>        set header_label  item 3 to "¦ æ«ž«˜" 
45174>>>>>        
45174>>>>>    End_Object    // oSelList
45175>>>>>
45175>>>>>    Object oOK_bn is a ButtonSub
45177>>>>>        set label to "&„§ ¢¦šã" 
45178>>>>>        Set Location to 114 207
45179>>>>>
45179>>>>>        //AB-StoreStart
45179>>>>>        Procedure OnClick
45181>>>>>            Send OK To (oSelList(current_object))
45182>>>>>        End_Procedure
45183>>>>>        //AB-StoreEnd
45183>>>>>
45183>>>>>    End_Object    // oOK_bn
45184>>>>>
45184>>>>>    Object oCancel_bn is a ButtonSub
45186>>>>>        set label to "&€¡ç¨à©ž" 
45187>>>>>        Set Location to 114 261
45188>>>>>
45188>>>>>        //AB-StoreStart
45188>>>>>        Procedure OnClick
45190>>>>>            Send Cancel To (oSelList(current_object))
45191>>>>>        End_Procedure
45192>>>>>        //AB-StoreEnd
45192>>>>>
45192>>>>>    End_Object    // oCancel_bn
45193>>>>>
45193>>>>>    Object oSearch_bn is a ButtonSub
45195>>>>>        set label to "€&¤˜ã«ž©ž" 
45196>>>>>        Set Location to 114 317
45197>>>>>
45197>>>>>        //AB-StoreStart
45197>>>>>        Procedure OnClick
45199>>>>>            Send Search To (oSelList(current_object))
45200>>>>>        End_Procedure
45201>>>>>        //AB-StoreEnd
45201>>>>>
45201>>>>>    End_Object    // oSearch_bn
45202>>>>>
45202>>>>>
45202>>>>>    //AB-StoreStart
45202>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
45203>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
45204>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
45205>>>>>    //AB-StoreEnd
45205>>>>>
45205>>>>>End_Object    // sl026a
45206>>>>>
45206>>>>>//AB/ End_Object    // prj
45206>>>Use sl029.sl
INCLUDING FILE: SL029.SL
45206>>>>>//AB/ Project Wtypkin : sl029
45206>>>>>//AB/ Object prj is a Lookup_Project
45206>>>>>//AB/     Set ProjectName to "Wtypkin : sl029"
45206>>>>>//AB/     Set ProjectFileName to "sl029.SL"
45206>>>>>
45206>>>>>// Project Object Structure
45206>>>>>//   sl029 is a dbModalPanelSub
45206>>>>>//     Wtypkin_DD is a DataDictionary
45206>>>>>//     oSelList is a dbListSub
45206>>>>>//     oOK_bn is a ButtonSub
45206>>>>>//     oCancel_bn is a ButtonSub
45206>>>>>//     oSearch_bn is a ButtonSub
45206>>>>>
45206>>>>>// Register all objects
45206>>>>>Register_Object oCancel_bn
45206>>>>>Register_Object oOK_bn
45206>>>>>Register_Object oSearch_bn
45206>>>>>Register_Object oSelList
45206>>>>>Register_Object sl029
45206>>>>>Register_Object Wtypkin_DD
45206>>>>>
45206>>>>>
45206>>>>>//AB-IgnoreStart
45206>>>>>
45206>>>>>Use DFAllEnt.pkg
45206>>>>>Use dbList.Sub
45206>>>>>Use Button.Sub
45206>>>>>
45206>>>>>
45206>>>>>Use WTYPKIN.DD
45206>>>>>
45206>>>>>//AB-IgnoreEnd
45206>>>>>
45206>>>>>CD_Popup_Object sl029 is a dbModalPanelSub
45225>>>>>    set label to "‰ ¤ã©œ ª €§¦Ÿã¡žª" 
45226>>>>>    Set Size to 148 480
45227>>>>>    Set Location to 12 16
45228>>>>>    Set Exit_Application_Local_State to FALSE
45229>>>>>    Set Modal_State to FALSE
45230>>>>>
45230>>>>>    //AB-DDOStart
45230>>>>>
45230>>>>>    Object Wtypkin_DD is a Wtypkin_DataDictionary
45232>>>>>    End_Object    // Wtypkin_DD
45233>>>>>
45233>>>>>    Set Main_DD to (Wtypkin_DD(self))
45234>>>>>    Set Server to (Wtypkin_DD(self))
45235>>>>>
45235>>>>>    //AB-DDOEnd
45235>>>>>
45235>>>>>    Object oSelList is a dbListSub
45237>>>>>        Set Main_File to Wtypkin.File_Number
45238>>>>>        Set Size to 105 465
45239>>>>>        Set Location to 6 6
45240>>>>>
45240>>>>>        Begin_Row
45243>>>>>            Entry_Item Wtypkin.Wtypkin_code
45244>>>>>            Entry_Item Wtypkin.Wtypkin_descr
45245>>>>>            Entry_Item Wtypkin.Wtypkin_anti
45246>>>>>        End_Row
45251>>>>>
45251>>>>>        Set Form_Width    item 0 to 43
45252>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
45253>>>>>        
45253>>>>>        Set Form_Width    item 1 to 293
45254>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã ‰å¤ž©žª" 
45255>>>>>        
45255>>>>>        Set Form_Width    item 2 to 120
45256>>>>>        set header_label  item 2 to "„¤›œ ¥ž" 
45257>>>>>        
45257>>>>>    End_Object    // oSelList
45258>>>>>
45258>>>>>    Object oOK_bn is a ButtonSub
45260>>>>>        set label to "&„§ ¢¦šã" 
45261>>>>>        Set Location to 114 312
45262>>>>>
45262>>>>>        //AB-StoreStart
45262>>>>>        Procedure OnClick
45264>>>>>            Send OK To (oSelList(current_object))
45265>>>>>        End_Procedure
45266>>>>>        //AB-StoreEnd
45266>>>>>
45266>>>>>    End_Object    // oOK_bn
45267>>>>>
45267>>>>>    Object oCancel_bn is a ButtonSub
45269>>>>>        set label to "&€¡ç¨à©ž" 
45270>>>>>        Set Location to 114 367
45271>>>>>
45271>>>>>        //AB-StoreStart
45271>>>>>        Procedure OnClick
45273>>>>>            Send Cancel To (oSelList(current_object))
45274>>>>>        End_Procedure
45275>>>>>        //AB-StoreEnd
45275>>>>>
45275>>>>>    End_Object    // oCancel_bn
45276>>>>>
45276>>>>>    Object oSearch_bn is a ButtonSub
45278>>>>>        set label to "€&¤˜ã«ž©ž" 
45279>>>>>        Set Location to 114 422
45280>>>>>
45280>>>>>        //AB-StoreStart
45280>>>>>        Procedure OnClick
45282>>>>>            Send Search To (oSelList(current_object))
45283>>>>>        End_Procedure
45284>>>>>        //AB-StoreEnd
45284>>>>>
45284>>>>>    End_Object    // oSearch_bn
45285>>>>>
45285>>>>>
45285>>>>>    //AB-StoreStart
45285>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
45286>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
45287>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
45288>>>>>    //AB-StoreEnd
45288>>>>>
45288>>>>>CD_End_Object    // sl029
45290>>>>>>
45290>>>>>
45290>>>>>//AB/ End_Object    // prj
45290>>>Use sl029a.sl
45290>>>Use sl031.sl
INCLUDING FILE: SL031.SL
45290>>>>>//AB/ Project SL031:BTYPKIN
45290>>>>>//AB/ Object prj is a Lookup_Project
45290>>>>>//AB/     Set ProjectName to "SL031:BTYPKIN"
45290>>>>>//AB/     Set ProjectFileName to "SL031.SL"
45290>>>>>
45290>>>>>// Project Object Structure
45290>>>>>//   SL031 is a dbModalPanelSub
45290>>>>>//     Btypkin_DD is a DataDictionary
45290>>>>>//     oSelList is a dbListSub
45290>>>>>//     oOK_bn is a ButtonSub
45290>>>>>//     oCancel_bn is a ButtonSub
45290>>>>>//     oSearch_bn is a ButtonSub
45290>>>>>
45290>>>>>// Register all objects
45290>>>>>Register_Object Btypkin_DD
45290>>>>>Register_Object oCancel_bn
45290>>>>>Register_Object oOK_bn
45290>>>>>Register_Object oSearch_bn
45290>>>>>Register_Object oSelList
45290>>>>>Register_Object SL031
45290>>>>>
45290>>>>>
45290>>>>>//AB-IgnoreStart
45290>>>>>
45290>>>>>Use DFAllEnt.pkg
45290>>>>>Use dbList.Sub
45290>>>>>Use Button.Sub
45290>>>>>
45290>>>>>
45290>>>>>Use BTYPKIN.DD
INCLUDING FILE: BTYPKIN.DD
45290>>>>>>>//DDB-FileStart
45290>>>>>>>//DDB-HeaderStart
45290>>>>>>>
45290>>>>>>>// File Name : BTYPKIN.DD
45290>>>>>>>// Class Name: Btypkin_DataDictionary
45290>>>>>>>// Revision  : 114
45290>>>>>>>// Version   : 2
45290>>>>>>>
45290>>>>>>>Use  Windows           // Basic Definitions
45290>>>>>>>Use  DataDict          // DataDictionary Class Definition
45290>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
45290>>>>>>>
45290>>>>>>>Open Btypkin
45292>>>>>>>Open Bflagkin
INCLUDING FILE: BFLAGKIN.FD
45294>>>>>>>Open Bkinkat
INCLUDING FILE: BKINKAT.FD
45296>>>>>>>Open Barticl
INCLUDING FILE: BARTICL.FD
45298>>>>>>>Open Sysrecb
INCLUDING FILE: SYSRECB.FD
45300>>>>>>>
45300>>>>>>>//DDB-HeaderEnd
45300>>>>>>>//DDB-ValidationStart
45300>>>>>>>
45300>>>>>>>//DDB/ ExternalValidationTable Bfile_VT  Baxio.pkg
45300>>>>>>>
45300>>>>>>>Register_Object Bfile_VT
45300>>>>>>>Register_Object Btypkin_Btypkin_Anti_Xp_VT
45300>>>>>>>Use Baxio.pkg        // Bfile_VT
INCLUDING FILE: BAXIO.PKG
45300>>>>>>>>>// **************************************************************************
45300>>>>>>>>>// *Code Style   : Object                                                   *
45300>>>>>>>>>// *Name         : Baxio.vts                                                *
45300>>>>>>>>>// *Revision     : 1                                                        *
45300>>>>>>>>>// *Main File    :                                                          *
45300>>>>>>>>>// *Location     : \Home.Win\Easyware\ED\Appsrc                             *
45300>>>>>>>>>// *Creation Date: 01/09/99                                                 *
45300>>>>>>>>>// *Last Update  :                                                          *
45300>>>>>>>>>// *Author       : JA                                                       *
45300>>>>>>>>>// *Includes     :                                                          *
45300>>>>>>>>>// *Comments     : œ¨ â®œ  æ¢˜ «˜ static validation tables «¦¬             *
45300>>>>>>>>>// *             : module «à¤ ˜¥ ¦š¨á­à¤.                                   *
45300>>>>>>>>>// *             :                                                          *
45300>>>>>>>>>// *             :                                                          *
45300>>>>>>>>>// *Returns      :                                                          *
45300>>>>>>>>>// *             :                                                          *
45300>>>>>>>>>// *‰nown bugs   :                                                          *
45300>>>>>>>>>// *             :                                                          *
45300>>>>>>>>>// *Improvements :                                                          *
45300>>>>>>>>>// *             :                                                          *
45300>>>>>>>>>// *             :                                                          *
45300>>>>>>>>>// **************************************************************************
45300>>>>>>>>>// *                        A N A L Y S I S                                 *
45300>>>>>>>>>// **************************************************************************
45300>>>>>>>>>// *                                                                        *
45300>>>>>>>>>// **************************************************************************
45300>>>>>>>>>
45300>>>>>>>>>
45300>>>>>>>>>//Set Allow_Blank_State To TRUE
45300>>>>>>>>>
45300>>>>>>>>>//used by: 1. baxiokat.baxiokat_type
45300>>>>>>>>>Object Baxiokat_Type_VT  is a DescriptionValidationTable
45302>>>>>>>>>       set table_title to "„å›¦ª €¥ ¦š¨á­¦¬"
45303>>>>>>>>>       Procedure Fill_List
45305>>>>>>>>>                 Forward Send Fill_List
45307>>>>>>>>>                 Send Add_Table_Value  "1"  "„ ©§¨˜¡«â¦"
45308>>>>>>>>>                 send add_table_value  "2"  "¢ž¨à«â¦"
45309>>>>>>>>>       End_Procedure //fill_list
45310>>>>>>>>>End_Object   //Baxiokat_Type_VT
45311>>>>>>>>>
45311>>>>>>>>>
45311>>>>>>>>>//¡˜«˜©«á©œ ª ˜¥ ¦š¨á­à¤
45311>>>>>>>>>//used by: 1. bkinkat.baxio_stat_from :¡˜«á©«˜©ž ˜§æ
45311>>>>>>>>>//         2. bkinkat.baxio_stat_to   :¡˜«á©«˜©ž ©â
45311>>>>>>>>>//         3. baxio.baxio_status      :¡˜«á©«˜©ž
45311>>>>>>>>>//â¤˜ ˜¥ æš¨˜­¦ œå¤˜  § Ÿ˜¤æ ¤˜ ™¨œŸœå ©« ª §˜¨˜¡á«à 3 ¡˜«˜©«á©œ ª:
45311>>>>>>>>>Object Baxio_Status_VT  is a DescriptionValidationTable
45313>>>>>>>>>       set table_title to "‰˜«˜©«á©œ ª €¥ ¦š¨á­à¤"
45314>>>>>>>>>       Procedure Fill_List
45316>>>>>>>>>                 Forward Send Fill_List
45318>>>>>>>>>                 Send Add_Table_Value  "1"  "„¡¡¨œ£âª"
45319>>>>>>>>>                 Send Add_Table_Value  "2"  "„¥¦­¢ž£â¤¦"
45320>>>>>>>>>                 Send Add_Table_Value  "3"  "ƒ ˜£˜¨«¬¨ž£â¤¦"
45321>>>>>>>>>                 Send Add_Table_Value  "4"  "’˜£œå¦"
45322>>>>>>>>>                 Send Add_Table_Value  "5"  "ƒœ©£œ¬£â¤¦"
45323>>>>>>>>>
45323>>>>>>>>>       End_Procedure // fill_list
45324>>>>>>>>>End_Object   //Baxio_Status_VT1
45325>>>>>>>>>
45325>>>>>>>>>
45325>>>>>>>>>
45325>>>>>>>>>//used by: 1. btypkin.btypkin_anti1
45325>>>>>>>>>//         2. btypkin.btypkin_anti2
45325>>>>>>>>>//         3. baxio.baxio_file_in
45325>>>>>>>>>//         4. baxio.baxio_file_out
45325>>>>>>>>>//         5. baxio.baxio_lfile
45325>>>>>>>>>Object Bfile_VT  is a DescriptionValidationTable
45327>>>>>>>>>       set table_title to "‘¬¤˜¢¢˜©æ£œ¤¦ª/˜¨˜¢ã§«žª ˜§æ"
45328>>>>>>>>>       Procedure Fill_List
45330>>>>>>>>>                 Forward Send Fill_List
45332>>>>>>>>>                 Send Add_Table_Value  "-1" "ƒœ¤ “§á¨®œ "
45333>>>>>>>>>                 Send Add_Table_Value  "0"  "Data Entry"
45334>>>>>>>>>                 Send Add_Table_Value  "1"  "Š¦š˜¨ ˜©£é¤ ‚Š"
45335>>>>>>>>>                 send add_table_value  "2"  "”¦¨â˜ª"
45336>>>>>>>>>                 Send Add_Table_Value  "3"  "¨¦£žŸœ¬«é¤"
45337>>>>>>>>>                 Send Add_Table_Value  "5"  "Ž ‘¬¤˜¢¢˜©æ£œ¤¦ª"
45338>>>>>>>>>                 Send Add_Table_Value  "6"  "’œ¢.˜¨˜¢ã§«žª"
45339>>>>>>>>>       End_Procedure // fill_list
45340>>>>>>>>>End_Object   // Btypkin_Btypkin_Anti_VT
45341>>>>>>>>>
45341>>>>>>>
45341>>>>>>>Object Btypkin_Btypkin_Anti_Xp_VT  is a DescriptionValidationTable
45343>>>>>>>
45343>>>>>>>    Procedure Fill_List
45345>>>>>>>        Forward Send Fill_List
45347>>>>>>>        Send Add_Table_Value  "1"  "•¨œé¤œ«˜ "
45348>>>>>>>        Send Add_Table_Value  "2"  " ©«é¤œ«˜ "
45349>>>>>>>    End_Procedure    // Fill_List
45350>>>>>>>    //DDB-ValidationCustomStart
45350>>>>>>>    //DDB-ValidationCustomEnd
45350>>>>>>>End_Object   // Btypkin_Btypkin_Anti_Xp_VT
45351>>>>>>>//DDB-ValidationEnd
45351>>>>>>>//DDB-SelectionStart
45351>>>>>>>//DDB/ ExternalSelectionList SL031  SL031.SL
45351>>>>>>>//DDB/ ExternalSelectionList sl007  sl007.SL
45351>>>>>>>//DDB/ ExternalSelectionList sl007r  sl007r.SL
45351>>>>>>>Register_Object SL031
45351>>>>>>>Register_Object sl007
45351>>>>>>>Register_Object sl007r
45351>>>>>>>//DDB-SelectionEnd
45351>>>>>>>
45351>>>>>>>// JSJSJSJS 24/01/2001 Register_Object SL056 //¢å©«˜ gplan
45351>>>>>>>//Register_Object SL056 //¢å©«˜ vendor
45351>>>>>>>
45351>>>>>>>
45351>>>>>>>Open SysCurXr
45353>>>>>>>
45353>>>>>>>Open Barticl //©œ«á¨œ  prompt objects
45355>>>>>>>// JSJSJSJS 24/01/2001 Open Gtypkin //™¨å©¡œ  rec0 ©«ž¤ update, externalyy updated, lock on save
45355>>>>>>>//Open Ctypkin //™¨å©¡œ  rec0 ©«ž¤ update, externalyy updated, lock on save
45355>>>>>>>//Open Vtypkin //™¨å©¡œ  rec0 ©«ž¤ update, externalyy updated, lock on save
45355>>>>>>>
45355>>>>>>>
45355>>>>>>>// JSJSJSJS 24/01/2001 Use SL056.SL //¢å©«˜ gplan
45355>>>>>>>//Use SL102.SL //¢å©«˜ customer
45355>>>>>>>//Use SL???.SL //¢å©«˜ vendor
45355>>>>>>>Use sl100.sl // Clients selection list
45355>>>>>>>
45355>>>>>>>//*********************************************************************************
45355>>>>>>>//*          A N A L Y S I S                                                      *
45355>>>>>>>//*********************************************************************************
45355>>>>>>>//† ¡áŸœ ¡å¤ž©ž ˜¥ ¦š¨á­à¤ ˜§¦«œ¢œå £å˜ ©¬¤˜¢¢˜šã.
45355>>>>>>>//„§¦£â¤àª ¦¨åœ«˜  £¦¤¦©ã£˜¤«˜ â¤˜ª ©¬¤˜¢¢˜©æ£œ¤¦ª
45355>>>>>>>
45355>>>>>>>//’é¨˜, ¦  › á­¦¨¦  «ç§¦  ©¬¤˜¢¢˜©¦£â¤à¤ §¦¬ ¬§¦©«ž¨åœ  «¦ ©ç©«ž£˜ ©ã£œ¨˜, œå¤˜ 
45355>>>>>>>//¦  œ¥ãª : 1  "Š¦š˜¨ ˜©£æª ‚Š : contsrained ¢å©«˜ gplan apo-eos Btypkin.Gplan_Code_Apo
45355>>>>>>>//                                                               Btypkin.Gplan_Code_Apo
45355>>>>>>>//                               ©«ž¤ §œ¨å§«à©ž ˜¬«ã, ¦ ¢¦š˜¨ ˜©£æª §¦¬ Ÿ˜ œ§ ¢œšœå
45355>>>>>>>//                               ©«¦ barticl, Ÿ˜ "­áœ " «ž¤ ®¨âà©ž/§å©«à©ž §¦¬ â®¦¬£œ
45355>>>>>>>//                               ›ž¢é©œ  ©«¦ §œ›å¦ Btypkin.Btypkin_Anti_Xp.
45355>>>>>>>//          2  "œ¢á«žª        : ¢å©«˜ customer
45355>>>>>>>//          3  "¨¦£žŸœ¬«ãª    : ¢å©«˜ vendor
45355>>>>>>>//          4  "Š¦ §¦å         : œá¤ «¦ modula ˜¥ ¦š¨á­à¤ §¦¬¢žŸœå ˜¬«æ¤¦£˜,
45355>>>>>>>//                               «æ«œ «¦¤ ©¬¤˜¢¢˜©æ£œ¤¦ ˜§¢éª «¦¤ §¢ž¡«¨¦¢¦š¦ç£œ.
45355>>>>>>>
45355>>>>>>>//† ©¬¤˜¢¢˜šã šå¤œ«˜  £œ ˜¥ æš¨˜­˜, á¨˜ §¨â§œ  ¤˜ š¤à¨å¦¬£œ œá¤ Ÿ˜ › ˜¡ ¤ã©¦¬£œ
45355>>>>>>>//£æ¤¦¤ 1 «ç§¦ ˜¥ ¦š¨á­à¤, ã §¦¢¢¦çª (§œ›å¦ Btypkin.Baxiokat_Code).
45355>>>>>>>//„á¤ ˜¬«æ œå¤˜  0, «æ«œ ©«¦ grid «¦¬ bmove ¦ user £˜ª ›ž¢é¤œ  baxiokat,
45355>>>>>>>//˜¢¢¦ éª «¦ §œ›å¦ œå¤˜  ¡¢œ ›à£â¤¦.
45355>>>>>>>
45355>>>>>>>Class Btypkin_DataDictionary  is a DataDictionary_Sec
45356>>>>>>>
45356>>>>>>>    Procedure Construct_Object
45357>>>>>>>              Forward Send Construct_Object
45359>>>>>>>
45359>>>>>>>              //object id «é¤ ddo servers š ˜ «á barticl+bmove+baxio+baxiokat
45359>>>>>>>              //©œ«á¨¦¤«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
45359>>>>>>>              //®¨ž© £œç¦¬¤ ©«ž¤ private.exit_btypkin_code
45359>>>>>>>              //š ˜ ¤˜ ©œ«á¨¦¬¤ «¦ visual interface
45359>>>>>>>              Property Integer piBarticl_dd  0
45360>>>>>>>              Property Integer piBmove_dd    0
45361>>>>>>>              Property Integer piBaxio_dd    0
45362>>>>>>>              Property Integer piBaxiokat_dd 0
45363>>>>>>>              Property Integer piMustNOTConstrain Public 0
45364>>>>>>>    End_Procedure   //construct_object
45365>>>>>>>
45365>>>>>>>//      //private
45365>>>>>>>//      //¡˜¢œå«˜  ˜§¦ «ž¤ private.Exit_Btypkin_Code
45365>>>>>>>//      Procedure private.Set_Prompt_Objects_of_all_Connected_DEOs Integer liPrompt_Object_id ;
45365>>>>>>>//                                                                 Integer liField            ;
45365>>>>>>>//                                                                 Integer iMustConstrain     ;
45365>>>>>>>//                                                                 String  sPelProm
45365>>>>>>>//                Integer iMax iCount iDEO liTemp liBarticl_dd iPelListID
45365>>>>>>>
45365>>>>>>>//                Move (sl100(Self)) to iPelListID
45365>>>>>>>//             //   den exei nohma giati den kanoyn tipota sthn lista
45365>>>>>>>//             //   If (iPelListID) Set piMustConstrain     Of iPelListID to 0
45365>>>>>>>//             //   If (iPelListID) Set psIsPromhtheyths    Of iPelListID to ''
45365>>>>>>>
45365>>>>>>>//                Get piBarticl_dd to liBarticl_dd
45365>>>>>>>//                If (liBarticl_dd <> 0);
45365>>>>>>>//                Begin //œá¤ æ¤«àª ¬§á¨®œ  client ddo £œ main file «¦ barticl
45365>>>>>>>//                     Get Data_Set_User_Interface_Count of liBarticl_dd to iMax
45365>>>>>>>//                     Decrement iMax
45365>>>>>>>//                     For iCount from 0 to iMax
45365>>>>>>>//                         Move (Data_Set_User_Interface(liBarticl_dd ,iCount)) to iDEO
45365>>>>>>>//                         Get Data_Field of iDEO Item 0 to liTemp
45365>>>>>>>//                         If (liTemp = liField);
45365>>>>>>>//                         Begin //œá¤ ™¨ž¡˜ deo (dfform?) §¦¬ ˜¤˜­â¨œ«˜  ©«¦ §œ›å¦ ©¬¤˜¢¢˜©æ£œ¤¦ª
45365>>>>>>>//                            If (liPrompt_Object_id <> 0);
45365>>>>>>>//                               Begin
45365>>>>>>>//                                  Set Prompt_Object      of iDEO to liPrompt_Object_id
45365>>>>>>>//                                  Set Prompt_Button_Mode of iDEO to PB_promptOn
45365>>>>>>>//                                  If (iMustConstrain) Begin
45365>>>>>>>//                                  //   den exei nohma giati den kanoyn tipota sthn lista
45365>>>>>>>//                                  //  If (liPrompt_Object_id) Set piMustConstrain     Of liPrompt_Object_id to iMustConstrain
45365>>>>>>>//                                  //  If (liPrompt_Object_id) Set psIsPromhtheyths    Of liPrompt_Object_id to sPelProm
45365>>>>>>>//                                  End
45365>>>>>>>//                            End
45365>>>>>>>//                            Else Begin
45365>>>>>>>//                                Set Prompt_Object      of iDEO to 0
45365>>>>>>>//                                Set Prompt_Button_Mode of iDEO to PB_promptOff
45365>>>>>>>//                            End
45365>>>>>>>//                         End
45365>>>>>>>//                     Loop
45365>>>>>>>//                End
45365>>>>>>>//      End_Procedure //private.set_prompt_objects_of_all_connected_dEOS
45365>>>>>>>
45365>>>>>>>
45365>>>>>>>//    //private
45365>>>>>>>//    //¡˜¢œå«˜  ˜§æ: iexit «¦¬ btypkin_code
45365>>>>>>>//    //¡˜¢œå    «ã¤: private.Set_Prompt_Objects_of_all_Connected_DEOS
45365>>>>>>>//    //©œ«á¨œ      : «á prompt objects š ˜ «¦ barticl_anti, ˜¤á¢¦š˜ £œ «¦ btypkin_anti.
45365>>>>>>>//    Procedure private.Exit_Btypkin_Code Integer liField Integer liBtypkin_Code
45365>>>>>>>//              Integer liBtypkin_Anti1 liBaxiokat_Num liBtypkin_Anti2
45365>>>>>>>//              Integer liBaxiokat_dd liBarticl_dd
45365>>>>>>>//              String lsBarticlCode1
45365>>>>>>>
45365>>>>>>>//            // btypkin_anti
45365>>>>>>>//            // "-1" "ƒâ¤ “§á¨®œ "
45365>>>>>>>//            // "0"  "Data Entry"
45365>>>>>>>//            // "1"  "Š¦š˜¨ ˜©£é¤ ‚Š"
45365>>>>>>>//            // "2"  "”¦¨â˜ª"
45365>>>>>>>//            // "3"  "¨¦£žŸœ¬«é¤"
45365>>>>>>>//            // "5"  "Ž ‘¬¤˜¢¢˜©æ£œ¤¦ª"
45365>>>>>>>//            // "6"  "’œ¢.˜¨˜¢ã§«žª"
45365>>>>>>>
45365>>>>>>>
45365>>>>>>>
45365>>>>>>>//              Get Field_Current_Value Field Btypkin.Btypkin_Anti1 to liBtypkin_Anti1
45365>>>>>>>//              Get Field_Current_Value Field Btypkin.Btypkin_Anti2 to liBtypkin_Anti2
45365>>>>>>>//              Case Begin
45365>>>>>>>//                   Case (liBtypkin_Anti1 = 1) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ š¢
45365>>>>>>>//                         Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0 Field Barticl.Barticl_Code1 0 ''
45365>>>>>>>//                   Case Break
45365>>>>>>>
45365>>>>>>>//                   Case (liBtypkin_Anti1 = 2) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §œ¢á«œª
45365>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code1 1 ''
45365>>>>>>>//                   Case Break
45365>>>>>>>
45365>>>>>>>//                   Case (liBtypkin_Anti1 = 3) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §¨¦£žŸœ¬«âª=> ¢ ©«˜ §œ¢˜«à¤
45365>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code1 1 '1'
45365>>>>>>>//                   Case Break
45365>>>>>>>
45365>>>>>>>//                   Case Else //=4 ¢¦ §¦å:©¬¤˜¢¢˜©æ£œ¤¦ª £œ user manual data entry
45365>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0  Field Barticl.Barticl_Code1 0 ''
45365>>>>>>>//                   Case Break
45365>>>>>>>//              Case End
45365>>>>>>>
45365>>>>>>>//              Case Begin
45365>>>>>>>//                   Case (liBtypkin_Anti2 = 1) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ š¢
45365>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0 Field Barticl.Barticl_Code2 0 ''
45365>>>>>>>//                   Case Break
45365>>>>>>>
45365>>>>>>>//                   Case (liBtypkin_Anti2 = 2) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §œ¢á«œª
45365>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code2 1 ''
45365>>>>>>>//                   Case Break
45365>>>>>>>
45365>>>>>>>//                   Case (liBtypkin_Anti2 = 3) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §¨¦£žŸœ¬«âª=> Š ©«˜ œ¢˜«é¤
45365>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code2 1 '1'
45365>>>>>>>//                   Case Break
45365>>>>>>>
45365>>>>>>>//                   Case Else //=4 ¢¦ §¦å:©¬¤˜¢¢˜©æ£œ¤¦ª £œ user manual data entry
45365>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0  Field Barticl.Barticl_Code2 0 ''
45365>>>>>>>//                   Case Break
45365>>>>>>>//              Case End
45365>>>>>>>//    End_Procedure //private.exit_btypkin_code
45365>>>>>>>
45365>>>>>>>//    // New_Current_Record:
45365>>>>>>>
45365>>>>>>>//    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
45365>>>>>>>//        Integer liBtypkinCodeFldNum
45365>>>>>>>//        Forward Send New_Current_Record  iOldRec iNewRec
45365>>>>>>>//        Get_FieldNumber Btypkin.Btypkin_Code to liBtypkinCodeFldNum
45365>>>>>>>//        Send private.Exit_Btypkin_Code liBtypkinCodeFldNum Btypkin.Btypkin_Code
45365>>>>>>>//        // Insert Code Here
45365>>>>>>>//    End_Procedure   // New_Current_Record
45365>>>>>>>
45365>>>>>>>
45365>>>>>>>    //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
45365>>>>>>>    //™) ˜¤áš¤à©ž properties
45365>>>>>>>    //š) › ˜®œå¨ ©ž calculated §œ›åà¤
45365>>>>>>>    //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
45365>>>>>>>    //œ) œ¤ž£â¨à©ž properties after
45365>>>>>>>    Procedure Update
45366>>>>>>>
45366>>>>>>>              Forward Send Update
45368>>>>>>>
45368>>>>>>>              //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
45368>>>>>>>                Move SysCurXR.Company_Code  to Btypkin.Company_Code
45369>>>>>>>                Move SysCurXR.Branch_Code   to Btypkin.Branch_Code
45370>>>>>>>                Move SysCurXR.Year_Year     to Btypkin.Year_Year
45371>>>>>>>                Move SysCurXR.Year_Recr     to Btypkin.Year_Recr
45372>>>>>>>
45372>>>>>>>              //™) ˜¤áš¤à©ž properties
45372>>>>>>>
45372>>>>>>>              //š) › ˜®œå¨ ©ž calculated §œ›åà¤
45372>>>>>>>              //š.1:Gplan_Code_Apo1 (conditional)
45372>>>>>>>              //š.2:Gplan_Code_Eos1 (conditional)
45372>>>>>>>              If (Btypkin.Btypkin_Anti1 <> 1);              Begin //æ®  ˜§¦ šœ¤ ¡ã ¢¦š ©« ¡ã
45374>>>>>>>             // gts 02/12/04 oxi gia titana
45374>>>>>>>             //      Move "" to Btypkin.Gplan_Code_Apo1
45374>>>>>>>             //      Move "" to Btypkin.Gplan_Code_Eos1
45374>>>>>>>              End
45374>>>>>>>>
45374>>>>>>>
45374>>>>>>>              //š.3:Gplan_Code_Apo2 (conditional)
45374>>>>>>>              //š.4:Gplan_Code_Eos2 (conditional)
45374>>>>>>>              If (Btypkin.Btypkin_Anti2 <> 1);              Begin //æ®  ˜§¦ šœ¤ ¡ã ¢¦š ©« ¡ã
45376>>>>>>>                   Move "" to Btypkin.Gplan_Code_Apo2
45377>>>>>>>                   Move "" to Btypkin.Gplan_Code_Eos2
45378>>>>>>>              End
45378>>>>>>>>
45378>>>>>>>
45378>>>>>>>              //š.3:gtypkin_rec0 (conditional)
45378>>>>>>>              Case Begin
45378>>>>>>>                   Case (Btypkin.Gtypkin_Code <> 0) //œ¤ž£œ¨é¤œ  šœ¤ ¡ã ¢¦š ©« ¡ã
45380>>>>>>>//jsjsjs 24/01/2001
45380>>>>>>>//                         Clear Gtypkin
45380>>>>>>>//                         Move Btypkin.Company_Code to Gtypkin.Company_Code
45380>>>>>>>//                         Move Btypkin.Branch_Code  to Gtypkin.Branch_Code
45380>>>>>>>//                         Move Btypkin.Year_Year    to Gtypkin.Year_Year
45380>>>>>>>//                         Move Btypkin.Gtypkin_Code to Gtypkin.Gtypkin_Code
45380>>>>>>>//                         Find Eq Gtypkin by Index.1 //company_code+branch_code+year_year+gtypkin_code
45380>>>>>>>//                         If (Found = 1) Move Gtypkin.Gtypkin_Rec0 to Btypkin.Gtypkin_Rec0
45380>>>>>>>//                         Else           Send Operation_Not_Allowed 3001 //›â¤ ™¨âŸž¡œ «¦ gtypkin_rec0, please reindex
45380>>>>>>>//jsjsjs 24/01/2001
45380>>>>>>>                   Case Break
45381>>>>>>>                   Case Else                        //›â¤ œ¤ž£œ¨é¤œ  šœ¤ ¡ã ¢¦š ©« ¡ã
45381>>>>>>>                         Move 0 to Btypkin.Gtypkin_Rec0
45382>>>>>>>              Case End
45382>>>>>>>
45382>>>>>>>              //š.4:ctypkin_rec0 (conditional)
45382>>>>>>>              Case Begin
45382>>>>>>>                   Case (Btypkin.Ctypkin_Code <> 0) //œ¤ž£œ¨é¤œ  §œ¢á«œª
45384>>>>>>>                         Clear Ctypkin
45385>>>>>>>                         Move Btypkin.Company_Code to Ctypkin.Company_Code
45386>>>>>>>                         Move Btypkin.Branch_Code  to Ctypkin.Branch_Code
45387>>>>>>>                         Move Btypkin.Year_Year    to Ctypkin.Year_Year
45388>>>>>>>                         Move Btypkin.Ctypkin_Code to Ctypkin.Ctypkin_Code
45389>>>>>>>                         Find Eq Ctypkin by Index.1 //company_code+branch_code+year_year+Ctypkin_code
45390>>>>>>>>
45390>>>>>>>                         If (Found = 1) Begin
45392>>>>>>>                            Move Ctypkin.Ctypkin_Rec0 to Btypkin.Ctypkin_Rec0
45393>>>>>>>                            Move Ctypkin.Ctypkin_Recr to Btypkin.Ctypkin_Recr
45394>>>>>>>                         End
45394>>>>>>>>
45394>>>>>>>                         Else           Send Operation_Not_Allowed 3002 //›â¤ ™¨âŸž¡œ «¦ Ctypkin_rec0, please reindex
45396>>>>>>>                   Case Break
45397>>>>>>>                   Case Else                        //›â¤ œ¤ž£œ¨é¤œ  §œ¢á«œª
45397>>>>>>>                         Move  0 to Btypkin.Ctypkin_Rec0
45398>>>>>>>                         Move '' to Btypkin.Ctypkin_Recr
45399>>>>>>>              Case End
45399>>>>>>>
45399>>>>>>>              //š.5:vtypkin_rec0 (conditional)
45399>>>>>>>              Case Begin
45399>>>>>>>                   Case (Btypkin.Vtypkin_Code <> 0) //œ¤ž£œ¨é¤œ  §¨¦£žŸœ¬«âª
45401>>>>>>>                         //Clear Vtypkin
45401>>>>>>>                         //Move Btypkin.Company_Code to Vtypkin.Company_Code
45401>>>>>>>                         //Move Btypkin.Branch_Code  to Vtypkin.Branch_Code
45401>>>>>>>                         //Move Btypkin.Year_Year    to Vtypkin.Year_Year
45401>>>>>>>                         //Move Btypkin.Vtypkin_Code to Vtypkin.Vtypkin_Code
45401>>>>>>>                         //Find Eq Vtypkin by Index.1 //company_code+branch_code+year_year+Vtypkin_code
45401>>>>>>>                         //If (Found = 1) Move Vtypkin.Vtypkin_Rec0 to Btypkin.Vtypkin_Rec0
45401>>>>>>>                         //Else           Send Operation_Not_Allowed 3003 //›â¤ ™¨âŸž¡œ «¦ Vtypkin_rec0, please reindex
45401>>>>>>>                   Case Break
45402>>>>>>>                   Case Else                        //›â¤ œ¤ž£œ¨é¤œ  §¨¦£žŸœ¬«âª
45402>>>>>>>                         Move 0 to Btypkin.Vtypkin_Rec0
45403>>>>>>>              Case End
45403>>>>>>>
45403>>>>>>>              //š.6:btypkin_l_hmnia (conditional)
45403>>>>>>>              If (Btypkin.Btypkin_L_No = 0) Move 0 to Btypkin.Btypkin_L_Hmnia
45406>>>>>>>
45406>>>>>>>
45406>>>>>>>              //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
45406>>>>>>>
45406>>>>>>>              //œ) œ¤ž£â¨à©ž properties after
45406>>>>>>>    End_Procedure //update
45407>>>>>>>
45407>>>>>>>    Procedure Creating
45408>>>>>>>              Forward Send Creating
45410>>>>>>>              //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBtypkin //˜¨ Ÿ£æª á¨Ÿ¨à¤ «žª ®¨ã©žª
45410>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Btypkin.Btypkin_Rec0)))))) to Btypkin.Btypkin_Recr
45411>>>>>>>    End_Procedure //creating
45412>>>>>>>
45412>>>>>>>//    Procedure OnConstrain
45412>>>>>>>//        Set piMustNOTConstrain to True
45412>>>>>>>        
45412>>>>>>>//        If (piMustNOTConstrain(Self)) Begin
45412>>>>>>>//        End
45412>>>>>>>//        Else Begin
45412>>>>>>>//            Constrain Btypkin.Company_Code  eq SysCurXR.Company_Code
45412>>>>>>>//            Constrain Btypkin.Branch_Code   eq SysCurXR.Branch_Code
45412>>>>>>>//            Constrain Btypkin.Year_Year     eq SysCurXR.Year_Year
45412>>>>>>>//        End
45412>>>>>>>//    End_Procedure
45412>>>>>>>
45412>>>>>>>
45412>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
45413>>>>>>>              String lsError_Message
45414>>>>>>>              Case Begin
45414>>>>>>>                   //˜§æ validate save
45414>>>>>>>                   Case (iError_Num = 1001)
45416>>>>>>>                        //Move ("DDC 141:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n† «¨¦§¦§¦åž©ž œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");
45416>>>>>>>                        //to lsError_Message
45416>>>>>>>                   Case Break
45417>>>>>>>                   Case (iError_Num = 1100)
45420>>>>>>>                        Move "DDC 141:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
45421>>>>>>>                        Case Break
45422>>>>>>>
45422>>>>>>>                   //˜§æ validate delete
45422>>>>>>>                   Case (iError_Num = 2001)
45425>>>>>>>                        //Clear Codemast
45425>>>>>>>                        //Move ("DDC 141:€›ç¤˜«ž ž › ˜š¨˜­ã !\n\n† › ˜š¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");
45425>>>>>>>                        //to lsError_Message
45425>>>>>>>                   Case Break
45426>>>>>>>                   Case (iError_Num = 2100)
45429>>>>>>>                        Move "DDC 141:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
45430>>>>>>>                        Case Break
45431>>>>>>>
45431>>>>>>>                   //˜§æ update
45431>>>>>>>                   Case (iError_Num = 3001)
45434>>>>>>>                        Move ("DDC 141:ƒâ¤ ™¨âŸž¡œ ž ˜¤«å©«¦ ®ž ¡å¤ž©ž «žª ‚œ¤ ¡ãª Š¦š ©« ¡ãª !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
45435>>>>>>>                   Case Break
45436>>>>>>>                   Case (iError_Num = 3002)
45439>>>>>>>                        Move ("DDC 141:ƒâ¤ ™¨âŸž¡œ ž ˜¤«å©«¦ ®ž ¡å¤ž©ž «é¤ œ¢˜«é¤ !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
45440>>>>>>>                   Case Break
45441>>>>>>>                   Case (iError_Num = 3003)
45444>>>>>>>                        Move ("DDC 141:ƒâ¤ ™¨âŸž¡œ ž ˜¤«å©«¦ ®ž ¡å¤ž©ž «é¤ ¨¦£žŸœ¬«é¤ !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
45445>>>>>>>                   Case Break
45446>>>>>>>
45446>>>>>>>
45446>>>>>>>
45446>>>>>>>                   Case Else
45446>>>>>>>                        Forward Send Operation_Not_Allowed iError_Num
45448>>>>>>>              Case End
45448>>>>>>>
45448>>>>>>>              Error iError_Num lsError_Message
45449>>>>>>>>
45449>>>>>>>    End_Procedure // operation_not_allowed
45450>>>>>>>
45450>>>>>>>
45450>>>>>>>//    //1001:
45450>>>>>>>//    //˜§˜š¦¨œçœ«˜  «¦ btypkin ¤˜ ˜¢¢áœ  parent year
45450>>>>>>>//    Function Validate_Save Returns Integer
45450>>>>>>>//             Integer iReturnVal
45450>>>>>>>
45450>>>>>>>//             Forward Get Validate_Save to iReturnVal
45450>>>>>>>
45450>>>>>>>//             If (Not(iReturnVal));
45450>>>>>>>//             Begin
45450>>>>>>>//                  //1100:cby = globals
45450>>>>>>>//                  If ( ;
45450>>>>>>>//                      (Not(Btypkin.Company_Code = SysCurXR.Company_Code))or ;
45450>>>>>>>//                      (Not(Btypkin.Branch_Code  = SysCurXR.Branch_Code)) or ;
45450>>>>>>>//                      (Not(Btypkin.Year_Year    = SysCurXR.Year_Year))      ;
45450>>>>>>>//                      )                                                   Send Operation_Not_Allowed 1100
45450>>>>>>>//             End //«â¢¦ª ¡é› ¡˜ validation
45450>>>>>>>//             Function_Return iReturnVal
45450>>>>>>>//    End_Function   // validate_save
45450>>>>>>>
45450>>>>>>>
45450>>>>>>>//    //2001:
45450>>>>>>>//    Function Validate_Delete  Returns Integer
45450>>>>>>>//             Integer iReturnVal
45450>>>>>>>//             Forward Get Validate_Delete  To iReturnVal
45450>>>>>>>//             If (Not(iReturnVal));
45450>>>>>>>//             Begin
45450>>>>>>>
45450>>>>>>>//                  //2100:cby = globals
45450>>>>>>>//                  If ( ;
45450>>>>>>>//                      (Not(Btypkin.Company_Code = SysCurXR.Company_Code))or ;
45450>>>>>>>//                      (Not(Btypkin.Branch_Code  = SysCurXR.Branch_Code)) or ;
45450>>>>>>>//                      (Not(Btypkin.Year_Year    = SysCurXR.Year_Year))      ;
45450>>>>>>>//                      )                                                   Send Operation_Not_Allowed 2100
45450>>>>>>>//             End //«â¢¦ª ¡é› ¡˜ validation
45450>>>>>>>//             Function_Return iReturnVal
45450>>>>>>>//    End_Function   // Validate_Delete
45450>>>>>>>
45450>>>>>>>
45450>>>>>>>    Procedure Define_Fields
45451>>>>>>>        Forward Send Define_Fields
45453>>>>>>>        //DDB-Generated-Code-Location
45453>>>>>>>        //DDB-DefineFieldStart
45453>>>>>>>
45453>>>>>>>        Set Main_File            To Btypkin.File_Number
45454>>>>>>>        Set Cascade_Delete_State To FALSE
45455>>>>>>>
45455>>>>>>>
45455>>>>>>>        // Child (Client) file structure................
45455>>>>>>>        Send Add_Client_File  Bflagkin.File_Number
45456>>>>>>>        Send Add_Client_File  Bkinkat.File_Number
45457>>>>>>>        Send Add_Client_File  Barticl.File_Number
45458>>>>>>>
45458>>>>>>>        // External (System) file structure.............
45458>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
45459>>>>>>>
45459>>>>>>>        Define_Auto_Increment  Sysrecb.Btypkin_Rec0  To Btypkin.Btypkin_Rec0
45462>>>>>>>
45462>>>>>>>        // Field-based properties.......................
45462>>>>>>>
45462>>>>>>>        // Btypkin.Company_Code
45462>>>>>>>        //DDB/ Comment_Short       Field Btypkin.Company_Code To "„¤ž£œ¨é¤œ«˜  ©«ž¤ update"
45462>>>>>>>
45462>>>>>>>        // Btypkin.Branch_Code
45462>>>>>>>        //DDB/ Comment_Short       Field Btypkin.Branch_Code To "„¤ž£œ¨é¤œ«˜  ©«ž¤ update"
45462>>>>>>>
45462>>>>>>>        // Btypkin.Year_Year
45462>>>>>>>        //DDB/ Comment_Short       Field Btypkin.Year_Year To "„¤ž£œ¨é¤œ«˜  ©«ž¤ update"
45462>>>>>>>
45462>>>>>>>        // Btypkin.Btypkin_Code
45462>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Code To (SL031(Self))
45463>>>>>>>
45463>>>>>>>        // Btypkin.Btypkin_Rec0
45463>>>>>>>
45463>>>>>>>        // Btypkin.Btypkin_Recr
45463>>>>>>>
45463>>>>>>>        // Btypkin.Year_Recr
45463>>>>>>>
45463>>>>>>>        // Btypkin.Btypkin_Descr
45463>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Descr To (SL031(Self))
45464>>>>>>>
45464>>>>>>>        // Btypkin.Gtypkin_Code
45464>>>>>>>
45464>>>>>>>        // Btypkin.Ctypkin_Code
45464>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Ctypkin_Code To (sl007(Self))
45465>>>>>>>
45465>>>>>>>        // Btypkin.Vtypkin_Code
45465>>>>>>>
45465>>>>>>>        // Btypkin.Gtypkin_Rec0
45465>>>>>>>
45465>>>>>>>        // Btypkin.Ctypkin_Rec0
45465>>>>>>>
45465>>>>>>>        // Btypkin.Vtypkin_Rec0
45465>>>>>>>
45465>>>>>>>        // Btypkin.Btypkin_Anti1
45465>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti1 To (Bfile_VT(Self))
45466>>>>>>>
45466>>>>>>>        // Btypkin.Gplan_Code_Apo1
45466>>>>>>>
45466>>>>>>>        // Btypkin.Gplan_Code_Eos1
45466>>>>>>>
45466>>>>>>>        // Btypkin.Btypkin_Anti2
45466>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti2 To (Bfile_VT(Self))
45467>>>>>>>
45467>>>>>>>        // Btypkin.Gplan_Code_Apo2
45467>>>>>>>
45467>>>>>>>        // Btypkin.Gplan_Code_Eos2
45467>>>>>>>
45467>>>>>>>        // Btypkin.Bflagkin_Num
45467>>>>>>>
45467>>>>>>>        // Btypkin.Bkinkat_Num
45467>>>>>>>        //DDB/ Comment_Short       Field Btypkin.Bkinkat_Num To "“§¦¢¦šåœ«˜  ©«ž¤ update «¦¬ bkinkat."
45467>>>>>>>
45467>>>>>>>        // Btypkin.Btypkin_Anti_Xp
45467>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti_Xp To (Btypkin_Btypkin_Anti_Xp_VT(Self))
45468>>>>>>>
45468>>>>>>>        // Btypkin.Btypkin_Printer
45468>>>>>>>
45468>>>>>>>        // Btypkin.Btypkin_Pdescr
45468>>>>>>>
45468>>>>>>>        // Btypkin.Btypkin_Form
45468>>>>>>>
45468>>>>>>>        // Btypkin.Btypkin_L_No
45468>>>>>>>
45468>>>>>>>        // Btypkin.Btypkin_L_Hmnia
45468>>>>>>>        Set Field_Mask_Type        Field Btypkin.Btypkin_L_Hmnia To MASK_DATE_WINDOW
45469>>>>>>>
45469>>>>>>>        // Btypkin.Btypkin_Seira
45469>>>>>>>
45469>>>>>>>        // Btypkin.Btypkin_Abr
45469>>>>>>>
45469>>>>>>>        // Btypkin.Btypkin_Flag01
45469>>>>>>>        //DDB/ Comment_Short       Field Btypkin.Btypkin_Flag01 To "“§¦¢¦šåœ«˜  ©«ž¤ update/backout «¦¬ bflagkin."
45469>>>>>>>
45469>>>>>>>        // Btypkin.Btypkin_Flag02
45469>>>>>>>
45469>>>>>>>        // Btypkin.Btypkin_Flag03
45469>>>>>>>
45469>>>>>>>        // Btypkin.Btypkin_Flag04
45469>>>>>>>
45469>>>>>>>        // Btypkin.Btypkin_Flag05
45469>>>>>>>        Set Field_Checkbox_Values  Field Btypkin.Btypkin_Flag05 To "1"  "0"
45470>>>>>>>
45470>>>>>>>        // Btypkin.Btypkin_Flag06
45470>>>>>>>
45470>>>>>>>        // Btypkin.Btypkin_Flag07
45470>>>>>>>
45470>>>>>>>        // Btypkin.Btypkin_Flag08
45470>>>>>>>
45470>>>>>>>        // Btypkin.Btypkin_Flag09
45470>>>>>>>
45470>>>>>>>        // Btypkin.Btypkin_Flag10
45470>>>>>>>
45470>>>>>>>        // Btypkin.Btypkin_Flag11
45470>>>>>>>
45470>>>>>>>        // Btypkin.Btypkin_Flag12
45470>>>>>>>
45470>>>>>>>        // Btypkin.Btypkin_Flag13
45470>>>>>>>
45470>>>>>>>        // Btypkin.Btypkin_Flag14
45470>>>>>>>
45470>>>>>>>        // Btypkin.Btypkin_Flag15
45470>>>>>>>
45470>>>>>>>        // Btypkin.Btypkin_Flag16
45470>>>>>>>
45470>>>>>>>        // Btypkin.Btypkin_Flag17
45470>>>>>>>
45470>>>>>>>        // Btypkin.Btypkin_Flag18
45470>>>>>>>
45470>>>>>>>        // Btypkin.Btypkin_Flag19
45470>>>>>>>
45470>>>>>>>        // Btypkin.Btypkin_Flag20
45470>>>>>>>
45470>>>>>>>        // Btypkin.Btypkin_Sign
45470>>>>>>>        Set Field_Checkbox_Values  Field Btypkin.Btypkin_Sign To "1"  "-1"
45471>>>>>>>
45471>>>>>>>        // Btypkin.Ctypkin_Recr
45471>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Ctypkin_Recr To (sl007r(Self))
45472>>>>>>>
45472>>>>>>>        // Btypkin.Label
45472>>>>>>>
45472>>>>>>>        // Btypkin.Locked
45472>>>>>>>
45472>>>>>>>        // Btypkin.Locked_Date
45472>>>>>>>        Set Field_Mask_Type        Field Btypkin.Locked_Date To MASK_DATE_WINDOW
45473>>>>>>>
45473>>>>>>>        //DDB-DefineFieldEnd
45473>>>>>>>
45473>>>>>>>        Set Main_File            To Btypkin.File_Number
45474>>>>>>>        Set Cascade_Delete_State To FALSE
45475>>>>>>>
45475>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
45476>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
45477>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
45478>>>>>>>
45478>>>>>>>        // Child (Client) file structure................
45478>>>>>>>        Send Add_Client_File  Bflagkin.File_Number
45479>>>>>>>        Send Add_Client_File  Barticl.File_Number
45480>>>>>>>        Send Add_Client_File  Bkinkat.File_Number
45481>>>>>>>
45481>>>>>>>        // External (System) file structure.............
45481>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
45482>>>>>>>        //Send Add_System_File  Gtypkin.File_Number  DD_LOCK_ON_SAVE
45482>>>>>>>
45482>>>>>>>        Define_Auto_Increment  Sysrecb.Btypkin_Rec0  To Btypkin.Btypkin_Rec0
45485>>>>>>>
45485>>>>>>>        // Field-based properties.......................
45485>>>>>>>
45485>>>>>>>        // Btypkin.Company_Code
45485>>>>>>>
45485>>>>>>>        // Btypkin.Branch_Code
45485>>>>>>>
45485>>>>>>>        // Btypkin.Year_Year
45485>>>>>>>
45485>>>>>>>        // Btypkin.Btypkin_Code
45485>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Code     To "‰à› ¡æª ‰å¤ž©žª"
45486>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Code     To "‰å¤ž©ž"
45487>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Code     To DD_AUTOFIND    DD_REQUIRED
45488>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Code     To (sl031(Self))
45489>>>>>>>        Set Key_Field_State        Field Btypkin.Btypkin_Code     To TRUE
45490>>>>>>>
45490>>>>>>>        // Btypkin.Btypkin_Rec0
45490>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Rec0     To DD_AUTOFIND    DD_NOPUT       DD_REQUIRED
45491>>>>>>>        Set Key_Field_State        Field Btypkin.Btypkin_Rec0     To TRUE
45492>>>>>>>
45492>>>>>>>        // Btypkin.Year_Rec0
45492>>>>>>>
45492>>>>>>>        // Btypkin.Btypkin_Descr
45492>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Descr    To "œ¨ š¨˜­ã ‰å¤ž©žª"
45493>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Descr    To "œ¨ š¨˜­ã"
45494>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Descr    To (sl031(Self))
45495>>>>>>>
45495>>>>>>>        // Btypkin.Gtypkin_Code
45495>>>>>>>        Set Field_Label_Long       Field Btypkin.Gtypkin_Code     To "‰å¤ž©ž ‚Š"
45496>>>>>>>        Set Field_Label_Short      Field Btypkin.Gtypkin_Code     To "‰å¤ž©ž ‚Š"
45497>>>>>>>        //Set Field_Prompt_Object    Field Btypkin.Gtypkin_Code     To (SL055(Self))
45497>>>>>>>
45497>>>>>>>        // Btypkin.Ctypkin_Code
45497>>>>>>>        Set Field_Label_Long       Field Btypkin.Ctypkin_Code     To "‰å¤ž©ž œ¢˜«é¤"
45498>>>>>>>        Set Field_Label_Short      Field Btypkin.Ctypkin_Code     To "‰å¤ž©ž œ¢˜«é¤"
45499>>>>>>>
45499>>>>>>>        // Btypkin.Vtypkin_Code
45499>>>>>>>        Set Field_Label_Long       Field Btypkin.Vtypkin_Code     To "‰å¤ž©ž ¨¦£žŸœ¬«é¤"
45500>>>>>>>        Set Field_Label_Short      Field Btypkin.Vtypkin_Code     To "‰å¤ž©ž ¨¦£žŸœ¬«é¤"
45501>>>>>>>
45501>>>>>>>        // Btypkin.Gtypkin_Rec0
45501>>>>>>>        Set Field_Options          Field Btypkin.Gtypkin_Rec0     To DD_DISPLAYONLY
45502>>>>>>>
45502>>>>>>>        // Btypkin.Ctypkin_Rec0
45502>>>>>>>        Set Field_Options          Field Btypkin.Ctypkin_Rec0     To DD_DISPLAYONLY
45503>>>>>>>
45503>>>>>>>        // Btypkin.Vtypkin_Rec0
45503>>>>>>>        Set Field_Options          Field Btypkin.Vtypkin_Rec0     To DD_DISPLAYONLY
45504>>>>>>>
45504>>>>>>>        // Btypkin.Btypkin_Anti1
45504>>>>>>>        Set Field_Class_Name       Field Btypkin.Btypkin_Anti1    To "dbComboForm_EZ"
45505>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Anti1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª ˜§¦ ˜¨®œå¦:"
45506>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Anti1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª"
45507>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti1    To (Bfile_VT(Self))
45508>>>>>>>
45508>>>>>>>        // Btypkin.Gplan_Code_Apo1
45508>>>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Apo1  To "€§¦ ‰à› ¡æ ‚Š"
45509>>>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Apo1  To "€§¦ ‰à› ¡æ ‚Š"
45510>>>>>>>
45510>>>>>>>        // Btypkin.Gplan_Code_Eos1
45510>>>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Eos1  To "„àª ‰à› ¡æ ‚Š"
45511>>>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Eos1  To "„àª ‰à› ¡æ ‚Š"
45512>>>>>>>
45512>>>>>>>        // Btypkin.Btypkin_Anti2
45512>>>>>>>        Set Field_Class_Name       Field Btypkin.Btypkin_Anti2    To "dbComboForm_EZ"
45513>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Anti2    To "˜¨˜¢ã§«žª ˜§¦ ˜¨®œå¦:"
45514>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Anti2    To "˜¨˜¢ã§«žª"
45515>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti2    To (Bfile_VT(Self))
45516>>>>>>>
45516>>>>>>>        // Btypkin.Gplan_Code_Apo2
45516>>>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Apo2  To "€§¦ ‰à› ¡æ ‚Š"
45517>>>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Apo2  To "€§¦ ‰à› ¡æ ‚Š"
45518>>>>>>>
45518>>>>>>>        // Btypkin.Gplan_Code_Eos2
45518>>>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Eos2  To "„àª ‰à› ¡æ ‚Š"
45519>>>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Eos2  To "„àª ‰à› ¡æ ‚Š"
45520>>>>>>>
45520>>>>>>>        // Btypkin.Bflagkin_Num
45520>>>>>>>        Set Field_Label_Long       Field Btypkin.Bflagkin_Num     To "¢ãŸ¦ª Flags"
45521>>>>>>>        Set Field_Label_Short      Field Btypkin.Bflagkin_Num     To "¢ãŸ¦ª Flags"
45522>>>>>>>        Set Field_Options          Field Btypkin.Bflagkin_Num     To DD_DISPLAYONLY
45523>>>>>>>
45523>>>>>>>        // Btypkin.Bkinkat_Num
45523>>>>>>>        Set Field_Label_Long       Field Btypkin.Bkinkat_Num      To "¢ãŸ¦ª ‰˜«žš¦¨ é¤ €¥ é¤"
45524>>>>>>>        Set Field_Label_Short      Field Btypkin.Bkinkat_Num      To "¢ãŸ¦ª ‰˜«.€¥ é¤"
45525>>>>>>>        Set Field_Options          Field Btypkin.Bkinkat_Num      To DD_DISPLAYONLY
45526>>>>>>>
45526>>>>>>>        // Btypkin.Btypkin_Anti_Xp
45526>>>>>>>        Set Field_Class_Name       Field Btypkin.Btypkin_Anti_Xp  To "dbComboForm_EZ"
45527>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Anti_Xp  To "Ž ©¬¤˜¢¢˜©æ£œ¤¦ª:"
45528>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Anti_Xp  To "• ‘¬¤˜¢¢˜©¦£â¤¦¬"
45529>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti_Xp  To (Btypkin_Btypkin_Anti_Xp_VT(Self))
45530>>>>>>>
45530>>>>>>>        // Btypkin.Btypkin_Printer
45530>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Printer  To "ƒ œçŸ¬¤©ž „¡«¬§à«ã"
45531>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Printer  To "„¡«¬§à«ãª"
45532>>>>>>>
45532>>>>>>>        // Btypkin.Btypkin_Pdescr
45532>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Pdescr   To "’å«¢¦ª „¡«ç§à©žª"
45533>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Pdescr   To "’å«¢¦ª „¡«ç§à©žª"
45534>>>>>>>
45534>>>>>>>        // Btypkin.Btypkin_Form
45534>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Form     To "”æ¨£˜ „¡«ç§à©žª"
45535>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Form     To "”æ¨£˜"
45536>>>>>>>
45536>>>>>>>        // Btypkin.Btypkin_L_No
45536>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_L_No     To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª"
45537>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_L_No     To "’œ¢.€¨."
45538>>>>>>>        //Set Field_Options          Field Btypkin.Btypkin_L_No     To DD_DISPLAYONLY
45538>>>>>>>
45538>>>>>>>        // Btypkin.Btypkin_L_Hmnia
45538>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_L_Hmnia  To "’œ¢œ¬«˜å˜ †£/¤å˜"
45539>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_L_Hmnia  To "’œ¢.†£/¤å˜"
45540>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_L_Hmnia  To DD_DISPLAYONLY
45541>>>>>>>
45541>>>>>>>        // Btypkin.Btypkin_Seira
45541>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Seira    To "‘œ ¨á"
45542>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Seira    To "‘œ ¨á"
45543>>>>>>>
45543>>>>>>>        // Btypkin.Btypkin_Abr
45543>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Abr      To "‘¬¤«¦£¦š¨˜­å˜"
45544>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Abr      To "‘¬¤«/­å˜"
45545>>>>>>>
45545>>>>>>>        // Btypkin.Btypkin_Flag01
45545>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag01   To DD_DISPLAYONLY
45546>>>>>>>
45546>>>>>>>        // Btypkin.Btypkin_Flag02
45546>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag02   To DD_DISPLAYONLY
45547>>>>>>>
45547>>>>>>>        // Btypkin.Btypkin_Flag03
45547>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag03   To DD_DISPLAYONLY
45548>>>>>>>
45548>>>>>>>        // Btypkin.Btypkin_Flag04
45548>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag04   To DD_DISPLAYONLY
45549>>>>>>>
45549>>>>>>>        // Btypkin.Btypkin_Flag05
45549>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag05   To DD_DISPLAYONLY
45550>>>>>>>
45550>>>>>>>        // Btypkin.Btypkin_Flag06
45550>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag06   To DD_DISPLAYONLY
45551>>>>>>>
45551>>>>>>>        // Btypkin.Btypkin_Flag07
45551>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag07   To DD_DISPLAYONLY
45552>>>>>>>
45552>>>>>>>        // Btypkin.Btypkin_Flag08
45552>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag08   To DD_DISPLAYONLY
45553>>>>>>>
45553>>>>>>>        // Btypkin.Btypkin_Flag09
45553>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag09   To DD_DISPLAYONLY
45554>>>>>>>
45554>>>>>>>        // Btypkin.Btypkin_Flag10
45554>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag10   To DD_DISPLAYONLY
45555>>>>>>>
45555>>>>>>>        // Btypkin.Btypkin_Flag11
45555>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag11   To DD_DISPLAYONLY
45556>>>>>>>
45556>>>>>>>        // Btypkin.Btypkin_Flag12
45556>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag12   To DD_DISPLAYONLY
45557>>>>>>>
45557>>>>>>>        // Btypkin.Btypkin_Flag13
45557>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag13   To DD_DISPLAYONLY
45558>>>>>>>
45558>>>>>>>        // Btypkin.Btypkin_Flag14
45558>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag14   To DD_DISPLAYONLY
45559>>>>>>>
45559>>>>>>>        // Btypkin.Btypkin_Flag15
45559>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag15   To DD_DISPLAYONLY
45560>>>>>>>
45560>>>>>>>        // Btypkin.Btypkin_Flag16
45560>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag16   To DD_DISPLAYONLY
45561>>>>>>>
45561>>>>>>>        // Btypkin.Btypkin_Flag17
45561>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag17   To DD_DISPLAYONLY
45562>>>>>>>
45562>>>>>>>        // Btypkin.Btypkin_Flag18
45562>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag18   To DD_DISPLAYONLY
45563>>>>>>>
45563>>>>>>>        // Btypkin.Btypkin_Flag19
45563>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag19   To DD_DISPLAYONLY
45564>>>>>>>
45564>>>>>>>        // Btypkin.Btypkin_Flag20
45564>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag20   To DD_DISPLAYONLY
45565>>>>>>>
45565>>>>>>>    End_Procedure    // Define_Fields
45566>>>>>>>
45566>>>>>>>
45566>>>>>>>
45566>>>>>>>    // Field_Defaults:
45566>>>>>>>    // This procedure is used to establish default field values.
45566>>>>>>>
45566>>>>>>>    Procedure Field_Defaults
45567>>>>>>>        Forward Send Field_Defaults
45569>>>>>>>        //DDB-Generated-Code-Location
45569>>>>>>>        //DDB-FieldDefaultStart
45569>>>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Anti1 To 0
45570>>>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Anti2 To 0
45571>>>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Anti_Xp To 1
45572>>>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Flag05 To 0
45573>>>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Sign To 1
45574>>>>>>>        //DDB-FieldDefaultEnd
45574>>>>>>>    End_Procedure    // Field_Defaults
45575>>>>>>>End_Class    // Btypkin_DataDictionary
45576>>>>>>>//DDB-Selection-pkg-Start
45576>>>>>>>
45576>>>>>>>Use SL031.SL         // SL031
45576>>>>>>>Use sl007.SL         // sl007
45576>>>>>>>Use sl007r.SL        // sl007r
45576>>>>>>>
45576>>>>>>>//DDB-Selection-pkg-End
45576>>>>>>>//DDB-FileEnd
45576>>>>>
45576>>>>>//AB-IgnoreEnd
45576>>>>>
45576>>>>>CD_Popup_Object SL031 is a dbModalPanelSub
45595>>>>>    Set Label to "‰ ¤ã©œ ª  €¥ ¦š¨á­à¤"
45596>>>>>    Set Size to 213 506
45597>>>>>    Set Location to 4 5
45598>>>>>    Set Exit_Application_Local_State to FALSE
45599>>>>>    Set Modal_State to FALSE
45600>>>>>
45600>>>>>    //AB-DDOStart
45600>>>>>
45600>>>>>    Object Btypkin_DD is a Btypkin_DataDictionary
45602>>>>>    End_Object    // Btypkin_DD
45603>>>>>
45603>>>>>    Set Main_DD to (Btypkin_DD(self))
45604>>>>>    Set Server to (Btypkin_DD(self))
45605>>>>>
45605>>>>>    //AB-DDOEnd
45605>>>>>
45605>>>>>    Object oSelList is a dbListSub
45607>>>>>        Set Main_File to Btypkin.File_Number
45608>>>>>        Set Size to 173 491
45609>>>>>        Set Location to 3 6
45610>>>>>
45610>>>>>        Begin_Row
45613>>>>>            Entry_Item Btypkin.Btypkin_code
45614>>>>>            Entry_Item Btypkin.Btypkin_descr
45615>>>>>            Entry_Item Btypkin.Gtypkin_code
45616>>>>>            Entry_Item Btypkin.Ctypkin_code
45617>>>>>            Entry_Item Btypkin.Vtypkin_code
45618>>>>>            Entry_Item Btypkin.Btypkin_anti_xp
45619>>>>>            Entry_Item Btypkin.Locked
45620>>>>>        End_Row
45625>>>>>
45625>>>>>        Set Form_Width    item 0 to 39
45626>>>>>        Set Header_Label  item 0 to "‰å¤ž©ž"
45627>>>>>        
45627>>>>>        Set Form_Width    item 1 to 172
45628>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
45629>>>>>        
45629>>>>>        Set Form_Width    item 2 to 46
45630>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž ‚Š"
45631>>>>>        
45631>>>>>        Set Form_Width    item 3 to 70
45632>>>>>        Set Header_Label  item 3 to "‰å¤ž©ž œ¢˜«é¤        "
45633>>>>>        
45633>>>>>        Set Form_Width    item 4 to 53
45634>>>>>        Set Header_Label  item 4 to "‰å¤ž©ž ¨¦£."
45635>>>>>        
45635>>>>>        Set Form_Width    item 5 to 64
45636>>>>>        Set Header_Label  item 5 to "• ‘¬¤˜¢¢˜©¦£."
45637>>>>>        
45637>>>>>        Set Form_Width    item 6 to 42
45638>>>>>        Set Header_Label  item 6 to "‰¢œ ›à£â¤ž"
45639>>>>>        Set Column_Checkbox_State  item 6 to True
45640>>>>>        
45640>>>>>    End_Object    // oSelList
45641>>>>>
45641>>>>>    Object oOK_bn is a ButtonSub
45643>>>>>        Set Label to "&„§ ¢¦šã"
45644>>>>>        Set Location to 177 337
45645>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45646>>>>>
45646>>>>>        //AB-StoreStart
45646>>>>>        Procedure OnClick
45648>>>>>            Send OK To oSelList
45649>>>>>        End_Procedure
45650>>>>>        //AB-StoreEnd
45650>>>>>
45650>>>>>    End_Object    // oOK_bn
45651>>>>>
45651>>>>>    Object oCancel_bn is a ButtonSub
45653>>>>>        Set Label to "&€¡ç¨à©ž"
45654>>>>>        Set Location to 177 393
45655>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45656>>>>>
45656>>>>>        //AB-StoreStart
45656>>>>>        Procedure OnClick
45658>>>>>            Send Cancel To oSelList
45659>>>>>        End_Procedure
45660>>>>>        //AB-StoreEnd
45660>>>>>
45660>>>>>    End_Object    // oCancel_bn
45661>>>>>
45661>>>>>    Object oSearch_bn is a ButtonSub
45663>>>>>        Set Label to "€&¤˜ã«ž©ž"
45664>>>>>        Set Location to 177 447
45665>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45666>>>>>
45666>>>>>        //AB-StoreStart
45666>>>>>        Procedure OnClick
45668>>>>>            Send Search To oSelList
45669>>>>>        End_Procedure
45670>>>>>        //AB-StoreEnd
45670>>>>>
45670>>>>>    End_Object    // oSearch_bn
45671>>>>>
45671>>>>>
45671>>>>>    //AB-StoreStart
45671>>>>>    On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
45672>>>>>    On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
45673>>>>>    On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
45674>>>>>    
45674>>>>>    //AB-StoreEnd
45674>>>>>
45674>>>>>CD_End_Object    // SL031
45676>>>>>>
45676>>>>>
45676>>>>>//AB/ End_Object    // prj
45676>>>Use sl031r.sl
INCLUDING FILE: SL031R.SL
45676>>>>>//AB/ Project sl031r:Btypkin with recr 1st col
45676>>>>>//AB/     Object prj is a Lookup_Project
45676>>>>>//AB/         Set ProjectName to "sl031r:Btypkin with recr 1st col"
45676>>>>>//AB/         Set ProjectFileName to "sl031r.SL"
45676>>>>>//AB/         Set GenerateFileName to "NONAME"
45676>>>>>
45676>>>>>// Project Object Structure
45676>>>>>//   SL031r is a dbModalPanelSub
45676>>>>>//     Btypkin_DD is a DataDictionary
45676>>>>>//     oSelList is a dbListSub
45676>>>>>//     oOK_bn is a ButtonSub
45676>>>>>//     oCancel_bn is a ButtonSub
45676>>>>>//     oSearch_bn is a ButtonSub
45676>>>>>
45676>>>>>// Register all objects
45676>>>>>Register_Object Btypkin_DD
45676>>>>>Register_Object oCancel_bn
45676>>>>>Register_Object oOK_bn
45676>>>>>Register_Object oSearch_bn
45676>>>>>Register_Object oSelList
45676>>>>>Register_Object SL031r
45676>>>>>
45676>>>>>
45676>>>>>    //AB-IgnoreStart
45676>>>>>
45676>>>>>    Use DFAllEnt.pkg
45676>>>>>    Use dbList.Sub
45676>>>>>    Use Button.Sub
45676>>>>>
45676>>>>>
45676>>>>>    Use BTYPKIN.DD
45676>>>>>    
45676>>>>>    //AB-IgnoreEnd
45676>>>>>
45676>>>>>    CD_Popup_Object SL031r is a dbModalPanelSub
45695>>>>>        set label to "‰ ¤ã©œ ª  €¥ ¦š¨á­à¤" 
45696>>>>>        Set Size to 213 362
45697>>>>>        Set Location to 4 5
45698>>>>>        Set Exit_Application_Local_State to FALSE
45699>>>>>        Set Modal_State to FALSE
45700>>>>>
45700>>>>>        //AB-DDOStart
45700>>>>>
45700>>>>>        Object Btypkin_DD is a Btypkin_DataDictionary
45702>>>>>        End_Object    // Btypkin_DD
45703>>>>>
45703>>>>>        Set Main_DD to (Btypkin_DD(self))
45704>>>>>        Set Server to (Btypkin_DD(self))
45705>>>>>
45705>>>>>        //AB-DDOEnd
45705>>>>>
45705>>>>>        Object oSelList is a dbListSub
45707>>>>>            Set Main_File to Btypkin.File_Number
45708>>>>>            Set Size to 173 347
45709>>>>>            Set Location to 2 6
45710>>>>>
45710>>>>>            Begin_Row
45713>>>>>                Entry_Item Btypkin.Btypkin_recr
45714>>>>>                Entry_Item Btypkin.Btypkin_code
45715>>>>>                Entry_Item Btypkin.Btypkin_descr
45716>>>>>                Entry_Item Btypkin.Gtypkin_code
45717>>>>>                Entry_Item Btypkin.Ctypkin_code
45718>>>>>                Entry_Item Btypkin.Vtypkin_code
45719>>>>>                Entry_Item Btypkin.Btypkin_anti_xp
45720>>>>>            End_Row
45725>>>>>
45725>>>>>            Set Form_Width    item 0 to 58
45726>>>>>            Set Header_Label  item 0 to "Btypkin recr"
45727>>>>>            
45727>>>>>            Set Form_Width    item 1 to 36
45728>>>>>            set header_label  item 1 to "‰å¤ž©ž" 
45729>>>>>            
45729>>>>>            Set Form_Width    item 2 to 86
45730>>>>>            set header_label  item 2 to "œ¨ š¨˜­ã" 
45731>>>>>            
45731>>>>>            Set Form_Width    item 3 to 36
45732>>>>>            set header_label  item 3 to "‰å¤ž©ž ‚Š" 
45733>>>>>            
45733>>>>>            Set Form_Width    item 4 to 36
45734>>>>>            set header_label  item 4 to "‰ ¤ã©œ ª œ¢˜«é¤        " 
45735>>>>>            
45735>>>>>            Set Form_Width    item 5 to 36
45736>>>>>            set header_label  item 5 to "‰å¤ž©ž ¨¦£žŸœ¬«é¤" 
45737>>>>>            
45737>>>>>            Set Form_Width    item 6 to 53
45738>>>>>            set header_label  item 6 to "• ‘¬¤˜¢¢˜©¦£â¤¦¬" 
45739>>>>>            
45739>>>>>
45739>>>>>            //AB-StoreStart
45739>>>>>            Set Column_Option Item 0 to NoEnter True
45740>>>>>            
45740>>>>>            //AB-StoreEnd
45740>>>>>
45740>>>>>        End_Object    // oSelList
45741>>>>>
45741>>>>>        Object oOK_bn is a ButtonSub
45743>>>>>            set label to "&„§ ¢¦šã" 
45744>>>>>            Set Location to 178 194
45745>>>>>
45745>>>>>            //AB-StoreStart
45745>>>>>            Procedure OnClick
45747>>>>>                Send OK To oSelList
45748>>>>>            End_Procedure
45749>>>>>            //AB-StoreEnd
45749>>>>>
45749>>>>>        End_Object    // oOK_bn
45750>>>>>
45750>>>>>        Object oCancel_bn is a ButtonSub
45752>>>>>            set label to "&€¡ç¨à©ž" 
45753>>>>>            Set Location to 178 249
45754>>>>>
45754>>>>>            //AB-StoreStart
45754>>>>>            Procedure OnClick
45756>>>>>                Send Cancel To oSelList
45757>>>>>            End_Procedure
45758>>>>>            //AB-StoreEnd
45758>>>>>
45758>>>>>        End_Object    // oCancel_bn
45759>>>>>
45759>>>>>        Object oSearch_bn is a ButtonSub
45761>>>>>            set label to "€&¤˜ã«ž©ž" 
45762>>>>>            Set Location to 178 304
45763>>>>>
45763>>>>>            //AB-StoreStart
45763>>>>>            Procedure OnClick
45765>>>>>                Send Search To oSelList
45766>>>>>            End_Procedure
45767>>>>>            //AB-StoreEnd
45767>>>>>
45767>>>>>        End_Object    // oSearch_bn
45768>>>>>
45768>>>>>
45768>>>>>        //AB-StoreStart
45768>>>>>        On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
45769>>>>>        On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
45770>>>>>        On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
45771>>>>>        
45771>>>>>        //AB-StoreEnd
45771>>>>>
45771>>>>>    CD_End_Object    // SL031r
45773>>>>>>
45773>>>>>
45773>>>>>//AB/     End_Object    // prj
45773>>>Use sl033.sl
INCLUDING FILE: SL033.SL
45773>>>>>//AB/ Project SL033:BKINKAT
45773>>>>>//AB/ Object prj is a Lookup_Project
45773>>>>>//AB/     Set ProjectName to "SL033:BKINKAT"
45773>>>>>//AB/     Set ProjectFileName to "sl033.SL"
45773>>>>>
45773>>>>>// Project Object Structure
45773>>>>>//   sl033 is a dbModalPanelSub
45773>>>>>//     Company_DD is a DataDictionary
45773>>>>>//     Branch_DD is a DataDictionary
45773>>>>>//     Year_DD is a DataDictionary
45773>>>>>//     Btypkin_DD is a DataDictionary
45773>>>>>//     Baxiokat_DD is a DataDictionary
45773>>>>>//     Bkinkat_DD is a DataDictionary
45773>>>>>//     oSelList is a dbListSub
45773>>>>>//     oOK_bn is a ButtonSub
45773>>>>>//     oCancel_bn is a ButtonSub
45773>>>>>//     oSearch_bn is a ButtonSub
45773>>>>>
45773>>>>>// Register all objects
45773>>>>>Register_Object Baxiokat_DD
45773>>>>>Register_Object Bkinkat_DD
45773>>>>>Register_Object Branch_DD
45773>>>>>Register_Object Btypkin_DD
45773>>>>>Register_Object Company_DD
45773>>>>>Register_Object oCancel_bn
45773>>>>>Register_Object oOK_bn
45773>>>>>Register_Object oSearch_bn
45773>>>>>Register_Object oSelList
45773>>>>>Register_Object sl033
45773>>>>>Register_Object Year_DD
45773>>>>>
45773>>>>>
45773>>>>>//AB-IgnoreStart
45773>>>>>
45773>>>>>Use DFAllEnt.pkg
45773>>>>>Use dbList.Sub
45773>>>>>Use Button.Sub
45773>>>>>
45773>>>>>
45773>>>>>Use COMPANY.DD
45773>>>>>Use BRANCH.DD
45773>>>>>Use YEAR.DD
45773>>>>>Use BTYPKIN.DD
45773>>>>>Use BAXIOKAT.DD
INCLUDING FILE: BAXIOKAT.DD
45773>>>>>>>//DDB-FileStart
45773>>>>>>>//DDB-HeaderStart
45773>>>>>>>
45773>>>>>>>// File Name : BAXIOKAT.DD
45773>>>>>>>// Class Name: Baxiokat_DataDictionary
45773>>>>>>>// Revision  : 45
45773>>>>>>>// Version   : 2
45773>>>>>>>
45773>>>>>>>Use  Windows           // Basic Definitions
45773>>>>>>>Use  DataDict          // DataDictionary Class Definition
45773>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
45773>>>>>>>
45773>>>>>>>Open Baxiokat
INCLUDING FILE: BAXIOKAT.FD
45775>>>>>>>Open Baxio
INCLUDING FILE: BAXIO.FD
45777>>>>>>>Open Bkinkat
45779>>>>>>>Open Tpclient
45781>>>>>>>Open Tperga
45783>>>>>>>Open Tparticl
45785>>>>>>>Open Sysrecb
45787>>>>>>>
45787>>>>>>>//DDB-HeaderEnd
45787>>>>>>>//DDB-ValidationStart
45787>>>>>>>
45787>>>>>>>//DDB/ ExternalValidationTable Baxiokat_Type_VT  BAXIO.PKG
45787>>>>>>>
45787>>>>>>>Register_Object Baxiokat_Type_VT
45787>>>>>>>Register_Object Baxiokat_Baxiokat_Yn5390_VT
45787>>>>>>>Register_Object Baxiokat_Baxiokat_Bank_VT
45787>>>>>>>Register_Object Baxiokat_Baxiokat_Formul_VT
45787>>>>>>>Use BAXIO.PKG        // Baxiokat_Type_VT
45787>>>>>>>
45787>>>>>>>Object Baxiokat_Baxiokat_Yn5390_VT  is a DescriptionValidationTable
45789>>>>>>>
45789>>>>>>>    Procedure Fill_List
45791>>>>>>>        Forward Send Fill_List
45793>>>>>>>        Send Add_Table_Value  "0"  "Ž® "
45794>>>>>>>        Send Add_Table_Value  "1"  "Œ˜ "
45795>>>>>>>    End_Procedure    // Fill_List
45796>>>>>>>    //DDB-ValidationCustomStart
45796>>>>>>>    //DDB-ValidationCustomEnd
45796>>>>>>>End_Object   // Baxiokat_Baxiokat_Yn5390_VT
45797>>>>>>>
45797>>>>>>>Object Baxiokat_Baxiokat_Bank_VT  is a CodeValidationTable
45799>>>>>>>    Set Type_Value        To "BANK"
45800>>>>>>>    Set Allow_Blank_State To TRUE
45801>>>>>>>    //DDB-ValidationCustomStart
45801>>>>>>>    //DDB-ValidationCustomEnd
45801>>>>>>>End_Object   // Baxiokat_Baxiokat_Bank_VT
45802>>>>>>>
45802>>>>>>>Object Baxiokat_Baxiokat_Formul_VT  is a DescriptionValidationTable
45804>>>>>>>    Set Allow_Blank_State To TRUE
45805>>>>>>>
45805>>>>>>>    Procedure Fill_List
45807>>>>>>>        Forward Send Fill_List
45809>>>>>>>        Send Add_Table_Value  "0"  ""
45810>>>>>>>        Send Add_Table_Value  "1"  "’ç§¦ª 1"
45811>>>>>>>        Send Add_Table_Value  "2"  "’ç§¦ª 2"
45812>>>>>>>    End_Procedure    // Fill_List
45813>>>>>>>    //DDB-ValidationCustomStart
45813>>>>>>>    //DDB-ValidationCustomEnd
45813>>>>>>>End_Object   // Baxiokat_Baxiokat_Formul_VT
45814>>>>>>>//DDB-ValidationEnd
45814>>>>>>>//DDB-SelectionStart
45814>>>>>>>//DDB/ ExternalSelectionList SL034  SL034.SL
45814>>>>>>>Register_Object SL034
45814>>>>>>>//DDB-SelectionEnd
45814>>>>>>>
45814>>>>>>>Open Syscurxr
45816>>>>>>>Open Btypkin
45818>>>>>>>Open Bkinkat
45820>>>>>>>
45820>>>>>>>
45820>>>>>>>// Apo Baxio_DD
45820>>>>>>>Register_Function private.Default_Axio_C_Code2 Returns String
45820>>>>>>>//
45820>>>>>>>
45820>>>>>>>Class Baxiokat_DataDictionary  is a DataDictionary_Sec
45821>>>>>>>
45821>>>>>>>     Procedure Creating
45822>>>>>>>        Forward Send Creating
45824>>>>>>>        // Insert Code Here
45824>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Baxiokat.Baxiokat_Rec0)))))) to Baxiokat.Baxiokat_Recr
45825>>>>>>>    End_Procedure   // Creating
45826>>>>>>>
45826>>>>>>>     Procedure Construct_Object
45827>>>>>>>               Forward Send Construct_Object
45829>>>>>>>
45829>>>>>>>               //object id «é¤ ddo servers š ˜ «á barticl+bmove+baxio+baxiokat
45829>>>>>>>               //©œ«á¨¦¤«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
45829>>>>>>>               //®¨ž© £œç¦¬¤ ©«ž¤ private.exit_btypkin_code
45829>>>>>>>               //š ˜ ¤˜ ©œ«á¨¦¬¤ «¦ visual interface
45829>>>>>>>               Property Integer piBarticl_dd  0
45830>>>>>>>               Property Integer piBmove_dd    0
45831>>>>>>>               Property Integer piBaxio_dd    0
45832>>>>>>>               Property Integer piBtypkin_dd 0
45833>>>>>>>     End_Procedure   //construct_object
45834>>>>>>>
45834>>>>>>>
45834>>>>>>>     //private
45834>>>>>>>     //¡˜¢œå«˜  ˜§æ: iexit «¦¬ baxiokat_code
45834>>>>>>>     //©œ«á¨œ      : «ž¤ default « £ã «¦¬ baxio_c_code2, ˜¤á¢¦š˜ £œ «¦ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
45834>>>>>>>     Procedure private.Exit_Baxiokat_Code Integer liField Integer liBaxiokat_Code
45835>>>>>>>               String lsBaxio_C_Code_2
45836>>>>>>>        PROCEDURE_RETURN
45837>>>>>>>//jsjsjs 24/01/2001
45837>>>>>>>//               Get File_Field_Current_Value File_Field Year.Year_C_Code0 to lsBaxio_C_Code_2
45837>>>>>>>
45837>>>>>>>//               Set Field_Changed_Value of (piBaxio_dd(Self)) Field Baxio.Baxio_C_Code2 to  lsBaxio_C_Code_2 //(private.Default_Axio_C_Code2((piBAxio_dd(Self))))
45837>>>>>>>//jsjsjs 24/01/2001
45837>>>>>>>     End_Procedure //private.exit_baxiokat_code
45838>>>>>>>
45838>>>>>>>
45838>>>>>>>    //private
45838>>>>>>>    //¡˜¢œå«˜  ˜§æ:
45838>>>>>>>    //©œ«á¨œ : «ž¤ default value to baxiokat_code, ˜¤á¢¦š˜ £œ «¦ btypkin.baxiokat_num
45838>>>>>>>    Procedure private.Entry_Baxiokat_Code Integer liField Integer liBaxiokat_Code
45839>>>>>>>              Integer liBtypkin_dd liBkinkat_Num liBtypkin_Rec0
45840>>>>>>>
45840>>>>>>>        PROCEDURE_RETURN
45841>>>>>>>
45841>>>>>>>
45841>>>>>>>    End_Procedure //private.entry_gtypkin_code
45842>>>>>>>
45842>>>>>>>
45842>>>>>>>
45842>>>>>>>
45842>>>>>>>    Procedure Update
45843>>>>>>>          Forward Send Update
45845>>>>>>>          If (Baxiokat.Baxiokat_Yn5390 = 0);          Begin //œá¤ ›â¤ œå¤˜  £ž®˜¤¦š¨˜­ž£â¤œª œ§ «˜šâª, £ž›â¤ ©œ æ¢˜ «˜ ©®œ« ¡á §œ›å˜
45847>>>>>>>               Move "" to Baxiokat.Baxiokat_Bank
45848>>>>>>>               Move "" to Baxiokat.Baxiokat_Lno
45849>>>>>>>               Move 0  to Baxiokat.Baxiokat_Formul
45850>>>>>>>          End
45850>>>>>>>>
45850>>>>>>>    End_Procedure
45851>>>>>>>
45851>>>>>>>
45851>>>>>>>    Procedure Define_Fields
45852>>>>>>>        Forward Send Define_Fields
45854>>>>>>>        //DDB-Generated-Code-Location
45854>>>>>>>        //DDB-DefineFieldStart
45854>>>>>>>
45854>>>>>>>        Set Main_File            To Baxiokat.File_Number
45855>>>>>>>        Set Cascade_Delete_State To FALSE
45856>>>>>>>
45856>>>>>>>
45856>>>>>>>        // Child (Client) file structure................
45856>>>>>>>        Send Add_Client_File  Baxio.File_Number
45857>>>>>>>        Send Add_Client_File  Bkinkat.File_Number
45858>>>>>>>        Send Add_Client_File  Tpclient.File_Number
45859>>>>>>>        Send Add_Client_File  Tperga.File_Number
45860>>>>>>>        Send Add_Client_File  Tparticl.File_Number
45861>>>>>>>
45861>>>>>>>        // External (System) file structure.............
45861>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
45862>>>>>>>
45862>>>>>>>        Define_Auto_Increment  Sysrecb.Baxiokat_Rec0  To Baxiokat.Baxiokat_Rec0
45865>>>>>>>
45865>>>>>>>        // Field-based properties.......................
45865>>>>>>>
45865>>>>>>>        // Baxiokat.Baxiokat_Code
45865>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Code To (SL034(Self))
45866>>>>>>>
45866>>>>>>>        // Baxiokat.Baxiokat_Descr
45866>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Descr To (SL034(Self))
45867>>>>>>>
45867>>>>>>>        // Baxiokat.Baxiokat_Rec0
45867>>>>>>>
45867>>>>>>>        // Baxiokat.Baxiokat_Recr
45867>>>>>>>
45867>>>>>>>        // Baxiokat.Baxiokat_Type
45867>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Type To (Baxiokat_Type_VT(Self))
45868>>>>>>>
45868>>>>>>>        // Baxiokat.Baxio_Lcode
45868>>>>>>>        //DDB/ Comment_Short       Field Baxiokat.Baxio_Lcode To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ creating/deleting «¦¬ baxio)"
45868>>>>>>>
45868>>>>>>>        // Baxiokat.Baxiokat_Yn5390
45868>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Yn5390 To (Baxiokat_Baxiokat_Yn5390_VT(Self))
45869>>>>>>>
45869>>>>>>>        // Baxiokat.Baxiokat_Bank
45869>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Bank To (Baxiokat_Baxiokat_Bank_VT(Self))
45870>>>>>>>
45870>>>>>>>        // Baxiokat.Baxiokat_Lno
45870>>>>>>>
45870>>>>>>>        // Baxiokat.Baxiokat_Formul
45870>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Formul To (Baxiokat_Baxiokat_Formul_VT(Self))
45871>>>>>>>
45871>>>>>>>        //DDB-DefineFieldEnd
45871>>>>>>>
45871>>>>>>>        Set Main_File            To Baxiokat.File_Number
45872>>>>>>>        Set Cascade_Delete_State To FALSE
45873>>>>>>>
45873>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
45874>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
45875>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
45876>>>>>>>
45876>>>>>>>        // Child (Client) file structure................
45876>>>>>>>        Send Add_Client_File  Baxio.File_Number
45877>>>>>>>        Send Add_Client_File  Bkinkat.File_Number
45878>>>>>>>
45878>>>>>>>        // External (System) file structure.............
45878>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
45879>>>>>>>
45879>>>>>>>        Define_Auto_Increment  Sysrecb.Baxiokat_Rec0  To Baxiokat.Baxiokat_Rec0
45882>>>>>>>
45882>>>>>>>        // Field-based properties.......................
45882>>>>>>>
45882>>>>>>>        // Baxiokat.Baxiokat_Code
45882>>>>>>>        Set Field_Entry_msg        Field Baxiokat.Baxiokat_Code   To private.Entry_Baxiokat_Code
45883>>>>>>>        Set Field_Exit_msg         Field Baxiokat.Baxiokat_Code   To private.Exit_Baxiokat_Code
45884>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Code   To "‰à› ¡æª „å›¦¬ª €¥ ¦š¨á­¦¬"
45885>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Code   To "„å›¦ª"
45886>>>>>>>        Set Field_Options          Field Baxiokat.Baxiokat_Code   To DD_AUTOFIND    DD_REQUIRED
45887>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Code   To (SL034(Self))
45888>>>>>>>        Set Key_Field_State        Field Baxiokat.Baxiokat_Code   To TRUE
45889>>>>>>>
45889>>>>>>>        // Baxiokat.Baxiokat_Descr
45889>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Descr  To "œ¨ š¨˜­ã „å›¦¬ª €¥ ¦š¨á­¦¬"
45890>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Descr  To "œ¨ š¨˜­ã"
45891>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Descr  To (SL034(Self))
45892>>>>>>>
45892>>>>>>>        // Baxiokat.Baxiokat_Rec0
45892>>>>>>>        Set Field_Options          Field Baxiokat.Baxiokat_Rec0   To DD_AUTOFIND    DD_REQUIRED
45893>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Rec0   To (SL034(Self))
45894>>>>>>>        Set Key_Field_State        Field Baxiokat.Baxiokat_Rec0   To TRUE
45895>>>>>>>
45895>>>>>>>        // Baxiokat.Baxiokat_Type
45895>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Type   To "dbComboForm_EZ"
45896>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Type   To "„ ©§¨˜¡«â¦/¢ž¨à«â¦"
45897>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Type   To "„ ©./¢ã¨."
45898>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Type   To (Baxiokat_Type_VT(Self))
45899>>>>>>>
45899>>>>>>>        // Baxiokat.Baxio_Lcode
45899>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxio_Lcode     To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª €¥ ¦šá­¦¬"
45900>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxio_Lcode     To "’œ¢.€¨ Ÿ£æª"
45901>>>>>>>        //Set Field_Options          Field Baxiokat.Baxio_Lcode     To DD_DISPLAYONLY
45901>>>>>>>
45901>>>>>>>        // Baxiokat.Baxiokat_Yn5390
45901>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Yn5390 To "dbComboForm_EZ"
45902>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Yn5390 To "‹ž®˜¤¦š¨˜­ž£â¤œª „§ «˜šâª ?"
45903>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Yn5390 To "‹ž®/¡âª „§ «˜šâª"
45904>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Yn5390 To (Baxiokat_Baxiokat_Yn5390_VT(Self))
45905>>>>>>>
45905>>>>>>>        // Baxiokat.Baxiokat_Bank
45905>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Bank   To "dbComboForm_EZ"
45906>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Bank   To "’¨á§œ˜"
45907>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Bank   To "’¨á§œ˜"
45908>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Bank   To (Baxiokat_Baxiokat_Bank_VT(Self))
45909>>>>>>>
45909>>>>>>>        // Baxiokat.Baxiokat_Lno
45909>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Lno    To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª"
45910>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Lno    To "’œ¢.€¨ Ÿ£æª"
45911>>>>>>>
45911>>>>>>>        // Baxiokat.Baxiokat_Formul
45911>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Formul To "dbComboForm_EZ"
45912>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Formul To "€¢šæ¨ Ÿ£¦ª Check Digit"
45913>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Formul To "Check Digit"
45914>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Formul To (Baxiokat_Baxiokat_Formul_VT(Self))
45915>>>>>>>
45915>>>>>>>    End_Procedure    // Define_Fields
45916>>>>>>>
45916>>>>>>>
45916>>>>>>>    Procedure Field_Defaults
45917>>>>>>>        Forward Send Field_Defaults
45919>>>>>>>        //DDB-Generated-Code-Location
45919>>>>>>>        //DDB-FieldDefaultStart
45919>>>>>>>        //DDB-FieldDefaultEnd
45919>>>>>>>        Set Field_Changed_Value   Field Baxiokat.Baxiokat_Yn5390 To 0
45920>>>>>>>    End_Procedure    // Field_Defaults
45921>>>>>>>
45921>>>>>>>End_Class    // Baxiokat_DataDictionary
45922>>>>>>>//DDB-Selection-pkg-Start
45922>>>>>>>
45922>>>>>>>Use SL034.SL         // SL034
INCLUDING FILE: SL034.SL
45922>>>>>>>>>//AB/ Project SL034:BAXIOKAT
45922>>>>>>>>>//AB/ Object prj is a Lookup_Project
45922>>>>>>>>>//AB/     Set ProjectName to "SL034:BAXIOKAT"
45922>>>>>>>>>//AB/     Set ProjectFileName to "SL034.SL"
45922>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
45922>>>>>>>>>
45922>>>>>>>>>// Project Object Structure
45922>>>>>>>>>//   SL034 is a dbModalPanelSub
45922>>>>>>>>>//     Baxiokat_DD is a DataDictionary
45922>>>>>>>>>//     oSelList is a dbListSub
45922>>>>>>>>>//     oOK_bn is a ButtonSub
45922>>>>>>>>>//     oCancel_bn is a ButtonSub
45922>>>>>>>>>//     oSearch_bn is a ButtonSub
45922>>>>>>>>>
45922>>>>>>>>>// Register all objects
45922>>>>>>>>>Register_Object Baxiokat_DD
45922>>>>>>>>>Register_Object oCancel_bn
45922>>>>>>>>>Register_Object oOK_bn
45922>>>>>>>>>Register_Object oSearch_bn
45922>>>>>>>>>Register_Object oSelList
45922>>>>>>>>>Register_Object SL034
45922>>>>>>>>>
45922>>>>>>>>>
45922>>>>>>>>>//AB-IgnoreStart
45922>>>>>>>>>
45922>>>>>>>>>Use DFAllEnt.pkg
45922>>>>>>>>>Use dbList.Sub
45922>>>>>>>>>Use Button.Sub
45922>>>>>>>>>
45922>>>>>>>>>
45922>>>>>>>>>Use BAXIOKAT.DD
45922>>>>>>>>>
45922>>>>>>>>>//AB-IgnoreEnd
45922>>>>>>>>>
45922>>>>>>>>>CD_Popup_Object SL034 is a dbModalPanelSub
45941>>>>>>>>>    set label to "‰˜«žš¦¨åœª €¥ ¦š¨á­à¤" 
45942>>>>>>>>>    Set Size to 206 347
45943>>>>>>>>>    Set Location to 4 5
45944>>>>>>>>>    Set Exit_Application_Local_State to FALSE
45945>>>>>>>>>    Set Modal_State to FALSE
45946>>>>>>>>>
45946>>>>>>>>>    //AB-DDOStart
45946>>>>>>>>>
45946>>>>>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
45948>>>>>>>>>    End_Object    // Baxiokat_DD
45949>>>>>>>>>
45949>>>>>>>>>    Set Main_DD to (Baxiokat_DD(self))
45950>>>>>>>>>    Set Server to (Baxiokat_DD(self))
45951>>>>>>>>>
45951>>>>>>>>>    //AB-DDOEnd
45951>>>>>>>>>
45951>>>>>>>>>    Object oSelList is a dbListSub
45953>>>>>>>>>        Set Main_File to Baxiokat.File_Number
45954>>>>>>>>>        Set Size to 164 335
45955>>>>>>>>>        Set Location to 5 4
45956>>>>>>>>>
45956>>>>>>>>>        Begin_Row
45959>>>>>>>>>            Entry_Item Baxiokat.Baxiokat_code
45960>>>>>>>>>            Entry_Item Baxiokat.Baxiokat_descr
45961>>>>>>>>>            Entry_Item Baxiokat.Baxiokat_type
45962>>>>>>>>>            Entry_Item (Export_Code_Description(Self,2,Baxiokat.Baxiokat_type))
45963>>>>>>>>>        End_Row
45968>>>>>>>>>
45968>>>>>>>>>        Set Form_Width    item 0 to 55
45969>>>>>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
45970>>>>>>>>>
45970>>>>>>>>>        Set Form_Width    item 1 to 172
45971>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
45972>>>>>>>>>
45972>>>>>>>>>        Set Form_Width    item 2 to 16
45973>>>>>>>>>        set header_label  item 2 to "’ç§¦ª" 
45974>>>>>>>>>
45974>>>>>>>>>        Set Form_Width    item 3 to 83
45975>>>>>>>>>        set header_label  item 3 to "„ ©./¢ž¨." 
45976>>>>>>>>>
45976>>>>>>>>>    End_Object    // oSelList
45977>>>>>>>>>
45977>>>>>>>>>    Object oOK_bn is a ButtonSub
45979>>>>>>>>>        set label to "&„§ ¢¦šã" 
45980>>>>>>>>>        Set Location to 172 180
45981>>>>>>>>>
45981>>>>>>>>>        //AB-StoreStart
45981>>>>>>>>>        Procedure OnClick
45983>>>>>>>>>            Send OK To oSelList
45984>>>>>>>>>        End_Procedure
45985>>>>>>>>>        //AB-StoreEnd
45985>>>>>>>>>
45985>>>>>>>>>    End_Object    // oOK_bn
45986>>>>>>>>>
45986>>>>>>>>>    Object oCancel_bn is a ButtonSub
45988>>>>>>>>>        set label to "&€¡ç¨à©ž" 
45989>>>>>>>>>        Set Location to 172 234
45990>>>>>>>>>
45990>>>>>>>>>        //AB-StoreStart
45990>>>>>>>>>        Procedure OnClick
45992>>>>>>>>>            Send Cancel To oSelList
45993>>>>>>>>>        End_Procedure
45994>>>>>>>>>        //AB-StoreEnd
45994>>>>>>>>>
45994>>>>>>>>>    End_Object    // oCancel_bn
45995>>>>>>>>>
45995>>>>>>>>>    Object oSearch_bn is a ButtonSub
45997>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
45998>>>>>>>>>        Set Location to 172 289
45999>>>>>>>>>
45999>>>>>>>>>        //AB-StoreStart
45999>>>>>>>>>        Procedure OnClick
46001>>>>>>>>>            Send Search To oSelList
46002>>>>>>>>>        End_Procedure
46003>>>>>>>>>        //AB-StoreEnd
46003>>>>>>>>>
46003>>>>>>>>>    End_Object    // oSearch_bn
46004>>>>>>>>>
46004>>>>>>>>>
46004>>>>>>>>>    //AB-StoreStart
46004>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
46005>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
46006>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
46007>>>>>>>>>    //AB-StoreEnd
46007>>>>>>>>>
46007>>>>>>>>>CD_End_Object    // SL034
46009>>>>>>>>>>
46009>>>>>>>>>
46009>>>>>>>>>//AB/ End_Object    // prj
46009>>>>>>>
46009>>>>>>>//DDB-Selection-pkg-End
46009>>>>>>>//DDB-FileEnd
46009>>>>>Use BKINKAT.DD
INCLUDING FILE: BKINKAT.DD
46009>>>>>>>//DDB-FileStart
46009>>>>>>>//DDB-HeaderStart
46009>>>>>>>
46009>>>>>>>// File Name : BKINKAT.DD
46009>>>>>>>// Class Name: Bkinkat_DataDictionary
46009>>>>>>>// Revision  : 39
46009>>>>>>>// Version   : 2
46009>>>>>>>
46009>>>>>>>Use  Windows           // Basic Definitions
46009>>>>>>>Use  DataDict          // DataDictionary Class Definition
46009>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
46009>>>>>>>
46009>>>>>>>Open Bkinkat
46011>>>>>>>Open Bkinkath
INCLUDING FILE: BKINKATH.FD
46013>>>>>>>Open Baxiokat
46015>>>>>>>Open Btypkin
46017>>>>>>>Open Sysrecb
46019>>>>>>>Open Bmove
INCLUDING FILE: BMOVE.FD
46021>>>>>>>
46021>>>>>>>//DDB-HeaderEnd
46021>>>>>>>//DDB-ValidationStart
46021>>>>>>>
46021>>>>>>>//DDB/ ExternalValidationTable Baxio_Status_VT  Baxio.Pkg
46021>>>>>>>
46021>>>>>>>Register_Object Bkinkat_Bkinkat_Yn_New_VT
46021>>>>>>>Register_Object Baxio_Status_VT
46021>>>>>>>Register_Object Bkinkat_Baxio_Place_VT
46021>>>>>>>Use Baxio.Pkg        // Baxio_Status_VT
46021>>>>>>>
46021>>>>>>>Object Bkinkat_Bkinkat_Yn_New_VT  is a DescriptionValidationTable
46023>>>>>>>
46023>>>>>>>    Procedure Fill_List
46025>>>>>>>        Forward Send Fill_List
46027>>>>>>>        Send Add_Table_Value  "0"  "Ž® "
46028>>>>>>>        Send Add_Table_Value  "1"  "Œ˜ "
46029>>>>>>>    End_Procedure    // Fill_List
46030>>>>>>>    //DDB-ValidationCustomStart
46030>>>>>>>    //DDB-ValidationCustomEnd
46030>>>>>>>End_Object   // Bkinkat_Bkinkat_Yn_New_VT
46031>>>>>>>
46031>>>>>>>Object Bkinkat_Baxio_Place_VT  is a CodeValidationTable
46033>>>>>>>    Set Type_Value        To "BAXIOPLACE"
46034>>>>>>>    Set Allow_Blank_State To TRUE
46035>>>>>>>    //DDB-ValidationCustomStart
46035>>>>>>>    //DDB-ValidationCustomEnd
46035>>>>>>>End_Object   // Bkinkat_Baxio_Place_VT
46036>>>>>>>//DDB-ValidationEnd
46036>>>>>>>Open SysCurXr
46038>>>>>>>
46038>>>>>>>Class Bkinkat_DataDictionary  is a DataDictionary_Sec
46039>>>>>>>
46039>>>>>>>    // Creating:
46039>>>>>>>
46039>>>>>>>    Procedure Creating
46040>>>>>>>        Forward Send Creating
46042>>>>>>>        // Insert Code Here
46042>>>>>>>        Move (Append('',((Trim(SysCurXr.Branch_Site))+;                         (Trim(String(Bkinkat.Bkinkat_Rec0)))))) to Bkinkat.Bkinkat_Recr
46043>>>>>>>    End_Procedure   // Creating
46044>>>>>>>
46044>>>>>>>      //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
46044>>>>>>>      //™) ˜¤áš¤à©ž properties
46044>>>>>>>      //š) › ˜®œå¨ ©ž calculated §œ›åà¤
46044>>>>>>>      //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
46044>>>>>>>      //œ) œ¤ž£â¨à©ž properties after
46044>>>>>>>      Procedure Update
46045>>>>>>>                Forward Send Update
46047>>>>>>>
46047>>>>>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
46047>>>>>>>                Move Syscurxr.Company_Code  to Bkinkat.Company_Code
46048>>>>>>>                Move Syscurxr.Branch_Code   to Bkinkat.Branch_Code
46049>>>>>>>                Move Syscurxr.Year_Year     to Bkinkat.Year_Year
46050>>>>>>>                Move Btypkin.Btypkin_Code   to Bkinkat.Btypkin_Code
46051>>>>>>>                Move Baxiokat.Baxiokat_Code to Bkinkat.Baxiokat_Code
46052>>>>>>>
46052>>>>>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
46052>>>>>>>                //š.1:baxio_stat_from + baxio_plac_from:
46052>>>>>>>                //    æ«˜¤ ›ž£ ¦¬¨š¦ç£œ ¤â¦ ˜¥ æš¨˜­¦,
46052>>>>>>>                //    §¨¦­˜¤éª "â¨®œ«˜ " ˜§¦ «¦ §¦¬Ÿœ¤á !
46052>>>>>>>                //    ¡˜  â®œ  ¡˜«á©«˜©ž 1
46052>>>>>>>                If (Bkinkat.Bkinkat_Yn_New = 1);                Begin
46054>>>>>>>                     Move 1 to Bkinkat.Baxio_Stat_From //¡˜«á©«˜ž ˜§æ = œ¡¡¨œ£âª
46055>>>>>>>                     Move 0 to Bkinkat.Baxio_Plac_From //¤â¦ ˜¥ æš¨˜­¦
46056>>>>>>>                End
46056>>>>>>>>
46056>>>>>>>                Else;                Begin //©«ã¤ ˜¤«åŸœ«ž §œ¨å§«à©ž, §¨â§œ  «˜ 2 §œ›å˜ ¤˜ œå¤˜  > 0
46057>>>>>>>                     //If (Not(Bkinkat.Baxio_Stat_From > 0)) Send Operation_Not_Allowed 3001 //¡˜«á©«˜ž ˜§æ = œ¡¡¨œ£âª
46057>>>>>>>                     If (Not(Bkinkat.Baxio_Plac_From > 0)) Send Operation_Not_Allowed 3001 //«¦ ¬§á¨®¦¤ ˜¥ æš¨˜­¦ §¨â§œ  ¡á§¦¬ ¤˜ ™¨å©¡œ«˜ 
46060>>>>>>>                End
46060>>>>>>>>
46060>>>>>>>
46060>>>>>>>                //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ btypkin
46060>>>>>>>                Add 1 to   Btypkin.Bkinkat_Num
46061>>>>>>>
46061>>>>>>>                //Move BkinKat.BkinKat_Rec0   to BkinKat.BkinKat_code
46061>>>>>>>      End_Procedure   //update
46062>>>>>>>
46062>>>>>>>
46062>>>>>>>      Procedure Backout
46063>>>>>>>                Forward Send Backout
46065>>>>>>>
46065>>>>>>>                //œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ Btypkin
46065>>>>>>>                Sub 1 from Btypkin.Bkinkat_Num
46066>>>>>>>      End_Procedure   //backout
46067>>>>>>>
46067>>>>>>>
46067>>>>>>>      Procedure Operation_Not_Allowed Integer iError_Num
46068>>>>>>>                String lsError_Message
46069>>>>>>>                Case Begin
46069>>>>>>>                     //˜§æ validate save
46069>>>>>>>                     Case (iError_Num = 1001)
46071>>>>>>>                     Case Break
46072>>>>>>>                     //˜§æ update
46072>>>>>>>                     Case (iError_Num = 3001)
46075>>>>>>>                          Move ("DDC 146:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n’¦ ¬§á¨®¦¤ ˜¥ æš¨˜­¦ §¨â§œ  ¡á§¦¬ ¤˜ ™¨å©¡œ«˜  !");                          to lsError_Message
46076>>>>>>>                     Case Break
46077>>>>>>>
46077>>>>>>>                     Case Else
46077>>>>>>>                          Forward Send Operation_Not_Allowed iError_Num
46079>>>>>>>                Case End
46079>>>>>>>
46079>>>>>>>                Error iError_Num lsError_Message
46080>>>>>>>>
46080>>>>>>>      End_Procedure // operation_not_allowed
46081>>>>>>>
46081>>>>>>>
46081>>>>>>>//----------------------------------------------------------------------------
46081>>>>>>>    Procedure Define_Fields
46082>>>>>>>        Forward Send Define_Fields
46084>>>>>>>        //DDB-Generated-Code-Location
46084>>>>>>>        //DDB-DefineFieldStart
46084>>>>>>>
46084>>>>>>>        Set Main_File            To Bkinkat.File_Number
46085>>>>>>>        Set Cascade_Delete_State To FALSE
46086>>>>>>>
46086>>>>>>>
46086>>>>>>>        // Child (Client) file structure................
46086>>>>>>>        Send Add_Client_File  Bkinkath.File_Number
46087>>>>>>>
46087>>>>>>>        // Parent (Server) file structure...............
46087>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
46088>>>>>>>        Send Add_Server_File  Btypkin.File_Number
46089>>>>>>>
46089>>>>>>>        // External (System) file structure.............
46089>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
46090>>>>>>>        Send Add_System_File  Bmove.File_Number  DD_LOCK_ON_ALL
46091>>>>>>>
46091>>>>>>>        Define_Auto_Increment  Sysrecb.Bkinkat_Rec0  To Bkinkat.Bkinkat_Rec0
46094>>>>>>>
46094>>>>>>>        // Field-based properties.......................
46094>>>>>>>
46094>>>>>>>        // Bkinkat.Company_Code
46094>>>>>>>
46094>>>>>>>        // Bkinkat.Branch_Code
46094>>>>>>>
46094>>>>>>>        // Bkinkat.Year_Year
46094>>>>>>>
46094>>>>>>>        // Bkinkat.Btypkin_Code
46094>>>>>>>
46094>>>>>>>        // Bkinkat.Baxiokat_Code
46094>>>>>>>
46094>>>>>>>        // Bkinkat.Bkinkat_Code
46094>>>>>>>
46094>>>>>>>        // Bkinkat.Bkinkat_Rec0
46094>>>>>>>
46094>>>>>>>        // Bkinkat.Bkinkat_Recr
46094>>>>>>>
46094>>>>>>>        // Bkinkat.Btypkin_Recr
46094>>>>>>>
46094>>>>>>>        // Bkinkat.Baxiokat_Recr
46094>>>>>>>
46094>>>>>>>        // Bkinkat.Bkinkat_Yn_New
46094>>>>>>>        Set Field_Value_Table      Field Bkinkat.Bkinkat_Yn_New To (Bkinkat_Bkinkat_Yn_New_VT(Self))
46095>>>>>>>
46095>>>>>>>        // Bkinkat.Baxio_Stat_From
46095>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Stat_From To (Baxio_Status_VT(Self))
46096>>>>>>>
46096>>>>>>>        // Bkinkat.Baxio_Stat_To
46096>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Stat_To To (Baxio_Status_VT(Self))
46097>>>>>>>
46097>>>>>>>        // Bkinkat.Baxio_Plac_From
46097>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Plac_From To (Bkinkat_Baxio_Place_VT(Self))
46098>>>>>>>
46098>>>>>>>        // Bkinkat.Baxio_Plac_To
46098>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Plac_To To (Bkinkat_Baxio_Place_VT(Self))
46099>>>>>>>
46099>>>>>>>        // Bkinkat.Bkinkat_Gplncod
46099>>>>>>>
46099>>>>>>>        //DDB-DefineFieldEnd
46099>>>>>>>
46099>>>>>>>        Set Main_File            To Bkinkat.File_Number
46100>>>>>>>        Set Cascade_Delete_State To FALSE
46101>>>>>>>
46101>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
46102>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
46103>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
46104>>>>>>>
46104>>>>>>>        // Parent (Server) file structure...............
46104>>>>>>>        Send Add_Server_File  Btypkin.File_Number
46105>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
46106>>>>>>>
46106>>>>>>>        // External (System) file structure.............
46106>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
46107>>>>>>>
46107>>>>>>>        Define_Auto_Increment  Sysrecb.Bkinkat_Rec0  To Bkinkat.Bkinkat_Rec0
46110>>>>>>>
46110>>>>>>>        // Field-based properties.......................
46110>>>>>>>
46110>>>>>>>        // Bkinkat.Btypkin_Code
46110>>>>>>>        Set Key_Field_State        Field Bkinkat.Btypkin_Code     To TRUE
46111>>>>>>>
46111>>>>>>>        // Bkinkat.Baxiokat_Code
46111>>>>>>>        Set Field_Options          Field Bkinkat.Baxiokat_Code    To DD_AUTOFIND
46112>>>>>>>        Set Key_Field_State        Field Bkinkat.Baxiokat_Code    To TRUE
46113>>>>>>>
46113>>>>>>>        // Bkinkat.Bkinkat_Rec0
46113>>>>>>>        Set Field_Options          Field Bkinkat.Bkinkat_Rec0     To DD_NOPUT
46114>>>>>>>
46114>>>>>>>        // Bkinkat.Btypkin_Rec0
46114>>>>>>>        //Set Field_Options          Field Bkinkat.Btypkin_Rec0     To DD_NOPUT
46114>>>>>>>
46114>>>>>>>        // Bkinkat.Baxiokat_Rec0
46114>>>>>>>        //Set Field_Options          Field Bkinkat.Baxiokat_Rec0    To DD_NOPUT
46114>>>>>>>
46114>>>>>>>        // Bkinkat.Bkinkat_Yn_New
46114>>>>>>>        Set Field_Class_Name       Field Bkinkat.Bkinkat_Yn_New   To "dbComboForm_EZ"
46115>>>>>>>        Set Field_Label_Long       Field Bkinkat.Bkinkat_Yn_New   To "Œâ¦ €¥ æš¨˜­¦ ?"
46116>>>>>>>        Set Field_Label_Short      Field Bkinkat.Bkinkat_Yn_New   To "Œâ¦ ?"
46117>>>>>>>        Set Field_Value_Table      Field Bkinkat.Bkinkat_Yn_New   To (Bkinkat_Bkinkat_Yn_New_VT(Self))
46118>>>>>>>
46118>>>>>>>        // Bkinkat.Baxio_Stat_From
46118>>>>>>>        Set Field_Class_Name       Field Bkinkat.Baxio_Stat_From  To "dbComboForm_EZ"
46119>>>>>>>        Set Field_Label_Long       Field Bkinkat.Baxio_Stat_From  To "‰˜«á©«˜©ž €§æ"
46120>>>>>>>        Set Field_Label_Short      Field Bkinkat.Baxio_Stat_From  To "‰˜«á©«˜©ž €§æ"
46121>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Stat_From  To (Baxio_Status_VT(Self))
46122>>>>>>>
46122>>>>>>>        // Bkinkat.Baxio_Stat_To
46122>>>>>>>        Set Field_Class_Name       Field Bkinkat.Baxio_Stat_To    To "dbComboForm_EZ"
46123>>>>>>>        Set Field_Label_Long       Field Bkinkat.Baxio_Stat_To    To "‰˜«á©«˜©ž ‘â"
46124>>>>>>>        Set Field_Label_Short      Field Bkinkat.Baxio_Stat_To    To "‰˜«á©«˜©ž ‘â"
46125>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Stat_To    To (Baxio_Status_VT(Self))
46126>>>>>>>
46126>>>>>>>        // Bkinkat.Baxio_Plac_From
46126>>>>>>>        Set Field_Class_Name       Field Bkinkat.Baxio_Plac_From  To "dbComboForm_EZ"
46127>>>>>>>        Set Field_Label_Long       Field Bkinkat.Baxio_Plac_From  To "„¬¨å¡œ«¦ ©â"
46128>>>>>>>        Set Field_Label_Short      Field Bkinkat.Baxio_Plac_From  To "„¬¨å¡œ«¦ ©â"
46129>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Plac_From  To (Bkinkat_Baxio_Place_VT(Self))
46130>>>>>>>
46130>>>>>>>        // Bkinkat.Baxio_Plac_To
46130>>>>>>>        Set Field_Class_Name       Field Bkinkat.Baxio_Plac_To    To "dbComboForm_EZ"
46131>>>>>>>        Set Field_Label_Long       Field Bkinkat.Baxio_Plac_To    To "áœ  ‘â"
46132>>>>>>>        Set Field_Label_Short      Field Bkinkat.Baxio_Plac_To    To "áœ  ‘â"
46133>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Plac_To    To (Bkinkat_Baxio_Place_VT(Self))
46134>>>>>>>
46134>>>>>>>        // Bkinkat.Bkinkat_Gplncod
46134>>>>>>>        Set Field_Label_Long       Field Bkinkat.Bkinkat_Gplncod  To "‰à› ¡æª ‚Š"
46135>>>>>>>        Set Field_Label_Short      Field Bkinkat.Bkinkat_Gplncod  To "‰à› ¡æª ‚Š"
46136>>>>>>>        //Set Field_Prompt_Object    Field Bkinkat.Bkinkat_Gplncod  To (SL056(Self))
46136>>>>>>>
46136>>>>>>>    End_Procedure    // Define_Fields
46137>>>>>>>
46137>>>>>>>
46137>>>>>>>    Procedure Field_Defaults
46138>>>>>>>        Forward Send Field_Defaults
46140>>>>>>>        //DDB-Generated-Code-Location
46140>>>>>>>        //DDB-FieldDefaultStart
46140>>>>>>>        //DDB-FieldDefaultEnd
46140>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Bkinkat_Yn_New   To 0
46141>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Baxio_Stat_From  To "1"
46142>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Baxio_Stat_To    To "1"
46143>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Baxio_Plac_From  To "1"
46144>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Baxio_Plac_To    To "1"
46145>>>>>>>    End_Procedure    // Field_Defaults
46146>>>>>>>
46146>>>>>>>End_Class    // Bkinkat_DataDictionary
46147>>>>>>>//DDB-FileEnd
46147>>>>>
46147>>>>>//AB-IgnoreEnd
46147>>>>>
46147>>>>>CD_Popup_Object sl033 is a dbModalPanelSub
46166>>>>>
46166>>>>>    //AB-StoreTopStart
46166>>>>>    Property Integer piFragmaBtypkinCode 0
46168>>>>>    
46168>>>>>    
46168>>>>>    
46168>>>>>    //AB-StoreTopEnd
46168>>>>>
46168>>>>>    Set Label to "‰˜«žš¦¨åœª ˜¥ ¦š¨á­à¤ š ˜ « ª ¡ ¤ã©œ ª"
46169>>>>>    Set Size to 206 362
46170>>>>>    Set Location to 4 5
46171>>>>>    Set Exit_Application_Local_State to FALSE
46172>>>>>    Set Modal_State to FALSE
46173>>>>>
46173>>>>>    //AB-DDOStart
46173>>>>>
46173>>>>>    Object Company_DD is a Company_DataDictionary
46175>>>>>    End_Object    // Company_DD
46176>>>>>
46176>>>>>    Object Branch_DD is a Branch_DataDictionary
46178>>>>>        Set DDO_Server to (Company_DD(self))
46179>>>>>    End_Object    // Branch_DD
46180>>>>>
46180>>>>>    Object Year_DD is a Year_DataDictionary
46182>>>>>        Set DDO_Server to (Branch_DD(self))
46183>>>>>    End_Object    // Year_DD
46184>>>>>
46184>>>>>    Object Btypkin_DD is a Btypkin_DataDictionary
46186>>>>>        Set DDO_Server to (Year_DD(self))
46187>>>>>    End_Object    // Btypkin_DD
46188>>>>>
46188>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
46190>>>>>    End_Object    // Baxiokat_DD
46191>>>>>
46191>>>>>    Object Bkinkat_DD is a Bkinkat_DataDictionary
46193>>>>>        Set DDO_Server to (Btypkin_DD(self))
46194>>>>>        Set DDO_Server to (Baxiokat_DD(self))
46195>>>>>
46195>>>>>        //AB-StoreStart
46195>>>>>                                
46195>>>>>        Procedure OnConstrain
46197>>>>>            Integer liBtypkinCode
46198>>>>>        
46198>>>>>            Get piFragmaBtypkinCode to liBtypkinCode
46199>>>>>            If (liBtypkinCode <> 0) Constrain Bkinkat.Btypkin_Code eq liBtypkinCode
46203>>>>>        End_Procedure // OnConstrain
46204>>>>>        
46204>>>>>        //AB-StoreEnd
46204>>>>>
46204>>>>>    End_Object    // Bkinkat_DD
46205>>>>>
46205>>>>>    Set Main_DD to (Bkinkat_DD(self))
46206>>>>>    Set Server to (Bkinkat_DD(self))
46207>>>>>
46207>>>>>    //AB-DDOEnd
46207>>>>>
46207>>>>>    Object oSelList is a dbListSub
46209>>>>>        Set Main_File to Bkinkat.File_Number
46210>>>>>        Set Size to 164 350
46211>>>>>        Set Location to 5 4
46212>>>>>
46212>>>>>        Begin_Row
46215>>>>>            Entry_Item Baxiokat.Baxiokat_code
46216>>>>>            Entry_Item Baxiokat.Baxiokat_descr
46217>>>>>            Entry_Item Baxiokat.Baxiokat_type
46218>>>>>            Entry_Item (Export_Code_Description(Self,2,Baxiokat.Baxiokat_type))
46219>>>>>        End_Row
46224>>>>>
46224>>>>>        Set Form_Width    item 0 to 36
46225>>>>>        Set Header_Label  item 0 to "„ ›¦ª"
46226>>>>>        
46226>>>>>        Set Form_Width    item 1 to 194
46227>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
46228>>>>>        
46228>>>>>        Set Form_Width    item 2 to 29
46229>>>>>        Set Header_Label  item 2 to "„ ©./¢ž¨."
46230>>>>>        
46230>>>>>        Set Form_Width    item 3 to 83
46231>>>>>        Set Header_Label  item 3 to "„ ©./¢ž¨."
46232>>>>>        
46232>>>>>
46232>>>>>        //AB-StoreStart
46232>>>>>                                
46232>>>>>        Property Integer piStoreFragmaBtypkinCode 0
46234>>>>>        
46234>>>>>        
46234>>>>>        Procedure Store_Defaults
46236>>>>>           Forward Send Store_Defaults
46238>>>>>           Set piStoreFragmaBtypkinCode to (piFragmaBtypkinCode(Self))
46239>>>>>        End_Procedure
46240>>>>>        
46240>>>>>        Procedure ReStore_Defaults
46242>>>>>           Forward Send ReStore_Defaults
46244>>>>>           Set piFragmaBtypkinCode to (piStoreFragmaBtypkinCode(Self))
46245>>>>>        End_Procedure
46246>>>>>        
46246>>>>>        Procedure Activating
46248>>>>>           Forward Send Activating
46250>>>>>           Send Rebuild_Constraints to Bkinkat_DD
46251>>>>>        End_Procedure
46252>>>>>        
46252>>>>>        
46252>>>>>        //AB-StoreEnd
46252>>>>>
46252>>>>>    End_Object    // oSelList
46253>>>>>
46253>>>>>    Object oOK_bn is a ButtonSub
46255>>>>>        Set Label to "&„§ ¢¦šã"
46256>>>>>        Set Location to 172 195
46257>>>>>
46257>>>>>        //AB-StoreStart
46257>>>>>        Procedure OnClick
46259>>>>>            Send OK To (oSelList(current_object))
46260>>>>>        End_Procedure
46261>>>>>        //AB-StoreEnd
46261>>>>>
46261>>>>>    End_Object    // oOK_bn
46262>>>>>
46262>>>>>    Object oCancel_bn is a ButtonSub
46264>>>>>        Set Label to "&€¡ç¨à©ž"
46265>>>>>        Set Location to 172 250
46266>>>>>
46266>>>>>        //AB-StoreStart
46266>>>>>        Procedure OnClick
46268>>>>>            Send Cancel To (oSelList(current_object))
46269>>>>>        End_Procedure
46270>>>>>        //AB-StoreEnd
46270>>>>>
46270>>>>>    End_Object    // oCancel_bn
46271>>>>>
46271>>>>>    Object oSearch_bn is a ButtonSub
46273>>>>>        Set Label to "€&¤˜ã«ž©ž"
46274>>>>>        Set Location to 172 304
46275>>>>>
46275>>>>>        //AB-StoreStart
46275>>>>>        Procedure OnClick
46277>>>>>            Send Search To (oSelList(current_object))
46278>>>>>        End_Procedure
46279>>>>>        //AB-StoreEnd
46279>>>>>
46279>>>>>    End_Object    // oSearch_bn
46280>>>>>
46280>>>>>
46280>>>>>    //AB-StoreStart
46280>>>>>    
46280>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
46281>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
46282>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
46283>>>>>    
46283>>>>>    
46283>>>>>    
46283>>>>>    
46283>>>>>    //AB-StoreEnd
46283>>>>>
46283>>>>>CD_End_Object    // sl033
46285>>>>>>
46285>>>>>
46285>>>>>//AB/ End_Object    // prj
46285>>>Use sl034.sl
46285>>>Use sl036.sl
INCLUDING FILE: SL036.SL
46285>>>>>//AB/ Project SL036:BARTICL
46285>>>>>//AB/     Object prj is a Lookup_Project
46285>>>>>//AB/         Set ProjectName to "SL036:BARTICL"
46285>>>>>//AB/         Set ProjectFileName to "SL036.SL"
46285>>>>>
46285>>>>>// Project Object Structure
46285>>>>>//   SL036 is a dbModalPanelSub
46285>>>>>//     Btypkin_DD is a DataDictionary
46285>>>>>//     Barticl_DD is a DataDictionary
46285>>>>>//     oSelList is a dbListSub
46285>>>>>//     oOK_bn is a ButtonSub
46285>>>>>//     oCancel_bn is a ButtonSub
46285>>>>>//     oSearch_bn is a ButtonSub
46285>>>>>
46285>>>>>// Register all objects
46285>>>>>Register_Object Barticl_DD
46285>>>>>Register_Object Btypkin_DD
46285>>>>>Register_Object oCancel_bn
46285>>>>>Register_Object oOK_bn
46285>>>>>Register_Object oSearch_bn
46285>>>>>Register_Object oSelList
46285>>>>>Register_Object SL036
46285>>>>>
46285>>>>>
46285>>>>>    //AB-IgnoreStart
46285>>>>>
46285>>>>>    Use DFAllEnt.pkg
46285>>>>>    Use dbList.Sub
46285>>>>>    Use Button.Sub
46285>>>>>
46285>>>>>
46285>>>>>    Use BTYPKIN.DD
46285>>>>>    Use BARTICL.DD
INCLUDING FILE: BARTICL.DD
46285>>>>>>>//DDB-FileStart
46285>>>>>>>//DDB-HeaderStart
46285>>>>>>>
46285>>>>>>>// File Name : BARTICL.DD
46285>>>>>>>// Class Name: Barticl_DataDictionary
46285>>>>>>>// Revision  : 94
46285>>>>>>>// Version   : 2
46285>>>>>>>
46285>>>>>>>Use  Windows           // Basic Definitions
46285>>>>>>>Use  DataDict          // DataDictionary Class Definition
46285>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
46285>>>>>>>
46285>>>>>>>Open Barticl
46287>>>>>>>Open Bmove
46289>>>>>>>Open Bsum
INCLUDING FILE: BSUM.FD
46291>>>>>>>Open Btypkin
46293>>>>>>>Open Sysrecb
46295>>>>>>>Open Cn
46297>>>>>>>
46297>>>>>>>//DDB-HeaderEnd
46297>>>>>>>//DDB-ValidationStart
46297>>>>>>>
46297>>>>>>>Register_Object Barticl_Barticl_M_Code_VT
46297>>>>>>>
46297>>>>>>>Object Barticl_Barticl_M_Code_VT  is a CodeValidationTable
46299>>>>>>>    Set Type_Value        To "MODULE"
46300>>>>>>>    Set Allow_Blank_State To TRUE
46301>>>>>>>    //DDB-ValidationCustomStart
46301>>>>>>>    //DDB-ValidationCustomEnd
46301>>>>>>>End_Object   // Barticl_Barticl_M_Code_VT
46302>>>>>>>//DDB-ValidationEnd
46302>>>>>>>//DDB-SelectionStart
46302>>>>>>>//DDB/ ExternalSelectionList Barticl  Barticl.SL
46302>>>>>>>//DDB/ ExternalSelectionList sl041  sl041.SL
46302>>>>>>>Register_Object Barticl
46302>>>>>>>Register_Object sl041
46302>>>>>>>//DDB-SelectionEnd
46302>>>>>>>
46302>>>>>>>Class Barticl_DataDictionary  is a DataDictionary_Sec
46303>>>>>>>
46303>>>>>>>    Procedure Shmera integer iField  Date dDate
46304>>>>>>>        Local Integer Changed
46305>>>>>>>        Get Field_Changed_State iField to Changed
46306>>>>>>>        If (Changed=0 AND dDate =0) Begin
46308>>>>>>>            SysDate4 dDate
46309>>>>>>>            Set Field_Default_Value iField to dDate
46310>>>>>>>        End
46310>>>>>>>>
46310>>>>>>>    End_Procedure   // Shmera
46311>>>>>>>
46311>>>>>>>    Procedure Save_Main_File
46312>>>>>>>        If (Barticl.Cn_Code<>'') Begin  
46314>>>>>>>            Clear Cn   
46315>>>>>>>            Move Barticl.Cn_Code to Cn.Cn_Code
46316>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code  
46317>>>>>>>>
46317>>>>>>>            Move Cn.Cn_Sls_ID     to Barticl.Sls_ID
46318>>>>>>>            Move Cn.Cn_Presp_ID   to Barticl.Presp_ID
46319>>>>>>>            Move Cn.CN_Cnt_ID     to Barticl.Cnt_ID
46320>>>>>>>        End
46320>>>>>>>>
46320>>>>>>>        Forward Send Save_Main_File
46322>>>>>>>    End_Procedure   // Save_Main_File
46323>>>>>>>
46323>>>>>>>      Procedure private.Initialize_Properties
46324>>>>>>>                 //£ž›œ¤ ©£æª §˜¢˜ é¤
46324>>>>>>>                 Set psB_Btypkin_Recr    to ''
46325>>>>>>>                 Set pdB_Barticl_Hmnia   to 0
46326>>>>>>>                 Set piB_Barticl_No      to 0
46327>>>>>>>                 Set psB_Barticl_Code1   to ""
46328>>>>>>>
46328>>>>>>>                 Set pdB_Garticl_Hmnia   to 0  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
46329>>>>>>>                 Set piB_Garticl_No      to 0
46330>>>>>>>                 Set psB_Garticl_Aitiol  to ""
46331>>>>>>>
46331>>>>>>>                 //£ž›œ¤ ©£æª ¤âà¤
46331>>>>>>>                 Set psA_Btypkin_Recr    to ''
46332>>>>>>>                 Set pdA_Barticl_Hmnia   to 0
46333>>>>>>>                 Set piA_Barticl_No      to 0
46334>>>>>>>                 Set psA_Barticl_Code1   to ""
46335>>>>>>>
46335>>>>>>>                 Set pdA_Garticl_Hmnia   to 0  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
46336>>>>>>>                 Set piA_Garticl_No      to 0
46337>>>>>>>                 Set psA_Garticl_Aitiol  to ""
46338>>>>>>>
46338>>>>>>>                 Set psB_Gplan_Code to ""
46339>>>>>>>                 Set psA_Gplan_Code to ""
46340>>>>>>>
46340>>>>>>>      End_Procedure //private.Initialize_Properties
46341>>>>>>>
46341>>>>>>>
46341>>>>>>>      Procedure Construct_Object
46342>>>>>>>                Forward Send Construct_Object
46344>>>>>>>
46344>>>>>>>                Property String  psA_Btypkin_Recr     ''
46345>>>>>>>                Property Date    pdA_Barticl_Hmnia    0
46346>>>>>>>                Property Integer piA_Barticl_No       0
46347>>>>>>>                Property String  psB_Barticl_Code1    ""
46348>>>>>>>
46348>>>>>>>                Property String  psB_Btypkin_Recr     ''
46349>>>>>>>                Property Date    pdB_Barticl_Hmnia    0
46350>>>>>>>                Property Integer piB_Barticl_No       0
46351>>>>>>>                Property String  psA_Barticl_Code1    ""
46352>>>>>>>
46352>>>>>>>                Property Date    pdA_Garticl_Hmnia    0 //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
46353>>>>>>>                Property Integer piA_Garticl_No       0
46354>>>>>>>                Property String  psA_Garticl_Aitiol   ''
46355>>>>>>>
46355>>>>>>>                Property Date    pdB_Garticl_Hmnia    0 //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
46356>>>>>>>                Property Integer piB_Garticl_No       0
46357>>>>>>>                Property String  psB_Garticl_Aitiol   ''
46358>>>>>>>
46358>>>>>>>
46358>>>>>>>                Property Integer piBaxio_dd           0 //object id «¦¬ ddo server š ˜ «¦ baxio
46359>>>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
46359>>>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ ???
46359>>>>>>>                Property Integer piBaxiokat_dd        0 //object id «¦¬ ddo server š ˜ «¦ baxio
46360>>>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
46360>>>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ ???
46360>>>>>>>                Property Integer piBmove_dd           0 //object id «¦¬ ddo server š ˜ «¦ bmove
46361>>>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
46361>>>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ cascade update
46361>>>>>>>                Property Integer piBtypkin_dd         0 //object id «¦¬ ddo server š ˜ «¦ btypkin
46362>>>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
46362>>>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ cascade update
46362>>>>>>>
46362>>>>>>>                Property String  psB_Gplan_Code
46363>>>>>>>                Property String  psA_Gplan_Code
46364>>>>>>>
46364>>>>>>>
46364>>>>>>>                Property Integer piCreated_Barticl 0 //©œ«á¨œ«˜  ©«ž¤ creating,
46365>>>>>>>                                                     //®¨ž© £¦§¦ œå«˜  ©«ž¤ update+validate_save ¡˜ 
46365>>>>>>>                                                     //£ž›œ¤åœ«˜  ©«ž¤ request_save «¦¬ bmove
46365>>>>>>>
46365>>>>>>>                Property  Integer piDo_GL_Maintainance       0 //object id «žª business process
46366>>>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «ã¤ šœ¤ ¡ã ¢¦š ©« ¡ã
46366>>>>>>>                Property  Integer piDo_CUSTOMER_Maintainance 0 //object id «žª business process
46367>>>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §œ¢á«œª
46367>>>>>>>                Property  Integer piDo_VENDOR_Maintainance   0 //object id «žª business process
46368>>>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §¨¦£žŸœ¬«âª
46368>>>>>>>      End_Procedure   //construct_object
46369>>>>>>>
46369>>>>>>>      Procedure Update
46370>>>>>>>                Integer liBAxio_dd liBaxiokat_dd
46371>>>>>>>                Forward Send Update
46373>>>>>>>
46373>>>>>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
46373>>>>>>>                Move Syscurxr.Company_Code  to Barticl.Company_Code
46374>>>>>>>                Move Syscurxr.Branch_Code   to Barticl.Branch_Code
46375>>>>>>>                Move Syscurxr.Year_Year     to Barticl.Year_Year
46376>>>>>>>                Move Btypkin.Btypkin_Code   to Barticl.Btypkin_Code
46377>>>>>>>
46377>>>>>>>
46377>>>>>>>                //™) ˜¤áš¤à©ž properties
46377>>>>>>>                Get piBaxio_dd    to liBaxio_dd    //«¦ ddo §¦¬ "©œ¨™å¨œ " «¦ baxio
46378>>>>>>>                Get piBaxiokat_dd to liBaxiokat_dd //«¦ ddo §¦¬ "©œ¨™å¨œ " «¦ baxiokat
46379>>>>>>>
46379>>>>>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
46379>>>>>>>                //š.1:btypkin.btypkin_L_Hmnia //«œ¢œ¬«˜å˜ ž£œ¨¦£ž¤å˜
46379>>>>>>>                 Move (Barticl.Barticl_Hmnia Max Btypkin.Btypkin_L_Hmnia) to Btypkin.Btypkin_L_Hmnia
46380>>>>>>>
46380>>>>>>>                Case Begin
46380>>>>>>>                    Case (Btypkin.Btypkin_Anti2 = 5) //§˜¨˜¢ã§«žª œå¤˜  ¦ å› ¦ª ¦ ©¬¤˜¢¢˜©æ£œ¤¦ª
46382>>>>>>>                        Move Barticl.Barticl_Code1 to Barticl.Barticl_Code2
46383>>>>>>>                        Move Barticl.Barticl_Epon1 to Barticl.Barticl_Epon2
46384>>>>>>>                      Case Break
46385>>>>>>>                    Case (Btypkin.Btypkin_Anti2 = (-1)) //›â¤ ¬§á¨®œ  §˜¨˜¢ã§«žª
46388>>>>>>>                        Move ""                    to Barticl.Barticl_Code2
46389>>>>>>>                        Move ""                    to Barticl.Barticl_Epon2
46390>>>>>>>                      Case Break
46391>>>>>>>                Case End
46391>>>>>>>
46391>>>>>>>
46391>>>>>>>                Case Begin
46391>>>>>>>                    Case ((Btypkin.Btypkin_Anti1=2) Or (Btypkin.Btypkin_Anti1=3))
46393>>>>>>>                        Clear Clients
46394>>>>>>>                        Move Barticl.Barticl_Code1 to Clients.Client_ID
46395>>>>>>>                        Find Eq Clients by Index.6 //Client_ID
46396>>>>>>>>
46396>>>>>>>                        If (Found = 1) Move Clients.Client_Recr to Barticl.Client_Mrecr
46399>>>>>>>                        Else Send Operation_Not_Allowed 3002 //›â¤ ™¨âŸž¡œ «¦ Master Customer_rec0, please reindex
46401>>>>>>>                      Case Break
46402>>>>>>>                Case End
46402>>>>>>>
46402>>>>>>>                If (Btypkin.Gtypkin_Code <> 0);                Begin //œá¤ ž ¡å¤ž©ž œ¤ž£œ¨é¤œ  «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã, ®¨œ á¦£˜  ¦§à›ã§¦«œ
46404>>>>>>>                      //master gplan rec0
46404>>>>>>>                      Case Begin
46404>>>>>>>                           Case (Btypkin.Btypkin_Anti1 = 1) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ š¢
46406>>>>>>>//jsjsjs 24/01/2001
46406>>>>>>>//                                Clear Gplan
46406>>>>>>>//                                Move Barticl.Company_Code  to Gplan.Company_Code
46406>>>>>>>//                                Move Barticl.Branch_Code   to Gplan.Branch_Code
46406>>>>>>>//                                Move Barticl.Year_Year     to Gplan.Year_Year
46406>>>>>>>//                                Move Barticl.Barticl_Code1 to Gplan.Gplan_Code
46406>>>>>>>//                                Find Eq Gplan by Index.1 //company_code+branch_code+year_year+Gplan_code
46406>>>>>>>//                                If (Found = 1) Move Gplan.Gplan_Rec0 to Barticl.Gplan_Mrec0
46406>>>>>>>//                                Else           Send Operation_Not_Allowed 3001 //›â¤ ™¨âŸž¡œ «¦ Master Gplan_rec0
46406>>>>>>>//jsjsjs 24/01/2001
46406>>>>>>>                           Case Break
46407>>>>>>>                           Case Else                        //=4 ¢¦ §¦å:©¬¤˜¢¢˜©æ£œ¤¦ª £œ user manual data entry
46407>>>>>>>                                Move 0 to Barticl.Gplan_Mrec0
46408>>>>>>>                      Case End
46408>>>>>>>                End   //please check the logic
46408>>>>>>>>
46408>>>>>>>
46408>>>>>>>
46408>>>>>>>                //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
46408>>>>>>>
46408>>>>>>>                //œ) œ¤ž£â¨à©ž properties after (˜§æ parent buffers!)
46408>>>>>>>                Set psA_Btypkin_Recr    to Btypkin.Btypkin_Recr
46409>>>>>>>                Set pdA_Barticl_Hmnia   to Barticl.Barticl_Hmnia
46410>>>>>>>                Set piA_Barticl_No      to Barticl.Barticl_No
46411>>>>>>>                Set psA_Barticl_Code1   to Barticl.Barticl_Code1
46412>>>>>>>
46412>>>>>>>                Set pdA_Garticl_Hmnia   to Barticl.Barticl_Hmnia  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
46413>>>>>>>                Set piA_Garticl_No      to Barticl.Barticl_No
46414>>>>>>>                Set psA_Garticl_Aitiol  to Barticl.Barticl_Aitiol
46415>>>>>>>
46415>>>>>>>      End_Procedure   //update
46416>>>>>>>
46416>>>>>>>
46416>>>>>>>      Procedure Backout
46417>>>>>>>                Forward Send Backout
46419>>>>>>>
46419>>>>>>>                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
46419>>>>>>>                Set psB_Btypkin_Recr    to Barticl.Btypkin_Recr
46420>>>>>>>                Set pdB_Barticl_Hmnia   to Barticl.Barticl_Hmnia
46421>>>>>>>                Set piB_Barticl_No      to Barticl.Barticl_No
46422>>>>>>>                Set psB_Barticl_Code1   to Barticl.Barticl_Code1
46423>>>>>>>
46423>>>>>>>                Set pdB_Garticl_Hmnia   to Barticl.Barticl_Hmnia  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
46424>>>>>>>                Set piB_Garticl_No      to Barticl.Barticl_No
46425>>>>>>>                Set psB_Garticl_Aitiol  to Barticl.Barticl_Aitiol
46426>>>>>>>      End_Procedure   // backout
46427>>>>>>>
46427>>>>>>>
46427>>>>>>>      Procedure Creating 
46428>>>>>>>                string sstr
46429>>>>>>>                Forward Send Creating
46431>>>>>>>
46431>>>>>>>                //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBarticl //˜¨ Ÿ£æª á¨Ÿ¨à¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
46431>>>>>>>
46431>>>>>>>            Move (Append('',((Trim(SysCurXR.Branch_Site))+;                            (Trim(String(Barticl.Barticl_Rec0)))))) to Barticl.Barticl_Recr
46432>>>>>>>
46432>>>>>>>                If (Barticl.Barticl_M_Code='') Move gs_Module_Code to Barticl.Barticl_M_Code
46435>>>>>>>
46435>>>>>>>                //************************************************************************
46435>>>>>>>                //flag 5:˜¬«æ£˜«ž ˜¨åŸ£ž©ž                                               *
46435>>>>>>>                //************************************************************************
46435>>>>>>>                If (Btypkin.Btypkin_Flag05 = TRUE);                     Begin //«¦ á¨Ÿ¨¦ â®œ  ˜¬«æ£˜«ž ˜¨åŸ£ž©ž
46437>>>>>>>                      Add 1 to Btypkin.Btypkin_L_No
46438>>>>>>>                      Move Btypkin.Btypkin_L_No  to Barticl.Barticl_No
46439>>>>>>>                     End
46439>>>>>>>>
46439>>>>>>>                Else Begin //«¦ á¨Ÿ¨¦ â®œ  ®œ ¨¦¡å¤ž«ž ˜¨åŸ£ž©ž
46440>>>>>>>                     End
46440>>>>>>>>
46440>>>>>>>                if ((btypkin.locked=1) and (barticl.barticl_hmnia ge btypkin.locked_date)) error 1966 '† ¡å¤ž©ž œå¤˜  ¡¢œ ›à£â¤ž' 
46443>>>>>>>                move '€¨.€„' To sstr 
46444>>>>>>>                Move (Append(sstr,(' '+(string(barticl.pae_arithm))+' - '+(string(Barticl.pae_hmnia))))) to sstr
46445>>>>>>>                move sstr to barticl.barticl_aitiol 
46446>>>>>>>                move 1 to barticl.ekkremes
46447>>>>>>>                
46447>>>>>>>                
46447>>>>>>>                Set piCreated_Barticl to TRUE
46448>>>>>>>      End_Procedure //creating
46449>>>>>>>
46449>>>>>>>
46449>>>>>>>      Procedure Deleting
46450>>>>>>>                Forward Send Deleting
46452>>>>>>>
46452>>>>>>>                //jsjsjs 24/01/2001 Sub 1 from Year.Year_NumBarticl //˜¨ Ÿ£æª á¨Ÿ¨à¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
46452>>>>>>>                If (Btypkin.Btypkin_L_No = Barticl.Barticl_No);                Begin //œá¤ › ˜š¨á­à «¦¤ «œ¢œ¬«˜å¦ ˜¨ Ÿ£æª !!! sos pleas check the logic!
46454>>>>>>>                  Sub 1 from Btypkin.Btypkin_L_No
46455>>>>>>>                  // js 05/09/2002
46455>>>>>>>                  Saverecord Btypkin
46456>>>>>>>                End
46456>>>>>>>>
46456>>>>>>>      End_Procedure //deleting
46457>>>>>>>
46457>>>>>>>
46457>>>>>>>      Procedure Operation_Not_Allowed Integer iError_Num
46458>>>>>>>                String lsError_Message
46459>>>>>>>                Case Begin
46459>>>>>>>                     //˜§æ validate save
46459>>>>>>>                     Case (iError_Num = 1001)
46461>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž †£œ¨¦£ž¤å˜ !\n\n‹ ¡¨æ«œ¨ž «žª œ¤á¨¥œàª ®¨ã©œàª ("+;                          (String(SysCurXr.Year_XrhshFrom))+")") to lsError_Message
46462>>>>>>>                     Case Break
46463>>>>>>>                     Case (iError_Num = 1002)
46466>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž †£œ¨¦£ž¤å˜ !\n\n‹œš˜¢ç«œ¨ž «žª ¢ã¥œàª ®¨ã©œàª ("+;                          (String(SysCurXr.Year_XrhshTo))+")") to lsError_Message
46467>>>>>>>                     Case Break
46468>>>>>>>                     Case (iError_Num = 1003)
46471>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "ƒâ¤ œ§ «¨â§œ«˜  ˜¢˜šã «ç§¦¬ ¡å¤ž©žª!");                          to lsError_Message
46472>>>>>>>                     Case Break
46473>>>>>>>                     Case (iError_Num = 1004)
46476>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n† ž£œ¨¦£ž¤å˜ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ «¦ á¨Ÿ¨¦!");                          to lsError_Message
46477>>>>>>>                     Case Break
46478>>>>>>>                     Case (iError_Num = 1005)
46481>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\nŽ ˜¨ Ÿ£æª «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ «¦ á¨Ÿ¨¦!");                          to lsError_Message
46482>>>>>>>                     Case Break
46483>>>>>>>                     Case (iError_Num = 1006)
46486>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n† ˜ « ¦¢¦šå˜ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ «¦ á¨Ÿ¨¦!");                          to lsError_Message
46487>>>>>>>                     Case Break
46488>>>>>>>                     Case (iError_Num = 1007)
46491>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n‹ž›œ¤ ¡æª ˜¨ Ÿ£æª §˜¨˜©«˜« ¡¦ç !");                          to lsError_Message
46492>>>>>>>                     Case Break
46493>>>>>>>                     Case (iError_Num = 1008)
46496>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "ƒâ¤ œ§ «¨â§œ«˜  ˜¢˜šã ©¬¤˜¢¢˜©¦£â¤¦¬!");                          to lsError_Message
46497>>>>>>>                     Case Break
46498>>>>>>>                     Case (iError_Num = 1009)
46501>>>>>>>                          Clear Codemast
46502>>>>>>>                          Move "MODULE" to Codemast.Type
46503>>>>>>>                          Move Barticl.Barticl_M_Code to Codemast.Code
46504>>>>>>>                          Find Eq Codemast by Index.1 //type+code
46505>>>>>>>>
46505>>>>>>>                          Move ("DDC 036:€›ç¤˜«ž ž „šš¨˜­ã\n\n(’¦ á¨Ÿ¨¦ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§æ "+;                          (Trim(Codemast.Description))+" )") to lsError_Message
46506>>>>>>>                     Case Break
46507>>>>>>>                     Case (iError_Num = 1011)
46510>>>>>>>                          Move ("DDC 036:€›ç¤˜«ž ž „šš¨˜­ã\n\n(ƒœ¤ â®œ  ¦¨ ©Ÿœå «¦ ¡ç¡¢à£˜!)");                          to lsError_Message
46511>>>>>>>                     Case Break
46512>>>>>>>                     Case (iError_Num = 1100)
46515>>>>>>>                          Move "DDC 036:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
46516>>>>>>>                          Case Break
46517>>>>>>>                     
46517>>>>>>>                     Case (iError_Num = 2100)
46520>>>>>>>                          Move "DDC 036:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
46521>>>>>>>                          Case Break
46522>>>>>>>
46522>>>>>>>                   //˜§æ update
46522>>>>>>>                   Case (iError_Num = 3001)
46525>>>>>>>                        Move ("DDC 036:ƒâ¤ ™¨âŸž¡œ ¦ ¡à› ¡æª "+ (Trim(Barticl.Barticl_Code1)) + " ©«ã ‚œ¤ ¡ã Š¦š ©« ¡ã !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
46526>>>>>>>                   Case Break
46527>>>>>>>                   Case (iError_Num = 3002)
46530>>>>>>>                        Move ("DDC 036:ƒâ¤ ™¨âŸž¡œ ¦ ¡à› ¡æª "+ (Trim(Barticl.Barticl_Code1)) + " ©«ã ‚œ¤ ¡ã Š¦š ©« ¡ã š ˜ «¦¤ œ¢á«ž !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
46531>>>>>>>                   Case Break
46532>>>>>>>                   Case (iError_Num = 3003)
46535>>>>>>>                        Move ("DDC 036:ƒâ¤ ™¨âŸž¡œ ¦ ¡à› ¡æª "+ (Trim(Barticl.Barticl_Code1)) + " ©«ã ‚œ¤ ¡ã Š¦š ©« ¡ã š ˜ «¦¤ ¨¦£žŸœ¬«ã !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
46536>>>>>>>                   Case Break
46537>>>>>>>
46537>>>>>>>                   Case (iError_Num = 1330)
46540>>>>>>>                          Move "DDC 036: €¨ Ÿ£æª .€.„. £ž›œ¤ ¡æª ã †£œ¨/¤å˜ .€.„. ¡œ¤ã" to lsError_Message
46541>>>>>>>                   Case Break
46542>>>>>>>
46542>>>>>>>                   Case (iError_Num = 1331)
46545>>>>>>>                          Move "DDC 036: †£œ¨/¤å˜ .€.„. ›œ¤ £§¦¨œå ¤˜ œå¤˜  > ©ã£œ¨˜" to lsError_Message
46546>>>>>>>                   Case Break
46547>>>>>>>
46547>>>>>>>                   Case (iError_Num = 1332)
46550>>>>>>>                          Move "DDC 036: †£œ¨/¤å˜ §˜¨˜©«˜« ¡¦ç ›œ¤ £§¦¨œå ¤˜ œå¤˜  > ©ã£œ¨˜" to lsError_Message
46551>>>>>>>                   Case Break
46552>>>>>>>
46552>>>>>>>                     Case Else
46552>>>>>>>                          Forward Send Operation_Not_Allowed iError_Num
46554>>>>>>>                Case End
46554>>>>>>>
46554>>>>>>>                Error iError_Num lsError_Message
46555>>>>>>>>
46555>>>>>>>      End_Procedure // operation_not_allowed
46556>>>>>>>
46556>>>>>>>      Function Validate_Save Returns Integer
46557>>>>>>>               Integer iReturnVal  
46558>>>>>>>               Date dShmera
46558>>>>>>>               Sysdate dShmera
46559>>>>>>>
46559>>>>>>>               Forward Get Validate_Save to iReturnVal
46561>>>>>>>               //Set piCreated_Barticl to 0
46561>>>>>>>
46561>>>>>>>               If (Not(iReturnVal));               Begin
46563>>>>>>>                //1001+1002:â¢œš®¦  ž£œ¨¦£ž¤å˜ª
46563>>>>>>>                If (Not(Barticl.Barticl_Hmnia >= SysCurXr.Year_XrhshFrom )) Send Operation_Not_Allowed 1001
46566>>>>>>>                If (Not(Barticl.Barticl_Hmnia <= SysCurXr.Year_XrhshTo   )) Send Operation_Not_Allowed 1002
46569>>>>>>>
46569>>>>>>>                //1007:â¢œš®¦ª ˜¨ Ÿ£¦ç §˜¨˜©«˜« ¡¦ç
46569>>>>>>>                If (Not(Barticl.Barticl_No     >  0                  )) Send Operation_Not_Allowed 1007
46572>>>>>>>                
46572>>>>>>>                
46572>>>>>>>                //1011:â¢œš®¦ª £ã ¡œ¤¦ç module œšš¨˜­ãª
46572>>>>>>>                If (Trim(Barticl.Barticl_M_Code)="")       Send Operation_Not_Allowed 1011
46575>>>>>>>                //---------«â¢¦ª œ¢âš®à¤ create & edit barticl record----------------------
46575>>>>>>>
46575>>>>>>>                //---------â¢œš®¦  create barticl record----------------------
46575>>>>>>>                //sososo £ž§àª §¨œ§œ  ¤˜ §˜ ¥à £œ «ž¤ current record ????
46575>>>>>>>                If (Barticl.Recnum =  0);                Begin //œá¤ ›ž£ ¦¬¨šé ¤â¦ record
46577>>>>>>>                End   //«â¢¦ª œ¢âš®à¤ ›ž£ ¦¬¨šå˜ª ¤â¦¬ barticl record
46577>>>>>>>>
46577>>>>>>>
46577>>>>>>>                //---------â¢œš®¦  editing existing barticl records-------------------
46577>>>>>>>                Else;                Begin //edit an existing record
46578>>>>>>>                      //1003:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent btypkin record
46578>>>>>>>                      If (Not;                          ((psB_Btypkin_Recr(Self)) = Btypkin.Btypkin_Recr);                         )                                              Send Operation_Not_Allowed 1003
46581>>>>>>>                      //1004:«¨¦§¦§¦åž©ž (edit) barticl_hmnia £æ¤¦¤ ˜§æ barticl_dd
46581>>>>>>>                      If (;                           ((pdB_Barticl_Hmnia(Self))     <> Barticl.Barticl_Hmnia) and;                           ((Main_File(OPERATION_ORIGIN)) <> Barticl.File_Number);                         )                                              Send Operation_Not_Allowed 1004
46584>>>>>>>                      //1005:«¨¦§¦§¦åž©ž (edit) barticl_no £æ¤¦¤ ˜§æ barticl_dd
46584>>>>>>>                      If (;                           ((piB_Barticl_No   (Self))     <> Barticl.Barticl_No) and;                           ((Main_File(OPERATION_ORIGIN)) <> Barticl.File_Number);                         )                                              Send Operation_Not_Allowed 1005
46587>>>>>>>
46587>>>>>>>
46587>>>>>>>                      //1006:«¨¦§¦§¦åž©ž (edit) barticl_aitiol £æ¤¦¤ ˜§æ barticl_dd
46587>>>>>>>                      If (;                           ((psB_Garticl_Aitiol(Self))    <> Barticl.Barticl_Aitiol) and;                           ((Main_File(OPERATION_ORIGIN)) <> Barticl.File_Number) ;                         )                                              Send Operation_Not_Allowed 1006
46590>>>>>>>
46590>>>>>>>
46590>>>>>>>
46590>>>>>>>                      //1008:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã barticl_code1 (©¬¤˜¢¢˜©¦£â¤¦¬)
46590>>>>>>>                      If (Not;                          ((psB_Barticl_Code1(Self)) = Barticl.Barticl_Code1);                         )                                              Send Operation_Not_Allowed 1008
46593>>>>>>>                End   //«â¢¦ª œ¢âš®à¤ editing existing barticl record
46593>>>>>>>>
46593>>>>>>>                If ( ;                    (Not(Barticl.Company_Code = Syscurxr.Company_Code)) or;                    (Not(Barticl.Branch_Code  = Syscurxr.Branch_Code )) or;                    (Not(Barticl.Year_Year    = Syscurxr.Year_Year   ));                    )                                                   Send Operation_Not_Allowed 1100
46596>>>>>>>
46596>>>>>>>               End //«â¢¦ª ¡é› ¡˜ validation         
46596>>>>>>>>
46596>>>>>>>               
46596>>>>>>>                If (sysfile.serial_number='1') Begin
46598>>>>>>>                    If ((Barticl.PAE_Arithm=0) Or (Barticl.PAE_Hmnia=""))   Send Operation_Not_Allowed 1330
46601>>>>>>>                    If (Barticl.PAE_Hmnia>dShmera)                          Send Operation_Not_Allowed 1331
46604>>>>>>>                End
46604>>>>>>>>
46604>>>>>>>
46604>>>>>>>                If (Barticl.Barticl_Hmnia>dShmera)                          Send Operation_Not_Allowed 1332
46607>>>>>>>               
46607>>>>>>>               Function_Return iReturnVal
46608>>>>>>>      End_Function   // validate_save
46609>>>>>>>
46609>>>>>>>
46609>>>>>>>      Function Validate_Delete  Returns Integer
46610>>>>>>>               Integer iReturnVal
46611>>>>>>>               Forward Get Validate_Delete  To iReturnVal
46613>>>>>>>               If (Not(iReturnVal));               Begin
46615>>>>>>>                    If ( ;                        (Not(Barticl.Company_Code = Syscurxr.Company_Code)) or;                        (Not(Barticl.Branch_Code  = Syscurxr.Branch_Code )) or;                        (Not(Barticl.Year_Year    = Syscurxr.Year_Year   ));                        )                                                   Send Operation_Not_Allowed 2100
46618>>>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
46618>>>>>>>>
46618>>>>>>>               Function_Return iReturnVal
46619>>>>>>>      End_Function   // Validate_Delete
46620>>>>>>>
46620>>>>>>>
46620>>>>>>>
46620>>>>>>>      Procedure Request_Save
46621>>>>>>>               Integer liGarticl_Rec0 liCmove_Rec0 liVmove_Rec0 iErrorObj
46622>>>>>>>
46622>>>>>>>               Send private.Initialize_Properties //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties
46623>>>>>>>
46623>>>>>>>               //ž cascade update «¨â®œ  £æ¤¦¤ ©œ existing barticl records
46623>>>>>>>               //æ«˜¤ ›ž£ ¦¬¨šé ¤â¦ record, «æ«œ ›â¤ ®¨œ á¦£˜  «å§¦«˜
46623>>>>>>>               If ((Current_Record(Self)) = 0) Begin
46625>>>>>>>                    Forward Send Request_Save
46627>>>>>>>                    Send private.Initialize_Properties //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties
46628>>>>>>>                    Procedure_Return
46629>>>>>>>               End
46629>>>>>>>>
46629>>>>>>>
46629>>>>>>>               //æ«˜¤ ¡á¤à edit existing record, §¨â§œ  ¤˜ «¨â®à «ž¤ cascade update
46629>>>>>>>               //š ˜ ¤˜ â¤ž£œ¨é©à (œá¤ ­¬© ¡á ®¨œ áœ«˜ ) «˜ child bmoves
46629>>>>>>>               //£œ « ª ˜¢¢˜šâª «à¤ 3 foreign §œ›åà¤ «¦¬ barticl
46629>>>>>>>               //(btypkin_code+barticl_hmnia+barticl_no)
46629>>>>>>>               //§¨æª «¦ §˜¨æ¤ ›â¤ œ§ «¨â§œ«˜  ˜¢¢˜šã «¦¬ btypkin.
46629>>>>>>>
46629>>>>>>>               BEGIN_TRANSACTION
46630>>>>>>>               Move Error_Object_ID to iErrorObj
46631>>>>>>>               Forward Send Request_Save
46633>>>>>>>
46633>>>>>>>               //˜¤áš¤à©ž rec0's «à¤ ˜¤«å©«¦ ®à¤ articl's «à¤ ¢¦ §é¤ modules
46633>>>>>>>               Get Field_Current_Value Field Barticl.Garticl_Rec0 to liGarticl_Rec0
46634>>>>>>>               Get Field_Current_Value Field Barticl.Carticl_Rec0 to liCmove_Rec0
46635>>>>>>>               Get Field_Current_Value Field Barticl.Varticl_Rec0 to liVmove_Rec0
46636>>>>>>>
46636>>>>>>>               Send private.Transaction_Cascade_Update_Bmove //cascade œ¤ž£â¨à©ž bmove
46637>>>>>>>
46637>>>>>>>               END_TRANSACTION
46638>>>>>>>               Move iErrorObj to Error_Object_ID
46639>>>>>>>               Send private.Initialize_Properties //£ž›œ¤ ©£æª properties š ˜ œ§æ£œ¤ž ¡å¤ž©ž
46640>>>>>>>
46640>>>>>>>               //œ§˜¤˜­¦¨á «¦¬ system indicator err
46640>>>>>>>               Indicate Err False
46641>>>>>>>     End_Procedure   // request_save
46642>>>>>>>
46642>>>>>>>
46642>>>>>>>     //ž ¨¦¬«å¤˜ ˜¬«ã ˜¤˜¢˜£™á¤œ  ¤˜ ¡á¤œ  cascade update ©«¦ bmove
46642>>>>>>>     //¡˜¢œå«˜  ˜§æ «ã¤ request save, £â©˜ ˜§æ transaction, £æ¤¦¤ š ˜ existing barticl records.
46642>>>>>>>     //œ§ ©«¨â­œ  ¢áŸž :
46642>>>>>>>     Procedure private.Transaction_Cascade_Update_Bmove
46643>>>>>>>               Integer liBmove_dd
46644>>>>>>>
46644>>>>>>>               //§˜¢˜ âª ¡˜  ¤âœª « £âª «¦¬ barticl
46644>>>>>>>               String   lsB_Btypkin_Recr     lsA_Btypkin_Recr
46644>>>>>>>               Date     ldB_Barticl_Hmnia    ldA_Barticl_Hmnia
46644>>>>>>>               Integer  liB_Barticl_No       liA_Barticl_No
46644>>>>>>>
46644>>>>>>>               //˜¤áš¤à©ž §˜¢˜ é¤ « £é¤ barticl
46644>>>>>>>               Get psB_Btypkin_Recr    to lsB_Btypkin_Recr
46645>>>>>>>               Get pdB_Barticl_Hmnia   to ldB_Barticl_Hmnia
46646>>>>>>>               Get piB_Barticl_No      to liB_Barticl_No
46647>>>>>>>
46647>>>>>>>               //˜¤áš¤à©ž ¤âà¤ « £é¤ barticl
46647>>>>>>>               Get psA_Btypkin_Recr    to lsA_Btypkin_Recr
46648>>>>>>>               Get pdA_Barticl_Hmnia   to ldA_Barticl_Hmnia
46649>>>>>>>               Get piA_Barticl_No      to liA_Barticl_No
46650>>>>>>>
46650>>>>>>>               //œá¤ æ¢œª ¦  « £âª before+after œå¤˜  å©œª,
46650>>>>>>>               //«æ«œ ›â¤ £§˜å¤à ¡˜Ÿæ¢¦¬ ©«¦¤ ¡æ§¦ ¤˜ «¨â¥à,
46650>>>>>>>               //˜¢¢á ­œçšà ...«¨â®¦¤«˜ª!
46650>>>>>>>               If (;                    (lsB_Btypkin_Recr   = lsA_Btypkin_Recr   ) and;                    (ldB_Barticl_Hmnia  = ldA_Barticl_Hmnia  ) and;                    (liB_Barticl_No     = liA_Barticl_No     )    ;                   ) Begin
46652>>>>>>>                      Procedure_Return
46653>>>>>>>                     End
46653>>>>>>>>
46653>>>>>>>
46653>>>>>>>
46653>>>>>>>               //**************************************************************************
46653>>>>>>>               //02.rebuild constraints, ¢æšà «à¤ ¡¢á©œà¤
46653>>>>>>>               //**************************************************************************
46653>>>>>>>               Get piBmove_dd           to liBmove_dd
46654>>>>>>>               Send Rebuild_Constraints to (piBtypkin_dd(Self))
46655>>>>>>>               Send Rebuild_Constraints to Self
46656>>>>>>>               Send Rebuild_Constraints to (piBaxio_dd  (Self))
46657>>>>>>>               Send Rebuild_Constraints to liBmove_dd
46658>>>>>>>
46658>>>>>>>               //**************************************************************************
46658>>>>>>>               //03.©á¨à©ž Bmove
46658>>>>>>>               //**************************************************************************
46658>>>>>>>               Send Clear to liBmove_dd
46659>>>>>>>               Send Find to liBmove_dd FIRST_RECORD 3 //barticl_recr+bmove_rec0
46660>>>>>>>               While (Found=1)
46664>>>>>>>                      Send Request_Save to liBmove_dd
46665>>>>>>>                      Send Find to liBmove_dd NEXT_RECORD 3 //Barticl_recr+Bmove_rec0
46666>>>>>>>               Loop
46667>>>>>>>>
46667>>>>>>>               Send Find to liBmove_dd FIRST_RECORD 3 //barticl_rec0+bmove_rec0
46668>>>>>>>               //send check_arthro_for_ypol (› æ«  £§¦¨œå ¤˜ ˜¢¢á¥œ   ©¦« £å˜ !)
46668>>>>>>>     End_Procedure //private.transaction_cascade_update_bmove
46669>>>>>>>
46669>>>>>>>
46669>>>>>>>
46669>>>>>>>     //ž ¨¦¬«å¤˜ ˜¬«ã ˜¤˜¢˜£™á¤œ  ¤˜ œ¤ž£œ¨é©œ  æ©˜ ˜§¦ «˜ ¬§æ¢¦ §˜ 3 modules «¦¬ ©¬©«ã£˜«¦ª
46669>>>>>>>     //§¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤.
46669>>>>>>>     //¡˜¢œå«˜  ˜§æ «åª request save & delete, £â©˜ ˜§æ transaction.
46669>>>>>>>     //œ§ ©«¨â­œ  ¢áŸž :
46669>>>>>>>     Procedure private.Transaction_Update_Other_Modules Integer liGarticl_Rec0;                                                        Integer liCmove_Rec0;                                                        Integer liVmove_Rec0;                                                        Integer liMode
46670>>>>>>>
46670>>>>>>>               Integer liDo_GL_Maintainance liDo_CUSTOMER_Maintainance liDo_VENDOR_Maintainance
46671>>>>>>>               Integer liMust_Update_GL     liMust_Update_CUSTOMER     liMust_Update_VENDOR
46671>>>>>>>
46671>>>>>>>               //4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
46671>>>>>>>               Integer liFlag02 liFlag03 liFlag04 liFlag05
46671>>>>>>>
46671>>>>>>>               //œç¨œ©ž «à¤ ¢¦ §é¤ modules §¦¬ §¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤
46671>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Gtypkin_Rec0   to liMust_Update_GL
46672>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Ctypkin_Rec0   to liMust_Update_CUSTOMER
46673>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Vtypkin_Rec0   to liMust_Update_VENDOR
46674>>>>>>>
46674>>>>>>>               //˜¤áš¤à©ž «à¤ 4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
46674>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag02 to liFlag02
46675>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag03 to liFlag03
46676>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag04 to liFlag04
46677>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag05 to liFlag05
46678>>>>>>>
46678>>>>>>>     End_Procedure //private.transaction_update_other_modules
46679>>>>>>>
46679>>>>>>>
46679>>>>>>>    Procedure Define_Fields
46680>>>>>>>        Forward Send Define_Fields
46682>>>>>>>        //DDB-Generated-Code-Location
46682>>>>>>>        //DDB-DefineFieldStart
46682>>>>>>>
46682>>>>>>>        Set Main_File            To Barticl.File_Number
46683>>>>>>>        Set Cascade_Delete_State To FALSE
46684>>>>>>>
46684>>>>>>>
46684>>>>>>>        // Child (Client) file structure................
46684>>>>>>>        Send Add_Client_File  Bmove.File_Number
46685>>>>>>>        Send Add_Client_File  Bsum.File_Number
46686>>>>>>>
46686>>>>>>>        // Parent (Server) file structure...............
46686>>>>>>>        Send Add_Server_File  Btypkin.File_Number
46687>>>>>>>
46687>>>>>>>        // External (System) file structure.............
46687>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
46688>>>>>>>        Send Add_System_File  Cn.File_Number  DD_LOCK_ON_ALL
46689>>>>>>>
46689>>>>>>>        Define_Auto_Increment  Sysrecb.Barticl_Rec0  To Barticl.Barticl_Rec0
46692>>>>>>>
46692>>>>>>>        // Field-based properties.......................
46692>>>>>>>
46692>>>>>>>        // Barticl.Company_Code
46692>>>>>>>
46692>>>>>>>        // Barticl.Branch_Code
46692>>>>>>>
46692>>>>>>>        // Barticl.Year_Year
46692>>>>>>>
46692>>>>>>>        // Barticl.Btypkin_Code
46692>>>>>>>
46692>>>>>>>        // Barticl.Barticl_Hmnia
46692>>>>>>>        Set Field_Entry_msg        Field Barticl.Barticl_Hmnia To Shmera
46693>>>>>>>        Set Field_Mask_Type        Field Barticl.Barticl_Hmnia To MASK_DATE_WINDOW
46694>>>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_Hmnia To (Barticl(Self))
46695>>>>>>>
46695>>>>>>>        // Barticl.Barticl_No
46695>>>>>>>
46695>>>>>>>        // Barticl.Barticl_Rec0
46695>>>>>>>
46695>>>>>>>        // Barticl.Barticl_Recr
46695>>>>>>>
46695>>>>>>>        // Barticl.Btypkin_Recr
46695>>>>>>>
46695>>>>>>>        // Barticl.Barticl_Code1
46695>>>>>>>
46695>>>>>>>        // Barticl.Barticl_Epon1
46695>>>>>>>
46695>>>>>>>        // Barticl.Barticl_Code2
46695>>>>>>>
46695>>>>>>>        // Barticl.Barticl_Epon2
46695>>>>>>>
46695>>>>>>>        // Barticl.Barticl_Aitiol
46695>>>>>>>
46695>>>>>>>        // Barticl.Barticl_Sv2
46695>>>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Sv2 To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
46695>>>>>>>
46695>>>>>>>        // Barticl.Barticl_Sv0
46695>>>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Sv0 To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
46695>>>>>>>
46695>>>>>>>        // Barticl.Barticl_Sv00
46695>>>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Sv00 To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
46695>>>>>>>
46695>>>>>>>        // Barticl.Barticl_Svr
46695>>>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Svr To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
46695>>>>>>>
46695>>>>>>>        // Barticl.Barticl_Lines
46695>>>>>>>
46695>>>>>>>        // Barticl.Barticl_Bmovela
46695>>>>>>>
46695>>>>>>>        // Barticl.Barticl_M_Code
46695>>>>>>>        Set Field_Value_Table      Field Barticl.Barticl_M_Code To (Barticl_Barticl_M_Code_VT(Self))
46696>>>>>>>
46696>>>>>>>        // Barticl.Garticl_Rec0
46696>>>>>>>
46696>>>>>>>        // Barticl.Carticl_Rec0
46696>>>>>>>
46696>>>>>>>        // Barticl.Varticl_Rec0
46696>>>>>>>
46696>>>>>>>        // Barticl.Gmove_Mrec0
46696>>>>>>>
46696>>>>>>>        // Barticl.Gplan_Mrec0
46696>>>>>>>
46696>>>>>>>        // Barticl.Client_Mrecr
46696>>>>>>>
46696>>>>>>>        // Barticl.Barticl_Ekleise
46696>>>>>>>
46696>>>>>>>        // Barticl.Cmoves_Recr
46696>>>>>>>
46696>>>>>>>        // Barticl.Isotimia
46696>>>>>>>
46696>>>>>>>        // Barticl.Cn_Code
46696>>>>>>>        Set Field_Prompt_Object    Field Barticl.Cn_Code To (sl041(Self))
46697>>>>>>>
46697>>>>>>>        // Barticl.Cn_Descr
46697>>>>>>>
46697>>>>>>>        // Barticl.Cn_Recr
46697>>>>>>>
46697>>>>>>>        // Barticl.Sls_Id
46697>>>>>>>
46697>>>>>>>        // Barticl.Cnt_Id
46697>>>>>>>
46697>>>>>>>        // Barticl.Presp_Id
46697>>>>>>>
46697>>>>>>>        // Barticl.Se_Logik
46697>>>>>>>
46697>>>>>>>        // Barticl.Sxolia1
46697>>>>>>>
46697>>>>>>>        // Barticl.Sxolia2
46697>>>>>>>
46697>>>>>>>        // Barticl.Partl_Akyr_Recr
46697>>>>>>>
46697>>>>>>>        // Barticl.Ekkremes
46697>>>>>>>
46697>>>>>>>        // Barticl.Arith_Orist
46697>>>>>>>
46697>>>>>>>        // Barticl.Hmnia_Orist
46697>>>>>>>
46697>>>>>>>        // Barticl.Pae_Arithm
46697>>>>>>>
46697>>>>>>>        // Barticl.Pae_Hmnia
46697>>>>>>>
46697>>>>>>>        //DDB-DefineFieldEnd
46697>>>>>>>
46697>>>>>>>//        Set Main_File            To Barticl.File_Number
46697>>>>>>>
46697>>>>>>>//        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
46697>>>>>>>//        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
46697>>>>>>>//        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
46697>>>>>>>
46697>>>>>>>//        // Child (Client) file structure................
46697>>>>>>>//        Send Add_Client_File  Bsum.File_Number
46697>>>>>>>//        Send Add_Client_File  Bmove.File_Number
46697>>>>>>>
46697>>>>>>>//        // Parent (Server) file structure...............
46697>>>>>>>//        Send Add_Server_File  Btypkin.File_Number
46697>>>>>>>
46697>>>>>>>//        // External (System) file structure.............
46697>>>>>>>//        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
46697>>>>>>>//        //Send Add_System_File  Gplan.File_Number  DD_LOCK_ON_SAVE
46697>>>>>>>
46697>>>>>>>//        Define_Auto_Increment  Sysrecb.Barticl_Rec0  To Barticl.Barticl_Rec0
46697>>>>>>>
46697>>>>>>>        // Field-based properties.......................
46697>>>>>>>
46697>>>>>>>        // Barticl.Company_Code
46697>>>>>>>
46697>>>>>>>        // Barticl.Branch_Code
46697>>>>>>>
46697>>>>>>>        // Barticl.Year_Year
46697>>>>>>>
46697>>>>>>>        // Barticl.Btypkin_Code
46697>>>>>>>
46697>>>>>>>        // Barticl.Barticl_Hmnia
46697>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Hmnia    To "†£/¤å˜"
46698>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Hmnia    To "†£/¤å˜"
46699>>>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_Hmnia    To (Barticl(Self))
46700>>>>>>>
46700>>>>>>>        // Barticl.Barticl_No
46700>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_No       To "€¨ Ÿ£æª"
46701>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_No       To "€¨ Ÿ£æª"
46702>>>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_No       To (Barticl(Self))
46703>>>>>>>
46703>>>>>>>        // Barticl.Barticl_Rec0
46703>>>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_Rec0     To (Barticl(Self))
46704>>>>>>>        Set Key_Field_State        Field Barticl.Barticl_Rec0     To TRUE
46705>>>>>>>
46705>>>>>>>        // Barticl.Btypkin_Rec0
46705>>>>>>>
46705>>>>>>>        // Barticl.Barticl_Code1
46705>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Code1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª"
46706>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Code1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª"
46707>>>>>>>
46707>>>>>>>        // Barticl.Barticl_Epon1
46707>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Epon1    To "„§à¤¬£å˜"
46708>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Epon1    To "„§à¤¬£å˜"
46709>>>>>>>
46709>>>>>>>        // Barticl.Barticl_Code2
46709>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Code2    To "˜¨˜¢ã§«žª"
46710>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Code2    To "˜¨˜¢ã§«žª"
46711>>>>>>>
46711>>>>>>>        // Barticl.Barticl_Epon2
46711>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Epon2    To "„§à¤¬£å˜"
46712>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Epon2    To "„§à¤¬£å˜"
46713>>>>>>>
46713>>>>>>>        // Barticl.Barticl_Aitiol
46713>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Aitiol   To "€ « ¦¢¦šå˜"
46714>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Aitiol   To "€ « ¦¢¦šå˜"
46715>>>>>>>
46715>>>>>>>        // Barticl.Barticl_Sv2
46715>>>>>>>        Set Field_Options          Field Barticl.Barticl_Sv2      To DD_DISPLAYONLY
46716>>>>>>>
46716>>>>>>>        // Barticl.Barticl_Sv0
46716>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Sv0      To "‘ç¤¦¢˜ €¥ é¤ ‘œ ‰ç¨ ¦ Œæ£ ©£˜ •¨ã©žª"
46717>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Sv0      To "‘ç¤¦¢˜"
46718>>>>>>>        Set Field_Options          Field Barticl.Barticl_Sv0      To DD_DISPLAYONLY
46719>>>>>>>
46719>>>>>>>        // Barticl.Barticl_Sv00
46719>>>>>>>        Set Field_Options          Field Barticl.Barticl_Sv00     To DD_DISPLAYONLY
46720>>>>>>>
46720>>>>>>>        // Barticl.Barticl_Svr
46720>>>>>>>        Set Field_Options          Field Barticl.Barticl_Svr      To DD_DISPLAYONLY
46721>>>>>>>
46721>>>>>>>        // Barticl.Barticl_Lines
46721>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Lines    To "’œ£á® ˜"
46722>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Lines    To "’œ£á® ˜"
46723>>>>>>>        Set Field_Options          Field Barticl.Barticl_Lines    To DD_DISPLAYONLY
46724>>>>>>>
46724>>>>>>>        // Barticl.Barticl_Bmovela
46724>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Bmovela  To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª ‚¨˜££ãª"
46725>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Bmovela  To "’œ¢. €¨.‚¨˜££ãª"
46726>>>>>>>        Set Field_Options          Field Barticl.Barticl_Bmovela  To DD_DISPLAYONLY
46727>>>>>>>
46727>>>>>>>        // Barticl.Barticl_M_Code
46727>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_M_Code   To "Module „šš¨˜­ãª"
46728>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_M_Code   To "Module „šš¨˜­ãª"
46729>>>>>>>        Set Field_Options          Field Barticl.Barticl_M_Code   To DD_DISPLAYONLY
46730>>>>>>>        Set Field_Value_Table      Field Barticl.Barticl_M_Code   To (Barticl_Barticl_M_Code_VT(Self))
46731>>>>>>>
46731>>>>>>>        // Barticl.Garticl_Rec0
46731>>>>>>>        Set Field_Options          Field Barticl.Garticl_Rec0     To DD_DISPLAYONLY
46732>>>>>>>
46732>>>>>>>        // Barticl.Carticl_Rec0
46732>>>>>>>        Set Field_Options          Field Barticl.Carticl_Rec0     To DD_DISPLAYONLY
46733>>>>>>>
46733>>>>>>>        // Barticl.Varticl_Rec0
46733>>>>>>>        Set Field_Options          Field Barticl.Varticl_Rec0     To DD_DISPLAYONLY
46734>>>>>>>
46734>>>>>>>        // Barticl.Gmove_Mrec0
46734>>>>>>>        Set Field_Options          Field Barticl.Gmove_Mrec0      To DD_DISPLAYONLY
46735>>>>>>>
46735>>>>>>>        // Barticl.Gplan_Mrec0
46735>>>>>>>        Set Field_Options          Field Barticl.Gplan_Mrec0      To DD_DISPLAYONLY
46736>>>>>>>
46736>>>>>>>    End_Procedure    // Define_Fields
46737>>>>>>>
46737>>>>>>>
46737>>>>>>>    Procedure Field_Defaults
46738>>>>>>>        Forward Send Field_Defaults
46740>>>>>>>        //DDB-Generated-Code-Location
46740>>>>>>>        //DDB-FieldDefaultStart
46740>>>>>>>        Set Field_Changed_Value   Field Barticl.Ekkremes To 1
46741>>>>>>>        //DDB-FieldDefaultEnd
46741>>>>>>>    End_Procedure    // Field_Defaults
46742>>>>>>>
46742>>>>>>>End_Class    // Barticl_DataDictionary
46743>>>>>>>//DDB-Selection-pkg-Start
46743>>>>>>>
46743>>>>>>>Use Barticl.SL       // Barticl
INCLUDING FILE: BARTICL.SL
46743>>>>>>>>>//AB/ Project Barticl:Lookup
46743>>>>>>>>>//AB/ Object prj is a Lookup_Project
46743>>>>>>>>>//AB/     Set ProjectName to "Barticl:Lookup"
46743>>>>>>>>>//AB/     Set ProjectFileName to "Barticl.SL"
46743>>>>>>>>>
46743>>>>>>>>>// Project Object Structure
46743>>>>>>>>>//   Barticl is a dbModalPanelSub
46743>>>>>>>>>//     Btypkin_DD2 is a Btypkin_DataDictionary
46743>>>>>>>>>//     Btypkin_DD is a DataDictionary
46743>>>>>>>>>//     Barticl_DD is a DataDictionary
46743>>>>>>>>>//     Country_DD is a DataDictionary
46743>>>>>>>>>//     Towns_DD is a DataDictionary
46743>>>>>>>>>//     Cities_DD is a DataDictionary
46743>>>>>>>>>//     Areas_DD is a DataDictionary
46743>>>>>>>>>//     Payresp_DD is a DataDictionary
46743>>>>>>>>>//     Clients_DD is a DataDictionary
46743>>>>>>>>>//     oSelList is a dbListSub
46743>>>>>>>>>//     Btypkin_Btypkin_Code is a dbFormSub
46743>>>>>>>>>//     Btypkin_Btypkin_Descr is a dbFormSub
46743>>>>>>>>>//     Clients_Client_Name is a dbFormSub
46743>>>>>>>>>//     cSyDateForm1 is a cSyDateForm
46743>>>>>>>>>//     chkOpen is a CheckBoxSub
46743>>>>>>>>>//     ButtonSub1 is a ButtonSub
46743>>>>>>>>>//     oOK_bn is a ButtonSub
46743>>>>>>>>>//     oCancel_bn is a ButtonSub
46743>>>>>>>>>
46743>>>>>>>>>// Register all objects
46743>>>>>>>>>Register_Object Areas_DD
46743>>>>>>>>>Register_Object Barticl
46743>>>>>>>>>Register_Object Barticl_DD
46743>>>>>>>>>Register_Object Btypkin_Btypkin_Code
46743>>>>>>>>>Register_Object Btypkin_Btypkin_Descr
46743>>>>>>>>>Register_Object Btypkin_DD
46743>>>>>>>>>Register_Object Btypkin_DD2
46743>>>>>>>>>Register_Object ButtonSub1
46743>>>>>>>>>Register_Object Cities_DD
46743>>>>>>>>>Register_Object Clients_Client_Name
46743>>>>>>>>>Register_Object Clients_DD
46743>>>>>>>>>Register_Object Country_DD
46743>>>>>>>>>Register_Object chkOpen
46743>>>>>>>>>Register_Object cSyDateForm1
46743>>>>>>>>>Register_Object oCancel_bn
46743>>>>>>>>>Register_Object oOK_bn
46743>>>>>>>>>Register_Object oSelList
46743>>>>>>>>>Register_Object Payresp_DD
46743>>>>>>>>>Register_Object Towns_DD
46743>>>>>>>>>
46743>>>>>>>>>
46743>>>>>>>>>//AB-IgnoreStart
46743>>>>>>>>>
46743>>>>>>>>>Use DFAllEnt.pkg
46743>>>>>>>>>Use dbList.Sub
46743>>>>>>>>>Use dbForm.Sub
46743>>>>>>>>>Use cSyDateForm.Pkg
46743>>>>>>>>>Use Chkbox.Sub
46743>>>>>>>>>Use Button.Sub
46743>>>>>>>>>
46743>>>>>>>>>
46743>>>>>>>>>Use BTYPKIN.DD
46743>>>>>>>>>Use BARTICL.DD
46743>>>>>>>>>Use COUNTRY.DD
INCLUDING FILE: COUNTRY.DD
46743>>>>>>>>>>>//DDB-FileStart
46743>>>>>>>>>>>//DDB-HeaderStart
46743>>>>>>>>>>>
46743>>>>>>>>>>>// File Name : COUNTRY.DD
46743>>>>>>>>>>>// Class Name: Country_DataDictionary
46743>>>>>>>>>>>// Revision  : 3
46743>>>>>>>>>>>// Version   : 2
46743>>>>>>>>>>>
46743>>>>>>>>>>>Use  Windows           // Basic Definitions
46743>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
46743>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
46743>>>>>>>>>>>
46743>>>>>>>>>>>Open Country
46745>>>>>>>>>>>Open Towns
46747>>>>>>>>>>>
46747>>>>>>>>>>>//DDB-HeaderEnd
46747>>>>>>>>>>>//DDB-SelectionStart
46747>>>>>>>>>>>//DDB/ ExternalSelectionList sl058  sl058.SL
46747>>>>>>>>>>>Register_Object sl058
46747>>>>>>>>>>>//DDB-SelectionEnd
46747>>>>>>>>>>>
46747>>>>>>>>>>>Class Country_DataDictionary  is a DataDictionary_Sec
46748>>>>>>>>>>>
46748>>>>>>>>>>>    // Define_Fields:
46748>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
46748>>>>>>>>>>>
46748>>>>>>>>>>>    Procedure Define_Fields
46749>>>>>>>>>>>        Forward Send Define_Fields
46751>>>>>>>>>>>        //DDB-Generated-Code-Location
46751>>>>>>>>>>>        //DDB-DefineFieldStart
46751>>>>>>>>>>>
46751>>>>>>>>>>>        Set Main_File            To Country.File_Number
46752>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
46753>>>>>>>>>>>
46753>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
46754>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
46755>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
46756>>>>>>>>>>>
46756>>>>>>>>>>>        // Child (Client) file structure................
46756>>>>>>>>>>>        Send Add_Client_File  Towns.File_Number
46757>>>>>>>>>>>
46757>>>>>>>>>>>        // Field-based properties.......................
46757>>>>>>>>>>>
46757>>>>>>>>>>>        // Country.Country_Id
46757>>>>>>>>>>>        Set Field_Options          Field Country.Country_Id To DD_AUTOFIND   
46758>>>>>>>>>>>        Set Field_Prompt_Object    Field Country.Country_Id To (sl058(Self))
46759>>>>>>>>>>>
46759>>>>>>>>>>>        // Country.Country_Descr
46759>>>>>>>>>>>        Set Field_Prompt_Object    Field Country.Country_Descr To (sl058(Self))
46760>>>>>>>>>>>
46760>>>>>>>>>>>        //DDB-DefineFieldEnd
46760>>>>>>>>>>>    End_Procedure    // Define_Fields
46761>>>>>>>>>>>
46761>>>>>>>>>>>    // Field_Defaults:
46761>>>>>>>>>>>    // This procedure is used to establish default field values.
46761>>>>>>>>>>>
46761>>>>>>>>>>>    Procedure Field_Defaults
46762>>>>>>>>>>>        Forward Send Field_Defaults
46764>>>>>>>>>>>        //DDB-Generated-Code-Location
46764>>>>>>>>>>>        //DDB-FieldDefaultStart
46764>>>>>>>>>>>        //DDB-FieldDefaultEnd
46764>>>>>>>>>>>    End_Procedure    // Field_Defaults
46765>>>>>>>>>>>
46765>>>>>>>>>>>End_Class    // Country_DataDictionary
46766>>>>>>>>>>>//DDB-Selection-pkg-Start
46766>>>>>>>>>>>
46766>>>>>>>>>>>Use sl058.SL         // sl058
INCLUDING FILE: SL058.SL
46766>>>>>>>>>>>>>//AB/ Project sl058 : Countries - Xores
46766>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
46766>>>>>>>>>>>>>//AB/         Set ProjectName to "sl058 : Countries - Xores"
46766>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl058.SL"
46766>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
46766>>>>>>>>>>>>>
46766>>>>>>>>>>>>>// Project Object Structure
46766>>>>>>>>>>>>>//   sl058 is a dbModalPanelSub
46766>>>>>>>>>>>>>//     Country_DD is a DataDictionary
46766>>>>>>>>>>>>>//     oSelList is a dbListSub
46766>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
46766>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
46766>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
46766>>>>>>>>>>>>>
46766>>>>>>>>>>>>>// Register all objects
46766>>>>>>>>>>>>>Register_Object Country_DD
46766>>>>>>>>>>>>>Register_Object oCancel_bn
46766>>>>>>>>>>>>>Register_Object oOK_bn
46766>>>>>>>>>>>>>Register_Object oSearch_bn
46766>>>>>>>>>>>>>Register_Object oSelList
46766>>>>>>>>>>>>>Register_Object sl058
46766>>>>>>>>>>>>>
46766>>>>>>>>>>>>>
46766>>>>>>>>>>>>>    //AB-IgnoreStart
46766>>>>>>>>>>>>>
46766>>>>>>>>>>>>>    Use DFAllEnt.pkg
46766>>>>>>>>>>>>>    Use dbList.Sub
46766>>>>>>>>>>>>>    Use Button.Sub
46766>>>>>>>>>>>>>
46766>>>>>>>>>>>>>
46766>>>>>>>>>>>>>    Use Country.DD
46766>>>>>>>>>>>>>    
46766>>>>>>>>>>>>>    //AB-IgnoreEnd
46766>>>>>>>>>>>>>
46766>>>>>>>>>>>>>    Object sl058 is a dbModalPanelSub
46768>>>>>>>>>>>>>        Set Label to "•é¨œª"
46769>>>>>>>>>>>>>        Set Size to 148 297
46770>>>>>>>>>>>>>        Set Location to 6 10
46771>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
46772>>>>>>>>>>>>>        Set Modal_State to FALSE
46773>>>>>>>>>>>>>
46773>>>>>>>>>>>>>        //AB-DDOStart
46773>>>>>>>>>>>>>
46773>>>>>>>>>>>>>        Object Country_DD is a Country_DataDictionary
46775>>>>>>>>>>>>>        End_Object    // Country_DD
46776>>>>>>>>>>>>>
46776>>>>>>>>>>>>>        Set Main_DD to (Country_DD(self))
46777>>>>>>>>>>>>>        Set Server to (Country_DD(self))
46778>>>>>>>>>>>>>
46778>>>>>>>>>>>>>        //AB-DDOEnd
46778>>>>>>>>>>>>>
46778>>>>>>>>>>>>>        Object oSelList is a dbListSub
46780>>>>>>>>>>>>>            Set Main_File to Country.File_Number
46781>>>>>>>>>>>>>            Set Size to 105 280
46782>>>>>>>>>>>>>            Set Location to 6 6
46783>>>>>>>>>>>>>
46783>>>>>>>>>>>>>            Begin_Row
46786>>>>>>>>>>>>>                Entry_Item Country.Country_id
46787>>>>>>>>>>>>>                Entry_Item Country.Country_descr
46788>>>>>>>>>>>>>            End_Row
46793>>>>>>>>>>>>>
46793>>>>>>>>>>>>>            Set Form_Width    item 0 to 87
46794>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à›"
46795>>>>>>>>>>>>>            
46795>>>>>>>>>>>>>            Set Form_Width    item 1 to 183
46796>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
46797>>>>>>>>>>>>>            
46797>>>>>>>>>>>>>        End_Object    // oSelList
46798>>>>>>>>>>>>>
46798>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
46800>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
46801>>>>>>>>>>>>>            Set Location to 115 126
46802>>>>>>>>>>>>>
46802>>>>>>>>>>>>>            //AB-StoreStart
46802>>>>>>>>>>>>>            Procedure OnClick
46804>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
46805>>>>>>>>>>>>>            End_Procedure
46806>>>>>>>>>>>>>            //AB-StoreEnd
46806>>>>>>>>>>>>>
46806>>>>>>>>>>>>>        End_Object    // oOK_bn
46807>>>>>>>>>>>>>
46807>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
46809>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
46810>>>>>>>>>>>>>            Set Location to 115 181
46811>>>>>>>>>>>>>
46811>>>>>>>>>>>>>            //AB-StoreStart
46811>>>>>>>>>>>>>            Procedure OnClick
46813>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
46814>>>>>>>>>>>>>            End_Procedure
46815>>>>>>>>>>>>>            //AB-StoreEnd
46815>>>>>>>>>>>>>
46815>>>>>>>>>>>>>        End_Object    // oCancel_bn
46816>>>>>>>>>>>>>
46816>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
46818>>>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
46819>>>>>>>>>>>>>            Set Location to 115 236
46820>>>>>>>>>>>>>
46820>>>>>>>>>>>>>            //AB-StoreStart
46820>>>>>>>>>>>>>            Procedure OnClick
46822>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
46823>>>>>>>>>>>>>            End_Procedure
46824>>>>>>>>>>>>>            //AB-StoreEnd
46824>>>>>>>>>>>>>
46824>>>>>>>>>>>>>        End_Object    // oSearch_bn
46825>>>>>>>>>>>>>
46825>>>>>>>>>>>>>
46825>>>>>>>>>>>>>        //AB-StoreStart
46825>>>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
46826>>>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
46827>>>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
46828>>>>>>>>>>>>>        //AB-StoreEnd
46828>>>>>>>>>>>>>
46828>>>>>>>>>>>>>    End_Object    // sl058
46829>>>>>>>>>>>>>
46829>>>>>>>>>>>>>//AB/     End_Object    // prj
46829>>>>>>>>>>>
46829>>>>>>>>>>>//DDB-Selection-pkg-End
46829>>>>>>>>>>>//DDB-FileEnd
46829>>>>>>>>>Use TOWNS.DD
INCLUDING FILE: TOWNS.DD
46829>>>>>>>>>>>//DDB-FileStart
46829>>>>>>>>>>>//DDB-HeaderStart
46829>>>>>>>>>>>
46829>>>>>>>>>>>// File Name : TOWNS.DD
46829>>>>>>>>>>>// Class Name: Towns_DataDictionary
46829>>>>>>>>>>>// Revision  : 8
46829>>>>>>>>>>>// Version   : 2
46829>>>>>>>>>>>
46829>>>>>>>>>>>Use  Windows           // Basic Definitions
46829>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
46829>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
46829>>>>>>>>>>>
46829>>>>>>>>>>>Open Towns
46831>>>>>>>>>>>Open Cities
46833>>>>>>>>>>>Open Country
46835>>>>>>>>>>>
46835>>>>>>>>>>>//DDB-HeaderEnd
46835>>>>>>>>>>>//DDB-SelectionStart
46835>>>>>>>>>>>//DDB/ ExternalSelectionList sl057  sl057.SL
46835>>>>>>>>>>>Register_Object sl057
46835>>>>>>>>>>>//DDB-SelectionEnd
46835>>>>>>>>>>>
46835>>>>>>>>>>>Class Towns_DataDictionary  is a DataDictionary_Sec
46836>>>>>>>>>>>
46836>>>>>>>>>>>    Procedure Save_Main_File
46837>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
46839>>>>>>>>>>>            If Towns.Recnum Eq 0 Procedure_Return
46842>>>>>>>>>>>        End
46842>>>>>>>>>>>>
46842>>>>>>>>>>>        Forward Send Save_Main_File
46844>>>>>>>>>>>    End_Procedure
46845>>>>>>>>>>>
46845>>>>>>>>>>>
46845>>>>>>>>>>>    // Define_Fields:
46845>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
46845>>>>>>>>>>>
46845>>>>>>>>>>>    Procedure Define_Fields
46846>>>>>>>>>>>        Forward Send Define_Fields
46848>>>>>>>>>>>        //DDB-Generated-Code-Location
46848>>>>>>>>>>>        //DDB-DefineFieldStart
46848>>>>>>>>>>>
46848>>>>>>>>>>>        Set Main_File            To Towns.File_Number
46849>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
46850>>>>>>>>>>>
46850>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   to DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
46851>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD to DD_NOPUT       DD_FINDREQ    
46852>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    to DD_DISPLAYONLY
46853>>>>>>>>>>>
46853>>>>>>>>>>>        // Child (Client) file structure................
46853>>>>>>>>>>>        Send Add_Client_File  Cities.File_Number
46854>>>>>>>>>>>
46854>>>>>>>>>>>        // Parent (Server) file structure...............
46854>>>>>>>>>>>        Send Add_Server_File  Country.File_Number
46855>>>>>>>>>>>
46855>>>>>>>>>>>        // Field-based properties.......................
46855>>>>>>>>>>>
46855>>>>>>>>>>>        // Towns.Country_Id
46855>>>>>>>>>>>        Set Key_Field_State        Field Towns.Country_Id To TRUE
46856>>>>>>>>>>>
46856>>>>>>>>>>>        // Towns.Town_Id
46856>>>>>>>>>>>        Set Field_Options          Field Towns.Town_Id To DD_AUTOFIND   
46857>>>>>>>>>>>        Set Field_Prompt_Object    Field Towns.Town_Id To (sl057(Self))
46858>>>>>>>>>>>
46858>>>>>>>>>>>        // Towns.Town_Descr
46858>>>>>>>>>>>        Set Field_Prompt_Object    Field Towns.Town_Descr To (sl057(Self))
46859>>>>>>>>>>>
46859>>>>>>>>>>>        //DDB-DefineFieldEnd
46859>>>>>>>>>>>    End_Procedure    // Define_Fields
46860>>>>>>>>>>>
46860>>>>>>>>>>>    // Field_Defaults:
46860>>>>>>>>>>>    // This procedure is used to establish default field values.
46860>>>>>>>>>>>
46860>>>>>>>>>>>    Procedure Field_Defaults
46861>>>>>>>>>>>        Forward Send Field_Defaults
46863>>>>>>>>>>>        //DDB-Generated-Code-Location
46863>>>>>>>>>>>        //DDB-FieldDefaultStart
46863>>>>>>>>>>>        //DDB-FieldDefaultEnd
46863>>>>>>>>>>>    End_Procedure    // Field_Defaults
46864>>>>>>>>>>>
46864>>>>>>>>>>>End_Class    // Towns_DataDictionary
46865>>>>>>>>>>>//DDB-Selection-pkg-Start
46865>>>>>>>>>>>
46865>>>>>>>>>>>Use sl057.SL         // sl057
INCLUDING FILE: SL057.SL
46865>>>>>>>>>>>>>//AB/ Project sl057 : Towns -Nomoi - Eyr Perioxes
46865>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
46865>>>>>>>>>>>>>//AB/         Set ProjectName to "sl057 : Towns -Nomoi - Eyr Perioxes"
46865>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl057.SL"
46865>>>>>>>>>>>>>
46865>>>>>>>>>>>>>// Project Object Structure
46865>>>>>>>>>>>>>//   sl057 is a dbModalPanelSub
46865>>>>>>>>>>>>>//     Country_DD is a DataDictionary
46865>>>>>>>>>>>>>//     Towns_DD is a DataDictionary
46865>>>>>>>>>>>>>//     oSelList is a dbListSub
46865>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
46865>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
46865>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
46865>>>>>>>>>>>>>
46865>>>>>>>>>>>>>// Register all objects
46865>>>>>>>>>>>>>Register_Object Country_DD
46865>>>>>>>>>>>>>Register_Object oCancel_bn
46865>>>>>>>>>>>>>Register_Object oOK_bn
46865>>>>>>>>>>>>>Register_Object oSearch_bn
46865>>>>>>>>>>>>>Register_Object oSelList
46865>>>>>>>>>>>>>Register_Object sl057
46865>>>>>>>>>>>>>Register_Object Towns_DD
46865>>>>>>>>>>>>>
46865>>>>>>>>>>>>>
46865>>>>>>>>>>>>>    //AB-IgnoreStart
46865>>>>>>>>>>>>>
46865>>>>>>>>>>>>>    Use DFAllEnt.pkg
46865>>>>>>>>>>>>>    Use dbList.Sub
46865>>>>>>>>>>>>>    Use Button.Sub
46865>>>>>>>>>>>>>
46865>>>>>>>>>>>>>
46865>>>>>>>>>>>>>    Use COUNTRY.DD
46865>>>>>>>>>>>>>    Use TOWNS.DD
46865>>>>>>>>>>>>>    
46865>>>>>>>>>>>>>    //AB-IgnoreEnd
46865>>>>>>>>>>>>>
46865>>>>>>>>>>>>>    Object sl057 is a dbModalPanelSub
46867>>>>>>>>>>>>>        Set Label to "Œ¦£¦å - „¬¨ç«œ¨œª §œ¨ ¦®âª"
46868>>>>>>>>>>>>>        Set Size to 148 297
46869>>>>>>>>>>>>>        Set Location to 6 10
46870>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
46871>>>>>>>>>>>>>        Set Modal_State to FALSE
46872>>>>>>>>>>>>>
46872>>>>>>>>>>>>>        //AB-DDOStart
46872>>>>>>>>>>>>>
46872>>>>>>>>>>>>>        Object Country_DD is a Country_DataDictionary
46874>>>>>>>>>>>>>        End_Object    // Country_DD
46875>>>>>>>>>>>>>
46875>>>>>>>>>>>>>        Object Towns_DD is a Towns_DataDictionary
46877>>>>>>>>>>>>>            Set DDO_Server to (Country_DD(self))
46878>>>>>>>>>>>>>        End_Object    // Towns_DD
46879>>>>>>>>>>>>>
46879>>>>>>>>>>>>>        Set Main_DD to (Towns_DD(self))
46880>>>>>>>>>>>>>        Set Server to (Towns_DD(self))
46881>>>>>>>>>>>>>
46881>>>>>>>>>>>>>        //AB-DDOEnd
46881>>>>>>>>>>>>>
46881>>>>>>>>>>>>>        Object oSelList is a dbListSub
46883>>>>>>>>>>>>>            Set Main_File to Towns.File_Number
46884>>>>>>>>>>>>>            Set Size to 105 280
46885>>>>>>>>>>>>>            Set Location to 6 6
46886>>>>>>>>>>>>>
46886>>>>>>>>>>>>>            Begin_Row
46889>>>>>>>>>>>>>                Entry_Item Towns.Town_id
46890>>>>>>>>>>>>>                Entry_Item Towns.Town_descr
46891>>>>>>>>>>>>>                Entry_Item Country.Country_descr
46892>>>>>>>>>>>>>            End_Row
46897>>>>>>>>>>>>>
46897>>>>>>>>>>>>>            Set Form_Width    item 0 to 43
46898>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à›"
46899>>>>>>>>>>>>>            
46899>>>>>>>>>>>>>            Set Form_Width    item 1 to 137
46900>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
46901>>>>>>>>>>>>>            
46901>>>>>>>>>>>>>            Set Form_Width    item 2 to 94
46902>>>>>>>>>>>>>            Set Header_Label  item 2 to "•é¨˜"
46903>>>>>>>>>>>>>            
46903>>>>>>>>>>>>>        End_Object    // oSelList
46904>>>>>>>>>>>>>
46904>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
46906>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
46907>>>>>>>>>>>>>            Set Location to 115 126
46908>>>>>>>>>>>>>
46908>>>>>>>>>>>>>            //AB-StoreStart
46908>>>>>>>>>>>>>            Procedure OnClick
46910>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
46911>>>>>>>>>>>>>            End_Procedure
46912>>>>>>>>>>>>>            //AB-StoreEnd
46912>>>>>>>>>>>>>
46912>>>>>>>>>>>>>        End_Object    // oOK_bn
46913>>>>>>>>>>>>>
46913>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
46915>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
46916>>>>>>>>>>>>>            Set Location to 115 181
46917>>>>>>>>>>>>>
46917>>>>>>>>>>>>>            //AB-StoreStart
46917>>>>>>>>>>>>>            Procedure OnClick
46919>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
46920>>>>>>>>>>>>>            End_Procedure
46921>>>>>>>>>>>>>            //AB-StoreEnd
46921>>>>>>>>>>>>>
46921>>>>>>>>>>>>>        End_Object    // oCancel_bn
46922>>>>>>>>>>>>>
46922>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
46924>>>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
46925>>>>>>>>>>>>>            Set Location to 115 236
46926>>>>>>>>>>>>>
46926>>>>>>>>>>>>>            //AB-StoreStart
46926>>>>>>>>>>>>>            Procedure OnClick
46928>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
46929>>>>>>>>>>>>>            End_Procedure
46930>>>>>>>>>>>>>            //AB-StoreEnd
46930>>>>>>>>>>>>>
46930>>>>>>>>>>>>>        End_Object    // oSearch_bn
46931>>>>>>>>>>>>>
46931>>>>>>>>>>>>>
46931>>>>>>>>>>>>>        //AB-StoreStart
46931>>>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
46932>>>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
46933>>>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
46934>>>>>>>>>>>>>        //AB-StoreEnd
46934>>>>>>>>>>>>>
46934>>>>>>>>>>>>>    End_Object    // sl057
46935>>>>>>>>>>>>>
46935>>>>>>>>>>>>>//AB/     End_Object    // prj
46935>>>>>>>>>>>
46935>>>>>>>>>>>//DDB-Selection-pkg-End
46935>>>>>>>>>>>//DDB-FileEnd
46935>>>>>>>>>Use CITIES.DD
46935>>>>>>>>>Use AREAS.DD
46935>>>>>>>>>Use PAYRESP.DD
46935>>>>>>>>>Use CLIENTS.DD
46935>>>>>>>>>
46935>>>>>>>>>//AB-IgnoreEnd
46935>>>>>>>>>
46935>>>>>>>>>Object Barticl is a dbModalPanelSub
46937>>>>>>>>>
46937>>>>>>>>>    //AB-StoreTopStart
46937>>>>>>>>>                    
46937>>>>>>>>>    Property Integer    piWhat              Public  0
46939>>>>>>>>>    Property Integer    FragmaTypkinCode    Public  0
46941>>>>>>>>>    Property Integer    piIsOpen            Public  0
46943>>>>>>>>>    Property String     FragmaClientID      Public ''
46945>>>>>>>>>    Property String     FragmaClientEpon    Public ''
46947>>>>>>>>>    Property Date       FragmaHmnia         Public ''
46949>>>>>>>>>    
46949>>>>>>>>>    Object Btypkin_DD2 is a Btypkin_DataDictionary
46951>>>>>>>>>    End_Object
46952>>>>>>>>>    
46952>>>>>>>>>    
46952>>>>>>>>>    //AB-StoreTopEnd
46952>>>>>>>>>
46952>>>>>>>>>    Set Label to "‰ ¤ã©œ ª €¥ ¦š¨á­à¤"
46953>>>>>>>>>    Set Size to 289 519
46954>>>>>>>>>    Set Location to 2 5
46955>>>>>>>>>    Set Exit_Application_Local_State to FALSE
46956>>>>>>>>>    Set Modal_State to FALSE
46957>>>>>>>>>
46957>>>>>>>>>    //AB-DDOStart
46957>>>>>>>>>
46957>>>>>>>>>    Object Btypkin_DD is a Btypkin_DataDictionary
46959>>>>>>>>>    End_Object    // Btypkin_DD
46960>>>>>>>>>
46960>>>>>>>>>    Object Barticl_DD is a Barticl_DataDictionary
46962>>>>>>>>>        Set DDO_Server to (Btypkin_DD(self))
46963>>>>>>>>>
46963>>>>>>>>>        //AB-StoreStart
46963>>>>>>>>>                                                
46963>>>>>>>>>        Begin_Constraints
46965>>>>>>>>>            Integer iTypkinCode iWhat isOpen
46966>>>>>>>>>            String  sClientID sClientEpon
46966>>>>>>>>>            Date    dHmnia
46966>>>>>>>>>        
46966>>>>>>>>>            Get FragmaTypkinCode    to iTypkinCode
46967>>>>>>>>>            Get FragmaClientID      to sClientID
46968>>>>>>>>>            Get FragmaClientEpon    to sClientEpon
46969>>>>>>>>>            Get FragmaHmnia         to dHmnia
46970>>>>>>>>>            Get piIsOpen            to isOpen
46971>>>>>>>>>        
46971>>>>>>>>>            If (iTypkinCode<>'') Begin
46973>>>>>>>>>                If (sClientID<>'') Begin
46975>>>>>>>>>                    Set Ordering Of Barticl_DD to 8
46976>>>>>>>>>                    // Comp+Br+Year+Btypkin_Code+Epon1+Hmnia+Recnum
46976>>>>>>>>>                    Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
46978>>>>>>>>>                    Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
46980>>>>>>>>>                    Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
46982>>>>>>>>>                    Constrain Barticl.Btypkin_Code  Eq iTypkinCode
46984>>>>>>>>>                    Constrain Barticl.Barticl_Epon1 Eq sClientEpon
46986>>>>>>>>>                    If (dHmnia<>'') Constrain Barticl.Barticl_Hmnia Eq dHmnia
46990>>>>>>>>>                End
46990>>>>>>>>>>
46990>>>>>>>>>                Else Begin
46991>>>>>>>>>                    Set Ordering Of Barticl_DD to 11
46992>>>>>>>>>                    // Comp+Br+Year+Btypkin_Code+Hmnia+Epon1+Recnum
46992>>>>>>>>>                    Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
46994>>>>>>>>>                    Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
46996>>>>>>>>>                    Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
46998>>>>>>>>>                    Constrain Barticl.Btypkin_Code  Eq iTypkinCode
47000>>>>>>>>>                    If (dHmnia<>'') Constrain Barticl.Barticl_Hmnia Eq dHmnia
47004>>>>>>>>>                End
47004>>>>>>>>>>
47004>>>>>>>>>            End
47004>>>>>>>>>>
47004>>>>>>>>>            Else If (dHmnia<>'') Begin
47007>>>>>>>>>                Set Ordering Of Barticl_DD to 9
47008>>>>>>>>>                // Comp+Br+Year+Hmnia+Epon1+Recnum
47008>>>>>>>>>                Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
47010>>>>>>>>>                Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
47012>>>>>>>>>                Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
47014>>>>>>>>>                Constrain Barticl.Barticl_Hmnia Eq dHmnia
47016>>>>>>>>>                If (sClientID<>'') Constrain Barticl.Barticl_Epon1 Eq sClientEpon
47020>>>>>>>>>            End
47020>>>>>>>>>>
47020>>>>>>>>>            Else If (sClientID<>'') Begin
47023>>>>>>>>>                Set Ordering Of Barticl_DD to 8
47024>>>>>>>>>                // Comp+Br+Year+Epon1+Hmnia+Recnum
47024>>>>>>>>>                Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
47026>>>>>>>>>                Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
47028>>>>>>>>>                Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
47030>>>>>>>>>                Constrain Barticl.Barticl_Epon1 Eq sClientEpon
47032>>>>>>>>>            End
47032>>>>>>>>>>
47032>>>>>>>>>            Else Begin
47033>>>>>>>>>                Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
47035>>>>>>>>>                Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
47037>>>>>>>>>                Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
47039>>>>>>>>>            End
47039>>>>>>>>>>
47039>>>>>>>>>            If (isOpen) Constrain Barticl.Barticl_Ekleise NE '1'
47043>>>>>>>>>        End_Constraints
47046>>>>>>>>>        
47046>>>>>>>>>        
47046>>>>>>>>>        
47046>>>>>>>>>        
47046>>>>>>>>>        
47046>>>>>>>>>        
47046>>>>>>>>>        
47046>>>>>>>>>        
47046>>>>>>>>>        
47046>>>>>>>>>        
47046>>>>>>>>>        
47046>>>>>>>>>        
47046>>>>>>>>>        
47046>>>>>>>>>        
47046>>>>>>>>>        //AB-StoreEnd
47046>>>>>>>>>
47046>>>>>>>>>    End_Object    // Barticl_DD
47047>>>>>>>>>
47047>>>>>>>>>    Object Country_DD is a Country_DataDictionary
47049>>>>>>>>>    End_Object    // Country_DD
47050>>>>>>>>>
47050>>>>>>>>>    Object Towns_DD is a Towns_DataDictionary
47052>>>>>>>>>        Set DDO_Server to (Country_DD(self))
47053>>>>>>>>>    End_Object    // Towns_DD
47054>>>>>>>>>
47054>>>>>>>>>    Object Cities_DD is a Cities_DataDictionary
47056>>>>>>>>>        Set DDO_Server to (Towns_DD(self))
47057>>>>>>>>>    End_Object    // Cities_DD
47058>>>>>>>>>
47058>>>>>>>>>    Object Areas_DD is a Areas_DataDictionary
47060>>>>>>>>>    End_Object    // Areas_DD
47061>>>>>>>>>
47061>>>>>>>>>    Object Payresp_DD is a Payresp_DataDictionary
47063>>>>>>>>>    End_Object    // Payresp_DD
47064>>>>>>>>>
47064>>>>>>>>>    Object Clients_DD is a Clients_DataDictionary
47066>>>>>>>>>        Set DDO_Server to (Cities_DD(self))
47067>>>>>>>>>        Set DDO_Server to (Areas_DD(self))
47068>>>>>>>>>        Set DDO_Server to (Payresp_DD(self))
47069>>>>>>>>>    End_Object    // Clients_DD
47070>>>>>>>>>
47070>>>>>>>>>    Set Main_DD to (Barticl_DD(self))
47071>>>>>>>>>    Set Server to (Barticl_DD(self))
47072>>>>>>>>>
47072>>>>>>>>>    //AB-DDOEnd
47072>>>>>>>>>
47072>>>>>>>>>    Object oSelList is a dbListSub
47074>>>>>>>>>        Set Main_File to Barticl.File_Number
47075>>>>>>>>>        Set Size to 219 505
47076>>>>>>>>>        Set Location to 6 6
47077>>>>>>>>>
47077>>>>>>>>>        Begin_Row
47080>>>>>>>>>            Entry_Item Barticl.Barticl_no
47081>>>>>>>>>            Entry_Item Barticl.Arith_orist
47082>>>>>>>>>            Entry_Item Barticl.Barticl_hmnia
47083>>>>>>>>>            Entry_Item Btypkin.Btypkin_code
47084>>>>>>>>>            Entry_Item Btypkin.Btypkin_descr
47085>>>>>>>>>            Entry_Item Barticl.Barticl_code1
47086>>>>>>>>>            Entry_Item Barticl.Barticl_epon1
47087>>>>>>>>>            Entry_Item Barticl.Barticl_sv0
47088>>>>>>>>>            Entry_Item Barticl.Barticl_ekleise
47089>>>>>>>>>            Entry_Item Barticl.Isotimia
47090>>>>>>>>>        End_Row
47095>>>>>>>>>
47095>>>>>>>>>        Set Form_Width    item 0 to 47
47096>>>>>>>>>        Set Header_Label  item 0 to "€¨ Ÿ£æª"
47097>>>>>>>>>        
47097>>>>>>>>>        Set Form_Width    item 1 to 47
47098>>>>>>>>>        Set Header_Label  item 1 to "Ž¨ ©«.˜¨ Ÿ."
47099>>>>>>>>>        
47099>>>>>>>>>        Set Form_Width    item 2 to 48
47100>>>>>>>>>        Set Header_Label  item 2 to "†£œ¨/¤å˜"
47101>>>>>>>>>        
47101>>>>>>>>>        Set Form_Width    item 3 to 39
47102>>>>>>>>>        Set Header_Label  item 3 to "‰å¤ž©ž"
47103>>>>>>>>>        
47103>>>>>>>>>        Set Form_Width    item 4 to 80
47104>>>>>>>>>        Set Header_Label  item 4 to "œ¨ š¨˜­ã"
47105>>>>>>>>>        
47105>>>>>>>>>        Set Form_Width    item 5 to 55
47106>>>>>>>>>        Set Header_Label  item 5 to "‘¬¤˜¢/¤¦ª"
47107>>>>>>>>>        
47107>>>>>>>>>        Set Form_Width    item 6 to 96
47108>>>>>>>>>        Set Header_Label  item 6 to "„§à¤¬£å˜"
47109>>>>>>>>>        
47109>>>>>>>>>        Set Form_Width    item 7 to 50
47110>>>>>>>>>        Set Header_Label  item 7 to "¦©æ"
47111>>>>>>>>>        
47111>>>>>>>>>        Set Form_Width    item 8 to 16
47112>>>>>>>>>        Set Header_Label  item 8 to "‰"
47113>>>>>>>>>        Set Column_Checkbox_State  item 8 to True
47114>>>>>>>>>        
47114>>>>>>>>>        Set Form_Width    item 9 to 22
47115>>>>>>>>>        Set Header_Label  item 9 to "„¡«."
47116>>>>>>>>>        Set Column_Checkbox_State  item 9 to True
47117>>>>>>>>>        
47117>>>>>>>>>
47117>>>>>>>>>        //AB-StoreStart
47117>>>>>>>>>        
47117>>>>>>>>>        //Property Integer StoreFragmaTypkinCode  Public 0
47117>>>>>>>>>        //Property String  StoreFragmaClientID    Public ''
47117>>>>>>>>>        //Property String  StoreFragmaClientEpon  Public ''
47117>>>>>>>>>        //Property Date    StoreFragmaHmnia       Public ''
47117>>>>>>>>>        
47117>>>>>>>>>        Procedure End_Construct_Object
47119>>>>>>>>>            Integer iDecimals
47120>>>>>>>>>            Forward Send End_Construct_Object
47122>>>>>>>>>            Get fiDekadika_Nomismatos SysCurXr.C_Code0   to    iDecimals
47123>>>>>>>>>            Set Points Item 7 to iDecimals
47124>>>>>>>>>            Set Numeric_Mask Item 7 to 14 iDecimals ' ,*'
47125>>>>>>>>>        End_Procedure
47126>>>>>>>>>        
47126>>>>>>>>>        //Procedure Store_Defaults
47126>>>>>>>>>        //       Forward Send Store_Defaults
47126>>>>>>>>>        //       Set StoreFragmaTypkinCode    to (FragmaTypkinCode(Self))
47126>>>>>>>>>        //       Set StoreFragmaClientID      to (FragmaClientID  (Self))
47126>>>>>>>>>        //       Set StoreFragmaClientEpon    to (FragmaClientEpon(Self))
47126>>>>>>>>>        //       Set StoreFragmaHmnia         to (FragmaHmnia     (Self))
47126>>>>>>>>>        //End_Procedure
47126>>>>>>>>>        
47126>>>>>>>>>        //Procedure ReStore_Defaults
47126>>>>>>>>>        //       Forward Send ReStore_Defaults
47126>>>>>>>>>        //       Set FragmaTypkinCode to (StoreFragmaTypkinCode(Self))
47126>>>>>>>>>        //       Set FragmaClientID   to (StoreFragmaClientID  (Self))
47126>>>>>>>>>        //       Set FragmaClientEpon to (StoreFragmaClientEpon(Self))
47126>>>>>>>>>        //       Set FragmaHmnia      to (StoreFragmaHmnia     (Self))
47126>>>>>>>>>        //End_Procedure
47126>>>>>>>>>        
47126>>>>>>>>>        Procedure Activate
47128>>>>>>>>>            Send Keyaction to ButtonSub1
47129>>>>>>>>>            Forward Send Activate
47131>>>>>>>>>        End_procedure
47132>>>>>>>>>        
47132>>>>>>>>>        Procedure Activating
47134>>>>>>>>>            Forward Send Activating
47136>>>>>>>>>            Set Auto_Index_State to True
47137>>>>>>>>>        End_Procedure
47138>>>>>>>>>        
47138>>>>>>>>>        
47138>>>>>>>>>        //AB-StoreEnd
47138>>>>>>>>>
47138>>>>>>>>>    End_Object    // oSelList
47139>>>>>>>>>
47139>>>>>>>>>    Object Btypkin_Btypkin_Code is a dbFormSub
47141>>>>>>>>>        Entry_Item Btypkin.Btypkin_code
47142>>>>>>>>>        Set Label to "’ç§¦ª ‰å¤ž©žª"
47143>>>>>>>>>        Set Size to 13 49
47144>>>>>>>>>        Set Location to 229 84
47145>>>>>>>>>        Set Label_Col_Offset to 5
47146>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
47147>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
47148>>>>>>>>>
47148>>>>>>>>>        //AB-StoreStart
47148>>>>>>>>>                                                                                                                        
47148>>>>>>>>>        Set Server to (Btypkin_DD2(Self))
47149>>>>>>>>>        
47149>>>>>>>>>        Procedure Key Integer iKey
47151>>>>>>>>>            Integer iRetVal
47152>>>>>>>>>            Forward Send Key iKey
47154>>>>>>>>>            If (iKey=277) Send Clear to Btypkin_DD2
47157>>>>>>>>>        End_Procedure
47158>>>>>>>>>        
47158>>>>>>>>>        
47158>>>>>>>>>        //AB-StoreEnd
47158>>>>>>>>>
47158>>>>>>>>>    End_Object    // Btypkin_Btypkin_Code
47159>>>>>>>>>
47159>>>>>>>>>    Object Btypkin_Btypkin_Descr is a dbFormSub
47161>>>>>>>>>        Entry_Item Btypkin.Btypkin_descr
47162>>>>>>>>>        Set Size to 13 133
47163>>>>>>>>>        Set Location to 229 139
47164>>>>>>>>>        Set Color to clBtnFace
47165>>>>>>>>>        Set Label_Col_Offset to 2
47166>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
47167>>>>>>>>>        Set Enabled_State to FALSE
47168>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
47169>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
47170>>>>>>>>>        Set Shadow_State Item 0 to TRUE
47171>>>>>>>>>
47171>>>>>>>>>        //AB-StoreStart
47171>>>>>>>>>        Set Server to (Btypkin_DD2(Self))
47172>>>>>>>>>        
47172>>>>>>>>>        //AB-StoreEnd
47172>>>>>>>>>
47172>>>>>>>>>    End_Object    // Btypkin_Btypkin_Descr
47173>>>>>>>>>
47173>>>>>>>>>    Object Clients_Client_Name is a dbFormSub
47175>>>>>>>>>        Entry_Item Clients.Client_name
47176>>>>>>>>>        Set Server to (Clients_DD(self))
47177>>>>>>>>>        Set Label to "‘¬¤˜¢¢˜©æ£œ¤¦ª"
47178>>>>>>>>>        Set Size to 13 188
47179>>>>>>>>>        Set Location to 244 84
47180>>>>>>>>>        Set Label_Col_Offset to 5
47181>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
47182>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
47183>>>>>>>>>
47183>>>>>>>>>        //AB-StoreStart
47183>>>>>>>>>                                                                                                                        
47183>>>>>>>>>        Procedure Key Integer iKey
47185>>>>>>>>>            Integer iRetVal
47186>>>>>>>>>            Forward Send Key iKey
47188>>>>>>>>>            If (iKey=277) Send Clear to Clients_DD
47191>>>>>>>>>        End_Procedure
47192>>>>>>>>>        
47192>>>>>>>>>        //AB-StoreEnd
47192>>>>>>>>>
47192>>>>>>>>>    End_Object    // Clients_Client_Name
47193>>>>>>>>>
47193>>>>>>>>>    Object cSyDateForm1 is a cSyDateForm
47195>>>>>>>>>        Set Label to "†£œ¨¦£ž¤å˜"
47196>>>>>>>>>        Set Size to 13 66
47197>>>>>>>>>        Set Location to 258 84
47198>>>>>>>>>        Set Label_Col_Offset to 5
47199>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
47200>>>>>>>>>        Set Form_Mask Item 0 to "dd/MM/yyyy"
47201>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
47202>>>>>>>>>
47202>>>>>>>>>        //AB-StoreStart
47202>>>>>>>>>                                                                                                                        
47202>>>>>>>>>        On_Key KClear Send ClearMe
47203>>>>>>>>>        
47203>>>>>>>>>        Procedure ClearMe
47205>>>>>>>>>            Set Value Item 0 to ''
47206>>>>>>>>>        End_Procedure
47207>>>>>>>>>        
47207>>>>>>>>>        //AB-StoreEnd
47207>>>>>>>>>
47207>>>>>>>>>    End_Object    // cSyDateForm1
47208>>>>>>>>>
47208>>>>>>>>>    Object chkOpen is a CheckBoxSub
47210>>>>>>>>>        Set Label to "‹æ¤¦ ˜¤¦ ®«á"
47211>>>>>>>>>        Set Size to 10 62
47212>>>>>>>>>        Set Location to 260 156
47213>>>>>>>>>    End_Object    // chkOpen
47214>>>>>>>>>
47214>>>>>>>>>    Object ButtonSub1 is a ButtonSub
47216>>>>>>>>>        Set Label to "œ¨ æ¨ ©œ"
47217>>>>>>>>>        Set Size to 13 52
47218>>>>>>>>>        Set Location to 258 219
47219>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
47220>>>>>>>>>
47220>>>>>>>>>        //AB-StoreStart
47220>>>>>>>>>                                                        
47220>>>>>>>>>        Procedure OnClick
47222>>>>>>>>>            String  sEpon sID
47223>>>>>>>>>            Integer iTypkin isOpen
47223>>>>>>>>>            Date    dHmnia
47223>>>>>>>>>        
47223>>>>>>>>>            Get Value Of cSyDateForm1 Item 0                                  to dHmnia
47224>>>>>>>>>            Get Field_Current_Value Of Clients_DD  Field Clients.Client_ID    to sID
47225>>>>>>>>>            Get Field_Current_Value Of Clients_DD  Field Clients.Client_Name  to sEpon
47226>>>>>>>>>            Get Field_Current_Value Of Btypkin_DD2 Field Btypkin.Btypkin_Code to iTypkin
47227>>>>>>>>>        
47227>>>>>>>>>            Get Checked_State Of chkOpen to isOpen
47228>>>>>>>>>        
47228>>>>>>>>>            Set FragmaTypkinCode    to iTypkin
47229>>>>>>>>>            Set FragmaClientID      to sID
47230>>>>>>>>>            Set FragmaClientEpon    to sEpon
47231>>>>>>>>>            Set FragmaHmnia         to dHmnia
47232>>>>>>>>>            Set piIsOpen            to isOpen
47233>>>>>>>>>        
47233>>>>>>>>>            Send Rebuild_Constraints    to Barticl_DD
47234>>>>>>>>>            Send Beginning_Of_Data      to oSelList True
47235>>>>>>>>>        End_Procedure // OnClick
47236>>>>>>>>>        
47236>>>>>>>>>        
47236>>>>>>>>>        
47236>>>>>>>>>        //AB-StoreEnd
47236>>>>>>>>>
47236>>>>>>>>>    End_Object    // ButtonSub1
47237>>>>>>>>>
47237>>>>>>>>>    Object oOK_bn is a ButtonSub
47239>>>>>>>>>        Set Label to "&„§ ¢¦šã"
47240>>>>>>>>>        Set Size to 13 50
47241>>>>>>>>>        Set Location to 258 406
47242>>>>>>>>>        Set Focus_Mode to Pointer_Only
47243>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
47244>>>>>>>>>
47244>>>>>>>>>        //AB-StoreStart
47244>>>>>>>>>        Procedure OnClick
47246>>>>>>>>>            Send OK To (oSelList(current_object))
47247>>>>>>>>>        End_Procedure
47248>>>>>>>>>        //AB-StoreEnd
47248>>>>>>>>>
47248>>>>>>>>>    End_Object    // oOK_bn
47249>>>>>>>>>
47249>>>>>>>>>    Object oCancel_bn is a ButtonSub
47251>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
47252>>>>>>>>>        Set Size to 13 50
47253>>>>>>>>>        Set Location to 258 461
47254>>>>>>>>>        Set Focus_Mode to Pointer_Only
47255>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
47256>>>>>>>>>
47256>>>>>>>>>        //AB-StoreStart
47256>>>>>>>>>        Procedure OnClick
47258>>>>>>>>>            Send Cancel To (oSelList(current_object))
47259>>>>>>>>>        End_Procedure
47260>>>>>>>>>        //AB-StoreEnd
47260>>>>>>>>>
47260>>>>>>>>>    End_Object    // oCancel_bn
47261>>>>>>>>>
47261>>>>>>>>>
47261>>>>>>>>>    //AB-StoreStart
47261>>>>>>>>>                    
47261>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
47262>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
47263>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
47264>>>>>>>>>    
47264>>>>>>>>>    Set Modal_State to True
47265>>>>>>>>>    
47265>>>>>>>>>    Procedure Activate
47267>>>>>>>>>        If (FragmaTypkinCode(Self)<>0) Begin
47269>>>>>>>>>            Send Clear to Btypkin_DD2
47270>>>>>>>>>            Move (FragmaTypkinCode(Self)) to Btypkin.Btypkin_Code
47271>>>>>>>>>            Send Find to Btypkin_DD2 Eq 1
47272>>>>>>>>>        End
47272>>>>>>>>>>
47272>>>>>>>>>        Else Send Clear to Btypkin_DD2
47274>>>>>>>>>        If (FragmaClientID(Self)<>'') Begin
47276>>>>>>>>>            Send Clear to Clients_DD
47277>>>>>>>>>            Move (FragmaClientID(Self)) to Clients.Client_ID
47278>>>>>>>>>            Send Find to Clients_DD Eq 6
47279>>>>>>>>>        End
47279>>>>>>>>>>
47279>>>>>>>>>        Else Send Clear to Clients_DD
47281>>>>>>>>>        If (FragmaHmnia(Self)<>'') Set Value Of cSyDateForm1 Item 0 to (FragmaHmnia(Self))
47284>>>>>>>>>        Else                       Set Value Of cSyDateForm1 Item 0 to ''
47286>>>>>>>>>        Forward Send Activate
47288>>>>>>>>>    End_Procedure
47289>>>>>>>>>    
47289>>>>>>>>>    //AB-StoreEnd
47289>>>>>>>>>
47289>>>>>>>>>End_Object    // Barticl
47290>>>>>>>>>
47290>>>>>>>>>//AB/ End_Object    // prj
47290>>>>>>>Use sl041.SL         // sl041
47290>>>>>>>
47290>>>>>>>//DDB-Selection-pkg-End
47290>>>>>>>//DDB-FileEnd
47290>>>>>    
47290>>>>>    //AB-IgnoreEnd
47290>>>>>
47290>>>>>    Object SL036 is a dbModalPanelSub
47292>>>>>
47292>>>>>        //AB-StoreTopStart
47292>>>>>        Property String     psClientID      Public ''
47294>>>>>        Property String     psEponymo       Public ''
47296>>>>>        Property Date       pdHmnia         Public ''
47298>>>>>        Property Integer    piTypkinCode    Public  0
47300>>>>>        
47300>>>>>        
47300>>>>>        //AB-StoreTopEnd
47300>>>>>
47300>>>>>        Set Label to "‰ ¤ã©œ ª  €¥ ¦š¨á­à¤"
47301>>>>>        Set Size to 288 522
47302>>>>>        Set Location to 6 3
47303>>>>>        Set Exit_Application_Local_State to FALSE
47304>>>>>        Set Modal_State to FALSE
47305>>>>>
47305>>>>>        //AB-DDOStart
47305>>>>>
47305>>>>>        Object Btypkin_DD is a Btypkin_DataDictionary
47307>>>>>        End_Object    // Btypkin_DD
47308>>>>>
47308>>>>>        Object Barticl_DD is a Barticl_DataDictionary
47310>>>>>            Set DDO_Server to (Btypkin_DD(self))
47311>>>>>
47311>>>>>            //AB-StoreStart
47311>>>>>                                            
47311>>>>>            Begin_Constraints
47313>>>>>                String  sClientID
47314>>>>>                Date    dHmnia
47314>>>>>                Integer iTypkinCode
47314>>>>>            
47314>>>>>                Get piTypkinCode    to iTypkinCode
47315>>>>>                Get psClientID      to sClientID
47316>>>>>                Get pdHmnia         to dHmnia
47317>>>>>            
47317>>>>>                Constrain Barticl.Company_Code  Eq Syscurxr.Company_Code
47319>>>>>                Constrain Barticl.Branch_Code   Eq Syscurxr.Branch_Code
47321>>>>>                Constrain Barticl.Year_Year     Eq Syscurxr.Year_Year
47323>>>>>            
47323>>>>>                If (sClientID  <> 0) Begin
47325>>>>>                    If (iTypkinCode<> 0) Begin
47327>>>>>                        Set Ordering to 8
47328>>>>>                        Constrain Barticl.Btypkin_Code  Eq iTypkinCode
47330>>>>>                        Constrain Barticl.Barticl_Code1 Eq sClientID
47332>>>>>                    End
47332>>>>>>
47332>>>>>                    Else Begin
47333>>>>>                        Set Ordering to 10
47334>>>>>                        Constrain Barticl.Barticl_Code1 Eq sClientID
47336>>>>>                    End
47336>>>>>>
47336>>>>>                End
47336>>>>>>
47336>>>>>                Else If (dHmnia     <>'') Begin
47339>>>>>                    Set Ordering to 9
47340>>>>>                    Constrain Barticl.Barticl_Hmnia Eq dHmnia
47342>>>>>                End
47342>>>>>>
47342>>>>>                Else If (iTypkinCode<> 0) Begin
47345>>>>>                    Set Ordering to 1
47346>>>>>                    Constrain Barticl.Btypkin_Code  Eq iTypkinCode
47348>>>>>                End
47348>>>>>>
47348>>>>>            End_Constraints
47351>>>>>            
47351>>>>>            //AB-StoreEnd
47351>>>>>
47351>>>>>        End_Object    // Barticl_DD
47352>>>>>
47352>>>>>        Set Main_DD to (Barticl_DD(self))
47353>>>>>        Set Server to (Barticl_DD(self))
47354>>>>>
47354>>>>>        //AB-DDOEnd
47354>>>>>
47354>>>>>        Object oSelList is a dbListSub
47356>>>>>            Set Main_File to Barticl.File_Number
47357>>>>>            Set Server to (Btypkin_DD(self))
47358>>>>>            Set Size to 238 508
47359>>>>>            Set Location to 4 5
47360>>>>>
47360>>>>>            Begin_Row
47363>>>>>                Entry_Item Barticl.Barticl_no
47364>>>>>                Entry_Item Barticl.Arith_orist
47365>>>>>                Entry_Item Barticl.Barticl_hmnia
47366>>>>>                Entry_Item Btypkin.Btypkin_code
47367>>>>>                Entry_Item Btypkin.Btypkin_descr
47368>>>>>                Entry_Item Barticl.Barticl_epon1
47369>>>>>                Entry_Item Barticl.Barticl_sv0
47370>>>>>            End_Row
47375>>>>>
47375>>>>>            Set Form_Width    item 0 to 60
47376>>>>>            Set Header_Label  item 0 to "€¨ Ÿ£æª"
47377>>>>>            
47377>>>>>            Set Form_Width    item 1 to 60
47378>>>>>            Set Header_Label  item 1 to "Ž¨ ©«.˜¨ Ÿ."
47379>>>>>            
47379>>>>>            Set Form_Width    item 2 to 57
47380>>>>>            Set Header_Label  item 2 to "†£œ¨¦£ž¤å˜"
47381>>>>>            
47381>>>>>            Set Form_Width    item 3 to 41
47382>>>>>            Set Header_Label  item 3 to "‰å¤ž©ž"
47383>>>>>            
47383>>>>>            Set Form_Width    item 4 to 140
47384>>>>>            Set Header_Label  item 4 to "œ¨ š¨˜­ã"
47385>>>>>            
47385>>>>>            Set Form_Width    item 5 to 90
47386>>>>>            Set Header_Label  item 5 to "‘¬¤˜¢¢˜©æ£œ¤¦ª"
47387>>>>>            
47387>>>>>            Set Form_Width    item 6 to 54
47388>>>>>            Set Header_Label  item 6 to "¦©æ"
47389>>>>>            
47389>>>>>
47389>>>>>            //AB-StoreStart
47389>>>>>            
47389>>>>>            Set Numeric_mask Item 6 to 14 0 ' ,*'
47390>>>>>            
47390>>>>>            Procedure Activating
47392>>>>>                Send Rebuild_Constraints    to Barticl_DD
47393>>>>>                Send Beginning_Of_Data      to oSelList True
47394>>>>>                Forward Send Activating
47396>>>>>            End_Procedure
47397>>>>>            
47397>>>>>            
47397>>>>>            
47397>>>>>            
47397>>>>>            
47397>>>>>            
47397>>>>>            
47397>>>>>            //AB-StoreEnd
47397>>>>>
47397>>>>>        End_Object    // oSelList
47398>>>>>
47398>>>>>        Object oOK_bn is a ButtonSub
47400>>>>>            Set Label to "&„§ ¢¦šã"
47401>>>>>            Set Location to 255 354
47402>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
47403>>>>>
47403>>>>>            //AB-StoreStart
47403>>>>>            Procedure OnClick
47405>>>>>                Send OK To oSelList
47406>>>>>            End_Procedure
47407>>>>>            //AB-StoreEnd
47407>>>>>
47407>>>>>        End_Object    // oOK_bn
47408>>>>>
47408>>>>>        Object oCancel_bn is a ButtonSub
47410>>>>>            Set Label to "&€¡ç¨à©ž"
47411>>>>>            Set Location to 255 410
47412>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
47413>>>>>
47413>>>>>            //AB-StoreStart
47413>>>>>            Procedure OnClick
47415>>>>>                Send Cancel To oSelList
47416>>>>>            End_Procedure
47417>>>>>            //AB-StoreEnd
47417>>>>>
47417>>>>>        End_Object    // oCancel_bn
47418>>>>>
47418>>>>>        Object oSearch_bn is a ButtonSub
47420>>>>>            Set Label to "€&¤˜ã«ž©ž"
47421>>>>>            Set Location to 255 464
47422>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
47423>>>>>
47423>>>>>            //AB-StoreStart
47423>>>>>            Procedure OnClick
47425>>>>>                Send Search To oSelList
47426>>>>>            End_Procedure
47427>>>>>            //AB-StoreEnd
47427>>>>>
47427>>>>>        End_Object    // oSearch_bn
47428>>>>>
47428>>>>>
47428>>>>>        //AB-StoreStart
47428>>>>>        On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
47429>>>>>        On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
47430>>>>>        On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
47431>>>>>        
47431>>>>>        
47431>>>>>        
47431>>>>>        
47431>>>>>        
47431>>>>>        
47431>>>>>        
47431>>>>>        
47431>>>>>        //AB-StoreEnd
47431>>>>>
47431>>>>>    End_Object    // SL036
47432>>>>>
47432>>>>>//AB/     End_Object    // prj
47432>>>Use sl036r.sl
INCLUDING FILE: SL036R.SL
47432>>>>>//AB/ Project sl036r:Barticle with recr 1st col
47432>>>>>//AB/     Object prj is a Lookup_Project
47432>>>>>//AB/         Set ProjectName to "sl036r:Barticle with recr 1st col"
47432>>>>>//AB/         Set ProjectFileName to "sl036r.SL"
47432>>>>>//AB/         Set GenerateFileName to "NONAME"
47432>>>>>
47432>>>>>// Project Object Structure
47432>>>>>//   sl036r is a dbModalPanelSub
47432>>>>>//     Btypkin_DD is a DataDictionary
47432>>>>>//     Barticl_DD is a DataDictionary
47432>>>>>//     oSelList is a dbListSub
47432>>>>>//     oOK_bn is a ButtonSub
47432>>>>>//     oCancel_bn is a ButtonSub
47432>>>>>//     oSearch_bn is a ButtonSub
47432>>>>>
47432>>>>>// Register all objects
47432>>>>>Register_Object Barticl_DD
47432>>>>>Register_Object Btypkin_DD
47432>>>>>Register_Object oCancel_bn
47432>>>>>Register_Object oOK_bn
47432>>>>>Register_Object oSearch_bn
47432>>>>>Register_Object oSelList
47432>>>>>Register_Object sl036r
47432>>>>>
47432>>>>>
47432>>>>>    //AB-IgnoreStart
47432>>>>>
47432>>>>>    Use DFAllEnt.pkg
47432>>>>>    Use dbList.Sub
47432>>>>>    Use Button.Sub
47432>>>>>
47432>>>>>
47432>>>>>    Use BTYPKIN.DD
47432>>>>>    Use BARTICL.DD
47432>>>>>    
47432>>>>>    //AB-IgnoreEnd
47432>>>>>
47432>>>>>    CD_Popup_Object sl036r is a dbModalPanelSub
47451>>>>>        set label to "‰ ¤ã©œ ª  €¥ ¦š¨á­à¤" 
47452>>>>>        Set Size to 148 440
47453>>>>>        Set Location to 4 5
47454>>>>>        Set Exit_Application_Local_State to FALSE
47455>>>>>        Set Modal_State to FALSE
47456>>>>>
47456>>>>>        //AB-DDOStart
47456>>>>>
47456>>>>>        Object Btypkin_DD is a Btypkin_DataDictionary
47458>>>>>        End_Object    // Btypkin_DD
47459>>>>>
47459>>>>>        Object Barticl_DD is a Barticl_DataDictionary
47461>>>>>            Set DDO_Server to (Btypkin_DD(self))
47462>>>>>        End_Object    // Barticl_DD
47463>>>>>
47463>>>>>        Set Main_DD to (Barticl_DD(self))
47464>>>>>        Set Server to (Barticl_DD(self))
47465>>>>>
47465>>>>>        //AB-DDOEnd
47465>>>>>
47465>>>>>        Object oSelList is a dbListSub
47467>>>>>            Set Main_File to Barticl.File_Number
47468>>>>>            Set Server to (Btypkin_DD(self))
47469>>>>>            Set Size to 105 424
47470>>>>>            Set Location to 6 6
47471>>>>>
47471>>>>>            Begin_Row
47474>>>>>                Entry_Item Barticl.Barticl_recr
47475>>>>>                Entry_Item Barticl.Barticl_no
47476>>>>>                Entry_Item Barticl.Barticl_hmnia
47477>>>>>                Entry_Item Btypkin.Btypkin_code
47478>>>>>                Entry_Item Btypkin.Btypkin_descr
47479>>>>>            End_Row
47484>>>>>
47484>>>>>            Set Form_Width    item 0 to 56
47485>>>>>            Set Header_Label  item 0 to "Barticl recr"
47486>>>>>            
47486>>>>>            Set Form_Width    item 1 to 84
47487>>>>>            set header_label  item 1 to "€¨ Ÿ£æª" 
47488>>>>>            
47488>>>>>            Set Form_Width    item 2 to 60
47489>>>>>            set header_label  item 2 to "†£œ¨¦£ž¤å˜" 
47490>>>>>            
47490>>>>>            Set Form_Width    item 3 to 38
47491>>>>>            set header_label  item 3 to "‰å¤ž©ž" 
47492>>>>>            
47492>>>>>            Set Form_Width    item 4 to 179
47493>>>>>            set header_label  item 4 to "œ¨ š¨˜­ã" 
47494>>>>>            
47494>>>>>
47494>>>>>            //AB-StoreStart
47494>>>>>            Set Column_Option Item 0 to NoEnter True
47495>>>>>            
47495>>>>>            //AB-StoreEnd
47495>>>>>
47495>>>>>        End_Object    // oSelList
47496>>>>>
47496>>>>>        Object oOK_bn is a ButtonSub
47498>>>>>            set label to "&„§ ¢¦šã" 
47499>>>>>            Set Location to 114 271
47500>>>>>
47500>>>>>            //AB-StoreStart
47500>>>>>            Procedure OnClick
47502>>>>>                Send OK To oSelList
47503>>>>>            End_Procedure
47504>>>>>            //AB-StoreEnd
47504>>>>>
47504>>>>>        End_Object    // oOK_bn
47505>>>>>
47505>>>>>        Object oCancel_bn is a ButtonSub
47507>>>>>            set label to "&€¡ç¨à©ž" 
47508>>>>>            Set Location to 114 327
47509>>>>>
47509>>>>>            //AB-StoreStart
47509>>>>>            Procedure OnClick
47511>>>>>                Send Cancel To oSelList
47512>>>>>            End_Procedure
47513>>>>>            //AB-StoreEnd
47513>>>>>
47513>>>>>        End_Object    // oCancel_bn
47514>>>>>
47514>>>>>        Object oSearch_bn is a ButtonSub
47516>>>>>            set label to "€&¤˜ã«ž©ž" 
47517>>>>>            Set Location to 114 381
47518>>>>>
47518>>>>>            //AB-StoreStart
47518>>>>>            Procedure OnClick
47520>>>>>                Send Search To oSelList
47521>>>>>            End_Procedure
47522>>>>>            //AB-StoreEnd
47522>>>>>
47522>>>>>        End_Object    // oSearch_bn
47523>>>>>
47523>>>>>
47523>>>>>        //AB-StoreStart
47523>>>>>        On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
47524>>>>>        On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
47525>>>>>        On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
47526>>>>>        
47526>>>>>        //AB-StoreEnd
47526>>>>>
47526>>>>>    CD_End_Object    // sl036r
47528>>>>>>
47528>>>>>
47528>>>>>//AB/     End_Object    // prj
47528>>>Use sl037.sl
INCLUDING FILE: SL037.SL
47528>>>>>//AB/ Project SL037:BAXIO
47528>>>>>//AB/ Object prj is a Lookup_Project
47528>>>>>//AB/     Set ProjectName to "SL037:BAXIO"
47528>>>>>//AB/     Set ProjectFileName to "SL037.SL"
47528>>>>>
47528>>>>>// Project Object Structure
47528>>>>>//   SL037 is a dbModalPanelSub
47528>>>>>//     Baxiokat_DD is a DataDictionary
47528>>>>>//     Baxio_DD is a DataDictionary
47528>>>>>//     oSelList is a dbListSub
47528>>>>>//     TextBoxSub1 is a TextBoxSub
47528>>>>>//     cSyDateForm1 is a cSyDateForm
47528>>>>>//     TextBoxSub2 is a TextBoxSub
47528>>>>>//     cSyDateForm2 is a cSyDateForm
47528>>>>>//     TextBoxSub4 is a TextBoxSub
47528>>>>>//     TextBoxSub5 is a TextBoxSub
47528>>>>>//     FormSub1 is a FormSub
47528>>>>>//     FormSub2 is a FormSub
47528>>>>>//     FormSub3 is a FormSub
47528>>>>>//     FormSub4 is a FormSub
47528>>>>>//     ButtonSub1 is a ButtonSub
47528>>>>>//     oOK_bn is a ButtonSub
47528>>>>>
47528>>>>>// Register all objects
47528>>>>>Register_Object Baxio_DD
47528>>>>>Register_Object Baxiokat_DD
47528>>>>>Register_Object ButtonSub1
47528>>>>>Register_Object cSyDateForm1
47528>>>>>Register_Object cSyDateForm2
47528>>>>>Register_Object FormSub1
47528>>>>>Register_Object FormSub2
47528>>>>>Register_Object FormSub3
47528>>>>>Register_Object FormSub4
47528>>>>>Register_Object oOK_bn
47528>>>>>Register_Object oSelList
47528>>>>>Register_Object SL037
47528>>>>>Register_Object TextBoxSub1
47528>>>>>Register_Object TextBoxSub2
47528>>>>>Register_Object TextBoxSub4
47528>>>>>Register_Object TextBoxSub5
47528>>>>>
47528>>>>>
47528>>>>>
47528>>>>>//AB-StoreTopStart
47528>>>>>    
47528>>>>>Use sl100.sl
47528>>>>>
47528>>>>>
47528>>>>>//AB-StoreTopEnd
47528>>>>>
47528>>>>>//AB-IgnoreStart
47528>>>>>
47528>>>>>Use DFAllEnt.pkg
47528>>>>>Use dbList.Sub
47528>>>>>Use Txtbox.Sub
47528>>>>>Use cSyDateForm.Pkg
47528>>>>>Use Form.Sub
47528>>>>>Use Button.Sub
47528>>>>>
47528>>>>>
47528>>>>>Use BAXIOKAT.DD
47528>>>>>Use BAXIO.DD
INCLUDING FILE: BAXIO.DD
47528>>>>>>>//DDB-FileStart
47528>>>>>>>//DDB-HeaderStart
47528>>>>>>>
47528>>>>>>>// File Name : BAXIO.DD
47528>>>>>>>// Class Name: Baxio_DataDictionary
47528>>>>>>>// Revision  : 112
47528>>>>>>>// Version   : 2
47528>>>>>>>
47528>>>>>>>Use  Windows           // Basic Definitions
47528>>>>>>>Use  DataDict          // DataDictionary Class Definition
47528>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
47528>>>>>>>
47528>>>>>>>Open Baxio
47530>>>>>>>Open Bmove
47532>>>>>>>Open Baxiokat
47534>>>>>>>Open Sysrecb
47536>>>>>>>
47536>>>>>>>//DDB-HeaderEnd
47536>>>>>>>//DDB-ValidationStart
47536>>>>>>>
47536>>>>>>>//DDB/ ExternalValidationTable Baxio_Status_VT  Baxio.pkg
47536>>>>>>>//DDB/ ExternalValidationTable Bfile_VT  Baxio.pkg
47536>>>>>>>
47536>>>>>>>Register_Object Baxio_Status_VT
47536>>>>>>>Register_Object Baxio_Baxio_Place_VT
47536>>>>>>>Register_Object Bfile_VT
47536>>>>>>>Register_Object Baxio_Baxio_Bank_VT
47536>>>>>>>Register_Object Baxio_Baxio_Banka_VT
47536>>>>>>>Register_Object Baxio_Baxio_From_VT
47536>>>>>>>Register_Object Baxio_Baxio_Topos_VT1
47536>>>>>>>Use Baxio.pkg        // Baxio_Status_VT, Bfile_VT
47536>>>>>>>
47536>>>>>>>Object Baxio_Baxio_Place_VT  is a CodeValidationTable
47538>>>>>>>    Set Type_Value        To "BAXIOPLACE"
47539>>>>>>>    //DDB-ValidationCustomStart
47539>>>>>>>    //DDB-ValidationCustomEnd
47539>>>>>>>End_Object   // Baxio_Baxio_Place_VT
47540>>>>>>>
47540>>>>>>>Object Baxio_Baxio_Bank_VT  is a CodeValidationTable
47542>>>>>>>    Set Type_Value        To "BANK"
47543>>>>>>>    Set Allow_Blank_State To TRUE
47544>>>>>>>    //DDB-ValidationCustomStart
47544>>>>>>>    //DDB-ValidationCustomEnd
47544>>>>>>>End_Object   // Baxio_Baxio_Bank_VT
47545>>>>>>>
47545>>>>>>>Object Baxio_Baxio_Banka_VT  is a CodeValidationTable
47547>>>>>>>    Set Type_Value        To "BANK"
47548>>>>>>>    Set Allow_Blank_State To TRUE
47549>>>>>>>    //DDB-ValidationCustomStart
47549>>>>>>>    //DDB-ValidationCustomEnd
47549>>>>>>>End_Object   // Baxio_Baxio_Banka_VT
47550>>>>>>>
47550>>>>>>>Object Baxio_Baxio_From_VT  is a DescriptionValidationTable
47552>>>>>>>    Set Allow_Blank_State To TRUE
47553>>>>>>>    Set Table_Title       To "€¥ æš¨˜­¦  ›å¦¬ / «¨å«¦¬"
47554>>>>>>>
47554>>>>>>>    Procedure Fill_List
47556>>>>>>>        Forward Send Fill_List
47558>>>>>>>        Send Add_Table_Value  "0"  "ˆ›å¦¬"
47559>>>>>>>        Send Add_Table_Value  "1"  "’¨å«¦¬"
47560>>>>>>>    End_Procedure    // Fill_List
47561>>>>>>>    //DDB-ValidationCustomStart
47561>>>>>>>    //DDB-ValidationCustomEnd
47561>>>>>>>End_Object   // Baxio_Baxio_From_VT
47562>>>>>>>
47562>>>>>>>Object Baxio_Baxio_Topos_VT1  is a DescriptionValidationTable
47564>>>>>>>    Set Allow_Blank_State To TRUE
47565>>>>>>>    Set Table_Title       To "€¥ æš¨˜­¦ €«« ¡ãª / „§˜¨®å˜ª"
47566>>>>>>>
47566>>>>>>>    Procedure Fill_List
47568>>>>>>>        Forward Send Fill_List
47570>>>>>>>        Send Add_Table_Value  "0"  "€«« ¡ãª"
47571>>>>>>>        Send Add_Table_Value  "1"  "„§˜¨®å˜ª"
47572>>>>>>>    End_Procedure    // Fill_List
47573>>>>>>>    //DDB-ValidationCustomStart
47573>>>>>>>    //DDB-ValidationCustomEnd
47573>>>>>>>End_Object   // Baxio_Baxio_Topos_VT1
47574>>>>>>>//DDB-ValidationEnd
47574>>>>>>>//DDB-SelectionStart
47574>>>>>>>//DDB/ ExternalSelectionList SL037  SL037.SL
47574>>>>>>>//DDB/ ExternalSelectionList slNomism  slnomism.sl
47574>>>>>>>Register_Object SL037
47574>>>>>>>Register_Object slNomism
47574>>>>>>>//DDB-SelectionEnd
47574>>>>>>>
47574>>>>>>>Class Baxio_DataDictionary  is a DataDictionary_Sec
47575>>>>>>>
47575>>>>>>>      Procedure Construct_Object
47576>>>>>>>                Forward Send Construct_Object
47578>>>>>>>
47578>>>>>>>                //btypkin related properties:
47578>>>>>>>                //œ¤ž£œ¨é¤¦¤«˜  ©«ã¤: update «¦¬ bmove,
47578>>>>>>>                //£ž›œ¤å¦¤«˜   ©«ž¤: request save & delete «¦¬ bmove.
47578>>>>>>>                Property Integer piBtypkin_Flag03 0
47579>>>>>>>                Property Integer piBtypkin_Flag04 0
47580>>>>>>>                Property Integer pifromxrhsh      0
47581>>>>>>>
47581>>>>>>>                //baxio related properties:
47581>>>>>>>                //œ¤ž£œ¨é¤œ«˜     ©«ž¤: creating,
47581>>>>>>>                //®¨ž© £¦§¦ œå«˜  ©«ž¤: update «¦¬ bmove š ˜ ¤˜ œ¤œ¨š¦§¦ ã©œ  «ž¤ private.created_baxio «¦¬ bmove,
47581>>>>>>>                //£ž›œ¤åœ«˜      ©«ž¤: request save & delete «¦¬ bmove.
47581>>>>>>>                Property Integer piCreated_Baxio  0
47582>>>>>>>
47582>>>>>>>                //œ¤ž£œ¨é¤¦¤«˜     ©«ž¤: backout,
47582>>>>>>>                //®¨ž© £¦§¦ ¦ç¤«˜  ©«ž¤: validate_save š ˜ «¦¤ â¢œš®¦ editing «¦¬ baxio,
47582>>>>>>>                //£ž›œ¤å¦¤«˜      ©«ž¤: request save & delete «¦¬ bmove.
47582>>>>>>>                Property Number  pnB_Baxio_V2      0
47583>>>>>>>                Property Number  pnB_Baxio_V0      0
47584>>>>>>>                Property Number  pnB_Baxio_V00     0
47585>>>>>>>                Property Number  pnB_Baxio_Vr      0
47586>>>>>>>                Property String  psB_Baxio_C_Code2 ""
47587>>>>>>>                Property Integer piB_Baxio_Status  0
47588>>>>>>>                Property Integer piB_Baxio_Place   0
47589>>>>>>>
47589>>>>>>>                //properties š ˜ œ¢âš®¦¬ª ˜¢˜ššãª parent records:
47589>>>>>>>                //œ¤ž£œ¨é¤¦¤«˜     ©«ž¤:backout,
47589>>>>>>>                //®¨ž© £¦§¦ ¦ç¤«˜  ©«ž¤: validate_save š ˜ «¦¤ â¢œš®¦ editing «à¤ §œ›åà¤,
47589>>>>>>>                //£ž›œ¤å¦¤«˜      ©«ž¤: request save & delete «¦¬ bmove.
47589>>>>>>>                Property Integer piB_Baxiokat_Code 0
47590>>>>>>>                Property Integer piB_Year_Year     0
47591>>>>>>>                Property Integer piMustNOTConstrain Public 0
47592>>>>>>>      End_Procedure //construct_object
47593>>>>>>>
47593>>>>>>>
47593>>>>>>>
47593>>>>>>>//    Function fngConvertPoso_Baxio String asNomismaCodeApo ;
47593>>>>>>>//                            Number anPoso           ;
47593>>>>>>>//                            String asNomismaCodeSe  ;
47593>>>>>>>//                            Date   adHmnia          ;
47593>>>>>>>//                            Number nIsotimia  Returns Number
47593>>>>>>>
47593>>>>>>>//        Number rVal nApo_Euro_Isot nSe_Euro_Isot
47593>>>>>>>//        Integer iApo_Einai_Euro_Zone iApo_Einai_DRX iApo_Einai_Euro iDekadika_Apo
47593>>>>>>>//        Integer iSe_Einai_Euro_Zone  iSe_Einai_DRX  iSe_Einai_Euro  iDekadika_Se
47593>>>>>>>
47593>>>>>>>//        If (asNomismaCodeApo=asNomismaCodeSe) Function_Return anPoso
47593>>>>>>>
47593>>>>>>>//        Clear Nomisma
47593>>>>>>>//        Move (Trim(asNomismaCodeApo)) to Nomisma.Nomisma_Code
47593>>>>>>>//        Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
47593>>>>>>>//        Move Nomisma.Euro_Zone      to iApo_Einai_Euro_Zone
47593>>>>>>>//        Move Nomisma.Einai_DRX      to iApo_Einai_DRX
47593>>>>>>>//        Move Nomisma.Einai_EURO     to iApo_Einai_Euro
47593>>>>>>>//        Move Nomisma.KL_ISOT_EURO   to nApo_Euro_Isot
47593>>>>>>>//        Move Nomisma.Dekadika       to iDekadika_Apo
47593>>>>>>>
47593>>>>>>>//        Clear Nomisma
47593>>>>>>>//        Move (Trim(asNomismaCodeSe)) to Nomisma.Nomisma_Code
47593>>>>>>>//        Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
47593>>>>>>>//        Move Nomisma.Euro_Zone      to iSe_Einai_Euro_Zone
47593>>>>>>>//        Move Nomisma.Einai_DRX      to iSe_Einai_DRX
47593>>>>>>>//        Move Nomisma.Einai_EURO     to iSe_Einai_Euro
47593>>>>>>>//        Move Nomisma.KL_ISOT_EURO   to nSe_Euro_Isot
47593>>>>>>>//        Move Nomisma.Dekadika       to iDekadika_Se
47593>>>>>>>
47593>>>>>>>//        //05a. ??ÿ??? ? --> ??? 
47593>>>>>>>//        Calc (anPoso/nApo_Euro_Isot) to rVal
47593>>>>>>>//        Move (Round_Number(rVal,6)) to rVal
47593>>>>>>>//        //05b. ???         --> ??ÿ??? ?™ *
47593>>>>>>>//        Calc (rVal*nSe_Euro_Isot) to rVal
47593>>>>>>>//        Move (Round_Number(rVal,iDekadika_Se)) to rVal
47593>>>>>>>//        Function_Return rVal
47593>>>>>>>//    End_Function
47593>>>>>>>
47593>>>>>>>
47593>>>>>>>
47593>>>>>>>      //¡˜Ÿ¦¨åœ  «ž¤ default « £ã «¦¬ ¤¦£å©£˜«¦ª ˜¤á¢¦š˜ £œ «¦ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
47593>>>>>>>      Function Default_Axio_C_Code2 Returns String
47594>>>>>>>               String lsBaxio_C_Code_2
47595>>>>>>>               //Get File_Field_Current_Value File_Field SyscurXr.C_Code0 to lsBaxio_C_Code_2
47595>>>>>>>               Move SyscurXr.C_Code0 to lsBaxio_C_Code_2
47596>>>>>>>               Function_Return (Trim(lsBaxio_C_Code_2))
47597>>>>>>>      End_Function //default_axio_c_code2
47598>>>>>>>
47598>>>>>>>
47598>>>>>>>      // js 09/02/2002 den yparxei enhmerosh ton nomismatvn xrhshs
47598>>>>>>>      Procedure Convert_Axio_Values
47599>>>>>>>
47599>>>>>>>                Integer liBtypkin_Flag03 liBtypkin_Flag04
47600>>>>>>>
47600>>>>>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_Code0    ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_Rate0       to Baxio.Baxio_V0
47601>>>>>>>
47601>>>>>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_Code00   ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_Rate00      to Baxio.Baxio_V00
47602>>>>>>>
47602>>>>>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_CodeR    ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_RateR       to Baxio.Baxio_VR
47603>>>>>>>
47603>>>>>>>
47603>>>>>>>//                Move (fngConvertPoso_Baxio(Self,Baxio.Baxio_C_Code2,   ;
47603>>>>>>>//                                     Baxio.Baxio_V2,        ;
47603>>>>>>>//                                     SyscurXr.C_Code0,      ;
47603>>>>>>>//                                     Baxio.Baxio_HmniaE,    ;
47603>>>>>>>//                                     Baxio.Baxio_Rate0)     ;
47603>>>>>>>//                                    ) to Baxio.Baxio_V0
47603>>>>>>>//                If (liBtypkin_Flag03 = TRUE);
47603>>>>>>>//                     Begin
47603>>>>>>>//                      //˜¥å˜ 2-->00
47603>>>>>>>//                      Move (fngConvertPoso_Baxio(Self, Baxio.Baxio_C_Code2, ;
47603>>>>>>>//                                            Baxio.Baxio_V2,      ;
47603>>>>>>>//                                            SyscurXr.C_Code00,   ;
47603>>>>>>>//                                            Baxio.Baxio_HmniaE,  ;
47603>>>>>>>//                                            Baxio.Baxio_Rate00)  ;
47603>>>>>>>//                                          ) to Baxio.Baxio_V00
47603>>>>>>>//                     End
47603>>>>>>>//                Else Begin
47603>>>>>>>//                      Move 0            to Baxio.Baxio_V00
47603>>>>>>>//                     End
47603>>>>>>>//                If (liBtypkin_Flag04 = TRUE);
47603>>>>>>>//                     Begin
47603>>>>>>>//                      //˜¥å˜ 2-->r
47603>>>>>>>//                      Move (fngConvertPoso_Baxio(Self,Baxio.Baxio_C_Code2, ;
47603>>>>>>>//                                       Baxio.Baxio_V2,      ;
47603>>>>>>>//                                       SyscurXr.C_CodeR,    ;
47603>>>>>>>//                                       Baxio.Baxio_HmniaE,  ;
47603>>>>>>>//                                       Baxio.Baxio_RateR)   ;
47603>>>>>>>//                                      ) to Baxio.Baxio_VR
47603>>>>>>>//                     End
47603>>>>>>>//                Else Begin
47603>>>>>>>//                      Move 0            to Baxio.Baxio_VR
47603>>>>>>>//                     End
47603>>>>>>>      End_Procedure
47604>>>>>>>
47604>>>>>>>
47604>>>>>>>
47604>>>>>>>      Procedure Constrain
47605>>>>>>>                Forward Send Constrain
47607>>>>>>>                If (piMustNOTConstrain(Self)=1) Begin
47609>>>>>>>                End 
47609>>>>>>>>
47609>>>>>>>                else If (piMustNOTConstrain(Self)=2) Begin 
47612>>>>>>>                    Constrain Baxio.Company_Code Eq Syscurxr.Company_Code
47614>>>>>>>                    Constrain Baxio.Branch_Code  Eq Syscurxr.Branch_Code
47616>>>>>>>                end    
47616>>>>>>>>
47616>>>>>>>                Else Begin
47617>>>>>>>                    Constrain Baxio.Company_Code Eq Syscurxr.Company_Code
47619>>>>>>>                    Constrain Baxio.Branch_Code  Eq Syscurxr.Branch_Code
47621>>>>>>>                    Constrain Baxio.Year_Year    Eq Syscurxr.Year_Year
47623>>>>>>>                End
47623>>>>>>>>
47623>>>>>>>      End_Procedure   //constrain
47624>>>>>>>
47624>>>>>>>
47624>>>>>>>      //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
47624>>>>>>>      //™) ˜¤áš¤à©ž properties
47624>>>>>>>      //š) › ˜®œå¨ ©ž calculated §œ›åà¤
47624>>>>>>>      //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
47624>>>>>>>      //œ) œ¤ž£â¨à©ž properties after
47624>>>>>>>      Procedure Update
47625>>>>>>>                Forward Send Update
47627>>>>>>>                
47627>>>>>>>                If (Baxio.Baxio_C_Code2='') Move SyscurXr.C_Code0 to Baxio.Baxio_C_Code2
47630>>>>>>>                
47630>>>>>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
47630>>>>>>>                Move Syscurxr.Company_Code  to Baxio.Company_Code
47631>>>>>>>                Move Syscurxr.Branch_Code   to Baxio.Branch_Code
47632>>>>>>>                Move Syscurxr.Year_Year     to Baxio.Year_Year
47633>>>>>>>                Move Syscurxr.Year_Recr     to Baxio.Year_Recr
47634>>>>>>>                Move Baxiokat.Baxiokat_Code to Baxio.Baxiokat_Code
47635>>>>>>>
47635>>>>>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
47635>>>>>>>                //š01:œ¥ ¦¨ ©£¦ç, «˜ §¢ž¨à«â˜ ›â¤ â®¦¬¤ ©«¦ ®œå˜ §˜¨˜¢¢˜™ãª
47635>>>>>>>                If (Baxiokat.Baxiokat_Type = 2);                Begin //˜¥ æš¨˜­˜ §¢ž¨à«â˜
47637>>>>>>>                     Move "" to Baxio.Baxio_Code_In
47638>>>>>>>                     Move "" to Baxio.Baxio_Epon_In
47639>>>>>>>                     Move 0  to Baxio.Baxio_Fpar_In
47640>>>>>>>                End
47640>>>>>>>>
47640>>>>>>>                //š02:yyyy + mm + dd ¢ã¥žª š ˜ «˜ reports
47640>>>>>>>                Move (TheYearSegment (Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_YYYY
47641>>>>>>>                Move (TheMonthSegment(Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_MM
47642>>>>>>>                Move (TheDaySegment  (Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_DD
47643>>>>>>>
47643>>>>>>>                //š03:§¨é«¦ª & «œ¢œ¬«˜å¦ª §˜¨˜¢ã§«žª
47643>>>>>>>                If (Baxio.Baxio_Lcode = "");                Begin
47645>>>>>>>                     Move (-1) to Baxio.Baxio_File_Out
47646>>>>>>>                     Move ""   to Baxio.Baxio_Code_Out
47647>>>>>>>                     Move ""   to Baxio.Baxio_Epon_Out
47648>>>>>>>                     Move ""   to Baxio.Baxio_Fpar_Out
47649>>>>>>>
47649>>>>>>>                     Move (-1) to Baxio.Baxio_Lfile
47650>>>>>>>                     Move ""   to Baxio.Baxio_Lepon
47651>>>>>>>                     Move ""   to Baxio.Baxio_Lpar
47652>>>>>>>                End
47652>>>>>>>>
47652>>>>>>>      End_Procedure //update
47653>>>>>>>
47653>>>>>>>
47653>>>>>>>      Procedure Backout
47654>>>>>>>                Forward Send Backout
47656>>>>>>>
47656>>>>>>>                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
47656>>>>>>>                Set pnB_Baxio_V2      to Baxio.Baxio_V2
47657>>>>>>>                Set pnB_Baxio_V0      to Baxio.Baxio_V0
47658>>>>>>>                Set pnB_Baxio_V00     to Baxio.Baxio_V00
47659>>>>>>>                Set pnB_Baxio_Vr      to Baxio.Baxio_Vr
47660>>>>>>>                Set psB_Baxio_C_Code2 to Baxio.Baxio_C_Code2
47661>>>>>>>                Set piB_Baxio_Status  to Baxio.Baxio_Status
47662>>>>>>>                Set piB_Baxio_Place   to Baxio.Baxio_Place
47663>>>>>>>                Set piB_Baxiokat_Code to Baxio.Baxiokat_Code    //š ˜ â¢œš®¦ ˜¢˜ššãª parent
47664>>>>>>>                Set piB_Year_Year     to Baxio.Year_Year        //š ˜ â¢œš®¦ ˜¢˜ššãª parent
47665>>>>>>>      End_Procedure //backout
47666>>>>>>>
47666>>>>>>>
47666>>>>>>>      Procedure New_Current_Record Integer liOld_Record Integer liNew_Record
47667>>>>>>>                Forward Send New_Current_Record liOld_Record liNew_Record
47669>>>>>>>                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
47669>>>>>>>                Set pnB_Baxio_V2      to Baxio.Baxio_V2
47670>>>>>>>                Set pnB_Baxio_V0      to Baxio.Baxio_V0
47671>>>>>>>                Set pnB_Baxio_V00     to Baxio.Baxio_V00
47672>>>>>>>                Set pnB_Baxio_Vr      to Baxio.Baxio_Vr
47673>>>>>>>                Set psB_Baxio_C_Code2 to Baxio.Baxio_C_Code2
47674>>>>>>>                Set piB_Baxio_Status  to Baxio.Baxio_Status
47675>>>>>>>                Set piB_Baxiokat_Code to Baxio.Baxiokat_Code    //š ˜ â¢œš®¦ ˜¢˜ššãª parent
47676>>>>>>>                Set piB_Year_Year     to Baxio.Year_Year        //š ˜ â¢œš®¦ ˜¢˜ššãª parent
47677>>>>>>>      End_Procedure //new_current_record
47678>>>>>>>
47678>>>>>>>
47678>>>>>>>      Procedure Creating
47679>>>>>>>                Forward Send Creating
47681>>>>>>>
47681>>>>>>>                //˜¨ Ÿ£æª ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
47681>>>>>>>                //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBaxio
47681>>>>>>>
47681>>>>>>>                //«œ¢œ¬«˜å¦ª ¡à› ¡æª ˜¨ Ÿ£æª ˜¥ ¦š¨á­¦¬
47681>>>>>>>                Add 1 to Baxiokat.Baxio_Lcode
47682>>>>>>>                Move Baxiokat.Baxio_Lcode to Baxio.Baxio_Code
47683>>>>>>>
47683>>>>>>>                //«¦ property ˜¬«æ œ¤œ¨š¦§¦ œå «ž¤ private.created_baxio
47683>>>>>>>                //£â©à «žª update ©«¦ bmove
47683>>>>>>>                Set piCreated_Baxio to TRUE
47684>>>>>>>
47684>>>>>>>//
47684>>>>>>>//                Move SysCurXr.C_Code0 to Baxio.Baxio_C_Code2
47684>>>>>>>
47684>>>>>>>                Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                 (Trim(String(Baxio.Baxio_Rec0)))))) to Baxio.Baxio_Recr
47685>>>>>>>
47685>>>>>>>      End_Procedure //creating
47686>>>>>>>
47686>>>>>>>
47686>>>>>>>      Procedure Operation_Not_Allowed Integer iError_Num
47687>>>>>>>                String lsError_Message
47688>>>>>>>                Case Begin
47688>>>>>>>                     //˜§æ validate save
47688>>>>>>>                     Case (iError_Num = 1001)
47690>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  ¦§à©›ã§¦«œ ž£œ¨¦£ž¤å˜ ¢ã¥œàª!");                          to lsError_Message
47691>>>>>>>                     Case Break
47692>>>>>>>                     Case (iError_Num = 1002)
47695>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
47696>>>>>>>                     Case Break
47697>>>>>>>                     Case (iError_Num = 1003)
47700>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  ¦§à©›ã§¦«œ ¤æ£ ©£˜!");                          to lsError_Message
47701>>>>>>>                     Case Break
47702>>>>>>>                     Case (iError_Num = 1004)
47705>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
47706>>>>>>>                     Case Break
47707>>>>>>>                     Case (iError_Num = 1005)
47710>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
47711>>>>>>>                     Case Break
47712>>>>>>>                     Case (iError_Num = 1006)
47715>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ Reporting).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
47716>>>>>>>                     Case Break
47717>>>>>>>
47717>>>>>>>                     Case (iError_Num = 1007)
47720>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\nŒâ˜ €¥ æš¨˜­˜ ›ž£ ¦¬¨š¦ç¤«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
47721>>>>>>>                     Case Break
47722>>>>>>>                     Case (iError_Num = 1008)
47725>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n’¦ ¤æ£ ©£˜ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
47726>>>>>>>                     Case Break
47727>>>>>>>                     Case (iError_Num = 1009)
47730>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
47731>>>>>>>                     Case Break
47732>>>>>>>                     Case (iError_Num = 1010)
47735>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©žª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
47736>>>>>>>                     Case Break
47737>>>>>>>                     Case (iError_Num = 1011)
47740>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜ •¨ã©žª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
47741>>>>>>>                     Case Break
47742>>>>>>>                     Case (iError_Num = 1012)
47745>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (Œæ£ ©£˜ Reporting) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
47746>>>>>>>                     Case Break
47747>>>>>>>                     Case (iError_Num = 1013)
47750>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n’¦ ˜¥ æš¨˜­¦ â®œ  œ¥¦­¢žŸœå !");                          to lsError_Message
47751>>>>>>>                     Case Break
47752>>>>>>>
47752>>>>>>>                     Case (iError_Num = 1014)
47755>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ ›â¤ œ§ «¨â§œ«˜  ¤˜ ˜¢¢á¥œ  ¡˜«žš¦¨å˜!");                          to lsError_Message
47756>>>>>>>                     Case Break
47757>>>>>>>                     Case (iError_Num = 1015)
47760>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ ›â¤ œ§ «¨â§œ«˜  ¤˜ ˜¢¢á¥œ  ®¨ã©ž!");                          to lsError_Message
47761>>>>>>>                     Case Break
47762>>>>>>>                     Case (iError_Num = 1100)
47765>>>>>>>                          Move "DDC 037:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
47766>>>>>>>                          Case Break
47767>>>>>>>
47767>>>>>>>                     //˜§æ validate delete
47767>>>>>>>                     Case (iError_Num = 2007)
47770>>>>>>>                          Move ("DDC 037:€›ç¤˜«ž ž › ˜š¨˜­ã !\n\n’¦ €¥ æš¨˜­¦ › ˜š¨á­œ«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
47771>>>>>>>                     Case Break
47772>>>>>>>                     Case (iError_Num = 2100)
47775>>>>>>>                          Move "DDC 037:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
47776>>>>>>>                          Case Break
47777>>>>>>>
47777>>>>>>>                     Case Else
47777>>>>>>>                          Forward Send Operation_Not_Allowed iError_Num
47779>>>>>>>                Case End
47779>>>>>>>
47779>>>>>>>                Error iError_Num lsError_Message
47780>>>>>>>>
47780>>>>>>>      End_Procedure // operation_not_allowed
47781>>>>>>>
47781>>>>>>>      //1001:baxio_hmnial > 0
47781>>>>>>>      //1002:baxio_v2 > 0            (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ œšš¨˜­ãª
47781>>>>>>>      //1003:baxio_c_code2 <> ""     (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ £ã¤ â®œ  ¤æ£ ©£˜)
47781>>>>>>>
47781>>>>>>>      //1004:baxio_v0 > 0            (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©žª
47781>>>>>>>      //1005:baxio_v00 > 0 if flag 3 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ›œ¬«œ¨œç¦¤ ¤æ£ ©£˜ ®¨ã©žª
47781>>>>>>>      //1006:baxio_vr > 0  of flag 4 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ reporting
47781>>>>>>>
47781>>>>>>>
47781>>>>>>>      //1007:›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬ œ§ «¨â§œ«˜  £æ¤¦¤ ˜§¦ «¦ bmove_dd, ›ž¢˜›ã §¨â§œ 
47781>>>>>>>      //       If (baxio.recnum=0) then operation_origin must be = bmove_dd
47781>>>>>>>      //1008:«¨¦§¦§¦åž©ž (edit) baxio_c_code2 £æ¤¦¤ ˜§æ bmove_dd
47781>>>>>>>      //1009:«¨¦§¦§¦åž©ž (edit) baxio_v2      £æ¤¦¤ ˜§æ bmove_dd
47781>>>>>>>      //1010:«¨¦§¦§¦åž©ž (edit) baxio_v0      £æ¤¦¤ ˜§æ bmove_dd
47781>>>>>>>      //1011:«¨¦§¦§¦åž©ž (edit) baxio_v00     £æ¤¦¤ ˜§æ bmove_dd
47781>>>>>>>      //1012:«¨¦§¦§¦åž©ž (edit) baxio_vr      £æ¤¦¤ ˜§æ bmove_dd
47781>>>>>>>
47781>>>>>>>      //1013:œá¤ «¦ status œå¤˜  œ¥¦­¢ž£â¤¦, ˜§˜š¦¨œçœ¦¤«˜  æ¢˜ «˜ §œ¨˜ «â¨à edits
47781>>>>>>>
47781>>>>>>>      //1014:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent baxiokat record
47781>>>>>>>      //1015:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent year     record
47781>>>>>>>      Function Validate_Save Returns Integer
47782>>>>>>>               Integer iReturnVal
47783>>>>>>>
47783>>>>>>>               Forward Get Validate_Save to iReturnVal
47785>>>>>>>
47785>>>>>>>               If (Not(iReturnVal));               Begin
47787>>>>>>>
47787>>>>>>>                //---------â¢œš®¦  ›ž£ ¦¬¨šå˜ª ¤â¦¬ baxio record----------------------
47787>>>>>>>                //sososo £ž§àª §¨œ§œ  ¤˜ §˜ ¥à £œ «ž¤ current record ????
47787>>>>>>>                If (Baxio.Recnum =  0);                Begin //œá¤ ›ž£ ¦¬¨šé ¤â¦ record
47789>>>>>>>                      //1007:â¢œš®¦ª ›ž£ ¦¬¨šå˜ª ¤â¦¬ ˜¥ ¦š¨á­¦¬ ˜§¦ «¦ baxio_dd
47789>>>>>>>
47789>>>>>>>                      If (pifromxrhsh(Self)=0) Begin
47791>>>>>>>                        If (Not((Main_File(OPERATION_ORIGIN)) =  Bmove.File_Number)) Send Operation_Not_Allowed 1007
47794>>>>>>>                      End
47794>>>>>>>>
47794>>>>>>>                End   //«â¢¦ª œ¢âš®à¤ ›ž£ ¦¬¨šå˜ª ¤â¦¬ baxio record
47794>>>>>>>>
47794>>>>>>>
47794>>>>>>>
47794>>>>>>>                //---------â¢œš®¦  editing existing baxio records---------------------
47794>>>>>>>                Else;                Begin //edit an existing record
47795>>>>>>>                      //1008:«¨¦§¦§¦åž©ž (edit) baxio_c_code2 £æ¤¦¤ ˜§æ bmove_dd
47795>>>>>>>
47795>>>>>>>                      If (pifromxrhsh(Self)=0) Begin
47797>>>>>>>
47797>>>>>>>                        If (;                            ((psB_Baxio_C_Code2(Self))     <> Baxio.Baxio_C_Code2) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1008
47800>>>>>>>                        //1009:«¨¦§¦§¦åž©ž (edit) baxio_v2 £æ¤¦¤ ˜§æ bmove_dd
47800>>>>>>>                        If (;                            ((pnB_Baxio_V2(Self))          <> Baxio.Baxio_V2      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1009
47803>>>>>>>                        //1010:«¨¦§¦§¦åž©ž (edit) baxio_v0 £æ¤¦¤ ˜§æ bmove_dd
47803>>>>>>>                        If (;                            ((pnB_Baxio_V0(Self))          <> Baxio.Baxio_V0      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1010
47806>>>>>>>                        //1011:«¨¦§¦§¦åž©ž (edit) baxio_v00 £æ¤¦¤ ˜§æ bmove_dd
47806>>>>>>>                        If (;                            ((pnB_Baxio_V00(Self))         <> Baxio.Baxio_V00     ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1011
47809>>>>>>>                        //1012:«¨¦§¦§¦åž©ž (edit) baxio_vr £æ¤¦¤ ˜§æ bmove_dd
47809>>>>>>>                        If (;                            ((pnB_Baxio_Vr(Self))          <> Baxio.Baxio_Vr      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1012
47812>>>>>>>
47812>>>>>>>                      End
47812>>>>>>>>
47812>>>>>>>                        // Egine rem 20/12/2001 giati an orisoume sta metrhta gia paradeigma
47812>>>>>>>                        // oti to status SE einai exoflhmeno, tote xtypaei to validation sto
47812>>>>>>>                        // kleisimo toy barticle. Alloste den vlepoume giati den mporei na
47812>>>>>>>                        // anoigokleisei
47812>>>>>>>//                      //1013:œá¤ «¦ status œå¤˜  œ¥¦­¢ž£â¤¦, ˜§˜š¦¨œç¦¤«˜  æ¢˜ «˜ §œ¨˜ «â¨à edits ˜§¦ «¦ bmove
47812>>>>>>>//                      If (;
47812>>>>>>>//                           ((piB_Baxio_Status(Self))      = 2                    ) and;
47812>>>>>>>//                           ((Main_File(OPERATION_ORIGIN)) =  Bmove.File_Number);
47812>>>>>>>//                         )                                                       Send Operation_Not_Allowed 1013
47812>>>>>>>
47812>>>>>>>                      If (pifromxrhsh(Self)=0) Begin
47814>>>>>>>                        //1014:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent baxiokat record
47814>>>>>>>                        If (Not;                            ((piB_Baxiokat_Code(Self)) =  Baxiokat.Baxiokat_Code);                            )                                                       Send Operation_Not_Allowed 1014
47817>>>>>>>
47817>>>>>>>                        //1015:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent year record
47817>>>>>>>                        If (Not;                            ((piB_Year_Year    (Self)) =  SysCurXr.Year_Year        );                            )                                                       Send Operation_Not_Allowed 1015
47820>>>>>>>                      End
47820>>>>>>>>
47820>>>>>>>                End   //«â¢¦ª œ¢âš®à¤ editing existing baxio records
47820>>>>>>>>
47820>>>>>>>
47820>>>>>>>                //¢¦§¦å â¢œš®¦ 
47820>>>>>>>                //1001:baxio_hmnial > 0
47820>>>>>>>                If (Not(Baxio.Baxio_Hmnial > 0 ))   Send Operation_Not_Allowed 1001
47823>>>>>>>                //1002:baxio_v2 > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ œšš¨˜­ãª
47823>>>>>>>                If (Not(Baxio.Baxio_V2 > 0))         Send Operation_Not_Allowed 1002
47826>>>>>>>                //1003:baxio_c_code2 <> ""
47826>>>>>>>                If (Not(Baxio.Baxio_C_Code2 <>""))    Send Operation_Not_Allowed 1003
47829>>>>>>>                //1004:baxio_v0 > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
47829>>>>>>>//--------------If (Not(Baxio.Baxio_V0 > 0))         Send Operation_Not_Allowed 1004
47829>>>>>>>                //1005:baxio_v00> 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ›œ¬«œ¨œç¦¤ ¤æ£ ©£˜ ®¨ã©œàª
47829>>>>>>>//--------------If (Not(Baxio.Baxio_V00> 0))         Send Operation_Not_Allowed 1005
47829>>>>>>>                //1006:baxio_vr > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ reporting
47829>>>>>>>//--------------If (Not(Baxio.Baxio_VR > 0))         Send Operation_Not_Allowed 1006
47829>>>>>>>                //1100:cby = globals
47829>>>>>>>
47829>>>>>>>                If (pifromxrhsh(Self)=0) Begin
47831>>>>>>>
47831>>>>>>>                    If ( ;                        (Not(Baxio.Company_Code = SyscurXr.Company_Code)) or;                        (Not(Baxio.Branch_Code  = SyscurXr.Branch_Code )) or;                        (Not(Baxio.Year_Year    = SyscurXr.Year_Year   ));                        )                                                   Send Operation_Not_Allowed 1100
47834>>>>>>>
47834>>>>>>>               End
47834>>>>>>>>
47834>>>>>>>
47834>>>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
47834>>>>>>>>
47834>>>>>>>               Function_Return iReturnVal
47835>>>>>>>      End_Function //validate_save
47836>>>>>>>
47836>>>>>>>
47836>>>>>>>      //2007:ž › ˜š¨˜­ã ˜¥ ¦š¨á­¦¬ œ§ «¨â§œ«˜  £æ¤¦¤ ˜§¦ «¦ bmove_dd
47836>>>>>>>      Function Validate_Delete  Returns Integer
47837>>>>>>>               Integer iReturnVal
47838>>>>>>>               Forward Get Validate_Delete  To iReturnVal
47840>>>>>>>               If (Not(iReturnVal));               Begin
47842>>>>>>>
47842>>>>>>>                  //2007:â¢œš®¦ª › ˜š¨˜­ãª ˜¥ ¦š¨á­¦¬ (£æ¤¦¤ ˜§¦ bmove_dd)
47842>>>>>>>                  If ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number)          Send Operation_Not_Allowed 2007
47845>>>>>>>
47845>>>>>>>                  //2100:cby = globals
47845>>>>>>>                  If ( ;                      (Not(Baxio.Company_Code = Syscurxr.Company_Code)) or;                      (Not(Baxio.Branch_Code  = Syscurxr.Branch_Code )) or;                      (Not(Baxio.Year_Year    = Syscurxr.Year_Year        ));                      )                                                   Send Operation_Not_Allowed 2100
47848>>>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
47848>>>>>>>>
47848>>>>>>>               Function_Return iReturnVal
47849>>>>>>>      End_Function //validate_delete
47850>>>>>>>
47850>>>>>>>
47850>>>>>>>//------------------------------------------------------------------
47850>>>>>>>    Procedure Define_Fields
47851>>>>>>>        Forward Send Define_Fields
47853>>>>>>>        //DDB-Generated-Code-Location
47853>>>>>>>        //DDB-DefineFieldStart
47853>>>>>>>
47853>>>>>>>        Set Main_File            To Baxio.File_Number
47854>>>>>>>        Set Cascade_Delete_State To FALSE
47855>>>>>>>
47855>>>>>>>
47855>>>>>>>        // Child (Client) file structure................
47855>>>>>>>        Send Add_Client_File  Bmove.File_Number
47856>>>>>>>
47856>>>>>>>        // Parent (Server) file structure...............
47856>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
47857>>>>>>>
47857>>>>>>>        // External (System) file structure.............
47857>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
47858>>>>>>>
47858>>>>>>>        Define_Auto_Increment  Sysrecb.Baxio_Rec0  To Baxio.Baxio_Rec0
47861>>>>>>>
47861>>>>>>>        // Field-based properties.......................
47861>>>>>>>
47861>>>>>>>        // Baxio.Company_Code
47861>>>>>>>
47861>>>>>>>        // Baxio.Branch_Code
47861>>>>>>>
47861>>>>>>>        // Baxio.Year_Year
47861>>>>>>>
47861>>>>>>>        // Baxio.Baxiokat_Code
47861>>>>>>>
47861>>>>>>>        // Baxio.Baxio_Code
47861>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Code To (SL037(Self))
47862>>>>>>>
47862>>>>>>>        // Baxio.Baxio_Rec0
47862>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Rec0 To (SL037(Self))
47863>>>>>>>
47863>>>>>>>        // Baxio.Year_Recr
47863>>>>>>>
47863>>>>>>>        // Baxio.Baxiokat_Recr
47863>>>>>>>
47863>>>>>>>        // Baxio.Baxio_Recr
47863>>>>>>>
47863>>>>>>>        // Baxio.Baxio_Status
47863>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Status To (Baxio_Status_VT(Self))
47864>>>>>>>
47864>>>>>>>        // Baxio.Baxio_Place
47864>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Place To (Baxio_Baxio_Place_VT(Self))
47865>>>>>>>
47865>>>>>>>        // Baxio.Baxio_File_In
47865>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_In To (Bfile_VT(Self))
47866>>>>>>>
47866>>>>>>>        // Baxio.Baxio_Code_In
47866>>>>>>>        //DDB/ Comment_Short       Field Baxio.Baxio_Code_In To "To BIAXIOKAT_FILE ¡˜Ÿ¦¨åœ  «ž¤ ©®œ« ¡ã ¢å©«˜"
47866>>>>>>>
47866>>>>>>>        // Baxio.Baxio_Epon_In
47866>>>>>>>
47866>>>>>>>        // Baxio.Baxio_Fpar_In
47866>>>>>>>
47866>>>>>>>        // Baxio.Baxio_File_Out
47866>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_Out To (Bfile_VT(Self))
47867>>>>>>>
47867>>>>>>>        // Baxio.Baxio_Code_Out
47867>>>>>>>
47867>>>>>>>        // Baxio.Baxio_Epon_Out
47867>>>>>>>
47867>>>>>>>        // Baxio.Baxio_Fpar_Out
47867>>>>>>>
47867>>>>>>>        // Baxio.Baxio_Lfile
47867>>>>>>>
47867>>>>>>>        // Baxio.Baxio_Lcode
47867>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Lcode To (Bfile_VT(Self))
47868>>>>>>>
47868>>>>>>>        // Baxio.Baxio_Lepon
47868>>>>>>>
47868>>>>>>>        // Baxio.Baxio_Lpar
47868>>>>>>>
47868>>>>>>>        // Baxio.Baxio_Bank00000
47868>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Bank00000 To (Baxio_Baxio_Bank_VT(Self))
47869>>>>>>>
47869>>>>>>>        // Baxio.Baxio_Hmniae
47869>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniae To (SL037(Self))
47870>>>>>>>
47870>>>>>>>        // Baxio.Baxio_Hmniap000
47870>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniap000 To (SL037(Self))
47871>>>>>>>
47871>>>>>>>        // Baxio.Baxio_Hmnial
47871>>>>>>>        //DDB/ Comment_Short       Field Baxio.Baxio_Hmnial To "†£/¤å˜ Šã¥žª:"
47871>>>>>>>
47871>>>>>>>        // Baxio.Baxio_Ekdoths
47871>>>>>>>
47871>>>>>>>        // Baxio.Baxio_Ekdothse
47871>>>>>>>
47871>>>>>>>        // Baxio.Baxio_Sediatagh
47871>>>>>>>
47871>>>>>>>        // Baxio.Baxio_Sdiataghe
47871>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Sdiataghe To (SL037(Self))
47872>>>>>>>
47872>>>>>>>        // Baxio.Baxio_Banka
47872>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Banka To (Baxio_Baxio_Banka_VT(Self))
47873>>>>>>>
47873>>>>>>>        // Baxio.Baxio_Opistho
47873>>>>>>>
47873>>>>>>>        // Baxio.Baxio_No
47873>>>>>>>
47873>>>>>>>        // Baxio.Baxio_V2
47873>>>>>>>
47873>>>>>>>        // Baxio.Baxio_V0
47873>>>>>>>
47873>>>>>>>        // Baxio.Baxio_V00
47873>>>>>>>
47873>>>>>>>        // Baxio.Baxio_Vr
47873>>>>>>>
47873>>>>>>>        // Baxio.Baxio_Rate0
47873>>>>>>>
47873>>>>>>>        // Baxio.Baxio_Rate00
47873>>>>>>>
47873>>>>>>>        // Baxio.Baxio_Rater
47873>>>>>>>
47873>>>>>>>        // Baxio.Baxio_C_Code2
47873>>>>>>>        Set Field_Entry_msg        Field Baxio.Baxio_C_Code2 To get_Default_Axio_C_Code2
47874>>>>>>>        Set Field_Options          Field Baxio.Baxio_C_Code2 To DD_CAPSLOCK   
47875>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_C_Code2 To (slNomism(Self))
47876>>>>>>>
47876>>>>>>>        // Baxio.Baxio_Lixi_Yyyy
47876>>>>>>>
47876>>>>>>>        // Baxio.Baxio_Lixi_Mm
47876>>>>>>>
47876>>>>>>>        // Baxio.Baxio_Lixi_Dd
47876>>>>>>>
47876>>>>>>>        // Baxio.Baxio_Bmove_Laa
47876>>>>>>>
47876>>>>>>>        // Baxio.Baxio_Desm
47876>>>>>>>
47876>>>>>>>        // Baxio.Baxio_From
47876>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_From To (Baxio_Baxio_From_VT(Self))
47877>>>>>>>
47877>>>>>>>        // Baxio.Baxio_Topos
47877>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Topos To (Baxio_Baxio_Topos_VT1(Self))
47878>>>>>>>
47878>>>>>>>        //DDB-DefineFieldEnd
47878>>>>>>>
47878>>>>>>>        Set Main_File            To Baxio.File_Number
47879>>>>>>>        Set Cascade_Delete_State To FALSE
47880>>>>>>>
47880>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
47881>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
47882>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
47883>>>>>>>
47883>>>>>>>        // Child (Client) file structure................
47883>>>>>>>        Send Add_Client_File  Bmove.File_Number
47884>>>>>>>
47884>>>>>>>        // Parent (Server) file structure...............
47884>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
47885>>>>>>>
47885>>>>>>>        // External (System) file structure.............
47885>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
47886>>>>>>>
47886>>>>>>>        Define_Auto_Increment  Sysrecb.Baxio_Rec0  To Baxio.Baxio_Rec0
47889>>>>>>>
47889>>>>>>>        // Field-based properties.......................
47889>>>>>>>
47889>>>>>>>        // Baxio.Company_Code
47889>>>>>>>
47889>>>>>>>        // Baxio.Branch_Code
47889>>>>>>>
47889>>>>>>>        // Baxio.Year_Year
47889>>>>>>>
47889>>>>>>>        // Baxio.Baxiokat_Code
47889>>>>>>>
47889>>>>>>>        // Baxio.Baxio_Code
47889>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Code         To "‰à› ¡æª €¥ ¦š¨á­¦¬"
47890>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Code         To "‰à› ¡æª"
47891>>>>>>>        Set Field_Options          Field Baxio.Baxio_Code         To DD_AUTOFIND    DD_NOPUT
47892>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Code         To (sl037(Self))
47893>>>>>>>        Set Key_Field_State        Field Baxio.Baxio_Code         To TRUE
47894>>>>>>>
47894>>>>>>>        // Baxio.Baxio_Rec0
47894>>>>>>>        Set Field_Options          Field Baxio.Baxio_Rec0         To DD_AUTOFIND    DD_REQUIRED
47895>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Rec0         To (sl037(Self))
47896>>>>>>>        Set Key_Field_State        Field Baxio.Baxio_Rec0         To TRUE
47897>>>>>>>
47897>>>>>>>        // Baxio.Year_Rec0
47897>>>>>>>
47897>>>>>>>        // Baxio.Baxiokat_Rec0
47897>>>>>>>
47897>>>>>>>        // Baxio.Baxio_Status
47897>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Status       To "dbComboForm_EZ"
47898>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Status       To "‰˜«á©«˜©ž"
47899>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Status       To "‰˜«á©«˜©ž"
47900>>>>>>>        Set Field_Options  Field Baxio.Baxio_Status  To DD_DISPLAYONLY
47901>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Status       To (Baxio_Status_VT(Self))
47902>>>>>>>
47902>>>>>>>        // Baxio.Baxio_Place
47902>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Place        To "dbComboForm_EZ"
47903>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Place        To "„¬¨å©¡œ«˜ "
47904>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Place        To "„¬¨å©¡œ«˜ "
47905>>>>>>>        Set Field_Options          Field Baxio.Baxio_Place        To DD_DISPLAYONLY
47906>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Place        To (Baxio_Baxio_Place_VT(Self))
47907>>>>>>>
47907>>>>>>>        // Baxio.Baxio_File_In
47907>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_In      To (Bfile_VT(Self))
47908>>>>>>>
47908>>>>>>>        // Baxio.Baxio_Code_In
47908>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Code_In      To "˜¨œ¢ã­Ÿž €§æ"
47909>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Code_In      To "˜¨œ¢ã­Ÿž €§æ"
47910>>>>>>>        Set Field_Options          Field Baxio.Baxio_Code_In      To DD_DISPLAYONLY
47911>>>>>>>
47911>>>>>>>        // Baxio.Baxio_Epon_In
47911>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Epon_In      To "„§à¤¬£å˜"
47912>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Epon_In      To "„§à¤¬£å˜"
47913>>>>>>>        Set Field_Options          Field Baxio.Baxio_Epon_In      To DD_DISPLAYONLY
47914>>>>>>>
47914>>>>>>>        // Baxio.Baxio_Fpar_In
47914>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Fpar_In      To "˜¨/¡æ ˜¨˜¢˜™ãª"
47915>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Fpar_In      To "˜¨/¡æ ˜¨˜¢."
47916>>>>>>>        Set Field_Options          Field Baxio.Baxio_Fpar_In      To DD_DISPLAYONLY
47917>>>>>>>
47917>>>>>>>        // Baxio.Baxio_File_Out
47917>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_Out     To (Bfile_VT(Self))
47918>>>>>>>
47918>>>>>>>        // Baxio.Baxio_Code_Out
47918>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Code_Out     To "¨é«¦ª ˜¨˜¢ã§«žª"
47919>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Code_Out     To "¨é«¦ª ˜¨˜¢ã§«žª"
47920>>>>>>>        Set Field_Options          Field Baxio.Baxio_Code_Out     To DD_DISPLAYONLY
47921>>>>>>>
47921>>>>>>>        // Baxio.Baxio_Epon_Out
47921>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Epon_Out     To "„§à¤¬£å˜"
47922>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Epon_Out     To "„§à¤¬£å˜"
47923>>>>>>>        Set Field_Options          Field Baxio.Baxio_Epon_Out     To DD_DISPLAYONLY
47924>>>>>>>
47924>>>>>>>        // Baxio.Baxio_Fpar_Out
47924>>>>>>>        Set Field_Options          Field Baxio.Baxio_Fpar_Out     To DD_DISPLAYONLY
47925>>>>>>>
47925>>>>>>>        // Baxio.Baxio_Lfile
47925>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Lfile        To (Bfile_VT(Self))
47926>>>>>>>
47926>>>>>>>        // Baxio.Baxio_Lcode
47926>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Lcode        To "’œ¢œ¬«˜å¦ª ˜¨˜¢ã§«žª"
47927>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Lcode        To "’œ¢.˜¨˜¢ã§«žª"
47928>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lcode        To DD_DISPLAYONLY
47929>>>>>>>
47929>>>>>>>        // Baxio.Baxio_Lepon
47929>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lepon        To DD_DISPLAYONLY
47930>>>>>>>
47930>>>>>>>        // Baxio.Baxio_Lpar
47930>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Lpar         To "˜¨/¡æ ˜¨á›¦©žª"
47931>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Lpar         To "˜¨/¡æ ˜¨á›¦©žª"
47932>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lpar         To DD_DISPLAYONLY
47933>>>>>>>
47933>>>>>>>        // Baxio.Baxio_Bank00000
47933>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Bank00000    To "dbComboForm_EZ"
47934>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Bank00000    To (Baxio_Baxio_Bank_VT(Self))
47935>>>>>>>
47935>>>>>>>        // Baxio.Baxio_Hmniae
47935>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmniae       To "dbSpinForm_EZ"
47936>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmniae       To "†£/¤å˜ „¡›¦©žª"
47937>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmniae       To "†£/¤å˜ „¡›¦©žª"
47938>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniae       To (sl037(Self))
47939>>>>>>>
47939>>>>>>>        // Baxio.Baxio_Hmniap000
47939>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmniap000    To "dbSpinForm_EZ"
47940>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmniap000    To "†£/¤å˜ ˜¨˜¢˜™ãª"
47941>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmniap000    To "†£/¤å˜ ˜¨˜¢˜™ãª"
47942>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniap000    To (sl037(Self))
47943>>>>>>>
47943>>>>>>>        // Baxio.Baxio_Hmnial
47943>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmnial       To "dbSpinForm_EZ"
47944>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmnial       To "†£/¤å˜ Šã¥žª"
47945>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmnial       To "†£/¤å˜ Šã¥žª"
47946>>>>>>>        Set Field_Options          Field Baxio.Baxio_Hmnial       To DD_REQUIRED
47947>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmnial       To (sl037(Self))
47948>>>>>>>
47948>>>>>>>        // Baxio.Baxio_Ekdoths
47948>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Ekdoths      To "€¨® ¡æª „¡›æ«žª"
47949>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Ekdoths      To "€¨®.„¡›æ«žª"
47950>>>>>>>
47950>>>>>>>        // Baxio.Baxio_Ekdothse
47950>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Ekdothse     To "„§à¤¬£å˜ €¨® ¡¦ç „¡›æ«ž"
47951>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Ekdothse     To "„§à¤¬£å˜"
47952>>>>>>>
47952>>>>>>>        // Baxio.Baxio_Sediatagh
47952>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Sediatagh    To "‘œ ƒ ˜«˜šã"
47953>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Sediatagh    To "‘œ ƒ ˜«˜šã"
47954>>>>>>>
47954>>>>>>>        // Baxio.Baxio_Sdiataghe
47954>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Sdiataghe    To "„§à¤¬£å˜ €¨® ¡¦ç ƒ ¡˜ ¦ç®¦¬"
47955>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Sdiataghe    To "„§à¤¬£å˜"
47956>>>>>>>
47956>>>>>>>        // Baxio.Baxio_Banka
47956>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Banka        To "dbComboForm_EZ"
47957>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Banka        To "’¨á§œ˜"
47958>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Banka        To "’¨á§œ˜"
47959>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Banka        To (Baxio_Baxio_Banka_VT(Self))
47960>>>>>>>
47960>>>>>>>        // Baxio.Baxio_Opistho
47960>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Opistho      To "Š¦ §¦å Ž§ ©Ÿ¦š¨á­¦ "
47961>>>>>>>
47961>>>>>>>        // Baxio.Baxio_No
47961>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_No           To "€¨ Ÿ£æª"
47962>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_No           To "€¨ Ÿ£æª"
47963>>>>>>>
47963>>>>>>>        // Baxio.Baxio_V2
47963>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_V2           To "¦©æ"
47964>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_V2           To "¦©æ"
47965>>>>>>>        Set Field_Options          Field Baxio.Baxio_V2           To DD_REQUIRED
47966>>>>>>>
47966>>>>>>>        // Baxio.Baxio_V0
47966>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_V0           To "¦©æ ‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª"
47967>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_V0           To "¦©æ(‰¬¨. Œæ£.•¨.)"
47968>>>>>>>
47968>>>>>>>        // Baxio.Baxio_V00
47968>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_V00          To "¦©æ ƒœ¬«œ¨œç¦¤  Œæ£ ©£˜ •¨ã©œàª"
47969>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_V00          To "¦©æ(ƒœ¬«. Œæ£.•¨.)"
47970>>>>>>>
47970>>>>>>>        // Baxio.Baxio_Vr
47970>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Vr           To "¦©æ Œæ£ ©£˜ Reporting"
47971>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Vr           To "¦©æ( Œæ£.Rep.)"
47972>>>>>>>
47972>>>>>>>        // Baxio.Baxio_Rate0
47972>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Rate0        To "Rate 1"
47973>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Rate0        To "Rate 1"
47974>>>>>>>
47974>>>>>>>        // Baxio.Baxio_Rate00
47974>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Rate00       To "Rate 2"
47975>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Rate00       To "Rate 2"
47976>>>>>>>
47976>>>>>>>        // Baxio.Baxio_Rater
47976>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Rater        To "Rate 3"
47977>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Rater        To "Rate 3"
47978>>>>>>>
47978>>>>>>>        // Baxio.Baxio_C_Code2
47978>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_C_Code2      To "dbComboForm_EZ"
47979>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_C_Code2      To "Œæ£ ©£˜"
47980>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_C_Code2      To "Œæ£ ©£˜"
47981>>>>>>>        Set Field_Options          Field Baxio.Baxio_C_Code2      To DD_REQUIRED
47982>>>>>>>
47982>>>>>>>        // Baxio.Baxio_Lixi_Yyyy
47982>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Yyyy    To DD_DISPLAYONLY
47983>>>>>>>
47983>>>>>>>        // Baxio.Baxio_Lixi_Mm
47983>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Mm      To DD_DISPLAYONLY
47984>>>>>>>
47984>>>>>>>        // Baxio.Baxio_Lixi_Dd
47984>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Dd      To DD_DISPLAYONLY
47985>>>>>>>
47985>>>>>>>        // Baxio.Baxio_Bmove_Laa
47985>>>>>>>        Set Field_Options          Field Baxio.Baxio_Bmove_Laa    To DD_DISPLAYONLY
47986>>>>>>>
47986>>>>>>>    End_Procedure    // Define_Fields
47987>>>>>>>
47987>>>>>>>
47987>>>>>>>    Procedure Field_Defaults
47988>>>>>>>        Forward Send Field_Defaults
47990>>>>>>>        //DDB-Generated-Code-Location
47990>>>>>>>        //DDB-FieldDefaultStart
47990>>>>>>>        Set Field_Changed_Value   Field Baxio.Baxio_Status To 1
47991>>>>>>>        Set Field_Changed_Value   Field Baxio.Baxio_Place To 1
47992>>>>>>>        //DDB-FieldDefaultEnd
47992>>>>>>>    End_Procedure    // Field_Defaults
47993>>>>>>>
47993>>>>>>>End_Class    // Baxio_DataDictionary
47994>>>>>>>//DDB-Selection-pkg-Start
47994>>>>>>>
47994>>>>>>>Use SL037.SL         // SL037
47994>>>>>>>Use slnomism.sl      // slNomism
47994>>>>>>>
47994>>>>>>>//DDB-Selection-pkg-End
47994>>>>>>>//DDB-FileEnd
47994>>>>>
47994>>>>>//AB-IgnoreEnd
47994>>>>>
47994>>>>>Object SL037 is a dbModalPanelSub
47996>>>>>
47996>>>>>    //AB-StoreTopStart
47996>>>>>                        
47996>>>>>    Property Integer piFragmaBaxiokatRec0 Public  0
47998>>>>>    Property Integer piFragmaBaxiokatCode Public  0
48000>>>>>    Property Integer piFragmaBaxioStatus  Public  0
48002>>>>>    Property Integer piFragmaBaxioPlace   Public  0
48004>>>>>    Property string  psfragmaclient       Public ''
48006>>>>>    Property String  psFragmaBaxioStatus  Public ''
48008>>>>>    Property String  psEkdoths            Public ''
48010>>>>>    Property String  psApodekths          Public ''
48012>>>>>    Property Date pdApo                   Public ''
48014>>>>>    Property Date pdEos                   Public ''
48016>>>>>    
48016>>>>>    //AB-StoreTopEnd
48016>>>>>
48016>>>>>    Set Label to "‰˜«á¢¦š¦ª €¥ ¦š¨á­à¤"
48017>>>>>    Set Size to 287 527
48018>>>>>    Set Location to 2 3
48019>>>>>    Set Exit_Application_Local_State to FALSE
48020>>>>>    Set Modal_State to FALSE
48021>>>>>
48021>>>>>    //AB-DDOStart
48021>>>>>
48021>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
48023>>>>>    End_Object    // Baxiokat_DD
48024>>>>>
48024>>>>>    Object Baxio_DD is a Baxio_DataDictionary
48026>>>>>        Set DDO_Server to (Baxiokat_DD(self))
48027>>>>>
48027>>>>>        //AB-StoreStart
48027>>>>>                                                    
48027>>>>>        Function fiIsOK Returns Integer
48029>>>>>            String lsBaxioStatus sclient
48030>>>>>            Get psFragmaBaxioStatus  to lsBaxioStatus
48031>>>>>            Get psfragmaclient       to sclient
48032>>>>>            If (Trim(sClient)='') Begin
48034>>>>>                If (lsBaxioStatus Contains Baxio.Baxio_Status) Function_Return 1
48037>>>>>            End
48037>>>>>>
48037>>>>>            Else Begin
48038>>>>>                If (baxio.baxio_desm Eq sClient And lsBaxioStatus Contains Baxio.Baxio_Status) Function_Return 1
48041>>>>>            End
48041>>>>>>
48041>>>>>            Function_Return 0
48042>>>>>        End_Function
48043>>>>>        
48043>>>>>        Procedure OnConstrain
48045>>>>>        
48045>>>>>            Integer liBaxiokatCode liBaxioStatus liBaxioPlace
48046>>>>>            string  sclient lsBaxioStatus sApodekths sEkdoths
48046>>>>>            Date    dApo dEos
48046>>>>>        
48046>>>>>            Forward Send OnConstrain
48048>>>>>        
48048>>>>>            Get piFragmaBaxiokatCode    to liBaxiokatCode
48049>>>>>            Get psFragmaBaxioStatus     to lsBaxioStatus
48050>>>>>            Get piFragmaBaxioPlace      to liBaxioPlace
48051>>>>>        
48051>>>>>            Get psApodekths             to sApodekths
48052>>>>>            Get psEkdoths               to sEkdoths
48053>>>>>            Get pdApo                   to dApo
48054>>>>>            Get pdEos                   to dEos
48055>>>>>        
48055>>>>>            If (liBaxioKatCode <> 0) Begin
48057>>>>>                Constrain Baxio.Baxiokat_Code eq liBaxiokatCode
48059>>>>>                If (liBaxioPlace  <> 0)  Constrain Baxio.Baxio_Place eq liBaxioPlace
48063>>>>>                If (lsBaxioStatus <> '') Constrain Baxio as (fiIsOK(Self)=1)
48066>>>>>            End
48066>>>>>>
48066>>>>>        
48066>>>>>            If (sApodekths  <>'') Constrain Baxio.Baxio_Code_Out    Eq sApodekths
48070>>>>>            If (sEkdoths    <>'') Constrain Baxio.Baxio_Code_In     Eq sEkdoths
48074>>>>>            If (dApo        <>'') Constrain Baxio.Baxio_HmniaL      Ge dApo
48078>>>>>            If (dEos        <>'') Constrain Baxio.Baxio_HmniaL      Le dEos
48082>>>>>        
48082>>>>>        End_Procedure // OnConstrain
48083>>>>>        
48083>>>>>        
48083>>>>>        
48083>>>>>        
48083>>>>>        
48083>>>>>        
48083>>>>>        
48083>>>>>        
48083>>>>>        
48083>>>>>        
48083>>>>>        
48083>>>>>        
48083>>>>>        
48083>>>>>        //AB-StoreEnd
48083>>>>>
48083>>>>>    End_Object    // Baxio_DD
48084>>>>>
48084>>>>>    Set Main_DD to (Baxio_DD(self))
48085>>>>>    Set Server to (Baxio_DD(self))
48086>>>>>
48086>>>>>    //AB-DDOEnd
48086>>>>>
48086>>>>>    Object oSelList is a dbListSub
48088>>>>>        Set Main_File to Baxio.File_Number
48089>>>>>        Set Size to 228 514
48090>>>>>        Set Location to 4 6
48091>>>>>
48091>>>>>        Begin_Row
48094>>>>>            Entry_Item Baxio.Baxio_code
48095>>>>>            Entry_Item Baxio.Baxio_epon_in
48096>>>>>            Entry_Item Baxio.Baxio_epon_out
48097>>>>>            Entry_Item Baxiokat.Baxiokat_descr
48098>>>>>            Entry_Item Baxio.Baxio_hmnial
48099>>>>>            Entry_Item Baxio.Baxio_v2
48100>>>>>            Entry_Item Baxio.Baxio_banka
48101>>>>>            Entry_Item (Export_Code_Description(Self,6,Baxio.Baxio_banka))
48102>>>>>            Entry_Item Baxio.Baxio_no
48103>>>>>        End_Row
48108>>>>>
48108>>>>>        Set Form_Width    item 0 to 41
48109>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
48110>>>>>        
48110>>>>>        Set Form_Width    item 1 to 98
48111>>>>>        Set Header_Label  item 1 to "„¡›æ«žª"
48112>>>>>        
48112>>>>>        Set Form_Width    item 2 to 94
48113>>>>>        Set Header_Label  item 2 to "€§¦›â¡«žª"
48114>>>>>        
48114>>>>>        Set Form_Width    item 3 to 75
48115>>>>>        Set Header_Label  item 3 to "œ¨ š¨˜­ã"
48116>>>>>        
48116>>>>>        Set Form_Width    item 4 to 47
48117>>>>>        Set Header_Label  item 4 to "Šã¥ž"
48118>>>>>        
48118>>>>>        Set Form_Width    item 5 to 48
48119>>>>>        Set Header_Label  item 5 to "¦©æ"
48120>>>>>        
48120>>>>>        Set Form_Width    item 6 to 12
48121>>>>>        Set Header_Label  item 6 to "‰à› ¡æª ’¨á§œ˜"
48122>>>>>        
48122>>>>>        Set Form_Width    item 7 to 42
48123>>>>>        Set Header_Label  item 7 to "’¨á§œ˜"
48124>>>>>        
48124>>>>>        Set Form_Width    item 8 to 53
48125>>>>>        Set Header_Label  item 8 to "€¨ Ÿ£æª"
48126>>>>>        
48126>>>>>
48126>>>>>        //AB-StoreStart
48126>>>>>                
48126>>>>>        Property Integer piStoreFragmaBaxiokatRec0 Public 0
48128>>>>>        Property Integer piStoreFragmaBaxiokatCode Public 0
48130>>>>>        Property Integer piStoreFragmaBaxioStatus  Public 0
48132>>>>>        Property Integer piStoreFragmaBaxioPlace   Public 0
48134>>>>>        Property String  psStoreFragmaBaxioStatus  Public ''
48136>>>>>        
48136>>>>>        Procedure Store_Defaults
48138>>>>>            Forward Send Store_Defaults
48140>>>>>            Set piStoreFragmaBaxiokatRec0 to (piFragmaBaxiokatRec0(Self))
48141>>>>>            Set piStoreFragmaBaxiokatCode to (piFragmaBaxiokatCode(Self))
48142>>>>>            Set piStoreFragmaBaxioStatus  to (piFragmaBaxioStatus(Self))
48143>>>>>            Set piStoreFragmaBaxioPlace   to (piFragmaBaxioPlace(Self))
48144>>>>>            Set psStoreFragmaBaxioStatus  to (psFragmaBaxioStatus(Self))
48145>>>>>        End_Procedure // Store_Defaults
48146>>>>>        
48146>>>>>        Procedure Restore_Defaults
48148>>>>>            Forward Send Restore_Defaults
48150>>>>>            Set piFragmaBaxiokatRec0 to (piStoreFragmaBaxiokatRec0(Self))
48151>>>>>            Set piFragmaBaxiokatCode to (piStoreFragmaBaxiokatCode(Self))
48152>>>>>            Set piFragmaBaxioStatus  to (piStoreFragmaBaxioStatus(Self))
48153>>>>>            Set piFragmaBaxioPlace   to (piStoreFragmaBaxioPlace(Self))
48154>>>>>            Set psFragmaBaxioStatus  to (psStoreFragmaBaxioStatus(Self))
48155>>>>>        End_Procedure // Restore_Defaults
48156>>>>>        
48156>>>>>        Procedure Activating
48158>>>>>            Forward Send Activating
48160>>>>>         //   Set Auto_Index_State        to True
48160>>>>>            Send Rebuild_Constraints    to Baxio_DD
48161>>>>>        End_Procedure
48162>>>>>        
48162>>>>>        Procedure End_Construct_Object
48164>>>>>            Integer iDecs
48165>>>>>            Forward Send End_Construct_Object
48167>>>>>            Get fiDekadika_Nomismatos SysCurXr.C_Code0  to    iDecs
48168>>>>>            Set Points Item 5 to iDecs
48169>>>>>            Set Numeric_Mask Item 5 to 10 iDecs ' ,*'
48170>>>>>        End_Procedure
48171>>>>>        
48171>>>>>        
48171>>>>>        
48171>>>>>        
48171>>>>>        
48171>>>>>        
48171>>>>>        
48171>>>>>        
48171>>>>>        
48171>>>>>        
48171>>>>>        
48171>>>>>        //AB-StoreEnd
48171>>>>>
48171>>>>>    End_Object    // oSelList
48172>>>>>
48172>>>>>    Object TextBoxSub1 is a TextBoxSub
48174>>>>>        Set Label to "Šã¥ž ˜§¦"
48175>>>>>        Set Location to 241 7
48176>>>>>        Set Size to 10 35
48177>>>>>        Set TypeFace to "MS Sans Serif"
48178>>>>>    End_Object    // TextBoxSub1
48179>>>>>
48179>>>>>    Object cSyDateForm1 is a cSyDateForm
48181>>>>>        Set Size to 13 66
48182>>>>>        Set Location to 240 45
48183>>>>>        Set Label_Col_Offset to 2
48184>>>>>        Set Label_Justification_Mode to jMode_Right
48185>>>>>        Set Form_Mask Item 0 to "d/M/yyyy"
48186>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48187>>>>>
48187>>>>>        //AB-StoreStart
48187>>>>>                                                    
48187>>>>>        Procedure Key Integer iKey
48189>>>>>            Integer iRetVal
48190>>>>>            Forward Send Key iKey
48192>>>>>            If (iKey=277) Begin
48194>>>>>                Set Value Item 0 to ''
48195>>>>>                //Send KeyAction to ButtonSub1
48195>>>>>            End
48195>>>>>>
48195>>>>>        End_Procedure
48196>>>>>        
48196>>>>>        
48196>>>>>        //AB-StoreEnd
48196>>>>>
48196>>>>>    End_Object    // cSyDateForm1
48197>>>>>
48197>>>>>    Object TextBoxSub2 is a TextBoxSub
48199>>>>>        Set Label to "Šã¥ž œàª"
48200>>>>>        Set Location to 258 7
48201>>>>>        Set Size to 10 35
48202>>>>>        Set TypeFace to "MS Sans Serif"
48203>>>>>    End_Object    // TextBoxSub2
48204>>>>>
48204>>>>>    Object cSyDateForm2 is a cSyDateForm
48206>>>>>        Set Size to 13 66
48207>>>>>        Set Location to 256 45
48208>>>>>        Set Label_Col_Offset to 2
48209>>>>>        Set Label_Justification_Mode to jMode_Right
48210>>>>>        Set Form_Mask Item 0 to "d/M/yyyy"
48211>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48212>>>>>
48212>>>>>        //AB-StoreStart
48212>>>>>                                                    
48212>>>>>        Procedure Key Integer iKey
48214>>>>>            Integer iRetVal
48215>>>>>            Forward Send Key iKey
48217>>>>>            If (iKey=277) Begin
48219>>>>>                Set Value Item 0 to ''
48220>>>>>                //Send KeyAction to ButtonSub1
48220>>>>>            End
48220>>>>>>
48220>>>>>        End_Procedure
48221>>>>>        
48221>>>>>        
48221>>>>>        //AB-StoreEnd
48221>>>>>
48221>>>>>    End_Object    // cSyDateForm2
48222>>>>>
48222>>>>>    Object TextBoxSub4 is a TextBoxSub
48224>>>>>        Set Label to "„¡›æ«žª"
48225>>>>>        Set Location to 241 118
48226>>>>>        Set Size to 10 33
48227>>>>>        Set TypeFace to "MS Sans Serif"
48228>>>>>    End_Object    // TextBoxSub4
48229>>>>>
48229>>>>>    Object TextBoxSub5 is a TextBoxSub
48231>>>>>        Set Label to "€§¦›â¡«žª"
48232>>>>>        Set Location to 258 118
48233>>>>>        Set Size to 10 39
48234>>>>>        Set TypeFace to "MS Sans Serif"
48235>>>>>    End_Object    // TextBoxSub5
48236>>>>>
48236>>>>>    Object FormSub1 is a FormSub
48238>>>>>        Set Size to 13 77
48239>>>>>        Set Location to 240 159
48240>>>>>        Set Label_Col_Offset to 2
48241>>>>>        Set Prompt_Button_Mode to pb_PromptOn
48242>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48243>>>>>
48243>>>>>        //AB-StoreStart
48243>>>>>                                                    
48243>>>>>        Set Prompt_Object to (sl100(Self))
48244>>>>>        
48244>>>>>        Procedure OnChange
48246>>>>>            String s1
48247>>>>>            Get Value Item 0 to s1
48248>>>>>            Set Value Of FormSub2 Item 0 to (fsClient(Self,s1))
48249>>>>>            Set psEkdoths to s1
48250>>>>>        End_Procedure
48251>>>>>        
48251>>>>>        
48251>>>>>        
48251>>>>>        
48251>>>>>        
48251>>>>>        
48251>>>>>        
48251>>>>>        //AB-StoreEnd
48251>>>>>
48251>>>>>    End_Object    // FormSub1
48252>>>>>
48252>>>>>    Object FormSub2 is a FormSub
48254>>>>>        Set Size to 13 187
48255>>>>>        Set Location to 240 240
48256>>>>>        Set Color to clBtnFace
48257>>>>>        Set Label_Col_Offset to 2
48258>>>>>        Set Enabled_State to FALSE
48259>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48260>>>>>        Set Item_Shadow_State Item 0 to TRUE
48261>>>>>        Set Shadow_State Item 0 to TRUE
48262>>>>>    End_Object    // FormSub2
48263>>>>>
48263>>>>>    Object FormSub3 is a FormSub
48265>>>>>        Set Size to 13 77
48266>>>>>        Set Location to 256 159
48267>>>>>        Set Label_Col_Offset to 2
48268>>>>>        Set Prompt_Button_Mode to pb_PromptOn
48269>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48270>>>>>
48270>>>>>        //AB-StoreStart
48270>>>>>                                                    
48270>>>>>        Set Prompt_Object to (sl100(Self))
48271>>>>>        
48271>>>>>        Procedure OnChange
48273>>>>>            String s1
48274>>>>>            Get Value Item 0 to s1
48275>>>>>            Set Value Of FormSub4 Item 0 to (fsClient(Self,s1))
48276>>>>>            Set psApodekths to s1
48277>>>>>        End_Procedure
48278>>>>>        
48278>>>>>        
48278>>>>>        
48278>>>>>        
48278>>>>>        
48278>>>>>        
48278>>>>>        
48278>>>>>        //AB-StoreEnd
48278>>>>>
48278>>>>>    End_Object    // FormSub3
48279>>>>>
48279>>>>>    Object FormSub4 is a FormSub
48281>>>>>        Set Size to 13 187
48282>>>>>        Set Location to 256 240
48283>>>>>        Set Color to clBtnFace
48284>>>>>        Set Label_Col_Offset to 2
48285>>>>>        Set Enabled_State to FALSE
48286>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48287>>>>>        Set Item_Shadow_State Item 0 to TRUE
48288>>>>>        Set Shadow_State Item 0 to TRUE
48289>>>>>    End_Object    // FormSub4
48290>>>>>
48290>>>>>    Object ButtonSub1 is a ButtonSub
48292>>>>>        Set Label to "œ¨ æ¨ ©œ"
48293>>>>>        Set Size to 14 43
48294>>>>>        Set Location to 256 430
48295>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48296>>>>>
48296>>>>>        //AB-StoreStart
48296>>>>>                                                    
48296>>>>>        Procedure OnClick
48298>>>>>            Date dApo dEos
48299>>>>>            Get Value Of cSyDateForm1 Item 0 to dApo
48300>>>>>            Get Value Of cSyDateForm2 Item 0 to dEos
48301>>>>>            Set pdApo to dApo
48302>>>>>            Set pdEos to dEos
48303>>>>>            Send Rebuild_Constraints to Baxio_DD
48304>>>>>            Send Beginning_Of_Data to oSelList True
48305>>>>>        End_Procedure // OnClick
48306>>>>>        
48306>>>>>        
48306>>>>>        
48306>>>>>        
48306>>>>>        
48306>>>>>        
48306>>>>>        
48306>>>>>        
48306>>>>>        
48306>>>>>        
48306>>>>>        
48306>>>>>        
48306>>>>>        
48306>>>>>        //AB-StoreEnd
48306>>>>>
48306>>>>>    End_Object    // ButtonSub1
48307>>>>>
48307>>>>>    Object oOK_bn is a ButtonSub
48309>>>>>        Set Label to "&„§ ¢¦šã"
48310>>>>>        Set Size to 14 43
48311>>>>>        Set Location to 256 478
48312>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48313>>>>>
48313>>>>>        //AB-StoreStart
48313>>>>>        Procedure OnClick
48315>>>>>            Send OK To oSelList
48316>>>>>        End_Procedure
48317>>>>>        //AB-StoreEnd
48317>>>>>
48317>>>>>    End_Object    // oOK_bn
48318>>>>>
48318>>>>>
48318>>>>>    //AB-StoreStart
48318>>>>>                        
48318>>>>>    On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
48319>>>>>    
48319>>>>>    Procedure Request_Cancel
48321>>>>>        Set Value Of cSyDateForm1 Item 0 to ''
48322>>>>>        Set Value Of cSyDateForm2 Item 0 to ''
48323>>>>>        Set Value Of FormSub1     Item 0 to ''
48324>>>>>        Set Value Of FormSub2     Item 0 to ''
48325>>>>>        Forward Send Request_Cancel
48327>>>>>    End_Procedure
48328>>>>>    
48328>>>>>    
48328>>>>>    
48328>>>>>    
48328>>>>>    
48328>>>>>    //AB-StoreEnd
48328>>>>>
48328>>>>>End_Object    // SL037
48329>>>>>
48329>>>>>
48329>>>>>//AB-StoreStart
48329>>>>>    
48329>>>>>//AB-StoreEnd
48329>>>>>
48329>>>>>//AB/ End_Object    // prj
48329>>>Use sl041.sl
48329>>>Use sl045.sl
INCLUDING FILE: SL045.SL
48329>>>>>//AB/ Project sl045: Wcmoves lookup
48329>>>>>//AB/     Object prj is a Lookup_Project
48329>>>>>//AB/         Set ProjectName to "sl045: Wcmoves lookup"
48329>>>>>//AB/         Set ProjectFileName to "sl045.SL"
48329>>>>>//AB/         Set GenerateFileName to "NONAME"
48329>>>>>
48329>>>>>// Project Object Structure
48329>>>>>//   sl045 is a dbModalPanelSub
48329>>>>>//     Wcmoves_DD is a DataDictionary
48329>>>>>//     oSelList is a dbListSub
48329>>>>>//     cSyDateForm1 is a cSyDateForm
48329>>>>>//     FormSub1 is a FormSub
48329>>>>>//     FormSub3 is a FormSub
48329>>>>>//     oOK_bn is a ButtonSub
48329>>>>>//     oSearch_bn is a ButtonSub
48329>>>>>//     ButtonSub1 is a ButtonSub
48329>>>>>//     TextBoxSub1 is a TextBoxSub
48329>>>>>//     TextBoxSub2 is a TextBoxSub
48329>>>>>
48329>>>>>// Register all objects
48329>>>>>Register_Object ButtonSub1
48329>>>>>Register_Object cSyDateForm1
48329>>>>>Register_Object FormSub1
48329>>>>>Register_Object FormSub3
48329>>>>>Register_Object oOK_bn
48329>>>>>Register_Object oSearch_bn
48329>>>>>Register_Object oSelList
48329>>>>>Register_Object sl045
48329>>>>>Register_Object TextBoxSub1
48329>>>>>Register_Object TextBoxSub2
48329>>>>>Register_Object Wcmoves_DD
48329>>>>>
48329>>>>>
48329>>>>>
48329>>>>>    //AB-StoreTopStart
48329>>>>>    use sl22s.sl
48329>>>>>    
48329>>>>>    //AB-StoreTopEnd
48329>>>>>
48329>>>>>    //AB-IgnoreStart
48329>>>>>
48329>>>>>    Use DFAllEnt.pkg
48329>>>>>    Use dbList.Sub
48329>>>>>    Use cSyDateForm.Pkg
48329>>>>>    Use Form.Sub
48329>>>>>    Use Button.Sub
48329>>>>>    Use Txtbox.Sub
48329>>>>>
48329>>>>>
48329>>>>>    Use WCMOVES.DD
INCLUDING FILE: WCMOVES.DD
48329>>>>>>>//DDB-FileStart
48329>>>>>>>//DDB-HeaderStart
48329>>>>>>>
48329>>>>>>>// File Name : WCMOVES.DD
48329>>>>>>>// Class Name: Wcmoves_DataDictionary
48329>>>>>>>// Revision  : 72
48329>>>>>>>// Version   : 2
48329>>>>>>>
48329>>>>>>>Use  Windows           // Basic Definitions
48329>>>>>>>Use  DataDict          // DataDictionary Class Definition
48329>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48329>>>>>>>
48329>>>>>>>Open Wcmoves
48331>>>>>>>Open Wtypkin
48333>>>>>>>Open Wax
48335>>>>>>>Open Witemx
48337>>>>>>>Open Sysrecw
48339>>>>>>>Open Wam
48341>>>>>>>
48341>>>>>>>//DDB-HeaderEnd
48341>>>>>>>//DDB-SelectionStart
48341>>>>>>>//DDB/ ExternalSelectionList sl045  sl045.SL
48341>>>>>>>//DDB/ ExternalSelectionList slNomism  slnomism.sl
48341>>>>>>>Register_Object sl045
48341>>>>>>>Register_Object slNomism
48341>>>>>>>//DDB-SelectionEnd
48341>>>>>>>
48341>>>>>>>Class Wcmoves_DataDictionary  is a DataDictionary_Sec
48342>>>>>>>
48342>>>>>>>   Procedure Construct_Object
48343>>>>>>>        Forward Send Construct_Object
48345>>>>>>>        Property Integer piFromxrhsh Public 0 //œ¤›œ ¥ž ¦«  œ¨®œ«˜  ˜§¦ €§¦š¨˜­ã ˜§¦Ÿã¡žª
48346>>>>>>>    End_Procedure
48347>>>>>>>
48347>>>>>>>    Function Validate_Save  Returns Integer
48348>>>>>>>        Integer iReturnVal iOpen_Items ifromxrhsh
48349>>>>>>>        String sModule
48349>>>>>>>        get pifromxrhsh to ifromxrhsh
48350>>>>>>>        Forward Get Validate_Save  To iReturnVal
48352>>>>>>>        If (Not(iReturnVal)) Begin
48354>>>>>>>            Clear Branch
48355>>>>>>>            Move SyscurXr.Company_Code  to Branch.Company_Code
48356>>>>>>>            Move SyscurXr.Branch_Code   to Branch.Branch_Code
48357>>>>>>>            Find Eq Branch By Index.1
48358>>>>>>>>
48358>>>>>>>            If (Not(Found)) Send Operation_Not_Allowed 6666
48361>>>>>>>            Else If ((Branch.Locked_Until<>'') And (WCmoves.WCmove_Hmnia<=Branch.Locked_Until)) Send Operation_Not_Allowed 6667
48365>>>>>>>
48365>>>>>>>            If (WCmoves.Prn_Theor='1') Move 8878 to iReturnVal
48368>>>>>>>            // ˜§¦ ˜§¦š¨˜­ã
48368>>>>>>>            Else If ((WCmoves.WCmove_Hmnia<SYSCURXR.YEAR_XRHSHFROM and ifromxrhsh<>1) Or ;                     (WCmoves.WCmove_Hmnia>SYSCURXR.YEAR_XRHSHTO and ifromxrhsh<>1))     ;                    Move 8877 to iReturnVal
48372>>>>>>>            Else If ((WCmoves.WCmove_QTY =0) And (WCmoves.Unit_Price=0)) Move 8833 to iReturnVal
48376>>>>>>>//                     (WCmoves.WCmove_Axia=0))    ;
48376>>>>>>>// js Allagh 26/08/2002 Gia na mporei na yparxei kinhsh Wcmoves
48376>>>>>>>//    me synolikh axia 0 (na exei timh monados alla p.x. ekptosh 100%)
48376>>>>>>>//    s' ena timologio polhshs.
48376>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
48379>>>>>>>        End
48379>>>>>>>>
48379>>>>>>>        Function_Return iReturnVal
48380>>>>>>>    End_Function   // Validate_Save
48381>>>>>>>
48381>>>>>>>    Function Validate_Delete  Returns Integer
48382>>>>>>>        Integer iReturnVal
48383>>>>>>>        String sModule
48383>>>>>>>        Forward Get Validate_Delete  To iReturnVal
48385>>>>>>>        If (Not(iReturnVal)) Begin
48387>>>>>>>
48387>>>>>>>            Clear Branch
48388>>>>>>>            Move SyscurXr.Company_Code  to Branch.Company_Code
48389>>>>>>>            Move SyscurXr.Branch_Code   to Branch.Branch_Code
48390>>>>>>>            Find Eq Branch By Index.1
48391>>>>>>>>
48391>>>>>>>            If (Not(Found)) Send Operation_Not_Allowed 6668
48394>>>>>>>            Else If ((Branch.Locked_Until<>'') And (WCmoves.WCmove_Hmnia<=Branch.Locked_Until)) Send Operation_Not_Allowed 6669
48398>>>>>>>
48398>>>>>>>            If (WCmoves.Prn_Theor='1') Move 8879 to iReturnVal
48401>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
48404>>>>>>>        End
48404>>>>>>>>
48404>>>>>>>        Function_Return iReturnVal
48405>>>>>>>    End_Function   // Validate_Delete
48406>>>>>>>
48406>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
48407>>>>>>>        String lsError_Message
48408>>>>>>>        Case Begin
48408>>>>>>>
48408>>>>>>>            Case (iError_Num = 6666)
48410>>>>>>>                Move "DDC 045: ‘­á¢£˜ 6666 €›ç¤˜«ž ž œšš¨˜­ž!\nƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ ¬§¦¡˜«˜©«ž£á«à¤" to lsError_Message
48411>>>>>>>            Case Break
48412>>>>>>>
48412>>>>>>>            Case (iError_Num = 6667)
48415>>>>>>>                Move "DDC 045: ‘­á¢£˜ 6667 €›ç¤˜«ž ž œšš¨˜­ž!\n†£/¤å˜ ¡å¤ž©žª §¨¦šœ¤â©«œ¨ž ž£/¤å˜ª ¡¢œ ›é£˜«¦ª" to lsError_Message
48416>>>>>>>            Case Break
48417>>>>>>>
48417>>>>>>>            Case (iError_Num = 6668)
48420>>>>>>>                Move "DDC 045: ‘­á¢£˜ 6668 €›ç¤˜«ž ž › ˜š¨˜­ã!\nƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ ¬§¦¡˜«˜©«ž£á«à¤" to lsError_Message
48421>>>>>>>            Case Break
48422>>>>>>>
48422>>>>>>>            Case (iError_Num = 6669)
48425>>>>>>>                Move "DDC 045: ‘­á¢£˜ 6669 €›ç¤˜«ž ž › ˜š¨˜­ã!\n†£/¤å˜ ¡å¤ž©žª §¨¦šœ¤â©«œ¨ž ž£/¤å˜ª ¡¢œ ›é£˜«¦ª" to lsError_Message
48426>>>>>>>            Case Break
48427>>>>>>>
48427>>>>>>>
48427>>>>>>>            Case (iError_Num = 8833)
48430>>>>>>>                Move "DDC 045:€›ç¤˜«ž ž œšš¨˜­ã!\n˜¥å˜ ¡˜  §¦©æ«ž«˜ œå¤˜  0" to lsError_Message
48431>>>>>>>            Case Break
48432>>>>>>>            Case (iError_Num = 8844)
48435>>>>>>>                Move "DDC 045: ’¦ ¬§æ¢¦ §¦ §¦©æ«ž«˜ª ˜§¦Ÿã¡žª §¨¦¡ç§«œ  ˜¨¤ž« ¡æ \n† «¨â®¦¬©˜ ¡å¤ž©ž ƒ„Œ Ÿ˜ ¡˜«˜®à¨žŸœå" to lsError_Message
48436>>>>>>>            Case Break
48437>>>>>>>            Case (iError_Num = 8877)
48440>>>>>>>                Move "DDC 045:€›ç¤˜«ž ž œšš¨˜­ž!\n\n†£œ¨¦£ž¤åœª œ¡«æª ¦¨åà¤ ®¨ã©žª" to lsError_Message
48441>>>>>>>            Case Break
48442>>>>>>>            Case (iError_Num = 8878)
48445>>>>>>>                Move "DDC 045:€›ç¤˜«ž ž œšš¨˜­ã!\n\„®œ  «¬§àŸœ  Ÿœà¨ž£â¤¦" to lsError_Message
48446>>>>>>>            Case Break
48447>>>>>>>            Case (iError_Num = 8879)
48450>>>>>>>                Move "DDC 045:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\„®œ  «¬§àŸœ  Ÿœà¨ž£â¤¦" to lsError_Message
48451>>>>>>>            Case Break
48452>>>>>>>            Case Else
48452>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
48454>>>>>>>        Case End
48454>>>>>>>        Error iError_Num lsError_Message
48455>>>>>>>>
48455>>>>>>>    End_Procedure // operation_not_allowed
48456>>>>>>>
48456>>>>>>>    Procedure Save_Main_File
48457>>>>>>>        If (Operation_Origin<>Self) Begin
48459>>>>>>>            If Wcmoves.Recnum Eq 0 Procedure_Return
48462>>>>>>>        End
48462>>>>>>>>
48462>>>>>>>        If (WCmoves.Cn_Code<>'') Begin
48464>>>>>>>            Clear Cn
48465>>>>>>>            Move WCmoves.Cn_Code    to Cn.Cn_Code
48466>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
48467>>>>>>>>
48467>>>>>>>            Move Cn.Cn_Sls_ID       to WCmoves.Sls_ID
48468>>>>>>>            Move Cn.CN_Cnt_ID       to WCmoves.Cnt_ID
48469>>>>>>>            Move Cn.Cn_Recr         to WCmoves.Cn_Recr
48470>>>>>>>            Move Cn.mhxanik_id      to Wcmoves.mhxanik_ID
48471>>>>>>>        End
48471>>>>>>>>
48471>>>>>>>        Else Begin
48472>>>>>>>            Move ''     to WCmoves.Sls_ID
48473>>>>>>>            Move ''     to WCmoves.Cnt_ID
48474>>>>>>>            Move ''     to WCmoves.Cn_Recr
48475>>>>>>>            Move ''     to Wcmoves.Mhxanik_ID
48476>>>>>>>        End
48476>>>>>>>>
48476>>>>>>>
48476>>>>>>>        Forward Send Save_Main_File
48478>>>>>>>    End_Procedure   // Save_Main_File
48479>>>>>>>
48479>>>>>>>    Procedure Enhm_Wam Number anQtyEisa Number anQtyExa Number anXre Number anPis Integer iSign
48480>>>>>>>        Integer isFound ifromxrhsh
48481>>>>>>>        get pifromxrhsh to ifromxrhsh
48482>>>>>>>        Move 0 to isFound
48483>>>>>>>
48483>>>>>>>        // 02/10/2001 js
48483>>>>>>>        // Klhsh apo Backout kai Update
48483>>>>>>>        Clear Wam
48484>>>>>>>        Move SysCurXR.Company_Code  to Wam.Company_Code
48485>>>>>>>        Move SysCurXR.Branch_Code   to Wam.Branch_Code
48486>>>>>>>        // ¡ ¤ã©œ ª ˜§¦š¨˜­ãª ¤˜ œ¤ž£œ¨é©¦¬¤ ˜§æŸœ£˜ ¤â˜ª ®¨ã©žª
48486>>>>>>>        if (ifromxrhsh=1) move (syscurxr.year_year+1) to wam.year_year
48489>>>>>>>        else              Move SysCurXR.Year_Year     to Wam.Year_Year
48491>>>>>>>        Move Wapokat.Wapokat_Code   to Wam.Wapokat_Code
48492>>>>>>>        Move Wapomast.Wapomast_Code to Wam.Wapomast_Code
48493>>>>>>>        Move Wax.Wax_Code           to Wam.Wax_Code
48494>>>>>>>        Move Witemkat.Witemkat_Code to Wam.Witemkat_Code
48495>>>>>>>        Move Units.Units_Code       to Wam.Units_Code
48496>>>>>>>        Move Item.Item_Code         to Wam.Item_Code
48497>>>>>>>        Move Witemx.Witemx_Code     to Wam.Witemx_Code
48498>>>>>>>        Find Eq Wam By Index.1
48499>>>>>>>>
48499>>>>>>>        If (Not(Found)) Begin
48501>>>>>>>            Move (SysrecW.Wam_Rec0+1)   to Wam.Wam_Rec0
48502>>>>>>>            Move (SysrecW.Wam_Rec0+1)   to SysrecW.Wam_Rec0
48503>>>>>>>            Saverecord SysrecW
48504>>>>>>>            Move (Append('',((Trim(SysCurXR.Branch_Site))+;                             (Trim(String(Wam.Wam_Rec0)))))) to Wam.Wam_Recr
48505>>>>>>>            Move Witemx.Witemx_Recr to Wam.Witemx_Recr
48506>>>>>>>            Move Wax.Wax_Recr       to Wam.Wax_Recr
48507>>>>>>>        End
48507>>>>>>>>
48507>>>>>>>        Add (anQtyEisa*iSign)       to Wam.Wam_qty_Eisa
48508>>>>>>>        Add (anQtyExa *iSign)       to Wam.Wam_qty_Exa
48509>>>>>>>        Add (anXre    *iSign)       to Wam.Wam_Amt_Eisa
48510>>>>>>>        Add (anPis    *iSign)       to Wam.Wam_Amt_Exa
48511>>>>>>>
48511>>>>>>>        Move (Wam.Wam_Qty_Eisa-Wam.Wam_Qty_Exa) to Wam.Wam_Qty_Apoth
48512>>>>>>>        Move (Wam.Wam_Amt_Eisa-Wam.Wam_Amt_Exa) to Wam.Wam_Amt_Apoth
48513>>>>>>>
48513>>>>>>>        Saverecord Wam
48514>>>>>>>
48514>>>>>>>        If (Sysfile.Chk_Apothema='1') Begin
48516>>>>>>>            If ((Wam.Wam_qty_Exa  >Wam.Wam_qty_Eisa) Or ;                (Wam.Wam_Qty_Apoth<0)) Send Operation_Not_Allowed 8844
48519>>>>>>>        End
48519>>>>>>>>
48519>>>>>>>        // 02/10/2001 js
48519>>>>>>>    End_Procedure
48520>>>>>>>
48520>>>>>>>    // Update:
48520>>>>>>>    Procedure Update
48521>>>>>>>        integer ifromxrhsh
48522>>>>>>>        Number nx np nqtyx nqtyp
48522>>>>>>>        Forward Send Update
48524>>>>>>>        get pifromxrhsh to ifromxrhsh
48525>>>>>>>        // Insert Code Here
48525>>>>>>>        Move SysCurXR.Company_Code  to WCmoves.Company_Code
48526>>>>>>>        Move SysCurXR.Branch_Code   to WCmoves.Branch_Code
48527>>>>>>>        // ¤˜ š¨á¯œ  ˜§¦š¨˜­ã ©«¦ œ«¦ª + 1
48527>>>>>>>        if (ifromxrhsh=1) move (syscurxr.year_year+1) to wcmoves.year_year
48530>>>>>>>        else              Move SysCurXR.Year_Year     to Wcmoves.Year_Year
48532>>>>>>>       // Move SysCurXR.Year_Year     to WCmoves.Year_Year
48532>>>>>>>        Move Wtypkin.Wtypkin_Code   to WCmoves.Wtypkin_Code
48533>>>>>>>        Move Wapokat.Wapokat_Code   to WCmoves.Wapokat_Code
48534>>>>>>>        Move Wapomast.Wapomast_Code to WCmoves.Wapomast_Code
48535>>>>>>>        Move Wax.Wax_Code           to WCmoves.Wax_Code
48536>>>>>>>        Move Witemkat.Witemkat_Code to WCmoves.Witemkat_Code
48537>>>>>>>        Move Units.Units_Code       to WCmoves.Units_Code
48538>>>>>>>        Move Item.Item_Code         to WCmoves.Item_Code
48539>>>>>>>        Move Witemx.Witemx_Code     to WCmoves.Witemx_Code
48540>>>>>>>
48540>>>>>>>
48540>>>>>>>        Move 0 to nx
48541>>>>>>>        Move 0 to np
48542>>>>>>>        Move 0 to nqtyx
48543>>>>>>>        Move 0 to nqtyp
48544>>>>>>>
48544>>>>>>>        // js 13/02/2002
48544>>>>>>>        // An ta extra pedia timon den exoun timh tote to wcmoves enhmeronei me axies
48544>>>>>>>        If (Wcmoves.Wcmov_Axia=0) Begin
48546>>>>>>>                 If (Wcmoves.Wcmove_X0<>0)  Move Wcmoves.Wcmov_Totamad0 to nx
48549>>>>>>>            Else If (Wcmoves.Wcmove_P0<>0)  Move Wcmoves.Wcmov_Totamad0 to np
48553>>>>>>>        End
48553>>>>>>>>
48553>>>>>>>        // An ta extra pedia posothton den exoun timh tote to wcmoves enhmeronei me posothtes
48553>>>>>>>        If ((Wcmoves.Sx_Posothta_Eis=0) And (Wcmoves.Sx_Posothta_Ex=0)) Begin
48555>>>>>>>                 If (Wcmoves.Wcmove_Qty_Eisa<>0) Move Wcmoves.Wcmove_Qty_Eisa   to nqtyx
48558>>>>>>>            Else If (Wcmoves.Wcmove_Qty_Exa <>0) Move Wcmoves.Wcmove_Qty_Exa    to nqtyp
48562>>>>>>>        End
48562>>>>>>>>
48562>>>>>>>
48562>>>>>>>        Add nqtyx   to witemx.qty_xre
48563>>>>>>>        Add nqtyp   to witemx.qty_pis
48564>>>>>>>        Add nx      to witemx.axia_xre
48565>>>>>>>        Add np      to witemx.axia_pis
48566>>>>>>>
48566>>>>>>>        // 02/10/2001 Enhmerosh arxeiou WAM
48566>>>>>>>        Send Enhm_Wam   nqtyx   ;                        nqtyp   ;                        nx      ;                        np      ;                        1
48567>>>>>>>
48567>>>>>>>        If (Wcmoves.Wcmove_SC_Code2='') ;             Move SyscurXr.C_Code0 to Wcmoves.Wcmove_SC_Code2
48570>>>>>>>
48570>>>>>>>
48570>>>>>>>    End_Procedure   // Update
48571>>>>>>>
48571>>>>>>>     // Backout:
48571>>>>>>>    Procedure Backout
48572>>>>>>>        Number nx np nqtyx nqtyp
48573>>>>>>>        Forward Send Backout
48575>>>>>>>
48575>>>>>>>        Move 0 to nx
48576>>>>>>>        Move 0 to np
48577>>>>>>>        Move 0 to nqtyx
48578>>>>>>>        Move 0 to nqtyp
48579>>>>>>>
48579>>>>>>>        // js 13/02/2002
48579>>>>>>>        // An ta extra pedia timon den exoun timh tote to wcmoves enhmeronei me axies
48579>>>>>>>        If (Wcmoves.Wcmov_Axia=0) Begin
48581>>>>>>>                 If (Wcmoves.Wcmove_X0<>0)  Move Wcmoves.Wcmov_Totamad0 to nx
48584>>>>>>>            Else If (Wcmoves.Wcmove_P0<>0)  Move Wcmoves.Wcmov_Totamad0 to np
48588>>>>>>>        End
48588>>>>>>>>
48588>>>>>>>        // An ta extra pedia posothton den exoun timh tote to wcmoves enhmeronei me posothtes
48588>>>>>>>        If ((Wcmoves.Sx_Posothta_Eis=0) And (Wcmoves.Sx_Posothta_Ex=0)) Begin
48590>>>>>>>                 If (Wcmoves.Wcmove_Qty_Eisa<>0) Move Wcmoves.Wcmove_Qty_Eisa   to nqtyx
48593>>>>>>>            Else If (Wcmoves.Wcmove_Qty_Exa <>0) Move Wcmoves.Wcmove_Qty_Exa    to nqtyp
48597>>>>>>>        End
48597>>>>>>>>
48597>>>>>>>
48597>>>>>>>        Sub nqtyx  From witemx.qty_xre
48598>>>>>>>        Sub nqtyp  From witemx.qty_pis
48599>>>>>>>        Sub nx     From witemx.axia_xre
48600>>>>>>>        Sub np     From witemx.axia_pis
48601>>>>>>>
48601>>>>>>>        // 02/10/2001 Enhmerosh arxeiou WAM
48601>>>>>>>        Send Enhm_Wam   nqtyx   ;                        nqtyp   ;                        nx      ;                        np      ;                        -1
48602>>>>>>>    End_Procedure   // Backout
48603>>>>>>>
48603>>>>>>>
48603>>>>>>>    // Creating:
48603>>>>>>>     Procedure Creating
48604>>>>>>>        Forward Send Creating
48606>>>>>>>        // Insert Code Here
48606>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wcmoves.Wcmove_Rec0)))))) to Wcmoves.Wcmove_Recr
48607>>>>>>>        If (Wcmoves.Wcmove_SC_Code2='') Move SyscurXr.C_Code0 to Wcmoves.Wcmove_SC_Code2
48610>>>>>>>    End_Procedure   // Creating
48611>>>>>>>
48611>>>>>>>    // Define_Fields:
48611>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48611>>>>>>>
48611>>>>>>>   Procedure Entry_wcmoves_date Integer iField Date dDate
48612>>>>>>>         Local Integer Changed
48613>>>>>>>         Get Field_Changed_State iField to Changed
48614>>>>>>>         If ( Changed=0 AND dDate = 0) Begin
48616>>>>>>>           SysDate4 dDate
48617>>>>>>>           Set Field_Default_Value iField to dDate
48618>>>>>>>         End
48618>>>>>>>>
48618>>>>>>>   End_Procedure
48619>>>>>>>
48619>>>>>>>
48619>>>>>>>    Procedure Define_Fields
48620>>>>>>>        Forward Send Define_Fields
48622>>>>>>>        //DDB-Generated-Code-Location
48622>>>>>>>        //DDB-DefineFieldStart
48622>>>>>>>
48622>>>>>>>        Set Main_File            To Wcmoves.File_Number
48623>>>>>>>        Set Cascade_Delete_State To FALSE
48624>>>>>>>
48624>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
48625>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
48626>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48627>>>>>>>
48627>>>>>>>        // Parent (Server) file structure...............
48627>>>>>>>        Send Add_Server_File  Wtypkin.File_Number
48628>>>>>>>        Send Add_Server_File  Wax.File_Number
48629>>>>>>>        Send Add_Server_File  Witemx.File_Number
48630>>>>>>>
48630>>>>>>>        // External (System) file structure.............
48630>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
48631>>>>>>>        Send Add_System_File  Wam.File_Number  DD_LOCK_ON_ALL
48632>>>>>>>
48632>>>>>>>        Define_Auto_Increment  Sysrecw.Wcmoves_Rec0  To Wcmoves.Wcmove_Rec0
48635>>>>>>>
48635>>>>>>>        // Field-based properties.......................
48635>>>>>>>
48635>>>>>>>        // Wcmoves.Company_Code
48635>>>>>>>
48635>>>>>>>        // Wcmoves.Branch_Code
48635>>>>>>>
48635>>>>>>>        // Wcmoves.Year_Year
48635>>>>>>>
48635>>>>>>>        // Wcmoves.Wtypkin_Code
48635>>>>>>>
48635>>>>>>>        // Wcmoves.Wapokat_Code
48635>>>>>>>
48635>>>>>>>        // Wcmoves.Wapomast_Code
48635>>>>>>>
48635>>>>>>>        // Wcmoves.Wax_Code
48635>>>>>>>
48635>>>>>>>        // Wcmoves.Witemkat_Code
48635>>>>>>>
48635>>>>>>>        // Wcmoves.Units_Code
48635>>>>>>>
48635>>>>>>>        // Wcmoves.Item_Code
48635>>>>>>>
48635>>>>>>>        // Wcmoves.Witemx_Code
48635>>>>>>>
48635>>>>>>>        // Wcmoves.Wcmove_Recr
48635>>>>>>>
48635>>>>>>>        // Wcmoves.Wcmove_Rec0
48635>>>>>>>
48635>>>>>>>        // Wcmoves.Wcmove_Hmnia
48635>>>>>>>        Set Field_Entry_msg        Field Wcmoves.Wcmove_Hmnia To Entry_wcmoves_date
48636>>>>>>>        Set Field_Mask_Type        Field Wcmoves.Wcmove_Hmnia To MASK_DATE_WINDOW
48637>>>>>>>        Set Field_Prompt_Object    Field Wcmoves.Wcmove_Hmnia To (sl045(Self))
48638>>>>>>>
48638>>>>>>>        // Wcmoves.Wtypkin_Recr
48638>>>>>>>
48638>>>>>>>        // Wcmoves.Wax_Recr
48638>>>>>>>
48638>>>>>>>        // Wcmoves.Witemx_Recr
48638>>>>>>>
48638>>>>>>>        // Wcmoves.Wcmove_Par
48638>>>>>>>
48638>>>>>>>        // Wcmoves.Partl_Recr
48638>>>>>>>
48638>>>>>>>        // Wcmoves.Wcmove_Axia
48638>>>>>>>
48638>>>>>>>        // Wcmoves.Wcmove_X0
48638>>>>>>>
48638>>>>>>>        // Wcmoves.Wcmove_P0
48638>>>>>>>
48638>>>>>>>        // Wcmoves.Wcmove_X00
48638>>>>>>>
48638>>>>>>>        // Wcmoves.Wcmove_P00
48638>>>>>>>
48638>>>>>>>        // Wcmoves.Wcmove_X1
48638>>>>>>>
48638>>>>>>>        // Wcmoves.Wcmove_P1
48638>>>>>>>
48638>>>>>>>        // Wcmoves.Wcmove_X2
48638>>>>>>>
48638>>>>>>>        // Wcmoves.Wcmove_P2
48638>>>>>>>
48638>>>>>>>        // Wcmoves.Wcmove_Dlixis
48638>>>>>>>
48638>>>>>>>        // Wcmoves.Wcmove_A_Code
48638>>>>>>>
48638>>>>>>>        // Wcmoves.Wcmove_Status_E
48638>>>>>>>
48638>>>>>>>        // Wcmoves.Wcmove_Status_A
48638>>>>>>>
48638>>>>>>>        // Wcmoves.Wcmove_S0
48638>>>>>>>
48638>>>>>>>        // Wcmoves.Wcmove_Ys0
48638>>>>>>>
48638>>>>>>>        // Wcmoves.Wcmove_S1
48638>>>>>>>
48638>>>>>>>        // Wcmoves.Wcmove_Ys1
48638>>>>>>>
48638>>>>>>>        // Wcmoves.Wcmove_S2
48638>>>>>>>
48638>>>>>>>        // Wcmoves.Wcmove_Ys2
48638>>>>>>>
48638>>>>>>>        // Wcmoves.Wcmove_Sc_Code2
48638>>>>>>>        Set Field_Prompt_Object    Field Wcmoves.Wcmove_Sc_Code2 To (slNomism(Self))
48639>>>>>>>
48639>>>>>>>        // Wcmoves.Wcmove_Open
48639>>>>>>>
48639>>>>>>>        // Wcmoves.Wcmove_Aopen
48639>>>>>>>
48639>>>>>>>        // Wcmoves.Wcmove_Yn_Myf
48639>>>>>>>
48639>>>>>>>        // Wcmoves.Wcmove_Myf_Axia
48639>>>>>>>
48639>>>>>>>        // Wcmoves.Wcmove_Kk
48639>>>>>>>
48639>>>>>>>        // Wcmoves.Wcmove_C_Code2
48639>>>>>>>        Set Field_Prompt_Object    Field Wcmoves.Wcmove_C_Code2 To (slNomism(Self))
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Client_Recr
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Cn_Code
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmove_Qty
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmov_Totambd0
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmov_Discam0
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmov_Totamad0
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmov_Vatam0
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmov_Extra0
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmov_Totambd00
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmov_Discam00
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmov_Totamad00
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmov_Vatam00
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmov_Extra00
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmov_Totambd1
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmov_Discam1
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmov_Totamad1
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmov_Vatam1
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmov_Extra1
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmove_Qty_Exa
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmove_Qty_Eisa
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Client_Id
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Module_From
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Unit_Price0
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Unit_Price00
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Unit_Pricer
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Cn_Recr
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Sls_Id
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Cnt_Id
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Presp_Id
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Mhxanik_Id
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Prn_Theor
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Extra_Axia
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Extra_Axia0
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Extra_Axia00
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Extra_Axiar
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Disc_Axia
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Disc_Axia0
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Disc_Axia00
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Disc_Axiar
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Unit_Price
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Particle_Recr
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Sx_Posothta_Eis
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Sx_Posothta_Ex
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmov_Axia
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmov_X0
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmov_X00
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmov_X1
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmov_X2
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmov_P0
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmov_P00
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmov_P1
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmov_P2
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Unit_Pric0
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Unit_Pric00
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Unit_Pricr
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmo_Totambd0
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmo_Totambd00
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmo_Totambd1
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmo_Discam0
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmo_Discam00
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmo_Discam1
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmo_Totamad0
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmo_Totamad00
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmo_Totamad1
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmo_Vatam0
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmo_Vatam00
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmo_Vatam1
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmo_Extra0
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmo_Extra00
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Wcmo_Extra1
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Sap_Hmnia
48640>>>>>>>
48640>>>>>>>        // Wcmoves.Texnikh
48640>>>>>>>
48640>>>>>>>        //DDB-DefineFieldEnd
48640>>>>>>>    End_Procedure    // Define_Fields
48641>>>>>>>
48641>>>>>>>    // Field_Defaults:
48641>>>>>>>    // This procedure is used to establish default field values.
48641>>>>>>>
48641>>>>>>>    Procedure Field_Defaults
48642>>>>>>>        Forward Send Field_Defaults
48644>>>>>>>        //DDB-Generated-Code-Location
48644>>>>>>>        //DDB-FieldDefaultStart
48644>>>>>>>        //DDB-FieldDefaultEnd
48644>>>>>>>    End_Procedure    // Field_Defaults
48645>>>>>>>
48645>>>>>>>
48645>>>>>>>
48645>>>>>>>End_Class    // Wcmoves_DataDictionary
48646>>>>>>>//DDB-Selection-pkg-Start
48646>>>>>>>
48646>>>>>>>Use sl045.SL         // sl045
48646>>>>>>>Use slnomism.sl      // slNomism
48646>>>>>>>
48646>>>>>>>//DDB-Selection-pkg-End
48646>>>>>>>//DDB-FileEnd
48646>>>>>    
48646>>>>>    //AB-IgnoreEnd
48646>>>>>
48646>>>>>    Object sl045 is a dbModalPanelSub
48648>>>>>
48648>>>>>        //AB-StoreTopStart
48648>>>>>        Property String psModule    Public ''
48650>>>>>        Property String psItemxCode Public ''
48652>>>>>        Property date   pddate      Public ''
48654>>>>>        //AB-StoreTopEnd
48654>>>>>
48654>>>>>        Set Label to "‰ ¤ã©œ ª €§¦Ÿã¡žª"
48655>>>>>        Set Size to 279 515
48656>>>>>        Set Location to 0 4
48657>>>>>        Set Exit_Application_Local_State to FALSE
48658>>>>>        Set Modal_State to FALSE
48659>>>>>
48659>>>>>        //AB-DDOStart
48659>>>>>
48659>>>>>        Object Wcmoves_DD is a Wcmoves_DataDictionary
48661>>>>>
48661>>>>>            //AB-StoreStart
48661>>>>>                        
48661>>>>>            Begin_Constraints
48663>>>>>                Constrain wcmoves.company_code  eq syscurxr.company_code
48665>>>>>                Constrain wcmoves.branch_code   eq syscurxr.branch_code
48667>>>>>                Constrain wcmoves.year_year     eq syscurxr.year_year
48669>>>>>                If (psItemxCode(Self)<>'') Begin
48671>>>>>                    Set Ordering to 15
48672>>>>>                    Constrain WCmoves.Witemx_Code Eq (Trim(psItemxCode(Self)))
48674>>>>>                    if (pddate(self)<>'') constrain wcmoves.wcmove_hmnia eq (pddate(self))
48678>>>>>                End
48678>>>>>>
48678>>>>>                Else begin
48679>>>>>                    Set Ordering to 3
48680>>>>>                    if (pddate(self)<>'') constrain wcmoves.wcmove_hmnia eq (pddate(self))
48684>>>>>                End
48684>>>>>>
48684>>>>>            End_Constraints
48687>>>>>            
48687>>>>>            
48687>>>>>            
48687>>>>>            
48687>>>>>            
48687>>>>>            
48687>>>>>            
48687>>>>>            
48687>>>>>            
48687>>>>>            
48687>>>>>            
48687>>>>>            
48687>>>>>            
48687>>>>>            
48687>>>>>            
48687>>>>>            
48687>>>>>            //AB-StoreEnd
48687>>>>>
48687>>>>>        End_Object    // Wcmoves_DD
48688>>>>>
48688>>>>>        Set Main_DD to (Wcmoves_DD(self))
48689>>>>>        Set Server to (Wcmoves_DD(self))
48690>>>>>
48690>>>>>        //AB-DDOEnd
48690>>>>>
48690>>>>>        Object oSelList is a dbListSub
48692>>>>>            Set Main_File to Wcmoves.File_Number
48693>>>>>            Set Size to 229 501
48694>>>>>            Set Location to 2 7
48695>>>>>            Set Auto_Index_State to FALSE
48696>>>>>
48696>>>>>            Begin_Row
48699>>>>>                Entry_Item Wcmoves.Witemx_code
48700>>>>>                Entry_Item (fswax(self,wcmoves.wax_recr))
48701>>>>>                Entry_Item (fswtypkin(self,wcmoves.wtypkin_code))
48702>>>>>                Entry_Item Wcmoves.Wcmove_hmnia
48703>>>>>                Entry_Item Wcmoves.Wcmove_par
48704>>>>>                Entry_Item Wcmoves.Wcmove_axia
48705>>>>>                Entry_Item Wcmoves.Wcmove_qty
48706>>>>>                Entry_Item Wcmoves.Wcmove_sc_code2
48707>>>>>                Entry_Item Wcmoves.Module_from
48708>>>>>            End_Row
48713>>>>>
48713>>>>>            Set Form_Width    item 0 to 85
48714>>>>>            Set Header_Label  item 0 to "„å›¦ª"
48715>>>>>            
48715>>>>>            Set Form_Width    item 1 to 50
48716>>>>>            Set Header_Label  item 1 to "€§¦Ÿã¡ž "
48717>>>>>            
48717>>>>>            Set Form_Width    item 2 to 80
48718>>>>>            Set Header_Label  item 2 to "‰å¤ž©ž"
48719>>>>>            
48719>>>>>            Set Form_Width    item 3 to 51
48720>>>>>            Set Header_Label  item 3 to "†£œ¨/¤å˜"
48721>>>>>            
48721>>>>>            Set Form_Width    item 4 to 65
48722>>>>>            Set Header_Label  item 4 to "€ « ¦¢¦šå˜"
48723>>>>>            
48723>>>>>            Set Form_Width    item 5 to 60
48724>>>>>            Set Header_Label  item 5 to " €¥å˜"
48725>>>>>            
48725>>>>>            Set Form_Width    item 6 to 51
48726>>>>>            Set Header_Label  item 6 to "¦©æ«ž«˜"
48727>>>>>            
48727>>>>>            Set Form_Width    item 7 to 26
48728>>>>>            Set Header_Label  item 7 to "Œ¦£"
48729>>>>>            
48729>>>>>            Set Form_Width    item 8 to 27
48730>>>>>            Set Header_Label  item 8 to "‰ç¡¢"
48731>>>>>            
48731>>>>>
48731>>>>>            //AB-StoreStart
48731>>>>>                                    
48731>>>>>            Procedure End_Construct_Object
48733>>>>>                String  sNom
48734>>>>>                Integer iDecs
48734>>>>>                Forward Send End_Construct_Object
48736>>>>>                Move SysCurxr.C_Code0 to sNom
48737>>>>>                Clear Nomisma
48738>>>>>                Move sNom to Nomisma.Nomisma_Code
48739>>>>>                Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
48740>>>>>>
48740>>>>>                If (Found=1)    Move Nomisma.Dekadika to iDecs
48743>>>>>                Else            Move 0 to iDecs
48745>>>>>                // ˜¨˜›¦®ã: ˜¤ «¦ ™˜© ¡æ ¤¦£ ©£˜ ®¨ã©žª ƒ„Œ œ®œ  ›œ¡˜› ¡á
48745>>>>>                // «æ«œ œ¥' ¦¨ ©£¦ç ™á¦¬£œ œ£œ ª 2
48745>>>>>                If (iDecs=0) Move 2 to iDecs
48748>>>>>                Set Points          Item 5 to       iDecs
48749>>>>>                Set Numeric_Mask    Item 5 to 14    iDecs '*, '
48750>>>>>                Set Points          Item 6 to       2 // ¦©æ«ž«˜
48751>>>>>            End_Procedure
48752>>>>>            
48752>>>>>            Procedure Activate
48754>>>>>                Send Keyaction to ButtonSub1
48755>>>>>                Forward Send Activate
48757>>>>>            End_procedure
48758>>>>>            
48758>>>>>            
48758>>>>>            
48758>>>>>            
48758>>>>>            
48758>>>>>            
48758>>>>>            
48758>>>>>            
48758>>>>>            
48758>>>>>            
48758>>>>>            
48758>>>>>            
48758>>>>>            
48758>>>>>            
48758>>>>>            
48758>>>>>            
48758>>>>>            
48758>>>>>            
48758>>>>>            
48758>>>>>            //AB-StoreEnd
48758>>>>>
48758>>>>>        End_Object    // oSelList
48759>>>>>
48759>>>>>        Object cSyDateForm1 is a cSyDateForm
48761>>>>>            Set Size to 13 75
48762>>>>>            Set Location to 236 51
48763>>>>>            Set Label_Col_Offset to 2
48764>>>>>            Set Label_Justification_Mode to jMode_Right
48765>>>>>            Set Form_Mask Item 0 to "d/M/yyyy"
48766>>>>>
48766>>>>>            //AB-StoreStart
48766>>>>>                                            
48766>>>>>            Procedure Key Integer iKey
48768>>>>>                Integer iRetVal
48769>>>>>                Forward Send Key iKey
48771>>>>>                If (iKey=277) Begin
48773>>>>>                    Send Clear_Me
48774>>>>>                End
48774>>>>>>
48774>>>>>            End_Procedure
48775>>>>>            
48775>>>>>            Procedure Clear_Me
48777>>>>>                Set Value Item 0 to ''
48778>>>>>                Send KeyAction to ButtonSub1
48779>>>>>            End_Procedure
48780>>>>>            
48780>>>>>            Procedure onchange
48782>>>>>                date ddate
48783>>>>>                get value item 0 to ddate
48784>>>>>                set pddate to ddate
48785>>>>>            
48785>>>>>            end_procedure
48786>>>>>            
48786>>>>>            
48786>>>>>            
48786>>>>>            
48786>>>>>            
48786>>>>>            
48786>>>>>            
48786>>>>>            
48786>>>>>            
48786>>>>>            //AB-StoreEnd
48786>>>>>
48786>>>>>        End_Object    // cSyDateForm1
48787>>>>>
48787>>>>>        Object FormSub1 is a FormSub
48789>>>>>            Set Size to 13 75
48790>>>>>            Set Location to 250 51
48791>>>>>            Set Label_Col_Offset to 2
48792>>>>>            Set Prompt_Button_Mode to pb_PromptOn
48793>>>>>
48793>>>>>            //AB-StoreStart
48793>>>>>                                                                                            
48793>>>>>            Set Prompt_Object to (sl22s(Self))
48794>>>>>            
48794>>>>>            
48794>>>>>            Procedure OnChange
48796>>>>>                String sitem
48797>>>>>                Get Value Item 0 to sitem
48798>>>>>                set psitemxcode to sitem
48799>>>>>                Set Value Of FormSub3 Item 0 to (fsitem(Self,sitem))
48800>>>>>            End_Procedure
48801>>>>>            
48801>>>>>            Procedure Key Integer iKey
48803>>>>>                Integer iRetVal
48804>>>>>                Forward Send Key iKey
48806>>>>>                If (iKey=277) Begin
48808>>>>>                    Send Clear_item
48809>>>>>                End
48809>>>>>>
48809>>>>>            End_Procedure
48810>>>>>            
48810>>>>>            Procedure Clear_item
48812>>>>>                Set Value Item 0 to ''
48813>>>>>                Send KeyAction to ButtonSub1
48814>>>>>            End_Procedure
48815>>>>>            
48815>>>>>            
48815>>>>>            
48815>>>>>            
48815>>>>>            
48815>>>>>            
48815>>>>>            
48815>>>>>            
48815>>>>>            
48815>>>>>            //AB-StoreEnd
48815>>>>>
48815>>>>>        End_Object    // FormSub1
48816>>>>>
48816>>>>>        Object FormSub3 is a FormSub
48818>>>>>            Set Size to 13 195
48819>>>>>            Set Location to 250 132
48820>>>>>            Set Color to clBtnFace
48821>>>>>            Set Label_Col_Offset to 2
48822>>>>>            Set Enabled_State to FALSE
48823>>>>>            Set Item_Shadow_State Item 0 to TRUE
48824>>>>>            Set Shadow_State Item 0 to TRUE
48825>>>>>        End_Object    // FormSub3
48826>>>>>
48826>>>>>        Object oOK_bn is a ButtonSub
48828>>>>>            Set Label to "&„§ ¢¦šã"
48829>>>>>            Set Location to 248 397
48830>>>>>
48830>>>>>            //AB-StoreStart
48830>>>>>            Procedure OnClick
48832>>>>>                Send OK To (oSelList(current_object))
48833>>>>>            End_Procedure
48834>>>>>            //AB-StoreEnd
48834>>>>>
48834>>>>>        End_Object    // oOK_bn
48835>>>>>
48835>>>>>        Object oSearch_bn is a ButtonSub
48837>>>>>            Set Label to "€&¤˜ã«ž©ž"
48838>>>>>            Set Location to 248 457
48839>>>>>
48839>>>>>            //AB-StoreStart
48839>>>>>            Procedure OnClick
48841>>>>>                Send Search To (oSelList(current_object))
48842>>>>>            End_Procedure
48843>>>>>            //AB-StoreEnd
48843>>>>>
48843>>>>>        End_Object    // oSearch_bn
48844>>>>>
48844>>>>>        Object ButtonSub1 is a ButtonSub
48846>>>>>            Set Label to "œ¨ æ¨ ©œ"
48847>>>>>            Set Size to 13 50
48848>>>>>            Set Location to 249 337
48849>>>>>            Set Form_FontWeight Item 0 to 600
48850>>>>>
48850>>>>>            //AB-StoreStart
48850>>>>>                                                                                                        
48850>>>>>            Procedure OnClick
48852>>>>>                Send Rebuild_Constraints to Wcmoves_DD
48853>>>>>                Send Beginning_Of_Data to oSelList True
48854>>>>>            End_Procedure // OnClick
48855>>>>>            
48855>>>>>            
48855>>>>>            
48855>>>>>            //AB-StoreEnd
48855>>>>>
48855>>>>>        End_Object    // ButtonSub1
48856>>>>>
48856>>>>>        Object TextBoxSub1 is a TextBoxSub
48858>>>>>            Set Label to "†£/¤å˜"
48859>>>>>            Set Location to 239 5
48860>>>>>            Set Size to 10 31
48861>>>>>        End_Object    // TextBoxSub1
48862>>>>>
48862>>>>>        Object TextBoxSub2 is a TextBoxSub
48864>>>>>            Set Label to "„å›¦ª"
48865>>>>>            Set Location to 251 5
48866>>>>>            Set Size to 12 21
48867>>>>>        End_Object    // TextBoxSub2
48868>>>>>
48868>>>>>
48868>>>>>        //AB-StoreStart
48868>>>>>                        
48868>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
48869>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
48870>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
48871>>>>>        
48871>>>>>        Set Locate_Mode to Center_On_Screen
48872>>>>>        Set Modal_State to True
48873>>>>>        
48873>>>>>        Procedure Activate
48875>>>>>            Forward send Activate
48877>>>>>        End_Procedure
48878>>>>>        
48878>>>>>        Procedure Request_Cancel
48880>>>>>            Set Value Of cSyDateForm1 Item 0 to ''
48881>>>>>            set value of formsub1     item 0 to ''
48882>>>>>            set value of formsub3     item 0 to ''
48883>>>>>            Send Clear to wcmoves_dd
48884>>>>>            Forward Send Request_Cancel
48886>>>>>        End_Procedure
48887>>>>>        
48887>>>>>        
48887>>>>>        
48887>>>>>        
48887>>>>>        
48887>>>>>        
48887>>>>>        
48887>>>>>        
48887>>>>>        
48887>>>>>        
48887>>>>>        
48887>>>>>        //AB-StoreEnd
48887>>>>>
48887>>>>>    End_Object    // sl045
48888>>>>>
48888>>>>>
48888>>>>>    //AB-StoreStart
48888>>>>>                        
48888>>>>>                        
48888>>>>>                        
48888>>>>>    //AB-StoreEnd
48888>>>>>
48888>>>>>//AB/     End_Object    // prj
48888>>>use sl052.sl
INCLUDING FILE: SL052.SL
48888>>>>>//AB/ Project sl052:drivers
48888>>>>>//AB/ Object prj is a Lookup_Project
48888>>>>>//AB/     Set ProjectName to "sl052:drivers"
48888>>>>>//AB/     Set ProjectFileName to "sl052.SL"
48888>>>>>//AB/     Set GenerateFileName to "NONAME"
48888>>>>>
48888>>>>>// Project Object Structure
48888>>>>>//   sl052 is a dbModalPanelSub
48888>>>>>//     Drivers_DD is a DataDictionary
48888>>>>>//     oSelList is a dbListSub
48888>>>>>//     oOK_bn is a ButtonSub
48888>>>>>//     oCancel_bn is a ButtonSub
48888>>>>>//     oSearch_bn is a ButtonSub
48888>>>>>
48888>>>>>// Register all objects
48888>>>>>Register_Object Drivers_DD
48888>>>>>Register_Object oCancel_bn
48888>>>>>Register_Object oOK_bn
48888>>>>>Register_Object oSearch_bn
48888>>>>>Register_Object oSelList
48888>>>>>Register_Object sl052
48888>>>>>
48888>>>>>
48888>>>>>//AB-IgnoreStart
48888>>>>>
48888>>>>>Use DFAllEnt.pkg
48888>>>>>Use dbList.Sub
48888>>>>>Use Button.Sub
48888>>>>>
48888>>>>>
48888>>>>>Use DRIVERS.DD
INCLUDING FILE: DRIVERS.DD
48888>>>>>>>//DDB-FileStart
48888>>>>>>>//DDB-HeaderStart
48888>>>>>>>
48888>>>>>>>// File Name : DRIVERS.DD
48888>>>>>>>// Class Name: Drivers_DataDictionary
48888>>>>>>>// Revision  : 18
48888>>>>>>>// Version   : 2
48888>>>>>>>
48888>>>>>>>Use  Windows           // Basic Definitions
48888>>>>>>>Use  DataDict          // DataDictionary Class Definition
48888>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48888>>>>>>>
48888>>>>>>>Open Drivers
48890>>>>>>>Open Sysrecc
48892>>>>>>>
48892>>>>>>>//DDB-HeaderEnd
48892>>>>>>>//DDB-ValidationStart
48892>>>>>>>
48892>>>>>>>Register_Object Drivers_Driver_Doy_VT
48892>>>>>>>
48892>>>>>>>Object Drivers_Driver_Doy_VT  is a CodeValidationTable
48894>>>>>>>    Set Type_Value        To "DOY"
48895>>>>>>>    Set Validate_State    To FALSE
48896>>>>>>>    Set Allow_Blank_State To TRUE
48897>>>>>>>    //DDB-ValidationCustomStart
48897>>>>>>>    //DDB-ValidationCustomEnd
48897>>>>>>>End_Object   // Drivers_Driver_Doy_VT
48898>>>>>>>//DDB-ValidationEnd
48898>>>>>>>//DDB-SelectionStart
48898>>>>>>>//DDB/ ExternalSelectionList sl052  sl052.SL
48898>>>>>>>Register_Object sl052
48898>>>>>>>//DDB-SelectionEnd
48898>>>>>>>
48898>>>>>>>Class Drivers_DataDictionary  is a DataDictionary_Sec
48899>>>>>>>
48899>>>>>>>    // Define_Fields:
48899>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48899>>>>>>>
48899>>>>>>>    Procedure Update
48900>>>>>>>        Forward Send Update
48902>>>>>>>        // Insert Code Here
48902>>>>>>>        Move SysCurXR.Company_Code  to drivers.driver_company
48903>>>>>>>
48903>>>>>>>        //betolink
48903>>>>>>>        Move SysCurXR.Beto_Site     to drivers.driver_SiteW
48904>>>>>>>        Move drivers.drivers_Rec0   to drivers.driver_SN
48905>>>>>>>        Move drivers.driver_id      to drivers.driver_repmatch
48906>>>>>>>
48906>>>>>>>    End_Procedure   // Update
48907>>>>>>>
48907>>>>>>>     Procedure Creating
48908>>>>>>>        Forward Send Creating
48910>>>>>>>        date ddate
48911>>>>>>>        sysdate4 ddate
48912>>>>>>>        // Insert Code Here
48912>>>>>>>        Get fsgCode_With_Zeroes drivers.drivers_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to drivers.driver_ID
48913>>>>>>>        move ddate to drivers.driver_hmnia
48914>>>>>>>    End_Procedure   // Creating
48915>>>>>>>
48915>>>>>>>
48915>>>>>>>
48915>>>>>>>
48915>>>>>>>    Procedure Define_Fields
48916>>>>>>>        Forward Send Define_Fields
48918>>>>>>>        //DDB-Generated-Code-Location
48918>>>>>>>        //DDB-DefineFieldStart
48918>>>>>>>
48918>>>>>>>        Set Main_File            To Drivers.File_Number
48919>>>>>>>        Set Cascade_Delete_State To FALSE
48920>>>>>>>
48920>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
48921>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
48922>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48923>>>>>>>
48923>>>>>>>        // External (System) file structure.............
48923>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
48924>>>>>>>
48924>>>>>>>        Define_Auto_Increment  Sysrecc.Drivers_Rec0  To Drivers.Drivers_Rec0
48927>>>>>>>
48927>>>>>>>        // Field-based properties.......................
48927>>>>>>>
48927>>>>>>>        // Drivers.Driver_Recnum
48927>>>>>>>
48927>>>>>>>        // Drivers.Driver_Company
48927>>>>>>>
48927>>>>>>>        // Drivers.Driver_Id
48927>>>>>>>        Set Field_Options          Field Drivers.Driver_Id To DD_AUTOFIND   
48928>>>>>>>        Set Field_Prompt_Object    Field Drivers.Driver_Id To (sl052(Self))
48929>>>>>>>        Set Key_Field_State        Field Drivers.Driver_Id To TRUE
48930>>>>>>>
48930>>>>>>>        // Drivers.Driver_Name
48930>>>>>>>        Set Field_Prompt_Object    Field Drivers.Driver_Name To (sl052(Self))
48931>>>>>>>
48931>>>>>>>        // Drivers.Driver_Doy
48931>>>>>>>        Set Field_Value_Table      Field Drivers.Driver_Doy To (Drivers_Driver_Doy_VT(Self))
48932>>>>>>>
48932>>>>>>>        // Drivers.Driver_Afm
48932>>>>>>>
48932>>>>>>>        // Drivers.Driver_Address
48932>>>>>>>
48932>>>>>>>        // Drivers.Driver_Zipcode
48932>>>>>>>
48932>>>>>>>        // Drivers.Driver_City
48932>>>>>>>
48932>>>>>>>        // Drivers.Driver_Area
48932>>>>>>>
48932>>>>>>>        // Drivers.Driver_Phone
48932>>>>>>>
48932>>>>>>>        // Drivers.Driver_Fax
48932>>>>>>>
48932>>>>>>>        // Drivers.Driver_Mobile
48932>>>>>>>
48932>>>>>>>        // Drivers.Driver_Aoh
48932>>>>>>>
48932>>>>>>>        // Drivers.Driver_Details
48932>>>>>>>
48932>>>>>>>        // Drivers.Driver_Sitew
48932>>>>>>>
48932>>>>>>>        // Drivers.Driver_Sn
48932>>>>>>>
48932>>>>>>>        // Drivers.Driver_Codem
48932>>>>>>>
48932>>>>>>>        // Drivers.Driver_Repmatch
48932>>>>>>>
48932>>>>>>>        // Drivers.Driver_Hmnia
48932>>>>>>>        Set Field_Mask_Type        Field Drivers.Driver_Hmnia To MASK_DATE_WINDOW
48933>>>>>>>
48933>>>>>>>        // Drivers.Drivers_Rec0
48933>>>>>>>
48933>>>>>>>        // Drivers.Driver_Add_No
48933>>>>>>>
48933>>>>>>>        // Drivers.Driver_Nomos
48933>>>>>>>
48933>>>>>>>        // Drivers.Driver_Xora
48933>>>>>>>
48933>>>>>>>        // Drivers.Polh_Recr
48933>>>>>>>
48933>>>>>>>        //DDB-DefineFieldEnd
48933>>>>>>>    End_Procedure    // Define_Fields
48934>>>>>>>
48934>>>>>>>    // Field_Defaults:
48934>>>>>>>    // This procedure is used to establish default field values.
48934>>>>>>>
48934>>>>>>>    Procedure Field_Defaults
48935>>>>>>>        Forward Send Field_Defaults
48937>>>>>>>        //DDB-Generated-Code-Location
48937>>>>>>>        //DDB-FieldDefaultStart
48937>>>>>>>        //DDB-FieldDefaultEnd
48937>>>>>>>    End_Procedure    // Field_Defaults
48938>>>>>>>
48938>>>>>>>End_Class    // Drivers_DataDictionary
48939>>>>>>>//DDB-Selection-pkg-Start
48939>>>>>>>
48939>>>>>>>Use sl052.SL         // sl052
48939>>>>>>>
48939>>>>>>>//DDB-Selection-pkg-End
48939>>>>>>>//DDB-FileEnd
48939>>>>>
48939>>>>>//AB-IgnoreEnd
48939>>>>>
48939>>>>>Object sl052 is a dbModalPanelSub
48941>>>>>    Set Label to "€¨®œå¦ Ž›žšé¤ "
48942>>>>>    Set Size to 148 371
48943>>>>>    Set Location to 4 5
48944>>>>>    Set Exit_Application_Local_State to FALSE
48945>>>>>    Set Modal_State to FALSE
48946>>>>>
48946>>>>>    //AB-DDOStart
48946>>>>>
48946>>>>>    Object Drivers_DD is a Drivers_DataDictionary
48948>>>>>    End_Object    // Drivers_DD
48949>>>>>
48949>>>>>    Set Main_DD to (Drivers_DD(self))
48950>>>>>    Set Server to (Drivers_DD(self))
48951>>>>>
48951>>>>>    //AB-DDOEnd
48951>>>>>
48951>>>>>    Object oSelList is a dbListSub
48953>>>>>        Set Main_File to Drivers.File_Number
48954>>>>>        Set Size to 105 354
48955>>>>>        Set Location to 6 6
48956>>>>>
48956>>>>>        Begin_Row
48959>>>>>            Entry_Item Drivers.Driver_id
48960>>>>>            Entry_Item Drivers.Driver_name
48961>>>>>            Entry_Item Drivers.Driver_afm
48962>>>>>            Entry_Item Drivers.Driver_city
48963>>>>>            Entry_Item Drivers.Driver_phone
48964>>>>>        End_Row
48969>>>>>
48969>>>>>        Set Form_Width    item 0 to 70
48970>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
48971>>>>>        
48971>>>>>        Set Form_Width    item 1 to 100
48972>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
48973>>>>>        
48973>>>>>        Set Form_Width    item 2 to 50
48974>>>>>        Set Header_Label  item 2 to "€.”.‹"
48975>>>>>        
48975>>>>>        Set Form_Width    item 3 to 76
48976>>>>>        Set Header_Label  item 3 to "æ¢ž"
48977>>>>>        
48977>>>>>        Set Form_Width    item 4 to 50
48978>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
48979>>>>>        
48979>>>>>    End_Object    // oSelList
48980>>>>>
48980>>>>>    Object oOK_bn is a ButtonSub
48982>>>>>        Set Label to "&„§ ¢¦šã"
48983>>>>>        Set Location to 114 201
48984>>>>>
48984>>>>>        //AB-StoreStart
48984>>>>>        Procedure OnClick
48986>>>>>            Send OK To (oSelList(current_object))
48987>>>>>        End_Procedure
48988>>>>>        //AB-StoreEnd
48988>>>>>
48988>>>>>    End_Object    // oOK_bn
48989>>>>>
48989>>>>>    Object oCancel_bn is a ButtonSub
48991>>>>>        Set Label to "&€¡ç¨à©ž"
48992>>>>>        Set Location to 114 255
48993>>>>>
48993>>>>>        //AB-StoreStart
48993>>>>>        Procedure OnClick
48995>>>>>            Send Cancel To (oSelList(current_object))
48996>>>>>        End_Procedure
48997>>>>>        //AB-StoreEnd
48997>>>>>
48997>>>>>    End_Object    // oCancel_bn
48998>>>>>
48998>>>>>    Object oSearch_bn is a ButtonSub
49000>>>>>        Set Label to "€&¤˜ã«ž©ž"
49001>>>>>        Set Location to 114 311
49002>>>>>
49002>>>>>        //AB-StoreStart
49002>>>>>        Procedure OnClick
49004>>>>>            Send Search To (oSelList(current_object))
49005>>>>>        End_Procedure
49006>>>>>        //AB-StoreEnd
49006>>>>>
49006>>>>>    End_Object    // oSearch_bn
49007>>>>>
49007>>>>>
49007>>>>>    //AB-StoreStart
49007>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49008>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49009>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49010>>>>>    //AB-StoreEnd
49010>>>>>
49010>>>>>End_Object    // sl052
49011>>>>>
49011>>>>>//AB/ End_Object    // prj
49011>>>Use sl057.sl
49011>>>Use sl058.sl
49011>>>Use sl059.sl
49011>>>Use sl060.sl
INCLUDING FILE: SL060.SL
49011>>>>>//AB/ Project sl060
49011>>>>>//AB/     Object prj is a LOOKUP_Project
49011>>>>>//AB/         Set ProjectName to "sl060"
49011>>>>>//AB/         Set ProjectFileName to "sl060.SL"
49011>>>>>//AB/         Set GenerateFileName to "NONAME"
49011>>>>>
49011>>>>>    //AB-IgnoreStart
49011>>>>>
49011>>>>>
49011>>>>>
49011>>>>>
49011>>>>>    Use ISOTIMIA.DD
INCLUDING FILE: ISOTIMIA.DD
49011>>>>>>>//DDB-FileStart
49011>>>>>>>//DDB-HeaderStart
49011>>>>>>>
49011>>>>>>>// File Name : ISOTIMIA.DD
49011>>>>>>>// Class Name: Isotimia_DataDictionary
49011>>>>>>>// Revision  : 18
49011>>>>>>>// Version   : 2
49011>>>>>>>
49011>>>>>>>Use  Windows           // Basic Definitions
49011>>>>>>>Use  DataDict          // DataDictionary Class Definition
49011>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49011>>>>>>>
49011>>>>>>>Open Isotimia
49013>>>>>>>Open Nomisma
49015>>>>>>>
49015>>>>>>>//DDB-HeaderEnd
49015>>>>>>>//DDB-ValidationStart
49015>>>>>>>
49015>>>>>>>Register_Object Isotimia_Poia_Metatrepei_VT
49015>>>>>>>
49015>>>>>>>Object Isotimia_Poia_Metatrepei_VT  is a DescriptionValidationTable
49017>>>>>>>    Set Allow_Blank_State To TRUE
49018>>>>>>>
49018>>>>>>>    Procedure Fill_List
49020>>>>>>>        Forward Send Fill_List
49022>>>>>>>        Send Add_Table_Value  "€"  "€‚Ž€"
49023>>>>>>>        Send Add_Table_Value  ""  "—Š†‘†"
49024>>>>>>>        Send Add_Table_Value  "F"  "FIXING"
49025>>>>>>>        Send Add_Table_Value  "P"  "PRIVATE"
49026>>>>>>>    End_Procedure    // Fill_List
49027>>>>>>>    //DDB-ValidationCustomStart
49027>>>>>>>    //DDB-ValidationCustomEnd
49027>>>>>>>End_Object   // Isotimia_Poia_Metatrepei_VT
49028>>>>>>>//DDB-ValidationEnd
49028>>>>>>>//DDB-SelectionStart
49028>>>>>>>//DDB/ ExternalSelectionList sl060  sl060.sl
49028>>>>>>>Register_Object sl060
49028>>>>>>>//DDB-SelectionEnd
49028>>>>>>>
49028>>>>>>>Class Isotimia_DataDictionary  is a DataDictionary_Sec
49029>>>>>>>
49029>>>>>>>
49029>>>>>>>    Function Validate_Save  Returns Integer
49030>>>>>>>        Local Integer iReturnVal
49031>>>>>>>        Forward Get Validate_Save  To iReturnVal
49033>>>>>>>        If (Not(iReturnVal)) ;            Begin
49035>>>>>>>                If Isotimia.isotimia_Hmnia eq ''  move 635 to iReturnVal
49038>>>>>>>                if iReturnVal Send Operation_Not_Allowed iReturnVal
49041>>>>>>>            End
49041>>>>>>>>
49041>>>>>>>        Function_Return iReturnVal
49042>>>>>>>    End_Function   // Validate_Save
49043>>>>>>>
49043>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
49044>>>>>>>        if iError_num eq 635 error 635 "ˆ©¦« £åœª => †£œ¨¦£ž¤å˜ ¡œ¤ã "
49047>>>>>>>        else Forward Send Operation_Not_Allowed  iError_Num
49050>>>>>>>    End_Procedure   // Operation_Not_Allowed
49051>>>>>>>
49051>>>>>>>
49051>>>>>>>
49051>>>>>>>    // Creating:
49051>>>>>>>    // This message is sent each time a new record is created in the
49051>>>>>>>    // main file. You should use this to assign field values that
49051>>>>>>>    // apply to the creation of a new record (i.e. assigning a unique ID
49051>>>>>>>    // from a system_file field). Creating is invoked while the database
49051>>>>>>>    // is locked.
49051>>>>>>>
49051>>>>>>>    Procedure Creating
49052>>>>>>>        Forward Send Creating
49054>>>>>>>        // Insert Code Here
49054>>>>>>>        SYSDATE ISOTIMIA.FUP
49055>>>>>>>        Move Nomisma.Kl_Isot_Euro to Isotimia.Isotimia_Euro
49056>>>>>>>    End_Procedure   // Creating
49057>>>>>>>
49057>>>>>>>
49057>>>>>>>    // Update:
49057>>>>>>>    // Use this message to effect changes in related-to files. The
49057>>>>>>>    // Backout message should be designed to reverse the effects of this
49057>>>>>>>    // message. It is invoked while the database is locked.
49057>>>>>>>
49057>>>>>>>    Procedure Update
49058>>>>>>>        Forward Send Update
49060>>>>>>>        // Insert Code Here
49060>>>>>>>        MOVE NOMISMA.NOMISMA_DESCR  TO ISOTIMIA.NOMISMA_DESCR
49061>>>>>>>        MOVE NOMISMA.NOMISMA_SHORT  TO ISOTIMIA.NOMISMA_SHORT
49062>>>>>>>        MOVE NOMISMA.DEKADIKA       TO ISOTIMIA.DEKADIKA
49063>>>>>>>        SYSDATE ISOTIMIA.LUP
49064>>>>>>>    End_Procedure   // Update
49065>>>>>>>
49065>>>>>>>
49065>>>>>>>
49065>>>>>>>
49065>>>>>>>    // Define_Fields:
49065>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49065>>>>>>>
49065>>>>>>>    Procedure Define_Fields
49066>>>>>>>        Forward Send Define_Fields
49068>>>>>>>        //DDB-Generated-Code-Location
49068>>>>>>>        //DDB-DefineFieldStart
49068>>>>>>>
49068>>>>>>>        Set Main_File            To Isotimia.File_Number
49069>>>>>>>        Set Cascade_Delete_State To FALSE
49070>>>>>>>
49070>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49071>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49072>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49073>>>>>>>
49073>>>>>>>        // Parent (Server) file structure...............
49073>>>>>>>        Send Add_Server_File  Nomisma.File_Number
49074>>>>>>>
49074>>>>>>>        // Field-based properties.......................
49074>>>>>>>
49074>>>>>>>        // Isotimia.Nomisma_Code
49074>>>>>>>
49074>>>>>>>        // Isotimia.Isotimia_Hmnia
49074>>>>>>>        Set Field_Prompt_Object    Field Isotimia.Isotimia_Hmnia To (sl060(Self))
49075>>>>>>>
49075>>>>>>>        // Isotimia.Isotimia_Agora
49075>>>>>>>
49075>>>>>>>        // Isotimia.Isotimia_Polhsh
49075>>>>>>>
49075>>>>>>>        // Isotimia.Isotimia_Fixing
49075>>>>>>>
49075>>>>>>>        // Isotimia.Isotimia_Privat
49075>>>>>>>
49075>>>>>>>        // Isotimia.Nomisma_Descr
49075>>>>>>>
49075>>>>>>>        // Isotimia.Nomisma_Short
49075>>>>>>>
49075>>>>>>>        // Isotimia.Fup
49075>>>>>>>
49075>>>>>>>        // Isotimia.Lup
49075>>>>>>>
49075>>>>>>>        // Isotimia.Sxolia
49075>>>>>>>
49075>>>>>>>        // Isotimia.Dekadika
49075>>>>>>>
49075>>>>>>>        // Isotimia.Isotimia_Euro
49075>>>>>>>
49075>>>>>>>        // Isotimia.Poia_Metatrepei
49075>>>>>>>        Set Field_Value_Table      Field Isotimia.Poia_Metatrepei To (Isotimia_Poia_Metatrepei_VT(Self))
49076>>>>>>>
49076>>>>>>>        //DDB-DefineFieldEnd
49076>>>>>>>    End_Procedure    // Define_Fields
49077>>>>>>>
49077>>>>>>>    // Field_Defaults:
49077>>>>>>>    // This procedure is used to establish default field values.
49077>>>>>>>
49077>>>>>>>    Procedure Field_Defaults
49078>>>>>>>        Forward Send Field_Defaults
49080>>>>>>>        //DDB-Generated-Code-Location
49080>>>>>>>        //DDB-FieldDefaultStart
49080>>>>>>>        //DDB-FieldDefaultEnd
49080>>>>>>>    End_Procedure    // Field_Defaults
49081>>>>>>>
49081>>>>>>>End_Class    // Isotimia_DataDictionary
49082>>>>>>>//DDB-Selection-pkg-Start
49082>>>>>>>
49082>>>>>>>Use sl060.sl         // sl060
49082>>>>>>>
49082>>>>>>>//DDB-Selection-pkg-End
49082>>>>>>>//DDB-FileEnd
49082>>>>>
49082>>>>>    //AB-IgnoreEnd
49082>>>>>
49082>>>>>    CD_Popup_Object sl060 is a dbModalPanelSub
49101>>>>>
49101>>>>>        //AB-StoreTopStart
49101>>>>>        Property Integer Fragmasl060 Public 0
49103>>>>>
49103>>>>>        //AB-StoreTopEnd
49103>>>>>
49103>>>>>        Set Minimize_Icon to FALSE
49104>>>>>        set label to "ˆ©¦« £åœª" 
49105>>>>>        Set Size to 148 353
49106>>>>>        Set Location to 4 5
49107>>>>>
49107>>>>>        //AB-DDOStart
49107>>>>>
49107>>>>>        Object Isotimia_DD is a Isotimia_DataDictionary
49109>>>>>
49109>>>>>            //AB-StoreTopStart
49109>>>>>
49109>>>>>            //AB-StoreTopEnd
49109>>>>>
49109>>>>>
49109>>>>>            //AB-StoreStart
49109>>>>>            Begin_Constraints
49111>>>>>                Local Integer liNomisma
49112>>>>>                Get Fragmasl060 to liNomisma
49113>>>>>                If liNomisma ne 0 Constrain Isotimia.Nomisma_Code eq liNomisma
49117>>>>>            End_Constraints
49120>>>>>            //AB-StoreEnd
49120>>>>>
49120>>>>>        End_Object    // Isotimia_DD
49121>>>>>
49121>>>>>        Set Main_DD to (Isotimia_DD(Current_Object))
49122>>>>>        Set Server to (Isotimia_DD(Current_Object))
49123>>>>>
49123>>>>>        //AB-DDOEnd
49123>>>>>
49123>>>>>        Object oSelList is a dbListSub
49125>>>>>
49125>>>>>            //AB-StoreTopStart
49125>>>>>
49125>>>>>            //AB-StoreTopEnd
49125>>>>>
49125>>>>>            Set Main_File to Isotimia.File_Number
49126>>>>>            Set Size to 105 337
49127>>>>>            Set Location to 6 6
49128>>>>>
49128>>>>>            Begin_Row
49131>>>>>                Entry_Item Isotimia.Isotimia_hmnia
49132>>>>>                Entry_Item Isotimia.Isotimia_agora
49133>>>>>                Entry_Item Isotimia.Isotimia_polhsh
49134>>>>>                Entry_Item Isotimia.Isotimia_fixing
49135>>>>>                Entry_Item Isotimia.Isotimia_privat
49136>>>>>            End_Row
49141>>>>>
49141>>>>>            Set Form_Width    item 0 to 53
49142>>>>>            set header_label  item 0 to "†£œ¨¦£ž¤å˜" 
49143>>>>>
49143>>>>>            Set Form_Width    item 1 to 66
49144>>>>>            set header_label  item 1 to "€š¦¨á" 
49145>>>>>
49145>>>>>            Set Form_Width    item 2 to 71
49146>>>>>            set header_label  item 2 to "é¢ž©ž" 
49147>>>>>
49147>>>>>            Set Form_Width    item 3 to 70
49148>>>>>            Set Header_Label  item 3 to "Fixing"
49149>>>>>
49149>>>>>            Set Form_Width    item 4 to 70
49150>>>>>            set header_label  item 4 to "¨¦©à§ ¡ã" 
49151>>>>>
49151>>>>>
49151>>>>>            //AB-StoreStart
49151>>>>>            Property Integer StoreFragmasl060 Public 0
49153>>>>>
49153>>>>>
49153>>>>>            Procedure Store_Defaults
49155>>>>>                   Forward Send Store_Defaults
49157>>>>>                   Set StoreFragmasl060 to (Fragmasl060(Self))
49158>>>>>            End_Procedure
49159>>>>>
49159>>>>>            Procedure ReStore_Defaults
49161>>>>>                   Forward Send ReStore_Defaults
49163>>>>>                   Set Fragmasl060 to (StoreFragmasl060(Self))
49164>>>>>            End_Procedure
49165>>>>>
49165>>>>>            Procedure Activating
49167>>>>>               Forward Send Activating
49169>>>>>               Send Rebuild_Constraints to (Isotimia_DD(Self))
49170>>>>>            End_Procedure
49171>>>>>
49171>>>>>            //AB-StoreEnd
49171>>>>>
49171>>>>>        End_Object    // oSelList
49172>>>>>
49172>>>>>        Object oOK_bn is a ButtonSub
49174>>>>>            set label to "&„§ ¢¦šã" 
49175>>>>>            Set Location to 115 183
49176>>>>>
49176>>>>>            //AB-StoreStart
49176>>>>>            Procedure OnClick
49178>>>>>                Send OK To (oSelList(current_object))
49179>>>>>            End_Procedure
49180>>>>>            //AB-StoreEnd
49180>>>>>
49180>>>>>        End_Object    // oOK_bn
49181>>>>>
49181>>>>>        Object oCancel_bn is a ButtonSub
49183>>>>>            set label to "&€¡ç¨à©ž" 
49184>>>>>            Set Location to 115 238
49185>>>>>
49185>>>>>            //AB-StoreStart
49185>>>>>            Procedure OnClick
49187>>>>>                Send Cancel To (oSelList(current_object))
49188>>>>>            End_Procedure
49189>>>>>            //AB-StoreEnd
49189>>>>>
49189>>>>>        End_Object    // oCancel_bn
49190>>>>>
49190>>>>>        Object oSearch_bn is a ButtonSub
49192>>>>>            set label to "€&¤˜ã«ž©ž" 
49193>>>>>            Set Location to 115 293
49194>>>>>
49194>>>>>            //AB-StoreStart
49194>>>>>            Procedure OnClick
49196>>>>>                Send Search To (oSelList(current_object))
49197>>>>>            End_Procedure
49198>>>>>            //AB-StoreEnd
49198>>>>>
49198>>>>>        End_Object    // oSearch_bn
49199>>>>>
49199>>>>>
49199>>>>>        //AB-StoreStart
49199>>>>>
49199>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49200>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49201>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49202>>>>>        //AB-StoreEnd
49202>>>>>
49202>>>>>    CD_End_Object    // sl060
49204>>>>>>
49204>>>>>
49204>>>>>//AB/     End_Object    // prj
49204>>>Use sl94_1.sl
INCLUDING FILE: SL94_1.SL
49204>>>>>//AB/ Project sl94_1:paraggelies Prom
49204>>>>>//AB/ Object prj is a Lookup_Project
49204>>>>>//AB/     Set ProjectName to "sl94_1:paraggelies Prom"
49204>>>>>//AB/     Set ProjectFileName to "sl94_1.SL"
49204>>>>>
49204>>>>>// Project Object Structure
49204>>>>>//   sl94_1 is a dbModalPanelSub
49204>>>>>//     Country_DD is a DataDictionary
49204>>>>>//     Towns_DD is a DataDictionary
49204>>>>>//     Cities_DD is a DataDictionary
49204>>>>>//     Payresp_DD is a DataDictionary
49204>>>>>//     Areas_DD is a DataDictionary
49204>>>>>//     Clients_DD is a DataDictionary
49204>>>>>//     Clorder_DD is a DataDictionary
49204>>>>>//     oSelList is a dbListSub
49204>>>>>//     oOK_bn is a ButtonSub
49204>>>>>//     oCancel_bn is a ButtonSub
49204>>>>>//     oSearch_bn is a ButtonSub
49204>>>>>
49204>>>>>// Register all objects
49204>>>>>Register_Object Areas_DD
49204>>>>>Register_Object Cities_DD
49204>>>>>Register_Object Clients_DD
49204>>>>>Register_Object Clorder_DD
49204>>>>>Register_Object Country_DD
49204>>>>>Register_Object oCancel_bn
49204>>>>>Register_Object oOK_bn
49204>>>>>Register_Object oSearch_bn
49204>>>>>Register_Object oSelList
49204>>>>>Register_Object Payresp_DD
49204>>>>>Register_Object sl94_1
49204>>>>>Register_Object Towns_DD
49204>>>>>
49204>>>>>
49204>>>>>
49204>>>>>//AB-StoreTopStart
49204>>>>>open nomisma
49206>>>>>//AB-StoreTopEnd
49206>>>>>
49206>>>>>//AB-IgnoreStart
49206>>>>>
49206>>>>>Use DFAllEnt.pkg
49206>>>>>Use dbList.Sub
49206>>>>>Use Button.Sub
49206>>>>>
49206>>>>>
49206>>>>>Use COUNTRY.DD
49206>>>>>Use TOWNS.DD
49206>>>>>Use CITIES.DD
49206>>>>>Use PAYRESP.DD
49206>>>>>Use AREAS.DD
49206>>>>>Use CLIENTS.DD
49206>>>>>Use CLORDER.DD
INCLUDING FILE: CLORDER.DD
49206>>>>>>>//DDB-FileStart
49206>>>>>>>//DDB-HeaderStart
49206>>>>>>>
49206>>>>>>>// File Name : CLORDER.DD
49206>>>>>>>// Class Name: Clorder_DataDictionary
49206>>>>>>>// Revision  : 34
49206>>>>>>>// Version   : 2
49206>>>>>>>
49206>>>>>>>Use  Windows           // Basic Definitions
49206>>>>>>>Use  DataDict          // DataDictionary Class Definition
49206>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49206>>>>>>>
49206>>>>>>>Open Clorder
49208>>>>>>>Open Clorderd
49210>>>>>>>Open Clients
49212>>>>>>>Open Sysrecc
49214>>>>>>>Open Codetype
INCLUDING FILE: CODETYPE.FD
49216>>>>>>>
49216>>>>>>>//DDB-HeaderEnd
49216>>>>>>>//DDB-ValidationStart
49216>>>>>>>
49216>>>>>>>Register_Object Clorder_Tropos_VT
49216>>>>>>>Register_Object Clorder_How_Pay_VT
49216>>>>>>>
49216>>>>>>>Object Clorder_Tropos_VT  is a CodeValidationTable
49218>>>>>>>    Set Type_Value        To "SEND_TERMS"
49219>>>>>>>    Set Validate_State    To FALSE
49220>>>>>>>    Set Allow_Blank_State To TRUE
49221>>>>>>>    Set Table_Title       To "’¨æ§¦  ˜¨á›¦©žª"
49222>>>>>>>    //DDB-ValidationCustomStart
49222>>>>>>>    //DDB-ValidationCustomEnd
49222>>>>>>>End_Object   // Clorder_Tropos_VT
49223>>>>>>>
49223>>>>>>>Object Clorder_How_Pay_VT  is a CodeValidationTable
49225>>>>>>>    Set Type_Value        To "PAY_TERMS"
49226>>>>>>>    Set Validate_State    To FALSE
49227>>>>>>>    Set Allow_Blank_State To TRUE
49228>>>>>>>    Set Table_Title       To "’¨æ§¦  ¢ž¨à£ãª"
49229>>>>>>>    //DDB-ValidationCustomStart
49229>>>>>>>    //DDB-ValidationCustomEnd
49229>>>>>>>End_Object   // Clorder_How_Pay_VT
49230>>>>>>>//DDB-ValidationEnd
49230>>>>>>>//DDB-SelectionStart
49230>>>>>>>//DDB/ ExternalSelectionList slNomism  slnomism.sl
49230>>>>>>>Register_Object slNomism
49230>>>>>>>//DDB-SelectionEnd
49230>>>>>>>  
49230>>>>>>>Class Clorder_DataDictionary  is a DataDictionary_Sec
49231>>>>>>>
49231>>>>>>>    // Define_Fields:
49231>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49231>>>>>>>
49231>>>>>>>    Procedure Define_Fields
49232>>>>>>>        Forward Send Define_Fields
49234>>>>>>>        //DDB-Generated-Code-Location
49234>>>>>>>        //DDB-DefineFieldStart
49234>>>>>>>
49234>>>>>>>        Set Main_File            To Clorder.File_Number
49235>>>>>>>        Set Cascade_Delete_State To FALSE
49236>>>>>>>
49236>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49237>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49238>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49239>>>>>>>
49239>>>>>>>        // Child (Client) file structure................
49239>>>>>>>        Send Add_Client_File  Clorderd.File_Number
49240>>>>>>>
49240>>>>>>>        // Parent (Server) file structure...............
49240>>>>>>>        Send Add_Server_File  Clients.File_Number
49241>>>>>>>
49241>>>>>>>        // External (System) file structure.............
49241>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
49242>>>>>>>        Send Add_System_File  Codetype.File_Number  DD_LOCK_ON_ALL
49243>>>>>>>
49243>>>>>>>        // Field-based properties.......................
49243>>>>>>>
49243>>>>>>>        // Clorder.Company_Code
49243>>>>>>>
49243>>>>>>>        // Clorder.Branch_Code
49243>>>>>>>
49243>>>>>>>        // Clorder.Year_Year
49243>>>>>>>
49243>>>>>>>        // Clorder.Aapar
49243>>>>>>>
49243>>>>>>>        // Clorder.Clients_Code
49243>>>>>>>
49243>>>>>>>        // Clorder.Armod
49243>>>>>>>
49243>>>>>>>        // Clorder.Order1_Recr
49243>>>>>>>
49243>>>>>>>        // Clorder.Rec0
49243>>>>>>>
49243>>>>>>>        // Clorder.Recr
49243>>>>>>>
49243>>>>>>>        // Clorder.Our_Date
49243>>>>>>>        Set Field_Mask_Type        Field Clorder.Our_Date To MASK_DATE_WINDOW
49244>>>>>>>
49244>>>>>>>        // Clorder.Rial_Date
49244>>>>>>>        Set Field_Mask_Type        Field Clorder.Rial_Date To MASK_DATE_WINDOW
49245>>>>>>>
49245>>>>>>>        // Clorder.Qty
49245>>>>>>>
49245>>>>>>>        // Clorder.Unitprice
49245>>>>>>>
49245>>>>>>>        // Clorder.Disc
49245>>>>>>>
49245>>>>>>>        // Clorder.Fpa
49245>>>>>>>
49245>>>>>>>        // Clorder.Net
49245>>>>>>>
49245>>>>>>>        // Clorder.Extra
49245>>>>>>>
49245>>>>>>>        // Clorder.Total
49245>>>>>>>
49245>>>>>>>        // Clorder.Aaparprom
49245>>>>>>>
49245>>>>>>>        // Clorder.Tropos
49245>>>>>>>        Set Field_Value_Table      Field Clorder.Tropos To (Clorder_Tropos_VT(Self))
49246>>>>>>>
49246>>>>>>>        // Clorder.Date
49246>>>>>>>        Set Field_Entry_msg        Field Clorder.Date To Entry_clorder_date
49247>>>>>>>        Set Field_Mask_Type        Field Clorder.Date To MASK_DATE_WINDOW
49248>>>>>>>
49248>>>>>>>        // Clorder.How_Pay
49248>>>>>>>        Set Field_Value_Table      Field Clorder.How_Pay To (Clorder_How_Pay_VT(Self))
49249>>>>>>>
49249>>>>>>>        // Clorder.Finish
49249>>>>>>>        Set Field_Mask             Field Clorder.Finish To "#"
49250>>>>>>>        Set Field_Mask_Type        Field Clorder.Finish To MASK_NUMERIC_WINDOW
49251>>>>>>>
49251>>>>>>>        // Clorder.Okey
49251>>>>>>>        Set Field_Mask             Field Clorder.Okey To "#"
49252>>>>>>>        Set Field_Mask_Type        Field Clorder.Okey To MASK_NUMERIC_WINDOW
49253>>>>>>>
49253>>>>>>>        // Clorder.Akyrh
49253>>>>>>>        Set Field_Mask             Field Clorder.Akyrh To "#"
49254>>>>>>>        Set Field_Mask_Type        Field Clorder.Akyrh To MASK_NUMERIC_WINDOW
49255>>>>>>>
49255>>>>>>>        // Clorder.Sxolia
49255>>>>>>>
49255>>>>>>>        // Clorder.Posodtl
49255>>>>>>>
49255>>>>>>>        // Clorder.Qtydtl
49255>>>>>>>
49255>>>>>>>        // Clorder.Nomisma
49255>>>>>>>        Set Field_Prompt_Object    Field Clorder.Nomisma To (slNomism(Self))
49256>>>>>>>
49256>>>>>>>        // Clorder.Module
49256>>>>>>>
49256>>>>>>>        // Clorder.Codetype
49256>>>>>>>
49256>>>>>>>        //DDB-DefineFieldEnd
49256>>>>>>>    End_Procedure    // Define_Fields
49257>>>>>>>
49257>>>>>>>     Procedure Update
49258>>>>>>>        Forward Send Update
49260>>>>>>>        move syscurxr.company_code to clorder.company_code
49261>>>>>>>        move syscurxr.branch_code  to clorder.branch_code
49262>>>>>>>        move syscurxr.year_year    to clorder.year_year
49263>>>>>>>        MOVE CODETYPE.TYPE         to clorder.codetype
49264>>>>>>>        // Insert Code Here
49264>>>>>>>    End_Procedure   // Update
49265>>>>>>>
49265>>>>>>>
49265>>>>>>>
49265>>>>>>>
49265>>>>>>>    Procedure Creating
49266>>>>>>>        if (clorder.module <> '01') move '02' to clorder.module
49269>>>>>>>        if (clorder.module = '01') begin
49271>>>>>>>           move (sysrecc.clorderc_rec0 + 1) to clorder.rec0
49272>>>>>>>           move clorder.rec0 to sysrecc.clorderc_rec0
49273>>>>>>>           saverecord sysrecc
49274>>>>>>>        end
49274>>>>>>>>
49274>>>>>>>        else begin
49275>>>>>>>           move (sysrecc.clorder_rec0 + 1) to clorder.rec0
49276>>>>>>>           move clorder.rec0 to sysrecc.clorder_rec0
49277>>>>>>>           saverecord sysrecc
49278>>>>>>>        end
49278>>>>>>>>
49278>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                         (Trim(String(clorder.rec0)))))) to clorder.recr
49279>>>>>>>        Move clorder.recr to clorder.aapar
49280>>>>>>>        move clorder.date to clients.last_order
49281>>>>>>>    End_Procedure   //
49282>>>>>>>    // Field_Defaults:
49282>>>>>>>    // This procedure is used to establish default field values.
49282>>>>>>>
49282>>>>>>>     Procedure Entry_clorder_date Integer iField Date dDate
49283>>>>>>>         Local Integer Changed
49284>>>>>>>         Get Field_Changed_State iField to Changed
49285>>>>>>>         If ( Changed=0 AND dDate = 0) Begin
49287>>>>>>>           SysDate4 dDate
49288>>>>>>>           Set Field_Default_Value iField to dDate
49289>>>>>>>         End
49289>>>>>>>>
49289>>>>>>>    End_Procedure
49290>>>>>>>
49290>>>>>>>
49290>>>>>>>    Procedure Field_Defaults
49291>>>>>>>        Forward Send Field_Defaults
49293>>>>>>>        //DDB-Generated-Code-Location
49293>>>>>>>        //DDB-FieldDefaultStart
49293>>>>>>>        //DDB-FieldDefaultEnd
49293>>>>>>>    End_Procedure    // Field_Defaults
49294>>>>>>>
49294>>>>>>>End_Class    // Clorder_DataDictionary
49295>>>>>>>//DDB-Selection-pkg-Start
49295>>>>>>>
49295>>>>>>>Use slnomism.sl      // slNomism
49295>>>>>>>
49295>>>>>>>//DDB-Selection-pkg-End
49295>>>>>>>//DDB-FileEnd
49295>>>>>
49295>>>>>//AB-IgnoreEnd
49295>>>>>
49295>>>>>Object sl94_1 is a dbModalPanelSub
49297>>>>>
49297>>>>>    //AB-StoreTopStart
49297>>>>>    
49297>>>>>    property string psmodule public ''
49299>>>>>    property string psclient public ''
49301>>>>>    
49301>>>>>    //AB-StoreTopEnd
49301>>>>>
49301>>>>>    Set Label to "˜¨˜ššœ¢åœª €¤á ¨¦£žŸœ¬«ã"
49302>>>>>    Set Size to 239 506
49303>>>>>    Set Location to 4 5
49304>>>>>    Set Exit_Application_Local_State to FALSE
49305>>>>>    Set Modal_State to FALSE
49306>>>>>
49306>>>>>    //AB-DDOStart
49306>>>>>
49306>>>>>    Object Country_DD is a Country_DataDictionary
49308>>>>>    End_Object    // Country_DD
49309>>>>>
49309>>>>>    Object Towns_DD is a Towns_DataDictionary
49311>>>>>        Set DDO_Server to (Country_DD(self))
49312>>>>>    End_Object    // Towns_DD
49313>>>>>
49313>>>>>    Object Cities_DD is a Cities_DataDictionary
49315>>>>>        Set DDO_Server to (Towns_DD(self))
49316>>>>>    End_Object    // Cities_DD
49317>>>>>
49317>>>>>    Object Payresp_DD is a Payresp_DataDictionary
49319>>>>>    End_Object    // Payresp_DD
49320>>>>>
49320>>>>>    Object Areas_DD is a Areas_DataDictionary
49322>>>>>    End_Object    // Areas_DD
49323>>>>>
49323>>>>>    Object Clients_DD is a Clients_DataDictionary
49325>>>>>        Set DDO_Server to (Cities_DD(self))
49326>>>>>        Set DDO_Server to (Payresp_DD(self))
49327>>>>>        Set DDO_Server to (Areas_DD(self))
49328>>>>>    End_Object    // Clients_DD
49329>>>>>
49329>>>>>    Object Clorder_DD is a Clorder_DataDictionary
49331>>>>>        Set DDO_Server to (Clients_DD(self))
49332>>>>>
49332>>>>>        //AB-StoreStart
49332>>>>>        Procedure OnConstrain
49334>>>>>            Constrain clorder.company_code  eq SysCurXR.Company_Code
49336>>>>>            Constrain clorder.Branch_Code   eq SysCurXR.Branch_Code
49338>>>>>            Constrain clorder.Year_Year     eq SysCurXR.Year_Year
49340>>>>>        
49340>>>>>            If (psModule(Self)<>'') Begin
49342>>>>>                Constrain clorder.Module eq (psModule(Self))
49344>>>>>            End
49344>>>>>>
49344>>>>>            If (psclient(Self)<>'') Begin
49346>>>>>                Constrain clorder.clients_code eq (psclient(Self))
49348>>>>>            End
49348>>>>>>
49348>>>>>        End_Procedure
49349>>>>>        
49349>>>>>        
49349>>>>>        
49349>>>>>        
49349>>>>>        
49349>>>>>        
49349>>>>>        
49349>>>>>        
49349>>>>>        
49349>>>>>        
49349>>>>>        
49349>>>>>        
49349>>>>>        
49349>>>>>        
49349>>>>>        
49349>>>>>        
49349>>>>>        
49349>>>>>        //AB-StoreEnd
49349>>>>>
49349>>>>>    End_Object    // Clorder_DD
49350>>>>>
49350>>>>>    Set Main_DD to (Clorder_DD(self))
49351>>>>>    Set Server to (Clorder_DD(self))
49352>>>>>
49352>>>>>    //AB-DDOEnd
49352>>>>>
49352>>>>>    Object oSelList is a dbListSub
49354>>>>>        Set Main_File to Clorder.File_Number
49355>>>>>        Set Ordering to 1
49356>>>>>        Set Size to 199 493
49357>>>>>        Set Location to 6 6
49358>>>>>        Set Color to 14280447
49359>>>>>        Set CurrentRowColor to 11783679
49360>>>>>        Set CurrentCellColor to 11783679
49361>>>>>
49361>>>>>        Begin_Row
49364>>>>>            Entry_Item Clorder.Aapar
49365>>>>>            Entry_Item Clients.Client_name
49366>>>>>            Entry_Item Clorder.Date
49367>>>>>            Entry_Item Clorder.Armod
49368>>>>>            Entry_Item Clorder.Nomisma
49369>>>>>            Entry_Item Clorder.Total
49370>>>>>            Entry_Item Clorder.Finish
49371>>>>>            Entry_Item Clorder.Okey
49372>>>>>            Entry_Item Clorder.Akyrh
49373>>>>>            Entry_Item Clorder.Rial_date
49374>>>>>        End_Row
49379>>>>>
49379>>>>>        Set Form_Width    item 0 to 52
49380>>>>>        Set Header_Label  item 0 to "€/˜ ˜¨˜šš."
49381>>>>>        
49381>>>>>        Set Form_Width    item 1 to 87
49382>>>>>        Set Header_Label  item 1 to ""
49383>>>>>        
49383>>>>>        Set Form_Width    item 2 to 45
49384>>>>>        Set Header_Label  item 2 to "†£/¤å˜ "
49385>>>>>        
49385>>>>>        Set Form_Width    item 3 to 82
49386>>>>>        Set Header_Label  item 3 to "“§œçŸ¬¤¦ª ‘ç¤«˜¥žª"
49387>>>>>        
49387>>>>>        Set Form_Width    item 4 to 30
49388>>>>>        Set Header_Label  item 4 to "Œæ£"
49389>>>>>        
49389>>>>>        Set Form_Width    item 5 to 69
49390>>>>>        Set Header_Label  item 5 to "‘ç¤.˜¨˜ššœ¢å˜ª"
49391>>>>>        
49391>>>>>        Set Form_Width    item 6 to 17
49392>>>>>        Set Header_Label  item 6 to "Ž‰"
49393>>>>>        Set Column_Checkbox_State  item 6 to True
49394>>>>>        
49394>>>>>        Set Form_Width    item 7 to 33
49395>>>>>        Set Header_Label  item 7 to "„§ ™œ™."
49396>>>>>        Set Column_Checkbox_State  item 7 to True
49397>>>>>        
49397>>>>>        Set Form_Width    item 8 to 30
49398>>>>>        Set Header_Label  item 8 to "€¡¬¨ž"
49399>>>>>        Set Column_Checkbox_State  item 8 to True
49400>>>>>        
49400>>>>>        Set Form_Width    item 9 to 43
49401>>>>>        Set Header_Label  item 9 to "œ¨˜ àŸ."
49402>>>>>        
49402>>>>>
49402>>>>>        //AB-StoreStart
49402>>>>>        Set Points          Item 5 to       2
49403>>>>>        Set Numeric_Mask    Item 5 to 14    2 ' ,*'
49404>>>>>        set ordering to 1
49405>>>>>        Property String Store_Fragma_prom public ""
49407>>>>>        //
49407>>>>>        Procedure Store_Defaults
49409>>>>>           forward send Store_Defaults
49411>>>>>           Set Store_Fragma_prom to (psclient(Self))
49412>>>>>        end_Procedure
49413>>>>>        //
49413>>>>>        Procedure Restore_Defaults
49415>>>>>            forward send Restore_Defaults
49417>>>>>            Set psclient to (Store_Fragma_prom(Self))
49418>>>>>        end_Procedure
49419>>>>>        //
49419>>>>>        
49419>>>>>        
49419>>>>>        
49419>>>>>        Procedure Activating Returns Integer
49421>>>>>            Integer rVal
49422>>>>>            Forward Get Msg_Activating to rVal
49424>>>>>                 if (psmodule(self)='01') set label of sl100 to '‰˜«á¢¦š¦ª œ¢˜«é¤'
49427>>>>>            else if (psmodule(self)='02') set label of sl100 to '‰˜«á¢¦š¦ª ¨¦£žŸœ¬«é¤'
49431>>>>>            Send Rebuild_Constraints to Clorder_DD
49432>>>>>          //  Send Beginning_Of_Data to oSelList True
49432>>>>>            Procedure_Return rVal
49433>>>>>        End_procedure
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        
49434>>>>>        //AB-StoreEnd
49434>>>>>
49434>>>>>    End_Object    // oSelList
49435>>>>>
49435>>>>>    Object oOK_bn is a ButtonSub
49437>>>>>        Set Label to "€§¦›¦®ã"
49438>>>>>        Set Location to 209 334
49439>>>>>
49439>>>>>        //AB-StoreStart
49439>>>>>        Procedure OnClick
49441>>>>>            Send OK To (oSelList(current_object))
49442>>>>>        End_Procedure
49443>>>>>        //AB-StoreEnd
49443>>>>>
49443>>>>>    End_Object    // oOK_bn
49444>>>>>
49444>>>>>    Object oCancel_bn is a ButtonSub
49446>>>>>        Set Label to "€¡ç¨à©ž"
49447>>>>>        Set Location to 209 388
49448>>>>>
49448>>>>>        //AB-StoreStart
49448>>>>>        Procedure OnClick
49450>>>>>            Send Cancel To (oSelList(current_object))
49451>>>>>        End_Procedure
49452>>>>>        //AB-StoreEnd
49452>>>>>
49452>>>>>    End_Object    // oCancel_bn
49453>>>>>
49453>>>>>    Object oSearch_bn is a ButtonSub
49455>>>>>        Set Label to "€¤˜ã«ž©ž"
49456>>>>>        Set Location to 209 444
49457>>>>>
49457>>>>>        //AB-StoreStart
49457>>>>>        Procedure OnClick
49459>>>>>            Send Search To (oSelList(current_object))
49460>>>>>        End_Procedure
49461>>>>>        //AB-StoreEnd
49461>>>>>
49461>>>>>    End_Object    // oSearch_bn
49462>>>>>
49462>>>>>
49462>>>>>    //AB-StoreStart
49462>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49463>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49464>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49465>>>>>    
49465>>>>>    Set Locate_Mode to Center_On_Screen
49466>>>>>    
49466>>>>>    Procedure Activating returns integer
49468>>>>>        string smodule
49469>>>>>        integer rval
49469>>>>>        get psmodule to smodule
49470>>>>>        if (sModule='01') set header_label  of (osellist(self)) item 1 to 'œ¢á«žª'
49473>>>>>        else              set header_label  of (osellist(self)) item 1 to '¨¦£žŸœ¬«ãª'
49475>>>>>        if (sModule='01') set label of sl94_1 to '˜¨˜ššœ¢åœª / œ¢á«ž'
49478>>>>>        else              set label of sl94_1 to '˜¨˜ššœ¢åœª / ¨¦£žŸœ¬«ã'
49480>>>>>        Send Rebuild_Constraints to clorder_DD
49481>>>>>        Send Beginning_Of_Data to oSelList True
49482>>>>>        Procedure_Return rVal
49483>>>>>    
49483>>>>>    End_Procedure
49484>>>>>    
49484>>>>>    
49484>>>>>    
49484>>>>>    
49484>>>>>    
49484>>>>>    
49484>>>>>    
49484>>>>>    
49484>>>>>    
49484>>>>>    
49484>>>>>    
49484>>>>>    
49484>>>>>    
49484>>>>>    
49484>>>>>    
49484>>>>>    
49484>>>>>    
49484>>>>>    //AB-StoreEnd
49484>>>>>
49484>>>>>End_Object    // sl94_1
49485>>>>>
49485>>>>>
49485>>>>>//AB-StoreStart
49485>>>>>                            
49485>>>>>                            
49485>>>>>                            
49485>>>>>//AB-StoreEnd
49485>>>>>
49485>>>>>//AB/ End_Object    // prj
49485>>>Use sl100.sl
49485>>>use sl108.sl
INCLUDING FILE: SL108.SL
49485>>>>>//AB/ Project sl108:polhtes
49485>>>>>//AB/ Object prj is a Lookup_Project
49485>>>>>//AB/     Set ProjectName to "sl108:polhtes"
49485>>>>>//AB/     Set ProjectFileName to "sl108.SL"
49485>>>>>//AB/     Set GenerateFileName to "NONAME"
49485>>>>>
49485>>>>>// Project Object Structure
49485>>>>>//   sl108 is a dbModalPanelSub
49485>>>>>//     Salesmen_DD is a DataDictionary
49485>>>>>//     oSelList is a dbListSub
49485>>>>>//     oOK_bn is a ButtonSub
49485>>>>>//     oCancel_bn is a ButtonSub
49485>>>>>//     oSearch_bn is a ButtonSub
49485>>>>>
49485>>>>>// Register all objects
49485>>>>>Register_Object oCancel_bn
49485>>>>>Register_Object oOK_bn
49485>>>>>Register_Object oSearch_bn
49485>>>>>Register_Object oSelList
49485>>>>>Register_Object Salesmen_DD
49485>>>>>Register_Object sl108
49485>>>>>
49485>>>>>
49485>>>>>//AB-IgnoreStart
49485>>>>>
49485>>>>>Use DFAllEnt.pkg
49485>>>>>Use dbList.Sub
49485>>>>>Use Button.Sub
49485>>>>>
49485>>>>>
49485>>>>>Use SALESMEN.DD
INCLUDING FILE: SALESMEN.DD
49485>>>>>>>//DDB-FileStart
49485>>>>>>>//DDB-HeaderStart
49485>>>>>>>
49485>>>>>>>// File Name : SALESMEN.DD
49485>>>>>>>// Class Name: Salesmen_DataDictionary
49485>>>>>>>// Revision  : 57
49485>>>>>>>// Version   : 2
49485>>>>>>>
49485>>>>>>>Use  Windows           // Basic Definitions
49485>>>>>>>Use  DataDict          // DataDictionary Class Definition
49485>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49485>>>>>>>
49485>>>>>>>Open Salesmen
49487>>>>>>>Open Cn
49489>>>>>>>Open Sysrecc
49491>>>>>>>
49491>>>>>>>//DDB-HeaderEnd
49491>>>>>>>//DDB-ValidationStart
49491>>>>>>>
49491>>>>>>>Register_Object Salesmen_Sls_Doy_VT
49491>>>>>>>
49491>>>>>>>Object Salesmen_Sls_Doy_VT  is a CodeValidationTable
49493>>>>>>>    Set Type_Value        To "DOY"
49494>>>>>>>    Set Allow_Blank_State To TRUE
49495>>>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
49496>>>>>>>    //DDB-ValidationCustomStart
49496>>>>>>>    //DDB-ValidationCustomEnd
49496>>>>>>>End_Object   // Salesmen_Sls_Doy_VT
49497>>>>>>>//DDB-ValidationEnd
49497>>>>>>>//DDB-SelectionStart
49497>>>>>>>//DDB/ ExternalSelectionList sl108  sl108.sl
49497>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
49497>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
49497>>>>>>>Register_Object sl108
49497>>>>>>>Register_Object sl198
49497>>>>>>>Register_Object sl197
49497>>>>>>>//DDB-SelectionEnd
49497>>>>>>>
49497>>>>>>>Class Salesmen_DataDictionary  is a DataDictionary_Sec
49498>>>>>>> 
49498>>>>>>>    // Save_Main_File:
49498>>>>>>> 
49498>>>>>>>    Procedure Save_Main_File
49499>>>>>>>        If ((Operation_Origin<>Self) And (Salesmen.Sls_ID='')) Procedure_Return
49502>>>>>>>        Forward Send Save_Main_File
49504>>>>>>>    End_Procedure   // Save_Main_File
49505>>>>>>> 
49505>>>>>>>    // Define_Fields:
49505>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49505>>>>>>>     Procedure Update
49506>>>>>>>        Forward Send Update
49508>>>>>>>        // Insert Code Here
49508>>>>>>>        Move SysCurXR.Company_Code  to salesmen.Company_Code
49509>>>>>>>        Move SysCurXR.Branch_Code   to salesmen.Branch_Code
49510>>>>>>>        Move SysCurXR.Year_Year     to salesmen.Year_Year
49511>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
49511>>>>>>>        Move (salesmen.Xreosh-salesmen.Pistosh)   to salesmen.Ypoloipo
49512>>>>>>>        Move (salesmen.Plafon-salesmen.ypoloipo)  to salesmen.Overhead
49513>>>>>>>
49513>>>>>>>        //Move Clients.Client_Address     to Clients.Client_LastUpd
49513>>>>>>>
49513>>>>>>>        //betolink
49513>>>>>>>        Move SysCurXR.Beto_Site      to salesmen.sls_SiteW
49514>>>>>>>        Move salesmen.sls_Rec0       to salesmen.sls_SN
49515>>>>>>>        Move salesmen.sls_id         to salesmen.sls_Repm
49516>>>>>>>
49516>>>>>>>    End_Procedure   // Update
49517>>>>>>>
49517>>>>>>>     Procedure Creating
49518>>>>>>>        Forward Send Creating
49520>>>>>>>        // Insert Code Here
49520>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(salesmen.sls_Rec0))))));                                    to salesmen.sls_Recr
49521>>>>>>>        Move '1'                    to salesmen.sls_Active
49522>>>>>>>        get fsgCode_With_Zeroes salesmen.sls_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to salesmen.sls_ID
49523>>>>>>>    End_Procedure   // Creating
49524>>>>>>>
49524>>>>>>>    Procedure Define_Fields
49525>>>>>>>        Forward Send Define_Fields
49527>>>>>>>        //DDB-Generated-Code-Location
49527>>>>>>>        //DDB-DefineFieldStart
49527>>>>>>>
49527>>>>>>>        Set Main_File            To Salesmen.File_Number
49528>>>>>>>        Set Cascade_Delete_State To FALSE
49529>>>>>>>
49529>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49530>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49531>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49532>>>>>>>
49532>>>>>>>        // Child (Client) file structure................
49532>>>>>>>        Send Add_Client_File  Cn.File_Number
49533>>>>>>>
49533>>>>>>>        // External (System) file structure.............
49533>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
49534>>>>>>>
49534>>>>>>>        Define_Auto_Increment  Sysrecc.Salesmen_Rec0  To Salesmen.Sls_Rec0
49537>>>>>>>
49537>>>>>>>        // Field-based properties.......................
49537>>>>>>>
49537>>>>>>>        // Salesmen.Company_Code
49537>>>>>>>
49537>>>>>>>        // Salesmen.Branch_Code
49537>>>>>>>
49537>>>>>>>        // Salesmen.Year_Year
49537>>>>>>>
49537>>>>>>>        // Salesmen.Sls_Id
49537>>>>>>>        Set Field_Options          Field Salesmen.Sls_Id To DD_AUTOFIND    DD_FINDREQ    
49538>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Id To (sl108(Self))
49539>>>>>>>        Set Key_Field_State        Field Salesmen.Sls_Id To TRUE
49540>>>>>>>
49540>>>>>>>        // Salesmen.Sls_Name
49540>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Name To (sl108(Self))
49541>>>>>>>
49541>>>>>>>        // Salesmen.Sls_Afm
49541>>>>>>>
49541>>>>>>>        // Salesmen.Sls_Rec0
49541>>>>>>>
49541>>>>>>>        // Salesmen.Sls_Recr
49541>>>>>>>
49541>>>>>>>        // Salesmen.Last_Xreosh
49541>>>>>>>
49541>>>>>>>        // Salesmen.Last_Pistosh
49541>>>>>>>
49541>>>>>>>        // Salesmen.Last_Order
49541>>>>>>>
49541>>>>>>>        // Salesmen.Sls_Doy
49541>>>>>>>        Set Field_Value_Table      Field Salesmen.Sls_Doy To (Salesmen_Sls_Doy_VT(Self))
49542>>>>>>>
49542>>>>>>>        // Salesmen.Sls_Address
49542>>>>>>>
49542>>>>>>>        // Salesmen.Sls_City
49542>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_City To (sl198(Self))
49543>>>>>>>
49543>>>>>>>        // Salesmen.Sls_Area
49543>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Area To (sl197(Self))
49544>>>>>>>
49544>>>>>>>        // Salesmen.Sls_Job
49544>>>>>>>
49544>>>>>>>        // Salesmen.Sls_Respons
49544>>>>>>>
49544>>>>>>>        // Salesmen.Sls_Zipcode
49544>>>>>>>
49544>>>>>>>        // Salesmen.Sls_Phone
49544>>>>>>>
49544>>>>>>>        // Salesmen.Sls_Fax
49544>>>>>>>
49544>>>>>>>        // Salesmen.Sls_Mobile
49544>>>>>>>
49544>>>>>>>        // Salesmen.Sls_Aoh
49544>>>>>>>
49544>>>>>>>        // Salesmen.Sls_Email
49544>>>>>>>
49544>>>>>>>        // Salesmen.Sls_Class
49544>>>>>>>
49544>>>>>>>        // Salesmen.Sls_Details
49544>>>>>>>
49544>>>>>>>        // Salesmen.Sls_Sitew
49544>>>>>>>
49544>>>>>>>        // Salesmen.Sls_Codem
49544>>>>>>>
49544>>>>>>>        // Salesmen.Sls_Categfpa
49544>>>>>>>
49544>>>>>>>        // Salesmen.Sls_Fpa
49544>>>>>>>
49544>>>>>>>        // Salesmen.Sls_Public
49544>>>>>>>
49544>>>>>>>        // Salesmen.Sls_Sn
49544>>>>>>>
49544>>>>>>>        // Salesmen.Sls_Repm
49544>>>>>>>
49544>>>>>>>        // Salesmen.Sls_Active
49544>>>>>>>
49544>>>>>>>        // Salesmen.Sls_Reported
49544>>>>>>>
49544>>>>>>>        // Salesmen.Sls_Lastupd
49544>>>>>>>
49544>>>>>>>        // Salesmen.Sls_Markexp
49544>>>>>>>
49544>>>>>>>        // Salesmen.Sls_Catjob
49544>>>>>>>
49544>>>>>>>        // Salesmen.Xreosh
49544>>>>>>>
49544>>>>>>>        // Salesmen.Pistosh
49544>>>>>>>
49544>>>>>>>        // Salesmen.Ypoloipo
49544>>>>>>>
49544>>>>>>>        // Salesmen.Plafon
49544>>>>>>>
49544>>>>>>>        // Salesmen.Overhead
49544>>>>>>>
49544>>>>>>>        // Salesmen.Sls_Add_No
49544>>>>>>>
49544>>>>>>>        // Salesmen.Sls_Nomos
49544>>>>>>>
49544>>>>>>>        // Salesmen.Sls_Xora
49544>>>>>>>
49544>>>>>>>        // Salesmen.Polh_Recr
49544>>>>>>>
49544>>>>>>>        //DDB-DefineFieldEnd
49544>>>>>>>    End_Procedure    // Define_Fields
49545>>>>>>>
49545>>>>>>>    // Field_Defaults:
49545>>>>>>>    // This procedure is used to establish default field values.
49545>>>>>>>
49545>>>>>>>    Procedure Field_Defaults
49546>>>>>>>        Forward Send Field_Defaults
49548>>>>>>>        //DDB-Generated-Code-Location
49548>>>>>>>        //DDB-FieldDefaultStart
49548>>>>>>>        Set Field_Changed_Value   Field Salesmen.Sls_Doy To "0"
49549>>>>>>>        //DDB-FieldDefaultEnd
49549>>>>>>>    End_Procedure    // Field_Defaults
49550>>>>>>>
49550>>>>>>>End_Class    // Salesmen_DataDictionary
49551>>>>>>>//DDB-Selection-pkg-Start
49551>>>>>>>
49551>>>>>>>Use sl108.sl         // sl108
49551>>>>>>>Use sl198.sl         // sl198
49551>>>>>>>Use sl197.SL         // sl197
49551>>>>>>>
49551>>>>>>>//DDB-Selection-pkg-End
49551>>>>>>>//DDB-FileEnd
49551>>>>>
49551>>>>>//AB-IgnoreEnd
49551>>>>>
49551>>>>>Object sl108 is a dbModalPanelSub
49553>>>>>    Set Label to "‹ž«¨é¦ à¢ž«é¤"
49554>>>>>    Set Size to 148 421
49555>>>>>    Set Location to 4 5
49556>>>>>    Set Exit_Application_Local_State to FALSE
49557>>>>>    Set Modal_State to FALSE
49558>>>>>
49558>>>>>    //AB-DDOStart
49558>>>>>
49558>>>>>    Object Salesmen_DD is a Salesmen_DataDictionary
49560>>>>>    End_Object    // Salesmen_DD
49561>>>>>
49561>>>>>    Set Main_DD to (Salesmen_DD(self))
49562>>>>>    Set Server to (Salesmen_DD(self))
49563>>>>>
49563>>>>>    //AB-DDOEnd
49563>>>>>
49563>>>>>    Object oSelList is a dbListSub
49565>>>>>        Set Main_File to Salesmen.File_Number
49566>>>>>        Set Size to 105 408
49567>>>>>        Set Location to 6 6
49568>>>>>
49568>>>>>        Begin_Row
49571>>>>>            Entry_Item Salesmen.Sls_id
49572>>>>>            Entry_Item Salesmen.Sls_name
49573>>>>>            Entry_Item Salesmen.Sls_afm
49574>>>>>            Entry_Item Salesmen.Sls_address
49575>>>>>            Entry_Item Salesmen.Sls_phone
49576>>>>>        End_Row
49581>>>>>
49581>>>>>        Set Form_Width    item 0 to 60
49582>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
49583>>>>>        
49583>>>>>        Set Form_Width    item 1 to 100
49584>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
49585>>>>>        
49585>>>>>        Set Form_Width    item 2 to 60
49586>>>>>        Set Header_Label  item 2 to "€.”.‹"
49587>>>>>        
49587>>>>>        Set Form_Width    item 3 to 125
49588>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
49589>>>>>        
49589>>>>>        Set Form_Width    item 4 to 54
49590>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
49591>>>>>        
49591>>>>>    End_Object    // oSelList
49592>>>>>
49592>>>>>    Object oOK_bn is a ButtonSub
49594>>>>>        Set Label to "&„§ ¢¦šã"
49595>>>>>        Set Location to 117 255
49596>>>>>
49596>>>>>        //AB-StoreStart
49596>>>>>        Procedure OnClick
49598>>>>>            Send OK To (oSelList(current_object))
49599>>>>>        End_Procedure
49600>>>>>        //AB-StoreEnd
49600>>>>>
49600>>>>>    End_Object    // oOK_bn
49601>>>>>
49601>>>>>    Object oCancel_bn is a ButtonSub
49603>>>>>        Set Label to "&€¡ç¨à©ž"
49604>>>>>        Set Location to 117 310
49605>>>>>
49605>>>>>        //AB-StoreStart
49605>>>>>        Procedure OnClick
49607>>>>>            Send Cancel To (oSelList(current_object))
49608>>>>>        End_Procedure
49609>>>>>        //AB-StoreEnd
49609>>>>>
49609>>>>>    End_Object    // oCancel_bn
49610>>>>>
49610>>>>>    Object oSearch_bn is a ButtonSub
49612>>>>>        Set Label to "€&¤˜ã«ž©ž"
49613>>>>>        Set Location to 117 365
49614>>>>>
49614>>>>>        //AB-StoreStart
49614>>>>>        Procedure OnClick
49616>>>>>            Send Search To (oSelList(current_object))
49617>>>>>        End_Procedure
49618>>>>>        //AB-StoreEnd
49618>>>>>
49618>>>>>    End_Object    // oSearch_bn
49619>>>>>
49619>>>>>
49619>>>>>    //AB-StoreStart
49619>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49620>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49621>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49622>>>>>    //AB-StoreEnd
49622>>>>>
49622>>>>>End_Object    // sl108
49623>>>>>
49623>>>>>//AB/ End_Object    // prj
49623>>>use sl182.sl
INCLUDING FILE: SL182.SL
49623>>>>>//AB/ Project sl182:diakiniseis eidon
49623>>>>>//AB/ Object prj is a Lookup_Project
49623>>>>>//AB/     Set ProjectName to "sl182:diakiniseis eidon"
49623>>>>>//AB/     Set ProjectFileName to "sl182.SL"
49623>>>>>//AB/     Set GenerateFileName to "NONAME"
49623>>>>>
49623>>>>>// Project Object Structure
49623>>>>>//   sl182 is a dbModalPanelSub
49623>>>>>//     Witemxtr_DD is a DataDictionary
49623>>>>>//     Witemxtd_DD is a DataDictionary
49623>>>>>//     oSelList is a dbListSub
49623>>>>>//     oOK_bn is a ButtonSub
49623>>>>>//     oCancel_bn is a ButtonSub
49623>>>>>//     oSearch_bn is a ButtonSub
49623>>>>>
49623>>>>>// Register all objects
49623>>>>>Register_Object oCancel_bn
49623>>>>>Register_Object oOK_bn
49623>>>>>Register_Object oSearch_bn
49623>>>>>Register_Object oSelList
49623>>>>>Register_Object sl182
49623>>>>>Register_Object Witemxtd_DD
49623>>>>>Register_Object Witemxtr_DD
49623>>>>>
49623>>>>>
49623>>>>>
49623>>>>>//AB-StoreTopStart
49623>>>>>open wax
49625>>>>>//AB-StoreTopEnd
49625>>>>>
49625>>>>>//AB-IgnoreStart
49625>>>>>
49625>>>>>Use DFAllEnt.pkg
49625>>>>>Use dbList.Sub
49625>>>>>Use Button.Sub
49625>>>>>
49625>>>>>
49625>>>>>Use WITEMXTR.DD
INCLUDING FILE: WITEMXTR.DD
49625>>>>>>>//DDB-FileStart
49625>>>>>>>//DDB-HeaderStart
49625>>>>>>>
49625>>>>>>>// File Name : WITEMXTR.DD
49625>>>>>>>// Class Name: Witemxtr_DataDictionary
49625>>>>>>>// Revision  : 38
49625>>>>>>>// Version   : 2
49625>>>>>>>
49625>>>>>>>Use  Windows           // Basic Definitions
49625>>>>>>>Use  DataDict          // DataDictionary Class Definition
49625>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49625>>>>>>>
49625>>>>>>>Open Witemxtr
INCLUDING FILE: WITEMXTR.FD
49627>>>>>>>Open Witemxtd
INCLUDING FILE: WITEMXTD.FD
49629>>>>>>>Open Sysrecw
49631>>>>>>>Open Branch
49633>>>>>>>Open Year
49635>>>>>>>
49635>>>>>>>//DDB-HeaderEnd
49635>>>>>>>//DDB-SelectionStart
49635>>>>>>>//DDB/ ExternalSelectionList sl182  sl182.SL
49635>>>>>>>//DDB/ ExternalSelectionList sl029a  sl029a.sl
49635>>>>>>>Register_Object sl182
49635>>>>>>>Register_Object sl029a
49635>>>>>>>//DDB-SelectionEnd
49635>>>>>>>
49635>>>>>>>Class Witemxtr_DataDictionary  is a DataDictionary_sec
49636>>>>>>>
49636>>>>>>>    // Define_Fields:
49636>>>>>>>    // This procedure is used to set up all data-dictionary rules. 
49636>>>>>>>    
49636>>>>>>>    Procedure Construct_Object
49637>>>>>>>        Forward Send Construct_Object
49639>>>>>>>        Property Integer piMustNOTConstrain Public 0
49640>>>>>>>    End_Procedure //construct_object
49641>>>>>>>
49641>>>>>>>    Procedure OnConstrain
49642>>>>>>>        Forward Send OnConstrain
49644>>>>>>>        Constrain Witemxtr.Company_Code  eq SysCurXR.Company_Code
49646>>>>>>>        Constrain Witemxtr.Branch_Code   eq SysCurXR.Branch_Code
49648>>>>>>>        Constrain Witemxtr.Year_Year     eq SysCurXR.Year_Year
49650>>>>>>>    End_Procedure
49651>>>>>>>
49651>>>>>>>    // Update:
49651>>>>>>>    Procedure Update
49652>>>>>>>        Forward Send Update
49654>>>>>>>        // Insert Code Here
49654>>>>>>>        Move SysCurXR.Company_Code  to Witemxtr.Company_Code
49655>>>>>>>        Move SysCurXR.Branch_Code   to Witemxtr.Branch_Code
49656>>>>>>>        Move SysCurXR.Year_Year     to Witemxtr.Year_Year
49657>>>>>>>    End_Procedure   // Update
49658>>>>>>>
49658>>>>>>>    Procedure Creating
49659>>>>>>>        Forward Send Creating 
49661>>>>>>>        integer idecs iYearRecnum iBranchRecnum
49662>>>>>>>        string srecr sentolh sAxia
49662>>>>>>>        if ((witemxtr.hmnia < syscurxr.year_xrhshfrom) or (witemxtr.hmnia > syscurxr.year_xrhshto));            error 3009 '†£œ¨¦£ž¤å˜ œ¡«æª ¦¨åà¤ ®¨ã©žª' 
49665>>>>>>>        
49665>>>>>>>        Move Year.Recnum    to iYearRecnum
49666>>>>>>>        Move Branch.Recnum  to iBranchRecnum
49667>>>>>>>        
49667>>>>>>>        Clear Year
49668>>>>>>>        move syscurxr.company_code  to Year.company_code
49669>>>>>>>        move syscurxr.branch_code   to Year.branch_code
49670>>>>>>>        move syscurxr.Year_Year     to Year.Year_Year
49671>>>>>>>        Find Eq Year By Index.1
49672>>>>>>>>
49672>>>>>>>        If (Not(Found)) Error 3001 'Witemxtr Creating - Year not found'
49675>>>>>>>        Move (Year.Year_NumBtypkin + 1) to Witemxtr.Axia
49676>>>>>>>        move (Year.Year_NumBtypkin + 1) to Year.Year_NumBtypkin
49677>>>>>>>        saverecord Year  
49678>>>>>>>        
49678>>>>>>>        clear branch
49679>>>>>>>        move syscurxr.company_code to branch.company_code
49680>>>>>>>        move syscurxr.branch_code  to branch.branch_code
49681>>>>>>>        find eq branch by index.1 
49682>>>>>>>>
49682>>>>>>>        If (Not(Found)) Error 3002 'Witemxtr Creating - Branch not found'
49685>>>>>>>        move (branch.entolh + 1) to branch.entolh
49686>>>>>>>        saverecord branch  
49687>>>>>>>        move branch.entolh to sentolh
49688>>>>>>>        move 5 to idecs
49689>>>>>>>        get fsgCode_n_Zeroes sentolh idecs to srecr
49690>>>>>>>        Get fsgCode_n_Zeroes (Integer(Witemxtr.Axia)) idecs to sAxia
49691>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(srecr)))))) to Witemxtr.Recr
49692>>>>>>>        Move (append('','„¤›¦› ˜¡.œ ›é¤ €¨.§˜¨˜©«. ' +(Trim(SysCurXR.Branch_Site)+Trim(sAxia)))) to witemxtr.descr 
49693>>>>>>>        move saxia to witemxtr.code
49694>>>>>>>        
49694>>>>>>>        If (iYearRecnum) Begin
49696>>>>>>>            Clear Year
49697>>>>>>>            Move iYearRecnum to Year.Recnum
49698>>>>>>>            Find Eq Year.Recnum
49699>>>>>>>>
49699>>>>>>>        End
49699>>>>>>>>
49699>>>>>>>        
49699>>>>>>>        If (iBranchRecnum) Begin
49701>>>>>>>            Clear Branch
49702>>>>>>>            Move iBranchRecnum to Branch.Recnum
49703>>>>>>>            Find Eq Branch.Recnum
49704>>>>>>>>
49704>>>>>>>        End
49704>>>>>>>>
49704>>>>>>>        
49704>>>>>>>    End_Procedure   // Creating    
49705>>>>>>>     
49705>>>>>>>    Procedure Shmera integer iField  Date dDate
49706>>>>>>>        Local Integer Changed
49707>>>>>>>        Get Field_Changed_State iField to Changed
49708>>>>>>>        If (Changed=0 AND dDate =0) Begin
49710>>>>>>>            SysDate4 dDate
49711>>>>>>>            Set Field_Default_Value iField to dDate
49712>>>>>>>        End
49712>>>>>>>>
49712>>>>>>>    End_Procedure   // Shmera
49713>>>>>>>
49713>>>>>>>    // Define_Fields:
49713>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49713>>>>>>>
49713>>>>>>>    Procedure Define_Fields
49714>>>>>>>        Forward Send Define_Fields
49716>>>>>>>        //DDB-Generated-Code-Location
49716>>>>>>>        //DDB-DefineFieldStart
49716>>>>>>>
49716>>>>>>>        Set Main_File            To Witemxtr.File_Number
49717>>>>>>>        Set Cascade_Delete_State To FALSE
49718>>>>>>>
49718>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49719>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49720>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49721>>>>>>>
49721>>>>>>>        // Child (Client) file structure................
49721>>>>>>>        Send Add_Client_File  Witemxtd.File_Number
49722>>>>>>>
49722>>>>>>>        // External (System) file structure.............
49722>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
49723>>>>>>>        Send Add_System_File  Branch.File_Number  DD_LOCK_ON_ALL
49724>>>>>>>        Send Add_System_File  Year.File_Number  DD_LOCK_ON_ALL
49725>>>>>>>
49725>>>>>>>        Define_Auto_Increment  Sysrecw.Witemxtr_Rec0  To Witemxtr.Rec0
49728>>>>>>>
49728>>>>>>>        // Field-based properties.......................
49728>>>>>>>
49728>>>>>>>        // Witemxtr.Company_Code
49728>>>>>>>
49728>>>>>>>        // Witemxtr.Branch_Code
49728>>>>>>>
49728>>>>>>>        // Witemxtr.Year_Year
49728>>>>>>>
49728>>>>>>>        // Witemxtr.Code
49728>>>>>>>
49728>>>>>>>        // Witemxtr.Recr
49728>>>>>>>
49728>>>>>>>        // Witemxtr.Rec0
49728>>>>>>>
49728>>>>>>>        // Witemxtr.Hmnia
49728>>>>>>>        Set Field_Entry_msg        Field Witemxtr.Hmnia To Shmera
49729>>>>>>>        Set Field_Mask_Type        Field Witemxtr.Hmnia To MASK_DATE_WINDOW
49730>>>>>>>        Set Field_Prompt_Object    Field Witemxtr.Hmnia To (sl182(Self))
49731>>>>>>>
49731>>>>>>>        // Witemxtr.Descr
49731>>>>>>>
49731>>>>>>>        // Witemxtr.Wax_From
49731>>>>>>>
49731>>>>>>>        // Witemxtr.Wax_To
49731>>>>>>>
49731>>>>>>>        // Witemxtr.Ekleise
49731>>>>>>>
49731>>>>>>>        // Witemxtr.Qty
49731>>>>>>>
49731>>>>>>>        // Witemxtr.Fpa
49731>>>>>>>
49731>>>>>>>        // Witemxtr.Axia
49731>>>>>>>
49731>>>>>>>        // Witemxtr.Total
49731>>>>>>>
49731>>>>>>>        // Witemxtr.Wtypkin_From
49731>>>>>>>        Set Field_Prompt_Object    Field Witemxtr.Wtypkin_From To (sl029a(Self))
49732>>>>>>>
49732>>>>>>>        // Witemxtr.Wtypkin_To
49732>>>>>>>        Set Field_Prompt_Object    Field Witemxtr.Wtypkin_To To (sl029a(Self))
49733>>>>>>>
49733>>>>>>>        // Witemxtr.From_No
49733>>>>>>>
49733>>>>>>>        // Witemxtr.To_No
49733>>>>>>>
49733>>>>>>>        // Witemxtr.Particle_Recr
49733>>>>>>>
49733>>>>>>>        // Witemxtr.Sap_Hmnia
49733>>>>>>>
49733>>>>>>>        //DDB-DefineFieldEnd
49733>>>>>>>    End_Procedure    // Define_Fields
49734>>>>>>>
49734>>>>>>>    // Field_Defaults:
49734>>>>>>>    // This procedure is used to establish default field values.
49734>>>>>>>
49734>>>>>>>    Procedure Field_Defaults
49735>>>>>>>        Forward Send Field_Defaults
49737>>>>>>>        //DDB-Generated-Code-Location
49737>>>>>>>        //DDB-FieldDefaultStart
49737>>>>>>>        Set Field_Changed_Value   Field Witemxtr.From_No To "1"
49738>>>>>>>        //DDB-FieldDefaultEnd
49738>>>>>>>    End_Procedure    // Field_Defaults
49739>>>>>>>
49739>>>>>>>End_Class    // Witemxtr_DataDictionary
49740>>>>>>>//DDB-Selection-pkg-Start
49740>>>>>>>
49740>>>>>>>Use sl182.SL         // sl182
49740>>>>>>>Use sl029a.sl        // sl029a
49740>>>>>>>
49740>>>>>>>//DDB-Selection-pkg-End
49740>>>>>>>//DDB-FileEnd
49740>>>>>Use WITEMXTD.DD
INCLUDING FILE: WITEMXTD.DD
49740>>>>>>>//DDB-FileStart
49740>>>>>>>//DDB-HeaderStart
49740>>>>>>>
49740>>>>>>>// File Name : WITEMXTD.DD
49740>>>>>>>// Class Name: Witemxtd_DataDictionary
49740>>>>>>>// Revision  : 15
49740>>>>>>>// Version   : 2
49740>>>>>>>
49740>>>>>>>Use  Windows           // Basic Definitions
49740>>>>>>>Use  DataDict          // DataDictionary Class Definition
49740>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49740>>>>>>>
49740>>>>>>>Open Witemxtd
49742>>>>>>>Open Witemxtr
49744>>>>>>>Open Sysrecw
49746>>>>>>>
49746>>>>>>>//DDB-HeaderEnd
49746>>>>>>>//DDB-SelectionStart
49746>>>>>>>//DDB/ ExternalSelectionList SL17  sl17.SL
49746>>>>>>>//DDB/ ExternalSelectionList Wax  wax.sl
49746>>>>>>>Register_Object SL17
49746>>>>>>>Register_Object Wax
49746>>>>>>>//DDB-SelectionEnd
49746>>>>>>>
49746>>>>>>>Class Witemxtd_DataDictionary  is a DataDictionary_sec
49747>>>>>>>
49747>>>>>>>    // Define_Fields:
49747>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49747>>>>>>>   procedure creating 
49748>>>>>>>        Forward Send Creating
49750>>>>>>>        // Insert Code Here
49750>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Witemxtd.Rec0)))))) to Witemxtd.Recr
49751>>>>>>>    End_Procedure   // Creating
49752>>>>>>>    
49752>>>>>>>     Procedure Backout
49753>>>>>>>        Forward Send Backout
49755>>>>>>>
49755>>>>>>>        // Insert Code Here
49755>>>>>>>        sub witemxtd.qty_from       from witemxtr.qty
49756>>>>>>>        
49756>>>>>>>    End_Procedure   // Backout
49757>>>>>>>
49757>>>>>>>
49757>>>>>>>
49757>>>>>>>    Procedure Update
49758>>>>>>>        Forward Send Update
49760>>>>>>>        Add witemxtd.qty_from     to witemxtr.qty
49761>>>>>>>    End_Procedure   // Update
49762>>>>>>>    
49762>>>>>>>    
49762>>>>>>>    
49762>>>>>>>    Procedure Define_Fields
49763>>>>>>>        Forward Send Define_Fields
49765>>>>>>>        //DDB-Generated-Code-Location
49765>>>>>>>        //DDB-DefineFieldStart
49765>>>>>>>
49765>>>>>>>        Set Main_File            To Witemxtd.File_Number
49766>>>>>>>
49766>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49767>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49768>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49769>>>>>>>
49769>>>>>>>        // Parent (Server) file structure...............
49769>>>>>>>        Send Add_Server_File  Witemxtr.File_Number
49770>>>>>>>
49770>>>>>>>        // External (System) file structure.............
49770>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
49771>>>>>>>
49771>>>>>>>        Define_Auto_Increment  Sysrecw.Witemxtd_Rec0  To Witemxtd.Rec0
49774>>>>>>>
49774>>>>>>>        // Field-based properties.......................
49774>>>>>>>
49774>>>>>>>        // Witemxtd.Witemxtr_Recr
49774>>>>>>>
49774>>>>>>>        // Witemxtd.Recr
49774>>>>>>>
49774>>>>>>>        // Witemxtd.Rec0
49774>>>>>>>
49774>>>>>>>        // Witemxtd.Witemx_Code
49774>>>>>>>        Set Field_Prompt_Object    Field Witemxtd.Witemx_Code To (SL17(Self))
49775>>>>>>>
49775>>>>>>>        // Witemxtd.Qty_From
49775>>>>>>>
49775>>>>>>>        // Witemxtd.Unitprice_From
49775>>>>>>>
49775>>>>>>>        // Witemxtd.Fpa_From
49775>>>>>>>
49775>>>>>>>        // Witemxtd.Pcfpa_From
49775>>>>>>>
49775>>>>>>>        // Witemxtd.Axia_From
49775>>>>>>>
49775>>>>>>>        // Witemxtd.Total_From
49775>>>>>>>
49775>>>>>>>        // Witemxtd.Wcmoves_Recr
49775>>>>>>>
49775>>>>>>>        // Witemxtd.Wax_From
49775>>>>>>>        Set Field_Prompt_Object    Field Witemxtd.Wax_From To (Wax(Self))
49776>>>>>>>
49776>>>>>>>        // Witemxtd.Wax_To
49776>>>>>>>        Set Field_Prompt_Object    Field Witemxtd.Wax_To To (Wax(Self))
49777>>>>>>>
49777>>>>>>>        // Witemxtd.Texnikh
49777>>>>>>>
49777>>>>>>>        //DDB-DefineFieldEnd
49777>>>>>>>    End_Procedure    // Define_Fields
49778>>>>>>>
49778>>>>>>>    // Field_Defaults:
49778>>>>>>>    // This procedure is used to establish default field values.
49778>>>>>>>
49778>>>>>>>    Procedure Field_Defaults
49779>>>>>>>        Forward Send Field_Defaults
49781>>>>>>>        //DDB-Generated-Code-Location
49781>>>>>>>        //DDB-FieldDefaultStart
49781>>>>>>>        //DDB-FieldDefaultEnd
49781>>>>>>>    End_Procedure    // Field_Defaults
49782>>>>>>>
49782>>>>>>>End_Class    // Witemxtd_DataDictionary
49783>>>>>>>//DDB-Selection-pkg-Start
49783>>>>>>>
49783>>>>>>>Use sl17.SL          // SL17
INCLUDING FILE: SL17.SL
49783>>>>>>>>>//AB/ Project SL17:witemx
49783>>>>>>>>>//AB/     Object prj is a Lookup_Project
49783>>>>>>>>>//AB/         Set ProjectName to "SL17:witemx"
49783>>>>>>>>>//AB/         Set ProjectFileName to "sl17.SL"
49783>>>>>>>>>
49783>>>>>>>>>// Project Object Structure
49783>>>>>>>>>//   SL17 is a dbModalPanelSub
49783>>>>>>>>>//     Units_DD is a DataDictionary
49783>>>>>>>>>//     Witemkat_DD is a DataDictionary
49783>>>>>>>>>//     Fpa_DD is a DataDictionary
49783>>>>>>>>>//     Item_DD is a DataDictionary
49783>>>>>>>>>//     Witemx_DD is a DataDictionary
49783>>>>>>>>>//     oSelList is a dbListSub
49783>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
49783>>>>>>>>>//     ocode is a FormSub
49783>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
49783>>>>>>>>>//     operi is a FormSub
49783>>>>>>>>>//     RadioGroupSub1 is a RadioGroupSub
49783>>>>>>>>>//       Radio1 is a RadioSub
49783>>>>>>>>>//       Radio2 is a RadioSub
49783>>>>>>>>>//     ButtonSub1 is a ButtonSub
49783>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
49783>>>>>>>>>//     ocodekat is a FormSub
49783>>>>>>>>>//     oOK_bn is a ButtonSub
49783>>>>>>>>>//     oCancel_bn is a ButtonSub
49783>>>>>>>>>//     oSearch_bn is a ButtonSub
49783>>>>>>>>>//     btnwitemcl is a ButtonSub
49783>>>>>>>>>
49783>>>>>>>>>// Register all objects
49783>>>>>>>>>Register_Object ButtonSub1
49783>>>>>>>>>Register_Object btnwitemcl
49783>>>>>>>>>Register_Object Fpa_DD
49783>>>>>>>>>Register_Object Item_DD
49783>>>>>>>>>Register_Object oCancel_bn
49783>>>>>>>>>Register_Object ocode
49783>>>>>>>>>Register_Object ocodekat
49783>>>>>>>>>Register_Object oOK_bn
49783>>>>>>>>>Register_Object operi
49783>>>>>>>>>Register_Object oSearch_bn
49783>>>>>>>>>Register_Object oSelList
49783>>>>>>>>>Register_Object Radio1
49783>>>>>>>>>Register_Object Radio2
49783>>>>>>>>>Register_Object RadioGroupSub1
49783>>>>>>>>>Register_Object SL17
49783>>>>>>>>>Register_Object TextBoxSub1
49783>>>>>>>>>Register_Object TextBoxSub2
49783>>>>>>>>>Register_Object TextBoxSub3
49783>>>>>>>>>Register_Object Units_DD
49783>>>>>>>>>Register_Object Witemkat_DD
49783>>>>>>>>>Register_Object Witemx_DD
49783>>>>>>>>>
49783>>>>>>>>>
49783>>>>>>>>>
49783>>>>>>>>>    //AB-StoreTopStart
49783>>>>>>>>>    use dg186.dg
INCLUDING FILE: DG186.DG
49783>>>>>>>>>>>//AB/ Project dg186
49783>>>>>>>>>>>//AB/     Object prj is a Dialog_Project
49783>>>>>>>>>>>//AB/         Set ProjectName to "dg186"
49783>>>>>>>>>>>//AB/         Set ProjectFileName to "dg186.DG"
49783>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
49783>>>>>>>>>>>
49783>>>>>>>>>>>// Project Object Structure
49783>>>>>>>>>>>//   dg186 is a dbModalPanelSub
49783>>>>>>>>>>>//     Witemkat_DD is a DataDictionary
49783>>>>>>>>>>>//     Units_DD is a DataDictionary
49783>>>>>>>>>>>//     Fpa_DD is a DataDictionary
49783>>>>>>>>>>>//     Item_DD is a DataDictionary
49783>>>>>>>>>>>//     Witemcl_DD is a DataDictionary
49783>>>>>>>>>>>//     The_Table is a dbGrid
49783>>>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
49783>>>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
49783>>>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
49783>>>>>>>>>>>//     ocode is a FormSub
49783>>>>>>>>>>>//     operi is a FormSub
49783>>>>>>>>>>>//     ocodeprom is a FormSub
49783>>>>>>>>>>>//     RadioGroupSub1 is a RadioGroupSub
49783>>>>>>>>>>>//       Radio1 is a RadioSub
49783>>>>>>>>>>>//       Radio2 is a RadioSub
49783>>>>>>>>>>>//     ButtonSub1 is a ButtonSub
49783>>>>>>>>>>>//     btnwitemcl is a ButtonSub
49783>>>>>>>>>>>
49783>>>>>>>>>>>// Register all objects
49783>>>>>>>>>>>Register_Object ButtonSub1
49783>>>>>>>>>>>Register_Object btnwitemcl
49783>>>>>>>>>>>Register_Object dg186
49783>>>>>>>>>>>Register_Object Fpa_DD
49783>>>>>>>>>>>Register_Object Item_DD
49783>>>>>>>>>>>Register_Object ocode
49783>>>>>>>>>>>Register_Object ocodeprom
49783>>>>>>>>>>>Register_Object operi
49783>>>>>>>>>>>Register_Object Radio1
49783>>>>>>>>>>>Register_Object Radio2
49783>>>>>>>>>>>Register_Object RadioGroupSub1
49783>>>>>>>>>>>Register_Object TextBoxSub1
49783>>>>>>>>>>>Register_Object TextBoxSub2
49783>>>>>>>>>>>Register_Object TextBoxSub3
49783>>>>>>>>>>>Register_Object The_Table
49783>>>>>>>>>>>Register_Object Units_DD
49783>>>>>>>>>>>Register_Object Witemcl_DD
49783>>>>>>>>>>>Register_Object Witemkat_DD
49783>>>>>>>>>>>
49783>>>>>>>>>>>
49783>>>>>>>>>>>
49783>>>>>>>>>>>    //AB-StoreTopStart
49783>>>>>>>>>>>    open clients
49785>>>>>>>>>>>    use sl17.sl
49785>>>>>>>>>>>    //AB-StoreTopEnd
49785>>>>>>>>>>>
49785>>>>>>>>>>>    //AB-IgnoreStart
49785>>>>>>>>>>>
49785>>>>>>>>>>>    Use DFAllEnt.pkg
49785>>>>>>>>>>>    Use Txtbox.Sub
49785>>>>>>>>>>>    Use Form.Sub
49785>>>>>>>>>>>    Use Rgroup.Sub
49785>>>>>>>>>>>    Use Radio.Sub
49785>>>>>>>>>>>    Use Button.Sub
49785>>>>>>>>>>>
49785>>>>>>>>>>>
49785>>>>>>>>>>>    Use WITEMKAT.DD
49785>>>>>>>>>>>    Use UNITS.DD
49785>>>>>>>>>>>    Use FPA.DD
49785>>>>>>>>>>>    Use ITEM.DD
49785>>>>>>>>>>>    Use WITEMCL.DD
INCLUDING FILE: WITEMCL.DD
49785>>>>>>>>>>>>>//DDB-FileStart
49785>>>>>>>>>>>>>//DDB-HeaderStart
49785>>>>>>>>>>>>>
49785>>>>>>>>>>>>>// File Name : WITEMCL.DD
49785>>>>>>>>>>>>>// Class Name: Witemcl_DataDictionary
49785>>>>>>>>>>>>>// Revision  : 16
49785>>>>>>>>>>>>>// Version   : 2
49785>>>>>>>>>>>>>
49785>>>>>>>>>>>>>Use  Windows           // Basic Definitions
49785>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
49785>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49785>>>>>>>>>>>>>
49785>>>>>>>>>>>>>Open Witemcl
49787>>>>>>>>>>>>>Open Witemcld
49789>>>>>>>>>>>>>Open Item
49791>>>>>>>>>>>>>Open Sysrecw
49793>>>>>>>>>>>>>
49793>>>>>>>>>>>>>//DDB-HeaderEnd
49793>>>>>>>>>>>>>//DDB-SelectionStart
49793>>>>>>>>>>>>>//DDB/ ExternalSelectionList SL100  sl100.sl
49793>>>>>>>>>>>>>Register_Object SL100
49793>>>>>>>>>>>>>//DDB-SelectionEnd
49793>>>>>>>>>>>>>
49793>>>>>>>>>>>>>Class Witemcl_DataDictionary  is a DataDictionary_Sec
49794>>>>>>>>>>>>> 
49794>>>>>>>>>>>>>    // Update:
49794>>>>>>>>>>>>> 
49794>>>>>>>>>>>>>    Procedure Update
49795>>>>>>>>>>>>>        Forward Send Update  
49797>>>>>>>>>>>>>        move item.item_descr to witemcl.item_descr
49798>>>>>>>>>>>>>    End_Procedure   // Update
49799>>>>>>>>>>>>> 
49799>>>>>>>>>>>>>
49799>>>>>>>>>>>>>    // Define_Fields:
49799>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49799>>>>>>>>>>>>>
49799>>>>>>>>>>>>>    Procedure Define_Fields
49800>>>>>>>>>>>>>        Forward Send Define_Fields
49802>>>>>>>>>>>>>        //DDB-Generated-Code-Location
49802>>>>>>>>>>>>>        //DDB-DefineFieldStart
49802>>>>>>>>>>>>>
49802>>>>>>>>>>>>>        Set Main_File            To Witemcl.File_Number
49803>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
49804>>>>>>>>>>>>>
49804>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49805>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49806>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49807>>>>>>>>>>>>>
49807>>>>>>>>>>>>>        // Child (Client) file structure................
49807>>>>>>>>>>>>>        Send Add_Client_File  Witemcld.File_Number
49808>>>>>>>>>>>>>
49808>>>>>>>>>>>>>        // Parent (Server) file structure...............
49808>>>>>>>>>>>>>        Send Add_Server_File  Item.File_Number
49809>>>>>>>>>>>>>
49809>>>>>>>>>>>>>        // External (System) file structure.............
49809>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
49810>>>>>>>>>>>>>
49810>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Witemcl_Rec0  To Witemcl.Rec0
49813>>>>>>>>>>>>>
49813>>>>>>>>>>>>>        // Field-based properties.......................
49813>>>>>>>>>>>>>
49813>>>>>>>>>>>>>        // Witemcl.Item_Code
49813>>>>>>>>>>>>>
49813>>>>>>>>>>>>>        // Witemcl.Client_Code
49813>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemcl.Client_Code To (SL100(Self))
49814>>>>>>>>>>>>>
49814>>>>>>>>>>>>>        // Witemcl.Client_Itemcode
49814>>>>>>>>>>>>>
49814>>>>>>>>>>>>>        // Witemcl.Client_Date
49814>>>>>>>>>>>>>        Set Field_Mask_Type        Field Witemcl.Client_Date To MASK_DATE_WINDOW
49815>>>>>>>>>>>>>
49815>>>>>>>>>>>>>        // Witemcl.Client_Price
49815>>>>>>>>>>>>>        Set Field_Mask_Type        Field Witemcl.Client_Price To MASK_NUMERIC_WINDOW
49816>>>>>>>>>>>>>
49816>>>>>>>>>>>>>        // Witemcl.Item_Descr
49816>>>>>>>>>>>>>
49816>>>>>>>>>>>>>        // Witemcl.Rec0
49816>>>>>>>>>>>>>
49816>>>>>>>>>>>>>        // Witemcl.Is_Client
49816>>>>>>>>>>>>>
49816>>>>>>>>>>>>>        //DDB-DefineFieldEnd
49816>>>>>>>>>>>>>    End_Procedure    // Define_Fields
49817>>>>>>>>>>>>>
49817>>>>>>>>>>>>>    // Field_Defaults:
49817>>>>>>>>>>>>>    // This procedure is used to establish default field values.
49817>>>>>>>>>>>>>
49817>>>>>>>>>>>>>    Procedure Field_Defaults
49818>>>>>>>>>>>>>        Forward Send Field_Defaults
49820>>>>>>>>>>>>>        //DDB-Generated-Code-Location
49820>>>>>>>>>>>>>        //DDB-FieldDefaultStart
49820>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
49820>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
49821>>>>>>>>>>>>>
49821>>>>>>>>>>>>>End_Class    // Witemcl_DataDictionary
49822>>>>>>>>>>>>>//DDB-Selection-pkg-Start
49822>>>>>>>>>>>>>
49822>>>>>>>>>>>>>Use sl100.sl         // SL100
49822>>>>>>>>>>>>>
49822>>>>>>>>>>>>>//DDB-Selection-pkg-End
49822>>>>>>>>>>>>>//DDB-FileEnd
49822>>>>>>>>>>>    
49822>>>>>>>>>>>    //AB-IgnoreEnd
49822>>>>>>>>>>>
49822>>>>>>>>>>>    Object dg186 is a dbModalPanelSub
49824>>>>>>>>>>>
49824>>>>>>>>>>>        //AB-StoreTopStart
49824>>>>>>>>>>>        Function fsclient string code Returns string
49826>>>>>>>>>>>            string name
49827>>>>>>>>>>>            clear clients
49828>>>>>>>>>>>            move code to clients.client_id
49829>>>>>>>>>>>            find eq clients by index.6
49830>>>>>>>>>>>>
49830>>>>>>>>>>>            move clients.client_name to name
49831>>>>>>>>>>>            function_return name
49832>>>>>>>>>>>        end_Function
49833>>>>>>>>>>>        
49833>>>>>>>>>>>        Property String     pscode                  ''
49835>>>>>>>>>>>        Property String     psperi                  ''
49837>>>>>>>>>>>        Property Integer    piContains_Or_Starts     0
49839>>>>>>>>>>>        Property String     pscodeprom              ''
49841>>>>>>>>>>>        
49841>>>>>>>>>>>        
49841>>>>>>>>>>>        //AB-StoreTopEnd
49841>>>>>>>>>>>
49841>>>>>>>>>>>        Set Label to "‘¬©®œ«å©œ ª „ ›é¤ €§¦Ÿã¡žª"
49842>>>>>>>>>>>        Set Size to 289 527
49843>>>>>>>>>>>        Set Location to 0 2
49844>>>>>>>>>>>
49844>>>>>>>>>>>        //AB-DDOStart
49844>>>>>>>>>>>
49844>>>>>>>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
49846>>>>>>>>>>>        End_Object    // Witemkat_DD
49847>>>>>>>>>>>
49847>>>>>>>>>>>        Object Units_DD is a Units_DataDictionary
49849>>>>>>>>>>>        End_Object    // Units_DD
49850>>>>>>>>>>>
49850>>>>>>>>>>>        Object Fpa_DD is a Fpa_DataDictionary
49852>>>>>>>>>>>        End_Object    // Fpa_DD
49853>>>>>>>>>>>
49853>>>>>>>>>>>        Object Item_DD is a Item_DataDictionary
49855>>>>>>>>>>>            Set DDO_Server to (Units_DD(self))
49856>>>>>>>>>>>            Set DDO_Server to (Witemkat_DD(self))
49857>>>>>>>>>>>            Set DDO_Server to (Fpa_DD(self))
49858>>>>>>>>>>>        End_Object    // Item_DD
49859>>>>>>>>>>>
49859>>>>>>>>>>>        Object Witemcl_DD is a Witemcl_DataDictionary
49861>>>>>>>>>>>
49861>>>>>>>>>>>            //AB-StoreTopStart
49861>>>>>>>>>>>            Function fiPeriexei Returns Integer
49863>>>>>>>>>>>                       String lsperi lscode  lscodeprom
49864>>>>>>>>>>>                       Integer rVal liContains_Or_Starts
49864>>>>>>>>>>>                       Move 0 to rVal
49865>>>>>>>>>>>                       Get piContains_Or_Starts to liContains_Or_Starts
49866>>>>>>>>>>>                       Get psperi to lsperi
49867>>>>>>>>>>>                       Get pscode to lscode
49868>>>>>>>>>>>                       Get pscodeprom to lscodeprom
49869>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
49870>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
49871>>>>>>>>>>>                  //     Move (Trim(lscodekat)) to lscodekat
49871>>>>>>>>>>>                       If (liContains_Or_Starts=0) Begin
49873>>>>>>>>>>>                           If ((Trim(witemcl.item_descr)) Contains lsperi) Begin
49875>>>>>>>>>>>                               If ((Trim(witemcl.item_code)) Contains lscode) Move 1 to rVal
49878>>>>>>>>>>>                           End
49878>>>>>>>>>>>>
49878>>>>>>>>>>>            
49878>>>>>>>>>>>                       End
49878>>>>>>>>>>>>
49878>>>>>>>>>>>                       Else Begin
49879>>>>>>>>>>>                           If (Left(witemcl.item_descr,(Length(lsperi)))=lsperi) Begin
49881>>>>>>>>>>>                               If (Left(witemcl.item_code,(Length(lscode)))=lscode) Move 1 to rVal
49884>>>>>>>>>>>                           End
49884>>>>>>>>>>>>
49884>>>>>>>>>>>            
49884>>>>>>>>>>>                       End
49884>>>>>>>>>>>>
49884>>>>>>>>>>>                       Function_Return rVal
49885>>>>>>>>>>>                   End_Function
49886>>>>>>>>>>>            
49886>>>>>>>>>>>                   Function fiArxizeiperi Returns Integer
49888>>>>>>>>>>>                       String lsperi
49889>>>>>>>>>>>                       Get psperi to lsperi
49890>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
49891>>>>>>>>>>>                       Function_Return (Left(witemcl.item_descr,(Length(lsperi)))=lsperi)
49892>>>>>>>>>>>                   End_Function
49893>>>>>>>>>>>            
49893>>>>>>>>>>>                   Function fiArxizeicode Returns Integer
49895>>>>>>>>>>>                       String lscode lscodeprom
49896>>>>>>>>>>>                       Get pscode to lscode
49897>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
49898>>>>>>>>>>>                       Function_Return (Left(witemcl.item_code,(Length(lscode)))=lscode)
49899>>>>>>>>>>>                   End_Function
49900>>>>>>>>>>>            
49900>>>>>>>>>>>            //AB-StoreTopEnd
49900>>>>>>>>>>>
49900>>>>>>>>>>>            Set DDO_Server to (Item_DD(self))
49901>>>>>>>>>>>
49901>>>>>>>>>>>            //AB-StoreStart
49901>>>>>>>>>>>                                                                
49901>>>>>>>>>>>                                                                
49901>>>>>>>>>>>            Begin_Constraints
49903>>>>>>>>>>>               String lsperi lscode lsvalue lstype lscodeprom
49904>>>>>>>>>>>               Integer liContains_Or_Starts
49904>>>>>>>>>>>                   Get psperi  to lsperi
49905>>>>>>>>>>>                   Get pscode  to lscode
49906>>>>>>>>>>>                   Get pscodeprom  to lscodeprom
49907>>>>>>>>>>>                   Get piContains_Or_Starts to liContains_Or_Starts
49908>>>>>>>>>>>                   Move (Trim(lsperi)) to lsperi
49909>>>>>>>>>>>                   Move (Trim(lscode)) to lscode
49910>>>>>>>>>>>                   Move (Trim(lscodeprom)) to lscodeprom
49911>>>>>>>>>>>                   If ((lsperi<>'') and ;                      (lscode<>'')) Constrain witemcl as (fiPeriexei(Self)=1)
49914>>>>>>>>>>>                   Else Begin
49915>>>>>>>>>>>                      If (liContains_Or_Starts=0) Begin
49917>>>>>>>>>>>                      If (lsperi<>'') Constrain witemcl.item_descr Contains lsperi
49921>>>>>>>>>>>                      Else If (lscode<>'') Constrain witemcl.item_code Contains lscode
49926>>>>>>>>>>>                      End
49926>>>>>>>>>>>>
49926>>>>>>>>>>>                   Else Begin
49927>>>>>>>>>>>                       If (lsperi<>'') Constrain witemcl as (fiArxizeiperi(Self)=1) //witemcl.item_descr
49930>>>>>>>>>>>                       Else If (lscode<>'') Constrain witemcl as (fiArxizeicode(Self)=1) //witemcl.item_code
49934>>>>>>>>>>>                       End
49934>>>>>>>>>>>>
49934>>>>>>>>>>>                   End
49934>>>>>>>>>>>>
49934>>>>>>>>>>>                   If (lscodeprom<>'') Constrain witemcl.client_itemcode Contains lscodeprom
49938>>>>>>>>>>>            
49938>>>>>>>>>>>            End_Constraints
49941>>>>>>>>>>>            
49941>>>>>>>>>>>            
49941>>>>>>>>>>>            //AB-StoreEnd
49941>>>>>>>>>>>
49941>>>>>>>>>>>        End_Object    // Witemcl_DD
49942>>>>>>>>>>>
49942>>>>>>>>>>>        Set Main_DD to (Witemcl_DD(self))
49943>>>>>>>>>>>        Set Server to (Witemcl_DD(self))
49944>>>>>>>>>>>
49944>>>>>>>>>>>        //AB-DDOEnd
49944>>>>>>>>>>>
49944>>>>>>>>>>>        Object The_Table is a dbGrid
49946>>>>>>>>>>>            Set Main_File to Witemcl.File_Number
49947>>>>>>>>>>>            Set Size to 201 519
49948>>>>>>>>>>>            Set Location to 3 2
49949>>>>>>>>>>>            Set Color to 14280447
49950>>>>>>>>>>>            Set CurrentRowColor to 11783679
49951>>>>>>>>>>>            Set CurrentCellColor to 11783679
49952>>>>>>>>>>>            Set Wrap_State to TRUE
49953>>>>>>>>>>>
49953>>>>>>>>>>>            Begin_Row
49956>>>>>>>>>>>                Entry_Item Witemcl.Item_code
49957>>>>>>>>>>>                Entry_Item Witemcl.Client_itemcode
49958>>>>>>>>>>>                Entry_Item Witemcl.Item_descr
49959>>>>>>>>>>>                Entry_Item Witemcl.Client_code
49960>>>>>>>>>>>                Entry_Item (fsclient(self,witemcl.client_code))
49961>>>>>>>>>>>            End_Row
49966>>>>>>>>>>>
49966>>>>>>>>>>>            Set Form_Width    item 0 to 100
49967>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª „å›¦¬ª"
49968>>>>>>>>>>>            
49968>>>>>>>>>>>            Set Form_Width    item 1 to 100
49969>>>>>>>>>>>            Set Header_Label  item 1 to "„å›¦ª ¨¦£žŸœ¬«ã"
49970>>>>>>>>>>>            
49970>>>>>>>>>>>            Set Form_Width    item 2 to 200
49971>>>>>>>>>>>            Set Header_Label  item 2 to "œ¨ š¨˜­ã „å›¦¬ª"
49972>>>>>>>>>>>            
49972>>>>>>>>>>>            Set Form_Width    item 3 to 0
49973>>>>>>>>>>>            Set Header_Label  item 3 to ""
49974>>>>>>>>>>>            
49974>>>>>>>>>>>            Set Form_Width    item 4 to 111
49975>>>>>>>>>>>            Set Header_Label  item 4 to "¨¦£žŸœ¬«ãª"
49976>>>>>>>>>>>            
49976>>>>>>>>>>>
49976>>>>>>>>>>>            //AB-StoreStart
49976>>>>>>>>>>>            Set Column_Option Item 3 to NoEnter True
49977>>>>>>>>>>>            //set read_only_state to true
49977>>>>>>>>>>>            set no_create_state to true
49978>>>>>>>>>>>            set no_delete_state to true
49979>>>>>>>>>>>            //AB-StoreEnd
49979>>>>>>>>>>>
49979>>>>>>>>>>>        End_Object    // The_Table
49980>>>>>>>>>>>
49980>>>>>>>>>>>        Object TextBoxSub1 is a TextBoxSub
49982>>>>>>>>>>>            Set Label to "‘á¨à©ž ‰à› ¡¦ç ‚ á"
49983>>>>>>>>>>>            Set Auto_Size_State to FALSE
49984>>>>>>>>>>>            Set Location to 208 5
49985>>>>>>>>>>>            Set Size to 13 78
49986>>>>>>>>>>>        End_Object    // TextBoxSub1
49987>>>>>>>>>>>
49987>>>>>>>>>>>        Object TextBoxSub2 is a TextBoxSub
49989>>>>>>>>>>>            Set Label to "‘á¨à©ž œ¨ š¨˜­ãª "
49990>>>>>>>>>>>            Set Auto_Size_State to FALSE
49991>>>>>>>>>>>            Set Location to 223 5
49992>>>>>>>>>>>            Set Size to 13 83
49993>>>>>>>>>>>        End_Object    // TextBoxSub2
49994>>>>>>>>>>>
49994>>>>>>>>>>>        Object TextBoxSub3 is a TextBoxSub
49996>>>>>>>>>>>            Set Label to "„å›¦ª ¨¦£žŸœ¬«ã ‚ á"
49997>>>>>>>>>>>            Set Auto_Size_State to FALSE
49998>>>>>>>>>>>            Set Location to 237 5
49999>>>>>>>>>>>            Set Size to 13 78
50000>>>>>>>>>>>        End_Object    // TextBoxSub3
50001>>>>>>>>>>>
50001>>>>>>>>>>>        Object ocode is a FormSub
50003>>>>>>>>>>>            Set Size to 13 197
50004>>>>>>>>>>>            Set Location to 209 91
50005>>>>>>>>>>>            Set Label_Col_Offset to 2
50006>>>>>>>>>>>
50006>>>>>>>>>>>            //AB-StoreStart
50006>>>>>>>>>>>                                                                                                                                                                                                    
50006>>>>>>>>>>>            Procedure OnKILLFOCUS
50008>>>>>>>>>>>               Send KeyAction to ButtonSub1
50009>>>>>>>>>>>            End_Procedure
50010>>>>>>>>>>>            
50010>>>>>>>>>>>            
50010>>>>>>>>>>>            
50010>>>>>>>>>>>            
50010>>>>>>>>>>>            //AB-StoreEnd
50010>>>>>>>>>>>
50010>>>>>>>>>>>        End_Object    // ocode
50011>>>>>>>>>>>
50011>>>>>>>>>>>        Object operi is a FormSub
50013>>>>>>>>>>>            Set Size to 13 197
50014>>>>>>>>>>>            Set Location to 223 91
50015>>>>>>>>>>>            Set Label_Col_Offset to 2
50016>>>>>>>>>>>
50016>>>>>>>>>>>            //AB-StoreStart
50016>>>>>>>>>>>                                                                                                                                                                                                    
50016>>>>>>>>>>>            Procedure OnKILLFOCUS
50018>>>>>>>>>>>              Send KeyAction to ButtonSub1
50019>>>>>>>>>>>            End_Procedure
50020>>>>>>>>>>>            
50020>>>>>>>>>>>            
50020>>>>>>>>>>>            
50020>>>>>>>>>>>            
50020>>>>>>>>>>>            //AB-StoreEnd
50020>>>>>>>>>>>
50020>>>>>>>>>>>        End_Object    // operi
50021>>>>>>>>>>>
50021>>>>>>>>>>>        Object ocodeprom is a FormSub
50023>>>>>>>>>>>            Set Size to 13 197
50024>>>>>>>>>>>            Set Location to 238 91
50025>>>>>>>>>>>            Set Label_Col_Offset to 2
50026>>>>>>>>>>>
50026>>>>>>>>>>>            //AB-StoreStart
50026>>>>>>>>>>>                                                                                                                                                                                                    
50026>>>>>>>>>>>            Procedure OnKILLFOCUS
50028>>>>>>>>>>>                Send KeyAction to ButtonSub1
50029>>>>>>>>>>>            End_Procedure
50030>>>>>>>>>>>            
50030>>>>>>>>>>>            
50030>>>>>>>>>>>            
50030>>>>>>>>>>>            //AB-StoreEnd
50030>>>>>>>>>>>
50030>>>>>>>>>>>        End_Object    // ocodeprom
50031>>>>>>>>>>>
50031>>>>>>>>>>>        Object RadioGroupSub1 is a RadioGroupSub
50033>>>>>>>>>>>            Set Size to 32 77
50034>>>>>>>>>>>            Set Location to 209 296
50035>>>>>>>>>>>            Object Radio1 is a RadioSub
50037>>>>>>>>>>>                Set Label to "œ¨ â®œ«˜ "
50038>>>>>>>>>>>                Set Size to 10 53
50039>>>>>>>>>>>                Set Location to 7 5
50040>>>>>>>>>>>            End_Object    // Radio1
50041>>>>>>>>>>>
50041>>>>>>>>>>>            Object Radio2 is a RadioSub
50043>>>>>>>>>>>                Set Label to "€¨®åœ  €§æ"
50044>>>>>>>>>>>                Set Size to 10 51
50045>>>>>>>>>>>                Set Location to 21 5
50046>>>>>>>>>>>            End_Object    // Radio2
50047>>>>>>>>>>>
50047>>>>>>>>>>>
50047>>>>>>>>>>>            //AB-StoreStart
50047>>>>>>>>>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
50047>>>>>>>>>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
50049>>>>>>>>>>>                //iToItem=0 => Contains, =1 => Starts with
50049>>>>>>>>>>>                Set piContains_Or_Starts to iToItem
50050>>>>>>>>>>>                Send KeyAction to ButtonSub1
50051>>>>>>>>>>>            End_Procedure
50052>>>>>>>>>>>            
50052>>>>>>>>>>>            // If you set Current_radio you must set this after the
50052>>>>>>>>>>>            // radio objects have been created AND after Notify_select_State has been
50052>>>>>>>>>>>            // created. i.e. Set in bottom-code at end!!
50052>>>>>>>>>>>            //Set Current_Radio to 0
50052>>>>>>>>>>>            
50052>>>>>>>>>>>            
50052>>>>>>>>>>>            //AB-StoreEnd
50052>>>>>>>>>>>
50052>>>>>>>>>>>        End_Object    // RadioGroupSub1
50053>>>>>>>>>>>
50053>>>>>>>>>>>        Object ButtonSub1 is a ButtonSub
50055>>>>>>>>>>>            Set Label to "Search"
50056>>>>>>>>>>>            Set Size to 28 37
50057>>>>>>>>>>>            Set Location to 210 413
50058>>>>>>>>>>>            Set Form_FontWeight Item 0 to 800
50059>>>>>>>>>>>            Set Form_TypeFace Item 0 to "ms sans serif"
50060>>>>>>>>>>>
50060>>>>>>>>>>>            //AB-StoreStart
50060>>>>>>>>>>>                                        
50060>>>>>>>>>>>            Set Visible_State to False
50061>>>>>>>>>>>            
50061>>>>>>>>>>>            Procedure OnClick
50063>>>>>>>>>>>                Forward Send OnClick
50065>>>>>>>>>>>                Set pscode  to (Value(ocode(Self),0))
50066>>>>>>>>>>>                Set psperi  to (Value(operi(Self),0))
50067>>>>>>>>>>>                Set pscodeprom  to (Value(ocodeprom(Self),0))
50068>>>>>>>>>>>                send Rebuild_Constraints    to (witemcl_DD(Self))
50069>>>>>>>>>>>                Send Beginning_Of_Data      to the_table
50070>>>>>>>>>>>            End_Procedure // OnClick
50071>>>>>>>>>>>            
50071>>>>>>>>>>>            
50071>>>>>>>>>>>            
50071>>>>>>>>>>>            
50071>>>>>>>>>>>            
50071>>>>>>>>>>>            
50071>>>>>>>>>>>            
50071>>>>>>>>>>>            
50071>>>>>>>>>>>            
50071>>>>>>>>>>>            
50071>>>>>>>>>>>            
50071>>>>>>>>>>>            
50071>>>>>>>>>>>            
50071>>>>>>>>>>>            
50071>>>>>>>>>>>            
50071>>>>>>>>>>>            //AB-StoreEnd
50071>>>>>>>>>>>
50071>>>>>>>>>>>        End_Object    // ButtonSub1
50072>>>>>>>>>>>
50072>>>>>>>>>>>        Object btnwitemcl is a ButtonSub
50074>>>>>>>>>>>
50074>>>>>>>>>>>            //AB-StoreTopStart
50074>>>>>>>>>>>                                                                                    
50074>>>>>>>>>>>            //AB-StoreTopEnd
50074>>>>>>>>>>>
50074>>>>>>>>>>>            Set Label to "ButtonSub1"
50075>>>>>>>>>>>            Set Bitmap to "Filesys3.bmp"
50076>>>>>>>>>>>            Set Size to 22 25
50077>>>>>>>>>>>            Set Location to 214 482
50078>>>>>>>>>>>            Set Focus_Mode to Pointer_Only
50079>>>>>>>>>>>
50079>>>>>>>>>>>            //AB-StoreStart
50079>>>>>>>>>>>                                                                                    
50079>>>>>>>>>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«¦ œ¬¨œ«ã¨ ¦ „ ›é¤"
50080>>>>>>>>>>>            
50080>>>>>>>>>>>            Procedure OnClick
50082>>>>>>>>>>>                String  scode speri
50083>>>>>>>>>>>                Get value of (ocode(self)) to scode
50084>>>>>>>>>>>                Get value of (operi(self)) to speri
50085>>>>>>>>>>>                set pscode of (sl17(self)) to scode
50086>>>>>>>>>>>                set psperi of (sl17(self)) to speri
50087>>>>>>>>>>>                send request_cancel to dg186
50088>>>>>>>>>>>            End_Procedure // OnClick
50089>>>>>>>>>>>            
50089>>>>>>>>>>>            
50089>>>>>>>>>>>            
50089>>>>>>>>>>>            
50089>>>>>>>>>>>            
50089>>>>>>>>>>>            
50089>>>>>>>>>>>            
50089>>>>>>>>>>>            
50089>>>>>>>>>>>            
50089>>>>>>>>>>>            
50089>>>>>>>>>>>            
50089>>>>>>>>>>>            
50089>>>>>>>>>>>            
50089>>>>>>>>>>>            
50089>>>>>>>>>>>            
50089>>>>>>>>>>>            
50089>>>>>>>>>>>            
50089>>>>>>>>>>>            
50089>>>>>>>>>>>            
50089>>>>>>>>>>>            
50089>>>>>>>>>>>            
50089>>>>>>>>>>>            //AB-StoreEnd
50089>>>>>>>>>>>
50089>>>>>>>>>>>        End_Object    // btnwitemcl
50090>>>>>>>>>>>
50090>>>>>>>>>>>
50090>>>>>>>>>>>        //AB-StoreStart
50090>>>>>>>>>>>        Procedure Activating
50092>>>>>>>>>>>           integer rval
50093>>>>>>>>>>>           set value of (ocode(self)) to (pscode(self))
50094>>>>>>>>>>>           set value of (operi(self)) to (psperi(self))
50095>>>>>>>>>>>           Send Rebuild_Constraints to (witemcl_DD(Self))
50096>>>>>>>>>>>           Forward send Activating
50098>>>>>>>>>>>        
50098>>>>>>>>>>>        End_Procedure
50099>>>>>>>>>>>        
50099>>>>>>>>>>>        
50099>>>>>>>>>>>        
50099>>>>>>>>>>>        
50099>>>>>>>>>>>        
50099>>>>>>>>>>>        
50099>>>>>>>>>>>        //AB-StoreEnd
50099>>>>>>>>>>>
50099>>>>>>>>>>>    End_Object    // dg186
50100>>>>>>>>>>>
50100>>>>>>>>>>>
50100>>>>>>>>>>>    //AB-StoreStart
50100>>>>>>>>>>>        
50100>>>>>>>>>>>    //AB-StoreEnd
50100>>>>>>>>>>>
50100>>>>>>>>>>>//AB/     End_Object    // prj
50100>>>>>>>>>    //AB-StoreTopEnd
50100>>>>>>>>>
50100>>>>>>>>>    //AB-IgnoreStart
50100>>>>>>>>>
50100>>>>>>>>>    Use DFAllEnt.pkg
50100>>>>>>>>>    Use dbList.Sub
50100>>>>>>>>>    Use Txtbox.Sub
50100>>>>>>>>>    Use Form.Sub
50100>>>>>>>>>    Use Rgroup.Sub
50100>>>>>>>>>    Use Radio.Sub
50100>>>>>>>>>    Use Button.Sub
50100>>>>>>>>>
50100>>>>>>>>>
50100>>>>>>>>>    Use UNITS.DD
50100>>>>>>>>>    Use WITEMKAT.DD
50100>>>>>>>>>    Use FPA.DD
50100>>>>>>>>>    Use ITEM.DD
50100>>>>>>>>>    Use WITEMX.DD
INCLUDING FILE: WITEMX.DD
50100>>>>>>>>>>>//DDB-FileStart
50100>>>>>>>>>>>//DDB-HeaderStart
50100>>>>>>>>>>>
50100>>>>>>>>>>>// File Name : WITEMX.DD
50100>>>>>>>>>>>// Class Name: Witemx_DataDictionary
50100>>>>>>>>>>>// Revision  : 78
50100>>>>>>>>>>>// Version   : 2
50100>>>>>>>>>>>
50100>>>>>>>>>>>Use  Windows           // Basic Definitions
50100>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
50100>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
50100>>>>>>>>>>>
50100>>>>>>>>>>>Open Witemx
50102>>>>>>>>>>>Open Witemxt
50104>>>>>>>>>>>Open Pmoves
50106>>>>>>>>>>>Open Wam
50108>>>>>>>>>>>Open Pmovesl
50110>>>>>>>>>>>Open Witemxen
INCLUDING FILE: WITEMXEN.FD
50112>>>>>>>>>>>Open Camovedd
INCLUDING FILE: CAMOVEDD.FD
50114>>>>>>>>>>>Open Wcmoves
50116>>>>>>>>>>>Open Item
50118>>>>>>>>>>>Open Sysrecw
50120>>>>>>>>>>>Open Syscurxr
50122>>>>>>>>>>>
50122>>>>>>>>>>>//DDB-HeaderEnd
50122>>>>>>>>>>>//DDB-SelectionStart
50122>>>>>>>>>>>//DDB/ ExternalSelectionList SL22s  sl22s.SL
50122>>>>>>>>>>>Register_Object SL22s
50122>>>>>>>>>>>//DDB-SelectionEnd
50122>>>>>>>>>>>
50122>>>>>>>>>>>Class Witemx_DataDictionary  is a DataDictionary
50123>>>>>>>>>>>
50123>>>>>>>>>>>    Procedure Construct_Object
50124>>>>>>>>>>>        Forward Send Construct_Object
50126>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
50127>>>>>>>>>>>    End_Procedure //construct_object
50128>>>>>>>>>>>
50128>>>>>>>>>>>    Procedure OnConstrain
50129>>>>>>>>>>>        Forward Send OnConstrain
50131>>>>>>>>>>>        If (piMustNOTConstrain(Self)) Begin
50133>>>>>>>>>>>        End
50133>>>>>>>>>>>>
50133>>>>>>>>>>>        Else Begin
50134>>>>>>>>>>>            Constrain Witemx.Company_Code  eq SysCurXR.Company_Code
50136>>>>>>>>>>>            Constrain Witemx.Branch_Code   eq SysCurXR.Branch_Code
50138>>>>>>>>>>>            Constrain Witemx.Year_Year     eq SysCurXR.Year_Year
50140>>>>>>>>>>>        End
50140>>>>>>>>>>>>
50140>>>>>>>>>>>    End_Procedure
50141>>>>>>>>>>>
50141>>>>>>>>>>>    Procedure Save_Main_File
50142>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
50144>>>>>>>>>>>            If Witemx.Recnum Eq 0 Procedure_Return
50147>>>>>>>>>>>        End
50147>>>>>>>>>>>>
50147>>>>>>>>>>>        Forward Send Save_Main_File
50149>>>>>>>>>>>    End_Procedure
50150>>>>>>>>>>>
50150>>>>>>>>>>>    // Update:
50150>>>>>>>>>>>    Procedure Update
50151>>>>>>>>>>>        Forward Send Update
50153>>>>>>>>>>>        // Insert Code Here
50153>>>>>>>>>>>        Move SysCurXR.Company_Code  to Witemx.Company_Code
50154>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Witemx.Branch_Code
50155>>>>>>>>>>>        Move SysCurXR.Year_Year     to Witemx.Year_Year
50156>>>>>>>>>>>        Move SysCurXR.Year_Recr     to Witemx.Year_Recr
50157>>>>>>>>>>>        Move Witemkat.Witemkat_Code to Witemx.Witemkat_Code
50158>>>>>>>>>>>        Move Units.Units_Code       to Witemx.Units_Code
50159>>>>>>>>>>>        Move Item.Item_Code         to Witemx.Item_Code
50160>>>>>>>>>>>        Move Item.Item_Code         to Witemx.Witemx_Code
50161>>>>>>>>>>>        Move Item.Item_Descr        to Witemx.Witemx_Descr
50162>>>>>>>>>>>        Move Item.Wapokat_Code      to Witemx.ITEM_APOKAT_COD 
50163>>>>>>>>>>>        Move Item.link1             to witemx.link1
50164>>>>>>>>>>>        move Item.link2             to witemx.link2
50165>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Xre/Witemx.Qty_Xre),4))  to Witemx.Mesosta_Xre
50166>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Pis/Witemx.Qty_Pis),4))  to Witemx.Mesosta_Pis
50167>>>>>>>>>>>    End_Procedure   // Update
50168>>>>>>>>>>>
50168>>>>>>>>>>>
50168>>>>>>>>>>>    Procedure Backout
50169>>>>>>>>>>>        Forward Send Backout
50171>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Xre/Witemx.Qty_Xre),4))  to Witemx.Mesosta_Xre
50172>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Pis/Witemx.Qty_Pis),4))  to Witemx.Mesosta_Pis
50173>>>>>>>>>>>    End_Procedure   // Update
50174>>>>>>>>>>>
50174>>>>>>>>>>>    Procedure Creating
50175>>>>>>>>>>>        Forward Send Creating
50177>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                       (Trim(String(Witemx.Witemx_Rec0)))))) to Witemx.Witemx_Recr
50178>>>>>>>>>>>    End_Procedure   // Creating
50179>>>>>>>>>>>
50179>>>>>>>>>>>
50179>>>>>>>>>>>
50179>>>>>>>>>>>    // Define_Fields:
50179>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
50179>>>>>>>>>>>
50179>>>>>>>>>>>    Procedure Define_Fields
50180>>>>>>>>>>>        Forward Send Define_Fields
50182>>>>>>>>>>>        //DDB-Generated-Code-Location
50182>>>>>>>>>>>        //DDB-DefineFieldStart
50182>>>>>>>>>>>
50182>>>>>>>>>>>        Set Main_File            To Witemx.File_Number
50183>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
50184>>>>>>>>>>>
50184>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
50185>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
50186>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
50187>>>>>>>>>>>
50187>>>>>>>>>>>        // Child (Client) file structure................
50187>>>>>>>>>>>        Send Add_Client_File  Witemxt.File_Number
50188>>>>>>>>>>>        Send Add_Client_File  Pmoves.File_Number
50189>>>>>>>>>>>        Send Add_Client_File  Wam.File_Number
50190>>>>>>>>>>>        Send Add_Client_File  Pmovesl.File_Number
50191>>>>>>>>>>>        Send Add_Client_File  Witemxen.File_Number
50192>>>>>>>>>>>        Send Add_Client_File  Camovedd.File_Number
50193>>>>>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
50194>>>>>>>>>>>
50194>>>>>>>>>>>        // Parent (Server) file structure...............
50194>>>>>>>>>>>        Send Add_Server_File  Item.File_Number
50195>>>>>>>>>>>
50195>>>>>>>>>>>        // External (System) file structure.............
50195>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
50196>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
50197>>>>>>>>>>>
50197>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Witemx_Rec0  To Witemx.Witemx_Rec0
50200>>>>>>>>>>>
50200>>>>>>>>>>>        // Field-based properties.......................
50200>>>>>>>>>>>
50200>>>>>>>>>>>        // Witemx.Company_Code
50200>>>>>>>>>>>
50200>>>>>>>>>>>        // Witemx.Branch_Code
50200>>>>>>>>>>>
50200>>>>>>>>>>>        // Witemx.Year_Year
50200>>>>>>>>>>>
50200>>>>>>>>>>>        // Witemx.Units_Code
50200>>>>>>>>>>>
50200>>>>>>>>>>>        // Witemx.Witemkat_Code
50200>>>>>>>>>>>
50200>>>>>>>>>>>        // Witemx.Item_Code
50200>>>>>>>>>>>
50200>>>>>>>>>>>        // Witemx.Witemx_Code
50200>>>>>>>>>>>        Set Field_Options          Field Witemx.Witemx_Code To DD_AUTOFIND   
50201>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Code To (SL22s(Self))
50202>>>>>>>>>>>        Set Key_Field_State        Field Witemx.Witemx_Code To TRUE
50203>>>>>>>>>>>
50203>>>>>>>>>>>        // Witemx.Witemx_Recr
50203>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Recr To (SL22s(Self))
50204>>>>>>>>>>>
50204>>>>>>>>>>>        // Witemx.Year_Recr
50204>>>>>>>>>>>
50204>>>>>>>>>>>        // Witemx.Item_Recr
50204>>>>>>>>>>>
50204>>>>>>>>>>>        // Witemx.Witemx_Descr
50204>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Descr To (SL22s(Self))
50205>>>>>>>>>>>
50205>>>>>>>>>>>        // Witemx.Witemx_Rec0
50205>>>>>>>>>>>
50205>>>>>>>>>>>        // Witemx.Witemx_Yeardesc
50205>>>>>>>>>>>
50205>>>>>>>>>>>        // Witemx.Item_Apokat_Cod
50205>>>>>>>>>>>
50205>>>>>>>>>>>        // Witemx.Qty_Xre
50205>>>>>>>>>>>
50205>>>>>>>>>>>        // Witemx.Qty_Pis
50205>>>>>>>>>>>
50205>>>>>>>>>>>        // Witemx.Axia_Xre
50205>>>>>>>>>>>
50205>>>>>>>>>>>        // Witemx.Axia_Pis
50205>>>>>>>>>>>
50205>>>>>>>>>>>        // Witemx.Mesosta_Xre
50205>>>>>>>>>>>
50205>>>>>>>>>>>        // Witemx.Mesosta_Pis
50205>>>>>>>>>>>
50205>>>>>>>>>>>        // Witemx.Link1
50205>>>>>>>>>>>
50205>>>>>>>>>>>        // Witemx.Link2
50205>>>>>>>>>>>
50205>>>>>>>>>>>        //DDB-DefineFieldEnd
50205>>>>>>>>>>>    End_Procedure    // Define_Fields
50206>>>>>>>>>>>
50206>>>>>>>>>>>    // Field_Defaults:
50206>>>>>>>>>>>    // This procedure is used to establish default field values.
50206>>>>>>>>>>>
50206>>>>>>>>>>>    Procedure Field_Defaults
50207>>>>>>>>>>>        Forward Send Field_Defaults
50209>>>>>>>>>>>        //DDB-Generated-Code-Location
50209>>>>>>>>>>>        //DDB-FieldDefaultStart
50209>>>>>>>>>>>        //DDB-FieldDefaultEnd
50209>>>>>>>>>>>    End_Procedure    // Field_Defaults
50210>>>>>>>>>>>
50210>>>>>>>>>>>End_Class    // Witemx_DataDictionary
50211>>>>>>>>>>>//DDB-Selection-pkg-Start
50211>>>>>>>>>>>
50211>>>>>>>>>>>Use sl22s.SL         // SL22s
50211>>>>>>>>>>>
50211>>>>>>>>>>>//DDB-Selection-pkg-End
50211>>>>>>>>>>>//DDB-FileEnd
50211>>>>>>>>>    
50211>>>>>>>>>    //AB-IgnoreEnd
50211>>>>>>>>>
50211>>>>>>>>>    Object SL17 is a dbModalPanelSub
50213>>>>>>>>>
50213>>>>>>>>>        //AB-StoreTopStart
50213>>>>>>>>>                
50213>>>>>>>>>        Property String     pscode                  ''
50215>>>>>>>>>        Property String     psperi                  ''
50217>>>>>>>>>        Property Integer    piContains_Or_Starts     0
50219>>>>>>>>>        Property String     pscodekat               ''
50221>>>>>>>>>        
50221>>>>>>>>>        //AB-StoreTopEnd
50221>>>>>>>>>
50221>>>>>>>>>        Set Minimize_Icon to FALSE
50222>>>>>>>>>        Set Label to "„¬¨œ«ã¨ ¦ €¨®œå¦¬ „ ›é¤"
50223>>>>>>>>>        Set Size to 266 484
50224>>>>>>>>>        Set Location to 9 14
50225>>>>>>>>>        Set Exit_Application_Local_State to FALSE
50226>>>>>>>>>        Set Modal_State to FALSE
50227>>>>>>>>>
50227>>>>>>>>>        //AB-DDOStart
50227>>>>>>>>>
50227>>>>>>>>>        Object Units_DD is a Units_DataDictionary
50229>>>>>>>>>        End_Object    // Units_DD
50230>>>>>>>>>
50230>>>>>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
50232>>>>>>>>>        End_Object    // Witemkat_DD
50233>>>>>>>>>
50233>>>>>>>>>        Object Fpa_DD is a Fpa_DataDictionary
50235>>>>>>>>>        End_Object    // Fpa_DD
50236>>>>>>>>>
50236>>>>>>>>>        Object Item_DD is a Item_DataDictionary
50238>>>>>>>>>
50238>>>>>>>>>            //AB-StoreTopStart
50238>>>>>>>>>                                                                                                    
50238>>>>>>>>>                                                                                                    
50238>>>>>>>>>            //AB-StoreTopEnd
50238>>>>>>>>>
50238>>>>>>>>>            Set DDO_Server to (Units_DD(self))
50239>>>>>>>>>            Set DDO_Server to (Witemkat_DD(self))
50240>>>>>>>>>            Set DDO_Server to (Fpa_DD(self))
50241>>>>>>>>>
50241>>>>>>>>>            //AB-StoreStart
50241>>>>>>>>>                                                                                                    
50241>>>>>>>>>                                                                                                    
50241>>>>>>>>>                                                                                                    
50241>>>>>>>>>                                                                                                    
50241>>>>>>>>>                                                                                                    
50241>>>>>>>>>                                                                                                    
50241>>>>>>>>>                                                                                                    
50241>>>>>>>>>                                                                                                    
50241>>>>>>>>>            //AB-StoreEnd
50241>>>>>>>>>
50241>>>>>>>>>        End_Object    // Item_DD
50242>>>>>>>>>
50242>>>>>>>>>        Object Witemx_DD is a Witemx_DataDictionary
50244>>>>>>>>>
50244>>>>>>>>>            //AB-StoreTopStart
50244>>>>>>>>>            Function fiPeriexei Returns Integer
50246>>>>>>>>>                       String lsperi lscode  lscodekat
50247>>>>>>>>>                       Integer rVal liContains_Or_Starts
50247>>>>>>>>>                       Move 0 to rVal
50248>>>>>>>>>                       Get piContains_Or_Starts to liContains_Or_Starts
50249>>>>>>>>>                       Get psperi to lsperi
50250>>>>>>>>>                       Get pscode to lscode
50251>>>>>>>>>                       Get pscodekat to lscodekat
50252>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
50253>>>>>>>>>                       Move (Trim(lscode)) to lscode
50254>>>>>>>>>                       If (liContains_Or_Starts=0) Begin
50256>>>>>>>>>                           If ((Trim(witemx.witemx_descr)) Contains lsperi) Begin
50258>>>>>>>>>                               If ((Trim(witemx.witemx_code)) Contains lscode) Move 1 to rVal
50261>>>>>>>>>                           End
50261>>>>>>>>>>
50261>>>>>>>>>                       End
50261>>>>>>>>>>
50261>>>>>>>>>                       Else Begin
50262>>>>>>>>>                           If (Left(witemx.witemx_descr,(Length(lsperi)))=lsperi) Begin
50264>>>>>>>>>                               If (Left(witemx.witemx_code,(Length(lscode)))=lscode) Move 1 to rVal
50267>>>>>>>>>                           End
50267>>>>>>>>>>
50267>>>>>>>>>                       End
50267>>>>>>>>>>
50267>>>>>>>>>                       Function_Return rVal
50268>>>>>>>>>                   End_Function
50269>>>>>>>>>            
50269>>>>>>>>>                   Function fiArxizeiperi Returns Integer
50271>>>>>>>>>                       String lsperi
50272>>>>>>>>>                       Get psperi to lsperi
50273>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
50274>>>>>>>>>                       Function_Return (Left(witemx.witemx_descr,(Length(lsperi)))=lsperi)
50275>>>>>>>>>                   End_Function
50276>>>>>>>>>            
50276>>>>>>>>>                   Function fiArxizeicode Returns Integer
50278>>>>>>>>>                       String lscode lscodekat
50279>>>>>>>>>                       Get pscode to lscode
50280>>>>>>>>>                       Move (Trim(lscode)) to lscode
50281>>>>>>>>>                       Function_Return (Left(witemx.witemx_code,(Length(lscode)))=lscode)
50282>>>>>>>>>                   End_Function
50283>>>>>>>>>            //AB-StoreTopEnd
50283>>>>>>>>>
50283>>>>>>>>>            Set DDO_Server to (Item_DD(self))
50284>>>>>>>>>
50284>>>>>>>>>            //AB-StoreStart
50284>>>>>>>>>                                                                                
50284>>>>>>>>>            Begin_Constraints
50286>>>>>>>>>               String lsperi lscode lsvalue lstype lscodekat
50287>>>>>>>>>               Integer liContains_Or_Starts
50287>>>>>>>>>               Get psperi               to lsperi
50288>>>>>>>>>               Get pscode               to lscode
50289>>>>>>>>>               Get pscodekat            to lscodekat
50290>>>>>>>>>               Get piContains_Or_Starts to liContains_Or_Starts
50291>>>>>>>>>               Move (Trim(lsperi))      to lsperi
50292>>>>>>>>>               Move (Trim(lscode))      to lscode
50293>>>>>>>>>               Move (Trim(lscodekat))   to lscodekat
50294>>>>>>>>>               Set Ordering to 4
50295>>>>>>>>>               If ((lsperi<>'') and (lscode<>'')) Begin
50297>>>>>>>>>                    Set Ordering to 4
50298>>>>>>>>>                    Constrain witemx as (fiPeriexei(Self)=1)
50299>>>>>>>>>               End
50299>>>>>>>>>>
50299>>>>>>>>>               Else Begin
50300>>>>>>>>>                  If (liContains_Or_Starts=0) Begin
50302>>>>>>>>>                        If (lsperi<>'') Begin
50304>>>>>>>>>                            Set Ordering to 3
50305>>>>>>>>>                            Constrain witemx.witemx_descr Contains lsperi
50307>>>>>>>>>                        End
50307>>>>>>>>>>
50307>>>>>>>>>                        Else If (lscode<>'') Begin
50310>>>>>>>>>                            Set Ordering to 4
50311>>>>>>>>>                            Constrain witemx.witemx_code Contains lscode
50313>>>>>>>>>                        End
50313>>>>>>>>>>
50313>>>>>>>>>                  End
50313>>>>>>>>>>
50313>>>>>>>>>                  Else Begin
50314>>>>>>>>>                        If (lsperi<>'') Begin
50316>>>>>>>>>                            Set Ordering to 3
50317>>>>>>>>>                            Constrain witemx as (fiArxizeiperi(Self)=1) //witemx.witemx_descr
50318>>>>>>>>>                        End
50318>>>>>>>>>>
50318>>>>>>>>>                        Else If (lscode<>'') Begin
50321>>>>>>>>>                            Set Ordering to 4
50322>>>>>>>>>                            Constrain witemx as (fiArxizeicode(Self)=1) //witemx.witemx_code
50323>>>>>>>>>                        End
50323>>>>>>>>>>
50323>>>>>>>>>                  End
50323>>>>>>>>>>
50323>>>>>>>>>                  If (lscodekat<>'') Begin
50325>>>>>>>>>                        Constrain witemx.witemkat_code Contains lscodekat
50327>>>>>>>>>                  End
50327>>>>>>>>>>
50327>>>>>>>>>               End
50327>>>>>>>>>>
50327>>>>>>>>>            End_Constraints
50330>>>>>>>>>            
50330>>>>>>>>>            
50330>>>>>>>>>            //AB-StoreEnd
50330>>>>>>>>>
50330>>>>>>>>>        End_Object    // Witemx_DD
50331>>>>>>>>>
50331>>>>>>>>>        Set Main_DD to (Witemx_DD(self))
50332>>>>>>>>>        Set Server to (Witemx_DD(self))
50333>>>>>>>>>
50333>>>>>>>>>        //AB-DDOEnd
50333>>>>>>>>>
50333>>>>>>>>>        Object oSelList is a dbListSub
50335>>>>>>>>>            Set Main_File to Witemx.File_Number
50336>>>>>>>>>            Set Ordering to 5
50337>>>>>>>>>            Set Size to 190 475
50338>>>>>>>>>            Set Location to 1 1
50339>>>>>>>>>            Set Color to 14280447
50340>>>>>>>>>            Set CurrentRowColor to 11783679
50341>>>>>>>>>            Set CurrentCellColor to 11783679
50342>>>>>>>>>            Set Auto_Index_State to FALSE
50343>>>>>>>>>
50343>>>>>>>>>            Begin_Row
50346>>>>>>>>>                Entry_Item Witemx.Witemx_code
50347>>>>>>>>>                Entry_Item Witemx.Witemx_descr
50348>>>>>>>>>                Entry_Item Witemx.Witemkat_code
50349>>>>>>>>>                Entry_Item Witemkat.Witemkat_descr
50350>>>>>>>>>                Entry_Item Item.Item_qual
50351>>>>>>>>>                Entry_Item Fpa.Fpa_pososto
50352>>>>>>>>>            End_Row
50357>>>>>>>>>
50357>>>>>>>>>            Set Form_Width    item 0 to 60
50358>>>>>>>>>            Set Header_Label  item 0 to "‰à›. „å›¦¬ª"
50359>>>>>>>>>            
50359>>>>>>>>>            Set Form_Width    item 1 to 140
50360>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
50361>>>>>>>>>            
50361>>>>>>>>>            Set Form_Width    item 2 to 70
50362>>>>>>>>>            Set Header_Label  item 2 to "‰à›. ‰˜«žš¦¨å˜ª"
50363>>>>>>>>>            
50363>>>>>>>>>            Set Form_Width    item 3 to 88
50364>>>>>>>>>            Set Header_Label  item 3 to "œ¨ š¨˜­ã ‰˜«žš."
50365>>>>>>>>>            
50365>>>>>>>>>            Set Form_Width    item 4 to 64
50366>>>>>>>>>            Set Header_Label  item 4 to "¦ æ«ž«˜"
50367>>>>>>>>>            
50367>>>>>>>>>            Set Form_Width    item 5 to 45
50368>>>>>>>>>            Set Header_Label  item 5 to "‰˜«.”..€"
50369>>>>>>>>>            
50369>>>>>>>>>
50369>>>>>>>>>            //AB-StoreStart
50369>>>>>>>>>            Property String Store_Fragma_Items public ""
50371>>>>>>>>>            set export_item_state to true
50372>>>>>>>>>            
50372>>>>>>>>>            Procedure End_Construct_Object
50374>>>>>>>>>                Forward Send End_Construct_Object
50376>>>>>>>>>                Set Color               to 14280447
50377>>>>>>>>>                Set CurrentRowColor     to 11783679
50378>>>>>>>>>                Set CurrentCellColor    to 11783679
50379>>>>>>>>>            End_Procedure
50380>>>>>>>>>            
50380>>>>>>>>>            Procedure Activating Returns Integer
50382>>>>>>>>>                Integer rVal
50383>>>>>>>>>                Forward Get Msg_Activating to rVal
50385>>>>>>>>>                set auto_index_state to true
50386>>>>>>>>>                Procedure_Return rVal
50387>>>>>>>>>            End_Procedure
50388>>>>>>>>>            
50388>>>>>>>>>            procedure move_value_out
50390>>>>>>>>>                forward send move_value_out
50392>>>>>>>>>                set value of (ocode(self)) to ''
50393>>>>>>>>>                set value of (operi(self)) to ''
50394>>>>>>>>>                set value of (ocodekat(self)) to ''
50395>>>>>>>>>                set psperi to ''
50396>>>>>>>>>                set pscode to ''
50397>>>>>>>>>                set pscodekat to ''
50398>>>>>>>>>            end_procedure
50399>>>>>>>>>            
50399>>>>>>>>>            
50399>>>>>>>>>            
50399>>>>>>>>>            
50399>>>>>>>>>            
50399>>>>>>>>>            
50399>>>>>>>>>            
50399>>>>>>>>>            
50399>>>>>>>>>            
50399>>>>>>>>>            //AB-StoreEnd
50399>>>>>>>>>
50399>>>>>>>>>        End_Object    // oSelList
50400>>>>>>>>>
50400>>>>>>>>>        Object TextBoxSub1 is a TextBoxSub
50402>>>>>>>>>            Set Label to "‘á¨à©ž ¡à› ¡¦ç š ˜"
50403>>>>>>>>>            Set Auto_Size_State to FALSE
50404>>>>>>>>>            Set Location to 192 6
50405>>>>>>>>>            Set Size to 13 69
50406>>>>>>>>>        End_Object    // TextBoxSub1
50407>>>>>>>>>
50407>>>>>>>>>        Object ocode is a FormSub
50409>>>>>>>>>            Set Size to 13 197
50410>>>>>>>>>            Set Location to 192 79
50411>>>>>>>>>            Set Label_Col_Offset to 2
50412>>>>>>>>>
50412>>>>>>>>>            //AB-StoreStart
50412>>>>>>>>>            
50412>>>>>>>>>            
50412>>>>>>>>>            
50412>>>>>>>>>            
50412>>>>>>>>>            
50412>>>>>>>>>            
50412>>>>>>>>>            
50412>>>>>>>>>            
50412>>>>>>>>>            //AB-StoreEnd
50412>>>>>>>>>
50412>>>>>>>>>        End_Object    // ocode
50413>>>>>>>>>
50413>>>>>>>>>        Object TextBoxSub2 is a TextBoxSub
50415>>>>>>>>>            Set Label to "‘á¨à©ž §œ¨ š¨˜­ãª "
50416>>>>>>>>>            Set Auto_Size_State to FALSE
50417>>>>>>>>>            Set Location to 207 6
50418>>>>>>>>>            Set Size to 13 71
50419>>>>>>>>>        End_Object    // TextBoxSub2
50420>>>>>>>>>
50420>>>>>>>>>        Object operi is a FormSub
50422>>>>>>>>>            Set Size to 13 197
50423>>>>>>>>>            Set Location to 207 79
50424>>>>>>>>>            Set Label_Col_Offset to 2
50425>>>>>>>>>
50425>>>>>>>>>            //AB-StoreStart
50425>>>>>>>>>            
50425>>>>>>>>>            
50425>>>>>>>>>            
50425>>>>>>>>>            
50425>>>>>>>>>            
50425>>>>>>>>>            
50425>>>>>>>>>            
50425>>>>>>>>>            //AB-StoreEnd
50425>>>>>>>>>
50425>>>>>>>>>        End_Object    // operi
50426>>>>>>>>>
50426>>>>>>>>>        Object RadioGroupSub1 is a RadioGroupSub
50428>>>>>>>>>            Set Size to 32 77
50429>>>>>>>>>            Set Location to 191 279
50430>>>>>>>>>            Object Radio1 is a RadioSub
50432>>>>>>>>>                Set Label to "œ¨ â®œ«˜ "
50433>>>>>>>>>                Set Size to 10 53
50434>>>>>>>>>                Set Location to 7 5
50435>>>>>>>>>            End_Object    // Radio1
50436>>>>>>>>>
50436>>>>>>>>>            Object Radio2 is a RadioSub
50438>>>>>>>>>                Set Label to "€¨®åœ  €§¦"
50439>>>>>>>>>                Set Size to 10 52
50440>>>>>>>>>                Set Location to 21 5
50441>>>>>>>>>            End_Object    // Radio2
50442>>>>>>>>>
50442>>>>>>>>>
50442>>>>>>>>>            //AB-StoreStart
50442>>>>>>>>>            
50442>>>>>>>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
50444>>>>>>>>>                Set piContains_Or_Starts to iToItem
50445>>>>>>>>>            End_Procedure
50446>>>>>>>>>            
50446>>>>>>>>>            
50446>>>>>>>>>            
50446>>>>>>>>>            
50446>>>>>>>>>            
50446>>>>>>>>>            //AB-StoreEnd
50446>>>>>>>>>
50446>>>>>>>>>        End_Object    // RadioGroupSub1
50447>>>>>>>>>
50447>>>>>>>>>        Object ButtonSub1 is a ButtonSub
50449>>>>>>>>>            Set Label to "œ¨ æ¨ ©œ"
50450>>>>>>>>>            Set Size to 15 197
50451>>>>>>>>>            Set Location to 236 79
50452>>>>>>>>>            Set Form_FontWeight Item 0 to 800
50453>>>>>>>>>            Set Form_TypeFace Item 0 to "ms sans serif"
50454>>>>>>>>>
50454>>>>>>>>>            //AB-StoreStart
50454>>>>>>>>>            
50454>>>>>>>>>            Procedure OnClick
50456>>>>>>>>>                Forward Send OnClick
50458>>>>>>>>>                Set pscode      to (Value(ocode(Self),0))
50459>>>>>>>>>                Set psperi      to (Value(operi(Self),0))
50460>>>>>>>>>                Set pscodekat   to (Value(ocodekat(Self),0))
50461>>>>>>>>>                send Rebuild_Constraints    to (witemx_DD(Self))
50462>>>>>>>>>                Send Beginning_Of_Data      to oSelList True
50463>>>>>>>>>            End_Procedure // OnClick
50464>>>>>>>>>            
50464>>>>>>>>>            
50464>>>>>>>>>            //AB-StoreEnd
50464>>>>>>>>>
50464>>>>>>>>>        End_Object    // ButtonSub1
50465>>>>>>>>>
50465>>>>>>>>>        Object TextBoxSub3 is a TextBoxSub
50467>>>>>>>>>            Set Label to "‰à›. ¡˜«žš¦¨å˜ª š ˜"
50468>>>>>>>>>            Set Auto_Size_State to FALSE
50469>>>>>>>>>            Set Location to 221 5
50470>>>>>>>>>            Set Size to 13 70
50471>>>>>>>>>        End_Object    // TextBoxSub3
50472>>>>>>>>>
50472>>>>>>>>>        Object ocodekat is a FormSub
50474>>>>>>>>>            Set Size to 13 197
50475>>>>>>>>>            Set Location to 221 79
50476>>>>>>>>>            Set Label_Col_Offset to 2
50477>>>>>>>>>
50477>>>>>>>>>            //AB-StoreStart
50477>>>>>>>>>            
50477>>>>>>>>>            
50477>>>>>>>>>            
50477>>>>>>>>>            
50477>>>>>>>>>            
50477>>>>>>>>>            
50477>>>>>>>>>            
50477>>>>>>>>>            //AB-StoreEnd
50477>>>>>>>>>
50477>>>>>>>>>        End_Object    // ocodekat
50478>>>>>>>>>
50478>>>>>>>>>        Object oOK_bn is a ButtonSub
50480>>>>>>>>>            Set Label to "&„§ ¢¦šã"
50481>>>>>>>>>            Set Location to 232 318
50482>>>>>>>>>
50482>>>>>>>>>            //AB-StoreStart
50482>>>>>>>>>            Procedure OnClick
50484>>>>>>>>>                Send OK To (oSelList(current_object))
50485>>>>>>>>>            End_Procedure
50486>>>>>>>>>            //AB-StoreEnd
50486>>>>>>>>>
50486>>>>>>>>>        End_Object    // oOK_bn
50487>>>>>>>>>
50487>>>>>>>>>        Object oCancel_bn is a ButtonSub
50489>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
50490>>>>>>>>>            Set Location to 232 373
50491>>>>>>>>>
50491>>>>>>>>>            //AB-StoreStart
50491>>>>>>>>>            Procedure OnClick
50493>>>>>>>>>                Send Cancel To (oSelList(current_object))
50494>>>>>>>>>            End_Procedure
50495>>>>>>>>>            //AB-StoreEnd
50495>>>>>>>>>
50495>>>>>>>>>        End_Object    // oCancel_bn
50496>>>>>>>>>
50496>>>>>>>>>        Object oSearch_bn is a ButtonSub
50498>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
50499>>>>>>>>>            Set Location to 232 428
50500>>>>>>>>>
50500>>>>>>>>>            //AB-StoreStart
50500>>>>>>>>>            Procedure OnClick
50502>>>>>>>>>                Send Search To (oSelList(current_object))
50503>>>>>>>>>            End_Procedure
50504>>>>>>>>>            //AB-StoreEnd
50504>>>>>>>>>
50504>>>>>>>>>        End_Object    // oSearch_bn
50505>>>>>>>>>
50505>>>>>>>>>        Object btnwitemcl is a ButtonSub
50507>>>>>>>>>
50507>>>>>>>>>            //AB-StoreTopStart
50507>>>>>>>>>            
50507>>>>>>>>>            //AB-StoreTopEnd
50507>>>>>>>>>
50507>>>>>>>>>            Set Label to "ButtonSub1"
50508>>>>>>>>>            Set Bitmap to "Filesys3.bmp"
50509>>>>>>>>>            Set Size to 22 25
50510>>>>>>>>>            Set Location to 196 443
50511>>>>>>>>>            Set Focus_Mode to Pointer_Only
50512>>>>>>>>>
50512>>>>>>>>>            //AB-StoreStart
50512>>>>>>>>>            
50512>>>>>>>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«¦ œ¬¨œ«ã¨ ¦ „ ›é¤ / ¨¦£žŸœ¬«ã"
50513>>>>>>>>>            
50513>>>>>>>>>            Procedure OnClick
50515>>>>>>>>>                String  scode speri
50516>>>>>>>>>                Get value of (ocode(self)) to scode
50517>>>>>>>>>                Get value of (operi(self)) to speri
50518>>>>>>>>>                set pscode of (dg186(self)) to scode
50519>>>>>>>>>                set psperi of (dg186(self)) to speri
50520>>>>>>>>>               Send popup_modal to (dg186(self))
50521>>>>>>>>>            End_Procedure // OnClick
50522>>>>>>>>>            
50522>>>>>>>>>            
50522>>>>>>>>>            
50522>>>>>>>>>            
50522>>>>>>>>>            
50522>>>>>>>>>            
50522>>>>>>>>>            
50522>>>>>>>>>            
50522>>>>>>>>>            
50522>>>>>>>>>            
50522>>>>>>>>>            
50522>>>>>>>>>            
50522>>>>>>>>>            
50522>>>>>>>>>            
50522>>>>>>>>>            
50522>>>>>>>>>            
50522>>>>>>>>>            
50522>>>>>>>>>            
50522>>>>>>>>>            
50522>>>>>>>>>            
50522>>>>>>>>>            
50522>>>>>>>>>            
50522>>>>>>>>>            
50522>>>>>>>>>            //AB-StoreEnd
50522>>>>>>>>>
50522>>>>>>>>>        End_Object    // btnwitemcl
50523>>>>>>>>>
50523>>>>>>>>>
50523>>>>>>>>>        //AB-StoreStart
50523>>>>>>>>>                
50523>>>>>>>>>        Set Locate_Mode to Center_On_Screen
50524>>>>>>>>>        
50524>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
50525>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
50526>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
50527>>>>>>>>>        
50527>>>>>>>>>        Procedure Activate
50529>>>>>>>>>            Send Rebuild_Constraints    to Witemx_DD
50530>>>>>>>>>            Send Beginning_Of_Data      to oSelList True
50531>>>>>>>>>            Forward Send Activate
50533>>>>>>>>>        End_Procedure
50534>>>>>>>>>        
50534>>>>>>>>>        procedure request_cancel
50536>>>>>>>>>            forward send request_cancel
50538>>>>>>>>>            set value of (ocode(self)) to ''
50539>>>>>>>>>            set value of (operi(self)) to ''
50540>>>>>>>>>            set value of (ocodekat(self)) to ''
50541>>>>>>>>>            Set psperi  to ''
50542>>>>>>>>>            Set pscode  to ''
50543>>>>>>>>>            Set pscodekat TO ''
50544>>>>>>>>>        end_procedure
50545>>>>>>>>>        
50545>>>>>>>>>        
50545>>>>>>>>>        
50545>>>>>>>>>        
50545>>>>>>>>>        
50545>>>>>>>>>        
50545>>>>>>>>>        
50545>>>>>>>>>        
50545>>>>>>>>>        
50545>>>>>>>>>        //AB-StoreEnd
50545>>>>>>>>>
50545>>>>>>>>>    End_Object    // SL17
50546>>>>>>>>>
50546>>>>>>>>>
50546>>>>>>>>>    //AB-StoreStart
50546>>>>>>>>>    
50546>>>>>>>>>    
50546>>>>>>>>>    
50546>>>>>>>>>    
50546>>>>>>>>>    
50546>>>>>>>>>    
50546>>>>>>>>>    
50546>>>>>>>>>    
50546>>>>>>>>>    
50546>>>>>>>>>    
50546>>>>>>>>>    
50546>>>>>>>>>    
50546>>>>>>>>>    //AB-StoreEnd
50546>>>>>>>>>
50546>>>>>>>>>//AB/     End_Object    // prj
50546>>>>>>>Use wax.sl           // Wax
50546>>>>>>>
50546>>>>>>>//DDB-Selection-pkg-End
50546>>>>>>>//DDB-FileEnd
50546>>>>>
50546>>>>>//AB-IgnoreEnd
50546>>>>>
50546>>>>>Object sl182 is a dbModalPanelSub
50548>>>>>
50548>>>>>    //AB-StoreTopStart
50548>>>>>                    
50548>>>>>    //AB-StoreTopEnd
50548>>>>>
50548>>>>>    Set Label to "ƒœ¢«å˜ „©à«œ¨ ¡ãª ƒ ˜¡å¤ž©žª „ ›é¤"
50549>>>>>    Set Size to 262 331
50550>>>>>    Set Location to 5 72
50551>>>>>    Set Exit_Application_Local_State to FALSE
50552>>>>>    Set Modal_State to FALSE
50553>>>>>
50553>>>>>    //AB-DDOStart
50553>>>>>
50553>>>>>    Object Witemxtr_DD is a Witemxtr_DataDictionary
50555>>>>>    End_Object    // Witemxtr_DD
50556>>>>>
50556>>>>>    Object Witemxtd_DD is a Witemxtd_DataDictionary
50558>>>>>        Set DDO_Server to (Witemxtr_DD(self))
50559>>>>>        Set Constrain_File to Witemxtr.File_Number
50560>>>>>    End_Object    // Witemxtd_DD
50561>>>>>
50561>>>>>    Set Main_DD to (Witemxtr_DD(self))
50562>>>>>    Set Server to (Witemxtr_DD(self))
50563>>>>>
50563>>>>>    //AB-DDOEnd
50563>>>>>
50563>>>>>    Object oSelList is a dbListSub
50565>>>>>        Set Main_File to Witemxtr.File_Number
50566>>>>>        Set Size to 220 311
50567>>>>>        Set Location to 6 6
50568>>>>>
50568>>>>>        Begin_Row
50571>>>>>            Entry_Item Witemxtr.Hmnia
50572>>>>>            Entry_Item Witemxtr.Descr
50573>>>>>            Entry_Item Witemxtr.Qty
50574>>>>>            Entry_Item Witemxtr.Ekleise
50575>>>>>        End_Row
50580>>>>>
50580>>>>>        Set Form_Width    item 0 to 48
50581>>>>>        Set Header_Label  item 0 to "†£/¤å˜"
50582>>>>>        
50582>>>>>        Set Form_Width    item 1 to 200
50583>>>>>        Set Header_Label  item 1 to "˜¨˜©«˜« ¡æ"
50584>>>>>        
50584>>>>>        Set Form_Width    item 2 to 35
50585>>>>>        Set Header_Label  item 2 to "¦©¦«."
50586>>>>>        
50586>>>>>        Set Form_Width    item 3 to 20
50587>>>>>        Set Header_Label  item 3 to "Ž‰"
50588>>>>>        Set Column_Checkbox_State  item 3 to True
50589>>>>>        
50589>>>>>
50589>>>>>        //AB-StoreStart
50589>>>>>        
50589>>>>>        Procedure End_Construct_Object
50591>>>>>            String  sNom
50592>>>>>            Integer iDecs
50592>>>>>            Forward Send End_Construct_Object
50594>>>>>            Move SysCurxr.C_Code0 to sNom
50595>>>>>            Clear Nomisma
50596>>>>>            Move sNom to Nomisma.Nomisma_Code
50597>>>>>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
50598>>>>>>
50598>>>>>            If (Found=1)    Move Nomisma.Dekadika to iDecs
50601>>>>>            Else            Move 0 to iDecs
50603>>>>>        
50603>>>>>            // Ž¨ ¦¬£œ §àª ˜¤ «¦ ™˜© ¡æ ¤¦£ ©£˜ ®¨ã©žª ƒ„Œ œ®œ  ›œ¡˜› ¡á
50603>>>>>            // «æ«œ œ¥' ¦¨ ©£¦ç ™á¦¬£œ œ£œ ª 2
50603>>>>>            If (iDecs=0) Move 2 to iDecs
50606>>>>>            //
50606>>>>>            Set Points          Item 2 to      2
50607>>>>>        
50607>>>>>        End_Procedure
50608>>>>>        
50608>>>>>        
50608>>>>>        
50608>>>>>        
50608>>>>>        
50608>>>>>        
50608>>>>>        
50608>>>>>        
50608>>>>>        
50608>>>>>        //AB-StoreEnd
50608>>>>>
50608>>>>>    End_Object    // oSelList
50609>>>>>
50609>>>>>    Object oOK_bn is a ButtonSub
50611>>>>>        Set Label to "&„§ ¢¦šã"
50612>>>>>        Set Location to 230 158
50613>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
50614>>>>>
50614>>>>>        //AB-StoreStart
50614>>>>>        Procedure OnClick
50616>>>>>            Send OK To (oSelList(current_object))
50617>>>>>        End_Procedure
50618>>>>>        //AB-StoreEnd
50618>>>>>
50618>>>>>    End_Object    // oOK_bn
50619>>>>>
50619>>>>>    Object oCancel_bn is a ButtonSub
50621>>>>>        Set Label to "&€¡ç¨à©ž"
50622>>>>>        Set Location to 230 214
50623>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
50624>>>>>
50624>>>>>        //AB-StoreStart
50624>>>>>        Procedure OnClick
50626>>>>>            Send Cancel To (oSelList(current_object))
50627>>>>>        End_Procedure
50628>>>>>        //AB-StoreEnd
50628>>>>>
50628>>>>>    End_Object    // oCancel_bn
50629>>>>>
50629>>>>>    Object oSearch_bn is a ButtonSub
50631>>>>>        Set Label to "€&¤˜ã«ž©ž..."
50632>>>>>        Set Location to 230 268
50633>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
50634>>>>>
50634>>>>>        //AB-StoreStart
50634>>>>>        Procedure OnClick
50636>>>>>            Send Search To (oSelList(current_object))
50637>>>>>        End_Procedure
50638>>>>>        //AB-StoreEnd
50638>>>>>
50638>>>>>    End_Object    // oSearch_bn
50639>>>>>
50639>>>>>
50639>>>>>    //AB-StoreStart
50639>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
50640>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
50641>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
50642>>>>>    
50642>>>>>    
50642>>>>>    
50642>>>>>    
50642>>>>>    
50642>>>>>    
50642>>>>>    //AB-StoreEnd
50642>>>>>
50642>>>>>End_Object    // sl182
50643>>>>>
50643>>>>>
50643>>>>>//AB-StoreStart
50643>>>>>                                    
50643>>>>>//AB-StoreEnd
50643>>>>>
50643>>>>>//AB/ End_Object    // prj
50643>>>Use sl186a.sl
INCLUDING FILE: SL186A.SL
50643>>>>>//AB/ Project sl186a:item-clients
50643>>>>>//AB/ Object prj is a Lookup_Project
50643>>>>>//AB/     Set ProjectName to "sl186a:item-clients"
50643>>>>>//AB/     Set ProjectFileName to "sl186a.SL"
50643>>>>>//AB/     Set GenerateFileName to "NONAME"
50643>>>>>
50643>>>>>// Project Object Structure
50643>>>>>//   sl186a is a dbModalPanelSub
50643>>>>>//     clients_dd2 is a clients_DataDictionary
50643>>>>>//     Witemkat_DD is a DataDictionary
50643>>>>>//     Units_DD is a DataDictionary
50643>>>>>//     Fpa_DD is a DataDictionary
50643>>>>>//     Item_DD is a DataDictionary
50643>>>>>//     Witemcl_DD is a DataDictionary
50643>>>>>//     oSelList is a dblist
50643>>>>>//     oOK_bn is a ButtonSub
50643>>>>>//     oCancel_bn is a ButtonSub
50643>>>>>//     oSearch_bn is a ButtonSub
50643>>>>>
50643>>>>>// Register all objects
50643>>>>>Register_Object clients_dd2
50643>>>>>Register_Object Fpa_DD
50643>>>>>Register_Object Item_DD
50643>>>>>Register_Object oCancel_bn
50643>>>>>Register_Object oOK_bn
50643>>>>>Register_Object oSearch_bn
50643>>>>>Register_Object oSelList
50643>>>>>Register_Object sl186a
50643>>>>>Register_Object Units_DD
50643>>>>>Register_Object Witemcl_DD
50643>>>>>Register_Object Witemkat_DD
50643>>>>>
50643>>>>>
50643>>>>>
50643>>>>>//AB-StoreTopStart
50643>>>>>open clients
50645>>>>>
50645>>>>>//AB-StoreTopEnd
50645>>>>>
50645>>>>>//AB-IgnoreStart
50645>>>>>
50645>>>>>Use DFAllEnt.pkg
50645>>>>>Use dbList.Sub
50645>>>>>Use Button.Sub
50645>>>>>
50645>>>>>
50645>>>>>Use WITEMKAT.DD
50645>>>>>Use UNITS.DD
50645>>>>>Use FPA.DD
50645>>>>>Use ITEM.DD
50645>>>>>Use WITEMCL.DD
50645>>>>>
50645>>>>>//AB-IgnoreEnd
50645>>>>>
50645>>>>>Object sl186a is a dbModalPanelSub
50647>>>>>
50647>>>>>    //AB-StoreTopStart
50647>>>>>
50647>>>>>    Property String Fragmaprom Public ""
50649>>>>>
50649>>>>>    object clients_dd2 is a clients_DataDictionary
50651>>>>>    end_object
50652>>>>>
50652>>>>>    Function fnclient String asCode Returns string
50654>>>>>        String sDescr
50655>>>>>        send clear to clients_dd2
50656>>>>>        move asCode to clients.client_id
50657>>>>>        send find to clients_dd2 eq 6
50658>>>>>        get field_current_value of clients_dd2 field clients.client_name to sDescr
50659>>>>>        function_return sDescr
50660>>>>>    end_Function
50661>>>>>
50661>>>>>    //AB-StoreTopEnd
50661>>>>>
50661>>>>>    Set Label to "„å›ž €¤á ¨¦£žŸœ¬«ã"
50662>>>>>    Set Size to 254 495
50663>>>>>    Set Location to 5 5
50664>>>>>    Set Exit_Application_Local_State to FALSE
50665>>>>>    Set Modal_State to FALSE
50666>>>>>
50666>>>>>    //AB-DDOStart
50666>>>>>
50666>>>>>    Object Witemkat_DD is a Witemkat_DataDictionary
50668>>>>>    End_Object    // Witemkat_DD
50669>>>>>
50669>>>>>    Object Units_DD is a Units_DataDictionary
50671>>>>>    End_Object    // Units_DD
50672>>>>>
50672>>>>>    Object Fpa_DD is a Fpa_DataDictionary
50674>>>>>    End_Object    // Fpa_DD
50675>>>>>
50675>>>>>    Object Item_DD is a Item_DataDictionary
50677>>>>>        Set DDO_Server to (Units_DD(self))
50678>>>>>        Set DDO_Server to (Witemkat_DD(self))
50679>>>>>        Set DDO_Server to (Fpa_DD(self))
50680>>>>>    End_Object    // Item_DD
50681>>>>>
50681>>>>>    Object Witemcl_DD is a Witemcl_DataDictionary
50683>>>>>        Set DDO_Server to (Item_DD(self))
50684>>>>>
50684>>>>>        //AB-StoreStart
50684>>>>>
50684>>>>>        Begin_Constraints
50686>>>>>            If (fragmaprom(Self)<>'') Begin
50688>>>>>                Constrain witemcl.client_code eq (fragmaprom(Self))
50690>>>>>            End
50690>>>>>>
50690>>>>>        End_Constraints
50693>>>>>
50693>>>>>
50693>>>>>        //AB-StoreEnd
50693>>>>>
50693>>>>>    End_Object    // Witemcl_DD
50694>>>>>
50694>>>>>    Set Main_DD to (Witemcl_DD(self))
50695>>>>>    Set Server to (Witemcl_DD(self))
50696>>>>>
50696>>>>>    //AB-DDOEnd
50696>>>>>
50696>>>>>    Object oSelList is a dblist
50698>>>>>        Set Main_File to Witemcl.File_Number
50699>>>>>        Set Ordering to 2
50700>>>>>        Set Size to 212 480
50701>>>>>        Set Location to 6 6
50702>>>>>        Set Color to 14280447
50703>>>>>        Set CurrentRowColor to 11783679
50704>>>>>        Set CurrentCellColor to 11783679
50705>>>>>
50705>>>>>        Begin_Row
50708>>>>>            Entry_Item Item.Item_code
50709>>>>>            Entry_Item Item.Item_descr
50710>>>>>            Entry_Item Witemcl.Client_code
50711>>>>>            Entry_Item (Fnclient(self,witemcl.client_code))
50712>>>>>            Entry_Item Witemcl.Client_itemcode
50713>>>>>            Entry_Item Witemcl.Client_date
50714>>>>>            Entry_Item Witemcl.Client_price
50715>>>>>        End_Row
50720>>>>>
50720>>>>>        Set Form_Width    item 0 to 61
50721>>>>>        Set Header_Label  item 0 to "‰à›.„å›¦¬ª"
50722>>>>>
50722>>>>>        Set Form_Width    item 1 to 90
50723>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã „å›¦¬ª"
50724>>>>>
50724>>>>>        Set Form_Width    item 2 to 55
50725>>>>>        Set Header_Label  item 2 to "‰à›.”¦¨â˜"
50726>>>>>
50726>>>>>        Set Form_Width    item 3 to 96
50727>>>>>        Set Header_Label  item 3 to "„§à¤¬£å˜ ”¦¨â˜"
50728>>>>>
50728>>>>>        Set Form_Width    item 4 to 60
50729>>>>>        Set Header_Label  item 4 to "„å›¦ª ¨¦£žŸ."
50730>>>>>
50730>>>>>        Set Form_Width    item 5 to 60
50731>>>>>        Set Header_Label  item 5 to "’'†£/¤å˜ „ ©˜š."
50732>>>>>
50732>>>>>        Set Form_Width    item 6 to 52
50733>>>>>        Set Header_Label  item 6 to "’'’ £ã „ ©˜š."
50734>>>>>
50734>>>>>
50734>>>>>        //AB-StoreStart
50734>>>>>
50734>>>>>        Property String Store_Fragma_prom public ""
50736>>>>>
50736>>>>>        Procedure Store_Defaults
50738>>>>>           forward send Store_Defaults
50740>>>>>           Set Store_Fragma_prom to (Fragmaprom(Self))
50741>>>>>        end_Procedure
50742>>>>>
50742>>>>>        Procedure Restore_Defaults
50744>>>>>            forward send Restore_Defaults
50746>>>>>            Set Fragmaprom to (Store_Fragma_prom(Self))
50747>>>>>        end_Procedure
50748>>>>>
50748>>>>>        Procedure Activating
50750>>>>>            Forward Send Activating
50752>>>>>            Send Rebuild_Constraints to WitemCl_DD
50753>>>>>        End_Procedure
50754>>>>>
50754>>>>>        Procedure End_Construct_Object
50756>>>>>            Integer iDecimals
50757>>>>>            Forward Send End_Construct_Object
50759>>>>>            Get fiDekadika_Nomismatos  SysCurXr.C_Code0  to    iDecimals
50760>>>>>            Set Points          Item 6 to       iDecimals
50761>>>>>            Set Numeric_Mask    Item 6 to 14    iDecimals '*, '
50762>>>>>        End_Procedure
50763>>>>>
50763>>>>>
50763>>>>>
50763>>>>>
50763>>>>>
50763>>>>>
50763>>>>>
50763>>>>>        //AB-StoreEnd
50763>>>>>
50763>>>>>    End_Object    // oSelList
50764>>>>>
50764>>>>>    Object oOK_bn is a ButtonSub
50766>>>>>        Set Label to "&„§ ¢¦šã"
50767>>>>>        Set Location to 222 326
50768>>>>>
50768>>>>>        //AB-StoreStart
50768>>>>>        Procedure OnClick
50770>>>>>            Send OK To (oSelList(current_object))
50771>>>>>        End_Procedure
50772>>>>>        //AB-StoreEnd
50772>>>>>
50772>>>>>    End_Object    // oOK_bn
50773>>>>>
50773>>>>>    Object oCancel_bn is a ButtonSub
50775>>>>>        Set Label to "&€¡ç¨à©ž"
50776>>>>>        Set Location to 222 381
50777>>>>>
50777>>>>>        //AB-StoreStart
50777>>>>>        Procedure OnClick
50779>>>>>            Send Cancel To (oSelList(current_object))
50780>>>>>        End_Procedure
50781>>>>>        //AB-StoreEnd
50781>>>>>
50781>>>>>    End_Object    // oCancel_bn
50782>>>>>
50782>>>>>    Object oSearch_bn is a ButtonSub
50784>>>>>        Set Label to "€&¤˜ã«ž©ž..."
50785>>>>>        Set Location to 222 436
50786>>>>>
50786>>>>>        //AB-StoreStart
50786>>>>>        Procedure OnClick
50788>>>>>            Send Search To (oSelList(current_object))
50789>>>>>        End_Procedure
50790>>>>>        //AB-StoreEnd
50790>>>>>
50790>>>>>    End_Object    // oSearch_bn
50791>>>>>
50791>>>>>
50791>>>>>    //AB-StoreStart
50791>>>>>
50791>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
50792>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
50793>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
50794>>>>>    procedure page integer pagemode
50796>>>>>        forward send page pagemode
50798>>>>>        set location to 40,40
50799>>>>>    end_procedure
50800>>>>>
50800>>>>>
50800>>>>>
50800>>>>>
50800>>>>>
50800>>>>>
50800>>>>>
50800>>>>>
50800>>>>>
50800>>>>>
50800>>>>>
50800>>>>>
50800>>>>>
50800>>>>>    //AB-StoreEnd
50800>>>>>
50800>>>>>End_Object    // sl186a
50801>>>>>
50801>>>>>
50801>>>>>//AB-StoreStart
50801>>>>>
50801>>>>>
50801>>>>>
50801>>>>>
50801>>>>>//AB-StoreEnd
50801>>>>>
50801>>>>>//AB/ End_Object    // prj
50801>>>Use sl185.sl
INCLUDING FILE: SL185.SL
50801>>>>>//AB/ Project sl185:entoles paragoghs
50801>>>>>//AB/ Object prj is a Lookup_Project
50801>>>>>//AB/     Set ProjectName to "sl185:entoles paragoghs"
50801>>>>>//AB/     Set ProjectFileName to "sl185.SL"
50801>>>>>//AB/     Set GenerateFileName to "NONAME"
50801>>>>>
50801>>>>>// Project Object Structure
50801>>>>>//   sl185 is a dbModalPanelSub
50801>>>>>//     Units_DD is a DataDictionary
50801>>>>>//     Witemkat_DD is a DataDictionary
50801>>>>>//     Fpa_DD is a DataDictionary
50801>>>>>//     Item_DD is a DataDictionary
50801>>>>>//     Witemx_DD is a DataDictionary
50801>>>>>//     Witemxen_DD is a DataDictionary
50801>>>>>//     oSelList is a dbListSub
50801>>>>>//     oOK_bn is a ButtonSub
50801>>>>>//     oCancel_bn is a ButtonSub
50801>>>>>//     oSearch_bn is a ButtonSub
50801>>>>>
50801>>>>>// Register all objects
50801>>>>>Register_Object Fpa_DD
50801>>>>>Register_Object Item_DD
50801>>>>>Register_Object oCancel_bn
50801>>>>>Register_Object oOK_bn
50801>>>>>Register_Object oSearch_bn
50801>>>>>Register_Object oSelList
50801>>>>>Register_Object sl185
50801>>>>>Register_Object Units_DD
50801>>>>>Register_Object Witemkat_DD
50801>>>>>Register_Object Witemx_DD
50801>>>>>Register_Object Witemxen_DD
50801>>>>>
50801>>>>>
50801>>>>>//AB-IgnoreStart
50801>>>>>
50801>>>>>Use DFAllEnt.pkg
50801>>>>>Use dbList.Sub
50801>>>>>Use Button.Sub
50801>>>>>
50801>>>>>
50801>>>>>Use UNITS.DD
50801>>>>>Use WITEMKAT.DD
50801>>>>>Use FPA.DD
50801>>>>>Use ITEM.DD
50801>>>>>Use WITEMX.DD
50801>>>>>Use WITEMXEN.DD
INCLUDING FILE: WITEMXEN.DD
50801>>>>>>>//DDB-FileStart
50801>>>>>>>//DDB-HeaderStart
50801>>>>>>>
50801>>>>>>>// File Name : WITEMXEN.DD
50801>>>>>>>// Class Name: Witemxen_DataDictionary
50801>>>>>>>// Revision  : 30
50801>>>>>>>// Version   : 2
50801>>>>>>>
50801>>>>>>>Use  Windows           // Basic Definitions
50801>>>>>>>Use  DataDict          // DataDictionary Class Definition
50801>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
50801>>>>>>>
50801>>>>>>>Open Witemxen
50803>>>>>>>Open Witemxed
INCLUDING FILE: WITEMXED.FD
50805>>>>>>>Open Witemx
50807>>>>>>>Open Sysrecw
50809>>>>>>>Open Branch
50811>>>>>>>
50811>>>>>>>//DDB-HeaderEnd
50811>>>>>>>//DDB-ValidationStart
50811>>>>>>>
50811>>>>>>>Register_Object Witemxen_Status_VT
50811>>>>>>>
50811>>>>>>>Object Witemxen_Status_VT  is a DescriptionValidationTable
50813>>>>>>>    Set Table_Title       To "‰˜«žš¦¨å˜ „¤«¦¢ãª"
50814>>>>>>>
50814>>>>>>>    Procedure Fill_List
50816>>>>>>>        Forward Send Fill_List
50818>>>>>>>        Send Add_Table_Value  "1"  "¨æª ‘ç¤Ÿœ©ž"
50819>>>>>>>        Send Add_Table_Value  "2"  "¨æª €§¦©ç¤Ÿœ©ž"
50820>>>>>>>    End_Procedure    // Fill_List
50821>>>>>>>    //DDB-ValidationCustomStart
50821>>>>>>>    //DDB-ValidationCustomEnd
50821>>>>>>>End_Object   // Witemxen_Status_VT
50822>>>>>>>//DDB-ValidationEnd
50822>>>>>>>//DDB-SelectionStart
50822>>>>>>>//DDB/ ExternalSelectionList sl185  sl185.SL
50822>>>>>>>//DDB/ ExternalSelectionList Wax  wax.sl
50822>>>>>>>//DDB/ ExternalSelectionList sl029a  sl029a.sl
50822>>>>>>>Register_Object sl185
50822>>>>>>>Register_Object Wax
50822>>>>>>>Register_Object sl029a
50822>>>>>>>//DDB-SelectionEnd
50822>>>>>>>
50822>>>>>>>Class Witemxen_DataDictionary  is a DataDictionary_Sec
50823>>>>>>>    Procedure Construct_Object
50824>>>>>>>        Forward Send Construct_Object
50826>>>>>>>        Property Integer piMustNOTConstrain Public 0
50827>>>>>>>    End_Procedure //construct_object
50828>>>>>>>
50828>>>>>>>    Procedure OnConstrain
50829>>>>>>>        Forward Send OnConstrain
50831>>>>>>>        Constrain Witemxen.Company_Code  eq SysCurXR.Company_Code
50833>>>>>>>        Constrain Witemxen.Branch_Code   eq SysCurXR.Branch_Code
50835>>>>>>>       Constrain Witemxen.Year_Year     eq SysCurXR.Year_Year
50837>>>>>>>    End_Procedure
50838>>>>>>>
50838>>>>>>>    // Update:
50838>>>>>>>    Procedure Update
50839>>>>>>>        Forward Send Update
50841>>>>>>>        // Insert Code Here
50841>>>>>>>        Move SysCurXR.Company_Code  to Witemxen.Company_Code
50842>>>>>>>        Move SysCurXR.Branch_Code   to Witemxen.Branch_Code
50843>>>>>>>        Move SysCurXR.Year_Year     to Witemxen.Year_Year
50844>>>>>>>        Move witemx.witemx_Code     to Witemxen.Witemxen_Code
50845>>>>>>>        Move witemx.witemx_Descr    to Witemxen.Witemxen_Descr
50846>>>>>>>
50846>>>>>>>    End_Procedure   // Update
50847>>>>>>>
50847>>>>>>>  
50847>>>>>>>    Procedure Creating
50848>>>>>>>        Forward Send Creating 
50850>>>>>>>        integer idecs 
50851>>>>>>>        string srecr sentolh
50851>>>>>>>        clear branch
50852>>>>>>>        move syscurxr.company_code to branch.company_code
50853>>>>>>>        move syscurxr.branch_code  to branch.branch_code
50854>>>>>>>        find eq branch by index.1 
50855>>>>>>>>
50855>>>>>>>        move (branch.paragogh + 1) to branch.paragogh
50856>>>>>>>        saverecord branch  
50857>>>>>>>        move branch.paragogh to sentolh
50858>>>>>>>        move 5 to idecs
50859>>>>>>>        get fsgCode_n_Zeroes sentolh idecs to srecr
50860>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(srecr)))))) to Witemxen.witemxen_Recr
50861>>>>>>>    End_Procedure   // Creating
50862>>>>>>>     
50862>>>>>>>    Procedure Shmera integer iField  Date dDate
50863>>>>>>>        Local Integer Changed
50864>>>>>>>        Get Field_Changed_State iField to Changed
50865>>>>>>>        If (Changed=0 AND dDate =0) Begin
50867>>>>>>>            SysDate4 dDate
50868>>>>>>>            Set Field_Default_Value iField to dDate
50869>>>>>>>        End
50869>>>>>>>>
50869>>>>>>>    End_Procedure   // Shmera
50870>>>>>>>
50870>>>>>>>    // Define_Fields:
50870>>>>>>>    // This procedure is used to set up all data-dictionary rules.
50870>>>>>>>
50870>>>>>>>    Procedure Define_Fields
50871>>>>>>>        Forward Send Define_Fields
50873>>>>>>>        //DDB-Generated-Code-Location
50873>>>>>>>        //DDB-DefineFieldStart
50873>>>>>>>
50873>>>>>>>        Set Main_File            To Witemxen.File_Number
50874>>>>>>>        Set Cascade_Delete_State To FALSE
50875>>>>>>>
50875>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
50876>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
50877>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
50878>>>>>>>
50878>>>>>>>        // Child (Client) file structure................
50878>>>>>>>        Send Add_Client_File  Witemxed.File_Number
50879>>>>>>>
50879>>>>>>>        // Parent (Server) file structure...............
50879>>>>>>>        Send Add_Server_File  Witemx.File_Number
50880>>>>>>>
50880>>>>>>>        // External (System) file structure.............
50880>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
50881>>>>>>>        Send Add_System_File  Branch.File_Number  DD_LOCK_ON_ALL
50882>>>>>>>
50882>>>>>>>        Define_Auto_Increment  Sysrecw.Witemxen_Rec0  To Witemxen.Witemxen_Rec0
50885>>>>>>>
50885>>>>>>>        // Field-based properties.......................
50885>>>>>>>
50885>>>>>>>        // Witemxen.Company_Code
50885>>>>>>>
50885>>>>>>>        // Witemxen.Branch_Code
50885>>>>>>>
50885>>>>>>>        // Witemxen.Year_Year
50885>>>>>>>
50885>>>>>>>        // Witemxen.Witemxen_Code
50885>>>>>>>
50885>>>>>>>        // Witemxen.Witemxen_Recr
50885>>>>>>>
50885>>>>>>>        // Witemxen.Witemx_Recr
50885>>>>>>>
50885>>>>>>>        // Witemxen.Witemxen_Rec0
50885>>>>>>>
50885>>>>>>>        // Witemxen.Witemxen_Hmnia
50885>>>>>>>        Set Field_Entry_msg        Field Witemxen.Witemxen_Hmnia To Shmera
50886>>>>>>>        Set Field_Mask_Type        Field Witemxen.Witemxen_Hmnia To MASK_DATE_WINDOW
50887>>>>>>>        Set Field_Prompt_Object    Field Witemxen.Witemxen_Hmnia To (sl185(Self))
50888>>>>>>>
50888>>>>>>>        // Witemxen.Witemxen_Descr
50888>>>>>>>
50888>>>>>>>        // Witemxen.Qty
50888>>>>>>>
50888>>>>>>>        // Witemxen.Wax_Recr
50888>>>>>>>        Set Field_Prompt_Object    Field Witemxen.Wax_Recr To (Wax(Self))
50889>>>>>>>
50889>>>>>>>        // Witemxen.Waxd_Recr
50889>>>>>>>        Set Field_Prompt_Object    Field Witemxen.Waxd_Recr To (Wax(Self))
50890>>>>>>>
50890>>>>>>>        // Witemxen.Wtypkin_Code
50890>>>>>>>        Set Field_Prompt_Object    Field Witemxen.Wtypkin_Code To (sl029a(Self))
50891>>>>>>>
50891>>>>>>>        // Witemxen.Wtypkind_Code
50891>>>>>>>        Set Field_Prompt_Object    Field Witemxen.Wtypkind_Code To (sl029a(Self))
50892>>>>>>>
50892>>>>>>>        // Witemxen.Status
50892>>>>>>>        Set Field_Class_Name       Field Witemxen.Status To "dbComboFormsub"
50893>>>>>>>        Set Field_Mask             Field Witemxen.Status To "#"
50894>>>>>>>        Set Field_Mask_Type        Field Witemxen.Status To MASK_NUMERIC_WINDOW
50895>>>>>>>        Set Field_Value_Table      Field Witemxen.Status To (Witemxen_Status_VT(Self))
50896>>>>>>>
50896>>>>>>>        // Witemxen.Ekleise
50896>>>>>>>
50896>>>>>>>        // Witemxen.Wcmoves_Recr
50896>>>>>>>
50896>>>>>>>        //DDB-DefineFieldEnd
50896>>>>>>>    End_Procedure    // Define_Fields
50897>>>>>>>
50897>>>>>>>    // Field_Defaults:
50897>>>>>>>    // This procedure is used to establish default field values.
50897>>>>>>>
50897>>>>>>>    Procedure Field_Defaults
50898>>>>>>>        Forward Send Field_Defaults
50900>>>>>>>        //DDB-Generated-Code-Location
50900>>>>>>>        //DDB-FieldDefaultStart
50900>>>>>>>        //DDB-FieldDefaultEnd
50900>>>>>>>    End_Procedure    // Field_Defaults
50901>>>>>>>
50901>>>>>>>End_Class    // Witemxen_DataDictionary
50902>>>>>>>//DDB-Selection-pkg-Start
50902>>>>>>>
50902>>>>>>>Use sl185.SL         // sl185
50902>>>>>>>Use wax.sl           // Wax
50902>>>>>>>Use sl029a.sl        // sl029a
50902>>>>>>>
50902>>>>>>>//DDB-Selection-pkg-End
50902>>>>>>>//DDB-FileEnd
50902>>>>>
50902>>>>>//AB-IgnoreEnd
50902>>>>>
50902>>>>>Object sl185 is a dbModalPanelSub
50904>>>>>
50904>>>>>    //AB-StoreTopStart
50904>>>>>    Function fnwhat integer code Returns string
50906>>>>>        string name
50907>>>>>        integer what
50907>>>>>        move code to what
50908>>>>>        if (what = 1);           move '¨æª ‘ç¤Ÿœ©ž' to name
50911>>>>>        else;           move '¨æª €§¦©ç¤Ÿœ©ž' to name
50913>>>>>        function_return name
50914>>>>>    end_Function
50915>>>>>    //AB-StoreTopEnd
50915>>>>>
50915>>>>>    Set Label to "„¬¨œ«ã¨ ¦ „¤«¦¢é¤ ˜¨˜šàšãª"
50916>>>>>    Set Size to 148 477
50917>>>>>    Set Location to 4 5
50918>>>>>    Set Exit_Application_Local_State to FALSE
50919>>>>>    Set Modal_State to FALSE
50920>>>>>
50920>>>>>    //AB-DDOStart
50920>>>>>
50920>>>>>    Object Units_DD is a Units_DataDictionary
50922>>>>>    End_Object    // Units_DD
50923>>>>>
50923>>>>>    Object Witemkat_DD is a Witemkat_DataDictionary
50925>>>>>    End_Object    // Witemkat_DD
50926>>>>>
50926>>>>>    Object Fpa_DD is a Fpa_DataDictionary
50928>>>>>    End_Object    // Fpa_DD
50929>>>>>
50929>>>>>    Object Item_DD is a Item_DataDictionary
50931>>>>>        Set DDO_Server to (Units_DD(self))
50932>>>>>        Set DDO_Server to (Witemkat_DD(self))
50933>>>>>        Set DDO_Server to (Fpa_DD(self))
50934>>>>>    End_Object    // Item_DD
50935>>>>>
50935>>>>>    Object Witemx_DD is a Witemx_DataDictionary
50937>>>>>        Set DDO_Server to (Item_DD(self))
50938>>>>>    End_Object    // Witemx_DD
50939>>>>>
50939>>>>>    Object Witemxen_DD is a Witemxen_DataDictionary
50941>>>>>        Set DDO_Server to (Witemx_DD(self))
50942>>>>>    End_Object    // Witemxen_DD
50943>>>>>
50943>>>>>    Set Main_DD to (Witemxen_DD(self))
50944>>>>>    Set Server to (Witemxen_DD(self))
50945>>>>>
50945>>>>>    //AB-DDOEnd
50945>>>>>
50945>>>>>    Object oSelList is a dbListSub
50947>>>>>        Set Main_File to Witemxen.File_Number
50948>>>>>        Set Server to (Witemx_DD(self))
50949>>>>>        Set Ordering to 3
50950>>>>>        Set Size to 105 460
50951>>>>>        Set Location to 6 6
50952>>>>>
50952>>>>>        Begin_Row
50955>>>>>            Entry_Item Witemxen.Witemxen_hmnia
50956>>>>>            Entry_Item Witemxen.Witemxen_recr
50957>>>>>            Entry_Item Witemxen.Witemxen_code
50958>>>>>            Entry_Item Witemx.Witemx_descr
50959>>>>>            Entry_Item (Fnwhat(self,witemxen.status))
50960>>>>>            Entry_Item Witemxen.Qty
50961>>>>>        End_Row
50966>>>>>
50966>>>>>        Set Form_Width    item 0 to 65
50967>>>>>        Set Header_Label  item 0 to "†£/¤å˜ „¤«¦¢é¤"
50968>>>>>        
50968>>>>>        Set Form_Width    item 1 to 56
50969>>>>>        Set Header_Label  item 1 to "€/˜ „¤«¦¢ãª"
50970>>>>>        
50970>>>>>        Set Form_Width    item 2 to 80
50971>>>>>        Set Header_Label  item 2 to "‰à› ¡æª „å›¦¬ª"
50972>>>>>        
50972>>>>>        Set Form_Width    item 3 to 120
50973>>>>>        Set Header_Label  item 3 to "œ¨ š¨˜­ã „å›¦¬ª"
50974>>>>>        
50974>>>>>        Set Form_Width    item 4 to 85
50975>>>>>        Set Header_Label  item 4 to "‰˜«žš¦¨å˜ „¤«¦¢ãª"
50976>>>>>        
50976>>>>>        Set Form_Width    item 5 to 46
50977>>>>>        Set Header_Label  item 5 to "¦©æ«ž«˜"
50978>>>>>        
50978>>>>>
50978>>>>>        //AB-StoreStart
50978>>>>>        set points of osellist item 5 to 1
50979>>>>>        
50979>>>>>        //AB-StoreEnd
50979>>>>>
50979>>>>>    End_Object    // oSelList
50980>>>>>
50980>>>>>    Object oOK_bn is a ButtonSub
50982>>>>>        Set Label to "&„§ ¢¦šã"
50983>>>>>        Set Location to 115 308
50984>>>>>
50984>>>>>        //AB-StoreStart
50984>>>>>        Procedure OnClick
50986>>>>>            Send OK To (oSelList(current_object))
50987>>>>>        End_Procedure
50988>>>>>        //AB-StoreEnd
50988>>>>>
50988>>>>>    End_Object    // oOK_bn
50989>>>>>
50989>>>>>    Object oCancel_bn is a ButtonSub
50991>>>>>        Set Label to "&€¡ç¨à©ž"
50992>>>>>        Set Location to 115 362
50993>>>>>
50993>>>>>        //AB-StoreStart
50993>>>>>        Procedure OnClick
50995>>>>>            Send Cancel To (oSelList(current_object))
50996>>>>>        End_Procedure
50997>>>>>        //AB-StoreEnd
50997>>>>>
50997>>>>>    End_Object    // oCancel_bn
50998>>>>>
50998>>>>>    Object oSearch_bn is a ButtonSub
51000>>>>>        Set Label to "€&¤˜ã«ž©ž..."
51001>>>>>        Set Location to 114 417
51002>>>>>
51002>>>>>        //AB-StoreStart
51002>>>>>        Procedure OnClick
51004>>>>>            Send Search To (oSelList(current_object))
51005>>>>>        End_Procedure
51006>>>>>        //AB-StoreEnd
51006>>>>>
51006>>>>>    End_Object    // oSearch_bn
51007>>>>>
51007>>>>>
51007>>>>>    //AB-StoreStart
51007>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
51008>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
51009>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
51010>>>>>    
51010>>>>>    //AB-StoreEnd
51010>>>>>
51010>>>>>End_Object    // sl185
51011>>>>>
51011>>>>>//AB/ End_Object    // prj
51011>>>Use sl22.sl
INCLUDING FILE: SL22.SL
51011>>>>>//AB/ Project sl22:kathgories apothkon
51011>>>>>//AB/     Object prj is a Lookup_Project
51011>>>>>//AB/         Set ProjectName to "sl22:kathgories apothkon"
51011>>>>>//AB/         Set ProjectFileName to "sl22.SL"
51011>>>>>//AB/         Set GenerateFileName to "NONAME"
51011>>>>>
51011>>>>>// Project Object Structure
51011>>>>>//   sl22 is a dbModalPanelSub
51011>>>>>//     Wapokat_DD is a DataDictionary
51011>>>>>//     oSelList is a dbListSub
51011>>>>>//     oOK_bn is a ButtonSub
51011>>>>>//     oCancel_bn is a ButtonSub
51011>>>>>//     oSearch_bn is a ButtonSub
51011>>>>>
51011>>>>>// Register all objects
51011>>>>>Register_Object oCancel_bn
51011>>>>>Register_Object oOK_bn
51011>>>>>Register_Object oSearch_bn
51011>>>>>Register_Object oSelList
51011>>>>>Register_Object sl22
51011>>>>>Register_Object Wapokat_DD
51011>>>>>
51011>>>>>
51011>>>>>    //AB-IgnoreStart
51011>>>>>
51011>>>>>    Use DFAllEnt.pkg
51011>>>>>    Use dbList.Sub
51011>>>>>    Use Button.Sub
51011>>>>>
51011>>>>>
51011>>>>>    Use WAPOKAT.DD
51011>>>>>    
51011>>>>>    //AB-IgnoreEnd
51011>>>>>
51011>>>>>    Object sl22 is a dbModalPanelSub
51013>>>>>        set label to "‰˜«žš¦¨åœª €§¦Ÿž¡é¤" 
51014>>>>>        Set Size to 148 297
51015>>>>>        Set Location to 4 5
51016>>>>>        Set Exit_Application_Local_State to FALSE
51017>>>>>        Set Modal_State to FALSE
51018>>>>>
51018>>>>>        //AB-DDOStart
51018>>>>>
51018>>>>>        Object Wapokat_DD is a Wapokat_DataDictionary
51020>>>>>        End_Object    // Wapokat_DD
51021>>>>>
51021>>>>>        Set Main_DD to (Wapokat_DD(self))
51022>>>>>        Set Server to (Wapokat_DD(self))
51023>>>>>
51023>>>>>        //AB-DDOEnd
51023>>>>>
51023>>>>>        Object oSelList is a dbListSub
51025>>>>>            Set Main_File to Wapokat.File_Number
51026>>>>>            Set Size to 105 280
51027>>>>>            Set Location to 6 6
51028>>>>>
51028>>>>>            Begin_Row
51031>>>>>                Entry_Item Wapokat.Wapokat_code
51032>>>>>                Entry_Item Wapokat.Wapokat_descr
51033>>>>>            End_Row
51038>>>>>
51038>>>>>            Set Form_Width    item 0 to 80
51039>>>>>            set header_label  item 0 to "‰à› ¡¦ª" 
51040>>>>>            
51040>>>>>            Set Form_Width    item 1 to 191
51041>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
51042>>>>>            
51042>>>>>        End_Object    // oSelList
51043>>>>>
51043>>>>>        Object oOK_bn is a ButtonSub
51045>>>>>            set label to "&„§ ¢¦šã" 
51046>>>>>            Set Location to 115 126
51047>>>>>
51047>>>>>            //AB-StoreStart
51047>>>>>            Procedure OnClick
51049>>>>>                Send OK To (oSelList(current_object))
51050>>>>>            End_Procedure
51051>>>>>            //AB-StoreEnd
51051>>>>>
51051>>>>>        End_Object    // oOK_bn
51052>>>>>
51052>>>>>        Object oCancel_bn is a ButtonSub
51054>>>>>            set label to "&€¡ç¨à©ž" 
51055>>>>>            Set Location to 115 181
51056>>>>>
51056>>>>>            //AB-StoreStart
51056>>>>>            Procedure OnClick
51058>>>>>                Send Cancel To (oSelList(current_object))
51059>>>>>            End_Procedure
51060>>>>>            //AB-StoreEnd
51060>>>>>
51060>>>>>        End_Object    // oCancel_bn
51061>>>>>
51061>>>>>        Object oSearch_bn is a ButtonSub
51063>>>>>            set label to "€&¤˜ã«ž©ž" 
51064>>>>>            Set Location to 115 236
51065>>>>>
51065>>>>>            //AB-StoreStart
51065>>>>>            Procedure OnClick
51067>>>>>                Send Search To (oSelList(current_object))
51068>>>>>            End_Procedure
51069>>>>>            //AB-StoreEnd
51069>>>>>
51069>>>>>        End_Object    // oSearch_bn
51070>>>>>
51070>>>>>
51070>>>>>        //AB-StoreStart
51070>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
51071>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
51072>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
51073>>>>>        //AB-StoreEnd
51073>>>>>
51073>>>>>    End_Object    // sl22
51074>>>>>
51074>>>>>//AB/     End_Object    // prj
51074>>>Use sl23.sl
INCLUDING FILE: SL23.SL
51074>>>>>//AB/ Project sl23: apothkes
51074>>>>>//AB/     Object prj is a Lookup_Project
51074>>>>>//AB/         Set ProjectName to "sl23: apothkes"
51074>>>>>//AB/         Set ProjectFileName to "sl23.SL"
51074>>>>>//AB/         Set GenerateFileName to "NONAME"
51074>>>>>
51074>>>>>// Project Object Structure
51074>>>>>//   sl23 is a dbModalPanelSub
51074>>>>>//     Wapokat_DD is a DataDictionary
51074>>>>>//     Wapomast_DD is a DataDictionary
51074>>>>>//     oSelList is a dbListSub
51074>>>>>//     oOK_bn is a ButtonSub
51074>>>>>//     oCancel_bn is a ButtonSub
51074>>>>>//     oSearch_bn is a ButtonSub
51074>>>>>
51074>>>>>// Register all objects
51074>>>>>Register_Object oCancel_bn
51074>>>>>Register_Object oOK_bn
51074>>>>>Register_Object oSearch_bn
51074>>>>>Register_Object oSelList
51074>>>>>Register_Object sl23
51074>>>>>Register_Object Wapokat_DD
51074>>>>>Register_Object Wapomast_DD
51074>>>>>
51074>>>>>
51074>>>>>    //AB-IgnoreStart
51074>>>>>
51074>>>>>    Use DFAllEnt.pkg
51074>>>>>    Use dbList.Sub
51074>>>>>    Use Button.Sub
51074>>>>>
51074>>>>>
51074>>>>>    Use WAPOKAT.DD
51074>>>>>    Use WAPOMAST.DD
51074>>>>>    
51074>>>>>    //AB-IgnoreEnd
51074>>>>>
51074>>>>>    Object sl23 is a dbModalPanelSub
51076>>>>>        set label to "€§¦Ÿã¡œª" 
51077>>>>>        Set Size to 148 285
51078>>>>>        Set Location to 4 5
51079>>>>>        Set Exit_Application_Local_State to FALSE
51080>>>>>        Set Modal_State to FALSE
51081>>>>>
51081>>>>>        //AB-DDOStart
51081>>>>>
51081>>>>>        Object Wapokat_DD is a Wapokat_DataDictionary
51083>>>>>        End_Object    // Wapokat_DD
51084>>>>>
51084>>>>>        Object Wapomast_DD is a Wapomast_DataDictionary
51086>>>>>            Set DDO_Server to (Wapokat_DD(self))
51087>>>>>        End_Object    // Wapomast_DD
51088>>>>>
51088>>>>>        Set Main_DD to (Wapomast_DD(self))
51089>>>>>        Set Server to (Wapomast_DD(self))
51090>>>>>
51090>>>>>        //AB-DDOEnd
51090>>>>>
51090>>>>>        Object oSelList is a dbListSub
51092>>>>>            Set Main_File to Wapomast.File_Number
51093>>>>>            Set Size to 105 269
51094>>>>>            Set Location to 6 6
51095>>>>>
51095>>>>>            Begin_Row
51098>>>>>                Entry_Item Wapomast.Wapomast_code
51099>>>>>                Entry_Item Wapomast.Wapomast_descr
51100>>>>>            End_Row
51105>>>>>
51105>>>>>            Set Form_Width    item 0 to 80
51106>>>>>            set header_label  item 0 to "€§¦Ÿã¡œª" 
51107>>>>>            
51107>>>>>            Set Form_Width    item 1 to 180
51108>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
51109>>>>>            
51109>>>>>        End_Object    // oSelList
51110>>>>>
51110>>>>>        Object oOK_bn is a ButtonSub
51112>>>>>            set label to "&„§ ¢¦šã" 
51113>>>>>            Set Location to 113 115
51114>>>>>
51114>>>>>            //AB-StoreStart
51114>>>>>            Procedure OnClick
51116>>>>>                Send OK To (oSelList(current_object))
51117>>>>>            End_Procedure
51118>>>>>            //AB-StoreEnd
51118>>>>>
51118>>>>>        End_Object    // oOK_bn
51119>>>>>
51119>>>>>        Object oCancel_bn is a ButtonSub
51121>>>>>            set label to "&€¡ç¨à©ž" 
51122>>>>>            Set Location to 113 170
51123>>>>>
51123>>>>>            //AB-StoreStart
51123>>>>>            Procedure OnClick
51125>>>>>                Send Cancel To (oSelList(current_object))
51126>>>>>            End_Procedure
51127>>>>>            //AB-StoreEnd
51127>>>>>
51127>>>>>        End_Object    // oCancel_bn
51128>>>>>
51128>>>>>        Object oSearch_bn is a ButtonSub
51130>>>>>            set label to "€&¤˜ã«ž©ž" 
51131>>>>>            Set Location to 113 225
51132>>>>>
51132>>>>>            //AB-StoreStart
51132>>>>>            Procedure OnClick
51134>>>>>                Send Search To (oSelList(current_object))
51135>>>>>            End_Procedure
51136>>>>>            //AB-StoreEnd
51136>>>>>
51136>>>>>        End_Object    // oSearch_bn
51137>>>>>
51137>>>>>
51137>>>>>        //AB-StoreStart
51137>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
51138>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
51139>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
51140>>>>>        //AB-StoreEnd
51140>>>>>
51140>>>>>    End_Object    // sl23
51141>>>>>
51141>>>>>//AB/     End_Object    // prj
51141>>>Use slNomism.sl
51141>>>Use CodeType.sl
INCLUDING FILE: CODETYPE.SL
51141>>>>>//AB/ Project CodeType LookUp
51141>>>>>//AB/     Object prj is a LOOKUP_Project
51141>>>>>//AB/         Set ProjectName to "CodeType LookUp"
51141>>>>>//AB/         Set ProjectFileName to "Codetype.sl"
51141>>>>>
51141>>>>>    //AB-IgnoreStart
51141>>>>>
51141>>>>>    USE AllentSc
51141>>>>>
51141>>>>>
51141>>>>>    Use CODETYPE.DD
INCLUDING FILE: CODETYPE.DD
51141>>>>>>>//DDB-FileStart
51141>>>>>>>//DDB-HeaderStart
51141>>>>>>>
51141>>>>>>>// File Name : CODETYPE.DD
51141>>>>>>>// Class Name: Codetype_DataDictionary
51141>>>>>>>// Revision  : 4
51141>>>>>>>// Version   : 2
51141>>>>>>>
51141>>>>>>>Use  Windows           // Basic Definitions
51141>>>>>>>Use  DataDict          // DataDictionary Class Definition
51141>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51141>>>>>>>
51141>>>>>>>Open Codetype
51143>>>>>>>Open Codemast
51145>>>>>>>
51145>>>>>>>//DDB-HeaderEnd
51145>>>>>>>//DDB-SelectionStart
51145>>>>>>>//DDB/ ExternalSelectionList CodeType_SL  codetype.sl
51145>>>>>>>Register_Object CodeType_SL
51145>>>>>>>//DDB-SelectionEnd
51145>>>>>>>
51145>>>>>>>Class Codetype_DataDictionary is a DataDictionary
51146>>>>>>>
51146>>>>>>>    // Disallow blank keys
51146>>>>>>>    Function Validate_Save Returns Integer
51147>>>>>>>        If CodeType.Type eq '' Begin
51149>>>>>>>            Error 300 '‰œ¤âª « £âª ›œ¤ œ§ «¨â§¦¤˜« .'
51150>>>>>>>>
51150>>>>>>>            Function_Return 1
51151>>>>>>>        End
51151>>>>>>>>
51151>>>>>>>    End_Function // Validate_Save
51152>>>>>>>
51152>>>>>>>    // Define_Fields:
51152>>>>>>>    // This procedure is used to set up all data-dictionary rules.
51152>>>>>>>
51152>>>>>>>    Procedure Define_Fields
51153>>>>>>>        Forward Send Define_Fields
51155>>>>>>>        //DDB-Generated-Code-Location
51155>>>>>>>        //DDB-DefineFieldStart
51155>>>>>>>
51155>>>>>>>        Set Main_File            To Codetype.File_Number
51156>>>>>>>        Set Cascade_Delete_State To FALSE
51157>>>>>>>
51157>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
51158>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
51159>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51160>>>>>>>
51160>>>>>>>        // Child (Client) file structure................
51160>>>>>>>        Send Add_Client_File  Codemast.File_Number
51161>>>>>>>
51161>>>>>>>        // Field-based properties.......................
51161>>>>>>>
51161>>>>>>>        // Codetype.Type
51161>>>>>>>        Set Field_Options          Field Codetype.Type To DD_AUTOFIND    DD_REQUIRED    DD_CAPSLOCK   
51162>>>>>>>        Set Field_Prompt_Object    Field Codetype.Type To (CodeType_SL(Self))
51163>>>>>>>        Set Key_Field_State        Field Codetype.Type To TRUE
51164>>>>>>>
51164>>>>>>>        // Codetype.Description
51164>>>>>>>        Set Field_Prompt_Object    Field Codetype.Description To (CodeType_SL(Self))
51165>>>>>>>
51165>>>>>>>        // Codetype.Comment
51165>>>>>>>        Set Status_Help            Field Codetype.Comment To "‹å˜ ˜¤˜¢¬« ¡æ«œ¨ž §œ¨ š¨˜­ã «žª ¡˜«žš¦¨å˜ª «¦¬ ¡à› ¡¦ç."
51166>>>>>>>
51166>>>>>>>        //DDB-DefineFieldEnd
51166>>>>>>>    End_Procedure    // Define_Fields
51167>>>>>>>
51167>>>>>>>    // Field_Defaults:
51167>>>>>>>    // This procedure is used to establish default field values.
51167>>>>>>>
51167>>>>>>>    Procedure Field_Defaults
51168>>>>>>>        Forward Send Field_Defaults
51170>>>>>>>        //DDB-Generated-Code-Location
51170>>>>>>>        //DDB-FieldDefaultStart
51170>>>>>>>        //DDB-FieldDefaultEnd
51170>>>>>>>    End_Procedure    // Field_Defaults
51171>>>>>>>End_Class    //  Codetype_DataDictionary
51172>>>>>>>//DDB-Selection-pkg-Start
51172>>>>>>>
51172>>>>>>>Use codetype.sl      // CodeType_SL
51172>>>>>>>
51172>>>>>>>//DDB-Selection-pkg-End
51172>>>>>>>//DDB-FileEnd
51172>>>>>
51172>>>>>    //AB-IgnoreEnd
51172>>>>>
51172>>>>>    CD_Popup_Object CodeType_SL is a dbModalPanelSub
51191>>>>>        Set Minimize_Icon to FALSE
51192>>>>>        set label to "€¨®œå¦ CODETYPE" 
51193>>>>>        Set Size to 151 264
51194>>>>>        Set Location to 5 5
51195>>>>>
51195>>>>>        //AB-DDOStart
51195>>>>>
51195>>>>>        Object Codetype_DD is a Codetype_DataDictionary
51197>>>>>        End_Object    // Codetype_DD
51198>>>>>
51198>>>>>        Set Main_DD to (Codetype_DD(Current_Object))
51199>>>>>        Set Server to (Codetype_DD(Current_Object))
51200>>>>>
51200>>>>>        //AB-DDOEnd
51200>>>>>
51200>>>>>        Object oSelList is a dbListSub
51202>>>>>            Set Main_File to Codetype.File_Number
51203>>>>>            Set Size to 105 247
51204>>>>>            Set Location to 6 6
51205>>>>>
51205>>>>>            Begin_Row
51208>>>>>                Entry_Item Codetype.Type
51209>>>>>                Entry_Item Codetype.Description
51210>>>>>            End_Row
51215>>>>>
51215>>>>>            Set Form_Width    item 0 to 60
51216>>>>>            set header_label  item 0 to "’ç§¦ª" 
51217>>>>>
51217>>>>>            Set Form_Width    item 1 to 180
51218>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
51219>>>>>
51219>>>>>        End_Object    // oSelList
51220>>>>>
51220>>>>>        Object oOK_bn is a ButtonSub
51222>>>>>            Set Default_State to TRUE
51223>>>>>            set label to "&„§ ¢¦šã" 
51224>>>>>            Set Location to 115 93
51225>>>>>
51225>>>>>            //AB-StoreStart
51225>>>>>            Procedure OnClick
51227>>>>>                Send OK To (oSelList(current_object))
51228>>>>>            End_Procedure
51229>>>>>            //AB-StoreEnd
51229>>>>>
51229>>>>>        End_Object    // oOK_bn
51230>>>>>
51230>>>>>        Object oCancel_bn is a ButtonSub
51232>>>>>            set label to "&€¡ç¨à©ž" 
51233>>>>>            Set Location to 115 148
51234>>>>>
51234>>>>>            //AB-StoreStart
51234>>>>>            Procedure OnClick
51236>>>>>                Send Cancel To (oSelList(current_object))
51237>>>>>            End_Procedure
51238>>>>>            //AB-StoreEnd
51238>>>>>
51238>>>>>        End_Object    // oCancel_bn
51239>>>>>
51239>>>>>        Object oSearch_bn is a ButtonSub
51241>>>>>            set label to "€&¤˜ã«ž©ž" 
51242>>>>>            Set Location to 115 203
51243>>>>>
51243>>>>>            //AB-StoreStart
51243>>>>>            Procedure OnClick
51245>>>>>                Send Search To (oSelList(current_object))
51246>>>>>            End_Procedure
51247>>>>>            //AB-StoreEnd
51247>>>>>
51247>>>>>        End_Object    // oSearch_bn
51248>>>>>
51248>>>>>
51248>>>>>        //AB-StoreStart
51248>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
51249>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
51250>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
51251>>>>>        //AB-StoreEnd
51251>>>>>
51251>>>>>    CD_End_Object    // CodeType_SL
51253>>>>>>
51253>>>>>
51253>>>>>//AB/     End_Object    // prj
51253>>>Use Fpa.sl
51253>>>Use Hmgio.sl
INCLUDING FILE: HMGIO.SL
51253>>>>>//AB/ Project Hmgio:Lookup
51253>>>>>//AB/ Object prj is a Lookup_Project
51253>>>>>//AB/     Set ProjectName to "Hmgio:Lookup"
51253>>>>>//AB/     Set ProjectFileName to "Hmgio.SL"
51253>>>>>//AB/     Set GenerateFileName to "NONAME"
51253>>>>>
51253>>>>>// Project Object Structure
51253>>>>>//   Hmgio is a dbModalPanelSub
51253>>>>>//     Hmgio_DD is a DataDictionary
51253>>>>>//     oSelList is a dbListSub
51253>>>>>//     oOK_bn is a ButtonSub
51253>>>>>//     oCancel_bn is a ButtonSub
51253>>>>>//     oSearch_bn is a ButtonSub
51253>>>>>
51253>>>>>// Register all objects
51253>>>>>Register_Object Hmgio
51253>>>>>Register_Object Hmgio_DD
51253>>>>>Register_Object oCancel_bn
51253>>>>>Register_Object oOK_bn
51253>>>>>Register_Object oSearch_bn
51253>>>>>Register_Object oSelList
51253>>>>>
51253>>>>>
51253>>>>>//AB-IgnoreStart
51253>>>>>
51253>>>>>Use DFAllEnt.pkg
51253>>>>>Use dbList.Sub
51253>>>>>Use Button.Sub
51253>>>>>
51253>>>>>
51253>>>>>Use HMGIO.DD
INCLUDING FILE: HMGIO.DD
51253>>>>>>>//DDB-FileStart
51253>>>>>>>//DDB-HeaderStart
51253>>>>>>>
51253>>>>>>>// File Name : HMGIO.DD
51253>>>>>>>// Class Name: Hmgio_DataDictionary
51253>>>>>>>// Revision  : 8
51253>>>>>>>// Version   : 2
51253>>>>>>>
51253>>>>>>>Use  Windows           // Basic Definitions
51253>>>>>>>Use  DataDict          // DataDictionary Class Definition
51253>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51253>>>>>>>
51253>>>>>>>Open Hmgio
INCLUDING FILE: HMGIO.FD
51255>>>>>>>Open Hmctyp
51257>>>>>>>Open Sysrecc
51259>>>>>>>
51259>>>>>>>//DDB-HeaderEnd
51259>>>>>>>//DDB-ValidationStart
51259>>>>>>>
51259>>>>>>>Register_Object Hmgio_Hmgio_Module_VT
51259>>>>>>>
51259>>>>>>>Object Hmgio_Hmgio_Module_VT  is a CodeValidationTable
51261>>>>>>>    Set Type_Value        To "MODULE"
51262>>>>>>>    Set Validate_State    To FALSE
51263>>>>>>>    Set Allow_Blank_State To TRUE
51264>>>>>>>    //DDB-ValidationCustomStart
51264>>>>>>>    //DDB-ValidationCustomEnd
51264>>>>>>>End_Object   // Hmgio_Hmgio_Module_VT
51265>>>>>>>//DDB-ValidationEnd
51265>>>>>>>//DDB-SelectionStart
51265>>>>>>>//DDB/ ExternalSelectionList Hmgio  Hmgio.SL
51265>>>>>>>Register_Object Hmgio
51265>>>>>>>//DDB-SelectionEnd
51265>>>>>>>
51265>>>>>>>Class Hmgio_DataDictionary  is a DataDictionary_Sec
51266>>>>>>>
51266>>>>>>>    // Define_Fields:
51266>>>>>>>    // This procedure is used to set up all data-dictionary rules.
51266>>>>>>>
51266>>>>>>>    Procedure Define_Fields
51267>>>>>>>        Forward Send Define_Fields
51269>>>>>>>        //DDB-Generated-Code-Location
51269>>>>>>>        //DDB-DefineFieldStart
51269>>>>>>>
51269>>>>>>>        Set Main_File            To Hmgio.File_Number
51270>>>>>>>        Set Cascade_Delete_State To FALSE
51271>>>>>>>
51271>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
51272>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
51273>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51274>>>>>>>
51274>>>>>>>        // Child (Client) file structure................
51274>>>>>>>        Send Add_Client_File  Hmctyp.File_Number
51275>>>>>>>
51275>>>>>>>        // External (System) file structure.............
51275>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
51276>>>>>>>
51276>>>>>>>        Define_Auto_Increment  Sysrecc.Hmgio_Code  To Hmgio.Hmgio_Code
51279>>>>>>>
51279>>>>>>>        // Field-based properties.......................
51279>>>>>>>
51279>>>>>>>        // Hmgio.Hmgio_Code
51279>>>>>>>        Set Field_Options          Field Hmgio.Hmgio_Code To DD_AUTOFIND   
51280>>>>>>>        Set Field_Prompt_Object    Field Hmgio.Hmgio_Code To (Hmgio(Self))
51281>>>>>>>        Set Key_Field_State        Field Hmgio.Hmgio_Code To TRUE
51282>>>>>>>
51282>>>>>>>        // Hmgio.Hmgio_Descr
51282>>>>>>>        Set Field_Prompt_Object    Field Hmgio.Hmgio_Descr To (Hmgio(Self))
51283>>>>>>>
51283>>>>>>>        // Hmgio.Hmgio_Module
51283>>>>>>>        Set Field_Value_Table      Field Hmgio.Hmgio_Module To (Hmgio_Hmgio_Module_VT(Self))
51284>>>>>>>
51284>>>>>>>        //DDB-DefineFieldEnd
51284>>>>>>>    End_Procedure    // Define_Fields
51285>>>>>>>
51285>>>>>>>    // Field_Defaults:
51285>>>>>>>    // This procedure is used to establish default field values.
51285>>>>>>>
51285>>>>>>>    Procedure Field_Defaults
51286>>>>>>>        Forward Send Field_Defaults
51288>>>>>>>        //DDB-Generated-Code-Location
51288>>>>>>>        //DDB-FieldDefaultStart
51288>>>>>>>        //DDB-FieldDefaultEnd
51288>>>>>>>    End_Procedure    // Field_Defaults
51289>>>>>>>
51289>>>>>>>End_Class    // Hmgio_DataDictionary
51290>>>>>>>//DDB-Selection-pkg-Start
51290>>>>>>>
51290>>>>>>>Use Hmgio.SL         // Hmgio
51290>>>>>>>
51290>>>>>>>//DDB-Selection-pkg-End
51290>>>>>>>//DDB-FileEnd
51290>>>>>
51290>>>>>//AB-IgnoreEnd
51290>>>>>
51290>>>>>Object Hmgio is a dbModalPanelSub
51292>>>>>
51292>>>>>    //AB-StoreTopStart
51292>>>>>    Property String psModule Public ''
51294>>>>>    
51294>>>>>    //AB-StoreTopEnd
51294>>>>>
51294>>>>>    Set Label to "†£œ¨¦¢æš ˜"
51295>>>>>    Set Size to 200 297
51296>>>>>    Set Location to 4 5
51297>>>>>    Set Exit_Application_Local_State to FALSE
51298>>>>>    Set Modal_State to FALSE
51299>>>>>
51299>>>>>    //AB-DDOStart
51299>>>>>
51299>>>>>    Object Hmgio_DD is a Hmgio_DataDictionary
51301>>>>>
51301>>>>>        //AB-StoreStart
51301>>>>>        Function fiEggrafh_OK Returns Integer
51303>>>>>            Integer rVal
51304>>>>>            String sModule
51304>>>>>            Get psModule to sModule
51305>>>>>            If ((hmgio.Hmgio_Module=smodule) Or (hmgio.Hmgio_Module='04')) Move 1 to rVal
51308>>>>>            Function_Return rVal
51309>>>>>        End_Function
51310>>>>>        
51310>>>>>        Begin_Constraints
51312>>>>>             Constrain hmgio as (fiEggrafh_OK(Self)=1)
51313>>>>>        End_Constraints
51316>>>>>        
51316>>>>>        
51316>>>>>        
51316>>>>>        
51316>>>>>        
51316>>>>>        //AB-StoreEnd
51316>>>>>
51316>>>>>    End_Object    // Hmgio_DD
51317>>>>>
51317>>>>>    Set Main_DD to (Hmgio_DD(self))
51318>>>>>    Set Server to (Hmgio_DD(self))
51319>>>>>
51319>>>>>    //AB-DDOEnd
51319>>>>>
51319>>>>>    Object oSelList is a dbListSub
51321>>>>>        Set Main_File to Hmgio.File_Number
51322>>>>>        Set Size to 161 280
51323>>>>>        Set Location to 6 6
51324>>>>>        Set Auto_Index_State to FALSE
51325>>>>>
51325>>>>>        Begin_Row
51328>>>>>            Entry_Item Hmgio.Hmgio_code
51329>>>>>            Entry_Item Hmgio.Hmgio_descr
51330>>>>>        End_Row
51335>>>>>
51335>>>>>        Set Form_Width    item 0 to 84
51336>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
51337>>>>>        
51337>>>>>        Set Form_Width    item 1 to 188
51338>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
51339>>>>>        
51339>>>>>
51339>>>>>        //AB-StoreStart
51339>>>>>                                    
51339>>>>>        Procedure Activate
51341>>>>>            Forward Send Activate
51343>>>>>            Send Rebuild_Constraints to Hmgio_DD
51344>>>>>            Send Beginning_Of_Data to oSelList True
51345>>>>>        End_Procedure
51346>>>>>        
51346>>>>>        //AB-StoreEnd
51346>>>>>
51346>>>>>    End_Object    // oSelList
51347>>>>>
51347>>>>>    Object oOK_bn is a ButtonSub
51349>>>>>        Set Label to "&„§ ¢¦šã"
51350>>>>>        Set Location to 169 131
51351>>>>>
51351>>>>>        //AB-StoreStart
51351>>>>>        Procedure OnClick
51353>>>>>            Send OK To (oSelList(current_object))
51354>>>>>        End_Procedure
51355>>>>>        //AB-StoreEnd
51355>>>>>
51355>>>>>    End_Object    // oOK_bn
51356>>>>>
51356>>>>>    Object oCancel_bn is a ButtonSub
51358>>>>>        Set Label to "&€¡ç¨à©ž"
51359>>>>>        Set Location to 169 185
51360>>>>>
51360>>>>>        //AB-StoreStart
51360>>>>>        Procedure OnClick
51362>>>>>            Send Cancel To (oSelList(current_object))
51363>>>>>        End_Procedure
51364>>>>>        //AB-StoreEnd
51364>>>>>
51364>>>>>    End_Object    // oCancel_bn
51365>>>>>
51365>>>>>    Object oSearch_bn is a ButtonSub
51367>>>>>        Set Label to "€&¤˜ã«ž©ž"
51368>>>>>        Set Location to 169 241
51369>>>>>
51369>>>>>        //AB-StoreStart
51369>>>>>        Procedure OnClick
51371>>>>>            Send Search To (oSelList(current_object))
51372>>>>>        End_Procedure
51373>>>>>        //AB-StoreEnd
51373>>>>>
51373>>>>>    End_Object    // oSearch_bn
51374>>>>>
51374>>>>>
51374>>>>>    //AB-StoreStart
51374>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
51375>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
51376>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
51377>>>>>    
51377>>>>>    //AB-StoreEnd
51377>>>>>
51377>>>>>End_Object    // Hmgio
51378>>>>>
51378>>>>>//AB/ End_Object    // prj
51378>>>Use Hmgiow.sl
INCLUDING FILE: HMGIOW.SL
51378>>>>>//AB/ Project HmgioW:Lookup
51378>>>>>//AB/     Object prj is a Lookup_Project
51378>>>>>//AB/         Set ProjectName to "HmgioW:Lookup"
51378>>>>>//AB/         Set ProjectFileName to "HmgioW.SL"
51378>>>>>//AB/         Set GenerateFileName to "NONAME"
51378>>>>>
51378>>>>>// Project Object Structure
51378>>>>>//   HmgioW is a dbModalPanelSub
51378>>>>>//     Hmgiow_DD is a DataDictionary
51378>>>>>//     oSelList is a dbListSub
51378>>>>>//     oOK_bn is a ButtonSub
51378>>>>>//     oCancel_bn is a ButtonSub
51378>>>>>//     oSearch_bn is a ButtonSub
51378>>>>>
51378>>>>>// Register all objects
51378>>>>>Register_Object HmgioW
51378>>>>>Register_Object Hmgiow_DD
51378>>>>>Register_Object oCancel_bn
51378>>>>>Register_Object oOK_bn
51378>>>>>Register_Object oSearch_bn
51378>>>>>Register_Object oSelList
51378>>>>>
51378>>>>>
51378>>>>>    //AB-IgnoreStart
51378>>>>>
51378>>>>>    Use DFAllEnt.pkg
51378>>>>>    Use dbList.Sub
51378>>>>>    Use Button.Sub
51378>>>>>
51378>>>>>
51378>>>>>    Use HMGIOW.DD
INCLUDING FILE: HMGIOW.DD
51378>>>>>>>//DDB-FileStart
51378>>>>>>>//DDB-HeaderStart
51378>>>>>>>
51378>>>>>>>// File Name : HMGIOW.DD
51378>>>>>>>// Class Name: Hmgiow_DataDictionary
51378>>>>>>>// Revision  : 3
51378>>>>>>>// Version   : 2
51378>>>>>>>
51378>>>>>>>Use  Windows           // Basic Definitions
51378>>>>>>>Use  DataDict          // DataDictionary Class Definition
51378>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51378>>>>>>>
51378>>>>>>>Open Hmgiow
INCLUDING FILE: HMGIOW.FD
51380>>>>>>>Open Hmwtyp
51382>>>>>>>Open Sysrecw
51384>>>>>>>
51384>>>>>>>//DDB-HeaderEnd
51384>>>>>>>//DDB-ValidationStart
51384>>>>>>>
51384>>>>>>>Register_Object Hmgiow_Hmgiow_Module_VT
51384>>>>>>>
51384>>>>>>>Object Hmgiow_Hmgiow_Module_VT  is a CodeValidationTable
51386>>>>>>>    Set Type_Value        To "MODULE"
51387>>>>>>>    //DDB-ValidationCustomStart
51387>>>>>>>    //DDB-ValidationCustomEnd
51387>>>>>>>End_Object   // Hmgiow_Hmgiow_Module_VT
51388>>>>>>>//DDB-ValidationEnd
51388>>>>>>>//DDB-SelectionStart
51388>>>>>>>//DDB/ ExternalSelectionList HmgioW  HmgioW.SL
51388>>>>>>>Register_Object HmgioW
51388>>>>>>>//DDB-SelectionEnd
51388>>>>>>>
51388>>>>>>>Class Hmgiow_DataDictionary  is a DataDictionary_Sec
51389>>>>>>>
51389>>>>>>>    // Define_Fields:
51389>>>>>>>    // This procedure is used to set up all data-dictionary rules.
51389>>>>>>>
51389>>>>>>>    Procedure Define_Fields
51390>>>>>>>        Forward Send Define_Fields
51392>>>>>>>        //DDB-Generated-Code-Location
51392>>>>>>>        //DDB-DefineFieldStart
51392>>>>>>>
51392>>>>>>>        Set Main_File            To Hmgiow.File_Number
51393>>>>>>>        Set Cascade_Delete_State To FALSE
51394>>>>>>>
51394>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
51395>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
51396>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51397>>>>>>>
51397>>>>>>>        // Child (Client) file structure................
51397>>>>>>>        Send Add_Client_File  Hmwtyp.File_Number
51398>>>>>>>
51398>>>>>>>        // External (System) file structure.............
51398>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
51399>>>>>>>
51399>>>>>>>        Define_Auto_Increment  Sysrecw.Hmgiow_Code  To Hmgiow.Hmgiow_Code
51402>>>>>>>
51402>>>>>>>        // Field-based properties.......................
51402>>>>>>>
51402>>>>>>>        // Hmgiow.Hmgiow_Code
51402>>>>>>>        Set Field_Options          Field Hmgiow.Hmgiow_Code To DD_AUTOFIND
51403>>>>>>>        Set Field_Prompt_Object    Field Hmgiow.Hmgiow_Code To (HmgioW(Self))
51404>>>>>>>
51404>>>>>>>        // Hmgiow.Hmgiow_Descr
51404>>>>>>>        Set Field_Options          Field Hmgiow.Hmgiow_Descr To DD_AUTOFIND
51405>>>>>>>        Set Field_Prompt_Object    Field Hmgiow.Hmgiow_Descr To (HmgioW(Self))
51406>>>>>>>
51406>>>>>>>        // Hmgiow.Hmgiow_Module
51406>>>>>>>        Set Field_Value_Table      Field Hmgiow.Hmgiow_Module To (Hmgiow_Hmgiow_Module_VT(Self))
51407>>>>>>>
51407>>>>>>>        //DDB-DefineFieldEnd
51407>>>>>>>    End_Procedure    // Define_Fields
51408>>>>>>>
51408>>>>>>>    // Field_Defaults:
51408>>>>>>>    // This procedure is used to establish default field values.
51408>>>>>>>
51408>>>>>>>    Procedure Field_Defaults
51409>>>>>>>        Forward Send Field_Defaults
51411>>>>>>>        //DDB-Generated-Code-Location
51411>>>>>>>        //DDB-FieldDefaultStart
51411>>>>>>>        //DDB-FieldDefaultEnd
51411>>>>>>>    End_Procedure    // Field_Defaults
51412>>>>>>>
51412>>>>>>>End_Class    // Hmgiow_DataDictionary
51413>>>>>>>//DDB-Selection-pkg-Start
51413>>>>>>>
51413>>>>>>>Use HmgioW.SL        // HmgioW
51413>>>>>>>
51413>>>>>>>//DDB-Selection-pkg-End
51413>>>>>>>//DDB-FileEnd
51413>>>>>    
51413>>>>>    //AB-IgnoreEnd
51413>>>>>
51413>>>>>    CD_Popup_Object HmgioW is a dbModalPanelSub
51432>>>>>
51432>>>>>        //AB-StoreTopStart
51432>>>>>        Property String psModule Public ''
51434>>>>>        
51434>>>>>        //AB-StoreTopEnd
51434>>>>>
51434>>>>>        set label to "†£œ¨¦¢æš ˜ €§¦Ÿã¡žª" 
51435>>>>>        Set Size to 148 297
51436>>>>>        Set Location to 5 9
51437>>>>>        Set Exit_Application_Local_State to FALSE
51438>>>>>        Set Modal_State to FALSE
51439>>>>>
51439>>>>>        //AB-DDOStart
51439>>>>>
51439>>>>>        Object Hmgiow_DD is a Hmgiow_DataDictionary
51441>>>>>        End_Object    // Hmgiow_DD
51442>>>>>
51442>>>>>        Set Main_DD to (Hmgiow_DD(self))
51443>>>>>        Set Server to (Hmgiow_DD(self))
51444>>>>>
51444>>>>>        //AB-DDOEnd
51444>>>>>
51444>>>>>        Object oSelList is a dbListSub
51446>>>>>            Set Main_File to Hmgiow.File_Number
51447>>>>>            Set Size to 105 280
51448>>>>>            Set Location to 6 6
51449>>>>>
51449>>>>>            Begin_Row
51452>>>>>                Entry_Item Hmgiow.Hmgiow_code
51453>>>>>                Entry_Item Hmgiow.Hmgiow_descr
51454>>>>>            End_Row
51459>>>>>
51459>>>>>            Set Form_Width    item 0 to 48
51460>>>>>            set header_label  item 0 to "‰à› ¡¦ª" 
51461>>>>>            
51461>>>>>            Set Form_Width    item 1 to 225
51462>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
51463>>>>>            
51463>>>>>        End_Object    // oSelList
51464>>>>>
51464>>>>>        Object oOK_bn is a ButtonSub
51466>>>>>            set label to "&„§ ¢¦šã" 
51467>>>>>            Set Location to 115 126
51468>>>>>
51468>>>>>            //AB-StoreStart
51468>>>>>            Procedure OnClick
51470>>>>>                Send OK To (oSelList(current_object))
51471>>>>>            End_Procedure
51472>>>>>            //AB-StoreEnd
51472>>>>>
51472>>>>>        End_Object    // oOK_bn
51473>>>>>
51473>>>>>        Object oCancel_bn is a ButtonSub
51475>>>>>            set label to "&€¡ç¨à©ž" 
51476>>>>>            Set Location to 115 181
51477>>>>>
51477>>>>>            //AB-StoreStart
51477>>>>>            Procedure OnClick
51479>>>>>                Send Cancel To (oSelList(current_object))
51480>>>>>            End_Procedure
51481>>>>>            //AB-StoreEnd
51481>>>>>
51481>>>>>        End_Object    // oCancel_bn
51482>>>>>
51482>>>>>        Object oSearch_bn is a ButtonSub
51484>>>>>            set label to "€&¤˜ã«ž©ž" 
51485>>>>>            Set Location to 115 236
51486>>>>>
51486>>>>>            //AB-StoreStart
51486>>>>>            Procedure OnClick
51488>>>>>                Send Search To (oSelList(current_object))
51489>>>>>            End_Procedure
51490>>>>>            //AB-StoreEnd
51490>>>>>
51490>>>>>        End_Object    // oSearch_bn
51491>>>>>
51491>>>>>
51491>>>>>        //AB-StoreStart
51491>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
51492>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
51493>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
51494>>>>>        
51494>>>>>        //AB-StoreEnd
51494>>>>>
51494>>>>>    CD_End_Object    // HmgioW
51496>>>>>>
51496>>>>>
51496>>>>>//AB/     End_Object    // prj
51496>>>Use Witemx.sl
INCLUDING FILE: WITEMX.SL
51496>>>>>//AB/ Project Witemx:Lookup Eidon Apothikhs
51496>>>>>//AB/     Object prj is a Lookup_Project
51496>>>>>//AB/         Set ProjectName to "Witemx:Lookup Eidon Apothikhs"
51496>>>>>//AB/         Set ProjectFileName to "Witemx.SL"
51496>>>>>//AB/         Set GenerateFileName to "NONAME"
51496>>>>>
51496>>>>>// Project Object Structure
51496>>>>>//   Witemx is a dbModalPanelSub
51496>>>>>//     Units_DD is a DataDictionary
51496>>>>>//     Witemkat_DD is a DataDictionary
51496>>>>>//     Item_DD is a DataDictionary
51496>>>>>//     Witemx_DD is a DataDictionary
51496>>>>>//     oSelList is a dbListSub
51496>>>>>//     oOK_bn is a ButtonSub
51496>>>>>//     oCancel_bn is a ButtonSub
51496>>>>>//     oSearch_bn is a ButtonSub
51496>>>>>
51496>>>>>// Register all objects
51496>>>>>Register_Object Item_DD
51496>>>>>Register_Object oCancel_bn
51496>>>>>Register_Object oOK_bn
51496>>>>>Register_Object oSearch_bn
51496>>>>>Register_Object oSelList
51496>>>>>Register_Object Units_DD
51496>>>>>Register_Object Witemkat_DD
51496>>>>>Register_Object Witemx
51496>>>>>Register_Object Witemx_DD
51496>>>>>
51496>>>>>
51496>>>>>    //AB-IgnoreStart
51496>>>>>
51496>>>>>    Use DFAllEnt.pkg
51496>>>>>    Use dbList.Sub
51496>>>>>    Use Button.Sub
51496>>>>>
51496>>>>>
51496>>>>>    Use UNITS.DD
51496>>>>>    Use WITEMKAT.DD
51496>>>>>    Use ITEM.DD
51496>>>>>    Use WITEMX.DD
51496>>>>>    
51496>>>>>    //AB-IgnoreEnd
51496>>>>>
51496>>>>>    CD_Popup_Object Witemx is a dbModalPanelSub
51515>>>>>        set label to "„ ›ž / Witemx" 
51516>>>>>        Set Size to 148 503
51517>>>>>        Set Location to 4 5
51518>>>>>        Set Exit_Application_Local_State to FALSE
51519>>>>>        Set Modal_State to FALSE
51520>>>>>
51520>>>>>        //AB-DDOStart
51520>>>>>
51520>>>>>        Object Units_DD is a Units_DataDictionary
51522>>>>>        End_Object    // Units_DD
51523>>>>>
51523>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
51525>>>>>        End_Object    // Witemkat_DD
51526>>>>>
51526>>>>>        Object Item_DD is a Item_DataDictionary
51528>>>>>            Set DDO_Server to (Units_DD(self))
51529>>>>>            Set DDO_Server to (Witemkat_DD(self))
51530>>>>>        End_Object    // Item_DD
51531>>>>>
51531>>>>>        Object Witemx_DD is a Witemx_DataDictionary
51533>>>>>            Set DDO_Server to (Item_DD(self))
51534>>>>>        End_Object    // Witemx_DD
51535>>>>>
51535>>>>>        Set Main_DD to (Witemx_DD(self))
51536>>>>>        Set Server to (Witemx_DD(self))
51537>>>>>
51537>>>>>        //AB-DDOEnd
51537>>>>>
51537>>>>>        Object oSelList is a dbListSub
51539>>>>>            Set Main_File to Witemx.File_Number
51540>>>>>            Set Size to 105 488
51541>>>>>            Set Location to 6 6
51542>>>>>
51542>>>>>            Begin_Row
51545>>>>>                Entry_Item Witemx.Witemx_recr
51546>>>>>                Entry_Item Witemx.Witemx_code
51547>>>>>                Entry_Item Witemx.Witemx_descr
51548>>>>>                entry_item units.units_descr 
51549>>>>>                Entry_Item Witemkat.Witemkat_descr
51550>>>>>                Entry_Item Item.Item_descr
51551>>>>>            End_Row
51556>>>>>
51556>>>>>            Set Form_Width    item 0 to 43
51557>>>>>            Set Header_Label  item 0 to "Recr"
51558>>>>>            
51558>>>>>            Set Form_Width    item 1 to 43
51559>>>>>            set header_label  item 1 to "‰à› ¡¦ª" 
51560>>>>>            
51560>>>>>            Set Form_Width    item 2 to 176
51561>>>>>            set header_label  item 2 to "œ¨ š¨˜­ã" 
51562>>>>>            
51562>>>>>            Set Form_Width    item 3 to 46
51563>>>>>            set header_label  item 3 to "‹/‹" 
51564>>>>>            
51564>>>>>            Set Form_Width    item 4 to 104
51565>>>>>            set header_label  item 4 to "‰˜«žš¦¨å˜   :" 
51566>>>>>            
51566>>>>>            Set Form_Width    item 5 to 69
51567>>>>>            set header_label  item 5 to "„ ›¦ª" 
51568>>>>>            
51568>>>>>        End_Object    // oSelList
51569>>>>>
51569>>>>>        Object oOK_bn is a ButtonSub
51571>>>>>            set label to "&„§ ¢¦šã" 
51572>>>>>            Set Location to 113 335
51573>>>>>
51573>>>>>            //AB-StoreStart
51573>>>>>            Procedure OnClick
51575>>>>>                Send OK To (oSelList(current_object))
51576>>>>>            End_Procedure
51577>>>>>            //AB-StoreEnd
51577>>>>>
51577>>>>>        End_Object    // oOK_bn
51578>>>>>
51578>>>>>        Object oCancel_bn is a ButtonSub
51580>>>>>            set label to "&€¡ç¨à©ž" 
51581>>>>>            Set Location to 113 390
51582>>>>>
51582>>>>>            //AB-StoreStart
51582>>>>>            Procedure OnClick
51584>>>>>                Send Cancel To (oSelList(current_object))
51585>>>>>            End_Procedure
51586>>>>>            //AB-StoreEnd
51586>>>>>
51586>>>>>        End_Object    // oCancel_bn
51587>>>>>
51587>>>>>        Object oSearch_bn is a ButtonSub
51589>>>>>            set label to "€&¤˜ã«ž©ž" 
51590>>>>>            Set Location to 113 445
51591>>>>>
51591>>>>>            //AB-StoreStart
51591>>>>>            Procedure OnClick
51593>>>>>                Send Search To (oSelList(current_object))
51594>>>>>            End_Procedure
51595>>>>>            //AB-StoreEnd
51595>>>>>
51595>>>>>        End_Object    // oSearch_bn
51596>>>>>
51596>>>>>
51596>>>>>        //AB-StoreStart
51596>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
51597>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
51598>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
51599>>>>>        //AB-StoreEnd
51599>>>>>
51599>>>>>    CD_End_Object    // Witemx
51601>>>>>>
51601>>>>>
51601>>>>>//AB/     End_Object    // prj
51601>>>Use Cities.sl
INCLUDING FILE: CITIES.SL
51601>>>>>//AB/ Project Cities:lookup
51601>>>>>//AB/ Object prj is a Lookup_Project
51601>>>>>//AB/     Set ProjectName to "Cities:lookup"
51601>>>>>//AB/     Set ProjectFileName to "Cities.SL"
51601>>>>>//AB/     Set GenerateFileName to "NONAME"
51601>>>>>
51601>>>>>// Project Object Structure
51601>>>>>//   Cities is a dbModalPanelSub
51601>>>>>//     Cities_DD is a DataDictionary
51601>>>>>//     oSelList is a dbListSub
51601>>>>>//     oOK_bn is a ButtonSub
51601>>>>>//     oCancel_bn is a ButtonSub
51601>>>>>//     oSearch_bn is a ButtonSub
51601>>>>>
51601>>>>>// Register all objects
51601>>>>>Register_Object Cities
51601>>>>>Register_Object Cities_DD
51601>>>>>Register_Object oCancel_bn
51601>>>>>Register_Object oOK_bn
51601>>>>>Register_Object oSearch_bn
51601>>>>>Register_Object oSelList
51601>>>>>
51601>>>>>
51601>>>>>//AB-IgnoreStart
51601>>>>>
51601>>>>>Use DFAllEnt.pkg
51601>>>>>Use dbList.Sub
51601>>>>>Use Button.Sub
51601>>>>>
51601>>>>>
51601>>>>>Use CITIES.DD
51601>>>>>
51601>>>>>//AB-IgnoreEnd
51601>>>>>
51601>>>>>CD_Popup_Object Cities is a dbModalPanelSub
51620>>>>>    Set Label to "Cities"
51621>>>>>    Set Size to 148 297
51622>>>>>    Set Location to 4 5
51623>>>>>    Set Exit_Application_Local_State to FALSE
51624>>>>>    Set Modal_State to FALSE
51625>>>>>
51625>>>>>    //AB-DDOStart
51625>>>>>
51625>>>>>    Object Cities_DD is a Cities_DataDictionary
51627>>>>>    End_Object    // Cities_DD
51628>>>>>
51628>>>>>    Set Main_DD to (Cities_DD(self))
51629>>>>>    Set Server to (Cities_DD(self))
51630>>>>>
51630>>>>>    //AB-DDOEnd
51630>>>>>
51630>>>>>    Object oSelList is a dbListSub
51632>>>>>        Set Main_File to Cities.File_Number
51633>>>>>        Set Size to 105 280
51634>>>>>        Set Location to 6 6
51635>>>>>
51635>>>>>        Begin_Row
51638>>>>>            Entry_Item Cities.City_id
51639>>>>>            Entry_Item Cities.City_descr
51640>>>>>        End_Row
51645>>>>>
51645>>>>>        Set Form_Width    item 0 to 52
51646>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
51647>>>>>        
51647>>>>>        Set Form_Width    item 1 to 221
51648>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
51649>>>>>        
51649>>>>>    End_Object    // oSelList
51650>>>>>
51650>>>>>    Object oOK_bn is a ButtonSub
51652>>>>>        set label to "&„§ ¢¦šã" 
51653>>>>>        Set Location to 115 126
51654>>>>>
51654>>>>>        //AB-StoreStart
51654>>>>>        Procedure OnClick
51656>>>>>            Send OK To (oSelList(current_object))
51657>>>>>        End_Procedure
51658>>>>>        //AB-StoreEnd
51658>>>>>
51658>>>>>    End_Object    // oOK_bn
51659>>>>>
51659>>>>>    Object oCancel_bn is a ButtonSub
51661>>>>>        set label to "&€¡ç¨à©ž" 
51662>>>>>        Set Location to 115 181
51663>>>>>
51663>>>>>        //AB-StoreStart
51663>>>>>        Procedure OnClick
51665>>>>>            Send Cancel To (oSelList(current_object))
51666>>>>>        End_Procedure
51667>>>>>        //AB-StoreEnd
51667>>>>>
51667>>>>>    End_Object    // oCancel_bn
51668>>>>>
51668>>>>>    Object oSearch_bn is a ButtonSub
51670>>>>>        set label to "€&¤˜ã«ž©ž" 
51671>>>>>        Set Location to 115 236
51672>>>>>
51672>>>>>        //AB-StoreStart
51672>>>>>        Procedure OnClick
51674>>>>>            Send Search To (oSelList(current_object))
51675>>>>>        End_Procedure
51676>>>>>        //AB-StoreEnd
51676>>>>>
51676>>>>>    End_Object    // oSearch_bn
51677>>>>>
51677>>>>>
51677>>>>>    //AB-StoreStart
51677>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
51678>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
51679>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
51680>>>>>    //AB-StoreEnd
51680>>>>>
51680>>>>>CD_End_Object    // Cities
51682>>>>>>
51682>>>>>
51682>>>>>//AB/ End_Object    // prj
51682>>>Use constrCn.sl
INCLUDING FILE: CONSTRCN.SL
51682>>>>>//AB/ Project CONSTRCN:LOOKUP
51682>>>>>//AB/ Object prj is a Lookup_Project
51682>>>>>//AB/     Set ProjectName to "CONSTRCN:LOOKUP"
51682>>>>>//AB/     Set ProjectFileName to "CONSTRCN.SL"
51682>>>>>
51682>>>>>// Project Object Structure
51682>>>>>//   CONSTRCN is a dbModalPanelSub
51682>>>>>//     Constrct_DD is a DataDictionary
51682>>>>>//     oSelList is a dbListSub
51682>>>>>//     oOK_bn is a ButtonSub
51682>>>>>//     oCancel_bn is a ButtonSub
51682>>>>>//     oSearch_bn is a ButtonSub
51682>>>>>
51682>>>>>// Register all objects
51682>>>>>Register_Object CONSTRCN
51682>>>>>Register_Object Constrct_DD
51682>>>>>Register_Object oCancel_bn
51682>>>>>Register_Object oOK_bn
51682>>>>>Register_Object oSearch_bn
51682>>>>>Register_Object oSelList
51682>>>>>
51682>>>>>
51682>>>>>//AB-IgnoreStart
51682>>>>>
51682>>>>>Use DFAllEnt.pkg
51682>>>>>Use dbList.Sub
51682>>>>>Use Button.Sub
51682>>>>>
51682>>>>>
51682>>>>>Use CONSTRCT.DD
INCLUDING FILE: CONSTRCT.DD
51682>>>>>>>//DDB-FileStart
51682>>>>>>>//DDB-HeaderStart
51682>>>>>>>
51682>>>>>>>// File Name : CONSTRCT.DD
51682>>>>>>>// Class Name: Constrct_DataDictionary
51682>>>>>>>// Revision  : 49
51682>>>>>>>// Version   : 2
51682>>>>>>>
51682>>>>>>>Use  Windows           // Basic Definitions
51682>>>>>>>Use  DataDict          // DataDictionary Class Definition
51682>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51682>>>>>>>
51682>>>>>>>Open Constrct
51684>>>>>>>Open Cn
51686>>>>>>>Open Sysrecc
51688>>>>>>>
51688>>>>>>>//DDB-HeaderEnd
51688>>>>>>>//DDB-ValidationStart
51688>>>>>>>
51688>>>>>>>Register_Object Constrct_Cnt_Doy_VT1
51688>>>>>>>
51688>>>>>>>Object Constrct_Cnt_Doy_VT1  is a CodeValidationTable
51690>>>>>>>    Set Type_Value        To "DOY"
51691>>>>>>>    Set Allow_Blank_State To TRUE
51692>>>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
51693>>>>>>>    //DDB-ValidationCustomStart
51693>>>>>>>    //DDB-ValidationCustomEnd
51693>>>>>>>End_Object   // Constrct_Cnt_Doy_VT1
51694>>>>>>>//DDB-ValidationEnd
51694>>>>>>>//DDB-SelectionStart
51694>>>>>>>//DDB/ ExternalSelectionList sl109  sl109.SL
51694>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
51694>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
51694>>>>>>>Register_Object sl109
51694>>>>>>>Register_Object sl198
51694>>>>>>>Register_Object sl197
51694>>>>>>>//DDB-SelectionEnd
51694>>>>>>>
51694>>>>>>>Class Constrct_DataDictionary  is a DataDictionary_Sec
51695>>>>>>>    Procedure Update
51696>>>>>>>        Forward Send Update
51698>>>>>>>        // Insert Code Here
51698>>>>>>>        Move SysCurXR.Company_Code  to constrct.Company_Code
51699>>>>>>>        Move SysCurXR.Branch_Code   to constrct.Branch_Code
51700>>>>>>>        Move SysCurXR.Year_Year     to constrct.Year_Year
51701>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
51701>>>>>>>        Move (constrct.Xreosh-Constrct.Pistosh)   to Constrct.Ypoloipo
51702>>>>>>>        Move (constrct.Plafon-Constrct.Ypoloipo)  to Constrct.Overhead
51703>>>>>>>
51703>>>>>>>        //betolink
51703>>>>>>>        Move SysCurXR.Beto_Site      to Constrct.cnt_SiteW
51704>>>>>>>        Move Constrct.cnt_Rec0        to Constrct.cnt_SN
51705>>>>>>>        Move Constrct.cnt_id          to constrct.cnt_Repm
51706>>>>>>>
51706>>>>>>>    End_Procedure   // Update
51707>>>>>>>
51707>>>>>>>     Procedure Creating
51708>>>>>>>        Forward Send Creating
51710>>>>>>>        // Insert Code Here
51710>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Constrct.cnt_Rec0))))));                                    to Constrct.Cnt_Recr
51711>>>>>>>        Move '1'                    to Constrct.Cnt_Active
51712>>>>>>>        Get fsgCode_With_Zeroes Constrct.Cnt_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to Constrct.cnt_ID
51713>>>>>>>    End_Procedure   // Creating
51714>>>>>>>
51714>>>>>>>
51714>>>>>>>    Procedure Define_Fields
51715>>>>>>>        Forward Send Define_Fields
51717>>>>>>>        //DDB-Generated-Code-Location
51717>>>>>>>        //DDB-DefineFieldStart
51717>>>>>>>
51717>>>>>>>        Set Main_File            To Constrct.File_Number
51718>>>>>>>        Set Cascade_Delete_State To FALSE
51719>>>>>>>
51719>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
51720>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
51721>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51722>>>>>>>
51722>>>>>>>        // Child (Client) file structure................
51722>>>>>>>        Send Add_Client_File  Cn.File_Number
51723>>>>>>>
51723>>>>>>>        // External (System) file structure.............
51723>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
51724>>>>>>>
51724>>>>>>>        Define_Auto_Increment  Sysrecc.Constrct_Rec0  To Constrct.Cnt_Rec0
51727>>>>>>>
51727>>>>>>>        // Field-based properties.......................
51727>>>>>>>
51727>>>>>>>        // Constrct.Company_Code
51727>>>>>>>
51727>>>>>>>        // Constrct.Branch_Code
51727>>>>>>>
51727>>>>>>>        // Constrct.Year_Year
51727>>>>>>>
51727>>>>>>>        // Constrct.Cnt_Id
51727>>>>>>>        Set Field_Options          Field Constrct.Cnt_Id To DD_AUTOFIND    DD_NOPUT      
51728>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_Id To (sl109(Self))
51729>>>>>>>        Set Key_Field_State        Field Constrct.Cnt_Id To TRUE
51730>>>>>>>
51730>>>>>>>        // Constrct.Cnt_Name
51730>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_Name To (sl109(Self))
51731>>>>>>>
51731>>>>>>>        // Constrct.Cnt_Afm
51731>>>>>>>
51731>>>>>>>        // Constrct.Cnt_Rec0
51731>>>>>>>
51731>>>>>>>        // Constrct.Cnt_Recr
51731>>>>>>>
51731>>>>>>>        // Constrct.Last_Xreosh
51731>>>>>>>
51731>>>>>>>        // Constrct.Last_Pistosh
51731>>>>>>>
51731>>>>>>>        // Constrct.Last_Order
51731>>>>>>>
51731>>>>>>>        // Constrct.Cnt_Doy
51731>>>>>>>        Set Field_Value_Table      Field Constrct.Cnt_Doy To (Constrct_Cnt_Doy_VT1(Self))
51732>>>>>>>
51732>>>>>>>        // Constrct.Cnt_Address
51732>>>>>>>
51732>>>>>>>        // Constrct.Cnt_City
51732>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_City To (sl198(Self))
51733>>>>>>>
51733>>>>>>>        // Constrct.Cnt_Area
51733>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_Area To (sl197(Self))
51734>>>>>>>
51734>>>>>>>        // Constrct.Cnt_Job
51734>>>>>>>
51734>>>>>>>        // Constrct.Cnt_Respons
51734>>>>>>>
51734>>>>>>>        // Constrct.Cnt_Zipcode
51734>>>>>>>
51734>>>>>>>        // Constrct.Cnt_Phone
51734>>>>>>>
51734>>>>>>>        // Constrct.Cnt_Fax
51734>>>>>>>
51734>>>>>>>        // Constrct.Cnt_Mobile
51734>>>>>>>
51734>>>>>>>        // Constrct.Cnt_Aoh
51734>>>>>>>
51734>>>>>>>        // Constrct.Cnt_Email
51734>>>>>>>
51734>>>>>>>        // Constrct.Cnt_Class
51734>>>>>>>
51734>>>>>>>        // Constrct.Cnt_Details
51734>>>>>>>
51734>>>>>>>        // Constrct.Cnt_Sitew
51734>>>>>>>
51734>>>>>>>        // Constrct.Cnt_Codem
51734>>>>>>>
51734>>>>>>>        // Constrct.Cnt_Categfpa
51734>>>>>>>
51734>>>>>>>        // Constrct.Cnt_Fpa
51734>>>>>>>
51734>>>>>>>        // Constrct.Cnt_Public
51734>>>>>>>
51734>>>>>>>        // Constrct.Cnt_Sn
51734>>>>>>>
51734>>>>>>>        // Constrct.Cnt_Repm
51734>>>>>>>
51734>>>>>>>        // Constrct.Cnt_Active
51734>>>>>>>
51734>>>>>>>        // Constrct.Cnt_Reported
51734>>>>>>>
51734>>>>>>>        // Constrct.Cnt_Pelprom
51734>>>>>>>
51734>>>>>>>        // Constrct.Cnt_Lastupdated
51734>>>>>>>
51734>>>>>>>        // Constrct.Cnt_Markexp
51734>>>>>>>
51734>>>>>>>        // Constrct.Cnt_Catjob
51734>>>>>>>
51734>>>>>>>        // Constrct.Xreosh
51734>>>>>>>
51734>>>>>>>        // Constrct.Pistosh
51734>>>>>>>
51734>>>>>>>        // Constrct.Ypoloipo
51734>>>>>>>
51734>>>>>>>        // Constrct.Plafon
51734>>>>>>>
51734>>>>>>>        // Constrct.Overhead
51734>>>>>>>
51734>>>>>>>        // Constrct.Cnt_Add_No
51734>>>>>>>
51734>>>>>>>        // Constrct.Cnt_Nomos
51734>>>>>>>
51734>>>>>>>        // Constrct.Cnt_Xora
51734>>>>>>>
51734>>>>>>>        // Constrct.Polh_Recr
51734>>>>>>>
51734>>>>>>>        //DDB-DefineFieldEnd
51734>>>>>>>    End_Procedure    // Define_Fields
51735>>>>>>>
51735>>>>>>>    // Field_Defaults:
51735>>>>>>>    // This procedure is used to establish default field values.
51735>>>>>>>
51735>>>>>>>    Procedure Field_Defaults
51736>>>>>>>        Forward Send Field_Defaults
51738>>>>>>>        //DDB-Generated-Code-Location
51738>>>>>>>        //DDB-FieldDefaultStart
51738>>>>>>>        Set Field_Changed_Value   Field Constrct.Cnt_Doy To "0"
51739>>>>>>>        //DDB-FieldDefaultEnd
51739>>>>>>>    End_Procedure    // Field_Defaults
51740>>>>>>>
51740>>>>>>>End_Class    // Constrct_DataDictionary
51741>>>>>>>//DDB-Selection-pkg-Start
51741>>>>>>>
51741>>>>>>>Use sl109.SL         // sl109
INCLUDING FILE: SL109.SL
51741>>>>>>>>>//AB/ Project sl109
51741>>>>>>>>>//AB/ Object prj is a Lookup_Project
51741>>>>>>>>>//AB/     Set ProjectName to "sl109"
51741>>>>>>>>>//AB/     Set ProjectFileName to "sl109.SL"
51741>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
51741>>>>>>>>>
51741>>>>>>>>>// Project Object Structure
51741>>>>>>>>>//   sl109 is a dbModalPanelSub
51741>>>>>>>>>//     Constrct_DD is a DataDictionary
51741>>>>>>>>>//     oSelList is a dbListSub
51741>>>>>>>>>//     oOK_bn is a ButtonSub
51741>>>>>>>>>//     oCancel_bn is a ButtonSub
51741>>>>>>>>>//     oSearch_bn is a ButtonSub
51741>>>>>>>>>
51741>>>>>>>>>// Register all objects
51741>>>>>>>>>Register_Object Constrct_DD
51741>>>>>>>>>Register_Object oCancel_bn
51741>>>>>>>>>Register_Object oOK_bn
51741>>>>>>>>>Register_Object oSearch_bn
51741>>>>>>>>>Register_Object oSelList
51741>>>>>>>>>Register_Object sl109
51741>>>>>>>>>
51741>>>>>>>>>
51741>>>>>>>>>//AB-IgnoreStart
51741>>>>>>>>>
51741>>>>>>>>>Use DFAllEnt.pkg
51741>>>>>>>>>Use dbList.Sub
51741>>>>>>>>>Use Button.Sub
51741>>>>>>>>>
51741>>>>>>>>>
51741>>>>>>>>>Use CONSTRCT.DD
51741>>>>>>>>>
51741>>>>>>>>>//AB-IgnoreEnd
51741>>>>>>>>>
51741>>>>>>>>>Object sl109 is a dbModalPanelSub
51743>>>>>>>>>    Set Label to "„¨š¦¢á™¦  "
51744>>>>>>>>>    Set Size to 148 427
51745>>>>>>>>>    Set Location to 4 5
51746>>>>>>>>>    Set Exit_Application_Local_State to FALSE
51747>>>>>>>>>    Set Modal_State to FALSE
51748>>>>>>>>>
51748>>>>>>>>>    //AB-DDOStart
51748>>>>>>>>>
51748>>>>>>>>>    Object Constrct_DD is a Constrct_DataDictionary
51750>>>>>>>>>    End_Object    // Constrct_DD
51751>>>>>>>>>
51751>>>>>>>>>    Set Main_DD to (Constrct_DD(self))
51752>>>>>>>>>    Set Server to (Constrct_DD(self))
51753>>>>>>>>>
51753>>>>>>>>>    //AB-DDOEnd
51753>>>>>>>>>
51753>>>>>>>>>    Object oSelList is a dbListSub
51755>>>>>>>>>        Set Main_File to Constrct.File_Number
51756>>>>>>>>>        Set Size to 105 415
51757>>>>>>>>>        Set Location to 6 6
51758>>>>>>>>>
51758>>>>>>>>>        Begin_Row
51761>>>>>>>>>            Entry_Item Constrct.Cnt_id
51762>>>>>>>>>            Entry_Item Constrct.Cnt_name
51763>>>>>>>>>            Entry_Item Constrct.Cnt_afm
51764>>>>>>>>>            Entry_Item Constrct.Cnt_address
51765>>>>>>>>>            Entry_Item Constrct.Cnt_phone
51766>>>>>>>>>        End_Row
51771>>>>>>>>>
51771>>>>>>>>>        Set Form_Width    item 0 to 70
51772>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
51773>>>>>>>>>        
51773>>>>>>>>>        Set Form_Width    item 1 to 100
51774>>>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
51775>>>>>>>>>        
51775>>>>>>>>>        Set Form_Width    item 2 to 50
51776>>>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
51777>>>>>>>>>        
51777>>>>>>>>>        Set Form_Width    item 3 to 135
51778>>>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
51779>>>>>>>>>        
51779>>>>>>>>>        Set Form_Width    item 4 to 52
51780>>>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
51781>>>>>>>>>        
51781>>>>>>>>>    End_Object    // oSelList
51782>>>>>>>>>
51782>>>>>>>>>    Object oOK_bn is a ButtonSub
51784>>>>>>>>>        Set Label to "&„§ ¢¦šã"
51785>>>>>>>>>        Set Location to 116 261
51786>>>>>>>>>
51786>>>>>>>>>        //AB-StoreStart
51786>>>>>>>>>        Procedure OnClick
51788>>>>>>>>>            Send OK To (oSelList(current_object))
51789>>>>>>>>>        End_Procedure
51790>>>>>>>>>        //AB-StoreEnd
51790>>>>>>>>>
51790>>>>>>>>>    End_Object    // oOK_bn
51791>>>>>>>>>
51791>>>>>>>>>    Object oCancel_bn is a ButtonSub
51793>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
51794>>>>>>>>>        Set Location to 116 315
51795>>>>>>>>>
51795>>>>>>>>>        //AB-StoreStart
51795>>>>>>>>>        Procedure OnClick
51797>>>>>>>>>            Send Cancel To (oSelList(current_object))
51798>>>>>>>>>        End_Procedure
51799>>>>>>>>>        //AB-StoreEnd
51799>>>>>>>>>
51799>>>>>>>>>    End_Object    // oCancel_bn
51800>>>>>>>>>
51800>>>>>>>>>    Object oSearch_bn is a ButtonSub
51802>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
51803>>>>>>>>>        Set Location to 116 371
51804>>>>>>>>>
51804>>>>>>>>>        //AB-StoreStart
51804>>>>>>>>>        Procedure OnClick
51806>>>>>>>>>            Send Search To (oSelList(current_object))
51807>>>>>>>>>        End_Procedure
51808>>>>>>>>>        //AB-StoreEnd
51808>>>>>>>>>
51808>>>>>>>>>    End_Object    // oSearch_bn
51809>>>>>>>>>
51809>>>>>>>>>
51809>>>>>>>>>    //AB-StoreStart
51809>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
51810>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
51811>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
51812>>>>>>>>>    //AB-StoreEnd
51812>>>>>>>>>
51812>>>>>>>>>End_Object    // sl109
51813>>>>>>>>>
51813>>>>>>>>>//AB/ End_Object    // prj
51813>>>>>>>Use sl198.sl         // sl198
51813>>>>>>>Use sl197.SL         // sl197
51813>>>>>>>
51813>>>>>>>//DDB-Selection-pkg-End
51813>>>>>>>//DDB-FileEnd
51813>>>>>
51813>>>>>//AB-IgnoreEnd
51813>>>>>
51813>>>>>CD_Popup_Object CONSTRCN is a dbModalPanelSub
51832>>>>>    Set Label to "Constructors"
51833>>>>>    Set Size to 148 423
51834>>>>>    Set Location to 6 6
51835>>>>>    Set Exit_Application_Local_State to FALSE
51836>>>>>    Set Modal_State to FALSE
51837>>>>>
51837>>>>>    //AB-DDOStart
51837>>>>>
51837>>>>>    Object Constrct_DD is a Constrct_DataDictionary
51839>>>>>    End_Object    // Constrct_DD
51840>>>>>
51840>>>>>    Set Main_DD to (Constrct_DD(self))
51841>>>>>    Set Server to (Constrct_DD(self))
51842>>>>>
51842>>>>>    //AB-DDOEnd
51842>>>>>
51842>>>>>    Object oSelList is a dbListSub
51844>>>>>        Set Main_File to Constrct.File_Number
51845>>>>>        Set Size to 105 406
51846>>>>>        Set Location to 6 6
51847>>>>>
51847>>>>>        Begin_Row
51850>>>>>            Entry_Item Constrct.Cnt_id
51851>>>>>            Entry_Item Constrct.Cnt_name
51852>>>>>            Entry_Item Constrct.Cnt_phone
51853>>>>>        End_Row
51858>>>>>
51858>>>>>        Set Form_Width    item 0 to 59
51859>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
51860>>>>>        
51860>>>>>        Set Form_Width    item 1 to 189
51861>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
51862>>>>>        
51862>>>>>        Set Form_Width    item 2 to 151
51863>>>>>        Set Header_Label  item 2 to "’ž¢â­à¤˜"
51864>>>>>        
51864>>>>>    End_Object    // oSelList
51865>>>>>
51865>>>>>    Object oOK_bn is a ButtonSub
51867>>>>>        Set Label to "&„§ ¢¦šã"
51868>>>>>        Set Location to 114 253
51869>>>>>
51869>>>>>        //AB-StoreStart
51869>>>>>        Procedure OnClick
51871>>>>>            Send OK To (oSelList(current_object))
51872>>>>>        End_Procedure
51873>>>>>        //AB-StoreEnd
51873>>>>>
51873>>>>>    End_Object    // oOK_bn
51874>>>>>
51874>>>>>    Object oCancel_bn is a ButtonSub
51876>>>>>        Set Label to "&€¡ç¨à©ž"
51877>>>>>        Set Location to 114 307
51878>>>>>
51878>>>>>        //AB-StoreStart
51878>>>>>        Procedure OnClick
51880>>>>>            Send Cancel To (oSelList(current_object))
51881>>>>>        End_Procedure
51882>>>>>        //AB-StoreEnd
51882>>>>>
51882>>>>>    End_Object    // oCancel_bn
51883>>>>>
51883>>>>>    Object oSearch_bn is a ButtonSub
51885>>>>>        Set Label to "€&¤˜ã«ž©ž"
51886>>>>>        Set Location to 114 363
51887>>>>>
51887>>>>>        //AB-StoreStart
51887>>>>>        Procedure OnClick
51889>>>>>            Send Search To (oSelList(current_object))
51890>>>>>        End_Procedure
51891>>>>>        //AB-StoreEnd
51891>>>>>
51891>>>>>    End_Object    // oSearch_bn
51892>>>>>
51892>>>>>
51892>>>>>    //AB-StoreStart
51892>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
51893>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
51894>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
51895>>>>>    //AB-StoreEnd
51895>>>>>
51895>>>>>CD_End_Object    // CONSTRCN
51897>>>>>>
51897>>>>>
51897>>>>>//AB/ End_Object    // prj
51897>>>
51897>>>
51897>        
51897>        Use bpMakeSx.dg
INCLUDING FILE: BPMAKESX.DG
51897>>>//AB/ Project bpMakeSx
51897>>>//AB/     Object prj is a Dialog_Project
51897>>>//AB/         Set ProjectName to "bpMakeSx"
51897>>>//AB/         Set ProjectFileName to "bpMakeSx.DG"
51897>>>//AB/         Set GenerateFileName to "NONAME"
51897>>>
51897>>>// Project Object Structure
51897>>>//   bpMakeSx is a BusinessProcessSub
51897>>>//     Ctypkin_DD is a DataDictionary
51897>>>//     Wtypkin_DD is a DataDictionary
51897>>>//     Ptyppar_DD is a DataDictionary
51897>>>//     Country_DD is a DataDictionary
51897>>>//     Towns_DD is a DataDictionary
51897>>>//     Cities_DD is a DataDictionary
51897>>>//     Areas_DD is a DataDictionary
51897>>>//     Payresp_DD is a DataDictionary
51897>>>//     Clients_DD is a DataDictionary
51897>>>//     Nomisma_DD is a DataDictionary
51897>>>//     Particle_DD is a DataDictionary
51897>>>//     Wapokat_DD is a DataDictionary
51897>>>//     Wapomast_DD is a DataDictionary
51897>>>//     Wax_DD is a DataDictionary
51897>>>//     Units_DD is a DataDictionary
51897>>>//     Witemkat_DD is a DataDictionary
51897>>>//     Fpa_DD is a DataDictionary
51897>>>//     Item_DD is a DataDictionary
51897>>>//     Witemx_DD is a DataDictionary
51897>>>//     Pmoves_DD is a DataDictionary
51897>>>//     Pmssxet_DD is a DataDictionary
51897>>>//     Psxetika_DD is a DataDictionary
51897>>>
51897>>>// Register all objects
51897>>>Register_Object Areas_DD
51897>>>Register_Object bpMakeSx
51897>>>Register_Object Cities_DD
51897>>>Register_Object Clients_DD
51897>>>Register_Object Country_DD
51897>>>Register_Object Ctypkin_DD
51897>>>Register_Object Fpa_DD
51897>>>Register_Object Item_DD
51897>>>Register_Object Nomisma_DD
51897>>>Register_Object Particle_DD
51897>>>Register_Object Payresp_DD
51897>>>Register_Object Pmoves_DD
51897>>>Register_Object Pmssxet_DD
51897>>>Register_Object Psxetika_DD
51897>>>Register_Object Ptyppar_DD
51897>>>Register_Object Towns_DD
51897>>>Register_Object Units_DD
51897>>>Register_Object Wapokat_DD
51897>>>Register_Object Wapomast_DD
51897>>>Register_Object Wax_DD
51897>>>Register_Object Witemkat_DD
51897>>>Register_Object Witemx_DD
51897>>>Register_Object Wtypkin_DD
51897>>>
51897>>>
51897>>>
51897>>>    //AB-StoreTopStart
51897>>>
51897>>>
51897>>>    //AB-StoreTopEnd
51897>>>
51897>>>    //AB-IgnoreStart
51897>>>
51897>>>    Use Bproces.Sub
51897>>>    Use DFAllEnt.pkg
51897>>>
51897>>>
51897>>>    Use CTYPKIN.DD
51897>>>    Use WTYPKIN.DD
51897>>>    Use PTYPPAR.DD
51897>>>    Use COUNTRY.DD
51897>>>    Use TOWNS.DD
51897>>>    Use CITIES.DD
51897>>>    Use AREAS.DD
51897>>>    Use PAYRESP.DD
51897>>>    Use CLIENTS.DD
51897>>>    Use NOMISMA.DD
51897>>>    Use PARTICLE.DD
51897>>>    Use PSXETIKA.DD
INCLUDING FILE: PSXETIKA.DD
51897>>>>>//DDB-FileStart
51897>>>>>//DDB-HeaderStart
51897>>>>>
51897>>>>>// File Name : PSXETIKA.DD
51897>>>>>// Class Name: Psxetika_DataDictionary
51897>>>>>// Revision  : 14
51897>>>>>// Version   : 2
51897>>>>>
51897>>>>>Use  Windows           // Basic Definitions
51897>>>>>Use  DataDict          // DataDictionary Class Definition
51897>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51897>>>>>
51897>>>>>Open Psxetika
51899>>>>>Open Particle
51901>>>>>Open Sysrecp
51903>>>>>
51903>>>>>//DDB-HeaderEnd
51903>>>>>
51903>>>>>Class Psxetika_DataDictionary  is a DataDictionary_Sec
51904>>>>>
51904>>>>>    Procedure Creating
51905>>>>>        Integer iNextNo
51906>>>>>        Forward Send Creating
51908>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Psxetika.Psxetika_Rec0)))))) to Psxetika.Psxetika_Recr
51909>>>>>    End_Procedure   // Creating
51910>>>>>
51910>>>>>    Procedure Update
51911>>>>>        Forward Send Update
51913>>>>>        Move SysCurXR.Company_Code  to Psxetika.Company_Code
51914>>>>>        Move SysCurXR.Branch_Code   to Psxetika.Branch_Code
51915>>>>>        Move SysCurXR.Year_Year     to Psxetika.Year_Year
51916>>>>>        Move Clients.Client_ID      to Psxetika.Client_ID
51917>>>>>        Move Ctypkin.Ctypkin_Code   to Psxetika.Ctypkin_Code
51918>>>>>        Move Wtypkin.Wtypkin_Code   to Psxetika.Wtypkin_Code
51919>>>>>        Move Ptyppar.Ptyppar_Code   to Psxetika.Ptyppar_Code
51920>>>>>        Move Particle.Partl_Hmnia   to Psxetika.Partl_Hmnia
51921>>>>>        Move Particle.Pseira_Seira  to Psxetika.Pseira_Seira
51922>>>>>        Move Particle.Partl_No      to Psxetika.Partl_No
51923>>>>>    End_Procedure   // Update
51924>>>>>
51924>>>>>//    gts 08-06-06 mallon den xriazete
51924>>>>>//    Procedure Request_Save
51924>>>>>//        Number  nQty
51924>>>>>//        String  sParticleRecr sPsxetikaRecr
51924>>>>>//
51924>>>>>//        Forward Send Request_Save
51924>>>>>//
51924>>>>>//        Get File_Field_Current_Value File_Field Particle.Partl_Recr     to sParticleRecr
51924>>>>>//        Get File_Field_Current_Value File_Field Psxetika.Psx_Partl_Recr to sPsxetikaRecr
51924>>>>>//        If ((Trim(sParticleRecr)<>'') And (Trim(sPsxetikaRecr)<>'')) Begin
51924>>>>>//            Get File_Field_Current_Value File_Field Psxetika.Pms_Sx_Qty to nQty
51924>>>>>//            If (nQty=0) Begin
51924>>>>>//                // An h posothta pou menei apo to athroisma posothtas ton Pmoves Sxetika
51924>>>>>//                // Mhdenisei, ayto shmainei pos den yparxoun alla Pmoves Sxetika, ara
51924>>>>>//                // prepei na diagrafei ayto to Psxetika record kai to antistrofo tou.
51924>>>>>//                Delete Psxetika
51924>>>>>//                Clear Psxetika
51924>>>>>//                Move sPsxetikaRecr  to Psxetika.Partl_Recr
51924>>>>>//                Move sParticleRecr  to Psxetika.Psx_Partl_Recr
51924>>>>>//                Find Eq Psxetika by Index.4
51924>>>>>//                If (Found) Delete Psxetika
51924>>>>>//            End
51924>>>>>//        End
51924>>>>>//    End_Procedure
51924>>>>>
51924>>>>>
51924>>>>>    // Define_Fields:
51924>>>>>    // This procedure is used to set up all data-dictionary rules.
51924>>>>>
51924>>>>>    Procedure Define_Fields
51925>>>>>        Forward Send Define_Fields
51927>>>>>        //DDB-Generated-Code-Location
51927>>>>>        //DDB-DefineFieldStart
51927>>>>>
51927>>>>>        Set Main_File            To Psxetika.File_Number
51928>>>>>
51928>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
51929>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
51930>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51931>>>>>
51931>>>>>        // Parent (Server) file structure...............
51931>>>>>        Send Add_Server_File  Particle.File_Number
51932>>>>>
51932>>>>>        // External (System) file structure.............
51932>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
51933>>>>>
51933>>>>>        Define_Auto_Increment  Sysrecp.Psxetika_Rec0  To Psxetika.Psxetika_Rec0
51936>>>>>
51936>>>>>        // Field-based properties.......................
51936>>>>>
51936>>>>>        // Psxetika.Company_Code
51936>>>>>
51936>>>>>        // Psxetika.Branch_Code
51936>>>>>
51936>>>>>        // Psxetika.Year_Year
51936>>>>>
51936>>>>>        // Psxetika.Ctypkin_Code
51936>>>>>
51936>>>>>        // Psxetika.Wtypkin_Code
51936>>>>>
51936>>>>>        // Psxetika.Ptyppar_Code
51936>>>>>
51936>>>>>        // Psxetika.Pseira_Seira
51936>>>>>
51936>>>>>        // Psxetika.Custprom_Code
51936>>>>>
51936>>>>>        // Psxetika.Client_Id
51936>>>>>
51936>>>>>        // Psxetika.Partl_No
51936>>>>>
51936>>>>>        // Psxetika.Partl_Hmnia
51936>>>>>
51936>>>>>        // Psxetika.Partl_Recr
51936>>>>>
51936>>>>>        // Psxetika.Psx_Partl_Recr
51936>>>>>
51936>>>>>        // Psxetika.Psxetika_Recr
51936>>>>>
51936>>>>>        // Psxetika.Psxetika_Rec0
51936>>>>>
51936>>>>>        // Psxetika.Sx_Company_Code
51936>>>>>
51936>>>>>        // Psxetika.Sx_Branch_Code
51936>>>>>
51936>>>>>        // Psxetika.Sx_Year_Year
51936>>>>>
51936>>>>>        // Psxetika.Sx_Ctypkin_Code
51936>>>>>
51936>>>>>        // Psxetika.Sx_Wtypkin_Code
51936>>>>>
51936>>>>>        // Psxetika.Sx_Ptyppar_Code
51936>>>>>
51936>>>>>        // Psxetika.Sx_Pseira_Seira
51936>>>>>
51936>>>>>        // Psxetika.Sx_Custpromcode
51936>>>>>
51936>>>>>        // Psxetika.Sx_Client_Id
51936>>>>>
51936>>>>>        // Psxetika.Sx_Partl_No
51936>>>>>
51936>>>>>        // Psxetika.Sx_Partl_Hmnia
51936>>>>>
51936>>>>>        // Psxetika.Sx_Ctypkin_Desc
51936>>>>>
51936>>>>>        // Psxetika.Sx_Wtypkin_Desc
51936>>>>>
51936>>>>>        // Psxetika.Sx_Ptyppar_Desc
51936>>>>>
51936>>>>>        // Psxetika.Sx_Custpromdesc
51936>>>>>
51936>>>>>        // Psxetika.Sx_Client_Desc
51936>>>>>
51936>>>>>        // Psxetika.Pms_Sx_Qty
51936>>>>>
51936>>>>>        //DDB-DefineFieldEnd
51936>>>>>    End_Procedure    // Define_Fields
51937>>>>>
51937>>>>>    // Field_Defaults:
51937>>>>>    // This procedure is used to establish default field values.
51937>>>>>
51937>>>>>    Procedure Field_Defaults
51938>>>>>        Forward Send Field_Defaults
51940>>>>>        //DDB-Generated-Code-Location
51940>>>>>        //DDB-FieldDefaultStart
51940>>>>>        //DDB-FieldDefaultEnd
51940>>>>>    End_Procedure    // Field_Defaults
51941>>>>>
51941>>>>>End_Class    // Psxetika_DataDictionary
51942>>>>>//DDB-FileEnd
51942>>>
51942>>>    //AB-IgnoreEnd
51942>>>
51942>>>    Object bpMakeSx is a BusinessProcessSub
51944>>>
51944>>>        //AB-StoreTopStart
51944>>>
51944>>>        Property String     psParticleRecr  Public ''
51946>>>        Property String     psSxPartlRecr   Public ''
51948>>>        Property Integer    piLathos        Public  0
51950>>>        Property Number     pnQty           Public  0
51952>>>
51952>>>        Set Status_Panel_State to False
51953>>>        //Set Allow_Cancel_State  to True
51953>>>        Set Display_Error_State to True
51954>>>        //Set Process_Title to "               "
51954>>>        //Set Status_Log_id to (status_log(Self)) //Use statlog.pkg
51954>>>        //Set Status_log_state to True
51954>>>
51954>>>        Use MyArray.dg
INCLUDING FILE: MYARRAY.DG
51954>>>>>//AB/ Project MyArray
51954>>>>>//AB/     Object prj is a Dialog_Project
51954>>>>>//AB/         Set ProjectName to "MyArray"
51954>>>>>//AB/         Set ProjectFileName to "MyArray.DG"
51954>>>>>//AB/         Set GenerateFileName to "NONAME"
51954>>>>>
51954>>>>>// Project Object Structure
51954>>>>>//   Psx_Array is a BusinessProcessSub
51954>>>>>//     Ctypkin_DD2 is a Ctypkin_DataDictionary
51954>>>>>//     Wtypkin_DD2 is a Wtypkin_DataDictionary
51954>>>>>//     Ptyppar_DD2 is a Ptyppar_DataDictionary
51954>>>>>//     Country_DD2 is a Country_DataDictionary
51954>>>>>//     Towns_DD2 is a Towns_DataDictionary
51954>>>>>//     Cities_DD2 is a Cities_DataDictionary
51954>>>>>//     Areas_DD2 is a Areas_DataDictionary
51954>>>>>//     Payresp_DD2 is a Payresp_DataDictionary
51954>>>>>//     Clients_DD2 is a Clients_DataDictionary
51954>>>>>//     Nomisma_DD2 is a Nomisma_DataDictionary
51954>>>>>//     Particle_DD2 is a Particle_DataDictionary
51954>>>>>//     Ctypkin_DD is a Ctypkin_DataDictionary
51954>>>>>//     Wtypkin_DD is a Wtypkin_DataDictionary
51954>>>>>//     Ptyppar_DD is a Ptyppar_DataDictionary
51954>>>>>//     Country_DD is a Country_DataDictionary
51954>>>>>//     Towns_DD is a Towns_DataDictionary
51954>>>>>//     Cities_DD is a Cities_DataDictionary
51954>>>>>//     Areas_DD is a Areas_DataDictionary
51954>>>>>//     Payresp_DD is a Payresp_DataDictionary
51954>>>>>//     Clients_DD is a Clients_DataDictionary
51954>>>>>//     Nomisma_DD is a Nomisma_DataDictionary
51954>>>>>//     Particle_DD is a Particle_DataDictionary
51954>>>>>//     Psxetika_DD is a Psxetika_DataDictionary
51954>>>>>
51954>>>>>// Register all objects
51954>>>>>Register_Object Areas_DD
51954>>>>>Register_Object Areas_DD2
51954>>>>>Register_Object Cities_DD
51954>>>>>Register_Object Cities_DD2
51954>>>>>Register_Object Clients_DD
51954>>>>>Register_Object Clients_DD2
51954>>>>>Register_Object Country_DD
51954>>>>>Register_Object Country_DD2
51954>>>>>Register_Object Ctypkin_DD
51954>>>>>Register_Object Ctypkin_DD2
51954>>>>>Register_Object Nomisma_DD
51954>>>>>Register_Object Nomisma_DD2
51954>>>>>Register_Object Particle_DD
51954>>>>>Register_Object Particle_DD2
51954>>>>>Register_Object Payresp_DD
51954>>>>>Register_Object Payresp_DD2
51954>>>>>Register_Object Psx_Array
51954>>>>>Register_Object Psxetika_DD
51954>>>>>Register_Object Ptyppar_DD
51954>>>>>Register_Object Ptyppar_DD2
51954>>>>>Register_Object Towns_DD
51954>>>>>Register_Object Towns_DD2
51954>>>>>Register_Object Wtypkin_DD
51954>>>>>Register_Object Wtypkin_DD2
51954>>>>>
51954>>>>>
51954>>>>>
51954>>>>>    //AB-StoreTopStart
51954>>>>>
51954>>>>>    Use CTYPKIN.DD
51954>>>>>    Use WTYPKIN.DD
51954>>>>>    Use PTYPPAR.DD
51954>>>>>    Use PSEIRA.DD
51954>>>>>    Use NOMISMA.DD
51954>>>>>    Use COUNTRY.DD
51954>>>>>    Use TOWNS.DD
51954>>>>>    Use CITIES.DD
51954>>>>>    Use PAYRESP.DD
51954>>>>>    Use AREAS.DD
51954>>>>>    Use CLIENTS.DD
51954>>>>>    Use PARTICLE.DD
51954>>>>>    Use WAPOKAT.DD
51954>>>>>    Use WAPOMAST.DD
51954>>>>>    Use WAX.DD
51954>>>>>    Use UNITS.DD
51954>>>>>    Use WITEMKAT.DD
51954>>>>>    Use FPA.DD
51954>>>>>    Use ITEM.DD
51954>>>>>    Use WITEMX.DD
51954>>>>>    Use PMOVES.DD
INCLUDING FILE: PMOVES.DD
51954>>>>>>>//DDB-FileStart
51954>>>>>>>//DDB-HeaderStart
51954>>>>>>>
51954>>>>>>>// File Name : PMOVES.DD
51954>>>>>>>// Class Name: Pmoves_DataDictionary
51954>>>>>>>// Revision  : 162
51954>>>>>>>// Version   : 2
51954>>>>>>>
51954>>>>>>>Use  Windows           // Basic Definitions
51954>>>>>>>Use  DataDict          // DataDictionary Class Definition
51954>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51954>>>>>>>
51954>>>>>>>Open Pmoves
51956>>>>>>>Open Pmsdtl
INCLUDING FILE: PMSDTL.FD
51958>>>>>>>Open Wax
51960>>>>>>>Open Witemx
51962>>>>>>>Open Particle
51964>>>>>>>Open Sysrecp
51966>>>>>>>Open Syscurxr
51968>>>>>>>Open Partlfpa
51970>>>>>>>Open Clorder
51972>>>>>>>Open Clorderd
51974>>>>>>>Open Btnemp
INCLUDING FILE: BTNEMP.FD
51976>>>>>>>Open Gmove
51978>>>>>>>Open Sysrecg
51980>>>>>>>
51980>>>>>>>//DDB-HeaderEnd
51980>>>>>>>Open Fpa
51982>>>>>>>Open PartlFpa
51984>>>>>>>Open Item
51986>>>>>>>Open Wtypkin
51988>>>>>>>Open Witemkat
51990>>>>>>>Open Wapomast
51992>>>>>>>Open Wapokat
51994>>>>>>>Open Payresp
51996>>>>>>>
51996>>>>>>>Class Pmoves_DataDictionary  is a DataDictionary_Sec
51997>>>>>>>
51997>>>>>>>
51997>>>>>>>    Procedure Construct_Object
51998>>>>>>>        Forward Send Construct_Object
52000>>>>>>>        Property Number  pnoQty         Public  0
52001>>>>>>>        Property integer pifromclorder  Public  0
52002>>>>>>>        Property Integer piCheckZeroFpa Public  0
52003>>>>>>>        Property Integer piPmsSxetID    Public  0
52004>>>>>>>        Property integer piFromMetasx   Public  0
52005>>>>>>>        Property String  psOldItem      Public ''
52006>>>>>>>        //------------------------------------------------
52006>>>>>>>        // Properties gia na kraththoun oi palies times
52006>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio
52006>>>>>>>        // einai 1     js 03/12/2007
52006>>>>>>>        //------------------------------------------------
52006>>>>>>>        Property Integer piCreateNew            Public  0
52007>>>>>>>        Property String  psAud_Old_Pelaths      Public ""
52008>>>>>>>        Property String  psAud_Old_PelathsN     Public ""
52009>>>>>>>        Property String  psAud_Old_Ergo         Public ""
52010>>>>>>>        Property String  psAud_Old_Poiothta     Public ""
52011>>>>>>>        Property String  psAud_Old_Eidos        Public ""
52012>>>>>>>
52012>>>>>>>        Property String  psAud_Old_Zonh         Public ""
52013>>>>>>>        Property String  psAud_Old_Antlia       Public ""
52014>>>>>>>        Property String  psAud_Old_Oxhma        Public ""
52015>>>>>>>
52015>>>>>>>        Property Number  pnAud_Old_Qty          Public  0
52016>>>>>>>        Property Number  pnAud_Old_Timh         Public  0
52017>>>>>>>        Property String  psAud_Old_PartlRecr    Public ""
52018>>>>>>>        Property String  psAud_Old_PmsRecr      Public ""
52019>>>>>>>        Property String  psAud_Old_Module       Public ""
52020>>>>>>>        Property String  psAud_Old_Parast       Public ""
52021>>>>>>>        Property String  psAud_Old_Seira        Public ""
52022>>>>>>>        Property Date    pdAud_Old_Hmnia        Public ""
52023>>>>>>>        Property Integer piAud_Old_No           Public  0
52024>>>>>>>        //------------------------------------------------
52024>>>>>>>    End_Procedure
52025>>>>>>>
52025>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
52026>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
52028>>>>>>>        Set pnoQty      to Pmoves.Pms_Qty
52029>>>>>>>        Set psOldItem   to Item.Item_Code
52030>>>>>>>        //------------------------------------------------
52030>>>>>>>        // Properties gia na kraththoun oi palies times
52030>>>>>>>        // ton pedion js 03/12/2007
52030>>>>>>>        //------------------------------------------------
52030>>>>>>>        Set psAud_Old_Pelaths       to Pmoves.Client_ID
52031>>>>>>>        Set psAud_Old_PelathsN      to Clients.Client_Name
52032>>>>>>>        Set psAud_Old_Ergo          to Pmoves.CN_Code
52033>>>>>>>        Set psAud_Old_Eidos         to Pmoves.Witemx_Code
52034>>>>>>>        Set psAud_Old_Poiothta      to Item.Item_Qual
52035>>>>>>>        Set pnAud_Old_Qty           to Pmoves.Pms_Qty
52036>>>>>>>        Set pnAud_Old_Timh          to Pmoves.Pms_UnitPrice
52037>>>>>>>        Set psAud_Old_PartlRecr     to Pmoves.Partl_Recr
52038>>>>>>>        Set psAud_Old_PmsRecr       to Pmoves.Pms_Recr
52039>>>>>>>        Set psAud_Old_Module        to Particle.Partl_Module
52040>>>>>>>        Set psAud_Old_Zonh          to Pmoves.Zone
52041>>>>>>>        Set psAud_Old_Antlia        to Pmoves.Pump_ID
52042>>>>>>>        Set psAud_Old_Oxhma         to Pmoves.Car_ID
52043>>>>>>>        Set psAud_Old_Parast        to Ptyppar.Ptyppar_Code
52044>>>>>>>        Set psAud_Old_Seira         to Particle.Pseira_Seira
52045>>>>>>>        Set pdAud_Old_Hmnia         to Particle.Partl_Hmnia
52046>>>>>>>        Set piAud_Old_No            to Particle.Partl_No
52047>>>>>>>        //------------------------------------------------
52047>>>>>>>    End_Procedure   // New_Current_Record
52048>>>>>>>
52048>>>>>>>
52048>>>>>>>    // Delete_Main_File:
52048>>>>>>>    Procedure Delete_Main_File
52049>>>>>>>        clear btnemp
52050>>>>>>>        move pmoves.pms_recr to btnemp.pms_recr
52051>>>>>>>        find ge btnemp by index.11
52052>>>>>>>>
52052>>>>>>>        if ((found=1) and (pmoves.pms_recr=btnemp.pms_recr)) begin
52054>>>>>>>           move 0 to btnemp.pms_recr
52055>>>>>>>           saverecord btnemp
52056>>>>>>>        end
52056>>>>>>>>
52056>>>>>>>
52056>>>>>>>        //---------------------------------------------
52056>>>>>>>        // Auditing / Katagrafh allagon
52056>>>>>>>        //OPERATION_MODE       OPERATION_ORIGIN
52056>>>>>>>            //MODE_WAITING
52056>>>>>>>            //MODE_FINDING
52056>>>>>>>            //MODE_CLEARING
52056>>>>>>>            //MODE_CREATING
52056>>>>>>>            //MODE_SAVING
52056>>>>>>>            //MODE_DELETING
52056>>>>>>>            //MODE_ABORTING
52056>>>>>>>        String  sUser sText sTime sMin sHour sSec
52057>>>>>>>        Date    dDate  Shmer
52057>>>>>>>        Integer iMin iHour iSec iLen
52057>>>>>>>        Sysdate dDate iHour iMin iSec
52061>>>>>>>        Move iHour  to sHour
52062>>>>>>>        Move iMin   to sMin
52063>>>>>>>        Move iSec   to sSec
52064>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
52068>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
52072>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
52076>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
52077>>>>>>>
52077>>>>>>>        // Auditing / Diagrafh - Diorthosh
52077>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING)) Begin
52079>>>>>>>            Get fsLoginUserID to sUser
52080>>>>>>>
52080>>>>>>>            clear gmove
52081>>>>>>>            move syscurxr.company_code  to gmove.company_code
52082>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
52083>>>>>>>            move syscurxr.year_year     to gmove.year_year
52084>>>>>>>            move  1                     to gmove.gtypkin_code// Apo Parastatika
52085>>>>>>>            move ddate                  to gmove.garticl_hmnia
52086>>>>>>>            move pmoves.partl_no        to gmove.garticl_no
52087>>>>>>>            move Particle.CN_Code       to gmove.gplan_recr
52088>>>>>>>            move suser                  to gmove.gplan_code
52089>>>>>>>            move pmoves.pms_recr        to gmove.garticl_recr
52090>>>>>>>            reread sysrecg
52094>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
52095>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
52096>>>>>>>            saverecord sysrecg
52097>>>>>>>            unlock
52098>>>>>>>>
52098>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                        to Gmove.Gmove_Recr
52099>>>>>>>
52099>>>>>>>            Move (psAud_Old_Module(Self))       to Gmove.Module
52100>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
52101>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs
52102>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
52103>>>>>>>            Move (psAud_Old_Pelaths (Self))     to Gmove.Prev_ID
52104>>>>>>>            Move (psAud_Old_PelathsN(Self))     to Gmove.Prev_Name
52105>>>>>>>            Move (psAud_Old_Ergo     (Self))    to Gmove.Prev_CN
52106>>>>>>>            Move (psAud_Old_Eidos    (Self))    to Gmove.Prev_Item
52107>>>>>>>            Move (psAud_Old_Poiothta (Self))    to Gmove.Prev_Qual
52108>>>>>>>            Move (pnAud_Old_Qty      (Self))    to Gmove.Prev_M3
52109>>>>>>>            Move (pnAud_Old_Timh     (Self))    to Gmove.Prev_UnitPrice
52110>>>>>>>            Move (psAud_Old_PartlRecr(Self))    to Gmove.Partl_Recr
52111>>>>>>>            Move (psAud_Old_PmsRecr  (Self))    to Gmove.Pms_Recr
52112>>>>>>>            Move (psAud_Old_Zonh     (Self))    to Gmove.Prev_Zonh
52113>>>>>>>            Move (psAud_Old_Antlia   (Self))    to Gmove.Prev_Antlia
52114>>>>>>>            Move (psAud_Old_Oxhma    (Self))    to Gmove.Prev_Oxhma
52115>>>>>>>            Move (psAud_Old_Parast   (Self))    to Gmove.Prev_Parast
52116>>>>>>>            Move (psAud_Old_Seira    (Self))    to Gmove.Prev_Seira
52117>>>>>>>            Move (pdAud_Old_Hmnia    (Self))    to Gmove.Prev_Hmnia
52118>>>>>>>            Move (piAud_Old_No       (Self))    to Gmove.Prev_No
52119>>>>>>>            Move "ƒ ˜š¨˜­ã š¨˜££ãª  ˜¨˜©«˜« ¡¦ç)" to sText
52120>>>>>>>            Move "D" to Gmove.Eidos_Metabolhs
52121>>>>>>>            move (trim(stext))          to gmove.gmove_aitiol
52122>>>>>>>            Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                to Gmove.Txt1
52123>>>>>>>            saverecord gmove
52124>>>>>>>        End
52124>>>>>>>>
52124>>>>>>>
52124>>>>>>>        Forward Send Delete_Main_File
52126>>>>>>>        // Insert Code Here
52126>>>>>>>    End_Procedure   // Delete_Main_File
52127>>>>>>>
52127>>>>>>>
52127>>>>>>>    Procedure Save_Main_File
52128>>>>>>>        Integer iYes
52129>>>>>>>        If (Operation_Origin<>Self) Begin
52131>>>>>>>            If Pmoves.Recnum Eq 0 Procedure_Return
52134>>>>>>>        End
52134>>>>>>>>
52134>>>>>>>
52134>>>>>>>        If ((Operation_Origin=Self) And (piCheckZeroFpa(Self))) Begin
52136>>>>>>>            // Elegxos FPA
52136>>>>>>>            // An typonei otidhpote ektos apo 1 (mono Posothtes)
52136>>>>>>>            If ((Ptyppar.Ti_Typonei_Pms<>'1')   And ;                (Pmoves.Pms_Vatam=0)            And ;                (Operation_Mode<>MODE_DELETING)) Begin
52138>>>>>>>                Move (YesNo_Box("¦©æ ”€ £ž›œ¤ ¡æ. Œ˜ ©¬¤œ®å©à ;", ;                                     "¨¦©¦®ã",  MB_DEFBUTTON2) ) to iYes
52139>>>>>>>                If (iYes=MBR_NO)  Send Operation_Not_Allowed 8000
52142>>>>>>>            End
52142>>>>>>>>
52142>>>>>>>        End
52142>>>>>>>>
52142>>>>>>>        Forward Send Save_Main_File
52144>>>>>>>    End_Procedure
52145>>>>>>>
52145>>>>>>>    Function fnTeleytaiaTimh Returns Number
52146>>>>>>>        Number  rVal nQty
52147>>>>>>>        String  sClientID sWitemxCode
52147>>>>>>>        Date    dHmnia
52147>>>>>>>        String  sWhat sRecr sClientCode sItemCode sCN
52147>>>>>>>
52147>>>>>>>        Get File_Field_Current_Value File_Field Ptyppar.Ptyppar_Is_What to sWhat
52148>>>>>>>        If (Trim(sWhat)='1') Begin
52150>>>>>>>            // 1=€š¦¨œª
52150>>>>>>>            Get File_Field_Current_Value File_Field Witemx.Witemx_Recr      to sRecr
52151>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Pms_Qty          to nQty
52152>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_Hmnia    to dHmnia
52153>>>>>>>            Get File_Field_Current_Value File_Field Item.Item_Code          to sItemCode
52154>>>>>>>            Get File_Field_Current_Value File_Field Clients.Client_ID       to sClientCode
52155>>>>>>>            // Sto arxeio Globals.inc
52155>>>>>>>            Get fnTeleytaiaTimhAgoras sClientCode sItemCode dHmnia nQty to rVal
52156>>>>>>>        End
52156>>>>>>>>
52156>>>>>>>        Else If (Trim(sWhat)='2') Begin
52159>>>>>>>            // 2=à¢ã©œ ª
52159>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Pms_Qty          to nQty
52160>>>>>>>            Get File_Field_Current_Value File_Field Item.Item_Code          to sItemCode
52161>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_Hmnia    to dHmnia
52162>>>>>>>            Get File_Field_Current_Value File_Field Particle.Cn_Code        to sCN
52163>>>>>>>            Get File_Field_Current_Value File_Field Witemx.Witemx_Recr      to sRecr
52164>>>>>>>            Get File_Field_Current_Value File_Field Clients.Client_ID       to sClientID
52165>>>>>>>            Get File_Field_Current_Value File_Field Witemx.Witemx_Code      to sWitemxCode
52166>>>>>>>            // Sto arxeio Globals.inc
52166>>>>>>>            Get fnTeleytaiaTimhPolhshs sRecr sClientID sWitemxCode dHmnia sItemCode nQty sCN to rVal
52167>>>>>>>        End
52167>>>>>>>>
52167>>>>>>>        Function_Return rVal
52168>>>>>>>    End_Function
52169>>>>>>>
52169>>>>>>>    Procedure Creating
52170>>>>>>>        Forward Send Creating
52172>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Pmoves.Pms_Rec0)))))) to Pmoves.Pms_Recr
52173>>>>>>>        Set piCreateNew to 1
52174>>>>>>>    End_Procedure   // Creating
52175>>>>>>>
52175>>>>>>>    Procedure Update
52176>>>>>>>        Integer iDecimals
52177>>>>>>>        Number  nInt nFpaOnTotal
52177>>>>>>>        String  sCurrentUser
52177>>>>>>>
52177>>>>>>>        Forward Send Update
52179>>>>>>>
52179>>>>>>>        Move SysCurXR.Company_Code                          to Pmoves.Company_Code
52180>>>>>>>        Move SysCurXR.Branch_Code                           to Pmoves.Branch_Code
52181>>>>>>>        Move SysCurXR.Year_Year                             to Pmoves.Year_Year
52182>>>>>>>        Move Ctypkin.Ctypkin_Code                           to Pmoves.Ctypkin_Code
52183>>>>>>>        Move Wtypkin.Wtypkin_Code                           to Pmoves.Wtypkin_Code
52184>>>>>>>
52184>>>>>>>        Move Witemkat.Witemkat_Code                         to Pmoves.Witemkat_Code
52185>>>>>>>        Move Item.Item_Code                                 to Pmoves.Item_Code
52186>>>>>>>        Move Witemx.Witemx_Code                             to Pmoves.Witemx_Code
52187>>>>>>>        Move Wapokat.Wapokat_Code                           to Pmoves.Wapokat_Code
52188>>>>>>>        Move Wapomast.Wapomast_Code                         to Pmoves.Wapomast_Code
52189>>>>>>>        Move Wax.Wax_Code                                   to Pmoves.Wax_Code
52190>>>>>>>
52190>>>>>>>        //Move Custprom.Custprom_Code                         to Pmoves.Custprom_Code
52190>>>>>>>        Move Clients.Client_ID                              to Pmoves.Client_ID
52191>>>>>>>        Move Ptyppar.Ptyppar_Code                           to Pmoves.Ptyppar_Code
52192>>>>>>>        Move Ptyppar.TI_TYPONEI_PMS                         to Pmoves.TI_TYPONEI_PMS
52193>>>>>>>        Move Particle.PSeira_Seira                          to Pmoves.Pseira_Seira
52194>>>>>>>
52194>>>>>>>        Move Nomisma.Nomisma_Code                           to Pmoves.Pms_Sc_Code2
52195>>>>>>>        Move Nomisma.Dekadika                               To iDecimals
52196>>>>>>>
52196>>>>>>>
52196>>>>>>>        Move Particle.Partl_No                              to Pmoves.Partl_No
52197>>>>>>>        Move Particle.Partl_Hmnia                           to Pmoves.Partl_Hmnia
52198>>>>>>>        Move Particle.Partl_Module                          to Pmoves.Pms_Module
52199>>>>>>>        Move Particle.Partl_Rec0                            to Pmoves.Partl_Rec0
52200>>>>>>>        Move Particle.Presp_ID                              to Pmoves.Presp_ID
52201>>>>>>>        if (particle.partl_euro<>1) begin
52203>>>>>>>            Move Particle.CN_Code                           to Pmoves.CN_Code
52204>>>>>>>            Move Particle.Sls_ID                            to Pmoves.Sls_ID
52205>>>>>>>
52205>>>>>>>            Move Particle.Cnt_ID                            to Pmoves.Cnt_ID
52206>>>>>>>        end
52206>>>>>>>>
52206>>>>>>>        Move Item.Units_Code                                to Pmoves.Pms_UnitCode
52207>>>>>>>        move witemx.witemx_descr                            to pmoves.witemx_descr
52208>>>>>>>        move ptyppar.ptyppar_descr                          to pmoves.ptyppar_descr
52209>>>>>>>        move clients.client_name                            to pmoves.client_name
52210>>>>>>>
52210>>>>>>>        if (Trim(pmoves.pump_id)='') ;            move particle.antlia_code                       to pmoves.pump_id
52213>>>>>>>        If (Trim(pmoves.car_id)='') ;            move particle.oxhma_code                        to pmoves.car_id
52216>>>>>>>        If (Trim(pmoves.zone)='') ;            move particle.zone_id                           to pmoves.zone
52219>>>>>>>
52219>>>>>>>      //  if (particle.zone_id='') move pmoves.zone           to particle.zone_id
52219>>>>>>>      //  else move particle.Zone_ID                          to pmoves.Zone
52219>>>>>>>
52219>>>>>>>//        Move (Pmoves.Pms_Qty-Pmoves.Timol_Qty)              to Pmoves.Timol_Ypol
52219>>>>>>>
52219>>>>>>>        Move (Pmoves.Qty_Kinhshs>0)                         to Pmoves.pms_Selected
52220>>>>>>>
52220>>>>>>>        Move (Round_Number((Pmoves.Pms_Qty*Pmoves.Pms_UnitPrice),iDecimals))    ;                                                            to Pmoves.Pms_Ambd
52221>>>>>>>
52221>>>>>>>        If (Pmoves.Pms_PctDisc<>0) ;            Move (Round_Number((Pmoves.Pms_Ambd*Pmoves.Pms_PctDisc/100),iDecimals)) ;                                                            to Pmoves.Pms_Discam
52224>>>>>>>        Else ;            Move (Round_Number( ((Pmoves.Pms_Discam/Pmoves.Pms_Ambd)*100),iDecimals)) ;                                                            to Pmoves.Pms_PctDisc
52226>>>>>>>
52226>>>>>>>        Move (Pmoves.Pms_Ambd-Pmoves.Pms_Discam)            to Pmoves.Pms_Amaftdisc
52227>>>>>>>
52227>>>>>>>        Move (Round_Number((Pmoves.Pms_Amaftdisc*Pmoves.Pms_Vatpct/100),iDecimals));                                                            to Pmoves.Pms_Vatam
52228>>>>>>>        Move (Pmoves.Pms_Amaftdisc+Pmoves.Pms_Vatam)        to Pmoves.Pms_Payable
52229>>>>>>>        Move Pmoves.Pms_Payable                             to Pmoves.Pms_Axia
52230>>>>>>>
52230>>>>>>>        Add Pmoves.Pms_Qty                                  to Particle.Partl_TotTem
52231>>>>>>>//        Add Pmoves.Timol_Qty                                to Particle.Timol_Qty
52231>>>>>>>
52231>>>>>>>        Add Pmoves.Pms_Ambd                                 to Particle.Partl_TotAmBD
52232>>>>>>>        Add Pmoves.Pms_DiscAm                               to Particle.Partl_AMDISCPMS
52233>>>>>>>        Add Pmoves.Pms_Amaftdisc                            to Particle.Partl_TotAmAd
52234>>>>>>>        Add 1                                               to Particle.Partl_NoOfLines
52235>>>>>>>
52235>>>>>>>        // An einai parastatiko polhshs kai to ptyppar einai flagarismeno oti
52235>>>>>>>        // prepei na enhmerosh to pedio Clients.Posa_apo_dap
52235>>>>>>>        // tote theoroume oti ypoxreotika prepei na vroume timh apo
52235>>>>>>>        // function timokatalogon kai na thn krathsoume sto pedio
52235>>>>>>>        // Pmoves.Posa_apo_dap
52235>>>>>>>        If ((Ptyppar.Ptyppar_Is_What='2') And (Ptyppar.Check_Posa_Plaf='1')) Begin
52237>>>>>>>            // An to pedio Particle.Partl_Vsn einai 0 tote shmainei
52237>>>>>>>            // oti den einai parastatiko metasxhmatismeno (px D.AP) ara
52237>>>>>>>            // h update prepei na prosthesei sto antistoixo pedio client
52237>>>>>>>            // An omos einai metasxhmatismeno (px apo D.AP tora einai
52237>>>>>>>            // Timologio) tote  prepei h update na afairesei apo to pedio
52237>>>>>>>            // tou client dioti to arxiko D.AP eixe prosthesei.
52237>>>>>>>
52237>>>>>>>            Move (Round_Number(Pmoves.Pms_Payable,2)) to Pmoves.Posa_Apo_Dap
52238>>>>>>>
52238>>>>>>>            If (Particle.Partl_Vsn=0) Begin
52240>>>>>>>                Add Pmoves.Posa_Apo_Dap to Clients.Posa_Apo_Dap
52241>>>>>>>                Add Pmoves.Posa_Apo_Dap to Payresp.Posa_Apo_Dap
52242>>>>>>>            End
52242>>>>>>>>
52242>>>>>>>            Else Begin
52243>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Clients.Posa_Apo_Dap
52244>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Payresp.Posa_Apo_Dap
52245>>>>>>>            End
52245>>>>>>>>
52245>>>>>>>        End
52245>>>>>>>>
52245>>>>>>>
52245>>>>>>>        //Add Pmoves.Qty_Kinhshs  to Particle.Partl_Disctof
52245>>>>>>>
52245>>>>>>>
52245>>>>>>>        ////////////////////////////////////////////////////////////////////////
52245>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
52245>>>>>>>        ////////////////////////////////////////////////////////////////////////
52245>>>>>>>        Add Pmoves.Pms_Vatam            to Particle.Partl_Vatam
52246>>>>>>>
52246>>>>>>>        Clear PartlFpa
52247>>>>>>>        Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
52248>>>>>>>        Move Pmoves.Pms_VatPct          to PartlFpa.Fpa_Pososto
52249>>>>>>>        Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
52250>>>>>>>>
52250>>>>>>>        Add Pmoves.Pms_Vatam            to PartlFpa.PartlFpa_Poso
52251>>>>>>>        Add Pmoves.Pms_Amaftdisc        to PartlFpa.Poso_Pro_Fpa
52252>>>>>>>        Saverecord PartlFpa
52253>>>>>>>
52253>>>>>>>        Move 0 to nFpaOnTotal
52254>>>>>>>        Clear PartlFpa
52255>>>>>>>        Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
52256>>>>>>>        Find Gt PartlFpa By Index.1
52257>>>>>>>>
52257>>>>>>>        While ((Found=1) And (PartlFpa.Partl_Recr=Particle.Partl_Recr))
52261>>>>>>>            Move (Round_Number(((PartlFpa.Fpa_Pososto*PartlFpa.Poso_Pro_Fpa)/100),2)) to PartlFpa.POSO_FPA
52262>>>>>>>            Move (PartlFpa.Poso_Pro_Fpa+PartlFpa.POSO_FPA) to PartlFpa.POSO_ME_FPA
52263>>>>>>>            Saverecord PartlFpa
52264>>>>>>>            Add PartlFpa.POSO_FPA to nFpaOnTotal
52265>>>>>>>            Find Gt PartlFpa By Index.1
52266>>>>>>>>
52266>>>>>>>        Loop
52267>>>>>>>>
52267>>>>>>>
52267>>>>>>>        Move nFpaOnTotal to Particle.Fpa_On_Total
52268>>>>>>>
52268>>>>>>>
52268>>>>>>>        //---------------------------------------------
52268>>>>>>>        // Auditing / Katagrafh allagon
52268>>>>>>>        //OPERATION_MODE       OPERATION_ORIGIN
52268>>>>>>>            //MODE_WAITING
52268>>>>>>>            //MODE_FINDING
52268>>>>>>>            //MODE_CLEARING
52268>>>>>>>            //MODE_CREATING
52268>>>>>>>            //MODE_SAVING
52268>>>>>>>            //MODE_DELETING
52268>>>>>>>            //MODE_ABORTING
52268>>>>>>>        String  sUser sText sTime sMin sHour sSec
52268>>>>>>>        Date    dDate  Shmer
52268>>>>>>>        Integer iMin iHour iSec iLen
52268>>>>>>>        Sysdate dDate iHour iMin iSec
52272>>>>>>>        Move iHour  to sHour
52273>>>>>>>        Move iMin   to sMin
52274>>>>>>>        Move iSec   to sSec
52275>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
52279>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
52283>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
52287>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
52288>>>>>>>
52288>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
52288>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
52290>>>>>>>            Get fsLoginUserID to sUser
52291>>>>>>>            If (piCreateNew(Self)=1) Begin
52293>>>>>>>                clear gmove
52294>>>>>>>                move syscurxr.company_code  to gmove.company_code
52295>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
52296>>>>>>>                move syscurxr.year_year     to gmove.year_year
52297>>>>>>>                move  1                     to gmove.gtypkin_code// Apo Parastatika
52298>>>>>>>                move ddate                  to gmove.garticl_hmnia
52299>>>>>>>                move pmoves.partl_no        to gmove.garticl_no
52300>>>>>>>                move Particle.CN_Code       to gmove.gplan_recr
52301>>>>>>>                move suser                  to gmove.gplan_code
52302>>>>>>>                move pmoves.pms_recr        to gmove.garticl_recr
52303>>>>>>>                reread sysrecg
52307>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
52308>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
52309>>>>>>>                saverecord sysrecg
52310>>>>>>>                unlock
52311>>>>>>>>
52311>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                            to Gmove.Gmove_Recr
52312>>>>>>>                Move Particle.Partl_Module          to Gmove.Module
52313>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
52314>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs
52315>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
52316>>>>>>>                Move Clients.Client_ID              to Gmove.Cur_ID
52317>>>>>>>                Move Clients.CLient_Name            to Gmove.Cur_Name
52318>>>>>>>                Move Particle.CN_Code               to Gmove.Cur_CN
52319>>>>>>>                Move Item.Item_Code                 to Gmove.Cur_Item
52320>>>>>>>                Move Item.Item_Qual                 to Gmove.Cur_Qual
52321>>>>>>>                Move Pmoves.Pms_Qty                 to Gmove.Cur_M3
52322>>>>>>>                Move Pmoves.Pms_UnitPrice           to Gmove.Cur_UnitPrice
52323>>>>>>>                Move Particle.Partl_Recr            to Gmove.Partl_Recr
52324>>>>>>>                Move Pmoves.Pms_Recr                to Gmove.Pms_Recr
52325>>>>>>>
52325>>>>>>>                Move Pmoves.Zone                    to Gmove.Cur_Zonh
52326>>>>>>>                Move Pmoves.Pump_ID                 to Gmove.Cur_Antlia
52327>>>>>>>                Move Pmoves.Car_ID                  to Gmove.Cur_Oxhma
52328>>>>>>>
52328>>>>>>>                Move Ptyppar.Ptyppar_Code           to Gmove.Cur_Parast
52329>>>>>>>                Move Particle.Pseira_Seira          to Gmove.Cur_Seira
52330>>>>>>>                Move Particle.Partl_Hmnia           to Gmove.Cur_Hmnia
52331>>>>>>>                Move "ƒž£ ¦¬¨šå˜ š¨˜££ãª §˜¨˜©«˜« ¡¦ç)" to sText
52332>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs
52333>>>>>>>                move (trim(stext))          to gmove.gmove_aitiol
52334>>>>>>>                Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                    to Gmove.Txt1
52335>>>>>>>                saverecord gmove
52336>>>>>>>                Set piCreateNew to 0
52337>>>>>>>            End
52337>>>>>>>>
52337>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1)) Begin
52340>>>>>>>                Integer isChanged
52340>>>>>>>                Move 0 to isChanged
52341>>>>>>>
52341>>>>>>>                     If ((Trim(psAud_Old_Pelaths(Self))<>Trim(Clients.Client_ID    ))   Or  (Trim(psAud_Old_Ergo    (Self))<>Trim(Pmoves.CN_Code      ))) Move 1 to isChanged
52344>>>>>>>                Else If ((Trim(psAud_Old_Eidos  (Self))<>Trim(Item.Item_Code       ))   Or  (Trim(psAud_Old_Poiothta(Self))<>Trim(Item.Item_Qual      ))) Move 1 to isChanged
52348>>>>>>>                Else If ((pnAud_Old_Qty         (Self) <>Pmoves.Pms_Qty             )   Or  (pnAud_Old_Timh         (Self) <>Pmoves.Pms_UnitPrice      )) Move 1 to isChanged
52352>>>>>>>                Else If ((Trim(psAud_Old_Zonh   (Self))<>Trim(Pmoves.Zone          ))   Or  (Trim(psAud_Old_Antlia  (Self))<>Trim(Pmoves.Pump_ID      ))) Move 1 to isChanged
52356>>>>>>>                Else If ((Trim(psAud_Old_Oxhma  (Self))<>Trim(Pmoves.Car_ID        ))   Or  (Trim(psAud_Old_Parast  (Self))<>Trim(Ptyppar.Ptyppar_Code))) Move 1 to isChanged
52360>>>>>>>                Else If ((Trim(psAud_Old_Seira  (Self))<>Trim(Particle.Pseira_Seira))   Or  (Trim(pdAud_Old_Hmnia   (Self))<>Particle.Partl_Hmnia      )) Move 1 to isChanged
52364>>>>>>>                Else If  (piAud_Old_No          (Self) <>Particle.Partl_No)                                                                               Move 1 to isChanged
52368>>>>>>>
52368>>>>>>>                If (isChanged>0) Begin
52370>>>>>>>                    clear gmove
52371>>>>>>>                    move syscurxr.company_code  to gmove.company_code
52372>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
52373>>>>>>>                    move syscurxr.year_year     to gmove.year_year
52374>>>>>>>                    move  1                     to gmove.gtypkin_code// Apo Parastatika
52375>>>>>>>                    move ddate                  to gmove.garticl_hmnia
52376>>>>>>>                    move pmoves.partl_no        to gmove.garticl_no
52377>>>>>>>                    move Particle.CN_Code       to gmove.gplan_recr
52378>>>>>>>                    move suser                  to gmove.gplan_code
52379>>>>>>>                    move pmoves.pms_recr        to gmove.garticl_recr
52380>>>>>>>                    reread sysrecg
52384>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
52385>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
52386>>>>>>>                    saverecord sysrecg
52387>>>>>>>                    unlock
52388>>>>>>>>
52388>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
52389>>>>>>>                    Move Particle.Partl_Module          to Gmove.Module
52390>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
52391>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs
52392>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
52393>>>>>>>                    //--
52393>>>>>>>                    Move Particle.Partl_Recr            to Gmove.Partl_Recr
52394>>>>>>>                    Move Pmoves.Pms_Recr                to Gmove.Pms_Recr
52395>>>>>>>                    //--
52395>>>>>>>                    Move (Trim(Clients.Client_ID    ))  to Gmove.Cur_ID
52396>>>>>>>                    Move (Trim(Clients.CLient_Name  ))  to Gmove.Cur_Name
52397>>>>>>>                    Move (Trim(Particle.CN_Code     ))  to Gmove.Cur_CN
52398>>>>>>>                    Move (Trim(Item.Item_Code       ))  to Gmove.Cur_Item
52399>>>>>>>                    Move (Trim(Item.Item_Qual       ))  to Gmove.Cur_Qual
52400>>>>>>>                    Move       Pmoves.Pms_Qty           to Gmove.Cur_M3
52401>>>>>>>                    Move       Pmoves.Pms_UnitPrice     to Gmove.Cur_UnitPrice
52402>>>>>>>
52402>>>>>>>                    Move (Trim(Pmoves.Zone          ))  to Gmove.Cur_Zonh
52403>>>>>>>                    Move (Trim(Pmoves.Pump_ID       ))  to Gmove.Cur_Antlia
52404>>>>>>>                    Move (Trim(Pmoves.Car_ID        ))  to Gmove.Cur_Oxhma
52405>>>>>>>
52405>>>>>>>                    Move (Trim(Ptyppar.Ptyppar_Code ))  to Gmove.Cur_Parast
52406>>>>>>>                    Move (Trim(Particle.Pseira_Seira))  to Gmove.Cur_Seira
52407>>>>>>>                    Move       Particle.Partl_Hmnia     to Gmove.Cur_Hmnia
52408>>>>>>>                    Move       Particle.Partl_No        to Gmove.Cur_No
52409>>>>>>>                    //--
52409>>>>>>>                    Move (Trim(psAud_Old_Pelaths (Self))) to Gmove.Prev_ID
52410>>>>>>>                    Move (Trim(psAud_Old_PelathsN(Self))) to Gmove.Prev_Name
52411>>>>>>>                    Move (Trim(psAud_Old_Ergo    (Self))) to Gmove.Prev_CN
52412>>>>>>>                    Move (Trim(psAud_Old_Eidos   (Self))) to Gmove.Prev_Item
52413>>>>>>>                    Move (Trim(psAud_Old_Poiothta(Self))) to Gmove.Prev_Qual
52414>>>>>>>                    Move      (pnAud_Old_Qty     (Self )) to Gmove.Prev_M3
52415>>>>>>>                    Move      (pnAud_Old_Timh    (Self )) to Gmove.Prev_UnitPrice
52416>>>>>>>                    Move (Trim(psAud_Old_Zonh    (Self))) to Gmove.Prev_Zonh
52417>>>>>>>                    Move (Trim(psAud_Old_Antlia  (Self))) to Gmove.Prev_Antlia
52418>>>>>>>                    Move (Trim(psAud_Old_Oxhma   (Self))) to Gmove.Prev_Oxhma
52419>>>>>>>                    Move (Trim(psAud_Old_Parast  (Self))) to Gmove.Prev_Parast
52420>>>>>>>                    Move (Trim(psAud_Old_Seira   (Self))) to Gmove.Prev_Seira
52421>>>>>>>                    Move      (pdAud_Old_Hmnia   (Self )) to Gmove.Prev_Hmnia
52422>>>>>>>                    Move      (piAud_Old_No      (Self )) to Gmove.Prev_No
52423>>>>>>>                    //--
52423>>>>>>>                    Move "ƒ æ¨Ÿà©ž š¨˜££ãª ˜¨˜©«˜« ¡¦ç)" to sText
52424>>>>>>>                    Move "E" to Gmove.Eidos_Metabolhs
52425>>>>>>>                    move (trim(stext))          to gmove.gmove_aitiol
52426>>>>>>>                    Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                        to Gmove.Txt1
52427>>>>>>>                    saverecord gmove
52428>>>>>>>                    Set piCreateNew to 0
52429>>>>>>>                End
52429>>>>>>>>
52429>>>>>>>            End
52429>>>>>>>>
52429>>>>>>>        End
52429>>>>>>>>
52429>>>>>>>    End_Procedure   // Update
52430>>>>>>>
52430>>>>>>>    // Backout:
52430>>>>>>>    Procedure Backout
52431>>>>>>>        Number nFpaOnTotal
52432>>>>>>>        Forward Send Backout
52434>>>>>>>
52434>>>>>>>        Sub Pmoves.Pms_Qty        From Particle.Partl_TotTem
52435>>>>>>>//        Sub Pmoves.Timol_Qty      From Particle.Timol_Qty
52435>>>>>>>        Sub Pmoves.Pms_Ambd       From Particle.Partl_TotAmBD
52436>>>>>>>        Sub Pmoves.Pms_DiscAm     From Particle.Partl_AMDISCPMS
52437>>>>>>>        Sub Pmoves.Pms_Amaftdisc  From Particle.Partl_TotAmAd
52438>>>>>>>        Sub 1                     From Particle.Partl_NoOfLines
52439>>>>>>>
52439>>>>>>>        // An einai parastatiko polhshs kai to ptyppar einai flagarismeno oti
52439>>>>>>>        // prepei na enhmerosh to pedio Clients.Posa_apo_dap
52439>>>>>>>        // tote theoroume oti ypoxreotika prepei na vroume timh sto pedio
52439>>>>>>>        // Pmoves.Posa_apo_dap
52439>>>>>>>        If ((Ptyppar.Ptyppar_Is_What='2') And (Ptyppar.Check_Posa_Plaf='1')) Begin
52441>>>>>>>            // An to pedio Particle.Partl_Vsn einai 0 tote shmainei
52441>>>>>>>            // oti den einai parastatiko metasxhmatismeno (px D.AP) ara
52441>>>>>>>            // h backout prepei na afairesei apo antistoixo pedio client
52441>>>>>>>            // An omos einai metasxhmatismeno (px apo D.AP tora einai
52441>>>>>>>            // Timologio) tote  prepei h backout na prosthesi sto pedio
52441>>>>>>>            // tou client dioti to arxiko D.AP eixe afairethei.
52441>>>>>>>            If (Particle.Partl_Vsn=0) Begin
52443>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Clients.Posa_Apo_Dap
52444>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Payresp.Posa_Apo_Dap
52445>>>>>>>            End
52445>>>>>>>>
52445>>>>>>>            Else Begin
52446>>>>>>>                Add Pmoves.Posa_Apo_Dap to Clients.Posa_Apo_Dap
52447>>>>>>>                Add Pmoves.Posa_Apo_Dap to Payresp.Posa_Apo_Dap
52448>>>>>>>            End
52448>>>>>>>>
52448>>>>>>>        End
52448>>>>>>>>
52448>>>>>>>
52448>>>>>>>        //Sub Pmoves.Qty_Kinhshs From Particle.Partl_Disctof
52448>>>>>>>
52448>>>>>>>        ////////////////////////////////////////////////////////////////////////
52448>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
52448>>>>>>>        ////////////////////////////////////////////////////////////////////////
52448>>>>>>>        Sub Pmoves.Pms_Vatam      From Particle.Partl_Vatam
52449>>>>>>>
52449>>>>>>>        Clear PartlFpa
52450>>>>>>>        Move Particle.Partl_Recr    to PartlFpa.Partl_Recr
52451>>>>>>>        Move Pmoves.Pms_VatPct      to PartlFpa.Fpa_Pososto
52452>>>>>>>        Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
52453>>>>>>>>
52453>>>>>>>        Sub Pmoves.Pms_Vatam      From PartlFpa.PartlFpa_Poso
52454>>>>>>>        Sub Pmoves.Pms_Amaftdisc  From PartlFpa.Poso_Pro_Fpa
52455>>>>>>>        Saverecord PartlFpa
52456>>>>>>>
52456>>>>>>>        Move 0 to nFpaOnTotal
52457>>>>>>>        Clear PartlFpa
52458>>>>>>>        Move Particle.Partl_Recr  to PartlFpa.Partl_Recr
52459>>>>>>>        Find Gt PartlFpa By Index.1
52460>>>>>>>>
52460>>>>>>>        While ((Found=1) And (PartlFpa.Partl_Recr=Particle.Partl_Recr))
52464>>>>>>>            Move (Round_Number(((PartlFpa.Fpa_Pososto*PartlFpa.Poso_Pro_Fpa)/100),2)) to PartlFpa.POSO_FPA
52465>>>>>>>            Move (PartlFpa.Poso_Pro_Fpa+PartlFpa.POSO_FPA) to PartlFpa.POSO_ME_FPA
52466>>>>>>>            Saverecord PartlFpa
52467>>>>>>>            Add PartlFpa.POSO_FPA to nFpaOnTotal
52468>>>>>>>            Find Gt PartlFpa By Index.1
52469>>>>>>>>
52469>>>>>>>        Loop
52470>>>>>>>>
52470>>>>>>>
52470>>>>>>>        Move nFpaOnTotal to Particle.Fpa_On_Total
52471>>>>>>>
52471>>>>>>>    End_Procedure   // Backout
52472>>>>>>>
52472>>>>>>>
52472>>>>>>>
52472>>>>>>>
52472>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
52473>>>>>>>             If (iError_Num = 1001) Error 1001 "DDC 18: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ©«¦ Wax"
52476>>>>>>>        Else If (iError_Num = 1002) Error 1002 "DDC 18: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ©«¦ Witemx"
52480>>>>>>>        Else If (iError_Num = 1003) Error 1003 "DDC 18: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ©«¦ Particle"
52484>>>>>>>        Else If (iError_Num = 1004) Error 1004 "DDC 18: ¦©æ«ž«˜ „å›¦¬ª ‹ž›œ¤ ¡ã\nƒ ˜š¨á¯«œ ˜¤ Ÿâ¢œ«œ, «ž š¨˜££ã «¦¬ œå›¦¬ª"
52488>>>>>>>        Else If (iError_Num = 1005) Error 1005 "DDC 18: ¦©æ §¨¦ „¡§«à©žª ‹ž›œ¤ ¡æ"
52492>>>>>>>        Else If (iError_Num = 1006) Error 1006 "DDC 18: ¦©æ §¨¦ ”€ ‹ž›œ¤ ¡æ"
52496>>>>>>>        Else If (iError_Num = 1007) Error 1007 "DDC 18: ¦©æ ¢ž¨à«â¦ „å›¦¬ª ‹ž›œ¤ ¡æ"
52500>>>>>>>        Else If (iError_Num = 1009) Error 1009 "DDC 18: ƒœ¤ œå¤˜  œ­ ¡«ã ž › ˜š¨˜­ã \n„®œ  ›ž£ ¦¬¨šžŸœå £œ«˜©®ž£˜« ©£â¤¦ §˜¨˜©«˜« ¡æ"
52504>>>>>>>        Else If (iError_Num = 1010) Error 1010 "DDC 18: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ §œ¢á«ž"
52508>>>>>>>        Else If (iError_Num = 1011) Error 1011 "DDC 18: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ ¬§. §¢ž¨à£ãª"
52512>>>>>>>        Else If (iError_Num = 1012) Error 1012 "DDC 18: ’¦ œå›¦ª ˜¬«æ §¨¦ã¢Ÿœ ˜§¦ £œ«˜©®ž£˜« ©£æ ¡˜  ›œ¤ › ˜š¨á­œ«˜ .\nƒ ˜š¨á¯«œ «¦ §˜¨˜©«˜« ¡æ ¡˜  ¥˜¤˜£œ«˜©®ž£˜«å©«œ «¦ ˜¨® ¡æ."
52516>>>>>>>        Else If (iError_Num = 1013) Error 1013 "DDC 18: ’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\n‰ ¤ãŸž¡œ §¦©æ«ž«˜ > ˜§¦ «ž › ˜Ÿâ© £ž"
52520>>>>>>>        Else If (iError_Num = 1111) Error 1111 "DDC 18: ƒœ¤ â®œ  ¡˜«˜®à¨žŸœå ©«¦ ©ç©«ž£˜ «â«¦ ¦ §¦©¦©«æ ”€"
52524>>>>>>>        Else If (iError_Num = 1105) Error 1105 "DDC 18: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
52528>>>>>>>        Else If (iError_Num = 1106) Error 1106 "DDC 18: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
52532>>>>>>>        Else If (iError_Num = 1107) Error 1107 "DDC 18: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
52536>>>>>>>        Else If (iError_Num = 1108) Error 1108 "DDC 18: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
52540>>>>>>>        Else If (iError_Num = 1110) Error 1110 "DDC 18: †£/¤å˜ §˜¨˜©«˜« ¡¦ç <= †£/¤å˜ª ¡¢œ ©å£˜«¦ª\nƒœ¤ œ§ «¨â§œ«˜  ¡˜££å˜ «¨¦§¦§¦åž©ž ©«¦ §˜¨˜©«˜« ¡æ"
52544>>>>>>>        Else If (iError_Num = 6001) Error 6001 "DDC 18: ƒœ¤ §¨¦¡ç§«œ  §¦©¦ ˜§¦ « £¦¡˜«á¢¦š¦"
52548>>>>>>>        Else If (iError_Num = 7000) Error 7000 "DDC 18: ¨¦â¨®œ«˜  ˜§¦ ˜¨˜ššœ¢å˜. † š¨˜££ã ˜¬«ã £æ¤¦ › ˜š¨á­œ«˜ "
52552>>>>>>>        Else If (iError_Num = 7001) Error 7001 "DDC 18: ’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ."
52556>>>>>>>        Else If (iError_Num = 7005) Error 7005 "DDC 18: † §¦©æ«ž«˜ ›œ¤ «¨¦§¦§¦ œå«˜  š ˜«  §¨¦ã¢Ÿœ ˜§¦ £œ«˜©®ž£˜« ©£æ.\nƒ ˜š¨á¯«œ «¦ §˜¨˜©«˜« ¡æ ¡˜  ¥˜¤˜£œ«˜©®ž£˜«å©«œ «¦ ˜¨® ¡æ."
52560>>>>>>>        Else If (iError_Num = 8000) Error 8000 "DDC 18: €¡¬¨éŸž¡œ ž ¡˜«˜®é¨ž©ž «¦¬ œå›¦¬ª ˜§¦ «¦¤ ®¨ã©«ž\n‹œ«˜ «¦ Ž‰, §˜«ã©«œ F5"
52564>>>>>>>        Else If (iError_Num = 8001) Error 8001 "DDC 18: ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã œå›¦¬ª\n‹œ«˜ «¦ Ž‰, §˜«ã©«œ F5"
52568>>>>>>>        Else If (iError_Num = 6655) Error 6655 "DDC 18: ¨¦¡ç§«œ  ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž > ˜¨® ¡ãª §¦©æ«ž«˜ª"
52572>>>>>>>        Else Forward Send Operation_Not_Allowed  iError_Num
52575>>>>>>>    End_Procedure   // Operation_Not_Allowed
52576>>>>>>>
52576>>>>>>>    Function Validate_Save  Returns Integer
52577>>>>>>>        Integer iReturnVal iFpaRecnum iYes
52578>>>>>>>        Number  nInt nqty nQtyKin
52578>>>>>>>        String  sUserID sOldUserID sOldItem
52578>>>>>>>
52578>>>>>>>        Forward Get Validate_Save  To iReturnVal
52580>>>>>>>
52580>>>>>>>        If (Not(iReturnVal)) Begin
52582>>>>>>>
52582>>>>>>>//////////////////////////////////////////////////////////////////////////////////////
52582>>>>>>>        // Egine rem o kodikas pou elegxei to pososto fpa giati sto shmeio ayto
52582>>>>>>>        // dhmiourgouse parenergeia an o xrhsths allaze to pososto fpa pou erxotan
52582>>>>>>>        // apo to eidos, tote allaze kai sto record tou eidous
52582>>>>>>>
52582>>>>>>>//            If (Pmoves.Pms_VatPct) Begin
52582>>>>>>>//                Move Fpa.Recnum to iFpaRecnum
52582>>>>>>>//                Clear Fpa
52582>>>>>>>//                Move Pmoves.Pms_VatPct      to Fpa.Fpa_Pososto
52582>>>>>>>//                Find eq Fpa By Index.1 // Fpa:Index.1:Fpa_Pososto
52582>>>>>>>//                If (Not(Found)) Move 1111 to iReturnVal
52582>>>>>>>//                If (iFpaRecnum) Begin
52582>>>>>>>//                    Clear Fpa
52582>>>>>>>//                    Move iFpaRecnum to Fpa.Recnum
52582>>>>>>>//                    Find Eq Fpa.Recnum
52582>>>>>>>//                End
52582>>>>>>>//            End
52582>>>>>>>//////////////////////////////////////////////////////////////////////////////////////
52582>>>>>>>
52582>>>>>>>                 If (Wax.Recnum          =0) Move 1001 to iReturnVal
52585>>>>>>>            Else If (Witemx.Recnum       =0) Move 1002 to iReturnVal
52589>>>>>>>            Else If (Particle.Recnum     =0) Move 1003 to iReturnVal
52593>>>>>>>            Else If (Pmoves.Pms_Qty      =0) Move 1004 to iReturnVal
52597>>>>>>>            Else If ( (Sysfile.Hm_Kleisimatos<>'') And ;                      (Particle.Partl_Hmnia<=Sysfile.Hm_Kleisimatos) ) ;                     Move 1110 to iReturnVal
52601>>>>>>>            Else Begin
52602>>>>>>>                //If (Pmoves.Timol_Ypol<0)                        Move 7001 to iReturnVal
52602>>>>>>>//////                GTS 09-06-06
52602>>>>>>>//                If (Pmoves.Qty_Kinhshs>Pmoves.Timol_Ypol)  Move 1013 to iReturnVal
52602>>>>>>>//                Else If (Pmoves.Timol_Ypol>Pmoves.Pms_Qty)      Move 6655 to iReturnVal
52602>>>>>>>                // SOS SOS SOS 24/10/2002 ¨¦©¦¨ ¤˜ Off š ˜«  ®«¬§˜œ  ©« ª ˜¤«¢ œª
52602>>>>>>>
52602>>>>>>>//                Else If ((Ptyppar.Ptyppar_Is_What='2') And (Ptyppar.Check_Posa_Plaf='1')) Begin
52602>>>>>>>//                    If (Pmoves.Posa_Apo_Dap=0) Begin
52602>>>>>>>//                        Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
52602>>>>>>>//                        If (iYes=MBR_NO) Move 6001 to iReturnVal
52602>>>>>>>//                    End
52602>>>>>>>//                End
52602>>>>>>>//                Else If ((Clients.Plafon>0) And ;
52602>>>>>>>//                    ((Clients.Ypoloipo+Pmoves.Posa_Apo_Dap)>Clients.Plafon) And ;
52602>>>>>>>//                    (Ptyppar.Check_Posa_Plaf='1')) Begin
52602>>>>>>>//                        Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
52602>>>>>>>//                        If (iYes=MBR_NO) Move 1010 to iReturnVal
52602>>>>>>>//                End
52602>>>>>>>//                Else If ((PayResp.Plafon>0) And ;
52602>>>>>>>//                        ((PayResp.Ypoloipo+Pmoves.Posa_Apo_Dap)>PayResp.Plafon) And ;
52602>>>>>>>//                         (Ptyppar.Check_Posa_Plaf='1')) Begin
52602>>>>>>>//                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
52602>>>>>>>//                        If (iYes=MBR_NO) Move 1011 to iReturnVal
52602>>>>>>>//                End
52602>>>>>>>                If ((pmoves.clorderd_recr <> '') and (pifromclorder(self)<>1)) begin //?? Pmoves ???ÿ????š???? ? ???????êœ??
52604>>>>>>>                    get pnoqty to nqty
52605>>>>>>>                    if (nqty <> pmoves.pms_qty)                 Move 7000 to iReturnVal
52608>>>>>>>                End
52608>>>>>>>>
52608>>>>>>>
52608>>>>>>>                Else If ((Pmoves.Qty_Ypol=1) And (piFromMetasx(Self)=0)) begin
52611>>>>>>>                    // js 28/08/2002
52611>>>>>>>                    // To pedio Qty_Ypol xrhsimopoihtai gia na flagarei an ena Pmove
52611>>>>>>>                    // exei proelthei apo metasxhmatismo (Eite sygkentrotika, eite analytika)
52611>>>>>>>                    // To xrhsimopoihsame ayto gia na mhn anoixtei neo pedio.
52611>>>>>>>                    // An loipon exei proelthei apo metasxhmatismo DEN epitrepetai tropopoihsh
52611>>>>>>>                    // ths posothtas tou ap' eutheias alla mono meso ths posothtas mias
52611>>>>>>>                    // sygkekrimenhs eggrafhs tou arxeiou PmsSxet
52611>>>>>>>                    If (Operation_Origin=Self) Begin
52613>>>>>>>                        get pnoqty to nqty
52614>>>>>>>                        if (nqty <> pmoves.pms_qty)             Move 7005 to iReturnVal
52617>>>>>>>
52617>>>>>>>                        // js 22/12/2003
52617>>>>>>>                        // Epishs DEN epitrepetai allagh eidous
52617>>>>>>>                        // Pianoume to bug pou se metasxhmatismeno parastatiko
52617>>>>>>>                        // mporouse na allaxei to eidos me F7/F8
52617>>>>>>>                        Get psOldItem to sOldItem
52618>>>>>>>                        If (Item.Item_Code<>sOldItem) Move 8001 to iReturnVal
52621>>>>>>>                    End
52621>>>>>>>>
52621>>>>>>>                End
52621>>>>>>>>
52621>>>>>>>            End
52621>>>>>>>>
52621>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
52624>>>>>>>        End
52624>>>>>>>>
52624>>>>>>>        Function_Return iReturnVal
52625>>>>>>>    End_Function   // Validate_Save
52626>>>>>>>
52626>>>>>>>    Function Validate_Delete  Returns Integer
52627>>>>>>>        Integer iReturnVal
52628>>>>>>>        Forward Get Validate_Delete  To iReturnVal
52630>>>>>>>        If (Not(iReturnVal)) Begin
52632>>>>>>>            If (Particle.Partl_Timol=1) Move 1009 to iReturnVal
52635>>>>>>>            Else If ( (Sysfile.Hm_Kleisimatos<>'') And ;                      (Particle.Partl_Hmnia<=Sysfile.Hm_Kleisimatos) ) ;                Move 1110 to iReturnVal
52639>>>>>>>            Else If ((pmoves.qty_ypol=1) And (Operation_Origin=Self)) Move 1012 to iReturnVal
52643>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
52646>>>>>>>        End
52646>>>>>>>>
52646>>>>>>>        Function_Return iReturnVal
52647>>>>>>>    End_Function   // Validate_Delete
52648>>>>>>>
52648>>>>>>>    Procedure Set_UnitPrice integer iField  Number nNum
52649>>>>>>>        Local Integer   Changed
52650>>>>>>>        Local Number    nInt
52650>>>>>>>        Get Field_Changed_State iField to Changed
52651>>>>>>>        If (Changed=0 AND nNum=0) Begin
52653>>>>>>>            Get fnTeleytaiaTimh to nInt
52654>>>>>>>            Set Field_Default_Value iField to nInt
52655>>>>>>>        End
52655>>>>>>>>
52655>>>>>>>    End_Procedure   // Shmera
52656>>>>>>>
52656>>>>>>>    Procedure Set_Discount integer iField  Number nNum
52657>>>>>>>        Local Integer Changed
52658>>>>>>>        Local Number nInt
52658>>>>>>>        Get Field_Changed_State iField to Changed
52659>>>>>>>        If (Changed=0 AND nNum=0) Begin
52661>>>>>>>            Get fnTeleytaiaTimh to nInt
52662>>>>>>>            If (nInt<0) Begin
52664>>>>>>>                Move (nInt*(-1)) to nInt
52665>>>>>>>                Set Field_Default_Value iField to nInt
52666>>>>>>>            End
52666>>>>>>>>
52666>>>>>>>        End
52666>>>>>>>>
52666>>>>>>>    End_Procedure   // Shmera
52667>>>>>>>
52667>>>>>>>    Procedure Set_FPA integer iField  Number nNum
52668>>>>>>>        Local Integer Changed
52669>>>>>>>        Local Number nInt
52669>>>>>>>        Get Field_Changed_State iField to Changed
52670>>>>>>>        If (Changed=0 AND nNum=0) Begin
52672>>>>>>>            Move Item.Fpa_Pososto to nInt
52673>>>>>>>            Set Field_Default_Value iField to nInt
52674>>>>>>>        End
52674>>>>>>>>
52674>>>>>>>    End_Procedure   // Shmera
52675>>>>>>>
52675>>>>>>>    // Define_Fields:
52675>>>>>>>    // This procedure is used to set up all data-dictionary rules.
52675>>>>>>>
52675>>>>>>>    Procedure Define_Fields
52676>>>>>>>        Forward Send Define_Fields
52678>>>>>>>        //DDB-Generated-Code-Location
52678>>>>>>>        //DDB-DefineFieldStart
52678>>>>>>>
52678>>>>>>>        Set Main_File            To Pmoves.File_Number
52679>>>>>>>
52679>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
52680>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
52681>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
52682>>>>>>>
52682>>>>>>>        // Child (Client) file structure................
52682>>>>>>>        Send Add_Client_File  Pmsdtl.File_Number
52683>>>>>>>
52683>>>>>>>        // Parent (Server) file structure...............
52683>>>>>>>        Send Add_Server_File  Wax.File_Number
52684>>>>>>>        Send Add_Server_File  Witemx.File_Number
52685>>>>>>>        Send Add_Server_File  Particle.File_Number
52686>>>>>>>
52686>>>>>>>        // External (System) file structure.............
52686>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_NEW_SAVE
52687>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
52688>>>>>>>        Send Add_System_File  Partlfpa.File_Number  DD_LOCK_ON_ALL
52689>>>>>>>        Send Add_System_File  Clorder.File_Number  DD_LOCK_ON_ALL
52690>>>>>>>        Send Add_System_File  Clorderd.File_Number  DD_LOCK_ON_ALL
52691>>>>>>>        Send Add_System_File  Btnemp.File_Number  DD_LOCK_ON_ALL
52692>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
52693>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
52694>>>>>>>
52694>>>>>>>        Define_Auto_Increment  Sysrecp.Pmoves_Rec0  To Pmoves.Pms_Rec0
52697>>>>>>>
52697>>>>>>>        // Field-based properties.......................
52697>>>>>>>
52697>>>>>>>        // Pmoves.Company_Code
52697>>>>>>>
52697>>>>>>>        // Pmoves.Branch_Code
52697>>>>>>>
52697>>>>>>>        // Pmoves.Year_Year
52697>>>>>>>
52697>>>>>>>        // Pmoves.Ctypkin_Code
52697>>>>>>>
52697>>>>>>>        // Pmoves.Wtypkin_Code
52697>>>>>>>
52697>>>>>>>        // Pmoves.Custprom_Code
52697>>>>>>>
52697>>>>>>>        // Pmoves.Client_Id
52697>>>>>>>
52697>>>>>>>        // Pmoves.Cn_Code
52697>>>>>>>
52697>>>>>>>        // Pmoves.Ptyppar_Code
52697>>>>>>>
52697>>>>>>>        // Pmoves.Partl_Hmnia
52697>>>>>>>
52697>>>>>>>        // Pmoves.Pseira_Seira
52697>>>>>>>
52697>>>>>>>        // Pmoves.Partl_No
52697>>>>>>>
52697>>>>>>>        // Pmoves.Partl_Rec0
52697>>>>>>>
52697>>>>>>>        // Pmoves.Witemkat_Code
52697>>>>>>>
52697>>>>>>>        // Pmoves.Units_Code
52697>>>>>>>
52697>>>>>>>        // Pmoves.Item_Code
52697>>>>>>>
52697>>>>>>>        // Pmoves.Witemx_Code
52697>>>>>>>
52697>>>>>>>        // Pmoves.Wapokat_Code
52697>>>>>>>
52697>>>>>>>        // Pmoves.Wapomast_Code
52697>>>>>>>
52697>>>>>>>        // Pmoves.Wax_Code
52697>>>>>>>
52697>>>>>>>        // Pmoves.Wax_Recr
52697>>>>>>>
52697>>>>>>>        // Pmoves.Witemx_Recr
52697>>>>>>>
52697>>>>>>>        // Pmoves.Partl_Recr
52697>>>>>>>
52697>>>>>>>        // Pmoves.Pms_Rec0
52697>>>>>>>        Set Field_Options          Field Pmoves.Pms_Rec0 To DD_AUTOFIND
52698>>>>>>>
52698>>>>>>>        // Pmoves.Pms_No
52698>>>>>>>
52698>>>>>>>        // Pmoves.Pms_Recr
52698>>>>>>>
52698>>>>>>>        // Pmoves.Pms_Unitcode
52698>>>>>>>
52698>>>>>>>        // Pmoves.Pms_Qty
52698>>>>>>>
52698>>>>>>>        // Pmoves.Pms_Unitprice
52698>>>>>>>        Set Field_Entry_msg        Field Pmoves.Pms_Unitprice To Set_UnitPrice
52699>>>>>>>
52699>>>>>>>        // Pmoves.Pms_Ambd
52699>>>>>>>
52699>>>>>>>        // Pmoves.Pms_Pctdisc
52699>>>>>>>        Set Field_Entry_msg        Field Pmoves.Pms_Pctdisc To Set_Discount
52700>>>>>>>
52700>>>>>>>        // Pmoves.Pms_Discam
52700>>>>>>>
52700>>>>>>>        // Pmoves.Pms_Amaftdisc
52700>>>>>>>
52700>>>>>>>        // Pmoves.Pms_Vatpct
52700>>>>>>>        Set Field_Entry_msg        Field Pmoves.Pms_Vatpct To Set_FPA
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_Vatam
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_Exrampct
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_Exdet
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_Payable
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_Axia
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_X0
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_P0
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_X00
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_P00
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_X1
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_P1
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_X2
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_P2
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_Dlixis
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_A_Code
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_Status_E
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_Status_A
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_S0
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_Ys0
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_S1
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_Ys1
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_S2
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_Ys2
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_Sc_Code2
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_Open
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_Aopen
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_M_Code
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_Yn_Myf
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_Myf_Axia
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_Kk
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_C_Code2
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_Cn_Code
52701>>>>>>>
52701>>>>>>>        // Pmoves.Wcmoves_Recr
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_Module
52701>>>>>>>
52701>>>>>>>        // Pmoves.Btnl2_Recr
52701>>>>>>>
52701>>>>>>>        // Pmoves.Btnemp_Recr
52701>>>>>>>
52701>>>>>>>        // Pmoves.Btarticle_Recr
52701>>>>>>>
52701>>>>>>>        // Pmoves.Sls_Id
52701>>>>>>>
52701>>>>>>>        // Pmoves.Presp_Id
52701>>>>>>>
52701>>>>>>>        // Pmoves.Cnt_Id
52701>>>>>>>
52701>>>>>>>        // Pmoves.Mhxanik_Id
52701>>>>>>>
52701>>>>>>>        // Pmoves.Extra_Epimer
52701>>>>>>>
52701>>>>>>>        // Pmoves.Ekpt_Epimer
52701>>>>>>>
52701>>>>>>>        // Pmoves.Clorderd_Recr
52701>>>>>>>
52701>>>>>>>        // Pmoves.Witemx_Descr
52701>>>>>>>
52701>>>>>>>        // Pmoves.Ptyppar_Descr
52701>>>>>>>
52701>>>>>>>        // Pmoves.Ti_Typonei_Pms
52701>>>>>>>
52701>>>>>>>        // Pmoves.Timol_Qty
52701>>>>>>>
52701>>>>>>>        // Pmoves.Timol_Ypol
52701>>>>>>>
52701>>>>>>>        // Pmoves.Posa_Apo_Dap
52701>>>>>>>
52701>>>>>>>        // Pmoves.Qty_Ypol
52701>>>>>>>
52701>>>>>>>        // Pmoves.Pms_Selected
52701>>>>>>>        Set Field_Class_Name       Field Pmoves.Pms_Selected To "dbCheckBoxsub"
52702>>>>>>>
52702>>>>>>>        // Pmoves.Qty_Kinhshs
52702>>>>>>>
52702>>>>>>>        // Pmoves.Sx_Parast
52702>>>>>>>
52702>>>>>>>        // Pmoves.Sx_Hmnia
52702>>>>>>>
52702>>>>>>>        // Pmoves.Sx_Seira
52702>>>>>>>
52702>>>>>>>        // Pmoves.Sx_Arithmos
52702>>>>>>>
52702>>>>>>>        // Pmoves.Pump_Id
52702>>>>>>>
52702>>>>>>>        // Pmoves.Car_Id
52702>>>>>>>
52702>>>>>>>        // Pmoves.Item_Ypot
52702>>>>>>>
52702>>>>>>>        // Pmoves.Qty_Return
52702>>>>>>>
52702>>>>>>>        // Pmoves.Client_Name
52702>>>>>>>
52702>>>>>>>        // Pmoves.Zone
52702>>>>>>>
52702>>>>>>>        //DDB-DefineFieldEnd
52702>>>>>>>    End_Procedure    // Define_Fields
52703>>>>>>>
52703>>>>>>>    // Field_Defaults:
52703>>>>>>>    // This procedure is used to establish default field values.
52703>>>>>>>
52703>>>>>>>    Procedure Field_Defaults
52704>>>>>>>        Forward Send Field_Defaults
52706>>>>>>>        //DDB-Generated-Code-Location
52706>>>>>>>        //DDB-FieldDefaultStart
52706>>>>>>>        //DDB-FieldDefaultEnd
52706>>>>>>>        //Set Field_Changed_Value Field Pmoves.Pms_VatPct to Item.Fpa_Pososto
52706>>>>>>>    End_Procedure    // Field_Defaults
52707>>>>>>>
52707>>>>>>>End_Class    // Pmoves_DataDictionary
52708>>>>>>>//DDB-FileEnd
52708>>>>>    Use PmsDtl.DD
INCLUDING FILE: PMSDTL.DD
52708>>>>>>>//DDB-FileStart
52708>>>>>>>//DDB-HeaderStart
52708>>>>>>>
52708>>>>>>>// File Name : PmsDtl.DD
52708>>>>>>>// Class Name: Pmsdtl_DataDictionary
52708>>>>>>>// Revision  : 0
52708>>>>>>>// Version   : 2
52708>>>>>>>
52708>>>>>>>Use  Windows           // Basic Definitions
52708>>>>>>>Use  DataDict          // DataDictionary Class Definition
52708>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
52708>>>>>>>
52708>>>>>>>Open Pmsdtl
52710>>>>>>>Open Pmoves
52712>>>>>>>
52712>>>>>>>//DDB-HeaderEnd
52712>>>>>>>
52712>>>>>>>Class Pmsdtl_DataDictionary  is a DataDictionary_Sec
52713>>>>>>>
52713>>>>>>>    // Define_Fields:
52713>>>>>>>    // This procedure is used to set up all data-dictionary rules.
52713>>>>>>>
52713>>>>>>>    Procedure Define_Fields
52714>>>>>>>        Forward Send Define_Fields
52716>>>>>>>        //DDB-Generated-Code-Location
52716>>>>>>>        //DDB-DefineFieldStart
52716>>>>>>>
52716>>>>>>>        Set Main_File            To Pmsdtl.File_Number
52717>>>>>>>
52717>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
52718>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
52719>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
52720>>>>>>>
52720>>>>>>>        // Parent (Server) file structure...............
52720>>>>>>>        Send Add_Server_File  Pmoves.File_Number
52721>>>>>>>
52721>>>>>>>        // Field-based properties.......................
52721>>>>>>>
52721>>>>>>>        // Pmsdtl.Pms_Recr
52721>>>>>>>        Set Field_Options          Field Pmsdtl.Pms_Recr To DD_AUTOFIND   
52722>>>>>>>        Set Key_Field_State        Field Pmsdtl.Pms_Recr To TRUE
52723>>>>>>>
52723>>>>>>>        // Pmsdtl.Line1
52723>>>>>>>
52723>>>>>>>        // Pmsdtl.Line2
52723>>>>>>>
52723>>>>>>>        // Pmsdtl.Line3
52723>>>>>>>
52723>>>>>>>        // Pmsdtl.Line4
52723>>>>>>>
52723>>>>>>>        // Pmsdtl.Line5
52723>>>>>>>
52723>>>>>>>        //DDB-DefineFieldEnd
52723>>>>>>>    End_Procedure    // Define_Fields
52724>>>>>>>
52724>>>>>>>    // Field_Defaults:
52724>>>>>>>    // This procedure is used to establish default field values.
52724>>>>>>>
52724>>>>>>>    Procedure Field_Defaults
52725>>>>>>>        Forward Send Field_Defaults
52727>>>>>>>        //DDB-Generated-Code-Location
52727>>>>>>>        //DDB-FieldDefaultStart
52727>>>>>>>        //DDB-FieldDefaultEnd
52727>>>>>>>    End_Procedure    // Field_Defaults
52728>>>>>>>
52728>>>>>>>End_Class    // Pmsdtl_DataDictionary
52729>>>>>>>//DDB-FileEnd
52729>>>>>    Use BAXIOKAT.DD
52729>>>>>    Use SYSCURXR.DD
INCLUDING FILE: SYSCURXR.DD
52729>>>>>>>//DDB-FileStart
52729>>>>>>>//DDB-HeaderStart
52729>>>>>>>
52729>>>>>>>// File Name : SYSCURXR.DD
52729>>>>>>>// Class Name: Syscurxr_DataDictionary
52729>>>>>>>// Revision  : 8
52729>>>>>>>// Version   : 2
52729>>>>>>>
52729>>>>>>>Use  Windows           // Basic Definitions
52729>>>>>>>Use  DataDict          // DataDictionary Class Definition
52729>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
52729>>>>>>>
52729>>>>>>>Open Syscurxr
52731>>>>>>>
52731>>>>>>>//DDB-HeaderEnd
52731>>>>>>>
52731>>>>>>>Class Syscurxr_DataDictionary  is a DataDictionary_Sec
52732>>>>>>>
52732>>>>>>>    // Define_Fields:
52732>>>>>>>    // This procedure is used to set up all data-dictionary rules.
52732>>>>>>>
52732>>>>>>>    Procedure Define_Fields
52733>>>>>>>        Forward Send Define_Fields
52735>>>>>>>        //DDB-Generated-Code-Location
52735>>>>>>>        //DDB-DefineFieldStart
52735>>>>>>>
52735>>>>>>>        Set Main_File            To Syscurxr.File_Number
52736>>>>>>>
52736>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
52737>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
52738>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
52739>>>>>>>
52739>>>>>>>        // Field-based properties.......................
52739>>>>>>>
52739>>>>>>>        // Syscurxr.Company_Code
52739>>>>>>>
52739>>>>>>>        // Syscurxr.Branch_Code
52739>>>>>>>
52739>>>>>>>        // Syscurxr.Year_Year
52739>>>>>>>
52739>>>>>>>        // Syscurxr.Branch_Site
52739>>>>>>>
52739>>>>>>>        // Syscurxr.Year_Recr
52739>>>>>>>
52739>>>>>>>        // Syscurxr.Company_Name
52739>>>>>>>
52739>>>>>>>        // Syscurxr.Branch_Name
52739>>>>>>>
52739>>>>>>>        // Syscurxr.Year_Descr
52739>>>>>>>
52739>>>>>>>        // Syscurxr.C_Code0
52739>>>>>>>
52739>>>>>>>        // Syscurxr.C_Code00
52739>>>>>>>
52739>>>>>>>        // Syscurxr.C_Coder
52739>>>>>>>
52739>>>>>>>        // Syscurxr.Year_Xrhshfrom
52739>>>>>>>
52739>>>>>>>        // Syscurxr.Year_Xrhshto
52739>>>>>>>
52739>>>>>>>        // Syscurxr.Beto_Site
52739>>>>>>>
52739>>>>>>>        // Syscurxr.Euro_Code
52739>>>>>>>
52739>>>>>>>        //DDB-DefineFieldEnd
52739>>>>>>>    End_Procedure    // Define_Fields
52740>>>>>>>
52740>>>>>>>    // Field_Defaults:
52740>>>>>>>    // This procedure is used to establish default field values.
52740>>>>>>>
52740>>>>>>>    Procedure Field_Defaults
52741>>>>>>>        Forward Send Field_Defaults
52743>>>>>>>        //DDB-Generated-Code-Location
52743>>>>>>>        //DDB-FieldDefaultStart
52743>>>>>>>        //DDB-FieldDefaultEnd
52743>>>>>>>    End_Procedure    // Field_Defaults
52744>>>>>>>
52744>>>>>>>End_Class    // Syscurxr_DataDictionary
52745>>>>>>>//DDB-FileEnd
52745>>>>>    Use PMSSXET.DD
INCLUDING FILE: PMSSXET.DD
52745>>>>>>>//DDB-FileStart
52745>>>>>>>//DDB-HeaderStart
52745>>>>>>>
52745>>>>>>>// File Name : PMSSXET.DD
52745>>>>>>>// Class Name: PmsSxet_DataDictionary
52745>>>>>>>// Revision  : 27
52745>>>>>>>// Version   : 2
52745>>>>>>>
52745>>>>>>>Use  Windows           // Basic Definitions
52745>>>>>>>Use  DataDict          // DataDictionary Class Definition
52745>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
52745>>>>>>>
52745>>>>>>>Open Pmssxet
INCLUDING FILE: PMSSXET.FD
52747>>>>>>>
52747>>>>>>>//DDB-HeaderEnd
52747>>>>>>>
52747>>>>>>>Use bpEnYpol.dg
INCLUDING FILE: BPENYPOL.DG
52747>>>>>>>>>//AB/ Project bpEnYpol
52747>>>>>>>>>//AB/ Object prj is a Dialog_Project
52747>>>>>>>>>//AB/     Set ProjectName to "bpEnYpol"
52747>>>>>>>>>//AB/     Set ProjectFileName to "bpEnYpol.DG"
52747>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
52747>>>>>>>>>
52747>>>>>>>>>// Project Object Structure
52747>>>>>>>>>//   bpEnYpol is a BusinessProcessSub
52747>>>>>>>>>
52747>>>>>>>>>// Register all objects
52747>>>>>>>>>Register_Object bpEnYpol
52747>>>>>>>>>
52747>>>>>>>>>
52747>>>>>>>>>//AB-IgnoreStart
52747>>>>>>>>>
52747>>>>>>>>>Use Bproces.Sub
52747>>>>>>>>>
52747>>>>>>>>>
52747>>>>>>>>>//AB-IgnoreEnd
52747>>>>>>>>>
52747>>>>>>>>>Object bpEnYpol is a BusinessProcessSub
52749>>>>>>>>>
52749>>>>>>>>>    //AB-StoreTopStart
52749>>>>>>>>>
52749>>>>>>>>>    Open Pmoves
52751>>>>>>>>>    Open Psxetika
52753>>>>>>>>>
52753>>>>>>>>>    Set Status_Panel_State to False
52754>>>>>>>>>    //Set Allow_Cancel_State  to True
52754>>>>>>>>>    Set Display_Error_State to True
52755>>>>>>>>>    //Set Process_Title to "               "
52755>>>>>>>>>    //Set Status_Log_id to (status_log(Self)) //Use statlog.pkg
52755>>>>>>>>>    //Set Status_log_state to True
52755>>>>>>>>>
52755>>>>>>>>>    Property Integer    piFromAkyrosh       Public  0
52757>>>>>>>>>    Property Integer    piLathos            Public  0
52759>>>>>>>>>    Property Number     pnQty               Public  0
52761>>>>>>>>>    Property Integer    piCurrentPartl      Public  0
52763>>>>>>>>>    Property Integer    piCurrentPmoves     Public  0
52765>>>>>>>>>    Property Integer    piCurrentPmsSxet    Public  0
52767>>>>>>>>>    Property String     psRecr              Public ''
52769>>>>>>>>>
52769>>>>>>>>>
52769>>>>>>>>>    //AB-StoreTopEnd
52769>>>>>>>>>
52769>>>>>>>>>    Set Size to 60 100
52770>>>>>>>>>    Set Location to 4 5
52771>>>>>>>>>
52771>>>>>>>>>    //AB-DDOStart
52771>>>>>>>>>
52771>>>>>>>>>
52771>>>>>>>>>    //AB-DDOEnd
52771>>>>>>>>>
52771>>>>>>>>>
52771>>>>>>>>>    //AB-StoreStart
52771>>>>>>>>>
52771>>>>>>>>>    Function fiUpdate_Pmoves_Qty String asRecr Number anQty Integer aiDoNotOpen Returns Integer
52773>>>>>>>>>        Clear Pmoves
52774>>>>>>>>>        Move asRecr to Pmoves.Pms_Recr
52775>>>>>>>>>        Find Eq Pmoves by index.2
52776>>>>>>>>>>
52776>>>>>>>>>        If (Found) Begin
52778>>>>>>>>>            If ((Pmoves.Timol_Qty+anQty) > Pmoves.Pms_Qty)      Function_Return 40001
52781>>>>>>>>>            Else Begin
52782>>>>>>>>>                Add anQty to Pmoves.Timol_Qty
52783>>>>>>>>>                Move (Pmoves.Pms_Qty-Pmoves.Timol_Qty) to Pmoves.Timol_Ypol
52784>>>>>>>>>                If (Pmoves.Timol_Ypol>Pmoves.Pms_Qty)  Function_Return 40003
52787>>>>>>>>>                Saverecord Pmoves
52788>>>>>>>>>
52788>>>>>>>>>                Clear Particle
52789>>>>>>>>>                Move Pmoves.Partl_Recr to Particle.Partl_Recr
52790>>>>>>>>>                Find Eq Particle by Index.2
52791>>>>>>>>>>
52791>>>>>>>>>                If (Found) Begin
52793>>>>>>>>>                   // Reread
52793>>>>>>>>>                    Add anQty to Particle.Timol_Qty
52794>>>>>>>>>                    If (Particle.Partl_TotTem>0) Begin
52796>>>>>>>>>                        Move (Particle.Partl_TotTem-Particle.Timol_Qty)     to Particle.Timol_Ypol
52797>>>>>>>>>
52797>>>>>>>>>                        If (aiDoNotOpen=1)  Move 1                          to Particle.Partl_Timol
52800>>>>>>>>>                        Else                Move (Particle.Timol_Ypol=0 )   to Particle.Partl_Timol
52802>>>>>>>>>
52802>>>>>>>>>                    End
52802>>>>>>>>>>
52802>>>>>>>>>                    Else Move 0 to Particle.Partl_Timol
52804>>>>>>>>>                    Saverecord Particle
52805>>>>>>>>>                   // Unlock
52805>>>>>>>>>                End
52805>>>>>>>>>>
52805>>>>>>>>>                Else Function_Return 40002
52807>>>>>>>>>            End
52807>>>>>>>>>>
52807>>>>>>>>>        End
52807>>>>>>>>>>
52807>>>>>>>>>        Else Function_Return 40000
52809>>>>>>>>>        Function_Return 0
52810>>>>>>>>>    End_Function
52811>>>>>>>>>
52811>>>>>>>>>    Procedure OnProcess
52813>>>>>>>>>        Integer iLathos iSub iAkyro
52814>>>>>>>>>        String  sCurr sRecr sPmoveRecr sParticleRecr
52814>>>>>>>>>        Number  nQty nQty2
52814>>>>>>>>>
52814>>>>>>>>>        Set piLathos        to 0
52815>>>>>>>>>        Get pnQty           to nQty2
52816>>>>>>>>>        Get psRecr          to sRecr
52817>>>>>>>>>        Get piFromAkyrosh   to iAkyro
52818>>>>>>>>>
52818>>>>>>>>>        // An h posothta einai setarismenh thetika shmainei pos klhthike
52818>>>>>>>>>        // apo thn Update tou PmsSxet, allios an erthei arnhtikh apo thn Backout
52818>>>>>>>>>        // Prepei na to xeroume gia thn periptosh tou akyrotikou, opou tha trexei
52818>>>>>>>>>        // apanota h function kai tha antistrpsei to proshmo ths posothtas.
52818>>>>>>>>>        Move (nQty2<0)   to iSub
52819>>>>>>>>>
52819>>>>>>>>>
52819>>>>>>>>>        Get fiUpdate_Pmoves_Qty sRecr nQty2 0 to iLathos
52820>>>>>>>>>
52820>>>>>>>>>        If (iLathos) Begin
52822>>>>>>>>>            Set piLathos to iLathos
52823>>>>>>>>>            Procedure_Return
52824>>>>>>>>>        End
52824>>>>>>>>>>
52824>>>>>>>>>
52824>>>>>>>>>
52824>>>>>>>>>        // js 30/08/2002 Enhmerosh ena bhma pio piso sthn periptosh pou
52824>>>>>>>>>        // h enhmerosh ton pmoves apo backout kai update tou PmsSxet,
52824>>>>>>>>>        // afora Akyrotiko. (DAP --> TIM --> AKYROTIKO). Erxomaste dhladh edo apo
52824>>>>>>>>>        // AKYROTIKO na enhmerosoume tis posothtes tou TIMOLOGIOU.
52824>>>>>>>>>        // Sthn periptosh ayth prepei na kanoume ta exhs:
52824>>>>>>>>>        // 1. Eyresh ton sxetikon tou trxontos pmove TIMOLOGIOU
52824>>>>>>>>>        // 2. Antistrofh tou proshmou ths posothtas tous
52824>>>>>>>>>        // 3. Eyresh tou arxikou Pmoves (DAP) kai enhmerosh posothtas kinhshs
52824>>>>>>>>>
52824>>>>>>>>>        If (iAkyro) Begin
52826>>>>>>>>>            Clear Pmoves
52827>>>>>>>>>            Move sRecr to Pmoves.Pms_Recr
52828>>>>>>>>>            Find Eq Pmoves by index.2
52829>>>>>>>>>>
52829>>>>>>>>>            If (Found) Begin
52831>>>>>>>>>                Clear PmsSxet
52832>>>>>>>>>                Move sRecr to PmsSxet.Pms_Recr
52833>>>>>>>>>                Find Gt PmsSxet by Index.1
52834>>>>>>>>>>
52834>>>>>>>>>                While ((Found=1) And (PmsSxet.Pms_Recr=sRecr))
52838>>>>>>>>>                    Move PmsSxet.Sxetiko_Recr   to sCurr
52839>>>>>>>>>                    Move PmsSxet.Posothta       to nQty
52840>>>>>>>>>                    If (iSub) Begin
52842>>>>>>>>>                        // An Exei erthei apo Backout tou PmsSxet (to gnorizoume apo thn posothta
52842>>>>>>>>>                        // h opoia sto property einai arnhtikh) tote gyrname thn posothta tou
52842>>>>>>>>>                        // PmsSxet thetikh (Ousiastika thn afhnoume opos einai dhladh).
52842>>>>>>>>>                    End
52842>>>>>>>>>>
52842>>>>>>>>>                    Else Begin
52843>>>>>>>>>                        // An Exei erthei apo Update tou PmsSxet (to gnorizoume apo thn posothta
52843>>>>>>>>>                        // h opoia sto property einai thetikh) tote gyrname thn posothta tou
52843>>>>>>>>>                        // PmsSxet arnhtikh.
52843>>>>>>>>>                        Move (nQty*(-1)) to nQty
52844>>>>>>>>>                    End
52844>>>>>>>>>>
52844>>>>>>>>>
52844>>>>>>>>>                    //Get fiUpdate_Pmoves_Qty sCurr nQty 1 to iLathos
52844>>>>>>>>>                    // 07/01/2003 //
52844>>>>>>>>>                    Get fiUpdate_Pmoves_Qty sCurr nQty 0 to iLathos
52845>>>>>>>>>
52845>>>>>>>>>                    If (iLathos) Begin
52847>>>>>>>>>                        Set piLathos to (iLathos+3)
52848>>>>>>>>>                        // An Gyrisei Pmoves Not Found      (40000) To kanoume 40003
52848>>>>>>>>>                        // An Gyrisei problhma sto ypoloipo (40001) To kanoume 40004
52848>>>>>>>>>                        // An Gyrisei problhma sto particle (40002) To kanoume 40005
52848>>>>>>>>>                        // An Gyrisei problhma sto particle (40003) To kanoume 40006
52848>>>>>>>>>                        Procedure_Return
52849>>>>>>>>>                    End
52849>>>>>>>>>>
52849>>>>>>>>>
52849>>>>>>>>>                    Clear PmsSxet
52850>>>>>>>>>                    Move sRecr      to PmsSxet.Pms_Recr
52851>>>>>>>>>                    Move sCurr      to PmsSxet.Sxetiko_Recr
52852>>>>>>>>>                    Find Eq PmsSxet by Index.1
52853>>>>>>>>>>
52853>>>>>>>>>                    Find Gt PmsSxet by Index.1
52854>>>>>>>>>>
52854>>>>>>>>>                Loop
52855>>>>>>>>>>
52855>>>>>>>>>            End
52855>>>>>>>>>>
52855>>>>>>>>>            Else Set piLathos to 40007
52857>>>>>>>>>        End
52857>>>>>>>>>>
52857>>>>>>>>>
52857>>>>>>>>>        If (piLathos(Self)<>0) Procedure_Return
52860>>>>>>>>>
52860>>>>>>>>>    End_Procedure
52861>>>>>>>>>
52861>>>>>>>>>    Procedure OnError integer error_info string errMsg
52863>>>>>>>>>    End_Procedure
52864>>>>>>>>>
52864>>>>>>>>>    Procedure Start_Process
52866>>>>>>>>>        Forward Send Start_Process
52868>>>>>>>>>    End_Procedure
52869>>>>>>>>>
52869>>>>>>>>>    Procedure End_Process
52871>>>>>>>>>        Forward Send End_Process
52873>>>>>>>>>        If (piCurrentPartl(Self)) Begin
52875>>>>>>>>>            Clear Particle
52876>>>>>>>>>            Move (piCurrentPartl(Self)) to Particle.Recnum
52877>>>>>>>>>            Find Eq Particle.Recnum
52878>>>>>>>>>>
52878>>>>>>>>>        End
52878>>>>>>>>>>
52878>>>>>>>>>        If (piCurrentPmoves(Self)) Begin
52880>>>>>>>>>            Clear Pmoves
52881>>>>>>>>>            Move (piCurrentPmoves(Self)) to Pmoves.Recnum
52882>>>>>>>>>            Find Eq Pmoves.Recnum
52883>>>>>>>>>>
52883>>>>>>>>>        End
52883>>>>>>>>>>
52883>>>>>>>>>        If (piCurrentPmsSxet(Self)<>0) Begin
52885>>>>>>>>>            Clear PmsSxet
52886>>>>>>>>>            Move (piCurrentPmsSxet(Self)) to PmsSxet.Recnum
52887>>>>>>>>>            Find Eq PmsSxet.Recnum
52888>>>>>>>>>>
52888>>>>>>>>>        End
52888>>>>>>>>>>
52888>>>>>>>>>    End_Procedure
52889>>>>>>>>>
52889>>>>>>>>>    //AB-StoreEnd
52889>>>>>>>>>
52889>>>>>>>>>End_Object    // bpEnYpol
52890>>>>>>>>>
52890>>>>>>>>>//AB/ End_Object    // prj
52890>>>>>>>Use MyArray.dg
52890>>>>>>>//Use bpMakeSx.dg
52890>>>>>>>
52890>>>>>>>Class PmsSxet_DataDictionary  is a DataDictionary_Sec
52891>>>>>>>
52891>>>>>>>    Procedure Construct_Object
52892>>>>>>>        Forward Send Construct_Object
52894>>>>>>>        Property Integer piFromCreate   Public 0
52895>>>>>>>    End_Procedure
52896>>>>>>>
52896>>>>>>>    Procedure Creating
52897>>>>>>>        Forward Send Creating
52899>>>>>>>        Set piFromCreate to 1
52900>>>>>>>    End_Procedure
52901>>>>>>>
52901>>>>>>>    Procedure Update
52902>>>>>>>        String  sRecr1 sRecr2 sPmsSxet
52903>>>>>>>        Number  nQty
52903>>>>>>>        Integer iLathos iCurrentPmoves iAkyro iCurrentPmsSxet iCurrentPartl
52903>>>>>>>
52903>>>>>>>        Forward Send Update
52905>>>>>>>
52905>>>>>>>        Move (Trim(Particle.Partl_LastNo)='1')  to iAkyro
52906>>>>>>>        Move Particle.Partl_Recr                to sRecr1
52907>>>>>>>        Move Pmoves.Recnum                      to iCurrentPmoves
52908>>>>>>>        Move PmsSxet.Recnum                     to iCurrentPmsSxet
52909>>>>>>>        Move PmsSxet.Arx_Partl_Recr             to sRecr2
52910>>>>>>>        Move PmsSxet.Posothta                   to nQty
52911>>>>>>>        Move Particle.Recnum                    to iCurrentPartl
52912>>>>>>>
52912>>>>>>>
52912>>>>>>>        If (piFromCreate(Self)<>1) Begin
52914>>>>>>>            Add nQty to Pmoves.Pms_Qty
52915>>>>>>>            Saverecord Pmoves
52916>>>>>>>
52916>>>>>>>            Set pnQty               Of bpEnYpol to nQty
52917>>>>>>>            Set psRecr              Of bpEnYpol to PmsSxet.Sxetiko_Recr
52918>>>>>>>            Set piFromAkyrosh       Of bpEnYpol to (iAkyro=1)
52919>>>>>>>            Set piCurrentPartl      Of bpEnYpol to iCurrentPartl
52920>>>>>>>            Set piCurrentPmoves     Of bpEnYpol to iCurrentPmoves
52921>>>>>>>            Set piCurrentPmsSxet    Of bpEnYpol to iCurrentPmsSxet
52922>>>>>>>            Send DoProcess          to bpEnYpol
52923>>>>>>>
52923>>>>>>>            Get piLathos            Of bpEnYpol to iLathos
52924>>>>>>>
52924>>>>>>>                 If (iLathos=40000) Error 8000 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
52927>>>>>>>            Else If (iLathos=40001) Error 8001 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
52931>>>>>>>            Else If (iLathos=40002) Error 8002 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
52935>>>>>>>            Else If (iLathos=40003) Error 8003 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
52939>>>>>>>            Else If (iLathos=40004) Error 8004 '’¦ §¨à«˜¨® ¡æ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
52943>>>>>>>            Else If (iLathos=40005) Error 8005 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
52947>>>>>>>            Else If (iLathos=40006) Error 8006 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
52951>>>>>>>
52951>>>>>>>        End
52951>>>>>>>>
52951>>>>>>>
52951>>>>>>>        // Epanafora posothtas giati afou trexei h backout me timh px 3 eno h update exei timh 4
52951>>>>>>>        // sthn epanatopothethsh ths bpenypol xanavriskei to current pmssxet record
52951>>>>>>>        // kai xanei thn posothta thn kainourgia opote epanerxetai me thn posothta ths
52951>>>>>>>        // backout pou einai 3.
52951>>>>>>>        Move nQty to PmsSxet.Posothta
52952>>>>>>>
52952>>>>>>>
52952>>>>>>>        Clear Psxetika
52953>>>>>>>        Move sRecr1 to Psxetika.Partl_Recr
52954>>>>>>>        Move sRecr2 to Psxetika.Psx_Partl_Recr
52955>>>>>>>        Find Eq Psxetika by index.4
52956>>>>>>>>
52956>>>>>>>        If (Found) Begin
52958>>>>>>>            Add nQty to Psxetika.Pms_Sx_Qty
52959>>>>>>>            Saverecord Psxetika
52960>>>>>>>        End
52960>>>>>>>>
52960>>>>>>>
52960>>>>>>>        Clear Psxetika
52961>>>>>>>        Move sRecr2 to Psxetika.Partl_Recr
52962>>>>>>>        Move sRecr1 to Psxetika.Psx_Partl_Recr
52963>>>>>>>        Find Eq Psxetika by index.4
52964>>>>>>>>
52964>>>>>>>        If (Found) Begin
52966>>>>>>>            Add nQty to Psxetika.Pms_Sx_Qty
52967>>>>>>>            Saverecord Psxetika
52968>>>>>>>        End
52968>>>>>>>>
52968>>>>>>>    End_Procedure
52969>>>>>>>
52969>>>>>>>    Procedure Backout
52970>>>>>>>        String  sRecr1 sRecr2 sPmsSxet
52971>>>>>>>        Number  nQty
52971>>>>>>>        Integer iLathos iCurrentPmoves iAkyro iCurrentPmsSxet iCurrentPartl
52971>>>>>>>
52971>>>>>>>        Move (Trim(Particle.Partl_LastNo)='1')  to iAkyro
52972>>>>>>>        Move Particle.Partl_Recr                to sRecr1
52973>>>>>>>        Move Pmoves.Recnum                      to iCurrentPmoves
52974>>>>>>>        Move PmsSxet.Recnum                     to iCurrentPmsSxet
52975>>>>>>>        Move PmsSxet.Arx_Partl_Recr             to sRecr2
52976>>>>>>>        Move PmsSxet.Posothta                   to nQty
52977>>>>>>>        Move Particle.Recnum                    to iCurrentPartl
52978>>>>>>>
52978>>>>>>>        Forward Send Backout
52980>>>>>>>
52980>>>>>>>        Set pnQty               Of bpEnYpol to (nQty*(-1))
52981>>>>>>>        Set psRecr              Of bpEnYpol to PmsSxet.Sxetiko_Recr
52982>>>>>>>        Set piFromAkyrosh       Of bpEnYpol to (iAkyro=1)
52983>>>>>>>        Set piCurrentPartl      Of bpEnYpol to iCurrentPartl
52984>>>>>>>        Set piCurrentPmoves     Of bpEnYpol to iCurrentPmoves
52985>>>>>>>        Set piCurrentPmsSxet    Of bpEnYpol to iCurrentPmsSxet
52986>>>>>>>        Send DoProcess          to bpEnYpol
52987>>>>>>>
52987>>>>>>>        Get piLathos            Of bpEnYpol to iLathos
52988>>>>>>>
52988>>>>>>>             If (iLathos=40000) Error 8000 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nBackout PmsSxet'
52991>>>>>>>        Else If (iLathos=40001) Error 8001 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nBackout PmsSxet'
52995>>>>>>>        Else If (iLathos=40002) Error 8002 'ƒœ¤ ™¨âŸž¡œ Particle\nBackout PmsSxet'
52999>>>>>>>        Else If (iLathos=40003) Error 8003 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nBackout PmsSxet'
53003>>>>>>>        Else If (iLathos=40004) Error 8004 '’¦ §¨à«˜¨® ¡æ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nBackout PmsSxet'
53007>>>>>>>        Else If (iLathos=40005) Error 8005 'ƒœ¤ ™¨âŸž¡œ Particle\nBackout PmsSxet'
53011>>>>>>>        Else If (iLathos=40006) Error 8006 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  > ˜¨® ¡ã §¦©æ«ž«˜.\nBackout PmsSxet'
53015>>>>>>>        Else If (iLathos=40007) Error 8007 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nBackout PmsSxet'
53019>>>>>>>
53019>>>>>>>        Clear Psxetika
53020>>>>>>>        Move sRecr1 to Psxetika.Partl_Recr
53021>>>>>>>        Move sRecr2 to Psxetika.Psx_Partl_Recr
53022>>>>>>>        Find Eq Psxetika by index.4
53023>>>>>>>>
53023>>>>>>>        If (Found) Begin
53025>>>>>>>            Sub nQty from Psxetika.Pms_Sx_Qty
53026>>>>>>>            Saverecord Psxetika
53027>>>>>>>        End
53027>>>>>>>>
53027>>>>>>>
53027>>>>>>>        Clear Psxetika
53028>>>>>>>        Move sRecr2 to Psxetika.Partl_Recr
53029>>>>>>>        Move sRecr1 to Psxetika.Psx_Partl_Recr
53030>>>>>>>        Find Eq Psxetika by index.4
53031>>>>>>>>
53031>>>>>>>        If (Found) Begin
53033>>>>>>>            Sub nQty from Psxetika.Pms_Sx_Qty
53034>>>>>>>            Saverecord Psxetika
53035>>>>>>>        End
53035>>>>>>>>
53035>>>>>>>    End_Procedure
53036>>>>>>>
53036>>>>>>>    Procedure Request_Save
53037>>>>>>>        Integer iInt iLathos iMustDelete iCurrentPmoves iAkyro iCurrentPmsSxet iCurrentPartl
53038>>>>>>>        String  sParticleRecr sPmsSxetRecr sPmovesRecr sArxPartlRecr sRecr1 sRecr2 sPmsSxet
53038>>>>>>>        Number  nQty
53038>>>>>>>
53038>>>>>>>        Set piFromCreate to 0
53039>>>>>>>
53039>>>>>>>        Forward Send Request_Save
53041>>>>>>>
53041>>>>>>>        If (piFromCreate(Self)=1) Begin
53043>>>>>>>            Set piFromCreate                                                to 0
53044>>>>>>>
53044>>>>>>>            Get File_Field_Current_Value File_Field Particle.Recnum         to iCurrentPartl
53045>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_Recr     to sParticleRecr
53046>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Pms_Recr         to sPmovesRecr
53047>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Recnum           to iCurrentPmoves
53048>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Recnum          to iCurrentPmsSxet
53049>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Sxetiko_Recr    to sPmsSxetRecr
53050>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Arx_Partl_Recr  to sArxPartlRecr
53051>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Posothta        to nQty
53052>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_LastNo   to iAkyro
53053>>>>>>>            Move (iAkyro=1)                                                 to iAkyro
53054>>>>>>>
53054>>>>>>>            Set pnQty               Of bpEnYpol to nQty
53055>>>>>>>            Set psRecr              Of bpEnYpol to sPmsSxetRecr
53056>>>>>>>            Set piFromAkyrosh       Of bpEnYpol to (iAkyro=1)
53057>>>>>>>            Set piCurrentPartl      Of bpEnYpol to iCurrentPartl
53058>>>>>>>            Set piCurrentPmoves     Of bpEnYpol to iCurrentPmoves
53059>>>>>>>            Set piCurrentPmsSxet    Of bpEnYpol to iCurrentPmsSxet
53060>>>>>>>            Send DoProcess          to bpEnYpol
53061>>>>>>>            Get piLathos            Of bpEnYpol to iLathos
53062>>>>>>>
53062>>>>>>>                 If (iLathos=40000) Error 8000 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
53065>>>>>>>            Else If (iLathos=40001) Error 8001 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
53069>>>>>>>            Else If (iLathos=40002) Error 8002 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
53073>>>>>>>            Else If (iLathos=40003) Error 8003 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
53077>>>>>>>            Else If (iLathos=40004) Error 8004 '’¦ §¨à«˜¨® ¡æ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
53081>>>>>>>            Else If (iLathos=40005) Error 8005 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
53085>>>>>>>            Else If (iLathos=40006) Error 8006 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  > ˜¨® ¡ã §¦©æ«ž«˜.\nUpdate PmsSxet'
53089>>>>>>>            Else If (iLathos=40007) Error 8007 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
53093>>>>>>>
53093>>>>>>>            Set psParticleRecr0     Of Psx_Array to sParticleRecr
53094>>>>>>>            Set psPsxetikaRecr0     Of Psx_Array to sArxPartlRecr
53095>>>>>>>            Set pnPosothta          Of Psx_Array to nQty
53096>>>>>>>            Send Make_The_Record    Of Psx_Array
53097>>>>>>>
53097>>>>>>>            // Xana vres tis eggrafes
53097>>>>>>>            Clear Particle
53098>>>>>>>            Move sParticleRecr  to Particle.Partl_Recr
53099>>>>>>>            Find Eq Particle by index.2
53100>>>>>>>>
53100>>>>>>>
53100>>>>>>>            Clear Pmoves
53101>>>>>>>            Move sPmovesRecr    to Pmoves.Pms_Recr
53102>>>>>>>            Find Eq Pmoves by index.2
53103>>>>>>>>
53103>>>>>>>
53103>>>>>>>            Clear PmsSxet
53104>>>>>>>            Move sPmovesRecr    to PmsSxet.Pms_Recr
53105>>>>>>>            Move sPmsSxetRecr   to PmsSxet.Sxetiko_Recr
53106>>>>>>>            Find Eq PmsSxet by Index.1
53107>>>>>>>>
53107>>>>>>>
53107>>>>>>>        End
53107>>>>>>>>
53107>>>>>>>    End_Procedure
53108>>>>>>>
53108>>>>>>>
53108>>>>>>>    Procedure Define_Fields
53109>>>>>>>        Forward Send Define_Fields
53111>>>>>>>        //DDB-Generated-Code-Location
53111>>>>>>>        //DDB-DefineFieldStart
53111>>>>>>>
53111>>>>>>>        Set Main_File            To Pmssxet.File_Number
53112>>>>>>>
53112>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
53113>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
53114>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
53115>>>>>>>
53115>>>>>>>
53115>>>>>>>        // Field-based properties.......................
53115>>>>>>>
53115>>>>>>>        // Pmssxet.Pms_Recr
53115>>>>>>>
53115>>>>>>>        // Pmssxet.Sxetiko_Recr
53115>>>>>>>
53115>>>>>>>        // Pmssxet.Posothta
53115>>>>>>>
53115>>>>>>>        // Pmssxet.Arx_Partl_Recr
53115>>>>>>>
53115>>>>>>>        // Pmssxet.Sx_Parast
53115>>>>>>>
53115>>>>>>>        // Pmssxet.Sx_Hmnia
53115>>>>>>>
53115>>>>>>>        // Pmssxet.Sx_Foreas
53115>>>>>>>
53115>>>>>>>        // Pmssxet.Sx_Arithmos
53115>>>>>>>
53115>>>>>>>        // Pmssxet.Sx_Seira
53115>>>>>>>
53115>>>>>>>        // Pmssxet.Sx_Posothta
53115>>>>>>>
53115>>>>>>>        //DDB-DefineFieldEnd
53115>>>>>>>    End_Procedure    // Define_Fields
53116>>>>>>>
53116>>>>>>>    Procedure Field_Defaults
53117>>>>>>>        Forward Send Field_Defaults
53119>>>>>>>        //DDB-Generated-Code-Location
53119>>>>>>>        //DDB-FieldDefaultStart
53119>>>>>>>        //DDB-FieldDefaultEnd
53119>>>>>>>    End_Procedure    // Field_Defaults
53120>>>>>>>
53120>>>>>>>End_Class    // Pmssxet_DataDictionary
53121>>>>>>>//DDB-FileEnd
53121>>>>>    Use SALESMEN.DD
53121>>>>>    Use CONSTRCT.DD
53121>>>>>    Use CN.DD
53121>>>>>    Use PSXETIKA.DD
53121>>>>>    Use TPARTICL.DD
INCLUDING FILE: TPARTICL.DD
53121>>>>>>>//DDB-FileStart
53121>>>>>>>//DDB-HeaderStart
53121>>>>>>>
53121>>>>>>>// File Name : TPARTICL.DD
53121>>>>>>>// Class Name: Tparticl_DataDictionary
53121>>>>>>>// Revision  : 28
53121>>>>>>>// Version   : 2
53121>>>>>>>
53121>>>>>>>Use  Windows           // Basic Definitions
53121>>>>>>>Use  DataDict          // DataDictionary Class Definition
53121>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
53121>>>>>>>
53121>>>>>>>Open Tparticl
53123>>>>>>>Open Particle
53125>>>>>>>Open Baxiokat
53127>>>>>>>Open Sysrecc
53129>>>>>>>
53129>>>>>>>//DDB-HeaderEnd
53129>>>>>>>//DDB-ValidationStart
53129>>>>>>>
53129>>>>>>>Register_Object Mera_Tou_Mhna_VT
53129>>>>>>>
53129>>>>>>>Object Mera_Tou_Mhna_VT  is a CodeValidationTable
53131>>>>>>>    Set Type_Value        To "HMERES"
53132>>>>>>>    Set Allow_Blank_State To TRUE
53133>>>>>>>    //DDB-ValidationCustomStart
53133>>>>>>>    //DDB-ValidationCustomEnd
53133>>>>>>>End_Object   // Mera_Tou_Mhna_VT
53134>>>>>>>//DDB-ValidationEnd
53134>>>>>>>
53134>>>>>>>Class Tparticl_DataDictionary  is a DataDictionary_Sec
53135>>>>>>>
53135>>>>>>>    Procedure Construct_Object
53136>>>>>>>        Forward Send Construct_Object
53138>>>>>>>        Property Integer piParticleID Public 0
53139>>>>>>>        Property Integer piBaxiokatID Public 0
53140>>>>>>>    End_Procedure
53141>>>>>>>
53141>>>>>>>    Procedure End_Construct_Object
53142>>>>>>>        Integer iID
53143>>>>>>>        Forward Send End_Construct_Object
53145>>>>>>>        Move (Find_Server_DDO(Self,Particle.File_Number )) to iID
53146>>>>>>>        Set piParticleID to iID
53147>>>>>>>        Move (Find_Server_DDO(Self,Baxiokat.File_Number )) to iID
53148>>>>>>>        Set piBaxiokatID to iID
53149>>>>>>>    End_Procedure
53150>>>>>>>
53150>>>>>>>    Procedure Calc_All_The_Fields
53151>>>>>>>        Number  nSynolo nPoso nPososto naxia
53152>>>>>>>        Date    dHmniaPlhromhs dHmniaParalabhs dHmniaTimologiou
53152>>>>>>>        Date    dProkeiptei dProsDate dAddDate dStartDate dEndDate
53152>>>>>>>        Integer iMeresXaritos iMeratouMhna iMeresParalabhs iID iInt iAdd
53152>>>>>>>        Integer iMeresPlhroteo iCode iXhmero iMhnasTimologiou  iMet
53152>>>>>>>
53152>>>>>>>        Get piBaxiokatID                                                to iID
53153>>>>>>>        Get Field_Current_Value Of iID Field Baxiokat.Baxiokat_Code     to iCode
53154>>>>>>>
53154>>>>>>>
53154>>>>>>>        Get piParticleID                                                to iID
53155>>>>>>>        Get Field_Current_Value Of iID Field Particle.Partl_Payam       to nSynolo
53156>>>>>>>        Get Field_Current_Value Of iID Field Particle.Partl_Hmnia       to dHmniaTimologiou
53157>>>>>>>        Get Field_Current_Value        Field TParticl.Pct_Epi_Synolou   to nPososto
53158>>>>>>>        Get Field_Current_Value        Field TParticl.Paralabh_Meres    to iMeresParalabhs
53159>>>>>>>        Get Field_Current_Value        Field TParticl.Xarhtos_Meres     to iMeresXaritos
53160>>>>>>>        Get Field_Current_Value        Field TParticl.Plhroteo_Meres    to iMeresPlhroteo
53161>>>>>>>
53161>>>>>>>        //////////////////////////////////////////////////////////////////////////
53161>>>>>>>        /////        10 (x)     -      10 (y)         /          30 (z)      /////
53161>>>>>>>        /////  iMeresParalabhs    iMeresXaritos              iMeresPlhroteo  /////
53161>>>>>>>        //////////////////////////////////////////////////////////////////////////
53161>>>>>>>
53161>>>>>>>        //  1. Kathorise thn 1h tou mhna, hmeromhniaka
53161>>>>>>>        Move ('01'+'/'+(String(TheMonthSegment(dHmniaTimologiou)))+'/'+;                       (String(TheYearSegment(dHmniaTimologiou)))) to dStartDate
53162>>>>>>>
53162>>>>>>>//        //  2. Vres thn Hmeromhnia paralabhs (Teleytaia hmera tou epomenou y hmerou
53162>>>>>>>//        //     sthn opoia meta tha prosthesoume tis hmeres paralabhs (x) )
53162>>>>>>>//        Move dStartDate to dHmniaParalabhs
53162>>>>>>>//        While (dHmniaParalabhs<(dHmniaTimologiou+iMeresXaritos))
53162>>>>>>>//            Add iMeresXaritos to dHmniaParalabhs
53162>>>>>>>//        Loop
53162>>>>>>>//        Add iMeresParalabhs to dHmniaParalabhs
53162>>>>>>>
53162>>>>>>>//        //  3. Vres thn Hmeromhnia Lhxhs ths epitaghs  (Teleytaia hmera tou trxontos y hmerou
53162>>>>>>>//        //     sthn opoia meta tha prosthesoume tis hmeres plhroteo (z) )
53162>>>>>>>//        Move dStartDate to dHmniaPlhromhs
53162>>>>>>>//        While (dHmniaPlhromhs<dHmniaTimologiou)
53162>>>>>>>//            Add iMeresXaritos to dHmniaPlhromhs
53162>>>>>>>//        Loop
53162>>>>>>>//        Add iMeresPlhroteo  to dHmniaPlhromhs
53162>>>>>>>
53162>>>>>>>        //  2. Vres thn Hmeromhnia  ths teleytaias hmera tou trexontos y hmerou
53162>>>>>>>        Move dStartDate to dHmniaParalabhs
53163>>>>>>>        If (iMeresXaritos<>0) Begin
53165>>>>>>>            While (dHmniaParalabhs<dHmniaTimologiou)
53169>>>>>>>                Add iMeresXaritos   to dHmniaParalabhs
53170>>>>>>>            Loop
53171>>>>>>>>
53171>>>>>>>        End
53171>>>>>>>>
53171>>>>>>>        Move dHmniaParalabhs    to dHmniaPlhromhs
53172>>>>>>>
53172>>>>>>>        Add (iMeresParalabhs-1) to dHmniaParalabhs
53173>>>>>>>        Add (iMeresPlhroteo-1)  to dHmniaPlhromhs
53174>>>>>>>
53174>>>>>>>        // Ypologise prota to poso bash posostou se sxesh me synolo parastatikou
53174>>>>>>>        Move (Round_number((nSynolo*nPososto/100),2))   to naxia
53175>>>>>>>
53175>>>>>>>        Set Field_Changed_Value Field TParticl.Poso     to naxia
53176>>>>>>>        Set Field_Changed_Value Field TParticl.Paralabh to dHmniaParalabhs
53177>>>>>>>        Set Field_Changed_Value Field TParticl.Exoflhsh to dHmniaPlhromhs
53178>>>>>>>
53178>>>>>>>    End_Procedure
53179>>>>>>>
53179>>>>>>>
53179>>>>>>>    Procedure Creating
53180>>>>>>>        Forward Send Creating
53182>>>>>>>        // Insert Code Here
53182>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Tparticl.Tparticl_Rec0))))));                                    to Tparticl.Tparticl_Recr
53183>>>>>>>    End_Procedure   // Creating
53184>>>>>>>
53184>>>>>>>
53184>>>>>>>    Procedure Save_Main_File
53185>>>>>>>        If (tparticl.isok <> '1') move ' ' to tparticl.isok
53188>>>>>>>        If (Operation_Origin<>Self) Begin
53190>>>>>>>            If tparticl.Recnum Eq 0 Procedure_Return
53193>>>>>>>        End
53193>>>>>>>>
53193>>>>>>>      Forward Send Save_Main_File
53195>>>>>>>    End_Procedure   // Save_Main_File
53196>>>>>>>
53196>>>>>>>
53196>>>>>>>    // Define_Fields:
53196>>>>>>>    // This procedure is used to set up all data-dictionary rules.
53196>>>>>>>
53196>>>>>>>    Procedure Define_Fields
53197>>>>>>>        Forward Send Define_Fields
53199>>>>>>>        //DDB-Generated-Code-Location
53199>>>>>>>        //DDB-DefineFieldStart
53199>>>>>>>
53199>>>>>>>        Set Main_File            To Tparticl.File_Number
53200>>>>>>>        Set Cascade_Delete_State To FALSE
53201>>>>>>>
53201>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
53202>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
53203>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
53204>>>>>>>
53204>>>>>>>        // Parent (Server) file structure...............
53204>>>>>>>        Send Add_Server_File  Particle.File_Number
53205>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
53206>>>>>>>
53206>>>>>>>        // External (System) file structure.............
53206>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
53207>>>>>>>
53207>>>>>>>        Define_Auto_Increment  Sysrecc.Tparticl_Rec0  To Tparticl.Tparticl_Rec0
53210>>>>>>>
53210>>>>>>>        // Field-based properties.......................
53210>>>>>>>
53210>>>>>>>        // Tparticl.Partl_Recr
53210>>>>>>>
53210>>>>>>>        // Tparticl.Baxiokat_Code
53210>>>>>>>        Set Field_Exit_msg         Field Tparticl.Baxiokat_Code To Calc_All_The_Fields
53211>>>>>>>
53211>>>>>>>        // Tparticl.Pct_Epi_Synolou
53211>>>>>>>        Set Field_Exit_msg         Field Tparticl.Pct_Epi_Synolou To Calc_All_The_Fields
53212>>>>>>>
53212>>>>>>>        // Tparticl.Paralabh_Meres
53212>>>>>>>        Set Field_Exit_msg         Field Tparticl.Paralabh_Meres To Calc_All_The_Fields
53213>>>>>>>
53213>>>>>>>        // Tparticl.Xarhtos_Meres
53213>>>>>>>        Set Field_Exit_msg         Field Tparticl.Xarhtos_Meres To Calc_All_The_Fields
53214>>>>>>>
53214>>>>>>>        // Tparticl.Plhroteo_Meres
53214>>>>>>>        Set Field_Exit_msg         Field Tparticl.Plhroteo_Meres To Calc_All_The_Fields
53215>>>>>>>
53215>>>>>>>        // Tparticl.Tparticl_Rec0
53215>>>>>>>
53215>>>>>>>        // Tparticl.Tparticl_Recr
53215>>>>>>>
53215>>>>>>>        // Tparticl.Mera_Tou_Mhna
53215>>>>>>>        Set Field_Exit_msg         Field Tparticl.Mera_Tou_Mhna To Calc_All_The_Fields
53216>>>>>>>        Set Field_Value_Table      Field Tparticl.Mera_Tou_Mhna To (Mera_Tou_Mhna_VT(Self))
53217>>>>>>>
53217>>>>>>>        // Tparticl.Poso
53217>>>>>>>
53217>>>>>>>        // Tparticl.Paralabh
53217>>>>>>>
53217>>>>>>>        // Tparticl.Exoflhsh
53217>>>>>>>
53217>>>>>>>        // Tparticl.Isok
53217>>>>>>>
53217>>>>>>>        //DDB-DefineFieldEnd
53217>>>>>>>    End_Procedure    // Define_Fields
53218>>>>>>>
53218>>>>>>>    // Field_Defaults:
53218>>>>>>>    // This procedure is used to establish default field values.
53218>>>>>>>
53218>>>>>>>    Procedure Field_Defaults
53219>>>>>>>        Forward Send Field_Defaults
53221>>>>>>>        //DDB-Generated-Code-Location
53221>>>>>>>        //DDB-FieldDefaultStart
53221>>>>>>>        //DDB-FieldDefaultEnd
53221>>>>>>>    End_Procedure    // Field_Defaults
53222>>>>>>>
53222>>>>>>>End_Class    // Tparticl_DataDictionary
53223>>>>>>>//DDB-FileEnd
53223>>>>>    Use PARTLFPA.DD
INCLUDING FILE: PARTLFPA.DD
53223>>>>>>>//DDB-FileStart
53223>>>>>>>//DDB-HeaderStart
53223>>>>>>>
53223>>>>>>>// File Name : PARTLFPA.DD
53223>>>>>>>// Class Name: Partlfpa_DataDictionary
53223>>>>>>>// Revision  : 7
53223>>>>>>>// Version   : 2
53223>>>>>>>
53223>>>>>>>Use  Windows           // Basic Definitions
53223>>>>>>>Use  DataDict          // DataDictionary Class Definition
53223>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
53223>>>>>>>
53223>>>>>>>Open Partlfpa
53225>>>>>>>Open Particle
53227>>>>>>>Open Fpa
53229>>>>>>>
53229>>>>>>>//DDB-HeaderEnd
53229>>>>>>> 
53229>>>>>>>Class Partlfpa_DataDictionary  is a DataDictionary_Sec
53230>>>>>>>
53230>>>>>>>
53230>>>>>>>    // Define_Fields:
53230>>>>>>>    // This procedure is used to set up all data-dictionary rules.
53230>>>>>>>
53230>>>>>>>    Procedure Define_Fields
53231>>>>>>>        Forward Send Define_Fields
53233>>>>>>>        //DDB-Generated-Code-Location
53233>>>>>>>        //DDB-DefineFieldStart
53233>>>>>>>
53233>>>>>>>        Set Main_File            To Partlfpa.File_Number
53234>>>>>>>
53234>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
53235>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
53236>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
53237>>>>>>>
53237>>>>>>>        // Parent (Server) file structure...............
53237>>>>>>>        Send Add_Server_File  Particle.File_Number
53238>>>>>>>        Send Add_Server_File  Fpa.File_Number
53239>>>>>>>
53239>>>>>>>        // Field-based properties.......................
53239>>>>>>>
53239>>>>>>>        // Partlfpa.Partl_Recr
53239>>>>>>>
53239>>>>>>>        // Partlfpa.Fpa_Pososto
53239>>>>>>>
53239>>>>>>>        // Partlfpa.Partlfpa_Poso
53239>>>>>>>
53239>>>>>>>        // Partlfpa.Poso_Pro_Ekpt
53239>>>>>>>
53239>>>>>>>        // Partlfpa.Poso_Ekpt
53239>>>>>>>
53239>>>>>>>        // Partlfpa.Poso_Pro_Fpa
53239>>>>>>>
53239>>>>>>>        // Partlfpa.Poso_Fpa
53239>>>>>>>
53239>>>>>>>        // Partlfpa.Poso_Me_Fpa
53239>>>>>>>
53239>>>>>>>        //DDB-DefineFieldEnd
53239>>>>>>>    End_Procedure    // Define_Fields
53240>>>>>>>
53240>>>>>>>    // Field_Defaults:
53240>>>>>>>    // This procedure is used to establish default field values.
53240>>>>>>>
53240>>>>>>>    Procedure Field_Defaults
53241>>>>>>>        Forward Send Field_Defaults
53243>>>>>>>        //DDB-Generated-Code-Location
53243>>>>>>>        //DDB-FieldDefaultStart
53243>>>>>>>        //DDB-FieldDefaultEnd
53243>>>>>>>    End_Procedure    // Field_Defaults
53244>>>>>>>
53244>>>>>>>End_Class    // Partlfpa_DataDictionary
53245>>>>>>>//DDB-FileEnd
53245>>>>>
53245>>>>>    //AB-StoreTopEnd
53245>>>>>
53245>>>>>    //AB-IgnoreStart
53245>>>>>
53245>>>>>    Use Bproces.Sub
53245>>>>>
53245>>>>>
53245>>>>>    //AB-IgnoreEnd
53245>>>>>
53245>>>>>    Object Psx_Array is a BusinessProcessSub
53247>>>>>
53247>>>>>        //AB-StoreTopStart
53247>>>>>
53247>>>>>        Property    String  psParticleRecr0 Public ''
53249>>>>>        Property    String  psPsxetikaRecr0 Public ''
53251>>>>>        Property    String  psClient_Desc   Public ''
53253>>>>>        Property    String  psPtyppar_Desc  Public ''
53255>>>>>        Property    String  psSeira_Seira   Public ''
53257>>>>>        Property    Date    pdPartl_Hmnia   Public ''
53259>>>>>        Property    Integer piPartl_No      Public  0
53261>>>>>        Property    Number  pnPosothta      Public  0
53263>>>>>
53263>>>>>        Object Ctypkin_DD2 is a Ctypkin_DataDictionary
53265>>>>>        End_Object    // Ctypkin_DD2
53266>>>>>
53266>>>>>        Object Wtypkin_DD2 is a Wtypkin_DataDictionary
53268>>>>>        End_Object    // Wtypkin_DD2
53269>>>>>
53269>>>>>        Object Ptyppar_DD2 is a Ptyppar_DataDictionary
53271>>>>>            Set DDO_Server to (Ctypkin_DD2(self))
53272>>>>>            Set DDO_Server to (Wtypkin_DD2(self))
53273>>>>>        End_Object    // Ptyppar_DD2
53274>>>>>
53274>>>>>        Object Country_DD2 is a Country_DataDictionary
53276>>>>>        End_Object    // Country_DD2
53277>>>>>
53277>>>>>        Object Towns_DD2 is a Towns_DataDictionary
53279>>>>>            Set DDO_Server to (Country_DD2(self))
53280>>>>>        End_Object    // Towns_DD2
53281>>>>>
53281>>>>>        Object Cities_DD2 is a Cities_DataDictionary
53283>>>>>            Set DDO_Server to (Towns_DD2(self))
53284>>>>>        End_Object    // Cities_DD2
53285>>>>>
53285>>>>>        Object Areas_DD2 is a Areas_DataDictionary
53287>>>>>        End_Object    // Areas_DD2
53288>>>>>
53288>>>>>        Object Payresp_DD2 is a Payresp_DataDictionary
53290>>>>>        End_Object    // Payresp_DD2
53291>>>>>
53291>>>>>        Object Clients_DD2 is a Clients_DataDictionary
53293>>>>>            Set DDO_Server to (Cities_DD2(self))
53294>>>>>            Set DDO_Server to (Areas_DD2(self))
53295>>>>>            Set DDO_Server to (Payresp_DD2(self))
53296>>>>>        End_Object    // Clients_DD2
53297>>>>>
53297>>>>>        Object Nomisma_DD2 is a Nomisma_DataDictionary
53299>>>>>        End_Object    // Nomisma_DD2
53300>>>>>
53300>>>>>        Object Particle_DD2 is a Particle_DataDictionary
53302>>>>>            Set DDO_Server to (Clients_DD2(self))
53303>>>>>            Set DDO_Server to (Ptyppar_DD2(self))
53304>>>>>            Set DDO_Server to (Nomisma_DD2(self))
53305>>>>>        End_Object    // Particle_DD2
53306>>>>>
53306>>>>>
53306>>>>>        /////////////////////////////////////////////
53306>>>>>
53306>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
53308>>>>>        End_Object    // Ctypkin_DD
53309>>>>>
53309>>>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
53311>>>>>        End_Object    // Wtypkin_DD
53312>>>>>
53312>>>>>        Object Ptyppar_DD is a Ptyppar_DataDictionary
53314>>>>>            Set DDO_Server to (Ctypkin_DD(self))
53315>>>>>            Set DDO_Server to (Wtypkin_DD(self))
53316>>>>>        End_Object    // Ptyppar_DD
53317>>>>>
53317>>>>>        Object Country_DD is a Country_DataDictionary
53319>>>>>        End_Object    // Country_DD
53320>>>>>
53320>>>>>        Object Towns_DD is a Towns_DataDictionary
53322>>>>>            Set DDO_Server to (Country_DD(self))
53323>>>>>        End_Object    // Towns_DD
53324>>>>>
53324>>>>>        Object Cities_DD is a Cities_DataDictionary
53326>>>>>            Set DDO_Server to (Towns_DD(self))
53327>>>>>        End_Object    // Cities_DD
53328>>>>>
53328>>>>>        Object Areas_DD is a Areas_DataDictionary
53330>>>>>        End_Object    // Areas_DD
53331>>>>>
53331>>>>>        Object Payresp_DD is a Payresp_DataDictionary
53333>>>>>        End_Object    // Payresp_DD
53334>>>>>
53334>>>>>        Object Clients_DD is a Clients_DataDictionary
53336>>>>>            Set DDO_Server to (Cities_DD(self))
53337>>>>>            Set DDO_Server to (Areas_DD(self))
53338>>>>>            Set DDO_Server to (Payresp_DD(self))
53339>>>>>        End_Object    // Clients_DD
53340>>>>>
53340>>>>>        Object Nomisma_DD is a Nomisma_DataDictionary
53342>>>>>        End_Object    // Nomisma_DD
53343>>>>>
53343>>>>>        Object Particle_DD is a Particle_DataDictionary
53345>>>>>            Set DDO_Server to (Clients_DD(self))
53346>>>>>            Set DDO_Server to (Ptyppar_DD(self))
53347>>>>>            Set DDO_Server to (Nomisma_DD(self))
53348>>>>>        End_Object    // Particle_DD
53349>>>>>
53349>>>>>        Object Psxetika_DD is a Psxetika_DataDictionary
53351>>>>>            Set DDO_Server      to (Particle_DD(self))
53352>>>>>            Set Constrain_File  to Particle.File_Number
53353>>>>>        End_Object
53354>>>>>
53354>>>>>
53354>>>>>        //AB-StoreTopEnd
53354>>>>>
53354>>>>>        Set Size to 60 100
53355>>>>>
53355>>>>>        //AB-DDOStart
53355>>>>>
53355>>>>>
53355>>>>>        //AB-DDOEnd
53355>>>>>
53355>>>>>
53355>>>>>        //AB-StoreStart
53355>>>>>
53355>>>>>        Procedure Find_Sxetika_Data String asParentRecr
53357>>>>>            String  sClient_Desc sPtyppar_Desc sPseira_Seira
53358>>>>>            Date    dPartl_Hmnia
53358>>>>>            Integer iPartl_No
53358>>>>>
53358>>>>>            Send Clear          to Particle_DD2
53359>>>>>            Move asParentRecr   to Particle.Partl_Recr
53360>>>>>            Send Find           to Particle_DD2 Eq 2
53361>>>>>
53361>>>>>            Get Field_Current_Value Of Clients_DD2  Field Clients.Client_Name   to sClient_Desc
53362>>>>>            Get Field_Current_Value Of Ptyppar_DD2  Field Ptyppar.Ptyppar_Descr to sPtyppar_Desc
53363>>>>>            Get Field_Current_Value Of Particle_DD2 Field Particle.Pseira_Seira to sPseira_Seira
53364>>>>>            Get Field_Current_Value Of Particle_DD2 Field Particle.Partl_Hmnia  to dPartl_Hmnia
53365>>>>>            Get Field_Current_Value Of Particle_DD2 Field Particle.Partl_No     to iPartl_No
53366>>>>>
53366>>>>>            Set psPtyppar_Desc      to sPtyppar_Desc
53367>>>>>            Set psClient_Desc       to sClient_Desc
53368>>>>>            Set psSeira_Seira       to sPseira_Seira
53369>>>>>            Set pdPartl_Hmnia       to dPartl_Hmnia
53370>>>>>            Set piPartl_No          to iPartl_No
53371>>>>>        End_Procedure
53372>>>>>
53372>>>>>
53372>>>>>        Procedure Make_The_Record
53374>>>>>
53374>>>>>            Set psPtyppar_Desc      to ''
53375>>>>>            Set psClient_Desc       to ''
53376>>>>>            Set psSeira_Seira       to ''
53377>>>>>            Set pdPartl_Hmnia       to ''
53378>>>>>            Set piPartl_No          to 0
53379>>>>>
53379>>>>>            Clear Psxetika
53380>>>>>            Move (psParticleRecr0(Self)) to Psxetika.Partl_Recr
53381>>>>>            Move (psPsxetikaRecr0(Self)) to Psxetika.Psx_Partl_Recr
53382>>>>>            Find Eq Psxetika by index.4
53383>>>>>>
53383>>>>>
53383>>>>>            If (Not(Found)) Begin
53385>>>>>
53385>>>>>                Send Find_Sxetika_Data (psPsxetikaRecr0(Self))
53386>>>>>
53386>>>>>                Send Clear to Particle_DD
53387>>>>>                Send Clear to Psxetika_DD
53388>>>>>
53388>>>>>                // Vres ton mpampa
53388>>>>>                Move (psParticleRecr0(Self)) to Particle.Partl_Recr
53389>>>>>                Send Find to Particle_DD Eq 2
53390>>>>>
53390>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Psx_Partl_Recr    ;                                                to (psPsxetikaRecr0(Self))
53391>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Client_Desc    ;                                                to (psClient_Desc(Self))
53392>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Ptyppar_Desc   ;                                                to (psPtyppar_Desc(Self))
53393>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_Hmnia    ;                                                to (pdPartl_Hmnia(Self))
53394>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_No       ;                                                to (piPartl_No(Self))
53395>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.SX_Pseira_Seira   ;                                                to (psSeira_Seira(Self))
53396>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Pms_Sx_Qty        ;                                                to (pnPosothta(Self))
53397>>>>>
53397>>>>>                Send Request_Save               to Psxetika_DD
53398>>>>>
53398>>>>>
53398>>>>>                // Make also 2nd Record
53398>>>>>                Clear Psxetika
53399>>>>>                Move (psPsxetikaRecr0(Self)) to Psxetika.Partl_Recr
53400>>>>>                Move (psParticleRecr0(Self)) to Psxetika.Psx_Partl_Recr
53401>>>>>                Find Eq Psxetika by index.4
53402>>>>>>
53402>>>>>
53402>>>>>                If (Not(Found)) Begin
53404>>>>>
53404>>>>>                    Send Find_Sxetika_Data (psParticleRecr0(Self))
53405>>>>>
53405>>>>>                    Send Clear to Particle_DD
53406>>>>>                    Send Clear to Psxetika_DD
53407>>>>>
53407>>>>>                    Move (psPsxetikaRecr0(Self)) to Particle.Partl_Recr
53408>>>>>                    Send Find to Particle_DD Eq 2
53409>>>>>
53409>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Psx_Partl_Recr    ;                                                    to (psParticleRecr0(Self))
53410>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Client_Desc    ;                                                    to (psClient_Desc(Self))
53411>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Ptyppar_Desc   ;                                                    to (psPtyppar_Desc(Self))
53412>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_Hmnia    ;                                                    to (pdPartl_Hmnia(Self))
53413>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_No       ;                                                    to (piPartl_No(Self))
53414>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.SX_Pseira_Seira   ;                                                    to (psSeira_Seira(Self))
53415>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Pms_Sx_Qty        ;                                                    to (pnPosothta(Self))
53416>>>>>                    Send Request_Save               to Psxetika_DD
53417>>>>>                End
53417>>>>>>
53417>>>>>            End
53417>>>>>>
53417>>>>>        End_Procedure
53418>>>>>
53418>>>>>        //AB-StoreEnd
53418>>>>>
53418>>>>>    End_Object    // Psx_Array
53419>>>>>
53419>>>>>
53419>>>>>    //AB-StoreStart
53419>>>>>
53419>>>>>    //AB-StoreEnd
53419>>>>>
53419>>>>>//AB/     End_Object    // prj
53419>>>
53419>>>        //AB-StoreTopEnd
53419>>>
53419>>>        Set Size to 60 100
53420>>>        Set Location to 18 17
53421>>>
53421>>>        //AB-DDOStart
53421>>>
53421>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
53423>>>        End_Object    // Ctypkin_DD
53424>>>
53424>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
53426>>>        End_Object    // Wtypkin_DD
53427>>>
53427>>>        Object Ptyppar_DD is a Ptyppar_DataDictionary
53429>>>            Set DDO_Server to (Ctypkin_DD(self))
53430>>>            Set DDO_Server to (Wtypkin_DD(self))
53431>>>        End_Object    // Ptyppar_DD
53432>>>
53432>>>        Object Country_DD is a Country_DataDictionary
53434>>>        End_Object    // Country_DD
53435>>>
53435>>>        Object Towns_DD is a Towns_DataDictionary
53437>>>            Set DDO_Server to (Country_DD(self))
53438>>>        End_Object    // Towns_DD
53439>>>
53439>>>        Object Cities_DD is a Cities_DataDictionary
53441>>>            Set DDO_Server to (Towns_DD(self))
53442>>>        End_Object    // Cities_DD
53443>>>
53443>>>        Object Areas_DD is a Areas_DataDictionary
53445>>>        End_Object    // Areas_DD
53446>>>
53446>>>        Object Payresp_DD is a Payresp_DataDictionary
53448>>>        End_Object    // Payresp_DD
53449>>>
53449>>>        Object Clients_DD is a Clients_DataDictionary
53451>>>            Set DDO_Server to (Cities_DD(self))
53452>>>            Set DDO_Server to (Areas_DD(self))
53453>>>            Set DDO_Server to (Payresp_DD(self))
53454>>>        End_Object    // Clients_DD
53455>>>
53455>>>        Object Nomisma_DD is a Nomisma_DataDictionary
53457>>>        End_Object    // Nomisma_DD
53458>>>
53458>>>        Object Particle_DD is a Particle_DataDictionary
53460>>>            Set DDO_Server to (Clients_DD(self))
53461>>>            Set DDO_Server to (Ptyppar_DD(self))
53462>>>            Set DDO_Server to (Nomisma_DD(self))
53463>>>        End_Object    // Particle_DD
53464>>>
53464>>>        Object Psxetika_DD is a Psxetika_DataDictionary
53466>>>            Set DDO_Server to (Particle_DD(self))
53467>>>        End_Object    // Psxetika_DD
53468>>>
53468>>>
53468>>>        //AB-DDOEnd
53468>>>
53468>>>
53468>>>        //AB-StoreStart
53468>>>
53468>>>        Procedure OnProcess
53470>>>            String  sParticleRecr sSxPartlRecr
53471>>>            Number  nQty nQty1
53471>>>            Get psParticleRecr  to sParticleRecr
53472>>>            Get psSxPartlRecr   to sSxPartlRecr
53473>>>            Get pnQty           to nQty
53474>>>
53474>>>            If ((sParticleRecr<>'') And (sSxPartlRecr<>'') And (nQty<>0)) Begin
53476>>>                Send Clear          to Psxetika_DD
53477>>>                Move sParticleRecr  to Psxetika.Partl_Recr
53478>>>                Move sSxPartlRecr   to Psxetika.Psx_Partl_Recr
53479>>>                Send Request_Find   to Psxetika_DD Eq Psxetika.File_Number 4
53480>>>                If (Found) Begin
53482>>>                    Get Field_Current_Value Of Psxetika_DD Field Psxetika.Pms_Sx_Qty to nQty1
53483>>>                    Add nQty to nQty1
53484>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Pms_Sx_Qty to nQty1
53485>>>                    Send Request_Save to Psxetika_DD
53486>>>                End
53486>>>>
53486>>>            End
53486>>>>
53486>>>
53486>>>        End_Procedure
53487>>>
53487>>>        Procedure OnError integer error_info string errMsg
53489>>>        End_Procedure
53490>>>
53490>>>        Procedure Start_Process
53492>>>            Forward Send Start_Process
53494>>>        End_Procedure
53495>>>
53495>>>        Procedure End_Process
53497>>>            Forward Send End_Process
53499>>>
53499>>>        End_Procedure
53500>>>
53500>>>        //AB-StoreEnd
53500>>>
53500>>>    End_Object    // bpMakeSx
53501>>>
53501>>>
53501>>>    //AB-StoreStart
53501>>>
53501>>>
53501>>>
53501>>>
53501>>>
53501>>>
53501>>>    //AB-StoreEnd
53501>>>
53501>>>//AB/     End_Object    // prj
53501>        
53501>        Open Nomisma
53503>        Open Isotimia
53505>        
53505>        
53505>        
53505>        Function fngConvertPoso Global String asNomismaCodeApo Number anPoso ;                                       String asNomismaCodeSe  Date   adHmnia;                                       Number nIsotimia  Returns Number
53506>        
53506>            Number rVal nApo_Euro_Isot nSe_Euro_Isot
53507>            Integer iApo_Einai_Euro_Zone iApo_Einai_DRX iApo_Einai_Euro iDekadika_Apo
53507>            Integer iSe_Einai_Euro_Zone  iSe_Einai_DRX  iSe_Einai_Euro  iDekadika_Se
53507>            String  sCode
53507>        
53507>            If (asNomismaCodeApo=asNomismaCodeSe) Function_Return anPoso
53510>        
53510>            Clear Nomisma
53511>            Move (Trim(asNomismaCodeApo)) to Nomisma.Nomisma_Code
53512>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
53513>            Move Nomisma.Euro_Zone      to iApo_Einai_Euro_Zone
53514>            Move Nomisma.Einai_DRX      to iApo_Einai_DRX
53515>            Move Nomisma.Einai_EURO     to iApo_Einai_Euro
53516>            Move Nomisma.KL_ISOT_EURO   to nApo_Euro_Isot
53517>            Move Nomisma.Dekadika       to iDekadika_Apo
53518>            // 1. An to nomisma APO den einai ths zonhs euro prepei na vrethei h isotimia tou
53518>            If ((NOT(iApo_Einai_Euro_Zone)) And (nApo_Euro_Isot=0))  Begin
53520>                If (adHmnia='') Sysdate            adHmnia
53523>                Move (Trim(asNomismaCodeApo))   to sCode
53524>                Clear Isotimia
53525>                Move sCode                      to Isotimia.Nomisma_Code
53526>                Move (adHmnia+1)                to Isotimia.Isotimia_Hmnia
53527>                Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
53528>                Move Isotimia.Isotimia_Euro     to nApo_Euro_Isot
53529>            End
53529>        
53529>            Clear Nomisma
53530>            Move (Trim(asNomismaCodeSe)) to Nomisma.Nomisma_Code
53531>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
53532>            Move Nomisma.Euro_Zone      to iSe_Einai_Euro_Zone
53533>            Move Nomisma.Einai_DRX      to iSe_Einai_DRX
53534>            Move Nomisma.Einai_EURO     to iSe_Einai_Euro
53535>            Move Nomisma.KL_ISOT_EURO   to nSe_Euro_Isot
53536>            Move Nomisma.Dekadika       to iDekadika_Se
53537>            // 2. An to nomisma SE den einai ths zonhs euro prepei na vrethei h isotimia tou
53537>            If ((NOT(iSe_Einai_Euro_Zone)) And (nSe_Euro_Isot=0)) Begin
53539>                If (adHmnia='') Sysdate            adHmnia
53542>                Move (Trim(asNomismaCodeSe))    to sCode
53543>                Clear Isotimia
53544>                Move sCode                      to Isotimia.Nomisma_Code
53545>                Move (adHmnia+1)                to Isotimia.Isotimia_Hmnia
53546>                Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
53547>                Move Isotimia.Isotimia_Euro     to nSe_Euro_Isot
53548>            End
53548>        
53548>            Calc (anPoso/nApo_Euro_Isot) to rVal
53549>            Move (Round_Number(rVal,6)) to rVal
53550>            Calc (rVal*nSe_Euro_Isot) to rVal
53551>            Move (Round_Number(rVal,iDekadika_Se)) to rVal
53552>        
53552>            Function_Return rVal
53553>        End_Function
53554>        
53554>        
53554>        //AB-ClientStoreTopEnd
53554>
53554>        //  Include all views
53554>        Use FtpView.VW                                                                      
INCLUDING FILE: FTPVIEW.VW
53554>>>//AB/ Project FtpView
53554>>>//AB/ Object prj is a View_Project
53554>>>//AB/     Set ProjectName to "FtpView"
53554>>>//AB/     Set ProjectFileName to "FtpView.VW"
53554>>>//AB/     Set GenerateFileName to "NONAME"
53554>>>
53554>>>// Project Object Structure
53554>>>//   FtpView is a dbViewSubs
53554>>>//     Units_DD is a DataDictionary
53554>>>//     Witemkat_DD is a DataDictionary
53554>>>//     Fpa_DD is a DataDictionary
53554>>>//     Item_DD is a DataDictionary
53554>>>//     Witemx_DD is a DataDictionary
53554>>>//     Tmpsel_DD is a DataDictionary
53554>>>//     dbGrpYear is a dbGroupSub
53554>>>//       otxtCompany is a TextBoxSub
53554>>>//       cboCompany is a ComboFormSub
53554>>>//       otxtBranch is a TextBoxSub
53554>>>//       cboBranch is a ComboFormSub
53554>>>//       otxtYear is a TextBoxSub
53554>>>//       cboYear is a ComboFormSub
53554>>>//       btnChangeXr is a ButtonSub
53554>>>//     frmAddress is a FormSub
53554>>>//     frmUserName is a FormSub
53554>>>//     frmPassword is a FormSub
53554>>>//     frmDirectory is a FormSub
53554>>>//     btn_Connect is a ButtonSub
53554>>>//       TimerObj is a DFTimer
53554>>>//     oStatusForm is a EditSub
53554>>>//     btnSelectFolder is a ButtonSub
53554>>>//     FormSub1 is a FormSub
53554>>>//     BtnFillList is a ButtonSub
53554>>>//     dbGridSub1 is a dbGridSub
53554>>>//     txtSel is a TextBoxSub
53554>>>//     txtCount is a TextBoxSub
53554>>>//     btn_Select is a ButtonSub
53554>>>//     btnDel is a ButtonSub
53554>>>//     frmMessage is a FormSub
53554>>>//     HmApo is a cSyDateForm
53554>>>//     HmEos is a cSyDateForm
53554>>>//     ButtonSub1 is a ButtonSub
53554>>>//       TimerObj2 is a DFTimer
53554>>>//     TextBoxSub1 is a TextBoxSub
53554>>>//     TextBoxSub2 is a TextBoxSub
53554>>>//     TextBoxSub3 is a TextBoxSub
53554>>>//     frmConn is a FormSub
53554>>>//     oDirectoryPicker is a OLEDPDlg
53554>>>//     oRecursiveFileFinder is a OLExfind
53554>>>//     Tmpsel_DD2 is a Tmpsel_DataDictionary
53554>>>//     oInternetErrorArray is a Array
53554>>>
53554>>>// Register all objects
53554>>>Register_Object BtnFillList
53554>>>Register_Object ButtonSub1
53554>>>Register_Object btn_Connect
53554>>>Register_Object btn_Select
53554>>>Register_Object btnChangeXr
53554>>>Register_Object btnDel
53554>>>Register_Object btnSelectFolder
53554>>>Register_Object cboBranch
53554>>>Register_Object cboCompany
53554>>>Register_Object cboYear
53554>>>Register_Object dbGridSub1
53554>>>Register_Object dbGrpYear
53554>>>Register_Object FormSub1
53554>>>Register_Object Fpa_DD
53554>>>Register_Object FtpView
53554>>>Register_Object frmAddress
53554>>>Register_Object frmConn
53554>>>Register_Object frmDirectory
53554>>>Register_Object frmMessage
53554>>>Register_Object frmPassword
53554>>>Register_Object frmUserName
53554>>>Register_Object HmApo
53554>>>Register_Object HmEos
53554>>>Register_Object Item_DD
53554>>>Register_Object oDirectoryPicker
53554>>>Register_Object oInternetErrorArray
53554>>>Register_Object oRecursiveFileFinder
53554>>>Register_Object oStatusForm
53554>>>Register_Object otxtBranch
53554>>>Register_Object otxtCompany
53554>>>Register_Object otxtYear
53554>>>Register_Object TextBoxSub1
53554>>>Register_Object TextBoxSub2
53554>>>Register_Object TextBoxSub3
53554>>>Register_Object TimerObj
53554>>>Register_Object TimerObj2
53554>>>Register_Object Tmpsel_DD
53554>>>Register_Object Tmpsel_DD2
53554>>>Register_Object txtCount
53554>>>Register_Object txtSel
53554>>>Register_Object Units_DD
53554>>>Register_Object Witemkat_DD
53554>>>Register_Object Witemx_DD
53554>>>
53554>>>
53554>>>//AB/ AppBuild VIEW
53554>>>
53554>>>
53554>>>//AB-StoreTopStart
53554>>>Open tmpSel
INCLUDING FILE: TMPSEL.FD
53556>>>Open HmerProg
INCLUDING FILE: HMERPROG.FD
53558>>>Open Btnemp
53560>>>Open Sysrecc
53562>>>Open Antech
INCLUDING FILE: ANTECH.FD
53564>>>Open AnProd
INCLUDING FILE: ANPROD.FD
53566>>>Open Iteml
53568>>>//AB-StoreTopEnd
53568>>>
53568>>>//AB-IgnoreStart
53568>>>
53568>>>Use dbViews.Sub
INCLUDING FILE: DBVIEWS.SUB
53568>>>>>Open Oth 
53570>>>>>Open GrpAct
INCLUDING FILE: GRPACT.FD
53572>>>>>Open GrpAct0
INCLUDING FILE: GRPACT0.FD
53574>>>>>
53574>>>>>Class DbviewSubs Is A DbviewSub
53575>>>>>
53575>>>>>    Procedure Construct_Object
53576>>>>>        Integer iPos iCount
53577>>>>>        Forward Send Construct_Object
53579>>>>>
53579>>>>>        Property String     psMyViewName        Public ''
53580>>>>>        Property Integer    piMyViewID          Public  0
53581>>>>>        Property Integer    piDoNotActivateView Public  0
53582>>>>>
53582>>>>>        Get Name            to gsViewName
53583>>>>>        Get Object_ID       to giViewID
53584>>>>>
53584>>>>>        Move 0 to iPos
53585>>>>>        For iCount From 1 to (Length(gsViewName))
53591>>>>>>
53591>>>>>            If (Mid(gsViewName,1,iCount)='.') Move iCount to iPos
53594>>>>>        Loop
53595>>>>>>
53595>>>>>        Move (Right(gsViewName,(Length(gsViewName)-iPos))) to gsViewName
53596>>>>>        Move (Trim(gsViewName)) to gsViewName
53597>>>>>
53597>>>>>        Set psMyViewName    to (Trim(gsViewName))
53598>>>>>        Set piMyViewID      to giViewID
53599>>>>>
53599>>>>>    End_Procedure
53600>>>>>
53600>>>>>    Procedure End_Construct_Object
53601>>>>>        Integer iFileNumber iFieldNumber iUser iColor iLimit iBase iCurr iCol iDeo iPos
53602>>>>>        Integer iObj iPrototype iColumn iItem iInt iFieldStatus iCurCol iCount
53602>>>>>        String  sFileName sFieldName sUser sRecr sStr sDbFormName sViewLabel sDeo svn
53602>>>>>
53602>>>>>        Forward Send End_Construct_Object
53604>>>>>
53604>>>>>        Get psMyViewName        to gsViewName
53605>>>>>        Get piMyViewID          to giViewID
53606>>>>>        Get Label Of giViewID   to sViewLabel
53607>>>>>        Move (Trim(sViewLabel)) to sViewLabel
53608>>>>>
53608>>>>>        Clear Oth
53609>>>>>        Move gsViewName to Oth.View_Name
53610>>>>>        Find eq Oth By Index.2 // Oth:Index.2:View_Name
53611>>>>>>
53611>>>>>        If (Not(Found)) Begin
53613>>>>>            Move sViewLabel to Oth.View_Label
53614>>>>>            Move giViewID   to Oth.View_ID
53615>>>>>            Saverecord Oth
53616>>>>>        End
53616>>>>>>
53616>>>>>
53616>>>>>//        Set piDoNotActivateView to 0
53616>>>>>//        Send DisableActivateView
53616>>>>>
53616>>>>>    End_Procedure //End_Construct_Object
53617>>>>>
53617>>>>>    Procedure Activate_View Returns Integer
53618>>>>>        String  lsLogin
53619>>>>>        String sLektiko
53619>>>>>        Integer liUser iGroup rVal
53619>>>>>        Set piDoNotActivateView to 0
53620>>>>>        Send DisableActivateView
53621>>>>>        If (piDoNotActivateView(Self)=0) Forward get Msg_Activate_View to rVal
53625>>>>>        Else Move -1 to rVal
53627>>>>>        Procedure_Return rVal
53628>>>>>    End_procedure
53629>>>>>
53629>>>>>
53629>>>>>    Procedure DisableActivateView
53630>>>>>        String  lsLogin
53631>>>>>        String sLektiko
53631>>>>>        Integer liUser iGroup rVal
53631>>>>>
53631>>>>>        Move (fsLoginUserID())      to lsLogin
53632>>>>>        Clear Users
53633>>>>>        Move lsLogin    to Users.Login_ID
53634>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
53635>>>>>>
53635>>>>>        If (Found=1)  Begin
53637>>>>>            Move Users.User_ID  to liUser
53638>>>>>            Move Users.Grp_ID   to iGroup
53639>>>>>        End
53639>>>>>>
53639>>>>>        
53639>>>>>        Clear GrpAct
53640>>>>>        Move liUser                 to GrpAct.User_ID
53641>>>>>        Move (psMyViewName(Self))   to GrpAct.View_Name
53642>>>>>        Find Eq GrpAct By Index.1
53643>>>>>>
53643>>>>>        If (Found) Begin
53645>>>>>            If (GrpAct.Allow=0) Begin
53647>>>>>                Set piDoNotActivateView to 1
53648>>>>>                Move "€¤œ§˜¨¡ã › ˜¡ é£˜«˜ •¨ã©«ž š ˜ œ¤œ¨š¦§¦åž©ž «¦¬ §˜¨˜Ÿç¨¦¬\n„§ ¡¦ ¤à¤ã©«œ £œ «¦¤ ƒ ˜®œ ¨ ©«ã «¦¬ ©¬©«ã£˜«¦ª" to sLektiko
53649>>>>>                Send Stop_Box sLektiko "Error 30001"
53650>>>>>                Procedure_Return -1
53651>>>>>            End
53651>>>>>>
53651>>>>>        End
53651>>>>>>
53651>>>>>
53651>>>>>        Clear GrpAct0
53652>>>>>        Move iGroup                 to GrpAct0.Group_ID
53653>>>>>        Move (psMyViewName(Self))   to GrpAct0.View_Name
53654>>>>>        Find Eq GrpAct0 By Index.1
53655>>>>>>
53655>>>>>        If ((Found) And (GrpAct0.Allow=0)) Begin
53657>>>>>            Set piDoNotActivateView to 1
53658>>>>>            Move "€¤œ§˜¨¡ã › ˜¡ é£˜«˜ Ž£á›˜ª š ˜ œ¤œ¨š¦§¦åž©ž «¦¬ §˜¨˜Ÿç¨¦¬\n„§ ¡¦ ¤à¤ã©«œ £œ «¦¤ ƒ ˜®œ ¨ ©«ã «¦¬ ©¬©«ã£˜«¦ª" to sLektiko
53659>>>>>            Send Stop_Box sLektiko "Error 30002"
53660>>>>>            Procedure_Return -1
53661>>>>>        End
53661>>>>>>
53661>>>>>    End_procedure
53662>>>>>
53662>>>>>
53662>>>>>End_Class //dbviewSubs
53663>>>>>
53663>>>>>
53663>>>Use DFAllEnt.pkg
53663>>>Use dbGroup.Sub
53663>>>Use Txtbox.Sub
53663>>>Use Cmbfrm.Sub
53663>>>Use Button.Sub
53663>>>Use Form.Sub
53663>>>Use Edit.Sub
53663>>>Use dbGrid.Sub
53663>>>Use cSyDateForm.Pkg
53663>>>
53663>>>Use UNITS.DD
53663>>>Use WITEMKAT.DD
53663>>>Use FPA.DD
53663>>>Use ITEM.DD
53663>>>Use WITEMX.DD
53663>>>Use tmpSel.DD
INCLUDING FILE: TMPSEL.DD
53663>>>>>//DDB-FileStart
53663>>>>>//DDB-HeaderStart
53663>>>>>
53663>>>>>// File Name : tmpSel.DD
53663>>>>>// Class Name: Tmpsel_DataDictionary
53663>>>>>// Revision  : 0
53663>>>>>// Version   : 2
53663>>>>>
53663>>>>>Use  Windows           // Basic Definitions
53663>>>>>Use  DataDict          // DataDictionary Class Definition
53663>>>>>Use  DDvalTbl          // Validation Table Class Definitions
53663>>>>>
53663>>>>>Open Tmpsel
53665>>>>>
53665>>>>>//DDB-HeaderEnd
53665>>>>>
53665>>>>>Class Tmpsel_DataDictionary  is a DataDictionary_Sec
53666>>>>>
53666>>>>>    // Define_Fields:
53666>>>>>    // This procedure is used to set up all data-dictionary rules.
53666>>>>>
53666>>>>>    Procedure Define_Fields
53667>>>>>        Forward Send Define_Fields
53669>>>>>        //DDB-Generated-Code-Location
53669>>>>>        //DDB-DefineFieldStart
53669>>>>>
53669>>>>>        Set Main_File            To Tmpsel.File_Number
53670>>>>>
53670>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
53671>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
53672>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
53673>>>>>
53673>>>>>        // Field-based properties.......................
53673>>>>>
53673>>>>>        // Tmpsel.Full_Path_Name
53673>>>>>
53673>>>>>        // Tmpsel.Is_Selected
53673>>>>>
53673>>>>>        // Tmpsel.Extension
53673>>>>>
53673>>>>>        // Tmpsel.Last_Init_Path
53673>>>>>
53673>>>>>        // Tmpsel.Filename
53673>>>>>
53673>>>>>        // Tmpsel.Pathname
53673>>>>>
53673>>>>>        // Tmpsel.Exist_In_Dbase
53673>>>>>
53673>>>>>        //DDB-DefineFieldEnd
53673>>>>>    End_Procedure    // Define_Fields
53674>>>>>
53674>>>>>    // Field_Defaults:
53674>>>>>    // This procedure is used to establish default field values.
53674>>>>>
53674>>>>>    Procedure Field_Defaults
53675>>>>>        Forward Send Field_Defaults
53677>>>>>        //DDB-Generated-Code-Location
53677>>>>>        //DDB-FieldDefaultStart
53677>>>>>        //DDB-FieldDefaultEnd
53677>>>>>    End_Procedure    // Field_Defaults
53678>>>>>
53678>>>>>End_Class    // Tmpsel_DataDictionary
53679>>>>>//DDB-FileEnd
53679>>>
53679>>>//AB-IgnoreEnd
53679>>>
53679>>>ACTIVATE_VIEW Activate_FtpView FOR FtpView
53683>>>
53683>>>Object FtpView is a dbViewSubs
53685>>>
53685>>>    //AB-StoreTopStart
53685>>>    Property Integer    piCount                 Public  0
53687>>>    Property String     psBranchPhone           Public ''
53689>>>    Property String     psSysfileFilesSendPath  Public ''
53691>>>    Property String     psBranchSendPathFiles   Public ''
53693>>>    Property String     psBranchSendPathConf    Public ''
53695>>>    Property Integer    piFtpSecondsRetry       Public  0
53697>>>    Property Integer    piFtpTimesExit          Public  0
53699>>>    Property Integer    piReceivedOK            Public  0
53701>>>    Property Integer    piTimesCount            Public  0
53703>>>    Property Integer    piFileRetreived         Public  0
53705>>>    Property Integer    piFromProgrammatismo    Public  0
53707>>>    Property Integer    piErrorOccured          Public  0
53709>>>    Property String     psBranchRecr            Public ''
53711>>>    property Integer    bConnectionStatus       public False
53713>>>    
53713>>>    External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;        Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
53714>>>    
53714>>>    Function Network_User_Name Returns String
53716>>>        Local String sName sLength
53717>>>        Local Pointer lpName_Addr lpLength_Addr
53717>>>        Local Integer iRetval
53717>>>        Movestr (Repeat (Character (0), 255)) To sName
53718>>>>
53718>>>        GetAddress Of sName To lpName_Addr
53719>>>        Movestr (DwordToBytes (255)) To sLength
53720>>>>
53720>>>        GetAddress Of sLength To lpLength_Addr
53721>>>        Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
53722>>>>
53722>>>        If iRetval Eq 0 Function_Return (CString (sName))
53725>>>        Else Function_Return "User Unknown"
53727>>>    End_Function // Network_User_Name
53728>>>    
53728>>>    Function fsVresEggrafh String asFileName returns Integer
53730>>>        Integer rVal
53731>>>        Move (UpperCase(asFileName)) to asFileName
53732>>>        Move (Trim(asFileName)) to asFileName
53733>>>        Function_Return rVal
53734>>>    End_Procedure
53735>>>    
53735>>>    Function fsVresExt String asFileName Returns String
53737>>>        String rVal
53738>>>        Integer iPos iLen
53738>>>        Move (UpperCase(asFileName)) to asFileName
53739>>>        Move (Trim(asFileName)) to asFileName
53740>>>        Move 0 to iPos
53741>>>        For iLen from 1 to (length(asFileName))
53747>>>>
53747>>>            If (Mid(asFileName,1,iLen)='.') Move iLen to iPos
53750>>>        Loop
53751>>>>
53751>>>        If (Not(iPos)) Function_Return ''
53754>>>        Move (Right(asFileName,(Length(asFileName)-iPos))) to rVal
53755>>>        Move (Trim(rVal)) to rVal
53756>>>        Function_Return rVal
53757>>>    End_Function
53758>>>    
53758>>>    Set Verify_Exit_Msg         to Get_No_Confirmation
53759>>>    Set Verify_Save_Msg         to Get_No_Confirmation
53760>>>    Set Verify_Data_Loss_Msg    to Get_No_Confirmation
53761>>>    
53761>>>    Register_Object     oInternetErrorArray
53761>>>    Register_Procedure  ShowInternetErrorMessage integer iInetError
53761>>>    Register_Object     oRecursiveFileFinder
53761>>>    Register_Object     oDirectoryPicker
53761>>>    Register_Object     Tmpsel_DD2
53761>>>    //Register_Object     MyRas
53761>>>    
53761>>>    Function fiCloseDialup Returns Integer
53763>>>        Integer rVal iStat
53764>>>        If (psBranchPhone(self)<>'') Begin
53766>>>            If (bConnectionStatus(Self)) begin
53768>>>               Move (dvInternetHangup())    to iStat
ERROR: 54 Invalid symbol in expression DVINTERNETHANGUP ON LINE: 206 (53768) OF FILE: L:\VDF6\Develop\Empor\AppSrc\FTPVIEW.VW
53769>>>               If iStat Eq 0 Begin
53771>>>                    Set bConnectionStatus   to False
53772>>>                    Move 1 to rVal
53773>>>               End
53773>>>>
53773>>>               Else Begin
53774>>>                    Move 0 to rVal
53775>>>                    Send Info_Box "ƒœ¤ £§¦¨é ¤˜ ¡¢œå©à «ž¤ š¨˜££ã" "¢ž¨¦­¦¨å˜"
53776>>>               End
53776>>>>
53776>>>            End
53776>>>>
53776>>>            Else Move 1 to rVal
53778>>>        End
53778>>>>
53778>>>        Else Move 1 to rVal
53780>>>        Function_Return rVal
53781>>>    End_Function
53782>>>    
53782>>>    Function fiGetFile String asRemoteFile String asLocalFile Integer aiCancelIfExist Integer aiType Returns Integer
53784>>>        // aiCancelIfExist  =0 Overwrites local file if already exists
53784>>>        // aiCancelIfExist  =1 Cancel transfer if local file already exists
53784>>>        // aiType           =0 ASCII transfer method (Control and formatting
53784>>>        //                     information is converted to local equivalents.
53784>>>        //                  =1 BINARY transfer method. The file is
53784>>>        //                     transferred exactly as it exists with no changes.
53784>>>        Integer iRetVal
53785>>>        send AddInfo to (oStatusForm(Self)) ;            ("Šã¯ž"*asRemoteFile*"©œ"*asLocalFile-"...")
53786>>>        move ( dvFtpGetFile (asRemoteFile,asLocalFile,0,1)) to iRetVal
ERROR: 54 Invalid symbol in expression DVFTPGETFILE ON LINE: 232 (53786) OF FILE: L:\VDF6\Develop\Empor\AppSrc\FTPVIEW.VW
53787>>>        if iRetVal begin
53789>>>            Function_Return iRetVal
53790>>>        end
53790>>>>
53790>>>        send AddInfo to (oStatusForm(Self)) ("’¦ ˜¨®œå¦"*asRemoteFile*"œ¢ã­Ÿœ ")
53791>>>        Function_Return 0
53792>>>    End_Function
53793>>>    
53793>>>    Function fiSendFile String asLocalFile String asRemoteFile Integer aiMode Returns Integer
53795>>>        // aiType           =0 ASCII transfer method (Control and formatting
53795>>>        //                     information is converted to local equivalents.
53795>>>        //                  =1 BINARY transfer method. The file is
53795>>>        //                     transferred exactly as it exists with no changes.
53795>>>        Integer iRetVal
53796>>>        send AddInfo to (oStatusForm(Self)) ;            ("€§¦©«¦¢ã ˜¨®œå¦¬ "*asLocalFile*"©œ"*asRemoteFile-"...")
53797>>>        move (dvFtpPutFile(asLocalFile,asRemoteFile,1)) to iRetVal
ERROR: 54 Invalid symbol in expression DVFTPPUTFILE ON LINE: 248 (53797) OF FILE: L:\VDF6\Develop\Empor\AppSrc\FTPVIEW.VW
53798>>>        if iRetVal begin
53800>>>            Function_Return iRetVal
53801>>>        end
53801>>>>
53801>>>        send AddInfo to (oStatusForm (Self)) ("’¦ ˜¨®œå¦"*asLocalFile*"œ©«á¢œ ")
53802>>>        Function_Return 0
53803>>>    End_Function
53804>>>    
53804>>>    
53804>>>    //AB-StoreTopEnd
53804>>>
53804>>>    Set Label to "‹œ«˜­¦¨á €¨®œåà¤ £â©à FTP"
53805>>>    Set Size to 287 523
53806>>>    Set Location to 2 3
53807>>>
53807>>>    //AB-DDOStart
53807>>>
53807>>>    Object Units_DD is a Units_DataDictionary
53809>>>    End_Object    // Units_DD
53810>>>
53810>>>    Object Witemkat_DD is a Witemkat_DataDictionary
53812>>>    End_Object    // Witemkat_DD
53813>>>
53813>>>    Object Fpa_DD is a Fpa_DataDictionary
53815>>>    End_Object    // Fpa_DD
53816>>>
53816>>>    Object Item_DD is a Item_DataDictionary
53818>>>        Set DDO_Server to (Units_DD(self))
53819>>>        Set DDO_Server to (Witemkat_DD(self))
53820>>>        Set DDO_Server to (Fpa_DD(self))
53821>>>    End_Object    // Item_DD
53822>>>
53822>>>    Object Witemx_DD is a Witemx_DataDictionary
53824>>>        Set DDO_Server to (Item_DD(self))
53825>>>    End_Object    // Witemx_DD
53826>>>
53826>>>    Object Tmpsel_DD is a Tmpsel_DataDictionary
53828>>>    End_Object    // Tmpsel_DD
53829>>>
53829>>>    Set Main_DD to (Tmpsel_DD(self))
53830>>>    Set Server to (Tmpsel_DD(self))
53831>>>
53831>>>    //AB-DDOEnd
53831>>>
53831>>>    Object dbGrpYear is a dbGroupSub
53833>>>
53833>>>        //AB-StoreTopStart
53833>>>        Open Company
53835>>>        Open Branch
53837>>>        Open Year
53839>>>        Open SysCurXr
53841>>>        Open Nomisma
53843>>>        
53843>>>        Use Wax.DD
53843>>>        Use Witemx.DD
53843>>>        Use Witemxen.DD
53843>>>        Use Witemxtr.DD
53843>>>        Use Witemxt.DD
INCLUDING FILE: WITEMXT.DD
53843>>>>>//DDB-FileStart
53843>>>>>//DDB-HeaderStart
53843>>>>>
53843>>>>>// File Name : WITEMXT.DD
53843>>>>>// Class Name: Witemxt_DataDictionary
53843>>>>>// Revision  : 18
53843>>>>>// Version   : 2
53843>>>>>
53843>>>>>Use  Windows           // Basic Definitions
53843>>>>>Use  DataDict          // DataDictionary Class Definition
53843>>>>>Use  DDvalTbl          // Validation Table Class Definitions
53843>>>>>
53843>>>>>Open Witemxt
53845>>>>>Open Witemx
53847>>>>>Open Sysrecw
53849>>>>>
53849>>>>>//DDB-HeaderEnd
53849>>>>>
53849>>>>>Class Witemxt_DataDictionary  is a DataDictionary_Sec
53850>>>>>
53850>>>>>   Begin_Constraints
53851>>>>>        //Forward Send OnConstrain
53851>>>>>        Constrain WitemxT.Company_Code  eq SysCurXR.Company_Code
53853>>>>>        Constrain WitemxT.Branch_Code   eq SysCurXR.Branch_Code
53855>>>>>        Constrain WitemxT.Year_Year     eq SysCurXR.Year_Year
53857>>>>>    End_Constraints
53860>>>>>
53860>>>>>    // Update:
53860>>>>>    Procedure Update
53861>>>>>        Forward Send Update
53863>>>>>        // Insert Code Here
53863>>>>>        Move SysCurXR.Company_Code  to WitemxT.Company_Code
53864>>>>>        Move SysCurXR.Branch_Code   to WitemxT.Branch_Code
53865>>>>>        Move SysCurXR.Year_Year     to WitemxT.Year_Year
53866>>>>>        Move Witemx.Witemx_Recr     to WitemxT.Witemx_Recr
53867>>>>>        Move Item.Item_Code         to Witemxt.Item_Code
53868>>>>>    End_Procedure   // Update
53869>>>>>
53869>>>>>     Procedure Creating
53870>>>>>        Forward Send Creating
53872>>>>>        // Insert Code Here
53872>>>>>        //Move (Append('',((Trim(SysCurXR.Branch_Site))+;
53872>>>>>        //                  (Trim(String(WitemxT.WitemxT_Rec0)))))) to WitemxT.Witemx_Recr
53872>>>>>    End_Procedure   // Creating
53873>>>>>   
53873>>>>>    Procedure Shmera integer iField  Date dDate
53874>>>>>        Local Integer Changed
53875>>>>>        Get Field_Changed_State iField to Changed
53876>>>>>        If (Changed=0 AND dDate =0) Begin
53878>>>>>            SysDate4 dDate
53879>>>>>            Set Field_Default_Value iField to dDate
53880>>>>>        End
53880>>>>>>
53880>>>>>     End_Procedure   // Shmera
53881>>>>>
53881>>>>>//    Procedure Operation_Not_Allowed Integer iError_Num
53881>>>>>//        String lsError_Message
53881>>>>>//        Case Begin
53881>>>>>//            Case (iError_Num = 3001)
53881>>>>>//                Move "WITEMXT.DD (189): ’¦ â«¦ª «žª ž£/¤å˜ª  ©®ç¦ª \n›œ¤ «˜ ¨ áœ  £œ «¦ â«¦ª «¦¬ SYSCURXR" to lsError_Message
53881>>>>>//            Case Break
53881>>>>>//            Case (iError_Num = 3002)
53881>>>>>//                Move "WITEMXT.DD (189): ’¦ â«¦ª «žª ž£/¤å˜ª  ©®ç¦ª \n›œ¤ «˜ ¨ áœ  £œ «¦ â«¦ª «¦¬ WITEMX" to lsError_Message
53881>>>>>//            Case Break
53881>>>>>//            Case Else
53881>>>>>//                Forward Send Operation_Not_Allowed iError_Num
53881>>>>>//        Case End
53881>>>>>//        Error iError_Num lsError_Message
53881>>>>>//    End_Procedure // operation_not_allowed
53881>>>>>
53881>>>>>    Function Validate_Save  Returns Integer
53882>>>>>        Integer iReturnVal iEtos
53883>>>>>
53883>>>>>        Forward Get Validate_Save  To iReturnVal
53885>>>>>//        If (Not(iReturnVal)) Begin
53885>>>>>//            Move (TheYearSegment(Witemxt.Value_Date)) to iEtos
53885>>>>>//                 If (SyscurXR.Year_Year<>iEtos) Move 3001 to iReturnVal
53885>>>>>//            Else If (Witemx.Year_Year  <>iEtos) Move 3002 to iReturnVal
53885>>>>>//            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
53885>>>>>//        End
53885>>>>>        Function_Return iReturnVal
53886>>>>>    End_Function   // Validate_Save
53887>>>>>
53887>>>>>    // Define_Fields:
53887>>>>>    // This procedure is used to set up all data-dictionary rules.
53887>>>>>
53887>>>>>    Procedure Define_Fields
53888>>>>>        Forward Send Define_Fields
53890>>>>>        //DDB-Generated-Code-Location
53890>>>>>        //DDB-DefineFieldStart
53890>>>>>
53890>>>>>        Set Main_File            To Witemxt.File_Number
53891>>>>>
53891>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
53892>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
53893>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
53894>>>>>
53894>>>>>        // Parent (Server) file structure...............
53894>>>>>        Send Add_Server_File  Witemx.File_Number
53895>>>>>
53895>>>>>        // External (System) file structure.............
53895>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_NEW_SAVE_DELETE
53896>>>>>
53896>>>>>        Define_Auto_Increment  Sysrecw.Witemxt_Rec0  To Witemxt.Witemxt_Rec0
53899>>>>>
53899>>>>>        // Field-based properties.......................
53899>>>>>
53899>>>>>        // Witemxt.Company_Code
53899>>>>>
53899>>>>>        // Witemxt.Branch_Code
53899>>>>>
53899>>>>>        // Witemxt.Year_Year
53899>>>>>
53899>>>>>        // Witemxt.Witemxt_Rec0
53899>>>>>
53899>>>>>        // Witemxt.Witemx_Recr
53899>>>>>
53899>>>>>        // Witemxt.Axia
53899>>>>>
53899>>>>>        // Witemxt.Axia0
53899>>>>>
53899>>>>>        // Witemxt.Axia00
53899>>>>>
53899>>>>>        // Witemxt.Axiar
53899>>>>>
53899>>>>>        // Witemxt.Value_Date
53899>>>>>        Set Field_Entry_msg        Field Witemxt.Value_Date To Shmera
53900>>>>>        Set Field_Mask_Type        Field Witemxt.Value_Date To MASK_DATE_WINDOW
53901>>>>>
53901>>>>>        // Witemxt.Qty
53901>>>>>
53901>>>>>        // Witemxt.Pcdisc
53901>>>>>
53901>>>>>        // Witemxt.Orio
53901>>>>>
53901>>>>>        // Witemxt.Pagioorio
53901>>>>>
53901>>>>>        // Witemxt.Pcdiscantlia
53901>>>>>
53901>>>>>        // Witemxt.Item_Code
53901>>>>>
53901>>>>>        //DDB-DefineFieldEnd
53901>>>>>    End_Procedure    // Define_Fields
53902>>>>>
53902>>>>>    // Field_Defaults:
53902>>>>>    // This procedure is used to establish default field values.
53902>>>>>
53902>>>>>    Procedure Field_Defaults
53903>>>>>        Forward Send Field_Defaults
53905>>>>>        //DDB-Generated-Code-Location
53905>>>>>        //DDB-FieldDefaultStart
53905>>>>>        //DDB-FieldDefaultEnd
53905>>>>>    End_Procedure    // Field_Defaults
53906>>>>>
53906>>>>>End_Class    // Witemxt_DataDictionary
53907>>>>>//DDB-FileEnd
53907>>>        Use Ptyppar.DD
53907>>>        Use Itemd.DD
INCLUDING FILE: ITEMD.DD
53907>>>>>//DDB-FileStart
53907>>>>>//DDB-HeaderStart
53907>>>>>
53907>>>>>// File Name : ITEMD.DD
53907>>>>>// Class Name: Itemd_DataDictionary
53907>>>>>// Revision  : 22
53907>>>>>// Version   : 2
53907>>>>>
53907>>>>>Use  Windows           // Basic Definitions
53907>>>>>Use  DataDict          // DataDictionary Class Definition
53907>>>>>Use  DDvalTbl          // Validation Table Class Definitions
53907>>>>>
53907>>>>>Open Itemd
INCLUDING FILE: ITEMD.FD
53909>>>>>Open Itemtehn
53911>>>>>Open Sysrecw
53913>>>>>
53913>>>>>//DDB-HeaderEnd
53913>>>>>//DDB-SelectionStart
53913>>>>>//DDB/ ExternalSelectionList sl026  sl026.sl
53913>>>>>Register_Object sl026
53913>>>>>//DDB-SelectionEnd
53913>>>>>
53913>>>>>Class Itemd_DataDictionary  is a DataDictionary_Sec
53914>>>>>
53914>>>>>   Procedure OnConstrain
53915>>>>>       Constrain ITEMD.company eq SysCurXR.Company_Code
53917>>>>>       Constrain itemd.branch  eq SysCurXR.Branch_Code
53919>>>>>       
53919>>>>>    End_Procedure 
53920>>>>>    
53920>>>>>    
53920>>>>>    
53920>>>>>    
53920>>>>>    // Update:
53920>>>>>       
53920>>>>>    Procedure Update
53921>>>>>        Forward Send Update 
53923>>>>>        move syscurxr.company_code to itemd.company 
53924>>>>>        move syscurxr.branch_code  to itemd.branch 
53925>>>>>        number wtot##
53926>>>>>        move item.item_code  to itemd.item_code
53927>>>>>   //     move ((itemd.itemd_axia * itemd.itemd_qty * itemd.itemd_fpa) / 100) to wtot##
53927>>>>>   //     move ((itemd.itemd_axia * itemd.itemd_qty) + wtot##) to itemd.itemd_total
53927>>>>>    End_Procedure   // Update
53928>>>>>
53928>>>>>
53928>>>>>    // Define_Fields:
53928>>>>>    // This procedure is used to set up all data-dictionary rules.
53928>>>>>    Procedure Creating
53929>>>>>        Forward Send Creating
53931>>>>>        // Insert Code Here
53931>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Itemd.Itemd_Rec0)))))) to Itemd.Itemd_Recr
53932>>>>>    End_Procedure   // Creating
53933>>>>>    Procedure Define_Fields
53934>>>>>        Forward Send Define_Fields
53936>>>>>        //DDB-Generated-Code-Location
53936>>>>>        //DDB-DefineFieldStart
53936>>>>>
53936>>>>>        Set Main_File            To Itemd.File_Number
53937>>>>>
53937>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
53938>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
53939>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
53940>>>>>
53940>>>>>        // Parent (Server) file structure...............
53940>>>>>        Send Add_Server_File  Itemtehn.File_Number
53941>>>>>
53941>>>>>        // External (System) file structure.............
53941>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
53942>>>>>
53942>>>>>        Define_Auto_Increment  Sysrecw.Itemd_Rec0  To Itemd.Itemd_Rec0
53945>>>>>
53945>>>>>        // Field-based properties.......................
53945>>>>>
53945>>>>>        // Itemd.Item_Code
53945>>>>>
53945>>>>>        // Itemd.Item_Recr
53945>>>>>
53945>>>>>        // Itemd.Itemd_Code
53945>>>>>        Set Field_Prompt_Object    Field Itemd.Itemd_Code To (sl026(Self))
53946>>>>>
53946>>>>>        // Itemd.Itemd_Rec0
53946>>>>>
53946>>>>>        // Itemd.Itemd_Recr
53946>>>>>
53946>>>>>        // Itemd.Itemd_Qty
53946>>>>>
53946>>>>>        // Itemd.Itemd_Fpa
53946>>>>>
53946>>>>>        // Itemd.Itemd_Axia
53946>>>>>
53946>>>>>        // Itemd.Itemd_Total
53946>>>>>
53946>>>>>        // Itemd.Company
53946>>>>>
53946>>>>>        // Itemd.Branch
53946>>>>>
53946>>>>>        // Itemd.Itemtehn_Recr
53946>>>>>
53946>>>>>        // Itemd.Sap_Aa
53946>>>>>
53946>>>>>        // Itemd.Sap_Cc
53946>>>>>
53946>>>>>        // Itemd.Itemtehn_Code
53946>>>>>
53946>>>>>        //DDB-DefineFieldEnd
53946>>>>>    End_Procedure    // Define_Fields
53947>>>>>
53947>>>>>    // Field_Defaults:
53947>>>>>    // This procedure is used to establish default field values.
53947>>>>>
53947>>>>>    Procedure Field_Defaults
53948>>>>>        Forward Send Field_Defaults
53950>>>>>        //DDB-Generated-Code-Location
53950>>>>>        //DDB-FieldDefaultStart
53950>>>>>        //DDB-FieldDefaultEnd
53950>>>>>    End_Procedure    // Field_Defaults
53951>>>>>
53951>>>>>End_Class    // Itemd_DataDictionary
53952>>>>>//DDB-Selection-pkg-Start
53952>>>>>
53952>>>>>Use sl026.sl         // sl026
53952>>>>>
53952>>>>>//DDB-Selection-pkg-End
53952>>>>>//DDB-FileEnd
53952>>>        Use Bmove.DD
INCLUDING FILE: BMOVE.DD
53952>>>>>//DDB-FileStart
53952>>>>>//DDB-HeaderStart
53952>>>>>
53952>>>>>// File Name : BMOVE.DD
53952>>>>>// Class Name: Bmove_DataDictionary
53952>>>>>// Revision  : 51
53952>>>>>// Version   : 2
53952>>>>>
53952>>>>>Use  Windows           // Basic Definitions
53952>>>>>Use  DataDict          // DataDictionary Class Definition
53952>>>>>Use  DDvalTbl          // Validation Table Class Definitions
53952>>>>>
53952>>>>>Open Bmove
53954>>>>>Open Barticl
53956>>>>>Open Baxio
53958>>>>>Open Sysrecb
53960>>>>>Open Bkinkat
53962>>>>>Open Bsum
53964>>>>>
53964>>>>>//DDB-HeaderEnd
53964>>>>>
53964>>>>>      //§ Ÿ˜¤¦å ©¬¤›¬˜©£¦å « £é¤ «à¤ bkinkat.baxio_stat_from + bkinkat.baxio_stat_to
53964>>>>>      //  ˜§¦          ©œ
53964>>>>>      //    0           0    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
53964>>>>>      //    0           1    â ©˜šàšã ©«¦ ®˜¨«¦­¬¢á¡ ¦ (create a new baxio (33.90))
53964>>>>>      //    0           2    â¥˜šàšã ˜§¦ ®˜¨«¦­¬¢á¡ ¦  (create a new baxio (53.90))
53964>>>>>
53964>>>>>      //    1           0    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
53964>>>>>      //    1           1    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
53964>>>>>      //    1           2    â¥˜šàšã ˜§¦ ®˜¨«¦­¬¢á¡ ¦
53964>>>>>
53964>>>>>      //    2           0    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
53964>>>>>      //    2           1    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
53964>>>>>      //    2           2    £œ«˜™å™˜©ž §® ˜§¦ «¨á§œ˜ ©œ «¨á§œ˜
53964>>>>>
53964>>>>>
53964>>>>>Open SysCurXr
53966>>>>>Open Baxiokat
53968>>>>>Open Btypkin
53970>>>>>Open Bkinkat
53972>>>>>Open Baxio
53974>>>>>
53974>>>>>Class Bmove_DataDictionary  is a DataDictionary_Sec
53975>>>>>
53975>>>>>      Procedure Construct_Object
53976>>>>>                Forward Send Construct_Object
53978>>>>>
53978>>>>>                Property Integer piCan_Create_Baxio (FALSE)
53979>>>>>
53979>>>>>                //object id «é¤ ddo servers š ˜ «á barticl+bmove+baxio+baxiokat
53979>>>>>                //©œ«á¨¦¤«˜  ˜§¦ «ž¤ end_construct
53979>>>>>                //®¨ž© £œç¦¬¤ ©«ž¤ private.exit_btypkin_code
53979>>>>>                //š ˜ ¤˜ ©œ«á¨¦¬¤ «¦ visual interface
53979>>>>>                Property Integer piBarticl_dd        0
53980>>>>>                Property Integer piBaxio_dd          0
53981>>>>>                Property Integer piBtypkin_dd        0
53982>>>>>                Property Integer piBaxiokat_dd       0
53983>>>>>                Property Integer piBaxio_Status_From 0
53984>>>>>                Property Integer piBaxio_Status_To   0
53985>>>>>
53985>>>>>                Property Integer piCreated_Bmove  0 //©œ«á¨œ«˜  ©«ž¤ creating,
53986>>>>>                                                    //®¨ž© £¦§¦ œå«˜  ©«ž¤ update+validate_save ¡˜ 
53986>>>>>                                                    //£ž›œ¤åœ«˜  ©«ž¤ request_save & delete «¦¬ bmove
53986>>>>>
53986>>>>>                Property Integer piB_Baxio_Status  0
53987>>>>>                Property Integer piA_Baxio_Status  0
53988>>>>>
53988>>>>>                //19 §˜¢˜ âª « £âª
53988>>>>>                Property  Integer piB_Garticl_Rec0           0
53989>>>>>                Property  Integer piB_Gtypkin_Rec0           0
53990>>>>>                Property  Date    pdB_Garticl_Hmnia          0
53991>>>>>                Property  Integer piB_Garticl_No             0
53992>>>>>                Property  String  psB_Garticl_C_Code2        0
53993>>>>>                Property  Number  pnB_Garticl_Rate0          0
53994>>>>>                Property  Number  pnB_Garticl_Rate00         0
53995>>>>>                Property  Number  pnB_Garticl_RateR          0
53996>>>>>                Property  String  psB_Garticl_Aitiol         0
53997>>>>>
53997>>>>>                Property  Integer piB_Gmove_Master_Rec0      0
53998>>>>>                Property  Integer piB_Gplan_Master_Rec0      0
53999>>>>>                Property  Number  pnB_Gmove_Master_X2        0
54000>>>>>                Property  Number  pnB_Gmove_Master_P2        0
54001>>>>>                Property  String  psB_Gmove_Master_Aitiol    0
54002>>>>>
54002>>>>>                Property  Integer piB_Gmove_Slave_Rec0       0
54003>>>>>                Property  Integer piB_Gplan_Slave_Rec0       0
54004>>>>>                Property  Number  pnB_Gmove_Slave_X2         0
54005>>>>>                Property  Number  pnB_Gmove_Slave_P2         0
54006>>>>>                Property  String  psB_Gmove_Slave_Aitiol     0
54007>>>>>
54007>>>>>                //19 ¤âœª « £âª
54007>>>>>                Property  Integer piA_Garticl_Rec0           0
54008>>>>>                Property  Integer piA_Gtypkin_Rec0           0
54009>>>>>                Property  Date    pdA_Garticl_Hmnia          0
54010>>>>>                Property  Integer piA_Garticl_No             0
54011>>>>>                Property  String  psA_Garticl_C_Code2        0
54012>>>>>                Property  Number  pnA_Garticl_Rate0          0
54013>>>>>                Property  Number  pnA_Garticl_Rate00         0
54014>>>>>                Property  Number  pnA_Garticl_RateR          0
54015>>>>>                Property  String  psA_Garticl_Aitiol         0
54016>>>>>
54016>>>>>                Property  Integer piA_Gmove_Master_Rec0      0
54017>>>>>                Property  Integer piA_Gplan_Master_Rec0      0
54018>>>>>                Property  Number  pnA_Gmove_Master_X2        0
54019>>>>>                Property  Number  pnA_Gmove_Master_P2        0
54020>>>>>                Property  String  psA_Gmove_Master_Aitiol    0
54021>>>>>
54021>>>>>                Property  Integer piA_Gmove_Slave_Rec0       0
54022>>>>>                Property  Integer piA_Gplan_Slave_Rec0       0
54023>>>>>                Property  Number  pnA_Gmove_Slave_X2         0
54024>>>>>                Property  Number  pnA_Gmove_Slave_P2         0
54025>>>>>                Property  String  psA_Gmove_Slave_Aitiol     0
54026>>>>>
54026>>>>>                Property  Integer piDo_GL_Maintainance       0 //object id «žª business process
54027>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «ã¤ šœ¤ ¡ã ¢¦š ©« ¡ã
54027>>>>>                Property  Integer piDo_CUSTOMER_Maintainance 0 //object id «žª business process
54028>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §œ¢á«œª
54028>>>>>                Property  Integer piDo_VENDOR_Maintainance   0 //object id «žª business process
54029>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §¨¦£žŸœ¬«âª
54029>>>>>
54029>>>>>                //3 properties š ˜ «ž¤ feedback œ¤ž£â¨à©ž ˜§¦ «ž¤ š¢
54029>>>>>                Property Integer  piF_Garticl_Rec0           0
54030>>>>>                Property Integer  piF_Gmove_Master_Rec0      0
54031>>>>>                Property Integer  piF_Gmove_Slave_Rec0       0
54032>>>>>
54032>>>>>                Property Integer  piUpdate                   0
54033>>>>>                Property Integer  piBackout                  0
54034>>>>>
54034>>>>>                //properties š ˜ «ž¤ procedural œ¤ž£â¨à©ž «¦¬ bsum
54034>>>>>                Property String   psB_Barticl_Recr           ''
54035>>>>>                Property String   psB_Baxiokat_Recr          ''
54036>>>>>                Property Number   pnB_Baxio_V2               0
54037>>>>>                Property Number   pnB_Baxio_V0               0
54038>>>>>                Property Number   pnB_Baxio_V00              0
54039>>>>>                Property Number   pnB_Baxio_VR               0
54040>>>>>
54040>>>>>                Property String   psA_Barticl_Recr           ''
54041>>>>>                Property String   psA_Baxiokat_Recr          ''
54042>>>>>                Property Number   pnA_Baxio_V2               0
54043>>>>>                Property Number   pnA_Baxio_V0               0
54044>>>>>                Property Number   pnA_Baxio_V00              0
54045>>>>>                Property Number   pnA_Baxio_VR               0
54046>>>>>
54046>>>>>                //booleans §¦¬ ›ž¢é¤¦¬¤ «˜ operations §¦¬ Ÿ˜ šå¤¦¬¤ ©«ž¤ š¢
54046>>>>>                Property Integer  piGarticl_Delete          0 //©œ«á¨œ«˜  ©«ž¤ backout
54047>>>>>                Property Integer  piGarticl_Edit            0 //˜¤«åŸœ«¦ «¦¬ create (update)
54048>>>>>                Property Integer  piGarticl_Create          0 //©œ«á¨œ«˜  ©«ž¤ update
54049>>>>>
54049>>>>>                Property Integer  piMaster_Gmove_Delete     0 //©œ«á¨œ«˜  ©«ž¤ backout
54050>>>>>                Property Integer  piMaster_Gmove_Edit       0 //˜¤«åŸœ«¦ «¦¬ create (update)
54051>>>>>                Property Integer  piMaster_Gmove_Create     0 //©œ«á¨œ«˜  ©«ž¤ private.creating_barticl
54052>>>>>
54052>>>>>                Property Integer  piSlave_Gmove_Delete      0 //©œ«á¨¦¤«˜  ©«ž¤ update_bsum
54053>>>>>                Property Integer  piSlave_Gmove_Edit        0 //©œ«á¨¦¤«˜  ©«ž¤ update_bsum
54054>>>>>                Property Integer  piSlave_Gmove_Create      0 //©œ«á¨¦¤«˜  ©«ž¤ update_bsum
54055>>>>>
54055>>>>>                Property Integer    piMustNotConstrain      0
54056>>>>>
54056>>>>>
54056>>>>>      End_Procedure   //construct_object
54057>>>>>
54057>>>>>
54057>>>>>
54057>>>>>      //****************************************************************************************
54057>>>>>      //**************P R O C E D U R A L    „ Œ † ‹„  — ‘ †    B S U M************************
54057>>>>>      //****************************************************************************************
54057>>>>>
54057>>>>>
54057>>>>>      //¡˜¢œå«˜  ˜§æ save+delete_main_file, «˜ œ£§¢œ¡æ£œ¤˜ ˜¨®œå˜ œå¤˜  locked
54057>>>>>      //¡˜  transaction is enabled !
54057>>>>>      //œ§å©žª â®à current record ©œ æ¢˜ «˜ parents.
54057>>>>>      //¡˜¢œå «ž¤ private.update_bsum
54057>>>>>      //œ§ ©«¨â­œ  «˜ œ¥ãª ¢áŸž:6001:˜¡˜«á¢¢ž¢¦ §¨æ©ž£¦ (¢áŸ¦ª ¡é› ¡˜ª)
54057>>>>>      //                        6002:ƒâ¤ â«¨œ¥œ ¦ç«œ update ¦ç«œ backout !
54057>>>>>      //œ§å©žª ˜§¦ ¢áŸ¦ª «¦¬ ¡é› ¡˜, £§¦¨œå ¤˜ ›é©œ  ¡˜  Error 10001 "Wrong Num Arguments!\n\nPlease Call Solution!"
54057>>>>>
54057>>>>>      //¡˜¢œå «ž¤ private.update_bsum 1 ­¦¨á š ˜ backout (˜­˜å¨œ©ž §˜¢˜ é¤ « £é¤) ¡˜ 
54057>>>>>      //                              1 ­¦¨á š ˜ update  (§¨æ©Ÿœ©ž ¤âà¤ « £é¤)
54057>>>>>      //œ¢âš®¦¤«˜  æ¢œª ¦  §˜¨á£œ«¨¦  before+after œá¤ œå¤˜  å©œª,
54057>>>>>      //¦§æ«œ ›â¤ œ¤ž£œ¨é¤à    ‰ € ‡ Ž Š Ž “    «¦ bsum (§® ¡á¤à £æ¤¦¤ ˜¢¢˜šã ˜ « ¦¢¦šå˜ª)
54057>>>>>      Procedure private.Trexe Returns Integer
54058>>>>>                Integer liBackout liUpdate
54059>>>>>
54059>>>>>                String  lsB_Barticl_Recr lsB_Baxiokat_Recr
54059>>>>>                Number  lnB_Baxio_V2
54059>>>>>                Number  lnB_Baxio_V0
54059>>>>>                Number  lnB_Baxio_V00
54059>>>>>                Number  lnB_Baxio_VR
54059>>>>>
54059>>>>>                String  lsA_Barticl_Recr lsA_Baxiokat_Recr
54059>>>>>                Number  lnA_Baxio_V2
54059>>>>>                Number  lnA_Baxio_V0
54059>>>>>                Number  lnA_Baxio_V00
54059>>>>>                Number  lnA_Baxio_VR
54059>>>>>
54059>>>>>                //˜¤áš¤à©ž ¡˜«á©«˜©žª «¦¬ ddo
54059>>>>>                Get piBackout to liBackout
54060>>>>>                Get piUpdate  to liUpdate
54061>>>>>
54061>>>>>                //š ˜ ¢æš¦¬ª ˜©­˜¢œå˜ª, â¢œš®¦ª backout & update
54061>>>>>                If (;                     (liBAckout = 0) and;                     (liUpdate  = 0);                   ) Begin
54063>>>>>                      Send Operation_Not_Allowed 6002 //"ƒâ¤ â«¨œ¥œ ¦ç«œ update ¦ç«œ backout !"
54064>>>>>                      //Procedure_Return    //› ˜¡¦§ã «¦¬ transaction! (£á¢¢¦¤ «œ¢œåàª ˜§åŸ˜¤¦, but who knows!
54064>>>>>                     End
54064>>>>>>
54064>>>>>
54064>>>>>                //˜¤áš¤à©ž §˜¢˜ é¤ « £é¤
54064>>>>>                Get psB_Barticl_Recr  to lsB_Barticl_Recr
54065>>>>>                Get psB_Baxiokat_Recr to lsB_Baxiokat_Recr
54066>>>>>                Get pnB_Baxio_V2      to lnB_Baxio_V2
54067>>>>>                Get pnB_Baxio_V0      to lnB_Baxio_V0
54068>>>>>                Get pnB_Baxio_V00     to lnB_Baxio_V00
54069>>>>>                Get pnB_Baxio_VR      to lnB_Baxio_VR
54070>>>>>
54070>>>>>                //˜¤áš¤à©ž ¤âà¤ « £é¤
54070>>>>>                Get psA_Barticl_Recr  to lsA_Barticl_Recr
54071>>>>>                Get psA_Baxiokat_Recr to lsA_Baxiokat_Recr
54072>>>>>                Get pnA_Baxio_V2      to lnA_Baxio_V2
54073>>>>>                Get pnA_Baxio_V0      to lnA_Baxio_V0
54074>>>>>                Get pnA_Baxio_V00     to lnA_Baxio_V00
54075>>>>>                Get pnA_Baxio_VR      to lnA_Baxio_VR
54076>>>>>
54076>>>>>                //œá¤ æ¢œª ¦  §˜¨á£œ«¨¦  before+after œå¤˜  å©œª,
54076>>>>>                //«æ«œ ›â¤ £§˜å¤à ¡˜Ÿæ¢¦¬ ©«ž¤ œ¤ž£â¨à©ž  ©¦¬šåà¤,
54076>>>>>                //˜¢¢á ­œçšà ...«¨â®¦¤«˜ª!
54076>>>>>                //sosos £ã§àª §¨â§œ  ¤˜ œ¢œš¥à gtypkin + gplan slave master ?
54076>>>>>                If (;                     (lsB_Barticl_Recr  =lsA_Barticl_Recr ) and;                     (lsB_Baxiokat_Recr =lsA_Baxiokat_Recr) and;                     (lnB_Baxio_V2      =lnA_Baxio_V2)      and;                     (lnB_Baxio_V0      =lnA_Baxio_V0)      and;                     (lnB_Baxio_V00     =lnA_Baxio_V00)     and;                     (lnB_Baxio_VR      =lnA_Baxio_VR)         ;                    ) Begin
54078>>>>>                       Procedure_Return
54079>>>>>                      End
54079>>>>>>
54079>>>>>
54079>>>>>                //˜­˜å¨œ©ž §˜¢˜ é¤ « £é¤
54079>>>>>                If (liBackout = 1);                Begin
54081>>>>>                     Send private.Update_Bsum lsB_Barticl_Recr;                                              lsB_Baxiokat_Recr;                                              lnB_Baxio_V2;                                              lnB_Baxio_V0;                                              lnB_Baxio_V00;                                              lnB_Baxio_VR;                                              (-1)
54082>>>>>                End //if (libackout = 1)
54082>>>>>>
54082>>>>>
54082>>>>>                //§¨æ©Ÿœ©ž ¤âà¤ « £é¤
54082>>>>>                If (liUpdate = 1);                Begin
54084>>>>>                     Send private.Update_Bsum lsA_Barticl_Recr;                                              lsA_Baxiokat_Recr;                                              lnA_Baxio_V2;                                              lnA_Baxio_V0;                                              lnA_Baxio_V00;                                              lnA_Baxio_VR;                                              1
54085>>>>>                End //if (liupdate = 1)
54085>>>>>>
54085>>>>>      End_Procedure //private.trexe
54086>>>>>
54086>>>>>
54086>>>>>      //¡˜¢œå«˜  ˜§æ «ž¤ prepare_to_update_bsum
54086>>>>>      //¡˜Ÿ¦¨åœ  «¦ slave operation
54086>>>>>      Procedure private.Update_Bsum String lsBarticl_Recr;                                    String lsBaxiokat_Recr;                                    Number  lnV2;                                    Number  lnV0;                                    Number  lnV00;                                    Number  lnVR;                                    Integer liSign
54087>>>>>
54087>>>>>                Integer liSlave_Gmove_Create //¡˜Ÿ˜¨á š ˜ ¢æš¦¬ª compilation
54088>>>>>
54088>>>>>                //š ˜ ¢æš¦¬ª ˜©­˜¢œå˜ª, £ã¤ «¬®æ¤ ¥œ§œ¨á©à «¦¬ª 255 ®˜¨˜¡«ã¨œª
54088>>>>>                If (Num_Arguments <> 7 ) Error 10001 "Wrong Num Arguments!\n\nPlease Call Solution!"
54091>>>>>
54091>>>>>                //**************************************************************************
54091>>>>>                //01.¬§¦¢¦š ©£æª & â¢œš®¦ª §¨¦©ã£¦¬ (+ ã -)
54091>>>>>                //**************************************************************************
54091>>>>>                If (;                     ((Abs(liSign)) <> 1 );                   ) Begin
54093>>>>>                      Send Operation_Not_Allowed 6001 //˜¡˜«á¢¢ž¢¦ §¨æ©ž£¦ (¢áŸ¦ª ¡é› ¡˜ª)
54094>>>>>                                                      //› ˜¡¦§ã «¦¬ transaction!
54094>>>>>                     End
54094>>>>>>
54094>>>>>                Move (lnV2  * liSign) to lnV2
54095>>>>>                Move (lnV0  * liSign) to lnV0
54096>>>>>                Move (lnV00 * liSign) to lnV00
54097>>>>>                Move (lnVR  * liSign) to lnVR
54098>>>>>
54098>>>>>                //**************************************************************************
54098>>>>>                //02.œ¤ž£â¨à©ž bsum
54098>>>>>                //**************************************************************************
54098>>>>>
54098>>>>>                //02.1:œç¨œ©ž/›ž£ ¦¬¨šå˜ & œ¤ž£â¨à©ž bsum
54098>>>>>                Clear Bsum
54099>>>>>                Move lsBarticl_Recr  to Bsum.Barticl_Recr
54100>>>>>                Move lsBaxiokat_Recr to Bsum.Baxiokat_Recr
54101>>>>>                Find Eq Bsum by Index.1 //barticl_recr+baxiokat_recr !!!!!!
54102>>>>>>
54102>>>>>                If (Found=0);                Begin //˜¨®ã ›ž£ ¦¬¨šå˜s ¤â¦¬ record bsum
54104>>>>>
54104>>>>>                      // jsjsjs 27/01/2001
54104>>>>>                      Add 1 to SysrecB.Bsum_Rec0
54105>>>>>                      Saverecord SysrecB
54106>>>>>                      Move SysrecB.Bsum_Rec0  to Bsum.Bsum_Rec0
54107>>>>>                      Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                        (Trim(String(Bsum.Bsum_Rec0)))))) to Bsum.Bsum_Recr
54108>>>>>
54108>>>>>                      //Add 1 to SysrecB.Bsum_Rec0
54108>>>>>                      //Saverecord SysrecB
54108>>>>>                      //§¨¦©¦®ã ! ›â¤ â®à rec mhdenia  ! ! !
54108>>>>>                      //Move SysrecB.Bsum_Rec0       to Bsum.Bsum_Rec0
54108>>>>>                      //œ¤ž£â¨à©ž £ã related §œ›åà¤
54108>>>>>                      //§¨¦©¦®ã ! ›â¤ â®à £ã related §œ›å˜ ! ! !
54108>>>>>                      Set piSlave_Gmove_Create to 1  //›ž£ ¦¬¨šå˜ ¤â¦¬ gmove slave record
54109>>>>>                      Move 1 to liSlave_Gmove_Create //¡˜Ÿ˜¨á š ˜ ¢æš¦¬ª compilation
54110>>>>>                End //«â¢¦ª ›ž£ ¦¬¨šå˜s ¤â¦¬ record bsum
54110>>>>>>
54110>>>>>
54110>>>>>                //02.2:œ¤ž£â¨à©ž bsum (update+backout)
54110>>>>>
54110>>>>>                //02.3:©é© £¦ ã › ˜š¨˜­ã «¦¬ bsum
54110>>>>>
54110>>>>>                If (;                     (Bsum.Bsum_SV2 + lnV2  = 0) and;                     ((piUpdate(Self))      = 0);                   );                Begin
54112>>>>>                     Delete Bsum
54113>>>>>                     Set piSlave_Gmove_Delete  to 1 //› ˜š¨˜­ã gmove slave record
54114>>>>>                End
54114>>>>>>
54114>>>>>                Else;                Begin
54115>>>>>                     Add lnV2  to Bsum.Bsum_SV2
54116>>>>>                     Add lnV0  to Bsum.Bsum_SV0
54117>>>>>                     Add lnV00 to Bsum.Bsum_SV00
54118>>>>>                     Add lnVR  to Bsum.Bsum_SVR
54119>>>>>                     Saverecord Bsum
54120>>>>>                     Set piSlave_Gmove_Edit    to (Not(liSlave_Gmove_Create)) //edit gmove slave record
54121>>>>>                End
54121>>>>>>
54121>>>>>
54121>>>>>      End_Procedure //private.update_bsum
54122>>>>>      //****************************************************************************************
54122>>>>>      //**************P R O C E D U R A L    „ Œ † ‹„  — ‘ †    B S U M************************
54122>>>>>      //****************************************************************************************
54122>>>>>
54122>>>>>
54122>>>>>      //private
54122>>>>>      //¡˜¢œå«˜  ˜§æ request save & delete, ˜¡¨ ™éª §¨å¤ ¡˜  £œ«á «¦ forward send
54122>>>>>      Procedure private.Initialize_Properties
54123>>>>>                Integer liBarticl_dd liBaxio_dd
54124>>>>>
54124>>>>>                //barticl related properties
54124>>>>>                Get piBarticl_dd to liBarticl_dd
54125>>>>>                If (liBarticl_dd <> 0);                Begin //œá¤ æ¤«àª ™¨å©¡à ¡á§¦ ¦ barticl_server_ddo
54127>>>>>                     Set piCreated_Barticl of liBarticl_dd to 0
54128>>>>>                End
54128>>>>>>
54128>>>>>                Else Error 10000 "Bmove does not have a Barticl Server ! ! !"
54130>>>>>
54130>>>>>                //baxio   related properties
54130>>>>>                Get piBaxio_dd to liBaxio_dd
54131>>>>>                If (liBaxio_dd <> 0);                Begin //œá¤ æ¤«àª ™¨å©¡à ¡á§¦ ¦ baxio_server_ddo
54133>>>>>                     Set piCreated_Baxio   of liBaxio_dd to 0
54134>>>>>                     Set pnB_Baxio_V2      of liBaxio_dd to 0
54135>>>>>                     Set pnB_Baxio_V0      of liBaxio_dd to 0
54136>>>>>                     Set pnB_Baxio_V00     of liBaxio_dd to 0
54137>>>>>                     Set pnB_Baxio_Vr      of liBaxio_dd to 0
54138>>>>>                     Set psB_Baxio_C_Code2 of liBaxio_dd to ""
54139>>>>>                     Set piB_Baxio_Status  of liBaxio_dd to 0
54140>>>>>                     Set piB_Baxiokat_Code of liBaxio_dd to 0
54141>>>>>                     Set piB_Year_Year     of liBaxio_dd to 0
54142>>>>>                     Set piBtypkin_Flag03  of liBaxio_dd to 0
54143>>>>>                     Set piBtypkin_Flag04  of liBaxio_dd to 0
54144>>>>>                End
54144>>>>>>
54144>>>>>                Else Error 10000 "Bmove does not have a Baxio Server ! ! !"
54146>>>>>
54146>>>>>                Set piCreated_Bmove  to 0 //©œ«á¨œ«˜  ©«ž¤ creating,
54147>>>>>
54147>>>>>                //£ž›œ¤ ©£æª 19 §˜¢˜ é¤ « £é¤
54147>>>>>                Set piB_Garticl_Rec0         to 0
54148>>>>>                Set piB_Gtypkin_Rec0         to 0
54149>>>>>                Set pdB_Garticl_Hmnia        to 0
54150>>>>>                Set piB_Garticl_No           to 0
54151>>>>>                Set psB_Garticl_C_Code2      to 0
54152>>>>>                Set pnB_Garticl_Rate0        to 0
54153>>>>>                Set pnB_Garticl_Rate00       to 0
54154>>>>>                Set pnB_Garticl_RateR        to 0
54155>>>>>                Set psB_Garticl_Aitiol       to 0
54156>>>>>
54156>>>>>                Set piB_Gmove_Master_Rec0    to 0
54157>>>>>                Set piB_Gplan_Master_Rec0    to 0
54158>>>>>                Set pnB_Gmove_Master_X2      to 0
54159>>>>>                Set pnB_Gmove_Master_P2      to 0
54160>>>>>                Set psB_Gmove_Master_Aitiol  to 0
54161>>>>>
54161>>>>>                Set piB_Gmove_Slave_Rec0     to 0
54162>>>>>                Set piB_Gplan_Slave_Rec0     to 0
54163>>>>>                Set pnB_Gmove_Slave_X2       to 0
54164>>>>>                Set pnB_Gmove_Slave_P2       to 0
54165>>>>>                Set psB_Gmove_Slave_Aitiol   to 0
54166>>>>>
54166>>>>>                //£ž›œ¤ ©£æª 19 ¤âà¤ « £é¤
54166>>>>>                Set piA_Garticl_Rec0         to 0
54167>>>>>                Set piA_Gtypkin_Rec0         to 0
54168>>>>>                Set pdA_Garticl_Hmnia        to 0
54169>>>>>                Set piA_Garticl_No           to 0
54170>>>>>                Set psA_Garticl_C_Code2      to 0
54171>>>>>                Set pnA_Garticl_Rate0        to 0
54172>>>>>                Set pnA_Garticl_Rate00       to 0
54173>>>>>                Set pnA_Garticl_RateR        to 0
54174>>>>>                Set psA_Garticl_Aitiol       to 0
54175>>>>>
54175>>>>>                Set piA_Gmove_Master_Rec0    to 0
54176>>>>>                Set piA_Gplan_Master_Rec0    to 0
54177>>>>>                Set pnA_Gmove_Master_X2      to 0
54178>>>>>                Set pnA_Gmove_Master_P2      to 0
54179>>>>>                Set psA_Gmove_Master_Aitiol  to 0
54180>>>>>
54180>>>>>                Set piA_Gmove_Slave_Rec0     to 0
54181>>>>>                Set piA_Gplan_Slave_Rec0     to 0
54182>>>>>                Set pnA_Gmove_Slave_X2       to 0
54183>>>>>                Set pnA_Gmove_Slave_P2       to 0
54184>>>>>                Set psA_Gmove_Slave_Aitiol   to 0
54185>>>>>
54185>>>>>                Set piBaxio_Status_From      to 0
54186>>>>>                Set piBaxio_Status_To        to 0
54187>>>>>
54187>>>>>                //3 properties š ˜ «ž¤ feedback œ¤ž£â¨à©ž ˜§¦ «ž¤ š¢
54187>>>>>                Set piF_Garticl_Rec0         to 0
54188>>>>>                Set piF_Gmove_Master_Rec0    to 0
54189>>>>>                Set piF_Gmove_Slave_Rec0     to 0
54190>>>>>
54190>>>>>                Set piUpdate                 to 0
54191>>>>>                Set piBackout                to 0
54192>>>>>
54192>>>>>                //properties š ˜ «ž¤ procedural œ¤ž£â¨à©ž «¦¬ bsum
54192>>>>>                Set psB_Barticl_Recr         to ''
54193>>>>>                Set psB_Baxiokat_Recr        to ''
54194>>>>>                Set pnB_Baxio_V2             to 0
54195>>>>>                Set pnB_Baxio_V0             to 0
54196>>>>>                Set pnB_Baxio_V00            to 0
54197>>>>>                Set pnB_Baxio_VR             to 0
54198>>>>>
54198>>>>>                Set psA_Barticl_Recr         to ''
54199>>>>>                Set psA_Baxiokat_Recr        to ''
54200>>>>>                Set pnA_Baxio_V2             to 0
54201>>>>>                Set pnA_Baxio_V0             to 0
54202>>>>>                Set pnA_Baxio_V00            to 0
54203>>>>>                Set pnA_Baxio_VR             to 0
54204>>>>>
54204>>>>>                //booleans §¦¬ ›ž¢é¤¦¬¤ «˜ operations §¦¬ Ÿ˜ šå¤œ  ©«¦¤ š¢
54204>>>>>                Set  piGarticl_Delete         to  0
54205>>>>>                Set  piGarticl_Edit           to  0
54206>>>>>                Set  piGarticl_Create         to  0
54207>>>>>
54207>>>>>                Set  piMaster_Gmove_Delete    to  0
54208>>>>>                Set  piMaster_Gmove_Edit      to  0
54209>>>>>                Set  piMaster_Gmove_Create    to  0
54210>>>>>
54210>>>>>                Set  piSlave_Gmove_Delete     to  0
54211>>>>>                Set  piSlave_Gmove_Edit       to  0
54212>>>>>                Set  piSlave_Gmove_Create     to  0
54213>>>>>      End_Procedure //private.Initialize_Properties
54214>>>>>
54214>>>>>
54214>>>>>      //private
54214>>>>>      //¡˜¢œå«˜  ˜§¦ «ž¤ update
54214>>>>>      Procedure private.Creating_Barticl
54215>>>>>      End_Procedure //private.creating_barticl
54216>>>>>
54216>>>>>
54216>>>>>      //private
54216>>>>>      //¡˜¢œå«˜  ˜§¦ «ž¤ update, ˜­¦ç â®œ  ™¨œå kinkat record
54216>>>>>      Procedure private.Creating_Baxio
54217>>>>>                Integer liCan_Create_Baxio //¡˜Ÿ˜¨á š ˜ ¢æš¦¬ª compilation only
54218>>>>>
54218>>>>>                //¡˜«'˜¨®áª ¤â˜ axio records ›ž£ ¦¬¨š¦ç¤«˜  £æ¤¦¤ æ«˜¤ :
54218>>>>>                //˜) œå¤˜  œ ©§¨˜¡«â˜ + «¦ bkinkat œ§ «¨â§œ  ›ž£ ¦¬¨šå˜, ã
54218>>>>>                //™) œå¤˜  §¢ž¨à«â˜   + «¦ bkinkat œ§ «¨â§œ  ›ž£ ¦¬¨šå˜.
54218>>>>>                //æ«˜¤ ›ž£ ¦¬¨š¦ç£œ ¤â˜ axio records, «æ«œ:
54218>>>>>                //˜)œ¤ž£â¨à©ž §œ›åà¤ first in, £æ¤¦ š ˜ œ ©§¨˜¡«â˜
54218>>>>>                //™)œ¤ž£â¨à©ž §œ›åà¤ first out, £æ¤¦ š ˜ §¢ž¨à«â˜
54218>>>>>                //š) §œ›å˜ status + place (˜¬«á «œ¢ ¡á «˜ œ¤ž£œ¨é¤à ©«ž¤ update)
54218>>>>>                Case Begin
54218>>>>>                     //›ž£ ¦¬¨šå˜ ˜¥ ¦š¨á­¦¬ œ ©§¨˜¡«â¦¬, œ¡¡¨œ£âª ©«¦ ®˜¨«¦­¬¢á¡ ¦
54218>>>>>                     Case ((Baxiokat.Baxiokat_Type = 1) and (Bkinkat.Bkinkat_Yn_New = 1))
54220>>>>>                          Move Btypkin.Btypkin_Anti1   to Baxio.Baxio_File_In
54221>>>>>                          Move Barticl.Barticl_Code1   to Baxio.Baxio_Code_In
54222>>>>>                          Move Barticl.Barticl_Epon1   to Baxio.Baxio_Epon_In
54223>>>>>                          Move Barticl.Barticl_Recr    to Baxio.Baxio_Fpar_In
54224>>>>>
54224>>>>>                          Move (-1)                    to Baxio.Baxio_File_Out //›â¤ ¬§á¨®œ 
54225>>>>>                          Move ""                      to Baxio.Baxio_Code_Out
54226>>>>>                          Move ""                      to Baxio.Baxio_Epon_Out
54227>>>>>                          Move 0                       to Baxio.Baxio_Fpar_Out
54228>>>>>                     Case Break
54229>>>>>
54229>>>>>                     //›ž£ ¦¬¨šå˜ ˜¥ ¦š¨á­¦¬ §¢ž¨à«â¦¬, œ¡¡¨œ£âª ©«¦ bkinkat_plac_to
54229>>>>>                     Case ((Baxiokat.Baxiokat_Type = 2) and (Bkinkat.Bkinkat_Yn_New = 1))
54232>>>>>                          Move (-1)                    to Baxio.Baxio_File_In  //›â¤ ¬§á¨®œ 
54233>>>>>                          Move ""                      to Baxio.Baxio_Code_In
54234>>>>>                          Move ""                      to Baxio.Baxio_Epon_In
54235>>>>>                          Move 0                       to Baxio.Baxio_Fpar_In
54236>>>>>
54236>>>>>                          Move Btypkin.Btypkin_Anti1   to Baxio.Baxio_File_Out
54237>>>>>                          Move Barticl.Barticl_Code1   to Baxio.Baxio_Code_Out
54238>>>>>                          Move Barticl.Barticl_Epon1   to Baxio.Baxio_Epon_Out
54239>>>>>                          Move Barticl.Barticl_Recr    to Baxio.Baxio_Fpar_Out
54240>>>>>                     Case Break
54241>>>>>
54241>>>>>                     Case Else //§¨¦­˜¤éª ¡á«  ›â¤ §áœ  ¡˜¢á
54241>>>>>                          Send Operation_Not_Allowed 3001 //›â¤ œ§ «¨â§œ«˜  ž ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬
54242>>>>>                Case End
54242>>>>>
54242>>>>>                If (Trim(Baxio.Baxio_C_Code2)='') Move (Trim(SysCurXr.C_Code0)) to Baxio.Baxio_C_Code2
54245>>>>>                Move barticl.barticl_hmnia  to baxio.baxio_hmniae
54246>>>>>                //›œç«œ¨¦ª â¢œš®¦ª ›ž£ ¦¬¨šå˜ª ¤â¦¬ ˜¥ ¦š¨á­¦¬ ˜§æ «¦ bkinkay_yn_create !
54246>>>>>                Get piCan_Create_Baxio to liCan_Create_Baxio //¡˜Ÿ˜¨á š ˜ ¢æš¦¬ª compilation only
54247>>>>>                If (liCan_Create_Baxio = FALSE) Send Operation_Not_Allowed 3001 //›â¤ œ§ «¨â§œ«˜  ž ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬
54250>>>>>      End_Procedure //private.creating_baxio
54251>>>>>
54251>>>>>
54251>>>>>//      //private
54251>>>>>//      //™¨å©¡œ  ˜§æ «¦ bsum «¦ gmove slave rec0
54251>>>>>//      //¡˜¢œå«˜  ˜§æ update+backout ?
54251>>>>>//      Function private.fiBsum_Gmove_Srec0 String lsBarticl_Recr ;
54251>>>>>//                                          String lsBaxiokat_Recr;
54251>>>>>//                                          Returns Integer
54251>>>>>//               Clear Bsum
54251>>>>>//               Move lsBarticl_Recr  to Bsum.Barticl_Recr
54251>>>>>//               Move lsBaxiokat_Recr to Bsum.Baxiokat_Recr
54251>>>>>//               Find Eq Bsum by Index.1 //barticl_recr+baxiokat_recr
54251>>>>>//               Function_Return Bsum.Gmove_Srec0
54251>>>>>//      End_Function //private.fibsum_gmove_srec0
54251>>>>>
54251>>>>>
54251>>>>>      //private
54251>>>>>      //™¨å©¡œ  œá¤ ž ©¬š¡œ¡¨ £â¤ž btypkin ¡ ¤œå «¦ libaxiokat_code
54251>>>>>      //¡˜¢œå«˜  ˜§æ update+validate_save
54251>>>>>      Function private.fiBkinkat_Baxiokat_Code String lsBtypkin_Recr;                                               Integer liBaxiokat_Code;                                               Returns Integer
54252>>>>>               Clear Bkinkat
54253>>>>>               Move SysCurXr.Company_Code   to Bkinkat.Company_Code
54254>>>>>               Move SysCurXr.Branch_Code    to Bkinkat.Branch_Code
54255>>>>>               Move SysCurXr.Year_Year      to Bkinkat.Year_year
54256>>>>>               Move lsBtypkin_Recr          to Bkinkat.Btypkin_Recr
54257>>>>>               Move liBaxiokat_Code         to Bkinkat.Baxiokat_Code
54258>>>>>               Find Eq Bkinkat by Index.3 //Company+Branch+Year+btypkin_recr+baxiokat_code
54259>>>>>>
54259>>>>>               If (Found = 0) Begin
54261>>>>>                               Set piBaxio_Status_From to (-1)
54262>>>>>                               Set piBaxio_Status_To   to (-1)
54263>>>>>                               Function_Return 0
54264>>>>>                              End
54264>>>>>>
54264>>>>>               Set piBaxio_Status_From to Bkinkat.Baxio_Stat_From
54265>>>>>               Set piBaxio_Status_To   to Bkinkat.Baxio_Stat_To
54266>>>>>
54266>>>>>
54266>>>>>               Function_Return Bkinkat.Baxiokat_Code
54267>>>>>      End_Function //private.fibkinkat_baxiokat_code
54268>>>>>
54268>>>>>
54268>>>>>      //¡˜¢œå«˜  ˜§æ update & backout
54268>>>>>      //¡˜  œ¤ž£œ¨é¤œ  « ª ©¬¤¦¢ ¡âª ˜¥åœª «¦¬ barticl
54268>>>>>      Procedure private.Adjust_Balances Integer liSign;                                        Number  lnBaxio_V2;                                        Number  lnBaxio_V0;                                        Number  lnBaxio_V00;                                        Number  lnBaxio_VR
54269>>>>>                If (;                     ((Abs(liSign)) <> 1 );                   ) Begin
54271>>>>>                      Error 10000 "€¡˜«á¢¢ž¢¦ §¨æ©ž£¦, ¢áŸ¦ª ¡é› ¡˜" //› ˜¡¦§ã «¦¬ transaction!
54272>>>>>>
54272>>>>>                      Procedure_Return
54273>>>>>                     End
54273>>>>>>
54273>>>>>
54273>>>>>                 //¤æ£ ©£˜ œšš¨˜­ãª
54273>>>>>                Add (lnBaxio_V2  * liSign) to Barticl.Barticl_SV2
54274>>>>>
54274>>>>>                //¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©žª
54274>>>>>                Add (lnBaxio_V0  * liSign) to Barticl.Barticl_SV0
54275>>>>>
54275>>>>>                //›œ¬«œ¨œç¦¤ ¤æ£ ©£˜ ®¨ã©žª
54275>>>>>                Add (lnBaxio_V00 * liSign) to Barticl.Barticl_SV00
54276>>>>>
54276>>>>>                //¤æ£ ©£˜ reporting
54276>>>>>                Add (lnBaxio_VR  * liSign) to Barticl.Barticl_SVR
54277>>>>>      End_Procedure //private.adjust_balances
54278>>>>>
54278>>>>>
54278>>>>>
54278>>>>>
54278>>>>>      //æ¢˜ «˜ ddo ˜¬«ãª «ãª ¡¢á©žª, œ¤ž£œ¨é¤¦¬¤ «˜ 4 parents ¡˜  «¦¤ œ¬˜«æ «¦¬ª
54278>>>>>      //£œ æ¢˜ «˜ ddo id's
54278>>>>>      //œ§å©žª §¨â§œ  ¤˜ ¬§á¨®¦¬¤ ¡˜  ¦  3 bpo's š ˜ «ž¤ œ¤ž£â¨à©ž «à¤ ¢¦ §é¤ modules
54278>>>>>      Procedure End_Construct_Object
54279>>>>>                Integer liBtypkin_dd liBarticl_dd liBaxio_dd liBaxiokat_dd
54280>>>>>
54280>>>>>                Forward Send End_Construct_Object
54282>>>>>
54282>>>>>                Move (Find_Server_DDO(Self        ,Barticl.File_Number )) to liBarticl_dd
54283>>>>>                Move (Find_Server_DDO(Self        ,Baxio.File_Number   )) to liBaxio_dd
54284>>>>>                Move (Find_Server_DDO(liBarticl_dd,Btypkin.File_Number )) to liBtypkin_dd
54285>>>>>                Move (Find_Server_DDO(liBaxio_dd  ,Baxiokat.File_Number)) to liBaxiokat_dd
54286>>>>>
54286>>>>>                //object id «žª business process §¦¬ œ¤ž£œ¨é¤œ  «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã
54286>>>>>                //jsjsjs 24/01/2001 Set piDo_GL_Maintainance       to (oDo_GL_Maintainance      (Self))
54286>>>>>
54286>>>>>                //object id «žª business process §¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §œ¢á«œª
54286>>>>>//------------->Set piDo_CUSTOMER_Maintainance to (oDo_CUSTOMER_Maintainance(Self))
54286>>>>>
54286>>>>>                //object id «žª business process §¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §¨¦£žŸœ¬«âª
54286>>>>>//------------->Set piDo_VENDOR_Maintainance   to (oDo_VENDOR_Maintainance  (Self))
54286>>>>>
54286>>>>>                //â¢œš®¦  ¬§¦®¨œà« ¡ãª ç§˜¨¥žª ¡˜  «à¤ 4 ddo'w
54286>>>>>                If (liBarticl_dd  = 0) Error 10000 "Bmove does not have a Barticl  Server ! ! !"
54289>>>>>                If (liBaxio_dd    = 0) Error 10000 "Bmove does not have a Baxio    Server ! ! !"
54292>>>>>                If (liBtypkin_dd  = 0) Error 10000 "Bmove does not have a Btypkin  Server ! ! !"
54295>>>>>                If (liBaxiokat_dd = 0) Error 10000 "Bmove does not have a Baxiokat Server ! ! !"
54298>>>>>
54298>>>>>                //properties › ¡á «¦¬
54298>>>>>                //æ§¦¬ «˜ ®¨ž© £¦§¦ é, Ÿ˜ £§¦¨¦ç©˜ ¤˜ â¡˜¤˜ «ž¤ å› ˜ ›¦¬¢œ á £œ «ž¤ file_field_value ?
54298>>>>>                //æ®  ©« ª §œ¨ §«é©œ ª §¦¬ › ˜®œ ¨å¦£˜¦ properties !
54298>>>>>                Set piBarticl_dd                  to liBarticl_dd
54299>>>>>                Set piBaxio_dd                    to liBaxio_dd
54300>>>>>                Set piBtypkin_dd                  to liBtypkin_dd
54301>>>>>                Set piBaxiokat_dd                 to liBaxiokat_dd
54302>>>>>
54302>>>>>                //properties «¦¬ btypkin
54302>>>>>                Set piBarticl_dd  of liBtypkin_dd to liBarticl_dd
54303>>>>>                Set piBmove_dd    of liBtypkin_dd to Self
54304>>>>>                Set piBaxio_dd    of liBtypkin_dd to liBaxio_dd
54305>>>>>                Set piBaxiokat_dd of liBtypkin_dd to liBaxiokat_dd
54306>>>>>
54306>>>>>                //properties «¦¬ baxiokat
54306>>>>>                Set piBarticl_dd  of liBaxiokat_dd to liBarticl_dd
54307>>>>>                Set piBmove_dd    of liBaxiokat_dd to Self
54308>>>>>                Set piBaxio_dd    of liBaxiokat_dd to liBaxio_dd
54309>>>>>                Set piBtypkin_dd  of liBaxiokat_dd to liBtypkin_dd
54310>>>>>
54310>>>>>                //properties «¦¬ barticl
54310>>>>>                Set piBmove_dd    of liBarticl_dd  to Self
54311>>>>>                Set piBaxio_dd    of liBarticl_dd  to liBaxio_dd
54312>>>>>                Set piBtypkin_dd  of liBarticl_dd  to liBtypkin_dd
54313>>>>>                Set piBaxiokat_dd of liBarticl_dd  to liBaxiokat_dd
54314>>>>>
54314>>>>>      End_Procedure   //end_construct_object
54315>>>>>
54315>>>>>      //£á¢¢¦¤ œå¤˜  á®¨ž©«ž, › æ«  §á¤«˜ «¦ bmove_dd «¦ › ˜®œ ¨å¦£˜ 
54315>>>>>      //œå«˜  ©˜¤ detail «¦¬ barticl, œå«˜  ©˜¤ detail «¦¬ baxio !
54315>>>>>      //ã constrain Ÿ˜ £¦¬ ®¨œ ˜©Ÿœå £æ¤¦¤ œá¤ â®à main server «¦ bmove_dd ! ! !
54315>>>>>      Procedure Constrain
54316>>>>>            Forward Send Constrain
54318>>>>>            If (piMustNotConstrain(Self)=2) Begin
54320>>>>>                Constrain Bmove.Company_Code  eq SysCurXR.Company_Code
54322>>>>>                Constrain Bmove.Branch_Code   eq SysCurXR.Branch_Code
54324>>>>>            End
54324>>>>>>
54324>>>>>            Else Begin
54325>>>>>                Constrain Bmove.Company_Code  eq SysCurXR.Company_Code
54327>>>>>                Constrain Bmove.Branch_Code   eq SysCurXR.Branch_Code
54329>>>>>                Constrain Bmove.Year_Year     eq SysCurXR.Year_Year
54331>>>>>            End
54331>>>>>>
54331>>>>>      End_Procedure   //constrain
54332>>>>>
54332>>>>>
54332>>>>>      //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
54332>>>>>      //™) ˜¤áš¤à©ž properties
54332>>>>>      //š) › ˜®œå¨ ©ž calculated §œ›åà¤
54332>>>>>      //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
54332>>>>>      //œ) œ¤ž£â¨à©ž properties after
54332>>>>>      Procedure Update
54333>>>>>                Integer liTemp
54334>>>>>                Integer liBarticl_dd      liBaxio_dd
54334>>>>>                Integer liCreated_Barticl liCreated_Baxio
54334>>>>>                String  lsGplan_Slave_Code
54334>>>>>
54334>>>>>                Forward Send Update
54336>>>>>
54336>>>>>                //0)š ˜ ¢æš¦¬ª  › ˜ «œ¨æ«ž«˜ª, æ¢¦ª ¦ ¡é› ¡˜ª
54336>>>>>                //«é¤ creating baxio + barticl  (?) «¨â®œ  «é¨˜, ˜§¦ «ž¤ update «¦¬ bmove ! ! !
54336>>>>>                //§¨é«˜ œ¤«¦§åà bkikat
54336>>>>>                Move (private.fiBkinkat_Baxiokat_Code(Self,;                                    Btypkin.Btypkin_Recr,;                                    Baxiokat.Baxiokat_Code);                     ) to liTemp
54337>>>>>                If (liTemp = 0) Send Operation_Not_Allowed 3002 //›â¤ œ§ «¨â§œ«˜  ž ¡å¤ž©ž baxiokat_code £œ «¦ btypkin
54340>>>>>
54340>>>>>
54340>>>>>                //***********************************************************
54340>>>>>                //*    ˜§æ œ›é ¡˜  ¡á«à, â®à §¢â¦¤ active bkinkat record    *
54340>>>>>                //***********************************************************
54340>>>>>
54340>>>>>
54340>>>>>                //œç¨œ©ž «à¤ 2 server ddo's
54340>>>>>                Get piBarticl_dd to liBarticl_dd
54341>>>>>                Get piBaxio_dd   to liBaxio_dd
54342>>>>>
54342>>>>>                //œ¤ž£â¨à©ž «¦¬ parent barticl dd
54342>>>>>                If (liBarticl_dd <> 0);                Begin
54344>>>>>                    Get piCreated_Barticl of liBarticl_dd to liCreated_Barticl
54345>>>>>                    If (liCreated_Barticl = TRUE)  Send private.Creating_Barticl
54348>>>>>                End
54348>>>>>>
54348>>>>>                Else Error 10000 "Bmove does not have a Barticl Server ! ! !"
54350>>>>>
54350>>>>>                //œ¤ž£â¨à©ž «¦¬ parent baxio dd
54350>>>>>                If (liBaxio_dd   <> 0);                Begin
54352>>>>>                    Get piCreated_Baxio   of liBaxio_dd   to liCreated_Baxio
54353>>>>>                    If (liCreated_Baxio   = TRUE)  Send private.Creating_Baxio
54356>>>>>                    Set piBtypkin_Flag03 of liBaxio_dd to Btypkin.Btypkin_Flag03
54357>>>>>                    Set piBtypkin_Flag04 of liBaxio_dd to Btypkin.Btypkin_Flag04
54358>>>>>                End
54358>>>>>>
54358>>>>>                Else Error 10000 "Bmove does not have a Baxio Server ! ! !"
54360>>>>>
54360>>>>>// jsjsjs sos energopoihsh xenou nomismatos 29/11/2001
54360>>>>>//                //***************************************************************************
54360>>>>>//                //============================================================================
54360>>>>>//                //||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
54360>>>>>//                //£œ«˜«¨¦§ã «žª ˜¥å˜ª ˜§æ ¤æ£ ©£˜ œšš¨˜­ãª (2) ©«˜ ¢¦ §á 3 ¤¦£å©£˜«˜  (0+00+r)
54360>>>>>//                Move 1                  to Baxio.Baxio_Rate0 //sosososo §¨¦©à¨ ¤á, £æ¤¦¤ ˜¥ æš¨˜­˜ ©œ ›¨®
54360>>>>>//                Move SysCurXr.C_Code0   to Baxio.Baxio_C_Code2 //sosososo §¨¦©à¨ ¤á, £æ¤¦¤ ˜¥ æš¨˜­˜ ©œ ›¨®
54360>>>>>//                //***************************************************************************
54360>>>>>//                //============================================================================
54360>>>>>//                //||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
54360>>>>>// jsjsjs sos energopoihsh xenou nomismatos 29/11/2001
54360>>>>>
54360>>>>>                Send Convert_Axio_Values to liBaxio_dd
54361>>>>>
54361>>>>>
54361>>>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
54361>>>>>                Move SysCurXr.Company_Code  to Bmove.Company_Code
54362>>>>>                Move SysCurXr.Branch_Code   to Bmove.Branch_Code
54363>>>>>                Move SysCurXr.Year_Year     to Bmove.Year_Year
54364>>>>>                Move Baxio.Baxio_Code       to Bmove.Baxio_Code
54365>>>>>                Move Btypkin.Btypkin_Code   to Bmove.Btypkin_Code
54366>>>>>                Move Btypkin.Btypkin_Recr   to Bmove.Btypkin_Recr
54367>>>>>                Move Barticl.Barticl_Hmnia  to Bmove.Barticl_Hmnia
54368>>>>>                Move Barticl.Barticl_No     to Bmove.Barticl_No
54369>>>>>
54369>>>>>                Move Barticl.Sls_ID         to Bmove.Sls_ID
54370>>>>>                Move Barticl.Presp_ID       to Bmove.Presp_ID
54371>>>>>                Move Barticl.Cnt_ID         to Bmove.Cnt_ID
54372>>>>>
54372>>>>>
54372>>>>>                //™) ˜¤áš¤à©ž properties
54372>>>>>
54372>>>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
54372>>>>>
54372>>>>>                //š.01:œ¤ž£â¨à©ž §œ›åà¤ previous §˜¨˜¢ã§«žª «¦¬ bmove š ˜ æ¢˜ «˜ ˜¥ æš¨˜­˜
54372>>>>>                //     §¨¦«¦ç ˜¢¢á¥à «˜ last §œ›å˜ «¦¬ baxio, «˜ ¡¨˜«áà ©«˜
54372>>>>>                //     previous §œ›å˜ «¦¬ bmove,
54372>>>>>                //     é©«œ ©«ž¤ deleting ¤˜ «˜ œ§˜¤˜­â¨à
54372>>>>>                Move Baxio.Baxio_Lfile      to  Bmove.Baxio_Pfile
54373>>>>>                Move Baxio.Baxio_Lcode      to  Bmove.Baxio_Pcode
54374>>>>>                Move Baxio.Baxio_Lepon      to  Bmove.Baxio_Pepon
54375>>>>>                Move Baxio.Baxio_Lpar       to  Bmove.Baxio_Ppar
54376>>>>>
54376>>>>>                //š.02:œ¤ž£â¨à©ž §œ›åà¤ last («œ¢œ¬«˜å¦ª §˜¨˜¢ã§«žª) «¦¬ baxio š ˜ æ¢˜ «˜ ˜¥ æš¨˜­˜
54376>>>>>
54376>>>>>// ----------------------------------------------------------------------------
54376>>>>>// js 24/02/2002    Ayth h periptosh den isxyei xoris elegxo giati otan afora
54376>>>>>//                  plhromh dikh mas o promhtheyths mpainei sto 1o koutaki dhladh
54376>>>>>//                  ston ekdoth kai paramenei kenos o apodekths (Code2).
54376>>>>>//                  Otan loipon menei kenos o apodekths den enhmeronei Lcode
54376>>>>>//                  kai an den enhmerosei Lcode tote apo to Baxio_DD katharizontai
54376>>>>>//                  ola ta _Out pedia
54376>>>>>
54376>>>>>//                Move Btypkin.Btypkin_Anti2  to Baxio.Baxio_Lfile
54376>>>>>//                Move Barticl.Barticl_Code2  to Baxio.Baxio_Lcode
54376>>>>>//                Move Barticl.Barticl_Epon2  to Baxio.Baxio_Lepon
54376>>>>>//                Move Barticl.Barticl_Recr   to Baxio.Baxio_Lpar
54376>>>>>                if (btypkin.btypkin_code=104) move 1 to baxio.baxio_rater
54379>>>>>                If (Baxiokat.Baxiokat_Type = 2) Begin
54381>>>>>                    If (Trim(Barticl.Barticl_Code2)<>'') Begin
54383>>>>>                        Move Btypkin.Btypkin_Anti2  to Baxio.Baxio_Lfile
54384>>>>>                        Move Barticl.Barticl_Code2  to Baxio.Baxio_Lcode
54385>>>>>                        Move Barticl.Barticl_Epon2  to Baxio.Baxio_Lepon
54386>>>>>                        Move Barticl.Barticl_Recr   to Baxio.Baxio_Lpar
54387>>>>>                    End
54387>>>>>>
54387>>>>>                    Else Begin
54388>>>>>                        Move Btypkin.Btypkin_Anti1  to Baxio.Baxio_Lfile
54389>>>>>                        Move Barticl.Barticl_Code1  to Baxio.Baxio_Lcode
54390>>>>>                        Move Barticl.Barticl_Epon1  to Baxio.Baxio_Lepon
54391>>>>>                        Move Barticl.Barticl_Recr   to Baxio.Baxio_Lpar
54392>>>>>                    End
54392>>>>>>
54392>>>>>                End
54392>>>>>>
54392>>>>>                Else If (Baxiokat.Baxiokat_Type = 1) Begin
54395>>>>>                    // js 24/02/2002 PARATHRHSEIS
54395>>>>>                    // Edo den kanoume elegxo giati an einai eisprakteo (xoris metavivash)
54395>>>>>                    // tote epeidh den anoigei to Code2 ex orismou tha einai kena
54395>>>>>                    // An tora einai eispraktea pros metavivash tote ex orismou
54395>>>>>                    // to Code2 exei timh apo thn othonh opote kai tha enhmerosei
54395>>>>>                    // me Lcode h update tou Baxio_DD
54395>>>>>                    // to kolpo edo einai oti apitoume apo ton xrhsth sthn periptosh
54395>>>>>                    // metavivashs na plhktrologhsei ston ekdoth KAI ston apodekth
54395>>>>>                    // ton idio kodiko tou promhtheyth ston opoio metavivazei thn epitagh
54395>>>>>
54395>>>>>                    // Ayto prepei sto epomeno version na allaxei opos epishs kai to gegonos
54395>>>>>                    // oti menei panta keno to pedio tou paralhpth stis eispraktees apo pelath
54395>>>>>                    // eno theoro oti tha prepe na mpainei h 'etairia' opos epishs kai
54395>>>>>                    // stis epitages plhrotees dikes mas menei keno o ekdoths pou pali
54395>>>>>                    // tha'prepe na'maste 'emeis' (Mia kartella dhladh opou h 'etairia mas'
54395>>>>>                    // tha emfanizetai kai pelaths kai promhtheyths.
54395>>>>>                    // js 24/02/2002 Parathrhseis
54395>>>>>                    Move Btypkin.Btypkin_Anti2  to Baxio.Baxio_Lfile
54396>>>>>                    Move Barticl.Barticl_Code2  to Baxio.Baxio_Lcode
54397>>>>>                    Move Barticl.Barticl_Epon2  to Baxio.Baxio_Lepon
54398>>>>>                    Move Barticl.Barticl_Recr   to Baxio.Baxio_Lpar
54399>>>>>                End
54399>>>>>>
54399>>>>>
54399>>>>>// ----------------------------------------------------------------------------
54399>>>>>
54399>>>>>                //š.03:œ¤ž£â¨à©ž §œ›åà¤ first out (§¨é«¦ª §˜¨˜¢ã§«žª) «¦¬ baxio š ˜ æ¢˜ «˜ ˜¥ æš¨˜­˜
54399>>>>>                //     ¡˜  œ­'æ©¦¤ ›â¤ â®¦¬¤ ã›ž œ¤ž£œ¨àŸœå,
54399>>>>>                //     ›ž¢˜›ã §¨æ¡œ «˜  š ˜ «ž¤ §¨é«ž £œ«˜™å™˜©ž-œ¥˜šàšã
54399>>>>>                If (;                     (Baxio.Baxio_Code_Out = "" );                   );                Begin
54401>>>>>                      Move Btypkin.Btypkin_Anti2   to Baxio.Baxio_File_Out
54402>>>>>                      Move Barticl.Barticl_Code2   to Baxio.Baxio_Code_Out
54403>>>>>                      Move Barticl.Barticl_Epon2   to Baxio.Baxio_Epon_Out
54404>>>>>                      Move Barticl.Barticl_Recr    to Baxio.Baxio_Fpar_Out
54405>>>>>                End
54405>>>>>>
54405>>>>>
54405>>>>>                //š.04:œ¤ž£â¨à©ž §œ›åà¤ status + place «¦¬ baxio, ˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž (bkinkat)
54405>>>>>                Move Bkinkat.Baxio_Stat_To  to Baxio.Baxio_Status //¡˜«á©«˜©ž :˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž
54406>>>>>                Move Bkinkat.Baxio_Plac_To  to Baxio.Baxio_Place  //œ¬¨å¡œ«˜ :˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž
54407>>>>>
54407>>>>>//                //š.05:©«¦ ®œå˜ slave gplan rec0
54407>>>>>//                Case Begin
54407>>>>>//                     Case (Btypkin.Gtypkin_Code <> 0) //œá¤ ž ¡å¤ž©ž œ¤ž£œ¨é¤œ  ‚Š
54407>>>>>////jsjsjs 24/01/2001
54407>>>>>////                          Clear Gplan
54407>>>>>////                          Move Company.Company_Code    to Gplan.Company_Code
54407>>>>>////                          Move Branch.Branch_Code      to Gplan.Branch_Code
54407>>>>>////                          Move Year.Year_Year          to Gplan.Year_Year
54407>>>>>////                          Move Bkinkat.Bkinkat_GplnCod to Gplan.Gplan_Code
54407>>>>>////                          Find Eq Gplan by Index.1 //company_code+branch_code+year_year+Gplan_code
54407>>>>>////                          If (Found = 1) Move Gplan.Gplan_Rec0 to Bmove.Gplan_SRec0
54407>>>>>////                          Else           Send Operation_Not_Allowed 3001 //›â¤ ™¨âŸž¡œ «¦ slave gplan_rec0
54407>>>>>////jsjsjs 24/01/2001
54407>>>>>//                     Case Break //æ® , › æ«  £§¦¨œå ¤˜ œ¤ž£œ¨é¤œ ¡˜  á¢¢˜ modules
54407>>>>>
54407>>>>>//                     Case (Btypkin.Ctypkin_Code <> 0) //œá¤ ž ¡å¤ž©ž œ¤ž£œ¨é¤œ  §œ¢á«œª
54407>>>>>//                     Case Break
54407>>>>>
54407>>>>>//                     Case (Btypkin.Vtypkin_Code <> 0) //œá¤ ž ¡å¤ž©ž œ¤ž£œ¨é¤œ  §¨¦£žŸœ¬«âª
54407>>>>>//                     Case Break
54407>>>>>
54407>>>>>//                     Case Else                        //›â¤ œ¤ž£œ¨é¤œ«˜  ¡˜¤â¤˜ ˜§¦ «˜ 3 modules
54407>>>>>//                          Move 0 to Bmove.Gplan_SRec0
54407>>>>>//                Case End
54407>>>>>
54407>>>>>                //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
54407>>>>>                Send private.Adjust_Balances (1);                                             Baxio.Baxio_V2;                                             Baxio.Baxio_V0;                                             Baxio.Baxio_V00;                                             Baxio.Baxio_VR
54408>>>>>
54408>>>>>//                //œ) œ¤ž£â¨à©ž properties after (˜§æ parent buffers!)
54408>>>>>//                Set piA_Garticl_Rec0         to Barticl.Garticl_Rec0
54408>>>>>//                Set piA_Gtypkin_Rec0         to Btypkin.Gtypkin_Rec0
54408>>>>>//                Set pdA_Garticl_Hmnia        to Barticl.Barticl_Hmnia
54408>>>>>//                Set piA_Garticl_No           to Barticl.Barticl_No
54408>>>>>//                Set psA_Garticl_C_Code2      to Baxio.Baxio_C_Code2
54408>>>>>//                Set pnA_Garticl_Rate0        to Baxio.Baxio_Rate0
54408>>>>>//                Set pnA_Garticl_Rate00       to Baxio.Baxio_Rate00
54408>>>>>//                Set pnA_Garticl_RateR        to Baxio.Baxio_RateR
54408>>>>>//                Set psA_Garticl_Aitiol       to Barticl.Barticl_Aitiol
54408>>>>>
54408>>>>>//                Set piA_Gmove_Master_Rec0    to Barticl.Gmove_Mrec0
54408>>>>>//                Set piA_Gplan_Master_Rec0    to Barticl.Gplan_Mrec0
54408>>>>>
54408>>>>>                //â¢œš®¦ª §¨¦©ã£¦¬
54408>>>>>                //If ((Abs(Btypkin.Btypkin_Sign)) <> 1) Error 10000 "To Btypkin Sign œå¤˜  ¢áŸ¦ª !"
54408>>>>>
54408>>>>>                Case Begin
54408>>>>>                     Case (Btypkin.Btypkin_Anti_Xp = 1) //®¨âà©ž master, §å©«à©ž slave
54410>>>>>//                          Set pnA_Gmove_Master_X2 to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
54410>>>>>//                          Set pnA_Gmove_Master_P2 to 0
54410>>>>>//                          Set pnA_Gmove_Slave_X2  to 0
54410>>>>>//                          Set pnA_Gmove_Slave_P2  to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
54410>>>>>                     Case Break
54411>>>>>                     Case (Btypkin.Btypkin_Anti_Xp = 2) // §å©«à©ž master, ®¨âà©ž slave
54414>>>>>//                          Set pnA_Gmove_Master_X2 to 0
54414>>>>>//                          Set pnA_Gmove_Master_P2 to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
54414>>>>>//                          Set pnA_Gmove_Slave_X2  to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
54414>>>>>//                          Set pnA_Gmove_Slave_P2  to 0
54414>>>>>                     Case Break
54415>>>>>                     Case Else
54415>>>>>                          Error 10000 "To Btypkin XP œå¤˜  ¢áŸ¦ª!"
54416>>>>>>
54416>>>>>                Case End
54416>>>>>//                Set psA_Gmove_Master_Aitiol  to Barticl.Barticl_Aitiol
54416>>>>>
54416>>>>>//                Set piA_Gmove_Slave_Rec0     to (private.fiBsum_Gmove_Srec0(Self,;
54416>>>>>//                                                                            Barticl.Barticl_Rec0,;
54416>>>>>//                                                                            Baxiokat.Baxiokat_Rec0))
54416>>>>>//                Set piA_Gplan_Slave_Rec0     to Bmove.Gplan_Srec0
54416>>>>>//                Set psA_Gmove_Slave_Aitiol   to Barticl.Barticl_Aitiol
54416>>>>>
54416>>>>>                Set piUpdate to 1
54417>>>>>
54417>>>>>                //properties š ˜ «ž¤ procedural œ¤ž£â¨à©ž «¦¬ bsum
54417>>>>>                Set psA_Barticl_Recr         to Barticl.Barticl_Recr
54418>>>>>                Set psA_Baxiokat_Recr        to Baxiokat.Baxiokat_Recr
54419>>>>>                Set pnA_Baxio_V2             to Baxio.Baxio_V2
54420>>>>>                Set pnA_Baxio_V0             to Baxio.Baxio_V0
54421>>>>>                Set pnA_Baxio_V00            to Baxio.Baxio_V00
54422>>>>>                Set pnA_Baxio_VR             to Baxio.Baxio_VR
54423>>>>>
54423>>>>>//                //booleans §¦¬ ›ž¢é¤¦¬¤ «˜ operations §¦¬ Ÿ˜ šå¤¦¬¤ ©«ã¤ š¢
54423>>>>>//                If (Barticl.Garticl_Rec0 = 0);
54423>>>>>//                Begin //«¦ barticl ›â¤ â®œ  ©¬¤›œŸœå £œ master gmove
54423>>>>>//                     If (Barticl.Gmove_Mrec0 <> 0) Error 10000 "Master Gmove <> 0 !"
54423>>>>>//                     Set  piGarticl_Create         to  1
54423>>>>>//                     Set  piMaster_Gmove_Create    to  1
54423>>>>>//                End
54423>>>>>//                Set piGarticl_Edit      to  (Not(piGarticl_Create     (Self)))
54423>>>>>//                Set piMaster_Gmove_Edit to  (Not(piMaster_Gmove_Create(Self)))
54423>>>>>      End_Procedure   //update
54424>>>>>
54424>>>>>
54424>>>>>      Procedure Backout
54425>>>>>                Forward Send Backout
54427>>>>>
54427>>>>>                //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
54427>>>>>                Send private.Adjust_Balances (-1);                                             Baxio.Baxio_V2;                                             Baxio.Baxio_V0;                                             Baxio.Baxio_V00;                                             Baxio.Baxio_VR
54428>>>>>
54428>>>>>
54428>>>>>
54428>>>>>                //******************************
54428>>>>>                //prosoxi ! allagi sto bmove def gia na exo kai ayta ta pedia !!!
54428>>>>>                //******************************
54428>>>>>
54428>>>>>//                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
54428>>>>>//                Set piB_Garticl_Rec0         to Barticl.Garticl_Rec0
54428>>>>>//                Set piB_Gtypkin_Rec0         to Btypkin.Gtypkin_Rec0
54428>>>>>//                Set pdB_Garticl_Hmnia        to Bmove.Barticl_Hmnia     //sosososo
54428>>>>>//                Set piB_Garticl_No           to Bmove.Barticl_No        //sosososo
54428>>>>>//                Set psB_Garticl_C_Code2      to Baxio.Baxio_C_Code2
54428>>>>>//                Set pnB_Garticl_Rate0        to Baxio.Baxio_Rate0
54428>>>>>//                Set pnB_Garticl_Rate00       to Baxio.Baxio_Rate00
54428>>>>>//                Set pnB_Garticl_RateR        to Baxio.Baxio_RateR
54428>>>>>//                Set psB_Garticl_Aitiol       to Barticl.Barticl_Aitiol
54428>>>>>
54428>>>>>//                Set piB_Gmove_Master_Rec0    to Barticl.Gmove_Mrec0
54428>>>>>//                Set piB_Gplan_Master_Rec0    to Barticl.Gplan_Mrec0
54428>>>>>
54428>>>>>                //â¢œš®¦ª §¨¦©ã£¦¬
54428>>>>>                //If ((Abs(Btypkin.Btypkin_Sign)) <> 1) Error 10000 "To Btypkin Sign œå¤˜  ¢áŸ¦ª !"
54428>>>>>
54428>>>>>                Case Begin
54428>>>>>                     Case (Btypkin.Btypkin_Anti_Xp = 1) //®¨âà©ž master, §å©«à©ž slave
54430>>>>>//                          Set pnB_Gmove_Master_X2 to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
54430>>>>>//                          Set pnB_Gmove_Master_P2 to 0
54430>>>>>//                          Set pnB_Gmove_Slave_X2  to 0
54430>>>>>//                          Set pnB_Gmove_Slave_P2  to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
54430>>>>>                     Case Break
54431>>>>>                     Case (Btypkin.Btypkin_Anti_Xp = 2) // §å©«à©ž master, ®¨âà©ž slave
54434>>>>>//                          Set pnB_Gmove_Master_X2 to 0
54434>>>>>//                          Set pnB_Gmove_Master_P2 to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
54434>>>>>//                          Set pnB_Gmove_Slave_X2  to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
54434>>>>>//                          Set pnB_Gmove_Slave_P2  to 0
54434>>>>>                     Case Break
54435>>>>>                     Case Else
54435>>>>>                          Error 10000 "To Btypkin XP œå¤˜  ¢áŸ¦ª!"
54436>>>>>>
54436>>>>>                Case End
54436>>>>>//                Set psB_Gmove_Master_Aitiol  to Barticl.Barticl_Aitiol
54436>>>>>
54436>>>>>//                Set piB_Gmove_Slave_Rec0     to (private.fiBsum_Gmove_Srec0(Self,;
54436>>>>>//                                                                            Barticl.Barticl_Rec0,;
54436>>>>>//                                                                            Baxiokat.Baxiokat_Rec0))
54436>>>>>
54436>>>>>//                Set piB_Gplan_Slave_Rec0     to Bmove.Gplan_Srec0
54436>>>>>//                Set psB_Gmove_Slave_Aitiol   to Barticl.Barticl_Aitiol
54436>>>>>
54436>>>>>                Set piBackout to 1
54437>>>>>
54437>>>>>                //properties š ˜ «ž¤ procedural œ¤ž£â¨à©ž «¦¬ bsum
54437>>>>>                Set psB_Barticl_Recr         to Barticl.Barticl_Recr
54438>>>>>                Set psB_Baxiokat_Recr        to Baxiokat.Baxiokat_Recr
54439>>>>>                Set pnB_Baxio_V2             to Baxio.Baxio_V2
54440>>>>>                Set pnB_Baxio_V0             to Baxio.Baxio_V0
54441>>>>>                Set pnB_Baxio_V00            to Baxio.Baxio_V00
54442>>>>>                Set pnB_Baxio_VR             to Baxio.Baxio_VR
54443>>>>>                if (btypkin.btypkin_code=104) move 0 to baxio.baxio_rater
54446>>>>>
54446>>>>>//                //booleans §¦¬ ›ž¢é¤¦¬¤ «¦ operation §¦¬ Ÿ˜ šå¤œ  ©«ã¤ š¢
54446>>>>>//                Case Begin
54446>>>>>//                     Case  (Barticl.Barticl_Lines = 0) //œá¤ › ˜š¨á­à «ž¤ «œ¢œ¬«˜å˜ š¨˜££ã «¦¬ barticl, «æ«œ Ÿ˜ › ˜š¨á¯à ¡˜  «¦ garticl
54446>>>>>//                           Set  piGarticl_Delete         to  1
54446>>>>>//                           Set  piMaster_Gmove_Delete    to  1
54446>>>>>//                     Case Break
54446>>>>>//                     Case  (Barticl.Barticl_Lines > 0) //˜¢¢¦ éª Ÿ˜ ¡á¤à edit ©«¦ garticl
54446>>>>>//                           Set  piGarticl_Edit           to  1
54446>>>>>//                           Set  piMaster_Gmove_Edit      to  1
54446>>>>>//                     Case Break
54446>>>>>//                     Case  (Barticl.Barticl_Lines < 0) //§¨æ™¢ž£˜, ¡á«  «¨â®œ 
54446>>>>>//                           Send Operation_Not_Allowed 9999 //«¨â¥«œ ¦¢ ¡á â¢œš®¦ ™á©žª
54446>>>>>//                     Case Break
54446>>>>>//                Case End
54446>>>>>
54446>>>>>/////////////////////Case (Barticl.Garticl_Rec0 = 0) //«¦ barticl ›â¤ â®œ  ©¬¤›œŸœå £œ master gmove
54446>>>>>/////////////////////     //If (Barticl.Gmove_Mrec0 <> 0) Error 1000 " djfdfsdds"
54446>>>>>/////////////////////Case Break
54446>>>>>      End_Procedure   // backout
54447>>>>>
54447>>>>>
54447>>>>>      Procedure Creating
54448>>>>>                Integer liBaxio_Status_From liBaxio_Status_To
54449>>>>>
54449>>>>>                Forward Send Creating
54451>>>>>
54451>>>>>            Move (Append('',((Trim(SysCurXR.Branch_Site))+;                             (Trim(String(Bmove.Bmove_Rec0)))))) to Bmove.Bmove_Recr
54452>>>>>
54452>>>>>
54452>>>>>                //˜¨ Ÿ£æª ¡ ¤ã©œà¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
54452>>>>>                //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBmove
54452>>>>>
54452>>>>>                //˜¨ Ÿ£æª š¨˜££é¤ barticl
54452>>>>>                Add 1 to Barticl.Barticl_Lines
54453>>>>>
54453>>>>>                //˜/˜ š¨˜££ãª á¨Ÿ¨¦¬
54453>>>>>                Add 1 to Barticl.Barticl_BmoveLa
54454>>>>>                Move Barticl.Barticl_BmoveLa to Bmove.Bmove_AA
54455>>>>>
54455>>>>>                //˜/˜ ¡å¤ž©žª ˜¥ ¦š¨á­¦¬
54455>>>>>                Add 1 to Baxio.Baxio_Bmove_Laa
54456>>>>>                Move Baxio.Baxio_Bmove_Laa to Bmove.Baxio_AA
54457>>>>>
54457>>>>>                //pourqua ??????
54457>>>>>                Get piBaxio_Status_From to liBaxio_Status_From
54458>>>>>                Get piBaxio_Status_To   to liBaxio_Status_To
54459>>>>>                //Set biBaxio_Status of liBaxio_dd to liBaxio_Status_From
54459>>>>>      End_Procedure //creating
54460>>>>>
54460>>>>>
54460>>>>>      Procedure Deleting
54461>>>>>                Integer liTemp
54462>>>>>
54462>>>>>                //œá¤ › ˜š¨á­à «ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬,
54462>>>>>                //æ¢˜ œå¤˜  ok, œå«œ «¦ ¡á¤à ˜§¦ «¦ bmove, œå«œ ˜§¦ «¦ barticl,
54462>>>>>                //œå«œ «œ¢ ¡á ˜§æ ¦§¦¬›ã§¦«œ !
54462>>>>>                //œá¤ æ£àª ›â¤ › ˜š¨á­à «ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬, ˜¢¢á ¡á§¦ ˜ á¢¢ž,
54462>>>>>                //§¨â§œ  ¤˜ › ˜¡æ¯à «¦ transaction, ˜¤˜¥á¨«ž«˜ ˜§¦ §¦ç «¦ â®à ¡˜¢â©œ .
54462>>>>>                //˜¬«æ ™â™˜ ˜ œ¢âš®œ«˜  ¡˜  ©«ž¤ validate delete, ˜¢¢á ¦¬© ˜©« ¡á §¨â§œ 
54462>>>>>                //¤˜ œ¢œšŸœå œ›é, › æ«  ž › ˜š¨˜­ã £§¦¨œå ¤˜ ¥œ¡ ¤ã©œ  ˜§æ cascade delete
54462>>>>>                //«¦¬ barticl.
54462>>>>>                //£œ á¢¢˜ ¢æš ˜ œ¤œ¨š¦§¦ é «ž¤ validate delete æ«˜¤ ž › ˜š¨˜­ã
54462>>>>>                //›â¤ ¥œ¡ ¤áœ  ˜§¦ «¦ bmove !
54462>>>>>                If (OPERATION_ORIGIN <> (Self));                Begin
54464>>>>>                     Get Validate_Delete to liTemp
54465>>>>>                     If (liTemp <> 0) Send Operation_Not_Allowed liTemp //á®¨ž©«¦
54468>>>>>                End
54468>>>>>>
54468>>>>>
54468>>>>>                Forward Send Deleting
54470>>>>>
54470>>>>>                //§¨é«˜ œ¤«¦§åà bkinkat
54470>>>>>                Move (private.fiBkinkat_Baxiokat_Code(Self,;                                    Btypkin.Btypkin_Recr,;                                    Baxiokat.Baxiokat_Code);                     ) to liTemp
54471>>>>>                If (liTemp = 0) Send Operation_Not_Allowed 4002 //›â¤ œ§ «¨â§œ«˜  ž ¡å¤ž©ž baxiokat_code £œ «¦ btypkin
54474>>>>>
54474>>>>>
54474>>>>>                //***********************************************************
54474>>>>>                //*    ˜§æ œ›é ¡˜  ¡á«à, â®à §¢â¦¤ active bkinkat record    *
54474>>>>>                //***********************************************************
54474>>>>>
54474>>>>>                //˜¨ Ÿ£æª ¡ ¤ã©œà¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
54474>>>>>                //jsjsjs 24/01/2001 Sub 1 from Year.Year_NumBmove
54474>>>>>
54474>>>>>                //˜¨ Ÿ£æª š¨˜££é¤ barticl
54474>>>>>                Sub 1 from Barticl.Barticl_Lines
54475>>>>>
54475>>>>>                //˜/˜ š¨˜££ãª á¨Ÿ¨¦¬
54475>>>>>                If (Bmove.Bmove_AA = Barticl.Barticl_BmoveLa);                Sub 1 from Barticl.Barticl_BmoveLa
54478>>>>>
54478>>>>>                //˜/˜ ¡å¤ž©žª ˜¥ ¦š¨á­¦¬
54478>>>>>                If (Bmove.Baxio_AA = Baxio.Baxio_Bmove_Laa);                Sub 1 from Baxio.Baxio_Bmove_Laa
54481>>>>>
54481>>>>>                //š.03:œ¤ž£â¨à©ž §œ›åà¤ status + place, ˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž (bkinkat)
54481>>>>>                //     ›ž¢˜›ã œ§˜¤˜­â¨à «¦ status ¡˜  «¦ place ˜§¦ œ¡â  §¦¬ «˜ §ã¨˜.
54481>>>>>                //     ™œ™˜åàª, › ˜š¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬
54481>>>>>                Move Bkinkat.Baxio_Stat_From to Baxio.Baxio_Status //¡˜«á©«˜ž :˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž
54482>>>>>                Move Bkinkat.Baxio_Plac_From to Baxio.Baxio_Place  //œ¬¨å¡œ«˜ :˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž
54483>>>>>
54483>>>>>                //œ›é Ÿ˜ §¨â§œ  ¤˜ ™á¢à ¡˜  «¦¤ §¨¦žš¦ç£œ¤¦ ˜§¦›â¡«ž ! ! ! !
54483>>>>>                //     ž œ¤ž£â¨à©ž §œ›åà¤ previous «¦¬ bmove š ˜ æ¢˜ «˜ ˜¥ æš¨˜­˜
54483>>>>>                //     âš ¤œ ©«ž¤ update §¨¦«¦ç ˜¢¢á¥à «˜ last §œ›å˜ «¦¬ baxio,
54483>>>>>                //     «˜ ¡¨˜«áà ©«˜
54483>>>>>                //     previous §œ›å˜ «¦¬ bmove,
54483>>>>>                //     â«©  é©«œ ©«ž¤ deleteig ¤˜ «˜ œ§˜¤˜­â¨à ©«¦ baxio
54483>>>>>                Move Bmove.Baxio_Pfile to Baxio.Baxio_Lfile
54484>>>>>                Move Bmove.Baxio_Pcode to Baxio.Baxio_Lcode
54485>>>>>                Move Bmove.Baxio_Pepon to Baxio.Baxio_Lepon
54486>>>>>                Move Bmove.Baxio_Ppar  to Baxio.Baxio_Lpar
54487>>>>>
54487>>>>>                // js 05/09/2002
54487>>>>>                Saverecord Barticl
54488>>>>>                Saverecord Baxio
54489>>>>>
54489>>>>>      End_Procedure //deleting
54490>>>>>
54490>>>>>
54490>>>>>      Procedure Save_Main_File
54491>>>>>                Forward Send Save_Main_File
54493>>>>>                Send private.Trexe //procedural › ˜®œå¨ ©ž bsums
54494>>>>>      End_Procedure//save_main_file
54495>>>>>
54495>>>>>
54495>>>>>      Procedure Delete_Main_File
54496>>>>>                Integer liTemp
54497>>>>>
54497>>>>>                Forward Send Delete_Main_File
54499>>>>>                Send private.Trexe //procedural › ˜®œå¨ ©ž bsums
54500>>>>>
54500>>>>>                //œá¤ › ˜š¨á­à «ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬, «æ«œ Ÿ˜ › ˜š¨á¯à ¡˜  ˜¬«æ
54500>>>>>                //¦¬© ˜©« ¡á ˜§æ œ›é ¡˜  £æ¤¦¤ ˜§¦ œ›é šå¤œ«˜  ž › ˜š¨˜­ã ˜¥ ¦š¨á­¦¬,
54500>>>>>                //œå¤˜  ¢¦ §æ¤ ž deleteing «¦¬ baxio !
54500>>>>>                If (Baxio.Baxio_Bmove_Laa = 0);                Begin
54502>>>>>
54502>>>>>                     //˜¨ Ÿ£æª ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
54502>>>>>                     //jsjsjs 26/01/2001
54502>>>>>                     //Sub 1 from Year.Year_NumBaxio
54502>>>>>
54502>>>>>                     //«œ¢œ¬«˜å˜ª ¡à› ¡æª ˜¨ Ÿ£æª ˜¥ ¦š¨á­¦¬
54502>>>>>                     If (Baxiokat.Baxio_Lcode = Baxio.Baxio_Code);                     Sub 1 from Baxiokat.Baxio_Lcode
54505>>>>>
54505>>>>>                     Delete Baxio
54506>>>>>                End
54506>>>>>>
54506>>>>>      End_Procedure //delete_main_file
54507>>>>>
54507>>>>>
54507>>>>>      Procedure Operation_Not_Allowed Integer iError_Num
54508>>>>>                String lsError_Message
54509>>>>>                Case Begin
54509>>>>>                     //˜§æ validate save
54509>>>>>                     Case (iError_Num = 5555)
54511>>>>>                          Move ("† ˜§¦Ÿã¡œ¬©ž ˜¡¬¨éŸž¡œ ˜§¦ «¦¤ ®¨ã©«ž");                          to lsError_Message
54512>>>>>                     Case Break
54513>>>>>                     Case (iError_Num = 1001)
54516>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n† «¨¦§¦§¦åž©ž œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");                          to lsError_Message
54517>>>>>                     Case Break
54518>>>>>                     Case (iError_Num = 1004)
54521>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n† ¡å¤ž©ž œ§ «¨â§œ«˜  £æ¤¦¤ £œ ¤â˜ ˜¥ æš¨˜­¦ !");                          to lsError_Message
54522>>>>>                     Case Break
54523>>>>>                     Case (iError_Num = 1005)
54526>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n† ¡å¤ž©ž œ§ «¨â§œ«˜  £æ¤¦¤ ©œ ¬§á¨®¦¤ ˜¥ æš¨˜­¦ !");                          to lsError_Message
54527>>>>>                     Case Break
54528>>>>>                     Case (iError_Num = 1006)
54531>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n’¦ barticl â®œ  «¨¦§¦§¦ žŸœå!");                          to lsError_Message
54532>>>>>                     Case Break
54533>>>>>                     Case (iError_Num = 1100)
54536>>>>>                          Move "DDC 44:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
54537>>>>>                     Case Break
54538>>>>>
54538>>>>>                     //˜§æ validate delete
54538>>>>>                     Case (iError_Num = 2001)
54541>>>>>                          Move ("DDC 44:€›ç¤˜«ž ž › ˜š¨˜­ã !\n\n† › ˜š¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");                          to lsError_Message
54542>>>>>                     Case Break
54543>>>>>                     Case (iError_Num = 2100)
54546>>>>>                          Move "DDC 44:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
54547>>>>>                     Case Break
54548>>>>>
54548>>>>>                     //˜§æ update
54548>>>>>                     Case (iError_Num = 3001)
54551>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\nƒâ¤ œ§ «¨â§œ«˜  ž ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬ !");                          to lsError_Message
54552>>>>>                     Case Break
54553>>>>>                     Case (iError_Num = 3002)
54556>>>>>                          Move ("DDC 44:‹ã €§¦›œ¡«æª «ç§¦ª €¥ ¦š¨á­¦¬ š ˜ «ž¤ ‰å¤ž©ž !\n\n‹œ "+(Trim(Btypkin.Btypkin_Descr))+;                          " ›â¤ ¡ ¤¦ç¤«˜  " + (Trim(Baxiokat.Baxiokat_Descr)));                          to lsError_Message
54557>>>>>                     Case Break
54558>>>>>
54558>>>>>                     //˜§æ deleting
54558>>>>>                     Case (iError_Num = 4002)
54561>>>>>                          Move ("DDC 44:‹ã €§¦›œ¡«æª «ç§¦ª €¥ ¦š¨á­¦¬ š ˜ «ž¤ ƒ ˜š¨˜­ã !\n\n‹œ "+(Trim(Btypkin.Btypkin_Descr))+;                          " ›â¤ ¡ ¤¦ç¤«˜  " + (Trim(Baxiokat.Baxiokat_Descr)));                          to lsError_Message
54562>>>>>                     Case Break
54563>>>>>
54563>>>>>                     //˜§æ private.Transaction_Update_Other_Modules
54563>>>>>                     Case (iError_Num = 5001) //›â¤ £§æ¨œ©˜ ¤˜ ¥˜¤˜™¨é barticl by recnum!
54566>>>>>                          Move ("DDC 44:Transaction Aborted! (Barticl Recnum Not Found)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
54567>>>>>                     Case Break
54568>>>>>                     Case (iError_Num = 5002) //›â¤ £§æ¨œ©˜ ¤˜ ¥˜¤˜™¨é bsum by recnum!
54571>>>>>                          Move ("DDC 44:Transaction Aborted! (Bsum Recnum Not Found)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
54572>>>>>                     Case Break
54573>>>>>                     Case (iError_Num = 5003) //«¦ create master âš ¤œ ©œ ã›ž ©¬¤›œ›œ£â¤¦ barticl
54576>>>>>                          Move ("DDC 44:Transaction Aborted! (Create Master on Connected B Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
54577>>>>>                     Case Break
54578>>>>>                     Case (iError_Num = 5004) //«¦ create master âš ¤œ ©œ £ã Ÿœ« ¡á gl records
54581>>>>>                          Move ("DDC 44:Transaction Aborted! (Create Master on Non Positive GL Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
54582>>>>>                     Case Break
54583>>>>>                     Case (iError_Num = 5005) //«¦ edit master âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤˜ barticl records
54586>>>>>                          Move ("DDC 44:Transaction Aborted! (Edit Master on Non Connected B Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
54587>>>>>                     Case Break
54588>>>>>                     Case (iError_Num = 5006) //«¦ edit master ›â¤ âš ¤œ ©«˜ å› ˜ master records
54591>>>>>                          Move ("DDC 44:Transaction Aborted! (Edit Master not on Same Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
54592>>>>>                     Case Break
54593>>>>>                     Case (iError_Num = 5007) //«¦ create slave âš ¤œ ©œ œå¤˜  ã›ž ©¬¤›œ›œ£â¤¦ bsum
54596>>>>>                          Move ("DDC 44:Transaction Aborted! (Create Slave on Connected B Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
54597>>>>>                     Case Break
54598>>>>>                     Case (iError_Num = 5008) //«¦ create slave âš ¤œ ©œ £ã Ÿœ« ¡æ gl record
54601>>>>>                          Move ("DDC 44:Transaction Aborted! (Create Slave on Non Positive GL Record)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
54602>>>>>                     Case Break
54603>>>>>                     Case (iError_Num = 5009) //«¦ edit slave âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤¦ record
54606>>>>>                          Move ("DDC 44:Transaction Aborted! (Edit Slave on Non Connected B Record)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
54607>>>>>                     Case Break
54608>>>>>                     Case (iError_Num = 5010) //«¦ edit slave ›â¤ âš ¤œ ©«¦ å› ¦ slave record
54611>>>>>                          Move ("DDC 44:Transaction Aborted! (Edit Slave not on Same Record)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
54612>>>>>                     Case Break
54613>>>>>                     Case (iError_Num = 5011) //«¦ delete master âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤˜ records
54616>>>>>                          Move ("DDC 44:Transaction Aborted! (Delete Master on Non Connected B Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
54617>>>>>                     Case Break
54618>>>>>                     Case (iError_Num = 5012) //«¦ delete master ›â¤ â›à©œ £ž›œ¤ ¡á master records «žª š¢
54621>>>>>                          Move ("DDC 44:Transaction Aborted! (Delete Master not with 0 GL Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
54622>>>>>                     Case Break
54623>>>>>
54623>>>>>                     //˜§æ private.trexe (save+delete main file)
54623>>>>>                     Case (iError_Num = 6001) //¢áŸ¦ª «¦¬ ¡é› ¡˜
54626>>>>>                          Move ("DDC 44:Transaction Aborted! (€¡˜«á¢¢ž¢¦ §¨æ©ž£¦)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «ž¢œ­à¤ã©«œ ©«ž¤ Solution!") to lsError_Message
54627>>>>>                     Case Break
54628>>>>>                     Case (iError_Num = 6002) //¢áŸ¦ª «¦¬ ¡é› ¡˜
54631>>>>>                          Move ("DDC 44:Transaction Aborted! (update=0 + backout=0)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «ž¢œ­à¤ã©«œ ©«ž¤ Solution!") to lsError_Message
54632>>>>>                     Case Break
54633>>>>>
54633>>>>>                     Case Else
54633>>>>>                          Forward Send Operation_Not_Allowed iError_Num
54635>>>>>                Case End
54635>>>>>
54635>>>>>                Error iError_Num lsError_Message
54636>>>>>>
54636>>>>>      End_Procedure // operation_not_allowed
54637>>>>>
54637>>>>>
54637>>>>>
54637>>>>>
54637>>>>>     //1001:Baxio_AA = baxio_bmove_laa (editing £æ¤¦¤ ©«¦¤ «œ¢œ¬«˜å¦ ˜˜ ¡å¤ž©žª «¦¬ ˜¥ ¦š¨á­¦¬)
54637>>>>>     //1002:create a new bmove £æ¤¦¤ œá¤ «¦ baxio_status <> œ¥¦­¢ž£â¤¦
54637>>>>>     //1003:˜§˜š¦¨œçœ«˜  «¦ bmove ¤˜ ˜¢¢áœ  parent barticl
54637>>>>>     //1004:˜§˜š¦¨œçœ«˜  «¦ bmove ¤˜ ˜¢¢áœ  parent baxiokat
54637>>>>>     //1005:œá¤ ž ¡å¤ž©ž ž«áœ  ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬
54637>>>>>     //     ¡˜  ¡á¤à create bmove, §¨â§œ  ¤˜ â®à ¡á¤œ  ¡˜  create baxio
54637>>>>>     //1006:›â¤ œ§ «¨â§œ«˜  save ©«¦ bmove, œá¤ «¦ barticl â®œ  šå¤œ  edit
54637>>>>>     //     ¡˜  ›â¤ â®œ  «¨â¥œ  ž request_save
54637>>>>>     //1007
54637>>>>>     //1008
54637>>>>>     //?1009:m_code:ž œšš¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ˜§¦ ¦ module §¦¬ «ž¤ ›ž£ ¦ç¨šž©œ
54637>>>>>      Function Validate_Save Returns Integer
54638>>>>>               Integer iReturnVal liBarticl_dd_Changed isNO
54639>>>>>
54639>>>>>               Forward Get Validate_Save to iReturnVal
54641>>>>>
54641>>>>>               If (Not(iReturnVal));               Begin
54643>>>>>
54643>>>>>//                If (Baxio.Baxio_HmniaL<Barticl.Barticl_Hmnia) Begin
54643>>>>>//                    Get YesNo_Box '† ž£œ¨¦£ž¤å˜ «žª œ§ «˜šãª œå¤˜ \n§¨¦šœ¤â©«œ¨ž «žª ž£œ¨¦£ž¤å˜ª «¦¬ §˜¨˜©«˜« ¡¦ç.\nŒ˜ ©¬¤œ®å©à ?' to isNO
54643>>>>>//                    If (isNO=MBR_NO) Send Operation_Not_Allowed 5555
54643>>>>>//                End
54643>>>>>
54643>>>>>                //---------â¢œš®¦  ›ž£ ¦¬¨šå˜ª ¤â¦¬ bmove record----------------------
54643>>>>>                If (Bmove.Recnum =  0);                Begin //œá¤ ›ž£ ¦¬¨šé ¤â¦ bmove record
54645>>>>>                      //1005:š ˜ ¤˜ ›œ®Ÿé «ž¤ ›ž£ ¦¬¨šå˜ ¤â¦¬ baxio record, §¨â§œ :
54645>>>>>                      //     1.œá¤ ž ¡å¤ž©ž ž«áœ  «ž¤ ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬,
54645>>>>>                      //       «æ«œ §¨â§œ  ¤˜ â®à æ¤«àª ¡á¤œ  ¡˜  create baxio.
54645>>>>>                      //     2.œá¤ ž ¡å¤ž©ž ›â¤ ž«áœ  «ž¤ ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬,
54645>>>>>                      //       «æ«œ ›â¤ §¨â§œ  ¤˜ â®à ¡á¤œ  ¡˜  create baxio.
54645>>>>>                      If ((piCan_Create_Baxio(Self)) = TRUE);                      Begin
54647>>>>>                      If (Not(;                              ((piCreated_Baxio(piBaxio_dd(Self))) = TRUE);                         )) Send Operation_Not_Allowed 1004 //ž ¡å¤ž©ž œ§ «¨â§œ«˜  £æ¤¦¤ £œ ¤â˜ ˜¥ æ§š¨˜­¦
54650>>>>>                      End
54650>>>>>>
54650>>>>>                      Else;                      Begin
54651>>>>>                      If (Not(;                              ((piCreated_Baxio(piBaxio_dd(Self))) = FALSE);                         )) Send Operation_Not_Allowed 1005 //ž ¡å¤ž©ž œ§ «¨â§œ«˜  £æ¤¦¤ ©œ ¬§á¨®¦¤ ˜¥ æ§š¨˜­¦
54654>>>>>                      End
54654>>>>>>
54654>>>>>
54654>>>>>                      //1002:create a new bmove £æ¤¦¤ œá¤ «¦ baxio_status <> œ¥¦­¢ž£â¤¦
54654>>>>>                      //If (Not(;
54654>>>>>                      //        (Baxio.Baxio_Old_Status <> 2);
54654>>>>>                      //   )) Send Operation_Not_Allowed 1002
54654>>>>>                End   //«â¢¦ª œ¢âš®à¤ ›ž£ ¦¬¨šå˜ª ¤â¦¬ bmove record
54654>>>>>>
54654>>>>>
54654>>>>>
54654>>>>>                //---------â¢œš®¦  editing existing bmove records---------------------
54654>>>>>                Else;                Begin //edit an existing record
54655>>>>>                      //1001:Baxio_AA = baxio_bmove_laa (editing £æ¤¦¤ ©«¦¤ «œ¢œ¬«˜å¦ ˜˜ ¡å¤ž©žª «¦¬ ˜¥ ¦š¨á­¦¬)
54655>>>>>                      If (Not(;                              (Baxio.Baxio_Bmove_Laa = Bmove.Baxio_AA);                         )) Send Operation_Not_Allowed 1001
54658>>>>>                End   //«â¢¦ª œ¢âš®à¤ editing existing bmove records
54658>>>>>>
54658>>>>>
54658>>>>>/////////////// js 07/08/2001  07-08-2001
54658>>>>>             // Ž ¡à› ¡˜ª ˜¬«¦ª £§ž¡œ remarks š ˜«  ž ¢¦š ¡ž £˜ª £œ©à «¦¬ ˜¤¦ ¥œ / ¡¢œ ©œ
54658>>>>>             // ¡˜  «¦ ©«ž© £¦ «žª œ­˜¨£¦šžª œ ¤˜  «œ«¦ ˜ §¦¬ ›œ¤ š ¤œ«˜  ˜¢¢ à©ž
54658>>>>>             // ˜§¦ ˜¢¢¦ ©ž£œ ¦ ©«¦ Barticl, ¡˜  œ§ §¢œ¦¤ ™˜¨˜œ  ¦«˜¤ ˜¤¦ š¦¡¢œ ¤œ 
54658>>>>>             // «¦ §˜¨˜©«˜« ¡¦ (§¨¦­˜¤àª š ˜«  £ž›œ¤ ¦¬¤ «˜ properties §¨¦ ¡˜  £œ«˜
54658>>>>>             // ˜§¦ «ž¤ private.Initialize_Properties
54658>>>>>//                //1006:›â¤ œ§ «¨â§œ«˜  save ©«¦ bmove, œá¤ «¦ barticl â®œ  šå¤œ  edit
54658>>>>>//                //     ¡˜  ›â¤ â®œ  «¨â¥œ  ž request_save
54658>>>>>//                Get Changed_State of (piBarticl_dd(Self)) to liBarticl_dd_Changed
54658>>>>>//                If (liBarticl_dd_Changed = TRUE) Send Operation_Not_Allowed 1006
54658>>>>>/////////////// js 07/08/2001  07-08-2001
54658>>>>>
54658>>>>>
54658>>>>>
54658>>>>>
54658>>>>>                //1100:cby = globals
54658>>>>>                If ( ;                    (Not(Bmove.Company_Code = SysCurXr.Company_Code)) or;                    (Not(Bmove.Branch_Code  = SysCurXr.Branch_Code )) or;                    (Not(Bmove.Year_Year    = SysCurXr.Year_Year   ));                    )                                                   Send Operation_Not_Allowed 1100
54661>>>>>
54661>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
54661>>>>>>
54661>>>>>               Function_Return iReturnVal
54662>>>>>      End_Function //validate_save
54663>>>>>
54663>>>>>
54663>>>>>      //2001:Baxio_AA = baxio_bmove_laa (delete £æ¤¦¤ «¦¤ «œ¢œ¬«˜å¦ ˜˜ ¡å¤ž©žª «¦¬ ˜¥ ¦š¨á­¦¬)
54663>>>>>      Function Validate_Delete  Returns Integer
54664>>>>>               Integer iReturnVal
54665>>>>>               Forward Get Validate_Delete  To iReturnVal
54667>>>>>               If (Not(iReturnVal));               Begin
54669>>>>>
54669>>>>>                //2001:â¢œš®¦ª «œ¢œ¬«˜å¦¬ ˜˜ ¡å¤ž©žª ˜¥ ¦š¨á­¦¬
54669>>>>>                If (Not(Bmove.Baxio_AA = Baxio.Baxio_Bmove_Laa))       Send Operation_Not_Allowed 2001
54672>>>>>                If ( ;                    (Not(Bmove.Company_Code = SysCurXr.Company_Code)) or;                    (Not(Bmove.Branch_Code  = SysCurXr.Branch_Code )) or;                    (Not(Bmove.Year_Year    = SysCurXr.Year_Year   ));                    )                                                   Send Operation_Not_Allowed 2100
54675>>>>>
54675>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
54675>>>>>>
54675>>>>>               Function_Return iReturnVal
54676>>>>>      End_Function //validate_delete
54677>>>>>
54677>>>>>
54677>>>>>      Procedure Request_Save
54678>>>>>                Integer liBaxiokat_Code liBaxio_Allow_Foreign_New_Save_State iErrorObj
54679>>>>>                String  lsBtypkin_Recr
54679>>>>>                //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties §¦¬ ˜­¦¨¦ç¤ «¦ transaction
54679>>>>>                Send private.Initialize_Properties
54680>>>>>                //˜¤áš¤à©ž «¨â®¦¬©˜ª ¡˜«á©«˜©žª «¦¬ baxio_dd
54680>>>>>                Get Allow_Foreign_New_Save_State of (piBaxio_dd(Self)) to liBaxio_Allow_Foreign_New_Save_State
54681>>>>>
54681>>>>>                //«¦ bkinkat_yn_new ¨¬Ÿ£åœ  œá¤ Ÿ˜ ¡á¤à œ ©˜šàšã ¤â¦¬ ˜¥ ¦š¨á­¦¬
54681>>>>>                Get File_Field_Current_Value File_Field Btypkin.Btypkin_Recr   to lsBtypkin_Recr
54682>>>>>                Get File_Field_Current_Value File_Field Baxiokat.Baxiokat_Code to liBaxiokat_Code
54683>>>>>
54683>>>>>                Clear Bkinkat
54684>>>>>                Move SysCurXr.Company_Code   to Bkinkat.Company_Code
54685>>>>>                Move SysCurXr.Branch_Code    to Bkinkat.Branch_Code
54686>>>>>                Move SysCurXr.Year_Year      to Bkinkat.Year_Year
54687>>>>>                Move lsBtypkin_Recr  to Bkinkat.Btypkin_Recr
54688>>>>>                Move liBaxiokat_Code to Bkinkat.Baxiokat_Code
54689>>>>>                Find Eq Bkinkat by Index.3 //company+branch+Year+btypkin_recr+baxiokat_code
54690>>>>>>
54690>>>>>                If (Found = 0) Begin //›â¤ œ§ «¨â§œ«˜  ž ¡å¤ž©ž baxiokat_code £œ «¦ btypkin
54692>>>>>                                Send Operation_Not_Allowed 3002
54693>>>>>                               End
54693>>>>>>
54693>>>>>
54693>>>>>                If (Bkinkat.Bkinkat_YN_New  = TRUE);                     Begin //œ ©˜šàšã ¤â¦¬ ˜¥ ¦š¨á­¦¬, á¨˜ œ§ «¨â§à «¦ create ©«¦ baxio
54695>>>>>                      Set Allow_Foreign_New_Save_State of (piBaxio_dd(Self)) to TRUE
54696>>>>>                      Set piCan_Create_Baxio                                 to TRUE
54697>>>>>                     End
54697>>>>>>
54697>>>>>                Else Begin //› ˜¡å¤ž©ž ¬§á¨®¦¤«¦ª ˜¥ ¦š¨á­¦¬, á¨˜ ›â¤ œ§ «¨â§à «¦ create ©«¦ baxio
54698>>>>>                      Set Allow_Foreign_New_Save_State of (piBaxio_dd(Self)) to FALSE
54699>>>>>                      Set piCan_Create_Baxio                                 to FALSE
54700>>>>>                     End
54700>>>>>>
54700>>>>>
54700>>>>>                Forward Send Request_Save
54702>>>>>
54702>>>>>                //œ§˜¤˜¤˜­¦¨á ˜¨® ¡ãª ¡˜«á©«˜©žª «¦¬ baxio_dd
54702>>>>>                Set Allow_Foreign_New_Save_State of (piBaxio_dd(Self)) to liBaxio_Allow_Foreign_New_Save_State
54703>>>>>                Set Smart_Filemode_State to True
54704>>>>>                //£ž›œ¤ ©£æª properties š ˜ œ§æ£œ¤ž ¡å¤ž©ž
54704>>>>>                Send private.Initialize_Properties
54705>>>>>                //œ§˜¤˜­¦¨á «¦¬ system indicator err
54705>>>>>                Indicate Err False
54706>>>>>      End_Procedure //request_save
54707>>>>>
54707>>>>>
54707>>>>>      Procedure Request_Delete
54708>>>>>                Integer iErrorObj
54709>>>>>                Send private.Initialize_Properties //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties
54710>>>>>                Forward Send Request_Delete
54712>>>>>                Send private.Initialize_Properties //£ž›œ¤ ©£æª properties š ˜ œ§æ£œ¤ž ¡å¤ž©ž
54713>>>>>                //œ§˜¤˜­¦¨á «¦¬ system indicator err
54713>>>>>                Indicate Err False
54714>>>>>      End_Procedure   //request_delete
54715>>>>>
54715>>>>>
54715>>>>>//      //ž ¨¦¬«å¤˜ ˜¬«ã ˜¤˜¢˜£™á¤œ  ¤˜ œ¤ž£œ¨é©œ  æ©˜ ˜§¦ «˜ ¬§æ¢¦ §˜ 3 modules «¦¬ ©¬©«ã£˜«¦ª
54715>>>>>//      //§¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤.
54715>>>>>//      //¡˜¢œå«˜  ˜§æ « ª request save & delete, £â©˜ ˜§æ transaction.
54715>>>>>//      //œ§ ©«¨â­œ  ¢áŸž : 5001 - 5012 š ˜ «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã
54715>>>>>//      Procedure private.Transaction_Update_Other_Modules
54715>>>>>//                Integer liDo_GL_Maintainance liDo_CUSTOMER_Maintainance liDo_VENDOR_Maintainance
54715>>>>>//                Integer liMust_Update_GL     liMust_Update_CUSTOMER     liMust_Update_VENDOR
54715>>>>>
54715>>>>>//                //š ˜ «ž¤ œç¨œ©ž «¦¬ bsum
54715>>>>>//                String lsBaxiokat_Recr
54715>>>>>
54715>>>>>//                //final values, š ˜ «ã¤ feedback œ¤ž£â¨à©ž «¦¬ barticl & bsum ˜§¦ «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã
54715>>>>>//                Integer liF_Garticl_Rec0 liF_Gmove_Master_Rec0 liF_Gmove_Slave_Rec0
54715>>>>>
54715>>>>>//                //final values, š ˜ «ã¤ feedback œ¤ž£â¨à©ž «¦¬ barticl ˜§¦ «¦çª §œ¢á«œª
54715>>>>>//                Integer liF_Carticl_Rec0 liF_Cmove_Rec0
54715>>>>>
54715>>>>>//                //final values, š ˜ «ã¤ feedback œ¤ž£â¨à©ž «¦¬ barticl ˜§¦ «¦çª §¨¦£žŸœ¬«âª
54715>>>>>//                Integer liF_Varticl_Rec0 liF_Vmove_Rec0
54715>>>>>
54715>>>>>//               //4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
54715>>>>>//               Integer liFlag02 liFlag03 liFlag04 liFlag05
54715>>>>>
54715>>>>>
54715>>>>>//                //œç¨œ©ž «à¤ ¢¦ §é¤ modules §¦¬ §¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤
54715>>>>>//                Get Field_Current_Value of (piBtypkin_dd(Self)) Field Btypkin.Gtypkin_Rec0 to liMust_Update_GL
54715>>>>>//                Get Field_Current_Value of (piBtypkin_dd(Self)) Field Btypkin.Ctypkin_Rec0 to liMust_Update_CUSTOMER
54715>>>>>//                Get Field_Current_Value of (piBtypkin_dd(Self)) Field Btypkin.Vtypkin_Rec0 to liMust_Update_VENDOR
54715>>>>>
54715>>>>>//               //˜¤áš¤à©ž «à¤ 4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
54715>>>>>//               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag02 to liFlag02
54715>>>>>//               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag03 to liFlag03
54715>>>>>//               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag04 to liFlag04
54715>>>>>//               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag05 to liFlag05
54715>>>>>
54715>>>>>
54715>>>>>//                //                                                  s  l  a  v  e  = bsum
54715>>>>>//                //                                        edit        create        delete
54715>>>>>//                //                                       -----        ------        ------
54715>>>>>//                // master garticl + gmove     edit         x            x              x
54715>>>>>//                //                            create                    x
54715>>>>>//                //                            delete                                   x
54715>>>>>//                // slave  gmove               edit         x            x              x
54715>>>>>//                //                            create                    x
54715>>>>>//                //                            delete                                   x
54715>>>>>
54715>>>>>
54715>>>>>//                If (;
54715>>>>>//                    ( liMust_Update_Gl     > 0                   ) and;
54715>>>>>//                    ((pnB_Baxio_V2(Self)) <> (pnA_Baxio_V2(Self)));
54715>>>>>//                   );
54715>>>>>//                Begin //edit œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ ˜¥å˜ v2 !
54715>>>>>//                //***************************************************************************
54715>>>>>//                //*  €  • †    „ Œ † ‹ „  — ‘ † ‘    ‚ „ Œ ˆ ‰ † ‘    Š Ž ‚ ˆ ‘ ’ ˆ ‰ † ‘ *
54715>>>>>//                //***************************************************************************
54715>>>>>//                //œ­'æ©¦¤ «¦ bmove record ©éŸž¡œ/› ˜š¨á­ž¡œ ¡˜¤¦¤ ¡á, §¨¦®à¨áà ©«ž¤ bpo
54715>>>>>//                //š ˜ «ž¤ œ¤ž£â¨à©ž «žª šœ¤ ¡ãª ¢¦š ©« ¡ãª, œá¤ æ£àª ®¨œ áœ«˜ ]
54715>>>>>
54715>>>>>//// jsjsjs 24/01/2001
54715>>>>>////                Send Transaction_BCVWmove_Update_GL to (piDo_GL_Maintainance(Self)) (Self);
54715>>>>>////                                                                                    liFlag02;
54715>>>>>////                                                                                    liFlag03;
54715>>>>>////                                                                                    liFlag04;
54715>>>>>////                                                                                    liFlag05
54715>>>>>//// jsjsjs 24/01/2001
54715>>>>>
54715>>>>>//                //œ­'æ©¦¤ ¡˜  «¦ bmove record ©éŸž¡œ/› ˜š¨á­ž¡œ ¡˜¤¦¤ ¡á,
54715>>>>>//                //¡˜  ž bpo â«¨œ¥œ ®à¨åª error,  ¡˜«˜®à¨é «¦ transaction
54715>>>>>//                //¡˜  œ¤ž£œ¨é¤à «© ©®œ« ¡á ˜¨®œå˜, › ˜™á¦¤«˜ª «˜
54715>>>>>//                //3 properties §¦¬ â®œ  œ§ ©«¨â¯œ  ž bpo œ¤ž£â¨à©žª «žª š¢
54715>>>>>//                Get piF_Garticl_Rec0      to liF_Garticl_Rec0       //barticl
54715>>>>>//                Get piF_Gmove_Master_Rec0 to liF_Gmove_Master_Rec0  //barticl
54715>>>>>//                Get piF_Gmove_Slave_Rec0  to liF_Gmove_Slave_Rec0   //bmove
54715>>>>>
54715>>>>>//                //œ¤ž£â¨à©ž bmove & barticl & bsum š ˜ « ª œšš¨˜­âª ©«á á¢¢˜ modules
54715>>>>>//                //œç¨œ©ž barticl, › æ«  œå¤˜  ˜§˜¨˜å«ž«¦ ©œ æ¢˜ «˜ operations
54715>>>>>//                Clear Barticl
54715>>>>>//                Get Current_Record of (piBarticl_dd(Self)) to Barticl.Recnum
54715>>>>>//                Find Eq Barticl.Recnum
54715>>>>>//                If (Found = 0);
54715>>>>>//                Begin //›â¤ £§æ¨œ©˜ ¤˜ ™¨é barticl by recnum
54715>>>>>//                      Send Operation_Not_Allowed 5001
54715>>>>>//                End
54715>>>>>
54715>>>>>//                //=======================================================================
54715>>>>>//                //œ­'æ©¦¤ ¡á¤à create or edit ©«¦ bmove,
54715>>>>>//                //™á©œ  «¦¬ §å¤˜¡˜ ©«¦ master ¡á¤à create or edit
54715>>>>>//                If ((piUpdate(Self)) = TRUE);
54715>>>>>//                Begin
54715>>>>>//                     //œç¨œ©ž bsum, «¦ ¦§¦å¦ ®¨œ áœ«˜  £æ¤¦¤ œ›é ¡˜  æ®  ©«ž¤ ¦¢ ¡ã › ˜š¨˜­ã «¦¬ garticl
54715>>>>>//                     Get Field_Current_Value of (piBaxiokat_dd(Self)) Field Baxiokat.Baxiokat_Recr to lsBaxiokat_Recr
54715>>>>>//                     Clear Bsum
54715>>>>>//                     Move Barticl.Barticl_Recr to Bsum.Barticl_Recr
54715>>>>>//                     Move lsBaxiokat_Recr      to Bsum.Baxiokat_Recr
54715>>>>>//                     Find Eq Bsum by Index.1 //barticl_recr+baxiokat_recr !!!!!!
54715>>>>>//                     If (Found=0);
54715>>>>>//                     Begin //›â¤ £§æ¨œ©˜ ¤˜ ™¨é bsum by recnum
54715>>>>>//                           Send Operation_Not_Allowed 5002
54715>>>>>//                     End
54715>>>>>
54715>>>>>//                     //œ¤ž£â¨à©ž master (create or edit)
54715>>>>>//                     Case Begin
54715>>>>>//                          //©«¦ create master, §¨â§œ  ž ©ç¤›œ©ž ¤© šå¤œ  «é¨˜,
54715>>>>>//                          //›ž¢˜›ã §¨â§œ  ¡˜  «˜ 2 §œ›å˜ ¤˜ œå¤˜  0,
54715>>>>>//                          //œ¤é «˜ master records «žª š¢ §¨â§œ  ¤˜ â®¦¬¤ Ÿœ« ¡ã « £ã.
54715>>>>>//                          Case ((piGarticl_Create(Self)) = TRUE)
54715>>>>>//                               If (;
54715>>>>>//                                    (Barticl.Garticl_Rec0 <> 0) or;
54715>>>>>//                                    (Barticl.Gmove_Mrec0  <> 0);
54715>>>>>//                                  ) Send Operation_Not_Allowed 5003 //«¦ create master âš ¤œ ©œ ã›ž ©¬¤›œ›œ£â¤¦ barticl
54715>>>>>//                               If (;
54715>>>>>//                                    (liF_Garticl_Rec0       <= 0) or;
54715>>>>>//                                    (liF_Gmove_Master_Rec0  <= 0);
54715>>>>>//                                  ) Send Operation_Not_Allowed 5004 //«¦ create master âš ¤œ ©œ £ã Ÿœ« ¡á gl records
54715>>>>>//                               Move liF_Garticl_Rec0      to Barticl.Garticl_Rec0 //©ç¤›œ©ž £œ garticl
54715>>>>>//                               Move liF_Gmove_Master_Rec0 to Barticl.Gmove_Mrec0  //©ç¤›œ©ž £œ master gmove
54715>>>>>//                               Saverecord Barticl
54715>>>>>//                          Case Break
54715>>>>>
54715>>>>>//                          //©«¦ edit master, §¨â§œ  ž ©ç¤›œ©ž ã›ž ¤˜ ¬§á¨®œ ,
54715>>>>>//                          //›ž¢˜›ã §¨â§œ  ¡˜  «˜ 2 §œ›å˜ ¤˜ œå¤˜  > 0
54715>>>>>//                          //¡˜  £á¢ ©«˜ ¤˜ © š¦¬¨œ¬«¦ç£œ æ«  ¡á¤˜£œ œ¤ž£â¨à©ž «žª š¢ ©«˜ å› ˜ master records
54715>>>>>//                          Case Else
54715>>>>>//                               If (;
54715>>>>>//                                    (Barticl.Garticl_Rec0 <= 0) or;
54715>>>>>//                                    (Barticl.Gmove_Mrec0  <= 0);
54715>>>>>//                                  ) Send Operation_Not_Allowed 5005 //«¦ edit master âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤˜ records
54715>>>>>//                               If (;
54715>>>>>//                                    (liF_Garticl_Rec0      <> Barticl.Garticl_Rec0) or;
54715>>>>>//                                    (liF_Gmove_Master_Rec0 <> Barticl.Gmove_Mrec0 );
54715>>>>>//                                  ) Send Operation_Not_Allowed 5006 //«¦ edit master ›â¤ âš ¤œ ©«˜ å› ˜ master records
54715>>>>>//                          Case Break
54715>>>>>//                     Case End //«â¢¦ª œ¤ž£â¨à©žª master
54715>>>>>
54715>>>>>//                     //œ¤ž£â¨à©ž slave (create or edit)
54715>>>>>//                     Case Begin
54715>>>>>//                          //©«¦ create slave, §¨â§œ  ž ©ç¤›œ©ž ¤˜ šå¤œ  «é¨˜,
54715>>>>>//                          //›ž¢˜›ã §¨â§œ  «o 1 §œ›åo ¤˜ œå¤˜  0,
54715>>>>>//                          //œ¤é «o slave record «žª š¢ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã « £ã.
54715>>>>>//                          Case ((piSlave_Gmove_Create(Self)) = TRUE)
54715>>>>>//                               If (Bsum.Gmove_Srec0 <> 0);
54715>>>>>//                                    Send Operation_Not_Allowed 5007 //«¦ create slave âš ¤œ ©œ œå¤˜  ã›ž ©¬¤›œ›œ£â¤¦ bsum
54715>>>>>//                               If (liF_Gmove_Slave_Rec0  <= 0);
54715>>>>>//                                    Send Operation_Not_Allowed 5008 //«¦ create slave âš ¤œ ©œ £ã Ÿœ« ¡æ gl record
54715>>>>>//                               Move liF_Gmove_Slave_Rec0  to Bsum.Gmove_Srec0     //©ç¤›œ©ž £œ slave gmove
54715>>>>>//                               Saverecord Bsum
54715>>>>>//                          Case Break
54715>>>>>
54715>>>>>//                          //©«¦ edit slave, §¨â§œ  ž ©ç¤›œ©ž ã›ž ¤˜ ¬§á¨®œ ,
54715>>>>>//                          //›ž¢˜›ã §¨â§œ  «¦ 1 §œ›å¦ ¤˜ œå¤˜  > 0
54715>>>>>//                          //¡˜  £á¢ ©«˜ ¤˜ © š¦¬¨œ¬«¦ç£œ æ«  ¡á¤˜£œ œ¤ž£â¨à©ž «žª š¢ ©«¦ å› ¦ slave record
54715>>>>>//                          Case Else
54715>>>>>//                               If (Bsum.Gmove_Srec0 =  0);
54715>>>>>//                                    Send Operation_Not_Allowed 5009 //«¦ edit slave âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤¦ record
54715>>>>>//                               If (liF_Gmove_Slave_Rec0  <> Bsum.Gmove_Srec0);
54715>>>>>//                                    Send Operation_Not_Allowed 5010 //«¦ edit slave ›â¤ âš ¤œ ©«¦ å› ¦ slave record
54715>>>>>//                          Case Break
54715>>>>>//                     Case End //«â¢¦ª œ¤ž£â¨à©žª slave
54715>>>>>//                End //«â¢¦ª œ¤ž£â¨à©žª edit or create bmove & barticl & bsum š ˜ « ª œšš¨˜­âª ©«á á¢¢˜ modules
54715>>>>>//                //=======================================================================
54715>>>>>
54715>>>>>//                //œ­'æ©¦¤ ©™ã¤à «ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ barticl,
54715>>>>>//                //®à¨åª æ£àª ¤˜ ©™ã©à ˜¬«æ,
54715>>>>>//                //£ž›œ¤åà ©«¦ barticl «¦ Garticl_Rec0 & Gmove_Mrec0,
54715>>>>>//                //š ˜ ¤˜ ˜§¦©¬¤›â©à «¦ barticl ˜§¦ «¦ garticl & «¦ gmove
54715>>>>>//                If ((piGarticl_Delete(Self)) = TRUE);
54715>>>>>//                Begin
54715>>>>>//                     //©«¦ delete master, §¨â§œ  ž ©ç¤›œ©ž ã›ž ¤˜ ¬§á¨®œ ,
54715>>>>>//                     //›ž¢˜›ã §¨â§œ  ¡˜  «˜ 2 §œ›å˜ ¤˜ œå¤˜  > 0
54715>>>>>//                     //¡˜  £á¢ ©«˜ ¤˜ © š¦¬¨œ¬«¦ç£œ æ«  «˜ master records «žª š¢ œå¤˜  £ž›œ¤ ¡á
54715>>>>>//                     If (;
54715>>>>>//                          (Barticl.Garticl_Rec0 <= 0) or;
54715>>>>>//                          (Barticl.Gmove_Mrec0  <= 0);
54715>>>>>//                        ) Send Operation_Not_Allowed 5011 //«¦ delete master âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤˜ records
54715>>>>>//                     If (;
54715>>>>>//                          (liF_Garticl_Rec0      <> 0) or;
54715>>>>>//                          (liF_Gmove_Master_Rec0 <> 0);
54715>>>>>//                        ) Send Operation_Not_Allowed 5012 //«¦ delete master ›â¤ â›à©œ £ž›œ¤ ¡á master records «žª š¢
54715>>>>>//                     Move liF_Garticl_Rec0      to Barticl.Garticl_Rec0 //˜§¦©ç¤›œ©ž £œ garticl
54715>>>>>//                     Move liF_Gmove_Master_Rec0 to Barticl.Gmove_Mrec0  //˜§¦˜ç¤›œ©ž £œ master gmove
54715>>>>>//                     Saverecord Barticl
54715>>>>>//                End //«â¢¦ª ˜§¦©ç¤›œ©žª barticl ˜§¦ garticl & gmove
54715>>>>>//                //****************************************************************************
54715>>>>>//                //* ’ „ Š Ž ‘    „ Œ † ‹ „  — ‘ † ‘    ‚ „ Œ ˆ ‰ † ‘    Š Ž ‚ ˆ ‘ ’ ˆ ‰ † ‘ *
54715>>>>>//                //****************************************************************************
54715>>>>>//                End //if (liMust_Update_Gl > 0) and ...
54715>>>>>
54715>>>>>
54715>>>>>
54715>>>>>//                If (liMust_Update_CUSTOMER > 0);
54715>>>>>//                Begin
54715>>>>>//                //****************************************************************************
54715>>>>>//                //*  €  • †    „ Œ † ‹ „  — ‘ † ‘     „ Š € ’ — Œ                         *
54715>>>>>//                //****************************************************************************
54715>>>>>//                //****************************************************************************
54715>>>>>//                //* ’ „ Š Ž ‘    „ Œ † ‹ „  — ‘ † ‘     „ Š € ’ — Œ                        *
54715>>>>>//                //****************************************************************************
54715>>>>>//                End //if (liMust_Update_CUSTOMER > 0)
54715>>>>>
54715>>>>>
54715>>>>>
54715>>>>>//                If (liMust_Update_VENDOR  > 0);
54715>>>>>//                Begin
54715>>>>>//                //****************************************************************************
54715>>>>>//                //*  €  • †    „ Œ † ‹ „  — ‘ † ‘      Ž ‹ † ‡ „ “ ’ — Œ                 *
54715>>>>>//                //****************************************************************************
54715>>>>>//                //****************************************************************************
54715>>>>>//                //* ’ „ Š Ž ‘    „ Œ † ‹ „  — ‘ † ‘      Ž ‹ † ‡ „ “ ’ — Œ                *
54715>>>>>//                //****************************************************************************
54715>>>>>//                End //if (liMust_Update_VENDOR > 0)
54715>>>>>
54715>>>>>//      End_Procedure //private.transaction_update_other_modules
54715>>>>>
54715>>>>>
54715>>>>>              //§˜¨'æ¢¦ §¦¬ œå¤˜  ..›ç¤˜£ž, ›â¤ §˜å¦¬¤ › æ«  «˜ §œ›å˜ œå¤˜  display only ! ¡˜  foreign fields
54715>>>>>              //Set File_Field_Entry File_Field Barticl.Garticl_Rec0 FALSE to liF_Garticl_Rec0
54715>>>>>              //Set File_Field_Entry File_Field Barticl.Gmove_Mrec0  FALSE to liF_Gmove_Master_Rec0
54715>>>>>              //Set File_Field_Entry File_Field Barticl.Gplan_Mrec0  FALSE to liF_Gplan_Master_Rec0
54715>>>>>
54715>>>>>              //Set File_Field_Entry File_Field Bmove.Gmove_Srec0    FALSE to liF_Gmove_Slave_Rec0
54715>>>>>              //Set File_Field_Entry File_Field Bmove.Gplan_Srec0    FALSE to liF_Gplan_Slave_Rec0
54715>>>>>
54715>>>>>              //Set File_Field_Changed_Value File_Field Barticl.Garticl_Rec0 to liF_Garticl_Rec0
54715>>>>>               //Set File_Field_Changed_Value File_Field Barticl.Gmove_Mrec0  to liF_Gmove_Master_Rec0
54715>>>>>              //Set File_Field_Changed_Value File_Field Barticl.Gplan_Mrec0  to liF_Gplan_Master_Rec0
54715>>>>>
54715>>>>>               //Set Field_Changed_Value      Field      Bmove.Gmove_Srec0    to liF_Gmove_Slave_Rec0
54715>>>>>               //Set Field_Changed_Value      Field      Bmove.Gplan_Srec0    to liF_Gplan_Slave_Rec0
54715>>>>>
54715>>>>>
54715>>>>>               //Forward Send Request_Save
54715>>>>>
54715>>>>>
54715>>>>>
54715>>>>>
54715>>>>>
54715>>>>>//--------------------------------------------------------------------------------
54715>>>>>    Procedure Define_Fields
54716>>>>>        Forward Send Define_Fields
54718>>>>>        //DDB-Generated-Code-Location
54718>>>>>        //DDB-DefineFieldStart
54718>>>>>
54718>>>>>        Set Main_File            To Bmove.File_Number
54719>>>>>        Set Cascade_Delete_State To FALSE
54720>>>>>
54720>>>>>
54720>>>>>        // Parent (Server) file structure...............
54720>>>>>        Send Add_Server_File  Barticl.File_Number
54721>>>>>        Send Add_Server_File  Baxio.File_Number
54722>>>>>
54722>>>>>        // External (System) file structure.............
54722>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
54723>>>>>        Send Add_System_File  Bkinkat.File_Number  DD_LOCK_ON_ALL
54724>>>>>        Send Add_System_File  Bsum.File_Number  DD_LOCK_ON_ALL
54725>>>>>
54725>>>>>        Define_Auto_Increment  Sysrecb.Bmove_Rec0  To Bmove.Bmove_Rec0
54728>>>>>
54728>>>>>        // Field-based properties.......................
54728>>>>>
54728>>>>>        // Bmove.Company_Code
54728>>>>>
54728>>>>>        // Bmove.Branch_Code
54728>>>>>
54728>>>>>        // Bmove.Year_Year
54728>>>>>
54728>>>>>        // Bmove.Btypkin_Code
54728>>>>>
54728>>>>>        // Bmove.Barticl_Hmnia
54728>>>>>
54728>>>>>        // Bmove.Barticl_No
54728>>>>>
54728>>>>>        // Bmove.Baxio_Code
54728>>>>>
54728>>>>>        // Bmove.Barticl_Recr
54728>>>>>
54728>>>>>        // Bmove.Baxio_Recr
54728>>>>>
54728>>>>>        // Bmove.Bmove_Rec0
54728>>>>>
54728>>>>>        // Bmove.Bmove_Recr
54728>>>>>
54728>>>>>        // Bmove.Bmove_Aa
54728>>>>>
54728>>>>>        // Bmove.Baxio_Aa
54728>>>>>
54728>>>>>        // Bmove.Gplan_Srec0
54728>>>>>
54728>>>>>        // Bmove.Baxio_Pfile
54728>>>>>
54728>>>>>        // Bmove.Baxio_Pcode
54728>>>>>
54728>>>>>        // Bmove.Baxio_Pepon
54728>>>>>
54728>>>>>        // Bmove.Baxio_Ppar
54728>>>>>
54728>>>>>        // Bmove.Btypkin_Recr
54728>>>>>
54728>>>>>        // Bmove.Sls_Id
54728>>>>>
54728>>>>>        // Bmove.Cnt_Id
54728>>>>>
54728>>>>>        // Bmove.Presp_Id
54728>>>>>
54728>>>>>        // Bmove.Bmove_M_Code
54728>>>>>
54728>>>>>        // Bmove.Cmoves_Recr
54728>>>>>
54728>>>>>        // Bmove.Exei_Enhmerosei
54728>>>>>
54728>>>>>        // Bmove.Hmnia_Enhmeros
54728>>>>>
54728>>>>>        //DDB-DefineFieldEnd
54728>>>>>
54728>>>>>        Set Main_File            To Bmove.File_Number
54729>>>>>        Set Cascade_Delete_State To FALSE
54730>>>>>
54730>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
54731>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
54732>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
54733>>>>>
54733>>>>>        // Parent (Server) file structure...............
54733>>>>>        Send Add_Server_File  Baxio.File_Number
54734>>>>>        Send Add_Server_File  Barticl.File_Number
54735>>>>>
54735>>>>>        // External (System) file structure.............
54735>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
54736>>>>>        Send Add_System_File  Bkinkat.File_Number  DD_LOCK_ON_ALL
54737>>>>>        Send Add_System_File  Bsum.File_Number  DD_LOCK_ON_ALL
54738>>>>>
54738>>>>>        Define_Auto_Increment  Sysrecb.Bmove_Rec0  To Bmove.Bmove_Rec0
54741>>>>>
54741>>>>>        // Field-based properties.......................
54741>>>>>
54741>>>>>        // Bmove.Company_Code
54741>>>>>
54741>>>>>        // Bmove.Branch_Code
54741>>>>>
54741>>>>>        // Bmove.Year_Year
54741>>>>>
54741>>>>>        // Bmove.Btypkin_Code
54741>>>>>
54741>>>>>        // Bmove.Barticl_Hmnia
54741>>>>>
54741>>>>>        // Bmove.Barticl_No
54741>>>>>
54741>>>>>        // Bmove.Barticl_Rec0
54741>>>>>
54741>>>>>        // Bmove.Baxio_Rec0
54741>>>>>
54741>>>>>        // Bmove.Bmove_Rec0
54741>>>>>
54741>>>>>        // Bmove.Bmove_Aa
54741>>>>>        Set Field_Options          Field Bmove.Bmove_Aa           To DD_DISPLAYONLY
54742>>>>>
54742>>>>>        // Bmove.Baxio_Aa
54742>>>>>        Set Field_Options          Field Bmove.Baxio_Aa           To DD_DISPLAYONLY
54743>>>>>
54743>>>>>        // Bmove.Gplan_Srec0
54743>>>>>        Set Field_Options          Field Bmove.Gplan_Srec0        To DD_DISPLAYONLY
54744>>>>>
54744>>>>>        // Bmove.Baxio_Pfile
54744>>>>>
54744>>>>>        // Bmove.Baxio_Pcode
54744>>>>>
54744>>>>>        // Bmove.Baxio_Pepon
54744>>>>>
54744>>>>>        // Bmove.Baxio_Ppar
54744>>>>>
54744>>>>>    End_Procedure    // Define_Fields
54745>>>>>
54745>>>>>
54745>>>>>    Procedure Field_Defaults
54746>>>>>        Forward Send Field_Defaults
54748>>>>>        //DDB-Generated-Code-Location
54748>>>>>        //DDB-FieldDefaultStart
54748>>>>>        //DDB-FieldDefaultEnd
54748>>>>>    End_Procedure    // Field_Defaults
54749>>>>>
54749>>>>>End_Class    // Bmove_DataDictionary
54750>>>>>//DDB-FileEnd
54750>>>        Use Baxio.DD
54750>>>        
54750>>>        Property String     psCurrentCompany    Public ''
54752>>>        Property String     psCurrentBranch     Public ''
54754>>>        Property Integer    piCurrentYear       Public  0
54756>>>        
54756>>>        Property String     psChoosenCompany    Public ''
54758>>>        Property String     psChoosenBranch     Public ''
54760>>>        Property Integer    piChoosenYear       Public  0
54762>>>        
54762>>>        Property Integer    pidbGrpYearID       Public  0
54764>>>        Property Integer    picboCompanyID      Public  0
54766>>>        Property Integer    picboBranchID       Public  0
54768>>>        Property Integer    picboYearID         Public  0
54770>>>        Property Integer    pibtnChangeXrID     Public  0
54772>>>        
54772>>>        //Procedure Reset_The_Constraints_After_Changing_Syscurxr
54772>>>        //    Send Rebuild_Constraints to Wax_DD
54772>>>        //    Send Rebuild_Constraints to Witemx_DD
54772>>>        //    Send Rebuild_Constraints to Witemxen_DD
54772>>>        //    Send Rebuild_Constraints to Witemxtr_DD
54772>>>        //    Send Rebuild_Constraints to Witemxt_DD
54772>>>        //    Send Rebuild_Constraints to Ptyppar_DD
54772>>>        //    Send Rebuild_Constraints to Itemd_DD
54772>>>        //    Send Rebuild_Constraints to Bmove_DD
54772>>>        //    Send Rebuild_Constraints to Baxio_DD
54772>>>        //End_Procedure
54772>>>        
54772>>>        
54772>>>        //AB-StoreTopEnd
54772>>>
54772>>>        Set Size to 26 514
54773>>>        Set Location to -3 3
54774>>>        Object otxtCompany is a TextBoxSub
54776>>>            Set Label to "„«˜ ¨œå˜"
54777>>>            Set Auto_Size_State to FALSE
54778>>>            Set TextColor to clNavy
54779>>>            Set FontSize to 4 0
54780>>>            Set Location to 11 5
54781>>>            Set Size to 10 31
54782>>>            Set FontWeight to 800
54783>>>            Set Justification_Mode to jMode_Right
54784>>>            Set TypeFace to "MS Sans Serif"
54785>>>            Set Enabled_State to TRUE
54786>>>        End_Object    // otxtCompany
54787>>>
54787>>>        Object cboCompany is a ComboFormSub
54789>>>
54789>>>            //AB-StoreTopStart
54789>>>                                                
54789>>>            //AB-StoreTopEnd
54789>>>
54789>>>            Set Size to 13 141
54790>>>            Set Location to 9 46
54791>>>            Set Label_Col_Offset to 2
54792>>>            Set Label_Justification_Mode to jMode_Right
54793>>>
54793>>>            //AB-StoreStart
54793>>>                                                
54793>>>            Procedure Exiting Integer WhereTo Returns Integer
54795>>>                Integer rVal iID iYes
54796>>>                Forward Get Msg_Exiting WhereTo to rVal
54798>>>                If rVal Procedure_Return rVal
54801>>>                If ((WhereTo<>picboCompanyID (Self)) And ;                    (WhereTo<>picboBranchID  (Self)) And ;                    (WhereTo<>picboYearID    (Self)) And ;                    (WhereTo<>pibtnChangeXrID(Self))) Begin
54803>>>                    If ((psChoosenCompany(Self)<>SyscurXr.Company_Code) Or ;                        (psChoosenBranch (Self)<>SyscurXr.Branch_Code ) Or ;                        (piChoosenYear   (Self)<>SyscurXr.year_Year   )) Begin
54805>>>                        Get YesNo_Box '¨¦©¦®ã ! €¢¢á¥˜«œ ©«¦ ®œå˜ „«˜ ¨å˜ª/“§¦¡˜«./•¨ã©žª\n˜¢¢á ƒ„Œ §˜«ã©˜«œ «¦ ¡¦¬£§å š ˜ œ¤œ¨š¦§¦åž©ž ˜¢¢˜šãª ®¨ã©žª\n‡â¢œ«œ ¤˜ œ¤œ¨š¦§¦ ã©à «é¨˜ «ž¤ ˜¢¢˜šã ˜¬«ã ?' to iYes
54806>>>                        If (iYes=MBR_YES) Send OnClick to (pibtnChangeXrID(Self))
54809>>>                        Else Send Reset_Combos
54811>>>                    End
54811>>>>
54811>>>                End
54811>>>>
54811>>>                Procedure_return rVal
54812>>>            End_Procedure
54813>>>            
54813>>>            Procedure Key Integer iKey
54815>>>            End_Procedure
54816>>>            
54816>>>            Procedure Combo_Fill_List
54818>>>                Clear Company
54819>>>                Find Gt Company.Recnum
54820>>>>
54820>>>                While (Found)
54824>>>                    Send Combo_Add_Item (Trim(Company.Company_Code)+' - '+ Trim(Company.Company_Name))
54825>>>                    Find Gt Company.Recnum
54826>>>>
54826>>>                Loop
54827>>>>
54827>>>            
54827>>>                // Find Current Company to display in Combo
54827>>>                Clear Company
54828>>>                Move (psChoosenCompany(Self))   to Company.Company_Code
54829>>>                Find Eq Company By Index.1
54830>>>>
54830>>>                If (Found)  Set Value Of cboCompany Item 0 to (Trim(Company.Company_Code)+' - '+ Trim(Company.Company_Name))
54833>>>                Else        Set Value Of cboCompany Item 0 to ''
54835>>>            End_procedure
54836>>>            
54836>>>            Procedure Combo_Item_Changed
54838>>>                String  sVal
54839>>>                Integer iPos
54839>>>                Forward Send Combo_Item_Changed
54841>>>                Get Value Of cboCompany Item 0  to sVal
54842>>>                If (Trim(sVal)='') Begin
54844>>>                    Clear Company
54845>>>                    Move (psChoosenCompany(Self))   to Company.Company_Code
54846>>>                    Find Eq Company By Index.1
54847>>>>
54847>>>                    If (Found)  Set Value Of cboCompany Item 0 to (Trim(Company.Company_Code)+' - '+ Trim(Company.Company_Name))
54850>>>                    Else        Set Value Of cboCompany Item 0 to ''
54852>>>                End
54852>>>>
54852>>>                Else Begin
54853>>>                    Move (Pos('-',sVal)-1) to iPos
54854>>>                    Set psChoosenCompany            to (Trim(Left(sVal,iPos)))
54855>>>                End
54855>>>>
54855>>>                Send Fill_Branch
54856>>>            End_procedure
54857>>>            
54857>>>            Procedure End_Construct_Object
54859>>>                Integer iID
54860>>>                Forward Send End_Construct_Object
54862>>>                Get Object_ID Of Self   to iID
54863>>>                Set picboCompanyID      to iID
54864>>>            End_Procedure
54865>>>            
54865>>>            
54865>>>            
54865>>>            
54865>>>            
54865>>>            
54865>>>            
54865>>>            
54865>>>            //AB-StoreEnd
54865>>>
54865>>>        End_Object    // cboCompany
54866>>>
54866>>>        Object otxtBranch is a TextBoxSub
54868>>>            Set Label to "“§¦¡/£˜ :"
54869>>>            Set Auto_Size_State to FALSE
54870>>>            Set TextColor to clNavy
54871>>>            Set FontSize to 4 0
54872>>>            Set Location to 11 195
54873>>>            Set Size to 10 30
54874>>>            Set FontWeight to 800
54875>>>            Set Justification_Mode to jMode_Right
54876>>>            Set TypeFace to "MS Sans Serif"
54877>>>            Set Enabled_State to TRUE
54878>>>        End_Object    // otxtBranch
54879>>>
54879>>>        Object cboBranch is a ComboFormSub
54881>>>            Set Size to 13 147
54882>>>            Set Location to 9 235
54883>>>            Set Label_Col_Offset to 2
54884>>>            Set Label_Justification_Mode to jMode_Right
54885>>>
54885>>>            //AB-StoreStart
54885>>>                                                
54885>>>            Procedure Exiting Integer WhereTo Returns Integer
54887>>>                Integer rVal iID iYes
54888>>>                Forward Get Msg_Exiting WhereTo to rVal
54890>>>                If rVal Procedure_Return rVal
54893>>>                If ((WhereTo<>picboCompanyID (Self)) And ;                    (WhereTo<>picboBranchID  (Self)) And ;                    (WhereTo<>picboYearID    (Self)) And ;                    (WhereTo<>pibtnChangeXrID(Self))) Begin
54895>>>                    If ((psChoosenCompany(Self)<>SyscurXr.Company_Code) Or ;                        (psChoosenBranch (Self)<>SyscurXr.Branch_Code ) Or ;                        (piChoosenYear   (Self)<>SyscurXr.year_Year   )) Begin
54897>>>                        Get YesNo_Box '¨¦©¦®ã ! €¢¢á¥˜«œ ©«¦ ®œå˜ „«˜ ¨å˜ª/“§¦¡˜«./•¨ã©žª\n˜¢¢á ƒ„Œ §˜«ã©˜«œ «¦ ¡¦¬£§å š ˜ œ¤œ¨š¦§¦åž©ž ˜¢¢˜šãª ®¨ã©žª\n‡â¢œ«œ ¤˜ œ¤œ¨š¦§¦ ã©à «é¨˜ «ž¤ ˜¢¢˜šã ˜¬«ã ?' to iYes
54898>>>                        If (iYes=MBR_YES) Send OnClick to (pibtnChangeXrID(Self))
54901>>>                        Else Send Reset_Combos
54903>>>                    End
54903>>>>
54903>>>                End
54903>>>>
54903>>>                Procedure_return rVal
54904>>>            End_Procedure
54905>>>            
54905>>>            Procedure Key Integer iKey
54907>>>            End_Procedure
54908>>>            
54908>>>            Procedure Combo_Fill_List
54910>>>            End_procedure
54911>>>            
54911>>>            Procedure Combo_Item_Changed
54913>>>                String  sVal
54914>>>                Integer iPos
54914>>>                Forward Send Combo_Item_Changed
54916>>>                Get Value Of cboBranch Item 0  to sVal
54917>>>                If (Trim(sVal)='') Begin
54919>>>                    Clear Branch
54920>>>                    Move (psChoosenCompany(Self))   to Branch.Company_Code
54921>>>                    Move (psChoosenBranch (Self))   to Branch.Branch_Code
54922>>>                    Find Eq Branch By Index.1
54923>>>>
54923>>>                    If (Found)  Set Value Of cboBranch Item 0 to (Trim(Branch.Branch_Code)+' - '+ Trim(Branch.Branch_Name))
54926>>>                    Else        Set Value Of cboBranch Item 0 to ''
54928>>>                End
54928>>>>
54928>>>                Else Begin
54929>>>                    Move (Pos('-',sVal)-1) to iPos
54930>>>                    Set psChoosenBranch    to (Trim(Left(sVal,iPos)))
54931>>>                End
54931>>>>
54931>>>                Send Fill_Year
54932>>>            End_procedure
54933>>>            
54933>>>            Procedure End_Construct_Object
54935>>>                Integer iID
54936>>>                Forward Send End_Construct_Object
54938>>>                Get Object_ID Of Self   to iID
54939>>>                Set picboBranchID       to iID
54940>>>            End_Procedure
54941>>>            
54941>>>            
54941>>>            
54941>>>            
54941>>>            
54941>>>            //AB-StoreEnd
54941>>>
54941>>>        End_Object    // cboBranch
54942>>>
54942>>>        Object otxtYear is a TextBoxSub
54944>>>            Set Label to "•¨ã©ž :          "
54945>>>            Set Auto_Size_State to FALSE
54946>>>            Set FontSize to 4 0
54947>>>            Set Location to 11 392
54948>>>            Set Size to 10 23
54949>>>            Set FontWeight to 600
54950>>>            Set Justification_Mode to jMode_Left
54951>>>            Set TypeFace to "MS Sans Serif"
54952>>>            Set Enabled_State to TRUE
54953>>>
54953>>>            //AB-StoreStart
54953>>>                                                
54953>>>            Set TextColor to clYellow
54954>>>            
54954>>>            //AB-StoreEnd
54954>>>
54954>>>        End_Object    // otxtYear
54955>>>
54955>>>        Object cboYear is a ComboFormSub
54957>>>            Set Size to 13 54
54958>>>            Set Location to 9 423
54959>>>            Set Label_Col_Offset to 2
54960>>>            Set Label_Justification_Mode to jMode_Right
54961>>>
54961>>>            //AB-StoreStart
54961>>>                                                
54961>>>            Procedure Exiting Integer WhereTo Returns Integer
54963>>>                Integer rVal iID iYes
54964>>>                Forward Get Msg_Exiting WhereTo to rVal
54966>>>                If rVal Procedure_Return rVal
54969>>>                If ((WhereTo<>picboCompanyID (Self)) And ;                    (WhereTo<>picboBranchID  (Self)) And ;                    (WhereTo<>picboYearID    (Self)) And ;                    (WhereTo<>pibtnChangeXrID(Self))) Begin
54971>>>                    If ((psChoosenCompany(Self)<>SyscurXr.Company_Code) Or ;                        (psChoosenBranch (Self)<>SyscurXr.Branch_Code ) Or ;                        (piChoosenYear   (Self)<>SyscurXr.year_Year   )) Begin
54973>>>                        Get YesNo_Box '¨¦©¦®ã ! €¢¢á¥˜«œ ©«¦ ®œå˜ „«˜ ¨å˜ª/“§¦¡˜«./•¨ã©žª\n˜¢¢á ƒ„Œ §˜«ã©˜«œ «¦ ¡¦¬£§å š ˜ œ¤œ¨š¦§¦åž©ž ˜¢¢˜šãª ®¨ã©žª\n‡â¢œ«œ ¤˜ œ¤œ¨š¦§¦ ã©à «é¨˜ «ž¤ ˜¢¢˜šã ˜¬«ã ?' to iYes
54974>>>                        If (iYes=MBR_YES) Send OnClick to (pibtnChangeXrID(Self))
54977>>>                        Else Send Reset_Combos
54979>>>                    End
54979>>>>
54979>>>                End
54979>>>>
54979>>>                Procedure_return rVal
54980>>>            End_Procedure
54981>>>            
54981>>>            Procedure Key Integer iKey
54983>>>            End_Procedure
54984>>>            
54984>>>            Procedure Combo_Fill_List
54986>>>            End_procedure
54987>>>            
54987>>>            Procedure Combo_Item_Changed
54989>>>                Integer iVal
54990>>>                Forward Send Combo_Item_Changed
54992>>>                Get Value Of cboYear Item 0 to iVal
54993>>>                Set piChoosenYear           to iVal
54994>>>            End_procedure
54995>>>            
54995>>>            Procedure End_Construct_Object
54997>>>                Integer iID
54998>>>                Forward Send End_Construct_Object
55000>>>                Get Object_ID Of Self   to iID
55001>>>                Set picboYearID         to iID
55002>>>            End_Procedure
55003>>>            
55003>>>            
55003>>>            
55003>>>            
55003>>>            //AB-StoreEnd
55003>>>
55003>>>        End_Object    // cboYear
55004>>>
55004>>>        Object btnChangeXr is a ButtonSub
55006>>>            Set Bitmap to "Convert2.bmp"
55007>>>            Set Size to 20 23
55008>>>            Set Location to 5 487
55009>>>            Set Border_Style to Border_Normal
55010>>>            Set Focus_Mode to Pointer_Only
55011>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
55012>>>
55012>>>            //AB-StoreStart
55012>>>                                                
55012>>>            Set TooltipValue to '„§ ™œ™˜åà©ž ˜¢¢˜šãª ©«¦ ®œåà¤ ®¨ã©žª'
55013>>>            
55013>>>            Procedure OnClick
55015>>>                String  sOld sNew
55016>>>                Integer iYes
55016>>>                Append sOld '€¢¢˜šã ˜§¦ -> ' (Trim(SyscurXr.Company_Name)) ' - ' (Trim(SyscurXr.Branch_Name)) ' - ' (String(SyscurXr.Year_Year)) '\n'
55023>>>                Append sNew '        ©œ -> ' (Trim(Value(cboCompany(Self),0))) ' - ' (Trim(Value(cboBranch(Self),0))) ' - ' (Trim(String(Value(cboYear(Self),0)))) ' ?'
55030>>>                Get YesNo_Box (sOld+sNew) to iYes
55031>>>                If (iYes=MBR_NO) Begin
55033>>>                    Send Reset_Combos
55034>>>                    Procedure_Return
55035>>>                End
55035>>>>
55035>>>            
55035>>>            
55035>>>                Send Reset_All_Files_Except_System
55036>>>            
55036>>>                // Verify that choosen company+branch+year
55036>>>                // is a valid record and existing record
55036>>>                Clear Year
55037>>>                Move (psChoosenCompany(Self)) to Year.Company_Code
55038>>>                Move (psChoosenBranch (Self)) to Year.Branch_Code
55039>>>                Move (piChoosenYear   (Self)) to Year.Year_Year
55040>>>                Find Eq Year By Index.1
55041>>>>
55041>>>                If (Not(Found)) Begin
55043>>>                    Send Stop_Box '€¤ç§˜¨¡«ž œ§ ¢¦šã „«˜ ¨å˜ª/“§¦¡˜«˜©«ã£˜«¦ª/•¨ã©žª' '‘­á¢£˜ 8000'
55044>>>                    Send Reset_Combos
55045>>>                    Procedure_Return
55046>>>                End
55046>>>>
55046>>>                // First Close All the Views and Check if
55046>>>                // function returns 0 = all views closed OK
55046>>>                //                  1 = Not ok
55046>>>            
55046>>>                If (Close_All_Views(Self,False)=1) Begin
55048>>>                    Send Reset_Combos
55049>>>                    Procedure_Return
55050>>>                End
55050>>>>
55050>>>                // Change Current Xrhsh
55050>>>                Send Change_Current_Xrhsh
55051>>>            End_Procedure // OnClick
55052>>>            
55052>>>            Procedure Change_Current_Xrhsh
55054>>>                Integer iRetVal00 iBreak00 iID
55055>>>                String  ldcheck00 lsYearRecr00 lsSite00 sCname00 sBname00
55055>>>                String  sYname00 sNom100 sNom200 sNom300 sCode00
55055>>>                Date    ldYearXrhsh_From00 ldYearXrhsh_To00
55055>>>            
55055>>>                // Exoume Current Year record apo ton elegxo sthn onclick
55055>>>                // tou button allaghs xrhshs mesa sto combo group.
55055>>>                // energopoioume kai tous mpampades.
55055>>>                Relate Year
55056>>>                //
55056>>>                Move Company.Company_Code   to gs_Selected_Company_Code
55057>>>                Move Company.Company_Name   to sCname00
55058>>>            
55058>>>                Move Branch.Branch_Code     to gs_Selected_Branch_Code
55059>>>                Move Branch.Beto_Site       to gs_Selected_Beto_Site
55060>>>                Move Branch.Branch_Site     to lsSite00
55061>>>                Move Branch.Branch_name     to sBname00
55062>>>            
55062>>>                Move Year.Year_Year         to gi_Selected_Year
55063>>>                Move Year.Year_Recr         to lsYearRecr00
55064>>>                Move Year.Year_C_Code0      to sNom100
55065>>>                Move Year.Year_C_Code00     to sNom200
55066>>>                Move Year.Year_C_CodeR      to sNom300
55067>>>                Move Year.Year_Descr        to sYname00
55068>>>            
55068>>>                Move Year.Year_Xrhshfrom    to ldYearXrhsh_From00
55069>>>                Move Year.Year_XrhshTo      to ldYearXrhsh_To00
55070>>>            
55070>>>                Move 0 to iBreak00
55071>>>                Clear Nomisma
55072>>>                Find Gt Nomisma.Recnum
55073>>>>
55073>>>                While ((Found=1) And (iBreak00=0))
55077>>>                    If (Nomisma.Einai_Euro='1') Begin
55079>>>                        Move 1 to iBreak00
55080>>>                        Move Nomisma.Nomisma_Code to sCode00
55081>>>                    End
55081>>>>
55081>>>                    If (Not(iBreak00)) Find Gt Nomisma.Recnum
55084>>>                Loop
55085>>>>
55085>>>                Move (Trim(sCode00)) to sCode00
55086>>>            
55086>>>                Reread SysCurXR
55090>>>                Move gs_Selected_Company_Code   to SysCurXR.Company_Code
55091>>>                Move sCname00                   to SysCurXR.Company_Name
55092>>>                Move gs_Selected_beto_site      to SysCurXR.beto_site
55093>>>                Move gs_Selected_Branch_Code    to SysCurXR.Branch_Code
55094>>>                Move lsSite00                   to SysCurXR.Branch_Site
55095>>>                Move sBname00                   to SysCurXR.Branch_Name
55096>>>                Move gi_Selected_Year           to SysCurXR.Year_Year
55097>>>                Move lsYearRecr00               to SysCurXR.Year_Recr
55098>>>                Move sYname00                   to SysCurXR.Year_Descr
55099>>>                Move ldYearXrhsh_From00         to SysCurXr.Year_XrhshFrom
55100>>>                Move ldYearXrhsh_To00           to SysCurXr.Year_XrhshTo
55101>>>                Move  (Trim(sNom100))           to SysCurXR.C_Code0
55102>>>                Move  (Trim(sNom200))           to SysCurXR.C_Code00
55103>>>                Move  (Trim(sNom300))           to SysCurXR.C_CodeR
55104>>>                Move sCode00                    to SysCurXR.Euro_Code
55105>>>            
55105>>>                Saverecord SysCurXR
55106>>>                Unlock
55107>>>>
55107>>>            
55107>>>                If (Syscurxr_DD(Self)<>0) Send Find_By_Recnum to Syscurxr_DD Syscurxr.File_Number Syscurxr.Recnum
ERROR: 54 Invalid symbol in expression SYSCURXR_DD ON LINE: 708 (55107) OF FILE: L:\VDF6\Develop\Empor\AppSrc\FTPVIEW.VW
ERROR: 300 INVALID OBJECT REFERENCE ON LINE: 708 (55109) OF FILE: L:\VDF6\Develop\Empor\AppSrc\FTPVIEW.VW
55109>>>            
55109>>>                Move lsYearRecr00               to gs_Selected_Year_Recr
55110>>>                Send Reset_Combos
55111>>>            
55111>>>                //Send Reset_The_Constraints_After_Changing_Syscurxr
55111>>>            
55111>>>                // Ta pidbViewID kai psdbViewName einai nea property
55111>>>                // apo thn klash dbViewSubS kai kratane to ID tou view
55111>>>                // kai to onoma tou.
55111>>>                Send Activate_View Of (pidbViewID(Self))
55112>>>                Send Reset_Combos
55113>>>            End_Procedure
55114>>>            
55114>>>            Procedure End_Construct_Object
55116>>>                Integer iID
55117>>>                Forward Send End_Construct_Object
55119>>>                Get Object_ID Of Self   to iID
55120>>>                Set pibtnChangeXrID     to iID
55121>>>            End_Procedure
55122>>>            
55122>>>            
55122>>>            
55122>>>            
55122>>>            
55122>>>            
55122>>>            
55122>>>            
55122>>>            
55122>>>            
55122>>>            
55122>>>            
55122>>>            
55122>>>            
55122>>>            
55122>>>            
55122>>>            
55122>>>            
55122>>>            
55122>>>            
55122>>>            //AB-StoreEnd
55122>>>
55122>>>        End_Object    // btnChangeXr
55123>>>
55123>>>
55123>>>        //AB-StoreStart
55123>>>                                
55123>>>                                
55123>>>        Procedure Reset_Combos
55125>>>            Set psCurrentCompany    to SysCurXr.Company_Code
55126>>>            Set psCurrentBranch     to SysCurXr.Branch_Code
55127>>>            Set piCurrentYear       to SysCurXr.Year_Year
55128>>>            Set psChoosenCompany    to SysCurXr.Company_Code
55129>>>            Set psChoosenBranch     to SysCurXr.Branch_Code
55130>>>            Set piChoosenYear       to SysCurXr.Year_Year
55131>>>            Send Combo_Item_Changed to cboCompany
55132>>>        End_Procedure
55133>>>        
55133>>>        Procedure Activating
55135>>>            Forward Send Activating
55137>>>            Send Reset_Combos
55138>>>        End_Procedure
55139>>>        
55139>>>        Procedure Fill_Branch
55141>>>            Send Combo_Delete_Data to cboBranch
55142>>>            Clear Branch
55143>>>            Move (psChoosenCompany(Self)) to Branch.Company_Code
55144>>>            Find Gt Branch By Index.1
55145>>>>
55145>>>            While ((Found=1) And (Branch.Company_Code=(psChoosenCompany(Self))))
55149>>>                Send Combo_Add_Item to cboBranch (Trim(Branch.Branch_Code)+' - '+ Trim(Branch.Branch_Name))
55150>>>                Find Gt Branch By Index.1
55151>>>>
55151>>>            Loop
55152>>>>
55152>>>        
55152>>>            // Find Current Branch to display in Combo
55152>>>            Clear Branch
55153>>>            Move (psChoosenCompany(Self))   to Branch.Company_Code
55154>>>            Move (psChoosenBranch (Self))   to Branch.Branch_Code
55155>>>            Find Eq Branch By Index.1
55156>>>>
55156>>>            If (Found)  Set Value Of cboBranch Item 0 to (Trim(Branch.Branch_Code)+' - '+ Trim(Branch.Branch_Name))
55159>>>            Else        Set Value Of cboBranch Item 0 to ''
55161>>>            Send Fill_Year
55162>>>        End_Procedure
55163>>>        
55163>>>        Procedure Fill_Year
55165>>>            Send Combo_Delete_Data to cboYear
55166>>>            Clear Year
55167>>>            Move (psChoosenCompany(Self))   to Year.Company_Code
55168>>>            Move (psChoosenBranch (Self))   to Year.Branch_Code
55169>>>            Find Gt Year By Index.1
55170>>>>
55170>>>            While ((Found=1) And (Year.Company_Code=(psChoosenCompany(Self))) And (Year.Branch_Code=(psChoosenBranch(Self))))
55174>>>                Send Combo_Add_Item to cboYear (Trim(String(Year.Year_Year)))
55175>>>                Find Gt Year By Index.1
55176>>>>
55176>>>            Loop
55177>>>>
55177>>>        
55177>>>            // Find Current Year to display in Combo
55177>>>            Clear Year
55178>>>            Move (psChoosenCompany(Self))   to Year.Company_Code
55179>>>            Move (psChoosenBranch (Self))   to Year.Branch_Code
55180>>>            Move (piChoosenYear   (Self))   to Year.Year_Year
55181>>>            Find Eq Year By Index.1
55182>>>>
55182>>>            If (Found=1)    Set Value Of cboYear Item 0 to (Trim(String(Year.Year_Year)))
55185>>>            Else            Set Value Of cboYear Item 0 to ''
55187>>>        End_Procedure
55188>>>        
55188>>>        Procedure End_Construct_Object
55190>>>            Integer iID
55191>>>            Forward Send End_Construct_Object
55193>>>            Get Object_ID Of Self   to iID
55194>>>            Set pidbGrpYearID       to iID
55195>>>        End_Procedure
55196>>>        
55196>>>        
55196>>>        
55196>>>        
55196>>>        
55196>>>        
55196>>>        
55196>>>        
55196>>>        
55196>>>        
55196>>>        
55196>>>        
55196>>>        //AB-StoreEnd
55196>>>
55196>>>    End_Object    // dbGrpYear
55197>>>
55197>>>    Object frmAddress is a FormSub
55199>>>        Set Label to "ƒ œçŸ¬¤©ž FTP"
55200>>>        Set Size to 13 98
55201>>>        Set Location to 191 3
55202>>>        Set Label_Col_Offset to 10
55203>>>        Set Label_Justification_Mode to jMode_Right
55204>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
55205>>>
55205>>>        //AB-StoreStart
55205>>>                                
55205>>>        //AB-StoreEnd
55205>>>
55205>>>    End_Object    // frmAddress
55206>>>
55206>>>    Object frmUserName is a FormSub
55208>>>        Set Size to 13 195
55209>>>        Set Location to 206 3
55210>>>        Set Label_Col_Offset to 10
55211>>>        Set Label_Justification_Mode to jMode_Right
55212>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
55213>>>    End_Object    // frmUserName
55214>>>
55214>>>    Object frmPassword is a FormSub
55216>>>        Set Size to 13 195
55217>>>        Set Location to 220 3
55218>>>        Set Label_Col_Offset to 10
55219>>>        Set Label_Justification_Mode to jMode_Right
55220>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
55221>>>        Set Password_State Item 0 to TRUE
55222>>>
55222>>>        //AB-StoreStart
55222>>>                                
55222>>>        Set Password_State to True
55223>>>        
55223>>>        //AB-StoreEnd
55223>>>
55223>>>    End_Object    // frmPassword
55224>>>
55224>>>    Object frmDirectory is a FormSub
55226>>>        Set Size to 13 195
55227>>>        Set Location to 234 3
55228>>>        Set Label_Col_Offset to 10
55229>>>        Set Label_Justification_Mode to jMode_Right
55230>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
55231>>>    End_Object    // frmDirectory
55232>>>
55232>>>    Object btn_Connect is a ButtonSub
55234>>>        Set Label to "‹œ«˜­¦¨á œ§ ¢œš£â¤à¤ ˜¨®œåà¤"
55235>>>        Set Size to 16 195
55236>>>        Set Location to 255 3
55237>>>        Set Form_FontWeight Item 0 to 600
55238>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
55239>>>
55239>>>        //AB-StoreStart
55239>>>                                
55239>>>        Object TimerObj Is A DFTimer
55241>>>        
55241>>>            Property Integer piForesCount   Public  0
55243>>>            Property String  psRemFile   Public ''
55245>>>            Property String  psLocFile    Public ''
55247>>>        
55247>>>            Set Auto_Start_State    to False
55248>>>            Set Auto_Stop_State     to False
55249>>>        
55249>>>            Procedure OnTimer
55251>>>                Integer iCount rVal
55252>>>                Get piForesCount to iCount
55253>>>                send AddInfo to (oStatusForm (Self)) ("œ¨ £â¤à ¢ã¯ž ˜¨®œå¦¬ "*(Trim(psRemFile(Self)))-"...")
55254>>>                Increment iCount
55255>>>                Get fiGetFile Of FtpView (psRemFile(Self)) (psLocFile(Self)) 0 1 to rVal
55256>>>                If (Not(rVal)) Begin
55258>>>                    Set piFileRetreived to 1
55259>>>                    Send Stop_Timer
55260>>>                End
55260>>>>
55260>>>                Set piForesCount to iCount
55261>>>                If (iCount>(piFtpTimesExit(Self))) Send Stop_Timer
55264>>>            End_Procedure
55265>>>        
55265>>>        End_Object
55266>>>        
55266>>>        Procedure Start_Timer String asRemoteFile String asLocalFile
55268>>>            Set piFileRetreived                         to 0
55269>>>            Set piForesCount        of (TimerObj(Self)) to 0
55270>>>            Set psRemFile           of (TimerObj(Self)) to (Trim(asRemoteFile))
55271>>>            Set psLocFile           of (TimerObj(Self)) to (Trim(asLocalFile))
55272>>>            Set Timeout             of (TimerObj(Self)) to (piFtpSecondsRetry(Self)*1000)
55273>>>            Set Timer_Active_State  of (TimerObj(Self)) to True // Starts timer
55274>>>        End_Procedure
55275>>>        
55275>>>        
55275>>>        Procedure Stop_Timer
55277>>>            Integer iFileRetreived iMetr iRecnum iStat
55278>>>            String  sFile
55278>>>            Set Timer_Active_State of (TimerObj(Self)) to False // Stops Timer
55279>>>            // Check property set by timer if zrok.txt is received
55279>>>        
55279>>>            Get fiCloseDialup   to iStat
55280>>>        
55280>>>            Get piFileRetreived to iFileRetreived
55281>>>        
55281>>>            If (Not(iFileRetreived)) Begin
55283>>>                Send Info_Box 'ƒœ¤ œ¢ã­Ÿœ  «¦ ˜¨®œå¦ œ§ ™œ™˜åà©žª' '¢ž¨¦­¦¨å˜'
55284>>>                Procedure_Return
55285>>>            End
55285>>>>
55285>>>            Get psLocFile Of TimerObj   to sFile
55286>>>            Move (Trim(sFile))          to sFile
55287>>>            send AddInfo to (oStatusForm (Self)) ("’¦ ˜¨®œå¦ œ¢ã­Ÿœ  - "*sFile-" - ...")
55288>>>            // Read zrok.txt and flag Hmerprog for all recnums
55288>>>            // in zrok.txt that records were correctly sent
55288>>>            Direct_Input Channel 9 sFile
55290>>>            Move 0 to iMetr
55291>>>            Readln Channel 9 iRecnum
55293>>>            If (Seqeof) Begin
55295>>>                Send Info_Box '’¦ ˜¨®œå¦ zrok.txt ›œ¤ ¬§á¨®œ  ã œå¤˜  á›œ ¦' '¢ž¨¦­¦¨å˜'
55296>>>                Procedure_Return
55297>>>            End
55297>>>>
55297>>>        
55297>>>            While (NOT(Seqeof))
55301>>>                Add 1 to iMetr
55302>>>                send AddInfo to (oStatusForm (Self)) ("„¤ž£â¨à©ž ¨¦š¨˜££˜« ©£¦ç " + String(iMetr)+ " ...")
55303>>>                Clear HmerProg
55304>>>                Move iRecnum to HmerProg.Recnum
55305>>>                Find Eq HmerProg.Recnum
55306>>>>
55306>>>                If (Found) Begin
55308>>>                    Reread HmerProg
55312>>>                    Move 1 to HmerProg.Sent
55313>>>                    Saverecord Hmerprog
55314>>>                    Unlock
55315>>>>
55315>>>                End
55315>>>>
55315>>>                Readln Channel 9 iRecnum
55317>>>            Loop
55318>>>>
55318>>>            Send Info_Box '† ˜§¦©«¦¢ã ¡˜  ž ¢ã¯ž ¦¢¦¡¢ž¨éŸž¡˜¤' '¢ž¨¦­¦¨å˜'
55319>>>            Send Delete_Data    to oStatusForm
55320>>>            Set Value of frmMessage Item 0 to ''
55321>>>            Send Paint          to oStatusForm
55322>>>            Send OnClick to btn_Select
55323>>>        End_Procedure
55324>>>        
55324>>>        Function fiFTPVerify Returns Integer
55326>>>            String  sFtp sUser sPassword sDir
55327>>>            Get Value Of frmAddress     to sFtp
55328>>>            Get Value Of frmUserName    to sUser
55329>>>            Get Value Of frmPassword    to sPassword
55330>>>            Get Value Of frmDirectory   to sDir
55331>>>            Move (Trim(sFtp))           to sFtp
55332>>>            Move (Trim(sUser))          to sUser
55333>>>            Move (Trim(sPassword))      to sPassword
55334>>>            Move (Trim(sDir))           to sDir
55335>>>            Clear TmpSel
55336>>>            Move '1' to TmpSel.Is_Selected
55337>>>            Find Gt TmpSel By Index.2 // TmpSel:Index.2:Is_Selected+Full_Path_Name
55338>>>>
55338>>>            If ((Found=1) And (TmpSel.Is_Selected='1')) Begin
55340>>>                If ((sFtp<>'')      And (sUser<>'') And ;                    (sPassword<>'') And (sDir<>'')) Function_Return 1
55343>>>                Else Begin
55344>>>                    Function_Return 0
55345>>>                End
55345>>>>
55345>>>            End
55345>>>>
55345>>>            Else Function_Return -1
55347>>>        End_Function
55348>>>        
55348>>>        Procedure OnClick
55350>>>            Integer isOK rVal iMetr iRecnum iFileRetreived isAvailable iStat
55351>>>            String  sFtp sUser sPassword sDir sConnectString sConnectCommand
55351>>>            String  sBranchSendPathFiles sBranchSendPathConf sLocalFile sRemoteFile
55351>>>            String  sSysfileFilesSendPath sFullFileName sFileName sStr
55351>>>            Integer isConnected iSelectCount iInt iSelRec iErr iClientId iObj
55351>>>        
55351>>>            Set Value of frmMessage Item 0 to ''
55352>>>            Send Delete_Data    to oStatusForm
55353>>>            Send Paint          to oStatusForm
55354>>>        
55354>>>            Clear Branch
55355>>>            Move Syscurxr.Company_Code      to Branch.Company_Code
55356>>>            Move Syscurxr.Branch_Code       to Branch.Branch_Code
55357>>>            Find Eq Branch By Index.1
55358>>>>
55358>>>        
55358>>>            Move Branch.SEND_PATH_FILES     to sBranchSendPathFiles
55359>>>            Move Branch.SEND_PATH_CONF      to sBranchSendPathConf
55360>>>            Move Sysfile.FILES_SEND_PATH    to sSysfileFilesSendPath
55361>>>        
55361>>>            Get Value Of frmAddress     to sFtp
55362>>>            Get Value Of frmUserName    to sUser
55363>>>            Get Value Of frmPassword    to sPassword
55364>>>            Get Value Of frmDirectory   to sDir
55365>>>        
55365>>>            Move (Trim(sFtp))           to sFtp
55366>>>            Move (Trim(sUser))          to sUser
55367>>>            Move (Trim(sPassword))      to sPassword
55368>>>            Move (Trim(sDir))           to sDir
55369>>>        
55369>>>            Move sSysfileFilesSendPath  to sLocalFile
55370>>>            Move (Trim(sLocalFile))     to sLocalFile
55371>>>            Append sLocalFile 'zsok.txt'
55372>>>            Move (Trim(sLocalFile)) to sLocalFile
55373>>>            EraseFile sLocalFile
55374>>>>
55374>>>        
55374>>>            Move sSysfileFilesSendPath  to sLocalFile
55375>>>            Move (Trim(sLocalFile))     to sLocalFile
55376>>>            Append sLocalFile 'zsendd.txt'
55377>>>            EraseFile sLocalFile
55378>>>>
55378>>>        
55378>>>            Move sSysfileFilesSendPath  to sLocalFile
55379>>>            Move (Trim(sLocalFile))     to sLocalFile
55380>>>            Append sLocalFile 'zbtnemp.txt'
55381>>>            EraseFile sLocalFile
55382>>>>
55382>>>        
55382>>>            EraseFile 'C:\Welcome.txt'
55383>>>>
55383>>>            Send Delete_Data    to oStatusForm
55384>>>            Set Value of frmMessage Item 0 to ''
55385>>>        
55385>>>            Get fiFTPVerify to isOK
55386>>>        
55386>>>            If (isOK=1) Begin
55388>>>        
55388>>>        //////////////////////////////////////////////////////////////////
55388>>>                If (psBranchPhone(self)<>'') Begin
55390>>>        
55390>>>                   set bConnectionStatus to FALSE
55391>>>        
55391>>>                   //first get the connect state of the local system
55391>>>                   move (dvInternetGetConnectedState()) to iStat
ERROR: 54 Invalid symbol in expression DVINTERNETGETCONNECTEDSTATE ON LINE: 1055 (55391) OF FILE: L:\VDF6\Develop\Empor\AppSrc\FTPVIEW.VW
55392>>>        
55392>>>                   if iStat eq 4 begin
55394>>>                      send Info_Box "’¦ modem œå¤˜  ˜§˜©®¦¢ž£â¤¦." "¢ž¨¦­¦¨å˜"
55395>>>                      procedure_return
55396>>>                   end
55396>>>>
55396>>>        
55396>>>                   If iStat eq 0 begin
55398>>>                      // there is no Internet connection and the modem is not busy, so let's dial...
55398>>>                      // phonebook entry this would be something like this
55398>>>                      // move (dvInternetAutodial()) to iStat
55398>>>                      move (dvInternetDial((psBranchPhone(self)))) to iStat
ERROR: 54 Invalid symbol in expression DVINTERNETDIAL ON LINE: 1066 (55398) OF FILE: L:\VDF6\Develop\Empor\AppSrc\FTPVIEW.VW
55399>>>        
55399>>>                      If iStat eq 0 set bConnectionStatus to True
55402>>>                      Else Begin
55403>>>                         Send Info_Box "† ©ç¤›œ©ž ›œ¤ £§¦¨œå ¤˜ ¦¢¦¡¢ž¨àŸœå" "¢ž¨¦­¦¨å˜"
55404>>>                         Procedure_Return
55405>>>                      End
55405>>>>
55405>>>                   End
55405>>>>
55405>>>        
55405>>>                End
55405>>>>
55405>>>        
55405>>>                Move '' to sConnectCommand
55406>>>                Move '' to sConnectString
55407>>>        
55407>>>                send AddInfo to (oStatusForm (Self)) ("‘ç¤›œ©ž "*sFtp-"...")
55408>>>        
55408>>>                // Connect to ftp site
55408>>>                if (trim(sFtp)<>'') begin
55410>>>                    if ( sUser<>"") begin
55412>>>                       //Get dvInternetConnect sFtp sUser sPassword 0 to rVal
55412>>>                       Move (dvInternetConnect(sFtp,sUser,sPassword,0)) to rVal
ERROR: 54 Invalid symbol in expression DVINTERNETCONNECT ON LINE: 1086 (55412) OF FILE: L:\VDF6\Develop\Empor\AppSrc\FTPVIEW.VW
55413>>>                    end
55413>>>>
55413>>>                    else move (dvInternetConnect(sFtp,"","",0)) to rVal //anonymous login
ERROR: 54 Invalid symbol in expression DVINTERNETCONNECT ON LINE: 1088 (55413) OF FILE: L:\VDF6\Develop\Empor\AppSrc\FTPVIEW.VW
55415>>>                    //Else Get dvInternetConnect sFtp "" "" 0 to rVal
55415>>>                end
55415>>>>
55415>>>                if rVal begin
55417>>>                    send ShowInternetErrorMessage rVal
55418>>>                    Get fiCloseDialup to iStat
55419>>>                    procedure_return
55420>>>                end
55420>>>>
55420>>>        
55420>>>                Move 'Welcome.txt'      to sRemoteFile
55421>>>                Move 'C:\Welcome.txt'   to sLocalFile
55422>>>                Get fiGetFile Of FtpView sRemoteFile sLocalFile 0 1 to rVal
55423>>>                If (rVal) Begin
55425>>>                    Send ShowInternetErrorMessage rVal
55426>>>                    Get fiCloseDialup to iStat
55427>>>                    //If (psBranchPhone(self)<>'') Send CloseDialUp Of MyRas
55427>>>                    //Send RasXComDisConnect Of MyRas
55427>>>                    Procedure_Return
55428>>>                End
55428>>>>
55428>>>        
55428>>>                Direct_Input    Channel 9 sLocalFile
55430>>>                Readln          Channel 9 sStr
55432>>>                Close_Input     Channel 9
55434>>>                Set Value of frmMessage Item 0 to (Trim(sStr))
55435>>>        
55435>>>                Move 0 to iInt
55436>>>                Move 0 to iSelectCount
55437>>>                Clear TmpSel
55438>>>                Move '1' to TmpSel.Is_Selected
55439>>>                Find Gt TmpSel By Index.2 // TmpSel:Index.2:Is_Selected+Full_Path_Name
55440>>>>
55440>>>                While ((Found=1) And (TmpSel.Is_Selected='1'))
55444>>>                    Add 1 to iSelectCount
55445>>>                    Find Gt TmpSel By Index.2 // TmpSel:Index.2:Is_Selected+Full_Path_Name
55446>>>>
55446>>>                Loop
55447>>>>
55447>>>        
55447>>>                If (iSelectCount>0) Begin
55449>>>                    Clear TmpSel
55450>>>                    Move '1' to TmpSel.Is_Selected
55451>>>                    Find Gt TmpSel By Index.2 // TmpSel:Index.2:Is_Selected+Full_Path_Name
55452>>>>
55452>>>                    While ((Found=1) And (TmpSel.Is_Selected='1'))
55456>>>                        Move (Trim(TmpSel.Full_Path_Name))                  to sFullFileName
55457>>>                        Move (Trim(fsReturnFileFromPath(sFullFileName)))    to sFileName
55458>>>                        Move sFullFileName  to sLocalFile
55459>>>                        Move sFileName      to sRemoteFile
55460>>>        //                Insert '/' in sRemoteFile   at 1
55460>>>                        Insert sDir in sRemoteFile  at 1
55462>>>                        Get fiSendFile Of FtpView sLocalFile sRemoteFile 1 to rVal
55463>>>                        If (rVal) Begin
55465>>>                            Send ShowInternetErrorMessage rVal
55466>>>                            Get fiCloseDialup to iStat
55467>>>                            //If (psBranchPhone(self)<>'') Send CloseDialUp Of MyRas
55467>>>                            //Send RasXComDisConnect Of MyRas
55467>>>                            Procedure_Return
55468>>>                        End
55468>>>>
55468>>>                        Find Gt TmpSel By Index.2 // TmpSel:Index.2:Is_Selected+Full_Path_Name
55469>>>>
55469>>>                    Loop
55470>>>>
55470>>>        
55470>>>                    // Prepare zsok.txt filename
55470>>>                    Move sSysfileFilesSendPath                  to sLocalFile
55471>>>                    Move (Trim(sLocalFile))                     to sLocalFile
55472>>>                    Append sLocalFile 'zsok.txt'
55473>>>                    Move (Trim(sLocalFile))                     to sLocalFile
55474>>>        
55474>>>                    Move (Trim(sBranchSendPathConf)+'zsok.txt') to sRemoteFile
55475>>>        
55475>>>                    // Create zsok.txt file
55475>>>                    Direct_Output   Channel 9 sLocalFile
55477>>>                    Write           Channel 9 '1234'
55479>>>                    Writeln         Channel 9
55481>>>                    Close_Output    Channel 9
55483>>>        
55483>>>                    // Send zsok.txt file
55483>>>                    Get fiSendFile Of FtpView sLocalFile sRemoteFile 1 to rVal
55484>>>                    If (rVal) Begin
55486>>>                        Send ShowInternetErrorMessage rVal
55487>>>                        Get fiCloseDialup to iStat
55488>>>                        //If (psBranchPhone(self)<>'') Send CloseDialUp Of MyRas
55488>>>                        //Send RasXComDisConnect Of MyRas
55488>>>                        Procedure_Return
55489>>>                    End
55489>>>>
55489>>>        
55489>>>                    // Prepare zrok.txt filename
55489>>>                    Move (Trim(sSysfileFilesSendPath))  to sLocalFile
55490>>>                    Append sLocalFile 'zrok.txt'
55491>>>                    Move (Trim(sBranchSendPathConf)+'zrok.txt') to sRemoteFile
55492>>>        
55492>>>                    // Delete previous local zrok.txt
55492>>>                    EraseFile sLocalFile
55493>>>>
55493>>>        
55493>>>                    // Call timer event to bring zrok.txt file
55493>>>                    // Program flow control continues in Stop_Timer
55493>>>                    Send Start_Timer sRemoteFile sLocalFile
55494>>>        
55494>>>                End
55494>>>>
55494>>>                Else Begin
55495>>>                    Send Info_Box 'ƒœ¤ ™¨âŸž¡œ ˜¨®œå¦ §¨¦ª ˜§¦©«¦¢ã'
55496>>>                    Get fiCloseDialup to iStat
55497>>>                    //If (psBranchPhone(self)<>'') Send CloseDialUp Of MyRas
55497>>>                    //Send RasXComDisConnect Of MyRas
55497>>>                    Procedure_Return
55498>>>                End
55498>>>>
55498>>>            End
55498>>>>
55498>>>            Else Begin
55499>>>                If (isOK=(-1)) Begin
55501>>>                    Send Info_Box "ƒœ¤ ™¨âŸž¡œ ¡á§¦ ˜ œ§ ¢œš£â¤ž œšš¨˜­ã"
55502>>>                End
55502>>>>
55502>>>                Else If (sFtp='') Begin
55505>>>                    Send Info_Box "FTP Address field is empty"
55506>>>                    Send Activate to frmAddress
55507>>>                End
55507>>>>
55507>>>                Else If (sUser='') Begin
55510>>>                    Send Info_Box "User field is empty"
55511>>>                    Send Activate to frmUserName
55512>>>                End
55512>>>>
55512>>>                Else If (sPassword='') Begin
55515>>>                    Send Info_Box "Password field is empty"
55516>>>                    Send Activate to frmPassword
55517>>>                End
55517>>>>
55517>>>                Else If (sDir='') Begin
55520>>>                    Send Info_Box "Directory field is empty"
55521>>>                    Send Activate to frmDirectory
55522>>>                End
55522>>>>
55522>>>            End
55522>>>>
55522>>>        End_Procedure // OnClick
55523>>>        
55523>>>        
55523>>>        
55523>>>        
55523>>>        
55523>>>        
55523>>>        
55523>>>        
55523>>>        
55523>>>        
55523>>>        
55523>>>        
55523>>>        
55523>>>        
55523>>>        
55523>>>        
55523>>>        
55523>>>        //AB-StoreEnd
55523>>>
55523>>>    End_Object    // btn_Connect
55524>>>
55524>>>    Object oStatusForm is a editSub
55526>>>        Set Size to 28 254
55527>>>        Set Location to 191 210
55528>>>        Set Color to clBtnFace
55529>>>        Set Enabled_State to FALSE
55530>>>        Set Read_Only_State to TRUE
55531>>>
55531>>>        //AB-StoreStart
55531>>>                                
55531>>>        Procedure AddInfo string sInfo
55533>>>            Send beginning_of_data
55534>>>            append sInfo (character(13)+character(10))
55535>>>            send insert sInfo
55536>>>            send paint
55537>>>        End_Procedure
55538>>>        
55538>>>        
55538>>>        //AB-StoreEnd
55538>>>
55538>>>    End_Object    // oStatusForm
55539>>>
55539>>>    Object btnSelectFolder is a ButtonSub
55541>>>
55541>>>        //AB-StoreTopStart
55541>>>                                
55541>>>                                
55541>>>        //AB-StoreTopEnd
55541>>>
55541>>>        Set Label to "„§ ¢¦šã ­˜¡â¢¢¦¬"
55542>>>        Set Size to 14 137
55543>>>        Set Location to 2 165
55544>>>        Set Focus_Mode to Pointer_Only
55545>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
55546>>>
55546>>>        //AB-StoreStart
55546>>>                                
55546>>>        Set Visible_State to False
55547>>>        
55547>>>        Procedure OnClick
55549>>>            Integer iInt
55550>>>            String sStr sStr2
55550>>>            //Send Activate to oDirectoryPicker
55550>>>            SET DPDlgPath Of oDirectoryPicker to (Trim(Sysfile.Files_Send_Path))
55551>>>            //SET DPDlgPath Of oDirectoryPicker to (ToAnsi(fsGetLastDir()))
55551>>>            Move (DPDlgShow(oDirectoryPicker(Self)))  to sStr
ERROR: 54 Invalid symbol in expression DPDLGSHOW ON LINE: 1277 (55551) OF FILE: L:\VDF6\Develop\Empor\AppSrc\FTPVIEW.VW
55552>>>            GET DPDlgPath Of (oDirectoryPicker(Self)) to sStr2  // Full Path
55553>>>            Move (Trim(sStr2)) to sStr2
55554>>>            Set piCount                     to 0
55555>>>            If (sStr2<>'')  Begin
55557>>>                Set Value Of FormSub1 Item 0 to (Uppercase(TOOEM(sStr2)))
55558>>>        
55558>>>                Clear TmpSel
55559>>>                Find Gt Tmpsel.recnum
55560>>>>
55560>>>                While (Found=1)
55564>>>                    Delete TmpSel
55565>>>                    Find Gt Tmpsel.recnum
55566>>>>
55566>>>                Loop
55567>>>>
55567>>>        
55567>>>                Get fiPutLastDir (TOOEM(sStr2)) to iInt
55568>>>                Send OnClick                  to btnFillList
55569>>>            End
55569>>>>
55569>>>            Else Set Value Of FormSub1 Item 0 to ''
55571>>>        End_Procedure // OnClick
55572>>>        
55572>>>        //AB-StoreEnd
55572>>>
55572>>>    End_Object    // btnSelectFolder
55573>>>
55573>>>    Object FormSub1 is a FormSub
55575>>>        Set Size to 13 157
55576>>>        Set Location to 2 306
55577>>>        Set Color to clBtnFace
55578>>>        Set Label_Col_Offset to 2
55579>>>        Set Enabled_State to FALSE
55580>>>        Set Form_FontHeight Item 0 to 14
55581>>>        Set Form_FontWeight Item 0 to 600
55582>>>        Set Form_TypeFace Item 0 to "Arial"
55583>>>        Set Implicit_Shadow_State to TRUE
55584>>>        Set Item_Shadow_State Item 0 to TRUE
55585>>>        Set Shadow_State Item 0 to TRUE
55586>>>
55586>>>        //AB-StoreStart
55586>>>                                
55586>>>        Set Visible_State to False
55587>>>        
55587>>>        //AB-StoreEnd
55587>>>
55587>>>    End_Object    // FormSub1
55588>>>
55588>>>    Object BtnFillList is a ButtonSub
55590>>>        Set Label to "Fill List With all Multimedia Files"
55591>>>        Set Size to 14 263
55592>>>        Set Location to 2 4
55593>>>        Set Focus_Mode to Pointer_Only
55594>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
55595>>>
55595>>>        //AB-StoreStart
55595>>>                                
55595>>>        Set Visible_State to False
55596>>>        
55596>>>        Procedure OnClick
55598>>>            Integer isRecursive iInt
55599>>>            String sExt sFrom
55599>>>        
55599>>>            Send Cursor_Wait to (Cursor_Control(Self))
55600>>>        
55600>>>            Move (Uppercase(Value(FormSub1(Self),0)))   to sFrom
55601>>>            Move (Trim(sFrom))                          to sFrom
55602>>>        
55602>>>            If ((Uppercase(Left(sFrom,2))='A:') Or ((sFrom<>'') And (Length(sFrom)>3))) Begin
55604>>>                Move '*.*' to sExt
55605>>>                Set xfindSearchString          Of oRecursiveFileFinder   to (Trim(sExt))
55606>>>                Set xfindSearchFrom            Of oRecursiveFileFinder   to sFrom
55607>>>                Set xfindSearchSubDirs         Of oRecursiveFileFinder   to (isRecursive)
55608>>>                Send xfindStartSearching       to oRecursiveFileFinder
55609>>>            End
55609>>>>
55609>>>            Send Beginning_Of_Data to dbGridSub1
55610>>>            Send Cursor_Ready to (Cursor_Control(Self))
55611>>>        End_Procedure // OnClick
55612>>>        
55612>>>        //AB-StoreEnd
55612>>>
55612>>>    End_Object    // BtnFillList
55613>>>
55613>>>    Object dbGridSub1 is a dbGridSub
55615>>>
55615>>>        //AB-StoreTopStart
55615>>>                                
55615>>>        //AB-StoreTopEnd
55615>>>
55615>>>        Set Main_File to Tmpsel.File_Number
55616>>>        Set Ordering to 1
55617>>>        Set Size to 161 458
55618>>>        Set Location to 28 5
55619>>>        Set Wrap_State to TRUE
55620>>>        Set No_Create_State to TRUE
55621>>>        Set No_Delete_State to TRUE
55622>>>        Set Validate_Mode to Validate_Default
55623>>>
55623>>>        Begin_Row
55626>>>            Entry_Item Tmpsel.Is_selected
55627>>>            Entry_Item Tmpsel.Pathname
55628>>>            Entry_Item Tmpsel.Filename
55629>>>            Entry_Item Tmpsel.Extension
55630>>>            Entry_Item Tmpsel.Full_path_name
55631>>>        End_Row
55636>>>
55636>>>        Set Form_Width    item 0 to 14
55637>>>        Set Header_Label  item 0 to "„"
55638>>>        Set Column_Checkbox_State  item 0 to True
55639>>>        
55639>>>        Set Form_Width    item 1 to 129
55640>>>        Set Header_Label  item 1 to "”á¡œ¢¢¦ª"
55641>>>        
55641>>>        Set Form_Width    item 2 to 65
55642>>>        Set Header_Label  item 2 to "€¨®œå¦"
55643>>>        
55643>>>        Set Form_Width    item 3 to 32
55644>>>        Set Header_Label  item 3 to "•˜¨"
55645>>>        
55645>>>        Set Form_Width    item 4 to 211
55646>>>        Set Header_Label  item 4 to "¢ã¨œª æ¤¦£˜"
55647>>>        
55647>>>
55647>>>        //AB-StoreStart
55647>>>                                
55647>>>        set currentrowcolor  to 11468799
55648>>>        set currentcellcolor to 11468799
55649>>>        
55649>>>        Procedure Find_Poses
55651>>>            Local Number cCount iFs iCount
55652>>>            File_Size tmpSel to iFs
55655>>>            Get Select_Count Of dbGridSub1 to cCount
55656>>>            If (iFs) Begin
55658>>>                If (cCount) Set Label Of btn_Select to ("Deselect all "+(String(cCount))+" File(s)")
55661>>>                Else        Set Label Of btn_Select to ("Select all "  +(String(iFs))   +" File(s)")
55663>>>            End
55663>>>>
55663>>>            Else Set Label Of btn_Select to ("Select all "  +(String(iFs))   +" File(s)")
55665>>>            Set piCount to cCount
55666>>>            Set Label of txtCount to (piCount(Self))
55667>>>        End_Procedure
55668>>>        
55668>>>        Procedure Select_Toggling Integer i1 Integer i2
55670>>>            Local integer cCount bState iBase iFs
55671>>>            Local integer iCol
55671>>>            Forward Send Select_Toggling i1 i2
55673>>>            If (Should_Save(TmpSel_DD(Self))) Send Request_Save to TmpSel_DD
55676>>>            Send Find_Poses
55677>>>        End_Procedure
55678>>>        
55678>>>        //Procedure Entry_Display Integer i1 Integer i2
55678>>>        //    Integer iBase iInt iRec
55678>>>        //    String sStr
55678>>>        //    Forward Send Entry_Display i1 i2
55678>>>        //    //Send Find_Poses
55678>>>        //End_Procedure
55678>>>        
55678>>>        //AB-StoreEnd
55678>>>
55678>>>    End_Object    // dbGridSub1
55679>>>
55679>>>    Object txtSel is a TextBoxSub
55681>>>        Set Label to "„§ ¢œš£â¤˜"
55682>>>        Set Location to 172 4
55683>>>        Set Size to 10 39
55684>>>        Set Justification_Mode to jMode_Right
55685>>>        Set TypeFace to "MS Sans Serif"
55686>>>
55686>>>        //AB-StoreStart
55686>>>                                
55686>>>        Set Visible_State to False
55687>>>        
55687>>>        //AB-StoreEnd
55687>>>
55687>>>    End_Object    // txtSel
55688>>>
55688>>>    Object txtCount is a TextBoxSub
55690>>>        Set Label to "label"
55691>>>        Set Location to 172 48
55692>>>        Set Size to 10 18
55693>>>        Set Justification_Mode to jMode_Right
55694>>>        Set TypeFace to "MS Sans Serif"
55695>>>
55695>>>        //AB-StoreStart
55695>>>        Set Label to ''
55696>>>        
55696>>>        Set Visible_State to False
55697>>>        
55697>>>        //AB-StoreEnd
55697>>>
55697>>>    End_Object    // txtCount
55698>>>
55698>>>    Object btn_Select is a ButtonSub
55700>>>        Set Label to "„§ ¢¦šã æ¢à¤"
55701>>>        Set Size to 14 195
55702>>>        Set Location to 172 136
55703>>>        Set Focus_Mode to Pointer_Only
55704>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
55705>>>
55705>>>        //AB-StoreStart
55705>>>                                
55705>>>        Set Visible_State to False
55706>>>        
55706>>>        Set Focus_Mode to Pointer_Only
55707>>>        
55707>>>        Procedure Select_All
55709>>>            Integer cCount
55710>>>            Number iFs
55710>>>            File_Size tmpSel to iFs
55713>>>            Set Dynamic_Update_State to False
55714>>>            Send Clear  to Tmpsel_DD2
ERROR: 52 Bad format of expression (operator)  ON LINE: 1483 (55714) OF FILE: L:\VDF6\Develop\Empor\AppSrc\FTPVIEW.VW
ERROR: 4121 Operation aborted  ON LINE: 1483 (55714) OF FILE: L:\VDF6\Develop\Empor\AppSrc\FTPVIEW.VW
Summary
Memory Available: 2147483647
Total Errors   : 12
Total Symbols  : 28234
Total Resources: 0
Total Commands : 55713
Total Windows  : 1
Total Pages    : 1
Static Data    : 392550
Message area   : 320400
Total Blocks   : 18084
12 ERRORS HAVE BEEN FOUND.
