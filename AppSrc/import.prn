Compiling Program: C:\Vdf6\Develop\Empor\AppSrc\import.src
Memory Available: 2147483647
1>Use AllEntSc
Using pre-compiled package ALLENTSC
INCLUDING FILE: ALLENTSC.PKD
30262>
30262>Register_Object Client_Area
30262>
30262>//AB-StoreTopStart
30262>Use Workspc.pkg
30262>
30262>//  Set date attributes as needed
30262>Set_Date_Attribute sysdate4_State to (TRUE)
30263>Set_Date_Attribute Date4_State    to (TRUE)
30264>Set_Date_Attribute epoch_value    to 30
30265>
30265>Object ProgramWorkspace is a WorkspaceSub
30267>    Set WorkspaceName to CURRENT$WORKSPACE
30268>    Set kEnter_Next_State to True
30269>//    Set ModuleName    to 'ProgramName' // Special module name.
30269>//    Set HelpName      to 'HelpName.hlp'// Please provide the name of your Windows help file.
30269>End_Object
30270>
30270>Use Help_Ids.inc // Developer should provide this file of help context links.
INCLUDING FILE: HELP_IDS.INC
30270>>>// Help_ids.inc
30270>>>//
30270>>>// Context ids for the order entry system. This uses
30270>>>// help file ordentry.hlp.
30270>>>//
30270>>>// This is a sample version. YOU must supply
30270>>>// the ID values
30270>>>
30270>>>//  Generic Context Ids
30270>>>//
30270>>>
30270>>>// It is expected that file-names ids will be the same as their
30270>>>// filenumber.
30270>>>
30270>>>
30270>>>//  View and selection-list specific context ids
30270>>>//
30270>>>//..........add view, object, selection-list ids here....
30270>Use Std_Help.pkg
INCLUDING FILE: STD_HELP.PKG
30270>>>// STD_HELP.PKG
30270>>>//
30270>>>// Global Help Object
30270>>>//
30270>>>//  Creates all Help Support required to access WINDOWs help system
30270>>>//  with DataFlex. Creates a global object named Help_Object.
30270>>>//
30270>>>//  9/19/97 JJT - Modified to define stadnard help Ids if they are undefined
30270>>>
30270>>>use DFHlpSys // Context Sensitive Help Support
30270>>>
30270>>>
30270>>>// This file needs to be provided by the developer. It will contain
30270>>>// symbolic replacements for the ID integer values used to access the
30270>>>// the windows help file's topics.
30270>>>//
30270>>>use Help_ids.inc
30270>>>
30270>>>// If the following are not defined in help_ids.inc,
30270>>>//  create default 0 values for them
30270>>>Define GeneralHelpId    for    0
30270>>>Define KeysHelpId       for    0
30270>>>Define FileHelpId       for    0
30270>>>Define ErrorHelpId      for    0  // probably not used in VDF
30270>>>Define IndexHelpId      for    0  // probably not used in VDF
30270>>>
30270>>>object Help_Object is a HelpSystem // global help object
30272>>>
30272>>>   Set Help_Id_General to GeneralHelpId    // these should all be defined
30273>>>   Set Help_Id_Index   to IndexHelpId      // in help_ids.inc.
30274>>>   Set Help_Id_Keys    to KeysHelpId       //
30275>>>   Set Help_Id_Files   to FileHelpId       //
30276>>>   Set Help_Id_Errors  to ErrorHelpId      //
30277>>>
30277>>>end_object
30278>
30278>// General Functions-Procedures and Variables
30278>Use Globals.Inc
INCLUDING FILE: GLOBALS.INC
30278>>>
30278>>>        String  gs_Selected_Company_Code
30278>>>        String  gs_Selected_Branch_Code
30278>>>        Integer gi_Selected_Year
30278>>>        String gs_Selected_Year_Recr
30278>>>        String  gs_Module_Code
30278>>>
30278>>>
30278>>>//Open Currency
30278>>>//Function CurrDigits Global String asCurr Returns Integer
30278>>>//    Integer liDecX
30278>>>//    Clear Currency
30278>>>//    move asCurr to Currency.Currency_C_Code
30278>>>//    Find Eq Currency By Index.1
30278>>>//    move Currency.Currency_Dec to liDecX
30278>>>//    Function_Return liDecX
30278>>>//End_Function // CurrDigits
30278>>>
30278>>>Open Nomisma
INCLUDING FILE: NOMISMA.FD
30280>>>Open SysCurXr
INCLUDING FILE: SYSCURXR.FD
30282>>>
30282>>>Function fiDekadika_Nomismatos Global String asNomisma Returns Integer
30283>>>    Move (Trim(asNomisma)) to asNomisma
30284>>>    Clear Nomisma
30285>>>    If ( asNomisma<>'' ) Move asNomisma         to Nomisma.Nomisma_Code
30288>>>    Else                 Move SysCurXr.C_Code0  to Nomisma.Nomisma_Code
30290>>>    Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
30291>>>>
30291>>>    Function_Return Nomisma.Dekadika
30292>>>End_Function //
30293>>>
30293>>>Function fsgCode_W_Zeroes Global Integer aiCode Integer aiPlaces Returns String
30294>>>    String rVal
30295>>>    Integer iLength iInt
30295>>>    Move aiCode to rVal
30296>>>    Move (trim(rVal)) to rVal
30297>>>    For iInt From 1 to (aiPlaces-(Length(rVal)))
30303>>>>
30303>>>        Move (Insert('0',rVal,1)) to rVal
30304>>>    Loop
30305>>>>
30305>>>    Function_Return rVal
30306>>>End_Function
30307>>>
30307>>>Function fsgCode_n_Zeroes Global number aiCode Integer aiPlaces Returns String
30308>>>    String rVal
30309>>>    Integer iLength iInt ipos
30309>>>    Move aiCode to rVal
30310>>>    Move (trim(rVal)) to rVal
30311>>>    MOVE (aiPlaces-(Length(rVal))) to ipos
30312>>>    For iInt From 1 to ipos
30318>>>>
30318>>>        Move (Insert('0',rVal,1)) to rVal
30319>>>    Loop
30320>>>>
30320>>>    Function_Return rVal
30321>>>End_Function
30322>>>
30322>>>
30322>>>Open Year
INCLUDING FILE: YEAR.FD
30324>>>Procedure EnumDDsForRebuildConstrain for DataDictionary integer aiMsg integer ahId
30325>>>    Send aiMsg to Self
30326>>>End_Procedure
30327>>>
30327>>>Procedure DoRefindYear for baseclass Integer aiPanel Integer aiYearDD
30328>>>    Integer liChanged
30329>>>
30329>>>    If ((aiYearDD = 0) or (Main_File(aiYearDD)<>Year.File_Number)) ;        Procedure_Return (Message_Box("Invalid Year_DD","Developer's Warning",MB_OK,MB_ICONWARNING))
30332>>>    If (Not(Current_Record(aiYearDD))) Begin
30334>>>        Get Should_Save of aiPanel to liChanged
30335>>>        Send Clear to aiYearDD
30336>>>        Move gs_Selected_Company_Code to Year.Company_Code
30337>>>        Move gs_Selected_Branch_Code  to Year.Branch_Code
30338>>>        Move gi_Selected_Year         to Year.Year_Year
30339>>>        Send Find to aiYearDD Eq 1 //Year.Index.1 - company_code+ranch_code+year_year
30340>>>        If (Not(liChanged)) Set Changed_State of aiPanel to False
30343>>>    End
30343>>>>
30343>>>End_Procedure
30344>>>
30344>>>Procedure RebuildConstrainIfYearChanged for baseclass Integer aiPanel String asCurrentYearRecr Integer aiYearDDId
30345>>>    Integer liSrvr
30346>>>    String  lsCurrentYearRecr
30346>>>
30346>>>    If (asCurrentYearRecr <> gs_Selected_Year_Recr) Begin
30348>>>        Broadcast Send EnumDDsForRebuildConstrain to aiPanel msg_Rebuild_Constraints Self
30350>>>    End
30350>>>>
30350>>>    Send DoRefindYear aiPanel aiYearDDId //(Year_DD(Self))
30351>>>    Get Server of aiPanel to liSrvr
30352>>>    // Respects Default values
30352>>>    If (liSrvr) If (Not(Current_Record(liSrvr))) Send Request_Clear to aiPanel
30357>>>End_Procedure
30358>>>
30358>>>//                                       ’¦ View            Property «¦¬ View             ’¦ Year DDO «¦¬ View
30358>>>//                                                          Holds the current year rec0
30358>>>// ‰¢ã©ž : Send RbldConstrIfYearChanged (Gplan_Test(Self))  (psCurrentYearRecr(Self))     (Year_DD(Self))
30358>>>
30358>>>
30358>>>Function fiRefindYear Global Returns Integer
30359>>>    Clear Year
30360>>>    Move gs_Selected_Company_Code to Year.Company_Code
30361>>>    Move gs_Selected_Branch_Code  to Year.Branch_Code
30362>>>    Move gi_Selected_Year         to Year.Year_Year
30363>>>    Find eq Year by Index.1 //company_code+ranch_code+year_year
30364>>>>
30364>>>    Function_Return (Found = 0)
30365>>>End_Function //fiRefindYear
30366>>>
30366>>>Procedure DoRunApplication for Baseclass String sAppName
30367>>>    string sRuntime  lsStr
30368>>>
30368>>>    Append lsStr 'C:\Dns.bat ' sAppName
30370>>>    RunProgram Wait  lsStr
30371>>>
30371>>>//    get_profile_string "defaults" "VDFBinDir" to sRuntime
30371>>>//    append sRuntime "\dfrun " sAppName
30371>>>    Append sRuntime 'C:\Program Files\Accessories\WORDPAD.EXE ' sAppName
30373>>>    runprogram background sRuntime
30374>>>End_procedure // DoRunApplication
30375>>>
30375>>>// Run the Editor
30375>>>Procedure DoRunEditor for Baseclass String asFile
30376>>>    string sRunPath lsWspcName
30377>>>    Move (WorkspaceName(ProgramWorkspace(Self))) to lsWspcName
30378>>>    get_profile_string ("workspaces\"+lsWspcName) "programpath" to sRunPath
30381>>>    //append sRunPath "\Editor "  asFile //// js 15/03/2002 " " lsWspcName
30381>>>    Move (Replace('.',asFile,'')) to asFile
30382>>>    append sRunPath asFile //// js 15/03/2002 " " lsWspcName
30383>>>    send DoRunApplication sRunPath
30384>>>End_Procedure // DoRunEditor
30385>>>
30385>>>//--------------------------------------
30385>>>
30385>>>//start of global functions and procedures
30385>>>
30385>>>
30385>>>//®¨ž© £¦§¦ œå«˜  ˜§æ: ˜) gmoves.dd    :private.update_gmhnes_ghmnies
30385>>>Function gsfFind_Previous Global String lsCode;                                 String lsDelimiter;                                 Returns String
30386>>>         String  lsTemp_Code1 lsTemp_Code2
30387>>>         Integer liCounter
30387>>>
30387>>>         //1.˜­˜å¨œ©ž ¡œ¤é¤
30387>>>         Move (Trim(lsCode)) to lsCode                                  //§® 30.12.345
30388>>>
30388>>>         //2.˜¤« ©«¨¦­ã
30388>>>         For liCounter From 1 to (Length(lsCode))
30394>>>>
30394>>>             Move (Insert(;                           (Mid(lsCode,1,liCounter)),;                           lsTemp_Code1,;                           1;                         )) to lsTemp_Code1                             //§® 543.21.03
30395>>>         Loop
30396>>>>
30396>>>
30396>>>         //3.˜­˜å¨œ©ž ¡œ¤é¤ (›â¤ ®¨œ áœ«˜ , safety only)
30396>>>         Move (Trim(lsTemp_Code1)) to lsTemp_Code1
30397>>>
30397>>>         //4.§˜å¨¤à £æ¤¦ «¦ ›œ¥ æ £â¨¦ª «¦¬ ˜¤«å©«¨¦­¦¬, £œ«á «¦ §¨é«¦ delimiter
30397>>>         Move (Right(;                      lsTemp_Code1,;                      ((Length(lsTemp_Code1))-((Pos(lsDelimiter,lsTemp_Code1))));                    )) to lsTemp_Code1                                  // §® 21.03
30398>>>
30398>>>         //5.¥˜¤á ˜¤« ©«¨¦­ã «¦¬ ˜¤«å©«¨¦­¦¬
30398>>>         For liCounter from 1 to (Length(lsTemp_Code1))
30404>>>>
30404>>>             Move (Insert(;                           (Mid(lsTemp_Code1,1,liCounter)),;                           lsTemp_Code2,;                           1;                         )) to lsTemp_Code2                             //§® 30.12
30405>>>         Loop
30406>>>>
30406>>>
30406>>>         Function_Return (Trim(lsTemp_Code2))
30407>>>End_Function //gsffind_previous
30408>>>
30408>>>
30408>>>Function gifSystem_Check Returns Integer
30409>>>         Integer liF_Gtypkins liF_Garicls liF_Gmoves liF_Gplans liF_Gmhnes liF_Ghmnies
30410>>>         Integer liS_Gtypkins liS_Garicls liS_Gmoves liS_Gplans liS_Gmhnes liS_Ghmnies
30410>>>//       Clear Company
30410>>>//       Find Gt Company.Recnum
30410>>>//       While (Found = 1)
30410>>>//             Add Company.Company_NumGtypkin to liS_Gtypkins § Ÿ˜¤é© ©«¦ sysfile ¤˜ «˜ ¡˜¨˜«áà ˜¬«á
30410>>>//             Add Company.Company_NumGarticl to liS_Garticls
30410>>>//             Add Company.Company_NumGmoves  to liS_Gmoves
30410>>>//             //d Company.Company_NumGtypkin to liS_Gtypkins
30410>>>//             Add Company.Company_NumGplan   to liS_GPlans
30410>>>//             Add Company.Company_NumGmhnes  to liS_Gmhnes
30410>>>//             Add Company.Company_NumGhmnies to liS_Ghmnies
30410>>>//             Find Gt Company.Recnum
30410>>>//       Loop
30410>>>//
30410>>>//       Get_Attribute {attribute} [of {file-handle} ;
30410>>>//                        [{field-num} | {index-num} [{segment-num}]]] ;
30410>>>//                        To {variable}
30410>>>//
30410>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30410>>>//       Get_Attribute DF_FILE_RECORDS_USED of Garticl.File_Number to liF_Garticls
30410>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmoves.File_Number  to liF_Gmoves
30410>>>//       //t_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30410>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gplan.File_Number   to liF_Gplans
30410>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmhnes.File_Number  to liF_Gmhnes
30410>>>//       Get_Attribute DF_FILE_RECORDS_USED of Ghmnies.File_Number to liF_Ghmnies
30410>>>//
30410>>>
30410>>>//       //â¢œš®¦ª DF_FILE_MAX_RECORDS+ £œ records used
30410>>>
30410>>>//       //â¢œš®¦ª last rec0 = sysrec rec0
30410>>>
30410>>>    Function_Return 0
30411>>>End_Function //gifSystem_Check
30412>>>
30412>>>/////////////////////////////////////////////////////////////////
30412>>>//‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª, £œ ž ®à¨åª ›œ¡˜› ¡á  JS
30412>>>Function Sfi_All_Numbers Global Number anValue Integer aiLengthAkeraios Integer aiLengthDekadika Returns String
30413>>>
30413>>>    String  lsRetval lsValue lsAkeraios lsDekadika
30414>>>    Integer liInt liInteger iTimes iStart
30414>>>    Number  lnDecimals
30414>>>
30414>>>    Move (Integer(anValue))                                         to liInteger
30415>>>    Move (Round(AnValue-(Integer(anValue))*(10^aiLengthDekadika)))  to lnDecimals
30416>>>
30416>>>    Move liInteger              to lsAkeraios
30417>>>    Move lnDecimals             to lsDekadika
30418>>>    Move (Trim(lsAkeraios))     to lsAkeraios
30419>>>    Move (Trim(lsDekadika))     to lsDekadika
30420>>>
30420>>>    Move (Length(lsAkeraios)) to iStart
30421>>>    For iTimes From iStart to (aiLengthAkeraios-1)
30427>>>>
30427>>>        Insert "0" in lsAkeraios at 1
30429>>>    Loop
30430>>>>
30430>>>    Move (Trim(lsAkeraios)) to lsAkeraios
30431>>>
30431>>>    Move (Length(lsDekadika)) to iStart
30432>>>    For iTimes From iStart to (aiLengthDekadika-1)
30438>>>>
30438>>>        Move (Append(lsDekadika,"0")) to lsDekadika
30439>>>    Loop
30440>>>>
30440>>>    Move (Trim(lsDekadika)) to lsDekadika
30441>>>
30441>>>    If (aiLengthDekadika=0) Move '' to lsDekadika
30444>>>    Move '' to lsRetVal
30445>>>    Move (Pad((lsAkeraios-lsDekadika),(aiLengthAkeraios+aiLengthDekadika))) to lsRetval
30446>>>    Function_Return lsRetval
30447>>>End_Function //sfi_All_Numbers  ‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª
30448>>>              //                 £œ ž ®à¨åª ›œ¡˜› ¡á (JS)
30448>>>
30448>>>Open Codemast
30450>>>
30450>>>
30450>>>Function gsfCode_Mast Global String lsType String lsValue Returns String
30451>>>         Clear Codemast
30452>>>         Move lsType  to Codemast.Type
30453>>>         Move lsValue to Codemast.Code
30454>>>         Find Eq Codemast by Index.1 //type+code
30455>>>>
30455>>>         Function_Return Codemast.Description
30456>>>End_Function //code_mast
30457>>>
30457>>>
30457>>>Open Branch
INCLUDING FILE: BRANCH.FD
30459>>>Function fsgCode_With_Zeroes Global Integer aiCode    ;                                    Integer aiPlaces  ;                                    String asCompany  ;                                    String asBranch   ;                               Returns String
30460>>>    String rVal
30461>>>    Integer iInt
30461>>>    Clear Branch
30462>>>    Move asCompany  to Branch.Company_Code
30463>>>    Move asBranch   to Branch.Branch_Code
30464>>>    Find Eq Branch by Index.1
30465>>>>
30465>>>    If (Trim(Branch.Tomeas_Code)<>'') Move (Trim(Branch.Tomeas_Code)) to asBranch
30468>>>    Move (Trim(asCompany))  to asCompany
30469>>>    Move (Trim(asBranch))   to asBranch
30470>>>    If (Length(asCompany)=1) Insert '0' In asCompany At 1
30474>>>    If (Length(asBranch) =1) Insert '0' In asBranch  At 1
30478>>>    Move ''                                           to rVal
30479>>>    Move (Sfi_All_Numbers(aiCode,aiPlaces,0))         to rVal
30480>>>    Move (Append((asCompany+'.'+asBranch+'.'),rVal))  to rVal
30481>>>    Move (Trim(rVal))                                 to rVal
30482>>>    Function_Return rVal
30483>>>End_Function
30484>>>
30484>>>Function fsgStripCodeFromID Global String asID Returns Integer
30485>>>      Integer iLen iPos iInt
30486>>>      If (Trim(asID)='') Function_Return 0
30489>>>      Move (Trim  (asID)) to asID
30490>>>      Move (Length(asID)) to iLen
30491>>>      For iInt From 1     to iLen
30497>>>>
30497>>>          If (Mid(asID,1,iInt)='.') Move iInt to iPos
30500>>>      Loop
30501>>>>
30501>>>      Function_Return (Right(asID,(iLen-iPos)))
30502>>>End_Function
30503>>>
30503>>>Function fsCityDescr Global Integer aiCityID Returns String
30504>>>    String rVal
30505>>>    Open Cities
INCLUDING FILE: CITIES.FD
30507>>>    Clear Cities
30508>>>    Move aiCityID to Cities.City_ID
30509>>>    Find Eq Cities By Index.1
30510>>>>
30510>>>    If (Found=1) Move Cities.City_descr to rVal
30513>>>    Else         Move '' to rVal
30515>>>    Function_Return rVal
30516>>>End_Function
30517>>>
30517>>>Function fiTownIDFromCity Global Integer aiCityID Returns Integer
30518>>>    Open Cities
30520>>>    Clear Cities
30521>>>    Move aiCityID to Cities.City_ID
30522>>>    Find Eq Cities By Index.1
30523>>>>
30523>>>    Function_Return Cities.Town_ID
30524>>>End_Function
30525>>>
30525>>>Function fiCountryIDFromTown Global Integer aiTownID Returns Integer
30526>>>    Open Towns
INCLUDING FILE: TOWNS.FD
30528>>>    Clear Towns
30529>>>    Move aiTownID to Towns.Town_ID
30530>>>    Find Eq Towns By Index.1
30531>>>>
30531>>>    Function_Return Towns.Country_ID
30532>>>End_Function
30533>>>
30533>>>Function fsTownDescr Global Integer aiTownID Returns String
30534>>>    String rVal
30535>>>    Open Towns
30537>>>    Clear Towns
30538>>>    Move aiTownID to Towns.Town_ID
30539>>>    Find Eq Towns By Index.1
30540>>>>
30540>>>    If (Found=1) Move Towns.Town_descr to rVal
30543>>>    Else         Move '' to rVal
30545>>>    Function_Return rVal
30546>>>End_Function
30547>>>
30547>>>Function fsCountryDescr Global Integer aiCountryID Returns String
30548>>>    String rVal
30549>>>    Open Country
INCLUDING FILE: COUNTRY.FD
30551>>>    Clear Country
30552>>>    Move aiCountryID to Country.Country_ID
30553>>>    Find Eq Country By Index.1
30554>>>>
30554>>>    If (Found=1) Move Country.Country_descr to rVal
30557>>>    Else         Move '' to rVal
30559>>>    Function_Return rVal
30560>>>End_Function
30561>>>
30561>>>Function fsAreaDescr Global Integer aiAreaID Returns String
30562>>>    String rVal
30563>>>    Open Areas
INCLUDING FILE: AREAS.FD
30565>>>    Clear Areas
30566>>>    Move aiAreaID to Areas.Area_ID
30567>>>    Find Eq Areas By Index.1
30568>>>>
30568>>>    If (Found=1) Move Areas.Area_descr to rVal
30571>>>    Else         Move '' to rVal
30573>>>    Function_Return rVal
30574>>>End_Function
30575>>>
30575>>>Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
30576>>>    Local String rVal lsTmp lsOO lsLL
30577>>>    Local Number lnOO lnLL
30577>>>
30577>>>    Move '' to lsOO
30578>>>    Move '' to lsLL
30579>>>    Move '' to rVal
30580>>>
30580>>>    Move (Integer(anTime))                              to lnOO
30581>>>
30581>>>    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
30582>>>
30582>>>    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
30585>>>    Else         Move (String(lnOO))                    to lsOO
30587>>>    Move (Trim(lsOO))                                   to lsOO
30588>>>
30588>>>    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
30591>>>    Else         Move (String(lnLL))                    to lsLL
30593>>>    Move (Trim(lsLL))                                   to lsLL
30594>>>
30594>>>    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
30595>>>
30595>>>    Move (Trim(rVal)) to rVal
30596>>>
30596>>>    Function_Return rVal
30597>>>End_Function
30598>>>
30598>>>Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
30599>>>    Local Number rVal nOres nLepta
30600>>>    Move (Integer(aiMinutes/60))    to nOres
30601>>>    Move (    Mod(aiMinutes,60))    to nLepta
30602>>>    Move (nOres+(nLepta/100))       to rVal
30603>>>    Function_Return rVal
30604>>>End_Function
30605>>>
30605>>>Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
30606>>>    Local Integer rVal
30607>>>    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
30608>>>    Function_Return rVal
30609>>>End_Function
30610>>>
30610>>>Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;                                                                    Number anEndTime    ;                                                                    Returns Integer
30611>>>    Local Integer rVal iMinStart iMinEnd
30612>>>
30612>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30615>>>
30615>>>    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
30616>>>    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
30617>>>    Move (iMinEnd-iMinStart)                                                     to rVal
30618>>>    Function_Return rVal
30619>>>End_Function
30620>>>
30620>>>
30620>>>Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;                                                                Number anEndTime    ;                                                                Returns Number
30621>>>    Local Integer iTmp
30622>>>    Local Number  rVal
30622>>>
30622>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30625>>>
30625>>>    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
30626>>>    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
30627>>>    Function_Return rVal
30628>>>End_Function
30629>>>
30629>>>
30629>>>
30629>>>Open WitemCL
INCLUDING FILE: WITEMCL.FD
30631>>>Open WitemCld
INCLUDING FILE: WITEMCLD.FD
30633>>>Open WitemxT
INCLUDING FILE: WITEMXT.FD
30635>>>
30635>>>Function fnTeleytaiaTimhAgoras String asPromCode String asItemCode  ;                               Date   adHmnia    Number anQty       ;                               Returns Number
30636>>>  Integer iExodos
30637>>>  Number nPoso nPct
30637>>>  Move 0 to nPoso
30638>>>  Move 0 to nPct
30639>>>  Move 0 to iExodos
30640>>>
30640>>>  Move (Trim(asItemCode)) to asItemCode
30641>>>  Move (Trim(asPromCode)) to asPromCode
30642>>>
30642>>>  // 1.Anazhthsh sto arxeio Witemcld
30642>>>  Clear Witemcld
30643>>>  Move asItemCode to Witemcld.Item_Code
30644>>>  Move asPromCode to Witemcld.Client_Code
30645>>>  Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30646>>>>
30646>>>  While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;                       (Witemcld.Client_Code= asPromCode) And ;                       (iExodos=0))
30650>>>      If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
30652>>>          Move 1 to iExodos
30653>>>               If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
30656>>>          Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
30660>>>      End
30660>>>>
30660>>>      Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30661>>>>
30661>>>  Loop
30662>>>>
30662>>>  If (iExodos) Begin
30664>>>      If (nPoso) Function_Return nPoso
30667>>>      Else Function_Return nPct
30669>>>  End
30669>>>>
30669>>>
30669>>>  // 2.Anazhthsh sto arxeio Witemcl
30669>>>  Clear WitemCL
30670>>>  Move (Trim(asPromCode)) to WitemCL.Client_Code
30671>>>  Move (Trim(asItemCode)) to WitemCL.Item_Code
30672>>>  Find Eq WitemCL By Index.1
30673>>>>
30673>>>  If (Found=1) Function_Return WitemCL.Client_Price
30676>>>
30676>>>  Function_Return 0
30677>>>End_Function
30678>>>
30678>>>Open BtnOrdd
INCLUDING FILE: BTNORDD.FD
30680>>>Function fnTeleytaiaTimhPolhshs String asWitemxRecr String asClientID ;                                String asWitemxCode Date   adHmnia    ;                                String asItemCode   Number anQty      ;                                String asCNCode     Returns Number
30681>>>
30681>>>  Integer iExodos iCheckDeop
30682>>>  Number nPoso nPct
30682>>>
30682>>>  Move (Num_Arguments=7) to iCheckDeop
30683>>>
30683>>>  Move 0 to nPoso
30684>>>  Move 0 to nPct
30685>>>  Move 0 to iExodos
30686>>>
30686>>>  Move (Trim(asItemCode))                 to asItemCode
30687>>>  Move (Trim(asClientID))                 to asClientID
30688>>>  Move (Trim(asWitemxRecr))               to asWitemxRecr
30689>>>  Move (Trim(asWitemxCode))               to asWitemxCode
30690>>>  If (iCheckDeop) Move (Trim(asCNCode))   to asCNCode
30693>>>
30693>>>  // 1. Anazhthsh apo DEOP ef' oson yparxei kodikos ergou
30693>>>  If (iCheckDeop) Begin
30695>>>      Clear btnordd
30696>>>      Move asClientID   to btnordd.vclient_id
30697>>>      Move asCNCode     to btnordd.vcn_code
30698>>>      Move asWitemxCode to btnordd.vitem
30699>>>      Move 0            to btnordd.vactive
30700>>>      Move adHmnia      to btnordd.arxh_date
30701>>>      Find LE btnordd by index.4//client_id+cn_code+item+arxh_date
30702>>>>
30702>>>      If ((found=1) and (asWitemxCode=btnordd.vitem)    and (adHmnia>=btnordd.arxh_date) ;                    and (adHmnia<=btnordd.deop_date)    and (btnordd.vactive=0)          ;                    and (asCNCode=btnordd.vcn_code)) begin
30704>>>          move btnordd.vprice to nPoso
30705>>>          If (nPoso) Function_Return nPoso
30708>>>      End
30708>>>>
30708>>>  End
30708>>>>
30708>>>
30708>>>  // 2.Anazhthsh sto arxeio Witemcld (Timokatalogos Pelath/Eidous)
30708>>>  Clear Witemcld
30709>>>  Move asItemCode to Witemcld.Item_Code
30710>>>  Move asClientID to Witemcld.Client_Code
30711>>>  Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30712>>>>
30712>>>  While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;                       (Witemcld.Client_Code= asClientID) And ;                       (iExodos=0))
30716>>>      If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
30718>>>          Move 1 to iExodos
30719>>>               If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
30722>>>          Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
30726>>>      End
30726>>>>
30726>>>      Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30727>>>>
30727>>>  Loop
30728>>>>
30728>>>  If (iExodos) Begin
30730>>>      If (nPoso) Function_Return nPoso
30733>>>      Else Function_Return nPct
30735>>>  End
30735>>>>
30735>>>
30735>>>
30735>>>  // 3.Anazhthsh sto arxeio Witemxt (Timokatalogos Eidous)
30735>>>  Clear Witemxt
30736>>>  Move SysCurXr.Company_Code  to Witemxt.Company_Code
30737>>>  Move SysCurXr.Branch_Code   to Witemxt.Branch_Code
30738>>>  Move SysCurXr.Year_Year     to Witemxt.Year_Year
30739>>>  Move asWitemxRecr           to Witemxt.Witemx_Recr
30740>>>  Find Gt Witemxt By Index.1 // Witemxt:Index.1
30741>>>>
30741>>>  While ((Found=1) And (Witemxt.Company_Code = SysCurXr.Company_Code) And ;                       (Witemxt.Branch_Code  = SysCurXr.Branch_Code ) And ;                       (Witemxt.Year_Year    = SysCurXr.Year_Year   ) And ;                       (Witemxt.Witemx_Recr  = asWitemxRecr         ) And ;                       (iExodos=0))
30745>>>      If ((adHmnia>=Witemxt.Value_Date) And (anQty<=Witemxt.Qty)) Begin
30747>>>          Move 1 to iExodos
30748>>>               If (Witemxt.Axia0 <>0) Move  Witemxt.Axia0         to nPoso
30751>>>          Else If (Witemxt.PcDisc<>0) Move (Witemxt.PcDisc*(-1))  to nPct
30755>>>      End
30755>>>>
30755>>>      Find Gt Witemxt By Index.1 // Witemxt:Index.1
30756>>>>
30756>>>  Loop
30757>>>>
30757>>>  If (iExodos) Begin
30759>>>      If (nPoso) Function_Return nPoso
30762>>>      Else Function_Return nPct
30764>>>  End
30764>>>>
30764>>>
30764>>>
30764>>>  // 4.Anazhthsh sto arxeio Witemcl (Teleytaia Timh Agoras)
30764>>>  Clear WitemCL
30765>>>  Move (Trim(asClientID)) to WitemCL.Client_Code
30766>>>  Move (Trim(asItemCode)) to WitemCL.Item_Code
30767>>>  Find Eq WitemCL By Index.1
30768>>>>
30768>>>  If (Found=1) Function_Return WitemCL.Client_Price
30771>>>
30771>>>  Function_Return 0
30772>>>End_Function
30773>>>
30773>>>Function fsStripTextFieldFromEnter Global String asStr Returns String
30774>>>    String sEnter
30775>>>    Move '' to sEnter
30776>>>    Move (Trim(asStr)) to asStr
30777>>>    Append sEnter (Character(13)) (Character(10))
30779>>>    Move (Replaces(sEnter,asStr,' ')) to asStr
30780>>>    Function_return (Trim(asStr))
30781>>>End_function
30782>>>
30782>>>
30782>>>//end   of global functions and procedures
30782>>>Use Wait.DG
INCLUDING FILE: WAIT.DG
30782>>>>>USE AllEntSc
30782>>>>>
30782>>>>>//AB-IgnoreEnd
30782>>>>>
30782>>>>>
30782>>>>>//AB-IgnoreEnd
30782>>>>>
30782>>>>>Object Wait is a ModalPanelSub
30784>>>>>
30784>>>>>    //AB-StoreTopStart
30784>>>>>
30784>>>>>    // How to Use It
30784>>>>>    // Get the maximum position of the bar
30784>>>>>    // Move (Bar_Maximum_position(Wait(self))) to iMax
30784>>>>>    //
30784>>>>>    // Set the maximum position of the bar
30784>>>>>    // Set Bar_Maximum_position of (Wait(self)) to iMax
30784>>>>>    //
30784>>>>>    // Start Bar Progress from beginning
30784>>>>>    // Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
30784>>>>>    //
30784>>>>>    // End Bar Progress
30784>>>>>    // Send Bar_Current_Position to (Wait(Self)) iMax iMax iMax False
30784>>>>>    //
30784>>>>>    // Update Bar Progress
30784>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax True OR
30784>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax False
30784>>>>>    // When you want the update to be done for every i (this is slower)
30784>>>>>    // Where i=Counter's current value, icounter=Counter's Max Value and iMax=Bar Max Position
30784>>>>>    //
30784>>>>>    // Display Buttons on the object
30784>>>>>    // Set Button_State of (Wait(Self)) to False/True
30784>>>>>    // If the Progress Bar gets initialized without buttons, it MUST be Deactivated
30784>>>>>    //
30784>>>>>    // Initialization of the Progress Bar
30784>>>>>    // Send Popup to (Wait(Self))
30784>>>>>    //
30784>>>>>    // Deactivation of the Progress Bar
30784>>>>>    // Send Deactivate to (Wait(Self))
30784>>>>>    //
30784>>>>>    // Message during the process
30784>>>>>    // Set Wait_Message of (Wait(Self)) to "Now Processing..."
30784>>>>>    //
30784>>>>>    // Extra Info for button "Info >>"
30784>>>>>    // Send Wait_Details to (Wait(Self)) sFile sDetail bInitData
30784>>>>>    // If sFile<>'' then reads the contents of the file
30784>>>>>    // Else Fills the Edit with the string of sDetail
30784>>>>>    // If bInitData is True then the edit object is cleared first else extra info is appended
30784>>>>>    //
30784>>>>>    // Remarks instead of Progress Bar
30784>>>>>    // Set Button_State of (Wait(Self))     to False
30784>>>>>    // Set BarVisibleState of (Wait(Self))  to 'Remarks' False
30784>>>>>    // Update During Process
30784>>>>>    // Send UpdateWait to (Wait(Self)) 'Remarks'
30784>>>>>
30784>>>>>    //AB-StoreTopEnd
30784>>>>>
30784>>>>>    Set Exit_Application_Local_State to FALSE
30785>>>>>    Set Modal_State to FALSE
30786>>>>>    Set Popup_State to TRUE
30787>>>>>    Set Border_Style to Border_Thick
30788>>>>>    Set Minimize_Icon to FALSE
30789>>>>>    Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
30790>>>>>    Set Size to 138 256
30791>>>>>
30791>>>>>    //AB-DDOStart
30791>>>>>
30791>>>>>
30791>>>>>    //AB-DDOEnd
30791>>>>>
30791>>>>>    Object WaitBar is a ProgressBarSub
30793>>>>>
30793>>>>>        //AB-StoreTopStart
30793>>>>>
30793>>>>>        //AB-StoreTopEnd
30793>>>>>
30793>>>>>        Set Size to 21 243
30794>>>>>        Set Location to 7 4
30795>>>>>
30795>>>>>        //AB-StoreStart
30795>>>>>        Send DoRegSize  self smTopRight
30796>>>>>        //AB-StoreEnd
30796>>>>>
30796>>>>>    End_Object
30797>>>>>
30797>>>>>    Object WaitText is a TextBoxSub
30799>>>>>
30799>>>>>        //AB-StoreTopStart
30799>>>>>
30799>>>>>        //AB-StoreTopEnd
30799>>>>>
30799>>>>>        Set Enabled_State to TRUE
30800>>>>>        Set Label to "Processing"
30801>>>>>        Set FontSize to 4 0
30802>>>>>        Set Size to 10 81
30803>>>>>        Set Location to 36 5
30804>>>>>
30804>>>>>        //AB-StoreStart
30804>>>>>
30804>>>>>        //AB-StoreEnd
30804>>>>>
30804>>>>>    End_Object
30805>>>>>
30805>>>>>    Object bnCancel is a ButtonSub
30807>>>>>
30807>>>>>        //AB-StoreTopStart
30807>>>>>
30807>>>>>        //AB-StoreTopEnd
30807>>>>>
30807>>>>>        Set Default_State to TRUE
30808>>>>>        Set Label to "OK"
30809>>>>>        Set Location to 34 143
30810>>>>>
30810>>>>>        //AB-StoreStart
30810>>>>>
30810>>>>>        Procedure OnClick
30812>>>>>             Send Deactivate to (Wait(Self))
30813>>>>>        End_Procedure
30814>>>>>
30814>>>>>        Send DoRegAlign self amTopRight
30815>>>>>        //AB-StoreEnd
30815>>>>>
30815>>>>>    End_Object
30816>>>>>
30816>>>>>    Object bnDetail is a ButtonSub
30818>>>>>
30818>>>>>        //AB-StoreTopStart
30818>>>>>
30818>>>>>        //AB-StoreTopEnd
30818>>>>>
30818>>>>>        Set Focus_Mode to Pointer_Only
30819>>>>>        Set Label to "Info >>"
30820>>>>>        Set Location to 34 197
30821>>>>>
30821>>>>>        //AB-StoreStart
30821>>>>>
30821>>>>>        Procedure OnClick
30823>>>>>            Delegate Send Show_Details False
30825>>>>>        End_Procedure
30826>>>>>
30826>>>>>        Send DoRegAlign self amTopRight
30827>>>>>        //AB-StoreEnd
30827>>>>>
30827>>>>>    End_Object
30828>>>>>
30828>>>>>    Object LineControlSub1 is a LineControlSub
30830>>>>>
30830>>>>>        //AB-StoreTopStart
30830>>>>>
30830>>>>>        //AB-StoreTopEnd
30830>>>>>
30830>>>>>        Set Size to 2 243
30831>>>>>        Set Location to 54 4
30832>>>>>
30832>>>>>        //AB-StoreStart
30832>>>>>
30832>>>>>        Send DoRegSize  self smTopRight
30833>>>>>        //AB-StoreEnd
30833>>>>>
30833>>>>>    End_Object
30834>>>>>
30834>>>>>    Object WaitEdit is a editSub
30836>>>>>
30836>>>>>        //AB-StoreTopStart
30836>>>>>
30836>>>>>        //AB-StoreTopEnd
30836>>>>>
30836>>>>>        Set Enabled_State to FALSE
30837>>>>>        Set Read_Only_State to TRUE
30838>>>>>        Set Size to 58 243
30839>>>>>        Set Location to 60 4
30840>>>>>        Set Color to clWhite
30841>>>>>
30841>>>>>        //AB-StoreStart
30841>>>>>
30841>>>>>        Send DoRegSize Self amBottomRight
30842>>>>>        Delegate Set Size to 66 256
30844>>>>>
30844>>>>>        //AB-StoreEnd
30844>>>>>
30844>>>>>    End_Object
30845>>>>>
30845>>>>>    Object oTxtAntiBar is a TextBoxSub
30847>>>>>        Set Enabled_State to TRUE
30848>>>>>        Set Visible_State to FALSE
30849>>>>>        Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
30850>>>>>        Set Justification_Mode to (jMode_Center IOR jMode_VCenter)
30851>>>>>        Set Auto_Size_State to FALSE
30852>>>>>        Set FontWeight to 600
30853>>>>>        Set FontSize to 4 0
30854>>>>>        Set Size to 10 209
30855>>>>>        Set Location to 10 4
30856>>>>>        Set TextColor to clNavy
30857>>>>>    End_Object
30858>>>>>
30858>>>>>
30858>>>>>    //AB-StoreStart
30858>>>>>    Property Integer piWaitSize  Public (Size(Self))
30860>>>>>    Property Integer piPrevSize  Public (Size(Self))
30862>>>>>    Property Integer piState     Public False
30864>>>>>
30864>>>>>    Set Locate_Mode to Center_On_Screen
30865>>>>>    Set Destroy_Object_State to True
30866>>>>>
30866>>>>>    Procedure Show_Details Integer bAlways
30868>>>>>        Local Integer liOriSize liSize hiSize hiOriSize lowSize bState
30869>>>>>        Local String sLabel
30869>>>>>        Get Size                to liSize
30870>>>>>        Get piState             to bState
30871>>>>>        Get piWaitSize          to liOriSize
30872>>>>>        Move (Hi(liSize))       to hiSize
30873>>>>>        Move (Low(liSize))      to lowSize
30874>>>>>        Move (Hi(liOriSize))    to hiOriSize
30875>>>>>        If (bAlways) Begin
30877>>>>>            Set piState         to False
30878>>>>>            Move 0              to bState
30879>>>>>        End
30879>>>>>>
30879>>>>>        If bState Begin
30881>>>>>             Set Size to hiOriSize lowSize
30882>>>>>             Set Label of (bnDetail(Self)) to "Info >>"
30883>>>>>        End
30883>>>>>>
30883>>>>>        Else Begin
30884>>>>>             Set Size to 138 lowSize
30885>>>>>             Set Label of (bnDetail(Self)) to "<< Info"
30886>>>>>        End
30886>>>>>>
30886>>>>>        Set piState to (1-bState)
30887>>>>>    End_Procedure
30888>>>>>
30888>>>>>    Procedure Bar_Current_Position Integer iCount Integer iOccurances Integer iMaximum Integer bState
30890>>>>>       If (bState) Begin
30892>>>>>         If (Mod(iCount,(iCount*((Number(iMaximum))/(Number(iOccurances)))))=0) ;            Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
30895>>>>>       End
30895>>>>>>
30895>>>>>       Else Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
30897>>>>>    End_Procedure
30898>>>>>
30898>>>>>    Procedure DoInitialize_WaitBar
30900>>>>>        Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
30901>>>>>    End_Procedure
30902>>>>>
30902>>>>>    Procedure DoTerminate_WaitBar
30904>>>>>        Local Integer iMax
30905>>>>>        Get Maximum_position of (WaitBar(Self)) to iMax
30906>>>>>        Send Bar_Current_Position to (Wait(Self)) iMax iMax Imax False
30907>>>>>    End_Procedure
30908>>>>>
30908>>>>>    Procedure Set Bar_Maximum_Position Integer iMaximum
30910>>>>>         Set Maximum_position of (WaitBar(Self)) to iMaximum
30911>>>>>    End_Procedure
30912>>>>>
30912>>>>>    Function Bar_Maximum_Position Returns Integer
30914>>>>>        Function_Return (Maximum_position(WaitBar(Self)))
30915>>>>>    End_Function
30916>>>>>
30916>>>>>    Procedure Set Bar_Minimum_Position Integer iMinimum
30918>>>>>         Set Minimum_position of (WaitBar(Self)) to iMinimum
30919>>>>>    End_Procedure
30920>>>>>
30920>>>>>    Function Bar_Minimum_Position Returns Integer
30922>>>>>        Function_Return (Minimum_position(WaitBar(Self)))
30923>>>>>    End_Function
30924>>>>>
30924>>>>>    Procedure Set Bar_Step_Value Integer iStep
30926>>>>>         Set Step_Value of (WaitBar(Self)) to iStep
30927>>>>>    End_Procedure
30928>>>>>
30928>>>>>    Function Bar_Step_Value Returns Integer
30930>>>>>        Function_Return (Step_Value(WaitBar(Self)))
30931>>>>>    End_Function
30932>>>>>
30932>>>>>    Procedure Set Wait_Message String sMessage
30934>>>>>        Set Value of (WaitText(Self)) to sMessage
30935>>>>>    End_Procedure
30936>>>>>
30936>>>>>    Procedure Wait_Details String sFile String sDetail Integer bInitData
30938>>>>>        Local Integer liEditId
30939>>>>>        Move (WaitEdit(Self)) to liEditId
30940>>>>>        If bInitData Send Delete_Data to liEditId
30943>>>>>        If sFile ne "" Begin
30945>>>>>           Send Read to liEditId sFile
30946>>>>>           Send Beginning_Of_Data to liEditId
30947>>>>>        End
30947>>>>>>
30947>>>>>        Else Begin
30948>>>>>           Send Insert to liEditId sDetail
30949>>>>>        End
30949>>>>>>
30949>>>>>    End_Procedure
30950>>>>>
30950>>>>>    Procedure OnResize
30952>>>>>        Local Integer liSize liHiSize liPrevSize liHiPrevSize bState liHiLoc liLoc
30953>>>>>        Get Size to liPrevSize
30954>>>>>        Move (Hi(liPrevSize)) to liHiPrevSize
30955>>>>>        Forward Send OnResize
30957>>>>>        Get Location of (WaitEdit(Self)) to liLoc
30958>>>>>        Move (Hi(liLoc)) to liHiLoc
30959>>>>>        Get piState to bState
30960>>>>>        Get Size to liSize
30961>>>>>        Move (Hi(liSize)) to liHiSize
30962>>>>>        If (liHiSize > (liHiLoc +30)) Begin
30964>>>>>            Set Value of (bnDetail(Self)) to "<< Info"
30965>>>>>            If (liHiPrevSize <= (liHiLoc +30)) Set piState to (1-bState)
30968>>>>>        End
30968>>>>>>
30968>>>>>        Else Begin
30969>>>>>            Set Value of (bnDetail(Self)) to "Info >>"
30970>>>>>            If (liHiPrevSize > (liHiLoc +30)) Set piState to (1-bState)
30973>>>>>        End
30973>>>>>>
30973>>>>>    End_Procedure
30974>>>>>
30974>>>>>    Procedure Set Button_State Integer bState
30976>>>>>        If bState Begin
30978>>>>>            Set Caption_Bar to True
30979>>>>>            Set Size to 66 256
30980>>>>>        End
30980>>>>>>
30980>>>>>        Else Begin
30981>>>>>            Set Caption_Bar to False
30982>>>>>            Set Size to 38 256
30983>>>>>        End
30983>>>>>>
30983>>>>>    End_Procedure
30984>>>>>
30984>>>>>    Procedure Set BarVisibleState String sMsg Integer bState
30986>>>>>        Set Visible_State of (oTxtAntiBar(Self)) to (bState = 0)
30987>>>>>        Set Visible_State of (WaitBar(Self))     to (bState = 1)
30988>>>>>        If (bState = 0) Begin
30990>>>>>            Set Size to 24 256
30991>>>>>            Set Location of (oTxtAntiBar(Self)) to 6 5
30992>>>>>        End
30992>>>>>>
30992>>>>>        If sMsg ne "" Set Value of (oTxtAntiBar(Self)) to sMsg
30995>>>>>    End_Procedure
30996>>>>>
30996>>>>>    Procedure Deactivating integer search_mode Returns Integer
30998>>>>>        local integer rval
30999>>>>>        Forward Get MSG_Deactivating search_mode to rval
31001>>>>>        Set Modal_State of (Wait(Self)) to False
31002>>>>>        Set BarVisibleState of (Wait(Self)) to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..." True
31003>>>>>        Procedure_Return rval
31004>>>>>    End_Procedure
31005>>>>>
31005>>>>>    Procedure UpdateWait String sMsg
31007>>>>>        Set Value of (oTxtAntiBar(Self)) to sMsg
31008>>>>>    End_Procedure
31009>>>>>
31009>>>>>
31009>>>>>    Procedure Set Horizontal_Justification Integer aiMode
31011>>>>>        Set Justification_Mode of oTxtAntiBar to (jMode_VCenter IOR aiMode)
31012>>>>>    End_Procedure
31013>>>>>
31013>>>>>
31013>>>>>
31013>>>>>
31013>>>>>
31013>>>>>
31013>>>>>    //AB-StoreEnd
31013>>>>>
31013>>>>>End_Object
31014>>>>>
31014>>>>>
31014>>>>>//AB-StoreStart
31014>>>>>
31014>>>>>//AB-StoreEnd
31014>>>>>
31014>>>>>//AB/ End_Object    // prj
31014>>>
31014>Use Calendar.sl
INCLUDING FILE: CALENDAR.SL
31014>>>//AB/ Project Calendar
31014>>>//AB/ Object prj is a Lookup_Project
31014>>>//AB/     Set ProjectName to "Calendar"
31014>>>//AB/     Set ProjectFileName to "Calendar.sl"
31014>>>
31014>>>// Project Object Structure
31014>>>//   oCalendar is a dbModalPanel
31014>>>//     Container3d1 is a Container3d
31014>>>//       Grid2 is a Grid
31014>>>//       Textbox2 is a Textbox
31014>>>//       Textbox3 is a Textbox
31014>>>//       Textbox4 is a Textbox
31014>>>//       Textbox5 is a Textbox
31014>>>//       Textbox6 is a Textbox
31014>>>//       Textbox7 is a Textbox
31014>>>//       Textbox8 is a Textbox
31014>>>//       LineControl1 is a LineControl
31014>>>//       Container3d2 is a Container3d
31014>>>//         oRght is a BitmapContainer
31014>>>//         oLeft is a BitmapContainer
31014>>>//         oMonth is a Textbox
31014>>>//           oSelectMonth is a FloatingPopupMenu
31014>>>//         oYear is a Textbox
31014>>>//         oSelectYear is a Form
31014>>>//     BitmapContainer3 is a BitmapContainer
31014>>>//     oToday is a Textbox
31014>>>
31014>>>// Register all objects
31014>>>Register_Object BitmapContainer3
31014>>>Register_Object Container3d1
31014>>>Register_Object Container3d2
31014>>>Register_Object Grid2
31014>>>Register_Object LineControl1
31014>>>Register_Object oCalendar
31014>>>Register_Object oLeft
31014>>>Register_Object oMonth
31014>>>Register_Object oRght
31014>>>Register_Object oSelectMonth
31014>>>Register_Object oSelectYear
31014>>>Register_Object oToday
31014>>>Register_Object oYear
31014>>>Register_Object Textbox2
31014>>>Register_Object Textbox3
31014>>>Register_Object Textbox4
31014>>>Register_Object Textbox5
31014>>>Register_Object Textbox6
31014>>>Register_Object Textbox7
31014>>>Register_Object Textbox8
31014>>>
31014>>>
31014>>>
31014>>>//AB-StoreTopStart
31014>>>Use dates.utl
INCLUDING FILE: DATES.UTL
31014>>>>>// **********************************************************************
31014>>>>>// Use Dates.utl    // Date manipulation for VDF and DF3.1
31014>>>>>//
31014>>>>>// by Sture Andersen (sa1@vd.dk)
31014>>>>>//
31014>>>>>// The file contains a number of global functions for manipulating
31014>>>>>// dates. The package may be used with DataFlex 3.1 and Visual DataFlex.
31014>>>>>// This package is public domain.
31014>>>>>//
31014>>>>>// The package file is accompanied by a Word document (dfutil.doc)
31014>>>>>// listing the functions and their use.
31014>>>>>//
31014>>>>>//
31014>>>>>// Create: Fri  06-06-1997 - Merger of s_utl020, 021, 022, 023, 024, 025.
31014>>>>>// Update: Thu  26-06-1997 - Fixes for strange behavior when date4_state is set.
31014>>>>>//                         - Addition of popup_calendar to VDF.
31014>>>>>//         Sun  29-06-1997 - Character mode popup calender.
31014>>>>>//         Fri  04-07-1997 - Function WeekToDate added.
31014>>>>>//         Thu  10-07-1997 - Fixes.
31014>>>>>//         Mon  11-08-1997 - WeekToDate fixed.
31014>>>>>//         Sun  24-08-1997 - Character mode popup calender finished.
31014>>>>>//         Mon  15-12-1997 - Procedure Request_Popup_Calendar added.
31014>>>>>//         Mon  29-12-1997 - Procedures ItemYear2to4, ItemDate2to4 and
31014>>>>>//                           ItemSysdate added.
31014>>>>>//         Mon  29-12-1997 - Procedures FieldYear2to4, FieldDate2to4 and
31014>>>>>//                           FieldSysdate added.
31014>>>>>//         Sun  01-02-1998 - Functions Module_Compile_Date and
31014>>>>>//                           Module_Compile_Time added.
31014>>>>>//         Wed  25-02-1998 - Request_Popup in calendar object now only
31014>>>>>//                           responds if entry_state of the calling object
31014>>>>>//                           is true (VDF version). (No apparent effect)
31014>>>>>//         Sat  28-03-1998 - Added the following functions:
31014>>>>>//                             TS_SysTime      TS_ExtractDate
31014>>>>>//                             TS_ExtractTime  TS_ConvertToString
31014>>>>>//         Tue  26-05-1998 - Procedure TS_UI_Update added
31014>>>>>//         Sat  01-08-1998 - mask_date_window taken into account
31014>>>>>//         Mon  10-08-1998 - Functions Module_Start_Date and
31014>>>>>//                           Module_Start_Time added.
31014>>>>>//         Wed  02-09-1998 - Parameter for Module_Start_Date removed
31014>>>>>//         Mon  12-10-1998 - Portuguese added
31014>>>>>//         Wed  04-11-1998 - TS_TimeEstimator class added
31014>>>>>//         Tue  29-12-1998 - Function DateAsString added
31014>>>>>//         Wed  13-01-1999 - Function DateWeekNumber changed according to
31014>>>>>//                           Kjetil Johanson
31014>>>>>//         Mon  18-01-1999 - Function DateWeekNumber changed according to
31014>>>>>//                           Kjetil Johanson (again)
31014>>>>>//         Tue  19-01-1999 - Changed procedure names in TS_TimeEstimator
31014>>>>>//                           class (Continue->TS_Continue and Pause->
31014>>>>>//                           TS_Pause)
31014>>>>>//         Thu  21-01-1999 - Procedures DateFormatAsString and DateFormatName
31014>>>>>//                           added.
31014>>>>>//                         - Procedures DateCurrentSeparator and
31014>>>>>//                           DateCurrentFormat added.
31014>>>>>//         Tue  13-04-1999 - Julian constants added: Jan1st1900, Jan1st2000
31014>>>>>//                           Jan1st1000 and Jan1st100
31014>>>>>//         Mon  26-04-1999 - Changed procedure FieldYear2to4 and ItemYear2to4
31014>>>>>//                           to trap 3 digit years.
31014>>>>>//         Wed  27-04-1999 - Changed Dutch abbriviated day names (to 2 characters)
31014>>>>>//         Sun  02-05-1999 - Added function TS_Compose2
31014>>>>>//                         - Fixed error in TS_ConvertToString
31014>>>>>//         Tue  01-06-1999 - Added procedure popup_no_export to calendar.
31014>>>>>//         Thu  15-06-1999 - Fixed Date4to2 function and exporting dates
31014>>>>>//                           from the calendar to forms with no form_margin.
31014>>>>>//         Tue  07-09-1999 - Added function DateAsText
31014>>>>>//         Wed  27-10-1999 - Temporary fix for Module_Compile_Date function
31014>>>>>//                           in combination with y2k.
31014>>>>>//         Wed  19-12-1999 - Function StringToDate added.
31014>>>>>//                         - Existing function DateAsString renamed to
31014>>>>>//                           DateToString.
31014>>>>>//         Mon  03-01-2000 - Fix for VDF4. Popup calendar on empty date field
31014>>>>>//                           would result in seeding the calendar on year 100.
31014>>>>>//                           This error was caused by the fact that VDF 4
31014>>>>>//                           ignores SYSDATE4_STATE such that the sysdate
31014>>>>>//                           command returns 03-01-100
31014>>>>>//         Wed  01-02-2000 - Define instead of #REPLACE
31014>>>>>//         Wed  23-08-2000 - Function TS_Module_Compile_Time added
31014>>>>>//
31014>>>>>// NOTE:  There is language dependent string constants in this file.
31014>>>>>//        Currently there are sections for dutch, english, danish, swedish,
31014>>>>>//        norwegian, spanish, german and portuguese
31014>>>>>//
31014>>>>>//        These sections may be identified by searching the symbol LNG_DEFAULT
31014>>>>>//
31014>>>>>// ***********************************************************************
31014>>>>>
31014>>>>>Use ui
31014>>>>>Use Language    // Set default languange if not set by compiler command line
INCLUDING FILE: LANGUAGE.PKG
31014>>>>>>>// Use Language     // Default language setup
31014>>>>>>>// Sets default languange if not set by compiler command line
31014>>>>>>>
31014>>>>>>>define lng_dutch      for 131
31014>>>>>>>define lng_french     for 133 // NOT TRANSLATED. DO NOT SELECT!
31014>>>>>>>define lng_spanish    for 134
31014>>>>>>>define lng_italian    for 139 // NOT TRANSLATED. DO NOT SELECT!
31014>>>>>>>define lng_english    for 144
31014>>>>>>>define lng_danish     for 145
31014>>>>>>>define lng_swedish    for 146
31014>>>>>>>define lng_norwegian  for 147
31014>>>>>>>define lng_Greek    for 148
31014>>>>>>>define lng_german     for 149
31014>>>>>>>define lng_portuguese for 155
31014>>>>>>>define lng_papiamentu for 199 // NOT TRANSLATED. DO NOT SELECT!
31014>>>>>>>
31014>>>>>>>
31014>>>>>>>define lng_default for !@
31014>>>>>>>
31014>>>>>>>  define _LANGUAGE_ for $ENGLISH$
31014>>>>>>>
#REM LANGUAGE SET BY LANGUAGE.PKG: $ENGLISH$
31014>>>>>Use Seq_Chnl    // Defines global sequential device management operations (DAC)
31014>>>>>Use Macros.utl  // Various macros (DESKTOP_SECTION)
INCLUDING FILE: MACROS.UTL
31014>>>>>>>// Use Macros.utl   // Various macros (FOR_EX...)
31014>>>>>>>
31014>>>>>>>//  FOR_EX (extended FOR command)
31014>>>>>>>//  -----------------------------
31014>>>>>>>//> The FOR_EX command is exactly like the standard FOR command except
31014>>>>>>>//> that it will allow you to use keyword "DOWN_TO" instead of "TO" if
31014>>>>>>>//> you need to do a decremental loop.
31014>>>>>>>
31014>>>>>>>
31014>>>>>>>//  DESKTOP_SECTION
31014>>>>>>>//  ---------------
31014>>>>>>>//> The DESKTOP_SECTION/END_DESKTOP_SECTION commands will make a sequence of
31014>>>>>>>//> code compile (or rather instantiate) as if it was situated on the DESKTOP
31014>>>>>>>//> even when it isn't. DESKTOP_SECTION's may not be nested.
31014>>>>>>>
31014>>>>>>>
31014>>>>>>>
31014>>>>>
31014>>>>>// Switches
31014>>>>>
31014>>>>>define DATES_INCLUDE_POPUP for 1   // If set to 0 the popup calendar will not be included
31014>>>>>define DATES_DF31B_EPOCH   for 40  // DF3.1b didn't have an epoch setting. Therefore this symbol defines the epoch value for that version.
31014>>>>>
31014>>>>> define t.calendar.year           for "Year"
31014>>>>> define t.calendar.month          for "Month"
31014>>>>> define t.calendar.day            for "Day"
31014>>>>> define t.calendar.week           for "Wk."
31014>>>>> define t.calendar.calendar_popup for "Calendar Popup"
31014>>>>> define t.calendar.Monday         for "Monday"
31014>>>>> define t.calendar.Tuesday        for "Tuesday"
31014>>>>> define t.calendar.Wednesday      for "Wednesday"
31014>>>>> define t.calendar.Thursday       for "Thursday"
31014>>>>> define t.calendar.Friday         for "Friday"
31014>>>>> define t.calendar.Saturday       for "Saturday"
31014>>>>> define t.calendar.Sunday         for "Sunday"
31014>>>>> define t.calendar.January        for "January"
31014>>>>> define t.calendar.February       for "February"
31014>>>>> define t.calendar.March          for "March"
31014>>>>> define t.calendar.April          for "April"
31014>>>>> define t.calendar.May            for "May"
31014>>>>> define t.calendar.June           for "June"
31014>>>>> define t.calendar.July           for "July"
31014>>>>> define t.calendar.August         for "August"
31014>>>>> define t.calendar.September      for "September"
31014>>>>> define t.calendar.October        for "October"
31014>>>>> define t.calendar.November       for "November"
31014>>>>> define t.calendar.December       for "December"
31014>>>>> define t.calendar.ok             for "OK"
31014>>>>> define t.calendar.Cancel         for "Cancel"
31014>>>>> define t.calendar.Activate       for "Activate popup calendar (Ctrl+D)"
31014>>>>>
31014>>>>>define LargestPossibleDate for 913490 // December 31st 2500
31014>>>>>define Jan1st1900          for 693975
31014>>>>>define Jan1st2000          for 730500
31014>>>>>define Jan1st1000          for 365250
31014>>>>>define Jan1st105           for 38352
31014>>>>>define Jan1st100           for 36525
31014>>>>>
31014>>>>>enumeration_list // Date Segments
31014>>>>>  define DS_DAY
31014>>>>>  define DS_WEEK
31014>>>>>  define DS_MONTH
31014>>>>>  define DS_YEAR
31014>>>>>end_enumeration_list
31014>>>>>
31014>>>>>integer Dates$Year Dates$Month Dates$Day // internal use
31014>>>>>
31014>>>>>procedure DateDecompose global date date# //very internal!!
31015>>>>>  local integer pos1# pos2# format#
31016>>>>>  local string str# sep#
31016>>>>>  get_attribute DF_DATE_FORMAT to format#
31019>>>>>  get_attribute DF_DATE_SEPARATOR to pos1# // overload
31022>>>>>  character pos1# to sep#                  // end overload
31023>>>>>>
31023>>>>>  move date# to str#
31024>>>>>  replace sep# in str# with "$"
31026>>>>>  move strmark to pos1#
31027>>>>>  if [found] begin
31029>>>>>    replace sep# in str# with "$"
31031>>>>>    move strmark to pos2#
31032>>>>>  end
31032>>>>>>
31032>>>>>  else begin
31033>>>>>    move 0 to Dates$Year
31034>>>>>    move 0 to Dates$Month
31035>>>>>    move 0 to Dates$Day
31036>>>>>  end
31036>>>>>>
31036>>>>>  [ found] begin
31038>>>>>>
31038>>>>>    if format# eq DF_DATE_EUROPEAN ;          left str# to Dates$Day    (pos1#-1)
31042>>>>>    if format# eq DF_DATE_USA begin
31044>>>>>          mid  str# to Dates$Day    (pos2#-pos1#-1) (pos1#+1)
31047>>>>>>
31047>>>>>          left str# to Dates$Month  (pos1#-1)
31049>>>>>>
31049>>>>>    end
31049>>>>>>
31049>>>>>    else  mid  str# to Dates$Month  (pos2#-pos1#-1) (pos1#+1)
31053>>>>>
31053>>>>>    if format# eq DF_DATE_MILITARY begin
31055>>>>>          mid  str# to Dates$Day  2 (pos2#+1)
31058>>>>>>
31058>>>>>          left str# to Dates$Year   (pos1#-1)
31060>>>>>>
31060>>>>>    end
31060>>>>>>
31060>>>>>    else  mid  str# to Dates$Year 4 (pos2#+1)
31064>>>>>  end
31064>>>>>>
31064>>>>>end_procedure
31065>>>>>
31065>>>>>function DateCompose global integer day# integer month# integer year# returns date
31066>>>>>  local integer format#
31067>>>>>  local date date#
31067>>>>>  local string sep#
31067>>>>>  ifnot (day#*month#*year#) function_return 0
31070>>>>>  get_attribute DF_DATE_SEPARATOR to format# // overload
31073>>>>>  character format# to sep#                  // end overload
31074>>>>>>
31074>>>>>  get_attribute DF_DATE_FORMAT to format#
31077>>>>>  if day# gt 28 begin
31079>>>>>    if format# eq DF_DATE_EUROPEAN move (date(string(day#)+sep#+string(month#)+sep#+string(year#))) to date# // DMY
31082>>>>>    if format# eq DF_DATE_USA      move (date(string(month#)+sep#+string(day#)+sep#+string(year#))) to date# // MDY
31085>>>>>    if format# eq DF_DATE_MILITARY move (date(string(year#)+sep#+string(month#)+sep#+string(day#))) to date# // YMD
31088>>>>>    send DateDecompose date#
31089>>>>>    if Dates$Month ne month# move (day#-Dates$Day) to day#
31092>>>>>  end
31092>>>>>>
31092>>>>>  if format# eq DF_DATE_EUROPEAN function_return (date(string(day#)+sep#+string(month#)+sep#+string(year#))) // DMY
31095>>>>>  if format# eq DF_DATE_USA function_return (date(string(month#)+sep#+string(day#)+sep#+string(year#))) // MDY
31098>>>>>  function_return (date(string(year#)+sep#+string(month#)+sep#+string(day#))) // YMD
31099>>>>>end_function
31100>>>>>
31100>>>>>function DateFormatName global integer format# returns string
31101>>>>>  if format# eq DF_DATE_EUROPEAN function_return "European"
31104>>>>>  if format# eq DF_DATE_USA      function_return "United States"
31107>>>>>  if format# eq DF_DATE_MILITARY function_return "Military"
31110>>>>>end_function
31111>>>>>
31111>>>>>function DateCurrentSeparator global returns string
31112>>>>>  local integer rval#
31113>>>>>  get_attribute DF_DATE_SEPARATOR to rval#
31116>>>>>  function_return (character(rval#))
31117>>>>>end_function
31118>>>>>
31118>>>>>function DateCurrentFormat global returns integer
31119>>>>>  local integer rval#
31120>>>>>  get_attribute DF_DATE_FORMAT to rval#
31123>>>>>  function_return rval#
31124>>>>>end_function
31125>>>>>
31125>>>>>function DateFormatAsString global integer format# integer long# string sep# returns string
31126>>>>>  local string rval# letter#
31127>>>>>  if format# eq DF_DATE_EUROPEAN move "3342241111" to rval#
31130>>>>>  if format# eq DF_DATE_USA      move "2243341111" to rval#
31133>>>>>  if format# eq DF_DATE_MILITARY move "1111422433" to rval#
31136>>>>>  left t.calendar.year to letter# 1
31138>>>>>>
31138>>>>>  replace "1" in rval# with letter#
31140>>>>>  replace "1" in rval# with letter#
31142>>>>>  ifnot long# move "" to letter#
31145>>>>>  move (replaces("1",rval#,letter#)) to rval#
31146>>>>>  move (replaces("2",rval#,left(t.calendar.month,1))) to rval#
31147>>>>>  move (replaces("3",rval#,left(t.calendar.day,1))) to rval#
31148>>>>>  if sep# eq "" begin
31150>>>>>    get_attribute DF_DATE_SEPARATOR to format#
31153>>>>>    character format# to sep#
31154>>>>>>
31154>>>>>  end
31154>>>>>>
31154>>>>>  move (replaces("4",rval#,sep#)) to rval#
31155>>>>>  function_return rval#
31156>>>>>end_function
31157>>>>>
31157>>>>>function StringToDate global string date# integer format# integer four_digit_year# string sep# returns date
31158>>>>>  local integer sep_len# day# month# year#
31159>>>>>  move (length(sep#)) to sep_len#
31160>>>>>  if four_digit_year# move 4 to four_digit_year#
31163>>>>>  else move 2 to four_digit_year#
31165>>>>>  if format# eq DF_DATE_EUROPEAN begin // DMY
31167>>>>>    move (mid(date#,2,1)) to day#
31168>>>>>    move (mid(date#,2,3+sep_len#)) to month#
31169>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31170>>>>>  end
31170>>>>>>
31170>>>>>  if format# eq DF_DATE_USA begin // MDY
31172>>>>>    move (mid(date#,2,1)) to month#
31173>>>>>    move (mid(date#,2,3+sep_len#)) to year#
31174>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31175>>>>>  end
31175>>>>>>
31175>>>>>  if format# eq DF_DATE_MILITARY begin // YMD
31177>>>>>    move (mid(date#,four_digit_year#,1)) to year#
31178>>>>>    move (mid(date#,2,1+four_digit_year#+sep_len#)) to month#
31179>>>>>    move (mid(date#,2,3+four_digit_year#+sep_len#+sep_len#)) to day#
31180>>>>>  end
31180>>>>>>
31180>>>>>  function_return (DateCompose(day#,month#,year#))
31181>>>>>end_function
31182>>>>>
31182>>>>>function DateToString global date date# integer format# integer four_digit_year# string sep# returns string
31183>>>>>  local string rval# day# month# year#
31184>>>>>  get Date2to4 date# to date#
31185>>>>>  if (integer(date#)) begin
31187>>>>>    send DateDecompose date#
31188>>>>>    move Dates$Day to day#
31189>>>>>    if Dates$Day lt 10 insert "0" in day# at 1
31193>>>>>    move Dates$Month to month#
31194>>>>>    if Dates$Month lt 10 insert "0" in month# at 1
31198>>>>>    move Dates$Year to year#
31199>>>>>    ifnot four_digit_year# move (right(year#,2)) to year#
31202>>>>>    if format# eq DF_DATE_EUROPEAN move (day#+sep#+month#+sep#+year#) to rval# // DMY
31205>>>>>    if format# eq DF_DATE_USA      move (month#+sep#+day#+sep#+year#) to rval# // MDY
31208>>>>>    if format# eq DF_DATE_MILITARY move (year#+sep#+month#+sep#+day#) to rval# // YMD
31211>>>>>  end
31211>>>>>>
31211>>>>>  function_return rval#
31212>>>>>end_function
31213>>>>>
31213>>>>>// Function DateAsString is only here for compatibility with earlier versions.
31213>>>>>// Use function DateToString instead.
31213>>>>>function DateAsString global date date# integer format# integer four_digit_year# string sep# returns string
31214>>>>>  function_return (DateToString(date#,format#,four_digit_year#,sep#))
31215>>>>>end_function
31216>>>>>
31216>>>>>function DateIncrement global date date# integer segment# integer amount# returns date
31217>>>>>  if (date#=0) function_return 0
31220>>>>>  if segment# eq DS_WEEK function_return (date#+(amount#*7)) //weeks
31223>>>>>  if (segment#<>DS_DAY) begin // months or years
31225>>>>>    send DateDecompose date#
31226>>>>>    if segment# eq DS_MONTH begin //months
31228>>>>>      move (Dates$Month+amount#) to Dates$Month
31229>>>>>      if amount# ge 0 function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-1)/12)*12),Dates$Year+((Dates$Month-1)/12)))
31232>>>>>      function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-12)/12)*12),Dates$Year+((Dates$Month-12)/12)))
31233>>>>>    end //years:
31233>>>>>>
31233>>>>>    if segment# eq DS_YEAR function_return (DateCompose(Dates$Day,Dates$Month,Dates$Year+amount#))
31236>>>>>  end
31236>>>>>>
31236>>>>>  else function_return (date#+amount#) //days
31238>>>>>end_function
31239>>>>>
31239>>>>>function DateSegment global date date# integer segment# returns integer
31240>>>>>  send DateDecompose date#
31241>>>>>  if segment# eq DS_DAY   function_return Dates$Day
31244>>>>>  if segment# eq DS_MONTH function_return Dates$Month
31247>>>>>  if segment# eq DS_YEAR  function_return Dates$Year
31250>>>>>end_function
31251>>>>>
31251>>>>>function DateToInteger global date date# returns integer
31252>>>>>  send DateDecompose date#
31253>>>>>  function_return (Dates$Year*100+Dates$Month*100+Dates$Day)
31254>>>>>end_function
31255>>>>>
31255>>>>>function FirstDayInMonth global date date# returns date
31256>>>>>  local integer month# year#
31257>>>>>  move (DateSegment(date#,DS_MONTH)) to month#
31258>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31259>>>>>  function_return (DateCompose(1,month#,year#))
31260>>>>>end_function
31261>>>>>
31261>>>>>function LastDayInMonth global date date# returns date
31262>>>>>  move (DateIncrement(date#,DS_MONTH,1)) to date#
31263>>>>>  function_return (FirstDayInMonth(date#)-1)
31264>>>>>end_function
31265>>>>>
31265>>>>>function FirstDayInYear global date date# returns date
31266>>>>>  local integer year#
31267>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31268>>>>>  function_return (DateCompose(1,1,year#))
31269>>>>>end_function
31270>>>>>
31270>>>>>function LastDayInYear global date date# returns date
31271>>>>>  move (DateIncrement(date#,DS_YEAR,1)) to date#
31272>>>>>  function_return (FirstDayInYear(date#)-1)
31273>>>>>end_function
31274>>>>>
31274>>>>>// Prior to 18/1-99 version of DateWeekNumber
31274>>>>>//function DateWeekNumber global date date# returns integer
31274>>>>>//  local integer week# first_wd# day_of_year# year#
31274>>>>>//  if (date#=0) function_return 0
31274>>>>>//  get Date2to4 date# to date#
31274>>>>>//  move (DateSegment(date#,DS_YEAR)) to year#
31274>>>>>//  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31274>>>>>//  move (date#-FirstDayInYear(date#)) to day_of_year#
31274>>>>>//  move (day_of_year#-1-7+first_wd#) to day_of_year#
31274>>>>>//  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31274>>>>>//  else move 0 to week#
31274>>>>>//  if first_wd# le 4 increment week#
31274>>>>>//  if week# gt 52 begin
31274>>>>>//    move 1 to week#
31274>>>>>//    if first_wd# eq 4 move 53 to week#
31274>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31274>>>>>//  end
31274>>>>>//  if week# eq 0 begin
31274>>>>>//    //get DateWeekNumber (DateIncrement(date#,DS_YEAR,-1)) to first_wd# // Original line
31274>>>>>//    get DateDayNumber  (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#ÿ // changed line
31274>>>>>//    move 52 to week#
31274>>>>>//    if first_wd# eq 4 move 53 to week#
31274>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31274>>>>>//  end
31274>>>>>//  function_return week#
31274>>>>>//end_function
31274>>>>>
31274>>>>>function DateWeekNumber global date date# returns integer
31275>>>>>  local integer week# first_wd# day_of_year# year# wd#
31276>>>>>  if (date#=0) function_return 0
31279>>>>>  get Date2to4 date# to date#
31280>>>>>  // Leap-year test for actual or previous year
31280>>>>>  // Year# only used for selection between 52 and
31280>>>>>  // Therefore get year# from the first day of actual week
31280>>>>>  get DateDayNumber date# to wd#
31281>>>>>  move (DateSegment(date#-wd#+1,DS_YEAR)) to year#
31282>>>>>
31282>>>>>  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31283>>>>>  move (date#-FirstDayInYear(date#)) to day_of_year#
31284>>>>>  move (day_of_year#-1-7+first_wd#) to day_of_year#
31285>>>>>  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31288>>>>>  else move 0 to week#
31290>>>>>  if first_wd# le 4 increment week#
31293>>>>>  if week# gt 52 begin
31295>>>>>    move 1 to week#
31296>>>>>    if first_wd# eq 4 move 53 to week#
31299>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31306>>>>>  end
31306>>>>>>
31306>>>>>  if week# eq 0 begin
31308>>>>>    // Week 52 or 53
31308>>>>>    get DateDayNumber (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#
31309>>>>>    move 52 to week#
31310>>>>>    if first_wd# eq 4 move 53 to week#
31313>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31320>>>>>  end
31320>>>>>>
31320>>>>>  function_return week#
31321>>>>>end_function
31322>>>>>
31322>>>>>function DayName global integer int# returns string
31323>>>>>  if int# eq 1 function_return t.calendar.Monday
31326>>>>>  if int# eq 2 function_return t.calendar.Tuesday
31329>>>>>  if int# eq 3 function_return t.calendar.Wednesday
31332>>>>>  if int# eq 4 function_return t.calendar.Thursday
31335>>>>>  if int# eq 5 function_return t.calendar.Friday
31338>>>>>  if int# eq 6 function_return t.calendar.Saturday
31341>>>>>  if int# eq 7 function_return t.calendar.Sunday
31344>>>>>  function_return ""
31345>>>>>end_function
31346>>>>>
31346>>>>>function DateDayNumber global date date# returns integer
31347>>>>>  local integer rval# // 1=Monday, ... , 7=Sunday
31348>>>>>  get Date2to4 date# to date#
31349>>>>>  move date# to rval#
31350>>>>>  if rval# begin
31352>>>>>    if rval# gt 693975 move (rval#-2) to rval#
31355>>>>>    move (rval#-((rval#/7)*7)) to rval#
31356>>>>>    if rval# eq 0 move 7 to rval#
31359>>>>>  end
31359>>>>>>
31359>>>>>  function_return rval#
31360>>>>>end_function
31361>>>>>
31361>>>>>function DateDayName global date date# returns string
31362>>>>>  function_return (DayName(DateDayNumber(date#)))
31363>>>>>end_function
31364>>>>>
31364>>>>>function YearMaxWeek global integer year# returns integer
31365>>>>>  local integer wk1# wk2#
31366>>>>>  get DateWeekNumber (DateCompose(31,12,year#)) to wk1#
31367>>>>>  get DateWeekNumber (DateCompose(24,12,year#)) to wk2#
31368>>>>>  function_return (wk1# max wk2#)
31369>>>>>end_function
31370>>>>>
31370>>>>>function WeekToDate global integer year# integer week# returns date
31371>>>>>  local date date#
31372>>>>>  move (DateCompose(1,1,year#)) to date#
31373>>>>>  if (DateWeekNumber(date#)) ne 1 move (date#+7) to date# // week 52 or 53
31376>>>>>  move (date#-DateDayNumber(date#)+1) to date# // Now it's a Monday
31377>>>>>  function_return (week#-1*7+date#)
31378>>>>>end_function
31379>>>>>
31379>>>>>function MonthName global integer int# returns string
31380>>>>>  if int# eq  1 function_return t.calendar.January
31383>>>>>  if int# eq  2 function_return t.calendar.February
31386>>>>>  if int# eq  3 function_return t.calendar.March
31389>>>>>  if int# eq  4 function_return t.calendar.April
31392>>>>>  if int# eq  5 function_return t.calendar.May
31395>>>>>  if int# eq  6 function_return t.calendar.June
31398>>>>>  if int# eq  7 function_return t.calendar.July
31401>>>>>  if int# eq  8 function_return t.calendar.August
31404>>>>>  if int# eq  9 function_return t.calendar.September
31407>>>>>  if int# eq 10 function_return t.calendar.October
31410>>>>>  if int# eq 11 function_return t.calendar.November
31413>>>>>  if int# eq 12 function_return t.calendar.December
31416>>>>>  function_return ""
31417>>>>>end_function
31418>>>>>
31418>>>>>function DateMonthName global date date# returns string
31419>>>>>  function_return (MonthName(DateSegment(date#,DS_MONTH)))
31420>>>>>end_function
31421>>>>>
31421>>>>>function DateAsText global date date# string format# returns string
31422>>>>>  if date# eq 0 function_return ""
31425>>>>>  move (replace("#DN",format#,DateDayName(date#)))                  to format#
31426>>>>>  move (replace("#MN",format#,DateMonthName(date#)))                to format#
31427>>>>>  move (replace("#D" ,format#,string(DateSegment(date#,DS_DAY))))   to format#
31428>>>>>  move (replace("#Y" ,format#,string(DateSegment(date#,DS_YEAR))))  to format#
31429>>>>>  move (replace("#M" ,format#,string(DateSegment(date#,DS_MONTH)))) to format#
31430>>>>>  function_return format#
31431>>>>>end_function
31432>>>>>
31432>>>>>function Year2to4 global integer year# returns integer
31433>>>>>  local integer epoch_value#
31434>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31435>>>>>  if year# lt 100 begin
31437>>>>>    if year# gt epoch_value# function_return (year#+1900)
31440>>>>>    function_return (year#+2000)
31441>>>>>  end
31441>>>>>>
31441>>>>>  function_return year# // No conversion done!
31442>>>>>end_function
31443>>>>>
31443>>>>>function Date2to4 global date date# returns date
31444>>>>>  local integer epoch_value#
31445>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31446>>>>>  if date# gt 0 begin // Only if there is a date to convert
31448>>>>>    if (DateSegment(date#,DS_YEAR)) lt 105 begin
31450>>>>>      if Dates$Year gt epoch_value# function_return (DateIncrement(date#,DS_YEAR,1900))
31453>>>>>      function_return (DateIncrement(date#,DS_YEAR,2000))
31454>>>>>    end
31454>>>>>>
31454>>>>>    function_return date# // No conversion done!
31455>>>>>  end
31455>>>>>>
31455>>>>>end_function
31456>>>>>
31456>>>>>function Date4to2 global date date# returns date
31457>>>>>  local integer epoch_value# year#
31458>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31459>>>>>  if date# gt 0 begin // Only if there is a date to convert
31461>>>>>    move (DateSegment(date#,DS_YEAR)) to year#
31462>>>>>    if year# ge 100 begin // Only then conversion is needed!
31464>>>>>      if (year#>=(1900+epoch_value#) and year#<(2000+epoch_value#)) begin
31466>>>>>        if year# lt 2000 function_return (DateIncrement(date#,DS_YEAR,-1900))
31469>>>>>        else             function_return (DateIncrement(date#,DS_YEAR,-2000))
31471>>>>>      end
31471>>>>>>
31471>>>>>      else error 301 "Date is out of epoch range"
31473>>>>>    end
31473>>>>>>
31473>>>>>  end
31473>>>>>>
31473>>>>>  function_return date# // No conversion done!
31474>>>>>end_function
31475>>>>>
31475>>>>>function dSysDate global returns date
31476>>>>>  local date date#
31477>>>>>  sysdate4 date#
31478>>>>>  function_return date#
31479>>>>>end_function
31480>>>>>
31480>>>>>function iSysYear global returns integer
31481>>>>>  local date date#
31482>>>>>  sysdate4 date#
31483>>>>>  function_return (DateSegment(date#,DS_YEAR))
31484>>>>>end_function
31485>>>>>
31485>>>>>procedure ItemSysdate for desktop integer itm#
31486>>>>>  local date date#
31487>>>>>  get value item itm# to date#
31488>>>>>  if date# eq 0 begin
31490>>>>>    sysdate4 date#
31491>>>>>    set changed_value item itm# to date#
31492>>>>>  end
31492>>>>>>
31492>>>>>end_procedure
31493>>>>>
31493>>>>>procedure ItemDate2to4 for desktop integer itm#
31494>>>>>  local integer year#
31495>>>>>  local date date# new_date#
31495>>>>>  get value item itm# to date#
31496>>>>>
31496>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31497>>>>>  if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31500>>>>>  else move date# to new_date#
31502>>>>>
31502>>>>>  move (Date2to4(new_date#)) to new_date#
31503>>>>>  move (DateSegment(new_date#,3)) to year#
31504>>>>>  if (year#>99 and year#<1000) begin
31506>>>>>    error 15 // Illegal entry in this window
31507>>>>>>
31507>>>>>    procedure_return 1
31508>>>>>  end
31508>>>>>>
31508>>>>>  if new_date# ne date# set value item itm# to new_date#
31511>>>>>end_procedure
31512>>>>>
31512>>>>>procedure ItemYear2to4 for desktop integer itm#
31513>>>>>  local integer year# new_year#
31514>>>>>  get value item itm# to year#
31515>>>>>  if (year#>99 and year#<1000) begin
31517>>>>>    error 15 // Illegal entry in this window
31518>>>>>>
31518>>>>>    procedure_return 1
31519>>>>>  end
31519>>>>>>
31519>>>>>  move (Year2to4(year#)) to new_year#
31520>>>>>  if new_year# ne year# set value item itm# to new_year#
31523>>>>>end_procedure
31524>>>>>
31524>>>>> procedure FieldSysdate for DataDictionary integer fld#
31525>>>>>   local date date#
31526>>>>>   get field_current_value fld# to date#
31527>>>>>   if date# eq 0 begin
31529>>>>>     sysdate4 date#
31530>>>>>     set field_changed_value fld# to date#
31531>>>>>   end
31531>>>>>>
31531>>>>> end_procedure
31532>>>>>
31532>>>>> procedure FieldDate2to4 for DataDictionary integer fld#
31533>>>>>   local integer year#
31534>>>>>   local date date# new_date#
31534>>>>>   get field_current_value fld# to date#
31535>>>>>
31535>>>>>   move (DateSegment(date#,DS_YEAR)) to year#
31536>>>>>   if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31539>>>>>   else move date# to new_date#
31541>>>>>
31541>>>>>   move (Date2to4(new_date#)) to new_date#
31542>>>>>   move (DateSegment(new_date#,3)) to year#
31543>>>>>   if (year#>99 and year# <=999) begin
31545>>>>>     error 15 // Illegal entry in this window
31546>>>>>>
31546>>>>>     procedure_return 1
31547>>>>>   end
31547>>>>>>
31547>>>>>   if new_date# ne date# set field_changed_value fld# to new_date#
31550>>>>> end_procedure
31551>>>>>
31551>>>>> procedure FieldYear2to4 for DataDictionary integer fld#
31552>>>>>   local integer year# new_year# changed#
31553>>>>>   get field_current_value fld# to year#
31554>>>>>   get field_changed_state fld# to changed#
31555>>>>>   if changed# begin
31557>>>>>     if (year#>99 and year#<1000) begin
31559>>>>>       error 15 // Illegal entry in this window
31560>>>>>>
31560>>>>>       procedure_return 1
31561>>>>>     end
31561>>>>>>
31561>>>>>     move (Year2to4(year#)) to new_year#
31562>>>>>     if new_year# ne year# set field_changed_value fld# to new_year#
31565>>>>>   end
31565>>>>>>
31565>>>>> end_procedure
31566>>>>>
31566>>>>> function SysDate global returns date
31567>>>>>   function_return (dSysDate())
31568>>>>> end_function
31569>>>>>
31569>>>>>function sSysTime global returns string
31570>>>>>  local integer h# m# s#
31571>>>>>  sysdate4 h# h# m# s#
31575>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31576>>>>>end_function
31577>>>>>
31577>>>>>function TS_SysTime global returns number
31578>>>>>  local integer d# h# m# s#
31579>>>>>  sysdate4 d# h# m# s#
31583>>>>>  function_return (d#*24.0+h#*60+m#*60+s#)
31584>>>>>end_function
31585>>>>>
31585>>>>>//> This function returns a TS value composed from the date and time
31585>>>>>//> passed to it. Note that the time variable must be of the format
31585>>>>>//> "hh:mm:ss".
31585>>>>>function TS_Compose global date date# string time# returns number
31586>>>>>  local integer h# m# s#
31587>>>>>  left time# to h# 2
31589>>>>>>
31589>>>>>  mid time# to m# 2 4
31592>>>>>>
31592>>>>>  mid time# to s# 2 7
31595>>>>>>
31595>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31596>>>>>end_function
31597>>>>>
31597>>>>>function TS_Compose2 global date date# integer h# integer m# integer s# returns number
31598>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31599>>>>>end_function
31600>>>>>
31600>>>>>function TS_ExtractDate global number time# returns date
31601>>>>>  function_return (time#/86400) // 86400=24*60*60
31602>>>>>end_function
31603>>>>>
31603>>>>>function TS_ExtractTime global number time# returns string
31604>>>>>  local integer h# m# s#
31605>>>>>  move (time#-(86400.0*integer(TS_ExtractDate(time#)))) to s#
31606>>>>>  move (s#/3600) to h#
31607>>>>>  move (s#-(h#*3600)) to s#
31608>>>>>  move (s#/60) to m#
31609>>>>>  move (s#-(m#*60)) to s#
31610>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31611>>>>>end_function
31612>>>>>
31612>>>>>function TS_ConvertToString global number time# returns string
31613>>>>>  local date d#
31614>>>>>  move (TS_ExtractDate(time#)) to d#
31615>>>>>  if (integer(d#)) function_return (string(d#)+" "+TS_ExtractTime(time#))
31618>>>>>  else function_return (TS_ExtractTime(time#))
31620>>>>>end_function
31621>>>>>
31621>>>>>function TS_ConvertToStringNoDate global number ts# returns string
31622>>>>>  local integer h# m#
31623>>>>>  move (ts#/3600) to h#
31624>>>>>  move (ts#-(h#*3600)) to ts#
31625>>>>>  move (ts#/60) to m#
31626>>>>>  move (ts#-(m#*60)) to ts#
31627>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(ts#<10,"0","")+string(ts#))
31628>>>>>end_function
31629>>>>>
31629>>>>>// This procedure is used when a TS-variable must be displayed on screen.
31629>>>>>procedure TS_UI_Update global number TS# integer obj1# integer itm1# integer tmp_obj2# integer tmp_itm2#
31630>>>>>  local integer obj2# itm2#
31631>>>>>  if num_arguments gt 3 begin
31633>>>>>    move tmp_obj2# to obj2#
31634>>>>>    move tmp_itm2# to itm2#
31635>>>>>  end
31635>>>>>>
31635>>>>>  else begin
31636>>>>>    move obj1# to obj2#
31637>>>>>    move (itm1#+1) to itm2#
31638>>>>>  end
31638>>>>>>
31638>>>>>  set value of obj1# item itm1# to (TS_ExtractDate(TS#))
31639>>>>>  set value of obj2# item itm2# to (TS_ExtractTime(TS#))
31640>>>>>end_procedure
31641>>>>>
31641>>>>>class TS_TimeEstimator is an array
31642>>>>>  procedure construct_object
31643>>>>>    forward send construct_object
31645>>>>>    set delegation_mode to delegate_to_parent
31646>>>>>    property number  pnTotal   public 0 // Seconds needed to run the loop.
31647>>>>>    property number  pnElapsed public 0 // Seconds elapsed so far.
31648>>>>>    property number  pnLeft    public 0 // Number of seconds left
31649>>>>>    property number  pnStart   public 0
31650>>>>>    property number  pnPause   public 0
31651>>>>>    property number  pnPercent public 0
31652>>>>>    property integer piMin     public 0
31653>>>>>    property integer piMax     public 0
31654>>>>>  end_procedure
31655>>>>>
31655>>>>>  procedure TS_Start integer min# integer max#
31656>>>>>    set piMin to min#
31657>>>>>    set piMax to max#
31658>>>>>    set pnStart to (TS_SysTime())
31659>>>>>    set pnElapsed to 0
31660>>>>>    set pnPercent to 0
31661>>>>>  end_procedure
31662>>>>>
31662>>>>>  procedure TS_Calculate integer pos#
31663>>>>>    local integer min# max#
31664>>>>>    get piMin to min#
31665>>>>>    get piMax to max#
31666>>>>>    set pnElapsed to (TS_SysTime()-pnStart(current_object))
31667>>>>>    set pnTotal   to (pnElapsed(current_object)*(max#-min#)/number(pos#-min#))
31668>>>>>    set pnLeft    to (pnTotal(current_object)-pnElapsed(current_object))
31669>>>>>    set pnPercent to (100.0*(pos#-min#)/(max#-min#))
31670>>>>>  end_procedure
31671>>>>>
31671>>>>>  procedure TS_Pause
31672>>>>>    set pnPause to (TS_SysTime())
31673>>>>>  end_procedure
31674>>>>>
31674>>>>>  procedure TS_Continue
31675>>>>>    set pnStart to (pnStart(current_object)+TS_SysTime()-pnPause(current_object))
31676>>>>>  end_procedure
31677>>>>>end_class
31678>>>>>
31678>>>>>function TS_Module_Compile_Time global string path# returns number
31679>>>>>  local integer pos# day# month# year# seqeof# ch#
31680>>>>>  local string date# str# time#
31680>>>>>  move path# to str#
31681>>>>>  if str# ne "" begin
31683>>>>>    get Seq_New_Channel to ch#   // This method and Seq_Release_Channel are
31684>>>>>    send Seq_Release_Channel ch# // We only need it for a second
31685>>>>>      direct_input channel ch# (trim(str#)+".vd6") // VDF 6
31687>>>>>      [seqeof] direct_input channel ch# (trim(str#)+".vd5") // VDF 5
31689>>>>>    [ seqeof] move 1 to seqeof#
31690>>>>>    [~seqeof] move 0 to seqeof#
31691>>>>>    [~seqeof] readln str#
31692>>>>>    close_input channel ch#
31694>>>>>  end
31694>>>>>>
31694>>>>>  if seqeof# function_return 0
31697>>>>>  pos "," in str# to pos#
31699>>>>>>
31699>>>>>  move (mid(str#,18,pos#+2)) to str#
31700>>>>>  move (integer(mid(str#,2,4))) to day#
31701>>>>>  move (integer(mid(str#,2,1))) to month#
31702>>>>>  move (integer(mid(str#,2,7))) to year#
31703>>>>>  if year# eq 10 begin
31705>>>>>    move (integer(mid(str#,3,7))+1900) to year#
31706>>>>>    move (mid(str#,8,11)) to str#
31707>>>>>  end
31707>>>>>>
31707>>>>>  else move (mid(str#,8,10)) to str#
31709>>>>>  move (DateCompose(day#,month#,year#)) to date#
31710>>>>>  move (Date2to4(date#)) to date#
31711>>>>>  pos ":" in str# to pos#
31713>>>>>>
31713>>>>>  function_return (TS_Compose(date#,mid(str#,8,pos#-2)))
31714>>>>>end_function
31715>>>>>
31715>>>>>string Dates$Module_Compile_Time
31715>>>>>move "" to Dates$Module_Compile_Time
31716>>>>>
31716>>>>>function Module_Compile_Date global returns date
31717>>>>>  local number ts#
31718>>>>>  local string str#
31718>>>>>  get module_name to str# // 'module_name' is most likely the name of the .flx file.
31719>>>>>  get TS_Module_Compile_Time str# to ts#
31720>>>>>  move (TS_ExtractTime(ts#)) to Dates$Module_Compile_Time
31721>>>>>  function_return (TS_ExtractDate(ts#))
31722>>>>>end_function
31723>>>>>
31723>>>>>function Module_Compile_Time global returns string
31724>>>>>  local date grb#
31725>>>>>  // Module_Compile_Date must be called before this one!
31725>>>>>  if Dates$Module_Compile_Time eq "" move (Module_Compile_Date()) to grb#
31728>>>>>  function_return Dates$Module_Compile_Time
31729>>>>>end_function
31730>>>>>
31730>>>>>date   Dates$ModuleStartDate
31730>>>>>string Dates$ModuleStartTime 8
31730>>>>>move (dSysDate()) to Dates$ModuleStartDate
31731>>>>>move (sSysTime()) to Dates$ModuleStartTime
31732>>>>>
31732>>>>>function Module_Start_Date global returns date
31733>>>>>  function_return Dates$ModuleStartDate
31734>>>>>end_function
31735>>>>>
31735>>>>>function Module_Start_Time global returns string
31736>>>>>  function_return Dates$ModuleStartTime
31737>>>>>end_function
31738>>>>>
31738>>>>> register_procedure NotifyPopupCalendarChange date date#
31738>>>>> register_procedure NotifyPopupCalendarSelect date date#
31738>>>>>  use dfAllent
31738>>>>>  class calendar.textbox is a textbox
31739>>>>>    procedure construct_object
31740>>>>>      forward send construct_object
31742>>>>>      Set Auto_Size_State To False
31743>>>>>      Set Justification_Mode To (jMode_vCenter+jMode_Center)
31744>>>>>    end_procedure
31745>>>>>  end_class
31746>>>>>
31746>>>>>  register_object btn1
31746>>>>>  register_object btn6
31746>>>>>
31746>>>>>  class calendar.button is a button
31747>>>>>
31747>>>>>    procedure construct_object
31748>>>>>      forward send construct_object
31750>>>>>      set size to 15 18
31751>>>>>      on_key kleftarrow   send prev_day
31752>>>>>      on_key krightarrow  send next_day
31753>>>>>      on_key kuparrow     send prev_week
31754>>>>>      on_key kdownarrow   send next_week
31755>>>>>      property date p_assigned_date public 0
31756>>>>>    end_procedure
31757>>>>>
31757>>>>>    procedure switch // This makes all 42 buttons act as if they are one focus
31758>>>>>      send activate to (btn1(current_object))
31759>>>>>    end_procedure
31760>>>>>    procedure switch_back
31761>>>>>      send activate to (btn6(current_object))
31762>>>>>    end_procedure
31763>>>>>
31763>>>>>    procedure mouse_down
31764>>>>>      local integer current_object#
31765>>>>>      forward send mouse_down
31767>>>>>      move current_object to current_object#
31768>>>>>      delegate set p_current_date to (p_assigned_date(current_object#))
31770>>>>>    end_procedure
31771>>>>>  end_class
31772>>>>>
31772>>>>>  desktop_section
31778>>>>>    object popup_calendar is a ModalPanel
31780>>>>>      set size to 160 250
31781>>>>>      property date    p_current_date  public 0
31783>>>>>      property integer p_current_year  public -1
31785>>>>>      property integer p_current_month public -1
31787>>>>>      property integer pExportState    public 1
31789>>>>>
31789>>>>>      on_key key_ctrl+key_pgup send prev_year
31790>>>>>      on_key key_ctrl+key_pgdn send next_year
31791>>>>>      on_key          key_pgup send prev_month
31792>>>>>      on_key          key_pgdn send next_month
31793>>>>>      on_key key_ctrl+key_d    send go_today
31794>>>>>      on_key kcancel           send cancel
31795>>>>>
31795>>>>>      object cont3d is a container3d
31797>>>>>        set location to 5 5
31798>>>>>        set size to 120 237
31799>>>>>        object textbox_year is a calendar.textbox
31801>>>>>          set location to 5 5
31802>>>>>          set size to 15 30
31803>>>>>          set border_style to border_staticedge
31804>>>>>          procedure display
31806>>>>>            set value to (p_current_year(current_object))
31807>>>>>          end_procedure
31808>>>>>        end_object
31809>>>>>        object dayname_header is a container3d
31811>>>>>          set location to 5 39
31812>>>>>          set size to 15 126
31813>>>>>          set border_style to border_staticedge
31814>>>>>          procedure initialize
31816>>>>>            local integer itm#
31817>>>>>            for itm# from 0 to 6
31823>>>>>>
31823>>>>>              object txt is a calendar.textbox
31825>>>>>                set size to 12 17
31826>>>>>                set location to 0 (itm#*17.6+1)
31827>>>>>                 set value to (left(DayName(itm#+1),3))
31828>>>>>              end_object
31829>>>>>            loop
31830>>>>>>
31830>>>>>          end_procedure
31831>>>>>          send initialize
31832>>>>>        end_object
31833>>>>>        object weeknumber_header is a container3d
31835>>>>>          set location to 24 5
31836>>>>>          set size     to 89 30
31837>>>>>          set border_style to border_staticedge
31838>>>>>          object obj_id_array is an array
31840>>>>>          end_object
31841>>>>>          procedure initialize
31843>>>>>            local integer itm# obj#
31844>>>>>            move (obj_id_array(current_object)) to obj#
31845>>>>>            for itm# from 0 to 5
31851>>>>>>
31851>>>>>              object txt is a textbox
31853>>>>>                set size to 15 30
31854>>>>>                set location to (itm#*15+1) 1
31855>>>>>                set value of obj# item (item_count(obj#)) to current_object
31856>>>>>              end_object
31857>>>>>            loop
31858>>>>>>
31858>>>>>          end_procedure
31859>>>>>          procedure display
31861>>>>>            local integer itm# obj#
31862>>>>>            local date date# last_date#
31862>>>>>            move (obj_id_array(current_object)) to obj#
31863>>>>>            get p_current_date to date#
31864>>>>>            move (FirstDayInMonth(date#)) to date#
31865>>>>>            move (LastDayInMonth(date#)) to last_date#
31866>>>>>            move (date#-DateDayNumber(date#)+1) to date#
31867>>>>>            for itm# from 0 to 5
31873>>>>>>
31873>>>>>              if (itm#*7+date#) le last_date# ;                set value of (integer(value(obj#,itm#))) to (t.calendar.week*string(DateWeekNumber(itm#*7+date#)))
31876>>>>>              else set value of (integer(value(obj#,itm#))) to ""
31878>>>>>            loop
31879>>>>>>
31879>>>>>          end_procedure
31880>>>>>          send initialize
31881>>>>>        end_object
31882>>>>>        object days_grid is a container3d
31884>>>>>          set location to 23 39
31885>>>>>          set size     to 100 127
31886>>>>>          set border_style to border_none
31887>>>>>          object btn_array is an array
31889>>>>>          end_object
31890>>>>>          procedure initialize
31892>>>>>            local integer row# col# button_array#
31893>>>>>            move (btn_array(current_object)) to button_array#
31894>>>>>            for row# from 0 to 5
31900>>>>>>
31900>>>>>              for col# from 0 to 6
31906>>>>>>
31906>>>>>                object btn is a calendar.button
31908>>>>>                  set location to (row#*15) (col#*18)
31909>>>>>                  set value of button_array# item (item_count(button_array#)) to current_object
31910>>>>>                  on_item "" send move_value_out_ok
31911>>>>>                end_object
31912>>>>>              loop
31913>>>>>>
31913>>>>>            loop
31914>>>>>>
31914>>>>>          end_procedure
31915>>>>>          send initialize
31916>>>>>
31916>>>>>          procedure display.iii integer itm# integer day# integer activate#
31918>>>>>            local integer obj# current_day#
31919>>>>>            move (integer(value(btn_array(current_object),itm#))) to obj#
31920>>>>>            move (DateSegment(p_current_date(current_object),DS_DAY)) to current_day#
31921>>>>>            if activate# begin
31923>>>>>              if day# eq current_day# send activate to obj#
31926>>>>>            end
31926>>>>>>
31926>>>>>            else begin
31927>>>>>              if day# begin
31929>>>>>                set value of obj# to day#
31930>>>>>                set visible_state of obj# to true
31931>>>>>                set p_assigned_date of obj# to (DateCompose(day#,p_current_month(current_object),p_current_year(current_object)))
31932>>>>>              end
31932>>>>>>
31932>>>>>              else set visible_state of obj# to false
31934>>>>>            end
31934>>>>>>
31934>>>>>          end_procedure
31935>>>>>
31935>>>>>          procedure display integer activate#
31937>>>>>            local integer first_item# last_item# itm# day# date#
31938>>>>>            get p_current_date to date#
31939>>>>>            move (FirstDayInMonth(date#)) to date#
31940>>>>>            move (DateDayNumber(date#)-1) to first_item#
31941>>>>>            move (LastDayInMonth(date#)-date#+first_item#) to last_item#
31942>>>>>            ifnot activate# begin
31944>>>>>              for itm# from 0 to (first_item#-1)
31950>>>>>>
31950>>>>>                send display.iii itm# 0 0
31951>>>>>              loop
31952>>>>>>
31952>>>>>            end
31952>>>>>>
31952>>>>>            move 1 to day#
31953>>>>>            for itm# from first_item# to last_item#
31959>>>>>>
31959>>>>>              send display.iii itm# day# activate#
31960>>>>>              increment day#
31961>>>>>            loop
31962>>>>>>
31962>>>>>            ifnot activate# begin
31964>>>>>              for itm# from (last_item#+1) to 41
31970>>>>>>
31970>>>>>                send display.iii itm# 0 0
31971>>>>>              loop
31972>>>>>>
31972>>>>>            end
31972>>>>>>
31972>>>>>          end_procedure
31973>>>>>        end_object
31974>>>>>        object txt_month is a calendar.textbox
31976>>>>>          set size to 12 27
31977>>>>>          set location to 25 185
31978>>>>>          set value to t.calendar.month
31979>>>>>        end_object
31980>>>>>        object btn1 is a button
31982>>>>>          set size to 12 12
31983>>>>>          set location to 40 185
31984>>>>>          on_item "" send prev_month
31985>>>>>          set bitmap to "prev.bmp"
31986>>>>>          procedure switch_back
31988>>>>>            send display_main
31989>>>>>          end_procedure
31990>>>>>        end_object
31991>>>>>        object btn2 is a button
31993>>>>>          set size to 12 12
31994>>>>>          set location to 40 200
31995>>>>>          on_item "" send next_month
31996>>>>>          set bitmap to "next.bmp"
31997>>>>>        end_object
31998>>>>>        object txt_year is a calendar.textbox
32000>>>>>          set size to 12 27
32001>>>>>          set location to 70 185
32002>>>>>          set value to t.calendar.year
32003>>>>>        end_object
32004>>>>>        object btn3 is a button
32006>>>>>          set size to 12 12
32007>>>>>          set location to 85 185
32008>>>>>          on_item "" send prev_year
32009>>>>>          set bitmap to "prev.bmp"
32010>>>>>        end_object
32011>>>>>        object btn4 is a button
32013>>>>>          set size to 12 12
32014>>>>>          set location to 85 200
32015>>>>>          on_item "" send next_year
32016>>>>>          set bitmap to "next.bmp"
32017>>>>>        end_object
32018>>>>>      end_object
32019>>>>>      object btn5 is a button
32021>>>>>        set size to 14 60
32022>>>>>        set location to 129 115
32023>>>>>        on_item t.calendar.ok send move_value_out_ok
32024>>>>>      end_object
32025>>>>>      object btn6 is a button
32027>>>>>        set size to 14 60
32028>>>>>        set location to 129 182
32029>>>>>        on_item t.calendar.cancel send cancel
32030>>>>>        procedure switch
32032>>>>>          send display_main
32033>>>>>        end_procedure
32034>>>>>      end_object
32035>>>>>      procedure next_year
32037>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32038>>>>>        send display_main
32039>>>>>      end_procedure
32040>>>>>      procedure prev_year
32042>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32043>>>>>        send display_main
32044>>>>>      end_procedure
32045>>>>>      procedure next_month
32047>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32048>>>>>        send display_main
32049>>>>>      end_procedure
32050>>>>>      procedure prev_month
32052>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32053>>>>>        send display_main
32054>>>>>      end_procedure
32055>>>>>      procedure next_week
32057>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,1))
32058>>>>>        send display_main
32059>>>>>      end_procedure
32060>>>>>      procedure prev_week
32062>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,-1))
32063>>>>>        send display_main
32064>>>>>      end_procedure
32065>>>>>      procedure next_day
32067>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,1))
32068>>>>>        send display_main
32069>>>>>      end_procedure
32070>>>>>      procedure prev_day
32072>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,-1))
32073>>>>>        send display_main
32074>>>>>      end_procedure
32075>>>>>      procedure go_today
32077>>>>>        local date date#
32078>>>>>        sysdate4 date#
32079>>>>>        set p_current_date to date#
32080>>>>>        send display_main
32081>>>>>      end_procedure
32082>>>>>      property integer invoking_object_id public 0
32084>>>>>      procedure OnChange date date#
32086>>>>>        local integer focus# dm#
32087>>>>>        get invoking_object_id to focus#
32088>>>>>        if focus# gt desktop begin
32090>>>>>          get delegation_mode of focus# to dm#
32091>>>>>          set delegation_mode of focus# to no_delegate_or_error
32092>>>>>          send NotifyPopupCalendarChange to focus# date#
32093>>>>>          set delegation_mode of focus# to dm#
32094>>>>>        end
32094>>>>>>
32094>>>>>      end_procedure
32095>>>>>      procedure display
32097>>>>>        local integer date# month# year#
32098>>>>>        get p_current_date to date#
32099>>>>>        send OnChange date#
32100>>>>>        move (DateSegment(date#,DS_YEAR)) to year#
32101>>>>>        move (DateSegment(date#,DS_MONTH)) to month#
32102>>>>>        if (p_current_year(current_object)<>year# or p_current_month(current_object)<>month#) begin
32104>>>>>          set p_current_year to year#
32105>>>>>          set p_current_month to month#
32106>>>>>          set value to (t.calendar.calendar_popup+", "+MonthName(month#))
32107>>>>>          send display to (textbox_year(cont3d(current_object)))
32108>>>>>          send display to (weeknumber_header(cont3d(current_object)))
32109>>>>>          send display to (days_grid(cont3d(current_object))) 0
32110>>>>>        end
32110>>>>>>
32110>>>>>      end_procedure
32111>>>>>      procedure display_main
32113>>>>>        send display
32114>>>>>        send display to (days_grid(cont3d(current_object))) 1
32115>>>>>      end_procedure
32116>>>>>      procedure popup_no_export
32118>>>>>        set pExportState to false
32119>>>>>        send popup
32120>>>>>        set pExportState to true
32121>>>>>      end_procedure
32122>>>>>
32122>>>>>      procedure popup_group
32124>>>>>        local integer focus#
32125>>>>>        local date date#
32125>>>>>        move (focus(desktop)) to focus#
32126>>>>>        set invoking_object_id to focus#
32127>>>>>        get value of focus# item current to date#
32128>>>>>        ifnot (integer(date#)) move (dSysdate()) to date#
32131>>>>>        move (Date2to4(date#)) to date#
32132>>>>>        set p_current_date to date#
32133>>>>>        send display
32134>>>>>        forward send popup_group
32136>>>>>        send display to (days_grid(cont3d(current_object))) 1
32137>>>>>      end_procedure
32138>>>>>
32138>>>>>      procedure move_value_out
32140>>>>>        local integer focus# dm# margin# datatype#
32141>>>>>        if (pExportState(current_object)) begin
32143>>>>>          get invoking_object_id to focus#
32144>>>>>          if focus# gt desktop begin
32146>>>>>            get delegation_mode of focus# to dm#
32147>>>>>            set delegation_mode of focus# to no_delegate_or_error
32148>>>>>            send NotifyPopupCalendarSelect to focus# (p_current_date(current_object))
32149>>>>>            get form_margin of focus# item current to margin#
32150>>>>>            get form_datatype of focus# item current to datatype#
32151>>>>>            set delegation_mode of focus# to dm#
32152>>>>>            if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to (p_current_date(current_object))
32155>>>>>            else             set value of focus# item current to (Date4to2(p_current_date(current_object)))
32157>>>>>            set item_changed_state of focus# item current to true
32158>>>>>          end
32158>>>>>>
32158>>>>>        end
32158>>>>>>
32158>>>>>      end_procedure
32159>>>>>
32159>>>>>      procedure move_value_out_ok
32161>>>>>        send move_value_out
32162>>>>>        send deactivate
32163>>>>>      end_procedure
32164>>>>>
32164>>>>>      procedure request_popup
32166>>>>>        local integer focus# type# dm#
32167>>>>>        move (focus(desktop)) to focus#
32168>>>>>        if focus# gt desktop begin
32170>>>>>          get delegation_mode of focus# to dm#
32171>>>>>          set delegation_mode of focus# to no_delegate_or_error
32172>>>>>          get form_datatype of focus# item current to type#
32173>>>>>          if (type#=date_window or type#=mask_date_window) send popup
32176>>>>>          set delegation_mode of focus# to dm#
32177>>>>>        end
32177>>>>>>
32177>>>>>      end_procedure
32178>>>>>    end_object
32179>>>>>  end_desktop_section
32181>>>>>  // If the procedure below was not defined "for BaseClass" its symbolic
32181>>>>>  // substitute would become negative (because located on the desktop). This
32181>>>>>  // would result in the toolbar object not being able to handle it. Therefore:
32181>>>>>  procedure request_popup_calendar for BaseClass
32182>>>>>    send request_popup to (popup_calendar(current_object))
32183>>>>>  end_procedure
32184>>>>>  procedure popup_calendar_no_export
32185>>>>>    send popup_no_export to (popup_calendar(current_object))
32186>>>>>  end_procedure
32187>>>>>  register_procedure Add_Toolbar_Button_Bitmap string bmp# string Tip# string StHlp# integer msg# integer obj#
32187>>>>>  procedure Add_Calendar_tbButton integer oTb#
32188>>>>>    send Add_Toolbar_Button_Bitmap to oTb# "DfCalend.bmp" t.calendar.calendar_popup t.calendar.Activate msg_request_popup_calendar
32189>>>>>  end_procedure
32190>>>>> function s.calendar returns integer // Backwards compatible!!
32191>>>>>   function_return (popup_calendar(current_object))
32192>>>>> end_function
32193>>>>>
32193>>>>>// Karl,
32193>>>>>// Structure is as follows,
32193>>>>>//
32193>>>>>// //put this code in the top portion of the view code or in the program
32193>>>>>// code.
32193>>>>>//
32193>>>>>// Type SystemTime
32193>>>>>//   field SystemTime.iYear As Word
32193>>>>>//   field SystemTime.iMonth As Word
32193>>>>>//   field SystemTime.iDayOfWeek As Word
32193>>>>>//   field SystemTime.iDay As Word
32193>>>>>//   field SystemTime.iHour As Word
32193>>>>>//   field SystemTime.iMinute As Word
32193>>>>>//   field SystemTime.iSecond As Word
32193>>>>>//   field SystemTime.iMilliseconds As Word
32193>>>>>// End_Type
32193>>>>>//
32193>>>>>// external_function GetSystemTime "GetSystemTime" kernel32.dll Pointer lpGST Returns VOID_TYPE
32193>>>>>//
32193>>>>>// //put this code in an onClick or wherever
32193>>>>>// procedure onclick
32193>>>>>//   local integer iRetVal
32193>>>>>//   local string TimeData
32193>>>>>//   local pointer GST
32193>>>>>//
32193>>>>>//   ZeroType SystemTime to TimeData
32193>>>>>//   getAddress from TimeData to GST
32193>>>>>//
32193>>>>>//   move (GetSystemTime(GST)) to iRetVal
32193>>>>>// end_procedure
32193>>>>>//
32193>>>>>// To extract the data from the Structure after calling the function use
32193>>>>>// the getbuff command as follows:
32193>>>>>//
32193>>>>>// getbuff from TimeData as SystemTime.IVAL to var
32193>>>>>//
32193>>>>>// where IVAL is one of the vars such as iYear or iDay, etc.
32193>>>>>//
32193>>>>>// OLIVER NELSON
32193>>>>>//
32193>>>>>//
32193>>>
32193>>>//AB-StoreTopEnd
32193>>>
32193>>>//AB-IgnoreStart
32193>>>
32193>>>Use DFAllEnt.pkg
32193>>>
32193>>>
32193>>>//AB-IgnoreEnd
32193>>>
32193>>>CD_Popup_Object oCalendar is a dbModalPanel
32212>>>
32212>>>    //AB-StoreTopStart
32212>>>    on_key kcancel           send cancel
32213>>>    //AB-StoreTopEnd
32213>>>
32213>>>    Set Border_Style to Border_Normal
32214>>>    Set Caption_Bar to FALSE
32215>>>    Set Label to "Ÿ­¢ àì, 2001"
32216>>>    Set Size to 98 123
32217>>>    Set Location to 10 22
32218>>>    Set Color to clWhite
32219>>>
32219>>>    //AB-DDOStart
32219>>>
32219>>>
32219>>>    //AB-DDOEnd
32219>>>
32219>>>    Object Container3d1 is a Container3d
32221>>>        Set Size to 88 135
32222>>>        Set Location to -2 -1
32223>>>        Set Color to clWhite
32224>>>        Set Border_Style to Border_None
32225>>>        Object Grid2 is a Grid
32227>>>
32227>>>            //AB-StoreTopStart
32227>>>            property date    p_current_date     public 0
32229>>>            property integer p_current_year     public -1
32231>>>            property integer p_current_month    public -1
32233>>>            property integer p_selected_day     public -1
32235>>>            property integer pExportState       public 1
32237>>>            property integer invoking_object_id public 0
32239>>>            
32239>>>            Set Border_Style To BORDER_NONE
32240>>>            Set header_visible_state To False
32241>>>            set select_mode to no_select
32242>>>            Set Gridline_mode To GRID_VISIBLE_NONE
32243>>>            
32243>>>            on_key Key_F1 Send Help
32244>>>            on_key key_ctrl+key_pgup send prev_year
32245>>>            on_key key_ctrl+key_pgdn send next_year
32246>>>            on_key          key_pgup send prev_month
32247>>>            on_key          key_pgdn send next_month
32248>>>            on_key key_enter         send move_value_out
32249>>>            on_key key_ctrl+key_d    send go_today
32250>>>            
32250>>>            //AB-StoreTopEnd
32250>>>
32250>>>            Set Color to clWhite
32251>>>            Set CurrentCellColor to clWhite
32252>>>            Set CurrentCellTextColor to clWhite
32253>>>            Set Size to 61 145
32254>>>            Set Location to 30 1
32255>>>            Set Resize_Column_state to FALSE
32256>>>
32256>>>            Set Line_Width to 7 0
32257>>>
32257>>>            Set Form_Width    item 0 to 18
32258>>>            Set Header_Label  item 0 to "­"
32259>>>            
32259>>>            Set Form_Width    item 1 to 18
32260>>>            Set Header_Label  item 1 to "‚â"
32261>>>            
32261>>>            Set Form_Width    item 2 to 18
32262>>>            Set Header_Label  item 2 to "‘à"
32263>>>            
32263>>>            Set Form_Width    item 3 to 18
32264>>>            Set Header_Label  item 3 to "—â"
32265>>>            
32265>>>            Set Form_Width    item 4 to 18
32266>>>            Set Header_Label  item 4 to "â"
32267>>>            
32267>>>            Set Form_Width    item 5 to 18
32268>>>            Set Header_Label  item 5 to "‘¡"
32269>>>            
32269>>>            Set Form_Width    item 6 to 18
32270>>>            Set Header_Label  item 6 to "‚á"
32271>>>            
32271>>>
32271>>>            //AB-StoreStart
32271>>>            
32271>>>            procedure go_today
32273>>>                Date date#
32274>>>                sysdate4 date#
32275>>>                set p_current_date to date#
32276>>>                Send Update_Calendar
32277>>>            end_procedure
32278>>>            
32278>>>            procedure next_month
32280>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32281>>>                Send Update_Calendar
32282>>>            end_procedure
32283>>>            
32283>>>            procedure prev_month
32285>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32286>>>                Send Update_Calendar
32287>>>            end_procedure
32288>>>            
32288>>>            procedure next_year
32290>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32291>>>                Send Update_Calendar
32292>>>            end_procedure
32293>>>            
32293>>>            procedure prev_year
32295>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32296>>>                Send Update_Calendar
32297>>>            end_procedure
32298>>>            
32298>>>            Procedure Activate
32300>>>                Date date#
32301>>>                Forward Send Activate
32303>>>                Set current_item to (p_selected_day(Self))
32304>>>            End_Procedure
32305>>>            
32305>>>            Procedure Update_Calendar
32307>>>                Set Dynamic_Update_State To False
32308>>>                send Fill_List
32309>>>                Set Dynamic_Update_State To True
32310>>>                // Send Update_Label
32310>>>                Set current_item to (p_selected_day(Self))
32311>>>                Send Date_Changing to (oYear(Container3d2(self)))
32312>>>                Send Date_Changing to (oMonth(Container3d2(self)))
32313>>>            End_Procedure
32314>>>            
32314>>>            Procedure Fill_List
32316>>>                Integer iFor prevdate# date# first_item# last_item# day# prev_last# nextdate# next_first#
32317>>>                Integer cur_year# cur_month# cur_day# sel_month# sel_day# sel_year#
32317>>>                Date dToday
32317>>>                Send Delete_Data
32318>>>            
32318>>>                Get p_current_date to date#
32319>>>            
32319>>>                SysDate4 dToday
32320>>>                move (DateSegment(dToday,DS_DAY)) to cur_day#
32321>>>                move (DateSegment(dToday,DS_MONTH)) to cur_month#
32322>>>                move (DateSegment(dToday,DS_YEAR)) to cur_year#
32323>>>            
32323>>>                move (DateSegment(date#,DS_DAY)) to sel_day#
32324>>>                move (DateSegment(date#,DS_MONTH)) to sel_month#
32325>>>                move (DateSegment(date#,DS_YEAR)) to sel_year#
32326>>>                Set p_current_month To sel_month#
32327>>>                Set p_current_year To sel_year#
32328>>>            
32328>>>                move (FirstDayInMonth(date#)) to date#
32329>>>                move (DateDayNumber(date#)-1) to first_item#
32330>>>                move (LastDayInMonth(date#)-date#+first_item#) to last_item#
32331>>>                move (DateIncrement(date#,DS_Month,-1)) To prevdate#
32332>>>                move (DateSegment((LastDayInMonth(prevdate#)),DS_DAY)) to prev_last#
32333>>>            
32333>>>                If (first_item# > 0) Begin
32335>>>                    Move (first_item#-1) to day#
32336>>>                    For iFor from 0 to (first_item#-1)
32342>>>>
32342>>>                        Send Add_Item msg_move_value_out (prev_last#-day#)
32343>>>                        Set Entry_State Item iFor To False
32344>>>                        Set ItemTextColor Item iFor To clGray
32345>>>                        Decrement day#
32346>>>                    Loop
32347>>>>
32347>>>                End
32347>>>>
32347>>>            
32347>>>                Move 1 To day#
32348>>>                For iFor from first_item# to last_item#
32354>>>>
32354>>>                    Send Add_Item Msg_Move_Value_Out day#
32355>>>                    Set Entry_State Item iFor To False
32356>>>                    If ((cur_month# eq sel_month#)and(cur_year# eq sel_year#)and(Day# eq cur_day#)) Set Form_Bitmap Item iFor To "cdate.bmp"
32359>>>                    If Day# eq sel_day# Set p_selected_day To iFor
32362>>>                    Set Form_justification_mode Item iFor To FORM_DISPLAYRIGHT
32363>>>                    Set form_datatype item iFor To mask_numeric_window
32364>>>                    Set form_Mask item iFor To "## "
32365>>>                    Increment day#
32366>>>                Loop
32367>>>>
32367>>>            
32367>>>                move (DateIncrement(date#,DS_Month,1)) To nextdate#
32368>>>                move (DateSegment((LastDayInMonth(nextdate#)),DS_DAY)) to next_first#
32369>>>            
32369>>>                If (last_item# < 41) Begin
32371>>>                    Move 1 to day#
32372>>>                    For iFor from (last_item#+1) to 41
32378>>>>
32378>>>                        Send Add_Item msg_move_value_out day#
32379>>>                        Set Entry_State Item iFor To False
32380>>>                        Set ItemTextColor Item iFor To clGray
32381>>>                        Increment day#
32382>>>                    Loop
32383>>>>
32383>>>                End
32383>>>>
32383>>>            
32383>>>            End_Procedure
32384>>>            
32384>>>            Procedure Help
32386>>>                Send Info_Box ("<Up>, <Dn>, <Lft>, <Rgt> - select date.\n<PgUp>, <PgDn> - select month.\n<Ctrl>+<D> - set current date.\n<Ctrl>+<PgUp>, <PgDn> - Select year.\n\n(c) 2001, SCR. Special thanks to Sture Andersen.") ("Help on Calendar")
32387>>>            End_Procedure
32388>>>            
32388>>>            procedure mouse_click integer window integer char_pos
32390>>>                Send Move_Value_Out
32391>>>                forward send mouse_click window char_pos
32393>>>            end_procedure
32394>>>            
32394>>>            Procedure Move_Value_Out
32396>>>                Integer iYear iMonth iDay iItm
32397>>>                Date Date# next_date# prev_date#
32397>>>                Get Current_Item To iItm
32398>>>                If (pExportState(Self)) Begin
32400>>>                    Get Value Item iItm To iDay
32401>>>                    Get p_current_month to iMonth
32402>>>                    Get p_current_year  to iYear
32403>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32404>>>            
32404>>>                    If ((iItm>27)and(iDay<15)) Begin
32406>>>                        Move (DateCompose(1,iMonth,iYear)) To next_date#
32407>>>                        move (DateIncrement(next_date#,DS_Month,1)) To next_date#
32408>>>                        move (DateSegment(next_date#,DS_MONTH)) to iMonth
32409>>>                        move (DateSegment(next_date#,DS_YEAR)) to iYear
32410>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32411>>>                    End
32411>>>>
32411>>>                    If ((iItm<7)and(iDay>20)) Begin
32413>>>                        Move (DateCompose(1,iMonth,iYear)) To prev_date#
32414>>>                        move (DateIncrement(prev_date#,DS_Month,-1)) To prev_date#
32415>>>                        move (DateSegment(prev_date#,DS_MONTH)) to iMonth
32416>>>                        move (DateSegment(prev_date#,DS_YEAR)) to iYear
32417>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32418>>>                    End
32418>>>>
32418>>>            
32418>>>                    Send Export_Date date#
32419>>>                End
32419>>>>
32419>>>            End_Procedure
32420>>>            
32420>>>            Procedure Export_Date date date#
32422>>>                local integer focus# dm# margin# datatype#
32423>>>                get invoking_object_id to focus#
32424>>>            
32424>>>                if focus# gt desktop begin
32426>>>                     get delegation_mode of focus# to dm#
32427>>>                     set delegation_mode of focus# to no_delegate_or_error
32428>>>                     get form_margin of focus# item current to margin#
32429>>>                     get form_datatype of focus# item current to datatype#
32430>>>                     set delegation_mode of focus# to dm#
32431>>>                     if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to date#
32434>>>                     else             set value of focus# item current to (Date4to2(date#))
32436>>>                     set item_changed_state of focus# item current to true
32437>>>                end
32437>>>>
32437>>>                Send Close_Calendar
32438>>>            End_Procedure
32439>>>            //AB-StoreEnd
32439>>>
32439>>>        End_Object    // Grid2
32440>>>
32440>>>        Object Textbox2 is a Textbox
32442>>>            Set Label to "­"
32443>>>            Set Auto_Size_State to FALSE
32444>>>            Set Transparent_State to TRUE
32445>>>            Set Color to clWhite
32446>>>            Set TextColor to clNavy
32447>>>            Set Location to 19 4
32448>>>            Set Size to 10 15
32449>>>
32449>>>            //AB-StoreStart
32449>>>                                        
32449>>>            Set Label To (left(t.calendar.Monday,2))
32450>>>            //AB-StoreEnd
32450>>>
32450>>>        End_Object    // Textbox2
32451>>>
32451>>>        Object Textbox3 is a Textbox
32453>>>            Set Label to "‚â"
32454>>>            Set Auto_Size_State to FALSE
32455>>>            Set Transparent_State to TRUE
32456>>>            Set Color to clWhite
32457>>>            Set TextColor to clNavy
32458>>>            Set Location to 19 22
32459>>>            Set Size to 10 12
32460>>>
32460>>>            //AB-StoreStart
32460>>>                                        
32460>>>            Set Label To (left(t.calendar.Tuesday,2))
32461>>>            //AB-StoreEnd
32461>>>
32461>>>        End_Object    // Textbox3
32462>>>
32462>>>        Object Textbox4 is a Textbox
32464>>>            Set Label to "‘à"
32465>>>            Set Auto_Size_State to FALSE
32466>>>            Set Transparent_State to TRUE
32467>>>            Set Color to clWhite
32468>>>            Set TextColor to clNavy
32469>>>            Set Location to 19 39
32470>>>            Set Size to 10 15
32471>>>
32471>>>            //AB-StoreStart
32471>>>                                        
32471>>>            Set Label To (left(t.calendar.Wednesday,2))
32472>>>            //AB-StoreEnd
32472>>>
32472>>>        End_Object    // Textbox4
32473>>>
32473>>>        Object Textbox5 is a Textbox
32475>>>            Set Label to "—â"
32476>>>            Set Auto_Size_State to FALSE
32477>>>            Set Transparent_State to TRUE
32478>>>            Set Color to clWhite
32479>>>            Set TextColor to clNavy
32480>>>            Set Location to 19 57
32481>>>            Set Size to 10 17
32482>>>
32482>>>            //AB-StoreStart
32482>>>                                        
32482>>>            Set Label To (left(t.calendar.Thursday,2))
32483>>>            //AB-StoreEnd
32483>>>
32483>>>        End_Object    // Textbox5
32484>>>
32484>>>        Object Textbox6 is a Textbox
32486>>>            Set Label to "â"
32487>>>            Set Auto_Size_State to FALSE
32488>>>            Set Transparent_State to TRUE
32489>>>            Set Color to clWhite
32490>>>            Set TextColor to clNavy
32491>>>            Set Location to 19 76
32492>>>            Set Size to 10 17
32493>>>
32493>>>            //AB-StoreStart
32493>>>                                        
32493>>>            Set Label To (left(t.calendar.Friday,2))
32494>>>            //AB-StoreEnd
32494>>>
32494>>>        End_Object    // Textbox6
32495>>>
32495>>>        Object Textbox7 is a Textbox
32497>>>            Set Label to "‘¡"
32498>>>            Set Auto_Size_State to FALSE
32499>>>            Set Transparent_State to TRUE
32500>>>            Set Color to clWhite
32501>>>            Set TextColor to clNavy
32502>>>            Set Location to 19 91
32503>>>            Set Size to 10 18
32504>>>
32504>>>            //AB-StoreStart
32504>>>                                        
32504>>>            Set Label To (left(t.calendar.Saturday,2))
32505>>>            //AB-StoreEnd
32505>>>
32505>>>        End_Object    // Textbox7
32506>>>
32506>>>        Object Textbox8 is a Textbox
32508>>>            Set Label to "‚á"
32509>>>            Set Auto_Size_State to FALSE
32510>>>            Set Transparent_State to TRUE
32511>>>            Set Color to clWhite
32512>>>            Set TextColor to clNavy
32513>>>            Set Location to 19 109
32514>>>            Set Size to 10 17
32515>>>
32515>>>            //AB-StoreStart
32515>>>                                        
32515>>>            Set Label To (left(t.calendar.Sunday,2))
32516>>>            //AB-StoreEnd
32516>>>
32516>>>        End_Object    // Textbox8
32517>>>
32517>>>        Object LineControl1 is a LineControl
32519>>>            Set Line_Style to lnSINGLE
32520>>>            Set Size to 1 116
32521>>>            Set Location to 28 4
32522>>>
32522>>>            //AB-StoreStart
32522>>>                                        
32522>>>            //AB-StoreEnd
32522>>>
32522>>>        End_Object    // LineControl1
32523>>>
32523>>>        Object Container3d2 is a Container3d
32525>>>            Set Size to 18 131
32526>>>            Set Location to 1 1
32527>>>            Set Color to clNavy
32528>>>            Set Border_Style to Border_None
32529>>>            Object oRght is a BitmapContainer
32531>>>                Set Size to 10 14
32532>>>                Set Location to 4 105
32533>>>                Set Bitmap to "rght.bmp"
32534>>>                Set Border_Style to Border_None
32535>>>
32535>>>                //AB-StoreStart
32535>>>                Procedure Mouse_Down
32537>>>                    Send Next_Month to Grid2
32538>>>                End_Procedure
32539>>>                //AB-StoreEnd
32539>>>
32539>>>            End_Object    // oRght
32540>>>
32540>>>            Object oLeft is a BitmapContainer
32542>>>                Set Size to 10 14
32543>>>                Set Location to 4 3
32544>>>                Set Bitmap to "lft.bmp"
32545>>>                Set Border_Style to Border_None
32546>>>
32546>>>                //AB-StoreStart
32546>>>                Procedure Mouse_Down
32548>>>                    Send Prev_Month to Grid2
32549>>>                End_Procedure
32550>>>                //AB-StoreEnd
32550>>>
32550>>>            End_Object    // oLeft
32551>>>
32551>>>            Object oMonth is a Textbox
32553>>>
32553>>>                //AB-StoreTopStart
32553>>>                Property integer piSelected_Month public 0
32555>>>                //AB-StoreTopEnd
32555>>>
32555>>>                Set Label to "January"
32556>>>                Set Auto_Size_State to FALSE
32557>>>                Set Transparent_State to TRUE
32558>>>                Set Color to clWhite
32559>>>                Set TextColor to clWhite
32560>>>                Set Location to 4 23
32561>>>                Set Size to 10 43
32562>>>                Set FontWeight to 800
32563>>>                Set Justification_Mode to jMode_Center
32564>>>
32564>>>                //AB-StoreStart
32564>>>                                    
32564>>>                Procedure Mouse_Down
32566>>>                    Integer iState
32567>>>                    Get Visible_State of oSelectYear to iState
32568>>>                    If (iState) Send OnKillFocus to oSelectYear
32571>>>                    Send Popup to oSelectMonth
32572>>>                End_Procedure
32573>>>                
32573>>>                Procedure pSelectJan
32575>>>                    Set Label to t.calendar.january
32576>>>                    Set piSelected_Month to 1
32577>>>                    Send Adjust_Calendar
32578>>>                End_Procedure
32579>>>                Procedure pSelectFeb
32581>>>                    Set Label to t.calendar.february
32582>>>                    Set piSelected_Month to 2
32583>>>                    Send Adjust_Calendar
32584>>>                End_Procedure
32585>>>                Procedure pSelectMar
32587>>>                    Set Label to t.calendar.march
32588>>>                    Set piSelected_Month to 3
32589>>>                    Send Adjust_Calendar
32590>>>                End_Procedure
32591>>>                Procedure pSelectApr
32593>>>                    Set Label to t.calendar.april
32594>>>                    Set piSelected_Month to 4
32595>>>                    Send Adjust_Calendar
32596>>>                End_Procedure
32597>>>                Procedure pSelectMay
32599>>>                    Set Label to t.calendar.may
32600>>>                    Set piSelected_Month to 5
32601>>>                    Send Adjust_Calendar
32602>>>                End_Procedure
32603>>>                Procedure pSelectJun
32605>>>                    Set Label to t.calendar.june
32606>>>                    Set piSelected_Month to 6
32607>>>                    Send Adjust_Calendar
32608>>>                End_Procedure
32609>>>                Procedure pSelectJul
32611>>>                    Set Label to t.calendar.july
32612>>>                    Set piSelected_Month to 7
32613>>>                    Send Adjust_Calendar
32614>>>                End_Procedure
32615>>>                Procedure pSelectAug
32617>>>                    Set Label to t.calendar.august
32618>>>                    Set piSelected_Month to 8
32619>>>                    Send Adjust_Calendar
32620>>>                End_Procedure
32621>>>                Procedure pSelectSep
32623>>>                    Set Label to t.calendar.september
32624>>>                    Set piSelected_Month to 9
32625>>>                    Send Adjust_Calendar
32626>>>                End_Procedure
32627>>>                Procedure pSelectOct
32629>>>                    Set Label to t.calendar.october
32630>>>                    Set piSelected_Month to 10
32631>>>                    Send Adjust_Calendar
32632>>>                End_Procedure
32633>>>                Procedure pSelectNov
32635>>>                    Set Label to t.calendar.november
32636>>>                    Set piSelected_Month to 11
32637>>>                    Send Adjust_Calendar
32638>>>                End_Procedure
32639>>>                Procedure pSelectDec
32641>>>                    Set Label to t.calendar.december
32642>>>                    Set piSelected_Month to 12
32643>>>                    Send Adjust_Calendar
32644>>>                End_Procedure
32645>>>                
32645>>>                Object oSelectMonth is a FloatingPopupMenu
32647>>>                    Send Add_Item msg_pSelectJan t.calendar.january
32648>>>                    Send Add_Item msg_pSelectFeb t.calendar.february
32649>>>                    Send Add_Item msg_pSelectMar t.calendar.march
32650>>>                    Send Add_Item msg_pSelectApr t.calendar.april
32651>>>                    Send Add_Item msg_pSelectMay t.calendar.may
32652>>>                    Send Add_Item msg_pSelectJun t.calendar.june
32653>>>                    Send Add_Item msg_pSelectJul t.calendar.july
32654>>>                    Send Add_Item msg_pSelectAug t.calendar.august
32655>>>                    Send Add_Item msg_pSelectSep t.calendar.september
32656>>>                    Send Add_Item msg_pSelectOct t.calendar.october
32657>>>                    Send Add_Item msg_pSelectNov t.calendar.november
32658>>>                    Send Add_Item msg_pSelectDec t.calendar.december
32659>>>                End_Object
32660>>>                
32660>>>                Procedure Adjust_Calendar
32662>>>                    Date date#
32663>>>                    Integer iDay iMonth iYear iItm
32663>>>                    Set Visible_State to false
32664>>>                    Set Visible_State to true
32665>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
32666>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
32667>>>                    Get piSelected_Month to iMonth
32668>>>                    Get Label of oYear to iYear
32669>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32670>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
32671>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
32672>>>                End_Procedure
32673>>>                
32673>>>                Procedure Activating
32675>>>                    Forward Send Activating
32677>>>                    Send Date_Changing
32678>>>                End_Procedure
32679>>>                
32679>>>                Procedure Date_Changing
32681>>>                    Set Visible_State to false
32682>>>                    Set Label to (MonthName(p_current_Month(Grid2(Container3D1(Self)))))
32683>>>                    Set piSelected_Month to (p_current_Month(Grid2(Container3D1(Self))))
32684>>>                    Set Visible_State to true
32685>>>                End_Procedure
32686>>>                
32686>>>                
32686>>>                //AB-StoreEnd
32686>>>
32686>>>            End_Object    // oMonth
32687>>>
32687>>>            Object oYear is a Textbox
32689>>>                Set Label to "2001"
32690>>>                Set Transparent_State to TRUE
32691>>>                Set Color to clWhite
32692>>>                Set TextColor to clWhite
32693>>>                Set Location to 4 77
32694>>>                Set Size to 10 18
32695>>>                Set FontWeight to 800
32696>>>
32696>>>                //AB-StoreStart
32696>>>                                                    
32696>>>                Procedure Mouse_Down
32698>>>                    String sVal
32699>>>                    Get Label to sVal
32700>>>                    Set Value of oSelectYear item 0 to sVal
32701>>>                    Set Visible_State of oSelectYear to True
32702>>>                    Send Activate to (oSelectYear(Self))
32703>>>                End_Procedure
32704>>>                
32704>>>                Procedure Activating
32706>>>                    Forward Send Activating
32708>>>                    Send Date_Changing
32709>>>                End_Procedure
32710>>>                
32710>>>                Procedure Date_Changing
32712>>>                    Set Visible_State to false
32713>>>                    Set Label to (String(p_current_Year(Grid2(Container3D1(Self)))))
32714>>>                    Set Visible_State to true
32715>>>                End_Procedure
32716>>>                //AB-StoreEnd
32716>>>
32716>>>            End_Object    // oYear
32717>>>
32717>>>            Object oSelectYear is a Form
32719>>>
32719>>>                //AB-StoreTopStart
32719>>>                Set Visible_State To False
32720>>>                //AB-StoreTopEnd
32720>>>
32720>>>                Set Size to 10 24
32721>>>                Set Location to 4 75
32722>>>                Set Color to clWhite
32723>>>                Set TextColor to clNavy
32724>>>                Set Form_Border Item 0 to Border_Normal
32725>>>
32725>>>                //AB-StoreStart
32725>>>                                                    
32725>>>                On_Key Key_Enter Send OnKillFocus
32726>>>                On_Key Key_Escape Send OnKillFocus
32727>>>                
32727>>>                Procedure SetFontWeight
32729>>>                    Set Form_FontWeight item 0 to 800
32730>>>                End_Procedure
32731>>>                
32731>>>                Procedure OnKillFocus
32733>>>                    String sVal
32734>>>                    Integer iMonth iDay iYear iItm
32734>>>                    Date date#
32734>>>                    Get Value item 0 to sVal
32735>>>                    Set Visible_State of oYear to false
32736>>>                    Set Label of oYear to sVal
32737>>>                    Set Visible_State of oYear to true
32738>>>                    Set Visible_State to false
32739>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
32740>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
32741>>>                    Get piSelected_Month of oMonth to iMonth
32742>>>                    Get Value item 0 to iYear
32743>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32744>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
32745>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
32746>>>                End_Procedure
32747>>>                
32747>>>                Send SetFontWeight
32748>>>                //AB-StoreEnd
32748>>>
32748>>>            End_Object    // oSelectYear
32749>>>
32749>>>
32749>>>            //AB-StoreStart
32749>>>                            
32749>>>            Procedure Mouse_Down
32751>>>                Integer iState
32752>>>                Get Visible_State of oSelectYear to iState
32753>>>                If (iState) Send OnKillFocus to oSelectYear
32756>>>            End_Procedure
32757>>>            
32757>>>            //AB-StoreEnd
32757>>>
32757>>>        End_Object    // Container3d2
32758>>>
32758>>>
32758>>>        //AB-StoreStart
32758>>>                            
32758>>>        //AB-StoreEnd
32758>>>
32758>>>    End_Object    // Container3d1
32759>>>
32759>>>    Object BitmapContainer3 is a BitmapContainer
32761>>>        Set Size to 9 19
32762>>>        Set Location to 88 3
32763>>>        Set Color to clWhite
32764>>>        Set Bitmap to "cdate.bmp"
32765>>>        Set Border_Style to Border_None
32766>>>
32766>>>        //AB-StoreStart
32766>>>        Procedure Mouse_Down
32768>>>            Send go_today to (Grid2(Container3d1(Self)))
32769>>>            Send Adjust_Label to oToday
32770>>>        End_Procedure
32771>>>        //AB-StoreEnd
32771>>>
32771>>>    End_Object    // BitmapContainer3
32772>>>
32772>>>    Object oToday is a Textbox
32774>>>        Set Label to "Today: 01.01.2001"
32775>>>        Set Auto_Size_State to FALSE
32776>>>        Set Color to clWhite
32777>>>        Set Location to 88 22
32778>>>        Set Size to 8 73
32779>>>        Set FontWeight to 800
32780>>>
32780>>>        //AB-StoreStart
32780>>>        Procedure Mouse_Down
32782>>>            Send go_today to (Grid2(Container3d1(Self)))
32783>>>            Send Adjust_Label
32784>>>        End_Procedure
32785>>>        
32785>>>        Procedure Adjust_Label
32787>>>            date date#
32788>>>            SysDate4 date#
32789>>>            Set Visible_State To false
32790>>>            Set Label         to (t.calendar.today+": "+String(date#))
32791>>>            Set Visible_State To true
32792>>>        End_Procedure
32793>>>        
32793>>>        Procedure Activating
32795>>>            Forward Send Activating
32797>>>            Send Adjust_Label
32798>>>        End_Procedure
32799>>>        //AB-StoreEnd
32799>>>
32799>>>    End_Object    // oToday
32800>>>
32800>>>
32800>>>    //AB-StoreStart
32800>>>                
32800>>>    procedure popup
32802>>>        local integer focus# icItm iYear iMonth
32803>>>        local date date#
32803>>>        move (focus(desktop)) to focus#
32804>>>        set invoking_object_id of (Grid2(Container3d1(self))) to focus#
32805>>>        get value of focus# item current to date#
32806>>>        ifnot (integer(date#)) sysdate date#
32809>>>        move (Date2to4(date#)) to date#
32810>>>        set p_current_date of (Grid2(Container3d1(self))) to date#
32811>>>        send fill_list to (Grid2(Container3d1(self)))
32812>>>        move (DateSegment(date#,DS_YEAR)) to iYear
32813>>>        move (DateSegment(date#,DS_MONTH)) to iMonth
32814>>>        Set Label To (MonthName(iMonth)+', '+String(iYear))
32815>>>        forward send popup
32817>>>    end_procedure
32818>>>    
32818>>>    Procedure Close_Calendar
32820>>>        Send Exit
32821>>>    End_Procedure
32822>>>    //AB-StoreEnd
32822>>>
32822>>>CD_End_Object    // oCalendar
32824>>>>
32824>>>
32824>>>
32824>>>//AB-StoreStart
32824>>>    
32824>>>    
32824>>>//AB-StoreEnd
32824>>>
32824>>>//AB/ End_Object    // prj
32824>Use Dates.Utl
32824>use roundfn.fnc
INCLUDING FILE: ROUNDFN.FNC
32824>>>// ===========================================================================
32824>>>//
32824>>>// The ROUND_NUMBER global function has been designed to return the rounded
32824>>>// value of a given 'numeric' argument at a specified rounding precision.
32824>>>//
32824>>>// ---------------------------------------------------------------------------
32824>>>// This version dispenses with the use of powers (10 ^ n) to perform the
32824>>>// necessary calculations.  It uses a string handling technique instead.
32824>>>// ---------------------------------------------------------------------------
32824>>>//
32824>>>// The function requires two arguments, as follows:-
32824>>>//
32824>>>// (a) The numeric value to be rounded, where the range of valid values is
32824>>>//     +/- 99,999,999,999,999.99999999.
32824>>>//
32824>>>// (b) The rounding precision required.  This must be an integer value in the
32824>>>//     range -13 to +8.  If a value outside this range is used, the nearest
32824>>>//     threshold value is substituted.
32824>>>//
32824>>>//     Values in the range +1 to +7 perform rounding on the decimal part of
32824>>>//     the number.  A value of +8 will perform no rounding at all.  A zero
32824>>>//     value will round to the nearest whole number.  Values -1 to -13 will
32824>>>//     round progressively to the left of the decimal point (a frequent
32824>>>//     requirement in financial reporting).
32824>>>//
32824>>>// If the result of the rounding produces a value outside the valid numeric
32824>>>// range (+/- 99,999,999,999,999.99999999) then a zero value is returned.
32824>>>//
32824>>>// Assumptions:-  The only assumptions made have been that the range of
32824>>>// numeric values and the limit of eight decimal places are unlikely to change
32824>>>// in the forseeable future.
32824>>>//
32824>>>// Examples:-
32824>>>//
32824>>>//  1st Argument      2nd Argument   Return Value
32824>>>//  ------------      ------------   ------------
32824>>>//  123456.87654321         8         123456.87654321
32824>>>//  123456.87654321         2         123456.88
32824>>>// -123456.87654321         2        -123456.88
32824>>>//  123456.98765432         0         123457
32824>>>// -123456.98765432        -1        -123460
32824>>>//  123456.98765432        -2         123500
32824>>>//  123456.98765432        -3         123000
32824>>>//  987654                 -4         990000
32824>>>//  987654                 -5        1000000
32824>>>//  987654                 -6        1000000
32824>>>//  987654                 -7              0
32824>>>//
32824>>>// ===========================================================================
32824>>>
32824>>>
32824>>>Function Round_Number GLOBAL number nVal integer iRnd returns Number
32825>>>
32825>>>  Local Number nAdj
32826>>>
32826>>>  Move 10000000000000 to nAdj
32827>>>
32827>>>  // If the rounding precision falls in the range 0 to 8, then return:-
32827>>>
32827>>>  If (iRnd >= 0) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 / (Number(Left(nAdj, ((iRnd + 1) ;      min 9)))) + nVal / (Number(Left(nAdj, (9 - (iRnd min 8))))) ;        * (Number(Left(nAdj, (9 - (iRnd min 8))))))
32830>>>
32830>>>  // Else, where the rounding precision is in the range -1 to -5, return:-
32830>>>
32830>>>  If (iRnd >= -5) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(Left(nAdj, (Abs(iRnd) + 9)))) ;        * (Number(Left(nAdj, (Abs(iRnd) + 9)))))
32833>>>
32833>>>  // Else, where the rounding precision is in the range -6 to -13, return:-
32833>>>
32833>>>  Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(nAdj)) / (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))) ;        * (Number(nAdj)) * (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))))
32834>>>
32834>>>End_Function
32835>use checkafm.pkg
INCLUDING FILE: CHECKAFM.PKG
32835>>>
32835>>>
32835>>>Function Check_Afm Global String Afm_Num Returns Integer
32836>>>    Integer iii Num1 Num2
32837>>>
32837>>>    Move (Trim(Afm_Num)) To Afm_Num
32838>>>    Move (Right(Afm_Num,1)) to Num2
32839>>>
32839>>>    If (Length(Afm_Num)<>9) Function_Return 2
32842>>>
32842>>>    For iii From 1 To (Length(Trim(Afm_Num)))
32848>>>>
32848>>>        If Not (Mid(Afm_Num,1,iii)) In  "0123456789" Function_Return 3
32851>>>    Loop
32852>>>>
32852>>>
32852>>>    Move 0 to Num1
32853>>>
32853>>>    For iii From 1 to 8
32859>>>>
32859>>>        Add ((Mid(Afm_Num,1,iii)) * (2 ^ (9 - iii))) to Num1
32860>>>    Loop
32861>>>>
32861>>>
32861>>>    Move (Mod(Num1,11)) to Num1
32862>>>    If (Num1=10) Move 0 to Num1
32865>>>
32865>>>    If (Num1=Num2)  Function_Return 0
32868>>>    Else            Function_Return 1
32870>>>End_Function
32871>>>
32871>use checklog.pkg
INCLUDING FILE: CHECKLOG.PKG
32871>>>open syscurgl
INCLUDING FILE: SYSCURGL.FD
32873>>>open syscurxr
32875>>>open gplan
INCLUDING FILE: GPLAN.FD
32877>>>open iteml
INCLUDING FILE: ITEML.FD
32879>>>open cn
INCLUDING FILE: CN.FD
32881>>>open payresp
INCLUDING FILE: PAYRESP.FD
32883>>>open salesmen
INCLUDING FILE: SALESMEN.FD
32885>>>open mhxanik
INCLUDING FILE: MHXANIK.FD
32887>>>open constrct
INCLUDING FILE: CONSTRCT.FD
32889>>>Function Check_log Global String slog Returns Integer
32890>>>    clear gplan
32891>>>    move syscurxr.company_code to gplan.company_code
32892>>>    move syscurxr.branch_code  to gplan.branch_code
32893>>>    move syscurxr.year_year    to gplan.year_year
32894>>>    move slog                  to gplan.gplan_code
32895>>>    find eq gplan by index.1
32896>>>>
32896>>>    if (found=1) function_return 0
32899>>>    else         function_return 1
32901>>>
32901>>>End_Function
32902>>>
32902>>>Function Check_last Global String slog Returns Integer
32903>>>    clear gplan
32904>>>    move syscurxr.company_code to gplan.company_code
32905>>>    move syscurxr.branch_code  to gplan.branch_code
32906>>>    move syscurxr.year_year    to gplan.year_year
32907>>>    move slog                  to gplan.gplan_code
32908>>>    find eq gplan by index.1
32909>>>>
32909>>>    if ((found=1) and (Gplan.Gplan_Yn_Last = 1)) Function_Return 0
32912>>>    else                                         Function_return 1
32914>>>
32914>>>End_Function
32915>>>
32915>>>Function fsgplandescr String slog Returns string
32916>>>    clear gplan
32917>>>    move syscurgl.company_code to gplan.company_code
32918>>>    move syscurgl.branch_code  to gplan.branch_code
32919>>>    move syscurgl.year_year    to gplan.year_year
32920>>>    move slog                  to gplan.gplan_code
32921>>>    find eq gplan by index.1
32922>>>>
32922>>>    if (found=1) function_return gplan.gplan_descr1
32925>>>    else         function_return ''
32927>>>
32927>>>End_Function
32928>>>
32928>>>Function fsclient string code Returns string
32929>>>    string name
32930>>>    clear clients
INCLUDING FILE: CLIENTS.FD
32931>>>    move code to clients.client_id
32932>>>    find eq clients by index.6
32933>>>>
32933>>>    if (found) move clients.client_name to name
32936>>>    else       move '' to name
32938>>>    function_return name
32939>>>end_Function
32940>>>
32940>>>Function fspayresp string code Returns string
32941>>>    string name
32942>>>    clear payresp
32943>>>    move code to payresp.presp_id
32944>>>    find eq payresp by index.7
32945>>>>
32945>>>    if (found) move payresp.presp_name to name
32948>>>    else       move '' to name
32950>>>    function_return name
32951>>>end_Function
32952>>>
32952>>>Function fssalesmen string code Returns string
32953>>>    string name
32954>>>    clear salesmen
32955>>>    move code to salesmen.sls_id
32956>>>    find eq salesmen by index.4
32957>>>>
32957>>>    if (found) move salesmen.sls_name to name
32960>>>    else       move '' to name
32962>>>    function_return name
32963>>>end_Function
32964>>>
32964>>>Function fsconstrct string code Returns string
32965>>>    string name
32966>>>    clear constrct
32967>>>    move code to constrct.cnt_id
32968>>>    find eq constrct by index.5
32969>>>>
32969>>>    if (found) move constrct.cnt_name to name
32972>>>    else       move '' to name
32974>>>    function_return name
32975>>>end_Function
32976>>>
32976>>>Function fsmhxanik string code Returns string
32977>>>    string name
32978>>>    clear mhxanik
32979>>>    move code to mhxanik.mhx_id
32980>>>    find eq mhxanik by index.4
32981>>>>
32981>>>    if (found) move mhxanik.mhx_name to name
32984>>>    else       move '' to name
32986>>>    function_return name
32987>>>end_Function
32988>>>
32988>>>
32988>>>Function fsptyppar string code Returns string
32989>>>    string sdescr
32990>>>    clear ptypparl
INCLUDING FILE: PTYPPARL.FD
32991>>>    move syscurxr.company_code to ptypparl.company_code
32992>>>    move syscurxr.branch_code  to ptypparl.branch_code
32993>>>    move syscurxr.year_year    to ptypparl.year_year
32994>>>    move code                  to ptypparl.ptyppar_code
32995>>>    find eq ptypparl by index.1
32996>>>>
32996>>>    move ptypparl.ptyppar_descr to sdescr
32997>>>    function_return sdescr
32998>>>end_Function
32999>>>
32999>>>Function fsgplan string code Returns string
33000>>>    string sdescr
33001>>>    clear gplan
33002>>>    move syscurxr.company_code to gplan.company_code
33003>>>    move syscurxr.branch_code  to gplan.branch_code
33004>>>    move syscurxr.year_year    to gplan.year_year
33005>>>    move code                  to gplan.gplan_code
33006>>>    find eq gplan by index.1
33007>>>>
33007>>>    move gplan.gplan_descr1    to sdescr
33008>>>    function_return sdescr
33009>>>end_Function
33010>>>
33010>>>Function fsitem string scode Returns string
33011>>>    clear iteml
33012>>>    move scode to iteml.item_code
33013>>>    find eq iteml by index.5
33014>>>>
33014>>>    function_return iteml.item_descr
33015>>>end_Function
33016>>>
33016>>>Function fswitemx string code Returns string
33017>>>    string name
33018>>>    clear witemx
INCLUDING FILE: WITEMX.FD
33019>>>    move syscurxr.company_code to witemx.company_code
33020>>>    move syscurxr.branch_code  to witemx.branch_code
33021>>>    move syscurxr.year_year    to witemx.year_year
33022>>>    move code to witemx.witemx_code
33023>>>    find eq witemx by index.5
33024>>>>
33024>>>    move witemx.witemx_descr to name
33025>>>    function_return name
33026>>>end_Function
33027>>>
33027>>>Function fsCNDescr String asItem Returns String
33028>>>    Clear CN
33029>>>    move asItem to CN.CN_Code
33030>>>    Find Eq CN by Index.5
33031>>>>
33031>>>    Function_Return CN.CN_Descr
33032>>>End_Function
33033>>>
33033>>>Function FindGtypkinDescr Integer aiCode Returns String
33034>>>    String lsDescr
33035>>>    Clear Gtypkin
INCLUDING FILE: GTYPKIN.FD
33036>>>    Move syscurxr.company_code    to Gtypkin.Company_Code
33037>>>    Move syscurxr.Branch_Code     to Gtypkin.Branch_Code
33038>>>    Move syscurxr.Year_year       to Gtypkin.Year_Year
33039>>>    Move aiCode                   to Gtypkin.Gtypkin_Code
33040>>>    Find eq Gtypkin by Index.1
33041>>>>
33041>>>    [Found] Move Gtypkin.Gtypkin_Descr to lsDescr
33042>>>    Function_Return lsDescr
33043>>>End_Function // FindGtypkinDescr
33044>>>
33044>>>Function FindBtypkinDescr Integer aiCode Returns String
33045>>>    String lsDescr
33046>>>    Clear Btypkin
INCLUDING FILE: BTYPKIN.FD
33047>>>    Move syscurxr.company_code    to Btypkin.Company_Code
33048>>>    Move syscurxr.Branch_Code     to Btypkin.Branch_Code
33049>>>    Move syscurxr.Year_year       to Btypkin.Year_Year
33050>>>    Move aiCode                   to Btypkin.btypkin_Code
33051>>>    Find eq Btypkin by Index.1
33052>>>>
33052>>>    [Found] Move Btypkin.Btypkin_Descr to lsDescr
33053>>>    Function_Return lsDescr
33054>>>End_Function // FindGtypkinDescr
33055>>>
33055>>>
33055>Use Connect.Dg
INCLUDING FILE: CONNECT.DG
33055>>>//AB/ Project Connect
33055>>>//AB/ Object prj is a Dialog_Project
33055>>>//AB/     Set ProjectName to "Connect"
33055>>>//AB/     Set ProjectFileName to "CONNECT.DG"
33055>>>
33055>>>// Project Object Structure
33055>>>//   Connect is a BasicPanelSub
33055>>>//     BitmapContainer1 is a BitmapContainerSub
33055>>>//     Textbox5 is a TextBoxSub
33055>>>//     ComboForm2 is a ComboFormSub
33055>>>//     Textbox6 is a TextBoxSub
33055>>>//     Form4 is a FormSub
33055>>>//     Textbox7 is a TextBoxSub
33055>>>//     Form5 is a FormSub
33055>>>//     Textbox8 is a TextBoxSub
33055>>>//     Form6 is a FormSub
33055>>>//     CheckBox1 is a CheckBoxSub
33055>>>//     oOK_bn is a ButtonSub
33055>>>//     oCancel_bn is a ButtonSub
33055>>>
33055>>>// Register all objects
33055>>>Register_Object BitmapContainer1
33055>>>Register_Object CheckBox1
33055>>>Register_Object ComboForm2
33055>>>Register_Object Connect
33055>>>Register_Object Form4
33055>>>Register_Object Form5
33055>>>Register_Object Form6
33055>>>Register_Object oCancel_bn
33055>>>Register_Object oOK_bn
33055>>>Register_Object Textbox5
33055>>>Register_Object Textbox6
33055>>>Register_Object Textbox7
33055>>>Register_Object Textbox8
33055>>>
33055>>>
33055>>>
33055>>>//AB-StoreTopStart
33055>>>
33055>>>///#INCLUDE
33055>>>Use mertech.inc
INCLUDING FILE: MERTECH.INC
33055>>>>>USE UI
33055>>>>>
#REM -----------------------------------------------
#REM MERTECH DATA SYSTEMS INC. - WWW.MERTECHDATA.COM
#REM MERTECH.INC VERSION 2.1.9
#REM -----------------------------------------------
33055>>>>>
33055>>>>>
33055>>>>>
33055>>>>>
33055>>>>>
33055>>>>>//
33055>>>>>//
33055>>>>>//
33055>>>>>//
33055>>>>>//
33055>>>>>//-----------------------------------------------
33055>>>>>// SELECT_COLUMNS_FIND <FILE> <START> THRU <END>
33055>>>>>// SELECT_COLUMNS_FIND <FILE> <FIELD>
33055>>>>>// This command will issue a properly commands to define the FETCH attribute status
33055>>>>>// for file fields.
33055>>>>>//
33055>>>>>//------------------------------------------------------------------------------
33055>>>>>// RESET_FETCH_FIELDS <FILE NAME>|<FILE NUMBER> <DF_FETCH_TRUE>|<DF_FETCH_FALSE>
33055>>>>>//
33055>>>>>//
33055>>>>>//-----------------------------
33055>>>>>// SQL_FOR_ONEROW <file number>
33055>>>>>//
33055>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get just
33055>>>>>// one ROW for each DataFlex FIND command issued
33055>>>>>// In this case the DBMS optimizer will generate a query with just one row
33055>>>>>//
33055>>>>>//
33055>>>>>//-------------------------------------------------------------------------------
33055>>>>>// SQL_FOR_SET <file number> MAXROWS <number of rows> CACHE|NOCACHE <return code>
33055>>>>>//
33055>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get a SET of rows.
33055>>>>>// In this case the DBMS optimizer will generate a query with <number of rows> Rows.
33055>>>>>// if CACHE is passed as argument, all these rows will be transfered to ORAFlex and then it will
33055>>>>>// save them in a local CACHE buffer. Just the FIND GT and FIND LT will get local cache.
33055>>>>>// Otherwise, i.e NOCACHE,  ORAFLex won't create a local cache.
33055>>>>>//
33055>>>>>//
33055>>>>>//---------------
33055>>>>>// SQL_SET <stmt>
33055>>>>>//
33055>>>>>//-----------------------------------------
33055>>>>>// SQL_APPEND <stmt1> <stmt2> .... <stmtn>
33055>>>>>//
33055>>>>>//------------
33055>>>>>// SQL_EXECUTE
33055>>>>>//
33055>>>>>//----------------------------------------------------------------------
33055>>>>>// LOCK_TABLE [<FILE NAME>|<FILE NUMBER> <FILE NAME>|<FILE NUMBER> ....]
33055>>>>>//
33055>>>>>// LOCK_TABLE will lock the entire table specified as an argument
33055>>>>>// This command will start a new transaction if it still wasn't done.
33055>>>>>// LOCK_TABLE won't lock the other opened tables or the current rows present
33055>>>>>// in their buffers it will be necessary issue a REREAD command to Lock the current
33055>>>>>// rows and then atualize their buffers
33055>>>>>//
33055>>>>>//
33055>>>>>//-------------------------------------------
33055>>>>>// SQL_CHECK_TABLE <SCHEMA NAME> <TABLE NAME>
33055>>>>>//
33055>>>>>//-------------------------------
33055>>>>>// CREATE_TD_FILE  DFTRUE|DFFALSE
33055>>>>>// SET A GLOBAL ATTRIBUTE TO CREATE THE TD FILE AFTER CLOSING AN OPENED FILE
33055>>>>>//
33055>>>>>//-------------------------------------------------
33055>>>>>// OPEN_INT <DATAFLEX FILE NAME>
33055>>>>>// OPEN_INT <PHYSICAL NAME> AS <DATAFLEX FILE NAME>
33055>>>>>//
33055>>>>>// OPEN_INT will check if the OPEN done is an OPEN AS. IF it's true, OPEN_INT
33055>>>>>// will try to open an intermediate file, if there is one. Otherwise OPEN_INT
33055>>>>>// will issue a OPEN command
33055>>>>>// OPEN_INT must be inserted into FMAC file instead OPEN COMMAND
33055>>>>>//
33055>>>>>//=========================================================================================================
33055>>>>>// SELECT STUFFS
33055>>>>>//--------------
33055>>>>>// SQL_SET_STMT OF FILENAME|FILENUMBER TO <STATMENT1>
33055>>>>>//
33055>>>>>// SQL_APPEND_ OF FILENAME|FILENUMBER TO <STATMENT1> <STATMENT2> ... <STATMENTn>
33055>>>>>//
33055>>>>>//
33055>>>>>// SQL_APPEND_UPDCOL_STMT OF FILENAME|FILENUMBER VALUE EXPRESSION WITH FIELD1 FIELD2 ... FIELDN
33055>>>>>//
33055>>>>>// SQL_PREPARE_STMT OF FILENAME|FILENUMBER
33055>>>>>//
33055>>>>>// SQL_BIND_COLUMN [FILENAME|FILENUMBER] [FIELDNAME|FIELDNUMBER]
33055>>>>>//
33055>>>>>// SQL_BINDCOLUMNS_STMT OF FILENAME|FILENUMBER TO <COLUMN1> <COLUMN2> ... <COLUMNn>
33055>>>>>//
33055>>>>>// SQL_EXECUTE_STMT OF FILENAME|FILENUMBER
33055>>>>>//
33055>>>>>// SQL_COMMIT_STMT
33055>>>>>//
33055>>>>>// SQL_ROLLBACK_STMT
33055>>>>>//
33055>>>>>// SQL_FETCH_NEXT_ROW OF FILENAME|FILENUMBER
33055>>>>>//
33055>>>>>//
33055>>>>>//
33055>>>>>//
33055>>>>>// CALL_STORED_PROCEDURE will call a stored procedure passing arguments
33055>>>>>//
33055>>>>>// FORMAT TO USE : CALL_STORED_PROCEDURE <STORED_PROC_NAME> [PASSING <ARG1> <ARG2> ....<ARGn>]
33055>>>>>//
33055>>>>>//
33055>>>>>//---------------------------------------------------------------------------------------------
33055>>>>>// CALL_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
33055>>>>>// CALL_STORED_FUNCTION will call an Oracle stored function passing arguments
33055>>>>>//
33055>>>>>//---------------------------
33055>>>>>// SQL_TEXT_MESSAGE <MESSAGE>
33055>>>>>// Writes a message inside driver log trace file if this is activated
33055>>>>>//
33055>>>>>//-----------------------------------------------------
33055>>>>>// OUTPUT_INT_FILE FOR <FILE NUMBER> TO <INT FILE NAME>
33055>>>>>// Generating the INT file
33055>>>>>//
33055>>>>>// -----------------------
33055>>>>>// SQL_ERROR_MESSAGE <VAR>
33055>>>>>// SQL_ERROR_MESSAGE retrieve the native error message issued by server for error number 25000
33055>>>>>
33055>>>>>
33055>>>>>//=======================================================================================
33055>>>>>// SQLFlex Commands
33055>>>>>//-----------------
33055>>>>>//
33055>>>>>//-----------------------
33055>>>>>// SQLFlex_REVISION <VAR>
33055>>>>>// Retrieves SQLFlex revision
33055>>>>>//
33055>>>>>//-------------------------------------
33055>>>>>// SET_DATABASE_NAME TO <DATABASE NAME>
33055>>>>>// Sets current database
33055>>>>>//
33055>>>>>//---------------------------
33055>>>>>// GET_DATABASE_NAME TO <VAR>
33055>>>>>// Gets name of current database
33055>>>>>//
33055>>>>>//----------------------------------
33055>>>>>// SET_SCHEMA_NAME TO <SCHEMA NAME>
33055>>>>>// Sets current schema name
33055>>>>>//
33055>>>>>//-------------------------
33055>>>>>// GET_SCHEMA_NAME TO <VAR>
33055>>>>>// Gets current schema name
33055>>>>>//
33055>>>>>//--------------------------------
33055>>>>>// SQL_USEDATABASE <DATABASE NAME>
33055>>>>>// Specifies the current Database
33055>>>>>//
33055>>>>>//----------------------------
33055>>>>>// SET_CURRENT_SERVER TO <VAR>
33055>>>>>// Set the current logged server
33055>>>>>//
33055>>>>>//----------------------------
33055>>>>>// GET_CURRENT_SERVER TO <VAR>
33055>>>>>// Retrieves the current logged server
33055>>>>>//
33055>>>>>//-----------------------------
33055>>>>>// SET_HOST_NAME TO <HOST NAME>
33055>>>>>// Defines current host name
33055>>>>>//
33055>>>>>//-----------------------
33055>>>>>// GET_HOST_NAME TO <VAR>
33055>>>>>// Retrieves the current host name
33055>>>>>//
33055>>>>>//---------------------------------------------------------------
33055>>>>>// LOGIN_SQLFLEX <SERVER NAME> <USER NAME> <PASSWORD> <HOST NAME>
33055>>>>>// Specifies host name during login process
33055>>>>>//
33055>>>>>// SQL_CANCEL_QUERY_STMT
33055>>>>>//
33055>>>>>//========================================
33055>>>>>// SQL SERVER Stored Procedure Call engine
33055>>>>>//----------------------------------------
33055>>>>>//
33055>>>>>//
33055>>>>>
33055>>>>>//
33055>>>>>//--------------------------------------------------------------------------------------------------------------
33055>>>>>// CALL_SQLSERVER_PROCEDURE <procedure name> PASSING <VALUE1|VARIABLE1> [SQLOUT] <VALUE2|VARIABLE2> [SQLOUT] ...
33055>>>>>//
33055>>>>>// Executes a stored procedure. SQLOUT will be used to indicate that the stored procedure
33055>>>>>// returns a parameter. The matching parameter in the stored proceudre must have been created with
33055>>>>>// the keyword OUTPUT. Call all procedures that doesn't returns any query with this syntax
33055>>>>>//
33055>>>>>//
33055>>>>>//
33055>>>>>//-----------------------------------------------------------------------------
33055>>>>>
33055>>>>>
33055>>>>>//=============================================================================
33055>>>>>// ORAFlex Commands
33055>>>>>//-----------------
33055>>>>>//----------------------------
33055>>>>>// ORAFlex_REVISION <VARIABLE>
33055>>>>>// Retrieves ORAFlex revision
33055>>>>>//
33055>>>>>//---------------------------------
33055>>>>>// KEEP_FILES_OPEN OF <SERVER NAME>
33055>>>>>// Keeps all files opened even during a LOGOUT
33055>>>>>//
33055>>>>>//-----------------------------------------------
33055>>>>>// SET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
33055>>>>>// Defines the maximum number of cursors that ORAFlex will be allowed for using
33055>>>>>//
33055>>>>>//-----------------------------------------------
33055>>>>>// GET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
33055>>>>>// Retrieves the maximum number of cursors allowed for ORAFlex use
33055>>>>>//
33055>>>>>//---------------------------------------------
33055>>>>>// GET_OPENED_CURSORS OF <SERVER NAME> TO <VAR>
33055>>>>>// Retrieves the number of opened cursors
33055>>>>>//
33055>>>>>//-----------------------------------------------
33055>>>>>// ACTIVATE_TIME_STAMP OF <SERVER NAME> TO ON|OFF
33055>>>>>// Activates Time stamp for date columns
33055>>>>>//
33055>>>>>//----------------------------------------------------------------------------------------------------
33055>>>>>// CALL_ORACLE_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
33055>>>>>// CALL_ORACLE_STORED_FUNCTION will call an Oracle stored function passing arguments
33055>>>>>//
33055>>>>>//-----------------------------------------------------------------------------
33055>>>>>
33055>>>>>//=============================================================================
33055>>>>>// BUFFER save stuffs
33055>>>>>//-------------------
33055>>>>>
33055>>>>>//-------------------------------------------------------
33055>>>>>// SQL_SAVE_BUFFER_BEGIN OF <FILE NUMBER> TO <CACHE SIZE>
33055>>>>>// Initialize the BUFFER buffer
33055>>>>>//
33055>>>>>//---------------------------------
33055>>>>>// SQL_SAVE_BUFFER OF <FILE NUMBER>
33055>>>>>// Moves field buffer values to cache buffer
33055>>>>>//-------------------------------------
33055>>>>>// SQL_SAVE_BUFFER_END OF <FILE NUMBER>
33055>>>>>// Save rows that remains in cache
33055>>>>>//-----------------------------------------------------------------------------
33055>>>>>
33055>>>
33055>>>//AB-StoreTopEnd
33055>>>
33055>>>//AB-IgnoreStart
33055>>>
33055>>>Use Panel.Sub
33055>>>Use Bitmap.Sub
33055>>>Use Txtbox.Sub
33055>>>Use Cmbfrm.Sub
33055>>>Use Form.Sub
33055>>>Use Chkbox.Sub
33055>>>Use Button.Sub
33055>>>
33055>>>
33055>>>//AB-IgnoreEnd
33055>>>
33055>>>Object Connect is a BasicPanelSub
33057>>>
33057>>>    //AB-StoreTopStart
33057>>>
33057>>>    //AB-StoreTopEnd
33057>>>
33057>>>    Set Sysmenu_Icon to FALSE
33058>>>    Set Minimize_Icon to FALSE
33059>>>    Set Label to "Login"
33060>>>    Set Size to 105 230
33061>>>    Set Location to 20 37
33062>>>
33062>>>    //AB-DDOStart
33062>>>
33062>>>
33062>>>    //AB-DDOEnd
33062>>>
33062>>>    Object BitmapContainer1 is a BitmapContainerSub
33064>>>        Set Size to 21 23
33065>>>        Set Location to 4 4
33066>>>        Set Bitmap to "Login1.bmp"
33067>>>        Set Border_Style to Border_None
33068>>>        Set Bitmap_Style to Bitmap_Center
33069>>>        Set Dialog_Caption to "Select a bitmap file"
33070>>>
33070>>>        //AB-StoreStart
33070>>>
33070>>>
33070>>>
33070>>>
33070>>>        //AB-StoreEnd
33070>>>
33070>>>    End_Object    // BitmapContainer1
33071>>>
33071>>>    Object Textbox5 is a TextBoxSub
33073>>>        Set Label to "Driver:"
33074>>>        Set FontSize to 4 0
33075>>>        Set Location to 6 34
33076>>>        Set Size to 13 40
33077>>>        Set Enabled_State to TRUE
33078>>>    End_Object    // Textbox5
33079>>>
33079>>>    Object ComboForm2 is a ComboFormSub
33081>>>
33081>>>        //AB-StoreTopStart
33081>>>
33081>>>        Set CapsLock_State to True
33082>>>
33082>>>        //AB-StoreTopEnd
33082>>>
33082>>>        Set Size to 13 85
33083>>>        Set Location to 6 76
33084>>>        Set Label_Col_Offset to 2
33085>>>        Set Label_Justification_Mode to jMode_Right
33086>>>
33086>>>        //AB-StoreStart
33086>>>        Procedure Combo_Fill_List
33088>>>                Local String Availdrv## TempDrv##
33089>>>                Local Integer HowMany i p1## p2##
33089>>>
33089>>>                get_profile_string "WorkSpaces" "CurrentWorkspace" to AvailDrv##
33092>>>                If AvailDrv## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to AvailDrv##
33095>>>                insert "WorkSpaces\" in AvailDrv## at 1
33097>>>                get_profile_string AvailDrv## "AvailableDrivers" to AvailDrv##
33100>>>
33100>>>                Move Availdrv## to Tempdrv##
33101>>>                Repeat
33101>>>>
33101>>>                    Replace "|" in Tempdrv## With ""
33103>>>                    [Found] Increment HowMany
33104>>>                Until [Finderr]
33106>>>
33106>>>                Send Combo_add_Item ""
33107>>>
33107>>>                If HowMany lt 1 Begin
33109>>>                    If Availdrv## ne "" Send Combo_Add_Item (UpperCase(Availdrv##))
33112>>>                End
33112>>>>
33112>>>                Else Begin
33113>>>                    For i From 0 to HowMany
33119>>>>
33119>>>                        If i eq 0 Move 1 to p1##
33122>>>                        Else Begin
33123>>>                            Move ((Pos("|",Availdrv##))+1) to p1##
33124>>>                            Replace "|" in Availdrv## With ","
33126>>>                        End
33126>>>>
33126>>>                        Move ((Pos("|",Availdrv##))) to p2##
33127>>>                        Send Combo_Add_Item (UpperCase(Mid(Availdrv##,(p2##-p1##),p1##)))
33128>>>                    Loop
33129>>>>
33129>>>                End
33129>>>>
33129>>>        End_Procedure
33130>>>
33130>>>        Set Allow_Blank_state to True
33131>>>
33131>>>
33131>>>
33131>>>        //AB-StoreEnd
33131>>>
33131>>>    End_Object    // ComboForm2
33132>>>
33132>>>    Object Textbox6 is a TextBoxSub
33134>>>        Set Label to "Server:"
33135>>>        Set FontSize to 4 0
33136>>>        Set Location to 22 34
33137>>>        Set Size to 13 40
33138>>>        Set Enabled_State to TRUE
33139>>>    End_Object    // Textbox6
33140>>>
33140>>>    Object Form4 is a FormSub
33142>>>        Set Size to 13 93
33143>>>        Set Location to 22 76
33144>>>        Set Label_Col_Offset to 2
33145>>>        Set Label_Justification_Mode to jMode_Right
33146>>>    End_Object    // Form4
33147>>>
33147>>>    Object Textbox7 is a TextBoxSub
33149>>>        Set Label to "User Name:"
33150>>>        Set FontSize to 4 0
33151>>>        Set Location to 38 34
33152>>>        Set Size to 13 40
33153>>>        Set Enabled_State to TRUE
33154>>>    End_Object    // Textbox7
33155>>>
33155>>>    Object Form5 is a FormSub
33157>>>        Set Size to 13 93
33158>>>        Set Location to 38 76
33159>>>        Set Label_Col_Offset to 2
33160>>>        Set Label_Justification_Mode to jMode_Right
33161>>>    End_Object    // Form5
33162>>>
33162>>>    Object Textbox8 is a TextBoxSub
33164>>>        Set Label to "Password:"
33165>>>        Set FontSize to 4 0
33166>>>        Set Location to 54 34
33167>>>        Set Size to 13 40
33168>>>        Set Enabled_State to TRUE
33169>>>    End_Object    // Textbox8
33170>>>
33170>>>    Object Form6 is a FormSub
33172>>>        Set Size to 13 93
33173>>>        Set Location to 54 76
33174>>>        Set Label_Col_Offset to 2
33175>>>        Set Label_Justification_Mode to jMode_Right
33176>>>
33176>>>        //AB-StoreStart
33176>>>        Set Password_State Item 0 to True
33177>>>
33177>>>        //AB-StoreEnd
33177>>>
33177>>>    End_Object    // Form6
33178>>>
33178>>>    Object CheckBox1 is a CheckBoxSub
33180>>>        Set Label to "Save Password"
33181>>>        Set Size to 10 66
33182>>>        Set Location to 73 76
33183>>>        Set Status_Help to "Remember The Password at Next Login"
33184>>>    End_Object    // CheckBox1
33185>>>
33185>>>    Object oOK_bn is a ButtonSub
33187>>>        Set Label to "Co&nnect"
33188>>>        Set Default_State to TRUE
33189>>>        Set Bitmap to "mcr.bmp"
33190>>>        Set Size to 28 33
33191>>>        Set Location to 9 184
33192>>>
33192>>>        //AB-StoreStart
33192>>>        Procedure OnClick
33194>>>            Set LoginOk to True
33195>>>            Send Stop_Modal_ui
33196>>>        End_Procedure
33197>>>        Set Status_Help to "Connect"
33198>>>        //AB-StoreEnd
33198>>>
33198>>>    End_Object    // oOK_bn
33199>>>
33199>>>    Object oCancel_bn is a ButtonSub
33201>>>        Set Label to "&Cancel"
33202>>>        Set Bitmap to "exit2.bmp"
33203>>>        Set Size to 28 32
33204>>>        Set Location to 39 184
33205>>>
33205>>>        //AB-StoreStart
33205>>>
33205>>>        ON_KEY KENTER SEND Exit_Application to (Connect(Current_Object))
33206>>>
33206>>>        Procedure OnClick
33208>>>            Set LoginOk to False
33209>>>            Send Exit_Application to (Connect(Current_Object))
33210>>>        End_Procedure
33211>>>
33211>>>        Set Status_Help to "Close Application"
33212>>>
33212>>>
33212>>>        //AB-StoreEnd
33212>>>
33212>>>    End_Object    // oCancel_bn
33213>>>
33213>>>
33213>>>    //AB-StoreStart
33213>>>
33213>>>    Set Modal_State to True
33214>>>
33214>>>    // Now is WorkspaceAware
33214>>>
33214>>>    ON_KEY KENTER SEND OnClick to (oOk_bn(Current_Object))
33215>>>    ON_KEY KSAVE_RECORD SEND OK
33216>>>    ON_KEY KCANCEL SEND EXIT_APPLICATION
33217>>>    ON_KEY KCLOSE_PANEL SEND EXIT_APPLICATION
33218>>>
33218>>>    Set Locate_Mode to Center_On_Screen
33219>>>    Set Exit_Application_Local_State to False
33220>>>    Set Exit_MSG to Exit
33221>>>    Set Description_State to True
33222>>>
33222>>>    Property Integer LoginOk public false
33224>>>
33224>>>    External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;        Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
33225>>>
33225>>>    Function Network_User_Name Returns String
33227>>>        Local String sName sLength
33228>>>        Local Pointer lpName_Addr lpLength_Addr
33228>>>        Local Integer iRetval
33228>>>
33228>>>        Movestr (Repeat (Character (0), 255)) To sName
33229>>>>
33229>>>        GetAddress Of sName To lpName_Addr
33230>>>        Movestr (DwordToBytes (255)) To sLength
33231>>>>
33231>>>        GetAddress Of sLength To lpLength_Addr
33232>>>
33232>>>        Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
33233>>>>
33233>>>
33233>>>        If iRetval Eq 0 Function_Return (CString (sName))
33236>>>        Else Function_Return "User Unknown"
33238>>>    End_Function // Network_User_Name
33239>>>
33239>>>    Function fsCrypto String lsWay String lsOld Returns String
33241>>>        Local String lsNew lsTemp
33242>>>        Local Integer liCount
33242>>>           For liCount From 1 to (Length(lsOld))
33248>>>>
33248>>>               Mid lsOld to lsTemp 1 liCount
33251>>>>
33251>>>               If ((Uppercase(lsWay)) eq 'FORWARD') Begin
33253>>>               If ((Ascii(lsTemp) = 255)) Move (Character(32)) to lsTemp
33256>>>               Else Move (Character(Ascii(lsTemp)+1)) to lsTemp
33258>>>               End
33258>>>>
33258>>>               Else Begin
33259>>>                   If ((Uppercase(lsWay)) eq 'BACKWARD') Begin
33261>>>                       If ((Ascii(lsTemp) = 32)) Move (Character(255)) to lsTemp
33264>>>                       Else Move (Character(Ascii(lsTemp)-1)) to lsTemp
33266>>>                   End
33266>>>>
33266>>>               End
33266>>>>
33266>>>               Append lsNew lsTemp
33267>>>           Loop
33268>>>>
33268>>>        Function_Return (lsNew)
33269>>>    End_Function
33270>>>
33270>>>    Procedure Activating
33272>>>        Local String LoginDriver## LoginServer## LoginUserid## LoginPassword##
33273>>>        Local String LastLogin## LoginSeq##
33273>>>        Local Integer SavePassword##
33273>>>
33273>>>        Forward Send Activating
33275>>>
33275>>>        get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
33278>>>        If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
33281>>>        insert "WorkSpaces\" in LastLogin## at 1
33283>>>        Append LastLogin## "\" (Module_Name(Self)) "\LastLogin"
33286>>>        get_profile_string LastLogin## "LoginDriver" to LoginSeq##
33289>>>
33289>>>        If "|" in LoginSeq## move (left(LoginSeq##,(pos("|",LoginSeq##) -1))) to LoginDriver##
33292>>>        Else Move LoginSeq## to LoginDriver##
33294>>>        get_profile_string LastLogin## "LoginServer"  to LoginServer##
33297>>>        get_profile_string LastLogin## "LoginUserId"  to LoginUserId##
33300>>>        get_profile_string LastLogin## "SavePassword" to SavePassword##
33303>>>        If LoginUserId## eq "" Move (Network_User_Name(Current_Object)) to LoginUserId##
33306>>>
33306>>>        If (((UpperCase(LoginDriver##)) eq "DATAFLEX") or (LoginDriver## eq "")) Begin
33308>>>                Set Value of (ComboForm2(Current_Object)) Item 0 to ""
33309>>>                Set Value of (Form4(Current_Object))      Item 0 to ""
33310>>>        End
33310>>>>
33310>>>        Else Begin
33311>>>            Set Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
33312>>>            Set Value of (Form4(Current_Object))      Item 0 to LoginServer##
33313>>>        End
33313>>>>
33313>>>        Set Value of (Form5(Current_Object))      Item 0 to LoginUserID##
33314>>>        Set Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
33315>>>        If (SavePassword##) Begin
33317>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33318>>>            get_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to LoginPassword##
33322>>>            Set Value of (Form6(Current_Object))      Item 0 to (fsCrypto(Self,"backward",LoginPassword##))
33323>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33324>>>        End
33324>>>>
33324>>>    End_Procedure
33325>>>
33325>>>    Function LoginUser Returns Integer
33327>>>        Integer SavePassword## Size## PasswordOk
33328>>>        String LoginDriver## LoginServer## LoginUserid## LoginPassword## LoginSeq## LastLogin##
33328>>>        String lsLoginDate lsHH lsMM lsSS sDepartment
33328>>>        Integer liOpenCursors
33328>>>
33328>>>        Send Popup_Modal
33329>>>
33329>>>        Get Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
33330>>>        Get Value of (Form4(Current_Object))      Item 0 to LoginServer##
33331>>>        Get Value of (Form5(Current_Object))      Item 0 to LoginUserID##
33332>>>        Get Value of (Form6(Current_Object))      Item 0 to LoginPassword##
33333>>>        Get Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
33334>>>        Set Value of (Form6(Current_Object))      Item 0 to ""
33335>>>
33335>>>        If ((LoginDriver## <> "") and (UpperCase(LoginDriver##)<>"DATAFLEX"))  begin
33337>>>            send ignore_error to (error_info_object(current_object)) 25000
33338>>>            send ignore_error to (error_info_object(current_object)) 4255
33339>>>            send ignore_error to (error_info_object(current_object)) 12293
33340>>>            login LoginServer## LoginUserId## LoginPassword## LoginDriver##
33342>>>            send trap_error to (error_info_object(current_object)) 25000
33343>>>            send trap_error to (error_info_object(current_object)) 4255
33344>>>            send trap_error to (error_info_object(current_object)) 12293
33345>>>            If LastErr eq 25000 Begin
33347>>>                Error LastErr "Invalid Login Information"
33348>>>>
33348>>>                Set LoginOk to False
33349>>>                Send Exit_Application
33350>>>            End
33350>>>>
33350>>>            If LastErr eq 4255 Begin
33352>>>                Error LastErr "Invalid Driver Name"
33353>>>>
33353>>>                Set LoginOk to False
33354>>>                Send Exit_Application
33355>>>            End
33355>>>>
33355>>>            If LastErr eq 12293 Begin
33357>>>                Error LastErr "(IBM CLI)Database alias name or Database name not found"
33358>>>>
33358>>>                Set LoginOk to False
33359>>>                Send Exit_Application
33360>>>            End
33360>>>>
33360>>>            Set LoginOk to True
33361>>>            If (UpperCase(LoginDriver##) = "ORA_DRV") Begin
33363>>>                GET_MAX_OPEN_CURSORS of LoginServer## to liOpenCursors
33376>>>                If (liOpenCursors <> 0) SET_MAX_OPEN_CURSORS of LoginServer## to (liOpenCursors+2)
33389>>>            End
33389>>>>
33389>>>        End
33389>>>>
33389>>>        Else Begin
33390>>>            Set LoginOk to True
33391>>>            Open "Users" as Users
INCLUDING FILE: USERS.FD
33393>>>            Move "DATAFLEX" To LoginDriver##
33394>>>            Move "" to LoginServer##
33395>>>            File_Size Users to Size##
33398>>>            If Size## ne 0 Begin
33400>>>                 Clear Users
33401>>>                 Move LoginUSerId##   to Users.Login_Id
33402>>>                 Find eq Users by Index.1
33403>>>>
33403>>>                 [Finderr] Begin
33405>>>>
33405>>>                    Error 25000 "Unknown User"
33406>>>>
33406>>>                    Set LoginOk to False
33407>>>                    Get LoginOk to PasswordOk
33408>>>                    Function_Return PasswordOk
33409>>>                 End
33409>>>>
33409>>>                 [Found] Begin
33411>>>>
33411>>>                    If (LoginPassword## ne Users.Password) Begin
33413>>>                        Error 25000 "Invalid Password"
33414>>>>
33414>>>                        Set LoginOk to False
33415>>>                        Get LoginOk to PasswordOk
33416>>>                        Function_Return PasswordOk
33417>>>                    End
33417>>>>
33417>>>                    Else Move Users.Departm_Code to sDepartment
33419>>>                    Move (Trim(sDepartment)) to sDepartment
33420>>>                 End
33420>>>>
33420>>>            End
33420>>>>
33420>>>            Close Users
33421>>>
33421>>>
33421>>>    //            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33421>>>    //            Integer bFileExists
33421>>>    //            Get Get_File_Exists  "C:\AutLogIn.txt" To bFileExists
33421>>>    //            If (NOT(bFileExists)) Begin
33421>>>
33421>>>    //                Get Get_File_Exists  "C:\UsrLogin.txt" To bFileExists
33421>>>    //                If (bFileExists) Begin
33421>>>
33421>>>    ////                        If Size## ne 0 Begin
33421>>>
33421>>>    //                            Local String ss1 ss2 ss3 ss4
33421>>>    //                            Local String dd1 dd2 dd3 dd4
33421>>>    //                            Move '' to dd1
33421>>>    //                            Move '' to dd2
33421>>>    //                            Move '' to dd3
33421>>>    //                            Move '' to dd4
33421>>>
33421>>>    //                            Direct_Input Channel 8 "C:\UsrLogin.txt"
33421>>>    //                            Readln Channel 8 ss1 ss2 ss3 ss4
33421>>>    //                            While (Not(Seqeof))
33421>>>    //                                Move (Trim(ss1)) to ss1
33421>>>    //                                Move (Trim(ss2)) to ss2
33421>>>    //                                Move (Trim(ss3)) to ss3
33421>>>    //                                Move (Trim(ss4)) to ss4
33421>>>    //                                Append dd1 '"' ss1 '"'
33421>>>    //                                Append dd2 '"' ss2 '"'
33421>>>    //                                Append dd3 '"' ss3 '"'
33421>>>    //                                Append dd4 '"' ss4 '"'
33421>>>    //                                Login dd1 dd2 dd3 dd4
33421>>>    //                                Readln Channel 8 ss1 ss2 ss3 ss4
33421>>>    //                            Loop
33421>>>
33421>>>
33421>>>    ////                            // Only Filmnet Users Log on to SQL
33421>>>    ////                            If (sDepartment='FILMNET') Begin
33421>>>    ////                                ////// 20/06/2001 js Allagh apo Oracle se SQL server
33421>>>    ////                                ////// login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33421>>>    ////                                login '192.168.128.5'   'sa'    ''   'SQL_DRV'
33421>>>    ////                                login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33421>>>    ////                            End
33421>>>    ////                            Else login '192.168.128.5'      'sa'    ''   'SQL_DRV'
33421>>>    ////                            //Else login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33421>>>
33421>>>    ////                        End
33421>>>    ////                        Else Begin
33421>>>    ////                            ////// 20/06/2001 js Allagh apo Oracle se SQL server
33421>>>    ////                            ///// login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33421>>>    ////                            login '192.168.128.5'       'sa'    ''   'SQL_DRV'
33421>>>    ////                            //login '192.168.128.5'   'EPGDNS'    'DNS'   'SQL_DRV'
33421>>>    ////                            login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33421>>>    ////                        End
33421>>>
33421>>>
33421>>>    //                End
33421>>>
33421>>>    //            End
33421>>>    //            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33421>>>
33421>>>
33421>>>
33421>>>            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33421>>>            //*Integer bFileExists
33421>>>            //*Get Get_File_Exists  "C:\AutLogIn.txt" To bFileExists
33421>>>            //*If (NOT(bFileExists)) Begin
33421>>>            //*    If Size## ne 0 Begin
33421>>>            //*        // Only Filmnet Users Log on to SQL
33421>>>            //*        If (sDepartment='FILMNET') Begin
33421>>>            //*            login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33421>>>            //*            login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33421>>>            //*        End
33421>>>            //*        Else login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33421>>>            //*    End
33421>>>            //*    Else Begin
33421>>>            //*        login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33421>>>            //*        login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33421>>>            //*    End
33421>>>            //*
33421>>>            //*End
33421>>>            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33421>>>
33421>>>
33421>>>
33421>>>        End
33421>>>>
33421>>>
33421>>>        Get LoginOk to PasswordOk
33422>>>        Sysdate lsLoginDate lsHH lsMM lsSS
33426>>>        get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
33429>>>        If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
33432>>>        insert "WorkSpaces\" in LastLogin## at 1
33434>>>        get_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
33437>>>        If ((LoginDriver## ne "") and ((UpperCase(LoginDriver##)) ne "DATAFLEX")) Begin
33439>>>           If Not LoginDriver## in LoginSeq## Begin
33441>>>                 If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
33444>>>                 Else Move (LoginSeq##+"|"+LoginDriver##) to LoginSeq##
33446>>>                 set_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
33449>>>           End
33449>>>>
33449>>>        End
33449>>>>
33449>>>        Append LastLogin## "\" (Module_Name(Self))
33451>>>        Append LastLogin## "\LastLogin"
33452>>>        get_profile_string LastLogin## "LoginDriver" to LoginSeq##
33455>>>
33455>>>        If "|" in LoginSeq## Begin
33457>>>            If ((left(LoginSeq##,(pos("|",LoginSeq##) -1))) ne LoginDriver##) Insert (LoginDriver##+"|") in LoginSeq## at 1
33461>>>        End
33461>>>>
33461>>>        Else Begin
33462>>>            If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
33465>>>            Else If LoginSeq## ne LoginDriver## Insert (LoginDriver##+"|") in LoginSeq## at 1
33470>>>        End
33470>>>>
33470>>>        Left LoginSeq## to LoginSeq## 250
33472>>>>
33472>>>        set_profile_string LastLogin## "LoginDriver" to (UpperCase(LoginSeq##))
33475>>>        set_profile_string LastLogin## "LoginServer" to LoginServer##
33478>>>        set_profile_string LastLogin## "LoginUserId" to LoginUserId##
33481>>>        set_profile_string LastLogin## "SavePassword" to SavePassword##
33484>>>        If lsHH lt 10 Insert 0 in lsHH at 1
33488>>>        If lsMM lt 10 Insert 0 in lsMM at 1
33492>>>        If lsSS lt 10 Insert 0 in lsSS at 1
33496>>>        Append lsLoginDate " - " lsHH ":" lsMM ":" lsSS
33502>>>        set_profile_string LastLogin## "LoginTime" to lsLoginDate
33505>>>        If (SavePassword##) Begin
33507>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33508>>>            set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to (fsCrypto(Self,"forward",LoginPassword##))
33511>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33512>>>        End
33512>>>>
33512>>>        Else Begin
33513>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33514>>>            set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to ""
33517>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33518>>>        End
33518>>>>
33518>>>
33518>>>        Function_Return PasswordOk
33519>>>    End_Function
33520>>>
33520>>>    Procedure Login For Desktop
33521>>>        Local Integer LoginPassword##
33522>>>        Get LoginUser of (Connect(Current_Object)) to LoginPassword##
33523>>>        If Not LoginPassword## Send Exit_Application
33526>>>    End_Procedure
33527>>>
33527>>>    Function CheckLogin For Desktop Returns Integer
33528>>>        Local Integer LoginPassword##
33529>>>        Get LoginUser of (Connect(Current_Object)) to LoginPassword##
33530>>>        Function_Return LoginPassword##
33531>>>    End_Function
33532>>>
33532>>>
33532>>>
33532>>>    //AB-StoreEnd
33532>>>
33532>>>End_Object    // Connect
33533>>>
33533>>>
33533>>>//AB-StoreStart
33533>>>
33533>>>
33533>>>
33533>>>//AB-StoreEnd
33533>>>
33533>>>//AB/ End_Object    // prj
33533>Send Login
33534>Use Xrhsh.pkg
INCLUDING FILE: XRHSH.PKG
33534>>>//------------------------------
33534>>>Use SelectXr.Dg
INCLUDING FILE: SELECTXR.DG
33534>>>>>//AB/ Project SelectXr
33534>>>>>//AB/     Object prj is a Dialog_Project
33534>>>>>//AB/         Set ProjectName to "SelectXr"
33534>>>>>//AB/         Set ProjectFileName to "SelectXr.DG"
33534>>>>>//AB/         Set GenerateFileName to "NONAME"
33534>>>>>
33534>>>>>// Project Object Structure
33534>>>>>//   oSelectYear is a dbModalPanelSub
33534>>>>>//     Company_DD is a DataDictionary
33534>>>>>//     Branch_DD is a DataDictionary
33534>>>>>//     Year_DD is a DataDictionary
33534>>>>>//     Company_Company_Code is a dbFormSub
33534>>>>>//     Company_Company_Name is a dbFormSub
33534>>>>>//     Branch_Branch_Code is a dbFormSub
33534>>>>>//     Branch_Branch_Name is a dbFormSub
33534>>>>>//     Year_Year_Year is a dbFormSub
33534>>>>>//     Year_Year_Descr is a dbFormSub
33534>>>>>//     Year_Year_Entrydate is a dbFormSub
33534>>>>>//     oOk_bn is a ButtonSub
33534>>>>>//     oCancel_bn is a ButtonSub
33534>>>>>//     otxtCompany is a TextBoxSub
33534>>>>>//     otxtBranch is a TextBoxSub
33534>>>>>//     otxtYear is a TextBoxSub
33534>>>>>//     otxtWorkingDay is a TextBoxSub
33534>>>>>//     otxtWorkingDay is a TextBoxSub
33534>>>>>//     chkxr is a CheckBoxSub
33534>>>>>
33534>>>>>// Register all objects
33534>>>>>Register_Object Branch_Branch_Code
33534>>>>>Register_Object Branch_Branch_Name
33534>>>>>Register_Object Branch_DD
33534>>>>>Register_Object Company_Company_Code
33534>>>>>Register_Object Company_Company_Name
33534>>>>>Register_Object Company_DD
33534>>>>>Register_Object chkxr
33534>>>>>Register_Object oCancel_bn
33534>>>>>Register_Object oOk_bn
33534>>>>>Register_Object oSelectYear
33534>>>>>Register_Object otxtBranch
33534>>>>>Register_Object otxtCompany
33534>>>>>Register_Object otxtWorkingDay
33534>>>>>Register_Object otxtYear
33534>>>>>Register_Object Year_DD
33534>>>>>Register_Object Year_Year_Descr
33534>>>>>Register_Object Year_Year_Entrydate
33534>>>>>Register_Object Year_Year_Year
33534>>>>>
33534>>>>>
33534>>>>>
33534>>>>>    //AB-StoreTopStart
33534>>>>>
33534>>>>>
33534>>>>>
33534>>>>>
33534>>>>>           String  gs_selected_beto_site
33534>>>>>
33534>>>>>    Open SysCurXR
33536>>>>>    Open Nomisma
33538>>>>>
33538>>>>>    //AB-StoreTopEnd
33538>>>>>
33538>>>>>    //AB-IgnoreStart
33538>>>>>
33538>>>>>    Use DFAllEnt.pkg
33538>>>>>    Use dbForm.Sub
33538>>>>>    Use Button.Sub
33538>>>>>    Use Txtbox.Sub
33538>>>>>    Use Chkbox.Sub
33538>>>>>
33538>>>>>
33538>>>>>    Use COMPANY.DD
INCLUDING FILE: COMPANY.DD
33538>>>>>>>//DDB-FileStart
33538>>>>>>>//DDB-HeaderStart
33538>>>>>>>
33538>>>>>>>// File Name : COMPANY.DD
33538>>>>>>>// Class Name: Company_DataDictionary
33538>>>>>>>// Revision  : 58
33538>>>>>>>// Version   : 2
33538>>>>>>>
33538>>>>>>>Use  Windows           // Basic Definitions
33538>>>>>>>Use  DataDict          // DataDictionary Class Definition
33538>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
33538>>>>>>>
33538>>>>>>>Open Company
INCLUDING FILE: COMPANY.FD
33540>>>>>>>Open Branch
33542>>>>>>>
33542>>>>>>>//DDB-HeaderEnd
33542>>>>>>>//DDB-ValidationStart
33542>>>>>>>
33542>>>>>>>Register_Object Company_Company_Doy_VT
33542>>>>>>>Register_Object Company_Company_J_Code_VT
33542>>>>>>>
33542>>>>>>>Object Company_Company_Doy_VT  is a CodeValidationTable
33544>>>>>>>    Set Type_Value        To "DOY"
33545>>>>>>>    Set Allow_Blank_State To TRUE
33546>>>>>>>    //DDB-ValidationCustomStart
33546>>>>>>>    //DDB-ValidationCustomEnd
33546>>>>>>>End_Object   // Company_Company_Doy_VT
33547>>>>>>>
33547>>>>>>>Object Company_Company_J_Code_VT  is a CodeValidationTable
33549>>>>>>>    Set Type_Value        To "JOB"
33550>>>>>>>    Set Allow_Blank_State To TRUE
33551>>>>>>>    //DDB-ValidationCustomStart
33551>>>>>>>    //DDB-ValidationCustomEnd
33551>>>>>>>End_Object   // Company_Company_J_Code_VT
33552>>>>>>>//DDB-ValidationEnd
33552>>>>>>>//DDB-SelectionStart
33552>>>>>>>//DDB/ ExternalSelectionList sl001  sl001.sl
33552>>>>>>>Register_Object sl001
33552>>>>>>>//DDB-SelectionEnd
33552>>>>>>> 
33552>>>>>>>Class Company_DataDictionary  is a DataDictionary
33553>>>>>>> 
33553>>>>>>>    // Update:
33553>>>>>>> 
33553>>>>>>>    Procedure Update
33554>>>>>>>        Forward Send Update
33556>>>>>>>        move 'DOY' to company.doy_type
33557>>>>>>>        move 'JOB' to company.jcode_type 
33558>>>>>>>        // Insert Code Here
33558>>>>>>>    End_Procedure   // Update
33559>>>>>>> 
33559>>>>>>>
33559>>>>>>>    // Operation_Not_Allowed:
33559>>>>>>>
33559>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
33560>>>>>>>        // Insert Code Here
33560>>>>>>>        Case Begin
33560>>>>>>>             Case (iError_Num = 1001)
33562>>>>>>>                  Error 1001 "DDC 051:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª „«˜ ¨œå˜ª!\n\n‰œ¤æª ‰à› ¡æª"
33563>>>>>>>>
33563>>>>>>>             Case Break
33564>>>>>>>
33564>>>>>>>             Case Else
33564>>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
33566>>>>>>>        Case End
33566>>>>>>>    End_Procedure   // Operation_Not_Allowed
33567>>>>>>>
33567>>>>>>>
33567>>>>>>>    // Validate_Save:
33567>>>>>>>
33567>>>>>>>    Function Validate_Save  Returns Integer
33568>>>>>>>        Local Integer iReturnVal
33569>>>>>>>        Forward Get Validate_Save  To iReturnVal
33571>>>>>>>        If (Not(iReturnVal)) Begin
33573>>>>>>>            // Insert Code Here
33573>>>>>>>            If (Company.Company_Code="") Send Operation_Not_Allowed 1001
33576>>>>>>>        End
33576>>>>>>>>
33576>>>>>>>        Function_Return iReturnVal
33577>>>>>>>    End_Function   // Validate_Save
33578>>>>>>>
33578>>>>>>>
33578>>>>>>>    // Define_Fields:
33578>>>>>>>    // This procedure is used to set up all data-dictionary rules.
33578>>>>>>>
33578>>>>>>>    Procedure Define_Fields
33579>>>>>>>        Forward Send Define_Fields
33581>>>>>>>        //DDB-Generated-Code-Location
33581>>>>>>>        //DDB-DefineFieldStart
33581>>>>>>>
33581>>>>>>>        Set Main_File            To Company.File_Number
33582>>>>>>>        Set Cascade_Delete_State To FALSE
33583>>>>>>>
33583>>>>>>>
33583>>>>>>>        // Child (Client) file structure................
33583>>>>>>>        Send Add_Client_File  Branch.File_Number
33584>>>>>>>
33584>>>>>>>        // Field-based properties.......................
33584>>>>>>>
33584>>>>>>>        // Company.Company_Code
33584>>>>>>>        Set Field_Options          Field Company.Company_Code To DD_AUTOFIND   
33585>>>>>>>        Set Field_Prompt_Object    Field Company.Company_Code To (sl001(Self))
33586>>>>>>>
33586>>>>>>>        // Company.Company_Name
33586>>>>>>>        Set Field_Options          Field Company.Company_Name To DD_REQUIRED   
33587>>>>>>>        Set Field_Prompt_Object    Field Company.Company_Name To (sl001(Self))
33588>>>>>>>
33588>>>>>>>        // Company.Company_Afm
33588>>>>>>>        Set Field_Options          Field Company.Company_Afm To DD_AUTOFIND   
33589>>>>>>>
33589>>>>>>>        // Company.Company_Addr
33589>>>>>>>
33589>>>>>>>        // Company.Company_Tk
33589>>>>>>>
33589>>>>>>>        // Company.Company_Poli
33589>>>>>>>
33589>>>>>>>        // Company.Company_Doy
33589>>>>>>>        Set Field_Value_Table      Field Company.Company_Doy To (Company_Company_Doy_VT(Self))
33590>>>>>>>
33590>>>>>>>        // Company.Company_J_Code
33590>>>>>>>        Set Field_Value_Table      Field Company.Company_J_Code To (Company_Company_J_Code_VT(Self))
33591>>>>>>>
33591>>>>>>>        // Company.Company_C_Code0
33591>>>>>>>
33591>>>>>>>        // Company.Company_C_Cod00
33591>>>>>>>
33591>>>>>>>        // Company.Company_C_Coder
33591>>>>>>>
33591>>>>>>>        // Company.Company_Tel
33591>>>>>>>
33591>>>>>>>        // Company.Company_Fax
33591>>>>>>>
33591>>>>>>>        // Company.Company_Email
33591>>>>>>>
33591>>>>>>>        // Company.Company_Resp
33591>>>>>>>
33591>>>>>>>        // Company.Company_Bitmap
33591>>>>>>>
33591>>>>>>>        // Company.Beto_Site
33591>>>>>>>
33591>>>>>>>        // Company.Logo
33591>>>>>>>
33591>>>>>>>        // Company.Doy_Type
33591>>>>>>>
33591>>>>>>>        // Company.Jcode_Type
33591>>>>>>>
33591>>>>>>>        //DDB-DefineFieldEnd
33591>>>>>>>    End_Procedure    // Define_Fields
33592>>>>>>>
33592>>>>>>>    // Field_Defaults:
33592>>>>>>>    // This procedure is used to establish default field values.
33592>>>>>>>
33592>>>>>>>    Procedure Field_Defaults
33593>>>>>>>        Forward Send Field_Defaults
33595>>>>>>>        //DDB-Generated-Code-Location
33595>>>>>>>        //DDB-FieldDefaultStart
33595>>>>>>>        //DDB-FieldDefaultEnd
33595>>>>>>>    End_Procedure    // Field_Defaults
33596>>>>>>>End_Class    // Company_DataDictionary
33597>>>>>>>
33597>>>>>>>//DDB-Selection-pkg-Start
33597>>>>>>>
33597>>>>>>>Use sl001.sl         // sl001
INCLUDING FILE: SL001.SL
33597>>>>>>>>>//AB/ Project sl001 : Etairies
33597>>>>>>>>>//AB/     Object prj is a Lookup_Project
33597>>>>>>>>>//AB/         Set ProjectName to "sl001 : Etairies"
33597>>>>>>>>>//AB/         Set ProjectFileName to "sl001.SL"
33597>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
33597>>>>>>>>>
33597>>>>>>>>>// Project Object Structure
33597>>>>>>>>>//   sl001 is a dbModalPanel
33597>>>>>>>>>//     Company_DD is a DataDictionary
33597>>>>>>>>>//     oSelList is a dbList
33597>>>>>>>>>//     oOK_bn is a ButtonSub
33597>>>>>>>>>//     oCancel_bn is a ButtonSub
33597>>>>>>>>>//     oSearch_bn is a ButtonSub
33597>>>>>>>>>
33597>>>>>>>>>// Register all objects
33597>>>>>>>>>Register_Object Company_DD
33597>>>>>>>>>Register_Object oCancel_bn
33597>>>>>>>>>Register_Object oOK_bn
33597>>>>>>>>>Register_Object oSearch_bn
33597>>>>>>>>>Register_Object oSelList
33597>>>>>>>>>Register_Object sl001
33597>>>>>>>>>
33597>>>>>>>>>
33597>>>>>>>>>    //AB-IgnoreStart
33597>>>>>>>>>
33597>>>>>>>>>    Use DFAllEnt.pkg
33597>>>>>>>>>    Use Button.Sub
33597>>>>>>>>>
33597>>>>>>>>>
33597>>>>>>>>>    Use COMPANY.DD
33597>>>>>>>>>    
33597>>>>>>>>>    //AB-IgnoreEnd
33597>>>>>>>>>
33597>>>>>>>>>    CD_Popup_Object sl001 is a dbModalPanel
33616>>>>>>>>>        Set Label to "„«˜ ¨åœª"
33617>>>>>>>>>        Set Size to 148 297
33618>>>>>>>>>        Set Location to 12 27
33619>>>>>>>>>
33619>>>>>>>>>        //AB-DDOStart
33619>>>>>>>>>
33619>>>>>>>>>        Object Company_DD is a Company_DataDictionary
33621>>>>>>>>>        End_Object    // Company_DD
33622>>>>>>>>>
33622>>>>>>>>>        Set Main_DD to (Company_DD(self))
33623>>>>>>>>>        Set Server to (Company_DD(self))
33624>>>>>>>>>
33624>>>>>>>>>        //AB-DDOEnd
33624>>>>>>>>>
33624>>>>>>>>>        Object oSelList is a dbList
33626>>>>>>>>>            Set Main_File to Company.File_Number
33627>>>>>>>>>            Set Size to 105 280
33628>>>>>>>>>            Set Location to 6 6
33629>>>>>>>>>
33629>>>>>>>>>            Begin_Row
33632>>>>>>>>>                Entry_Item Company.Company_code
33633>>>>>>>>>                Entry_Item Company.Company_name
33634>>>>>>>>>                Entry_Item Company.Company_afm
33635>>>>>>>>>            End_Row
33640>>>>>>>>>
33640>>>>>>>>>            Set Form_Width    item 0 to 42
33641>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
33642>>>>>>>>>            
33642>>>>>>>>>            Set Form_Width    item 1 to 150
33643>>>>>>>>>            Set Header_Label  item 1 to "„§à¤¬£å˜"
33644>>>>>>>>>            
33644>>>>>>>>>            Set Form_Width    item 2 to 80
33645>>>>>>>>>            Set Header_Label  item 2 to "€.”.‹"
33646>>>>>>>>>            
33646>>>>>>>>>        End_Object    // oSelList
33647>>>>>>>>>
33647>>>>>>>>>        Object oOK_bn is a ButtonSub
33649>>>>>>>>>            Set Label to "&„§ ¢¦šã"
33650>>>>>>>>>            Set Location to 115 126
33651>>>>>>>>>
33651>>>>>>>>>            //AB-StoreStart
33651>>>>>>>>>            Procedure OnClick
33653>>>>>>>>>                Send OK To (oSelList(current_object))
33654>>>>>>>>>            End_Procedure
33655>>>>>>>>>            //AB-StoreEnd
33655>>>>>>>>>
33655>>>>>>>>>        End_Object    // oOK_bn
33656>>>>>>>>>
33656>>>>>>>>>        Object oCancel_bn is a ButtonSub
33658>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
33659>>>>>>>>>            Set Location to 115 181
33660>>>>>>>>>
33660>>>>>>>>>            //AB-StoreStart
33660>>>>>>>>>            Procedure OnClick
33662>>>>>>>>>                Send Cancel To (oSelList(current_object))
33663>>>>>>>>>            End_Procedure
33664>>>>>>>>>            //AB-StoreEnd
33664>>>>>>>>>
33664>>>>>>>>>        End_Object    // oCancel_bn
33665>>>>>>>>>
33665>>>>>>>>>        Object oSearch_bn is a ButtonSub
33667>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
33668>>>>>>>>>            Set Location to 115 236
33669>>>>>>>>>
33669>>>>>>>>>            //AB-StoreStart
33669>>>>>>>>>            Procedure OnClick
33671>>>>>>>>>                Send Search To (oSelList(current_object))
33672>>>>>>>>>            End_Procedure
33673>>>>>>>>>            //AB-StoreEnd
33673>>>>>>>>>
33673>>>>>>>>>        End_Object    // oSearch_bn
33674>>>>>>>>>
33674>>>>>>>>>
33674>>>>>>>>>        //AB-StoreStart
33674>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To oOk_bn
33675>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To oCancel_bn
33676>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To oSearch_bn
33677>>>>>>>>>        //AB-StoreEnd
33677>>>>>>>>>
33677>>>>>>>>>    CD_End_Object    // sl001
33679>>>>>>>>>>
33679>>>>>>>>>
33679>>>>>>>>>//AB/     End_Object    // prj
33679>>>>>>>
33679>>>>>>>//DDB-Selection-pkg-End
33679>>>>>>>//DDB-FileEnd
33679>>>>>    Use BRANCH.DD
INCLUDING FILE: BRANCH.DD
33679>>>>>>>//DDB-FileStart
33679>>>>>>>//DDB-HeaderStart
33679>>>>>>>
33679>>>>>>>// File Name : BRANCH.DD
33679>>>>>>>// Class Name: Branch_DataDictionary
33679>>>>>>>// Revision  : 83
33679>>>>>>>// Version   : 2
33679>>>>>>>
33679>>>>>>>Use  Windows           // Basic Definitions
33679>>>>>>>Use  DataDict          // DataDictionary Class Definition
33679>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
33679>>>>>>>
33679>>>>>>>Open Branch
33681>>>>>>>Open Year
33683>>>>>>>Open Brzones
INCLUDING FILE: BRZONES.FD
33685>>>>>>>Open Tpbranch
INCLUDING FILE: TPBRANCH.FD
33687>>>>>>>Open Company
33689>>>>>>>Open Sysrecg
INCLUDING FILE: SYSRECG.FD
33691>>>>>>>
33691>>>>>>>//DDB-HeaderEnd
33691>>>>>>>//DDB-ValidationStart
33691>>>>>>>
33691>>>>>>>Register_Object Branch_Branch_Doy_VT
33691>>>>>>>Register_Object Branch_Branch_J_Code_VT
33691>>>>>>>Register_Object Branch_Branch_C_Code0_VT
33691>>>>>>>
33691>>>>>>>Object Branch_Branch_Doy_VT  is a CodeValidationTable
33693>>>>>>>    Set Type_Value        To "DOY"
33694>>>>>>>    Set Validate_State    To FALSE
33695>>>>>>>    Set Allow_Blank_State To TRUE
33696>>>>>>>    //DDB-ValidationCustomStart
33696>>>>>>>    //DDB-ValidationCustomEnd
33696>>>>>>>End_Object   // Branch_Branch_Doy_VT
33697>>>>>>>
33697>>>>>>>Object Branch_Branch_J_Code_VT  is a CodeValidationTable
33699>>>>>>>    Set Type_Value        To "JOB"
33700>>>>>>>    Set Allow_Blank_State To TRUE
33701>>>>>>>    //DDB-ValidationCustomStart
33701>>>>>>>    //DDB-ValidationCustomEnd
33701>>>>>>>End_Object   // Branch_Branch_J_Code_VT
33702>>>>>>>
33702>>>>>>>Object Branch_Branch_C_Code0_VT  is a CodeValidationTable
33704>>>>>>>    Set Type_Value        To ""
33705>>>>>>>    Set Allow_Blank_State To TRUE
33706>>>>>>>    //DDB-ValidationCustomStart
33706>>>>>>>    //DDB-ValidationCustomEnd
33706>>>>>>>End_Object   // Branch_Branch_C_Code0_VT
33707>>>>>>>//DDB-ValidationEnd
33707>>>>>>>//DDB-SelectionStart
33707>>>>>>>//DDB/ ExternalSelectionList SL002  Sl002.sl
33707>>>>>>>Register_Object SL002
33707>>>>>>>//DDB-SelectionEnd
33707>>>>>>>
33707>>>>>>>Class Branch_DataDictionary  is a DataDictionary
33708>>>>>>> 
33708>>>>>>>    Procedure Save_Main_File
33709>>>>>>>        Forward Send Save_Main_File
33711>>>>>>>        // Insert Code Here
33711>>>>>>>    End_Procedure   // Save_Main_File
33712>>>>>>> 
33712>>>>>>>    Procedure Creating
33713>>>>>>>        Forward Send Creating
33715>>>>>>>        // Insert Code Here
33715>>>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Branch.Branch_Rec0)))))) to Branch.Branch_Recr
33716>>>>>>>    End_Procedure   // Creating
33717>>>>>>>
33717>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
33718>>>>>>>        // Insert Code Here
33718>>>>>>>        Case Begin
33718>>>>>>>             Case (iError_Num = 1001)
33720>>>>>>>                  Error 1001 "DDC 052:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
33721>>>>>>>>
33721>>>>>>>             Case Break
33722>>>>>>>
33722>>>>>>>             Case Else
33722>>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
33724>>>>>>>        Case End
33724>>>>>>>    End_Procedure   // Operation_Not_Allowed
33725>>>>>>>
33725>>>>>>>
33725>>>>>>>    // Validate_Save:
33725>>>>>>>
33725>>>>>>>    Function Validate_Save  Returns Integer
33726>>>>>>>        Local Integer iReturnVal
33727>>>>>>>        Forward Get Validate_Save  To iReturnVal
33729>>>>>>>        If (Not(iReturnVal)) Begin
33731>>>>>>>            // Insert Code Here
33731>>>>>>>            If (Branch.Branch_Code="") Send Operation_Not_Allowed 1001
33734>>>>>>>        End
33734>>>>>>>>
33734>>>>>>>        Function_Return iReturnVal
33735>>>>>>>    End_Function   // Validate_Save
33736>>>>>>>
33736>>>>>>>
33736>>>>>>>    // Define_Fields:
33736>>>>>>>    // This procedure is used to set up all data-dictionary rules.
33736>>>>>>>
33736>>>>>>>    Procedure Define_Fields
33737>>>>>>>        Forward Send Define_Fields
33739>>>>>>>        //DDB-Generated-Code-Location
33739>>>>>>>        //DDB-DefineFieldStart
33739>>>>>>>
33739>>>>>>>        Set Main_File            To Branch.File_Number
33740>>>>>>>        Set Cascade_Delete_State To FALSE
33741>>>>>>>
33741>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
33742>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOENTER     DD_FINDREQ    
33743>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
33744>>>>>>>
33744>>>>>>>        // Child (Client) file structure................
33744>>>>>>>        Send Add_Client_File  Year.File_Number
33745>>>>>>>        Send Add_Client_File  Brzones.File_Number
33746>>>>>>>        Send Add_Client_File  Tpbranch.File_Number
33747>>>>>>>
33747>>>>>>>        // Parent (Server) file structure...............
33747>>>>>>>        Send Add_Server_File  Company.File_Number
33748>>>>>>>
33748>>>>>>>        // External (System) file structure.............
33748>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
33749>>>>>>>
33749>>>>>>>        Define_Auto_Increment  Sysrecg.Branch_Rec0  To Branch.Branch_Rec0
33752>>>>>>>
33752>>>>>>>        // Field-based properties.......................
33752>>>>>>>
33752>>>>>>>        // Branch.Company_Code
33752>>>>>>>
33752>>>>>>>        // Branch.Branch_Code
33752>>>>>>>        Set Field_Options          Field Branch.Branch_Code To DD_AUTOFIND   
33753>>>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Code To (SL002(Self))
33754>>>>>>>        Set Key_Field_State        Field Branch.Branch_Code To TRUE
33755>>>>>>>
33755>>>>>>>        // Branch.Branch_Rec0
33755>>>>>>>
33755>>>>>>>        // Branch.Branch_Recr
33755>>>>>>>
33755>>>>>>>        // Branch.Branch_Name
33755>>>>>>>        Set Field_Options          Field Branch.Branch_Name To DD_REQUIRED   
33756>>>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Name To (SL002(Self))
33757>>>>>>>
33757>>>>>>>        // Branch.Branch_Afm
33757>>>>>>>
33757>>>>>>>        // Branch.Branch_Addr
33757>>>>>>>
33757>>>>>>>        // Branch.Branch_Tk
33757>>>>>>>
33757>>>>>>>        // Branch.Branch_Poli
33757>>>>>>>
33757>>>>>>>        // Branch.Branch_Doy
33757>>>>>>>        Set Field_Value_Table      Field Branch.Branch_Doy To (Branch_Branch_Doy_VT(Self))
33758>>>>>>>
33758>>>>>>>        // Branch.Branch_J_Code
33758>>>>>>>        Set Field_Value_Table      Field Branch.Branch_J_Code To (Branch_Branch_J_Code_VT(Self))
33759>>>>>>>
33759>>>>>>>        // Branch.Branch_C_Code0
33759>>>>>>>        Set Field_Value_Table      Field Branch.Branch_C_Code0 To (Branch_Branch_C_Code0_VT(Self))
33760>>>>>>>
33760>>>>>>>        // Branch.Branch_C_Code00
33760>>>>>>>
33760>>>>>>>        // Branch.Branch_C_Coder
33760>>>>>>>
33760>>>>>>>        // Branch.Branch_Tel
33760>>>>>>>
33760>>>>>>>        // Branch.Branch_Fax
33760>>>>>>>
33760>>>>>>>        // Branch.Branch_Email
33760>>>>>>>
33760>>>>>>>        // Branch.Branch_Resp
33760>>>>>>>
33760>>>>>>>        // Branch.Branch_Bitmap
33760>>>>>>>
33760>>>>>>>        // Branch.Branch_Site
33760>>>>>>>
33760>>>>>>>        // Branch.Branch_Apoth
33760>>>>>>>
33760>>>>>>>        // Branch.Beto_Site
33760>>>>>>>
33760>>>>>>>        // Branch.Path_Exp
33760>>>>>>>
33760>>>>>>>        // Branch.Exp_Txtname
33760>>>>>>>
33760>>>>>>>        // Branch.Send_Phone
33760>>>>>>>
33760>>>>>>>        // Branch.Send_Path_Files
33760>>>>>>>
33760>>>>>>>        // Branch.Send_Path_Conf
33760>>>>>>>
33760>>>>>>>        // Branch.Tomeas_Code
33760>>>>>>>
33760>>>>>>>        // Branch.Ftp_Sec_Retry
33760>>>>>>>
33760>>>>>>>        // Branch.Ftp_Sec_Exit
33760>>>>>>>
33760>>>>>>>        // Branch.Ras_Name
33760>>>>>>>
33760>>>>>>>        // Branch.Ras_Passw
33760>>>>>>>
33760>>>>>>>        // Branch.Ras_Domain
33760>>>>>>>
33760>>>>>>>        // Branch.Last_Hmnia_Ekt
33760>>>>>>>
33760>>>>>>>        // Branch.Deop_Logo
33760>>>>>>>
33760>>>>>>>        // Branch.Entolh
33760>>>>>>>
33760>>>>>>>        // Branch.Paragogh
33760>>>>>>>
33760>>>>>>>        // Branch.Locked_Until
33760>>>>>>>
33760>>>>>>>        //DDB-DefineFieldEnd
33760>>>>>>>    End_Procedure    // Define_Fields
33761>>>>>>>
33761>>>>>>>    // Field_Defaults:
33761>>>>>>>    // This procedure is used to establish default field values.
33761>>>>>>>
33761>>>>>>>    Procedure Field_Defaults
33762>>>>>>>        Forward Send Field_Defaults
33764>>>>>>>        //DDB-Generated-Code-Location
33764>>>>>>>        //DDB-FieldDefaultStart
33764>>>>>>>        //DDB-FieldDefaultEnd
33764>>>>>>>    End_Procedure    // Field_Defaults
33765>>>>>>>End_Class    // Branch_DataDictionary
33766>>>>>>>
33766>>>>>>>//DDB-Selection-pkg-Start
33766>>>>>>>
33766>>>>>>>Use Sl002.sl         // SL002
INCLUDING FILE: SL002.SL
33766>>>>>>>>>//AB/ Project SL002:Branch
33766>>>>>>>>>//AB/ Object prj is a Lookup_Project
33766>>>>>>>>>//AB/     Set ProjectName to "SL002:Branch"
33766>>>>>>>>>//AB/     Set ProjectFileName to "Sl002.sl"
33766>>>>>>>>>
33766>>>>>>>>>// Project Object Structure
33766>>>>>>>>>//   SL002 is a dbModalPanelSub
33766>>>>>>>>>//     Company_DD is a DataDictionary
33766>>>>>>>>>//     Branch_DD is a DataDictionary
33766>>>>>>>>>//     oSelList is a dbListSub
33766>>>>>>>>>//     oOK_bn is a ButtonSub
33766>>>>>>>>>//     oCancel_bn is a ButtonSub
33766>>>>>>>>>//     oSearch_bn is a ButtonSub
33766>>>>>>>>>
33766>>>>>>>>>// Register all objects
33766>>>>>>>>>Register_Object Branch_DD
33766>>>>>>>>>Register_Object Company_DD
33766>>>>>>>>>Register_Object oCancel_bn
33766>>>>>>>>>Register_Object oOK_bn
33766>>>>>>>>>Register_Object oSearch_bn
33766>>>>>>>>>Register_Object oSelList
33766>>>>>>>>>Register_Object SL002
33766>>>>>>>>>
33766>>>>>>>>>
33766>>>>>>>>>//AB-IgnoreStart
33766>>>>>>>>>
33766>>>>>>>>>Use DFAllEnt.pkg
33766>>>>>>>>>Use dbList.Sub
33766>>>>>>>>>Use Button.Sub
33766>>>>>>>>>
33766>>>>>>>>>
33766>>>>>>>>>Use COMPANY.DD
33766>>>>>>>>>Use BRANCH.DD
33766>>>>>>>>>
33766>>>>>>>>>//AB-IgnoreEnd
33766>>>>>>>>>
33766>>>>>>>>>Object SL002 is a dbModalPanelSub
33768>>>>>>>>>
33768>>>>>>>>>    //AB-StoreTopStart
33768>>>>>>>>>    Property String psFragmaCompanyCode  ""
33770>>>>>>>>>    
33770>>>>>>>>>    //AB-StoreTopEnd
33770>>>>>>>>>
33770>>>>>>>>>    Set Minimize_Icon to FALSE
33771>>>>>>>>>    Set Label to "“§¦¡˜«˜©«ã£˜«˜"
33772>>>>>>>>>    Set Size to 146 430
33773>>>>>>>>>    Set Location to 4 5
33774>>>>>>>>>    Set Exit_Application_Local_State to FALSE
33775>>>>>>>>>    Set Modal_State to FALSE
33776>>>>>>>>>
33776>>>>>>>>>    //AB-DDOStart
33776>>>>>>>>>
33776>>>>>>>>>    Object Company_DD is a Company_DataDictionary
33778>>>>>>>>>    End_Object    // Company_DD
33779>>>>>>>>>
33779>>>>>>>>>    Object Branch_DD is a Branch_DataDictionary
33781>>>>>>>>>        Set DDO_Server to (Company_DD(self))
33782>>>>>>>>>
33782>>>>>>>>>        //AB-StoreStart
33782>>>>>>>>>        Procedure OnConstrain
33784>>>>>>>>>             String lsCompanyCode
33785>>>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
33786>>>>>>>>>             If (lsCompanyCode <> "") Constrain Branch.Company_code eq lsCompanyCode
33790>>>>>>>>>        End_Procedure // OnConstrain
33791>>>>>>>>>        
33791>>>>>>>>>        
33791>>>>>>>>>        
33791>>>>>>>>>        //AB-StoreEnd
33791>>>>>>>>>
33791>>>>>>>>>    End_Object    // Branch_DD
33792>>>>>>>>>
33792>>>>>>>>>    Set Main_DD to (Branch_DD(self))
33793>>>>>>>>>    Set Server to (Branch_DD(self))
33794>>>>>>>>>
33794>>>>>>>>>    //AB-DDOEnd
33794>>>>>>>>>
33794>>>>>>>>>    Object oSelList is a dbListSub
33796>>>>>>>>>        Set Main_File to Branch.File_Number
33797>>>>>>>>>        Set Size to 105 415
33798>>>>>>>>>        Set Location to 6 6
33799>>>>>>>>>
33799>>>>>>>>>        Begin_Row
33802>>>>>>>>>            Entry_Item Branch.Branch_code
33803>>>>>>>>>            Entry_Item Branch.Branch_name
33804>>>>>>>>>            Entry_Item Company.Company_code
33805>>>>>>>>>            Entry_Item Company.Company_name
33806>>>>>>>>>            Entry_Item Branch.Beto_site
33807>>>>>>>>>            Entry_Item Branch.Branch_recr
33808>>>>>>>>>        End_Row
33813>>>>>>>>>
33813>>>>>>>>>        Set Form_Width    item 0 to 60
33814>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
33815>>>>>>>>>        
33815>>>>>>>>>        Set Form_Width    item 1 to 128
33816>>>>>>>>>        Set Header_Label  item 1 to "Ž¤¦£˜"
33817>>>>>>>>>        
33817>>>>>>>>>        Set Form_Width    item 2 to 69
33818>>>>>>>>>        Set Header_Label  item 2 to "‰à› ¡æª „«˜ ¨å˜ª"
33819>>>>>>>>>        
33819>>>>>>>>>        Set Form_Width    item 3 to 109
33820>>>>>>>>>        Set Header_Label  item 3 to "Ž¤¦£˜ „«˜ ¨å˜ª"
33821>>>>>>>>>        
33821>>>>>>>>>        Set Form_Width    item 4 to 42
33822>>>>>>>>>        Set Header_Label  item 4 to "Site"
33823>>>>>>>>>        
33823>>>>>>>>>        Set Form_Width    item 5 to 0
33824>>>>>>>>>        Set Header_Label  item 5 to ""
33825>>>>>>>>>        
33825>>>>>>>>>
33825>>>>>>>>>        //AB-StoreStart
33825>>>>>>>>>        
33825>>>>>>>>>        Property String psStoreFragmaCompanyCode  ""
33827>>>>>>>>>        
33827>>>>>>>>>        Procedure Store_Defaults
33829>>>>>>>>>            forward send Store_Defaults
33831>>>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
33832>>>>>>>>>        end_Procedure // Store_Defaults
33833>>>>>>>>>        
33833>>>>>>>>>        Procedure Restore_Defaults
33835>>>>>>>>>            forward send Restore_Defaults
33837>>>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
33838>>>>>>>>>        end_Procedure // Restore_Defaults
33839>>>>>>>>>        
33839>>>>>>>>>        Procedure Activating
33841>>>>>>>>>            Forward Send Activating
33843>>>>>>>>>            Send Rebuild_Constraints to (Branch_DD(self))
33844>>>>>>>>>        End_Procedure // Activating
33845>>>>>>>>>        
33845>>>>>>>>>        Set Column_Options Item 5 to NoEnter True
33846>>>>>>>>>        
33846>>>>>>>>>        
33846>>>>>>>>>        //AB-StoreEnd
33846>>>>>>>>>
33846>>>>>>>>>    End_Object    // oSelList
33847>>>>>>>>>
33847>>>>>>>>>    Object oOK_bn is a ButtonSub
33849>>>>>>>>>        Set Label to "&„§ ¢¦šã"
33850>>>>>>>>>        Set Location to 112 262
33851>>>>>>>>>
33851>>>>>>>>>        //AB-StoreStart
33851>>>>>>>>>        Procedure OnClick
33853>>>>>>>>>            Send OK To (oSelList(current_object))
33854>>>>>>>>>        End_Procedure
33855>>>>>>>>>        //AB-StoreEnd
33855>>>>>>>>>
33855>>>>>>>>>    End_Object    // oOK_bn
33856>>>>>>>>>
33856>>>>>>>>>    Object oCancel_bn is a ButtonSub
33858>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
33859>>>>>>>>>        Set Location to 112 317
33860>>>>>>>>>
33860>>>>>>>>>        //AB-StoreStart
33860>>>>>>>>>        Procedure OnClick
33862>>>>>>>>>            Send Cancel To (oSelList(current_object))
33863>>>>>>>>>        End_Procedure
33864>>>>>>>>>        //AB-StoreEnd
33864>>>>>>>>>
33864>>>>>>>>>    End_Object    // oCancel_bn
33865>>>>>>>>>
33865>>>>>>>>>    Object oSearch_bn is a ButtonSub
33867>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
33868>>>>>>>>>        Set Location to 112 372
33869>>>>>>>>>
33869>>>>>>>>>        //AB-StoreStart
33869>>>>>>>>>        Procedure OnClick
33871>>>>>>>>>            Send Search To (oSelList(current_object))
33872>>>>>>>>>        End_Procedure
33873>>>>>>>>>        //AB-StoreEnd
33873>>>>>>>>>
33873>>>>>>>>>    End_Object    // oSearch_bn
33874>>>>>>>>>
33874>>>>>>>>>
33874>>>>>>>>>    //AB-StoreStart
33874>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
33875>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
33876>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
33877>>>>>>>>>    
33877>>>>>>>>>    
33877>>>>>>>>>    //AB-StoreEnd
33877>>>>>>>>>
33877>>>>>>>>>End_Object    // SL002
33878>>>>>>>>>
33878>>>>>>>>>//AB/ End_Object    // prj
33878>>>>>>>
33878>>>>>>>//DDB-Selection-pkg-End
33878>>>>>>>//DDB-FileEnd
33878>>>>>    Use YEAR.DD
INCLUDING FILE: YEAR.DD
33878>>>>>>>//DDB-FileStart
33878>>>>>>>//DDB-HeaderStart
33878>>>>>>>
33878>>>>>>>// File Name : YEAR.DD
33878>>>>>>>// Class Name: Year_DataDictionary
33878>>>>>>>// Revision  : 118
33878>>>>>>>// Version   : 2
33878>>>>>>>
33878>>>>>>>Use  Windows           // Basic Definitions
33878>>>>>>>Use  DataDict          // DataDictionary Class Definition
33878>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
33878>>>>>>>
33878>>>>>>>Open Year
33880>>>>>>>Open Branch
33882>>>>>>>Open Syscurxr
33884>>>>>>>
33884>>>>>>>//DDB-HeaderEnd
33884>>>>>>>//DDB-ValidationStart
33884>>>>>>>
33884>>>>>>>Register_Object Year_Year_C_Code0_VT1
33884>>>>>>>Register_Object Year_Year_C_Code00_VT1
33884>>>>>>>Register_Object Year_Year_C_Coder_VT1
33884>>>>>>>
33884>>>>>>>Object Year_Year_C_Code0_VT1  is a CodeValidationTable
33886>>>>>>>    Set Type_Value        To "CURRENCY"
33887>>>>>>>    //DDB-ValidationCustomStart
33887>>>>>>>    //DDB-ValidationCustomEnd
33887>>>>>>>End_Object   // Year_Year_C_Code0_VT1
33888>>>>>>>
33888>>>>>>>Object Year_Year_C_Code00_VT1  is a CodeValidationTable
33890>>>>>>>    Set Type_Value        To "CURRENCY"
33891>>>>>>>    //DDB-ValidationCustomStart
33891>>>>>>>    //DDB-ValidationCustomEnd
33891>>>>>>>End_Object   // Year_Year_C_Code00_VT1
33892>>>>>>>
33892>>>>>>>Object Year_Year_C_Coder_VT1  is a CodeValidationTable
33894>>>>>>>    Set Type_Value        To "CURRENCY"
33895>>>>>>>    //DDB-ValidationCustomStart
33895>>>>>>>    //DDB-ValidationCustomEnd
33895>>>>>>>End_Object   // Year_Year_C_Coder_VT1
33896>>>>>>>//DDB-ValidationEnd
33896>>>>>>>//DDB-SelectionStart
33896>>>>>>>//DDB/ ExternalSelectionList SL003  Sl003.sl
33896>>>>>>>Register_Object SL003
33896>>>>>>>//DDB-SelectionEnd
33896>>>>>>>            
33896>>>>>>>Class Year_DataDictionary  is a DataDictionary
33897>>>>>>>    
33897>>>>>>>    Procedure Creating
33898>>>>>>>        Forward Send Creating
33900>>>>>>>        // Insert Code Here
33900>>>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Year.Year_Year)))))) to Year.Year_Recr
33901>>>>>>>    End_Procedure   // Creating
33902>>>>>>>
33902>>>>>>>
33902>>>>>>>    // Operation_Not_Allowed:
33902>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
33903>>>>>>>        // Insert Code Here
33903>>>>>>>        Case Begin    
33903>>>>>>>             Case (iError_Num = 1001)
33905>>>>>>>                  Error 1001 "DDC 053:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
33906>>>>>>>>
33906>>>>>>>             Case Break
33907>>>>>>>             Case (iError_Num=1002)
33910>>>>>>>                Error 1002 "DDC 053:Branch Site ¡˜«œ™˜å¤œ  ©«¦ Year ¡œ¤æ"
33911>>>>>>>>
33911>>>>>>>             Case Break
33912>>>>>>>             Case (iError_Num=1003)
33915>>>>>>>                Error 1003 "DDC 053:Company Code=0"
33916>>>>>>>>
33916>>>>>>>             Case Break
33917>>>>>>>             Case (iError_Num=1004)
33920>>>>>>>                Error 1004 "DDC 053:Branch Code=0"
33921>>>>>>>>
33921>>>>>>>             Case Break
33922>>>>>>>             Case Else
33922>>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
33924>>>>>>>        Case End
33924>>>>>>>    End_Procedure   // Operation_Not_Allowed
33925>>>>>>>
33925>>>>>>>
33925>>>>>>>    // Update:
33925>>>>>>>    // Use this message to effect changes in related-to files. The
33925>>>>>>>    // Backout message should be designed to reverse the effects of this
33925>>>>>>>    // message. It is invoked while the database is locked.
33925>>>>>>>
33925>>>>>>>    Procedure Update
33926>>>>>>>        Forward Send Update
33928>>>>>>>        // Insert Code Here
33928>>>>>>>        Move Company.Company_Code   to Year.Company_Code
33929>>>>>>>        Move Branch.Branch_Code     to Year.Branch_Code
33930>>>>>>>        move branch.beto_site       to year.beto_site
33931>>>>>>>
33931>>>>>>>        //sos:parametrika apo sysfile?
33931>>>>>>>       
33931>>>>>>>       // If ((Year.Year_EntryDate-14) < Year.Year_XrhshFrom) Begin
33931>>>>>>>       //     Move Year.Year_XrhshFrom to Year.Year_OpenFrom
33931>>>>>>>       // End
33931>>>>>>>       // Else Begin
33931>>>>>>>       //     Move (Year.Year_EntryDate-14) to Year.Year_OpenFrom
33931>>>>>>>       // End
33931>>>>>>>      //  Move Year.Year_EntryDate      to Year.Year_OpenTo
33931>>>>>>>    End_Procedure   // Update
33932>>>>>>>
33932>>>>>>>    // Validate_Save:
33932>>>>>>>
33932>>>>>>>    Function Validate_Save  Returns Integer
33933>>>>>>>        Local Integer iReturnVal
33934>>>>>>>        Forward Get Validate_Save  To iReturnVal
33936>>>>>>>        If (Not(iReturnVal)) Begin
33938>>>>>>>                 If (Year.Year_Year   = 0) Send Operation_Not_Allowed 1001
33941>>>>>>>            Else If (Year.Company_Code='') Send Operation_Not_Allowed 1003
33945>>>>>>>            Else If (Year.Branch_Code ='') Send Operation_Not_Allowed 1004
33949>>>>>>>        End
33949>>>>>>>>
33949>>>>>>>        Function_Return iReturnVal
33950>>>>>>>    End_Function   // Validate_Save
33951>>>>>>>
33951>>>>>>>
33951>>>>>>>    // Define_Fields:
33951>>>>>>>    // This procedure is used to set up all data-dictionary rules.
33951>>>>>>>
33951>>>>>>>    Procedure Define_Fields
33952>>>>>>>        Forward Send Define_Fields
33954>>>>>>>        //DDB-Generated-Code-Location
33954>>>>>>>        //DDB-DefineFieldStart
33954>>>>>>>
33954>>>>>>>        Set Main_File            To Year.File_Number
33955>>>>>>>        Set Cascade_Delete_State To FALSE
33956>>>>>>>
33956>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
33957>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
33958>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
33959>>>>>>>
33959>>>>>>>        // Parent (Server) file structure...............
33959>>>>>>>        Send Add_Server_File  Branch.File_Number
33960>>>>>>>
33960>>>>>>>        // External (System) file structure.............
33960>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
33961>>>>>>>
33961>>>>>>>        // Field-based properties.......................
33961>>>>>>>
33961>>>>>>>        // Year.Company_Code
33961>>>>>>>
33961>>>>>>>        // Year.Branch_Code
33961>>>>>>>
33961>>>>>>>        // Year.Year_Year
33961>>>>>>>        Set Field_Options          Field Year.Year_Year To DD_AUTOFIND    DD_REQUIRED   
33962>>>>>>>        Set Field_Prompt_Object    Field Year.Year_Year To (SL003(Self))
33963>>>>>>>        Set Key_Field_State        Field Year.Year_Year To TRUE
33964>>>>>>>
33964>>>>>>>        // Year.Year_Recr
33964>>>>>>>        Set Field_Prompt_Object    Field Year.Year_Recr To (SL003(Self))
33965>>>>>>>
33965>>>>>>>        // Year.Branch_Recr
33965>>>>>>>
33965>>>>>>>        // Year.Year_Descr
33965>>>>>>>
33965>>>>>>>        // Year.Year_Isolfrom
33965>>>>>>>
33965>>>>>>>        // Year.Year_Isolto
33965>>>>>>>
33965>>>>>>>        // Year.Year_Openfrom
33965>>>>>>>
33965>>>>>>>        // Year.Year_Opento
33965>>>>>>>
33965>>>>>>>        // Year.Year_Entrydate
33965>>>>>>>
33965>>>>>>>        // Year.Year_Dateaa
33965>>>>>>>
33965>>>>>>>        // Year.Year_Xrhshfrom
33965>>>>>>>
33965>>>>>>>        // Year.Year_Xrhshto
33965>>>>>>>
33965>>>>>>>        // Year.Year_Myflimit
33965>>>>>>>
33965>>>>>>>        // Year.Year_Numgtypkin
33965>>>>>>>
33965>>>>>>>        // Year.Year_Numgarticl
33965>>>>>>>
33965>>>>>>>        // Year.Year_Numgmove
33965>>>>>>>
33965>>>>>>>        // Year.Year_Numgplan
33965>>>>>>>
33965>>>>>>>        // Year.Year_Numgformat
33965>>>>>>>
33965>>>>>>>        // Year.Year_Numgthaa
33965>>>>>>>
33965>>>>>>>        // Year.Year_Numgopen
33965>>>>>>>
33965>>>>>>>        // Year.Year_Numbtypkin
33965>>>>>>>
33965>>>>>>>        // Year.Year_Numbaxio
33965>>>>>>>
33965>>>>>>>        // Year.Year_Numbarticl
33965>>>>>>>
33965>>>>>>>        // Year.Year_Numbmove
33965>>>>>>>
33965>>>>>>>        // Year.Year_Delimiter
33965>>>>>>>
33965>>>>>>>        // Year.Year_Printer
33965>>>>>>>
33965>>>>>>>        // Year.Year_Valid_Char
33965>>>>>>>
33965>>>>>>>        // Year.Year_C_Code0
33965>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0 To "dbComboFormSub"
33966>>>>>>>        Set Field_Value_Table      Field Year.Year_C_Code0 To (Year_Year_C_Code0_VT1(Self))
33967>>>>>>>
33967>>>>>>>        // Year.Year_C_Code00
33967>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00 To "dbComboFormSub"
33968>>>>>>>        Set Field_Value_Table      Field Year.Year_C_Code00 To (Year_Year_C_Code00_VT1(Self))
33969>>>>>>>
33969>>>>>>>        // Year.Year_C_Coder
33969>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder To "dbComboFormSub"
33970>>>>>>>        Set Field_Value_Table      Field Year.Year_C_Coder To (Year_Year_C_Coder_VT1(Self))
33971>>>>>>>
33971>>>>>>>        // Year.Beto_Site
33971>>>>>>>
33971>>>>>>>        // Year.Clients_Plafon
33971>>>>>>>
33971>>>>>>>        // Year.Payresp_Plafon
33971>>>>>>>
33971>>>>>>>        // Year.Clients_Ofeilh
33971>>>>>>>
33971>>>>>>>        // Year.Payresp_Ofeilh
33971>>>>>>>
33971>>>>>>>        // Year.Working
33971>>>>>>>
33971>>>>>>>        //DDB-DefineFieldEnd
33971>>>>>>>
33971>>>>>>>        Set Main_File            To Year.File_Number
33972>>>>>>>        Set Cascade_Delete_State To FALSE
33973>>>>>>>
33973>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
33974>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
33975>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
33976>>>>>>>
33976>>>>>>>        // Child (Client) file structure................
33976>>>>>>>
33976>>>>>>>        // Parent (Server) file structure...............
33976>>>>>>>        Send Add_Server_File  Branch.File_Number
33977>>>>>>>
33977>>>>>>>        // Field-based properties.......................
33977>>>>>>>
33977>>>>>>>        // Year.Company_Code
33977>>>>>>>
33977>>>>>>>        // Year.Branch_Code
33977>>>>>>>
33977>>>>>>>        // Year.Year_Year
33977>>>>>>>        Set Field_Label_Long       Field Year.Year_Year           To "•¨ã©ž"
33978>>>>>>>        Set Field_Label_Short      Field Year.Year_Year           To "•¨ã©ž"
33979>>>>>>>        Set Field_Options          Field Year.Year_Year           To DD_REQUIRED
33980>>>>>>>        //Set Field_Prompt_Object    Field Year.Year_Year           To (SL053(Self))
33980>>>>>>>
33980>>>>>>>        // Year.Year_Descr
33980>>>>>>>        Set Field_Label_Long       Field Year.Year_Descr          To "œ¨ š¨˜­ã •¨ã©žª"
33981>>>>>>>        Set Field_Label_Short      Field Year.Year_Descr          To "œ¨.•¨ã©žª"
33982>>>>>>>
33982>>>>>>>        // Year.Year_C_Code0
33982>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0        To "dbComboForm"
33983>>>>>>>        Set Field_Label_Long       Field Year.Year_C_Code0        To "‰ç¨ ¦ Œæ£ ©£˜"
33984>>>>>>>        Set Field_Label_Short      Field Year.Year_C_Code0        To "‰¬¨.Œ¦£ ©£˜"
33985>>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code0        To (Year_Year_C_Code0_VT(Self))
33985>>>>>>>
33985>>>>>>>        // Year.Year_C_Code00
33985>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00       To "dbComboForm"
33986>>>>>>>        Set Field_Label_Long       Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
33987>>>>>>>        Set Field_Label_Short      Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
33988>>>>>>>        //Set Field_Options          Field Year.Year_C_Code00       To DD_REQUIRED
33988>>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code00       To (Year_Year_C_Code1_VT(Self))
33988>>>>>>>
33988>>>>>>>        // Year.Year_C_Coder
33988>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder        To "dbComboForm"
33989>>>>>>>        Set Field_Label_Long       Field Year.Year_C_Coder        To "Œæ£ ©£˜ REPORTING"
33990>>>>>>>        Set Field_Label_Short      Field Year.Year_C_Coder        To "Œæ£ ©£˜ REP"
33991>>>>>>>        //Set Field_Options          Field Year.Year_C_Coder        To DD_REQUIRED
33991>>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Coder        To (Year_Year_C_Coder_VT(Self))
33991>>>>>>>
33991>>>>>>>        // Year.Year_Isolfrom
33991>>>>>>>        Set Field_Label_Long       Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
33992>>>>>>>        Set Field_Label_Short      Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
33993>>>>>>>
33993>>>>>>>        // Year.Year_Isolto
33993>>>>>>>        Set Field_Label_Long       Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
33994>>>>>>>        Set Field_Label_Short      Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
33995>>>>>>>
33995>>>>>>>        // Year.Year_Openfrom
33995>>>>>>>        Set Field_Label_Long       Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
33996>>>>>>>        Set Field_Label_Short      Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
33997>>>>>>>
33997>>>>>>>        // Year.Year_Opento
33997>>>>>>>        Set Field_Label_Long       Field Year.Year_Opento         To "„šš¨˜­âª „àª"
33998>>>>>>>        Set Field_Label_Short      Field Year.Year_Opento         To "„šš¨˜­âª „àª"
33999>>>>>>>
33999>>>>>>>        // Year.Year_Entrydate
33999>>>>>>>        Set Field_Label_Long       Field Year.Year_Entrydate      To "†£œ¨¦£ž¤å˜ „¨š˜©å˜ª"
34000>>>>>>>        Set Field_Label_Short      Field Year.Year_Entrydate      To "†£/¤å˜ „¨š˜©å˜ª"
34001>>>>>>>
34001>>>>>>>        // Year.Year_Dateaa
34001>>>>>>>
34001>>>>>>>        // Year.Year_Xrhshfrom
34001>>>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
34002>>>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
34003>>>>>>>
34003>>>>>>>        // Year.Year_Xrhshto
34003>>>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
34004>>>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
34005>>>>>>>
34005>>>>>>>        // Year.Year_Myflimit
34005>>>>>>>        Set Field_Label_Long       Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
34006>>>>>>>        Set Field_Label_Short      Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
34007>>>>>>>
34007>>>>>>>        // Year.Year_Numgtypkin
34007>>>>>>>        Set Field_Options          Field Year.Year_Numgtypkin     To DD_DISPLAYONLY
34008>>>>>>>
34008>>>>>>>        // Year.Year_Numgarticl
34008>>>>>>>        Set Field_Options          Field Year.Year_Numgarticl     To DD_DISPLAYONLY
34009>>>>>>>
34009>>>>>>>        // Year.Year_Numgmove
34009>>>>>>>        Set Field_Options          Field Year.Year_Numgmove       To DD_DISPLAYONLY
34010>>>>>>>
34010>>>>>>>        // Year.Year_Numgplan
34010>>>>>>>        Set Field_Options          Field Year.Year_Numgplan       To DD_DISPLAYONLY
34011>>>>>>>
34011>>>>>>>        // Year.Year_Numgformat
34011>>>>>>>        Set Field_Options          Field Year.Year_Numgformat     To DD_DISPLAYONLY
34012>>>>>>>
34012>>>>>>>        // Year.Year_Numgthaa
34012>>>>>>>        Set Field_Options          Field Year.Year_Numgthaa       To DD_DISPLAYONLY
34013>>>>>>>
34013>>>>>>>        // Year.Year_Numgopen
34013>>>>>>>        Set Field_Options          Field Year.Year_Numgopen       To DD_DISPLAYONLY
34014>>>>>>>
34014>>>>>>>        // Year.Year_Numbtypkin
34014>>>>>>>        Set Field_Options          Field Year.Year_Numbtypkin     To DD_DISPLAYONLY
34015>>>>>>>
34015>>>>>>>        // Year.Year_Numbaxio
34015>>>>>>>        Set Field_Options          Field Year.Year_Numbaxio       To DD_DISPLAYONLY
34016>>>>>>>
34016>>>>>>>        // Year.Year_Numbarticl
34016>>>>>>>        Set Field_Options          Field Year.Year_Numbarticl     To DD_DISPLAYONLY
34017>>>>>>>
34017>>>>>>>        // Year.Year_Numbmove
34017>>>>>>>        Set Field_Options          Field Year.Year_Numbmove       To DD_DISPLAYONLY
34018>>>>>>>
34018>>>>>>>        // Year.Year_Delimiter
34018>>>>>>>        Set Status_Help            Field Year.Year_Delimiter      To "ƒ ˜®à¨ ©« ¡æ š ˜ «¦ Š‘ «žª •¨ã©œàª"
34019>>>>>>>
34019>>>>>>>        // Year.Year_Printer
34019>>>>>>>
34019>>>>>>>        // Year.Year_Valid_Char
34019>>>>>>>
34019>>>>>>>    End_Procedure    // Define_Fields
34020>>>>>>>
34020>>>>>>>    // Field_Defaults:
34020>>>>>>>    // This procedure is used to establish default field values.
34020>>>>>>>
34020>>>>>>>    Procedure Field_Defaults
34021>>>>>>>        Forward Send Field_Defaults
34023>>>>>>>        //DDB-Generated-Code-Location
34023>>>>>>>        //DDB-FieldDefaultStart
34023>>>>>>>        //DDB-FieldDefaultEnd
34023>>>>>>>        Set Field_Changed_Value   Field Year.Year_Delimiter      To "."
34024>>>>>>>        Set Field_Changed_Value   Field Year.Year_Printer        To "LPT1:"
34025>>>>>>>        Set Field_Changed_Value   Field Year.Year_Valid_Char     To "1234567890"
34026>>>>>>>    End_Procedure    // Field_Defaults
34027>>>>>>>
34027>>>>>>>End_Class    // Year_DataDictionary
34028>>>>>>>//DDB-Selection-pkg-Start
34028>>>>>>>
34028>>>>>>>Use Sl003.sl         // SL003
INCLUDING FILE: SL003.SL
34028>>>>>>>>>//AB/ Project SL003:Year
34028>>>>>>>>>//AB/ Object prj is a Lookup_Project
34028>>>>>>>>>//AB/     Set ProjectName to "SL003:Year"
34028>>>>>>>>>//AB/     Set ProjectFileName to "Sl003.sl"
34028>>>>>>>>>
34028>>>>>>>>>// Project Object Structure
34028>>>>>>>>>//   SL003 is a dbModalPanelSub
34028>>>>>>>>>//     Company_DD is a DataDictionary
34028>>>>>>>>>//     Branch_DD is a DataDictionary
34028>>>>>>>>>//     Year_DD is a DataDictionary
34028>>>>>>>>>//     oSelList is a dbListSub
34028>>>>>>>>>//     oOK_bn is a ButtonSub
34028>>>>>>>>>//     oCancel_bn is a ButtonSub
34028>>>>>>>>>//     oSearch_bn is a ButtonSub
34028>>>>>>>>>
34028>>>>>>>>>// Register all objects
34028>>>>>>>>>Register_Object Branch_DD
34028>>>>>>>>>Register_Object Company_DD
34028>>>>>>>>>Register_Object oCancel_bn
34028>>>>>>>>>Register_Object oOK_bn
34028>>>>>>>>>Register_Object oSearch_bn
34028>>>>>>>>>Register_Object oSelList
34028>>>>>>>>>Register_Object SL003
34028>>>>>>>>>Register_Object Year_DD
34028>>>>>>>>>
34028>>>>>>>>>
34028>>>>>>>>>//AB-IgnoreStart
34028>>>>>>>>>
34028>>>>>>>>>Use DFAllEnt.pkg
34028>>>>>>>>>Use dbList.Sub
34028>>>>>>>>>Use Button.Sub
34028>>>>>>>>>
34028>>>>>>>>>
34028>>>>>>>>>Use COMPANY.DD
34028>>>>>>>>>Use BRANCH.DD
34028>>>>>>>>>Use YEAR.DD
34028>>>>>>>>>
34028>>>>>>>>>//AB-IgnoreEnd
34028>>>>>>>>>
34028>>>>>>>>>CD_Popup_Object SL003 is a dbModalPanelSub
34047>>>>>>>>>
34047>>>>>>>>>    //AB-StoreTopStart
34047>>>>>>>>>    Property String psFragmaCompanyCode  ""
34049>>>>>>>>>    Property String psFragmaBranchCode   ""
34051>>>>>>>>>    property integer pifragmaactive public 0
34053>>>>>>>>>    //AB-StoreTopEnd
34053>>>>>>>>>
34053>>>>>>>>>    Set Minimize_Icon to FALSE
34054>>>>>>>>>    Set Label to "•¨ã©œ ª"
34055>>>>>>>>>    Set Size to 149 449
34056>>>>>>>>>    Set Location to 4 7
34057>>>>>>>>>    Set Exit_Application_Local_State to FALSE
34058>>>>>>>>>    Set Modal_State to FALSE
34059>>>>>>>>>
34059>>>>>>>>>    //AB-DDOStart
34059>>>>>>>>>
34059>>>>>>>>>    Object Company_DD is a Company_DataDictionary
34061>>>>>>>>>    End_Object    // Company_DD
34062>>>>>>>>>
34062>>>>>>>>>    Object Branch_DD is a Branch_DataDictionary
34064>>>>>>>>>        Set DDO_Server to (Company_DD(self))
34065>>>>>>>>>    End_Object    // Branch_DD
34066>>>>>>>>>
34066>>>>>>>>>    Object Year_DD is a Year_DataDictionary
34068>>>>>>>>>        Set DDO_Server to (Branch_DD(self))
34069>>>>>>>>>
34069>>>>>>>>>        //AB-StoreStart
34069>>>>>>>>>        Procedure OnConstrain
34071>>>>>>>>>             String lsCompanyCode lsBranchCode
34072>>>>>>>>>             integer iactive
34072>>>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
34073>>>>>>>>>             get pifragmaactive to iactive
34074>>>>>>>>>             If (lsCompanyCode <> "") Begin
34076>>>>>>>>>                Get psFragmaBranchCode  to lsBranchCode
34077>>>>>>>>>                Constrain Year.Company_Code eq lsCompanyCode
34079>>>>>>>>>                If (lsBranchCode <> "") Constrain Year.Branch_code eq lsBranchCode
34083>>>>>>>>>             End
34083>>>>>>>>>>
34083>>>>>>>>>             if (iactive = 0) constrain year.working ne 1
34087>>>>>>>>>        End_Procedure // OnConstrain
34088>>>>>>>>>        
34088>>>>>>>>>        
34088>>>>>>>>>        
34088>>>>>>>>>        
34088>>>>>>>>>        
34088>>>>>>>>>        //AB-StoreEnd
34088>>>>>>>>>
34088>>>>>>>>>    End_Object    // Year_DD
34089>>>>>>>>>
34089>>>>>>>>>    Set Main_DD to (Year_DD(self))
34090>>>>>>>>>    Set Server to (Year_DD(self))
34091>>>>>>>>>
34091>>>>>>>>>    //AB-DDOEnd
34091>>>>>>>>>
34091>>>>>>>>>    Object oSelList is a dbListSub
34093>>>>>>>>>        Set Main_File to Year.File_Number
34094>>>>>>>>>        Set Size to 105 433
34095>>>>>>>>>        Set Location to 6 6
34096>>>>>>>>>
34096>>>>>>>>>        Begin_Row
34099>>>>>>>>>            Entry_Item Year.Year_year
34100>>>>>>>>>            Entry_Item Company.Company_code
34101>>>>>>>>>            Entry_Item Company.Company_name
34102>>>>>>>>>            Entry_Item Branch.Branch_code
34103>>>>>>>>>            Entry_Item Branch.Branch_name
34104>>>>>>>>>        End_Row
34109>>>>>>>>>
34109>>>>>>>>>        Set Form_Width    item 0 to 36
34110>>>>>>>>>        Set Header_Label  item 0 to "•¨ã©ž :          "
34111>>>>>>>>>        
34111>>>>>>>>>        Set Form_Width    item 1 to 71
34112>>>>>>>>>        Set Header_Label  item 1 to "‰à› ¡æª „«˜ ¨å˜ª"
34113>>>>>>>>>        
34113>>>>>>>>>        Set Form_Width    item 2 to 136
34114>>>>>>>>>        Set Header_Label  item 2 to "Ž¤¦£˜ „«˜ ¨å˜ª"
34115>>>>>>>>>        
34115>>>>>>>>>        Set Form_Width    item 3 to 73
34116>>>>>>>>>        Set Header_Label  item 3 to "‰à› ¡æª “§¦¡/«¦ª"
34117>>>>>>>>>        
34117>>>>>>>>>        Set Form_Width    item 4 to 109
34118>>>>>>>>>        Set Header_Label  item 4 to "Ž¤¦£˜ “§¦¡/«¦ª"
34119>>>>>>>>>        
34119>>>>>>>>>
34119>>>>>>>>>        //AB-StoreStart
34119>>>>>>>>>                                                
34119>>>>>>>>>        Property String psStoreFragmaCompanyCode  ""
34121>>>>>>>>>        Property String psStoreFragmaBranchCode   ""
34123>>>>>>>>>        
34123>>>>>>>>>        Procedure Store_Defaults
34125>>>>>>>>>            forward send Store_Defaults
34127>>>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
34128>>>>>>>>>            Set psStoreFragmaBranchCode  to (psFragmaBranchCode(Self))
34129>>>>>>>>>        end_Procedure // Store_Defaults
34130>>>>>>>>>        
34130>>>>>>>>>        Procedure Restore_Defaults
34132>>>>>>>>>            forward send Restore_Defaults
34134>>>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
34135>>>>>>>>>            Set psFragmaBranchCode  to (psStoreFragmaBranchCode(self))
34136>>>>>>>>>        end_Procedure // Restore_Defaults
34137>>>>>>>>>        
34137>>>>>>>>>        Procedure Activating
34139>>>>>>>>>            Forward Send Activating
34141>>>>>>>>>            Send Rebuild_Constraints to (Year_DD(self))
34142>>>>>>>>>        End_Procedure // Activating
34143>>>>>>>>>        
34143>>>>>>>>>        
34143>>>>>>>>>        
34143>>>>>>>>>        //AB-StoreEnd
34143>>>>>>>>>
34143>>>>>>>>>    End_Object    // oSelList
34144>>>>>>>>>
34144>>>>>>>>>    Object oOK_bn is a ButtonSub
34146>>>>>>>>>        Set Label to "&„§ ¢¦šã"
34147>>>>>>>>>        Set Location to 112 280
34148>>>>>>>>>
34148>>>>>>>>>        //AB-StoreStart
34148>>>>>>>>>        Procedure OnClick
34150>>>>>>>>>            Send OK To (oSelList(current_object))
34151>>>>>>>>>        End_Procedure
34152>>>>>>>>>        //AB-StoreEnd
34152>>>>>>>>>
34152>>>>>>>>>    End_Object    // oOK_bn
34153>>>>>>>>>
34153>>>>>>>>>    Object oCancel_bn is a ButtonSub
34155>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
34156>>>>>>>>>        Set Location to 112 335
34157>>>>>>>>>
34157>>>>>>>>>        //AB-StoreStart
34157>>>>>>>>>        Procedure OnClick
34159>>>>>>>>>            Send Cancel To (oSelList(current_object))
34160>>>>>>>>>        End_Procedure
34161>>>>>>>>>        //AB-StoreEnd
34161>>>>>>>>>
34161>>>>>>>>>    End_Object    // oCancel_bn
34162>>>>>>>>>
34162>>>>>>>>>    Object oSearch_bn is a ButtonSub
34164>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
34165>>>>>>>>>        Set Location to 112 390
34166>>>>>>>>>
34166>>>>>>>>>        //AB-StoreStart
34166>>>>>>>>>        Procedure OnClick
34168>>>>>>>>>            Send Search To (oSelList(current_object))
34169>>>>>>>>>        End_Procedure
34170>>>>>>>>>        //AB-StoreEnd
34170>>>>>>>>>
34170>>>>>>>>>    End_Object    // oSearch_bn
34171>>>>>>>>>
34171>>>>>>>>>
34171>>>>>>>>>    //AB-StoreStart
34171>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
34172>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
34173>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
34174>>>>>>>>>    
34174>>>>>>>>>    
34174>>>>>>>>>    
34174>>>>>>>>>    //AB-StoreEnd
34174>>>>>>>>>
34174>>>>>>>>>CD_End_Object    // SL003
34176>>>>>>>>>>
34176>>>>>>>>>
34176>>>>>>>>>//AB/ End_Object    // prj
34176>>>>>>>
34176>>>>>>>//DDB-Selection-pkg-End
34176>>>>>>>//DDB-FileEnd
34176>>>>>
34176>>>>>    //AB-IgnoreEnd
34176>>>>>
34176>>>>>    Object oSelectYear is a dbModalPanelSub
34178>>>>>
34178>>>>>        //AB-StoreTopStart
34178>>>>>
34178>>>>>        Property String  psSelectedYearRecr  ''
34180>>>>>        Property Integer piChangeState False
34182>>>>>
34182>>>>>        //AB-StoreTopEnd
34182>>>>>
34182>>>>>        Set Minimize_Icon to FALSE
34183>>>>>        Set Label to "„§ ¢¦šã „«˜ ¨œå˜ª - “§¦¡˜«˜©«ã£˜«¦ª - •¨ã©žª"
34184>>>>>        Set Size to 111 372
34185>>>>>        Set Location to 60 40
34186>>>>>        Set Color to 12232306
34187>>>>>        Set Popup_State to TRUE
34188>>>>>
34188>>>>>        //AB-DDOStart
34188>>>>>
34188>>>>>        Object Company_DD is a Company_DataDictionary
34190>>>>>
34190>>>>>            //AB-StoreStart
34190>>>>>            Set Foreign_Field_Options DD_KEYFIELD                   to DD_Clear_Field_Options DD_FindReq
34191>>>>>            Set Foreign_Field_Options DD_INDEXFIELD                 to DD_Clear_Field_Options DD_FindReq
34192>>>>>            Set Foreign_Field_Options Field Company.Company_Name    to DD_DisplayOnly
34193>>>>>
34193>>>>>
34193>>>>>
34193>>>>>            //AB-StoreEnd
34193>>>>>
34193>>>>>        End_Object    // Company_DD
34194>>>>>
34194>>>>>        Object Branch_DD is a Branch_DataDictionary
34196>>>>>            Set DDO_Server to (Company_DD(self))
34197>>>>>
34197>>>>>            //AB-StoreStart
34197>>>>>            Set Foreign_Field_Options DD_KEYFIELD   to DD_Clear_Field_Options DD_FindReq
34198>>>>>            Set Foreign_Field_Options DD_INDEXFIELD to DD_Clear_Field_Options DD_FindReq
34199>>>>>
34199>>>>>            Set Foreign_Field_Options DD_KEYFIELD   to DD_AutoFind_GE
34200>>>>>            Set Foreign_Field_Options DD_INDEXFIELD to DD_AutoFind_GE
34201>>>>>
34201>>>>>            Set Foreign_Field_Options Field Branch.Branch_Name to DD_DisplayOnly
34202>>>>>            //AB-StoreEnd
34202>>>>>
34202>>>>>        End_Object    // Branch_DD
34203>>>>>
34203>>>>>        Object Year_DD is a Year_DataDictionary
34205>>>>>            Set DDO_Server to (Branch_DD(self))
34206>>>>>
34206>>>>>            //AB-StoreStart
34206>>>>>
34206>>>>>            Set Field_Options Field Year.Year_Descr to DD_DisplayOnly
34207>>>>>            Set Field_Options Field Year.Year_Year to DD_AutoFind_GE
34208>>>>>
34208>>>>>            Function Validate_Delete Returns Integer
34210>>>>>                Function_Return 1
34211>>>>>            End_Function
34212>>>>>
34212>>>>>            //AB-StoreEnd
34212>>>>>
34212>>>>>        End_Object    // Year_DD
34213>>>>>
34213>>>>>        Set Main_DD to (Year_DD(self))
34214>>>>>        Set Server to (Year_DD(self))
34215>>>>>
34215>>>>>        //AB-DDOEnd
34215>>>>>
34215>>>>>        Object Company_Company_Code is a dbFormSub
34217>>>>>            Entry_Item Company.Company_code
34218>>>>>            Set Size to 13 71
34219>>>>>            Set Location to 9 112
34220>>>>>            Set Label_Col_Offset to 2
34221>>>>>            Set Label_Justification_Mode to jMode_Right
34222>>>>>            Set Prompt_Button_Mode to pb_PromptOn
34223>>>>>            Set Auto_Clear_Deo_State to FALSE
34224>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34225>>>>>
34225>>>>>            //AB-StoreStart
34225>>>>>
34225>>>>>            Set Prompt_Object to (sl001(Self))
34226>>>>>
34226>>>>>
34226>>>>>            //AB-StoreEnd
34226>>>>>
34226>>>>>        End_Object    // Company_Company_Code
34227>>>>>
34227>>>>>        Object Company_Company_Name is a dbFormSub
34229>>>>>            Entry_Item Company.Company_name
34230>>>>>            Set Size to 13 168
34231>>>>>            Set Location to 9 188
34232>>>>>            Set Label_Col_Offset to 2
34233>>>>>            Set Label_Justification_Mode to jMode_Right
34234>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34235>>>>>
34235>>>>>            //AB-StoreStart
34235>>>>>
34235>>>>>            //AB-StoreEnd
34235>>>>>
34235>>>>>        End_Object    // Company_Company_Name
34236>>>>>
34236>>>>>        Object Branch_Branch_Code is a dbFormSub
34238>>>>>            Entry_Item Branch.Branch_code
34239>>>>>            Set Size to 13 71
34240>>>>>            Set Location to 23 112
34241>>>>>            Set Label_Col_Offset to 2
34242>>>>>            Set Label_Justification_Mode to jMode_Right
34243>>>>>            Set Prompt_Button_Mode to pb_PromptOn
34244>>>>>            Set Auto_Clear_Deo_State to FALSE
34245>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34246>>>>>
34246>>>>>            //AB-StoreStart
34246>>>>>            Set Prompt_Object to (sl002(Self))
34247>>>>>
34247>>>>>            Procedure Prompt_CallBack Integer hPrompt
34249>>>>>                string lsCompanyCode
34250>>>>>                Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
34251>>>>>                Set psFragmaCompanyCode of hPrompt to lsCompanyCode
34252>>>>>            End_Procedure
34253>>>>>
34253>>>>>
34253>>>>>
34253>>>>>
34253>>>>>            //AB-StoreEnd
34253>>>>>
34253>>>>>        End_Object    // Branch_Branch_Code
34254>>>>>
34254>>>>>        Object Branch_Branch_Name is a dbFormSub
34256>>>>>            Entry_Item Branch.Branch_name
34257>>>>>            Set Size to 13 168
34258>>>>>            Set Location to 23 188
34259>>>>>            Set Label_Justification_Mode to jMode_Right
34260>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34261>>>>>
34261>>>>>            //AB-StoreStart
34261>>>>>
34261>>>>>
34261>>>>>            //AB-StoreEnd
34261>>>>>
34261>>>>>        End_Object    // Branch_Branch_Name
34262>>>>>
34262>>>>>        Object Year_Year_Year is a dbFormSub
34264>>>>>            Entry_Item Year.Year_year
34265>>>>>            Set Size to 13 71
34266>>>>>            Set Location to 37 112
34267>>>>>            Set Label_Col_Offset to 2
34268>>>>>            Set Label_Justification_Mode to jMode_Right
34269>>>>>            Set Prompt_Button_Mode to pb_PromptOn
34270>>>>>            Set Auto_Clear_Deo_State to FALSE
34271>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34272>>>>>
34272>>>>>            //AB-StoreStart
34272>>>>>            Set Prompt_Object to (sl003(Self))
34273>>>>>
34273>>>>>            Procedure Prompt_CallBack Integer hPrompt
34275>>>>>                String lsCompanyCode lsBranchCode
34276>>>>>                integer icheck
34276>>>>>                get checked_state of (chkxr(self)) to icheck
34277>>>>>                Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
34278>>>>>                Get Field_Current_Value of Branch_DD  Field Branch.Branch_Code   to lsBranchCode
34279>>>>>                Set psFragmaCompanyCode of hPrompt to lsCompanyCode
34280>>>>>                Set psFragmaBranchCode  of hPrompt to lsBranchCode
34281>>>>>                set pifragmaactive      of hPrompt to icheck
34282>>>>>            End_Procedure
34283>>>>>
34283>>>>>
34283>>>>>
34283>>>>>
34283>>>>>
34283>>>>>
34283>>>>>            //AB-StoreEnd
34283>>>>>
34283>>>>>        End_Object    // Year_Year_Year
34284>>>>>
34284>>>>>        Object Year_Year_Descr is a dbFormSub
34286>>>>>            Entry_Item Year.Year_descr
34287>>>>>            Set Size to 13 168
34288>>>>>            Set Location to 37 188
34289>>>>>            Set Label_Col_Offset to 2
34290>>>>>            Set Label_Justification_Mode to jMode_Right
34291>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34292>>>>>
34292>>>>>            //AB-StoreStart
34292>>>>>
34292>>>>>            //AB-StoreEnd
34292>>>>>
34292>>>>>        End_Object    // Year_Year_Descr
34293>>>>>
34293>>>>>        Object Year_Year_Entrydate is a dbFormSub
34295>>>>>            Entry_Item Year.Year_entrydate
34296>>>>>            Set Size to 13 71
34297>>>>>            Set Location to 52 112
34298>>>>>            Set Label_Col_Offset to 2
34299>>>>>            Set Label_Justification_Mode to jMode_Right
34300>>>>>            Set Auto_Clear_Deo_State to FALSE
34301>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34302>>>>>        End_Object    // Year_Year_Entrydate
34303>>>>>
34303>>>>>        Object oOk_bn is a ButtonSub
34305>>>>>            Set Label to "€§¦›¦®ã (F2)"
34306>>>>>            Set Size to 17 54
34307>>>>>            Set Location to 74 188
34308>>>>>            Set Form_FontHeight Item 0 to 14
34309>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34310>>>>>
34310>>>>>            //AB-StoreStart
34310>>>>>
34310>>>>>            Procedure OnClick
34312>>>>>                Delegate Send AcceptTheValues
34314>>>>>            End_Procedure
34315>>>>>
34315>>>>>
34315>>>>>
34315>>>>>
34315>>>>>            //AB-StoreEnd
34315>>>>>
34315>>>>>        End_Object    // oOk_bn
34316>>>>>
34316>>>>>        Object oCancel_bn is a ButtonSub
34318>>>>>            Set Label to "„¥¦›¦ª "
34319>>>>>            Set Size to 17 54
34320>>>>>            Set Location to 74 302
34321>>>>>            Set Form_FontHeight Item 0 to 14
34322>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34323>>>>>
34323>>>>>            //AB-StoreStart
34323>>>>>
34323>>>>>            Procedure OnClick
34325>>>>>               Send Exit_Application to oSelectYear
34326>>>>>            End_Procedure
34327>>>>>
34327>>>>>
34327>>>>>
34327>>>>>            //AB-StoreEnd
34327>>>>>
34327>>>>>        End_Object    // oCancel_bn
34328>>>>>
34328>>>>>        Object otxtCompany is a TextBoxSub
34330>>>>>            Set Label to "„«˜ ¨œå˜"
34331>>>>>            Set Auto_Size_State to FALSE
34332>>>>>            Set Color to 12232306
34333>>>>>            Set FontSize to 14 8
34334>>>>>            Set Location to 9 10
34335>>>>>            Set Size to 10 35
34336>>>>>            Set FontWeight to 600
34337>>>>>            Set TypeFace to "MS Sans Serif"
34338>>>>>            Set Enabled_State to TRUE
34339>>>>>        End_Object    // otxtCompany
34340>>>>>
34340>>>>>        Object otxtBranch is a TextBoxSub
34342>>>>>            Set Label to "“§¦¡˜«˜©«ã£˜«˜"
34343>>>>>            Set Auto_Size_State to FALSE
34344>>>>>            Set Color to 12232306
34345>>>>>            Set FontSize to 14 8
34346>>>>>            Set Location to 23 10
34347>>>>>            Set Size to 10 63
34348>>>>>            Set FontWeight to 600
34349>>>>>            Set TypeFace to "MS Sans Serif"
34350>>>>>            Set Enabled_State to TRUE
34351>>>>>        End_Object    // otxtBranch
34352>>>>>
34352>>>>>        Object otxtYear is a TextBoxSub
34354>>>>>            Set Label to "•¨ã©ž :          "
34355>>>>>            Set Auto_Size_State to FALSE
34356>>>>>            Set Color to 12232306
34357>>>>>            Set FontSize to 14 8
34358>>>>>            Set Location to 38 10
34359>>>>>            Set Size to 10 40
34360>>>>>            Set FontWeight to 600
34361>>>>>            Set TypeFace to "MS Sans Serif"
34362>>>>>            Set Enabled_State to TRUE
34363>>>>>        End_Object    // otxtYear
34364>>>>>
34364>>>>>        Object otxtWorkingDay is a TextBoxSub
34366>>>>>            Set Label to "†£/¤å˜ „¨š˜©å˜ª"
34367>>>>>            Set Auto_Size_State to FALSE
34368>>>>>            Set Color to 12232306
34369>>>>>            Set FontSize to 14 8
34370>>>>>            Set Location to 52 10
34371>>>>>            Set Size to 10 63
34372>>>>>            Set FontWeight to 600
34373>>>>>            Set TypeFace to "MS Sans Serif"
34374>>>>>            Set Enabled_State to TRUE
34375>>>>>        End_Object    // otxtWorkingDay
34376>>>>>
34376>>>>>        Object otxtWorkingDay is a TextBoxSub
34378>>>>>            Set Label to "Ž¢œª ¦  ®¨ã©œ ª"
34379>>>>>            Set Auto_Size_State to FALSE
34380>>>>>            Set Color to 12232306
34381>>>>>            Set FontSize to 14 8
34382>>>>>            Set Location to 79 9
34383>>>>>            Set Size to 10 63
34384>>>>>            Set FontWeight to 600
34385>>>>>            Set TypeFace to "MS Sans Serif"
34386>>>>>            Set Enabled_State to TRUE
34387>>>>>        End_Object    // otxtWorkingDay
34388>>>>>
34388>>>>>        Object chkxr is a CheckBoxSub
34390>>>>>            Set Size to 13 22
34391>>>>>            Set Location to 79 113
34392>>>>>            Set Color to 12232306
34393>>>>>        End_Object    // chkxr
34394>>>>>
34394>>>>>
34394>>>>>        //AB-StoreStart
34394>>>>>
34394>>>>>        On_Key Key_Ctrl+Key_X Send None
34395>>>>>        On_Key Key_Alt+Key_X  Send None
34396>>>>>
34396>>>>>        Function ifSelect_Xrhsh Returns String
34398>>>>>            String  lsRecord_id
34399>>>>>            Set psSelectedYearRecr to gs_Selected_Year_Recr
34400>>>>>            send popup_modal
34401>>>>>            Get psSelectedYearRecr to lsRecord_id
34402>>>>>            Function_return lsRecord_Id
34403>>>>>        End_Function
34404>>>>>
34404>>>>>        Procedure AcceptTheValues
34406>>>>>            Integer iRetVal liYearDD liCompanyDD liBranchDD
34407>>>>>            String ldcheck lsYearRecr lsSite sCname sBname sYname sNom1 sNom2 sNom3
34407>>>>>            Date ldYearXrhsh_From ldYearXrhsh_To
34407>>>>>            Move Year_DD to liYearDD
34408>>>>>            Get Field_Current_Value of liYearDD Field Year.Year_EntryDate to ldcheck
34409>>>>>            if (ldcheck = "") ;                Get Message_Box "ƒœ¤ œ§ ¢â¥˜«œ ©à©«ã ž£œ¨¦£ž¤å˜." "¨¦©¦®ã" MB_OK MB_ICONWARNING to iRetVal
34412>>>>>            else begin
34413>>>>>                Get Field_Current_Value of liYearDD Field Year.Year_XrhshFrom   to ldYearXrhsh_From
34414>>>>>                Get Field_Current_Value of liYearDD Field Year.Year_XrhshTo     to ldYearXrhsh_To
34415>>>>>                if ((ldcheck < ldYearXrhsh_From) or (ldcheck > ldYearXrhsh_To)) ;                    Get Message_Box "†£œ¨/¤å˜ œ¡«éª ¦¨åà¤" "¨¦©¦®ã" MB_OK MB_ICONWARNING to iRetVal
34418>>>>>                else begin
34419>>>>>                    Move Company_DD to liCompanyDD
34420>>>>>                    Move Branch_DD  to liBranchDD
34421>>>>>                    Move Year_DD    to liYearDD
34422>>>>>                    send Request_Save to liYearDD
34423>>>>>                    Get Field_Current_Value of liCompanyDD Field Company.Company_Code to gs_Selected_Company_Code
34424>>>>>                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_Code   to gs_Selected_Branch_Code
34425>>>>>
34425>>>>>                    Get Field_Current_Value of liBranchDD  Field Branch.Beto_Site   to gs_Selected_Beto_Site
34426>>>>>
34426>>>>>                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_Site   to lsSite
34427>>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_Year       to gi_Selected_Year
34428>>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_Recr       to lsYearRecr
34429>>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_C_Code0    to sNom1
34430>>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_C_Code00   to sNom2
34431>>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_C_CodeR    to sNom3
34432>>>>>
34432>>>>>                    Get Field_Current_Value of liCompanyDD Field Company.Company_Name to sCname
34433>>>>>                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_name   to sBname
34434>>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_Descr      to sYname
34435>>>>>
34435>>>>>
34435>>>>>                    Local String    sCode
34435>>>>>                    Local Integer   iBreak
34435>>>>>                    Move 0 to iBreak
34436>>>>>                    Clear Nomisma
34437>>>>>                    Find Gt Nomisma.Recnum
34438>>>>>>
34438>>>>>                    While ((Found=1) And (iBreak=0))
34442>>>>>                        If (Nomisma.Einai_Euro='1') Begin
34444>>>>>                            Move 1 to iBreak
34445>>>>>                            Move Nomisma.Nomisma_Code to sCode
34446>>>>>                        End
34446>>>>>>
34446>>>>>                        If (Not(iBreak)) Find Gt Nomisma.Recnum
34449>>>>>                    Loop
34450>>>>>>
34450>>>>>                    Move (Trim(sCode)) to sCode
34451>>>>>
34451>>>>>
34451>>>>>                    Reread SysCurXR
34455>>>>>                    Move gs_Selected_Company_Code   to SysCurXR.Company_Code
34456>>>>>                    Move gs_Selected_beto_site      to SysCurXR.beto_site
34457>>>>>                    Move gs_Selected_Branch_Code    to SysCurXR.Branch_Code
34458>>>>>                    Move gi_Selected_Year           to SysCurXR.Year_Year
34459>>>>>                    Move lsYearRecr                 to SysCurXR.Year_Recr
34460>>>>>                    Move lsSite                     to SysCurXR.Branch_Site
34461>>>>>
34461>>>>>                    Move sCname                     to SysCurXR.Company_Name
34462>>>>>                    Move sBname                     to SysCurXR.Branch_Name
34463>>>>>                    Move sYname                     to SysCurXR.Year_Descr
34464>>>>>
34464>>>>>                    Move ldYearXrhsh_From           to SysCurXr.Year_XrhshFrom
34465>>>>>                    Move ldYearXrhsh_To             to SysCurXr.Year_XrhshTo
34466>>>>>
34466>>>>>                    Move  (Trim(sNom1))             to SysCurXR.C_Code0
34467>>>>>                    Move  (Trim(sNom2))             to SysCurXR.C_Code00
34468>>>>>                    Move  (Trim(sNom3))             to SysCurXR.C_CodeR
34469>>>>>
34469>>>>>                    Move sCode                      to SysCurXR.Euro_Code
34470>>>>>
34470>>>>>                    Saverecord SysCurXR
34471>>>>>                    Unlock
34472>>>>>>
34472>>>>>
34472>>>>>                    Move lsYearRecr                 to gs_Selected_Year_Recr
34473>>>>>                    Set psSelectedYearRecr          to lsYearRecr
34474>>>>>
34474>>>>>                    Send Stop_Modal_ui
34475>>>>>
34475>>>>>                    Set kEnter_Next_State of ghoWorkSpace to TRUE
34476>>>>>                End
34476>>>>>>
34476>>>>>            end
34476>>>>>>
34476>>>>>        End_Procedure
34477>>>>>
34477>>>>>        Set Locate_Mode to Center_On_Screen
34478>>>>>
34478>>>>>        On_Key KCancel      Send KeyAction to (oCancel_Bn(Self))
34479>>>>>        On_Key KClose_Panel Send KeyAction to (oCancel_Bn(Self))
34480>>>>>        On_Key Ksave_record send KeyAction to (oOK_Bn(Self))
34481>>>>>
34481>>>>>        On_Key Key_alt+Key_A send KeyAction to (oOK_Bn(Self))
34482>>>>>        On_Key Key_alt+Key_Q send KeyAction to (oCancel_Bn(Self))
34483>>>>>
34483>>>>>
34483>>>>>
34483>>>>>
34483>>>>>
34483>>>>>
34483>>>>>
34483>>>>>        //AB-StoreEnd
34483>>>>>
34483>>>>>    End_Object    // oSelectYear
34484>>>>>
34484>>>>>
34484>>>>>    //AB-StoreStart
34484>>>>>
34484>>>>>
34484>>>>>    //AB-StoreEnd
34484>>>>>
34484>>>>>//AB/     End_Object    // prj
34484>>>
34484>>>Procedure Epelexe_Xrhsh
34485>>>    Integer liCompanyDD liBranchDD liYearDD liYear liModalId
34486>>>    String lsCompany lsBranch lsWhatXrhsh
34486>>>    Move oSelectYear to liModalId
34487>>>    Get ifSelect_Xrhsh Of liModalId to lsWhatXrhsh
34488>>>    if (Trim(lsWhatXrhsh)='') Send Exit_Application
34491>>>End_Procedure
34492>>>
34492>>>Procedure Allaxe_Xrhsh
34493>>>    Integer rVal liModalId iID
34494>>>    If (Close_All_Views(Self,True)=0) Begin
34496>>>        Move oSelectYear to liModalId
34497>>>        Send Epelexe_Xrhsh
34498>>>    End
34498>>>>
34498>>>End_Procedure
34499>>>
34499>>>On_Key Key_Ctrl+Key_X Send Allaxe_Xrhsh
34500>>>On_Key Key_Alt+Key_X  Send Allaxe_Xrhsh
34501>>>
34501>>>Send Epelexe_Xrhsh
34502>>>//------------------------------
34502>>>
34502>Use Menu_Sec.Sub
INCLUDING FILE: MENU_SEC.SUB
34502>>>
34502>>>Use Idiotht.pkg
INCLUDING FILE: IDIOTHT.PKG
34502>>>>>
34502>>>>>Open Users
34504>>>>>Open UserGrps
INCLUDING FILE: USERGRPS.FD
34506>>>>>Open Pedia
INCLUDING FILE: PEDIA.FD
34508>>>>>Open Arxeia
INCLUDING FILE: ARXEIA.FD
34510>>>>>Open GrpPedia
INCLUDING FILE: GRPPEDIA.FD
34512>>>>>Open GrpPed0
INCLUDING FILE: GRPPED0.FD
34514>>>>>Open GrpArx
INCLUDING FILE: GRPARX.FD
34516>>>>>Open GrpArx0
INCLUDING FILE: GRPARX0.FD
34518>>>>>Open ViewFlds
INCLUDING FILE: VIEWFLDS.FD
34520>>>>>Open Oth
INCLUDING FILE: OTH.FD
34522>>>>>Open GrpOth
INCLUDING FILE: GRPOTH.FD
34524>>>>>Open GrpOth0
INCLUDING FILE: GRPOTH0.FD
34526>>>>>Open Departm
INCLUDING FILE: DEPARTM.FD
34528>>>>>
34528>>>>>
34528>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
34529>>>>>
34529>>>>>Function Network_User_Name Returns String
34530>>>>>    Local String sName sLength
34531>>>>>    Local Pointer lpName_Addr lpLength_Addr
34531>>>>>    Local Integer iRetval
34531>>>>>    Movestr (Repeat (Character (0), 255)) To sName
34532>>>>>>
34532>>>>>    GetAddress Of sName To lpName_Addr
34533>>>>>    Movestr (DwordToBytes (255)) To sLength
34534>>>>>>
34534>>>>>    GetAddress Of sLength To lpLength_Addr
34535>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
34536>>>>>>
34536>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
34539>>>>>    Else Function_Return "User Unknown"
34541>>>>>End_Function // Network_User_Name
34542>>>>>
34542>>>>>Function fsGetOfficePath Global Returns String
34543>>>>>    String sRegistryKeyPath sRegOfficePath
34544>>>>>    Set_Registry_Root                                                   to HKEY_LOCAL_MACHINE "Software"
34545>>>>>    Move "Microsoft\Office\9.0\Word"                                    to sRegistryKeyPath
34546>>>>>    Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path"    to sRegOfficePath
34550>>>>>    Move (Trim(sRegOfficePath))                                         to sRegOfficePath
34551>>>>>    If (sRegOfficePath='') Begin
34553>>>>>        Move "Microsoft\Office\8.0\Word"                                to sRegistryKeyPath
34554>>>>>        Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34558>>>>>        Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34559>>>>>        If (sRegOfficePath='') Begin
34561>>>>>            Move "Microsoft\Office\7.0\Word"                             to sRegistryKeyPath
34562>>>>>            Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34566>>>>>            Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34567>>>>>            If (sRegOfficePath='') Begin
34569>>>>>                Move "Microsoft\Office\10.0\Word"                                to sRegistryKeyPath
34570>>>>>                Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34574>>>>>                Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34575>>>>>            End
34575>>>>>>
34575>>>>>        End
34575>>>>>>
34575>>>>>    End
34575>>>>>>
34575>>>>>    Function_Return sRegOfficePath
34576>>>>>End_Procedure
34577>>>>>
34577>>>>>
34577>>>>>Function fsGetLastDir Global Returns String
34578>>>>>    String sRegistryKeyPath sRegDir sUserName
34579>>>>>    Get Network_User_Name to sUserName
34580>>>>>
34580>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
34583>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
34586>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
34588>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
34590>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
34591>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
34592>>>>>    Get_profile_string sRegistryKeyPath "Path" to sRegDir
34595>>>>>    Function_Return sRegDir
34596>>>>>End_Procedure
34597>>>>>
34597>>>>>Function fiPutLastDir Global String asDirectory Returns Integer
34598>>>>>    String sRegistryKeyPath sRegDir sUserName
34599>>>>>    Get Network_User_Name to sUserName
34600>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
34603>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
34606>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
34608>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
34610>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
34611>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
34612>>>>>    Set_profile_string sRegistryKeyPath "Path" to asDirectory
34615>>>>>    Function_Return 0
34616>>>>>End_Procedure
34617>>>>>
34617>>>>>
34617>>>>>Function fsVresExt Global String asFileName Returns String
34618>>>>>    String rVal
34619>>>>>    Integer iPos iLen
34619>>>>>    Move (UpperCase(asFileName)) to asFileName
34620>>>>>    Move (Trim(asFileName)) to asFileName
34621>>>>>    Move 0 to iPos
34622>>>>>    For iLen from 1 to (length(asFileName))
34628>>>>>>
34628>>>>>        If (Mid(asFileName,1,iLen)='.') Move iLen to iPos
34631>>>>>    Loop
34632>>>>>>
34632>>>>>    If (Not(iPos)) Function_Return ''
34635>>>>>    Move (Right(asFileName,(Length(asFileName)-iPos))) to rVal
34636>>>>>    Move (Trim(rVal)) to rVal
34637>>>>>    Function_Return rVal
34638>>>>>End_Function
34639>>>>>
34639>>>>>
34639>>>>>Function fiScreenFieldStatus Global String asViewName String asDbFormName Returns Integer
34640>>>>>    Integer rVal iUser iGroup
34641>>>>>    String  sUser sRecr
34641>>>>>    Move (Trim(asViewName))     to asViewName
34642>>>>>    Move (Trim(asDbFormName))   to asDbFormName
34643>>>>>
34643>>>>>    If ((asViewName<>'') And (asDbFormName<>'')) Begin
34645>>>>>        Get fsLoginUserID to sUser
34646>>>>>        Clear Users
34647>>>>>        Move sUser        to Users.Login_ID
34648>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
34649>>>>>>
34649>>>>>        If (Found=1) Begin
34651>>>>>            Move Users.User_ID  to iUser
34652>>>>>            Move Users.Grp_ID   to iGroup
34653>>>>>            Clear GrpOth
34654>>>>>            Move iUser          to GrpOth.User_ID
34655>>>>>            Move asViewName     to GrpOth.View_Name
34656>>>>>            Move asDbFormName   to GrpOth.Scr_Field_Name
34657>>>>>            Find eq GrpOth by Index.2 // GrpOth:Index.2:User_ID+View_Name+Scr_Field_Name
34658>>>>>>
34658>>>>>            If (Found=1) Begin
34660>>>>>                // rVal=1 ==> NO READ ALLOWED
34660>>>>>                // rVal=2 ==> NO EDIT BUT CAN COPY
34660>>>>>                // rVal=3 ==> NO EDIT AND NO COPY
34660>>>>>                If (GrpOth.Allow_Read <>'1') Move 1 to rVal
34663>>>>>                Else Begin
34664>>>>>                    If (GrpOth.Allow_Change<>'1') Begin
34666>>>>>                        If (GrpOth.Allow_Copy<>'1') Move 3 to rVal
34669>>>>>                        Else                        Move 2 to rVal
34671>>>>>                    End
34671>>>>>>
34671>>>>>                End
34671>>>>>>
34671>>>>>            End
34671>>>>>>
34671>>>>>            Else Begin
34672>>>>>                Clear GrpOth0
34673>>>>>                Move iGroup         to GrpOth0.Group_ID
34674>>>>>                Move asViewName     to GrpOth0.View_Name
34675>>>>>                Move asDbFormName   to GrpOth0.Scr_Field_Name
34676>>>>>
34676>>>>>                Find eq GrpOth0 by Index.2 // GrpOth0:Index.2:Group_ID+View_Name+Scr_Field_Name
34677>>>>>>
34677>>>>>                If (Found=1) Begin
34679>>>>>                    // rVal=1 ==> NO READ ALLOWED
34679>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
34679>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
34679>>>>>                    If (GrpOth0.Allow_Read <>'1') Move 1 to rVal
34682>>>>>                    Else Begin
34683>>>>>                        If (GrpOth0.Allow_Change<>'1') Begin
34685>>>>>                            If (GrpOth0.Allow_Copy<>'1') Move 3 to rVal
34688>>>>>                            Else                         Move 2 to rVal
34690>>>>>                        End
34690>>>>>>
34690>>>>>                    End
34690>>>>>>
34690>>>>>                End
34690>>>>>>
34690>>>>>                Else Move 0 to rVal
34692>>>>>            End
34692>>>>>>
34692>>>>>        End
34692>>>>>>
34692>>>>>        Else Move 0 to rVal
34694>>>>>    End
34694>>>>>>
34694>>>>>    Function_Return rVal
34695>>>>>End_Function
34696>>>>>
34696>>>>>Function fiFieldStatus Global Integer aiFileNumber Integer aiFieldNumber Returns Integer
34697>>>>>    Integer rVal iUser iGroup
34698>>>>>    String  sUser sRecr
34698>>>>>    If ((aiFileNumber) And (aiFieldNumber)) Begin
34700>>>>>        Get fsLoginUserID to sUser
34701>>>>>        Clear Users
34702>>>>>        Move sUser        to Users.Login_ID
34703>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
34704>>>>>>
34704>>>>>        If (Found=1) Begin
34706>>>>>            Move Users.User_ID  to iUser
34707>>>>>            Move Users.Grp_ID   to iGroup
34708>>>>>            Clear Pedia
34709>>>>>            Move aiFileNumber  to Pedia.Arxeio_ID
34710>>>>>            Move aiFieldNumber to Pedia.Pedio_Number
34711>>>>>            Find eq Pedia By Index.1 // Pedia:Index.1:Arxeio_ID+Pedio_Number
34712>>>>>>
34712>>>>>            If (Found=1) Begin
34714>>>>>                Move (Trim(Pedia.Pedio_Recr))   to sRecr
34715>>>>>                // Find Combination User/File/Field in GRPPEDIA
34715>>>>>                Clear GrpPedia
34716>>>>>                Move iUser                      to GrpPedia.User_ID
34717>>>>>                Move (Trim(sRecr))              to GrpPedia.Pedio_Recr
34718>>>>>                Find eq GrpPedia by Index.4 // GrpPedia:Index.4:Pedio_Recr + User_ID
34719>>>>>>
34719>>>>>                If (Found=1) Begin
34721>>>>>                    // rVal=1 ==> NO READ ALLOWED
34721>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
34721>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
34721>>>>>                    If (GrpPedia.Allow_Read <>'1') Move 1 to rVal
34724>>>>>                    Else Begin
34725>>>>>                        If (GrpPedia.Allow_Change<>'1') Begin
34727>>>>>                            If (GrpPedia.Allow_Copy<>'1')   Move 3 to rVal
34730>>>>>                            Else                            Move 2 to rVal
34732>>>>>                        End
34732>>>>>>
34732>>>>>                    End
34732>>>>>>
34732>>>>>                End
34732>>>>>>
34732>>>>>                Else Begin
34733>>>>>                    // Find Combination UserGrps/File/Field in GRPPED0
34733>>>>>                    Clear GrpPed0
34734>>>>>                    Move iGroup         to GrpPed0.Group_ID
34735>>>>>                    Move (Trim(sRecr))  to GrpPed0.Pedio_Recr
34736>>>>>                    Find eq GrpPed0 by Index.4 // GrpPed0:Index.4:Pedio_Recr + Group_ID
34737>>>>>>
34737>>>>>                    If (Found=1) Begin
34739>>>>>                        // rVal=1 ==> NO READ ALLOWED
34739>>>>>                        // rVal=2 ==> NO EDIT BUT CAN COPY
34739>>>>>                        // rVal=3 ==> NO EDIT AND NO COPY
34739>>>>>                        If (GrpPed0.Allow_Read <>'1') Move 1 to rVal
34742>>>>>                        Else Begin
34743>>>>>                            If (GrpPed0.Allow_Change<>'1') Begin
34745>>>>>                                If (GrpPed0.Allow_Copy<>'1')   Move 3 to rVal
34748>>>>>                                Else                           Move 2 to rVal
34750>>>>>                            End
34750>>>>>>
34750>>>>>                        End
34750>>>>>>
34750>>>>>                    End
34750>>>>>>
34750>>>>>                End
34750>>>>>>
34750>>>>>            End
34750>>>>>>
34750>>>>>            Else Begin
34751>>>>>                Move 0 to rVal
34752>>>>>            End
34752>>>>>>
34752>>>>>        End
34752>>>>>>
34752>>>>>        Else Begin
34753>>>>>            Move 0 to rVal
34754>>>>>        End
34754>>>>>>
34754>>>>>    End
34754>>>>>>
34754>>>>>    Function_Return rVal
34755>>>>>End_Function
34756>>>>>
34756>>>>>Function fsReturnFileFromPath Global String asFullPath Returns String
34757>>>>>    String rVal lsDirSep
34758>>>>>    Integer iPos iMet iLen iCnt
34758>>>>>    Move (Trim(asFullPath))                 To rVal
34759>>>>>    Move (Sysconf(SYSCONF_DIR_SEPARATOR))   To lsDirSep
34760>>>>>    If (rVal Contains lsDirSep) Begin
34762>>>>>        Move (Length(rVal)) to iLen
34763>>>>>        Move iLen to iCnt
34764>>>>>        While iCnt Gt 0
34768>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Begin
34770>>>>>                If (iCnt=iLen) Function_Return asFullPath
34773>>>>>                Else Function_Return (Right(rVal,(iLen-iCnt)))
34775>>>>>            End
34775>>>>>>
34775>>>>>            Decrement iCnt
34776>>>>>        End // While iCnt Gt 0
34777>>>>>>
34777>>>>>    End
34777>>>>>>
34777>>>>>    Else  Function_Return (Trim(asFullPath))
34779>>>>>    Function_Return rVal
34780>>>>>End_Function
34781>>>>>
34781>>>>>Function fsReturnDirectoriesFromPath Global String asFullPath Returns String
34782>>>>>    String rVal lsDirSep
34783>>>>>    Integer iPos iMet iLen iCnt
34783>>>>>    Move (Trim(asFullPath))                 To rVal
34784>>>>>    Move (Sysconf(SYSCOnF_DIR_SEPARATOR))   To lsDirSep
34785>>>>>    If (rVal Contains lsDirSep) Begin
34787>>>>>        Move (Length(rVal)) to iLen
34788>>>>>        Move iLen to iCnt
34789>>>>>        While iCnt Gt 0
34793>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Function_Return (Left(rVal,iCnt))
34796>>>>>            Decrement iCnt
34797>>>>>        End // While iCnt Gt 0
34798>>>>>>
34798>>>>>    End
34798>>>>>>
34798>>>>>    Function_Return rVal
34799>>>>>End_Function
34800>>>>>
34800>>>>>//Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
34800>>>>>//    Local String rVal lsTmp lsOO lsLL
34800>>>>>//    Local Number lnOO lnLL
34800>>>>>
34800>>>>>//    Move '' to lsOO
34800>>>>>//    Move '' to lsLL
34800>>>>>//    Move '' to rVal
34800>>>>>
34800>>>>>//    Move (Integer(anTime))                              to lnOO
34800>>>>>//    ////////////////////////////////////////////
34800>>>>>//    // sos sos sos jsjsjsjsjs yannis 30/03/2000
34800>>>>>//    //If ((lnOO=24) and (lnll=0)) Move 0 to lnOO
34800>>>>>//    ////////////////////////////////////////////
34800>>>>>
34800>>>>>//    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
34800>>>>>
34800>>>>>//    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
34800>>>>>//    Else         Move (String(lnOO))                    to lsOO
34800>>>>>//    Move (Trim(lsOO))                                   to lsOO
34800>>>>>
34800>>>>>//    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
34800>>>>>//    Else         Move (String(lnLL))                    to lsLL
34800>>>>>//    Move (Trim(lsLL))                                   to lsLL
34800>>>>>
34800>>>>>//    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
34800>>>>>
34800>>>>>//    Move (Trim(rVal)) to rVal
34800>>>>>
34800>>>>>//    Function_Return rVal
34800>>>>>//End_Function
34800>>>>>
34800>>>>>//Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
34800>>>>>//    Local Number rVal nOres nLepta
34800>>>>>//    Move (Integer(aiMinutes/60))    to nOres
34800>>>>>//    Move (    Mod(aiMinutes,60))    to nLepta
34800>>>>>//    Move (nOres+(nLepta/100))       to rVal
34800>>>>>//    Function_Return rVal
34800>>>>>//End_Function
34800>>>>>
34800>>>>>//Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
34800>>>>>//    Local Integer rVal
34800>>>>>//    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
34800>>>>>//    Function_Return rVal
34800>>>>>//End_Function
34800>>>>>
34800>>>>>//Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;
34800>>>>>//                                                                    Number anEndTime    ;
34800>>>>>//                                                                    Returns Integer
34800>>>>>//    Local Integer rVal iMinStart iMinEnd
34800>>>>>
34800>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
34800>>>>>
34800>>>>>//    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
34800>>>>>//    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
34800>>>>>//    Move (iMinEnd-iMinStart)                                                     to rVal
34800>>>>>//    Function_Return rVal
34800>>>>>//End_Function
34800>>>>>
34800>>>>>
34800>>>>>//Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;
34800>>>>>//                                                                Number anEndTime    ;
34800>>>>>//                                                                Returns Number
34800>>>>>//    Local Integer iTmp
34800>>>>>//    Local Number  rVal
34800>>>>>
34800>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
34800>>>>>
34800>>>>>//    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
34800>>>>>//    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
34800>>>>>//    Function_Return rVal
34800>>>>>//End_Function
34800>>>>>
34800>>>>>
34800>>>>>Function fsLoginUserID Global Returns String
34801>>>>>    Local String LastLogin# LoginUserid#
34802>>>>>    get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin#
34805>>>>>    If LastLogin# eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin#
34808>>>>>    insert "WorkSpaces\" in LastLogin# at 1
34810>>>>>    Append LastLogin# "\" (Module_Name(Self)) "\LastLogin"
34813>>>>>    get_profile_string LastLogin# "LoginUserId"  to LoginUserId#
34816>>>>>    Trim LoginUserID# to LoginUserID#
34817>>>>>>
34817>>>>>    If LoginUserId# eq "" Move (Network_User_Name(Current_Object)) to LoginUserId#
34820>>>>>    Function_Return LoginUserID#
34821>>>>>End_Function
34822>>>>>
34822>>>>>Function fiWriteRegistryLastSDFPath Global String asLastPath Returns Integer
34823>>>>>    Integer rVal
34824>>>>>    String  lsCurrentWksp
34824>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34827>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34830>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34832>>>>>    // Œœ¦ ¡¢œ ›   - Last_SDF_Path -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
34832>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
34832>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
34835>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
34838>>>>>    Function_Return rVal
34839>>>>>End_Function
34840>>>>>
34840>>>>>
34840>>>>>Function fsReadRegistryLastSDFPath Global Returns String
34841>>>>>    String rVal lsCurrentWksp
34842>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34845>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34848>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34850>>>>>    // Œœ¦ ¡¢œ ›   - LastParastUsed -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
34850>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
34850>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
34853>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
34856>>>>>    Function_Return (Trim(rVal))
34857>>>>>End_Function
34858>>>>>
34858>>>>>
34858>>>>>Function fiWriteRegistryLastMCryptPath Global String asLastPath Returns Integer
34859>>>>>    Integer rVal
34860>>>>>    String  lsCurrentWksp
34860>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34863>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34866>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34868>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
34871>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
34874>>>>>    Function_Return rVal
34875>>>>>End_Function
34876>>>>>
34876>>>>>
34876>>>>>Function fsReadRegistryLastMCryptPath Global Returns String
34877>>>>>    String rVal lsCurrentWksp
34878>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34881>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34884>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34886>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
34889>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
34892>>>>>    Function_Return (Trim(rVal))
34893>>>>>End_Function
34894>>>>>
34894>>>>>
34894>>>>>Function fiWriteRegistryLastWEBPath Global String asLastPath Returns Integer
34895>>>>>    Integer rVal
34896>>>>>    String  lsCurrentWksp
34896>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34899>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34902>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34904>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
34907>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
34910>>>>>    Function_Return rVal
34911>>>>>End_Function
34912>>>>>
34912>>>>>
34912>>>>>Function fsReadRegistryLastWEBPath Global Returns String
34913>>>>>    String rVal lsCurrentWksp
34914>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34917>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34920>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34922>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
34925>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
34928>>>>>    Function_Return (Trim(rVal))
34929>>>>>End_Function
34930>>>>>
34930>>>>>
34930>>>>>
34930>>>>>Function fig_Is_Admin Global Returns Integer
34931>>>>>    String sUser
34932>>>>>    Integer rVal
34932>>>>>    Get fsLoginUserID to sUser
34933>>>>>    Move (trim(sUser)) to sUser
34934>>>>>    Clear Users
34935>>>>>    Move sUser to Users.Login_ID
34936>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
34937>>>>>>
34937>>>>>    Move Users.Admin_Rights to rVal
34938>>>>>    Function_Return rVal
34939>>>>>End_Function
34940>>>>>
34940>>>>>Function fig_The_User_Group Global Returns Integer
34941>>>>>    String sUser
34942>>>>>    Get fsLoginUserID   to sUser
34943>>>>>    Move (trim(sUser))  to sUser
34944>>>>>    Clear Users
34945>>>>>    Move sUser          to Users.Login_ID
34946>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
34947>>>>>>
34947>>>>>    Clear UserGrps
34948>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
34949>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
34950>>>>>>
34950>>>>>    Function_Return UserGrps.Grp_ID
34951>>>>>End_Function
34952>>>>>
34952>>>>>Function fsg_The_User_Department Global Returns String
34953>>>>>    String sUser
34954>>>>>    Get fsLoginUserID   to sUser
34955>>>>>    Move (trim(sUser))  to sUser
34956>>>>>    Clear Users
34957>>>>>    Move sUser          to Users.Login_ID
34958>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
34959>>>>>>
34959>>>>>    Clear Departm
34960>>>>>    Move Users.Departm_Code   to Departm.Code
34961>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
34962>>>>>>
34962>>>>>    Function_Return Departm.Code
34963>>>>>End_Function
34964>>>>>
34964>>>>>
34964>>>>>Function fig_Is_Specific_Admin Global String asUser Returns Integer
34965>>>>>    Integer rVal
34966>>>>>    Move (trim(asUser)) to asUser
34967>>>>>    Clear Users
34968>>>>>    Move asUser to Users.Login_ID
34969>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
34970>>>>>>
34970>>>>>    Move Users.Admin_Rights to rVal
34971>>>>>    Function_Return rVal
34972>>>>>End_Function
34973>>>>>
34973>>>>>Function fig_The_Specific_User_Group Global String asUser Returns Integer
34974>>>>>    Move (trim(asUser))  to asUser
34975>>>>>    Clear Users
34976>>>>>    Move asUser          to Users.Login_ID
34977>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
34978>>>>>>
34978>>>>>    Clear UserGrps
34979>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
34980>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
34981>>>>>>
34981>>>>>    Function_Return UserGrps.Grp_ID
34982>>>>>End_Function
34983>>>>>
34983>>>>>Function fsg_The_Specific_User_Department Global String asUser Returns String
34984>>>>>    Move (trim(asUser))  to asUser
34985>>>>>    Clear Users
34986>>>>>    Move asUser          to Users.Login_ID
34987>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
34988>>>>>>
34988>>>>>    Clear Departm
34989>>>>>    Move Users.Departm_Code   to Departm.Code
34990>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
34991>>>>>>
34991>>>>>    Function_Return Departm.Code
34992>>>>>End_Function
34993>>>>>
34993>>>>>
34993>>>
34993>>>Class ViewPopupMenu_Sec Is A ViewPopupMenu
34994>>>
34994>>>    Open Sysfile
INCLUDING FILE: SYSFILE.FD
34996>>>    Open Users
34998>>>    Open Views
INCLUDING FILE: VIEWS.FD
35000>>>    Open GrpViews
INCLUDING FILE: GRPVIEWS.FD
35002>>>    Open GrpView0
INCLUDING FILE: GRPVIEW0.FD
35004>>>    Open Arxeia
35006>>>    Open GrpArx
35008>>>
35008>>>    Function Find_User_Rights_In_Class String asView Returns Integer
35009>>>        String  lsView lsLogin
35010>>>        Integer liUser  liViews iGroup
35010>>>
35010>>>        Move (fsLoginUserID())      to lsLogin
35011>>>        Move (Trim(ToOEM(asView)))  to lsView
35012>>>
35012>>>        //////  /////////////////////////////////////
35012>>>        Clear Users
35013>>>        Move lsLogin    to Users.Login_ID
35014>>>
35014>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
35015>>>>
35015>>>        If (Found=1)  Begin
35017>>>            Move Users.User_ID  to liUser
35018>>>            Move Users.Grp_ID   to iGroup
35019>>>        End
35019>>>>
35019>>>        Else Function_Return 0
35021>>>
35021>>>        Clear Views
35022>>>        Move (Trim(lsView)) to Views.Menu_Name
35023>>>        Find eq Views by Index.2 // Views:Index.2:Views.Menu_Name
35024>>>>
35024>>>        If (Found=1) Begin
35026>>>            Move Views.View_ID to liViews
35027>>>            Clear GrpViews
35028>>>            Move liUser    to GrpViews.User_ID
35029>>>            Move liViews   to GrpViews.View_ID
35030>>>            Find Eq GrpViews by Index.1 // GrpViews:Index.1:GrpViews.User_ID+GrpViews.View_ID
35031>>>>
35031>>>            If (Found=1) Begin // And (liUser=GrpViews.User_ID) And (liViews=GrpViews.View_ID)) Begin
35033>>>                Function_Return (GrpViews.Allow_Read<>'1')
35034>>>            End
35034>>>>
35034>>>            Else Begin
35035>>>                Clear GrpView0
35036>>>                Move iGroup    to GrpView0.Group_ID
35037>>>                Move liViews   to GrpView0.View_ID
35038>>>                Find eq GrpView0 by Index.1 // GrpView0:Index.1:Group_ID+View_ID
35039>>>>
35039>>>                If (Found=1) Begin
35041>>>                    Function_Return (GrpView0.Allow_Read<>'1')
35042>>>                End
35042>>>>
35042>>>                Else         Function_Return 0
35044>>>            End
35044>>>>
35044>>>        End
35044>>>>
35044>>>        Else Function_Return 0
35046>>>    End_Function
35047>>>
35047>>>//    Procedure Enhmerose_Views_File_In_Class
35047>>>//        Integer liCount liInt liLastNo
35047>>>//        String lsStr
35047>>>//        Get Item_Count to liCount
35047>>>//        // find last view_id
35047>>>//        Clear Views
35047>>>//        Move 9999 to Views.View_ID
35047>>>//        Find lt Views by index.1 // view_id
35047>>>//        If (Found=1)    Move Views.View_ID  to liLastNo
35047>>>//        Else            Move 0              to liLastNo
35047>>>//        For liInt From 0 to (liCount-1)
35047>>>//            Get Value item liInt to lsStr
35047>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
35047>>>//            //Move (Trim(lsStr)) to lsStr
35047>>>//            If (lsStr<>'') Begin
35047>>>//                Clear Views
35047>>>//                Move lsStr to Views.Menu_Name
35047>>>//                Find eq Views by index.2 // Views.Menu_Name
35047>>>//                If (NOT(Found)) Begin
35047>>>//                    Add 1 to liLastNo
35047>>>//                    Move liLastNo to Views.View_ID
35047>>>//                    Saverecord Views
35047>>>//                End
35047>>>//            End
35047>>>//        Loop
35047>>>//        For liInt From 0 to (liCount-1)
35047>>>//            Get Value item liInt to lsStr
35047>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
35047>>>//            //Move (Trim(lsStr)) to lsStr
35047>>>//            If (lsStr<>'') Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
35047>>>//        Loop
35047>>>//    End_procedure
35047>>>
35047>>>    Procedure OnInitMenu
35048>>>        Integer liCount liInt liLastNo
35049>>>        String lsStr
35049>>>
35049>>>        Get Item_Count to liCount
35050>>>
35050>>>        // find last view_id
35050>>>        Clear Views
35051>>>        Move 9999 to Views.View_ID
35052>>>        Find lt Views by index.1 // view_id
35053>>>>
35053>>>        If (Found=1)    Move Views.View_ID  to liLastNo
35056>>>        Else            Move 0              to liLastNo
35058>>>        For liInt From 0 to (liCount-1)
35064>>>>
35064>>>            Get Value item liInt to lsStr
35065>>>            Move (Trim(lsStr)) to lsStr
35066>>>            If ((lsStr<>'') and (Length(lsStr)>2)) Begin
35068>>>                Clear Views
35069>>>                Move (ToOEM(lsStr)) to Views.Menu_Name
35070>>>                Find eq Views by index.2 // Views.Menu_Name
35071>>>>
35071>>>                If (NOT(Found)) Begin
35073>>>                    Add 1 to liLastNo
35074>>>                    Move liLastNo to Views.View_ID
35075>>>                    //Move (ToOEM(lsStr)) to Views.Menu_Name
35075>>>                    Saverecord Views
35076>>>                End
35076>>>>
35076>>>            End
35076>>>>
35076>>>        Loop
35077>>>>
35077>>>        For liInt From 0 to (liCount-1)
35083>>>>
35083>>>            Get Value item liInt to lsStr
35084>>>            Move (Trim(lsStr)) to lsStr
35085>>>            Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
35086>>>        Loop
35087>>>>
35087>>>
35087>>>    End_procedure
35088>>>
35088>>>//    Procedure End_Construct_Object
35088>>>//        Forward Send End_Construct_Object
35088>>>//        Send Enhmerose_Views_File_In_Class
35088>>>//    End_Procedure
35088>>>
35088>>>End_Class //ButtonSub
35089>>>
35089>>>
35089>
35089>//AB-StoreTopEnd
35089>
35089>
35089>Object Main is a Panelsub
35091>    Set Label To "Import Data TITAN"
35092>
35092>    DFCreate_Menu Main_Menu
INCLUDING FILE: FILE_PM.INC
35095>>Object oMyWinPrint is an DF_PRINTER
35097>>
35097>>    Procedure DFPrint
35099>>        Local Integer iRetVal
35100>>
35100>>        Get DFGetPrintDialogFlags To iRetVal
35101>>
35101>>        If iRetVal Begin
35103>>            Send DFPrintDoc
35104>>            Send DFClearDoc
35105>>        End
35105>>>
35105>>    End_Procedure
35106>>    Move Current_Object to WinPrintId
35107>>End_Object
35108>>
35108>>
35108>>DFCreate_Menu "&File" File_Menu is a DEOPopupMenu
35112>>    On_Item "&Clear/Add\aF5" send Request_Clear
35113>>        Set Status_Help To 'Clear current record / Add a new record'
35114>>
35114>>    On_Item "Clear &all\aCtrl+F5" send Request_Clear_All
35115>>        Set Status_Help To 'Clear all data from view'
35116>>
35116>>    On_Item "&Delete\aShift+F2" send Request_Delete
35117>>        Set Status_Help To 'Delete the current record'
35118>>
35118>>    On_Item "&Find\aF9" send Find_GE
35119>>        Set Status_Help To 'Find a record'
35120>>
35120>>    On_Item "&Next\aF8" send Find_Next
35121>>        Set Status_Help To 'Find the Next record'
35122>>
35122>>    On_Item "&Previous\aF7" send Find_Previous
35123>>        Set Status_Help To 'Find the Previous record'
35124>>
35124>>    On_Item "Superfind\aShift+F9" send Superfind
35125>>        Set Status_Help To 'Superfind a record'
35126>>
35126>>    On_Item "Superfind next\aShift+F8" send Superfind_Next
35127>>        Set Status_Help To 'Superfind the Next record'
35128>>
35128>>    On_Item "Superfind previous\aShift+F7" send Superfind_Previous
35129>>        Set Status_Help To 'Superfind the Previous record'
35130>>
35130>>    On_Item "Find fi&rst\aCtrl+Home" send Beginning_Of_Data
35131>>        Set Status_Help To 'Find the First record'
35132>>
35132>>    On_Item "Find &last\aCtrl+End" send End_Of_Data
35133>>        Set Status_Help To 'Find the Last record'
35134>>
35134>>    On_Item "&Save\aF2" send Request_Save
35135>>        Set Status_Help To 'Save the current record'
35136>>
35136>>
35136>>    On_Item "" send NONE
35137>>
35137>>    on_item   "Printer Settings   "  send DFPrintSetup       to (oWinPrint(Self))
35138>>    Set Status_Help To ""
35139>>    on_item   "Print              "  send DFPrint            to (oMyWinPrint(Self))
35140>>    Set Status_Help To ""
35141>>
35141>>    On_Item "" send NONE
35142>>
35142>>    On_Item "Properties" send DoShowProperties to Self
35143>>    Set Status_Help To 'Setup Program Properties'
35144>>
35144>>    On_Item "" send NONE
35145>>
35145>>    On_Item "E&xit\aAlt+F4" send Exit_Application to desktop
35146>>        Set Status_Help To "Stop Program's execution"
35147>>
35147>>    Procedure DoShowProperties
35149>>       // If (Close_All_Views(Self,True)=0) Send Activate_View to (piPropertiesObjectId(self))
35149>>    End_Procedure
35150>>
35150>>    On_Key Key_Alt+Key_I Send DoShowProperties
35151>>
35151>>    //
35151>>    Procedure OnInitMenu
35153>>        Local integer Obj# IsDeo Changed NoIndex File# Field# Srvr Itm
35154>>        Local integer IsDeoControl lId liClId
35154>>        Get Focus to Obj#
35155>>        Get is_Function Get_DEO_Object Obj# TRUE to IsDeo
35156>>        If IsDeo Get Server of obj# to Srvr          // invoking data-set
35159>>        If (isDeo AND Srvr) Begin
35161>>            // returns T if object in question is a DEO control object (i.e.
35161>>            // understands the data_file, data_field messages).
35161>>            Get is_Function Get_DEO_Control_Object Obj# False to IsDeoControl
35162>>            Get Should_Save of Obj# to changed  // changed file?
35163>>            If IsDEOControl Begin
35165>>                Get data_file of Obj# to file#
35166>>                Get data_field of Obj# to field#
35167>>                Move ( File#=0 OR ;                    (Field_Main_Index(Srvr,File#,Field#)=-1) ;                    ) to NoIndex             // has a find index?
35168>>            End
35168>>>
35168>>            Else ;                Move 1 to NoIndex
35170>>            Set Shadow_state item  0  to False                     // Clear
35171>>            Set Shadow_state item  1  to False                     // Clear All
35172>>            Set Shadow_state item  2  to (Current_record(Srvr)=0)  // Delete
35173>>            Set Shadow_state item  3  to NoIndex                   // Find
35174>>            Set Shadow_state item  4  to NoIndex                   // Find Next
35175>>            Set Shadow_state item  5  to NoIndex                   // Find Previous
35176>>            Set Shadow_state item  6  to NoIndex                   // Superfind
35177>>            Set Shadow_state item  7  to NoIndex                   // Superfind Next
35178>>            Set Shadow_state item  8  to NoIndex                   // Superfind Previous
35179>>            Set Shadow_state item  9  to NoIndex                   // Find First
35180>>            Set Shadow_state item 10  to NoIndex                   // Find Last
35181>>            Set Shadow_state item 11  to (Should_Save(Srvr)=0)     // Save
35182>>            Set Shadow_state item 12  to NoIndex                   // Printer
35183>>            Set Shadow_state item 13  to NoIndex                   // Print
35184>>//            Set Shadow_state item 14  to NoIndex                   // Properties
35184>>//            Set Shadow_state item 15  to (Should_Save(Srvr)=0)     // Exodos
35184>>        End
35184>>>
35184>>        Else Begin
35185>>            for itm from 0 to 13
35191>>>
35191>>                set shadow_State item itm to TRUE
35192>>            Loop
35193>>>
35193>>        End
35193>>>
35193>> //       Set Shadow_State Item 14 to (piPropertiesObjectId(Self)=0)
35193>>    End_Procedure
35194>>
35194>>    Register_Procedure Activate_oPrnSetup
35194>>
35194>>End_Pull_Down
35196>>Set Status_Help to "Find, Save, Delete, Clear information or quit this application."
35197>
35197>        DFCreate_Menu "&View" ViewPopupMenu is a ViewPopupMenu
35201>            On_Item "&tAxio\aCtrl+1" Send Activate_tAxio
35202>        End_Pull_down
35204>        Set Status_Help To "Available Views"
35205>        
INCLUDING FILE: NAVI_PM.INC
35205>>Use DFDEOMnu
35205>>
35205>>DFCreate_Menu "&Navigation" NAVIGATE_Menu is a DEOPopupMenu
35209>>    On_Item "&Next Area\aF6"            send Switch_Next_Area
35210>>        Set Status_Help To  'Move to Next Area'
35211>>
35211>>    On_Item "&Previous Area\aShift+F6"  send Switch_Prior_Area
35212>>        Set Status_Help To  'Move to Previous Area'
35213>>
35213>>    On_Item "N&ext View\aAlt+F6"        send Switch_Next_View
35214>>        Set Status_Help To  'Move to Next View'
35215>>
35215>>    On_Item "P&revious View\aCtrl+F6"   send Switch_Prior_View
35216>>        Set Status_Help To  'Move to Previous View'
35217>>
35217>>    On_Item ""                          send none
35218>>
35218>>    On_Item "&List\aF4"               send Prompt
35219>>        Set Status_Help To  'Show Selection Lists'
35220>>
35220>>    On_Item "&Zoom\aAlt+F9"             send Zoom
35221>>        Set Status_Help To  'Show Zoom'
35222>>
35222>>    Procedure OnInitMenu
35224>>        Local integer Obj# IsDeo Itm prmpt zm isDeoControl
35225>>        Get Focus to Obj#
35226>>        Get is_Function Get_DEO_Object Obj# TRUE to IsDeo
35227>>        If IsDeo Begin
35229>>            Get is_Function Get_DEO_Control_Object Obj# False to IsDeoControl
35230>>            If IsDeoControl Begin
35232>>                Get Prompt_Object of Obj# to Prmpt
35233>>                Get Zoom_Object of Obj# to zm
35234>>            End
35234>>>
35234>>            Set Shadow_state item 0  to False
35235>>            Set Shadow_state item 1  to False
35236>>            Set Shadow_state item 2  to False
35237>>            Set Shadow_state item 3  to False
35238>>            Set Shadow_state item 5  to (Prmpt=0)
35239>>            Set Shadow_state item 6  to (Zm=0)
35240>>        End
35240>>>
35240>>        Else Begin
35241>>            for itm from 0 to 6
35247>>>
35247>>                set shadow_State item itm to TRUE
35248>>            Loop
35249>>>
35249>>        End
35249>>>
35249>>    End_Procedure
35250>>
35250>>End_Pull_Down
35252>>Set Status_Help to "Navigation in different areas of the screen"
35253>>
INCLUDING FILE: WIN_PM.INC
35253>>DFCreate_Menu "&Window" Window_Menu
35257>>    Set select_mode to Multi_Select
35258>>    // normal number of items in pulldown (w/ no active views)
35258>>    property integer std_item_count public 0
35260>>
35260>>    DFCreate_Menu "&Preferences" Display_Options_Menu
35264>>        Set select_mode to Multi_Select
35265>>        On_Item "&ToolBar"        Send Toggle_Toolbar             To Self
35266>>        On_Item "&StatusBar"      Send Toggle_Statusbar           To Self
35267>>        On_Item "&Arrange Icons"  Send Toggle_Auto_Arrange_Icons  To Self
35268>>
35268>>        //  When ever the menu [pulldown] is initialized, check/set
35268>>        //  the state of its items.
35268>>        //
35268>>        Procedure OnInitMenu
35270>>            local integer bState
35271>>
35271>>            Get ToolBar_State to bState
35272>>            Set Select_State Item 0 to bState
35273>>            if  bState   Set Status_Help Item 0 To '' //'Hide the ToolBar'
35276>>            Else         Set Status_Help Item 0 to '' //'Show the ToolBar'
35278>>
35278>>            Get Statusbar_State to bState
35279>>            Set Select_State Item 1 to bState
35280>>            if  bState  Set Status_Help Item 1 To ''// 'Hide the StatusBar'
35283>>            Else        Set Status_Help Item 1 to ''// 'Show the StatusBar'
35285>>
35285>>            Get Auto_Arrange_Icons_State to bState
35286>>            Set Select_State Item 2 to bState
35287>>            if  bState  Set Status_Help Item 2 To '' //'Hide AutoArrange Icons'
35290>>            Else        Set Status_Help Item 2 to '' //'Show AutoArrange Icons'
35292>>
35292>>        End_procedure
35293>>
35293>>
35293>>    End_Pull_Down
35295>>    Set Status_Help                                           To '' //"Enable Toolbar, StatusBar, and AutoArrange Icons options"
35296>>
35296>>    On_Item ""
35297>>
35297>>    On_Item "&Cascade" send Cascade_Windows                   To Self
35298>>        Set Status_Help                                       To ''
35299>>
35299>>    On_Item "Tile &Horizontally" send Tile_Windows_Horizontal To Self
35300>>        Set Status_Help                                       To ''
35301>>
35301>>    On_Item "Tile &Vertically" send Tile_Windows_Vertical     To Self
35302>>        Set Status_Help                                       To ''
35303>>
35303>>    On_Item ""
35304>>
35304>>    On_Item "Minimize all" send Minimize_all_Windows          To Current_Object
35305>>        Set Status_Help                                       To ''
35306>>
35306>>    On_Item "&Restore all" send Restore_all_Windows           To Current_Object
35307>>        Set Status_Help                                       To ''
35308>>
35308>>    On_Item ""
35309>>
35309>>    On_Item "&Arrange Icons" send Arrange_Icons               To Current_Object
35310>>        Set Status_Help                                       To ''
35311>>
35311>>    // set this to the number of items in the menu with no views.
35311>>    Set Std_item_count to (item_count(current_object))
35312>>
35312>>    // add all active views to the end of the menu
35312>>    Procedure OnInitMenu
35314>>        local integer iStdCnt iNumCnt hVw hCl iCount
35315>>        Local string sLbl
35315>>        //*** Remove all old view items
35315>>        Get Item_count     to iNumCnt
35316>>        get Std_item_count to iStdCnt
35317>>        For iCount from 1  to (iNumCnt - iStdCnt)
35323>>>
35323>>            Send Delete_item iStdCnt
35324>>        Loop
35325>>>
35325>>
35325>>        Move iStdcnt to iNumCnt
35326>>        get Client_id to hCl // object id of client area
35327>>        If hCl Begin
35329>>           Get Next_Mdi_Dialog of hcl TRUE to hVw // find first view
35330>>           While hVw
35334>>              if (Active_state(hVw)) Begin
35336>>                 if iNumCnt eq iStdCnt Begin // if first view, add separator
35338>>                    send add_item 0 ''
35339>>                    increment iNumCnt
35340>>                 end
35340>>>
35340>>                 Get Label of hVw to sLbl // caption bar (name) of view
35341>>                 // note that all views understand the message activate_view.
35341>>                 send add_item msg_activate_view sLbl // set message, value and destination
35342>>                 set aux_value item iNumcnt to hVw
35343>>                 // if this is the focus view, mark it.
35343>>                 If (current_scope(desktop)=hVw and View_mode(hVw)<>VIEWMODE_ICONIZE) ;                     set select_state item iNumCnt to True
35346>>                 // create status help
35346>>                 Set Status_help item iNumCnt to ("Make this view (" - trim(sLbl) - ") the active window.")
35347>>                 increment iNumCnt
35348>>              end
35348>>>
35348>>              Get Next_Mdi_Dialog of hcl FALSE to hVw // find next
35349>>           End
35350>>>
35350>>        End
35350>>>
35350>>    End_Procedure // OnInitMenu
35351>>
35351>>End_Pull_Down
35353>>Set Status_Help to ''
INCLUDING FILE: HELPA_PM.INC
35354>>
35354>>
35354>>DFCreate_Menu "&Help" Help_Menu
35358>>    on_item "&Help Topic" send Help_on_topic
35359>>        Set Status_Help To "Search for help on a particular subject."
35360>>        on_item "" send NONE
35361>>    on_item "&Context Help"          send Extended_Help
35362>>        Set Status_Help To "Show Context sensitive help."
35363>>
35363>>    on_item "&Files Help"            send File_Help
35364>>        Set Status_Help To "Show Files help."
35365>>
35365>>    on_item "&Keys Help"             send Keys_Help
35366>>        Set Status_Help To "Show Keys help."
35367>>
35367>>    on_item "" send NONE
35368>>
35368>>    on_item "&How to Use Help"       send Help_For_Help
35369>>        Set Status_Help To "How to Use Help"
35370>>
35370>>    on_item "" send NONE
35371>>
35371>>    On_Item "&Tips of the Day" send Activate_TipOfDay
35372>>        Set Status_Help To "Tips of the Day"
35373>>
35373>>    on_item "" send NONE
35374>>
35374>>    On_item "About" Send Activate_About
35375>>        Set Status_Help To "System Information"
35376>>end_pull_down
35378>>Set Status_Help to "Access to the program's help subsystem"
35379>>
35379>>Register_Procedure Activate_TipOfDay
35379>>
35379>>
35379>    End_Menu
35381>
35381>    Use DFStdBtn.pkg //  Tool-Bar object.
INCLUDING FILE: DFSTDBTN.PKG
35381>>>// 07/23/96 JJT - New Class names
35381>>>// 10/03/97 KCR - removed leading separator
35381>>>
35381>>>Use DFMainBt  // dfMain_ButtonBar
INCLUDING FILE: DFMAINBT.PKG
35381>>>>>//-------------------------------------------------------------------------
35381>>>>>// DFMainBt.pkg - DfMain_ButtonBar class
35381>>>>>//
35381>>>>>//
35381>>>>>// 07/23/96 JJT - New Class names
35381>>>>>//-------------------------------------------------------------------------
35381>>>>>
35381>>>>>Use DfPanel // dfapp_buttonbar
35381>>>>>
35381>>>>>Class ToolBar is a AppToolBar
35382>>>>>
35382>>>>>    Function Is_Function Integer MsgId Integer ObjId Integer DelegateFg Returns Integer
35383>>>>>      Local integer rval MainObj#
35384>>>>>      Get Main_Panel_id to MainObj#
35385>>>>>      If (ObjId>Desktop AND MainObj#) ;         Get Is_Function of MainObj# MsgId ObjId DelegateFg to rVal
35388>>>>>      Function_Return rVal
35389>>>>>    End_Function
35390>>>>>
35390>>>>>    Procedure Redirect_Button_Message integer Itm
35391>>>>>         Local integer Msg# Aux# rval Understood
35392>>>>>         If (Shadow_State(Current_Object,itm)) Procedure_Return
35395>>>>>         Get Message   item itm  to Msg#
35396>>>>>         Get Aux_Value item itm  to Aux#
35397>>>>>         If Msg# Begin
35399>>>>>           If Aux# eq 0 Begin
35401>>>>>              Get Focus to Aux#
35402>>>>>              Get Is_Function Get_DEO_Object Aux# TRUE to Understood
35403>>>>>              If Not Understood Move 0 to Aux#
35406>>>>>           End
35406>>>>>>
35406>>>>>           If Aux# Get Msg# of Aux# to rval
35409>>>>>           Procedure_return rval
35410>>>>>         end
35410>>>>>>
35410>>>>>    End_Procedure // Redirect_Message
35411>>>>>
35411>>>>>End_Class
35412>>>>>
35412>>>>>
35412>>>
35412>>>//  Button bar object.
35412>>>//
35412>>>Object Tool_Bar is a ToolBar
35414>>>
35414>>>    Send ImageList_Add 'bgn.bmp'   // 0
35415>>>    Send ImageList_Add 'end.bmp'   // 1
35416>>>    Send ImageList_Add 'next.bmp'  // 2
35417>>>    Send ImageList_Add 'prev.bmp'  // 3
35418>>>    Send ImageList_Add 'clr.bmp'   // 4
35419>>>    Send ImageList_Add 'clra.bmp'  // 5
35420>>>
35420>>>    send Add_button (ico_user+0) msg_beginning_of_data
35421>>>    Send Add_ToolTip "Beginning of file"
35422>>>    Set  Status_Help To 'Find the First record (Ctrl+Home)'
35423>>>
35423>>>    send Add_button (ico_user+3) msg_find_previous
35424>>>    Send Add_ToolTip "Find Previous"
35425>>>    Set  Status_Help To 'Find the Previous record (F7)'
35426>>>
35426>>>    send Add_button (ico_user+2) msg_find_next
35427>>>    Send Add_ToolTip "Find Next"
35428>>>    Set  Status_Help To 'Find the Next record (F8)'
35429>>>
35429>>>    send Add_button (ico_user+1) msg_end_of_data
35430>>>    Send Add_ToolTip "End of File"
35431>>>    Set  Status_Help To 'Find the Last record (Ctrl+End)'
35432>>>
35432>>>    Send Add_space
35433>>>
35433>>>    send Add_button ico_std_find msg_prompt
35434>>>    Send Add_ToolTip "Prompt"
35435>>>    Set  Status_Help To 'Show available selections (F4)'
35436>>>
35436>>>    send Add_button (ico_user+4) msg_request_clear
35437>>>    Send Add_ToolTip "Clear"
35438>>>    Set  Status_Help To 'Clear current record / Add a new record (F5)'
35439>>>
35439>>>    send Add_button (ico_user+5) msg_request_clear_all
35440>>>    Send Add_ToolTip "Clear All"
35441>>>    Set  Status_Help To 'Clear all data from view (Ctrl+F5)'
35442>>>
35442>>>    send Add_space
35443>>>
35443>>>    send Add_button ico_std_filesave msg_request_save
35444>>>    Send Add_ToolTip "Save"
35445>>>    Set  Status_Help To 'Save the current record (F2)'
35446>>>
35446>>>    send Add_button ico_std_delete msg_request_delete
35447>>>    Send Add_ToolTip "Delete"
35448>>>    Set  Status_Help To 'Delete the current record (Shift+F2)'
35449>>>
35449>>>    send Add_space
35450>>>
35450>>>    send Add_button ico_std_cut msg_cut
35451>>>    Send Add_ToolTip "Cut"
35452>>>    Set  Status_Help to "Cuts the selection and puts it on the Clipboard"
35453>>>
35453>>>    send Add_button ico_std_copy msg_copy
35454>>>    Send Add_ToolTip "Copy"
35455>>>    Set  Status_Help to "Copies the selection and puts it on the Clipboard"
35456>>>
35456>>>    send Add_button ico_std_paste msg_paste
35457>>>    Send Add_ToolTip "Paste"
35458>>>    Set  Status_Help to "Inserts Clipboard contents"
35459>>>
35459>>>End_Object
35460>>>
35460>    
35460>    Object Client_Area is a AppClientAreasub
35462>
35462>        //AB-ClientStoreTopStart
35462>        
35462>        Use DD_Sec.Sub
INCLUDING FILE: DD_SEC.SUB
35462>>>
35462>>>Open Sysfile
35464>>>Open UserGrps
35466>>>Open Users
35468>>>Open Views
35470>>>Open GrpViews
35472>>>Open Arxeia
35474>>>Open GrpArx
35476>>>Open GrpArx0
35478>>>Open GrpView0
35480>>>
35480>>>Use DD.Sub
35480>>>
35480>>>Class Datadictionary_Sec  Is A DatadictionarySub
35481>>>
35481>>>
35481>>>    Procedure Construct_Object
35482>>>        Forward Send Construct_Object
35484>>>        Property Integer cpiUpdate              0
35485>>>        Property Integer cpiBackout             0
35486>>>        Property Integer cpiEditing             0
35487>>>        Property Integer cpiFileNumber          0
35488>>>        Property String  cpsFileName            ''
35489>>>        Property String  cpsLoginID             ''
35490>>>        Property Integer cpiCannot_Read         0
35491>>>        Property Integer cpiCannot_Create       0
35492>>>        Property Integer cpiCannot_Delete       0
35493>>>        Property Integer cpiCannot_Edit         0
35494>>>        Property Integer piFN                   0
35495>>>    End_Procedure
35496>>>
35496>>>//    Procedure Save_Main_File
35496>>>//        If (Operation_Origin<>Self) Begin
35496>>>//            If Indirect_File.Recnum Eq 0 Procedure_Return
35496>>>//        End
35496>>>//        Forward Send Save_Main_File
35496>>>//    End_Procedure
35496>>>
35496>>>
35496>>>
35496>>>    Function Validate_Save Returns Integer
35497>>>        Integer rVal
35498>>>        Forward Get Validate_Save to rVal
35500>>>        If (Not(rVal)) Begin
35502>>>            Get cpiCannot_Read to rVal
35503>>>            If (Not(rVal)) Begin
35505>>>                Set cpiEditing to ((cpiBackout(Self)=1) and (cpiUpdate(Self)=1))
35506>>>                If (cpiEditing(Self)=1) Get cpiCannot_Edit      to rVal
35509>>>                Else                    Get cpiCannot_Create    to rVal
35511>>>            End
35511>>>>
35511>>>            If (rVal) Send Operation_Not_Allowed rVal
35514>>>        End
35514>>>>
35514>>>        Function_Return rVal
35515>>>    End_Function
35516>>>
35516>>>    Function Validate_Delete Returns Integer
35517>>>        Integer rVal
35518>>>        Forward Get Validate_Delete to rVal
35520>>>        If (Not(rVal)) Begin
35522>>>            Get cpiCannot_Read to rVal
35523>>>            If (Not(rVal)) Get cpiCannot_Delete to rVal
35526>>>            If (rVal) Send Operation_Not_Allowed rVal
35529>>>        End
35529>>>>
35529>>>        Function_Return rVal
35530>>>    End_Function
35531>>>
35531>>>    Procedure End_Construct_Object
35532>>>        Integer liSrv rVal
35533>>>        String lsStr
35533>>>        Forward Send End_Construct_Object
35535>>>        Get Main_File                                   To liSrv
35536>>>        Set cpiFileNumber                               To liSrv
35537>>>        Get_Attribute DF_FILE_PHYSICAL_NAME Of liSrv    To lsStr
35540>>>        Set cpsFileName                                 To (Trim(Uppercase(lsStr)))
35541>>>        Set cpsLoginID                                  To (fsLoginUserID())
35542>>>        Send Find_User_Rights
35543>>>        Set piFN to lisrv
35544>>>    End_Procedure
35545>>>
35545>>>    Procedure Find_User_Rights
35546>>>        String lsArxeio lsLogin
35547>>>        Integer liUser liArxeio iGroup
35547>>>
35547>>>        Get cpiFileNumber   to liArxeio
35548>>>        Get cpsFileName     to lsArxeio
35549>>>        Get cpsLoginID      to lsLogin
35550>>>
35550>>>        Clear Users
35551>>>        Move lsLogin    to Users.Login_ID
35552>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
35553>>>>
35553>>>        If (Found=1)  Begin
35555>>>            Move Users.User_ID  to liUser
35556>>>            Move Users.Grp_ID   to iGroup
35557>>>        End
35557>>>>
35557>>>        //Else Send Operation_Not_Allowed 9999
35557>>>
35557>>>        Clear Arxeia
35558>>>
35558>>>        Move liArxeio to Arxeia.Arxeio_ID
35559>>>        Find eq Arxeia by Index.1 // Arxeia:Index.1:Arxeia.Arxeio_ID
35560>>>>
35560>>>
35560>>>        If (Found=1) Begin
35562>>>            Move Arxeia.Arxeio_ID to liArxeio
35563>>>
35563>>>            Clear GrpArx
35564>>>            Move liUser     to GrpArx.User_ID
35565>>>            Move liArxeio   to GrpArx.Arxeio_ID
35566>>>            Find eq GrpArx by Index.1 // GrpArx:Index.1:GrpArx.User_ID+GrpArx.Arxeio_ID
35567>>>>
35567>>>            If (Found=1) Begin
35569>>>               If (GrpArx.Allow_Read  ='1') Set cpiCannot_Read   to 0
35572>>>               Else                         Set cpiCannot_Read   to 10003
35574>>>               If (GrpArx.Allow_Create='1') Set cpiCannot_Create to 0
35577>>>               Else                         Set cpiCannot_Create to 10000
35579>>>               If (GrpArx.Allow_Change='1') Set cpiCannot_Edit   to 0
35582>>>               Else                         Set cpiCannot_Edit   to 10001
35584>>>               If (GrpArx.Allow_Delete='1') Set cpiCannot_Delete to 0
35587>>>               Else                         Set cpiCannot_Delete to 10002
35589>>>            End
35589>>>>
35589>>>            Else Begin
35590>>>                Clear GrpArx0
35591>>>                Move iGroup   to GrpArx0.Group_ID
35592>>>                Move liArxeio to GrpArx0.Arxeio_ID
35593>>>                Find eq GrpArx0 by Index.1 // GrpArx0:Index.1:Group_ID+Arxeio_ID
35594>>>>
35594>>>                If (Found=1) Begin
35596>>>                    If (GrpArx0.Allow_Read  ='1')   Set cpiCannot_Read   to 0
35599>>>                    Else                            Set cpiCannot_Read   to 20003
35601>>>                    If (GrpArx0.Allow_Create='1')   Set cpiCannot_Create to 0
35604>>>                    Else                            Set cpiCannot_Create to 20000
35606>>>                    If (GrpArx0.Allow_Change='1')   Set cpiCannot_Edit   to 0
35609>>>                    Else                            Set cpiCannot_Edit   to 20001
35611>>>                    If (GrpArx0.Allow_Delete='1')   Set cpiCannot_Delete to 0
35614>>>                    Else                            Set cpiCannot_Delete to 20002
35616>>>                End
35616>>>>
35616>>>                Else Begin
35617>>>                    Set cpiCannot_Read   to 0
35618>>>                    Set cpiCannot_Edit   to 0
35619>>>                    Set cpiCannot_Create to 0
35620>>>                    Set cpiCannot_Delete to 0
35621>>>                End
35621>>>>
35621>>>            End
35621>>>>
35621>>>        End
35621>>>>
35621>>>        Else Begin
35622>>>            // €¤ ›œ¤ ™¨œŸœ  «¦ ˜¨®œ ¦ «¦«œ Ÿœà¨¦¬£œ ¦«  ¦ ®¨ž©«žª œ®œ  §¨¦©™˜©ž ©'˜¬«¦
35622>>>            Set cpiCannot_Read   to 0
35623>>>            Set cpiCannot_Edit   to 0
35624>>>            Set cpiCannot_Create to 0
35625>>>            Set cpiCannot_Delete to 0
35626>>>        End
35626>>>>
35626>>>    End_Procedure
35627>>>
35627>>>    Procedure Clear_main_file
35628>>>        Forward Send Clear_main_file
35630>>>        Set cpiBackout to 0
35631>>>        Set cpiUpdate  to 0
35632>>>    End_Procedure
35633>>>
35633>>>    Procedure Update
35634>>>        Forward Send Update
35636>>>        Set cpiUpdate to 1
35637>>>    End_Procedure
35638>>>
35638>>>    Procedure Backout
35639>>>        Forward Send Backout
35641>>>        Set cpiBackout to 1
35642>>>    End_Procedure
35643>>>
35643>>>    Procedure OnConstrain
35644>>>        Integer rVal liSrv
35645>>>        Forward Send OnConstrain
35647>>>        Get cpiFileNumber  To liSrv
35648>>>        Move liSrv         To Filenumber
35649>>>        Get cpiCannot_Read to rVal
35650>>>        If (rVal) Constrain Indirect_File.Recnum eq 0
35654>>>    End_Procedure
35655>>>
35655>>>    Procedure Operation_Not_Allowed  Integer iError_Num
35656>>>        String sLektiko
35657>>>        Move '' to sLektiko
35658>>>
35658>>>             If iError_Num eq 10000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
35661>>>        Else If iError_Num eq 10001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Users permissions. Check with your Administrator"    to sLektiko
35665>>>        Else If iError_Num eq 10002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
35669>>>        Else If iError_Num eq 10003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
35673>>>        Else If iError_Num eq 20000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
35677>>>        Else If iError_Num eq 20001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Group permissions. Check with your Administrator"    to sLektiko
35681>>>        Else If iError_Num eq 20002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
35685>>>        Else If iError_Num eq 20003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
35689>>>        Else If iError_Num eq  9999 Move "Unknown User in Users File"                                                                                    to sLektiko
35693>>>        Else If iError_Num eq 20101 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Change its Data"                 to sLektiko
35697>>>        Else If iError_Num eq 20102 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Delete It"                       to sLektiko
35701>>>        Append sLektiko '\nFile = ' (String(cpiFileNumber(Self))) ' - ' (CpsFileName(Self))
35705>>>
35705>>>             If iError_Num eq 10000 Error 10000 sLektiko
35708>>>        Else If iError_Num eq 10001 Error 10001 sLektiko
35712>>>        Else If iError_Num eq 10002 Error 10002 sLektiko
35716>>>        Else If iError_Num eq 10003 Error 10003 sLektiko
35720>>>        Else If iError_Num eq 20000 Error 20000 sLektiko
35724>>>        Else If iError_Num eq 20001 Error 20001 sLektiko
35728>>>        Else If iError_Num eq 20002 Error 20002 sLektiko
35732>>>        Else If iError_Num eq 20003 Error 20003 sLektiko
35736>>>        Else If iError_Num eq  9999 Error  9999 sLektiko
35740>>>        Else If iError_Num eq 20101 Error 20101 sLektiko
35744>>>        Else If iError_Num eq 20102 Error 20102 sLektiko
35748>>>
35748>>>        Else Forward Send Operation_Not_Allowed  iError_Num
35751>>>    End_Procedure   // Operation_Not_Allowed
35752>>>
35752>>>
35752>>>End_Class //Datadictionary_Sec
35753>        Use Roundfn.Fnc
35753>        
35753>        Function fngConvertPoso Global String asNomismaCodeApo Number anPoso ;                                       String asNomismaCodeSe  Date   adHmnia;                                       Number nIsotimia  Returns Number
35754>        
35754>            Number rVal nApo_Euro_Isot nSe_Euro_Isot
35755>            Integer iApo_Einai_Euro_Zone iApo_Einai_DRX iApo_Einai_Euro iDekadika_Apo
35755>            Integer iSe_Einai_Euro_Zone  iSe_Einai_DRX  iSe_Einai_Euro  iDekadika_Se
35755>            String  sCode
35755>        
35755>            If (asNomismaCodeApo=asNomismaCodeSe) Function_Return anPoso
35758>        
35758>            Clear Nomisma
35759>            Move (Trim(asNomismaCodeApo)) to Nomisma.Nomisma_Code
35760>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
35761>            Move Nomisma.Euro_Zone      to iApo_Einai_Euro_Zone
35762>            Move Nomisma.Einai_DRX      to iApo_Einai_DRX
35763>            Move Nomisma.Einai_EURO     to iApo_Einai_Euro
35764>            Move Nomisma.KL_ISOT_EURO   to nApo_Euro_Isot
35765>            Move Nomisma.Dekadika       to iDekadika_Apo
35766>            // 1. An to nomisma APO den einai ths zonhs euro prepei na vrethei h isotimia tou
35766>            If ((NOT(iApo_Einai_Euro_Zone)) And (nApo_Euro_Isot=0))  Begin
35768>                If (adHmnia='') Sysdate            adHmnia
35771>                Move (Trim(asNomismaCodeApo))   to sCode
35772>                Clear Isotimia
INCLUDING FILE: ISOTIMIA.FD
35773>                Move sCode                      to Isotimia.Nomisma_Code
35774>                Move (adHmnia+1)                to Isotimia.Isotimia_Hmnia
35775>                Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
35776>                Move Isotimia.Isotimia_Euro     to nApo_Euro_Isot
35777>            End
35777>        
35777>            Clear Nomisma
35778>            Move (Trim(asNomismaCodeSe)) to Nomisma.Nomisma_Code
35779>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
35780>            Move Nomisma.Euro_Zone      to iSe_Einai_Euro_Zone
35781>            Move Nomisma.Einai_DRX      to iSe_Einai_DRX
35782>            Move Nomisma.Einai_EURO     to iSe_Einai_Euro
35783>            Move Nomisma.KL_ISOT_EURO   to nSe_Euro_Isot
35784>            Move Nomisma.Dekadika       to iDekadika_Se
35785>            // 2. An to nomisma SE den einai ths zonhs euro prepei na vrethei h isotimia tou
35785>            If ((NOT(iSe_Einai_Euro_Zone)) And (nSe_Euro_Isot=0)) Begin
35787>                If (adHmnia='') Sysdate            adHmnia
35790>                Move (Trim(asNomismaCodeSe))    to sCode
35791>                Clear Isotimia
35792>                Move sCode                      to Isotimia.Nomisma_Code
35793>                Move (adHmnia+1)                to Isotimia.Isotimia_Hmnia
35794>                Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
35795>                Move Isotimia.Isotimia_Euro     to nSe_Euro_Isot
35796>            End
35796>        
35796>            Calc (anPoso/nApo_Euro_Isot) to rVal
35797>            Move (Round_Number(rVal,6)) to rVal
35798>            Calc (rVal*nSe_Euro_Isot) to rVal
35799>            Move (Round_Number(rVal,iDekadika_Se)) to rVal
35800>        
35800>            Function_Return rVal
35801>        End_Function
35802>        
35802>        //AB-ClientStoreTopEnd
35802>
35802>        //  Include all views
35802>        Use tAxio.VW                                                                        
INCLUDING FILE: TAXIO.VW
35802>>>//AB/ Project tAxio
35802>>>//AB/ Object prj is a View_Project
35802>>>//AB/     Set ProjectName to "tAxio"
35802>>>//AB/     Set ProjectFileName to "tAxio.VW"
35802>>>//AB/     Set GenerateFileName to "NONAME"
35802>>>
35802>>>// Project Object Structure
35802>>>//   tAxio is a dbViewSub
35802>>>//     Ctypkin_DD is a Ctypkin_DataDictionary
35802>>>//     Country_DD is a Country_DataDictionary
35802>>>//     Towns_DD is a Towns_DataDictionary
35802>>>//     Cities_DD is a Cities_DataDictionary
35802>>>//     Payresp_DD is a Payresp_DataDictionary
35802>>>//     Constrct_DD is a Constrct_DataDictionary
35802>>>//     Salesmen_DD is a Salesmen_DataDictionary
35802>>>//     Mhxanik_DD is a Mhxanik_DataDictionary
35802>>>//     Areas_DD is a Areas_DataDictionary
35802>>>//     Btypkin_DD is a Btypkin_DataDictionary
35802>>>//     Baxiokat_DD is a Baxiokat_DataDictionary
35802>>>//     Barticl_DD is a Barticl_DataDictionary
35802>>>//     Bsum_DD is a Bsum_DataDictionary
35802>>>//     Baxio_DD is a Baxio_DataDictionary
35802>>>//     Syscurxr_DD is a Syscurxr_DataDictionary
35802>>>//     Clients_DD is a Clients_DataDictionary
35802>>>//     Cn_DD is a Cn_DataDictionary
35802>>>//     Tperga_DD is a Tperga_DataDictionary
35802>>>//     Bmove_DD is a Bmove_DataDictionary
35802>>>//     Cmoves_DD is a Cmoves_DataDictionary
35802>>>//     Btnordh_DD is a Btnordh_DataDictionary
35802>>>//     Btnordd_DD is a Btnordd_DataDictionary
35802>>>//     oOpenFile is a OpenDialog
35802>>>//     frmFileName is a FormSub
35802>>>//     ButtonSub1 is a ButtonSub
35802>>>//     TextBoxSub1 is a TextBoxSub
35802>>>//     RadioGroupSub1 is a RadioGroupSub
35802>>>//       Radio1 is a RadioSub
35802>>>//       Radio2 is a RadioSub
35802>>>//       Radio3 is a RadioSub
35802>>>//       Radio1 is a RadioSub
35802>>>//       Radio2 is a RadioSub
35802>>>
35802>>>// Register all objects
35802>>>Register_Object Areas_DD
35802>>>Register_Object Barticl_DD
35802>>>Register_Object Baxio_DD
35802>>>Register_Object Baxiokat_DD
35802>>>Register_Object Bmove_DD
35802>>>Register_Object Bsum_DD
35802>>>Register_Object Btnordd_DD
35802>>>Register_Object Btnordh_DD
35802>>>Register_Object Btypkin_DD
35802>>>Register_Object ButtonSub1
35802>>>Register_Object Cities_DD
35802>>>Register_Object Clients_DD
35802>>>Register_Object Cmoves_DD
35802>>>Register_Object Cn_DD
35802>>>Register_Object Constrct_DD
35802>>>Register_Object Country_DD
35802>>>Register_Object Ctypkin_DD
35802>>>Register_Object frmFileName
35802>>>Register_Object Mhxanik_DD
35802>>>Register_Object oOpenFile
35802>>>Register_Object Payresp_DD
35802>>>Register_Object Radio1
35802>>>Register_Object Radio2
35802>>>Register_Object Radio3
35802>>>Register_Object RadioGroupSub1
35802>>>Register_Object Salesmen_DD
35802>>>Register_Object Syscurxr_DD
35802>>>Register_Object TextBoxSub1
35802>>>Register_Object Towns_DD
35802>>>Register_Object Tperga_DD
35802>>>Register_Object tAxio
35802>>>
35802>>>
35802>>>//AB/ AppBuild VIEW
35802>>>
35802>>>
35802>>>//AB-StoreTopStart
35802>>>
35802>>>Use sl041.sl
INCLUDING FILE: SL041.SL
35802>>>>>//AB/ Project CN : sl041
35802>>>>>//AB/ Object prj is a Lookup_Project
35802>>>>>//AB/     Set ProjectName to "CN : sl041"
35802>>>>>//AB/     Set ProjectFileName to "sl041.SL"
35802>>>>>//AB/     Set GenerateFileName to "NONAME"
35802>>>>>
35802>>>>>// Project Object Structure
35802>>>>>//   sl041 is a dbModalPanelSub
35802>>>>>//     Clients_DD is a DataDictionary
35802>>>>>//     Cn_DD is a DataDictionary
35802>>>>>//     oSelList is a dbListSub
35802>>>>>//     oOK_bn is a ButtonSub
35802>>>>>//     oCancel_bn is a ButtonSub
35802>>>>>//     oSearch_bn is a ButtonSub
35802>>>>>
35802>>>>>// Register all objects
35802>>>>>Register_Object Clients_DD
35802>>>>>Register_Object Cn_DD
35802>>>>>Register_Object oCancel_bn
35802>>>>>Register_Object oOK_bn
35802>>>>>Register_Object oSearch_bn
35802>>>>>Register_Object oSelList
35802>>>>>Register_Object sl041
35802>>>>>
35802>>>>>
35802>>>>>//AB-IgnoreStart
35802>>>>>
35802>>>>>Use DFAllEnt.pkg
35802>>>>>Use dbList.Sub
35802>>>>>Use Button.Sub
35802>>>>>
35802>>>>>
35802>>>>>Use CLIENTS.DD
INCLUDING FILE: CLIENTS.DD
35802>>>>>>>//DDB-FileStart
35802>>>>>>>//DDB-HeaderStart
35802>>>>>>>
35802>>>>>>>// File Name : CLIENTS.DD
35802>>>>>>>// Class Name: Clients_DataDictionary
35802>>>>>>>// Revision  : 229
35802>>>>>>>// Version   : 2
35802>>>>>>>
35802>>>>>>>Use  Windows           // Basic Definitions
35802>>>>>>>Use  DataDict          // DataDictionary Class Definition
35802>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
35802>>>>>>>
35802>>>>>>>Open Clients
35804>>>>>>>Open Cmoves
INCLUDING FILE: CMOVES.FD
35806>>>>>>>Open Particle
INCLUDING FILE: PARTICLE.FD
35808>>>>>>>Open Cmovesa
INCLUDING FILE: CMOVESA.FD
35810>>>>>>>Open Cn
35812>>>>>>>Open Particll
INCLUDING FILE: PARTICLL.FD
35814>>>>>>>Open Clnbank
INCLUDING FILE: CLNBANK.FD
35816>>>>>>>Open Tpclient
INCLUDING FILE: TPCLIENT.FD
35818>>>>>>>Open Clorder
INCLUDING FILE: CLORDER.FD
35820>>>>>>>Open Clitem
INCLUDING FILE: CLITEM.FD
35822>>>>>>>Open Cities
35824>>>>>>>Open Areas
35826>>>>>>>Open Payresp
35828>>>>>>>Open Syscurxr
35830>>>>>>>Open Sysrecc
INCLUDING FILE: SYSRECC.FD
35832>>>>>>>
35832>>>>>>>//DDB-HeaderEnd
35832>>>>>>>//DDB-ValidationStart
35832>>>>>>>
35832>>>>>>>Register_Object Clients_Client_Doy_VT
35832>>>>>>>Register_Object Clients_Client_Job_VT
35832>>>>>>>Register_Object Clients_Client_Categfpa_VT
35832>>>>>>>Register_Object Clients_Client_Catjob_VT1
35832>>>>>>>Register_Object Clients_Client_Idiot_VT
35832>>>>>>>Register_Object Clients_Feregios_VT
35832>>>>>>>
35832>>>>>>>Object Clients_Client_Doy_VT  is a CodeValidationTable
35834>>>>>>>    Set Type_Value        To "DOY"
35835>>>>>>>    Set Validate_State    To FALSE
35836>>>>>>>    Set Allow_Blank_State To TRUE
35837>>>>>>>    Set Table_Title       To "ƒ.Ž.“"
35838>>>>>>>    //DDB-ValidationCustomStart
35838>>>>>>>    //DDB-ValidationCustomEnd
35838>>>>>>>End_Object   // Clients_Client_Doy_VT
35839>>>>>>>
35839>>>>>>>Object Clients_Client_Job_VT  is a CodeValidationTable
35841>>>>>>>    Set Type_Value        To "JOB"
35842>>>>>>>    Set Validate_State    To FALSE
35843>>>>>>>    Set Allow_Blank_State To TRUE
35844>>>>>>>    Set Table_Title       To "„§˜ššâ¢£˜«˜"
35845>>>>>>>    //DDB-ValidationCustomStart
35845>>>>>>>    //DDB-ValidationCustomEnd
35845>>>>>>>End_Object   // Clients_Client_Job_VT
35846>>>>>>>
35846>>>>>>>Object Clients_Client_Categfpa_VT  is a CodeValidationTable
35848>>>>>>>    Set Type_Value        To "VAT_STATUS"
35849>>>>>>>    Set Validate_State    To FALSE
35850>>>>>>>    Set Allow_Blank_State To TRUE
35851>>>>>>>    //DDB-ValidationCustomStart
35851>>>>>>>    //DDB-ValidationCustomEnd
35851>>>>>>>End_Object   // Clients_Client_Categfpa_VT
35852>>>>>>>
35852>>>>>>>Object Clients_Client_Catjob_VT1  is a CodeValidationTable
35854>>>>>>>    Set Type_Value        To "JOB"
35855>>>>>>>    Set Validate_State    To FALSE
35856>>>>>>>    Set Allow_Blank_State To TRUE
35857>>>>>>>    //DDB-ValidationCustomStart
35857>>>>>>>    //DDB-ValidationCustomEnd
35857>>>>>>>End_Object   // Clients_Client_Catjob_VT1
35858>>>>>>>
35858>>>>>>>Object Clients_Client_Idiot_VT  is a CodeValidationTable
35860>>>>>>>    Set Type_Value        To "IDIOT"
35861>>>>>>>    Set Validate_State    To FALSE
35862>>>>>>>    Set Allow_Blank_State To TRUE
35863>>>>>>>    Set Table_Title       To "€¨®œå¦ ˆ› ¦«ã«à¤"
35864>>>>>>>    //DDB-ValidationCustomStart
35864>>>>>>>    //DDB-ValidationCustomEnd
35864>>>>>>>End_Object   // Clients_Client_Idiot_VT
35865>>>>>>>
35865>>>>>>>Object Clients_Feregios_VT  is a CodeValidationTable
35867>>>>>>>    Set Type_Value        To "FEREGIOS"
35868>>>>>>>    Set Allow_Blank_State To TRUE
35869>>>>>>>    Set Table_Title       To "ƒœå¡«œª ”œ¨œšš¬æ«ž«˜ª ”¦¨âà¤"
35870>>>>>>>    //DDB-ValidationCustomStart
35870>>>>>>>    //DDB-ValidationCustomEnd
35870>>>>>>>End_Object   // Clients_Feregios_VT
35871>>>>>>>//DDB-ValidationEnd
35871>>>>>>>//DDB-SelectionStart
35871>>>>>>>//DDB/ ExternalSelectionList sl100  sl100.SL
35871>>>>>>>Register_Object sl100
35871>>>>>>>//DDB-SelectionEnd
35871>>>>>>>Open Sysfile
35873>>>>>>>open year
35875>>>>>>>
35875>>>>>>>Class Clients_DataDictionary  is a DataDictionary_Sec
35876>>>>>>>
35876>>>>>>>    Procedure Construct_Object
35877>>>>>>>        Forward Send Construct_Object
35879>>>>>>>        Property Integer piMustNOTConstrain Public 0
35880>>>>>>>        Property Integer piCheckPlaf        Public 0
35881>>>>>>>    End_Procedure
35882>>>>>>>
35882>>>>>>>    // Backout:
35882>>>>>>>    Procedure Backout
35883>>>>>>>        Forward Send Backout
35885>>>>>>>        // Insert Code Here
35885>>>>>>>    End_Procedure   // Backout
35886>>>>>>>
35886>>>>>>>
35886>>>>>>>
35886>>>>>>>    Procedure Update
35887>>>>>>>        Forward Send Update
35889>>>>>>>        // Insert Code Here
35889>>>>>>>        Move SysCurXR.Company_Code  to Clients.Company_Code
35890>>>>>>>        Move SysCurXR.Branch_Code   to Clients.Branch_Code
35891>>>>>>>        Move SysCurXR.Year_Year     to Clients.Year_Year
35892>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
35892>>>>>>>        Move (Clients.Xreosh-Clients.Pistosh)   to Clients.Ypoloipo
35893>>>>>>>        Move (Clients.Plafon-Clients.Ypoloipo)  to Clients.Overhead
35894>>>>>>>
35894>>>>>>>        //Move Clients.Client_Address     to Clients.Client_LastUpd
35894>>>>>>>
35894>>>>>>>        //betolink
35894>>>>>>>        Move SysCurXR.Beto_Site      to Clients.Client_SiteW
35895>>>>>>>        Move Clients.Client_Rec0     to Clients.Client_SN
35896>>>>>>>        Move Clients.Client_id       to Clients.Client_Repm
35897>>>>>>>        Move Clients.Company_Code    to Clients.CLIENT_COMPANY
35898>>>>>>>        Move Clients.Client_id       to Clients.Client_RepMatch
35899>>>>>>>     //   Move (gsfCode_Mast('JOB',Clients.Client_CatJob)) to Clients.Client_Job
35899>>>>>>>    End_Procedure   // Update
35900>>>>>>>
35900>>>>>>>
35900>>>>>>>    Procedure Creating
35901>>>>>>>        date ddate iYes
35902>>>>>>>        Forward Send Creating
35904>>>>>>>        // Insert Code Here
35904>>>>>>>
35904>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Clients.Client_Rec0))))));                                    to Clients.Client_Recr
35905>>>>>>>        Move '1'                    to Clients.Client_Active
35906>>>>>>>        get fsgCode_With_Zeroes Clients.Client_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to Clients.Client_ID
35907>>>>>>>        sysdate4 ddate
35908>>>>>>>        move ddate                  to Clients.Client_Hmnia
35909>>>>>>>        clear year
35910>>>>>>>        move syscurxr.company_code  to year.company_code
35911>>>>>>>        move syscurxr.branch_code   to year.branch_code
35912>>>>>>>        move syscurxr.year_year     to year.year_year
35913>>>>>>>        find eq year by index.1
35914>>>>>>>>
35914>>>>>>>        If (found=1) begin
35916>>>>>>>            move year.clients_plafon to clients.plafon
35917>>>>>>>            move year.clients_ofeilh to clients.orio_syn_ofeilh
35918>>>>>>>        end
35918>>>>>>>>
35918>>>>>>>    End_Procedure   // Creating
35919>>>>>>>
35919>>>>>>>    Function Validate_Save  Returns Integer
35920>>>>>>>        Integer iReturnVal iCheck iYes
35921>>>>>>>        Forward Get Validate_Save  To iReturnVal
35923>>>>>>>        If (Not(iReturnVal)) Begin
35925>>>>>>>
35925>>>>>>>            If (clients.is_eksoter <> '1') begin
35927>>>>>>>                If (Clients.Is_Xondr='1') Begin
35929>>>>>>>                    If (Sysfile.Check_Afm=1) Begin
35931>>>>>>>                        Move (Check_AFM(Clients.Client_Afm)) to iCheck
35932>>>>>>>                        If (iCheck) Begin
35934>>>>>>>                                 If (iCheck=1) Move 4001 to iReturnVal
35937>>>>>>>                            Else If (iCheck=2) Move 4002 to iReturnVal
35941>>>>>>>                            Else If (iCheck=3) Move 4003 to iReturnVal
35945>>>>>>>                        End
35945>>>>>>>>
35945>>>>>>>                    End
35945>>>>>>>>
35945>>>>>>>                End
35945>>>>>>>>
35945>>>>>>>            End
35945>>>>>>>>
35945>>>>>>>
35945>>>>>>>            If (piCheckPlaf(Self)=1) Begin
35947>>>>>>>                If ((Clients.Plafon>0) And ((Clients.Ypoloipo+Clients.Posa_Apo_Dap)>Clients.Plafon)) Begin
35949>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4000 Clients' to iYes
35950>>>>>>>                    If (iYes=MBR_NO) Error 4004 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž' //Move 4004 to iReturnVal
35953>>>>>>>                End
35953>>>>>>>>
35953>>>>>>>                Else If ((PayResp.Plafon<>0) And (PayResp.Plafon<=PayResp.Synolikh_Ofeilh)) Begin
35956>>>>>>>                    Get YesNo_Box 'Ž ¬§œçŸ¬¤¦ª §¢ž¨à£ãª ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž\nŒ˜ ©¬¤œ®å©à ©«ž¤ ›ž£ ¦¬¨šå˜ œšš¨˜­ãª §œ¢á«ž;' to iYes
35957>>>>>>>                    If (iYes=MBR_NO) Error 4005 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
35960>>>>>>>                End
35960>>>>>>>>
35960>>>>>>>                Else If ((Clients.Orio_Syn_Ofeilh>0) And (Clients.Synolikh_Ofeilh>Clients.Orio_Syn_Ofeilh)) Begin
35963>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4001 Clients' to iYes
35964>>>>>>>                    If (iYes=MBR_NO) Error 4005 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
35967>>>>>>>                End
35967>>>>>>>>
35967>>>>>>>                Else If ((Clients.Orio_Syn_Ofeilh>0) And (PayResp.Orio_Syn_Ofeilh>0) And (Clients.Synolikh_Ofeilh>Payresp.Orio_Syn_Ofeilh)) Begin
35970>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4002 Clients' to iYes
35971>>>>>>>                    If (iYes=MBR_NO) Error 4006 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'   //Move 4006 to iReturnVal
35974>>>>>>>                End
35974>>>>>>>>
35974>>>>>>>                If ((Clients.Plafon>0) And ((Clients.Ypoloipo+Clients.Posa_Apo_Parag)>Clients.Plafon)) Begin
35976>>>>>>>                    Send Info_Box '’˜ §¦©á «à¤ ž£œ¨ž©åà¤ §˜¨˜ššœ¢ é¤\n¬§œ¨™˜å¤¦¬¤ «¦ › ˜Ÿâ© £¦ ¬§æ¢¦ §¦\n™á©ž §¢˜­æ¤ «¦¬ §œ¢á«ž' '¨¦©¦®ã !!!'
35977>>>>>>>                End
35977>>>>>>>>
35977>>>>>>>            End
35977>>>>>>>>
35977>>>>>>>
35977>>>>>>>            If (iReturnVal) Begin
35979>>>>>>>                Send Operation_Not_Allowed iReturnVal
35980>>>>>>>            End
35980>>>>>>>>
35980>>>>>>>        End
35980>>>>>>>>
35980>>>>>>>        Function_Return iReturnVal
35981>>>>>>>    End_Function   // Validate_Save
35982>>>>>>>
35982>>>>>>>
35982>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
35983>>>>>>>        String lsError_Message
35984>>>>>>>
35984>>>>>>>        Case Begin
35984>>>>>>>            Case (iError_Num = 4001)
35986>>>>>>>                Move "DDC 100: Š˜¤Ÿ˜©£â¤¦ €”‹ œ¢á«ž" ;                    to lsError_Message
35987>>>>>>>              Case Break
35988>>>>>>>            Case (iError_Num = 4002)
35991>>>>>>>                Move "DDC 100: ’¦ €”‹ œ¢á«ž ›œ¤ œå¤˜  9 ¯ã­ ¦" ;                    to lsError_Message
35992>>>>>>>              Case Break
35993>>>>>>>            Case (iError_Num = 4003)
35996>>>>>>>                Move "DDC 100: €¡˜«á¢¢ž¢¦ª ®˜¨˜¡«ã¨˜ª ©«¦ €”‹ œ¢á«ž" ;                    to lsError_Message
35997>>>>>>>              Case Break
35998>>>>>>>            Case (iError_Num = 4004)
36001>>>>>>>                Move "DDC 100: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ §œ¢á«ž" ;                    to lsError_Message
36002>>>>>>>              Case Break
36003>>>>>>>            Case (iError_Num = 4005)
36006>>>>>>>                Move "DDC 100: † ©¬¤¦¢ ¡ã ¦­œ ¢ã ¬§œ¨™˜å¤œ \n«¦ æ¨ ¦ ©¬¤¦¢ ¡ãª ¦­œ ¢ãª" ;                    to lsError_Message
36007>>>>>>>              Case Break
36008>>>>>>>            Case (iError_Num = 4006)
36011>>>>>>>                Move "DDC 100: † ©¬¤¦¢ ¡ã ¦­œ ¢ã ¬§œ¨™˜å¤œ \n«¦ æ¨ ¦ ©¬¤¦¢ ¡ãª ¦­œ ¢ãª «¦¬ “§œ¬Ÿç¤¦¬" ;                    to lsError_Message
36012>>>>>>>              Case Break
36013>>>>>>>
36013>>>>>>>            Case Else
36013>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
36015>>>>>>>        Case End
36015>>>>>>>
36015>>>>>>>        Error iError_Num lsError_Message
36016>>>>>>>>
36016>>>>>>>    End_Procedure // operation_not_allowed
36017>>>>>>>
36017>>>>>>>
36017>>>>>>>    // Define_Fields:
36017>>>>>>>    // This procedure is used to set up all data-dictionary rules.
36017>>>>>>>
36017>>>>>>>    Procedure Define_Fields
36018>>>>>>>        Forward Send Define_Fields
36020>>>>>>>        //DDB-Generated-Code-Location
36020>>>>>>>        //DDB-DefineFieldStart
36020>>>>>>>
36020>>>>>>>        Set Main_File            To Clients.File_Number
36021>>>>>>>        Set Cascade_Delete_State To FALSE
36022>>>>>>>
36022>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
36023>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
36024>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
36025>>>>>>>
36025>>>>>>>        // Child (Client) file structure................
36025>>>>>>>        Send Add_Client_File  Cmoves.File_Number
36026>>>>>>>        Send Add_Client_File  Particle.File_Number
36027>>>>>>>        Send Add_Client_File  Cmovesa.File_Number
36028>>>>>>>        Send Add_Client_File  Cn.File_Number
36029>>>>>>>        Send Add_Client_File  Particll.File_Number
36030>>>>>>>        Send Add_Client_File  Clnbank.File_Number
36031>>>>>>>        Send Add_Client_File  Tpclient.File_Number
36032>>>>>>>        Send Add_Client_File  Clorder.File_Number
36033>>>>>>>        Send Add_Client_File  Clitem.File_Number
36034>>>>>>>
36034>>>>>>>        // Parent (Server) file structure...............
36034>>>>>>>        Send Add_Server_File  Cities.File_Number
36035>>>>>>>        Send Add_Server_File  Areas.File_Number
36036>>>>>>>        Send Add_Server_File  Payresp.File_Number
36037>>>>>>>
36037>>>>>>>        // External (System) file structure.............
36037>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
36038>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
36039>>>>>>>
36039>>>>>>>        Define_Auto_Increment  Sysrecc.Client_Rec0  To Clients.Client_Rec0
36042>>>>>>>
36042>>>>>>>        // Field-based properties.......................
36042>>>>>>>
36042>>>>>>>        // Clients.Company_Code
36042>>>>>>>
36042>>>>>>>        // Clients.Branch_Code
36042>>>>>>>
36042>>>>>>>        // Clients.Year_Year
36042>>>>>>>
36042>>>>>>>        // Clients.Custprom_Code
36042>>>>>>>
36042>>>>>>>        // Clients.Client_Id
36042>>>>>>>        Set Field_Options          Field Clients.Client_Id To DD_AUTOFIND    DD_NOPUT
36043>>>>>>>        Set Field_Prompt_Object    Field Clients.Client_Id To (sl100(Self))
36044>>>>>>>        Set Key_Field_State        Field Clients.Client_Id To TRUE
36045>>>>>>>
36045>>>>>>>        // Clients.Client_Name
36045>>>>>>>        Set Field_Prompt_Object    Field Clients.Client_Name To (sl100(Self))
36046>>>>>>>
36046>>>>>>>        // Clients.Client_Afm
36046>>>>>>>        Set Field_Options          Field Clients.Client_Afm To DD_AUTOFIND
36047>>>>>>>
36047>>>>>>>        // Clients.Client_Rec0
36047>>>>>>>        Set Field_Options          Field Clients.Client_Rec0 To DD_AUTOFIND
36048>>>>>>>
36048>>>>>>>        // Clients.Custprom_Recr
36048>>>>>>>
36048>>>>>>>        // Clients.Client_Recr
36048>>>>>>>        Set Field_Options          Field Clients.Client_Recr To DD_AUTOFIND
36049>>>>>>>
36049>>>>>>>        // Clients.Last_Xreosh
36049>>>>>>>
36049>>>>>>>        // Clients.Last_Pistosh
36049>>>>>>>
36049>>>>>>>        // Clients.Last_Order
36049>>>>>>>        Set Field_Class_Name       Field Clients.Last_Order To "dbComboFormSub"
36050>>>>>>>
36050>>>>>>>        // Clients.Client_Doy
36050>>>>>>>        Set Field_Value_Table      Field Clients.Client_Doy To (Clients_Client_Doy_VT(Self))
36051>>>>>>>
36051>>>>>>>        // Clients.Client_Address
36051>>>>>>>
36051>>>>>>>        // Clients.Client_City_Id
36051>>>>>>>
36051>>>>>>>        // Clients.Client_Area
36051>>>>>>>
36051>>>>>>>        // Clients.Client_Job
36051>>>>>>>        Set Field_Value_Table      Field Clients.Client_Job To (Clients_Client_Job_VT(Self))
36052>>>>>>>
36052>>>>>>>        // Clients.Client_Respons
36052>>>>>>>
36052>>>>>>>        // Clients.Client_Zipcode
36052>>>>>>>
36052>>>>>>>        // Clients.Client_Phone
36052>>>>>>>
36052>>>>>>>        // Clients.Client_Fax
36052>>>>>>>
36052>>>>>>>        // Clients.Client_Mobile
36052>>>>>>>
36052>>>>>>>        // Clients.Client_Aoh
36052>>>>>>>
36052>>>>>>>        // Clients.Client_Email
36052>>>>>>>
36052>>>>>>>        // Clients.Client_Class
36052>>>>>>>
36052>>>>>>>        // Clients.Client_Details
36052>>>>>>>
36052>>>>>>>        // Clients.Client_Sitew
36052>>>>>>>
36052>>>>>>>        // Clients.Client_Codem
36052>>>>>>>
36052>>>>>>>        // Clients.Client_Categfpa
36052>>>>>>>        Set Field_Value_Table      Field Clients.Client_Categfpa To (Clients_Client_Categfpa_VT(Self))
36053>>>>>>>
36053>>>>>>>        // Clients.Client_Fpa
36053>>>>>>>
36053>>>>>>>        // Clients.Client_Public
36053>>>>>>>
36053>>>>>>>        // Clients.Client_Sn
36053>>>>>>>
36053>>>>>>>        // Clients.Client_Repm
36053>>>>>>>
36053>>>>>>>        // Clients.Client_Active
36053>>>>>>>
36053>>>>>>>        // Clients.Client_Reported
36053>>>>>>>
36053>>>>>>>        // Clients.Client_Pelprom
36053>>>>>>>
36053>>>>>>>        // Clients.Client_Lastupd
36053>>>>>>>
36053>>>>>>>        // Clients.Client_Markexp
36053>>>>>>>
36053>>>>>>>        // Clients.Client_Catjob
36053>>>>>>>        Set Field_Value_Table      Field Clients.Client_Catjob To (Clients_Client_Catjob_VT1(Self))
36054>>>>>>>
36054>>>>>>>        // Clients.Is_Promhtheyths
36054>>>>>>>
36054>>>>>>>        // Clients.Xreosh
36054>>>>>>>
36054>>>>>>>        // Clients.Pistosh
36054>>>>>>>
36054>>>>>>>        // Clients.Ypoloipo
36054>>>>>>>
36054>>>>>>>        // Clients.Plafon
36054>>>>>>>
36054>>>>>>>        // Clients.Overhead
36054>>>>>>>
36054>>>>>>>        // Clients.Client_Company
36054>>>>>>>
36054>>>>>>>        // Clients.Client_Repmatch
36054>>>>>>>
36054>>>>>>>        // Clients.Client_Hmnia
36054>>>>>>>
36054>>>>>>>        // Clients.Client_Presp
36054>>>>>>>
36054>>>>>>>        // Clients.Client_Locked
36054>>>>>>>
36054>>>>>>>        // Clients.Synolikh_Ofeilh
36054>>>>>>>
36054>>>>>>>        // Clients.Client_Idiot
36054>>>>>>>        Set Field_Value_Table      Field Clients.Client_Idiot To (Clients_Client_Idiot_VT(Self))
36055>>>>>>>
36055>>>>>>>        // Clients.Client_Add_No
36055>>>>>>>
36055>>>>>>>        // Clients.Client_Nomos
36055>>>>>>>
36055>>>>>>>        // Clients.Client_Xora
36055>>>>>>>
36055>>>>>>>        // Clients.Polh_Recr
36055>>>>>>>
36055>>>>>>>        // Clients.Presp_Id
36055>>>>>>>
36055>>>>>>>        // Clients.Sum_Pct_Tpcl
36055>>>>>>>
36055>>>>>>>        // Clients.Is_Client
36055>>>>>>>
36055>>>>>>>        // Clients.Sysxetish
36055>>>>>>>
36055>>>>>>>        // Clients.Poso_Se_Apait
36055>>>>>>>
36055>>>>>>>        // Clients.Client_Glcode
36055>>>>>>>
36055>>>>>>>        // Clients.Is_Eksoter
36055>>>>>>>
36055>>>>>>>        // Clients.Is_Xondr
36055>>>>>>>
36055>>>>>>>        // Clients.Orio_Syn_Ofeilh
36055>>>>>>>
36055>>>>>>>        // Clients.Posa_Apo_Dap
36055>>>>>>>
36055>>>>>>>        // Clients.Client_Doybtm
36055>>>>>>>
36055>>>>>>>        // Clients.Posa_Apo_Parag
36055>>>>>>>
36055>>>>>>>        // Clients.Client_Ptyppar
36055>>>>>>>
36055>>>>>>>        // Clients.Client_Seira
36055>>>>>>>
36055>>>>>>>        // Clients.Hpso
36055>>>>>>>
36055>>>>>>>        // Clients.Hpal
36055>>>>>>>
36055>>>>>>>        // Clients.Feregios
36055>>>>>>>        Set Field_Value_Table      Field Clients.Feregios To (Clients_Feregios_VT(Self))
36056>>>>>>>
36056>>>>>>>        // Clients.Diakin
36056>>>>>>>
36056>>>>>>>        //DDB-DefineFieldEnd
36056>>>>>>>    End_Procedure    // Define_Fields
36057>>>>>>>
36057>>>>>>>    // Field_Defaults:
36057>>>>>>>    // This procedure is used to establish default field values.
36057>>>>>>>
36057>>>>>>>    Procedure Field_Defaults
36058>>>>>>>        Forward Send Field_Defaults
36060>>>>>>>        //DDB-Generated-Code-Location
36060>>>>>>>        //DDB-FieldDefaultStart
36060>>>>>>>        Set Field_Changed_Value   Field Clients.Client_Doy To "0"
36061>>>>>>>        //DDB-FieldDefaultEnd
36061>>>>>>>    End_Procedure    // Field_Defaults
36062>>>>>>>
36062>>>>>>>End_Class    // Clients_DataDictionary
36063>>>>>>>//DDB-Selection-pkg-Start
36063>>>>>>>
36063>>>>>>>Use sl100.SL        // sl100
INCLUDING FILE: SL100.SL
36063>>>>>>>>>//AB/ Project SL100:PELATES
36063>>>>>>>>>//AB/     Object prj is a Lookup_Project
36063>>>>>>>>>//AB/         Set ProjectName to "SL100:PELATES"
36063>>>>>>>>>//AB/         Set ProjectFileName to "SL100.SL"
36063>>>>>>>>>
36063>>>>>>>>>// Project Object Structure
36063>>>>>>>>>//   sl100 is a dbModalPanelSub
36063>>>>>>>>>//     Clients_DD is a DataDictionary
36063>>>>>>>>>//     oSelList is a dbListSub
36063>>>>>>>>>//     oOK_bn is a ButtonSub
36063>>>>>>>>>//     oCancel_bn is a ButtonSub
36063>>>>>>>>>//     oSearch_bn is a ButtonSub
36063>>>>>>>>>
36063>>>>>>>>>// Register all objects
36063>>>>>>>>>Register_Object Clients_DD
36063>>>>>>>>>Register_Object oCancel_bn
36063>>>>>>>>>Register_Object oOK_bn
36063>>>>>>>>>Register_Object oSearch_bn
36063>>>>>>>>>Register_Object oSelList
36063>>>>>>>>>Register_Object sl100
36063>>>>>>>>>
36063>>>>>>>>>
36063>>>>>>>>>    //AB-IgnoreStart
36063>>>>>>>>>
36063>>>>>>>>>    Use DFAllEnt.pkg
36063>>>>>>>>>    Use dbList.Sub
36063>>>>>>>>>    Use Button.Sub
36063>>>>>>>>>
36063>>>>>>>>>
36063>>>>>>>>>    Use CLIENTS.DD
36063>>>>>>>>>    
36063>>>>>>>>>    //AB-IgnoreEnd
36063>>>>>>>>>
36063>>>>>>>>>    Object sl100 is a dbModalPanelSub
36065>>>>>>>>>
36065>>>>>>>>>        //AB-StoreTopStart
36065>>>>>>>>>                
36065>>>>>>>>>        Property String     FragmaClient        Public ''
36067>>>>>>>>>        Property String     psIsPromhtheyths    Public ''
36069>>>>>>>>>        Property Integer    piMustConstrain     Public  0
36071>>>>>>>>>        Property String     psModule            Public ''
36073>>>>>>>>>        
36073>>>>>>>>>        //AB-StoreTopEnd
36073>>>>>>>>>
36073>>>>>>>>>        Set Label to "(Xlate(Label(Self)))"
36074>>>>>>>>>        Set Size to 252 509
36075>>>>>>>>>        Set Location to 4 5
36076>>>>>>>>>        Set Popup_State to TRUE
36077>>>>>>>>>
36077>>>>>>>>>        //AB-DDOStart
36077>>>>>>>>>
36077>>>>>>>>>        Object Clients_DD is a Clients_DataDictionary
36079>>>>>>>>>
36079>>>>>>>>>            //AB-StoreTopStart
36079>>>>>>>>>                        
36079>>>>>>>>>            //AB-StoreTopEnd
36079>>>>>>>>>
36079>>>>>>>>>
36079>>>>>>>>>            //AB-StoreStart
36079>>>>>>>>>                        
36079>>>>>>>>>            Begin_Constraints
36081>>>>>>>>>                     If (psModule(Self)='01') Constrain Clients.is_Client        Eq '1'
36085>>>>>>>>>                Else If (psModule(Self)='02') Constrain Clients.is_Promhtheyths  Eq '1'
36090>>>>>>>>>            End_Constraints
36093>>>>>>>>>            
36093>>>>>>>>>            
36093>>>>>>>>>            
36093>>>>>>>>>            //AB-StoreEnd
36093>>>>>>>>>
36093>>>>>>>>>        End_Object    // Clients_DD
36094>>>>>>>>>
36094>>>>>>>>>        Set Main_DD to (Clients_DD(self))
36095>>>>>>>>>        Set Server to (Clients_DD(self))
36096>>>>>>>>>
36096>>>>>>>>>        //AB-DDOEnd
36096>>>>>>>>>
36096>>>>>>>>>        Object oSelList is a dbListSub
36098>>>>>>>>>            Set Main_File to Clients.File_Number
36099>>>>>>>>>            Set Ordering to 6
36100>>>>>>>>>            Set Size to 204 496
36101>>>>>>>>>            Set Location to 7 5
36102>>>>>>>>>            Set Auto_Index_State to FALSE
36103>>>>>>>>>            Set Modal_State to TRUE
36104>>>>>>>>>
36104>>>>>>>>>            Begin_Row
36107>>>>>>>>>                Entry_Item Clients.Client_id
36108>>>>>>>>>                Entry_Item Clients.Client_name
36109>>>>>>>>>                Entry_Item Clients.Client_afm
36110>>>>>>>>>                Entry_Item Clients.Last_xreosh
36111>>>>>>>>>                Entry_Item Clients.Last_pistosh
36112>>>>>>>>>                Entry_Item Clients.Last_order
36113>>>>>>>>>                Entry_Item Clients.Is_client
36114>>>>>>>>>                Entry_Item Clients.Is_promhtheyths
36115>>>>>>>>>            End_Row
36120>>>>>>>>>
36120>>>>>>>>>            Set Form_Width    item 0 to 64
36121>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
36122>>>>>>>>>            
36122>>>>>>>>>            Set Form_Width    item 1 to 133
36123>>>>>>>>>            Set Header_Label  item 1 to "„§à¤¬£å˜"
36124>>>>>>>>>            
36124>>>>>>>>>            Set Form_Width    item 2 to 62
36125>>>>>>>>>            Set Header_Label  item 2 to "€”‹"
36126>>>>>>>>>            
36126>>>>>>>>>            Set Form_Width    item 3 to 60
36127>>>>>>>>>            Set Header_Label  item 3 to "’œ¢. •¨âà©ž"
36128>>>>>>>>>            
36128>>>>>>>>>            Set Form_Width    item 4 to 60
36129>>>>>>>>>            Set Header_Label  item 4 to "’œ¢. å©«à©ž"
36130>>>>>>>>>            
36130>>>>>>>>>            Set Form_Width    item 5 to 60
36131>>>>>>>>>            Set Header_Label  item 5 to "’œ¢. ˜¨˜š"
36132>>>>>>>>>            
36132>>>>>>>>>            Set Form_Width    item 6 to 26
36133>>>>>>>>>            Set Header_Label  item 6 to "œ¢"
36134>>>>>>>>>            Set Column_Checkbox_State  item 6 to True
36135>>>>>>>>>            
36135>>>>>>>>>            Set Form_Width    item 7 to 26
36136>>>>>>>>>            Set Header_Label  item 7 to "¨¦£"
36137>>>>>>>>>            Set Column_Checkbox_State  item 7 to True
36138>>>>>>>>>            
36138>>>>>>>>>
36138>>>>>>>>>            //AB-StoreStart
36138>>>>>>>>>            
36138>>>>>>>>>            //Property String StoreFragmaClient   Public ''
36138>>>>>>>>>            //Property String StorePsModule       Public ''
36138>>>>>>>>>            
36138>>>>>>>>>            //Procedure Store_Defaults
36138>>>>>>>>>            //    Forward Send Store_Defaults
36138>>>>>>>>>            //    Set StoreFragmaClient   to (FragmaClient(Self))
36138>>>>>>>>>            //    Set StorePsModule       to (psModule    (Self))
36138>>>>>>>>>            //End_Procedure
36138>>>>>>>>>            
36138>>>>>>>>>            //Procedure ReStore_Defaults
36138>>>>>>>>>            //    Forward Send ReStore_Defaults
36138>>>>>>>>>            //    Set FragmaClient to (StoreFragmaClient(Self))
36138>>>>>>>>>            //    Set psModule     to (StorePsModule    (Self))
36138>>>>>>>>>            //End_Procedure
36138>>>>>>>>>            
36138>>>>>>>>>            Set Column_Option Item 6 to NoEnter True
36139>>>>>>>>>            Set Column_Option Item 7 to NoEnter True
36140>>>>>>>>>            
36140>>>>>>>>>            Procedure Activating
36142>>>>>>>>>                Forward Send Activating
36144>>>>>>>>>                Set Auto_Index_State to True
36145>>>>>>>>>            End_Procedure
36146>>>>>>>>>            
36146>>>>>>>>>            Procedure Activate
36148>>>>>>>>>                Send Rebuild_Constraints    to Clients_DD
36149>>>>>>>>>                If (FragmaClient(Self)<>'') Begin
36151>>>>>>>>>                    Clear Clients
36152>>>>>>>>>                    Move (FragmaClient(Self)) to Clients.Client_ID
36153>>>>>>>>>                    Find Eq Clients By Index.6
36154>>>>>>>>>>
36154>>>>>>>>>                    If (Found) Send Request_Find to Clients_DD Eq Clients.File_Number 6
36157>>>>>>>>>                End
36157>>>>>>>>>>
36157>>>>>>>>>                Forward Send Activate
36159>>>>>>>>>            End_procedure
36160>>>>>>>>>            
36160>>>>>>>>>            
36160>>>>>>>>>            
36160>>>>>>>>>            
36160>>>>>>>>>            //AB-StoreEnd
36160>>>>>>>>>
36160>>>>>>>>>        End_Object    // oSelList
36161>>>>>>>>>
36161>>>>>>>>>        Object oOK_bn is a ButtonSub
36163>>>>>>>>>            Set Label to "&„§ ¢¦šã"
36164>>>>>>>>>            Set Location to 218 341
36165>>>>>>>>>
36165>>>>>>>>>            //AB-StoreStart
36165>>>>>>>>>            Procedure OnClick
36167>>>>>>>>>                Send OK To (oSelList(current_object))
36168>>>>>>>>>            End_Procedure
36169>>>>>>>>>            //AB-StoreEnd
36169>>>>>>>>>
36169>>>>>>>>>        End_Object    // oOK_bn
36170>>>>>>>>>
36170>>>>>>>>>        Object oCancel_bn is a ButtonSub
36172>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
36173>>>>>>>>>            Set Location to 218 396
36174>>>>>>>>>
36174>>>>>>>>>            //AB-StoreStart
36174>>>>>>>>>            Procedure OnClick
36176>>>>>>>>>                Send Cancel To (oSelList(current_object))
36177>>>>>>>>>            End_Procedure
36178>>>>>>>>>            //AB-StoreEnd
36178>>>>>>>>>
36178>>>>>>>>>        End_Object    // oCancel_bn
36179>>>>>>>>>
36179>>>>>>>>>        Object oSearch_bn is a ButtonSub
36181>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
36182>>>>>>>>>            Set Location to 218 451
36183>>>>>>>>>
36183>>>>>>>>>            //AB-StoreStart
36183>>>>>>>>>            Procedure OnClick
36185>>>>>>>>>                Send Search To (oSelList(current_object))
36186>>>>>>>>>            End_Procedure
36187>>>>>>>>>            //AB-StoreEnd
36187>>>>>>>>>
36187>>>>>>>>>        End_Object    // oSearch_bn
36188>>>>>>>>>
36188>>>>>>>>>
36188>>>>>>>>>        //AB-StoreStart
36188>>>>>>>>>                
36188>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
36189>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
36190>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
36191>>>>>>>>>        
36191>>>>>>>>>        Set Locate_Mode to Center_On_Screen
36192>>>>>>>>>        Set Modal_State to True
36193>>>>>>>>>        
36193>>>>>>>>>        Procedure Activating Returns Integer
36195>>>>>>>>>            Integer rVal
36196>>>>>>>>>            Forward Get Msg_Activating to rVal
36198>>>>>>>>>                 if (psmodule(self)='01') set label of sl100 to '‰˜«á¢¦š¦ª œ¢˜«é¤'
36201>>>>>>>>>            else if (psmodule(self)='02') set label of sl100 to '‰˜«á¢¦š¦ª ¨¦£žŸœ¬«é¤'
36205>>>>>>>>>            Procedure_Return rVal
36206>>>>>>>>>        End_procedure
36207>>>>>>>>>        
36207>>>>>>>>>        
36207>>>>>>>>>        
36207>>>>>>>>>        
36207>>>>>>>>>        
36207>>>>>>>>>        
36207>>>>>>>>>        
36207>>>>>>>>>        //AB-StoreEnd
36207>>>>>>>>>
36207>>>>>>>>>    End_Object    // sl100
36208>>>>>>>>>
36208>>>>>>>>>//AB/     End_Object    // prj
36208>>>>>>>
36208>>>>>>>//DDB-Selection-pkg-End
36208>>>>>>>//DDB-FileEnd
36208>>>>>Use CN.DD
INCLUDING FILE: CN.DD
36208>>>>>>>//DDB-FileStart
36208>>>>>>>//DDB-HeaderStart
36208>>>>>>>
36208>>>>>>>// File Name : CN.DD
36208>>>>>>>// Class Name: Cn_DataDictionary
36208>>>>>>>// Revision  : 89
36208>>>>>>>// Version   : 2
36208>>>>>>>
36208>>>>>>>Use  Windows           // Basic Definitions
36208>>>>>>>Use  DataDict          // DataDictionary Class Definition
36208>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
36208>>>>>>>
36208>>>>>>>Open Cn
36210>>>>>>>Open Cnzones
INCLUDING FILE: CNZONES.FD
36212>>>>>>>Open Tperga
INCLUDING FILE: TPERGA.FD
36214>>>>>>>Open Btnordh
INCLUDING FILE: BTNORDH.FD
36216>>>>>>>Open Dorderh
INCLUDING FILE: DORDERH.FD
36218>>>>>>>Open Clients
36220>>>>>>>Open Salesmen
36222>>>>>>>Open Mhxanik
36224>>>>>>>Open Constrct
36226>>>>>>>Open Sysrecc
36228>>>>>>>Open Syscurxr
36230>>>>>>>
36230>>>>>>>//DDB-HeaderEnd
36230>>>>>>>//DDB-ValidationStart
36230>>>>>>>
36230>>>>>>>Register_Object Cn_Cn_Categfpa_VT1
36230>>>>>>>Register_Object Cn_Tropos_Metaf_VT
36230>>>>>>>Register_Object Cn_Eidos_Cn_VT
36230>>>>>>>Register_Object Cn_Yesno_VT
36230>>>>>>>
36230>>>>>>>Object Cn_Cn_Categfpa_VT1  is a CodeValidationTable
36232>>>>>>>    Set Type_Value        To "VAT_STATUS"
36233>>>>>>>    Set Validate_State    To FALSE
36234>>>>>>>    Set Allow_Blank_State To TRUE
36235>>>>>>>    //DDB-ValidationCustomStart
36235>>>>>>>    //DDB-ValidationCustomEnd
36235>>>>>>>End_Object   // Cn_Cn_Categfpa_VT1
36236>>>>>>>
36236>>>>>>>Object Cn_Tropos_Metaf_VT  is a CodeValidationTable
36238>>>>>>>    Set Type_Value        To "FORTOSH"
36239>>>>>>>    Set Allow_Blank_State To TRUE
36240>>>>>>>    Set Table_Title       To "’¨æ§¦  ‹œ«˜­¦¨áª"
36241>>>>>>>    //DDB-ValidationCustomStart
36241>>>>>>>    //DDB-ValidationCustomEnd
36241>>>>>>>End_Object   // Cn_Tropos_Metaf_VT
36242>>>>>>>
36242>>>>>>>Object Cn_Eidos_Cn_VT  is a CodeValidationTable
36244>>>>>>>    Set Type_Value        To "EIDOSCN"
36245>>>>>>>    Set Allow_Blank_State To TRUE
36246>>>>>>>    Set Table_Title       To "„å›¦ª „¨š¦¬"
36247>>>>>>>    //DDB-ValidationCustomStart
36247>>>>>>>    //DDB-ValidationCustomEnd
36247>>>>>>>End_Object   // Cn_Eidos_Cn_VT
36248>>>>>>>
36248>>>>>>>Object Cn_Yesno_VT  is a CodeValidationTable
36250>>>>>>>    Set Type_Value        To "YESNO"
36251>>>>>>>    Set Allow_Blank_State To TRUE
36252>>>>>>>    //DDB-ValidationCustomStart
36252>>>>>>>    //DDB-ValidationCustomEnd
36252>>>>>>>End_Object   // Cn_Yesno_VT
36253>>>>>>>//DDB-ValidationEnd
36253>>>>>>>//DDB-SelectionStart
36253>>>>>>>//DDB/ ExternalSelectionList sl041  sl041.sl
36253>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
36253>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
36253>>>>>>>Register_Object sl041
36253>>>>>>>Register_Object sl198
36253>>>>>>>Register_Object sl197
36253>>>>>>>//DDB-SelectionEnd
36253>>>>>>>
36253>>>>>>>Class Cn_DataDictionary  is a DataDictionary_Sec
36254>>>>>>>
36254>>>>>>>
36254>>>>>>>    Procedure Update
36255>>>>>>>        Forward Send Update
36257>>>>>>>        // Insert Code Here
36257>>>>>>>        Move SysCurXR.Company_Code  to CN.Company_Code
36258>>>>>>>        Move SysCurXR.Branch_Code   to CN.Branch_Code
36259>>>>>>>        Move SysCurXR.Year_Year     to CN.Year_Year
36260>>>>>>>        //Move Custprom.Custprom_Code to CN.Custprom_Code
36260>>>>>>>        Move Clients.Client_ID      to CN.Client_ID
36261>>>>>>>
36261>>>>>>>        Move SysCurXR.Beto_Site      to CN.Cn_SiteW
36262>>>>>>>        Move Cn.Cn_Rec0              to CN.Cn_SN
36263>>>>>>>        Move Cn.Client_id            to Cn.Cn_clientid
36264>>>>>>>        Move Cn.cn_code              to Cn.Cn_Repmatch
36265>>>>>>>        Move Cn.Cn_Code              to Cn.Constraction_ID
36266>>>>>>>        Move PayResp.Presp_ID        to Cn.Cn_Presp_ID
36267>>>>>>>        Move Salesmen.Sls_ID         to Cn.Cn_Sls_ID
36268>>>>>>>        Move Constrct.Cnt_ID         to Cn.Cn_Cnt_ID
36269>>>>>>>        Move mhxanik.mhx_id          to Cn.mhxanik_ID
36270>>>>>>>    End_Procedure   // Update
36271>>>>>>>
36271>>>>>>>     Procedure Creating
36272>>>>>>>        Forward Send Creating
36274>>>>>>>        // Insert Code Here
36274>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(CN.CN_Rec0)))))) to CN.CN_Recr
36275>>>>>>>        Get fsgCode_With_Zeroes CN.CN_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to CN.CN_Code
36276>>>>>>>    End_Procedure   // Creating
36277>>>>>>>
36277>>>>>>>
36277>>>>>>>
36277>>>>>>>    // Define_Fields:
36277>>>>>>>    // This procedure is used to set up all data-dictionary rules.
36277>>>>>>>
36277>>>>>>>    Procedure Define_Fields
36278>>>>>>>        Forward Send Define_Fields
36280>>>>>>>        //DDB-Generated-Code-Location
36280>>>>>>>        //DDB-DefineFieldStart
36280>>>>>>>
36280>>>>>>>        Set Main_File            To Cn.File_Number
36281>>>>>>>        Set Cascade_Delete_State To FALSE
36282>>>>>>>
36282>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
36283>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
36284>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
36285>>>>>>>
36285>>>>>>>        // Child (Client) file structure................
36285>>>>>>>        Send Add_Client_File  Cnzones.File_Number
36286>>>>>>>        Send Add_Client_File  Tperga.File_Number
36287>>>>>>>        Send Add_Client_File  Btnordh.File_Number
36288>>>>>>>        Send Add_Client_File  Dorderh.File_Number
36289>>>>>>>
36289>>>>>>>        // Parent (Server) file structure...............
36289>>>>>>>        Send Add_Server_File  Clients.File_Number
36290>>>>>>>        Send Add_Server_File  Salesmen.File_Number
36291>>>>>>>        Send Add_Server_File  Mhxanik.File_Number
36292>>>>>>>        Send Add_Server_File  Constrct.File_Number
36293>>>>>>>
36293>>>>>>>        // External (System) file structure.............
36293>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
36294>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
36295>>>>>>>
36295>>>>>>>        Define_Auto_Increment  Sysrecc.Cn_Rec0  To Cn.Cn_Rec0
36298>>>>>>>
36298>>>>>>>        // Field-based properties.......................
36298>>>>>>>
36298>>>>>>>        // Cn.Company_Code
36298>>>>>>>
36298>>>>>>>        // Cn.Branch_Code
36298>>>>>>>
36298>>>>>>>        // Cn.Year_Year
36298>>>>>>>
36298>>>>>>>        // Cn.Custprom_Code
36298>>>>>>>
36298>>>>>>>        // Cn.Client_Id
36298>>>>>>>
36298>>>>>>>        // Cn.Cn_Code
36298>>>>>>>        Set Field_Options          Field Cn.Cn_Code To DD_AUTOFIND    DD_NOPUT      
36299>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_Code To (sl041(Self))
36300>>>>>>>        Set Key_Field_State        Field Cn.Cn_Code To TRUE
36301>>>>>>>
36301>>>>>>>        // Cn.Client_Recr
36301>>>>>>>
36301>>>>>>>        // Cn.Cn_Rec0
36301>>>>>>>
36301>>>>>>>        // Cn.Cn_Recr
36301>>>>>>>
36301>>>>>>>        // Cn.Cn_Descr
36301>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_Descr To (sl041(Self))
36302>>>>>>>
36302>>>>>>>        // Cn.Cn_Address
36302>>>>>>>
36302>>>>>>>        // Cn.Cn_Zipcode
36302>>>>>>>
36302>>>>>>>        // Cn.Cn_City
36302>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_City To (sl198(Self))
36303>>>>>>>
36303>>>>>>>        // Cn.Cn_Area
36303>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_Area To (sl197(Self))
36304>>>>>>>
36304>>>>>>>        // Cn.Cn_License
36304>>>>>>>
36304>>>>>>>        // Cn.Cn_Responsible
36304>>>>>>>
36304>>>>>>>        // Cn.Cn_Cnt_Recr
36304>>>>>>>
36304>>>>>>>        // Cn.Cn_Cnt_Id
36304>>>>>>>
36304>>>>>>>        // Cn.Cn_Phone
36304>>>>>>>
36304>>>>>>>        // Cn.Cn_Zone
36304>>>>>>>
36304>>>>>>>        // Cn.Cn_Sls_Recr
36304>>>>>>>
36304>>>>>>>        // Cn.Cn_Sls_Id
36304>>>>>>>
36304>>>>>>>        // Cn.Cn_Details
36304>>>>>>>
36304>>>>>>>        // Cn.Cn_Distance
36304>>>>>>>
36304>>>>>>>        // Cn.Cn_Pump
36304>>>>>>>
36304>>>>>>>        // Cn.Cn_Pumplicense
36304>>>>>>>
36304>>>>>>>        // Cn.Cn_Totalstats
36304>>>>>>>
36304>>>>>>>        // Cn.Cn_Analstats
36304>>>>>>>
36304>>>>>>>        // Cn.Cn_Coated
36304>>>>>>>
36304>>>>>>>        // Cn.Cn_Sitew
36304>>>>>>>
36304>>>>>>>        // Cn.Cn_Clientmatch
36304>>>>>>>
36304>>>>>>>        // Cn.Cn_Codematch
36304>>>>>>>
36304>>>>>>>        // Cn.Cn_Pumpid
36304>>>>>>>
36304>>>>>>>        // Cn.Cn_Clientid
36304>>>>>>>
36304>>>>>>>        // Cn.Cn_Sn
36304>>>>>>>
36304>>>>>>>        // Cn.Cn_Repmatch
36304>>>>>>>
36304>>>>>>>        // Cn.Cn_Active
36304>>>>>>>        Set Field_Checkbox_Values  Field Cn.Cn_Active To "A"  "F"
36305>>>>>>>
36305>>>>>>>        // Cn.Cn_Reported
36305>>>>>>>
36305>>>>>>>        // Cn.Cn_Lastupdated
36305>>>>>>>
36305>>>>>>>        // Cn.Cn_Markexp
36305>>>>>>>
36305>>>>>>>        // Cn.Cn_Vdetails
36305>>>>>>>
36305>>>>>>>        // Cn.Cn_Vticket
36305>>>>>>>
36305>>>>>>>        // Cn.Constraction_Id
36305>>>>>>>
36305>>>>>>>        // Cn.Cn_Presp_Id
36305>>>>>>>
36305>>>>>>>        // Cn.Cn_Presp_Recr
36305>>>>>>>
36305>>>>>>>        // Cn.Cn_Add_No
36305>>>>>>>
36305>>>>>>>        // Cn.Cn_Nomos
36305>>>>>>>
36305>>>>>>>        // Cn.Cn_Xora
36305>>>>>>>
36305>>>>>>>        // Cn.Polh_Recr
36305>>>>>>>
36305>>>>>>>        // Cn.Lic_Number
36305>>>>>>>
36305>>>>>>>        // Cn.Lic_Date
36305>>>>>>>        Set Field_Mask_Type        Field Cn.Lic_Date To MASK_DATE_WINDOW
36306>>>>>>>
36306>>>>>>>        // Cn.Lic_Lixi
36306>>>>>>>        Set Field_Mask_Type        Field Cn.Lic_Lixi To MASK_DATE_WINDOW
36307>>>>>>>
36307>>>>>>>        // Cn.Lic_Auth
36307>>>>>>>
36307>>>>>>>        // Cn.Cn_Start_Date
36307>>>>>>>        Set Field_Mask_Type        Field Cn.Cn_Start_Date To MASK_DATE_WINDOW
36308>>>>>>>
36308>>>>>>>        // Cn.Cn_End_Date
36308>>>>>>>        Set Field_Mask_Type        Field Cn.Cn_End_Date To MASK_DATE_WINDOW
36309>>>>>>>
36309>>>>>>>        // Cn.Cn_Categfpa
36309>>>>>>>        Set Field_Value_Table      Field Cn.Cn_Categfpa To (Cn_Cn_Categfpa_VT1(Self))
36310>>>>>>>
36310>>>>>>>        // Cn.Cn_Tpay
36310>>>>>>>
36310>>>>>>>        // Cn.Mhxanik_Id
36310>>>>>>>
36310>>>>>>>        // Cn.Sum_Pct_Tper
36310>>>>>>>
36310>>>>>>>        // Cn.Cn_M3
36310>>>>>>>
36310>>>>>>>        // Cn.Aa_Deop
36310>>>>>>>
36310>>>>>>>        // Cn.Hm_Tel_Fortio
36310>>>>>>>        Set Field_Mask_Type        Field Cn.Hm_Tel_Fortio To MASK_DATE_WINDOW
36311>>>>>>>
36311>>>>>>>        // Cn.Tel_Fortio_No
36311>>>>>>>
36311>>>>>>>        // Cn.Tropos_Metaf
36311>>>>>>>        Set Field_Value_Table      Field Cn.Tropos_Metaf To (Cn_Tropos_Metaf_VT(Self))
36312>>>>>>>
36312>>>>>>>        // Cn.Eidos_Cn
36312>>>>>>>        Set Field_Value_Table      Field Cn.Eidos_Cn To (Cn_Eidos_Cn_VT(Self))
36313>>>>>>>
36313>>>>>>>        // Cn.Polhths_Constr
36313>>>>>>>
36313>>>>>>>        // Cn.Polhths_Mhx
36313>>>>>>>
36313>>>>>>>        // Cn.Hm_Prot_Fortio
36313>>>>>>>        Set Field_Mask_Type        Field Cn.Hm_Prot_Fortio To MASK_DATE_WINDOW
36314>>>>>>>
36314>>>>>>>        // Cn.Mesoskyklos
36314>>>>>>>
36314>>>>>>>        // Cn.Diodia
36314>>>>>>>
36314>>>>>>>        // Cn.Yesno
36314>>>>>>>        Set Field_Value_Table      Field Cn.Yesno To (Cn_Yesno_VT(Self))
36315>>>>>>>
36315>>>>>>>        // Cn.Dateeggy
36315>>>>>>>        Set Field_Mask_Type        Field Cn.Dateeggy To MASK_DATE_WINDOW
36316>>>>>>>
36316>>>>>>>        // Cn.Cn_Branch
36316>>>>>>>
36316>>>>>>>        //DDB-DefineFieldEnd
36316>>>>>>>    End_Procedure    // Define_Fields
36317>>>>>>>
36317>>>>>>>    // Field_Defaults:
36317>>>>>>>    // This procedure is used to establish default field values.
36317>>>>>>>          
36317>>>>>>>    Procedure Field_Defaults
36318>>>>>>>        Forward Send Field_Defaults
36320>>>>>>>        //DDB-Generated-Code-Location
36320>>>>>>>        //DDB-FieldDefaultStart
36320>>>>>>>        Set Field_Changed_Value   Field Cn.Cn_Active To "A"
36321>>>>>>>        //DDB-FieldDefaultEnd
36321>>>>>>>    End_Procedure    // Field_Defaults
36322>>>>>>>
36322>>>>>>>End_Class    // Cn_DataDictionary
36323>>>>>>>//DDB-Selection-pkg-Start
36323>>>>>>>
36323>>>>>>>Use sl041.sl         // sl041
36323>>>>>>>Use sl198.sl         // sl198
INCLUDING FILE: SL198.SL
36323>>>>>>>>>//AB/ Project sl198:cities
36323>>>>>>>>>//AB/ Object prj is a Lookup_Project
36323>>>>>>>>>//AB/     Set ProjectName to "sl198:cities"
36323>>>>>>>>>//AB/     Set ProjectFileName to "sl198.SL"
36323>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
36323>>>>>>>>>
36323>>>>>>>>>// Project Object Structure
36323>>>>>>>>>//   sl198 is a dbModalPanelSub
36323>>>>>>>>>//     Cities_DD is a DataDictionary
36323>>>>>>>>>//     oSelList is a dbListSub
36323>>>>>>>>>//     oOK_bn is a ButtonSub
36323>>>>>>>>>//     oCancel_bn is a ButtonSub
36323>>>>>>>>>//     oSearch_bn is a ButtonSub
36323>>>>>>>>>
36323>>>>>>>>>// Register all objects
36323>>>>>>>>>Register_Object Cities_DD
36323>>>>>>>>>Register_Object oCancel_bn
36323>>>>>>>>>Register_Object oOK_bn
36323>>>>>>>>>Register_Object oSearch_bn
36323>>>>>>>>>Register_Object oSelList
36323>>>>>>>>>Register_Object sl198
36323>>>>>>>>>
36323>>>>>>>>>
36323>>>>>>>>>//AB-IgnoreStart
36323>>>>>>>>>
36323>>>>>>>>>Use DFAllEnt.pkg
36323>>>>>>>>>Use dbList.Sub
36323>>>>>>>>>Use Button.Sub
36323>>>>>>>>>
36323>>>>>>>>>
36323>>>>>>>>>Use CITIES.DD
INCLUDING FILE: CITIES.DD
36323>>>>>>>>>>>//DDB-FileStart
36323>>>>>>>>>>>//DDB-HeaderStart
36323>>>>>>>>>>>
36323>>>>>>>>>>>// File Name : CITIES.DD
36323>>>>>>>>>>>// Class Name: Cities_DataDictionary
36323>>>>>>>>>>>// Revision  : 14
36323>>>>>>>>>>>// Version   : 2
36323>>>>>>>>>>>
36323>>>>>>>>>>>Use  Windows           // Basic Definitions
36323>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
36323>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
36323>>>>>>>>>>>
36323>>>>>>>>>>>Open Cities
36325>>>>>>>>>>>Open Clients
36327>>>>>>>>>>>Open Towns
36329>>>>>>>>>>>
36329>>>>>>>>>>>//DDB-HeaderEnd
36329>>>>>>>>>>>//DDB-SelectionStart
36329>>>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.SL
36329>>>>>>>>>>>Register_Object sl198
36329>>>>>>>>>>>//DDB-SelectionEnd
36329>>>>>>>>>>>
36329>>>>>>>>>>>Class Cities_DataDictionary  is a DataDictionary_Sec
36330>>>>>>>>>>>
36330>>>>>>>>>>>    // Define_Fields:
36330>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
36330>>>>>>>>>>>
36330>>>>>>>>>>>    Procedure Define_Fields
36331>>>>>>>>>>>        Forward Send Define_Fields
36333>>>>>>>>>>>        //DDB-Generated-Code-Location
36333>>>>>>>>>>>        //DDB-DefineFieldStart
36333>>>>>>>>>>>
36333>>>>>>>>>>>        Set Main_File            To Cities.File_Number
36334>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
36335>>>>>>>>>>>
36335>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
36336>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
36337>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
36338>>>>>>>>>>>
36338>>>>>>>>>>>        // Child (Client) file structure................
36338>>>>>>>>>>>        Send Add_Client_File  Clients.File_Number
36339>>>>>>>>>>>
36339>>>>>>>>>>>        // Parent (Server) file structure...............
36339>>>>>>>>>>>        Send Add_Server_File  Towns.File_Number
36340>>>>>>>>>>>
36340>>>>>>>>>>>        // Field-based properties.......................
36340>>>>>>>>>>>
36340>>>>>>>>>>>        // Cities.City_Id
36340>>>>>>>>>>>        Set Field_Options          Field Cities.City_Id To DD_AUTOFIND   
36341>>>>>>>>>>>        Set Field_Prompt_Object    Field Cities.City_Id To (sl198(Self))
36342>>>>>>>>>>>        Set Key_Field_State        Field Cities.City_Id To TRUE
36343>>>>>>>>>>>
36343>>>>>>>>>>>        // Cities.City_Descr
36343>>>>>>>>>>>        Set Field_Prompt_Object    Field Cities.City_Descr To (sl198(Self))
36344>>>>>>>>>>>
36344>>>>>>>>>>>        // Cities.Town_Id
36344>>>>>>>>>>>
36344>>>>>>>>>>>        //DDB-DefineFieldEnd
36344>>>>>>>>>>>    End_Procedure    // Define_Fields
36345>>>>>>>>>>>
36345>>>>>>>>>>>    // Field_Defaults:
36345>>>>>>>>>>>    // This procedure is used to establish default field values.
36345>>>>>>>>>>>
36345>>>>>>>>>>>    Procedure Field_Defaults
36346>>>>>>>>>>>        Forward Send Field_Defaults
36348>>>>>>>>>>>        //DDB-Generated-Code-Location
36348>>>>>>>>>>>        //DDB-FieldDefaultStart
36348>>>>>>>>>>>        //DDB-FieldDefaultEnd
36348>>>>>>>>>>>    End_Procedure    // Field_Defaults
36349>>>>>>>>>>>
36349>>>>>>>>>>>End_Class    // Cities_DataDictionary
36350>>>>>>>>>>>//DDB-Selection-pkg-Start
36350>>>>>>>>>>>
36350>>>>>>>>>>>Use sl198.SL         // sl198
36350>>>>>>>>>>>
36350>>>>>>>>>>>//DDB-Selection-pkg-End
36350>>>>>>>>>>>//DDB-FileEnd
36350>>>>>>>>>
36350>>>>>>>>>//AB-IgnoreEnd
36350>>>>>>>>>
36350>>>>>>>>>Object sl198 is a dbModalPanelSub
36352>>>>>>>>>    Set Label to "€¨®œå¦ æ¢œà¤"
36353>>>>>>>>>    Set Size to 148 297
36354>>>>>>>>>    Set Location to 4 5
36355>>>>>>>>>    Set Exit_Application_Local_State to FALSE
36356>>>>>>>>>    Set Modal_State to FALSE
36357>>>>>>>>>
36357>>>>>>>>>    //AB-DDOStart
36357>>>>>>>>>
36357>>>>>>>>>    Object Cities_DD is a Cities_DataDictionary
36359>>>>>>>>>
36359>>>>>>>>>        //AB-StoreStart
36359>>>>>>>>>                
36359>>>>>>>>>                
36359>>>>>>>>>        //AB-StoreEnd
36359>>>>>>>>>
36359>>>>>>>>>    End_Object    // Cities_DD
36360>>>>>>>>>
36360>>>>>>>>>    Set Main_DD to (Cities_DD(self))
36361>>>>>>>>>    Set Server to (Cities_DD(self))
36362>>>>>>>>>
36362>>>>>>>>>    //AB-DDOEnd
36362>>>>>>>>>
36362>>>>>>>>>    Object oSelList is a dbListSub
36364>>>>>>>>>        Set Main_File to Cities.File_Number
36365>>>>>>>>>        Set Size to 105 280
36366>>>>>>>>>        Set Location to 6 6
36367>>>>>>>>>
36367>>>>>>>>>        Begin_Row
36370>>>>>>>>>            Entry_Item Cities.City_id
36371>>>>>>>>>            Entry_Item Cities.City_descr
36372>>>>>>>>>        End_Row
36377>>>>>>>>>
36377>>>>>>>>>        Set Form_Width    item 0 to 50
36378>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
36379>>>>>>>>>        
36379>>>>>>>>>        Set Form_Width    item 1 to 221
36380>>>>>>>>>        Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
36381>>>>>>>>>        
36381>>>>>>>>>
36381>>>>>>>>>        //AB-StoreStart
36381>>>>>>>>>        
36381>>>>>>>>>        Set Column_Option Item 0 to NoEnter True
36382>>>>>>>>>        
36382>>>>>>>>>        
36382>>>>>>>>>        
36382>>>>>>>>>        
36382>>>>>>>>>        
36382>>>>>>>>>        //AB-StoreEnd
36382>>>>>>>>>
36382>>>>>>>>>    End_Object    // oSelList
36383>>>>>>>>>
36383>>>>>>>>>    Object oOK_bn is a ButtonSub
36385>>>>>>>>>        Set Label to "&„§ ¢¦šã"
36386>>>>>>>>>        Set Location to 115 126
36387>>>>>>>>>
36387>>>>>>>>>        //AB-StoreStart
36387>>>>>>>>>        Procedure OnClick
36389>>>>>>>>>            Send OK To (oSelList(current_object))
36390>>>>>>>>>        End_Procedure
36391>>>>>>>>>        //AB-StoreEnd
36391>>>>>>>>>
36391>>>>>>>>>    End_Object    // oOK_bn
36392>>>>>>>>>
36392>>>>>>>>>    Object oCancel_bn is a ButtonSub
36394>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
36395>>>>>>>>>        Set Location to 115 181
36396>>>>>>>>>
36396>>>>>>>>>        //AB-StoreStart
36396>>>>>>>>>        Procedure OnClick
36398>>>>>>>>>            Send Cancel To (oSelList(current_object))
36399>>>>>>>>>        End_Procedure
36400>>>>>>>>>        //AB-StoreEnd
36400>>>>>>>>>
36400>>>>>>>>>    End_Object    // oCancel_bn
36401>>>>>>>>>
36401>>>>>>>>>    Object oSearch_bn is a ButtonSub
36403>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
36404>>>>>>>>>        Set Location to 115 236
36405>>>>>>>>>
36405>>>>>>>>>        //AB-StoreStart
36405>>>>>>>>>        Procedure OnClick
36407>>>>>>>>>            Send Search To (oSelList(current_object))
36408>>>>>>>>>        End_Procedure
36409>>>>>>>>>        //AB-StoreEnd
36409>>>>>>>>>
36409>>>>>>>>>    End_Object    // oSearch_bn
36410>>>>>>>>>
36410>>>>>>>>>
36410>>>>>>>>>    //AB-StoreStart
36410>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
36411>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
36412>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
36413>>>>>>>>>    //AB-StoreEnd
36413>>>>>>>>>
36413>>>>>>>>>End_Object    // sl198
36414>>>>>>>>>
36414>>>>>>>>>//AB/ End_Object    // prj
36414>>>>>>>Use sl197.SL         // sl197
INCLUDING FILE: SL197.SL
36414>>>>>>>>>//AB/ Project sl197:areas
36414>>>>>>>>>//AB/     Object prj is a Lookup_Project
36414>>>>>>>>>//AB/         Set ProjectName to "sl197:areas"
36414>>>>>>>>>//AB/         Set ProjectFileName to "sl197.SL"
36414>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
36414>>>>>>>>>
36414>>>>>>>>>// Project Object Structure
36414>>>>>>>>>//   sl197 is a dbModalPanelSub
36414>>>>>>>>>//     Areas_DD is a DataDictionary
36414>>>>>>>>>//     oSelList is a dbListSub
36414>>>>>>>>>//     oOK_bn is a ButtonSub
36414>>>>>>>>>//     oCancel_bn is a ButtonSub
36414>>>>>>>>>//     oSearch_bn is a ButtonSub
36414>>>>>>>>>
36414>>>>>>>>>// Register all objects
36414>>>>>>>>>Register_Object Areas_DD
36414>>>>>>>>>Register_Object oCancel_bn
36414>>>>>>>>>Register_Object oOK_bn
36414>>>>>>>>>Register_Object oSearch_bn
36414>>>>>>>>>Register_Object oSelList
36414>>>>>>>>>Register_Object sl197
36414>>>>>>>>>
36414>>>>>>>>>
36414>>>>>>>>>    //AB-IgnoreStart
36414>>>>>>>>>
36414>>>>>>>>>    Use DFAllEnt.pkg
36414>>>>>>>>>    Use dbList.Sub
36414>>>>>>>>>    Use Button.Sub
36414>>>>>>>>>
36414>>>>>>>>>
36414>>>>>>>>>    Use AREAS.DD
INCLUDING FILE: AREAS.DD
36414>>>>>>>>>>>//DDB-FileStart
36414>>>>>>>>>>>//DDB-HeaderStart
36414>>>>>>>>>>>
36414>>>>>>>>>>>// File Name : AREAS.DD
36414>>>>>>>>>>>// Class Name: Areas_DataDictionary
36414>>>>>>>>>>>// Revision  : 7
36414>>>>>>>>>>>// Version   : 2
36414>>>>>>>>>>>
36414>>>>>>>>>>>Use  Windows           // Basic Definitions
36414>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
36414>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
36414>>>>>>>>>>>
36414>>>>>>>>>>>Open Areas
36416>>>>>>>>>>>Open Clients
36418>>>>>>>>>>>
36418>>>>>>>>>>>//DDB-HeaderEnd
36418>>>>>>>>>>>//DDB-SelectionStart
36418>>>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
36418>>>>>>>>>>>Register_Object sl197
36418>>>>>>>>>>>//DDB-SelectionEnd
36418>>>>>>>>>>>
36418>>>>>>>>>>>Class Areas_DataDictionary  is a DataDictionary_Sec
36419>>>>>>>>>>>
36419>>>>>>>>>>>    // Define_Fields:
36419>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
36419>>>>>>>>>>>
36419>>>>>>>>>>>    Procedure Define_Fields
36420>>>>>>>>>>>        Forward Send Define_Fields
36422>>>>>>>>>>>        //DDB-Generated-Code-Location
36422>>>>>>>>>>>        //DDB-DefineFieldStart
36422>>>>>>>>>>>
36422>>>>>>>>>>>        Set Main_File            To Areas.File_Number
36423>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
36424>>>>>>>>>>>
36424>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
36425>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
36426>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
36427>>>>>>>>>>>
36427>>>>>>>>>>>        // Child (Client) file structure................
36427>>>>>>>>>>>        Send Add_Client_File  Clients.File_Number
36428>>>>>>>>>>>
36428>>>>>>>>>>>        // Field-based properties.......................
36428>>>>>>>>>>>
36428>>>>>>>>>>>        // Areas.Area_Id
36428>>>>>>>>>>>        Set Field_Prompt_Object    Field Areas.Area_Id To (sl197(Self))
36429>>>>>>>>>>>
36429>>>>>>>>>>>        // Areas.Area_Descr
36429>>>>>>>>>>>        Set Field_Prompt_Object    Field Areas.Area_Descr To (sl197(Self))
36430>>>>>>>>>>>
36430>>>>>>>>>>>        // Areas.Area_Site
36430>>>>>>>>>>>
36430>>>>>>>>>>>        //DDB-DefineFieldEnd
36430>>>>>>>>>>>    End_Procedure    // Define_Fields
36431>>>>>>>>>>>
36431>>>>>>>>>>>    // Field_Defaults:
36431>>>>>>>>>>>    // This procedure is used to establish default field values.
36431>>>>>>>>>>>
36431>>>>>>>>>>>    Procedure Field_Defaults
36432>>>>>>>>>>>        Forward Send Field_Defaults
36434>>>>>>>>>>>        //DDB-Generated-Code-Location
36434>>>>>>>>>>>        //DDB-FieldDefaultStart
36434>>>>>>>>>>>        //DDB-FieldDefaultEnd
36434>>>>>>>>>>>    End_Procedure    // Field_Defaults
36435>>>>>>>>>>>
36435>>>>>>>>>>>End_Class    // Areas_DataDictionary
36436>>>>>>>>>>>//DDB-Selection-pkg-Start
36436>>>>>>>>>>>
36436>>>>>>>>>>>Use sl197.SL         // sl197
36436>>>>>>>>>>>
36436>>>>>>>>>>>//DDB-Selection-pkg-End
36436>>>>>>>>>>>//DDB-FileEnd
36436>>>>>>>>>    
36436>>>>>>>>>    //AB-IgnoreEnd
36436>>>>>>>>>
36436>>>>>>>>>    Object sl197 is a dbModalPanelSub
36438>>>>>>>>>
36438>>>>>>>>>        //AB-StoreTopStart
36438>>>>>>>>>                    
36438>>>>>>>>>        //AB-StoreTopEnd
36438>>>>>>>>>
36438>>>>>>>>>        Set Label to "€¨®œå¦ œ¨ ¦®é¤"
36439>>>>>>>>>        Set Size to 148 297
36440>>>>>>>>>        Set Location to 4 5
36441>>>>>>>>>        Set Exit_Application_Local_State to FALSE
36442>>>>>>>>>        Set Modal_State to FALSE
36443>>>>>>>>>
36443>>>>>>>>>        //AB-DDOStart
36443>>>>>>>>>
36443>>>>>>>>>        Object Areas_DD is a Areas_DataDictionary
36445>>>>>>>>>
36445>>>>>>>>>            //AB-StoreStart
36445>>>>>>>>>                                    
36445>>>>>>>>>            //AB-StoreEnd
36445>>>>>>>>>
36445>>>>>>>>>        End_Object    // Areas_DD
36446>>>>>>>>>
36446>>>>>>>>>        Set Main_DD to (Areas_DD(self))
36447>>>>>>>>>        Set Server to (Areas_DD(self))
36448>>>>>>>>>
36448>>>>>>>>>        //AB-DDOEnd
36448>>>>>>>>>
36448>>>>>>>>>        Object oSelList is a dbListSub
36450>>>>>>>>>            Set Main_File to Areas.File_Number
36451>>>>>>>>>            Set Ordering to 2
36452>>>>>>>>>            Set Size to 105 280
36453>>>>>>>>>            Set Location to 5 5
36454>>>>>>>>>            Set Export_Item_State to TRUE
36455>>>>>>>>>
36455>>>>>>>>>            Begin_Row
36458>>>>>>>>>                Entry_Item Areas.Area_id
36459>>>>>>>>>                Entry_Item Areas.Area_descr
36460>>>>>>>>>                Entry_Item Areas.Area_site
36461>>>>>>>>>            End_Row
36466>>>>>>>>>
36466>>>>>>>>>            Set Form_Width    item 0 to 45
36467>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
36468>>>>>>>>>            
36468>>>>>>>>>            Set Form_Width    item 1 to 192
36469>>>>>>>>>            Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
36470>>>>>>>>>            
36470>>>>>>>>>            Set Form_Width    item 2 to 35
36471>>>>>>>>>            Set Header_Label  item 2 to "’¦£â˜ª"
36472>>>>>>>>>            
36472>>>>>>>>>
36472>>>>>>>>>            //AB-StoreStart
36472>>>>>>>>>            
36472>>>>>>>>>            Set Column_Option Item 0 to NoEnter True
36473>>>>>>>>>            
36473>>>>>>>>>            
36473>>>>>>>>>            //AB-StoreEnd
36473>>>>>>>>>
36473>>>>>>>>>        End_Object    // oSelList
36474>>>>>>>>>
36474>>>>>>>>>        Object oOK_bn is a ButtonSub
36476>>>>>>>>>            Set Label to "&„§ ¢¦šã"
36477>>>>>>>>>            Set Location to 115 126
36478>>>>>>>>>
36478>>>>>>>>>            //AB-StoreStart
36478>>>>>>>>>            Procedure OnClick
36480>>>>>>>>>                Send OK To (oSelList(current_object))
36481>>>>>>>>>            End_Procedure
36482>>>>>>>>>            //AB-StoreEnd
36482>>>>>>>>>
36482>>>>>>>>>        End_Object    // oOK_bn
36483>>>>>>>>>
36483>>>>>>>>>        Object oCancel_bn is a ButtonSub
36485>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
36486>>>>>>>>>            Set Location to 115 181
36487>>>>>>>>>
36487>>>>>>>>>            //AB-StoreStart
36487>>>>>>>>>            Procedure OnClick
36489>>>>>>>>>                Send Cancel To (oSelList(current_object))
36490>>>>>>>>>            End_Procedure
36491>>>>>>>>>            //AB-StoreEnd
36491>>>>>>>>>
36491>>>>>>>>>        End_Object    // oCancel_bn
36492>>>>>>>>>
36492>>>>>>>>>        Object oSearch_bn is a ButtonSub
36494>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
36495>>>>>>>>>            Set Location to 115 236
36496>>>>>>>>>
36496>>>>>>>>>            //AB-StoreStart
36496>>>>>>>>>            Procedure OnClick
36498>>>>>>>>>                Send Search To (oSelList(current_object))
36499>>>>>>>>>            End_Procedure
36500>>>>>>>>>            //AB-StoreEnd
36500>>>>>>>>>
36500>>>>>>>>>        End_Object    // oSearch_bn
36501>>>>>>>>>
36501>>>>>>>>>
36501>>>>>>>>>        //AB-StoreStart
36501>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
36502>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
36503>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
36504>>>>>>>>>        
36504>>>>>>>>>        
36504>>>>>>>>>        
36504>>>>>>>>>        
36504>>>>>>>>>        
36504>>>>>>>>>        //AB-StoreEnd
36504>>>>>>>>>
36504>>>>>>>>>    End_Object    // sl197
36505>>>>>>>>>
36505>>>>>>>>>//AB/     End_Object    // prj
36505>>>>>>>
36505>>>>>>>//DDB-Selection-pkg-End
36505>>>>>>>//DDB-FileEnd
36505>>>>>
36505>>>>>//AB-IgnoreEnd
36505>>>>>
36505>>>>>Object sl041 is a dbModalPanelSub
36507>>>>>
36507>>>>>    //AB-StoreTopStart
36507>>>>>    Property String FragmaClient_ID Public ''
36509>>>>>    
36509>>>>>    //AB-StoreTopEnd
36509>>>>>
36509>>>>>    Set Label to "„§ ¢¦šã „¨šà¤"
36510>>>>>    Set Size to 249 500
36511>>>>>    Set Location to 2 6
36512>>>>>    Set Exit_Application_Local_State to FALSE
36513>>>>>    Set Modal_State to FALSE
36514>>>>>
36514>>>>>    //AB-DDOStart
36514>>>>>
36514>>>>>    Object Clients_DD is a Clients_DataDictionary
36516>>>>>
36516>>>>>        //AB-StoreStart
36516>>>>>                                                                                                                                                                                                                            
36516>>>>>                                                                                                                                                                                                                            
36516>>>>>                                                                                                                                                                                                                            
36516>>>>>        //AB-StoreEnd
36516>>>>>
36516>>>>>    End_Object    // Clients_DD
36517>>>>>
36517>>>>>    Object Cn_DD is a Cn_DataDictionary
36519>>>>>        Set DDO_Server to (Clients_DD(self))
36520>>>>>
36520>>>>>        //AB-StoreStart
36520>>>>>                                
36520>>>>>        Begin_Constraints
36522>>>>>            String sID
36523>>>>>            Get FragmaClient_ID to sID
36524>>>>>            If (sID<>'') begin
36526>>>>>                set ordering to 4
36527>>>>>                Constrain CN.Client_ID eq sID
36529>>>>>            end
36529>>>>>>
36529>>>>>            ELSE SET ORDERING TO -1
36531>>>>>        End_Constraints
36534>>>>>        
36534>>>>>        
36534>>>>>        
36534>>>>>        
36534>>>>>        
36534>>>>>        
36534>>>>>        
36534>>>>>        
36534>>>>>        
36534>>>>>        
36534>>>>>        
36534>>>>>        
36534>>>>>        
36534>>>>>        
36534>>>>>        
36534>>>>>        //AB-StoreEnd
36534>>>>>
36534>>>>>    End_Object    // Cn_DD
36535>>>>>
36535>>>>>    Set Main_DD to (Cn_DD(self))
36536>>>>>    Set Server to (Cn_DD(self))
36537>>>>>
36537>>>>>    //AB-DDOEnd
36537>>>>>
36537>>>>>    Object oSelList is a dbListSub
36539>>>>>        Set Main_File to Cn.File_Number
36540>>>>>        Set Ordering to 5
36541>>>>>        Set Size to 209 481
36542>>>>>        Set Location to 6 6
36543>>>>>        Set Auto_Index_State to FALSE
36544>>>>>
36544>>>>>        Begin_Row
36547>>>>>            Entry_Item Cn.Cn_code
36548>>>>>            Entry_Item Cn.Cn_descr
36549>>>>>            Entry_Item Cn.Client_id
36550>>>>>            Entry_Item Clients.Client_name
36551>>>>>            Entry_Item Cn.Cn_active
36552>>>>>        End_Row
36557>>>>>
36557>>>>>        Set Form_Width    item 0 to 61
36558>>>>>        Set Header_Label  item 0 to "‰à› ¡æª „¨š¦¬"
36559>>>>>        
36559>>>>>        Set Form_Width    item 1 to 185
36560>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã „¨š¦¬"
36561>>>>>        
36561>>>>>        Set Form_Width    item 2 to 60
36562>>>>>        Set Header_Label  item 2 to "‰à›.œ¢á«ž"
36563>>>>>        
36563>>>>>        Set Form_Width    item 3 to 123
36564>>>>>        Set Header_Label  item 3 to "„§à¤¬£å˜ œ¢á«ž"
36565>>>>>        
36565>>>>>        Set Form_Width    item 4 to 44
36566>>>>>        Set Header_Label  item 4 to "‘œ „¥â¢ ¥ž"
36567>>>>>        Set Column_Checkbox_State  item 4 to True
36568>>>>>        
36568>>>>>
36568>>>>>        //AB-StoreStart
36568>>>>>                                
36568>>>>>        Property String StoreFragmaClient_ID Public ''
36570>>>>>        
36570>>>>>        Procedure Store_Defaults
36572>>>>>               Forward Send Store_Defaults
36574>>>>>               Set StoreFragmaClient_ID to (FragmaClient_ID(Self))
36575>>>>>        End_Procedure
36576>>>>>        
36576>>>>>        Procedure ReStore_Defaults
36578>>>>>               Forward Send ReStore_Defaults
36580>>>>>               Set FragmaClient_ID to (StoreFragmaClient_ID(Self))
36581>>>>>        End_Procedure
36582>>>>>        
36582>>>>>        Procedure Activating Returns Integer
36584>>>>>            Integer rVal
36585>>>>>            Forward Get Msg_Activating to rVal
36587>>>>>            set auto_index_state to true
36588>>>>>            SET ORDERING TO -1
36589>>>>>            Procedure_Return rVal
36590>>>>>        End_Procedure
36591>>>>>        
36591>>>>>        
36591>>>>>        
36591>>>>>        
36591>>>>>        
36591>>>>>        
36591>>>>>        
36591>>>>>        
36591>>>>>        
36591>>>>>        
36591>>>>>        
36591>>>>>        
36591>>>>>        
36591>>>>>        
36591>>>>>        
36591>>>>>        
36591>>>>>        
36591>>>>>        
36591>>>>>        //AB-StoreEnd
36591>>>>>
36591>>>>>    End_Object    // oSelList
36592>>>>>
36592>>>>>    Object oOK_bn is a ButtonSub
36594>>>>>        Set Label to "&„§ ¢¦šã"
36595>>>>>        Set Location to 219 327
36596>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
36597>>>>>
36597>>>>>        //AB-StoreStart
36597>>>>>        Procedure OnClick
36599>>>>>            Send OK To (oSelList(current_object))
36600>>>>>        End_Procedure
36601>>>>>        //AB-StoreEnd
36601>>>>>
36601>>>>>    End_Object    // oOK_bn
36602>>>>>
36602>>>>>    Object oCancel_bn is a ButtonSub
36604>>>>>        Set Label to "&€¡ç¨à©ž"
36605>>>>>        Set Location to 219 383
36606>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
36607>>>>>
36607>>>>>        //AB-StoreStart
36607>>>>>        Procedure OnClick
36609>>>>>            Send Cancel To (oSelList(current_object))
36610>>>>>        End_Procedure
36611>>>>>        //AB-StoreEnd
36611>>>>>
36611>>>>>    End_Object    // oCancel_bn
36612>>>>>
36612>>>>>    Object oSearch_bn is a ButtonSub
36614>>>>>        Set Label to "€&¤˜ã«ž©ž"
36615>>>>>        Set Location to 219 437
36616>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
36617>>>>>
36617>>>>>        //AB-StoreStart
36617>>>>>        Procedure OnClick
36619>>>>>            Send Search To (oSelList(current_object))
36620>>>>>        End_Procedure
36621>>>>>        //AB-StoreEnd
36621>>>>>
36621>>>>>    End_Object    // oSearch_bn
36622>>>>>
36622>>>>>
36622>>>>>    //AB-StoreStart
36622>>>>>                
36622>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
36623>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
36624>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
36625>>>>>    Set Modal_State to True
36626>>>>>    Procedure Activating Returns Integer
36628>>>>>        Integer rVal
36629>>>>>        Forward Get Msg_Activating to rVal
36631>>>>>        Send Rebuild_Constraints to (CN_DD(Self))
36632>>>>>        Send Beginning_Of_Data to oSelList
36633>>>>>        Procedure_Return rVal
36634>>>>>    End_Procedure
36635>>>>>    
36635>>>>>    procedure page integer pagemode
36637>>>>>        forward send page pagemode
36639>>>>>        set location to 40,40
36640>>>>>    end_procedure
36641>>>>>    
36641>>>>>    
36641>>>>>    
36641>>>>>    
36641>>>>>    
36641>>>>>    
36641>>>>>    
36641>>>>>    
36641>>>>>    
36641>>>>>    
36641>>>>>    
36641>>>>>    
36641>>>>>    
36641>>>>>    
36641>>>>>    
36641>>>>>    
36641>>>>>    
36641>>>>>    
36641>>>>>    //AB-StoreEnd
36641>>>>>
36641>>>>>End_Object    // sl041
36642>>>>>
36642>>>>>//AB/ End_Object    // prj
36642>>>
36642>>>Use bpEnCmv3.dg // Business Process Finilizing Barticle
INCLUDING FILE: BPENCMV3.DG
36642>>>>>//AB/ Project bpencmv3
36642>>>>>//AB/     Object prj is a Dialog_Project
36642>>>>>//AB/         Set ProjectName to "bpencmv3"
36642>>>>>//AB/         Set ProjectFileName to "bpencmv3.DG"
36642>>>>>
36642>>>>>// Project Object Structure
36642>>>>>//   bpencmv3 is a BusinessProcessSub
36642>>>>>//     Ctypkin_DD is a DataDictionary
36642>>>>>//     Country_DD is a DataDictionary
36642>>>>>//     Towns_DD is a DataDictionary
36642>>>>>//     Cities_DD is a DataDictionary
36642>>>>>//     Payresp_DD is a DataDictionary
36642>>>>>//     Areas_DD is a DataDictionary
36642>>>>>//     Clients_DD is a DataDictionary
36642>>>>>//     Cmoves_DD is a DataDictionary
36642>>>>>//     Cflagkin_DD is a DataDictionary
36642>>>>>//     Btypkin_DD is a DataDictionary
36642>>>>>//     Baxiokat_DD is a DataDictionary
36642>>>>>//     Barticl_DD is a DataDictionary
36642>>>>>//     Baxio_DD is a DataDictionary
36642>>>>>//     Bmove_DD is a DataDictionary
36642>>>>>//     Nomisma_DD is a DataDictionary
36642>>>>>
36642>>>>>// Register all objects
36642>>>>>Register_Object Areas_DD
36642>>>>>Register_Object Barticl_DD
36642>>>>>Register_Object Baxio_DD
36642>>>>>Register_Object Baxiokat_DD
36642>>>>>Register_Object Bmove_DD
36642>>>>>Register_Object Btypkin_DD
36642>>>>>Register_Object bpencmv3
36642>>>>>Register_Object Cflagkin_DD
36642>>>>>Register_Object Cities_DD
36642>>>>>Register_Object Clients_DD
36642>>>>>Register_Object Cmoves_DD
36642>>>>>Register_Object Country_DD
36642>>>>>Register_Object Ctypkin_DD
36642>>>>>Register_Object Nomisma_DD
36642>>>>>Register_Object Payresp_DD
36642>>>>>Register_Object Towns_DD
36642>>>>>
36642>>>>>
36642>>>>>
36642>>>>>    //AB-StoreTopStart
36642>>>>>
36642>>>>>
36642>>>>>    //AB-StoreTopEnd
36642>>>>>
36642>>>>>    //AB-IgnoreStart
36642>>>>>
36642>>>>>    Use Bproces.Sub
36642>>>>>    Use DFAllEnt.pkg
36642>>>>>
36642>>>>>
36642>>>>>    Use CTYPKIN.DD
INCLUDING FILE: CTYPKIN.DD
36642>>>>>>>//DDB-FileStart
36642>>>>>>>//DDB-HeaderStart
36642>>>>>>>
36642>>>>>>>// File Name : CTYPKIN.DD
36642>>>>>>>// Class Name: Ctypkin_DataDictionary
36642>>>>>>>// Revision  : 69
36642>>>>>>>// Version   : 2
36642>>>>>>>
36642>>>>>>>Use  Windows           // Basic Definitions
36642>>>>>>>Use  DataDict          // DataDictionary Class Definition
36642>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
36642>>>>>>>
36642>>>>>>>Open Ctypkin
INCLUDING FILE: CTYPKIN.FD
36644>>>>>>>Open Cmoves
36646>>>>>>>Open Cflagkin
INCLUDING FILE: CFLAGKIN.FD
36648>>>>>>>Open Ptypparl
36650>>>>>>>Open Ptyppar
INCLUDING FILE: PTYPPAR.FD
36652>>>>>>>Open Hmctyp
INCLUDING FILE: HMCTYP.FD
36654>>>>>>>Open Cmovesa
36656>>>>>>>Open Sysrecc
36658>>>>>>>Open Syscurxr
36660>>>>>>>
36660>>>>>>>//DDB-HeaderEnd
36660>>>>>>>//DDB-ValidationStart
36660>>>>>>>
36660>>>>>>>Register_Object Ctypkin_Ctypkin_Module_VT
36660>>>>>>>
36660>>>>>>>Object Ctypkin_Ctypkin_Module_VT  is a CodeValidationTable
36662>>>>>>>    Set Type_Value        To "MODULE"
36663>>>>>>>    //DDB-ValidationCustomStart
36663>>>>>>>    //DDB-ValidationCustomEnd
36663>>>>>>>End_Object   // Ctypkin_Ctypkin_Module_VT
36664>>>>>>>//DDB-ValidationEnd
36664>>>>>>>//DDB-SelectionStart
36664>>>>>>>//DDB/ ExternalSelectionList sl007  sl007.SL
36664>>>>>>>Register_Object sl007
36664>>>>>>>//DDB-SelectionEnd
36664>>>>>>>
36664>>>>>>>Class Ctypkin_DataDictionary  is a DataDictionary
36665>>>>>>>         
36665>>>>>>>    Procedure Construct_Object
36666>>>>>>>        Forward Send Construct_Object
36668>>>>>>>        Property Integer piMustNOTConstrain Public 0
36669>>>>>>>    End_Procedure
36670>>>>>>>
36670>>>>>>>
36670>>>>>>>    Procedure Save_Main_File
36671>>>>>>>        If (Operation_Origin<>Self) Begin
36673>>>>>>>            If Ctypkin.Recnum Eq 0 Procedure_Return
36676>>>>>>>        End
36676>>>>>>>>
36676>>>>>>>        Forward Send Save_Main_File
36678>>>>>>>    End_Procedure
36679>>>>>>>
36679>>>>>>>     Procedure Creating
36680>>>>>>>        Forward Send Creating
36682>>>>>>>        // Insert Code Here
36682>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Ctypkin.Ctypkin_Rec0)))))) to Ctypkin.Ctypkin_Recr
36683>>>>>>>    End_Procedure   // Creating
36684>>>>>>>
36684>>>>>>>
36684>>>>>>>    // Define_Fields:
36684>>>>>>>    // This procedure is used to set up all data-dictionary rules.
36684>>>>>>>
36684>>>>>>>    Procedure Define_Fields
36685>>>>>>>        Forward Send Define_Fields
36687>>>>>>>        //DDB-Generated-Code-Location
36687>>>>>>>        //DDB-DefineFieldStart
36687>>>>>>>
36687>>>>>>>        Set Main_File            To Ctypkin.File_Number
36688>>>>>>>        Set Cascade_Delete_State To FALSE
36689>>>>>>>
36689>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
36690>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
36691>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
36692>>>>>>>
36692>>>>>>>        // Child (Client) file structure................
36692>>>>>>>        Send Add_Client_File  Cmoves.File_Number
36693>>>>>>>        Send Add_Client_File  Cflagkin.File_Number
36694>>>>>>>        Send Add_Client_File  Ptypparl.File_Number
36695>>>>>>>        Send Add_Client_File  Ptyppar.File_Number
36696>>>>>>>        Send Add_Client_File  Hmctyp.File_Number
36697>>>>>>>        Send Add_Client_File  Cmovesa.File_Number
36698>>>>>>>
36698>>>>>>>        // External (System) file structure.............
36698>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
36699>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
36700>>>>>>>
36700>>>>>>>        Define_Auto_Increment  Sysrecc.Ctypkin_Rec0  To Ctypkin.Ctypkin_Rec0
36703>>>>>>>
36703>>>>>>>        // Field-based properties.......................
36703>>>>>>>
36703>>>>>>>        // Ctypkin.Company_Code
36703>>>>>>>
36703>>>>>>>        // Ctypkin.Branch_Code
36703>>>>>>>
36703>>>>>>>        // Ctypkin.Year_Year
36703>>>>>>>
36703>>>>>>>        // Ctypkin.Ctypkin_Code
36703>>>>>>>        Set Field_Options          Field Ctypkin.Ctypkin_Code To DD_AUTOFIND   
36704>>>>>>>        Set Field_Prompt_Object    Field Ctypkin.Ctypkin_Code To (sl007(Self))
36705>>>>>>>        Set Key_Field_State        Field Ctypkin.Ctypkin_Code To TRUE
36706>>>>>>>
36706>>>>>>>        // Ctypkin.Ctypkin_Rec0
36706>>>>>>>
36706>>>>>>>        // Ctypkin.Ctypkin_Recr
36706>>>>>>>
36706>>>>>>>        // Ctypkin.Year_Recr
36706>>>>>>>
36706>>>>>>>        // Ctypkin.Ctypkin_Descr
36706>>>>>>>        Set Field_Prompt_Object    Field Ctypkin.Ctypkin_Descr To (sl007(Self))
36707>>>>>>>
36707>>>>>>>        // Ctypkin.Ctypkin_Anti
36707>>>>>>>
36707>>>>>>>        // Ctypkin.Ctypkin_Flags
36707>>>>>>>
36707>>>>>>>        // Ctypkin.Ctypkin_Module
36707>>>>>>>        Set Field_Value_Table      Field Ctypkin.Ctypkin_Module To (Ctypkin_Ctypkin_Module_VT(Self))
36708>>>>>>>
36708>>>>>>>        // Ctypkin.Open_Item
36708>>>>>>>
36708>>>>>>>        // Ctypkin.Check_Overhead
36708>>>>>>>
36708>>>>>>>        // Ctypkin.Max_Days_Sx_Par
36708>>>>>>>
36708>>>>>>>        // Ctypkin.Singular
36708>>>>>>>
36708>>>>>>>        // Ctypkin.Sub
36708>>>>>>>
36708>>>>>>>        // Ctypkin.Subreport
36708>>>>>>>
36708>>>>>>>        //DDB-DefineFieldEnd
36708>>>>>>>    End_Procedure    // Define_Fields
36709>>>>>>>
36709>>>>>>>    // Field_Defaults:
36709>>>>>>>    // This procedure is used to establish default field values.
36709>>>>>>>
36709>>>>>>>    Procedure Field_Defaults
36710>>>>>>>        Forward Send Field_Defaults
36712>>>>>>>        //DDB-Generated-Code-Location
36712>>>>>>>        //DDB-FieldDefaultStart
36712>>>>>>>        //DDB-FieldDefaultEnd
36712>>>>>>>    End_Procedure    // Field_Defaults
36713>>>>>>>
36713>>>>>>>End_Class    // Ctypkin_DataDictionary
36714>>>>>>>//DDB-Selection-pkg-Start
36714>>>>>>>
36714>>>>>>>Use sl007.SL         // sl007
INCLUDING FILE: SL007.SL
36714>>>>>>>>>//AB/ Project Ctypkin : sl007
36714>>>>>>>>>//AB/ Object prj is a Lookup_Project
36714>>>>>>>>>//AB/     Set ProjectName to "Ctypkin : sl007"
36714>>>>>>>>>//AB/     Set ProjectFileName to "sl007.SL"
36714>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
36714>>>>>>>>>
36714>>>>>>>>>// Project Object Structure
36714>>>>>>>>>//   sl007 is a dbModalPanelSub
36714>>>>>>>>>//     Ctypkin_DD is a DataDictionary
36714>>>>>>>>>//     oSelList is a dbListSub
36714>>>>>>>>>//     oOK_bn is a ButtonSub
36714>>>>>>>>>//     oCancel_bn is a ButtonSub
36714>>>>>>>>>//     oSearch_bn is a ButtonSub
36714>>>>>>>>>
36714>>>>>>>>>// Register all objects
36714>>>>>>>>>Register_Object Ctypkin_DD
36714>>>>>>>>>Register_Object oCancel_bn
36714>>>>>>>>>Register_Object oOK_bn
36714>>>>>>>>>Register_Object oSearch_bn
36714>>>>>>>>>Register_Object oSelList
36714>>>>>>>>>Register_Object sl007
36714>>>>>>>>>
36714>>>>>>>>>
36714>>>>>>>>>//AB-IgnoreStart
36714>>>>>>>>>
36714>>>>>>>>>Use DFAllEnt.pkg
36714>>>>>>>>>Use dbList.Sub
36714>>>>>>>>>Use Button.Sub
36714>>>>>>>>>
36714>>>>>>>>>
36714>>>>>>>>>Use CTYPKIN.DD
36714>>>>>>>>>
36714>>>>>>>>>//AB-IgnoreEnd
36714>>>>>>>>>
36714>>>>>>>>>Object sl007 is a dbModalPanelSub
36716>>>>>>>>>
36716>>>>>>>>>    //AB-StoreTopStart
36716>>>>>>>>>    Property String psModule Public ''
36718>>>>>>>>>    
36718>>>>>>>>>    //AB-StoreTopEnd
36718>>>>>>>>>
36718>>>>>>>>>    Set Label to "‰ ¤ã©œ ª    "
36719>>>>>>>>>    Set Size to 148 350
36720>>>>>>>>>    Set Location to 4 7
36721>>>>>>>>>    Set Exit_Application_Local_State to FALSE
36722>>>>>>>>>    Set Modal_State to FALSE
36723>>>>>>>>>
36723>>>>>>>>>    //AB-DDOStart
36723>>>>>>>>>
36723>>>>>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
36725>>>>>>>>>
36725>>>>>>>>>        //AB-StoreStart
36725>>>>>>>>>                                
36725>>>>>>>>>        Begin_Constraints
36727>>>>>>>>>            If (psModule(sl007(Self))<>'') Constrain Ctypkin.Ctypkin_Module eq (psModule(sl007(Self)))
36731>>>>>>>>>        End_Constraints
36734>>>>>>>>>        
36734>>>>>>>>>        
36734>>>>>>>>>        
36734>>>>>>>>>        
36734>>>>>>>>>        //AB-StoreEnd
36734>>>>>>>>>
36734>>>>>>>>>    End_Object    // Ctypkin_DD
36735>>>>>>>>>
36735>>>>>>>>>    Set Main_DD to (Ctypkin_DD(self))
36736>>>>>>>>>    Set Server to (Ctypkin_DD(self))
36737>>>>>>>>>
36737>>>>>>>>>    //AB-DDOEnd
36737>>>>>>>>>
36737>>>>>>>>>    Object oSelList is a dbListSub
36739>>>>>>>>>        Set Main_File to Ctypkin.File_Number
36740>>>>>>>>>        Set Size to 105 335
36741>>>>>>>>>        Set Location to 6 6
36742>>>>>>>>>
36742>>>>>>>>>        Begin_Row
36745>>>>>>>>>            Entry_Item Ctypkin.Ctypkin_code
36746>>>>>>>>>            Entry_Item Ctypkin.Ctypkin_descr
36747>>>>>>>>>        End_Row
36752>>>>>>>>>
36752>>>>>>>>>        Set Form_Width    item 0 to 71
36753>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª ‰ ¤ã©œàª"
36754>>>>>>>>>        
36754>>>>>>>>>        Set Form_Width    item 1 to 255
36755>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã ‰ ¤ã©œàª"
36756>>>>>>>>>        
36756>>>>>>>>>
36756>>>>>>>>>        //AB-StoreStart
36756>>>>>>>>>                    
36756>>>>>>>>>                    
36756>>>>>>>>>        Procedure Activate
36758>>>>>>>>>            Forward Send Activate
36760>>>>>>>>>            Send Beginning_Of_Data to oSelList True
36761>>>>>>>>>        End_Procedure
36762>>>>>>>>>        
36762>>>>>>>>>        
36762>>>>>>>>>        
36762>>>>>>>>>        
36762>>>>>>>>>        //AB-StoreEnd
36762>>>>>>>>>
36762>>>>>>>>>    End_Object    // oSelList
36763>>>>>>>>>
36763>>>>>>>>>    Object oOK_bn is a ButtonSub
36765>>>>>>>>>        Set Label to "&„§ ¢¦šã"
36766>>>>>>>>>        Set Location to 113 171
36767>>>>>>>>>
36767>>>>>>>>>        //AB-StoreStart
36767>>>>>>>>>        Procedure OnClick
36769>>>>>>>>>            Send OK To (oSelList(current_object))
36770>>>>>>>>>        End_Procedure
36771>>>>>>>>>        //AB-StoreEnd
36771>>>>>>>>>
36771>>>>>>>>>    End_Object    // oOK_bn
36772>>>>>>>>>
36772>>>>>>>>>    Object oCancel_bn is a ButtonSub
36774>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
36775>>>>>>>>>        Set Location to 113 226
36776>>>>>>>>>
36776>>>>>>>>>        //AB-StoreStart
36776>>>>>>>>>        Procedure OnClick
36778>>>>>>>>>            Send Cancel To (oSelList(current_object))
36779>>>>>>>>>        End_Procedure
36780>>>>>>>>>        //AB-StoreEnd
36780>>>>>>>>>
36780>>>>>>>>>    End_Object    // oCancel_bn
36781>>>>>>>>>
36781>>>>>>>>>    Object oSearch_bn is a ButtonSub
36783>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
36784>>>>>>>>>        Set Location to 113 281
36785>>>>>>>>>
36785>>>>>>>>>        //AB-StoreStart
36785>>>>>>>>>        Procedure OnClick
36787>>>>>>>>>            Send Search To (oSelList(current_object))
36788>>>>>>>>>        End_Procedure
36789>>>>>>>>>        //AB-StoreEnd
36789>>>>>>>>>
36789>>>>>>>>>    End_Object    // oSearch_bn
36790>>>>>>>>>
36790>>>>>>>>>
36790>>>>>>>>>    //AB-StoreStart
36790>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
36791>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
36792>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
36793>>>>>>>>>    
36793>>>>>>>>>    Procedure Activate Returns Integer
36795>>>>>>>>>        Integer rVal
36796>>>>>>>>>        Send Rebuild_Constraints to Ctypkin_DD
36797>>>>>>>>>        Forward Get Msg_Activate to rVal
36799>>>>>>>>>        Procedure_Return rVal
36800>>>>>>>>>    End_Procedure
36801>>>>>>>>>    
36801>>>>>>>>>    //AB-StoreEnd
36801>>>>>>>>>
36801>>>>>>>>>End_Object    // sl007
36802>>>>>>>>>
36802>>>>>>>>>//AB/ End_Object    // prj
36802>>>>>>>
36802>>>>>>>//DDB-Selection-pkg-End
36802>>>>>>>//DDB-FileEnd
36802>>>>>    Use COUNTRY.DD
INCLUDING FILE: COUNTRY.DD
36802>>>>>>>//DDB-FileStart
36802>>>>>>>//DDB-HeaderStart
36802>>>>>>>
36802>>>>>>>// File Name : COUNTRY.DD
36802>>>>>>>// Class Name: Country_DataDictionary
36802>>>>>>>// Revision  : 3
36802>>>>>>>// Version   : 2
36802>>>>>>>
36802>>>>>>>Use  Windows           // Basic Definitions
36802>>>>>>>Use  DataDict          // DataDictionary Class Definition
36802>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
36802>>>>>>>
36802>>>>>>>Open Country
36804>>>>>>>Open Towns
36806>>>>>>>
36806>>>>>>>//DDB-HeaderEnd
36806>>>>>>>//DDB-SelectionStart
36806>>>>>>>//DDB/ ExternalSelectionList sl058  sl058.SL
36806>>>>>>>Register_Object sl058
36806>>>>>>>//DDB-SelectionEnd
36806>>>>>>>
36806>>>>>>>Class Country_DataDictionary  is a DataDictionary_Sec
36807>>>>>>>
36807>>>>>>>    // Define_Fields:
36807>>>>>>>    // This procedure is used to set up all data-dictionary rules.
36807>>>>>>>
36807>>>>>>>    Procedure Define_Fields
36808>>>>>>>        Forward Send Define_Fields
36810>>>>>>>        //DDB-Generated-Code-Location
36810>>>>>>>        //DDB-DefineFieldStart
36810>>>>>>>
36810>>>>>>>        Set Main_File            To Country.File_Number
36811>>>>>>>        Set Cascade_Delete_State To FALSE
36812>>>>>>>
36812>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
36813>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
36814>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
36815>>>>>>>
36815>>>>>>>        // Child (Client) file structure................
36815>>>>>>>        Send Add_Client_File  Towns.File_Number
36816>>>>>>>
36816>>>>>>>        // Field-based properties.......................
36816>>>>>>>
36816>>>>>>>        // Country.Country_Id
36816>>>>>>>        Set Field_Options          Field Country.Country_Id To DD_AUTOFIND   
36817>>>>>>>        Set Field_Prompt_Object    Field Country.Country_Id To (sl058(Self))
36818>>>>>>>
36818>>>>>>>        // Country.Country_Descr
36818>>>>>>>        Set Field_Prompt_Object    Field Country.Country_Descr To (sl058(Self))
36819>>>>>>>
36819>>>>>>>        //DDB-DefineFieldEnd
36819>>>>>>>    End_Procedure    // Define_Fields
36820>>>>>>>
36820>>>>>>>    // Field_Defaults:
36820>>>>>>>    // This procedure is used to establish default field values.
36820>>>>>>>
36820>>>>>>>    Procedure Field_Defaults
36821>>>>>>>        Forward Send Field_Defaults
36823>>>>>>>        //DDB-Generated-Code-Location
36823>>>>>>>        //DDB-FieldDefaultStart
36823>>>>>>>        //DDB-FieldDefaultEnd
36823>>>>>>>    End_Procedure    // Field_Defaults
36824>>>>>>>
36824>>>>>>>End_Class    // Country_DataDictionary
36825>>>>>>>//DDB-Selection-pkg-Start
36825>>>>>>>
36825>>>>>>>Use sl058.SL         // sl058
INCLUDING FILE: SL058.SL
36825>>>>>>>>>//AB/ Project sl058 : Countries - Xores
36825>>>>>>>>>//AB/     Object prj is a Lookup_Project
36825>>>>>>>>>//AB/         Set ProjectName to "sl058 : Countries - Xores"
36825>>>>>>>>>//AB/         Set ProjectFileName to "sl058.SL"
36825>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
36825>>>>>>>>>
36825>>>>>>>>>// Project Object Structure
36825>>>>>>>>>//   sl058 is a dbModalPanelSub
36825>>>>>>>>>//     Country_DD is a DataDictionary
36825>>>>>>>>>//     oSelList is a dbListSub
36825>>>>>>>>>//     oOK_bn is a ButtonSub
36825>>>>>>>>>//     oCancel_bn is a ButtonSub
36825>>>>>>>>>//     oSearch_bn is a ButtonSub
36825>>>>>>>>>
36825>>>>>>>>>// Register all objects
36825>>>>>>>>>Register_Object Country_DD
36825>>>>>>>>>Register_Object oCancel_bn
36825>>>>>>>>>Register_Object oOK_bn
36825>>>>>>>>>Register_Object oSearch_bn
36825>>>>>>>>>Register_Object oSelList
36825>>>>>>>>>Register_Object sl058
36825>>>>>>>>>
36825>>>>>>>>>
36825>>>>>>>>>    //AB-IgnoreStart
36825>>>>>>>>>
36825>>>>>>>>>    Use DFAllEnt.pkg
36825>>>>>>>>>    Use dbList.Sub
36825>>>>>>>>>    Use Button.Sub
36825>>>>>>>>>
36825>>>>>>>>>
36825>>>>>>>>>    Use Country.DD
36825>>>>>>>>>    
36825>>>>>>>>>    //AB-IgnoreEnd
36825>>>>>>>>>
36825>>>>>>>>>    Object sl058 is a dbModalPanelSub
36827>>>>>>>>>        Set Label to "•é¨œª"
36828>>>>>>>>>        Set Size to 148 297
36829>>>>>>>>>        Set Location to 6 10
36830>>>>>>>>>        Set Exit_Application_Local_State to FALSE
36831>>>>>>>>>        Set Modal_State to FALSE
36832>>>>>>>>>
36832>>>>>>>>>        //AB-DDOStart
36832>>>>>>>>>
36832>>>>>>>>>        Object Country_DD is a Country_DataDictionary
36834>>>>>>>>>        End_Object    // Country_DD
36835>>>>>>>>>
36835>>>>>>>>>        Set Main_DD to (Country_DD(self))
36836>>>>>>>>>        Set Server to (Country_DD(self))
36837>>>>>>>>>
36837>>>>>>>>>        //AB-DDOEnd
36837>>>>>>>>>
36837>>>>>>>>>        Object oSelList is a dbListSub
36839>>>>>>>>>            Set Main_File to Country.File_Number
36840>>>>>>>>>            Set Size to 105 280
36841>>>>>>>>>            Set Location to 6 6
36842>>>>>>>>>
36842>>>>>>>>>            Begin_Row
36845>>>>>>>>>                Entry_Item Country.Country_id
36846>>>>>>>>>                Entry_Item Country.Country_descr
36847>>>>>>>>>            End_Row
36852>>>>>>>>>
36852>>>>>>>>>            Set Form_Width    item 0 to 87
36853>>>>>>>>>            Set Header_Label  item 0 to "‰à›"
36854>>>>>>>>>            
36854>>>>>>>>>            Set Form_Width    item 1 to 183
36855>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
36856>>>>>>>>>            
36856>>>>>>>>>        End_Object    // oSelList
36857>>>>>>>>>
36857>>>>>>>>>        Object oOK_bn is a ButtonSub
36859>>>>>>>>>            Set Label to "&„§ ¢¦šã"
36860>>>>>>>>>            Set Location to 115 126
36861>>>>>>>>>
36861>>>>>>>>>            //AB-StoreStart
36861>>>>>>>>>            Procedure OnClick
36863>>>>>>>>>                Send OK To (oSelList(current_object))
36864>>>>>>>>>            End_Procedure
36865>>>>>>>>>            //AB-StoreEnd
36865>>>>>>>>>
36865>>>>>>>>>        End_Object    // oOK_bn
36866>>>>>>>>>
36866>>>>>>>>>        Object oCancel_bn is a ButtonSub
36868>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
36869>>>>>>>>>            Set Location to 115 181
36870>>>>>>>>>
36870>>>>>>>>>            //AB-StoreStart
36870>>>>>>>>>            Procedure OnClick
36872>>>>>>>>>                Send Cancel To (oSelList(current_object))
36873>>>>>>>>>            End_Procedure
36874>>>>>>>>>            //AB-StoreEnd
36874>>>>>>>>>
36874>>>>>>>>>        End_Object    // oCancel_bn
36875>>>>>>>>>
36875>>>>>>>>>        Object oSearch_bn is a ButtonSub
36877>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
36878>>>>>>>>>            Set Location to 115 236
36879>>>>>>>>>
36879>>>>>>>>>            //AB-StoreStart
36879>>>>>>>>>            Procedure OnClick
36881>>>>>>>>>                Send Search To (oSelList(current_object))
36882>>>>>>>>>            End_Procedure
36883>>>>>>>>>            //AB-StoreEnd
36883>>>>>>>>>
36883>>>>>>>>>        End_Object    // oSearch_bn
36884>>>>>>>>>
36884>>>>>>>>>
36884>>>>>>>>>        //AB-StoreStart
36884>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
36885>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
36886>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
36887>>>>>>>>>        //AB-StoreEnd
36887>>>>>>>>>
36887>>>>>>>>>    End_Object    // sl058
36888>>>>>>>>>
36888>>>>>>>>>//AB/     End_Object    // prj
36888>>>>>>>
36888>>>>>>>//DDB-Selection-pkg-End
36888>>>>>>>//DDB-FileEnd
36888>>>>>    Use TOWNS.DD
INCLUDING FILE: TOWNS.DD
36888>>>>>>>//DDB-FileStart
36888>>>>>>>//DDB-HeaderStart
36888>>>>>>>
36888>>>>>>>// File Name : TOWNS.DD
36888>>>>>>>// Class Name: Towns_DataDictionary
36888>>>>>>>// Revision  : 8
36888>>>>>>>// Version   : 2
36888>>>>>>>
36888>>>>>>>Use  Windows           // Basic Definitions
36888>>>>>>>Use  DataDict          // DataDictionary Class Definition
36888>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
36888>>>>>>>
36888>>>>>>>Open Towns
36890>>>>>>>Open Cities
36892>>>>>>>Open Country
36894>>>>>>>
36894>>>>>>>//DDB-HeaderEnd
36894>>>>>>>//DDB-SelectionStart
36894>>>>>>>//DDB/ ExternalSelectionList sl057  sl057.SL
36894>>>>>>>Register_Object sl057
36894>>>>>>>//DDB-SelectionEnd
36894>>>>>>>
36894>>>>>>>Class Towns_DataDictionary  is a DataDictionary_Sec
36895>>>>>>>
36895>>>>>>>    Procedure Save_Main_File
36896>>>>>>>        If (Operation_Origin<>Self) Begin
36898>>>>>>>            If Towns.Recnum Eq 0 Procedure_Return
36901>>>>>>>        End
36901>>>>>>>>
36901>>>>>>>        Forward Send Save_Main_File
36903>>>>>>>    End_Procedure
36904>>>>>>>
36904>>>>>>>
36904>>>>>>>    // Define_Fields:
36904>>>>>>>    // This procedure is used to set up all data-dictionary rules.
36904>>>>>>>
36904>>>>>>>    Procedure Define_Fields
36905>>>>>>>        Forward Send Define_Fields
36907>>>>>>>        //DDB-Generated-Code-Location
36907>>>>>>>        //DDB-DefineFieldStart
36907>>>>>>>
36907>>>>>>>        Set Main_File            To Towns.File_Number
36908>>>>>>>        Set Cascade_Delete_State To FALSE
36909>>>>>>>
36909>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   to DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
36910>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD to DD_NOPUT       DD_FINDREQ    
36911>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    to DD_DISPLAYONLY
36912>>>>>>>
36912>>>>>>>        // Child (Client) file structure................
36912>>>>>>>        Send Add_Client_File  Cities.File_Number
36913>>>>>>>
36913>>>>>>>        // Parent (Server) file structure...............
36913>>>>>>>        Send Add_Server_File  Country.File_Number
36914>>>>>>>
36914>>>>>>>        // Field-based properties.......................
36914>>>>>>>
36914>>>>>>>        // Towns.Country_Id
36914>>>>>>>        Set Key_Field_State        Field Towns.Country_Id To TRUE
36915>>>>>>>
36915>>>>>>>        // Towns.Town_Id
36915>>>>>>>        Set Field_Options          Field Towns.Town_Id To DD_AUTOFIND   
36916>>>>>>>        Set Field_Prompt_Object    Field Towns.Town_Id To (sl057(Self))
36917>>>>>>>
36917>>>>>>>        // Towns.Town_Descr
36917>>>>>>>        Set Field_Prompt_Object    Field Towns.Town_Descr To (sl057(Self))
36918>>>>>>>
36918>>>>>>>        //DDB-DefineFieldEnd
36918>>>>>>>    End_Procedure    // Define_Fields
36919>>>>>>>
36919>>>>>>>    // Field_Defaults:
36919>>>>>>>    // This procedure is used to establish default field values.
36919>>>>>>>
36919>>>>>>>    Procedure Field_Defaults
36920>>>>>>>        Forward Send Field_Defaults
36922>>>>>>>        //DDB-Generated-Code-Location
36922>>>>>>>        //DDB-FieldDefaultStart
36922>>>>>>>        //DDB-FieldDefaultEnd
36922>>>>>>>    End_Procedure    // Field_Defaults
36923>>>>>>>
36923>>>>>>>End_Class    // Towns_DataDictionary
36924>>>>>>>//DDB-Selection-pkg-Start
36924>>>>>>>
36924>>>>>>>Use sl057.SL         // sl057
INCLUDING FILE: SL057.SL
36924>>>>>>>>>//AB/ Project sl057 : Towns -Nomoi - Eyr Perioxes
36924>>>>>>>>>//AB/     Object prj is a Lookup_Project
36924>>>>>>>>>//AB/         Set ProjectName to "sl057 : Towns -Nomoi - Eyr Perioxes"
36924>>>>>>>>>//AB/         Set ProjectFileName to "sl057.SL"
36924>>>>>>>>>
36924>>>>>>>>>// Project Object Structure
36924>>>>>>>>>//   sl057 is a dbModalPanelSub
36924>>>>>>>>>//     Country_DD is a DataDictionary
36924>>>>>>>>>//     Towns_DD is a DataDictionary
36924>>>>>>>>>//     oSelList is a dbListSub
36924>>>>>>>>>//     oOK_bn is a ButtonSub
36924>>>>>>>>>//     oCancel_bn is a ButtonSub
36924>>>>>>>>>//     oSearch_bn is a ButtonSub
36924>>>>>>>>>
36924>>>>>>>>>// Register all objects
36924>>>>>>>>>Register_Object Country_DD
36924>>>>>>>>>Register_Object oCancel_bn
36924>>>>>>>>>Register_Object oOK_bn
36924>>>>>>>>>Register_Object oSearch_bn
36924>>>>>>>>>Register_Object oSelList
36924>>>>>>>>>Register_Object sl057
36924>>>>>>>>>Register_Object Towns_DD
36924>>>>>>>>>
36924>>>>>>>>>
36924>>>>>>>>>    //AB-IgnoreStart
36924>>>>>>>>>
36924>>>>>>>>>    Use DFAllEnt.pkg
36924>>>>>>>>>    Use dbList.Sub
36924>>>>>>>>>    Use Button.Sub
36924>>>>>>>>>
36924>>>>>>>>>
36924>>>>>>>>>    Use COUNTRY.DD
36924>>>>>>>>>    Use TOWNS.DD
36924>>>>>>>>>    
36924>>>>>>>>>    //AB-IgnoreEnd
36924>>>>>>>>>
36924>>>>>>>>>    Object sl057 is a dbModalPanelSub
36926>>>>>>>>>        Set Label to "Œ¦£¦å - „¬¨ç«œ¨œª §œ¨ ¦®âª"
36927>>>>>>>>>        Set Size to 148 297
36928>>>>>>>>>        Set Location to 6 10
36929>>>>>>>>>        Set Exit_Application_Local_State to FALSE
36930>>>>>>>>>        Set Modal_State to FALSE
36931>>>>>>>>>
36931>>>>>>>>>        //AB-DDOStart
36931>>>>>>>>>
36931>>>>>>>>>        Object Country_DD is a Country_DataDictionary
36933>>>>>>>>>        End_Object    // Country_DD
36934>>>>>>>>>
36934>>>>>>>>>        Object Towns_DD is a Towns_DataDictionary
36936>>>>>>>>>            Set DDO_Server to (Country_DD(self))
36937>>>>>>>>>        End_Object    // Towns_DD
36938>>>>>>>>>
36938>>>>>>>>>        Set Main_DD to (Towns_DD(self))
36939>>>>>>>>>        Set Server to (Towns_DD(self))
36940>>>>>>>>>
36940>>>>>>>>>        //AB-DDOEnd
36940>>>>>>>>>
36940>>>>>>>>>        Object oSelList is a dbListSub
36942>>>>>>>>>            Set Main_File to Towns.File_Number
36943>>>>>>>>>            Set Size to 105 280
36944>>>>>>>>>            Set Location to 6 6
36945>>>>>>>>>
36945>>>>>>>>>            Begin_Row
36948>>>>>>>>>                Entry_Item Towns.Town_id
36949>>>>>>>>>                Entry_Item Towns.Town_descr
36950>>>>>>>>>                Entry_Item Country.Country_descr
36951>>>>>>>>>            End_Row
36956>>>>>>>>>
36956>>>>>>>>>            Set Form_Width    item 0 to 43
36957>>>>>>>>>            Set Header_Label  item 0 to "‰à›"
36958>>>>>>>>>            
36958>>>>>>>>>            Set Form_Width    item 1 to 137
36959>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
36960>>>>>>>>>            
36960>>>>>>>>>            Set Form_Width    item 2 to 94
36961>>>>>>>>>            Set Header_Label  item 2 to "•é¨˜"
36962>>>>>>>>>            
36962>>>>>>>>>        End_Object    // oSelList
36963>>>>>>>>>
36963>>>>>>>>>        Object oOK_bn is a ButtonSub
36965>>>>>>>>>            Set Label to "&„§ ¢¦šã"
36966>>>>>>>>>            Set Location to 115 126
36967>>>>>>>>>
36967>>>>>>>>>            //AB-StoreStart
36967>>>>>>>>>            Procedure OnClick
36969>>>>>>>>>                Send OK To (oSelList(current_object))
36970>>>>>>>>>            End_Procedure
36971>>>>>>>>>            //AB-StoreEnd
36971>>>>>>>>>
36971>>>>>>>>>        End_Object    // oOK_bn
36972>>>>>>>>>
36972>>>>>>>>>        Object oCancel_bn is a ButtonSub
36974>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
36975>>>>>>>>>            Set Location to 115 181
36976>>>>>>>>>
36976>>>>>>>>>            //AB-StoreStart
36976>>>>>>>>>            Procedure OnClick
36978>>>>>>>>>                Send Cancel To (oSelList(current_object))
36979>>>>>>>>>            End_Procedure
36980>>>>>>>>>            //AB-StoreEnd
36980>>>>>>>>>
36980>>>>>>>>>        End_Object    // oCancel_bn
36981>>>>>>>>>
36981>>>>>>>>>        Object oSearch_bn is a ButtonSub
36983>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
36984>>>>>>>>>            Set Location to 115 236
36985>>>>>>>>>
36985>>>>>>>>>            //AB-StoreStart
36985>>>>>>>>>            Procedure OnClick
36987>>>>>>>>>                Send Search To (oSelList(current_object))
36988>>>>>>>>>            End_Procedure
36989>>>>>>>>>            //AB-StoreEnd
36989>>>>>>>>>
36989>>>>>>>>>        End_Object    // oSearch_bn
36990>>>>>>>>>
36990>>>>>>>>>
36990>>>>>>>>>        //AB-StoreStart
36990>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
36991>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
36992>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
36993>>>>>>>>>        //AB-StoreEnd
36993>>>>>>>>>
36993>>>>>>>>>    End_Object    // sl057
36994>>>>>>>>>
36994>>>>>>>>>//AB/     End_Object    // prj
36994>>>>>>>
36994>>>>>>>//DDB-Selection-pkg-End
36994>>>>>>>//DDB-FileEnd
36994>>>>>    Use CITIES.DD
36994>>>>>    Use PAYRESP.DD
INCLUDING FILE: PAYRESP.DD
36994>>>>>>>//DDB-FileStart
36994>>>>>>>//DDB-HeaderStart
36994>>>>>>>
36994>>>>>>>// File Name : PAYRESP.DD
36994>>>>>>>// Class Name: Payresp_DataDictionary
36994>>>>>>>// Revision  : 78
36994>>>>>>>// Version   : 2
36994>>>>>>>
36994>>>>>>>Use  Windows           // Basic Definitions
36994>>>>>>>Use  DataDict          // DataDictionary Class Definition
36994>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
36994>>>>>>>
36994>>>>>>>Open Payresp
36996>>>>>>>Open Prspbank
INCLUDING FILE: PRSPBANK.FD
36998>>>>>>>Open Tppresp
INCLUDING FILE: TPPRESP.FD
37000>>>>>>>Open Clients
37002>>>>>>>Open Sysrecc
37004>>>>>>>
37004>>>>>>>//DDB-HeaderEnd
37004>>>>>>>//DDB-ValidationStart
37004>>>>>>>
37004>>>>>>>Register_Object Payresp_Presp_Doy_VT
37004>>>>>>>Register_Object Payresp_Presp_Categfpa_VT
37004>>>>>>>Register_Object Payresp_Feregios_VT
37004>>>>>>>
37004>>>>>>>Object Payresp_Presp_Doy_VT  is a CodeValidationTable
37006>>>>>>>    Set Type_Value        To "DOY"
37007>>>>>>>    Set Allow_Blank_State To TRUE
37008>>>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
37009>>>>>>>    //DDB-ValidationCustomStart
37009>>>>>>>    //DDB-ValidationCustomEnd
37009>>>>>>>End_Object   // Payresp_Presp_Doy_VT
37010>>>>>>>
37010>>>>>>>Object Payresp_Presp_Categfpa_VT  is a CodeValidationTable
37012>>>>>>>    Set Type_Value        To "VAT_STATUS"
37013>>>>>>>    Set Validate_State    To FALSE
37014>>>>>>>    Set Allow_Blank_State To TRUE
37015>>>>>>>    //DDB-ValidationCustomStart
37015>>>>>>>    //DDB-ValidationCustomEnd
37015>>>>>>>End_Object   // Payresp_Presp_Categfpa_VT
37016>>>>>>>
37016>>>>>>>Object Payresp_Feregios_VT  is a CodeValidationTable
37018>>>>>>>    Set Type_Value        To "FEREGIOS"
37019>>>>>>>    Set Allow_Blank_State To TRUE
37020>>>>>>>    Set Table_Title       To "ƒœå¡«œª ”œ¨œšš¬æ«ž«˜ª ”¦¨âà¤"
37021>>>>>>>    //DDB-ValidationCustomStart
37021>>>>>>>    //DDB-ValidationCustomEnd
37021>>>>>>>End_Object   // Payresp_Feregios_VT
37022>>>>>>>//DDB-ValidationEnd
37022>>>>>>>//DDB-SelectionStart
37022>>>>>>>//DDB/ ExternalSelectionList sl111  sl111.SL
37022>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
37022>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
37022>>>>>>>Register_Object sl111
37022>>>>>>>Register_Object sl198
37022>>>>>>>Register_Object sl197
37022>>>>>>>//DDB-SelectionEnd
37022>>>>>>>
37022>>>>>>>Open Year      
37024>>>>>>>
37024>>>>>>>Class Payresp_DataDictionary  is a DataDictionary_Sec
37025>>>>>>>
37025>>>>>>>    Procedure Construct_Object
37026>>>>>>>        Forward Send Construct_Object
37028>>>>>>>        Property Integer piCheckPlaf        Public 0
37029>>>>>>>    End_procedure
37030>>>>>>>
37030>>>>>>>    Procedure Update
37031>>>>>>>        Forward Send Update
37033>>>>>>>        Move SysCurXR.Company_Code  to payresp.Company_Code
37034>>>>>>>        Move SysCurXR.Branch_Code   to payresp.Branch_Code
37035>>>>>>>        Move SysCurXR.Year_Year     to payresp.Year_Year
37036>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
37036>>>>>>>        Move (payresp.Xreosh-payresp.Pistosh)   to payresp.Ypoloipo
37037>>>>>>>        Move (payresp.Plafon-payresp.ypoloipo)  to payresp.Overhead
37038>>>>>>>
37038>>>>>>>        //betolink
37038>>>>>>>        Move SysCurXR.Beto_Site      to payresp.presp_SiteW
37039>>>>>>>        Move payresp.presp_Rec0      to payresp.presp_SN
37040>>>>>>>        Move payresp.presp_id        to payresp.presp_Repm
37041>>>>>>>
37041>>>>>>>    End_Procedure   // Update
37042>>>>>>>
37042>>>>>>>     Procedure Creating
37043>>>>>>>        Forward Send Creating
37045>>>>>>>        // Insert Code Here
37045>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(payresp.presp_Rec0))))));                                    to payresp.presp_Recr
37046>>>>>>>        Move '1'                    to payresp.presp_Active
37047>>>>>>>        get fsgCode_With_Zeroes payresp.presp_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to payresp.presp_ID
37048>>>>>>>        clear year
37049>>>>>>>        move syscurxr.branch_code   to year.branch_code
37050>>>>>>>        move syscurxr.company_code  to year.company_code
37051>>>>>>>        move syscurxr.year_year     to YEAR.year_year
37052>>>>>>>        find eq year by index.1
37053>>>>>>>>
37053>>>>>>>        if (found=1) begin
37055>>>>>>>            move year.payresp_plafon to payresp.plafon
37056>>>>>>>            move year.payresp_ofeilh to payresp.orio_syn_ofeilh
37057>>>>>>>        end
37057>>>>>>>>
37057>>>>>>>    End_Procedure   // Creating
37058>>>>>>>
37058>>>>>>>   Function Validate_Save  Returns Integer
37059>>>>>>>        Integer iReturnVal iCheck iYes
37060>>>>>>>        Forward Get Validate_Save  To iReturnVal
37062>>>>>>>        If (Not(iReturnVal)) Begin
37064>>>>>>>
37064>>>>>>>            If (Sysfile.Check_Afm=1) Begin
37066>>>>>>>                Move (Check_AFM(payresp.presp_Afm)) to iCheck
37067>>>>>>>                If (iCheck) Begin
37069>>>>>>>                         If (iCheck=1) Move 4001 to iReturnVal
37072>>>>>>>                    Else If (iCheck=2) Move 4002 to iReturnVal
37076>>>>>>>                    Else If (iCheck=3) Move 4003 to iReturnVal
37080>>>>>>>                End
37080>>>>>>>>
37080>>>>>>>            End
37080>>>>>>>>
37080>>>>>>>
37080>>>>>>>           If (piCheckPlaf(Self)=1) Begin
37082>>>>>>>                If ((PayResp.Plafon>0) And ((PayResp.Ypoloipo+PayResp.Posa_Apo_Dap)>PayResp.Plafon)) Begin
37084>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 5000 Payresp'  to iYes
37085>>>>>>>                        If (iYes=MBR_NO) Error 4004 'DDC111: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4004 to iReturnVal
37088>>>>>>>                End
37088>>>>>>>>
37088>>>>>>>                Else If ((PayResp.Orio_Syn_Ofeilh>0) And (PayResp.Synolikh_Ofeilh>PayResp.Orio_Syn_Ofeilh)) Begin
37091>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 5001 Payresp' to iYes
37092>>>>>>>                        If (iYes=MBR_NO) Error 4005 'DDC111: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
37095>>>>>>>                End
37095>>>>>>>>
37095>>>>>>>           End
37095>>>>>>>>
37095>>>>>>>        If (iReturnVal) Send Operation_Not_Allowed iReturnVal
37098>>>>>>>        End
37098>>>>>>>>
37098>>>>>>>        Function_Return iReturnVal
37099>>>>>>>    End_Function   // Validate_Save
37100>>>>>>>
37100>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
37101>>>>>>>        String lsError_Message
37102>>>>>>>        Case Begin
37102>>>>>>>            Case (iError_Num = 4001)
37104>>>>>>>                Move "DDC 100: Š˜¤Ÿ˜©£â¤¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤" to lsError_Message
37105>>>>>>>              Case Break
37106>>>>>>>            Case (iError_Num = 4002)
37109>>>>>>>                Move "DDC 100: ’¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤ ›œ¤ œå¤˜  9 ¯ã­ ¦" to lsError_Message
37110>>>>>>>              Case Break
37111>>>>>>>            Case (iError_Num = 4003)
37114>>>>>>>                Move "DDC 100: €¡˜«á¢¢ž¢¦ª ®˜¨˜¡«ã¨˜ª ©«¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤ " to lsError_Message
37115>>>>>>>              Case Break
37116>>>>>>>            Case (iError_Num = 4004)
37119>>>>>>>                Move "DDC 100: „š ¤œ ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç" to lsError_Message
37120>>>>>>>              Case Break
37121>>>>>>>            Case (iError_Num = 4005)
37124>>>>>>>                Move "DDC 100: „š ¤œ ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª" to lsError_Message
37125>>>>>>>              Case Break
37126>>>>>>>            Case Else
37126>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
37128>>>>>>>        Case End
37128>>>>>>>        Error iError_Num lsError_Message
37129>>>>>>>>
37129>>>>>>>    End_Procedure // operation_not_allowed
37130>>>>>>>
37130>>>>>>>
37130>>>>>>>
37130>>>>>>>    Procedure Define_Fields
37131>>>>>>>        Forward Send Define_Fields
37133>>>>>>>        //DDB-Generated-Code-Location
37133>>>>>>>        //DDB-DefineFieldStart
37133>>>>>>>
37133>>>>>>>        Set Main_File            To Payresp.File_Number
37134>>>>>>>        Set Cascade_Delete_State To FALSE
37135>>>>>>>
37135>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
37136>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
37137>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
37138>>>>>>>
37138>>>>>>>        // Child (Client) file structure................
37138>>>>>>>        Send Add_Client_File  Prspbank.File_Number
37139>>>>>>>        Send Add_Client_File  Tppresp.File_Number
37140>>>>>>>        Send Add_Client_File  Clients.File_Number
37141>>>>>>>
37141>>>>>>>        // External (System) file structure.............
37141>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
37142>>>>>>>
37142>>>>>>>        Define_Auto_Increment  Sysrecc.Payresp_Rec0  To Payresp.Presp_Rec0
37145>>>>>>>
37145>>>>>>>        // Field-based properties.......................
37145>>>>>>>
37145>>>>>>>        // Payresp.Company_Code
37145>>>>>>>
37145>>>>>>>        // Payresp.Branch_Code
37145>>>>>>>
37145>>>>>>>        // Payresp.Year_Year
37145>>>>>>>
37145>>>>>>>        // Payresp.Custprom_Code
37145>>>>>>>
37145>>>>>>>        // Payresp.Presp_Id
37145>>>>>>>        Set Field_Options          Field Payresp.Presp_Id To DD_AUTOFIND    DD_NOPUT      
37146>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Id To (sl111(Self))
37147>>>>>>>        Set Key_Field_State        Field Payresp.Presp_Id To TRUE
37148>>>>>>>
37148>>>>>>>        // Payresp.Presp_Name
37148>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Name To (sl111(Self))
37149>>>>>>>
37149>>>>>>>        // Payresp.Presp_Afm
37149>>>>>>>
37149>>>>>>>        // Payresp.Presp_Rec0
37149>>>>>>>
37149>>>>>>>        // Payresp.Custprom_Recr
37149>>>>>>>
37149>>>>>>>        // Payresp.Presp_Recr
37149>>>>>>>
37149>>>>>>>        // Payresp.Last_Xreosh
37149>>>>>>>
37149>>>>>>>        // Payresp.Last_Pistosh
37149>>>>>>>
37149>>>>>>>        // Payresp.Last_Order
37149>>>>>>>
37149>>>>>>>        // Payresp.Presp_Doy
37149>>>>>>>        Set Field_Value_Table      Field Payresp.Presp_Doy To (Payresp_Presp_Doy_VT(Self))
37150>>>>>>>
37150>>>>>>>        // Payresp.Presp_Address
37150>>>>>>>
37150>>>>>>>        // Payresp.Presp_City_Id
37150>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_City_Id To (sl198(Self))
37151>>>>>>>
37151>>>>>>>        // Payresp.Presp_Area
37151>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Area To (sl197(Self))
37152>>>>>>>
37152>>>>>>>        // Payresp.Presp_Job
37152>>>>>>>
37152>>>>>>>        // Payresp.Presp_Respons
37152>>>>>>>
37152>>>>>>>        // Payresp.Presp_Zipcode
37152>>>>>>>
37152>>>>>>>        // Payresp.Presp_Phone
37152>>>>>>>
37152>>>>>>>        // Payresp.Presp_Fax
37152>>>>>>>
37152>>>>>>>        // Payresp.Presp_Mobile
37152>>>>>>>
37152>>>>>>>        // Payresp.Presp_Aoh
37152>>>>>>>
37152>>>>>>>        // Payresp.Presp_Email
37152>>>>>>>
37152>>>>>>>        // Payresp.Presp_Class
37152>>>>>>>
37152>>>>>>>        // Payresp.Presp_Details
37152>>>>>>>
37152>>>>>>>        // Payresp.Presp_Sitew
37152>>>>>>>
37152>>>>>>>        // Payresp.Presp_Codem
37152>>>>>>>
37152>>>>>>>        // Payresp.Presp_Categfpa
37152>>>>>>>        Set Field_Value_Table      Field Payresp.Presp_Categfpa To (Payresp_Presp_Categfpa_VT(Self))
37153>>>>>>>
37153>>>>>>>        // Payresp.Presp_Fpa
37153>>>>>>>
37153>>>>>>>        // Payresp.Presp_Public
37153>>>>>>>
37153>>>>>>>        // Payresp.Presp_Sn
37153>>>>>>>
37153>>>>>>>        // Payresp.Presp_Repm
37153>>>>>>>
37153>>>>>>>        // Payresp.Presp_Active
37153>>>>>>>
37153>>>>>>>        // Payresp.Presp_Reported
37153>>>>>>>
37153>>>>>>>        // Payresp.Presp_Pelprom
37153>>>>>>>
37153>>>>>>>        // Payresp.Presp_Lastupd
37153>>>>>>>
37153>>>>>>>        // Payresp.Presp_Markexp
37153>>>>>>>
37153>>>>>>>        // Payresp.Presp_Catjob
37153>>>>>>>
37153>>>>>>>        // Payresp.Is_Promhtheyths
37153>>>>>>>
37153>>>>>>>        // Payresp.Xreosh
37153>>>>>>>
37153>>>>>>>        // Payresp.Pistosh
37153>>>>>>>
37153>>>>>>>        // Payresp.Ypoloipo
37153>>>>>>>
37153>>>>>>>        // Payresp.Plafon
37153>>>>>>>
37153>>>>>>>        // Payresp.Overhead
37153>>>>>>>
37153>>>>>>>        // Payresp.Presp_Add_No
37153>>>>>>>
37153>>>>>>>        // Payresp.Presp_Nomos
37153>>>>>>>
37153>>>>>>>        // Payresp.Presp_Xora
37153>>>>>>>
37153>>>>>>>        // Payresp.Polh_Recr
37153>>>>>>>
37153>>>>>>>        // Payresp.Synolikh_Ofeilh
37153>>>>>>>
37153>>>>>>>        // Payresp.Stoxos_Ipal
37153>>>>>>>
37153>>>>>>>        // Payresp.Stoxos_Ipso
37153>>>>>>>
37153>>>>>>>        // Payresp.Poso_Se_Apait
37153>>>>>>>
37153>>>>>>>        // Payresp.Orio_Syn_Ofeilh
37153>>>>>>>
37153>>>>>>>        // Payresp.Posa_Apo_Dap
37153>>>>>>>
37153>>>>>>>        // Payresp.Feregios
37153>>>>>>>        Set Field_Value_Table      Field Payresp.Feregios To (Payresp_Feregios_VT(Self))
37154>>>>>>>
37154>>>>>>>        //DDB-DefineFieldEnd
37154>>>>>>>    End_Procedure    // Define_Fields
37155>>>>>>>
37155>>>>>>>    // Field_Defaults:
37155>>>>>>>    // This procedure is used to establish default field values.
37155>>>>>>>
37155>>>>>>>    Procedure Field_Defaults
37156>>>>>>>        Forward Send Field_Defaults
37158>>>>>>>        //DDB-Generated-Code-Location
37158>>>>>>>        //DDB-FieldDefaultStart
37158>>>>>>>        Set Field_Changed_Value   Field Payresp.Presp_Doy To "0"
37159>>>>>>>        //DDB-FieldDefaultEnd
37159>>>>>>>    End_Procedure    // Field_Defaults
37160>>>>>>>
37160>>>>>>>End_Class    // Payresp_DataDictionary
37161>>>>>>>//DDB-Selection-pkg-Start
37161>>>>>>>
37161>>>>>>>Use sl111.SL         // sl111
INCLUDING FILE: SL111.SL
37161>>>>>>>>>//AB/ Project sl111
37161>>>>>>>>>//AB/ Object prj is a Lookup_Project
37161>>>>>>>>>//AB/     Set ProjectName to "sl111"
37161>>>>>>>>>//AB/     Set ProjectFileName to "sl111.SL"
37161>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
37161>>>>>>>>>
37161>>>>>>>>>// Project Object Structure
37161>>>>>>>>>//   sl111 is a dbModalPanelSub
37161>>>>>>>>>//     Payresp_DD is a DataDictionary
37161>>>>>>>>>//     oSelList is a dbListSub
37161>>>>>>>>>//     oOK_bn is a ButtonSub
37161>>>>>>>>>//     oCancel_bn is a ButtonSub
37161>>>>>>>>>//     oSearch_bn is a ButtonSub
37161>>>>>>>>>
37161>>>>>>>>>// Register all objects
37161>>>>>>>>>Register_Object oCancel_bn
37161>>>>>>>>>Register_Object oOK_bn
37161>>>>>>>>>Register_Object oSearch_bn
37161>>>>>>>>>Register_Object oSelList
37161>>>>>>>>>Register_Object Payresp_DD
37161>>>>>>>>>Register_Object sl111
37161>>>>>>>>>
37161>>>>>>>>>
37161>>>>>>>>>//AB-IgnoreStart
37161>>>>>>>>>
37161>>>>>>>>>Use DFAllEnt.pkg
37161>>>>>>>>>Use dbList.Sub
37161>>>>>>>>>Use Button.Sub
37161>>>>>>>>>
37161>>>>>>>>>
37161>>>>>>>>>Use PAYRESP.DD
37161>>>>>>>>>
37161>>>>>>>>>//AB-IgnoreEnd
37161>>>>>>>>>
37161>>>>>>>>>Object sl111 is a dbModalPanelSub
37163>>>>>>>>>    Set Label to "“§œçŸ¬¤¦  ¢ž¨à£é¤ "
37164>>>>>>>>>    Set Size to 148 443
37165>>>>>>>>>    Set Location to 4 5
37166>>>>>>>>>    Set Exit_Application_Local_State to FALSE
37167>>>>>>>>>    Set Modal_State to FALSE
37168>>>>>>>>>
37168>>>>>>>>>    //AB-DDOStart
37168>>>>>>>>>
37168>>>>>>>>>    Object Payresp_DD is a Payresp_DataDictionary
37170>>>>>>>>>    End_Object    // Payresp_DD
37171>>>>>>>>>
37171>>>>>>>>>    Set Main_DD to (Payresp_DD(self))
37172>>>>>>>>>    Set Server to (Payresp_DD(self))
37173>>>>>>>>>
37173>>>>>>>>>    //AB-DDOEnd
37173>>>>>>>>>
37173>>>>>>>>>    Object oSelList is a dbListSub
37175>>>>>>>>>        Set Main_File to Payresp.File_Number
37176>>>>>>>>>        Set Size to 105 430
37177>>>>>>>>>        Set Location to 6 6
37178>>>>>>>>>
37178>>>>>>>>>        Begin_Row
37181>>>>>>>>>            Entry_Item Payresp.Presp_id
37182>>>>>>>>>            Entry_Item Payresp.Presp_name
37183>>>>>>>>>            Entry_Item Payresp.Presp_afm
37184>>>>>>>>>            Entry_Item Payresp.Presp_address
37185>>>>>>>>>            Entry_Item Payresp.Presp_phone
37186>>>>>>>>>        End_Row
37191>>>>>>>>>
37191>>>>>>>>>        Set Form_Width    item 0 to 60
37192>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
37193>>>>>>>>>        
37193>>>>>>>>>        Set Form_Width    item 1 to 106
37194>>>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
37195>>>>>>>>>        
37195>>>>>>>>>        Set Form_Width    item 2 to 60
37196>>>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
37197>>>>>>>>>        
37197>>>>>>>>>        Set Form_Width    item 3 to 135
37198>>>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
37199>>>>>>>>>        
37199>>>>>>>>>        Set Form_Width    item 4 to 60
37200>>>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
37201>>>>>>>>>        
37201>>>>>>>>>    End_Object    // oSelList
37202>>>>>>>>>
37202>>>>>>>>>    Object oOK_bn is a ButtonSub
37204>>>>>>>>>        Set Label to "&„§ ¢¦šã"
37205>>>>>>>>>        Set Location to 113 277
37206>>>>>>>>>
37206>>>>>>>>>        //AB-StoreStart
37206>>>>>>>>>        Procedure OnClick
37208>>>>>>>>>            Send OK To (oSelList(current_object))
37209>>>>>>>>>        End_Procedure
37210>>>>>>>>>        //AB-StoreEnd
37210>>>>>>>>>
37210>>>>>>>>>    End_Object    // oOK_bn
37211>>>>>>>>>
37211>>>>>>>>>    Object oCancel_bn is a ButtonSub
37213>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
37214>>>>>>>>>        Set Location to 113 332
37215>>>>>>>>>
37215>>>>>>>>>        //AB-StoreStart
37215>>>>>>>>>        Procedure OnClick
37217>>>>>>>>>            Send Cancel To (oSelList(current_object))
37218>>>>>>>>>        End_Procedure
37219>>>>>>>>>        //AB-StoreEnd
37219>>>>>>>>>
37219>>>>>>>>>    End_Object    // oCancel_bn
37220>>>>>>>>>
37220>>>>>>>>>    Object oSearch_bn is a ButtonSub
37222>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
37223>>>>>>>>>        Set Location to 113 387
37224>>>>>>>>>
37224>>>>>>>>>        //AB-StoreStart
37224>>>>>>>>>        Procedure OnClick
37226>>>>>>>>>            Send Search To (oSelList(current_object))
37227>>>>>>>>>        End_Procedure
37228>>>>>>>>>        //AB-StoreEnd
37228>>>>>>>>>
37228>>>>>>>>>    End_Object    // oSearch_bn
37229>>>>>>>>>
37229>>>>>>>>>
37229>>>>>>>>>    //AB-StoreStart
37229>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
37230>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
37231>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
37232>>>>>>>>>    //AB-StoreEnd
37232>>>>>>>>>
37232>>>>>>>>>End_Object    // sl111
37233>>>>>>>>>
37233>>>>>>>>>//AB/ End_Object    // prj
37233>>>>>>>Use sl198.sl         // sl198
37233>>>>>>>Use sl197.SL         // sl197
37233>>>>>>>
37233>>>>>>>//DDB-Selection-pkg-End
37233>>>>>>>//DDB-FileEnd
37233>>>>>    Use AREAS.DD
37233>>>>>    Use CLIENTS.DD
37233>>>>>    Use CMOVES.DD
INCLUDING FILE: CMOVES.DD
37233>>>>>>>//DDB-FileStart
37233>>>>>>>//DDB-HeaderStart
37233>>>>>>>
37233>>>>>>>// File Name : CMOVES.DD
37233>>>>>>>// Class Name: Cmoves_DataDictionary
37233>>>>>>>// Revision  : 129
37233>>>>>>>// Version   : 2
37233>>>>>>>
37233>>>>>>>Use  Windows           // Basic Definitions
37233>>>>>>>Use  DataDict          // DataDictionary Class Definition
37233>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
37233>>>>>>>
37233>>>>>>>Open Cmoves
37235>>>>>>>Open Copen
INCLUDING FILE: COPEN.FD
37237>>>>>>>Open Ctypkin
37239>>>>>>>Open Clients
37241>>>>>>>Open Sysrecc
37243>>>>>>>Open Syscurxr
37245>>>>>>>
37245>>>>>>>//DDB-HeaderEnd
37245>>>>>>>//DDB-SelectionStart
37245>>>>>>>//DDB/ ExternalSelectionList sl006  sl006.SL
37245>>>>>>>//DDB/ ExternalSelectionList slNomism  slnomism.sl
37245>>>>>>>//DDB/ ExternalSelectionList sl041  sl041.SL
37245>>>>>>>Register_Object sl006
37245>>>>>>>Register_Object slNomism
37245>>>>>>>Register_Object sl041
37245>>>>>>>//DDB-SelectionEnd
37245>>>>>>>
37245>>>>>>>Use Payresp.DD
37245>>>>>>>Use PmsSxet.DD
INCLUDING FILE: PMSSXET.DD
37245>>>>>>>>>//DDB-FileStart
37245>>>>>>>>>//DDB-HeaderStart
37245>>>>>>>>>
37245>>>>>>>>>// File Name : PMSSXET.DD
37245>>>>>>>>>// Class Name: PmsSxet_DataDictionary
37245>>>>>>>>>// Revision  : 27
37245>>>>>>>>>// Version   : 2
37245>>>>>>>>>
37245>>>>>>>>>Use  Windows           // Basic Definitions
37245>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
37245>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
37245>>>>>>>>>
37245>>>>>>>>>Open Pmssxet
INCLUDING FILE: PMSSXET.FD
37247>>>>>>>>>Open Pmoves
INCLUDING FILE: PMOVES.FD
37249>>>>>>>>>Open Psxetika
INCLUDING FILE: PSXETIKA.FD
37251>>>>>>>>>Open Pmoves
37253>>>>>>>>>
37253>>>>>>>>>//DDB-HeaderEnd
37253>>>>>>>>>
37253>>>>>>>>>Use bpEnYpol.dg
INCLUDING FILE: BPENYPOL.DG
37253>>>>>>>>>>>//AB/ Project bpEnYpol
37253>>>>>>>>>>>//AB/ Object prj is a Dialog_Project
37253>>>>>>>>>>>//AB/     Set ProjectName to "bpEnYpol"
37253>>>>>>>>>>>//AB/     Set ProjectFileName to "bpEnYpol.DG"
37253>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
37253>>>>>>>>>>>
37253>>>>>>>>>>>// Project Object Structure
37253>>>>>>>>>>>//   bpEnYpol is a BusinessProcessSub
37253>>>>>>>>>>>
37253>>>>>>>>>>>// Register all objects
37253>>>>>>>>>>>Register_Object bpEnYpol
37253>>>>>>>>>>>
37253>>>>>>>>>>>
37253>>>>>>>>>>>//AB-IgnoreStart
37253>>>>>>>>>>>
37253>>>>>>>>>>>Use Bproces.Sub
37253>>>>>>>>>>>
37253>>>>>>>>>>>
37253>>>>>>>>>>>//AB-IgnoreEnd
37253>>>>>>>>>>>
37253>>>>>>>>>>>Object bpEnYpol is a BusinessProcessSub
37255>>>>>>>>>>>
37255>>>>>>>>>>>    //AB-StoreTopStart
37255>>>>>>>>>>>
37255>>>>>>>>>>>    Open Pmoves
37257>>>>>>>>>>>    Open Psxetika
37259>>>>>>>>>>>
37259>>>>>>>>>>>    Set Status_Panel_State to False
37260>>>>>>>>>>>    //Set Allow_Cancel_State  to True
37260>>>>>>>>>>>    Set Display_Error_State to True
37261>>>>>>>>>>>    //Set Process_Title to "               "
37261>>>>>>>>>>>    //Set Status_Log_id to (status_log(Self)) //Use statlog.pkg
37261>>>>>>>>>>>    //Set Status_log_state to True
37261>>>>>>>>>>>
37261>>>>>>>>>>>    Property Integer    piFromAkyrosh       Public  0
37263>>>>>>>>>>>    Property Integer    piLathos            Public  0
37265>>>>>>>>>>>    Property Number     pnQty               Public  0
37267>>>>>>>>>>>    Property Integer    piCurrentPartl      Public  0
37269>>>>>>>>>>>    Property Integer    piCurrentPmoves     Public  0
37271>>>>>>>>>>>    Property Integer    piCurrentPmsSxet    Public  0
37273>>>>>>>>>>>    Property String     psRecr              Public ''
37275>>>>>>>>>>>
37275>>>>>>>>>>>
37275>>>>>>>>>>>    //AB-StoreTopEnd
37275>>>>>>>>>>>
37275>>>>>>>>>>>    Set Size to 60 100
37276>>>>>>>>>>>    Set Location to 4 5
37277>>>>>>>>>>>
37277>>>>>>>>>>>    //AB-DDOStart
37277>>>>>>>>>>>
37277>>>>>>>>>>>
37277>>>>>>>>>>>    //AB-DDOEnd
37277>>>>>>>>>>>
37277>>>>>>>>>>>
37277>>>>>>>>>>>    //AB-StoreStart
37277>>>>>>>>>>>
37277>>>>>>>>>>>    Function fiUpdate_Pmoves_Qty String asRecr Number anQty Integer aiDoNotOpen Returns Integer
37279>>>>>>>>>>>        Clear Pmoves
37280>>>>>>>>>>>        Move asRecr to Pmoves.Pms_Recr
37281>>>>>>>>>>>        Find Eq Pmoves by index.2
37282>>>>>>>>>>>>
37282>>>>>>>>>>>        If (Found) Begin
37284>>>>>>>>>>>            If ((Pmoves.Timol_Qty+anQty) > Pmoves.Pms_Qty) Function_Return 40001
37287>>>>>>>>>>>            Else Begin
37288>>>>>>>>>>>                //Reread Pmoves
37288>>>>>>>>>>>                Add anQty to Pmoves.Timol_Qty
37289>>>>>>>>>>>                Move (Pmoves.Pms_Qty-Pmoves.Timol_Qty) to Pmoves.Timol_Ypol
37290>>>>>>>>>>>                Saverecord Pmoves
37291>>>>>>>>>>>               // Unlock
37291>>>>>>>>>>>
37291>>>>>>>>>>>                Clear Particle
37292>>>>>>>>>>>                Move Pmoves.Partl_Recr to Particle.Partl_Recr
37293>>>>>>>>>>>                Find Eq Particle by Index.2
37294>>>>>>>>>>>>
37294>>>>>>>>>>>                If (Found) Begin
37296>>>>>>>>>>>                   // Reread
37296>>>>>>>>>>>                    Add anQty to Particle.Timol_Qty
37297>>>>>>>>>>>                    If (Particle.Partl_TotTem>0) Begin
37299>>>>>>>>>>>                        Move (Particle.Partl_TotTem-Particle.Timol_Qty)     to Particle.Timol_Ypol
37300>>>>>>>>>>>
37300>>>>>>>>>>>                        If (aiDoNotOpen=1)  Move 1                          to Particle.Partl_Timol
37303>>>>>>>>>>>                        Else                Move (Particle.Timol_Ypol=0 )   to Particle.Partl_Timol
37305>>>>>>>>>>>                        // 07/01/2003
37305>>>>>>>>>>>                        //Else                Move (Particle.Timol_Qty>0 )    to Particle.Partl_Timol
37305>>>>>>>>>>>
37305>>>>>>>>>>>                    End
37305>>>>>>>>>>>>
37305>>>>>>>>>>>                    Else Move 0 to Particle.Partl_Timol
37307>>>>>>>>>>>                    Saverecord Particle
37308>>>>>>>>>>>                   // Unlock
37308>>>>>>>>>>>                End
37308>>>>>>>>>>>>
37308>>>>>>>>>>>                Else Function_Return 40002
37310>>>>>>>>>>>            End
37310>>>>>>>>>>>>
37310>>>>>>>>>>>        End
37310>>>>>>>>>>>>
37310>>>>>>>>>>>        Else Function_Return 40000
37312>>>>>>>>>>>        Function_Return 0
37313>>>>>>>>>>>    End_Function
37314>>>>>>>>>>>
37314>>>>>>>>>>>    Procedure OnProcess
37316>>>>>>>>>>>        Integer iLathos iSub iAkyro
37317>>>>>>>>>>>        String  sCurr sRecr sPmoveRecr sParticleRecr
37317>>>>>>>>>>>        Number  nQty nQty2
37317>>>>>>>>>>>
37317>>>>>>>>>>>        Set piLathos        to 0
37318>>>>>>>>>>>        Get pnQty           to nQty2
37319>>>>>>>>>>>        Get psRecr          to sRecr
37320>>>>>>>>>>>        Get piFromAkyrosh   to iAkyro
37321>>>>>>>>>>>
37321>>>>>>>>>>>        // An h posothta einai setarismenh thetika shmainei pos klhthike
37321>>>>>>>>>>>        // apo thn Update tou PmsSxet, allios an erthei arnhtikh apo thn Backout
37321>>>>>>>>>>>        // Prepei na to xeroume gia thn periptosh tou akyrotikou, opou tha trexei
37321>>>>>>>>>>>        // apanota h function kai tha antistrpsei to proshmo ths posothtas.
37321>>>>>>>>>>>        Move (nQty2<0)   to iSub
37322>>>>>>>>>>>
37322>>>>>>>>>>>
37322>>>>>>>>>>>        Get fiUpdate_Pmoves_Qty sRecr nQty2 0 to iLathos
37323>>>>>>>>>>>
37323>>>>>>>>>>>        If (iLathos) Begin
37325>>>>>>>>>>>            Set piLathos to iLathos
37326>>>>>>>>>>>            Procedure_Return
37327>>>>>>>>>>>        End
37327>>>>>>>>>>>>
37327>>>>>>>>>>>
37327>>>>>>>>>>>
37327>>>>>>>>>>>        // js 30/08/2002 Enhmerosh ena bhma pio piso sthn periptosh pou
37327>>>>>>>>>>>        // h enhmerosh ton pmoves apo backout kai update tou PmsSxet,
37327>>>>>>>>>>>        // afora Akyrotiko. (DAP --> TIM --> AKYROTIKO). Erxomaste dhladh edo apo
37327>>>>>>>>>>>        // AKYROTIKO na enhmerosoume tis posothtes tou TIMOLOGIOU.
37327>>>>>>>>>>>        // Sthn periptosh ayth prepei na kanoume ta exhs:
37327>>>>>>>>>>>        // 1. Eyresh ton sxetikon tou trxontos pmove TIMOLOGIOU
37327>>>>>>>>>>>        // 2. Antistrofh tou proshmou ths posothtas tous
37327>>>>>>>>>>>        // 3. Eyresh tou arxikou Pmoves (DAP) kai enhmerosh posothtas kinhshs
37327>>>>>>>>>>>
37327>>>>>>>>>>>        If (iAkyro) Begin
37329>>>>>>>>>>>            Clear Pmoves
37330>>>>>>>>>>>            Move sRecr to Pmoves.Pms_Recr
37331>>>>>>>>>>>            Find Eq Pmoves by index.2
37332>>>>>>>>>>>>
37332>>>>>>>>>>>            If (Found) Begin
37334>>>>>>>>>>>                Clear PmsSxet
37335>>>>>>>>>>>                Move sRecr to PmsSxet.Pms_Recr
37336>>>>>>>>>>>                Find Gt PmsSxet by Index.1
37337>>>>>>>>>>>>
37337>>>>>>>>>>>                While ((Found=1) And (PmsSxet.Pms_Recr=sRecr))
37341>>>>>>>>>>>                    Move PmsSxet.Sxetiko_Recr   to sCurr
37342>>>>>>>>>>>                    Move PmsSxet.Posothta       to nQty
37343>>>>>>>>>>>                    If (iSub) Begin
37345>>>>>>>>>>>                        // An Exei erthei apo Backout tou PmsSxet (to gnorizoume apo thn posothta
37345>>>>>>>>>>>                        // h opoia sto property einai arnhtikh) tote gyrname thn posothta tou
37345>>>>>>>>>>>                        // PmsSxet thetikh (Ousiastika thn afhnoume opos einai dhladh).
37345>>>>>>>>>>>                    End
37345>>>>>>>>>>>>
37345>>>>>>>>>>>                    Else Begin
37346>>>>>>>>>>>                        // An Exei erthei apo Update tou PmsSxet (to gnorizoume apo thn posothta
37346>>>>>>>>>>>                        // h opoia sto property einai thetikh) tote gyrname thn posothta tou
37346>>>>>>>>>>>                        // PmsSxet arnhtikh.
37346>>>>>>>>>>>                        Move (nQty*(-1)) to nQty
37347>>>>>>>>>>>                    End
37347>>>>>>>>>>>>
37347>>>>>>>>>>>
37347>>>>>>>>>>>                    //Get fiUpdate_Pmoves_Qty sCurr nQty 1 to iLathos
37347>>>>>>>>>>>                    // 07/01/2003 //
37347>>>>>>>>>>>                    Get fiUpdate_Pmoves_Qty sCurr nQty 0 to iLathos
37348>>>>>>>>>>>
37348>>>>>>>>>>>                    If (iLathos) Begin
37350>>>>>>>>>>>                        Set piLathos to (iLathos+3)
37351>>>>>>>>>>>                        // An Gyrisei Pmoves Not Found      (40000) To kanoume 40003
37351>>>>>>>>>>>                        // An Gyrisei problhma sto ypoloipo (40001) To kanoume 40004
37351>>>>>>>>>>>                        // An Gyrisei problhma sto particle (40002) To kanoume 40005
37351>>>>>>>>>>>                        Procedure_Return
37352>>>>>>>>>>>                    End
37352>>>>>>>>>>>>
37352>>>>>>>>>>>
37352>>>>>>>>>>>                    Clear PmsSxet
37353>>>>>>>>>>>                    Move sRecr      to PmsSxet.Pms_Recr
37354>>>>>>>>>>>                    Move sCurr      to PmsSxet.Sxetiko_Recr
37355>>>>>>>>>>>                    Find Eq PmsSxet by Index.1
37356>>>>>>>>>>>>
37356>>>>>>>>>>>                    Find Gt PmsSxet by Index.1
37357>>>>>>>>>>>>
37357>>>>>>>>>>>                Loop
37358>>>>>>>>>>>>
37358>>>>>>>>>>>            End
37358>>>>>>>>>>>>
37358>>>>>>>>>>>            Else Set piLathos to 40006
37360>>>>>>>>>>>        End
37360>>>>>>>>>>>>
37360>>>>>>>>>>>
37360>>>>>>>>>>>        If (piLathos(Self)<>0) Procedure_Return
37363>>>>>>>>>>>
37363>>>>>>>>>>>    End_Procedure
37364>>>>>>>>>>>
37364>>>>>>>>>>>    Procedure OnError integer error_info string errMsg
37366>>>>>>>>>>>    End_Procedure
37367>>>>>>>>>>>
37367>>>>>>>>>>>    Procedure Start_Process
37369>>>>>>>>>>>        Forward Send Start_Process
37371>>>>>>>>>>>    End_Procedure
37372>>>>>>>>>>>
37372>>>>>>>>>>>    Procedure End_Process
37374>>>>>>>>>>>        Forward Send End_Process
37376>>>>>>>>>>>        If (piCurrentPartl(Self)) Begin
37378>>>>>>>>>>>            Clear Particle
37379>>>>>>>>>>>            Move (piCurrentPartl(Self)) to Particle.Recnum
37380>>>>>>>>>>>            Find Eq Particle.Recnum
37381>>>>>>>>>>>>
37381>>>>>>>>>>>        End
37381>>>>>>>>>>>>
37381>>>>>>>>>>>        If (piCurrentPmoves(Self)) Begin
37383>>>>>>>>>>>            Clear Pmoves
37384>>>>>>>>>>>            Move (piCurrentPmoves(Self)) to Pmoves.Recnum
37385>>>>>>>>>>>            Find Eq Pmoves.Recnum
37386>>>>>>>>>>>>
37386>>>>>>>>>>>        End
37386>>>>>>>>>>>>
37386>>>>>>>>>>>        If (piCurrentPmsSxet(Self)<>0) Begin
37388>>>>>>>>>>>            Clear PmsSxet
37389>>>>>>>>>>>            Move (piCurrentPmsSxet(Self)) to PmsSxet.Recnum
37390>>>>>>>>>>>            Find Eq PmsSxet.Recnum
37391>>>>>>>>>>>>
37391>>>>>>>>>>>        End
37391>>>>>>>>>>>>
37391>>>>>>>>>>>    End_Procedure
37392>>>>>>>>>>>
37392>>>>>>>>>>>    //AB-StoreEnd
37392>>>>>>>>>>>
37392>>>>>>>>>>>End_Object    // bpEnYpol
37393>>>>>>>>>>>
37393>>>>>>>>>>>//AB/ End_Object    // prj
37393>>>>>>>>>Use MyArray.dg
INCLUDING FILE: MYARRAY.DG
37393>>>>>>>>>>>//AB/ Project MyArray
37393>>>>>>>>>>>//AB/     Object prj is a Dialog_Project
37393>>>>>>>>>>>//AB/         Set ProjectName to "MyArray"
37393>>>>>>>>>>>//AB/         Set ProjectFileName to "MyArray.DG"
37393>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
37393>>>>>>>>>>>
37393>>>>>>>>>>>// Project Object Structure
37393>>>>>>>>>>>//   Psx_Array is a BusinessProcessSub
37393>>>>>>>>>>>//     Ctypkin_DD2 is a Ctypkin_DataDictionary
37393>>>>>>>>>>>//     Wtypkin_DD2 is a Wtypkin_DataDictionary
37393>>>>>>>>>>>//     Ptyppar_DD2 is a Ptyppar_DataDictionary
37393>>>>>>>>>>>//     Country_DD2 is a Country_DataDictionary
37393>>>>>>>>>>>//     Towns_DD2 is a Towns_DataDictionary
37393>>>>>>>>>>>//     Cities_DD2 is a Cities_DataDictionary
37393>>>>>>>>>>>//     Areas_DD2 is a Areas_DataDictionary
37393>>>>>>>>>>>//     Payresp_DD2 is a Payresp_DataDictionary
37393>>>>>>>>>>>//     Clients_DD2 is a Clients_DataDictionary
37393>>>>>>>>>>>//     Nomisma_DD2 is a Nomisma_DataDictionary
37393>>>>>>>>>>>//     Particle_DD2 is a Particle_DataDictionary
37393>>>>>>>>>>>//     Ctypkin_DD is a Ctypkin_DataDictionary
37393>>>>>>>>>>>//     Wtypkin_DD is a Wtypkin_DataDictionary
37393>>>>>>>>>>>//     Ptyppar_DD is a Ptyppar_DataDictionary
37393>>>>>>>>>>>//     Country_DD is a Country_DataDictionary
37393>>>>>>>>>>>//     Towns_DD is a Towns_DataDictionary
37393>>>>>>>>>>>//     Cities_DD is a Cities_DataDictionary
37393>>>>>>>>>>>//     Areas_DD is a Areas_DataDictionary
37393>>>>>>>>>>>//     Payresp_DD is a Payresp_DataDictionary
37393>>>>>>>>>>>//     Clients_DD is a Clients_DataDictionary
37393>>>>>>>>>>>//     Nomisma_DD is a Nomisma_DataDictionary
37393>>>>>>>>>>>//     Particle_DD is a Particle_DataDictionary
37393>>>>>>>>>>>//     Psxetika_DD is a Psxetika_DataDictionary
37393>>>>>>>>>>>
37393>>>>>>>>>>>// Register all objects
37393>>>>>>>>>>>Register_Object Areas_DD
37393>>>>>>>>>>>Register_Object Areas_DD2
37393>>>>>>>>>>>Register_Object Cities_DD
37393>>>>>>>>>>>Register_Object Cities_DD2
37393>>>>>>>>>>>Register_Object Clients_DD
37393>>>>>>>>>>>Register_Object Clients_DD2
37393>>>>>>>>>>>Register_Object Country_DD
37393>>>>>>>>>>>Register_Object Country_DD2
37393>>>>>>>>>>>Register_Object Ctypkin_DD
37393>>>>>>>>>>>Register_Object Ctypkin_DD2
37393>>>>>>>>>>>Register_Object Nomisma_DD
37393>>>>>>>>>>>Register_Object Nomisma_DD2
37393>>>>>>>>>>>Register_Object Particle_DD
37393>>>>>>>>>>>Register_Object Particle_DD2
37393>>>>>>>>>>>Register_Object Payresp_DD
37393>>>>>>>>>>>Register_Object Payresp_DD2
37393>>>>>>>>>>>Register_Object Psx_Array
37393>>>>>>>>>>>Register_Object Psxetika_DD
37393>>>>>>>>>>>Register_Object Ptyppar_DD
37393>>>>>>>>>>>Register_Object Ptyppar_DD2
37393>>>>>>>>>>>Register_Object Towns_DD
37393>>>>>>>>>>>Register_Object Towns_DD2
37393>>>>>>>>>>>Register_Object Wtypkin_DD
37393>>>>>>>>>>>Register_Object Wtypkin_DD2
37393>>>>>>>>>>>
37393>>>>>>>>>>>
37393>>>>>>>>>>>
37393>>>>>>>>>>>    //AB-StoreTopStart
37393>>>>>>>>>>>
37393>>>>>>>>>>>    Use CTYPKIN.DD
37393>>>>>>>>>>>    Use WTYPKIN.DD
INCLUDING FILE: WTYPKIN.DD
37393>>>>>>>>>>>>>//DDB-FileStart
37393>>>>>>>>>>>>>//DDB-HeaderStart
37393>>>>>>>>>>>>>
37393>>>>>>>>>>>>>// File Name : WTYPKIN.DD
37393>>>>>>>>>>>>>// Class Name: Wtypkin_DataDictionary
37393>>>>>>>>>>>>>// Revision  : 49
37393>>>>>>>>>>>>>// Version   : 2
37393>>>>>>>>>>>>>
37393>>>>>>>>>>>>>Use  Windows           // Basic Definitions
37393>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
37393>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
37393>>>>>>>>>>>>>
37393>>>>>>>>>>>>>Open Wtypkin
INCLUDING FILE: WTYPKIN.FD
37395>>>>>>>>>>>>>Open Ptyppar
37397>>>>>>>>>>>>>Open Wcmoves
INCLUDING FILE: WCMOVES.FD
37399>>>>>>>>>>>>>Open Hmwtyp
INCLUDING FILE: HMWTYP.FD
37401>>>>>>>>>>>>>Open Wflagkin
INCLUDING FILE: WFLAGKIN.FD
37403>>>>>>>>>>>>>Open Sysrecw
INCLUDING FILE: SYSRECW.FD
37405>>>>>>>>>>>>>Open Syscurxr
37407>>>>>>>>>>>>>
37407>>>>>>>>>>>>>//DDB-HeaderEnd
37407>>>>>>>>>>>>>//DDB-ValidationStart
37407>>>>>>>>>>>>>
37407>>>>>>>>>>>>>Register_Object Wtypkin_Wtypkin_Module_VT
37407>>>>>>>>>>>>>
37407>>>>>>>>>>>>>Object Wtypkin_Wtypkin_Module_VT  is a CodeValidationTable
37409>>>>>>>>>>>>>    Set Type_Value        To "MODULE"
37410>>>>>>>>>>>>>    //DDB-ValidationCustomStart
37410>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
37410>>>>>>>>>>>>>End_Object   // Wtypkin_Wtypkin_Module_VT
37411>>>>>>>>>>>>>//DDB-ValidationEnd
37411>>>>>>>>>>>>>//DDB-SelectionStart
37411>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl029a  sl029a.SL
37411>>>>>>>>>>>>>Register_Object sl029a
37411>>>>>>>>>>>>>//DDB-SelectionEnd
37411>>>>>>>>>>>>>
37411>>>>>>>>>>>>>Class Wtypkin_DataDictionary  is a DataDictionary
37412>>>>>>>>>>>>>               
37412>>>>>>>>>>>>>    Procedure Construct_Object
37413>>>>>>>>>>>>>        Forward Send Construct_Object
37415>>>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
37416>>>>>>>>>>>>>    End_Procedure
37417>>>>>>>>>>>>>
37417>>>>>>>>>>>>>    Procedure Save_Main_File
37418>>>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
37420>>>>>>>>>>>>>            If Wtypkin.Recnum Eq 0 Procedure_Return
37423>>>>>>>>>>>>>        End
37423>>>>>>>>>>>>>>
37423>>>>>>>>>>>>>        Forward Send Save_Main_File
37425>>>>>>>>>>>>>    End_Procedure
37426>>>>>>>>>>>>>
37426>>>>>>>>>>>>>
37426>>>>>>>>>>>>>     Procedure Creating
37427>>>>>>>>>>>>>        Forward Send Creating
37429>>>>>>>>>>>>>        // Insert Code Here
37429>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wtypkin.Wtypkin_Rec0)))))) to Wtypkin.Wtypkin_Recr
37430>>>>>>>>>>>>>    End_Procedure   // Creating
37431>>>>>>>>>>>>>
37431>>>>>>>>>>>>>    // Define_Fields:
37431>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
37431>>>>>>>>>>>>>
37431>>>>>>>>>>>>>    Procedure Define_Fields
37432>>>>>>>>>>>>>        Forward Send Define_Fields
37434>>>>>>>>>>>>>        //DDB-Generated-Code-Location
37434>>>>>>>>>>>>>        //DDB-DefineFieldStart
37434>>>>>>>>>>>>>
37434>>>>>>>>>>>>>        Set Main_File            To Wtypkin.File_Number
37435>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
37436>>>>>>>>>>>>>
37436>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
37437>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
37438>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
37439>>>>>>>>>>>>>
37439>>>>>>>>>>>>>        // Child (Client) file structure................
37439>>>>>>>>>>>>>        Send Add_Client_File  Ptyppar.File_Number
37440>>>>>>>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
37441>>>>>>>>>>>>>        Send Add_Client_File  Hmwtyp.File_Number
37442>>>>>>>>>>>>>        Send Add_Client_File  Wflagkin.File_Number
37443>>>>>>>>>>>>>
37443>>>>>>>>>>>>>        // External (System) file structure.............
37443>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
37444>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
37445>>>>>>>>>>>>>
37445>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Wtypkin_Rec0  To Wtypkin.Wtypkin_Rec0
37448>>>>>>>>>>>>>
37448>>>>>>>>>>>>>        // Field-based properties.......................
37448>>>>>>>>>>>>>
37448>>>>>>>>>>>>>        // Wtypkin.Company_Code
37448>>>>>>>>>>>>>
37448>>>>>>>>>>>>>        // Wtypkin.Branch_Code
37448>>>>>>>>>>>>>
37448>>>>>>>>>>>>>        // Wtypkin.Year_Year
37448>>>>>>>>>>>>>
37448>>>>>>>>>>>>>        // Wtypkin.Wtypkin_Code
37448>>>>>>>>>>>>>        Set Field_Options          Field Wtypkin.Wtypkin_Code To DD_AUTOFIND   
37449>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Wtypkin.Wtypkin_Code To (sl029a(Self))
37450>>>>>>>>>>>>>        Set Key_Field_State        Field Wtypkin.Wtypkin_Code To TRUE
37451>>>>>>>>>>>>>
37451>>>>>>>>>>>>>        // Wtypkin.Wtypkin_Rec0
37451>>>>>>>>>>>>>        Set Field_Options          Field Wtypkin.Wtypkin_Rec0 To DD_AUTOFIND   
37452>>>>>>>>>>>>>
37452>>>>>>>>>>>>>        // Wtypkin.Wtypkin_Recr
37452>>>>>>>>>>>>>
37452>>>>>>>>>>>>>        // Wtypkin.Year_Recr
37452>>>>>>>>>>>>>
37452>>>>>>>>>>>>>        // Wtypkin.Wtypkin_Descr
37452>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Wtypkin.Wtypkin_Descr To (sl029a(Self))
37453>>>>>>>>>>>>>
37453>>>>>>>>>>>>>        // Wtypkin.Wtypkin_Anti
37453>>>>>>>>>>>>>
37453>>>>>>>>>>>>>        // Wtypkin.Wtypkin_Module
37453>>>>>>>>>>>>>        Set Field_Value_Table      Field Wtypkin.Wtypkin_Module To (Wtypkin_Wtypkin_Module_VT(Self))
37454>>>>>>>>>>>>>
37454>>>>>>>>>>>>>        // Wtypkin.Max_Days_Sx_Par
37454>>>>>>>>>>>>>
37454>>>>>>>>>>>>>        //DDB-DefineFieldEnd
37454>>>>>>>>>>>>>    End_Procedure    // Define_Fields
37455>>>>>>>>>>>>>
37455>>>>>>>>>>>>>    // Field_Defaults:
37455>>>>>>>>>>>>>    // This procedure is used to establish default field values.
37455>>>>>>>>>>>>>
37455>>>>>>>>>>>>>    Procedure Field_Defaults
37456>>>>>>>>>>>>>        Forward Send Field_Defaults
37458>>>>>>>>>>>>>        //DDB-Generated-Code-Location
37458>>>>>>>>>>>>>        //DDB-FieldDefaultStart
37458>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
37458>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
37459>>>>>>>>>>>>>
37459>>>>>>>>>>>>>End_Class    // Wtypkin_DataDictionary
37460>>>>>>>>>>>>>//DDB-Selection-pkg-Start
37460>>>>>>>>>>>>>
37460>>>>>>>>>>>>>Use sl029a.SL        // sl029a
INCLUDING FILE: SL029A.SL
37460>>>>>>>>>>>>>>>//AB/ Project sl029a:wtypkin
37460>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
37460>>>>>>>>>>>>>>>//AB/         Set ProjectName to "sl029a:wtypkin"
37460>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl029a.SL"
37460>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
37460>>>>>>>>>>>>>>>
37460>>>>>>>>>>>>>>>// Project Object Structure
37460>>>>>>>>>>>>>>>//   sl029a is a dbModalPanelSub
37460>>>>>>>>>>>>>>>//     Wtypkin_DD is a DataDictionary
37460>>>>>>>>>>>>>>>//     oSelList is a dbListSub
37460>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
37460>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
37460>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
37460>>>>>>>>>>>>>>>
37460>>>>>>>>>>>>>>>// Register all objects
37460>>>>>>>>>>>>>>>Register_Object oCancel_bn
37460>>>>>>>>>>>>>>>Register_Object oOK_bn
37460>>>>>>>>>>>>>>>Register_Object oSearch_bn
37460>>>>>>>>>>>>>>>Register_Object oSelList
37460>>>>>>>>>>>>>>>Register_Object sl029a
37460>>>>>>>>>>>>>>>Register_Object Wtypkin_DD
37460>>>>>>>>>>>>>>>
37460>>>>>>>>>>>>>>>
37460>>>>>>>>>>>>>>>    //AB-IgnoreStart
37460>>>>>>>>>>>>>>>
37460>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
37460>>>>>>>>>>>>>>>    Use dbList.Sub
37460>>>>>>>>>>>>>>>    Use Button.Sub
37460>>>>>>>>>>>>>>>
37460>>>>>>>>>>>>>>>
37460>>>>>>>>>>>>>>>    Use WTYPKIN.DD
37460>>>>>>>>>>>>>>>    
37460>>>>>>>>>>>>>>>    //AB-IgnoreEnd
37460>>>>>>>>>>>>>>>
37460>>>>>>>>>>>>>>>    Object sl029a is a dbModalPanelSub
37462>>>>>>>>>>>>>>>        set label to "Ž¨ ©£æª ‰ ¤ã©œà¤ €§¦Ÿã¡žª" 
37463>>>>>>>>>>>>>>>        Set Size to 148 297
37464>>>>>>>>>>>>>>>        Set Location to 4 5
37465>>>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
37466>>>>>>>>>>>>>>>        Set Modal_State to FALSE
37467>>>>>>>>>>>>>>>
37467>>>>>>>>>>>>>>>        //AB-DDOStart
37467>>>>>>>>>>>>>>>
37467>>>>>>>>>>>>>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
37469>>>>>>>>>>>>>>>        End_Object    // Wtypkin_DD
37470>>>>>>>>>>>>>>>
37470>>>>>>>>>>>>>>>        Set Main_DD to (Wtypkin_DD(self))
37471>>>>>>>>>>>>>>>        Set Server to (Wtypkin_DD(self))
37472>>>>>>>>>>>>>>>
37472>>>>>>>>>>>>>>>        //AB-DDOEnd
37472>>>>>>>>>>>>>>>
37472>>>>>>>>>>>>>>>        Object oSelList is a dbListSub
37474>>>>>>>>>>>>>>>            Set Main_File to Wtypkin.File_Number
37475>>>>>>>>>>>>>>>            Set Size to 105 280
37476>>>>>>>>>>>>>>>            Set Location to 6 6
37477>>>>>>>>>>>>>>>
37477>>>>>>>>>>>>>>>            Begin_Row
37480>>>>>>>>>>>>>>>                Entry_Item Wtypkin.Wtypkin_code
37481>>>>>>>>>>>>>>>                Entry_Item Wtypkin.Wtypkin_descr
37482>>>>>>>>>>>>>>>            End_Row
37487>>>>>>>>>>>>>>>
37487>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 60
37488>>>>>>>>>>>>>>>            set header_label  item 0 to "‰à› ¡¦ª" 
37489>>>>>>>>>>>>>>>            
37489>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 212
37490>>>>>>>>>>>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
37491>>>>>>>>>>>>>>>            
37491>>>>>>>>>>>>>>>        End_Object    // oSelList
37492>>>>>>>>>>>>>>>
37492>>>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
37494>>>>>>>>>>>>>>>            set label to "&„§ ¢¦šã" 
37495>>>>>>>>>>>>>>>            Set Location to 115 126
37496>>>>>>>>>>>>>>>
37496>>>>>>>>>>>>>>>            //AB-StoreStart
37496>>>>>>>>>>>>>>>            Procedure OnClick
37498>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
37499>>>>>>>>>>>>>>>            End_Procedure
37500>>>>>>>>>>>>>>>            //AB-StoreEnd
37500>>>>>>>>>>>>>>>
37500>>>>>>>>>>>>>>>        End_Object    // oOK_bn
37501>>>>>>>>>>>>>>>
37501>>>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
37503>>>>>>>>>>>>>>>            set label to "&€¡ç¨à©ž" 
37504>>>>>>>>>>>>>>>            Set Location to 115 181
37505>>>>>>>>>>>>>>>
37505>>>>>>>>>>>>>>>            //AB-StoreStart
37505>>>>>>>>>>>>>>>            Procedure OnClick
37507>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
37508>>>>>>>>>>>>>>>            End_Procedure
37509>>>>>>>>>>>>>>>            //AB-StoreEnd
37509>>>>>>>>>>>>>>>
37509>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
37510>>>>>>>>>>>>>>>
37510>>>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
37512>>>>>>>>>>>>>>>            set label to "€&¤˜ã«ž©ž" 
37513>>>>>>>>>>>>>>>            Set Location to 115 236
37514>>>>>>>>>>>>>>>
37514>>>>>>>>>>>>>>>            //AB-StoreStart
37514>>>>>>>>>>>>>>>            Procedure OnClick
37516>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
37517>>>>>>>>>>>>>>>            End_Procedure
37518>>>>>>>>>>>>>>>            //AB-StoreEnd
37518>>>>>>>>>>>>>>>
37518>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
37519>>>>>>>>>>>>>>>
37519>>>>>>>>>>>>>>>
37519>>>>>>>>>>>>>>>        //AB-StoreStart
37519>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
37520>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
37521>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
37522>>>>>>>>>>>>>>>        //AB-StoreEnd
37522>>>>>>>>>>>>>>>
37522>>>>>>>>>>>>>>>    End_Object    // sl029a
37523>>>>>>>>>>>>>>>
37523>>>>>>>>>>>>>>>//AB/     End_Object    // prj
37523>>>>>>>>>>>>>
37523>>>>>>>>>>>>>//DDB-Selection-pkg-End
37523>>>>>>>>>>>>>//DDB-FileEnd
37523>>>>>>>>>>>    Use PTYPPAR.DD
INCLUDING FILE: PTYPPAR.DD
37523>>>>>>>>>>>>>//DDB-FileStart
37523>>>>>>>>>>>>>//DDB-HeaderStart
37523>>>>>>>>>>>>>
37523>>>>>>>>>>>>>// File Name : PTYPPAR.DD
37523>>>>>>>>>>>>>// Class Name: Ptyppar_DataDictionary
37523>>>>>>>>>>>>>// Revision  : 73
37523>>>>>>>>>>>>>// Version   : 2
37523>>>>>>>>>>>>>
37523>>>>>>>>>>>>>Use  Windows           // Basic Definitions
37523>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
37523>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
37523>>>>>>>>>>>>>
37523>>>>>>>>>>>>>Open Ptyppar
37525>>>>>>>>>>>>>Open Particle
37527>>>>>>>>>>>>>Open Pseira
INCLUDING FILE: PSEIRA.FD
37529>>>>>>>>>>>>>Open Ptypmet
INCLUDING FILE: PTYPMET.FD
37531>>>>>>>>>>>>>Open Ptypparh
INCLUDING FILE: PTYPPARH.FD
37533>>>>>>>>>>>>>Open Ctypkin
37535>>>>>>>>>>>>>Open Wtypkin
37537>>>>>>>>>>>>>Open Sysrecp
INCLUDING FILE: SYSRECP.FD
37539>>>>>>>>>>>>>Open Syscurxr
37541>>>>>>>>>>>>>
37541>>>>>>>>>>>>>//DDB-HeaderEnd
37541>>>>>>>>>>>>>//DDB-ValidationStart
37541>>>>>>>>>>>>>
37541>>>>>>>>>>>>>Register_Object Ptyppar_Ptyppar_Is_What_VT
37541>>>>>>>>>>>>>Register_Object Ptyppar_Ptyppar_Module_VT
37541>>>>>>>>>>>>>Register_Object Ptyppar_Ti_Typonei_Pms_VT1
37541>>>>>>>>>>>>>
37541>>>>>>>>>>>>>Object Ptyppar_Ptyppar_Is_What_VT  is a DescriptionValidationTable
37543>>>>>>>>>>>>>
37543>>>>>>>>>>>>>    Procedure Fill_List
37545>>>>>>>>>>>>>        Forward Send Fill_List
37547>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "€š¦¨á"
37548>>>>>>>>>>>>>        Send Add_Table_Value  "2"  "é¢ž©ž"
37549>>>>>>>>>>>>>        Send Add_Table_Value  "3"  "€ŠŠŽ"
37550>>>>>>>>>>>>>    End_Procedure    // Fill_List
37551>>>>>>>>>>>>>    //DDB-ValidationCustomStart
37551>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
37551>>>>>>>>>>>>>End_Object   // Ptyppar_Ptyppar_Is_What_VT
37552>>>>>>>>>>>>>
37552>>>>>>>>>>>>>Object Ptyppar_Ptyppar_Module_VT  is a CodeValidationTable
37554>>>>>>>>>>>>>    Set Type_Value        To "MODULE"
37555>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
37556>>>>>>>>>>>>>    //DDB-ValidationCustomStart
37556>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
37556>>>>>>>>>>>>>End_Object   // Ptyppar_Ptyppar_Module_VT
37557>>>>>>>>>>>>>
37557>>>>>>>>>>>>>Object Ptyppar_Ti_Typonei_Pms_VT1  is a DescriptionValidationTable
37559>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
37560>>>>>>>>>>>>>
37560>>>>>>>>>>>>>    Procedure Fill_List
37562>>>>>>>>>>>>>        Forward Send Fill_List
37564>>>>>>>>>>>>>        Send Add_Table_Value  ""  "¦©æ«ž«œª ¡˜  €¥åœª"
37565>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "¦©æ«ž«œª"
37566>>>>>>>>>>>>>        Send Add_Table_Value  "2"  "€¥åœª"
37567>>>>>>>>>>>>>    End_Procedure    // Fill_List
37568>>>>>>>>>>>>>    //DDB-ValidationCustomStart
37568>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
37568>>>>>>>>>>>>>End_Object   // Ptyppar_Ti_Typonei_Pms_VT1
37569>>>>>>>>>>>>>//DDB-ValidationEnd
37569>>>>>>>>>>>>>//DDB-SelectionStart
37569>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl012  sl012.SL
37569>>>>>>>>>>>>>Register_Object sl012
37569>>>>>>>>>>>>>//DDB-SelectionEnd
37569>>>>>>>>>>>>>
37569>>>>>>>>>>>>>Class Ptyppar_DataDictionary  is a DataDictionary_Sec
37570>>>>>>>>>>>>> 
37570>>>>>>>>>>>>>    Procedure Construct_Object
37571>>>>>>>>>>>>>        Forward Send Construct_Object
37573>>>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
37574>>>>>>>>>>>>>        Property Integer piOldCtypkin       Public 0
37575>>>>>>>>>>>>>        Property Integer piOldWtypkin       Public 0
37576>>>>>>>>>>>>>    End_Procedure
37577>>>>>>>>>>>>> 
37577>>>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
37578>>>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
37580>>>>>>>>>>>>>        Set piOldCtypkin to Ctypkin.Ctypkin_Code
37581>>>>>>>>>>>>>        Set piOldWtypkin to Wtypkin.Wtypkin_Code
37582>>>>>>>>>>>>>    End_Procedure   // New_Current_Record
37583>>>>>>>>>>>>>
37583>>>>>>>>>>>>>    Procedure OnConstrain
37584>>>>>>>>>>>>>        If (piMustNotConstrain(Self)=0) Begin
37586>>>>>>>>>>>>>            Constrain Ptyppar.Company_Code  eq SysCurXR.Company_Code
37588>>>>>>>>>>>>>            Constrain Ptyppar.Branch_Code   eq SysCurXR.Branch_Code
37590>>>>>>>>>>>>>        End
37590>>>>>>>>>>>>>>
37590>>>>>>>>>>>>>    End_Procedure
37591>>>>>>>>>>>>>
37591>>>>>>>>>>>>>    Procedure Clear_Main_File
37592>>>>>>>>>>>>>        Forward Send Clear_Main_File
37594>>>>>>>>>>>>>        Set piOldCtypkin to 0
37595>>>>>>>>>>>>>        Set piOldWtypkin to 0
37596>>>>>>>>>>>>>    End_Procedure
37597>>>>>>>>>>>>>
37597>>>>>>>>>>>>>    Procedure Save_Main_File  
37598>>>>>>>>>>>>>        Integer isAdmin iYes
37599>>>>>>>>>>>>>        String  sStr
37599>>>>>>>>>>>>>        Get fig_Is_Admin to isAdmin
37600>>>>>>>>>>>>>        
37600>>>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
37602>>>>>>>>>>>>>            If Ptyppar.Recnum Eq 0 Procedure_Return
37605>>>>>>>>>>>>>        End              
37605>>>>>>>>>>>>>>
37605>>>>>>>>>>>>>        If (Operation_Origin=Self) Begin
37607>>>>>>>>>>>>>            If ((piOldCtypkin(Self)<>0) And (piOldCtypkin(Self)<>Ctypkin.Ctypkin_Code)) Begin
37609>>>>>>>>>>>>>                If (Not(isAdmin)) Error 1001 'ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ¡å¤ž©žª §œ¢á«ž'
37612>>>>>>>>>>>>>                Else Begin 
37613>>>>>>>>>>>>>                    Move '' to sStr    
37614>>>>>>>>>>>>>                    Append sStr '€¤ ˜¢¢á¥œ«œ ¡å¤ž©ž, £§¦¨œå ¤˜ œ§ž¨œá©œ  ã›ž ¡˜«˜®à¨ž£â¤˜ §˜¨˜©«˜« ¡á\n «˜ ¦§¦å˜ â®¦¬¤ ­« ˜®«œå £œ « ª §˜¢ âª ¡ ¤ã©œ ª §¦¬ «é¨˜ ˜¢¢áœ«œ\n„å©«œ ™â™˜ ¦  §àª Ÿâ¢œ«œ ¤˜ ©¬¤œ®å©à ?'
37615>>>>>>>>>>>>>                    Get YesNo_Box sStr to iYes
37616>>>>>>>>>>>>>                    If (iYes=MBR_NO) Error 1000 '€¡¬¨éŸž¡œ ž › ˜› ¡˜©å˜ ˜¢¢˜šãª ˜§¦ «¦¤ ®¨ã©«ž'
37619>>>>>>>>>>>>>                End
37619>>>>>>>>>>>>>>
37619>>>>>>>>>>>>>            End // If ((piOldCtypkin(Self)<>0) And (piOldCtypkin(Self)<>Ctypkin.Ctypkin_Code))
37619>>>>>>>>>>>>>>
37619>>>>>>>>>>>>>            If ((piOldWtypkin(Self)<>0) And (piOldWtypkin(Self)<>Wtypkin.Wtypkin_Code)) Begin
37621>>>>>>>>>>>>>                If (Not(isAdmin)) Error 1002 'ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ¡å¤ž©žª ˜§¦Ÿã¡žª'
37624>>>>>>>>>>>>>                Else Begin 
37625>>>>>>>>>>>>>                    Move '' to sStr    
37626>>>>>>>>>>>>>                    Append sStr '€¤ ˜¢¢á¥œ«œ ¡å¤ž©ž, £§¦¨œå ¤˜ œ§ž¨œá©œ  ã›ž ¡˜«˜®à¨ž£â¤˜ §˜¨˜©«˜« ¡á\n «˜ ¦§¦å˜ â®¦¬¤ ­« ˜®«œå £œ « ª §˜¢ âª ¡ ¤ã©œ ª §¦¬ «é¨˜ ˜¢¢áœ«œ\n„å©«œ ™â™˜ ¦  §àª Ÿâ¢œ«œ ¤˜ ©¬¤œ®å©à ?'
37627>>>>>>>>>>>>>                    Get YesNo_Box sStr to iYes
37628>>>>>>>>>>>>>                    If (iYes=MBR_NO) Error 1000 '€¡¬¨éŸž¡œ ž › ˜› ¡˜©å˜ ˜¢¢˜šãª ˜§¦ «¦¤ ®¨ã©«ž'
37631>>>>>>>>>>>>>                End
37631>>>>>>>>>>>>>>
37631>>>>>>>>>>>>>            End // ((piOldWtypkin(Self)<>0) And (piOldWtypkin(Self)<>Wtypkin.Wtypkin_Code))
37631>>>>>>>>>>>>>>
37631>>>>>>>>>>>>>        End // If (Operation_Origin=Self)
37631>>>>>>>>>>>>>>
37631>>>>>>>>>>>>>        Forward Send Save_Main_File
37633>>>>>>>>>>>>>    End_Procedure // Save_Main_File
37634>>>>>>>>>>>>>    
37634>>>>>>>>>>>>>
37634>>>>>>>>>>>>>    Procedure Update
37635>>>>>>>>>>>>>        Forward Send Update
37637>>>>>>>>>>>>>        // Insert Code Here
37637>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to Ptyppar.Company_Code
37638>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Ptyppar.Branch_Code
37639>>>>>>>>>>>>>//        Move SysCurXR.Year_Year     to Ptyppar.Year_Year
37639>>>>>>>>>>>>>//        Move SysCurXR.Year_Recr     to Ptyppar.Year_Recr
37639>>>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code   to Ptyppar.Ctypkin_Code
37640>>>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code   to Ptyppar.Wtypkin_Code
37641>>>>>>>>>>>>>    End_Procedure   // Update
37642>>>>>>>>>>>>>
37642>>>>>>>>>>>>>    Procedure Creating
37643>>>>>>>>>>>>>        Forward Send Creating
37645>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Ptyppar.Ptyppar_Rec0)))))) to Ptyppar.Ptyppar_Recr
37646>>>>>>>>>>>>>    End_Procedure   // Creating
37647>>>>>>>>>>>>>
37647>>>>>>>>>>>>>
37647>>>>>>>>>>>>>    // Define_Fields:
37647>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
37647>>>>>>>>>>>>>    Procedure Define_Fields
37648>>>>>>>>>>>>>        Forward Send Define_Fields
37650>>>>>>>>>>>>>        //DDB-Generated-Code-Location
37650>>>>>>>>>>>>>        //DDB-DefineFieldStart
37650>>>>>>>>>>>>>
37650>>>>>>>>>>>>>        Set Main_File            To Ptyppar.File_Number
37651>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
37652>>>>>>>>>>>>>
37652>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
37653>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
37654>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
37655>>>>>>>>>>>>>
37655>>>>>>>>>>>>>        // Child (Client) file structure................
37655>>>>>>>>>>>>>        Send Add_Client_File  Particle.File_Number
37656>>>>>>>>>>>>>        Send Add_Client_File  Pseira.File_Number
37657>>>>>>>>>>>>>        Send Add_Client_File  Ptypmet.File_Number
37658>>>>>>>>>>>>>        Send Add_Client_File  Ptypparh.File_Number
37659>>>>>>>>>>>>>
37659>>>>>>>>>>>>>        // Parent (Server) file structure...............
37659>>>>>>>>>>>>>        Send Add_Server_File  Ctypkin.File_Number
37660>>>>>>>>>>>>>        Send Add_Server_File  Wtypkin.File_Number
37661>>>>>>>>>>>>>
37661>>>>>>>>>>>>>        // External (System) file structure.............
37661>>>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
37662>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
37663>>>>>>>>>>>>>
37663>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Ptyppar_Rec0  To Ptyppar.Ptyppar_Rec0
37666>>>>>>>>>>>>>
37666>>>>>>>>>>>>>        // Field-based properties.......................
37666>>>>>>>>>>>>>
37666>>>>>>>>>>>>>        // Ptyppar.Company_Code
37666>>>>>>>>>>>>>
37666>>>>>>>>>>>>>        // Ptyppar.Branch_Code
37666>>>>>>>>>>>>>
37666>>>>>>>>>>>>>        // Ptyppar.Year_Year
37666>>>>>>>>>>>>>
37666>>>>>>>>>>>>>        // Ptyppar.Ctypkin_Code
37666>>>>>>>>>>>>>
37666>>>>>>>>>>>>>        // Ptyppar.Wtypkin_Code
37666>>>>>>>>>>>>>
37666>>>>>>>>>>>>>        // Ptyppar.Year_Recr
37666>>>>>>>>>>>>>
37666>>>>>>>>>>>>>        // Ptyppar.Ctypkin_Recr
37666>>>>>>>>>>>>>
37666>>>>>>>>>>>>>        // Ptyppar.Wtypkin_Recr
37666>>>>>>>>>>>>>
37666>>>>>>>>>>>>>        // Ptyppar.Ptyppar_Code
37666>>>>>>>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Code To DD_AUTOFIND   
37667>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Ptyppar.Ptyppar_Code To (sl012(Self))
37668>>>>>>>>>>>>>        Set Key_Field_State        Field Ptyppar.Ptyppar_Code To TRUE
37669>>>>>>>>>>>>>
37669>>>>>>>>>>>>>        // Ptyppar.Ptyppar_Rec0
37669>>>>>>>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Rec0 To DD_AUTOFIND   
37670>>>>>>>>>>>>>
37670>>>>>>>>>>>>>        // Ptyppar.Ptyppar_Descr
37670>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Ptyppar.Ptyppar_Descr To (sl012(Self))
37671>>>>>>>>>>>>>
37671>>>>>>>>>>>>>        // Ptyppar.Ptyppar_Recr
37671>>>>>>>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Recr To DD_AUTOFIND   
37672>>>>>>>>>>>>>
37672>>>>>>>>>>>>>        // Ptyppar.Ptyppar_Is_What
37672>>>>>>>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ptyppar_Is_What To (Ptyppar_Ptyppar_Is_What_VT(Self))
37673>>>>>>>>>>>>>
37673>>>>>>>>>>>>>        // Ptyppar.Ptyppar_Module
37673>>>>>>>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ptyppar_Module To (Ptyppar_Ptyppar_Module_VT(Self))
37674>>>>>>>>>>>>>
37674>>>>>>>>>>>>>        // Ptyppar.Ptyppar_Abrev
37674>>>>>>>>>>>>>
37674>>>>>>>>>>>>>        // Ptyppar.Ftiaxnei_Tpay
37674>>>>>>>>>>>>>        Set Field_Class_Name       Field Ptyppar.Ftiaxnei_Tpay To "dbCheckBoxsub"
37675>>>>>>>>>>>>>
37675>>>>>>>>>>>>>        // Ptyppar.Ti_Typonei_Pms
37675>>>>>>>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ti_Typonei_Pms To (Ptyppar_Ti_Typonei_Pms_VT1(Self))
37676>>>>>>>>>>>>>
37676>>>>>>>>>>>>>        // Ptyppar.Einai_Paroxh_Yp
37676>>>>>>>>>>>>>        Set Field_Checkbox_Values  Field Ptyppar.Einai_Paroxh_Yp To "1"  "0"
37677>>>>>>>>>>>>>        Set Field_Class_Name       Field Ptyppar.Einai_Paroxh_Yp To "dbCheckBoxsub"
37678>>>>>>>>>>>>>
37678>>>>>>>>>>>>>        // Ptyppar.Gtypkin_Code
37678>>>>>>>>>>>>>
37678>>>>>>>>>>>>>        // Ptyppar.Sysxet_Ptyppar
37678>>>>>>>>>>>>>
37678>>>>>>>>>>>>>        // Ptyppar.Sysx_Ptyp_Recr
37678>>>>>>>>>>>>>
37678>>>>>>>>>>>>>        // Ptyppar.Check_Posa_Plaf
37678>>>>>>>>>>>>>
37678>>>>>>>>>>>>>        // Ptyppar.Singular
37678>>>>>>>>>>>>>
37678>>>>>>>>>>>>>        // Ptyppar.Sub
37678>>>>>>>>>>>>>
37678>>>>>>>>>>>>>        // Ptyppar.Constrain
37678>>>>>>>>>>>>>
37678>>>>>>>>>>>>>        // Ptyppar.Label
37678>>>>>>>>>>>>>
37678>>>>>>>>>>>>>        // Ptyppar.Label1
37678>>>>>>>>>>>>>
37678>>>>>>>>>>>>>        //DDB-DefineFieldEnd
37678>>>>>>>>>>>>>    End_Procedure    // Define_Fields
37679>>>>>>>>>>>>>
37679>>>>>>>>>>>>>    // Field_Defaults:
37679>>>>>>>>>>>>>    // This procedure is used to establish default field values.
37679>>>>>>>>>>>>>
37679>>>>>>>>>>>>>    Procedure Field_Defaults
37680>>>>>>>>>>>>>        Forward Send Field_Defaults
37682>>>>>>>>>>>>>        //DDB-Generated-Code-Location
37682>>>>>>>>>>>>>        //DDB-FieldDefaultStart
37682>>>>>>>>>>>>>        Set Field_Changed_Value   Field Ptyppar.Ftiaxnei_Tpay To "1"
37683>>>>>>>>>>>>>        Set Field_Changed_Value   Field Ptyppar.Einai_Paroxh_Yp To 0
37684>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
37684>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
37685>>>>>>>>>>>>>
37685>>>>>>>>>>>>>End_Class    // Ptyppar_DataDictionary
37686>>>>>>>>>>>>>//DDB-Selection-pkg-Start
37686>>>>>>>>>>>>>
37686>>>>>>>>>>>>>Use sl012.SL         // sl012
INCLUDING FILE: SL012.SL
37686>>>>>>>>>>>>>>>//AB/ Project sl012 : Ptyppar
37686>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
37686>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl012 : Ptyppar"
37686>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl012.SL"
37686>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
37686>>>>>>>>>>>>>>>
37686>>>>>>>>>>>>>>>// Project Object Structure
37686>>>>>>>>>>>>>>>//   sl012 is a dbModalPanelSub
37686>>>>>>>>>>>>>>>//     Ctypkin_DD is a DataDictionary
37686>>>>>>>>>>>>>>>//     Wtypkin_DD is a DataDictionary
37686>>>>>>>>>>>>>>>//     Ptyppar_DD is a DataDictionary
37686>>>>>>>>>>>>>>>//     oSelList is a dbListSub
37686>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
37686>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
37686>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
37686>>>>>>>>>>>>>>>
37686>>>>>>>>>>>>>>>// Register all objects
37686>>>>>>>>>>>>>>>Register_Object Ctypkin_DD
37686>>>>>>>>>>>>>>>Register_Object oCancel_bn
37686>>>>>>>>>>>>>>>Register_Object oOK_bn
37686>>>>>>>>>>>>>>>Register_Object oSearch_bn
37686>>>>>>>>>>>>>>>Register_Object oSelList
37686>>>>>>>>>>>>>>>Register_Object Ptyppar_DD
37686>>>>>>>>>>>>>>>Register_Object sl012
37686>>>>>>>>>>>>>>>Register_Object Wtypkin_DD
37686>>>>>>>>>>>>>>>
37686>>>>>>>>>>>>>>>
37686>>>>>>>>>>>>>>>//AB-IgnoreStart
37686>>>>>>>>>>>>>>>
37686>>>>>>>>>>>>>>>Use DFAllEnt.pkg
37686>>>>>>>>>>>>>>>Use dbList.Sub
37686>>>>>>>>>>>>>>>Use Button.Sub
37686>>>>>>>>>>>>>>>
37686>>>>>>>>>>>>>>>
37686>>>>>>>>>>>>>>>Use CTYPKIN.DD
37686>>>>>>>>>>>>>>>Use WTYPKIN.DD
37686>>>>>>>>>>>>>>>Use PTYPPAR.DD
37686>>>>>>>>>>>>>>>
37686>>>>>>>>>>>>>>>//AB-IgnoreEnd
37686>>>>>>>>>>>>>>>
37686>>>>>>>>>>>>>>>Object sl012 is a dbModalPanelSub
37688>>>>>>>>>>>>>>>
37688>>>>>>>>>>>>>>>    //AB-StoreTopStart
37688>>>>>>>>>>>>>>>    Property String psModule Public ''
37690>>>>>>>>>>>>>>>    Property integer pifromclient Public 0
37692>>>>>>>>>>>>>>>    
37692>>>>>>>>>>>>>>>    //AB-StoreTopEnd
37692>>>>>>>>>>>>>>>
37692>>>>>>>>>>>>>>>    Set Label to "’ç§¦  §˜¨˜©«˜« ¡é¤"
37693>>>>>>>>>>>>>>>    Set Size to 203 490
37694>>>>>>>>>>>>>>>    Set Location to 4 4
37695>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
37696>>>>>>>>>>>>>>>    Set Modal_State to FALSE
37697>>>>>>>>>>>>>>>
37697>>>>>>>>>>>>>>>    //AB-DDOStart
37697>>>>>>>>>>>>>>>
37697>>>>>>>>>>>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
37699>>>>>>>>>>>>>>>    End_Object    // Ctypkin_DD
37700>>>>>>>>>>>>>>>
37700>>>>>>>>>>>>>>>    Object Wtypkin_DD is a Wtypkin_DataDictionary
37702>>>>>>>>>>>>>>>    End_Object    // Wtypkin_DD
37703>>>>>>>>>>>>>>>
37703>>>>>>>>>>>>>>>    Object Ptyppar_DD is a Ptyppar_DataDictionary
37705>>>>>>>>>>>>>>>        Set DDO_Server to (Ctypkin_DD(self))
37706>>>>>>>>>>>>>>>        Set DDO_Server to (Wtypkin_DD(self))
37707>>>>>>>>>>>>>>>
37707>>>>>>>>>>>>>>>        //AB-StoreStart
37707>>>>>>>>>>>>>>>        
37707>>>>>>>>>>>>>>>        Procedure OnConstrain
37709>>>>>>>>>>>>>>>            Forward Send OnConstrain
37711>>>>>>>>>>>>>>>            If (psModule(Self)<>'') Begin
37713>>>>>>>>>>>>>>>                Constrain Ptyppar.Ptyppar_Module eq (psModule(Self))
37715>>>>>>>>>>>>>>>            End
37715>>>>>>>>>>>>>>>>
37715>>>>>>>>>>>>>>>            If (pifromclient(self)=1) Begin
37717>>>>>>>>>>>>>>>                Constrain Ptyppar.constrain eq '1'
37719>>>>>>>>>>>>>>>            End
37719>>>>>>>>>>>>>>>>
37719>>>>>>>>>>>>>>>        End_Procedure
37720>>>>>>>>>>>>>>>        
37720>>>>>>>>>>>>>>>        
37720>>>>>>>>>>>>>>>        
37720>>>>>>>>>>>>>>>        
37720>>>>>>>>>>>>>>>        //AB-StoreEnd
37720>>>>>>>>>>>>>>>
37720>>>>>>>>>>>>>>>    End_Object    // Ptyppar_DD
37721>>>>>>>>>>>>>>>
37721>>>>>>>>>>>>>>>    Set Main_DD to (Ptyppar_DD(self))
37722>>>>>>>>>>>>>>>    Set Server to (Ptyppar_DD(self))
37723>>>>>>>>>>>>>>>
37723>>>>>>>>>>>>>>>    //AB-DDOEnd
37723>>>>>>>>>>>>>>>
37723>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
37725>>>>>>>>>>>>>>>        Set Main_File to Ptyppar.File_Number
37726>>>>>>>>>>>>>>>        Set Size to 161 474
37727>>>>>>>>>>>>>>>        Set Location to 6 6
37728>>>>>>>>>>>>>>>
37728>>>>>>>>>>>>>>>        Begin_Row
37731>>>>>>>>>>>>>>>            Entry_Item Ptyppar.Ptyppar_code
37732>>>>>>>>>>>>>>>            Entry_Item Ptyppar.Ptyppar_descr
37733>>>>>>>>>>>>>>>            Entry_Item Ctypkin.Ctypkin_descr
37734>>>>>>>>>>>>>>>            Entry_Item Wtypkin.Wtypkin_descr
37735>>>>>>>>>>>>>>>        End_Row
37740>>>>>>>>>>>>>>>
37740>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 77
37741>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à›. ˜¨˜©«˜« ¡¦ç"
37742>>>>>>>>>>>>>>>        
37742>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 125
37743>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
37744>>>>>>>>>>>>>>>        
37744>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 137
37745>>>>>>>>>>>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž"
37746>>>>>>>>>>>>>>>        
37746>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 129
37747>>>>>>>>>>>>>>>        Set Header_Label  item 3 to "‰å¤ž©ž €§¦Ÿã¡žª"
37748>>>>>>>>>>>>>>>        
37748>>>>>>>>>>>>>>>
37748>>>>>>>>>>>>>>>        //AB-StoreStart
37748>>>>>>>>>>>>>>>        
37748>>>>>>>>>>>>>>>        Procedure Activate
37750>>>>>>>>>>>>>>>            Forward Send Activate
37752>>>>>>>>>>>>>>>            Send Rebuild_Constraints to Ptyppar_DD
37753>>>>>>>>>>>>>>>            Send Beginning_Of_Data to oSelList True
37754>>>>>>>>>>>>>>>        End_Procedure
37755>>>>>>>>>>>>>>>        
37755>>>>>>>>>>>>>>>        //AB-StoreEnd
37755>>>>>>>>>>>>>>>
37755>>>>>>>>>>>>>>>    End_Object    // oSelList
37756>>>>>>>>>>>>>>>
37756>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
37758>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
37759>>>>>>>>>>>>>>>        Set Location to 171 323
37760>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
37761>>>>>>>>>>>>>>>
37761>>>>>>>>>>>>>>>        //AB-StoreStart
37761>>>>>>>>>>>>>>>        Procedure OnClick
37763>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
37764>>>>>>>>>>>>>>>        End_Procedure
37765>>>>>>>>>>>>>>>        //AB-StoreEnd
37765>>>>>>>>>>>>>>>
37765>>>>>>>>>>>>>>>    End_Object    // oOK_bn
37766>>>>>>>>>>>>>>>
37766>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
37768>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
37769>>>>>>>>>>>>>>>        Set Location to 171 377
37770>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
37771>>>>>>>>>>>>>>>
37771>>>>>>>>>>>>>>>        //AB-StoreStart
37771>>>>>>>>>>>>>>>        Procedure OnClick
37773>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
37774>>>>>>>>>>>>>>>        End_Procedure
37775>>>>>>>>>>>>>>>        //AB-StoreEnd
37775>>>>>>>>>>>>>>>
37775>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
37776>>>>>>>>>>>>>>>
37776>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
37778>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
37779>>>>>>>>>>>>>>>        Set Location to 171 433
37780>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
37781>>>>>>>>>>>>>>>
37781>>>>>>>>>>>>>>>        //AB-StoreStart
37781>>>>>>>>>>>>>>>        Procedure OnClick
37783>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
37784>>>>>>>>>>>>>>>        End_Procedure
37785>>>>>>>>>>>>>>>        //AB-StoreEnd
37785>>>>>>>>>>>>>>>
37785>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
37786>>>>>>>>>>>>>>>
37786>>>>>>>>>>>>>>>
37786>>>>>>>>>>>>>>>    //AB-StoreStart
37786>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
37787>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
37788>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
37789>>>>>>>>>>>>>>>    
37789>>>>>>>>>>>>>>>    
37789>>>>>>>>>>>>>>>    //AB-StoreEnd
37789>>>>>>>>>>>>>>>
37789>>>>>>>>>>>>>>>End_Object    // sl012
37790>>>>>>>>>>>>>>>
37790>>>>>>>>>>>>>>>//AB/ End_Object    // prj
37790>>>>>>>>>>>>>
37790>>>>>>>>>>>>>//DDB-Selection-pkg-End
37790>>>>>>>>>>>>>//DDB-FileEnd
37790>>>>>>>>>>>    Use PSEIRA.DD
INCLUDING FILE: PSEIRA.DD
37790>>>>>>>>>>>>>//DDB-FileStart
37790>>>>>>>>>>>>>//DDB-HeaderStart
37790>>>>>>>>>>>>>
37790>>>>>>>>>>>>>// File Name : PSEIRA.DD
37790>>>>>>>>>>>>>// Class Name: Pseira_DataDictionary
37790>>>>>>>>>>>>>// Revision  : 34
37790>>>>>>>>>>>>>// Version   : 2
37790>>>>>>>>>>>>>
37790>>>>>>>>>>>>>Use  Windows           // Basic Definitions
37790>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
37790>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
37790>>>>>>>>>>>>>
37790>>>>>>>>>>>>>Open Pseira
37792>>>>>>>>>>>>>Open Ptyppar
37794>>>>>>>>>>>>>Open Sysrecp
37796>>>>>>>>>>>>>Open Syscurxr
37798>>>>>>>>>>>>>
37798>>>>>>>>>>>>>//DDB-HeaderEnd
37798>>>>>>>>>>>>>//DDB-SelectionStart
37798>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl013  sl013.SL
37798>>>>>>>>>>>>>Register_Object sl013
37798>>>>>>>>>>>>>//DDB-SelectionEnd
37798>>>>>>>>>>>>>
37798>>>>>>>>>>>>>Class Pseira_DataDictionary  is a DataDictionary
37799>>>>>>>>>>>>>
37799>>>>>>>>>>>>>    Procedure Save_Main_File
37800>>>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
37802>>>>>>>>>>>>>            If Pseira.Recnum Eq 0 Procedure_Return
37805>>>>>>>>>>>>>        End
37805>>>>>>>>>>>>>>
37805>>>>>>>>>>>>>        Forward Send Save_Main_File
37807>>>>>>>>>>>>>    End_Procedure
37808>>>>>>>>>>>>>
37808>>>>>>>>>>>>>    Procedure Update
37809>>>>>>>>>>>>>        Forward Send Update
37811>>>>>>>>>>>>>        // Insert Code Here
37811>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to Pseira.Company_Code
37812>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Pseira.Branch_Code
37813>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to Pseira.Year_Year
37814>>>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code   to Pseira.Ctypkin_Code
37815>>>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code   to Pseira.Wtypkin_Code
37816>>>>>>>>>>>>>        Move Ptyppar.Ptyppar_Code   to Pseira.Ptyppar_Code
37817>>>>>>>>>>>>>    End_Procedure   // Update
37818>>>>>>>>>>>>>
37818>>>>>>>>>>>>>
37818>>>>>>>>>>>>>     Procedure Creating
37819>>>>>>>>>>>>>        Forward Send Creating
37821>>>>>>>>>>>>>        // Insert Code Here
37821>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Pseira.Pseira_Rec0)))))) to Pseira.Pseira_Recr
37822>>>>>>>>>>>>>    End_Procedure   // Creating
37823>>>>>>>>>>>>>
37823>>>>>>>>>>>>>
37823>>>>>>>>>>>>>    // Define_Fields:
37823>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
37823>>>>>>>>>>>>>
37823>>>>>>>>>>>>>    Procedure Define_Fields
37824>>>>>>>>>>>>>        Forward Send Define_Fields
37826>>>>>>>>>>>>>        //DDB-Generated-Code-Location
37826>>>>>>>>>>>>>        //DDB-DefineFieldStart
37826>>>>>>>>>>>>>
37826>>>>>>>>>>>>>        Set Main_File            To Pseira.File_Number
37827>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
37828>>>>>>>>>>>>>
37828>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
37829>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
37830>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
37831>>>>>>>>>>>>>
37831>>>>>>>>>>>>>        // Parent (Server) file structure...............
37831>>>>>>>>>>>>>        Send Add_Server_File  Ptyppar.File_Number
37832>>>>>>>>>>>>>
37832>>>>>>>>>>>>>        // External (System) file structure.............
37832>>>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
37833>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
37834>>>>>>>>>>>>>
37834>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Pseira_Rec0  To Pseira.Pseira_Rec0
37837>>>>>>>>>>>>>
37837>>>>>>>>>>>>>        // Field-based properties.......................
37837>>>>>>>>>>>>>
37837>>>>>>>>>>>>>        // Pseira.Company_Code
37837>>>>>>>>>>>>>
37837>>>>>>>>>>>>>        // Pseira.Branch_Code
37837>>>>>>>>>>>>>
37837>>>>>>>>>>>>>        // Pseira.Year_Year
37837>>>>>>>>>>>>>
37837>>>>>>>>>>>>>        // Pseira.Ctypkin_Code
37837>>>>>>>>>>>>>
37837>>>>>>>>>>>>>        // Pseira.Wtypkin_Code
37837>>>>>>>>>>>>>
37837>>>>>>>>>>>>>        // Pseira.Ptyppar_Code
37837>>>>>>>>>>>>>
37837>>>>>>>>>>>>>        // Pseira.Ptyppar_Recr
37837>>>>>>>>>>>>>
37837>>>>>>>>>>>>>        // Pseira.Pseira_Seira
37837>>>>>>>>>>>>>        Set Field_Options          Field Pseira.Pseira_Seira To DD_AUTOFIND   
37838>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Pseira.Pseira_Seira To (sl013(Self))
37839>>>>>>>>>>>>>
37839>>>>>>>>>>>>>        // Pseira.Pseira_Rec0
37839>>>>>>>>>>>>>        Set Field_Options          Field Pseira.Pseira_Rec0 To DD_AUTOFIND   
37840>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Pseira.Pseira_Rec0 To (sl013(Self))
37841>>>>>>>>>>>>>
37841>>>>>>>>>>>>>        // Pseira.Pseira_Recr
37841>>>>>>>>>>>>>        Set Field_Options          Field Pseira.Pseira_Recr To DD_AUTOFIND   
37842>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Pseira.Pseira_Recr To (sl013(Self))
37843>>>>>>>>>>>>>
37843>>>>>>>>>>>>>        // Pseira.Pseira_Printer
37843>>>>>>>>>>>>>
37843>>>>>>>>>>>>>        // Pseira.Pseira_Form
37843>>>>>>>>>>>>>
37843>>>>>>>>>>>>>        // Pseira.Pseira_Autonum
37843>>>>>>>>>>>>>
37843>>>>>>>>>>>>>        // Pseira.Autonum_Plus
37843>>>>>>>>>>>>>
37843>>>>>>>>>>>>>        // Pseira.Autonum_Minus
37843>>>>>>>>>>>>>
37843>>>>>>>>>>>>>        // Pseira.Auto_Plus_Last
37843>>>>>>>>>>>>>
37843>>>>>>>>>>>>>        //DDB-DefineFieldEnd
37843>>>>>>>>>>>>>    End_Procedure    // Define_Fields
37844>>>>>>>>>>>>>
37844>>>>>>>>>>>>>    // Field_Defaults:
37844>>>>>>>>>>>>>    // This procedure is used to establish default field values.
37844>>>>>>>>>>>>>
37844>>>>>>>>>>>>>    Procedure Field_Defaults
37845>>>>>>>>>>>>>        Forward Send Field_Defaults
37847>>>>>>>>>>>>>        //DDB-Generated-Code-Location
37847>>>>>>>>>>>>>        //DDB-FieldDefaultStart
37847>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
37847>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
37848>>>>>>>>>>>>>
37848>>>>>>>>>>>>>End_Class    // Pseira_DataDictionary
37849>>>>>>>>>>>>>//DDB-Selection-pkg-Start
37849>>>>>>>>>>>>>
37849>>>>>>>>>>>>>Use sl013.SL         // sl013
INCLUDING FILE: SL013.SL
37849>>>>>>>>>>>>>>>//AB/ Project sl013:SeiraP
37849>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
37849>>>>>>>>>>>>>>>//AB/         Set ProjectName to "sl013:SeiraP"
37849>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl013.SL"
37849>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
37849>>>>>>>>>>>>>>>
37849>>>>>>>>>>>>>>>// Project Object Structure
37849>>>>>>>>>>>>>>>//   sl013 is a dbModalPanelSub
37849>>>>>>>>>>>>>>>//     Ctypkin_DD is a DataDictionary
37849>>>>>>>>>>>>>>>//     Wtypkin_DD is a DataDictionary
37849>>>>>>>>>>>>>>>//     Ptyppar_DD is a DataDictionary
37849>>>>>>>>>>>>>>>//     Pseira_DD is a DataDictionary
37849>>>>>>>>>>>>>>>//     oSelList is a dbListSub
37849>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
37849>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
37849>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
37849>>>>>>>>>>>>>>>
37849>>>>>>>>>>>>>>>// Register all objects
37849>>>>>>>>>>>>>>>Register_Object Ctypkin_DD
37849>>>>>>>>>>>>>>>Register_Object oCancel_bn
37849>>>>>>>>>>>>>>>Register_Object oOK_bn
37849>>>>>>>>>>>>>>>Register_Object oSearch_bn
37849>>>>>>>>>>>>>>>Register_Object oSelList
37849>>>>>>>>>>>>>>>Register_Object Pseira_DD
37849>>>>>>>>>>>>>>>Register_Object Ptyppar_DD
37849>>>>>>>>>>>>>>>Register_Object sl013
37849>>>>>>>>>>>>>>>Register_Object Wtypkin_DD
37849>>>>>>>>>>>>>>>
37849>>>>>>>>>>>>>>>
37849>>>>>>>>>>>>>>>    //AB-IgnoreStart
37849>>>>>>>>>>>>>>>
37849>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
37849>>>>>>>>>>>>>>>    Use dbList.Sub
37849>>>>>>>>>>>>>>>    Use Button.Sub
37849>>>>>>>>>>>>>>>
37849>>>>>>>>>>>>>>>
37849>>>>>>>>>>>>>>>    Use CTYPKIN.DD
37849>>>>>>>>>>>>>>>    Use WTYPKIN.DD
37849>>>>>>>>>>>>>>>    Use PTYPPAR.DD
37849>>>>>>>>>>>>>>>    Use PSEIRA.DD
37849>>>>>>>>>>>>>>>    
37849>>>>>>>>>>>>>>>    //AB-IgnoreEnd
37849>>>>>>>>>>>>>>>
37849>>>>>>>>>>>>>>>    Object sl013 is a dbModalPanelSub
37851>>>>>>>>>>>>>>>
37851>>>>>>>>>>>>>>>        //AB-StoreTopStart
37851>>>>>>>>>>>>>>>        Property String FragmaPtyppar_Recr Public ''
37853>>>>>>>>>>>>>>>        
37853>>>>>>>>>>>>>>>        //AB-StoreTopEnd
37853>>>>>>>>>>>>>>>
37853>>>>>>>>>>>>>>>        Set Label to "‰˜«á¢¦š¦ª ‘œ ¨é¤"
37854>>>>>>>>>>>>>>>        Set Size to 148 214
37855>>>>>>>>>>>>>>>        Set Location to 1 7
37856>>>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
37857>>>>>>>>>>>>>>>        Set Modal_State to FALSE
37858>>>>>>>>>>>>>>>
37858>>>>>>>>>>>>>>>        //AB-DDOStart
37858>>>>>>>>>>>>>>>
37858>>>>>>>>>>>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
37860>>>>>>>>>>>>>>>        End_Object    // Ctypkin_DD
37861>>>>>>>>>>>>>>>
37861>>>>>>>>>>>>>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
37863>>>>>>>>>>>>>>>        End_Object    // Wtypkin_DD
37864>>>>>>>>>>>>>>>
37864>>>>>>>>>>>>>>>        Object Ptyppar_DD is a Ptyppar_DataDictionary
37866>>>>>>>>>>>>>>>            Set DDO_Server to (Ctypkin_DD(self))
37867>>>>>>>>>>>>>>>            Set DDO_Server to (Wtypkin_DD(self))
37868>>>>>>>>>>>>>>>        End_Object    // Ptyppar_DD
37869>>>>>>>>>>>>>>>
37869>>>>>>>>>>>>>>>        Object Pseira_DD is a Pseira_DataDictionary
37871>>>>>>>>>>>>>>>            Set DDO_Server to (Ptyppar_DD(self))
37872>>>>>>>>>>>>>>>
37872>>>>>>>>>>>>>>>            //AB-StoreStart
37872>>>>>>>>>>>>>>>            Procedure OnConstrain
37874>>>>>>>>>>>>>>>                String sID
37875>>>>>>>>>>>>>>>                Forward Send OnConstrain
37877>>>>>>>>>>>>>>>                Get FragmaPtyppar_Recr to sID
37878>>>>>>>>>>>>>>>                Move (trim(sID)) to sID
37879>>>>>>>>>>>>>>>                If (sID<>'') Constrain Pseira.Ptyppar_Recr eq sID
37883>>>>>>>>>>>>>>>            End_procedure
37884>>>>>>>>>>>>>>>            
37884>>>>>>>>>>>>>>>            //AB-StoreEnd
37884>>>>>>>>>>>>>>>
37884>>>>>>>>>>>>>>>        End_Object    // Pseira_DD
37885>>>>>>>>>>>>>>>
37885>>>>>>>>>>>>>>>        Set Main_DD to (Pseira_DD(self))
37886>>>>>>>>>>>>>>>        Set Server to (Pseira_DD(self))
37887>>>>>>>>>>>>>>>
37887>>>>>>>>>>>>>>>        //AB-DDOEnd
37887>>>>>>>>>>>>>>>
37887>>>>>>>>>>>>>>>        Object oSelList is a dbListSub
37889>>>>>>>>>>>>>>>            Set Main_File to Pseira.File_Number
37890>>>>>>>>>>>>>>>            Set Size to 105 197
37891>>>>>>>>>>>>>>>            Set Location to 6 6
37892>>>>>>>>>>>>>>>
37892>>>>>>>>>>>>>>>            Begin_Row
37895>>>>>>>>>>>>>>>                Entry_Item Pseira.Pseira_seira
37896>>>>>>>>>>>>>>>                Entry_Item Pseira.Pseira_printer
37897>>>>>>>>>>>>>>>                Entry_Item Pseira.Pseira_autonum
37898>>>>>>>>>>>>>>>            End_Row
37903>>>>>>>>>>>>>>>
37903>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 40
37904>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‘œ ¨á"
37905>>>>>>>>>>>>>>>            
37905>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 135
37906>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "„¡«¬§à«ãª"
37907>>>>>>>>>>>>>>>            
37907>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 16
37908>>>>>>>>>>>>>>>            Set Header_Label  item 2 to "Autonum"
37909>>>>>>>>>>>>>>>            Set Column_Checkbox_State  item 2 to True
37910>>>>>>>>>>>>>>>            
37910>>>>>>>>>>>>>>>
37910>>>>>>>>>>>>>>>            //AB-StoreStart
37910>>>>>>>>>>>>>>>                    
37910>>>>>>>>>>>>>>>            Property String StoreFragmaPtyppar_Recr Public ''
37912>>>>>>>>>>>>>>>            
37912>>>>>>>>>>>>>>>            Procedure Store_Defaults
37914>>>>>>>>>>>>>>>                   Forward Send Store_Defaults
37916>>>>>>>>>>>>>>>                   Set StoreFragmaPtyppar_Recr to (FragmaPtyppar_Recr(Self))
37917>>>>>>>>>>>>>>>            End_Procedure
37918>>>>>>>>>>>>>>>            
37918>>>>>>>>>>>>>>>            Procedure ReStore_Defaults
37920>>>>>>>>>>>>>>>                   Forward Send ReStore_Defaults
37922>>>>>>>>>>>>>>>                   Set FragmaPtyppar_Recr to (StoreFragmaPtyppar_Recr(Self))
37923>>>>>>>>>>>>>>>            End_Procedure
37924>>>>>>>>>>>>>>>            
37924>>>>>>>>>>>>>>>            Procedure Activating
37926>>>>>>>>>>>>>>>                Forward Send Activating
37928>>>>>>>>>>>>>>>                Send Rebuild_Constraints to (Pseira_DD(Self))
37929>>>>>>>>>>>>>>>            End_Procedure
37930>>>>>>>>>>>>>>>            
37930>>>>>>>>>>>>>>>            
37930>>>>>>>>>>>>>>>            //AB-StoreEnd
37930>>>>>>>>>>>>>>>
37930>>>>>>>>>>>>>>>        End_Object    // oSelList
37931>>>>>>>>>>>>>>>
37931>>>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
37933>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
37934>>>>>>>>>>>>>>>            Set Location to 114 42
37935>>>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
37936>>>>>>>>>>>>>>>
37936>>>>>>>>>>>>>>>            //AB-StoreStart
37936>>>>>>>>>>>>>>>            Procedure OnClick
37938>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
37939>>>>>>>>>>>>>>>            End_Procedure
37940>>>>>>>>>>>>>>>            //AB-StoreEnd
37940>>>>>>>>>>>>>>>
37940>>>>>>>>>>>>>>>        End_Object    // oOK_bn
37941>>>>>>>>>>>>>>>
37941>>>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
37943>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
37944>>>>>>>>>>>>>>>            Set Location to 114 98
37945>>>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
37946>>>>>>>>>>>>>>>
37946>>>>>>>>>>>>>>>            //AB-StoreStart
37946>>>>>>>>>>>>>>>            Procedure OnClick
37948>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
37949>>>>>>>>>>>>>>>            End_Procedure
37950>>>>>>>>>>>>>>>            //AB-StoreEnd
37950>>>>>>>>>>>>>>>
37950>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
37951>>>>>>>>>>>>>>>
37951>>>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
37953>>>>>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
37954>>>>>>>>>>>>>>>            Set Location to 114 153
37955>>>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
37956>>>>>>>>>>>>>>>
37956>>>>>>>>>>>>>>>            //AB-StoreStart
37956>>>>>>>>>>>>>>>            Procedure OnClick
37958>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
37959>>>>>>>>>>>>>>>            End_Procedure
37960>>>>>>>>>>>>>>>            //AB-StoreEnd
37960>>>>>>>>>>>>>>>
37960>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
37961>>>>>>>>>>>>>>>
37961>>>>>>>>>>>>>>>
37961>>>>>>>>>>>>>>>        //AB-StoreStart
37961>>>>>>>>>>>>>>>            
37961>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
37962>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
37963>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
37964>>>>>>>>>>>>>>>        
37964>>>>>>>>>>>>>>>        
37964>>>>>>>>>>>>>>>        
37964>>>>>>>>>>>>>>>        
37964>>>>>>>>>>>>>>>        
37964>>>>>>>>>>>>>>>        
37964>>>>>>>>>>>>>>>        
37964>>>>>>>>>>>>>>>        
37964>>>>>>>>>>>>>>>        //AB-StoreEnd
37964>>>>>>>>>>>>>>>
37964>>>>>>>>>>>>>>>    End_Object    // sl013
37965>>>>>>>>>>>>>>>
37965>>>>>>>>>>>>>>>//AB/     End_Object    // prj
37965>>>>>>>>>>>>>
37965>>>>>>>>>>>>>//DDB-Selection-pkg-End
37965>>>>>>>>>>>>>//DDB-FileEnd
37965>>>>>>>>>>>    Use NOMISMA.DD
INCLUDING FILE: NOMISMA.DD
37965>>>>>>>>>>>>>//DDB-FileStart
37965>>>>>>>>>>>>>//DDB-HeaderStart
37965>>>>>>>>>>>>>
37965>>>>>>>>>>>>>// File Name : NOMISMA.DD
37965>>>>>>>>>>>>>// Class Name: Nomisma_DataDictionary
37965>>>>>>>>>>>>>// Revision  : 52
37965>>>>>>>>>>>>>// Version   : 2
37965>>>>>>>>>>>>>
37965>>>>>>>>>>>>>Use  Windows           // Basic Definitions
37965>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
37965>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
37965>>>>>>>>>>>>>
37965>>>>>>>>>>>>>Open Nomisma
37967>>>>>>>>>>>>>Open Isotimia
37969>>>>>>>>>>>>>Open Particle
37971>>>>>>>>>>>>>
37971>>>>>>>>>>>>>//DDB-HeaderEnd
37971>>>>>>>>>>>>>//DDB-ValidationStart
37971>>>>>>>>>>>>>
37971>>>>>>>>>>>>>Register_Object Nomisma_Nomisma_Type_VT
37971>>>>>>>>>>>>>Register_Object Nomisma_Nomisma_Sign0_VT
37971>>>>>>>>>>>>>Register_Object Nomisma_Nomisma_Sign00_VT
37971>>>>>>>>>>>>>Register_Object Nomisma_Nomisma_Signr_VT
37971>>>>>>>>>>>>>
37971>>>>>>>>>>>>>Object Nomisma_Nomisma_Type_VT  is a DescriptionValidationTable
37973>>>>>>>>>>>>>
37973>>>>>>>>>>>>>    Procedure Fill_List
37975>>>>>>>>>>>>>        Forward Send Fill_List
37977>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "Book1"
37978>>>>>>>>>>>>>        Send Add_Table_Value  "2"  "Book2"
37979>>>>>>>>>>>>>        Send Add_Table_Value  "3"  "Reporting"
37980>>>>>>>>>>>>>        Send Add_Table_Value  "0"  "Other"
37981>>>>>>>>>>>>>    End_Procedure    // Fill_List
37982>>>>>>>>>>>>>    //DDB-ValidationCustomStart
37982>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
37982>>>>>>>>>>>>>End_Object   // Nomisma_Nomisma_Type_VT
37983>>>>>>>>>>>>>
37983>>>>>>>>>>>>>Object Nomisma_Nomisma_Sign0_VT  is a DescriptionValidationTable
37985>>>>>>>>>>>>>
37985>>>>>>>>>>>>>    Procedure Fill_List
37987>>>>>>>>>>>>>        Forward Send Fill_List
37989>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
37990>>>>>>>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
37991>>>>>>>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨œ¯ £¦"
37992>>>>>>>>>>>>>    End_Procedure    // Fill_List
37993>>>>>>>>>>>>>    //DDB-ValidationCustomStart
37993>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
37993>>>>>>>>>>>>>End_Object   // Nomisma_Nomisma_Sign0_VT
37994>>>>>>>>>>>>>
37994>>>>>>>>>>>>>Object Nomisma_Nomisma_Sign00_VT  is a DescriptionValidationTable
37996>>>>>>>>>>>>>
37996>>>>>>>>>>>>>    Procedure Fill_List
37998>>>>>>>>>>>>>        Forward Send Fill_List
38000>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
38001>>>>>>>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
38002>>>>>>>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨â¯ £¦"
38003>>>>>>>>>>>>>    End_Procedure    // Fill_List
38004>>>>>>>>>>>>>    //DDB-ValidationCustomStart
38004>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
38004>>>>>>>>>>>>>End_Object   // Nomisma_Nomisma_Sign00_VT
38005>>>>>>>>>>>>>
38005>>>>>>>>>>>>>Object Nomisma_Nomisma_Signr_VT  is a DescriptionValidationTable
38007>>>>>>>>>>>>>
38007>>>>>>>>>>>>>    Procedure Fill_List
38009>>>>>>>>>>>>>        Forward Send Fill_List
38011>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
38012>>>>>>>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
38013>>>>>>>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨â¯ £¦"
38014>>>>>>>>>>>>>    End_Procedure    // Fill_List
38015>>>>>>>>>>>>>    //DDB-ValidationCustomStart
38015>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
38015>>>>>>>>>>>>>End_Object   // Nomisma_Nomisma_Signr_VT
38016>>>>>>>>>>>>>//DDB-ValidationEnd
38016>>>>>>>>>>>>>//DDB-SelectionStart
38016>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl059  sl059.sl
38016>>>>>>>>>>>>>Register_Object sl059
38016>>>>>>>>>>>>>//DDB-SelectionEnd
38016>>>>>>>>>>>>>
38016>>>>>>>>>>>>>Class Nomisma_DataDictionary  is a DataDictionary_Sec
38017>>>>>>>>>>>>>
38017>>>>>>>>>>>>>    Procedure Construct_Object
38018>>>>>>>>>>>>>        Forward Send Construct_Object
38020>>>>>>>>>>>>>        Property String psOldCode Public ''
38021>>>>>>>>>>>>>    End_procedure
38022>>>>>>>>>>>>>
38022>>>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
38023>>>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
38025>>>>>>>>>>>>>        Set psOldCode to Nomisma.Nomisma_Code
38026>>>>>>>>>>>>>    End_Procedure   // New_Current_Record
38027>>>>>>>>>>>>>
38027>>>>>>>>>>>>>    Procedure Save_Main_File
38028>>>>>>>>>>>>>        If ((Operation_Origin<>Self) And;             (Nomisma.Recnum=0)) Procedure_Return
38031>>>>>>>>>>>>>        Forward Send Save_Main_File
38033>>>>>>>>>>>>>    End_Procedure   // Save_Main_File
38034>>>>>>>>>>>>>
38034>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
38035>>>>>>>>>>>>>        Local Integer iReturnVal 
38036>>>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
38038>>>>>>>>>>>>>        If (Not(iReturnVal)) ;            Begin
38040>>>>>>>>>>>>>                     If  Nomisma.nomisma_Code eq ''                 Move 6220 to iReturnVal
38043>>>>>>>>>>>>>                Else If (Nomisma.Nomisma_Code <>(psOldCode(Self)) And ;                         (psOldCode(Self)<>''))  Move 6030 to iReturnVal
38047>>>>>>>>>>>>>                if iReturnVal Send Operation_Not_Allowed iReturnVal
38050>>>>>>>>>>>>>            End
38050>>>>>>>>>>>>>>
38050>>>>>>>>>>>>>        Function_Return iReturnVal
38051>>>>>>>>>>>>>    End_Function   // Validate_Save
38052>>>>>>>>>>>>>
38052>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
38053>>>>>>>>>>>>>             if iError_num eq 6220 error 6220 "Œ¦£ ©£˜«˜ => ‰à› ¡æª ¡œ¤æª "
38056>>>>>>>>>>>>>        Else if iError_num eq 6030 error 6030 "„§ ¢â¥«œ ¤æ£ ©£˜ ˜§¦ «ž¤ ¢å©«˜ £œ (F4)\nž §˜«ã©«œ §¨é«˜ F5 ©«¦ ž›ž ¬§á¨®¦¤\nà©«œ ¤˜ ¡˜Ÿ˜¨å©œ  ž ˜¨® ¡ã «¦¬ « £ã\n§¨å¤ œ§ ¢â¥œ«œ á¢¢¦"
38060>>>>>>>>>>>>>        //Else if iError_num eq 6030 error 6030 "ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ©«¦ ¡à› ¡æ ¤¦£å©£˜«¦ª"
38060>>>>>>>>>>>>>        else Forward Send Operation_Not_Allowed  iError_Num
38063>>>>>>>>>>>>>    End_Procedure   // Operation_Not_Allowed
38064>>>>>>>>>>>>>
38064>>>>>>>>>>>>>    Procedure Update
38065>>>>>>>>>>>>>        Forward Send Update
38067>>>>>>>>>>>>>        // Insert Code Here
38067>>>>>>>>>>>>>        SYSDATE NOMISMA.LUP
38068>>>>>>>>>>>>>    End_Procedure   // Update
38069>>>>>>>>>>>>>
38069>>>>>>>>>>>>>    Procedure Creating
38070>>>>>>>>>>>>>        Forward Send Creating
38072>>>>>>>>>>>>>        // Insert Code Here
38072>>>>>>>>>>>>>        SYSDATE NOMISMA.FUP
38073>>>>>>>>>>>>>    End_Procedure   // Creating
38074>>>>>>>>>>>>>
38074>>>>>>>>>>>>>    // Define_Fields:
38074>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
38074>>>>>>>>>>>>>
38074>>>>>>>>>>>>>    Procedure Define_Fields
38075>>>>>>>>>>>>>        Forward Send Define_Fields
38077>>>>>>>>>>>>>        //DDB-Generated-Code-Location
38077>>>>>>>>>>>>>        //DDB-DefineFieldStart
38077>>>>>>>>>>>>>
38077>>>>>>>>>>>>>        Set Main_File            To Nomisma.File_Number
38078>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
38079>>>>>>>>>>>>>
38079>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
38080>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
38081>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38082>>>>>>>>>>>>>
38082>>>>>>>>>>>>>        // Child (Client) file structure................
38082>>>>>>>>>>>>>        Send Add_Client_File  Isotimia.File_Number
38083>>>>>>>>>>>>>        Send Add_Client_File  Particle.File_Number
38084>>>>>>>>>>>>>
38084>>>>>>>>>>>>>        // Field-based properties.......................
38084>>>>>>>>>>>>>
38084>>>>>>>>>>>>>        // Nomisma.Nomisma_Code
38084>>>>>>>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Code To DD_AUTOFIND    DD_CAPSLOCK   
38085>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Code To (sl059(Self))
38086>>>>>>>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Code To TRUE
38087>>>>>>>>>>>>>
38087>>>>>>>>>>>>>        // Nomisma.Nomisma_Descr
38087>>>>>>>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Descr To DD_CAPSLOCK   
38088>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Descr To (sl059(Self))
38089>>>>>>>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Descr To TRUE
38090>>>>>>>>>>>>>
38090>>>>>>>>>>>>>        // Nomisma.Nomisma_Short
38090>>>>>>>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Short To DD_CAPSLOCK   
38091>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Short To (sl059(Self))
38092>>>>>>>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Short To TRUE
38093>>>>>>>>>>>>>
38093>>>>>>>>>>>>>        // Nomisma.Dekadika
38093>>>>>>>>>>>>>
38093>>>>>>>>>>>>>        // Nomisma.Fup
38093>>>>>>>>>>>>>
38093>>>>>>>>>>>>>        // Nomisma.Lup
38093>>>>>>>>>>>>>
38093>>>>>>>>>>>>>        // Nomisma.Euro_Zone
38093>>>>>>>>>>>>>
38093>>>>>>>>>>>>>        // Nomisma.Einai_Drx
38093>>>>>>>>>>>>>
38093>>>>>>>>>>>>>        // Nomisma.Einai_Euro
38093>>>>>>>>>>>>>
38093>>>>>>>>>>>>>        // Nomisma.Monades
38093>>>>>>>>>>>>>
38093>>>>>>>>>>>>>        // Nomisma.Kl_Isot_Euro
38093>>>>>>>>>>>>>
38093>>>>>>>>>>>>>        // Nomisma.Nomisma_Type
38093>>>>>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Type To (Nomisma_Nomisma_Type_VT(Self))
38094>>>>>>>>>>>>>
38094>>>>>>>>>>>>>        // Nomisma.Nomisma_Sign0
38094>>>>>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Sign0 To (Nomisma_Nomisma_Sign0_VT(Self))
38095>>>>>>>>>>>>>
38095>>>>>>>>>>>>>        // Nomisma.Nomisma_Sign00
38095>>>>>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Sign00 To (Nomisma_Nomisma_Sign00_VT(Self))
38096>>>>>>>>>>>>>
38096>>>>>>>>>>>>>        // Nomisma.Nomisma_Signr
38096>>>>>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Signr To (Nomisma_Nomisma_Signr_VT(Self))
38097>>>>>>>>>>>>>
38097>>>>>>>>>>>>>        //DDB-DefineFieldEnd
38097>>>>>>>>>>>>>    End_Procedure    // Define_Fields
38098>>>>>>>>>>>>>
38098>>>>>>>>>>>>>    // Field_Defaults:
38098>>>>>>>>>>>>>    // This procedure is used to establish default field values.
38098>>>>>>>>>>>>>
38098>>>>>>>>>>>>>    Procedure Field_Defaults
38099>>>>>>>>>>>>>        Forward Send Field_Defaults
38101>>>>>>>>>>>>>        //DDB-Generated-Code-Location
38101>>>>>>>>>>>>>        //DDB-FieldDefaultStart
38101>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
38101>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
38102>>>>>>>>>>>>>
38102>>>>>>>>>>>>>End_Class    // Nomisma_DataDictionary
38103>>>>>>>>>>>>>//DDB-Selection-pkg-Start
38103>>>>>>>>>>>>>
38103>>>>>>>>>>>>>Use sl059.sl         // sl059
INCLUDING FILE: SL059.SL
38103>>>>>>>>>>>>>>>//AB/ Project sl059
38103>>>>>>>>>>>>>>>//AB/     Object prj is a LOOKUP_Project
38103>>>>>>>>>>>>>>>//AB/         Set ProjectName to "sl059"
38103>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl059.SL"
38103>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
38103>>>>>>>>>>>>>>>
38103>>>>>>>>>>>>>>>    //AB-IgnoreStart
38103>>>>>>>>>>>>>>>
38103>>>>>>>>>>>>>>>
38103>>>>>>>>>>>>>>>
38103>>>>>>>>>>>>>>>
38103>>>>>>>>>>>>>>>    Use NOMISMA.DD
38103>>>>>>>>>>>>>>>
38103>>>>>>>>>>>>>>>    //AB-IgnoreEnd
38103>>>>>>>>>>>>>>>
38103>>>>>>>>>>>>>>>    CD_Popup_Object sl059 is a dbModalPanelSub
38122>>>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
38123>>>>>>>>>>>>>>>        Set Modal_State to FALSE
38124>>>>>>>>>>>>>>>        Set Popup_State to FALSE
38125>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
38126>>>>>>>>>>>>>>>        set label to "Œ¦£å©£˜«˜" 
38127>>>>>>>>>>>>>>>        Set Size to 148 295
38128>>>>>>>>>>>>>>>        Set Location to 4 5
38129>>>>>>>>>>>>>>>
38129>>>>>>>>>>>>>>>        //AB-DDOStart
38129>>>>>>>>>>>>>>>
38129>>>>>>>>>>>>>>>        Object Nomisma_DD is a Nomisma_DataDictionary
38131>>>>>>>>>>>>>>>        End_Object    // Nomisma_DD
38132>>>>>>>>>>>>>>>
38132>>>>>>>>>>>>>>>        Set Main_DD to (Nomisma_DD(Current_Object))
38133>>>>>>>>>>>>>>>        Set Server to (Nomisma_DD(Current_Object))
38134>>>>>>>>>>>>>>>
38134>>>>>>>>>>>>>>>        //AB-DDOEnd
38134>>>>>>>>>>>>>>>
38134>>>>>>>>>>>>>>>        Object oSelList is a dbListSub
38136>>>>>>>>>>>>>>>            Set Main_File to Nomisma.File_Number
38137>>>>>>>>>>>>>>>            Set Size to 105 278
38138>>>>>>>>>>>>>>>            Set Location to 6 6
38139>>>>>>>>>>>>>>>
38139>>>>>>>>>>>>>>>            Begin_Row
38142>>>>>>>>>>>>>>>                Entry_Item Nomisma.Nomisma_code
38143>>>>>>>>>>>>>>>                Entry_Item Nomisma.Nomisma_descr
38144>>>>>>>>>>>>>>>                Entry_Item Nomisma.Nomisma_short
38145>>>>>>>>>>>>>>>                Entry_Item Nomisma.Dekadika
38146>>>>>>>>>>>>>>>            End_Row
38151>>>>>>>>>>>>>>>
38151>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 45
38152>>>>>>>>>>>>>>>            set header_label  item 0 to "‰à› ¡¦ª" 
38153>>>>>>>>>>>>>>>
38153>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 115
38154>>>>>>>>>>>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
38155>>>>>>>>>>>>>>>
38155>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 58
38156>>>>>>>>>>>>>>>            set header_label  item 2 to "‘ç¤«¦£ž" 
38157>>>>>>>>>>>>>>>
38157>>>>>>>>>>>>>>>            Set Form_Width    item 3 to 54
38158>>>>>>>>>>>>>>>            set header_label  item 3 to "ƒœ¡˜› ¡á" 
38159>>>>>>>>>>>>>>>
38159>>>>>>>>>>>>>>>        End_Object    // oSelList
38160>>>>>>>>>>>>>>>
38160>>>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
38162>>>>>>>>>>>>>>>            set label to "&„§ ¢¦šã" 
38163>>>>>>>>>>>>>>>            Set Location to 113 124
38164>>>>>>>>>>>>>>>
38164>>>>>>>>>>>>>>>            //AB-StoreStart
38164>>>>>>>>>>>>>>>            Procedure OnClick
38166>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
38167>>>>>>>>>>>>>>>            End_Procedure
38168>>>>>>>>>>>>>>>            //AB-StoreEnd
38168>>>>>>>>>>>>>>>
38168>>>>>>>>>>>>>>>        End_Object    // oOK_bn
38169>>>>>>>>>>>>>>>
38169>>>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
38171>>>>>>>>>>>>>>>            set label to "&€¡ç¨à©ž" 
38172>>>>>>>>>>>>>>>            Set Location to 113 179
38173>>>>>>>>>>>>>>>
38173>>>>>>>>>>>>>>>            //AB-StoreStart
38173>>>>>>>>>>>>>>>            Procedure OnClick
38175>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
38176>>>>>>>>>>>>>>>            End_Procedure
38177>>>>>>>>>>>>>>>            //AB-StoreEnd
38177>>>>>>>>>>>>>>>
38177>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
38178>>>>>>>>>>>>>>>
38178>>>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
38180>>>>>>>>>>>>>>>            set label to "€&¤˜ã«ž©ž" 
38181>>>>>>>>>>>>>>>            Set Location to 113 234
38182>>>>>>>>>>>>>>>
38182>>>>>>>>>>>>>>>            //AB-StoreStart
38182>>>>>>>>>>>>>>>            Procedure OnClick
38184>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
38185>>>>>>>>>>>>>>>            End_Procedure
38186>>>>>>>>>>>>>>>            //AB-StoreEnd
38186>>>>>>>>>>>>>>>
38186>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
38187>>>>>>>>>>>>>>>
38187>>>>>>>>>>>>>>>
38187>>>>>>>>>>>>>>>        //AB-StoreStart
38187>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
38188>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
38189>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
38190>>>>>>>>>>>>>>>        //AB-StoreEnd
38190>>>>>>>>>>>>>>>
38190>>>>>>>>>>>>>>>    CD_End_Object    // sl059
38192>>>>>>>>>>>>>>>>
38192>>>>>>>>>>>>>>>
38192>>>>>>>>>>>>>>>//AB/     End_Object    // prj
38192>>>>>>>>>>>>>
38192>>>>>>>>>>>>>//DDB-Selection-pkg-End
38192>>>>>>>>>>>>>//DDB-FileEnd
38192>>>>>>>>>>>    Use COUNTRY.DD
38192>>>>>>>>>>>    Use TOWNS.DD
38192>>>>>>>>>>>    Use CITIES.DD
38192>>>>>>>>>>>    Use PAYRESP.DD
38192>>>>>>>>>>>    Use AREAS.DD
38192>>>>>>>>>>>    Use CLIENTS.DD
38192>>>>>>>>>>>    Use PARTICLE.DD
INCLUDING FILE: PARTICLE.DD
38192>>>>>>>>>>>>>//DDB-FileStart
38192>>>>>>>>>>>>>//DDB-HeaderStart
38192>>>>>>>>>>>>>
38192>>>>>>>>>>>>>// File Name : PARTICLE.DD
38192>>>>>>>>>>>>>// Class Name: Particle_DataDictionary
38192>>>>>>>>>>>>>// Revision  : 237
38192>>>>>>>>>>>>>// Version   : 2
38192>>>>>>>>>>>>>
38192>>>>>>>>>>>>>Use  Windows           // Basic Definitions
38192>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
38192>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38192>>>>>>>>>>>>>
38192>>>>>>>>>>>>>Open Particle
38194>>>>>>>>>>>>>Open Pmoves
38196>>>>>>>>>>>>>Open Tparticl
INCLUDING FILE: TPARTICL.FD
38198>>>>>>>>>>>>>Open Partlfpa
INCLUDING FILE: PARTLFPA.FD
38200>>>>>>>>>>>>>Open Pmovesl
INCLUDING FILE: PMOVESL.FD
38202>>>>>>>>>>>>>Open Psxetika
38204>>>>>>>>>>>>>Open Clients
38206>>>>>>>>>>>>>Open Ptyppar
38208>>>>>>>>>>>>>Open Nomisma
38210>>>>>>>>>>>>>Open Sysrecp
38212>>>>>>>>>>>>>Open Syscurxr
38214>>>>>>>>>>>>>Open Pseira
38216>>>>>>>>>>>>>Open Cn
38218>>>>>>>>>>>>>Open Partlfpa
38220>>>>>>>>>>>>>Open Clorder
38222>>>>>>>>>>>>>Open Clorderd
INCLUDING FILE: CLORDERD.FD
38224>>>>>>>>>>>>>Open Ypoprosf
INCLUDING FILE: YPOPROSF.FD
38226>>>>>>>>>>>>>Open Psxetika
38228>>>>>>>>>>>>>Open Pmoves
38230>>>>>>>>>>>>>
38230>>>>>>>>>>>>>//DDB-HeaderEnd
38230>>>>>>>>>>>>>//DDB-ValidationStart
38230>>>>>>>>>>>>>
38230>>>>>>>>>>>>>Register_Object Particle_Tropos_Diakin_VT
38230>>>>>>>>>>>>>Register_Object Particle_Skopos_Diakin_VT
38230>>>>>>>>>>>>>Register_Object Particle_Tropos_Plhromhs_VT
38230>>>>>>>>>>>>>
38230>>>>>>>>>>>>>Object Particle_Tropos_Diakin_VT  is a CodeValidationTable
38232>>>>>>>>>>>>>    Set Type_Value        To "SEND_TERMS"
38233>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
38234>>>>>>>>>>>>>    //DDB-ValidationCustomStart
38234>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
38234>>>>>>>>>>>>>End_Object   // Particle_Tropos_Diakin_VT
38235>>>>>>>>>>>>>
38235>>>>>>>>>>>>>Object Particle_Skopos_Diakin_VT  is a CodeValidationTable
38237>>>>>>>>>>>>>    Set Type_Value        To "SKOPOS"
38238>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
38239>>>>>>>>>>>>>    //DDB-ValidationCustomStart
38239>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
38239>>>>>>>>>>>>>End_Object   // Particle_Skopos_Diakin_VT
38240>>>>>>>>>>>>>
38240>>>>>>>>>>>>>Object Particle_Tropos_Plhromhs_VT  is a CodeValidationTable
38242>>>>>>>>>>>>>    Set Type_Value        To "PAY_TERMS"
38243>>>>>>>>>>>>>    Set Validate_State    To FALSE
38244>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
38245>>>>>>>>>>>>>    //DDB-ValidationCustomStart
38245>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
38245>>>>>>>>>>>>>End_Object   // Particle_Tropos_Plhromhs_VT
38246>>>>>>>>>>>>>//DDB-ValidationEnd
38246>>>>>>>>>>>>>//DDB-SelectionStart
38246>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl041  sl041.SL
38246>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl014  sl014.SL
38246>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl054  sl054.SL
38246>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl053  sl053.SL
38246>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl064  sl064.SL
38246>>>>>>>>>>>>>Register_Object sl041
38246>>>>>>>>>>>>>Register_Object sl014
38246>>>>>>>>>>>>>Register_Object sl054
38246>>>>>>>>>>>>>Register_Object sl053
38246>>>>>>>>>>>>>Register_Object sl064
38246>>>>>>>>>>>>>//DDB-SelectionEnd
38246>>>>>>>>>>>>>
38246>>>>>>>>>>>>>//Object oValidateSeira is a FileValidationTable
38246>>>>>>>>>>>>>//    Set Table_Title         to "„§ ¢¦šã ‘œ ¨áª ˜¨˜©«˜« ¡¦ç"
38246>>>>>>>>>>>>>//    Set Main_File           to Pseira.File_Number
38246>>>>>>>>>>>>>//    Set Code_Field          to  8 //Pseira.Pseira_Seira
38246>>>>>>>>>>>>>//    Set Description_Field   to 11 //Pseira.Pseira_Printer
38246>>>>>>>>>>>>>//    Set Ordering            to  1
38246>>>>>>>>>>>>>//    Set Static_State to False
38246>>>>>>>>>>>>>//End_Object
38246>>>>>>>>>>>>>
38246>>>>>>>>>>>>>Open Cars
INCLUDING FILE: CARS.FD
38248>>>>>>>>>>>>>Open Drivers
INCLUDING FILE: DRIVERS.FD
38250>>>>>>>>>>>>>Open Pumps
INCLUDING FILE: PUMPS.FD
38252>>>>>>>>>>>>>Open SysCurXr
38254>>>>>>>>>>>>>
38254>>>>>>>>>>>>>Class Particle_DataDictionary  is a DataDictionary_Sec
38255>>>>>>>>>>>>>
38255>>>>>>>>>>>>>    Function fsVresAntliaDescr String asOxhmaCode Returns String
38256>>>>>>>>>>>>>        String rVal
38257>>>>>>>>>>>>>        Clear Pumps
38258>>>>>>>>>>>>>        Move SysCurXr.Company_Code  to Pumps.Pump_Company
38259>>>>>>>>>>>>>        Move asOxhmaCode            to Pumps.Pump_ID
38260>>>>>>>>>>>>>        Find Eq Pumps By Index.1 // Pump_Company + Pump_ID
38261>>>>>>>>>>>>>>
38261>>>>>>>>>>>>>        If (Found) Move (Trim(Pumps.Pump_Descr)) to rVal
38264>>>>>>>>>>>>>        Else Move '' to rVal
38266>>>>>>>>>>>>>        Function_Return rVal
38267>>>>>>>>>>>>>    End_Function
38268>>>>>>>>>>>>>
38268>>>>>>>>>>>>>    Function fsVresOxhmaDescr String asOxhmaCode Returns String
38269>>>>>>>>>>>>>        String rVal
38270>>>>>>>>>>>>>        Clear Cars
38271>>>>>>>>>>>>>        Move SysCurXr.Company_Code  to Cars.Car_Company
38272>>>>>>>>>>>>>        Move asOxhmaCode            to Cars.Car_ID
38273>>>>>>>>>>>>>        Find Eq Cars By Index.1 // Car_Company + Car_ID
38274>>>>>>>>>>>>>>
38274>>>>>>>>>>>>>
38274>>>>>>>>>>>>>        If (Found) Move (Trim(Cars.Car_License)) to rVal
38277>>>>>>>>>>>>>        Else Move '' to rVal
38279>>>>>>>>>>>>>        Function_Return rVal
38280>>>>>>>>>>>>>    End_Function
38281>>>>>>>>>>>>>
38281>>>>>>>>>>>>>    Function fsVresDriverCode String asOxhmaCode Returns String
38282>>>>>>>>>>>>>        String rVal
38283>>>>>>>>>>>>>        Clear Cars
38284>>>>>>>>>>>>>        Move SysCurXr.Company_Code  to Cars.Car_Company
38285>>>>>>>>>>>>>        Move asOxhmaCode            to Cars.Car_ID
38286>>>>>>>>>>>>>        Find Eq Cars By Index.1 // Car_Company + Car_ID
38287>>>>>>>>>>>>>>
38287>>>>>>>>>>>>>        If (Found)  Move (Trim(Cars.Car_DriverID)) to rVal
38290>>>>>>>>>>>>>        Else        Move '' to rVal
38292>>>>>>>>>>>>>        Function_Return rVal
38293>>>>>>>>>>>>>    End_Function
38294>>>>>>>>>>>>>
38294>>>>>>>>>>>>>    Function fsVresDriverDescr String asDriverCode Returns String
38295>>>>>>>>>>>>>        String rVal
38296>>>>>>>>>>>>>        Clear Drivers
38297>>>>>>>>>>>>>        Move SysCurXr.Company_Code  to Drivers.Driver_Company
38298>>>>>>>>>>>>>        Move asDriverCode           to Drivers.Driver_ID
38299>>>>>>>>>>>>>        Find Eq Drivers By Index.1 // Driver_Company + Driver_ID
38300>>>>>>>>>>>>>>
38300>>>>>>>>>>>>>        If (Found) Move (Trim(Drivers.Driver_Name)) to rVal
38303>>>>>>>>>>>>>        Else Move '' to rVal
38305>>>>>>>>>>>>>        Function_Return rVal
38306>>>>>>>>>>>>>    End_Function
38307>>>>>>>>>>>>>
38307>>>>>>>>>>>>>    Procedure Construct_Object
38308>>>>>>>>>>>>>        Forward Send Construct_Object
38310>>>>>>>>>>>>>        Property String     psOldCode       Public ''
38311>>>>>>>>>>>>>        Property Integer    piPmovesID      Public  0
38312>>>>>>>>>>>>>        Property String     psOldUserID     Public ''
38313>>>>>>>>>>>>>        Property Integer    piOldSelected   Public  0
38314>>>>>>>>>>>>>        Property Integer    piFromMetasx    Public  0
38315>>>>>>>>>>>>>    End_procedure
38316>>>>>>>>>>>>>
38316>>>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
38317>>>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
38319>>>>>>>>>>>>>        Set psOldCode       to Particle.Nomisma_Code
38320>>>>>>>>>>>>>        Set psOldUserID     to Particle.Partl_ToposF
38321>>>>>>>>>>>>>        Set piOldSelected   to Particle.Partl_Selected
38322>>>>>>>>>>>>>    End_Procedure   // New_Current_Record
38323>>>>>>>>>>>>>
38323>>>>>>>>>>>>>    Procedure Shmera integer iField  Date dDate
38324>>>>>>>>>>>>>        Local Integer Changed
38325>>>>>>>>>>>>>        Get Field_Changed_State iField to Changed
38326>>>>>>>>>>>>>        If (Changed=0 AND dDate =0) Begin
38328>>>>>>>>>>>>>            SysDate4 dDate
38329>>>>>>>>>>>>>            Set Field_Default_Value iField to dDate
38330>>>>>>>>>>>>>        End
38330>>>>>>>>>>>>>>
38330>>>>>>>>>>>>>    End_Procedure   // Shmera
38331>>>>>>>>>>>>>
38331>>>>>>>>>>>>>    Procedure Shmera_Ora integer iField  Number nOra
38332>>>>>>>>>>>>>        Local Integer Changed
38333>>>>>>>>>>>>>        Date dDate
38333>>>>>>>>>>>>>        Number nHour nMin
38333>>>>>>>>>>>>>        Get Field_Changed_State iField to Changed
38334>>>>>>>>>>>>>        If (Changed=0 AND nOra =0) Begin
38336>>>>>>>>>>>>>            SysDate4 dDate nHour nMin
38339>>>>>>>>>>>>>            Set Field_Default_Value iField to (nHour+(nMin/100))
38340>>>>>>>>>>>>>        End
38340>>>>>>>>>>>>>>
38340>>>>>>>>>>>>>    End_Procedure   // Shmera
38341>>>>>>>>>>>>>
38341>>>>>>>>>>>>>    Procedure Shmera_Ora_String integer iField  String asOra
38342>>>>>>>>>>>>>        Local Integer Changed
38343>>>>>>>>>>>>>        Date dDate
38343>>>>>>>>>>>>>        Number nHour nMin nTotal
38343>>>>>>>>>>>>>        String sOra sMin
38343>>>>>>>>>>>>>        Get Field_Changed_State iField to Changed
38344>>>>>>>>>>>>>        If (Changed=0 AND asOra='') Begin
38346>>>>>>>>>>>>>            SysDate4 dDate nHour nMin
38349>>>>>>>>>>>>>            Move (nHour+(nMin/100)) to nTotal
38350>>>>>>>>>>>>>            Set Field_Default_Value iField to (fsConvert_Time_Number_To_String_With_Zeroes(nTotal))
38351>>>>>>>>>>>>>        End
38351>>>>>>>>>>>>>>
38351>>>>>>>>>>>>>    End_Procedure   // Shmera
38352>>>>>>>>>>>>>
38352>>>>>>>>>>>>>    Procedure Save_Main_File
38353>>>>>>>>>>>>>        String  sCodeApo sCodeEos sOldUserID sCurrentUserID
38354>>>>>>>>>>>>>        Integer iBreak iPmoves iSelected iOldSelected
38354>>>>>>>>>>>>>        Number  nPoso nPosoEuro nIsotimia nPosothtaKin
38354>>>>>>>>>>>>>        Date    dHmnia
38354>>>>>>>>>>>>>
38354>>>>>>>>>>>>>        If ((Operation_Origin<>Self) And ;            (Particle.Recnum=0)) Procedure_Return
38357>>>>>>>>>>>>>
38357>>>>>>>>>>>>>        If (Particle.Cn_Code<>'') Begin
38359>>>>>>>>>>>>>            Clear Cn
38360>>>>>>>>>>>>>            Move Particle.Cn_Code   to Cn.Cn_Code
38361>>>>>>>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
38362>>>>>>>>>>>>>>
38362>>>>>>>>>>>>>            If (Found) Begin
38364>>>>>>>>>>>>>                Move Cn.Cn_Sls_ID       to Particle.Sls_ID
38365>>>>>>>>>>>>>                Move Cn.CN_Cnt_ID       to Particle.Cnt_ID
38366>>>>>>>>>>>>>                Move Cn.CN_Recr         to Particle.CN_Recr
38367>>>>>>>>>>>>>            End
38367>>>>>>>>>>>>>>
38367>>>>>>>>>>>>>            Else Begin
38368>>>>>>>>>>>>>                Move ''                 to Particle.Sls_ID
38369>>>>>>>>>>>>>                Move ''                 to Particle.Cnt_ID
38370>>>>>>>>>>>>>                Move ''                 to Particle.CN_Recr
38371>>>>>>>>>>>>>            End
38371>>>>>>>>>>>>>>
38371>>>>>>>>>>>>>        End
38371>>>>>>>>>>>>>>
38371>>>>>>>>>>>>>        Else Begin
38372>>>>>>>>>>>>>            Move ''                 to Particle.Sls_ID
38373>>>>>>>>>>>>>            Move ''                 to Particle.Cnt_ID
38374>>>>>>>>>>>>>            Move ''                 to Particle.CN_Recr
38375>>>>>>>>>>>>>        End
38375>>>>>>>>>>>>>>
38375>>>>>>>>>>>>>
38375>>>>>>>>>>>>>        Move Pmoves.Recnum              to iPmoves
38376>>>>>>>>>>>>>
38376>>>>>>>>>>>>>        Move Particle.Partl_Selected    to iSelected
38377>>>>>>>>>>>>>        Get piOldSelected               to iOldSelected
38378>>>>>>>>>>>>>        Get fsLoginUserID               to sCurrentUserID
38379>>>>>>>>>>>>>        Get psOldUserID                 to sOldUserID
38380>>>>>>>>>>>>>
38380>>>>>>>>>>>>>        If (Particle.Partl_Disctof<>0) Begin
38382>>>>>>>>>>>>>            If (sOldUserID='') Move sCurrentUserID to Particle.Partl_Toposf
38385>>>>>>>>>>>>>        End
38385>>>>>>>>>>>>>>
38385>>>>>>>>>>>>>        Else Begin
38386>>>>>>>>>>>>>            Move '' to Particle.Partl_Toposf
38387>>>>>>>>>>>>>        End
38387>>>>>>>>>>>>>>
38387>>>>>>>>>>>>>
38387>>>>>>>>>>>>>        Move 0 to nPosothtaKin
38388>>>>>>>>>>>>>
38388>>>>>>>>>>>>>        //If (iSelected<>iOldSelected) Begin
38388>>>>>>>>>>>>>        If ((piFromMetasx(Self)) Or (iSelected<>iOldSelected))Begin
38390>>>>>>>>>>>>>            If ((Particle.Partl_Toposf=sCurrentUserID) Or (Particle.Partl_Toposf='')) Begin
38392>>>>>>>>>>>>>                If (iSelected) Begin
38394>>>>>>>>>>>>>                    Clear Pmoves
38395>>>>>>>>>>>>>                    Move Particle.Partl_Recr to Pmoves.Partl_Recr
38396>>>>>>>>>>>>>                    Find Gt Pmoves by index.3
38397>>>>>>>>>>>>>>
38397>>>>>>>>>>>>>                    While ((Found=1) And (Pmoves.Partl_Recr=Particle.Partl_Recr))
38401>>>>>>>>>>>>>                        Move Pmoves.Timol_Ypol  to Pmoves.Qty_Kinhshs
38402>>>>>>>>>>>>>                        Add  Pmoves.Timol_Ypol  to nPosothtaKin
38403>>>>>>>>>>>>>                        Move 1              to Pmoves.Pms_Selected
38404>>>>>>>>>>>>>                        Saverecord Pmoves
38405>>>>>>>>>>>>>                        Find Gt Pmoves by index.3
38406>>>>>>>>>>>>>>
38406>>>>>>>>>>>>>                    Loop
38407>>>>>>>>>>>>>>
38407>>>>>>>>>>>>>                    Move sCurrentUserID to Particle.Partl_Toposf
38408>>>>>>>>>>>>>                    Move nPosothtaKin   to Particle.Partl_Disctof
38409>>>>>>>>>>>>>                End
38409>>>>>>>>>>>>>>
38409>>>>>>>>>>>>>                Else Begin
38410>>>>>>>>>>>>>                    Clear Pmoves
38411>>>>>>>>>>>>>                    Move Particle.Partl_Recr to Pmoves.Partl_Recr
38412>>>>>>>>>>>>>                    Find Gt Pmoves by index.3
38413>>>>>>>>>>>>>>
38413>>>>>>>>>>>>>                    While ((Found=1) And (Pmoves.Partl_Recr=Particle.Partl_Recr))
38417>>>>>>>>>>>>>                        Move 0 to Pmoves.Qty_Kinhshs
38418>>>>>>>>>>>>>                        Move 0 to Pmoves.Pms_Selected
38419>>>>>>>>>>>>>                        Saverecord Pmoves
38420>>>>>>>>>>>>>                        Find Gt Pmoves by index.3
38421>>>>>>>>>>>>>>
38421>>>>>>>>>>>>>                    Loop
38422>>>>>>>>>>>>>>
38422>>>>>>>>>>>>>                    Move '' to Particle.Partl_Toposf
38423>>>>>>>>>>>>>                    Move 0  to Particle.Partl_Disctof
38424>>>>>>>>>>>>>                End
38424>>>>>>>>>>>>>>
38424>>>>>>>>>>>>>
38424>>>>>>>>>>>>>//                // js 11/04/2003
38424>>>>>>>>>>>>>//                If (iPmoves) Begin
38424>>>>>>>>>>>>>//                    Clear Pmoves
38424>>>>>>>>>>>>>//                    Move iPmoves to Pmoves.Recnum
38424>>>>>>>>>>>>>//                    Find Eq Pmoves.Recnum
38424>>>>>>>>>>>>>//                End
38424>>>>>>>>>>>>>
38424>>>>>>>>>>>>>            End
38424>>>>>>>>>>>>>>
38424>>>>>>>>>>>>>            Set piFromMetasx to 0
38425>>>>>>>>>>>>>        End
38425>>>>>>>>>>>>>>
38425>>>>>>>>>>>>>
38425>>>>>>>>>>>>>        Forward Send Save_Main_File
38427>>>>>>>>>>>>>
38427>>>>>>>>>>>>>    End_Procedure   // Save_Main_File
38428>>>>>>>>>>>>>
38428>>>>>>>>>>>>>
38428>>>>>>>>>>>>>    Procedure Calc_The_Totals
38429>>>>>>>>>>>>>        Number nPct nPoso nAxia nTmp
38430>>>>>>>>>>>>>
38430>>>>>>>>>>>>>        Move (Particle.Partl_AMDISCPMS  + ;              Particle.Partl_TotDiscPc)         to Particle.Partl_DiscAm
38431>>>>>>>>>>>>>
38431>>>>>>>>>>>>>        Move (Particle.Partl_TotAmBD    - ;              Particle.Partl_DiscAm)            to Particle.Partl_TotAmAd
38432>>>>>>>>>>>>>
38432>>>>>>>>>>>>>        Move (Particle.Partl_TotAmAd    + ;              Particle.Partl_Extra)             to Particle.Partl_GenAm
38433>>>>>>>>>>>>>
38433>>>>>>>>>>>>>        If ((Particle.Partl_Extra<>0) And (Particle.Partl_ExtraVatP<>0)) Begin
38435>>>>>>>>>>>>>            Move (Round(Particle.Partl_Extra        *;                        Particle.Partl_ExtraVatP    /;                  100))                         to Particle.Partl_ExtraVat
38436>>>>>>>>>>>>>        End
38436>>>>>>>>>>>>>>
38436>>>>>>>>>>>>>
38436>>>>>>>>>>>>>        If ((Particle.Partl_TotDiscPC<>0) And (Particle.Disc_Vat_Pct<>0)) Begin
38438>>>>>>>>>>>>>            Move (Round(Particle.Partl_TotDiscPC    *;                        Particle.Disc_Vat_Pct       /;                  100))                         to Particle.Disc_Vat_Poso
38439>>>>>>>>>>>>>        End
38439>>>>>>>>>>>>>>
38439>>>>>>>>>>>>>
38439>>>>>>>>>>>>>        Move (Particle.Partl_Vatam-Particle.Disc_Vat_Poso+Particle.Partl_ExtraVat) ;            to Particle.Total_Vat_Poso
38440>>>>>>>>>>>>>
38440>>>>>>>>>>>>>        Move (Particle.Partl_GenAm      + ;              Particle.Total_Vat_Poso ) to Particle.Partl_PayAm
38441>>>>>>>>>>>>>
38441>>>>>>>>>>>>>        If (Particle.PARTL_TOTTEM>0) Begin
38443>>>>>>>>>>>>>            Move (Particle.PARTL_TOTTEM-Particle.Timol_Qty) ;                                            to Particle.Timol_Ypol
38444>>>>>>>>>>>>>
38444>>>>>>>>>>>>>            Move (Particle.Timol_Ypol=0)    to Particle.Partl_Timol
38445>>>>>>>>>>>>>
38445>>>>>>>>>>>>>        End
38445>>>>>>>>>>>>>>
38445>>>>>>>>>>>>>        Else Move 0 to Particle.Partl_Timol
38447>>>>>>>>>>>>>
38447>>>>>>>>>>>>>        Move Particle.Partl_TotAmAD  to nAxia
38448>>>>>>>>>>>>>        Move Particle.Parakrat_Pct   to nPct
38449>>>>>>>>>>>>>        Move (Round_Number(((nAxia*nPct)/100),2)) to nTmp
38450>>>>>>>>>>>>>        Move nTmp to Particle.Parakrat_Poso
38451>>>>>>>>>>>>>    End_Procedure
38452>>>>>>>>>>>>>
38452>>>>>>>>>>>>>    Procedure Find_The_Rate
38453>>>>>>>>>>>>>        String  sCode sWhat
38454>>>>>>>>>>>>>        Integer iRateID
38454>>>>>>>>>>>>>        Number nEuro nIsot nRate
38454>>>>>>>>>>>>>        Date dHmnia
38454>>>>>>>>>>>>>        Move Nomisma.Nomisma_Code                   to sCode
38455>>>>>>>>>>>>>        If (Trim(sCode)='') Move SysCurXr.C_Code0   to sCode
38458>>>>>>>>>>>>>        Move Particle.Partl_Hmnia       to dHmnia
38459>>>>>>>>>>>>>        Move Particle.Isotimia          to nIsot
38460>>>>>>>>>>>>>        If (nIsot=0) Begin
38462>>>>>>>>>>>>>            If (dHmnia='') Sysdate dHmnia
38465>>>>>>>>>>>>>            Move (Trim(sCode)) to sCode
38466>>>>>>>>>>>>>            Clear Isotimia
38467>>>>>>>>>>>>>            Move sCode      to Isotimia.Nomisma_Code
38468>>>>>>>>>>>>>            Move (dHmnia+1) to Isotimia.Isotimia_Hmnia
38469>>>>>>>>>>>>>            Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
38470>>>>>>>>>>>>>>
38470>>>>>>>>>>>>>            If (Nomisma.Einai_Drx) Move 1 to Particle.Isotimia
38473>>>>>>>>>>>>>            Else Begin
38474>>>>>>>>>>>>>                Case Begin
38474>>>>>>>>>>>>>                    case (isotimia.poia_metatrepei='€') // Agora
38476>>>>>>>>>>>>>                        Move Isotimia.Isotimia_Agora to Particle.Isotimia
38477>>>>>>>>>>>>>                        Case Break
38478>>>>>>>>>>>>>                    case (isotimia.poia_metatrepei='') // Polhsh
38481>>>>>>>>>>>>>                        Move Isotimia.Isotimia_Polhsh to Particle.Isotimia
38482>>>>>>>>>>>>>                        Case Break
38483>>>>>>>>>>>>>                    Case (Isotimia.Poia_Metatrepei='F') // Fixing
38486>>>>>>>>>>>>>                        Move Isotimia.Isotimia_Fixing to Particle.Isotimia
38487>>>>>>>>>>>>>                        Case Break
38488>>>>>>>>>>>>>                    Case (Isotimia.Poia_Metatrepei='P') // Private
38491>>>>>>>>>>>>>                        Move Isotimia.Isotimia_Privat to Particle.Isotimia
38492>>>>>>>>>>>>>                        Case Break
38493>>>>>>>>>>>>>                Case End
38493>>>>>>>>>>>>>            End
38493>>>>>>>>>>>>>>
38493>>>>>>>>>>>>>        End
38493>>>>>>>>>>>>>>
38493>>>>>>>>>>>>>        Else Begin
38494>>>>>>>>>>>>>            If (dHmnia='') Sysdate      dHmnia
38497>>>>>>>>>>>>>            Move (Trim(sCode))      to  sCode
38498>>>>>>>>>>>>>            Clear Nomisma
38499>>>>>>>>>>>>>            Move sCode              to Nomisma.Nomisma_Code
38500>>>>>>>>>>>>>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
38501>>>>>>>>>>>>>>
38501>>>>>>>>>>>>>            If (Nomisma.Einai_Drx) Move 1 to Particle.Isotimia
38504>>>>>>>>>>>>>        End
38504>>>>>>>>>>>>>>
38504>>>>>>>>>>>>>    End_Procedure
38505>>>>>>>>>>>>>
38505>>>>>>>>>>>>>    Procedure Update
38506>>>>>>>>>>>>>        String  sCodeApo sCodeEos
38507>>>>>>>>>>>>>        String  sCar sCarDescr sDriver sDriverDescr
38507>>>>>>>>>>>>>        Integer iBreak iPmovesID
38507>>>>>>>>>>>>>        Number  nPoso nPosoEuro nIsotimia
38507>>>>>>>>>>>>>        Date    dHmnia
38507>>>>>>>>>>>>>
38507>>>>>>>>>>>>>        Forward Send Update
38509>>>>>>>>>>>>>
38509>>>>>>>>>>>>>        Send Find_The_Rate
38510>>>>>>>>>>>>>
38510>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to Particle.Company_Code
38511>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Particle.Branch_Code
38512>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to Particle.Year_Year
38513>>>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code   to Particle.Ctypkin_Code
38514>>>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code   to Particle.Wtypkin_Code
38515>>>>>>>>>>>>>        //Move Custprom.Custprom_Code to Particle.Custprom_Code
38515>>>>>>>>>>>>>        Move Clients.Client_ID      to Particle.Client_ID
38516>>>>>>>>>>>>>        Move Ptyppar.Ptyppar_Code   to Particle.Ptyppar_Code
38517>>>>>>>>>>>>>        Move Ptyppar.Ptyppar_Module to Particle.Partl_Module
38518>>>>>>>>>>>>>
38518>>>>>>>>>>>>>        Move Payresp.Presp_ID       to Particle.Presp_ID
38519>>>>>>>>>>>>>
38519>>>>>>>>>>>>>        Send Calc_The_Totals
38520>>>>>>>>>>>>>
38520>>>>>>>>>>>>>        Move    Particle.Oxhma_Code             to sCar
38521>>>>>>>>>>>>>        Get     fsVresOxhmaDescr sCar           to Particle.Oxhma_Descr
38522>>>>>>>>>>>>>        Get     fsVresDriverCode sCar           to Particle.Odhgos_Code
38523>>>>>>>>>>>>>        Move    Particle.Odhgos_Code            to sDriver
38524>>>>>>>>>>>>>        Get     fsVresDriverDescr sDriver       to Particle.Odhgos_Name
38525>>>>>>>>>>>>>        Move    Particle.Antlia_Code            to sCar
38526>>>>>>>>>>>>>        Get     fsVresAntliaDescr sCar          to sCarDescr
38527>>>>>>>>>>>>>        Move    sCarDescr                       to Particle.Antlia_Descr
38528>>>>>>>>>>>>>
38528>>>>>>>>>>>>>        If (Particle.Partl_ExtraVat) Begin
38530>>>>>>>>>>>>>            Clear PartlFpa
38531>>>>>>>>>>>>>            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
38532>>>>>>>>>>>>>            Move Particle.Partl_ExtraVatP   to PartlFpa.Fpa_Pososto
38533>>>>>>>>>>>>>            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
38534>>>>>>>>>>>>>>
38534>>>>>>>>>>>>>            Add Particle.Partl_ExtraVat     to PartlFpa.PartlFpa_Poso
38535>>>>>>>>>>>>>            Saverecord PartlFpa
38536>>>>>>>>>>>>>        End
38536>>>>>>>>>>>>>>
38536>>>>>>>>>>>>>
38536>>>>>>>>>>>>>        If (Particle.Disc_Vat_Poso) Begin
38538>>>>>>>>>>>>>            Clear PartlFpa
38539>>>>>>>>>>>>>            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
38540>>>>>>>>>>>>>            Move Particle.Disc_Vat_Pct      to PartlFpa.Fpa_Pososto
38541>>>>>>>>>>>>>            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
38542>>>>>>>>>>>>>>
38542>>>>>>>>>>>>>            Add Particle.Disc_Vat_Poso      to PartlFpa.PartlFpa_Poso
38543>>>>>>>>>>>>>            Saverecord PartlFpa
38544>>>>>>>>>>>>>        End
38544>>>>>>>>>>>>>>
38544>>>>>>>>>>>>>
38544>>>>>>>>>>>>>        // 01/10/2001 Mphke edo anti gia thn creating gia na kalipsei to problhma
38544>>>>>>>>>>>>>        // pou proekeipte an gia kapoio logo den symplhrvnotan seira kai o arithmos
38544>>>>>>>>>>>>>        // emene 0 eprepe na sbhstoun OLA ta lines kai to idio to parastatiko gia na
38544>>>>>>>>>>>>>        // xanatrexei o kodikas elegxou seiras kai arithmou
38544>>>>>>>>>>>>>        // Tora trexei sthn Update (giati sthn Save_Main_File kanei validation
38544>>>>>>>>>>>>>        // PRIN kai kobei thn eggrafh epeidh o arithmos einai 0
38544>>>>>>>>>>>>>        If ( ((Operation_Origin=Self) Or                 ;             (Operation_Origin=(piPmovesID(Self)))) And  ;             (Particle.Partl_No=0)) Send Kathorise_Thn_Seira
38547>>>>>>>>>>>>>        // 01/10/2001
38547>>>>>>>>>>>>>    End_Procedure   // Update
38548>>>>>>>>>>>>>
38548>>>>>>>>>>>>>    Procedure Backout
38549>>>>>>>>>>>>>        Forward Send Backout
38551>>>>>>>>>>>>>        Send Calc_The_Totals
38552>>>>>>>>>>>>>
38552>>>>>>>>>>>>>        If (Particle.Partl_ExtraVat) Begin
38554>>>>>>>>>>>>>            Clear PartlFpa
38555>>>>>>>>>>>>>            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
38556>>>>>>>>>>>>>            Move Particle.Partl_ExtraVatP   to PartlFpa.Fpa_Pososto
38557>>>>>>>>>>>>>            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
38558>>>>>>>>>>>>>>
38558>>>>>>>>>>>>>            Sub Particle.Partl_ExtraVat   From PartlFpa.PartlFpa_Poso
38559>>>>>>>>>>>>>            Saverecord PartlFpa
38560>>>>>>>>>>>>>            If (PartlFpa.PartlFpa_Poso=0) Delete PartlFpa
38563>>>>>>>>>>>>>        End
38563>>>>>>>>>>>>>>
38563>>>>>>>>>>>>>
38563>>>>>>>>>>>>>        If (Particle.Disc_Vat_Poso) Begin
38565>>>>>>>>>>>>>            Clear PartlFpa
38566>>>>>>>>>>>>>            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
38567>>>>>>>>>>>>>            Move Particle.Disc_Vat_Pct      to PartlFpa.Fpa_Pososto
38568>>>>>>>>>>>>>            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
38569>>>>>>>>>>>>>>
38569>>>>>>>>>>>>>            Sub Particle.Disc_Vat_Poso    From PartlFpa.PartlFpa_Poso
38570>>>>>>>>>>>>>            Saverecord PartlFpa
38571>>>>>>>>>>>>>            If (PartlFpa.PartlFpa_Poso=0) Delete PartlFpa
38574>>>>>>>>>>>>>        End
38574>>>>>>>>>>>>>>
38574>>>>>>>>>>>>>    End_Procedure
38575>>>>>>>>>>>>>
38575>>>>>>>>>>>>>    Procedure Kathorise_Thn_Seira
38576>>>>>>>>>>>>>        Integer iNextNo iSeiraRecnum iPtypparRecnum
38577>>>>>>>>>>>>>
38577>>>>>>>>>>>>>//       js 25/04/2002 Prosthikh gia na ypostirixei ektyposh promhtheyton
38577>>>>>>>>>>>>>        If (Ptyppar.Ptyppar_Is_What='2') Begin
38579>>>>>>>>>>>>>            Clear Pseira
38580>>>>>>>>>>>>>            Move SysCurXr.Company_Code  to Pseira.Company_Code
38581>>>>>>>>>>>>>            Move SysCurXr.Branch_Code   to Pseira.Branch_Code
38582>>>>>>>>>>>>>            //Move SysCurXr.Year_Year     to Pseira.Year_Year
38582>>>>>>>>>>>>>            //Move Ctypkin.Ctypkin_Code   to Pseira.Ctypkin_Code
38582>>>>>>>>>>>>>            //Move Wtypkin.Wtypkin_Code   to Pseira.Wtypkin_Code
38582>>>>>>>>>>>>>            Move Ptyppar.Ptyppar_Code   to Pseira.Ptyppar_Code
38583>>>>>>>>>>>>>            Move Particle.Pseira_Seira  to Pseira.Pseira_Seira
38584>>>>>>>>>>>>>            Find eq Pseira By Index.1 // Pseira:Index.1:Company_Code+Branch_Code+Year_Year+;
38585>>>>>>>>>>>>>>
38585>>>>>>>>>>>>>                                    //                Ctypkin_Code+Wtypkin_Code+Ptyppar_Code+Seira_Seira
38585>>>>>>>>>>>>>            If (Found=1) Begin
38587>>>>>>>>>>>>>                // €¤ ž ©œ ¨˜ œ ¤˜  autonum ¡˜  «¦ §˜¨˜©«˜« ¡¦ œ ¤˜  «¬§¦¬ 2 —Š†‘†
38587>>>>>>>>>>>>>                If ((Pseira.Pseira_Autonum  = 1)    And ;                    (Particle.Partl_No      = 0 )) Begin
38589>>>>>>>>>>>>>                    Move (Pseira.Autonum_Minus-1) to iNextNo
38590>>>>>>>>>>>>>                    Move (Pseira.Autonum_Minus-1) to Pseira.Autonum_Minus
38591>>>>>>>>>>>>>                    Saverecord Pseira
38592>>>>>>>>>>>>>                    Move iNextNo to Particle.Partl_No
38593>>>>>>>>>>>>>                End
38593>>>>>>>>>>>>>>
38593>>>>>>>>>>>>>            End
38593>>>>>>>>>>>>>>
38593>>>>>>>>>>>>>        End
38593>>>>>>>>>>>>>>
38593>>>>>>>>>>>>>        Else Begin
38594>>>>>>>>>>>>>//       js 25/04/2002 Prosthikh gia na ypostirixei ektyposh promhtheyton
38594>>>>>>>>>>>>>            If ((Ptyppar.Ptyppar_Is_What='1') And (Trim(Ptyppar.Sysxet_Ptyppar)<>'')) Begin
38596>>>>>>>>>>>>>                Move (Random(-10000000)-1) To Particle.Partl_No
38597>>>>>>>>>>>>>            End
38597>>>>>>>>>>>>>>
38597>>>>>>>>>>>>>        End
38597>>>>>>>>>>>>>>
38597>>>>>>>>>>>>>    End_Procedure
38598>>>>>>>>>>>>>
38598>>>>>>>>>>>>>    Procedure Creating
38599>>>>>>>>>>>>>        Integer iNextNo
38600>>>>>>>>>>>>>        String  sNo sSeira
38600>>>>>>>>>>>>>        Forward Send Creating
38602>>>>>>>>>>>>>        // Insert Code Here
38602>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                         (Trim(String(Particle.Partl_Rec0)))))) to Particle.Partl_Recr
38603>>>>>>>>>>>>>
38603>>>>>>>>>>>>>        If (Particle.Disc_Vat_Pct   =0) Move 18 to Particle.Disc_Vat_Pct
38606>>>>>>>>>>>>>        If (Particle.Partl_ExtraVatP=0) Move 18 to Particle.Partl_ExtraVatP
38609>>>>>>>>>>>>>
38609>>>>>>>>>>>>>        Move Clients.Ypoloipo to Particle.Prohg_Ypol
38610>>>>>>>>>>>>>
38610>>>>>>>>>>>>>        If ((Trim(Ptyppar.Ti_Typonei_Pms)<>'2') And (Trim(Particle.Cn_Code)<>'')) Begin
38612>>>>>>>>>>>>>            Clear Cn
38613>>>>>>>>>>>>>            Move Particle.Cn_Code   to Cn.Cn_Code
38614>>>>>>>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
38615>>>>>>>>>>>>>>
38615>>>>>>>>>>>>>            If (Found) Begin
38617>>>>>>>>>>>>>                Move Particle.Partl_No      to sNo
38618>>>>>>>>>>>>>                Move Particle.Pseira_Seira  to sSeira
38619>>>>>>>>>>>>>                Move (Trim(sNo))            to sNo
38620>>>>>>>>>>>>>                Move (Trim(sSeira))         to sSeira
38621>>>>>>>>>>>>>                if (cn.hm_prot_fortio='')   Move Particle.Partl_Hmnia   to Cn.Hm_prot_Fortio
38624>>>>>>>>>>>>>                Move Particle.Partl_Hmnia   to Cn.Hm_Tel_Fortio
38625>>>>>>>>>>>>>                Move (Trim(sSeira+' '+sNo)) to Cn.Tel_Fortio_No
38626>>>>>>>>>>>>>                Saverecord CN
38627>>>>>>>>>>>>>            End
38627>>>>>>>>>>>>>>
38627>>>>>>>>>>>>>        End
38627>>>>>>>>>>>>>>
38627>>>>>>>>>>>>>    End_Procedure   // Creating
38628>>>>>>>>>>>>>
38628>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
38629>>>>>>>>>>>>>        String sStr
38630>>>>>>>>>>>>>        Move '' to sStr
38631>>>>>>>>>>>>>        Append sStr "DDC 14: ’¦ §˜¨˜©«˜« ¡æ §œ¨ â®œ  œ¤˜ œå›¦ª «¦ ¦§¦å¦\n"
38632>>>>>>>>>>>>>        Append sStr "§˜¨¦¬© áœ  ¡å¤ž©ž §¨¦ª £œ«˜©®ž£˜« ©£æ ˜§¦ «¦¤ ®¨ã©«ž\n"
38633>>>>>>>>>>>>>        Append sStr Particle.Partl_Toposf ". ˜«ã©«œ F5 £œ«˜ «¦ Ž‰"
38635>>>>>>>>>>>>>
38635>>>>>>>>>>>>>             If (iError_Num = 1001) Error 1001 "DDC 14: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ˜¨˜©«˜« ¡¦ç"
38638>>>>>>>>>>>>>        Else If (iError_Num = 1002) Error 1002 "DDC 14: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ”¦¨â˜"
38642>>>>>>>>>>>>>        Else If (iError_Num = 1003) Error 1003 "DDC 14: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã Œ¦£å©£˜«¦ª"
38646>>>>>>>>>>>>>        Else If (iError_Num = 1004) Error 1004 "DDC 14: †£œ¨¦£ž¤å˜ §˜¨˜©«˜« ¡¦ç ¡œ¤ã"
38650>>>>>>>>>>>>>        Else If (iError_Num = 1005) Error 1005 "DDC 14: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
38654>>>>>>>>>>>>>        Else If (iError_Num = 1006) Error 1006 "DDC 14: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
38658>>>>>>>>>>>>>        Else If (iError_Num = 1007) Error 1007 "DDC 14: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
38662>>>>>>>>>>>>>        Else If (iError_Num = 1008) Error 1008 "DDC 14: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
38666>>>>>>>>>>>>>        Else If (iError_Num = 1009) Error 1009 "DDC 14: ƒœ¤ œå¤˜  œ­ ¡«ã ž › ˜š¨˜­ã \n„®œ  ›ž£ ¦¬¨šžŸœå £œ«˜©®ž£˜« ©£â¤¦ §˜¨˜©«˜« ¡æ"
38670>>>>>>>>>>>>>        Else If (iError_Num = 1010) Error 1010 "DDC 14: † é¨˜ §¨â§œ  ¤˜ ›¦Ÿœå\n£œ 2 ¯ž­å˜ š ˜ «ž¤ é¨˜ ¡˜  2 š ˜ «˜ ¢œ§«á"
38674>>>>>>>>>>>>>        Else If (iError_Num = 1011) Error 1011 "DDC 14: †£œ¨¦£ž¤å˜ §¨¦šœ¤â©«œ¨ž «žª «œ¢œ¬«˜å˜ª œ¡«ç§à©žª"
38678>>>>>>>>>>>>>        Else If (iError_Num = 1012) Error 1012 sStr
38682>>>>>>>>>>>>>        Else If (iError_Num = 1055) Error 1055 "DDC 14: †£œ¨¦£ž¤åœª œ¡«æª ¦¨åà¤ ®¨ã©žª"
38686>>>>>>>>>>>>>        Else If (iError_Num = 1060) Error 1060 "DDC 14: ˜¨˜©«˜« ¡æ £œ«˜©®ž£˜« ©£â¤¦.\nƒœ¤ œ§ «¨â§œ«˜  ¦§¦ ˜›ã§¦«œ ˜¢¢˜šã ©«¦ ®œåà¤"
38690>>>>>>>>>>>>>        Else If (iError_Num = 1061) Error 1061 "DDC 14: ˜¨˜©«˜« ¡æ £œ«˜©®ž£˜« ©£â¤¦.\nƒœ¤ œ§ «¨â§œ«˜  ¤˜ › ˜š¨˜­œå"
38694>>>>>>>>>>>>>        Else If (iError_Num = 6040) Error 6040 "DDC 14: ƒœ¤ â®œ  §¨¦©› ¦¨ ©«œå ¡à› ¡æª ¤¦£å©£˜«¦ª"
38698>>>>>>>>>>>>>        Else If (iError_Num = 6050) Error 6050 "DDC 14: Ž œ¢á«žª ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž"
38702>>>>>>>>>>>>>        Else If (iError_Num = 6051) Error 6051 "DDC 14: ’¦ §˜¨˜©«˜« ¡æ ¡ ¤œå ˜¥åœª ˜¢¢á «¦ ©ç¤¦¢¦ «à¤ ˜¥ é¤ «¦¬ œå¤˜  £ž›œ¤ ¡æ"
38706>>>>>>>>>>>>>        Else If (iError_Num = 6060) Error 6060 "DDC 14: Ž “§œçŸ¬¤¦ª ¢ž¨à£é¤ ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž"
38710>>>>>>>>>>>>>        Else If (iError_Num = 1110) Error 1110 "DDC 14: †£/¤å˜ §˜¨˜©«˜« ¡¦ç <= †£/¤å˜ª ¡¢œ ©å£˜«¦ª\nƒœ¤ œ§ «¨â§œ«˜  ¡˜££å˜ «¨¦§¦§¦åž©ž ©«¦ §˜¨˜©«˜« ¡æ"
38714>>>>>>>>>>>>>        Else If (iError_Num = 1065) Error 1065 "DDC 14: Ž €¨ Ÿ£æª «¦¬ §˜¨˜©«˜« ¡¦ç \nƒ„Œ §¨â§œ  ¡˜  ›œ¤ £§¦¨œå ¤˜ œå¤˜  £ž›œ¤ ¡æª"
38718>>>>>>>>>>>>>        Else Forward Send Operation_Not_Allowed  iError_Num
38721>>>>>>>>>>>>>    End_Procedure   // Operation_Not_Allowed
38722>>>>>>>>>>>>>
38722>>>>>>>>>>>>>    Function Validate_Save Returns Integer
38723>>>>>>>>>>>>>        Number nqty
38724>>>>>>>>>>>>>        Integer iReturnVal iYes
38724>>>>>>>>>>>>>        String  sCurrentUserID sOldUserID
38724>>>>>>>>>>>>>
38724>>>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
38726>>>>>>>>>>>>>
38726>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
38728>>>>>>>>>>>>>                 If (Ptyppar.Recnum      = 0)   Move 1001 to iReturnVal
38731>>>>>>>>>>>>>            Else If (Clients.Recnum      = 0)   Move 1002 to iReturnVal
38735>>>>>>>>>>>>>            Else If (Nomisma.Recnum      = 0)   Move 1003 to iReturnVal
38739>>>>>>>>>>>>>            Else If (Particle.Partl_Hmnia='')   Move 1004 to iReturnVal
38743>>>>>>>>>>>>>            Else If  Nomisma.nomisma_Code eq '' Move 6040 to iReturnVal
38747>>>>>>>>>>>>>            Else Begin
38748>>>>>>>>>>>>>//                If ((Clients.Plafon>0) And (Clients.OverHead<1) And (Sysfile.Over_OverHead<>'1')) Begin
38748>>>>>>>>>>>>>//                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
38748>>>>>>>>>>>>>//                    If (iYes=MBR_NO) Move 6050 to iReturnVal
38748>>>>>>>>>>>>>//                End
38748>>>>>>>>>>>>>//                Else If ((Clients.Plafon>0) And (PayResp.Plafon>0) And (PayResp.OverHead<1) And (Sysfile.Over_OverHead<>'1')) Begin
38748>>>>>>>>>>>>>//                    Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
38748>>>>>>>>>>>>>//                    If (iYes=MBR_NO) Move 6060 to iReturnVal
38748>>>>>>>>>>>>>//                End
38748>>>>>>>>>>>>>//                Else If ((PayResp.Plafon>0) And (PayResp.OverHead<1) And (Sysfile.Over_OverHead<>'1')) begin
38748>>>>>>>>>>>>>//                    Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
38748>>>>>>>>>>>>>//                    If (iYes=MBR_NO) Move 6060 to iReturnVal
38748>>>>>>>>>>>>>//                End
38748>>>>>>>>>>>>>
38748>>>>>>>>>>>>>                If ((Particle.Partl_Hmnia<SYSCURXR.YEAR_XRHSHFROM) Or ;                    (Particle.Partl_Hmnia>SYSCURXR.YEAR_XRHSHTO))     ;                                                Move 1055 to iReturnVal
38751>>>>>>>>>>>>>                Else Begin
38752>>>>>>>>>>>>>                    If (Particle.Partl_Disctof<>0) Begin
38754>>>>>>>>>>>>>                        Get fsLoginUserID to sCurrentUserID
38755>>>>>>>>>>>>>                        Get psOldUserID   to sOldUserID
38756>>>>>>>>>>>>>                        If (sOldUserID<>'') Begin
38758>>>>>>>>>>>>>                            If (sOldUserID<>sCurrentUserID) Move 1012 to iReturnVal
38761>>>>>>>>>>>>>                        End
38761>>>>>>>>>>>>>>
38761>>>>>>>>>>>>>                        //Else Move sCurrentUserID to Particle.Partl_Toposf
38761>>>>>>>>>>>>>                    End
38761>>>>>>>>>>>>>>
38761>>>>>>>>>>>>>                    //Else Move '' to Particle.Partl_Toposf
38761>>>>>>>>>>>>>                End
38761>>>>>>>>>>>>>>
38761>>>>>>>>>>>>>            End
38761>>>>>>>>>>>>>>
38761>>>>>>>>>>>>>/////////////////////////////////////////////////////////////////////////////
38761>>>>>>>>>>>>>// js 26/08/2002 Erothsh: Pos tha piaso ena parastatiko to opoio kinei
38761>>>>>>>>>>>>>//               axies alla katalhgei na exei geniko synolo 0 (an p.x.
38761>>>>>>>>>>>>>//               ginoun ekptoseis 100%.
38761>>>>>>>>>>>>>//               Apanthsh: To piano edo me ton oro oti den mporei na kopsei
38761>>>>>>>>>>>>>//               timologio m'ena eidos mono to opoio exei ekptosh 100%, opote
38761>>>>>>>>>>>>>//               ef'oson tha yparxoun pano apo ena eidos, to eidos me thn
38761>>>>>>>>>>>>>//               ekptosh prepei na kataxorithei san 2o kai meta.POTE proto
38761>>>>>>>>>>>>>//               giati etsi tha exei 0 to synolo tou parastatikou kai tha
38761>>>>>>>>>>>>>//               varesei to validation.
38761>>>>>>>>>>>>>
38761>>>>>>>>>>>>>// Rem giati sthn fash metasxhmatismou apo DAP se TIM den yparxoun times sto DAP
38761>>>>>>>>>>>>>// opote kai to TIM pou paragetai den exei times (Eno leme pos TIM xoris times den ginetai
38761>>>>>>>>>>>>>// Bebaia edo mporoume na elegxoume epipleon an to paragomeno erxetai apo metasxhmatismo
38761>>>>>>>>>>>>>// opote kai tha to afhname. NA TO DOUME.
38761>>>>>>>>>>>>>//            Else If ((Sysfile.Mhdeniko_Partl=0) And (Ptyppar.Ti_Typonei_Pms<>'1') And ;
38761>>>>>>>>>>>>>//                     (Particle.Partl_Payam=0)   And (Particle.Partl_NoOfLines>0)) ;
38761>>>>>>>>>>>>>//                    Move 6051 to iReturnVal
38761>>>>>>>>>>>>>
38761>>>>>>>>>>>>>/////////////////////////////////////////////////////////////////////////////
38761>>>>>>>>>>>>>
38761>>>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
38764>>>>>>>>>>>>>        End
38764>>>>>>>>>>>>>>
38764>>>>>>>>>>>>>        Function_Return iReturnVal
38765>>>>>>>>>>>>>    End_Function   // Validate_Save
38766>>>>>>>>>>>>>
38766>>>>>>>>>>>>>
38766>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
38767>>>>>>>>>>>>>        Integer iReturnVal
38768>>>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
38770>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
38772>>>>>>>>>>>>>            If (Particle.Partl_Timol = 1) Move 1009 to iReturnVal
38775>>>>>>>>>>>>>            Else If ( (Sysfile.Hm_Kleisimatos<>'') And ;                      (Particle.Partl_Hmnia<=Sysfile.Hm_Kleisimatos) ) ;                     Move 1110 to iReturnVal
38779>>>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
38782>>>>>>>>>>>>>        End
38782>>>>>>>>>>>>>>
38782>>>>>>>>>>>>>        Function_Return iReturnVal
38783>>>>>>>>>>>>>    End_Function   // Validate_Delete
38784>>>>>>>>>>>>>
38784>>>>>>>>>>>>>
38784>>>>>>>>>>>>>    // Define_Fields:
38784>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
38784>>>>>>>>>>>>>
38784>>>>>>>>>>>>>    Procedure Define_Fields
38785>>>>>>>>>>>>>        Forward Send Define_Fields
38787>>>>>>>>>>>>>        //DDB-Generated-Code-Location
38787>>>>>>>>>>>>>        //DDB-DefineFieldStart
38787>>>>>>>>>>>>>
38787>>>>>>>>>>>>>        Set Main_File            To Particle.File_Number
38788>>>>>>>>>>>>>
38788>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
38789>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
38790>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38791>>>>>>>>>>>>>
38791>>>>>>>>>>>>>        // Child (Client) file structure................
38791>>>>>>>>>>>>>        Send Add_Client_File  Pmoves.File_Number
38792>>>>>>>>>>>>>        Send Add_Client_File  Tparticl.File_Number
38793>>>>>>>>>>>>>        Send Add_Client_File  Partlfpa.File_Number
38794>>>>>>>>>>>>>        Send Add_Client_File  Pmovesl.File_Number
38795>>>>>>>>>>>>>        Send Add_Client_File  Psxetika.File_Number
38796>>>>>>>>>>>>>
38796>>>>>>>>>>>>>        // Parent (Server) file structure...............
38796>>>>>>>>>>>>>        Send Add_Server_File  Clients.File_Number
38797>>>>>>>>>>>>>        Send Add_Server_File  Ptyppar.File_Number
38798>>>>>>>>>>>>>        Send Add_Server_File  Nomisma.File_Number
38799>>>>>>>>>>>>>
38799>>>>>>>>>>>>>        // External (System) file structure.............
38799>>>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
38800>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
38801>>>>>>>>>>>>>        Send Add_System_File  Pseira.File_Number  DD_LOCK_ON_ALL
38802>>>>>>>>>>>>>        Send Add_System_File  Cn.File_Number  DD_LOCK_ON_ALL
38803>>>>>>>>>>>>>        Send Add_System_File  Partlfpa.File_Number  DD_LOCK_ON_ALL
38804>>>>>>>>>>>>>        Send Add_System_File  Clorder.File_Number  DD_LOCK_ON_ALL
38805>>>>>>>>>>>>>        Send Add_System_File  Clorderd.File_Number  DD_LOCK_ON_ALL
38806>>>>>>>>>>>>>        Send Add_System_File  Ypoprosf.File_Number  DD_LOCK_ON_ALL
38807>>>>>>>>>>>>>        Send Add_System_File  Psxetika.File_Number  DD_LOCK_ON_ALL
38808>>>>>>>>>>>>>        Send Add_System_File  Pmoves.File_Number  DD_LOCK_ON_ALL
38809>>>>>>>>>>>>>
38809>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Particle_Rec0  To Particle.Partl_Rec0
38812>>>>>>>>>>>>>
38812>>>>>>>>>>>>>        // Field-based properties.......................
38812>>>>>>>>>>>>>
38812>>>>>>>>>>>>>        // Particle.Company_Code
38812>>>>>>>>>>>>>
38812>>>>>>>>>>>>>        // Particle.Branch_Code
38812>>>>>>>>>>>>>
38812>>>>>>>>>>>>>        // Particle.Year_Year
38812>>>>>>>>>>>>>
38812>>>>>>>>>>>>>        // Particle.Ctypkin_Code
38812>>>>>>>>>>>>>
38812>>>>>>>>>>>>>        // Particle.Wtypkin_Code
38812>>>>>>>>>>>>>
38812>>>>>>>>>>>>>        // Particle.Ptyppar_Code
38812>>>>>>>>>>>>>
38812>>>>>>>>>>>>>        // Particle.Pseira_Seira
38812>>>>>>>>>>>>>
38812>>>>>>>>>>>>>        // Particle.Custprom_Code
38812>>>>>>>>>>>>>
38812>>>>>>>>>>>>>        // Particle.Client_Id
38812>>>>>>>>>>>>>
38812>>>>>>>>>>>>>        // Particle.Partl_No
38812>>>>>>>>>>>>>
38812>>>>>>>>>>>>>        // Particle.Cn_Recr
38812>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Cn_Recr To (sl041(Self))
38813>>>>>>>>>>>>>
38813>>>>>>>>>>>>>        // Particle.Pseira_Recr
38813>>>>>>>>>>>>>
38813>>>>>>>>>>>>>        // Particle.Partl_Hmnia
38813>>>>>>>>>>>>>        Set Field_Entry_msg        Field Particle.Partl_Hmnia To Shmera
38814>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Partl_Hmnia To (sl014(Self))
38815>>>>>>>>>>>>>
38815>>>>>>>>>>>>>        // Particle.Partl_Rec0
38815>>>>>>>>>>>>>        Set Field_Options          Field Particle.Partl_Rec0 To DD_AUTOFIND
38816>>>>>>>>>>>>>
38816>>>>>>>>>>>>>        // Particle.Partl_Lastno
38816>>>>>>>>>>>>>
38816>>>>>>>>>>>>>        // Particle.Partl_Tdiakin
38816>>>>>>>>>>>>>
38816>>>>>>>>>>>>>        // Particle.Partl_Car
38816>>>>>>>>>>>>>
38816>>>>>>>>>>>>>        // Particle.Partl_Reldoc
38816>>>>>>>>>>>>>
38816>>>>>>>>>>>>>        // Particle.Partl_Toposf
38816>>>>>>>>>>>>>
38816>>>>>>>>>>>>>        // Particle.Partl_Toposa
38816>>>>>>>>>>>>>
38816>>>>>>>>>>>>>        // Particle.Partl_Troposa
38816>>>>>>>>>>>>>
38816>>>>>>>>>>>>>        // Particle.Partl_Tof
38816>>>>>>>>>>>>>
38816>>>>>>>>>>>>>        // Particle.Partl_Disctof
38816>>>>>>>>>>>>>
38816>>>>>>>>>>>>>        // Particle.Partl_Disccl
38816>>>>>>>>>>>>>
38816>>>>>>>>>>>>>        // Particle.Partl_Autodisc
38816>>>>>>>>>>>>>
38816>>>>>>>>>>>>>        // Particle.Partl_Time
38816>>>>>>>>>>>>>
38816>>>>>>>>>>>>>        // Particle.Partl_Totambd
38816>>>>>>>>>>>>>
38816>>>>>>>>>>>>>        // Particle.Partl_Amdiscpms
38816>>>>>>>>>>>>>
38816>>>>>>>>>>>>>        // Particle.Partl_Totdiscpc
38816>>>>>>>>>>>>>
38816>>>>>>>>>>>>>        // Particle.Partl_Discam
38816>>>>>>>>>>>>>
38816>>>>>>>>>>>>>        // Particle.Partl_Totamad
38816>>>>>>>>>>>>>
38816>>>>>>>>>>>>>        // Particle.Partl_Vatpct
38816>>>>>>>>>>>>>
38816>>>>>>>>>>>>>        // Particle.Partl_Vatam
38816>>>>>>>>>>>>>
38816>>>>>>>>>>>>>        // Particle.Partl_Genam
38816>>>>>>>>>>>>>
38816>>>>>>>>>>>>>        // Particle.Partl_Extra
38816>>>>>>>>>>>>>
38816>>>>>>>>>>>>>        // Particle.Partl_Extravatp
38816>>>>>>>>>>>>>
38816>>>>>>>>>>>>>        // Particle.Partl_Extravat
38816>>>>>>>>>>>>>
38816>>>>>>>>>>>>>        // Particle.Partl_Payam
38816>>>>>>>>>>>>>
38816>>>>>>>>>>>>>        // Particle.Partl_Befypol
38816>>>>>>>>>>>>>
38816>>>>>>>>>>>>>        // Particle.Partl_Currypol
38816>>>>>>>>>>>>>
38816>>>>>>>>>>>>>        // Particle.Partl_Tottem
38816>>>>>>>>>>>>>
38816>>>>>>>>>>>>>        // Particle.Partl_Det
38816>>>>>>>>>>>>>
38816>>>>>>>>>>>>>        // Particle.Partl_Recr
38816>>>>>>>>>>>>>        Set Field_Options          Field Particle.Partl_Recr To DD_AUTOFIND
38817>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Partl_Recr To (sl014(Self))
38818>>>>>>>>>>>>>
38818>>>>>>>>>>>>>        // Particle.Cn_Code
38818>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Cn_Code To (sl041(Self))
38819>>>>>>>>>>>>>
38819>>>>>>>>>>>>>        // Particle.Client_Recr
38819>>>>>>>>>>>>>
38819>>>>>>>>>>>>>        // Particle.Ptyppar_Recr
38819>>>>>>>>>>>>>
38819>>>>>>>>>>>>>        // Particle.Partl_Ekleise
38819>>>>>>>>>>>>>
38819>>>>>>>>>>>>>        // Particle.Partl_Ekl_Recr
38819>>>>>>>>>>>>>
38819>>>>>>>>>>>>>        // Particle.Partl_Ektyposh
38819>>>>>>>>>>>>>
38819>>>>>>>>>>>>>        // Particle.Partl_Akyrosh
38819>>>>>>>>>>>>>
38819>>>>>>>>>>>>>        // Particle.Partl_Akyr_Recr
38819>>>>>>>>>>>>>
38819>>>>>>>>>>>>>        // Particle.Partl_Nooflines
38819>>>>>>>>>>>>>
38819>>>>>>>>>>>>>        // Particle.Cmoves_Recr
38819>>>>>>>>>>>>>
38819>>>>>>>>>>>>>        // Particle.Nomisma_Code
38819>>>>>>>>>>>>>
38819>>>>>>>>>>>>>        // Particle.Isotimia
38819>>>>>>>>>>>>>
38819>>>>>>>>>>>>>        // Particle.Wcmoves_Recr
38819>>>>>>>>>>>>>
38819>>>>>>>>>>>>>        // Particle.Partl_Module
38819>>>>>>>>>>>>>
38819>>>>>>>>>>>>>        // Particle.Partl_Timol
38819>>>>>>>>>>>>>        Set Field_Mask             Field Particle.Partl_Timol To "#"
38820>>>>>>>>>>>>>        Set Field_Mask_Type        Field Particle.Partl_Timol To MASK_NUMERIC_WINDOW
38821>>>>>>>>>>>>>
38821>>>>>>>>>>>>>        // Particle.Partl_Selected
38821>>>>>>>>>>>>>
38821>>>>>>>>>>>>>        // Particle.Partl_Tim_Recr
38821>>>>>>>>>>>>>
38821>>>>>>>>>>>>>        // Particle.Partl_Vsn
38821>>>>>>>>>>>>>
38821>>>>>>>>>>>>>        // Particle.Sls_Id
38821>>>>>>>>>>>>>
38821>>>>>>>>>>>>>        // Particle.Presp_Id
38821>>>>>>>>>>>>>
38821>>>>>>>>>>>>>        // Particle.Cnt_Id
38821>>>>>>>>>>>>>
38821>>>>>>>>>>>>>        // Particle.Topos_Apostolhs
38821>>>>>>>>>>>>>
38821>>>>>>>>>>>>>        // Particle.Tropos_Diakin
38821>>>>>>>>>>>>>        Set Field_Class_Name       Field Particle.Tropos_Diakin To "dbComboFormsub"
38822>>>>>>>>>>>>>        Set Field_Value_Table      Field Particle.Tropos_Diakin To (Particle_Tropos_Diakin_VT(Self))
38823>>>>>>>>>>>>>
38823>>>>>>>>>>>>>        // Particle.Ora_Apostolhs
38823>>>>>>>>>>>>>        Set Field_Entry_msg        Field Particle.Ora_Apostolhs To Shmera_Ora_String
38824>>>>>>>>>>>>>        Set Field_Mask             Field Particle.Ora_Apostolhs To "##:##"
38825>>>>>>>>>>>>>
38825>>>>>>>>>>>>>        // Particle.Skopos_Diakin
38825>>>>>>>>>>>>>        Set Field_Class_Name       Field Particle.Skopos_Diakin To "dbComboFormsub"
38826>>>>>>>>>>>>>        Set Field_Value_Table      Field Particle.Skopos_Diakin To (Particle_Skopos_Diakin_VT(Self))
38827>>>>>>>>>>>>>
38827>>>>>>>>>>>>>        // Particle.Tropos_Plhromhs
38827>>>>>>>>>>>>>        Set Field_Value_Table      Field Particle.Tropos_Plhromhs To (Particle_Tropos_Plhromhs_VT(Self))
38828>>>>>>>>>>>>>
38828>>>>>>>>>>>>>        // Particle.Odhgos_Code
38828>>>>>>>>>>>>>
38828>>>>>>>>>>>>>        // Particle.Odhgos_Name
38828>>>>>>>>>>>>>
38828>>>>>>>>>>>>>        // Particle.Oxhma_Code
38828>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Oxhma_Code To (sl054(Self))
38829>>>>>>>>>>>>>
38829>>>>>>>>>>>>>        // Particle.Oxhma_Descr
38829>>>>>>>>>>>>>
38829>>>>>>>>>>>>>        // Particle.Antlia_Code
38829>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Antlia_Code To (sl053(Self))
38830>>>>>>>>>>>>>
38830>>>>>>>>>>>>>        // Particle.Antlia_Descr
38830>>>>>>>>>>>>>
38830>>>>>>>>>>>>>        // Particle.Partl_Euro
38830>>>>>>>>>>>>>
38830>>>>>>>>>>>>>        // Particle.Disc_Vat_Pct
38830>>>>>>>>>>>>>
38830>>>>>>>>>>>>>        // Particle.Disc_Vat_Poso
38830>>>>>>>>>>>>>
38830>>>>>>>>>>>>>        // Particle.Total_Vat_Poso
38830>>>>>>>>>>>>>
38830>>>>>>>>>>>>>        // Particle.Exei_Sxetika
38830>>>>>>>>>>>>>
38830>>>>>>>>>>>>>        // Particle.Aitiol
38830>>>>>>>>>>>>>
38830>>>>>>>>>>>>>        // Particle.Max_Days_Date
38830>>>>>>>>>>>>>
38830>>>>>>>>>>>>>        // Particle.Timol_Qty
38830>>>>>>>>>>>>>
38830>>>>>>>>>>>>>        // Particle.Timol_Ypol
38830>>>>>>>>>>>>>
38830>>>>>>>>>>>>>        // Particle.Epilogh_Ekkrem
38830>>>>>>>>>>>>>
38830>>>>>>>>>>>>>        // Particle.No_Print_Module
38830>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Particle.No_Print_Module To "Œ˜ £ž¤ «¬§é¤œ«˜  (˜§¦ ˜¢¢¦ ¡ç¡¢à£˜ §.®.§˜¨˜š ©œ ¨¦£)"
38830>>>>>>>>>>>>>
38830>>>>>>>>>>>>>        // Particle.Prohg_Ypol
38830>>>>>>>>>>>>>
38830>>>>>>>>>>>>>        // Particle.Trex_Ypol
38830>>>>>>>>>>>>>
38830>>>>>>>>>>>>>        // Particle.Parakrat_Pct
38830>>>>>>>>>>>>>
38830>>>>>>>>>>>>>        // Particle.Parakrat_Poso
38830>>>>>>>>>>>>>
38830>>>>>>>>>>>>>        // Particle.Cms_Parak_Recr
38830>>>>>>>>>>>>>
38830>>>>>>>>>>>>>        // Particle.Enhm_Logik
38830>>>>>>>>>>>>>
38830>>>>>>>>>>>>>        // Particle.Se_Logik
38830>>>>>>>>>>>>>
38830>>>>>>>>>>>>>        // Particle.Akyro
38830>>>>>>>>>>>>>
38830>>>>>>>>>>>>>        // Particle.Zone_Id
38830>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Zone_Id To (sl064(Self))
38831>>>>>>>>>>>>>
38831>>>>>>>>>>>>>        //DDB-DefineFieldEnd
38831>>>>>>>>>>>>>    End_Procedure    // Define_Fields
38832>>>>>>>>>>>>>
38832>>>>>>>>>>>>>    // Field_Defaults:
38832>>>>>>>>>>>>>    // This procedure is used to establish default field values.
38832>>>>>>>>>>>>>
38832>>>>>>>>>>>>>    Procedure Field_Defaults
38833>>>>>>>>>>>>>        Forward Send Field_Defaults
38835>>>>>>>>>>>>>        //DDB-Generated-Code-Location
38835>>>>>>>>>>>>>        //DDB-FieldDefaultStart
38835>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
38835>>>>>>>>>>>>>        Set Field_Changed_Value Field Particle.Nomisma_Code to SyscurXr.C_Code0
38836>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
38837>>>>>>>>>>>>>
38837>>>>>>>>>>>>>End_Class    // Particle_DataDictionary
38838>>>>>>>>>>>>>//DDB-Selection-pkg-Start
38838>>>>>>>>>>>>>
38838>>>>>>>>>>>>>Use sl041.SL         // sl041
38838>>>>>>>>>>>>>Use sl014.SL         // sl014
INCLUDING FILE: SL014.SL
38838>>>>>>>>>>>>>>>//AB/ Project sl014:Particle Lookup
38838>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
38838>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl014:Particle Lookup"
38838>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl014.SL"
38838>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
38838>>>>>>>>>>>>>>>
38838>>>>>>>>>>>>>>>// Project Object Structure
38838>>>>>>>>>>>>>>>//   sl014 is a dbModalPanelSub
38838>>>>>>>>>>>>>>>//     Ctypkin_DD is a DataDictionary
38838>>>>>>>>>>>>>>>//     Wtypkin_DD is a DataDictionary
38838>>>>>>>>>>>>>>>//     Ptyppar_DD is a DataDictionary
38838>>>>>>>>>>>>>>>//     Clients_DD is a DataDictionary
38838>>>>>>>>>>>>>>>//     Nomisma_DD is a DataDictionary
38838>>>>>>>>>>>>>>>//     Particle_DD is a DataDictionary
38838>>>>>>>>>>>>>>>//     oSelList is a dbListSub
38838>>>>>>>>>>>>>>>//     cSyDateForm1 is a cSyDateForm
38838>>>>>>>>>>>>>>>//     FormSub1 is a FormSub
38838>>>>>>>>>>>>>>>//     FormSub3 is a FormSub
38838>>>>>>>>>>>>>>>//     FormSub2 is a FormSub
38838>>>>>>>>>>>>>>>//     FormSub4 is a FormSub
38838>>>>>>>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
38838>>>>>>>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
38838>>>>>>>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
38838>>>>>>>>>>>>>>>//     ButtonSub1 is a ButtonSub
38838>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
38838>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
38838>>>>>>>>>>>>>>>
38838>>>>>>>>>>>>>>>// Register all objects
38838>>>>>>>>>>>>>>>Register_Object ButtonSub1
38838>>>>>>>>>>>>>>>Register_Object Clients_DD
38838>>>>>>>>>>>>>>>Register_Object Ctypkin_DD
38838>>>>>>>>>>>>>>>Register_Object cSyDateForm1
38838>>>>>>>>>>>>>>>Register_Object FormSub1
38838>>>>>>>>>>>>>>>Register_Object FormSub2
38838>>>>>>>>>>>>>>>Register_Object FormSub3
38838>>>>>>>>>>>>>>>Register_Object FormSub4
38838>>>>>>>>>>>>>>>Register_Object Nomisma_DD
38838>>>>>>>>>>>>>>>Register_Object oOK_bn
38838>>>>>>>>>>>>>>>Register_Object oSearch_bn
38838>>>>>>>>>>>>>>>Register_Object oSelList
38838>>>>>>>>>>>>>>>Register_Object Particle_DD
38838>>>>>>>>>>>>>>>Register_Object Ptyppar_DD
38838>>>>>>>>>>>>>>>Register_Object sl014
38838>>>>>>>>>>>>>>>Register_Object TextBoxSub1
38838>>>>>>>>>>>>>>>Register_Object TextBoxSub2
38838>>>>>>>>>>>>>>>Register_Object TextBoxSub3
38838>>>>>>>>>>>>>>>Register_Object Wtypkin_DD
38838>>>>>>>>>>>>>>>
38838>>>>>>>>>>>>>>>
38838>>>>>>>>>>>>>>>
38838>>>>>>>>>>>>>>>//AB-StoreTopStart
38838>>>>>>>>>>>>>>>    
38838>>>>>>>>>>>>>>>Open PtypparL
38840>>>>>>>>>>>>>>>
38840>>>>>>>>>>>>>>>Use sl100.sl
38840>>>>>>>>>>>>>>>Use sl012.sl
38840>>>>>>>>>>>>>>>
38840>>>>>>>>>>>>>>>//AB-StoreTopEnd
38840>>>>>>>>>>>>>>>
38840>>>>>>>>>>>>>>>//AB-IgnoreStart
38840>>>>>>>>>>>>>>>
38840>>>>>>>>>>>>>>>Use DFAllEnt.pkg
38840>>>>>>>>>>>>>>>Use dbList.Sub
38840>>>>>>>>>>>>>>>Use cSyDateForm.Pkg
INCLUDING FILE: CSYDATEFORM.PKG
38840>>>>>>>>>>>>>>>>>Use cSyDateIntelliMix.pkg
INCLUDING FILE: CSYDATEINTELLIMIX.PKG
38840>>>>>>>>>>>>>>>>>>>Use Calendar.Sl // Needed for date prompt.
38840>>>>>>>>>>>>>>>>>>>Use Dates.Utl
38840>>>>>>>>>>>>>>>>>>>
38840>>>>>>>>>>>>>>>>>>>   Define cStatusHelp       for "F4 = Calendar. T = Today, B = Begin of month, E = End of month."
38840>>>>>>>>>>>>>>>>>>>   Define cDateToday        for "T"
38840>>>>>>>>>>>>>>>>>>>   Define cDateBeginOfMonth for "B"
38840>>>>>>>>>>>>>>>>>>>   Define cDateEndOfMonth   for "E"
38840>>>>>>>>>>>>>>>>>>>
38840>>>>>>>>>>>>>>>>>>>Class cSyIntelliSense_Date_Mixin is a Message
38841>>>>>>>>>>>>>>>>>>>   Procedure DoDefineIntelliSenseDateMixin
38842>>>>>>>>>>>>>>>>>>>      Property Date    pdOriginal_Value          Public 0
38843>>>>>>>>>>>>>>>>>>>      Property Integer pbIntelliSense_Date_State Public dfTrue
38844>>>>>>>>>>>>>>>>>>>      Property Integer pbEnableCalendarPrompt    Public dfTrue
38845>>>>>>>>>>>>>>>>>>>   End_Procedure // DoDefineIntelliSenseDateMixin
38846>>>>>>>>>>>>>>>>>>>
38846>>>>>>>>>>>>>>>>>>>   // **WvA: Augmented to store the current date-value before any changes are made
38846>>>>>>>>>>>>>>>>>>>   Procedure Entering returns Integer
38847>>>>>>>>>>>>>>>>>>>      Integer iRetVal
38848>>>>>>>>>>>>>>>>>>>      Date    dOriginal
38848>>>>>>>>>>>>>>>>>>>      Forward Get Msg_Entering to iRetVal
38850>>>>>>>>>>>>>>>>>>>      If (iRetVal = 0) Begin
38852>>>>>>>>>>>>>>>>>>>         Send DoStoreOriginalDate
38853>>>>>>>>>>>>>>>>>>>      End
38853>>>>>>>>>>>>>>>>>>>>
38853>>>>>>>>>>>>>>>>>>>      Procedure_Return iRetVal
38854>>>>>>>>>>>>>>>>>>>   End_Procedure // Entering
38855>>>>>>>>>>>>>>>>>>>
38855>>>>>>>>>>>>>>>>>>>   //**WvA: This procedure is augmented to see if the user entered a 1 or 2 digit
38855>>>>>>>>>>>>>>>>>>>   //       value with the intention to only change the day-part of the current date.
38855>>>>>>>>>>>>>>>>>>>   Procedure Next
38856>>>>>>>>>>>>>>>>>>>      Send DoIntelliSenseDate
38857>>>>>>>>>>>>>>>>>>>      Forward Send Next
38859>>>>>>>>>>>>>>>>>>>   End_Procedure // Next
38860>>>>>>>>>>>>>>>>>>>
38860>>>>>>>>>>>>>>>>>>>   // **WvA: Store the current date-value before any changes are made
38860>>>>>>>>>>>>>>>>>>>   Procedure DoStoreOriginalDate
38861>>>>>>>>>>>>>>>>>>>      Date    dOriginal
38862>>>>>>>>>>>>>>>>>>>      //If (pbIntelliSense_Date_State(Self)) Begin
38862>>>>>>>>>>>>>>>>>>>         Get Value Item 0 to dOriginal
38863>>>>>>>>>>>>>>>>>>>         Set pdOriginal_Value to dOriginal
38864>>>>>>>>>>>>>>>>>>>      //End
38864>>>>>>>>>>>>>>>>>>>   End_Procedure // DoStoreOriginalDate
38865>>>>>>>>>>>>>>>>>>>
38865>>>>>>>>>>>>>>>>>>>   Procedure DoIntelliSenseDate
38866>>>>>>>>>>>>>>>>>>>      Integer iCurrent iStored iDaysOffSet iSep iDate_Format bChanged iYear
38867>>>>>>>>>>>>>>>>>>>      Date    dCurrent dOriginal
38867>>>>>>>>>>>>>>>>>>>      String  sStored  sCurrent sSep sMask
38867>>>>>>>>>>>>>>>>>>>
38867>>>>>>>>>>>>>>>>>>>      Get Item_Changed_State Item 0 to bChanged
38868>>>>>>>>>>>>>>>>>>>      Get pdOriginal_Value to dOriginal
38869>>>>>>>>>>>>>>>>>>>      If (pbIntelliSense_Date_State(Self) And (bChanged)) Begin
38871>>>>>>>>>>>>>>>>>>>         If (dOriginal Eq 0) Sysdate4 dOriginal
38874>>>>>>>>>>>>>>>>>>>
38874>>>>>>>>>>>>>>>>>>>         // We need the masked value, because the normal value is corrected by the runtime for
38874>>>>>>>>>>>>>>>>>>>         // USA dates.
38874>>>>>>>>>>>>>>>>>>>         Get Masked_Value Item 0 to sCurrent // getting a 2 digit entered date to a datavariable results in an error.
38875>>>>>>>>>>>>>>>>>>>         Move (Replaces(" ",sCurrent,"")) to sCurrent
38876>>>>>>>>>>>>>>>>>>>         Get_Attribute DF_DATE_SEPARATOR to iSep
38879>>>>>>>>>>>>>>>>>>>         Move (Character(iSep)) to sSep
38880>>>>>>>>>>>>>>>>>>>
38880>>>>>>>>>>>>>>>>>>>         // Although the sep value is "/" in the European date format, the mask seperator is "-".
38880>>>>>>>>>>>>>>>>>>>         Move (Replaces("-",sCurrent,sSep)) to sCurrent
38881>>>>>>>>>>>>>>>>>>>         Move (sSep+sSep) to sMask
38882>>>>>>>>>>>>>>>>>>>
38882>>>>>>>>>>>>>>>>>>>         // Now check if the user just entered a day or a day and a month.
38882>>>>>>>>>>>>>>>>>>>         // Something very special is going on here. We are interpreting a string, so the format
38882>>>>>>>>>>>>>>>>>>>         // will always be the same, even for USA or Military dates. "99//" where 9 can be any number
38882>>>>>>>>>>>>>>>>>>>         //If ( (length(sCurrent) > 2) And (Right(sCurrent,2) = sMask)  ) Begin
38882>>>>>>>>>>>>>>>>>>>         If ((length(sCurrent) <= 4) And (Right(sCurrent,2) = sMask)) Begin
38884>>>>>>>>>>>>>>>>>>>            Move (replace(sMask,sCurrent,"")) to sCurrent
38885>>>>>>>>>>>>>>>>>>>            Move sCurrent to iCurrent
38886>>>>>>>>>>>>>>>>>>>            If ((iCurrent >= 1) And (iCurrent <= 31)) Begin
38888>>>>>>>>>>>>>>>>>>>               Get_Attribute DF_DATE_FORMAT to iDate_Format
38891>>>>>>>>>>>>>>>>>>>               If (iDate_Format = DF_DATE_USA) Begin
38893>>>>>>>>>>>>>>>>>>>                  Move (Mid( String(dOriginal),2,4)) to iDaysOffSet
38894>>>>>>>>>>>>>>>>>>>               End
38894>>>>>>>>>>>>>>>>>>>>
38894>>>>>>>>>>>>>>>>>>>               Else If (iDate_Format = DF_DATE_EUROPEAN) Begin
38897>>>>>>>>>>>>>>>>>>>                  Move (Left( String(dOriginal),2 )) to iDaysOffSet
38898>>>>>>>>>>>>>>>>>>>               End
38898>>>>>>>>>>>>>>>>>>>>
38898>>>>>>>>>>>>>>>>>>>               Else If (iDate_Format = DF_DATE_MILITARY) Begin
38901>>>>>>>>>>>>>>>>>>>                  Move (Right( String(dOriginal),2 )) to iDaysOffSet
38902>>>>>>>>>>>>>>>>>>>               End
38902>>>>>>>>>>>>>>>>>>>>
38902>>>>>>>>>>>>>>>>>>>               Set Value Item 0 to (Date(dOriginal - iDaysOffSet + iCurrent))
38903>>>>>>>>>>>>>>>>>>>            End // Let the runtime handle the error if value not in the range 1..31
38903>>>>>>>>>>>>>>>>>>>>
38903>>>>>>>>>>>>>>>>>>>         End
38903>>>>>>>>>>>>>>>>>>>>
38903>>>>>>>>>>>>>>>>>>>         Else If ((length(sCurrent) > 4) And (Right(sCurrent,1) = sSep)) Begin
38906>>>>>>>>>>>>>>>>>>>            Get_Attribute DF_DATE_FORMAT to iDate_Format
38909>>>>>>>>>>>>>>>>>>>            If ((iDate_Format = DF_DATE_USA) Or (iDate_Format = DF_DATE_EUROPEAN)) Begin
38911>>>>>>>>>>>>>>>>>>>               Move (Right(dOriginal,4)) to iYear
38912>>>>>>>>>>>>>>>>>>>            End
38912>>>>>>>>>>>>>>>>>>>>
38912>>>>>>>>>>>>>>>>>>>            Else If (iDate_Format = DF_DATE_MILITARY) Begin
38915>>>>>>>>>>>>>>>>>>>               Move (Left(dOriginal,4))  to iYear
38916>>>>>>>>>>>>>>>>>>>            End
38916>>>>>>>>>>>>>>>>>>>>
38916>>>>>>>>>>>>>>>>>>>            Set Value Item 0 to (Date(sCurrent + String(iYear)))
38917>>>>>>>>>>>>>>>>>>>         End
38917>>>>>>>>>>>>>>>>>>>>
38917>>>>>>>>>>>>>>>>>>>      End
38917>>>>>>>>>>>>>>>>>>>>
38917>>>>>>>>>>>>>>>>>>>   End_Procedure // DoIntelliSenseDate
38918>>>>>>>>>>>>>>>>>>>
38918>>>>>>>>>>>>>>>>>>>   Procedure Key Integer iKey Returns Integer
38919>>>>>>>>>>>>>>>>>>>      Date dToday dTemp
38920>>>>>>>>>>>>>>>>>>>      Sysdate4 dToday
38921>>>>>>>>>>>>>>>>>>>
38921>>>>>>>>>>>>>>>>>>>      If ((Character(iKey) EQ cDateToday) OR (Character(iKey) EQ Lowercase(cDateToday))) Begin
38923>>>>>>>>>>>>>>>>>>>         Set Value to dToday
38924>>>>>>>>>>>>>>>>>>>      End
38924>>>>>>>>>>>>>>>>>>>>
38924>>>>>>>>>>>>>>>>>>>      Else If ((Character(iKey) EQ cDateBeginOfMonth) OR (Character(iKey) EQ Lowercase(cDateBeginOfMonth))) Begin
38927>>>>>>>>>>>>>>>>>>>         Get FirstDayInMonth dToday to dTemp
38928>>>>>>>>>>>>>>>>>>>         Set Value to dTemp
38929>>>>>>>>>>>>>>>>>>>      End
38929>>>>>>>>>>>>>>>>>>>>
38929>>>>>>>>>>>>>>>>>>>      Else If ((Character(iKey) EQ cDateEndOfMonth) OR (Character(iKey) EQ Lowercase(cDateEndOfMonth))) Begin
38932>>>>>>>>>>>>>>>>>>>         Get LastDayInMonth dToday to dTemp
38933>>>>>>>>>>>>>>>>>>>         Set Value to dTemp
38934>>>>>>>>>>>>>>>>>>>      End
38934>>>>>>>>>>>>>>>>>>>>
38934>>>>>>>>>>>>>>>>>>>      Else Forward Send Key iKey
38937>>>>>>>>>>>>>>>>>>>   End_procedure
38938>>>>>>>>>>>>>>>>>>>
38938>>>>>>>>>>>>>>>>>>>End_Class // cSyIntelliSense_Date_Mixin
38939>>>>>>>>>>>>>>>>>
38939>>>>>>>>>>>>>>>>>Class cSyDateForm Is A FormSub
38940>>>>>>>>>>>>>>>>>   Procedure Construct_Object
38941>>>>>>>>>>>>>>>>>      Forward Send Construct_Object
38943>>>>>>>>>>>>>>>>>
38943>>>>>>>>>>>>>>>>>      Set Prompt_Button_Mode   to PB_PromptOn
38944>>>>>>>>>>>>>>>>>      Set Form_Datatype Item 0 to Mask_Date_Window
38945>>>>>>>>>>>>>>>>>
38945>>>>>>>>>>>>>>>>>      Send DoDefineIntelliSenseDateMixin
38946>>>>>>>>>>>>>>>>>
38946>>>>>>>>>>>>>>>>>      On_Key kPrompt Send Prompt
38947>>>>>>>>>>>>>>>>>
38947>>>>>>>>>>>>>>>>>      Set Prompt_Object to (oCalendar(Self))
38948>>>>>>>>>>>>>>>>>      Set Status_Help   to cStatusHelp
38949>>>>>>>>>>>>>>>>>
38949>>>>>>>>>>>>>>>>>   End_Procedure // Construct_Object
38950>>>>>>>>>>>>>>>>>
38950>>>>>>>>>>>>>>>>>   Import_Class_Protocol cSyIntelliSense_Date_Mixin
38951>>>>>>>>>>>>>>>>>
38951>>>>>>>>>>>>>>>>>//   Function Form_Datatype Integer iItem Returns Integer
38951>>>>>>>>>>>>>>>>>//      Integer iDatatype
38951>>>>>>>>>>>>>>>>>//
38951>>>>>>>>>>>>>>>>>//      If (iItem = Current) Begin
38951>>>>>>>>>>>>>>>>>//         Get Current_Item to iItem
38951>>>>>>>>>>>>>>>>>//      End
38951>>>>>>>>>>>>>>>>>//
38951>>>>>>>>>>>>>>>>>//      Forward Get Form_Datatype Item iItem to iDataType
38951>>>>>>>>>>>>>>>>>//
38951>>>>>>>>>>>>>>>>>//      Function_Return iDatatype
38951>>>>>>>>>>>>>>>>>//   End_Function // Form_Datatype
38951>>>>>>>>>>>>>>>>>
38951>>>>>>>>>>>>>>>>>End_Class // cSyDateForm
38952>>>>>>>>>>>>>>>Use Form.Sub
38952>>>>>>>>>>>>>>>Use Txtbox.Sub
38952>>>>>>>>>>>>>>>Use Button.Sub
38952>>>>>>>>>>>>>>>
38952>>>>>>>>>>>>>>>
38952>>>>>>>>>>>>>>>Use CTYPKIN.DD
38952>>>>>>>>>>>>>>>Use WTYPKIN.DD
38952>>>>>>>>>>>>>>>Use PTYPPAR.DD
38952>>>>>>>>>>>>>>>Use CLIENTS.DD
38952>>>>>>>>>>>>>>>Use NOMISMA.DD
38952>>>>>>>>>>>>>>>Use PARTICLE.DD
38952>>>>>>>>>>>>>>>
38952>>>>>>>>>>>>>>>//AB-IgnoreEnd
38952>>>>>>>>>>>>>>>
38952>>>>>>>>>>>>>>>Object sl014 is a dbModalPanelSub
38954>>>>>>>>>>>>>>>
38954>>>>>>>>>>>>>>>    //AB-StoreTopStart
38954>>>>>>>>>>>>>>>            
38954>>>>>>>>>>>>>>>    Property String psModule        Public ''
38956>>>>>>>>>>>>>>>    Property String psClient        Public ''
38958>>>>>>>>>>>>>>>    Property String psPtyppar       Public ''
38960>>>>>>>>>>>>>>>    Property String psCtypkin       Public ''
38962>>>>>>>>>>>>>>>    Property String psWtypkin       Public ''
38964>>>>>>>>>>>>>>>    Property String psPtypparRecr   Public ''
38966>>>>>>>>>>>>>>>    Property Date   pdHmnia         Public ''
38968>>>>>>>>>>>>>>>    
38968>>>>>>>>>>>>>>>    //AB-StoreTopEnd
38968>>>>>>>>>>>>>>>
38968>>>>>>>>>>>>>>>    Set Label to "˜¨˜©«˜« ¡á"
38969>>>>>>>>>>>>>>>    Set Size to 282 523
38970>>>>>>>>>>>>>>>    Set Location to 4 3
38971>>>>>>>>>>>>>>>    Set Color to 12363657
38972>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
38973>>>>>>>>>>>>>>>    Set Modal_State to FALSE
38974>>>>>>>>>>>>>>>
38974>>>>>>>>>>>>>>>    //AB-DDOStart
38974>>>>>>>>>>>>>>>
38974>>>>>>>>>>>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
38976>>>>>>>>>>>>>>>    End_Object    // Ctypkin_DD
38977>>>>>>>>>>>>>>>
38977>>>>>>>>>>>>>>>    Object Wtypkin_DD is a Wtypkin_DataDictionary
38979>>>>>>>>>>>>>>>    End_Object    // Wtypkin_DD
38980>>>>>>>>>>>>>>>
38980>>>>>>>>>>>>>>>    Object Ptyppar_DD is a Ptyppar_DataDictionary
38982>>>>>>>>>>>>>>>        Set DDO_Server to (Ctypkin_DD(self))
38983>>>>>>>>>>>>>>>        Set DDO_Server to (Wtypkin_DD(self))
38984>>>>>>>>>>>>>>>    End_Object    // Ptyppar_DD
38985>>>>>>>>>>>>>>>
38985>>>>>>>>>>>>>>>    Object Clients_DD is a Clients_DataDictionary
38987>>>>>>>>>>>>>>>    End_Object    // Clients_DD
38988>>>>>>>>>>>>>>>
38988>>>>>>>>>>>>>>>    Object Nomisma_DD is a Nomisma_DataDictionary
38990>>>>>>>>>>>>>>>    End_Object    // Nomisma_DD
38991>>>>>>>>>>>>>>>
38991>>>>>>>>>>>>>>>    Object Particle_DD is a Particle_DataDictionary
38993>>>>>>>>>>>>>>>        Set DDO_Server to (Clients_DD(self))
38994>>>>>>>>>>>>>>>        Set DDO_Server to (Ptyppar_DD(self))
38995>>>>>>>>>>>>>>>        Set DDO_Server to (Nomisma_DD(self))
38996>>>>>>>>>>>>>>>
38996>>>>>>>>>>>>>>>        //AB-StoreStart
38996>>>>>>>>>>>>>>>                                    
38996>>>>>>>>>>>>>>>        Procedure OnConstrain
38998>>>>>>>>>>>>>>>            String  sPtyppar sWtypkin sCtypkin sClientID sPtypparRecr
38999>>>>>>>>>>>>>>>            Date    dHmnia
38999>>>>>>>>>>>>>>>        
38999>>>>>>>>>>>>>>>            Get psClient        to sClientID
39000>>>>>>>>>>>>>>>            Get psPtyppar       to sPtyppar
39001>>>>>>>>>>>>>>>            Get psPtypparRecr   to sPtypparRecr
39002>>>>>>>>>>>>>>>            Get psCtypkin       to sCtypkin
39003>>>>>>>>>>>>>>>            Get psWtypkin       to sWtypkin
39004>>>>>>>>>>>>>>>            Get Value Of cSyDateForm1 Item 0 to dHmnia
39005>>>>>>>>>>>>>>>        
39005>>>>>>>>>>>>>>>            If (sClientID<>'') Begin
39007>>>>>>>>>>>>>>>                If (sPtypparRecr<>'') Begin
39009>>>>>>>>>>>>>>>                    Set Ordering to 1
39010>>>>>>>>>>>>>>>                    Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
39012>>>>>>>>>>>>>>>                    Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
39014>>>>>>>>>>>>>>>                    Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
39016>>>>>>>>>>>>>>>                    Constrain Particle.CustProm_Code    Eq ''
39018>>>>>>>>>>>>>>>                    Constrain Particle.Client_ID        Eq sClientID
39020>>>>>>>>>>>>>>>                    Constrain Particle.Ctypkin_Code     Eq sCtypkin
39022>>>>>>>>>>>>>>>                    Constrain Particle.Wtypkin_Code     Eq sWtypkin
39024>>>>>>>>>>>>>>>                    Constrain Particle.Ptyppar_Code     Eq sPtyppar
39026>>>>>>>>>>>>>>>                    If (dHmnia<>'') ;                        Constrain Particle.Partl_Hmnia  Eq dHmnia
39030>>>>>>>>>>>>>>>                End
39030>>>>>>>>>>>>>>>>
39030>>>>>>>>>>>>>>>                Else Begin
39031>>>>>>>>>>>>>>>                    Set Ordering to 13
39032>>>>>>>>>>>>>>>                    Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
39034>>>>>>>>>>>>>>>                    Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
39036>>>>>>>>>>>>>>>                    Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
39038>>>>>>>>>>>>>>>                    Constrain Particle.Client_ID        Eq sClientID
39040>>>>>>>>>>>>>>>                    If (dHmnia<>'') ;                        Constrain Particle.Partl_Hmnia  Eq dHmnia
39044>>>>>>>>>>>>>>>                End
39044>>>>>>>>>>>>>>>>
39044>>>>>>>>>>>>>>>            End
39044>>>>>>>>>>>>>>>>
39044>>>>>>>>>>>>>>>            Else If (sPtypparRecr<>'') Begin
39047>>>>>>>>>>>>>>>                Set Ordering to 12
39048>>>>>>>>>>>>>>>                Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
39050>>>>>>>>>>>>>>>                Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
39052>>>>>>>>>>>>>>>                Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
39054>>>>>>>>>>>>>>>                Constrain Particle.Partl_Module     Eq (psModule(Self))
39056>>>>>>>>>>>>>>>                Constrain Particle.Ptyppar_Recr     Eq sPtypparRecr
39058>>>>>>>>>>>>>>>                If (dHmnia<>'') ;                    Constrain Particle.Partl_Hmnia  Eq dHmnia
39062>>>>>>>>>>>>>>>            End
39062>>>>>>>>>>>>>>>>
39062>>>>>>>>>>>>>>>            Else  Begin
39063>>>>>>>>>>>>>>>                Set Ordering to 14
39064>>>>>>>>>>>>>>>                Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
39066>>>>>>>>>>>>>>>                Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
39068>>>>>>>>>>>>>>>                Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
39070>>>>>>>>>>>>>>>                Constrain Particle.Partl_Module     Eq (psModule(Self))
39072>>>>>>>>>>>>>>>                If (dHmnia<>'') ;                    Constrain Particle.Partl_Hmnia  Eq dHmnia
39076>>>>>>>>>>>>>>>            End
39076>>>>>>>>>>>>>>>>
39076>>>>>>>>>>>>>>>        
39076>>>>>>>>>>>>>>>        End_Procedure
39077>>>>>>>>>>>>>>>        
39077>>>>>>>>>>>>>>>        
39077>>>>>>>>>>>>>>>        
39077>>>>>>>>>>>>>>>        
39077>>>>>>>>>>>>>>>        
39077>>>>>>>>>>>>>>>        
39077>>>>>>>>>>>>>>>        
39077>>>>>>>>>>>>>>>        
39077>>>>>>>>>>>>>>>        
39077>>>>>>>>>>>>>>>        
39077>>>>>>>>>>>>>>>        
39077>>>>>>>>>>>>>>>        
39077>>>>>>>>>>>>>>>        
39077>>>>>>>>>>>>>>>        
39077>>>>>>>>>>>>>>>        //AB-StoreEnd
39077>>>>>>>>>>>>>>>
39077>>>>>>>>>>>>>>>    End_Object    // Particle_DD
39078>>>>>>>>>>>>>>>
39078>>>>>>>>>>>>>>>    Set Main_DD to (Particle_DD(self))
39079>>>>>>>>>>>>>>>    Set Server to (Particle_DD(self))
39080>>>>>>>>>>>>>>>
39080>>>>>>>>>>>>>>>    //AB-DDOEnd
39080>>>>>>>>>>>>>>>
39080>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
39082>>>>>>>>>>>>>>>
39082>>>>>>>>>>>>>>>        //AB-StoreTopStart
39082>>>>>>>>>>>>>>>                                                
39082>>>>>>>>>>>>>>>                                                
39082>>>>>>>>>>>>>>>        //AB-StoreTopEnd
39082>>>>>>>>>>>>>>>
39082>>>>>>>>>>>>>>>        Set Main_File to Particle.File_Number
39083>>>>>>>>>>>>>>>        Set Ordering to 14
39084>>>>>>>>>>>>>>>        Set Size to 208 511
39085>>>>>>>>>>>>>>>        Set Location to 6 5
39086>>>>>>>>>>>>>>>        Set Auto_Index_State to FALSE
39087>>>>>>>>>>>>>>>
39087>>>>>>>>>>>>>>>        Begin_Row
39090>>>>>>>>>>>>>>>            Entry_Item Particle.Partl_hmnia
39091>>>>>>>>>>>>>>>            Entry_Item Ptyppar.Ptyppar_descr
39092>>>>>>>>>>>>>>>            Entry_Item Particle.Pseira_seira
39093>>>>>>>>>>>>>>>            Entry_Item Particle.Partl_no
39094>>>>>>>>>>>>>>>            Entry_Item Clients.Client_id
39095>>>>>>>>>>>>>>>            Entry_Item Clients.Client_name
39096>>>>>>>>>>>>>>>            Entry_Item Particle.Partl_ekleise
39097>>>>>>>>>>>>>>>        End_Row
39102>>>>>>>>>>>>>>>
39102>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 60
39103>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "†£œ¨/¤å˜"
39104>>>>>>>>>>>>>>>        
39104>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 117
39105>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "˜¨˜©«˜« ¡æ"
39106>>>>>>>>>>>>>>>        
39106>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 36
39107>>>>>>>>>>>>>>>        Set Header_Label  item 2 to "‘œ ¨á"
39108>>>>>>>>>>>>>>>        
39108>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 60
39109>>>>>>>>>>>>>>>        Set Header_Label  item 3 to "€¨ Ÿ£æª"
39110>>>>>>>>>>>>>>>        
39110>>>>>>>>>>>>>>>        Set Form_Width    item 4 to 57
39111>>>>>>>>>>>>>>>        Set Header_Label  item 4 to "‰à› ¡æª"
39112>>>>>>>>>>>>>>>        
39112>>>>>>>>>>>>>>>        Set Form_Width    item 5 to 159
39113>>>>>>>>>>>>>>>        Set Header_Label  item 5 to "œ¢á«žª / ¨¦£žŸœ¬«ãª"
39114>>>>>>>>>>>>>>>        
39114>>>>>>>>>>>>>>>        Set Form_Width    item 6 to 16
39115>>>>>>>>>>>>>>>        Set Header_Label  item 6 to "K"
39116>>>>>>>>>>>>>>>        Set Column_Checkbox_State  item 6 to True
39117>>>>>>>>>>>>>>>        
39117>>>>>>>>>>>>>>>
39117>>>>>>>>>>>>>>>        //AB-StoreStart
39117>>>>>>>>>>>>>>>                                                
39117>>>>>>>>>>>>>>>        Procedure Activate
39119>>>>>>>>>>>>>>>            Send Keyaction to ButtonSub1
39120>>>>>>>>>>>>>>>            Forward Send Activate
39122>>>>>>>>>>>>>>>        End_procedure
39123>>>>>>>>>>>>>>>        
39123>>>>>>>>>>>>>>>        Procedure Activating
39125>>>>>>>>>>>>>>>            Forward Send Activating
39127>>>>>>>>>>>>>>>            Set Auto_Index_State to True
39128>>>>>>>>>>>>>>>        End_Procedure
39129>>>>>>>>>>>>>>>        
39129>>>>>>>>>>>>>>>        
39129>>>>>>>>>>>>>>>        //AB-StoreEnd
39129>>>>>>>>>>>>>>>
39129>>>>>>>>>>>>>>>    End_Object    // oSelList
39130>>>>>>>>>>>>>>>
39130>>>>>>>>>>>>>>>    Object cSyDateForm1 is a cSyDateForm
39132>>>>>>>>>>>>>>>        Set Size to 13 85
39133>>>>>>>>>>>>>>>        Set Location to 222 54
39134>>>>>>>>>>>>>>>        Set Label_Col_Offset to 2
39135>>>>>>>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
39136>>>>>>>>>>>>>>>        Set Form_Mask Item 0 to "d/M/yyyy"
39137>>>>>>>>>>>>>>>
39137>>>>>>>>>>>>>>>        //AB-StoreStart
39137>>>>>>>>>>>>>>>                        
39137>>>>>>>>>>>>>>>        Procedure Key Integer iKey
39139>>>>>>>>>>>>>>>            Integer iRetVal
39140>>>>>>>>>>>>>>>            Forward Send Key iKey
39142>>>>>>>>>>>>>>>            If (iKey=277) Begin
39144>>>>>>>>>>>>>>>                Send Clear_Me
39145>>>>>>>>>>>>>>>            End
39145>>>>>>>>>>>>>>>>
39145>>>>>>>>>>>>>>>        End_Procedure
39146>>>>>>>>>>>>>>>        
39146>>>>>>>>>>>>>>>        Procedure Clear_Me
39148>>>>>>>>>>>>>>>            Set Value Item 0 to ''
39149>>>>>>>>>>>>>>>            Send KeyAction to ButtonSub1
39150>>>>>>>>>>>>>>>        End_Procedure
39151>>>>>>>>>>>>>>>        
39151>>>>>>>>>>>>>>>        Procedure Exiting00000
39153>>>>>>>>>>>>>>>            Forward Send Exiting
39155>>>>>>>>>>>>>>>            Send KeyAction to ButtonSub1
39156>>>>>>>>>>>>>>>        End_procedure
39157>>>>>>>>>>>>>>>        
39157>>>>>>>>>>>>>>>        
39157>>>>>>>>>>>>>>>        
39157>>>>>>>>>>>>>>>        //AB-StoreEnd
39157>>>>>>>>>>>>>>>
39157>>>>>>>>>>>>>>>    End_Object    // cSyDateForm1
39158>>>>>>>>>>>>>>>
39158>>>>>>>>>>>>>>>    Object FormSub1 is a FormSub
39160>>>>>>>>>>>>>>>        Set Size to 13 85
39161>>>>>>>>>>>>>>>        Set Location to 236 54
39162>>>>>>>>>>>>>>>        Set Label_Col_Offset to 2
39163>>>>>>>>>>>>>>>        Set Prompt_Button_Mode to pb_PromptOn
39164>>>>>>>>>>>>>>>
39164>>>>>>>>>>>>>>>        //AB-StoreStart
39164>>>>>>>>>>>>>>>                
39164>>>>>>>>>>>>>>>        Set Prompt_Object to (sl012(Self))
39165>>>>>>>>>>>>>>>        
39165>>>>>>>>>>>>>>>        Procedure Prompt
39167>>>>>>>>>>>>>>>            String sModule
39168>>>>>>>>>>>>>>>            Get psModule Of (sl012(Self)) to sModule
39169>>>>>>>>>>>>>>>            Set psModule Of (sl012(Self)) to (psModule(Self))
39170>>>>>>>>>>>>>>>            Forward Send Prompt
39172>>>>>>>>>>>>>>>            Set psModule Of (sl012(Self)) to sModule
39173>>>>>>>>>>>>>>>        End_Procedure
39174>>>>>>>>>>>>>>>        
39174>>>>>>>>>>>>>>>        Procedure OnChange
39176>>>>>>>>>>>>>>>            String s1
39177>>>>>>>>>>>>>>>            Get Value Item 0 to s1
39178>>>>>>>>>>>>>>>            Set Value Of FormSub3 Item 0 to (fsPtyppar(Self,s1))
39179>>>>>>>>>>>>>>>            Clear Ptypparl
39180>>>>>>>>>>>>>>>            Move Syscurxr.Company_Code  to ptypparl.Company_Code
39181>>>>>>>>>>>>>>>            Move Syscurxr.Branch_Code   to ptypparl.Branch_Code
39182>>>>>>>>>>>>>>>            Move s1                     to Ptypparl.Ptyppar_Code
39183>>>>>>>>>>>>>>>            Find Eq Ptypparl by index.1
39184>>>>>>>>>>>>>>>>
39184>>>>>>>>>>>>>>>            Set psPtyppar       to s1
39185>>>>>>>>>>>>>>>            Set psPtypparRecr   to Ptypparl.Ptyppar_Recr
39186>>>>>>>>>>>>>>>            Set psWtypkin       to PtypparL.Wtypkin_Code
39187>>>>>>>>>>>>>>>            Set psCtypkin       to PtypparL.Ctypkin_Code
39188>>>>>>>>>>>>>>>        End_Procedure
39189>>>>>>>>>>>>>>>        
39189>>>>>>>>>>>>>>>        
39189>>>>>>>>>>>>>>>        
39189>>>>>>>>>>>>>>>        
39189>>>>>>>>>>>>>>>        
39189>>>>>>>>>>>>>>>        
39189>>>>>>>>>>>>>>>        
39189>>>>>>>>>>>>>>>        //AB-StoreEnd
39189>>>>>>>>>>>>>>>
39189>>>>>>>>>>>>>>>    End_Object    // FormSub1
39190>>>>>>>>>>>>>>>
39190>>>>>>>>>>>>>>>    Object FormSub3 is a FormSub
39192>>>>>>>>>>>>>>>        Set Size to 13 195
39193>>>>>>>>>>>>>>>        Set Location to 236 145
39194>>>>>>>>>>>>>>>        Set Color to 12363657
39195>>>>>>>>>>>>>>>        Set Label_Col_Offset to 2
39196>>>>>>>>>>>>>>>        Set Enabled_State to FALSE
39197>>>>>>>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
39198>>>>>>>>>>>>>>>        Set Shadow_State Item 0 to TRUE
39199>>>>>>>>>>>>>>>    End_Object    // FormSub3
39200>>>>>>>>>>>>>>>
39200>>>>>>>>>>>>>>>    Object FormSub2 is a FormSub
39202>>>>>>>>>>>>>>>        Set Size to 13 85
39203>>>>>>>>>>>>>>>        Set Location to 250 54
39204>>>>>>>>>>>>>>>        Set Label_Col_Offset to 2
39205>>>>>>>>>>>>>>>        Set Prompt_Button_Mode to pb_PromptOn
39206>>>>>>>>>>>>>>>
39206>>>>>>>>>>>>>>>        //AB-StoreStart
39206>>>>>>>>>>>>>>>                
39206>>>>>>>>>>>>>>>        Set Prompt_Object to (sl100(Self))
39207>>>>>>>>>>>>>>>        
39207>>>>>>>>>>>>>>>        Procedure Prompt
39209>>>>>>>>>>>>>>>            String sModule
39210>>>>>>>>>>>>>>>            Get psModule Of (sl100(Self)) to sModule
39211>>>>>>>>>>>>>>>            Set psModule Of (sl100(Self)) to (psModule(Self))
39212>>>>>>>>>>>>>>>            Forward Send Prompt
39214>>>>>>>>>>>>>>>            Set psModule Of (sl100(Self)) to sModule
39215>>>>>>>>>>>>>>>        End_Procedure
39216>>>>>>>>>>>>>>>        
39216>>>>>>>>>>>>>>>        Procedure OnChange
39218>>>>>>>>>>>>>>>            String s1
39219>>>>>>>>>>>>>>>            Get Value Item 0 to s1
39220>>>>>>>>>>>>>>>            Set Value Of FormSub4 Item 0 to (fsClient(Self,s1))
39221>>>>>>>>>>>>>>>            Set psClient to s1
39222>>>>>>>>>>>>>>>        End_Procedure
39223>>>>>>>>>>>>>>>        
39223>>>>>>>>>>>>>>>        
39223>>>>>>>>>>>>>>>        
39223>>>>>>>>>>>>>>>        
39223>>>>>>>>>>>>>>>        
39223>>>>>>>>>>>>>>>        
39223>>>>>>>>>>>>>>>        
39223>>>>>>>>>>>>>>>        //AB-StoreEnd
39223>>>>>>>>>>>>>>>
39223>>>>>>>>>>>>>>>    End_Object    // FormSub2
39224>>>>>>>>>>>>>>>
39224>>>>>>>>>>>>>>>    Object FormSub4 is a FormSub
39226>>>>>>>>>>>>>>>        Set Size to 13 195
39227>>>>>>>>>>>>>>>        Set Location to 250 145
39228>>>>>>>>>>>>>>>        Set Color to 12363657
39229>>>>>>>>>>>>>>>        Set Label_Col_Offset to 2
39230>>>>>>>>>>>>>>>        Set Enabled_State to FALSE
39231>>>>>>>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
39232>>>>>>>>>>>>>>>        Set Shadow_State Item 0 to TRUE
39233>>>>>>>>>>>>>>>    End_Object    // FormSub4
39234>>>>>>>>>>>>>>>
39234>>>>>>>>>>>>>>>    Object TextBoxSub1 is a TextBoxSub
39236>>>>>>>>>>>>>>>        Set Label to "†£œ¨/¤å˜"
39237>>>>>>>>>>>>>>>        Set Color to 12363657
39238>>>>>>>>>>>>>>>        Set Location to 222 5
39239>>>>>>>>>>>>>>>        Set Size to 10 35
39240>>>>>>>>>>>>>>>    End_Object    // TextBoxSub1
39241>>>>>>>>>>>>>>>
39241>>>>>>>>>>>>>>>    Object TextBoxSub2 is a TextBoxSub
39243>>>>>>>>>>>>>>>        Set Label to "˜¨˜©«/¡æ"
39244>>>>>>>>>>>>>>>        Set Color to 12363657
39245>>>>>>>>>>>>>>>        Set Location to 237 4
39246>>>>>>>>>>>>>>>        Set Size to 10 41
39247>>>>>>>>>>>>>>>    End_Object    // TextBoxSub2
39248>>>>>>>>>>>>>>>
39248>>>>>>>>>>>>>>>    Object TextBoxSub3 is a TextBoxSub
39250>>>>>>>>>>>>>>>        Set Label to "”¦¨â˜ª"
39251>>>>>>>>>>>>>>>        Set Color to 12363657
39252>>>>>>>>>>>>>>>        Set Location to 252 4
39253>>>>>>>>>>>>>>>        Set Size to 10 31
39254>>>>>>>>>>>>>>>    End_Object    // TextBoxSub3
39255>>>>>>>>>>>>>>>
39255>>>>>>>>>>>>>>>    Object ButtonSub1 is a ButtonSub
39257>>>>>>>>>>>>>>>        Set Label to "œ¨ æ¨ ©œ"
39258>>>>>>>>>>>>>>>        Set Size to 13 50
39259>>>>>>>>>>>>>>>        Set Location to 252 355
39260>>>>>>>>>>>>>>>        Set Form_FontWeight Item 0 to 600
39261>>>>>>>>>>>>>>>
39261>>>>>>>>>>>>>>>        //AB-StoreStart
39261>>>>>>>>>>>>>>>                                    
39261>>>>>>>>>>>>>>>        Procedure OnClick
39263>>>>>>>>>>>>>>>            Send Rebuild_Constraints to Particle_DD
39264>>>>>>>>>>>>>>>            Send Beginning_Of_Data to oSelList True
39265>>>>>>>>>>>>>>>        End_Procedure // OnClick
39266>>>>>>>>>>>>>>>        
39266>>>>>>>>>>>>>>>        
39266>>>>>>>>>>>>>>>        //AB-StoreEnd
39266>>>>>>>>>>>>>>>
39266>>>>>>>>>>>>>>>    End_Object    // ButtonSub1
39267>>>>>>>>>>>>>>>
39267>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
39269>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
39270>>>>>>>>>>>>>>>        Set Size to 13 50
39271>>>>>>>>>>>>>>>        Set Location to 252 413
39272>>>>>>>>>>>>>>>
39272>>>>>>>>>>>>>>>        //AB-StoreStart
39272>>>>>>>>>>>>>>>        Procedure OnClick
39274>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
39275>>>>>>>>>>>>>>>        End_Procedure
39276>>>>>>>>>>>>>>>        //AB-StoreEnd
39276>>>>>>>>>>>>>>>
39276>>>>>>>>>>>>>>>    End_Object    // oOK_bn
39277>>>>>>>>>>>>>>>
39277>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
39279>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
39280>>>>>>>>>>>>>>>        Set Size to 13 50
39281>>>>>>>>>>>>>>>        Set Location to 252 466
39282>>>>>>>>>>>>>>>
39282>>>>>>>>>>>>>>>        //AB-StoreStart
39282>>>>>>>>>>>>>>>        Procedure OnClick
39284>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
39285>>>>>>>>>>>>>>>        End_Procedure
39286>>>>>>>>>>>>>>>        //AB-StoreEnd
39286>>>>>>>>>>>>>>>
39286>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
39287>>>>>>>>>>>>>>>
39287>>>>>>>>>>>>>>>
39287>>>>>>>>>>>>>>>    //AB-StoreStart
39287>>>>>>>>>>>>>>>            
39287>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39288>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39289>>>>>>>>>>>>>>>    
39289>>>>>>>>>>>>>>>    Set Locate_Mode to Center_On_Screen
39290>>>>>>>>>>>>>>>    Set Modal_State to True
39291>>>>>>>>>>>>>>>    
39291>>>>>>>>>>>>>>>    Procedure Activate
39293>>>>>>>>>>>>>>>        Forward Send Activate
39295>>>>>>>>>>>>>>>    End_procedure
39296>>>>>>>>>>>>>>>    
39296>>>>>>>>>>>>>>>    Procedure Request_Cancel
39298>>>>>>>>>>>>>>>        Set Value Of cSyDateForm1 Item 0 to ''
39299>>>>>>>>>>>>>>>        Send Clear to Particle_DD
39300>>>>>>>>>>>>>>>        Forward Send Request_Cancel
39302>>>>>>>>>>>>>>>    End_Procedure
39303>>>>>>>>>>>>>>>    
39303>>>>>>>>>>>>>>>    
39303>>>>>>>>>>>>>>>    
39303>>>>>>>>>>>>>>>    
39303>>>>>>>>>>>>>>>    
39303>>>>>>>>>>>>>>>    
39303>>>>>>>>>>>>>>>    
39303>>>>>>>>>>>>>>>    
39303>>>>>>>>>>>>>>>    
39303>>>>>>>>>>>>>>>    
39303>>>>>>>>>>>>>>>    
39303>>>>>>>>>>>>>>>    
39303>>>>>>>>>>>>>>>    
39303>>>>>>>>>>>>>>>    
39303>>>>>>>>>>>>>>>    
39303>>>>>>>>>>>>>>>    
39303>>>>>>>>>>>>>>>    
39303>>>>>>>>>>>>>>>    
39303>>>>>>>>>>>>>>>    //AB-StoreEnd
39303>>>>>>>>>>>>>>>
39303>>>>>>>>>>>>>>>End_Object    // sl014
39304>>>>>>>>>>>>>>>
39304>>>>>>>>>>>>>>>
39304>>>>>>>>>>>>>>>//AB-StoreStart
39304>>>>>>>>>>>>>>>    
39304>>>>>>>>>>>>>>>    
39304>>>>>>>>>>>>>>>//AB-StoreEnd
39304>>>>>>>>>>>>>>>
39304>>>>>>>>>>>>>>>//AB/ End_Object    // prj
39304>>>>>>>>>>>>>Use sl054.SL         // sl054
INCLUDING FILE: SL054.SL
39304>>>>>>>>>>>>>>>//AB/ Project sl054:cars
39304>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
39304>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl054:cars"
39304>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl054.SL"
39304>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
39304>>>>>>>>>>>>>>>
39304>>>>>>>>>>>>>>>// Project Object Structure
39304>>>>>>>>>>>>>>>//   sl054 is a dbModalPanelSub
39304>>>>>>>>>>>>>>>//     Cars_DD is a DataDictionary
39304>>>>>>>>>>>>>>>//     oSelList is a dbListSub
39304>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
39304>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
39304>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
39304>>>>>>>>>>>>>>>
39304>>>>>>>>>>>>>>>// Register all objects
39304>>>>>>>>>>>>>>>Register_Object Cars_DD
39304>>>>>>>>>>>>>>>Register_Object oCancel_bn
39304>>>>>>>>>>>>>>>Register_Object oOK_bn
39304>>>>>>>>>>>>>>>Register_Object oSearch_bn
39304>>>>>>>>>>>>>>>Register_Object oSelList
39304>>>>>>>>>>>>>>>Register_Object sl054
39304>>>>>>>>>>>>>>>
39304>>>>>>>>>>>>>>>
39304>>>>>>>>>>>>>>>//AB-IgnoreStart
39304>>>>>>>>>>>>>>>
39304>>>>>>>>>>>>>>>Use DFAllEnt.pkg
39304>>>>>>>>>>>>>>>Use dbList.Sub
39304>>>>>>>>>>>>>>>Use Button.Sub
39304>>>>>>>>>>>>>>>
39304>>>>>>>>>>>>>>>
39304>>>>>>>>>>>>>>>Use Cars.DD
INCLUDING FILE: CARS.DD
39304>>>>>>>>>>>>>>>>>//DDB-FileStart
39304>>>>>>>>>>>>>>>>>//DDB-HeaderStart
39304>>>>>>>>>>>>>>>>>
39304>>>>>>>>>>>>>>>>>// File Name : CARS.DD
39304>>>>>>>>>>>>>>>>>// Class Name: Cars_DataDictionary
39304>>>>>>>>>>>>>>>>>// Revision  : 7
39304>>>>>>>>>>>>>>>>>// Version   : 2
39304>>>>>>>>>>>>>>>>>
39304>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
39304>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
39304>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39304>>>>>>>>>>>>>>>>>
39304>>>>>>>>>>>>>>>>>Open Cars
39306>>>>>>>>>>>>>>>>>
39306>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
39306>>>>>>>>>>>>>>>>>//DDB-ValidationStart
39306>>>>>>>>>>>>>>>>>
39306>>>>>>>>>>>>>>>>>Register_Object Cars_Ctype_Id_VT
39306>>>>>>>>>>>>>>>>>
39306>>>>>>>>>>>>>>>>>Object Cars_Ctype_Id_VT  is a CodeValidationTable
39308>>>>>>>>>>>>>>>>>    Set Type_Value        To "PUMPSTYPE"
39309>>>>>>>>>>>>>>>>>    Set Validate_State    To FALSE
39310>>>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
39311>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
39311>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
39311>>>>>>>>>>>>>>>>>End_Object   // Cars_Ctype_Id_VT
39312>>>>>>>>>>>>>>>>>//DDB-ValidationEnd
39312>>>>>>>>>>>>>>>>>//DDB-SelectionStart
39312>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl054  sl054.SL
39312>>>>>>>>>>>>>>>>>Register_Object sl054
39312>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
39312>>>>>>>>>>>>>>>>>
39312>>>>>>>>>>>>>>>>>Class Cars_DataDictionary  is a DataDictionary_Sec
39313>>>>>>>>>>>>>>>>>
39313>>>>>>>>>>>>>>>>>    // Update:
39313>>>>>>>>>>>>>>>>>
39313>>>>>>>>>>>>>>>>>    Procedure Update
39314>>>>>>>>>>>>>>>>>        Forward Send Update
39316>>>>>>>>>>>>>>>>>        move syscurxr.company_code  to cars.car_company
39317>>>>>>>>>>>>>>>>>        move syscurxr.beto_site     to cars.car_bsite
39318>>>>>>>>>>>>>>>>>        // Insert Code Here
39318>>>>>>>>>>>>>>>>>    End_Procedure   // Update
39319>>>>>>>>>>>>>>>>>
39319>>>>>>>>>>>>>>>>>
39319>>>>>>>>>>>>>>>>>    // Define_Fields:
39319>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39319>>>>>>>>>>>>>>>>>
39319>>>>>>>>>>>>>>>>>    Procedure Define_Fields
39320>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
39322>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
39322>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
39322>>>>>>>>>>>>>>>>>
39322>>>>>>>>>>>>>>>>>        Set Main_File            To Cars.File_Number
39323>>>>>>>>>>>>>>>>>
39323>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39324>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39325>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39326>>>>>>>>>>>>>>>>>
39326>>>>>>>>>>>>>>>>>        // Field-based properties.......................
39326>>>>>>>>>>>>>>>>>
39326>>>>>>>>>>>>>>>>>        // Cars.Car_Recnum
39326>>>>>>>>>>>>>>>>>
39326>>>>>>>>>>>>>>>>>        // Cars.Car_Company
39326>>>>>>>>>>>>>>>>>
39326>>>>>>>>>>>>>>>>>        // Cars.Car_Id
39326>>>>>>>>>>>>>>>>>        Set Field_Options          Field Cars.Car_Id To DD_AUTOFIND   
39327>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cars.Car_Id To (sl054(Self))
39328>>>>>>>>>>>>>>>>>        Set Key_Field_State        Field Cars.Car_Id To TRUE
39329>>>>>>>>>>>>>>>>>
39329>>>>>>>>>>>>>>>>>        // Cars.Car_Descr
39329>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cars.Car_Descr To (sl054(Self))
39330>>>>>>>>>>>>>>>>>
39330>>>>>>>>>>>>>>>>>        // Cars.Car_License
39330>>>>>>>>>>>>>>>>>
39330>>>>>>>>>>>>>>>>>        // Cars.Car_Driverrecn
39330>>>>>>>>>>>>>>>>>
39330>>>>>>>>>>>>>>>>>        // Cars.Car_Details
39330>>>>>>>>>>>>>>>>>
39330>>>>>>>>>>>>>>>>>        // Cars.Car_Maxm3
39330>>>>>>>>>>>>>>>>>
39330>>>>>>>>>>>>>>>>>        // Cars.Car_Sitew
39330>>>>>>>>>>>>>>>>>
39330>>>>>>>>>>>>>>>>>        // Cars.Car_Tare
39330>>>>>>>>>>>>>>>>>
39330>>>>>>>>>>>>>>>>>        // Cars.Car_Codematch
39330>>>>>>>>>>>>>>>>>
39330>>>>>>>>>>>>>>>>>        // Cars.Car_Driverid
39330>>>>>>>>>>>>>>>>>
39330>>>>>>>>>>>>>>>>>        // Cars.Car_Sn
39330>>>>>>>>>>>>>>>>>
39330>>>>>>>>>>>>>>>>>        // Cars.Car_Lastupdated
39330>>>>>>>>>>>>>>>>>
39330>>>>>>>>>>>>>>>>>        // Cars.Car_Markexp
39330>>>>>>>>>>>>>>>>>
39330>>>>>>>>>>>>>>>>>        // Cars.Car_748tare1
39330>>>>>>>>>>>>>>>>>
39330>>>>>>>>>>>>>>>>>        // Cars.Car_748tare2
39330>>>>>>>>>>>>>>>>>
39330>>>>>>>>>>>>>>>>>        // Cars.Car_748sign
39330>>>>>>>>>>>>>>>>>
39330>>>>>>>>>>>>>>>>>        // Cars.Car_Bsite
39330>>>>>>>>>>>>>>>>>
39330>>>>>>>>>>>>>>>>>        // Cars.Ctype_Id
39330>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Cars.Ctype_Id To "dbComboFormsub"
39331>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Cars.Ctype_Id To (Cars_Ctype_Id_VT(Self))
39332>>>>>>>>>>>>>>>>>
39332>>>>>>>>>>>>>>>>>        // Cars.Pagio
39332>>>>>>>>>>>>>>>>>
39332>>>>>>>>>>>>>>>>>        // Cars.Parakrat
39332>>>>>>>>>>>>>>>>>
39332>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
39332>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
39333>>>>>>>>>>>>>>>>>
39333>>>>>>>>>>>>>>>>>    // Field_Defaults:
39333>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
39333>>>>>>>>>>>>>>>>>
39333>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
39334>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
39336>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
39336>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
39336>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
39336>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
39337>>>>>>>>>>>>>>>>>
39337>>>>>>>>>>>>>>>>>End_Class    // Cars_DataDictionary
39338>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
39338>>>>>>>>>>>>>>>>>
39338>>>>>>>>>>>>>>>>>Use sl054.SL         // sl054
39338>>>>>>>>>>>>>>>>>
39338>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
39338>>>>>>>>>>>>>>>>>//DDB-FileEnd
39338>>>>>>>>>>>>>>>
39338>>>>>>>>>>>>>>>//AB-IgnoreEnd
39338>>>>>>>>>>>>>>>
39338>>>>>>>>>>>>>>>Object sl054 is a dbModalPanelSub
39340>>>>>>>>>>>>>>>    Set Label to "€¨®œå¦ Ž®ž£á«à¤"
39341>>>>>>>>>>>>>>>    Set Size to 148 420
39342>>>>>>>>>>>>>>>    Set Location to 4 5
39343>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
39344>>>>>>>>>>>>>>>    Set Modal_State to FALSE
39345>>>>>>>>>>>>>>>
39345>>>>>>>>>>>>>>>    //AB-DDOStart
39345>>>>>>>>>>>>>>>
39345>>>>>>>>>>>>>>>    Object Cars_DD is a Cars_DataDictionary
39347>>>>>>>>>>>>>>>    End_Object    // Cars_DD
39348>>>>>>>>>>>>>>>
39348>>>>>>>>>>>>>>>    Set Main_DD to (Cars_DD(self))
39349>>>>>>>>>>>>>>>    Set Server to (Cars_DD(self))
39350>>>>>>>>>>>>>>>
39350>>>>>>>>>>>>>>>    //AB-DDOEnd
39350>>>>>>>>>>>>>>>
39350>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
39352>>>>>>>>>>>>>>>        Set Main_File to Cars.File_Number
39353>>>>>>>>>>>>>>>        Set Size to 105 403
39354>>>>>>>>>>>>>>>        Set Location to 6 6
39355>>>>>>>>>>>>>>>
39355>>>>>>>>>>>>>>>        Begin_Row
39358>>>>>>>>>>>>>>>            Entry_Item Cars.Car_id
39359>>>>>>>>>>>>>>>            Entry_Item Cars.Car_descr
39360>>>>>>>>>>>>>>>            Entry_Item Cars.Car_license
39361>>>>>>>>>>>>>>>            Entry_Item Cars.Car_maxm3
39362>>>>>>>>>>>>>>>            Entry_Item Cars.Car_driverid
39363>>>>>>>>>>>>>>>        End_Row
39368>>>>>>>>>>>>>>>
39368>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 80
39369>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à›.Ž®ã£˜«¦ª"
39370>>>>>>>>>>>>>>>        
39370>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 120
39371>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
39372>>>>>>>>>>>>>>>        
39372>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 80
39373>>>>>>>>>>>>>>>        Set Header_Label  item 2 to "€¨ Ÿ.‰¬¡¢¦­¦¨å˜ª"
39374>>>>>>>>>>>>>>>        
39374>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 50
39375>>>>>>>>>>>>>>>        Set Header_Label  item 3 to "Max.m3"
39376>>>>>>>>>>>>>>>        
39376>>>>>>>>>>>>>>>        Set Form_Width    item 4 to 65
39377>>>>>>>>>>>>>>>        Set Header_Label  item 4 to "‰à›.Ž›žš¦ç"
39378>>>>>>>>>>>>>>>        
39378>>>>>>>>>>>>>>>    End_Object    // oSelList
39379>>>>>>>>>>>>>>>
39379>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
39381>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
39382>>>>>>>>>>>>>>>        Set Location to 114 249
39383>>>>>>>>>>>>>>>
39383>>>>>>>>>>>>>>>        //AB-StoreStart
39383>>>>>>>>>>>>>>>        Procedure OnClick
39385>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
39386>>>>>>>>>>>>>>>        End_Procedure
39387>>>>>>>>>>>>>>>        //AB-StoreEnd
39387>>>>>>>>>>>>>>>
39387>>>>>>>>>>>>>>>    End_Object    // oOK_bn
39388>>>>>>>>>>>>>>>
39388>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
39390>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
39391>>>>>>>>>>>>>>>        Set Location to 114 305
39392>>>>>>>>>>>>>>>
39392>>>>>>>>>>>>>>>        //AB-StoreStart
39392>>>>>>>>>>>>>>>        Procedure OnClick
39394>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
39395>>>>>>>>>>>>>>>        End_Procedure
39396>>>>>>>>>>>>>>>        //AB-StoreEnd
39396>>>>>>>>>>>>>>>
39396>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
39397>>>>>>>>>>>>>>>
39397>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
39399>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
39400>>>>>>>>>>>>>>>        Set Location to 114 359
39401>>>>>>>>>>>>>>>
39401>>>>>>>>>>>>>>>        //AB-StoreStart
39401>>>>>>>>>>>>>>>        Procedure OnClick
39403>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
39404>>>>>>>>>>>>>>>        End_Procedure
39405>>>>>>>>>>>>>>>        //AB-StoreEnd
39405>>>>>>>>>>>>>>>
39405>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
39406>>>>>>>>>>>>>>>
39406>>>>>>>>>>>>>>>
39406>>>>>>>>>>>>>>>    //AB-StoreStart
39406>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39407>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39408>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39409>>>>>>>>>>>>>>>    //AB-StoreEnd
39409>>>>>>>>>>>>>>>
39409>>>>>>>>>>>>>>>End_Object    // sl054
39410>>>>>>>>>>>>>>>
39410>>>>>>>>>>>>>>>//AB/ End_Object    // prj
39410>>>>>>>>>>>>>Use sl053.SL         // sl053
INCLUDING FILE: SL053.SL
39410>>>>>>>>>>>>>>>//AB/ Project sl053:pumps
39410>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
39410>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl053:pumps"
39410>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl053.SL"
39410>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
39410>>>>>>>>>>>>>>>
39410>>>>>>>>>>>>>>>// Project Object Structure
39410>>>>>>>>>>>>>>>//   sl053 is a dbModalPanelSub
39410>>>>>>>>>>>>>>>//     Pumps_DD is a DataDictionary
39410>>>>>>>>>>>>>>>//     oSelList is a dbListSub
39410>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
39410>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
39410>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
39410>>>>>>>>>>>>>>>
39410>>>>>>>>>>>>>>>// Register all objects
39410>>>>>>>>>>>>>>>Register_Object oCancel_bn
39410>>>>>>>>>>>>>>>Register_Object oOK_bn
39410>>>>>>>>>>>>>>>Register_Object oSearch_bn
39410>>>>>>>>>>>>>>>Register_Object oSelList
39410>>>>>>>>>>>>>>>Register_Object Pumps_DD
39410>>>>>>>>>>>>>>>Register_Object sl053
39410>>>>>>>>>>>>>>>
39410>>>>>>>>>>>>>>>
39410>>>>>>>>>>>>>>>//AB-IgnoreStart
39410>>>>>>>>>>>>>>>
39410>>>>>>>>>>>>>>>Use DFAllEnt.pkg
39410>>>>>>>>>>>>>>>Use dbList.Sub
39410>>>>>>>>>>>>>>>Use Button.Sub
39410>>>>>>>>>>>>>>>
39410>>>>>>>>>>>>>>>
39410>>>>>>>>>>>>>>>Use Pumps.DD
INCLUDING FILE: PUMPS.DD
39410>>>>>>>>>>>>>>>>>//DDB-FileStart
39410>>>>>>>>>>>>>>>>>//DDB-HeaderStart
39410>>>>>>>>>>>>>>>>>
39410>>>>>>>>>>>>>>>>>// File Name : PUMPS.DD
39410>>>>>>>>>>>>>>>>>// Class Name: Pumps_DataDictionary
39410>>>>>>>>>>>>>>>>>// Revision  : 11
39410>>>>>>>>>>>>>>>>>// Version   : 2
39410>>>>>>>>>>>>>>>>>
39410>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
39410>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
39410>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39410>>>>>>>>>>>>>>>>>
39410>>>>>>>>>>>>>>>>>Open Pumps
39412>>>>>>>>>>>>>>>>>
39412>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
39412>>>>>>>>>>>>>>>>>//DDB-ValidationStart
39412>>>>>>>>>>>>>>>>>
39412>>>>>>>>>>>>>>>>>Register_Object Pumps_Ctype_Id_VT
39412>>>>>>>>>>>>>>>>>
39412>>>>>>>>>>>>>>>>>Object Pumps_Ctype_Id_VT  is a CodeValidationTable
39414>>>>>>>>>>>>>>>>>    Set Type_Value        To "PUMPSTYPE"
39415>>>>>>>>>>>>>>>>>    Set Validate_State    To FALSE
39416>>>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
39417>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
39417>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
39417>>>>>>>>>>>>>>>>>End_Object   // Pumps_Ctype_Id_VT
39418>>>>>>>>>>>>>>>>>//DDB-ValidationEnd
39418>>>>>>>>>>>>>>>>>//DDB-SelectionStart
39418>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl053  sl053.SL
39418>>>>>>>>>>>>>>>>>Register_Object sl053
39418>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
39418>>>>>>>>>>>>>>>>>
39418>>>>>>>>>>>>>>>>>Class Pumps_DataDictionary  is a DataDictionary_Sec
39419>>>>>>>>>>>>>>>>>
39419>>>>>>>>>>>>>>>>>    // Update:
39419>>>>>>>>>>>>>>>>>
39419>>>>>>>>>>>>>>>>>    Procedure Update
39420>>>>>>>>>>>>>>>>>        Forward Send Update
39422>>>>>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to Pumps.Pump_Company
39423>>>>>>>>>>>>>>>>>        Move SysCurXR.Beto_Site     to Pumps.Pump_SiteW
39424>>>>>>>>>>>>>>>>>    End_Procedure   // Update
39425>>>>>>>>>>>>>>>>>
39425>>>>>>>>>>>>>>>>>
39425>>>>>>>>>>>>>>>>>    // Define_Fields:
39425>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39425>>>>>>>>>>>>>>>>>
39425>>>>>>>>>>>>>>>>>    Procedure Define_Fields
39426>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
39428>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
39428>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
39428>>>>>>>>>>>>>>>>>
39428>>>>>>>>>>>>>>>>>        Set Main_File            To Pumps.File_Number
39429>>>>>>>>>>>>>>>>>
39429>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39430>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39431>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39432>>>>>>>>>>>>>>>>>
39432>>>>>>>>>>>>>>>>>        // Field-based properties.......................
39432>>>>>>>>>>>>>>>>>
39432>>>>>>>>>>>>>>>>>        // Pumps.Pump_Recnum
39432>>>>>>>>>>>>>>>>>
39432>>>>>>>>>>>>>>>>>        // Pumps.Pump_Company
39432>>>>>>>>>>>>>>>>>
39432>>>>>>>>>>>>>>>>>        // Pumps.Pump_Id
39432>>>>>>>>>>>>>>>>>        Set Field_Options          Field Pumps.Pump_Id To DD_AUTOFIND   
39433>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Pumps.Pump_Id To (sl053(Self))
39434>>>>>>>>>>>>>>>>>        Set Key_Field_State        Field Pumps.Pump_Id To TRUE
39435>>>>>>>>>>>>>>>>>
39435>>>>>>>>>>>>>>>>>        // Pumps.Pump_Descr
39435>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Pumps.Pump_Descr To (sl053(Self))
39436>>>>>>>>>>>>>>>>>
39436>>>>>>>>>>>>>>>>>        // Pumps.Pump_License
39436>>>>>>>>>>>>>>>>>
39436>>>>>>>>>>>>>>>>>        // Pumps.Pump_Mhkos
39436>>>>>>>>>>>>>>>>>
39436>>>>>>>>>>>>>>>>>        // Pumps.Pump_Mhkosch
39436>>>>>>>>>>>>>>>>>
39436>>>>>>>>>>>>>>>>>        // Pumps.Pump_Codematch
39436>>>>>>>>>>>>>>>>>
39436>>>>>>>>>>>>>>>>>        // Pumps.Pump_Sitew
39436>>>>>>>>>>>>>>>>>
39436>>>>>>>>>>>>>>>>>        // Pumps.Pump_Driver
39436>>>>>>>>>>>>>>>>>
39436>>>>>>>>>>>>>>>>>        // Pumps.Pump_Bsite
39436>>>>>>>>>>>>>>>>>
39436>>>>>>>>>>>>>>>>>        // Pumps.Ctype_Id
39436>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Pumps.Ctype_Id To "dbComboFormsub"
39437>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Pumps.Ctype_Id To (Pumps_Ctype_Id_VT(Self))
39438>>>>>>>>>>>>>>>>>
39438>>>>>>>>>>>>>>>>>        // Pumps.Pagiomin
39438>>>>>>>>>>>>>>>>>
39438>>>>>>>>>>>>>>>>>        // Pumps.Pricem3
39438>>>>>>>>>>>>>>>>>
39438>>>>>>>>>>>>>>>>>        // Pumps.Parakrat
39438>>>>>>>>>>>>>>>>>
39438>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
39438>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
39439>>>>>>>>>>>>>>>>>
39439>>>>>>>>>>>>>>>>>    // Field_Defaults:
39439>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
39439>>>>>>>>>>>>>>>>>
39439>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
39440>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
39442>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
39442>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
39442>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
39442>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
39443>>>>>>>>>>>>>>>>>
39443>>>>>>>>>>>>>>>>>End_Class    // Pumps_DataDictionary
39444>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
39444>>>>>>>>>>>>>>>>>
39444>>>>>>>>>>>>>>>>>Use sl053.SL         // sl053
39444>>>>>>>>>>>>>>>>>
39444>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
39444>>>>>>>>>>>>>>>>>//DDB-FileEnd
39444>>>>>>>>>>>>>>>
39444>>>>>>>>>>>>>>>//AB-IgnoreEnd
39444>>>>>>>>>>>>>>>
39444>>>>>>>>>>>>>>>Object sl053 is a dbModalPanelSub
39446>>>>>>>>>>>>>>>    Set Label to "€¨®œå¦ €¤«¢ é¤"
39447>>>>>>>>>>>>>>>    Set Size to 148 325
39448>>>>>>>>>>>>>>>    Set Location to 4 5
39449>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
39450>>>>>>>>>>>>>>>    Set Modal_State to FALSE
39451>>>>>>>>>>>>>>>
39451>>>>>>>>>>>>>>>    //AB-DDOStart
39451>>>>>>>>>>>>>>>
39451>>>>>>>>>>>>>>>    Object Pumps_DD is a Pumps_DataDictionary
39453>>>>>>>>>>>>>>>    End_Object    // Pumps_DD
39454>>>>>>>>>>>>>>>
39454>>>>>>>>>>>>>>>    Set Main_DD to (Pumps_DD(self))
39455>>>>>>>>>>>>>>>    Set Server to (Pumps_DD(self))
39456>>>>>>>>>>>>>>>
39456>>>>>>>>>>>>>>>    //AB-DDOEnd
39456>>>>>>>>>>>>>>>
39456>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
39458>>>>>>>>>>>>>>>        Set Main_File to Pumps.File_Number
39459>>>>>>>>>>>>>>>        Set Size to 105 309
39460>>>>>>>>>>>>>>>        Set Location to 6 6
39461>>>>>>>>>>>>>>>
39461>>>>>>>>>>>>>>>        Begin_Row
39464>>>>>>>>>>>>>>>            Entry_Item Pumps.Pump_id
39465>>>>>>>>>>>>>>>            Entry_Item Pumps.Pump_descr
39466>>>>>>>>>>>>>>>            Entry_Item Pumps.Pump_license
39467>>>>>>>>>>>>>>>            Entry_Item Pumps.Pump_mhkos
39468>>>>>>>>>>>>>>>        End_Row
39473>>>>>>>>>>>>>>>
39473>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 70
39474>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª €¤«¢å˜ª"
39475>>>>>>>>>>>>>>>        
39475>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 120
39476>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
39477>>>>>>>>>>>>>>>        
39477>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 65
39478>>>>>>>>>>>>>>>        Set Header_Label  item 2 to " ¤˜¡å›˜"
39479>>>>>>>>>>>>>>>        
39479>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 46
39480>>>>>>>>>>>>>>>        Set Header_Label  item 3 to "‹ã¡¦ª"
39481>>>>>>>>>>>>>>>        
39481>>>>>>>>>>>>>>>    End_Object    // oSelList
39482>>>>>>>>>>>>>>>
39482>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
39484>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
39485>>>>>>>>>>>>>>>        Set Location to 114 157
39486>>>>>>>>>>>>>>>
39486>>>>>>>>>>>>>>>        //AB-StoreStart
39486>>>>>>>>>>>>>>>        Procedure OnClick
39488>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
39489>>>>>>>>>>>>>>>        End_Procedure
39490>>>>>>>>>>>>>>>        //AB-StoreEnd
39490>>>>>>>>>>>>>>>
39490>>>>>>>>>>>>>>>    End_Object    // oOK_bn
39491>>>>>>>>>>>>>>>
39491>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
39493>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
39494>>>>>>>>>>>>>>>        Set Location to 114 212
39495>>>>>>>>>>>>>>>
39495>>>>>>>>>>>>>>>        //AB-StoreStart
39495>>>>>>>>>>>>>>>        Procedure OnClick
39497>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
39498>>>>>>>>>>>>>>>        End_Procedure
39499>>>>>>>>>>>>>>>        //AB-StoreEnd
39499>>>>>>>>>>>>>>>
39499>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
39500>>>>>>>>>>>>>>>
39500>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
39502>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
39503>>>>>>>>>>>>>>>        Set Location to 114 267
39504>>>>>>>>>>>>>>>
39504>>>>>>>>>>>>>>>        //AB-StoreStart
39504>>>>>>>>>>>>>>>        Procedure OnClick
39506>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
39507>>>>>>>>>>>>>>>        End_Procedure
39508>>>>>>>>>>>>>>>        //AB-StoreEnd
39508>>>>>>>>>>>>>>>
39508>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
39509>>>>>>>>>>>>>>>
39509>>>>>>>>>>>>>>>
39509>>>>>>>>>>>>>>>    //AB-StoreStart
39509>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39510>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39511>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39512>>>>>>>>>>>>>>>    //AB-StoreEnd
39512>>>>>>>>>>>>>>>
39512>>>>>>>>>>>>>>>End_Object    // sl053
39513>>>>>>>>>>>>>>>
39513>>>>>>>>>>>>>>>//AB/ End_Object    // prj
39513>>>>>>>>>>>>>Use sl064.SL         // sl064
INCLUDING FILE: SL064.SL
39513>>>>>>>>>>>>>>>//AB/ Project sl064 : Zones
39513>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
39513>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl064 : Zones"
39513>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl064.SL"
39513>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
39513>>>>>>>>>>>>>>>
39513>>>>>>>>>>>>>>>// Project Object Structure
39513>>>>>>>>>>>>>>>//   sl064 is a dbModalPanelSub
39513>>>>>>>>>>>>>>>//     Zones_DD is a DataDictionary
39513>>>>>>>>>>>>>>>//     oSelList is a dbListSub
39513>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
39513>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
39513>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
39513>>>>>>>>>>>>>>>
39513>>>>>>>>>>>>>>>// Register all objects
39513>>>>>>>>>>>>>>>Register_Object oCancel_bn
39513>>>>>>>>>>>>>>>Register_Object oOK_bn
39513>>>>>>>>>>>>>>>Register_Object oSearch_bn
39513>>>>>>>>>>>>>>>Register_Object oSelList
39513>>>>>>>>>>>>>>>Register_Object sl064
39513>>>>>>>>>>>>>>>Register_Object Zones_DD
39513>>>>>>>>>>>>>>>
39513>>>>>>>>>>>>>>>
39513>>>>>>>>>>>>>>>//AB-IgnoreStart
39513>>>>>>>>>>>>>>>
39513>>>>>>>>>>>>>>>Use DFAllEnt.pkg
39513>>>>>>>>>>>>>>>Use dbList.Sub
39513>>>>>>>>>>>>>>>Use Button.Sub
39513>>>>>>>>>>>>>>>
39513>>>>>>>>>>>>>>>
39513>>>>>>>>>>>>>>>Use ZONES.DD
INCLUDING FILE: ZONES.DD
39513>>>>>>>>>>>>>>>>>//DDB-FileStart
39513>>>>>>>>>>>>>>>>>//DDB-HeaderStart
39513>>>>>>>>>>>>>>>>>
39513>>>>>>>>>>>>>>>>>// File Name : ZONES.DD
39513>>>>>>>>>>>>>>>>>// Class Name: Zones_DataDictionary
39513>>>>>>>>>>>>>>>>>// Revision  : 2
39513>>>>>>>>>>>>>>>>>// Version   : 2
39513>>>>>>>>>>>>>>>>>
39513>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
39513>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
39513>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39513>>>>>>>>>>>>>>>>>
39513>>>>>>>>>>>>>>>>>Open Zones
INCLUDING FILE: ZONES.FD
39515>>>>>>>>>>>>>>>>>Open Brzones
39517>>>>>>>>>>>>>>>>>
39517>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
39517>>>>>>>>>>>>>>>>>//DDB-SelectionStart
39517>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl064  sl064.SL
39517>>>>>>>>>>>>>>>>>Register_Object sl064
39517>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
39517>>>>>>>>>>>>>>>>>
39517>>>>>>>>>>>>>>>>>Class Zones_DataDictionary  is a DataDictionary_Sec
39518>>>>>>>>>>>>>>>>>
39518>>>>>>>>>>>>>>>>>    // Define_Fields:
39518>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39518>>>>>>>>>>>>>>>>>
39518>>>>>>>>>>>>>>>>>    Procedure Define_Fields
39519>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
39521>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
39521>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
39521>>>>>>>>>>>>>>>>>
39521>>>>>>>>>>>>>>>>>        Set Main_File            To Zones.File_Number
39522>>>>>>>>>>>>>>>>>
39522>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
39523>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
39524>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39525>>>>>>>>>>>>>>>>>
39525>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
39525>>>>>>>>>>>>>>>>>        Send Add_Client_File  Brzones.File_Number
39526>>>>>>>>>>>>>>>>>
39526>>>>>>>>>>>>>>>>>        // Field-based properties.......................
39526>>>>>>>>>>>>>>>>>
39526>>>>>>>>>>>>>>>>>        // Zones.Zone_Id
39526>>>>>>>>>>>>>>>>>        Set Field_Options          Field Zones.Zone_Id To DD_AUTOFIND
39527>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Zones.Zone_Id To (sl064(Self))
39528>>>>>>>>>>>>>>>>>
39528>>>>>>>>>>>>>>>>>        // Zones.Zone_Descr
39528>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Zones.Zone_Descr To (sl064(Self))
39529>>>>>>>>>>>>>>>>>
39529>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
39529>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
39530>>>>>>>>>>>>>>>>>
39530>>>>>>>>>>>>>>>>>    // Field_Defaults:
39530>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
39530>>>>>>>>>>>>>>>>>
39530>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
39531>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
39533>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
39533>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
39533>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
39533>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
39534>>>>>>>>>>>>>>>>>
39534>>>>>>>>>>>>>>>>>End_Class    // Zones_DataDictionary
39535>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
39535>>>>>>>>>>>>>>>>>
39535>>>>>>>>>>>>>>>>>Use sl064.SL         // sl064
39535>>>>>>>>>>>>>>>>>
39535>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
39535>>>>>>>>>>>>>>>>>//DDB-FileEnd
39535>>>>>>>>>>>>>>>
39535>>>>>>>>>>>>>>>//AB-IgnoreEnd
39535>>>>>>>>>>>>>>>
39535>>>>>>>>>>>>>>>CD_Popup_Object sl064 is a dbModalPanelSub
39554>>>>>>>>>>>>>>>    Set Label to "…é¤œª"
39555>>>>>>>>>>>>>>>    Set Size to 148 297
39556>>>>>>>>>>>>>>>    Set Location to 4 5
39557>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
39558>>>>>>>>>>>>>>>    Set Modal_State to FALSE
39559>>>>>>>>>>>>>>>
39559>>>>>>>>>>>>>>>    //AB-DDOStart
39559>>>>>>>>>>>>>>>
39559>>>>>>>>>>>>>>>    Object Zones_DD is a Zones_DataDictionary
39561>>>>>>>>>>>>>>>    End_Object    // Zones_DD
39562>>>>>>>>>>>>>>>
39562>>>>>>>>>>>>>>>    Set Main_DD to (Zones_DD(self))
39563>>>>>>>>>>>>>>>    Set Server to (Zones_DD(self))
39564>>>>>>>>>>>>>>>
39564>>>>>>>>>>>>>>>    //AB-DDOEnd
39564>>>>>>>>>>>>>>>
39564>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
39566>>>>>>>>>>>>>>>        Set Main_File to Zones.File_Number
39567>>>>>>>>>>>>>>>        Set Size to 105 280
39568>>>>>>>>>>>>>>>        Set Location to 6 6
39569>>>>>>>>>>>>>>>
39569>>>>>>>>>>>>>>>        Begin_Row
39572>>>>>>>>>>>>>>>            Entry_Item Zones.Zone_id
39573>>>>>>>>>>>>>>>            Entry_Item Zones.Zone_descr
39574>>>>>>>>>>>>>>>        End_Row
39579>>>>>>>>>>>>>>>
39579>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 73
39580>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
39581>>>>>>>>>>>>>>>        
39581>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 199
39582>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
39583>>>>>>>>>>>>>>>        
39583>>>>>>>>>>>>>>>    End_Object    // oSelList
39584>>>>>>>>>>>>>>>
39584>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
39586>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
39587>>>>>>>>>>>>>>>        Set Location to 115 126
39588>>>>>>>>>>>>>>>
39588>>>>>>>>>>>>>>>        //AB-StoreStart
39588>>>>>>>>>>>>>>>        Procedure OnClick
39590>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
39591>>>>>>>>>>>>>>>        End_Procedure
39592>>>>>>>>>>>>>>>        //AB-StoreEnd
39592>>>>>>>>>>>>>>>
39592>>>>>>>>>>>>>>>    End_Object    // oOK_bn
39593>>>>>>>>>>>>>>>
39593>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
39595>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
39596>>>>>>>>>>>>>>>        Set Location to 115 181
39597>>>>>>>>>>>>>>>
39597>>>>>>>>>>>>>>>        //AB-StoreStart
39597>>>>>>>>>>>>>>>        Procedure OnClick
39599>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
39600>>>>>>>>>>>>>>>        End_Procedure
39601>>>>>>>>>>>>>>>        //AB-StoreEnd
39601>>>>>>>>>>>>>>>
39601>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
39602>>>>>>>>>>>>>>>
39602>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
39604>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
39605>>>>>>>>>>>>>>>        Set Location to 115 236
39606>>>>>>>>>>>>>>>
39606>>>>>>>>>>>>>>>        //AB-StoreStart
39606>>>>>>>>>>>>>>>        Procedure OnClick
39608>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
39609>>>>>>>>>>>>>>>        End_Procedure
39610>>>>>>>>>>>>>>>        //AB-StoreEnd
39610>>>>>>>>>>>>>>>
39610>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
39611>>>>>>>>>>>>>>>
39611>>>>>>>>>>>>>>>
39611>>>>>>>>>>>>>>>    //AB-StoreStart
39611>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39612>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39613>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39614>>>>>>>>>>>>>>>    //AB-StoreEnd
39614>>>>>>>>>>>>>>>
39614>>>>>>>>>>>>>>>CD_End_Object    // sl064
39616>>>>>>>>>>>>>>>>
39616>>>>>>>>>>>>>>>
39616>>>>>>>>>>>>>>>//AB/ End_Object    // prj
39616>>>>>>>>>>>>>
39616>>>>>>>>>>>>>//DDB-Selection-pkg-End
39616>>>>>>>>>>>>>//DDB-FileEnd
39616>>>>>>>>>>>    Use WAPOKAT.DD
INCLUDING FILE: WAPOKAT.DD
39616>>>>>>>>>>>>>//DDB-FileStart
39616>>>>>>>>>>>>>//DDB-HeaderStart
39616>>>>>>>>>>>>>
39616>>>>>>>>>>>>>// File Name : WAPOKAT.DD
39616>>>>>>>>>>>>>// Class Name: Wapokat_DataDictionary
39616>>>>>>>>>>>>>// Revision  : 13
39616>>>>>>>>>>>>>// Version   : 2
39616>>>>>>>>>>>>>
39616>>>>>>>>>>>>>Use  Windows           // Basic Definitions
39616>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
39616>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39616>>>>>>>>>>>>>
39616>>>>>>>>>>>>>Open Wapokat
INCLUDING FILE: WAPOKAT.FD
39618>>>>>>>>>>>>>Open Wapomast
INCLUDING FILE: WAPOMAST.FD
39620>>>>>>>>>>>>>Open Sysrecw
39622>>>>>>>>>>>>>Open Syscurxr
39624>>>>>>>>>>>>>
39624>>>>>>>>>>>>>//DDB-HeaderEnd
39624>>>>>>>>>>>>>//DDB-SelectionStart
39624>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl022  sl022.SL
39624>>>>>>>>>>>>>Register_Object sl022
39624>>>>>>>>>>>>>//DDB-SelectionEnd
39624>>>>>>>>>>>>>
39624>>>>>>>>>>>>>Class Wapokat_DataDictionary  is a DataDictionary
39625>>>>>>>>>>>>>
39625>>>>>>>>>>>>>    // Update:
39625>>>>>>>>>>>>>    Procedure Update
39626>>>>>>>>>>>>>        Forward Send Update
39628>>>>>>>>>>>>>        // Insert Code Here
39628>>>>>>>>>>>>>//        Move SysCurXR.Company_Code   to Wapokat.Company_Code
39628>>>>>>>>>>>>>//        Move SysCurXR.Branch_Code     to Wapokat.Branch_Code
39628>>>>>>>>>>>>>//        Move SysCurXR.Year_Year         to Wapokat.Year_Year
39628>>>>>>>>>>>>>    End_Procedure   // Update
39629>>>>>>>>>>>>> 
39629>>>>>>>>>>>>>     Procedure Creating
39630>>>>>>>>>>>>>        Forward Send Creating
39632>>>>>>>>>>>>>        // Insert Code Here
39632>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wapokat.Wapokat_Rec0)))))) to Wapokat.Wapokat_Recr
39633>>>>>>>>>>>>>    End_Procedure   // Creating
39634>>>>>>>>>>>>>
39634>>>>>>>>>>>>>
39634>>>>>>>>>>>>>    // Define_Fields:
39634>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39634>>>>>>>>>>>>>
39634>>>>>>>>>>>>>    Procedure Define_Fields
39635>>>>>>>>>>>>>        Forward Send Define_Fields
39637>>>>>>>>>>>>>        //DDB-Generated-Code-Location
39637>>>>>>>>>>>>>        //DDB-DefineFieldStart
39637>>>>>>>>>>>>>
39637>>>>>>>>>>>>>        Set Main_File            To Wapokat.File_Number
39638>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
39639>>>>>>>>>>>>>
39639>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39640>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39641>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39642>>>>>>>>>>>>>
39642>>>>>>>>>>>>>        // Child (Client) file structure................
39642>>>>>>>>>>>>>        Send Add_Client_File  Wapomast.File_Number
39643>>>>>>>>>>>>>
39643>>>>>>>>>>>>>        // External (System) file structure.............
39643>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
39644>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
39645>>>>>>>>>>>>>
39645>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Wapokat_Rec0  To Wapokat.Wapokat_Rec0
39648>>>>>>>>>>>>>
39648>>>>>>>>>>>>>        // Field-based properties.......................
39648>>>>>>>>>>>>>
39648>>>>>>>>>>>>>        // Wapokat.Wapokat_Code
39648>>>>>>>>>>>>>        Set Field_Options          Field Wapokat.Wapokat_Code To DD_AUTOFIND   
39649>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Wapokat.Wapokat_Code To (sl022(Self))
39650>>>>>>>>>>>>>
39650>>>>>>>>>>>>>        // Wapokat.Wapokat_Rec0
39650>>>>>>>>>>>>>        Set Field_Options          Field Wapokat.Wapokat_Rec0 To DD_AUTOFIND   
39651>>>>>>>>>>>>>
39651>>>>>>>>>>>>>        // Wapokat.Wapokat_Descr
39651>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Wapokat.Wapokat_Descr To (sl022(Self))
39652>>>>>>>>>>>>>
39652>>>>>>>>>>>>>        // Wapokat.Wapokat_Recr
39652>>>>>>>>>>>>>        Set Field_Options          Field Wapokat.Wapokat_Recr To DD_AUTOFIND   
39653>>>>>>>>>>>>>
39653>>>>>>>>>>>>>        //DDB-DefineFieldEnd
39653>>>>>>>>>>>>>    End_Procedure    // Define_Fields
39654>>>>>>>>>>>>>
39654>>>>>>>>>>>>>    // Field_Defaults:
39654>>>>>>>>>>>>>    // This procedure is used to establish default field values.
39654>>>>>>>>>>>>>
39654>>>>>>>>>>>>>    Procedure Field_Defaults
39655>>>>>>>>>>>>>        Forward Send Field_Defaults
39657>>>>>>>>>>>>>        //DDB-Generated-Code-Location
39657>>>>>>>>>>>>>        //DDB-FieldDefaultStart
39657>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
39657>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
39658>>>>>>>>>>>>>
39658>>>>>>>>>>>>>End_Class    // Wapokat_DataDictionary
39659>>>>>>>>>>>>>//DDB-Selection-pkg-Start
39659>>>>>>>>>>>>>
39659>>>>>>>>>>>>>Use sl022.SL         // sl022
INCLUDING FILE: SL022.SL
39659>>>>>>>>>>>>>>>//AB/ Project sl022:kathg-apothkon
39659>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
39659>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl022:kathg-apothkon"
39659>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl022.SL"
39659>>>>>>>>>>>>>>>
39659>>>>>>>>>>>>>>>// Project Object Structure
39659>>>>>>>>>>>>>>>//   sl022 is a dbModalPanelSub
39659>>>>>>>>>>>>>>>//     Wapokat_DD is a DataDictionary
39659>>>>>>>>>>>>>>>//     oSelList is a dbListSub
39659>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
39659>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
39659>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
39659>>>>>>>>>>>>>>>
39659>>>>>>>>>>>>>>>// Register all objects
39659>>>>>>>>>>>>>>>Register_Object oCancel_bn
39659>>>>>>>>>>>>>>>Register_Object oOK_bn
39659>>>>>>>>>>>>>>>Register_Object oSearch_bn
39659>>>>>>>>>>>>>>>Register_Object oSelList
39659>>>>>>>>>>>>>>>Register_Object sl022
39659>>>>>>>>>>>>>>>Register_Object Wapokat_DD
39659>>>>>>>>>>>>>>>
39659>>>>>>>>>>>>>>>
39659>>>>>>>>>>>>>>>//AB-IgnoreStart
39659>>>>>>>>>>>>>>>
39659>>>>>>>>>>>>>>>Use DFAllEnt.pkg
39659>>>>>>>>>>>>>>>Use dbList.Sub
39659>>>>>>>>>>>>>>>Use Button.Sub
39659>>>>>>>>>>>>>>>
39659>>>>>>>>>>>>>>>
39659>>>>>>>>>>>>>>>Use WAPOKAT.DD
39659>>>>>>>>>>>>>>>
39659>>>>>>>>>>>>>>>//AB-IgnoreEnd
39659>>>>>>>>>>>>>>>
39659>>>>>>>>>>>>>>>CD_Popup_Object sl022 is a dbModalPanelSub
39678>>>>>>>>>>>>>>>    set label to "‰˜«žš¦¨åœª €§¦Ÿž¡é¤" 
39679>>>>>>>>>>>>>>>    Set Size to 148 297
39680>>>>>>>>>>>>>>>    Set Location to 12 19
39681>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
39682>>>>>>>>>>>>>>>    Set Modal_State to FALSE
39683>>>>>>>>>>>>>>>
39683>>>>>>>>>>>>>>>    //AB-DDOStart
39683>>>>>>>>>>>>>>>
39683>>>>>>>>>>>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
39685>>>>>>>>>>>>>>>    End_Object    // Wapokat_DD
39686>>>>>>>>>>>>>>>
39686>>>>>>>>>>>>>>>    Set Main_DD to (Wapokat_DD(self))
39687>>>>>>>>>>>>>>>    Set Server to (Wapokat_DD(self))
39688>>>>>>>>>>>>>>>
39688>>>>>>>>>>>>>>>    //AB-DDOEnd
39688>>>>>>>>>>>>>>>
39688>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
39690>>>>>>>>>>>>>>>        Set Main_File to Wapokat.File_Number
39691>>>>>>>>>>>>>>>        Set Size to 105 280
39692>>>>>>>>>>>>>>>        Set Location to 6 6
39693>>>>>>>>>>>>>>>
39693>>>>>>>>>>>>>>>        Begin_Row
39696>>>>>>>>>>>>>>>            Entry_Item Wapokat.Wapokat_code
39697>>>>>>>>>>>>>>>            Entry_Item Wapokat.Wapokat_descr
39698>>>>>>>>>>>>>>>        End_Row
39703>>>>>>>>>>>>>>>
39703>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 42
39704>>>>>>>>>>>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
39705>>>>>>>>>>>>>>>        
39705>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 228
39706>>>>>>>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
39707>>>>>>>>>>>>>>>        
39707>>>>>>>>>>>>>>>    End_Object    // oSelList
39708>>>>>>>>>>>>>>>
39708>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
39710>>>>>>>>>>>>>>>        set label to "&„§ ¢¦šã" 
39711>>>>>>>>>>>>>>>        Set Location to 115 126
39712>>>>>>>>>>>>>>>
39712>>>>>>>>>>>>>>>        //AB-StoreStart
39712>>>>>>>>>>>>>>>        Procedure OnClick
39714>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
39715>>>>>>>>>>>>>>>        End_Procedure
39716>>>>>>>>>>>>>>>        //AB-StoreEnd
39716>>>>>>>>>>>>>>>
39716>>>>>>>>>>>>>>>    End_Object    // oOK_bn
39717>>>>>>>>>>>>>>>
39717>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
39719>>>>>>>>>>>>>>>        set label to "&€¡ç¨à©ž" 
39720>>>>>>>>>>>>>>>        Set Location to 115 181
39721>>>>>>>>>>>>>>>
39721>>>>>>>>>>>>>>>        //AB-StoreStart
39721>>>>>>>>>>>>>>>        Procedure OnClick
39723>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
39724>>>>>>>>>>>>>>>        End_Procedure
39725>>>>>>>>>>>>>>>        //AB-StoreEnd
39725>>>>>>>>>>>>>>>
39725>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
39726>>>>>>>>>>>>>>>
39726>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
39728>>>>>>>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
39729>>>>>>>>>>>>>>>        Set Location to 115 236
39730>>>>>>>>>>>>>>>
39730>>>>>>>>>>>>>>>        //AB-StoreStart
39730>>>>>>>>>>>>>>>        Procedure OnClick
39732>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
39733>>>>>>>>>>>>>>>        End_Procedure
39734>>>>>>>>>>>>>>>        //AB-StoreEnd
39734>>>>>>>>>>>>>>>
39734>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
39735>>>>>>>>>>>>>>>
39735>>>>>>>>>>>>>>>
39735>>>>>>>>>>>>>>>    //AB-StoreStart
39735>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39736>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39737>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39738>>>>>>>>>>>>>>>    //AB-StoreEnd
39738>>>>>>>>>>>>>>>
39738>>>>>>>>>>>>>>>CD_End_Object    // sl022
39740>>>>>>>>>>>>>>>>
39740>>>>>>>>>>>>>>>
39740>>>>>>>>>>>>>>>//AB/ End_Object    // prj
39740>>>>>>>>>>>>>
39740>>>>>>>>>>>>>//DDB-Selection-pkg-End
39740>>>>>>>>>>>>>//DDB-FileEnd
39740>>>>>>>>>>>    Use WAPOMAST.DD
INCLUDING FILE: WAPOMAST.DD
39740>>>>>>>>>>>>>//DDB-FileStart
39740>>>>>>>>>>>>>//DDB-HeaderStart
39740>>>>>>>>>>>>>
39740>>>>>>>>>>>>>// File Name : WAPOMAST.DD
39740>>>>>>>>>>>>>// Class Name: Wapomast_DataDictionary
39740>>>>>>>>>>>>>// Revision  : 13
39740>>>>>>>>>>>>>// Version   : 2
39740>>>>>>>>>>>>>
39740>>>>>>>>>>>>>Use  Windows           // Basic Definitions
39740>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
39740>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39740>>>>>>>>>>>>>
39740>>>>>>>>>>>>>Open Wapomast
39742>>>>>>>>>>>>>Open Wax
INCLUDING FILE: WAX.FD
39744>>>>>>>>>>>>>Open Wapokat
39746>>>>>>>>>>>>>Open Sysrecw
39748>>>>>>>>>>>>>
39748>>>>>>>>>>>>>//DDB-HeaderEnd
39748>>>>>>>>>>>>>//DDB-SelectionStart
39748>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl023  sl023.SL
39748>>>>>>>>>>>>>Register_Object sl023
39748>>>>>>>>>>>>>//DDB-SelectionEnd
39748>>>>>>>>>>>>>
39748>>>>>>>>>>>>>Class Wapomast_DataDictionary  is a DataDictionary
39749>>>>>>>>>>>>>    // Update:
39749>>>>>>>>>>>>>    Procedure Update
39750>>>>>>>>>>>>>        Forward Send Update
39752>>>>>>>>>>>>>        // Insert Code Here
39752>>>>>>>>>>>>>//        Move SysCurXR.Company_Code   to Wapomast.Company_Code
39752>>>>>>>>>>>>>//        Move SysCurXR.Branch_Code     to Wapomast.Branch_Code
39752>>>>>>>>>>>>>//        Move SysCurXR.Year_Year         to Wapomast.Year_Year
39752>>>>>>>>>>>>>        Move Wapokat.Wapokat_Code   to Wapomast.Wapokat_Code
39753>>>>>>>>>>>>>    End_Procedure   // Update
39754>>>>>>>>>>>>> 
39754>>>>>>>>>>>>>     Procedure Creating
39755>>>>>>>>>>>>>        Forward Send Creating
39757>>>>>>>>>>>>>        // Insert Code Here
39757>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wapomast.Wapomast_Rec0)))))) to Wapomast.Wapomast_Recr
39758>>>>>>>>>>>>>    End_Procedure   // Creating
39759>>>>>>>>>>>>>
39759>>>>>>>>>>>>>
39759>>>>>>>>>>>>>    // Define_Fields:
39759>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39759>>>>>>>>>>>>>
39759>>>>>>>>>>>>>    Procedure Define_Fields
39760>>>>>>>>>>>>>        Forward Send Define_Fields
39762>>>>>>>>>>>>>        //DDB-Generated-Code-Location
39762>>>>>>>>>>>>>        //DDB-DefineFieldStart
39762>>>>>>>>>>>>>
39762>>>>>>>>>>>>>        Set Main_File            To Wapomast.File_Number
39763>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
39764>>>>>>>>>>>>>
39764>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39765>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39766>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39767>>>>>>>>>>>>>
39767>>>>>>>>>>>>>        // Child (Client) file structure................
39767>>>>>>>>>>>>>        Send Add_Client_File  Wax.File_Number
39768>>>>>>>>>>>>>
39768>>>>>>>>>>>>>        // Parent (Server) file structure...............
39768>>>>>>>>>>>>>        Send Add_Server_File  Wapokat.File_Number
39769>>>>>>>>>>>>>
39769>>>>>>>>>>>>>        // External (System) file structure.............
39769>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
39770>>>>>>>>>>>>>
39770>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Wapomast_Rec0  To Wapomast.Wapomast_Rec0
39773>>>>>>>>>>>>>
39773>>>>>>>>>>>>>        // Field-based properties.......................
39773>>>>>>>>>>>>>
39773>>>>>>>>>>>>>        // Wapomast.Wapokat_Code
39773>>>>>>>>>>>>>
39773>>>>>>>>>>>>>        // Wapomast.Wapokat_Recr
39773>>>>>>>>>>>>>
39773>>>>>>>>>>>>>        // Wapomast.Wapomast_Code
39773>>>>>>>>>>>>>        Set Field_Options          Field Wapomast.Wapomast_Code To DD_AUTOFIND   
39774>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Wapomast.Wapomast_Code To (sl023(Self))
39775>>>>>>>>>>>>>
39775>>>>>>>>>>>>>        // Wapomast.Wapomast_Rec0
39775>>>>>>>>>>>>>        Set Field_Options          Field Wapomast.Wapomast_Rec0 To DD_AUTOFIND   
39776>>>>>>>>>>>>>
39776>>>>>>>>>>>>>        // Wapomast.Wapomast_Descr
39776>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Wapomast.Wapomast_Descr To (sl023(Self))
39777>>>>>>>>>>>>>
39777>>>>>>>>>>>>>        // Wapomast.Wapomast_Recr
39777>>>>>>>>>>>>>        Set Field_Options          Field Wapomast.Wapomast_Recr To DD_AUTOFIND   
39778>>>>>>>>>>>>>
39778>>>>>>>>>>>>>        //DDB-DefineFieldEnd
39778>>>>>>>>>>>>>    End_Procedure    // Define_Fields
39779>>>>>>>>>>>>>
39779>>>>>>>>>>>>>    // Field_Defaults:
39779>>>>>>>>>>>>>    // This procedure is used to establish default field values.
39779>>>>>>>>>>>>>
39779>>>>>>>>>>>>>    Procedure Field_Defaults
39780>>>>>>>>>>>>>        Forward Send Field_Defaults
39782>>>>>>>>>>>>>        //DDB-Generated-Code-Location
39782>>>>>>>>>>>>>        //DDB-FieldDefaultStart
39782>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
39782>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
39783>>>>>>>>>>>>>
39783>>>>>>>>>>>>>End_Class    // Wapomast_DataDictionary
39784>>>>>>>>>>>>>//DDB-Selection-pkg-Start
39784>>>>>>>>>>>>>
39784>>>>>>>>>>>>>Use sl023.SL         // sl023
INCLUDING FILE: SL023.SL
39784>>>>>>>>>>>>>>>//AB/ Project sl023:apothkes
39784>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
39784>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl023:apothkes"
39784>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl023.SL"
39784>>>>>>>>>>>>>>>
39784>>>>>>>>>>>>>>>// Project Object Structure
39784>>>>>>>>>>>>>>>//   sl023 is a dbModalPanelSub
39784>>>>>>>>>>>>>>>//     Wapokat_DD is a DataDictionary
39784>>>>>>>>>>>>>>>//     Wapomast_DD is a DataDictionary
39784>>>>>>>>>>>>>>>//     oSelList is a dbListSub
39784>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
39784>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
39784>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
39784>>>>>>>>>>>>>>>
39784>>>>>>>>>>>>>>>// Register all objects
39784>>>>>>>>>>>>>>>Register_Object oCancel_bn
39784>>>>>>>>>>>>>>>Register_Object oOK_bn
39784>>>>>>>>>>>>>>>Register_Object oSearch_bn
39784>>>>>>>>>>>>>>>Register_Object oSelList
39784>>>>>>>>>>>>>>>Register_Object sl023
39784>>>>>>>>>>>>>>>Register_Object Wapokat_DD
39784>>>>>>>>>>>>>>>Register_Object Wapomast_DD
39784>>>>>>>>>>>>>>>
39784>>>>>>>>>>>>>>>
39784>>>>>>>>>>>>>>>//AB-IgnoreStart
39784>>>>>>>>>>>>>>>
39784>>>>>>>>>>>>>>>Use DFAllEnt.pkg
39784>>>>>>>>>>>>>>>Use dbList.Sub
39784>>>>>>>>>>>>>>>Use Button.Sub
39784>>>>>>>>>>>>>>>
39784>>>>>>>>>>>>>>>
39784>>>>>>>>>>>>>>>Use WAPOKAT.DD
39784>>>>>>>>>>>>>>>Use WAPOMAST.DD
39784>>>>>>>>>>>>>>>
39784>>>>>>>>>>>>>>>//AB-IgnoreEnd
39784>>>>>>>>>>>>>>>
39784>>>>>>>>>>>>>>>Object sl023 is a dbModalPanelSub
39786>>>>>>>>>>>>>>>
39786>>>>>>>>>>>>>>>    //AB-StoreTopStart
39786>>>>>>>>>>>>>>>    property string psapokat public ''
39788>>>>>>>>>>>>>>>    //AB-StoreTopEnd
39788>>>>>>>>>>>>>>>
39788>>>>>>>>>>>>>>>    Set Label to "€§¦Ÿã¡œª"
39789>>>>>>>>>>>>>>>    Set Size to 126 260
39790>>>>>>>>>>>>>>>    Set Location to 4 19
39791>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
39792>>>>>>>>>>>>>>>    Set Modal_State to FALSE
39793>>>>>>>>>>>>>>>
39793>>>>>>>>>>>>>>>    //AB-DDOStart
39793>>>>>>>>>>>>>>>
39793>>>>>>>>>>>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
39795>>>>>>>>>>>>>>>    End_Object    // Wapokat_DD
39796>>>>>>>>>>>>>>>
39796>>>>>>>>>>>>>>>    Object Wapomast_DD is a Wapomast_DataDictionary
39798>>>>>>>>>>>>>>>        Set DDO_Server to (Wapokat_DD(self))
39799>>>>>>>>>>>>>>>
39799>>>>>>>>>>>>>>>        //AB-StoreStart
39799>>>>>>>>>>>>>>>        
39799>>>>>>>>>>>>>>>        begin_constraints
39801>>>>>>>>>>>>>>>          if (psapokat(self) <> '') constrain wapomast.wapokat_code eq (psapokat(self))
39805>>>>>>>>>>>>>>>        
39805>>>>>>>>>>>>>>>        end_constraints
39808>>>>>>>>>>>>>>>        
39808>>>>>>>>>>>>>>>        //AB-StoreEnd
39808>>>>>>>>>>>>>>>
39808>>>>>>>>>>>>>>>    End_Object    // Wapomast_DD
39809>>>>>>>>>>>>>>>
39809>>>>>>>>>>>>>>>    Set Main_DD to (Wapomast_DD(self))
39810>>>>>>>>>>>>>>>    Set Server to (Wapomast_DD(self))
39811>>>>>>>>>>>>>>>
39811>>>>>>>>>>>>>>>    //AB-DDOEnd
39811>>>>>>>>>>>>>>>
39811>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
39813>>>>>>>>>>>>>>>        Set Main_File to Wapomast.File_Number
39814>>>>>>>>>>>>>>>        Set Server to (Wapokat_DD(self))
39815>>>>>>>>>>>>>>>        Set Size to 89 240
39816>>>>>>>>>>>>>>>        Set Location to 6 6
39817>>>>>>>>>>>>>>>
39817>>>>>>>>>>>>>>>        Begin_Row
39820>>>>>>>>>>>>>>>            Entry_Item Wapomast.Wapomast_code
39821>>>>>>>>>>>>>>>            Entry_Item Wapomast.Wapomast_descr
39822>>>>>>>>>>>>>>>        End_Row
39827>>>>>>>>>>>>>>>
39827>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 70
39828>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "€§¦Ÿã¡ž      :"
39829>>>>>>>>>>>>>>>        
39829>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 160
39830>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
39831>>>>>>>>>>>>>>>        
39831>>>>>>>>>>>>>>>
39831>>>>>>>>>>>>>>>        //AB-StoreStart
39831>>>>>>>>>>>>>>>                    
39831>>>>>>>>>>>>>>>                    
39831>>>>>>>>>>>>>>>        //AB-StoreEnd
39831>>>>>>>>>>>>>>>
39831>>>>>>>>>>>>>>>    End_Object    // oSelList
39832>>>>>>>>>>>>>>>
39832>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
39834>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
39835>>>>>>>>>>>>>>>        Set Location to 92 81
39836>>>>>>>>>>>>>>>
39836>>>>>>>>>>>>>>>        //AB-StoreStart
39836>>>>>>>>>>>>>>>        Procedure OnClick
39838>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
39839>>>>>>>>>>>>>>>        End_Procedure
39840>>>>>>>>>>>>>>>        //AB-StoreEnd
39840>>>>>>>>>>>>>>>
39840>>>>>>>>>>>>>>>    End_Object    // oOK_bn
39841>>>>>>>>>>>>>>>
39841>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
39843>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
39844>>>>>>>>>>>>>>>        Set Location to 92 135
39845>>>>>>>>>>>>>>>
39845>>>>>>>>>>>>>>>        //AB-StoreStart
39845>>>>>>>>>>>>>>>        Procedure OnClick
39847>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
39848>>>>>>>>>>>>>>>        End_Procedure
39849>>>>>>>>>>>>>>>        //AB-StoreEnd
39849>>>>>>>>>>>>>>>
39849>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
39850>>>>>>>>>>>>>>>
39850>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
39852>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
39853>>>>>>>>>>>>>>>        Set Location to 92 191
39854>>>>>>>>>>>>>>>
39854>>>>>>>>>>>>>>>        //AB-StoreStart
39854>>>>>>>>>>>>>>>        Procedure OnClick
39856>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
39857>>>>>>>>>>>>>>>        End_Procedure
39858>>>>>>>>>>>>>>>        //AB-StoreEnd
39858>>>>>>>>>>>>>>>
39858>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
39859>>>>>>>>>>>>>>>
39859>>>>>>>>>>>>>>>
39859>>>>>>>>>>>>>>>    //AB-StoreStart
39859>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39860>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39861>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39862>>>>>>>>>>>>>>>    
39862>>>>>>>>>>>>>>>    procedure activate
39864>>>>>>>>>>>>>>>        send rebuild_constraints to wapomast_dd
39865>>>>>>>>>>>>>>>        send beginning_of_data to osellist true
39866>>>>>>>>>>>>>>>        forward send activate
39868>>>>>>>>>>>>>>>    end_procedure
39869>>>>>>>>>>>>>>>    
39869>>>>>>>>>>>>>>>    
39869>>>>>>>>>>>>>>>    //AB-StoreEnd
39869>>>>>>>>>>>>>>>
39869>>>>>>>>>>>>>>>End_Object    // sl023
39870>>>>>>>>>>>>>>>
39870>>>>>>>>>>>>>>>//AB/ End_Object    // prj
39870>>>>>>>>>>>>>
39870>>>>>>>>>>>>>//DDB-Selection-pkg-End
39870>>>>>>>>>>>>>//DDB-FileEnd
39870>>>>>>>>>>>    Use WAX.DD
INCLUDING FILE: WAX.DD
39870>>>>>>>>>>>>>//DDB-FileStart
39870>>>>>>>>>>>>>//DDB-HeaderStart
39870>>>>>>>>>>>>>
39870>>>>>>>>>>>>>// File Name : WAX.DD
39870>>>>>>>>>>>>>// Class Name: Wax_DataDictionary
39870>>>>>>>>>>>>>// Revision  : 39
39870>>>>>>>>>>>>>// Version   : 2
39870>>>>>>>>>>>>>
39870>>>>>>>>>>>>>Use  Windows           // Basic Definitions
39870>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
39870>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39870>>>>>>>>>>>>>
39870>>>>>>>>>>>>>Open Wax
39872>>>>>>>>>>>>>Open Pmoves
39874>>>>>>>>>>>>>Open Wcmoves
39876>>>>>>>>>>>>>Open Wam
INCLUDING FILE: WAM.FD
39878>>>>>>>>>>>>>Open Pmovesl
39880>>>>>>>>>>>>>Open Wapomast
39882>>>>>>>>>>>>>Open Sysrecw
39884>>>>>>>>>>>>>Open Syscurxr
39886>>>>>>>>>>>>>
39886>>>>>>>>>>>>>//DDB-HeaderEnd
39886>>>>>>>>>>>>>//DDB-SelectionStart
39886>>>>>>>>>>>>>//DDB/ ExternalSelectionList Wax  Wax.SL
39886>>>>>>>>>>>>>Register_Object Wax
39886>>>>>>>>>>>>>//DDB-SelectionEnd
39886>>>>>>>>>>>>>
39886>>>>>>>>>>>>>Class Wax_DataDictionary  is a DataDictionary_Sec
39887>>>>>>>>>>>>>
39887>>>>>>>>>>>>>    Procedure Construct_Object
39888>>>>>>>>>>>>>        Forward Send Construct_Object
39890>>>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
39891>>>>>>>>>>>>>    End_Procedure //construct_object
39892>>>>>>>>>>>>>
39892>>>>>>>>>>>>>    Procedure OnConstrain
39893>>>>>>>>>>>>>        Forward Send OnConstrain
39895>>>>>>>>>>>>>        If (piMustNOTConstrain(Self)) Begin
39897>>>>>>>>>>>>>        End
39897>>>>>>>>>>>>>>
39897>>>>>>>>>>>>>        Else Begin
39898>>>>>>>>>>>>>            Constrain Wax.Company_Code  eq SysCurXR.Company_Code
39900>>>>>>>>>>>>>            Constrain Wax.Branch_Code   eq SysCurXR.Branch_Code
39902>>>>>>>>>>>>>            Constrain Wax.Year_Year     eq SysCurXR.Year_Year
39904>>>>>>>>>>>>>        End
39904>>>>>>>>>>>>>>
39904>>>>>>>>>>>>>    End_Procedure
39905>>>>>>>>>>>>>
39905>>>>>>>>>>>>>
39905>>>>>>>>>>>>>    // Update:
39905>>>>>>>>>>>>>    Procedure Update
39906>>>>>>>>>>>>>        Forward Send Update
39908>>>>>>>>>>>>>        // Insert Code Here
39908>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to Wax.Company_Code
39909>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Wax.Branch_Code
39910>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to Wax.Year_Year
39911>>>>>>>>>>>>>        Move SysCurXR.Year_Recr     to Wax.Year_Recr
39912>>>>>>>>>>>>>        Move Wapokat.Wapokat_Code   to Wax.Wapokat_Code
39913>>>>>>>>>>>>>        Move Wapomast.Wapomast_Code to Wax.Wapomast_Code
39914>>>>>>>>>>>>>    End_Procedure   // Update
39915>>>>>>>>>>>>>
39915>>>>>>>>>>>>>     Procedure Creating
39916>>>>>>>>>>>>>        Forward Send Creating
39918>>>>>>>>>>>>>        // Insert Code Here
39918>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wax.Wax_Rec0)))))) to Wax.Wax_Recr
39919>>>>>>>>>>>>>    End_Procedure   // Creating
39920>>>>>>>>>>>>>
39920>>>>>>>>>>>>>
39920>>>>>>>>>>>>>
39920>>>>>>>>>>>>>    // Define_Fields:
39920>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39920>>>>>>>>>>>>>
39920>>>>>>>>>>>>>    Procedure Define_Fields
39921>>>>>>>>>>>>>        Forward Send Define_Fields
39923>>>>>>>>>>>>>        //DDB-Generated-Code-Location
39923>>>>>>>>>>>>>        //DDB-DefineFieldStart
39923>>>>>>>>>>>>>
39923>>>>>>>>>>>>>        Set Main_File            To Wax.File_Number
39924>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
39925>>>>>>>>>>>>>
39925>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39926>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39927>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39928>>>>>>>>>>>>>
39928>>>>>>>>>>>>>        // Child (Client) file structure................
39928>>>>>>>>>>>>>        Send Add_Client_File  Pmoves.File_Number
39929>>>>>>>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
39930>>>>>>>>>>>>>        Send Add_Client_File  Wam.File_Number
39931>>>>>>>>>>>>>        Send Add_Client_File  Pmovesl.File_Number
39932>>>>>>>>>>>>>
39932>>>>>>>>>>>>>        // Parent (Server) file structure...............
39932>>>>>>>>>>>>>        Send Add_Server_File  Wapomast.File_Number
39933>>>>>>>>>>>>>
39933>>>>>>>>>>>>>        // External (System) file structure.............
39933>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
39934>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
39935>>>>>>>>>>>>>
39935>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Wax_Rec0  To Wax.Wax_Rec0
39938>>>>>>>>>>>>>
39938>>>>>>>>>>>>>        // Field-based properties.......................
39938>>>>>>>>>>>>>
39938>>>>>>>>>>>>>        // Wax.Company_Code
39938>>>>>>>>>>>>>
39938>>>>>>>>>>>>>        // Wax.Branch_Code
39938>>>>>>>>>>>>>
39938>>>>>>>>>>>>>        // Wax.Year_Year
39938>>>>>>>>>>>>>
39938>>>>>>>>>>>>>        // Wax.Wapokat_Code
39938>>>>>>>>>>>>>
39938>>>>>>>>>>>>>        // Wax.Wapomast_Code
39938>>>>>>>>>>>>>
39938>>>>>>>>>>>>>        // Wax.Wax_Code
39938>>>>>>>>>>>>>        Set Field_Options          Field Wax.Wax_Code To DD_AUTOFIND   
39939>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Code To (Wax(Self))
39940>>>>>>>>>>>>>
39940>>>>>>>>>>>>>        // Wax.Year_Recr
39940>>>>>>>>>>>>>
39940>>>>>>>>>>>>>        // Wax.Wapomast_Recr
39940>>>>>>>>>>>>>
39940>>>>>>>>>>>>>        // Wax.Wax_Rec0
39940>>>>>>>>>>>>>        Set Field_Options          Field Wax.Wax_Rec0 To DD_AUTOFIND   
39941>>>>>>>>>>>>>
39941>>>>>>>>>>>>>        // Wax.Wax_Recr
39941>>>>>>>>>>>>>        Set Field_Options          Field Wax.Wax_Recr To DD_AUTOFIND   
39942>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Recr To (Wax(Self))
39943>>>>>>>>>>>>>
39943>>>>>>>>>>>>>        // Wax.Wax_Descr
39943>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Descr To (Wax(Self))
39944>>>>>>>>>>>>>
39944>>>>>>>>>>>>>        //DDB-DefineFieldEnd
39944>>>>>>>>>>>>>    End_Procedure    // Define_Fields
39945>>>>>>>>>>>>>
39945>>>>>>>>>>>>>    // Field_Defaults:
39945>>>>>>>>>>>>>    // This procedure is used to establish default field values.
39945>>>>>>>>>>>>>
39945>>>>>>>>>>>>>    Procedure Field_Defaults
39946>>>>>>>>>>>>>        Forward Send Field_Defaults
39948>>>>>>>>>>>>>        //DDB-Generated-Code-Location
39948>>>>>>>>>>>>>        //DDB-FieldDefaultStart
39948>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
39948>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
39949>>>>>>>>>>>>>
39949>>>>>>>>>>>>>End_Class    // Wax_DataDictionary
39950>>>>>>>>>>>>>//DDB-Selection-pkg-Start
39950>>>>>>>>>>>>>
39950>>>>>>>>>>>>>Use Wax.SL           // Wax
INCLUDING FILE: WAX.SL
39950>>>>>>>>>>>>>>>//AB/ Project Wax:Lookup Apothikhs
39950>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
39950>>>>>>>>>>>>>>>//AB/     Set ProjectName to "Wax:Lookup Apothikhs"
39950>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "Wax.SL"
39950>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
39950>>>>>>>>>>>>>>>
39950>>>>>>>>>>>>>>>// Project Object Structure
39950>>>>>>>>>>>>>>>//   Wax is a dbModalPanelSub
39950>>>>>>>>>>>>>>>//     Wapokat_DD is a DataDictionary
39950>>>>>>>>>>>>>>>//     Wapomast_DD is a DataDictionary
39950>>>>>>>>>>>>>>>//     Wax_DD is a DataDictionary
39950>>>>>>>>>>>>>>>//     oSelList is a dbListSub
39950>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
39950>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
39950>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
39950>>>>>>>>>>>>>>>
39950>>>>>>>>>>>>>>>// Register all objects
39950>>>>>>>>>>>>>>>Register_Object oCancel_bn
39950>>>>>>>>>>>>>>>Register_Object oOK_bn
39950>>>>>>>>>>>>>>>Register_Object oSearch_bn
39950>>>>>>>>>>>>>>>Register_Object oSelList
39950>>>>>>>>>>>>>>>Register_Object Wapokat_DD
39950>>>>>>>>>>>>>>>Register_Object Wapomast_DD
39950>>>>>>>>>>>>>>>Register_Object Wax
39950>>>>>>>>>>>>>>>Register_Object Wax_DD
39950>>>>>>>>>>>>>>>
39950>>>>>>>>>>>>>>>
39950>>>>>>>>>>>>>>>//AB-IgnoreStart
39950>>>>>>>>>>>>>>>
39950>>>>>>>>>>>>>>>Use DFAllEnt.pkg
39950>>>>>>>>>>>>>>>Use dbList.Sub
39950>>>>>>>>>>>>>>>Use Button.Sub
39950>>>>>>>>>>>>>>>
39950>>>>>>>>>>>>>>>
39950>>>>>>>>>>>>>>>Use WAPOKAT.DD
39950>>>>>>>>>>>>>>>Use WAPOMAST.DD
39950>>>>>>>>>>>>>>>Use WAX.DD
39950>>>>>>>>>>>>>>>
39950>>>>>>>>>>>>>>>//AB-IgnoreEnd
39950>>>>>>>>>>>>>>>
39950>>>>>>>>>>>>>>>Object Wax is a dbModalPanelSub
39952>>>>>>>>>>>>>>>
39952>>>>>>>>>>>>>>>    //AB-StoreTopStart
39952>>>>>>>>>>>>>>>                                    
39952>>>>>>>>>>>>>>>    Property Integer    piMustConstrain Public  0
39954>>>>>>>>>>>>>>>    Property Integer    piYear          Public  0
39956>>>>>>>>>>>>>>>    Property String     psCompany       Public ''
39958>>>>>>>>>>>>>>>    Property String     psBranch        Public ''
39960>>>>>>>>>>>>>>>    Property String     psWapokat       Public ''
39962>>>>>>>>>>>>>>>    
39962>>>>>>>>>>>>>>>    //AB-StoreTopEnd
39962>>>>>>>>>>>>>>>
39962>>>>>>>>>>>>>>>    Set Label to "‰˜«á¢¦š¦ª €§¦Ÿž¡é¤"
39963>>>>>>>>>>>>>>>    Set Size to 148 355
39964>>>>>>>>>>>>>>>    Set Location to 8 21
39965>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
39966>>>>>>>>>>>>>>>    Set Modal_State to FALSE
39967>>>>>>>>>>>>>>>
39967>>>>>>>>>>>>>>>    //AB-DDOStart
39967>>>>>>>>>>>>>>>
39967>>>>>>>>>>>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
39969>>>>>>>>>>>>>>>    End_Object    // Wapokat_DD
39970>>>>>>>>>>>>>>>
39970>>>>>>>>>>>>>>>    Object Wapomast_DD is a Wapomast_DataDictionary
39972>>>>>>>>>>>>>>>        Set DDO_Server to (Wapokat_DD(self))
39973>>>>>>>>>>>>>>>    End_Object    // Wapomast_DD
39974>>>>>>>>>>>>>>>
39974>>>>>>>>>>>>>>>    Object Wax_DD is a Wax_DataDictionary
39976>>>>>>>>>>>>>>>        Set DDO_Server to (Wapomast_DD(self))
39977>>>>>>>>>>>>>>>
39977>>>>>>>>>>>>>>>        //AB-StoreStart
39977>>>>>>>>>>>>>>>        
39977>>>>>>>>>>>>>>>        Begin_Constraints
39979>>>>>>>>>>>>>>>            Integer iMustConstrain iYear
39980>>>>>>>>>>>>>>>            String  sCompany sBranch sWapokat
39980>>>>>>>>>>>>>>>            Get piMustConstrain to iMustConstrain
39981>>>>>>>>>>>>>>>            If (iMustConstrain) Begin
39983>>>>>>>>>>>>>>>                Get piYear     to  iYear
39984>>>>>>>>>>>>>>>                Get psCompany  to  sCompany
39985>>>>>>>>>>>>>>>                Get psBranch   to  sBranch
39986>>>>>>>>>>>>>>>                Get psWapokat  to  sWapokat
39987>>>>>>>>>>>>>>>                If (sCompany<>'') Begin
39989>>>>>>>>>>>>>>>                    Constrain Wax.Company_Code eq sCompany
39991>>>>>>>>>>>>>>>                    If (sBranch<>'') Begin
39993>>>>>>>>>>>>>>>                        Constrain Wax.Branch_Code eq sBranch
39995>>>>>>>>>>>>>>>                        If (iYear<>0) Begin
39997>>>>>>>>>>>>>>>                            Constrain Wax.Year_Year eq iYear
39999>>>>>>>>>>>>>>>                            If (sWapokat<>'') Begin
40001>>>>>>>>>>>>>>>                                Constrain Wax.Wapokat_Code eq sWapokat
40003>>>>>>>>>>>>>>>                            End
40003>>>>>>>>>>>>>>>>
40003>>>>>>>>>>>>>>>                        End
40003>>>>>>>>>>>>>>>>
40003>>>>>>>>>>>>>>>                    End
40003>>>>>>>>>>>>>>>>
40003>>>>>>>>>>>>>>>                End
40003>>>>>>>>>>>>>>>>
40003>>>>>>>>>>>>>>>            End
40003>>>>>>>>>>>>>>>>
40003>>>>>>>>>>>>>>>        End_Constraints
40006>>>>>>>>>>>>>>>        
40006>>>>>>>>>>>>>>>        
40006>>>>>>>>>>>>>>>        
40006>>>>>>>>>>>>>>>        
40006>>>>>>>>>>>>>>>        
40006>>>>>>>>>>>>>>>        
40006>>>>>>>>>>>>>>>        //AB-StoreEnd
40006>>>>>>>>>>>>>>>
40006>>>>>>>>>>>>>>>    End_Object    // Wax_DD
40007>>>>>>>>>>>>>>>
40007>>>>>>>>>>>>>>>    Set Main_DD to (Wax_DD(self))
40008>>>>>>>>>>>>>>>    Set Server to (Wax_DD(self))
40009>>>>>>>>>>>>>>>
40009>>>>>>>>>>>>>>>    //AB-DDOEnd
40009>>>>>>>>>>>>>>>
40009>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
40011>>>>>>>>>>>>>>>        Set Main_File to Wax.File_Number
40012>>>>>>>>>>>>>>>        Set Size to 105 340
40013>>>>>>>>>>>>>>>        Set Location to 5 6
40014>>>>>>>>>>>>>>>
40014>>>>>>>>>>>>>>>        Begin_Row
40017>>>>>>>>>>>>>>>            Entry_Item Wax.Wax_recr
40018>>>>>>>>>>>>>>>            Entry_Item Wax.Wax_code
40019>>>>>>>>>>>>>>>            Entry_Item Wax.Wax_descr
40020>>>>>>>>>>>>>>>        End_Row
40025>>>>>>>>>>>>>>>
40025>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 33
40026>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "Recr"
40027>>>>>>>>>>>>>>>        
40027>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 80
40028>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "‰à› ¡æª"
40029>>>>>>>>>>>>>>>        
40029>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 219
40030>>>>>>>>>>>>>>>        Set Header_Label  item 2 to "œ¨ š¨˜­ã"
40031>>>>>>>>>>>>>>>        
40031>>>>>>>>>>>>>>>
40031>>>>>>>>>>>>>>>        //AB-StoreStart
40031>>>>>>>>>>>>>>>        
40031>>>>>>>>>>>>>>>        Procedure Activate
40033>>>>>>>>>>>>>>>            Send Rebuild_Constraints to Wax_DD
40034>>>>>>>>>>>>>>>            Send Beginning_Of_Data to oSelList True
40035>>>>>>>>>>>>>>>            Forward Send Activate
40037>>>>>>>>>>>>>>>        End_procedure
40038>>>>>>>>>>>>>>>        
40038>>>>>>>>>>>>>>>        //AB-StoreEnd
40038>>>>>>>>>>>>>>>
40038>>>>>>>>>>>>>>>    End_Object    // oSelList
40039>>>>>>>>>>>>>>>
40039>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
40041>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
40042>>>>>>>>>>>>>>>        Set Location to 113 186
40043>>>>>>>>>>>>>>>
40043>>>>>>>>>>>>>>>        //AB-StoreStart
40043>>>>>>>>>>>>>>>        Procedure OnClick
40045>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
40046>>>>>>>>>>>>>>>        End_Procedure
40047>>>>>>>>>>>>>>>        //AB-StoreEnd
40047>>>>>>>>>>>>>>>
40047>>>>>>>>>>>>>>>    End_Object    // oOK_bn
40048>>>>>>>>>>>>>>>
40048>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
40050>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
40051>>>>>>>>>>>>>>>        Set Location to 113 241
40052>>>>>>>>>>>>>>>
40052>>>>>>>>>>>>>>>        //AB-StoreStart
40052>>>>>>>>>>>>>>>        Procedure OnClick
40054>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
40055>>>>>>>>>>>>>>>        End_Procedure
40056>>>>>>>>>>>>>>>        //AB-StoreEnd
40056>>>>>>>>>>>>>>>
40056>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
40057>>>>>>>>>>>>>>>
40057>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
40059>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
40060>>>>>>>>>>>>>>>        Set Location to 113 296
40061>>>>>>>>>>>>>>>
40061>>>>>>>>>>>>>>>        //AB-StoreStart
40061>>>>>>>>>>>>>>>        Procedure OnClick
40063>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
40064>>>>>>>>>>>>>>>        End_Procedure
40065>>>>>>>>>>>>>>>        //AB-StoreEnd
40065>>>>>>>>>>>>>>>
40065>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
40066>>>>>>>>>>>>>>>
40066>>>>>>>>>>>>>>>
40066>>>>>>>>>>>>>>>    //AB-StoreStart
40066>>>>>>>>>>>>>>>                                    
40066>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
40067>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
40068>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
40069>>>>>>>>>>>>>>>    
40069>>>>>>>>>>>>>>>    
40069>>>>>>>>>>>>>>>    
40069>>>>>>>>>>>>>>>    
40069>>>>>>>>>>>>>>>    
40069>>>>>>>>>>>>>>>    
40069>>>>>>>>>>>>>>>    //AB-StoreEnd
40069>>>>>>>>>>>>>>>
40069>>>>>>>>>>>>>>>End_Object    // Wax
40070>>>>>>>>>>>>>>>
40070>>>>>>>>>>>>>>>//AB/ End_Object    // prj
40070>>>>>>>>>>>>>
40070>>>>>>>>>>>>>//DDB-Selection-pkg-End
40070>>>>>>>>>>>>>//DDB-FileEnd
40070>>>>>>>>>>>    Use UNITS.DD
INCLUDING FILE: UNITS.DD
40070>>>>>>>>>>>>>//DDB-FileStart
40070>>>>>>>>>>>>>//DDB-HeaderStart
40070>>>>>>>>>>>>>
40070>>>>>>>>>>>>>// File Name : UNITS.DD
40070>>>>>>>>>>>>>// Class Name: Units_DataDictionary
40070>>>>>>>>>>>>>// Revision  : 17
40070>>>>>>>>>>>>>// Version   : 2
40070>>>>>>>>>>>>>
40070>>>>>>>>>>>>>Use  Windows           // Basic Definitions
40070>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
40070>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
40070>>>>>>>>>>>>>
40070>>>>>>>>>>>>>Open Units
INCLUDING FILE: UNITS.FD
40072>>>>>>>>>>>>>Open Item
INCLUDING FILE: ITEM.FD
40074>>>>>>>>>>>>>Open Sysrecw
40076>>>>>>>>>>>>>Open Syscurxr
40078>>>>>>>>>>>>>
40078>>>>>>>>>>>>>//DDB-HeaderEnd
40078>>>>>>>>>>>>>//DDB-SelectionStart
40078>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl025  sl025.SL
40078>>>>>>>>>>>>>Register_Object sl025
40078>>>>>>>>>>>>>//DDB-SelectionEnd
40078>>>>>>>>>>>>>
40078>>>>>>>>>>>>>Class Units_DataDictionary  is a DataDictionary
40079>>>>>>>>>>>>>
40079>>>>>>>>>>>>>    Procedure Save_Main_File
40080>>>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
40082>>>>>>>>>>>>>            If Units.Recnum Eq 0 Procedure_Return
40085>>>>>>>>>>>>>        End
40085>>>>>>>>>>>>>>
40085>>>>>>>>>>>>>        Forward Send Save_Main_File
40087>>>>>>>>>>>>>    End_Procedure
40088>>>>>>>>>>>>>
40088>>>>>>>>>>>>>
40088>>>>>>>>>>>>>     Procedure Creating
40089>>>>>>>>>>>>>        Forward Send Creating
40091>>>>>>>>>>>>>        // Insert Code Here
40091>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Units.Units_Rec0)))))) to Units.Units_Recr
40092>>>>>>>>>>>>>    End_Procedure   // Creating
40093>>>>>>>>>>>>>
40093>>>>>>>>>>>>>
40093>>>>>>>>>>>>>
40093>>>>>>>>>>>>>    // Define_Fields:
40093>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
40093>>>>>>>>>>>>>
40093>>>>>>>>>>>>>    Procedure Define_Fields
40094>>>>>>>>>>>>>        Forward Send Define_Fields
40096>>>>>>>>>>>>>        //DDB-Generated-Code-Location
40096>>>>>>>>>>>>>        //DDB-DefineFieldStart
40096>>>>>>>>>>>>>
40096>>>>>>>>>>>>>        Set Main_File            To Units.File_Number
40097>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
40098>>>>>>>>>>>>>
40098>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
40099>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
40100>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
40101>>>>>>>>>>>>>
40101>>>>>>>>>>>>>        // Child (Client) file structure................
40101>>>>>>>>>>>>>        Send Add_Client_File  Item.File_Number
40102>>>>>>>>>>>>>
40102>>>>>>>>>>>>>        // External (System) file structure.............
40102>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
40103>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
40104>>>>>>>>>>>>>
40104>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Units_Rec0  To Units.Units_Rec0
40107>>>>>>>>>>>>>
40107>>>>>>>>>>>>>        // Field-based properties.......................
40107>>>>>>>>>>>>>
40107>>>>>>>>>>>>>        // Units.Units_Code
40107>>>>>>>>>>>>>        Set Field_Options          Field Units.Units_Code To DD_AUTOFIND   
40108>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Units.Units_Code To (sl025(Self))
40109>>>>>>>>>>>>>
40109>>>>>>>>>>>>>        // Units.Units_Rec0
40109>>>>>>>>>>>>>        Set Field_Options          Field Units.Units_Rec0 To DD_AUTOFIND   
40110>>>>>>>>>>>>>
40110>>>>>>>>>>>>>        // Units.Units_Descr
40110>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Units.Units_Descr To (sl025(Self))
40111>>>>>>>>>>>>>
40111>>>>>>>>>>>>>        // Units.Units_Recr
40111>>>>>>>>>>>>>        Set Field_Options          Field Units.Units_Recr To DD_AUTOFIND   
40112>>>>>>>>>>>>>
40112>>>>>>>>>>>>>        //DDB-DefineFieldEnd
40112>>>>>>>>>>>>>    End_Procedure    // Define_Fields
40113>>>>>>>>>>>>>
40113>>>>>>>>>>>>>    // Field_Defaults:
40113>>>>>>>>>>>>>    // This procedure is used to establish default field values.
40113>>>>>>>>>>>>>
40113>>>>>>>>>>>>>    Procedure Field_Defaults
40114>>>>>>>>>>>>>        Forward Send Field_Defaults
40116>>>>>>>>>>>>>        //DDB-Generated-Code-Location
40116>>>>>>>>>>>>>        //DDB-FieldDefaultStart
40116>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
40116>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
40117>>>>>>>>>>>>>
40117>>>>>>>>>>>>>End_Class    // Units_DataDictionary
40118>>>>>>>>>>>>>//DDB-Selection-pkg-Start
40118>>>>>>>>>>>>>
40118>>>>>>>>>>>>>Use sl025.SL         // sl025
INCLUDING FILE: SL025.SL
40118>>>>>>>>>>>>>>>//AB/ Project sl025
40118>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
40118>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl025"
40118>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl025.SL"
40118>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
40118>>>>>>>>>>>>>>>
40118>>>>>>>>>>>>>>>// Project Object Structure
40118>>>>>>>>>>>>>>>//   sl025 is a dbModalPanelSub
40118>>>>>>>>>>>>>>>//     Units_DD is a DataDictionary
40118>>>>>>>>>>>>>>>//     oSelList is a dbListSub
40118>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
40118>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
40118>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
40118>>>>>>>>>>>>>>>
40118>>>>>>>>>>>>>>>// Register all objects
40118>>>>>>>>>>>>>>>Register_Object oCancel_bn
40118>>>>>>>>>>>>>>>Register_Object oOK_bn
40118>>>>>>>>>>>>>>>Register_Object oSearch_bn
40118>>>>>>>>>>>>>>>Register_Object oSelList
40118>>>>>>>>>>>>>>>Register_Object sl025
40118>>>>>>>>>>>>>>>Register_Object Units_DD
40118>>>>>>>>>>>>>>>
40118>>>>>>>>>>>>>>>
40118>>>>>>>>>>>>>>>//AB-IgnoreStart
40118>>>>>>>>>>>>>>>
40118>>>>>>>>>>>>>>>Use DFAllEnt.pkg
40118>>>>>>>>>>>>>>>Use dbList.Sub
40118>>>>>>>>>>>>>>>Use Button.Sub
40118>>>>>>>>>>>>>>>
40118>>>>>>>>>>>>>>>
40118>>>>>>>>>>>>>>>Use UNITS.DD
40118>>>>>>>>>>>>>>>
40118>>>>>>>>>>>>>>>//AB-IgnoreEnd
40118>>>>>>>>>>>>>>>
40118>>>>>>>>>>>>>>>Object sl025 is a dbModalPanelSub
40120>>>>>>>>>>>>>>>    set label to "‹¦¤á›œª ‹â«¨ž©žª" 
40121>>>>>>>>>>>>>>>    Set Size to 148 297
40122>>>>>>>>>>>>>>>    Set Location to 4 5
40123>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
40124>>>>>>>>>>>>>>>    Set Modal_State to FALSE
40125>>>>>>>>>>>>>>>
40125>>>>>>>>>>>>>>>    //AB-DDOStart
40125>>>>>>>>>>>>>>>
40125>>>>>>>>>>>>>>>    Object Units_DD is a Units_DataDictionary
40127>>>>>>>>>>>>>>>    End_Object    // Units_DD
40128>>>>>>>>>>>>>>>
40128>>>>>>>>>>>>>>>    Set Main_DD to (Units_DD(self))
40129>>>>>>>>>>>>>>>    Set Server to (Units_DD(self))
40130>>>>>>>>>>>>>>>
40130>>>>>>>>>>>>>>>    //AB-DDOEnd
40130>>>>>>>>>>>>>>>
40130>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
40132>>>>>>>>>>>>>>>        set main_file to units.file_number 
40133>>>>>>>>>>>>>>>        Set Size to 105 280
40134>>>>>>>>>>>>>>>        Set Location to 6 6
40135>>>>>>>>>>>>>>>
40135>>>>>>>>>>>>>>>        Begin_Row
40138>>>>>>>>>>>>>>>            entry_item units.units_code 
40139>>>>>>>>>>>>>>>            entry_item units.units_descr 
40140>>>>>>>>>>>>>>>        End_Row
40145>>>>>>>>>>>>>>>
40145>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 91
40146>>>>>>>>>>>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
40147>>>>>>>>>>>>>>>        
40147>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 180
40148>>>>>>>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
40149>>>>>>>>>>>>>>>        
40149>>>>>>>>>>>>>>>    End_Object    // oSelList
40150>>>>>>>>>>>>>>>
40150>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
40152>>>>>>>>>>>>>>>        set label to "&„§ ¢¦šã" 
40153>>>>>>>>>>>>>>>        Set Location to 115 126
40154>>>>>>>>>>>>>>>
40154>>>>>>>>>>>>>>>        //AB-StoreStart
40154>>>>>>>>>>>>>>>        Procedure OnClick
40156>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
40157>>>>>>>>>>>>>>>        End_Procedure
40158>>>>>>>>>>>>>>>        //AB-StoreEnd
40158>>>>>>>>>>>>>>>
40158>>>>>>>>>>>>>>>    End_Object    // oOK_bn
40159>>>>>>>>>>>>>>>
40159>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
40161>>>>>>>>>>>>>>>        set label to "&€¡ç¨à©ž" 
40162>>>>>>>>>>>>>>>        Set Location to 115 181
40163>>>>>>>>>>>>>>>
40163>>>>>>>>>>>>>>>        //AB-StoreStart
40163>>>>>>>>>>>>>>>        Procedure OnClick
40165>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
40166>>>>>>>>>>>>>>>        End_Procedure
40167>>>>>>>>>>>>>>>        //AB-StoreEnd
40167>>>>>>>>>>>>>>>
40167>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
40168>>>>>>>>>>>>>>>
40168>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
40170>>>>>>>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
40171>>>>>>>>>>>>>>>        Set Location to 115 236
40172>>>>>>>>>>>>>>>
40172>>>>>>>>>>>>>>>        //AB-StoreStart
40172>>>>>>>>>>>>>>>        Procedure OnClick
40174>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
40175>>>>>>>>>>>>>>>        End_Procedure
40176>>>>>>>>>>>>>>>        //AB-StoreEnd
40176>>>>>>>>>>>>>>>
40176>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
40177>>>>>>>>>>>>>>>
40177>>>>>>>>>>>>>>>
40177>>>>>>>>>>>>>>>    //AB-StoreStart
40177>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
40178>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
40179>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
40180>>>>>>>>>>>>>>>    //AB-StoreEnd
40180>>>>>>>>>>>>>>>
40180>>>>>>>>>>>>>>>End_Object    // sl025
40181>>>>>>>>>>>>>>>
40181>>>>>>>>>>>>>>>//AB/ End_Object    // prj
40181>>>>>>>>>>>>>
40181>>>>>>>>>>>>>//DDB-Selection-pkg-End
40181>>>>>>>>>>>>>//DDB-FileEnd
40181>>>>>>>>>>>    Use WITEMKAT.DD
INCLUDING FILE: WITEMKAT.DD
40181>>>>>>>>>>>>>//DDB-FileStart
40181>>>>>>>>>>>>>//DDB-HeaderStart
40181>>>>>>>>>>>>>
40181>>>>>>>>>>>>>// File Name : WITEMKAT.DD
40181>>>>>>>>>>>>>// Class Name: Witemkat_DataDictionary
40181>>>>>>>>>>>>>// Revision  : 25
40181>>>>>>>>>>>>>// Version   : 2
40181>>>>>>>>>>>>>
40181>>>>>>>>>>>>>Use  Windows           // Basic Definitions
40181>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
40181>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
40181>>>>>>>>>>>>>
40181>>>>>>>>>>>>>Open Witemkat
INCLUDING FILE: WITEMKAT.FD
40183>>>>>>>>>>>>>Open Item
40185>>>>>>>>>>>>>Open Sysrecw
40187>>>>>>>>>>>>>Open Syscurxr
40189>>>>>>>>>>>>>
40189>>>>>>>>>>>>>//DDB-HeaderEnd
40189>>>>>>>>>>>>>//DDB-SelectionStart
40189>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl024  sl024.SL
40189>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl150  sl150.SL
40189>>>>>>>>>>>>>Register_Object sl024
40189>>>>>>>>>>>>>Register_Object sl150
40189>>>>>>>>>>>>>//DDB-SelectionEnd
40189>>>>>>>>>>>>>
40189>>>>>>>>>>>>>Class Witemkat_DataDictionary  is a DataDictionary
40190>>>>>>>>>>>>>
40190>>>>>>>>>>>>>     Procedure Creating
40191>>>>>>>>>>>>>        Forward Send Creating
40193>>>>>>>>>>>>>        // Insert Code Here
40193>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(WitemKat.WitemKat_Rec0)))))) to WitemKat.WitemKat_Recr
40194>>>>>>>>>>>>>    End_Procedure   // Creating
40195>>>>>>>>>>>>>   
40195>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
40196>>>>>>>>>>>>>        Local Integer iReturnVal icheck
40197>>>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
40199>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
40201>>>>>>>>>>>>>            // Insert Code Here
40201>>>>>>>>>>>>>//           if (witemkat.codegl <> '') begin
40201>>>>>>>>>>>>>//              Move (Check_log(witemkat.codegl)) to iCheck  
40201>>>>>>>>>>>>>//              if (icheck) Move 24001 to iReturnVal 
40201>>>>>>>>>>>>>//           end
40201>>>>>>>>>>>>>           If (iReturnVal) Send Operation_Not_Allowed iReturnVal
40204>>>>>>>>>>>>>        End
40204>>>>>>>>>>>>>>
40204>>>>>>>>>>>>>        Function_Return iReturnVal
40205>>>>>>>>>>>>>    End_Function   // Validate_Save
40206>>>>>>>>>>>>> 
40206>>>>>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
40207>>>>>>>>>>>>>        String lsError_Message
40208>>>>>>>>>>>>>        Case Begin
40208>>>>>>>>>>>>>            Case (iError_Num = 24001)
40210>>>>>>>>>>>>>                Move "DDC 24: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ¡˜«žš¦¨å˜ª œå›¦¬ª" to lsError_Message
40211>>>>>>>>>>>>>              Case Break
40212>>>>>>>>>>>>>            Case Else
40212>>>>>>>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
40214>>>>>>>>>>>>>        Case End
40214>>>>>>>>>>>>>        Error iError_Num lsError_Message
40215>>>>>>>>>>>>>>
40215>>>>>>>>>>>>>    End_Procedure // operation_not_allowed
40216>>>>>>>>>>>>>
40216>>>>>>>>>>>>>
40216>>>>>>>>>>>>>
40216>>>>>>>>>>>>>    // Define_Fields:
40216>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
40216>>>>>>>>>>>>>
40216>>>>>>>>>>>>>    Procedure Define_Fields
40217>>>>>>>>>>>>>        Forward Send Define_Fields
40219>>>>>>>>>>>>>        //DDB-Generated-Code-Location
40219>>>>>>>>>>>>>        //DDB-DefineFieldStart
40219>>>>>>>>>>>>>
40219>>>>>>>>>>>>>        Set Main_File            To Witemkat.File_Number
40220>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
40221>>>>>>>>>>>>>
40221>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
40222>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
40223>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
40224>>>>>>>>>>>>>
40224>>>>>>>>>>>>>        // Child (Client) file structure................
40224>>>>>>>>>>>>>        Send Add_Client_File  Item.File_Number
40225>>>>>>>>>>>>>
40225>>>>>>>>>>>>>        // External (System) file structure.............
40225>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
40226>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
40227>>>>>>>>>>>>>
40227>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Witemkat_Rec0  To Witemkat.Witemkat_Rec0
40230>>>>>>>>>>>>>
40230>>>>>>>>>>>>>        // Field-based properties.......................
40230>>>>>>>>>>>>>
40230>>>>>>>>>>>>>        // Witemkat.Witemkat_Code
40230>>>>>>>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Code To DD_AUTOFIND   
40231>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemkat.Witemkat_Code To (sl024(Self))
40232>>>>>>>>>>>>>
40232>>>>>>>>>>>>>        // Witemkat.Witemkat_Rec0
40232>>>>>>>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Rec0 To DD_AUTOFIND   
40233>>>>>>>>>>>>>
40233>>>>>>>>>>>>>        // Witemkat.Witemkat_Descr
40233>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemkat.Witemkat_Descr To (sl024(Self))
40234>>>>>>>>>>>>>
40234>>>>>>>>>>>>>        // Witemkat.Witemkat_Recr
40234>>>>>>>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Recr To DD_AUTOFIND   
40235>>>>>>>>>>>>>
40235>>>>>>>>>>>>>        // Witemkat.Codeglpol
40235>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemkat.Codeglpol To (sl150(Self))
40236>>>>>>>>>>>>>
40236>>>>>>>>>>>>>        // Witemkat.Codeglago
40236>>>>>>>>>>>>>
40236>>>>>>>>>>>>>        //DDB-DefineFieldEnd
40236>>>>>>>>>>>>>    End_Procedure    // Define_Fields
40237>>>>>>>>>>>>>
40237>>>>>>>>>>>>>    // Field_Defaults:
40237>>>>>>>>>>>>>    // This procedure is used to establish default field values.
40237>>>>>>>>>>>>>
40237>>>>>>>>>>>>>    Procedure Field_Defaults
40238>>>>>>>>>>>>>        Forward Send Field_Defaults
40240>>>>>>>>>>>>>        //DDB-Generated-Code-Location
40240>>>>>>>>>>>>>        //DDB-FieldDefaultStart
40240>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
40240>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
40241>>>>>>>>>>>>>
40241>>>>>>>>>>>>>End_Class    // Witemkat_DataDictionary
40242>>>>>>>>>>>>>//DDB-Selection-pkg-Start
40242>>>>>>>>>>>>>
40242>>>>>>>>>>>>>Use sl024.SL         // sl024
INCLUDING FILE: SL024.SL
40242>>>>>>>>>>>>>>>//AB/ Project sl024:kathgories eidon
40242>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
40242>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl024:kathgories eidon"
40242>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl024.SL"
40242>>>>>>>>>>>>>>>
40242>>>>>>>>>>>>>>>// Project Object Structure
40242>>>>>>>>>>>>>>>//   sl024 is a dbModalPanelSub
40242>>>>>>>>>>>>>>>//     Witemkat_DD is a DataDictionary
40242>>>>>>>>>>>>>>>//     oSelList is a dbListSub
40242>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
40242>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
40242>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
40242>>>>>>>>>>>>>>>
40242>>>>>>>>>>>>>>>// Register all objects
40242>>>>>>>>>>>>>>>Register_Object oCancel_bn
40242>>>>>>>>>>>>>>>Register_Object oOK_bn
40242>>>>>>>>>>>>>>>Register_Object oSearch_bn
40242>>>>>>>>>>>>>>>Register_Object oSelList
40242>>>>>>>>>>>>>>>Register_Object sl024
40242>>>>>>>>>>>>>>>Register_Object Witemkat_DD
40242>>>>>>>>>>>>>>>
40242>>>>>>>>>>>>>>>
40242>>>>>>>>>>>>>>>//AB-IgnoreStart
40242>>>>>>>>>>>>>>>
40242>>>>>>>>>>>>>>>Use DFAllEnt.pkg
40242>>>>>>>>>>>>>>>Use dbList.Sub
40242>>>>>>>>>>>>>>>Use Button.Sub
40242>>>>>>>>>>>>>>>
40242>>>>>>>>>>>>>>>
40242>>>>>>>>>>>>>>>Use WITEMKAT.DD
40242>>>>>>>>>>>>>>>
40242>>>>>>>>>>>>>>>//AB-IgnoreEnd
40242>>>>>>>>>>>>>>>
40242>>>>>>>>>>>>>>>Object sl024 is a dbModalPanelSub
40244>>>>>>>>>>>>>>>    Set Label to "‰˜«žš¦¨åœª „ ›é¤"
40245>>>>>>>>>>>>>>>    Set Size to 217 375
40246>>>>>>>>>>>>>>>    Set Location to 4 5
40247>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
40248>>>>>>>>>>>>>>>    Set Modal_State to FALSE
40249>>>>>>>>>>>>>>>
40249>>>>>>>>>>>>>>>    //AB-DDOStart
40249>>>>>>>>>>>>>>>
40249>>>>>>>>>>>>>>>    Object Witemkat_DD is a Witemkat_DataDictionary
40251>>>>>>>>>>>>>>>    End_Object    // Witemkat_DD
40252>>>>>>>>>>>>>>>
40252>>>>>>>>>>>>>>>    Set Main_DD to (Witemkat_DD(self))
40253>>>>>>>>>>>>>>>    Set Server to (Witemkat_DD(self))
40254>>>>>>>>>>>>>>>
40254>>>>>>>>>>>>>>>    //AB-DDOEnd
40254>>>>>>>>>>>>>>>
40254>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
40256>>>>>>>>>>>>>>>        Set Main_File to Witemkat.File_Number
40257>>>>>>>>>>>>>>>        Set Size to 175 357
40258>>>>>>>>>>>>>>>        Set Location to 6 6
40259>>>>>>>>>>>>>>>
40259>>>>>>>>>>>>>>>        Begin_Row
40262>>>>>>>>>>>>>>>            Entry_Item Witemkat.Witemkat_code
40263>>>>>>>>>>>>>>>            Entry_Item Witemkat.Witemkat_descr
40264>>>>>>>>>>>>>>>        End_Row
40269>>>>>>>>>>>>>>>
40269>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 124
40270>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
40271>>>>>>>>>>>>>>>        
40271>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 223
40272>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
40273>>>>>>>>>>>>>>>        
40273>>>>>>>>>>>>>>>    End_Object    // oSelList
40274>>>>>>>>>>>>>>>
40274>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
40276>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
40277>>>>>>>>>>>>>>>        Set Location to 186 210
40278>>>>>>>>>>>>>>>
40278>>>>>>>>>>>>>>>        //AB-StoreStart
40278>>>>>>>>>>>>>>>        Procedure OnClick
40280>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
40281>>>>>>>>>>>>>>>        End_Procedure
40282>>>>>>>>>>>>>>>        //AB-StoreEnd
40282>>>>>>>>>>>>>>>
40282>>>>>>>>>>>>>>>    End_Object    // oOK_bn
40283>>>>>>>>>>>>>>>
40283>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
40285>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
40286>>>>>>>>>>>>>>>        Set Location to 186 265
40287>>>>>>>>>>>>>>>
40287>>>>>>>>>>>>>>>        //AB-StoreStart
40287>>>>>>>>>>>>>>>        Procedure OnClick
40289>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
40290>>>>>>>>>>>>>>>        End_Procedure
40291>>>>>>>>>>>>>>>        //AB-StoreEnd
40291>>>>>>>>>>>>>>>
40291>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
40292>>>>>>>>>>>>>>>
40292>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
40294>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
40295>>>>>>>>>>>>>>>        Set Location to 186 320
40296>>>>>>>>>>>>>>>
40296>>>>>>>>>>>>>>>        //AB-StoreStart
40296>>>>>>>>>>>>>>>        Procedure OnClick
40298>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
40299>>>>>>>>>>>>>>>        End_Procedure
40300>>>>>>>>>>>>>>>        //AB-StoreEnd
40300>>>>>>>>>>>>>>>
40300>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
40301>>>>>>>>>>>>>>>
40301>>>>>>>>>>>>>>>
40301>>>>>>>>>>>>>>>    //AB-StoreStart
40301>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
40302>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
40303>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
40304>>>>>>>>>>>>>>>    //AB-StoreEnd
40304>>>>>>>>>>>>>>>
40304>>>>>>>>>>>>>>>End_Object    // sl024
40305>>>>>>>>>>>>>>>
40305>>>>>>>>>>>>>>>//AB/ End_Object    // prj
40305>>>>>>>>>>>>>Use sl150.SL         // sl150
INCLUDING FILE: SL150.SL
40305>>>>>>>>>>>>>>>//AB/ Project sl150:GL Gplan
40305>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
40305>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl150:GL Gplan"
40305>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl150.SL"
40305>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
40305>>>>>>>>>>>>>>>
40305>>>>>>>>>>>>>>>// Project Object Structure
40305>>>>>>>>>>>>>>>//   sl150 is a dbModalPanel
40305>>>>>>>>>>>>>>>//     Gplan_DD is a DataDictionary
40305>>>>>>>>>>>>>>>//     oSelList is a dbList
40305>>>>>>>>>>>>>>>//     oOK_bn is a Button
40305>>>>>>>>>>>>>>>//     oCancel_bn is a Button
40305>>>>>>>>>>>>>>>//     oSearch_bn is a Button
40305>>>>>>>>>>>>>>>
40305>>>>>>>>>>>>>>>// Register all objects
40305>>>>>>>>>>>>>>>Register_Object Gplan_DD
40305>>>>>>>>>>>>>>>Register_Object oCancel_bn
40305>>>>>>>>>>>>>>>Register_Object oOK_bn
40305>>>>>>>>>>>>>>>Register_Object oSearch_bn
40305>>>>>>>>>>>>>>>Register_Object oSelList
40305>>>>>>>>>>>>>>>Register_Object sl150
40305>>>>>>>>>>>>>>>
40305>>>>>>>>>>>>>>>
40305>>>>>>>>>>>>>>>//AB-IgnoreStart
40305>>>>>>>>>>>>>>>
40305>>>>>>>>>>>>>>>Use DFAllEnt.pkg
40305>>>>>>>>>>>>>>>
40305>>>>>>>>>>>>>>>
40305>>>>>>>>>>>>>>>Use GPLAN.DD
INCLUDING FILE: GPLAN.DD
40305>>>>>>>>>>>>>>>>>//DDB-FileStart
40305>>>>>>>>>>>>>>>>>//DDB-HeaderStart
40305>>>>>>>>>>>>>>>>>
40305>>>>>>>>>>>>>>>>>// File Name : GPLAN.DD
40305>>>>>>>>>>>>>>>>>// Class Name: Gplan_DataDictionary
40305>>>>>>>>>>>>>>>>>// Revision  : 125
40305>>>>>>>>>>>>>>>>>// Version   : 2
40305>>>>>>>>>>>>>>>>>
40305>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
40305>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
40305>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
40305>>>>>>>>>>>>>>>>>
40305>>>>>>>>>>>>>>>>>Open Gplan
40307>>>>>>>>>>>>>>>>>Open Gmovea
INCLUDING FILE: GMOVEA.FD
40309>>>>>>>>>>>>>>>>>Open Gplanmod
INCLUDING FILE: GPLANMOD.FD
40311>>>>>>>>>>>>>>>>>Open Gmhnes
INCLUDING FILE: GMHNES.FD
40313>>>>>>>>>>>>>>>>>Open Gmove
INCLUDING FILE: GMOVE.FD
40315>>>>>>>>>>>>>>>>>Open Gvatd
INCLUDING FILE: GVATD.FD
40317>>>>>>>>>>>>>>>>>Open Gpmoves
INCLUDING FILE: GPMOVES.FD
40319>>>>>>>>>>>>>>>>>Open Sysrecg
40321>>>>>>>>>>>>>>>>>Open Syscurgl
40323>>>>>>>>>>>>>>>>>
40323>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
40323>>>>>>>>>>>>>>>>>//DDB-ValidationStart
40323>>>>>>>>>>>>>>>>>
40323>>>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_O_Code_VT
40323>>>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Yn_VT
40323>>>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Xpm_VT
40323>>>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Doy_VT
40323>>>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_J_Code_VT
40323>>>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_C_Code2_VT
40323>>>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_I_A_Code_VT2
40323>>>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Myf_Sum_VT
40323>>>>>>>>>>>>>>>>>
40323>>>>>>>>>>>>>>>>>Object Gplan_Gplan_O_Code_VT  is a CodeValidationTable
40325>>>>>>>>>>>>>>>>>    Set Type_Value        To "OMADA"
40326>>>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
40327>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
40327>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
40327>>>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_O_Code_VT
40328>>>>>>>>>>>>>>>>>
40328>>>>>>>>>>>>>>>>>Object Gplan_Gplan_Yn_VT  is a CodeValidationTable
40330>>>>>>>>>>>>>>>>>    Set Type_Value        To "YESNO"
40331>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
40331>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
40331>>>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Yn_VT
40332>>>>>>>>>>>>>>>>>
40332>>>>>>>>>>>>>>>>>Object Gplan_Gplan_Xpm_VT  is a DescriptionValidationTable
40334>>>>>>>>>>>>>>>>>
40334>>>>>>>>>>>>>>>>>    Procedure Fill_List
40336>>>>>>>>>>>>>>>>>        Forward Send Fill_List
40338>>>>>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "•¨œ¦ç£œ¤¦ª"
40339>>>>>>>>>>>>>>>>>        Send Add_Table_Value  "2"  " ©«¦ç£œ¤¦ª"
40340>>>>>>>>>>>>>>>>>        Send Add_Table_Value  "3"  "‹ ¡«æª"
40341>>>>>>>>>>>>>>>>>    End_Procedure    // Fill_List
40342>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
40342>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
40342>>>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Xpm_VT
40343>>>>>>>>>>>>>>>>>
40343>>>>>>>>>>>>>>>>>Object Gplan_Gplan_Doy_VT  is a CodeValidationTable
40345>>>>>>>>>>>>>>>>>    Set Type_Value        To "DOY"
40346>>>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
40347>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
40347>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
40347>>>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Doy_VT
40348>>>>>>>>>>>>>>>>>
40348>>>>>>>>>>>>>>>>>Object Gplan_Gplan_J_Code_VT  is a CodeValidationTable
40350>>>>>>>>>>>>>>>>>    Set Type_Value        To "JOB"
40351>>>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
40352>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
40352>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
40352>>>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_J_Code_VT
40353>>>>>>>>>>>>>>>>>
40353>>>>>>>>>>>>>>>>>Object Gplan_Gplan_C_Code2_VT  is a CodeValidationTable
40355>>>>>>>>>>>>>>>>>    Set Type_Value        To "CURRENCY"
40356>>>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
40357>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
40357>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
40357>>>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_C_Code2_VT
40358>>>>>>>>>>>>>>>>>
40358>>>>>>>>>>>>>>>>>Object Gplan_Gplan_I_A_Code_VT2  is a CodeValidationTable
40360>>>>>>>>>>>>>>>>>    Set Type_Value        To "AITIOL"
40361>>>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
40362>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
40362>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
40362>>>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_I_A_Code_VT2
40363>>>>>>>>>>>>>>>>>
40363>>>>>>>>>>>>>>>>>Object Gplan_Gplan_Myf_Sum_VT  is a CodeValidationTable
40365>>>>>>>>>>>>>>>>>    Set Type_Value        To "MYF"
40366>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
40366>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
40366>>>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Myf_Sum_VT
40367>>>>>>>>>>>>>>>>>//DDB-ValidationEnd
40367>>>>>>>>>>>>>>>>>//DDB-SelectionStart
40367>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl150  sl150.sl
40367>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList Gtypkin  Gtypkin.sl
40367>>>>>>>>>>>>>>>>>Register_Object sl150
40367>>>>>>>>>>>>>>>>>Register_Object Gtypkin
40367>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
40367>>>>>>>>>>>>>>>>>Use arrays.Sub
40367>>>>>>>>>>>>>>>>>
40367>>>>>>>>>>>>>>>>>Use Gmovea.dd //®¨œ áœ«˜  ¦§à›ã§¦«œ, › æ«  œå¤˜  alias file ¡˜ 
INCLUDING FILE: GMOVEA.DD
40367>>>>>>>>>>>>>>>>>>>//DDB-FileStart
40367>>>>>>>>>>>>>>>>>>>//DDB-HeaderStart
40367>>>>>>>>>>>>>>>>>>>
40367>>>>>>>>>>>>>>>>>>>// File Name : GMOVEA.DD
40367>>>>>>>>>>>>>>>>>>>// Class Name: Gmovea_DataDictionary
40367>>>>>>>>>>>>>>>>>>>// Revision  : 17
40367>>>>>>>>>>>>>>>>>>>// Version   : 2
40367>>>>>>>>>>>>>>>>>>>
40367>>>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
40367>>>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
40367>>>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
40367>>>>>>>>>>>>>>>>>>>
40367>>>>>>>>>>>>>>>>>>>Open Gmovea
40369>>>>>>>>>>>>>>>>>>>Open Gopen
INCLUDING FILE: GOPEN.FD
40371>>>>>>>>>>>>>>>>>>>Open Garticl
INCLUDING FILE: GARTICL.FD
40373>>>>>>>>>>>>>>>>>>>Open Gplan
40375>>>>>>>>>>>>>>>>>>>
40375>>>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
40375>>>>>>>>>>>>>>>>>>>
40375>>>>>>>>>>>>>>>>>>>//open master file
40375>>>>>>>>>>>>>>>>>>>Open Gmove
40377>>>>>>>>>>>>>>>>>>>
40377>>>>>>>>>>>>>>>>>>>//define alias-master condition
40377>>>>>>>>>>>>>>>>>>>Set_Attribute DF_FILE_ALIAS of Gmovea.File_Number to DF_FILE_IS_ALIAS
40380>>>>>>>>>>>>>>>>>>>Set_Attribute DF_FILE_ALIAS of Gmove.File_Number  to DF_FILE_IS_MASTER
40383>>>>>>>>>>>>>>>>>>>
40383>>>>>>>>>>>>>>>>>>>//clear all relationships from the alias file
40383>>>>>>>>>>>>>>>>>>>Set_Relate Gmovea.Garticl_Recr to |FN0,0
40384>>>>>>>>>>>>>>>>>>>>
40384>>>>>>>>>>>>>>>>>>>Set_Relate Gmovea.Gplan_Recr   to |FN0,0
40385>>>>>>>>>>>>>>>>>>>>
40385>>>>>>>>>>>>>>>>>>>
40385>>>>>>>>>>>>>>>>>>>
40385>>>>>>>>>>>>>>>>>>>Class Gmovea_DataDictionary  is a DataDictionary_Sec
40386>>>>>>>>>>>>>>>>>>>
40386>>>>>>>>>>>>>>>>>>>
40386>>>>>>>>>>>>>>>>>>>      //private
40386>>>>>>>>>>>>>>>>>>>      //œ¤ž£œ¨é¤œ  «˜ 13 §œ›å˜ open item
40386>>>>>>>>>>>>>>>>>>>      //¡˜¢œå«˜  ˜§æ update
40386>>>>>>>>>>>>>>>>>>>      Procedure private.Do_Compute_Open_Itemsa
40387>>>>>>>>>>>>>>>>>>>                Case Begin
40387>>>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_X0 > 0) //˜«æ­ ¦ ®¨œà©« ¡æ record
40389>>>>>>>>>>>>>>>>>>>                          Move "+"                                                 to Gmovea.Gmove_Topen
40390>>>>>>>>>>>>>>>>>>>                          Move (     Gmovea.Gmove_X0  - Gmovea.Gmove_Open_Sx0) to Gmovea.Gmove_Open_Yx0
40391>>>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yp0
40392>>>>>>>>>>>>>>>>>>>                     Case Break
40393>>>>>>>>>>>>>>>>>>>
40393>>>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_X0 < 0) //¯œ¬«¦- ®¨œà©« ¡æ record
40396>>>>>>>>>>>>>>>>>>>                          Move "-"                                                 to Gmovea.Gmove_Topen
40397>>>>>>>>>>>>>>>>>>>                          Move ((Abs(Gmovea.Gmove_X0))- Gmovea.Gmove_Open_Sp0) to Gmovea.Gmove_Open_Yp0
40398>>>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yx0
40399>>>>>>>>>>>>>>>>>>>                     Case Break
40400>>>>>>>>>>>>>>>>>>>
40400>>>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_P0 > 0) //˜«æ­ ¦ § ©«à« ¡æ record
40403>>>>>>>>>>>>>>>>>>>                          Move "-"                                                 to Gmovea.Gmove_Topen
40404>>>>>>>>>>>>>>>>>>>                          Move (     Gmovea.Gmove_P0  - Gmovea.Gmove_Open_Sp0) to Gmovea.Gmove_Open_Yp0
40405>>>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yx0
40406>>>>>>>>>>>>>>>>>>>                     Case Break
40407>>>>>>>>>>>>>>>>>>>
40407>>>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_P0 < 0) //¯œç«¦- ®¨œà©« ¡æ record
40410>>>>>>>>>>>>>>>>>>>                          Move "+"                                                 to Gmovea.Gmove_Topen
40411>>>>>>>>>>>>>>>>>>>                          Move ((Abs(Gmovea.Gmove_P0))- Gmovea.Gmove_Open_Sx0) to Gmovea.Gmove_Open_Yx0
40412>>>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yp0
40413>>>>>>>>>>>>>>>>>>>                     Case Break
40414>>>>>>>>>>>>>>>>>>>                Case End
40414>>>>>>>>>>>>>>>>>>>      End_Procedure //private.do_compute_open_itemsa
40415>>>>>>>>>>>>>>>>>>>
40415>>>>>>>>>>>>>>>>>>>
40415>>>>>>>>>>>>>>>>>>>
40415>>>>>>>>>>>>>>>>>>>      //private
40415>>>>>>>>>>>>>>>>>>>      //œ¢âš®œ  «˜ 13 §œ›å˜ open item
40415>>>>>>>>>>>>>>>>>>>      //¡˜¢œå«˜  ˜§æ validate save
40415>>>>>>>>>>>>>>>>>>>      Function  private.fi_Validate_Open_Itemsa Returns Integer
40416>>>>>>>>>>>>>>>>>>>
40416>>>>>>>>>>>>>>>>>>>                 //1101+1102+1103+1104:â¢œš®¦  £ã ˜¨¤ž« ¡é¤ ¬§¦¢¦å§à¤ §¨¦ª ©¬©®â« ©ž ¡˜  ©¬©®œ« ©Ÿâ¤«à¤ §¦©é¤
40416>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 >= 0                       )) Function_Return 1101
40419>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 >= 0                       )) Function_Return 1102
40422>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 >= 0                       )) Function_Return 1103
40425>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 >= 0                       )) Function_Return 1104
40428>>>>>>>>>>>>>>>>>>>
40428>>>>>>>>>>>>>>>>>>>                 Case Begin
40428>>>>>>>>>>>>>>>>>>>                      //1105+1106+1107+1108:â¢œš®¦  š ˜ ˜«æ­ ¦ ®¨œà©« ¡æ record
40428>>>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_X0 > 0)
40430>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 <=      Gmovea.Gmove_X0  )) Function_Return 1105
40433>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 <=      Gmovea.Gmove_X0  )) Function_Return 1106
40436>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0  = 0                       )) Function_Return 1107
40439>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0  = 0                       )) Function_Return 1108
40442>>>>>>>>>>>>>>>>>>>                      Case Break
40443>>>>>>>>>>>>>>>>>>>                      //1109+1110+1111+1112:â¢œš®¦  š ˜ ¯œ¬«¦- ®¨œà©« ¡æ record
40443>>>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_X0 < 0)
40446>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0  = 0                       )) Function_Return 1109
40449>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0  = 0                       )) Function_Return 1110
40452>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 <= (Abs(Gmovea.Gmove_X0)))) Function_Return 1111
40455>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 <= (Abs(Gmovea.Gmove_X0)))) Function_Return 1112
40458>>>>>>>>>>>>>>>>>>>                      Case Break
40459>>>>>>>>>>>>>>>>>>>                      //1113+1114+1115+1116:â¢œš®¦  š ˜ ˜«æ­ ¦ § ©«à« ¡æ record
40459>>>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_P0 > 0)
40462>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0  = 0                       )) Function_Return 1113
40465>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0  = 0                       )) Function_Return 1114
40468>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 <=      Gmovea.Gmove_P0  )) Function_Return 1115
40471>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 <=      Gmovea.Gmove_P0  )) Function_Return 1116
40474>>>>>>>>>>>>>>>>>>>                      Case Break
40475>>>>>>>>>>>>>>>>>>>                      //1117+1118+1119+1120:â¢œš®¦  š ˜ ¯œç«¦- ®¨œà©« ¡æ record
40475>>>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_P0 < 0)
40478>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 <= (Abs(Gmovea.Gmove_P0)))) Function_Return 1117
40481>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 <= (Abs(Gmovea.Gmove_P0)))) Function_Return 1118
40484>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0  = 0                       )) Function_Return 1119
40487>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0  = 0                       )) Function_Return 1120
40490>>>>>>>>>>>>>>>>>>>                      Case Break
40491>>>>>>>>>>>>>>>>>>>                 Case End
40491>>>>>>>>>>>>>>>>>>>
40491>>>>>>>>>>>>>>>>>>>                 Function_Return 0 //æ¢˜ ok
40492>>>>>>>>>>>>>>>>>>>      End_Function //private.fi_validate_open_itemsa
40493>>>>>>>>>>>>>>>>>>>
40493>>>>>>>>>>>>>>>>>>>    Procedure Update
40494>>>>>>>>>>>>>>>>>>>          Send private.Do_Compute_Open_Itemsa
40495>>>>>>>>>>>>>>>>>>>    End_Procedure //update
40496>>>>>>>>>>>>>>>>>>>
40496>>>>>>>>>>>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
40497>>>>>>>>>>>>>>>>>>>              String lsError_Message
40498>>>>>>>>>>>>>>>>>>>              Case Begin
40498>>>>>>>>>>>>>>>>>>>                   //˜§æ validate save
40498>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1101)
40500>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ œå¤˜  ˜¨¤ž« ¡æ !");                        to lsError_Message
40501>>>>>>>>>>>>>>>>>>>                   Case Break
40502>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1102)
40505>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ œå¤˜  ˜¨¤ž« ¡æ !");                        to lsError_Message
40506>>>>>>>>>>>>>>>>>>>                   Case Break
40507>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1103)
40510>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª œå¤˜  ˜¨¤ž« ¡ã !");                        to lsError_Message
40511>>>>>>>>>>>>>>>>>>>                   Case Break
40512>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1104)
40515>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª œå¤˜  ˜¨¤ž« ¡ã !");                        to lsError_Message
40516>>>>>>>>>>>>>>>>>>>                   Case Break
40517>>>>>>>>>>>>>>>>>>>                   //---------------------------------------Ÿœ« ¡âª ®¨œé©œ ª-----------------
40517>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1105)
40520>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã ®¨âà©ž !");                        to lsError_Message
40521>>>>>>>>>>>>>>>>>>>                   Case Break
40522>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1106)
40525>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã ®¨âà©ž !");                        to lsError_Message
40526>>>>>>>>>>>>>>>>>>>                   Case Break
40527>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1107)
40530>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ !");                        to lsError_Message
40531>>>>>>>>>>>>>>>>>>>                   Case Break
40532>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1108)
40535>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
40536>>>>>>>>>>>>>>>>>>>                   Case Break
40537>>>>>>>>>>>>>>>>>>>                   //---------------------------------------˜¨¤ž« ¡âª ®¨œé©œ ª---------------
40537>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1109)
40540>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ!");                        to lsError_Message
40541>>>>>>>>>>>>>>>>>>>                   Case Break
40542>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1110)
40545>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
40546>>>>>>>>>>>>>>>>>>>                   Case Break
40547>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1111)
40550>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª ®¨âà©žª !");                        to lsError_Message
40551>>>>>>>>>>>>>>>>>>>                   Case Break
40552>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1112)
40555>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª ®¨âà©žª !");                        to lsError_Message
40556>>>>>>>>>>>>>>>>>>>                   Case Break
40557>>>>>>>>>>>>>>>>>>>                   //---------------------------------------Ÿœ« ¡âª § ©«é©œ ª----------------
40557>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1113)
40560>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ !");                        to lsError_Message
40561>>>>>>>>>>>>>>>>>>>                   Case Break
40562>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1114)
40565>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
40566>>>>>>>>>>>>>>>>>>>                   Case Break
40567>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1115)
40570>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã §å©«à©ž !");                        to lsError_Message
40571>>>>>>>>>>>>>>>>>>>                   Case Break
40572>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1116)
40575>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã §å©«à©ž !");                        to lsError_Message
40576>>>>>>>>>>>>>>>>>>>                   Case Break
40577>>>>>>>>>>>>>>>>>>>                   //---------------------------------------˜¨àž« ¡âª § ©«é©œ ª----------------
40577>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1117)
40580>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ!");                        to lsError_Message
40581>>>>>>>>>>>>>>>>>>>                   Case Break
40582>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1118)
40585>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
40586>>>>>>>>>>>>>>>>>>>                   Case Break
40587>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1119)
40590>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª §å©«à©žª !");                        to lsError_Message
40591>>>>>>>>>>>>>>>>>>>                   Case Break
40592>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1120) //soso ayto den xoraei display stin othoni !
40595>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª §å©«à©žª !");                        to lsError_Message
40596>>>>>>>>>>>>>>>>>>>                   Case Break
40597>>>>>>>>>>>>>>>>>>>
40597>>>>>>>>>>>>>>>>>>>
40597>>>>>>>>>>>>>>>>>>>                   //˜§æ validate delete
40597>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 2001)
40600>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n˜¨˜¡˜¢é ¡˜¢â©˜«œ «ž¤ Solution !");                        to lsError_Message
40601>>>>>>>>>>>>>>>>>>>                   Case Break
40602>>>>>>>>>>>>>>>>>>>
40602>>>>>>>>>>>>>>>>>>>                   Case Else
40602>>>>>>>>>>>>>>>>>>>                        Forward Send Operation_Not_Allowed iError_Num
40604>>>>>>>>>>>>>>>>>>>              Case End
40604>>>>>>>>>>>>>>>>>>>
40604>>>>>>>>>>>>>>>>>>>              Error iError_Num lsError_Message
40605>>>>>>>>>>>>>>>>>>>>
40605>>>>>>>>>>>>>>>>>>>    End_Procedure   //operation_not_allowed
40606>>>>>>>>>>>>>>>>>>>
40606>>>>>>>>>>>>>>>>>>>
40606>>>>>>>>>>>>>>>>>>>    Function Validate_Save Returns Integer
40607>>>>>>>>>>>>>>>>>>>             Integer iReturnVal liOpen_Itemsa
40608>>>>>>>>>>>>>>>>>>>             Forward Get Validate_Save to iReturnVal
40610>>>>>>>>>>>>>>>>>>>
40610>>>>>>>>>>>>>>>>>>>             If (Not(iReturnVal));             Begin
40612>>>>>>>>>>>>>>>>>>>             //1101-1120:â¢œš®¦  open item
40612>>>>>>>>>>>>>>>>>>>              Move (private.fi_Validate_Open_Itemsa(Self)) to liOpen_Itemsa
40613>>>>>>>>>>>>>>>>>>>              If (liOpen_Itemsa <> 0) Send Operation_Not_Allowed liOpen_Itemsa
40616>>>>>>>>>>>>>>>>>>>             End //«â¢¦ª ¡é› ¡˜ validation
40616>>>>>>>>>>>>>>>>>>>>
40616>>>>>>>>>>>>>>>>>>>
40616>>>>>>>>>>>>>>>>>>>
40616>>>>>>>>>>>>>>>>>>>             Function_Return iReturnVal
40617>>>>>>>>>>>>>>>>>>>    End_Function //validate_save
40618>>>>>>>>>>>>>>>>>>>
40618>>>>>>>>>>>>>>>>>>>
40618>>>>>>>>>>>>>>>>>>>    //2001:«¦ alias Gmovea ›â¤ œ§ «¨â§œ  ‰ € ‹ ˆ €   › ˜š¨˜­ã
40618>>>>>>>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
40619>>>>>>>>>>>>>>>>>>>             Send Operation_Not_Allowed 2001 //¢áŸ¦ª «¦¬ ¡é› ¡˜ !!!
40620>>>>>>>>>>>>>>>>>>>    End_Function //validate_delete
40621>>>>>>>>>>>>>>>>>>>
40621>>>>>>>>>>>>>>>>>>>
40621>>>>>>>>>>>>>>>>>>>    // Define_Fields:
40621>>>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
40621>>>>>>>>>>>>>>>>>>>
40621>>>>>>>>>>>>>>>>>>>    Procedure Define_Fields
40622>>>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
40624>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
40624>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
40624>>>>>>>>>>>>>>>>>>>
40624>>>>>>>>>>>>>>>>>>>        Set Main_File            To Gmovea.File_Number
40625>>>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
40626>>>>>>>>>>>>>>>>>>>
40626>>>>>>>>>>>>>>>>>>>
40626>>>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
40626>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gopen.File_Number
40627>>>>>>>>>>>>>>>>>>>
40627>>>>>>>>>>>>>>>>>>>        // Parent (Server) file structure...............
40627>>>>>>>>>>>>>>>>>>>        Send Add_Server_File  Garticl.File_Number
40628>>>>>>>>>>>>>>>>>>>        Send Add_Server_File  Gplan.File_Number
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Field-based properties.......................
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Company_Code
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Branch_Code
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Year_Year
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Code
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Garticl_Hmnia
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Garticl_No
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Garticl_Recr
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Recr
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Rec0
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Code
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Aitiol
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X0
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P0
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X0k
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P0k
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X00
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P00
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X00k
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P00k
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X1
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P1
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X2
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P2
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X2k
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P2k
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Xr
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Pr
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Xrk
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Prk
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Dlixis
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_A_Code
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gthhmgio_Code
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Aa
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx0
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp0
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx0
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp0
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx1
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp1
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx1
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp1
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx2
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp2
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx2
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp2
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Sc_Code2
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Aopen
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Topen
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Kk
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gthhmgio_Period
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Yn_Myfp
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Yn_Myfa
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Myf_Sump
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Myf_Suma
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag01
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag02
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag03
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag04
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag05
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag06
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag07
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag08
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag09
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag10
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag11
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag12
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag13
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag14
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag15
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag16
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag17
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag18
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag19
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag20
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Year_Recr
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Recr
40629>>>>>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
40629>>>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
40630>>>>>>>>>>>>>>>>>>>
40630>>>>>>>>>>>>>>>>>>>    // Field_Defaults:
40630>>>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
40630>>>>>>>>>>>>>>>>>>>
40630>>>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
40631>>>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
40633>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
40633>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
40633>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
40633>>>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
40634>>>>>>>>>>>>>>>>>>>End_Class    // Gmovea_DataDictionary
40635>>>>>>>>>>>>>>>>>>>//DDB-FileEnd
40635>>>>>>>>>>>>>>>>>              //©«ž¤ begin_transaction §¨¦¡˜¢œå deadlock
40635>>>>>>>>>>>>>>>>>
40635>>>>>>>>>>>>>>>>>Class Gplan_DataDictionary  is a DataDictionary_Sec
40636>>>>>>>>>>>>>>>>>
40636>>>>>>>>>>>>>>>>>    Procedure Construct_Object
40637>>>>>>>>>>>>>>>>>        Forward Send Construct_Object
40639>>>>>>>>>>>>>>>>>        Object oarrayGplan_Aux is a cPinakas
40641>>>>>>>>>>>>>>>>>        End_Object
40642>>>>>>>>>>>>>>>>>        Property Integer pioarray_Gplan_Aux (oarrayGplan_Aux(self))
40643>>>>>>>>>>>>>>>>>        Property String psValidChars ""
40644>>>>>>>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
40645>>>>>>>>>>>>>>>>>    End_Procedure   // Construct_Object
40646>>>>>>>>>>>>>>>>>
40646>>>>>>>>>>>>>>>>>    Procedure OnConstrain
40647>>>>>>>>>>>>>>>>>        Forward Send OnConstrain
40649>>>>>>>>>>>>>>>>>        If (piMustNOTConstrain(Self)) Begin
40651>>>>>>>>>>>>>>>>>        End
40651>>>>>>>>>>>>>>>>>>
40651>>>>>>>>>>>>>>>>>        Else Begin
40652>>>>>>>>>>>>>>>>>            Constrain Gplan.Company_Code  eq SysCurGL.Company_Code
40654>>>>>>>>>>>>>>>>>            Constrain Gplan.Branch_Code   eq SysCurGL.Branch_Code
40656>>>>>>>>>>>>>>>>>            Constrain Gplan.Year_Year     eq SysCurGL.Year_Year
40658>>>>>>>>>>>>>>>>>        End
40658>>>>>>>>>>>>>>>>>>
40658>>>>>>>>>>>>>>>>>    End_Procedure
40659>>>>>>>>>>>>>>>>>
40659>>>>>>>>>>>>>>>>>    Procedure Update
40660>>>>>>>>>>>>>>>>>        Forward Send Update
40662>>>>>>>>>>>>>>>>>        // Insert Code Here
40662>>>>>>>>>>>>>>>>>        Move SysCurGL.Company_Code  to Gplan.Company_Code
40663>>>>>>>>>>>>>>>>>        Move SysCurGL.Branch_Code   to Gplan.Branch_Code
40664>>>>>>>>>>>>>>>>>        Move SysCurGL.Year_Year     to Gplan.Year_Year
40665>>>>>>>>>>>>>>>>>        Move SysCurGL.Year_Recr     to Gplan.Year_Recr
40666>>>>>>>>>>>>>>>>>    End_Procedure   // Update
40667>>>>>>>>>>>>>>>>>
40667>>>>>>>>>>>>>>>>>    Procedure Creating
40668>>>>>>>>>>>>>>>>>        Forward Send Creating
40670>>>>>>>>>>>>>>>>>        // Insert Code Here
40670>>>>>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurGL.Branch_Site))+;                         (Trim(String(Gplan.Gplan_Rec0)))))) to Gplan.Gplan_Recr
40671>>>>>>>>>>>>>>>>>    End_Procedure   // Creating
40672>>>>>>>>>>>>>>>>>
40672>>>>>>>>>>>>>>>>>
40672>>>>>>>>>>>>>>>>>//////////////////////////////////////
40672>>>>>>>>>>>>>>>>>//////////////////////////////////////
40672>>>>>>>>>>>>>>>>>
40672>>>>>>>>>>>>>>>>>    Function fiCheckValidChars String asGplanCode String asValChars Returns Integer
40673>>>>>>>>>>>>>>>>>        String lsChar
40674>>>>>>>>>>>>>>>>>        Integer liLen liCharPos rVal
40674>>>>>>>>>>>>>>>>>        If (asGplanCode <> "") Begin
40676>>>>>>>>>>>>>>>>>            Move (Trim(asGplanCode)) to asGplanCode
40677>>>>>>>>>>>>>>>>>            Move (Length(asGplanCode)) to liLen
40678>>>>>>>>>>>>>>>>>            For liCharPos From 1 to liLen
40684>>>>>>>>>>>>>>>>>>
40684>>>>>>>>>>>>>>>>>               Move (Mid(asGplanCode,1,liCharPos)) to lsChar
40685>>>>>>>>>>>>>>>>>               If (Not(asValChars contains lsChar)) Begin
40687>>>>>>>>>>>>>>>>>                    Set psValidChars to asValChars
40688>>>>>>>>>>>>>>>>>                    Function_Return 1001
40689>>>>>>>>>>>>>>>>>               End
40689>>>>>>>>>>>>>>>>>>
40689>>>>>>>>>>>>>>>>>            Loop
40690>>>>>>>>>>>>>>>>>>
40690>>>>>>>>>>>>>>>>>        End
40690>>>>>>>>>>>>>>>>>>
40690>>>>>>>>>>>>>>>>>        Function_Return rVal
40691>>>>>>>>>>>>>>>>>    End_Function // fiCheckValidChars
40692>>>>>>>>>>>>>>>>>
40692>>>>>>>>>>>>>>>>>    // private_Do_Restore_Fields:
40692>>>>>>>>>>>>>>>>>    Procedure private_Do_Restore_Fields for Gplan_DataDictionary
40693>>>>>>>>>>>>>>>>>        // Insert Code Here
40693>>>>>>>>>>>>>>>>>        Local Integer lioarray_Gplan_Aux##
40694>>>>>>>>>>>>>>>>>        Local Integer liFile##
40694>>>>>>>>>>>>>>>>>        Local Integer liField_Count##
40694>>>>>>>>>>>>>>>>>        Local Integer liField_Type##
40694>>>>>>>>>>>>>>>>>        Local Integer liField##
40694>>>>>>>>>>>>>>>>>
40694>>>>>>>>>>>>>>>>>        Get pioarray_Gplan_Aux to lioarray_Gplan_Aux##
40695>>>>>>>>>>>>>>>>>        Get Main_File to liFile##
40696>>>>>>>>>>>>>>>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of liFile## to liField_Count##
40699>>>>>>>>>>>>>>>>>
40699>>>>>>>>>>>>>>>>>
40699>>>>>>>>>>>>>>>>>        For liField## from 0 to (liField_Count##-1)
40705>>>>>>>>>>>>>>>>>>
40705>>>>>>>>>>>>>>>>>            //Get_Attribute DF_FIELD_TYPE of iFile iField to iField_Type
40705>>>>>>>>>>>>>>>>>            move liField## to Fieldindex
40706>>>>>>>>>>>>>>>>>            Get Array_Value of lioarray_Gplan_Aux## Item (liField##+1) to Gplan.Company_Code&
40707>>>>>>>>>>>>>>>>>        Loop
40708>>>>>>>>>>>>>>>>>>
40708>>>>>>>>>>>>>>>>>        Send Delete_Data to lioarray_Gplan_Aux##
40709>>>>>>>>>>>>>>>>>    End_Procedure   // private_Do_Restore_Fields
40710>>>>>>>>>>>>>>>>>
40710>>>>>>>>>>>>>>>>>    // private_Do_Keep_Fields:
40710>>>>>>>>>>>>>>>>>
40710>>>>>>>>>>>>>>>>>    Procedure private_Do_Keep_Fields for Gplan_DataDictionary
40711>>>>>>>>>>>>>>>>>        // Insert Code Here
40711>>>>>>>>>>>>>>>>>        Local Integer lioarray_Gplan_Aux##
40712>>>>>>>>>>>>>>>>>        Local Integer liFile##
40712>>>>>>>>>>>>>>>>>        Local Integer liField_Count##
40712>>>>>>>>>>>>>>>>>        Local Integer liField_Type##
40712>>>>>>>>>>>>>>>>>        Local Integer liField##
40712>>>>>>>>>>>>>>>>>
40712>>>>>>>>>>>>>>>>>        Get pioarray_Gplan_Aux to lioarray_Gplan_Aux##
40713>>>>>>>>>>>>>>>>>        Get Main_File to liFile##
40714>>>>>>>>>>>>>>>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of liFile## to liField_Count##
40717>>>>>>>>>>>>>>>>>
40717>>>>>>>>>>>>>>>>>        Send Delete_Data to lioarray_Gplan_Aux##
40718>>>>>>>>>>>>>>>>>        Send Add_Item to lioarray_Gplan_Aux## 0 //sos.sos
40719>>>>>>>>>>>>>>>>>
40719>>>>>>>>>>>>>>>>>        For liField## from 0 to (liField_Count##-1)
40725>>>>>>>>>>>>>>>>>>
40725>>>>>>>>>>>>>>>>>            //Get_Attribute DF_FIELD_TYPE of iFile iField to iField_Type
40725>>>>>>>>>>>>>>>>>            move liField## to Fieldindex
40726>>>>>>>>>>>>>>>>>            Send Add_Item to lioarray_Gplan_Aux## Gplan.Company_Code&
40727>>>>>>>>>>>>>>>>>        Loop
40728>>>>>>>>>>>>>>>>>>
40728>>>>>>>>>>>>>>>>>    End_Procedure   // private_Do_Keep_Fields
40729>>>>>>>>>>>>>>>>>
40729>>>>>>>>>>>>>>>>>    // Request_Save:
40729>>>>>>>>>>>>>>>>>
40729>>>>>>>>>>>>>>>>>
40729>>>>>>>>>>>>>>>>>
40729>>>>>>>>>>>>>>>>>//-----------------------------------------------------------------------------
40729>>>>>>>>>>>>>>>>>    FUNCTION Compute_Bathmos for Gplan_DataDictionary STRING KODIKOS## RETURNS INTEGER
40730>>>>>>>>>>>>>>>>>             LOCAL INTEGER BATHMOS##
40731>>>>>>>>>>>>>>>>>             REPEAT
40731>>>>>>>>>>>>>>>>>>
40731>>>>>>>>>>>>>>>>>                   REPLACE "." IN KODIKOS## WITH ""
40733>>>>>>>>>>>>>>>>>                   [FOUND] INCREMENT BATHMOS##
40734>>>>>>>>>>>>>>>>>             UNTIL (FINDERR=1)
40736>>>>>>>>>>>>>>>>>             FUNCTION_RETURN (BATHMOS##+1)
40737>>>>>>>>>>>>>>>>>    END_FUNCTION //compute_bathmos
40738>>>>>>>>>>>>>>>>>
40738>>>>>>>>>>>>>>>>>    FUNCTION Find_Previous for Gplan_DataDictionary STRING LS_CODE1## RETURNS STRING
40739>>>>>>>>>>>>>>>>>        LOCAL STRING LS_TEMP_CODE1## LS_TEMP_CODE2##
40740>>>>>>>>>>>>>>>>>        LOCAL INTEGER LI_COUNTER##
40740>>>>>>>>>>>>>>>>>
40740>>>>>>>>>>>>>>>>>        FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_CODE1##))
40746>>>>>>>>>>>>>>>>>>
40746>>>>>>>>>>>>>>>>>             INSERT (MID(LS_CODE1##,1,LI_COUNTER##)) IN LS_TEMP_CODE1## AT 1
40748>>>>>>>>>>>>>>>>>        LOOP
40749>>>>>>>>>>>>>>>>>>
40749>>>>>>>>>>>>>>>>>        MOVE (RIGHT(LS_TEMP_CODE1##,(LENGTH(LS_TEMP_CODE1##)-(POS(".",LS_TEMP_CODE1##))))) ;             TO LS_TEMP_CODE1##
40750>>>>>>>>>>>>>>>>>        FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_TEMP_CODE1##))
40756>>>>>>>>>>>>>>>>>>
40756>>>>>>>>>>>>>>>>>            INSERT (MID(LS_TEMP_CODE1##,1,LI_COUNTER##)) IN LS_TEMP_CODE2## AT 1
40758>>>>>>>>>>>>>>>>>        LOOP
40759>>>>>>>>>>>>>>>>>>
40759>>>>>>>>>>>>>>>>>        FUNCTION_RETURN LS_TEMP_CODE2##
40760>>>>>>>>>>>>>>>>>    END_FUNCTION
40761>>>>>>>>>>>>>>>>>
40761>>>>>>>>>>>>>>>>>    FUNCTION fiCheck_Format STRING  LS_CODE1##;                            STRING  LS_MASK##;                            INTEGER LI_BATHMOS##;                            RETURNS INTEGER
40762>>>>>>>>>>>>>>>>>             String  LS_TEMP_CODE1## LS_TEMP_CODE2## LS_MASK2##
40763>>>>>>>>>>>>>>>>>             Integer LI_COUNTER## LI_BATHMOS1##
40763>>>>>>>>>>>>>>>>>             Move (Trim(ls_Code1##)) to ls_Code1##
40764>>>>>>>>>>>>>>>>>             Move (Trim(ls_Mask##))  to ls_Mask##
40765>>>>>>>>>>>>>>>>>             FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_MASK##))
40771>>>>>>>>>>>>>>>>>>
40771>>>>>>>>>>>>>>>>>                  IF ((MID(LS_MASK##,1,LI_COUNTER##)) = ".") INCREMENT LI_BATHMOS1##
40774>>>>>>>>>>>>>>>>>                  IF (LI_BATHMOS1## < LI_BATHMOS##) ;                  INSERT (MID(LS_MASK##,1,LI_COUNTER##)) IN LS_MASK2## AT LI_COUNTER##
40778>>>>>>>>>>>>>>>>>             LOOP
40779>>>>>>>>>>>>>>>>>>
40779>>>>>>>>>>>>>>>>>             IF (;                  (LENGTH(LS_CODE1##)) <> (LENGTH(LS_MASK2##));                ) FUNCTION_RETURN 1000
40782>>>>>>>>>>>>>>>>>             FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_MASK2##))
40788>>>>>>>>>>>>>>>>>>
40788>>>>>>>>>>>>>>>>>                  IF (;                      ((MID(LS_MASK2##,1,LI_COUNTER##)) = ".") AND;                      ((MID(LS_CODE1##,1,LI_COUNTER##)) <> ".");                     ) FUNCTION_RETURN 1000
40791>>>>>>>>>>>>>>>>>             LOOP
40792>>>>>>>>>>>>>>>>>>
40792>>>>>>>>>>>>>>>>>             FUNCTION_RETURN 0
40793>>>>>>>>>>>>>>>>>    END_FUNCTION //fiCHECK_FORMAT
40794>>>>>>>>>>>>>>>>>
40794>>>>>>>>>>>>>>>>>    Function fiBackward_Check for Gplan_DataDictionary String LsGplanCode_Back integer liBathmos Returns Integer
40795>>>>>>>>>>>>>>>>>        Integer liGplan_Yn_Last
40796>>>>>>>>>>>>>>>>>        Number liGplanRecnum
40796>>>>>>>>>>>>>>>>>        String LsSearch_CodePrevious
40796>>>>>>>>>>>>>>>>>
40796>>>>>>>>>>>>>>>>>        if (liBathmos > 1) begin
40798>>>>>>>>>>>>>>>>>
40798>>>>>>>>>>>>>>>>>            move (Current_Record(Self)) to liGplanRecnum
40799>>>>>>>>>>>>>>>>>            move gplan.Gplan_Yn_Last to liGplan_Yn_Last
40800>>>>>>>>>>>>>>>>>            Send private_Do_Keep_Fields
40801>>>>>>>>>>>>>>>>>
40801>>>>>>>>>>>>>>>>>            Move (Find_Previous(self,lsGplanCode_Back)) to lsSearch_CodePrevious
40802>>>>>>>>>>>>>>>>>
40802>>>>>>>>>>>>>>>>>            clear Gplan
40803>>>>>>>>>>>>>>>>>            move gs_Selected_Company_Code  to Gplan.Company_Code
40804>>>>>>>>>>>>>>>>>            move gs_Selected_Branch_Code   to Gplan.Branch_Code
40805>>>>>>>>>>>>>>>>>            move gi_Selected_Year          to Gplan.Year_Year
40806>>>>>>>>>>>>>>>>>            move lsSearch_CodePrevious     to Gplan.Gplan_Code
40807>>>>>>>>>>>>>>>>>            Find eq Gplan by index.1 // pkid
40808>>>>>>>>>>>>>>>>>>
40808>>>>>>>>>>>>>>>>>            If (Found = 0) begin
40810>>>>>>>>>>>>>>>>>                clear gplan
40811>>>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
40812>>>>>>>>>>>>>>>>>                find eq gplan.recnum
40813>>>>>>>>>>>>>>>>>>
40813>>>>>>>>>>>>>>>>>                Send private_Do_Restore_Fields
40814>>>>>>>>>>>>>>>>>                Function_return  7001 //return to fiValidate
40815>>>>>>>>>>>>>>>>>            end
40815>>>>>>>>>>>>>>>>>>
40815>>>>>>>>>>>>>>>>>            else begin
40816>>>>>>>>>>>>>>>>>               // The  previous logar marked last  and current greater bathmos
40816>>>>>>>>>>>>>>>>>               if   (Gplan.Gplan_yn_Last = 1) begin
40818>>>>>>>>>>>>>>>>>                   Send private_Do_Restore_Fields
40819>>>>>>>>>>>>>>>>>                   Function_return 7003
40820>>>>>>>>>>>>>>>>>               end
40820>>>>>>>>>>>>>>>>>>
40820>>>>>>>>>>>>>>>>>               clear gplan
40821>>>>>>>>>>>>>>>>>               move liGplanRecnum to gplan.recnum
40822>>>>>>>>>>>>>>>>>               find eq gplan.recnum
40823>>>>>>>>>>>>>>>>>>
40823>>>>>>>>>>>>>>>>>               Send private_Do_Restore_Fields
40824>>>>>>>>>>>>>>>>>               function_Return 0 //ok
40825>>>>>>>>>>>>>>>>>            end
40825>>>>>>>>>>>>>>>>>>
40825>>>>>>>>>>>>>>>>>        end
40825>>>>>>>>>>>>>>>>>>
40825>>>>>>>>>>>>>>>>>        Function_Return 0
40826>>>>>>>>>>>>>>>>>    End_Function  // fiBackward_Check
40827>>>>>>>>>>>>>>>>>    //-----------------------------------------------------------------------------
40827>>>>>>>>>>>>>>>>>
40827>>>>>>>>>>>>>>>>>
40827>>>>>>>>>>>>>>>>>    //-----------------------------------------------------------------------------
40827>>>>>>>>>>>>>>>>>    FUNCTION fiForward_Check for Gplan_DataDictionary STRING LS_GplanCode integer liMode Returns Integer
40828>>>>>>>>>>>>>>>>>        String lsNext_Anoep
40829>>>>>>>>>>>>>>>>>        Integer liGplan_Yn_Last
40829>>>>>>>>>>>>>>>>>        Number liGplanRecnum
40829>>>>>>>>>>>>>>>>>
40829>>>>>>>>>>>>>>>>>
40829>>>>>>>>>>>>>>>>>        //move gplan.recnum to liGplanRecnum
40829>>>>>>>>>>>>>>>>>        move (Current_Record(Self)) to liGplanRecnum
40830>>>>>>>>>>>>>>>>>        move gplan.Gplan_Code to lsNext_Anoep
40831>>>>>>>>>>>>>>>>>        move gplan.Gplan_Yn_Last to liGplan_Yn_Last
40832>>>>>>>>>>>>>>>>>        Send private_Do_Keep_Fields
40833>>>>>>>>>>>>>>>>>
40833>>>>>>>>>>>>>>>>>        if (liGplan_Yn_Last = 1)  begin
40835>>>>>>>>>>>>>>>>>            find gt gplan by index.1
40836>>>>>>>>>>>>>>>>>>
40836>>>>>>>>>>>>>>>>>            if (found = 0) begin
40838>>>>>>>>>>>>>>>>>                clear gplan
40839>>>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
40840>>>>>>>>>>>>>>>>>                find eq gplan.recnum
40841>>>>>>>>>>>>>>>>>>
40841>>>>>>>>>>>>>>>>>                Send private_Do_Restore_Fields
40842>>>>>>>>>>>>>>>>>            end
40842>>>>>>>>>>>>>>>>>>
40842>>>>>>>>>>>>>>>>>            else begin
40843>>>>>>>>>>>>>>>>>                // The Current and the previous logar marked last
40843>>>>>>>>>>>>>>>>>                if (Gplan.Gplan_Anoep = lsNext_Anoep) begin
40845>>>>>>>>>>>>>>>>>                    clear gplan
40846>>>>>>>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
40847>>>>>>>>>>>>>>>>>                    find eq gplan.recnum
40848>>>>>>>>>>>>>>>>>>
40848>>>>>>>>>>>>>>>>>                    Send private_Do_Restore_Fields
40849>>>>>>>>>>>>>>>>>                    Function_return 7004
40850>>>>>>>>>>>>>>>>>                end
40850>>>>>>>>>>>>>>>>>>
40850>>>>>>>>>>>>>>>>>                else begin
40851>>>>>>>>>>>>>>>>>                    clear gplan
40852>>>>>>>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
40853>>>>>>>>>>>>>>>>>                    find eq gplan.recnum
40854>>>>>>>>>>>>>>>>>>
40854>>>>>>>>>>>>>>>>>                    Send private_Do_Restore_Fields
40855>>>>>>>>>>>>>>>>>                end
40855>>>>>>>>>>>>>>>>>>
40855>>>>>>>>>>>>>>>>>            end
40855>>>>>>>>>>>>>>>>>>
40855>>>>>>>>>>>>>>>>>        end
40855>>>>>>>>>>>>>>>>>>
40855>>>>>>>>>>>>>>>>>
40855>>>>>>>>>>>>>>>>>        if (liMode = 1) begin
40857>>>>>>>>>>>>>>>>>            find gt gplan by index.1
40858>>>>>>>>>>>>>>>>>>
40858>>>>>>>>>>>>>>>>>            if (Found = 0) begin
40860>>>>>>>>>>>>>>>>>                clear gplan
40861>>>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
40862>>>>>>>>>>>>>>>>>                find eq gplan.recnum
40863>>>>>>>>>>>>>>>>>>
40863>>>>>>>>>>>>>>>>>                Send private_Do_Restore_Fields
40864>>>>>>>>>>>>>>>>>            end
40864>>>>>>>>>>>>>>>>>>
40864>>>>>>>>>>>>>>>>>            else begin
40865>>>>>>>>>>>>>>>>>                if (Gplan.Gplan_Anoep = lsNext_Anoep) begin
40867>>>>>>>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
40868>>>>>>>>>>>>>>>>>                    find eq gplan.recnum
40869>>>>>>>>>>>>>>>>>>
40869>>>>>>>>>>>>>>>>>                    Send private_Do_Restore_Fields
40870>>>>>>>>>>>>>>>>>                    Function_return 7010 //called from validate delete
40871>>>>>>>>>>>>>>>>>                end
40871>>>>>>>>>>>>>>>>>>
40871>>>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
40872>>>>>>>>>>>>>>>>>                find eq gplan.recnum
40873>>>>>>>>>>>>>>>>>>
40873>>>>>>>>>>>>>>>>>                //Send private_Do_Restore_Fields
40873>>>>>>>>>>>>>>>>>            end
40873>>>>>>>>>>>>>>>>>>
40873>>>>>>>>>>>>>>>>>        end
40873>>>>>>>>>>>>>>>>>>
40873>>>>>>>>>>>>>>>>>        Function_return 0
40874>>>>>>>>>>>>>>>>>    End_Function // fiForward_Check
40875>>>>>>>>>>>>>>>>>
40875>>>>>>>>>>>>>>>>>
40875>>>>>>>>>>>>>>>>>    Function private_Man_Gplan_Code for Gplan_DataDictionary integer liField## String lsGplan_Code integer liModeGplan Returns Integer
40876>>>>>>>>>>>>>>>>>
40876>>>>>>>>>>>>>>>>>        // Insert Code Here
40876>>>>>>>>>>>>>>>>>        Integer liCounter liPosition liLength liBathmos liRetVal
40877>>>>>>>>>>>>>>>>>        string lsMask lsCkeckChar lsSearchCode
40877>>>>>>>>>>>>>>>>>
40877>>>>>>>>>>>>>>>>>        Trim lsGplan_code to lsGplan_code
40878>>>>>>>>>>>>>>>>>>
40878>>>>>>>>>>>>>>>>>        Move lsGplan_Code to lsSearchCode
40879>>>>>>>>>>>>>>>>>    Search_Again:
40879>>>>>>>>>>>>>>>>>        clear Gformat
INCLUDING FILE: GFORMAT.FD
40880>>>>>>>>>>>>>>>>>        move SysCurGL.Company_Code  to Gformat.Company_Code
40881>>>>>>>>>>>>>>>>>        move SysCurGL.Branch_Code   to Gformat.Branch_Code
40882>>>>>>>>>>>>>>>>>        move SysCurGL.Year_Year     to Gformat.Year_Year
40883>>>>>>>>>>>>>>>>>        move lsSearchCode           to Gformat.Gformat_Code
40884>>>>>>>>>>>>>>>>>        Find eq Gformat by index.1
40885>>>>>>>>>>>>>>>>>>
40885>>>>>>>>>>>>>>>>>
40885>>>>>>>>>>>>>>>>>        if (Found = 1) begin
40887>>>>>>>>>>>>>>>>>            Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
40888>>>>>>>>>>>>>>>>>            Move (fiCheck_Format(self,lsGplan_Code,gformat.gformat_mask,liBathmos)) to liRetVal
40889>>>>>>>>>>>>>>>>>            if (liRetVal = 0) begin
40891>>>>>>>>>>>>>>>>>                Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
40892>>>>>>>>>>>>>>>>>                if (liModeGplan = 0) Begin
40894>>>>>>>>>>>>>>>>>                    if (Not(Current_Record(self))) begin
40896>>>>>>>>>>>>>>>>>                        set field_default_value field Gplan.gplan_Bathmos to libathmos //from deo
40897>>>>>>>>>>>>>>>>>                    end
40897>>>>>>>>>>>>>>>>>>
40897>>>>>>>>>>>>>>>>>                end
40897>>>>>>>>>>>>>>>>>>
40897>>>>>>>>>>>>>>>>>                if (libathmos > 1) begin
40899>>>>>>>>>>>>>>>>>                    Move (Find_Previous(self,lsGplan_Code)) to lsSearchCode
40900>>>>>>>>>>>>>>>>>                    if (liModeGplan = 0) Begin
40902>>>>>>>>>>>>>>>>>                        if (Not(Current_Record(self))) begin
40904>>>>>>>>>>>>>>>>>                            set field_default_value field Gplan.gplan_Anoep to lsSearchCode //from Deo
40905>>>>>>>>>>>>>>>>>                        End
40905>>>>>>>>>>>>>>>>>>
40905>>>>>>>>>>>>>>>>>                    End
40905>>>>>>>>>>>>>>>>>>
40905>>>>>>>>>>>>>>>>>                end
40905>>>>>>>>>>>>>>>>>>
40905>>>>>>>>>>>>>>>>>            function_return 0
40906>>>>>>>>>>>>>>>>>            end
40906>>>>>>>>>>>>>>>>>>
40906>>>>>>>>>>>>>>>>>            else begin
40907>>>>>>>>>>>>>>>>>                function_return 127
40908>>>>>>>>>>>>>>>>>            end
40908>>>>>>>>>>>>>>>>>>
40908>>>>>>>>>>>>>>>>>        end
40908>>>>>>>>>>>>>>>>>>
40908>>>>>>>>>>>>>>>>>        else begin
40909>>>>>>>>>>>>>>>>>            Move (Compute_Bathmos(self,lsSearchCode)) to liBathmos
40910>>>>>>>>>>>>>>>>>            if ((liBathmos-1) <> 0) begin
40912>>>>>>>>>>>>>>>>>                Move (Find_Previous(self,lsSearchCode)) to lsSearchCode
40913>>>>>>>>>>>>>>>>>                Goto Search_Again
40914>>>>>>>>>>>>>>>>>>
40914>>>>>>>>>>>>>>>>>            end
40914>>>>>>>>>>>>>>>>>>
40914>>>>>>>>>>>>>>>>>            else begin
40915>>>>>>>>>>>>>>>>>                clear Gformat
40916>>>>>>>>>>>>>>>>>                move SysCurGL.Company_Code  to Gformat.Company_Code
40917>>>>>>>>>>>>>>>>>                move SysCurGL.Branch_Code   to Gformat.Branch_Code
40918>>>>>>>>>>>>>>>>>                move SysCurGL.Year_Year     to Gformat.Year_Year
40919>>>>>>>>>>>>>>>>>                move "@@"                   to Gformat.Gformat_Code
40920>>>>>>>>>>>>>>>>>                Find eq Gformat by index.1 // pkid
40921>>>>>>>>>>>>>>>>>>
40921>>>>>>>>>>>>>>>>>//* to be a function
40921>>>>>>>>>>>>>>>>>                Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
40922>>>>>>>>>>>>>>>>>                Move (fiCheck_Format(self,lsGplan_Code,gformat.gformat_mask,liBathmos)) to liRetVal
40923>>>>>>>>>>>>>>>>>                if (liRetVal = 0) begin
40925>>>>>>>>>>>>>>>>>                    Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
40926>>>>>>>>>>>>>>>>>                    if (liModeGplan = 0) Begin
40928>>>>>>>>>>>>>>>>>                        if (Not(Current_Record(self))) begin
40930>>>>>>>>>>>>>>>>>                            set field_default_value field Gplan.gplan_Bathmos to libathmos //from Deo
40931>>>>>>>>>>>>>>>>>                        end
40931>>>>>>>>>>>>>>>>>>
40931>>>>>>>>>>>>>>>>>                    end
40931>>>>>>>>>>>>>>>>>>
40931>>>>>>>>>>>>>>>>>                    if (libathmos > 1) begin
40933>>>>>>>>>>>>>>>>>                        Move (Find_Previous(self,lsGplan_Code)) to lsSearchCode
40934>>>>>>>>>>>>>>>>>                        if (liModeGplan = 0) Begin
40936>>>>>>>>>>>>>>>>>                            if (Not(Current_Record(self))) begin
40938>>>>>>>>>>>>>>>>>                                set field_default_value field Gplan.gplan_Anoep to lsSearchCode //from Deo
40939>>>>>>>>>>>>>>>>>                            end
40939>>>>>>>>>>>>>>>>>>
40939>>>>>>>>>>>>>>>>>                        end
40939>>>>>>>>>>>>>>>>>>
40939>>>>>>>>>>>>>>>>>                    end
40939>>>>>>>>>>>>>>>>>>
40939>>>>>>>>>>>>>>>>>                function_return 0
40940>>>>>>>>>>>>>>>>>                end
40940>>>>>>>>>>>>>>>>>>
40940>>>>>>>>>>>>>>>>>                else begin
40941>>>>>>>>>>>>>>>>>                    function_return 127
40942>>>>>>>>>>>>>>>>>                end
40942>>>>>>>>>>>>>>>>>>
40942>>>>>>>>>>>>>>>>>
40942>>>>>>>>>>>>>>>>>                //* emd to be a function
40942>>>>>>>>>>>>>>>>>                function_return 0
40943>>>>>>>>>>>>>>>>>            end
40943>>>>>>>>>>>>>>>>>>
40943>>>>>>>>>>>>>>>>>        end
40943>>>>>>>>>>>>>>>>>>
40943>>>>>>>>>>>>>>>>>        Function_return 0    //ok
40944>>>>>>>>>>>>>>>>>    End_Function   // private_Man_Gplan_Code
40945>>>>>>>>>>>>>>>>>
40945>>>>>>>>>>>>>>>>>
40945>>>>>>>>>>>>>>>>>
40945>>>>>>>>>>>>>>>>>    // fiValidateGplanFields:
40945>>>>>>>>>>>>>>>>>
40945>>>>>>>>>>>>>>>>>    Function fiValidateGplanFields for Gplan_DataDictionary integer liField string lsFieldvalue Returns Integer
40946>>>>>>>>>>>>>>>>>        String  sName lsAnoep lsGplan_Code
40947>>>>>>>>>>>>>>>>>        Integer iMainFile liGplanRecnum liReturnVal liReturnValb liBathmos1
40947>>>>>>>>>>>>>>>>>        String lsValidChar lsDelimiter
40947>>>>>>>>>>>>>>>>>
40947>>>>>>>>>>>>>>>>>        Get Main_File to iMainFile
40948>>>>>>>>>>>>>>>>>        Get_Attribute DF_FIELD_NAME of iMainFile liField to sName
40951>>>>>>>>>>>>>>>>>
40951>>>>>>>>>>>>>>>>>        If (sName = 'GPLAN_CODE') Begin
40953>>>>>>>>>>>>>>>>>            move (trim(lsFieldvalue)) to lsFieldvalue //from deo
40954>>>>>>>>>>>>>>>>>            if (lsFieldvalue <>  "") begin //new
40956>>>>>>>>>>>>>>>>>                Move SyscurGL.Year_Valid_Char to lsValidChar
40957>>>>>>>>>>>>>>>>>                Move SyscurGL.Year_Delimiter  to lsDelimiter
40958>>>>>>>>>>>>>>>>>                Move (fiCheckValidChars(Self,lsFieldvalue,((Trim(lsValidChar))+(Trim(lsDelimiter))))) to liReturnVal
40959>>>>>>>>>>>>>>>>>                if (liReturnVal = '1001') begin
40961>>>>>>>>>>>>>>>>>                               error liReturnVal ("‹ž ˜§¦›œ¡«æª ®˜¨˜¡«ã¨˜ª š ˜ ¡à› ¡æ Š.‘ !\n\n€§¦›œ¡«¦å ®˜¨˜¡«ã¨œª : '" + (psValidChars(Self)) + "'")
40962>>>>>>>>>>>>>>>>>>
40962>>>>>>>>>>>>>>>>>                               Function_Return liReturnVal
40963>>>>>>>>>>>>>>>>>                            end
40963>>>>>>>>>>>>>>>>>>
40963>>>>>>>>>>>>>>>>>
40963>>>>>>>>>>>>>>>>>                Move (private_Man_Gplan_Code(self,liField,lsFieldvalue,0)) to liReturnVal
40964>>>>>>>>>>>>>>>>>                if (lireturnval <> 0) begin
40966>>>>>>>>>>>>>>>>>                                        error 127 ("ŠáŸ¦ª £¦¨­ã ¡à› ¡¦ç !\n\n"+Gplan.Gplan_Code)
40967>>>>>>>>>>>>>>>>>>
40967>>>>>>>>>>>>>>>>>                                        function_return 127
40968>>>>>>>>>>>>>>>>>                                      end
40968>>>>>>>>>>>>>>>>>>
40968>>>>>>>>>>>>>>>>>
40968>>>>>>>>>>>>>>>>>                get field_current_value field Gplan.gplan_Code to lsGplan_Code
40969>>>>>>>>>>>>>>>>>                get field_current_value field Gplan.gplan_Bathmos to liBathmos1
40970>>>>>>>>>>>>>>>>>                get field_current_value field Gplan.gplan_anoep to lsAnoep
40971>>>>>>>>>>>>>>>>>                Move (fiBackward_Check(self,lsGplan_Code,liBathmos1)) to liReturnValb
40972>>>>>>>>>>>>>>>>>                if (liReturnValb = '7001') begin
40974>>>>>>>>>>>>>>>>>                                               error 7001 "ƒœ¤ ¬§á¨®œ  ¦ §œ¨ ¢ž§« ¡æª ™˜Ÿ£æª !"
40975>>>>>>>>>>>>>>>>>>
40975>>>>>>>>>>>>>>>>>                                               Function_Return 8001
40976>>>>>>>>>>>>>>>>>                                            end
40976>>>>>>>>>>>>>>>>>>
40976>>>>>>>>>>>>>>>>>                if (liReturnValb = '7002') begin
40978>>>>>>>>>>>>>>>>>                                               error 7002 "“§á¨®œ  ¡à› ¡æª «œ¢œ¬«˜å¦¬ ™˜Ÿ£¦ç !"
40979>>>>>>>>>>>>>>>>>>
40979>>>>>>>>>>>>>>>>>                                               Function_Return 8002
40980>>>>>>>>>>>>>>>>>                                          end
40980>>>>>>>>>>>>>>>>>>
40980>>>>>>>>>>>>>>>>>                if (liReturnValb = '7003') begin
40982>>>>>>>>>>>>>>>>>                                               error 7003 "Ž §¨¦žš¦ç£œ¤¦ª œå¤˜  «œ¢œ¬«˜å¦¬ ™˜Ÿ£¦ç !"
40983>>>>>>>>>>>>>>>>>>
40983>>>>>>>>>>>>>>>>>                                               Function_Return 8003
40984>>>>>>>>>>>>>>>>>                                          end
40984>>>>>>>>>>>>>>>>>>
40984>>>>>>>>>>>>>>>>>
40984>>>>>>>>>>>>>>>>>                Move (fiForward_Check(self,lsGplan_Code,0)) to liReturnValb
40985>>>>>>>>>>>>>>>>>                if (liReturnValb = '7004') begin
40987>>>>>>>>>>>>>>>>>                                               error 7004 "“§á¨®œ  ¦ ˜¤é«œ¨¦ª ™˜Ÿ£æª !"
40988>>>>>>>>>>>>>>>>>>
40988>>>>>>>>>>>>>>>>>                                               Function_Return 8004
40989>>>>>>>>>>>>>>>>>                                            end
40989>>>>>>>>>>>>>>>>>>
40989>>>>>>>>>>>>>>>>>
40989>>>>>>>>>>>>>>>>>            end
40989>>>>>>>>>>>>>>>>>>
40989>>>>>>>>>>>>>>>>>            else Function_Return 0  //exit function ok!!!
40991>>>>>>>>>>>>>>>>>         end
40991>>>>>>>>>>>>>>>>>>
40991>>>>>>>>>>>>>>>>>         function_return 0
40992>>>>>>>>>>>>>>>>>    End_Function   // fiValidateGplanFields
40993>>>>>>>>>>>>>>>>>
40993>>>>>>>>>>>>>>>>>
40993>>>>>>>>>>>>>>>>>//-----------------------------------------------Save Operation ----------------------------------------------------
40993>>>>>>>>>>>>>>>>>
40993>>>>>>>>>>>>>>>>>
40993>>>>>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
40994>>>>>>>>>>>>>>>>>        //Forward Send Operation_Not_Allowed  iError_Num
40994>>>>>>>>>>>>>>>>>        // Insert Code Here
40994>>>>>>>>>>>>>>>>>                 if iError_num eq 127  error 127 ((Trim(Gplan.Gplan_Code))+" Wrong Format !!!! \n\n")
40997>>>>>>>>>>>>>>>>>            Else if iError_num eq 128  error 128 ("Not a valid Data Entry.  Account is Missing !!!!\n\n"+Gplan.Gplan_Code)
41001>>>>>>>>>>>>>>>>>            Else if iError_num eq 129  error 129 ("Not a valid Data Entry.  Bathmos is Missing !!!!\n\n"+Gplan.Gplan_Code)
41005>>>>>>>>>>>>>>>>>            Else if iError_num eq 130  error 130 ("Not a valid Data Entry.  Previews Account is Missing !!!!\n\n"+Gplan.Gplan_Code)
41009>>>>>>>>>>>>>>>>>            Else if iError_num eq 1100  error 1100 "DDC:150 - ‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
41013>>>>>>>>>>>>>>>>>            Else if iError_num eq 2100  error 2100 "DDC:150 - ‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
41017>>>>>>>>>>>>>>>>>            Else if iError_num eq 7001 error 8001 ("Anoep Does not Exist !!!!\n\n"+Gplan.Gplan_Code)
41021>>>>>>>>>>>>>>>>>            Else if iError_num eq 7002 error 8002 ("Last Exists\n\n!!!! "+Gplan.Gplan_Code)
41025>>>>>>>>>>>>>>>>>            Else if iError_num eq 7003 error 8003 ("Previous batmos is last  !!!!\n\n"+Gplan.Gplan_Code)
41029>>>>>>>>>>>>>>>>>            Else if iError_num eq 7004 error 8004 ("Greater bathmos exists  !!!!\n\n"+Gplan.Gplan_Code)
41033>>>>>>>>>>>>>>>>>            Else if iError_num eq 7010 error 7010 ("Greater bathmos exists  !!!!\n\n"+Gplan.Gplan_Code)
41037>>>>>>>>>>>>>>>>>            Else if (iError_num = 1001) error 1001 ("‹ž ˜§¦›œ¡«æª ®˜¨˜¡«ã¨˜ª š ˜ ¡à› ¡æ Š.‘ !\n\n€§¦›œ¡«¦å ®˜¨˜¡«ã¨œª : '" + (psValidChars(Self)) + "'")
41041>>>>>>>>>>>>>>>>>            Else Forward Send Operation_Not_Allowed  iError_Num
41044>>>>>>>>>>>>>>>>>    End_Procedure
41045>>>>>>>>>>>>>>>>>
41045>>>>>>>>>>>>>>>>>
41045>>>>>>>>>>>>>>>>>    Procedure Clear_From_Bpo
41046>>>>>>>>>>>>>>>>>        Clear Gplan
41047>>>>>>>>>>>>>>>>>    End_Procedure
41048>>>>>>>>>>>>>>>>>
41048>>>>>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
41049>>>>>>>>>>>>>>>>>        Local Integer iReturnVal iField##
41050>>>>>>>>>>>>>>>>>        locaL string lsVal##
41050>>>>>>>>>>>>>>>>>
41050>>>>>>>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
41052>>>>>>>>>>>>>>>>>
41052>>>>>>>>>>>>>>>>>
41052>>>>>>>>>>>>>>>>>        If (Not(iReturnVal))Begin
41054>>>>>>>>>>>>>>>>>            If (Not(Current_Record(Self))) Move (fiCheckValidChars(Self,Gplan.Gplan_Code,((Trim(Year.Year_Valid_Char))+(Trim(Year.Year_Delimiter))))) to iReturnVal
41057>>>>>>>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
41060>>>>>>>>>>>>>>>>>            If (Gplan.Gplan_Code    = "") Send Operation_Not_Allowed 128
41063>>>>>>>>>>>>>>>>>            If (Gplan.Gplan_Bathmos = 0 ) Send Operation_Not_Allowed 129
41066>>>>>>>>>>>>>>>>>            If (;                 (Gplan.Gplan_Bathmos <> 1) and;                 (Gplan.Gplan_Anoep = "");               ) Send Operation_Not_Allowed 130
41069>>>>>>>>>>>>>>>>>            For iField## from 4 to 4   // Field number for Starting and Ending pp's ???????
41075>>>>>>>>>>>>>>>>>>
41075>>>>>>>>>>>>>>>>>
41075>>>>>>>>>>>>>>>>>                Move (private_Man_Gplan_Code(self,iField##,Gplan.Gplan_Code,1))     to iReturnVal
41076>>>>>>>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
41079>>>>>>>>>>>>>>>>>
41079>>>>>>>>>>>>>>>>>                Move (fiBACKWARD_CHECK(self,Gplan.Gplan_Code,Gplan.Gplan_Bathmos)) to iReturnVal
41080>>>>>>>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
41083>>>>>>>>>>>>>>>>>
41083>>>>>>>>>>>>>>>>>                Move (fiFORWARD_CHECK(self,Gplan.Gplan_Code,0))                     to iReturnVal
41084>>>>>>>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
41087>>>>>>>>>>>>>>>>>
41087>>>>>>>>>>>>>>>>>            Loop
41088>>>>>>>>>>>>>>>>>>
41088>>>>>>>>>>>>>>>>>              //1100:cby = globals
41088>>>>>>>>>>>>>>>>>              If ( ;                   (Not(Gplan.Company_Code = SysCurGL.Company_Code)) or;                   (Not(Gplan.Branch_Code  = SysCurGL.Branch_Code )) or;                   (Not(Gplan.Year_Year    = SysCurGL.Year_Year   ));                  ) Send Operation_Not_Allowed 1100
41091>>>>>>>>>>>>>>>>>        End
41091>>>>>>>>>>>>>>>>>>
41091>>>>>>>>>>>>>>>>>        Function_Return iReturnVal
41092>>>>>>>>>>>>>>>>>    End_Function
41093>>>>>>>>>>>>>>>>>
41093>>>>>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
41094>>>>>>>>>>>>>>>>>        Local Integer iReturnVal liReturnValb##
41095>>>>>>>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
41097>>>>>>>>>>>>>>>>>
41097>>>>>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
41099>>>>>>>>>>>>>>>>>            // Insert Code Here
41099>>>>>>>>>>>>>>>>>               Move (fiFORWARD_CHECK(Self,Gplan.Gplan_Code,1)) to liReturnValb##
41100>>>>>>>>>>>>>>>>>               If (liReturnValb##>1) Send Operation_Not_Allowed liReturnValb##
41103>>>>>>>>>>>>>>>>>              //2100:cby = globals
41103>>>>>>>>>>>>>>>>>              If ( ;                   (Not(Gplan.Company_Code = SysCurGL.Company_Code)) or;                   (Not(Gplan.Branch_Code  = SysCurGL.Branch_Code )) or;                   (Not(Gplan.Year_Year    = SysCurGL.Year_Year   ));                  )                                                   Send Operation_Not_Allowed 2100
41106>>>>>>>>>>>>>>>>>        End
41106>>>>>>>>>>>>>>>>>>
41106>>>>>>>>>>>>>>>>>
41106>>>>>>>>>>>>>>>>>        Function_Return iReturnVal
41107>>>>>>>>>>>>>>>>>    End_Function
41108>>>>>>>>>>>>>>>>>
41108>>>>>>>>>>>>>>>>>
41108>>>>>>>>>>>>>>>>>//    Procedure Update
41108>>>>>>>>>>>>>>>>>//        Forward Send Update
41108>>>>>>>>>>>>>>>>>//        // Insert Code Here
41108>>>>>>>>>>>>>>>>>//        Move Company.Company_Code  to Gplan.Company_Code
41108>>>>>>>>>>>>>>>>>//        Move Branch.Branch_Code    to Gplan.Branch_Code
41108>>>>>>>>>>>>>>>>>//        Move Year.Year_Year        to Gplan.Year_Year
41108>>>>>>>>>>>>>>>>>//        Add 1 to Year.Year_NumGplan //˜¨ Ÿ£æª ¢¦š˜¨ ˜©£é¤ «žª ®¨ã©žª
41108>>>>>>>>>>>>>>>>>//    End_Procedure   // Update
41108>>>>>>>>>>>>>>>>>
41108>>>>>>>>>>>>>>>>>//    Procedure Backout
41108>>>>>>>>>>>>>>>>>//        Forward Send Backout
41108>>>>>>>>>>>>>>>>>//        Sub 1 from Year.Year_NumGplan //˜¨ Ÿ£æª ¢¦š˜¨ ˜©£é¤ «žª ®¨ã©žª
41108>>>>>>>>>>>>>>>>>//    End_Procedure //deleting
41108>>>>>>>>>>>>>>>>>
41108>>>>>>>>>>>>>>>>>
41108>>>>>>>>>>>>>>>>>
41108>>>>>>>>>>>>>>>>>    // Define_Fields:
41108>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41108>>>>>>>>>>>>>>>>>
41108>>>>>>>>>>>>>>>>>    Procedure Define_Fields
41109>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
41111>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
41111>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
41111>>>>>>>>>>>>>>>>>
41111>>>>>>>>>>>>>>>>>        Set Main_File            To Gplan.File_Number
41112>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
41113>>>>>>>>>>>>>>>>>
41113>>>>>>>>>>>>>>>>>
41113>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
41113>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gmovea.File_Number
41114>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gplanmod.File_Number
41115>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gmhnes.File_Number
41116>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gmove.File_Number
41117>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gvatd.File_Number
41118>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gpmoves.File_Number
41119>>>>>>>>>>>>>>>>>
41119>>>>>>>>>>>>>>>>>        // External (System) file structure.............
41119>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
41120>>>>>>>>>>>>>>>>>        Send Add_System_File  Syscurgl.File_Number  DD_LOCK_ON_ALL
41121>>>>>>>>>>>>>>>>>
41121>>>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gplan_Rec0  To Gplan.Gplan_Rec0
41124>>>>>>>>>>>>>>>>>
41124>>>>>>>>>>>>>>>>>        // Field-based properties.......................
41124>>>>>>>>>>>>>>>>>
41124>>>>>>>>>>>>>>>>>        // Gplan.Company_Code
41124>>>>>>>>>>>>>>>>>
41124>>>>>>>>>>>>>>>>>        // Gplan.Branch_Code
41124>>>>>>>>>>>>>>>>>
41124>>>>>>>>>>>>>>>>>        // Gplan.Year_Year
41124>>>>>>>>>>>>>>>>>
41124>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Code
41124>>>>>>>>>>>>>>>>>        Set Field_Exit_msg         Field Gplan.Gplan_Code To get_fiValidateGplanFields
41125>>>>>>>>>>>>>>>>>        Set Field_Options          Field Gplan.Gplan_Code To DD_AUTOFIND    DD_REQUIRED   
41126>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Code To (sl150(Self))
41127>>>>>>>>>>>>>>>>>
41127>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Rec0
41127>>>>>>>>>>>>>>>>>
41127>>>>>>>>>>>>>>>>>        // Gplan.Year_Recr
41127>>>>>>>>>>>>>>>>>
41127>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Descr1
41127>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Descr1 To (sl150(Self))
41128>>>>>>>>>>>>>>>>>
41128>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Descr2
41128>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Descr2 To (sl150(Self))
41129>>>>>>>>>>>>>>>>>
41129>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Bathmos
41129>>>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Bathmos To "Calulated"
41129>>>>>>>>>>>>>>>>>
41129>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Anoep
41129>>>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Anoep To "Calulated"
41129>>>>>>>>>>>>>>>>>
41129>>>>>>>>>>>>>>>>>        // Gplan.Gplan_O_Code
41129>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_O_Code To "dbComboFormSub"
41130>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_O_Code To (Gplan_Gplan_O_Code_VT(Self))
41131>>>>>>>>>>>>>>>>>
41131>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Xfer
41131>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Xfer To "dbComboFormSub"
41132>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Xfer To (Gplan_Gplan_Yn_VT(Self))
41133>>>>>>>>>>>>>>>>>
41133>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Last
41133>>>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Last To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1013)"
41133>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Last To "dbComboFormSub"
41134>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Last To (Gplan_Gplan_Yn_VT(Self))
41135>>>>>>>>>>>>>>>>>
41135>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Kin
41135>>>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Kin To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1014)"
41135>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Kin To "dbComboFormSub"
41136>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Kin To (Gplan_Gplan_Yn_VT(Self))
41137>>>>>>>>>>>>>>>>>
41137>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Kk
41137>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Kk To "dbComboFormSub"
41138>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Kk To (Gplan_Gplan_Yn_VT(Self))
41139>>>>>>>>>>>>>>>>>
41139>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Xpm
41139>>>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Xpm To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1015+1016)"
41139>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Xpm To "dbComboFormSub"
41140>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Xpm To (Gplan_Gplan_Xpm_VT(Self))
41141>>>>>>>>>>>>>>>>>
41141>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Xy
41141>>>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Xy To "•¨ž© £¦§¦ œå«˜  ©«ž¤ private.trexe «¦¬ Gmove (1017)"
41141>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Xy To "dbComboFormSub"
41142>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Xy To (Gplan_Gplan_Yn_VT(Self))
41143>>>>>>>>>>>>>>>>>
41143>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Py
41143>>>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Py To "•¨ž© £¦§¦ œå«˜  ©«ž¤ private.trexe «¦¬ Gmove (1018)"
41143>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Py To "dbComboFormSub"
41144>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Py To (Gplan_Gplan_Yn_VT(Self))
41145>>>>>>>>>>>>>>>>>
41145>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Fpaent
41145>>>>>>>>>>>>>>>>>
41145>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Fpaent_Yn
41145>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Fpaent_Yn To (Gplan_Gplan_Yn_VT(Self))
41146>>>>>>>>>>>>>>>>>
41146>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Afm
41146>>>>>>>>>>>>>>>>>
41146>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Addr
41146>>>>>>>>>>>>>>>>>
41146>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Tk
41146>>>>>>>>>>>>>>>>>
41146>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Poli
41146>>>>>>>>>>>>>>>>>
41146>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Doy
41146>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Doy To "dbComboFormSub"
41147>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Doy To (Gplan_Gplan_Doy_VT(Self))
41148>>>>>>>>>>>>>>>>>
41148>>>>>>>>>>>>>>>>>        // Gplan.Gplan_J_Code
41148>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_J_Code To "dbComboFormSub"
41149>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_J_Code To (Gplan_Gplan_J_Code_VT(Self))
41150>>>>>>>>>>>>>>>>>
41150>>>>>>>>>>>>>>>>>        // Gplan.Gplan_C_Code2
41150>>>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_C_Code2 To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1019)"
41150>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_C_Code2 To "dbComboFormSub"
41151>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_C_Code2 To (Gplan_Gplan_C_Code2_VT(Self))
41152>>>>>>>>>>>>>>>>>
41152>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Tel
41152>>>>>>>>>>>>>>>>>
41152>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Email
41152>>>>>>>>>>>>>>>>>
41152>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Resp
41152>>>>>>>>>>>>>>>>>
41152>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Bitmap
41152>>>>>>>>>>>>>>>>>
41152>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Rep_Code
41152>>>>>>>>>>>>>>>>>
41152>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Rep_Pct
41152>>>>>>>>>>>>>>>>>
41152>>>>>>>>>>>>>>>>>        // Gplan.Gplan_I_Xy_Code
41152>>>>>>>>>>>>>>>>>
41152>>>>>>>>>>>>>>>>>        // Gplan.Gplan_I_Py_Code
41152>>>>>>>>>>>>>>>>>
41152>>>>>>>>>>>>>>>>>        // Gplan.Gplan_I_Ctypkin
41152>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_I_Ctypkin To (Gtypkin(Self))
41153>>>>>>>>>>>>>>>>>
41153>>>>>>>>>>>>>>>>>        // Gplan.Gplan_I_A_Code
41153>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_I_A_Code To "dbComboFormSub"
41154>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_I_A_Code To (Gplan_Gplan_I_A_Code_VT2(Self))
41155>>>>>>>>>>>>>>>>>
41155>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Myfp
41155>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Myfp To "dbComboFormSub"
41156>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Myfp To (Gplan_Gplan_Yn_VT(Self))
41157>>>>>>>>>>>>>>>>>
41157>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Myfa
41157>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Myfa To "dbComboFormSub"
41158>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Myfa To (Gplan_Gplan_Yn_VT(Self))
41159>>>>>>>>>>>>>>>>>
41159>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfnump
41159>>>>>>>>>>>>>>>>>
41159>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfvalp
41159>>>>>>>>>>>>>>>>>
41159>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfnuma
41159>>>>>>>>>>>>>>>>>
41159>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfvala
41159>>>>>>>>>>>>>>>>>
41159>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Myf_Sump
41159>>>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Myf_Sump To "‰˜Ÿ¦¨åœ  œá¤ ¦  ®¨œé©œ ª/§ ©«é©œ ª Ÿ˜ ˜Ÿ¨¦ ©«¦ç¤ ©«ž¤ ‹“”"
41159>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Myf_Sump To "dbComboFormSub"
41160>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Myf_Sump To (Gplan_Gplan_Myf_Sum_VT(Self))
41161>>>>>>>>>>>>>>>>>
41161>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Myf_Suma
41161>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Myf_Suma To "dbComboFormSub"
41162>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Myf_Suma To (Gplan_Gplan_Myf_Sum_VT(Self))
41163>>>>>>>>>>>>>>>>>
41163>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Sx0
41163>>>>>>>>>>>>>>>>>
41163>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Sp0
41163>>>>>>>>>>>>>>>>>
41163>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Sx00
41163>>>>>>>>>>>>>>>>>
41163>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Sp00
41163>>>>>>>>>>>>>>>>>
41163>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Sxr
41163>>>>>>>>>>>>>>>>>
41163>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Spr
41163>>>>>>>>>>>>>>>>>
41163>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Sx2
41163>>>>>>>>>>>>>>>>>
41163>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Sp2
41163>>>>>>>>>>>>>>>>>
41163>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Gmhnnorec
41163>>>>>>>>>>>>>>>>>
41163>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Recr
41163>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Recr To (sl150(Self))
41164>>>>>>>>>>>>>>>>>
41164>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
41164>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
41165>>>>>>>>>>>>>>>>>
41165>>>>>>>>>>>>>>>>>    // Field_Defaults:
41165>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
41165>>>>>>>>>>>>>>>>>
41165>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
41166>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
41168>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
41168>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
41168>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Xfer To 0
41169>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Last To 0
41170>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Kin To 1
41171>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Kk To 0
41172>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Xpm To 3
41173>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Xy To 1
41174>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Py To 1
41175>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Fpaent_Yn To 0
41176>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Rep_Pct To 100
41177>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Myfp To 0
41178>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Myfa To 0
41179>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
41179>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
41180>>>>>>>>>>>>>>>>>End_Class    // Gplan_DataDictionary
41181>>>>>>>>>>>>>>>>>
41181>>>>>>>>>>>>>>>>>
41181>>>>>>>>>>>>>>>>>
41181>>>>>>>>>>>>>>>>>
41181>>>>>>>>>>>>>>>>>
41181>>>>>>>>>>>>>>>>>
41181>>>>>>>>>>>>>>>>>
41181>>>>>>>>>>>>>>>>>
41181>>>>>>>>>>>>>>>>>
41181>>>>>>>>>>>>>>>>>
41181>>>>>>>>>>>>>>>>>
41181>>>>>>>>>>>>>>>>>
41181>>>>>>>>>>>>>>>>>
41181>>>>>>>>>>>>>>>>>
41181>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
41181>>>>>>>>>>>>>>>>>
41181>>>>>>>>>>>>>>>>>Use sl150.sl         // sl150
41181>>>>>>>>>>>>>>>>>Use Gtypkin.sl       // Gtypkin
INCLUDING FILE: GTYPKIN.SL
41181>>>>>>>>>>>>>>>>>>>//AB/ Project gtypkin:Gtypkin
41181>>>>>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
41181>>>>>>>>>>>>>>>>>>>//AB/         Set ProjectName to "gtypkin:Gtypkin"
41181>>>>>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "gtypkin.SL"
41181>>>>>>>>>>>>>>>>>>>
41181>>>>>>>>>>>>>>>>>>>// Project Object Structure
41181>>>>>>>>>>>>>>>>>>>//   gtypkin is a dbModalPanel
41181>>>>>>>>>>>>>>>>>>>//     Gthhmgio_DD is a DataDictionary
41181>>>>>>>>>>>>>>>>>>>//     Gtypkin_DD is a DataDictionary
41181>>>>>>>>>>>>>>>>>>>//     oSelList is a dbList
41181>>>>>>>>>>>>>>>>>>>//     oOK_bn is a Button
41181>>>>>>>>>>>>>>>>>>>//     oCancel_bn is a Button
41181>>>>>>>>>>>>>>>>>>>//     oSearch_bn is a Button
41181>>>>>>>>>>>>>>>>>>>
41181>>>>>>>>>>>>>>>>>>>// Register all objects
41181>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio_DD
41181>>>>>>>>>>>>>>>>>>>Register_Object Gtypkin_DD
41181>>>>>>>>>>>>>>>>>>>Register_Object gtypkin
41181>>>>>>>>>>>>>>>>>>>Register_Object oCancel_bn
41181>>>>>>>>>>>>>>>>>>>Register_Object oOK_bn
41181>>>>>>>>>>>>>>>>>>>Register_Object oSearch_bn
41181>>>>>>>>>>>>>>>>>>>Register_Object oSelList
41181>>>>>>>>>>>>>>>>>>>
41181>>>>>>>>>>>>>>>>>>>
41181>>>>>>>>>>>>>>>>>>>    //AB-IgnoreStart
41181>>>>>>>>>>>>>>>>>>>
41181>>>>>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
41181>>>>>>>>>>>>>>>>>>>
41181>>>>>>>>>>>>>>>>>>>
41181>>>>>>>>>>>>>>>>>>>    Use GTHHMGIO.DD
INCLUDING FILE: GTHHMGIO.DD
41181>>>>>>>>>>>>>>>>>>>>>//DDB-FileStart
41181>>>>>>>>>>>>>>>>>>>>>//DDB-HeaderStart
41181>>>>>>>>>>>>>>>>>>>>>
41181>>>>>>>>>>>>>>>>>>>>>// File Name : GTHHMGIO.DD
41181>>>>>>>>>>>>>>>>>>>>>// Class Name: Gthhmgio_DataDictionary
41181>>>>>>>>>>>>>>>>>>>>>// Revision  : 33
41181>>>>>>>>>>>>>>>>>>>>>// Version   : 2
41181>>>>>>>>>>>>>>>>>>>>>
41181>>>>>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
41181>>>>>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
41181>>>>>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41181>>>>>>>>>>>>>>>>>>>>>
41181>>>>>>>>>>>>>>>>>>>>>Open Gthhmgio
INCLUDING FILE: GTHHMGIO.FD
41183>>>>>>>>>>>>>>>>>>>>>Open Gtypkin
41185>>>>>>>>>>>>>>>>>>>>>Open Gthaa
INCLUDING FILE: GTHAA.FD
41187>>>>>>>>>>>>>>>>>>>>>Open Sysrecg
41189>>>>>>>>>>>>>>>>>>>>>
41189>>>>>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
41189>>>>>>>>>>>>>>>>>>>>>//DDB-ValidationStart
41189>>>>>>>>>>>>>>>>>>>>>
41189>>>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio_Gthhmgio_Period_VT
41189>>>>>>>>>>>>>>>>>>>>>
41189>>>>>>>>>>>>>>>>>>>>>Object Gthhmgio_Gthhmgio_Period_VT  is a CodeValidationTable
41191>>>>>>>>>>>>>>>>>>>>>    Set Type_Value        To "PERIOD"
41192>>>>>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
41192>>>>>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
41192>>>>>>>>>>>>>>>>>>>>>End_Object   // Gthhmgio_Gthhmgio_Period_VT
41193>>>>>>>>>>>>>>>>>>>>>//DDB-ValidationEnd
41193>>>>>>>>>>>>>>>>>>>>>//DDB-SelectionStart
41193>>>>>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList Gthhmgio  Gthhmgio.SL
41193>>>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio
41193>>>>>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
41193>>>>>>>>>>>>>>>>>>>>>
41193>>>>>>>>>>>>>>>>>>>>>Class Gthhmgio_DataDictionary  is a DataDictionary_Sec
41194>>>>>>>>>>>>>>>>>>>>>
41194>>>>>>>>>>>>>>>>>>>>>
41194>>>>>>>>>>>>>>>>>>>>>    // Define_Fields:
41194>>>>>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41194>>>>>>>>>>>>>>>>>>>>>
41194>>>>>>>>>>>>>>>>>>>>>    Procedure Define_Fields
41195>>>>>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
41197>>>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
41197>>>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
41197>>>>>>>>>>>>>>>>>>>>>
41197>>>>>>>>>>>>>>>>>>>>>        Set Main_File            To Gthhmgio.File_Number
41198>>>>>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
41199>>>>>>>>>>>>>>>>>>>>>
41199>>>>>>>>>>>>>>>>>>>>>
41199>>>>>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
41199>>>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gtypkin.File_Number
41200>>>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gthaa.File_Number
41201>>>>>>>>>>>>>>>>>>>>>
41201>>>>>>>>>>>>>>>>>>>>>        // External (System) file structure.............
41201>>>>>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
41202>>>>>>>>>>>>>>>>>>>>>
41202>>>>>>>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gthhmgio_Rec0  To Gthhmgio.Gthhmgio_Rec0
41205>>>>>>>>>>>>>>>>>>>>>
41205>>>>>>>>>>>>>>>>>>>>>        // Field-based properties.......................
41205>>>>>>>>>>>>>>>>>>>>>
41205>>>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Code
41205>>>>>>>>>>>>>>>>>>>>>        Set Field_Options          Field Gthhmgio.Gthhmgio_Code To DD_AUTOFIND   
41206>>>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gthhmgio.Gthhmgio_Code To (Gthhmgio(Self))
41207>>>>>>>>>>>>>>>>>>>>>        Set Key_Field_State        Field Gthhmgio.Gthhmgio_Code To TRUE
41208>>>>>>>>>>>>>>>>>>>>>
41208>>>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Rec0
41208>>>>>>>>>>>>>>>>>>>>>
41208>>>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Descr
41208>>>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gthhmgio.Gthhmgio_Descr To (Gthhmgio(Self))
41209>>>>>>>>>>>>>>>>>>>>>
41209>>>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Period
41209>>>>>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gthhmgio.Gthhmgio_Period To (Gthhmgio_Gthhmgio_Period_VT(Self))
41210>>>>>>>>>>>>>>>>>>>>>
41210>>>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Recr
41210>>>>>>>>>>>>>>>>>>>>>        Set Field_Options          Field Gthhmgio.Gthhmgio_Recr To DD_AUTOFIND   
41211>>>>>>>>>>>>>>>>>>>>>        Set Key_Field_State        Field Gthhmgio.Gthhmgio_Recr To TRUE
41212>>>>>>>>>>>>>>>>>>>>>
41212>>>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
41212>>>>>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
41213>>>>>>>>>>>>>>>>>>>>>
41213>>>>>>>>>>>>>>>>>>>>>    // Field_Defaults:
41213>>>>>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
41213>>>>>>>>>>>>>>>>>>>>>
41213>>>>>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
41214>>>>>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
41216>>>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
41216>>>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
41216>>>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
41216>>>>>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
41217>>>>>>>>>>>>>>>>>>>>>End_Class    // Gthhmgio_DataDictionary
41218>>>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
41218>>>>>>>>>>>>>>>>>>>>>
41218>>>>>>>>>>>>>>>>>>>>>Use Gthhmgio.SL      // Gthhmgio
INCLUDING FILE: GTHHMGIO.SL
41218>>>>>>>>>>>>>>>>>>>>>>>//AB/ Project Gthhmgio:Gthhmgio
41218>>>>>>>>>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
41218>>>>>>>>>>>>>>>>>>>>>>>//AB/         Set ProjectName to "Gthhmgio:Gthhmgio"
41218>>>>>>>>>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "Gthhmgio.SL"
41218>>>>>>>>>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
41218>>>>>>>>>>>>>>>>>>>>>>>
41218>>>>>>>>>>>>>>>>>>>>>>>// Project Object Structure
41218>>>>>>>>>>>>>>>>>>>>>>>//   Gthhmgio is a dbModalPanel
41218>>>>>>>>>>>>>>>>>>>>>>>//     Gthhmgio_DD is a DataDictionary
41218>>>>>>>>>>>>>>>>>>>>>>>//     oSelList is a dbList
41218>>>>>>>>>>>>>>>>>>>>>>>//     oOK_bn is a Button
41218>>>>>>>>>>>>>>>>>>>>>>>//     oCancel_bn is a Button
41218>>>>>>>>>>>>>>>>>>>>>>>//     oSearch_bn is a Button
41218>>>>>>>>>>>>>>>>>>>>>>>
41218>>>>>>>>>>>>>>>>>>>>>>>// Register all objects
41218>>>>>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio_DD
41218>>>>>>>>>>>>>>>>>>>>>>>Register_Object oCancel_bn
41218>>>>>>>>>>>>>>>>>>>>>>>Register_Object oOK_bn
41218>>>>>>>>>>>>>>>>>>>>>>>Register_Object oSearch_bn
41218>>>>>>>>>>>>>>>>>>>>>>>Register_Object oSelList
41218>>>>>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio
41218>>>>>>>>>>>>>>>>>>>>>>>
41218>>>>>>>>>>>>>>>>>>>>>>>
41218>>>>>>>>>>>>>>>>>>>>>>>    //AB-IgnoreStart
41218>>>>>>>>>>>>>>>>>>>>>>>
41218>>>>>>>>>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
41218>>>>>>>>>>>>>>>>>>>>>>>
41218>>>>>>>>>>>>>>>>>>>>>>>
41218>>>>>>>>>>>>>>>>>>>>>>>    Use GTHHMGIO.DD
41218>>>>>>>>>>>>>>>>>>>>>>>
41218>>>>>>>>>>>>>>>>>>>>>>>    //AB-IgnoreEnd
41218>>>>>>>>>>>>>>>>>>>>>>>
41218>>>>>>>>>>>>>>>>>>>>>>>    CD_Popup_Object Gthhmgio is a dbModalPanel
41237>>>>>>>>>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
41238>>>>>>>>>>>>>>>>>>>>>>>        Set Label to "Šå©«˜ †£œ¨¦¢¦šåà¤"
41239>>>>>>>>>>>>>>>>>>>>>>>        Set Size to 148 297
41240>>>>>>>>>>>>>>>>>>>>>>>        Set Location to 4 5
41241>>>>>>>>>>>>>>>>>>>>>>>
41241>>>>>>>>>>>>>>>>>>>>>>>        //AB-DDOStart
41241>>>>>>>>>>>>>>>>>>>>>>>
41241>>>>>>>>>>>>>>>>>>>>>>>        Object Gthhmgio_DD is a Gthhmgio_DataDictionary
41243>>>>>>>>>>>>>>>>>>>>>>>        End_Object    // Gthhmgio_DD
41244>>>>>>>>>>>>>>>>>>>>>>>
41244>>>>>>>>>>>>>>>>>>>>>>>        Set Main_DD to (Gthhmgio_DD(self))
41245>>>>>>>>>>>>>>>>>>>>>>>        Set Server to (Gthhmgio_DD(self))
41246>>>>>>>>>>>>>>>>>>>>>>>
41246>>>>>>>>>>>>>>>>>>>>>>>        //AB-DDOEnd
41246>>>>>>>>>>>>>>>>>>>>>>>
41246>>>>>>>>>>>>>>>>>>>>>>>        Object oSelList is a dbList
41248>>>>>>>>>>>>>>>>>>>>>>>            Set Main_File to Gthhmgio.File_Number
41249>>>>>>>>>>>>>>>>>>>>>>>            Set Size to 105 280
41250>>>>>>>>>>>>>>>>>>>>>>>            Set Location to 6 6
41251>>>>>>>>>>>>>>>>>>>>>>>
41251>>>>>>>>>>>>>>>>>>>>>>>            Begin_Row
41254>>>>>>>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_code
41255>>>>>>>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_descr
41256>>>>>>>>>>>>>>>>>>>>>>>            End_Row
41261>>>>>>>>>>>>>>>>>>>>>>>
41261>>>>>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 52
41262>>>>>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
41263>>>>>>>>>>>>>>>>>>>>>>>
41263>>>>>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 220
41264>>>>>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
41265>>>>>>>>>>>>>>>>>>>>>>>
41265>>>>>>>>>>>>>>>>>>>>>>>        End_Object    // oSelList
41266>>>>>>>>>>>>>>>>>>>>>>>
41266>>>>>>>>>>>>>>>>>>>>>>>        Object oOK_bn is a Button
41268>>>>>>>>>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
41269>>>>>>>>>>>>>>>>>>>>>>>            Set Location to 111 127
41270>>>>>>>>>>>>>>>>>>>>>>>
41270>>>>>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
41270>>>>>>>>>>>>>>>>>>>>>>>            Procedure OnClick
41272>>>>>>>>>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
41273>>>>>>>>>>>>>>>>>>>>>>>            End_Procedure
41274>>>>>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
41274>>>>>>>>>>>>>>>>>>>>>>>
41274>>>>>>>>>>>>>>>>>>>>>>>        End_Object    // oOK_bn
41275>>>>>>>>>>>>>>>>>>>>>>>
41275>>>>>>>>>>>>>>>>>>>>>>>        Object oCancel_bn is a Button
41277>>>>>>>>>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
41278>>>>>>>>>>>>>>>>>>>>>>>            Set Location to 111 181
41279>>>>>>>>>>>>>>>>>>>>>>>
41279>>>>>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
41279>>>>>>>>>>>>>>>>>>>>>>>            Procedure OnClick
41281>>>>>>>>>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
41282>>>>>>>>>>>>>>>>>>>>>>>            End_Procedure
41283>>>>>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
41283>>>>>>>>>>>>>>>>>>>>>>>
41283>>>>>>>>>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
41284>>>>>>>>>>>>>>>>>>>>>>>
41284>>>>>>>>>>>>>>>>>>>>>>>        Object oSearch_bn is a Button
41286>>>>>>>>>>>>>>>>>>>>>>>            Set Label to "&€¤˜ã«ž©ž..."
41287>>>>>>>>>>>>>>>>>>>>>>>            Set Location to 111 237
41288>>>>>>>>>>>>>>>>>>>>>>>
41288>>>>>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
41288>>>>>>>>>>>>>>>>>>>>>>>            Procedure OnClick
41290>>>>>>>>>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
41291>>>>>>>>>>>>>>>>>>>>>>>            End_Procedure
41292>>>>>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
41292>>>>>>>>>>>>>>>>>>>>>>>
41292>>>>>>>>>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
41293>>>>>>>>>>>>>>>>>>>>>>>
41293>>>>>>>>>>>>>>>>>>>>>>>
41293>>>>>>>>>>>>>>>>>>>>>>>        //AB-StoreStart
41293>>>>>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
41294>>>>>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
41295>>>>>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
41296>>>>>>>>>>>>>>>>>>>>>>>        //AB-StoreEnd
41296>>>>>>>>>>>>>>>>>>>>>>>
41296>>>>>>>>>>>>>>>>>>>>>>>    CD_End_Object    // Gthhmgio
41298>>>>>>>>>>>>>>>>>>>>>>>>
41298>>>>>>>>>>>>>>>>>>>>>>>
41298>>>>>>>>>>>>>>>>>>>>>>>//AB/     End_Object    // prj
41298>>>>>>>>>>>>>>>>>>>>>
41298>>>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
41298>>>>>>>>>>>>>>>>>>>>>//DDB-FileEnd
41298>>>>>>>>>>>>>>>>>>>    Use GTYPKIN.DD
INCLUDING FILE: GTYPKIN.DD
41298>>>>>>>>>>>>>>>>>>>>>//DDB-FileStart
41298>>>>>>>>>>>>>>>>>>>>>//DDB-HeaderStart
41298>>>>>>>>>>>>>>>>>>>>>
41298>>>>>>>>>>>>>>>>>>>>>// File Name : GTYPKIN.DD
41298>>>>>>>>>>>>>>>>>>>>>// Class Name: Gtypkin_DataDictionary
41298>>>>>>>>>>>>>>>>>>>>>// Revision  : 44
41298>>>>>>>>>>>>>>>>>>>>>// Version   : 2
41298>>>>>>>>>>>>>>>>>>>>>
41298>>>>>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
41298>>>>>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
41298>>>>>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41298>>>>>>>>>>>>>>>>>>>>>
41298>>>>>>>>>>>>>>>>>>>>>Open Gtypkin
41300>>>>>>>>>>>>>>>>>>>>>Open Garticl
41302>>>>>>>>>>>>>>>>>>>>>Open Gflagkin
INCLUDING FILE: GFLAGKIN.FD
41304>>>>>>>>>>>>>>>>>>>>>Open Gparticl
INCLUDING FILE: GPARTICL.FD
41306>>>>>>>>>>>>>>>>>>>>>Open Gthhmgio
41308>>>>>>>>>>>>>>>>>>>>>Open Sysrecg
41310>>>>>>>>>>>>>>>>>>>>>
41310>>>>>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
41310>>>>>>>>>>>>>>>>>>>>>//DDB-SelectionStart
41310>>>>>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList gtypkin  gtypkin.SL
41310>>>>>>>>>>>>>>>>>>>>>Register_Object gtypkin
41310>>>>>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
41310>>>>>>>>>>>>>>>>>>>>>Open SysCurGL
41312>>>>>>>>>>>>>>>>>>>>>
41312>>>>>>>>>>>>>>>>>>>>>Class Gtypkin_DataDictionary  is a DataDictionary_Sec
41313>>>>>>>>>>>>>>>>>>>>>
41313>>>>>>>>>>>>>>>>>>>>>    Procedure Entry_Order_Date  Integer iField  Date dDate
41314>>>>>>>>>>>>>>>>>>>>>         // Add a default date if the field is blank
41314>>>>>>>>>>>>>>>>>>>>>         Integer Changed
41315>>>>>>>>>>>>>>>>>>>>>         Get Field_Changed_State iField to Changed
41316>>>>>>>>>>>>>>>>>>>>>         If (Changed=0 AND dDate =0) Begin
41318>>>>>>>>>>>>>>>>>>>>>             SysDate4 dDate
41319>>>>>>>>>>>>>>>>>>>>>             Set Field_Default_Value iField to dDate
41320>>>>>>>>>>>>>>>>>>>>>         End
41320>>>>>>>>>>>>>>>>>>>>>>
41320>>>>>>>>>>>>>>>>>>>>>    End_Procedure
41321>>>>>>>>>>>>>>>>>>>>>
41321>>>>>>>>>>>>>>>>>>>>>    Procedure Construct_Object
41322>>>>>>>>>>>>>>>>>>>>>        Forward Send Construct_Object
41324>>>>>>>>>>>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
41325>>>>>>>>>>>>>>>>>>>>>        Property Date    pdDefault_Hmnia    Public 0
41326>>>>>>>>>>>>>>>>>>>>>        Property Integer piRate             Public 0
41327>>>>>>>>>>>>>>>>>>>>>        Property Integer piGthhmgio_dd      Public 0
41328>>>>>>>>>>>>>>>>>>>>>    End_Procedure   // Construct_Object
41329>>>>>>>>>>>>>>>>>>>>>
41329>>>>>>>>>>>>>>>>>>>>>    Procedure OnConstrain
41330>>>>>>>>>>>>>>>>>>>>>        Forward Send OnConstrain
41332>>>>>>>>>>>>>>>>>>>>>        If (piMustNOTConstrain(Self)) Begin
41334>>>>>>>>>>>>>>>>>>>>>        End
41334>>>>>>>>>>>>>>>>>>>>>>
41334>>>>>>>>>>>>>>>>>>>>>        Else Begin
41335>>>>>>>>>>>>>>>>>>>>>            Constrain Gtypkin.Company_Code  eq SysCurGL.Company_Code
41337>>>>>>>>>>>>>>>>>>>>>            Constrain Gtypkin.Branch_Code   eq SysCurGL.Branch_Code
41339>>>>>>>>>>>>>>>>>>>>>            Constrain Gtypkin.Year_Year     eq SysCurGL.Year_Year
41341>>>>>>>>>>>>>>>>>>>>>        End
41341>>>>>>>>>>>>>>>>>>>>>>
41341>>>>>>>>>>>>>>>>>>>>>    End_Procedure
41342>>>>>>>>>>>>>>>>>>>>>
41342>>>>>>>>>>>>>>>>>>>>>    Procedure Update
41343>>>>>>>>>>>>>>>>>>>>>        Forward Send Update
41345>>>>>>>>>>>>>>>>>>>>>        // Insert Code Here
41345>>>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Company_Code  to Gtypkin.Company_Code
41346>>>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Branch_Code   to Gtypkin.Branch_Code
41347>>>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Year_Year     to Gtypkin.Year_Year
41348>>>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Year_Recr     to Gtypkin.Year_Recr
41349>>>>>>>>>>>>>>>>>>>>>        Move Gthhmgio.Gthhmgio_Code to Gtypkin.Gthhmgio_Code
41350>>>>>>>>>>>>>>>>>>>>>    End_Procedure   // Update
41351>>>>>>>>>>>>>>>>>>>>>
41351>>>>>>>>>>>>>>>>>>>>>    Procedure Creating
41352>>>>>>>>>>>>>>>>>>>>>        Forward Send Creating
41354>>>>>>>>>>>>>>>>>>>>>        // Insert Code Here
41354>>>>>>>>>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurGL.Branch_Site))+;                         (Trim(String(Gtypkin.Gtypkin_Rec0)))))) to Gtypkin.Gtypkin_Recr
41355>>>>>>>>>>>>>>>>>>>>>    End_Procedure   // Creating
41356>>>>>>>>>>>>>>>>>>>>>
41356>>>>>>>>>>>>>>>>>>>>>
41356>>>>>>>>>>>>>>>>>>>>>
41356>>>>>>>>>>>>>>>>>>>>>//----------------------------------------------------------------------------
41356>>>>>>>>>>>>>>>>>>>>>
41356>>>>>>>>>>>>>>>>>>>>>//    Procedure Creating
41356>>>>>>>>>>>>>>>>>>>>>//              Forward Send Creating
41356>>>>>>>>>>>>>>>>>>>>>//              Add 1 to Year.Year_NumGtypkin //˜¨ Ÿ£æª «ç§à¤ ¡ ¤ã©œà¤ «žª ®¨ã©žª
41356>>>>>>>>>>>>>>>>>>>>>//    End_Procedure //creating
41356>>>>>>>>>>>>>>>>>>>>>//    Procedure Deleting
41356>>>>>>>>>>>>>>>>>>>>>//              Forward Send Deleting
41356>>>>>>>>>>>>>>>>>>>>>//              Sub 1 from Year.Year_NumGtypkin //˜¨ Ÿ£æª «ç§à¤ ¡ ¤ã©œà¤ «žª ®¨ã©žª
41356>>>>>>>>>>>>>>>>>>>>>//    End_Procedure //deleting
41356>>>>>>>>>>>>>>>>>>>>>
41356>>>>>>>>>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
41357>>>>>>>>>>>>>>>>>>>>>        Integer iReturnVal
41358>>>>>>>>>>>>>>>>>>>>>        Forward Get Validate_Save To iReturnVal
41360>>>>>>>>>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
41362>>>>>>>>>>>>>>>>>>>>>            //1100:cby = globals
41362>>>>>>>>>>>>>>>>>>>>>            If ( ;                (Not(Gtypkin.Company_Code = SysCurGL.Company_Code)) or;                (Not(Gtypkin.Branch_Code  = SysCurGL.Branch_Code )) or;                (Not(Gtypkin.Year_Year    = SysCurGL.Year_Year   ));                ) Send Operation_Not_Allowed 1100
41365>>>>>>>>>>>>>>>>>>>>>        End
41365>>>>>>>>>>>>>>>>>>>>>>
41365>>>>>>>>>>>>>>>>>>>>>        Function_Return iReturnVal
41366>>>>>>>>>>>>>>>>>>>>>    End_Function   //validate_save
41367>>>>>>>>>>>>>>>>>>>>>
41367>>>>>>>>>>>>>>>>>>>>>
41367>>>>>>>>>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
41368>>>>>>>>>>>>>>>>>>>>>        Integer iReturnVal
41369>>>>>>>>>>>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
41371>>>>>>>>>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
41373>>>>>>>>>>>>>>>>>>>>>            //2100:cby = globals
41373>>>>>>>>>>>>>>>>>>>>>            If ( ;                (Not(Gtypkin.Company_Code = SysCurGL.Company_Code)) or;                (Not(Gtypkin.Branch_Code  = SysCurGL.Branch_Code )) or;                (Not(Gtypkin.Year_Year    = SysCurGL.Year_Year   ));                ) Send Operation_Not_Allowed 2100
41376>>>>>>>>>>>>>>>>>>>>>        End
41376>>>>>>>>>>>>>>>>>>>>>>
41376>>>>>>>>>>>>>>>>>>>>>        Function_Return iReturnVal
41377>>>>>>>>>>>>>>>>>>>>>    End_Function   // validate_delete
41378>>>>>>>>>>>>>>>>>>>>>
41378>>>>>>>>>>>>>>>>>>>>>
41378>>>>>>>>>>>>>>>>>>>>>
41378>>>>>>>>>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
41379>>>>>>>>>>>>>>>>>>>>>              Case Begin
41379>>>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1100)
41381>>>>>>>>>>>>>>>>>>>>>                        Error 1100 "DDC 151:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
41382>>>>>>>>>>>>>>>>>>>>>>
41382>>>>>>>>>>>>>>>>>>>>>                        Case Break
41383>>>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 2100)
41386>>>>>>>>>>>>>>>>>>>>>                        Error 2100 "DDC 151:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
41387>>>>>>>>>>>>>>>>>>>>>>
41387>>>>>>>>>>>>>>>>>>>>>                        Case Break
41388>>>>>>>>>>>>>>>>>>>>>                   Case Else
41388>>>>>>>>>>>>>>>>>>>>>                        Forward Send Operation_Not_Allowed  iError_Num
41390>>>>>>>>>>>>>>>>>>>>>              Case End
41390>>>>>>>>>>>>>>>>>>>>>    End_Procedure   //operation_not_allowed
41391>>>>>>>>>>>>>>>>>>>>>
41391>>>>>>>>>>>>>>>>>>>>>
41391>>>>>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
41392>>>>>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
41394>>>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
41394>>>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
41394>>>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
41394>>>>>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
41395>>>>>>>>>>>>>>>>>>>>>
41395>>>>>>>>>>>>>>>>>>>>>
41395>>>>>>>>>>>>>>>>>>>>>
41395>>>>>>>>>>>>>>>>>>>>>    // Define_Fields:
41395>>>>>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41395>>>>>>>>>>>>>>>>>>>>>
41395>>>>>>>>>>>>>>>>>>>>>    Procedure Define_Fields
41396>>>>>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
41398>>>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
41398>>>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
41398>>>>>>>>>>>>>>>>>>>>>
41398>>>>>>>>>>>>>>>>>>>>>        Set Main_File            To Gtypkin.File_Number
41399>>>>>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
41400>>>>>>>>>>>>>>>>>>>>>
41400>>>>>>>>>>>>>>>>>>>>>
41400>>>>>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
41400>>>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Garticl.File_Number
41401>>>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gflagkin.File_Number
41402>>>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gparticl.File_Number
41403>>>>>>>>>>>>>>>>>>>>>
41403>>>>>>>>>>>>>>>>>>>>>        // Parent (Server) file structure...............
41403>>>>>>>>>>>>>>>>>>>>>        Send Add_Server_File  Gthhmgio.File_Number
41404>>>>>>>>>>>>>>>>>>>>>
41404>>>>>>>>>>>>>>>>>>>>>        // External (System) file structure.............
41404>>>>>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
41405>>>>>>>>>>>>>>>>>>>>>
41405>>>>>>>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gtypkin_Rec0  To Gtypkin.Gtypkin_Rec0
41408>>>>>>>>>>>>>>>>>>>>>
41408>>>>>>>>>>>>>>>>>>>>>        // Field-based properties.......................
41408>>>>>>>>>>>>>>>>>>>>>
41408>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Company_Code
41408>>>>>>>>>>>>>>>>>>>>>
41408>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Branch_Code
41408>>>>>>>>>>>>>>>>>>>>>
41408>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Year_Year
41408>>>>>>>>>>>>>>>>>>>>>
41408>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Code
41408>>>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gtypkin.Gtypkin_Code To (gtypkin(Self))
41409>>>>>>>>>>>>>>>>>>>>>
41409>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Rec0
41409>>>>>>>>>>>>>>>>>>>>>
41409>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Year_Recr
41409>>>>>>>>>>>>>>>>>>>>>
41409>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gthhmgio_Code
41409>>>>>>>>>>>>>>>>>>>>>
41409>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gthhmgio_Recr
41409>>>>>>>>>>>>>>>>>>>>>
41409>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Descr
41409>>>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gtypkin.Gtypkin_Descr To (gtypkin(Self))
41410>>>>>>>>>>>>>>>>>>>>>
41410>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Anti
41410>>>>>>>>>>>>>>>>>>>>>
41410>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Printer
41410>>>>>>>>>>>>>>>>>>>>>
41410>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Form
41410>>>>>>>>>>>>>>>>>>>>>
41410>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_L_No
41410>>>>>>>>>>>>>>>>>>>>>
41410>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_L_Hmnia
41410>>>>>>>>>>>>>>>>>>>>>
41410>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Seira
41410>>>>>>>>>>>>>>>>>>>>>
41410>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Abr
41410>>>>>>>>>>>>>>>>>>>>>
41410>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag01
41410>>>>>>>>>>>>>>>>>>>>>
41410>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag02
41410>>>>>>>>>>>>>>>>>>>>>
41410>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag03
41410>>>>>>>>>>>>>>>>>>>>>
41410>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag04
41410>>>>>>>>>>>>>>>>>>>>>
41410>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag05
41410>>>>>>>>>>>>>>>>>>>>>
41410>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag06
41410>>>>>>>>>>>>>>>>>>>>>
41410>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag07
41410>>>>>>>>>>>>>>>>>>>>>
41410>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag08
41410>>>>>>>>>>>>>>>>>>>>>
41410>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag09
41410>>>>>>>>>>>>>>>>>>>>>
41410>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag10
41410>>>>>>>>>>>>>>>>>>>>>
41410>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag11
41410>>>>>>>>>>>>>>>>>>>>>
41410>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag12
41410>>>>>>>>>>>>>>>>>>>>>
41410>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag13
41410>>>>>>>>>>>>>>>>>>>>>
41410>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag14
41410>>>>>>>>>>>>>>>>>>>>>
41410>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag15
41410>>>>>>>>>>>>>>>>>>>>>
41410>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag16
41410>>>>>>>>>>>>>>>>>>>>>
41410>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag17
41410>>>>>>>>>>>>>>>>>>>>>
41410>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag18
41410>>>>>>>>>>>>>>>>>>>>>
41410>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag19
41410>>>>>>>>>>>>>>>>>>>>>
41410>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag20
41410>>>>>>>>>>>>>>>>>>>>>
41410>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Recr
41410>>>>>>>>>>>>>>>>>>>>>
41410>>>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
41410>>>>>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
41411>>>>>>>>>>>>>>>>>>>>>End_Class    // Gtypkin_DataDictionary
41412>>>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
41412>>>>>>>>>>>>>>>>>>>>>
41412>>>>>>>>>>>>>>>>>>>>>Use gtypkin.SL       // gtypkin
41412>>>>>>>>>>>>>>>>>>>>>
41412>>>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
41412>>>>>>>>>>>>>>>>>>>>>//DDB-FileEnd
41412>>>>>>>>>>>>>>>>>>>    
41412>>>>>>>>>>>>>>>>>>>    //AB-IgnoreEnd
41412>>>>>>>>>>>>>>>>>>>
41412>>>>>>>>>>>>>>>>>>>    CD_Popup_Object gtypkin is a dbModalPanel
41431>>>>>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
41432>>>>>>>>>>>>>>>>>>>        Set Label to "Šå©«˜ ‰ ¤ã©œà¤"
41433>>>>>>>>>>>>>>>>>>>        Set Size to 171 467
41434>>>>>>>>>>>>>>>>>>>        Set Location to 4 5
41435>>>>>>>>>>>>>>>>>>>
41435>>>>>>>>>>>>>>>>>>>        //AB-DDOStart
41435>>>>>>>>>>>>>>>>>>>
41435>>>>>>>>>>>>>>>>>>>        Object Gthhmgio_DD is a Gthhmgio_DataDictionary
41437>>>>>>>>>>>>>>>>>>>        End_Object    // Gthhmgio_DD
41438>>>>>>>>>>>>>>>>>>>
41438>>>>>>>>>>>>>>>>>>>        Object Gtypkin_DD is a Gtypkin_DataDictionary
41440>>>>>>>>>>>>>>>>>>>            Set DDO_Server to (Gthhmgio_DD(self))
41441>>>>>>>>>>>>>>>>>>>        End_Object    // Gtypkin_DD
41442>>>>>>>>>>>>>>>>>>>
41442>>>>>>>>>>>>>>>>>>>        Set Main_DD to (Gtypkin_DD(self))
41443>>>>>>>>>>>>>>>>>>>        Set Server to (Gtypkin_DD(self))
41444>>>>>>>>>>>>>>>>>>>
41444>>>>>>>>>>>>>>>>>>>        //AB-DDOEnd
41444>>>>>>>>>>>>>>>>>>>
41444>>>>>>>>>>>>>>>>>>>        Object oSelList is a dbList
41446>>>>>>>>>>>>>>>>>>>            Set Main_File to Gtypkin.File_Number
41447>>>>>>>>>>>>>>>>>>>            Set Size to 132 450
41448>>>>>>>>>>>>>>>>>>>            Set Location to 6 6
41449>>>>>>>>>>>>>>>>>>>
41449>>>>>>>>>>>>>>>>>>>            Begin_Row
41452>>>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_code
41453>>>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_descr
41454>>>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_abr
41455>>>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_seira
41456>>>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_code
41457>>>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_descr
41458>>>>>>>>>>>>>>>>>>>            End_Row
41463>>>>>>>>>>>>>>>>>>>
41463>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 40
41464>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
41465>>>>>>>>>>>>>>>>>>>            
41465>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 150
41466>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
41467>>>>>>>>>>>>>>>>>>>            
41467>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 68
41468>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 2 to "‘¬¤«¦£¦š¨˜­å˜"
41469>>>>>>>>>>>>>>>>>>>            
41469>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 3 to 30
41470>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 3 to "‘œ ¨á"
41471>>>>>>>>>>>>>>>>>>>            
41471>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 4 to 55
41472>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 4 to "‰à› ¡æª †£/š ¦¬"
41473>>>>>>>>>>>>>>>>>>>            
41473>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 5 to 99
41474>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 5 to "œ¨ š¨˜­ã †£/šå¦¬"
41475>>>>>>>>>>>>>>>>>>>            
41475>>>>>>>>>>>>>>>>>>>        End_Object    // oSelList
41476>>>>>>>>>>>>>>>>>>>
41476>>>>>>>>>>>>>>>>>>>        Object oOK_bn is a Button
41478>>>>>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
41479>>>>>>>>>>>>>>>>>>>            Set Location to 140 298
41480>>>>>>>>>>>>>>>>>>>
41480>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
41480>>>>>>>>>>>>>>>>>>>            Procedure OnClick
41482>>>>>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
41483>>>>>>>>>>>>>>>>>>>            End_Procedure
41484>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
41484>>>>>>>>>>>>>>>>>>>
41484>>>>>>>>>>>>>>>>>>>        End_Object    // oOK_bn
41485>>>>>>>>>>>>>>>>>>>
41485>>>>>>>>>>>>>>>>>>>        Object oCancel_bn is a Button
41487>>>>>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
41488>>>>>>>>>>>>>>>>>>>            Set Location to 140 353
41489>>>>>>>>>>>>>>>>>>>
41489>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
41489>>>>>>>>>>>>>>>>>>>            Procedure OnClick
41491>>>>>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
41492>>>>>>>>>>>>>>>>>>>            End_Procedure
41493>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
41493>>>>>>>>>>>>>>>>>>>
41493>>>>>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
41494>>>>>>>>>>>>>>>>>>>
41494>>>>>>>>>>>>>>>>>>>        Object oSearch_bn is a Button
41496>>>>>>>>>>>>>>>>>>>            Set Label to "&€¤˜ã«ž©ž..."
41497>>>>>>>>>>>>>>>>>>>            Set Location to 140 408
41498>>>>>>>>>>>>>>>>>>>
41498>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
41498>>>>>>>>>>>>>>>>>>>            Procedure OnClick
41500>>>>>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
41501>>>>>>>>>>>>>>>>>>>            End_Procedure
41502>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
41502>>>>>>>>>>>>>>>>>>>
41502>>>>>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
41503>>>>>>>>>>>>>>>>>>>
41503>>>>>>>>>>>>>>>>>>>
41503>>>>>>>>>>>>>>>>>>>        //AB-StoreStart
41503>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
41504>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
41505>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
41506>>>>>>>>>>>>>>>>>>>        //AB-StoreEnd
41506>>>>>>>>>>>>>>>>>>>
41506>>>>>>>>>>>>>>>>>>>    CD_End_Object    // gtypkin
41508>>>>>>>>>>>>>>>>>>>>
41508>>>>>>>>>>>>>>>>>>>
41508>>>>>>>>>>>>>>>>>>>//AB/     End_Object    // prj
41508>>>>>>>>>>>>>>>>>
41508>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
41508>>>>>>>>>>>>>>>>>//DDB-FileEnd
41508>>>>>>>>>>>>>>>
41508>>>>>>>>>>>>>>>//AB-IgnoreEnd
41508>>>>>>>>>>>>>>>
41508>>>>>>>>>>>>>>>CD_Popup_Object sl150 is a dbModalPanel
41527>>>>>>>>>>>>>>>
41527>>>>>>>>>>>>>>>    //AB-StoreTopStart
41527>>>>>>>>>>>>>>>    Property Integer piFragmaLast -1
41529>>>>>>>>>>>>>>>    Property String  psFragmaFromCode ""
41531>>>>>>>>>>>>>>>    Property String  psFragmaToCode ""
41533>>>>>>>>>>>>>>>    
41533>>>>>>>>>>>>>>>    //AB-StoreTopEnd
41533>>>>>>>>>>>>>>>
41533>>>>>>>>>>>>>>>    Set Minimize_Icon to FALSE
41534>>>>>>>>>>>>>>>    Set Label to "Šå©«˜ Š¦š˜¨ ˜©£é¤"
41535>>>>>>>>>>>>>>>    Set Size to 204 393
41536>>>>>>>>>>>>>>>    Set Location to 5 16
41537>>>>>>>>>>>>>>>
41537>>>>>>>>>>>>>>>    //AB-DDOStart
41537>>>>>>>>>>>>>>>
41537>>>>>>>>>>>>>>>    Object Gplan_DD is a Gplan_DataDictionary
41539>>>>>>>>>>>>>>>
41539>>>>>>>>>>>>>>>        //AB-StoreStart
41539>>>>>>>>>>>>>>>                                                    
41539>>>>>>>>>>>>>>>        Procedure OnConstrain
41541>>>>>>>>>>>>>>>            Integer liFragmaLast
41542>>>>>>>>>>>>>>>            String lsFragmaFromCode lsFragmaToCode
41542>>>>>>>>>>>>>>>            Get piFragmaLast     to liFragmaLast
41543>>>>>>>>>>>>>>>            Get psFragmaFromCode to lsFragmaFromCode
41544>>>>>>>>>>>>>>>            Get psFragmaToCode   to lsFragmaToCode
41545>>>>>>>>>>>>>>>            If (liFragmaLast <> -1)     Constrain Gplan.Gplan_Yn_Last eq liFragmaLast
41549>>>>>>>>>>>>>>>            If (lsFragmaFromCode <> "") Constrain Gplan.Gplan_Code    ge lsFragmaFromCode
41553>>>>>>>>>>>>>>>            If (lsFragmaToCode <> "")   Constrain Gplan.Gplan_Code    le lsFragmaToCode
41557>>>>>>>>>>>>>>>        End_Procedure // OnConstrain
41558>>>>>>>>>>>>>>>        
41558>>>>>>>>>>>>>>>        
41558>>>>>>>>>>>>>>>        //AB-StoreEnd
41558>>>>>>>>>>>>>>>
41558>>>>>>>>>>>>>>>    End_Object    // Gplan_DD
41559>>>>>>>>>>>>>>>
41559>>>>>>>>>>>>>>>    Set Main_DD to (Gplan_DD(self))
41560>>>>>>>>>>>>>>>    Set Server to (Gplan_DD(self))
41561>>>>>>>>>>>>>>>
41561>>>>>>>>>>>>>>>    //AB-DDOEnd
41561>>>>>>>>>>>>>>>
41561>>>>>>>>>>>>>>>    Object oSelList is a dbList
41563>>>>>>>>>>>>>>>        Set Main_File to Gplan.File_Number
41564>>>>>>>>>>>>>>>        Set Size to 164 378
41565>>>>>>>>>>>>>>>        Set Location to 4 6
41566>>>>>>>>>>>>>>>
41566>>>>>>>>>>>>>>>        Begin_Row
41569>>>>>>>>>>>>>>>            Entry_Item Gplan.Gplan_code
41570>>>>>>>>>>>>>>>            Entry_Item Gplan.Gplan_descr1
41571>>>>>>>>>>>>>>>            Entry_Item Gplan.Gplan_bathmos
41572>>>>>>>>>>>>>>>            Entry_Item Gplan.Gplan_yn_last
41573>>>>>>>>>>>>>>>        End_Row
41578>>>>>>>>>>>>>>>
41578>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 105
41579>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
41580>>>>>>>>>>>>>>>        
41580>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 212
41581>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
41582>>>>>>>>>>>>>>>        
41582>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 34
41583>>>>>>>>>>>>>>>        Set Header_Label  item 2 to "˜Ÿ£æª"
41584>>>>>>>>>>>>>>>        
41584>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 19
41585>>>>>>>>>>>>>>>        Set Header_Label  item 3 to " ’"
41586>>>>>>>>>>>>>>>        Set Column_Checkbox_State  item 3 to True
41587>>>>>>>>>>>>>>>        
41587>>>>>>>>>>>>>>>
41587>>>>>>>>>>>>>>>        //AB-StoreStart
41587>>>>>>>>>>>>>>>                                                    
41587>>>>>>>>>>>>>>>        Property String piStoredFragmaLast -1
41589>>>>>>>>>>>>>>>        Property String psStoredFragmaFromCode ""
41591>>>>>>>>>>>>>>>        Property String psStoredFragmaToCode ""
41593>>>>>>>>>>>>>>>        
41593>>>>>>>>>>>>>>>        Procedure Store_Defaults
41595>>>>>>>>>>>>>>>            forward send Store_Defaults
41597>>>>>>>>>>>>>>>            Set piStoredFragmaLast     to (piFragmaLast(Self))
41598>>>>>>>>>>>>>>>            Set psStoredFragmaFromCode to (psFragmaFromCode(Self))
41599>>>>>>>>>>>>>>>            Set psStoredFragmaToCode   to (psFragmaToCode(Self))
41600>>>>>>>>>>>>>>>        end_Procedure // Store_Defaults
41601>>>>>>>>>>>>>>>        
41601>>>>>>>>>>>>>>>        Procedure Restore_Defaults
41603>>>>>>>>>>>>>>>            forward send Restore_Defaults
41605>>>>>>>>>>>>>>>            Set piFragmaLast     to (piStoredFragmaLast(self))
41606>>>>>>>>>>>>>>>            Set psFragmaFromCode to (psStoredFragmaFromCode(self))
41607>>>>>>>>>>>>>>>            Set psFragmaToCode   to (psStoredFragmaToCode(self))
41608>>>>>>>>>>>>>>>        end_Procedure // Restore_Defaults
41609>>>>>>>>>>>>>>>        
41609>>>>>>>>>>>>>>>        Procedure Activating
41611>>>>>>>>>>>>>>>            Forward Send Activating
41613>>>>>>>>>>>>>>>            Send Rebuild_Constraints to (Gplan_DD(self))
41614>>>>>>>>>>>>>>>        End_Procedure // Activating
41615>>>>>>>>>>>>>>>        
41615>>>>>>>>>>>>>>>        
41615>>>>>>>>>>>>>>>        
41615>>>>>>>>>>>>>>>        
41615>>>>>>>>>>>>>>>        //AB-StoreEnd
41615>>>>>>>>>>>>>>>
41615>>>>>>>>>>>>>>>    End_Object    // oSelList
41616>>>>>>>>>>>>>>>
41616>>>>>>>>>>>>>>>    Object oOK_bn is a Button
41618>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
41619>>>>>>>>>>>>>>>        Set Location to 170 226
41620>>>>>>>>>>>>>>>
41620>>>>>>>>>>>>>>>        //AB-StoreStart
41620>>>>>>>>>>>>>>>        Procedure OnClick
41622>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
41623>>>>>>>>>>>>>>>        End_Procedure
41624>>>>>>>>>>>>>>>        //AB-StoreEnd
41624>>>>>>>>>>>>>>>
41624>>>>>>>>>>>>>>>    End_Object    // oOK_bn
41625>>>>>>>>>>>>>>>
41625>>>>>>>>>>>>>>>    Object oCancel_bn is a Button
41627>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
41628>>>>>>>>>>>>>>>        Set Location to 170 279
41629>>>>>>>>>>>>>>>
41629>>>>>>>>>>>>>>>        //AB-StoreStart
41629>>>>>>>>>>>>>>>        Procedure OnClick
41631>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
41632>>>>>>>>>>>>>>>        End_Procedure
41633>>>>>>>>>>>>>>>        //AB-StoreEnd
41633>>>>>>>>>>>>>>>
41633>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
41634>>>>>>>>>>>>>>>
41634>>>>>>>>>>>>>>>    Object oSearch_bn is a Button
41636>>>>>>>>>>>>>>>        Set Label to "&€¤˜ã«ž©ž..."
41637>>>>>>>>>>>>>>>        Set Location to 170 334
41638>>>>>>>>>>>>>>>
41638>>>>>>>>>>>>>>>        //AB-StoreStart
41638>>>>>>>>>>>>>>>        Procedure OnClick
41640>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
41641>>>>>>>>>>>>>>>        End_Procedure
41642>>>>>>>>>>>>>>>        //AB-StoreEnd
41642>>>>>>>>>>>>>>>
41642>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
41643>>>>>>>>>>>>>>>
41643>>>>>>>>>>>>>>>
41643>>>>>>>>>>>>>>>    //AB-StoreStart
41643>>>>>>>>>>>>>>>                            
41643>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
41644>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
41645>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
41646>>>>>>>>>>>>>>>    
41646>>>>>>>>>>>>>>>    
41646>>>>>>>>>>>>>>>    
41646>>>>>>>>>>>>>>>    //AB-StoreEnd
41646>>>>>>>>>>>>>>>
41646>>>>>>>>>>>>>>>CD_End_Object    // sl150
41648>>>>>>>>>>>>>>>>
41648>>>>>>>>>>>>>>>
41648>>>>>>>>>>>>>>>//AB/ End_Object    // prj
41648>>>>>>>>>>>>>
41648>>>>>>>>>>>>>//DDB-Selection-pkg-End
41648>>>>>>>>>>>>>//DDB-FileEnd
41648>>>>>>>>>>>    Use FPA.DD
INCLUDING FILE: FPA.DD
41648>>>>>>>>>>>>>//DDB-FileStart
41648>>>>>>>>>>>>>//DDB-HeaderStart
41648>>>>>>>>>>>>>
41648>>>>>>>>>>>>>// File Name : FPA.DD
41648>>>>>>>>>>>>>// Class Name: Fpa_DataDictionary
41648>>>>>>>>>>>>>// Revision  : 34
41648>>>>>>>>>>>>>// Version   : 2
41648>>>>>>>>>>>>>
41648>>>>>>>>>>>>>Use  Windows           // Basic Definitions
41648>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
41648>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41648>>>>>>>>>>>>>
41648>>>>>>>>>>>>>Open Fpa
INCLUDING FILE: FPA.FD
41650>>>>>>>>>>>>>Open Iteml
41652>>>>>>>>>>>>>Open Partlfpa
41654>>>>>>>>>>>>>Open Item
41656>>>>>>>>>>>>>
41656>>>>>>>>>>>>>//DDB-HeaderEnd
41656>>>>>>>>>>>>>//DDB-SelectionStart
41656>>>>>>>>>>>>>//DDB/ ExternalSelectionList Fpa  Fpa.SL
41656>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl150  sl150.SL
41656>>>>>>>>>>>>>Register_Object Fpa
41656>>>>>>>>>>>>>Register_Object sl150
41656>>>>>>>>>>>>>//DDB-SelectionEnd
41656>>>>>>>>>>>>>
41656>>>>>>>>>>>>>Class Fpa_DataDictionary  is a DataDictionary_Sec
41657>>>>>>>>>>>>> 
41657>>>>>>>>>>>>>    // Validate_Save:
41657>>>>>>>>>>>>> 
41657>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
41658>>>>>>>>>>>>>        Local Integer iReturnVal icheck
41659>>>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
41661>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
41663>>>>>>>>>>>>>            // Insert Code Here
41663>>>>>>>>>>>>>         //  if (fpa.agora_codegl <> '') begin
41663>>>>>>>>>>>>>         //     Move (Check_log(fpa.agora_codegl)) to iCheck  
41663>>>>>>>>>>>>>         //     if (icheck) Move 104001 to iReturnVal 
41663>>>>>>>>>>>>>         //  end
41663>>>>>>>>>>>>>         //  if (fpa.polhsh_codegl <> '') begin
41663>>>>>>>>>>>>>         //     Move (Check_log(fpa.polhsh_codegl)) to iCheck  
41663>>>>>>>>>>>>>         //     if (icheck) Move 104002 to iReturnVal
41663>>>>>>>>>>>>>         //  end   
41663>>>>>>>>>>>>>         //  If (iReturnVal) Send Operation_Not_Allowed iReturnVal
41663>>>>>>>>>>>>>        End
41663>>>>>>>>>>>>>>
41663>>>>>>>>>>>>>        Function_Return iReturnVal
41664>>>>>>>>>>>>>    End_Function   // Validate_Save
41665>>>>>>>>>>>>> 
41665>>>>>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
41666>>>>>>>>>>>>>        String lsError_Message
41667>>>>>>>>>>>>>        Case Begin
41667>>>>>>>>>>>>>            Case (iError_Num = 104001)
41669>>>>>>>>>>>>>                Move "DDC 104: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ”..€ ˜š¦¨é¤" to lsError_Message
41670>>>>>>>>>>>>>              Case Break
41671>>>>>>>>>>>>>            Case (iError_Num = 104002)
41674>>>>>>>>>>>>>                Move "DDC 104: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ”..€ §à¢ã©œà¤" to lsError_Message
41675>>>>>>>>>>>>>              Case Break
41676>>>>>>>>>>>>>            Case Else
41676>>>>>>>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
41678>>>>>>>>>>>>>        Case End
41678>>>>>>>>>>>>>        Error iError_Num lsError_Message
41679>>>>>>>>>>>>>>
41679>>>>>>>>>>>>>    End_Procedure // operation_not_allowed
41680>>>>>>>>>>>>>
41680>>>>>>>>>>>>>    // Define_Fields:
41680>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41680>>>>>>>>>>>>>
41680>>>>>>>>>>>>>    Procedure Define_Fields
41681>>>>>>>>>>>>>        Forward Send Define_Fields
41683>>>>>>>>>>>>>        //DDB-Generated-Code-Location
41683>>>>>>>>>>>>>        //DDB-DefineFieldStart
41683>>>>>>>>>>>>>
41683>>>>>>>>>>>>>        Set Main_File            To Fpa.File_Number
41684>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
41685>>>>>>>>>>>>>
41685>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41686>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41687>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41688>>>>>>>>>>>>>
41688>>>>>>>>>>>>>        // Child (Client) file structure................
41688>>>>>>>>>>>>>        Send Add_Client_File  Iteml.File_Number
41689>>>>>>>>>>>>>        Send Add_Client_File  Partlfpa.File_Number
41690>>>>>>>>>>>>>        Send Add_Client_File  Item.File_Number
41691>>>>>>>>>>>>>
41691>>>>>>>>>>>>>        // Field-based properties.......................
41691>>>>>>>>>>>>>
41691>>>>>>>>>>>>>        // Fpa.Fpa_Pososto
41691>>>>>>>>>>>>>        Set Field_Options          Field Fpa.Fpa_Pososto To DD_AUTOFIND    DD_REQUIRED   
41692>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Fpa.Fpa_Pososto To (Fpa(Self))
41693>>>>>>>>>>>>>        Set Key_Field_State        Field Fpa.Fpa_Pososto To TRUE
41694>>>>>>>>>>>>>
41694>>>>>>>>>>>>>        // Fpa.Fpa_Descr
41694>>>>>>>>>>>>>        Set Field_Options          Field Fpa.Fpa_Descr To DD_AUTOFIND   
41695>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Fpa.Fpa_Descr To (Fpa(Self))
41696>>>>>>>>>>>>>
41696>>>>>>>>>>>>>        // Fpa.Agora_Codegl
41696>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Fpa.Agora_Codegl To (sl150(Self))
41697>>>>>>>>>>>>>
41697>>>>>>>>>>>>>        // Fpa.Polhsh_Codegl
41697>>>>>>>>>>>>>
41697>>>>>>>>>>>>>        //DDB-DefineFieldEnd
41697>>>>>>>>>>>>>    End_Procedure    // Define_Fields
41698>>>>>>>>>>>>>
41698>>>>>>>>>>>>>    // Field_Defaults:
41698>>>>>>>>>>>>>    // This procedure is used to establish default field values.
41698>>>>>>>>>>>>>
41698>>>>>>>>>>>>>    Procedure Field_Defaults
41699>>>>>>>>>>>>>        Forward Send Field_Defaults
41701>>>>>>>>>>>>>        //DDB-Generated-Code-Location
41701>>>>>>>>>>>>>        //DDB-FieldDefaultStart
41701>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
41701>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
41702>>>>>>>>>>>>>
41702>>>>>>>>>>>>>End_Class    // Fpa_DataDictionary
41703>>>>>>>>>>>>>//DDB-Selection-pkg-Start
41703>>>>>>>>>>>>>
41703>>>>>>>>>>>>>Use Fpa.SL           // Fpa
INCLUDING FILE: FPA.SL
41703>>>>>>>>>>>>>>>//AB/ Project Fpa:Lookup
41703>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
41703>>>>>>>>>>>>>>>//AB/     Set ProjectName to "Fpa:Lookup"
41703>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "Fpa.SL"
41703>>>>>>>>>>>>>>>
41703>>>>>>>>>>>>>>>// Project Object Structure
41703>>>>>>>>>>>>>>>//   Fpa is a dbModalPanelSub
41703>>>>>>>>>>>>>>>//     Fpa_DD is a DataDictionary
41703>>>>>>>>>>>>>>>//     oSelList is a dbListSub
41703>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
41703>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
41703>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
41703>>>>>>>>>>>>>>>
41703>>>>>>>>>>>>>>>// Register all objects
41703>>>>>>>>>>>>>>>Register_Object Fpa
41703>>>>>>>>>>>>>>>Register_Object Fpa_DD
41703>>>>>>>>>>>>>>>Register_Object oCancel_bn
41703>>>>>>>>>>>>>>>Register_Object oOK_bn
41703>>>>>>>>>>>>>>>Register_Object oSearch_bn
41703>>>>>>>>>>>>>>>Register_Object oSelList
41703>>>>>>>>>>>>>>>
41703>>>>>>>>>>>>>>>
41703>>>>>>>>>>>>>>>//AB-IgnoreStart
41703>>>>>>>>>>>>>>>
41703>>>>>>>>>>>>>>>Use DFAllEnt.pkg
41703>>>>>>>>>>>>>>>Use dbList.Sub
41703>>>>>>>>>>>>>>>Use Button.Sub
41703>>>>>>>>>>>>>>>
41703>>>>>>>>>>>>>>>
41703>>>>>>>>>>>>>>>Use FPA.DD
41703>>>>>>>>>>>>>>>
41703>>>>>>>>>>>>>>>//AB-IgnoreEnd
41703>>>>>>>>>>>>>>>
41703>>>>>>>>>>>>>>>CD_Popup_Object Fpa is a dbModalPanelSub
41722>>>>>>>>>>>>>>>    set label to "¦©¦©«á ”..€." 
41723>>>>>>>>>>>>>>>    Set Size to 148 181
41724>>>>>>>>>>>>>>>    Set Location to 4 5
41725>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
41726>>>>>>>>>>>>>>>    Set Modal_State to FALSE
41727>>>>>>>>>>>>>>>
41727>>>>>>>>>>>>>>>    //AB-DDOStart
41727>>>>>>>>>>>>>>>
41727>>>>>>>>>>>>>>>    Object Fpa_DD is a Fpa_DataDictionary
41729>>>>>>>>>>>>>>>    End_Object    // Fpa_DD
41730>>>>>>>>>>>>>>>
41730>>>>>>>>>>>>>>>    Set Main_DD to (Fpa_DD(self))
41731>>>>>>>>>>>>>>>    Set Server to (Fpa_DD(self))
41732>>>>>>>>>>>>>>>
41732>>>>>>>>>>>>>>>    //AB-DDOEnd
41732>>>>>>>>>>>>>>>
41732>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
41734>>>>>>>>>>>>>>>        Set Main_File to Fpa.File_Number
41735>>>>>>>>>>>>>>>        Set Size to 105 165
41736>>>>>>>>>>>>>>>        Set Location to 6 6
41737>>>>>>>>>>>>>>>
41737>>>>>>>>>>>>>>>        Begin_Row
41740>>>>>>>>>>>>>>>            Entry_Item Fpa.Fpa_pososto
41741>>>>>>>>>>>>>>>            Entry_Item Fpa.Fpa_descr
41742>>>>>>>>>>>>>>>        End_Row
41747>>>>>>>>>>>>>>>
41747>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 66
41748>>>>>>>>>>>>>>>        set header_label  item 0 to "% ”€" 
41749>>>>>>>>>>>>>>>        
41749>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 90
41750>>>>>>>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
41751>>>>>>>>>>>>>>>        
41751>>>>>>>>>>>>>>>    End_Object    // oSelList
41752>>>>>>>>>>>>>>>
41752>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
41754>>>>>>>>>>>>>>>        set label to "&„§ ¢¦šã" 
41755>>>>>>>>>>>>>>>        Set Size to 14 46
41756>>>>>>>>>>>>>>>        Set Location to 113 26
41757>>>>>>>>>>>>>>>
41757>>>>>>>>>>>>>>>        //AB-StoreStart
41757>>>>>>>>>>>>>>>        Procedure OnClick
41759>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
41760>>>>>>>>>>>>>>>        End_Procedure
41761>>>>>>>>>>>>>>>        //AB-StoreEnd
41761>>>>>>>>>>>>>>>
41761>>>>>>>>>>>>>>>    End_Object    // oOK_bn
41762>>>>>>>>>>>>>>>
41762>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
41764>>>>>>>>>>>>>>>        set label to "&€¡ç¨à©ž" 
41765>>>>>>>>>>>>>>>        Set Size to 14 46
41766>>>>>>>>>>>>>>>        Set Location to 113 75
41767>>>>>>>>>>>>>>>
41767>>>>>>>>>>>>>>>        //AB-StoreStart
41767>>>>>>>>>>>>>>>        Procedure OnClick
41769>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
41770>>>>>>>>>>>>>>>        End_Procedure
41771>>>>>>>>>>>>>>>        //AB-StoreEnd
41771>>>>>>>>>>>>>>>
41771>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
41772>>>>>>>>>>>>>>>
41772>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
41774>>>>>>>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
41775>>>>>>>>>>>>>>>        Set Size to 14 46
41776>>>>>>>>>>>>>>>        Set Location to 113 126
41777>>>>>>>>>>>>>>>
41777>>>>>>>>>>>>>>>        //AB-StoreStart
41777>>>>>>>>>>>>>>>        Procedure OnClick
41779>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
41780>>>>>>>>>>>>>>>        End_Procedure
41781>>>>>>>>>>>>>>>        //AB-StoreEnd
41781>>>>>>>>>>>>>>>
41781>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
41782>>>>>>>>>>>>>>>
41782>>>>>>>>>>>>>>>
41782>>>>>>>>>>>>>>>    //AB-StoreStart
41782>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
41783>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
41784>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
41785>>>>>>>>>>>>>>>    //AB-StoreEnd
41785>>>>>>>>>>>>>>>
41785>>>>>>>>>>>>>>>CD_End_Object    // Fpa
41787>>>>>>>>>>>>>>>>
41787>>>>>>>>>>>>>>>
41787>>>>>>>>>>>>>>>//AB/ End_Object    // prj
41787>>>>>>>>>>>>>Use sl150.SL         // sl150
41787>>>>>>>>>>>>>
41787>>>>>>>>>>>>>//DDB-Selection-pkg-End
41787>>>>>>>>>>>>>//DDB-FileEnd
41787>>>>>>>>>>>    Use ITEM.DD
INCLUDING FILE: ITEM.DD
41787>>>>>>>>>>>>>//DDB-FileStart
41787>>>>>>>>>>>>>//DDB-HeaderStart
41787>>>>>>>>>>>>>
41787>>>>>>>>>>>>>// File Name : ITEM.DD
41787>>>>>>>>>>>>>// Class Name: Item_DataDictionary
41787>>>>>>>>>>>>>// Revision  : 53
41787>>>>>>>>>>>>>// Version   : 2
41787>>>>>>>>>>>>>
41787>>>>>>>>>>>>>Use  Windows           // Basic Definitions
41787>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
41787>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41787>>>>>>>>>>>>>
41787>>>>>>>>>>>>>Open Item
41789>>>>>>>>>>>>>Open Witemx
41791>>>>>>>>>>>>>Open Itemd
INCLUDING FILE: ITEMD.FD
41793>>>>>>>>>>>>>Open Witemcl
41795>>>>>>>>>>>>>Open Units
41797>>>>>>>>>>>>>Open Witemkat
41799>>>>>>>>>>>>>Open Fpa
41801>>>>>>>>>>>>>Open Sysrecw
41803>>>>>>>>>>>>>Open Witemx
41805>>>>>>>>>>>>>
41805>>>>>>>>>>>>>//DDB-HeaderEnd
41805>>>>>>>>>>>>>//DDB-ValidationStart
41805>>>>>>>>>>>>>
41805>>>>>>>>>>>>>Register_Object Item_Item_Qual_VT
41805>>>>>>>>>>>>>Register_Object Item_Item_Analysh_VT
41805>>>>>>>>>>>>>
41805>>>>>>>>>>>>>Object Item_Item_Qual_VT  is a CodeValidationTable
41807>>>>>>>>>>>>>    Set Type_Value        To "QUAL"
41808>>>>>>>>>>>>>    Set Validate_State    To FALSE
41809>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
41810>>>>>>>>>>>>>    //DDB-ValidationCustomStart
41810>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
41810>>>>>>>>>>>>>End_Object   // Item_Item_Qual_VT
41811>>>>>>>>>>>>>
41811>>>>>>>>>>>>>Object Item_Item_Analysh_VT  is a CodeValidationTable
41813>>>>>>>>>>>>>    Set Type_Value        To "ITEMANAL"
41814>>>>>>>>>>>>>    Set Table_Title       To "€¤á¢¬©ž „å›¦¬ª"
41815>>>>>>>>>>>>>    //DDB-ValidationCustomStart
41815>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
41815>>>>>>>>>>>>>End_Object   // Item_Item_Analysh_VT
41816>>>>>>>>>>>>>//DDB-ValidationEnd
41816>>>>>>>>>>>>>//DDB-SelectionStart
41816>>>>>>>>>>>>>//DDB/ ExternalSelectionList SL22s  sl22s.sl
41816>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl022  sl022.SL
41816>>>>>>>>>>>>>Register_Object SL22s
41816>>>>>>>>>>>>>Register_Object sl022
41816>>>>>>>>>>>>>//DDB-SelectionEnd
41816>>>>>>>>>>>>>
41816>>>>>>>>>>>>>Class Item_DataDictionary  is a DataDictionary
41817>>>>>>>>>>>>>
41817>>>>>>>>>>>>>    Procedure Update
41818>>>>>>>>>>>>>        Forward Send Update
41820>>>>>>>>>>>>>        Move Witemkat.Witemkat_Code to Item.Witemkat_Code
41821>>>>>>>>>>>>>        Move Units.Units_Code       to Item.Units_Code
41822>>>>>>>>>>>>>    End_Procedure   // Update
41823>>>>>>>>>>>>>
41823>>>>>>>>>>>>>     Procedure Creating
41824>>>>>>>>>>>>>        Date dHmnia
41825>>>>>>>>>>>>>        Forward Send Creating
41827>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Item.Item_Rec0)))))) to Item.Item_Recr
41828>>>>>>>>>>>>>        Clear Witemx
41829>>>>>>>>>>>>>        Move SysCurXR.Company_Code    to Witemx.Company_Code
41830>>>>>>>>>>>>>        Move SysCurXR.Branch_Code     to Witemx.Branch_Code
41831>>>>>>>>>>>>>        Move SysCurXR.Year_Year       to Witemx.Year_Year
41832>>>>>>>>>>>>>        Move SysCurXR.Year_Year       to Witemx.Witemx_YearDesc
41833>>>>>>>>>>>>>        Move SysCurXR.Year_Recr       to Witemx.Year_Recr
41834>>>>>>>>>>>>>        Move Witemkat.Witemkat_Code   to Witemx.Witemkat_Code
41835>>>>>>>>>>>>>        Move Units.Units_Code         to Witemx.Units_Code
41836>>>>>>>>>>>>>        Move Item.Item_Code           to Witemx.Item_Code
41837>>>>>>>>>>>>>        Move Item.Item_Code           to Witemx.Witemx_Code
41838>>>>>>>>>>>>>        Move Item.Item_Descr          to Witemx.Witemx_Descr
41839>>>>>>>>>>>>>        Move Item.Wapokat_Code        to Witemx.ITEM_APOKAT_COD
41840>>>>>>>>>>>>>        Move Item.link1               to Witemx.link1
41841>>>>>>>>>>>>>        Move Item.link2               to Witemx.link2
41842>>>>>>>>>>>>>        Move Item.Item_Recr           to Witemx.Item_Recr
41843>>>>>>>>>>>>>        Move (Sysrecw.Witemx_Rec0+1)  to Witemx.Witemx_Rec0
41844>>>>>>>>>>>>>        Move (Sysrecw.Witemx_Rec0+1)  to Sysrecw.Witemx_Rec0
41845>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                       (Trim(String(Witemx.Witemx_Rec0)))))) ;                                      to Witemx.Witemx_Recr
41846>>>>>>>>>>>>>        Saverecord Sysrecw
41847>>>>>>>>>>>>>        Saverecord Witemx
41848>>>>>>>>>>>>>     End_Procedure   // Creating
41849>>>>>>>>>>>>>
41849>>>>>>>>>>>>>
41849>>>>>>>>>>>>>    // Define_Fields:
41849>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41849>>>>>>>>>>>>>
41849>>>>>>>>>>>>>    Procedure Define_Fields
41850>>>>>>>>>>>>>        Forward Send Define_Fields
41852>>>>>>>>>>>>>        //DDB-Generated-Code-Location
41852>>>>>>>>>>>>>        //DDB-DefineFieldStart
41852>>>>>>>>>>>>>
41852>>>>>>>>>>>>>        Set Main_File            To Item.File_Number
41853>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
41854>>>>>>>>>>>>>
41854>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41855>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41856>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41857>>>>>>>>>>>>>
41857>>>>>>>>>>>>>        // Child (Client) file structure................
41857>>>>>>>>>>>>>        Send Add_Client_File  Witemx.File_Number
41858>>>>>>>>>>>>>        Send Add_Client_File  Itemd.File_Number
41859>>>>>>>>>>>>>        Send Add_Client_File  Witemcl.File_Number
41860>>>>>>>>>>>>>
41860>>>>>>>>>>>>>        // Parent (Server) file structure...............
41860>>>>>>>>>>>>>        Send Add_Server_File  Units.File_Number
41861>>>>>>>>>>>>>        Send Add_Server_File  Witemkat.File_Number
41862>>>>>>>>>>>>>        Send Add_Server_File  Fpa.File_Number
41863>>>>>>>>>>>>>
41863>>>>>>>>>>>>>        // External (System) file structure.............
41863>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
41864>>>>>>>>>>>>>        Send Add_System_File  Witemx.File_Number  DD_LOCK_ON_ALL
41865>>>>>>>>>>>>>
41865>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Item_Rec0  To Item.Item_Rec0
41868>>>>>>>>>>>>>
41868>>>>>>>>>>>>>        // Field-based properties.......................
41868>>>>>>>>>>>>>
41868>>>>>>>>>>>>>        // Item.Units_Code
41868>>>>>>>>>>>>>
41868>>>>>>>>>>>>>        // Item.Units_Recr
41868>>>>>>>>>>>>>
41868>>>>>>>>>>>>>        // Item.Witemkat_Code
41868>>>>>>>>>>>>>
41868>>>>>>>>>>>>>        // Item.Witemkat_Recr
41868>>>>>>>>>>>>>
41868>>>>>>>>>>>>>        // Item.Item_Code
41868>>>>>>>>>>>>>        Set Field_Options          Field Item.Item_Code To DD_AUTOFIND   
41869>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Item.Item_Code To (SL22s(Self))
41870>>>>>>>>>>>>>        Set Key_Field_State        Field Item.Item_Code To TRUE
41871>>>>>>>>>>>>>
41871>>>>>>>>>>>>>        // Item.Item_Rec0
41871>>>>>>>>>>>>>        Set Field_Options          Field Item.Item_Rec0 To DD_AUTOFIND   
41872>>>>>>>>>>>>>
41872>>>>>>>>>>>>>        // Item.Item_Descr
41872>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Item.Item_Descr To (SL22s(Self))
41873>>>>>>>>>>>>>
41873>>>>>>>>>>>>>        // Item.Item_Recr
41873>>>>>>>>>>>>>        Set Field_Options          Field Item.Item_Recr To DD_AUTOFIND   
41874>>>>>>>>>>>>>
41874>>>>>>>>>>>>>        // Item.Fpa_Pososto
41874>>>>>>>>>>>>>
41874>>>>>>>>>>>>>        // Item.Item_Qual
41874>>>>>>>>>>>>>        Set Field_Value_Table      Field Item.Item_Qual To (Item_Item_Qual_VT(Self))
41875>>>>>>>>>>>>>
41875>>>>>>>>>>>>>        // Item.Wapokat_Code
41875>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Item.Wapokat_Code To (sl022(Self))
41876>>>>>>>>>>>>>
41876>>>>>>>>>>>>>        // Item.Item_Analysh
41876>>>>>>>>>>>>>        Set Field_Class_Name       Field Item.Item_Analysh To "dbComboFormsub"
41877>>>>>>>>>>>>>        Set Field_Value_Table      Field Item.Item_Analysh To (Item_Item_Analysh_VT(Self))
41878>>>>>>>>>>>>>
41878>>>>>>>>>>>>>        // Item.Item_Orio
41878>>>>>>>>>>>>>
41878>>>>>>>>>>>>>        // Item.Codeglpol
41878>>>>>>>>>>>>>
41878>>>>>>>>>>>>>        // Item.Codeglago
41878>>>>>>>>>>>>>
41878>>>>>>>>>>>>>        // Item.Link1
41878>>>>>>>>>>>>>
41878>>>>>>>>>>>>>        // Item.Link2
41878>>>>>>>>>>>>>
41878>>>>>>>>>>>>>        // Item.Group
41878>>>>>>>>>>>>>
41878>>>>>>>>>>>>>        //DDB-DefineFieldEnd
41878>>>>>>>>>>>>>    End_Procedure    // Define_Fields
41879>>>>>>>>>>>>>
41879>>>>>>>>>>>>>    // Field_Defaults:
41879>>>>>>>>>>>>>    // This procedure is used to establish default field values.
41879>>>>>>>>>>>>>
41879>>>>>>>>>>>>>    Procedure Field_Defaults
41880>>>>>>>>>>>>>        Forward Send Field_Defaults
41882>>>>>>>>>>>>>        //DDB-Generated-Code-Location
41882>>>>>>>>>>>>>        //DDB-FieldDefaultStart
41882>>>>>>>>>>>>>        Set Field_Changed_Value   Field Item.Item_Analysh To "0"
41883>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
41883>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
41884>>>>>>>>>>>>>
41884>>>>>>>>>>>>>End_Class    // Item_DataDictionary
41885>>>>>>>>>>>>>//DDB-Selection-pkg-Start
41885>>>>>>>>>>>>>
41885>>>>>>>>>>>>>Use sl22s.sl         // SL22s
INCLUDING FILE: SL22S.SL
41885>>>>>>>>>>>>>>>//AB/ Project SL22s:ITEM
41885>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
41885>>>>>>>>>>>>>>>//AB/         Set ProjectName to "SL22s:ITEM"
41885>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl22s.sl"
41885>>>>>>>>>>>>>>>
41885>>>>>>>>>>>>>>>// Project Object Structure
41885>>>>>>>>>>>>>>>//   SL22s is a dbModalPanel
41885>>>>>>>>>>>>>>>//     Witemkat_DD is a DataDictionary
41885>>>>>>>>>>>>>>>//     Units_DD is a DataDictionary
41885>>>>>>>>>>>>>>>//     Fpa_DD is a DataDictionary
41885>>>>>>>>>>>>>>>//     Item_DD is a DataDictionary
41885>>>>>>>>>>>>>>>//     oSelList is a dbListSub
41885>>>>>>>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
41885>>>>>>>>>>>>>>>//     ocode is a FormSub
41885>>>>>>>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
41885>>>>>>>>>>>>>>>//     operi is a FormSub
41885>>>>>>>>>>>>>>>//     RadioGroupSub1 is a RadioGroupSub
41885>>>>>>>>>>>>>>>//       Radio1 is a RadioSub
41885>>>>>>>>>>>>>>>//       Radio2 is a RadioSub
41885>>>>>>>>>>>>>>>//     ButtonSub1 is a ButtonSub
41885>>>>>>>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
41885>>>>>>>>>>>>>>>//     ocodekat is a FormSub
41885>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
41885>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
41885>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
41885>>>>>>>>>>>>>>>
41885>>>>>>>>>>>>>>>// Register all objects
41885>>>>>>>>>>>>>>>Register_Object ButtonSub1
41885>>>>>>>>>>>>>>>Register_Object Fpa_DD
41885>>>>>>>>>>>>>>>Register_Object Item_DD
41885>>>>>>>>>>>>>>>Register_Object oCancel_bn
41885>>>>>>>>>>>>>>>Register_Object ocode
41885>>>>>>>>>>>>>>>Register_Object ocodekat
41885>>>>>>>>>>>>>>>Register_Object oOK_bn
41885>>>>>>>>>>>>>>>Register_Object operi
41885>>>>>>>>>>>>>>>Register_Object oSearch_bn
41885>>>>>>>>>>>>>>>Register_Object oSelList
41885>>>>>>>>>>>>>>>Register_Object Radio1
41885>>>>>>>>>>>>>>>Register_Object Radio2
41885>>>>>>>>>>>>>>>Register_Object RadioGroupSub1
41885>>>>>>>>>>>>>>>Register_Object SL22s
41885>>>>>>>>>>>>>>>Register_Object TextBoxSub1
41885>>>>>>>>>>>>>>>Register_Object TextBoxSub2
41885>>>>>>>>>>>>>>>Register_Object TextBoxSub3
41885>>>>>>>>>>>>>>>Register_Object Units_DD
41885>>>>>>>>>>>>>>>Register_Object Witemkat_DD
41885>>>>>>>>>>>>>>>
41885>>>>>>>>>>>>>>>
41885>>>>>>>>>>>>>>>
41885>>>>>>>>>>>>>>>    //AB-StoreTopStart
41885>>>>>>>>>>>>>>>                    
41885>>>>>>>>>>>>>>>                    
41885>>>>>>>>>>>>>>>    //AB-StoreTopEnd
41885>>>>>>>>>>>>>>>
41885>>>>>>>>>>>>>>>    //AB-IgnoreStart
41885>>>>>>>>>>>>>>>
41885>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
41885>>>>>>>>>>>>>>>    Use dbList.Sub
41885>>>>>>>>>>>>>>>    Use Txtbox.Sub
41885>>>>>>>>>>>>>>>    Use Form.Sub
41885>>>>>>>>>>>>>>>    Use Rgroup.Sub
41885>>>>>>>>>>>>>>>    Use Radio.Sub
41885>>>>>>>>>>>>>>>    Use Button.Sub
41885>>>>>>>>>>>>>>>
41885>>>>>>>>>>>>>>>
41885>>>>>>>>>>>>>>>    Use WITEMKAT.DD
41885>>>>>>>>>>>>>>>    Use UNITS.DD
41885>>>>>>>>>>>>>>>    Use FPA.DD
41885>>>>>>>>>>>>>>>    Use ITEM.DD
41885>>>>>>>>>>>>>>>    
41885>>>>>>>>>>>>>>>    //AB-IgnoreEnd
41885>>>>>>>>>>>>>>>
41885>>>>>>>>>>>>>>>    CD_Popup_Object SL22s is a dbModalPanel
41904>>>>>>>>>>>>>>>
41904>>>>>>>>>>>>>>>        //AB-StoreTopStart
41904>>>>>>>>>>>>>>>        Property String     pscode                  ''
41906>>>>>>>>>>>>>>>        Property String     psperi                  ''
41908>>>>>>>>>>>>>>>        Property Integer    piContains_Or_Starts     0
41910>>>>>>>>>>>>>>>        Property String     pscodekat               ''
41912>>>>>>>>>>>>>>>        
41912>>>>>>>>>>>>>>>        //AB-StoreTopEnd
41912>>>>>>>>>>>>>>>
41912>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
41913>>>>>>>>>>>>>>>        Set Label to "€¨®œå¦ „ ›é¤"
41914>>>>>>>>>>>>>>>        Set Size to 270 484
41915>>>>>>>>>>>>>>>        Set Location to 1 6
41916>>>>>>>>>>>>>>>
41916>>>>>>>>>>>>>>>        //AB-DDOStart
41916>>>>>>>>>>>>>>>
41916>>>>>>>>>>>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
41918>>>>>>>>>>>>>>>        End_Object    // Witemkat_DD
41919>>>>>>>>>>>>>>>
41919>>>>>>>>>>>>>>>        Object Units_DD is a Units_DataDictionary
41921>>>>>>>>>>>>>>>        End_Object    // Units_DD
41922>>>>>>>>>>>>>>>
41922>>>>>>>>>>>>>>>        Object Fpa_DD is a Fpa_DataDictionary
41924>>>>>>>>>>>>>>>        End_Object    // Fpa_DD
41925>>>>>>>>>>>>>>>
41925>>>>>>>>>>>>>>>        Object Item_DD is a Item_DataDictionary
41927>>>>>>>>>>>>>>>
41927>>>>>>>>>>>>>>>            //AB-StoreTopStart
41927>>>>>>>>>>>>>>>            Function fiPeriexei Returns Integer
41929>>>>>>>>>>>>>>>                       String lsperi lscode  lscodekat
41930>>>>>>>>>>>>>>>                       Integer rVal liContains_Or_Starts
41930>>>>>>>>>>>>>>>                       Move 0 to rVal
41931>>>>>>>>>>>>>>>                       Get piContains_Or_Starts to liContains_Or_Starts
41932>>>>>>>>>>>>>>>                       Get psperi to lsperi
41933>>>>>>>>>>>>>>>                       Get pscode to lscode
41934>>>>>>>>>>>>>>>                       Get pscodekat to lscodekat
41935>>>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
41936>>>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
41937>>>>>>>>>>>>>>>                  //     Move (Trim(lscodekat)) to lscodekat
41937>>>>>>>>>>>>>>>                       If (liContains_Or_Starts=0) Begin
41939>>>>>>>>>>>>>>>                           If ((Trim(item.item_descr)) Contains lsperi) Begin
41941>>>>>>>>>>>>>>>                               If ((Trim(item.item_code)) Contains lscode) Move 1 to rVal
41944>>>>>>>>>>>>>>>                           End
41944>>>>>>>>>>>>>>>>
41944>>>>>>>>>>>>>>>            
41944>>>>>>>>>>>>>>>                       End
41944>>>>>>>>>>>>>>>>
41944>>>>>>>>>>>>>>>                       Else Begin
41945>>>>>>>>>>>>>>>                           If (Left(item.item_descr,(Length(lsperi)))=lsperi) Begin
41947>>>>>>>>>>>>>>>                               If (Left(item.item_code,(Length(lscode)))=lscode) Move 1 to rVal
41950>>>>>>>>>>>>>>>                           End
41950>>>>>>>>>>>>>>>>
41950>>>>>>>>>>>>>>>            
41950>>>>>>>>>>>>>>>                       End
41950>>>>>>>>>>>>>>>>
41950>>>>>>>>>>>>>>>                       Function_Return rVal
41951>>>>>>>>>>>>>>>                   End_Function
41952>>>>>>>>>>>>>>>            
41952>>>>>>>>>>>>>>>                   Function fiArxizeiperi Returns Integer
41954>>>>>>>>>>>>>>>                       String lsperi
41955>>>>>>>>>>>>>>>                       Get psperi to lsperi
41956>>>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
41957>>>>>>>>>>>>>>>                       Function_Return (Left(item.item_descr,(Length(lsperi)))=lsperi)
41958>>>>>>>>>>>>>>>                   End_Function
41959>>>>>>>>>>>>>>>            
41959>>>>>>>>>>>>>>>                   Function fiArxizeicode Returns Integer
41961>>>>>>>>>>>>>>>                       String lscode lscodekat
41962>>>>>>>>>>>>>>>                       Get pscode to lscode
41963>>>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
41964>>>>>>>>>>>>>>>                       Function_Return (Left(item.item_code,(Length(lscode)))=lscode)
41965>>>>>>>>>>>>>>>                   End_Function
41966>>>>>>>>>>>>>>>            
41966>>>>>>>>>>>>>>>            //AB-StoreTopEnd
41966>>>>>>>>>>>>>>>
41966>>>>>>>>>>>>>>>            Set DDO_Server to (Units_DD(self))
41967>>>>>>>>>>>>>>>            Set DDO_Server to (Witemkat_DD(self))
41968>>>>>>>>>>>>>>>            Set DDO_Server to (Fpa_DD(self))
41969>>>>>>>>>>>>>>>
41969>>>>>>>>>>>>>>>            //AB-StoreStart
41969>>>>>>>>>>>>>>>                                                            
41969>>>>>>>>>>>>>>>                                                            
41969>>>>>>>>>>>>>>>                                                            
41969>>>>>>>>>>>>>>>            Begin_Constraints
41971>>>>>>>>>>>>>>>               String lsperi lscode lsvalue lstype lscodekat
41972>>>>>>>>>>>>>>>               Integer liContains_Or_Starts
41972>>>>>>>>>>>>>>>             //  Get FragmaItem  to lsValue
41972>>>>>>>>>>>>>>>            
41972>>>>>>>>>>>>>>>                   Get psperi  to lsperi
41973>>>>>>>>>>>>>>>                   Get pscode  to lscode
41974>>>>>>>>>>>>>>>                   Get pscodekat  to lscodekat
41975>>>>>>>>>>>>>>>                   Get piContains_Or_Starts to liContains_Or_Starts
41976>>>>>>>>>>>>>>>                   Move (Trim(lsperi)) to lsperi
41977>>>>>>>>>>>>>>>                   Move (Trim(lscode)) to lscode
41978>>>>>>>>>>>>>>>                   Move (Trim(lscodekat)) to lscodekat
41979>>>>>>>>>>>>>>>                   If ((lsperi<>'') and (lscode<>'')) begin
41981>>>>>>>>>>>>>>>                        set ordering to 5
41982>>>>>>>>>>>>>>>                        Constrain item as (fiPeriexei(Self)=1)
41983>>>>>>>>>>>>>>>                   end
41983>>>>>>>>>>>>>>>>
41983>>>>>>>>>>>>>>>                   Else Begin
41984>>>>>>>>>>>>>>>                      If (liContains_Or_Starts=0) Begin
41986>>>>>>>>>>>>>>>                        If (lsperi<>'') begin
41988>>>>>>>>>>>>>>>                            set ordering to 3
41989>>>>>>>>>>>>>>>                            Constrain item.item_descr Contains lsperi
41991>>>>>>>>>>>>>>>                        end
41991>>>>>>>>>>>>>>>>
41991>>>>>>>>>>>>>>>                        Else If (lscode<>'') begin
41994>>>>>>>>>>>>>>>                            set ordering to 5
41995>>>>>>>>>>>>>>>                            Constrain item.item_code Contains lscode
41997>>>>>>>>>>>>>>>                        end
41997>>>>>>>>>>>>>>>>
41997>>>>>>>>>>>>>>>                      End
41997>>>>>>>>>>>>>>>>
41997>>>>>>>>>>>>>>>                      Else Begin
41998>>>>>>>>>>>>>>>                           If (lsperi<>'') begin
42000>>>>>>>>>>>>>>>                                set ordering to 3
42001>>>>>>>>>>>>>>>                                Constrain item as (fiArxizeiperi(Self)=1) //item.item_descr
42002>>>>>>>>>>>>>>>                           end
42002>>>>>>>>>>>>>>>>
42002>>>>>>>>>>>>>>>                           Else If (lscode<>'') begin
42005>>>>>>>>>>>>>>>                                set ordering to 5
42006>>>>>>>>>>>>>>>                                Constrain item as (fiArxizeicode(Self)=1) //item.item_code
42007>>>>>>>>>>>>>>>                           end
42007>>>>>>>>>>>>>>>>
42007>>>>>>>>>>>>>>>                      End
42007>>>>>>>>>>>>>>>>
42007>>>>>>>>>>>>>>>                   End
42007>>>>>>>>>>>>>>>>
42007>>>>>>>>>>>>>>>                   If (lscodekat<>'') Constrain item.witemkat_code Contains lscodekat
42011>>>>>>>>>>>>>>>            
42011>>>>>>>>>>>>>>>            End_Constraints
42014>>>>>>>>>>>>>>>            
42014>>>>>>>>>>>>>>>            
42014>>>>>>>>>>>>>>>            
42014>>>>>>>>>>>>>>>            
42014>>>>>>>>>>>>>>>            //AB-StoreEnd
42014>>>>>>>>>>>>>>>
42014>>>>>>>>>>>>>>>        End_Object    // Item_DD
42015>>>>>>>>>>>>>>>
42015>>>>>>>>>>>>>>>        Set Main_DD to (Item_DD(self))
42016>>>>>>>>>>>>>>>        Set Server to (Item_DD(self))
42017>>>>>>>>>>>>>>>
42017>>>>>>>>>>>>>>>        //AB-DDOEnd
42017>>>>>>>>>>>>>>>
42017>>>>>>>>>>>>>>>        Object oSelList is a dbListSub
42019>>>>>>>>>>>>>>>            Set Main_File to Item.File_Number
42020>>>>>>>>>>>>>>>            Set Ordering to 5
42021>>>>>>>>>>>>>>>            Set Size to 190 475
42022>>>>>>>>>>>>>>>            Set Location to -1 2
42023>>>>>>>>>>>>>>>            Set Color to 14280447
42024>>>>>>>>>>>>>>>            Set CurrentRowColor to 11783679
42025>>>>>>>>>>>>>>>            Set CurrentCellColor to 11783679
42026>>>>>>>>>>>>>>>            Set Auto_Index_State to FALSE
42027>>>>>>>>>>>>>>>
42027>>>>>>>>>>>>>>>            Begin_Row
42030>>>>>>>>>>>>>>>                Entry_Item Item.Item_code
42031>>>>>>>>>>>>>>>                Entry_Item Item.Item_descr
42032>>>>>>>>>>>>>>>                Entry_Item Item.Witemkat_code
42033>>>>>>>>>>>>>>>                Entry_Item Witemkat.Witemkat_descr
42034>>>>>>>>>>>>>>>                Entry_Item Item.Item_qual
42035>>>>>>>>>>>>>>>                Entry_Item Fpa.Fpa_pososto
42036>>>>>>>>>>>>>>>            End_Row
42041>>>>>>>>>>>>>>>
42041>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 60
42042>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à›. „å›¦¬ª"
42043>>>>>>>>>>>>>>>            
42043>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 140
42044>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
42045>>>>>>>>>>>>>>>            
42045>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 70
42046>>>>>>>>>>>>>>>            Set Header_Label  item 2 to "‰à›. ‰˜«žš¦¨å˜ª"
42047>>>>>>>>>>>>>>>            
42047>>>>>>>>>>>>>>>            Set Form_Width    item 3 to 88
42048>>>>>>>>>>>>>>>            Set Header_Label  item 3 to "œ¨ š¨˜­ã ‰˜«žš."
42049>>>>>>>>>>>>>>>            
42049>>>>>>>>>>>>>>>            Set Form_Width    item 4 to 64
42050>>>>>>>>>>>>>>>            Set Header_Label  item 4 to "¦ æ«ž«˜"
42051>>>>>>>>>>>>>>>            
42051>>>>>>>>>>>>>>>            Set Form_Width    item 5 to 45
42052>>>>>>>>>>>>>>>            Set Header_Label  item 5 to "‰˜«.”..€"
42053>>>>>>>>>>>>>>>            
42053>>>>>>>>>>>>>>>
42053>>>>>>>>>>>>>>>            //AB-StoreStart
42053>>>>>>>>>>>>>>>            Property String Store_Fragma_Items public ""
42055>>>>>>>>>>>>>>>            set export_item_state to true
42056>>>>>>>>>>>>>>>            
42056>>>>>>>>>>>>>>>            Procedure Activating
42058>>>>>>>>>>>>>>>               Forward send Activating
42060>>>>>>>>>>>>>>>               Send Rebuild_Constraints to (Item_DD(Self))
42061>>>>>>>>>>>>>>>            End_Procedure
42062>>>>>>>>>>>>>>>            
42062>>>>>>>>>>>>>>>            procedure move_value_out
42064>>>>>>>>>>>>>>>                forward send move_value_out
42066>>>>>>>>>>>>>>>                set value of (ocode(self)) to ''
42067>>>>>>>>>>>>>>>                set value of (operi(self)) to ''
42068>>>>>>>>>>>>>>>                set value of (ocodekat(self)) to ''
42069>>>>>>>>>>>>>>>                set psperi to ''
42070>>>>>>>>>>>>>>>                set pscode to ''
42071>>>>>>>>>>>>>>>                set pscodekat to ''
42072>>>>>>>>>>>>>>>            end_procedure
42073>>>>>>>>>>>>>>>            
42073>>>>>>>>>>>>>>>            
42073>>>>>>>>>>>>>>>            
42073>>>>>>>>>>>>>>>            
42073>>>>>>>>>>>>>>>            
42073>>>>>>>>>>>>>>>            
42073>>>>>>>>>>>>>>>            
42073>>>>>>>>>>>>>>>            
42073>>>>>>>>>>>>>>>            
42073>>>>>>>>>>>>>>>            
42073>>>>>>>>>>>>>>>            
42073>>>>>>>>>>>>>>>            
42073>>>>>>>>>>>>>>>            
42073>>>>>>>>>>>>>>>            
42073>>>>>>>>>>>>>>>            
42073>>>>>>>>>>>>>>>            
42073>>>>>>>>>>>>>>>            
42073>>>>>>>>>>>>>>>            
42073>>>>>>>>>>>>>>>            
42073>>>>>>>>>>>>>>>            //AB-StoreEnd
42073>>>>>>>>>>>>>>>
42073>>>>>>>>>>>>>>>        End_Object    // oSelList
42074>>>>>>>>>>>>>>>
42074>>>>>>>>>>>>>>>        Object TextBoxSub1 is a TextBoxSub
42076>>>>>>>>>>>>>>>            Set Label to "‘á¨à©ž ‰à› ¡¦ç ‚ á"
42077>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
42078>>>>>>>>>>>>>>>            Set Location to 192 6
42079>>>>>>>>>>>>>>>            Set Size to 13 78
42080>>>>>>>>>>>>>>>        End_Object    // TextBoxSub1
42081>>>>>>>>>>>>>>>
42081>>>>>>>>>>>>>>>        Object ocode is a FormSub
42083>>>>>>>>>>>>>>>            Set Size to 13 197
42084>>>>>>>>>>>>>>>            Set Location to 192 79
42085>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
42086>>>>>>>>>>>>>>>
42086>>>>>>>>>>>>>>>            //AB-StoreStart
42086>>>>>>>>>>>>>>>            
42086>>>>>>>>>>>>>>>            Procedure OnKILLFOCUS
42088>>>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
42089>>>>>>>>>>>>>>>            End_Procedure
42090>>>>>>>>>>>>>>>            
42090>>>>>>>>>>>>>>>            
42090>>>>>>>>>>>>>>>            
42090>>>>>>>>>>>>>>>            
42090>>>>>>>>>>>>>>>            //AB-StoreEnd
42090>>>>>>>>>>>>>>>
42090>>>>>>>>>>>>>>>        End_Object    // ocode
42091>>>>>>>>>>>>>>>
42091>>>>>>>>>>>>>>>        Object TextBoxSub2 is a TextBoxSub
42093>>>>>>>>>>>>>>>            Set Label to "‘á¨à©ž œ¨ š¨˜­ãª "
42094>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
42095>>>>>>>>>>>>>>>            Set Location to 207 6
42096>>>>>>>>>>>>>>>            Set Size to 13 83
42097>>>>>>>>>>>>>>>        End_Object    // TextBoxSub2
42098>>>>>>>>>>>>>>>
42098>>>>>>>>>>>>>>>        Object operi is a FormSub
42100>>>>>>>>>>>>>>>            Set Size to 13 197
42101>>>>>>>>>>>>>>>            Set Location to 207 79
42102>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
42103>>>>>>>>>>>>>>>
42103>>>>>>>>>>>>>>>            //AB-StoreStart
42103>>>>>>>>>>>>>>>            
42103>>>>>>>>>>>>>>>            Procedure OnKILLFOCUS
42105>>>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
42106>>>>>>>>>>>>>>>            End_Procedure
42107>>>>>>>>>>>>>>>            
42107>>>>>>>>>>>>>>>            
42107>>>>>>>>>>>>>>>            
42107>>>>>>>>>>>>>>>            
42107>>>>>>>>>>>>>>>            //AB-StoreEnd
42107>>>>>>>>>>>>>>>
42107>>>>>>>>>>>>>>>        End_Object    // operi
42108>>>>>>>>>>>>>>>
42108>>>>>>>>>>>>>>>        Object RadioGroupSub1 is a RadioGroupSub
42110>>>>>>>>>>>>>>>            Set Size to 32 77
42111>>>>>>>>>>>>>>>            Set Location to 193 277
42112>>>>>>>>>>>>>>>            Object Radio1 is a RadioSub
42114>>>>>>>>>>>>>>>                Set Label to "œ¨ â®œ«˜ "
42115>>>>>>>>>>>>>>>                Set Size to 10 53
42116>>>>>>>>>>>>>>>                Set Location to 7 5
42117>>>>>>>>>>>>>>>            End_Object    // Radio1
42118>>>>>>>>>>>>>>>
42118>>>>>>>>>>>>>>>            Object Radio2 is a RadioSub
42120>>>>>>>>>>>>>>>                Set Label to "€¨®åœ  €§æ"
42121>>>>>>>>>>>>>>>                Set Size to 10 51
42122>>>>>>>>>>>>>>>                Set Location to 21 5
42123>>>>>>>>>>>>>>>            End_Object    // Radio2
42124>>>>>>>>>>>>>>>
42124>>>>>>>>>>>>>>>
42124>>>>>>>>>>>>>>>            //AB-StoreStart
42124>>>>>>>>>>>>>>>            
42124>>>>>>>>>>>>>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
42126>>>>>>>>>>>>>>>                Set piContains_Or_Starts to iToItem
42127>>>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
42128>>>>>>>>>>>>>>>            End_Procedure
42129>>>>>>>>>>>>>>>            
42129>>>>>>>>>>>>>>>            
42129>>>>>>>>>>>>>>>            
42129>>>>>>>>>>>>>>>            
42129>>>>>>>>>>>>>>>            //AB-StoreEnd
42129>>>>>>>>>>>>>>>
42129>>>>>>>>>>>>>>>        End_Object    // RadioGroupSub1
42130>>>>>>>>>>>>>>>
42130>>>>>>>>>>>>>>>        Object ButtonSub1 is a ButtonSub
42132>>>>>>>>>>>>>>>            Set Label to "Search"
42133>>>>>>>>>>>>>>>            Set Size to 28 37
42134>>>>>>>>>>>>>>>            Set Location to 198 357
42135>>>>>>>>>>>>>>>            Set Form_FontWeight Item 0 to 800
42136>>>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "ms sans serif"
42137>>>>>>>>>>>>>>>
42137>>>>>>>>>>>>>>>            //AB-StoreStart
42137>>>>>>>>>>>>>>>                                                            
42137>>>>>>>>>>>>>>>            Set Visible_State to False
42138>>>>>>>>>>>>>>>            
42138>>>>>>>>>>>>>>>            Procedure OnClick
42140>>>>>>>>>>>>>>>                Forward Send OnClick
42142>>>>>>>>>>>>>>>                Set pscode  to (Value(ocode(Self),0))
42143>>>>>>>>>>>>>>>                Set psperi  to (Value(operi(Self),0))
42144>>>>>>>>>>>>>>>                Set pscodekat  to (Value(ocodekat(Self),0))
42145>>>>>>>>>>>>>>>                send Rebuild_Constraints    to (item_DD(Self))
42146>>>>>>>>>>>>>>>                Send Beginning_Of_Data      to oSelList True
42147>>>>>>>>>>>>>>>            End_Procedure // OnClick
42148>>>>>>>>>>>>>>>            
42148>>>>>>>>>>>>>>>            
42148>>>>>>>>>>>>>>>            
42148>>>>>>>>>>>>>>>            
42148>>>>>>>>>>>>>>>            
42148>>>>>>>>>>>>>>>            
42148>>>>>>>>>>>>>>>            
42148>>>>>>>>>>>>>>>            
42148>>>>>>>>>>>>>>>            
42148>>>>>>>>>>>>>>>            
42148>>>>>>>>>>>>>>>            
42148>>>>>>>>>>>>>>>            
42148>>>>>>>>>>>>>>>            
42148>>>>>>>>>>>>>>>            //AB-StoreEnd
42148>>>>>>>>>>>>>>>
42148>>>>>>>>>>>>>>>        End_Object    // ButtonSub1
42149>>>>>>>>>>>>>>>
42149>>>>>>>>>>>>>>>        Object TextBoxSub3 is a TextBoxSub
42151>>>>>>>>>>>>>>>            Set Label to "‰à›.‰˜«žš¦¨å˜ª ‚ á"
42152>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
42153>>>>>>>>>>>>>>>            Set Location to 221 5
42154>>>>>>>>>>>>>>>            Set Size to 13 78
42155>>>>>>>>>>>>>>>        End_Object    // TextBoxSub3
42156>>>>>>>>>>>>>>>
42156>>>>>>>>>>>>>>>        Object ocodekat is a FormSub
42158>>>>>>>>>>>>>>>            Set Size to 13 197
42159>>>>>>>>>>>>>>>            Set Location to 221 78
42160>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
42161>>>>>>>>>>>>>>>
42161>>>>>>>>>>>>>>>            //AB-StoreStart
42161>>>>>>>>>>>>>>>            
42161>>>>>>>>>>>>>>>            Procedure OnKILLFOCUS
42163>>>>>>>>>>>>>>>               Send KeyAction to ButtonSub1
42164>>>>>>>>>>>>>>>            End_Procedure
42165>>>>>>>>>>>>>>>            
42165>>>>>>>>>>>>>>>            
42165>>>>>>>>>>>>>>>            
42165>>>>>>>>>>>>>>>            //AB-StoreEnd
42165>>>>>>>>>>>>>>>
42165>>>>>>>>>>>>>>>        End_Object    // ocodekat
42166>>>>>>>>>>>>>>>
42166>>>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
42168>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
42169>>>>>>>>>>>>>>>            Set Location to 237 316
42170>>>>>>>>>>>>>>>
42170>>>>>>>>>>>>>>>            //AB-StoreStart
42170>>>>>>>>>>>>>>>            Procedure OnClick
42172>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
42173>>>>>>>>>>>>>>>            End_Procedure
42174>>>>>>>>>>>>>>>            //AB-StoreEnd
42174>>>>>>>>>>>>>>>
42174>>>>>>>>>>>>>>>        End_Object    // oOK_bn
42175>>>>>>>>>>>>>>>
42175>>>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
42177>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
42178>>>>>>>>>>>>>>>            Set Location to 237 371
42179>>>>>>>>>>>>>>>
42179>>>>>>>>>>>>>>>            //AB-StoreStart
42179>>>>>>>>>>>>>>>            Procedure OnClick
42181>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
42182>>>>>>>>>>>>>>>            End_Procedure
42183>>>>>>>>>>>>>>>            //AB-StoreEnd
42183>>>>>>>>>>>>>>>
42183>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
42184>>>>>>>>>>>>>>>
42184>>>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
42186>>>>>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
42187>>>>>>>>>>>>>>>            Set Location to 237 426
42188>>>>>>>>>>>>>>>
42188>>>>>>>>>>>>>>>            //AB-StoreStart
42188>>>>>>>>>>>>>>>            Procedure OnClick
42190>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
42191>>>>>>>>>>>>>>>            End_Procedure
42192>>>>>>>>>>>>>>>            //AB-StoreEnd
42192>>>>>>>>>>>>>>>
42192>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
42193>>>>>>>>>>>>>>>
42193>>>>>>>>>>>>>>>
42193>>>>>>>>>>>>>>>        //AB-StoreStart
42193>>>>>>>>>>>>>>>                
42193>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
42194>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
42195>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
42196>>>>>>>>>>>>>>>        
42196>>>>>>>>>>>>>>>        
42196>>>>>>>>>>>>>>>        procedure page integer pagemode
42198>>>>>>>>>>>>>>>            forward send page pagemode
42200>>>>>>>>>>>>>>>            set location to 40,40
42201>>>>>>>>>>>>>>>        end_procedure
42202>>>>>>>>>>>>>>>        
42202>>>>>>>>>>>>>>>        procedure request_cancel
42204>>>>>>>>>>>>>>>            forward send request_cancel
42206>>>>>>>>>>>>>>>            set value of (ocode(self)) to ''
42207>>>>>>>>>>>>>>>            set value of (operi(self)) to ''
42208>>>>>>>>>>>>>>>            set value of (ocodekat(self)) to ''
42209>>>>>>>>>>>>>>>            Set psperi  to ''
42210>>>>>>>>>>>>>>>            Set pscode  to ''
42211>>>>>>>>>>>>>>>            Set pscodekat TO ''
42212>>>>>>>>>>>>>>>        end_procedure
42213>>>>>>>>>>>>>>>        
42213>>>>>>>>>>>>>>>        
42213>>>>>>>>>>>>>>>        
42213>>>>>>>>>>>>>>>        
42213>>>>>>>>>>>>>>>        
42213>>>>>>>>>>>>>>>        
42213>>>>>>>>>>>>>>>        
42213>>>>>>>>>>>>>>>        
42213>>>>>>>>>>>>>>>        
42213>>>>>>>>>>>>>>>        
42213>>>>>>>>>>>>>>>        //AB-StoreEnd
42213>>>>>>>>>>>>>>>
42213>>>>>>>>>>>>>>>    CD_End_Object    // SL22s
42215>>>>>>>>>>>>>>>>
42215>>>>>>>>>>>>>>>
42215>>>>>>>>>>>>>>>
42215>>>>>>>>>>>>>>>    //AB-StoreStart
42215>>>>>>>>>>>>>>>                    
42215>>>>>>>>>>>>>>>                    
42215>>>>>>>>>>>>>>>                    
42215>>>>>>>>>>>>>>>                    
42215>>>>>>>>>>>>>>>                    
42215>>>>>>>>>>>>>>>                    
42215>>>>>>>>>>>>>>>                    
42215>>>>>>>>>>>>>>>                    
42215>>>>>>>>>>>>>>>                    
42215>>>>>>>>>>>>>>>                    
42215>>>>>>>>>>>>>>>    //AB-StoreEnd
42215>>>>>>>>>>>>>>>
42215>>>>>>>>>>>>>>>//AB/     End_Object    // prj
42215>>>>>>>>>>>>>Use sl022.SL         // sl022
42215>>>>>>>>>>>>>
42215>>>>>>>>>>>>>//DDB-Selection-pkg-End
42215>>>>>>>>>>>>>//DDB-FileEnd
42215>>>>>>>>>>>    Use WITEMX.DD
INCLUDING FILE: WITEMX.DD
42215>>>>>>>>>>>>>//DDB-FileStart
42215>>>>>>>>>>>>>//DDB-HeaderStart
42215>>>>>>>>>>>>>
42215>>>>>>>>>>>>>// File Name : WITEMX.DD
42215>>>>>>>>>>>>>// Class Name: Witemx_DataDictionary
42215>>>>>>>>>>>>>// Revision  : 75
42215>>>>>>>>>>>>>// Version   : 2
42215>>>>>>>>>>>>>
42215>>>>>>>>>>>>>Use  Windows           // Basic Definitions
42215>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
42215>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
42215>>>>>>>>>>>>>
42215>>>>>>>>>>>>>Open Witemx
42217>>>>>>>>>>>>>Open Wcmoves
42219>>>>>>>>>>>>>Open Witemxt
42221>>>>>>>>>>>>>Open Pmoves
42223>>>>>>>>>>>>>Open Wam
42225>>>>>>>>>>>>>Open Pmovesl
42227>>>>>>>>>>>>>Open Witemxen
INCLUDING FILE: WITEMXEN.FD
42229>>>>>>>>>>>>>Open Camovedd
INCLUDING FILE: CAMOVEDD.FD
42231>>>>>>>>>>>>>Open Item
42233>>>>>>>>>>>>>Open Sysrecw
42235>>>>>>>>>>>>>Open Syscurxr
42237>>>>>>>>>>>>>
42237>>>>>>>>>>>>>//DDB-HeaderEnd
42237>>>>>>>>>>>>>//DDB-SelectionStart
42237>>>>>>>>>>>>>//DDB/ ExternalSelectionList SL17  sl17.SL
42237>>>>>>>>>>>>>Register_Object SL17
42237>>>>>>>>>>>>>//DDB-SelectionEnd
42237>>>>>>>>>>>>>
42237>>>>>>>>>>>>>Class Witemx_DataDictionary  is a DataDictionary
42238>>>>>>>>>>>>>
42238>>>>>>>>>>>>>    Procedure Construct_Object
42239>>>>>>>>>>>>>        Forward Send Construct_Object
42241>>>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
42242>>>>>>>>>>>>>    End_Procedure //construct_object
42243>>>>>>>>>>>>>
42243>>>>>>>>>>>>>    Procedure OnConstrain
42244>>>>>>>>>>>>>        Forward Send OnConstrain
42246>>>>>>>>>>>>>        If (piMustNOTConstrain(Self)) Begin
42248>>>>>>>>>>>>>        End
42248>>>>>>>>>>>>>>
42248>>>>>>>>>>>>>        Else Begin
42249>>>>>>>>>>>>>            Constrain Witemx.Company_Code  eq SysCurXR.Company_Code
42251>>>>>>>>>>>>>            Constrain Witemx.Branch_Code   eq SysCurXR.Branch_Code
42253>>>>>>>>>>>>>            Constrain Witemx.Year_Year     eq SysCurXR.Year_Year
42255>>>>>>>>>>>>>        End
42255>>>>>>>>>>>>>>
42255>>>>>>>>>>>>>    End_Procedure
42256>>>>>>>>>>>>>
42256>>>>>>>>>>>>>    Procedure Save_Main_File
42257>>>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
42259>>>>>>>>>>>>>            If Witemx.Recnum Eq 0 Procedure_Return
42262>>>>>>>>>>>>>        End
42262>>>>>>>>>>>>>>
42262>>>>>>>>>>>>>        Forward Send Save_Main_File
42264>>>>>>>>>>>>>    End_Procedure
42265>>>>>>>>>>>>>
42265>>>>>>>>>>>>>    // Update:
42265>>>>>>>>>>>>>    Procedure Update
42266>>>>>>>>>>>>>        Forward Send Update
42268>>>>>>>>>>>>>        // Insert Code Here
42268>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to Witemx.Company_Code
42269>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Witemx.Branch_Code
42270>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to Witemx.Year_Year
42271>>>>>>>>>>>>>        Move SysCurXR.Year_Recr     to Witemx.Year_Recr
42272>>>>>>>>>>>>>        Move Witemkat.Witemkat_Code to Witemx.Witemkat_Code
42273>>>>>>>>>>>>>        Move Units.Units_Code       to Witemx.Units_Code
42274>>>>>>>>>>>>>        Move Item.Item_Code         to Witemx.Item_Code
42275>>>>>>>>>>>>>        Move Item.Item_Code         to Witemx.Witemx_Code
42276>>>>>>>>>>>>>        Move Item.Item_Descr        to Witemx.Witemx_Descr
42277>>>>>>>>>>>>>        Move Item.Wapokat_Code      to Witemx.ITEM_APOKAT_COD 
42278>>>>>>>>>>>>>        Move Item.link1             to witemx.link1
42279>>>>>>>>>>>>>        move Item.link2             to witemx.link2
42280>>>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Xre/Witemx.Qty_Xre),4))  to Witemx.Mesosta_Xre
42281>>>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Pis/Witemx.Qty_Pis),4))  to Witemx.Mesosta_Pis
42282>>>>>>>>>>>>>    End_Procedure   // Update
42283>>>>>>>>>>>>>
42283>>>>>>>>>>>>>
42283>>>>>>>>>>>>>    Procedure Backout
42284>>>>>>>>>>>>>        Forward Send Backout
42286>>>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Xre/Witemx.Qty_Xre),4))  to Witemx.Mesosta_Xre
42287>>>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Pis/Witemx.Qty_Pis),4))  to Witemx.Mesosta_Pis
42288>>>>>>>>>>>>>    End_Procedure   // Update
42289>>>>>>>>>>>>>
42289>>>>>>>>>>>>>    Procedure Creating
42290>>>>>>>>>>>>>        Forward Send Creating
42292>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                       (Trim(String(Witemx.Witemx_Rec0)))))) to Witemx.Witemx_Recr
42293>>>>>>>>>>>>>    End_Procedure   // Creating
42294>>>>>>>>>>>>>
42294>>>>>>>>>>>>>
42294>>>>>>>>>>>>>
42294>>>>>>>>>>>>>    // Define_Fields:
42294>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
42294>>>>>>>>>>>>>
42294>>>>>>>>>>>>>    Procedure Define_Fields
42295>>>>>>>>>>>>>        Forward Send Define_Fields
42297>>>>>>>>>>>>>        //DDB-Generated-Code-Location
42297>>>>>>>>>>>>>        //DDB-DefineFieldStart
42297>>>>>>>>>>>>>
42297>>>>>>>>>>>>>        Set Main_File            To Witemx.File_Number
42298>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
42299>>>>>>>>>>>>>
42299>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
42300>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
42301>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
42302>>>>>>>>>>>>>
42302>>>>>>>>>>>>>        // Child (Client) file structure................
42302>>>>>>>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
42303>>>>>>>>>>>>>        Send Add_Client_File  Witemxt.File_Number
42304>>>>>>>>>>>>>        Send Add_Client_File  Pmoves.File_Number
42305>>>>>>>>>>>>>        Send Add_Client_File  Wam.File_Number
42306>>>>>>>>>>>>>        Send Add_Client_File  Pmovesl.File_Number
42307>>>>>>>>>>>>>        Send Add_Client_File  Witemxen.File_Number
42308>>>>>>>>>>>>>        Send Add_Client_File  Camovedd.File_Number
42309>>>>>>>>>>>>>
42309>>>>>>>>>>>>>        // Parent (Server) file structure...............
42309>>>>>>>>>>>>>        Send Add_Server_File  Item.File_Number
42310>>>>>>>>>>>>>
42310>>>>>>>>>>>>>        // External (System) file structure.............
42310>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
42311>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
42312>>>>>>>>>>>>>
42312>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Witemx_Rec0  To Witemx.Witemx_Rec0
42315>>>>>>>>>>>>>
42315>>>>>>>>>>>>>        // Field-based properties.......................
42315>>>>>>>>>>>>>
42315>>>>>>>>>>>>>        // Witemx.Company_Code
42315>>>>>>>>>>>>>
42315>>>>>>>>>>>>>        // Witemx.Branch_Code
42315>>>>>>>>>>>>>
42315>>>>>>>>>>>>>        // Witemx.Year_Year
42315>>>>>>>>>>>>>
42315>>>>>>>>>>>>>        // Witemx.Units_Code
42315>>>>>>>>>>>>>
42315>>>>>>>>>>>>>        // Witemx.Witemkat_Code
42315>>>>>>>>>>>>>
42315>>>>>>>>>>>>>        // Witemx.Item_Code
42315>>>>>>>>>>>>>
42315>>>>>>>>>>>>>        // Witemx.Witemx_Code
42315>>>>>>>>>>>>>        Set Field_Options          Field Witemx.Witemx_Code To DD_AUTOFIND   
42316>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Code To (SL17(Self))
42317>>>>>>>>>>>>>        Set Key_Field_State        Field Witemx.Witemx_Code To TRUE
42318>>>>>>>>>>>>>
42318>>>>>>>>>>>>>        // Witemx.Witemx_Recr
42318>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Recr To (SL17(Self))
42319>>>>>>>>>>>>>
42319>>>>>>>>>>>>>        // Witemx.Year_Recr
42319>>>>>>>>>>>>>
42319>>>>>>>>>>>>>        // Witemx.Item_Recr
42319>>>>>>>>>>>>>
42319>>>>>>>>>>>>>        // Witemx.Witemx_Descr
42319>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Descr To (SL17(Self))
42320>>>>>>>>>>>>>
42320>>>>>>>>>>>>>        // Witemx.Witemx_Rec0
42320>>>>>>>>>>>>>
42320>>>>>>>>>>>>>        // Witemx.Witemx_Yeardesc
42320>>>>>>>>>>>>>
42320>>>>>>>>>>>>>        // Witemx.Item_Apokat_Cod
42320>>>>>>>>>>>>>
42320>>>>>>>>>>>>>        // Witemx.Qty_Xre
42320>>>>>>>>>>>>>
42320>>>>>>>>>>>>>        // Witemx.Qty_Pis
42320>>>>>>>>>>>>>
42320>>>>>>>>>>>>>        // Witemx.Axia_Xre
42320>>>>>>>>>>>>>
42320>>>>>>>>>>>>>        // Witemx.Axia_Pis
42320>>>>>>>>>>>>>
42320>>>>>>>>>>>>>        // Witemx.Mesosta_Xre
42320>>>>>>>>>>>>>
42320>>>>>>>>>>>>>        // Witemx.Mesosta_Pis
42320>>>>>>>>>>>>>
42320>>>>>>>>>>>>>        // Witemx.Link1
42320>>>>>>>>>>>>>
42320>>>>>>>>>>>>>        // Witemx.Link2
42320>>>>>>>>>>>>>
42320>>>>>>>>>>>>>        //DDB-DefineFieldEnd
42320>>>>>>>>>>>>>    End_Procedure    // Define_Fields
42321>>>>>>>>>>>>>
42321>>>>>>>>>>>>>    // Field_Defaults:
42321>>>>>>>>>>>>>    // This procedure is used to establish default field values.
42321>>>>>>>>>>>>>
42321>>>>>>>>>>>>>    Procedure Field_Defaults
42322>>>>>>>>>>>>>        Forward Send Field_Defaults
42324>>>>>>>>>>>>>        //DDB-Generated-Code-Location
42324>>>>>>>>>>>>>        //DDB-FieldDefaultStart
42324>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
42324>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
42325>>>>>>>>>>>>>
42325>>>>>>>>>>>>>End_Class    // Witemx_DataDictionary
42326>>>>>>>>>>>>>//DDB-Selection-pkg-Start
42326>>>>>>>>>>>>>
42326>>>>>>>>>>>>>Use sl17.SL          // SL17
INCLUDING FILE: SL17.SL
42326>>>>>>>>>>>>>>>//AB/ Project SL17:witemx
42326>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
42326>>>>>>>>>>>>>>>//AB/         Set ProjectName to "SL17:witemx"
42326>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl17.SL"
42326>>>>>>>>>>>>>>>
42326>>>>>>>>>>>>>>>// Project Object Structure
42326>>>>>>>>>>>>>>>//   SL17 is a dbModalPanelSub
42326>>>>>>>>>>>>>>>//     Units_DD is a DataDictionary
42326>>>>>>>>>>>>>>>//     Witemkat_DD is a DataDictionary
42326>>>>>>>>>>>>>>>//     Fpa_DD is a DataDictionary
42326>>>>>>>>>>>>>>>//     Item_DD is a DataDictionary
42326>>>>>>>>>>>>>>>//     Witemx_DD is a DataDictionary
42326>>>>>>>>>>>>>>>//     oSelList is a dbListSub
42326>>>>>>>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
42326>>>>>>>>>>>>>>>//     ocode is a FormSub
42326>>>>>>>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
42326>>>>>>>>>>>>>>>//     operi is a FormSub
42326>>>>>>>>>>>>>>>//     RadioGroupSub1 is a RadioGroupSub
42326>>>>>>>>>>>>>>>//       Radio1 is a RadioSub
42326>>>>>>>>>>>>>>>//       Radio2 is a RadioSub
42326>>>>>>>>>>>>>>>//     ButtonSub1 is a ButtonSub
42326>>>>>>>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
42326>>>>>>>>>>>>>>>//     ocodekat is a FormSub
42326>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
42326>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
42326>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
42326>>>>>>>>>>>>>>>//     btnwitemcl is a ButtonSub
42326>>>>>>>>>>>>>>>
42326>>>>>>>>>>>>>>>// Register all objects
42326>>>>>>>>>>>>>>>Register_Object ButtonSub1
42326>>>>>>>>>>>>>>>Register_Object btnwitemcl
42326>>>>>>>>>>>>>>>Register_Object Fpa_DD
42326>>>>>>>>>>>>>>>Register_Object Item_DD
42326>>>>>>>>>>>>>>>Register_Object oCancel_bn
42326>>>>>>>>>>>>>>>Register_Object ocode
42326>>>>>>>>>>>>>>>Register_Object ocodekat
42326>>>>>>>>>>>>>>>Register_Object oOK_bn
42326>>>>>>>>>>>>>>>Register_Object operi
42326>>>>>>>>>>>>>>>Register_Object oSearch_bn
42326>>>>>>>>>>>>>>>Register_Object oSelList
42326>>>>>>>>>>>>>>>Register_Object Radio1
42326>>>>>>>>>>>>>>>Register_Object Radio2
42326>>>>>>>>>>>>>>>Register_Object RadioGroupSub1
42326>>>>>>>>>>>>>>>Register_Object SL17
42326>>>>>>>>>>>>>>>Register_Object TextBoxSub1
42326>>>>>>>>>>>>>>>Register_Object TextBoxSub2
42326>>>>>>>>>>>>>>>Register_Object TextBoxSub3
42326>>>>>>>>>>>>>>>Register_Object Units_DD
42326>>>>>>>>>>>>>>>Register_Object Witemkat_DD
42326>>>>>>>>>>>>>>>Register_Object Witemx_DD
42326>>>>>>>>>>>>>>>
42326>>>>>>>>>>>>>>>
42326>>>>>>>>>>>>>>>
42326>>>>>>>>>>>>>>>    //AB-StoreTopStart
42326>>>>>>>>>>>>>>>    use dg186.dg
INCLUDING FILE: DG186.DG
42326>>>>>>>>>>>>>>>>>//AB/ Project dg186
42326>>>>>>>>>>>>>>>>>//AB/     Object prj is a Dialog_Project
42326>>>>>>>>>>>>>>>>>//AB/         Set ProjectName to "dg186"
42326>>>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "dg186.DG"
42326>>>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
42326>>>>>>>>>>>>>>>>>
42326>>>>>>>>>>>>>>>>>// Project Object Structure
42326>>>>>>>>>>>>>>>>>//   dg186 is a dbModalPanelSub
42326>>>>>>>>>>>>>>>>>//     Witemkat_DD is a DataDictionary
42326>>>>>>>>>>>>>>>>>//     Units_DD is a DataDictionary
42326>>>>>>>>>>>>>>>>>//     Fpa_DD is a DataDictionary
42326>>>>>>>>>>>>>>>>>//     Item_DD is a DataDictionary
42326>>>>>>>>>>>>>>>>>//     Witemcl_DD is a DataDictionary
42326>>>>>>>>>>>>>>>>>//     The_Table is a dbGrid
42326>>>>>>>>>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
42326>>>>>>>>>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
42326>>>>>>>>>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
42326>>>>>>>>>>>>>>>>>//     ocode is a FormSub
42326>>>>>>>>>>>>>>>>>//     operi is a FormSub
42326>>>>>>>>>>>>>>>>>//     ocodeprom is a FormSub
42326>>>>>>>>>>>>>>>>>//     RadioGroupSub1 is a RadioGroupSub
42326>>>>>>>>>>>>>>>>>//       Radio1 is a RadioSub
42326>>>>>>>>>>>>>>>>>//       Radio2 is a RadioSub
42326>>>>>>>>>>>>>>>>>//     ButtonSub1 is a ButtonSub
42326>>>>>>>>>>>>>>>>>//     btnwitemcl is a ButtonSub
42326>>>>>>>>>>>>>>>>>
42326>>>>>>>>>>>>>>>>>// Register all objects
42326>>>>>>>>>>>>>>>>>Register_Object ButtonSub1
42326>>>>>>>>>>>>>>>>>Register_Object btnwitemcl
42326>>>>>>>>>>>>>>>>>Register_Object dg186
42326>>>>>>>>>>>>>>>>>Register_Object Fpa_DD
42326>>>>>>>>>>>>>>>>>Register_Object Item_DD
42326>>>>>>>>>>>>>>>>>Register_Object ocode
42326>>>>>>>>>>>>>>>>>Register_Object ocodeprom
42326>>>>>>>>>>>>>>>>>Register_Object operi
42326>>>>>>>>>>>>>>>>>Register_Object Radio1
42326>>>>>>>>>>>>>>>>>Register_Object Radio2
42326>>>>>>>>>>>>>>>>>Register_Object RadioGroupSub1
42326>>>>>>>>>>>>>>>>>Register_Object TextBoxSub1
42326>>>>>>>>>>>>>>>>>Register_Object TextBoxSub2
42326>>>>>>>>>>>>>>>>>Register_Object TextBoxSub3
42326>>>>>>>>>>>>>>>>>Register_Object The_Table
42326>>>>>>>>>>>>>>>>>Register_Object Units_DD
42326>>>>>>>>>>>>>>>>>Register_Object Witemcl_DD
42326>>>>>>>>>>>>>>>>>Register_Object Witemkat_DD
42326>>>>>>>>>>>>>>>>>
42326>>>>>>>>>>>>>>>>>
42326>>>>>>>>>>>>>>>>>
42326>>>>>>>>>>>>>>>>>    //AB-StoreTopStart
42326>>>>>>>>>>>>>>>>>    open clients
42328>>>>>>>>>>>>>>>>>    use sl17.sl
42328>>>>>>>>>>>>>>>>>    //AB-StoreTopEnd
42328>>>>>>>>>>>>>>>>>
42328>>>>>>>>>>>>>>>>>    //AB-IgnoreStart
42328>>>>>>>>>>>>>>>>>
42328>>>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
42328>>>>>>>>>>>>>>>>>    Use Txtbox.Sub
42328>>>>>>>>>>>>>>>>>    Use Form.Sub
42328>>>>>>>>>>>>>>>>>    Use Rgroup.Sub
42328>>>>>>>>>>>>>>>>>    Use Radio.Sub
42328>>>>>>>>>>>>>>>>>    Use Button.Sub
42328>>>>>>>>>>>>>>>>>
42328>>>>>>>>>>>>>>>>>
42328>>>>>>>>>>>>>>>>>    Use WITEMKAT.DD
42328>>>>>>>>>>>>>>>>>    Use UNITS.DD
42328>>>>>>>>>>>>>>>>>    Use FPA.DD
42328>>>>>>>>>>>>>>>>>    Use ITEM.DD
42328>>>>>>>>>>>>>>>>>    Use WITEMCL.DD
INCLUDING FILE: WITEMCL.DD
42328>>>>>>>>>>>>>>>>>>>//DDB-FileStart
42328>>>>>>>>>>>>>>>>>>>//DDB-HeaderStart
42328>>>>>>>>>>>>>>>>>>>
42328>>>>>>>>>>>>>>>>>>>// File Name : WITEMCL.DD
42328>>>>>>>>>>>>>>>>>>>// Class Name: Witemcl_DataDictionary
42328>>>>>>>>>>>>>>>>>>>// Revision  : 16
42328>>>>>>>>>>>>>>>>>>>// Version   : 2
42328>>>>>>>>>>>>>>>>>>>
42328>>>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
42328>>>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
42328>>>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
42328>>>>>>>>>>>>>>>>>>>
42328>>>>>>>>>>>>>>>>>>>Open Witemcl
42330>>>>>>>>>>>>>>>>>>>Open Witemcld
42332>>>>>>>>>>>>>>>>>>>Open Item
42334>>>>>>>>>>>>>>>>>>>Open Sysrecw
42336>>>>>>>>>>>>>>>>>>>
42336>>>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
42336>>>>>>>>>>>>>>>>>>>//DDB-SelectionStart
42336>>>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList SL100  sl100.sl
42336>>>>>>>>>>>>>>>>>>>Register_Object SL100
42336>>>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
42336>>>>>>>>>>>>>>>>>>>
42336>>>>>>>>>>>>>>>>>>>Class Witemcl_DataDictionary  is a DataDictionary_Sec
42337>>>>>>>>>>>>>>>>>>> 
42337>>>>>>>>>>>>>>>>>>>    // Update:
42337>>>>>>>>>>>>>>>>>>> 
42337>>>>>>>>>>>>>>>>>>>    Procedure Update
42338>>>>>>>>>>>>>>>>>>>        Forward Send Update  
42340>>>>>>>>>>>>>>>>>>>        move item.item_descr to witemcl.item_descr
42341>>>>>>>>>>>>>>>>>>>    End_Procedure   // Update
42342>>>>>>>>>>>>>>>>>>> 
42342>>>>>>>>>>>>>>>>>>>
42342>>>>>>>>>>>>>>>>>>>    // Define_Fields:
42342>>>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
42342>>>>>>>>>>>>>>>>>>>
42342>>>>>>>>>>>>>>>>>>>    Procedure Define_Fields
42343>>>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
42345>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
42345>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
42345>>>>>>>>>>>>>>>>>>>
42345>>>>>>>>>>>>>>>>>>>        Set Main_File            To Witemcl.File_Number
42346>>>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
42347>>>>>>>>>>>>>>>>>>>
42347>>>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
42348>>>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
42349>>>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
42350>>>>>>>>>>>>>>>>>>>
42350>>>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
42350>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Witemcld.File_Number
42351>>>>>>>>>>>>>>>>>>>
42351>>>>>>>>>>>>>>>>>>>        // Parent (Server) file structure...............
42351>>>>>>>>>>>>>>>>>>>        Send Add_Server_File  Item.File_Number
42352>>>>>>>>>>>>>>>>>>>
42352>>>>>>>>>>>>>>>>>>>        // External (System) file structure.............
42352>>>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
42353>>>>>>>>>>>>>>>>>>>
42353>>>>>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Witemcl_Rec0  To Witemcl.Rec0
42356>>>>>>>>>>>>>>>>>>>
42356>>>>>>>>>>>>>>>>>>>        // Field-based properties.......................
42356>>>>>>>>>>>>>>>>>>>
42356>>>>>>>>>>>>>>>>>>>        // Witemcl.Item_Code
42356>>>>>>>>>>>>>>>>>>>
42356>>>>>>>>>>>>>>>>>>>        // Witemcl.Client_Code
42356>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemcl.Client_Code To (SL100(Self))
42357>>>>>>>>>>>>>>>>>>>
42357>>>>>>>>>>>>>>>>>>>        // Witemcl.Client_Itemcode
42357>>>>>>>>>>>>>>>>>>>
42357>>>>>>>>>>>>>>>>>>>        // Witemcl.Client_Date
42357>>>>>>>>>>>>>>>>>>>        Set Field_Mask_Type        Field Witemcl.Client_Date To MASK_DATE_WINDOW
42358>>>>>>>>>>>>>>>>>>>
42358>>>>>>>>>>>>>>>>>>>        // Witemcl.Client_Price
42358>>>>>>>>>>>>>>>>>>>        Set Field_Mask_Type        Field Witemcl.Client_Price To MASK_NUMERIC_WINDOW
42359>>>>>>>>>>>>>>>>>>>
42359>>>>>>>>>>>>>>>>>>>        // Witemcl.Item_Descr
42359>>>>>>>>>>>>>>>>>>>
42359>>>>>>>>>>>>>>>>>>>        // Witemcl.Rec0
42359>>>>>>>>>>>>>>>>>>>
42359>>>>>>>>>>>>>>>>>>>        // Witemcl.Is_Client
42359>>>>>>>>>>>>>>>>>>>
42359>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
42359>>>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
42360>>>>>>>>>>>>>>>>>>>
42360>>>>>>>>>>>>>>>>>>>    // Field_Defaults:
42360>>>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
42360>>>>>>>>>>>>>>>>>>>
42360>>>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
42361>>>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
42363>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
42363>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
42363>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
42363>>>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
42364>>>>>>>>>>>>>>>>>>>
42364>>>>>>>>>>>>>>>>>>>End_Class    // Witemcl_DataDictionary
42365>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
42365>>>>>>>>>>>>>>>>>>>
42365>>>>>>>>>>>>>>>>>>>Use sl100.sl         // SL100
42365>>>>>>>>>>>>>>>>>>>
42365>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
42365>>>>>>>>>>>>>>>>>>>//DDB-FileEnd
42365>>>>>>>>>>>>>>>>>    
42365>>>>>>>>>>>>>>>>>    //AB-IgnoreEnd
42365>>>>>>>>>>>>>>>>>
42365>>>>>>>>>>>>>>>>>    Object dg186 is a dbModalPanelSub
42367>>>>>>>>>>>>>>>>>
42367>>>>>>>>>>>>>>>>>        //AB-StoreTopStart
42367>>>>>>>>>>>>>>>>>        Function fsclient string code Returns string
42369>>>>>>>>>>>>>>>>>            string name
42370>>>>>>>>>>>>>>>>>            clear clients
42371>>>>>>>>>>>>>>>>>            move code to clients.client_id
42372>>>>>>>>>>>>>>>>>            find eq clients by index.6
42373>>>>>>>>>>>>>>>>>>
42373>>>>>>>>>>>>>>>>>            move clients.client_name to name
42374>>>>>>>>>>>>>>>>>            function_return name
42375>>>>>>>>>>>>>>>>>        end_Function
42376>>>>>>>>>>>>>>>>>        
42376>>>>>>>>>>>>>>>>>        Property String     pscode                  ''
42378>>>>>>>>>>>>>>>>>        Property String     psperi                  ''
42380>>>>>>>>>>>>>>>>>        Property Integer    piContains_Or_Starts     0
42382>>>>>>>>>>>>>>>>>        Property String     pscodeprom              ''
42384>>>>>>>>>>>>>>>>>        
42384>>>>>>>>>>>>>>>>>        
42384>>>>>>>>>>>>>>>>>        //AB-StoreTopEnd
42384>>>>>>>>>>>>>>>>>
42384>>>>>>>>>>>>>>>>>        Set Label to "‘¬©®œ«å©œ ª „ ›é¤ €§¦Ÿã¡žª"
42385>>>>>>>>>>>>>>>>>        Set Size to 289 527
42386>>>>>>>>>>>>>>>>>        Set Location to 0 2
42387>>>>>>>>>>>>>>>>>
42387>>>>>>>>>>>>>>>>>        //AB-DDOStart
42387>>>>>>>>>>>>>>>>>
42387>>>>>>>>>>>>>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
42389>>>>>>>>>>>>>>>>>        End_Object    // Witemkat_DD
42390>>>>>>>>>>>>>>>>>
42390>>>>>>>>>>>>>>>>>        Object Units_DD is a Units_DataDictionary
42392>>>>>>>>>>>>>>>>>        End_Object    // Units_DD
42393>>>>>>>>>>>>>>>>>
42393>>>>>>>>>>>>>>>>>        Object Fpa_DD is a Fpa_DataDictionary
42395>>>>>>>>>>>>>>>>>        End_Object    // Fpa_DD
42396>>>>>>>>>>>>>>>>>
42396>>>>>>>>>>>>>>>>>        Object Item_DD is a Item_DataDictionary
42398>>>>>>>>>>>>>>>>>            Set DDO_Server to (Units_DD(self))
42399>>>>>>>>>>>>>>>>>            Set DDO_Server to (Witemkat_DD(self))
42400>>>>>>>>>>>>>>>>>            Set DDO_Server to (Fpa_DD(self))
42401>>>>>>>>>>>>>>>>>        End_Object    // Item_DD
42402>>>>>>>>>>>>>>>>>
42402>>>>>>>>>>>>>>>>>        Object Witemcl_DD is a Witemcl_DataDictionary
42404>>>>>>>>>>>>>>>>>
42404>>>>>>>>>>>>>>>>>            //AB-StoreTopStart
42404>>>>>>>>>>>>>>>>>            Function fiPeriexei Returns Integer
42406>>>>>>>>>>>>>>>>>                       String lsperi lscode  lscodeprom
42407>>>>>>>>>>>>>>>>>                       Integer rVal liContains_Or_Starts
42407>>>>>>>>>>>>>>>>>                       Move 0 to rVal
42408>>>>>>>>>>>>>>>>>                       Get piContains_Or_Starts to liContains_Or_Starts
42409>>>>>>>>>>>>>>>>>                       Get psperi to lsperi
42410>>>>>>>>>>>>>>>>>                       Get pscode to lscode
42411>>>>>>>>>>>>>>>>>                       Get pscodeprom to lscodeprom
42412>>>>>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
42413>>>>>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
42414>>>>>>>>>>>>>>>>>                  //     Move (Trim(lscodekat)) to lscodekat
42414>>>>>>>>>>>>>>>>>                       If (liContains_Or_Starts=0) Begin
42416>>>>>>>>>>>>>>>>>                           If ((Trim(witemcl.item_descr)) Contains lsperi) Begin
42418>>>>>>>>>>>>>>>>>                               If ((Trim(witemcl.item_code)) Contains lscode) Move 1 to rVal
42421>>>>>>>>>>>>>>>>>                           End
42421>>>>>>>>>>>>>>>>>>
42421>>>>>>>>>>>>>>>>>            
42421>>>>>>>>>>>>>>>>>                       End
42421>>>>>>>>>>>>>>>>>>
42421>>>>>>>>>>>>>>>>>                       Else Begin
42422>>>>>>>>>>>>>>>>>                           If (Left(witemcl.item_descr,(Length(lsperi)))=lsperi) Begin
42424>>>>>>>>>>>>>>>>>                               If (Left(witemcl.item_code,(Length(lscode)))=lscode) Move 1 to rVal
42427>>>>>>>>>>>>>>>>>                           End
42427>>>>>>>>>>>>>>>>>>
42427>>>>>>>>>>>>>>>>>            
42427>>>>>>>>>>>>>>>>>                       End
42427>>>>>>>>>>>>>>>>>>
42427>>>>>>>>>>>>>>>>>                       Function_Return rVal
42428>>>>>>>>>>>>>>>>>                   End_Function
42429>>>>>>>>>>>>>>>>>            
42429>>>>>>>>>>>>>>>>>                   Function fiArxizeiperi Returns Integer
42431>>>>>>>>>>>>>>>>>                       String lsperi
42432>>>>>>>>>>>>>>>>>                       Get psperi to lsperi
42433>>>>>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
42434>>>>>>>>>>>>>>>>>                       Function_Return (Left(witemcl.item_descr,(Length(lsperi)))=lsperi)
42435>>>>>>>>>>>>>>>>>                   End_Function
42436>>>>>>>>>>>>>>>>>            
42436>>>>>>>>>>>>>>>>>                   Function fiArxizeicode Returns Integer
42438>>>>>>>>>>>>>>>>>                       String lscode lscodeprom
42439>>>>>>>>>>>>>>>>>                       Get pscode to lscode
42440>>>>>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
42441>>>>>>>>>>>>>>>>>                       Function_Return (Left(witemcl.item_code,(Length(lscode)))=lscode)
42442>>>>>>>>>>>>>>>>>                   End_Function
42443>>>>>>>>>>>>>>>>>            
42443>>>>>>>>>>>>>>>>>            //AB-StoreTopEnd
42443>>>>>>>>>>>>>>>>>
42443>>>>>>>>>>>>>>>>>            Set DDO_Server to (Item_DD(self))
42444>>>>>>>>>>>>>>>>>
42444>>>>>>>>>>>>>>>>>            //AB-StoreStart
42444>>>>>>>>>>>>>>>>>                                                                
42444>>>>>>>>>>>>>>>>>                                                                
42444>>>>>>>>>>>>>>>>>            Begin_Constraints
42446>>>>>>>>>>>>>>>>>               String lsperi lscode lsvalue lstype lscodeprom
42447>>>>>>>>>>>>>>>>>               Integer liContains_Or_Starts
42447>>>>>>>>>>>>>>>>>                   Get psperi  to lsperi
42448>>>>>>>>>>>>>>>>>                   Get pscode  to lscode
42449>>>>>>>>>>>>>>>>>                   Get pscodeprom  to lscodeprom
42450>>>>>>>>>>>>>>>>>                   Get piContains_Or_Starts to liContains_Or_Starts
42451>>>>>>>>>>>>>>>>>                   Move (Trim(lsperi)) to lsperi
42452>>>>>>>>>>>>>>>>>                   Move (Trim(lscode)) to lscode
42453>>>>>>>>>>>>>>>>>                   Move (Trim(lscodeprom)) to lscodeprom
42454>>>>>>>>>>>>>>>>>                   If ((lsperi<>'') and ;                      (lscode<>'')) Constrain witemcl as (fiPeriexei(Self)=1)
42457>>>>>>>>>>>>>>>>>                   Else Begin
42458>>>>>>>>>>>>>>>>>                      If (liContains_Or_Starts=0) Begin
42460>>>>>>>>>>>>>>>>>                      If (lsperi<>'') Constrain witemcl.item_descr Contains lsperi
42464>>>>>>>>>>>>>>>>>                      Else If (lscode<>'') Constrain witemcl.item_code Contains lscode
42469>>>>>>>>>>>>>>>>>                      End
42469>>>>>>>>>>>>>>>>>>
42469>>>>>>>>>>>>>>>>>                   Else Begin
42470>>>>>>>>>>>>>>>>>                       If (lsperi<>'') Constrain witemcl as (fiArxizeiperi(Self)=1) //witemcl.item_descr
42473>>>>>>>>>>>>>>>>>                       Else If (lscode<>'') Constrain witemcl as (fiArxizeicode(Self)=1) //witemcl.item_code
42477>>>>>>>>>>>>>>>>>                       End
42477>>>>>>>>>>>>>>>>>>
42477>>>>>>>>>>>>>>>>>                   End
42477>>>>>>>>>>>>>>>>>>
42477>>>>>>>>>>>>>>>>>                   If (lscodeprom<>'') Constrain witemcl.client_itemcode Contains lscodeprom
42481>>>>>>>>>>>>>>>>>            
42481>>>>>>>>>>>>>>>>>            End_Constraints
42484>>>>>>>>>>>>>>>>>            
42484>>>>>>>>>>>>>>>>>            
42484>>>>>>>>>>>>>>>>>            //AB-StoreEnd
42484>>>>>>>>>>>>>>>>>
42484>>>>>>>>>>>>>>>>>        End_Object    // Witemcl_DD
42485>>>>>>>>>>>>>>>>>
42485>>>>>>>>>>>>>>>>>        Set Main_DD to (Witemcl_DD(self))
42486>>>>>>>>>>>>>>>>>        Set Server to (Witemcl_DD(self))
42487>>>>>>>>>>>>>>>>>
42487>>>>>>>>>>>>>>>>>        //AB-DDOEnd
42487>>>>>>>>>>>>>>>>>
42487>>>>>>>>>>>>>>>>>        Object The_Table is a dbGrid
42489>>>>>>>>>>>>>>>>>            Set Main_File to Witemcl.File_Number
42490>>>>>>>>>>>>>>>>>            Set Size to 201 519
42491>>>>>>>>>>>>>>>>>            Set Location to 3 2
42492>>>>>>>>>>>>>>>>>            Set Color to 14280447
42493>>>>>>>>>>>>>>>>>            Set CurrentRowColor to 11783679
42494>>>>>>>>>>>>>>>>>            Set CurrentCellColor to 11783679
42495>>>>>>>>>>>>>>>>>            Set Wrap_State to TRUE
42496>>>>>>>>>>>>>>>>>
42496>>>>>>>>>>>>>>>>>            Begin_Row
42499>>>>>>>>>>>>>>>>>                Entry_Item Witemcl.Item_code
42500>>>>>>>>>>>>>>>>>                Entry_Item Witemcl.Client_itemcode
42501>>>>>>>>>>>>>>>>>                Entry_Item Witemcl.Item_descr
42502>>>>>>>>>>>>>>>>>                Entry_Item Witemcl.Client_code
42503>>>>>>>>>>>>>>>>>                Entry_Item (fsclient(self,witemcl.client_code))
42504>>>>>>>>>>>>>>>>>            End_Row
42509>>>>>>>>>>>>>>>>>
42509>>>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 100
42510>>>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª „å›¦¬ª"
42511>>>>>>>>>>>>>>>>>            
42511>>>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 100
42512>>>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "„å›¦ª ¨¦£žŸœ¬«ã"
42513>>>>>>>>>>>>>>>>>            
42513>>>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 200
42514>>>>>>>>>>>>>>>>>            Set Header_Label  item 2 to "œ¨ š¨˜­ã „å›¦¬ª"
42515>>>>>>>>>>>>>>>>>            
42515>>>>>>>>>>>>>>>>>            Set Form_Width    item 3 to 0
42516>>>>>>>>>>>>>>>>>            Set Header_Label  item 3 to ""
42517>>>>>>>>>>>>>>>>>            
42517>>>>>>>>>>>>>>>>>            Set Form_Width    item 4 to 111
42518>>>>>>>>>>>>>>>>>            Set Header_Label  item 4 to "¨¦£žŸœ¬«ãª"
42519>>>>>>>>>>>>>>>>>            
42519>>>>>>>>>>>>>>>>>
42519>>>>>>>>>>>>>>>>>            //AB-StoreStart
42519>>>>>>>>>>>>>>>>>            Set Column_Option Item 3 to NoEnter True
42520>>>>>>>>>>>>>>>>>            //set read_only_state to true
42520>>>>>>>>>>>>>>>>>            set no_create_state to true
42521>>>>>>>>>>>>>>>>>            set no_delete_state to true
42522>>>>>>>>>>>>>>>>>            //AB-StoreEnd
42522>>>>>>>>>>>>>>>>>
42522>>>>>>>>>>>>>>>>>        End_Object    // The_Table
42523>>>>>>>>>>>>>>>>>
42523>>>>>>>>>>>>>>>>>        Object TextBoxSub1 is a TextBoxSub
42525>>>>>>>>>>>>>>>>>            Set Label to "‘á¨à©ž ‰à› ¡¦ç ‚ á"
42526>>>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
42527>>>>>>>>>>>>>>>>>            Set Location to 208 5
42528>>>>>>>>>>>>>>>>>            Set Size to 13 78
42529>>>>>>>>>>>>>>>>>        End_Object    // TextBoxSub1
42530>>>>>>>>>>>>>>>>>
42530>>>>>>>>>>>>>>>>>        Object TextBoxSub2 is a TextBoxSub
42532>>>>>>>>>>>>>>>>>            Set Label to "‘á¨à©ž œ¨ š¨˜­ãª "
42533>>>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
42534>>>>>>>>>>>>>>>>>            Set Location to 223 5
42535>>>>>>>>>>>>>>>>>            Set Size to 13 83
42536>>>>>>>>>>>>>>>>>        End_Object    // TextBoxSub2
42537>>>>>>>>>>>>>>>>>
42537>>>>>>>>>>>>>>>>>        Object TextBoxSub3 is a TextBoxSub
42539>>>>>>>>>>>>>>>>>            Set Label to "„å›¦ª ¨¦£žŸœ¬«ã ‚ á"
42540>>>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
42541>>>>>>>>>>>>>>>>>            Set Location to 237 5
42542>>>>>>>>>>>>>>>>>            Set Size to 13 78
42543>>>>>>>>>>>>>>>>>        End_Object    // TextBoxSub3
42544>>>>>>>>>>>>>>>>>
42544>>>>>>>>>>>>>>>>>        Object ocode is a FormSub
42546>>>>>>>>>>>>>>>>>            Set Size to 13 197
42547>>>>>>>>>>>>>>>>>            Set Location to 209 91
42548>>>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
42549>>>>>>>>>>>>>>>>>
42549>>>>>>>>>>>>>>>>>            //AB-StoreStart
42549>>>>>>>>>>>>>>>>>                                                                                                                                                                                                    
42549>>>>>>>>>>>>>>>>>            Procedure OnKILLFOCUS
42551>>>>>>>>>>>>>>>>>               Send KeyAction to ButtonSub1
42552>>>>>>>>>>>>>>>>>            End_Procedure
42553>>>>>>>>>>>>>>>>>            
42553>>>>>>>>>>>>>>>>>            
42553>>>>>>>>>>>>>>>>>            
42553>>>>>>>>>>>>>>>>>            
42553>>>>>>>>>>>>>>>>>            //AB-StoreEnd
42553>>>>>>>>>>>>>>>>>
42553>>>>>>>>>>>>>>>>>        End_Object    // ocode
42554>>>>>>>>>>>>>>>>>
42554>>>>>>>>>>>>>>>>>        Object operi is a FormSub
42556>>>>>>>>>>>>>>>>>            Set Size to 13 197
42557>>>>>>>>>>>>>>>>>            Set Location to 223 91
42558>>>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
42559>>>>>>>>>>>>>>>>>
42559>>>>>>>>>>>>>>>>>            //AB-StoreStart
42559>>>>>>>>>>>>>>>>>                                                                                                                                                                                                    
42559>>>>>>>>>>>>>>>>>            Procedure OnKILLFOCUS
42561>>>>>>>>>>>>>>>>>              Send KeyAction to ButtonSub1
42562>>>>>>>>>>>>>>>>>            End_Procedure
42563>>>>>>>>>>>>>>>>>            
42563>>>>>>>>>>>>>>>>>            
42563>>>>>>>>>>>>>>>>>            
42563>>>>>>>>>>>>>>>>>            
42563>>>>>>>>>>>>>>>>>            //AB-StoreEnd
42563>>>>>>>>>>>>>>>>>
42563>>>>>>>>>>>>>>>>>        End_Object    // operi
42564>>>>>>>>>>>>>>>>>
42564>>>>>>>>>>>>>>>>>        Object ocodeprom is a FormSub
42566>>>>>>>>>>>>>>>>>            Set Size to 13 197
42567>>>>>>>>>>>>>>>>>            Set Location to 238 91
42568>>>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
42569>>>>>>>>>>>>>>>>>
42569>>>>>>>>>>>>>>>>>            //AB-StoreStart
42569>>>>>>>>>>>>>>>>>                                                                                                                                                                                                    
42569>>>>>>>>>>>>>>>>>            Procedure OnKILLFOCUS
42571>>>>>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
42572>>>>>>>>>>>>>>>>>            End_Procedure
42573>>>>>>>>>>>>>>>>>            
42573>>>>>>>>>>>>>>>>>            
42573>>>>>>>>>>>>>>>>>            
42573>>>>>>>>>>>>>>>>>            //AB-StoreEnd
42573>>>>>>>>>>>>>>>>>
42573>>>>>>>>>>>>>>>>>        End_Object    // ocodeprom
42574>>>>>>>>>>>>>>>>>
42574>>>>>>>>>>>>>>>>>        Object RadioGroupSub1 is a RadioGroupSub
42576>>>>>>>>>>>>>>>>>            Set Size to 32 77
42577>>>>>>>>>>>>>>>>>            Set Location to 209 296
42578>>>>>>>>>>>>>>>>>            Object Radio1 is a RadioSub
42580>>>>>>>>>>>>>>>>>                Set Label to "œ¨ â®œ«˜ "
42581>>>>>>>>>>>>>>>>>                Set Size to 10 53
42582>>>>>>>>>>>>>>>>>                Set Location to 7 5
42583>>>>>>>>>>>>>>>>>            End_Object    // Radio1
42584>>>>>>>>>>>>>>>>>
42584>>>>>>>>>>>>>>>>>            Object Radio2 is a RadioSub
42586>>>>>>>>>>>>>>>>>                Set Label to "€¨®åœ  €§æ"
42587>>>>>>>>>>>>>>>>>                Set Size to 10 51
42588>>>>>>>>>>>>>>>>>                Set Location to 21 5
42589>>>>>>>>>>>>>>>>>            End_Object    // Radio2
42590>>>>>>>>>>>>>>>>>
42590>>>>>>>>>>>>>>>>>
42590>>>>>>>>>>>>>>>>>            //AB-StoreStart
42590>>>>>>>>>>>>>>>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
42590>>>>>>>>>>>>>>>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
42592>>>>>>>>>>>>>>>>>                //iToItem=0 => Contains, =1 => Starts with
42592>>>>>>>>>>>>>>>>>                Set piContains_Or_Starts to iToItem
42593>>>>>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
42594>>>>>>>>>>>>>>>>>            End_Procedure
42595>>>>>>>>>>>>>>>>>            
42595>>>>>>>>>>>>>>>>>            // If you set Current_radio you must set this after the
42595>>>>>>>>>>>>>>>>>            // radio objects have been created AND after Notify_select_State has been
42595>>>>>>>>>>>>>>>>>            // created. i.e. Set in bottom-code at end!!
42595>>>>>>>>>>>>>>>>>            //Set Current_Radio to 0
42595>>>>>>>>>>>>>>>>>            
42595>>>>>>>>>>>>>>>>>            
42595>>>>>>>>>>>>>>>>>            //AB-StoreEnd
42595>>>>>>>>>>>>>>>>>
42595>>>>>>>>>>>>>>>>>        End_Object    // RadioGroupSub1
42596>>>>>>>>>>>>>>>>>
42596>>>>>>>>>>>>>>>>>        Object ButtonSub1 is a ButtonSub
42598>>>>>>>>>>>>>>>>>            Set Label to "Search"
42599>>>>>>>>>>>>>>>>>            Set Size to 28 37
42600>>>>>>>>>>>>>>>>>            Set Location to 210 413
42601>>>>>>>>>>>>>>>>>            Set Form_FontWeight Item 0 to 800
42602>>>>>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "ms sans serif"
42603>>>>>>>>>>>>>>>>>
42603>>>>>>>>>>>>>>>>>            //AB-StoreStart
42603>>>>>>>>>>>>>>>>>                                        
42603>>>>>>>>>>>>>>>>>            Set Visible_State to False
42604>>>>>>>>>>>>>>>>>            
42604>>>>>>>>>>>>>>>>>            Procedure OnClick
42606>>>>>>>>>>>>>>>>>                Forward Send OnClick
42608>>>>>>>>>>>>>>>>>                Set pscode  to (Value(ocode(Self),0))
42609>>>>>>>>>>>>>>>>>                Set psperi  to (Value(operi(Self),0))
42610>>>>>>>>>>>>>>>>>                Set pscodeprom  to (Value(ocodeprom(Self),0))
42611>>>>>>>>>>>>>>>>>                send Rebuild_Constraints    to (witemcl_DD(Self))
42612>>>>>>>>>>>>>>>>>                Send Beginning_Of_Data      to the_table
42613>>>>>>>>>>>>>>>>>            End_Procedure // OnClick
42614>>>>>>>>>>>>>>>>>            
42614>>>>>>>>>>>>>>>>>            
42614>>>>>>>>>>>>>>>>>            
42614>>>>>>>>>>>>>>>>>            
42614>>>>>>>>>>>>>>>>>            
42614>>>>>>>>>>>>>>>>>            
42614>>>>>>>>>>>>>>>>>            
42614>>>>>>>>>>>>>>>>>            
42614>>>>>>>>>>>>>>>>>            
42614>>>>>>>>>>>>>>>>>            
42614>>>>>>>>>>>>>>>>>            
42614>>>>>>>>>>>>>>>>>            
42614>>>>>>>>>>>>>>>>>            
42614>>>>>>>>>>>>>>>>>            
42614>>>>>>>>>>>>>>>>>            
42614>>>>>>>>>>>>>>>>>            //AB-StoreEnd
42614>>>>>>>>>>>>>>>>>
42614>>>>>>>>>>>>>>>>>        End_Object    // ButtonSub1
42615>>>>>>>>>>>>>>>>>
42615>>>>>>>>>>>>>>>>>        Object btnwitemcl is a ButtonSub
42617>>>>>>>>>>>>>>>>>
42617>>>>>>>>>>>>>>>>>            //AB-StoreTopStart
42617>>>>>>>>>>>>>>>>>                                                                                    
42617>>>>>>>>>>>>>>>>>            //AB-StoreTopEnd
42617>>>>>>>>>>>>>>>>>
42617>>>>>>>>>>>>>>>>>            Set Label to "ButtonSub1"
42618>>>>>>>>>>>>>>>>>            Set Bitmap to "Filesys3.bmp"
42619>>>>>>>>>>>>>>>>>            Set Size to 22 25
42620>>>>>>>>>>>>>>>>>            Set Location to 214 482
42621>>>>>>>>>>>>>>>>>            Set Focus_Mode to Pointer_Only
42622>>>>>>>>>>>>>>>>>
42622>>>>>>>>>>>>>>>>>            //AB-StoreStart
42622>>>>>>>>>>>>>>>>>                                                                                    
42622>>>>>>>>>>>>>>>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«¦ œ¬¨œ«ã¨ ¦ „ ›é¤"
42623>>>>>>>>>>>>>>>>>            
42623>>>>>>>>>>>>>>>>>            Procedure OnClick
42625>>>>>>>>>>>>>>>>>                String  scode speri
42626>>>>>>>>>>>>>>>>>                Get value of (ocode(self)) to scode
42627>>>>>>>>>>>>>>>>>                Get value of (operi(self)) to speri
42628>>>>>>>>>>>>>>>>>                set pscode of (sl17(self)) to scode
42629>>>>>>>>>>>>>>>>>                set psperi of (sl17(self)) to speri
42630>>>>>>>>>>>>>>>>>                send request_cancel to dg186
42631>>>>>>>>>>>>>>>>>            End_Procedure // OnClick
42632>>>>>>>>>>>>>>>>>            
42632>>>>>>>>>>>>>>>>>            
42632>>>>>>>>>>>>>>>>>            
42632>>>>>>>>>>>>>>>>>            
42632>>>>>>>>>>>>>>>>>            
42632>>>>>>>>>>>>>>>>>            
42632>>>>>>>>>>>>>>>>>            
42632>>>>>>>>>>>>>>>>>            
42632>>>>>>>>>>>>>>>>>            
42632>>>>>>>>>>>>>>>>>            
42632>>>>>>>>>>>>>>>>>            
42632>>>>>>>>>>>>>>>>>            
42632>>>>>>>>>>>>>>>>>            
42632>>>>>>>>>>>>>>>>>            
42632>>>>>>>>>>>>>>>>>            
42632>>>>>>>>>>>>>>>>>            
42632>>>>>>>>>>>>>>>>>            
42632>>>>>>>>>>>>>>>>>            
42632>>>>>>>>>>>>>>>>>            
42632>>>>>>>>>>>>>>>>>            
42632>>>>>>>>>>>>>>>>>            
42632>>>>>>>>>>>>>>>>>            //AB-StoreEnd
42632>>>>>>>>>>>>>>>>>
42632>>>>>>>>>>>>>>>>>        End_Object    // btnwitemcl
42633>>>>>>>>>>>>>>>>>
42633>>>>>>>>>>>>>>>>>
42633>>>>>>>>>>>>>>>>>        //AB-StoreStart
42633>>>>>>>>>>>>>>>>>        Procedure Activating
42635>>>>>>>>>>>>>>>>>           integer rval
42636>>>>>>>>>>>>>>>>>           set value of (ocode(self)) to (pscode(self))
42637>>>>>>>>>>>>>>>>>           set value of (operi(self)) to (psperi(self))
42638>>>>>>>>>>>>>>>>>           Send Rebuild_Constraints to (witemcl_DD(Self))
42639>>>>>>>>>>>>>>>>>           Forward send Activating
42641>>>>>>>>>>>>>>>>>        
42641>>>>>>>>>>>>>>>>>        End_Procedure
42642>>>>>>>>>>>>>>>>>        
42642>>>>>>>>>>>>>>>>>        
42642>>>>>>>>>>>>>>>>>        
42642>>>>>>>>>>>>>>>>>        
42642>>>>>>>>>>>>>>>>>        
42642>>>>>>>>>>>>>>>>>        
42642>>>>>>>>>>>>>>>>>        //AB-StoreEnd
42642>>>>>>>>>>>>>>>>>
42642>>>>>>>>>>>>>>>>>    End_Object    // dg186
42643>>>>>>>>>>>>>>>>>
42643>>>>>>>>>>>>>>>>>
42643>>>>>>>>>>>>>>>>>    //AB-StoreStart
42643>>>>>>>>>>>>>>>>>        
42643>>>>>>>>>>>>>>>>>    //AB-StoreEnd
42643>>>>>>>>>>>>>>>>>
42643>>>>>>>>>>>>>>>>>//AB/     End_Object    // prj
42643>>>>>>>>>>>>>>>    //AB-StoreTopEnd
42643>>>>>>>>>>>>>>>
42643>>>>>>>>>>>>>>>    //AB-IgnoreStart
42643>>>>>>>>>>>>>>>
42643>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
42643>>>>>>>>>>>>>>>    Use dbList.Sub
42643>>>>>>>>>>>>>>>    Use Txtbox.Sub
42643>>>>>>>>>>>>>>>    Use Form.Sub
42643>>>>>>>>>>>>>>>    Use Rgroup.Sub
42643>>>>>>>>>>>>>>>    Use Radio.Sub
42643>>>>>>>>>>>>>>>    Use Button.Sub
42643>>>>>>>>>>>>>>>
42643>>>>>>>>>>>>>>>
42643>>>>>>>>>>>>>>>    Use UNITS.DD
42643>>>>>>>>>>>>>>>    Use WITEMKAT.DD
42643>>>>>>>>>>>>>>>    Use FPA.DD
42643>>>>>>>>>>>>>>>    Use ITEM.DD
42643>>>>>>>>>>>>>>>    Use WITEMX.DD
42643>>>>>>>>>>>>>>>    
42643>>>>>>>>>>>>>>>    //AB-IgnoreEnd
42643>>>>>>>>>>>>>>>
42643>>>>>>>>>>>>>>>    Object SL17 is a dbModalPanelSub
42645>>>>>>>>>>>>>>>
42645>>>>>>>>>>>>>>>        //AB-StoreTopStart
42645>>>>>>>>>>>>>>>                
42645>>>>>>>>>>>>>>>        Property String     pscode                  ''
42647>>>>>>>>>>>>>>>        Property String     psperi                  ''
42649>>>>>>>>>>>>>>>        Property Integer    piContains_Or_Starts     0
42651>>>>>>>>>>>>>>>        Property String     pscodekat               ''
42653>>>>>>>>>>>>>>>        
42653>>>>>>>>>>>>>>>        //AB-StoreTopEnd
42653>>>>>>>>>>>>>>>
42653>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
42654>>>>>>>>>>>>>>>        Set Label to "„¬¨œ«ã¨ ¦ €¨®œå¦¬ „ ›é¤"
42655>>>>>>>>>>>>>>>        Set Size to 266 484
42656>>>>>>>>>>>>>>>        Set Location to 9 14
42657>>>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
42658>>>>>>>>>>>>>>>        Set Modal_State to FALSE
42659>>>>>>>>>>>>>>>
42659>>>>>>>>>>>>>>>        //AB-DDOStart
42659>>>>>>>>>>>>>>>
42659>>>>>>>>>>>>>>>        Object Units_DD is a Units_DataDictionary
42661>>>>>>>>>>>>>>>        End_Object    // Units_DD
42662>>>>>>>>>>>>>>>
42662>>>>>>>>>>>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
42664>>>>>>>>>>>>>>>        End_Object    // Witemkat_DD
42665>>>>>>>>>>>>>>>
42665>>>>>>>>>>>>>>>        Object Fpa_DD is a Fpa_DataDictionary
42667>>>>>>>>>>>>>>>        End_Object    // Fpa_DD
42668>>>>>>>>>>>>>>>
42668>>>>>>>>>>>>>>>        Object Item_DD is a Item_DataDictionary
42670>>>>>>>>>>>>>>>
42670>>>>>>>>>>>>>>>            //AB-StoreTopStart
42670>>>>>>>>>>>>>>>                                                                                                    
42670>>>>>>>>>>>>>>>                                                                                                    
42670>>>>>>>>>>>>>>>            //AB-StoreTopEnd
42670>>>>>>>>>>>>>>>
42670>>>>>>>>>>>>>>>            Set DDO_Server to (Units_DD(self))
42671>>>>>>>>>>>>>>>            Set DDO_Server to (Witemkat_DD(self))
42672>>>>>>>>>>>>>>>            Set DDO_Server to (Fpa_DD(self))
42673>>>>>>>>>>>>>>>
42673>>>>>>>>>>>>>>>            //AB-StoreStart
42673>>>>>>>>>>>>>>>                                                                                                    
42673>>>>>>>>>>>>>>>                                                                                                    
42673>>>>>>>>>>>>>>>                                                                                                    
42673>>>>>>>>>>>>>>>                                                                                                    
42673>>>>>>>>>>>>>>>                                                                                                    
42673>>>>>>>>>>>>>>>                                                                                                    
42673>>>>>>>>>>>>>>>                                                                                                    
42673>>>>>>>>>>>>>>>                                                                                                    
42673>>>>>>>>>>>>>>>            //AB-StoreEnd
42673>>>>>>>>>>>>>>>
42673>>>>>>>>>>>>>>>        End_Object    // Item_DD
42674>>>>>>>>>>>>>>>
42674>>>>>>>>>>>>>>>        Object Witemx_DD is a Witemx_DataDictionary
42676>>>>>>>>>>>>>>>
42676>>>>>>>>>>>>>>>            //AB-StoreTopStart
42676>>>>>>>>>>>>>>>            Function fiPeriexei Returns Integer
42678>>>>>>>>>>>>>>>                       String lsperi lscode  lscodekat
42679>>>>>>>>>>>>>>>                       Integer rVal liContains_Or_Starts
42679>>>>>>>>>>>>>>>                       Move 0 to rVal
42680>>>>>>>>>>>>>>>                       Get piContains_Or_Starts to liContains_Or_Starts
42681>>>>>>>>>>>>>>>                       Get psperi to lsperi
42682>>>>>>>>>>>>>>>                       Get pscode to lscode
42683>>>>>>>>>>>>>>>                       Get pscodekat to lscodekat
42684>>>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
42685>>>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
42686>>>>>>>>>>>>>>>                       If (liContains_Or_Starts=0) Begin
42688>>>>>>>>>>>>>>>                           If ((Trim(witemx.witemx_descr)) Contains lsperi) Begin
42690>>>>>>>>>>>>>>>                               If ((Trim(witemx.witemx_code)) Contains lscode) Move 1 to rVal
42693>>>>>>>>>>>>>>>                           End
42693>>>>>>>>>>>>>>>>
42693>>>>>>>>>>>>>>>                       End
42693>>>>>>>>>>>>>>>>
42693>>>>>>>>>>>>>>>                       Else Begin
42694>>>>>>>>>>>>>>>                           If (Left(witemx.witemx_descr,(Length(lsperi)))=lsperi) Begin
42696>>>>>>>>>>>>>>>                               If (Left(witemx.witemx_code,(Length(lscode)))=lscode) Move 1 to rVal
42699>>>>>>>>>>>>>>>                           End
42699>>>>>>>>>>>>>>>>
42699>>>>>>>>>>>>>>>                       End
42699>>>>>>>>>>>>>>>>
42699>>>>>>>>>>>>>>>                       Function_Return rVal
42700>>>>>>>>>>>>>>>                   End_Function
42701>>>>>>>>>>>>>>>            
42701>>>>>>>>>>>>>>>                   Function fiArxizeiperi Returns Integer
42703>>>>>>>>>>>>>>>                       String lsperi
42704>>>>>>>>>>>>>>>                       Get psperi to lsperi
42705>>>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
42706>>>>>>>>>>>>>>>                       Function_Return (Left(witemx.witemx_descr,(Length(lsperi)))=lsperi)
42707>>>>>>>>>>>>>>>                   End_Function
42708>>>>>>>>>>>>>>>            
42708>>>>>>>>>>>>>>>                   Function fiArxizeicode Returns Integer
42710>>>>>>>>>>>>>>>                       String lscode lscodekat
42711>>>>>>>>>>>>>>>                       Get pscode to lscode
42712>>>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
42713>>>>>>>>>>>>>>>                       Function_Return (Left(witemx.witemx_code,(Length(lscode)))=lscode)
42714>>>>>>>>>>>>>>>                   End_Function
42715>>>>>>>>>>>>>>>            //AB-StoreTopEnd
42715>>>>>>>>>>>>>>>
42715>>>>>>>>>>>>>>>            Set DDO_Server to (Item_DD(self))
42716>>>>>>>>>>>>>>>
42716>>>>>>>>>>>>>>>            //AB-StoreStart
42716>>>>>>>>>>>>>>>                                                                                
42716>>>>>>>>>>>>>>>            Begin_Constraints
42718>>>>>>>>>>>>>>>               String lsperi lscode lsvalue lstype lscodekat
42719>>>>>>>>>>>>>>>               Integer liContains_Or_Starts
42719>>>>>>>>>>>>>>>               Get psperi               to lsperi
42720>>>>>>>>>>>>>>>               Get pscode               to lscode
42721>>>>>>>>>>>>>>>               Get pscodekat            to lscodekat
42722>>>>>>>>>>>>>>>               Get piContains_Or_Starts to liContains_Or_Starts
42723>>>>>>>>>>>>>>>               Move (Trim(lsperi))      to lsperi
42724>>>>>>>>>>>>>>>               Move (Trim(lscode))      to lscode
42725>>>>>>>>>>>>>>>               Move (Trim(lscodekat))   to lscodekat
42726>>>>>>>>>>>>>>>               Set Ordering to 4
42727>>>>>>>>>>>>>>>               If ((lsperi<>'') and (lscode<>'')) Begin
42729>>>>>>>>>>>>>>>                    Set Ordering to 4
42730>>>>>>>>>>>>>>>                    Constrain witemx as (fiPeriexei(Self)=1)
42731>>>>>>>>>>>>>>>               End
42731>>>>>>>>>>>>>>>>
42731>>>>>>>>>>>>>>>               Else Begin
42732>>>>>>>>>>>>>>>                  If (liContains_Or_Starts=0) Begin
42734>>>>>>>>>>>>>>>                        If (lsperi<>'') Begin
42736>>>>>>>>>>>>>>>                            Set Ordering to 3
42737>>>>>>>>>>>>>>>                            Constrain witemx.witemx_descr Contains lsperi
42739>>>>>>>>>>>>>>>                        End
42739>>>>>>>>>>>>>>>>
42739>>>>>>>>>>>>>>>                        Else If (lscode<>'') Begin
42742>>>>>>>>>>>>>>>                            Set Ordering to 4
42743>>>>>>>>>>>>>>>                            Constrain witemx.witemx_code Contains lscode
42745>>>>>>>>>>>>>>>                        End
42745>>>>>>>>>>>>>>>>
42745>>>>>>>>>>>>>>>                  End
42745>>>>>>>>>>>>>>>>
42745>>>>>>>>>>>>>>>                  Else Begin
42746>>>>>>>>>>>>>>>                        If (lsperi<>'') Begin
42748>>>>>>>>>>>>>>>                            Set Ordering to 3
42749>>>>>>>>>>>>>>>                            Constrain witemx as (fiArxizeiperi(Self)=1) //witemx.witemx_descr
42750>>>>>>>>>>>>>>>                        End
42750>>>>>>>>>>>>>>>>
42750>>>>>>>>>>>>>>>                        Else If (lscode<>'') Begin
42753>>>>>>>>>>>>>>>                            Set Ordering to 4
42754>>>>>>>>>>>>>>>                            Constrain witemx as (fiArxizeicode(Self)=1) //witemx.witemx_code
42755>>>>>>>>>>>>>>>                        End
42755>>>>>>>>>>>>>>>>
42755>>>>>>>>>>>>>>>                  End
42755>>>>>>>>>>>>>>>>
42755>>>>>>>>>>>>>>>                  If (lscodekat<>'') Begin
42757>>>>>>>>>>>>>>>                        Constrain witemx.witemkat_code Contains lscodekat
42759>>>>>>>>>>>>>>>                  End
42759>>>>>>>>>>>>>>>>
42759>>>>>>>>>>>>>>>               End
42759>>>>>>>>>>>>>>>>
42759>>>>>>>>>>>>>>>            End_Constraints
42762>>>>>>>>>>>>>>>            
42762>>>>>>>>>>>>>>>            
42762>>>>>>>>>>>>>>>            //AB-StoreEnd
42762>>>>>>>>>>>>>>>
42762>>>>>>>>>>>>>>>        End_Object    // Witemx_DD
42763>>>>>>>>>>>>>>>
42763>>>>>>>>>>>>>>>        Set Main_DD to (Witemx_DD(self))
42764>>>>>>>>>>>>>>>        Set Server to (Witemx_DD(self))
42765>>>>>>>>>>>>>>>
42765>>>>>>>>>>>>>>>        //AB-DDOEnd
42765>>>>>>>>>>>>>>>
42765>>>>>>>>>>>>>>>        Object oSelList is a dbListSub
42767>>>>>>>>>>>>>>>            Set Main_File to Witemx.File_Number
42768>>>>>>>>>>>>>>>            Set Ordering to 5
42769>>>>>>>>>>>>>>>            Set Size to 190 475
42770>>>>>>>>>>>>>>>            Set Location to 1 1
42771>>>>>>>>>>>>>>>            Set Color to 14280447
42772>>>>>>>>>>>>>>>            Set CurrentRowColor to 11783679
42773>>>>>>>>>>>>>>>            Set CurrentCellColor to 11783679
42774>>>>>>>>>>>>>>>            Set Auto_Index_State to FALSE
42775>>>>>>>>>>>>>>>
42775>>>>>>>>>>>>>>>            Begin_Row
42778>>>>>>>>>>>>>>>                Entry_Item Witemx.Witemx_code
42779>>>>>>>>>>>>>>>                Entry_Item Witemx.Witemx_descr
42780>>>>>>>>>>>>>>>                Entry_Item Witemx.Witemkat_code
42781>>>>>>>>>>>>>>>                Entry_Item Witemkat.Witemkat_descr
42782>>>>>>>>>>>>>>>                Entry_Item Item.Item_qual
42783>>>>>>>>>>>>>>>                Entry_Item Fpa.Fpa_pososto
42784>>>>>>>>>>>>>>>            End_Row
42789>>>>>>>>>>>>>>>
42789>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 60
42790>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à›. „å›¦¬ª"
42791>>>>>>>>>>>>>>>            
42791>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 140
42792>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
42793>>>>>>>>>>>>>>>            
42793>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 70
42794>>>>>>>>>>>>>>>            Set Header_Label  item 2 to "‰à›. ‰˜«žš¦¨å˜ª"
42795>>>>>>>>>>>>>>>            
42795>>>>>>>>>>>>>>>            Set Form_Width    item 3 to 88
42796>>>>>>>>>>>>>>>            Set Header_Label  item 3 to "œ¨ š¨˜­ã ‰˜«žš."
42797>>>>>>>>>>>>>>>            
42797>>>>>>>>>>>>>>>            Set Form_Width    item 4 to 64
42798>>>>>>>>>>>>>>>            Set Header_Label  item 4 to "¦ æ«ž«˜"
42799>>>>>>>>>>>>>>>            
42799>>>>>>>>>>>>>>>            Set Form_Width    item 5 to 45
42800>>>>>>>>>>>>>>>            Set Header_Label  item 5 to "‰˜«.”..€"
42801>>>>>>>>>>>>>>>            
42801>>>>>>>>>>>>>>>
42801>>>>>>>>>>>>>>>            //AB-StoreStart
42801>>>>>>>>>>>>>>>            Property String Store_Fragma_Items public ""
42803>>>>>>>>>>>>>>>            set export_item_state to true
42804>>>>>>>>>>>>>>>            
42804>>>>>>>>>>>>>>>            Procedure End_Construct_Object
42806>>>>>>>>>>>>>>>                Forward Send End_Construct_Object
42808>>>>>>>>>>>>>>>                Set Color               to 14280447
42809>>>>>>>>>>>>>>>                Set CurrentRowColor     to 11783679
42810>>>>>>>>>>>>>>>                Set CurrentCellColor    to 11783679
42811>>>>>>>>>>>>>>>            End_Procedure
42812>>>>>>>>>>>>>>>            
42812>>>>>>>>>>>>>>>            Procedure Activating Returns Integer
42814>>>>>>>>>>>>>>>                Integer rVal
42815>>>>>>>>>>>>>>>                Forward Get Msg_Activating to rVal
42817>>>>>>>>>>>>>>>                set auto_index_state to true
42818>>>>>>>>>>>>>>>                Procedure_Return rVal
42819>>>>>>>>>>>>>>>            End_Procedure
42820>>>>>>>>>>>>>>>            
42820>>>>>>>>>>>>>>>            procedure move_value_out
42822>>>>>>>>>>>>>>>                forward send move_value_out
42824>>>>>>>>>>>>>>>                set value of (ocode(self)) to ''
42825>>>>>>>>>>>>>>>                set value of (operi(self)) to ''
42826>>>>>>>>>>>>>>>                set value of (ocodekat(self)) to ''
42827>>>>>>>>>>>>>>>                set psperi to ''
42828>>>>>>>>>>>>>>>                set pscode to ''
42829>>>>>>>>>>>>>>>                set pscodekat to ''
42830>>>>>>>>>>>>>>>            end_procedure
42831>>>>>>>>>>>>>>>            
42831>>>>>>>>>>>>>>>            
42831>>>>>>>>>>>>>>>            
42831>>>>>>>>>>>>>>>            
42831>>>>>>>>>>>>>>>            
42831>>>>>>>>>>>>>>>            
42831>>>>>>>>>>>>>>>            
42831>>>>>>>>>>>>>>>            
42831>>>>>>>>>>>>>>>            
42831>>>>>>>>>>>>>>>            //AB-StoreEnd
42831>>>>>>>>>>>>>>>
42831>>>>>>>>>>>>>>>        End_Object    // oSelList
42832>>>>>>>>>>>>>>>
42832>>>>>>>>>>>>>>>        Object TextBoxSub1 is a TextBoxSub
42834>>>>>>>>>>>>>>>            Set Label to "‘á¨à©ž ¡à› ¡¦ç š ˜"
42835>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
42836>>>>>>>>>>>>>>>            Set Location to 192 6
42837>>>>>>>>>>>>>>>            Set Size to 13 69
42838>>>>>>>>>>>>>>>        End_Object    // TextBoxSub1
42839>>>>>>>>>>>>>>>
42839>>>>>>>>>>>>>>>        Object ocode is a FormSub
42841>>>>>>>>>>>>>>>            Set Size to 13 197
42842>>>>>>>>>>>>>>>            Set Location to 192 79
42843>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
42844>>>>>>>>>>>>>>>
42844>>>>>>>>>>>>>>>            //AB-StoreStart
42844>>>>>>>>>>>>>>>            
42844>>>>>>>>>>>>>>>            
42844>>>>>>>>>>>>>>>            
42844>>>>>>>>>>>>>>>            
42844>>>>>>>>>>>>>>>            
42844>>>>>>>>>>>>>>>            
42844>>>>>>>>>>>>>>>            
42844>>>>>>>>>>>>>>>            
42844>>>>>>>>>>>>>>>            //AB-StoreEnd
42844>>>>>>>>>>>>>>>
42844>>>>>>>>>>>>>>>        End_Object    // ocode
42845>>>>>>>>>>>>>>>
42845>>>>>>>>>>>>>>>        Object TextBoxSub2 is a TextBoxSub
42847>>>>>>>>>>>>>>>            Set Label to "‘á¨à©ž §œ¨ š¨˜­ãª "
42848>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
42849>>>>>>>>>>>>>>>            Set Location to 207 6
42850>>>>>>>>>>>>>>>            Set Size to 13 71
42851>>>>>>>>>>>>>>>        End_Object    // TextBoxSub2
42852>>>>>>>>>>>>>>>
42852>>>>>>>>>>>>>>>        Object operi is a FormSub
42854>>>>>>>>>>>>>>>            Set Size to 13 197
42855>>>>>>>>>>>>>>>            Set Location to 207 79
42856>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
42857>>>>>>>>>>>>>>>
42857>>>>>>>>>>>>>>>            //AB-StoreStart
42857>>>>>>>>>>>>>>>            
42857>>>>>>>>>>>>>>>            
42857>>>>>>>>>>>>>>>            
42857>>>>>>>>>>>>>>>            
42857>>>>>>>>>>>>>>>            
42857>>>>>>>>>>>>>>>            
42857>>>>>>>>>>>>>>>            
42857>>>>>>>>>>>>>>>            //AB-StoreEnd
42857>>>>>>>>>>>>>>>
42857>>>>>>>>>>>>>>>        End_Object    // operi
42858>>>>>>>>>>>>>>>
42858>>>>>>>>>>>>>>>        Object RadioGroupSub1 is a RadioGroupSub
42860>>>>>>>>>>>>>>>            Set Size to 32 77
42861>>>>>>>>>>>>>>>            Set Location to 191 279
42862>>>>>>>>>>>>>>>            Object Radio1 is a RadioSub
42864>>>>>>>>>>>>>>>                Set Label to "œ¨ â®œ«˜ "
42865>>>>>>>>>>>>>>>                Set Size to 10 53
42866>>>>>>>>>>>>>>>                Set Location to 7 5
42867>>>>>>>>>>>>>>>            End_Object    // Radio1
42868>>>>>>>>>>>>>>>
42868>>>>>>>>>>>>>>>            Object Radio2 is a RadioSub
42870>>>>>>>>>>>>>>>                Set Label to "€¨®åœ  €§¦"
42871>>>>>>>>>>>>>>>                Set Size to 10 52
42872>>>>>>>>>>>>>>>                Set Location to 21 5
42873>>>>>>>>>>>>>>>            End_Object    // Radio2
42874>>>>>>>>>>>>>>>
42874>>>>>>>>>>>>>>>
42874>>>>>>>>>>>>>>>            //AB-StoreStart
42874>>>>>>>>>>>>>>>            
42874>>>>>>>>>>>>>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
42876>>>>>>>>>>>>>>>                Set piContains_Or_Starts to iToItem
42877>>>>>>>>>>>>>>>            End_Procedure
42878>>>>>>>>>>>>>>>            
42878>>>>>>>>>>>>>>>            
42878>>>>>>>>>>>>>>>            
42878>>>>>>>>>>>>>>>            
42878>>>>>>>>>>>>>>>            
42878>>>>>>>>>>>>>>>            //AB-StoreEnd
42878>>>>>>>>>>>>>>>
42878>>>>>>>>>>>>>>>        End_Object    // RadioGroupSub1
42879>>>>>>>>>>>>>>>
42879>>>>>>>>>>>>>>>        Object ButtonSub1 is a ButtonSub
42881>>>>>>>>>>>>>>>            Set Label to "œ¨ æ¨ ©œ"
42882>>>>>>>>>>>>>>>            Set Size to 15 197
42883>>>>>>>>>>>>>>>            Set Location to 236 79
42884>>>>>>>>>>>>>>>            Set Form_FontWeight Item 0 to 800
42885>>>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "ms sans serif"
42886>>>>>>>>>>>>>>>
42886>>>>>>>>>>>>>>>            //AB-StoreStart
42886>>>>>>>>>>>>>>>            
42886>>>>>>>>>>>>>>>            Procedure OnClick
42888>>>>>>>>>>>>>>>                Forward Send OnClick
42890>>>>>>>>>>>>>>>                Set pscode      to (Value(ocode(Self),0))
42891>>>>>>>>>>>>>>>                Set psperi      to (Value(operi(Self),0))
42892>>>>>>>>>>>>>>>                Set pscodekat   to (Value(ocodekat(Self),0))
42893>>>>>>>>>>>>>>>                send Rebuild_Constraints    to (witemx_DD(Self))
42894>>>>>>>>>>>>>>>                Send Beginning_Of_Data      to oSelList True
42895>>>>>>>>>>>>>>>            End_Procedure // OnClick
42896>>>>>>>>>>>>>>>            
42896>>>>>>>>>>>>>>>            
42896>>>>>>>>>>>>>>>            //AB-StoreEnd
42896>>>>>>>>>>>>>>>
42896>>>>>>>>>>>>>>>        End_Object    // ButtonSub1
42897>>>>>>>>>>>>>>>
42897>>>>>>>>>>>>>>>        Object TextBoxSub3 is a TextBoxSub
42899>>>>>>>>>>>>>>>            Set Label to "‰à›. ¡˜«žš¦¨å˜ª š ˜"
42900>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
42901>>>>>>>>>>>>>>>            Set Location to 221 5
42902>>>>>>>>>>>>>>>            Set Size to 13 70
42903>>>>>>>>>>>>>>>        End_Object    // TextBoxSub3
42904>>>>>>>>>>>>>>>
42904>>>>>>>>>>>>>>>        Object ocodekat is a FormSub
42906>>>>>>>>>>>>>>>            Set Size to 13 197
42907>>>>>>>>>>>>>>>            Set Location to 221 79
42908>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
42909>>>>>>>>>>>>>>>
42909>>>>>>>>>>>>>>>            //AB-StoreStart
42909>>>>>>>>>>>>>>>            
42909>>>>>>>>>>>>>>>            
42909>>>>>>>>>>>>>>>            
42909>>>>>>>>>>>>>>>            
42909>>>>>>>>>>>>>>>            
42909>>>>>>>>>>>>>>>            
42909>>>>>>>>>>>>>>>            
42909>>>>>>>>>>>>>>>            //AB-StoreEnd
42909>>>>>>>>>>>>>>>
42909>>>>>>>>>>>>>>>        End_Object    // ocodekat
42910>>>>>>>>>>>>>>>
42910>>>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
42912>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
42913>>>>>>>>>>>>>>>            Set Location to 232 318
42914>>>>>>>>>>>>>>>
42914>>>>>>>>>>>>>>>            //AB-StoreStart
42914>>>>>>>>>>>>>>>            Procedure OnClick
42916>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
42917>>>>>>>>>>>>>>>            End_Procedure
42918>>>>>>>>>>>>>>>            //AB-StoreEnd
42918>>>>>>>>>>>>>>>
42918>>>>>>>>>>>>>>>        End_Object    // oOK_bn
42919>>>>>>>>>>>>>>>
42919>>>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
42921>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
42922>>>>>>>>>>>>>>>            Set Location to 232 373
42923>>>>>>>>>>>>>>>
42923>>>>>>>>>>>>>>>            //AB-StoreStart
42923>>>>>>>>>>>>>>>            Procedure OnClick
42925>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
42926>>>>>>>>>>>>>>>            End_Procedure
42927>>>>>>>>>>>>>>>            //AB-StoreEnd
42927>>>>>>>>>>>>>>>
42927>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
42928>>>>>>>>>>>>>>>
42928>>>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
42930>>>>>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
42931>>>>>>>>>>>>>>>            Set Location to 232 428
42932>>>>>>>>>>>>>>>
42932>>>>>>>>>>>>>>>            //AB-StoreStart
42932>>>>>>>>>>>>>>>            Procedure OnClick
42934>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
42935>>>>>>>>>>>>>>>            End_Procedure
42936>>>>>>>>>>>>>>>            //AB-StoreEnd
42936>>>>>>>>>>>>>>>
42936>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
42937>>>>>>>>>>>>>>>
42937>>>>>>>>>>>>>>>        Object btnwitemcl is a ButtonSub
42939>>>>>>>>>>>>>>>
42939>>>>>>>>>>>>>>>            //AB-StoreTopStart
42939>>>>>>>>>>>>>>>            
42939>>>>>>>>>>>>>>>            //AB-StoreTopEnd
42939>>>>>>>>>>>>>>>
42939>>>>>>>>>>>>>>>            Set Label to "ButtonSub1"
42940>>>>>>>>>>>>>>>            Set Bitmap to "Filesys3.bmp"
42941>>>>>>>>>>>>>>>            Set Size to 22 25
42942>>>>>>>>>>>>>>>            Set Location to 196 443
42943>>>>>>>>>>>>>>>            Set Focus_Mode to Pointer_Only
42944>>>>>>>>>>>>>>>
42944>>>>>>>>>>>>>>>            //AB-StoreStart
42944>>>>>>>>>>>>>>>            
42944>>>>>>>>>>>>>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«¦ œ¬¨œ«ã¨ ¦ „ ›é¤ / ¨¦£žŸœ¬«ã"
42945>>>>>>>>>>>>>>>            
42945>>>>>>>>>>>>>>>            Procedure OnClick
42947>>>>>>>>>>>>>>>                String  scode speri
42948>>>>>>>>>>>>>>>                Get value of (ocode(self)) to scode
42949>>>>>>>>>>>>>>>                Get value of (operi(self)) to speri
42950>>>>>>>>>>>>>>>                set pscode of (dg186(self)) to scode
42951>>>>>>>>>>>>>>>                set psperi of (dg186(self)) to speri
42952>>>>>>>>>>>>>>>               Send popup_modal to (dg186(self))
42953>>>>>>>>>>>>>>>            End_Procedure // OnClick
42954>>>>>>>>>>>>>>>            
42954>>>>>>>>>>>>>>>            
42954>>>>>>>>>>>>>>>            
42954>>>>>>>>>>>>>>>            
42954>>>>>>>>>>>>>>>            
42954>>>>>>>>>>>>>>>            
42954>>>>>>>>>>>>>>>            
42954>>>>>>>>>>>>>>>            
42954>>>>>>>>>>>>>>>            
42954>>>>>>>>>>>>>>>            
42954>>>>>>>>>>>>>>>            
42954>>>>>>>>>>>>>>>            
42954>>>>>>>>>>>>>>>            
42954>>>>>>>>>>>>>>>            
42954>>>>>>>>>>>>>>>            
42954>>>>>>>>>>>>>>>            
42954>>>>>>>>>>>>>>>            
42954>>>>>>>>>>>>>>>            
42954>>>>>>>>>>>>>>>            
42954>>>>>>>>>>>>>>>            
42954>>>>>>>>>>>>>>>            
42954>>>>>>>>>>>>>>>            
42954>>>>>>>>>>>>>>>            
42954>>>>>>>>>>>>>>>            //AB-StoreEnd
42954>>>>>>>>>>>>>>>
42954>>>>>>>>>>>>>>>        End_Object    // btnwitemcl
42955>>>>>>>>>>>>>>>
42955>>>>>>>>>>>>>>>
42955>>>>>>>>>>>>>>>        //AB-StoreStart
42955>>>>>>>>>>>>>>>                
42955>>>>>>>>>>>>>>>        Set Locate_Mode to Center_On_Screen
42956>>>>>>>>>>>>>>>        
42956>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
42957>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
42958>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
42959>>>>>>>>>>>>>>>        
42959>>>>>>>>>>>>>>>        Procedure Activate
42961>>>>>>>>>>>>>>>            Send Rebuild_Constraints    to Witemx_DD
42962>>>>>>>>>>>>>>>            Send Beginning_Of_Data      to oSelList True
42963>>>>>>>>>>>>>>>            Forward Send Activate
42965>>>>>>>>>>>>>>>        End_Procedure
42966>>>>>>>>>>>>>>>        
42966>>>>>>>>>>>>>>>        procedure request_cancel
42968>>>>>>>>>>>>>>>            forward send request_cancel
42970>>>>>>>>>>>>>>>            set value of (ocode(self)) to ''
42971>>>>>>>>>>>>>>>            set value of (operi(self)) to ''
42972>>>>>>>>>>>>>>>            set value of (ocodekat(self)) to ''
42973>>>>>>>>>>>>>>>            Set psperi  to ''
42974>>>>>>>>>>>>>>>            Set pscode  to ''
42975>>>>>>>>>>>>>>>            Set pscodekat TO ''
42976>>>>>>>>>>>>>>>        end_procedure
42977>>>>>>>>>>>>>>>        
42977>>>>>>>>>>>>>>>        
42977>>>>>>>>>>>>>>>        
42977>>>>>>>>>>>>>>>        
42977>>>>>>>>>>>>>>>        
42977>>>>>>>>>>>>>>>        
42977>>>>>>>>>>>>>>>        
42977>>>>>>>>>>>>>>>        
42977>>>>>>>>>>>>>>>        
42977>>>>>>>>>>>>>>>        //AB-StoreEnd
42977>>>>>>>>>>>>>>>
42977>>>>>>>>>>>>>>>    End_Object    // SL17
42978>>>>>>>>>>>>>>>
42978>>>>>>>>>>>>>>>
42978>>>>>>>>>>>>>>>    //AB-StoreStart
42978>>>>>>>>>>>>>>>    
42978>>>>>>>>>>>>>>>    
42978>>>>>>>>>>>>>>>    
42978>>>>>>>>>>>>>>>    
42978>>>>>>>>>>>>>>>    
42978>>>>>>>>>>>>>>>    
42978>>>>>>>>>>>>>>>    
42978>>>>>>>>>>>>>>>    
42978>>>>>>>>>>>>>>>    
42978>>>>>>>>>>>>>>>    
42978>>>>>>>>>>>>>>>    
42978>>>>>>>>>>>>>>>    
42978>>>>>>>>>>>>>>>    //AB-StoreEnd
42978>>>>>>>>>>>>>>>
42978>>>>>>>>>>>>>>>//AB/     End_Object    // prj
42978>>>>>>>>>>>>>
42978>>>>>>>>>>>>>//DDB-Selection-pkg-End
42978>>>>>>>>>>>>>//DDB-FileEnd
42978>>>>>>>>>>>    Use PMOVES.DD
INCLUDING FILE: PMOVES.DD
42978>>>>>>>>>>>>>//DDB-FileStart
42978>>>>>>>>>>>>>//DDB-HeaderStart
42978>>>>>>>>>>>>>
42978>>>>>>>>>>>>>// File Name : PMOVES.DD
42978>>>>>>>>>>>>>// Class Name: Pmoves_DataDictionary
42978>>>>>>>>>>>>>// Revision  : 135
42978>>>>>>>>>>>>>// Version   : 2
42978>>>>>>>>>>>>>
42978>>>>>>>>>>>>>Use  Windows           // Basic Definitions
42978>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
42978>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
42978>>>>>>>>>>>>>
42978>>>>>>>>>>>>>Open Pmoves
42980>>>>>>>>>>>>>Open Pmsdtl
INCLUDING FILE: PMSDTL.FD
42982>>>>>>>>>>>>>Open Pmssxet
42984>>>>>>>>>>>>>Open Wax
42986>>>>>>>>>>>>>Open Witemx
42988>>>>>>>>>>>>>Open Particle
42990>>>>>>>>>>>>>Open Sysrecp
42992>>>>>>>>>>>>>Open Syscurxr
42994>>>>>>>>>>>>>Open Partlfpa
42996>>>>>>>>>>>>>Open Clorder
42998>>>>>>>>>>>>>Open Clorderd
43000>>>>>>>>>>>>>Open Btnemp
INCLUDING FILE: BTNEMP.FD
43002>>>>>>>>>>>>>
43002>>>>>>>>>>>>>//DDB-HeaderEnd
43002>>>>>>>>>>>>>Open Fpa
43004>>>>>>>>>>>>>Open PartlFpa 
43006>>>>>>>>>>>>>Open Item
43008>>>>>>>>>>>>>Open Wtypkin
43010>>>>>>>>>>>>>Open Witemkat
43012>>>>>>>>>>>>>Open Wapomast     
43014>>>>>>>>>>>>>Open Wapokat
43016>>>>>>>>>>>>>Open Payresp
43018>>>>>>>>>>>>>
43018>>>>>>>>>>>>>Class Pmoves_DataDictionary  is a DataDictionary_Sec
43019>>>>>>>>>>>>>
43019>>>>>>>>>>>>>    // Delete_Main_File:
43019>>>>>>>>>>>>>
43019>>>>>>>>>>>>>    Procedure Delete_Main_File
43020>>>>>>>>>>>>>        clear btnemp
43021>>>>>>>>>>>>>        move pmoves.pms_recr to btnemp.pms_recr
43022>>>>>>>>>>>>>        find ge btnemp by index.11
43023>>>>>>>>>>>>>>
43023>>>>>>>>>>>>>        if ((found=1) and (pmoves.pms_recr=btnemp.pms_recr)) begin
43025>>>>>>>>>>>>>           move 0 to btnemp.pms_recr
43026>>>>>>>>>>>>>           saverecord btnemp
43027>>>>>>>>>>>>>        end
43027>>>>>>>>>>>>>>
43027>>>>>>>>>>>>>        Forward Send Delete_Main_File
43029>>>>>>>>>>>>>        // Insert Code Here
43029>>>>>>>>>>>>>    End_Procedure   // Delete_Main_File
43030>>>>>>>>>>>>>
43030>>>>>>>>>>>>>
43030>>>>>>>>>>>>>    Procedure Construct_Object
43031>>>>>>>>>>>>>        Forward Send Construct_Object
43033>>>>>>>>>>>>>        Property Number  pnoQty         Public  0
43034>>>>>>>>>>>>>        Property integer pifromclorder  Public  0
43035>>>>>>>>>>>>>        Property Integer piCheckZeroFpa Public  0
43036>>>>>>>>>>>>>        Property Integer piPmsSxetID    Public  0
43037>>>>>>>>>>>>>        Property integer piFromMetasx   Public  0
43038>>>>>>>>>>>>>    End_Procedure
43039>>>>>>>>>>>>>
43039>>>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
43040>>>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
43042>>>>>>>>>>>>>        Set pnoQty      to Pmoves.Pms_Qty
43043>>>>>>>>>>>>>    End_Procedure   // New_Current_Record
43044>>>>>>>>>>>>>
43044>>>>>>>>>>>>>    Procedure Save_Main_File
43045>>>>>>>>>>>>>        Integer iYes
43046>>>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
43048>>>>>>>>>>>>>            If Pmoves.Recnum Eq 0 Procedure_Return
43051>>>>>>>>>>>>>        End
43051>>>>>>>>>>>>>>
43051>>>>>>>>>>>>>
43051>>>>>>>>>>>>>        If ((Operation_Origin=Self) And (piCheckZeroFpa(Self))) Begin
43053>>>>>>>>>>>>>            // Elegxos FPA
43053>>>>>>>>>>>>>            // An typonei otidhpote ektos apo 1 (mono Posothtes)
43053>>>>>>>>>>>>>            If ((Ptyppar.Ti_Typonei_Pms<>'1')   And ;                (Pmoves.Pms_Vatam=0)            And ;                (Operation_Mode<>MODE_DELETING)) Begin
43055>>>>>>>>>>>>>                Move (YesNo_Box("¦©æ ”€ £ž›œ¤ ¡æ. Œ˜ ©¬¤œ®å©à ;", ;                                     "¨¦©¦®ã",  MB_DEFBUTTON2) ) to iYes
43056>>>>>>>>>>>>>                If (iYes=MBR_NO)  Send Operation_Not_Allowed 8000
43059>>>>>>>>>>>>>            End
43059>>>>>>>>>>>>>>
43059>>>>>>>>>>>>>        End
43059>>>>>>>>>>>>>>
43059>>>>>>>>>>>>>        Forward Send Save_Main_File
43061>>>>>>>>>>>>>    End_Procedure
43062>>>>>>>>>>>>>
43062>>>>>>>>>>>>>    Function fnTeleytaiaTimh Returns Number
43063>>>>>>>>>>>>>        Number  rVal nQty
43064>>>>>>>>>>>>>        String  sClientID sWitemxCode
43064>>>>>>>>>>>>>        Date    dHmnia
43064>>>>>>>>>>>>>        String  sWhat sRecr sClientCode sItemCode sCN
43064>>>>>>>>>>>>>
43064>>>>>>>>>>>>>        Get File_Field_Current_Value File_Field Ptyppar.Ptyppar_Is_What to sWhat
43065>>>>>>>>>>>>>        If (Trim(sWhat)='1') Begin
43067>>>>>>>>>>>>>            // 1=€š¦¨œª
43067>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Witemx.Witemx_Recr      to sRecr
43068>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Pms_Qty          to nQty
43069>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_Hmnia    to dHmnia
43070>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Item.Item_Code          to sItemCode
43071>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Clients.Client_ID       to sClientCode
43072>>>>>>>>>>>>>            // Sto arxeio Globals.inc
43072>>>>>>>>>>>>>            Get fnTeleytaiaTimhAgoras sClientCode sItemCode dHmnia nQty to rVal
43073>>>>>>>>>>>>>        End
43073>>>>>>>>>>>>>>
43073>>>>>>>>>>>>>        Else If (Trim(sWhat)='2') Begin
43076>>>>>>>>>>>>>            // 2=à¢ã©œ ª
43076>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Pms_Qty          to nQty
43077>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Item.Item_Code          to sItemCode
43078>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_Hmnia    to dHmnia
43079>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Cn_Code        to sCN
43080>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Witemx.Witemx_Recr      to sRecr
43081>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Clients.Client_ID       to sClientID
43082>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Witemx.Witemx_Code      to sWitemxCode
43083>>>>>>>>>>>>>            // Sto arxeio Globals.inc
43083>>>>>>>>>>>>>            Get fnTeleytaiaTimhPolhshs sRecr sClientID sWitemxCode dHmnia sItemCode nQty sCN to rVal
43084>>>>>>>>>>>>>        End
43084>>>>>>>>>>>>>>
43084>>>>>>>>>>>>>        Function_Return rVal
43085>>>>>>>>>>>>>    End_Function
43086>>>>>>>>>>>>>
43086>>>>>>>>>>>>>    Procedure Creating
43087>>>>>>>>>>>>>        Forward Send Creating
43089>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Pmoves.Pms_Rec0)))))) to Pmoves.Pms_Recr
43090>>>>>>>>>>>>>    End_Procedure   // Creating
43091>>>>>>>>>>>>>
43091>>>>>>>>>>>>>    Procedure Update
43092>>>>>>>>>>>>>        Integer iDecimals
43093>>>>>>>>>>>>>        Number  nInt
43093>>>>>>>>>>>>>        String  sCurrentUser
43093>>>>>>>>>>>>>
43093>>>>>>>>>>>>>        Forward Send Update
43095>>>>>>>>>>>>>
43095>>>>>>>>>>>>>        Move SysCurXR.Company_Code                          to Pmoves.Company_Code
43096>>>>>>>>>>>>>        Move SysCurXR.Branch_Code                           to Pmoves.Branch_Code
43097>>>>>>>>>>>>>        Move SysCurXR.Year_Year                             to Pmoves.Year_Year
43098>>>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code                           to Pmoves.Ctypkin_Code
43099>>>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code                           to Pmoves.Wtypkin_Code
43100>>>>>>>>>>>>>
43100>>>>>>>>>>>>>        Move Witemkat.Witemkat_Code                         to Pmoves.Witemkat_Code
43101>>>>>>>>>>>>>        Move Item.Item_Code                                 to Pmoves.Item_Code
43102>>>>>>>>>>>>>        Move Witemx.Witemx_Code                             to Pmoves.Witemx_Code
43103>>>>>>>>>>>>>        Move Wapokat.Wapokat_Code                           to Pmoves.Wapokat_Code
43104>>>>>>>>>>>>>        Move Wapomast.Wapomast_Code                         to Pmoves.Wapomast_Code
43105>>>>>>>>>>>>>        Move Wax.Wax_Code                                   to Pmoves.Wax_Code
43106>>>>>>>>>>>>>
43106>>>>>>>>>>>>>        //Move Custprom.Custprom_Code                         to Pmoves.Custprom_Code
43106>>>>>>>>>>>>>        Move Clients.Client_ID                              to Pmoves.Client_ID
43107>>>>>>>>>>>>>        Move Ptyppar.Ptyppar_Code                           to Pmoves.Ptyppar_Code
43108>>>>>>>>>>>>>        Move Ptyppar.TI_TYPONEI_PMS                         to Pmoves.TI_TYPONEI_PMS
43109>>>>>>>>>>>>>        Move Particle.PSeira_Seira                          to Pmoves.Pseira_Seira
43110>>>>>>>>>>>>>
43110>>>>>>>>>>>>>        Move Nomisma.Nomisma_Code                           to Pmoves.Pms_Sc_Code2
43111>>>>>>>>>>>>>        Move Nomisma.Dekadika                               To iDecimals
43112>>>>>>>>>>>>>
43112>>>>>>>>>>>>>        Move Particle.CN_Code                               to Pmoves.CN_Code
43113>>>>>>>>>>>>>        Move Particle.Partl_No                              to Pmoves.Partl_No
43114>>>>>>>>>>>>>        Move Particle.Partl_Hmnia                           to Pmoves.Partl_Hmnia
43115>>>>>>>>>>>>>        Move Particle.Partl_Module                          to Pmoves.Pms_Module
43116>>>>>>>>>>>>>        Move Particle.Partl_Rec0                            to Pmoves.Partl_Rec0
43117>>>>>>>>>>>>>
43117>>>>>>>>>>>>>        Move Particle.Sls_ID                                to Pmoves.Sls_ID
43118>>>>>>>>>>>>>        Move Particle.Presp_ID                              to Pmoves.Presp_ID
43119>>>>>>>>>>>>>        Move Particle.Cnt_ID                                to Pmoves.Cnt_ID
43120>>>>>>>>>>>>>        Move Item.Units_Code                                to Pmoves.Pms_UnitCode
43121>>>>>>>>>>>>>        move witemx.witemx_descr                            to pmoves.witemx_descr
43122>>>>>>>>>>>>>        move ptyppar.ptyppar_descr                          to pmoves.ptyppar_descr
43123>>>>>>>>>>>>>        move clients.client_name                            to pmoves.client_name
43124>>>>>>>>>>>>>        move particle.antlia_code                           to pmoves.pump_id
43125>>>>>>>>>>>>>        move particle.oxhma_code                            to pmoves.car_id
43126>>>>>>>>>>>>>        if (particle.zone_id='') move pmoves.zone           to particle.zone_id
43129>>>>>>>>>>>>>        else move particle.Zone_ID                          to pmoves.Zone
43131>>>>>>>>>>>>>        
43131>>>>>>>>>>>>>        Move (Pmoves.Pms_Qty-Pmoves.Timol_Qty)              to Pmoves.Timol_Ypol
43132>>>>>>>>>>>>>
43132>>>>>>>>>>>>>        Move (Pmoves.Qty_Kinhshs>0)                         to Pmoves.pms_Selected
43133>>>>>>>>>>>>>
43133>>>>>>>>>>>>>        Move (Round_Number((Pmoves.Pms_Qty*Pmoves.Pms_UnitPrice),iDecimals))    ;                                                            to Pmoves.Pms_Ambd
43134>>>>>>>>>>>>>        Move (Round_Number((Pmoves.Pms_Ambd*Pmoves.Pms_PctDisc/100),iDecimals)) ;                                                            to Pmoves.Pms_Discam
43135>>>>>>>>>>>>>        Move (Pmoves.Pms_Ambd-Pmoves.Pms_Discam)            to Pmoves.Pms_Amaftdisc
43136>>>>>>>>>>>>>
43136>>>>>>>>>>>>>        Move (Round_Number((Pmoves.Pms_Amaftdisc*Pmoves.Pms_Vatpct/100),iDecimals));                                                            to Pmoves.Pms_Vatam
43137>>>>>>>>>>>>>        Move (Pmoves.Pms_Amaftdisc+Pmoves.Pms_Vatam)        to Pmoves.Pms_Payable
43138>>>>>>>>>>>>>        Move Pmoves.Pms_Payable                             to Pmoves.Pms_Axia
43139>>>>>>>>>>>>>
43139>>>>>>>>>>>>>        Add Pmoves.Pms_Qty                                  to Particle.Partl_TotTem
43140>>>>>>>>>>>>>        Add Pmoves.Timol_Qty                                to Particle.Timol_Qty
43141>>>>>>>>>>>>>
43141>>>>>>>>>>>>>        Add Pmoves.Pms_Ambd                                 to Particle.Partl_TotAmBD
43142>>>>>>>>>>>>>        Add Pmoves.Pms_DiscAm                               to Particle.Partl_AMDISCPMS
43143>>>>>>>>>>>>>        Add Pmoves.Pms_Amaftdisc                            to Particle.Partl_TotAmAd
43144>>>>>>>>>>>>>        Add Pmoves.Pms_Vatam                                to Particle.Partl_Vatam
43145>>>>>>>>>>>>>        Add 1                                               to Particle.Partl_NoOfLines
43146>>>>>>>>>>>>>
43146>>>>>>>>>>>>>        If (Pmoves.Pms_Vatam) Begin
43148>>>>>>>>>>>>>            Clear PartlFpa
43149>>>>>>>>>>>>>            Move Particle.Partl_Recr                            to PartlFpa.Partl_Recr
43150>>>>>>>>>>>>>            Move Pmoves.Pms_VatPct                              to PartlFpa.Fpa_Pososto
43151>>>>>>>>>>>>>            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
43152>>>>>>>>>>>>>>
43152>>>>>>>>>>>>>            Add Pmoves.Pms_Vatam                                to PartlFpa.PartlFpa_Poso
43153>>>>>>>>>>>>>            Saverecord PartlFpa
43154>>>>>>>>>>>>>        End
43154>>>>>>>>>>>>>>
43154>>>>>>>>>>>>>
43154>>>>>>>>>>>>>        // An einai parastatiko polhshs kai to ptyppar einai flagarismeno oti
43154>>>>>>>>>>>>>        // prepei na enhmerosh to pedio Clients.Posa_apo_dap
43154>>>>>>>>>>>>>        // tote theoroume oti ypoxreotika prepei na vroume timh apo
43154>>>>>>>>>>>>>        // function timokatalogon kai na thn krathsoume sto pedio
43154>>>>>>>>>>>>>        // Pmoves.Posa_apo_dap
43154>>>>>>>>>>>>>        If ((Ptyppar.Ptyppar_Is_What='2') And (Ptyppar.Check_Posa_Plaf='1')) Begin
43156>>>>>>>>>>>>>            // An to pedio Particle.Partl_Vsn einai 0 tote shmainei
43156>>>>>>>>>>>>>            // oti den einai parastatiko metasxhmatismeno (px D.AP) ara
43156>>>>>>>>>>>>>            // h update prepei na prosthesei sto antistoixo pedio client
43156>>>>>>>>>>>>>            // An omos einai metasxhmatismeno (px apo D.AP tora einai
43156>>>>>>>>>>>>>            // Timologio) tote  prepei h update na afairesei apo to pedio
43156>>>>>>>>>>>>>            // tou client dioti to arxiko D.AP eixe prosthesei.
43156>>>>>>>>>>>>>
43156>>>>>>>>>>>>>            Move (Round_Number(Pmoves.Pms_Payable,2)) to Pmoves.Posa_Apo_Dap
43157>>>>>>>>>>>>>
43157>>>>>>>>>>>>>            If (Particle.Partl_Vsn=0) Begin
43159>>>>>>>>>>>>>                Add Pmoves.Posa_Apo_Dap to Clients.Posa_Apo_Dap
43160>>>>>>>>>>>>>                Add Pmoves.Posa_Apo_Dap to Payresp.Posa_Apo_Dap
43161>>>>>>>>>>>>>            End
43161>>>>>>>>>>>>>>
43161>>>>>>>>>>>>>            Else Begin
43162>>>>>>>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Clients.Posa_Apo_Dap
43163>>>>>>>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Payresp.Posa_Apo_Dap
43164>>>>>>>>>>>>>            End
43164>>>>>>>>>>>>>>
43164>>>>>>>>>>>>>        End
43164>>>>>>>>>>>>>>
43164>>>>>>>>>>>>>
43164>>>>>>>>>>>>>        Add Pmoves.Qty_Kinhshs  to Particle.Partl_Disctof
43165>>>>>>>>>>>>>
43165>>>>>>>>>>>>>    End_Procedure   // Update
43166>>>>>>>>>>>>>
43166>>>>>>>>>>>>>    // Backout:
43166>>>>>>>>>>>>>    Procedure Backout
43167>>>>>>>>>>>>>
43167>>>>>>>>>>>>>        Forward Send Backout
43169>>>>>>>>>>>>>
43169>>>>>>>>>>>>>        Sub Pmoves.Pms_Qty        From Particle.Partl_TotTem
43170>>>>>>>>>>>>>        Sub Pmoves.Timol_Qty      From Particle.Timol_Qty
43171>>>>>>>>>>>>>        Sub Pmoves.Pms_Ambd       From Particle.Partl_TotAmBD
43172>>>>>>>>>>>>>        Sub Pmoves.Pms_DiscAm     From Particle.Partl_AMDISCPMS
43173>>>>>>>>>>>>>        Sub Pmoves.Pms_Amaftdisc  From Particle.Partl_TotAmAd
43174>>>>>>>>>>>>>        Sub Pmoves.Pms_Vatam      From Particle.Partl_Vatam
43175>>>>>>>>>>>>>        Sub 1                     From Particle.Partl_NoOfLines
43176>>>>>>>>>>>>>
43176>>>>>>>>>>>>>        If (Pmoves.Pms_Vatam) Begin
43178>>>>>>>>>>>>>            Clear PartlFpa
43179>>>>>>>>>>>>>            Move Particle.Partl_Recr    to PartlFpa.Partl_Recr
43180>>>>>>>>>>>>>            Move Pmoves.Pms_VatPct      to PartlFpa.Fpa_Pososto
43181>>>>>>>>>>>>>            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
43182>>>>>>>>>>>>>>
43182>>>>>>>>>>>>>            Sub Pmoves.Pms_Vatam      From PartlFpa.PartlFpa_Poso
43183>>>>>>>>>>>>>            Saverecord PartlFpa
43184>>>>>>>>>>>>>        End
43184>>>>>>>>>>>>>>
43184>>>>>>>>>>>>>
43184>>>>>>>>>>>>>        // An einai parastatiko polhshs kai to ptyppar einai flagarismeno oti
43184>>>>>>>>>>>>>        // prepei na enhmerosh to pedio Clients.Posa_apo_dap
43184>>>>>>>>>>>>>        // tote theoroume oti ypoxreotika prepei na vroume timh sto pedio
43184>>>>>>>>>>>>>        // Pmoves.Posa_apo_dap
43184>>>>>>>>>>>>>        If ((Ptyppar.Ptyppar_Is_What='2') And (Ptyppar.Check_Posa_Plaf='1')) Begin
43186>>>>>>>>>>>>>            // An to pedio Particle.Partl_Vsn einai 0 tote shmainei
43186>>>>>>>>>>>>>            // oti den einai parastatiko metasxhmatismeno (px D.AP) ara
43186>>>>>>>>>>>>>            // h backout prepei na afairesei apo antistoixo pedio client
43186>>>>>>>>>>>>>            // An omos einai metasxhmatismeno (px apo D.AP tora einai
43186>>>>>>>>>>>>>            // Timologio) tote  prepei h backout na prosthesi sto pedio
43186>>>>>>>>>>>>>            // tou client dioti to arxiko D.AP eixe afairethei.
43186>>>>>>>>>>>>>            If (Particle.Partl_Vsn=0) Begin
43188>>>>>>>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Clients.Posa_Apo_Dap
43189>>>>>>>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Payresp.Posa_Apo_Dap
43190>>>>>>>>>>>>>            End
43190>>>>>>>>>>>>>>
43190>>>>>>>>>>>>>            Else Begin
43191>>>>>>>>>>>>>                Add Pmoves.Posa_Apo_Dap to Clients.Posa_Apo_Dap
43192>>>>>>>>>>>>>                Add Pmoves.Posa_Apo_Dap to Payresp.Posa_Apo_Dap
43193>>>>>>>>>>>>>            End
43193>>>>>>>>>>>>>>
43193>>>>>>>>>>>>>        End
43193>>>>>>>>>>>>>>
43193>>>>>>>>>>>>>
43193>>>>>>>>>>>>>        Sub Pmoves.Qty_Kinhshs From Particle.Partl_Disctof
43194>>>>>>>>>>>>>
43194>>>>>>>>>>>>>    End_Procedure   // Backout
43195>>>>>>>>>>>>>
43195>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
43196>>>>>>>>>>>>>             If (iError_Num = 1001) Error 1001 "DDC 18: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ©«¦ Wax"
43199>>>>>>>>>>>>>        Else If (iError_Num = 1002) Error 1002 "DDC 18: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ©«¦ Witemx"
43203>>>>>>>>>>>>>        Else If (iError_Num = 1003) Error 1003 "DDC 18: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ©«¦ Particle"
43207>>>>>>>>>>>>>        Else If (iError_Num = 1004) Error 1004 "DDC 18: ¦©æ«ž«˜ „å›¦¬ª ‹ž›œ¤ ¡ã\nƒ ˜š¨á¯«œ ˜¤ Ÿâ¢œ«œ, «ž š¨˜££ã «¦¬ œå›¦¬ª"
43211>>>>>>>>>>>>>        Else If (iError_Num = 1005) Error 1005 "DDC 18: ¦©æ §¨¦ „¡§«à©žª ‹ž›œ¤ ¡æ"
43215>>>>>>>>>>>>>        Else If (iError_Num = 1006) Error 1006 "DDC 18: ¦©æ §¨¦ ”€ ‹ž›œ¤ ¡æ"
43219>>>>>>>>>>>>>        Else If (iError_Num = 1007) Error 1007 "DDC 18: ¦©æ ¢ž¨à«â¦ „å›¦¬ª ‹ž›œ¤ ¡æ"
43223>>>>>>>>>>>>>        Else If (iError_Num = 1009) Error 1009 "DDC 18: ƒœ¤ œå¤˜  œ­ ¡«ã ž › ˜š¨˜­ã \n„®œ  ›ž£ ¦¬¨šžŸœå £œ«˜©®ž£˜« ©£â¤¦ §˜¨˜©«˜« ¡æ"
43227>>>>>>>>>>>>>        Else If (iError_Num = 1010) Error 1010 "DDC 18: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ §œ¢á«ž"
43231>>>>>>>>>>>>>        Else If (iError_Num = 1011) Error 1011 "DDC 18: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ ¬§. §¢ž¨à£ãª"
43235>>>>>>>>>>>>>        Else If (iError_Num = 1012) Error 1012 "DDC 18: ’¦ œå›¦ª ˜¬«æ §¨¦ã¢Ÿœ ˜§¦ £œ«˜©®ž£˜« ©£æ ¡˜  ›œ¤ › ˜š¨á­œ«˜ .\nƒ ˜š¨á¯«œ «¦ §˜¨˜©«˜« ¡æ ¡˜  ¥˜¤˜£œ«˜©®ž£˜«å©«œ «¦ ˜¨® ¡æ."
43239>>>>>>>>>>>>>        Else If (iError_Num = 1013) Error 1013 "DDC 18: ’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\n‰ ¤ãŸž¡œ §¦©æ«ž«˜ > ˜§¦ «ž › ˜Ÿâ© £ž"
43243>>>>>>>>>>>>>        Else If (iError_Num = 1111) Error 1111 "DDC 18: ƒœ¤ â®œ  ¡˜«˜®à¨žŸœå ©«¦ ©ç©«ž£˜ «â«¦ ¦ §¦©¦©«æ ”€"
43247>>>>>>>>>>>>>        Else If (iError_Num = 1105) Error 1105 "DDC 18: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
43251>>>>>>>>>>>>>        Else If (iError_Num = 1106) Error 1106 "DDC 18: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
43255>>>>>>>>>>>>>        Else If (iError_Num = 1107) Error 1107 "DDC 18: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
43259>>>>>>>>>>>>>        Else If (iError_Num = 1108) Error 1108 "DDC 18: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
43263>>>>>>>>>>>>>        Else If (iError_Num = 1110) Error 1110 "DDC 18: †£/¤å˜ §˜¨˜©«˜« ¡¦ç <= †£/¤å˜ª ¡¢œ ©å£˜«¦ª\nƒœ¤ œ§ «¨â§œ«˜  ¡˜££å˜ «¨¦§¦§¦åž©ž ©«¦ §˜¨˜©«˜« ¡æ"
43267>>>>>>>>>>>>>        Else If (iError_Num = 6001) Error 6001 "DDC 18: ƒœ¤ §¨¦¡ç§«œ  §¦©¦ ˜§¦ « £¦¡˜«á¢¦š¦"
43271>>>>>>>>>>>>>        Else If (iError_Num = 7000) Error 7000 "DDC 18: ¨¦â¨®œ«˜  ˜§¦ ˜¨˜ššœ¢å˜. † š¨˜££ã ˜¬«ã £æ¤¦ › ˜š¨á­œ«˜ "
43275>>>>>>>>>>>>>        Else If (iError_Num = 7001) Error 7001 "DDC 18: ’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ."
43279>>>>>>>>>>>>>        Else If (iError_Num = 7005) Error 7005 "DDC 18: † §¦©æ«ž«˜ ›œ¤ «¨¦§¦§¦ œå«˜  š ˜«  §¨¦ã¢Ÿœ ˜§¦ £œ«˜©®ž£˜« ©£æ.\nƒ ˜š¨á¯«œ «¦ §˜¨˜©«˜« ¡æ ¡˜  ¥˜¤˜£œ«˜©®ž£˜«å©«œ «¦ ˜¨® ¡æ."
43283>>>>>>>>>>>>>        Else If (iError_Num = 8000) Error 8000 "DDC 18: €¡¬¨éŸž¡œ ž ¡˜«˜®é¨ž©ž «¦¬ œå›¦¬ª ˜§¦ «¦¤ ®¨ã©«ž\n‹œ«˜ «¦ Ž‰, §˜«ã©«œ F5"
43287>>>>>>>>>>>>>        Else Forward Send Operation_Not_Allowed  iError_Num
43290>>>>>>>>>>>>>    End_Procedure   // Operation_Not_Allowed
43291>>>>>>>>>>>>>
43291>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
43292>>>>>>>>>>>>>        Integer iReturnVal iFpaRecnum iYes
43293>>>>>>>>>>>>>        Number  nInt nqty nQtyKin
43293>>>>>>>>>>>>>        String  sUserID sOldUserID
43293>>>>>>>>>>>>>
43293>>>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
43295>>>>>>>>>>>>>
43295>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
43297>>>>>>>>>>>>>            If (Pmoves.Pms_VatPct) Begin
43299>>>>>>>>>>>>>                Move Fpa.Recnum to iFpaRecnum
43300>>>>>>>>>>>>>                Clear Fpa
43301>>>>>>>>>>>>>                Move Pmoves.Pms_VatPct      to Fpa.Fpa_Pososto
43302>>>>>>>>>>>>>                Find eq Fpa By Index.1 // Fpa:Index.1:Fpa_Pososto
43303>>>>>>>>>>>>>>
43303>>>>>>>>>>>>>                If (Not(Found)) Move 1111 to iReturnVal
43306>>>>>>>>>>>>>                If (iFpaRecnum) Begin
43308>>>>>>>>>>>>>                    Clear Fpa
43309>>>>>>>>>>>>>                    Move iFpaRecnum to Fpa.Recnum
43310>>>>>>>>>>>>>                    Find Eq Fpa.Recnum
43311>>>>>>>>>>>>>>
43311>>>>>>>>>>>>>                End
43311>>>>>>>>>>>>>>
43311>>>>>>>>>>>>>            End
43311>>>>>>>>>>>>>>
43311>>>>>>>>>>>>>                 If (Wax.Recnum          =0) Move 1001 to iReturnVal
43314>>>>>>>>>>>>>            Else If (Witemx.Recnum       =0) Move 1002 to iReturnVal
43318>>>>>>>>>>>>>            Else If (Particle.Recnum     =0) Move 1003 to iReturnVal
43322>>>>>>>>>>>>>            Else If (Pmoves.Pms_Qty      =0) Move 1004 to iReturnVal
43326>>>>>>>>>>>>>            Else If ( (Sysfile.Hm_Kleisimatos<>'') And ;                      (Particle.Partl_Hmnia<=Sysfile.Hm_Kleisimatos) ) ;                     Move 1110 to iReturnVal
43330>>>>>>>>>>>>>            Else Begin
43331>>>>>>>>>>>>>                If (Pmoves.Timol_Ypol<0)                        Move 7001 to iReturnVal
43334>>>>>>>>>>>>>
43334>>>>>>>>>>>>>
43334>>>>>>>>>>>>>                // SOS SOS SOS 24/10/2002 ¨¦©¦¨ ¤˜ Off š ˜«  ®«¬§˜œ  ©« ª ˜¤«¢ œª
43334>>>>>>>>>>>>>                Else If (Pmoves.Qty_Kinhshs>Pmoves.Timol_Ypol)  Move 1013 to iReturnVal
43338>>>>>>>>>>>>>
43338>>>>>>>>>>>>>//                Else If ((Ptyppar.Ptyppar_Is_What='2') And (Ptyppar.Check_Posa_Plaf='1')) Begin
43338>>>>>>>>>>>>>//                    If (Pmoves.Posa_Apo_Dap=0) Begin
43338>>>>>>>>>>>>>//                        Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
43338>>>>>>>>>>>>>//                        If (iYes=MBR_NO) Move 6001 to iReturnVal
43338>>>>>>>>>>>>>//                    End
43338>>>>>>>>>>>>>//                End
43338>>>>>>>>>>>>>//                Else If ((Clients.Plafon>0) And ;
43338>>>>>>>>>>>>>//                    ((Clients.Ypoloipo+Pmoves.Posa_Apo_Dap)>Clients.Plafon) And ;
43338>>>>>>>>>>>>>//                    (Ptyppar.Check_Posa_Plaf='1')) Begin
43338>>>>>>>>>>>>>//                        Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
43338>>>>>>>>>>>>>//                        If (iYes=MBR_NO) Move 1010 to iReturnVal
43338>>>>>>>>>>>>>//                End
43338>>>>>>>>>>>>>//                Else If ((PayResp.Plafon>0) And ;
43338>>>>>>>>>>>>>//                        ((PayResp.Ypoloipo+Pmoves.Posa_Apo_Dap)>PayResp.Plafon) And ;
43338>>>>>>>>>>>>>//                         (Ptyppar.Check_Posa_Plaf='1')) Begin
43338>>>>>>>>>>>>>//                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
43338>>>>>>>>>>>>>//                        If (iYes=MBR_NO) Move 1011 to iReturnVal
43338>>>>>>>>>>>>>//                End
43338>>>>>>>>>>>>>                Else If ((pmoves.clorderd_recr <> '') and (pifromclorder(self)<>1)) begin //?? Pmoves ???ÿ????š???? ? ???????êœ??
43341>>>>>>>>>>>>>                    get pnoqty to nqty
43342>>>>>>>>>>>>>                    if (nqty <> pmoves.pms_qty)                 Move 7000 to iReturnVal
43345>>>>>>>>>>>>>                End
43345>>>>>>>>>>>>>>
43345>>>>>>>>>>>>>
43345>>>>>>>>>>>>>                Else If ((Pmoves.Qty_Ypol=1) And (piFromMetasx(Self)=0)) begin
43348>>>>>>>>>>>>>                    // js 28/08/2002
43348>>>>>>>>>>>>>                    // To pedio Qty_Ypol xrhsimopoihtai gia na flagarei an ena Pmove
43348>>>>>>>>>>>>>                    // exei proelthei apo metasxhmatismo (Eite sygkentrotika, eite analytika)
43348>>>>>>>>>>>>>                    // To xrhsimopoihsame ayto gia na mhn anoixtei neo pedio.
43348>>>>>>>>>>>>>                    // An loipon exei proelthei apo metasxhmatismo DEN epitrepetai tropopoihsh
43348>>>>>>>>>>>>>                    // ths posothtas tou ap' eutheias alla mono meso ths posothtas mias
43348>>>>>>>>>>>>>                    // sygkekrimenhs eggrafhs tou arxeiou PmsSxet
43348>>>>>>>>>>>>>                    If (Operation_Origin=Self) Begin
43350>>>>>>>>>>>>>                        get pnoqty to nqty
43351>>>>>>>>>>>>>                        if (nqty <> pmoves.pms_qty)             Move 7005 to iReturnVal
43354>>>>>>>>>>>>>                    End
43354>>>>>>>>>>>>>>
43354>>>>>>>>>>>>>                End
43354>>>>>>>>>>>>>>
43354>>>>>>>>>>>>>            End
43354>>>>>>>>>>>>>>
43354>>>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
43357>>>>>>>>>>>>>        End
43357>>>>>>>>>>>>>>
43357>>>>>>>>>>>>>        Function_Return iReturnVal
43358>>>>>>>>>>>>>    End_Function   // Validate_Save
43359>>>>>>>>>>>>>
43359>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
43360>>>>>>>>>>>>>        Integer iReturnVal
43361>>>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
43363>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
43365>>>>>>>>>>>>>            If (Particle.Partl_Timol=1) Move 1009 to iReturnVal
43368>>>>>>>>>>>>>            Else If ( (Sysfile.Hm_Kleisimatos<>'') And ;                      (Particle.Partl_Hmnia<=Sysfile.Hm_Kleisimatos) ) ;                Move 1110 to iReturnVal
43372>>>>>>>>>>>>>            Else If ((pmoves.qty_ypol=1) And (Operation_Origin=Self)) Move 1012 to iReturnVal
43376>>>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
43379>>>>>>>>>>>>>        End
43379>>>>>>>>>>>>>>
43379>>>>>>>>>>>>>        Function_Return iReturnVal
43380>>>>>>>>>>>>>    End_Function   // Validate_Delete
43381>>>>>>>>>>>>>
43381>>>>>>>>>>>>>    Procedure Set_UnitPrice integer iField  Number nNum
43382>>>>>>>>>>>>>        Local Integer   Changed
43383>>>>>>>>>>>>>        Local Number    nInt
43383>>>>>>>>>>>>>        Get Field_Changed_State iField to Changed
43384>>>>>>>>>>>>>        If (Changed=0 AND nNum=0) Begin
43386>>>>>>>>>>>>>            Get fnTeleytaiaTimh to nInt
43387>>>>>>>>>>>>>            Set Field_Default_Value iField to nInt
43388>>>>>>>>>>>>>        End
43388>>>>>>>>>>>>>>
43388>>>>>>>>>>>>>    End_Procedure   // Shmera
43389>>>>>>>>>>>>>
43389>>>>>>>>>>>>>    Procedure Set_Discount integer iField  Number nNum
43390>>>>>>>>>>>>>        Local Integer Changed
43391>>>>>>>>>>>>>        Local Number nInt
43391>>>>>>>>>>>>>        Get Field_Changed_State iField to Changed
43392>>>>>>>>>>>>>        If (Changed=0 AND nNum=0) Begin
43394>>>>>>>>>>>>>            Get fnTeleytaiaTimh to nInt
43395>>>>>>>>>>>>>            If (nInt<0) Begin
43397>>>>>>>>>>>>>                Move (nInt*(-1)) to nInt
43398>>>>>>>>>>>>>                Set Field_Default_Value iField to nInt
43399>>>>>>>>>>>>>            End
43399>>>>>>>>>>>>>>
43399>>>>>>>>>>>>>        End
43399>>>>>>>>>>>>>>
43399>>>>>>>>>>>>>    End_Procedure   // Shmera
43400>>>>>>>>>>>>>
43400>>>>>>>>>>>>>    Procedure Set_FPA integer iField  Number nNum
43401>>>>>>>>>>>>>        Local Integer Changed
43402>>>>>>>>>>>>>        Local Number nInt
43402>>>>>>>>>>>>>        Get Field_Changed_State iField to Changed
43403>>>>>>>>>>>>>        If (Changed=0 AND nNum=0) Begin
43405>>>>>>>>>>>>>            Move Item.Fpa_Pososto to nInt
43406>>>>>>>>>>>>>            Set Field_Default_Value iField to nInt
43407>>>>>>>>>>>>>        End
43407>>>>>>>>>>>>>>
43407>>>>>>>>>>>>>    End_Procedure   // Shmera
43408>>>>>>>>>>>>>
43408>>>>>>>>>>>>>    // Define_Fields:
43408>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
43408>>>>>>>>>>>>>
43408>>>>>>>>>>>>>    Procedure Define_Fields
43409>>>>>>>>>>>>>        Forward Send Define_Fields
43411>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43411>>>>>>>>>>>>>        //DDB-DefineFieldStart
43411>>>>>>>>>>>>>
43411>>>>>>>>>>>>>        Set Main_File            To Pmoves.File_Number
43412>>>>>>>>>>>>>
43412>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
43413>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
43414>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43415>>>>>>>>>>>>>
43415>>>>>>>>>>>>>        // Child (Client) file structure................
43415>>>>>>>>>>>>>        Send Add_Client_File  Pmsdtl.File_Number
43416>>>>>>>>>>>>>        Send Add_Client_File  Pmssxet.File_Number
43417>>>>>>>>>>>>>
43417>>>>>>>>>>>>>        // Parent (Server) file structure...............
43417>>>>>>>>>>>>>        Send Add_Server_File  Wax.File_Number
43418>>>>>>>>>>>>>        Send Add_Server_File  Witemx.File_Number
43419>>>>>>>>>>>>>        Send Add_Server_File  Particle.File_Number
43420>>>>>>>>>>>>>
43420>>>>>>>>>>>>>        // External (System) file structure.............
43420>>>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
43421>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
43422>>>>>>>>>>>>>        Send Add_System_File  Partlfpa.File_Number  DD_LOCK_ON_ALL
43423>>>>>>>>>>>>>        Send Add_System_File  Clorder.File_Number  DD_LOCK_ON_ALL
43424>>>>>>>>>>>>>        Send Add_System_File  Clorderd.File_Number  DD_LOCK_ON_ALL
43425>>>>>>>>>>>>>        Send Add_System_File  Btnemp.File_Number  DD_LOCK_ON_ALL
43426>>>>>>>>>>>>>
43426>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Pmoves_Rec0  To Pmoves.Pms_Rec0
43429>>>>>>>>>>>>>
43429>>>>>>>>>>>>>        // Field-based properties.......................
43429>>>>>>>>>>>>>
43429>>>>>>>>>>>>>        // Pmoves.Company_Code
43429>>>>>>>>>>>>>
43429>>>>>>>>>>>>>        // Pmoves.Branch_Code
43429>>>>>>>>>>>>>
43429>>>>>>>>>>>>>        // Pmoves.Year_Year
43429>>>>>>>>>>>>>
43429>>>>>>>>>>>>>        // Pmoves.Ctypkin_Code
43429>>>>>>>>>>>>>
43429>>>>>>>>>>>>>        // Pmoves.Wtypkin_Code
43429>>>>>>>>>>>>>
43429>>>>>>>>>>>>>        // Pmoves.Custprom_Code
43429>>>>>>>>>>>>>
43429>>>>>>>>>>>>>        // Pmoves.Client_Id
43429>>>>>>>>>>>>>
43429>>>>>>>>>>>>>        // Pmoves.Cn_Code
43429>>>>>>>>>>>>>
43429>>>>>>>>>>>>>        // Pmoves.Ptyppar_Code
43429>>>>>>>>>>>>>
43429>>>>>>>>>>>>>        // Pmoves.Partl_Hmnia
43429>>>>>>>>>>>>>
43429>>>>>>>>>>>>>        // Pmoves.Pseira_Seira
43429>>>>>>>>>>>>>
43429>>>>>>>>>>>>>        // Pmoves.Partl_No
43429>>>>>>>>>>>>>
43429>>>>>>>>>>>>>        // Pmoves.Partl_Rec0
43429>>>>>>>>>>>>>
43429>>>>>>>>>>>>>        // Pmoves.Witemkat_Code
43429>>>>>>>>>>>>>
43429>>>>>>>>>>>>>        // Pmoves.Units_Code
43429>>>>>>>>>>>>>
43429>>>>>>>>>>>>>        // Pmoves.Item_Code
43429>>>>>>>>>>>>>
43429>>>>>>>>>>>>>        // Pmoves.Witemx_Code
43429>>>>>>>>>>>>>
43429>>>>>>>>>>>>>        // Pmoves.Wapokat_Code
43429>>>>>>>>>>>>>
43429>>>>>>>>>>>>>        // Pmoves.Wapomast_Code
43429>>>>>>>>>>>>>
43429>>>>>>>>>>>>>        // Pmoves.Wax_Code
43429>>>>>>>>>>>>>
43429>>>>>>>>>>>>>        // Pmoves.Wax_Recr
43429>>>>>>>>>>>>>
43429>>>>>>>>>>>>>        // Pmoves.Witemx_Recr
43429>>>>>>>>>>>>>
43429>>>>>>>>>>>>>        // Pmoves.Partl_Recr
43429>>>>>>>>>>>>>
43429>>>>>>>>>>>>>        // Pmoves.Pms_Rec0
43429>>>>>>>>>>>>>        Set Field_Options          Field Pmoves.Pms_Rec0 To DD_AUTOFIND   
43430>>>>>>>>>>>>>
43430>>>>>>>>>>>>>        // Pmoves.Pms_No
43430>>>>>>>>>>>>>
43430>>>>>>>>>>>>>        // Pmoves.Pms_Recr
43430>>>>>>>>>>>>>
43430>>>>>>>>>>>>>        // Pmoves.Pms_Unitcode
43430>>>>>>>>>>>>>
43430>>>>>>>>>>>>>        // Pmoves.Pms_Qty
43430>>>>>>>>>>>>>
43430>>>>>>>>>>>>>        // Pmoves.Pms_Unitprice
43430>>>>>>>>>>>>>        Set Field_Entry_msg        Field Pmoves.Pms_Unitprice To Set_UnitPrice
43431>>>>>>>>>>>>>
43431>>>>>>>>>>>>>        // Pmoves.Pms_Ambd
43431>>>>>>>>>>>>>
43431>>>>>>>>>>>>>        // Pmoves.Pms_Pctdisc
43431>>>>>>>>>>>>>        Set Field_Entry_msg        Field Pmoves.Pms_Pctdisc To Set_Discount
43432>>>>>>>>>>>>>
43432>>>>>>>>>>>>>        // Pmoves.Pms_Discam
43432>>>>>>>>>>>>>
43432>>>>>>>>>>>>>        // Pmoves.Pms_Amaftdisc
43432>>>>>>>>>>>>>
43432>>>>>>>>>>>>>        // Pmoves.Pms_Vatpct
43432>>>>>>>>>>>>>        Set Field_Entry_msg        Field Pmoves.Pms_Vatpct To Set_FPA
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_Vatam
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_Exrampct
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_Exdet
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_Payable
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_Axia
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_X0
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_P0
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_X00
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_P00
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_X1
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_P1
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_X2
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_P2
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_Dlixis
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_A_Code
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_Status_E
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_Status_A
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_S0
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_Ys0
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_S1
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_Ys1
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_S2
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_Ys2
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_Sc_Code2
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_Open
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_Aopen
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_M_Code
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_Yn_Myf
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_Myf_Axia
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_Kk
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_C_Code2
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_Cn_Code
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Wcmoves_Recr
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_Module
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Btnl2_Recr
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Btnemp_Recr
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Btarticle_Recr
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Sls_Id
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Presp_Id
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Cnt_Id
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Mhxanik_Id
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Extra_Epimer
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Ekpt_Epimer
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Clorderd_Recr
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Witemx_Descr
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Ptyppar_Descr
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Ti_Typonei_Pms
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Timol_Qty
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Timol_Ypol
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Posa_Apo_Dap
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Qty_Ypol
43433>>>>>>>>>>>>>
43433>>>>>>>>>>>>>        // Pmoves.Pms_Selected
43433>>>>>>>>>>>>>        Set Field_Class_Name       Field Pmoves.Pms_Selected To "dbCheckBoxsub"
43434>>>>>>>>>>>>>
43434>>>>>>>>>>>>>        // Pmoves.Qty_Kinhshs
43434>>>>>>>>>>>>>
43434>>>>>>>>>>>>>        // Pmoves.Sx_Parast
43434>>>>>>>>>>>>>
43434>>>>>>>>>>>>>        // Pmoves.Sx_Hmnia
43434>>>>>>>>>>>>>
43434>>>>>>>>>>>>>        // Pmoves.Sx_Seira
43434>>>>>>>>>>>>>
43434>>>>>>>>>>>>>        // Pmoves.Sx_Arithmos
43434>>>>>>>>>>>>>
43434>>>>>>>>>>>>>        // Pmoves.Pump_Id
43434>>>>>>>>>>>>>
43434>>>>>>>>>>>>>        // Pmoves.Car_Id
43434>>>>>>>>>>>>>
43434>>>>>>>>>>>>>        // Pmoves.Item_Ypot
43434>>>>>>>>>>>>>
43434>>>>>>>>>>>>>        // Pmoves.Qty_Return
43434>>>>>>>>>>>>>
43434>>>>>>>>>>>>>        // Pmoves.Client_Name
43434>>>>>>>>>>>>>
43434>>>>>>>>>>>>>        // Pmoves.Zone
43434>>>>>>>>>>>>>
43434>>>>>>>>>>>>>        //DDB-DefineFieldEnd
43434>>>>>>>>>>>>>    End_Procedure    // Define_Fields
43435>>>>>>>>>>>>>
43435>>>>>>>>>>>>>    // Field_Defaults:
43435>>>>>>>>>>>>>    // This procedure is used to establish default field values.
43435>>>>>>>>>>>>>
43435>>>>>>>>>>>>>    Procedure Field_Defaults
43436>>>>>>>>>>>>>        Forward Send Field_Defaults
43438>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43438>>>>>>>>>>>>>        //DDB-FieldDefaultStart
43438>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
43438>>>>>>>>>>>>>        //Set Field_Changed_Value Field Pmoves.Pms_VatPct to Item.Fpa_Pososto
43438>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
43439>>>>>>>>>>>>>
43439>>>>>>>>>>>>>End_Class    // Pmoves_DataDictionary
43440>>>>>>>>>>>>>//DDB-FileEnd
43440>>>>>>>>>>>    Use PmsDtl.DD
INCLUDING FILE: PMSDTL.DD
43440>>>>>>>>>>>>>//DDB-FileStart
43440>>>>>>>>>>>>>//DDB-HeaderStart
43440>>>>>>>>>>>>>
43440>>>>>>>>>>>>>// File Name : PmsDtl.DD
43440>>>>>>>>>>>>>// Class Name: Pmsdtl_DataDictionary
43440>>>>>>>>>>>>>// Revision  : 0
43440>>>>>>>>>>>>>// Version   : 2
43440>>>>>>>>>>>>>
43440>>>>>>>>>>>>>Use  Windows           // Basic Definitions
43440>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
43440>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43440>>>>>>>>>>>>>
43440>>>>>>>>>>>>>Open Pmsdtl
43442>>>>>>>>>>>>>Open Pmoves
43444>>>>>>>>>>>>>
43444>>>>>>>>>>>>>//DDB-HeaderEnd
43444>>>>>>>>>>>>>
43444>>>>>>>>>>>>>Class Pmsdtl_DataDictionary  is a DataDictionary_Sec
43445>>>>>>>>>>>>>
43445>>>>>>>>>>>>>    // Define_Fields:
43445>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
43445>>>>>>>>>>>>>
43445>>>>>>>>>>>>>    Procedure Define_Fields
43446>>>>>>>>>>>>>        Forward Send Define_Fields
43448>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43448>>>>>>>>>>>>>        //DDB-DefineFieldStart
43448>>>>>>>>>>>>>
43448>>>>>>>>>>>>>        Set Main_File            To Pmsdtl.File_Number
43449>>>>>>>>>>>>>
43449>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
43450>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
43451>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43452>>>>>>>>>>>>>
43452>>>>>>>>>>>>>        // Parent (Server) file structure...............
43452>>>>>>>>>>>>>        Send Add_Server_File  Pmoves.File_Number
43453>>>>>>>>>>>>>
43453>>>>>>>>>>>>>        // Field-based properties.......................
43453>>>>>>>>>>>>>
43453>>>>>>>>>>>>>        // Pmsdtl.Pms_Recr
43453>>>>>>>>>>>>>        Set Field_Options          Field Pmsdtl.Pms_Recr To DD_AUTOFIND   
43454>>>>>>>>>>>>>        Set Key_Field_State        Field Pmsdtl.Pms_Recr To TRUE
43455>>>>>>>>>>>>>
43455>>>>>>>>>>>>>        // Pmsdtl.Line1
43455>>>>>>>>>>>>>
43455>>>>>>>>>>>>>        // Pmsdtl.Line2
43455>>>>>>>>>>>>>
43455>>>>>>>>>>>>>        // Pmsdtl.Line3
43455>>>>>>>>>>>>>
43455>>>>>>>>>>>>>        // Pmsdtl.Line4
43455>>>>>>>>>>>>>
43455>>>>>>>>>>>>>        // Pmsdtl.Line5
43455>>>>>>>>>>>>>
43455>>>>>>>>>>>>>        //DDB-DefineFieldEnd
43455>>>>>>>>>>>>>    End_Procedure    // Define_Fields
43456>>>>>>>>>>>>>
43456>>>>>>>>>>>>>    // Field_Defaults:
43456>>>>>>>>>>>>>    // This procedure is used to establish default field values.
43456>>>>>>>>>>>>>
43456>>>>>>>>>>>>>    Procedure Field_Defaults
43457>>>>>>>>>>>>>        Forward Send Field_Defaults
43459>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43459>>>>>>>>>>>>>        //DDB-FieldDefaultStart
43459>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
43459>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
43460>>>>>>>>>>>>>
43460>>>>>>>>>>>>>End_Class    // Pmsdtl_DataDictionary
43461>>>>>>>>>>>>>//DDB-FileEnd
43461>>>>>>>>>>>    Use BAXIOKAT.DD
INCLUDING FILE: BAXIOKAT.DD
43461>>>>>>>>>>>>>//DDB-FileStart
43461>>>>>>>>>>>>>//DDB-HeaderStart
43461>>>>>>>>>>>>>
43461>>>>>>>>>>>>>// File Name : BAXIOKAT.DD
43461>>>>>>>>>>>>>// Class Name: Baxiokat_DataDictionary
43461>>>>>>>>>>>>>// Revision  : 44
43461>>>>>>>>>>>>>// Version   : 2
43461>>>>>>>>>>>>>
43461>>>>>>>>>>>>>Use  Windows           // Basic Definitions
43461>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
43461>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43461>>>>>>>>>>>>>
43461>>>>>>>>>>>>>Open Baxiokat
INCLUDING FILE: BAXIOKAT.FD
43463>>>>>>>>>>>>>Open Baxio
INCLUDING FILE: BAXIO.FD
43465>>>>>>>>>>>>>Open Bkinkat
INCLUDING FILE: BKINKAT.FD
43467>>>>>>>>>>>>>Open Tpclient
43469>>>>>>>>>>>>>Open Tperga
43471>>>>>>>>>>>>>Open Tparticl
43473>>>>>>>>>>>>>Open Sysrecb
INCLUDING FILE: SYSRECB.FD
43475>>>>>>>>>>>>>
43475>>>>>>>>>>>>>//DDB-HeaderEnd
43475>>>>>>>>>>>>>//DDB-ValidationStart
43475>>>>>>>>>>>>>
43475>>>>>>>>>>>>>//DDB/ ExternalValidationTable Baxiokat_Type_VT  BAXIO.PKG
43475>>>>>>>>>>>>>
43475>>>>>>>>>>>>>Register_Object Baxiokat_Type_VT
43475>>>>>>>>>>>>>Register_Object Baxiokat_Baxiokat_Yn5390_VT
43475>>>>>>>>>>>>>Register_Object Baxiokat_Baxiokat_Bank_VT
43475>>>>>>>>>>>>>Register_Object Baxiokat_Baxiokat_Formul_VT
43475>>>>>>>>>>>>>Use BAXIO.PKG        // Baxiokat_Type_VT
INCLUDING FILE: BAXIO.PKG
43475>>>>>>>>>>>>>>>// **************************************************************************
43475>>>>>>>>>>>>>>>// *Code Style   : Object                                                   *
43475>>>>>>>>>>>>>>>// *Name         : Baxio.vts                                                *
43475>>>>>>>>>>>>>>>// *Revision     : 1                                                        *
43475>>>>>>>>>>>>>>>// *Main File    :                                                          *
43475>>>>>>>>>>>>>>>// *Location     : \Home.Win\Easyware\ED\Appsrc                             *
43475>>>>>>>>>>>>>>>// *Creation Date: 01/09/99                                                 *
43475>>>>>>>>>>>>>>>// *Last Update  :                                                          *
43475>>>>>>>>>>>>>>>// *Author       : JA                                                       *
43475>>>>>>>>>>>>>>>// *Includes     :                                                          *
43475>>>>>>>>>>>>>>>// *Comments     : œ¨ â®œ  æ¢˜ «˜ static validation tables «¦¬             *
43475>>>>>>>>>>>>>>>// *             : module «à¤ ˜¥ ¦š¨á­à¤.                                   *
43475>>>>>>>>>>>>>>>// *             :                                                          *
43475>>>>>>>>>>>>>>>// *             :                                                          *
43475>>>>>>>>>>>>>>>// *Returns      :                                                          *
43475>>>>>>>>>>>>>>>// *             :                                                          *
43475>>>>>>>>>>>>>>>// *‰nown bugs   :                                                          *
43475>>>>>>>>>>>>>>>// *             :                                                          *
43475>>>>>>>>>>>>>>>// *Improvements :                                                          *
43475>>>>>>>>>>>>>>>// *             :                                                          *
43475>>>>>>>>>>>>>>>// *             :                                                          *
43475>>>>>>>>>>>>>>>// **************************************************************************
43475>>>>>>>>>>>>>>>// *                        A N A L Y S I S                                 *
43475>>>>>>>>>>>>>>>// **************************************************************************
43475>>>>>>>>>>>>>>>// *                                                                        *
43475>>>>>>>>>>>>>>>// **************************************************************************
43475>>>>>>>>>>>>>>>
43475>>>>>>>>>>>>>>>
43475>>>>>>>>>>>>>>>//Set Allow_Blank_State To TRUE
43475>>>>>>>>>>>>>>>
43475>>>>>>>>>>>>>>>//used by: 1. baxiokat.baxiokat_type
43475>>>>>>>>>>>>>>>Object Baxiokat_Type_VT  is a DescriptionValidationTable
43477>>>>>>>>>>>>>>>       set table_title to "„å›¦ª €¥ ¦š¨á­¦¬"
43478>>>>>>>>>>>>>>>       Procedure Fill_List
43480>>>>>>>>>>>>>>>                 Forward Send Fill_List
43482>>>>>>>>>>>>>>>                 Send Add_Table_Value  "1"  "„ ©§¨˜¡«â¦"
43483>>>>>>>>>>>>>>>                 send add_table_value  "2"  "¢ž¨à«â¦"
43484>>>>>>>>>>>>>>>       End_Procedure //fill_list
43485>>>>>>>>>>>>>>>End_Object   //Baxiokat_Type_VT
43486>>>>>>>>>>>>>>>
43486>>>>>>>>>>>>>>>
43486>>>>>>>>>>>>>>>//¡˜«˜©«á©œ ª ˜¥ ¦š¨á­à¤
43486>>>>>>>>>>>>>>>//used by: 1. bkinkat.baxio_stat_from :¡˜«á©«˜©ž ˜§æ
43486>>>>>>>>>>>>>>>//         2. bkinkat.baxio_stat_to   :¡˜«á©«˜©ž ©â
43486>>>>>>>>>>>>>>>//         3. baxio.baxio_status      :¡˜«á©«˜©ž
43486>>>>>>>>>>>>>>>//â¤˜ ˜¥ æš¨˜­¦ œå¤˜  § Ÿ˜¤æ ¤˜ ™¨œŸœå ©« ª §˜¨˜¡á«à 3 ¡˜«˜©«á©œ ª:
43486>>>>>>>>>>>>>>>Object Baxio_Status_VT  is a DescriptionValidationTable
43488>>>>>>>>>>>>>>>       set table_title to "‰˜«˜©«á©œ ª €¥ ¦š¨á­à¤"
43489>>>>>>>>>>>>>>>       Procedure Fill_List
43491>>>>>>>>>>>>>>>                 Forward Send Fill_List
43493>>>>>>>>>>>>>>>                 Send Add_Table_Value  "1"  "„¡¡¨œ£âª"
43494>>>>>>>>>>>>>>>                 Send Add_Table_Value  "2"  "„¥¦­¢ž£â¤¦"
43495>>>>>>>>>>>>>>>                 Send Add_Table_Value  "3"  "ƒ ˜£˜¨«¬¨ž£â¤¦"
43496>>>>>>>>>>>>>>>                 Send Add_Table_Value  "4"  "’˜£œå¦"
43497>>>>>>>>>>>>>>>                 Send Add_Table_Value  "5"  "ƒœ©£œ¬£â¤¦"
43498>>>>>>>>>>>>>>>
43498>>>>>>>>>>>>>>>       End_Procedure // fill_list
43499>>>>>>>>>>>>>>>End_Object   //Baxio_Status_VT1
43500>>>>>>>>>>>>>>>
43500>>>>>>>>>>>>>>>
43500>>>>>>>>>>>>>>>
43500>>>>>>>>>>>>>>>//used by: 1. btypkin.btypkin_anti1
43500>>>>>>>>>>>>>>>//         2. btypkin.btypkin_anti2
43500>>>>>>>>>>>>>>>//         3. baxio.baxio_file_in
43500>>>>>>>>>>>>>>>//         4. baxio.baxio_file_out
43500>>>>>>>>>>>>>>>//         5. baxio.baxio_lfile
43500>>>>>>>>>>>>>>>Object Bfile_VT  is a DescriptionValidationTable
43502>>>>>>>>>>>>>>>       set table_title to "‘¬¤˜¢¢˜©æ£œ¤¦ª/˜¨˜¢ã§«žª ˜§æ"
43503>>>>>>>>>>>>>>>       Procedure Fill_List
43505>>>>>>>>>>>>>>>                 Forward Send Fill_List
43507>>>>>>>>>>>>>>>                 Send Add_Table_Value  "-1" "ƒœ¤ “§á¨®œ "
43508>>>>>>>>>>>>>>>                 Send Add_Table_Value  "0"  "Data Entry"
43509>>>>>>>>>>>>>>>                 Send Add_Table_Value  "1"  "Š¦š˜¨ ˜©£é¤ ‚Š"
43510>>>>>>>>>>>>>>>                 send add_table_value  "2"  "”¦¨â˜ª"
43511>>>>>>>>>>>>>>>                 Send Add_Table_Value  "3"  "¨¦£žŸœ¬«é¤"
43512>>>>>>>>>>>>>>>                 Send Add_Table_Value  "5"  "Ž ‘¬¤˜¢¢˜©æ£œ¤¦ª"
43513>>>>>>>>>>>>>>>                 Send Add_Table_Value  "6"  "’œ¢.˜¨˜¢ã§«žª"
43514>>>>>>>>>>>>>>>       End_Procedure // fill_list
43515>>>>>>>>>>>>>>>End_Object   // Btypkin_Btypkin_Anti_VT
43516>>>>>>>>>>>>>>>
43516>>>>>>>>>>>>>
43516>>>>>>>>>>>>>Object Baxiokat_Baxiokat_Yn5390_VT  is a DescriptionValidationTable
43518>>>>>>>>>>>>>
43518>>>>>>>>>>>>>    Procedure Fill_List
43520>>>>>>>>>>>>>        Forward Send Fill_List
43522>>>>>>>>>>>>>        Send Add_Table_Value  "0"  "Ž® "
43523>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "Œ˜ "
43524>>>>>>>>>>>>>    End_Procedure    // Fill_List
43525>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43525>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43525>>>>>>>>>>>>>End_Object   // Baxiokat_Baxiokat_Yn5390_VT
43526>>>>>>>>>>>>>
43526>>>>>>>>>>>>>Object Baxiokat_Baxiokat_Bank_VT  is a CodeValidationTable
43528>>>>>>>>>>>>>    Set Type_Value        To "BANK"
43529>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
43530>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43530>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43530>>>>>>>>>>>>>End_Object   // Baxiokat_Baxiokat_Bank_VT
43531>>>>>>>>>>>>>
43531>>>>>>>>>>>>>Object Baxiokat_Baxiokat_Formul_VT  is a DescriptionValidationTable
43533>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
43534>>>>>>>>>>>>>
43534>>>>>>>>>>>>>    Procedure Fill_List
43536>>>>>>>>>>>>>        Forward Send Fill_List
43538>>>>>>>>>>>>>        Send Add_Table_Value  "0"  ""
43539>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "’ç§¦ª 1"
43540>>>>>>>>>>>>>        Send Add_Table_Value  "2"  "’ç§¦ª 2"
43541>>>>>>>>>>>>>    End_Procedure    // Fill_List
43542>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43542>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43542>>>>>>>>>>>>>End_Object   // Baxiokat_Baxiokat_Formul_VT
43543>>>>>>>>>>>>>//DDB-ValidationEnd
43543>>>>>>>>>>>>>//DDB-SelectionStart
43543>>>>>>>>>>>>>//DDB/ ExternalSelectionList SL034  SL034.SL
43543>>>>>>>>>>>>>Register_Object SL034
43543>>>>>>>>>>>>>//DDB-SelectionEnd
43543>>>>>>>>>>>>>
43543>>>>>>>>>>>>>Open Syscurxr
43545>>>>>>>>>>>>>Open Btypkin
43547>>>>>>>>>>>>>Open Bkinkat
43549>>>>>>>>>>>>>
43549>>>>>>>>>>>>>
43549>>>>>>>>>>>>>// Apo Baxio_DD
43549>>>>>>>>>>>>>Register_Function private.Default_Axio_C_Code2 Returns String
43549>>>>>>>>>>>>>//
43549>>>>>>>>>>>>>
43549>>>>>>>>>>>>>Class Baxiokat_DataDictionary  is a DataDictionary_Sec
43550>>>>>>>>>>>>>
43550>>>>>>>>>>>>>     Procedure Creating
43551>>>>>>>>>>>>>        Forward Send Creating
43553>>>>>>>>>>>>>        // Insert Code Here
43553>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Baxiokat.Baxiokat_Rec0)))))) to Baxiokat.Baxiokat_Recr
43554>>>>>>>>>>>>>    End_Procedure   // Creating
43555>>>>>>>>>>>>>
43555>>>>>>>>>>>>>     Procedure Construct_Object
43556>>>>>>>>>>>>>               Forward Send Construct_Object
43558>>>>>>>>>>>>>
43558>>>>>>>>>>>>>               //object id «é¤ ddo servers š ˜ «á barticl+bmove+baxio+baxiokat
43558>>>>>>>>>>>>>               //©œ«á¨¦¤«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
43558>>>>>>>>>>>>>               //®¨ž© £œç¦¬¤ ©«ž¤ private.exit_btypkin_code
43558>>>>>>>>>>>>>               //š ˜ ¤˜ ©œ«á¨¦¬¤ «¦ visual interface
43558>>>>>>>>>>>>>               Property Integer piBarticl_dd  0
43559>>>>>>>>>>>>>               Property Integer piBmove_dd    0
43560>>>>>>>>>>>>>               Property Integer piBaxio_dd    0
43561>>>>>>>>>>>>>               Property Integer piBtypkin_dd 0
43562>>>>>>>>>>>>>     End_Procedure   //construct_object
43563>>>>>>>>>>>>>
43563>>>>>>>>>>>>>
43563>>>>>>>>>>>>>     //private
43563>>>>>>>>>>>>>     //¡˜¢œå«˜  ˜§æ: iexit «¦¬ baxiokat_code
43563>>>>>>>>>>>>>     //©œ«á¨œ      : «ž¤ default « £ã «¦¬ baxio_c_code2, ˜¤á¢¦š˜ £œ «¦ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
43563>>>>>>>>>>>>>     Procedure private.Exit_Baxiokat_Code Integer liField Integer liBaxiokat_Code
43564>>>>>>>>>>>>>               String lsBaxio_C_Code_2
43565>>>>>>>>>>>>>        PROCEDURE_RETURN
43566>>>>>>>>>>>>>//jsjsjs 24/01/2001
43566>>>>>>>>>>>>>//               Get File_Field_Current_Value File_Field Year.Year_C_Code0 to lsBaxio_C_Code_2
43566>>>>>>>>>>>>>
43566>>>>>>>>>>>>>//               Set Field_Changed_Value of (piBaxio_dd(Self)) Field Baxio.Baxio_C_Code2 to  lsBaxio_C_Code_2 //(private.Default_Axio_C_Code2((piBAxio_dd(Self))))
43566>>>>>>>>>>>>>//jsjsjs 24/01/2001
43566>>>>>>>>>>>>>     End_Procedure //private.exit_baxiokat_code
43567>>>>>>>>>>>>>
43567>>>>>>>>>>>>>
43567>>>>>>>>>>>>>    //private
43567>>>>>>>>>>>>>    //¡˜¢œå«˜  ˜§æ:
43567>>>>>>>>>>>>>    //©œ«á¨œ : «ž¤ default value to baxiokat_code, ˜¤á¢¦š˜ £œ «¦ btypkin.baxiokat_num
43567>>>>>>>>>>>>>    Procedure private.Entry_Baxiokat_Code Integer liField Integer liBaxiokat_Code
43568>>>>>>>>>>>>>              Integer liBtypkin_dd liBkinkat_Num liBtypkin_Rec0
43569>>>>>>>>>>>>>
43569>>>>>>>>>>>>>        PROCEDURE_RETURN
43570>>>>>>>>>>>>>
43570>>>>>>>>>>>>>
43570>>>>>>>>>>>>>    End_Procedure //private.entry_gtypkin_code
43571>>>>>>>>>>>>>
43571>>>>>>>>>>>>>
43571>>>>>>>>>>>>>
43571>>>>>>>>>>>>>
43571>>>>>>>>>>>>>    Procedure Update
43572>>>>>>>>>>>>>          Forward Send Update
43574>>>>>>>>>>>>>          If (Baxiokat.Baxiokat_Yn5390 = 0);          Begin //œá¤ ›â¤ œå¤˜  £ž®˜¤¦š¨˜­ž£â¤œª œ§ «˜šâª, £ž›â¤ ©œ æ¢˜ «˜ ©®œ« ¡á §œ›å˜
43576>>>>>>>>>>>>>               Move "" to Baxiokat.Baxiokat_Bank
43577>>>>>>>>>>>>>               Move "" to Baxiokat.Baxiokat_Lno
43578>>>>>>>>>>>>>               Move 0  to Baxiokat.Baxiokat_Formul
43579>>>>>>>>>>>>>          End
43579>>>>>>>>>>>>>>
43579>>>>>>>>>>>>>    End_Procedure
43580>>>>>>>>>>>>>
43580>>>>>>>>>>>>>
43580>>>>>>>>>>>>>    Procedure Define_Fields
43581>>>>>>>>>>>>>        Forward Send Define_Fields
43583>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43583>>>>>>>>>>>>>        //DDB-DefineFieldStart
43583>>>>>>>>>>>>>
43583>>>>>>>>>>>>>        Set Main_File            To Baxiokat.File_Number
43584>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
43585>>>>>>>>>>>>>
43585>>>>>>>>>>>>>
43585>>>>>>>>>>>>>        // Child (Client) file structure................
43585>>>>>>>>>>>>>        Send Add_Client_File  Baxio.File_Number
43586>>>>>>>>>>>>>        Send Add_Client_File  Bkinkat.File_Number
43587>>>>>>>>>>>>>        Send Add_Client_File  Tpclient.File_Number
43588>>>>>>>>>>>>>        Send Add_Client_File  Tperga.File_Number
43589>>>>>>>>>>>>>        Send Add_Client_File  Tparticl.File_Number
43590>>>>>>>>>>>>>
43590>>>>>>>>>>>>>        // External (System) file structure.............
43590>>>>>>>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
43591>>>>>>>>>>>>>
43591>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecb.Baxiokat_Rec0  To Baxiokat.Baxiokat_Rec0
43594>>>>>>>>>>>>>
43594>>>>>>>>>>>>>        // Field-based properties.......................
43594>>>>>>>>>>>>>
43594>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Code
43594>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Code To (SL034(Self))
43595>>>>>>>>>>>>>
43595>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Descr
43595>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Descr To (SL034(Self))
43596>>>>>>>>>>>>>
43596>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Rec0
43596>>>>>>>>>>>>>
43596>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Recr
43596>>>>>>>>>>>>>
43596>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Type
43596>>>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Type To (Baxiokat_Type_VT(Self))
43597>>>>>>>>>>>>>
43597>>>>>>>>>>>>>        // Baxiokat.Baxio_Lcode
43597>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Baxiokat.Baxio_Lcode To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ creating/deleting «¦¬ baxio)"
43597>>>>>>>>>>>>>
43597>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Yn5390
43597>>>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Yn5390 To (Baxiokat_Baxiokat_Yn5390_VT(Self))
43598>>>>>>>>>>>>>
43598>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Bank
43598>>>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Bank To (Baxiokat_Baxiokat_Bank_VT(Self))
43599>>>>>>>>>>>>>
43599>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Lno
43599>>>>>>>>>>>>>
43599>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Formul
43599>>>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Formul To (Baxiokat_Baxiokat_Formul_VT(Self))
43600>>>>>>>>>>>>>
43600>>>>>>>>>>>>>        //DDB-DefineFieldEnd
43600>>>>>>>>>>>>>
43600>>>>>>>>>>>>>        Set Main_File            To Baxiokat.File_Number
43601>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
43602>>>>>>>>>>>>>
43602>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
43603>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
43604>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43605>>>>>>>>>>>>>
43605>>>>>>>>>>>>>        // Child (Client) file structure................
43605>>>>>>>>>>>>>        Send Add_Client_File  Baxio.File_Number
43606>>>>>>>>>>>>>        Send Add_Client_File  Bkinkat.File_Number
43607>>>>>>>>>>>>>
43607>>>>>>>>>>>>>        // External (System) file structure.............
43607>>>>>>>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
43608>>>>>>>>>>>>>
43608>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecb.Baxiokat_Rec0  To Baxiokat.Baxiokat_Rec0
43611>>>>>>>>>>>>>
43611>>>>>>>>>>>>>        // Field-based properties.......................
43611>>>>>>>>>>>>>
43611>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Code
43611>>>>>>>>>>>>>        Set Field_Entry_msg        Field Baxiokat.Baxiokat_Code   To private.Entry_Baxiokat_Code
43612>>>>>>>>>>>>>        Set Field_Exit_msg         Field Baxiokat.Baxiokat_Code   To private.Exit_Baxiokat_Code
43613>>>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Code   To "‰à› ¡æª „å›¦¬ª €¥ ¦š¨á­¦¬"
43614>>>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Code   To "„å›¦ª"
43615>>>>>>>>>>>>>        Set Field_Options          Field Baxiokat.Baxiokat_Code   To DD_AUTOFIND    DD_REQUIRED
43616>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Code   To (SL034(Self))
43617>>>>>>>>>>>>>        Set Key_Field_State        Field Baxiokat.Baxiokat_Code   To TRUE
43618>>>>>>>>>>>>>
43618>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Descr
43618>>>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Descr  To "œ¨ š¨˜­ã „å›¦¬ª €¥ ¦š¨á­¦¬"
43619>>>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Descr  To "œ¨ š¨˜­ã"
43620>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Descr  To (SL034(Self))
43621>>>>>>>>>>>>>
43621>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Rec0
43621>>>>>>>>>>>>>        Set Field_Options          Field Baxiokat.Baxiokat_Rec0   To DD_AUTOFIND    DD_REQUIRED
43622>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Rec0   To (SL034(Self))
43623>>>>>>>>>>>>>        Set Key_Field_State        Field Baxiokat.Baxiokat_Rec0   To TRUE
43624>>>>>>>>>>>>>
43624>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Type
43624>>>>>>>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Type   To "dbComboForm_EZ"
43625>>>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Type   To "„ ©§¨˜¡«â¦/¢ž¨à«â¦"
43626>>>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Type   To "„ ©./¢ã¨."
43627>>>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Type   To (Baxiokat_Type_VT(Self))
43628>>>>>>>>>>>>>
43628>>>>>>>>>>>>>        // Baxiokat.Baxio_Lcode
43628>>>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxio_Lcode     To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª €¥ ¦šá­¦¬"
43629>>>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxio_Lcode     To "’œ¢.€¨ Ÿ£æª"
43630>>>>>>>>>>>>>        Set Field_Options          Field Baxiokat.Baxio_Lcode     To DD_DISPLAYONLY
43631>>>>>>>>>>>>>
43631>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Yn5390
43631>>>>>>>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Yn5390 To "dbComboForm_EZ"
43632>>>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Yn5390 To "‹ž®˜¤¦š¨˜­ž£â¤œª „§ «˜šâª ?"
43633>>>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Yn5390 To "‹ž®/¡âª „§ «˜šâª"
43634>>>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Yn5390 To (Baxiokat_Baxiokat_Yn5390_VT(Self))
43635>>>>>>>>>>>>>
43635>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Bank
43635>>>>>>>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Bank   To "dbComboForm_EZ"
43636>>>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Bank   To "’¨á§œ˜"
43637>>>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Bank   To "’¨á§œ˜"
43638>>>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Bank   To (Baxiokat_Baxiokat_Bank_VT(Self))
43639>>>>>>>>>>>>>
43639>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Lno
43639>>>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Lno    To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª"
43640>>>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Lno    To "’œ¢.€¨ Ÿ£æª"
43641>>>>>>>>>>>>>
43641>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Formul
43641>>>>>>>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Formul To "dbComboForm_EZ"
43642>>>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Formul To "€¢šæ¨ Ÿ£¦ª Check Digit"
43643>>>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Formul To "Check Digit"
43644>>>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Formul To (Baxiokat_Baxiokat_Formul_VT(Self))
43645>>>>>>>>>>>>>
43645>>>>>>>>>>>>>    End_Procedure    // Define_Fields
43646>>>>>>>>>>>>>
43646>>>>>>>>>>>>>
43646>>>>>>>>>>>>>    Procedure Field_Defaults
43647>>>>>>>>>>>>>        Forward Send Field_Defaults
43649>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43649>>>>>>>>>>>>>        //DDB-FieldDefaultStart
43649>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
43649>>>>>>>>>>>>>        Set Field_Changed_Value   Field Baxiokat.Baxiokat_Yn5390 To 0
43650>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
43651>>>>>>>>>>>>>
43651>>>>>>>>>>>>>End_Class    // Baxiokat_DataDictionary
43652>>>>>>>>>>>>>//DDB-Selection-pkg-Start
43652>>>>>>>>>>>>>
43652>>>>>>>>>>>>>Use SL034.SL         // SL034
INCLUDING FILE: SL034.SL
43652>>>>>>>>>>>>>>>//AB/ Project SL034:BAXIOKAT
43652>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
43652>>>>>>>>>>>>>>>//AB/     Set ProjectName to "SL034:BAXIOKAT"
43652>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "SL034.SL"
43652>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
43652>>>>>>>>>>>>>>>
43652>>>>>>>>>>>>>>>// Project Object Structure
43652>>>>>>>>>>>>>>>//   SL034 is a dbModalPanelSub
43652>>>>>>>>>>>>>>>//     Baxiokat_DD is a DataDictionary
43652>>>>>>>>>>>>>>>//     oSelList is a dbListSub
43652>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
43652>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
43652>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
43652>>>>>>>>>>>>>>>
43652>>>>>>>>>>>>>>>// Register all objects
43652>>>>>>>>>>>>>>>Register_Object Baxiokat_DD
43652>>>>>>>>>>>>>>>Register_Object oCancel_bn
43652>>>>>>>>>>>>>>>Register_Object oOK_bn
43652>>>>>>>>>>>>>>>Register_Object oSearch_bn
43652>>>>>>>>>>>>>>>Register_Object oSelList
43652>>>>>>>>>>>>>>>Register_Object SL034
43652>>>>>>>>>>>>>>>
43652>>>>>>>>>>>>>>>
43652>>>>>>>>>>>>>>>//AB-IgnoreStart
43652>>>>>>>>>>>>>>>
43652>>>>>>>>>>>>>>>Use DFAllEnt.pkg
43652>>>>>>>>>>>>>>>Use dbList.Sub
43652>>>>>>>>>>>>>>>Use Button.Sub
43652>>>>>>>>>>>>>>>
43652>>>>>>>>>>>>>>>
43652>>>>>>>>>>>>>>>Use BAXIOKAT.DD
43652>>>>>>>>>>>>>>>
43652>>>>>>>>>>>>>>>//AB-IgnoreEnd
43652>>>>>>>>>>>>>>>
43652>>>>>>>>>>>>>>>CD_Popup_Object SL034 is a dbModalPanelSub
43671>>>>>>>>>>>>>>>    set label to "‰˜«žš¦¨åœª €¥ ¦š¨á­à¤" 
43672>>>>>>>>>>>>>>>    Set Size to 206 347
43673>>>>>>>>>>>>>>>    Set Location to 4 5
43674>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
43675>>>>>>>>>>>>>>>    Set Modal_State to FALSE
43676>>>>>>>>>>>>>>>
43676>>>>>>>>>>>>>>>    //AB-DDOStart
43676>>>>>>>>>>>>>>>
43676>>>>>>>>>>>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
43678>>>>>>>>>>>>>>>    End_Object    // Baxiokat_DD
43679>>>>>>>>>>>>>>>
43679>>>>>>>>>>>>>>>    Set Main_DD to (Baxiokat_DD(self))
43680>>>>>>>>>>>>>>>    Set Server to (Baxiokat_DD(self))
43681>>>>>>>>>>>>>>>
43681>>>>>>>>>>>>>>>    //AB-DDOEnd
43681>>>>>>>>>>>>>>>
43681>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
43683>>>>>>>>>>>>>>>        Set Main_File to Baxiokat.File_Number
43684>>>>>>>>>>>>>>>        Set Size to 164 335
43685>>>>>>>>>>>>>>>        Set Location to 5 4
43686>>>>>>>>>>>>>>>
43686>>>>>>>>>>>>>>>        Begin_Row
43689>>>>>>>>>>>>>>>            Entry_Item Baxiokat.Baxiokat_code
43690>>>>>>>>>>>>>>>            Entry_Item Baxiokat.Baxiokat_descr
43691>>>>>>>>>>>>>>>            Entry_Item Baxiokat.Baxiokat_type
43692>>>>>>>>>>>>>>>            Entry_Item (Export_Code_Description(Self,2,Baxiokat.Baxiokat_type))
43693>>>>>>>>>>>>>>>        End_Row
43698>>>>>>>>>>>>>>>
43698>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 55
43699>>>>>>>>>>>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
43700>>>>>>>>>>>>>>>
43700>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 172
43701>>>>>>>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
43702>>>>>>>>>>>>>>>
43702>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 16
43703>>>>>>>>>>>>>>>        set header_label  item 2 to "’ç§¦ª" 
43704>>>>>>>>>>>>>>>
43704>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 83
43705>>>>>>>>>>>>>>>        set header_label  item 3 to "„ ©./¢ž¨." 
43706>>>>>>>>>>>>>>>
43706>>>>>>>>>>>>>>>    End_Object    // oSelList
43707>>>>>>>>>>>>>>>
43707>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
43709>>>>>>>>>>>>>>>        set label to "&„§ ¢¦šã" 
43710>>>>>>>>>>>>>>>        Set Location to 172 180
43711>>>>>>>>>>>>>>>
43711>>>>>>>>>>>>>>>        //AB-StoreStart
43711>>>>>>>>>>>>>>>        Procedure OnClick
43713>>>>>>>>>>>>>>>            Send OK To oSelList
43714>>>>>>>>>>>>>>>        End_Procedure
43715>>>>>>>>>>>>>>>        //AB-StoreEnd
43715>>>>>>>>>>>>>>>
43715>>>>>>>>>>>>>>>    End_Object    // oOK_bn
43716>>>>>>>>>>>>>>>
43716>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
43718>>>>>>>>>>>>>>>        set label to "&€¡ç¨à©ž" 
43719>>>>>>>>>>>>>>>        Set Location to 172 234
43720>>>>>>>>>>>>>>>
43720>>>>>>>>>>>>>>>        //AB-StoreStart
43720>>>>>>>>>>>>>>>        Procedure OnClick
43722>>>>>>>>>>>>>>>            Send Cancel To oSelList
43723>>>>>>>>>>>>>>>        End_Procedure
43724>>>>>>>>>>>>>>>        //AB-StoreEnd
43724>>>>>>>>>>>>>>>
43724>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
43725>>>>>>>>>>>>>>>
43725>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
43727>>>>>>>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
43728>>>>>>>>>>>>>>>        Set Location to 172 289
43729>>>>>>>>>>>>>>>
43729>>>>>>>>>>>>>>>        //AB-StoreStart
43729>>>>>>>>>>>>>>>        Procedure OnClick
43731>>>>>>>>>>>>>>>            Send Search To oSelList
43732>>>>>>>>>>>>>>>        End_Procedure
43733>>>>>>>>>>>>>>>        //AB-StoreEnd
43733>>>>>>>>>>>>>>>
43733>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
43734>>>>>>>>>>>>>>>
43734>>>>>>>>>>>>>>>
43734>>>>>>>>>>>>>>>    //AB-StoreStart
43734>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
43735>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
43736>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
43737>>>>>>>>>>>>>>>    //AB-StoreEnd
43737>>>>>>>>>>>>>>>
43737>>>>>>>>>>>>>>>CD_End_Object    // SL034
43739>>>>>>>>>>>>>>>>
43739>>>>>>>>>>>>>>>
43739>>>>>>>>>>>>>>>//AB/ End_Object    // prj
43739>>>>>>>>>>>>>
43739>>>>>>>>>>>>>//DDB-Selection-pkg-End
43739>>>>>>>>>>>>>//DDB-FileEnd
43739>>>>>>>>>>>    Use SYSCURXR.DD
INCLUDING FILE: SYSCURXR.DD
43739>>>>>>>>>>>>>//DDB-FileStart
43739>>>>>>>>>>>>>//DDB-HeaderStart
43739>>>>>>>>>>>>>
43739>>>>>>>>>>>>>// File Name : SYSCURXR.DD
43739>>>>>>>>>>>>>// Class Name: Syscurxr_DataDictionary
43739>>>>>>>>>>>>>// Revision  : 8
43739>>>>>>>>>>>>>// Version   : 2
43739>>>>>>>>>>>>>
43739>>>>>>>>>>>>>Use  Windows           // Basic Definitions
43739>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
43739>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43739>>>>>>>>>>>>>
43739>>>>>>>>>>>>>Open Syscurxr
43741>>>>>>>>>>>>>
43741>>>>>>>>>>>>>//DDB-HeaderEnd
43741>>>>>>>>>>>>>
43741>>>>>>>>>>>>>Class Syscurxr_DataDictionary  is a DataDictionary_Sec
43742>>>>>>>>>>>>>
43742>>>>>>>>>>>>>    // Define_Fields:
43742>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
43742>>>>>>>>>>>>>
43742>>>>>>>>>>>>>    Procedure Define_Fields
43743>>>>>>>>>>>>>        Forward Send Define_Fields
43745>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43745>>>>>>>>>>>>>        //DDB-DefineFieldStart
43745>>>>>>>>>>>>>
43745>>>>>>>>>>>>>        Set Main_File            To Syscurxr.File_Number
43746>>>>>>>>>>>>>
43746>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
43747>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
43748>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43749>>>>>>>>>>>>>
43749>>>>>>>>>>>>>        // Field-based properties.......................
43749>>>>>>>>>>>>>
43749>>>>>>>>>>>>>        // Syscurxr.Company_Code
43749>>>>>>>>>>>>>
43749>>>>>>>>>>>>>        // Syscurxr.Branch_Code
43749>>>>>>>>>>>>>
43749>>>>>>>>>>>>>        // Syscurxr.Year_Year
43749>>>>>>>>>>>>>
43749>>>>>>>>>>>>>        // Syscurxr.Branch_Site
43749>>>>>>>>>>>>>
43749>>>>>>>>>>>>>        // Syscurxr.Year_Recr
43749>>>>>>>>>>>>>
43749>>>>>>>>>>>>>        // Syscurxr.Company_Name
43749>>>>>>>>>>>>>
43749>>>>>>>>>>>>>        // Syscurxr.Branch_Name
43749>>>>>>>>>>>>>
43749>>>>>>>>>>>>>        // Syscurxr.Year_Descr
43749>>>>>>>>>>>>>
43749>>>>>>>>>>>>>        // Syscurxr.C_Code0
43749>>>>>>>>>>>>>
43749>>>>>>>>>>>>>        // Syscurxr.C_Code00
43749>>>>>>>>>>>>>
43749>>>>>>>>>>>>>        // Syscurxr.C_Coder
43749>>>>>>>>>>>>>
43749>>>>>>>>>>>>>        // Syscurxr.Year_Xrhshfrom
43749>>>>>>>>>>>>>
43749>>>>>>>>>>>>>        // Syscurxr.Year_Xrhshto
43749>>>>>>>>>>>>>
43749>>>>>>>>>>>>>        // Syscurxr.Beto_Site
43749>>>>>>>>>>>>>
43749>>>>>>>>>>>>>        // Syscurxr.Euro_Code
43749>>>>>>>>>>>>>
43749>>>>>>>>>>>>>        //DDB-DefineFieldEnd
43749>>>>>>>>>>>>>    End_Procedure    // Define_Fields
43750>>>>>>>>>>>>>
43750>>>>>>>>>>>>>    // Field_Defaults:
43750>>>>>>>>>>>>>    // This procedure is used to establish default field values.
43750>>>>>>>>>>>>>
43750>>>>>>>>>>>>>    Procedure Field_Defaults
43751>>>>>>>>>>>>>        Forward Send Field_Defaults
43753>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43753>>>>>>>>>>>>>        //DDB-FieldDefaultStart
43753>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
43753>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
43754>>>>>>>>>>>>>
43754>>>>>>>>>>>>>End_Class    // Syscurxr_DataDictionary
43755>>>>>>>>>>>>>//DDB-FileEnd
43755>>>>>>>>>>>    Use PMSSXET.DD
43755>>>>>>>>>>>    Use SALESMEN.DD
INCLUDING FILE: SALESMEN.DD
43755>>>>>>>>>>>>>//DDB-FileStart
43755>>>>>>>>>>>>>//DDB-HeaderStart
43755>>>>>>>>>>>>>
43755>>>>>>>>>>>>>// File Name : SALESMEN.DD
43755>>>>>>>>>>>>>// Class Name: Salesmen_DataDictionary
43755>>>>>>>>>>>>>// Revision  : 57
43755>>>>>>>>>>>>>// Version   : 2
43755>>>>>>>>>>>>>
43755>>>>>>>>>>>>>Use  Windows           // Basic Definitions
43755>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
43755>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43755>>>>>>>>>>>>>
43755>>>>>>>>>>>>>Open Salesmen
43757>>>>>>>>>>>>>Open Cn
43759>>>>>>>>>>>>>Open Sysrecc
43761>>>>>>>>>>>>>
43761>>>>>>>>>>>>>//DDB-HeaderEnd
43761>>>>>>>>>>>>>//DDB-ValidationStart
43761>>>>>>>>>>>>>
43761>>>>>>>>>>>>>Register_Object Salesmen_Sls_Doy_VT
43761>>>>>>>>>>>>>
43761>>>>>>>>>>>>>Object Salesmen_Sls_Doy_VT  is a CodeValidationTable
43763>>>>>>>>>>>>>    Set Type_Value        To "DOY"
43764>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
43765>>>>>>>>>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
43766>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43766>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43766>>>>>>>>>>>>>End_Object   // Salesmen_Sls_Doy_VT
43767>>>>>>>>>>>>>//DDB-ValidationEnd
43767>>>>>>>>>>>>>//DDB-SelectionStart
43767>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl108  sl108.sl
43767>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
43767>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
43767>>>>>>>>>>>>>Register_Object sl108
43767>>>>>>>>>>>>>Register_Object sl198
43767>>>>>>>>>>>>>Register_Object sl197
43767>>>>>>>>>>>>>//DDB-SelectionEnd
43767>>>>>>>>>>>>>
43767>>>>>>>>>>>>>Class Salesmen_DataDictionary  is a DataDictionary_Sec
43768>>>>>>>>>>>>> 
43768>>>>>>>>>>>>>    // Save_Main_File:
43768>>>>>>>>>>>>> 
43768>>>>>>>>>>>>>    Procedure Save_Main_File
43769>>>>>>>>>>>>>        If ((Operation_Origin<>Self) And (Salesmen.Sls_ID='')) Procedure_Return
43772>>>>>>>>>>>>>        Forward Send Save_Main_File
43774>>>>>>>>>>>>>    End_Procedure   // Save_Main_File
43775>>>>>>>>>>>>> 
43775>>>>>>>>>>>>>    // Define_Fields:
43775>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
43775>>>>>>>>>>>>>     Procedure Update
43776>>>>>>>>>>>>>        Forward Send Update
43778>>>>>>>>>>>>>        // Insert Code Here
43778>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to salesmen.Company_Code
43779>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to salesmen.Branch_Code
43780>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to salesmen.Year_Year
43781>>>>>>>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
43781>>>>>>>>>>>>>        Move (salesmen.Xreosh-salesmen.Pistosh)   to salesmen.Ypoloipo
43782>>>>>>>>>>>>>        Move (salesmen.Plafon-salesmen.ypoloipo)  to salesmen.Overhead
43783>>>>>>>>>>>>>
43783>>>>>>>>>>>>>        //Move Clients.Client_Address     to Clients.Client_LastUpd
43783>>>>>>>>>>>>>
43783>>>>>>>>>>>>>        //betolink
43783>>>>>>>>>>>>>        Move SysCurXR.Beto_Site      to salesmen.sls_SiteW
43784>>>>>>>>>>>>>        Move salesmen.sls_Rec0       to salesmen.sls_SN
43785>>>>>>>>>>>>>        Move salesmen.sls_id         to salesmen.sls_Repm
43786>>>>>>>>>>>>>
43786>>>>>>>>>>>>>    End_Procedure   // Update
43787>>>>>>>>>>>>>
43787>>>>>>>>>>>>>     Procedure Creating
43788>>>>>>>>>>>>>        Forward Send Creating
43790>>>>>>>>>>>>>        // Insert Code Here
43790>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(salesmen.sls_Rec0))))));                                    to salesmen.sls_Recr
43791>>>>>>>>>>>>>        Move '1'                    to salesmen.sls_Active
43792>>>>>>>>>>>>>        get fsgCode_With_Zeroes salesmen.sls_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to salesmen.sls_ID
43793>>>>>>>>>>>>>    End_Procedure   // Creating
43794>>>>>>>>>>>>>
43794>>>>>>>>>>>>>    Procedure Define_Fields
43795>>>>>>>>>>>>>        Forward Send Define_Fields
43797>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43797>>>>>>>>>>>>>        //DDB-DefineFieldStart
43797>>>>>>>>>>>>>
43797>>>>>>>>>>>>>        Set Main_File            To Salesmen.File_Number
43798>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
43799>>>>>>>>>>>>>
43799>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
43800>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
43801>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43802>>>>>>>>>>>>>
43802>>>>>>>>>>>>>        // Child (Client) file structure................
43802>>>>>>>>>>>>>        Send Add_Client_File  Cn.File_Number
43803>>>>>>>>>>>>>
43803>>>>>>>>>>>>>        // External (System) file structure.............
43803>>>>>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
43804>>>>>>>>>>>>>
43804>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecc.Salesmen_Rec0  To Salesmen.Sls_Rec0
43807>>>>>>>>>>>>>
43807>>>>>>>>>>>>>        // Field-based properties.......................
43807>>>>>>>>>>>>>
43807>>>>>>>>>>>>>        // Salesmen.Company_Code
43807>>>>>>>>>>>>>
43807>>>>>>>>>>>>>        // Salesmen.Branch_Code
43807>>>>>>>>>>>>>
43807>>>>>>>>>>>>>        // Salesmen.Year_Year
43807>>>>>>>>>>>>>
43807>>>>>>>>>>>>>        // Salesmen.Sls_Id
43807>>>>>>>>>>>>>        Set Field_Options          Field Salesmen.Sls_Id To DD_AUTOFIND    DD_FINDREQ    
43808>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Id To (sl108(Self))
43809>>>>>>>>>>>>>        Set Key_Field_State        Field Salesmen.Sls_Id To TRUE
43810>>>>>>>>>>>>>
43810>>>>>>>>>>>>>        // Salesmen.Sls_Name
43810>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Name To (sl108(Self))
43811>>>>>>>>>>>>>
43811>>>>>>>>>>>>>        // Salesmen.Sls_Afm
43811>>>>>>>>>>>>>
43811>>>>>>>>>>>>>        // Salesmen.Sls_Rec0
43811>>>>>>>>>>>>>
43811>>>>>>>>>>>>>        // Salesmen.Sls_Recr
43811>>>>>>>>>>>>>
43811>>>>>>>>>>>>>        // Salesmen.Last_Xreosh
43811>>>>>>>>>>>>>
43811>>>>>>>>>>>>>        // Salesmen.Last_Pistosh
43811>>>>>>>>>>>>>
43811>>>>>>>>>>>>>        // Salesmen.Last_Order
43811>>>>>>>>>>>>>
43811>>>>>>>>>>>>>        // Salesmen.Sls_Doy
43811>>>>>>>>>>>>>        Set Field_Value_Table      Field Salesmen.Sls_Doy To (Salesmen_Sls_Doy_VT(Self))
43812>>>>>>>>>>>>>
43812>>>>>>>>>>>>>        // Salesmen.Sls_Address
43812>>>>>>>>>>>>>
43812>>>>>>>>>>>>>        // Salesmen.Sls_City
43812>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_City To (sl198(Self))
43813>>>>>>>>>>>>>
43813>>>>>>>>>>>>>        // Salesmen.Sls_Area
43813>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Area To (sl197(Self))
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Sls_Job
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Sls_Respons
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Sls_Zipcode
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Sls_Phone
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Sls_Fax
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Sls_Mobile
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Sls_Aoh
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Sls_Email
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Sls_Class
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Sls_Details
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Sls_Sitew
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Sls_Codem
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Sls_Categfpa
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Sls_Fpa
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Sls_Public
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Sls_Sn
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Sls_Repm
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Sls_Active
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Sls_Reported
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Sls_Lastupd
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Sls_Markexp
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Sls_Catjob
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Xreosh
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Pistosh
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Ypoloipo
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Plafon
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Overhead
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Sls_Add_No
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Sls_Nomos
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Sls_Xora
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        // Salesmen.Polh_Recr
43814>>>>>>>>>>>>>
43814>>>>>>>>>>>>>        //DDB-DefineFieldEnd
43814>>>>>>>>>>>>>    End_Procedure    // Define_Fields
43815>>>>>>>>>>>>>
43815>>>>>>>>>>>>>    // Field_Defaults:
43815>>>>>>>>>>>>>    // This procedure is used to establish default field values.
43815>>>>>>>>>>>>>
43815>>>>>>>>>>>>>    Procedure Field_Defaults
43816>>>>>>>>>>>>>        Forward Send Field_Defaults
43818>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43818>>>>>>>>>>>>>        //DDB-FieldDefaultStart
43818>>>>>>>>>>>>>        Set Field_Changed_Value   Field Salesmen.Sls_Doy To "0"
43819>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
43819>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
43820>>>>>>>>>>>>>
43820>>>>>>>>>>>>>End_Class    // Salesmen_DataDictionary
43821>>>>>>>>>>>>>//DDB-Selection-pkg-Start
43821>>>>>>>>>>>>>
43821>>>>>>>>>>>>>Use sl108.sl         // sl108
INCLUDING FILE: SL108.SL
43821>>>>>>>>>>>>>>>//AB/ Project sl108:polhtes
43821>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
43821>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl108:polhtes"
43821>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl108.SL"
43821>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
43821>>>>>>>>>>>>>>>
43821>>>>>>>>>>>>>>>// Project Object Structure
43821>>>>>>>>>>>>>>>//   sl108 is a dbModalPanelSub
43821>>>>>>>>>>>>>>>//     Salesmen_DD is a DataDictionary
43821>>>>>>>>>>>>>>>//     oSelList is a dbListSub
43821>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
43821>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
43821>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
43821>>>>>>>>>>>>>>>
43821>>>>>>>>>>>>>>>// Register all objects
43821>>>>>>>>>>>>>>>Register_Object oCancel_bn
43821>>>>>>>>>>>>>>>Register_Object oOK_bn
43821>>>>>>>>>>>>>>>Register_Object oSearch_bn
43821>>>>>>>>>>>>>>>Register_Object oSelList
43821>>>>>>>>>>>>>>>Register_Object Salesmen_DD
43821>>>>>>>>>>>>>>>Register_Object sl108
43821>>>>>>>>>>>>>>>
43821>>>>>>>>>>>>>>>
43821>>>>>>>>>>>>>>>//AB-IgnoreStart
43821>>>>>>>>>>>>>>>
43821>>>>>>>>>>>>>>>Use DFAllEnt.pkg
43821>>>>>>>>>>>>>>>Use dbList.Sub
43821>>>>>>>>>>>>>>>Use Button.Sub
43821>>>>>>>>>>>>>>>
43821>>>>>>>>>>>>>>>
43821>>>>>>>>>>>>>>>Use SALESMEN.DD
43821>>>>>>>>>>>>>>>
43821>>>>>>>>>>>>>>>//AB-IgnoreEnd
43821>>>>>>>>>>>>>>>
43821>>>>>>>>>>>>>>>Object sl108 is a dbModalPanelSub
43823>>>>>>>>>>>>>>>    Set Label to "‹ž«¨é¦ à¢ž«é¤"
43824>>>>>>>>>>>>>>>    Set Size to 148 421
43825>>>>>>>>>>>>>>>    Set Location to 4 5
43826>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
43827>>>>>>>>>>>>>>>    Set Modal_State to FALSE
43828>>>>>>>>>>>>>>>
43828>>>>>>>>>>>>>>>    //AB-DDOStart
43828>>>>>>>>>>>>>>>
43828>>>>>>>>>>>>>>>    Object Salesmen_DD is a Salesmen_DataDictionary
43830>>>>>>>>>>>>>>>    End_Object    // Salesmen_DD
43831>>>>>>>>>>>>>>>
43831>>>>>>>>>>>>>>>    Set Main_DD to (Salesmen_DD(self))
43832>>>>>>>>>>>>>>>    Set Server to (Salesmen_DD(self))
43833>>>>>>>>>>>>>>>
43833>>>>>>>>>>>>>>>    //AB-DDOEnd
43833>>>>>>>>>>>>>>>
43833>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
43835>>>>>>>>>>>>>>>        Set Main_File to Salesmen.File_Number
43836>>>>>>>>>>>>>>>        Set Size to 105 408
43837>>>>>>>>>>>>>>>        Set Location to 6 6
43838>>>>>>>>>>>>>>>
43838>>>>>>>>>>>>>>>        Begin_Row
43841>>>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_id
43842>>>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_name
43843>>>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_afm
43844>>>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_address
43845>>>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_phone
43846>>>>>>>>>>>>>>>        End_Row
43851>>>>>>>>>>>>>>>
43851>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 60
43852>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
43853>>>>>>>>>>>>>>>        
43853>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 100
43854>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
43855>>>>>>>>>>>>>>>        
43855>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 60
43856>>>>>>>>>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
43857>>>>>>>>>>>>>>>        
43857>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 125
43858>>>>>>>>>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
43859>>>>>>>>>>>>>>>        
43859>>>>>>>>>>>>>>>        Set Form_Width    item 4 to 54
43860>>>>>>>>>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
43861>>>>>>>>>>>>>>>        
43861>>>>>>>>>>>>>>>    End_Object    // oSelList
43862>>>>>>>>>>>>>>>
43862>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
43864>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
43865>>>>>>>>>>>>>>>        Set Location to 117 255
43866>>>>>>>>>>>>>>>
43866>>>>>>>>>>>>>>>        //AB-StoreStart
43866>>>>>>>>>>>>>>>        Procedure OnClick
43868>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
43869>>>>>>>>>>>>>>>        End_Procedure
43870>>>>>>>>>>>>>>>        //AB-StoreEnd
43870>>>>>>>>>>>>>>>
43870>>>>>>>>>>>>>>>    End_Object    // oOK_bn
43871>>>>>>>>>>>>>>>
43871>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
43873>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
43874>>>>>>>>>>>>>>>        Set Location to 117 310
43875>>>>>>>>>>>>>>>
43875>>>>>>>>>>>>>>>        //AB-StoreStart
43875>>>>>>>>>>>>>>>        Procedure OnClick
43877>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
43878>>>>>>>>>>>>>>>        End_Procedure
43879>>>>>>>>>>>>>>>        //AB-StoreEnd
43879>>>>>>>>>>>>>>>
43879>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
43880>>>>>>>>>>>>>>>
43880>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
43882>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
43883>>>>>>>>>>>>>>>        Set Location to 117 365
43884>>>>>>>>>>>>>>>
43884>>>>>>>>>>>>>>>        //AB-StoreStart
43884>>>>>>>>>>>>>>>        Procedure OnClick
43886>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
43887>>>>>>>>>>>>>>>        End_Procedure
43888>>>>>>>>>>>>>>>        //AB-StoreEnd
43888>>>>>>>>>>>>>>>
43888>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
43889>>>>>>>>>>>>>>>
43889>>>>>>>>>>>>>>>
43889>>>>>>>>>>>>>>>    //AB-StoreStart
43889>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
43890>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
43891>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
43892>>>>>>>>>>>>>>>    //AB-StoreEnd
43892>>>>>>>>>>>>>>>
43892>>>>>>>>>>>>>>>End_Object    // sl108
43893>>>>>>>>>>>>>>>
43893>>>>>>>>>>>>>>>//AB/ End_Object    // prj
43893>>>>>>>>>>>>>Use sl198.sl         // sl198
43893>>>>>>>>>>>>>Use sl197.SL         // sl197
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>//DDB-Selection-pkg-End
43893>>>>>>>>>>>>>//DDB-FileEnd
43893>>>>>>>>>>>    Use CONSTRCT.DD
INCLUDING FILE: CONSTRCT.DD
43893>>>>>>>>>>>>>//DDB-FileStart
43893>>>>>>>>>>>>>//DDB-HeaderStart
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>// File Name : CONSTRCT.DD
43893>>>>>>>>>>>>>// Class Name: Constrct_DataDictionary
43893>>>>>>>>>>>>>// Revision  : 48
43893>>>>>>>>>>>>>// Version   : 2
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>Use  Windows           // Basic Definitions
43893>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
43893>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>Open Constrct
43895>>>>>>>>>>>>>Open Cn
43897>>>>>>>>>>>>>Open Sysrecc
43899>>>>>>>>>>>>>
43899>>>>>>>>>>>>>//DDB-HeaderEnd
43899>>>>>>>>>>>>>//DDB-ValidationStart
43899>>>>>>>>>>>>>
43899>>>>>>>>>>>>>Register_Object Constrct_Cnt_Doy_VT1
43899>>>>>>>>>>>>>
43899>>>>>>>>>>>>>Object Constrct_Cnt_Doy_VT1  is a CodeValidationTable
43901>>>>>>>>>>>>>    Set Type_Value        To "DOY"
43902>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
43903>>>>>>>>>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
43904>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43904>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43904>>>>>>>>>>>>>End_Object   // Constrct_Cnt_Doy_VT1
43905>>>>>>>>>>>>>//DDB-ValidationEnd
43905>>>>>>>>>>>>>//DDB-SelectionStart
43905>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl109  sl109.SL
43905>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
43905>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
43905>>>>>>>>>>>>>Register_Object sl109
43905>>>>>>>>>>>>>Register_Object sl198
43905>>>>>>>>>>>>>Register_Object sl197
43905>>>>>>>>>>>>>//DDB-SelectionEnd
43905>>>>>>>>>>>>>
43905>>>>>>>>>>>>>Class Constrct_DataDictionary  is a DataDictionary_Sec
43906>>>>>>>>>>>>>
43906>>>>>>>>>>>>>
43906>>>>>>>>>>>>>
43906>>>>>>>>>>>>>    Procedure Update
43907>>>>>>>>>>>>>        Forward Send Update
43909>>>>>>>>>>>>>        // Insert Code Here
43909>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to constrct.Company_Code
43910>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to constrct.Branch_Code
43911>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to constrct.Year_Year
43912>>>>>>>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
43912>>>>>>>>>>>>>        Move (constrct.Xreosh-Constrct.Pistosh)   to Constrct.Ypoloipo
43913>>>>>>>>>>>>>        Move (constrct.Plafon-Constrct.Ypoloipo)  to Constrct.Overhead
43914>>>>>>>>>>>>>
43914>>>>>>>>>>>>>        //betolink
43914>>>>>>>>>>>>>        Move SysCurXR.Beto_Site      to Constrct.cnt_SiteW
43915>>>>>>>>>>>>>        Move Constrct.cnt_Rec0        to Constrct.cnt_SN
43916>>>>>>>>>>>>>        Move Constrct.cnt_id          to constrct.cnt_Repm
43917>>>>>>>>>>>>>
43917>>>>>>>>>>>>>    End_Procedure   // Update
43918>>>>>>>>>>>>>
43918>>>>>>>>>>>>>     Procedure Creating
43919>>>>>>>>>>>>>        Forward Send Creating
43921>>>>>>>>>>>>>        // Insert Code Here
43921>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Constrct.cnt_Rec0))))));                                    to Constrct.Cnt_Recr
43922>>>>>>>>>>>>>        Move '1'                    to Constrct.Cnt_Active
43923>>>>>>>>>>>>>        Get fsgCode_With_Zeroes Constrct.Cnt_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to Constrct.cnt_ID
43924>>>>>>>>>>>>>    End_Procedure   // Creating
43925>>>>>>>>>>>>>
43925>>>>>>>>>>>>>
43925>>>>>>>>>>>>>    Procedure Define_Fields
43926>>>>>>>>>>>>>        Forward Send Define_Fields
43928>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43928>>>>>>>>>>>>>        //DDB-DefineFieldStart
43928>>>>>>>>>>>>>
43928>>>>>>>>>>>>>        Set Main_File            To Constrct.File_Number
43929>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
43930>>>>>>>>>>>>>
43930>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
43931>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
43932>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43933>>>>>>>>>>>>>
43933>>>>>>>>>>>>>        // Child (Client) file structure................
43933>>>>>>>>>>>>>        Send Add_Client_File  Cn.File_Number
43934>>>>>>>>>>>>>
43934>>>>>>>>>>>>>        // External (System) file structure.............
43934>>>>>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
43935>>>>>>>>>>>>>
43935>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecc.Constrct_Rec0  To Constrct.Cnt_Rec0
43938>>>>>>>>>>>>>
43938>>>>>>>>>>>>>        // Field-based properties.......................
43938>>>>>>>>>>>>>
43938>>>>>>>>>>>>>        // Constrct.Company_Code
43938>>>>>>>>>>>>>
43938>>>>>>>>>>>>>        // Constrct.Branch_Code
43938>>>>>>>>>>>>>
43938>>>>>>>>>>>>>        // Constrct.Year_Year
43938>>>>>>>>>>>>>
43938>>>>>>>>>>>>>        // Constrct.Cnt_Id
43938>>>>>>>>>>>>>        Set Field_Options          Field Constrct.Cnt_Id To DD_AUTOFIND    DD_NOPUT      
43939>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_Id To (sl109(Self))
43940>>>>>>>>>>>>>        Set Key_Field_State        Field Constrct.Cnt_Id To TRUE
43941>>>>>>>>>>>>>
43941>>>>>>>>>>>>>        // Constrct.Cnt_Name
43941>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_Name To (sl109(Self))
43942>>>>>>>>>>>>>
43942>>>>>>>>>>>>>        // Constrct.Cnt_Afm
43942>>>>>>>>>>>>>
43942>>>>>>>>>>>>>        // Constrct.Cnt_Rec0
43942>>>>>>>>>>>>>
43942>>>>>>>>>>>>>        // Constrct.Cnt_Recr
43942>>>>>>>>>>>>>
43942>>>>>>>>>>>>>        // Constrct.Last_Xreosh
43942>>>>>>>>>>>>>
43942>>>>>>>>>>>>>        // Constrct.Last_Pistosh
43942>>>>>>>>>>>>>
43942>>>>>>>>>>>>>        // Constrct.Last_Order
43942>>>>>>>>>>>>>
43942>>>>>>>>>>>>>        // Constrct.Cnt_Doy
43942>>>>>>>>>>>>>        Set Field_Value_Table      Field Constrct.Cnt_Doy To (Constrct_Cnt_Doy_VT1(Self))
43943>>>>>>>>>>>>>
43943>>>>>>>>>>>>>        // Constrct.Cnt_Address
43943>>>>>>>>>>>>>
43943>>>>>>>>>>>>>        // Constrct.Cnt_City
43943>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_City To (sl198(Self))
43944>>>>>>>>>>>>>
43944>>>>>>>>>>>>>        // Constrct.Cnt_Area
43944>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_Area To (sl197(Self))
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Cnt_Job
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Cnt_Respons
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Cnt_Zipcode
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Cnt_Phone
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Cnt_Fax
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Cnt_Mobile
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Cnt_Aoh
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Cnt_Email
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Cnt_Class
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Cnt_Details
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Cnt_Sitew
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Cnt_Codem
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Cnt_Categfpa
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Cnt_Fpa
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Cnt_Public
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Cnt_Sn
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Cnt_Repm
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Cnt_Active
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Cnt_Reported
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Cnt_Pelprom
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Cnt_Lastupdated
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Cnt_Markexp
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Cnt_Catjob
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Xreosh
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Pistosh
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Ypoloipo
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Plafon
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Overhead
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Cnt_Add_No
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Cnt_Nomos
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Cnt_Xora
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        // Constrct.Polh_Recr
43945>>>>>>>>>>>>>
43945>>>>>>>>>>>>>        //DDB-DefineFieldEnd
43945>>>>>>>>>>>>>    End_Procedure    // Define_Fields
43946>>>>>>>>>>>>>
43946>>>>>>>>>>>>>    // Field_Defaults:
43946>>>>>>>>>>>>>    // This procedure is used to establish default field values.
43946>>>>>>>>>>>>>
43946>>>>>>>>>>>>>    Procedure Field_Defaults
43947>>>>>>>>>>>>>        Forward Send Field_Defaults
43949>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43949>>>>>>>>>>>>>        //DDB-FieldDefaultStart
43949>>>>>>>>>>>>>        Set Field_Changed_Value   Field Constrct.Cnt_Doy To "0"
43950>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
43950>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
43951>>>>>>>>>>>>>
43951>>>>>>>>>>>>>End_Class    // Constrct_DataDictionary
43952>>>>>>>>>>>>>//DDB-Selection-pkg-Start
43952>>>>>>>>>>>>>
43952>>>>>>>>>>>>>Use sl109.SL         // sl109
INCLUDING FILE: SL109.SL
43952>>>>>>>>>>>>>>>//AB/ Project sl109
43952>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
43952>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl109"
43952>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl109.SL"
43952>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
43952>>>>>>>>>>>>>>>
43952>>>>>>>>>>>>>>>// Project Object Structure
43952>>>>>>>>>>>>>>>//   sl109 is a dbModalPanelSub
43952>>>>>>>>>>>>>>>//     Constrct_DD is a DataDictionary
43952>>>>>>>>>>>>>>>//     oSelList is a dbListSub
43952>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
43952>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
43952>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
43952>>>>>>>>>>>>>>>
43952>>>>>>>>>>>>>>>// Register all objects
43952>>>>>>>>>>>>>>>Register_Object Constrct_DD
43952>>>>>>>>>>>>>>>Register_Object oCancel_bn
43952>>>>>>>>>>>>>>>Register_Object oOK_bn
43952>>>>>>>>>>>>>>>Register_Object oSearch_bn
43952>>>>>>>>>>>>>>>Register_Object oSelList
43952>>>>>>>>>>>>>>>Register_Object sl109
43952>>>>>>>>>>>>>>>
43952>>>>>>>>>>>>>>>
43952>>>>>>>>>>>>>>>//AB-IgnoreStart
43952>>>>>>>>>>>>>>>
43952>>>>>>>>>>>>>>>Use DFAllEnt.pkg
43952>>>>>>>>>>>>>>>Use dbList.Sub
43952>>>>>>>>>>>>>>>Use Button.Sub
43952>>>>>>>>>>>>>>>
43952>>>>>>>>>>>>>>>
43952>>>>>>>>>>>>>>>Use CONSTRCT.DD
43952>>>>>>>>>>>>>>>
43952>>>>>>>>>>>>>>>//AB-IgnoreEnd
43952>>>>>>>>>>>>>>>
43952>>>>>>>>>>>>>>>Object sl109 is a dbModalPanelSub
43954>>>>>>>>>>>>>>>    Set Label to "„¨š¦¢á™¦  "
43955>>>>>>>>>>>>>>>    Set Size to 148 427
43956>>>>>>>>>>>>>>>    Set Location to 4 5
43957>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
43958>>>>>>>>>>>>>>>    Set Modal_State to FALSE
43959>>>>>>>>>>>>>>>
43959>>>>>>>>>>>>>>>    //AB-DDOStart
43959>>>>>>>>>>>>>>>
43959>>>>>>>>>>>>>>>    Object Constrct_DD is a Constrct_DataDictionary
43961>>>>>>>>>>>>>>>    End_Object    // Constrct_DD
43962>>>>>>>>>>>>>>>
43962>>>>>>>>>>>>>>>    Set Main_DD to (Constrct_DD(self))
43963>>>>>>>>>>>>>>>    Set Server to (Constrct_DD(self))
43964>>>>>>>>>>>>>>>
43964>>>>>>>>>>>>>>>    //AB-DDOEnd
43964>>>>>>>>>>>>>>>
43964>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
43966>>>>>>>>>>>>>>>        Set Main_File to Constrct.File_Number
43967>>>>>>>>>>>>>>>        Set Size to 105 415
43968>>>>>>>>>>>>>>>        Set Location to 6 6
43969>>>>>>>>>>>>>>>
43969>>>>>>>>>>>>>>>        Begin_Row
43972>>>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_id
43973>>>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_name
43974>>>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_afm
43975>>>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_address
43976>>>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_phone
43977>>>>>>>>>>>>>>>        End_Row
43982>>>>>>>>>>>>>>>
43982>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 70
43983>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
43984>>>>>>>>>>>>>>>        
43984>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 100
43985>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
43986>>>>>>>>>>>>>>>        
43986>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 50
43987>>>>>>>>>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
43988>>>>>>>>>>>>>>>        
43988>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 135
43989>>>>>>>>>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
43990>>>>>>>>>>>>>>>        
43990>>>>>>>>>>>>>>>        Set Form_Width    item 4 to 52
43991>>>>>>>>>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
43992>>>>>>>>>>>>>>>        
43992>>>>>>>>>>>>>>>    End_Object    // oSelList
43993>>>>>>>>>>>>>>>
43993>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
43995>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
43996>>>>>>>>>>>>>>>        Set Location to 116 261
43997>>>>>>>>>>>>>>>
43997>>>>>>>>>>>>>>>        //AB-StoreStart
43997>>>>>>>>>>>>>>>        Procedure OnClick
43999>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
44000>>>>>>>>>>>>>>>        End_Procedure
44001>>>>>>>>>>>>>>>        //AB-StoreEnd
44001>>>>>>>>>>>>>>>
44001>>>>>>>>>>>>>>>    End_Object    // oOK_bn
44002>>>>>>>>>>>>>>>
44002>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
44004>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
44005>>>>>>>>>>>>>>>        Set Location to 116 315
44006>>>>>>>>>>>>>>>
44006>>>>>>>>>>>>>>>        //AB-StoreStart
44006>>>>>>>>>>>>>>>        Procedure OnClick
44008>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
44009>>>>>>>>>>>>>>>        End_Procedure
44010>>>>>>>>>>>>>>>        //AB-StoreEnd
44010>>>>>>>>>>>>>>>
44010>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
44011>>>>>>>>>>>>>>>
44011>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
44013>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
44014>>>>>>>>>>>>>>>        Set Location to 116 371
44015>>>>>>>>>>>>>>>
44015>>>>>>>>>>>>>>>        //AB-StoreStart
44015>>>>>>>>>>>>>>>        Procedure OnClick
44017>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
44018>>>>>>>>>>>>>>>        End_Procedure
44019>>>>>>>>>>>>>>>        //AB-StoreEnd
44019>>>>>>>>>>>>>>>
44019>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
44020>>>>>>>>>>>>>>>
44020>>>>>>>>>>>>>>>
44020>>>>>>>>>>>>>>>    //AB-StoreStart
44020>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
44021>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
44022>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
44023>>>>>>>>>>>>>>>    //AB-StoreEnd
44023>>>>>>>>>>>>>>>
44023>>>>>>>>>>>>>>>End_Object    // sl109
44024>>>>>>>>>>>>>>>
44024>>>>>>>>>>>>>>>//AB/ End_Object    // prj
44024>>>>>>>>>>>>>Use sl198.sl         // sl198
44024>>>>>>>>>>>>>Use sl197.SL         // sl197
44024>>>>>>>>>>>>>
44024>>>>>>>>>>>>>//DDB-Selection-pkg-End
44024>>>>>>>>>>>>>//DDB-FileEnd
44024>>>>>>>>>>>    Use CN.DD
44024>>>>>>>>>>>    Use PSXETIKA.DD
INCLUDING FILE: PSXETIKA.DD
44024>>>>>>>>>>>>>//DDB-FileStart
44024>>>>>>>>>>>>>//DDB-HeaderStart
44024>>>>>>>>>>>>>
44024>>>>>>>>>>>>>// File Name : PSXETIKA.DD
44024>>>>>>>>>>>>>// Class Name: Psxetika_DataDictionary
44024>>>>>>>>>>>>>// Revision  : 14
44024>>>>>>>>>>>>>// Version   : 2
44024>>>>>>>>>>>>>
44024>>>>>>>>>>>>>Use  Windows           // Basic Definitions
44024>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
44024>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
44024>>>>>>>>>>>>>
44024>>>>>>>>>>>>>Open Psxetika
44026>>>>>>>>>>>>>Open Particle
44028>>>>>>>>>>>>>Open Sysrecp
44030>>>>>>>>>>>>>
44030>>>>>>>>>>>>>//DDB-HeaderEnd
44030>>>>>>>>>>>>>
44030>>>>>>>>>>>>>Class Psxetika_DataDictionary  is a DataDictionary_Sec
44031>>>>>>>>>>>>>    
44031>>>>>>>>>>>>>    Procedure Creating
44032>>>>>>>>>>>>>        Integer iNextNo
44033>>>>>>>>>>>>>        Forward Send Creating
44035>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Psxetika.Psxetika_Rec0)))))) to Psxetika.Psxetika_Recr
44036>>>>>>>>>>>>>    End_Procedure   // Creating
44037>>>>>>>>>>>>>
44037>>>>>>>>>>>>>    Procedure Update
44038>>>>>>>>>>>>>        Forward Send Update
44040>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to Psxetika.Company_Code
44041>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Psxetika.Branch_Code
44042>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to Psxetika.Year_Year
44043>>>>>>>>>>>>>        Move Clients.Client_ID      to Psxetika.Client_ID
44044>>>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code   to Psxetika.Ctypkin_Code
44045>>>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code   to Psxetika.Wtypkin_Code
44046>>>>>>>>>>>>>        Move Ptyppar.Ptyppar_Code   to Psxetika.Ptyppar_Code
44047>>>>>>>>>>>>>        Move Particle.Partl_Hmnia   to Psxetika.Partl_Hmnia
44048>>>>>>>>>>>>>        Move Pseira.Pseira_Seira    to Psxetika.Pseira_Seira
44049>>>>>>>>>>>>>        Move Particle.Partl_No      to Psxetika.Partl_No
44050>>>>>>>>>>>>>    End_Procedure   // Update
44051>>>>>>>>>>>>>
44051>>>>>>>>>>>>>
44051>>>>>>>>>>>>>    Procedure Request_Save
44052>>>>>>>>>>>>>        Number  nQty
44053>>>>>>>>>>>>>        String  sParticleRecr sPsxetikaRecr
44053>>>>>>>>>>>>>
44053>>>>>>>>>>>>>        Forward Send Request_Save
44055>>>>>>>>>>>>>
44055>>>>>>>>>>>>>        Get File_Field_Current_Value File_Field Particle.Partl_Recr     to sParticleRecr
44056>>>>>>>>>>>>>        Get File_Field_Current_Value File_Field Psxetika.Psx_Partl_Recr to sPsxetikaRecr
44057>>>>>>>>>>>>>        If ((Trim(sParticleRecr)<>'') And (Trim(sPsxetikaRecr)<>'')) Begin
44059>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Psxetika.Pms_Sx_Qty to nQty
44060>>>>>>>>>>>>>            If (nQty=0) Begin
44062>>>>>>>>>>>>>                // An h posothta pou menei apo to athroisma posothtas ton Pmoves Sxetika
44062>>>>>>>>>>>>>                // Mhdenisei, ayto shmainei pos den yparxoun alla Pmoves Sxetika, ara
44062>>>>>>>>>>>>>                // prepei na diagrafei ayto to Psxetika record kai to antistrofo tou.
44062>>>>>>>>>>>>>                Delete Psxetika
44063>>>>>>>>>>>>>                Clear Psxetika
44064>>>>>>>>>>>>>                Move sPsxetikaRecr  to Psxetika.Partl_Recr
44065>>>>>>>>>>>>>                Move sParticleRecr  to Psxetika.Psx_Partl_Recr
44066>>>>>>>>>>>>>                Find Eq Psxetika by Index.4
44067>>>>>>>>>>>>>>
44067>>>>>>>>>>>>>                If (Found) Delete Psxetika
44070>>>>>>>>>>>>>            End
44070>>>>>>>>>>>>>>
44070>>>>>>>>>>>>>        End
44070>>>>>>>>>>>>>>
44070>>>>>>>>>>>>>    End_Procedure
44071>>>>>>>>>>>>>
44071>>>>>>>>>>>>>
44071>>>>>>>>>>>>>    // Define_Fields:
44071>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
44071>>>>>>>>>>>>>
44071>>>>>>>>>>>>>    Procedure Define_Fields
44072>>>>>>>>>>>>>        Forward Send Define_Fields
44074>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44074>>>>>>>>>>>>>        //DDB-DefineFieldStart
44074>>>>>>>>>>>>>
44074>>>>>>>>>>>>>        Set Main_File            To Psxetika.File_Number
44075>>>>>>>>>>>>>
44075>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
44076>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
44077>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
44078>>>>>>>>>>>>>
44078>>>>>>>>>>>>>        // Parent (Server) file structure...............
44078>>>>>>>>>>>>>        Send Add_Server_File  Particle.File_Number
44079>>>>>>>>>>>>>
44079>>>>>>>>>>>>>        // External (System) file structure.............
44079>>>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
44080>>>>>>>>>>>>>
44080>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Psxetika_Rec0  To Psxetika.Psxetika_Rec0
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Field-based properties.......................
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Company_Code
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Branch_Code
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Year_Year
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Ctypkin_Code
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Wtypkin_Code
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Ptyppar_Code
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Pseira_Seira
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Custprom_Code
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Client_Id
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Partl_No
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Partl_Hmnia
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Partl_Recr
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Psx_Partl_Recr
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Psxetika_Recr
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Psxetika_Rec0
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Sx_Company_Code
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Sx_Branch_Code
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Sx_Year_Year
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Sx_Ctypkin_Code
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Sx_Wtypkin_Code
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Sx_Ptyppar_Code
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Sx_Pseira_Seira
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Sx_Custpromcode
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Sx_Client_Id
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Sx_Partl_No
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Sx_Partl_Hmnia
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Sx_Ctypkin_Desc
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Sx_Wtypkin_Desc
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Sx_Ptyppar_Desc
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Sx_Custpromdesc
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Sx_Client_Desc
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        // Psxetika.Pms_Sx_Qty
44083>>>>>>>>>>>>>
44083>>>>>>>>>>>>>        //DDB-DefineFieldEnd
44083>>>>>>>>>>>>>    End_Procedure    // Define_Fields
44084>>>>>>>>>>>>>
44084>>>>>>>>>>>>>    // Field_Defaults:
44084>>>>>>>>>>>>>    // This procedure is used to establish default field values.
44084>>>>>>>>>>>>>
44084>>>>>>>>>>>>>    Procedure Field_Defaults
44085>>>>>>>>>>>>>        Forward Send Field_Defaults
44087>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44087>>>>>>>>>>>>>        //DDB-FieldDefaultStart
44087>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
44087>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
44088>>>>>>>>>>>>>
44088>>>>>>>>>>>>>End_Class    // Psxetika_DataDictionary
44089>>>>>>>>>>>>>//DDB-FileEnd
44089>>>>>>>>>>>    Use TPARTICL.DD
INCLUDING FILE: TPARTICL.DD
44089>>>>>>>>>>>>>//DDB-FileStart
44089>>>>>>>>>>>>>//DDB-HeaderStart
44089>>>>>>>>>>>>>
44089>>>>>>>>>>>>>// File Name : TPARTICL.DD
44089>>>>>>>>>>>>>// Class Name: Tparticl_DataDictionary
44089>>>>>>>>>>>>>// Revision  : 27
44089>>>>>>>>>>>>>// Version   : 2
44089>>>>>>>>>>>>>
44089>>>>>>>>>>>>>Use  Windows           // Basic Definitions
44089>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
44089>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
44089>>>>>>>>>>>>>
44089>>>>>>>>>>>>>Open Tparticl
44091>>>>>>>>>>>>>Open Particle
44093>>>>>>>>>>>>>Open Baxiokat
44095>>>>>>>>>>>>>Open Sysrecc
44097>>>>>>>>>>>>>
44097>>>>>>>>>>>>>//DDB-HeaderEnd
44097>>>>>>>>>>>>>//DDB-ValidationStart
44097>>>>>>>>>>>>>
44097>>>>>>>>>>>>>Register_Object Mera_Tou_Mhna_VT
44097>>>>>>>>>>>>>
44097>>>>>>>>>>>>>Object Mera_Tou_Mhna_VT  is a CodeValidationTable
44099>>>>>>>>>>>>>    Set Type_Value        To "HMERES"
44100>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
44101>>>>>>>>>>>>>    //DDB-ValidationCustomStart
44101>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
44101>>>>>>>>>>>>>End_Object   // Mera_Tou_Mhna_VT
44102>>>>>>>>>>>>>//DDB-ValidationEnd
44102>>>>>>>>>>>>>
44102>>>>>>>>>>>>>Class Tparticl_DataDictionary  is a DataDictionary_Sec
44103>>>>>>>>>>>>>
44103>>>>>>>>>>>>>    Procedure Construct_Object
44104>>>>>>>>>>>>>        Forward Send Construct_Object
44106>>>>>>>>>>>>>        Property Integer piParticleID Public 0
44107>>>>>>>>>>>>>        Property Integer piBaxiokatID Public 0
44108>>>>>>>>>>>>>    End_Procedure
44109>>>>>>>>>>>>>
44109>>>>>>>>>>>>>    Procedure End_Construct_Object
44110>>>>>>>>>>>>>        Integer iID
44111>>>>>>>>>>>>>        Forward Send End_Construct_Object
44113>>>>>>>>>>>>>        Move (Find_Server_DDO(Self,Particle.File_Number )) to iID
44114>>>>>>>>>>>>>        Set piParticleID to iID
44115>>>>>>>>>>>>>        Move (Find_Server_DDO(Self,Baxiokat.File_Number )) to iID
44116>>>>>>>>>>>>>        Set piBaxiokatID to iID
44117>>>>>>>>>>>>>    End_Procedure
44118>>>>>>>>>>>>>
44118>>>>>>>>>>>>>    Procedure Calc_All_The_Fields
44119>>>>>>>>>>>>>        Number  nSynolo nPoso nPososto naxia
44120>>>>>>>>>>>>>        Date    dHmniaPlhromhs dHmniaParalabhs dHmniaTimologiou
44120>>>>>>>>>>>>>        Date    dProkeiptei dProsDate dAddDate dStartDate dEndDate
44120>>>>>>>>>>>>>        Integer iMeresXaritos iMeratouMhna iMeresParalabhs iID iInt iAdd
44120>>>>>>>>>>>>>        Integer iMeresPlhroteo iCode iXhmero iMhnasTimologiou  iMet
44120>>>>>>>>>>>>>
44120>>>>>>>>>>>>>        Get piBaxiokatID                                                to iID
44121>>>>>>>>>>>>>        Get Field_Current_Value Of iID Field Baxiokat.Baxiokat_Code     to iCode
44122>>>>>>>>>>>>>
44122>>>>>>>>>>>>>
44122>>>>>>>>>>>>>        Get piParticleID                                                to iID
44123>>>>>>>>>>>>>        Get Field_Current_Value Of iID Field Particle.Partl_Payam       to nSynolo
44124>>>>>>>>>>>>>        Get Field_Current_Value Of iID Field Particle.Partl_Hmnia       to dHmniaTimologiou
44125>>>>>>>>>>>>>        Get Field_Current_Value        Field TParticl.Pct_Epi_Synolou   to nPososto
44126>>>>>>>>>>>>>        Get Field_Current_Value        Field TParticl.Paralabh_Meres    to iMeresParalabhs
44127>>>>>>>>>>>>>        Get Field_Current_Value        Field TParticl.Xarhtos_Meres     to iMeresXaritos
44128>>>>>>>>>>>>>        Get Field_Current_Value        Field TParticl.Plhroteo_Meres    to iMeresPlhroteo
44129>>>>>>>>>>>>>
44129>>>>>>>>>>>>>        //////////////////////////////////////////////////////////////////////////
44129>>>>>>>>>>>>>        /////        10 (x)     -      10 (y)         /          30 (z)      /////
44129>>>>>>>>>>>>>        /////  iMeresParalabhs    iMeresXaritos              iMeresPlhroteo  /////
44129>>>>>>>>>>>>>        //////////////////////////////////////////////////////////////////////////
44129>>>>>>>>>>>>>
44129>>>>>>>>>>>>>        //  1. Kathorise thn 1h tou mhna, hmeromhniaka
44129>>>>>>>>>>>>>        Move ('01'+'/'+(String(TheMonthSegment(dHmniaTimologiou)))+'/'+;                       (String(TheYearSegment(dHmniaTimologiou)))) to dStartDate
44130>>>>>>>>>>>>>
44130>>>>>>>>>>>>>//        //  2. Vres thn Hmeromhnia paralabhs (Teleytaia hmera tou epomenou y hmerou
44130>>>>>>>>>>>>>//        //     sthn opoia meta tha prosthesoume tis hmeres paralabhs (x) )
44130>>>>>>>>>>>>>//        Move dStartDate to dHmniaParalabhs
44130>>>>>>>>>>>>>//        While (dHmniaParalabhs<(dHmniaTimologiou+iMeresXaritos))
44130>>>>>>>>>>>>>//            Add iMeresXaritos to dHmniaParalabhs
44130>>>>>>>>>>>>>//        Loop
44130>>>>>>>>>>>>>//        Add iMeresParalabhs to dHmniaParalabhs
44130>>>>>>>>>>>>>
44130>>>>>>>>>>>>>//        //  3. Vres thn Hmeromhnia Lhxhs ths epitaghs  (Teleytaia hmera tou trxontos y hmerou
44130>>>>>>>>>>>>>//        //     sthn opoia meta tha prosthesoume tis hmeres plhroteo (z) )
44130>>>>>>>>>>>>>//        Move dStartDate to dHmniaPlhromhs
44130>>>>>>>>>>>>>//        While (dHmniaPlhromhs<dHmniaTimologiou)
44130>>>>>>>>>>>>>//            Add iMeresXaritos to dHmniaPlhromhs
44130>>>>>>>>>>>>>//        Loop
44130>>>>>>>>>>>>>//        Add iMeresPlhroteo  to dHmniaPlhromhs
44130>>>>>>>>>>>>>
44130>>>>>>>>>>>>>        //  2. Vres thn Hmeromhnia  ths teleytaias hmera tou trexontos y hmerou
44130>>>>>>>>>>>>>        Move dStartDate to dHmniaParalabhs
44131>>>>>>>>>>>>>        If (iMeresXaritos<>0) Begin
44133>>>>>>>>>>>>>            While (dHmniaParalabhs<dHmniaTimologiou)
44137>>>>>>>>>>>>>                Add iMeresXaritos   to dHmniaParalabhs
44138>>>>>>>>>>>>>            Loop
44139>>>>>>>>>>>>>>
44139>>>>>>>>>>>>>        End
44139>>>>>>>>>>>>>>
44139>>>>>>>>>>>>>        Move dHmniaParalabhs    to dHmniaPlhromhs
44140>>>>>>>>>>>>>
44140>>>>>>>>>>>>>        Add (iMeresParalabhs-1) to dHmniaParalabhs
44141>>>>>>>>>>>>>        Add (iMeresPlhroteo-1)  to dHmniaPlhromhs
44142>>>>>>>>>>>>>
44142>>>>>>>>>>>>>        // Ypologise prota to poso bash posostou se sxesh me synolo parastatikou
44142>>>>>>>>>>>>>        Move (Round_number((nSynolo*nPososto/100),2))   to naxia
44143>>>>>>>>>>>>>
44143>>>>>>>>>>>>>        Set Field_Changed_Value Field TParticl.Poso     to naxia
44144>>>>>>>>>>>>>        Set Field_Changed_Value Field TParticl.Paralabh to dHmniaParalabhs
44145>>>>>>>>>>>>>        Set Field_Changed_Value Field TParticl.Exoflhsh to dHmniaPlhromhs
44146>>>>>>>>>>>>>
44146>>>>>>>>>>>>>    End_Procedure
44147>>>>>>>>>>>>>
44147>>>>>>>>>>>>>
44147>>>>>>>>>>>>>    Procedure Creating
44148>>>>>>>>>>>>>        Forward Send Creating
44150>>>>>>>>>>>>>        // Insert Code Here
44150>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Tparticl.Tparticl_Rec0))))));                                    to Tparticl.Tparticl_Recr
44151>>>>>>>>>>>>>    End_Procedure   // Creating
44152>>>>>>>>>>>>>
44152>>>>>>>>>>>>>
44152>>>>>>>>>>>>>    Procedure Save_Main_File
44153>>>>>>>>>>>>>        If (tparticl.isok <> '1') move ' ' to tparticl.isok
44156>>>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
44158>>>>>>>>>>>>>            If tparticl.Recnum Eq 0 Procedure_Return
44161>>>>>>>>>>>>>        End
44161>>>>>>>>>>>>>>
44161>>>>>>>>>>>>>      Forward Send Save_Main_File
44163>>>>>>>>>>>>>    End_Procedure   // Save_Main_File
44164>>>>>>>>>>>>>
44164>>>>>>>>>>>>>
44164>>>>>>>>>>>>>
44164>>>>>>>>>>>>>
44164>>>>>>>>>>>>>
44164>>>>>>>>>>>>>    // Define_Fields:
44164>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
44164>>>>>>>>>>>>>
44164>>>>>>>>>>>>>    Procedure Define_Fields
44165>>>>>>>>>>>>>        Forward Send Define_Fields
44167>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44167>>>>>>>>>>>>>        //DDB-DefineFieldStart
44167>>>>>>>>>>>>>
44167>>>>>>>>>>>>>        Set Main_File            To Tparticl.File_Number
44168>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
44169>>>>>>>>>>>>>
44169>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
44170>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
44171>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
44172>>>>>>>>>>>>>
44172>>>>>>>>>>>>>        // Parent (Server) file structure...............
44172>>>>>>>>>>>>>        Send Add_Server_File  Particle.File_Number
44173>>>>>>>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
44174>>>>>>>>>>>>>
44174>>>>>>>>>>>>>        // External (System) file structure.............
44174>>>>>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
44175>>>>>>>>>>>>>
44175>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecc.Tparticl_Rec0  To Tparticl.Tparticl_Rec0
44178>>>>>>>>>>>>>
44178>>>>>>>>>>>>>        // Field-based properties.......................
44178>>>>>>>>>>>>>
44178>>>>>>>>>>>>>        // Tparticl.Partl_Recr
44178>>>>>>>>>>>>>
44178>>>>>>>>>>>>>        // Tparticl.Baxiokat_Code
44178>>>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Baxiokat_Code To Calc_All_The_Fields
44179>>>>>>>>>>>>>
44179>>>>>>>>>>>>>        // Tparticl.Pct_Epi_Synolou
44179>>>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Pct_Epi_Synolou To Calc_All_The_Fields
44180>>>>>>>>>>>>>
44180>>>>>>>>>>>>>        // Tparticl.Paralabh_Meres
44180>>>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Paralabh_Meres To Calc_All_The_Fields
44181>>>>>>>>>>>>>
44181>>>>>>>>>>>>>        // Tparticl.Xarhtos_Meres
44181>>>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Xarhtos_Meres To Calc_All_The_Fields
44182>>>>>>>>>>>>>
44182>>>>>>>>>>>>>        // Tparticl.Plhroteo_Meres
44182>>>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Plhroteo_Meres To Calc_All_The_Fields
44183>>>>>>>>>>>>>
44183>>>>>>>>>>>>>        // Tparticl.Tparticl_Rec0
44183>>>>>>>>>>>>>
44183>>>>>>>>>>>>>        // Tparticl.Tparticl_Recr
44183>>>>>>>>>>>>>
44183>>>>>>>>>>>>>        // Tparticl.Mera_Tou_Mhna
44183>>>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Mera_Tou_Mhna To Calc_All_The_Fields
44184>>>>>>>>>>>>>        Set Field_Value_Table      Field Tparticl.Mera_Tou_Mhna To (Mera_Tou_Mhna_VT(Self))
44185>>>>>>>>>>>>>
44185>>>>>>>>>>>>>        // Tparticl.Poso
44185>>>>>>>>>>>>>
44185>>>>>>>>>>>>>        // Tparticl.Paralabh
44185>>>>>>>>>>>>>
44185>>>>>>>>>>>>>        // Tparticl.Exoflhsh
44185>>>>>>>>>>>>>
44185>>>>>>>>>>>>>        // Tparticl.Isok
44185>>>>>>>>>>>>>
44185>>>>>>>>>>>>>        //DDB-DefineFieldEnd
44185>>>>>>>>>>>>>    End_Procedure    // Define_Fields
44186>>>>>>>>>>>>>
44186>>>>>>>>>>>>>    // Field_Defaults:
44186>>>>>>>>>>>>>    // This procedure is used to establish default field values.
44186>>>>>>>>>>>>>
44186>>>>>>>>>>>>>    Procedure Field_Defaults
44187>>>>>>>>>>>>>        Forward Send Field_Defaults
44189>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44189>>>>>>>>>>>>>        //DDB-FieldDefaultStart
44189>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
44189>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
44190>>>>>>>>>>>>>
44190>>>>>>>>>>>>>End_Class    // Tparticl_DataDictionary
44191>>>>>>>>>>>>>//DDB-FileEnd
44191>>>>>>>>>>>    Use PARTLFPA.DD
INCLUDING FILE: PARTLFPA.DD
44191>>>>>>>>>>>>>//DDB-FileStart
44191>>>>>>>>>>>>>//DDB-HeaderStart
44191>>>>>>>>>>>>>
44191>>>>>>>>>>>>>// File Name : PARTLFPA.DD
44191>>>>>>>>>>>>>// Class Name: Partlfpa_DataDictionary
44191>>>>>>>>>>>>>// Revision  : 5
44191>>>>>>>>>>>>>// Version   : 2
44191>>>>>>>>>>>>>
44191>>>>>>>>>>>>>Use  Windows           // Basic Definitions
44191>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
44191>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
44191>>>>>>>>>>>>>
44191>>>>>>>>>>>>>Open Partlfpa
44193>>>>>>>>>>>>>Open Particle
44195>>>>>>>>>>>>>Open Fpa
44197>>>>>>>>>>>>>
44197>>>>>>>>>>>>>//DDB-HeaderEnd
44197>>>>>>>>>>>>> 
44197>>>>>>>>>>>>>Class Partlfpa_DataDictionary  is a DataDictionary_Sec
44198>>>>>>>>>>>>>
44198>>>>>>>>>>>>>
44198>>>>>>>>>>>>>    // Define_Fields:
44198>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
44198>>>>>>>>>>>>>
44198>>>>>>>>>>>>>    Procedure Define_Fields
44199>>>>>>>>>>>>>        Forward Send Define_Fields
44201>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44201>>>>>>>>>>>>>        //DDB-DefineFieldStart
44201>>>>>>>>>>>>>
44201>>>>>>>>>>>>>        Set Main_File            To Partlfpa.File_Number
44202>>>>>>>>>>>>>
44202>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
44203>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
44204>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
44205>>>>>>>>>>>>>
44205>>>>>>>>>>>>>        // Parent (Server) file structure...............
44205>>>>>>>>>>>>>        Send Add_Server_File  Particle.File_Number
44206>>>>>>>>>>>>>        Send Add_Server_File  Fpa.File_Number
44207>>>>>>>>>>>>>
44207>>>>>>>>>>>>>        // Field-based properties.......................
44207>>>>>>>>>>>>>
44207>>>>>>>>>>>>>        // Partlfpa.Partl_Recr
44207>>>>>>>>>>>>>
44207>>>>>>>>>>>>>        // Partlfpa.Fpa_Pososto
44207>>>>>>>>>>>>>
44207>>>>>>>>>>>>>        // Partlfpa.Partlfpa_Poso
44207>>>>>>>>>>>>>
44207>>>>>>>>>>>>>        // Partlfpa.Poso_Pro_Ekpt
44207>>>>>>>>>>>>>
44207>>>>>>>>>>>>>        // Partlfpa.Poso_Ekpt
44207>>>>>>>>>>>>>
44207>>>>>>>>>>>>>        // Partlfpa.Poso_Pro_Fpa
44207>>>>>>>>>>>>>
44207>>>>>>>>>>>>>        //DDB-DefineFieldEnd
44207>>>>>>>>>>>>>    End_Procedure    // Define_Fields
44208>>>>>>>>>>>>>
44208>>>>>>>>>>>>>    // Field_Defaults:
44208>>>>>>>>>>>>>    // This procedure is used to establish default field values.
44208>>>>>>>>>>>>>
44208>>>>>>>>>>>>>    Procedure Field_Defaults
44209>>>>>>>>>>>>>        Forward Send Field_Defaults
44211>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44211>>>>>>>>>>>>>        //DDB-FieldDefaultStart
44211>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
44211>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
44212>>>>>>>>>>>>>
44212>>>>>>>>>>>>>End_Class    // Partlfpa_DataDictionary
44213>>>>>>>>>>>>>//DDB-FileEnd
44213>>>>>>>>>>>
44213>>>>>>>>>>>    //AB-StoreTopEnd
44213>>>>>>>>>>>
44213>>>>>>>>>>>    //AB-IgnoreStart
44213>>>>>>>>>>>
44213>>>>>>>>>>>    Use Bproces.Sub
44213>>>>>>>>>>>
44213>>>>>>>>>>>
44213>>>>>>>>>>>    //AB-IgnoreEnd
44213>>>>>>>>>>>
44213>>>>>>>>>>>    Object Psx_Array is a BusinessProcessSub
44215>>>>>>>>>>>
44215>>>>>>>>>>>        //AB-StoreTopStart
44215>>>>>>>>>>>
44215>>>>>>>>>>>        Property    String  psParticleRecr0 Public ''
44217>>>>>>>>>>>        Property    String  psPsxetikaRecr0 Public ''
44219>>>>>>>>>>>        Property    String  psClient_Desc   Public ''
44221>>>>>>>>>>>        Property    String  psPtyppar_Desc  Public ''
44223>>>>>>>>>>>        Property    String  psSeira_Seira   Public ''
44225>>>>>>>>>>>        Property    Date    pdPartl_Hmnia   Public ''
44227>>>>>>>>>>>        Property    Integer piPartl_No      Public  0
44229>>>>>>>>>>>        Property    Number  pnPosothta      Public  0
44231>>>>>>>>>>>
44231>>>>>>>>>>>        Object Ctypkin_DD2 is a Ctypkin_DataDictionary
44233>>>>>>>>>>>        End_Object    // Ctypkin_DD2
44234>>>>>>>>>>>
44234>>>>>>>>>>>        Object Wtypkin_DD2 is a Wtypkin_DataDictionary
44236>>>>>>>>>>>        End_Object    // Wtypkin_DD2
44237>>>>>>>>>>>
44237>>>>>>>>>>>        Object Ptyppar_DD2 is a Ptyppar_DataDictionary
44239>>>>>>>>>>>            Set DDO_Server to (Ctypkin_DD2(self))
44240>>>>>>>>>>>            Set DDO_Server to (Wtypkin_DD2(self))
44241>>>>>>>>>>>        End_Object    // Ptyppar_DD2
44242>>>>>>>>>>>
44242>>>>>>>>>>>        Object Country_DD2 is a Country_DataDictionary
44244>>>>>>>>>>>        End_Object    // Country_DD2
44245>>>>>>>>>>>
44245>>>>>>>>>>>        Object Towns_DD2 is a Towns_DataDictionary
44247>>>>>>>>>>>            Set DDO_Server to (Country_DD2(self))
44248>>>>>>>>>>>        End_Object    // Towns_DD2
44249>>>>>>>>>>>
44249>>>>>>>>>>>        Object Cities_DD2 is a Cities_DataDictionary
44251>>>>>>>>>>>            Set DDO_Server to (Towns_DD2(self))
44252>>>>>>>>>>>        End_Object    // Cities_DD2
44253>>>>>>>>>>>
44253>>>>>>>>>>>        Object Areas_DD2 is a Areas_DataDictionary
44255>>>>>>>>>>>        End_Object    // Areas_DD2
44256>>>>>>>>>>>
44256>>>>>>>>>>>        Object Payresp_DD2 is a Payresp_DataDictionary
44258>>>>>>>>>>>        End_Object    // Payresp_DD2
44259>>>>>>>>>>>
44259>>>>>>>>>>>        Object Clients_DD2 is a Clients_DataDictionary
44261>>>>>>>>>>>            Set DDO_Server to (Cities_DD2(self))
44262>>>>>>>>>>>            Set DDO_Server to (Areas_DD2(self))
44263>>>>>>>>>>>            Set DDO_Server to (Payresp_DD2(self))
44264>>>>>>>>>>>        End_Object    // Clients_DD2
44265>>>>>>>>>>>
44265>>>>>>>>>>>        Object Nomisma_DD2 is a Nomisma_DataDictionary
44267>>>>>>>>>>>        End_Object    // Nomisma_DD2
44268>>>>>>>>>>>
44268>>>>>>>>>>>        Object Particle_DD2 is a Particle_DataDictionary
44270>>>>>>>>>>>            Set DDO_Server to (Clients_DD2(self))
44271>>>>>>>>>>>            Set DDO_Server to (Ptyppar_DD2(self))
44272>>>>>>>>>>>            Set DDO_Server to (Nomisma_DD2(self))
44273>>>>>>>>>>>        End_Object    // Particle_DD2
44274>>>>>>>>>>>
44274>>>>>>>>>>>
44274>>>>>>>>>>>        /////////////////////////////////////////////
44274>>>>>>>>>>>
44274>>>>>>>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
44276>>>>>>>>>>>        End_Object    // Ctypkin_DD
44277>>>>>>>>>>>
44277>>>>>>>>>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
44279>>>>>>>>>>>        End_Object    // Wtypkin_DD
44280>>>>>>>>>>>
44280>>>>>>>>>>>        Object Ptyppar_DD is a Ptyppar_DataDictionary
44282>>>>>>>>>>>            Set DDO_Server to (Ctypkin_DD(self))
44283>>>>>>>>>>>            Set DDO_Server to (Wtypkin_DD(self))
44284>>>>>>>>>>>        End_Object    // Ptyppar_DD
44285>>>>>>>>>>>
44285>>>>>>>>>>>        Object Country_DD is a Country_DataDictionary
44287>>>>>>>>>>>        End_Object    // Country_DD
44288>>>>>>>>>>>
44288>>>>>>>>>>>        Object Towns_DD is a Towns_DataDictionary
44290>>>>>>>>>>>            Set DDO_Server to (Country_DD(self))
44291>>>>>>>>>>>        End_Object    // Towns_DD
44292>>>>>>>>>>>
44292>>>>>>>>>>>        Object Cities_DD is a Cities_DataDictionary
44294>>>>>>>>>>>            Set DDO_Server to (Towns_DD(self))
44295>>>>>>>>>>>        End_Object    // Cities_DD
44296>>>>>>>>>>>
44296>>>>>>>>>>>        Object Areas_DD is a Areas_DataDictionary
44298>>>>>>>>>>>        End_Object    // Areas_DD
44299>>>>>>>>>>>
44299>>>>>>>>>>>        Object Payresp_DD is a Payresp_DataDictionary
44301>>>>>>>>>>>        End_Object    // Payresp_DD
44302>>>>>>>>>>>
44302>>>>>>>>>>>        Object Clients_DD is a Clients_DataDictionary
44304>>>>>>>>>>>            Set DDO_Server to (Cities_DD(self))
44305>>>>>>>>>>>            Set DDO_Server to (Areas_DD(self))
44306>>>>>>>>>>>            Set DDO_Server to (Payresp_DD(self))
44307>>>>>>>>>>>        End_Object    // Clients_DD
44308>>>>>>>>>>>
44308>>>>>>>>>>>        Object Nomisma_DD is a Nomisma_DataDictionary
44310>>>>>>>>>>>        End_Object    // Nomisma_DD
44311>>>>>>>>>>>
44311>>>>>>>>>>>        Object Particle_DD is a Particle_DataDictionary
44313>>>>>>>>>>>            Set DDO_Server to (Clients_DD(self))
44314>>>>>>>>>>>            Set DDO_Server to (Ptyppar_DD(self))
44315>>>>>>>>>>>            Set DDO_Server to (Nomisma_DD(self))
44316>>>>>>>>>>>        End_Object    // Particle_DD
44317>>>>>>>>>>>
44317>>>>>>>>>>>        Object Psxetika_DD is a Psxetika_DataDictionary
44319>>>>>>>>>>>            Set DDO_Server      to (Particle_DD(self))
44320>>>>>>>>>>>            Set Constrain_File  to Particle.File_Number
44321>>>>>>>>>>>        End_Object
44322>>>>>>>>>>>
44322>>>>>>>>>>>
44322>>>>>>>>>>>        //AB-StoreTopEnd
44322>>>>>>>>>>>
44322>>>>>>>>>>>        Set Size to 60 100
44323>>>>>>>>>>>
44323>>>>>>>>>>>        //AB-DDOStart
44323>>>>>>>>>>>
44323>>>>>>>>>>>
44323>>>>>>>>>>>        //AB-DDOEnd
44323>>>>>>>>>>>
44323>>>>>>>>>>>
44323>>>>>>>>>>>        //AB-StoreStart
44323>>>>>>>>>>>
44323>>>>>>>>>>>        Procedure Find_Sxetika_Data String asParentRecr
44325>>>>>>>>>>>            String  sClient_Desc sPtyppar_Desc sPseira_Seira
44326>>>>>>>>>>>            Date    dPartl_Hmnia
44326>>>>>>>>>>>            Integer iPartl_No
44326>>>>>>>>>>>
44326>>>>>>>>>>>            Send Clear          to Particle_DD2
44327>>>>>>>>>>>            Move asParentRecr   to Particle.Partl_Recr
44328>>>>>>>>>>>            Send Find           to Particle_DD2 Eq 2
44329>>>>>>>>>>>
44329>>>>>>>>>>>            Get Field_Current_Value Of Clients_DD2  Field Clients.Client_Name   to sClient_Desc
44330>>>>>>>>>>>            Get Field_Current_Value Of Ptyppar_DD2  Field Ptyppar.Ptyppar_Descr to sPtyppar_Desc
44331>>>>>>>>>>>            Get Field_Current_Value Of Particle_DD2 Field Particle.Pseira_Seira to sPseira_Seira
44332>>>>>>>>>>>            Get Field_Current_Value Of Particle_DD2 Field Particle.Partl_Hmnia  to dPartl_Hmnia
44333>>>>>>>>>>>            Get Field_Current_Value Of Particle_DD2 Field Particle.Partl_No     to iPartl_No
44334>>>>>>>>>>>
44334>>>>>>>>>>>            Set psPtyppar_Desc      to sPtyppar_Desc
44335>>>>>>>>>>>            Set psClient_Desc       to sClient_Desc
44336>>>>>>>>>>>            Set psSeira_Seira       to sPseira_Seira
44337>>>>>>>>>>>            Set pdPartl_Hmnia       to dPartl_Hmnia
44338>>>>>>>>>>>            Set piPartl_No          to iPartl_No
44339>>>>>>>>>>>        End_Procedure
44340>>>>>>>>>>>
44340>>>>>>>>>>>
44340>>>>>>>>>>>        Procedure Make_The_Record
44342>>>>>>>>>>>
44342>>>>>>>>>>>            Set psPtyppar_Desc      to ''
44343>>>>>>>>>>>            Set psClient_Desc       to ''
44344>>>>>>>>>>>            Set psSeira_Seira       to ''
44345>>>>>>>>>>>            Set pdPartl_Hmnia       to ''
44346>>>>>>>>>>>            Set piPartl_No          to 0
44347>>>>>>>>>>>
44347>>>>>>>>>>>            Clear Psxetika
44348>>>>>>>>>>>            Move (psParticleRecr0(Self)) to Psxetika.Partl_Recr
44349>>>>>>>>>>>            Move (psPsxetikaRecr0(Self)) to Psxetika.Psx_Partl_Recr
44350>>>>>>>>>>>            Find Eq Psxetika by index.4
44351>>>>>>>>>>>>
44351>>>>>>>>>>>
44351>>>>>>>>>>>            If (Not(Found)) Begin
44353>>>>>>>>>>>
44353>>>>>>>>>>>                Send Find_Sxetika_Data (psPsxetikaRecr0(Self))
44354>>>>>>>>>>>
44354>>>>>>>>>>>                Send Clear to Particle_DD
44355>>>>>>>>>>>                Send Clear to Psxetika_DD
44356>>>>>>>>>>>
44356>>>>>>>>>>>                // Vres ton mpampa
44356>>>>>>>>>>>                Move (psParticleRecr0(Self)) to Particle.Partl_Recr
44357>>>>>>>>>>>                Send Find to Particle_DD Eq 2
44358>>>>>>>>>>>
44358>>>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Psx_Partl_Recr    ;                                                to (psPsxetikaRecr0(Self))
44359>>>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Client_Desc    ;                                                to (psClient_Desc(Self))
44360>>>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Ptyppar_Desc   ;                                                to (psPtyppar_Desc(Self))
44361>>>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_Hmnia    ;                                                to (pdPartl_Hmnia(Self))
44362>>>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_No       ;                                                to (piPartl_No(Self))
44363>>>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.SX_Pseira_Seira   ;                                                to (psSeira_Seira(Self))
44364>>>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Pms_Sx_Qty        ;                                                to (pnPosothta(Self))
44365>>>>>>>>>>>
44365>>>>>>>>>>>                Send Request_Save               to Psxetika_DD
44366>>>>>>>>>>>
44366>>>>>>>>>>>
44366>>>>>>>>>>>                // Make also 2nd Record
44366>>>>>>>>>>>                Clear Psxetika
44367>>>>>>>>>>>                Move (psPsxetikaRecr0(Self)) to Psxetika.Partl_Recr
44368>>>>>>>>>>>                Move (psParticleRecr0(Self)) to Psxetika.Psx_Partl_Recr
44369>>>>>>>>>>>                Find Eq Psxetika by index.4
44370>>>>>>>>>>>>
44370>>>>>>>>>>>
44370>>>>>>>>>>>                If (Not(Found)) Begin
44372>>>>>>>>>>>
44372>>>>>>>>>>>                    Send Find_Sxetika_Data (psParticleRecr0(Self))
44373>>>>>>>>>>>
44373>>>>>>>>>>>                    Send Clear to Particle_DD
44374>>>>>>>>>>>                    Send Clear to Psxetika_DD
44375>>>>>>>>>>>
44375>>>>>>>>>>>                    Move (psPsxetikaRecr0(Self)) to Particle.Partl_Recr
44376>>>>>>>>>>>                    Send Find to Particle_DD Eq 2
44377>>>>>>>>>>>
44377>>>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Psx_Partl_Recr    ;                                                    to (psParticleRecr0(Self))
44378>>>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Client_Desc    ;                                                    to (psClient_Desc(Self))
44379>>>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Ptyppar_Desc   ;                                                    to (psPtyppar_Desc(Self))
44380>>>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_Hmnia    ;                                                    to (pdPartl_Hmnia(Self))
44381>>>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_No       ;                                                    to (piPartl_No(Self))
44382>>>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.SX_Pseira_Seira   ;                                                    to (psSeira_Seira(Self))
44383>>>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Pms_Sx_Qty        ;                                                    to (pnPosothta(Self))
44384>>>>>>>>>>>                    Send Request_Save               to Psxetika_DD
44385>>>>>>>>>>>                End
44385>>>>>>>>>>>>
44385>>>>>>>>>>>            End
44385>>>>>>>>>>>>
44385>>>>>>>>>>>        End_Procedure
44386>>>>>>>>>>>
44386>>>>>>>>>>>        //AB-StoreEnd
44386>>>>>>>>>>>
44386>>>>>>>>>>>    End_Object    // Psx_Array
44387>>>>>>>>>>>
44387>>>>>>>>>>>
44387>>>>>>>>>>>    //AB-StoreStart
44387>>>>>>>>>>>
44387>>>>>>>>>>>    //AB-StoreEnd
44387>>>>>>>>>>>
44387>>>>>>>>>>>//AB/     End_Object    // prj
44387>>>>>>>>>//Use bpMakeSx.dg
44387>>>>>>>>>
44387>>>>>>>>>Class PmsSxet_DataDictionary  is a DataDictionary_Sec
44388>>>>>>>>>
44388>>>>>>>>>    Procedure Construct_Object
44389>>>>>>>>>        Forward Send Construct_Object
44391>>>>>>>>>        Property Integer piFromCreate   Public 0
44392>>>>>>>>>    End_Procedure
44393>>>>>>>>>
44393>>>>>>>>>    Procedure Creating
44394>>>>>>>>>        Forward Send Creating
44396>>>>>>>>>        Set piFromCreate to 1
44397>>>>>>>>>    End_Procedure
44398>>>>>>>>>
44398>>>>>>>>>    Procedure Update
44399>>>>>>>>>        String  sRecr1 sRecr2 sPmsSxet
44400>>>>>>>>>        Number  nQty
44400>>>>>>>>>        Integer iLathos iCurrentPmoves iAkyro iCurrentPmsSxet iCurrentPartl
44400>>>>>>>>>
44400>>>>>>>>>        Forward Send Update
44402>>>>>>>>>
44402>>>>>>>>>        Move (Trim(Particle.Partl_LastNo)='1')  to iAkyro
44403>>>>>>>>>        Move Particle.Partl_Recr                to sRecr1
44404>>>>>>>>>        Move Pmoves.Recnum                      to iCurrentPmoves
44405>>>>>>>>>        Move PmsSxet.Recnum                     to iCurrentPmsSxet
44406>>>>>>>>>        Move PmsSxet.Arx_Partl_Recr             to sRecr2
44407>>>>>>>>>        Move PmsSxet.Posothta                   to nQty
44408>>>>>>>>>        Move Particle.Recnum                    to iCurrentPartl
44409>>>>>>>>>
44409>>>>>>>>>
44409>>>>>>>>>        If (piFromCreate(Self)<>1) Begin
44411>>>>>>>>>            Add nQty to Pmoves.Pms_Qty
44412>>>>>>>>>            Saverecord Pmoves
44413>>>>>>>>>
44413>>>>>>>>>            Set pnQty               Of bpEnYpol to nQty
44414>>>>>>>>>            Set psRecr              Of bpEnYpol to PmsSxet.Sxetiko_Recr
44415>>>>>>>>>            Set piFromAkyrosh       Of bpEnYpol to (iAkyro=1)
44416>>>>>>>>>            Set piCurrentPartl      Of bpEnYpol to iCurrentPartl
44417>>>>>>>>>            Set piCurrentPmoves     Of bpEnYpol to iCurrentPmoves
44418>>>>>>>>>            Set piCurrentPmsSxet    Of bpEnYpol to iCurrentPmsSxet
44419>>>>>>>>>            Send DoProcess          to bpEnYpol
44420>>>>>>>>>
44420>>>>>>>>>            Get piLathos            Of bpEnYpol to iLathos
44421>>>>>>>>>
44421>>>>>>>>>                 If (iLathos=40000) Error 8000 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
44424>>>>>>>>>            Else If (iLathos=40001) Error 8001 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
44428>>>>>>>>>            Else If (iLathos=40002) Error 8002 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
44432>>>>>>>>>            Else If (iLathos=40003) Error 8003 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
44436>>>>>>>>>            Else If (iLathos=40004) Error 8004 '’¦ §¨à«˜¨® ¡æ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
44440>>>>>>>>>            Else If (iLathos=40005) Error 8005 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
44444>>>>>>>>>            Else If (iLathos=40006) Error 8006 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
44448>>>>>>>>>
44448>>>>>>>>>        End
44448>>>>>>>>>>
44448>>>>>>>>>
44448>>>>>>>>>        // Epanafora posothtas giati afou trexei h backout me timh px 3 eno h update exei timh 4
44448>>>>>>>>>        // sthn epanatopothethsh ths bpenypol xanavriskei to current pmssxet record
44448>>>>>>>>>        // kai xanei thn posothta thn kainourgia opote epanerxetai me thn posothta ths
44448>>>>>>>>>        // backout pou einai 3.
44448>>>>>>>>>        Move nQty to PmsSxet.Posothta
44449>>>>>>>>>
44449>>>>>>>>>
44449>>>>>>>>>        Clear Psxetika
44450>>>>>>>>>        Move sRecr1 to Psxetika.Partl_Recr
44451>>>>>>>>>        Move sRecr2 to Psxetika.Psx_Partl_Recr
44452>>>>>>>>>        Find Eq Psxetika by index.4
44453>>>>>>>>>>
44453>>>>>>>>>        If (Found) Begin
44455>>>>>>>>>            Add nQty to Psxetika.Pms_Sx_Qty
44456>>>>>>>>>            Saverecord Psxetika
44457>>>>>>>>>        End
44457>>>>>>>>>>
44457>>>>>>>>>
44457>>>>>>>>>        Clear Psxetika
44458>>>>>>>>>        Move sRecr2 to Psxetika.Partl_Recr
44459>>>>>>>>>        Move sRecr1 to Psxetika.Psx_Partl_Recr
44460>>>>>>>>>        Find Eq Psxetika by index.4
44461>>>>>>>>>>
44461>>>>>>>>>        If (Found) Begin
44463>>>>>>>>>            Add nQty to Psxetika.Pms_Sx_Qty
44464>>>>>>>>>            Saverecord Psxetika
44465>>>>>>>>>        End
44465>>>>>>>>>>
44465>>>>>>>>>    End_Procedure
44466>>>>>>>>>
44466>>>>>>>>>    Procedure Backout
44467>>>>>>>>>        String  sRecr1 sRecr2 sPmsSxet
44468>>>>>>>>>        Number  nQty
44468>>>>>>>>>        Integer iLathos iCurrentPmoves iAkyro iCurrentPmsSxet iCurrentPartl
44468>>>>>>>>>
44468>>>>>>>>>        Move (Trim(Particle.Partl_LastNo)='1')  to iAkyro
44469>>>>>>>>>        Move Particle.Partl_Recr                to sRecr1
44470>>>>>>>>>        Move Pmoves.Recnum                      to iCurrentPmoves
44471>>>>>>>>>        Move PmsSxet.Recnum                     to iCurrentPmsSxet
44472>>>>>>>>>        Move PmsSxet.Arx_Partl_Recr             to sRecr2
44473>>>>>>>>>        Move PmsSxet.Posothta                   to nQty
44474>>>>>>>>>        Move Particle.Recnum                    to iCurrentPartl
44475>>>>>>>>>
44475>>>>>>>>>        Forward Send Backout
44477>>>>>>>>>
44477>>>>>>>>>        Set pnQty               Of bpEnYpol to (nQty*(-1))
44478>>>>>>>>>        Set psRecr              Of bpEnYpol to PmsSxet.Sxetiko_Recr
44479>>>>>>>>>        Set piFromAkyrosh       Of bpEnYpol to (iAkyro=1)
44480>>>>>>>>>        Set piCurrentPartl      Of bpEnYpol to iCurrentPartl
44481>>>>>>>>>        Set piCurrentPmoves     Of bpEnYpol to iCurrentPmoves
44482>>>>>>>>>        Set piCurrentPmsSxet    Of bpEnYpol to iCurrentPmsSxet
44483>>>>>>>>>        Send DoProcess          to bpEnYpol
44484>>>>>>>>>
44484>>>>>>>>>        Get piLathos            Of bpEnYpol to iLathos
44485>>>>>>>>>
44485>>>>>>>>>             If (iLathos=40000) Error 8000 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nBackout PmsSxet'
44488>>>>>>>>>        Else If (iLathos=40001) Error 8001 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nBackout PmsSxet'
44492>>>>>>>>>        Else If (iLathos=40002) Error 8002 'ƒœ¤ ™¨âŸž¡œ Particle\nBackout PmsSxet'
44496>>>>>>>>>        Else If (iLathos=40003) Error 8003 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nBackout PmsSxet'
44500>>>>>>>>>        Else If (iLathos=40004) Error 8004 '’¦ §¨à«˜¨® ¡æ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nBackout PmsSxet'
44504>>>>>>>>>        Else If (iLathos=40005) Error 8005 'ƒœ¤ ™¨âŸž¡œ Particle\nBackout PmsSxet'
44508>>>>>>>>>        Else If (iLathos=40006) Error 8006 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nBackout PmsSxet'
44512>>>>>>>>>
44512>>>>>>>>>        Clear Psxetika
44513>>>>>>>>>        Move sRecr1 to Psxetika.Partl_Recr
44514>>>>>>>>>        Move sRecr2 to Psxetika.Psx_Partl_Recr
44515>>>>>>>>>        Find Eq Psxetika by index.4
44516>>>>>>>>>>
44516>>>>>>>>>        If (Found) Begin
44518>>>>>>>>>            Sub nQty from Psxetika.Pms_Sx_Qty
44519>>>>>>>>>            Saverecord Psxetika
44520>>>>>>>>>        End
44520>>>>>>>>>>
44520>>>>>>>>>
44520>>>>>>>>>        Clear Psxetika
44521>>>>>>>>>        Move sRecr2 to Psxetika.Partl_Recr
44522>>>>>>>>>        Move sRecr1 to Psxetika.Psx_Partl_Recr
44523>>>>>>>>>        Find Eq Psxetika by index.4
44524>>>>>>>>>>
44524>>>>>>>>>        If (Found) Begin
44526>>>>>>>>>            Sub nQty from Psxetika.Pms_Sx_Qty
44527>>>>>>>>>            Saverecord Psxetika
44528>>>>>>>>>        End
44528>>>>>>>>>>
44528>>>>>>>>>    End_Procedure
44529>>>>>>>>>
44529>>>>>>>>>    Procedure Request_Save
44530>>>>>>>>>        Integer iInt iLathos iMustDelete iCurrentPmoves iAkyro iCurrentPmsSxet iCurrentPartl
44531>>>>>>>>>        String  sParticleRecr sPmsSxetRecr sPmovesRecr sArxPartlRecr sRecr1 sRecr2 sPmsSxet
44531>>>>>>>>>        Number  nQty
44531>>>>>>>>>
44531>>>>>>>>>        Set piFromCreate to 0
44532>>>>>>>>>
44532>>>>>>>>>        Forward Send Request_Save
44534>>>>>>>>>
44534>>>>>>>>>        If (piFromCreate(Self)=1) Begin
44536>>>>>>>>>            Set piFromCreate                                                to 0
44537>>>>>>>>>
44537>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Recnum         to iCurrentPartl
44538>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_Recr     to sParticleRecr
44539>>>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Pms_Recr         to sPmovesRecr
44540>>>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Recnum           to iCurrentPmoves
44541>>>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Recnum          to iCurrentPmsSxet
44542>>>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Sxetiko_Recr    to sPmsSxetRecr
44543>>>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Arx_Partl_Recr  to sArxPartlRecr
44544>>>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Posothta        to nQty
44545>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_LastNo   to iAkyro
44546>>>>>>>>>            Move (iAkyro=1)                                                 to iAkyro
44547>>>>>>>>>
44547>>>>>>>>>            Set pnQty               Of bpEnYpol to nQty
44548>>>>>>>>>            Set psRecr              Of bpEnYpol to sPmsSxetRecr
44549>>>>>>>>>            Set piFromAkyrosh       Of bpEnYpol to (iAkyro=1)
44550>>>>>>>>>            Set piCurrentPartl      Of bpEnYpol to iCurrentPartl
44551>>>>>>>>>            Set piCurrentPmoves     Of bpEnYpol to iCurrentPmoves
44552>>>>>>>>>            Set piCurrentPmsSxet    Of bpEnYpol to iCurrentPmsSxet
44553>>>>>>>>>            Send DoProcess          to bpEnYpol
44554>>>>>>>>>            Get piLathos            Of bpEnYpol to iLathos
44555>>>>>>>>>
44555>>>>>>>>>                 If (iLathos=40000) Error 8000 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
44558>>>>>>>>>            Else If (iLathos=40001) Error 8001 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
44562>>>>>>>>>            Else If (iLathos=40002) Error 8002 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
44566>>>>>>>>>            Else If (iLathos=40003) Error 8003 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
44570>>>>>>>>>            Else If (iLathos=40004) Error 8004 '’¦ §¨à«˜¨® ¡æ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
44574>>>>>>>>>            Else If (iLathos=40005) Error 8005 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
44578>>>>>>>>>            Else If (iLathos=40006) Error 8006 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
44582>>>>>>>>>
44582>>>>>>>>>            Set psParticleRecr0     Of Psx_Array to sParticleRecr
44583>>>>>>>>>            Set psPsxetikaRecr0     Of Psx_Array to sArxPartlRecr
44584>>>>>>>>>            Set pnPosothta          Of Psx_Array to nQty
44585>>>>>>>>>            Send Make_The_Record    Of Psx_Array
44586>>>>>>>>>
44586>>>>>>>>>            // Xana vres tis eggrafes
44586>>>>>>>>>            Clear Particle
44587>>>>>>>>>            Move sParticleRecr  to Particle.Partl_Recr
44588>>>>>>>>>            Find Eq Particle by index.2
44589>>>>>>>>>>
44589>>>>>>>>>
44589>>>>>>>>>            Clear Pmoves
44590>>>>>>>>>            Move sPmovesRecr    to Pmoves.Pms_Recr
44591>>>>>>>>>            Find Eq Pmoves by index.2
44592>>>>>>>>>>
44592>>>>>>>>>
44592>>>>>>>>>            Clear PmsSxet
44593>>>>>>>>>            Move sPmovesRecr    to PmsSxet.Pms_Recr
44594>>>>>>>>>            Move sPmsSxetRecr   to PmsSxet.Sxetiko_Recr
44595>>>>>>>>>            Find Eq PmsSxet by Index.1
44596>>>>>>>>>>
44596>>>>>>>>>
44596>>>>>>>>>        End
44596>>>>>>>>>>
44596>>>>>>>>>    End_Procedure
44597>>>>>>>>>
44597>>>>>>>>>
44597>>>>>>>>>    Procedure Define_Fields
44598>>>>>>>>>        Forward Send Define_Fields
44600>>>>>>>>>        //DDB-Generated-Code-Location
44600>>>>>>>>>        //DDB-DefineFieldStart
44600>>>>>>>>>
44600>>>>>>>>>        Set Main_File            To Pmssxet.File_Number
44601>>>>>>>>>
44601>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
44602>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
44603>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
44604>>>>>>>>>
44604>>>>>>>>>        // Parent (Server) file structure...............
44604>>>>>>>>>        Send Add_Server_File  Pmoves.File_Number
44605>>>>>>>>>
44605>>>>>>>>>        // External (System) file structure.............
44605>>>>>>>>>        Send Add_System_File  Psxetika.File_Number  DD_LOCK_ON_ALL
44606>>>>>>>>>        Send Add_System_File  Pmoves.File_Number  DD_LOCK_ON_ALL
44607>>>>>>>>>
44607>>>>>>>>>        // Field-based properties.......................
44607>>>>>>>>>
44607>>>>>>>>>        // Pmssxet.Pms_Recr
44607>>>>>>>>>
44607>>>>>>>>>        // Pmssxet.Sxetiko_Recr
44607>>>>>>>>>
44607>>>>>>>>>        // Pmssxet.Posothta
44607>>>>>>>>>
44607>>>>>>>>>        // Pmssxet.Arx_Partl_Recr
44607>>>>>>>>>
44607>>>>>>>>>        // Pmssxet.Sx_Parast
44607>>>>>>>>>
44607>>>>>>>>>        // Pmssxet.Sx_Hmnia
44607>>>>>>>>>
44607>>>>>>>>>        // Pmssxet.Sx_Foreas
44607>>>>>>>>>
44607>>>>>>>>>        // Pmssxet.Sx_Arithmos
44607>>>>>>>>>
44607>>>>>>>>>        // Pmssxet.Sx_Seira
44607>>>>>>>>>
44607>>>>>>>>>        // Pmssxet.Sx_Posothta
44607>>>>>>>>>
44607>>>>>>>>>        //DDB-DefineFieldEnd
44607>>>>>>>>>    End_Procedure    // Define_Fields
44608>>>>>>>>>
44608>>>>>>>>>    Procedure Field_Defaults
44609>>>>>>>>>        Forward Send Field_Defaults
44611>>>>>>>>>        //DDB-Generated-Code-Location
44611>>>>>>>>>        //DDB-FieldDefaultStart
44611>>>>>>>>>        //DDB-FieldDefaultEnd
44611>>>>>>>>>    End_Procedure    // Field_Defaults
44612>>>>>>>>>
44612>>>>>>>>>End_Class    // Pmssxet_DataDictionary
44613>>>>>>>>>//DDB-FileEnd
44613>>>>>>>
44613>>>>>>>Class Cmoves_DataDictionary  is a DataDictionary
44614>>>>>>>
44614>>>>>>>    Procedure Construct_Object
44615>>>>>>>        Forward Send Construct_Object
44617>>>>>>>        Property Integer piFromBP Public 0
44618>>>>>>>        Property Integer piFromxrhsh Public 0//œ¤›œ ¥ž ¦«  œ¨®œ«˜  ˜§¦ £œ«˜­¦¨á ¬§¦¢¦å§à¤
44619>>>>>>>    End_Procedure
44620>>>>>>>
44620>>>>>>>    Function Validate_Save  Returns Integer
44621>>>>>>>        Integer iReturnVal iOpen_Items iCheck ifromxrhsh iYes
44622>>>>>>>        String sModule
44622>>>>>>>        get pifromxrhsh to ifromxrhsh
44623>>>>>>>        Forward Get Validate_Save  To iReturnVal
44625>>>>>>>        If (Not(iReturnVal)) Begin
44627>>>>>>>            
44627>>>>>>>            Clear Branch
44628>>>>>>>            Move SyscurXr.Company_Code  to Branch.Company_Code
44629>>>>>>>            Move SyscurXr.Branch_Code   to Branch.Branch_Code
44630>>>>>>>            Find Eq Branch By Index.1
44631>>>>>>>>
44631>>>>>>>            If (Not(Found)) Move 6666 to iReturnVal
44634>>>>>>>            Else If ((Branch.Locked_Until<>'') And (Cmoves.Cmoves_Hmnia<=Branch.Locked_Until)) Move 6667 to iReturnVal
44638>>>>>>>            
44638>>>>>>>            If (Cmoves.Axia_Ypol_Sysx<0) Begin
44640>>>>>>>                Move 10101 to iReturnVal
44641>>>>>>>            End
44641>>>>>>>>
44641>>>>>>>            Else Begin
44642>>>>>>>                Move Ctypkin.Check_Overhead to iCheck
44643>>>>>>>                If (iCheck) Begin
44645>>>>>>>                    If ((Clients.Plafon>0) And (Clients.Overhead<0) And (Sysfile.Over_Overhead<>'1')) Begin
44647>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 3000 Cmoves' to iYes
44648>>>>>>>                        If (iYes=MBR_NO) Move 11170 to iReturnVal
44651>>>>>>>                    End
44651>>>>>>>>
44651>>>>>>>                    Else If ((PayResp.Plafon>0) And (PayResp.Overhead<0) And (Sysfile.Over_Overhead<>'1')) Begin
44654>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 3001 Cmoves' to iYes
44655>>>>>>>                        If (iYes=MBR_NO) Move 11171 to iReturnVal
44658>>>>>>>                    End
44658>>>>>>>>
44658>>>>>>>                End
44658>>>>>>>>
44658>>>>>>>                Else If (Cmoves.Prn_Theor='1')      Move 22278 to iReturnVal
44662>>>>>>>                Else If (Clients.Client_Locked='1') Move 11172 to iReturnVal
44666>>>>>>>                // ˜¤ œ¨®œ«˜  ˜§¦ £œ«˜­¦¨á ¬§¦¢¦å§à¤ £ž¤ «¦¤ ¡¦™œ ª
44666>>>>>>>                Else If ((Cmoves.Cmoves_Hmnia<syscurxr.Year_Xrhshfrom and ifromxrhsh<>1) Or ;                         (Cmoves.Cmoves_Hmnia>Syscurxr.Year_Xrhshto and ifromxrhsh<>1)) Move 22277 to iReturnVal
44670>>>>>>>                Else Begin
44671>>>>>>>                    If (Cmoves.Module_From='') Move 22250 to iReturnVal
44674>>>>>>>                    Else Begin
44675>>>>>>>                        If (piFromBP(Self)<>1) Begin // €¤ ›œ¤ §¨¦œ¨®œ«˜  ˜§¦ « ª 2 Business Process
44677>>>>>>>                            If (Cmoves.Module_From<>gs_Module_Code) Move 22288 to iReturnVal
44680>>>>>>>                            Else If (Cmoves.Recnum<>0) Begin // €¤ ›œ¤ ¡˜¤œ  create ¤œ˜ œšš¨˜­ž
44683>>>>>>>                                If (Cmoves.Barticl_Recr<>'') Move 22284 to iReturnVal
44686>>>>>>>                                Else If (Cmoves.Partl_Recr  <>'') Begin
44689>>>>>>>                                    If (Cmoves.Module_From='01') Move 22283 to iReturnVal
44692>>>>>>>                                    Else If (Cmoves.Module_From='02') Move 22282 to iReturnVal
44696>>>>>>>                                End
44696>>>>>>>>
44696>>>>>>>                            End
44696>>>>>>>>
44696>>>>>>>                        End
44696>>>>>>>>
44696>>>>>>>                    End
44696>>>>>>>>
44696>>>>>>>                End
44696>>>>>>>>
44696>>>>>>>            End
44696>>>>>>>>
44696>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
44699>>>>>>>        End
44699>>>>>>>>
44699>>>>>>>        Function_Return iReturnVal
44700>>>>>>>    End_Function   // Validate_Save
44701>>>>>>>
44701>>>>>>>    Function Validate_Delete  Returns Integer
44702>>>>>>>        Integer iReturnVal
44703>>>>>>>        String sModule
44703>>>>>>>        Forward Get Validate_Delete  To iReturnVal
44705>>>>>>>        If (Not(iReturnVal)) Begin
44707>>>>>>>
44707>>>>>>>            Clear Branch
44708>>>>>>>            Move SyscurXr.Company_Code  to Branch.Company_Code
44709>>>>>>>            Move SyscurXr.Branch_Code   to Branch.Branch_Code
44710>>>>>>>            Find Eq Branch By Index.1
44711>>>>>>>>
44711>>>>>>>            If (Not(Found)) Move 6668 to iReturnVal
44714>>>>>>>            Else If ((Branch.Locked_Until<>'') And (Cmoves.Cmoves_Hmnia<=Branch.Locked_Until)) Move 6669 to iReturnVal
44718>>>>>>>
44718>>>>>>>            If (Cmoves.Prn_Theor='1') Move 22279 to iReturnVal
44721>>>>>>>            If (piFromBP(Self)<>1) Begin
44723>>>>>>>                If (Cmoves.Module_From<>gs_Module_Code) Move 22289 to iReturnVal
44726>>>>>>>                Else Begin
44727>>>>>>>                    If (Cmoves.Barticl_Recr<>'') Move 22287 to iReturnVal
44730>>>>>>>                    Else If (Cmoves.Partl_Recr  <>'') Begin
44733>>>>>>>                        If (Cmoves.Module_From='01') Move 22286 to iReturnVal
44736>>>>>>>                        Else If (Cmoves.Module_From='02') Move 22285 to iReturnVal
44740>>>>>>>                    End
44740>>>>>>>>
44740>>>>>>>                End
44740>>>>>>>>
44740>>>>>>>            End
44740>>>>>>>>
44740>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
44743>>>>>>>        End
44743>>>>>>>>
44743>>>>>>>        Function_Return iReturnVal
44744>>>>>>>    End_Function   // Validate_Delete
44745>>>>>>>
44745>>>>>>>    Procedure Save_Main_File
44746>>>>>>>        If (Operation_Origin<>Self) Begin
44748>>>>>>>            If Cmoves.Recnum Eq 0 Procedure_Return
44751>>>>>>>        End
44751>>>>>>>>
44751>>>>>>>        If (Cmoves.Cn_Code<>'') Begin
44753>>>>>>>            Clear Cn
44754>>>>>>>            Move Cmoves.Cn_Code to Cn.Cn_Code
44755>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
44756>>>>>>>>
44756>>>>>>>            Move Cn.Cn_Sls_ID      to Cmoves.Sls_ID
44757>>>>>>>            Move cn.Mhxanik_id     to Cmoves.Mhxanik_Id
44758>>>>>>>            Move Cn.CN_Cnt_ID      to Cmoves.Cnt_ID
44759>>>>>>>            Move Cn.Cn_Recr        to Cmoves.Cn_Recr
44760>>>>>>>        End
44760>>>>>>>>
44760>>>>>>>        Else Begin
44761>>>>>>>            Move ''     to Cmoves.Sls_ID
44762>>>>>>>            Move ''     to Cmoves.Cnt_ID
44763>>>>>>>            Move ''     to Cmoves.Cn_Recr
44764>>>>>>>            Move ''     to Cmoves.Mhxanik_id
44765>>>>>>>        End
44765>>>>>>>>
44765>>>>>>>        Forward Send Save_Main_File
44767>>>>>>>    End_Procedure   // Save_Main_File
44768>>>>>>>
44768>>>>>>>
44768>>>>>>>    Procedure Update
44769>>>>>>>        String sNomisma
44770>>>>>>>        Forward Send Update
44772>>>>>>>        Move SysCurXR.Company_Code      to Cmoves.Company_Code
44773>>>>>>>        Move SysCurXR.Branch_Code       to Cmoves.Branch_Code
44774>>>>>>>        //˜¤ šå¤œ«˜  £œ«˜­¦¨á ¬§¦¢¦å§à¤
44774>>>>>>>        if (pifromxrhsh(self)=1)    Move (SysCurXR.Year_Year+1) to Cmoves.Year_Year
44777>>>>>>>        else                        Move SysCurXR.Year_Year     to Cmoves.Year_Year
44779>>>>>>>        //Move Custprom.Custprom_Code to Cmoves.Custprom_Code
44779>>>>>>>        Move Clients.Client_ID          to Cmoves.Client_ID
44780>>>>>>>        Move Clients.Client_Name        to Cmoves.Client_Name
44781>>>>>>>        Move Ctypkin.Ctypkin_Descr      to Cmoves.Ctypkin_Descr
44782>>>>>>>
44782>>>>>>>        // js 28/03/2002 Gia na mhn allazei sta Copen me to Ctypkin tou CmovesA
44782>>>>>>>        If (Cmoves.Ctypkin_Code='') ;            Move Ctypkin.Ctypkin_Code   to Cmoves.Ctypkin_Code
44785>>>>>>>
44785>>>>>>>
44785>>>>>>>        Move payresp.presp_ID           to Cmoves.Presp_ID
44786>>>>>>>
44786>>>>>>>        ///an enhmeronei synolikh ofeilh pelath
44786>>>>>>>        if (Cmoves.enhm_ofeilh='1') begin
44788>>>>>>>            Add (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) to Clients.Synolikh_ofeilh
44789>>>>>>>            Add (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) to Payresp.Synolikh_ofeilh
44790>>>>>>>        end
44790>>>>>>>>
44790>>>>>>>
44790>>>>>>>        If (Cmoves.Enhm_Ypol_Pel='1') Begin
44792>>>>>>>            If (Cmoves.Cmoves_x0<>0) Begin
44794>>>>>>>                Add Cmoves.Cmoves_x0 to Clients.Xreosh
44795>>>>>>>                Add Cmoves.Cmoves_x0 to PayResp.Xreosh
44796>>>>>>>            End
44796>>>>>>>>
44796>>>>>>>            Else If (Cmoves.Cmoves_p0<>0) Begin
44799>>>>>>>                Add Cmoves.Cmoves_p0 to Clients.Pistosh
44800>>>>>>>                Add Cmoves.Cmoves_p0 to PayResp.Pistosh
44801>>>>>>>            End
44801>>>>>>>>
44801>>>>>>>        End
44801>>>>>>>>
44801>>>>>>>        If (Cmoves.Enhm_Hmnies_Pel='1') Begin
44803>>>>>>>            If (Cmoves.Cmoves_x0<>0) Begin
44805>>>>>>>                Move Cmoves.Cmoves_Hmnia   to Clients.Last_Xreosh
44806>>>>>>>                Move Cmoves.Cmoves_Hmnia   to PayResp.Last_Xreosh
44807>>>>>>>            End
44807>>>>>>>>
44807>>>>>>>            Else If (Cmoves.Cmoves_p0<>0) Begin
44810>>>>>>>                Move Cmoves.Cmoves_Hmnia   to Clients.Last_Pistosh
44811>>>>>>>                Move Cmoves.Cmoves_Hmnia   to PayResp.Last_Pistosh
44812>>>>>>>            End
44812>>>>>>>>
44812>>>>>>>        End
44812>>>>>>>>
44812>>>>>>>
44812>>>>>>>             If ((Cmoves.Cmoves_M_Code='') And (Cmoves.Module_From  <>'')) Move Cmoves.Module_From     to Cmoves.Cmoves_M_Code
44815>>>>>>>        Else If ((Cmoves.Module_From  ='') And (Cmoves.Cmoves_M_Code<>'')) Move Cmoves.Cmoves_M_Code   to Cmoves.Module_From
44819>>>>>>>
44819>>>>>>>        If (Ctypkin.Open_Item='1') Move (Cmoves.Axia_Pros_Sysx-Cmoves.Axia_Sysxet) to Cmoves.Axia_Ypol_Sysx
44822>>>>>>>        Else Begin
44823>>>>>>>            Move 0 to Cmoves.Axia_Pros_Sysx
44824>>>>>>>            Move 0 to Cmoves.Axia_Sysxet
44825>>>>>>>            Move 0 to Cmoves.Axia_Ypol_Sysx
44826>>>>>>>        End
44826>>>>>>>>
44826>>>>>>>
44826>>>>>>>        // js 23/01/2002
44826>>>>>>>        // Enhmerosh Pediou Flag_Ypol to opoio antiprosopeyei
44826>>>>>>>        // to an h eggrafh exei diathesimo ypoloipo pros sysxetish
44826>>>>>>>        Move (Cmoves.Axia_Ypol_Sysx<>0) to Cmoves.Flag_Ypol
44827>>>>>>>
44827>>>>>>>        // js 23/01/2002
44827>>>>>>>        // Enhmerosh Pediou Flag_Open to opoio antiprosopeyei
44827>>>>>>>        // an einai xreosh=1, pistosh=2, arnhtikh xreosh=2 arnhtikh Pistosh=1
44827>>>>>>>        // gia na emfanizei ta antistrofa sto copen
44827>>>>>>>        If (Ctypkin.Open_Item='1') Begin
44829>>>>>>>            If ((Cmoves.Cmoves_X0<>0) And ((Cmoves.Cmoves_P0=0))) Begin
44831>>>>>>>                Move 1                          to Cmoves.Flag_Copen
44832>>>>>>>                If (Cmoves.Cmoves_X0<0) Move 2  to Cmoves.Flag_Copen
44835>>>>>>>            End
44835>>>>>>>>
44835>>>>>>>            Else If ((Cmoves.Cmoves_P0<>0) And ((Cmoves.Cmoves_X0=0))) Begin
44838>>>>>>>                Move 2                          to Cmoves.Flag_Copen
44839>>>>>>>                If (Cmoves.Cmoves_P0<0) Move 1  to Cmoves.Flag_Copen
44842>>>>>>>            End
44842>>>>>>>>
44842>>>>>>>            Else Move 0 to Cmoves.Flag_Copen
44844>>>>>>>        End
44844>>>>>>>>
44844>>>>>>>        Else Move 0 to Cmoves.Flag_Copen
44846>>>>>>>    End_Procedure   // Update
44847>>>>>>>
44847>>>>>>>    Procedure Backout
44848>>>>>>>        Forward Send Backout
44850>>>>>>>
44850>>>>>>>        if (Cmoves.enhm_ofeilh='1') begin
44852>>>>>>>            sub (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) from Clients.Synolikh_ofeilh
44853>>>>>>>            sub (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) from Payresp.Synolikh_ofeilh
44854>>>>>>>        end
44854>>>>>>>>
44854>>>>>>>
44854>>>>>>>//        if (Cmoves.enhm_ofeilh='2') begin
44854>>>>>>>//            sub ((Cmoves.Cmoves_x0-Cmoves.cmoves_p0)*-1) from Clients.Synolikh_ofeilh
44854>>>>>>>//            sub ((Cmoves.Cmoves_x0-Cmoves.cmoves_p0)*-1) from Payresp.Synolikh_ofeilh
44854>>>>>>>//        end
44854>>>>>>>
44854>>>>>>>        If (Cmoves.Enhm_Ypol_Pel='1') Begin
44856>>>>>>>            If (Cmoves.Cmoves_x0<>0) Begin
44858>>>>>>>                Sub Cmoves.Cmoves_x0 From Clients.Xreosh
44859>>>>>>>                Sub Cmoves.Cmoves_x0 From PayResp.Xreosh
44860>>>>>>>            End
44860>>>>>>>>
44860>>>>>>>            Else If (Cmoves.Cmoves_p0<>0) Begin
44863>>>>>>>                Sub Cmoves.Cmoves_p0 From Clients.Pistosh
44864>>>>>>>                Sub Cmoves.Cmoves_p0 From PayResp.Pistosh
44865>>>>>>>            End
44865>>>>>>>>
44865>>>>>>>        End
44865>>>>>>>>
44865>>>>>>>    End_Procedure
44866>>>>>>>
44866>>>>>>>    Procedure Creating
44867>>>>>>>        Forward Send Creating
44869>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Cmoves.Cmoves_Rec0)))))) to Cmoves.Cmoves_Recr
44870>>>>>>>
44870>>>>>>>        //If ((Cmoves.Module_From='' ) Or (piFromBP(Self)<>1)) Move gs_Module_Code to Cmoves.Module_From
44870>>>>>>>
44870>>>>>>>        If (Ctypkin.Open_Item ='1') Begin
44872>>>>>>>                 If (Cmoves.Cmoves_x0<>0) Move (Abs(Cmoves.Cmoves_x0)) to Cmoves.Axia_Pros_Sysx
44875>>>>>>>            Else If (Cmoves.Cmoves_p0<>0) Move (Abs(Cmoves.Cmoves_p0)) to Cmoves.Axia_Pros_Sysx
44879>>>>>>>        End
44879>>>>>>>>
44879>>>>>>>    End_Procedure   // Creating
44880>>>>>>>
44880>>>>>>>
44880>>>>>>>
44880>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
44881>>>>>>>        String lsError_Message
44882>>>>>>>
44882>>>>>>>        Case Begin
44882>>>>>>>
44882>>>>>>>            Case (iError_Num = 6666)
44884>>>>>>>                Move "DDC 006: ‘­á¢£˜ 6666 €›ç¤˜«ž ž œšš¨˜­ž!\nƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ ¬§¦¡˜«˜©«ž£á«à¤" to lsError_Message
44885>>>>>>>            Case Break
44886>>>>>>>
44886>>>>>>>            Case (iError_Num = 6667)
44889>>>>>>>                Move "DDC 006: ‘­á¢£˜ 6667 €›ç¤˜«ž ž œšš¨˜­ž!\n†£/¤å˜ ¡å¤ž©žª §¨¦šœ¤â©«œ¨ž ž£/¤å˜ª ¡¢œ ›é£˜«¦ª" to lsError_Message
44890>>>>>>>            Case Break
44891>>>>>>>
44891>>>>>>>            Case (iError_Num = 6668)
44894>>>>>>>                Move "DDC 006: ‘­á¢£˜ 6668 €›ç¤˜«ž ž › ˜š¨˜­ã!\nƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ ¬§¦¡˜«˜©«ž£á«à¤" to lsError_Message
44895>>>>>>>            Case Break
44896>>>>>>>
44896>>>>>>>            Case (iError_Num = 6669)
44899>>>>>>>                Move "DDC 006: ‘­á¢£˜ 6669 €›ç¤˜«ž ž › ˜š¨˜­ã!\n†£/¤å˜ ¡å¤ž©žª §¨¦šœ¤â©«œ¨ž ž£/¤å˜ª ¡¢œ ›é£˜«¦ª" to lsError_Message
44900>>>>>>>            Case Break
44901>>>>>>>
44901>>>>>>>            Case (iError_Num = 22277)
44904>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n†£œ¨¦£ž¤åœª œ¡«æª ¦¨åà¤ ®¨ã©žª" to lsError_Message
44905>>>>>>>            Case Break
44906>>>>>>>
44906>>>>>>>            Case (iError_Num = 22278)
44909>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ã!\n\„®œ  «¬§àŸœ  Ÿœà¨ž£â¤¦" to lsError_Message
44910>>>>>>>            Case Break
44911>>>>>>>
44911>>>>>>>            Case (iError_Num = 22279)
44914>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\„®œ  «¬§àŸœ  Ÿœà¨ž£â¤¦" to lsError_Message
44915>>>>>>>            Case Break
44916>>>>>>>
44916>>>>>>>            Case (iError_Num = 11170)
44919>>>>>>>                Move "DDC 006:’¦ § ©«à« ¡æ æ¨ ¦ «¦¬ ­¦¨â˜ â®œ  œ¥˜¤«¢žŸœå" to lsError_Message
44920>>>>>>>            Case Break
44921>>>>>>>
44921>>>>>>>            Case (iError_Num = 11171)
44924>>>>>>>                Move "DDC 006:’¦ § ©«à« ¡æ æ¨ ¦ «¦¬ “§. ¢ž¨à£é¤ â®œ  œ¥˜¤«¢žŸœå" to lsError_Message
44925>>>>>>>            Case Break
44926>>>>>>>
44926>>>>>>>            Case (iError_Num = 11172)
44929>>>>>>>                Move "DDC 006:Ž ­¦¨â˜ª œå¤˜  ¡¢œ ›à£â¤¦ª ¢æšà § ©«à« ¡¦ç ¦¨å¦¬" to lsError_Message
44930>>>>>>>            Case Break
44931>>>>>>>
44931>>>>>>>            Case (iError_Num = 22288)
44934>>>>>>>                Clear Codemast
44935>>>>>>>                Move "MODULE" to Codemast.Type
44936>>>>>>>                Move Cmoves.Module_From to Codemast.Code
44937>>>>>>>                Find Eq Codemast by Index.1 //type+code
44938>>>>>>>>
44938>>>>>>>                Move ("DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n(† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ "+;                (Trim(Codemast.Description))+" )") to lsError_Message
44939>>>>>>>            Case Break
44940>>>>>>>
44940>>>>>>>            Case (iError_Num = 22250)
44943>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n’¦ ¡ç¡¢à£˜ (Module) «žª œšš¨˜­ãª œå¤˜  ¡œ¤æ" to lsError_Message
44944>>>>>>>            Case Break
44945>>>>>>>
44945>>>>>>>            Case (iError_Num = 22284)
44948>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ «˜ €¥ æš¨˜­˜" to lsError_Message
44949>>>>>>>            Case Break
44950>>>>>>>            Case (iError_Num = 22283)
44953>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ « ª à¢ã©œ ª" to lsError_Message
44954>>>>>>>            Case Break
44955>>>>>>>            Case (iError_Num = 22282)
44958>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ « ª €š¦¨âª" to lsError_Message
44959>>>>>>>            Case Break
44960>>>>>>>
44960>>>>>>>            //˜§æ validate delete
44960>>>>>>>            Case (iError_Num = 22289)
44963>>>>>>>                Clear Codemast
44964>>>>>>>                Move "MODULE" to Codemast.Type
44965>>>>>>>                Move Cmoves.Module_From to Codemast.Code
44966>>>>>>>                Find Eq Codemast by Index.1 //type+code
44967>>>>>>>>
44967>>>>>>>                Move ("DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n(† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ "+;                (Trim(Codemast.Description))+" )") to lsError_Message
44968>>>>>>>            Case Break
44969>>>>>>>
44969>>>>>>>            Case (iError_Num = 22287)
44972>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ «˜ €¥ æš¨˜­˜" to lsError_Message
44973>>>>>>>            Case Break
44974>>>>>>>            Case (iError_Num = 22286)
44977>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ « ª à¢ã©œ ª" to lsError_Message
44978>>>>>>>            Case Break
44979>>>>>>>            Case (iError_Num = 22285)
44982>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ « ª €š¦¨âª" to lsError_Message
44983>>>>>>>            Case Break
44984>>>>>>>
44984>>>>>>>            //â¢œš®¦  open items
44984>>>>>>>            Case (iError_Num = 10101)
44987>>>>>>>                Move ("DDC 006:€¡˜«á¢¢ž¢ž „šš¨˜­ã.\n\n"+;                "’¦ ©¬©®œ« ©£â¤¦ §¦©æ œå¤˜  £œš˜¢ç«œ¨¦\n˜§¦ «¦ ˜¨® ¡á › ˜Ÿâ© £¦ §¨¦ª ©¬©®â« ©ž");                to lsError_Message
44988>>>>>>>            Case Break
44989>>>>>>>
44989>>>>>>>            Case Else
44989>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
44991>>>>>>>        Case End
44991>>>>>>>
44991>>>>>>>        Error iError_Num lsError_Message
44992>>>>>>>>
44992>>>>>>>    End_Procedure // operation_not_allowed
44993>>>>>>>
44993>>>>>>>
44993>>>>>>>    // Define_Fields:
44993>>>>>>>    // This procedure is used to set up all data-dictionary rules.
44993>>>>>>>
44993>>>>>>>    Procedure Define_Fields
44994>>>>>>>        Forward Send Define_Fields
44996>>>>>>>        //DDB-Generated-Code-Location
44996>>>>>>>        //DDB-DefineFieldStart
44996>>>>>>>
44996>>>>>>>        Set Main_File            To Cmoves.File_Number
44997>>>>>>>        Set Cascade_Delete_State To FALSE
44998>>>>>>>
44998>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
44999>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
45000>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
45001>>>>>>>
45001>>>>>>>        // Child (Client) file structure................
45001>>>>>>>        Send Add_Client_File  Copen.File_Number
45002>>>>>>>
45002>>>>>>>        // Parent (Server) file structure...............
45002>>>>>>>        Send Add_Server_File  Ctypkin.File_Number
45003>>>>>>>        Send Add_Server_File  Clients.File_Number
45004>>>>>>>
45004>>>>>>>        // External (System) file structure.............
45004>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_NEW_SAVE_DELETE
45005>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
45006>>>>>>>
45006>>>>>>>        Define_Auto_Increment  Sysrecc.Cmoves_Rec0  To Cmoves.Cmoves_Rec0
45009>>>>>>>
45009>>>>>>>        // Field-based properties.......................
45009>>>>>>>
45009>>>>>>>        // Cmoves.Company_Code
45009>>>>>>>
45009>>>>>>>        // Cmoves.Branch_Code
45009>>>>>>>
45009>>>>>>>        // Cmoves.Year_Year
45009>>>>>>>
45009>>>>>>>        // Cmoves.Custprom_Code
45009>>>>>>>
45009>>>>>>>        // Cmoves.Client_Id
45009>>>>>>>
45009>>>>>>>        // Cmoves.Ctypkin_Code
45009>>>>>>>
45009>>>>>>>        // Cmoves.Cmoves_Recr
45009>>>>>>>
45009>>>>>>>        // Cmoves.Cmoves_Rec0
45009>>>>>>>        Set Field_Options          Field Cmoves.Cmoves_Rec0 To DD_AUTOFIND   
45010>>>>>>>
45010>>>>>>>        // Cmoves.Cmoves_Hmnia
45010>>>>>>>        Set Field_Prompt_Object    Field Cmoves.Cmoves_Hmnia To (sl006(Self))
45011>>>>>>>
45011>>>>>>>        // Cmoves.Ctypkin_Recr
45011>>>>>>>
45011>>>>>>>        // Cmoves.Cmoves_Par
45011>>>>>>>
45011>>>>>>>        // Cmoves.Partl_Recr
45011>>>>>>>        //DDB/ Comment_Short       Field Cmoves.Partl_Recr To "‘¬¤›œ©ž record £œ ¡ç¡¢à£˜ à¢ã©œà¤"
45011>>>>>>>
45011>>>>>>>        // Cmoves.Cmoves_Axia
45011>>>>>>>
45011>>>>>>>        // Cmoves.Cmoves_X0
45011>>>>>>>
45011>>>>>>>        // Cmoves.Cmoves_P0
45011>>>>>>>
45011>>>>>>>        // Cmoves.Cmoves_X00
45011>>>>>>>
45011>>>>>>>        // Cmoves.Cmoves_P00
45011>>>>>>>
45011>>>>>>>        // Cmoves.Cmoves_X1
45011>>>>>>>
45011>>>>>>>        // Cmoves.Cmoves_P1
45011>>>>>>>
45011>>>>>>>        // Cmoves.Cmoves_X2
45011>>>>>>>
45011>>>>>>>        // Cmoves.Cmoves_P2
45011>>>>>>>
45011>>>>>>>        // Cmoves.Cmoves_Dlixis
45011>>>>>>>
45011>>>>>>>        // Cmoves.Cmoves_A_Code
45011>>>>>>>
45011>>>>>>>        // Cmoves.Cmoves_Status_E
45011>>>>>>>
45011>>>>>>>        // Cmoves.Cmoves_Status_A
45011>>>>>>>
45011>>>>>>>        // Cmoves.Cmoves_S0
45011>>>>>>>
45011>>>>>>>        // Cmoves.Cmoves_Ys0
45011>>>>>>>
45011>>>>>>>        // Cmoves.Cmoves_S1
45011>>>>>>>
45011>>>>>>>        // Cmoves.Cmoves_Ys1
45011>>>>>>>
45011>>>>>>>        // Cmoves.Cmoves_S2
45011>>>>>>>
45011>>>>>>>        // Cmoves.Cmoves_Ys2
45011>>>>>>>
45011>>>>>>>        // Cmoves.Cmoves_Sc_Code2
45011>>>>>>>        Set Field_Prompt_Object    Field Cmoves.Cmoves_Sc_Code2 To (slNomism(Self))
45012>>>>>>>
45012>>>>>>>        // Cmoves.Cmoves_Open
45012>>>>>>>
45012>>>>>>>        // Cmoves.Cmoves_Aopen
45012>>>>>>>
45012>>>>>>>        // Cmoves.Cmoves_M_Code
45012>>>>>>>
45012>>>>>>>        // Cmoves.Cmoves_Yn_Myf
45012>>>>>>>
45012>>>>>>>        // Cmoves.Cmoves_Myf_Axia
45012>>>>>>>
45012>>>>>>>        // Cmoves.Cmoves_Kk
45012>>>>>>>
45012>>>>>>>        // Cmoves.Cmoves_C_Code2
45012>>>>>>>
45012>>>>>>>        // Cmoves.Cn_Code
45012>>>>>>>        Set Field_Prompt_Object    Field Cmoves.Cn_Code To (sl041(Self))
45013>>>>>>>
45013>>>>>>>        // Cmoves.Client_Recr
45013>>>>>>>
45013>>>>>>>        // Cmoves.Barticl_Recr
45013>>>>>>>
45013>>>>>>>        // Cmoves.Cmoves_Qty
45013>>>>>>>
45013>>>>>>>        // Cmoves.Cmove_Totambd0
45013>>>>>>>
45013>>>>>>>        // Cmoves.Cmove_Discam0
45013>>>>>>>
45013>>>>>>>        // Cmoves.Cmove_Totamad0
45013>>>>>>>
45013>>>>>>>        // Cmoves.Cmove_Vatam0
45013>>>>>>>
45013>>>>>>>        // Cmoves.Cmove_Extra0
45013>>>>>>>
45013>>>>>>>        // Cmoves.Cmove_Totambd00
45013>>>>>>>
45013>>>>>>>        // Cmoves.Cmove_Discam00
45013>>>>>>>
45013>>>>>>>        // Cmoves.Cmove_Totamad00
45013>>>>>>>
45013>>>>>>>        // Cmoves.Cmove_Vatam00
45013>>>>>>>
45013>>>>>>>        // Cmoves.Cmove_Extra00
45013>>>>>>>
45013>>>>>>>        // Cmoves.Cmove_Totambd1
45013>>>>>>>
45013>>>>>>>        // Cmoves.Cmove_Discam1
45013>>>>>>>
45013>>>>>>>        // Cmoves.Cmove_Totamad1
45013>>>>>>>
45013>>>>>>>        // Cmoves.Cmove_Vatam1
45013>>>>>>>
45013>>>>>>>        // Cmoves.Cmove_Extra1
45013>>>>>>>
45013>>>>>>>        // Cmoves.Module_From
45013>>>>>>>
45013>>>>>>>        // Cmoves.Parast_Abrev
45013>>>>>>>
45013>>>>>>>        // Cmoves.Enhm_Ypol_Pel
45013>>>>>>>
45013>>>>>>>        // Cmoves.Enhm_Hmnies_Pel
45013>>>>>>>
45013>>>>>>>        // Cmoves.Sls_Id
45013>>>>>>>
45013>>>>>>>        // Cmoves.Presp_Id
45013>>>>>>>
45013>>>>>>>        // Cmoves.Cnt_Id
45013>>>>>>>
45013>>>>>>>        // Cmoves.Cmoves_Open_Sx0
45013>>>>>>>
45013>>>>>>>        // Cmoves.Cmoves_Open_Sp0
45013>>>>>>>
45013>>>>>>>        // Cmoves.Cmoves_Open_Yx0
45013>>>>>>>
45013>>>>>>>        // Cmoves.Cmoves_Open_Yp0
45013>>>>>>>
45013>>>>>>>        // Cmoves.Cmoves_Open_Sx1
45013>>>>>>>
45013>>>>>>>        // Cmoves.Cmoves_Open_Sp1
45013>>>>>>>
45013>>>>>>>        // Cmoves.Cmoves_Open_Sx2
45013>>>>>>>
45013>>>>>>>        // Cmoves.Cmoves_Open_Sp2
45013>>>>>>>
45013>>>>>>>        // Cmoves.Cmoves_Topen
45013>>>>>>>
45013>>>>>>>        // Cmoves.Cn_Recr
45013>>>>>>>
45013>>>>>>>        // Cmoves.Axia_Pros_Sysx
45013>>>>>>>
45013>>>>>>>        // Cmoves.Axia_Sysxet
45013>>>>>>>
45013>>>>>>>        // Cmoves.Axia_Ypol_Sysx
45013>>>>>>>
45013>>>>>>>        // Cmoves.Axia_Pros_Sys00
45013>>>>>>>
45013>>>>>>>        // Cmoves.Axia_Sysxet00
45013>>>>>>>
45013>>>>>>>        // Cmoves.Axia_Ypol_Sys00
45013>>>>>>>
45013>>>>>>>        // Cmoves.Axia_Pros_Sysr
45013>>>>>>>
45013>>>>>>>        // Cmoves.Axia_Sysxetr
45013>>>>>>>
45013>>>>>>>        // Cmoves.Axia_Ypol_Sysr
45013>>>>>>>
45013>>>>>>>        // Cmoves.Mhxanik_Id
45013>>>>>>>
45013>>>>>>>        // Cmoves.Prn_Theor
45013>>>>>>>
45013>>>>>>>        // Cmoves.Is_Closed
45013>>>>>>>
45013>>>>>>>        // Cmoves.Flag_Copen
45013>>>>>>>
45013>>>>>>>        // Cmoves.Flag_Ypol
45013>>>>>>>
45013>>>>>>>        // Cmoves.Ctypkin_Descr
45013>>>>>>>
45013>>>>>>>        // Cmoves.Client_Name
45013>>>>>>>
45013>>>>>>>        // Cmoves.Enhm_Ofeilh
45013>>>>>>>
45013>>>>>>>        //DDB-DefineFieldEnd
45013>>>>>>>    End_Procedure    // Define_Fields
45014>>>>>>>
45014>>>>>>>    // Field_Defaults:
45014>>>>>>>    // This procedure is used to establish default field values.
45014>>>>>>>
45014>>>>>>>    Procedure Field_Defaults
45015>>>>>>>        Forward Send Field_Defaults
45017>>>>>>>        //DDB-Generated-Code-Location
45017>>>>>>>        //DDB-FieldDefaultStart
45017>>>>>>>        //DDB-FieldDefaultEnd
45017>>>>>>>    End_Procedure    // Field_Defaults
45018>>>>>>>
45018>>>>>>>End_Class    // Cmoves_DataDictionary
45019>>>>>>>//DDB-Selection-pkg-Start
45019>>>>>>>
45019>>>>>>>Use sl006.SL         // sl006
INCLUDING FILE: SL006.SL
45019>>>>>>>>>//AB/ Project sl006:Cmoves lookup
45019>>>>>>>>>//AB/     Object prj is a Lookup_Project
45019>>>>>>>>>//AB/         Set ProjectName to "sl006:Cmoves lookup"
45019>>>>>>>>>//AB/         Set ProjectFileName to "sl006.SL"
45019>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
45019>>>>>>>>>
45019>>>>>>>>>// Project Object Structure
45019>>>>>>>>>//   sl006 is a dbModalPanelSub
45019>>>>>>>>>//     Ctypkin_DD is a DataDictionary
45019>>>>>>>>>//     Clients_DD is a DataDictionary
45019>>>>>>>>>//     Cmoves_DD is a DataDictionary
45019>>>>>>>>>//     oSelList is a dbListSub
45019>>>>>>>>>//     oOK_bn is a ButtonSub
45019>>>>>>>>>//     oCancel_bn is a ButtonSub
45019>>>>>>>>>//     oSearch_bn is a ButtonSub
45019>>>>>>>>>//     Cmoves_Axia_Pros_Sysx is a dbFormSub
45019>>>>>>>>>//     Cmoves_Axia_Sysxet is a dbFormSub
45019>>>>>>>>>//     Cmoves_Axia_Ypol_Sysx is a dbFormSub
45019>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
45019>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
45019>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
45019>>>>>>>>>//     RadioGroupSub2 is a RadioGroupSub
45019>>>>>>>>>//       Radio4 is a RadioSub
45019>>>>>>>>>//       Radio5 is a RadioSub
45019>>>>>>>>>//       Radio6 is a RadioSub
45019>>>>>>>>>
45019>>>>>>>>>// Register all objects
45019>>>>>>>>>Register_Object Clients_DD
45019>>>>>>>>>Register_Object Cmoves_Axia_Pros_Sysx
45019>>>>>>>>>Register_Object Cmoves_Axia_Sysxet
45019>>>>>>>>>Register_Object Cmoves_Axia_Ypol_Sysx
45019>>>>>>>>>Register_Object Cmoves_DD
45019>>>>>>>>>Register_Object Ctypkin_DD
45019>>>>>>>>>Register_Object oCancel_bn
45019>>>>>>>>>Register_Object oOK_bn
45019>>>>>>>>>Register_Object oSearch_bn
45019>>>>>>>>>Register_Object oSelList
45019>>>>>>>>>Register_Object Radio4
45019>>>>>>>>>Register_Object Radio5
45019>>>>>>>>>Register_Object Radio6
45019>>>>>>>>>Register_Object RadioGroupSub2
45019>>>>>>>>>Register_Object sl006
45019>>>>>>>>>Register_Object TextBoxSub1
45019>>>>>>>>>Register_Object TextBoxSub2
45019>>>>>>>>>Register_Object TextBoxSub3
45019>>>>>>>>>
45019>>>>>>>>>
45019>>>>>>>>>    //AB-IgnoreStart
45019>>>>>>>>>
45019>>>>>>>>>    Use DFAllEnt.pkg
45019>>>>>>>>>    Use dbList.Sub
45019>>>>>>>>>    Use Button.Sub
45019>>>>>>>>>    Use dbForm.Sub
45019>>>>>>>>>    Use Txtbox.Sub
45019>>>>>>>>>    Use Rgroup.Sub
45019>>>>>>>>>    Use Radio.Sub
45019>>>>>>>>>
45019>>>>>>>>>
45019>>>>>>>>>    Use CTYPKIN.DD
45019>>>>>>>>>    Use CLIENTS.DD
45019>>>>>>>>>    Use CMOVES.DD
45019>>>>>>>>>    
45019>>>>>>>>>    //AB-IgnoreEnd
45019>>>>>>>>>
45019>>>>>>>>>    Object sl006 is a dbModalPanelSub
45021>>>>>>>>>
45021>>>>>>>>>        //AB-StoreTopStart
45021>>>>>>>>>                                    
45021>>>>>>>>>        Property String     psModule    Public ''
45023>>>>>>>>>        Property String     psClientID  Public ''
45025>>>>>>>>>        Property Date       pdApo       public ''
45027>>>>>>>>>        Property Date       pdEos       public ''
45029>>>>>>>>>        Property Integer    piXr_Or_Pi  public  0
45031>>>>>>>>>        Property Integer    piWhat      public  0
45033>>>>>>>>>        
45033>>>>>>>>>        //AB-StoreTopEnd
45033>>>>>>>>>
45033>>>>>>>>>        Set Label to "‰ ¤ã©œ ª ”¦¨âà¤"
45034>>>>>>>>>        Set Size to 270 519
45035>>>>>>>>>        Set Location to 5 7
45036>>>>>>>>>        Set Exit_Application_Local_State to FALSE
45037>>>>>>>>>        Set Modal_State to FALSE
45038>>>>>>>>>
45038>>>>>>>>>        //AB-DDOStart
45038>>>>>>>>>
45038>>>>>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
45040>>>>>>>>>        End_Object    // Ctypkin_DD
45041>>>>>>>>>
45041>>>>>>>>>        Object Clients_DD is a Clients_DataDictionary
45043>>>>>>>>>        End_Object    // Clients_DD
45044>>>>>>>>>
45044>>>>>>>>>        Object Cmoves_DD is a Cmoves_DataDictionary
45046>>>>>>>>>            Set DDO_Server to (Ctypkin_DD(self))
45047>>>>>>>>>            Set DDO_Server to (Clients_DD(self))
45048>>>>>>>>>
45048>>>>>>>>>            //AB-StoreStart
45048>>>>>>>>>            
45048>>>>>>>>>            Begin_Constraints
45050>>>>>>>>>            
45050>>>>>>>>>                Constrain Cmoves.Company_Code   Eq SyscurXr.Company_Code
45052>>>>>>>>>                Constrain Cmoves.Branch_Code    Eq SyscurXr.Branch_Code
45054>>>>>>>>>                Constrain Cmoves.Year_Year      Eq SyscurXr.Year_Year
45056>>>>>>>>>            
45056>>>>>>>>>                If (psClientID(Self)<>'')   Constrain Cmoves.Client_ID      Eq (psClientID(Self))
45060>>>>>>>>>                If (pdApo(Self)<>'')        Constrain Cmoves.Cmoves_Hmnia   Ge (pdApo(Self))
45064>>>>>>>>>                If (pdEos(Self)<>'')        Constrain Cmoves.Cmoves_Hmnia   Le (pdEos(Self))
45068>>>>>>>>>            
45068>>>>>>>>>                Constrain Cmoves.Module_From    Eq (psModule(Self))
45070>>>>>>>>>            
45070>>>>>>>>>                     If (piWhat(Self)=1) Constrain Cmoves.Flag_Ypol Eq 1
45074>>>>>>>>>                Else If (piWhat(Self)=2) Constrain Cmoves.Flag_Ypol Eq 0
45079>>>>>>>>>            
45079>>>>>>>>>            End_Constraints
45082>>>>>>>>>            
45082>>>>>>>>>            
45082>>>>>>>>>            
45082>>>>>>>>>            
45082>>>>>>>>>            
45082>>>>>>>>>            
45082>>>>>>>>>            
45082>>>>>>>>>            
45082>>>>>>>>>            
45082>>>>>>>>>            
45082>>>>>>>>>            
45082>>>>>>>>>            
45082>>>>>>>>>            
45082>>>>>>>>>            
45082>>>>>>>>>            
45082>>>>>>>>>            
45082>>>>>>>>>            
45082>>>>>>>>>            
45082>>>>>>>>>            
45082>>>>>>>>>            
45082>>>>>>>>>            
45082>>>>>>>>>            
45082>>>>>>>>>            
45082>>>>>>>>>            
45082>>>>>>>>>            
45082>>>>>>>>>            //AB-StoreEnd
45082>>>>>>>>>
45082>>>>>>>>>        End_Object    // Cmoves_DD
45083>>>>>>>>>
45083>>>>>>>>>        Set Main_DD to (Cmoves_DD(self))
45084>>>>>>>>>        Set Server to (Cmoves_DD(self))
45085>>>>>>>>>
45085>>>>>>>>>        //AB-DDOEnd
45085>>>>>>>>>
45085>>>>>>>>>        Object oSelList is a dbListSub
45087>>>>>>>>>
45087>>>>>>>>>            //AB-StoreTopStart
45087>>>>>>>>>                                                                                                                                                                                                                                                                                                                    
45087>>>>>>>>>            //AB-StoreTopEnd
45087>>>>>>>>>
45087>>>>>>>>>            Set Main_File to Cmoves.File_Number
45088>>>>>>>>>            Set Ordering to 4
45089>>>>>>>>>            Set Size to 199 505
45090>>>>>>>>>            Set Location to 31 7
45091>>>>>>>>>            Set Auto_Index_State to FALSE
45092>>>>>>>>>
45092>>>>>>>>>            Begin_Row
45095>>>>>>>>>                Entry_Item Cmoves.Cmoves_hmnia
45096>>>>>>>>>                Entry_Item Cmoves.Cmoves_par
45097>>>>>>>>>                Entry_Item Ctypkin.Ctypkin_descr
45098>>>>>>>>>                Entry_Item Clients.Client_name
45099>>>>>>>>>                Entry_Item Cmoves.Cmoves_axia
45100>>>>>>>>>                Entry_Item Cmoves.Cmoves_sc_code2
45101>>>>>>>>>                Entry_Item Cmoves.Module_from
45102>>>>>>>>>            End_Row
45107>>>>>>>>>
45107>>>>>>>>>            Set Form_Width    item 0 to 57
45108>>>>>>>>>            Set Header_Label  item 0 to "†£œ¨/¤å˜"
45109>>>>>>>>>            
45109>>>>>>>>>            Set Form_Width    item 1 to 121
45110>>>>>>>>>            Set Header_Label  item 1 to "€ « ¦¢¦šå˜"
45111>>>>>>>>>            
45111>>>>>>>>>            Set Form_Width    item 2 to 65
45112>>>>>>>>>            Set Header_Label  item 2 to "‰å¤ž©ž"
45113>>>>>>>>>            
45113>>>>>>>>>            Set Form_Width    item 3 to 107
45114>>>>>>>>>            Set Header_Label  item 3 to "‘¬¤˜¢¢˜©æ£œ¤¦ª"
45115>>>>>>>>>            
45115>>>>>>>>>            Set Form_Width    item 4 to 63
45116>>>>>>>>>            Set Header_Label  item 4 to " €¥å˜"
45117>>>>>>>>>            
45117>>>>>>>>>            Set Form_Width    item 5 to 42
45118>>>>>>>>>            Set Header_Label  item 5 to "Œæ£ ©£˜"
45119>>>>>>>>>            
45119>>>>>>>>>            Set Form_Width    item 6 to 45
45120>>>>>>>>>            Set Header_Label  item 6 to "‰ç¡¢à£˜"
45121>>>>>>>>>            
45121>>>>>>>>>
45121>>>>>>>>>            //AB-StoreStart
45121>>>>>>>>>                                                                                                                                                                                                                                                                                                                    
45121>>>>>>>>>            Procedure End_Construct_Object
45123>>>>>>>>>                String  sNom
45124>>>>>>>>>                Integer iDecs
45124>>>>>>>>>                Forward Send End_Construct_Object
45126>>>>>>>>>                Move SysCurxr.C_Code0 to sNom
45127>>>>>>>>>                Clear Nomisma
45128>>>>>>>>>                Move sNom to Nomisma.Nomisma_Code
45129>>>>>>>>>                Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
45130>>>>>>>>>>
45130>>>>>>>>>                If (Found=1)    Move Nomisma.Dekadika to iDecs
45133>>>>>>>>>                Else            Move 0 to iDecs
45135>>>>>>>>>            
45135>>>>>>>>>                // Ž¨ ¦¬£œ §àª ˜¤ «¦ ™˜© ¡æ ¤¦£ ©£˜ ®¨ã©žª ƒ„Œ œ®œ  ›œ¡˜› ¡á
45135>>>>>>>>>                // «æ«œ œ¥' ¦¨ ©£¦ç ™á¦¬£œ œ£œ ª 2
45135>>>>>>>>>                If (iDecs=0) Move 2 to iDecs
45138>>>>>>>>>                //
45138>>>>>>>>>            
45138>>>>>>>>>                Set Points          Item 4 to       iDecs
45139>>>>>>>>>                Set Numeric_Mask    Item 4 to 14    iDecs '*, '
45140>>>>>>>>>            End_Procedure
45141>>>>>>>>>            
45141>>>>>>>>>            
45141>>>>>>>>>            
45141>>>>>>>>>            
45141>>>>>>>>>            
45141>>>>>>>>>            //AB-StoreEnd
45141>>>>>>>>>
45141>>>>>>>>>        End_Object    // oSelList
45142>>>>>>>>>
45142>>>>>>>>>        Object oOK_bn is a ButtonSub
45144>>>>>>>>>            Set Label to "&„§ ¢¦šã"
45145>>>>>>>>>            Set Location to 236 350
45146>>>>>>>>>
45146>>>>>>>>>            //AB-StoreStart
45146>>>>>>>>>            Procedure OnClick
45148>>>>>>>>>                Send OK To (oSelList(current_object))
45149>>>>>>>>>            End_Procedure
45150>>>>>>>>>            //AB-StoreEnd
45150>>>>>>>>>
45150>>>>>>>>>        End_Object    // oOK_bn
45151>>>>>>>>>
45151>>>>>>>>>        Object oCancel_bn is a ButtonSub
45153>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
45154>>>>>>>>>            Set Location to 236 404
45155>>>>>>>>>
45155>>>>>>>>>            //AB-StoreStart
45155>>>>>>>>>            Procedure OnClick
45157>>>>>>>>>                Send Cancel To (oSelList(current_object))
45158>>>>>>>>>            End_Procedure
45159>>>>>>>>>            //AB-StoreEnd
45159>>>>>>>>>
45159>>>>>>>>>        End_Object    // oCancel_bn
45160>>>>>>>>>
45160>>>>>>>>>        Object oSearch_bn is a ButtonSub
45162>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
45163>>>>>>>>>            Set Location to 236 460
45164>>>>>>>>>
45164>>>>>>>>>            //AB-StoreStart
45164>>>>>>>>>            Procedure OnClick
45166>>>>>>>>>                Send Search To (oSelList(current_object))
45167>>>>>>>>>            End_Procedure
45168>>>>>>>>>            //AB-StoreEnd
45168>>>>>>>>>
45168>>>>>>>>>        End_Object    // oSearch_bn
45169>>>>>>>>>
45169>>>>>>>>>        Object Cmoves_Axia_Pros_Sysx is a dbFormSub
45171>>>>>>>>>            Entry_Item Cmoves.Axia_pros_sysx
45172>>>>>>>>>            Set Size to 13 54
45173>>>>>>>>>            Set Location to 236 24
45174>>>>>>>>>            Set Color to clBtnFace
45175>>>>>>>>>            Set Label_Col_Offset to 2
45176>>>>>>>>>            Set Label_Justification_Mode to jMode_Right
45177>>>>>>>>>            Set Enabled_State to FALSE
45178>>>>>>>>>            Set Item_Shadow_State Item 0 to TRUE
45179>>>>>>>>>            Set Shadow_State Item 0 to TRUE
45180>>>>>>>>>
45180>>>>>>>>>            //AB-StoreStart
45180>>>>>>>>>            Set points item 0 to 2
45181>>>>>>>>>            Set Numeric_Mask Item 0 to 8 2 ' ,*'
45182>>>>>>>>>            
45182>>>>>>>>>            //AB-StoreEnd
45182>>>>>>>>>
45182>>>>>>>>>        End_Object    // Cmoves_Axia_Pros_Sysx
45183>>>>>>>>>
45183>>>>>>>>>        Object Cmoves_Axia_Sysxet is a dbFormSub
45185>>>>>>>>>            Entry_Item Cmoves.Axia_sysxet
45186>>>>>>>>>            Set Size to 13 54
45187>>>>>>>>>            Set Location to 236 140
45188>>>>>>>>>            Set Color to clBtnFace
45189>>>>>>>>>            Set Label_Col_Offset to 2
45190>>>>>>>>>            Set Label_Justification_Mode to jMode_Right
45191>>>>>>>>>            Set Enabled_State to FALSE
45192>>>>>>>>>            Set Item_Shadow_State Item 0 to TRUE
45193>>>>>>>>>            Set Shadow_State Item 0 to TRUE
45194>>>>>>>>>
45194>>>>>>>>>            //AB-StoreStart
45194>>>>>>>>>            Set points item 0 to 2
45195>>>>>>>>>            Set Numeric_Mask Item 0 to 8 2 ' ,*'
45196>>>>>>>>>            
45196>>>>>>>>>            //AB-StoreEnd
45196>>>>>>>>>
45196>>>>>>>>>        End_Object    // Cmoves_Axia_Sysxet
45197>>>>>>>>>
45197>>>>>>>>>        Object Cmoves_Axia_Ypol_Sysx is a dbFormSub
45199>>>>>>>>>            Entry_Item Cmoves.Axia_ypol_sysx
45200>>>>>>>>>            Set Size to 13 54
45201>>>>>>>>>            Set Location to 236 248
45202>>>>>>>>>            Set Color to clBtnFace
45203>>>>>>>>>            Set Label_Col_Offset to 2
45204>>>>>>>>>            Set Label_Justification_Mode to jMode_Right
45205>>>>>>>>>            Set Enabled_State to FALSE
45206>>>>>>>>>            Set Item_Shadow_State Item 0 to TRUE
45207>>>>>>>>>            Set Shadow_State Item 0 to TRUE
45208>>>>>>>>>
45208>>>>>>>>>            //AB-StoreStart
45208>>>>>>>>>                                                                                            
45208>>>>>>>>>            Set points item 0 to 2
45209>>>>>>>>>            Set Numeric_Mask Item 0 to 8 2 ' ,*'
45210>>>>>>>>>            
45210>>>>>>>>>            //AB-StoreEnd
45210>>>>>>>>>
45210>>>>>>>>>        End_Object    // Cmoves_Axia_Ypol_Sysx
45211>>>>>>>>>
45211>>>>>>>>>        Object TextBoxSub1 is a TextBoxSub
45213>>>>>>>>>            Set Label to "€¥å˜"
45214>>>>>>>>>            Set Location to 238 7
45215>>>>>>>>>            Set Size to 10 15
45216>>>>>>>>>        End_Object    // TextBoxSub1
45217>>>>>>>>>
45217>>>>>>>>>        Object TextBoxSub2 is a TextBoxSub
45219>>>>>>>>>            Set Label to "‘¬©®œ« ©£â¤ž"
45220>>>>>>>>>            Set Location to 238 89
45221>>>>>>>>>            Set Size to 10 49
45222>>>>>>>>>        End_Object    // TextBoxSub2
45223>>>>>>>>>
45223>>>>>>>>>        Object TextBoxSub3 is a TextBoxSub
45225>>>>>>>>>            Set Label to "ƒ ˜Ÿâ© £ž"
45226>>>>>>>>>            Set Location to 238 210
45227>>>>>>>>>            Set Size to 10 35
45228>>>>>>>>>        End_Object    // TextBoxSub3
45229>>>>>>>>>
45229>>>>>>>>>        Object RadioGroupSub2 is a RadioGroupSub
45231>>>>>>>>>            Set Label to "„§ ¢¦šã ‰ ¤ã©œà¤"
45232>>>>>>>>>            Set Size to 24 497
45233>>>>>>>>>            Set Location to 3 9
45234>>>>>>>>>            Object Radio4 is a RadioSub
45236>>>>>>>>>                Set Label to "Ž¢œª"
45237>>>>>>>>>                Set Size to 10 37
45238>>>>>>>>>                Set Location to 10 97
45239>>>>>>>>>            End_Object    // Radio4
45240>>>>>>>>>
45240>>>>>>>>>            Object Radio5 is a RadioSub
45242>>>>>>>>>                Set Label to "‹œ ¬§æ¢¦ §¦ ©¬©®â« ©žª"
45243>>>>>>>>>                Set Size to 10 97
45244>>>>>>>>>                Set Location to 10 167
45245>>>>>>>>>            End_Object    // Radio5
45246>>>>>>>>>
45246>>>>>>>>>            Object Radio6 is a RadioSub
45248>>>>>>>>>                Set Label to "•à¨åª ¬§æ¢¦ §¦ ©¬©®â« ©žª"
45249>>>>>>>>>                Set Size to 10 111
45250>>>>>>>>>                Set Location to 10 278
45251>>>>>>>>>            End_Object    // Radio6
45252>>>>>>>>>
45252>>>>>>>>>
45252>>>>>>>>>            //AB-StoreStart
45252>>>>>>>>>                                                                                
45252>>>>>>>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
45254>>>>>>>>>                Set piWhat to iToItem
45255>>>>>>>>>                Send Rebuild_Constraints to Cmoves_DD
45256>>>>>>>>>                Send Beginning_Of_Data To oSelList True
45257>>>>>>>>>            End_Procedure
45258>>>>>>>>>            
45258>>>>>>>>>            Set Current_Radio to 1
45259>>>>>>>>>            
45259>>>>>>>>>            
45259>>>>>>>>>            
45259>>>>>>>>>            
45259>>>>>>>>>            //AB-StoreEnd
45259>>>>>>>>>
45259>>>>>>>>>        End_Object    // RadioGroupSub2
45260>>>>>>>>>
45260>>>>>>>>>
45260>>>>>>>>>        //AB-StoreStart
45260>>>>>>>>>                                    
45260>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
45261>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
45262>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
45263>>>>>>>>>        
45263>>>>>>>>>        Set Modal_State to True
45264>>>>>>>>>        
45264>>>>>>>>>        Procedure Activate
45266>>>>>>>>>            String  sNom
45267>>>>>>>>>            Integer iDecs rVal
45267>>>>>>>>>            Set piWhat to 1
45268>>>>>>>>>            Set Current_Radio Of RadioGroupSub2 to 1
45269>>>>>>>>>            Forward Send Activate
45271>>>>>>>>>            Send Rebuild_Constraints        to Cmoves_DD
45272>>>>>>>>>            Send Beginning_Of_Data          to oSelList True
45273>>>>>>>>>        End_procedure
45274>>>>>>>>>        
45274>>>>>>>>>        
45274>>>>>>>>>        
45274>>>>>>>>>        
45274>>>>>>>>>        
45274>>>>>>>>>        
45274>>>>>>>>>        
45274>>>>>>>>>        
45274>>>>>>>>>        
45274>>>>>>>>>        
45274>>>>>>>>>        
45274>>>>>>>>>        
45274>>>>>>>>>        
45274>>>>>>>>>        
45274>>>>>>>>>        
45274>>>>>>>>>        
45274>>>>>>>>>        
45274>>>>>>>>>        
45274>>>>>>>>>        
45274>>>>>>>>>        
45274>>>>>>>>>        
45274>>>>>>>>>        
45274>>>>>>>>>        
45274>>>>>>>>>        
45274>>>>>>>>>        
45274>>>>>>>>>        
45274>>>>>>>>>        //AB-StoreEnd
45274>>>>>>>>>
45274>>>>>>>>>    End_Object    // sl006
45275>>>>>>>>>
45275>>>>>>>>>//AB/     End_Object    // prj
45275>>>>>>>Use slnomism.sl      // slNomism
INCLUDING FILE: SLNOMISM.SL
45275>>>>>>>>>//AB/ Project slNomism
45275>>>>>>>>>//AB/ Object prj is a Lookup_Project
45275>>>>>>>>>//AB/     Set ProjectName to "slNomism"
45275>>>>>>>>>//AB/     Set ProjectFileName to "slNomism.SL"
45275>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
45275>>>>>>>>>
45275>>>>>>>>>// Project Object Structure
45275>>>>>>>>>//   slNomism is a dbModalPanelSub
45275>>>>>>>>>//     Nomisma_DD is a DataDictionary
45275>>>>>>>>>//     oSelList is a dbListSub
45275>>>>>>>>>//     oOK_bn is a ButtonSub
45275>>>>>>>>>//     oSearch_bn is a ButtonSub
45275>>>>>>>>>
45275>>>>>>>>>// Register all objects
45275>>>>>>>>>Register_Object Nomisma_DD
45275>>>>>>>>>Register_Object oOK_bn
45275>>>>>>>>>Register_Object oSearch_bn
45275>>>>>>>>>Register_Object oSelList
45275>>>>>>>>>Register_Object slNomism
45275>>>>>>>>>
45275>>>>>>>>>
45275>>>>>>>>>//AB-IgnoreStart
45275>>>>>>>>>
45275>>>>>>>>>Use DFAllEnt.pkg
45275>>>>>>>>>Use dbList.Sub
45275>>>>>>>>>Use Button.Sub
45275>>>>>>>>>
45275>>>>>>>>>
45275>>>>>>>>>Use NOMISMA.DD
45275>>>>>>>>>
45275>>>>>>>>>//AB-IgnoreEnd
45275>>>>>>>>>
45275>>>>>>>>>Object slNomism is a dbModalPanelSub
45277>>>>>>>>>
45277>>>>>>>>>    //AB-StoreTopStart
45277>>>>>>>>>    
45277>>>>>>>>>    
45277>>>>>>>>>    
45277>>>>>>>>>    //AB-StoreTopEnd
45277>>>>>>>>>
45277>>>>>>>>>    Set Label to "Œ¦£å©£˜«˜"
45278>>>>>>>>>    Set Size to 175 397
45279>>>>>>>>>    Set Location to 5 7
45280>>>>>>>>>    Set Exit_Application_Local_State to FALSE
45281>>>>>>>>>    Set Modal_State to FALSE
45282>>>>>>>>>
45282>>>>>>>>>    //AB-DDOStart
45282>>>>>>>>>
45282>>>>>>>>>    Object Nomisma_DD is a Nomisma_DataDictionary
45284>>>>>>>>>    End_Object    // Nomisma_DD
45285>>>>>>>>>
45285>>>>>>>>>    Set Main_DD to (Nomisma_DD(self))
45286>>>>>>>>>    Set Server to (Nomisma_DD(self))
45287>>>>>>>>>
45287>>>>>>>>>    //AB-DDOEnd
45287>>>>>>>>>
45287>>>>>>>>>    Object oSelList is a dbListSub
45289>>>>>>>>>        Set Main_File to Nomisma.File_Number
45290>>>>>>>>>        Set Size to 130 382
45291>>>>>>>>>        Set Location to 6 6
45292>>>>>>>>>
45292>>>>>>>>>        Begin_Row
45295>>>>>>>>>            Entry_Item Nomisma.Nomisma_code
45296>>>>>>>>>            Entry_Item Nomisma.Nomisma_descr
45297>>>>>>>>>            Entry_Item Nomisma.Dekadika
45298>>>>>>>>>            Entry_Item Nomisma.Euro_zone
45299>>>>>>>>>            Entry_Item Nomisma.Einai_drx
45300>>>>>>>>>            Entry_Item Nomisma.Einai_euro
45301>>>>>>>>>        End_Row
45306>>>>>>>>>
45306>>>>>>>>>        Set Form_Width    item 0 to 49
45307>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
45308>>>>>>>>>        
45308>>>>>>>>>        Set Form_Width    item 1 to 115
45309>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
45310>>>>>>>>>        
45310>>>>>>>>>        Set Form_Width    item 2 to 47
45311>>>>>>>>>        Set Header_Label  item 2 to "ƒœ¡˜› ¡á"
45312>>>>>>>>>        
45312>>>>>>>>>        Set Form_Width    item 3 to 55
45313>>>>>>>>>        Set Header_Label  item 3 to "…é¤ž EURO"
45314>>>>>>>>>        Set Column_Checkbox_State  item 3 to True
45315>>>>>>>>>        
45315>>>>>>>>>        Set Form_Width    item 4 to 55
45316>>>>>>>>>        Set Header_Label  item 4 to "„å¤˜  ƒ•"
45317>>>>>>>>>        Set Column_Checkbox_State  item 4 to True
45318>>>>>>>>>        
45318>>>>>>>>>        Set Form_Width    item 5 to 55
45319>>>>>>>>>        Set Header_Label  item 5 to "„å¤˜  „¬¨é"
45320>>>>>>>>>        Set Column_Checkbox_State  item 5 to True
45321>>>>>>>>>        
45321>>>>>>>>>
45321>>>>>>>>>        //AB-StoreStart
45321>>>>>>>>>        
45321>>>>>>>>>        //AB-StoreEnd
45321>>>>>>>>>
45321>>>>>>>>>    End_Object    // oSelList
45322>>>>>>>>>
45322>>>>>>>>>    Object oOK_bn is a ButtonSub
45324>>>>>>>>>        Set Label to "&„§ ¢¦šã"
45325>>>>>>>>>        Set Location to 140 279
45326>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45327>>>>>>>>>
45327>>>>>>>>>        //AB-StoreStart
45327>>>>>>>>>        Procedure OnClick
45329>>>>>>>>>            Send OK To (oSelList(current_object))
45330>>>>>>>>>        End_Procedure
45331>>>>>>>>>        //AB-StoreEnd
45331>>>>>>>>>
45331>>>>>>>>>    End_Object    // oOK_bn
45332>>>>>>>>>
45332>>>>>>>>>    Object oSearch_bn is a ButtonSub
45334>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
45335>>>>>>>>>        Set Location to 140 339
45336>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45337>>>>>>>>>
45337>>>>>>>>>        //AB-StoreStart
45337>>>>>>>>>        
45337>>>>>>>>>        Procedure OnClick
45339>>>>>>>>>            Send Search To (oSelList(current_object))
45340>>>>>>>>>        End_Procedure
45341>>>>>>>>>        
45341>>>>>>>>>        
45341>>>>>>>>>        Set Visible_State to False
45342>>>>>>>>>        Set Enabled_State to False
45343>>>>>>>>>        //AB-StoreEnd
45343>>>>>>>>>
45343>>>>>>>>>    End_Object    // oSearch_bn
45344>>>>>>>>>
45344>>>>>>>>>
45344>>>>>>>>>    //AB-StoreStart
45344>>>>>>>>>    
45344>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
45345>>>>>>>>>    
45345>>>>>>>>>    On_Key Key_Alt+Key_s Send KeyAction To (oSearch_bn(current_object))
45346>>>>>>>>>    
45346>>>>>>>>>    
45346>>>>>>>>>    
45346>>>>>>>>>    
45346>>>>>>>>>    //AB-StoreEnd
45346>>>>>>>>>
45346>>>>>>>>>End_Object    // slNomism
45347>>>>>>>>>
45347>>>>>>>>>//AB/ End_Object    // prj
45347>>>>>>>Use sl041.SL         // sl041
45347>>>>>>>
45347>>>>>>>//DDB-Selection-pkg-End
45347>>>>>>>//DDB-FileEnd
45347>>>>>    Use CFLAGKIN.DD
INCLUDING FILE: CFLAGKIN.DD
45347>>>>>>>//DDB-FileStart
45347>>>>>>>//DDB-HeaderStart
45347>>>>>>>
45347>>>>>>>// File Name : CFLAGKIN.DD
45347>>>>>>>// Class Name: Cflagkin_DataDictionary
45347>>>>>>>// Revision  : 28
45347>>>>>>>// Version   : 2
45347>>>>>>>
45347>>>>>>>Use  Windows           // Basic Definitions
45347>>>>>>>Use  DataDict          // DataDictionary Class Definition
45347>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
45347>>>>>>>
45347>>>>>>>Open Cflagkin
45349>>>>>>>Open Ctypkin
45351>>>>>>>Open Sysrecc
45353>>>>>>>Open Syscurxr
45355>>>>>>>
45355>>>>>>>//DDB-HeaderEnd
45355>>>>>>>//DDB-ValidationStart
45355>>>>>>>
45355>>>>>>>Register_Object Cflagkin_Flag
45355>>>>>>>
45355>>>>>>>Object Cflagkin_Flag  is a CodeValidationTable
45357>>>>>>>    Set Type_Value        To "CFLAGS"
45358>>>>>>>    //DDB-ValidationCustomStart
45358>>>>>>>    //DDB-ValidationCustomEnd
45358>>>>>>>End_Object   // Cflagkin_Flag
45359>>>>>>>//DDB-ValidationEnd
45359>>>>>>>
45359>>>>>>>Class Cflagkin_DataDictionary  is a DataDictionary
45360>>>>>>>
45360>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
45361>>>>>>>        String lsError_Message
45362>>>>>>>        Case Begin
45362>>>>>>>            Case (iError_Num = 7001)
45364>>>>>>>                Move "DDC 008:ƒœ¤ œ§ «¨â§¦¤«˜  Flags ˜¤à «à¤ 2 ¯ž­åà¤" to lsError_Message
45365>>>>>>>            Case Break
45366>>>>>>>            Case (iError_Num = 7002)
45369>>>>>>>                Move "DDC 008:ƒœ¤ œ§ «¨â§¦¤«˜  Flags £ž›œ¤ ¡á" to lsError_Message
45370>>>>>>>            Case Break
45371>>>>>>>            Case Else
45371>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
45373>>>>>>>        Case End
45373>>>>>>>        Error iError_Num lsError_Message
45374>>>>>>>>
45374>>>>>>>    End_Procedure // operation_not_allowed
45375>>>>>>>
45375>>>>>>>    Function Validate_Save  Returns Integer
45376>>>>>>>        Integer iReturnVal
45377>>>>>>>        Forward Get Validate_Save  To iReturnVal
45379>>>>>>>        If (Not(iReturnVal)) Begin
45381>>>>>>>                 If (Length(Trim(Cflagkin.Cflagkin_Flag))>2)    Move 7001 to iReturnVal
45384>>>>>>>            Else If (Cflagkin.Flag_Numeric=0)                   Move 7002 to iReturnVal
45388>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
45391>>>>>>>        End
45391>>>>>>>>
45391>>>>>>>        Function_Return iReturnVal
45392>>>>>>>    End_Function   // Validate_Save
45393>>>>>>>
45393>>>>>>>    Procedure Update
45394>>>>>>>        Forward Send Update
45396>>>>>>>        // Insert Code Here
45396>>>>>>>//        Move SysCurXR.Company_Code  to Cflagkin.Company_Code
45396>>>>>>>//        Move SysCurXR.Branch_Code   to Cflagkin.Branch_Code
45396>>>>>>>//        Move SysCurXR.Year_Year     to Cflagkin.Year_Year
45396>>>>>>>        Move Ctypkin.Ctypkin_Code   to Cflagkin.Ctypkin_Code
45397>>>>>>>        Move Cflagkin.Cflagkin_Flag to Cflagkin.Flag_Numeric
45398>>>>>>>    End_Procedure   // Update
45399>>>>>>>
45399>>>>>>>    Procedure Creating
45400>>>>>>>        Forward Send Creating
45402>>>>>>>        // Insert Code Here
45402>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Cflagkin.Cflagkin_Rec0)))))) to Cflagkin.Cflagkin_Recr
45403>>>>>>>    End_Procedure   // Creating
45404>>>>>>>
45404>>>>>>>    // Define_Fields:
45404>>>>>>>    // This procedure is used to set up all data-dictionary rules.
45404>>>>>>>
45404>>>>>>>    Procedure Define_Fields
45405>>>>>>>        Forward Send Define_Fields
45407>>>>>>>        //DDB-Generated-Code-Location
45407>>>>>>>        //DDB-DefineFieldStart
45407>>>>>>>
45407>>>>>>>        Set Main_File            To Cflagkin.File_Number
45408>>>>>>>        Set Cascade_Delete_State To FALSE
45409>>>>>>>
45409>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
45410>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
45411>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
45412>>>>>>>
45412>>>>>>>        // Parent (Server) file structure...............
45412>>>>>>>        Send Add_Server_File  Ctypkin.File_Number
45413>>>>>>>
45413>>>>>>>        // External (System) file structure.............
45413>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
45414>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
45415>>>>>>>
45415>>>>>>>        Define_Auto_Increment  Sysrecc.Cflagkin_Rec0  To Cflagkin.Cflagkin_Rec0
45418>>>>>>>
45418>>>>>>>        // Field-based properties.......................
45418>>>>>>>
45418>>>>>>>        // Cflagkin.Company_Code
45418>>>>>>>
45418>>>>>>>        // Cflagkin.Branch_Code
45418>>>>>>>
45418>>>>>>>        // Cflagkin.Year_Year
45418>>>>>>>
45418>>>>>>>        // Cflagkin.Ctypkin_Code
45418>>>>>>>
45418>>>>>>>        // Cflagkin.Cflagkin_Flag
45418>>>>>>>        Set Field_Value_Table      Field Cflagkin.Cflagkin_Flag To (Cflagkin_Flag(Self))
45419>>>>>>>
45419>>>>>>>        // Cflagkin.Ctypkin_Recr
45419>>>>>>>
45419>>>>>>>        // Cflagkin.Cflagkin_Descr
45419>>>>>>>
45419>>>>>>>        // Cflagkin.Cflagkin_Rec0
45419>>>>>>>        Set Field_Options          Field Cflagkin.Cflagkin_Rec0 To DD_AUTOFIND   
45420>>>>>>>
45420>>>>>>>        // Cflagkin.Cflagkin_Recr
45420>>>>>>>
45420>>>>>>>        // Cflagkin.Flag_Numeric
45420>>>>>>>
45420>>>>>>>        //DDB-DefineFieldEnd
45420>>>>>>>    End_Procedure    // Define_Fields
45421>>>>>>>
45421>>>>>>>    // Field_Defaults:
45421>>>>>>>    // This procedure is used to establish default field values.
45421>>>>>>>
45421>>>>>>>    Procedure Field_Defaults
45422>>>>>>>        Forward Send Field_Defaults
45424>>>>>>>        //DDB-Generated-Code-Location
45424>>>>>>>        //DDB-FieldDefaultStart
45424>>>>>>>        //DDB-FieldDefaultEnd
45424>>>>>>>    End_Procedure    // Field_Defaults
45425>>>>>>>
45425>>>>>>>End_Class    // Cflagkin_DataDictionary
45426>>>>>>>//DDB-FileEnd
45426>>>>>    Use BTYPKIN.DD
INCLUDING FILE: BTYPKIN.DD
45426>>>>>>>//DDB-FileStart
45426>>>>>>>//DDB-HeaderStart
45426>>>>>>>
45426>>>>>>>// File Name : BTYPKIN.DD
45426>>>>>>>// Class Name: Btypkin_DataDictionary
45426>>>>>>>// Revision  : 108
45426>>>>>>>// Version   : 2
45426>>>>>>>
45426>>>>>>>Use  Windows           // Basic Definitions
45426>>>>>>>Use  DataDict          // DataDictionary Class Definition
45426>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
45426>>>>>>>
45426>>>>>>>Open Btypkin
45428>>>>>>>Open Bflagkin
INCLUDING FILE: BFLAGKIN.FD
45430>>>>>>>Open Bkinkat
45432>>>>>>>Open Barticl
INCLUDING FILE: BARTICL.FD
45434>>>>>>>Open Sysrecb
45436>>>>>>>
45436>>>>>>>//DDB-HeaderEnd
45436>>>>>>>//DDB-ValidationStart
45436>>>>>>>
45436>>>>>>>//DDB/ ExternalValidationTable Bfile_VT  Baxio.pkg
45436>>>>>>>
45436>>>>>>>Register_Object Bfile_VT
45436>>>>>>>Register_Object Btypkin_Btypkin_Anti_Xp_VT
45436>>>>>>>Use Baxio.pkg        // Bfile_VT
45436>>>>>>>
45436>>>>>>>Object Btypkin_Btypkin_Anti_Xp_VT  is a DescriptionValidationTable
45438>>>>>>>
45438>>>>>>>    Procedure Fill_List
45440>>>>>>>        Forward Send Fill_List
45442>>>>>>>        Send Add_Table_Value  "1"  "•¨œé¤œ«˜ "
45443>>>>>>>        Send Add_Table_Value  "2"  " ©«é¤œ«˜ "
45444>>>>>>>    End_Procedure    // Fill_List
45445>>>>>>>    //DDB-ValidationCustomStart
45445>>>>>>>    //DDB-ValidationCustomEnd
45445>>>>>>>End_Object   // Btypkin_Btypkin_Anti_Xp_VT
45446>>>>>>>//DDB-ValidationEnd
45446>>>>>>>//DDB-SelectionStart
45446>>>>>>>//DDB/ ExternalSelectionList SL031  SL031.SL
45446>>>>>>>//DDB/ ExternalSelectionList sl007  sl007.SL
45446>>>>>>>//DDB/ ExternalSelectionList sl007r  sl007r.SL
45446>>>>>>>Register_Object SL031
45446>>>>>>>Register_Object sl007
45446>>>>>>>Register_Object sl007r
45446>>>>>>>//DDB-SelectionEnd
45446>>>>>>>
45446>>>>>>>// JSJSJSJS 24/01/2001 Register_Object SL056 //¢å©«˜ gplan
45446>>>>>>>//Register_Object SL056 //¢å©«˜ vendor
45446>>>>>>>
45446>>>>>>>
45446>>>>>>>Open SysCurXr
45448>>>>>>>
45448>>>>>>>Open Barticl //©œ«á¨œ  prompt objects
45450>>>>>>>// JSJSJSJS 24/01/2001 Open Gtypkin //™¨å©¡œ  rec0 ©«ž¤ update, externalyy updated, lock on save
45450>>>>>>>//Open Ctypkin //™¨å©¡œ  rec0 ©«ž¤ update, externalyy updated, lock on save
45450>>>>>>>//Open Vtypkin //™¨å©¡œ  rec0 ©«ž¤ update, externalyy updated, lock on save
45450>>>>>>>
45450>>>>>>>
45450>>>>>>>// JSJSJSJS 24/01/2001 Use SL056.SL //¢å©«˜ gplan
45450>>>>>>>//Use SL102.SL //¢å©«˜ customer
45450>>>>>>>//Use SL???.SL //¢å©«˜ vendor
45450>>>>>>>Use sl100.sl // Clients selection list
45450>>>>>>>
45450>>>>>>>//*********************************************************************************
45450>>>>>>>//*          A N A L Y S I S                                                      *
45450>>>>>>>//*********************************************************************************
45450>>>>>>>//† ¡áŸœ ¡å¤ž©ž ˜¥ ¦š¨á­à¤ ˜§¦«œ¢œå £å˜ ©¬¤˜¢¢˜šã.
45450>>>>>>>//„§¦£â¤àª ¦¨åœ«˜  £¦¤¦©ã£˜¤«˜ â¤˜ª ©¬¤˜¢¢˜©æ£œ¤¦ª
45450>>>>>>>
45450>>>>>>>//’é¨˜, ¦  › á­¦¨¦  «ç§¦  ©¬¤˜¢¢˜©¦£â¤à¤ §¦¬ ¬§¦©«ž¨åœ  «¦ ©ç©«ž£˜ ©ã£œ¨˜, œå¤˜ 
45450>>>>>>>//¦  œ¥ãª : 1  "Š¦š˜¨ ˜©£æª ‚Š : contsrained ¢å©«˜ gplan apo-eos Btypkin.Gplan_Code_Apo
45450>>>>>>>//                                                               Btypkin.Gplan_Code_Apo
45450>>>>>>>//                               ©«ž¤ §œ¨å§«à©ž ˜¬«ã, ¦ ¢¦š˜¨ ˜©£æª §¦¬ Ÿ˜ œ§ ¢œšœå
45450>>>>>>>//                               ©«¦ barticl, Ÿ˜ "­áœ " «ž¤ ®¨âà©ž/§å©«à©ž §¦¬ â®¦¬£œ
45450>>>>>>>//                               ›ž¢é©œ  ©«¦ §œ›å¦ Btypkin.Btypkin_Anti_Xp.
45450>>>>>>>//          2  "œ¢á«žª        : ¢å©«˜ customer
45450>>>>>>>//          3  "¨¦£žŸœ¬«ãª    : ¢å©«˜ vendor
45450>>>>>>>//          4  "Š¦ §¦å         : œá¤ «¦ modula ˜¥ ¦š¨á­à¤ §¦¬¢žŸœå ˜¬«æ¤¦£˜,
45450>>>>>>>//                               «æ«œ «¦¤ ©¬¤˜¢¢˜©æ£œ¤¦ ˜§¢éª «¦¤ §¢ž¡«¨¦¢¦š¦ç£œ.
45450>>>>>>>
45450>>>>>>>//† ©¬¤˜¢¢˜šã šå¤œ«˜  £œ ˜¥ æš¨˜­˜, á¨˜ §¨â§œ  ¤˜ š¤à¨å¦¬£œ œá¤ Ÿ˜ › ˜¡ ¤ã©¦¬£œ
45450>>>>>>>//£æ¤¦¤ 1 «ç§¦ ˜¥ ¦š¨á­à¤, ã §¦¢¢¦çª (§œ›å¦ Btypkin.Baxiokat_Code).
45450>>>>>>>//„á¤ ˜¬«æ œå¤˜  0, «æ«œ ©«¦ grid «¦¬ bmove ¦ user £˜ª ›ž¢é¤œ  baxiokat,
45450>>>>>>>//˜¢¢¦ éª «¦ §œ›å¦ œå¤˜  ¡¢œ ›à£â¤¦.
45450>>>>>>>
45450>>>>>>>Class Btypkin_DataDictionary  is a DataDictionary_Sec
45451>>>>>>>
45451>>>>>>>    Procedure Construct_Object
45452>>>>>>>              Forward Send Construct_Object
45454>>>>>>>
45454>>>>>>>              //object id «é¤ ddo servers š ˜ «á barticl+bmove+baxio+baxiokat
45454>>>>>>>              //©œ«á¨¦¤«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
45454>>>>>>>              //®¨ž© £œç¦¬¤ ©«ž¤ private.exit_btypkin_code
45454>>>>>>>              //š ˜ ¤˜ ©œ«á¨¦¬¤ «¦ visual interface
45454>>>>>>>              Property Integer piBarticl_dd  0
45455>>>>>>>              Property Integer piBmove_dd    0
45456>>>>>>>              Property Integer piBaxio_dd    0
45457>>>>>>>              Property Integer piBaxiokat_dd 0
45458>>>>>>>              Property Integer piMustNOTConstrain Public 0
45459>>>>>>>    End_Procedure   //construct_object
45460>>>>>>>
45460>>>>>>>//      //private
45460>>>>>>>//      //¡˜¢œå«˜  ˜§¦ «ž¤ private.Exit_Btypkin_Code
45460>>>>>>>//      Procedure private.Set_Prompt_Objects_of_all_Connected_DEOs Integer liPrompt_Object_id ;
45460>>>>>>>//                                                                 Integer liField            ;
45460>>>>>>>//                                                                 Integer iMustConstrain     ;
45460>>>>>>>//                                                                 String  sPelProm
45460>>>>>>>//                Integer iMax iCount iDEO liTemp liBarticl_dd iPelListID
45460>>>>>>>
45460>>>>>>>//                Move (sl100(Self)) to iPelListID
45460>>>>>>>//             //   den exei nohma giati den kanoyn tipota sthn lista
45460>>>>>>>//             //   If (iPelListID) Set piMustConstrain     Of iPelListID to 0
45460>>>>>>>//             //   If (iPelListID) Set psIsPromhtheyths    Of iPelListID to ''
45460>>>>>>>
45460>>>>>>>//                Get piBarticl_dd to liBarticl_dd
45460>>>>>>>//                If (liBarticl_dd <> 0);
45460>>>>>>>//                Begin //œá¤ æ¤«àª ¬§á¨®œ  client ddo £œ main file «¦ barticl
45460>>>>>>>//                     Get Data_Set_User_Interface_Count of liBarticl_dd to iMax
45460>>>>>>>//                     Decrement iMax
45460>>>>>>>//                     For iCount from 0 to iMax
45460>>>>>>>//                         Move (Data_Set_User_Interface(liBarticl_dd ,iCount)) to iDEO
45460>>>>>>>//                         Get Data_Field of iDEO Item 0 to liTemp
45460>>>>>>>//                         If (liTemp = liField);
45460>>>>>>>//                         Begin //œá¤ ™¨ž¡˜ deo (dfform?) §¦¬ ˜¤˜­â¨œ«˜  ©«¦ §œ›å¦ ©¬¤˜¢¢˜©æ£œ¤¦ª
45460>>>>>>>//                            If (liPrompt_Object_id <> 0);
45460>>>>>>>//                               Begin
45460>>>>>>>//                                  Set Prompt_Object      of iDEO to liPrompt_Object_id
45460>>>>>>>//                                  Set Prompt_Button_Mode of iDEO to PB_promptOn
45460>>>>>>>//                                  If (iMustConstrain) Begin
45460>>>>>>>//                                  //   den exei nohma giati den kanoyn tipota sthn lista
45460>>>>>>>//                                  //  If (liPrompt_Object_id) Set piMustConstrain     Of liPrompt_Object_id to iMustConstrain
45460>>>>>>>//                                  //  If (liPrompt_Object_id) Set psIsPromhtheyths    Of liPrompt_Object_id to sPelProm
45460>>>>>>>//                                  End
45460>>>>>>>//                            End
45460>>>>>>>//                            Else Begin
45460>>>>>>>//                                Set Prompt_Object      of iDEO to 0
45460>>>>>>>//                                Set Prompt_Button_Mode of iDEO to PB_promptOff
45460>>>>>>>//                            End
45460>>>>>>>//                         End
45460>>>>>>>//                     Loop
45460>>>>>>>//                End
45460>>>>>>>//      End_Procedure //private.set_prompt_objects_of_all_connected_dEOS
45460>>>>>>>
45460>>>>>>>
45460>>>>>>>//    //private
45460>>>>>>>//    //¡˜¢œå«˜  ˜§æ: iexit «¦¬ btypkin_code
45460>>>>>>>//    //¡˜¢œå    «ã¤: private.Set_Prompt_Objects_of_all_Connected_DEOS
45460>>>>>>>//    //©œ«á¨œ      : «á prompt objects š ˜ «¦ barticl_anti, ˜¤á¢¦š˜ £œ «¦ btypkin_anti.
45460>>>>>>>//    Procedure private.Exit_Btypkin_Code Integer liField Integer liBtypkin_Code
45460>>>>>>>//              Integer liBtypkin_Anti1 liBaxiokat_Num liBtypkin_Anti2
45460>>>>>>>//              Integer liBaxiokat_dd liBarticl_dd
45460>>>>>>>//              String lsBarticlCode1
45460>>>>>>>
45460>>>>>>>//            // btypkin_anti
45460>>>>>>>//            // "-1" "ƒâ¤ “§á¨®œ "
45460>>>>>>>//            // "0"  "Data Entry"
45460>>>>>>>//            // "1"  "Š¦š˜¨ ˜©£é¤ ‚Š"
45460>>>>>>>//            // "2"  "”¦¨â˜ª"
45460>>>>>>>//            // "3"  "¨¦£žŸœ¬«é¤"
45460>>>>>>>//            // "5"  "Ž ‘¬¤˜¢¢˜©æ£œ¤¦ª"
45460>>>>>>>//            // "6"  "’œ¢.˜¨˜¢ã§«žª"
45460>>>>>>>
45460>>>>>>>
45460>>>>>>>
45460>>>>>>>//              Get Field_Current_Value Field Btypkin.Btypkin_Anti1 to liBtypkin_Anti1
45460>>>>>>>//              Get Field_Current_Value Field Btypkin.Btypkin_Anti2 to liBtypkin_Anti2
45460>>>>>>>//              Case Begin
45460>>>>>>>//                   Case (liBtypkin_Anti1 = 1) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ š¢
45460>>>>>>>//                         Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0 Field Barticl.Barticl_Code1 0 ''
45460>>>>>>>//                   Case Break
45460>>>>>>>
45460>>>>>>>//                   Case (liBtypkin_Anti1 = 2) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §œ¢á«œª
45460>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code1 1 ''
45460>>>>>>>//                   Case Break
45460>>>>>>>
45460>>>>>>>//                   Case (liBtypkin_Anti1 = 3) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §¨¦£žŸœ¬«âª=> ¢ ©«˜ §œ¢˜«à¤
45460>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code1 1 '1'
45460>>>>>>>//                   Case Break
45460>>>>>>>
45460>>>>>>>//                   Case Else //=4 ¢¦ §¦å:©¬¤˜¢¢˜©æ£œ¤¦ª £œ user manual data entry
45460>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0  Field Barticl.Barticl_Code1 0 ''
45460>>>>>>>//                   Case Break
45460>>>>>>>//              Case End
45460>>>>>>>
45460>>>>>>>//              Case Begin
45460>>>>>>>//                   Case (liBtypkin_Anti2 = 1) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ š¢
45460>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0 Field Barticl.Barticl_Code2 0 ''
45460>>>>>>>//                   Case Break
45460>>>>>>>
45460>>>>>>>//                   Case (liBtypkin_Anti2 = 2) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §œ¢á«œª
45460>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code2 1 ''
45460>>>>>>>//                   Case Break
45460>>>>>>>
45460>>>>>>>//                   Case (liBtypkin_Anti2 = 3) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §¨¦£žŸœ¬«âª=> Š ©«˜ œ¢˜«é¤
45460>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code2 1 '1'
45460>>>>>>>//                   Case Break
45460>>>>>>>
45460>>>>>>>//                   Case Else //=4 ¢¦ §¦å:©¬¤˜¢¢˜©æ£œ¤¦ª £œ user manual data entry
45460>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0  Field Barticl.Barticl_Code2 0 ''
45460>>>>>>>//                   Case Break
45460>>>>>>>//              Case End
45460>>>>>>>//    End_Procedure //private.exit_btypkin_code
45460>>>>>>>
45460>>>>>>>//    // New_Current_Record:
45460>>>>>>>
45460>>>>>>>//    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
45460>>>>>>>//        Integer liBtypkinCodeFldNum
45460>>>>>>>//        Forward Send New_Current_Record  iOldRec iNewRec
45460>>>>>>>//        Get_FieldNumber Btypkin.Btypkin_Code to liBtypkinCodeFldNum
45460>>>>>>>//        Send private.Exit_Btypkin_Code liBtypkinCodeFldNum Btypkin.Btypkin_Code
45460>>>>>>>//        // Insert Code Here
45460>>>>>>>//    End_Procedure   // New_Current_Record
45460>>>>>>>
45460>>>>>>>
45460>>>>>>>    //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
45460>>>>>>>    //™) ˜¤áš¤à©ž properties
45460>>>>>>>    //š) › ˜®œå¨ ©ž calculated §œ›åà¤
45460>>>>>>>    //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
45460>>>>>>>    //œ) œ¤ž£â¨à©ž properties after
45460>>>>>>>    Procedure Update
45461>>>>>>>
45461>>>>>>>              Forward Send Update
45463>>>>>>>
45463>>>>>>>              //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
45463>>>>>>>                Move SysCurXR.Company_Code  to Btypkin.Company_Code
45464>>>>>>>                Move SysCurXR.Branch_Code   to Btypkin.Branch_Code
45465>>>>>>>                Move SysCurXR.Year_Year     to Btypkin.Year_Year
45466>>>>>>>                Move SysCurXR.Year_Recr     to Btypkin.Year_Recr
45467>>>>>>>
45467>>>>>>>              //™) ˜¤áš¤à©ž properties
45467>>>>>>>
45467>>>>>>>              //š) › ˜®œå¨ ©ž calculated §œ›åà¤
45467>>>>>>>              //š.1:Gplan_Code_Apo1 (conditional)
45467>>>>>>>              //š.2:Gplan_Code_Eos1 (conditional)
45467>>>>>>>              If (Btypkin.Btypkin_Anti1 <> 1);              Begin //æ®  ˜§¦ šœ¤ ¡ã ¢¦š ©« ¡ã
45469>>>>>>>                   Move "" to Btypkin.Gplan_Code_Apo1
45470>>>>>>>                   Move "" to Btypkin.Gplan_Code_Eos1
45471>>>>>>>              End
45471>>>>>>>>
45471>>>>>>>
45471>>>>>>>              //š.3:Gplan_Code_Apo2 (conditional)
45471>>>>>>>              //š.4:Gplan_Code_Eos2 (conditional)
45471>>>>>>>              If (Btypkin.Btypkin_Anti2 <> 1);              Begin //æ®  ˜§¦ šœ¤ ¡ã ¢¦š ©« ¡ã
45473>>>>>>>                   Move "" to Btypkin.Gplan_Code_Apo2
45474>>>>>>>                   Move "" to Btypkin.Gplan_Code_Eos2
45475>>>>>>>              End
45475>>>>>>>>
45475>>>>>>>
45475>>>>>>>              //š.3:gtypkin_rec0 (conditional)
45475>>>>>>>              Case Begin
45475>>>>>>>                   Case (Btypkin.Gtypkin_Code <> 0) //œ¤ž£œ¨é¤œ  šœ¤ ¡ã ¢¦š ©« ¡ã
45477>>>>>>>//jsjsjs 24/01/2001
45477>>>>>>>//                         Clear Gtypkin
45477>>>>>>>//                         Move Btypkin.Company_Code to Gtypkin.Company_Code
45477>>>>>>>//                         Move Btypkin.Branch_Code  to Gtypkin.Branch_Code
45477>>>>>>>//                         Move Btypkin.Year_Year    to Gtypkin.Year_Year
45477>>>>>>>//                         Move Btypkin.Gtypkin_Code to Gtypkin.Gtypkin_Code
45477>>>>>>>//                         Find Eq Gtypkin by Index.1 //company_code+branch_code+year_year+gtypkin_code
45477>>>>>>>//                         If (Found = 1) Move Gtypkin.Gtypkin_Rec0 to Btypkin.Gtypkin_Rec0
45477>>>>>>>//                         Else           Send Operation_Not_Allowed 3001 //›â¤ ™¨âŸž¡œ «¦ gtypkin_rec0, please reindex
45477>>>>>>>//jsjsjs 24/01/2001
45477>>>>>>>                   Case Break
45478>>>>>>>                   Case Else                        //›â¤ œ¤ž£œ¨é¤œ  šœ¤ ¡ã ¢¦š ©« ¡ã
45478>>>>>>>                         Move 0 to Btypkin.Gtypkin_Rec0
45479>>>>>>>              Case End
45479>>>>>>>
45479>>>>>>>              //š.4:ctypkin_rec0 (conditional)
45479>>>>>>>              Case Begin
45479>>>>>>>                   Case (Btypkin.Ctypkin_Code <> 0) //œ¤ž£œ¨é¤œ  §œ¢á«œª
45481>>>>>>>                         Clear Ctypkin
45482>>>>>>>                         Move Btypkin.Company_Code to Ctypkin.Company_Code
45483>>>>>>>                         Move Btypkin.Branch_Code  to Ctypkin.Branch_Code
45484>>>>>>>                         Move Btypkin.Year_Year    to Ctypkin.Year_Year
45485>>>>>>>                         Move Btypkin.Ctypkin_Code to Ctypkin.Ctypkin_Code
45486>>>>>>>                         Find Eq Ctypkin by Index.1 //company_code+branch_code+year_year+Ctypkin_code
45487>>>>>>>>
45487>>>>>>>                         If (Found = 1) Begin
45489>>>>>>>                            Move Ctypkin.Ctypkin_Rec0 to Btypkin.Ctypkin_Rec0
45490>>>>>>>                            Move Ctypkin.Ctypkin_Recr to Btypkin.Ctypkin_Recr
45491>>>>>>>                         End
45491>>>>>>>>
45491>>>>>>>                         Else           Send Operation_Not_Allowed 3002 //›â¤ ™¨âŸž¡œ «¦ Ctypkin_rec0, please reindex
45493>>>>>>>                   Case Break
45494>>>>>>>                   Case Else                        //›â¤ œ¤ž£œ¨é¤œ  §œ¢á«œª
45494>>>>>>>                         Move  0 to Btypkin.Ctypkin_Rec0
45495>>>>>>>                         Move '' to Btypkin.Ctypkin_Recr
45496>>>>>>>              Case End
45496>>>>>>>
45496>>>>>>>              //š.5:vtypkin_rec0 (conditional)
45496>>>>>>>              Case Begin
45496>>>>>>>                   Case (Btypkin.Vtypkin_Code <> 0) //œ¤ž£œ¨é¤œ  §¨¦£žŸœ¬«âª
45498>>>>>>>                         //Clear Vtypkin
45498>>>>>>>                         //Move Btypkin.Company_Code to Vtypkin.Company_Code
45498>>>>>>>                         //Move Btypkin.Branch_Code  to Vtypkin.Branch_Code
45498>>>>>>>                         //Move Btypkin.Year_Year    to Vtypkin.Year_Year
45498>>>>>>>                         //Move Btypkin.Vtypkin_Code to Vtypkin.Vtypkin_Code
45498>>>>>>>                         //Find Eq Vtypkin by Index.1 //company_code+branch_code+year_year+Vtypkin_code
45498>>>>>>>                         //If (Found = 1) Move Vtypkin.Vtypkin_Rec0 to Btypkin.Vtypkin_Rec0
45498>>>>>>>                         //Else           Send Operation_Not_Allowed 3003 //›â¤ ™¨âŸž¡œ «¦ Vtypkin_rec0, please reindex
45498>>>>>>>                   Case Break
45499>>>>>>>                   Case Else                        //›â¤ œ¤ž£œ¨é¤œ  §¨¦£žŸœ¬«âª
45499>>>>>>>                         Move 0 to Btypkin.Vtypkin_Rec0
45500>>>>>>>              Case End
45500>>>>>>>
45500>>>>>>>              //š.6:btypkin_l_hmnia (conditional)
45500>>>>>>>              If (Btypkin.Btypkin_L_No = 0) Move 0 to Btypkin.Btypkin_L_Hmnia
45503>>>>>>>
45503>>>>>>>
45503>>>>>>>              //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
45503>>>>>>>
45503>>>>>>>              //œ) œ¤ž£â¨à©ž properties after
45503>>>>>>>    End_Procedure //update
45504>>>>>>>
45504>>>>>>>    Procedure Creating
45505>>>>>>>              Forward Send Creating
45507>>>>>>>              //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBtypkin //˜¨ Ÿ£æª á¨Ÿ¨à¤ «žª ®¨ã©žª
45507>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Btypkin.Btypkin_Rec0)))))) to Btypkin.Btypkin_Recr
45508>>>>>>>    End_Procedure //creating
45509>>>>>>>
45509>>>>>>>//    Procedure OnConstrain
45509>>>>>>>//        Set piMustNOTConstrain to True
45509>>>>>>>        
45509>>>>>>>//        If (piMustNOTConstrain(Self)) Begin
45509>>>>>>>//        End
45509>>>>>>>//        Else Begin
45509>>>>>>>//            Constrain Btypkin.Company_Code  eq SysCurXR.Company_Code
45509>>>>>>>//            Constrain Btypkin.Branch_Code   eq SysCurXR.Branch_Code
45509>>>>>>>//            Constrain Btypkin.Year_Year     eq SysCurXR.Year_Year
45509>>>>>>>//        End
45509>>>>>>>//    End_Procedure
45509>>>>>>>
45509>>>>>>>
45509>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
45510>>>>>>>              String lsError_Message
45511>>>>>>>              Case Begin
45511>>>>>>>                   //˜§æ validate save
45511>>>>>>>                   Case (iError_Num = 1001)
45513>>>>>>>                        //Move ("DDC 141:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n† «¨¦§¦§¦åž©ž œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");
45513>>>>>>>                        //to lsError_Message
45513>>>>>>>                   Case Break
45514>>>>>>>                   Case (iError_Num = 1100)
45517>>>>>>>                        Move "DDC 141:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
45518>>>>>>>                        Case Break
45519>>>>>>>
45519>>>>>>>                   //˜§æ validate delete
45519>>>>>>>                   Case (iError_Num = 2001)
45522>>>>>>>                        //Clear Codemast
45522>>>>>>>                        //Move ("DDC 141:€›ç¤˜«ž ž › ˜š¨˜­ã !\n\n† › ˜š¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");
45522>>>>>>>                        //to lsError_Message
45522>>>>>>>                   Case Break
45523>>>>>>>                   Case (iError_Num = 2100)
45526>>>>>>>                        Move "DDC 141:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
45527>>>>>>>                        Case Break
45528>>>>>>>
45528>>>>>>>                   //˜§æ update
45528>>>>>>>                   Case (iError_Num = 3001)
45531>>>>>>>                        Move ("DDC 141:ƒâ¤ ™¨âŸž¡œ ž ˜¤«å©«¦ ®ž ¡å¤ž©ž «žª ‚œ¤ ¡ãª Š¦š ©« ¡ãª !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
45532>>>>>>>                   Case Break
45533>>>>>>>                   Case (iError_Num = 3002)
45536>>>>>>>                        Move ("DDC 141:ƒâ¤ ™¨âŸž¡œ ž ˜¤«å©«¦ ®ž ¡å¤ž©ž «é¤ œ¢˜«é¤ !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
45537>>>>>>>                   Case Break
45538>>>>>>>                   Case (iError_Num = 3003)
45541>>>>>>>                        Move ("DDC 141:ƒâ¤ ™¨âŸž¡œ ž ˜¤«å©«¦ ®ž ¡å¤ž©ž «é¤ ¨¦£žŸœ¬«é¤ !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
45542>>>>>>>                   Case Break
45543>>>>>>>
45543>>>>>>>
45543>>>>>>>
45543>>>>>>>                   Case Else
45543>>>>>>>                        Forward Send Operation_Not_Allowed iError_Num
45545>>>>>>>              Case End
45545>>>>>>>
45545>>>>>>>              Error iError_Num lsError_Message
45546>>>>>>>>
45546>>>>>>>    End_Procedure // operation_not_allowed
45547>>>>>>>
45547>>>>>>>
45547>>>>>>>//    //1001:
45547>>>>>>>//    //˜§˜š¦¨œçœ«˜  «¦ btypkin ¤˜ ˜¢¢áœ  parent year
45547>>>>>>>//    Function Validate_Save Returns Integer
45547>>>>>>>//             Integer iReturnVal
45547>>>>>>>
45547>>>>>>>//             Forward Get Validate_Save to iReturnVal
45547>>>>>>>
45547>>>>>>>//             If (Not(iReturnVal));
45547>>>>>>>//             Begin
45547>>>>>>>//                  //1100:cby = globals
45547>>>>>>>//                  If ( ;
45547>>>>>>>//                      (Not(Btypkin.Company_Code = SysCurXR.Company_Code))or ;
45547>>>>>>>//                      (Not(Btypkin.Branch_Code  = SysCurXR.Branch_Code)) or ;
45547>>>>>>>//                      (Not(Btypkin.Year_Year    = SysCurXR.Year_Year))      ;
45547>>>>>>>//                      )                                                   Send Operation_Not_Allowed 1100
45547>>>>>>>//             End //«â¢¦ª ¡é› ¡˜ validation
45547>>>>>>>//             Function_Return iReturnVal
45547>>>>>>>//    End_Function   // validate_save
45547>>>>>>>
45547>>>>>>>
45547>>>>>>>//    //2001:
45547>>>>>>>//    Function Validate_Delete  Returns Integer
45547>>>>>>>//             Integer iReturnVal
45547>>>>>>>//             Forward Get Validate_Delete  To iReturnVal
45547>>>>>>>//             If (Not(iReturnVal));
45547>>>>>>>//             Begin
45547>>>>>>>
45547>>>>>>>//                  //2100:cby = globals
45547>>>>>>>//                  If ( ;
45547>>>>>>>//                      (Not(Btypkin.Company_Code = SysCurXR.Company_Code))or ;
45547>>>>>>>//                      (Not(Btypkin.Branch_Code  = SysCurXR.Branch_Code)) or ;
45547>>>>>>>//                      (Not(Btypkin.Year_Year    = SysCurXR.Year_Year))      ;
45547>>>>>>>//                      )                                                   Send Operation_Not_Allowed 2100
45547>>>>>>>//             End //«â¢¦ª ¡é› ¡˜ validation
45547>>>>>>>//             Function_Return iReturnVal
45547>>>>>>>//    End_Function   // Validate_Delete
45547>>>>>>>
45547>>>>>>>
45547>>>>>>>    Procedure Define_Fields
45548>>>>>>>        Forward Send Define_Fields
45550>>>>>>>        //DDB-Generated-Code-Location
45550>>>>>>>        //DDB-DefineFieldStart
45550>>>>>>>
45550>>>>>>>        Set Main_File            To Btypkin.File_Number
45551>>>>>>>        Set Cascade_Delete_State To FALSE
45552>>>>>>>
45552>>>>>>>
45552>>>>>>>        // Child (Client) file structure................
45552>>>>>>>        Send Add_Client_File  Bflagkin.File_Number
45553>>>>>>>        Send Add_Client_File  Bkinkat.File_Number
45554>>>>>>>        Send Add_Client_File  Barticl.File_Number
45555>>>>>>>
45555>>>>>>>        // External (System) file structure.............
45555>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
45556>>>>>>>
45556>>>>>>>        Define_Auto_Increment  Sysrecb.Btypkin_Rec0  To Btypkin.Btypkin_Rec0
45559>>>>>>>
45559>>>>>>>        // Field-based properties.......................
45559>>>>>>>
45559>>>>>>>        // Btypkin.Company_Code
45559>>>>>>>        //DDB/ Comment_Short       Field Btypkin.Company_Code To "„¤ž£œ¨é¤œ«˜  ©«ž¤ update"
45559>>>>>>>
45559>>>>>>>        // Btypkin.Branch_Code
45559>>>>>>>        //DDB/ Comment_Short       Field Btypkin.Branch_Code To "„¤ž£œ¨é¤œ«˜  ©«ž¤ update"
45559>>>>>>>
45559>>>>>>>        // Btypkin.Year_Year
45559>>>>>>>        //DDB/ Comment_Short       Field Btypkin.Year_Year To "„¤ž£œ¨é¤œ«˜  ©«ž¤ update"
45559>>>>>>>
45559>>>>>>>        // Btypkin.Btypkin_Code
45559>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Code To (SL031(Self))
45560>>>>>>>
45560>>>>>>>        // Btypkin.Btypkin_Rec0
45560>>>>>>>
45560>>>>>>>        // Btypkin.Btypkin_Recr
45560>>>>>>>
45560>>>>>>>        // Btypkin.Year_Recr
45560>>>>>>>
45560>>>>>>>        // Btypkin.Btypkin_Descr
45560>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Descr To (SL031(Self))
45561>>>>>>>
45561>>>>>>>        // Btypkin.Gtypkin_Code
45561>>>>>>>
45561>>>>>>>        // Btypkin.Ctypkin_Code
45561>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Ctypkin_Code To (sl007(Self))
45562>>>>>>>
45562>>>>>>>        // Btypkin.Vtypkin_Code
45562>>>>>>>
45562>>>>>>>        // Btypkin.Gtypkin_Rec0
45562>>>>>>>
45562>>>>>>>        // Btypkin.Ctypkin_Rec0
45562>>>>>>>
45562>>>>>>>        // Btypkin.Vtypkin_Rec0
45562>>>>>>>
45562>>>>>>>        // Btypkin.Btypkin_Anti1
45562>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti1 To (Bfile_VT(Self))
45563>>>>>>>
45563>>>>>>>        // Btypkin.Gplan_Code_Apo1
45563>>>>>>>
45563>>>>>>>        // Btypkin.Gplan_Code_Eos1
45563>>>>>>>
45563>>>>>>>        // Btypkin.Btypkin_Anti2
45563>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti2 To (Bfile_VT(Self))
45564>>>>>>>
45564>>>>>>>        // Btypkin.Gplan_Code_Apo2
45564>>>>>>>
45564>>>>>>>        // Btypkin.Gplan_Code_Eos2
45564>>>>>>>
45564>>>>>>>        // Btypkin.Bflagkin_Num
45564>>>>>>>
45564>>>>>>>        // Btypkin.Bkinkat_Num
45564>>>>>>>        //DDB/ Comment_Short       Field Btypkin.Bkinkat_Num To "“§¦¢¦šåœ«˜  ©«ž¤ update «¦¬ bkinkat."
45564>>>>>>>
45564>>>>>>>        // Btypkin.Btypkin_Anti_Xp
45564>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti_Xp To (Btypkin_Btypkin_Anti_Xp_VT(Self))
45565>>>>>>>
45565>>>>>>>        // Btypkin.Btypkin_Printer
45565>>>>>>>
45565>>>>>>>        // Btypkin.Btypkin_Pdescr
45565>>>>>>>
45565>>>>>>>        // Btypkin.Btypkin_Form
45565>>>>>>>
45565>>>>>>>        // Btypkin.Btypkin_L_No
45565>>>>>>>
45565>>>>>>>        // Btypkin.Btypkin_L_Hmnia
45565>>>>>>>        Set Field_Mask_Type        Field Btypkin.Btypkin_L_Hmnia To MASK_DATE_WINDOW
45566>>>>>>>
45566>>>>>>>        // Btypkin.Btypkin_Seira
45566>>>>>>>
45566>>>>>>>        // Btypkin.Btypkin_Abr
45566>>>>>>>
45566>>>>>>>        // Btypkin.Btypkin_Flag01
45566>>>>>>>        //DDB/ Comment_Short       Field Btypkin.Btypkin_Flag01 To "“§¦¢¦šåœ«˜  ©«ž¤ update/backout «¦¬ bflagkin."
45566>>>>>>>
45566>>>>>>>        // Btypkin.Btypkin_Flag02
45566>>>>>>>
45566>>>>>>>        // Btypkin.Btypkin_Flag03
45566>>>>>>>
45566>>>>>>>        // Btypkin.Btypkin_Flag04
45566>>>>>>>
45566>>>>>>>        // Btypkin.Btypkin_Flag05
45566>>>>>>>        Set Field_Checkbox_Values  Field Btypkin.Btypkin_Flag05 To "1"  "0"
45567>>>>>>>
45567>>>>>>>        // Btypkin.Btypkin_Flag06
45567>>>>>>>
45567>>>>>>>        // Btypkin.Btypkin_Flag07
45567>>>>>>>
45567>>>>>>>        // Btypkin.Btypkin_Flag08
45567>>>>>>>
45567>>>>>>>        // Btypkin.Btypkin_Flag09
45567>>>>>>>
45567>>>>>>>        // Btypkin.Btypkin_Flag10
45567>>>>>>>
45567>>>>>>>        // Btypkin.Btypkin_Flag11
45567>>>>>>>
45567>>>>>>>        // Btypkin.Btypkin_Flag12
45567>>>>>>>
45567>>>>>>>        // Btypkin.Btypkin_Flag13
45567>>>>>>>
45567>>>>>>>        // Btypkin.Btypkin_Flag14
45567>>>>>>>
45567>>>>>>>        // Btypkin.Btypkin_Flag15
45567>>>>>>>
45567>>>>>>>        // Btypkin.Btypkin_Flag16
45567>>>>>>>
45567>>>>>>>        // Btypkin.Btypkin_Flag17
45567>>>>>>>
45567>>>>>>>        // Btypkin.Btypkin_Flag18
45567>>>>>>>
45567>>>>>>>        // Btypkin.Btypkin_Flag19
45567>>>>>>>
45567>>>>>>>        // Btypkin.Btypkin_Flag20
45567>>>>>>>
45567>>>>>>>        // Btypkin.Btypkin_Sign
45567>>>>>>>        Set Field_Checkbox_Values  Field Btypkin.Btypkin_Sign To "1"  "-1"
45568>>>>>>>
45568>>>>>>>        // Btypkin.Ctypkin_Recr
45568>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Ctypkin_Recr To (sl007r(Self))
45569>>>>>>>
45569>>>>>>>        // Btypkin.Label
45569>>>>>>>
45569>>>>>>>        //DDB-DefineFieldEnd
45569>>>>>>>
45569>>>>>>>        Set Main_File            To Btypkin.File_Number
45570>>>>>>>        Set Cascade_Delete_State To FALSE
45571>>>>>>>
45571>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
45572>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
45573>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
45574>>>>>>>
45574>>>>>>>        // Child (Client) file structure................
45574>>>>>>>        Send Add_Client_File  Bflagkin.File_Number
45575>>>>>>>        Send Add_Client_File  Barticl.File_Number
45576>>>>>>>        Send Add_Client_File  Bkinkat.File_Number
45577>>>>>>>
45577>>>>>>>        // External (System) file structure.............
45577>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
45578>>>>>>>        //Send Add_System_File  Gtypkin.File_Number  DD_LOCK_ON_SAVE
45578>>>>>>>
45578>>>>>>>        Define_Auto_Increment  Sysrecb.Btypkin_Rec0  To Btypkin.Btypkin_Rec0
45581>>>>>>>
45581>>>>>>>        // Field-based properties.......................
45581>>>>>>>
45581>>>>>>>        // Btypkin.Company_Code
45581>>>>>>>
45581>>>>>>>        // Btypkin.Branch_Code
45581>>>>>>>
45581>>>>>>>        // Btypkin.Year_Year
45581>>>>>>>
45581>>>>>>>        // Btypkin.Btypkin_Code
45581>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Code     To "‰à› ¡æª ‰å¤ž©žª"
45582>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Code     To "‰å¤ž©ž"
45583>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Code     To DD_AUTOFIND    DD_REQUIRED
45584>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Code     To (sl031(Self))
45585>>>>>>>        Set Key_Field_State        Field Btypkin.Btypkin_Code     To TRUE
45586>>>>>>>
45586>>>>>>>        // Btypkin.Btypkin_Rec0
45586>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Rec0     To DD_AUTOFIND    DD_NOPUT       DD_REQUIRED
45587>>>>>>>        Set Key_Field_State        Field Btypkin.Btypkin_Rec0     To TRUE
45588>>>>>>>
45588>>>>>>>        // Btypkin.Year_Rec0
45588>>>>>>>
45588>>>>>>>        // Btypkin.Btypkin_Descr
45588>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Descr    To "œ¨ š¨˜­ã ‰å¤ž©žª"
45589>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Descr    To "œ¨ š¨˜­ã"
45590>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Descr    To (sl031(Self))
45591>>>>>>>
45591>>>>>>>        // Btypkin.Gtypkin_Code
45591>>>>>>>        Set Field_Label_Long       Field Btypkin.Gtypkin_Code     To "‰å¤ž©ž ‚Š"
45592>>>>>>>        Set Field_Label_Short      Field Btypkin.Gtypkin_Code     To "‰å¤ž©ž ‚Š"
45593>>>>>>>        //Set Field_Prompt_Object    Field Btypkin.Gtypkin_Code     To (SL055(Self))
45593>>>>>>>
45593>>>>>>>        // Btypkin.Ctypkin_Code
45593>>>>>>>        Set Field_Label_Long       Field Btypkin.Ctypkin_Code     To "‰å¤ž©ž œ¢˜«é¤"
45594>>>>>>>        Set Field_Label_Short      Field Btypkin.Ctypkin_Code     To "‰å¤ž©ž œ¢˜«é¤"
45595>>>>>>>
45595>>>>>>>        // Btypkin.Vtypkin_Code
45595>>>>>>>        Set Field_Label_Long       Field Btypkin.Vtypkin_Code     To "‰å¤ž©ž ¨¦£žŸœ¬«é¤"
45596>>>>>>>        Set Field_Label_Short      Field Btypkin.Vtypkin_Code     To "‰å¤ž©ž ¨¦£žŸœ¬«é¤"
45597>>>>>>>
45597>>>>>>>        // Btypkin.Gtypkin_Rec0
45597>>>>>>>        Set Field_Options          Field Btypkin.Gtypkin_Rec0     To DD_DISPLAYONLY
45598>>>>>>>
45598>>>>>>>        // Btypkin.Ctypkin_Rec0
45598>>>>>>>        Set Field_Options          Field Btypkin.Ctypkin_Rec0     To DD_DISPLAYONLY
45599>>>>>>>
45599>>>>>>>        // Btypkin.Vtypkin_Rec0
45599>>>>>>>        Set Field_Options          Field Btypkin.Vtypkin_Rec0     To DD_DISPLAYONLY
45600>>>>>>>
45600>>>>>>>        // Btypkin.Btypkin_Anti1
45600>>>>>>>        Set Field_Class_Name       Field Btypkin.Btypkin_Anti1    To "dbComboForm_EZ"
45601>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Anti1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª ˜§¦ ˜¨®œå¦:"
45602>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Anti1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª"
45603>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti1    To (Bfile_VT(Self))
45604>>>>>>>
45604>>>>>>>        // Btypkin.Gplan_Code_Apo1
45604>>>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Apo1  To "€§¦ ‰à› ¡æ ‚Š"
45605>>>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Apo1  To "€§¦ ‰à› ¡æ ‚Š"
45606>>>>>>>
45606>>>>>>>        // Btypkin.Gplan_Code_Eos1
45606>>>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Eos1  To "„àª ‰à› ¡æ ‚Š"
45607>>>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Eos1  To "„àª ‰à› ¡æ ‚Š"
45608>>>>>>>
45608>>>>>>>        // Btypkin.Btypkin_Anti2
45608>>>>>>>        Set Field_Class_Name       Field Btypkin.Btypkin_Anti2    To "dbComboForm_EZ"
45609>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Anti2    To "˜¨˜¢ã§«žª ˜§¦ ˜¨®œå¦:"
45610>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Anti2    To "˜¨˜¢ã§«žª"
45611>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti2    To (Bfile_VT(Self))
45612>>>>>>>
45612>>>>>>>        // Btypkin.Gplan_Code_Apo2
45612>>>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Apo2  To "€§¦ ‰à› ¡æ ‚Š"
45613>>>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Apo2  To "€§¦ ‰à› ¡æ ‚Š"
45614>>>>>>>
45614>>>>>>>        // Btypkin.Gplan_Code_Eos2
45614>>>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Eos2  To "„àª ‰à› ¡æ ‚Š"
45615>>>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Eos2  To "„àª ‰à› ¡æ ‚Š"
45616>>>>>>>
45616>>>>>>>        // Btypkin.Bflagkin_Num
45616>>>>>>>        Set Field_Label_Long       Field Btypkin.Bflagkin_Num     To "¢ãŸ¦ª Flags"
45617>>>>>>>        Set Field_Label_Short      Field Btypkin.Bflagkin_Num     To "¢ãŸ¦ª Flags"
45618>>>>>>>        Set Field_Options          Field Btypkin.Bflagkin_Num     To DD_DISPLAYONLY
45619>>>>>>>
45619>>>>>>>        // Btypkin.Bkinkat_Num
45619>>>>>>>        Set Field_Label_Long       Field Btypkin.Bkinkat_Num      To "¢ãŸ¦ª ‰˜«žš¦¨ é¤ €¥ é¤"
45620>>>>>>>        Set Field_Label_Short      Field Btypkin.Bkinkat_Num      To "¢ãŸ¦ª ‰˜«.€¥ é¤"
45621>>>>>>>        Set Field_Options          Field Btypkin.Bkinkat_Num      To DD_DISPLAYONLY
45622>>>>>>>
45622>>>>>>>        // Btypkin.Btypkin_Anti_Xp
45622>>>>>>>        Set Field_Class_Name       Field Btypkin.Btypkin_Anti_Xp  To "dbComboForm_EZ"
45623>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Anti_Xp  To "Ž ©¬¤˜¢¢˜©æ£œ¤¦ª:"
45624>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Anti_Xp  To "• ‘¬¤˜¢¢˜©¦£â¤¦¬"
45625>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti_Xp  To (Btypkin_Btypkin_Anti_Xp_VT(Self))
45626>>>>>>>
45626>>>>>>>        // Btypkin.Btypkin_Printer
45626>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Printer  To "ƒ œçŸ¬¤©ž „¡«¬§à«ã"
45627>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Printer  To "„¡«¬§à«ãª"
45628>>>>>>>
45628>>>>>>>        // Btypkin.Btypkin_Pdescr
45628>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Pdescr   To "’å«¢¦ª „¡«ç§à©žª"
45629>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Pdescr   To "’å«¢¦ª „¡«ç§à©žª"
45630>>>>>>>
45630>>>>>>>        // Btypkin.Btypkin_Form
45630>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Form     To "”æ¨£˜ „¡«ç§à©žª"
45631>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Form     To "”æ¨£˜"
45632>>>>>>>
45632>>>>>>>        // Btypkin.Btypkin_L_No
45632>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_L_No     To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª"
45633>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_L_No     To "’œ¢.€¨."
45634>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_L_No     To DD_DISPLAYONLY
45635>>>>>>>
45635>>>>>>>        // Btypkin.Btypkin_L_Hmnia
45635>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_L_Hmnia  To "’œ¢œ¬«˜å˜ †£/¤å˜"
45636>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_L_Hmnia  To "’œ¢.†£/¤å˜"
45637>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_L_Hmnia  To DD_DISPLAYONLY
45638>>>>>>>
45638>>>>>>>        // Btypkin.Btypkin_Seira
45638>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Seira    To "‘œ ¨á"
45639>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Seira    To "‘œ ¨á"
45640>>>>>>>
45640>>>>>>>        // Btypkin.Btypkin_Abr
45640>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Abr      To "‘¬¤«¦£¦š¨˜­å˜"
45641>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Abr      To "‘¬¤«/­å˜"
45642>>>>>>>
45642>>>>>>>        // Btypkin.Btypkin_Flag01
45642>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag01   To DD_DISPLAYONLY
45643>>>>>>>
45643>>>>>>>        // Btypkin.Btypkin_Flag02
45643>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag02   To DD_DISPLAYONLY
45644>>>>>>>
45644>>>>>>>        // Btypkin.Btypkin_Flag03
45644>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag03   To DD_DISPLAYONLY
45645>>>>>>>
45645>>>>>>>        // Btypkin.Btypkin_Flag04
45645>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag04   To DD_DISPLAYONLY
45646>>>>>>>
45646>>>>>>>        // Btypkin.Btypkin_Flag05
45646>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag05   To DD_DISPLAYONLY
45647>>>>>>>
45647>>>>>>>        // Btypkin.Btypkin_Flag06
45647>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag06   To DD_DISPLAYONLY
45648>>>>>>>
45648>>>>>>>        // Btypkin.Btypkin_Flag07
45648>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag07   To DD_DISPLAYONLY
45649>>>>>>>
45649>>>>>>>        // Btypkin.Btypkin_Flag08
45649>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag08   To DD_DISPLAYONLY
45650>>>>>>>
45650>>>>>>>        // Btypkin.Btypkin_Flag09
45650>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag09   To DD_DISPLAYONLY
45651>>>>>>>
45651>>>>>>>        // Btypkin.Btypkin_Flag10
45651>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag10   To DD_DISPLAYONLY
45652>>>>>>>
45652>>>>>>>        // Btypkin.Btypkin_Flag11
45652>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag11   To DD_DISPLAYONLY
45653>>>>>>>
45653>>>>>>>        // Btypkin.Btypkin_Flag12
45653>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag12   To DD_DISPLAYONLY
45654>>>>>>>
45654>>>>>>>        // Btypkin.Btypkin_Flag13
45654>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag13   To DD_DISPLAYONLY
45655>>>>>>>
45655>>>>>>>        // Btypkin.Btypkin_Flag14
45655>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag14   To DD_DISPLAYONLY
45656>>>>>>>
45656>>>>>>>        // Btypkin.Btypkin_Flag15
45656>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag15   To DD_DISPLAYONLY
45657>>>>>>>
45657>>>>>>>        // Btypkin.Btypkin_Flag16
45657>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag16   To DD_DISPLAYONLY
45658>>>>>>>
45658>>>>>>>        // Btypkin.Btypkin_Flag17
45658>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag17   To DD_DISPLAYONLY
45659>>>>>>>
45659>>>>>>>        // Btypkin.Btypkin_Flag18
45659>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag18   To DD_DISPLAYONLY
45660>>>>>>>
45660>>>>>>>        // Btypkin.Btypkin_Flag19
45660>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag19   To DD_DISPLAYONLY
45661>>>>>>>
45661>>>>>>>        // Btypkin.Btypkin_Flag20
45661>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag20   To DD_DISPLAYONLY
45662>>>>>>>
45662>>>>>>>    End_Procedure    // Define_Fields
45663>>>>>>>
45663>>>>>>>
45663>>>>>>>
45663>>>>>>>    // Field_Defaults:
45663>>>>>>>    // This procedure is used to establish default field values.
45663>>>>>>>
45663>>>>>>>    Procedure Field_Defaults
45664>>>>>>>        Forward Send Field_Defaults
45666>>>>>>>        //DDB-Generated-Code-Location
45666>>>>>>>        //DDB-FieldDefaultStart
45666>>>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Anti1 To 0
45667>>>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Anti2 To 0
45668>>>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Anti_Xp To 1
45669>>>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Flag05 To 0
45670>>>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Sign To 1
45671>>>>>>>        //DDB-FieldDefaultEnd
45671>>>>>>>    End_Procedure    // Field_Defaults
45672>>>>>>>End_Class    // Btypkin_DataDictionary
45673>>>>>>>//DDB-Selection-pkg-Start
45673>>>>>>>
45673>>>>>>>Use SL031.SL         // SL031
INCLUDING FILE: SL031.SL
45673>>>>>>>>>//AB/ Project SL031:BTYPKIN
45673>>>>>>>>>//AB/     Object prj is a Lookup_Project
45673>>>>>>>>>//AB/         Set ProjectName to "SL031:BTYPKIN"
45673>>>>>>>>>//AB/         Set ProjectFileName to "SL031.SL"
45673>>>>>>>>>
45673>>>>>>>>>// Project Object Structure
45673>>>>>>>>>//   SL031 is a dbModalPanelSub
45673>>>>>>>>>//     Btypkin_DD is a DataDictionary
45673>>>>>>>>>//     oSelList is a dbListSub
45673>>>>>>>>>//     oOK_bn is a ButtonSub
45673>>>>>>>>>//     oCancel_bn is a ButtonSub
45673>>>>>>>>>//     oSearch_bn is a ButtonSub
45673>>>>>>>>>
45673>>>>>>>>>// Register all objects
45673>>>>>>>>>Register_Object Btypkin_DD
45673>>>>>>>>>Register_Object oCancel_bn
45673>>>>>>>>>Register_Object oOK_bn
45673>>>>>>>>>Register_Object oSearch_bn
45673>>>>>>>>>Register_Object oSelList
45673>>>>>>>>>Register_Object SL031
45673>>>>>>>>>
45673>>>>>>>>>
45673>>>>>>>>>    //AB-IgnoreStart
45673>>>>>>>>>
45673>>>>>>>>>    Use DFAllEnt.pkg
45673>>>>>>>>>    Use dbList.Sub
45673>>>>>>>>>    Use Button.Sub
45673>>>>>>>>>
45673>>>>>>>>>
45673>>>>>>>>>    Use BTYPKIN.DD
45673>>>>>>>>>    
45673>>>>>>>>>    //AB-IgnoreEnd
45673>>>>>>>>>
45673>>>>>>>>>    CD_Popup_Object SL031 is a dbModalPanelSub
45692>>>>>>>>>        set label to "‰ ¤ã©œ ª  €¥ ¦š¨á­à¤" 
45693>>>>>>>>>        Set Size to 213 506
45694>>>>>>>>>        Set Location to 4 5
45695>>>>>>>>>        Set Exit_Application_Local_State to FALSE
45696>>>>>>>>>        Set Modal_State to FALSE
45697>>>>>>>>>
45697>>>>>>>>>        //AB-DDOStart
45697>>>>>>>>>
45697>>>>>>>>>        Object Btypkin_DD is a Btypkin_DataDictionary
45699>>>>>>>>>        End_Object    // Btypkin_DD
45700>>>>>>>>>
45700>>>>>>>>>        Set Main_DD to (Btypkin_DD(self))
45701>>>>>>>>>        Set Server to (Btypkin_DD(self))
45702>>>>>>>>>
45702>>>>>>>>>        //AB-DDOEnd
45702>>>>>>>>>
45702>>>>>>>>>        Object oSelList is a dbListSub
45704>>>>>>>>>            Set Main_File to Btypkin.File_Number
45705>>>>>>>>>            Set Size to 173 491
45706>>>>>>>>>            Set Location to 3 6
45707>>>>>>>>>
45707>>>>>>>>>            Begin_Row
45710>>>>>>>>>                Entry_Item Btypkin.Btypkin_code
45711>>>>>>>>>                Entry_Item Btypkin.Btypkin_descr
45712>>>>>>>>>                Entry_Item Btypkin.Gtypkin_code
45713>>>>>>>>>                Entry_Item Btypkin.Ctypkin_code
45714>>>>>>>>>                Entry_Item Btypkin.Vtypkin_code
45715>>>>>>>>>                Entry_Item Btypkin.Btypkin_anti_xp
45716>>>>>>>>>            End_Row
45721>>>>>>>>>
45721>>>>>>>>>            Set Form_Width    item 0 to 39
45722>>>>>>>>>            set header_label  item 0 to "‰å¤ž©ž" 
45723>>>>>>>>>            
45723>>>>>>>>>            Set Form_Width    item 1 to 186
45724>>>>>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
45725>>>>>>>>>            
45725>>>>>>>>>            Set Form_Width    item 2 to 57
45726>>>>>>>>>            set header_label  item 2 to "‰å¤ž©ž ‚Š" 
45727>>>>>>>>>            
45727>>>>>>>>>            Set Form_Width    item 3 to 69
45728>>>>>>>>>            set header_label  item 3 to "‰ ¤ã©œ ª œ¢˜«é¤        " 
45729>>>>>>>>>            
45729>>>>>>>>>            Set Form_Width    item 4 to 59
45730>>>>>>>>>            set header_label  item 4 to "‰å¤ž©ž ¨¦£." 
45731>>>>>>>>>            
45731>>>>>>>>>            Set Form_Width    item 5 to 71
45732>>>>>>>>>            set header_label  item 5 to "• ‘¬¤˜¢¢˜©¦£." 
45733>>>>>>>>>            
45733>>>>>>>>>        End_Object    // oSelList
45734>>>>>>>>>
45734>>>>>>>>>        Object oOK_bn is a ButtonSub
45736>>>>>>>>>            set label to "&„§ ¢¦šã" 
45737>>>>>>>>>            Set Location to 177 337
45738>>>>>>>>>
45738>>>>>>>>>            //AB-StoreStart
45738>>>>>>>>>            Procedure OnClick
45740>>>>>>>>>                Send OK To oSelList
45741>>>>>>>>>            End_Procedure
45742>>>>>>>>>            //AB-StoreEnd
45742>>>>>>>>>
45742>>>>>>>>>        End_Object    // oOK_bn
45743>>>>>>>>>
45743>>>>>>>>>        Object oCancel_bn is a ButtonSub
45745>>>>>>>>>            set label to "&€¡ç¨à©ž" 
45746>>>>>>>>>            Set Location to 177 393
45747>>>>>>>>>
45747>>>>>>>>>            //AB-StoreStart
45747>>>>>>>>>            Procedure OnClick
45749>>>>>>>>>                Send Cancel To oSelList
45750>>>>>>>>>            End_Procedure
45751>>>>>>>>>            //AB-StoreEnd
45751>>>>>>>>>
45751>>>>>>>>>        End_Object    // oCancel_bn
45752>>>>>>>>>
45752>>>>>>>>>        Object oSearch_bn is a ButtonSub
45754>>>>>>>>>            set label to "€&¤˜ã«ž©ž" 
45755>>>>>>>>>            Set Location to 177 447
45756>>>>>>>>>
45756>>>>>>>>>            //AB-StoreStart
45756>>>>>>>>>            Procedure OnClick
45758>>>>>>>>>                Send Search To oSelList
45759>>>>>>>>>            End_Procedure
45760>>>>>>>>>            //AB-StoreEnd
45760>>>>>>>>>
45760>>>>>>>>>        End_Object    // oSearch_bn
45761>>>>>>>>>
45761>>>>>>>>>
45761>>>>>>>>>        //AB-StoreStart
45761>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
45762>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
45763>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
45764>>>>>>>>>        
45764>>>>>>>>>        //AB-StoreEnd
45764>>>>>>>>>
45764>>>>>>>>>    CD_End_Object    // SL031
45766>>>>>>>>>>
45766>>>>>>>>>
45766>>>>>>>>>//AB/     End_Object    // prj
45766>>>>>>>Use sl007.SL         // sl007
45766>>>>>>>Use sl007r.SL        // sl007r
INCLUDING FILE: SL007R.SL
45766>>>>>>>>>//AB/ Project sl007r:Ctypkin lookup with RecR 1st Col
45766>>>>>>>>>//AB/     Object prj is a Lookup_Project
45766>>>>>>>>>//AB/         Set ProjectName to "sl007r:Ctypkin lookup with RecR 1st Col"
45766>>>>>>>>>//AB/         Set ProjectFileName to "sl007r.SL"
45766>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
45766>>>>>>>>>
45766>>>>>>>>>// Project Object Structure
45766>>>>>>>>>//   sl007r is a dbModalPanelSub
45766>>>>>>>>>//     Ctypkin_DD is a DataDictionary
45766>>>>>>>>>//     oSelList is a dbListSub
45766>>>>>>>>>//     oOK_bn is a ButtonSub
45766>>>>>>>>>//     oCancel_bn is a ButtonSub
45766>>>>>>>>>//     oSearch_bn is a ButtonSub
45766>>>>>>>>>
45766>>>>>>>>>// Register all objects
45766>>>>>>>>>Register_Object Ctypkin_DD
45766>>>>>>>>>Register_Object oCancel_bn
45766>>>>>>>>>Register_Object oOK_bn
45766>>>>>>>>>Register_Object oSearch_bn
45766>>>>>>>>>Register_Object oSelList
45766>>>>>>>>>Register_Object sl007r
45766>>>>>>>>>
45766>>>>>>>>>
45766>>>>>>>>>    //AB-IgnoreStart
45766>>>>>>>>>
45766>>>>>>>>>    Use DFAllEnt.pkg
45766>>>>>>>>>    Use dbList.Sub
45766>>>>>>>>>    Use Button.Sub
45766>>>>>>>>>
45766>>>>>>>>>
45766>>>>>>>>>    Use CTYPKIN.DD
45766>>>>>>>>>    
45766>>>>>>>>>    //AB-IgnoreEnd
45766>>>>>>>>>
45766>>>>>>>>>    CD_Popup_Object sl007r is a dbModalPanelSub
45785>>>>>>>>>        Set Label to "Ctypkin"
45786>>>>>>>>>        Set Size to 148 480
45787>>>>>>>>>        Set Location to 12 16
45788>>>>>>>>>        Set Exit_Application_Local_State to FALSE
45789>>>>>>>>>        Set Modal_State to FALSE
45790>>>>>>>>>
45790>>>>>>>>>        //AB-DDOStart
45790>>>>>>>>>
45790>>>>>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
45792>>>>>>>>>        End_Object    // Ctypkin_DD
45793>>>>>>>>>
45793>>>>>>>>>        Set Main_DD to (Ctypkin_DD(self))
45794>>>>>>>>>        Set Server to (Ctypkin_DD(self))
45795>>>>>>>>>
45795>>>>>>>>>        //AB-DDOEnd
45795>>>>>>>>>
45795>>>>>>>>>        Object oSelList is a dbListSub
45797>>>>>>>>>            Set Main_File to Ctypkin.File_Number
45798>>>>>>>>>            Set Size to 105 465
45799>>>>>>>>>            Set Location to 6 6
45800>>>>>>>>>
45800>>>>>>>>>            Begin_Row
45803>>>>>>>>>                Entry_Item Ctypkin.Ctypkin_recr
45804>>>>>>>>>                Entry_Item Ctypkin.Ctypkin_code
45805>>>>>>>>>                Entry_Item Ctypkin.Ctypkin_descr
45806>>>>>>>>>                Entry_Item Ctypkin.Ctypkin_anti
45807>>>>>>>>>            End_Row
45812>>>>>>>>>
45812>>>>>>>>>            Set Form_Width    item 0 to 72
45813>>>>>>>>>            Set Header_Label  item 0 to "RecR"
45814>>>>>>>>>            
45814>>>>>>>>>            Set Form_Width    item 1 to 58
45815>>>>>>>>>            Set Header_Label  item 1 to "Ctypkin code"
45816>>>>>>>>>            
45816>>>>>>>>>            Set Form_Width    item 2 to 209
45817>>>>>>>>>            Set Header_Label  item 2 to "Ctypkin descr"
45818>>>>>>>>>            
45818>>>>>>>>>            Set Form_Width    item 3 to 120
45819>>>>>>>>>            Set Header_Label  item 3 to "Ctypkin anti"
45820>>>>>>>>>            
45820>>>>>>>>>
45820>>>>>>>>>            //AB-StoreStart
45820>>>>>>>>>            
45820>>>>>>>>>            Set Column_Option Item 0 to Noenter True
45821>>>>>>>>>            
45821>>>>>>>>>            //AB-StoreEnd
45821>>>>>>>>>
45821>>>>>>>>>        End_Object    // oSelList
45822>>>>>>>>>
45822>>>>>>>>>        Object oOK_bn is a ButtonSub
45824>>>>>>>>>            set label to "&„§ ¢¦šã" 
45825>>>>>>>>>            Set Location to 114 312
45826>>>>>>>>>
45826>>>>>>>>>            //AB-StoreStart
45826>>>>>>>>>            Procedure OnClick
45828>>>>>>>>>                Send OK To (oSelList(current_object))
45829>>>>>>>>>            End_Procedure
45830>>>>>>>>>            //AB-StoreEnd
45830>>>>>>>>>
45830>>>>>>>>>        End_Object    // oOK_bn
45831>>>>>>>>>
45831>>>>>>>>>        Object oCancel_bn is a ButtonSub
45833>>>>>>>>>            set label to "&€¡ç¨à©ž" 
45834>>>>>>>>>            Set Location to 114 367
45835>>>>>>>>>
45835>>>>>>>>>            //AB-StoreStart
45835>>>>>>>>>            Procedure OnClick
45837>>>>>>>>>                Send Cancel To (oSelList(current_object))
45838>>>>>>>>>            End_Procedure
45839>>>>>>>>>            //AB-StoreEnd
45839>>>>>>>>>
45839>>>>>>>>>        End_Object    // oCancel_bn
45840>>>>>>>>>
45840>>>>>>>>>        Object oSearch_bn is a ButtonSub
45842>>>>>>>>>            set label to "€&¤˜ã«ž©ž" 
45843>>>>>>>>>            Set Location to 114 422
45844>>>>>>>>>
45844>>>>>>>>>            //AB-StoreStart
45844>>>>>>>>>            Procedure OnClick
45846>>>>>>>>>                Send Search To (oSelList(current_object))
45847>>>>>>>>>            End_Procedure
45848>>>>>>>>>            //AB-StoreEnd
45848>>>>>>>>>
45848>>>>>>>>>        End_Object    // oSearch_bn
45849>>>>>>>>>
45849>>>>>>>>>
45849>>>>>>>>>        //AB-StoreStart
45849>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
45850>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
45851>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
45852>>>>>>>>>        //AB-StoreEnd
45852>>>>>>>>>
45852>>>>>>>>>    CD_End_Object    // sl007r
45854>>>>>>>>>>
45854>>>>>>>>>
45854>>>>>>>>>//AB/     End_Object    // prj
45854>>>>>>>
45854>>>>>>>//DDB-Selection-pkg-End
45854>>>>>>>//DDB-FileEnd
45854>>>>>    Use BAXIOKAT.DD
45854>>>>>    Use BARTICL.DD
INCLUDING FILE: BARTICL.DD
45854>>>>>>>//DDB-FileStart
45854>>>>>>>//DDB-HeaderStart
45854>>>>>>>
45854>>>>>>>// File Name : BARTICL.DD
45854>>>>>>>// Class Name: Barticl_DataDictionary
45854>>>>>>>// Revision  : 70
45854>>>>>>>// Version   : 2
45854>>>>>>>
45854>>>>>>>Use  Windows           // Basic Definitions
45854>>>>>>>Use  DataDict          // DataDictionary Class Definition
45854>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
45854>>>>>>>
45854>>>>>>>Open Barticl
45856>>>>>>>Open Bmove
INCLUDING FILE: BMOVE.FD
45858>>>>>>>Open Bsum
INCLUDING FILE: BSUM.FD
45860>>>>>>>Open Btypkin
45862>>>>>>>Open Sysrecb
45864>>>>>>>Open Cn
45866>>>>>>>
45866>>>>>>>//DDB-HeaderEnd
45866>>>>>>>//DDB-ValidationStart
45866>>>>>>>
45866>>>>>>>Register_Object Barticl_Barticl_M_Code_VT
45866>>>>>>>
45866>>>>>>>Object Barticl_Barticl_M_Code_VT  is a CodeValidationTable
45868>>>>>>>    Set Type_Value        To "MODULE"
45869>>>>>>>    Set Allow_Blank_State To TRUE
45870>>>>>>>    //DDB-ValidationCustomStart
45870>>>>>>>    //DDB-ValidationCustomEnd
45870>>>>>>>End_Object   // Barticl_Barticl_M_Code_VT
45871>>>>>>>//DDB-ValidationEnd
45871>>>>>>>//DDB-SelectionStart
45871>>>>>>>//DDB/ ExternalSelectionList Barticl  Barticl.SL
45871>>>>>>>//DDB/ ExternalSelectionList sl041  sl041.SL
45871>>>>>>>Register_Object Barticl
45871>>>>>>>Register_Object sl041
45871>>>>>>>//DDB-SelectionEnd
45871>>>>>>>
45871>>>>>>>//jsjsjs 24/01/2001 Open Gplan    //™¨å©¡œ  gplan_rec0 ©«ž¤ update, externalyy updated, lock on save
45871>>>>>>>//Open Customer //™¨å©¡œ  gplan_rec0 ©«ž¤ update, externalyy updated, lock on save
45871>>>>>>>//Open Vendor   //™¨å©¡œ  gplan_rec0 ©«ž¤ update, externalyy updated, lock on save
45871>>>>>>>
45871>>>>>>>
45871>>>>>>>//jsjsjs 24/01/2001 Use SL056.SL //¢å©«˜ gplan
45871>>>>>>>//e SL102.SL //¢å©«˜ customer
45871>>>>>>>//e SL???.SL //¢å©«˜ vendor
45871>>>>>>>
45871>>>>>>>//Use i:\homewin.dev\easyware.vis\gl\appsrc\doGlMntn.Bp //œ¤ž£â¨à©ž šœ¤ ¡ãª ¢¦š ©« ¡ãª
45871>>>>>>>//jsjsjs 24/01/2001 Use                                       doGlMntn.Bp //œ¤ž£â¨à©ž šœ¤ ¡ãª ¢¦š ©« ¡ãª
45871>>>>>>>//Use                                doCUMntn.Bp //œ¤ž£â¨à©ž §œ¢˜«é¤
45871>>>>>>>//Use                                doVEMntn.Bp //œ¤ž£â¨à©ž §¨¦£žŸœ¬«é¤
45871>>>>>>>
45871>>>>>>>
45871>>>>>>>Class Barticl_DataDictionary  is a DataDictionary_Sec
45872>>>>>>>
45872>>>>>>>    Procedure Shmera integer iField  Date dDate
45873>>>>>>>        Local Integer Changed
45874>>>>>>>        Get Field_Changed_State iField to Changed
45875>>>>>>>        If (Changed=0 AND dDate =0) Begin
45877>>>>>>>            SysDate4 dDate
45878>>>>>>>            Set Field_Default_Value iField to dDate
45879>>>>>>>        End
45879>>>>>>>>
45879>>>>>>>    End_Procedure   // Shmera
45880>>>>>>>
45880>>>>>>>
45880>>>>>>>    // Save_Main_File:
45880>>>>>>>
45880>>>>>>>    Procedure Save_Main_File
45881>>>>>>>        If (Barticl.Cn_Code<>'') Begin
45883>>>>>>>            Clear Cn
45884>>>>>>>            Move Barticl.Cn_Code to Cn.Cn_Code
45885>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
45886>>>>>>>>
45886>>>>>>>            Move Cn.Cn_Sls_ID     to Barticl.Sls_ID
45887>>>>>>>            Move Cn.Cn_Presp_ID   to Barticl.Presp_ID
45888>>>>>>>            Move Cn.CN_Cnt_ID     to Barticl.Cnt_ID
45889>>>>>>>        End
45889>>>>>>>>
45889>>>>>>>        Forward Send Save_Main_File
45891>>>>>>>    End_Procedure   // Save_Main_File
45892>>>>>>>
45892>>>>>>>
45892>>>>>>>//        Function SetEpon1Or2 Integer aiPedio1OrPedio2 String asCode Returns String
45892>>>>>>>//            String lsEponymia lsApoCode lsEosCode
45892>>>>>>>//            Integer liBtypkin_Anti
45892>>>>>>>//        //                 Btypkin_Anti1 ? 2  "-1" "?™? ?˜???ÿ"
45892>>>>>>>//        //                                     "0" "Data Entry"
45892>>>>>>>//        //                                     "1" "?????ÿ??? ? ??"
45892>>>>>>>//        //                                     "2" "??ê?? ?"
45892>>>>>>>//        //                                     "3" "????????? ?"
45892>>>>>>>//        //                                     "5" "? ????êê???????"
45892>>>>>>>//        //                                     "6" "??ê.????êš???"
45892>>>>>>>//            If (aiPedio1OrPedio2 = 1) Begin
45892>>>>>>>//                Move Btypkin.Btypkin_Anti1   to liBtypkin_Anti
45892>>>>>>>//                Move Btypkin.Gplan_Code_Apo1 to lsApoCode
45892>>>>>>>//                Move Btypkin.Gplan_Code_Eos1 to lsEosCode
45892>>>>>>>//            End
45892>>>>>>>//            Else Begin
45892>>>>>>>//                If (aiPedio1OrPedio2 = 2) Begin
45892>>>>>>>//                    Move Btypkin.Btypkin_Anti2 to liBtypkin_Anti
45892>>>>>>>//                    Move Btypkin.Gplan_Code_Apo2 to lsApoCode
45892>>>>>>>//                    Move Btypkin.Gplan_Code_Eos2 to lsEosCode
45892>>>>>>>//                End
45892>>>>>>>//            End
45892>>>>>>>
45892>>>>>>>//            Case Begin
45892>>>>>>>//                Case (liBtypkin_Anti = -1) // ??? ?˜???
45892>>>>>>>//                    Case Break
45892>>>>>>>//                Case (liBtypkin_Anti =  0) // Data Entry
45892>>>>>>>//                    Case Break
45892>>>>>>>//                Case (liBtypkin_Anti = 1)  // ???ÿ?š ???ÿ??ÿ?š
45892>>>>>>>//                // jsjsjs 24/01/2001
45892>>>>>>>//        //                Clear Gplan
45892>>>>>>>//        //                Move gs_Selected_Company_Code to Gplan.Company_Code
45892>>>>>>>//        //                Move gs_Selected_Branch_Code  to Gplan.Branch_Code
45892>>>>>>>//        //                Move gi_Selected_Year         to Gplan.Year_Year
45892>>>>>>>//        //                Move asCode                   to Gplan.Gplan_Code
45892>>>>>>>//        //                Find eq Gplan by Index.1 //Gplan:Index.1:Company_Code-Branch_Code-Year_Year-Gplan_Code
45892>>>>>>>//        //                [Found] Begin
45892>>>>>>>//        //                    If ((asCode >= lsApoCode) and (asCode <= lsEosCode) and (Gplan.Gplan_Yn_Last = 1)) ;
45892>>>>>>>//        //                        Move  Gplan.Gplan_Descr1 to lsEponymia
45892>>>>>>>//        //                End
45892>>>>>>>//                // jsjsjs 24/01/2001
45892>>>>>>>//                    Case Break
45892>>>>>>>//                Case ((liBtypkin_Anti = 2) Or (liBtypkin_Anti = 3)) // ????œ? ??ê?? ?/????????? ?
45892>>>>>>>//                    Clear Clients
45892>>>>>>>////                    Move SysCurXr.Company_Code  to Clients.Company_Code
45892>>>>>>>////                    Move SysCurXr.Branch_Code   to Clients.Branch_Code
45892>>>>>>>////                    Move SysCurXr.Year_Year     to Clients.Year_Year
45892>>>>>>>//                    Move asCode                 to Clients.Client_ID
45892>>>>>>>////                    Find Eq Clients by Index.5 //company_code+branch_code+year_year+Client_ID
45892>>>>>>>//                    Find Eq Clients by Index.6 //Client_ID
45892>>>>>>>//                    Move Clients.Client_Name    to lsEponymia
45892>>>>>>>//                  Case Break
45892>>>>>>>//                Case (liBtypkin_Anti = 4) // ???????????
45892>>>>>>>//                    Case Break
45892>>>>>>>//                Case (liBtypkin_Anti = 5) // ? ????êê???????
45892>>>>>>>//                    Case Break
45892>>>>>>>
45892>>>>>>>//                Case (liBtypkin_Anti = 6) // ??ê. ????êš???
45892>>>>>>>//                    Case Break
45892>>>>>>>//            Case End
45892>>>>>>>//            Function_Return (Trim(lsEponymia))
45892>>>>>>>//        End_Function // SetEponymia
45892>>>>>>>
45892>>>>>>>      //private
45892>>>>>>>      //¡˜¢œå«˜  ˜§¦ «åª request save & delete ¡˜  £ž›œ¤åœ  æ¢˜ «˜ properties
45892>>>>>>>      Procedure private.Initialize_Properties
45893>>>>>>>                 //£ž›œ¤ ©£æª §˜¢˜ é¤
45893>>>>>>>                 Set psB_Btypkin_Recr    to ''
45894>>>>>>>                 Set pdB_Barticl_Hmnia   to 0
45895>>>>>>>                 Set piB_Barticl_No      to 0
45896>>>>>>>                 Set psB_Barticl_Code1   to ""
45897>>>>>>>
45897>>>>>>>                 Set pdB_Garticl_Hmnia   to 0  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
45898>>>>>>>                 Set piB_Garticl_No      to 0
45899>>>>>>>                 Set psB_Garticl_Aitiol  to ""
45900>>>>>>>
45900>>>>>>>                 //£ž›œ¤ ©£æª ¤âà¤
45900>>>>>>>                 Set psA_Btypkin_Recr    to ''
45901>>>>>>>                 Set pdA_Barticl_Hmnia   to 0
45902>>>>>>>                 Set piA_Barticl_No      to 0
45903>>>>>>>                 Set psA_Barticl_Code1   to ""
45904>>>>>>>
45904>>>>>>>                 Set pdA_Garticl_Hmnia   to 0  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
45905>>>>>>>                 Set piA_Garticl_No      to 0
45906>>>>>>>                 Set psA_Garticl_Aitiol  to ""
45907>>>>>>>
45907>>>>>>>                 Set psB_Gplan_Code to ""
45908>>>>>>>                 Set psA_Gplan_Code to ""
45909>>>>>>>
45909>>>>>>>      End_Procedure //private.Initialize_Properties
45910>>>>>>>
45910>>>>>>>
45910>>>>>>>      Procedure Construct_Object
45911>>>>>>>                Forward Send Construct_Object
45913>>>>>>>
45913>>>>>>>                Property String  psA_Btypkin_Recr     ''
45914>>>>>>>                Property Date    pdA_Barticl_Hmnia    0
45915>>>>>>>                Property Integer piA_Barticl_No       0
45916>>>>>>>                Property String  psB_Barticl_Code1    ""
45917>>>>>>>
45917>>>>>>>                Property String  psB_Btypkin_Recr     ''
45918>>>>>>>                Property Date    pdB_Barticl_Hmnia    0
45919>>>>>>>                Property Integer piB_Barticl_No       0
45920>>>>>>>                Property String  psA_Barticl_Code1    ""
45921>>>>>>>
45921>>>>>>>                Property Date    pdA_Garticl_Hmnia    0 //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
45922>>>>>>>                Property Integer piA_Garticl_No       0
45923>>>>>>>                Property String  psA_Garticl_Aitiol   ''
45924>>>>>>>
45924>>>>>>>                Property Date    pdB_Garticl_Hmnia    0 //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
45925>>>>>>>                Property Integer piB_Garticl_No       0
45926>>>>>>>                Property String  psB_Garticl_Aitiol   ''
45927>>>>>>>
45927>>>>>>>
45927>>>>>>>                Property Integer piBaxio_dd           0 //object id «¦¬ ddo server š ˜ «¦ baxio
45928>>>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
45928>>>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ ???
45928>>>>>>>                Property Integer piBaxiokat_dd        0 //object id «¦¬ ddo server š ˜ «¦ baxio
45929>>>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
45929>>>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ ???
45929>>>>>>>                Property Integer piBmove_dd           0 //object id «¦¬ ddo server š ˜ «¦ bmove
45930>>>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
45930>>>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ cascade update
45930>>>>>>>                Property Integer piBtypkin_dd         0 //object id «¦¬ ddo server š ˜ «¦ btypkin
45931>>>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
45931>>>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ cascade update
45931>>>>>>>
45931>>>>>>>                Property String  psB_Gplan_Code
45932>>>>>>>                Property String  psA_Gplan_Code
45933>>>>>>>
45933>>>>>>>
45933>>>>>>>                Property Integer piCreated_Barticl 0 //©œ«á¨œ«˜  ©«ž¤ creating,
45934>>>>>>>                                                     //®¨ž© £¦§¦ œå«˜  ©«ž¤ update+validate_save ¡˜ 
45934>>>>>>>                                                     //£ž›œ¤åœ«˜  ©«ž¤ request_save «¦¬ bmove
45934>>>>>>>
45934>>>>>>>                Property  Integer piDo_GL_Maintainance       0 //object id «žª business process
45935>>>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «ã¤ šœ¤ ¡ã ¢¦š ©« ¡ã
45935>>>>>>>                Property  Integer piDo_CUSTOMER_Maintainance 0 //object id «žª business process
45936>>>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §œ¢á«œª
45936>>>>>>>                Property  Integer piDo_VENDOR_Maintainance   0 //object id «žª business process
45937>>>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §¨¦£žŸœ¬«âª
45937>>>>>>>      End_Procedure   //construct_object
45938>>>>>>>
45938>>>>>>>
45938>>>>>>>      Procedure End_Construct_Object
45939>>>>>>>                Forward Send End_Construct_Object
45941>>>>>>>
45941>>>>>>>//jsjsjs 24/01/2001
45941>>>>>>>//                //object id «žª business process §¦¬ œ¤ž£œ¨é¤œ  «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã
45941>>>>>>>//                Set piDo_GL_Maintainance       to (oDo_GL_Maintainance      (Self))
45941>>>>>>>//jsjsjs 24/01/2001
45941>>>>>>>
45941>>>>>>>                //object id «žª business process §¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §œ¢á«œª
45941>>>>>>>//--------------Set piDo_CUSTOMER_Maintainance to (oDo_CUSTOMER_Maintainance(Self))
45941>>>>>>>
45941>>>>>>>                //object id «žª business process §¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §¨¦£žŸœ¬«âª
45941>>>>>>>//------------->Set piDo_VENDOR_Maintainance   to (oDo_VENDOR_Maintainance  (Self))
45941>>>>>>>      End_Procedure   //end_construct_object
45942>>>>>>>
45942>>>>>>>
45942>>>>>>>//jsjsjs 24/01/2001 georg 14/01/03 giati oxi constrain?
45942>>>>>>>//      Procedure Constrain
45942>>>>>>>//                Forward Send Constrain
45942>>>>>>>//                Constrain Barticl.Company_Code Eq gs_Selected_Company_Code
45942>>>>>>>//                Constrain Barticl.Branch_Code  Eq gs_Selected_Branch_Code
45942>>>>>>>//                Constrain Barticl.Year_Year    Eq gi_Selected_Year
45942>>>>>>>//      End_Procedure   //constrain
45942>>>>>>>//jsjsjs 24/01/2001
45942>>>>>>>
45942>>>>>>>
45942>>>>>>>
45942>>>>>>>      //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
45942>>>>>>>      //™) ˜¤áš¤à©ž properties
45942>>>>>>>      //š) › ˜®œå¨ ©ž calculated §œ›åà¤
45942>>>>>>>      //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
45942>>>>>>>      //œ) œ¤ž£â¨à©ž properties after
45942>>>>>>>      Procedure Update
45943>>>>>>>                Integer liBAxio_dd liBaxiokat_dd
45944>>>>>>>                Forward Send Update
45946>>>>>>>
45946>>>>>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
45946>>>>>>>                Move Syscurxr.Company_Code  to Barticl.Company_Code
45947>>>>>>>                Move Syscurxr.Branch_Code   to Barticl.Branch_Code
45948>>>>>>>                Move Syscurxr.Year_Year     to Barticl.Year_Year
45949>>>>>>>                Move Btypkin.Btypkin_Code   to Barticl.Btypkin_Code
45950>>>>>>>
45950>>>>>>>
45950>>>>>>>                //™) ˜¤áš¤à©ž properties
45950>>>>>>>                Get piBaxio_dd    to liBaxio_dd    //«¦ ddo §¦¬ "©œ¨™å¨œ " «¦ baxio
45951>>>>>>>                Get piBaxiokat_dd to liBaxiokat_dd //«¦ ddo §¦¬ "©œ¨™å¨œ " «¦ baxiokat
45952>>>>>>>
45952>>>>>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
45952>>>>>>>                //š.1:btypkin.btypkin_L_Hmnia //«œ¢œ¬«˜å˜ ž£œ¨¦£ž¤å˜
45952>>>>>>>                 Move (Barticl.Barticl_Hmnia Max Btypkin.Btypkin_L_Hmnia) to Btypkin.Btypkin_L_Hmnia
45953>>>>>>>
45953>>>>>>>
45953>>>>>>>                //š.0:btypkin.stat_from:¨¬Ÿ£åœ  œá¤ Ÿ˜ ¡á¤à œ ©˜šàšã ¤â¦¬ ˜¥ ¦š¨á­¦¬
45953>>>>>>>                //If (Btypkin.Baxio_Stat_From = 0);
45953>>>>>>>                //     Begin //œ ©˜šàšã ¤â¦¬ ˜¥ ¦š¨á­¦¬, á¨˜ œ§ «¨â§à «¦ create ©«¦ baxio
45953>>>>>>>                //      Set Allow_Foreign_New_Save_State of liBaxio_dd to True
45953>>>>>>>                //     End
45953>>>>>>>                //Else Begin //› ˜¡å¤ž©ž ¬§á¨®¦¤«¦ª ˜¥ ¦š¨á­¦¬, á¨˜ ›â¤ œ§ «¨â§à «¦ create ©«¦ baxio
45953>>>>>>>                //      Set Allow_Foreign_New_Save_State of liBaxio_dd to False
45953>>>>>>>                //     End
45953>>>>>>>
45953>>>>>>>                //š.3:btypkin.baxiokat_code:¨¬Ÿ£åœ  œá¤ œ§ «¨â§à › ˜¡å¤ž©ž §¦¢¢é¤ «ç§à¤ ˜¥ é¤
45953>>>>>>>                //                          £œ «¦ «¨â®à¤ á¨Ÿ¨¦
45953>>>>>>>                //If (Btypkin.Bkinkat_Num <> 0);
45953>>>>>>>                //     Begin //› ˜¡å¤ž©ž §¦¢¢é¤ «ç§à¤ ˜¥ ¦š¨á­à¤
45953>>>>>>>                //     End
45953>>>>>>>                //Else Begin //› ˜¡å¤ž©ž œ¤æª £æ¤¦¤ «ç§¦¬ ˜¥ ¦š¨á­à¤
45953>>>>>>>                //      //Set Field_Changed_Value of liBaxiokat_dd Field Baxiokat.Baxiokat_Code to Btypkin.Baxiokat_Code
45953>>>>>>>                //     End
45953>>>>>>>
45953>>>>>>>//-------------------------------------------------------------------------------------------
45953>>>>>>>//////jsjsjs out 28/01/2001
45953>>>>>>>//                //š.04:„§à¤¬£åœª ©¬¤˜¢¢˜©¦£â¤¦¬ §˜¨˜¢ã§«ž ©«¦ barticl
45953>>>>>>>//                Get SetEpon1Or2 Btypkin.Btypkin_Anti1 Barticl.Barticl_Code1 to Barticl.Barticl_Epon1
45953>>>>>>>//                Get SetEpon1Or2 Btypkin.Btypkin_Anti2 Barticl.Barticl_Code2 to Barticl.Barticl_Epon2
45953>>>>>>>//
45953>>>>>>>//-------------------------------------------------------------------------------------------
45953>>>>>>>
45953>>>>>>>                //š.02:©«¦ ®œå˜ §˜¨˜¢ã§«ž ©«¦ barticl
45953>>>>>>>                //    œå¤˜  «˜ §œ›å˜ barticl_code2 ¡˜  barticl_epon2,
45953>>>>>>>                //    ˜¤á¢¦š˜ £œ «¦ btypkin_anti2, ›ž¢˜›ã:
45953>>>>>>>                //    1.= 5 §˜¨˜¢ã§«žª œå¤˜  ¦ å› ¦ª ¦ ©¬¤˜¢¢˜©æ£œ¤¦ª
45953>>>>>>>                //    1.=-1 ›â¤ ¬§á¨®œ  §˜¨˜¢ã§«žª
45953>>>>>>>                //˜¬«¦ Ÿ˜ £§¦¨¦¬©œ ¤˜ §˜œ  ©«ž¤ update «¦¬ barticl
45953>>>>>>>                //æ¤«àª £œ«˜­â¨Ÿž¡œ ˜§¦ «¦ bmove!
45953>>>>>>>
45953>>>>>>>                Case Begin
45953>>>>>>>                    Case (Btypkin.Btypkin_Anti2 = 5) //§˜¨˜¢ã§«žª œå¤˜  ¦ å› ¦ª ¦ ©¬¤˜¢¢˜©æ£œ¤¦ª
45955>>>>>>>                        Move Barticl.Barticl_Code1 to Barticl.Barticl_Code2
45956>>>>>>>                        Move Barticl.Barticl_Epon1 to Barticl.Barticl_Epon2
45957>>>>>>>                      Case Break
45958>>>>>>>                    Case (Btypkin.Btypkin_Anti2 = (-1)) //›â¤ ¬§á¨®œ  §˜¨˜¢ã§«žª
45961>>>>>>>                        Move ""                    to Barticl.Barticl_Code2
45962>>>>>>>                        Move ""                    to Barticl.Barticl_Epon2
45963>>>>>>>                      Case Break
45964>>>>>>>                Case End
45964>>>>>>>
45964>>>>>>>
45964>>>>>>>                Case Begin
45964>>>>>>>                    Case ((Btypkin.Btypkin_Anti1=2) Or (Btypkin.Btypkin_Anti1=3))
45966>>>>>>>
45966>>>>>>>                        Clear Clients
45967>>>>>>>//                        Move Barticl.Company_Code  to Clients.Company_Code
45967>>>>>>>//                        Move Barticl.Branch_Code   to Clients.Branch_Code
45967>>>>>>>//                        Move Barticl.Year_Year     to Clients.Year_Year
45967>>>>>>>                        Move Barticl.Barticl_Code1 to Clients.Client_ID
45968>>>>>>>//                        Find Eq Clients by Index.5 //company_code+branch_code+year_year+Client_ID
45968>>>>>>>                        Find Eq Clients by Index.6 //Client_ID
45969>>>>>>>>
45969>>>>>>>                        If (Found = 1) Begin
45971>>>>>>>                            Move Clients.Client_Recr to Barticl.Client_Mrecr
45972>>>>>>>                        End
45972>>>>>>>>
45972>>>>>>>
45972>>>>>>>                        Else Begin
45973>>>>>>>                           Send Operation_Not_Allowed 3002 //›â¤ ™¨âŸž¡œ «¦ Master Customer_rec0, please reindex
45974>>>>>>>                        End
45974>>>>>>>>
45974>>>>>>>                      Case Break
45975>>>>>>>
45975>>>>>>>                Case End
45975>>>>>>>
45975>>>>>>>
45975>>>>>>>//-------------------------------------------------------------------------------------------
45975>>>>>>>
45975>>>>>>>                //š.03:master gplan_mrec0, £æ¤¦¤ œá¤ «¦ btypkin œ¤ž£œ¨é¤œ  «ž¤ š¢
45975>>>>>>>                If (Btypkin.Gtypkin_Code <> 0);                Begin //œá¤ ž ¡å¤ž©ž œ¤ž£œ¨é¤œ  «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã, ®¨œ á¦£˜  ¦§à›ã§¦«œ
45977>>>>>>>                      //master gplan rec0
45977>>>>>>>                      Case Begin
45977>>>>>>>                           Case (Btypkin.Btypkin_Anti1 = 1) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ š¢
45979>>>>>>>//jsjsjs 24/01/2001
45979>>>>>>>//                                Clear Gplan
45979>>>>>>>//                                Move Barticl.Company_Code  to Gplan.Company_Code
45979>>>>>>>//                                Move Barticl.Branch_Code   to Gplan.Branch_Code
45979>>>>>>>//                                Move Barticl.Year_Year     to Gplan.Year_Year
45979>>>>>>>//                                Move Barticl.Barticl_Code1 to Gplan.Gplan_Code
45979>>>>>>>//                                Find Eq Gplan by Index.1 //company_code+branch_code+year_year+Gplan_code
45979>>>>>>>//                                If (Found = 1) Move Gplan.Gplan_Rec0 to Barticl.Gplan_Mrec0
45979>>>>>>>//                                Else           Send Operation_Not_Allowed 3001 //›â¤ ™¨âŸž¡œ «¦ Master Gplan_rec0
45979>>>>>>>//jsjsjs 24/01/2001
45979>>>>>>>                           Case Break
45980>>>>>>>                           Case Else                        //=4 ¢¦ §¦å:©¬¤˜¢¢˜©æ£œ¤¦ª £œ user manual data entry
45980>>>>>>>                                Move 0 to Barticl.Gplan_Mrec0
45981>>>>>>>                      Case End
45981>>>>>>>                End   //please check the logic
45981>>>>>>>>
45981>>>>>>>
45981>>>>>>>
45981>>>>>>>                //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
45981>>>>>>>
45981>>>>>>>                //œ) œ¤ž£â¨à©ž properties after (˜§æ parent buffers!)
45981>>>>>>>                Set psA_Btypkin_Recr    to Btypkin.Btypkin_Recr
45982>>>>>>>                Set pdA_Barticl_Hmnia   to Barticl.Barticl_Hmnia
45983>>>>>>>                Set piA_Barticl_No      to Barticl.Barticl_No
45984>>>>>>>                Set psA_Barticl_Code1   to Barticl.Barticl_Code1
45985>>>>>>>
45985>>>>>>>                Set pdA_Garticl_Hmnia   to Barticl.Barticl_Hmnia  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
45986>>>>>>>                Set piA_Garticl_No      to Barticl.Barticl_No
45987>>>>>>>                Set psA_Garticl_Aitiol  to Barticl.Barticl_Aitiol
45988>>>>>>>
45988>>>>>>>      End_Procedure   //update
45989>>>>>>>
45989>>>>>>>
45989>>>>>>>      Procedure Backout
45990>>>>>>>                Forward Send Backout
45992>>>>>>>
45992>>>>>>>                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
45992>>>>>>>                Set psB_Btypkin_Recr    to Barticl.Btypkin_Recr
45993>>>>>>>                Set pdB_Barticl_Hmnia   to Barticl.Barticl_Hmnia
45994>>>>>>>                Set piB_Barticl_No      to Barticl.Barticl_No
45995>>>>>>>                Set psB_Barticl_Code1   to Barticl.Barticl_Code1
45996>>>>>>>
45996>>>>>>>                Set pdB_Garticl_Hmnia   to Barticl.Barticl_Hmnia  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
45997>>>>>>>                Set piB_Garticl_No      to Barticl.Barticl_No
45998>>>>>>>                Set psB_Garticl_Aitiol  to Barticl.Barticl_Aitiol
45999>>>>>>>      End_Procedure   // backout
46000>>>>>>>
46000>>>>>>>
46000>>>>>>>      Procedure Creating
46001>>>>>>>                Forward Send Creating
46003>>>>>>>
46003>>>>>>>                //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBarticl //˜¨ Ÿ£æª á¨Ÿ¨à¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
46003>>>>>>>
46003>>>>>>>            Move (Append('',((Trim(SysCurXR.Branch_Site))+;                            (Trim(String(Barticl.Barticl_Rec0)))))) to Barticl.Barticl_Recr
46004>>>>>>>
46004>>>>>>>                If (Barticl.Barticl_M_Code='') Move gs_Module_Code to Barticl.Barticl_M_Code
46007>>>>>>>
46007>>>>>>>                //************************************************************************
46007>>>>>>>                //flag 5:˜¬«æ£˜«ž ˜¨åŸ£ž©ž                                               *
46007>>>>>>>                //************************************************************************
46007>>>>>>>                If (Btypkin.Btypkin_Flag05 = TRUE);                     Begin //«¦ á¨Ÿ¨¦ â®œ  ˜¬«æ£˜«ž ˜¨åŸ£ž©ž
46009>>>>>>>                      Add 1 to Btypkin.Btypkin_L_No
46010>>>>>>>                      Move Btypkin.Btypkin_L_No  to Barticl.Barticl_No
46011>>>>>>>                     End
46011>>>>>>>>
46011>>>>>>>                Else Begin //«¦ á¨Ÿ¨¦ â®œ  ®œ ¨¦¡å¤ž«ž ˜¨åŸ£ž©ž
46012>>>>>>>                     End
46012>>>>>>>>
46012>>>>>>>
46012>>>>>>>                Set piCreated_Barticl to TRUE
46013>>>>>>>      End_Procedure //creating
46014>>>>>>>
46014>>>>>>>
46014>>>>>>>      Procedure Deleting
46015>>>>>>>                Forward Send Deleting
46017>>>>>>>
46017>>>>>>>                //jsjsjs 24/01/2001 Sub 1 from Year.Year_NumBarticl //˜¨ Ÿ£æª á¨Ÿ¨à¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
46017>>>>>>>                If (Btypkin.Btypkin_L_No = Barticl.Barticl_No);                Begin //œá¤ › ˜š¨á­à «¦¤ «œ¢œ¬«˜å¦ ˜¨ Ÿ£æª !!! sos pleas check the logic!
46019>>>>>>>                  Sub 1 from Btypkin.Btypkin_L_No
46020>>>>>>>                  // js 05/09/2002
46020>>>>>>>                  Saverecord Btypkin
46021>>>>>>>                End
46021>>>>>>>>
46021>>>>>>>      End_Procedure //deleting
46022>>>>>>>
46022>>>>>>>
46022>>>>>>>      Procedure Operation_Not_Allowed Integer iError_Num
46023>>>>>>>                String lsError_Message
46024>>>>>>>                Case Begin
46024>>>>>>>                     //˜§æ validate save
46024>>>>>>>                     Case (iError_Num = 1001)
46026>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž †£œ¨¦£ž¤å˜ !\n\n‹ ¡¨æ«œ¨ž «žª œ¤á¨¥œàª ®¨ã©œàª ("+;                          (String(SysCurXr.Year_XrhshFrom))+")") to lsError_Message
46027>>>>>>>                     Case Break
46028>>>>>>>                     Case (iError_Num = 1002)
46031>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž †£œ¨¦£ž¤å˜ !\n\n‹œš˜¢ç«œ¨ž «žª ¢ã¥œàª ®¨ã©œàª ("+;                          (String(SysCurXr.Year_XrhshTo))+")") to lsError_Message
46032>>>>>>>                     Case Break
46033>>>>>>>                     Case (iError_Num = 1003)
46036>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "ƒâ¤ œ§ «¨â§œ«˜  ˜¢˜šã «ç§¦¬ ¡å¤ž©žª!");                          to lsError_Message
46037>>>>>>>                     Case Break
46038>>>>>>>                     Case (iError_Num = 1004)
46041>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n† ž£œ¨¦£ž¤å˜ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ «¦ á¨Ÿ¨¦!");                          to lsError_Message
46042>>>>>>>                     Case Break
46043>>>>>>>                     Case (iError_Num = 1005)
46046>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\nŽ ˜¨ Ÿ£æª «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ «¦ á¨Ÿ¨¦!");                          to lsError_Message
46047>>>>>>>                     Case Break
46048>>>>>>>                     Case (iError_Num = 1006)
46051>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n† ˜ « ¦¢¦šå˜ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ «¦ á¨Ÿ¨¦!");                          to lsError_Message
46052>>>>>>>                     Case Break
46053>>>>>>>                     Case (iError_Num = 1007)
46056>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n‹ž›œ¤ ¡æª ˜¨ Ÿ£æª §˜¨˜©«˜« ¡¦ç !");                          to lsError_Message
46057>>>>>>>                     Case Break
46058>>>>>>>                     Case (iError_Num = 1008)
46061>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "ƒâ¤ œ§ «¨â§œ«˜  ˜¢˜šã ©¬¤˜¢¢˜©¦£â¤¦¬!");                          to lsError_Message
46062>>>>>>>                     Case Break
46063>>>>>>>                     Case (iError_Num = 1009)
46066>>>>>>>                          Clear Codemast
46067>>>>>>>                          Move "MODULE" to Codemast.Type
46068>>>>>>>                          Move Barticl.Barticl_M_Code to Codemast.Code
46069>>>>>>>                          Find Eq Codemast by Index.1 //type+code
46070>>>>>>>>
46070>>>>>>>                          Move ("DDC 036:€›ç¤˜«ž ž „šš¨˜­ã\n\n(’¦ á¨Ÿ¨¦ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§æ "+;                          (Trim(Codemast.Description))+" )") to lsError_Message
46071>>>>>>>                     Case Break
46072>>>>>>>                     Case (iError_Num = 1011)
46075>>>>>>>                          Move ("DDC 036:€›ç¤˜«ž ž „šš¨˜­ã\n\n(ƒœ¤ â®œ  ¦¨ ©Ÿœå «¦ ¡ç¡¢à£˜!)");                          to lsError_Message
46076>>>>>>>                     Case Break
46077>>>>>>>                     Case (iError_Num = 1100)
46080>>>>>>>                          Move "DDC 036:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
46081>>>>>>>                          Case Break
46082>>>>>>>
46082>>>>>>>                     Case (iError_Num = 2100)
46085>>>>>>>                          Move "DDC 036:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
46086>>>>>>>                          Case Break
46087>>>>>>>
46087>>>>>>>                   //˜§æ update
46087>>>>>>>                   Case (iError_Num = 3001)
46090>>>>>>>                        Move ("DDC 036:ƒâ¤ ™¨âŸž¡œ ¦ ¡à› ¡æª "+ (Trim(Barticl.Barticl_Code1)) + " ©«ã ‚œ¤ ¡ã Š¦š ©« ¡ã !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
46091>>>>>>>                   Case Break
46092>>>>>>>                   Case (iError_Num = 3002)
46095>>>>>>>                        Move ("DDC 036:ƒâ¤ ™¨âŸž¡œ ¦ ¡à› ¡æª "+ (Trim(Barticl.Barticl_Code1)) + " ©«ã ‚œ¤ ¡ã Š¦š ©« ¡ã š ˜ «¦¤ œ¢á«ž !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
46096>>>>>>>                   Case Break
46097>>>>>>>                   Case (iError_Num = 3003)
46100>>>>>>>                        Move ("DDC 036:ƒâ¤ ™¨âŸž¡œ ¦ ¡à› ¡æª "+ (Trim(Barticl.Barticl_Code1)) + " ©«ã ‚œ¤ ¡ã Š¦š ©« ¡ã š ˜ «¦¤ ¨¦£žŸœ¬«ã !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
46101>>>>>>>                   Case Break
46102>>>>>>>
46102>>>>>>>                     Case Else
46102>>>>>>>                          Forward Send Operation_Not_Allowed iError_Num
46104>>>>>>>                Case End
46104>>>>>>>
46104>>>>>>>                Error iError_Num lsError_Message
46105>>>>>>>>
46105>>>>>>>      End_Procedure // operation_not_allowed
46106>>>>>>>
46106>>>>>>>
46106>>>>>>>    //1001:bartcl_hmnia >= year_xrhsh From
46106>>>>>>>    //1002:bartcl_hmnia <= year_xrhsh To
46106>>>>>>>    //1003:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent btypkin record
46106>>>>>>>    //1004:«¨¦§¦§¦åž©ž (edit) barticl_hmnia  £æ¤¦¤ ˜§æ barticl_dd
46106>>>>>>>    //1005:«¨¦§¦§¦åž©ž (edit) barticl_no     £æ¤¦¤ ˜§æ barticl_dd
46106>>>>>>>    //1006:«¨¦§¦§¦åž©ž (edit) barticl_aitiol £æ¤¦¤ ˜§æ barticl_dd
46106>>>>>>>    //1007:barticl_no > 0
46106>>>>>>>    //1008:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã barticl_code1 (©¬¤˜¢¢˜©¦£â¤¦¬)
46106>>>>>>>    //1009:m_code:ž œšš¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ˜§¦ «¦ module §¦¬ «ž¤ ›ž£ ¦ç¨šž©œ
46106>>>>>>>    //1010
46106>>>>>>>    //1011:m_code <> "" (š ˜ «¦¬ª å› ¦¬ª ¢æš¦¬ª «¦¬ c_code_2
46106>>>>>>>
46106>>>>>>>
46106>>>>>>>    //****:garticl_aa = 0:œ§ «¨â§œ«˜  save £æ¤¦¤ ©œ §¨¦©à¨ ¤âª ¡ ¤ã©œ ª-«˜ ¦¨ ©« ¡á á¨Ÿ¨˜ ›â¤ ˜¢¦ é¤¦¤«˜ 
46106>>>>>>>    //                   (§¨¦©¦®ã ©«ž¤ ®¦¨ã©ž©ž ˜˜ : §¨é«˜ ©éà Gmove ¡˜  £œ«á garticl!)
46106>>>>>>>    //                   § Ÿ˜¤æ¤ ¦ â¢œš®¦ª ˜¬«æª ¤˜ šå¤œ  £œ «¦ statuse
46106>>>>>>>    //                   ˜¬«æ § á¤œ«˜  ˜§¦ «¦ garticl «žª šœ¤ ¡ãª ¢¦š ©« ¡ãª
46106>>>>>>>      Function Validate_Save Returns Integer
46107>>>>>>>               Integer iReturnVal
46108>>>>>>>
46108>>>>>>>               Forward Get Validate_Save to iReturnVal
46110>>>>>>>               //Set piCreated_Barticl to 0
46110>>>>>>>
46110>>>>>>>                //---------â¢œš®¦  create & edit barticl record----------------------
46110>>>>>>>               If (Not(iReturnVal));               Begin
46112>>>>>>>                //1001+1002:â¢œš®¦  ž£œ¨¦£ž¤å˜ª
46112>>>>>>>                If (Not(Barticl.Barticl_Hmnia >= SysCurXr.Year_XrhshFrom )) Send Operation_Not_Allowed 1001
46115>>>>>>>                If (Not(Barticl.Barticl_Hmnia <= SysCurXr.Year_XrhshTo   )) Send Operation_Not_Allowed 1002
46118>>>>>>>
46118>>>>>>>                //1007:â¢œš®¦ª ˜¨ Ÿ£¦ç §˜¨˜©«˜« ¡¦ç
46118>>>>>>>                If (Not(Barticl.Barticl_No     >  0                  )) Send Operation_Not_Allowed 1007
46121>>>>>>>
46121>>>>>>>//                //1009:â¢œš®¦ª module œšš¨˜­ãª
46121>>>>>>>//                    If (Not(Barticl.Barticl_M_Code = gs_Module_Code))       Begin
46121>>>>>>>//                        Pause 24 00 'Barticl.Barticl_M_Code=' Barticl.Barticl_M_Code '     gs_Module_Code=' gs_Module_Code
46121>>>>>>>//                        Send Operation_Not_Allowed 1009
46121>>>>>>>//                    End
46121>>>>>>>
46121>>>>>>>                //1011:â¢œš®¦ª £ã ¡œ¤¦ç module œšš¨˜­ãª
46121>>>>>>>                If (Trim(Barticl.Barticl_M_Code)="")       Send Operation_Not_Allowed 1011
46124>>>>>>>                //---------«â¢¦ª œ¢âš®à¤ create & edit barticl record----------------------
46124>>>>>>>
46124>>>>>>>                //---------â¢œš®¦  create barticl record----------------------
46124>>>>>>>                //sososo £ž§àª §¨œ§œ  ¤˜ §˜ ¥à £œ «ž¤ current record ????
46124>>>>>>>                If (Barticl.Recnum =  0);                Begin //œá¤ ›ž£ ¦¬¨šé ¤â¦ record
46126>>>>>>>                End   //«â¢¦ª œ¢âš®à¤ ›ž£ ¦¬¨šå˜ª ¤â¦¬ barticl record
46126>>>>>>>>
46126>>>>>>>
46126>>>>>>>                //---------â¢œš®¦  editing existing barticl records-------------------
46126>>>>>>>                Else;                Begin //edit an existing record
46127>>>>>>>                      //1003:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent btypkin record
46127>>>>>>>                      If (Not;                          ((psB_Btypkin_Recr(Self)) = Btypkin.Btypkin_Recr);                         )                                              Send Operation_Not_Allowed 1003
46130>>>>>>>                      //1004:«¨¦§¦§¦åž©ž (edit) barticl_hmnia £æ¤¦¤ ˜§æ barticl_dd
46130>>>>>>>                      If (;                           ((pdB_Barticl_Hmnia(Self))     <> Barticl.Barticl_Hmnia) and;                           ((Main_File(OPERATION_ORIGIN)) <> Barticl.File_Number);                         )                                              Send Operation_Not_Allowed 1004
46133>>>>>>>                      //1005:«¨¦§¦§¦åž©ž (edit) barticl_no £æ¤¦¤ ˜§æ barticl_dd
46133>>>>>>>                      If (;                           ((piB_Barticl_No   (Self))     <> Barticl.Barticl_No) and;                           ((Main_File(OPERATION_ORIGIN)) <> Barticl.File_Number);                         )                                              Send Operation_Not_Allowed 1005
46136>>>>>>>
46136>>>>>>>
46136>>>>>>>                      //1006:«¨¦§¦§¦åž©ž (edit) barticl_aitiol £æ¤¦¤ ˜§æ barticl_dd
46136>>>>>>>                      If (;                           ((psB_Garticl_Aitiol(Self))    <> Barticl.Barticl_Aitiol) and;                           ((Main_File(OPERATION_ORIGIN)) <> Barticl.File_Number) ;                         )                                              Send Operation_Not_Allowed 1006
46139>>>>>>>
46139>>>>>>>
46139>>>>>>>
46139>>>>>>>                      //1008:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã barticl_code1 (©¬¤˜¢¢˜©¦£â¤¦¬)
46139>>>>>>>                      If (Not;                          ((psB_Barticl_Code1(Self)) = Barticl.Barticl_Code1);                         )                                              Send Operation_Not_Allowed 1008
46142>>>>>>>                End   //«â¢¦ª œ¢âš®à¤ editing existing barticl record
46142>>>>>>>>
46142>>>>>>>                If ( ;                    (Not(Barticl.Company_Code = Syscurxr.Company_Code)) or;                    (Not(Barticl.Branch_Code  = Syscurxr.Branch_Code )) or;                    (Not(Barticl.Year_Year    = Syscurxr.Year_Year   ));                    )                                                   Send Operation_Not_Allowed 1100
46145>>>>>>>
46145>>>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
46145>>>>>>>>
46145>>>>>>>               Function_Return iReturnVal
46146>>>>>>>      End_Function   // validate_save
46147>>>>>>>
46147>>>>>>>
46147>>>>>>>      Function Validate_Delete  Returns Integer
46148>>>>>>>               Integer iReturnVal
46149>>>>>>>               Forward Get Validate_Delete  To iReturnVal
46151>>>>>>>               If (Not(iReturnVal));               Begin
46153>>>>>>>                    If ( ;                        (Not(Barticl.Company_Code = Syscurxr.Company_Code)) or;                        (Not(Barticl.Branch_Code  = Syscurxr.Branch_Code )) or;                        (Not(Barticl.Year_Year    = Syscurxr.Year_Year   ));                        )                                                   Send Operation_Not_Allowed 2100
46156>>>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
46156>>>>>>>>
46156>>>>>>>               Function_Return iReturnVal
46157>>>>>>>      End_Function   // Validate_Delete
46158>>>>>>>
46158>>>>>>>
46158>>>>>>>
46158>>>>>>>      Procedure Request_Save
46159>>>>>>>               Integer liGarticl_Rec0 liCmove_Rec0 liVmove_Rec0 iErrorObj
46160>>>>>>>
46160>>>>>>>               Send private.Initialize_Properties //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties
46161>>>>>>>
46161>>>>>>>               //ž cascade update «¨â®œ  £æ¤¦¤ ©œ existing barticl records
46161>>>>>>>               //æ«˜¤ ›ž£ ¦¬¨šé ¤â¦ record, «æ«œ ›â¤ ®¨œ á¦£˜  «å§¦«˜
46161>>>>>>>               If ((Current_Record(Self)) = 0) Begin
46163>>>>>>>                    Forward Send Request_Save
46165>>>>>>>                    Send private.Initialize_Properties //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties
46166>>>>>>>                    Procedure_Return
46167>>>>>>>               End
46167>>>>>>>>
46167>>>>>>>
46167>>>>>>>               //æ«˜¤ ¡á¤à edit existing record, §¨â§œ  ¤˜ «¨â®à «ž¤ cascade update
46167>>>>>>>               //š ˜ ¤˜ â¤ž£œ¨é©à (œá¤ ­¬© ¡á ®¨œ áœ«˜ ) «˜ child bmoves
46167>>>>>>>               //£œ « ª ˜¢¢˜šâª «à¤ 3 foreign §œ›åà¤ «¦¬ barticl
46167>>>>>>>               //(btypkin_code+barticl_hmnia+barticl_no)
46167>>>>>>>               //§¨æª «¦ §˜¨æ¤ ›â¤ œ§ «¨â§œ«˜  ˜¢¢˜šã «¦¬ btypkin.
46167>>>>>>>
46167>>>>>>>               //***************
46167>>>>>>>               BEGIN_TRANSACTION
46168>>>>>>>               //***************
46168>>>>>>>                // js 09/09/2002
46168>>>>>>>                Move Error_Object_ID to iErrorObj
46169>>>>>>>                //
46169>>>>>>>
46169>>>>>>>//               Set Smart_Filemode_State to False
46169>>>>>>>
46169>>>>>>>               Forward Send Request_Save
46171>>>>>>>
46171>>>>>>>               //˜¤áš¤à©ž rec0's «à¤ ˜¤«å©«¦ ®à¤ articl's «à¤ ¢¦ §é¤ modules
46171>>>>>>>               Get Field_Current_Value Field Barticl.Garticl_Rec0 to liGarticl_Rec0
46172>>>>>>>               Get Field_Current_Value Field Barticl.Carticl_Rec0 to liCmove_Rec0
46173>>>>>>>               Get Field_Current_Value Field Barticl.Varticl_Rec0 to liVmove_Rec0
46174>>>>>>>
46174>>>>>>>//               Send private.Transaction_Update_Other_Modules liGarticl_Rec0;
46174>>>>>>>//                                                             liCmove_Rec0;
46174>>>>>>>//                                                             liVmove_Rec0;
46174>>>>>>>//                                                             1
46174>>>>>>>//                                                             //œ¤ž£â¨à©ž ¢¦ §é¤ modules
46174>>>>>>>
46174>>>>>>>               Send private.Transaction_Cascade_Update_Bmove //cascade œ¤ž£â¨à©ž bmove
46175>>>>>>>
46175>>>>>>>               //***************
46175>>>>>>>               END_TRANSACTION
46176>>>>>>>               //***************
46176>>>>>>>                // js 09/09/2002
46176>>>>>>>                Move iErrorObj to Error_Object_ID
46177>>>>>>>//                //
46177>>>>>>>
46177>>>>>>>//               Set Smart_Filemode_State to True
46177>>>>>>>
46177>>>>>>>               Send private.Initialize_Properties //£ž›œ¤ ©£æª properties š ˜ œ§æ£œ¤ž ¡å¤ž©ž
46178>>>>>>>
46178>>>>>>>               //œ§˜¤˜­¦¨á «¦¬ system indicator err
46178>>>>>>>               Indicate Err False
46179>>>>>>>     End_Procedure   // request_save
46180>>>>>>>
46180>>>>>>>
46180>>>>>>>//     Procedure Request_Delete
46180>>>>>>>//               Integer liGarticl_Rec0 liCmove_Rec0 liVmove_Rec0 iErrorObj
46180>>>>>>>
46180>>>>>>>//               //safety only ?
46180>>>>>>>//               If ((Current_Record(Self)) <> 0);
46180>>>>>>>//               Begin
46180>>>>>>>//                    Send Request_Assign //š ˜ ¤˜ © š¦¬¨œ¬«é æ«  «˜ file buffers â®¦¬¤ ©¬š®¨¦¤©Ÿœå £œ «˜ ddo buffers
46180>>>>>>>
46180>>>>>>>//                    Send private.Initialize_Properties //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties
46180>>>>>>>
46180>>>>>>>//                    //***************
46180>>>>>>>//                    BEGIN_TRANSACTION
46180>>>>>>>//                    //***************
46180>>>>>>>
46180>>>>>>>//                    // js 09/09/2002
46180>>>>>>>//                    Move Error_Object_ID to iErrorObj
46180>>>>>>>//                    //
46180>>>>>>>//                    Set Smart_Filemode_State to False
46180>>>>>>>
46180>>>>>>>//                    //˜¤áš¤à©ž rec0's «à¤ ˜¤«å©«¦ ®à¤ articl's «à¤ ¢¦ §é¤ modules
46180>>>>>>>//                    Get Field_Current_Value Field Barticl.Garticl_Rec0 to liGarticl_Rec0
46180>>>>>>>//                    Get Field_Current_Value Field Barticl.Carticl_Rec0 to liCmove_Rec0
46180>>>>>>>//                    Get Field_Current_Value Field Barticl.Varticl_Rec0 to liVmove_Rec0
46180>>>>>>>
46180>>>>>>>//                    Forward Send Request_Delete
46180>>>>>>>
46180>>>>>>>////                    Send private.Transaction_Update_Other_Modules liGarticl_Rec0;
46180>>>>>>>////                                                                  liCmove_Rec0;
46180>>>>>>>////                                                                  liVmove_Rec0;
46180>>>>>>>////                                                                  (-1)
46180>>>>>>>////                    //***************
46180>>>>>>>//                    END_TRANSACTION
46180>>>>>>>//                    //***************
46180>>>>>>>//                    // js 09/09/2002
46180>>>>>>>//                    Move iErrorObj to Error_Object_ID
46180>>>>>>>//                    //
46180>>>>>>>
46180>>>>>>>//                    Set Smart_Filemode_State to True
46180>>>>>>>
46180>>>>>>>//                    Send private.Initialize_Properties //£ž›œ¤ ©£æª properties š ˜ œ§æ£œ¤ž ¡å¤ž©ž
46180>>>>>>>
46180>>>>>>>//                    //œ§˜¤˜­¦¨á «¦¬ system indicator err
46180>>>>>>>//                    Indicate Err False
46180>>>>>>>//               End
46180>>>>>>>//     End_Procedure //request_delete
46180>>>>>>>
46180>>>>>>>
46180>>>>>>>     //ž ¨¦¬«å¤˜ ˜¬«ã ˜¤˜¢˜£™á¤œ  ¤˜ ¡á¤œ  cascade update ©«¦ bmove
46180>>>>>>>     //¡˜¢œå«˜  ˜§æ «ã¤ request save, £â©˜ ˜§æ transaction, £æ¤¦¤ š ˜ existing barticl records.
46180>>>>>>>     //œ§ ©«¨â­œ  ¢áŸž :
46180>>>>>>>     Procedure private.Transaction_Cascade_Update_Bmove
46181>>>>>>>               Integer liBmove_dd
46182>>>>>>>
46182>>>>>>>               //§˜¢˜ âª ¡˜  ¤âœª « £âª «¦¬ barticl
46182>>>>>>>               String   lsB_Btypkin_Recr     lsA_Btypkin_Recr
46182>>>>>>>               Date     ldB_Barticl_Hmnia    ldA_Barticl_Hmnia
46182>>>>>>>               Integer  liB_Barticl_No       liA_Barticl_No
46182>>>>>>>
46182>>>>>>>               //˜¤áš¤à©ž §˜¢˜ é¤ « £é¤ barticl
46182>>>>>>>               Get psB_Btypkin_Recr    to lsB_Btypkin_Recr
46183>>>>>>>               Get pdB_Barticl_Hmnia   to ldB_Barticl_Hmnia
46184>>>>>>>               Get piB_Barticl_No      to liB_Barticl_No
46185>>>>>>>
46185>>>>>>>               //˜¤áš¤à©ž ¤âà¤ « £é¤ barticl
46185>>>>>>>               Get psA_Btypkin_Recr    to lsA_Btypkin_Recr
46186>>>>>>>               Get pdA_Barticl_Hmnia   to ldA_Barticl_Hmnia
46187>>>>>>>               Get piA_Barticl_No      to liA_Barticl_No
46188>>>>>>>
46188>>>>>>>               //œá¤ æ¢œª ¦  « £âª before+after œå¤˜  å©œª,
46188>>>>>>>               //«æ«œ ›â¤ £§˜å¤à ¡˜Ÿæ¢¦¬ ©«¦¤ ¡æ§¦ ¤˜ «¨â¥à,
46188>>>>>>>               //˜¢¢á ­œçšà ...«¨â®¦¤«˜ª!
46188>>>>>>>               If (;                    (lsB_Btypkin_Recr   = lsA_Btypkin_Recr   ) and;                    (ldB_Barticl_Hmnia  = ldA_Barticl_Hmnia  ) and;                    (liB_Barticl_No     = liA_Barticl_No     )    ;                   ) Begin
46190>>>>>>>                      Procedure_Return
46191>>>>>>>                     End
46191>>>>>>>>
46191>>>>>>>
46191>>>>>>>
46191>>>>>>>               //**************************************************************************
46191>>>>>>>               //02.rebuild constraints, ¢æšà «à¤ ¡¢á©œà¤
46191>>>>>>>               //**************************************************************************
46191>>>>>>>               Get piBmove_dd           to liBmove_dd
46192>>>>>>>               Send Rebuild_Constraints to (piBtypkin_dd(Self))
46193>>>>>>>               Send Rebuild_Constraints to Self
46194>>>>>>>               Send Rebuild_Constraints to (piBaxio_dd  (Self))
46195>>>>>>>               Send Rebuild_Constraints to liBmove_dd
46196>>>>>>>
46196>>>>>>>               //**************************************************************************
46196>>>>>>>               //03.©á¨à©ž Bmove
46196>>>>>>>               //**************************************************************************
46196>>>>>>>               Send Clear to liBmove_dd
46197>>>>>>>               Send Find to liBmove_dd FIRST_RECORD 3 //barticl_recr+bmove_rec0
46198>>>>>>>               While (Found=1)
46202>>>>>>>                      Send Request_Save to liBmove_dd
46203>>>>>>>                      Send Find to liBmove_dd NEXT_RECORD 3 //Barticl_recr+Bmove_rec0
46204>>>>>>>               Loop
46205>>>>>>>>
46205>>>>>>>               Send Find to liBmove_dd FIRST_RECORD 3 //barticl_rec0+bmove_rec0
46206>>>>>>>               //send check_arthro_for_ypol (› æ«  £§¦¨œå ¤˜ ˜¢¢á¥œ   ©¦« £å˜ !)
46206>>>>>>>     End_Procedure //private.transaction_cascade_update_bmove
46207>>>>>>>
46207>>>>>>>
46207>>>>>>>
46207>>>>>>>     //ž ¨¦¬«å¤˜ ˜¬«ã ˜¤˜¢˜£™á¤œ  ¤˜ œ¤ž£œ¨é©œ  æ©˜ ˜§¦ «˜ ¬§æ¢¦ §˜ 3 modules «¦¬ ©¬©«ã£˜«¦ª
46207>>>>>>>     //§¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤.
46207>>>>>>>     //¡˜¢œå«˜  ˜§æ «åª request save & delete, £â©˜ ˜§æ transaction.
46207>>>>>>>     //œ§ ©«¨â­œ  ¢áŸž :
46207>>>>>>>     Procedure private.Transaction_Update_Other_Modules Integer liGarticl_Rec0;                                                        Integer liCmove_Rec0;                                                        Integer liVmove_Rec0;                                                        Integer liMode
46208>>>>>>>
46208>>>>>>>               Integer liDo_GL_Maintainance liDo_CUSTOMER_Maintainance liDo_VENDOR_Maintainance
46209>>>>>>>               Integer liMust_Update_GL     liMust_Update_CUSTOMER     liMust_Update_VENDOR
46209>>>>>>>
46209>>>>>>>               //4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
46209>>>>>>>               Integer liFlag02 liFlag03 liFlag04 liFlag05
46209>>>>>>>
46209>>>>>>>               //œç¨œ©ž «à¤ ¢¦ §é¤ modules §¦¬ §¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤
46209>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Gtypkin_Rec0   to liMust_Update_GL
46210>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Ctypkin_Rec0   to liMust_Update_CUSTOMER
46211>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Vtypkin_Rec0   to liMust_Update_VENDOR
46212>>>>>>>
46212>>>>>>>               //˜¤áš¤à©ž «à¤ 4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
46212>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag02 to liFlag02
46213>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag03 to liFlag03
46214>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag04 to liFlag04
46215>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag05 to liFlag05
46216>>>>>>>
46216>>>>>>>               If (;                   ( liMust_Update_Gl     > 0) and;                   ( liGarticl_Rec0      <> 0)    ;                  );               Begin //delete or edit barticl
46218>>>>>>>               //***************************************************************************
46218>>>>>>>               //*  €  • †    „ Œ † ‹ „  — ‘ † ‘    ‚ „ Œ ˆ ‰ † ‘    Š Ž ‚ ˆ ‘ ’ ˆ ‰ † ‘ *
46218>>>>>>>               //***************************************************************************
46218>>>>>>>               //œ­'æ©¦¤ «¦ barticl record › ˜š¨á­ž¡œ ¡˜¤¦¤ ¡á, §¨¦®à¨áà ©«ž¤ bpo
46218>>>>>>>               //š ˜ «ž¤ œ¤ž£â¨à©ž «žª šœ¤ ¡ãª ¢¦š ©« ¡ãª, œá¤ æ£àª ®¨œ áœ«˜ !
46218>>>>>>>               //§¨¦­˜¤éª, §¨â§œ  ¤˜ › ˜š¨á¯à ¡˜  æ¢¦ «¦ ˜¤«å©«¦ ®¦ garticl
46218>>>>>>>
46218>>>>>>>//jsjsjs 24/01/2001
46218>>>>>>>//               If (liMode = (-1));
46218>>>>>>>//               Begin //¡¢ã©ž ˜§¦ request delete
46218>>>>>>>//                     Send Transaction_Delete_Garticl to (piDo_GL_Maintainance(Self)) (Self);
46218>>>>>>>//                                                                                     liGarticl_Rec0;
46218>>>>>>>//                                                                                     liFlag02;
46218>>>>>>>//                                                                                     liFlag03;
46218>>>>>>>//                                                                                     liFlag04;
46218>>>>>>>//                                                                                     liFlag05
46218>>>>>>>//               End
46218>>>>>>>//               Else;
46218>>>>>>>//               Begin //¡¢ã©ž ˜§¦ request save ç©«œ¨˜ ˜§¦ «ž¤ cascase update bmove
46218>>>>>>>//                     Send Transaction_Update_Garticl to (piDo_GL_Maintainance(Self)) (Self);
46218>>>>>>>//                                                                                     liGarticl_Rec0;
46218>>>>>>>//                                                                                     liFlag02;
46218>>>>>>>//                                                                                     liFlag03;
46218>>>>>>>//                                                                                     liFlag04;
46218>>>>>>>//                                                                                     liFlag05
46218>>>>>>>//               End
46218>>>>>>>//               //****************************************************************************
46218>>>>>>>//               //* ’ „ Š Ž ‘    „ Œ † ‹ „  — ‘ † ‘    ‚ „ Œ ˆ ‰ † ‘    Š Ž ‚ ˆ ‘ ’ ˆ ‰ † ‘ *
46218>>>>>>>//               //****************************************************************************
46218>>>>>>>               End //if (liMust_Update_Gl > 0) and ...
46218>>>>>>>>
46218>>>>>>>//jsjsjs 24/01/2001
46218>>>>>>>
46218>>>>>>>
46218>>>>>>>
46218>>>>>>>
46218>>>>>>>               If (liMust_Update_CUSTOMER > 0);               Begin
46220>>>>>>>               //****************************************************************************
46220>>>>>>>               //*  €  • †    „ Œ † ‹ „  — ‘ † ‘     „ Š € ’ — Œ                         *
46220>>>>>>>               //****************************************************************************
46220>>>>>>>               //****************************************************************************
46220>>>>>>>               //* ’ „ Š Ž ‘    „ Œ † ‹ „  — ‘ † ‘     „ Š € ’ — Œ                        *
46220>>>>>>>               //****************************************************************************
46220>>>>>>>               End //if (liMust_Update_CUSTOMER > 0)
46220>>>>>>>>
46220>>>>>>>
46220>>>>>>>
46220>>>>>>>               If (liMust_Update_VENDOR   > 0);               Begin
46222>>>>>>>               //****************************************************************************
46222>>>>>>>               //*  €  • †    „ Œ † ‹ „  — ‘ † ‘      Ž ‹ † ‡ „ “ ’ — Œ                 *
46222>>>>>>>               //****************************************************************************
46222>>>>>>>               //****************************************************************************
46222>>>>>>>               //* ’ „ Š Ž ‘    „ Œ † ‹ „  — ‘ † ‘      Ž ‹ † ‡ „ “ ’ — Œ                *
46222>>>>>>>               //****************************************************************************
46222>>>>>>>               End //if (liMust_Update_VENDOR > 0)
46222>>>>>>>>
46222>>>>>>>
46222>>>>>>>     End_Procedure //private.transaction_update_other_modules
46223>>>>>>>
46223>>>>>>>
46223>>>>>>>
46223>>>>>>>
46223>>>>>>>//--------------------------------------------------------------------------------------------
46223>>>>>>>
46223>>>>>>>    Procedure Define_Fields
46224>>>>>>>        Forward Send Define_Fields
46226>>>>>>>        //DDB-Generated-Code-Location
46226>>>>>>>        //DDB-DefineFieldStart
46226>>>>>>>
46226>>>>>>>        Set Main_File            To Barticl.File_Number
46227>>>>>>>        Set Cascade_Delete_State To FALSE
46228>>>>>>>
46228>>>>>>>
46228>>>>>>>        // Child (Client) file structure................
46228>>>>>>>        Send Add_Client_File  Bmove.File_Number
46229>>>>>>>        Send Add_Client_File  Bsum.File_Number
46230>>>>>>>
46230>>>>>>>        // Parent (Server) file structure...............
46230>>>>>>>        Send Add_Server_File  Btypkin.File_Number
46231>>>>>>>
46231>>>>>>>        // External (System) file structure.............
46231>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
46232>>>>>>>        Send Add_System_File  Cn.File_Number  DD_LOCK_ON_ALL
46233>>>>>>>
46233>>>>>>>        Define_Auto_Increment  Sysrecb.Barticl_Rec0  To Barticl.Barticl_Rec0
46236>>>>>>>
46236>>>>>>>        // Field-based properties.......................
46236>>>>>>>
46236>>>>>>>        // Barticl.Company_Code
46236>>>>>>>
46236>>>>>>>        // Barticl.Branch_Code
46236>>>>>>>
46236>>>>>>>        // Barticl.Year_Year
46236>>>>>>>
46236>>>>>>>        // Barticl.Btypkin_Code
46236>>>>>>>
46236>>>>>>>        // Barticl.Barticl_Hmnia
46236>>>>>>>        Set Field_Entry_msg        Field Barticl.Barticl_Hmnia To Shmera
46237>>>>>>>        Set Field_Mask_Type        Field Barticl.Barticl_Hmnia To MASK_DATE_WINDOW
46238>>>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_Hmnia To (Barticl(Self))
46239>>>>>>>
46239>>>>>>>        // Barticl.Barticl_No
46239>>>>>>>
46239>>>>>>>        // Barticl.Barticl_Rec0
46239>>>>>>>
46239>>>>>>>        // Barticl.Barticl_Recr
46239>>>>>>>
46239>>>>>>>        // Barticl.Btypkin_Recr
46239>>>>>>>
46239>>>>>>>        // Barticl.Barticl_Code1
46239>>>>>>>
46239>>>>>>>        // Barticl.Barticl_Epon1
46239>>>>>>>
46239>>>>>>>        // Barticl.Barticl_Code2
46239>>>>>>>
46239>>>>>>>        // Barticl.Barticl_Epon2
46239>>>>>>>
46239>>>>>>>        // Barticl.Barticl_Aitiol
46239>>>>>>>
46239>>>>>>>        // Barticl.Barticl_Sv2
46239>>>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Sv2 To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
46239>>>>>>>
46239>>>>>>>        // Barticl.Barticl_Sv0
46239>>>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Sv0 To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
46239>>>>>>>
46239>>>>>>>        // Barticl.Barticl_Sv00
46239>>>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Sv00 To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
46239>>>>>>>
46239>>>>>>>        // Barticl.Barticl_Svr
46239>>>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Svr To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
46239>>>>>>>
46239>>>>>>>        // Barticl.Barticl_Lines
46239>>>>>>>
46239>>>>>>>        // Barticl.Barticl_Bmovela
46239>>>>>>>
46239>>>>>>>        // Barticl.Barticl_M_Code
46239>>>>>>>        Set Field_Value_Table      Field Barticl.Barticl_M_Code To (Barticl_Barticl_M_Code_VT(Self))
46240>>>>>>>
46240>>>>>>>        // Barticl.Garticl_Rec0
46240>>>>>>>
46240>>>>>>>        // Barticl.Carticl_Rec0
46240>>>>>>>
46240>>>>>>>        // Barticl.Varticl_Rec0
46240>>>>>>>
46240>>>>>>>        // Barticl.Gmove_Mrec0
46240>>>>>>>
46240>>>>>>>        // Barticl.Gplan_Mrec0
46240>>>>>>>
46240>>>>>>>        // Barticl.Client_Mrecr
46240>>>>>>>
46240>>>>>>>        // Barticl.Barticl_Ekleise
46240>>>>>>>
46240>>>>>>>        // Barticl.Cmoves_Recr
46240>>>>>>>
46240>>>>>>>        // Barticl.Isotimia
46240>>>>>>>
46240>>>>>>>        // Barticl.Cn_Code
46240>>>>>>>        Set Field_Prompt_Object    Field Barticl.Cn_Code To (sl041(Self))
46241>>>>>>>
46241>>>>>>>        // Barticl.Cn_Descr
46241>>>>>>>
46241>>>>>>>        // Barticl.Cn_Recr
46241>>>>>>>
46241>>>>>>>        // Barticl.Sls_Id
46241>>>>>>>
46241>>>>>>>        // Barticl.Cnt_Id
46241>>>>>>>
46241>>>>>>>        // Barticl.Presp_Id
46241>>>>>>>
46241>>>>>>>        // Barticl.Se_Logik
46241>>>>>>>
46241>>>>>>>        // Barticl.Sxolia1
46241>>>>>>>
46241>>>>>>>        // Barticl.Sxolia2
46241>>>>>>>
46241>>>>>>>        // Barticl.Partl_Akyr_Recr
46241>>>>>>>
46241>>>>>>>        //DDB-DefineFieldEnd
46241>>>>>>>
46241>>>>>>>        Set Main_File            To Barticl.File_Number
46242>>>>>>>
46242>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
46243>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
46244>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
46245>>>>>>>
46245>>>>>>>        // Child (Client) file structure................
46245>>>>>>>        Send Add_Client_File  Bsum.File_Number
46246>>>>>>>        Send Add_Client_File  Bmove.File_Number
46247>>>>>>>
46247>>>>>>>        // Parent (Server) file structure...............
46247>>>>>>>        Send Add_Server_File  Btypkin.File_Number
46248>>>>>>>
46248>>>>>>>        // External (System) file structure.............
46248>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
46249>>>>>>>        //Send Add_System_File  Gplan.File_Number  DD_LOCK_ON_SAVE
46249>>>>>>>
46249>>>>>>>        Define_Auto_Increment  Sysrecb.Barticl_Rec0  To Barticl.Barticl_Rec0
46252>>>>>>>
46252>>>>>>>        // Field-based properties.......................
46252>>>>>>>
46252>>>>>>>        // Barticl.Company_Code
46252>>>>>>>
46252>>>>>>>        // Barticl.Branch_Code
46252>>>>>>>
46252>>>>>>>        // Barticl.Year_Year
46252>>>>>>>
46252>>>>>>>        // Barticl.Btypkin_Code
46252>>>>>>>
46252>>>>>>>        // Barticl.Barticl_Hmnia
46252>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Hmnia    To "†£/¤å˜"
46253>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Hmnia    To "†£/¤å˜"
46254>>>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_Hmnia    To (Barticl(Self))
46255>>>>>>>
46255>>>>>>>        // Barticl.Barticl_No
46255>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_No       To "€¨ Ÿ£æª"
46256>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_No       To "€¨ Ÿ£æª"
46257>>>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_No       To (Barticl(Self))
46258>>>>>>>
46258>>>>>>>        // Barticl.Barticl_Rec0
46258>>>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_Rec0     To (Barticl(Self))
46259>>>>>>>        Set Key_Field_State        Field Barticl.Barticl_Rec0     To TRUE
46260>>>>>>>
46260>>>>>>>        // Barticl.Btypkin_Rec0
46260>>>>>>>
46260>>>>>>>        // Barticl.Barticl_Code1
46260>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Code1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª"
46261>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Code1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª"
46262>>>>>>>
46262>>>>>>>        // Barticl.Barticl_Epon1
46262>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Epon1    To "„§à¤¬£å˜"
46263>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Epon1    To "„§à¤¬£å˜"
46264>>>>>>>
46264>>>>>>>        // Barticl.Barticl_Code2
46264>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Code2    To "˜¨˜¢ã§«žª"
46265>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Code2    To "˜¨˜¢ã§«žª"
46266>>>>>>>
46266>>>>>>>        // Barticl.Barticl_Epon2
46266>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Epon2    To "„§à¤¬£å˜"
46267>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Epon2    To "„§à¤¬£å˜"
46268>>>>>>>
46268>>>>>>>        // Barticl.Barticl_Aitiol
46268>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Aitiol   To "€ « ¦¢¦šå˜"
46269>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Aitiol   To "€ « ¦¢¦šå˜"
46270>>>>>>>
46270>>>>>>>        // Barticl.Barticl_Sv2
46270>>>>>>>        Set Field_Options          Field Barticl.Barticl_Sv2      To DD_DISPLAYONLY
46271>>>>>>>
46271>>>>>>>        // Barticl.Barticl_Sv0
46271>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Sv0      To "‘ç¤¦¢˜ €¥ é¤ ‘œ ‰ç¨ ¦ Œæ£ ©£˜ •¨ã©žª"
46272>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Sv0      To "‘ç¤¦¢˜"
46273>>>>>>>        Set Field_Options          Field Barticl.Barticl_Sv0      To DD_DISPLAYONLY
46274>>>>>>>
46274>>>>>>>        // Barticl.Barticl_Sv00
46274>>>>>>>        Set Field_Options          Field Barticl.Barticl_Sv00     To DD_DISPLAYONLY
46275>>>>>>>
46275>>>>>>>        // Barticl.Barticl_Svr
46275>>>>>>>        Set Field_Options          Field Barticl.Barticl_Svr      To DD_DISPLAYONLY
46276>>>>>>>
46276>>>>>>>        // Barticl.Barticl_Lines
46276>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Lines    To "’œ£á® ˜"
46277>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Lines    To "’œ£á® ˜"
46278>>>>>>>        Set Field_Options          Field Barticl.Barticl_Lines    To DD_DISPLAYONLY
46279>>>>>>>
46279>>>>>>>        // Barticl.Barticl_Bmovela
46279>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Bmovela  To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª ‚¨˜££ãª"
46280>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Bmovela  To "’œ¢. €¨.‚¨˜££ãª"
46281>>>>>>>        Set Field_Options          Field Barticl.Barticl_Bmovela  To DD_DISPLAYONLY
46282>>>>>>>
46282>>>>>>>        // Barticl.Barticl_M_Code
46282>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_M_Code   To "Module „šš¨˜­ãª"
46283>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_M_Code   To "Module „šš¨˜­ãª"
46284>>>>>>>        Set Field_Options          Field Barticl.Barticl_M_Code   To DD_DISPLAYONLY
46285>>>>>>>        Set Field_Value_Table      Field Barticl.Barticl_M_Code   To (Barticl_Barticl_M_Code_VT(Self))
46286>>>>>>>
46286>>>>>>>        // Barticl.Garticl_Rec0
46286>>>>>>>        Set Field_Options          Field Barticl.Garticl_Rec0     To DD_DISPLAYONLY
46287>>>>>>>
46287>>>>>>>        // Barticl.Carticl_Rec0
46287>>>>>>>        Set Field_Options          Field Barticl.Carticl_Rec0     To DD_DISPLAYONLY
46288>>>>>>>
46288>>>>>>>        // Barticl.Varticl_Rec0
46288>>>>>>>        Set Field_Options          Field Barticl.Varticl_Rec0     To DD_DISPLAYONLY
46289>>>>>>>
46289>>>>>>>        // Barticl.Gmove_Mrec0
46289>>>>>>>        Set Field_Options          Field Barticl.Gmove_Mrec0      To DD_DISPLAYONLY
46290>>>>>>>
46290>>>>>>>        // Barticl.Gplan_Mrec0
46290>>>>>>>        Set Field_Options          Field Barticl.Gplan_Mrec0      To DD_DISPLAYONLY
46291>>>>>>>
46291>>>>>>>    End_Procedure    // Define_Fields
46292>>>>>>>
46292>>>>>>>
46292>>>>>>>    Procedure Field_Defaults
46293>>>>>>>        Forward Send Field_Defaults
46295>>>>>>>        //DDB-Generated-Code-Location
46295>>>>>>>        //DDB-FieldDefaultStart
46295>>>>>>>        //DDB-FieldDefaultEnd
46295>>>>>>>    End_Procedure    // Field_Defaults
46296>>>>>>>
46296>>>>>>>End_Class    // Barticl_DataDictionary
46297>>>>>>>//DDB-Selection-pkg-Start
46297>>>>>>>
46297>>>>>>>Use Barticl.SL       // Barticl
INCLUDING FILE: BARTICL.SL
46297>>>>>>>>>//AB/ Project Barticl:Lookup
46297>>>>>>>>>//AB/ Object prj is a Lookup_Project
46297>>>>>>>>>//AB/     Set ProjectName to "Barticl:Lookup"
46297>>>>>>>>>//AB/     Set ProjectFileName to "Barticl.SL"
46297>>>>>>>>>
46297>>>>>>>>>// Project Object Structure
46297>>>>>>>>>//   Barticl is a dbModalPanelSub
46297>>>>>>>>>//     Btypkin_DD2 is a Btypkin_DataDictionary
46297>>>>>>>>>//     Btypkin_DD is a DataDictionary
46297>>>>>>>>>//     Barticl_DD is a DataDictionary
46297>>>>>>>>>//     Country_DD is a DataDictionary
46297>>>>>>>>>//     Towns_DD is a DataDictionary
46297>>>>>>>>>//     Cities_DD is a DataDictionary
46297>>>>>>>>>//     Areas_DD is a DataDictionary
46297>>>>>>>>>//     Payresp_DD is a DataDictionary
46297>>>>>>>>>//     Clients_DD is a DataDictionary
46297>>>>>>>>>//     oSelList is a dbListSub
46297>>>>>>>>>//     Btypkin_Btypkin_Code is a dbFormSub
46297>>>>>>>>>//     Btypkin_Btypkin_Descr is a dbFormSub
46297>>>>>>>>>//     Clients_Client_Name is a dbFormSub
46297>>>>>>>>>//     cSyDateForm1 is a cSyDateForm
46297>>>>>>>>>//     chkOpen is a CheckBoxSub
46297>>>>>>>>>//     ButtonSub1 is a ButtonSub
46297>>>>>>>>>//     oOK_bn is a ButtonSub
46297>>>>>>>>>//     oCancel_bn is a ButtonSub
46297>>>>>>>>>
46297>>>>>>>>>// Register all objects
46297>>>>>>>>>Register_Object Areas_DD
46297>>>>>>>>>Register_Object Barticl
46297>>>>>>>>>Register_Object Barticl_DD
46297>>>>>>>>>Register_Object Btypkin_Btypkin_Code
46297>>>>>>>>>Register_Object Btypkin_Btypkin_Descr
46297>>>>>>>>>Register_Object Btypkin_DD
46297>>>>>>>>>Register_Object Btypkin_DD2
46297>>>>>>>>>Register_Object ButtonSub1
46297>>>>>>>>>Register_Object Cities_DD
46297>>>>>>>>>Register_Object Clients_Client_Name
46297>>>>>>>>>Register_Object Clients_DD
46297>>>>>>>>>Register_Object Country_DD
46297>>>>>>>>>Register_Object chkOpen
46297>>>>>>>>>Register_Object cSyDateForm1
46297>>>>>>>>>Register_Object oCancel_bn
46297>>>>>>>>>Register_Object oOK_bn
46297>>>>>>>>>Register_Object oSelList
46297>>>>>>>>>Register_Object Payresp_DD
46297>>>>>>>>>Register_Object Towns_DD
46297>>>>>>>>>
46297>>>>>>>>>
46297>>>>>>>>>//AB-IgnoreStart
46297>>>>>>>>>
46297>>>>>>>>>Use DFAllEnt.pkg
46297>>>>>>>>>Use dbList.Sub
46297>>>>>>>>>Use dbForm.Sub
46297>>>>>>>>>Use cSyDateForm.Pkg
46297>>>>>>>>>Use Chkbox.Sub
46297>>>>>>>>>Use Button.Sub
46297>>>>>>>>>
46297>>>>>>>>>
46297>>>>>>>>>Use BTYPKIN.DD
46297>>>>>>>>>Use BARTICL.DD
46297>>>>>>>>>Use COUNTRY.DD
46297>>>>>>>>>Use TOWNS.DD
46297>>>>>>>>>Use CITIES.DD
46297>>>>>>>>>Use AREAS.DD
46297>>>>>>>>>Use PAYRESP.DD
46297>>>>>>>>>Use CLIENTS.DD
46297>>>>>>>>>
46297>>>>>>>>>//AB-IgnoreEnd
46297>>>>>>>>>
46297>>>>>>>>>Object Barticl is a dbModalPanelSub
46299>>>>>>>>>
46299>>>>>>>>>    //AB-StoreTopStart
46299>>>>>>>>>    
46299>>>>>>>>>    Property Integer    piWhat              Public  0
46301>>>>>>>>>    Property Integer    FragmaTypkinCode    Public  0
46303>>>>>>>>>    Property Integer    piIsOpen            Public  0
46305>>>>>>>>>    Property String     FragmaClientID      Public ''
46307>>>>>>>>>    Property String     FragmaClientEpon    Public ''
46309>>>>>>>>>    Property Date       FragmaHmnia         Public ''
46311>>>>>>>>>    
46311>>>>>>>>>    Object Btypkin_DD2 is a Btypkin_DataDictionary
46313>>>>>>>>>    End_Object
46314>>>>>>>>>    
46314>>>>>>>>>    
46314>>>>>>>>>    //AB-StoreTopEnd
46314>>>>>>>>>
46314>>>>>>>>>    Set Label to "‰ ¤ã©œ ª €¥ ¦š¨á­à¤"
46315>>>>>>>>>    Set Size to 289 519
46316>>>>>>>>>    Set Location to 2 5
46317>>>>>>>>>    Set Exit_Application_Local_State to FALSE
46318>>>>>>>>>    Set Modal_State to FALSE
46319>>>>>>>>>
46319>>>>>>>>>    //AB-DDOStart
46319>>>>>>>>>
46319>>>>>>>>>    Object Btypkin_DD is a Btypkin_DataDictionary
46321>>>>>>>>>    End_Object    // Btypkin_DD
46322>>>>>>>>>
46322>>>>>>>>>    Object Barticl_DD is a Barticl_DataDictionary
46324>>>>>>>>>        Set DDO_Server to (Btypkin_DD(self))
46325>>>>>>>>>
46325>>>>>>>>>        //AB-StoreStart
46325>>>>>>>>>                    
46325>>>>>>>>>        Begin_Constraints
46327>>>>>>>>>            Integer iTypkinCode iWhat isOpen
46328>>>>>>>>>            String  sClientID sClientEpon
46328>>>>>>>>>            Date    dHmnia
46328>>>>>>>>>        
46328>>>>>>>>>            Get FragmaTypkinCode    to iTypkinCode
46329>>>>>>>>>            Get FragmaClientID      to sClientID
46330>>>>>>>>>            Get FragmaClientEpon    to sClientEpon
46331>>>>>>>>>            Get FragmaHmnia         to dHmnia
46332>>>>>>>>>            Get piIsOpen            to isOpen
46333>>>>>>>>>        
46333>>>>>>>>>            If (iTypkinCode<>'') Begin
46335>>>>>>>>>                If (sClientID<>'') Begin
46337>>>>>>>>>                    Set Ordering Of Barticl_DD to 8
46338>>>>>>>>>                    // Comp+Br+Year+Btypkin_Code+Epon1+Hmnia+Recnum
46338>>>>>>>>>                    Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
46340>>>>>>>>>                    Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
46342>>>>>>>>>                    Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
46344>>>>>>>>>                    Constrain Barticl.Btypkin_Code  Eq iTypkinCode
46346>>>>>>>>>                    Constrain Barticl.Barticl_Epon1 Eq sClientEpon
46348>>>>>>>>>                    If (dHmnia<>'') Constrain Barticl.Barticl_Hmnia Eq dHmnia
46352>>>>>>>>>                End
46352>>>>>>>>>>
46352>>>>>>>>>                Else Begin
46353>>>>>>>>>                    Set Ordering Of Barticl_DD to 11
46354>>>>>>>>>                    // Comp+Br+Year+Btypkin_Code+Hmnia+Epon1+Recnum
46354>>>>>>>>>                    Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
46356>>>>>>>>>                    Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
46358>>>>>>>>>                    Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
46360>>>>>>>>>                    Constrain Barticl.Btypkin_Code  Eq iTypkinCode
46362>>>>>>>>>                    If (dHmnia<>'') Constrain Barticl.Barticl_Hmnia Eq dHmnia
46366>>>>>>>>>                End
46366>>>>>>>>>>
46366>>>>>>>>>            End
46366>>>>>>>>>>
46366>>>>>>>>>            Else If (dHmnia<>'') Begin
46369>>>>>>>>>                Set Ordering Of Barticl_DD to 9
46370>>>>>>>>>                // Comp+Br+Year+Hmnia+Epon1+Recnum
46370>>>>>>>>>                Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
46372>>>>>>>>>                Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
46374>>>>>>>>>                Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
46376>>>>>>>>>                Constrain Barticl.Barticl_Hmnia Eq dHmnia
46378>>>>>>>>>                If (sClientID<>'') Constrain Barticl.Barticl_Epon1 Eq sClientEpon
46382>>>>>>>>>            End
46382>>>>>>>>>>
46382>>>>>>>>>            Else If (sClientID<>'') Begin
46385>>>>>>>>>                Set Ordering Of Barticl_DD to 8
46386>>>>>>>>>                // Comp+Br+Year+Epon1+Hmnia+Recnum
46386>>>>>>>>>                Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
46388>>>>>>>>>                Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
46390>>>>>>>>>                Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
46392>>>>>>>>>                Constrain Barticl.Barticl_Epon1 Eq sClientEpon
46394>>>>>>>>>            End
46394>>>>>>>>>>
46394>>>>>>>>>            Else Begin
46395>>>>>>>>>                Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
46397>>>>>>>>>                Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
46399>>>>>>>>>                Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
46401>>>>>>>>>            End
46401>>>>>>>>>>
46401>>>>>>>>>            If (isOpen) Constrain Barticl.Barticl_Ekleise NE '1'
46405>>>>>>>>>        End_Constraints
46408>>>>>>>>>        
46408>>>>>>>>>        
46408>>>>>>>>>        
46408>>>>>>>>>        
46408>>>>>>>>>        
46408>>>>>>>>>        
46408>>>>>>>>>        
46408>>>>>>>>>        
46408>>>>>>>>>        
46408>>>>>>>>>        
46408>>>>>>>>>        
46408>>>>>>>>>        
46408>>>>>>>>>        
46408>>>>>>>>>        
46408>>>>>>>>>        //AB-StoreEnd
46408>>>>>>>>>
46408>>>>>>>>>    End_Object    // Barticl_DD
46409>>>>>>>>>
46409>>>>>>>>>    Object Country_DD is a Country_DataDictionary
46411>>>>>>>>>    End_Object    // Country_DD
46412>>>>>>>>>
46412>>>>>>>>>    Object Towns_DD is a Towns_DataDictionary
46414>>>>>>>>>        Set DDO_Server to (Country_DD(self))
46415>>>>>>>>>    End_Object    // Towns_DD
46416>>>>>>>>>
46416>>>>>>>>>    Object Cities_DD is a Cities_DataDictionary
46418>>>>>>>>>        Set DDO_Server to (Towns_DD(self))
46419>>>>>>>>>    End_Object    // Cities_DD
46420>>>>>>>>>
46420>>>>>>>>>    Object Areas_DD is a Areas_DataDictionary
46422>>>>>>>>>    End_Object    // Areas_DD
46423>>>>>>>>>
46423>>>>>>>>>    Object Payresp_DD is a Payresp_DataDictionary
46425>>>>>>>>>    End_Object    // Payresp_DD
46426>>>>>>>>>
46426>>>>>>>>>    Object Clients_DD is a Clients_DataDictionary
46428>>>>>>>>>        Set DDO_Server to (Cities_DD(self))
46429>>>>>>>>>        Set DDO_Server to (Areas_DD(self))
46430>>>>>>>>>        Set DDO_Server to (Payresp_DD(self))
46431>>>>>>>>>    End_Object    // Clients_DD
46432>>>>>>>>>
46432>>>>>>>>>    Set Main_DD to (Barticl_DD(self))
46433>>>>>>>>>    Set Server to (Barticl_DD(self))
46434>>>>>>>>>
46434>>>>>>>>>    //AB-DDOEnd
46434>>>>>>>>>
46434>>>>>>>>>    Object oSelList is a dbListSub
46436>>>>>>>>>        Set Main_File to Barticl.File_Number
46437>>>>>>>>>        Set Size to 219 505
46438>>>>>>>>>        Set Location to 6 6
46439>>>>>>>>>
46439>>>>>>>>>        Begin_Row
46442>>>>>>>>>            Entry_Item Barticl.Barticl_no
46443>>>>>>>>>            Entry_Item Barticl.Barticl_hmnia
46444>>>>>>>>>            Entry_Item Btypkin.Btypkin_code
46445>>>>>>>>>            Entry_Item Btypkin.Btypkin_descr
46446>>>>>>>>>            Entry_Item Barticl.Barticl_code1
46447>>>>>>>>>            Entry_Item Barticl.Barticl_epon1
46448>>>>>>>>>            Entry_Item Barticl.Barticl_sv0
46449>>>>>>>>>            Entry_Item Barticl.Barticl_ekleise
46450>>>>>>>>>        End_Row
46455>>>>>>>>>
46455>>>>>>>>>        Set Form_Width    item 0 to 53
46456>>>>>>>>>        Set Header_Label  item 0 to "€¨ Ÿ£æª"
46457>>>>>>>>>        
46457>>>>>>>>>        Set Form_Width    item 1 to 48
46458>>>>>>>>>        Set Header_Label  item 1 to "†£œ¨/¤å˜"
46459>>>>>>>>>        
46459>>>>>>>>>        Set Form_Width    item 2 to 39
46460>>>>>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž"
46461>>>>>>>>>        
46461>>>>>>>>>        Set Form_Width    item 3 to 100
46462>>>>>>>>>        Set Header_Label  item 3 to "œ¨ š¨˜­ã"
46463>>>>>>>>>        
46463>>>>>>>>>        Set Form_Width    item 4 to 60
46464>>>>>>>>>        Set Header_Label  item 4 to "‘¬¤˜¢/¤¦ª"
46465>>>>>>>>>        
46465>>>>>>>>>        Set Form_Width    item 5 to 122
46466>>>>>>>>>        Set Header_Label  item 5 to "„§à¤¬£å˜"
46467>>>>>>>>>        
46467>>>>>>>>>        Set Form_Width    item 6 to 60
46468>>>>>>>>>        Set Header_Label  item 6 to "¦©æ"
46469>>>>>>>>>        
46469>>>>>>>>>        Set Form_Width    item 7 to 16
46470>>>>>>>>>        Set Header_Label  item 7 to "‰"
46471>>>>>>>>>        Set Column_Checkbox_State  item 7 to True
46472>>>>>>>>>        
46472>>>>>>>>>
46472>>>>>>>>>        //AB-StoreStart
46472>>>>>>>>>                                                
46472>>>>>>>>>        //Property Integer StoreFragmaTypkinCode  Public 0
46472>>>>>>>>>        //Property String  StoreFragmaClientID    Public ''
46472>>>>>>>>>        //Property String  StoreFragmaClientEpon  Public ''
46472>>>>>>>>>        //Property Date    StoreFragmaHmnia       Public ''
46472>>>>>>>>>        
46472>>>>>>>>>        Procedure End_Construct_Object
46474>>>>>>>>>            Integer iDecimals
46475>>>>>>>>>            Forward Send End_Construct_Object
46477>>>>>>>>>            Get fiDekadika_Nomismatos SysCurXr.C_Code0   to    iDecimals
46478>>>>>>>>>            Set Points Item 6 to iDecimals
46479>>>>>>>>>            Set Numeric_Mask Item 6 to 14 iDecimals ' ,*'
46480>>>>>>>>>        End_Procedure
46481>>>>>>>>>        
46481>>>>>>>>>        //Procedure Store_Defaults
46481>>>>>>>>>        //       Forward Send Store_Defaults
46481>>>>>>>>>        //       Set StoreFragmaTypkinCode    to (FragmaTypkinCode(Self))
46481>>>>>>>>>        //       Set StoreFragmaClientID      to (FragmaClientID  (Self))
46481>>>>>>>>>        //       Set StoreFragmaClientEpon    to (FragmaClientEpon(Self))
46481>>>>>>>>>        //       Set StoreFragmaHmnia         to (FragmaHmnia     (Self))
46481>>>>>>>>>        //End_Procedure
46481>>>>>>>>>        
46481>>>>>>>>>        //Procedure ReStore_Defaults
46481>>>>>>>>>        //       Forward Send ReStore_Defaults
46481>>>>>>>>>        //       Set FragmaTypkinCode to (StoreFragmaTypkinCode(Self))
46481>>>>>>>>>        //       Set FragmaClientID   to (StoreFragmaClientID  (Self))
46481>>>>>>>>>        //       Set FragmaClientEpon to (StoreFragmaClientEpon(Self))
46481>>>>>>>>>        //       Set FragmaHmnia      to (StoreFragmaHmnia     (Self))
46481>>>>>>>>>        //End_Procedure
46481>>>>>>>>>        
46481>>>>>>>>>        Procedure Activate
46483>>>>>>>>>            Send Keyaction to ButtonSub1
46484>>>>>>>>>            Forward Send Activate
46486>>>>>>>>>        End_procedure
46487>>>>>>>>>        
46487>>>>>>>>>        Procedure Activating
46489>>>>>>>>>            Forward Send Activating
46491>>>>>>>>>            Set Auto_Index_State to True
46492>>>>>>>>>        End_Procedure
46493>>>>>>>>>        
46493>>>>>>>>>        
46493>>>>>>>>>        
46493>>>>>>>>>        
46493>>>>>>>>>        
46493>>>>>>>>>        
46493>>>>>>>>>        
46493>>>>>>>>>        
46493>>>>>>>>>        
46493>>>>>>>>>        
46493>>>>>>>>>        
46493>>>>>>>>>        
46493>>>>>>>>>        
46493>>>>>>>>>        
46493>>>>>>>>>        
46493>>>>>>>>>        
46493>>>>>>>>>        
46493>>>>>>>>>        
46493>>>>>>>>>        
46493>>>>>>>>>        
46493>>>>>>>>>        
46493>>>>>>>>>        //AB-StoreEnd
46493>>>>>>>>>
46493>>>>>>>>>    End_Object    // oSelList
46494>>>>>>>>>
46494>>>>>>>>>    Object Btypkin_Btypkin_Code is a dbFormSub
46496>>>>>>>>>        Entry_Item Btypkin.Btypkin_code
46497>>>>>>>>>        Set Label to "’ç§¦ª ‰å¤ž©žª"
46498>>>>>>>>>        Set Size to 13 49
46499>>>>>>>>>        Set Location to 229 84
46500>>>>>>>>>        Set Label_Col_Offset to 5
46501>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
46502>>>>>>>>>
46502>>>>>>>>>        //AB-StoreStart
46502>>>>>>>>>                                                                                            
46502>>>>>>>>>        Set Server to (Btypkin_DD2(Self))
46503>>>>>>>>>        
46503>>>>>>>>>        Procedure Key Integer iKey
46505>>>>>>>>>            Integer iRetVal
46506>>>>>>>>>            Forward Send Key iKey
46508>>>>>>>>>            If (iKey=277) Send Clear to Btypkin_DD2
46511>>>>>>>>>        End_Procedure
46512>>>>>>>>>        
46512>>>>>>>>>        
46512>>>>>>>>>        //AB-StoreEnd
46512>>>>>>>>>
46512>>>>>>>>>    End_Object    // Btypkin_Btypkin_Code
46513>>>>>>>>>
46513>>>>>>>>>    Object Btypkin_Btypkin_Descr is a dbFormSub
46515>>>>>>>>>        Entry_Item Btypkin.Btypkin_descr
46516>>>>>>>>>        Set Size to 13 133
46517>>>>>>>>>        Set Location to 229 139
46518>>>>>>>>>        Set Color to clBtnFace
46519>>>>>>>>>        Set Label_Col_Offset to 2
46520>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
46521>>>>>>>>>        Set Enabled_State to FALSE
46522>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
46523>>>>>>>>>        Set Shadow_State Item 0 to TRUE
46524>>>>>>>>>
46524>>>>>>>>>        //AB-StoreStart
46524>>>>>>>>>        Set Server to (Btypkin_DD2(Self))
46525>>>>>>>>>        
46525>>>>>>>>>        //AB-StoreEnd
46525>>>>>>>>>
46525>>>>>>>>>    End_Object    // Btypkin_Btypkin_Descr
46526>>>>>>>>>
46526>>>>>>>>>    Object Clients_Client_Name is a dbFormSub
46528>>>>>>>>>        Entry_Item Clients.Client_name
46529>>>>>>>>>        Set Server to (Clients_DD(self))
46530>>>>>>>>>        Set Label to "‘¬¤˜¢¢˜©æ£œ¤¦ª"
46531>>>>>>>>>        Set Size to 13 188
46532>>>>>>>>>        Set Location to 244 84
46533>>>>>>>>>        Set Label_Col_Offset to 5
46534>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
46535>>>>>>>>>
46535>>>>>>>>>        //AB-StoreStart
46535>>>>>>>>>                                                                                            
46535>>>>>>>>>        Procedure Key Integer iKey
46537>>>>>>>>>            Integer iRetVal
46538>>>>>>>>>            Forward Send Key iKey
46540>>>>>>>>>            If (iKey=277) Send Clear to Clients_DD
46543>>>>>>>>>        End_Procedure
46544>>>>>>>>>        
46544>>>>>>>>>        //AB-StoreEnd
46544>>>>>>>>>
46544>>>>>>>>>    End_Object    // Clients_Client_Name
46545>>>>>>>>>
46545>>>>>>>>>    Object cSyDateForm1 is a cSyDateForm
46547>>>>>>>>>        Set Label to "†£œ¨¦£ž¤å˜"
46548>>>>>>>>>        Set Size to 13 66
46549>>>>>>>>>        Set Location to 258 84
46550>>>>>>>>>        Set Label_Col_Offset to 5
46551>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
46552>>>>>>>>>        Set Form_Mask Item 0 to "dd/MM/yyyy"
46553>>>>>>>>>
46553>>>>>>>>>        //AB-StoreStart
46553>>>>>>>>>                                                                                            
46553>>>>>>>>>        On_Key KClear Send ClearMe
46554>>>>>>>>>        
46554>>>>>>>>>        Procedure ClearMe
46556>>>>>>>>>            Set Value Item 0 to ''
46557>>>>>>>>>        End_Procedure
46558>>>>>>>>>        
46558>>>>>>>>>        //AB-StoreEnd
46558>>>>>>>>>
46558>>>>>>>>>    End_Object    // cSyDateForm1
46559>>>>>>>>>
46559>>>>>>>>>    Object chkOpen is a CheckBoxSub
46561>>>>>>>>>        Set Label to "‹æ¤¦ ˜¤¦ ®«á"
46562>>>>>>>>>        Set Size to 10 62
46563>>>>>>>>>        Set Location to 260 156
46564>>>>>>>>>    End_Object    // chkOpen
46565>>>>>>>>>
46565>>>>>>>>>    Object ButtonSub1 is a ButtonSub
46567>>>>>>>>>        Set Label to "œ¨ æ¨ ©œ"
46568>>>>>>>>>        Set Size to 13 52
46569>>>>>>>>>        Set Location to 258 219
46570>>>>>>>>>
46570>>>>>>>>>        //AB-StoreStart
46570>>>>>>>>>                            
46570>>>>>>>>>        Procedure OnClick
46572>>>>>>>>>            String  sEpon sID
46573>>>>>>>>>            Integer iTypkin isOpen
46573>>>>>>>>>            Date    dHmnia
46573>>>>>>>>>        
46573>>>>>>>>>            Get Value Of cSyDateForm1 Item 0                                  to dHmnia
46574>>>>>>>>>            Get Field_Current_Value Of Clients_DD  Field Clients.Client_ID    to sID
46575>>>>>>>>>            Get Field_Current_Value Of Clients_DD  Field Clients.Client_Name  to sEpon
46576>>>>>>>>>            Get Field_Current_Value Of Btypkin_DD2 Field Btypkin.Btypkin_Code to iTypkin
46577>>>>>>>>>        
46577>>>>>>>>>            Get Checked_State Of chkOpen to isOpen
46578>>>>>>>>>        
46578>>>>>>>>>            Set FragmaTypkinCode    to iTypkin
46579>>>>>>>>>            Set FragmaClientID      to sID
46580>>>>>>>>>            Set FragmaClientEpon    to sEpon
46581>>>>>>>>>            Set FragmaHmnia         to dHmnia
46582>>>>>>>>>            Set piIsOpen            to isOpen
46583>>>>>>>>>        
46583>>>>>>>>>            Send Rebuild_Constraints    to Barticl_DD
46584>>>>>>>>>            Send Beginning_Of_Data      to oSelList True
46585>>>>>>>>>        End_Procedure // OnClick
46586>>>>>>>>>        
46586>>>>>>>>>        
46586>>>>>>>>>        
46586>>>>>>>>>        //AB-StoreEnd
46586>>>>>>>>>
46586>>>>>>>>>    End_Object    // ButtonSub1
46587>>>>>>>>>
46587>>>>>>>>>    Object oOK_bn is a ButtonSub
46589>>>>>>>>>        Set Label to "&„§ ¢¦šã"
46590>>>>>>>>>        Set Size to 13 50
46591>>>>>>>>>        Set Location to 258 406
46592>>>>>>>>>        Set Focus_Mode to Pointer_Only
46593>>>>>>>>>
46593>>>>>>>>>        //AB-StoreStart
46593>>>>>>>>>        Procedure OnClick
46595>>>>>>>>>            Send OK To (oSelList(current_object))
46596>>>>>>>>>        End_Procedure
46597>>>>>>>>>        //AB-StoreEnd
46597>>>>>>>>>
46597>>>>>>>>>    End_Object    // oOK_bn
46598>>>>>>>>>
46598>>>>>>>>>    Object oCancel_bn is a ButtonSub
46600>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
46601>>>>>>>>>        Set Size to 13 50
46602>>>>>>>>>        Set Location to 258 461
46603>>>>>>>>>        Set Focus_Mode to Pointer_Only
46604>>>>>>>>>
46604>>>>>>>>>        //AB-StoreStart
46604>>>>>>>>>        Procedure OnClick
46606>>>>>>>>>            Send Cancel To (oSelList(current_object))
46607>>>>>>>>>        End_Procedure
46608>>>>>>>>>        //AB-StoreEnd
46608>>>>>>>>>
46608>>>>>>>>>    End_Object    // oCancel_bn
46609>>>>>>>>>
46609>>>>>>>>>
46609>>>>>>>>>    //AB-StoreStart
46609>>>>>>>>>    
46609>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
46610>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
46611>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
46612>>>>>>>>>    
46612>>>>>>>>>    Set Modal_State to True
46613>>>>>>>>>    
46613>>>>>>>>>    Procedure Activate
46615>>>>>>>>>        If (FragmaTypkinCode(Self)<>0) Begin
46617>>>>>>>>>            Send Clear to Btypkin_DD2
46618>>>>>>>>>            Move (FragmaTypkinCode(Self)) to Btypkin.Btypkin_Code
46619>>>>>>>>>            Send Find to Btypkin_DD2 Eq 1
46620>>>>>>>>>        End
46620>>>>>>>>>>
46620>>>>>>>>>        Else Send Clear to Btypkin_DD2
46622>>>>>>>>>        If (FragmaClientID(Self)<>'') Begin
46624>>>>>>>>>            Send Clear to Clients_DD
46625>>>>>>>>>            Move (FragmaClientID(Self)) to Clients.Client_ID
46626>>>>>>>>>            Send Find to Clients_DD Eq 6
46627>>>>>>>>>        End
46627>>>>>>>>>>
46627>>>>>>>>>        Else Send Clear to Clients_DD
46629>>>>>>>>>        If (FragmaHmnia(Self)<>'') Set Value Of cSyDateForm1 Item 0 to (FragmaHmnia(Self))
46632>>>>>>>>>        Else                       Set Value Of cSyDateForm1 Item 0 to ''
46634>>>>>>>>>        Forward Send Activate
46636>>>>>>>>>    End_Procedure
46637>>>>>>>>>    
46637>>>>>>>>>    //AB-StoreEnd
46637>>>>>>>>>
46637>>>>>>>>>End_Object    // Barticl
46638>>>>>>>>>
46638>>>>>>>>>//AB/ End_Object    // prj
46638>>>>>>>Use sl041.SL         // sl041
46638>>>>>>>
46638>>>>>>>//DDB-Selection-pkg-End
46638>>>>>>>//DDB-FileEnd
46638>>>>>    Use BAXIO.DD
INCLUDING FILE: BAXIO.DD
46638>>>>>>>//DDB-FileStart
46638>>>>>>>//DDB-HeaderStart
46638>>>>>>>
46638>>>>>>>// File Name : BAXIO.DD
46638>>>>>>>// Class Name: Baxio_DataDictionary
46638>>>>>>>// Revision  : 105
46638>>>>>>>// Version   : 2
46638>>>>>>>
46638>>>>>>>Use  Windows           // Basic Definitions
46638>>>>>>>Use  DataDict          // DataDictionary Class Definition
46638>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
46638>>>>>>>
46638>>>>>>>Open Baxio
46640>>>>>>>Open Bmove
46642>>>>>>>Open Baxiokat
46644>>>>>>>Open Sysrecb
46646>>>>>>>
46646>>>>>>>//DDB-HeaderEnd
46646>>>>>>>//DDB-ValidationStart
46646>>>>>>>
46646>>>>>>>//DDB/ ExternalValidationTable Baxio_Status_VT  Baxio.pkg
46646>>>>>>>//DDB/ ExternalValidationTable Bfile_VT  Baxio.pkg
46646>>>>>>>
46646>>>>>>>Register_Object Baxio_Status_VT
46646>>>>>>>Register_Object Baxio_Baxio_Place_VT
46646>>>>>>>Register_Object Bfile_VT
46646>>>>>>>Register_Object Baxio_Baxio_Bank_VT
46646>>>>>>>Register_Object Baxio_Baxio_Banka_VT
46646>>>>>>>Register_Object Baxio_Baxio_From_VT
46646>>>>>>>Register_Object Baxio_Baxio_Topos_VT1
46646>>>>>>>Use Baxio.pkg        // Baxio_Status_VT, Bfile_VT
46646>>>>>>>
46646>>>>>>>Object Baxio_Baxio_Place_VT  is a CodeValidationTable
46648>>>>>>>    Set Type_Value        To "BAXIOPLACE"
46649>>>>>>>    //DDB-ValidationCustomStart
46649>>>>>>>    //DDB-ValidationCustomEnd
46649>>>>>>>End_Object   // Baxio_Baxio_Place_VT
46650>>>>>>>
46650>>>>>>>Object Baxio_Baxio_Bank_VT  is a CodeValidationTable
46652>>>>>>>    Set Type_Value        To "BANK"
46653>>>>>>>    Set Allow_Blank_State To TRUE
46654>>>>>>>    //DDB-ValidationCustomStart
46654>>>>>>>    //DDB-ValidationCustomEnd
46654>>>>>>>End_Object   // Baxio_Baxio_Bank_VT
46655>>>>>>>
46655>>>>>>>Object Baxio_Baxio_Banka_VT  is a CodeValidationTable
46657>>>>>>>    Set Type_Value        To "BANK"
46658>>>>>>>    Set Allow_Blank_State To TRUE
46659>>>>>>>    //DDB-ValidationCustomStart
46659>>>>>>>    //DDB-ValidationCustomEnd
46659>>>>>>>End_Object   // Baxio_Baxio_Banka_VT
46660>>>>>>>
46660>>>>>>>Object Baxio_Baxio_From_VT  is a DescriptionValidationTable
46662>>>>>>>    Set Allow_Blank_State To TRUE
46663>>>>>>>    Set Table_Title       To "€¥ æš¨˜­¦  ›å¦¬ / «¨å«¦¬"
46664>>>>>>>
46664>>>>>>>    Procedure Fill_List
46666>>>>>>>        Forward Send Fill_List
46668>>>>>>>        Send Add_Table_Value  "0"  "ˆ›å¦¬"
46669>>>>>>>        Send Add_Table_Value  "1"  "’¨å«¦¬"
46670>>>>>>>    End_Procedure    // Fill_List
46671>>>>>>>    //DDB-ValidationCustomStart
46671>>>>>>>    //DDB-ValidationCustomEnd
46671>>>>>>>End_Object   // Baxio_Baxio_From_VT
46672>>>>>>>
46672>>>>>>>Object Baxio_Baxio_Topos_VT1  is a DescriptionValidationTable
46674>>>>>>>    Set Allow_Blank_State To TRUE
46675>>>>>>>    Set Table_Title       To "€¥ æš¨˜­¦ €«« ¡ãª / „§˜¨®å˜ª"
46676>>>>>>>
46676>>>>>>>    Procedure Fill_List
46678>>>>>>>        Forward Send Fill_List
46680>>>>>>>        Send Add_Table_Value  "0"  "€«« ¡ãª"
46681>>>>>>>        Send Add_Table_Value  "1"  "„§˜¨®å˜ª"
46682>>>>>>>    End_Procedure    // Fill_List
46683>>>>>>>    //DDB-ValidationCustomStart
46683>>>>>>>    //DDB-ValidationCustomEnd
46683>>>>>>>End_Object   // Baxio_Baxio_Topos_VT1
46684>>>>>>>//DDB-ValidationEnd
46684>>>>>>>//DDB-SelectionStart
46684>>>>>>>//DDB/ ExternalSelectionList SL037  SL037.SL
46684>>>>>>>//DDB/ ExternalSelectionList slNomism  slnomism.sl
46684>>>>>>>Register_Object SL037
46684>>>>>>>Register_Object slNomism
46684>>>>>>>//DDB-SelectionEnd
46684>>>>>>>
46684>>>>>>>Class Baxio_DataDictionary  is a DataDictionary_Sec
46685>>>>>>>
46685>>>>>>>
46685>>>>>>>
46685>>>>>>>//    Function fngConvertPoso_Baxio String asNomismaCodeApo ;
46685>>>>>>>//                            Number anPoso           ;
46685>>>>>>>//                            String asNomismaCodeSe  ;
46685>>>>>>>//                            Date   adHmnia          ;
46685>>>>>>>//                            Number nIsotimia  Returns Number
46685>>>>>>>
46685>>>>>>>//        Number rVal nApo_Euro_Isot nSe_Euro_Isot
46685>>>>>>>//        Integer iApo_Einai_Euro_Zone iApo_Einai_DRX iApo_Einai_Euro iDekadika_Apo
46685>>>>>>>//        Integer iSe_Einai_Euro_Zone  iSe_Einai_DRX  iSe_Einai_Euro  iDekadika_Se
46685>>>>>>>
46685>>>>>>>//        If (asNomismaCodeApo=asNomismaCodeSe) Function_Return anPoso
46685>>>>>>>
46685>>>>>>>//        Clear Nomisma
46685>>>>>>>//        Move (Trim(asNomismaCodeApo)) to Nomisma.Nomisma_Code
46685>>>>>>>//        Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
46685>>>>>>>//        Move Nomisma.Euro_Zone      to iApo_Einai_Euro_Zone
46685>>>>>>>//        Move Nomisma.Einai_DRX      to iApo_Einai_DRX
46685>>>>>>>//        Move Nomisma.Einai_EURO     to iApo_Einai_Euro
46685>>>>>>>//        Move Nomisma.KL_ISOT_EURO   to nApo_Euro_Isot
46685>>>>>>>//        Move Nomisma.Dekadika       to iDekadika_Apo
46685>>>>>>>
46685>>>>>>>//        Clear Nomisma
46685>>>>>>>//        Move (Trim(asNomismaCodeSe)) to Nomisma.Nomisma_Code
46685>>>>>>>//        Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
46685>>>>>>>//        Move Nomisma.Euro_Zone      to iSe_Einai_Euro_Zone
46685>>>>>>>//        Move Nomisma.Einai_DRX      to iSe_Einai_DRX
46685>>>>>>>//        Move Nomisma.Einai_EURO     to iSe_Einai_Euro
46685>>>>>>>//        Move Nomisma.KL_ISOT_EURO   to nSe_Euro_Isot
46685>>>>>>>//        Move Nomisma.Dekadika       to iDekadika_Se
46685>>>>>>>
46685>>>>>>>//        //05a. ??ÿ??? ? --> ??? 
46685>>>>>>>//        Calc (anPoso/nApo_Euro_Isot) to rVal
46685>>>>>>>//        Move (Round_Number(rVal,6)) to rVal
46685>>>>>>>//        //05b. ???         --> ??ÿ??? ?™ *
46685>>>>>>>//        Calc (rVal*nSe_Euro_Isot) to rVal
46685>>>>>>>//        Move (Round_Number(rVal,iDekadika_Se)) to rVal
46685>>>>>>>//        Function_Return rVal
46685>>>>>>>//    End_Function
46685>>>>>>>
46685>>>>>>>
46685>>>>>>>
46685>>>>>>>      //¡˜Ÿ¦¨åœ  «ž¤ default « £ã «¦¬ ¤¦£å©£˜«¦ª ˜¤á¢¦š˜ £œ «¦ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
46685>>>>>>>      Function Default_Axio_C_Code2 Returns String
46686>>>>>>>               String lsBaxio_C_Code_2
46687>>>>>>>               //Get File_Field_Current_Value File_Field SyscurXr.C_Code0 to lsBaxio_C_Code_2
46687>>>>>>>               Move SyscurXr.C_Code0 to lsBaxio_C_Code_2
46688>>>>>>>               Function_Return (Trim(lsBaxio_C_Code_2))
46689>>>>>>>      End_Function //default_axio_c_code2
46690>>>>>>>
46690>>>>>>>
46690>>>>>>>      // js 09/02/2002 den yparxei enhmerosh ton nomismatvn xrhshs
46690>>>>>>>      Procedure Convert_Axio_Values
46691>>>>>>>
46691>>>>>>>                Integer liBtypkin_Flag03 liBtypkin_Flag04
46692>>>>>>>
46692>>>>>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_Code0    ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_Rate0       to Baxio.Baxio_V0
46693>>>>>>>
46693>>>>>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_Code00   ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_Rate00      to Baxio.Baxio_V00
46694>>>>>>>
46694>>>>>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_CodeR    ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_RateR       to Baxio.Baxio_VR
46695>>>>>>>
46695>>>>>>>
46695>>>>>>>//                Move (fngConvertPoso_Baxio(Self,Baxio.Baxio_C_Code2,   ;
46695>>>>>>>//                                     Baxio.Baxio_V2,        ;
46695>>>>>>>//                                     SyscurXr.C_Code0,      ;
46695>>>>>>>//                                     Baxio.Baxio_HmniaE,    ;
46695>>>>>>>//                                     Baxio.Baxio_Rate0)     ;
46695>>>>>>>//                                    ) to Baxio.Baxio_V0
46695>>>>>>>//                If (liBtypkin_Flag03 = TRUE);
46695>>>>>>>//                     Begin
46695>>>>>>>//                      //˜¥å˜ 2-->00
46695>>>>>>>//                      Move (fngConvertPoso_Baxio(Self, Baxio.Baxio_C_Code2, ;
46695>>>>>>>//                                            Baxio.Baxio_V2,      ;
46695>>>>>>>//                                            SyscurXr.C_Code00,   ;
46695>>>>>>>//                                            Baxio.Baxio_HmniaE,  ;
46695>>>>>>>//                                            Baxio.Baxio_Rate00)  ;
46695>>>>>>>//                                          ) to Baxio.Baxio_V00
46695>>>>>>>//                     End
46695>>>>>>>//                Else Begin
46695>>>>>>>//                      Move 0            to Baxio.Baxio_V00
46695>>>>>>>//                     End
46695>>>>>>>//                If (liBtypkin_Flag04 = TRUE);
46695>>>>>>>//                     Begin
46695>>>>>>>//                      //˜¥å˜ 2-->r
46695>>>>>>>//                      Move (fngConvertPoso_Baxio(Self,Baxio.Baxio_C_Code2, ;
46695>>>>>>>//                                       Baxio.Baxio_V2,      ;
46695>>>>>>>//                                       SyscurXr.C_CodeR,    ;
46695>>>>>>>//                                       Baxio.Baxio_HmniaE,  ;
46695>>>>>>>//                                       Baxio.Baxio_RateR)   ;
46695>>>>>>>//                                      ) to Baxio.Baxio_VR
46695>>>>>>>//                     End
46695>>>>>>>//                Else Begin
46695>>>>>>>//                      Move 0            to Baxio.Baxio_VR
46695>>>>>>>//                     End
46695>>>>>>>      End_Procedure
46696>>>>>>>
46696>>>>>>>
46696>>>>>>>      Procedure Construct_Object
46697>>>>>>>                Forward Send Construct_Object
46699>>>>>>>
46699>>>>>>>                //btypkin related properties:
46699>>>>>>>                //œ¤ž£œ¨é¤¦¤«˜  ©«ã¤: update «¦¬ bmove,
46699>>>>>>>                //£ž›œ¤å¦¤«˜   ©«ž¤: request save & delete «¦¬ bmove.
46699>>>>>>>                Property Integer piBtypkin_Flag03 0
46700>>>>>>>                Property Integer piBtypkin_Flag04 0
46701>>>>>>>                Property Integer pifromxrhsh      0
46702>>>>>>>
46702>>>>>>>                //baxio related properties:
46702>>>>>>>                //œ¤ž£œ¨é¤œ«˜     ©«ž¤: creating,
46702>>>>>>>                //®¨ž© £¦§¦ œå«˜  ©«ž¤: update «¦¬ bmove š ˜ ¤˜ œ¤œ¨š¦§¦ ã©œ  «ž¤ private.created_baxio «¦¬ bmove,
46702>>>>>>>                //£ž›œ¤åœ«˜      ©«ž¤: request save & delete «¦¬ bmove.
46702>>>>>>>                Property Integer piCreated_Baxio  0
46703>>>>>>>
46703>>>>>>>                //œ¤ž£œ¨é¤¦¤«˜     ©«ž¤: backout,
46703>>>>>>>                //®¨ž© £¦§¦ ¦ç¤«˜  ©«ž¤: validate_save š ˜ «¦¤ â¢œš®¦ editing «¦¬ baxio,
46703>>>>>>>                //£ž›œ¤å¦¤«˜      ©«ž¤: request save & delete «¦¬ bmove.
46703>>>>>>>                Property Number  pnB_Baxio_V2      0
46704>>>>>>>                Property Number  pnB_Baxio_V0      0
46705>>>>>>>                Property Number  pnB_Baxio_V00     0
46706>>>>>>>                Property Number  pnB_Baxio_Vr      0
46707>>>>>>>                Property String  psB_Baxio_C_Code2 ""
46708>>>>>>>                Property Integer piB_Baxio_Status  0
46709>>>>>>>                Property Integer piB_Baxio_Place   0
46710>>>>>>>
46710>>>>>>>                //properties š ˜ œ¢âš®¦¬ª ˜¢˜ššãª parent records:
46710>>>>>>>                //œ¤ž£œ¨é¤¦¤«˜     ©«ž¤:backout,
46710>>>>>>>                //®¨ž© £¦§¦ ¦ç¤«˜  ©«ž¤: validate_save š ˜ «¦¤ â¢œš®¦ editing «à¤ §œ›åà¤,
46710>>>>>>>                //£ž›œ¤å¦¤«˜      ©«ž¤: request save & delete «¦¬ bmove.
46710>>>>>>>                Property Integer piB_Baxiokat_Code 0
46711>>>>>>>                Property Integer piB_Year_Year     0
46712>>>>>>>                Property Integer piMustNOTConstrain Public 0
46713>>>>>>>      End_Procedure //construct_object
46714>>>>>>>
46714>>>>>>>
46714>>>>>>>      Procedure Constrain
46715>>>>>>>                Forward Send Constrain
46717>>>>>>>                If (piMustNOTConstrain(Self)) Begin
46719>>>>>>>                End
46719>>>>>>>>
46719>>>>>>>                Else Begin
46720>>>>>>>                    Constrain Baxio.Company_Code Eq Syscurxr.Company_Code
46722>>>>>>>                    Constrain Baxio.Branch_Code  Eq Syscurxr.Branch_Code
46724>>>>>>>                    Constrain Baxio.Year_Year    Eq Syscurxr.Year_Year
46726>>>>>>>                End
46726>>>>>>>>
46726>>>>>>>      End_Procedure   //constrain
46727>>>>>>>
46727>>>>>>>
46727>>>>>>>      //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
46727>>>>>>>      //™) ˜¤áš¤à©ž properties
46727>>>>>>>      //š) › ˜®œå¨ ©ž calculated §œ›åà¤
46727>>>>>>>      //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
46727>>>>>>>      //œ) œ¤ž£â¨à©ž properties after
46727>>>>>>>      Procedure Update
46728>>>>>>>                Forward Send Update
46730>>>>>>>                
46730>>>>>>>                If (Baxio.Baxio_C_Code2='') Move SyscurXr.C_Code0 to Baxio.Baxio_C_Code2
46733>>>>>>>                
46733>>>>>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
46733>>>>>>>                Move Syscurxr.Company_Code  to Baxio.Company_Code
46734>>>>>>>                Move Syscurxr.Branch_Code   to Baxio.Branch_Code
46735>>>>>>>                Move Syscurxr.Year_Year     to Baxio.Year_Year
46736>>>>>>>                Move Syscurxr.Year_Recr     to Baxio.Year_Recr
46737>>>>>>>                Move Baxiokat.Baxiokat_Code to Baxio.Baxiokat_Code
46738>>>>>>>
46738>>>>>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
46738>>>>>>>                //š01:œ¥ ¦¨ ©£¦ç, «˜ §¢ž¨à«â˜ ›â¤ â®¦¬¤ ©«¦ ®œå˜ §˜¨˜¢¢˜™ãª
46738>>>>>>>                If (Baxiokat.Baxiokat_Type = 2);                Begin //˜¥ æš¨˜­˜ §¢ž¨à«â˜
46740>>>>>>>                     Move "" to Baxio.Baxio_Code_In
46741>>>>>>>                     Move "" to Baxio.Baxio_Epon_In
46742>>>>>>>                     Move 0  to Baxio.Baxio_Fpar_In
46743>>>>>>>                End
46743>>>>>>>>
46743>>>>>>>                //š02:yyyy + mm + dd ¢ã¥žª š ˜ «˜ reports
46743>>>>>>>                Move (TheYearSegment (Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_YYYY
46744>>>>>>>                Move (TheMonthSegment(Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_MM
46745>>>>>>>                Move (TheDaySegment  (Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_DD
46746>>>>>>>
46746>>>>>>>                //š03:§¨é«¦ª & «œ¢œ¬«˜å¦ª §˜¨˜¢ã§«žª
46746>>>>>>>                If (Baxio.Baxio_Lcode = "");                Begin
46748>>>>>>>                     Move (-1) to Baxio.Baxio_File_Out
46749>>>>>>>                     Move ""   to Baxio.Baxio_Code_Out
46750>>>>>>>                     Move ""   to Baxio.Baxio_Epon_Out
46751>>>>>>>                     Move ""   to Baxio.Baxio_Fpar_Out
46752>>>>>>>
46752>>>>>>>                     Move (-1) to Baxio.Baxio_Lfile
46753>>>>>>>                     Move ""   to Baxio.Baxio_Lepon
46754>>>>>>>                     Move ""   to Baxio.Baxio_Lpar
46755>>>>>>>                End
46755>>>>>>>>
46755>>>>>>>      End_Procedure //update
46756>>>>>>>
46756>>>>>>>
46756>>>>>>>      Procedure Backout
46757>>>>>>>                Forward Send Backout
46759>>>>>>>
46759>>>>>>>                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
46759>>>>>>>                Set pnB_Baxio_V2      to Baxio.Baxio_V2
46760>>>>>>>                Set pnB_Baxio_V0      to Baxio.Baxio_V0
46761>>>>>>>                Set pnB_Baxio_V00     to Baxio.Baxio_V00
46762>>>>>>>                Set pnB_Baxio_Vr      to Baxio.Baxio_Vr
46763>>>>>>>                Set psB_Baxio_C_Code2 to Baxio.Baxio_C_Code2
46764>>>>>>>                Set piB_Baxio_Status  to Baxio.Baxio_Status
46765>>>>>>>                Set piB_Baxio_Place   to Baxio.Baxio_Place
46766>>>>>>>                Set piB_Baxiokat_Code to Baxio.Baxiokat_Code    //š ˜ â¢œš®¦ ˜¢˜ššãª parent
46767>>>>>>>                Set piB_Year_Year     to Baxio.Year_Year        //š ˜ â¢œš®¦ ˜¢˜ššãª parent
46768>>>>>>>      End_Procedure //backout
46769>>>>>>>
46769>>>>>>>
46769>>>>>>>      Procedure New_Current_Record Integer liOld_Record Integer liNew_Record
46770>>>>>>>                Forward Send New_Current_Record liOld_Record liNew_Record
46772>>>>>>>                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
46772>>>>>>>                Set pnB_Baxio_V2      to Baxio.Baxio_V2
46773>>>>>>>                Set pnB_Baxio_V0      to Baxio.Baxio_V0
46774>>>>>>>                Set pnB_Baxio_V00     to Baxio.Baxio_V00
46775>>>>>>>                Set pnB_Baxio_Vr      to Baxio.Baxio_Vr
46776>>>>>>>                Set psB_Baxio_C_Code2 to Baxio.Baxio_C_Code2
46777>>>>>>>                Set piB_Baxio_Status  to Baxio.Baxio_Status
46778>>>>>>>                Set piB_Baxiokat_Code to Baxio.Baxiokat_Code    //š ˜ â¢œš®¦ ˜¢˜ššãª parent
46779>>>>>>>                Set piB_Year_Year     to Baxio.Year_Year        //š ˜ â¢œš®¦ ˜¢˜ššãª parent
46780>>>>>>>      End_Procedure //new_current_record
46781>>>>>>>
46781>>>>>>>
46781>>>>>>>      Procedure Creating
46782>>>>>>>                Forward Send Creating
46784>>>>>>>
46784>>>>>>>                //˜¨ Ÿ£æª ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
46784>>>>>>>                //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBaxio
46784>>>>>>>
46784>>>>>>>                //«œ¢œ¬«˜å¦ª ¡à› ¡æª ˜¨ Ÿ£æª ˜¥ ¦š¨á­¦¬
46784>>>>>>>                Add 1 to Baxiokat.Baxio_Lcode
46785>>>>>>>                Move Baxiokat.Baxio_Lcode to Baxio.Baxio_Code
46786>>>>>>>
46786>>>>>>>                //«¦ property ˜¬«æ œ¤œ¨š¦§¦ œå «ž¤ private.created_baxio
46786>>>>>>>                //£â©à «žª update ©«¦ bmove
46786>>>>>>>                Set piCreated_Baxio to TRUE
46787>>>>>>>
46787>>>>>>>//
46787>>>>>>>//                Move SysCurXr.C_Code0 to Baxio.Baxio_C_Code2
46787>>>>>>>
46787>>>>>>>                Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                 (Trim(String(Baxio.Baxio_Rec0)))))) to Baxio.Baxio_Recr
46788>>>>>>>
46788>>>>>>>      End_Procedure //creating
46789>>>>>>>
46789>>>>>>>
46789>>>>>>>      Procedure Operation_Not_Allowed Integer iError_Num
46790>>>>>>>                String lsError_Message
46791>>>>>>>                Case Begin
46791>>>>>>>                     //˜§æ validate save
46791>>>>>>>                     Case (iError_Num = 1001)
46793>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  ¦§à©›ã§¦«œ ž£œ¨¦£ž¤å˜ ¢ã¥œàª!");                          to lsError_Message
46794>>>>>>>                     Case Break
46795>>>>>>>                     Case (iError_Num = 1002)
46798>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
46799>>>>>>>                     Case Break
46800>>>>>>>                     Case (iError_Num = 1003)
46803>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  ¦§à©›ã§¦«œ ¤æ£ ©£˜!");                          to lsError_Message
46804>>>>>>>                     Case Break
46805>>>>>>>                     Case (iError_Num = 1004)
46808>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
46809>>>>>>>                     Case Break
46810>>>>>>>                     Case (iError_Num = 1005)
46813>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
46814>>>>>>>                     Case Break
46815>>>>>>>                     Case (iError_Num = 1006)
46818>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ Reporting).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
46819>>>>>>>                     Case Break
46820>>>>>>>
46820>>>>>>>                     Case (iError_Num = 1007)
46823>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\nŒâ˜ €¥ æš¨˜­˜ ›ž£ ¦¬¨š¦ç¤«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
46824>>>>>>>                     Case Break
46825>>>>>>>                     Case (iError_Num = 1008)
46828>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n’¦ ¤æ£ ©£˜ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
46829>>>>>>>                     Case Break
46830>>>>>>>                     Case (iError_Num = 1009)
46833>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
46834>>>>>>>                     Case Break
46835>>>>>>>                     Case (iError_Num = 1010)
46838>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©žª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
46839>>>>>>>                     Case Break
46840>>>>>>>                     Case (iError_Num = 1011)
46843>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜ •¨ã©žª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
46844>>>>>>>                     Case Break
46845>>>>>>>                     Case (iError_Num = 1012)
46848>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (Œæ£ ©£˜ Reporting) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
46849>>>>>>>                     Case Break
46850>>>>>>>                     Case (iError_Num = 1013)
46853>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n’¦ ˜¥ æš¨˜­¦ â®œ  œ¥¦­¢žŸœå !");                          to lsError_Message
46854>>>>>>>                     Case Break
46855>>>>>>>
46855>>>>>>>                     Case (iError_Num = 1014)
46858>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ ›â¤ œ§ «¨â§œ«˜  ¤˜ ˜¢¢á¥œ  ¡˜«žš¦¨å˜!");                          to lsError_Message
46859>>>>>>>                     Case Break
46860>>>>>>>                     Case (iError_Num = 1015)
46863>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ ›â¤ œ§ «¨â§œ«˜  ¤˜ ˜¢¢á¥œ  ®¨ã©ž!");                          to lsError_Message
46864>>>>>>>                     Case Break
46865>>>>>>>                     Case (iError_Num = 1100)
46868>>>>>>>                          Move "DDC 037:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
46869>>>>>>>                          Case Break
46870>>>>>>>
46870>>>>>>>                     //˜§æ validate delete
46870>>>>>>>                     Case (iError_Num = 2007)
46873>>>>>>>                          Move ("DDC 037:€›ç¤˜«ž ž › ˜š¨˜­ã !\n\n’¦ €¥ æš¨˜­¦ › ˜š¨á­œ«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
46874>>>>>>>                     Case Break
46875>>>>>>>                     Case (iError_Num = 2100)
46878>>>>>>>                          Move "DDC 037:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
46879>>>>>>>                          Case Break
46880>>>>>>>
46880>>>>>>>                     Case Else
46880>>>>>>>                          Forward Send Operation_Not_Allowed iError_Num
46882>>>>>>>                Case End
46882>>>>>>>
46882>>>>>>>                Error iError_Num lsError_Message
46883>>>>>>>>
46883>>>>>>>      End_Procedure // operation_not_allowed
46884>>>>>>>
46884>>>>>>>      //1001:baxio_hmnial > 0
46884>>>>>>>      //1002:baxio_v2 > 0            (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ œšš¨˜­ãª
46884>>>>>>>      //1003:baxio_c_code2 <> ""     (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ £ã¤ â®œ  ¤æ£ ©£˜)
46884>>>>>>>
46884>>>>>>>      //1004:baxio_v0 > 0            (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©žª
46884>>>>>>>      //1005:baxio_v00 > 0 if flag 3 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ›œ¬«œ¨œç¦¤ ¤æ£ ©£˜ ®¨ã©žª
46884>>>>>>>      //1006:baxio_vr > 0  of flag 4 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ reporting
46884>>>>>>>
46884>>>>>>>
46884>>>>>>>      //1007:›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬ œ§ «¨â§œ«˜  £æ¤¦¤ ˜§¦ «¦ bmove_dd, ›ž¢˜›ã §¨â§œ 
46884>>>>>>>      //       If (baxio.recnum=0) then operation_origin must be = bmove_dd
46884>>>>>>>      //1008:«¨¦§¦§¦åž©ž (edit) baxio_c_code2 £æ¤¦¤ ˜§æ bmove_dd
46884>>>>>>>      //1009:«¨¦§¦§¦åž©ž (edit) baxio_v2      £æ¤¦¤ ˜§æ bmove_dd
46884>>>>>>>      //1010:«¨¦§¦§¦åž©ž (edit) baxio_v0      £æ¤¦¤ ˜§æ bmove_dd
46884>>>>>>>      //1011:«¨¦§¦§¦åž©ž (edit) baxio_v00     £æ¤¦¤ ˜§æ bmove_dd
46884>>>>>>>      //1012:«¨¦§¦§¦åž©ž (edit) baxio_vr      £æ¤¦¤ ˜§æ bmove_dd
46884>>>>>>>
46884>>>>>>>      //1013:œá¤ «¦ status œå¤˜  œ¥¦­¢ž£â¤¦, ˜§˜š¦¨œçœ¦¤«˜  æ¢˜ «˜ §œ¨˜ «â¨à edits
46884>>>>>>>
46884>>>>>>>      //1014:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent baxiokat record
46884>>>>>>>      //1015:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent year     record
46884>>>>>>>      Function Validate_Save Returns Integer
46885>>>>>>>               Integer iReturnVal
46886>>>>>>>
46886>>>>>>>               Forward Get Validate_Save to iReturnVal
46888>>>>>>>
46888>>>>>>>               If (Not(iReturnVal));               Begin
46890>>>>>>>
46890>>>>>>>                //---------â¢œš®¦  ›ž£ ¦¬¨šå˜ª ¤â¦¬ baxio record----------------------
46890>>>>>>>                //sososo £ž§àª §¨œ§œ  ¤˜ §˜ ¥à £œ «ž¤ current record ????
46890>>>>>>>                If (Baxio.Recnum =  0);                Begin //œá¤ ›ž£ ¦¬¨šé ¤â¦ record
46892>>>>>>>                      //1007:â¢œš®¦ª ›ž£ ¦¬¨šå˜ª ¤â¦¬ ˜¥ ¦š¨á­¦¬ ˜§¦ «¦ baxio_dd
46892>>>>>>>
46892>>>>>>>                      If (pifromxrhsh(Self)=0) Begin
46894>>>>>>>                        If (Not((Main_File(OPERATION_ORIGIN)) =  Bmove.File_Number)) Send Operation_Not_Allowed 1007
46897>>>>>>>                      End
46897>>>>>>>>
46897>>>>>>>                End   //«â¢¦ª œ¢âš®à¤ ›ž£ ¦¬¨šå˜ª ¤â¦¬ baxio record
46897>>>>>>>>
46897>>>>>>>
46897>>>>>>>
46897>>>>>>>                //---------â¢œš®¦  editing existing baxio records---------------------
46897>>>>>>>                Else;                Begin //edit an existing record
46898>>>>>>>                      //1008:«¨¦§¦§¦åž©ž (edit) baxio_c_code2 £æ¤¦¤ ˜§æ bmove_dd
46898>>>>>>>
46898>>>>>>>                      If (pifromxrhsh(Self)=0) Begin
46900>>>>>>>
46900>>>>>>>                        If (;                            ((psB_Baxio_C_Code2(Self))     <> Baxio.Baxio_C_Code2) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1008
46903>>>>>>>                        //1009:«¨¦§¦§¦åž©ž (edit) baxio_v2 £æ¤¦¤ ˜§æ bmove_dd
46903>>>>>>>                        If (;                            ((pnB_Baxio_V2(Self))          <> Baxio.Baxio_V2      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1009
46906>>>>>>>                        //1010:«¨¦§¦§¦åž©ž (edit) baxio_v0 £æ¤¦¤ ˜§æ bmove_dd
46906>>>>>>>                        If (;                            ((pnB_Baxio_V0(Self))          <> Baxio.Baxio_V0      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1010
46909>>>>>>>                        //1011:«¨¦§¦§¦åž©ž (edit) baxio_v00 £æ¤¦¤ ˜§æ bmove_dd
46909>>>>>>>                        If (;                            ((pnB_Baxio_V00(Self))         <> Baxio.Baxio_V00     ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1011
46912>>>>>>>                        //1012:«¨¦§¦§¦åž©ž (edit) baxio_vr £æ¤¦¤ ˜§æ bmove_dd
46912>>>>>>>                        If (;                            ((pnB_Baxio_Vr(Self))          <> Baxio.Baxio_Vr      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1012
46915>>>>>>>
46915>>>>>>>                      End
46915>>>>>>>>
46915>>>>>>>                        // Egine rem 20/12/2001 giati an orisoume sta metrhta gia paradeigma
46915>>>>>>>                        // oti to status SE einai exoflhmeno, tote xtypaei to validation sto
46915>>>>>>>                        // kleisimo toy barticle. Alloste den vlepoume giati den mporei na
46915>>>>>>>                        // anoigokleisei
46915>>>>>>>//                      //1013:œá¤ «¦ status œå¤˜  œ¥¦­¢ž£â¤¦, ˜§˜š¦¨œç¦¤«˜  æ¢˜ «˜ §œ¨˜ «â¨à edits ˜§¦ «¦ bmove
46915>>>>>>>//                      If (;
46915>>>>>>>//                           ((piB_Baxio_Status(Self))      = 2                    ) and;
46915>>>>>>>//                           ((Main_File(OPERATION_ORIGIN)) =  Bmove.File_Number);
46915>>>>>>>//                         )                                                       Send Operation_Not_Allowed 1013
46915>>>>>>>
46915>>>>>>>                      If (pifromxrhsh(Self)=0) Begin
46917>>>>>>>                        //1014:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent baxiokat record
46917>>>>>>>                        If (Not;                            ((piB_Baxiokat_Code(Self)) =  Baxiokat.Baxiokat_Code);                            )                                                       Send Operation_Not_Allowed 1014
46920>>>>>>>
46920>>>>>>>                        //1015:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent year record
46920>>>>>>>                        If (Not;                            ((piB_Year_Year    (Self)) =  SysCurXr.Year_Year        );                            )                                                       Send Operation_Not_Allowed 1015
46923>>>>>>>                      End
46923>>>>>>>>
46923>>>>>>>                End   //«â¢¦ª œ¢âš®à¤ editing existing baxio records
46923>>>>>>>>
46923>>>>>>>
46923>>>>>>>                //¢¦§¦å â¢œš®¦ 
46923>>>>>>>                //1001:baxio_hmnial > 0
46923>>>>>>>                If (Not(Baxio.Baxio_Hmnial > 0 ))   Send Operation_Not_Allowed 1001
46926>>>>>>>                //1002:baxio_v2 > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ œšš¨˜­ãª
46926>>>>>>>                If (Not(Baxio.Baxio_V2 > 0))         Send Operation_Not_Allowed 1002
46929>>>>>>>                //1003:baxio_c_code2 <> ""
46929>>>>>>>                If (Not(Baxio.Baxio_C_Code2 <>""))    Send Operation_Not_Allowed 1003
46932>>>>>>>                //1004:baxio_v0 > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
46932>>>>>>>//--------------If (Not(Baxio.Baxio_V0 > 0))         Send Operation_Not_Allowed 1004
46932>>>>>>>                //1005:baxio_v00> 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ›œ¬«œ¨œç¦¤ ¤æ£ ©£˜ ®¨ã©œàª
46932>>>>>>>//--------------If (Not(Baxio.Baxio_V00> 0))         Send Operation_Not_Allowed 1005
46932>>>>>>>                //1006:baxio_vr > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ reporting
46932>>>>>>>//--------------If (Not(Baxio.Baxio_VR > 0))         Send Operation_Not_Allowed 1006
46932>>>>>>>                //1100:cby = globals
46932>>>>>>>
46932>>>>>>>                If (pifromxrhsh(Self)=0) Begin
46934>>>>>>>
46934>>>>>>>                    If ( ;                        (Not(Baxio.Company_Code = SyscurXr.Company_Code)) or;                        (Not(Baxio.Branch_Code  = SyscurXr.Branch_Code )) or;                        (Not(Baxio.Year_Year    = SyscurXr.Year_Year   ));                        )                                                   Send Operation_Not_Allowed 1100
46937>>>>>>>
46937>>>>>>>               End
46937>>>>>>>>
46937>>>>>>>
46937>>>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
46937>>>>>>>>
46937>>>>>>>               Function_Return iReturnVal
46938>>>>>>>      End_Function //validate_save
46939>>>>>>>
46939>>>>>>>
46939>>>>>>>      //2007:ž › ˜š¨˜­ã ˜¥ ¦š¨á­¦¬ œ§ «¨â§œ«˜  £æ¤¦¤ ˜§¦ «¦ bmove_dd
46939>>>>>>>      Function Validate_Delete  Returns Integer
46940>>>>>>>               Integer iReturnVal
46941>>>>>>>               Forward Get Validate_Delete  To iReturnVal
46943>>>>>>>               If (Not(iReturnVal));               Begin
46945>>>>>>>
46945>>>>>>>                  //2007:â¢œš®¦ª › ˜š¨˜­ãª ˜¥ ¦š¨á­¦¬ (£æ¤¦¤ ˜§¦ bmove_dd)
46945>>>>>>>                  If ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number)          Send Operation_Not_Allowed 2007
46948>>>>>>>
46948>>>>>>>                  //2100:cby = globals
46948>>>>>>>                  If ( ;                      (Not(Baxio.Company_Code = Syscurxr.Company_Code)) or;                      (Not(Baxio.Branch_Code  = Syscurxr.Branch_Code )) or;                      (Not(Baxio.Year_Year    = Syscurxr.Year_Year        ));                      )                                                   Send Operation_Not_Allowed 2100
46951>>>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
46951>>>>>>>>
46951>>>>>>>               Function_Return iReturnVal
46952>>>>>>>      End_Function //validate_delete
46953>>>>>>>
46953>>>>>>>
46953>>>>>>>//------------------------------------------------------------------
46953>>>>>>>    Procedure Define_Fields
46954>>>>>>>        Forward Send Define_Fields
46956>>>>>>>        //DDB-Generated-Code-Location
46956>>>>>>>        //DDB-DefineFieldStart
46956>>>>>>>
46956>>>>>>>        Set Main_File            To Baxio.File_Number
46957>>>>>>>        Set Cascade_Delete_State To FALSE
46958>>>>>>>
46958>>>>>>>
46958>>>>>>>        // Child (Client) file structure................
46958>>>>>>>        Send Add_Client_File  Bmove.File_Number
46959>>>>>>>
46959>>>>>>>        // Parent (Server) file structure...............
46959>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
46960>>>>>>>
46960>>>>>>>        // External (System) file structure.............
46960>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
46961>>>>>>>
46961>>>>>>>        Define_Auto_Increment  Sysrecb.Baxio_Rec0  To Baxio.Baxio_Rec0
46964>>>>>>>
46964>>>>>>>        // Field-based properties.......................
46964>>>>>>>
46964>>>>>>>        // Baxio.Company_Code
46964>>>>>>>
46964>>>>>>>        // Baxio.Branch_Code
46964>>>>>>>
46964>>>>>>>        // Baxio.Year_Year
46964>>>>>>>
46964>>>>>>>        // Baxio.Baxiokat_Code
46964>>>>>>>
46964>>>>>>>        // Baxio.Baxio_Code
46964>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Code To (SL037(Self))
46965>>>>>>>
46965>>>>>>>        // Baxio.Baxio_Rec0
46965>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Rec0 To (SL037(Self))
46966>>>>>>>
46966>>>>>>>        // Baxio.Year_Recr
46966>>>>>>>
46966>>>>>>>        // Baxio.Baxiokat_Recr
46966>>>>>>>
46966>>>>>>>        // Baxio.Baxio_Recr
46966>>>>>>>
46966>>>>>>>        // Baxio.Baxio_Status
46966>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Status To (Baxio_Status_VT(Self))
46967>>>>>>>
46967>>>>>>>        // Baxio.Baxio_Place
46967>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Place To (Baxio_Baxio_Place_VT(Self))
46968>>>>>>>
46968>>>>>>>        // Baxio.Baxio_File_In
46968>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_In To (Bfile_VT(Self))
46969>>>>>>>
46969>>>>>>>        // Baxio.Baxio_Code_In
46969>>>>>>>        //DDB/ Comment_Short       Field Baxio.Baxio_Code_In To "To BIAXIOKAT_FILE ¡˜Ÿ¦¨åœ  «ž¤ ©®œ« ¡ã ¢å©«˜"
46969>>>>>>>
46969>>>>>>>        // Baxio.Baxio_Epon_In
46969>>>>>>>
46969>>>>>>>        // Baxio.Baxio_Fpar_In
46969>>>>>>>
46969>>>>>>>        // Baxio.Baxio_File_Out
46969>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_Out To (Bfile_VT(Self))
46970>>>>>>>
46970>>>>>>>        // Baxio.Baxio_Code_Out
46970>>>>>>>
46970>>>>>>>        // Baxio.Baxio_Epon_Out
46970>>>>>>>
46970>>>>>>>        // Baxio.Baxio_Fpar_Out
46970>>>>>>>
46970>>>>>>>        // Baxio.Baxio_Lfile
46970>>>>>>>
46970>>>>>>>        // Baxio.Baxio_Lcode
46970>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Lcode To (Bfile_VT(Self))
46971>>>>>>>
46971>>>>>>>        // Baxio.Baxio_Lepon
46971>>>>>>>
46971>>>>>>>        // Baxio.Baxio_Lpar
46971>>>>>>>
46971>>>>>>>        // Baxio.Baxio_Bank00000
46971>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Bank00000 To (Baxio_Baxio_Bank_VT(Self))
46972>>>>>>>
46972>>>>>>>        // Baxio.Baxio_Hmniae
46972>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniae To (SL037(Self))
46973>>>>>>>
46973>>>>>>>        // Baxio.Baxio_Hmniap000
46973>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniap000 To (SL037(Self))
46974>>>>>>>
46974>>>>>>>        // Baxio.Baxio_Hmnial
46974>>>>>>>        //DDB/ Comment_Short       Field Baxio.Baxio_Hmnial To "†£/¤å˜ Šã¥žª:"
46974>>>>>>>
46974>>>>>>>        // Baxio.Baxio_Ekdoths
46974>>>>>>>
46974>>>>>>>        // Baxio.Baxio_Ekdothse
46974>>>>>>>
46974>>>>>>>        // Baxio.Baxio_Sediatagh
46974>>>>>>>
46974>>>>>>>        // Baxio.Baxio_Sdiataghe
46974>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Sdiataghe To (SL037(Self))
46975>>>>>>>
46975>>>>>>>        // Baxio.Baxio_Banka
46975>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Banka To (Baxio_Baxio_Banka_VT(Self))
46976>>>>>>>
46976>>>>>>>        // Baxio.Baxio_Opistho
46976>>>>>>>
46976>>>>>>>        // Baxio.Baxio_No
46976>>>>>>>
46976>>>>>>>        // Baxio.Baxio_V2
46976>>>>>>>
46976>>>>>>>        // Baxio.Baxio_V0
46976>>>>>>>
46976>>>>>>>        // Baxio.Baxio_V00
46976>>>>>>>
46976>>>>>>>        // Baxio.Baxio_Vr
46976>>>>>>>
46976>>>>>>>        // Baxio.Baxio_Rate0
46976>>>>>>>
46976>>>>>>>        // Baxio.Baxio_Rate00
46976>>>>>>>
46976>>>>>>>        // Baxio.Baxio_Rater
46976>>>>>>>
46976>>>>>>>        // Baxio.Baxio_C_Code2
46976>>>>>>>        Set Field_Entry_msg        Field Baxio.Baxio_C_Code2 To get_Default_Axio_C_Code2
46977>>>>>>>        Set Field_Options          Field Baxio.Baxio_C_Code2 To DD_CAPSLOCK   
46978>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_C_Code2 To (slNomism(Self))
46979>>>>>>>
46979>>>>>>>        // Baxio.Baxio_Lixi_Yyyy
46979>>>>>>>
46979>>>>>>>        // Baxio.Baxio_Lixi_Mm
46979>>>>>>>
46979>>>>>>>        // Baxio.Baxio_Lixi_Dd
46979>>>>>>>
46979>>>>>>>        // Baxio.Baxio_Bmove_Laa
46979>>>>>>>
46979>>>>>>>        // Baxio.Baxio_Desm
46979>>>>>>>
46979>>>>>>>        // Baxio.Baxio_From
46979>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_From To (Baxio_Baxio_From_VT(Self))
46980>>>>>>>
46980>>>>>>>        // Baxio.Baxio_Topos
46980>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Topos To (Baxio_Baxio_Topos_VT1(Self))
46981>>>>>>>
46981>>>>>>>        //DDB-DefineFieldEnd
46981>>>>>>>
46981>>>>>>>        Set Main_File            To Baxio.File_Number
46982>>>>>>>        Set Cascade_Delete_State To FALSE
46983>>>>>>>
46983>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
46984>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
46985>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
46986>>>>>>>
46986>>>>>>>        // Child (Client) file structure................
46986>>>>>>>        Send Add_Client_File  Bmove.File_Number
46987>>>>>>>
46987>>>>>>>        // Parent (Server) file structure...............
46987>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
46988>>>>>>>
46988>>>>>>>        // External (System) file structure.............
46988>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
46989>>>>>>>
46989>>>>>>>        Define_Auto_Increment  Sysrecb.Baxio_Rec0  To Baxio.Baxio_Rec0
46992>>>>>>>
46992>>>>>>>        // Field-based properties.......................
46992>>>>>>>
46992>>>>>>>        // Baxio.Company_Code
46992>>>>>>>
46992>>>>>>>        // Baxio.Branch_Code
46992>>>>>>>
46992>>>>>>>        // Baxio.Year_Year
46992>>>>>>>
46992>>>>>>>        // Baxio.Baxiokat_Code
46992>>>>>>>
46992>>>>>>>        // Baxio.Baxio_Code
46992>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Code         To "‰à› ¡æª €¥ ¦š¨á­¦¬"
46993>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Code         To "‰à› ¡æª"
46994>>>>>>>        Set Field_Options          Field Baxio.Baxio_Code         To DD_AUTOFIND    DD_NOPUT
46995>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Code         To (sl037(Self))
46996>>>>>>>        Set Key_Field_State        Field Baxio.Baxio_Code         To TRUE
46997>>>>>>>
46997>>>>>>>        // Baxio.Baxio_Rec0
46997>>>>>>>        Set Field_Options          Field Baxio.Baxio_Rec0         To DD_AUTOFIND    DD_REQUIRED
46998>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Rec0         To (sl037(Self))
46999>>>>>>>        Set Key_Field_State        Field Baxio.Baxio_Rec0         To TRUE
47000>>>>>>>
47000>>>>>>>        // Baxio.Year_Rec0
47000>>>>>>>
47000>>>>>>>        // Baxio.Baxiokat_Rec0
47000>>>>>>>
47000>>>>>>>        // Baxio.Baxio_Status
47000>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Status       To "dbComboForm_EZ"
47001>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Status       To "‰˜«á©«˜©ž"
47002>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Status       To "‰˜«á©«˜©ž"
47003>>>>>>>        Set Field_Options  Field Baxio.Baxio_Status  To DD_DISPLAYONLY
47004>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Status       To (Baxio_Status_VT(Self))
47005>>>>>>>
47005>>>>>>>        // Baxio.Baxio_Place
47005>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Place        To "dbComboForm_EZ"
47006>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Place        To "„¬¨å©¡œ«˜ "
47007>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Place        To "„¬¨å©¡œ«˜ "
47008>>>>>>>        Set Field_Options          Field Baxio.Baxio_Place        To DD_DISPLAYONLY
47009>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Place        To (Baxio_Baxio_Place_VT(Self))
47010>>>>>>>
47010>>>>>>>        // Baxio.Baxio_File_In
47010>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_In      To (Bfile_VT(Self))
47011>>>>>>>
47011>>>>>>>        // Baxio.Baxio_Code_In
47011>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Code_In      To "˜¨œ¢ã­Ÿž €§æ"
47012>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Code_In      To "˜¨œ¢ã­Ÿž €§æ"
47013>>>>>>>        Set Field_Options          Field Baxio.Baxio_Code_In      To DD_DISPLAYONLY
47014>>>>>>>
47014>>>>>>>        // Baxio.Baxio_Epon_In
47014>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Epon_In      To "„§à¤¬£å˜"
47015>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Epon_In      To "„§à¤¬£å˜"
47016>>>>>>>        Set Field_Options          Field Baxio.Baxio_Epon_In      To DD_DISPLAYONLY
47017>>>>>>>
47017>>>>>>>        // Baxio.Baxio_Fpar_In
47017>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Fpar_In      To "˜¨/¡æ ˜¨˜¢˜™ãª"
47018>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Fpar_In      To "˜¨/¡æ ˜¨˜¢."
47019>>>>>>>        Set Field_Options          Field Baxio.Baxio_Fpar_In      To DD_DISPLAYONLY
47020>>>>>>>
47020>>>>>>>        // Baxio.Baxio_File_Out
47020>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_Out     To (Bfile_VT(Self))
47021>>>>>>>
47021>>>>>>>        // Baxio.Baxio_Code_Out
47021>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Code_Out     To "¨é«¦ª ˜¨˜¢ã§«žª"
47022>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Code_Out     To "¨é«¦ª ˜¨˜¢ã§«žª"
47023>>>>>>>        Set Field_Options          Field Baxio.Baxio_Code_Out     To DD_DISPLAYONLY
47024>>>>>>>
47024>>>>>>>        // Baxio.Baxio_Epon_Out
47024>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Epon_Out     To "„§à¤¬£å˜"
47025>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Epon_Out     To "„§à¤¬£å˜"
47026>>>>>>>        Set Field_Options          Field Baxio.Baxio_Epon_Out     To DD_DISPLAYONLY
47027>>>>>>>
47027>>>>>>>        // Baxio.Baxio_Fpar_Out
47027>>>>>>>        Set Field_Options          Field Baxio.Baxio_Fpar_Out     To DD_DISPLAYONLY
47028>>>>>>>
47028>>>>>>>        // Baxio.Baxio_Lfile
47028>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Lfile        To (Bfile_VT(Self))
47029>>>>>>>
47029>>>>>>>        // Baxio.Baxio_Lcode
47029>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Lcode        To "’œ¢œ¬«˜å¦ª ˜¨˜¢ã§«žª"
47030>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Lcode        To "’œ¢.˜¨˜¢ã§«žª"
47031>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lcode        To DD_DISPLAYONLY
47032>>>>>>>
47032>>>>>>>        // Baxio.Baxio_Lepon
47032>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lepon        To DD_DISPLAYONLY
47033>>>>>>>
47033>>>>>>>        // Baxio.Baxio_Lpar
47033>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Lpar         To "˜¨/¡æ ˜¨á›¦©žª"
47034>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Lpar         To "˜¨/¡æ ˜¨á›¦©žª"
47035>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lpar         To DD_DISPLAYONLY
47036>>>>>>>
47036>>>>>>>        // Baxio.Baxio_Bank00000
47036>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Bank00000    To "dbComboForm_EZ"
47037>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Bank00000    To (Baxio_Baxio_Bank_VT(Self))
47038>>>>>>>
47038>>>>>>>        // Baxio.Baxio_Hmniae
47038>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmniae       To "dbSpinForm_EZ"
47039>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmniae       To "†£/¤å˜ „¡›¦©žª"
47040>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmniae       To "†£/¤å˜ „¡›¦©žª"
47041>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniae       To (sl037(Self))
47042>>>>>>>
47042>>>>>>>        // Baxio.Baxio_Hmniap000
47042>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmniap000    To "dbSpinForm_EZ"
47043>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmniap000    To "†£/¤å˜ ˜¨˜¢˜™ãª"
47044>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmniap000    To "†£/¤å˜ ˜¨˜¢˜™ãª"
47045>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniap000    To (sl037(Self))
47046>>>>>>>
47046>>>>>>>        // Baxio.Baxio_Hmnial
47046>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmnial       To "dbSpinForm_EZ"
47047>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmnial       To "†£/¤å˜ Šã¥žª"
47048>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmnial       To "†£/¤å˜ Šã¥žª"
47049>>>>>>>        Set Field_Options          Field Baxio.Baxio_Hmnial       To DD_REQUIRED
47050>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmnial       To (sl037(Self))
47051>>>>>>>
47051>>>>>>>        // Baxio.Baxio_Ekdoths
47051>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Ekdoths      To "€¨® ¡æª „¡›æ«žª"
47052>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Ekdoths      To "€¨®.„¡›æ«žª"
47053>>>>>>>
47053>>>>>>>        // Baxio.Baxio_Ekdothse
47053>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Ekdothse     To "„§à¤¬£å˜ €¨® ¡¦ç „¡›æ«ž"
47054>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Ekdothse     To "„§à¤¬£å˜"
47055>>>>>>>
47055>>>>>>>        // Baxio.Baxio_Sediatagh
47055>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Sediatagh    To "‘œ ƒ ˜«˜šã"
47056>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Sediatagh    To "‘œ ƒ ˜«˜šã"
47057>>>>>>>
47057>>>>>>>        // Baxio.Baxio_Sdiataghe
47057>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Sdiataghe    To "„§à¤¬£å˜ €¨® ¡¦ç ƒ ¡˜ ¦ç®¦¬"
47058>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Sdiataghe    To "„§à¤¬£å˜"
47059>>>>>>>
47059>>>>>>>        // Baxio.Baxio_Banka
47059>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Banka        To "dbComboForm_EZ"
47060>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Banka        To "’¨á§œ˜"
47061>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Banka        To "’¨á§œ˜"
47062>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Banka        To (Baxio_Baxio_Banka_VT(Self))
47063>>>>>>>
47063>>>>>>>        // Baxio.Baxio_Opistho
47063>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Opistho      To "Š¦ §¦å Ž§ ©Ÿ¦š¨á­¦ "
47064>>>>>>>
47064>>>>>>>        // Baxio.Baxio_No
47064>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_No           To "€¨ Ÿ£æª"
47065>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_No           To "€¨ Ÿ£æª"
47066>>>>>>>
47066>>>>>>>        // Baxio.Baxio_V2
47066>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_V2           To "¦©æ"
47067>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_V2           To "¦©æ"
47068>>>>>>>        Set Field_Options          Field Baxio.Baxio_V2           To DD_REQUIRED
47069>>>>>>>
47069>>>>>>>        // Baxio.Baxio_V0
47069>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_V0           To "¦©æ ‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª"
47070>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_V0           To "¦©æ(‰¬¨. Œæ£.•¨.)"
47071>>>>>>>
47071>>>>>>>        // Baxio.Baxio_V00
47071>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_V00          To "¦©æ ƒœ¬«œ¨œç¦¤  Œæ£ ©£˜ •¨ã©œàª"
47072>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_V00          To "¦©æ(ƒœ¬«. Œæ£.•¨.)"
47073>>>>>>>
47073>>>>>>>        // Baxio.Baxio_Vr
47073>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Vr           To "¦©æ Œæ£ ©£˜ Reporting"
47074>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Vr           To "¦©æ( Œæ£.Rep.)"
47075>>>>>>>
47075>>>>>>>        // Baxio.Baxio_Rate0
47075>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Rate0        To "Rate 1"
47076>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Rate0        To "Rate 1"
47077>>>>>>>
47077>>>>>>>        // Baxio.Baxio_Rate00
47077>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Rate00       To "Rate 2"
47078>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Rate00       To "Rate 2"
47079>>>>>>>
47079>>>>>>>        // Baxio.Baxio_Rater
47079>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Rater        To "Rate 3"
47080>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Rater        To "Rate 3"
47081>>>>>>>
47081>>>>>>>        // Baxio.Baxio_C_Code2
47081>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_C_Code2      To "dbComboForm_EZ"
47082>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_C_Code2      To "Œæ£ ©£˜"
47083>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_C_Code2      To "Œæ£ ©£˜"
47084>>>>>>>        Set Field_Options          Field Baxio.Baxio_C_Code2      To DD_REQUIRED
47085>>>>>>>
47085>>>>>>>        // Baxio.Baxio_Lixi_Yyyy
47085>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Yyyy    To DD_DISPLAYONLY
47086>>>>>>>
47086>>>>>>>        // Baxio.Baxio_Lixi_Mm
47086>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Mm      To DD_DISPLAYONLY
47087>>>>>>>
47087>>>>>>>        // Baxio.Baxio_Lixi_Dd
47087>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Dd      To DD_DISPLAYONLY
47088>>>>>>>
47088>>>>>>>        // Baxio.Baxio_Bmove_Laa
47088>>>>>>>        Set Field_Options          Field Baxio.Baxio_Bmove_Laa    To DD_DISPLAYONLY
47089>>>>>>>
47089>>>>>>>    End_Procedure    // Define_Fields
47090>>>>>>>
47090>>>>>>>
47090>>>>>>>    Procedure Field_Defaults
47091>>>>>>>        Forward Send Field_Defaults
47093>>>>>>>        //DDB-Generated-Code-Location
47093>>>>>>>        //DDB-FieldDefaultStart
47093>>>>>>>        Set Field_Changed_Value   Field Baxio.Baxio_Status To 1
47094>>>>>>>        Set Field_Changed_Value   Field Baxio.Baxio_Place To 1
47095>>>>>>>        //DDB-FieldDefaultEnd
47095>>>>>>>    End_Procedure    // Field_Defaults
47096>>>>>>>
47096>>>>>>>End_Class    // Baxio_DataDictionary
47097>>>>>>>//DDB-Selection-pkg-Start
47097>>>>>>>
47097>>>>>>>Use SL037.SL         // SL037
INCLUDING FILE: SL037.SL
47097>>>>>>>>>//AB/ Project SL037:BAXIO
47097>>>>>>>>>//AB/ Object prj is a Lookup_Project
47097>>>>>>>>>//AB/     Set ProjectName to "SL037:BAXIO"
47097>>>>>>>>>//AB/     Set ProjectFileName to "SL037.SL"
47097>>>>>>>>>
47097>>>>>>>>>// Project Object Structure
47097>>>>>>>>>//   SL037 is a dbModalPanelSub
47097>>>>>>>>>//     Baxiokat_DD is a DataDictionary
47097>>>>>>>>>//     Baxio_DD is a DataDictionary
47097>>>>>>>>>//     oSelList is a dbListSub
47097>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
47097>>>>>>>>>//     cSyDateForm1 is a cSyDateForm
47097>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
47097>>>>>>>>>//     cSyDateForm2 is a cSyDateForm
47097>>>>>>>>>//     TextBoxSub4 is a TextBoxSub
47097>>>>>>>>>//     TextBoxSub5 is a TextBoxSub
47097>>>>>>>>>//     FormSub1 is a FormSub
47097>>>>>>>>>//     FormSub2 is a FormSub
47097>>>>>>>>>//     FormSub3 is a FormSub
47097>>>>>>>>>//     FormSub4 is a FormSub
47097>>>>>>>>>//     ButtonSub1 is a ButtonSub
47097>>>>>>>>>//     oOK_bn is a ButtonSub
47097>>>>>>>>>
47097>>>>>>>>>// Register all objects
47097>>>>>>>>>Register_Object Baxio_DD
47097>>>>>>>>>Register_Object Baxiokat_DD
47097>>>>>>>>>Register_Object ButtonSub1
47097>>>>>>>>>Register_Object cSyDateForm1
47097>>>>>>>>>Register_Object cSyDateForm2
47097>>>>>>>>>Register_Object FormSub1
47097>>>>>>>>>Register_Object FormSub2
47097>>>>>>>>>Register_Object FormSub3
47097>>>>>>>>>Register_Object FormSub4
47097>>>>>>>>>Register_Object oOK_bn
47097>>>>>>>>>Register_Object oSelList
47097>>>>>>>>>Register_Object SL037
47097>>>>>>>>>Register_Object TextBoxSub1
47097>>>>>>>>>Register_Object TextBoxSub2
47097>>>>>>>>>Register_Object TextBoxSub4
47097>>>>>>>>>Register_Object TextBoxSub5
47097>>>>>>>>>
47097>>>>>>>>>
47097>>>>>>>>>//AB-IgnoreStart
47097>>>>>>>>>
47097>>>>>>>>>Use DFAllEnt.pkg
47097>>>>>>>>>Use dbList.Sub
47097>>>>>>>>>Use Txtbox.Sub
47097>>>>>>>>>Use cSyDateForm.Pkg
47097>>>>>>>>>Use Form.Sub
47097>>>>>>>>>Use Button.Sub
47097>>>>>>>>>
47097>>>>>>>>>
47097>>>>>>>>>Use BAXIOKAT.DD
47097>>>>>>>>>Use BAXIO.DD
47097>>>>>>>>>
47097>>>>>>>>>//AB-IgnoreEnd
47097>>>>>>>>>
47097>>>>>>>>>Object SL037 is a dbModalPanelSub
47099>>>>>>>>>
47099>>>>>>>>>    //AB-StoreTopStart
47099>>>>>>>>>        
47099>>>>>>>>>    Property Integer piFragmaBaxiokatRec0 Public  0
47101>>>>>>>>>    Property Integer piFragmaBaxiokatCode Public  0
47103>>>>>>>>>    Property Integer piFragmaBaxioStatus  Public  0
47105>>>>>>>>>    Property Integer piFragmaBaxioPlace   Public  0
47107>>>>>>>>>    Property string  psfragmaclient       Public ''
47109>>>>>>>>>    Property String  psFragmaBaxioStatus  Public ''
47111>>>>>>>>>    Property String  psEkdoths            Public ''
47113>>>>>>>>>    Property String  psApodekths          Public ''
47115>>>>>>>>>    Property Date pdApo                   Public ''
47117>>>>>>>>>    Property Date pdEos                   Public ''
47119>>>>>>>>>    
47119>>>>>>>>>    //AB-StoreTopEnd
47119>>>>>>>>>
47119>>>>>>>>>    Set Label to "‰˜«á¢¦š¦ª €¥ ¦š¨á­à¤"
47120>>>>>>>>>    Set Size to 287 527
47121>>>>>>>>>    Set Location to 2 3
47122>>>>>>>>>    Set Exit_Application_Local_State to FALSE
47123>>>>>>>>>    Set Modal_State to FALSE
47124>>>>>>>>>
47124>>>>>>>>>    //AB-DDOStart
47124>>>>>>>>>
47124>>>>>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
47126>>>>>>>>>    End_Object    // Baxiokat_DD
47127>>>>>>>>>
47127>>>>>>>>>    Object Baxio_DD is a Baxio_DataDictionary
47129>>>>>>>>>        Set DDO_Server to (Baxiokat_DD(self))
47130>>>>>>>>>
47130>>>>>>>>>        //AB-StoreStart
47130>>>>>>>>>                        
47130>>>>>>>>>        Function fiIsOK Returns Integer
47132>>>>>>>>>            String lsBaxioStatus sclient
47133>>>>>>>>>            Get psFragmaBaxioStatus  to lsBaxioStatus
47134>>>>>>>>>            Get psfragmaclient       to sclient
47135>>>>>>>>>            If (Trim(sClient)='') Begin
47137>>>>>>>>>                If (lsBaxioStatus Contains Baxio.Baxio_Status) Function_Return 1
47140>>>>>>>>>            End
47140>>>>>>>>>>
47140>>>>>>>>>            Else Begin
47141>>>>>>>>>                If (baxio.baxio_desm Eq sClient And lsBaxioStatus Contains Baxio.Baxio_Status) Function_Return 1
47144>>>>>>>>>            End
47144>>>>>>>>>>
47144>>>>>>>>>            Function_Return 0
47145>>>>>>>>>        End_Function
47146>>>>>>>>>        
47146>>>>>>>>>        Procedure OnConstrain
47148>>>>>>>>>        
47148>>>>>>>>>            Integer liBaxiokatCode liBaxioStatus liBaxioPlace
47149>>>>>>>>>            string  sclient lsBaxioStatus sApodekths sEkdoths
47149>>>>>>>>>            Date    dApo dEos
47149>>>>>>>>>        
47149>>>>>>>>>            Forward Send OnConstrain
47151>>>>>>>>>        
47151>>>>>>>>>            Get piFragmaBaxiokatCode    to liBaxiokatCode
47152>>>>>>>>>            Get psFragmaBaxioStatus     to lsBaxioStatus
47153>>>>>>>>>            Get piFragmaBaxioPlace      to liBaxioPlace
47154>>>>>>>>>        
47154>>>>>>>>>            Get psApodekths             to sApodekths
47155>>>>>>>>>            Get psEkdoths               to sEkdoths
47156>>>>>>>>>            Get pdApo                   to dApo
47157>>>>>>>>>            Get pdEos                   to dEos
47158>>>>>>>>>        
47158>>>>>>>>>            If (liBaxioKatCode <> 0) Begin
47160>>>>>>>>>                Constrain Baxio.Baxiokat_Code eq liBaxiokatCode
47162>>>>>>>>>                If (liBaxioPlace  <> 0)  Constrain Baxio.Baxio_Place eq liBaxioPlace
47166>>>>>>>>>                If (lsBaxioStatus <> '') Constrain Baxio as (fiIsOK(Self)=1)
47169>>>>>>>>>            End
47169>>>>>>>>>>
47169>>>>>>>>>        
47169>>>>>>>>>            If (sApodekths  <>'') Constrain Baxio.Baxio_Code_Out    Eq sApodekths
47173>>>>>>>>>            If (sEkdoths    <>'') Constrain Baxio.Baxio_Code_In     Eq sEkdoths
47177>>>>>>>>>            If (dApo        <>'') Constrain Baxio.Baxio_HmniaL      Ge dApo
47181>>>>>>>>>            If (dEos        <>'') Constrain Baxio.Baxio_HmniaL      Le dEos
47185>>>>>>>>>        
47185>>>>>>>>>        End_Procedure // OnConstrain
47186>>>>>>>>>        
47186>>>>>>>>>        
47186>>>>>>>>>        
47186>>>>>>>>>        
47186>>>>>>>>>        
47186>>>>>>>>>        
47186>>>>>>>>>        
47186>>>>>>>>>        
47186>>>>>>>>>        
47186>>>>>>>>>        
47186>>>>>>>>>        
47186>>>>>>>>>        
47186>>>>>>>>>        
47186>>>>>>>>>        //AB-StoreEnd
47186>>>>>>>>>
47186>>>>>>>>>    End_Object    // Baxio_DD
47187>>>>>>>>>
47187>>>>>>>>>    Set Main_DD to (Baxio_DD(self))
47188>>>>>>>>>    Set Server to (Baxio_DD(self))
47189>>>>>>>>>
47189>>>>>>>>>    //AB-DDOEnd
47189>>>>>>>>>
47189>>>>>>>>>    Object oSelList is a dbListSub
47191>>>>>>>>>        Set Main_File to Baxio.File_Number
47192>>>>>>>>>        Set Size to 228 514
47193>>>>>>>>>        Set Location to 4 6
47194>>>>>>>>>        Set Auto_Index_State to FALSE
47195>>>>>>>>>
47195>>>>>>>>>        Begin_Row
47198>>>>>>>>>            Entry_Item Baxio.Baxio_code
47199>>>>>>>>>            Entry_Item Baxio.Baxio_epon_in
47200>>>>>>>>>            Entry_Item Baxio.Baxio_epon_out
47201>>>>>>>>>            Entry_Item Baxiokat.Baxiokat_descr
47202>>>>>>>>>            Entry_Item Baxio.Baxio_hmnial
47203>>>>>>>>>            Entry_Item Baxio.Baxio_v2
47204>>>>>>>>>            Entry_Item Baxio.Baxio_banka
47205>>>>>>>>>            Entry_Item (Export_Code_Description(Self,6,Baxio.Baxio_banka))
47206>>>>>>>>>            Entry_Item Baxio.Baxio_no
47207>>>>>>>>>        End_Row
47212>>>>>>>>>
47212>>>>>>>>>        Set Form_Width    item 0 to 41
47213>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
47214>>>>>>>>>        
47214>>>>>>>>>        Set Form_Width    item 1 to 98
47215>>>>>>>>>        Set Header_Label  item 1 to "„¡›æ«žª"
47216>>>>>>>>>        
47216>>>>>>>>>        Set Form_Width    item 2 to 94
47217>>>>>>>>>        Set Header_Label  item 2 to "€§¦›â¡«žª"
47218>>>>>>>>>        
47218>>>>>>>>>        Set Form_Width    item 3 to 75
47219>>>>>>>>>        Set Header_Label  item 3 to "œ¨ š¨˜­ã"
47220>>>>>>>>>        
47220>>>>>>>>>        Set Form_Width    item 4 to 47
47221>>>>>>>>>        Set Header_Label  item 4 to "Šã¥ž"
47222>>>>>>>>>        
47222>>>>>>>>>        Set Form_Width    item 5 to 48
47223>>>>>>>>>        Set Header_Label  item 5 to "¦©æ"
47224>>>>>>>>>        
47224>>>>>>>>>        Set Form_Width    item 6 to 12
47225>>>>>>>>>        Set Header_Label  item 6 to "‰à› ¡æª ’¨á§œ˜"
47226>>>>>>>>>        
47226>>>>>>>>>        Set Form_Width    item 7 to 42
47227>>>>>>>>>        Set Header_Label  item 7 to "’¨á§œ˜"
47228>>>>>>>>>        
47228>>>>>>>>>        Set Form_Width    item 8 to 53
47229>>>>>>>>>        Set Header_Label  item 8 to "€¨ Ÿ£æª"
47230>>>>>>>>>        
47230>>>>>>>>>
47230>>>>>>>>>        //AB-StoreStart
47230>>>>>>>>>        
47230>>>>>>>>>        Property Integer piStoreFragmaBaxiokatRec0 Public 0
47232>>>>>>>>>        Property Integer piStoreFragmaBaxiokatCode Public 0
47234>>>>>>>>>        Property Integer piStoreFragmaBaxioStatus  Public 0
47236>>>>>>>>>        Property Integer piStoreFragmaBaxioPlace   Public 0
47238>>>>>>>>>        Property String  psStoreFragmaBaxioStatus  Public ''
47240>>>>>>>>>        
47240>>>>>>>>>        Procedure Store_Defaults
47242>>>>>>>>>            Forward Send Store_Defaults
47244>>>>>>>>>            Set piStoreFragmaBaxiokatRec0 to (piFragmaBaxiokatRec0(Self))
47245>>>>>>>>>            Set piStoreFragmaBaxiokatCode to (piFragmaBaxiokatCode(Self))
47246>>>>>>>>>            Set piStoreFragmaBaxioStatus  to (piFragmaBaxioStatus(Self))
47247>>>>>>>>>            Set piStoreFragmaBaxioPlace   to (piFragmaBaxioPlace(Self))
47248>>>>>>>>>            Set psStoreFragmaBaxioStatus  to (psFragmaBaxioStatus(Self))
47249>>>>>>>>>        End_Procedure // Store_Defaults
47250>>>>>>>>>        
47250>>>>>>>>>        Procedure Restore_Defaults
47252>>>>>>>>>            Forward Send Restore_Defaults
47254>>>>>>>>>            Set piFragmaBaxiokatRec0 to (piStoreFragmaBaxiokatRec0(Self))
47255>>>>>>>>>            Set piFragmaBaxiokatCode to (piStoreFragmaBaxiokatCode(Self))
47256>>>>>>>>>            Set piFragmaBaxioStatus  to (piStoreFragmaBaxioStatus(Self))
47257>>>>>>>>>            Set piFragmaBaxioPlace   to (piStoreFragmaBaxioPlace(Self))
47258>>>>>>>>>            Set psFragmaBaxioStatus  to (psStoreFragmaBaxioStatus(Self))
47259>>>>>>>>>        End_Procedure // Restore_Defaults
47260>>>>>>>>>        
47260>>>>>>>>>        Procedure Activating
47262>>>>>>>>>            Forward Send Activating
47264>>>>>>>>>            Set Auto_Index_State        to True
47265>>>>>>>>>            Send Rebuild_Constraints    to Baxio_DD
47266>>>>>>>>>        End_Procedure
47267>>>>>>>>>        
47267>>>>>>>>>        Procedure End_Construct_Object
47269>>>>>>>>>            Integer iDecs
47270>>>>>>>>>            Forward Send End_Construct_Object
47272>>>>>>>>>            Get fiDekadika_Nomismatos SysCurXr.C_Code0  to    iDecs
47273>>>>>>>>>            Set Points Item 5 to iDecs
47274>>>>>>>>>            Set Numeric_Mask Item 5 to 10 iDecs ' ,*'
47275>>>>>>>>>        End_Procedure
47276>>>>>>>>>        
47276>>>>>>>>>        
47276>>>>>>>>>        
47276>>>>>>>>>        
47276>>>>>>>>>        
47276>>>>>>>>>        
47276>>>>>>>>>        
47276>>>>>>>>>        
47276>>>>>>>>>        
47276>>>>>>>>>        
47276>>>>>>>>>        //AB-StoreEnd
47276>>>>>>>>>
47276>>>>>>>>>    End_Object    // oSelList
47277>>>>>>>>>
47277>>>>>>>>>    Object TextBoxSub1 is a TextBoxSub
47279>>>>>>>>>        Set Label to "Šã¥ž ˜§¦"
47280>>>>>>>>>        Set Location to 241 7
47281>>>>>>>>>        Set Size to 10 35
47282>>>>>>>>>    End_Object    // TextBoxSub1
47283>>>>>>>>>
47283>>>>>>>>>    Object cSyDateForm1 is a cSyDateForm
47285>>>>>>>>>        Set Size to 13 66
47286>>>>>>>>>        Set Location to 240 45
47287>>>>>>>>>        Set Label_Col_Offset to 2
47288>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
47289>>>>>>>>>        Set Form_Mask Item 0 to "d/M/yyyy"
47290>>>>>>>>>
47290>>>>>>>>>        //AB-StoreStart
47290>>>>>>>>>                        
47290>>>>>>>>>        Procedure Key Integer iKey
47292>>>>>>>>>            Integer iRetVal
47293>>>>>>>>>            Forward Send Key iKey
47295>>>>>>>>>            If (iKey=277) Begin
47297>>>>>>>>>                Set Value Item 0 to ''
47298>>>>>>>>>                //Send KeyAction to ButtonSub1
47298>>>>>>>>>            End
47298>>>>>>>>>>
47298>>>>>>>>>        End_Procedure
47299>>>>>>>>>        
47299>>>>>>>>>        
47299>>>>>>>>>        //AB-StoreEnd
47299>>>>>>>>>
47299>>>>>>>>>    End_Object    // cSyDateForm1
47300>>>>>>>>>
47300>>>>>>>>>    Object TextBoxSub2 is a TextBoxSub
47302>>>>>>>>>        Set Label to "Šã¥ž œàª"
47303>>>>>>>>>        Set Location to 258 7
47304>>>>>>>>>        Set Size to 10 35
47305>>>>>>>>>    End_Object    // TextBoxSub2
47306>>>>>>>>>
47306>>>>>>>>>    Object cSyDateForm2 is a cSyDateForm
47308>>>>>>>>>        Set Size to 13 66
47309>>>>>>>>>        Set Location to 256 45
47310>>>>>>>>>        Set Label_Col_Offset to 2
47311>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
47312>>>>>>>>>        Set Form_Mask Item 0 to "d/M/yyyy"
47313>>>>>>>>>
47313>>>>>>>>>        //AB-StoreStart
47313>>>>>>>>>                        
47313>>>>>>>>>        Procedure Key Integer iKey
47315>>>>>>>>>            Integer iRetVal
47316>>>>>>>>>            Forward Send Key iKey
47318>>>>>>>>>            If (iKey=277) Begin
47320>>>>>>>>>                Set Value Item 0 to ''
47321>>>>>>>>>                //Send KeyAction to ButtonSub1
47321>>>>>>>>>            End
47321>>>>>>>>>>
47321>>>>>>>>>        End_Procedure
47322>>>>>>>>>        
47322>>>>>>>>>        
47322>>>>>>>>>        //AB-StoreEnd
47322>>>>>>>>>
47322>>>>>>>>>    End_Object    // cSyDateForm2
47323>>>>>>>>>
47323>>>>>>>>>    Object TextBoxSub4 is a TextBoxSub
47325>>>>>>>>>        Set Label to "„¡›æ«žª"
47326>>>>>>>>>        Set Location to 241 118
47327>>>>>>>>>        Set Size to 10 33
47328>>>>>>>>>    End_Object    // TextBoxSub4
47329>>>>>>>>>
47329>>>>>>>>>    Object TextBoxSub5 is a TextBoxSub
47331>>>>>>>>>        Set Label to "€§¦›â¡«žª"
47332>>>>>>>>>        Set Location to 258 118
47333>>>>>>>>>        Set Size to 10 39
47334>>>>>>>>>    End_Object    // TextBoxSub5
47335>>>>>>>>>
47335>>>>>>>>>    Object FormSub1 is a FormSub
47337>>>>>>>>>        Set Size to 13 77
47338>>>>>>>>>        Set Location to 240 159
47339>>>>>>>>>        Set Label_Col_Offset to 2
47340>>>>>>>>>        Set Prompt_Button_Mode to pb_PromptOn
47341>>>>>>>>>
47341>>>>>>>>>        //AB-StoreStart
47341>>>>>>>>>                        
47341>>>>>>>>>        Set Prompt_Object to (sl100(Self))
47342>>>>>>>>>        
47342>>>>>>>>>        Procedure OnChange
47344>>>>>>>>>            String s1
47345>>>>>>>>>            Get Value Item 0 to s1
47346>>>>>>>>>            Set Value Of FormSub2 Item 0 to (fsClient(Self,s1))
47347>>>>>>>>>            Set psEkdoths to s1
47348>>>>>>>>>        End_Procedure
47349>>>>>>>>>        
47349>>>>>>>>>        
47349>>>>>>>>>        
47349>>>>>>>>>        
47349>>>>>>>>>        
47349>>>>>>>>>        
47349>>>>>>>>>        
47349>>>>>>>>>        //AB-StoreEnd
47349>>>>>>>>>
47349>>>>>>>>>    End_Object    // FormSub1
47350>>>>>>>>>
47350>>>>>>>>>    Object FormSub2 is a FormSub
47352>>>>>>>>>        Set Size to 13 187
47353>>>>>>>>>        Set Location to 240 240
47354>>>>>>>>>        Set Color to clBtnFace
47355>>>>>>>>>        Set Label_Col_Offset to 2
47356>>>>>>>>>        Set Enabled_State to FALSE
47357>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
47358>>>>>>>>>        Set Shadow_State Item 0 to TRUE
47359>>>>>>>>>    End_Object    // FormSub2
47360>>>>>>>>>
47360>>>>>>>>>    Object FormSub3 is a FormSub
47362>>>>>>>>>        Set Size to 13 77
47363>>>>>>>>>        Set Location to 256 159
47364>>>>>>>>>        Set Label_Col_Offset to 2
47365>>>>>>>>>        Set Prompt_Button_Mode to pb_PromptOn
47366>>>>>>>>>
47366>>>>>>>>>        //AB-StoreStart
47366>>>>>>>>>                        
47366>>>>>>>>>        Set Prompt_Object to (sl100(Self))
47367>>>>>>>>>        
47367>>>>>>>>>        Procedure OnChange
47369>>>>>>>>>            String s1
47370>>>>>>>>>            Get Value Item 0 to s1
47371>>>>>>>>>            Set Value Of FormSub4 Item 0 to (fsClient(Self,s1))
47372>>>>>>>>>            Set psApodekths to s1
47373>>>>>>>>>        End_Procedure
47374>>>>>>>>>        
47374>>>>>>>>>        
47374>>>>>>>>>        
47374>>>>>>>>>        
47374>>>>>>>>>        
47374>>>>>>>>>        
47374>>>>>>>>>        
47374>>>>>>>>>        //AB-StoreEnd
47374>>>>>>>>>
47374>>>>>>>>>    End_Object    // FormSub3
47375>>>>>>>>>
47375>>>>>>>>>    Object FormSub4 is a FormSub
47377>>>>>>>>>        Set Size to 13 187
47378>>>>>>>>>        Set Location to 256 240
47379>>>>>>>>>        Set Color to clBtnFace
47380>>>>>>>>>        Set Label_Col_Offset to 2
47381>>>>>>>>>        Set Enabled_State to FALSE
47382>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
47383>>>>>>>>>        Set Shadow_State Item 0 to TRUE
47384>>>>>>>>>    End_Object    // FormSub4
47385>>>>>>>>>
47385>>>>>>>>>    Object ButtonSub1 is a ButtonSub
47387>>>>>>>>>        Set Label to "œ¨ æ¨ ©œ"
47388>>>>>>>>>        Set Size to 14 43
47389>>>>>>>>>        Set Location to 256 430
47390>>>>>>>>>
47390>>>>>>>>>        //AB-StoreStart
47390>>>>>>>>>                        
47390>>>>>>>>>        Procedure OnClick
47392>>>>>>>>>            Date dApo dEos
47393>>>>>>>>>            Get Value Of cSyDateForm1 Item 0 to dApo
47394>>>>>>>>>            Get Value Of cSyDateForm2 Item 0 to dEos
47395>>>>>>>>>            Set pdApo to dApo
47396>>>>>>>>>            Set pdEos to dEos
47397>>>>>>>>>            Send Rebuild_Constraints to Baxio_DD
47398>>>>>>>>>            Send Beginning_Of_Data to oSelList True
47399>>>>>>>>>        End_Procedure // OnClick
47400>>>>>>>>>        
47400>>>>>>>>>        
47400>>>>>>>>>        
47400>>>>>>>>>        
47400>>>>>>>>>        
47400>>>>>>>>>        
47400>>>>>>>>>        
47400>>>>>>>>>        
47400>>>>>>>>>        
47400>>>>>>>>>        
47400>>>>>>>>>        
47400>>>>>>>>>        
47400>>>>>>>>>        
47400>>>>>>>>>        //AB-StoreEnd
47400>>>>>>>>>
47400>>>>>>>>>    End_Object    // ButtonSub1
47401>>>>>>>>>
47401>>>>>>>>>    Object oOK_bn is a ButtonSub
47403>>>>>>>>>        Set Label to "&„§ ¢¦šã"
47404>>>>>>>>>        Set Size to 14 43
47405>>>>>>>>>        Set Location to 256 478
47406>>>>>>>>>
47406>>>>>>>>>        //AB-StoreStart
47406>>>>>>>>>        Procedure OnClick
47408>>>>>>>>>            Send OK To oSelList
47409>>>>>>>>>        End_Procedure
47410>>>>>>>>>        //AB-StoreEnd
47410>>>>>>>>>
47410>>>>>>>>>    End_Object    // oOK_bn
47411>>>>>>>>>
47411>>>>>>>>>
47411>>>>>>>>>    //AB-StoreStart
47411>>>>>>>>>        
47411>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
47412>>>>>>>>>    
47412>>>>>>>>>    Procedure Request_Cancel
47414>>>>>>>>>        Set Value Of cSyDateForm1 Item 0 to ''
47415>>>>>>>>>        Set Value Of cSyDateForm2 Item 0 to ''
47416>>>>>>>>>        Set Value Of FormSub1     Item 0 to ''
47417>>>>>>>>>        Set Value Of FormSub2     Item 0 to ''
47418>>>>>>>>>        Forward Send Request_Cancel
47420>>>>>>>>>    End_Procedure
47421>>>>>>>>>    
47421>>>>>>>>>    
47421>>>>>>>>>    
47421>>>>>>>>>    
47421>>>>>>>>>    
47421>>>>>>>>>    //AB-StoreEnd
47421>>>>>>>>>
47421>>>>>>>>>End_Object    // SL037
47422>>>>>>>>>
47422>>>>>>>>>//AB/ End_Object    // prj
47422>>>>>>>Use slnomism.sl      // slNomism
47422>>>>>>>
47422>>>>>>>//DDB-Selection-pkg-End
47422>>>>>>>//DDB-FileEnd
47422>>>>>    Use BMOVE.DD
INCLUDING FILE: BMOVE.DD
47422>>>>>>>//DDB-FileStart
47422>>>>>>>//DDB-HeaderStart
47422>>>>>>>
47422>>>>>>>// File Name : BMOVE.DD
47422>>>>>>>// Class Name: Bmove_DataDictionary
47422>>>>>>>// Revision  : 47
47422>>>>>>>// Version   : 2
47422>>>>>>>
47422>>>>>>>Use  Windows           // Basic Definitions
47422>>>>>>>Use  DataDict          // DataDictionary Class Definition
47422>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
47422>>>>>>>
47422>>>>>>>Open Bmove
47424>>>>>>>Open Barticl
47426>>>>>>>Open Baxio
47428>>>>>>>Open Sysrecb
47430>>>>>>>Open Bkinkat
47432>>>>>>>Open Bsum
47434>>>>>>>
47434>>>>>>>//DDB-HeaderEnd
47434>>>>>>>
47434>>>>>>>      //§ Ÿ˜¤¦å ©¬¤›¬˜©£¦å « £é¤ «à¤ bkinkat.baxio_stat_from + bkinkat.baxio_stat_to
47434>>>>>>>      //  ˜§¦          ©œ
47434>>>>>>>      //    0           0    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
47434>>>>>>>      //    0           1    â ©˜šàšã ©«¦ ®˜¨«¦­¬¢á¡ ¦ (create a new baxio (33.90))
47434>>>>>>>      //    0           2    â¥˜šàšã ˜§¦ ®˜¨«¦­¬¢á¡ ¦  (create a new baxio (53.90))
47434>>>>>>>
47434>>>>>>>      //    1           0    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
47434>>>>>>>      //    1           1    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
47434>>>>>>>      //    1           2    â¥˜šàšã ˜§¦ ®˜¨«¦­¬¢á¡ ¦
47434>>>>>>>
47434>>>>>>>      //    2           0    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
47434>>>>>>>      //    2           1    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
47434>>>>>>>      //    2           2    £œ«˜™å™˜©ž §® ˜§¦ «¨á§œ˜ ©œ «¨á§œ˜
47434>>>>>>>
47434>>>>>>>
47434>>>>>>>//Register_Object SL056 //¢å©«˜ gplan
47434>>>>>>>//Register_Object SL102 //¢å©«˜ customer
47434>>>>>>>//gister_Object SL056   //¢å©«˜ vendor
47434>>>>>>>
47434>>>>>>>Open SysCurXr
47436>>>>>>>Open Baxiokat
47438>>>>>>>Open Btypkin
47440>>>>>>>Open Bkinkat
47442>>>>>>>Open Baxio
47444>>>>>>>
47444>>>>>>>//Use i:\homewin.dev\easyware.vis\gl\appsrc\doGlMntn.Bp //œ¤ž£â¨à©ž šœ¤ ¡ãª ¢¦š ©« ¡ãª
47444>>>>>>>//jsjsjsjs 24/01/2001 Use                                       doGlMntn.Bp //œ¤ž£â¨à©ž šœ¤ ¡ãª ¢¦š ©« ¡ãª
47444>>>>>>>
47444>>>>>>>//Use                                doCUMntn.Bp //œ¤ž£â¨à©ž §œ¢˜«é¤
47444>>>>>>>//Use                                doVEMntn.Bp //œ¤ž£â¨à©ž §¨¦£žŸœ¬«é¤
47444>>>>>>>
47444>>>>>>>Class Bmove_DataDictionary  is a DataDictionary_Sec
47445>>>>>>>
47445>>>>>>>      Procedure Construct_Object
47446>>>>>>>                Forward Send Construct_Object
47448>>>>>>>
47448>>>>>>>                Property Integer piCan_Create_Baxio (FALSE)
47449>>>>>>>
47449>>>>>>>                //object id «é¤ ddo servers š ˜ «á barticl+bmove+baxio+baxiokat
47449>>>>>>>                //©œ«á¨¦¤«˜  ˜§¦ «ž¤ end_construct
47449>>>>>>>                //®¨ž© £œç¦¬¤ ©«ž¤ private.exit_btypkin_code
47449>>>>>>>                //š ˜ ¤˜ ©œ«á¨¦¬¤ «¦ visual interface
47449>>>>>>>                Property Integer piBarticl_dd        0
47450>>>>>>>                Property Integer piBaxio_dd          0
47451>>>>>>>                Property Integer piBtypkin_dd        0
47452>>>>>>>                Property Integer piBaxiokat_dd       0
47453>>>>>>>                Property Integer piBaxio_Status_From 0
47454>>>>>>>                Property Integer piBaxio_Status_To   0
47455>>>>>>>
47455>>>>>>>                Property Integer piCreated_Bmove  0 //©œ«á¨œ«˜  ©«ž¤ creating,
47456>>>>>>>                                                    //®¨ž© £¦§¦ œå«˜  ©«ž¤ update+validate_save ¡˜ 
47456>>>>>>>                                                    //£ž›œ¤åœ«˜  ©«ž¤ request_save & delete «¦¬ bmove
47456>>>>>>>
47456>>>>>>>                Property Integer piB_Baxio_Status  0
47457>>>>>>>                Property Integer piA_Baxio_Status  0
47458>>>>>>>
47458>>>>>>>                //19 §˜¢˜ âª « £âª
47458>>>>>>>                Property  Integer piB_Garticl_Rec0           0
47459>>>>>>>                Property  Integer piB_Gtypkin_Rec0           0
47460>>>>>>>                Property  Date    pdB_Garticl_Hmnia          0
47461>>>>>>>                Property  Integer piB_Garticl_No             0
47462>>>>>>>                Property  String  psB_Garticl_C_Code2        0
47463>>>>>>>                Property  Number  pnB_Garticl_Rate0          0
47464>>>>>>>                Property  Number  pnB_Garticl_Rate00         0
47465>>>>>>>                Property  Number  pnB_Garticl_RateR          0
47466>>>>>>>                Property  String  psB_Garticl_Aitiol         0
47467>>>>>>>
47467>>>>>>>                Property  Integer piB_Gmove_Master_Rec0      0
47468>>>>>>>                Property  Integer piB_Gplan_Master_Rec0      0
47469>>>>>>>                Property  Number  pnB_Gmove_Master_X2        0
47470>>>>>>>                Property  Number  pnB_Gmove_Master_P2        0
47471>>>>>>>                Property  String  psB_Gmove_Master_Aitiol    0
47472>>>>>>>
47472>>>>>>>                Property  Integer piB_Gmove_Slave_Rec0       0
47473>>>>>>>                Property  Integer piB_Gplan_Slave_Rec0       0
47474>>>>>>>                Property  Number  pnB_Gmove_Slave_X2         0
47475>>>>>>>                Property  Number  pnB_Gmove_Slave_P2         0
47476>>>>>>>                Property  String  psB_Gmove_Slave_Aitiol     0
47477>>>>>>>
47477>>>>>>>                //19 ¤âœª « £âª
47477>>>>>>>                Property  Integer piA_Garticl_Rec0           0
47478>>>>>>>                Property  Integer piA_Gtypkin_Rec0           0
47479>>>>>>>                Property  Date    pdA_Garticl_Hmnia          0
47480>>>>>>>                Property  Integer piA_Garticl_No             0
47481>>>>>>>                Property  String  psA_Garticl_C_Code2        0
47482>>>>>>>                Property  Number  pnA_Garticl_Rate0          0
47483>>>>>>>                Property  Number  pnA_Garticl_Rate00         0
47484>>>>>>>                Property  Number  pnA_Garticl_RateR          0
47485>>>>>>>                Property  String  psA_Garticl_Aitiol         0
47486>>>>>>>
47486>>>>>>>                Property  Integer piA_Gmove_Master_Rec0      0
47487>>>>>>>                Property  Integer piA_Gplan_Master_Rec0      0
47488>>>>>>>                Property  Number  pnA_Gmove_Master_X2        0
47489>>>>>>>                Property  Number  pnA_Gmove_Master_P2        0
47490>>>>>>>                Property  String  psA_Gmove_Master_Aitiol    0
47491>>>>>>>
47491>>>>>>>                Property  Integer piA_Gmove_Slave_Rec0       0
47492>>>>>>>                Property  Integer piA_Gplan_Slave_Rec0       0
47493>>>>>>>                Property  Number  pnA_Gmove_Slave_X2         0
47494>>>>>>>                Property  Number  pnA_Gmove_Slave_P2         0
47495>>>>>>>                Property  String  psA_Gmove_Slave_Aitiol     0
47496>>>>>>>
47496>>>>>>>                Property  Integer piDo_GL_Maintainance       0 //object id «žª business process
47497>>>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «ã¤ šœ¤ ¡ã ¢¦š ©« ¡ã
47497>>>>>>>                Property  Integer piDo_CUSTOMER_Maintainance 0 //object id «žª business process
47498>>>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §œ¢á«œª
47498>>>>>>>                Property  Integer piDo_VENDOR_Maintainance   0 //object id «žª business process
47499>>>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §¨¦£žŸœ¬«âª
47499>>>>>>>
47499>>>>>>>                //3 properties š ˜ «ž¤ feedback œ¤ž£â¨à©ž ˜§¦ «ž¤ š¢
47499>>>>>>>                Property Integer  piF_Garticl_Rec0           0
47500>>>>>>>                Property Integer  piF_Gmove_Master_Rec0      0
47501>>>>>>>                Property Integer  piF_Gmove_Slave_Rec0       0
47502>>>>>>>
47502>>>>>>>                Property Integer  piUpdate                   0
47503>>>>>>>                Property Integer  piBackout                  0
47504>>>>>>>
47504>>>>>>>                //properties š ˜ «ž¤ procedural œ¤ž£â¨à©ž «¦¬ bsum
47504>>>>>>>                Property String   psB_Barticl_Recr           ''
47505>>>>>>>                Property String   psB_Baxiokat_Recr          ''
47506>>>>>>>                Property Number   pnB_Baxio_V2               0
47507>>>>>>>                Property Number   pnB_Baxio_V0               0
47508>>>>>>>                Property Number   pnB_Baxio_V00              0
47509>>>>>>>                Property Number   pnB_Baxio_VR               0
47510>>>>>>>
47510>>>>>>>                Property String   psA_Barticl_Recr           ''
47511>>>>>>>                Property String   psA_Baxiokat_Recr          ''
47512>>>>>>>                Property Number   pnA_Baxio_V2               0
47513>>>>>>>                Property Number   pnA_Baxio_V0               0
47514>>>>>>>                Property Number   pnA_Baxio_V00              0
47515>>>>>>>                Property Number   pnA_Baxio_VR               0
47516>>>>>>>
47516>>>>>>>                //booleans §¦¬ ›ž¢é¤¦¬¤ «˜ operations §¦¬ Ÿ˜ šå¤¦¬¤ ©«ž¤ š¢
47516>>>>>>>                Property Integer  piGarticl_Delete          0 //©œ«á¨œ«˜  ©«ž¤ backout
47517>>>>>>>                Property Integer  piGarticl_Edit            0 //˜¤«åŸœ«¦ «¦¬ create (update)
47518>>>>>>>                Property Integer  piGarticl_Create          0 //©œ«á¨œ«˜  ©«ž¤ update
47519>>>>>>>
47519>>>>>>>                Property Integer  piMaster_Gmove_Delete     0 //©œ«á¨œ«˜  ©«ž¤ backout
47520>>>>>>>                Property Integer  piMaster_Gmove_Edit       0 //˜¤«åŸœ«¦ «¦¬ create (update)
47521>>>>>>>                Property Integer  piMaster_Gmove_Create     0 //©œ«á¨œ«˜  ©«ž¤ private.creating_barticl
47522>>>>>>>
47522>>>>>>>                Property Integer  piSlave_Gmove_Delete      0 //©œ«á¨¦¤«˜  ©«ž¤ update_bsum
47523>>>>>>>                Property Integer  piSlave_Gmove_Edit        0 //©œ«á¨¦¤«˜  ©«ž¤ update_bsum
47524>>>>>>>                Property Integer  piSlave_Gmove_Create      0 //©œ«á¨¦¤«˜  ©«ž¤ update_bsum
47525>>>>>>>      End_Procedure   //construct_object
47526>>>>>>>
47526>>>>>>>
47526>>>>>>>
47526>>>>>>>      //****************************************************************************************
47526>>>>>>>      //**************P R O C E D U R A L    „ Œ † ‹„  — ‘ †    B S U M************************
47526>>>>>>>      //****************************************************************************************
47526>>>>>>>
47526>>>>>>>
47526>>>>>>>      //¡˜¢œå«˜  ˜§æ save+delete_main_file, «˜ œ£§¢œ¡æ£œ¤˜ ˜¨®œå˜ œå¤˜  locked
47526>>>>>>>      //¡˜  transaction is enabled !
47526>>>>>>>      //œ§å©žª â®à current record ©œ æ¢˜ «˜ parents.
47526>>>>>>>      //¡˜¢œå «ž¤ private.update_bsum
47526>>>>>>>      //œ§ ©«¨â­œ  «˜ œ¥ãª ¢áŸž:6001:˜¡˜«á¢¢ž¢¦ §¨æ©ž£¦ (¢áŸ¦ª ¡é› ¡˜ª)
47526>>>>>>>      //                        6002:ƒâ¤ â«¨œ¥œ ¦ç«œ update ¦ç«œ backout !
47526>>>>>>>      //œ§å©žª ˜§¦ ¢áŸ¦ª «¦¬ ¡é› ¡˜, £§¦¨œå ¤˜ ›é©œ  ¡˜  Error 10001 "Wrong Num Arguments!\n\nPlease Call Solution!"
47526>>>>>>>
47526>>>>>>>      //¡˜¢œå «ž¤ private.update_bsum 1 ­¦¨á š ˜ backout (˜­˜å¨œ©ž §˜¢˜ é¤ « £é¤) ¡˜ 
47526>>>>>>>      //                              1 ­¦¨á š ˜ update  (§¨æ©Ÿœ©ž ¤âà¤ « £é¤)
47526>>>>>>>      //œ¢âš®¦¤«˜  æ¢œª ¦  §˜¨á£œ«¨¦  before+after œá¤ œå¤˜  å©œª,
47526>>>>>>>      //¦§æ«œ ›â¤ œ¤ž£œ¨é¤à    ‰ € ‡ Ž Š Ž “    «¦ bsum (§® ¡á¤à £æ¤¦¤ ˜¢¢˜šã ˜ « ¦¢¦šå˜ª)
47526>>>>>>>      Procedure private.Trexe Returns Integer
47527>>>>>>>                Integer liBackout liUpdate
47528>>>>>>>
47528>>>>>>>                String  lsB_Barticl_Recr lsB_Baxiokat_Recr
47528>>>>>>>                Number  lnB_Baxio_V2
47528>>>>>>>                Number  lnB_Baxio_V0
47528>>>>>>>                Number  lnB_Baxio_V00
47528>>>>>>>                Number  lnB_Baxio_VR
47528>>>>>>>
47528>>>>>>>                String  lsA_Barticl_Recr lsA_Baxiokat_Recr
47528>>>>>>>                Number  lnA_Baxio_V2
47528>>>>>>>                Number  lnA_Baxio_V0
47528>>>>>>>                Number  lnA_Baxio_V00
47528>>>>>>>                Number  lnA_Baxio_VR
47528>>>>>>>
47528>>>>>>>                //˜¤áš¤à©ž ¡˜«á©«˜©žª «¦¬ ddo
47528>>>>>>>                Get piBackout to liBackout
47529>>>>>>>                Get piUpdate  to liUpdate
47530>>>>>>>
47530>>>>>>>                //š ˜ ¢æš¦¬ª ˜©­˜¢œå˜ª, â¢œš®¦ª backout & update
47530>>>>>>>                If (;                     (liBAckout = 0) and;                     (liUpdate  = 0);                   ) Begin
47532>>>>>>>                      Send Operation_Not_Allowed 6002 //"ƒâ¤ â«¨œ¥œ ¦ç«œ update ¦ç«œ backout !"
47533>>>>>>>                      //Procedure_Return    //› ˜¡¦§ã «¦¬ transaction! (£á¢¢¦¤ «œ¢œåàª ˜§åŸ˜¤¦, but who knows!
47533>>>>>>>                     End
47533>>>>>>>>
47533>>>>>>>
47533>>>>>>>                //˜¤áš¤à©ž §˜¢˜ é¤ « £é¤
47533>>>>>>>                Get psB_Barticl_Recr  to lsB_Barticl_Recr
47534>>>>>>>                Get psB_Baxiokat_Recr to lsB_Baxiokat_Recr
47535>>>>>>>                Get pnB_Baxio_V2      to lnB_Baxio_V2
47536>>>>>>>                Get pnB_Baxio_V0      to lnB_Baxio_V0
47537>>>>>>>                Get pnB_Baxio_V00     to lnB_Baxio_V00
47538>>>>>>>                Get pnB_Baxio_VR      to lnB_Baxio_VR
47539>>>>>>>
47539>>>>>>>                //˜¤áš¤à©ž ¤âà¤ « £é¤
47539>>>>>>>                Get psA_Barticl_Recr  to lsA_Barticl_Recr
47540>>>>>>>                Get psA_Baxiokat_Recr to lsA_Baxiokat_Recr
47541>>>>>>>                Get pnA_Baxio_V2      to lnA_Baxio_V2
47542>>>>>>>                Get pnA_Baxio_V0      to lnA_Baxio_V0
47543>>>>>>>                Get pnA_Baxio_V00     to lnA_Baxio_V00
47544>>>>>>>                Get pnA_Baxio_VR      to lnA_Baxio_VR
47545>>>>>>>
47545>>>>>>>                //œá¤ æ¢œª ¦  §˜¨á£œ«¨¦  before+after œå¤˜  å©œª,
47545>>>>>>>                //«æ«œ ›â¤ £§˜å¤à ¡˜Ÿæ¢¦¬ ©«ž¤ œ¤ž£â¨à©ž  ©¦¬šåà¤,
47545>>>>>>>                //˜¢¢á ­œçšà ...«¨â®¦¤«˜ª!
47545>>>>>>>                //sosos £ã§àª §¨â§œ  ¤˜ œ¢œš¥à gtypkin + gplan slave master ?
47545>>>>>>>                If (;                     (lsB_Barticl_Recr  =lsA_Barticl_Recr ) and;                     (lsB_Baxiokat_Recr =lsA_Baxiokat_Recr) and;                     (lnB_Baxio_V2      =lnA_Baxio_V2)      and;                     (lnB_Baxio_V0      =lnA_Baxio_V0)      and;                     (lnB_Baxio_V00     =lnA_Baxio_V00)     and;                     (lnB_Baxio_VR      =lnA_Baxio_VR)         ;                    ) Begin
47547>>>>>>>                       Procedure_Return
47548>>>>>>>                      End
47548>>>>>>>>
47548>>>>>>>
47548>>>>>>>                //˜­˜å¨œ©ž §˜¢˜ é¤ « £é¤
47548>>>>>>>                If (liBackout = 1);                Begin
47550>>>>>>>                     Send private.Update_Bsum lsB_Barticl_Recr;                                              lsB_Baxiokat_Recr;                                              lnB_Baxio_V2;                                              lnB_Baxio_V0;                                              lnB_Baxio_V00;                                              lnB_Baxio_VR;                                              (-1)
47551>>>>>>>                End //if (libackout = 1)
47551>>>>>>>>
47551>>>>>>>
47551>>>>>>>                //§¨æ©Ÿœ©ž ¤âà¤ « £é¤
47551>>>>>>>                If (liUpdate = 1);                Begin
47553>>>>>>>                     Send private.Update_Bsum lsA_Barticl_Recr;                                              lsA_Baxiokat_Recr;                                              lnA_Baxio_V2;                                              lnA_Baxio_V0;                                              lnA_Baxio_V00;                                              lnA_Baxio_VR;                                              1
47554>>>>>>>                End //if (liupdate = 1)
47554>>>>>>>>
47554>>>>>>>      End_Procedure //private.trexe
47555>>>>>>>
47555>>>>>>>
47555>>>>>>>      //¡˜¢œå«˜  ˜§æ «ž¤ prepare_to_update_bsum
47555>>>>>>>      //¡˜Ÿ¦¨åœ  «¦ slave operation
47555>>>>>>>      Procedure private.Update_Bsum String lsBarticl_Recr;                                    String lsBaxiokat_Recr;                                    Number  lnV2;                                    Number  lnV0;                                    Number  lnV00;                                    Number  lnVR;                                    Integer liSign
47556>>>>>>>
47556>>>>>>>                Integer liSlave_Gmove_Create //¡˜Ÿ˜¨á š ˜ ¢æš¦¬ª compilation
47557>>>>>>>
47557>>>>>>>                //š ˜ ¢æš¦¬ª ˜©­˜¢œå˜ª, £ã¤ «¬®æ¤ ¥œ§œ¨á©à «¦¬ª 255 ®˜¨˜¡«ã¨œª
47557>>>>>>>                If (Num_Arguments <> 7 ) Error 10001 "Wrong Num Arguments!\n\nPlease Call Solution!"
47560>>>>>>>
47560>>>>>>>                //**************************************************************************
47560>>>>>>>                //01.¬§¦¢¦š ©£æª & â¢œš®¦ª §¨¦©ã£¦¬ (+ ã -)
47560>>>>>>>                //**************************************************************************
47560>>>>>>>                If (;                     ((Abs(liSign)) <> 1 );                   ) Begin
47562>>>>>>>                      Send Operation_Not_Allowed 6001 //˜¡˜«á¢¢ž¢¦ §¨æ©ž£¦ (¢áŸ¦ª ¡é› ¡˜ª)
47563>>>>>>>                                                      //› ˜¡¦§ã «¦¬ transaction!
47563>>>>>>>                     End
47563>>>>>>>>
47563>>>>>>>                Move (lnV2  * liSign) to lnV2
47564>>>>>>>                Move (lnV0  * liSign) to lnV0
47565>>>>>>>                Move (lnV00 * liSign) to lnV00
47566>>>>>>>                Move (lnVR  * liSign) to lnVR
47567>>>>>>>
47567>>>>>>>                //**************************************************************************
47567>>>>>>>                //02.œ¤ž£â¨à©ž bsum
47567>>>>>>>                //**************************************************************************
47567>>>>>>>
47567>>>>>>>                //02.1:œç¨œ©ž/›ž£ ¦¬¨šå˜ & œ¤ž£â¨à©ž bsum
47567>>>>>>>                Clear Bsum
47568>>>>>>>                Move lsBarticl_Recr  to Bsum.Barticl_Recr
47569>>>>>>>                Move lsBaxiokat_Recr to Bsum.Baxiokat_Recr
47570>>>>>>>                Find Eq Bsum by Index.1 //barticl_recr+baxiokat_recr !!!!!!
47571>>>>>>>>
47571>>>>>>>                If (Found=0);                Begin //˜¨®ã ›ž£ ¦¬¨šå˜s ¤â¦¬ record bsum
47573>>>>>>>
47573>>>>>>>                      // jsjsjs 27/01/2001
47573>>>>>>>                      Add 1 to SysrecB.Bsum_Rec0
47574>>>>>>>                      Saverecord SysrecB
47575>>>>>>>                      Move SysrecB.Bsum_Rec0  to Bsum.Bsum_Rec0
47576>>>>>>>                      Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                        (Trim(String(Bsum.Bsum_Rec0)))))) to Bsum.Bsum_Recr
47577>>>>>>>
47577>>>>>>>                      //Add 1 to SysrecB.Bsum_Rec0
47577>>>>>>>                      //Saverecord SysrecB
47577>>>>>>>                      //§¨¦©¦®ã ! ›â¤ â®à rec mhdenia  ! ! !
47577>>>>>>>                      //Move SysrecB.Bsum_Rec0       to Bsum.Bsum_Rec0
47577>>>>>>>                      //œ¤ž£â¨à©ž £ã related §œ›åà¤
47577>>>>>>>                      //§¨¦©¦®ã ! ›â¤ â®à £ã related §œ›å˜ ! ! !
47577>>>>>>>                      Set piSlave_Gmove_Create to 1  //›ž£ ¦¬¨šå˜ ¤â¦¬ gmove slave record
47578>>>>>>>                      Move 1 to liSlave_Gmove_Create //¡˜Ÿ˜¨á š ˜ ¢æš¦¬ª compilation
47579>>>>>>>                End //«â¢¦ª ›ž£ ¦¬¨šå˜s ¤â¦¬ record bsum
47579>>>>>>>>
47579>>>>>>>
47579>>>>>>>                //02.2:œ¤ž£â¨à©ž bsum (update+backout)
47579>>>>>>>
47579>>>>>>>                //02.3:©é© £¦ ã › ˜š¨˜­ã «¦¬ bsum
47579>>>>>>>
47579>>>>>>>                If (;                     (Bsum.Bsum_SV2 + lnV2  = 0) and;                     ((piUpdate(Self))      = 0);                   );                Begin
47581>>>>>>>                     Delete Bsum
47582>>>>>>>                     Set piSlave_Gmove_Delete  to 1 //› ˜š¨˜­ã gmove slave record
47583>>>>>>>                End
47583>>>>>>>>
47583>>>>>>>                Else;                Begin
47584>>>>>>>                     Add lnV2  to Bsum.Bsum_SV2
47585>>>>>>>                     Add lnV0  to Bsum.Bsum_SV0
47586>>>>>>>                     Add lnV00 to Bsum.Bsum_SV00
47587>>>>>>>                     Add lnVR  to Bsum.Bsum_SVR
47588>>>>>>>                     Saverecord Bsum
47589>>>>>>>                     Set piSlave_Gmove_Edit    to (Not(liSlave_Gmove_Create)) //edit gmove slave record
47590>>>>>>>                End
47590>>>>>>>>
47590>>>>>>>
47590>>>>>>>      End_Procedure //private.update_bsum
47591>>>>>>>      //****************************************************************************************
47591>>>>>>>      //**************P R O C E D U R A L    „ Œ † ‹„  — ‘ †    B S U M************************
47591>>>>>>>      //****************************************************************************************
47591>>>>>>>
47591>>>>>>>
47591>>>>>>>      //private
47591>>>>>>>      //¡˜¢œå«˜  ˜§æ request save & delete, ˜¡¨ ™éª §¨å¤ ¡˜  £œ«á «¦ forward send
47591>>>>>>>      Procedure private.Initialize_Properties
47592>>>>>>>                Integer liBarticl_dd liBaxio_dd
47593>>>>>>>
47593>>>>>>>                //barticl related properties
47593>>>>>>>                Get piBarticl_dd to liBarticl_dd
47594>>>>>>>                If (liBarticl_dd <> 0);                Begin //œá¤ æ¤«àª ™¨å©¡à ¡á§¦ ¦ barticl_server_ddo
47596>>>>>>>                     Set piCreated_Barticl of liBarticl_dd to 0
47597>>>>>>>                End
47597>>>>>>>>
47597>>>>>>>                Else Error 10000 "Bmove does not have a Barticl Server ! ! !"
47599>>>>>>>
47599>>>>>>>                //baxio   related properties
47599>>>>>>>                Get piBaxio_dd to liBaxio_dd
47600>>>>>>>                If (liBaxio_dd <> 0);                Begin //œá¤ æ¤«àª ™¨å©¡à ¡á§¦ ¦ baxio_server_ddo
47602>>>>>>>                     Set piCreated_Baxio   of liBaxio_dd to 0
47603>>>>>>>                     Set pnB_Baxio_V2      of liBaxio_dd to 0
47604>>>>>>>                     Set pnB_Baxio_V0      of liBaxio_dd to 0
47605>>>>>>>                     Set pnB_Baxio_V00     of liBaxio_dd to 0
47606>>>>>>>                     Set pnB_Baxio_Vr      of liBaxio_dd to 0
47607>>>>>>>                     Set psB_Baxio_C_Code2 of liBaxio_dd to ""
47608>>>>>>>                     Set piB_Baxio_Status  of liBaxio_dd to 0
47609>>>>>>>                     Set piB_Baxiokat_Code of liBaxio_dd to 0
47610>>>>>>>                     Set piB_Year_Year     of liBaxio_dd to 0
47611>>>>>>>                     Set piBtypkin_Flag03  of liBaxio_dd to 0
47612>>>>>>>                     Set piBtypkin_Flag04  of liBaxio_dd to 0
47613>>>>>>>                End
47613>>>>>>>>
47613>>>>>>>                Else Error 10000 "Bmove does not have a Baxio Server ! ! !"
47615>>>>>>>
47615>>>>>>>                Set piCreated_Bmove  to 0 //©œ«á¨œ«˜  ©«ž¤ creating,
47616>>>>>>>
47616>>>>>>>                //£ž›œ¤ ©£æª 19 §˜¢˜ é¤ « £é¤
47616>>>>>>>                Set piB_Garticl_Rec0         to 0
47617>>>>>>>                Set piB_Gtypkin_Rec0         to 0
47618>>>>>>>                Set pdB_Garticl_Hmnia        to 0
47619>>>>>>>                Set piB_Garticl_No           to 0
47620>>>>>>>                Set psB_Garticl_C_Code2      to 0
47621>>>>>>>                Set pnB_Garticl_Rate0        to 0
47622>>>>>>>                Set pnB_Garticl_Rate00       to 0
47623>>>>>>>                Set pnB_Garticl_RateR        to 0
47624>>>>>>>                Set psB_Garticl_Aitiol       to 0
47625>>>>>>>
47625>>>>>>>                Set piB_Gmove_Master_Rec0    to 0
47626>>>>>>>                Set piB_Gplan_Master_Rec0    to 0
47627>>>>>>>                Set pnB_Gmove_Master_X2      to 0
47628>>>>>>>                Set pnB_Gmove_Master_P2      to 0
47629>>>>>>>                Set psB_Gmove_Master_Aitiol  to 0
47630>>>>>>>
47630>>>>>>>                Set piB_Gmove_Slave_Rec0     to 0
47631>>>>>>>                Set piB_Gplan_Slave_Rec0     to 0
47632>>>>>>>                Set pnB_Gmove_Slave_X2       to 0
47633>>>>>>>                Set pnB_Gmove_Slave_P2       to 0
47634>>>>>>>                Set psB_Gmove_Slave_Aitiol   to 0
47635>>>>>>>
47635>>>>>>>                //£ž›œ¤ ©£æª 19 ¤âà¤ « £é¤
47635>>>>>>>                Set piA_Garticl_Rec0         to 0
47636>>>>>>>                Set piA_Gtypkin_Rec0         to 0
47637>>>>>>>                Set pdA_Garticl_Hmnia        to 0
47638>>>>>>>                Set piA_Garticl_No           to 0
47639>>>>>>>                Set psA_Garticl_C_Code2      to 0
47640>>>>>>>                Set pnA_Garticl_Rate0        to 0
47641>>>>>>>                Set pnA_Garticl_Rate00       to 0
47642>>>>>>>                Set pnA_Garticl_RateR        to 0
47643>>>>>>>                Set psA_Garticl_Aitiol       to 0
47644>>>>>>>
47644>>>>>>>                Set piA_Gmove_Master_Rec0    to 0
47645>>>>>>>                Set piA_Gplan_Master_Rec0    to 0
47646>>>>>>>                Set pnA_Gmove_Master_X2      to 0
47647>>>>>>>                Set pnA_Gmove_Master_P2      to 0
47648>>>>>>>                Set psA_Gmove_Master_Aitiol  to 0
47649>>>>>>>
47649>>>>>>>                Set piA_Gmove_Slave_Rec0     to 0
47650>>>>>>>                Set piA_Gplan_Slave_Rec0     to 0
47651>>>>>>>                Set pnA_Gmove_Slave_X2       to 0
47652>>>>>>>                Set pnA_Gmove_Slave_P2       to 0
47653>>>>>>>                Set psA_Gmove_Slave_Aitiol   to 0
47654>>>>>>>
47654>>>>>>>                Set piBaxio_Status_From      to 0
47655>>>>>>>                Set piBaxio_Status_To        to 0
47656>>>>>>>
47656>>>>>>>                //3 properties š ˜ «ž¤ feedback œ¤ž£â¨à©ž ˜§¦ «ž¤ š¢
47656>>>>>>>                Set piF_Garticl_Rec0         to 0
47657>>>>>>>                Set piF_Gmove_Master_Rec0    to 0
47658>>>>>>>                Set piF_Gmove_Slave_Rec0     to 0
47659>>>>>>>
47659>>>>>>>                Set piUpdate                 to 0
47660>>>>>>>                Set piBackout                to 0
47661>>>>>>>
47661>>>>>>>                //properties š ˜ «ž¤ procedural œ¤ž£â¨à©ž «¦¬ bsum
47661>>>>>>>                Set psB_Barticl_Recr         to ''
47662>>>>>>>                Set psB_Baxiokat_Recr        to ''
47663>>>>>>>                Set pnB_Baxio_V2             to 0
47664>>>>>>>                Set pnB_Baxio_V0             to 0
47665>>>>>>>                Set pnB_Baxio_V00            to 0
47666>>>>>>>                Set pnB_Baxio_VR             to 0
47667>>>>>>>
47667>>>>>>>                Set psA_Barticl_Recr         to ''
47668>>>>>>>                Set psA_Baxiokat_Recr        to ''
47669>>>>>>>                Set pnA_Baxio_V2             to 0
47670>>>>>>>                Set pnA_Baxio_V0             to 0
47671>>>>>>>                Set pnA_Baxio_V00            to 0
47672>>>>>>>                Set pnA_Baxio_VR             to 0
47673>>>>>>>
47673>>>>>>>                //booleans §¦¬ ›ž¢é¤¦¬¤ «˜ operations §¦¬ Ÿ˜ šå¤œ  ©«¦¤ š¢
47673>>>>>>>                Set  piGarticl_Delete         to  0
47674>>>>>>>                Set  piGarticl_Edit           to  0
47675>>>>>>>                Set  piGarticl_Create         to  0
47676>>>>>>>
47676>>>>>>>                Set  piMaster_Gmove_Delete    to  0
47677>>>>>>>                Set  piMaster_Gmove_Edit      to  0
47678>>>>>>>                Set  piMaster_Gmove_Create    to  0
47679>>>>>>>
47679>>>>>>>                Set  piSlave_Gmove_Delete     to  0
47680>>>>>>>                Set  piSlave_Gmove_Edit       to  0
47681>>>>>>>                Set  piSlave_Gmove_Create     to  0
47682>>>>>>>      End_Procedure //private.Initialize_Properties
47683>>>>>>>
47683>>>>>>>
47683>>>>>>>      //private
47683>>>>>>>      //¡˜¢œå«˜  ˜§¦ «ž¤ update
47683>>>>>>>      Procedure private.Creating_Barticl
47684>>>>>>>      End_Procedure //private.creating_barticl
47685>>>>>>>
47685>>>>>>>
47685>>>>>>>      //private
47685>>>>>>>      //¡˜¢œå«˜  ˜§¦ «ž¤ update, ˜­¦ç â®œ  ™¨œå kinkat record
47685>>>>>>>      Procedure private.Creating_Baxio
47686>>>>>>>                Integer liCan_Create_Baxio //¡˜Ÿ˜¨á š ˜ ¢æš¦¬ª compilation only
47687>>>>>>>
47687>>>>>>>                //¡˜«'˜¨®áª ¤â˜ axio records ›ž£ ¦¬¨š¦ç¤«˜  £æ¤¦¤ æ«˜¤ :
47687>>>>>>>                //˜) œå¤˜  œ ©§¨˜¡«â˜ + «¦ bkinkat œ§ «¨â§œ  ›ž£ ¦¬¨šå˜, ã
47687>>>>>>>                //™) œå¤˜  §¢ž¨à«â˜   + «¦ bkinkat œ§ «¨â§œ  ›ž£ ¦¬¨šå˜.
47687>>>>>>>                //æ«˜¤ ›ž£ ¦¬¨š¦ç£œ ¤â˜ axio records, «æ«œ:
47687>>>>>>>                //˜)œ¤ž£â¨à©ž §œ›åà¤ first in, £æ¤¦ š ˜ œ ©§¨˜¡«â˜
47687>>>>>>>                //™)œ¤ž£â¨à©ž §œ›åà¤ first out, £æ¤¦ š ˜ §¢ž¨à«â˜
47687>>>>>>>                //š) §œ›å˜ status + place (˜¬«á «œ¢ ¡á «˜ œ¤ž£œ¨é¤à ©«ž¤ update)
47687>>>>>>>                Case Begin
47687>>>>>>>                     //›ž£ ¦¬¨šå˜ ˜¥ ¦š¨á­¦¬ œ ©§¨˜¡«â¦¬, œ¡¡¨œ£âª ©«¦ ®˜¨«¦­¬¢á¡ ¦
47687>>>>>>>                     Case ((Baxiokat.Baxiokat_Type = 1) and (Bkinkat.Bkinkat_Yn_New = 1))
47689>>>>>>>                          Move Btypkin.Btypkin_Anti1   to Baxio.Baxio_File_In
47690>>>>>>>                          Move Barticl.Barticl_Code1   to Baxio.Baxio_Code_In
47691>>>>>>>                          Move Barticl.Barticl_Epon1   to Baxio.Baxio_Epon_In
47692>>>>>>>                          Move Barticl.Barticl_Recr    to Baxio.Baxio_Fpar_In
47693>>>>>>>
47693>>>>>>>                          Move (-1)                    to Baxio.Baxio_File_Out //›â¤ ¬§á¨®œ 
47694>>>>>>>                          Move ""                      to Baxio.Baxio_Code_Out
47695>>>>>>>                          Move ""                      to Baxio.Baxio_Epon_Out
47696>>>>>>>                          Move 0                       to Baxio.Baxio_Fpar_Out
47697>>>>>>>                     Case Break
47698>>>>>>>
47698>>>>>>>                     //›ž£ ¦¬¨šå˜ ˜¥ ¦š¨á­¦¬ §¢ž¨à«â¦¬, œ¡¡¨œ£âª ©«¦ bkinkat_plac_to
47698>>>>>>>                     Case ((Baxiokat.Baxiokat_Type = 2) and (Bkinkat.Bkinkat_Yn_New = 1))
47701>>>>>>>                          Move (-1)                    to Baxio.Baxio_File_In  //›â¤ ¬§á¨®œ 
47702>>>>>>>                          Move ""                      to Baxio.Baxio_Code_In
47703>>>>>>>                          Move ""                      to Baxio.Baxio_Epon_In
47704>>>>>>>                          Move 0                       to Baxio.Baxio_Fpar_In
47705>>>>>>>
47705>>>>>>>                          Move Btypkin.Btypkin_Anti1   to Baxio.Baxio_File_Out
47706>>>>>>>                          Move Barticl.Barticl_Code1   to Baxio.Baxio_Code_Out
47707>>>>>>>                          Move Barticl.Barticl_Epon1   to Baxio.Baxio_Epon_Out
47708>>>>>>>                          Move Barticl.Barticl_Recr    to Baxio.Baxio_Fpar_Out
47709>>>>>>>                     Case Break
47710>>>>>>>
47710>>>>>>>                     Case Else //§¨¦­˜¤éª ¡á«  ›â¤ §áœ  ¡˜¢á
47710>>>>>>>                          Send Operation_Not_Allowed 3001 //›â¤ œ§ «¨â§œ«˜  ž ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬
47711>>>>>>>                Case End
47711>>>>>>>
47711>>>>>>>                If (Trim(Baxio.Baxio_C_Code2)='') Move (Trim(SysCurXr.C_Code0)) to Baxio.Baxio_C_Code2
47714>>>>>>>
47714>>>>>>>                //›œç«œ¨¦ª â¢œš®¦ª ›ž£ ¦¬¨šå˜ª ¤â¦¬ ˜¥ ¦š¨á­¦¬ ˜§æ «¦ bkinkay_yn_create !
47714>>>>>>>                Get piCan_Create_Baxio to liCan_Create_Baxio //¡˜Ÿ˜¨á š ˜ ¢æš¦¬ª compilation only
47715>>>>>>>                If (liCan_Create_Baxio = FALSE) Send Operation_Not_Allowed 3001 //›â¤ œ§ «¨â§œ«˜  ž ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬
47718>>>>>>>      End_Procedure //private.creating_baxio
47719>>>>>>>
47719>>>>>>>
47719>>>>>>>//      //private
47719>>>>>>>//      //™¨å©¡œ  ˜§æ «¦ bsum «¦ gmove slave rec0
47719>>>>>>>//      //¡˜¢œå«˜  ˜§æ update+backout ?
47719>>>>>>>//      Function private.fiBsum_Gmove_Srec0 String lsBarticl_Recr ;
47719>>>>>>>//                                          String lsBaxiokat_Recr;
47719>>>>>>>//                                          Returns Integer
47719>>>>>>>//               Clear Bsum
47719>>>>>>>//               Move lsBarticl_Recr  to Bsum.Barticl_Recr
47719>>>>>>>//               Move lsBaxiokat_Recr to Bsum.Baxiokat_Recr
47719>>>>>>>//               Find Eq Bsum by Index.1 //barticl_recr+baxiokat_recr
47719>>>>>>>//               Function_Return Bsum.Gmove_Srec0
47719>>>>>>>//      End_Function //private.fibsum_gmove_srec0
47719>>>>>>>
47719>>>>>>>
47719>>>>>>>      //private
47719>>>>>>>      //™¨å©¡œ  œá¤ ž ©¬š¡œ¡¨ £â¤ž btypkin ¡ ¤œå «¦ libaxiokat_code
47719>>>>>>>      //¡˜¢œå«˜  ˜§æ update+validate_save
47719>>>>>>>      Function private.fiBkinkat_Baxiokat_Code String lsBtypkin_Recr;                                               Integer liBaxiokat_Code;                                               Returns Integer
47720>>>>>>>               Clear Bkinkat
47721>>>>>>>               Move SysCurXr.Company_Code   to Bkinkat.Company_Code
47722>>>>>>>               Move SysCurXr.Branch_Code    to Bkinkat.Branch_Code
47723>>>>>>>               Move SysCurXr.Year_Year      to Bkinkat.Year_year
47724>>>>>>>               Move lsBtypkin_Recr          to Bkinkat.Btypkin_Recr
47725>>>>>>>               Move liBaxiokat_Code         to Bkinkat.Baxiokat_Code
47726>>>>>>>               Find Eq Bkinkat by Index.3 //Company+Branch+Year+btypkin_recr+baxiokat_code
47727>>>>>>>>
47727>>>>>>>               If (Found = 0) Begin
47729>>>>>>>                               Set piBaxio_Status_From to (-1)
47730>>>>>>>                               Set piBaxio_Status_To   to (-1)
47731>>>>>>>                               Function_Return 0
47732>>>>>>>                              End
47732>>>>>>>>
47732>>>>>>>               Set piBaxio_Status_From to Bkinkat.Baxio_Stat_From
47733>>>>>>>               Set piBaxio_Status_To   to Bkinkat.Baxio_Stat_To
47734>>>>>>>
47734>>>>>>>
47734>>>>>>>               Function_Return Bkinkat.Baxiokat_Code
47735>>>>>>>      End_Function //private.fibkinkat_baxiokat_code
47736>>>>>>>
47736>>>>>>>
47736>>>>>>>      //¡˜¢œå«˜  ˜§æ update & backout
47736>>>>>>>      //¡˜  œ¤ž£œ¨é¤œ  « ª ©¬¤¦¢ ¡âª ˜¥åœª «¦¬ barticl
47736>>>>>>>      Procedure private.Adjust_Balances Integer liSign;                                        Number  lnBaxio_V2;                                        Number  lnBaxio_V0;                                        Number  lnBaxio_V00;                                        Number  lnBaxio_VR
47737>>>>>>>                If (;                     ((Abs(liSign)) <> 1 );                   ) Begin
47739>>>>>>>                      Error 10000 "€¡˜«á¢¢ž¢¦ §¨æ©ž£¦, ¢áŸ¦ª ¡é› ¡˜" //› ˜¡¦§ã «¦¬ transaction!
47740>>>>>>>>
47740>>>>>>>                      Procedure_Return
47741>>>>>>>                     End
47741>>>>>>>>
47741>>>>>>>
47741>>>>>>>                 //¤æ£ ©£˜ œšš¨˜­ãª
47741>>>>>>>                Add (lnBaxio_V2  * liSign) to Barticl.Barticl_SV2
47742>>>>>>>
47742>>>>>>>                //¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©žª
47742>>>>>>>                Add (lnBaxio_V0  * liSign) to Barticl.Barticl_SV0
47743>>>>>>>
47743>>>>>>>                //›œ¬«œ¨œç¦¤ ¤æ£ ©£˜ ®¨ã©žª
47743>>>>>>>                Add (lnBaxio_V00 * liSign) to Barticl.Barticl_SV00
47744>>>>>>>
47744>>>>>>>                //¤æ£ ©£˜ reporting
47744>>>>>>>                Add (lnBaxio_VR  * liSign) to Barticl.Barticl_SVR
47745>>>>>>>      End_Procedure //private.adjust_balances
47746>>>>>>>
47746>>>>>>>
47746>>>>>>>
47746>>>>>>>
47746>>>>>>>      //æ¢˜ «˜ ddo ˜¬«ãª «ãª ¡¢á©žª, œ¤ž£œ¨é¤¦¬¤ «˜ 4 parents ¡˜  «¦¤ œ¬˜«æ «¦¬ª
47746>>>>>>>      //£œ æ¢˜ «˜ ddo id's
47746>>>>>>>      //œ§å©žª §¨â§œ  ¤˜ ¬§á¨®¦¬¤ ¡˜  ¦  3 bpo's š ˜ «ž¤ œ¤ž£â¨à©ž «à¤ ¢¦ §é¤ modules
47746>>>>>>>      Procedure End_Construct_Object
47747>>>>>>>                Integer liBtypkin_dd liBarticl_dd liBaxio_dd liBaxiokat_dd
47748>>>>>>>
47748>>>>>>>                Forward Send End_Construct_Object
47750>>>>>>>
47750>>>>>>>                Move (Find_Server_DDO(Self        ,Barticl.File_Number )) to liBarticl_dd
47751>>>>>>>                Move (Find_Server_DDO(Self        ,Baxio.File_Number   )) to liBaxio_dd
47752>>>>>>>                Move (Find_Server_DDO(liBarticl_dd,Btypkin.File_Number )) to liBtypkin_dd
47753>>>>>>>                Move (Find_Server_DDO(liBaxio_dd  ,Baxiokat.File_Number)) to liBaxiokat_dd
47754>>>>>>>
47754>>>>>>>                //object id «žª business process §¦¬ œ¤ž£œ¨é¤œ  «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã
47754>>>>>>>                //jsjsjs 24/01/2001 Set piDo_GL_Maintainance       to (oDo_GL_Maintainance      (Self))
47754>>>>>>>
47754>>>>>>>                //object id «žª business process §¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §œ¢á«œª
47754>>>>>>>//------------->Set piDo_CUSTOMER_Maintainance to (oDo_CUSTOMER_Maintainance(Self))
47754>>>>>>>
47754>>>>>>>                //object id «žª business process §¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §¨¦£žŸœ¬«âª
47754>>>>>>>//------------->Set piDo_VENDOR_Maintainance   to (oDo_VENDOR_Maintainance  (Self))
47754>>>>>>>
47754>>>>>>>                //â¢œš®¦  ¬§¦®¨œà« ¡ãª ç§˜¨¥žª ¡˜  «à¤ 4 ddo'w
47754>>>>>>>                If (liBarticl_dd  = 0) Error 10000 "Bmove does not have a Barticl  Server ! ! !"
47757>>>>>>>                If (liBaxio_dd    = 0) Error 10000 "Bmove does not have a Baxio    Server ! ! !"
47760>>>>>>>                If (liBtypkin_dd  = 0) Error 10000 "Bmove does not have a Btypkin  Server ! ! !"
47763>>>>>>>                If (liBaxiokat_dd = 0) Error 10000 "Bmove does not have a Baxiokat Server ! ! !"
47766>>>>>>>
47766>>>>>>>                //properties › ¡á «¦¬
47766>>>>>>>                //æ§¦¬ «˜ ®¨ž© £¦§¦ é, Ÿ˜ £§¦¨¦ç©˜ ¤˜ â¡˜¤˜ «ž¤ å› ˜ ›¦¬¢œ á £œ «ž¤ file_field_value ?
47766>>>>>>>                //æ®  ©« ª §œ¨ §«é©œ ª §¦¬ › ˜®œ ¨å¦£˜¦ properties !
47766>>>>>>>                Set piBarticl_dd                  to liBarticl_dd
47767>>>>>>>                Set piBaxio_dd                    to liBaxio_dd
47768>>>>>>>                Set piBtypkin_dd                  to liBtypkin_dd
47769>>>>>>>                Set piBaxiokat_dd                 to liBaxiokat_dd
47770>>>>>>>
47770>>>>>>>                //properties «¦¬ btypkin
47770>>>>>>>                Set piBarticl_dd  of liBtypkin_dd to liBarticl_dd
47771>>>>>>>                Set piBmove_dd    of liBtypkin_dd to Self
47772>>>>>>>                Set piBaxio_dd    of liBtypkin_dd to liBaxio_dd
47773>>>>>>>                Set piBaxiokat_dd of liBtypkin_dd to liBaxiokat_dd
47774>>>>>>>
47774>>>>>>>                //properties «¦¬ baxiokat
47774>>>>>>>                Set piBarticl_dd  of liBaxiokat_dd to liBarticl_dd
47775>>>>>>>                Set piBmove_dd    of liBaxiokat_dd to Self
47776>>>>>>>                Set piBaxio_dd    of liBaxiokat_dd to liBaxio_dd
47777>>>>>>>                Set piBtypkin_dd  of liBaxiokat_dd to liBtypkin_dd
47778>>>>>>>
47778>>>>>>>                //properties «¦¬ barticl
47778>>>>>>>                Set piBmove_dd    of liBarticl_dd  to Self
47779>>>>>>>                Set piBaxio_dd    of liBarticl_dd  to liBaxio_dd
47780>>>>>>>                Set piBtypkin_dd  of liBarticl_dd  to liBtypkin_dd
47781>>>>>>>                Set piBaxiokat_dd of liBarticl_dd  to liBaxiokat_dd
47782>>>>>>>
47782>>>>>>>      End_Procedure   //end_construct_object
47783>>>>>>>
47783>>>>>>>      //£á¢¢¦¤ œå¤˜  á®¨ž©«ž, › æ«  §á¤«˜ «¦ bmove_dd «¦ › ˜®œ ¨å¦£˜ 
47783>>>>>>>      //œå«˜  ©˜¤ detail «¦¬ barticl, œå«˜  ©˜¤ detail «¦¬ baxio !
47783>>>>>>>      //ã constrain Ÿ˜ £¦¬ ®¨œ ˜©Ÿœå £æ¤¦¤ œá¤ â®à main server «¦ bmove_dd ! ! !
47783>>>>>>>      Procedure Constrain
47784>>>>>>>                Forward Send Constrain
47786>>>>>>>                Constrain Bmove.Company_Code  eq SysCurXR.Company_Code
47788>>>>>>>                Constrain Bmove.Branch_Code   eq SysCurXR.Branch_Code
47790>>>>>>>                Constrain Bmove.Year_Year     eq SysCurXR.Year_Year
47792>>>>>>>      End_Procedure   //constrain
47793>>>>>>>
47793>>>>>>>
47793>>>>>>>      //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
47793>>>>>>>      //™) ˜¤áš¤à©ž properties
47793>>>>>>>      //š) › ˜®œå¨ ©ž calculated §œ›åà¤
47793>>>>>>>      //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
47793>>>>>>>      //œ) œ¤ž£â¨à©ž properties after
47793>>>>>>>      Procedure Update
47794>>>>>>>                Integer liTemp
47795>>>>>>>                Integer liBarticl_dd      liBaxio_dd
47795>>>>>>>                Integer liCreated_Barticl liCreated_Baxio
47795>>>>>>>                String  lsGplan_Slave_Code
47795>>>>>>>
47795>>>>>>>                Forward Send Update
47797>>>>>>>
47797>>>>>>>                //0)š ˜ ¢æš¦¬ª  › ˜ «œ¨æ«ž«˜ª, æ¢¦ª ¦ ¡é› ¡˜ª
47797>>>>>>>                //«é¤ creating baxio + barticl  (?) «¨â®œ  «é¨˜, ˜§¦ «ž¤ update «¦¬ bmove ! ! !
47797>>>>>>>                //§¨é«˜ œ¤«¦§åà bkikat
47797>>>>>>>                Move (private.fiBkinkat_Baxiokat_Code(Self,;                                    Btypkin.Btypkin_Recr,;                                    Baxiokat.Baxiokat_Code);                     ) to liTemp
47798>>>>>>>                If (liTemp = 0) Send Operation_Not_Allowed 3002 //›â¤ œ§ «¨â§œ«˜  ž ¡å¤ž©ž baxiokat_code £œ «¦ btypkin
47801>>>>>>>
47801>>>>>>>
47801>>>>>>>                //***********************************************************
47801>>>>>>>                //*    ˜§æ œ›é ¡˜  ¡á«à, â®à §¢â¦¤ active bkinkat record    *
47801>>>>>>>                //***********************************************************
47801>>>>>>>
47801>>>>>>>
47801>>>>>>>                //œç¨œ©ž «à¤ 2 server ddo's
47801>>>>>>>                Get piBarticl_dd to liBarticl_dd
47802>>>>>>>                Get piBaxio_dd   to liBaxio_dd
47803>>>>>>>
47803>>>>>>>                //œ¤ž£â¨à©ž «¦¬ parent barticl dd
47803>>>>>>>                If (liBarticl_dd <> 0);                Begin
47805>>>>>>>                    Get piCreated_Barticl of liBarticl_dd to liCreated_Barticl
47806>>>>>>>                    If (liCreated_Barticl = TRUE)  Send private.Creating_Barticl
47809>>>>>>>                End
47809>>>>>>>>
47809>>>>>>>                Else Error 10000 "Bmove does not have a Barticl Server ! ! !"
47811>>>>>>>
47811>>>>>>>                //œ¤ž£â¨à©ž «¦¬ parent baxio dd
47811>>>>>>>                If (liBaxio_dd   <> 0);                Begin
47813>>>>>>>                    Get piCreated_Baxio   of liBaxio_dd   to liCreated_Baxio
47814>>>>>>>                    If (liCreated_Baxio   = TRUE)  Send private.Creating_Baxio
47817>>>>>>>                    Set piBtypkin_Flag03 of liBaxio_dd to Btypkin.Btypkin_Flag03
47818>>>>>>>                    Set piBtypkin_Flag04 of liBaxio_dd to Btypkin.Btypkin_Flag04
47819>>>>>>>                End
47819>>>>>>>>
47819>>>>>>>                Else Error 10000 "Bmove does not have a Baxio Server ! ! !"
47821>>>>>>>
47821>>>>>>>// jsjsjs sos energopoihsh xenou nomismatos 29/11/2001
47821>>>>>>>//                //***************************************************************************
47821>>>>>>>//                //============================================================================
47821>>>>>>>//                //||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
47821>>>>>>>//                //£œ«˜«¨¦§ã «žª ˜¥å˜ª ˜§æ ¤æ£ ©£˜ œšš¨˜­ãª (2) ©«˜ ¢¦ §á 3 ¤¦£å©£˜«˜  (0+00+r)
47821>>>>>>>//                Move 1                  to Baxio.Baxio_Rate0 //sosososo §¨¦©à¨ ¤á, £æ¤¦¤ ˜¥ æš¨˜­˜ ©œ ›¨®
47821>>>>>>>//                Move SysCurXr.C_Code0   to Baxio.Baxio_C_Code2 //sosososo §¨¦©à¨ ¤á, £æ¤¦¤ ˜¥ æš¨˜­˜ ©œ ›¨®
47821>>>>>>>//                //***************************************************************************
47821>>>>>>>//                //============================================================================
47821>>>>>>>//                //||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
47821>>>>>>>// jsjsjs sos energopoihsh xenou nomismatos 29/11/2001
47821>>>>>>>
47821>>>>>>>                Send Convert_Axio_Values to liBaxio_dd
47822>>>>>>>
47822>>>>>>>
47822>>>>>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
47822>>>>>>>                Move SysCurXr.Company_Code  to Bmove.Company_Code
47823>>>>>>>                Move SysCurXr.Branch_Code   to Bmove.Branch_Code
47824>>>>>>>                Move SysCurXr.Year_Year     to Bmove.Year_Year
47825>>>>>>>                Move Baxio.Baxio_Code       to Bmove.Baxio_Code
47826>>>>>>>                Move Btypkin.Btypkin_Code   to Bmove.Btypkin_Code
47827>>>>>>>                Move Btypkin.Btypkin_Recr   to Bmove.Btypkin_Recr
47828>>>>>>>                Move Barticl.Barticl_Hmnia  to Bmove.Barticl_Hmnia
47829>>>>>>>                Move Barticl.Barticl_No     to Bmove.Barticl_No
47830>>>>>>>
47830>>>>>>>                Move Barticl.Sls_ID         to Bmove.Sls_ID
47831>>>>>>>                Move Barticl.Presp_ID       to Bmove.Presp_ID
47832>>>>>>>                Move Barticl.Cnt_ID         to Bmove.Cnt_ID
47833>>>>>>>
47833>>>>>>>
47833>>>>>>>                //™) ˜¤áš¤à©ž properties
47833>>>>>>>
47833>>>>>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
47833>>>>>>>
47833>>>>>>>                //š.01:œ¤ž£â¨à©ž §œ›åà¤ previous §˜¨˜¢ã§«žª «¦¬ bmove š ˜ æ¢˜ «˜ ˜¥ æš¨˜­˜
47833>>>>>>>                //     §¨¦«¦ç ˜¢¢á¥à «˜ last §œ›å˜ «¦¬ baxio, «˜ ¡¨˜«áà ©«˜
47833>>>>>>>                //     previous §œ›å˜ «¦¬ bmove,
47833>>>>>>>                //     é©«œ ©«ž¤ deleting ¤˜ «˜ œ§˜¤˜­â¨à
47833>>>>>>>                Move Baxio.Baxio_Lfile      to  Bmove.Baxio_Pfile
47834>>>>>>>                Move Baxio.Baxio_Lcode      to  Bmove.Baxio_Pcode
47835>>>>>>>                Move Baxio.Baxio_Lepon      to  Bmove.Baxio_Pepon
47836>>>>>>>                Move Baxio.Baxio_Lpar       to  Bmove.Baxio_Ppar
47837>>>>>>>
47837>>>>>>>                //š.02:œ¤ž£â¨à©ž §œ›åà¤ last («œ¢œ¬«˜å¦ª §˜¨˜¢ã§«žª) «¦¬ baxio š ˜ æ¢˜ «˜ ˜¥ æš¨˜­˜
47837>>>>>>>
47837>>>>>>>// ----------------------------------------------------------------------------
47837>>>>>>>// js 24/02/2002    Ayth h periptosh den isxyei xoris elegxo giati otan afora
47837>>>>>>>//                  plhromh dikh mas o promhtheyths mpainei sto 1o koutaki dhladh
47837>>>>>>>//                  ston ekdoth kai paramenei kenos o apodekths (Code2).
47837>>>>>>>//                  Otan loipon menei kenos o apodekths den enhmeronei Lcode
47837>>>>>>>//                  kai an den enhmerosei Lcode tote apo to Baxio_DD katharizontai
47837>>>>>>>//                  ola ta _Out pedia
47837>>>>>>>
47837>>>>>>>//                Move Btypkin.Btypkin_Anti2  to Baxio.Baxio_Lfile
47837>>>>>>>//                Move Barticl.Barticl_Code2  to Baxio.Baxio_Lcode
47837>>>>>>>//                Move Barticl.Barticl_Epon2  to Baxio.Baxio_Lepon
47837>>>>>>>//                Move Barticl.Barticl_Recr   to Baxio.Baxio_Lpar
47837>>>>>>>
47837>>>>>>>                If (Baxiokat.Baxiokat_Type = 2) Begin
47839>>>>>>>                    If (Trim(Barticl.Barticl_Code2)<>'') Begin
47841>>>>>>>                        Move Btypkin.Btypkin_Anti2  to Baxio.Baxio_Lfile
47842>>>>>>>                        Move Barticl.Barticl_Code2  to Baxio.Baxio_Lcode
47843>>>>>>>                        Move Barticl.Barticl_Epon2  to Baxio.Baxio_Lepon
47844>>>>>>>                        Move Barticl.Barticl_Recr   to Baxio.Baxio_Lpar
47845>>>>>>>                    End
47845>>>>>>>>
47845>>>>>>>                    Else Begin
47846>>>>>>>                        Move Btypkin.Btypkin_Anti1  to Baxio.Baxio_Lfile
47847>>>>>>>                        Move Barticl.Barticl_Code1  to Baxio.Baxio_Lcode
47848>>>>>>>                        Move Barticl.Barticl_Epon1  to Baxio.Baxio_Lepon
47849>>>>>>>                        Move Barticl.Barticl_Recr   to Baxio.Baxio_Lpar
47850>>>>>>>                    End
47850>>>>>>>>
47850>>>>>>>                End
47850>>>>>>>>
47850>>>>>>>                Else If (Baxiokat.Baxiokat_Type = 1) Begin
47853>>>>>>>                    // js 24/02/2002 PARATHRHSEIS
47853>>>>>>>                    // Edo den kanoume elegxo giati an einai eisprakteo (xoris metavivash)
47853>>>>>>>                    // tote epeidh den anoigei to Code2 ex orismou tha einai kena
47853>>>>>>>                    // An tora einai eispraktea pros metavivash tote ex orismou
47853>>>>>>>                    // to Code2 exei timh apo thn othonh opote kai tha enhmerosei
47853>>>>>>>                    // me Lcode h update tou Baxio_DD
47853>>>>>>>                    // to kolpo edo einai oti apitoume apo ton xrhsth sthn periptosh
47853>>>>>>>                    // metavivashs na plhktrologhsei ston ekdoth KAI ston apodekth
47853>>>>>>>                    // ton idio kodiko tou promhtheyth ston opoio metavivazei thn epitagh
47853>>>>>>>
47853>>>>>>>                    // Ayto prepei sto epomeno version na allaxei opos epishs kai to gegonos
47853>>>>>>>                    // oti menei panta keno to pedio tou paralhpth stis eispraktees apo pelath
47853>>>>>>>                    // eno theoro oti tha prepe na mpainei h 'etairia' opos epishs kai
47853>>>>>>>                    // stis epitages plhrotees dikes mas menei keno o ekdoths pou pali
47853>>>>>>>                    // tha'prepe na'maste 'emeis' (Mia kartella dhladh opou h 'etairia mas'
47853>>>>>>>                    // tha emfanizetai kai pelaths kai promhtheyths.
47853>>>>>>>                    // js 24/02/2002 Parathrhseis
47853>>>>>>>                    Move Btypkin.Btypkin_Anti2  to Baxio.Baxio_Lfile
47854>>>>>>>                    Move Barticl.Barticl_Code2  to Baxio.Baxio_Lcode
47855>>>>>>>                    Move Barticl.Barticl_Epon2  to Baxio.Baxio_Lepon
47856>>>>>>>                    Move Barticl.Barticl_Recr   to Baxio.Baxio_Lpar
47857>>>>>>>                End
47857>>>>>>>>
47857>>>>>>>
47857>>>>>>>// ----------------------------------------------------------------------------
47857>>>>>>>
47857>>>>>>>                //š.03:œ¤ž£â¨à©ž §œ›åà¤ first out (§¨é«¦ª §˜¨˜¢ã§«žª) «¦¬ baxio š ˜ æ¢˜ «˜ ˜¥ æš¨˜­˜
47857>>>>>>>                //     ¡˜  œ­'æ©¦¤ ›â¤ â®¦¬¤ ã›ž œ¤ž£œ¨àŸœå,
47857>>>>>>>                //     ›ž¢˜›ã §¨æ¡œ «˜  š ˜ «ž¤ §¨é«ž £œ«˜™å™˜©ž-œ¥˜šàšã
47857>>>>>>>                If (;                     (Baxio.Baxio_Code_Out = "" );                   );                Begin
47859>>>>>>>                      Move Btypkin.Btypkin_Anti2   to Baxio.Baxio_File_Out
47860>>>>>>>                      Move Barticl.Barticl_Code2   to Baxio.Baxio_Code_Out
47861>>>>>>>                      Move Barticl.Barticl_Epon2   to Baxio.Baxio_Epon_Out
47862>>>>>>>                      Move Barticl.Barticl_Recr    to Baxio.Baxio_Fpar_Out
47863>>>>>>>                End
47863>>>>>>>>
47863>>>>>>>
47863>>>>>>>                //š.04:œ¤ž£â¨à©ž §œ›åà¤ status + place «¦¬ baxio, ˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž (bkinkat)
47863>>>>>>>                Move Bkinkat.Baxio_Stat_To  to Baxio.Baxio_Status //¡˜«á©«˜©ž :˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž
47864>>>>>>>                Move Bkinkat.Baxio_Plac_To  to Baxio.Baxio_Place  //œ¬¨å¡œ«˜ :˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž
47865>>>>>>>
47865>>>>>>>//                //š.05:©«¦ ®œå˜ slave gplan rec0
47865>>>>>>>//                Case Begin
47865>>>>>>>//                     Case (Btypkin.Gtypkin_Code <> 0) //œá¤ ž ¡å¤ž©ž œ¤ž£œ¨é¤œ  ‚Š
47865>>>>>>>////jsjsjs 24/01/2001
47865>>>>>>>////                          Clear Gplan
47865>>>>>>>////                          Move Company.Company_Code    to Gplan.Company_Code
47865>>>>>>>////                          Move Branch.Branch_Code      to Gplan.Branch_Code
47865>>>>>>>////                          Move Year.Year_Year          to Gplan.Year_Year
47865>>>>>>>////                          Move Bkinkat.Bkinkat_GplnCod to Gplan.Gplan_Code
47865>>>>>>>////                          Find Eq Gplan by Index.1 //company_code+branch_code+year_year+Gplan_code
47865>>>>>>>////                          If (Found = 1) Move Gplan.Gplan_Rec0 to Bmove.Gplan_SRec0
47865>>>>>>>////                          Else           Send Operation_Not_Allowed 3001 //›â¤ ™¨âŸž¡œ «¦ slave gplan_rec0
47865>>>>>>>////jsjsjs 24/01/2001
47865>>>>>>>//                     Case Break //æ® , › æ«  £§¦¨œå ¤˜ œ¤ž£œ¨é¤œ ¡˜  á¢¢˜ modules
47865>>>>>>>
47865>>>>>>>//                     Case (Btypkin.Ctypkin_Code <> 0) //œá¤ ž ¡å¤ž©ž œ¤ž£œ¨é¤œ  §œ¢á«œª
47865>>>>>>>//                     Case Break
47865>>>>>>>
47865>>>>>>>//                     Case (Btypkin.Vtypkin_Code <> 0) //œá¤ ž ¡å¤ž©ž œ¤ž£œ¨é¤œ  §¨¦£žŸœ¬«âª
47865>>>>>>>//                     Case Break
47865>>>>>>>
47865>>>>>>>//                     Case Else                        //›â¤ œ¤ž£œ¨é¤œ«˜  ¡˜¤â¤˜ ˜§¦ «˜ 3 modules
47865>>>>>>>//                          Move 0 to Bmove.Gplan_SRec0
47865>>>>>>>//                Case End
47865>>>>>>>
47865>>>>>>>                //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
47865>>>>>>>                Send private.Adjust_Balances (1);                                             Baxio.Baxio_V2;                                             Baxio.Baxio_V0;                                             Baxio.Baxio_V00;                                             Baxio.Baxio_VR
47866>>>>>>>
47866>>>>>>>//                //œ) œ¤ž£â¨à©ž properties after (˜§æ parent buffers!)
47866>>>>>>>//                Set piA_Garticl_Rec0         to Barticl.Garticl_Rec0
47866>>>>>>>//                Set piA_Gtypkin_Rec0         to Btypkin.Gtypkin_Rec0
47866>>>>>>>//                Set pdA_Garticl_Hmnia        to Barticl.Barticl_Hmnia
47866>>>>>>>//                Set piA_Garticl_No           to Barticl.Barticl_No
47866>>>>>>>//                Set psA_Garticl_C_Code2      to Baxio.Baxio_C_Code2
47866>>>>>>>//                Set pnA_Garticl_Rate0        to Baxio.Baxio_Rate0
47866>>>>>>>//                Set pnA_Garticl_Rate00       to Baxio.Baxio_Rate00
47866>>>>>>>//                Set pnA_Garticl_RateR        to Baxio.Baxio_RateR
47866>>>>>>>//                Set psA_Garticl_Aitiol       to Barticl.Barticl_Aitiol
47866>>>>>>>
47866>>>>>>>//                Set piA_Gmove_Master_Rec0    to Barticl.Gmove_Mrec0
47866>>>>>>>//                Set piA_Gplan_Master_Rec0    to Barticl.Gplan_Mrec0
47866>>>>>>>
47866>>>>>>>                //â¢œš®¦ª §¨¦©ã£¦¬
47866>>>>>>>                If ((Abs(Btypkin.Btypkin_Sign)) <> 1) Error 10000 "To Btypkin Sign œå¤˜  ¢áŸ¦ª !"
47869>>>>>>>
47869>>>>>>>                Case Begin
47869>>>>>>>                     Case (Btypkin.Btypkin_Anti_Xp = 1) //®¨âà©ž master, §å©«à©ž slave
47871>>>>>>>//                          Set pnA_Gmove_Master_X2 to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
47871>>>>>>>//                          Set pnA_Gmove_Master_P2 to 0
47871>>>>>>>//                          Set pnA_Gmove_Slave_X2  to 0
47871>>>>>>>//                          Set pnA_Gmove_Slave_P2  to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
47871>>>>>>>                     Case Break
47872>>>>>>>                     Case (Btypkin.Btypkin_Anti_Xp = 2) // §å©«à©ž master, ®¨âà©ž slave
47875>>>>>>>//                          Set pnA_Gmove_Master_X2 to 0
47875>>>>>>>//                          Set pnA_Gmove_Master_P2 to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
47875>>>>>>>//                          Set pnA_Gmove_Slave_X2  to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
47875>>>>>>>//                          Set pnA_Gmove_Slave_P2  to 0
47875>>>>>>>                     Case Break
47876>>>>>>>                     Case Else
47876>>>>>>>                          Error 10000 "To Btypkin XP œå¤˜  ¢áŸ¦ª!"
47877>>>>>>>>
47877>>>>>>>                Case End
47877>>>>>>>//                Set psA_Gmove_Master_Aitiol  to Barticl.Barticl_Aitiol
47877>>>>>>>
47877>>>>>>>//                Set piA_Gmove_Slave_Rec0     to (private.fiBsum_Gmove_Srec0(Self,;
47877>>>>>>>//                                                                            Barticl.Barticl_Rec0,;
47877>>>>>>>//                                                                            Baxiokat.Baxiokat_Rec0))
47877>>>>>>>//                Set piA_Gplan_Slave_Rec0     to Bmove.Gplan_Srec0
47877>>>>>>>//                Set psA_Gmove_Slave_Aitiol   to Barticl.Barticl_Aitiol
47877>>>>>>>
47877>>>>>>>                Set piUpdate to 1
47878>>>>>>>
47878>>>>>>>                //properties š ˜ «ž¤ procedural œ¤ž£â¨à©ž «¦¬ bsum
47878>>>>>>>                Set psA_Barticl_Recr         to Barticl.Barticl_Recr
47879>>>>>>>                Set psA_Baxiokat_Recr        to Baxiokat.Baxiokat_Recr
47880>>>>>>>                Set pnA_Baxio_V2             to Baxio.Baxio_V2
47881>>>>>>>                Set pnA_Baxio_V0             to Baxio.Baxio_V0
47882>>>>>>>                Set pnA_Baxio_V00            to Baxio.Baxio_V00
47883>>>>>>>                Set pnA_Baxio_VR             to Baxio.Baxio_VR
47884>>>>>>>
47884>>>>>>>//                //booleans §¦¬ ›ž¢é¤¦¬¤ «˜ operations §¦¬ Ÿ˜ šå¤¦¬¤ ©«ã¤ š¢
47884>>>>>>>//                If (Barticl.Garticl_Rec0 = 0);
47884>>>>>>>//                Begin //«¦ barticl ›â¤ â®œ  ©¬¤›œŸœå £œ master gmove
47884>>>>>>>//                     If (Barticl.Gmove_Mrec0 <> 0) Error 10000 "Master Gmove <> 0 !"
47884>>>>>>>//                     Set  piGarticl_Create         to  1
47884>>>>>>>//                     Set  piMaster_Gmove_Create    to  1
47884>>>>>>>//                End
47884>>>>>>>//                Set piGarticl_Edit      to  (Not(piGarticl_Create     (Self)))
47884>>>>>>>//                Set piMaster_Gmove_Edit to  (Not(piMaster_Gmove_Create(Self)))
47884>>>>>>>      End_Procedure   //update
47885>>>>>>>
47885>>>>>>>
47885>>>>>>>      Procedure Backout
47886>>>>>>>                Forward Send Backout
47888>>>>>>>
47888>>>>>>>                //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
47888>>>>>>>                Send private.Adjust_Balances (-1);                                             Baxio.Baxio_V2;                                             Baxio.Baxio_V0;                                             Baxio.Baxio_V00;                                             Baxio.Baxio_VR
47889>>>>>>>
47889>>>>>>>
47889>>>>>>>
47889>>>>>>>                //******************************
47889>>>>>>>                //prosoxi ! allagi sto bmove def gia na exo kai ayta ta pedia !!!
47889>>>>>>>                //******************************
47889>>>>>>>
47889>>>>>>>//                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
47889>>>>>>>//                Set piB_Garticl_Rec0         to Barticl.Garticl_Rec0
47889>>>>>>>//                Set piB_Gtypkin_Rec0         to Btypkin.Gtypkin_Rec0
47889>>>>>>>//                Set pdB_Garticl_Hmnia        to Bmove.Barticl_Hmnia     //sosososo
47889>>>>>>>//                Set piB_Garticl_No           to Bmove.Barticl_No        //sosososo
47889>>>>>>>//                Set psB_Garticl_C_Code2      to Baxio.Baxio_C_Code2
47889>>>>>>>//                Set pnB_Garticl_Rate0        to Baxio.Baxio_Rate0
47889>>>>>>>//                Set pnB_Garticl_Rate00       to Baxio.Baxio_Rate00
47889>>>>>>>//                Set pnB_Garticl_RateR        to Baxio.Baxio_RateR
47889>>>>>>>//                Set psB_Garticl_Aitiol       to Barticl.Barticl_Aitiol
47889>>>>>>>
47889>>>>>>>//                Set piB_Gmove_Master_Rec0    to Barticl.Gmove_Mrec0
47889>>>>>>>//                Set piB_Gplan_Master_Rec0    to Barticl.Gplan_Mrec0
47889>>>>>>>
47889>>>>>>>                //â¢œš®¦ª §¨¦©ã£¦¬
47889>>>>>>>                If ((Abs(Btypkin.Btypkin_Sign)) <> 1) Error 10000 "To Btypkin Sign œå¤˜  ¢áŸ¦ª !"
47892>>>>>>>
47892>>>>>>>                Case Begin
47892>>>>>>>                     Case (Btypkin.Btypkin_Anti_Xp = 1) //®¨âà©ž master, §å©«à©ž slave
47894>>>>>>>//                          Set pnB_Gmove_Master_X2 to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
47894>>>>>>>//                          Set pnB_Gmove_Master_P2 to 0
47894>>>>>>>//                          Set pnB_Gmove_Slave_X2  to 0
47894>>>>>>>//                          Set pnB_Gmove_Slave_P2  to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
47894>>>>>>>                     Case Break
47895>>>>>>>                     Case (Btypkin.Btypkin_Anti_Xp = 2) // §å©«à©ž master, ®¨âà©ž slave
47898>>>>>>>//                          Set pnB_Gmove_Master_X2 to 0
47898>>>>>>>//                          Set pnB_Gmove_Master_P2 to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
47898>>>>>>>//                          Set pnB_Gmove_Slave_X2  to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
47898>>>>>>>//                          Set pnB_Gmove_Slave_P2  to 0
47898>>>>>>>                     Case Break
47899>>>>>>>                     Case Else
47899>>>>>>>                          Error 10000 "To Btypkin XP œå¤˜  ¢áŸ¦ª!"
47900>>>>>>>>
47900>>>>>>>                Case End
47900>>>>>>>//                Set psB_Gmove_Master_Aitiol  to Barticl.Barticl_Aitiol
47900>>>>>>>
47900>>>>>>>//                Set piB_Gmove_Slave_Rec0     to (private.fiBsum_Gmove_Srec0(Self,;
47900>>>>>>>//                                                                            Barticl.Barticl_Rec0,;
47900>>>>>>>//                                                                            Baxiokat.Baxiokat_Rec0))
47900>>>>>>>
47900>>>>>>>//                Set piB_Gplan_Slave_Rec0     to Bmove.Gplan_Srec0
47900>>>>>>>//                Set psB_Gmove_Slave_Aitiol   to Barticl.Barticl_Aitiol
47900>>>>>>>
47900>>>>>>>                Set piBackout to 1
47901>>>>>>>
47901>>>>>>>                //properties š ˜ «ž¤ procedural œ¤ž£â¨à©ž «¦¬ bsum
47901>>>>>>>                Set psB_Barticl_Recr         to Barticl.Barticl_Recr
47902>>>>>>>                Set psB_Baxiokat_Recr        to Baxiokat.Baxiokat_Recr
47903>>>>>>>                Set pnB_Baxio_V2             to Baxio.Baxio_V2
47904>>>>>>>                Set pnB_Baxio_V0             to Baxio.Baxio_V0
47905>>>>>>>                Set pnB_Baxio_V00            to Baxio.Baxio_V00
47906>>>>>>>                Set pnB_Baxio_VR             to Baxio.Baxio_VR
47907>>>>>>>
47907>>>>>>>
47907>>>>>>>//                //booleans §¦¬ ›ž¢é¤¦¬¤ «¦ operation §¦¬ Ÿ˜ šå¤œ  ©«ã¤ š¢
47907>>>>>>>//                Case Begin
47907>>>>>>>//                     Case  (Barticl.Barticl_Lines = 0) //œá¤ › ˜š¨á­à «ž¤ «œ¢œ¬«˜å˜ š¨˜££ã «¦¬ barticl, «æ«œ Ÿ˜ › ˜š¨á¯à ¡˜  «¦ garticl
47907>>>>>>>//                           Set  piGarticl_Delete         to  1
47907>>>>>>>//                           Set  piMaster_Gmove_Delete    to  1
47907>>>>>>>//                     Case Break
47907>>>>>>>//                     Case  (Barticl.Barticl_Lines > 0) //˜¢¢¦ éª Ÿ˜ ¡á¤à edit ©«¦ garticl
47907>>>>>>>//                           Set  piGarticl_Edit           to  1
47907>>>>>>>//                           Set  piMaster_Gmove_Edit      to  1
47907>>>>>>>//                     Case Break
47907>>>>>>>//                     Case  (Barticl.Barticl_Lines < 0) //§¨æ™¢ž£˜, ¡á«  «¨â®œ 
47907>>>>>>>//                           Send Operation_Not_Allowed 9999 //«¨â¥«œ ¦¢ ¡á â¢œš®¦ ™á©žª
47907>>>>>>>//                     Case Break
47907>>>>>>>//                Case End
47907>>>>>>>
47907>>>>>>>/////////////////////Case (Barticl.Garticl_Rec0 = 0) //«¦ barticl ›â¤ â®œ  ©¬¤›œŸœå £œ master gmove
47907>>>>>>>/////////////////////     //If (Barticl.Gmove_Mrec0 <> 0) Error 1000 " djfdfsdds"
47907>>>>>>>/////////////////////Case Break
47907>>>>>>>      End_Procedure   // backout
47908>>>>>>>
47908>>>>>>>
47908>>>>>>>      Procedure Creating
47909>>>>>>>                Integer liBaxio_Status_From liBaxio_Status_To
47910>>>>>>>
47910>>>>>>>                Forward Send Creating
47912>>>>>>>
47912>>>>>>>            Move (Append('',((Trim(SysCurXR.Branch_Site))+;                             (Trim(String(Bmove.Bmove_Rec0)))))) to Bmove.Bmove_Recr
47913>>>>>>>
47913>>>>>>>
47913>>>>>>>                //˜¨ Ÿ£æª ¡ ¤ã©œà¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
47913>>>>>>>                //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBmove
47913>>>>>>>
47913>>>>>>>                //˜¨ Ÿ£æª š¨˜££é¤ barticl
47913>>>>>>>                Add 1 to Barticl.Barticl_Lines
47914>>>>>>>
47914>>>>>>>                //˜/˜ š¨˜££ãª á¨Ÿ¨¦¬
47914>>>>>>>                Add 1 to Barticl.Barticl_BmoveLa
47915>>>>>>>                Move Barticl.Barticl_BmoveLa to Bmove.Bmove_AA
47916>>>>>>>
47916>>>>>>>                //˜/˜ ¡å¤ž©žª ˜¥ ¦š¨á­¦¬
47916>>>>>>>                Add 1 to Baxio.Baxio_Bmove_Laa
47917>>>>>>>                Move Baxio.Baxio_Bmove_Laa to Bmove.Baxio_AA
47918>>>>>>>
47918>>>>>>>                //pourqua ??????
47918>>>>>>>                Get piBaxio_Status_From to liBaxio_Status_From
47919>>>>>>>                Get piBaxio_Status_To   to liBaxio_Status_To
47920>>>>>>>                //Set biBaxio_Status of liBaxio_dd to liBaxio_Status_From
47920>>>>>>>      End_Procedure //creating
47921>>>>>>>
47921>>>>>>>
47921>>>>>>>      Procedure Deleting
47922>>>>>>>                Integer liTemp
47923>>>>>>>
47923>>>>>>>                //œá¤ › ˜š¨á­à «ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬,
47923>>>>>>>                //æ¢˜ œå¤˜  ok, œå«œ «¦ ¡á¤à ˜§¦ «¦ bmove, œå«œ ˜§¦ «¦ barticl,
47923>>>>>>>                //œå«œ «œ¢ ¡á ˜§æ ¦§¦¬›ã§¦«œ !
47923>>>>>>>                //œá¤ æ£àª ›â¤ › ˜š¨á­à «ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬, ˜¢¢á ¡á§¦ ˜ á¢¢ž,
47923>>>>>>>                //§¨â§œ  ¤˜ › ˜¡æ¯à «¦ transaction, ˜¤˜¥á¨«ž«˜ ˜§¦ §¦ç «¦ â®à ¡˜¢â©œ .
47923>>>>>>>                //˜¬«æ ™â™˜ ˜ œ¢âš®œ«˜  ¡˜  ©«ž¤ validate delete, ˜¢¢á ¦¬© ˜©« ¡á §¨â§œ 
47923>>>>>>>                //¤˜ œ¢œšŸœå œ›é, › æ«  ž › ˜š¨˜­ã £§¦¨œå ¤˜ ¥œ¡ ¤ã©œ  ˜§æ cascade delete
47923>>>>>>>                //«¦¬ barticl.
47923>>>>>>>                //£œ á¢¢˜ ¢æš ˜ œ¤œ¨š¦§¦ é «ž¤ validate delete æ«˜¤ ž › ˜š¨˜­ã
47923>>>>>>>                //›â¤ ¥œ¡ ¤áœ  ˜§¦ «¦ bmove !
47923>>>>>>>                If (OPERATION_ORIGIN <> (Self));                Begin
47925>>>>>>>                     Get Validate_Delete to liTemp
47926>>>>>>>                     If (liTemp <> 0) Send Operation_Not_Allowed liTemp //á®¨ž©«¦
47929>>>>>>>                End
47929>>>>>>>>
47929>>>>>>>
47929>>>>>>>                Forward Send Deleting
47931>>>>>>>
47931>>>>>>>                //§¨é«˜ œ¤«¦§åà bkinkat
47931>>>>>>>                Move (private.fiBkinkat_Baxiokat_Code(Self,;                                    Btypkin.Btypkin_Recr,;                                    Baxiokat.Baxiokat_Code);                     ) to liTemp
47932>>>>>>>                If (liTemp = 0) Send Operation_Not_Allowed 4002 //›â¤ œ§ «¨â§œ«˜  ž ¡å¤ž©ž baxiokat_code £œ «¦ btypkin
47935>>>>>>>
47935>>>>>>>
47935>>>>>>>                //***********************************************************
47935>>>>>>>                //*    ˜§æ œ›é ¡˜  ¡á«à, â®à §¢â¦¤ active bkinkat record    *
47935>>>>>>>                //***********************************************************
47935>>>>>>>
47935>>>>>>>                //˜¨ Ÿ£æª ¡ ¤ã©œà¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
47935>>>>>>>                //jsjsjs 24/01/2001 Sub 1 from Year.Year_NumBmove
47935>>>>>>>
47935>>>>>>>                //˜¨ Ÿ£æª š¨˜££é¤ barticl
47935>>>>>>>                Sub 1 from Barticl.Barticl_Lines
47936>>>>>>>
47936>>>>>>>                //˜/˜ š¨˜££ãª á¨Ÿ¨¦¬
47936>>>>>>>                If (Bmove.Bmove_AA = Barticl.Barticl_BmoveLa);                Sub 1 from Barticl.Barticl_BmoveLa
47939>>>>>>>
47939>>>>>>>                //˜/˜ ¡å¤ž©žª ˜¥ ¦š¨á­¦¬
47939>>>>>>>                If (Bmove.Baxio_AA = Baxio.Baxio_Bmove_Laa);                Sub 1 from Baxio.Baxio_Bmove_Laa
47942>>>>>>>
47942>>>>>>>                //š.03:œ¤ž£â¨à©ž §œ›åà¤ status + place, ˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž (bkinkat)
47942>>>>>>>                //     ›ž¢˜›ã œ§˜¤˜­â¨à «¦ status ¡˜  «¦ place ˜§¦ œ¡â  §¦¬ «˜ §ã¨˜.
47942>>>>>>>                //     ™œ™˜åàª, › ˜š¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬
47942>>>>>>>                Move Bkinkat.Baxio_Stat_From to Baxio.Baxio_Status //¡˜«á©«˜ž :˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž
47943>>>>>>>                Move Bkinkat.Baxio_Plac_From to Baxio.Baxio_Place  //œ¬¨å¡œ«˜ :˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž
47944>>>>>>>
47944>>>>>>>                //œ›é Ÿ˜ §¨â§œ  ¤˜ ™á¢à ¡˜  «¦¤ §¨¦žš¦ç£œ¤¦ ˜§¦›â¡«ž ! ! ! !
47944>>>>>>>                //     ž œ¤ž£â¨à©ž §œ›åà¤ previous «¦¬ bmove š ˜ æ¢˜ «˜ ˜¥ æš¨˜­˜
47944>>>>>>>                //     âš ¤œ ©«ž¤ update §¨¦«¦ç ˜¢¢á¥à «˜ last §œ›å˜ «¦¬ baxio,
47944>>>>>>>                //     «˜ ¡¨˜«áà ©«˜
47944>>>>>>>                //     previous §œ›å˜ «¦¬ bmove,
47944>>>>>>>                //     â«©  é©«œ ©«ž¤ deleteig ¤˜ «˜ œ§˜¤˜­â¨à ©«¦ baxio
47944>>>>>>>                Move Bmove.Baxio_Pfile to Baxio.Baxio_Lfile
47945>>>>>>>                Move Bmove.Baxio_Pcode to Baxio.Baxio_Lcode
47946>>>>>>>                Move Bmove.Baxio_Pepon to Baxio.Baxio_Lepon
47947>>>>>>>                Move Bmove.Baxio_Ppar  to Baxio.Baxio_Lpar
47948>>>>>>>
47948>>>>>>>                // js 05/09/2002
47948>>>>>>>                Saverecord Barticl
47949>>>>>>>                Saverecord Baxio
47950>>>>>>>
47950>>>>>>>      End_Procedure //deleting
47951>>>>>>>
47951>>>>>>>
47951>>>>>>>      Procedure Save_Main_File
47952>>>>>>>                Forward Send Save_Main_File
47954>>>>>>>                Send private.Trexe //procedural › ˜®œå¨ ©ž bsums
47955>>>>>>>      End_Procedure//save_main_file
47956>>>>>>>
47956>>>>>>>
47956>>>>>>>      Procedure Delete_Main_File
47957>>>>>>>                Integer liTemp
47958>>>>>>>
47958>>>>>>>                Forward Send Delete_Main_File
47960>>>>>>>                Send private.Trexe //procedural › ˜®œå¨ ©ž bsums
47961>>>>>>>
47961>>>>>>>                //œá¤ › ˜š¨á­à «ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬, «æ«œ Ÿ˜ › ˜š¨á¯à ¡˜  ˜¬«æ
47961>>>>>>>                //¦¬© ˜©« ¡á ˜§æ œ›é ¡˜  £æ¤¦¤ ˜§¦ œ›é šå¤œ«˜  ž › ˜š¨˜­ã ˜¥ ¦š¨á­¦¬,
47961>>>>>>>                //œå¤˜  ¢¦ §æ¤ ž deleteing «¦¬ baxio !
47961>>>>>>>                If (Baxio.Baxio_Bmove_Laa = 0);                Begin
47963>>>>>>>
47963>>>>>>>                     //˜¨ Ÿ£æª ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
47963>>>>>>>                     //jsjsjs 26/01/2001
47963>>>>>>>                     //Sub 1 from Year.Year_NumBaxio
47963>>>>>>>
47963>>>>>>>                     //«œ¢œ¬«˜å˜ª ¡à› ¡æª ˜¨ Ÿ£æª ˜¥ ¦š¨á­¦¬
47963>>>>>>>                     If (Baxiokat.Baxio_Lcode = Baxio.Baxio_Code);                     Sub 1 from Baxiokat.Baxio_Lcode
47966>>>>>>>
47966>>>>>>>                     Delete Baxio
47967>>>>>>>                End
47967>>>>>>>>
47967>>>>>>>      End_Procedure //delete_main_file
47968>>>>>>>
47968>>>>>>>
47968>>>>>>>      Procedure Operation_Not_Allowed Integer iError_Num
47969>>>>>>>                String lsError_Message
47970>>>>>>>                Case Begin
47970>>>>>>>                     //˜§æ validate save
47970>>>>>>>                     Case (iError_Num = 5555)
47972>>>>>>>                          Move ("† ˜§¦Ÿã¡œ¬©ž ˜¡¬¨éŸž¡œ ˜§¦ «¦¤ ®¨ã©«ž");                          to lsError_Message
47973>>>>>>>                     Case Break
47974>>>>>>>                     Case (iError_Num = 1001)
47977>>>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n† «¨¦§¦§¦åž©ž œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");                          to lsError_Message
47978>>>>>>>                     Case Break
47979>>>>>>>                     Case (iError_Num = 1004)
47982>>>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n† ¡å¤ž©ž œ§ «¨â§œ«˜  £æ¤¦¤ £œ ¤â˜ ˜¥ æš¨˜­¦ !");                          to lsError_Message
47983>>>>>>>                     Case Break
47984>>>>>>>                     Case (iError_Num = 1005)
47987>>>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n† ¡å¤ž©ž œ§ «¨â§œ«˜  £æ¤¦¤ ©œ ¬§á¨®¦¤ ˜¥ æš¨˜­¦ !");                          to lsError_Message
47988>>>>>>>                     Case Break
47989>>>>>>>                     Case (iError_Num = 1006)
47992>>>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n’¦ barticl â®œ  «¨¦§¦§¦ žŸœå!");                          to lsError_Message
47993>>>>>>>                     Case Break
47994>>>>>>>                     Case (iError_Num = 1100)
47997>>>>>>>                          Move "DDC 44:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
47998>>>>>>>                     Case Break
47999>>>>>>>
47999>>>>>>>                     //˜§æ validate delete
47999>>>>>>>                     Case (iError_Num = 2001)
48002>>>>>>>                          Move ("DDC 44:€›ç¤˜«ž ž › ˜š¨˜­ã !\n\n† › ˜š¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");                          to lsError_Message
48003>>>>>>>                     Case Break
48004>>>>>>>                     Case (iError_Num = 2100)
48007>>>>>>>                          Move "DDC 44:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
48008>>>>>>>                     Case Break
48009>>>>>>>
48009>>>>>>>                     //˜§æ update
48009>>>>>>>                     Case (iError_Num = 3001)
48012>>>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\nƒâ¤ œ§ «¨â§œ«˜  ž ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬ !");                          to lsError_Message
48013>>>>>>>                     Case Break
48014>>>>>>>                     Case (iError_Num = 3002)
48017>>>>>>>                          Move ("DDC 44:‹ã €§¦›œ¡«æª «ç§¦ª €¥ ¦š¨á­¦¬ š ˜ «ž¤ ‰å¤ž©ž !\n\n‹œ "+(Trim(Btypkin.Btypkin_Descr))+;                          " ›â¤ ¡ ¤¦ç¤«˜  " + (Trim(Baxiokat.Baxiokat_Descr)));                          to lsError_Message
48018>>>>>>>                     Case Break
48019>>>>>>>
48019>>>>>>>                     //˜§æ deleting
48019>>>>>>>                     Case (iError_Num = 4002)
48022>>>>>>>                          Move ("DDC 44:‹ã €§¦›œ¡«æª «ç§¦ª €¥ ¦š¨á­¦¬ š ˜ «ž¤ ƒ ˜š¨˜­ã !\n\n‹œ "+(Trim(Btypkin.Btypkin_Descr))+;                          " ›â¤ ¡ ¤¦ç¤«˜  " + (Trim(Baxiokat.Baxiokat_Descr)));                          to lsError_Message
48023>>>>>>>                     Case Break
48024>>>>>>>
48024>>>>>>>                     //˜§æ private.Transaction_Update_Other_Modules
48024>>>>>>>                     Case (iError_Num = 5001) //›â¤ £§æ¨œ©˜ ¤˜ ¥˜¤˜™¨é barticl by recnum!
48027>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Barticl Recnum Not Found)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
48028>>>>>>>                     Case Break
48029>>>>>>>                     Case (iError_Num = 5002) //›â¤ £§æ¨œ©˜ ¤˜ ¥˜¤˜™¨é bsum by recnum!
48032>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Bsum Recnum Not Found)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
48033>>>>>>>                     Case Break
48034>>>>>>>                     Case (iError_Num = 5003) //«¦ create master âš ¤œ ©œ ã›ž ©¬¤›œ›œ£â¤¦ barticl
48037>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Create Master on Connected B Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
48038>>>>>>>                     Case Break
48039>>>>>>>                     Case (iError_Num = 5004) //«¦ create master âš ¤œ ©œ £ã Ÿœ« ¡á gl records
48042>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Create Master on Non Positive GL Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
48043>>>>>>>                     Case Break
48044>>>>>>>                     Case (iError_Num = 5005) //«¦ edit master âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤˜ barticl records
48047>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Edit Master on Non Connected B Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
48048>>>>>>>                     Case Break
48049>>>>>>>                     Case (iError_Num = 5006) //«¦ edit master ›â¤ âš ¤œ ©«˜ å› ˜ master records
48052>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Edit Master not on Same Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
48053>>>>>>>                     Case Break
48054>>>>>>>                     Case (iError_Num = 5007) //«¦ create slave âš ¤œ ©œ œå¤˜  ã›ž ©¬¤›œ›œ£â¤¦ bsum
48057>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Create Slave on Connected B Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
48058>>>>>>>                     Case Break
48059>>>>>>>                     Case (iError_Num = 5008) //«¦ create slave âš ¤œ ©œ £ã Ÿœ« ¡æ gl record
48062>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Create Slave on Non Positive GL Record)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
48063>>>>>>>                     Case Break
48064>>>>>>>                     Case (iError_Num = 5009) //«¦ edit slave âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤¦ record
48067>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Edit Slave on Non Connected B Record)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
48068>>>>>>>                     Case Break
48069>>>>>>>                     Case (iError_Num = 5010) //«¦ edit slave ›â¤ âš ¤œ ©«¦ å› ¦ slave record
48072>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Edit Slave not on Same Record)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
48073>>>>>>>                     Case Break
48074>>>>>>>                     Case (iError_Num = 5011) //«¦ delete master âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤˜ records
48077>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Delete Master on Non Connected B Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
48078>>>>>>>                     Case Break
48079>>>>>>>                     Case (iError_Num = 5012) //«¦ delete master ›â¤ â›à©œ £ž›œ¤ ¡á master records «žª š¢
48082>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Delete Master not with 0 GL Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
48083>>>>>>>                     Case Break
48084>>>>>>>
48084>>>>>>>                     //˜§æ private.trexe (save+delete main file)
48084>>>>>>>                     Case (iError_Num = 6001) //¢áŸ¦ª «¦¬ ¡é› ¡˜
48087>>>>>>>                          Move ("DDC 44:Transaction Aborted! (€¡˜«á¢¢ž¢¦ §¨æ©ž£¦)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «ž¢œ­à¤ã©«œ ©«ž¤ Solution!") to lsError_Message
48088>>>>>>>                     Case Break
48089>>>>>>>                     Case (iError_Num = 6002) //¢áŸ¦ª «¦¬ ¡é› ¡˜
48092>>>>>>>                          Move ("DDC 44:Transaction Aborted! (update=0 + backout=0)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «ž¢œ­à¤ã©«œ ©«ž¤ Solution!") to lsError_Message
48093>>>>>>>                     Case Break
48094>>>>>>>
48094>>>>>>>                     Case Else
48094>>>>>>>                          Forward Send Operation_Not_Allowed iError_Num
48096>>>>>>>                Case End
48096>>>>>>>
48096>>>>>>>                Error iError_Num lsError_Message
48097>>>>>>>>
48097>>>>>>>      End_Procedure // operation_not_allowed
48098>>>>>>>
48098>>>>>>>
48098>>>>>>>
48098>>>>>>>
48098>>>>>>>     //1001:Baxio_AA = baxio_bmove_laa (editing £æ¤¦¤ ©«¦¤ «œ¢œ¬«˜å¦ ˜˜ ¡å¤ž©žª «¦¬ ˜¥ ¦š¨á­¦¬)
48098>>>>>>>     //1002:create a new bmove £æ¤¦¤ œá¤ «¦ baxio_status <> œ¥¦­¢ž£â¤¦
48098>>>>>>>     //1003:˜§˜š¦¨œçœ«˜  «¦ bmove ¤˜ ˜¢¢áœ  parent barticl
48098>>>>>>>     //1004:˜§˜š¦¨œçœ«˜  «¦ bmove ¤˜ ˜¢¢áœ  parent baxiokat
48098>>>>>>>     //1005:œá¤ ž ¡å¤ž©ž ž«áœ  ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬
48098>>>>>>>     //     ¡˜  ¡á¤à create bmove, §¨â§œ  ¤˜ â®à ¡á¤œ  ¡˜  create baxio
48098>>>>>>>     //1006:›â¤ œ§ «¨â§œ«˜  save ©«¦ bmove, œá¤ «¦ barticl â®œ  šå¤œ  edit
48098>>>>>>>     //     ¡˜  ›â¤ â®œ  «¨â¥œ  ž request_save
48098>>>>>>>     //1007
48098>>>>>>>     //1008
48098>>>>>>>     //?1009:m_code:ž œšš¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ˜§¦ ¦ module §¦¬ «ž¤ ›ž£ ¦ç¨šž©œ
48098>>>>>>>      Function Validate_Save Returns Integer
48099>>>>>>>               Integer iReturnVal liBarticl_dd_Changed isNO
48100>>>>>>>
48100>>>>>>>               Forward Get Validate_Save to iReturnVal
48102>>>>>>>
48102>>>>>>>               If (Not(iReturnVal));               Begin
48104>>>>>>>
48104>>>>>>>//                If (Baxio.Baxio_HmniaL<Barticl.Barticl_Hmnia) Begin
48104>>>>>>>//                    Get YesNo_Box '† ž£œ¨¦£ž¤å˜ «žª œ§ «˜šãª œå¤˜ \n§¨¦šœ¤â©«œ¨ž «žª ž£œ¨¦£ž¤å˜ª «¦¬ §˜¨˜©«˜« ¡¦ç.\nŒ˜ ©¬¤œ®å©à ?' to isNO
48104>>>>>>>//                    If (isNO=MBR_NO) Send Operation_Not_Allowed 5555
48104>>>>>>>//                End
48104>>>>>>>
48104>>>>>>>                //---------â¢œš®¦  ›ž£ ¦¬¨šå˜ª ¤â¦¬ bmove record----------------------
48104>>>>>>>                If (Bmove.Recnum =  0);                Begin //œá¤ ›ž£ ¦¬¨šé ¤â¦ bmove record
48106>>>>>>>                      //1005:š ˜ ¤˜ ›œ®Ÿé «ž¤ ›ž£ ¦¬¨šå˜ ¤â¦¬ baxio record, §¨â§œ :
48106>>>>>>>                      //     1.œá¤ ž ¡å¤ž©ž ž«áœ  «ž¤ ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬,
48106>>>>>>>                      //       «æ«œ §¨â§œ  ¤˜ â®à æ¤«àª ¡á¤œ  ¡˜  create baxio.
48106>>>>>>>                      //     2.œá¤ ž ¡å¤ž©ž ›â¤ ž«áœ  «ž¤ ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬,
48106>>>>>>>                      //       «æ«œ ›â¤ §¨â§œ  ¤˜ â®à ¡á¤œ  ¡˜  create baxio.
48106>>>>>>>                      If ((piCan_Create_Baxio(Self)) = TRUE);                      Begin
48108>>>>>>>                      If (Not(;                              ((piCreated_Baxio(piBaxio_dd(Self))) = TRUE);                         )) Send Operation_Not_Allowed 1004 //ž ¡å¤ž©ž œ§ «¨â§œ«˜  £æ¤¦¤ £œ ¤â˜ ˜¥ æ§š¨˜­¦
48111>>>>>>>                      End
48111>>>>>>>>
48111>>>>>>>                      Else;                      Begin
48112>>>>>>>                      If (Not(;                              ((piCreated_Baxio(piBaxio_dd(Self))) = FALSE);                         )) Send Operation_Not_Allowed 1005 //ž ¡å¤ž©ž œ§ «¨â§œ«˜  £æ¤¦¤ ©œ ¬§á¨®¦¤ ˜¥ æ§š¨˜­¦
48115>>>>>>>                      End
48115>>>>>>>>
48115>>>>>>>
48115>>>>>>>                      //1002:create a new bmove £æ¤¦¤ œá¤ «¦ baxio_status <> œ¥¦­¢ž£â¤¦
48115>>>>>>>                      //If (Not(;
48115>>>>>>>                      //        (Baxio.Baxio_Old_Status <> 2);
48115>>>>>>>                      //   )) Send Operation_Not_Allowed 1002
48115>>>>>>>                End   //«â¢¦ª œ¢âš®à¤ ›ž£ ¦¬¨šå˜ª ¤â¦¬ bmove record
48115>>>>>>>>
48115>>>>>>>
48115>>>>>>>
48115>>>>>>>                //---------â¢œš®¦  editing existing bmove records---------------------
48115>>>>>>>                Else;                Begin //edit an existing record
48116>>>>>>>                      //1001:Baxio_AA = baxio_bmove_laa (editing £æ¤¦¤ ©«¦¤ «œ¢œ¬«˜å¦ ˜˜ ¡å¤ž©žª «¦¬ ˜¥ ¦š¨á­¦¬)
48116>>>>>>>                      If (Not(;                              (Baxio.Baxio_Bmove_Laa = Bmove.Baxio_AA);                         )) Send Operation_Not_Allowed 1001
48119>>>>>>>                End   //«â¢¦ª œ¢âš®à¤ editing existing bmove records
48119>>>>>>>>
48119>>>>>>>
48119>>>>>>>/////////////// js 07/08/2001  07-08-2001
48119>>>>>>>             // Ž ¡à› ¡˜ª ˜¬«¦ª £§ž¡œ remarks š ˜«  ž ¢¦š ¡ž £˜ª £œ©à «¦¬ ˜¤¦ ¥œ / ¡¢œ ©œ
48119>>>>>>>             // ¡˜  «¦ ©«ž© £¦ «žª œ­˜¨£¦šžª œ ¤˜  «œ«¦ ˜ §¦¬ ›œ¤ š ¤œ«˜  ˜¢¢ à©ž
48119>>>>>>>             // ˜§¦ ˜¢¢¦ ©ž£œ ¦ ©«¦ Barticl, ¡˜  œ§ §¢œ¦¤ ™˜¨˜œ  ¦«˜¤ ˜¤¦ š¦¡¢œ ¤œ 
48119>>>>>>>             // «¦ §˜¨˜©«˜« ¡¦ (§¨¦­˜¤àª š ˜«  £ž›œ¤ ¦¬¤ «˜ properties §¨¦ ¡˜  £œ«˜
48119>>>>>>>             // ˜§¦ «ž¤ private.Initialize_Properties
48119>>>>>>>//                //1006:›â¤ œ§ «¨â§œ«˜  save ©«¦ bmove, œá¤ «¦ barticl â®œ  šå¤œ  edit
48119>>>>>>>//                //     ¡˜  ›â¤ â®œ  «¨â¥œ  ž request_save
48119>>>>>>>//                Get Changed_State of (piBarticl_dd(Self)) to liBarticl_dd_Changed
48119>>>>>>>//                If (liBarticl_dd_Changed = TRUE) Send Operation_Not_Allowed 1006
48119>>>>>>>/////////////// js 07/08/2001  07-08-2001
48119>>>>>>>
48119>>>>>>>
48119>>>>>>>                
48119>>>>>>>
48119>>>>>>>                //1100:cby = globals
48119>>>>>>>                If ( ;                    (Not(Bmove.Company_Code = SysCurXr.Company_Code)) or;                    (Not(Bmove.Branch_Code  = SysCurXr.Branch_Code )) or;                    (Not(Bmove.Year_Year    = SysCurXr.Year_Year   ));                    )                                                   Send Operation_Not_Allowed 1100
48122>>>>>>>
48122>>>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
48122>>>>>>>>
48122>>>>>>>               Function_Return iReturnVal
48123>>>>>>>      End_Function //validate_save
48124>>>>>>>
48124>>>>>>>
48124>>>>>>>      //2001:Baxio_AA = baxio_bmove_laa (delete £æ¤¦¤ «¦¤ «œ¢œ¬«˜å¦ ˜˜ ¡å¤ž©žª «¦¬ ˜¥ ¦š¨á­¦¬)
48124>>>>>>>      Function Validate_Delete  Returns Integer
48125>>>>>>>               Integer iReturnVal
48126>>>>>>>               Forward Get Validate_Delete  To iReturnVal
48128>>>>>>>               If (Not(iReturnVal));               Begin
48130>>>>>>>
48130>>>>>>>                //2001:â¢œš®¦ª «œ¢œ¬«˜å¦¬ ˜˜ ¡å¤ž©žª ˜¥ ¦š¨á­¦¬
48130>>>>>>>                If (Not(Bmove.Baxio_AA = Baxio.Baxio_Bmove_Laa))       Send Operation_Not_Allowed 2001
48133>>>>>>>                If ( ;                    (Not(Bmove.Company_Code = SysCurXr.Company_Code)) or;                    (Not(Bmove.Branch_Code  = SysCurXr.Branch_Code )) or;                    (Not(Bmove.Year_Year    = SysCurXr.Year_Year   ));                    )                                                   Send Operation_Not_Allowed 2100
48136>>>>>>>
48136>>>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
48136>>>>>>>>
48136>>>>>>>               Function_Return iReturnVal
48137>>>>>>>      End_Function //validate_delete
48138>>>>>>>
48138>>>>>>>
48138>>>>>>>      Procedure Request_Save
48139>>>>>>>                Integer liBaxiokat_Code liBaxio_Allow_Foreign_New_Save_State iErrorObj
48140>>>>>>>                String  lsBtypkin_Recr
48140>>>>>>>                //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties §¦¬ ˜­¦¨¦ç¤ «¦ transaction
48140>>>>>>>                Send private.Initialize_Properties
48141>>>>>>>                //˜¤áš¤à©ž «¨â®¦¬©˜ª ¡˜«á©«˜©žª «¦¬ baxio_dd
48141>>>>>>>                Get Allow_Foreign_New_Save_State of (piBaxio_dd(Self)) to liBaxio_Allow_Foreign_New_Save_State
48142>>>>>>>
48142>>>>>>>                //«¦ bkinkat_yn_new ¨¬Ÿ£åœ  œá¤ Ÿ˜ ¡á¤à œ ©˜šàšã ¤â¦¬ ˜¥ ¦š¨á­¦¬
48142>>>>>>>                Get File_Field_Current_Value File_Field Btypkin.Btypkin_Recr   to lsBtypkin_Recr
48143>>>>>>>                Get File_Field_Current_Value File_Field Baxiokat.Baxiokat_Code to liBaxiokat_Code
48144>>>>>>>
48144>>>>>>>                Clear Bkinkat
48145>>>>>>>                Move SysCurXr.Company_Code   to Bkinkat.Company_Code
48146>>>>>>>                Move SysCurXr.Branch_Code    to Bkinkat.Branch_Code
48147>>>>>>>                Move SysCurXr.Year_Year      to Bkinkat.Year_Year
48148>>>>>>>                Move lsBtypkin_Recr  to Bkinkat.Btypkin_Recr
48149>>>>>>>                Move liBaxiokat_Code to Bkinkat.Baxiokat_Code
48150>>>>>>>                Find Eq Bkinkat by Index.3 //company+branch+Year+btypkin_recr+baxiokat_code
48151>>>>>>>>
48151>>>>>>>                If (Found = 0) Begin //›â¤ œ§ «¨â§œ«˜  ž ¡å¤ž©ž baxiokat_code £œ «¦ btypkin
48153>>>>>>>                                Send Operation_Not_Allowed 3002
48154>>>>>>>                               End
48154>>>>>>>>
48154>>>>>>>
48154>>>>>>>                If (Bkinkat.Bkinkat_YN_New  = TRUE);                     Begin //œ ©˜šàšã ¤â¦¬ ˜¥ ¦š¨á­¦¬, á¨˜ œ§ «¨â§à «¦ create ©«¦ baxio
48156>>>>>>>                      Set Allow_Foreign_New_Save_State of (piBaxio_dd(Self)) to TRUE
48157>>>>>>>                      Set piCan_Create_Baxio                                 to TRUE
48158>>>>>>>                     End
48158>>>>>>>>
48158>>>>>>>                Else Begin //› ˜¡å¤ž©ž ¬§á¨®¦¤«¦ª ˜¥ ¦š¨á­¦¬, á¨˜ ›â¤ œ§ «¨â§à «¦ create ©«¦ baxio
48159>>>>>>>                      Set Allow_Foreign_New_Save_State of (piBaxio_dd(Self)) to FALSE
48160>>>>>>>                      Set piCan_Create_Baxio                                 to FALSE
48161>>>>>>>                     End
48161>>>>>>>>
48161>>>>>>>
48161>>>>>>>                Forward Send Request_Save
48163>>>>>>>
48163>>>>>>>                //œ§˜¤˜¤˜­¦¨á ˜¨® ¡ãª ¡˜«á©«˜©žª «¦¬ baxio_dd
48163>>>>>>>                Set Allow_Foreign_New_Save_State of (piBaxio_dd(Self)) to liBaxio_Allow_Foreign_New_Save_State
48164>>>>>>>                Set Smart_Filemode_State to True
48165>>>>>>>                //£ž›œ¤ ©£æª properties š ˜ œ§æ£œ¤ž ¡å¤ž©ž
48165>>>>>>>                Send private.Initialize_Properties
48166>>>>>>>                //œ§˜¤˜­¦¨á «¦¬ system indicator err
48166>>>>>>>                Indicate Err False
48167>>>>>>>      End_Procedure //request_save
48168>>>>>>>
48168>>>>>>>
48168>>>>>>>      Procedure Request_Delete
48169>>>>>>>                Integer iErrorObj
48170>>>>>>>                Send private.Initialize_Properties //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties
48171>>>>>>>                Forward Send Request_Delete
48173>>>>>>>                Send private.Initialize_Properties //£ž›œ¤ ©£æª properties š ˜ œ§æ£œ¤ž ¡å¤ž©ž
48174>>>>>>>                //œ§˜¤˜­¦¨á «¦¬ system indicator err
48174>>>>>>>                Indicate Err False
48175>>>>>>>      End_Procedure   //request_delete
48176>>>>>>>
48176>>>>>>>
48176>>>>>>>//      //ž ¨¦¬«å¤˜ ˜¬«ã ˜¤˜¢˜£™á¤œ  ¤˜ œ¤ž£œ¨é©œ  æ©˜ ˜§¦ «˜ ¬§æ¢¦ §˜ 3 modules «¦¬ ©¬©«ã£˜«¦ª
48176>>>>>>>//      //§¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤.
48176>>>>>>>//      //¡˜¢œå«˜  ˜§æ « ª request save & delete, £â©˜ ˜§æ transaction.
48176>>>>>>>//      //œ§ ©«¨â­œ  ¢áŸž : 5001 - 5012 š ˜ «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã
48176>>>>>>>//      Procedure private.Transaction_Update_Other_Modules
48176>>>>>>>//                Integer liDo_GL_Maintainance liDo_CUSTOMER_Maintainance liDo_VENDOR_Maintainance
48176>>>>>>>//                Integer liMust_Update_GL     liMust_Update_CUSTOMER     liMust_Update_VENDOR
48176>>>>>>>
48176>>>>>>>//                //š ˜ «ž¤ œç¨œ©ž «¦¬ bsum
48176>>>>>>>//                String lsBaxiokat_Recr
48176>>>>>>>
48176>>>>>>>//                //final values, š ˜ «ã¤ feedback œ¤ž£â¨à©ž «¦¬ barticl & bsum ˜§¦ «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã
48176>>>>>>>//                Integer liF_Garticl_Rec0 liF_Gmove_Master_Rec0 liF_Gmove_Slave_Rec0
48176>>>>>>>
48176>>>>>>>//                //final values, š ˜ «ã¤ feedback œ¤ž£â¨à©ž «¦¬ barticl ˜§¦ «¦çª §œ¢á«œª
48176>>>>>>>//                Integer liF_Carticl_Rec0 liF_Cmove_Rec0
48176>>>>>>>
48176>>>>>>>//                //final values, š ˜ «ã¤ feedback œ¤ž£â¨à©ž «¦¬ barticl ˜§¦ «¦çª §¨¦£žŸœ¬«âª
48176>>>>>>>//                Integer liF_Varticl_Rec0 liF_Vmove_Rec0
48176>>>>>>>
48176>>>>>>>//               //4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
48176>>>>>>>//               Integer liFlag02 liFlag03 liFlag04 liFlag05
48176>>>>>>>
48176>>>>>>>
48176>>>>>>>//                //œç¨œ©ž «à¤ ¢¦ §é¤ modules §¦¬ §¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤
48176>>>>>>>//                Get Field_Current_Value of (piBtypkin_dd(Self)) Field Btypkin.Gtypkin_Rec0 to liMust_Update_GL
48176>>>>>>>//                Get Field_Current_Value of (piBtypkin_dd(Self)) Field Btypkin.Ctypkin_Rec0 to liMust_Update_CUSTOMER
48176>>>>>>>//                Get Field_Current_Value of (piBtypkin_dd(Self)) Field Btypkin.Vtypkin_Rec0 to liMust_Update_VENDOR
48176>>>>>>>
48176>>>>>>>//               //˜¤áš¤à©ž «à¤ 4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
48176>>>>>>>//               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag02 to liFlag02
48176>>>>>>>//               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag03 to liFlag03
48176>>>>>>>//               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag04 to liFlag04
48176>>>>>>>//               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag05 to liFlag05
48176>>>>>>>
48176>>>>>>>
48176>>>>>>>//                //                                                  s  l  a  v  e  = bsum
48176>>>>>>>//                //                                        edit        create        delete
48176>>>>>>>//                //                                       -----        ------        ------
48176>>>>>>>//                // master garticl + gmove     edit         x            x              x
48176>>>>>>>//                //                            create                    x
48176>>>>>>>//                //                            delete                                   x
48176>>>>>>>//                // slave  gmove               edit         x            x              x
48176>>>>>>>//                //                            create                    x
48176>>>>>>>//                //                            delete                                   x
48176>>>>>>>
48176>>>>>>>
48176>>>>>>>//                If (;
48176>>>>>>>//                    ( liMust_Update_Gl     > 0                   ) and;
48176>>>>>>>//                    ((pnB_Baxio_V2(Self)) <> (pnA_Baxio_V2(Self)));
48176>>>>>>>//                   );
48176>>>>>>>//                Begin //edit œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ ˜¥å˜ v2 !
48176>>>>>>>//                //***************************************************************************
48176>>>>>>>//                //*  €  • †    „ Œ † ‹ „  — ‘ † ‘    ‚ „ Œ ˆ ‰ † ‘    Š Ž ‚ ˆ ‘ ’ ˆ ‰ † ‘ *
48176>>>>>>>//                //***************************************************************************
48176>>>>>>>//                //œ­'æ©¦¤ «¦ bmove record ©éŸž¡œ/› ˜š¨á­ž¡œ ¡˜¤¦¤ ¡á, §¨¦®à¨áà ©«ž¤ bpo
48176>>>>>>>//                //š ˜ «ž¤ œ¤ž£â¨à©ž «žª šœ¤ ¡ãª ¢¦š ©« ¡ãª, œá¤ æ£àª ®¨œ áœ«˜ ]
48176>>>>>>>
48176>>>>>>>//// jsjsjs 24/01/2001
48176>>>>>>>////                Send Transaction_BCVWmove_Update_GL to (piDo_GL_Maintainance(Self)) (Self);
48176>>>>>>>////                                                                                    liFlag02;
48176>>>>>>>////                                                                                    liFlag03;
48176>>>>>>>////                                                                                    liFlag04;
48176>>>>>>>////                                                                                    liFlag05
48176>>>>>>>//// jsjsjs 24/01/2001
48176>>>>>>>
48176>>>>>>>//                //œ­'æ©¦¤ ¡˜  «¦ bmove record ©éŸž¡œ/› ˜š¨á­ž¡œ ¡˜¤¦¤ ¡á,
48176>>>>>>>//                //¡˜  ž bpo â«¨œ¥œ ®à¨åª error,  ¡˜«˜®à¨é «¦ transaction
48176>>>>>>>//                //¡˜  œ¤ž£œ¨é¤à «© ©®œ« ¡á ˜¨®œå˜, › ˜™á¦¤«˜ª «˜
48176>>>>>>>//                //3 properties §¦¬ â®œ  œ§ ©«¨â¯œ  ž bpo œ¤ž£â¨à©žª «žª š¢
48176>>>>>>>//                Get piF_Garticl_Rec0      to liF_Garticl_Rec0       //barticl
48176>>>>>>>//                Get piF_Gmove_Master_Rec0 to liF_Gmove_Master_Rec0  //barticl
48176>>>>>>>//                Get piF_Gmove_Slave_Rec0  to liF_Gmove_Slave_Rec0   //bmove
48176>>>>>>>
48176>>>>>>>//                //œ¤ž£â¨à©ž bmove & barticl & bsum š ˜ « ª œšš¨˜­âª ©«á á¢¢˜ modules
48176>>>>>>>//                //œç¨œ©ž barticl, › æ«  œå¤˜  ˜§˜¨˜å«ž«¦ ©œ æ¢˜ «˜ operations
48176>>>>>>>//                Clear Barticl
48176>>>>>>>//                Get Current_Record of (piBarticl_dd(Self)) to Barticl.Recnum
48176>>>>>>>//                Find Eq Barticl.Recnum
48176>>>>>>>//                If (Found = 0);
48176>>>>>>>//                Begin //›â¤ £§æ¨œ©˜ ¤˜ ™¨é barticl by recnum
48176>>>>>>>//                      Send Operation_Not_Allowed 5001
48176>>>>>>>//                End
48176>>>>>>>
48176>>>>>>>//                //=======================================================================
48176>>>>>>>//                //œ­'æ©¦¤ ¡á¤à create or edit ©«¦ bmove,
48176>>>>>>>//                //™á©œ  «¦¬ §å¤˜¡˜ ©«¦ master ¡á¤à create or edit
48176>>>>>>>//                If ((piUpdate(Self)) = TRUE);
48176>>>>>>>//                Begin
48176>>>>>>>//                     //œç¨œ©ž bsum, «¦ ¦§¦å¦ ®¨œ áœ«˜  £æ¤¦¤ œ›é ¡˜  æ®  ©«ž¤ ¦¢ ¡ã › ˜š¨˜­ã «¦¬ garticl
48176>>>>>>>//                     Get Field_Current_Value of (piBaxiokat_dd(Self)) Field Baxiokat.Baxiokat_Recr to lsBaxiokat_Recr
48176>>>>>>>//                     Clear Bsum
48176>>>>>>>//                     Move Barticl.Barticl_Recr to Bsum.Barticl_Recr
48176>>>>>>>//                     Move lsBaxiokat_Recr      to Bsum.Baxiokat_Recr
48176>>>>>>>//                     Find Eq Bsum by Index.1 //barticl_recr+baxiokat_recr !!!!!!
48176>>>>>>>//                     If (Found=0);
48176>>>>>>>//                     Begin //›â¤ £§æ¨œ©˜ ¤˜ ™¨é bsum by recnum
48176>>>>>>>//                           Send Operation_Not_Allowed 5002
48176>>>>>>>//                     End
48176>>>>>>>
48176>>>>>>>//                     //œ¤ž£â¨à©ž master (create or edit)
48176>>>>>>>//                     Case Begin
48176>>>>>>>//                          //©«¦ create master, §¨â§œ  ž ©ç¤›œ©ž ¤© šå¤œ  «é¨˜,
48176>>>>>>>//                          //›ž¢˜›ã §¨â§œ  ¡˜  «˜ 2 §œ›å˜ ¤˜ œå¤˜  0,
48176>>>>>>>//                          //œ¤é «˜ master records «žª š¢ §¨â§œ  ¤˜ â®¦¬¤ Ÿœ« ¡ã « £ã.
48176>>>>>>>//                          Case ((piGarticl_Create(Self)) = TRUE)
48176>>>>>>>//                               If (;
48176>>>>>>>//                                    (Barticl.Garticl_Rec0 <> 0) or;
48176>>>>>>>//                                    (Barticl.Gmove_Mrec0  <> 0);
48176>>>>>>>//                                  ) Send Operation_Not_Allowed 5003 //«¦ create master âš ¤œ ©œ ã›ž ©¬¤›œ›œ£â¤¦ barticl
48176>>>>>>>//                               If (;
48176>>>>>>>//                                    (liF_Garticl_Rec0       <= 0) or;
48176>>>>>>>//                                    (liF_Gmove_Master_Rec0  <= 0);
48176>>>>>>>//                                  ) Send Operation_Not_Allowed 5004 //«¦ create master âš ¤œ ©œ £ã Ÿœ« ¡á gl records
48176>>>>>>>//                               Move liF_Garticl_Rec0      to Barticl.Garticl_Rec0 //©ç¤›œ©ž £œ garticl
48176>>>>>>>//                               Move liF_Gmove_Master_Rec0 to Barticl.Gmove_Mrec0  //©ç¤›œ©ž £œ master gmove
48176>>>>>>>//                               Saverecord Barticl
48176>>>>>>>//                          Case Break
48176>>>>>>>
48176>>>>>>>//                          //©«¦ edit master, §¨â§œ  ž ©ç¤›œ©ž ã›ž ¤˜ ¬§á¨®œ ,
48176>>>>>>>//                          //›ž¢˜›ã §¨â§œ  ¡˜  «˜ 2 §œ›å˜ ¤˜ œå¤˜  > 0
48176>>>>>>>//                          //¡˜  £á¢ ©«˜ ¤˜ © š¦¬¨œ¬«¦ç£œ æ«  ¡á¤˜£œ œ¤ž£â¨à©ž «žª š¢ ©«˜ å› ˜ master records
48176>>>>>>>//                          Case Else
48176>>>>>>>//                               If (;
48176>>>>>>>//                                    (Barticl.Garticl_Rec0 <= 0) or;
48176>>>>>>>//                                    (Barticl.Gmove_Mrec0  <= 0);
48176>>>>>>>//                                  ) Send Operation_Not_Allowed 5005 //«¦ edit master âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤˜ records
48176>>>>>>>//                               If (;
48176>>>>>>>//                                    (liF_Garticl_Rec0      <> Barticl.Garticl_Rec0) or;
48176>>>>>>>//                                    (liF_Gmove_Master_Rec0 <> Barticl.Gmove_Mrec0 );
48176>>>>>>>//                                  ) Send Operation_Not_Allowed 5006 //«¦ edit master ›â¤ âš ¤œ ©«˜ å› ˜ master records
48176>>>>>>>//                          Case Break
48176>>>>>>>//                     Case End //«â¢¦ª œ¤ž£â¨à©žª master
48176>>>>>>>
48176>>>>>>>//                     //œ¤ž£â¨à©ž slave (create or edit)
48176>>>>>>>//                     Case Begin
48176>>>>>>>//                          //©«¦ create slave, §¨â§œ  ž ©ç¤›œ©ž ¤˜ šå¤œ  «é¨˜,
48176>>>>>>>//                          //›ž¢˜›ã §¨â§œ  «o 1 §œ›åo ¤˜ œå¤˜  0,
48176>>>>>>>//                          //œ¤é «o slave record «žª š¢ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã « £ã.
48176>>>>>>>//                          Case ((piSlave_Gmove_Create(Self)) = TRUE)
48176>>>>>>>//                               If (Bsum.Gmove_Srec0 <> 0);
48176>>>>>>>//                                    Send Operation_Not_Allowed 5007 //«¦ create slave âš ¤œ ©œ œå¤˜  ã›ž ©¬¤›œ›œ£â¤¦ bsum
48176>>>>>>>//                               If (liF_Gmove_Slave_Rec0  <= 0);
48176>>>>>>>//                                    Send Operation_Not_Allowed 5008 //«¦ create slave âš ¤œ ©œ £ã Ÿœ« ¡æ gl record
48176>>>>>>>//                               Move liF_Gmove_Slave_Rec0  to Bsum.Gmove_Srec0     //©ç¤›œ©ž £œ slave gmove
48176>>>>>>>//                               Saverecord Bsum
48176>>>>>>>//                          Case Break
48176>>>>>>>
48176>>>>>>>//                          //©«¦ edit slave, §¨â§œ  ž ©ç¤›œ©ž ã›ž ¤˜ ¬§á¨®œ ,
48176>>>>>>>//                          //›ž¢˜›ã §¨â§œ  «¦ 1 §œ›å¦ ¤˜ œå¤˜  > 0
48176>>>>>>>//                          //¡˜  £á¢ ©«˜ ¤˜ © š¦¬¨œ¬«¦ç£œ æ«  ¡á¤˜£œ œ¤ž£â¨à©ž «žª š¢ ©«¦ å› ¦ slave record
48176>>>>>>>//                          Case Else
48176>>>>>>>//                               If (Bsum.Gmove_Srec0 =  0);
48176>>>>>>>//                                    Send Operation_Not_Allowed 5009 //«¦ edit slave âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤¦ record
48176>>>>>>>//                               If (liF_Gmove_Slave_Rec0  <> Bsum.Gmove_Srec0);
48176>>>>>>>//                                    Send Operation_Not_Allowed 5010 //«¦ edit slave ›â¤ âš ¤œ ©«¦ å› ¦ slave record
48176>>>>>>>//                          Case Break
48176>>>>>>>//                     Case End //«â¢¦ª œ¤ž£â¨à©žª slave
48176>>>>>>>//                End //«â¢¦ª œ¤ž£â¨à©žª edit or create bmove & barticl & bsum š ˜ « ª œšš¨˜­âª ©«á á¢¢˜ modules
48176>>>>>>>//                //=======================================================================
48176>>>>>>>
48176>>>>>>>//                //œ­'æ©¦¤ ©™ã¤à «ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ barticl,
48176>>>>>>>//                //®à¨åª æ£àª ¤˜ ©™ã©à ˜¬«æ,
48176>>>>>>>//                //£ž›œ¤åà ©«¦ barticl «¦ Garticl_Rec0 & Gmove_Mrec0,
48176>>>>>>>//                //š ˜ ¤˜ ˜§¦©¬¤›â©à «¦ barticl ˜§¦ «¦ garticl & «¦ gmove
48176>>>>>>>//                If ((piGarticl_Delete(Self)) = TRUE);
48176>>>>>>>//                Begin
48176>>>>>>>//                     //©«¦ delete master, §¨â§œ  ž ©ç¤›œ©ž ã›ž ¤˜ ¬§á¨®œ ,
48176>>>>>>>//                     //›ž¢˜›ã §¨â§œ  ¡˜  «˜ 2 §œ›å˜ ¤˜ œå¤˜  > 0
48176>>>>>>>//                     //¡˜  £á¢ ©«˜ ¤˜ © š¦¬¨œ¬«¦ç£œ æ«  «˜ master records «žª š¢ œå¤˜  £ž›œ¤ ¡á
48176>>>>>>>//                     If (;
48176>>>>>>>//                          (Barticl.Garticl_Rec0 <= 0) or;
48176>>>>>>>//                          (Barticl.Gmove_Mrec0  <= 0);
48176>>>>>>>//                        ) Send Operation_Not_Allowed 5011 //«¦ delete master âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤˜ records
48176>>>>>>>//                     If (;
48176>>>>>>>//                          (liF_Garticl_Rec0      <> 0) or;
48176>>>>>>>//                          (liF_Gmove_Master_Rec0 <> 0);
48176>>>>>>>//                        ) Send Operation_Not_Allowed 5012 //«¦ delete master ›â¤ â›à©œ £ž›œ¤ ¡á master records «žª š¢
48176>>>>>>>//                     Move liF_Garticl_Rec0      to Barticl.Garticl_Rec0 //˜§¦©ç¤›œ©ž £œ garticl
48176>>>>>>>//                     Move liF_Gmove_Master_Rec0 to Barticl.Gmove_Mrec0  //˜§¦˜ç¤›œ©ž £œ master gmove
48176>>>>>>>//                     Saverecord Barticl
48176>>>>>>>//                End //«â¢¦ª ˜§¦©ç¤›œ©žª barticl ˜§¦ garticl & gmove
48176>>>>>>>//                //****************************************************************************
48176>>>>>>>//                //* ’ „ Š Ž ‘    „ Œ † ‹ „  — ‘ † ‘    ‚ „ Œ ˆ ‰ † ‘    Š Ž ‚ ˆ ‘ ’ ˆ ‰ † ‘ *
48176>>>>>>>//                //****************************************************************************
48176>>>>>>>//                End //if (liMust_Update_Gl > 0) and ...
48176>>>>>>>
48176>>>>>>>
48176>>>>>>>
48176>>>>>>>//                If (liMust_Update_CUSTOMER > 0);
48176>>>>>>>//                Begin
48176>>>>>>>//                //****************************************************************************
48176>>>>>>>//                //*  €  • †    „ Œ † ‹ „  — ‘ † ‘     „ Š € ’ — Œ                         *
48176>>>>>>>//                //****************************************************************************
48176>>>>>>>//                //****************************************************************************
48176>>>>>>>//                //* ’ „ Š Ž ‘    „ Œ † ‹ „  — ‘ † ‘     „ Š € ’ — Œ                        *
48176>>>>>>>//                //****************************************************************************
48176>>>>>>>//                End //if (liMust_Update_CUSTOMER > 0)
48176>>>>>>>
48176>>>>>>>
48176>>>>>>>
48176>>>>>>>//                If (liMust_Update_VENDOR  > 0);
48176>>>>>>>//                Begin
48176>>>>>>>//                //****************************************************************************
48176>>>>>>>//                //*  €  • †    „ Œ † ‹ „  — ‘ † ‘      Ž ‹ † ‡ „ “ ’ — Œ                 *
48176>>>>>>>//                //****************************************************************************
48176>>>>>>>//                //****************************************************************************
48176>>>>>>>//                //* ’ „ Š Ž ‘    „ Œ † ‹ „  — ‘ † ‘      Ž ‹ † ‡ „ “ ’ — Œ                *
48176>>>>>>>//                //****************************************************************************
48176>>>>>>>//                End //if (liMust_Update_VENDOR > 0)
48176>>>>>>>
48176>>>>>>>//      End_Procedure //private.transaction_update_other_modules
48176>>>>>>>
48176>>>>>>>
48176>>>>>>>              //§˜¨'æ¢¦ §¦¬ œå¤˜  ..›ç¤˜£ž, ›â¤ §˜å¦¬¤ › æ«  «˜ §œ›å˜ œå¤˜  display only ! ¡˜  foreign fields
48176>>>>>>>              //Set File_Field_Entry File_Field Barticl.Garticl_Rec0 FALSE to liF_Garticl_Rec0
48176>>>>>>>              //Set File_Field_Entry File_Field Barticl.Gmove_Mrec0  FALSE to liF_Gmove_Master_Rec0
48176>>>>>>>              //Set File_Field_Entry File_Field Barticl.Gplan_Mrec0  FALSE to liF_Gplan_Master_Rec0
48176>>>>>>>
48176>>>>>>>              //Set File_Field_Entry File_Field Bmove.Gmove_Srec0    FALSE to liF_Gmove_Slave_Rec0
48176>>>>>>>              //Set File_Field_Entry File_Field Bmove.Gplan_Srec0    FALSE to liF_Gplan_Slave_Rec0
48176>>>>>>>
48176>>>>>>>              //Set File_Field_Changed_Value File_Field Barticl.Garticl_Rec0 to liF_Garticl_Rec0
48176>>>>>>>               //Set File_Field_Changed_Value File_Field Barticl.Gmove_Mrec0  to liF_Gmove_Master_Rec0
48176>>>>>>>              //Set File_Field_Changed_Value File_Field Barticl.Gplan_Mrec0  to liF_Gplan_Master_Rec0
48176>>>>>>>
48176>>>>>>>               //Set Field_Changed_Value      Field      Bmove.Gmove_Srec0    to liF_Gmove_Slave_Rec0
48176>>>>>>>               //Set Field_Changed_Value      Field      Bmove.Gplan_Srec0    to liF_Gplan_Slave_Rec0
48176>>>>>>>
48176>>>>>>>
48176>>>>>>>               //Forward Send Request_Save
48176>>>>>>>
48176>>>>>>>
48176>>>>>>>
48176>>>>>>>
48176>>>>>>>
48176>>>>>>>//--------------------------------------------------------------------------------
48176>>>>>>>    Procedure Define_Fields
48177>>>>>>>        Forward Send Define_Fields
48179>>>>>>>        //DDB-Generated-Code-Location
48179>>>>>>>        //DDB-DefineFieldStart
48179>>>>>>>
48179>>>>>>>        Set Main_File            To Bmove.File_Number
48180>>>>>>>        Set Cascade_Delete_State To FALSE
48181>>>>>>>
48181>>>>>>>
48181>>>>>>>        // Parent (Server) file structure...............
48181>>>>>>>        Send Add_Server_File  Barticl.File_Number
48182>>>>>>>        Send Add_Server_File  Baxio.File_Number
48183>>>>>>>
48183>>>>>>>        // External (System) file structure.............
48183>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
48184>>>>>>>        Send Add_System_File  Bkinkat.File_Number  DD_LOCK_ON_ALL
48185>>>>>>>        Send Add_System_File  Bsum.File_Number  DD_LOCK_ON_ALL
48186>>>>>>>
48186>>>>>>>        Define_Auto_Increment  Sysrecb.Bmove_Rec0  To Bmove.Bmove_Rec0
48189>>>>>>>
48189>>>>>>>        // Field-based properties.......................
48189>>>>>>>
48189>>>>>>>        // Bmove.Company_Code
48189>>>>>>>
48189>>>>>>>        // Bmove.Branch_Code
48189>>>>>>>
48189>>>>>>>        // Bmove.Year_Year
48189>>>>>>>
48189>>>>>>>        // Bmove.Btypkin_Code
48189>>>>>>>
48189>>>>>>>        // Bmove.Barticl_Hmnia
48189>>>>>>>
48189>>>>>>>        // Bmove.Barticl_No
48189>>>>>>>
48189>>>>>>>        // Bmove.Baxio_Code
48189>>>>>>>
48189>>>>>>>        // Bmove.Barticl_Recr
48189>>>>>>>
48189>>>>>>>        // Bmove.Baxio_Recr
48189>>>>>>>
48189>>>>>>>        // Bmove.Bmove_Rec0
48189>>>>>>>
48189>>>>>>>        // Bmove.Bmove_Recr
48189>>>>>>>
48189>>>>>>>        // Bmove.Bmove_Aa
48189>>>>>>>
48189>>>>>>>        // Bmove.Baxio_Aa
48189>>>>>>>
48189>>>>>>>        // Bmove.Gplan_Srec0
48189>>>>>>>
48189>>>>>>>        // Bmove.Baxio_Pfile
48189>>>>>>>
48189>>>>>>>        // Bmove.Baxio_Pcode
48189>>>>>>>
48189>>>>>>>        // Bmove.Baxio_Pepon
48189>>>>>>>
48189>>>>>>>        // Bmove.Baxio_Ppar
48189>>>>>>>
48189>>>>>>>        // Bmove.Btypkin_Recr
48189>>>>>>>
48189>>>>>>>        // Bmove.Sls_Id
48189>>>>>>>
48189>>>>>>>        // Bmove.Cnt_Id
48189>>>>>>>
48189>>>>>>>        // Bmove.Presp_Id
48189>>>>>>>
48189>>>>>>>        // Bmove.Bmove_M_Code
48189>>>>>>>
48189>>>>>>>        // Bmove.Cmoves_Recr
48189>>>>>>>
48189>>>>>>>        // Bmove.Exei_Enhmerosei
48189>>>>>>>
48189>>>>>>>        // Bmove.Hmnia_Enhmeros
48189>>>>>>>
48189>>>>>>>        //DDB-DefineFieldEnd
48189>>>>>>>
48189>>>>>>>        Set Main_File            To Bmove.File_Number
48190>>>>>>>        Set Cascade_Delete_State To FALSE
48191>>>>>>>
48191>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
48192>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
48193>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48194>>>>>>>
48194>>>>>>>        // Parent (Server) file structure...............
48194>>>>>>>        Send Add_Server_File  Baxio.File_Number
48195>>>>>>>        Send Add_Server_File  Barticl.File_Number
48196>>>>>>>
48196>>>>>>>        // External (System) file structure.............
48196>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
48197>>>>>>>        Send Add_System_File  Bkinkat.File_Number  DD_LOCK_ON_ALL
48198>>>>>>>        Send Add_System_File  Bsum.File_Number  DD_LOCK_ON_ALL
48199>>>>>>>
48199>>>>>>>        Define_Auto_Increment  Sysrecb.Bmove_Rec0  To Bmove.Bmove_Rec0
48202>>>>>>>
48202>>>>>>>        // Field-based properties.......................
48202>>>>>>>
48202>>>>>>>        // Bmove.Company_Code
48202>>>>>>>
48202>>>>>>>        // Bmove.Branch_Code
48202>>>>>>>
48202>>>>>>>        // Bmove.Year_Year
48202>>>>>>>
48202>>>>>>>        // Bmove.Btypkin_Code
48202>>>>>>>
48202>>>>>>>        // Bmove.Barticl_Hmnia
48202>>>>>>>
48202>>>>>>>        // Bmove.Barticl_No
48202>>>>>>>
48202>>>>>>>        // Bmove.Barticl_Rec0
48202>>>>>>>
48202>>>>>>>        // Bmove.Baxio_Rec0
48202>>>>>>>
48202>>>>>>>        // Bmove.Bmove_Rec0
48202>>>>>>>
48202>>>>>>>        // Bmove.Bmove_Aa
48202>>>>>>>        Set Field_Options          Field Bmove.Bmove_Aa           To DD_DISPLAYONLY
48203>>>>>>>
48203>>>>>>>        // Bmove.Baxio_Aa
48203>>>>>>>        Set Field_Options          Field Bmove.Baxio_Aa           To DD_DISPLAYONLY
48204>>>>>>>
48204>>>>>>>        // Bmove.Gplan_Srec0
48204>>>>>>>        Set Field_Options          Field Bmove.Gplan_Srec0        To DD_DISPLAYONLY
48205>>>>>>>
48205>>>>>>>        // Bmove.Baxio_Pfile
48205>>>>>>>
48205>>>>>>>        // Bmove.Baxio_Pcode
48205>>>>>>>
48205>>>>>>>        // Bmove.Baxio_Pepon
48205>>>>>>>
48205>>>>>>>        // Bmove.Baxio_Ppar
48205>>>>>>>
48205>>>>>>>    End_Procedure    // Define_Fields
48206>>>>>>>
48206>>>>>>>
48206>>>>>>>    Procedure Field_Defaults
48207>>>>>>>        Forward Send Field_Defaults
48209>>>>>>>        //DDB-Generated-Code-Location
48209>>>>>>>        //DDB-FieldDefaultStart
48209>>>>>>>        //DDB-FieldDefaultEnd
48209>>>>>>>    End_Procedure    // Field_Defaults
48210>>>>>>>
48210>>>>>>>End_Class    // Bmove_DataDictionary
48211>>>>>>>//DDB-FileEnd
48211>>>>>    Use NOMISMA.DD
48211>>>>>
48211>>>>>    //AB-IgnoreEnd
48211>>>>>
48211>>>>>    Object bpencmv3 is a BusinessProcessSub
48213>>>>>
48213>>>>>        //AB-StoreTopStart
48213>>>>>        Property String      psModule        Public ''
48215>>>>>        Property String      psBarticleRecr  Public ''
48217>>>>>        Property String      psCmovesRecr    Public ''
48219>>>>>        Property Integer     piWithDeletion  Public  0
48221>>>>>        Property Integer     piLathos        Public  0
48223>>>>>        Property Integer     piTxtID         Public  0
48225>>>>>        Property String      piBarticleRecn  Public  0
48227>>>>>
48227>>>>>
48227>>>>>        ////////////////////////////////////////////////////////////
48227>>>>>        /////////// Extra Data Set Needed For Finding //////////////
48227>>>>>        /////////// Incoming Bmove Record             //////////////
48227>>>>>        ////////////////////////////////////////////////////////////
48227>>>>>
48227>>>>>        Set Status_Panel_State to False
48228>>>>>        //Set Allow_Cancel_State  to True
48228>>>>>        Set Display_Error_State to True
48229>>>>>        //Set Process_Title to "               "
48229>>>>>        //Set Status_Log_id to (status_log(Self)) //Use statlog.pkg
48229>>>>>        //Set Status_log_state to True
48229>>>>>
48229>>>>>        //AB-StoreTopEnd
48229>>>>>
48229>>>>>        Set Size        to 58 88
48230>>>>>        Set Location    to 18 52
48231>>>>>
48231>>>>>        //AB-DDOStart
48231>>>>>
48231>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
48233>>>>>        End_Object    // Ctypkin_DD
48234>>>>>
48234>>>>>        Object Country_DD is a Country_DataDictionary
48236>>>>>        End_Object    // Country_DD
48237>>>>>
48237>>>>>        Object Towns_DD is a Towns_DataDictionary
48239>>>>>            Set DDO_Server to (Country_DD(self))
48240>>>>>        End_Object    // Towns_DD
48241>>>>>
48241>>>>>        Object Cities_DD is a Cities_DataDictionary
48243>>>>>            Set DDO_Server to (Towns_DD(self))
48244>>>>>        End_Object    // Cities_DD
48245>>>>>
48245>>>>>        Object Payresp_DD is a Payresp_DataDictionary
48247>>>>>        End_Object    // Payresp_DD
48248>>>>>
48248>>>>>        Object Areas_DD is a Areas_DataDictionary
48250>>>>>        End_Object    // Areas_DD
48251>>>>>
48251>>>>>        Object Clients_DD is a Clients_DataDictionary
48253>>>>>            Set DDO_Server to (Cities_DD(self))
48254>>>>>            Set DDO_Server to (Payresp_DD(self))
48255>>>>>            Set DDO_Server to (Areas_DD(self))
48256>>>>>        End_Object    // Clients_DD
48257>>>>>
48257>>>>>        Object Cmoves_DD is a Cmoves_DataDictionary
48259>>>>>            Set DDO_Server  to (Ctypkin_DD(self))
48260>>>>>            Set DDO_Server  to (Clients_DD(self))
48261>>>>>            Set piFromBP    to 1
48262>>>>>        End_Object    // Cmoves_DD
48263>>>>>
48263>>>>>        Object Cflagkin_DD is a Cflagkin_DataDictionary
48265>>>>>            Set DDO_Server to (Ctypkin_DD(self))
48266>>>>>        End_Object    // Cflagkin_DD
48267>>>>>
48267>>>>>        Object Btypkin_DD is a Btypkin_DataDictionary
48269>>>>>        End_Object    // Btypkin_DD
48270>>>>>
48270>>>>>        Object Baxiokat_DD is a Baxiokat_DataDictionary
48272>>>>>        End_Object    // Baxiokat_DD
48273>>>>>
48273>>>>>        Object Barticl_DD is a Barticl_DataDictionary
48275>>>>>            Set DDO_Server to (Btypkin_DD(self))
48276>>>>>        End_Object    // Barticl_DD
48277>>>>>
48277>>>>>        Object Baxio_DD is a Baxio_DataDictionary
48279>>>>>            Set DDO_Server to (Baxiokat_DD(self))
48280>>>>>        End_Object    // Baxio_DD
48281>>>>>
48281>>>>>        Object Bmove_DD is a Bmove_DataDictionary
48283>>>>>            Set DDO_Server to (Barticl_DD(self))
48284>>>>>            Set DDO_Server to (Baxio_DD(self))
48285>>>>>            Set Constrain_File to Barticl.File_Number
48286>>>>>        End_Object    // Bmove_DD
48287>>>>>
48287>>>>>        Object Nomisma_DD is a Nomisma_DataDictionary
48289>>>>>        End_Object    // Nomisma_DD
48290>>>>>
48290>>>>>        //AB-DDOEnd
48290>>>>>
48290>>>>>
48290>>>>>        //AB-StoreStart
48290>>>>>
48290>>>>>        Function fiDelete_Cmoves_Record String asRecr Integer aiDelete Returns Integer
48292>>>>>            Integer rVal iErr
48293>>>>>            Move 0 to rVal
48294>>>>>            Send Clear to Cmoves_DD
48295>>>>>            Move asRecr to Cmoves.Cmoves_Recr
48296>>>>>            Send Find to Cmoves_DD eq 2 //Cmoves:Index.2:Cmoves_Recr
48297>>>>>            If (Found=1) Begin
48299>>>>>                If (aiDelete) Begin
48301>>>>>                    Send UpdateWait to (Wait(Self))  ('ƒ ˜š¨˜­ã ‰å¤ž©žª '+(String(Cmoves.Recnum)))
48302>>>>>                    Send Request_Delete to Cmoves_DD
48303>>>>>                End
48303>>>>>>
48303>>>>>            End
48303>>>>>>
48303>>>>>            Else Begin
48304>>>>>                Move 60003 to rVal
48305>>>>>                // If From Deletion and Could not find Cmoves with Barticle_Cmoves_Recr set piLathos
48305>>>>>                If (aiDelete) error 6003 "ƒœ¤ ™¨âŸž¡œ Cmoves £œ «¦ Cmoves Recr «¦¬ §˜¨˜©«˜« ¡¦ç"
48308>>>>>            End
48308>>>>>>
48308>>>>>            Function_Return rVal
48309>>>>>        End_Function
48310>>>>>
48310>>>>>        Procedure Deal_With_Barticle
48312>>>>>            Integer iErr isClosed iInt iWithDeletion iSign iClient iID iMustSaveClientYpoloipa
48313>>>>>            Integer iEpireazeiAxies iMustEnhmWitemcl  iEpireazeiPosothtes iAntistrofhProshmou iBmoveRec0
48313>>>>>            Integer iOneWflag iiPartlNO iExitFlag iMustSaveWCmoves iExeiSxetika iBmoveRecnum iMustSaveEpisf
48313>>>>>            Integer iMustSaveCmoves iMustSaveClient iMyf iInt2 iOneCflag iAnti iiBarticleNO iMustsaveofeilh
48313>>>>>
48313>>>>>            String  ssPtypparDescr ssSeiraDescr sWCmovesRecr sRecr2 ssPtypparDescrShort sPelaths
48313>>>>>            String  sRecr sParticle_CmovesRecr sCtypkinRecr sCn_Code sSls_ID sCnt_ID sPresp_ID
48313>>>>>            String  sClientRecr sCmovesRecr sNomisma sFlag sWtypkinRecr sItem sLocked sModule
48313>>>>>            String  sWitemxRecr sWaxRecr sClientID sPerigrafh sParticle_WCmovesRecr ssBtypkinDescrShort
48313>>>>>
48313>>>>>            Number  nVatam nGenAm nExtra nPayam nDiscAm nIsotimia nUnitPrice nGSynolo
48313>>>>>            Number  nTotAmBd nTotDiscPms nTotDiscPC nTotAmAd nActualXreosh nActualPistosh
48313>>>>>            Number  nAthr1 nAthr2 nAthr3 nAthr4 nAthr5 nAthr6 nParastXreosh nParastPistosh
48313>>>>>            Number  nPoso nXre nPis nMyf nPosothta nAthr7 nAthr8 nPosothtaFinal nXreFinal nPisFinal
48313>>>>>            Number  nApait nEpitPoso nofeilh nofeilhpayresp napaitpayresp
48313>>>>>            Date    dHmnia dLastPis dLastXre dLastXreParast dLastPisParast
48313>>>>>
48313>>>>>            Number nQtyEisFinal nQtyExFinal nQtyEis nQtyEx nJS
48313>>>>>
48313>>>>>
48313>>>>>            Get psBarticleRecr  to sRecr
48314>>>>>            Move (Trim(sRecr))  to sRecr
48315>>>>>            Send Clear          to Barticl_DD
48316>>>>>            Move srecr          to Barticl.Barticl_Recr
48317>>>>>            Send Find to Barticl_DD Eq 2 // Barticl:Index.2:Barticl_Recr
48318>>>>>// todo: 25/06/2002 Logo tou find ktypaei to gamhmeno mhnyma otan kleinei h efarmogh
48318>>>>>// omos kammia allagh me opoiadhpote tropopoihsh tou kodika, eite kanoume manual find prota,
48318>>>>>// eite find_by_recnum. Opoiadhpote find mh procedural ektelestei exei to idio apotelesma
48318>>>>>
48318>>>>>//          Send Find_By_Recnum to Barticl_DD Barticl.File_Number (piBarticleRecn(Self))
48318>>>>>
48318>>>>>            If (Found=1) Begin
48320>>>>>                Get Field_Current_Value Of Btypkin_DD Field Btypkin.Btypkin_anti1   to iAnti
48321>>>>>                Get Field_Current_Value Of Barticl_DD Field Barticl.Barticl_Ekleise to isClosed
48322>>>>>                Get Field_Current_Value Of Barticl_DD Field Barticl.CN_Code         to sCN_Code
48323>>>>>
48323>>>>>                If (isClosed) Begin
48325>>>>>                    Move 0 to iExitFlag
48326>>>>>
48326>>>>>                    Send Find To Bmove_DD First_Record 3 //Bmoves:Index.3:Barticl_Recr + Bmove_Rec0
48327>>>>>                    While ((Found=1) And (iExitFlag=0))
48331>>>>>                        Get Field_Current_Value Of Bmove_DD Field Bmove.Cmoves_Recr to sRecr2
48332>>>>>                        Move (Trim(sRecr2)) to sRecr2
48333>>>>>                        If (Not(sRecr2='')) Move (fiDelete_Cmoves_Record(Self,sRecr2,1))  to iInt2
48336>>>>>                        Else                Move 0 to iInt2
48338>>>>>
48338>>>>>                        Send Clear to Ctypkin_DD
48339>>>>>                        Get Field_Current_Value Of Btypkin_DD Field Btypkin.Ctypkin_Recr to sCtypkinRecr
48340>>>>>                        Move 0 to iMustSaveEpisf
48341>>>>>                        Clear Cflagkin
48342>>>>>                        Move sCtypkinRecr to Cflagkin.Ctypkin_Recr
48343>>>>>                        Find Gt Cflagkin By Index.5 // Cflagkin:Index.5:Ctypkin_Recr+Flag_Numeric+Cflagkin_Recr
48344>>>>>>
48344>>>>>                        While ((Found=1) And (sCtypkinRecr=Cflagkin.Ctypkin_Recr))
48348>>>>>                            Move Cflagkin.Cflagkin_Flag to sFlag
48349>>>>>                            Move (Trim(sFlag)) to sFlag
48350>>>>>                                 If (sFlag='60') Move 1 to iMustSaveEpisf   // Enhmeronei Episfalh Posa Thetika
48353>>>>>                            Else If (sFlag='61') Move 2 to iMustSaveEpisf   // Enhmeronei Episfalh Posa Arnhtika
48357>>>>>                            Else If (sflag='66') Move 1 to iMustsaveofeilh  // enhmerovnei synolikh ofeilh
48361>>>>>                            Find Gt Cflagkin By Index.5 // Cflagkin:Index.5:Ctypkin_Recr+Flag_Numeric+Cflagkin_Recr
48362>>>>>>
48362>>>>>                        Loop
48363>>>>>>
48363>>>>>
48363>>>>>                        If ((iMustSaveEpisf<>0) or (imustsaveofeilh<>0)) Begin
48365>>>>>                            Move 0  to nApait
48366>>>>>                            Move 0  to nEpitPoso
48367>>>>>                            Move 0  to nofeilh
48368>>>>>                            Move 0  to nofeilhpayresp
48369>>>>>                            Move 0  to napaitpayresp
48370>>>>>                            Move '' to sPelaths
48371>>>>>
48371>>>>>                            //Get field_current_value of Baxio_dd field Baxio.Baxio_V0            to nEpitPoso
48371>>>>>                            Get field_current_value of Baxio_dd field Baxio.Baxio_V2            to nEpitPoso
48372>>>>>                            Get field_current_value of Baxio_dd field Baxio.Baxio_Code_In       to sPelaths
48373>>>>>
48373>>>>>                            // js 13/03/2003 Giati oi apografikes xreoseis pou kataxorountai apo
48373>>>>>                            // ta axiografa ?? exoun keno ayto to pedio apo thn klash tou baxio
48373>>>>>                            // Elegxetai to pedio Baxiokat.Baxiokat_Type  opou an einai 2 (Xreosh)
48373>>>>>                            // mhdenizei to pedio tou pelath Baxio.Baxio_Code_In
48373>>>>>                            If (Trim(sPelaths)='') Get field_current_value of Barticl_dd field Barticl.Barticl_code1 to sPelaths
48376>>>>>                            // js 13/03/2003
48376>>>>>
48376>>>>>                            Send Clear to Clients_DD
48377>>>>>                            Move (Trim(sPelaths)) to Clients.Client_ID
48378>>>>>                            Send Find to Clients_DD Eq 6 // Clients:index.6:Client_ID
48379>>>>>                            If (Found=1) Begin
48381>>>>>                                Get field_current_value of clients_dd field clients.Poso_Se_Apait   to nApait
48382>>>>>                                Get field_current_value of payresp_dd field payresp.Poso_Se_Apait   to nApaitpayresp
48383>>>>>                                Get field_current_value of clients_dd field clients.synolikh_ofeilh to nofeilh
48384>>>>>                                Get field_current_value of payresp_dd field payresp.synolikh_ofeilh to nofeilhpayresp
48385>>>>>
48385>>>>>                                If (iMustSaveofeilh=1)  Begin
48387>>>>>//                                    Set Field_Changed_Value of clients_dd field clients.synolikh_ofeilh to (nepitposo+nofeilh)
48387>>>>>//                                    Send Request_Save to Clients_DD
48387>>>>>//                                    Set Field_Changed_Value of payresp_dd field payresp.synolikh_ofeilh to (nepitposo+nofeilhpayresp)
48387>>>>>//                                    Send Request_Save to payresp_DD
48387>>>>>                                    If (Baxiokat.Baxiokat_Type = 2) Begin
48389>>>>>                                        Set Field_Changed_Value of clients_dd field clients.synolikh_ofeilh to (nofeilh-nepitposo)
48390>>>>>                                        Send Request_Save to Clients_DD
48391>>>>>                                        Set Field_Changed_Value of payresp_dd field payresp.synolikh_ofeilh to (nofeilhpayresp-nepitposo)
48392>>>>>                                        Send Request_Save to payresp_DD
48393>>>>>                                    End
48393>>>>>>
48393>>>>>                                    Else Begin
48394>>>>>                                        Set Field_Changed_Value of clients_dd field clients.synolikh_ofeilh to (nofeilh+nepitposo)
48395>>>>>                                        Send Request_Save to Clients_DD
48396>>>>>                                        Set Field_Changed_Value of payresp_dd field payresp.synolikh_ofeilh to (nofeilhpayresp+nepitposo)
48397>>>>>                                        Send Request_Save to payresp_DD
48398>>>>>                                    End
48398>>>>>>
48398>>>>>                                End
48398>>>>>>
48398>>>>>
48398>>>>>                                If (iMustSaveEpisf=1)  Begin
48400>>>>>                                    Sub nEpitPoso from nApait
48401>>>>>                                    Set Field_Changed_Value of clients_dd field clients.Poso_Se_Apait to nApait
48402>>>>>                                    Send Request_Save to Clients_DD
48403>>>>>                                    Sub nepitposo from napaitpayresp
48404>>>>>                                    Set Field_Changed_Value of payresp_dd field payresp.Poso_Se_Apait to nApaitpayresp
48405>>>>>                                    Send Request_Save to payresp_DD
48406>>>>>                                End
48406>>>>>>
48406>>>>>                                Else If (iMustSaveEpisf=2)  Begin
48409>>>>>                                    Sub (nEpitPoso*(-1)) to nApait
48410>>>>>                                    Set Field_Changed_Value of clients_dd field clients.Poso_Se_Apait to nApait
48411>>>>>                                    Send Request_Save to Clients_DD
48412>>>>>                                    Sub (nEpitPoso*(-1)) to nApaitpayresp
48413>>>>>                                    Set Field_Changed_Value of payresp_dd field payresp.Poso_Se_Apait to nApaitpayresp
48414>>>>>                                    Send Request_Save to payresp_DD
48415>>>>>                                End
48415>>>>>>
48415>>>>>                            End
48415>>>>>>
48415>>>>>                            Else Begin
48416>>>>>                            End
48416>>>>>>
48416>>>>>                        End
48416>>>>>>
48416>>>>>
48416>>>>>                        If (iInt2<>0) Move iInt2 to iExitFlag
48419>>>>>                        Else Begin
48420>>>>>                            Send UpdateWait to (Wait(Self)) ('„¤ž£œ¨à©ž ‰å¤ž©žª '+(String(Bmove.Recnum)))
48421>>>>>                            Set Field_Changed_Value Of Bmove_DD Field Bmove.Cmoves_Recr to ''
48422>>>>>                            Send Request_Save to Bmove_DD
48423>>>>>                        End
48423>>>>>>
48423>>>>>                        Send Find To Bmove_DD Next_Record 3 //Bmoves:Index.3:Barticl_Recr + Bmove_Rec0
48424>>>>>                    Loop
48425>>>>>>
48425>>>>>
48425>>>>>
48425>>>>>
48425>>>>>                    If (iExitFlag) Move iExitFlag   to iInt2
48428>>>>>                    Else           Move 0           to iInt2
48430>>>>>
48430>>>>>                    If (Not(iInt2)) Begin
48432>>>>>                        // €¤ ›œ¤ ®«¬§ž©œ ¢˜Ÿ¦ª ¡˜«˜ «ž¤ › ˜š¨˜­ž ¡˜  › œš¨˜­œ  ©à©«˜ «¦ Cmoves ¡˜  «¦ Wcmoves record
48432>>>>>                        // «¦«œ ¡˜Ÿ˜¨ ¦¬£œ «¦ Barticle ˜§¦ ©ž£á› ˜ Cmoves kai Wcmoves
48432>>>>>                        // ¡˜  ¥œ£˜¨¡˜¨¦¬£œ «¦ record Barticle àª ‹† ‰¢œ ©«æ §¢â¦¤
48432>>>>>                        Set Field_Changed_Value Of Barticl_DD Field Barticl.Cmoves_Recr         to ''
48433>>>>>                        Set Field_Changed_Value Of Barticl_DD Field Barticl.Barticl_Ekleise     to ''
48434>>>>>                        Send Request_Save to Barticl_DD
48435>>>>>                        //Send info_box "’¦ §˜¨˜©«˜« ¡æ œå¤˜  «é¨˜ ˜¤¦ ®«æ.\n„§ «¨â§œ«œ ž «¨¦§¦§¦åž©ž «¦¬" '¢ž¨¦­¦¨å˜'
48435>>>>>                    End
48435>>>>>>
48435>>>>>                    Else Begin
48436>>>>>                        // •«¬§ž©œ ¢˜Ÿ¦ª ©«ž¤ › ˜š¨˜­ž WCmoves
48436>>>>>                        error 6111 "ƒœ¤ ™¨âŸž¡œ Cmoves š ˜ › ˜š¨˜­ã"
48437>>>>>>
48437>>>>>                    End
48437>>>>>>
48437>>>>>
48437>>>>>                End
48437>>>>>>
48437>>>>>                //// IF IS NOT CLOSED (Barticle)
48437>>>>>                Else Begin
48438>>>>>                    Integer iiRecn
48438>>>>>                    Move 0 to iExitFlag
48439>>>>>                    Send Clear To Bmove_DD
48440>>>>>                    Send Find To Bmove_DD First_Record 3 //Bmove:Index.3:Barticl_Recr+Bmove_Rec0
48441>>>>>                    While ((Found=1) And (iExitFlag=0))
48445>>>>>                        Get Field_Current_Value Of Bmove_DD Field Bmove.Recnum to iiRecn
48446>>>>>                        Move 0 to iInt
48447>>>>>                        Get Field_Current_Value Of Bmove_DD Field Bmove.Cmoves_Recr to sRecr2
48448>>>>>                        Move (Trim(sRecr2)) to sRecr2
48449>>>>>                        If (Not(sRecr2='')) Begin
48451>>>>>                            Move (fiDelete_Cmoves_Record(Self,sRecr2,0))  to iInt
48452>>>>>                            If (iInt<>60003) Move 1 to iExitFlag
48455>>>>>                        End
48455>>>>>>
48455>>>>>                        Send Find To Bmove_DD Next_Record 3
48456>>>>>                        Send UpdateWait to (Wait(Self)) ('„¤ž£œ¨à©ž ‰å¤ž©žª '+(String(Bmove.Recnum)))
48457>>>>>                    Loop
48458>>>>>>
48458>>>>>
48458>>>>>                    If (iExitFlag) Begin
48460>>>>>                        error 6100  "Found Cmoves Record on Open Barticl"
48461>>>>>>
48461>>>>>                    End
48461>>>>>>
48461>>>>>
48461>>>>>        ///////////////////////////// SOS ///////
48461>>>>>        ///////////////////////////  ENHMEROSH FLAGS APO WFLAGKIN <ARXH>  //////////////////////////////
48461>>>>>        //////////////////////////jsjsjsjsjsjsjsjs
48461>>>>>
48461>>>>>                    Send Find To Bmove_DD First_Record 3 // Bmove:Index.2:Bmove_Recr
48462>>>>>
48462>>>>>                    While (Found=1)
48466>>>>>
48466>>>>>                        Send Clear to Ctypkin_DD
48467>>>>>                        Send Clear to Cflagkin_DD
48468>>>>>                        Send Clear to Clients_DD
48469>>>>>                        Send Clear to Cmoves_DD
48470>>>>>
48470>>>>>                        Get Field_Current_Value Of Btypkin_DD   Field Btypkin.Ctypkin_Recr  to sCtypkinRecr
48471>>>>>                        Get Field_Current_Value Of Barticl_DD   Field Barticl.Client_Mrecr  to sClientRecr
48472>>>>>                        move sclientrecr to clients.client_recr
48473>>>>>                        Send Find to Clients_DD eq 2 //Clients:Index.2:Client_Recr
48474>>>>>
48474>>>>>                        If (Not(Found)) Begin
48476>>>>>                            If ((iAnti=2) Or (iAnti=3)) error 5005 "Client record not found"
48479>>>>>                             ///// Else Goto Skip_All_Ctypkin
48479>>>>>                            ///// @@##@@ 21/12/2001 yannis
48479>>>>>                            ///// h allagh ayth egine gia na mporoume na enhmeronoume
48479>>>>>                            ///// kartella pelath apo episfalh posa opote kai prepei
48479>>>>>                            ///// na diabazei ta cflags
48479>>>>>                        End
48479>>>>>>
48479>>>>>
48479>>>>>                        Move sCtypkinRecr to Ctypkin.Ctypkin_Recr
48480>>>>>                        Send Find to Ctypkin_DD eq 2 //Ctypkin:Index.2:Client_Recr
48481>>>>>                        If (Not(Found)) error 5006 "Ctypkin record not found"
48484>>>>>                        Get Field_Current_Value Of Barticl_DD   Field Barticl.Barticl_Hmnia     to dHmnia
48485>>>>>                        Get Field_Current_Value Of Barticl_DD   Field Barticl.Barticl_Aitiol    to sPerigrafh
48486>>>>>            //                    Get Field_Current_Value Of Barticl_DD   Field Barticl.Isotimia          to nIsotimia
48486>>>>>                        Get Field_Current_Value Of Ctypkin_DD   Field Ctypkin.Ctypkin_Module    to sModule
48487>>>>>                        Get Field_Current_Value Of Barticl_DD   Field Barticl.Sls_ID            to sSls_ID
48488>>>>>                        Get Field_Current_Value Of Barticl_DD   Field Barticl.Cnt_ID            to sCnt_ID
48489>>>>>                        Get Field_Current_Value Of Barticl_DD   Field Barticl.Presp_ID          to sPresp_ID
48490>>>>>
48490>>>>>                        Move 1 to iSign // Always 'Update'
48491>>>>>                        Move 0 to iOneCflag
48492>>>>>                        Move 0 to iMustSaveCmoves
48493>>>>>                        Move 0 to iMustSaveClient
48494>>>>>                        Move 0 to iMustSaveClientYpoloipa
48495>>>>>                        Move 0 to iMustSaveEpisf
48496>>>>>                        Move 0 to iAntistrofhProshmou
48497>>>>>                        Move 0 to imustsaveofeilh
48498>>>>>
48498>>>>>                        Send UpdateWait to (Wait(Self)) ('„¤ž£œ¨à©ž ‰å¤ž©žª '+(String(Bmove.Recnum)))
48499>>>>>
48499>>>>>                        Move 0 to iOneWflag
48500>>>>>                        Move 0 to iMustSaveWCmoves
48501>>>>>                        Move 0 to nPosothtaFinal
48502>>>>>                        Move 0 to nXreFinal
48503>>>>>                        Move 0 to nPisFinal
48504>>>>>                        Move 0 to iEpireazeiAxies
48505>>>>>                        Move 0 to iEpireazeiPosothtes
48506>>>>>                        Move 0 to nXre
48507>>>>>                        Move 0 to nPis
48508>>>>>                        Move 0 to nQtyEis
48509>>>>>                        Move 0 to nQtyEx
48510>>>>>                        Move 0 to iMustEnhmWitemcl
48511>>>>>
48511>>>>>                        Get Field_Current_Value Of Baxio_DD   Field Baxio.Baxio_C_Code2  to sNomisma
48512>>>>>                        Move (Trim(sNomisma))   to sNomisma
48513>>>>>                        Move sNomisma to Nomisma.Nomisma_Code
48514>>>>>                        Send Find to Nomisma_DD eq 1 //Nomisma:Index.1:Nomisma_Code
48515>>>>>                        If (Not(Found)) Begin
48517>>>>>                            error 20000 "ƒœ¤ ™¨âŸž¡œ «¦ ¤æ£ ©£˜"
48518>>>>>>
48518>>>>>                        End
48518>>>>>>
48518>>>>>
48518>>>>>                        Get Field_Current_Value Of Baxio_DD     Field Baxio.Baxio_V2        to nPoso
48519>>>>>                        Get Field_Current_Value Of Barticl_DD   Field Barticl.Barticl_Hmnia to dHmnia
48520>>>>>                        Move 1                                                              to nPosothta
48521>>>>>
48521>>>>>                        Move 0 to iAntistrofhProshmou
48522>>>>>
48522>>>>>                        Clear Cflagkin
48523>>>>>                        Move sCtypkinRecr           to Cflagkin.Ctypkin_Recr
48524>>>>>                        Find Gt Cflagkin By Index.5 // Cflagkin:Index.5:Ctypkin_Recr+Flag_Numeric+Cflagkin_Recr
48525>>>>>>
48525>>>>>
48525>>>>>                        While ((Found=1) And (sCtypkinRecr=Cflagkin.Ctypkin_Recr))
48529>>>>>
48529>>>>>                            Move 1 to iOneCflag
48530>>>>>                            Move Cflagkin.Cflagkin_Flag to sFlag
48531>>>>>                            Move (Trim(sFlag)) to sFlag
48532>>>>>
48532>>>>>                            Case Begin
48532>>>>>                                Case (sFlag='1')
48534>>>>>                                    Move 1 to iMustSaveCmoves
48535>>>>>                                Case Break
48536>>>>>                                Case (sFlag='2') // Antistrofh Proshmou
48539>>>>>                                    Move (nPoso*iSign*(-1)) to nPoso
48540>>>>>                                    Move 1 to iAntistrofhProshmou
48541>>>>>                                Case Break
48542>>>>>                                Case (sFlag='3') // Epireazei xreoseis
48545>>>>>                                    Move (nPoso*iSign)  to nXre
48546>>>>>                                    Move 0              to nPis
48547>>>>>                                Case Break
48548>>>>>                                Case (sFlag='4') // Epireazei pistoseis
48551>>>>>                                    Move (nPoso*iSign)  to nPis
48552>>>>>                                    Move 0              to nXre
48553>>>>>                                Case Break
48554>>>>>                                Case (sFlag='5') // Epireazei Hmeromhnies
48557>>>>>                                    Move 1 to iMustSaveClient
48558>>>>>                                    If (nXre<>0) Begin
48560>>>>>                                        Move dHmnia to dLastXre
48561>>>>>                                        Move dHmnia to dLastXreParast
48562>>>>>                                        Move ''     to dLastPis
48563>>>>>                                        Move ''     to dLastPisParast
48564>>>>>                                    End
48564>>>>>>
48564>>>>>                                    Else If (nPis<>0) Begin
48567>>>>>                                        Move dHmnia to dLastPis
48568>>>>>                                        Move dHmnia to dLastPisParast
48569>>>>>                                        Move ''     to dLastXre
48570>>>>>                                        Move ''     to dLastXreParast
48571>>>>>                                    End
48571>>>>>>
48571>>>>>                                Case Break
48572>>>>>                                Case (sFlag='6') // Epireazei Hmeromhnia teleytaias paraggelias
48575>>>>>                                Case Break
48576>>>>>                                Case (sFlag='7') // Epireazei ekkremh axiografa
48579>>>>>                                Case Break
48580>>>>>                                Case (sFlag='8') // Epireazei Diamartyrhmena
48583>>>>>                                Case Break
48584>>>>>                                Case (sFlag='9') // Epireazei Tziro
48587>>>>>                                Case Break
48588>>>>>                                Case (sFlag='10') // Epireazei Apografh xreoshs
48591>>>>>                                Case Break
48592>>>>>                                Case (sFlag='11') // Epireazei Apografh Pistosh
48595>>>>>                                Case Break
48596>>>>>                                Case (sFlag='12') // Symmetoxh se MYF (Plythos)
48599>>>>>                                    Move iSign to iMyf
48600>>>>>                                Case Break
48601>>>>>                                Case (sFlag='13') // Symmetoxh se MYF (Axia)
48604>>>>>                                    Move (nPoso*iSign)  to nMyf
48605>>>>>                                Case Break
48606>>>>>                                Case (sFlag='14') // Axies se Xeno sma
48609>>>>>                                    // Blepe sxetika erothmata sthn arxh ths procedure
48609>>>>>                                Case Break
48610>>>>>                                Case (sFlag='15') // Aytomath dhmiourgia axiografou
48613>>>>>                                Case Break
48614>>>>>                                Case (sFlag='16') // Allagh XreoPistoshs me antistrofh proshmou
48617>>>>>                                    If (nXre<>0) Begin
48619>>>>>                                        Move (nXre*(-1))    to nPis
48620>>>>>                                        Move 0              to nXre
48621>>>>>                                    End
48621>>>>>>
48621>>>>>                                    Else If (nPis<>0) Begin
48624>>>>>                                        Move (nPis*(-1))    to nXre
48625>>>>>                                        Move 0              to nPis
48626>>>>>                                    End
48626>>>>>>
48626>>>>>                                Case Break
48627>>>>>                                Case (sFlag='17') // Afairei apo Myf (akyrotika)
48630>>>>>                                    // Thelei exhghsh ti shmainei 'afairei' ?
48630>>>>>                                    // apo posothta? apo axia? apo allou?
48630>>>>>                                Case Break
48631>>>>>                                Case (sFlag='23') // Athroisths 1
48634>>>>>                                    Move (nPoso*iSign) to nAthr1
48635>>>>>                                Case Break
48636>>>>>                                Case (sFlag='24') // Athroisths 2
48639>>>>>                                    Move (nPoso*iSign) to nAthr2
48640>>>>>                                Case Break
48641>>>>>                                Case (sFlag='25') // Athroisths 3
48644>>>>>                                    Move (nPoso*iSign) to nAthr3
48645>>>>>                                Case Break
48646>>>>>                                Case (sFlag='26') // Athroisths 4
48649>>>>>                                    Move (nPoso*iSign) to nAthr4
48650>>>>>                                Case Break
48651>>>>>                                Case (sFlag='27') // Athroisths 5
48654>>>>>                                    Move (nPoso*iSign) to nAthr5
48655>>>>>                                Case Break
48656>>>>>                                Case (sFlag='28') // Athroisths 6
48659>>>>>                                    Move (nPoso*iSign) to nAthr6
48660>>>>>                                Case Break
48661>>>>>                                Case (sFlag='29') // Athroisths 7
48664>>>>>                                    Move (nPoso*iSign) to nAthr7
48665>>>>>                                Case Break
48666>>>>>                                Case (sFlag='30') // Athroisths 8
48669>>>>>                                    Move (nPoso*iSign) to nAthr8
48670>>>>>                                Case Break
48671>>>>>
48671>>>>>                                Case (sFlag='60') // Enhmeronei Episfalh Posa Thetika
48674>>>>>                                    Move 1 to iMustSaveEpisf
48675>>>>>                                Case Break
48676>>>>>
48676>>>>>                                Case (sFlag='61') // Enhmeronei Episfalh Posa Arnhtika
48679>>>>>                                    Move 2 to iMustSaveEpisf
48680>>>>>                                Case Break
48681>>>>>
48681>>>>>                                Case (sFlag='66') // Enhmeronei synolikh ofeilh
48684>>>>>                                    Move 1 to iMustSaveofeilh
48685>>>>>                                Case Break
48686>>>>>
48686>>>>>
48686>>>>>                                Case (sFlag='99') // Enhmeronei Ypoloipa
48689>>>>>                                    Move 1 to iMustSaveClientYpoloipa
48690>>>>>                                Case Break
48691>>>>>
48691>>>>>                            Case End
48691>>>>>                            Find Gt Cflagkin By Index.5 // Cflagkin:Index.5:Ctypkin_Recr+Flag_Numeric+Cflagkin_Recr
48692>>>>>>
48692>>>>>                        Loop
48693>>>>>>
48693>>>>>
48693>>>>>
48693>>>>>                        If ((iOneCflag) And (iMustSaveCmoves)) Begin
48695>>>>>
48695>>>>>                            If (nXre<>0) Begin
48697>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_Axia   to nXre
48698>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x0 ;                                    to (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Code0,dHmnia,nIsotimia))
48699>>>>>                                Move (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Code0,dHmnia,nIsotimia)) to nParastXreosh
48700>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x00 ;                                    to (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Code00,dHmnia,nIsotimia))
48701>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x1 ;                                    to (fngConvertPoso(sNomisma,nXre,SysCurXr.C_CodeR,dHmnia,nIsotimia))
48702>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x2     to nXre
48703>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p0     to 0
48704>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p00    to 0
48705>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p1     to 0
48706>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p2     to 0
48707>>>>>                                Move 0 to nParastPistosh
48708>>>>>                            End
48708>>>>>>
48708>>>>>                            Else If (nPis<>0) Begin
48711>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_Axia   to nPis
48712>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p0 ;                                    to (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Code0,dHmnia,nIsotimia))
48713>>>>>                                Move (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Code0,dHmnia,nIsotimia)) to nParastPistosh
48714>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p00 ;                                    to (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Code00,dHmnia,nIsotimia))
48715>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p1 ;                                    to (fngConvertPoso(sNomisma,nPis,SysCurXr.C_CodeR,dHmnia,nIsotimia))
48716>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p2     to nPis
48717>>>>>
48717>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x0     to 0
48718>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x00    to 0
48719>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x1     to 0
48720>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x2     to 0
48721>>>>>                                Move 0 to nParastXreosh
48722>>>>>                            End
48722>>>>>>
48722>>>>>                            Set Field_Changed_Value Of Cmoves_DD    Field Cmoves.Cmoves_Hmnia   to dHmnia
48723>>>>>                            Set Field_Changed_Value Of Cmoves_DD    Field Cmoves.Barticl_Recr   to sRecr
48724>>>>>                            Set Field_Changed_Value Of Cmoves_DD    Field Cmoves.CN_Code        to (Trim(sCN_Code))
48725>>>>>
48725>>>>>                            // jsjsjsjs 28/01/2001 Hard Coded tou kerata to nomisma eggrafhs = 'GRD'
48725>>>>>                            Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_SC_Code2   to (Trim(sNomisma))
48726>>>>>                            Get Field_Current_Value Of Btypkin_DD  Field Btypkin.Btypkin_Abr    to ssBtypkinDescrShort
48727>>>>>                            Get Field_Current_Value Of Barticl_DD  Field Barticl.Barticl_No     to iiBarticleNO
48728>>>>>                            Move '' to sPerigrafh
48729>>>>>                            Move (Append(sPerigrafh,('*'+(Trim(ssBtypkinDescrShort))+'  '+ ;                                                    (String(iiBarticleNO))+ '*'))) to sPerigrafh
48730>>>>>                            //
48730>>>>>                            Set Field_Changed_Value Of Cmoves_DD    Field Cmoves.Cmoves_Par     to (Trim(sPerigrafh))
48731>>>>>
48731>>>>>                            //////////////////////////////////////////////////////////////////////////////
48731>>>>>                            // jsjsjsjs 06/02/2001 ©¬£§¢ž¨à¤¦¤«˜  «˜ §˜¨˜¡˜«à §œ› ˜
48731>>>>>                            //                     £œ «¦  › ¦ §¦©¦ š ˜ ¢¦š¦¬ª reportin ˜¥ ¦š¨˜­à¤
48731>>>>>                            //////////////////////////////////////////////////////////////////////////////
48731>>>>>                            Get Field_Current_Value Of Cmoves_DD Field Cmoves.Cmoves_Axia to nJS
48732>>>>>
48732>>>>>
48732>>>>>                            If (iAntistrofhProshmou)    Move (-1) to iSign
48735>>>>>                            Else                        Move   1  to iSign
48737>>>>>
48737>>>>>                            Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmove_TotAmBd0    ;                                to ((fngConvertPoso(sNomisma,nJS,SysCurXr.C_Code0,dHmnia,nIsotimia))*iSign)
48738>>>>>                            Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmove_TotAmBd00   ;                                to ((fngConvertPoso(sNomisma,nJS,SysCurXr.C_Code00,dHmnia,nIsotimia))*iSign)
48739>>>>>                            Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmove_TotAmBd1    ;                                to ((fngConvertPoso(sNomisma,nJS,SysCurXr.C_CodeR,dHmnia,nIsotimia))*iSign)
48740>>>>>                            //////////////////////////////////////////////////////////////////////////////
48740>>>>>                            //////////////////////////////////////////////////////////////////////////////
48740>>>>>
48740>>>>>
48740>>>>>                            Set Field_Changed_Value Of Cmoves_DD   Field Cmoves.Module_From  to (trim(sModule))
48741>>>>>
48741>>>>>                            Get field_current_value of clients_dd field clients.recnum to iclient
48742>>>>>
48742>>>>>                            If (iClient) Begin
48744>>>>>                                If (iMustSaveClientYpoloipa =1)  Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Enhm_Ypol_Pel   to '1'
48747>>>>>                                If (iMustSaveClient         =1)  Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Enhm_Hmnies_Pel to '1'
48750>>>>>                            End
48750>>>>>>
48750>>>>>
48750>>>>>                            Else begin
48751>>>>>                                error 5011 "Client record not found while saving cmoves"
48752>>>>>>
48752>>>>>                            end
48752>>>>>>
48752>>>>>                            Set Field_Changed_Value Of Cmoves_DD   Field Cmoves.Sls_ID      to sSls_ID
48753>>>>>                            Set Field_Changed_Value Of Cmoves_DD   Field Cmoves.Cnt_ID      to sCnt_ID
48754>>>>>                            Set Field_Changed_Value Of Cmoves_DD   Field Cmoves.Presp_ID    to sPresp_ID
48755>>>>>                            Send Request_Save to Cmoves_DD
48756>>>>>
48756>>>>>                            Get Field_Current_Value Of Cmoves_DD Field Cmoves.Cmoves_Recr to sCmovesRecr
48757>>>>>
48757>>>>>                            If (Trim(sCmovesRecr)='') error 5008 "Saved Cmoves but dont have Recr"
48760>>>>>                            // jsjsjs 31/08/2001
48760>>>>>                            Skip_All_Ctypkin:
48760>>>>>
48760>>>>>                            //Set Field_Changed_Value Of Barticl_DD Field Barticl.Cmoves_Recr      to (Trim(sCmovesRecr))
48760>>>>>                            If ((iAnti=2) Or (iAnti=3)) ;                                Set Field_Changed_Value Of BMove_DD Field BMove.Cmoves_Recr to (Trim(sCmovesRecr))
48763>>>>>                            // jsjsjs 31/08/2001
48763>>>>>
48763>>>>>                            Send Request_Save to Bmove_DD
48764>>>>>                            Set Field_Changed_Value Of Barticl_DD Field Barticl.Barticl_Ekleise  to '1'
48765>>>>>                            Send Request_Save to Barticl_DD
48766>>>>>                        End
48766>>>>>>
48766>>>>>                        Else Begin
48767>>>>>                            // Prosthetos kodikas gia na kleinei kai ta axiografa
48767>>>>>                            // ta opoia den kanoun kammia kinhsh.
48767>>>>>                            Set Field_Changed_Value Of Barticl_DD Field Barticl.Barticl_Ekleise  to '1'
48768>>>>>                            Send Request_Save to Barticl_DD
48769>>>>>                        End
48769>>>>>>
48769>>>>>
48769>>>>>                        // @@##@@## yannis
48769>>>>>                        If ((iMustSaveEpisf<>0) or (imustsaveofeilh<>0)) Begin
48771>>>>>                            Move 0  to nApait
48772>>>>>                            Move 0  to napaitpayresp
48773>>>>>                            Move 0  to nEpitPoso
48774>>>>>                            Move '' to sPelaths
48775>>>>>                            Move 0  to nofeilh
48776>>>>>                            Move 0  to nofeilhpayresp
48777>>>>>                            //Get field_current_value of Baxio_dd field Baxio.Baxio_V0            to nEpitPoso
48777>>>>>                            Get field_current_value of Baxio_dd field Baxio.Baxio_V2            to nEpitPoso
48778>>>>>                            Get field_current_value of Baxio_dd field Baxio.Baxio_Code_In       to sPelaths
48779>>>>>
48779>>>>>                            // js 13/03/2003 Giati oi apografikes xreoseis pou kataxorountai apo
48779>>>>>                            // ta axiografa ?? exoun keno ayto to pedio apo thn klash tou baxio
48779>>>>>                            // Elegxetai to pedio Baxiokat.Baxiokat_Type  opou an einai 2 (Xreosh)
48779>>>>>                            // mhdenizei to pedio tou pelath Baxio.Baxio_Code_In
48779>>>>>                            If (Trim(sPelaths)='') Get field_current_value of Barticl_dd field Barticl.Barticl_code1 to sPelaths
48782>>>>>                            // js 13/03/2003
48782>>>>>
48782>>>>>                            Send Clear to Clients_DD
48783>>>>>                            Move (Trim(sPelaths)) to Clients.Client_ID
48784>>>>>                            Send Find to Clients_DD Eq 6 // Clients:index.6:Client_ID
48785>>>>>                            If (Found=1) Begin
48787>>>>>                                Get field_current_value of clients_dd field clients.Poso_Se_Apait   to nApait
48788>>>>>                                Get field_current_value of payresp_dd field payresp.Poso_Se_Apait   to nApaitpayresp
48789>>>>>                                Get field_current_value of clients_dd field clients.synolikh_ofeilh to nofeilh
48790>>>>>                                Get field_current_value of payresp_dd field payresp.synolikh_ofeilh to nofeilhpayresp
48791>>>>>
48791>>>>>                                If (iMustSaveofeilh=1)  Begin
48793>>>>>                                    If (Baxiokat.Baxiokat_Type = 2) Begin
48795>>>>>                                        Set Field_Changed_Value of clients_dd field clients.synolikh_ofeilh to (nofeilh+nepitposo)
48796>>>>>                                        Send Request_Save to Clients_DD
48797>>>>>                                        Set Field_Changed_Value of payresp_dd field payresp.synolikh_ofeilh to (nofeilhpayresp+nepitposo)
48798>>>>>                                        Send Request_Save to payresp_DD
48799>>>>>                                    End
48799>>>>>>
48799>>>>>                                    Else Begin
48800>>>>>                                        Set Field_Changed_Value of clients_dd field clients.synolikh_ofeilh to (nofeilh-nepitposo)
48801>>>>>                                        Send Request_Save to Clients_DD
48802>>>>>                                        Set Field_Changed_Value of payresp_dd field payresp.synolikh_ofeilh to (nofeilhpayresp-nepitposo)
48803>>>>>                                        Send Request_Save to payresp_DD
48804>>>>>                                    End
48804>>>>>>
48804>>>>>                                End
48804>>>>>>
48804>>>>>
48804>>>>>                                If (iMustSaveEpisf=1)  Begin
48806>>>>>                                    Add nEpitPoso to nApait
48807>>>>>                                    Set Field_Changed_Value of clients_dd field clients.Poso_Se_Apait to nApait
48808>>>>>                                    Send Request_Save to Clients_DD
48809>>>>>                                    Add nEpitPoso to nApaitpayresp
48810>>>>>                                    Set Field_Changed_Value of payresp_dd field payresp.Poso_Se_Apait to nApaitpayresp
48811>>>>>                                    Send Request_Save to payresp_DD
48812>>>>>
48812>>>>>                                End
48812>>>>>>
48812>>>>>                                Else If (iMustSaveEpisf=2)  Begin
48815>>>>>                                    Add (nEpitPoso*(-1)) to nApait
48816>>>>>                                    Set Field_Changed_Value of clients_dd field clients.Poso_Se_Apait to nApait
48817>>>>>                                    Send Request_Save to Clients_DD
48818>>>>>                                    Add (nEpitPoso*(-1)) to nApaitpayresp
48819>>>>>                                    Set Field_Changed_Value of payresp_dd field payresp.Poso_Se_Apait to nApaitpayresp
48820>>>>>                                    Send Request_Save to payresp_DD
48821>>>>>                                End
48821>>>>>>
48821>>>>>
48821>>>>>                                Set Field_Changed_Value Of Barticl_DD Field Barticl.Barticl_Ekleise  to '1'
48822>>>>>                                Send Request_Save to Barticl_DD
48823>>>>>                            End
48823>>>>>>
48823>>>>>                            Else Begin
48824>>>>>                            End
48824>>>>>>
48824>>>>>                        End
48824>>>>>>
48824>>>>>
48824>>>>>                        Move sCtypkinRecr to Ctypkin.Ctypkin_Recr
48825>>>>>                        Send Find to Ctypkin_DD eq 2 //Ctypkin:Index.2:Client_Recr
48826>>>>>                        If (Not(Found)) error 5006 "Ctypkin record not found"
48829>>>>>
48829>>>>>                        Send Find To Bmove_DD Next_Record 3 // Bmove:Index.2:Bmove_Recr
48830>>>>>                    Loop
48831>>>>>>
48831>>>>>
48831>>>>>                    //send info_box "€¥ æš¨˜­˜ œ§ «¬®éª ¡¢œ ©£â¤˜.\nƒœ¤ «¨¦§¦§¦ ¦ç¤«˜  ˜¤ ›œ¤ ¥œ¡¢œ ›é©¦¬¤" '¢ž¨¦­¦¨å˜'
48831>>>>>                End
48831>>>>>>
48831>>>>>            End
48831>>>>>>
48831>>>>>            Else error 5001 "’¦ ˜¨® ¡æ Barticle Recr ›œ¤ ™¨âŸž¡œ"
48833>>>>>        End_procedure
48834>>>>>
48834>>>>>
48834>>>>>        Procedure OnProcess
48836>>>>>            If (psModule(Self)='') error 5999 "Business Process Called without setting psModule property"
48839>>>>>            If (Trim(psBarticleRecr(Self))<>'') Send Deal_With_Barticle
48842>>>>>            Else error 5000  "ƒœ¤ ¬§á¨®œ  ˜¨® ¡æ Barticle Recr"// No Initial Barticle recr is passed
48844>>>>>        End_Procedure
48845>>>>>
48845>>>>>        Procedure Start_Process
48847>>>>>            Integer iErr iID
48848>>>>>            Indicate Err False
48849>>>>>            Set Button_State    of (Wait(Self)) to False
48850>>>>>            Set BarVisibleState of (Wait(Self)) to '' False
48851>>>>>            Send Popup                          to (Wait(Self))
48852>>>>>            Set piLathos                        to 0
48853>>>>>            Forward Send Start_Process
48855>>>>>        End_Procedure
48856>>>>>
48856>>>>>        Procedure End_Process
48858>>>>>            Forward Send End_Process
48860>>>>>            Send Deactivate to (Wait(Self))
48861>>>>>        End_Procedure
48862>>>>>
48862>>>>>        //AB-StoreEnd
48862>>>>>
48862>>>>>    End_Object    // bpencmv3
48863>>>>>
48863>>>>>//AB/     End_Object    // prj
48863>>>
48863>>>Use slNomism.sl
48863>>>Use Globals.Inc
48863>>>Use sl033.sl
INCLUDING FILE: SL033.SL
48863>>>>>//AB/ Project SL033:BKINKAT
48863>>>>>//AB/ Object prj is a Lookup_Project
48863>>>>>//AB/     Set ProjectName to "SL033:BKINKAT"
48863>>>>>//AB/     Set ProjectFileName to "sl033.SL"
48863>>>>>
48863>>>>>// Project Object Structure
48863>>>>>//   sl033 is a dbModalPanelSub
48863>>>>>//     Company_DD is a DataDictionary
48863>>>>>//     Branch_DD is a DataDictionary
48863>>>>>//     Year_DD is a DataDictionary
48863>>>>>//     Btypkin_DD is a DataDictionary
48863>>>>>//     Baxiokat_DD is a DataDictionary
48863>>>>>//     Bkinkat_DD is a DataDictionary
48863>>>>>//     oSelList is a dbListSub
48863>>>>>//     oOK_bn is a ButtonSub
48863>>>>>//     oCancel_bn is a ButtonSub
48863>>>>>//     oSearch_bn is a ButtonSub
48863>>>>>
48863>>>>>// Register all objects
48863>>>>>Register_Object Baxiokat_DD
48863>>>>>Register_Object Bkinkat_DD
48863>>>>>Register_Object Branch_DD
48863>>>>>Register_Object Btypkin_DD
48863>>>>>Register_Object Company_DD
48863>>>>>Register_Object oCancel_bn
48863>>>>>Register_Object oOK_bn
48863>>>>>Register_Object oSearch_bn
48863>>>>>Register_Object oSelList
48863>>>>>Register_Object sl033
48863>>>>>Register_Object Year_DD
48863>>>>>
48863>>>>>
48863>>>>>//AB-IgnoreStart
48863>>>>>
48863>>>>>Use DFAllEnt.pkg
48863>>>>>Use dbList.Sub
48863>>>>>Use Button.Sub
48863>>>>>
48863>>>>>
48863>>>>>Use COMPANY.DD
48863>>>>>Use BRANCH.DD
48863>>>>>Use YEAR.DD
48863>>>>>Use BTYPKIN.DD
48863>>>>>Use BAXIOKAT.DD
48863>>>>>Use BKINKAT.DD
INCLUDING FILE: BKINKAT.DD
48863>>>>>>>//DDB-FileStart
48863>>>>>>>//DDB-HeaderStart
48863>>>>>>>
48863>>>>>>>// File Name : BKINKAT.DD
48863>>>>>>>// Class Name: Bkinkat_DataDictionary
48863>>>>>>>// Revision  : 39
48863>>>>>>>// Version   : 2
48863>>>>>>>
48863>>>>>>>Use  Windows           // Basic Definitions
48863>>>>>>>Use  DataDict          // DataDictionary Class Definition
48863>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48863>>>>>>>
48863>>>>>>>Open Bkinkat
48865>>>>>>>Open Bkinkath
INCLUDING FILE: BKINKATH.FD
48867>>>>>>>Open Baxiokat
48869>>>>>>>Open Btypkin
48871>>>>>>>Open Sysrecb
48873>>>>>>>Open Bmove
48875>>>>>>>
48875>>>>>>>//DDB-HeaderEnd
48875>>>>>>>//DDB-ValidationStart
48875>>>>>>>
48875>>>>>>>//DDB/ ExternalValidationTable Baxio_Status_VT  Baxio.Pkg
48875>>>>>>>
48875>>>>>>>Register_Object Bkinkat_Bkinkat_Yn_New_VT
48875>>>>>>>Register_Object Baxio_Status_VT
48875>>>>>>>Register_Object Bkinkat_Baxio_Place_VT
48875>>>>>>>Use Baxio.Pkg        // Baxio_Status_VT
48875>>>>>>>
48875>>>>>>>Object Bkinkat_Bkinkat_Yn_New_VT  is a DescriptionValidationTable
48877>>>>>>>
48877>>>>>>>    Procedure Fill_List
48879>>>>>>>        Forward Send Fill_List
48881>>>>>>>        Send Add_Table_Value  "0"  "Ž® "
48882>>>>>>>        Send Add_Table_Value  "1"  "Œ˜ "
48883>>>>>>>    End_Procedure    // Fill_List
48884>>>>>>>    //DDB-ValidationCustomStart
48884>>>>>>>    //DDB-ValidationCustomEnd
48884>>>>>>>End_Object   // Bkinkat_Bkinkat_Yn_New_VT
48885>>>>>>>
48885>>>>>>>Object Bkinkat_Baxio_Place_VT  is a CodeValidationTable
48887>>>>>>>    Set Type_Value        To "BAXIOPLACE"
48888>>>>>>>    Set Allow_Blank_State To TRUE
48889>>>>>>>    //DDB-ValidationCustomStart
48889>>>>>>>    //DDB-ValidationCustomEnd
48889>>>>>>>End_Object   // Bkinkat_Baxio_Place_VT
48890>>>>>>>//DDB-ValidationEnd
48890>>>>>>>Open SysCurXr
48892>>>>>>>
48892>>>>>>>Class Bkinkat_DataDictionary  is a DataDictionary_Sec
48893>>>>>>>
48893>>>>>>>    // Creating:
48893>>>>>>>
48893>>>>>>>    Procedure Creating
48894>>>>>>>        Forward Send Creating
48896>>>>>>>        // Insert Code Here
48896>>>>>>>        Move (Append('',((Trim(SysCurXr.Branch_Site))+;                         (Trim(String(Bkinkat.Bkinkat_Rec0)))))) to Bkinkat.Bkinkat_Recr
48897>>>>>>>    End_Procedure   // Creating
48898>>>>>>>
48898>>>>>>>      //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
48898>>>>>>>      //™) ˜¤áš¤à©ž properties
48898>>>>>>>      //š) › ˜®œå¨ ©ž calculated §œ›åà¤
48898>>>>>>>      //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
48898>>>>>>>      //œ) œ¤ž£â¨à©ž properties after
48898>>>>>>>      Procedure Update
48899>>>>>>>                Forward Send Update
48901>>>>>>>
48901>>>>>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
48901>>>>>>>                Move Syscurxr.Company_Code  to Bkinkat.Company_Code
48902>>>>>>>                Move Syscurxr.Branch_Code   to Bkinkat.Branch_Code
48903>>>>>>>                Move Syscurxr.Year_Year     to Bkinkat.Year_Year
48904>>>>>>>                Move Btypkin.Btypkin_Code   to Bkinkat.Btypkin_Code
48905>>>>>>>                Move Baxiokat.Baxiokat_Code to Bkinkat.Baxiokat_Code
48906>>>>>>>
48906>>>>>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
48906>>>>>>>                //š.1:baxio_stat_from + baxio_plac_from:
48906>>>>>>>                //    æ«˜¤ ›ž£ ¦¬¨š¦ç£œ ¤â¦ ˜¥ æš¨˜­¦,
48906>>>>>>>                //    §¨¦­˜¤éª "â¨®œ«˜ " ˜§¦ «¦ §¦¬Ÿœ¤á !
48906>>>>>>>                //    ¡˜  â®œ  ¡˜«á©«˜©ž 1
48906>>>>>>>                If (Bkinkat.Bkinkat_Yn_New = 1);                Begin
48908>>>>>>>                     Move 1 to Bkinkat.Baxio_Stat_From //¡˜«á©«˜ž ˜§æ = œ¡¡¨œ£âª
48909>>>>>>>                     Move 0 to Bkinkat.Baxio_Plac_From //¤â¦ ˜¥ æš¨˜­¦
48910>>>>>>>                End
48910>>>>>>>>
48910>>>>>>>                Else;                Begin //©«ã¤ ˜¤«åŸœ«ž §œ¨å§«à©ž, §¨â§œ  «˜ 2 §œ›å˜ ¤˜ œå¤˜  > 0
48911>>>>>>>                     //If (Not(Bkinkat.Baxio_Stat_From > 0)) Send Operation_Not_Allowed 3001 //¡˜«á©«˜ž ˜§æ = œ¡¡¨œ£âª
48911>>>>>>>                     If (Not(Bkinkat.Baxio_Plac_From > 0)) Send Operation_Not_Allowed 3001 //«¦ ¬§á¨®¦¤ ˜¥ æš¨˜­¦ §¨â§œ  ¡á§¦¬ ¤˜ ™¨å©¡œ«˜ 
48914>>>>>>>                End
48914>>>>>>>>
48914>>>>>>>
48914>>>>>>>                //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ btypkin
48914>>>>>>>                Add 1 to   Btypkin.Bkinkat_Num
48915>>>>>>>
48915>>>>>>>                //Move BkinKat.BkinKat_Rec0   to BkinKat.BkinKat_code
48915>>>>>>>      End_Procedure   //update
48916>>>>>>>
48916>>>>>>>
48916>>>>>>>      Procedure Backout
48917>>>>>>>                Forward Send Backout
48919>>>>>>>
48919>>>>>>>                //œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ Btypkin
48919>>>>>>>                Sub 1 from Btypkin.Bkinkat_Num
48920>>>>>>>      End_Procedure   //backout
48921>>>>>>>
48921>>>>>>>
48921>>>>>>>      Procedure Operation_Not_Allowed Integer iError_Num
48922>>>>>>>                String lsError_Message
48923>>>>>>>                Case Begin
48923>>>>>>>                     //˜§æ validate save
48923>>>>>>>                     Case (iError_Num = 1001)
48925>>>>>>>                     Case Break
48926>>>>>>>                     //˜§æ update
48926>>>>>>>                     Case (iError_Num = 3001)
48929>>>>>>>                          Move ("DDC 146:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n’¦ ¬§á¨®¦¤ ˜¥ æš¨˜­¦ §¨â§œ  ¡á§¦¬ ¤˜ ™¨å©¡œ«˜  !");                          to lsError_Message
48930>>>>>>>                     Case Break
48931>>>>>>>
48931>>>>>>>                     Case Else
48931>>>>>>>                          Forward Send Operation_Not_Allowed iError_Num
48933>>>>>>>                Case End
48933>>>>>>>
48933>>>>>>>                Error iError_Num lsError_Message
48934>>>>>>>>
48934>>>>>>>      End_Procedure // operation_not_allowed
48935>>>>>>>
48935>>>>>>>
48935>>>>>>>//----------------------------------------------------------------------------
48935>>>>>>>    Procedure Define_Fields
48936>>>>>>>        Forward Send Define_Fields
48938>>>>>>>        //DDB-Generated-Code-Location
48938>>>>>>>        //DDB-DefineFieldStart
48938>>>>>>>
48938>>>>>>>        Set Main_File            To Bkinkat.File_Number
48939>>>>>>>        Set Cascade_Delete_State To FALSE
48940>>>>>>>
48940>>>>>>>
48940>>>>>>>        // Child (Client) file structure................
48940>>>>>>>        Send Add_Client_File  Bkinkath.File_Number
48941>>>>>>>
48941>>>>>>>        // Parent (Server) file structure...............
48941>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
48942>>>>>>>        Send Add_Server_File  Btypkin.File_Number
48943>>>>>>>
48943>>>>>>>        // External (System) file structure.............
48943>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
48944>>>>>>>        Send Add_System_File  Bmove.File_Number  DD_LOCK_ON_ALL
48945>>>>>>>
48945>>>>>>>        Define_Auto_Increment  Sysrecb.Bkinkat_Rec0  To Bkinkat.Bkinkat_Rec0
48948>>>>>>>
48948>>>>>>>        // Field-based properties.......................
48948>>>>>>>
48948>>>>>>>        // Bkinkat.Company_Code
48948>>>>>>>
48948>>>>>>>        // Bkinkat.Branch_Code
48948>>>>>>>
48948>>>>>>>        // Bkinkat.Year_Year
48948>>>>>>>
48948>>>>>>>        // Bkinkat.Btypkin_Code
48948>>>>>>>
48948>>>>>>>        // Bkinkat.Baxiokat_Code
48948>>>>>>>
48948>>>>>>>        // Bkinkat.Bkinkat_Code
48948>>>>>>>
48948>>>>>>>        // Bkinkat.Bkinkat_Rec0
48948>>>>>>>
48948>>>>>>>        // Bkinkat.Bkinkat_Recr
48948>>>>>>>
48948>>>>>>>        // Bkinkat.Btypkin_Recr
48948>>>>>>>
48948>>>>>>>        // Bkinkat.Baxiokat_Recr
48948>>>>>>>
48948>>>>>>>        // Bkinkat.Bkinkat_Yn_New
48948>>>>>>>        Set Field_Value_Table      Field Bkinkat.Bkinkat_Yn_New To (Bkinkat_Bkinkat_Yn_New_VT(Self))
48949>>>>>>>
48949>>>>>>>        // Bkinkat.Baxio_Stat_From
48949>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Stat_From To (Baxio_Status_VT(Self))
48950>>>>>>>
48950>>>>>>>        // Bkinkat.Baxio_Stat_To
48950>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Stat_To To (Baxio_Status_VT(Self))
48951>>>>>>>
48951>>>>>>>        // Bkinkat.Baxio_Plac_From
48951>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Plac_From To (Bkinkat_Baxio_Place_VT(Self))
48952>>>>>>>
48952>>>>>>>        // Bkinkat.Baxio_Plac_To
48952>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Plac_To To (Bkinkat_Baxio_Place_VT(Self))
48953>>>>>>>
48953>>>>>>>        // Bkinkat.Bkinkat_Gplncod
48953>>>>>>>
48953>>>>>>>        //DDB-DefineFieldEnd
48953>>>>>>>
48953>>>>>>>        Set Main_File            To Bkinkat.File_Number
48954>>>>>>>        Set Cascade_Delete_State To FALSE
48955>>>>>>>
48955>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
48956>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
48957>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48958>>>>>>>
48958>>>>>>>        // Parent (Server) file structure...............
48958>>>>>>>        Send Add_Server_File  Btypkin.File_Number
48959>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
48960>>>>>>>
48960>>>>>>>        // External (System) file structure.............
48960>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
48961>>>>>>>
48961>>>>>>>        Define_Auto_Increment  Sysrecb.Bkinkat_Rec0  To Bkinkat.Bkinkat_Rec0
48964>>>>>>>
48964>>>>>>>        // Field-based properties.......................
48964>>>>>>>
48964>>>>>>>        // Bkinkat.Btypkin_Code
48964>>>>>>>        Set Key_Field_State        Field Bkinkat.Btypkin_Code     To TRUE
48965>>>>>>>
48965>>>>>>>        // Bkinkat.Baxiokat_Code
48965>>>>>>>        Set Field_Options          Field Bkinkat.Baxiokat_Code    To DD_AUTOFIND
48966>>>>>>>        Set Key_Field_State        Field Bkinkat.Baxiokat_Code    To TRUE
48967>>>>>>>
48967>>>>>>>        // Bkinkat.Bkinkat_Rec0
48967>>>>>>>        Set Field_Options          Field Bkinkat.Bkinkat_Rec0     To DD_NOPUT
48968>>>>>>>
48968>>>>>>>        // Bkinkat.Btypkin_Rec0
48968>>>>>>>        //Set Field_Options          Field Bkinkat.Btypkin_Rec0     To DD_NOPUT
48968>>>>>>>
48968>>>>>>>        // Bkinkat.Baxiokat_Rec0
48968>>>>>>>        //Set Field_Options          Field Bkinkat.Baxiokat_Rec0    To DD_NOPUT
48968>>>>>>>
48968>>>>>>>        // Bkinkat.Bkinkat_Yn_New
48968>>>>>>>        Set Field_Class_Name       Field Bkinkat.Bkinkat_Yn_New   To "dbComboForm_EZ"
48969>>>>>>>        Set Field_Label_Long       Field Bkinkat.Bkinkat_Yn_New   To "Œâ¦ €¥ æš¨˜­¦ ?"
48970>>>>>>>        Set Field_Label_Short      Field Bkinkat.Bkinkat_Yn_New   To "Œâ¦ ?"
48971>>>>>>>        Set Field_Value_Table      Field Bkinkat.Bkinkat_Yn_New   To (Bkinkat_Bkinkat_Yn_New_VT(Self))
48972>>>>>>>
48972>>>>>>>        // Bkinkat.Baxio_Stat_From
48972>>>>>>>        Set Field_Class_Name       Field Bkinkat.Baxio_Stat_From  To "dbComboForm_EZ"
48973>>>>>>>        Set Field_Label_Long       Field Bkinkat.Baxio_Stat_From  To "‰˜«á©«˜©ž €§æ"
48974>>>>>>>        Set Field_Label_Short      Field Bkinkat.Baxio_Stat_From  To "‰˜«á©«˜©ž €§æ"
48975>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Stat_From  To (Baxio_Status_VT(Self))
48976>>>>>>>
48976>>>>>>>        // Bkinkat.Baxio_Stat_To
48976>>>>>>>        Set Field_Class_Name       Field Bkinkat.Baxio_Stat_To    To "dbComboForm_EZ"
48977>>>>>>>        Set Field_Label_Long       Field Bkinkat.Baxio_Stat_To    To "‰˜«á©«˜©ž ‘â"
48978>>>>>>>        Set Field_Label_Short      Field Bkinkat.Baxio_Stat_To    To "‰˜«á©«˜©ž ‘â"
48979>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Stat_To    To (Baxio_Status_VT(Self))
48980>>>>>>>
48980>>>>>>>        // Bkinkat.Baxio_Plac_From
48980>>>>>>>        Set Field_Class_Name       Field Bkinkat.Baxio_Plac_From  To "dbComboForm_EZ"
48981>>>>>>>        Set Field_Label_Long       Field Bkinkat.Baxio_Plac_From  To "„¬¨å¡œ«¦ ©â"
48982>>>>>>>        Set Field_Label_Short      Field Bkinkat.Baxio_Plac_From  To "„¬¨å¡œ«¦ ©â"
48983>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Plac_From  To (Bkinkat_Baxio_Place_VT(Self))
48984>>>>>>>
48984>>>>>>>        // Bkinkat.Baxio_Plac_To
48984>>>>>>>        Set Field_Class_Name       Field Bkinkat.Baxio_Plac_To    To "dbComboForm_EZ"
48985>>>>>>>        Set Field_Label_Long       Field Bkinkat.Baxio_Plac_To    To "áœ  ‘â"
48986>>>>>>>        Set Field_Label_Short      Field Bkinkat.Baxio_Plac_To    To "áœ  ‘â"
48987>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Plac_To    To (Bkinkat_Baxio_Place_VT(Self))
48988>>>>>>>
48988>>>>>>>        // Bkinkat.Bkinkat_Gplncod
48988>>>>>>>        Set Field_Label_Long       Field Bkinkat.Bkinkat_Gplncod  To "‰à› ¡æª ‚Š"
48989>>>>>>>        Set Field_Label_Short      Field Bkinkat.Bkinkat_Gplncod  To "‰à› ¡æª ‚Š"
48990>>>>>>>        //Set Field_Prompt_Object    Field Bkinkat.Bkinkat_Gplncod  To (SL056(Self))
48990>>>>>>>
48990>>>>>>>    End_Procedure    // Define_Fields
48991>>>>>>>
48991>>>>>>>
48991>>>>>>>    Procedure Field_Defaults
48992>>>>>>>        Forward Send Field_Defaults
48994>>>>>>>        //DDB-Generated-Code-Location
48994>>>>>>>        //DDB-FieldDefaultStart
48994>>>>>>>        //DDB-FieldDefaultEnd
48994>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Bkinkat_Yn_New   To 0
48995>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Baxio_Stat_From  To "1"
48996>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Baxio_Stat_To    To "1"
48997>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Baxio_Plac_From  To "1"
48998>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Baxio_Plac_To    To "1"
48999>>>>>>>    End_Procedure    // Field_Defaults
49000>>>>>>>
49000>>>>>>>End_Class    // Bkinkat_DataDictionary
49001>>>>>>>//DDB-FileEnd
49001>>>>>
49001>>>>>//AB-IgnoreEnd
49001>>>>>
49001>>>>>CD_Popup_Object sl033 is a dbModalPanelSub
49020>>>>>
49020>>>>>    //AB-StoreTopStart
49020>>>>>    Property Integer piFragmaBtypkinCode 0
49022>>>>>    
49022>>>>>    
49022>>>>>    
49022>>>>>    //AB-StoreTopEnd
49022>>>>>
49022>>>>>    Set Label to "‰˜«žš¦¨åœª ˜¥ ¦š¨á­à¤ š ˜ « ª ¡ ¤ã©œ ª"
49023>>>>>    Set Size to 206 362
49024>>>>>    Set Location to 4 5
49025>>>>>    Set Exit_Application_Local_State to FALSE
49026>>>>>    Set Modal_State to FALSE
49027>>>>>
49027>>>>>    //AB-DDOStart
49027>>>>>
49027>>>>>    Object Company_DD is a Company_DataDictionary
49029>>>>>    End_Object    // Company_DD
49030>>>>>
49030>>>>>    Object Branch_DD is a Branch_DataDictionary
49032>>>>>        Set DDO_Server to (Company_DD(self))
49033>>>>>    End_Object    // Branch_DD
49034>>>>>
49034>>>>>    Object Year_DD is a Year_DataDictionary
49036>>>>>        Set DDO_Server to (Branch_DD(self))
49037>>>>>    End_Object    // Year_DD
49038>>>>>
49038>>>>>    Object Btypkin_DD is a Btypkin_DataDictionary
49040>>>>>        Set DDO_Server to (Year_DD(self))
49041>>>>>    End_Object    // Btypkin_DD
49042>>>>>
49042>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
49044>>>>>    End_Object    // Baxiokat_DD
49045>>>>>
49045>>>>>    Object Bkinkat_DD is a Bkinkat_DataDictionary
49047>>>>>        Set DDO_Server to (Btypkin_DD(self))
49048>>>>>        Set DDO_Server to (Baxiokat_DD(self))
49049>>>>>
49049>>>>>        //AB-StoreStart
49049>>>>>                                
49049>>>>>        Procedure OnConstrain
49051>>>>>            Integer liBtypkinCode
49052>>>>>        
49052>>>>>            Get piFragmaBtypkinCode to liBtypkinCode
49053>>>>>            If (liBtypkinCode <> 0) Constrain Bkinkat.Btypkin_Code eq liBtypkinCode
49057>>>>>        End_Procedure // OnConstrain
49058>>>>>        
49058>>>>>        //AB-StoreEnd
49058>>>>>
49058>>>>>    End_Object    // Bkinkat_DD
49059>>>>>
49059>>>>>    Set Main_DD to (Bkinkat_DD(self))
49060>>>>>    Set Server to (Bkinkat_DD(self))
49061>>>>>
49061>>>>>    //AB-DDOEnd
49061>>>>>
49061>>>>>    Object oSelList is a dbListSub
49063>>>>>        Set Main_File to Bkinkat.File_Number
49064>>>>>        Set Size to 164 350
49065>>>>>        Set Location to 5 4
49066>>>>>
49066>>>>>        Begin_Row
49069>>>>>            Entry_Item Baxiokat.Baxiokat_code
49070>>>>>            Entry_Item Baxiokat.Baxiokat_descr
49071>>>>>            Entry_Item Baxiokat.Baxiokat_type
49072>>>>>            Entry_Item (Export_Code_Description(Self,2,Baxiokat.Baxiokat_type))
49073>>>>>        End_Row
49078>>>>>
49078>>>>>        Set Form_Width    item 0 to 36
49079>>>>>        Set Header_Label  item 0 to "„ ›¦ª"
49080>>>>>        
49080>>>>>        Set Form_Width    item 1 to 194
49081>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
49082>>>>>        
49082>>>>>        Set Form_Width    item 2 to 29
49083>>>>>        Set Header_Label  item 2 to "„ ©./¢ž¨."
49084>>>>>        
49084>>>>>        Set Form_Width    item 3 to 83
49085>>>>>        Set Header_Label  item 3 to "„ ©./¢ž¨."
49086>>>>>        
49086>>>>>
49086>>>>>        //AB-StoreStart
49086>>>>>                                
49086>>>>>        Property Integer piStoreFragmaBtypkinCode 0
49088>>>>>        
49088>>>>>        
49088>>>>>        Procedure Store_Defaults
49090>>>>>           Forward Send Store_Defaults
49092>>>>>           Set piStoreFragmaBtypkinCode to (piFragmaBtypkinCode(Self))
49093>>>>>        End_Procedure
49094>>>>>        
49094>>>>>        Procedure ReStore_Defaults
49096>>>>>           Forward Send ReStore_Defaults
49098>>>>>           Set piFragmaBtypkinCode to (piStoreFragmaBtypkinCode(Self))
49099>>>>>        End_Procedure
49100>>>>>        
49100>>>>>        Procedure Activating
49102>>>>>           Forward Send Activating
49104>>>>>           Send Rebuild_Constraints to Bkinkat_DD
49105>>>>>        End_Procedure
49106>>>>>        
49106>>>>>        
49106>>>>>        //AB-StoreEnd
49106>>>>>
49106>>>>>    End_Object    // oSelList
49107>>>>>
49107>>>>>    Object oOK_bn is a ButtonSub
49109>>>>>        Set Label to "&„§ ¢¦šã"
49110>>>>>        Set Location to 172 195
49111>>>>>
49111>>>>>        //AB-StoreStart
49111>>>>>        Procedure OnClick
49113>>>>>            Send OK To (oSelList(current_object))
49114>>>>>        End_Procedure
49115>>>>>        //AB-StoreEnd
49115>>>>>
49115>>>>>    End_Object    // oOK_bn
49116>>>>>
49116>>>>>    Object oCancel_bn is a ButtonSub
49118>>>>>        Set Label to "&€¡ç¨à©ž"
49119>>>>>        Set Location to 172 250
49120>>>>>
49120>>>>>        //AB-StoreStart
49120>>>>>        Procedure OnClick
49122>>>>>            Send Cancel To (oSelList(current_object))
49123>>>>>        End_Procedure
49124>>>>>        //AB-StoreEnd
49124>>>>>
49124>>>>>    End_Object    // oCancel_bn
49125>>>>>
49125>>>>>    Object oSearch_bn is a ButtonSub
49127>>>>>        Set Label to "€&¤˜ã«ž©ž"
49128>>>>>        Set Location to 172 304
49129>>>>>
49129>>>>>        //AB-StoreStart
49129>>>>>        Procedure OnClick
49131>>>>>            Send Search To (oSelList(current_object))
49132>>>>>        End_Procedure
49133>>>>>        //AB-StoreEnd
49133>>>>>
49133>>>>>    End_Object    // oSearch_bn
49134>>>>>
49134>>>>>
49134>>>>>    //AB-StoreStart
49134>>>>>    
49134>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49135>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49136>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49137>>>>>    
49137>>>>>    
49137>>>>>    
49137>>>>>    
49137>>>>>    //AB-StoreEnd
49137>>>>>
49137>>>>>CD_End_Object    // sl033
49139>>>>>>
49139>>>>>
49139>>>>>//AB/ End_Object    // prj
49139>>>Use r044.rv
INCLUDING FILE: R044.RV
49139>>>>>//AB/ Project R044:BMOVES
49139>>>>>//AB/     Object prj is a Report_Project
49139>>>>>//AB/         Set ProjectName to "R044:BMOVES"
49139>>>>>//AB/         Set ProjectFileName to "r044.RV"
49139>>>>>
49139>>>>>// Project Object Structure
49139>>>>>//   R044 is a ReportViewSub
49139>>>>>//     GroupSub2 is a GroupSub
49139>>>>>//       FormSub1 is a FormSub
49139>>>>>//       FormSub2 is a FormSub
49139>>>>>//       TextBoxSub7 is a TextBoxSub
49139>>>>>//       TextBoxSub8 is a TextBoxSub
49139>>>>>//     GroupSub1 is a GroupSub
49139>>>>>//       frmG12_3 is a FormSub
49139>>>>>//       frmG12_4 is a FormSub
49139>>>>>//       TextBoxSub3 is a TextBoxSub
49139>>>>>//       TextBoxSub4 is a TextBoxSub
49139>>>>>//     GroupSub3 is a GroupSub
49139>>>>>//       frmG1 is a FormSub
49139>>>>>//       frmG2 is a FormSub
49139>>>>>//       TextBoxSub9 is a TextBoxSub
49139>>>>>//       TextBoxSub10 is a TextBoxSub
49139>>>>>//     oSelectCurr is a GroupSub
49139>>>>>//       chkbCurr0 is a CheckBoxSub
49139>>>>>//       chkbCurr00 is a CheckBoxSub
49139>>>>>//       chkbCurrR is a CheckBoxSub
49139>>>>>//       chkbKeepTogether is a CheckBoxSub
49139>>>>>//     rdgSelectPrint is a RadioGroupSub
49139>>>>>//       RadioSub5 is a RadioSub
49139>>>>>//       RadioSub6 is a RadioSub
49139>>>>>//       rdFile is a RadioSub
49139>>>>>//       frmFile is a FormSub
49139>>>>>//     FormSub5 is a FormSub
49139>>>>>//     oPrint_bn is a ButtonSub
49139>>>>>//     oExit_bn is a ButtonSub
49139>>>>>//     grpYear is a GroupSub
49139>>>>>//       frmCompany is a FormSub
49139>>>>>//       frmBranch is a FormSub
49139>>>>>//       frmYear is a FormSub
49139>>>>>//       TextBoxSub11 is a TextBoxSub
49139>>>>>//       TextBoxSub12 is a TextBoxSub
49139>>>>>//       TextBoxSub13 is a TextBoxSub
49139>>>>>//     oClear_bn is a ButtonSub
49139>>>>>//     Textbox1 is a Textbox
49139>>>>>//     branch_name is a FormSub
49139>>>>>//     BMoves_BasicReport is a BasicReportSub
49139>>>>>
49139>>>>>// Register all objects
49139>>>>>Register_Object BMoves_BasicReport
49139>>>>>Register_Object branch_name
49139>>>>>Register_Object chkbCurr0
49139>>>>>Register_Object chkbCurr00
49139>>>>>Register_Object chkbCurrR
49139>>>>>Register_Object chkbKeepTogether
49139>>>>>Register_Object FormSub1
49139>>>>>Register_Object FormSub2
49139>>>>>Register_Object FormSub5
49139>>>>>Register_Object frmBranch
49139>>>>>Register_Object frmCompany
49139>>>>>Register_Object frmFile
49139>>>>>Register_Object frmG1
49139>>>>>Register_Object frmG12_3
49139>>>>>Register_Object frmG12_4
49139>>>>>Register_Object frmG2
49139>>>>>Register_Object frmYear
49139>>>>>Register_Object GroupSub1
49139>>>>>Register_Object GroupSub2
49139>>>>>Register_Object GroupSub3
49139>>>>>Register_Object grpYear
49139>>>>>Register_Object oClear_bn
49139>>>>>Register_Object oExit_bn
49139>>>>>Register_Object oPrint_bn
49139>>>>>Register_Object oSelectCurr
49139>>>>>Register_Object R044
49139>>>>>Register_Object RadioSub5
49139>>>>>Register_Object RadioSub6
49139>>>>>Register_Object rdFile
49139>>>>>Register_Object rdgSelectPrint
49139>>>>>Register_Object TextBoxSub10
49139>>>>>Register_Object TextBoxSub11
49139>>>>>Register_Object TextBoxSub12
49139>>>>>Register_Object TextBoxSub13
49139>>>>>Register_Object TextBoxSub3
49139>>>>>Register_Object TextBoxSub4
49139>>>>>Register_Object TextBoxSub7
49139>>>>>Register_Object TextBoxSub8
49139>>>>>Register_Object TextBoxSub9
49139>>>>>Register_Object Textbox1
49139>>>>>
49139>>>>>
49139>>>>>//AB/     Report View
49139>>>>>
49139>>>>>
49139>>>>>    //AB-StoreTopStart
49139>>>>>    Use DFAllRpt.pkg
49139>>>>>    Use BasicRpt.Sub
INCLUDING FILE: BASICRPT.SUB
49139>>>>>>>Use Dfrpt.pkg
49139>>>>>>>
49139>>>>>>>Class BasicReportSub is a BasicReport
49140>>>>>>>
49140>>>>>>>  Procedure Start_Log
49141>>>>>>>     Send Log_Status ("Starting Report:"+Report_Title(Current_Object))
49142>>>>>>>  End_Procedure // Start_Log
49143>>>>>>>
49143>>>>>>>  Procedure End_Log
49144>>>>>>>     Send Log_Status ("Ending Report:  " + Report_Title(Current_Object))
49145>>>>>>>  End_Procedure // End_Log
49146>>>>>>>
49146>>>>>>>  Procedure Error_Log_Status integer ErrNum integer Err_Line string ErrMsg
49147>>>>>>>     Send Log_Status ("Error #"* String(ErrNum) + "." * ErrMsg)
49148>>>>>>>  End_Procedure // Error_Log_Status
49149>>>>>>>
49149>>>>>>>  Procedure Update_Status_Page
49150>>>>>>>     If (Page_End(Current_Object)) EQ 0 ;        Send Update_Status ("Record: " + String(Page_Count(Current_Object)))
49153>>>>>>>     Else Send Update_Status ("Page: " + String(Page_Count(Current_Object)))
49155>>>>>>>  End_Procedure // Update_Status_Page
49156>>>>>>>
49156>>>>>>>  Function Report_Interrupt Returns Integer
49157>>>>>>>     Integer rVal
49158>>>>>>>     String Mess
49158>>>>>>>
49158>>>>>>>     If (Error_Check_State(Current_Object)) ;        Move "An error occured during processing. Do you want to cancel ?" to Mess
49161>>>>>>>     Else ;            Move  "Do you want to cancel the process ?" to Mess
49163>>>>>>>            Get YesNo_Box Mess "Process Interrupted" to rVal
49164>>>>>>>     Function_Return (Rval=MBR_YES)
49165>>>>>>>  End_Function  // Report_Interrupt
49166>>>>>>>
49166>>>>>>>End_Class // BasicReportSub
49167>>>>>>>
49167>>>>>>>Class WinReportSub is a WinReport
49168>>>>>>>
49168>>>>>>>  Procedure Start_Log
49169>>>>>>>     Send Log_Status ("Start Report:"+Report_Title(Current_Object))
49170>>>>>>>  End_Procedure // Start_Log
49171>>>>>>>
49171>>>>>>>  Procedure End_Log
49172>>>>>>>     Send Log_Status ("End Report:  " + Report_Title(Current_Object))
49173>>>>>>>  End_Procedure // End_Log
49174>>>>>>>
49174>>>>>>>  Procedure Error_Log_Status integer ErrNum integer Err_Line string ErrMsg
49175>>>>>>>     Send Log_Status ("Error #"* String(ErrNum) + "." * ErrMsg)
49176>>>>>>>  End_Procedure // Error_Log_Status
49177>>>>>>>
49177>>>>>>>  Procedure Update_Status_Page
49178>>>>>>>     If (Page_End(Current_Object)) EQ 0 ;        Send Update_Status ("Record: " + String(Page_Count(Current_Object)))
49181>>>>>>>     Else Send Update_Status ("Page: " + String(Page_Count(Current_Object)))
49183>>>>>>>  End_Procedure // Update_Status_Page
49184>>>>>>>
49184>>>>>>>  Function Report_Interrupt Returns Integer
49185>>>>>>>     Integer rVal
49186>>>>>>>     String Mess
49186>>>>>>>
49186>>>>>>>     If (Error_Check_State(Current_Object)) ;        Move "An error occured during processing. Do you want to cancel ?" to Mess
49189>>>>>>>     Else ;            Move  "Do you want to cancel the process ?" to Mess
49191>>>>>>>            Get YesNo_Box Mess "Process Interrupted" to rVal
49192>>>>>>>     Function_Return (Rval=MBR_YES)
49193>>>>>>>  End_Function  // Report_Interrupt
49194>>>>>>>
49194>>>>>>>End_Class // WinReportSub
49195>>>>>>>
49195>>>>>    
49195>>>>>    Use SysCurXr.DD
49195>>>>>    Use BTYPKIN.DD
49195>>>>>    Use BARTICL.DD
49195>>>>>    Use BMOVE.DD
49195>>>>>    Use BAXIOKAT.DD
49195>>>>>    Use BAXIO.DD
49195>>>>>    
49195>>>>>    Use Rvi044.pkg
INCLUDING FILE: RVI044.PKG
/HEADERR044
Image 2, HEADERR044
 ________________________________________   ________________________________________   _________________
                                            †‹„ŽŠŽ‚ˆŽ €ˆŽ‚€”—Œ
                                            =====================
/SubHeaderR044_1
Image 3, SUBHEADERR044_1
_____________________________________________________________________________   ‘„ˆ€ : ___
‰ˆŒ†‘† : _________     €.€€‘’.: ____________.     €.€‡Ž“ : ____________.  †‹/Œˆ€ : __/__/____
‘“Œ€ŠŠ€‘Ž‹„ŒŽ‘ : ___________________________________
€€Š†’†‘     : ___________________________________   ‰“ˆŽ ŒŽ‹ˆ‘‹€ •†‘†‘ : ___________   ‘“ŒŽŠŽ : _,___,___,___.__
€ˆ’ˆŽŠŽ‚ˆ€ : _______________________________________________
-------------------------------------------------------------------------------------------------------------------------------
   €/€ „ˆƒŽ‘                    ‰—ƒˆ‰Ž‘ ’€„…€     €ˆ‡‹Ž‘      ŒŽ‹ˆ‘‹€             Ž‘Ž        Š†† ‰“ˆŽ               Ž‘Ž
                                                                 „‚‚€”†‘                             ŒŽ‹ˆ‘‹€
-------------------------------------------------------------------------------------------------------------------------------
/SubHeaderR044_2
Image 4, SUBHEADERR044_2
/BodyR044
Image 5, BODYR044
_____. _________________ _____________. ___________ ____________ _______ _,___,___,___.__  __/__/____ _______ _,___,___,___.__
/SubtotalR044_1
Image 6, SUBTOTALR044_1
/SubtotalR044_2
Image 7, SUBTOTALR044_2
-------------------------------------------------------------------------------------------------------------------------------
‘“ŒŽŠŽ                                                                             ’„‹€•ˆ€ : _______.         _,___,___,___.__
===============================================================================================================================
/RecParArticl
Image 8, RECPARARTICL
_________.
/FooterR044_1
Image 9, FOOTERR044_1
__/__/____
/*
49195>>>>>    Use sl031r.sl
INCLUDING FILE: SL031R.SL
49195>>>>>>>//AB/ Project sl031r:Btypkin with recr 1st col
49195>>>>>>>//AB/     Object prj is a Lookup_Project
49195>>>>>>>//AB/         Set ProjectName to "sl031r:Btypkin with recr 1st col"
49195>>>>>>>//AB/         Set ProjectFileName to "sl031r.SL"
49195>>>>>>>//AB/         Set GenerateFileName to "NONAME"
49195>>>>>>>
49195>>>>>>>// Project Object Structure
49195>>>>>>>//   SL031r is a dbModalPanelSub
49195>>>>>>>//     Btypkin_DD is a DataDictionary
49195>>>>>>>//     oSelList is a dbListSub
49195>>>>>>>//     oOK_bn is a ButtonSub
49195>>>>>>>//     oCancel_bn is a ButtonSub
49195>>>>>>>//     oSearch_bn is a ButtonSub
49195>>>>>>>
49195>>>>>>>// Register all objects
49195>>>>>>>Register_Object Btypkin_DD
49195>>>>>>>Register_Object oCancel_bn
49195>>>>>>>Register_Object oOK_bn
49195>>>>>>>Register_Object oSearch_bn
49195>>>>>>>Register_Object oSelList
49195>>>>>>>Register_Object SL031r
49195>>>>>>>
49195>>>>>>>
49195>>>>>>>    //AB-IgnoreStart
49195>>>>>>>
49195>>>>>>>    Use DFAllEnt.pkg
49195>>>>>>>    Use dbList.Sub
49195>>>>>>>    Use Button.Sub
49195>>>>>>>
49195>>>>>>>
49195>>>>>>>    Use BTYPKIN.DD
49195>>>>>>>    
49195>>>>>>>    //AB-IgnoreEnd
49195>>>>>>>
49195>>>>>>>    CD_Popup_Object SL031r is a dbModalPanelSub
49214>>>>>>>        set label to "‰ ¤ã©œ ª  €¥ ¦š¨á­à¤" 
49215>>>>>>>        Set Size to 213 362
49216>>>>>>>        Set Location to 4 5
49217>>>>>>>        Set Exit_Application_Local_State to FALSE
49218>>>>>>>        Set Modal_State to FALSE
49219>>>>>>>
49219>>>>>>>        //AB-DDOStart
49219>>>>>>>
49219>>>>>>>        Object Btypkin_DD is a Btypkin_DataDictionary
49221>>>>>>>        End_Object    // Btypkin_DD
49222>>>>>>>
49222>>>>>>>        Set Main_DD to (Btypkin_DD(self))
49223>>>>>>>        Set Server to (Btypkin_DD(self))
49224>>>>>>>
49224>>>>>>>        //AB-DDOEnd
49224>>>>>>>
49224>>>>>>>        Object oSelList is a dbListSub
49226>>>>>>>            Set Main_File to Btypkin.File_Number
49227>>>>>>>            Set Size to 173 347
49228>>>>>>>            Set Location to 2 6
49229>>>>>>>
49229>>>>>>>            Begin_Row
49232>>>>>>>                Entry_Item Btypkin.Btypkin_recr
49233>>>>>>>                Entry_Item Btypkin.Btypkin_code
49234>>>>>>>                Entry_Item Btypkin.Btypkin_descr
49235>>>>>>>                Entry_Item Btypkin.Gtypkin_code
49236>>>>>>>                Entry_Item Btypkin.Ctypkin_code
49237>>>>>>>                Entry_Item Btypkin.Vtypkin_code
49238>>>>>>>                Entry_Item Btypkin.Btypkin_anti_xp
49239>>>>>>>            End_Row
49244>>>>>>>
49244>>>>>>>            Set Form_Width    item 0 to 58
49245>>>>>>>            Set Header_Label  item 0 to "Btypkin recr"
49246>>>>>>>            
49246>>>>>>>            Set Form_Width    item 1 to 36
49247>>>>>>>            set header_label  item 1 to "‰å¤ž©ž" 
49248>>>>>>>            
49248>>>>>>>            Set Form_Width    item 2 to 86
49249>>>>>>>            set header_label  item 2 to "œ¨ š¨˜­ã" 
49250>>>>>>>            
49250>>>>>>>            Set Form_Width    item 3 to 36
49251>>>>>>>            set header_label  item 3 to "‰å¤ž©ž ‚Š" 
49252>>>>>>>            
49252>>>>>>>            Set Form_Width    item 4 to 36
49253>>>>>>>            set header_label  item 4 to "‰ ¤ã©œ ª œ¢˜«é¤        " 
49254>>>>>>>            
49254>>>>>>>            Set Form_Width    item 5 to 36
49255>>>>>>>            set header_label  item 5 to "‰å¤ž©ž ¨¦£žŸœ¬«é¤" 
49256>>>>>>>            
49256>>>>>>>            Set Form_Width    item 6 to 53
49257>>>>>>>            set header_label  item 6 to "• ‘¬¤˜¢¢˜©¦£â¤¦¬" 
49258>>>>>>>            
49258>>>>>>>
49258>>>>>>>            //AB-StoreStart
49258>>>>>>>            Set Column_Option Item 0 to NoEnter True
49259>>>>>>>            
49259>>>>>>>            //AB-StoreEnd
49259>>>>>>>
49259>>>>>>>        End_Object    // oSelList
49260>>>>>>>
49260>>>>>>>        Object oOK_bn is a ButtonSub
49262>>>>>>>            set label to "&„§ ¢¦šã" 
49263>>>>>>>            Set Location to 178 194
49264>>>>>>>
49264>>>>>>>            //AB-StoreStart
49264>>>>>>>            Procedure OnClick
49266>>>>>>>                Send OK To oSelList
49267>>>>>>>            End_Procedure
49268>>>>>>>            //AB-StoreEnd
49268>>>>>>>
49268>>>>>>>        End_Object    // oOK_bn
49269>>>>>>>
49269>>>>>>>        Object oCancel_bn is a ButtonSub
49271>>>>>>>            set label to "&€¡ç¨à©ž" 
49272>>>>>>>            Set Location to 178 249
49273>>>>>>>
49273>>>>>>>            //AB-StoreStart
49273>>>>>>>            Procedure OnClick
49275>>>>>>>                Send Cancel To oSelList
49276>>>>>>>            End_Procedure
49277>>>>>>>            //AB-StoreEnd
49277>>>>>>>
49277>>>>>>>        End_Object    // oCancel_bn
49278>>>>>>>
49278>>>>>>>        Object oSearch_bn is a ButtonSub
49280>>>>>>>            set label to "€&¤˜ã«ž©ž" 
49281>>>>>>>            Set Location to 178 304
49282>>>>>>>
49282>>>>>>>            //AB-StoreStart
49282>>>>>>>            Procedure OnClick
49284>>>>>>>                Send Search To oSelList
49285>>>>>>>            End_Procedure
49286>>>>>>>            //AB-StoreEnd
49286>>>>>>>
49286>>>>>>>        End_Object    // oSearch_bn
49287>>>>>>>
49287>>>>>>>
49287>>>>>>>        //AB-StoreStart
49287>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
49288>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
49289>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
49290>>>>>>>        
49290>>>>>>>        //AB-StoreEnd
49290>>>>>>>
49290>>>>>>>    CD_End_Object    // SL031r
49292>>>>>>>>
49292>>>>>>>
49292>>>>>>>//AB/     End_Object    // prj
49292>>>>>    Use sl036r.sl
INCLUDING FILE: SL036R.SL
49292>>>>>>>//AB/ Project sl036r:Barticle with recr 1st col
49292>>>>>>>//AB/     Object prj is a Lookup_Project
49292>>>>>>>//AB/         Set ProjectName to "sl036r:Barticle with recr 1st col"
49292>>>>>>>//AB/         Set ProjectFileName to "sl036r.SL"
49292>>>>>>>//AB/         Set GenerateFileName to "NONAME"
49292>>>>>>>
49292>>>>>>>// Project Object Structure
49292>>>>>>>//   sl036r is a dbModalPanelSub
49292>>>>>>>//     Btypkin_DD is a DataDictionary
49292>>>>>>>//     Barticl_DD is a DataDictionary
49292>>>>>>>//     oSelList is a dbListSub
49292>>>>>>>//     oOK_bn is a ButtonSub
49292>>>>>>>//     oCancel_bn is a ButtonSub
49292>>>>>>>//     oSearch_bn is a ButtonSub
49292>>>>>>>
49292>>>>>>>// Register all objects
49292>>>>>>>Register_Object Barticl_DD
49292>>>>>>>Register_Object Btypkin_DD
49292>>>>>>>Register_Object oCancel_bn
49292>>>>>>>Register_Object oOK_bn
49292>>>>>>>Register_Object oSearch_bn
49292>>>>>>>Register_Object oSelList
49292>>>>>>>Register_Object sl036r
49292>>>>>>>
49292>>>>>>>
49292>>>>>>>    //AB-IgnoreStart
49292>>>>>>>
49292>>>>>>>    Use DFAllEnt.pkg
49292>>>>>>>    Use dbList.Sub
49292>>>>>>>    Use Button.Sub
49292>>>>>>>
49292>>>>>>>
49292>>>>>>>    Use BTYPKIN.DD
49292>>>>>>>    Use BARTICL.DD
49292>>>>>>>    
49292>>>>>>>    //AB-IgnoreEnd
49292>>>>>>>
49292>>>>>>>    CD_Popup_Object sl036r is a dbModalPanelSub
49311>>>>>>>        set label to "‰ ¤ã©œ ª  €¥ ¦š¨á­à¤" 
49312>>>>>>>        Set Size to 148 440
49313>>>>>>>        Set Location to 4 5
49314>>>>>>>        Set Exit_Application_Local_State to FALSE
49315>>>>>>>        Set Modal_State to FALSE
49316>>>>>>>
49316>>>>>>>        //AB-DDOStart
49316>>>>>>>
49316>>>>>>>        Object Btypkin_DD is a Btypkin_DataDictionary
49318>>>>>>>        End_Object    // Btypkin_DD
49319>>>>>>>
49319>>>>>>>        Object Barticl_DD is a Barticl_DataDictionary
49321>>>>>>>            Set DDO_Server to (Btypkin_DD(self))
49322>>>>>>>        End_Object    // Barticl_DD
49323>>>>>>>
49323>>>>>>>        Set Main_DD to (Barticl_DD(self))
49324>>>>>>>        Set Server to (Barticl_DD(self))
49325>>>>>>>
49325>>>>>>>        //AB-DDOEnd
49325>>>>>>>
49325>>>>>>>        Object oSelList is a dbListSub
49327>>>>>>>            Set Main_File to Barticl.File_Number
49328>>>>>>>            Set Server to (Btypkin_DD(self))
49329>>>>>>>            Set Size to 105 424
49330>>>>>>>            Set Location to 6 6
49331>>>>>>>
49331>>>>>>>            Begin_Row
49334>>>>>>>                Entry_Item Barticl.Barticl_recr
49335>>>>>>>                Entry_Item Barticl.Barticl_no
49336>>>>>>>                Entry_Item Barticl.Barticl_hmnia
49337>>>>>>>                Entry_Item Btypkin.Btypkin_code
49338>>>>>>>                Entry_Item Btypkin.Btypkin_descr
49339>>>>>>>            End_Row
49344>>>>>>>
49344>>>>>>>            Set Form_Width    item 0 to 56
49345>>>>>>>            Set Header_Label  item 0 to "Barticl recr"
49346>>>>>>>            
49346>>>>>>>            Set Form_Width    item 1 to 84
49347>>>>>>>            set header_label  item 1 to "€¨ Ÿ£æª" 
49348>>>>>>>            
49348>>>>>>>            Set Form_Width    item 2 to 60
49349>>>>>>>            set header_label  item 2 to "†£œ¨¦£ž¤å˜" 
49350>>>>>>>            
49350>>>>>>>            Set Form_Width    item 3 to 38
49351>>>>>>>            set header_label  item 3 to "‰å¤ž©ž" 
49352>>>>>>>            
49352>>>>>>>            Set Form_Width    item 4 to 179
49353>>>>>>>            set header_label  item 4 to "œ¨ š¨˜­ã" 
49354>>>>>>>            
49354>>>>>>>
49354>>>>>>>            //AB-StoreStart
49354>>>>>>>            Set Column_Option Item 0 to NoEnter True
49355>>>>>>>            
49355>>>>>>>            //AB-StoreEnd
49355>>>>>>>
49355>>>>>>>        End_Object    // oSelList
49356>>>>>>>
49356>>>>>>>        Object oOK_bn is a ButtonSub
49358>>>>>>>            set label to "&„§ ¢¦šã" 
49359>>>>>>>            Set Location to 114 271
49360>>>>>>>
49360>>>>>>>            //AB-StoreStart
49360>>>>>>>            Procedure OnClick
49362>>>>>>>                Send OK To oSelList
49363>>>>>>>            End_Procedure
49364>>>>>>>            //AB-StoreEnd
49364>>>>>>>
49364>>>>>>>        End_Object    // oOK_bn
49365>>>>>>>
49365>>>>>>>        Object oCancel_bn is a ButtonSub
49367>>>>>>>            set label to "&€¡ç¨à©ž" 
49368>>>>>>>            Set Location to 114 327
49369>>>>>>>
49369>>>>>>>            //AB-StoreStart
49369>>>>>>>            Procedure OnClick
49371>>>>>>>                Send Cancel To oSelList
49372>>>>>>>            End_Procedure
49373>>>>>>>            //AB-StoreEnd
49373>>>>>>>
49373>>>>>>>        End_Object    // oCancel_bn
49374>>>>>>>
49374>>>>>>>        Object oSearch_bn is a ButtonSub
49376>>>>>>>            set label to "€&¤˜ã«ž©ž" 
49377>>>>>>>            Set Location to 114 381
49378>>>>>>>
49378>>>>>>>            //AB-StoreStart
49378>>>>>>>            Procedure OnClick
49380>>>>>>>                Send Search To oSelList
49381>>>>>>>            End_Procedure
49382>>>>>>>            //AB-StoreEnd
49382>>>>>>>
49382>>>>>>>        End_Object    // oSearch_bn
49383>>>>>>>
49383>>>>>>>
49383>>>>>>>        //AB-StoreStart
49383>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
49384>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
49385>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
49386>>>>>>>        
49386>>>>>>>        //AB-StoreEnd
49386>>>>>>>
49386>>>>>>>    CD_End_Object    // sl036r
49388>>>>>>>>
49388>>>>>>>
49388>>>>>>>//AB/     End_Object    // prj
49388>>>>>    use sl002.sl
49388>>>>>    //AB-StoreTopEnd
49388>>>>>
49388>>>>>    //AB-IgnoreStart
49388>>>>>
49388>>>>>    Use Rptvw.Sub
INCLUDING FILE: RPTVW.SUB
49388>>>>>>>Use DFRptvw.pkg
49388>>>>>>>Use dbRptvw.pkg
INCLUDING FILE: DBRPTVW.PKG
49388>>>>>>>>>
49388>>>>>>>>>Use Windows
49388>>>>>>>>>Use DfPanel
49388>>>>>>>>>Use EnClient
49388>>>>>>>>>Use DFNav_mx
49388>>>>>>>>>Use dfConfrm
49388>>>>>>>>>Use dfRptVw
49388>>>>>>>>>Use DFGSINI
49388>>>>>>>>>
49388>>>>>>>>>Class dbReportAppClient_ is a ReportView STARTMAC ECstart
49389>>>>>>>>>    Import_Class_Protocol Entry_Client
49390>>>>>>>>>    //  Defeat the activating augmentation for auto-locate
49390>>>>>>>>>    Procedure Activating Returns Integer
49391>>>>>>>>>      local integer RVal
49392>>>>>>>>>      forward get MSG_activating to rVal
49394>>>>>>>>>      Procedure_Return rVal
49395>>>>>>>>>    End_Procedure
49396>>>>>>>>>End_Class // dbReportAppClient_
49397>>>>>>>>>
49397>>>>>>>>>Class dbReportAppView_ is a dbReportAppClient_
49398>>>>>>>>>  import_Class_protocol entry_view_Client
49399>>>>>>>>>End_Class // dbReportAppView_
49400>>>>>>>>>
49400>>>>>>>>>
49400>>>>>>>>>Class dbReportView is a dbReportAppView_
49401>>>>>>>>>
49401>>>>>>>>>     Procedure Construct_Object
49402>>>>>>>>>      Forward Send Construct_Object No_Image
49404>>>>>>>>>      Send Define_DFNavigation  // GUI navigate changes
49405>>>>>>>>>      // dialog views get activated as popup objects.
49405>>>>>>>>>      set Dso_Detach_Mode to Detach_Always
49406>>>>>>>>>
49406>>>>>>>>>      Set Verify_Data_Loss_Msg TO GET_No_Confirmation
49407>>>>>>>>>      Set Verify_Delete_Msg    TO GET_No_Confirmation
49408>>>>>>>>>      Set Verify_Save_Msg      TO GET_No_Confirmation
49409>>>>>>>>>      Set Verify_Exit_Msg      TO GET_No_confirmation
49410>>>>>>>>>      //
49410>>>>>>>>>      // This reportview-client will almost always be a modalpanel, therefore minimizing
49410>>>>>>>>>      // is out of the question...
49410>>>>>>>>>      Set Minimize_Icon To False
49411>>>>>>>>>      Set Maximize_Icon To False
49412>>>>>>>>>   End_Procedure // Construct_Object
49413>>>>>>>>>
49413>>>>>>>>>   Procedure Request_Delete
49414>>>>>>>>>   End_Procedure // request_delete
49415>>>>>>>>>
49415>>>>>>>>>   Procedure Request_Save
49416>>>>>>>>>   End_Procedure // request_save
49417>>>>>>>>>
49417>>>>>>>>>   Function Exit_Application_Check Returns Integer
49418>>>>>>>>>     Function_return 0
49419>>>>>>>>>   End_Function
49420>>>>>>>>>
49420>>>>>>>>>   Import_Class_Protocol DFNavigate_Mixin
49421>>>>>>>>>
49421>>>>>>>>>  //  Returns TRUE to indicate that this is a DEO. This is used by
49421>>>>>>>>>  //  delegation to figure out if you are within a DEO and should therefore
49421>>>>>>>>>  //  send a DEO message. DEO clients set this true
49421>>>>>>>>>  Function DEO_Object Returns integer
49422>>>>>>>>>    Function_Return 1
49423>>>>>>>>>  End_Function // DEO_Object
49424>>>>>>>>>
49424>>>>>>>>>  //
49424>>>>>>>>>  //  Activate message for views that:
49424>>>>>>>>>  //  1. restores the view if it is minimized
49424>>>>>>>>>  //  2. Maintains the current scope's focus.
49424>>>>>>>>>  //
49424>>>>>>>>>  Procedure Activate_current_scope
49425>>>>>>>>>    If ( View_mode(Current_Object)=VIEWMODE_ICONIZE ) ;       Set view_mode to viewmode_normal
49428>>>>>>>>>    Set Current_Scope to Current_Object
49429>>>>>>>>>  End_Procedure // Activate_current_scope
49430>>>>>>>>>
49430>>>>>>>>>  //  Pass full object name - return the relative name
49430>>>>>>>>>  //  e.g.,  Main.View.Obj1 --> Obj1
49430>>>>>>>>>  Function Local_Object_name string nm returns string
49431>>>>>>>>>     local integer ps
49432>>>>>>>>>     Repeat
49432>>>>>>>>>>
49432>>>>>>>>>       pos "." in nm to ps
49434>>>>>>>>>>
49434>>>>>>>>>       If ps eq 0 function_return nm
49437>>>>>>>>>       increment ps
49438>>>>>>>>>       Mid Nm to Nm 255 ps
49441>>>>>>>>>>
49441>>>>>>>>>     Loop
49442>>>>>>>>>>
49442>>>>>>>>>  end_function
49443>>>>>>>>>
49443>>>>>>>>>  //  Take string "#1,#2" and return integer hi #1 + #2
49443>>>>>>>>>  Function Parse_Complex string sVal returns integer
49444>>>>>>>>>     Local integer ps
49445>>>>>>>>>     Pos "," in sVal to ps
49447>>>>>>>>>>
49447>>>>>>>>>     if ps ;        Function_Return ( integer(left(sVal,ps-1))*65536 + ;                          integer(mid(sVal,255,ps+1)) )
49450>>>>>>>>>  End_Function // Parse_Complex
49451>>>>>>>>>
49451>>>>>>>>>  // Convert a complex integer to a string "hi,Low"
49451>>>>>>>>>  //
49451>>>>>>>>>  Function Complex_to_String integer i1 returns string
49452>>>>>>>>>     function_return ( string(hi(i1)) - "," - String(low(i1)) )
49453>>>>>>>>>  End_function
49454>>>>>>>>>
49454>>>>>>>>>
49454>>>>>>>>>  // *WvA: I don't want to save locations of a reportview noted in the registry.
49454>>>>>>>>>  // These printing dialogs are centered on the panel anyway, so it doesn't make any
49454>>>>>>>>>  // sense to clutter up the registry with this kind of nonsense.
49454>>>>>>>>>  ////
49454>>>>>>>>>  ////  Save View information to dfwin.ini file. Save as:
49454>>>>>>>>>  ////  View_ObjectName=LOC:Row,Col  e.g., Cust_Ent=LOC:10,20
49454>>>>>>>>>  ////     Leaving room for growth here.
49454>>>>>>>>>  ////
49454>>>>>>>>>  Procedure Save_Environment
49455>>>>>>>>>  //   Local String nm Vn st
49455>>>>>>>>>  //   Local Integer H
49455>>>>>>>>>  //
49455>>>>>>>>>  //   Get System_Profile_String "SaveEnvironment" to St
49455>>>>>>>>>  //   Move (Uppercase(trim(st))) to st
49455>>>>>>>>>  //   If (st="YES" or st="ON" or st="TRUE") Begin
49455>>>>>>>>>  //     // Note with the 3.05 version we will have problems if the view has
49455>>>>>>>>>  //     // been maximized and then iconized. We still don't know what the normal
49455>>>>>>>>>  //     // size/loc is when maximized. We will take a chance and assume that an
49455>>>>>>>>>  //     // iconized view is always non-zoomed (since views don't support the zoom
49455>>>>>>>>>  //     // button).
49455>>>>>>>>>  //     If (View_mode(Current_Object)<>VIEWMODE_ZOOM) Begin
49455>>>>>>>>>  //
49455>>>>>>>>>  //       Get Name to Vn // full name of object
49455>>>>>>>>>  //       Get Local_Object_Name Vn to Vn   // just get the local name
49455>>>>>>>>>  //       Get GUILocation to H             // complex location
49455>>>>>>>>>  //       Get Complex_to_String h to nm    // convert complex to "hi,low"
49455>>>>>>>>>  //       Set System_Profile_String VN to ("LOC:"+Nm)
49455>>>>>>>>>  //     End
49455>>>>>>>>>  //   End
49455>>>>>>>>>  //
49455>>>>>>>>>  End_Procedure
49456>>>>>>>>>  //
49456>>>>>>>>>  //// Augment to check for view string in .INI. Currently, if found
49456>>>>>>>>>  //// set the location
49456>>>>>>>>>  ////
49456>>>>>>>>>  Procedure Load_Environment
49457>>>>>>>>>  //   Local String nm Vn Lc
49457>>>>>>>>>  //   Local Integer H ps
49457>>>>>>>>>  //   // see above for reasoning on this
49457>>>>>>>>>  //   If (View_mode(Current_Object)=VIEWMODE_NORMAL) Begin
49457>>>>>>>>>  //     Get Name to Vn
49457>>>>>>>>>  //     Get Local_Object_Name Vn to Vn
49457>>>>>>>>>  //     Get System_Profile_String Vn to Nm
49457>>>>>>>>>  //     IF Nm ne '' Begin
49457>>>>>>>>>  //        Pos "LOC:" in Nm to Ps   // look for LOC:row,col
49457>>>>>>>>>  //        If Ps Begin
49457>>>>>>>>>  //           Mid Nm to Lc 255 (Ps+4)
49457>>>>>>>>>  //           Pos " " in Lc to ps
49457>>>>>>>>>  //           if Ps left lc to lc (ps-1)
49457>>>>>>>>>  //           Get Parse_Complex lc to H
49457>>>>>>>>>  //           Set GUILocation to (Hi(H)) (Low(H))
49457>>>>>>>>>  //           Send Adjust_Logicals
49457>>>>>>>>>  //        End
49457>>>>>>>>>  //     End
49457>>>>>>>>>  //   End
49457>>>>>>>>>  End_Procedure
49458>>>>>>>>>
49458>>>>>>>>>  Function View_Changed returns Integer
49459>>>>>>>>>     Local Integer Changed
49460>>>>>>>>>     Broadcast Get Data_Set_Should_Save to Changed // Ask for changes in Data-sets
49462>>>>>>>>>     Function_Return Changed
49463>>>>>>>>>  End_Function
49464>>>>>>>>>
49464>>>>>>>>>  Procedure Notify_Exit_Application
49465>>>>>>>>>    Send Save_Environment
49466>>>>>>>>>  End_procedure
49467>>>>>>>>>
49467>>>>>>>>>  Procedure End_Construct_Object
49468>>>>>>>>>     Send Load_Environment
49469>>>>>>>>>     //Send Define_SysMenu
49469>>>>>>>>>     Forward Send End_Construct_Object
49471>>>>>>>>>  End_Procedure // End_Construct_Object
49472>>>>>>>>>
49472>>>>>>>>>  Procedure Close_Client
49473>>>>>>>>>     Send Exit_Function
49474>>>>>>>>>  End_Procedure
49475>>>>>>>>>
49475>>>>>>>>>  Procedure Entering_Scope returns Integer
49476>>>>>>>>>     Local Integer rVal
49477>>>>>>>>>     Forward Get MSG_Entering_Scope to rVal
49479>>>>>>>>>     If not rVal send Show_View_Name (Label(Current_Object))
49482>>>>>>>>>  End_Procedure
49483>>>>>>>>>
49483>>>>>>>>>  Procedure Exiting_Scope integer whereto returns Integer
49484>>>>>>>>>     Local Integer rVal
49485>>>>>>>>>     Forward Get MSG_Exiting_Scope whereto to rVal
49487>>>>>>>>>     If not rVal Send Show_View_Name ''
49490>>>>>>>>>  End_Procedure
49491>>>>>>>>>
49491>>>>>>>>>  Procedure Show_view_Name string sHelp
49492>>>>>>>>>     Local Integer rVal Id
49493>>>>>>>>>     Get Statusbar_id to id
49494>>>>>>>>>     If Id Send Show_View_Name to Id sHelp
49497>>>>>>>>>  End_Procedure
49498>>>>>>>>>
49498>>>>>>>>>  Function Should_Save_Recursive returns integer
49499>>>>>>>>>    Function_return (View_Changed(Current_Object))
49500>>>>>>>>>  End_Function
49501>>>>>>>>>
49501>>>>>>>>>End_Class // dbReportView
49502>>>>>>>
49502>>>>>>>Class ReportViewSub is a ReportView
49503>>>>>>>
49503>>>>>>>    Procedure Construct_Object
49504>>>>>>>        Forward Send Construct_Object
49506>>>>>>>        Property Integer Server 0
49507>>>>>>>    End_Procedure // Construct_Object
49508>>>>>>>
49508>>>>>>>    Procedure Page Integer PageMode
49509>>>>>>>        Integer hWnd
49510>>>>>>>        Forward Send Page PageMode
49512>>>>>>>        Get Window_Handle to hWnd
49513>>>>>>>        If (hWnd) Begin
49515>>>>>>>            Send GreekSysMenu
49516>>>>>>>        End
49516>>>>>>>>
49516>>>>>>>    End_Procedure
49517>>>>>>>
49517>>>>>>>    Procedure Close_Panel
49518>>>>>>>        Local Integer liScope
49519>>>>>>>        Move (Prior_Scope(Desktop)) To liScope
49520>>>>>>>        Move (Scope_Focus(liScope)) To liScope
49521>>>>>>>        Forward Send Close_Panel
49523>>>>>>>        Send Activate To liScope
49524>>>>>>>    End_Procedure // Close_Panel
49525>>>>>>>
49525>>>>>>>End_Class
49526>>>>>>>
49526>>>>>>>Class dbReportViewSub is a dbReportView
49527>>>>>>>
49527>>>>>>>    Procedure Construct_Object
49528>>>>>>>        Forward Send Construct_Object
49530>>>>>>>        Property Integer Server 0
49531>>>>>>>    End_Procedure // Construct_Object
49532>>>>>>>
49532>>>>>>>    Procedure Page Integer PageMode
49533>>>>>>>        Integer hWnd
49534>>>>>>>        Forward Send Page PageMode
49536>>>>>>>        Get Window_Handle to hWnd
49537>>>>>>>        If (hWnd) Begin
49539>>>>>>>            Send GreekSysMenu
49540>>>>>>>        End
49540>>>>>>>>
49540>>>>>>>    End_Procedure
49541>>>>>>>
49541>>>>>>>    Procedure Close_Panel
49542>>>>>>>        Local Integer liScope
49543>>>>>>>        Move (Prior_Scope(Desktop)) To liScope
49544>>>>>>>        Move (Scope_Focus(liScope)) To liScope
49545>>>>>>>        Forward Send Close_Panel
49547>>>>>>>        Send Activate To liScope
49548>>>>>>>    End_Procedure // Close_Panel
49549>>>>>>>End_Class
49550>>>>>>>
49550>>>>>    Use Group.Sub
49550>>>>>    Use Form.Sub
49550>>>>>    Use Txtbox.Sub
49550>>>>>    Use Chkbox.Sub
49550>>>>>    Use Rgroup.Sub
49550>>>>>    Use Radio.Sub
49550>>>>>    Use Button.Sub
49550>>>>>    Use DFAllEnt.pkg
49550>>>>>
49550>>>>>    //AB-IgnoreEnd
49550>>>>>
49550>>>>>    ACTIVATE_VIEW Activate_R044 FOR R044
49554>>>>>
49554>>>>>    Object R044 is a ReportViewSub
49556>>>>>
49556>>>>>        //AB-StoreTopStart
49556>>>>>        Property Integer Sort_IndexR044 0
49558>>>>>        property string  psbranch public ''
49560>>>>>        Open Syscurxr
49562>>>>>        open branch
49564>>>>>        //AB-StoreTopEnd
49564>>>>>
49564>>>>>        Set Label to "R044:†£œ¨¦¢æš ¦ €¥ ¦š¨á­à¤"
49565>>>>>        Set Size to 228 324
49566>>>>>        Set Location to 5 7
49567>>>>>
49567>>>>>        //AB-DDOStart
49567>>>>>
49567>>>>>
49567>>>>>        //AB-DDOEnd
49567>>>>>
49567>>>>>        Object GroupSub2 is a GroupSub
49569>>>>>            Set Label to "„§ ¢¦šã †£œ¨¦£ž¤å˜ª €¨Ÿ¨à¤"
49570>>>>>            Set Size to 28 317
49571>>>>>            Set Location to 28 3
49572>>>>>            Object FormSub1 is a FormSub
49574>>>>>                Set Size to 13 60
49575>>>>>                Set Location to 10 51
49576>>>>>                Set Label_Col_Offset to 2
49577>>>>>                Set Label_Justification_Mode to jMode_Right
49578>>>>>                Set Form_Datatype Item 0 to Mask_Date_Window
49579>>>>>                Set Form_Mask Item 0 to "dd/mm/yyyy"
49580>>>>>
49580>>>>>                //AB-StoreStart
49580>>>>>                set Form_Datatype item 0 to mask_date_window
49581>>>>>                
49581>>>>>                
49581>>>>>                //AB-StoreEnd
49581>>>>>
49581>>>>>            End_Object    // FormSub1
49582>>>>>
49582>>>>>            Object FormSub2 is a FormSub
49584>>>>>                Set Size to 13 60
49585>>>>>                Set Location to 10 164
49586>>>>>                Set Label_Col_Offset to 2
49587>>>>>                Set Label_Justification_Mode to jMode_Right
49588>>>>>                Set Form_Datatype Item 0 to Mask_Date_Window
49589>>>>>                Set Form_Mask Item 0 to "dd/MM/yy"
49590>>>>>
49590>>>>>                //AB-StoreStart
49590>>>>>                set Form_Datatype item 0 to mask_date_window
49591>>>>>                
49591>>>>>                
49591>>>>>                //AB-StoreEnd
49591>>>>>
49591>>>>>            End_Object    // FormSub2
49592>>>>>
49592>>>>>            Object TextBoxSub7 is a TextBoxSub
49594>>>>>                Set Label to "€§æ †£/¤å˜ "
49595>>>>>                Set Auto_Size_State to FALSE
49596>>>>>                Set FontSize to 4 0
49597>>>>>                Set Location to 10 5
49598>>>>>                Set Size to 10 41
49599>>>>>                Set Enabled_State to TRUE
49600>>>>>            End_Object    // TextBoxSub7
49601>>>>>
49601>>>>>            Object TextBoxSub8 is a TextBoxSub
49603>>>>>                Set Label to "„àª †£¤å˜  :"
49604>>>>>                Set Auto_Size_State to FALSE
49605>>>>>                Set FontSize to 4 0
49606>>>>>                Set Location to 11 124
49607>>>>>                Set Size to 10 37
49608>>>>>                Set Enabled_State to TRUE
49609>>>>>            End_Object    // TextBoxSub8
49610>>>>>
49610>>>>>        End_Object    // GroupSub2
49611>>>>>
49611>>>>>        Object GroupSub1 is a GroupSub
49613>>>>>            Set Label to "„§ ¢¦šã €¨Ÿ¨à¤"
49614>>>>>            Set Size to 46 151
49615>>>>>            Set Location to 58 3
49616>>>>>            Object frmG12_3 is a FormSub
49618>>>>>                Set Size to 13 71
49619>>>>>                Set Location to 10 60
49620>>>>>                Set Label_Col_Offset to 2
49621>>>>>                Set Label_Justification_Mode to jMode_Right
49622>>>>>                Set Prompt_Button_Mode to pb_PromptOn
49623>>>>>                Set Form_Margin Item 0 to 14
49624>>>>>
49624>>>>>                //AB-StoreStart
49624>>>>>                Set Prompt_Object to (Sl036r(Current_object))
49625>>>>>                
49625>>>>>                //Procedure RetValue
49625>>>>>                //    Set Value Item 0 to Barticl.Barticl_Recr
49625>>>>>                //End_Procedure // RetValue
49625>>>>>                
49625>>>>>                //// this is called by the prompt list upon initialization. This will let us
49625>>>>>                //// set special properties for the list's one time use. In this case we
49625>>>>>                //// want the intial column and the export column to be name (col 1)
49625>>>>>                //Procedure Prompt_Callback integer hPrompt
49625>>>>>                //    Integer liFld liBestColumn
49625>>>>>                //    Get_Fieldnumber Barticl.Barticl_Recr to liFld
49625>>>>>                //    Get Select_Best_Column Of hPrompt Barticl.File_Number liFld To liBestColumn
49625>>>>>                //    Set Export_Column Of hPrompt        To liBestColumn
49625>>>>>                //    Set Initial_Column Of hPrompt       To liBestColumn
49625>>>>>                //    Set display_buffer_msg of hPrompt   to msg_RetValue
49625>>>>>                //end_procedure
49625>>>>>                
49625>>>>>                
49625>>>>>                
49625>>>>>                
49625>>>>>                
49625>>>>>                
49625>>>>>                //AB-StoreEnd
49625>>>>>
49625>>>>>            End_Object    // frmG12_3
49626>>>>>
49626>>>>>            Object frmG12_4 is a FormSub
49628>>>>>                Set Size to 13 71
49629>>>>>                Set Location to 27 60
49630>>>>>                Set Label_Col_Offset to 2
49631>>>>>                Set Label_Justification_Mode to jMode_Right
49632>>>>>                Set Prompt_Button_Mode to pb_PromptOn
49633>>>>>                Set Form_Margin Item 0 to 14
49634>>>>>
49634>>>>>                //AB-StoreStart
49634>>>>>                Set Prompt_Object to (Sl036r(Current_object))
49635>>>>>                
49635>>>>>                //Procedure RetValue
49635>>>>>                //    Set Value Item 0 to Barticl.Barticl_Recr
49635>>>>>                //End_Procedure // RetValue
49635>>>>>                //
49635>>>>>                //// this is called by the prompt list upon initialization. This will let us
49635>>>>>                //// set special properties for the list's one time use. In this case we
49635>>>>>                //// want the intial column and the export column to be name (col 1)
49635>>>>>                //Procedure Prompt_Callback integer hPrompt
49635>>>>>                //    Integer liFld liBestColumn
49635>>>>>                //
49635>>>>>                //    Get_Fieldnumber Barticl.Barticl_Recr to liFld
49635>>>>>                //    Get Select_Best_Column Of hPrompt Barticl.File_Number liFld To liBestColumn
49635>>>>>                //    Set Export_Column Of hPrompt To liBestColumn
49635>>>>>                //    Set Initial_Column Of hPrompt To liBestColumn
49635>>>>>                //    Set display_buffer_msg of hPrompt to msg_RetValue
49635>>>>>                //end_procedure // Prompt_Callback
49635>>>>>                //
49635>>>>>                
49635>>>>>                
49635>>>>>                
49635>>>>>                //AB-StoreEnd
49635>>>>>
49635>>>>>            End_Object    // frmG12_4
49636>>>>>
49636>>>>>            Object TextBoxSub3 is a TextBoxSub
49638>>>>>                Set Label to "€§æ €¨Ÿ¨¦  :"
49639>>>>>                Set Auto_Size_State to FALSE
49640>>>>>                Set FontSize to 4 0
49641>>>>>                Set Location to 10 5
49642>>>>>                Set Size to 10 45
49643>>>>>                Set Enabled_State to TRUE
49644>>>>>            End_Object    // TextBoxSub3
49645>>>>>
49645>>>>>            Object TextBoxSub4 is a TextBoxSub
49647>>>>>                Set Label to "„àª €¨Ÿ¨¦  :"
49648>>>>>                Set Auto_Size_State to FALSE
49649>>>>>                Set FontSize to 4 0
49650>>>>>                Set Location to 26 5
49651>>>>>                Set Size to 13 47
49652>>>>>                Set Enabled_State to TRUE
49653>>>>>            End_Object    // TextBoxSub4
49654>>>>>
49654>>>>>
49654>>>>>            //AB-StoreStart
49654>>>>>                                                                                                        
49654>>>>>                                                                                                        
49654>>>>>            //AB-StoreEnd
49654>>>>>
49654>>>>>        End_Object    // GroupSub1
49655>>>>>
49655>>>>>        Object GroupSub3 is a GroupSub
49657>>>>>            Set Label to "„§ ¢¦šã ‰ ¤ã©œà¤"
49658>>>>>            Set Size to 46 160
49659>>>>>            Set Location to 58 159
49660>>>>>            Object frmG1 is a FormSub
49662>>>>>                Set Size to 13 63
49663>>>>>                Set Location to 10 60
49664>>>>>                Set Label_Col_Offset to 2
49665>>>>>                Set Label_Justification_Mode to jMode_Right
49666>>>>>                Set Prompt_Button_Mode to pb_PromptOn
49667>>>>>                Set Form_Margin Item 0 to 6
49668>>>>>
49668>>>>>                //AB-StoreStart
49668>>>>>                Set Prompt_Object to (Sl031r(Current_object))
49669>>>>>                
49669>>>>>                //Procedure RetValue
49669>>>>>                //    Set Value Item 0 to Btypkin.Btypkin_Recr
49669>>>>>                //End_Procedure // RetValue
49669>>>>>                //
49669>>>>>                //// this is called by the prompt list upon initialization. This will let us
49669>>>>>                //// set special properties for the list's one time use. In this case we
49669>>>>>                //// want the intial column and the export column to be name (col 1)
49669>>>>>                //Procedure Prompt_Callback integer hPrompt
49669>>>>>                //    Integer liFld liBestColumn
49669>>>>>                //
49669>>>>>                //    Get_Fieldnumber Btypkin.Btypkin_Recr to liFld
49669>>>>>                //    Get Select_Best_Column Of hPrompt Btypkin.File_Number liFld To liBestColumn
49669>>>>>                //    Set Export_Column Of hPrompt To liBestColumn
49669>>>>>                //    Set Initial_Column Of hPrompt To liBestColumn
49669>>>>>                //    Set display_buffer_msg of hPrompt to msg_RetValue
49669>>>>>                //end_procedure // Prompt_Callback
49669>>>>>                
49669>>>>>                
49669>>>>>                
49669>>>>>                
49669>>>>>                //AB-StoreEnd
49669>>>>>
49669>>>>>            End_Object    // frmG1
49670>>>>>
49670>>>>>            Object frmG2 is a FormSub
49672>>>>>                Set Size to 13 63
49673>>>>>                Set Location to 27 60
49674>>>>>                Set Label_Col_Offset to 2
49675>>>>>                Set Label_Justification_Mode to jMode_Right
49676>>>>>                Set Prompt_Button_Mode to pb_PromptOn
49677>>>>>                Set Form_Margin Item 0 to 6
49678>>>>>
49678>>>>>                //AB-StoreStart
49678>>>>>                Set Prompt_Object to (Sl031r(Current_object))
49679>>>>>                
49679>>>>>                //Procedure RetValue
49679>>>>>                //    Set Value Item 0 to Btypkin.Btypkin_Recr
49679>>>>>                //End_Procedure // RetValue
49679>>>>>                //
49679>>>>>                //// this is called by the prompt list upon initialization. This will let us
49679>>>>>                //// set special properties for the list's one time use. In this case we
49679>>>>>                //// want the intial column and the export column to be name (col 1)
49679>>>>>                //Procedure Prompt_Callback integer hPrompt
49679>>>>>                //    Integer liFld liBestColumn
49679>>>>>                //
49679>>>>>                //    Get_Fieldnumber Btypkin.Btypkin_Recr to liFld
49679>>>>>                //    Get Select_Best_Column Of hPrompt Btypkin.File_Number liFld To liBestColumn
49679>>>>>                //    Set Export_Column Of hPrompt To liBestColumn
49679>>>>>                //    Set Initial_Column Of hPrompt To liBestColumn
49679>>>>>                //    Set display_buffer_msg of hPrompt to msg_RetValue
49679>>>>>                //end_procedure // Prompt_Callback
49679>>>>>                //
49679>>>>>                
49679>>>>>                
49679>>>>>                //AB-StoreEnd
49679>>>>>
49679>>>>>            End_Object    // frmG2
49680>>>>>
49680>>>>>            Object TextBoxSub9 is a TextBoxSub
49682>>>>>                Set Label to "€§æ ‰å¤ž©ž   :"
49683>>>>>                Set Auto_Size_State to FALSE
49684>>>>>                Set FontSize to 4 0
49685>>>>>                Set Location to 10 5
49686>>>>>                Set Size to 10 45
49687>>>>>                Set Enabled_State to TRUE
49688>>>>>            End_Object    // TextBoxSub9
49689>>>>>
49689>>>>>            Object TextBoxSub10 is a TextBoxSub
49691>>>>>                Set Label to "„àª ‰å¤ž©ž   :"
49692>>>>>                Set Auto_Size_State to FALSE
49693>>>>>                Set FontSize to 4 0
49694>>>>>                Set Location to 26 5
49695>>>>>                Set Size to 13 47
49696>>>>>                Set Enabled_State to TRUE
49697>>>>>            End_Object    // TextBoxSub10
49698>>>>>
49698>>>>>
49698>>>>>            //AB-StoreStart
49698>>>>>                                                                                                        
49698>>>>>                                                                                                        
49698>>>>>                                                                                                        
49698>>>>>                                                                                                        
49698>>>>>            //AB-StoreEnd
49698>>>>>
49698>>>>>        End_Object    // GroupSub3
49699>>>>>
49699>>>>>        Object oSelectCurr is a GroupSub
49701>>>>>            Set Label to "„§ ¢¦šã Œ¦£ ©£á«à¤"
49702>>>>>            Set Size to 28 317
49703>>>>>            Set Location to 106 3
49704>>>>>            Object chkbCurr0 is a CheckBoxSub
49706>>>>>                Set Label to "0"
49707>>>>>                Set Size to 10 21
49708>>>>>                Set Location to 12 15
49709>>>>>            End_Object    // chkbCurr0
49710>>>>>
49710>>>>>            Object chkbCurr00 is a CheckBoxSub
49712>>>>>                Set Label to "00"
49713>>>>>                Set Size to 10 25
49714>>>>>                Set Location to 12 90
49715>>>>>            End_Object    // chkbCurr00
49716>>>>>
49716>>>>>            Object chkbCurrR is a CheckBoxSub
49718>>>>>                Set Label to "rep"
49719>>>>>                Set Size to 10 27
49720>>>>>                Set Location to 12 162
49721>>>>>            End_Object    // chkbCurrR
49722>>>>>
49722>>>>>            Object chkbKeepTogether is a CheckBoxSub
49724>>>>>                Set Size to 10 17
49725>>>>>                Set Location to 12 251
49726>>>>>                Set Enabled_State to FALSE
49727>>>>>                Set Item_Shadow_State Item 0 to TRUE
49728>>>>>                Set Shadow_State Item 0 to TRUE
49729>>>>>
49729>>>>>                //AB-StoreStart
49729>>>>>                                                                                                                                            
49729>>>>>                Set Visible_State to False
49730>>>>>                //AB-StoreEnd
49730>>>>>
49730>>>>>            End_Object    // chkbKeepTogether
49731>>>>>
49731>>>>>        End_Object    // oSelectCurr
49732>>>>>
49732>>>>>        Object rdgSelectPrint is a RadioGroupSub
49734>>>>>            Set Label to "„¡«ç&§à©ž"
49735>>>>>            Set Size to 28 317
49736>>>>>            Set Location to 137 3
49737>>>>>            Object RadioSub5 is a RadioSub
49739>>>>>                Set Label to "ŽŸæ¤ž :"
49740>>>>>                Set Size to 10 36
49741>>>>>                Set Location to 12 6
49742>>>>>            End_Object    // RadioSub5
49743>>>>>
49743>>>>>            Object RadioSub6 is a RadioSub
49745>>>>>                Set Label to "„¡«¬§à«ãª : "
49746>>>>>                Set Size to 10 49
49747>>>>>                Set Location to 12 51
49748>>>>>            End_Object    // RadioSub6
49749>>>>>
49749>>>>>            Object rdFile is a RadioSub
49751>>>>>                Set Label to "€¨®œå¦"
49752>>>>>                Set Size to 10 41
49753>>>>>                Set Location to 12 113
49754>>>>>                Set Auto_Size_State to FALSE
49755>>>>>            End_Object    // rdFile
49756>>>>>
49756>>>>>            Object frmFile is a FormSub
49758>>>>>                Set Size to 13 144
49759>>>>>                Set Location to 10 158
49760>>>>>                Set Color to clBtnFace
49761>>>>>                Set Label_Col_Offset to 2
49762>>>>>                Set Enabled_State to FALSE
49763>>>>>                Set Item_Shadow_State Item 0 to TRUE
49764>>>>>                Set Shadow_State Item 0 to TRUE
49765>>>>>            End_Object    // frmFile
49766>>>>>
49766>>>>>
49766>>>>>            //AB-StoreStart
49766>>>>>            Procedure Notify_Select_State  Integer iNewItem  Integer iOldItem
49768>>>>>                If iNewItem EQ 0     Set Output_Device_Mode  To PRINT_TO_WINDOW
49771>>>>>                Else If iNewItem EQ 1   Set Output_Device_Mode  To PRINT_TO_PRINTER
49775>>>>>                Else If iNewItem EQ 2   Set Output_Device_Mode  To PRINT_TO_FILE
49779>>>>>                Set Enabled_State of frmFile to (iNewItem = 2)
49780>>>>>            End_Procedure
49781>>>>>            
49781>>>>>            
49781>>>>>            //AB-StoreEnd
49781>>>>>
49781>>>>>        End_Object    // rdgSelectPrint
49782>>>>>
49782>>>>>        Object FormSub5 is a FormSub
49784>>>>>            Set Size to 13 69
49785>>>>>            Set Location to 171 73
49786>>>>>            Set Label_Col_Offset to 2
49787>>>>>            Set Prompt_Button_Mode to pb_PromptOn
49788>>>>>
49788>>>>>            //AB-StoreStart
49788>>>>>            Set Prompt_Object to (sl002(Current_object))
49789>>>>>            
49789>>>>>            procedure onchange
49791>>>>>                string sbranch
49792>>>>>                get value item 0 to sbranch
49793>>>>>                clear branch
49794>>>>>                move syscurxr.company_code to branch.company_code
49795>>>>>                move sbranch               to branch.branch_code
49796>>>>>                find eq branch by index.1
49797>>>>>>
49797>>>>>                if (found=1) set value of (branch_name(self)) to branch.branch_name
49800>>>>>                else         set value of (branch_name(self)) to ''
49802>>>>>                set psbranch to branch.branch_code
49803>>>>>            end_procedure
49804>>>>>            
49804>>>>>            //AB-StoreEnd
49804>>>>>
49804>>>>>        End_Object    // FormSub5
49805>>>>>
49805>>>>>        Object oPrint_bn is a ButtonSub
49807>>>>>            Set Label to "„¡«â¢œ©ž (F2)"
49808>>>>>            Set Size to 18 53
49809>>>>>            Set Location to 193 208
49810>>>>>
49810>>>>>            //AB-StoreStart
49810>>>>>            Procedure OnClick
49812>>>>>                Send StartReport
49813>>>>>            End_Procedure // OnClick
49814>>>>>            
49814>>>>>            
49814>>>>>            //AB-StoreEnd
49814>>>>>
49814>>>>>        End_Object    // oPrint_bn
49815>>>>>
49815>>>>>        Object oExit_bn is a ButtonSub
49817>>>>>            Set Label to "„¥¦›¦ª (Esc)"
49818>>>>>            Set Size to 18 53
49819>>>>>            Set Location to 193 267
49820>>>>>
49820>>>>>            //AB-StoreStart
49820>>>>>            Procedure OnClick
49822>>>>>                Send Request_Cancel
49823>>>>>            End_Procedure // OnClick
49824>>>>>            
49824>>>>>            //AB-StoreEnd
49824>>>>>
49824>>>>>        End_Object    // oExit_bn
49825>>>>>
49825>>>>>        Object grpYear is a GroupSub
49827>>>>>            Set Size to 24 316
49828>>>>>            Set Location to 1 3
49829>>>>>            Object frmCompany is a FormSub
49831>>>>>                Set Size to 13 71
49832>>>>>                Set Location to 8 36
49833>>>>>                Set Color to clBtnFace
49834>>>>>                Set Label_Col_Offset to 2
49835>>>>>                Set Label_Justification_Mode to jMode_Right
49836>>>>>                Set Enabled_State to FALSE
49837>>>>>                Set Item_Shadow_State Item 0 to TRUE
49838>>>>>                Set Shadow_State Item 0 to TRUE
49839>>>>>            End_Object    // frmCompany
49840>>>>>
49840>>>>>            Object frmBranch is a FormSub
49842>>>>>                Set Size to 13 85
49843>>>>>                Set Location to 8 147
49844>>>>>                Set Color to clBtnFace
49845>>>>>                Set Label_Col_Offset to 2
49846>>>>>                Set Label_Justification_Mode to jMode_Right
49847>>>>>                Set Enabled_State to FALSE
49848>>>>>                Set Item_Shadow_State Item 0 to TRUE
49849>>>>>                Set Shadow_State Item 0 to TRUE
49850>>>>>            End_Object    // frmBranch
49851>>>>>
49851>>>>>            Object frmYear is a FormSub
49853>>>>>                Set Size to 13 43
49854>>>>>                Set Location to 8 268
49855>>>>>                Set Color to clBtnFace
49856>>>>>                Set Label_Col_Offset to 2
49857>>>>>                Set Label_Justification_Mode to jMode_Right
49858>>>>>                Set Enabled_State to FALSE
49859>>>>>                Set Item_Shadow_State Item 0 to TRUE
49860>>>>>                Set Shadow_State Item 0 to TRUE
49861>>>>>            End_Object    // frmYear
49862>>>>>
49862>>>>>            Object TextBoxSub11 is a TextBoxSub
49864>>>>>                Set Label to "„«˜ ¨œå˜"
49865>>>>>                Set Location to 8 3
49866>>>>>                Set Size to 10 30
49867>>>>>            End_Object    // TextBoxSub11
49868>>>>>
49868>>>>>            Object TextBoxSub12 is a TextBoxSub
49870>>>>>                Set Label to "“§¦¡/£˜"
49871>>>>>                Set Location to 9 109
49872>>>>>                Set Size to 10 33
49873>>>>>            End_Object    // TextBoxSub12
49874>>>>>
49874>>>>>            Object TextBoxSub13 is a TextBoxSub
49876>>>>>                Set Label to "•¨ã©ž           "
49877>>>>>                Set Location to 8 234
49878>>>>>                Set Size to 10 29
49879>>>>>            End_Object    // TextBoxSub13
49880>>>>>
49880>>>>>        End_Object    // grpYear
49881>>>>>
49881>>>>>        Object oClear_bn is a ButtonSub
49883>>>>>            Set Label to "€¡ç¨à©ž (F5)"
49884>>>>>            Set Size to 18 53
49885>>>>>            Set Location to 193 3
49886>>>>>            Set Focus_Mode to Pointer_Only
49887>>>>>
49887>>>>>            //AB-StoreStart
49887>>>>>                                                                                                        
49887>>>>>            Set MDI_Container to (R044(Self))
49888>>>>>            
49888>>>>>            Procedure OnClick
49890>>>>>                Delegate Send Request_Clear
49892>>>>>                Forward Send OnClick
49894>>>>>            End_Procedure // OnClick
49895>>>>>            
49895>>>>>            
49895>>>>>            
49895>>>>>            
49895>>>>>            //AB-StoreEnd
49895>>>>>
49895>>>>>        End_Object    // oClear_bn
49896>>>>>
49896>>>>>        Object Textbox1 is a Textbox
49898>>>>>            Set Label to "“§¦¡˜«á©«ž£˜"
49899>>>>>            Set Location to 172 5
49900>>>>>            Set Size to 10 54
49901>>>>>            Set FontWeight to 600
49902>>>>>        End_Object    // Textbox1
49903>>>>>
49903>>>>>        Object branch_name is a FormSub
49905>>>>>            Set Size to 13 145
49906>>>>>            Set Location to 170 161
49907>>>>>            Set Label_Col_Offset to 2
49908>>>>>
49908>>>>>            //AB-StoreStart
49908>>>>>            set enabled_state to false
49909>>>>>            //AB-StoreEnd
49909>>>>>
49909>>>>>        End_Object    // branch_name
49910>>>>>
49910>>>>>
49910>>>>>        //AB-StoreStart
49910>>>>>                
49910>>>>>        Property String     pdDate_To           ""
49912>>>>>        Property String     pdDate_From         ""
49914>>>>>        
49914>>>>>        //jsjsjs 29/01/2001
49914>>>>>        //Property Number pnSelArthro     0
49914>>>>>        //Property Number pnSelArthro_1   0
49914>>>>>        //Property Number pnSelArthro_2   0
49914>>>>>        //Property Integer    piBtypKin_Code_From  0
49914>>>>>        //Property Integer    piBtypKin_Code_To    0
49914>>>>>        Property String psBtypKin_Recr_From     ''
49916>>>>>        Property String psBtypKin_recr_To       ''
49918>>>>>        Property String psSelArthro             ''
49920>>>>>        Property String psSelArthro_1           ''
49922>>>>>        Property String psSelArthro_2           ''
49924>>>>>        //jsjsjs 29/01/2001
49924>>>>>        
49924>>>>>        Property Integer piSeries 0
49926>>>>>        Property Integer piKeepSectionTogether 0 //All one by one currencies
49928>>>>>        Property Integer piState1 0
49930>>>>>        Property Integer piState2 0
49932>>>>>        Property Integer piState3 0
49934>>>>>        Property Integer piFromGmoveView False
49936>>>>>        
49936>>>>>        Procedure PrintCurrArthro String asSelectedArthro String asPrinter String lsBtypkinRecr Date ldBarticlHmnia
49938>>>>>            Integer liRptId
49939>>>>>            Set psSelArthro to asSelectedArthro
49940>>>>>            if (psSelArthro(Self) <> '') Begin
49942>>>>>                Set pdDate_To           to ldBarticlHmnia
49943>>>>>                Set pdDate_From         to ldBarticlHmnia
49944>>>>>                Set psBtypKin_Recr_From to lsBtypkinRecr
49945>>>>>                Set psBtypKin_Recr_To   to lsBtypkinRecr
49946>>>>>                Get Report_Object_Id    to liRptId
49947>>>>>                If (liRptId) Send Rebuild_Constraints to liRptId
49950>>>>>                Set piFromGmoveView     to True
49951>>>>>                If (asPrinter = "") Move "lpt1:" to asPrinter
49954>>>>>                Set Output_Device_Name  To asPrinter
49955>>>>>                Send Run_Report
49956>>>>>                Set piFromGmoveView     to False
49957>>>>>                Set psSelArthro         to ''
49958>>>>>                Set pdDate_To           to ''
49959>>>>>                Set pdDate_From         to ''
49960>>>>>                Set psBtypKin_Recr_From to ''
49961>>>>>                Set psBtypKin_Recr_To   to ''
49962>>>>>            end
49962>>>>>>
49962>>>>>        End_Procedure // PrintCurrArthro
49963>>>>>        
49963>>>>>        Procedure StartReport
49965>>>>>            Integer iOutputDevice liRptId
49966>>>>>            String  FileName
49966>>>>>            Date ldDate_From ldDate_To
49966>>>>>            Integer liGthaa_044
49966>>>>>            String lsSelArthro_1 lsSelArthro_2 lsBtypKin_Recr_From lsBtypKin_Recr_To
49966>>>>>            Integer liState1 liState2 liState3 liKeepSectionTogether
49966>>>>>        
49966>>>>>            Get Output_Device_Mode To iOutputDevice
49967>>>>>        
49967>>>>>            If iOutputDevice EQ PRINT_TO_WINDOW Begin
49969>>>>>               Make_Temp_File "TXT" FileName
49970>>>>>               Move (".\" - FileName)  To FileName
49971>>>>>               Set Output_Device_Name  To FileName
49972>>>>>            End
49972>>>>>>
49972>>>>>            Else If iOutputDevice EQ PRINT_TO_PRINTER ;               Set Output_Device_Name  To "Lpt1:"
49976>>>>>            Else If iOutputDevice EQ PRINT_TO_FILE Begin
49979>>>>>               Get Value of (frmFile(rdgSelectPrint (Self))) Item 0 to FileName
49980>>>>>               If (FileName = "") Make_Temp_File "TXT" FileName
49983>>>>>               Move (".\" - FileName)  To FileName
49984>>>>>               Set Output_Device_Name  To FileName
49985>>>>>            End
49985>>>>>>
49985>>>>>        
49985>>>>>            Get value of (FormSub1(GroupSub2(Self))) item 0 to ldDate_From
49986>>>>>            Set pdDate_From to ldDate_From
49987>>>>>            Get value of (FormSub2(GroupSub2(Self))) item 0 to ldDate_To
49988>>>>>            Set pdDate_To to ldDate_To
49989>>>>>        
49989>>>>>            Get value of (FrmG1(GroupSub3(Self))) item 0 to lsBtypKin_Recr_From
49990>>>>>            Set psBtypKin_Recr_From to (Trim(lsBtypKin_Recr_From))
49991>>>>>            Get value of (FrmG2(GroupSub3(Self))) item 0 to lsBtypKin_Recr_To
49992>>>>>            Set psBtypKin_Recr_To to (Trim(lsBtypKin_Recr_To))
49993>>>>>        
49993>>>>>            Get value of (FrmG12_3(GroupSub1(Self))) item 0 to lsSelArthro_1
49994>>>>>            Set psSelArthro_1 to (Trim(lsSelArthro_1))
49995>>>>>            Get value of (FrmG12_4(GroupSub1(Self))) item 0 to lsSelArthro_2
49996>>>>>            Set psSelArthro_2 to (Trim(lsSelArthro_2))
49997>>>>>        
49997>>>>>            Set piSeries to 0
49998>>>>>        
49998>>>>>            //--------------------------------------------------------------------------------
49998>>>>>            Get checked_State of (chkbCurr0(oSelectCurr(Self))) to liState1
49999>>>>>            Set piState1 to liState1
50000>>>>>            Get checked_State of (chkbCurr00(oSelectCurr(Self))) to liState2
50001>>>>>            Set piState2 to liState2
50002>>>>>            Get checked_State of (chkbCurrR(oSelectCurr(Self))) to liState3
50003>>>>>            Set piState3 to liState3
50004>>>>>            Get checked_State of (chkbKeepTogether(oSelectCurr(Self))) to liKeepSectionTogether
50005>>>>>            Set piKeepSectionTogether to liKeepSectionTogether
50006>>>>>            //--------------------------------------------------------------------------------
50006>>>>>        
50006>>>>>            Get Report_Object_Id to liRptId
50007>>>>>            If (liRptId) Send Rebuild_Constraints to liRptId
50010>>>>>        
50010>>>>>            if (piState1(Self) = 1) begin
50012>>>>>                    Set piSeries to 1 //Book1
50013>>>>>                    Set piState1 to 0
50014>>>>>                    Send Run_Report
50015>>>>>            end
50015>>>>>>
50015>>>>>            if (piState2(Self) = 1) begin
50017>>>>>                    Set piSeries to 2 //Book2
50018>>>>>                    Set piState2 to 0
50019>>>>>                    send Run_Report
50020>>>>>            end
50020>>>>>>
50020>>>>>            if (piState3(Self) = 1) begin
50022>>>>>                    Set piSeries to 3 //Reporting
50023>>>>>                    Set piState3 to 0
50024>>>>>                    send Run_Report
50025>>>>>            end
50025>>>>>>
50025>>>>>            If (piSeries(Self) = 0) send Run_Report
50028>>>>>        
50028>>>>>            if (piKeepSectionTogether(Self) = 1) begin
50030>>>>>                Set piKeepSectionTogether to 0
50031>>>>>                send page_bottom to (BMoves_BasicReport(Self))
50032>>>>>                formfeed
50033>>>>>>
50033>>>>>            end
50033>>>>>>
50033>>>>>        
50033>>>>>            If iOutputDevice EQ PRINT_TO_WINDOW Begin
50035>>>>>               //Send DoRunEditor FileName "Empor"
50035>>>>>               RunProgram background "NotePad" FileName
50036>>>>>               EraseFile FileName
50037>>>>>>
50037>>>>>            End
50037>>>>>>
50037>>>>>        End_Procedure   // StartReport
50038>>>>>        
50038>>>>>        Function Bank_Descr String asCode Returns string
50040>>>>>            String lsDescr
50041>>>>>        
50041>>>>>            Clear Codemast
50042>>>>>            Move "BANK" to CodeMast.Type
50043>>>>>            Move asCode to CodeMast.Code
50044>>>>>            Find eq Codemast by Index.1
50045>>>>>>
50045>>>>>            [Found] Move (Trim(Codemast.Description)) to lsDescr
50046>>>>>            Function_Return lsDescr
50047>>>>>        End_Function // Bank_Descr
50048>>>>>        
50048>>>>>        Object BMoves_BasicReport is a BasicReportSub
50050>>>>>        
50050>>>>>            if (piKeepSectionTogether(Self) = 1) begin
50052>>>>>                set new_page_state to false
50053>>>>>            end
50053>>>>>>
50053>>>>>        
50053>>>>>           Set report_view_id to (Parent(Self))
50054>>>>>           set report_caption to "ƒ ˜› ¡˜©å˜ ©œ œ¥â¢ ¥ž             "
50055>>>>>           set report_title to "„¡«ç§à©ž €¨Ÿ¨à¤                     "
50056>>>>>           Report_Main_File BMove
50057>>>>>           Report_breaks Bmove.Barticl_Hmnia Bmove.Barticl_Recr
50071>>>>>        
50071>>>>>           Procedure Constrain
50073>>>>>                //jsjsjs 29/01/2001 Number lnSelArthro lnSelArthro_1 lnSelArthro_2
50073>>>>>                String lsSelArthro lsSelArthro_1 lsSelArthro_2 sbranch
50074>>>>>                Integer liGarticlStatusE
50074>>>>>                get psbranch to sbranch
50075>>>>>                Constrain Bmove.Company_Code eq SysCurXr.Company_Code
50077>>>>>                if (sbranch<>'');                    Constrain Bmove.Branch_Code  eq Sbranch
50081>>>>>                Constrain Bmove.Year_Year    eq SysCurXr.Year_Year
50083>>>>>        
50083>>>>>                Get psSelArthro     to lsSelArthro
50084>>>>>                Get psSelArthro_1   to lsSelArthro_1
50085>>>>>                Get psSelArthro_2   to lsSelArthro_2
50086>>>>>        
50086>>>>>                If (pdDate_From        (Self)<>'')  Constrain Bmove.Barticl_Hmnia ge (pdDate_From(Self))
50090>>>>>                If (pdDate_To          (Self)<>'')  Constrain Bmove.Barticl_Hmnia le (pdDate_To(Self))
50094>>>>>                if (psBtypKin_Recr_From(Self)<>'')  Constrain Bmove.Btypkin_Recr  ge (psBtypKin_Recr_From(Self))
50098>>>>>                if (psBtypKin_Recr_To  (Self)<>'')  Constrain Bmove.Btypkin_Recr  le (psBtypKin_Recr_To(Self))
50102>>>>>                if (lsSelArthro              <>'')  Constrain Bmove.Barticl_recr  eq lsSelArthro
50106>>>>>                Else if ((lsSelArthro_1<>'') OR (lsSelArthro_2 <> '')) Begin
50109>>>>>                     If  (lsSelArthro_1<>'') Constrain Bmove.Barticl_recr ge lsSelArthro_1
50113>>>>>                     If  (lsSelArthro_2<>'') Constrain Bmove.Barticl_recr le lsSelArthro_2
50117>>>>>                End
50117>>>>>>
50117>>>>>                Forward Send Constrain
50119>>>>>           End_Procedure // Constrain
50120>>>>>        
50120>>>>>           Function Starting_Report Returns Integer
50122>>>>>                Zero_SubTotals SubHeaderR044_1.10
50123>>>>>                Zero_SubTotals BodyR044.7 BodyR044.10 RecParArticl.1
50126>>>>>                Zero_SubTotals SubtotalR044_2.1 SubtotalR044_2.2
50128>>>>>           End_Function // Starting_Report
50129>>>>>        
50129>>>>>           Function Starting_Main_Report Returns Integer
50131>>>>>              Integer iRetVal
50132>>>>>              Integer iIndexR044 liRepPanelId
50132>>>>>              Forward Get Starting_Main_Report to iRetval
50134>>>>>        
50134>>>>>              If (piFromGmoveView(Self)) Begin
50136>>>>>                   Move 5 to iIndexR044  //
50137>>>>>              End
50137>>>>>>
50137>>>>>              Else Begin
50138>>>>>                   Move 5 to iIndexR044
50139>>>>>              End
50139>>>>>>
50139>>>>>              Report_Index BY iIndexR044    // set the sort order
50141>>>>>              Blankform FooterR044_1.1
50142>>>>>>
50142>>>>>              Get Report_Status_Panel to liRepPanelId
50143>>>>>              set button_text of lireppanelid to "&€¡ç¨à©ž"
50144>>>>>              Set page_feed to  0 //66 // default -2
50145>>>>>              Set page_end  to 63    // default 59
50146>>>>>              Function_Return iRetval
50147>>>>>           End_Function
50148>>>>>        
50148>>>>>           Procedure_Section Page_Top as HeaderR044
50153>>>>>              Integer iPage
50153>>>>>              string sbranch
50153>>>>>              Get Page_Count  To iPage
50154>>>>>              get psbranch    to sbranch
50155>>>>>              clear branch
50156>>>>>              move syscurxr.company_code to branch.company_code
50157>>>>>              move sbranch               to branch.branch_code
50158>>>>>              find eq branch by index.1
50159>>>>>>
50159>>>>>              if (found=1) print branch.branch_name to HeaderR044.2
50162>>>>>              else         print ''                 to HeaderR044.2
50164>>>>>              print SysCurXr.Company_Name to HeaderR044.1
50165>>>>>            //  print SysCurXr.Branch_Name  to HeaderR044.2
50165>>>>>              print SysCurXr.Year_Descr   to HeaderR044.3
50166>>>>>        
50166>>>>>             // Print iPage                to HeaderR044.7
50166>>>>>              OutPut_PageCheck
50167>>>>>           End_Procedure
50168>>>>>        
50168>>>>>           Procedure_Section SubHeader1
50170>>>>>           End_Procedure // SubHeader1
50171>>>>>        
50171>>>>>           Procedure_Section SubHeader2 as SubheaderR044_1
50176>>>>>              Integer iPage liSeries
50176>>>>>              Number lnYpol
50176>>>>>              String lsCCode
50176>>>>>        
50176>>>>>        
50176>>>>>              Get piSeries to liSeries
50177>>>>>              Print Btypkin.Btypkin_Pdescr to SubheaderR044_1.1
50178>>>>>              Print Btypkin.Btypkin_Seira  to SubheaderR044_1.2
50179>>>>>              Print Btypkin.Btypkin_Code   to SubheaderR044_1.3
50180>>>>>              Print Barticl.Barticl_No     to SubheaderR044_1.4
50181>>>>>              Print Barticl.Barticl_Rec0   to SubheaderR044_1.5
50182>>>>>              Print Barticl.Barticl_Hmnia  to SubheaderR044_1.6
50183>>>>>              Print Barticl.Barticl_Epon1  to SubheaderR044_1.7
50184>>>>>              Print Barticl.Barticl_Epon2  to SubheaderR044_1.8
50185>>>>>        
50185>>>>>              If (liSeries = 1) Begin
50187>>>>>                Move Barticl.Barticl_Sv0  to lnYpol
50188>>>>>                Move Year.Year_C_Code0    to lsCCode
50189>>>>>              End
50189>>>>>>
50189>>>>>              Else If (liSeries = 2) Begin
50192>>>>>                Move Barticl.Barticl_Sv00 to lnYpol
50193>>>>>                Move Year.Year_C_Code00   to lsCCode
50194>>>>>              End
50194>>>>>>
50194>>>>>              Else If (liSeries = 3) Begin
50197>>>>>                Move Barticl.Barticl_SvR  to lnYpol
50198>>>>>                Move Year.Year_C_CodeR    to lsCCode
50199>>>>>              End
50199>>>>>>
50199>>>>>              Else If (liSeries = 0) Begin
50202>>>>>                Move Barticl.Barticl_Sv0  to lnYpol
50203>>>>>                Move Year.Year_C_Code0    to lsCCode
50204>>>>>              End
50204>>>>>>
50204>>>>>              Print lscCode                to SubheaderR044_1.9
50205>>>>>              Print lnYpol                 to SubheaderR044_1.10
50206>>>>>              Print Barticl.Barticl_Aitiol to SubheaderR044_1.11
50207>>>>>        
50207>>>>>              OutPut_PageCheck
50208>>>>>           End_Procedure
50209>>>>>        
50209>>>>>           Procedure_Section  Body as BodyR044
50214>>>>>             Integer liSeries
50214>>>>>             Number lnAjia
50214>>>>>             String lsCCode
50214>>>>>        
50214>>>>>             send update_status ('„šš¨˜­ã ' + string(barticl.barticl_hmnia) + ":" +  string(bmove.bmove_rec0))
50215>>>>>             Get piSeries to liSeries
50216>>>>>             Print Bmove.Bmove_aa                to BodyR044.1
50217>>>>>             Print Baxiokat.Baxiokat_Descr       to BodyR044.2
50218>>>>>             Print Baxio.Baxio_Code              to BodyR044.3
50219>>>>>             Print (Bank_Descr(Self,Baxio.Baxio_Banka))    to BodyR044.4
50220>>>>>             Print Baxio.Baxio_No                to BodyR044.5
50221>>>>>        
50221>>>>>             Print Baxio.Baxio_C_Code2           to BodyR044.6
50222>>>>>             Print Baxio.Baxio_V2                to BodyR044.7 //{ points=2} //Reccord
50223>>>>>        
50223>>>>>             Print Baxio.Baxio_Hmnial            to BodyR044.8
50224>>>>>        
50224>>>>>             if (liSeries = 1) begin
50226>>>>>                Move Year.Year_C_Code0  to lsCCode
50227>>>>>                Move Baxio.Baxio_V0     to lnAjia
50228>>>>>             end
50228>>>>>>
50228>>>>>             if (liSeries = 2) begin
50230>>>>>                Move Year.Year_C_Code00 to lsCCode
50231>>>>>                Move Baxio.Baxio_V00    to lnAjia
50232>>>>>             End
50232>>>>>>
50232>>>>>             if (liSeries = 3) begin
50234>>>>>                Move Year.Year_C_CodeR  to lsCCode
50235>>>>>                 Move Baxio.Baxio_VR    to lnAjia
50236>>>>>             End
50236>>>>>>
50236>>>>>             if (liSeries = 0) begin
50238>>>>>                Move Year.Year_C_Code0  to lsCCode
50239>>>>>                Move Baxio.Baxio_V0     to lnAjia
50240>>>>>             end
50240>>>>>>
50240>>>>>        
50240>>>>>             Print lsCCode                       to BodyR044.9  //{ points=2} BOOK
50241>>>>>             Print lnAjia                        to BodyR044.10 //{ points=2} BOOK
50242>>>>>             Add 1 to RecParArticl.1
50243>>>>>             OutPut_PageCheck
50244>>>>>           End_Procedure
50245>>>>>        
50245>>>>>           Procedure_Section  Subtotal2 as SubtotalR044_2
50250>>>>>        
50250>>>>>             Print    RecParArticl.1   to SubtotalR044_2.1
50251>>>>>             Subtotal BodyR044.10      to SubtotalR044_2.2 //{ points=2}
50253>>>>>             BlankForm RecParArticl.1
50254>>>>>>
50254>>>>>        
50254>>>>>             OutPut_PageCheck
50255>>>>>           end_Procedure  // Subtotal2
50256>>>>>        
50256>>>>>           Procedure_Section  Subtotal1 as SubtotalR044_1
50261>>>>>        
50261>>>>>             //Subtotal SubtotalR044_2.2 to SubtotalR044_1.1 { points=2}
50261>>>>>             //Subtotal SubtotalR044_2.3 to SubtotalR044_1.2 { points=2}
50261>>>>>        
50261>>>>>             //If (piFromGmoveView(Self)=0) OutPut_PageCheck
50261>>>>>        
50261>>>>>           end_Procedure // Subtotal1
50262>>>>>        
50262>>>>>           Procedure_Section Page_Bottom as FooterR044_1
50271>>>>>               if (piKeepSectionTogether(self) <> 1)  OutPut_PageCheck
50274>>>>>           End_Procedure
50275>>>>>        
50275>>>>>        
50275>>>>>           Procedure Ending_Report
50277>>>>>               Integer rVal
50278>>>>>               Blankform SubtotalR044_2.1
50279>>>>>>
50279>>>>>               // „§˜¤˜­¦¨á «à¤ Buffers
50279>>>>>               Get fiRefindYear to rVal
50280>>>>>           End_Procedure
50281>>>>>        
50281>>>>>        End_Object // GMoves_BasicReport
50282>>>>>        
50282>>>>>        Procedure Activate_View Returns Integer
50284>>>>>            Integer Rval
50285>>>>>            Forward Get MSG_Activate_View   to Rval
50287>>>>>            If (Not(rVal))  Begin
50289>>>>>                Set Value of (frmCompany(grpYear(Self))) to SysCurXr.Company_Name
50290>>>>>                Set Value of (frmBranch(grpYear(Self)))  to SysCurXr.Branch_Name
50291>>>>>                Set Value of (frmYear(grpYear(Self)))    to SysCurXr.Year_Descr
50292>>>>>                set value of (formsub5(self))            to SysCurXr.Branch_code
50293>>>>>                set label of (chkbCurr0(oSelectCurr(Self)))  To SysCurXr.C_Code0
50294>>>>>                set label of (chkbCurr00(oSelectCurr(Self))) To SysCurXr.C_Code00
50295>>>>>                set label of (chkbCurrR(oSelectCurr(Self)))  To SysCurXr.C_CodeR
50296>>>>>                Set checked_State of (chkbCurr0(oSelectCurr(Self))) to 1
50297>>>>>            End
50297>>>>>>
50297>>>>>            Procedure_Return rVal
50298>>>>>        End_Procedure // Activate_View
50299>>>>>        
50299>>>>>        Procedure Request_Clear
50301>>>>>            Set Value of (FormSub1(GroupSub2(Self))) Item 0 to ""
50302>>>>>            Set Value of (FormSub2(GroupSub2(Self))) Item 0 to ""
50303>>>>>            Set Value of (frmG12_3(GroupSub1(Self))) Item 0 to ""
50304>>>>>            Set Value of (frmG12_4(GroupSub1(Self))) Item 0 to ""
50305>>>>>            Set Value of (frmG1(GroupSub3(Self))) Item 0 to ""
50306>>>>>            Set Value of (frmG2(GroupSub3(Self))) Item 0 to ""
50307>>>>>            Set checked_State of (chkbCurr0(oSelectCurr(Self))) to True
50308>>>>>            Set checked_State of (chkbCurr00(oSelectCurr(Self))) to False
50309>>>>>            Set checked_State of (chkbCurrR(oSelectCurr(Self))) to False
50310>>>>>            Set checked_State of (chkbKeepTogether(oSelectCurr(Self))) to False
50311>>>>>            Send Activate to (FormSub1(GroupSub2(Self)))
50312>>>>>        End_Procedure // Request_Clear
50313>>>>>        
50313>>>>>        //Set Verify_Exit_Msg To Get_No_Confirmation
50313>>>>>        On_Key kSave_Record Send KeyAction to oPrint_bn
50314>>>>>        On_Key kCancel      Send KeyAction to oExit_bn
50315>>>>>        On_Key kClear       Send Request_Clear
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        
50316>>>>>        //AB-StoreEnd
50316>>>>>
50316>>>>>    End_Object    // R044
50317>>>>>
50317>>>>>
50317>>>>>    //AB-StoreStart
50317>>>>>            
50317>>>>>            
50317>>>>>            
50317>>>>>            
50317>>>>>            
50317>>>>>            
50317>>>>>    //AB-StoreEnd
50317>>>>>
50317>>>>>//AB/     End_Object    // prj
50317>>>Use v037.vw
INCLUDING FILE: V037.VW
50317>>>>>//AB/ Project V037:BAXIO
50317>>>>>//AB/ Object prj is a View_Project
50317>>>>>//AB/     Set ProjectName to "V037:BAXIO"
50317>>>>>//AB/     Set ProjectFileName to "V037.VW"
50317>>>>>
50317>>>>>// Project Object Structure
50317>>>>>//   VW037 is a dbViewSub
50317>>>>>//     Btypkin_DD is a DataDictionary
50317>>>>>//     Baxiokat_DD is a DataDictionary
50317>>>>>//     Barticl_DD is a DataDictionary
50317>>>>>//     Baxio_DD is a DataDictionary
50317>>>>>//     Syscurxr_DD is a DataDictionary
50317>>>>>//     Bmove_DD is a DataDictionary
50317>>>>>//     Baxiokat_Baxiokat_Code is a dbFormSub
50317>>>>>//     Baxiokat_Baxiokat_Descr is a dbFormSub
50317>>>>>//     Baxio_Baxio_Code is a dbFormSub
50317>>>>>//     Baxio_Baxio_Status is a dbFormSub
50317>>>>>//     Baxio_Baxio_Place is a dbFormSub
50317>>>>>//     dbTbDlgAxio is a dbTabDialogSub
50317>>>>>//       TP_Additional is a dbTabPage
50317>>>>>//         dbGrpObligate is a dbGroupSub
50317>>>>>//           Baxio_Baxio_Hmnial is a dbFormSub
50317>>>>>//           Baxio_Baxio_V4 is a dbFormSub
50317>>>>>//           Rate0 is a dbFormSub
50317>>>>>//           Rate00 is a dbFormSub
50317>>>>>//           RateR is a dbFormSub
50317>>>>>//           TextBoxSub3 is a TextBoxSub
50317>>>>>//           TextBoxSub4 is a TextBoxSub
50317>>>>>//           TextBoxSub5 is a TextBoxSub
50317>>>>>//           txtnom1 is a TextBoxSub
50317>>>>>//           txtnom2 is a TextBoxSub
50317>>>>>//           txtnom3 is a TextBoxSub
50317>>>>>//           Baxio_Baxio_C_Code2 is a dbFormSub
50317>>>>>//         dbGrpOptional is a dbGroupSub
50317>>>>>//           Baxio_Baxio_Ekdoths is a dbFormSub
50317>>>>>//           Baxio_Baxio_Ekdothse is a dbFormSub
50317>>>>>//           Baxio_Baxio_Sediatagh is a dbFormSub
50317>>>>>//           Baxio_Baxio_Sdiataghe is a dbFormSub
50317>>>>>//           Baxio_Baxio_Banka is a dbComboFormSub
50317>>>>>//           Baxio_Baxio_No is a dbFormSub
50317>>>>>//           Baxio_Baxio_From is a dbComboFormSub
50317>>>>>//           Baxio_Baxio_Topos is a dbComboFormSub
50317>>>>>//           Baxio_Baxio_Opistho is a dbEditSub
50317>>>>>//           TextBoxSub6 is a TextBoxSub
50317>>>>>//           TextBoxSub7 is a TextBoxSub
50317>>>>>//           TextBoxSub8 is a TextBoxSub
50317>>>>>//           TextBoxSub9 is a TextBoxSub
50317>>>>>//           TextBoxSub10 is a TextBoxSub
50317>>>>>//           TextBoxSub11 is a TextBoxSub
50317>>>>>//           TextBoxSub12 is a TextBoxSub
50317>>>>>//           Textbox3 is a Textbox
50317>>>>>//           Textbox4 is a Textbox
50317>>>>>//       TP_Status is a dbTabPage
50317>>>>>//         dbGrpEispraktea is a dbGroupSub
50317>>>>>//           Baxio_Baxio_Fbarticl is a dbFormSub
50317>>>>>//           Baxio_Baxio_Code_In is a dbFormSub
50317>>>>>//           Baxio_Baxio_Epon_In is a dbFormSub
50317>>>>>//           dbFrmHmnia is a dbFormSub
50317>>>>>//           dbFrmNo is a dbFormSub
50317>>>>>//           dbFrmGtypkin is a dbFormSub
50317>>>>>//           TextBoxSub18 is a TextBoxSub
50317>>>>>//           TextBoxSub19 is a TextBoxSub
50317>>>>>//           TextBoxSub24 is a TextBoxSub
50317>>>>>//           TextBoxSub27 is a TextBoxSub
50317>>>>>//           TextBoxSub30 is a TextBoxSub
50317>>>>>//         dbGrpPlhrotea is a dbGroupSub
50317>>>>>//           Baxio_Baxio_Lbarticl is a dbFormSub
50317>>>>>//           Baxio_Baxio_Code_Out is a dbFormSub
50317>>>>>//           Baxio_Baxio_Epon_Out is a dbFormSub
50317>>>>>//           dbFrmHmnia is a dbFormSub
50317>>>>>//           dbFrmNo is a dbFormSub
50317>>>>>//           dbFrmGtypkin is a dbFormSub
50317>>>>>//           TextBoxSub20 is a TextBoxSub
50317>>>>>//           TextBoxSub21 is a TextBoxSub
50317>>>>>//           TextBoxSub25 is a TextBoxSub
50317>>>>>//           TextBoxSub28 is a TextBoxSub
50317>>>>>//           TextBoxSub31 is a TextBoxSub
50317>>>>>//         dbGrpCurrentStat is a dbGroupSub
50317>>>>>//           Baxio_Baxio_Lcode is a dbFormSub
50317>>>>>//           Baxio_Baxio_Lepon is a dbFormSub
50317>>>>>//           Baxio_Baxio_Lpar is a dbFormSub
50317>>>>>//           dbFrmHmnia is a dbFormSub
50317>>>>>//           dbFrmNo is a dbFormSub
50317>>>>>//           dbFrmGtypkin is a dbFormSub
50317>>>>>//           TextBoxSub22 is a TextBoxSub
50317>>>>>//           TextBoxSub23 is a TextBoxSub
50317>>>>>//           TextBoxSub26 is a TextBoxSub
50317>>>>>//           TextBoxSub29 is a TextBoxSub
50317>>>>>//           TextBoxSub32 is a TextBoxSub
50317>>>>>//       TP_Bmove is a dbTabPage
50317>>>>>//         grdBmove is a dbGridSub
50317>>>>>//     dbGrpYear is a dbGroupSub
50317>>>>>//       Company_Company_Name is a dbFormSub
50317>>>>>//       Branch_Branch_Name is a dbFormSub
50317>>>>>//       Year_Year_Year is a dbFormSub
50317>>>>>//       otxtCompany is a TextBoxSub
50317>>>>>//       otxtBranch is a TextBoxSub
50317>>>>>//       otxtYear is a TextBoxSub
50317>>>>>//     TextBoxSub1 is a TextBoxSub
50317>>>>>//     TextBoxSub2 is a TextBoxSub
50317>>>>>//     TextBoxSub13 is a TextBoxSub
50317>>>>>//     TextBoxSub14 is a TextBoxSub
50317>>>>>
50317>>>>>// Register all objects
50317>>>>>Register_Object Barticl_DD
50317>>>>>Register_Object Baxio_Baxio_Banka
50317>>>>>Register_Object Baxio_Baxio_C_Code2
50317>>>>>Register_Object Baxio_Baxio_Code
50317>>>>>Register_Object Baxio_Baxio_Code_In
50317>>>>>Register_Object Baxio_Baxio_Code_Out
50317>>>>>Register_Object Baxio_Baxio_Ekdoths
50317>>>>>Register_Object Baxio_Baxio_Ekdothse
50317>>>>>Register_Object Baxio_Baxio_Epon_In
50317>>>>>Register_Object Baxio_Baxio_Epon_Out
50317>>>>>Register_Object Baxio_Baxio_Fbarticl
50317>>>>>Register_Object Baxio_Baxio_From
50317>>>>>Register_Object Baxio_Baxio_Hmnial
50317>>>>>Register_Object Baxio_Baxio_Lbarticl
50317>>>>>Register_Object Baxio_Baxio_Lcode
50317>>>>>Register_Object Baxio_Baxio_Lepon
50317>>>>>Register_Object Baxio_Baxio_Lpar
50317>>>>>Register_Object Baxio_Baxio_No
50317>>>>>Register_Object Baxio_Baxio_Opistho
50317>>>>>Register_Object Baxio_Baxio_Place
50317>>>>>Register_Object Baxio_Baxio_Sdiataghe
50317>>>>>Register_Object Baxio_Baxio_Sediatagh
50317>>>>>Register_Object Baxio_Baxio_Status
50317>>>>>Register_Object Baxio_Baxio_Topos
50317>>>>>Register_Object Baxio_Baxio_V4
50317>>>>>Register_Object Baxio_DD
50317>>>>>Register_Object Baxiokat_Baxiokat_Code
50317>>>>>Register_Object Baxiokat_Baxiokat_Descr
50317>>>>>Register_Object Baxiokat_DD
50317>>>>>Register_Object Bmove_DD
50317>>>>>Register_Object Branch_Branch_Name
50317>>>>>Register_Object Btypkin_DD
50317>>>>>Register_Object Company_Company_Name
50317>>>>>Register_Object dbFrmGtypkin
50317>>>>>Register_Object dbFrmHmnia
50317>>>>>Register_Object dbFrmNo
50317>>>>>Register_Object dbGrpCurrentStat
50317>>>>>Register_Object dbGrpEispraktea
50317>>>>>Register_Object dbGrpObligate
50317>>>>>Register_Object dbGrpOptional
50317>>>>>Register_Object dbGrpPlhrotea
50317>>>>>Register_Object dbGrpYear
50317>>>>>Register_Object dbTbDlgAxio
50317>>>>>Register_Object grdBmove
50317>>>>>Register_Object otxtBranch
50317>>>>>Register_Object otxtCompany
50317>>>>>Register_Object otxtYear
50317>>>>>Register_Object Rate0
50317>>>>>Register_Object Rate00
50317>>>>>Register_Object RateR
50317>>>>>Register_Object Syscurxr_DD
50317>>>>>Register_Object TextBoxSub1
50317>>>>>Register_Object TextBoxSub10
50317>>>>>Register_Object TextBoxSub11
50317>>>>>Register_Object TextBoxSub12
50317>>>>>Register_Object TextBoxSub13
50317>>>>>Register_Object TextBoxSub14
50317>>>>>Register_Object TextBoxSub18
50317>>>>>Register_Object TextBoxSub19
50317>>>>>Register_Object TextBoxSub2
50317>>>>>Register_Object TextBoxSub20
50317>>>>>Register_Object TextBoxSub21
50317>>>>>Register_Object TextBoxSub22
50317>>>>>Register_Object TextBoxSub23
50317>>>>>Register_Object TextBoxSub24
50317>>>>>Register_Object TextBoxSub25
50317>>>>>Register_Object TextBoxSub26
50317>>>>>Register_Object TextBoxSub27
50317>>>>>Register_Object TextBoxSub28
50317>>>>>Register_Object TextBoxSub29
50317>>>>>Register_Object TextBoxSub3
50317>>>>>Register_Object TextBoxSub30
50317>>>>>Register_Object TextBoxSub31
50317>>>>>Register_Object TextBoxSub32
50317>>>>>Register_Object TextBoxSub4
50317>>>>>Register_Object TextBoxSub5
50317>>>>>Register_Object TextBoxSub6
50317>>>>>Register_Object TextBoxSub7
50317>>>>>Register_Object TextBoxSub8
50317>>>>>Register_Object TextBoxSub9
50317>>>>>Register_Object Textbox3
50317>>>>>Register_Object Textbox4
50317>>>>>Register_Object TP_Additional
50317>>>>>Register_Object TP_Bmove
50317>>>>>Register_Object TP_Status
50317>>>>>Register_Object txtnom1
50317>>>>>Register_Object txtnom2
50317>>>>>Register_Object txtnom3
50317>>>>>Register_Object VW037
50317>>>>>Register_Object Year_Year_Year
50317>>>>>
50317>>>>>
50317>>>>>//AB/ AppBuild VIEW
50317>>>>>
50317>>>>>//AB-IgnoreStart
50317>>>>>
50317>>>>>Use dbView.Sub
50317>>>>>Use DFAllEnt.pkg
50317>>>>>Use dbForm.Sub
50317>>>>>Use dbTabdlg.Sub
50317>>>>>Use dbGroup.Sub
50317>>>>>Use Txtbox.Sub
50317>>>>>Use dbCmbfrm.Sub
50317>>>>>Use dbEdit.Sub
50317>>>>>Use dbGrid.Sub
50317>>>>>
50317>>>>>Use BTYPKIN.DD
50317>>>>>Use BAXIOKAT.DD
50317>>>>>Use BARTICL.DD
50317>>>>>Use BAXIO.DD
50317>>>>>Use SYSCURXR.DD
50317>>>>>Use BMOVE.DD
50317>>>>>
50317>>>>>//AB-IgnoreEnd
50317>>>>>
50317>>>>>ACTIVATE_VIEW Activate_VW037 FOR VW037
50321>>>>>
50321>>>>>Object VW037 is a dbViewSub
50323>>>>>
50323>>>>>    //AB-StoreTopStart
50323>>>>>                                                                    
50323>>>>>    //AB-StoreTopEnd
50323>>>>>
50323>>>>>    Set Label to "V037:€¥ æš¨˜­˜"
50324>>>>>    Set Size to 278 515
50325>>>>>    Set Location to 1 0
50326>>>>>
50326>>>>>    //AB-DDOStart
50326>>>>>
50326>>>>>    Object Btypkin_DD is a Btypkin_DataDictionary
50328>>>>>
50328>>>>>        //AB-StoreStart
50328>>>>>                                                                                                                
50328>>>>>        Set Field_Prompt_Object Field Btypkin.Btypkin_Code to None
50329>>>>>        
50329>>>>>        
50329>>>>>        
50329>>>>>        //AB-StoreEnd
50329>>>>>
50329>>>>>    End_Object    // Btypkin_DD
50330>>>>>
50330>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
50332>>>>>
50332>>>>>        //AB-StoreStart
50332>>>>>                                                                                                                
50332>>>>>        Set Field_Options Field Baxiokat.Baxiokat_Code  to DD_Clear_Field_Options DD_Required
50333>>>>>        
50333>>>>>        Set Foreign_Field_Options DD_IndexField         to DD_Clear_Field_Options DD_FindReq
50334>>>>>        Set Foreign_Field_Options DD_KeyField           to DD_Clear_Field_Options DD_FindReq
50335>>>>>        
50335>>>>>        
50335>>>>>        //AB-StoreEnd
50335>>>>>
50335>>>>>    End_Object    // Baxiokat_DD
50336>>>>>
50336>>>>>    Object Barticl_DD is a Barticl_DataDictionary
50338>>>>>        Set DDO_Server to (Btypkin_DD(self))
50339>>>>>
50339>>>>>        //AB-StoreStart
50339>>>>>                                                                                                                
50339>>>>>        Set Field_Prompt_Object Field Barticl.Barticl_Hmnia to None
50340>>>>>        Set Field_Prompt_Object Field Barticl.Barticl_No    to None
50341>>>>>        
50341>>>>>        //AB-StoreEnd
50341>>>>>
50341>>>>>    End_Object    // Barticl_DD
50342>>>>>
50342>>>>>    Object Baxio_DD is a Baxio_DataDictionary
50344>>>>>        Set DDO_Server to (Baxiokat_DD(self))
50345>>>>>
50345>>>>>        //AB-StoreStart
50345>>>>>                                                                                                                
50345>>>>>        Function Validate_Save Returns Integer
50347>>>>>            Integer rVal
50348>>>>>            Forward Get Validate_Save to rVal
50350>>>>>            If (Not(rval)) If (Not(Current_Record(Self))) Move 1 to rVal
50355>>>>>            Function_Return rVal
50356>>>>>        End_Procedure // Validate_Save
50357>>>>>        
50357>>>>>        
50357>>>>>        
50357>>>>>        
50357>>>>>        //AB-StoreEnd
50357>>>>>
50357>>>>>    End_Object    // Baxio_DD
50358>>>>>
50358>>>>>    Object Syscurxr_DD is a Syscurxr_DataDictionary
50360>>>>>    End_Object    // Syscurxr_DD
50361>>>>>
50361>>>>>    Object Bmove_DD is a Bmove_DataDictionary
50363>>>>>        Set DDO_Server to (Barticl_DD(self))
50364>>>>>        Set DDO_Server to (Baxio_DD(self))
50365>>>>>        Set Constrain_File to Baxio.File_Number
50366>>>>>
50366>>>>>        //AB-StoreStart
50366>>>>>                                                                                                                
50366>>>>>        Set Ordering to 4
50367>>>>>        
50367>>>>>        Function Validate_Save Returns Integer
50369>>>>>            Function_Return 1
50370>>>>>        End_Procedure // Validate_Save
50371>>>>>        
50371>>>>>        Function Validate_Delete  Returns Integer
50373>>>>>            Function_Return 1
50374>>>>>        End_Function // Validate_Delete
50375>>>>>        
50375>>>>>        
50375>>>>>        
50375>>>>>        
50375>>>>>        
50375>>>>>        //AB-StoreEnd
50375>>>>>
50375>>>>>    End_Object    // Bmove_DD
50376>>>>>
50376>>>>>    Set Main_DD to (Baxio_DD(self))
50377>>>>>    Set Server to (Baxio_DD(self))
50378>>>>>
50378>>>>>    //AB-DDOEnd
50378>>>>>
50378>>>>>    Object Baxiokat_Baxiokat_Code is a dbFormSub
50380>>>>>        Entry_Item Baxiokat.Baxiokat_code
50381>>>>>        Set Size to 13 42
50382>>>>>        Set Location to 36 41
50383>>>>>        Set Label_Col_Offset to 35
50384>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
50385>>>>>    End_Object    // Baxiokat_Baxiokat_Code
50386>>>>>
50386>>>>>    Object Baxiokat_Baxiokat_Descr is a dbFormSub
50388>>>>>        Entry_Item Baxiokat.Baxiokat_descr
50389>>>>>        Set Size to 13 182
50390>>>>>        Set Location to 36 86
50391>>>>>        Set Label_Col_Offset to 2
50392>>>>>        Set Label_Justification_Mode to jMode_Right
50393>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
50394>>>>>    End_Object    // Baxiokat_Baxiokat_Descr
50395>>>>>
50395>>>>>    Object Baxio_Baxio_Code is a dbFormSub
50397>>>>>        Entry_Item Baxio.Baxio_code
50398>>>>>        Set Size to 13 116
50399>>>>>        Set Location to 50 41
50400>>>>>        Set Label_Col_Offset to 35
50401>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
50402>>>>>
50402>>>>>        //AB-StoreStart
50402>>>>>                                                                                                                
50402>>>>>        Procedure Prompt_Callback Integer hPrompt
50404>>>>>            Integer liBaxiokatCode
50405>>>>>            Get Field_Current_Value of Baxiokat_DD Field Baxiokat.Baxiokat_Code to liBaxiokatCode
50406>>>>>            Set piFragmaBaxiokatCode of hPrompt to liBaxiokatCode
50407>>>>>            Set Auto_Index_State of hPrompt to False
50408>>>>>        End_Procedure // Prompt_Callback
50409>>>>>        
50409>>>>>        
50409>>>>>        
50409>>>>>        
50409>>>>>        
50409>>>>>        
50409>>>>>        //AB-StoreEnd
50409>>>>>
50409>>>>>    End_Object    // Baxio_Baxio_Code
50410>>>>>
50410>>>>>    Object Baxio_Baxio_Status is a dbFormSub
50412>>>>>
50412>>>>>        //AB-StoreTopStart
50412>>>>>                                                                                                                
50412>>>>>        Function Show_Status_Descr Returns String
50414>>>>>            Integer iValue iSrv iField iObj liStatusId
50415>>>>>            String sDesc sVal
50415>>>>>            If (Current_Record(Baxio_DD(Self))) Begin
50417>>>>>                Get Server of Baxio_Baxio_Status to iSrv
50418>>>>>                Get_FieldNumber Baxio.Baxio_Status to iField
50419>>>>>                Get Field_Current_Value of iSrv Field Baxio.Baxio_Status to sVal
50420>>>>>                Move Baxio_Status_VT to iObj
50421>>>>>                If (iObj) get Find_Code_Description of iObj sVal to sDesc
50424>>>>>                Function_Return sDesc
50425>>>>>            End
50425>>>>>>
50425>>>>>        End_Function // Show_Status_Descr
50426>>>>>        
50426>>>>>        //AB-StoreTopEnd
50426>>>>>
50426>>>>>        Entry_Item (Show_Status_Descr(Self))
50427>>>>>        Set Size to 13 116
50428>>>>>        Set Location to 36 340
50429>>>>>        Set Label_Col_Offset to 50
50430>>>>>
50430>>>>>        //AB-StoreStart
50430>>>>>                                                                                                                
50430>>>>>                                                                                                                
50430>>>>>        //AB-StoreEnd
50430>>>>>
50430>>>>>    End_Object    // Baxio_Baxio_Status
50431>>>>>
50431>>>>>    Object Baxio_Baxio_Place is a dbFormSub
50433>>>>>
50433>>>>>        //AB-StoreTopStart
50433>>>>>                                                                                                                
50433>>>>>        Function Show_Place_Descr Returns String
50435>>>>>            Integer iValue iSrv iField iObj liStatusId
50436>>>>>            String sDesc sVal
50436>>>>>            If (Current_Record(Baxio_DD(Self))) Begin
50438>>>>>                Get Server of Baxio_Baxio_Place to iSrv
50439>>>>>                Get_FieldNumber Baxio.Baxio_Place to iField
50440>>>>>                Get Field_Current_Value of iSrv Field Baxio.Baxio_Place to sVal
50441>>>>>                Move Baxio_Baxio_Place_VT to iObj
50442>>>>>                If (iObj) get Find_Code_Description of iObj sVal to sDesc
50445>>>>>                Function_Return sDesc
50446>>>>>            End
50446>>>>>>
50446>>>>>        End_Function // Show_Place_Descr
50447>>>>>        
50447>>>>>        //AB-StoreTopEnd
50447>>>>>
50447>>>>>        Entry_Item (Show_Place_Descr(Self))
50448>>>>>        Set Size to 13 116
50449>>>>>        Set Location to 50 340
50450>>>>>        Set Label_Col_Offset to 50
50451>>>>>
50451>>>>>        //AB-StoreStart
50451>>>>>                                                                                                                
50451>>>>>                                                                                                                
50451>>>>>                                                                                                                
50451>>>>>                                                                                                                
50451>>>>>                                                                                                                
50451>>>>>                                                                                                                
50451>>>>>        //AB-StoreEnd
50451>>>>>
50451>>>>>    End_Object    // Baxio_Baxio_Place
50452>>>>>
50452>>>>>    Object dbTbDlgAxio is a dbTabDialogSub
50454>>>>>        Set Size to 191 507
50455>>>>>        Set Location to 70 2
50456>>>>>        Object TP_Additional is a dbTabPage
50458>>>>>            Set Label to "¨æ©Ÿœ«˜"
50459>>>>>            Object dbGrpObligate is a dbGroupSub
50461>>>>>                Set Label to "“§¦®¨œà« ¡á ‘«¦ ®œå˜"
50462>>>>>                Set Size to 60 492
50463>>>>>                Set Location to 3 4
50464>>>>>                Set TextColor to clNavy
50465>>>>>                Object Baxio_Baxio_Hmnial is a dbFormSub
50467>>>>>                    Entry_Item Baxio.Baxio_hmnial
50468>>>>>                    Set Size to 13 66
50469>>>>>                    Set Location to 10 82
50470>>>>>                    Set Label_Col_Offset to 70
50471>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
50472>>>>>                End_Object    // Baxio_Baxio_Hmnial
50473>>>>>
50473>>>>>                Object Baxio_Baxio_V4 is a dbFormSub
50475>>>>>                    Entry_Item Baxio.Baxio_v2
50476>>>>>                    Set Size to 13 66
50477>>>>>                    Set Location to 40 82
50478>>>>>                    Set Label_Col_Offset to 70
50479>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
50480>>>>>
50480>>>>>                    //AB-StoreStart
50480>>>>>                                                                                                                                                                                                                                                    
50480>>>>>                    //Set Points Item 0 to 0
50480>>>>>                    //Set Numeric_Mask Item 0 to 14  0 ' ,*'
50480>>>>>                    
50480>>>>>                    Procedure End_Construct_Object
50482>>>>>                        Integer iDecimals
50483>>>>>                        Forward Send End_Construct_Object
50485>>>>>                        Get fiDekadika_Nomismatos  SysCurXr.C_Code0  to    iDecimals
50486>>>>>                        Set Points Item 0 to iDecimals
50487>>>>>                        Set Numeric_Mask Item 0 to 14 iDecimals ' ,*'
50488>>>>>                    End_Procedure
50489>>>>>                    
50489>>>>>                    
50489>>>>>                    //AB-StoreEnd
50489>>>>>
50489>>>>>                End_Object    // Baxio_Baxio_V4
50490>>>>>
50490>>>>>                Object Rate0 is a dbFormSub
50492>>>>>                    Entry_Item Baxio.Baxio_rate0
50493>>>>>                    Set Size to 13 46
50494>>>>>                    Set Location to 11 440
50495>>>>>                    Set Label_Col_Offset to 35
50496>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
50497>>>>>
50497>>>>>                    //AB-StoreStart
50497>>>>>                                                                                                                                                                                                                                                    
50497>>>>>                    Set Points Item 0 to 0
50498>>>>>                    Set Visible_State to False
50499>>>>>                    Set Enabled_State to False
50500>>>>>                    
50500>>>>>                    
50500>>>>>                    
50500>>>>>                    //AB-StoreEnd
50500>>>>>
50500>>>>>                End_Object    // Rate0
50501>>>>>
50501>>>>>                Object Rate00 is a dbFormSub
50503>>>>>                    Entry_Item Baxio.Baxio_rate00
50504>>>>>                    Set Size to 13 46
50505>>>>>                    Set Location to 26 440
50506>>>>>                    Set Label_Col_Offset to 35
50507>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
50508>>>>>
50508>>>>>                    //AB-StoreStart
50508>>>>>                                                                                                                                                                                                                                                    
50508>>>>>                    Set Points Item 0 to 2
50509>>>>>                    Set Visible_State to False
50510>>>>>                    Set Enabled_State to False
50511>>>>>                    
50511>>>>>                    //AB-StoreEnd
50511>>>>>
50511>>>>>                End_Object    // Rate00
50512>>>>>
50512>>>>>                Object RateR is a dbFormSub
50514>>>>>                    Entry_Item Baxio.Baxio_rater
50515>>>>>                    Set Size to 13 46
50516>>>>>                    Set Location to 41 440
50517>>>>>                    Set Label_Col_Offset to 35
50518>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
50519>>>>>
50519>>>>>                    //AB-StoreStart
50519>>>>>                                                                                                                                                                                                                                                    
50519>>>>>                    Set Points Item 0 to 2
50520>>>>>                    Set Visible_State to False
50521>>>>>                    Set Enabled_State to False
50522>>>>>                    
50522>>>>>                    
50522>>>>>                    //AB-StoreEnd
50522>>>>>
50522>>>>>                End_Object    // RateR
50523>>>>>
50523>>>>>                Object TextBoxSub3 is a TextBoxSub
50525>>>>>                    Set Label to "†£/¤å˜ Šã¥žª"
50526>>>>>                    Set Location to 11 18
50527>>>>>                    Set Size to 10 57
50528>>>>>                End_Object    // TextBoxSub3
50529>>>>>
50529>>>>>                Object TextBoxSub4 is a TextBoxSub
50531>>>>>                    Set Label to "Œæ£ ©£˜"
50532>>>>>                    Set Location to 24 18
50533>>>>>                    Set Size to 10 32
50534>>>>>                End_Object    // TextBoxSub4
50535>>>>>
50535>>>>>                Object TextBoxSub5 is a TextBoxSub
50537>>>>>                    Set Label to "¦©æ"
50538>>>>>                    Set Location to 39 18
50539>>>>>                    Set Size to 10 32
50540>>>>>                End_Object    // TextBoxSub5
50541>>>>>
50541>>>>>                Object txtnom1 is a TextBoxSub
50543>>>>>                    Set Label to "ˆ©¦« £å˜1"
50544>>>>>                    Set Location to 13 405
50545>>>>>                    Set Size to 10 31
50546>>>>>
50546>>>>>                    //AB-StoreStart
50546>>>>>                    Set Visible_State to False
50547>>>>>                    
50547>>>>>                    //AB-StoreEnd
50547>>>>>
50547>>>>>                End_Object    // txtnom1
50548>>>>>
50548>>>>>                Object txtnom2 is a TextBoxSub
50550>>>>>                    Set Label to "ˆ©¦« £å˜2"
50551>>>>>                    Set Location to 28 405
50552>>>>>                    Set Size to 10 31
50553>>>>>
50553>>>>>                    //AB-StoreStart
50553>>>>>                    Set Visible_State to False
50554>>>>>                    
50554>>>>>                    //AB-StoreEnd
50554>>>>>
50554>>>>>                End_Object    // txtnom2
50555>>>>>
50555>>>>>                Object txtnom3 is a TextBoxSub
50557>>>>>                    Set Label to "ˆ©¦« £å˜3"
50558>>>>>                    Set Location to 43 405
50559>>>>>                    Set Size to 10 31
50560>>>>>
50560>>>>>                    //AB-StoreStart
50560>>>>>                    Set Visible_State to False
50561>>>>>                    
50561>>>>>                    //AB-StoreEnd
50561>>>>>
50561>>>>>                End_Object    // txtnom3
50562>>>>>
50562>>>>>                Object Baxio_Baxio_C_Code2 is a dbFormSub
50564>>>>>
50564>>>>>                    //AB-StoreTopStart
50564>>>>>                    //Procedure Set_The_Decimal_Points
50564>>>>>                    //    Integer iContID
50564>>>>>                    //    String  sCode sPartlRecr
50564>>>>>                    //    date    dHmnia
50564>>>>>                    
50564>>>>>                    //    Move (dbGrpObligate(TP_Additional(dbtbDlgAxio(Self)))) to iContID
50564>>>>>                    
50564>>>>>                    //    Get Field_Current_Value Of Baxio_DD Field Baxio.Baxio_Sc_Code2 to sCode
50564>>>>>                    //    Move (Trim(sCode))  to sCode
50564>>>>>                    
50564>>>>>                    //    Clear Nomisma
50564>>>>>                    //    Move sCode to Nomisma.Nomisma_Code
50564>>>>>                    //    Find eq Nomisma by Index.1
50564>>>>>                    //    Set Points          Of (Axia(iContID)) Item  0 to Nomisma.Dekadika
50564>>>>>                    //    Set Numeric_Mask    Of (Axia(iContID)) Item  0 to 12 Nomisma.Dekadika "*,"
50564>>>>>                    
50564>>>>>                    //    Get Label Of (TxtNom1(iContID)) Item 0 to sCode
50564>>>>>                    //    Move (Trim(sCode))  to sCode
50564>>>>>                    //    Clear Nomisma
50564>>>>>                    //    Move sCode to Nomisma.Nomisma_Code
50564>>>>>                    //    Find eq Nomisma by Index.1
50564>>>>>                    //    Set Points          Of (X0(iContID)) Item  0 to Nomisma.Dekadika
50564>>>>>                    //    Set Points          Of (P0(iContID)) Item  0 to Nomisma.Dekadika
50564>>>>>                    //    Set Numeric_Mask Of (X0(iContID))          Item  0  to 12 Nomisma.Dekadika "*,"
50564>>>>>                    //    Set Numeric_Mask Of (P0(iContID))          Item  0  to 12 Nomisma.Dekadika "*,"
50564>>>>>                    
50564>>>>>                    //    Get Label Of (TxtNom2(iContID)) Item 0 to sCode
50564>>>>>                    //    Move (Trim(sCode))  to sCode
50564>>>>>                    //    Clear Nomisma
50564>>>>>                    //    Move sCode to Nomisma.Nomisma_Code
50564>>>>>                    //    Find eq Nomisma by Index.1
50564>>>>>                    //    Set Points          Of (X00(iContID)) Item  0 to Nomisma.Dekadika
50564>>>>>                    //    Set Numeric_Mask Of (X00(iContID))         Item  0  to 12 Nomisma.Dekadika "*,"
50564>>>>>                    //    Set Points          Of (P00(iContID)) Item  0 to Nomisma.Dekadika
50564>>>>>                    //    Set Numeric_Mask Of (P00(iContID))         Item  0  to 12 Nomisma.Dekadika "*,"
50564>>>>>                    
50564>>>>>                    //    Get Label Of (TxtNom3(iContID)) Item 0 to sCode
50564>>>>>                    //    Move (Trim(sCode))  to sCode
50564>>>>>                    //    Clear Nomisma
50564>>>>>                    //    Move sCode to Nomisma.Nomisma_Code
50564>>>>>                    //    Find eq Nomisma by Index.1
50564>>>>>                    //    Set Points          Of (X1(iContID)) Item  0 to     Nomisma.Dekadika
50564>>>>>                    //    Set Numeric_Mask Of (X1(iContID))    Item  0 to 12  Nomisma.Dekadika "*,"
50564>>>>>                    //    Set Points          Of (P1(iContID)) Item  0 to     Nomisma.Dekadika
50564>>>>>                    //    Set Numeric_Mask Of (P1(iContID))    Item  0 to 12  Nomisma.Dekadika "*,"
50564>>>>>                    //End_procedure
50564>>>>>                    
50564>>>>>                    
50564>>>>>                    //AB-StoreTopEnd
50564>>>>>
50564>>>>>                    Entry_Item Baxio.Baxio_c_code2
50565>>>>>                    Set Size to 13 66
50566>>>>>                    Set Location to 25 82
50567>>>>>                    Set Label_Col_Offset to 2
50568>>>>>                    Set Label_Justification_Mode to jMode_Right
50569>>>>>                    Set Prompt_Button_Mode to pb_PromptOff
50570>>>>>
50570>>>>>                    //AB-StoreStart
50570>>>>>                                                                                                                                                                                                                                                    
50570>>>>>                    //Procedure OnChange
50570>>>>>                    //    Send Set_The_Decimal_Points
50570>>>>>                    //End_Procedure
50570>>>>>                    
50570>>>>>                    
50570>>>>>                    //AB-StoreEnd
50570>>>>>
50570>>>>>                End_Object    // Baxio_Baxio_C_Code2
50571>>>>>
50571>>>>>            End_Object    // dbGrpObligate
50572>>>>>
50572>>>>>            Object dbGrpOptional is a dbGroupSub
50574>>>>>                Set Label to "¨¦˜ ¨œ« ¡á ‘«¦ ®œå˜"
50575>>>>>                Set Size to 106 492
50576>>>>>                Set Location to 65 4
50577>>>>>                Set TextColor to clNavy
50578>>>>>                Object Baxio_Baxio_Ekdoths is a dbFormSub
50580>>>>>                    Entry_Item Baxio.Baxio_ekdoths
50581>>>>>                    Set Size to 13 126
50582>>>>>                    Set Location to 10 81
50583>>>>>                    Set Label_Col_Offset to 70
50584>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
50585>>>>>                End_Object    // Baxio_Baxio_Ekdoths
50586>>>>>
50586>>>>>                Object Baxio_Baxio_Ekdothse is a dbFormSub
50588>>>>>                    Entry_Item Baxio.Baxio_ekdothse
50589>>>>>                    Set Size to 13 208
50590>>>>>                    Set Location to 10 264
50591>>>>>                    Set Label_Col_Offset to 35
50592>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
50593>>>>>                End_Object    // Baxio_Baxio_Ekdothse
50594>>>>>
50594>>>>>                Object Baxio_Baxio_Sediatagh is a dbFormSub
50596>>>>>                    Entry_Item Baxio.Baxio_sediatagh
50597>>>>>                    Set Size to 13 126
50598>>>>>                    Set Location to 26 81
50599>>>>>                    Set Label_Col_Offset to 70
50600>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
50601>>>>>                End_Object    // Baxio_Baxio_Sediatagh
50602>>>>>
50602>>>>>                Object Baxio_Baxio_Sdiataghe is a dbFormSub
50604>>>>>                    Entry_Item Baxio.Baxio_sdiataghe
50605>>>>>                    Set Size to 13 208
50606>>>>>                    Set Location to 26 264
50607>>>>>                    Set Label_Col_Offset to 35
50608>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
50609>>>>>                End_Object    // Baxio_Baxio_Sdiataghe
50610>>>>>
50610>>>>>                Object Baxio_Baxio_Banka is a dbComboFormSub
50612>>>>>                    Entry_Item Baxio.Baxio_banka
50613>>>>>                    Set Size to 13 126
50614>>>>>                    Set Location to 40 81
50615>>>>>                    Set Label_Col_Offset to 70
50616>>>>>                End_Object    // Baxio_Baxio_Banka
50617>>>>>
50617>>>>>                Object Baxio_Baxio_No is a dbFormSub
50619>>>>>                    Entry_Item Baxio.Baxio_no
50620>>>>>                    Set Size to 13 126
50621>>>>>                    Set Location to 55 81
50622>>>>>                    Set Label_Col_Offset to 70
50623>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
50624>>>>>                End_Object    // Baxio_Baxio_No
50625>>>>>
50625>>>>>                Object Baxio_Baxio_From is a dbComboFormSub
50627>>>>>                    Entry_Item Baxio.Baxio_from
50628>>>>>                    Set Size to 13 54
50629>>>>>                    Set Location to 70 81
50630>>>>>                    Set Label_Col_Offset to 2
50631>>>>>
50631>>>>>                    //AB-StoreStart
50631>>>>>                                                            
50631>>>>>                    Procedure Combo_Fill_List
50633>>>>>                        Send Combo_Add_Item  "ˆ›å¦¬" "0"
50634>>>>>                        Send Combo_Add_Item  "’¨å«¦¬" "1"
50635>>>>>                    End_Procedure
50636>>>>>                    
50636>>>>>                    
50636>>>>>                    
50636>>>>>                    
50636>>>>>                    
50636>>>>>                    
50636>>>>>                    //AB-StoreEnd
50636>>>>>
50636>>>>>                End_Object    // Baxio_Baxio_From
50637>>>>>
50637>>>>>                Object Baxio_Baxio_Topos is a dbComboFormSub
50639>>>>>                    Entry_Item Baxio.Baxio_topos
50640>>>>>                    Set Size to 13 54
50641>>>>>                    Set Location to 84 81
50642>>>>>                    Set Label_Col_Offset to 2
50643>>>>>
50643>>>>>                    //AB-StoreStart
50643>>>>>                    Procedure Combo_Fill_List
50645>>>>>                        Send Combo_Add_Item  "€«« ¡ãª" "0"
50646>>>>>                        Send Combo_Add_Item  "„§˜¨®å˜ª" "1"
50647>>>>>                    End_Procedure
50648>>>>>                    
50648>>>>>                    
50648>>>>>                    
50648>>>>>                    
50648>>>>>                    
50648>>>>>                    
50648>>>>>                    //AB-StoreEnd
50648>>>>>
50648>>>>>                End_Object    // Baxio_Baxio_Topos
50649>>>>>
50649>>>>>                Object Baxio_Baxio_Opistho is a dbEditSub
50651>>>>>                    Entry_Item Baxio.Baxio_opistho
50652>>>>>                    Set Size to 48 211
50653>>>>>                    Set Location to 50 263
50654>>>>>                End_Object    // Baxio_Baxio_Opistho
50655>>>>>
50655>>>>>                Object TextBoxSub6 is a TextBoxSub
50657>>>>>                    Set Label to "€¨® ¡æª „¡›æ«žª:"
50658>>>>>                    Set Location to 11 10
50659>>>>>                    Set Size to 10 63
50660>>>>>                End_Object    // TextBoxSub6
50661>>>>>
50661>>>>>                Object TextBoxSub7 is a TextBoxSub
50663>>>>>                    Set Label to "‘œ ƒ ˜«˜šã:"
50664>>>>>                    Set Location to 25 10
50665>>>>>                    Set Size to 10 56
50666>>>>>                End_Object    // TextBoxSub7
50667>>>>>
50667>>>>>                Object TextBoxSub8 is a TextBoxSub
50669>>>>>                    Set Label to "’¨á§œ˜"
50670>>>>>                    Set Location to 40 10
50671>>>>>                    Set Size to 10 35
50672>>>>>                End_Object    // TextBoxSub8
50673>>>>>
50673>>>>>                Object TextBoxSub9 is a TextBoxSub
50675>>>>>                    Set Label to "€¨ Ÿ£æª"
50676>>>>>                    Set Location to 55 10
50677>>>>>                    Set Size to 10 47
50678>>>>>                End_Object    // TextBoxSub9
50679>>>>>
50679>>>>>                Object TextBoxSub10 is a TextBoxSub
50681>>>>>                    Set Label to "„§à¤¬£å˜"
50682>>>>>                    Set Location to 12 224
50683>>>>>                    Set Size to 10 36
50684>>>>>                End_Object    // TextBoxSub10
50685>>>>>
50685>>>>>                Object TextBoxSub11 is a TextBoxSub
50687>>>>>                    Set Label to "„§à¤¬£å˜"
50688>>>>>                    Set Location to 28 224
50689>>>>>                    Set Size to 10 36
50690>>>>>                End_Object    // TextBoxSub11
50691>>>>>
50691>>>>>                Object TextBoxSub12 is a TextBoxSub
50693>>>>>                    Set Label to "Š¦ §¦å Ž§ ©Ÿ¦š¨á­¦ "
50694>>>>>                    Set Location to 41 265
50695>>>>>                    Set Size to 10 79
50696>>>>>                End_Object    // TextBoxSub12
50697>>>>>
50697>>>>>                Object Textbox3 is a Textbox
50699>>>>>                    Set Label to "ˆ›å¦¬/’¨å«¦¬"
50700>>>>>                    Set Location to 71 10
50701>>>>>                    Set Size to 10 46
50702>>>>>                End_Object    // Textbox3
50703>>>>>
50703>>>>>                Object Textbox4 is a Textbox
50705>>>>>                    Set Label to "€«« ¡ãª/„§˜¨®å˜ª"
50706>>>>>                    Set Location to 86 10
50707>>>>>                    Set Size to 10 63
50708>>>>>                End_Object    // Textbox4
50709>>>>>
50709>>>>>            End_Object    // dbGrpOptional
50710>>>>>
50710>>>>>
50710>>>>>            //AB-StoreStart
50710>>>>>            set label to "‘«â¢œ®¦ª/‘é£˜ €¥ ¦š¨á­¦¬"
50711>>>>>            
50711>>>>>            //AB-StoreEnd
50711>>>>>
50711>>>>>        End_Object    // TP_Additional
50712>>>>>
50712>>>>>        Object TP_Status is a dbTabPage
50714>>>>>            Set Label to "‰˜«á©«˜©ž"
50715>>>>>            Object dbGrpEispraktea is a dbGroupSub
50717>>>>>                Set Label to "„ ©§¨˜¡«â˜"
50718>>>>>                Set Size to 44 493
50719>>>>>                Set Location to 4 3
50720>>>>>                Set TextColor to clNavy
50721>>>>>                Object Baxio_Baxio_Fbarticl is a dbFormSub
50723>>>>>
50723>>>>>                    //AB-StoreTopStart
50723>>>>>                    Procedure Find_Barticls
50725>>>>>                        Integer liBarticlRec0 liWhichBarticl
50726>>>>>                        Date ldHmnia
50726>>>>>                        String liNo liBtypkin
50726>>>>>                    
50726>>>>>                        Move Barticl.Barticl_Rec0 to liBarticlRec0
50727>>>>>                    
50727>>>>>                        Get Field_Current_Value of Baxio_DD Field Baxio.Baxio_Fpar_In to liWhichBarticl
50728>>>>>                        If (liWhichBarticl <> 0) Begin
50730>>>>>                            Clear Barticl
50731>>>>>                            Move liWhichBarticl to Barticl.Barticl_Rec0
50732>>>>>                            Find eq Barticl by Index.2
50733>>>>>>
50733>>>>>                            [Found] Begin
50735>>>>>>
50735>>>>>                                Move Barticl.Barticl_Hmnia   to ldHmnia
50736>>>>>                                Move Barticl.Barticl_No      to liNo
50737>>>>>                                Move Barticl.Btypkin_Code    to liBtypkin
50738>>>>>                            End
50738>>>>>>
50738>>>>>                        End
50738>>>>>>
50738>>>>>                        Set Value of dbfrmHmnia   Item 0 to ldHmnia
50739>>>>>                        Set Value of dbfrmNo      Item 0 to liNo
50740>>>>>                        Set Value of dbfrmGtypkin Item 0 to liBtypkin
50741>>>>>                    
50741>>>>>                        Move "" to ldHmnia
50742>>>>>                        Move "" to liNo
50743>>>>>                        Move "" to liBtypkin
50744>>>>>                    
50744>>>>>                        Get Field_Current_Value of Baxio_DD Field Baxio.Baxio_Fpar_Out to liWhichBarticl
50745>>>>>                        If (liWhichBarticl <> 0) Begin
50747>>>>>                            Clear Barticl
50748>>>>>                            Move liWhichBarticl to Barticl.Barticl_Rec0
50749>>>>>                            Find eq Barticl by Index.2
50750>>>>>>
50750>>>>>                            [Found] Begin
50752>>>>>>
50752>>>>>                                Move Barticl.Barticl_Hmnia   to ldHmnia
50753>>>>>                                Move Barticl.Barticl_No      to liNo
50754>>>>>                                Move Barticl.Btypkin_Code    to liBtypkin
50755>>>>>                            End
50755>>>>>>
50755>>>>>                        End
50755>>>>>>
50755>>>>>                        Set Value of (dbfrmHmnia(dbGrpPlhrotea(Self)))   Item 0 to ldHmnia
50756>>>>>                        Set Value of (dbfrmNo(dbGrpPlhrotea(Self)))      Item 0 to liNo
50757>>>>>                        Set Value of (dbfrmGtypkin(dbGrpPlhrotea(Self))) Item 0 to liBtypkin
50758>>>>>                    
50758>>>>>                        Move "" to ldHmnia
50759>>>>>                        Move "" to liNo
50760>>>>>                        Move "" to liBtypkin
50761>>>>>                    
50761>>>>>                        Get Field_Current_Value of Baxio_DD Field Baxio.Baxio_Lpar to liWhichBarticl
50762>>>>>                        If (liWhichBarticl <> 0) Begin
50764>>>>>                            Clear Barticl
50765>>>>>                            Move liWhichBarticl to Barticl.Barticl_Rec0
50766>>>>>                            Find eq Barticl by Index.2
50767>>>>>>
50767>>>>>                            [Found] Begin
50769>>>>>>
50769>>>>>                                Move Barticl.Barticl_Hmnia   to ldHmnia
50770>>>>>                                Move Barticl.Barticl_No      to liNo
50771>>>>>                                Move Barticl.Btypkin_Code    to liBtypkin
50772>>>>>                            End
50772>>>>>>
50772>>>>>                        End
50772>>>>>>
50772>>>>>                        Set Value of (dbfrmHmnia(dbGrpCurrentStat(Self)))   Item 0 to ldHmnia
50773>>>>>                        Set Value of (dbfrmNo(dbGrpCurrentStat(Self)))      Item 0 to liNo
50774>>>>>                        Set Value of (dbfrmGtypkin(dbGrpCurrentStat(Self))) Item 0 to liBtypkin
50775>>>>>                    
50775>>>>>                        Clear Barticl
50776>>>>>                        Move liBarticlRec0 to Barticl.Barticl_Rec0
50777>>>>>                        Find eq Barticl by Index.2
50778>>>>>>
50778>>>>>                    End_Procedure
50779>>>>>                    
50779>>>>>                    //AB-StoreTopEnd
50779>>>>>
50779>>>>>                    Entry_Item Baxio.Baxio_fpar_in
50780>>>>>                    Set Size to 13 90
50781>>>>>                    Set Location to 10 109
50782>>>>>                    Set Label_Col_Offset to 90
50783>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
50784>>>>>
50784>>>>>                    //AB-StoreStart
50784>>>>>                                                                                                                                                                                                                                                    
50784>>>>>                    Procedure Refresh Integer iMode
50786>>>>>                        Forward Send Refresh iMode
50788>>>>>                        Send Find_Barticls
50789>>>>>                    End_Procedure // Refresh
50790>>>>>                    
50790>>>>>                    
50790>>>>>                    
50790>>>>>                    
50790>>>>>                    
50790>>>>>                    //AB-StoreEnd
50790>>>>>
50790>>>>>                End_Object    // Baxio_Baxio_Fbarticl
50791>>>>>
50791>>>>>                Object Baxio_Baxio_Code_In is a dbFormSub
50793>>>>>                    Entry_Item Baxio.Baxio_code_in
50794>>>>>                    Set Size to 13 126
50795>>>>>                    Set Location to 24 109
50796>>>>>                    Set Label_Col_Offset to 90
50797>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
50798>>>>>                End_Object    // Baxio_Baxio_Code_In
50799>>>>>
50799>>>>>                Object Baxio_Baxio_Epon_In is a dbFormSub
50801>>>>>                    Entry_Item Baxio.Baxio_epon_in
50802>>>>>                    Set Size to 13 192
50803>>>>>                    Set Location to 24 283
50804>>>>>                    Set Color to clBtnFace
50805>>>>>                    Set Label_Col_Offset to 40
50806>>>>>                    Set Enabled_State to FALSE
50807>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
50808>>>>>                    Set Item_Shadow_State Item 0 to TRUE
50809>>>>>                    Set Shadow_State Item 0 to TRUE
50810>>>>>                End_Object    // Baxio_Baxio_Epon_In
50811>>>>>
50811>>>>>                Object dbFrmHmnia is a dbFormSub
50813>>>>>                    Set Size to 13 65
50814>>>>>                    Set Location to 10 231
50815>>>>>                    Set Color to clBtnFace
50816>>>>>                    Set Label_Col_Offset to 2
50817>>>>>                    Set Label_Justification_Mode to jMode_Right
50818>>>>>                    Set Enabled_State to FALSE
50819>>>>>                    Set Item_Shadow_State Item 0 to TRUE
50820>>>>>                    Set Shadow_State Item 0 to TRUE
50821>>>>>                End_Object    // dbFrmHmnia
50822>>>>>
50822>>>>>                Object dbFrmNo is a dbFormSub
50824>>>>>                    Set Size to 13 65
50825>>>>>                    Set Location to 10 318
50826>>>>>                    Set Color to clBtnFace
50827>>>>>                    Set Label_Col_Offset to 2
50828>>>>>                    Set Label_Justification_Mode to jMode_Right
50829>>>>>                    Set Enabled_State to FALSE
50830>>>>>                    Set Item_Shadow_State Item 0 to TRUE
50831>>>>>                    Set Shadow_State Item 0 to TRUE
50832>>>>>                End_Object    // dbFrmNo
50833>>>>>
50833>>>>>                Object dbFrmGtypkin is a dbFormSub
50835>>>>>                    Set Label to "‰å¤ž©ž"
50836>>>>>                    Set Size to 13 57
50837>>>>>                    Set Location to 10 418
50838>>>>>                    Set Color to clBtnFace
50839>>>>>                    Set Label_Col_Offset to 2
50840>>>>>                    Set Label_Justification_Mode to jMode_Right
50841>>>>>                    Set Enabled_State to FALSE
50842>>>>>                    Set Item_Shadow_State Item 0 to TRUE
50843>>>>>                    Set Shadow_State Item 0 to TRUE
50844>>>>>                End_Object    // dbFrmGtypkin
50845>>>>>
50845>>>>>                Object TextBoxSub18 is a TextBoxSub
50847>>>>>                    Set Label to "˜¨/¡æ ˜¨˜¢˜™ãª:"
50848>>>>>                    Set Location to 12 18
50849>>>>>                    Set Size to 10 69
50850>>>>>                End_Object    // TextBoxSub18
50851>>>>>
50851>>>>>                Object TextBoxSub19 is a TextBoxSub
50853>>>>>                    Set Label to "˜¨˜¢ã­Ÿž¡œ ˜§æ:"
50854>>>>>                    Set Location to 25 18
50855>>>>>                    Set Size to 10 67
50856>>>>>                End_Object    // TextBoxSub19
50857>>>>>
50857>>>>>                Object TextBoxSub24 is a TextBoxSub
50859>>>>>                    Set Label to "†£-¤å˜"
50860>>>>>                    Set Location to 12 201
50861>>>>>                    Set Size to 10 26
50862>>>>>                End_Object    // TextBoxSub24
50863>>>>>
50863>>>>>                Object TextBoxSub27 is a TextBoxSub
50865>>>>>                    Set Label to "„§à¤¬£å˜"
50866>>>>>                    Set Location to 26 239
50867>>>>>                    Set Size to 10 39
50868>>>>>                End_Object    // TextBoxSub27
50869>>>>>
50869>>>>>                Object TextBoxSub30 is a TextBoxSub
50871>>>>>                    Set Label to "Œ¦:"
50872>>>>>                    Set Location to 11 298
50873>>>>>                    Set Size to 10 15
50874>>>>>                End_Object    // TextBoxSub30
50875>>>>>
50875>>>>>            End_Object    // dbGrpEispraktea
50876>>>>>
50876>>>>>            Object dbGrpPlhrotea is a dbGroupSub
50878>>>>>                Set Label to "„ ©§¨˜¡«â˜/¢ž¨à«â˜"
50879>>>>>                Set Size to 44 493
50880>>>>>                Set Location to 51 3
50881>>>>>                Set TextColor to clNavy
50882>>>>>                Object Baxio_Baxio_Lbarticl is a dbFormSub
50884>>>>>                    Entry_Item Baxio.Baxio_fpar_out
50885>>>>>                    Set Size to 13 90
50886>>>>>                    Set Location to 10 109
50887>>>>>                    Set Label_Col_Offset to 90
50888>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
50889>>>>>                End_Object    // Baxio_Baxio_Lbarticl
50890>>>>>
50890>>>>>                Object Baxio_Baxio_Code_Out is a dbFormSub
50892>>>>>                    Entry_Item Baxio.Baxio_code_out
50893>>>>>                    Set Size to 13 126
50894>>>>>                    Set Location to 25 109
50895>>>>>                    Set Label_Col_Offset to 90
50896>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
50897>>>>>                End_Object    // Baxio_Baxio_Code_Out
50898>>>>>
50898>>>>>                Object Baxio_Baxio_Epon_Out is a dbFormSub
50900>>>>>                    Entry_Item Baxio.Baxio_epon_out
50901>>>>>                    Set Size to 13 192
50902>>>>>                    Set Location to 25 283
50903>>>>>                    Set Color to clBtnFace
50904>>>>>                    Set Label_Col_Offset to 40
50905>>>>>                    Set Enabled_State to FALSE
50906>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
50907>>>>>                    Set Item_Shadow_State Item 0 to TRUE
50908>>>>>                    Set Shadow_State Item 0 to TRUE
50909>>>>>                End_Object    // Baxio_Baxio_Epon_Out
50910>>>>>
50910>>>>>                Object dbFrmHmnia is a dbFormSub
50912>>>>>                    Set Size to 13 65
50913>>>>>                    Set Location to 10 231
50914>>>>>                    Set Color to clBtnFace
50915>>>>>                    Set Label_Col_Offset to 2
50916>>>>>                    Set Label_Justification_Mode to jMode_Right
50917>>>>>                    Set Enabled_State to FALSE
50918>>>>>                    Set Item_Shadow_State Item 0 to TRUE
50919>>>>>                    Set Shadow_State Item 0 to TRUE
50920>>>>>                End_Object    // dbFrmHmnia
50921>>>>>
50921>>>>>                Object dbFrmNo is a dbFormSub
50923>>>>>                    Set Size to 13 65
50924>>>>>                    Set Location to 10 318
50925>>>>>                    Set Color to clBtnFace
50926>>>>>                    Set Label_Col_Offset to 2
50927>>>>>                    Set Label_Justification_Mode to jMode_Right
50928>>>>>                    Set Enabled_State to FALSE
50929>>>>>                    Set Item_Shadow_State Item 0 to TRUE
50930>>>>>                    Set Shadow_State Item 0 to TRUE
50931>>>>>                End_Object    // dbFrmNo
50932>>>>>
50932>>>>>                Object dbFrmGtypkin is a dbFormSub
50934>>>>>                    Set Label to "‰å¤ž©ž"
50935>>>>>                    Set Size to 13 57
50936>>>>>                    Set Location to 10 418
50937>>>>>                    Set Color to clBtnFace
50938>>>>>                    Set Label_Col_Offset to 2
50939>>>>>                    Set Label_Justification_Mode to jMode_Right
50940>>>>>                    Set Enabled_State to FALSE
50941>>>>>                    Set Item_Shadow_State Item 0 to TRUE
50942>>>>>                    Set Shadow_State Item 0 to TRUE
50943>>>>>                End_Object    // dbFrmGtypkin
50944>>>>>
50944>>>>>                Object TextBoxSub20 is a TextBoxSub
50946>>>>>                    Set Label to "˜¨/¡æ ˜¨á›¦©žª:"
50947>>>>>                    Set Location to 10 19
50948>>>>>                    Set Size to 10 71
50949>>>>>                End_Object    // TextBoxSub20
50950>>>>>
50950>>>>>                Object TextBoxSub21 is a TextBoxSub
50952>>>>>                    Set Label to "¨é«¦ª ˜¨˜¢ã§«žª:"
50953>>>>>                    Set Location to 24 19
50954>>>>>                    Set Size to 10 78
50955>>>>>                End_Object    // TextBoxSub21
50956>>>>>
50956>>>>>                Object TextBoxSub25 is a TextBoxSub
50958>>>>>                    Set Label to "†£-¤å˜"
50959>>>>>                    Set Location to 10 201
50960>>>>>                    Set Size to 10 26
50961>>>>>                End_Object    // TextBoxSub25
50962>>>>>
50962>>>>>                Object TextBoxSub28 is a TextBoxSub
50964>>>>>                    Set Label to "„§à¤¬£å˜"
50965>>>>>                    Set Location to 27 237
50966>>>>>                    Set Size to 10 41
50967>>>>>                End_Object    // TextBoxSub28
50968>>>>>
50968>>>>>                Object TextBoxSub31 is a TextBoxSub
50970>>>>>                    Set Label to "Œ¦:"
50971>>>>>                    Set Location to 12 298
50972>>>>>                    Set Size to 9 15
50973>>>>>                End_Object    // TextBoxSub31
50974>>>>>
50974>>>>>            End_Object    // dbGrpPlhrotea
50975>>>>>
50975>>>>>            Object dbGrpCurrentStat is a dbGroupSub
50977>>>>>                Set Label to "’¨â®¦¬©˜ ‰˜«á©«˜©ž"
50978>>>>>                Set Size to 44 493
50979>>>>>                Set Location to 98 3
50980>>>>>                Set TextColor to clNavy
50981>>>>>                Object Baxio_Baxio_Lcode is a dbFormSub
50983>>>>>                    Entry_Item Baxio.Baxio_lcode
50984>>>>>                    Set Size to 13 126
50985>>>>>                    Set Location to 24 109
50986>>>>>                    Set Label_Col_Offset to 90
50987>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
50988>>>>>                End_Object    // Baxio_Baxio_Lcode
50989>>>>>
50989>>>>>                Object Baxio_Baxio_Lepon is a dbFormSub
50991>>>>>                    Entry_Item Baxio.Baxio_lepon
50992>>>>>                    Set Size to 13 192
50993>>>>>                    Set Location to 24 283
50994>>>>>                    Set Color to clBtnFace
50995>>>>>                    Set Label_Col_Offset to 40
50996>>>>>                    Set Enabled_State to FALSE
50997>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
50998>>>>>                    Set Item_Shadow_State Item 0 to TRUE
50999>>>>>                    Set Shadow_State Item 0 to TRUE
51000>>>>>                End_Object    // Baxio_Baxio_Lepon
51001>>>>>
51001>>>>>                Object Baxio_Baxio_Lpar is a dbFormSub
51003>>>>>                    Entry_Item Baxio.Baxio_lpar
51004>>>>>                    Set Size to 13 90
51005>>>>>                    Set Location to 9 109
51006>>>>>                    Set Label_Col_Offset to 90
51007>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
51008>>>>>                End_Object    // Baxio_Baxio_Lpar
51009>>>>>
51009>>>>>                Object dbFrmHmnia is a dbFormSub
51011>>>>>                    Set Size to 13 65
51012>>>>>                    Set Location to 10 231
51013>>>>>                    Set Color to clBtnFace
51014>>>>>                    Set Label_Col_Offset to 2
51015>>>>>                    Set Label_Justification_Mode to jMode_Right
51016>>>>>                    Set Enabled_State to FALSE
51017>>>>>                    Set Item_Shadow_State Item 0 to TRUE
51018>>>>>                    Set Shadow_State Item 0 to TRUE
51019>>>>>                End_Object    // dbFrmHmnia
51020>>>>>
51020>>>>>                Object dbFrmNo is a dbFormSub
51022>>>>>                    Set Size to 13 65
51023>>>>>                    Set Location to 10 318
51024>>>>>                    Set Color to clBtnFace
51025>>>>>                    Set Label_Col_Offset to 2
51026>>>>>                    Set Label_Justification_Mode to jMode_Right
51027>>>>>                    Set Enabled_State to FALSE
51028>>>>>                    Set Item_Shadow_State Item 0 to TRUE
51029>>>>>                    Set Shadow_State Item 0 to TRUE
51030>>>>>                End_Object    // dbFrmNo
51031>>>>>
51031>>>>>                Object dbFrmGtypkin is a dbFormSub
51033>>>>>                    Set Label to "‰å¤ž©ž"
51034>>>>>                    Set Size to 13 57
51035>>>>>                    Set Location to 10 418
51036>>>>>                    Set Color to clBtnFace
51037>>>>>                    Set Label_Col_Offset to 2
51038>>>>>                    Set Label_Justification_Mode to jMode_Right
51039>>>>>                    Set Enabled_State to FALSE
51040>>>>>                    Set Item_Shadow_State Item 0 to TRUE
51041>>>>>                    Set Shadow_State Item 0 to TRUE
51042>>>>>                End_Object    // dbFrmGtypkin
51043>>>>>
51043>>>>>                Object TextBoxSub22 is a TextBoxSub
51045>>>>>                    Set Label to "’œ¢œ¬«˜å¦ ˜¨/¡æ:"
51046>>>>>                    Set Location to 11 13
51047>>>>>                    Set Size to 10 68
51048>>>>>                End_Object    // TextBoxSub22
51049>>>>>
51049>>>>>                Object TextBoxSub23 is a TextBoxSub
51051>>>>>                    Set Label to "’œ¢œ¬«˜å¦ª ˜¨˜¢ã§«žª:"
51052>>>>>                    Set Location to 24 13
51053>>>>>                    Set Size to 10 90
51054>>>>>                End_Object    // TextBoxSub23
51055>>>>>
51055>>>>>                Object TextBoxSub26 is a TextBoxSub
51057>>>>>                    Set Label to "†£-¤å˜"
51058>>>>>                    Set Location to 11 200
51059>>>>>                    Set Size to 10 27
51060>>>>>                End_Object    // TextBoxSub26
51061>>>>>
51061>>>>>                Object TextBoxSub29 is a TextBoxSub
51063>>>>>                    Set Label to "„§à¤¬£å˜"
51064>>>>>                    Set Location to 26 239
51065>>>>>                    Set Size to 10 40
51066>>>>>                End_Object    // TextBoxSub29
51067>>>>>
51067>>>>>                Object TextBoxSub32 is a TextBoxSub
51069>>>>>                    Set Label to "Œ¦:"
51070>>>>>                    Set Location to 11 297
51071>>>>>                    Set Size to 10 15
51072>>>>>                End_Object    // TextBoxSub32
51073>>>>>
51073>>>>>            End_Object    // dbGrpCurrentStat
51074>>>>>
51074>>>>>
51074>>>>>            //AB-StoreStart
51074>>>>>            set label to "Š¦ §á ‘«¦ ®œå˜"
51075>>>>>            
51075>>>>>            //AB-StoreEnd
51075>>>>>
51075>>>>>        End_Object    // TP_Status
51076>>>>>
51076>>>>>        Object TP_Bmove is a dbTabPage
51078>>>>>            Set Label to "‰å¤ž©ž"
51079>>>>>            Object grdBmove is a dbGridSub
51081>>>>>                Set Main_File to Bmove.File_Number
51082>>>>>                Set Server to (Bmove_DD(self))
51083>>>>>                Set Ordering to 4
51084>>>>>                Set Size to 159 489
51085>>>>>                Set Location to 7 5
51086>>>>>                Set Wrap_State to TRUE
51087>>>>>                Set Read_Only_State to TRUE
51088>>>>>
51088>>>>>                Begin_Row
51091>>>>>                    Entry_Item Btypkin.Btypkin_code
51092>>>>>                    Entry_Item Btypkin.Btypkin_descr
51093>>>>>                    Entry_Item Barticl.Barticl_hmnia
51094>>>>>                    Entry_Item Barticl.Barticl_no
51095>>>>>                    Entry_Item Barticl.Barticl_code1
51096>>>>>                    Entry_Item Barticl.Barticl_code2
51097>>>>>                End_Row
51102>>>>>
51102>>>>>                Set Form_Width    item 0 to 38
51103>>>>>                Set Header_Label  item 0 to "‰å¤ž©ž"
51104>>>>>                
51104>>>>>                Set Form_Width    item 1 to 197
51105>>>>>                Set Header_Label  item 1 to "œ¨ š¨˜­ã"
51106>>>>>                
51106>>>>>                Set Form_Width    item 2 to 45
51107>>>>>                Set Header_Label  item 2 to "†£-¤å˜"
51108>>>>>                
51108>>>>>                Set Form_Width    item 3 to 45
51109>>>>>                Set Header_Label  item 3 to "€¨ Ÿ£æª"
51110>>>>>                
51110>>>>>                Set Form_Width    item 4 to 82
51111>>>>>                Set Header_Label  item 4 to "‘¬¤˜¢¢˜©©æ£œ¤¦ª"
51112>>>>>                
51112>>>>>                Set Form_Width    item 5 to 76
51113>>>>>                Set Header_Label  item 5 to "˜¨˜¢ã§«žª"
51114>>>>>                
51114>>>>>
51114>>>>>                //AB-StoreStart
51114>>>>>                                                                                                                                                                                                        
51114>>>>>                Procedure Set Col_Entry_State Integer iItem Integer iState
51116>>>>>                    Integer liPrototype
51117>>>>>                    Get Prototype_Object to liPrototype
51118>>>>>                    Set Entry_State of liPrototype Item iItem to iState
51119>>>>>                End_Procedure // Col_Entry_State
51120>>>>>                
51120>>>>>                Set Col_Entry_State to 0 False
51121>>>>>                Set Col_Entry_State to 1 False
51122>>>>>                Set Col_Entry_State to 2 False
51123>>>>>                Set Col_Entry_State to 3 False
51124>>>>>                Set Col_Entry_State to 4 False
51125>>>>>                Set Col_Entry_State to 5 False
51126>>>>>                
51126>>>>>                Procedure Mouse_Up Integer aiWindow Integer iChar_Pos
51128>>>>>                End_Procedure // Mouse_Up
51129>>>>>                
51129>>>>>                Procedure Request_Clear_All
51131>>>>>                End_Procedure // Request_Clear_All
51132>>>>>                
51132>>>>>                
51132>>>>>                
51132>>>>>                
51132>>>>>                
51132>>>>>                
51132>>>>>                //AB-StoreEnd
51132>>>>>
51132>>>>>            End_Object    // grdBmove
51133>>>>>
51133>>>>>
51133>>>>>            //AB-StoreStart
51133>>>>>            set label to "‰ ¤ã©œ ª    "
51134>>>>>            //AB-StoreEnd
51134>>>>>
51134>>>>>        End_Object    // TP_Bmove
51135>>>>>
51135>>>>>    End_Object    // dbTbDlgAxio
51136>>>>>
51136>>>>>    Object dbGrpYear is a dbGroupSub
51138>>>>>        Set Size to 26 505
51139>>>>>        Set Location to 2 3
51140>>>>>        Object Company_Company_Name is a dbFormSub
51142>>>>>            Entry_Item Syscurxr.Company_name
51143>>>>>            Set Server to (Syscurxr_DD(self))
51144>>>>>            Set Size to 13 139
51145>>>>>            Set Location to 9 47
51146>>>>>            Set Color to clBtnFace
51147>>>>>            Set Label_Col_Offset to 2
51148>>>>>            Set Label_Justification_Mode to jMode_Right
51149>>>>>            Set Enabled_State to FALSE
51150>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
51151>>>>>            Set Item_Shadow_State Item 0 to TRUE
51152>>>>>            Set Shadow_State Item 0 to TRUE
51153>>>>>        End_Object    // Company_Company_Name
51154>>>>>
51154>>>>>        Object Branch_Branch_Name is a dbFormSub
51156>>>>>            Entry_Item Syscurxr.Branch_name
51157>>>>>            Set Server to (Syscurxr_DD(self))
51158>>>>>            Set Size to 13 141
51159>>>>>            Set Location to 9 241
51160>>>>>            Set Color to clBtnFace
51161>>>>>            Set Label_Col_Offset to 2
51162>>>>>            Set Label_Justification_Mode to jMode_Right
51163>>>>>            Set Enabled_State to FALSE
51164>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
51165>>>>>            Set Item_Shadow_State Item 0 to TRUE
51166>>>>>            Set Shadow_State Item 0 to TRUE
51167>>>>>        End_Object    // Branch_Branch_Name
51168>>>>>
51168>>>>>        Object Year_Year_Year is a dbFormSub
51170>>>>>            Entry_Item Syscurxr.Year_year
51171>>>>>            Set Server to (Syscurxr_DD(self))
51172>>>>>            Set Size to 13 61
51173>>>>>            Set Location to 9 440
51174>>>>>            Set Color to clBtnFace
51175>>>>>            Set Label_Col_Offset to 2
51176>>>>>            Set Label_Justification_Mode to jMode_Right
51177>>>>>            Set Enabled_State to FALSE
51178>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
51179>>>>>            Set Item_Shadow_State Item 0 to TRUE
51180>>>>>            Set Shadow_State Item 0 to TRUE
51181>>>>>
51181>>>>>            //AB-StoreStart
51181>>>>>                                                                                                                                                            
51181>>>>>                                                                                                                                                            
51181>>>>>                                                                                                                                                            
51181>>>>>            //AB-StoreEnd
51181>>>>>
51181>>>>>        End_Object    // Year_Year_Year
51182>>>>>
51182>>>>>        Object otxtCompany is a TextBoxSub
51184>>>>>            Set Label to "„«˜ ¨œå˜"
51185>>>>>            Set Auto_Size_State to FALSE
51186>>>>>            Set TextColor to clNavy
51187>>>>>            Set FontSize to 4 0
51188>>>>>            Set Location to 10 8
51189>>>>>            Set Size to 10 31
51190>>>>>            Set FontWeight to 800
51191>>>>>            Set Justification_Mode to jMode_Right
51192>>>>>            Set TypeFace to "MS Sans Serif"
51193>>>>>            Set Enabled_State to TRUE
51194>>>>>        End_Object    // otxtCompany
51195>>>>>
51195>>>>>        Object otxtBranch is a TextBoxSub
51197>>>>>            Set Label to "“§¦¡/£˜ :"
51198>>>>>            Set Auto_Size_State to FALSE
51199>>>>>            Set TextColor to clNavy
51200>>>>>            Set FontSize to 4 0
51201>>>>>            Set Location to 10 200
51202>>>>>            Set Size to 10 31
51203>>>>>            Set FontWeight to 800
51204>>>>>            Set Justification_Mode to jMode_Right
51205>>>>>            Set TypeFace to "MS Sans Serif"
51206>>>>>            Set Enabled_State to TRUE
51207>>>>>        End_Object    // otxtBranch
51208>>>>>
51208>>>>>        Object otxtYear is a TextBoxSub
51210>>>>>            Set Label to "•¨ã©ž :          "
51211>>>>>            Set Auto_Size_State to FALSE
51212>>>>>            Set TextColor to clNavy
51213>>>>>            Set FontSize to 4 0
51214>>>>>            Set Location to 10 408
51215>>>>>            Set Size to 10 24
51216>>>>>            Set FontWeight to 800
51217>>>>>            Set Justification_Mode to jMode_Right
51218>>>>>            Set TypeFace to "MS Sans Serif"
51219>>>>>            Set Enabled_State to TRUE
51220>>>>>        End_Object    // otxtYear
51221>>>>>
51221>>>>>    End_Object    // dbGrpYear
51222>>>>>
51222>>>>>    Object TextBoxSub1 is a TextBoxSub
51224>>>>>        Set Label to "„å›¦ª"
51225>>>>>        Set Location to 36 5
51226>>>>>        Set Size to 10 35
51227>>>>>    End_Object    // TextBoxSub1
51228>>>>>
51228>>>>>    Object TextBoxSub2 is a TextBoxSub
51230>>>>>        Set Label to "‰à› ¡æª"
51231>>>>>        Set Location to 49 5
51232>>>>>        Set Size to 10 33
51233>>>>>    End_Object    // TextBoxSub2
51234>>>>>
51234>>>>>    Object TextBoxSub13 is a TextBoxSub
51236>>>>>        Set Label to "‰˜«á©«˜©ž"
51237>>>>>        Set Location to 37 285
51238>>>>>        Set Size to 10 51
51239>>>>>    End_Object    // TextBoxSub13
51240>>>>>
51240>>>>>    Object TextBoxSub14 is a TextBoxSub
51242>>>>>        Set Label to "¨å©¡œ«˜ "
51243>>>>>        Set Location to 49 285
51244>>>>>        Set Size to 12 39
51245>>>>>    End_Object    // TextBoxSub14
51246>>>>>
51246>>>>>
51246>>>>>    //AB-StoreStart
51246>>>>>                                                                    
51246>>>>>                                                                    
51246>>>>>    //AB-StoreEnd
51246>>>>>
51246>>>>>End_Object    // VW037
51247>>>>>
51247>>>>>//AB/ End_Object    // prj
51247>>>Use sl100.sl
51247>>>Use sl036.sl
INCLUDING FILE: SL036.SL
51247>>>>>//AB/ Project SL036:BARTICL
51247>>>>>//AB/ Object prj is a Lookup_Project
51247>>>>>//AB/     Set ProjectName to "SL036:BARTICL"
51247>>>>>//AB/     Set ProjectFileName to "SL036.SL"
51247>>>>>
51247>>>>>// Project Object Structure
51247>>>>>//   SL036 is a dbModalPanelSub
51247>>>>>//     Btypkin_DD is a DataDictionary
51247>>>>>//     Barticl_DD is a DataDictionary
51247>>>>>//     oSelList is a dbListSub
51247>>>>>//     oOK_bn is a ButtonSub
51247>>>>>//     oCancel_bn is a ButtonSub
51247>>>>>//     oSearch_bn is a ButtonSub
51247>>>>>
51247>>>>>// Register all objects
51247>>>>>Register_Object Barticl_DD
51247>>>>>Register_Object Btypkin_DD
51247>>>>>Register_Object oCancel_bn
51247>>>>>Register_Object oOK_bn
51247>>>>>Register_Object oSearch_bn
51247>>>>>Register_Object oSelList
51247>>>>>Register_Object SL036
51247>>>>>
51247>>>>>
51247>>>>>//AB-IgnoreStart
51247>>>>>
51247>>>>>Use DFAllEnt.pkg
51247>>>>>Use dbList.Sub
51247>>>>>Use Button.Sub
51247>>>>>
51247>>>>>
51247>>>>>Use BTYPKIN.DD
51247>>>>>Use BARTICL.DD
51247>>>>>
51247>>>>>//AB-IgnoreEnd
51247>>>>>
51247>>>>>Object SL036 is a dbModalPanelSub
51249>>>>>
51249>>>>>    //AB-StoreTopStart
51249>>>>>    Property String     psClientID      Public ''
51251>>>>>    Property String     psEponymo       Public ''
51253>>>>>    Property Date       pdHmnia         Public ''
51255>>>>>    Property Integer    piTypkinCode    Public  0
51257>>>>>    
51257>>>>>    
51257>>>>>    //AB-StoreTopEnd
51257>>>>>
51257>>>>>    Set Label to "‰ ¤ã©œ ª  €¥ ¦š¨á­à¤"
51258>>>>>    Set Size to 288 522
51259>>>>>    Set Location to 6 3
51260>>>>>    Set Exit_Application_Local_State to FALSE
51261>>>>>    Set Modal_State to FALSE
51262>>>>>
51262>>>>>    //AB-DDOStart
51262>>>>>
51262>>>>>    Object Btypkin_DD is a Btypkin_DataDictionary
51264>>>>>    End_Object    // Btypkin_DD
51265>>>>>
51265>>>>>    Object Barticl_DD is a Barticl_DataDictionary
51267>>>>>        Set DDO_Server to (Btypkin_DD(self))
51268>>>>>
51268>>>>>        //AB-StoreStart
51268>>>>>        
51268>>>>>        Begin_Constraints
51270>>>>>            String  sClientID
51271>>>>>            Date    dHmnia
51271>>>>>            Integer iTypkinCode
51271>>>>>        
51271>>>>>            Get piTypkinCode    to iTypkinCode
51272>>>>>            Get psClientID      to sClientID
51273>>>>>            Get pdHmnia         to dHmnia
51274>>>>>        
51274>>>>>            Constrain Barticl.Company_Code  Eq Syscurxr.Company_Code
51276>>>>>            Constrain Barticl.Branch_Code   Eq Syscurxr.Branch_Code
51278>>>>>            Constrain Barticl.Year_Year     Eq Syscurxr.Year_Year
51280>>>>>        
51280>>>>>            If (sClientID  <> 0) Begin
51282>>>>>                If (iTypkinCode<> 0) Begin
51284>>>>>                    Set Ordering to 8
51285>>>>>                    Constrain Barticl.Btypkin_Code  Eq iTypkinCode
51287>>>>>                    Constrain Barticl.Barticl_Code1 Eq sClientID
51289>>>>>                End
51289>>>>>>
51289>>>>>                Else Begin
51290>>>>>                    Set Ordering to 10
51291>>>>>                    Constrain Barticl.Barticl_Code1 Eq sClientID
51293>>>>>                End
51293>>>>>>
51293>>>>>            End
51293>>>>>>
51293>>>>>            Else If (dHmnia     <>'') Begin
51296>>>>>                Set Ordering to 9
51297>>>>>                Constrain Barticl.Barticl_Hmnia Eq dHmnia
51299>>>>>            End
51299>>>>>>
51299>>>>>            Else If (iTypkinCode<> 0) Begin
51302>>>>>                Set Ordering to 1
51303>>>>>                Constrain Barticl.Btypkin_Code  Eq iTypkinCode
51305>>>>>            End
51305>>>>>>
51305>>>>>        End_Constraints
51308>>>>>        
51308>>>>>        //AB-StoreEnd
51308>>>>>
51308>>>>>    End_Object    // Barticl_DD
51309>>>>>
51309>>>>>    Set Main_DD to (Barticl_DD(self))
51310>>>>>    Set Server to (Barticl_DD(self))
51311>>>>>
51311>>>>>    //AB-DDOEnd
51311>>>>>
51311>>>>>    Object oSelList is a dbListSub
51313>>>>>        Set Main_File to Barticl.File_Number
51314>>>>>        Set Server to (Btypkin_DD(self))
51315>>>>>        Set Size to 238 508
51316>>>>>        Set Location to 4 5
51317>>>>>
51317>>>>>        Begin_Row
51320>>>>>            Entry_Item Barticl.Barticl_no
51321>>>>>            Entry_Item Barticl.Barticl_hmnia
51322>>>>>            Entry_Item Btypkin.Btypkin_code
51323>>>>>            Entry_Item Btypkin.Btypkin_descr
51324>>>>>            Entry_Item Barticl.Barticl_epon1
51325>>>>>            Entry_Item Barticl.Barticl_sv0
51326>>>>>        End_Row
51331>>>>>
51331>>>>>        Set Form_Width    item 0 to 84
51332>>>>>        Set Header_Label  item 0 to "€¨ Ÿ£æª"
51333>>>>>        
51333>>>>>        Set Form_Width    item 1 to 57
51334>>>>>        Set Header_Label  item 1 to "†£œ¨¦£ž¤å˜"
51335>>>>>        
51335>>>>>        Set Form_Width    item 2 to 41
51336>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž"
51337>>>>>        
51337>>>>>        Set Form_Width    item 3 to 157
51338>>>>>        Set Header_Label  item 3 to "œ¨ š¨˜­ã"
51339>>>>>        
51339>>>>>        Set Form_Width    item 4 to 102
51340>>>>>        Set Header_Label  item 4 to "‘¬¤˜¢¢˜©æ£œ¤¦ª"
51341>>>>>        
51341>>>>>        Set Form_Width    item 5 to 60
51342>>>>>        Set Header_Label  item 5 to "¦©æ"
51343>>>>>        
51343>>>>>
51343>>>>>        //AB-StoreStart
51343>>>>>                                                
51343>>>>>        Set Numeric_mask Item 5 to 14 0 ' ,*'
51344>>>>>        
51344>>>>>        Procedure Activating
51346>>>>>            Send Rebuild_Constraints    to Barticl_DD
51347>>>>>            Send Beginning_Of_Data      to oSelList True
51348>>>>>            Forward Send Activating
51350>>>>>        End_Procedure
51351>>>>>        
51351>>>>>        
51351>>>>>        
51351>>>>>        
51351>>>>>        
51351>>>>>        
51351>>>>>        //AB-StoreEnd
51351>>>>>
51351>>>>>    End_Object    // oSelList
51352>>>>>
51352>>>>>    Object oOK_bn is a ButtonSub
51354>>>>>        Set Label to "&„§ ¢¦šã"
51355>>>>>        Set Location to 255 354
51356>>>>>
51356>>>>>        //AB-StoreStart
51356>>>>>        Procedure OnClick
51358>>>>>            Send OK To oSelList
51359>>>>>        End_Procedure
51360>>>>>        //AB-StoreEnd
51360>>>>>
51360>>>>>    End_Object    // oOK_bn
51361>>>>>
51361>>>>>    Object oCancel_bn is a ButtonSub
51363>>>>>        Set Label to "&€¡ç¨à©ž"
51364>>>>>        Set Location to 255 410
51365>>>>>
51365>>>>>        //AB-StoreStart
51365>>>>>        Procedure OnClick
51367>>>>>            Send Cancel To oSelList
51368>>>>>        End_Procedure
51369>>>>>        //AB-StoreEnd
51369>>>>>
51369>>>>>    End_Object    // oCancel_bn
51370>>>>>
51370>>>>>    Object oSearch_bn is a ButtonSub
51372>>>>>        Set Label to "€&¤˜ã«ž©ž"
51373>>>>>        Set Location to 255 464
51374>>>>>
51374>>>>>        //AB-StoreStart
51374>>>>>        Procedure OnClick
51376>>>>>            Send Search To oSelList
51377>>>>>        End_Procedure
51378>>>>>        //AB-StoreEnd
51378>>>>>
51378>>>>>    End_Object    // oSearch_bn
51379>>>>>
51379>>>>>
51379>>>>>    //AB-StoreStart
51379>>>>>    On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
51380>>>>>    On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
51381>>>>>    On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
51382>>>>>    
51382>>>>>    
51382>>>>>    
51382>>>>>    
51382>>>>>    
51382>>>>>    
51382>>>>>    
51382>>>>>    
51382>>>>>    //AB-StoreEnd
51382>>>>>
51382>>>>>End_Object    // SL036
51383>>>>>
51383>>>>>//AB/ End_Object    // prj
51383>>>use r36.rv
INCLUDING FILE: R36.RV
51383>>>>>//AB/ Project R36:ektyposh barticl
51383>>>>>//AB/     Object prj is a Report_Project
51383>>>>>//AB/         Set ProjectName to "R36:ektyposh barticl"
51383>>>>>//AB/         Set ProjectFileName to "r36.rv"
51383>>>>>
51383>>>>>// Project Object Structure
51383>>>>>//   r36 is a ReportViewSub
51383>>>>>//     DestRadio is a RadioGroup
51383>>>>>//       WindowRadio is a Radio
51383>>>>>//       PrinterRadio is a Radio
51383>>>>>//     ButtonSub3 is a ButtonSub
51383>>>>>//     ButtonSub4 is a ButtonSub
51383>>>>>//     AXIO_BasicReport is a BasicReport
51383>>>>>//       Btypkin_DD is a Btypkin_DataDictionary
51383>>>>>//       Baxiokat_DD is a Baxiokat_DataDictionary
51383>>>>>//       Barticl_DD is a Barticl_DataDictionary
51383>>>>>//       Bsum_DD is a Bsum_DataDictionary
51383>>>>>//       Baxio_DD is a Baxio_DataDictionary
51383>>>>>//       Syscurxr_DD is a Syscurxr_DataDictionary
51383>>>>>//       Clients_DD is a Clients_DataDictionary
51383>>>>>//       Bmove_DD is a Bmove_DataDictionary
51383>>>>>
51383>>>>>// Register all objects
51383>>>>>Register_Object AXIO_BasicReport
51383>>>>>Register_Object Barticl_DD
51383>>>>>Register_Object Baxio_DD
51383>>>>>Register_Object Baxiokat_DD
51383>>>>>Register_Object Bmove_DD
51383>>>>>Register_Object Bsum_DD
51383>>>>>Register_Object Btypkin_DD
51383>>>>>Register_Object ButtonSub3
51383>>>>>Register_Object ButtonSub4
51383>>>>>Register_Object Clients_DD
51383>>>>>Register_Object DestRadio
51383>>>>>Register_Object PrinterRadio
51383>>>>>Register_Object r36
51383>>>>>Register_Object Syscurxr_DD
51383>>>>>Register_Object WindowRadio
51383>>>>>
51383>>>>>
51383>>>>>//AB/     Report View
51383>>>>>
51383>>>>>
51383>>>>>    //AB-StoreTopStart
51383>>>>>                                                        
51383>>>>>    Use dfallrpt.pkg
51383>>>>>    use btypkin.dd
51383>>>>>    use baxiokat.dd
51383>>>>>    Use barticl.dd
51383>>>>>    use bsum.dd
INCLUDING FILE: BSUM.DD
51383>>>>>>>//DDB-FileStart
51383>>>>>>>//DDB-HeaderStart
51383>>>>>>>
51383>>>>>>>// File Name : BSUM.DD
51383>>>>>>>// Class Name: Bsum_DataDictionary
51383>>>>>>>// Revision  : 11
51383>>>>>>>// Version   : 2
51383>>>>>>>
51383>>>>>>>Use  Windows           // Basic Definitions
51383>>>>>>>Use  DataDict          // DataDictionary Class Definition
51383>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51383>>>>>>>
51383>>>>>>>Open Bsum
51385>>>>>>>Open Barticl
51387>>>>>>>Open Sysrecb
51389>>>>>>>
51389>>>>>>>//DDB-HeaderEnd
51389>>>>>>>Class Bsum_DataDictionary  is a DataDictionary_Sec
51390>>>>>>>
51390>>>>>>>    // Creating:
51390>>>>>>>
51390>>>>>>>    Procedure Creating
51391>>>>>>>        Forward Send Creating
51393>>>>>>>        // Insert Code Here
51393>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Bsum.Bsum_Rec0)))))) to Bsum.Bsum_Recr
51394>>>>>>>    End_Procedure   // Creating
51395>>>>>>>
51395>>>>>>>
51395>>>>>>>    Procedure Define_Fields
51396>>>>>>>        Forward Send Define_Fields
51398>>>>>>>        //DDB-Generated-Code-Location
51398>>>>>>>        //DDB-DefineFieldStart
51398>>>>>>>
51398>>>>>>>        Set Main_File            To Bsum.File_Number
51399>>>>>>>        Set Cascade_Delete_State To FALSE
51400>>>>>>>
51400>>>>>>>
51400>>>>>>>        // Parent (Server) file structure...............
51400>>>>>>>        Send Add_Server_File  Barticl.File_Number
51401>>>>>>>
51401>>>>>>>        // External (System) file structure.............
51401>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
51402>>>>>>>
51402>>>>>>>        Define_Auto_Increment  Sysrecb.Bsum_Rec0  To Bsum.Bsum_Rec0
51405>>>>>>>
51405>>>>>>>        // Field-based properties.......................
51405>>>>>>>
51405>>>>>>>        // Bsum.Barticl_Recr
51405>>>>>>>
51405>>>>>>>        // Bsum.Baxiokat_Recr
51405>>>>>>>
51405>>>>>>>        // Bsum.Bsum_Sv2
51405>>>>>>>
51405>>>>>>>        // Bsum.Bsum_Sv0
51405>>>>>>>
51405>>>>>>>        // Bsum.Bsum_Sv00
51405>>>>>>>
51405>>>>>>>        // Bsum.Bsum_Svr
51405>>>>>>>
51405>>>>>>>        // Bsum.Gmove_Srec0
51405>>>>>>>
51405>>>>>>>        // Bsum.Bsum_Rec0
51405>>>>>>>
51405>>>>>>>        // Bsum.Bsum_Recr
51405>>>>>>>
51405>>>>>>>        //DDB-DefineFieldEnd
51405>>>>>>>
51405>>>>>>>        Set Main_File            To Bsum.File_Number
51406>>>>>>>
51406>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
51407>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
51408>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51409>>>>>>>
51409>>>>>>>        // Parent (Server) file structure...............
51409>>>>>>>        Send Add_Server_File  Barticl.File_Number
51410>>>>>>>
51410>>>>>>>        // Field-based properties.......................
51410>>>>>>>
51410>>>>>>>        // Bsum.Barticl_Rec0
51410>>>>>>>
51410>>>>>>>        // Bsum.Baxiokat_Rec0
51410>>>>>>>
51410>>>>>>>        // Bsum.Bsum_Sv2
51410>>>>>>>
51410>>>>>>>        // Bsum.Bsum_Sv0
51410>>>>>>>
51410>>>>>>>        // Bsum.Bsum_Sv00
51410>>>>>>>
51410>>>>>>>        // Bsum.Bsum_Svr
51410>>>>>>>
51410>>>>>>>        // Bsum.Gmove_Srec0
51410>>>>>>>
51410>>>>>>>    End_Procedure    // Define_Fields
51411>>>>>>>
51411>>>>>>>
51411>>>>>>>    Procedure Field_Defaults
51412>>>>>>>        Forward Send Field_Defaults
51414>>>>>>>        //DDB-Generated-Code-Location
51414>>>>>>>        //DDB-FieldDefaultStart
51414>>>>>>>        //DDB-FieldDefaultEnd
51414>>>>>>>    End_Procedure    // Field_Defaults
51415>>>>>>>
51415>>>>>>>End_Class    // Bsum_DataDictionary
51416>>>>>>>//DDB-FileEnd
51416>>>>>    use baxio.dd
51416>>>>>    use syscurxr.dd
51416>>>>>    use clients.dd
51416>>>>>    use bmove.dd
51416>>>>>    Use rvi36.pkg
INCLUDING FILE: RVI36.PKG
/HEADERR36
Image 10, HEADERR36
 !
 __________________________________                                                          †‹Œˆ€  : __________
 __________________________________                                                          €.€ : __________
 __________________________________
 __________     ___________________
 €”‹ __________ ƒŽ“ _______________
                                  _______________________________________________
                                  ===============================================
                    ‘ « ¦   ® œ å ˜   ‹ œ « ˜ ™   ™ ˜  æ £ œ ¤ ¦ ¬   € ¥   ¦ š ¨ á ­ ¦ ¬     ‘«¦ ®œå˜ €§¦›â¡«ž
   ˜/˜   „å›¦ª €¥ ¦š¨á­¦¬      €¨ Ÿ£æª     „¡›æ«žª      ’¨á§œ˜  †£.Šã¥žª   Œ¦£.         €¥å˜
/BodyR36
Image 11, BODYR36
  ___  _____________________ ____________ ____________ ________ __/__/____ ___ ___,___,___.__ ____________________
/TotalR36
Image 12, TOTALR36
------------------------------------------------------------------------------------------------------------------
                                                   ‘ç¤¦¢¦ €¥å˜ª €¥ ¦š¨á­à¤ ___,___,___,___.__
       ‚ ˜ «ž __________________________________               Ž ˜¨˜¢˜™é¤
˜¨˜«ž¨ã©œ ª: ____________________________________________________________
              ____________________________________________________________  !
/*
51416>>>>>    open codemast
51418>>>>>    open company
51420>>>>>    //AB-StoreTopEnd
51420>>>>>
51420>>>>>    //AB-IgnoreStart
51420>>>>>
51420>>>>>    Use DFAllEnt.pkg
51420>>>>>    Use Button.Sub
51420>>>>>
51420>>>>>    //AB-IgnoreEnd
51420>>>>>
51420>>>>>    ACTIVATE_VIEW Activate_r36 FOR r36
51424>>>>>
51424>>>>>    Object r36 is a ReportViewSub
51426>>>>>
51426>>>>>        //AB-StoreTopStart
51426>>>>>        
51426>>>>>        Property Integer Sort_Indexaxio   Public 1
51428>>>>>        Property string  psrecr           public ''
51430>>>>>        property integer piaa             public 0
51432>>>>>        //AB-StoreTopEnd
51432>>>>>
51432>>>>>        Set Label to "„¡«ç§à©ž Bmoves"
51433>>>>>        Set Size to 64 186
51434>>>>>        Set Location to 1 7
51435>>>>>
51435>>>>>        //AB-DDOStart
51435>>>>>
51435>>>>>
51435>>>>>        //AB-DDOEnd
51435>>>>>
51435>>>>>        Object DestRadio is a RadioGroup
51437>>>>>
51437>>>>>            //AB-StoreTopStart
51437>>>>>                        
51437>>>>>            //AB-StoreTopEnd
51437>>>>>
51437>>>>>            Set Label to "„¡«ç§à©ž"
51438>>>>>            Set Size to 42 49
51439>>>>>            Set Location to 2 1
51440>>>>>            Object WindowRadio is a Radio
51442>>>>>                Set Size to 13 30
51443>>>>>                Set Location to 12 12
51444>>>>>                Set Bitmap to "screen4.bmp"
51445>>>>>            End_Object    // WindowRadio
51446>>>>>
51446>>>>>            Object PrinterRadio is a Radio
51448>>>>>                Set Size to 10 31
51449>>>>>                Set Location to 30 12
51450>>>>>                Set Bitmap to "PRINT_M1.BMP"
51451>>>>>            End_Object    // PrinterRadio
51452>>>>>
51452>>>>>
51452>>>>>            //AB-StoreStart
51452>>>>>            Procedure Notify_Select_State  Integer iNewItem  Integer iOldItem
51454>>>>>                Forward Send Notify_Select_State  iNewItem  iOldItem
51456>>>>>                If iNewItem EQ 0 Set Output_Device_Mode  To PRINT_TO_WINDOW
51459>>>>>              //  Set Output_Device_Mode  To PRINT_TO_WINDOW
51459>>>>>            End_Procedure
51460>>>>>            
51460>>>>>            
51460>>>>>            
51460>>>>>            
51460>>>>>            
51460>>>>>            
51460>>>>>            
51460>>>>>            //AB-StoreEnd
51460>>>>>
51460>>>>>        End_Object    // DestRadio
51461>>>>>
51461>>>>>        Object ButtonSub3 is a ButtonSub
51463>>>>>
51463>>>>>            //AB-StoreTopStart
51463>>>>>                                                                                                                                                                                                                                                            
51463>>>>>            //AB-StoreTopEnd
51463>>>>>
51463>>>>>            Set Bitmap to "RUNPROG.BMP"
51464>>>>>            Set Size to 18 27
51465>>>>>            Set Location to 6 59
51466>>>>>
51466>>>>>            //AB-StoreStart
51466>>>>>            Procedure OnClick
51468>>>>>            
51468>>>>>            
51468>>>>>            End_Procedure
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            
51469>>>>>            //AB-StoreEnd
51469>>>>>
51469>>>>>        End_Object    // ButtonSub3
51470>>>>>
51470>>>>>        Object ButtonSub4 is a ButtonSub
51472>>>>>
51472>>>>>            //AB-StoreTopStart
51472>>>>>                                                                                                                                                                                                                                                                                            
51472>>>>>            //AB-StoreTopEnd
51472>>>>>
51472>>>>>            Set Bitmap to "CANCEL.BMP"
51473>>>>>            Set Size to 18 27
51474>>>>>            Set Location to 28 58
51475>>>>>
51475>>>>>            //AB-StoreStart
51475>>>>>            Procedure OnClick
51477>>>>>                Send Request_Cancel
51478>>>>>            End_Procedure
51479>>>>>            
51479>>>>>            
51479>>>>>            
51479>>>>>            
51479>>>>>            //AB-StoreEnd
51479>>>>>
51479>>>>>        End_Object    // ButtonSub4
51480>>>>>
51480>>>>>
51480>>>>>        //AB-StoreStart
51480>>>>>        
51480>>>>>        //Selection Variables
51480>>>>>        
51480>>>>>        //HELP-VARIABLES
51480>>>>>        
51480>>>>>        Procedure StartReport
51482>>>>>        
51482>>>>>            Local Integer iOutputDevice
51483>>>>>            Local String  FileName
51483>>>>>            local integer inew_state
51483>>>>>            Get Output_Device_Mode To iOutputDevice
51484>>>>>            If iOutputDevice EQ 0 Begin
51486>>>>>               Make_Temp_File "TXT" FileName
51487>>>>>               Move (".\" - FileName)  To FileName
51488>>>>>               Set Output_Device_Name  To FileName
51489>>>>>              // set piprinter to 1
51489>>>>>            End
51489>>>>>>
51489>>>>>            Else ;            Set Output_Device_Name  To "Lpt1:"
51491>>>>>        
51491>>>>>            SEND RUN_REPORT
51492>>>>>        
51492>>>>>         //   If iOutputDevice EQ 1 Begin
51492>>>>>         //      RunProgram background "notepad" FileName
51492>>>>>         //      EraseFile FileName
51492>>>>>          //  End
51492>>>>>        
51492>>>>>        End_Procedure   // StartReport
51493>>>>>        
51493>>>>>        
51493>>>>>        Object AXIO_BasicReport is a BasicReport
51495>>>>>        
51495>>>>>           Set Report_Title to "„¡«ç§à©ž €¥ ¦š¨á­à¤       "
51496>>>>>        
51496>>>>>           Object Btypkin_DD is a Btypkin_DataDictionary
51498>>>>>           End_Object    // Btypkin_DD
51499>>>>>        
51499>>>>>           Object Baxiokat_DD is a Baxiokat_DataDictionary
51501>>>>>           End_Object    // Baxiokat_DD
51502>>>>>        
51502>>>>>           Object Barticl_DD is a Barticl_DataDictionary
51504>>>>>              Set DDO_Server to (Btypkin_DD(self))
51505>>>>>           End_Object    // Barticl_DD
51506>>>>>        
51506>>>>>           Object Bsum_DD is a Bsum_DataDictionary
51508>>>>>              Set DDO_Server to (Barticl_DD(self))
51509>>>>>              Set Constrain_File to Barticl.File_Number
51510>>>>>           End_Object    // Bsum_DD
51511>>>>>        
51511>>>>>           Object Baxio_DD is a Baxio_DataDictionary
51513>>>>>              Set DDO_Server to (Baxiokat_DD(self))
51514>>>>>           End_Object    // Baxio_DD
51515>>>>>        
51515>>>>>           Object Syscurxr_DD is a Syscurxr_DataDictionary
51517>>>>>           End_Object    // Syscurxr_DD
51518>>>>>        
51518>>>>>            Object Clients_DD is a Clients_DataDictionary
51520>>>>>        
51520>>>>>            End_Object    // Clients_DD
51521>>>>>        
51521>>>>>        
51521>>>>>            Object Bmove_DD is a Bmove_DataDictionary
51523>>>>>                Set DDO_Server to (Barticl_DD(self))
51524>>>>>                Set DDO_Server to (Baxio_DD(self))
51525>>>>>                Set Constrain_File to Barticl.File_Number
51526>>>>>                begin_constraints
51528>>>>>                    constrain bmove.barticl_recr eq (psrecr(self))
51530>>>>>                end_constraints
51533>>>>>            End_Object    // Bmove_DD
51534>>>>>        
51534>>>>>        
51534>>>>>        
51534>>>>>        
51534>>>>>            //Main DD for the report
51534>>>>>            Set Server To (bmove_dd(Current_Object))
51535>>>>>        
51535>>>>>            //Breaks and Index for the report
51535>>>>>            Report_Index By Index.1
51537>>>>>            Function Starting_Main_Report Returns Integer
51539>>>>>              Integer iIndexaxio
51540>>>>>              Local Integer iRetVal
51540>>>>>              set page_feed to 66
51541>>>>>              set page_end to 60
51542>>>>>              set piaa to 0
51543>>>>>              Forward Get Starting_Main_Report to iRetval
51545>>>>>              send rebuild_constraints to bmove_dd
51546>>>>>              Send Find to (bmove_dd(self)) First_Record 1
51547>>>>>              Get Sort_Indexaxio  To iIndexaxio
51548>>>>>              Report_Index BY iIndexaxio
51550>>>>>           End_Function
51551>>>>>        
51551>>>>>           Procedure_Section Page_Top as HeaderR36
51556>>>>>               date ddate
51556>>>>>               sysdate4 ddate
51557>>>>>               clear company
51558>>>>>               move barticl.company_code  to company.company_code
51559>>>>>               find eq company by index.1
51560>>>>>>
51560>>>>>               print company.company_name to headerr36.1
51561>>>>>               print ddate                to headerr36.2
51562>>>>>               clear codemast
51563>>>>>               move 'JOB' to codemast.type
51564>>>>>               move company.company_j_code to codemast.code
51565>>>>>               find eq codemast by index.1
51566>>>>>>
51566>>>>>               move codemast.description   to headerr36.3
51567>>>>>               move barticl.barticl_no      to headerr36.4
51568>>>>>               move company.company_addr   to headerr36.5
51569>>>>>               move company.company_tk     to headerr36.6
51570>>>>>               move company.company_poli   to headerr36.7
51571>>>>>               move company.company_afm    to headerr36.8
51572>>>>>               clear codemast
51573>>>>>               move 'DOY' to codemast.type
51574>>>>>               move company.company_doy    to codemast.code
51575>>>>>               find eq codemast by index.1
51576>>>>>>
51576>>>>>               move codemast.description   to headerr36.9
51577>>>>>               move btypkin.btypkin_descr  to headerr36.10
51578>>>>>               OutPut_PageCheck
51579>>>>>           End_Procedure
51580>>>>>        
51580>>>>>           Procedure_Section  Body as BodyR36
51585>>>>>              number iaa
51585>>>>>              get piaa                      to iaa
51586>>>>>              add 1                         to iaa
51587>>>>>              set piaa                      to iaa
51588>>>>>              print iaa                     to bodyr36.1
51589>>>>>              print baxiokat.baxiokat_descr to bodyr36.2
51590>>>>>              Print baxio.baxio_no          to bodyr36.3
51591>>>>>              clear codemast
51592>>>>>              move 'BANK' to codemast.type
51593>>>>>              move baxio.baxio_banka to codemast.code
51594>>>>>              find eq codemast by index.1
51595>>>>>>
51595>>>>>              move baxio.baxio_epon_in    to bodyr36.4
51596>>>>>              move codemast.description   to bodyr36.5
51597>>>>>              move baxio.baxio_hmnial     to bodyr36.6
51598>>>>>              move baxio.baxio_c_code2    to bodyr36.7
51599>>>>>              print baxio.baxio_v2        to bodyr36.8
51600>>>>>              move baxio.baxio_epon_out   to bodyr36.9
51601>>>>>              add bodyr36.8               to totalr36.1
51602>>>>>              OutPut_PageCheck
51603>>>>>           End_Procedure
51604>>>>>        
51604>>>>>           PROCEDURE_SECTION TOTAL AS TOTALR36
51609>>>>>             // Subtotal BodyR36.8      TO totalr36.1
51609>>>>>              print totalr36.1
51610>>>>>              print company.company_name to totalr36.2
51611>>>>>              print barticl.sxolia1      to totalr36.3
51612>>>>>              print barticl.sxolia2      to totalr36.4
51613>>>>>              output_pagecheck
51614>>>>>           END_PROCEDURE
51615>>>>>        
51615>>>>>           Procedure Ending_Report
51617>>>>>             Blankform BodyR36.1      Thru BodyR36.9
51618>>>>>>
51618>>>>>           End_Procedure
51619>>>>>        
51619>>>>>        End_Object
51620>>>>>        
51620>>>>>        
51620>>>>>        Procedure Activate_View Returns Integer
51622>>>>>            Local Integer Rval
51623>>>>>            Forward Get MSG_Activate_View to Rval
51625>>>>>        End_Procedure
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        
51626>>>>>        //AB-StoreEnd
51626>>>>>
51626>>>>>    End_Object    // r36
51627>>>>>
51627>>>>>
51627>>>>>    //AB-StoreStart
51627>>>>>                                                        
51627>>>>>                                                        
51627>>>>>                                                        
51627>>>>>                                                        
51627>>>>>                                                        
51627>>>>>                                                        
51627>>>>>                                                        
51627>>>>>                                                        
51627>>>>>                                                        
51627>>>>>                                                        
51627>>>>>                                                        
51627>>>>>                                                        
51627>>>>>                                                        
51627>>>>>                                                        
51627>>>>>                                                        
51627>>>>>                                                        
51627>>>>>                                                        
51627>>>>>                                                        
51627>>>>>                                                        
51627>>>>>                                                        
51627>>>>>                                                        
51627>>>>>                                                        
51627>>>>>                                                        
51627>>>>>                                                        
51627>>>>>                                                        
51627>>>>>                                                        
51627>>>>>                                                        
51627>>>>>                                                        
51627>>>>>    //AB-StoreEnd
51627>>>>>
51627>>>>>//AB/     End_Object    // prj
51627>>>Use baxio.dd
51627>>>Use Tperga.dd
INCLUDING FILE: TPERGA.DD
51627>>>>>//DDB-FileStart
51627>>>>>//DDB-HeaderStart
51627>>>>>
51627>>>>>// File Name : TPERGA.DD
51627>>>>>// Class Name: Tperga_DataDictionary
51627>>>>>// Revision  : 14
51627>>>>>// Version   : 2
51627>>>>>
51627>>>>>Use  Windows           // Basic Definitions
51627>>>>>Use  DataDict          // DataDictionary Class Definition
51627>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51627>>>>>
51627>>>>>Open Tperga
51629>>>>>Open Cn
51631>>>>>Open Baxiokat
51633>>>>>Open Sysrecc
51635>>>>>
51635>>>>>//DDB-HeaderEnd
51635>>>>>
51635>>>>>Class Tperga_DataDictionary  is a DataDictionary_Sec
51636>>>>>
51636>>>>>    Procedure Save_Main_File
51637>>>>>        If (Operation_Origin<>Self) Begin
51639>>>>>            If Tperga.Recnum Eq 0 Procedure_Return
51642>>>>>        End
51642>>>>>>
51642>>>>>        Forward Send Save_Main_File
51644>>>>>    End_Procedure
51645>>>>>
51645>>>>>
51645>>>>>
51645>>>>>    Procedure Creating
51646>>>>>        Forward Send Creating
51648>>>>>        // Insert Code Here
51648>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(TPErga.TPErga_Rec0))))));                                    to TPErga.TPErga_Recr
51649>>>>>    End_Procedure   // Creating
51650>>>>>
51650>>>>>    // Define_Fields:
51650>>>>>    // This procedure is used to set up all data-dictionary rules.
51650>>>>>
51650>>>>>    Procedure Define_Fields
51651>>>>>        Forward Send Define_Fields
51653>>>>>        //DDB-Generated-Code-Location
51653>>>>>        //DDB-DefineFieldStart
51653>>>>>
51653>>>>>        Set Main_File            To Tperga.File_Number
51654>>>>>        Set Cascade_Delete_State To FALSE
51655>>>>>
51655>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
51656>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
51657>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51658>>>>>
51658>>>>>        // Parent (Server) file structure...............
51658>>>>>        Send Add_Server_File  Cn.File_Number
51659>>>>>        Send Add_Server_File  Baxiokat.File_Number
51660>>>>>
51660>>>>>        // External (System) file structure.............
51660>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
51661>>>>>
51661>>>>>        Define_Auto_Increment  Sysrecc.Tperga_Rec0  To Tperga.Tperga_Rec0
51664>>>>>
51664>>>>>        // Field-based properties.......................
51664>>>>>
51664>>>>>        // Tperga.Cn_Code
51664>>>>>
51664>>>>>        // Tperga.Baxiokat_Code
51664>>>>>
51664>>>>>        // Tperga.Pct_Epi_Synolou
51664>>>>>
51664>>>>>        // Tperga.Paralabh_Meres
51664>>>>>
51664>>>>>        // Tperga.Xarhtos_Meres
51664>>>>>
51664>>>>>        // Tperga.Plhroteo_Meres
51664>>>>>
51664>>>>>        // Tperga.Tperga_Rec0
51664>>>>>
51664>>>>>        // Tperga.Tperga_Recr
51664>>>>>
51664>>>>>        //DDB-DefineFieldEnd
51664>>>>>    End_Procedure    // Define_Fields
51665>>>>>
51665>>>>>    // Field_Defaults:
51665>>>>>    // This procedure is used to establish default field values.
51665>>>>>
51665>>>>>    Procedure Field_Defaults
51666>>>>>        Forward Send Field_Defaults
51668>>>>>        //DDB-Generated-Code-Location
51668>>>>>        //DDB-FieldDefaultStart
51668>>>>>        //DDB-FieldDefaultEnd
51668>>>>>    End_Procedure    // Field_Defaults
51669>>>>>
51669>>>>>End_Class    // Tperga_DataDictionary
51670>>>>>//DDB-FileEnd
51670>>>Use BtnOrdH.DD
INCLUDING FILE: BTNORDH.DD
51670>>>>>//DDB-FileStart
51670>>>>>//DDB-HeaderStart
51670>>>>>
51670>>>>>// File Name : BTNORDH.DD
51670>>>>>// Class Name: Btnordh_DataDictionary
51670>>>>>// Revision  : 50
51670>>>>>// Version   : 2
51670>>>>>
51670>>>>>Use  Windows           // Basic Definitions
51670>>>>>Use  DataDict          // DataDictionary Class Definition
51670>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51670>>>>>
51670>>>>>Open Btnordh
51672>>>>>Open Btnordd
51674>>>>>Open Cn
51676>>>>>Open Sysrecc
51678>>>>>
51678>>>>>//DDB-HeaderEnd
51678>>>>>//DDB-ValidationStart
51678>>>>>
51678>>>>>Register_Object Btnordh_Velxr_VT1
51678>>>>>
51678>>>>>Object Btnordh_Velxr_VT1  is a CodeValidationTable
51680>>>>>    Set Type_Value        To "ELXREOSH"
51681>>>>>    Set Table_Title       To "•¨âà©ž „¢¢œ §é¤ ”¦¨«åà¤"
51682>>>>>    //DDB-ValidationCustomStart
51682>>>>>    //DDB-ValidationCustomEnd
51682>>>>>End_Object   // Btnordh_Velxr_VT1
51683>>>>>//DDB-ValidationEnd
51683>>>>>
51683>>>>>Class Btnordh_DataDictionary  is a DataDictionary_Sec
51684>>>>>    
51684>>>>>    Procedure Construct_Object
51685>>>>>        Forward Send Construct_Object
51687>>>>>        Property integer piactive  Public 0
51688>>>>>    End_Procedure
51689>>>>>    
51689>>>>>    Procedure Creating
51690>>>>>        String  sClientCode sCNCode
51691>>>>>        Integer iClientCode iCnCode iAA
51691>>>>>        date ddate
51691>>>>>        Forward Send Creating
51693>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                        (Trim(String(BTNORDH.Rec0)))))) to BTNORDH.Recr
51694>>>>>
51694>>>>>        Move (fsgStripCodeFromID(Clients.Client_ID))    to iClientCode
51695>>>>>        Move (fsgStripCodeFromID(CN.CN_Code))           to iCnCode
51696>>>>>        Move Cn.AA_Deop                                 to iAA
51697>>>>>        Add 1                                           to iAA  
51698>>>>>        Add 1                                           to Cn.AA_Deop
51699>>>>>
51699>>>>>
51699>>>>>        Get Sfi_All_Numbers iClientCode Sysfile.Client_Digits 0 to sClientCode
51700>>>>>        Get Sfi_All_Numbers iCNCode     Sysfile.Client_Digits 0 to sCNCode
51701>>>>>        
51701>>>>>        Move (sClientCode+sCNCode+'/'+(String(iAA)))    to btnordh.aa_deop  
51702>>>>>        sysdate4 ddate
51703>>>>>        if (btnordh.date_create='') move ddate to btnordh.date_create
51706>>>>>        if (btnordh.deop_date ='') move ddate to btnordh.deop_date 
51709>>>>>        if (piactive(self)=1) move 0 to btnordh.deop_active
51712>>>>>        else move 1 to btnordh.deop_active
51714>>>>>        // Insert Code Here
51714>>>>>    End_Procedure   // Creating
51715>>>>>
51715>>>>>     Procedure Update
51716>>>>>        Forward Send Update 
51718>>>>>       
51718>>>>>        // Insert Code Here
51718>>>>>        Move SysCurXR.Company_Code  to btnordh.Vcompany
51719>>>>>        Move SysCurXR.Branch_Code   to btnordh.Vbranch 
51720>>>>>        move syscurxr.year_year     to btnordh.vyear  
51721>>>>>        move cn.cn_code             to btnordh.cn_code  
51722>>>>>        move clients.client_id      to btnordh.client_id
51723>>>>>        move payresp.presp_id       to btnordh.presp_id  
51724>>>>>        if (btnordh.deop_date = '');            move cn.cn_start_date to btnordh.deop_date
51727>>>>>     end_procedure
51728>>>>>
51728>>>>>
51728>>>>> 
51728>>>>>    // Define_Fields:
51728>>>>>    // This procedure is used to set up all data-dictionary rules.
51728>>>>>
51728>>>>>    Procedure Define_Fields
51729>>>>>        Forward Send Define_Fields
51731>>>>>        //DDB-Generated-Code-Location
51731>>>>>        //DDB-DefineFieldStart
51731>>>>>
51731>>>>>        Set Main_File            To Btnordh.File_Number
51732>>>>>        Set Cascade_Delete_State To FALSE
51733>>>>>
51733>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
51734>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
51735>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51736>>>>>
51736>>>>>        // Child (Client) file structure................
51736>>>>>        Send Add_Client_File  Btnordd.File_Number
51737>>>>>
51737>>>>>        // Parent (Server) file structure...............
51737>>>>>        Send Add_Server_File  Cn.File_Number
51738>>>>>
51738>>>>>        // External (System) file structure.............
51738>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
51739>>>>>
51739>>>>>        Define_Auto_Increment  Sysrecc.Btnordh_Rec0  To Btnordh.Rec0
51742>>>>>
51742>>>>>        // Field-based properties.......................
51742>>>>>
51742>>>>>        // Btnordh.Vcompany
51742>>>>>
51742>>>>>        // Btnordh.Vbranch
51742>>>>>
51742>>>>>        // Btnordh.Vyear
51742>>>>>
51742>>>>>        // Btnordh.Rec0
51742>>>>>
51742>>>>>        // Btnordh.Recr
51742>>>>>
51742>>>>>        // Btnordh.Aa_Deop
51742>>>>>
51742>>>>>        // Btnordh.Cn_Recr
51742>>>>>
51742>>>>>        // Btnordh.Sxolia
51742>>>>>
51742>>>>>        // Btnordh.Cn_Code
51742>>>>>
51742>>>>>        // Btnordh.Client_Id
51742>>>>>
51742>>>>>        // Btnordh.Presp_Id
51742>>>>>
51742>>>>>        // Btnordh.Deop_Date
51742>>>>>        Set Field_Mask_Type        Field Btnordh.Deop_Date To MASK_DATE_WINDOW
51743>>>>>
51743>>>>>        // Btnordh.Deop_Active
51743>>>>>
51743>>>>>        // Btnordh.Eleiph
51743>>>>>
51743>>>>>        // Btnordh.Locked
51743>>>>>
51743>>>>>        // Btnordh.User_Id
51743>>>>>
51743>>>>>        // Btnordh.Date_Create
51743>>>>>
51743>>>>>        // Btnordh.Date_Modify
51743>>>>>
51743>>>>>        // Btnordh.Date_Locked
51743>>>>>
51743>>>>>        // Btnordh.Deop_Lhxh
51743>>>>>        Set Field_Mask_Type        Field Btnordh.Deop_Lhxh To MASK_DATE_WINDOW
51744>>>>>
51744>>>>>        // Btnordh.Statero
51744>>>>>
51744>>>>>        // Btnordh.Velxr
51744>>>>>        Set Field_Value_Table      Field Btnordh.Velxr To (Btnordh_Velxr_VT1(Self))
51745>>>>>
51745>>>>>        // Btnordh.Timeout
51745>>>>>
51745>>>>>        // Btnordh.Timeout1
51745>>>>>
51745>>>>>        //DDB-DefineFieldEnd
51745>>>>>    End_Procedure    // Define_Fields
51746>>>>>
51746>>>>>    
51746>>>>>    // Field_Defaults:
51746>>>>>    // This procedure is used to establish default field values.
51746>>>>>
51746>>>>>    Procedure Field_Defaults
51747>>>>>        Forward Send Field_Defaults
51749>>>>>        //DDB-Generated-Code-Location
51749>>>>>        //DDB-FieldDefaultStart
51749>>>>>        //DDB-FieldDefaultEnd
51749>>>>>    End_Procedure    // Field_Defaults
51750>>>>>
51750>>>>>End_Class    // Btnordh_DataDictionary
51751>>>>>//DDB-FileEnd
51751>>>Use BtnOrdD.DD
INCLUDING FILE: BTNORDD.DD
51751>>>>>//DDB-FileStart
51751>>>>>//DDB-HeaderStart
51751>>>>>
51751>>>>>// File Name : BTNORDD.DD
51751>>>>>// Class Name: Btnordd_DataDictionary
51751>>>>>// Revision  : 46
51751>>>>>// Version   : 2
51751>>>>>
51751>>>>>Use  Windows           // Basic Definitions
51751>>>>>Use  DataDict          // DataDictionary Class Definition
51751>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51751>>>>>
51751>>>>>Open Btnordd
51753>>>>>Open Btnordh
51755>>>>>
51755>>>>>//DDB-HeaderEnd
51755>>>>>//DDB-ValidationStart
51755>>>>>
51755>>>>>Register_Object Btnordd_Vkatish_VT
51755>>>>>Register_Object Btnordd_Velxr_VT
51755>>>>>
51755>>>>>Object Btnordd_Vkatish_VT  is a CodeValidationTable
51757>>>>>    Set Type_Value        To "KATISH"
51758>>>>>    Set Allow_Blank_State To TRUE
51759>>>>>    Set Table_Title       To "‰€‡ˆ‘†"
51760>>>>>    //DDB-ValidationCustomStart
51760>>>>>    //DDB-ValidationCustomEnd
51760>>>>>End_Object   // Btnordd_Vkatish_VT
51761>>>>>
51761>>>>>Object Btnordd_Velxr_VT  is a CodeValidationTable
51763>>>>>    Set Type_Value        To "ELXREOSH"
51764>>>>>    Set Validate_State    To FALSE
51765>>>>>    Set Table_Title       To "•¨âà©ž „¢¢œ §é¤ ”¦¨«åà¤"
51766>>>>>    //DDB-ValidationCustomStart
51766>>>>>    //DDB-ValidationCustomEnd
51766>>>>>End_Object   // Btnordd_Velxr_VT
51767>>>>>//DDB-ValidationEnd
51767>>>>>Open Item
51769>>>>>
51769>>>>>Class Btnordd_DataDictionary  is a DataDictionary_Sec
51770>>>>> 
51770>>>>>    Procedure Construct_Object
51771>>>>>        Forward Send Construct_Object
51773>>>>>        Property Number pnOldPctDisc    Public 0
51774>>>>>        Property Number pnOldPosoDisc   Public 0
51775>>>>>    End_Procedure
51776>>>>>    
51776>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
51777>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
51779>>>>>        Set pnOldPctDisc    to Btnordd.Vdisc
51780>>>>>        Set pnOldPosoDisc   to Btnordd.VdiscPoso
51781>>>>>    End_Procedure   // New_Current_Record
51782>>>>>
51782>>>>>    Procedure Creating
51783>>>>>        Forward Send Creating   
51785>>>>>        move btnordh.deop_active to btnordd.vactive
51786>>>>>    End_Procedure   // Creating
51787>>>>> 
51787>>>>>   Procedure Update
51788>>>>>        Number iOldPct iOldPoso Total
51789>>>>>        Forward Send Update   
51791>>>>>        Get pnOldPosoDisc           to iOldPoso
51792>>>>>        Get pnOldPctDisc            to iOldPct
51793>>>>>        move btnordh.aa_deop        to btnordd.vorderbt
51794>>>>>        move btnordh.client_id      to btnordd.vclient_id
51795>>>>>        move btnordh.cn_code        to btnordd.vcn_code
51796>>>>>        move btnordh.deop_lhxh      to btnordd.deop_date   
51797>>>>>        move btnordh.deop_date      to btnordd.arxh_date
51798>>>>>      
51798>>>>>        If  (Btnordd.Vqty <> 0) Begin
51800>>>>>            Move  btnordd.VunitPrice to btnordd.Vprice
51801>>>>>            If (btnordd.vdisc >0) move (round_number(((btnordd.vprice * btnordd.vdisc) / 100),2)) to total
51804>>>>>            Move (btnordd.vprice - total) to btnordd.vprice
51805>>>>>        End
51805>>>>>>
51805>>>>>        Else Begin
51806>>>>>            move 0 to btnordd.vprice
51807>>>>>            Move 0 to btnordd.Vdisc
51808>>>>>            Move 0 to btnordd.VdiscPoso
51809>>>>>        End
51809>>>>>>
51809>>>>>
51809>>>>>        Clear Item
51810>>>>>        Move Btnordd.Vitem to Item.Item_Code
51811>>>>>        Find Eq Item by Index.5
51812>>>>>>
51812>>>>>        Move Item.Item_Descr to btnordd.Vitem_Descr
51813>>>>>        Move Item.Item_Qual  to btnordd.VQual
51814>>>>>   End_Procedure
51815>>>>>   
51815>>>>> 
51815>>>>>
51815>>>>>    // Define_Fields:
51815>>>>>    // This procedure is used to set up all data-dictionary rules.
51815>>>>>
51815>>>>>    Procedure Define_Fields
51816>>>>>        Forward Send Define_Fields
51818>>>>>        //DDB-Generated-Code-Location
51818>>>>>        //DDB-DefineFieldStart
51818>>>>>
51818>>>>>        Set Main_File            To Btnordd.File_Number
51819>>>>>
51819>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
51820>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
51821>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51822>>>>>
51822>>>>>        // Parent (Server) file structure...............
51822>>>>>        Send Add_Server_File  Btnordh.File_Number
51823>>>>>
51823>>>>>        // Field-based properties.......................
51823>>>>>
51823>>>>>        // Btnordd.Btnordh_Recr
51823>>>>>
51823>>>>>        // Btnordd.Vitem
51823>>>>>
51823>>>>>        // Btnordd.Vitem_Descr
51823>>>>>
51823>>>>>        // Btnordd.Vqual
51823>>>>>
51823>>>>>        // Btnordd.Vqty
51823>>>>>
51823>>>>>        // Btnordd.Vunitprice
51823>>>>>
51823>>>>>        // Btnordd.Vdisc
51823>>>>>
51823>>>>>        // Btnordd.Vprice
51823>>>>>
51823>>>>>        // Btnordd.Vkatish
51823>>>>>        Set Field_Value_Table      Field Btnordd.Vkatish To (Btnordd_Vkatish_VT(Self))
51824>>>>>
51824>>>>>        // Btnordd.Vxrm3
51824>>>>>
51824>>>>>        // Btnordd.Vpagiaxrm3
51824>>>>>
51824>>>>>        // Btnordd.Vpagiaxrprice
51824>>>>>
51824>>>>>        // Btnordd.Vanopagia
51824>>>>>
51824>>>>>        // Btnordd.Vsthsimo
51824>>>>>
51824>>>>>        // Btnordd.Veleipes
51824>>>>>
51824>>>>>        // Btnordd.Vorderbt
51824>>>>>
51824>>>>>        // Btnordd.Vclient_Id
51824>>>>>
51824>>>>>        // Btnordd.Vcn_Code
51824>>>>>
51824>>>>>        // Btnordd.Vactive
51824>>>>>
51824>>>>>        // Btnordd.Deop_Date
51824>>>>>
51824>>>>>        // Btnordd.Velxr
51824>>>>>        Set Field_Value_Table      Field Btnordd.Velxr To (Btnordd_Velxr_VT(Self))
51825>>>>>
51825>>>>>        // Btnordd.Arxh_Date
51825>>>>>        Set Field_Mask_Type        Field Btnordd.Arxh_Date To MASK_DATE_WINDOW
51826>>>>>
51826>>>>>        // Btnordd.Vdiscposo
51826>>>>>
51826>>>>>        // Btnordd.Vqtyused
51826>>>>>
51826>>>>>        //DDB-DefineFieldEnd
51826>>>>>    End_Procedure    // Define_Fields
51827>>>>>
51827>>>>>    // Field_Defaults:
51827>>>>>    // This procedure is used to establish default field values.
51827>>>>>
51827>>>>>    Procedure Field_Defaults
51828>>>>>        Forward Send Field_Defaults
51830>>>>>        //DDB-Generated-Code-Location
51830>>>>>        //DDB-FieldDefaultStart
51830>>>>>        //DDB-FieldDefaultEnd
51830>>>>>    End_Procedure    // Field_Defaults
51831>>>>>
51831>>>>>End_Class    // Btnordd_DataDictionary
51832>>>>>//DDB-FileEnd
51832>>>Use Mhxanik.DD
INCLUDING FILE: MHXANIK.DD
51832>>>>>//DDB-FileStart
51832>>>>>//DDB-HeaderStart
51832>>>>>
51832>>>>>// File Name : MHXANIK.DD
51832>>>>>// Class Name: Mhxanik_DataDictionary
51832>>>>>// Revision  : 24
51832>>>>>// Version   : 2
51832>>>>>
51832>>>>>Use  Windows           // Basic Definitions
51832>>>>>Use  DataDict          // DataDictionary Class Definition
51832>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51832>>>>>
51832>>>>>Open Mhxanik
51834>>>>>Open Cn
51836>>>>>Open Sysrecc
51838>>>>>
51838>>>>>//DDB-HeaderEnd
51838>>>>>//DDB-ValidationStart
51838>>>>>
51838>>>>>Register_Object Mhxanik_Mhx_Doy_VT
51838>>>>>
51838>>>>>Object Mhxanik_Mhx_Doy_VT  is a CodeValidationTable
51840>>>>>    Set Type_Value        To "DOY"
51841>>>>>    Set Validate_State    To FALSE
51842>>>>>    Set Allow_Blank_State To TRUE
51843>>>>>    //DDB-ValidationCustomStart
51843>>>>>    //DDB-ValidationCustomEnd
51843>>>>>End_Object   // Mhxanik_Mhx_Doy_VT
51844>>>>>//DDB-ValidationEnd
51844>>>>>//DDB-SelectionStart
51844>>>>>//DDB/ ExternalSelectionList sl055  sl055.SL
51844>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
51844>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
51844>>>>>Register_Object sl055
51844>>>>>Register_Object sl198
51844>>>>>Register_Object sl197
51844>>>>>//DDB-SelectionEnd
51844>>>>>
51844>>>>>Class Mhxanik_DataDictionary  is a DataDictionary_Sec
51845>>>>>
51845>>>>>     Procedure Update
51846>>>>>        Forward Send Update
51848>>>>>        // Insert Code Here
51848>>>>>        Move SysCurXR.Company_Code  to Mhxanik.Company_Code
51849>>>>>        Move SysCurXR.Branch_Code   to Mhxanik.Branch_Code
51850>>>>>        Move SysCurXR.Year_Year     to Mhxanik.Year_Year
51851>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
51851>>>>>        Move (Mhxanik.Xreosh-Mhxanik.Pistosh)   to Mhxanik.Ypoloipo
51852>>>>>        Move (Mhxanik.Plafon-Mhxanik.ypoloipo)  to Mhxanik.Overhead
51853>>>>>
51853>>>>>        //Move Clients.Client_Address     to Clients.Client_LastUpd
51853>>>>>
51853>>>>>        //betolink
51853>>>>>        Move SysCurXR.Beto_Site         to Mhxanik.Mhx_SiteW
51854>>>>>        Move Mhxanik.Mhx_Rec0           to Mhxanik.Mhx_SN
51855>>>>>        Move Mhxanik.Mhx_id             to Mhxanik.Mhx_Repm
51856>>>>>
51856>>>>>    End_Procedure   // Update
51857>>>>>
51857>>>>>     Procedure Creating
51858>>>>>        Forward Send Creating
51860>>>>>        // Insert Code Here
51860>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Mhxanik.Mhx_Rec0))))));                                    to Mhxanik.Mhx_Recr
51861>>>>>        Move '1'                    to Mhxanik.Mhx_Active
51862>>>>>        get fsgCode_With_Zeroes Mhxanik.Mhx_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to Mhxanik.Mhx_ID
51863>>>>>    End_Procedure   // Creating
51864>>>>>
51864>>>>>
51864>>>>>    // Define_Fields:
51864>>>>>    // This procedure is used to set up all data-dictionary rules.
51864>>>>>
51864>>>>>    Procedure Define_Fields
51865>>>>>        Forward Send Define_Fields
51867>>>>>        //DDB-Generated-Code-Location
51867>>>>>        //DDB-DefineFieldStart
51867>>>>>
51867>>>>>        Set Main_File            To Mhxanik.File_Number
51868>>>>>        Set Cascade_Delete_State To FALSE
51869>>>>>
51869>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
51870>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
51871>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51872>>>>>
51872>>>>>        // Child (Client) file structure................
51872>>>>>        Send Add_Client_File  Cn.File_Number
51873>>>>>
51873>>>>>        // External (System) file structure.............
51873>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
51874>>>>>
51874>>>>>        Define_Auto_Increment  Sysrecc.Mhxanik_Rec0  To Mhxanik.Mhx_Rec0
51877>>>>>
51877>>>>>        // Field-based properties.......................
51877>>>>>
51877>>>>>        // Mhxanik.Company_Code
51877>>>>>
51877>>>>>        // Mhxanik.Branch_Code
51877>>>>>
51877>>>>>        // Mhxanik.Year_Year
51877>>>>>
51877>>>>>        // Mhxanik.Mhx_Id
51877>>>>>        Set Field_Options          Field Mhxanik.Mhx_Id To DD_AUTOFIND    DD_NOPUT      
51878>>>>>        Set Field_Prompt_Object    Field Mhxanik.Mhx_Id To (sl055(Self))
51879>>>>>        Set Key_Field_State        Field Mhxanik.Mhx_Id To TRUE
51880>>>>>
51880>>>>>        // Mhxanik.Mhx_Name
51880>>>>>        Set Field_Prompt_Object    Field Mhxanik.Mhx_Name To (sl055(Self))
51881>>>>>
51881>>>>>        // Mhxanik.Mhx_Afm
51881>>>>>
51881>>>>>        // Mhxanik.Mhx_Rec0
51881>>>>>
51881>>>>>        // Mhxanik.Mhx_Recr
51881>>>>>
51881>>>>>        // Mhxanik.Last_Xreosh
51881>>>>>
51881>>>>>        // Mhxanik.Last_Pistosh
51881>>>>>
51881>>>>>        // Mhxanik.Last_Order
51881>>>>>
51881>>>>>        // Mhxanik.Mhx_Doy
51881>>>>>        Set Field_Value_Table      Field Mhxanik.Mhx_Doy To (Mhxanik_Mhx_Doy_VT(Self))
51882>>>>>
51882>>>>>        // Mhxanik.Mhx_Address
51882>>>>>
51882>>>>>        // Mhxanik.Mhx_City
51882>>>>>        Set Field_Prompt_Object    Field Mhxanik.Mhx_City To (sl198(Self))
51883>>>>>
51883>>>>>        // Mhxanik.Mhx_Area
51883>>>>>        Set Field_Prompt_Object    Field Mhxanik.Mhx_Area To (sl197(Self))
51884>>>>>
51884>>>>>        // Mhxanik.Mhx_Job
51884>>>>>
51884>>>>>        // Mhxanik.Mhx_Respons
51884>>>>>
51884>>>>>        // Mhxanik.Mhx_Zipcode
51884>>>>>
51884>>>>>        // Mhxanik.Mhx_Phone
51884>>>>>
51884>>>>>        // Mhxanik.Mhx_Fax
51884>>>>>
51884>>>>>        // Mhxanik.Mhx_Mobile
51884>>>>>
51884>>>>>        // Mhxanik.Mhx_Aoh
51884>>>>>
51884>>>>>        // Mhxanik.Mhx_Email
51884>>>>>
51884>>>>>        // Mhxanik.Mhx_Class
51884>>>>>
51884>>>>>        // Mhxanik.Mhx_Details
51884>>>>>
51884>>>>>        // Mhxanik.Mhx_Sitew
51884>>>>>
51884>>>>>        // Mhxanik.Mhx_Codem
51884>>>>>
51884>>>>>        // Mhxanik.Mhx_Categfpa
51884>>>>>
51884>>>>>        // Mhxanik.Mhx_Fpa
51884>>>>>
51884>>>>>        // Mhxanik.Mhx_Public
51884>>>>>
51884>>>>>        // Mhxanik.Mhx_Sn
51884>>>>>
51884>>>>>        // Mhxanik.Mhx_Repm
51884>>>>>
51884>>>>>        // Mhxanik.Mhx_Active
51884>>>>>
51884>>>>>        // Mhxanik.Mhx_Reported
51884>>>>>
51884>>>>>        // Mhxanik.Mhx_Lastupd
51884>>>>>
51884>>>>>        // Mhxanik.Mhx_Markexp
51884>>>>>
51884>>>>>        // Mhxanik.Mhx_Catjob
51884>>>>>
51884>>>>>        // Mhxanik.Xreosh
51884>>>>>
51884>>>>>        // Mhxanik.Pistosh
51884>>>>>
51884>>>>>        // Mhxanik.Ypoloipo
51884>>>>>
51884>>>>>        // Mhxanik.Plafon
51884>>>>>
51884>>>>>        // Mhxanik.Overhead
51884>>>>>
51884>>>>>        // Mhxanik.Mhx_Add_No
51884>>>>>
51884>>>>>        // Mhxanik.Mhx_Nomos
51884>>>>>
51884>>>>>        // Mhxanik.Mhx_Xora
51884>>>>>
51884>>>>>        // Mhxanik.Polh_Recr
51884>>>>>
51884>>>>>        //DDB-DefineFieldEnd
51884>>>>>    End_Procedure    // Define_Fields
51885>>>>>
51885>>>>>    // Field_Defaults:
51885>>>>>    // This procedure is used to establish default field values.
51885>>>>>
51885>>>>>    Procedure Field_Defaults
51886>>>>>        Forward Send Field_Defaults
51888>>>>>        //DDB-Generated-Code-Location
51888>>>>>        //DDB-FieldDefaultStart
51888>>>>>        Set Field_Changed_Value   Field Mhxanik.Mhx_Doy To "0"
51889>>>>>        Set Field_Changed_Value   Field Mhxanik.Mhx_City To 0
51890>>>>>        //DDB-FieldDefaultEnd
51890>>>>>    End_Procedure    // Field_Defaults
51891>>>>>
51891>>>>>End_Class    // Mhxanik_DataDictionary
51892>>>>>//DDB-Selection-pkg-Start
51892>>>>>
51892>>>>>Use sl055.SL         // sl055
INCLUDING FILE: SL055.SL
51892>>>>>>>//AB/ Project sl055:mhxanikoi
51892>>>>>>>//AB/ Object prj is a Lookup_Project
51892>>>>>>>//AB/     Set ProjectName to "sl055:mhxanikoi"
51892>>>>>>>//AB/     Set ProjectFileName to "sl055.SL"
51892>>>>>>>//AB/     Set GenerateFileName to "NONAME"
51892>>>>>>>
51892>>>>>>>// Project Object Structure
51892>>>>>>>//   sl055 is a dbModalPanelSub
51892>>>>>>>//     Mhxanik_DD is a DataDictionary
51892>>>>>>>//     oSelList is a dbListSub
51892>>>>>>>//     oOK_bn is a ButtonSub
51892>>>>>>>//     oCancel_bn is a ButtonSub
51892>>>>>>>//     oSearch_bn is a ButtonSub
51892>>>>>>>
51892>>>>>>>// Register all objects
51892>>>>>>>Register_Object Mhxanik_DD
51892>>>>>>>Register_Object oCancel_bn
51892>>>>>>>Register_Object oOK_bn
51892>>>>>>>Register_Object oSearch_bn
51892>>>>>>>Register_Object oSelList
51892>>>>>>>Register_Object sl055
51892>>>>>>>
51892>>>>>>>
51892>>>>>>>//AB-IgnoreStart
51892>>>>>>>
51892>>>>>>>Use DFAllEnt.pkg
51892>>>>>>>Use dbList.Sub
51892>>>>>>>Use Button.Sub
51892>>>>>>>
51892>>>>>>>
51892>>>>>>>Use MHXANIK.DD
51892>>>>>>>
51892>>>>>>>//AB-IgnoreEnd
51892>>>>>>>
51892>>>>>>>Object sl055 is a dbModalPanelSub
51894>>>>>>>    Set Label to "€¨®œå¦ ‹ž®˜¤ ¡é¤"
51895>>>>>>>    Set Size to 148 430
51896>>>>>>>    Set Location to 4 5
51897>>>>>>>    Set Exit_Application_Local_State to FALSE
51898>>>>>>>    Set Modal_State to FALSE
51899>>>>>>>
51899>>>>>>>    //AB-DDOStart
51899>>>>>>>
51899>>>>>>>    Object Mhxanik_DD is a Mhxanik_DataDictionary
51901>>>>>>>    End_Object    // Mhxanik_DD
51902>>>>>>>
51902>>>>>>>    Set Main_DD to (Mhxanik_DD(self))
51903>>>>>>>    Set Server to (Mhxanik_DD(self))
51904>>>>>>>
51904>>>>>>>    //AB-DDOEnd
51904>>>>>>>
51904>>>>>>>    Object oSelList is a dbListSub
51906>>>>>>>        Set Main_File to Mhxanik.File_Number
51907>>>>>>>        Set Size to 105 415
51908>>>>>>>        Set Location to 6 6
51909>>>>>>>
51909>>>>>>>        Begin_Row
51912>>>>>>>            Entry_Item Mhxanik.Mhx_id
51913>>>>>>>            Entry_Item Mhxanik.Mhx_name
51914>>>>>>>            Entry_Item Mhxanik.Mhx_afm
51915>>>>>>>            Entry_Item Mhxanik.Mhx_address
51916>>>>>>>            Entry_Item Mhxanik.Mhx_phone
51917>>>>>>>        End_Row
51922>>>>>>>
51922>>>>>>>        Set Form_Width    item 0 to 70
51923>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
51924>>>>>>>        
51924>>>>>>>        Set Form_Width    item 1 to 100
51925>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
51926>>>>>>>        
51926>>>>>>>        Set Form_Width    item 2 to 50
51927>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
51928>>>>>>>        
51928>>>>>>>        Set Form_Width    item 3 to 135
51929>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
51930>>>>>>>        
51930>>>>>>>        Set Form_Width    item 4 to 52
51931>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
51932>>>>>>>        
51932>>>>>>>    End_Object    // oSelList
51933>>>>>>>
51933>>>>>>>    Object oOK_bn is a ButtonSub
51935>>>>>>>        Set Label to "&„§ ¢¦šã"
51936>>>>>>>        Set Location to 113 263
51937>>>>>>>
51937>>>>>>>        //AB-StoreStart
51937>>>>>>>        Procedure OnClick
51939>>>>>>>            Send OK To (oSelList(current_object))
51940>>>>>>>        End_Procedure
51941>>>>>>>        //AB-StoreEnd
51941>>>>>>>
51941>>>>>>>    End_Object    // oOK_bn
51942>>>>>>>
51942>>>>>>>    Object oCancel_bn is a ButtonSub
51944>>>>>>>        Set Label to "&€¡ç¨à©ž"
51945>>>>>>>        Set Location to 113 317
51946>>>>>>>
51946>>>>>>>        //AB-StoreStart
51946>>>>>>>        Procedure OnClick
51948>>>>>>>            Send Cancel To (oSelList(current_object))
51949>>>>>>>        End_Procedure
51950>>>>>>>        //AB-StoreEnd
51950>>>>>>>
51950>>>>>>>    End_Object    // oCancel_bn
51951>>>>>>>
51951>>>>>>>    Object oSearch_bn is a ButtonSub
51953>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
51954>>>>>>>        Set Location to 113 373
51955>>>>>>>
51955>>>>>>>        //AB-StoreStart
51955>>>>>>>        Procedure OnClick
51957>>>>>>>            Send Search To (oSelList(current_object))
51958>>>>>>>        End_Procedure
51959>>>>>>>        //AB-StoreEnd
51959>>>>>>>
51959>>>>>>>    End_Object    // oSearch_bn
51960>>>>>>>
51960>>>>>>>
51960>>>>>>>    //AB-StoreStart
51960>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
51961>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
51962>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
51963>>>>>>>    //AB-StoreEnd
51963>>>>>>>
51963>>>>>>>End_Object    // sl055
51964>>>>>>>
51964>>>>>>>//AB/ End_Object    // prj
51964>>>>>Use sl198.sl         // sl198
51964>>>>>Use sl197.SL         // sl197
51964>>>>>
51964>>>>>//DDB-Selection-pkg-End
51964>>>>>//DDB-FileEnd
51964>>>Use Constrct.dd
51964>>>Use Salesmen.dd
51964>>>
51964>>>//Use bp2ndCop.dg
51964>>>//Use bpACopen.dg
51964>>>
51964>>>
51964>>>//AB-StoreTopEnd
51964>>>
51964>>>//AB-IgnoreStart
51964>>>
51964>>>Use dbView.Sub
51964>>>Use DFAllEnt.pkg
51964>>>Use Form.Sub
51964>>>Use Button.Sub
51964>>>Use Txtbox.Sub
51964>>>Use Rgroup.Sub
51964>>>Use Radio.Sub
51964>>>
51964>>>//AB-IgnoreEnd
51964>>>
51964>>>ACTIVATE_VIEW Activate_tAxio FOR tAxio
51968>>>
51968>>>Object tAxio is a dbViewSub
51970>>>
51970>>>    //AB-StoreTopStart
51970>>>
51970>>>    Property Integer piLathos   Public   0
51972>>>    Property String  psModule   Public '01'
51974>>>    Property Integer piWhat     Public   0
51976>>>
51976>>>    Open Sysrecc
51978>>>    Open SysCurXR
51980>>>    Open Year
51982>>>
51982>>>
51982>>>    //////////////////////////////////////////////////////
51982>>>    // DataDictionary Structure needed for making Barticle
51982>>>    //////////////////////////////////////////////////////
51982>>>
51982>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
51984>>>    End_Object    // Ctypkin_DD
51985>>>
51985>>>    Object Country_DD is a Country_DataDictionary
51987>>>    End_Object    // Country_DD
51988>>>
51988>>>    Object Towns_DD is a Towns_DataDictionary
51990>>>        Set DDO_Server to (Country_DD(self))
51991>>>    End_Object    // Towns_DD
51992>>>
51992>>>    Object Cities_DD is a Cities_DataDictionary
51994>>>        Set DDO_Server to (Towns_DD(self))
51995>>>    End_Object    // Cities_DD
51996>>>
51996>>>    Object Payresp_DD is a Payresp_DataDictionary
51998>>>    End_Object    // Payresp_DD
51999>>>
51999>>>
51999>>>    Object Constrct_DD is a Constrct_DataDictionary
52001>>>    End_Object    // Constrct_DD
52002>>>
52002>>>    Object Salesmen_DD is a Salesmen_DataDictionary
52004>>>    End_Object    // Salesmen_DD
52005>>>
52005>>>    Object Mhxanik_DD is a Mhxanik_DataDictionary
52007>>>    End_Object    // Mhxanik_DD
52008>>>
52008>>>    Object Areas_DD is a Areas_DataDictionary
52010>>>    End_Object    // Areas_DD
52011>>>
52011>>>    Object Btypkin_DD is a Btypkin_DataDictionary
52013>>>        Set Foreign_Field_Options DD_KEYFIELD           to DD_Clear_Field_Options DD_FindReq
52014>>>        Set Foreign_Field_Options DD_INDEXFIELD         to DD_Clear_Field_Options DD_FindReq
52015>>>        Set Field_Options Field Btypkin.Btypkin_Code    to DD_Clear_Field_Options DD_Required
52016>>>    End_Object    // Btypkin_DD
52017>>>
52017>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
52019>>>    End_Object    // Baxiokat_DD
52020>>>
52020>>>    Object Barticl_DD is a Barticl_DataDictionary
52022>>>        Set DDO_Server to (Btypkin_DD(self))
52023>>>    End_Object    // Barticl_DD
52024>>>
52024>>>    Object Bsum_DD is a Bsum_DataDictionary
52026>>>        Set DDO_Server to (Barticl_DD(self))
52027>>>        Set Constrain_File to Barticl.File_Number
52028>>>    End_Object    // Bsum_DD
52029>>>
52029>>>    Object Baxio_DD is a Baxio_DataDictionary
52031>>>        Set DDO_Server to (Baxiokat_DD(self))
52032>>>        Set allow_foreign_new_save_state to true
52033>>>    End_Object    // Baxio_DD
52034>>>
52034>>>    Object Syscurxr_DD is a Syscurxr_DataDictionary
52036>>>    End_Object    // Syscurxr_DD
52037>>>
52037>>>    Object Clients_DD is a Clients_DataDictionary
52039>>>        Set DDO_Server to (Cities_DD(self))
52040>>>        Set DDO_Server to (Payresp_DD(self))
52041>>>        Set DDO_Server to (Areas_DD(self))
52042>>>    End_Object    // Clients_DD
52043>>>
52043>>>    Object Cn_DD is a Cn_DataDictionary
52045>>>        Set DDO_Server to (Clients_DD(self))
52046>>>        Set DDO_Server to (Constrct_DD(self))
52047>>>        Set DDO_Server to (Salesmen_DD(self))
52048>>>        Set DDO_Server to (Mhxanik_DD(self))
52049>>>    End_Object    // Cn_DD
52050>>>
52050>>>    Object Tperga_DD is a Tperga_DataDictionary
52052>>>        Set DDO_Server to (CN_DD(self))
52053>>>        Set DDO_Server to (Baxiokat_DD(self))
52054>>>        Set Constrain_File to CN.File_Number
52055>>>    End_Object    // Btnordd_DD
52056>>>
52056>>>    Object Bmove_DD is a Bmove_DataDictionary
52058>>>        Set DDO_Server to (Barticl_DD(self))
52059>>>        Set DDO_Server to (Baxio_DD(self))
52060>>>        Set Constrain_File to Barticl.File_Number
52061>>>    End_Object    // Bmove_DD
52062>>>
52062>>>    Object Cmoves_DD is a Cmoves_DataDictionary
52064>>>        Set DDO_Server to (Ctypkin_DD(self))
52065>>>        Set DDO_Server to (Clients_DD(self))
52066>>>        Set Constrain_File to Clients.File_Number
52067>>>        Set piFromBP to True
52068>>>    End_Object    // Cmoves_DD
52069>>>
52069>>>    Object Btnordh_DD is a Btnordh_DataDictionary
52071>>>        Set DDO_Server to (Cn_DD(self))
52072>>>        Set Constrain_File to Cn.File_Number
52073>>>        Send DefineAllExtendedFields
52074>>>    End_Object    // Btnordh_DD
52075>>>
52075>>>    Object Btnordd_DD is a Btnordd_DataDictionary
52077>>>        Set DDO_Server to (Btnordh_DD(self))
52078>>>        Set Constrain_File to Btnordh.File_Number
52079>>>    End_Object    // Btnordd_DD
52080>>>
52080>>>    //////////////////////////////////////////////////////
52080>>>    // DataDictionary Structure needed for making Barticle
52080>>>    //////////////////////////////////////////////////////
52080>>>
52080>>>
52080>>>    //AB-StoreTopEnd
52080>>>
52080>>>    Set Label to "ƒž£ ¦¬¨šå˜ „šš¨˜­é¤ - ‚â­¬¨œª"
52081>>>    Set Size to 167 451
52082>>>    Set Location to 9 7
52083>>>
52083>>>    //AB-DDOStart
52083>>>
52083>>>
52083>>>    //AB-DDOEnd
52083>>>
52083>>>    Object oOpenFile is a OpenDialog
52085>>>        Set Location to 2 407
52086>>>
52086>>>        //AB-StoreStart
52086>>>        Set Filter_String   to 'Text Files|*.txt|All Files|*.*'
52087>>>        Set Initial_Folder  to 'C:\VDF6\Develop\Empor'
52088>>>        Set Filter_Index    to 1
52089>>>
52089>>>        //AB-StoreEnd
52089>>>
52089>>>    End_Object    // oOpenFile
52090>>>
52090>>>    Object frmFileName is a FormSub
52092>>>        Set Size to 13 321
52093>>>        Set Location to 6 63
52094>>>        Set Label_Col_Offset to 2
52095>>>        Set Label_Justification_Mode to jMode_Right
52096>>>        Set Prompt_Button_Mode to pb_PromptOn
52097>>>
52097>>>        //AB-StoreStart
52097>>>
52097>>>        Procedure Prompt
52099>>>            String  sFileName
52100>>>            Integer bOpen
52100>>>            Get Show_Dialog of oOpenFile To bOpen
52101>>>            If bOpen Begin
52103>>>                Get File_Name of oOpenFile to sFileName
52104>>>                If (Trim(sFileName)<>'') Set Value Item 0 to sFileName
52107>>>            End
52107>>>>
52107>>>        End_Procedure
52108>>>
52108>>>
52108>>>        //AB-StoreEnd
52108>>>
52108>>>    End_Object    // frmFileName
52109>>>
52109>>>    Object ButtonSub1 is a ButtonSub
52111>>>
52111>>>        //AB-StoreTopStart
52111>>>
52111>>>        //AB-StoreTopEnd
52111>>>
52111>>>        Set Label to "„§œ¥œ¨š˜©å˜"
52112>>>        Set Size to 14 218
52113>>>        Set Location to 131 114
52114>>>
52114>>>        //AB-StoreStart
52114>>>
52114>>>        Procedure OnClick
52116>>>            String  sFile sFile2 sLabel
52117>>>            Integer iFileExists iCheckAfm
52117>>>            Get label to slabel
52118>>>            Set Enabled_State to False
52119>>>
52119>>>            Move Sysfile.Check_Afm to iCheckAfm
52120>>>
52120>>>            If (iCheckAFM) Begin
52122>>>                Reread Sysfile
52126>>>                Move 0 to Sysfile.Check_Afm
52127>>>                Saverecord Sysfile
52128>>>                Unlock
52129>>>>
52129>>>            End
52129>>>>
52129>>>
52129>>>            Get Value Of frmFileName item 0 to sFile
52130>>>            Move (Trim(UpperCase(sFile)))   to sFile
52131>>>            If (sFile<>'') Begin
52133>>>                Get Get_File_Exists sFile   To iFileExists
52134>>>                If (NOT(iFileExists)) Begin
52136>>>                    Send Stop_Box "ƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦." "‘­á¢£˜ 1001"
52137>>>                    Set Enabled_State to True
52138>>>                    Procedure_Return
52139>>>                End
52139>>>>
52139>>>
52139>>>                     If (piWhat(Self)=0) Send Make_Payresp_Record   sFile
52142>>>                Else If (piWhat(Self)=1) Send Read_Pelates          sFile
52146>>>                Else If (piWhat(Self)=2) Send Read_Erga             sFile
52150>>>                Else If (piWhat(Self)=3) Send Read_Deop             sFile
52154>>>                Else If (piWhat(Self)=4) Send Read_Kinhseis         sFile
52158>>>
52158>>>        //        Move (fsReturnFileFromPath(sFile)) to sFile2
52158>>>
52158>>>        //             If (sFile2='PELATES.TXT' ) Send Read_Pelates   sFile
52158>>>        //        Else If (sFile2='PELATES1.TXT') Send Read_Pelates   sFile
52158>>>        //        Else If (sFile2='KINHSEIS.TXT') Send Read_Kinhseis  sFile
52158>>>        //        Else If (sFile2='KINHSEIS1.TXT') Send Read_Kinhseis  sFile
52158>>>        //        Else If (sFile2='KINHSEIS2.TXT') Send Read_Kinhseis  sFile
52158>>>        //        Else If (sFile2='KINHSEIS3.TXT') Send Read_Kinhseis  sFile
52158>>>        //        Else If (sFile2='KINHSEIS4.TXT') Send Read_Kinhseis  sFile
52158>>>        //        Else If (sFile2='KINH40.TXT')    Send Read_Kinhseis  sFile
52158>>>        //        Else If (sFile2='KINHSEIS5.TXT') Send Read_Kinhseis  sFile
52158>>>        //        Else If (sFile2='KINHSEIS6.TXT') Send Read_Kinhseis  sFile
52158>>>        //        Else If (sFile2='PELWRK.TXT'  ) Send Read_Erga      sFile
52158>>>        //        Else If (sFile2='PELWRK1.TXT' ) Send Read_Erga      sFile
52158>>>        //        Else If (sFile2='PELDEOP.TXT' ) Send Read_Deop      sFile
52158>>>        //        Else If (sFile2='PELDEOP1.TXT') Send Read_Deop      sFile
52158>>>        //        Else If (sFile2='PELDEOP2.TXT') Send Read_Deop      sFile
52158>>>        //        Else If (sFile2='PELDEOP3.TXT') Send Read_Deop      sFile
52158>>>        //        Else If (sFile2='PELDEOP4.TXT') Send Read_Deop      sFile
52158>>>        //        Else If (sFile2='VISA.TXT'    ) Send Make_Payresp_Record   sFile
52158>>>
52158>>>                Send Info_Box "† ƒ ˜› ¡˜©å˜ «œ¢œåà©œ" "¢ž¨¦­¦¨å˜"
52159>>>            End
52159>>>>
52159>>>            Else Send Stop_Box 'ƒœ¤ §¨¦©› ¦¨å©˜«œ §¦¬ ™¨å©¡œ«œ «¦ ˜¨®œå¦' '‘­á¢£˜ 1002'
52161>>>
52161>>>            If (iCheckAFM) Begin
52163>>>                Reread Sysfile
52167>>>                Move 1 to Sysfile.Check_Afm
52168>>>                Saverecord Sysfile
52169>>>                Unlock
52170>>>>
52170>>>            End
52170>>>>
52170>>>
52170>>>            Set Label Of ButtonSub1 to sLabel
52171>>>            Set Enabled_State to True
52172>>>        End_Procedure // OnClick
52173>>>
52173>>>
52173>>>        Function Make_Payresp   String asArmodios       ;                                String asArmodiosAdd    ;                                String asArmodiosLoipa  ;                                String asAFM            ;                                String asDOY            ;                                String asPrespCode      ;                                Returns String
52175>>>            Integer isFound iLen
52176>>>            String  sID
52176>>>
52176>>>            Move 0  to isFound
52177>>>            Move '' to sID
52178>>>
52178>>>            Move (Trim(asArmodios     ))    to asArmodios
52179>>>            Move (Trim(asArmodiosAdd  ))    to asArmodiosAdd
52180>>>            Move (Trim(asArmodiosLoipa))    to asArmodiosLoipa
52181>>>            Move (Trim(asAFM          ))    to asAFM
52182>>>            Move (Trim(asDOY          ))    to asDOY
52183>>>            Move (Trim(asPrespCode    ))    to asPrespCode
52184>>>
52184>>>            Move (Length(asArmodiosAdd))    to iLen
52185>>>
52185>>>            // 1. Elegxos an yparxei bash kodikou
52185>>>            //    Teleytaio pedio arxeio Pelates.txt
52185>>>            //    21/12/2002
52185>>>            Clear Payresp
52186>>>            Move asPrespCode to Payresp.Presp_Codem
52187>>>            Find Ge Payresp By Index.8 // Presp_Codem+Presp_ID
52188>>>>
52188>>>            If ((Found=1) And (Payresp.Presp_Codem=asPrespCode)) ;                Function_Return Payresp.Presp_ID
52191>>>
52191>>>            // 2. An den vrethei elegxos bash eponymias
52191>>>            Clear Payresp
52192>>>            Move asArmodios to Payresp.Presp_Name
52193>>>            Find Gt Payresp by Index.3 // Presp_Name+Presp_Recr
52194>>>>
52194>>>            While ((Found) And (Payresp.Presp_Name=asArmodios) And (isFound=0))
52198>>>                If ((Left(Payresp.Presp_Address,iLen))=asArmodiosAdd) Begin
52200>>>                    Move 1                  to isFound
52201>>>                    Move Payresp.Presp_ID   to sID
52202>>>                End
52202>>>>
52202>>>                Find Gt Payresp by Index.3 // Presp_Name+Presp_Recr
52203>>>>
52203>>>            Loop
52204>>>>
52204>>>
52204>>>            If (isFound) Function_Return sID
52207>>>
52207>>>            // Make the new record
52207>>>            Clear Payresp
52208>>>            Move (Sysrecc.Payresp_Rec0+1)   to Payresp.Presp_Rec0
52209>>>            Move (Sysrecc.Payresp_Rec0+1)   to Sysrecc.Payresp_Rec0
52210>>>            Saverecord Sysrecc
52211>>>            Move (Append('',((Trim(SysCurXR.Branch_Site))+;                             (Trim(String(payresp.presp_Rec0))))));                                            to payresp.presp_Recr
52212>>>
52212>>>            Get fsgCode_With_Zeroes Payresp.Presp_Rec0      ;                                    Sysfile.Client_Digits   ;                                    SysCurXr.Company_Code   ;                                    SysCurXr.Branch_Code    ;                                            to Payresp.Presp_ID
52213>>>
52213>>>            Move Payresp.Presp_ID           to sID
52214>>>
52214>>>            Clear Year
52215>>>            Move Syscurxr.Branch_Code       to Year.Branch_Code
52216>>>            Move Syscurxr.Company_Code      to Year.Company_Code
52217>>>            Move Syscurxr.Year_Year         to Year.Year_Year
52218>>>            Find Eq Year By Index.1
52219>>>>
52219>>>            If (Found=1) Begin
52221>>>                Move Year.Payresp_Plafon    to Payresp.Plafon
52222>>>                Move Year.Payresp_Ofeilh    to Payresp.Orio_Syn_Ofeilh
52223>>>            End
52223>>>>
52223>>>
52223>>>            Move SysCurXr.Company_Code      to Payresp.Company_Code
52224>>>            Move SysCurXr.Branch_Code       to Payresp.Branch_Code
52225>>>            Move SysCurXr.Year_Year         to Payresp.Year_Year
52226>>>            Move Syscurxr.Beto_Site         to Payresp.Presp_Sitew
52227>>>            Move Payresp.Presp_Rec0         to Payresp.Presp_Sn
52228>>>            Move Payresp.Presp_Id           to Payresp.Presp_Repm
52229>>>            Move '1'                        to Payresp.Presp_Active
52230>>>
52230>>>            Move asArmodios                 to Payresp.Presp_Name
52231>>>            Move asArmodiosAdd              to Payresp.Presp_Address
52232>>>            Move asArmodiosLoipa            to Payresp.Presp_Phone
52233>>>            Move asAFM                      to Payresp.Presp_AFM
52234>>>            //Move asDOY                      to Payresp.Presp_DOY
52234>>>            Move asPrespCode                to Payresp.Presp_Codem
52235>>>
52235>>>            Saverecord Payresp
52236>>>            Function_Return sID
52237>>>        End_Function // Make_Payresp
52238>>>
52238>>>        Procedure Make_Payresp_Record String asFile
52240>>>            String  sLine sPrespcode  sPrespName sID
52241>>>            Integer iInt1
52241>>>            Direct_Input Channel 1 asFile
52243>>>
52243>>>            Readln Channel 1 sLine
52245>>>
52245>>>            While (Not(Seqeof))
52249>>>                Move (Mid(sLine,06, 01  ))  to sPrespCode
52250>>>                Move (Mid(sLine,25, 12  ))  to sPrespName
52251>>>
52251>>>                Move (Trim(sPrespCode))     to sPrespCode
52252>>>                Move (Trim(sPrespName))     to sPrespName
52253>>>
52253>>>                Add 1                       to iInt1
52254>>>                Set Label Of ButtonSub1     to (String(iInt1))
52255>>>
52255>>>                If (sPrespName='') Goto Read_Presp_Next
52258>>>
52258>>>                Clear Payresp
52259>>>                Move sPrespCode to Payresp.Presp_Codem
52260>>>                Find Ge Payresp By Index.8 // Presp_Codem+Presp_ID
52261>>>>
52261>>>                If ((Found=1) And (Payresp.Presp_Codem=sPrespCode)) Goto Read_Presp_Next
52264>>>
52264>>>                // Make the new record
52264>>>                Clear Payresp
52265>>>                Move sPrespCode to Payresp.Presp_Codem
52266>>>                Move sPrespName to Payresp.Presp_Name
52267>>>
52267>>>                Move (Sysrecc.Payresp_Rec0+1)   to Payresp.Presp_Rec0
52268>>>                Move (Sysrecc.Payresp_Rec0+1)   to Sysrecc.Payresp_Rec0
52269>>>                Saverecord Sysrecc
52270>>>                Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                (Trim(String(payresp.presp_Rec0))))));                                                to payresp.presp_Recr
52271>>>
52271>>>                Get fsgCode_With_Zeroes Payresp.Presp_Rec0      ;                                        Sysfile.Client_Digits   ;                                        SysCurXr.Company_Code   ;                                        SysCurXr.Branch_Code    ;                                                to Payresp.Presp_ID
52272>>>
52272>>>                Move Payresp.Presp_ID           to sID
52273>>>
52273>>>                Clear Year
52274>>>                Move Syscurxr.Branch_Code       to Year.Branch_Code
52275>>>                Move Syscurxr.Company_Code      to Year.Company_Code
52276>>>                Move Syscurxr.Year_Year         to Year.Year_Year
52277>>>                Find Eq Year By Index.1
52278>>>>
52278>>>                If (Found=1) Begin
52280>>>                    Move Year.Payresp_Plafon    to Payresp.Plafon
52281>>>                    Move Year.Payresp_Ofeilh    to Payresp.Orio_Syn_Ofeilh
52282>>>                End
52282>>>>
52282>>>
52282>>>                Move SysCurXr.Company_Code      to Payresp.Company_Code
52283>>>                Move SysCurXr.Branch_Code       to Payresp.Branch_Code
52284>>>                Move SysCurXr.Year_Year         to Payresp.Year_Year
52285>>>                Move Syscurxr.Beto_Site         to Payresp.Presp_Sitew
52286>>>                Move Payresp.Presp_Rec0         to Payresp.Presp_Sn
52287>>>                Move Payresp.Presp_Id           to Payresp.Presp_Repm
52288>>>                Move '1'                        to Payresp.Presp_Active
52289>>>
52289>>>                Saverecord Payresp
52290>>>
52290>>>                Read_Presp_Next:
52290>>>                Readln Channel 1 sLine
52292>>>            Loop
52293>>>>
52293>>>            Set Label Of ButtonSub1 to ''
52294>>>            Close_output Channel 1
52296>>>        End_Procedure
52297>>>
52297>>>
52297>>>        Procedure Read_Deop String asFile
52299>>>
52299>>>            Set_Argument_Size 1024
52300>>>>
52300>>>            // €¤œ¥á¨«ž«œª ‹œ«˜™¢ž«âª
52300>>>            String  sLine sToAnsi sClientID
52301>>>            Integer iLathos iInt1
52301>>>            //String  sVorderbt sVitem sDeopDate sVclientid svcncode svitem sarxhdate
52301>>>
52301>>>            /////////////////////////
52301>>>
52301>>>            // ‹œ«˜™¢ž«âª §œ›åà¤
52301>>>            Local String  sDeop sKodPel sKodErgo sEidos
52301>>>            Local String  sOroiPlhromhs sSxolia sSynPlyn sCNCode sSN
52301>>>            Number  nM3 nTimhM3 iElleiph  iPagioAntlias
52301>>>            Integer iHmeresApoTim iZonh itropoi
52301>>>            Date    dHmniaEkdoshs dEnarxh dLhxh
52301>>>
52301>>>            Move 0 to iInt1
52302>>>
52302>>>            Append_Output Channel 9 'C:\Titan_Kinhseis_Error.txt'
52304>>>
52304>>>            Direct_Input Channel 1 asFile
52306>>>            Readln Channel 1 sLine
52308>>>            While (Not(Seqeof))
52312>>>
52312>>>                Move (Mid(sLine,10, 01  ))  to sDeop
52313>>>                Move (Mid(sLine,05, 11  ))  to sKodPel
52314>>>                Move (Mid(sLine,05, 16  ))  to sKodErgo
52315>>>                Move (Mid(sLine,08, 21  ))  to sEidos
52316>>>                Move (Mid(sLine,08, 29  ))  to nM3
52317>>>                Move (Mid(sLine,10, 37  ))  to nTimhM3
52318>>>                Move (Mid(sLine,02, 47  ))  to iHmeresApoTim
52319>>>                Move (Mid(sLine,03, 49  ))  to sOroiPlhromhs
52320>>>                Move (Mid(sLine,08, 52  ))  to dHmniaEkdoshs
52321>>>                Move (Mid(sLine,08, 60  ))  to dEnarxh
52322>>>                //Move (Mid(sLine,08, 68  ))  to dLhxh
52322>>>
52322>>>                // Tolis 14/04/2003
52322>>>                Move '31/12/2002'           to dLhxh
52323>>>                //
52323>>>
52323>>>                Move (Mid(sLine,02, 76  ))  to iZonh
52324>>>                Move (Mid(sLine,06, 78  ))  to iElleiph
52325>>>                Move (Mid(sLine,06, 84  ))  to iPagioAntlias
52326>>>                Move (Mid(sLine,04, 90  ))  to sSynPlyn
52327>>>                Move (Mid(sLine,63, 94  ))  to sSxolia
52328>>>
52328>>>                Move (Trim(sKodPel      ))  to sKodPel
52329>>>                Move (Trim(sKodErgo     ))  to sKodErgo
52330>>>                Move (Trim(sDeop        ))  to sDeop
52331>>>                Move (Trim(sEidos       ))  to sEidos
52332>>>                Move (Trim(sOroiPlhromhs))  to sOroiPlhromhs
52333>>>                Move (Trim(sSxolia      ))  to sSxolia
52334>>>
52334>>>                Add 1 to iInt1
52335>>>                Set Label Of ButtonSub1 to (String(iInt1))
52336>>>                if (dlhxh<'01/01/2000') goto read_deop_next
52339>>>
52339>>>
52339>>>                Send Clear to CN_DD
52340>>>                Move (Trim(sKodPel+sKodErgo)) to CN.CN_CodeMatch  // 1151700001
52341>>>                Send Find to CN_DD GE 8 // CN_CodeMatch+CN_Code
52342>>>                If (NOT((Found) And (CN.CN_CodeMatch=Trim(sKodPel+sKodErgo)))) Begin
52344>>>                    Writeln Channel 9 'ƒ„Ž     - Record #' (String(iInt1)) '    CN.CN_CODEMATCH=' (Trim(sKodPel+sKodErgo))
52350>>>                    Goto Read_Deop_Next
52351>>>>
52351>>>                End
52351>>>>
52351>>>
52351>>>                Get fsgCode_With_Zeroes Cn.Cn_SN                ;                                        Sysfile.Client_Digits   ;                                        SysCurXr.Company_Code   ;                                        SysCurXr.Branch_Code    ;                                                    to sSN
52352>>>                Get fsgStripCodeFromID sSN to sSN
52353>>>                Move (Trim(sKodPel)+(Trim(sSN)))    to sCNCode
52354>>>
52354>>>
52354>>>                Begin_Transaction
52355>>>                    Lock
52356>>>>
52356>>>
52356>>>                    Clear btnordh
52357>>>                    Move (Trim(sCNCode)) to btnordh.AA_Deop
52358>>>                    Find Ge Btnordh by index.1
52359>>>>
52359>>>
52359>>>                    If ((Found=1) And (Left(btnordh.AA_Deop,10)=(Trim(sCNCode)))) Begin
52361>>>                        Send Find_By_Recnum to Btnordh_DD Btnordh.File_Number Btnordh.Recnum
52362>>>                    End
52362>>>>
52362>>>                    Else Begin
52363>>>                        Send Clear to btnordh_DD
52364>>>                        Set Field_Changed_Value Of Btnordh_DD Field Btnordh.AA_Deop     to sDeop
52365>>>                        Set Field_Changed_Value Of Btnordh_DD Field Btnordh.Sxolia      to sSxolia
52366>>>                        Set Field_Changed_Value Of Btnordh_DD Field Btnordh.Deop_Date   to dEnarxh
52367>>>                        Set Field_Changed_Value Of Btnordh_DD Field Btnordh.Eleiph      to iElleiph
52368>>>                        Set Field_Changed_Value Of Btnordh_DD Field Btnordh.Date_Create to dHmniaEkdoshs
52369>>>                        Set Field_Changed_Value Of Btnordh_DD Field Btnordh.Deop_Lhxh   to dLhxh
52370>>>                        Send Request_Save to Btnordh_DD
52371>>>                    End
52371>>>>
52371>>>
52371>>>                    Send Clear to btnordd_DD
52372>>>                    Set Field_Changed_Value Of btnordd_DD Field btnordd.Vitem       to sEidos
52373>>>                    Set Field_Changed_Value Of btnordd_DD Field btnordd.VQty        to nM3
52374>>>                    Set Field_Changed_Value Of btnordd_DD Field btnordd.VUnitPrice  to nTimhM3
52375>>>                    Set field_changed_value of btnordd_dd field btnordd.vpagiaxrm3  to iPagioAntlias
52376>>>                     If (Trim(sSynPlyn)='ŽŠ€') ;                        Set Field_Changed_Value Of Btnordh_DD Field Btnordh.VELXR   to '2'
52379>>>                    Else If (Trim(sSynPlyn)='€Œ„“') ;                        Set Field_Changed_Value Of Btnordh_DD Field Btnordh.VELXR   to '0'
52383>>>                    Else If (Trim(sSynPlyn)='Š†Œ') ;                        Set Field_Changed_Value Of Btnordh_DD Field Btnordh.VELXR   to '1'
52387>>>
52387>>>                    Send Request_Save to Btnordd_DD
52388>>>
52388>>>                    Send Request_Save to Btnordh_DD
52389>>>
52389>>>                         If (Trim(sOroiPlhromhs)='001') Move 99 to iTropoi
52392>>>                    Else If (Trim(sOroiPlhromhs)='002') Move  1 to iTropoi
52396>>>                    Else If (Trim(sOroiPlhromhs)='003') Move  1 to iTropoi
52400>>>                    Else If (Trim(sOroiPlhromhs)='004') Move  1 to iTropoi
52404>>>                    Else If (Trim(sOroiPlhromhs)='005') Move  1 to iTropoi
52408>>>                    Else If (Trim(sOroiPlhromhs)='006') Move  2 to iTropoi
52412>>>                    Else If (Trim(sOroiPlhromhs)='007') Move  2 to iTropoi
52416>>>                    Else If (Trim(sOroiPlhromhs)='008') Move  2 to iTropoi
52420>>>                    Else If (Trim(sOroiPlhromhs)='009') Move  2 to iTropoi
52424>>>                    Else If (Trim(sOroiPlhromhs)='010') Move 99 to iTropoi
52428>>>                    Else If (Trim(sOroiPlhromhs)='011') Move  1 to iTropoi
52432>>>                    Else If (Trim(sOroiPlhromhs)='012') Move  1 to iTropoi
52436>>>                    Else If (Trim(sOroiPlhromhs)='045') Move  1 to iTropoi
52440>>>
52440>>>                    Clear Tperga
52441>>>                    Move 100        to Tperga.Pct_Epi_Synolou
52442>>>                    Move iTropoi    to Tperga.Baxiokat_Code
52443>>>                    Move CN.Cn_Code to Tperga.Cn_Code
52444>>>                    Find Eq Tperga by index.1
52445>>>>
52445>>>
52445>>>                    If (Not(Found)) Begin
52447>>>                        Send Clear to TPErga_DD
52448>>>                        Move itropoi to Baxiokat.Baxiokat_Code
52449>>>                        Send Request_Find to Baxiokat_DD Eq Baxiokat.File_Number 1
52450>>>                        Set Field_Changed_Value Of TPErga_DD Field Tperga.Pct_Epi_Synolou   to 100
52451>>>                        Set Field_Changed_Value Of TPErga_DD Field Tperga.Paralabh_Meres    to  10
52452>>>                        Set Field_Changed_Value Of TPErga_DD Field Tperga.Xarhtos_Meres     to  10
52453>>>                        Set Field_Changed_Value Of TPErga_DD Field Tperga.Plhroteo_Meres    to  30
52454>>>                        Send Request_Save to Tperga_DD
52455>>>                    End
52455>>>>
52455>>>                End_Transaction
52456>>>
52456>>>                Read_Deop_Next:
52456>>>                Unlock
52457>>>>
52457>>>
52457>>>                Readln Channel 1 sLine
52459>>>            Loop
52460>>>>
52460>>>            Set Label Of ButtonSub1 to ''
52461>>>            Close_Output Channel 9
52463>>>        End_Procedure // Read_Deop
52464>>>
52464>>>
52464>>>        Procedure Read_Pelates String asFile
52466>>>            // €¤œ¥á¨«ž«œª ‹œ«˜™¢ž«âª
52466>>>            String  sLine sClientID
52467>>>            Integer iLathos iNum iInt1 iInt2
52467>>>            /////////////////////////
52467>>>
52467>>>            // ‹œ«˜™¢ž«âª §œ›åà¤
52467>>>            Local String  sKodPel sPelName sAfm sPresp
52467>>>            Local String  sStoixeia  sArmodios sArmodiosAdd sArmodiosLoipa
52467>>>            String  sDOY sPrespID
52467>>>            Integer iXondr iStatus iLastClient
52467>>>            Number  nOrioAnoixto nAnoixto nOrioYpol nYpol
52467>>>            Date    dCreation
52467>>>
52467>>>            Move 0 to iInt1
52468>>>            Move 0 to iInt2
52469>>>
52469>>>            /////////////////////////
52469>>>
52469>>>            Direct_Input Channel 1 asFile
52471>>>            Readln Channel 1 sLine
52473>>>            While (Not(Seqeof))
52477>>>
52477>>>                Move (Mid(sLine,05, 01))    to sKodPel
52478>>>                Move (Mid(sLine,25, 06))    to sPelName
52479>>>                Move (Mid(sLine,09, 31))    to sAFM
52480>>>                Move (Mid(sLine,01, 40))    to iXondr
52481>>>                Move (Mid(sLine,60, 41))    to sStoixeia
52482>>>                Move (Mid(sLine,25,101))    to sArmodios
52483>>>                Move (Mid(sLine,25,126))    to sArmodiosAdd
52484>>>                Move (Mid(sLine,25,151))    to sArmodiosLoipa
52485>>>                Move (Mid(sLine,08,176))    to dCreation
52486>>>                Move (Mid(sLine,26,184))    to sDOY
52487>>>                Move (Mid(sLine,01,210))    to iStatus
52488>>>                Move (Mid(sLine,10,211))    to nOrioAnoixto
52489>>>                Move (Mid(sLine,10,221))    to nAnoixto
52490>>>                Move (Mid(sLine,10,231))    to nOrioYpol
52491>>>                Move (Mid(sLine,10,241))    to nYpol
52492>>>                Move (Mid(sLine,06,251))    to sPresp
52493>>>
52493>>>                Move (Trim(sKodPel))        to sKodPel
52494>>>                Move (Trim(sPelName))       to sPelName
52495>>>                Move (Trim(sAFM))           to sAFM
52496>>>                Move (Trim(sStoixeia))      to sStoixeia
52497>>>                Move (Trim(sArmodios))      to sArmodios
52498>>>                Move (Trim(sArmodiosAdd))   to sArmodiosAdd
52499>>>                Move (Trim(sArmodiosLoipa)) to sArmodiosLoipa
52500>>>                Move (Trim(sDOY))           to sDOY
52501>>>                Move (Trim(sPresp))         to sPresp
52502>>>
52502>>>
52502>>>                Add 1 to iInt1
52503>>>                Set Label Of ButtonSub1 to (String(iInt1))
52504>>>
52504>>>
52504>>>                Clear Clients
52505>>>                Get fsgCode_With_Zeroes sKodPel                 ;                                        5                       ;                                        SysCurXr.Company_Code   ;                                        SysCurXr.Branch_Code    ;                                                to sClientID
52506>>>
52506>>>                Move sClientID                  to Clients.Client_Id
52507>>>                Find Eq Clients By Index.6 // Client_ID
52508>>>>
52508>>>                If (Found) Goto Read_Pel_Next
52511>>>
52511>>>                Clear Clients
52512>>>                Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                 (Trim(sKodPel))))) to Clients.Client_Recr
52513>>>                Find Eq Clients by index.2
52514>>>>
52514>>>                If (Found) Goto Read_Pel_Next
52517>>>
52517>>>
52517>>>                If (sPelName='') Begin
52519>>>                    Writeln Channel 9 'œ¢á«œª     - Record #' (String(iInt1)) '    Client without name  iID=' sKodPel
52525>>>                    Goto Read_Pel_Next
52526>>>>
52526>>>                End
52526>>>>
52526>>>
52526>>>                Clear Clients
52527>>>                Move sKodPel                    to Clients.Client_Rec0
52528>>>                Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                 (Trim(String(Clients.Client_Rec0))))));                                                to Clients.Client_Recr
52529>>>
52529>>>                Move SysCurXR.Company_Code      to Clients.Company_Code
52530>>>                Move SysCurXR.Branch_Code       to Clients.Branch_Code
52531>>>                Move SysCurXR.Year_Year         to Clients.Year_Year
52532>>>
52532>>>                Move '1'                        to Clients.Client_Active
52533>>>
52533>>>                // To iStatus exei times 0=Closed 1=Open ara antistrefoume.
52533>>>                Move (1-iStatus)                to Clients.Client_Locked
52534>>>
52534>>>                Get Make_Payresp sArmodios sArmodiosAdd sArmodiosLoipa sAFM sDOY sPresp ;                                                to sPrespID
52535>>>
52535>>>                Move sClientID                  to Clients.Client_ID
52536>>>                Move sPelName                   to Clients.Client_Name
52537>>>                Move sAFM                       to Clients.Client_AFM
52538>>>                Move sStoixeia                  to Clients.Client_Address
52539>>>                Move sPrespID                   to Clients.Presp_ID
52540>>>                Move dCreation                  to Clients.Client_Hmnia
52541>>>                Move sDOY                       to Clients.Client_DOYBTM
52542>>>                //betolink
52542>>>                Move SysCurXR.Beto_Site         to Clients.Client_Sitew
52543>>>                Move Clients.Client_Rec0        to Clients.Client_Sn
52544>>>                Move Clients.Client_id          to Clients.Client_Repm
52545>>>                Move Clients.Company_Code       to Clients.CLIENT_COMPANY
52546>>>                Move Clients.Client_id          to Clients.Client_RepMatch
52547>>>
52547>>>                Move '1'                        to Clients.is_Client
52548>>>
52548>>>                // Na Dieykrinistei ti paei pou ??????????????????????????????
52548>>>                //Move nOrioAnoixto               to Clients.Plafon
52548>>>                //Move nAnoixto                   to Clients.Orio_Syn_Ofeilh
52548>>>                //Move nOrioYpol                  to Clients.Orio_Syn_Ofeilh
52548>>>                //Move nOrio                      to Clients.Orio_Syn_Ofeilh
52548>>>                // Na Dieykrinistei ti paei pou ??????????????????????????????
52548>>>
52548>>>                Move (Clients.Xreosh-Clients.Pistosh)   ;                                                to Clients.Ypoloipo
52549>>>                Move (Clients.Plafon-Clients.Ypoloipo)  ;                                                to Clients.Overhead
52550>>>                Saverecord Clients
52551>>>
52551>>>                Read_Pel_Next:
52551>>>
52551>>>                Readln Channel 1 sLine
52553>>>            Loop
52554>>>>
52554>>>
52554>>>
52554>>>            Clear Clients
52555>>>            Move '99.ZZ' to Clients.Client_Id
52556>>>            Find LE Clients by index.6 // Client_ID
52557>>>>
52557>>>            If (Found) Begin
52559>>>                Get fsgStripCodeFromID Clients.Client_Id to iNum
52560>>>                Reread
52561>>>                Move iNum to Sysrecc.Client_Rec0
52562>>>                Saverecord Sysrecc
52563>>>                Unlock
52564>>>>
52564>>>            End
52564>>>>
52564>>>
52564>>>            Set Label Of ButtonSub1 to ''
52565>>>
52565>>>        End_Procedure // Read_Pelates
52566>>>
52566>>>
52566>>>        Procedure Read_Erga String asFile
52568>>>            // €¤œ¥á¨«ž«œª ‹œ«˜™¢ž«âª
52568>>>            String  sLine sMatch sClientID
52569>>>            Integer iLathos iInt1
52569>>>            /////////////////////////
52569>>>
52569>>>            // ‹œ«˜™¢ž«âª §œ›åà¤
52569>>>            Local String  sKodPel sKodErgo sAdd1 sAdd2 sAdd3
52569>>>            Local String  sZonh sExpress sBarel sPlate  sMonada sTomeas
52569>>>            Local String  sZonhDescr sDeop1 sDeop2 sDescr
52569>>>            Number       nAxiaTim
52569>>>            Date    dLastDap dStart dEnd
52569>>>
52569>>>            /////////////////////////
52569>>>
52569>>>            Move 0 to iInt1
52570>>>
52570>>>            Append_Output Channel 9 'C:\Titan_Kinhseis_Error.txt'
52572>>>
52572>>>            Direct_Input Channel 1 asFile
52574>>>            Readln Channel 1 sLine
52576>>>            While (Not(Seqeof))
52580>>>
52580>>>                Move (Mid(sLine,05, 01)) to sKodPel
52581>>>                Move (Mid(sLine,05, 06)) to sKodErgo
52582>>>                Move (Mid(sLine,30, 11)) to sAdd1
52583>>>                Move (Mid(sLine,30, 41)) to sAdd2
52584>>>                Move (Mid(sLine,30, 71)) to sAdd3
52585>>>                Move (Mid(sLine,08,101)) to dLastDap
52586>>>                Move (Mid(sLine,02,109)) to sZonh
52587>>>                Move (Mid(sLine,08,111)) to sExpress
52588>>>                Move (Mid(sLine,05,119)) to sBarel
52589>>>                Move (Mid(sLine,10,124)) to sPlate
52590>>>                Move (Mid(sLine,02,134)) to sMonada
52591>>>                Move (Mid(sLine,02,136)) to sTomeas
52592>>>                Move (Mid(sLine,12,138)) to nAxiaTim
52593>>>                Move (Mid(sLine,25,150)) to sZonhDescr
52594>>>                Move (Mid(sLine,30,175)) to sDeop1
52595>>>                Move (Mid(sLine,30,205)) to sDeop2
52596>>>                Move (Mid(sLine,08,235)) to dStart
52597>>>                Move (Mid(sLine,08,243)) to dEnd
52598>>>
52598>>>                Move (Trim(sKodPel     )) to sKodPel
52599>>>                Move (Trim(sKodErgo    )) to sKodErgo
52600>>>                Move (Trim(sAdd1       )) to sAdd1
52601>>>                Move (Trim(sAdd2       )) to sAdd2
52602>>>                Move (Trim(sAdd3       )) to sAdd3
52603>>>                Move (Trim(sDeop1      )) to sDeop1
52604>>>                Move (Trim(sDeop2      )) to sDeop2
52605>>>                Move (Trim(sZonh       )) to sZonh
52606>>>                Move (Trim(sMonada     )) to sMonada
52607>>>                Move (Trim(sTomeas     )) to sTomeas
52608>>>
52608>>>                Add 1 to iInt1
52609>>>                Set Label Of ButtonSub1 to (String(iInt1))
52610>>>
52610>>>                Clear CN
52611>>>                Move (Trim(sKodPel+sKodErgo)) to CN.CN_CodeMatch
52612>>>                Find GE CN By Index.8 // CN_CodeMatch+CN_Code
52613>>>>
52613>>>                If ((Found) And (CN.CN_CodeMatch=Trim(sKodPel+sKodErgo))) ;                    Goto Read_Erg_Next
52616>>>
52616>>>
52616>>>                Clear CN
52617>>>
52617>>>                Lock
52618>>>>
52618>>>
52618>>>                Move (Sysrecc.CN_Rec0+1)   to CN.CN_Rec0
52619>>>                Move (Sysrecc.CN_Rec0+1)   to Sysrecc.CN_Rec0
52620>>>                Saverecord Sysrecc
52621>>>
52621>>>                Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                (Trim(String(Sysrecc.CN_Rec0)))))) to CN.CN_Recr
52622>>>
52622>>>                Get fsgCode_With_Zeroes Sysrecc.CN_Rec0         ;                                        5                       ;                                        SysCurXr.Company_Code   ;                                        SysCurXr.Branch_Code    ;                                                to CN.CN_Code
52623>>>
52623>>>                Move SysCurXR.Company_Code      to CN.Company_Code
52624>>>                Move SysCurXR.Branch_Code       to CN.Branch_Code
52625>>>                Move SysCurXR.Year_Year         to CN.Year_Year
52626>>>                Move SysCurXR.Beto_Site         to CN.Cn_SiteW
52627>>>                Move 'A'                        to CN.CN_Active
52628>>>
52628>>>                // Vres thn eggrafh tou client
52628>>>                Clear Clients
52629>>>                Get fsgCode_With_Zeroes sKodPel                 ;                                        5                       ;                                        SysCurXr.Company_Code   ;                                        SysCurXr.Branch_Code    ;                                                to sClientID
52630>>>                Move sClientID                  to Clients.Client_Id
52631>>>                Find Eq Clients By Index.6 // Client_ID
52632>>>>
52632>>>
52632>>>                If (Not(Found)) Begin
52634>>>                    Writeln Channel 9 '„¨š˜     - Record #' (String(iInt1)) '    Client  not found iID=' (Trim(sClientID))
52640>>>                    Goto Read_Erg_Next
52641>>>>
52641>>>                End
52641>>>>
52641>>>
52641>>>                Move '' to sDescr
52642>>>                Append sDescr (Trim(Clients.Client_Name)) ' (' ;                       (Trim(sAdd1)) ' ' (Trim(sAdd2)) ' ' (Trim(sAdd3))  ')'
52650>>>
52650>>>                Move (Trim(sDescr))             to Cn.Cn_Descr
52651>>>
52651>>>                Move sClientID                  to Cn.Client_id
52652>>>                Move Clients.Presp_ID           to Cn.Cn_Presp_ID
52653>>>                Move Clients.Client_Recr        to Cn.Client_Recr
52654>>>                Move Cn.Cn_Rec0                 to CN.Cn_SN
52655>>>                Move Cn.Client_id               to Cn.Cn_clientid
52656>>>
52656>>>                Move Cn.cn_code                 to CN.CN_RepMatch
52657>>>                Move (Trim(sKodPel+sKodErgo))   to CN.CN_CodeMatch
52658>>>
52658>>>                Move Cn.Cn_Code                 to Cn.Constraction_ID
52659>>>
52659>>>                Saverecord CN
52660>>>
52660>>>                Read_Erg_Next:
52660>>>                Unlock
52661>>>>
52661>>>                Readln Channel 1 sLine
52663>>>            Loop
52664>>>>
52664>>>
52664>>>            Set Label Of ButtonSub1 to ''
52665>>>
52665>>>            Close_Output Channel 9
52667>>>
52667>>>        End_Procedure // Read_Erga
52668>>>
52668>>>
52668>>>        Procedure Read_Kinhseis String asFile
52670>>>            // €¤œ¥á¨«ž«œª ‹œ«˜™¢ž«âª
52670>>>            String  sLine   sClientID sRecr   sError
52671>>>            Integer iLathos iBtypkin  iInt1   iBaxioKat iCmvRec
52671>>>            Integer iError_Object_ID  iRecnum iErr rVal
52671>>>            /////////////////////////
52671>>>
52671>>>            // ‹œ«˜™¢ž«âª §œ›åà¤
52671>>>            Local String  sKinhsh sArPar sEidAxio sUnused sHmnia sKodPel sKodErg sCN
52671>>>            Integer iKodMon iXondr iKodKin1 iKodKin2 iCtypkin
52671>>>            Number  nAxia
52671>>>            Date    dHmParast dHmAxio
52671>>>            /////////////////////////
52671>>>
52671>>>            Move 0 to iInt1
52672>>>
52672>>>            Append_Output Channel 9 'C:\Titan_Kinhseis_Error.txt'
52674>>>
52674>>>            Set piLathos to 0
52675>>>
52675>>>            LOCK
52676>>>>
52676>>>
52676>>>            Move '04' to gs_Module_Code
52677>>>
52677>>>            Direct_Input Channel 1 asFile
52679>>>            Readln Channel 1 sLine
52681>>>            While (Not(Seqeof))
52685>>>                Move (Mid(sLine,30,01)) to sKinhsh
52686>>>                Move (Mid(sLine,10,31)) to sArPar
52687>>>                Move (Mid(sLine,05,41)) to sKodPel
52688>>>                Move (Mid(sLine,05,46)) to sKodErg
52689>>>                Move (Mid(sLine,02,51)) to iKodMon
52690>>>                Move (Mid(sLine,01,53)) to iXondr
52691>>>                Move (Mid(sLine,08,54)) to dHmParast
52692>>>                Move (Mid(sLine,10,62)) to sEidAxio
52693>>>                Move (Mid(sLine,08,72)) to dHmAxio
52694>>>                Move (Mid(sLine,12,80)) to nAxia
52695>>>                Move (Mid(sLine,02,92)) to iKodKin1
52696>>>                Move (Mid(sLine,02,94)) to iKodKin2
52697>>>
52697>>>                Add 1 to iInt1
52698>>>                Set Label Of ButtonSub1 to (String(iInt1))
52699>>>
52699>>>
52699>>>                BEGIN_TRANSACTION
52700>>>                move Error_Object_ID to iError_Object_ID
52701>>>
52701>>>        //               // Mono Kinhseis me kodiko1=09 Plhromh Pelatou)
52701>>>               If (iKodKin1=9) Begin
52703>>>                   Send Clear to Btypkin_DD
52704>>>                   Send Clear to Barticl_DD
52705>>>
52705>>>                        If (iKodKin2=90)   Move 103 to iBtypkin
52708>>>                   Else If (iKodKin2=91)   Move 101 to iBtypkin
52712>>>                   Else If (iKodKin2=92)   Move 100 to iBtypkin
52716>>>                   Else If (iKodKin2=93)   Move 100 to iBtypkin
52720>>>                   Else If (iKodKin2=94)   Move 100 to iBtypkin
52724>>>
52724>>>                   Move SysCurXr.Company_Code  to Btypkin.Company_Code
52725>>>                   Move SysCurXr.Branch_Code   to Btypkin.Branch_Code
52726>>>                   Move SysCurXr.Year_Year     to Btypkin.Year_Year
52727>>>                   Move iBtypkin               to btypkin.Btypkin_Code
52728>>>                   Send Find to Btypkin_DD Eq 1
52729>>>                   If (Not(Found)) Begin
52731>>>                       Set piLathos to 7000
52732>>>                       Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Btypkin not found iBtypkin=' (String(iBtypkin))
52738>>>                       Abort_Transaction
52739>>>                       Goto Read_Next_Kinhsh
52740>>>>
52740>>>                   End
52740>>>>
52740>>>
52740>>>                   Clear Clients
52741>>>                   Get fsgCode_With_Zeroes sKodPel                 ;                                           5                       ;                                           SysCurXr.Company_Code   ;                                           SysCurXr.Branch_Code    ;                                                   to sClientID
52742>>>
52742>>>                   Move sClientID                  to Clients.Client_Id
52743>>>                   Find Eq Clients By Index.6 // Client_ID
52744>>>>
52744>>>                   If (NOT(Found)) Begin
52746>>>                       Set piLathos to 7001
52747>>>                       Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Client not found ID= ' (Trim(sClientID))
52753>>>                       Abort_Transaction
52754>>>                       Goto Read_Next_Kinhsh
52755>>>>
52755>>>                   End
52755>>>>
52755>>>
52755>>>                   Set Field_Changed_Value Of Barticl_DD Field Barticl.Barticl_Hmnia    to dHmParast
52756>>>                   Set Field_Changed_Value Of Barticl_DD Field Barticl.Barticl_Code1    to Clients.Client_ID
52757>>>                   Set Field_Changed_Value Of Barticl_DD Field Barticl.Barticl_Epon1    to Clients.Client_Name
52758>>>                   Set Field_Changed_Value Of Barticl_DD Field Barticl.Barticl_Aitiol   to (Trim(sArPar))
52759>>>                   Set Field_Changed_Value Of Barticl_DD Field Barticl.Barticl_M_Code   to '04'
52760>>>
52760>>>                   Clear CN
52761>>>                   Move (Trim(sKodPel+sKodErg)) to CN.CN_CodeMatch
52762>>>                   Find GE CN By Index.8 // CN_CodeMatch+CN_Code
52763>>>>
52763>>>                   If ((Found) And (CN.CN_CodeMatch=Trim(sKodPel+sKodErg))) ;                       Set Field_Changed_Value Of Barticl_DD Field Barticl.CN_Code to Cn.CN_Code
52766>>>
52766>>>                   Send Request_Save to Barticl_DD
52767>>>
52767>>>                   Send Clear to Baxiokat_DD
52768>>>                   Send Clear to Baxio_DD
52769>>>                   Send Clear to Bmove_DD
52770>>>
52770>>>                        If (iKodKin2=90)   Move 99 to iBaxioKat
52773>>>                   Else If (iKodKin2=91)   Move  2 to iBaxioKat
52777>>>                   Else If (iKodKin2=92)   Move  1 to iBaxioKat
52781>>>                   Else If (iKodKin2=93)   Move  1 to iBaxioKat
52785>>>                   Else If (iKodKin2=94)   Move  1 to iBaxioKat
52789>>>
52789>>>                   Move iBaxioKat  to BaxioKat.Baxiokat_Code
52790>>>                   Send Find       to Baxiokat_DD Eq 1
52791>>>                   If (Not(Found)) Begin
52793>>>                       Set piLathos to 7002
52794>>>                       Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Baxiokat not found ID= ' (String(iBaxioKat))
52800>>>                       Abort_Transaction
52801>>>                       Goto Read_Next_Kinhsh
52802>>>>
52802>>>                   End
52802>>>>
52802>>>
52802>>>                   Set Field_Changed_Value Of Baxio_DD Field Baxio.Baxio_HmniaL    to dHmAxio
52803>>>                   Set Field_Changed_Value Of Baxio_DD Field Baxio.Baxio_C_Code2   to 'EUR'
52804>>>                   Set Field_Changed_Value Of Baxio_DD Field Baxio.Baxio_V2        to nAxia
52805>>>                   Set Field_Changed_Value Of Baxio_DD Field Baxio.Baxio_Ekdoths   to Clients.Client_ID
52806>>>                   Set Field_Changed_Value Of Baxio_DD Field Baxio.Baxio_EkdothsE  to Clients.Client_Name
52807>>>
52807>>>                   Send Request_Save to Bmove_DD
52808>>>
52808>>>                   Get Field_Current_Value Of Barticl_DD Field Barticl.Barticl_Recr to sRecr
52809>>>                   Get Field_Current_Value Of Barticl_DD Field Barticl.Recnum       to iRecnum
52810>>>
52810>>>                   If ((iRecnum) And (sRecr<>'')) Begin
52812>>>                       Set psModule        Of (bpEnCmv3(Self))     to '04'
52813>>>                       Set psBarticleRecr  Of (bpEnCmv3(Self))     to sRecr
52814>>>                       Set piBarticleRecn  Of (bpEnCmv3(Self))     to iRecnum
52815>>>                       Send DoProcess                              to (bpEnCmv3(Self))
52816>>>                       If (Wait(bpEnCmv3(Self))) Send Deactivate   to (Wait(bpEnCmv3(Self)))
52819>>>                   End
52819>>>>
52819>>>               End
52819>>>>
52819>>>               Else Begin
52820>>>                    If (iKodKin1=2) Begin
52822>>>                        // Aytomath Timologhsh
52822>>>                        If (iKodkin2=1) Begin
52824>>>                            // Loipes xreoseis lianikhs
52824>>>                            Move 119 to iCtypkin
52825>>>                        End
52825>>>>
52825>>>                        Else If (iKodkin2=2) Begin
52828>>>                            // Loipes xreoseis xondrikhs
52828>>>                            Move 116 to iCtypkin
52829>>>                        End
52829>>>>
52829>>>                        Else Begin
52830>>>                            Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Kinhsh not found iKodKin2=' (String(iKodKin2))
52836>>>                            Abort_Transaction
52837>>>                            Goto Read_Next_Kinhsh
52838>>>>
52838>>>                        End
52838>>>>
52838>>>                    End
52838>>>>
52838>>>                    Else If (iKodKin1=4) Begin
52841>>>                        // Ap' eytheias -timologhsh
52841>>>                        If (iKodkin2=1) Begin
52843>>>                            // Loipes xreoseis lianikhs
52843>>>                            Move 119 to iCtypkin
52844>>>                        End
52844>>>>
52844>>>                        Else If (iKodkin2=2) Begin
52847>>>                            // Loipes xreoseis xondrikhs
52847>>>                            Move 116 to iCtypkin
52848>>>                        End
52848>>>>
52848>>>                        Else Begin
52849>>>                            Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Kinhsh not found iKodKin2=' (String(iKodKin2))
52855>>>                            Abort_Transaction
52856>>>                            Goto Read_Next_Kinhsh
52857>>>>
52857>>>                        End
52857>>>>
52857>>>                    End
52857>>>>
52857>>>                    Else If (iKodKin1=5) Begin
52860>>>                        // Pistotiko timologio
52860>>>                        If (iKodkin2=3) Begin
52862>>>                            // Epistrofh lianikhs polhshs pistotiko
52862>>>                            Move 121 to iCtypkin
52863>>>                        End
52863>>>>
52863>>>                        Else If (iKodkin2=4) Begin
52866>>>                            // Pistotiko timologio xondrikhs
52866>>>                            Move 121 to iCtypkin
52867>>>                        End
52867>>>>
52867>>>                        Else Begin
52868>>>                            Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Kinhsh not found iKodKin2=' (String(iKodKin2))
52874>>>                            Abort_Transaction
52875>>>                            Goto Read_Next_Kinhsh
52876>>>>
52876>>>                        End
52876>>>>
52876>>>                    End
52876>>>>
52876>>>                    Else If (iKodKin1=8) Begin
52879>>>                        // Flat kinhseis pou mexri tora pernagane
52879>>>                        // san timologia (ara symmetexan sthn MYF gia paradeigma eno
52879>>>                        // den tha eprepe) eno htan xeres xreoseis h pistoseislogo
52879>>>                        // kleisimatos kartellas p.x.
52879>>>                        If (iKodkin2=1) Begin
52881>>>                            // Genikh Xreostikh
52881>>>                            Move 103 to iCtypkin
52882>>>                        End
52882>>>>
52882>>>                        Else If (iKodkin2=2) Begin
52885>>>                            // Genikh Pistotikh
52885>>>                            Move 104 to iCtypkin
52886>>>                        End
52886>>>>
52886>>>                        Else Begin
52887>>>                            Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Kinhsh not found iKodKin2=' (String(iKodKin2))
52893>>>                            Abort_Transaction
52894>>>                            Goto Read_Next_Kinhsh
52895>>>>
52895>>>                        End
52895>>>>
52895>>>                    End
52895>>>>
52895>>>                    Else Begin
52896>>>                        Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Kinhsh not found iKodKin1=' (String(iKodKin1))
52902>>>                        Abort_Transaction
52903>>>                        Goto Read_Next_Kinhsh
52904>>>>
52904>>>                    End
52904>>>>
52904>>>
52904>>>
52904>>>                    Move '' to sCN
52905>>>                    Clear CN
52906>>>                    Move (Trim(sKodPel+sKodErg)) to CN.CN_CodeMatch
52907>>>                    Find GE CN By Index.8 // CN_CodeMatch+CN_Code
52908>>>>
52908>>>                    If ((Found) And (CN.CN_CodeMatch=Trim(sKodPel+sKodErg))) ;                        Move (Trim(CN.CN_Code)) to sCN
52911>>>
52911>>>
52911>>>                    Send Clear to Clients_DD
52912>>>                    Send Clear to Ctypkin_DD
52913>>>
52913>>>                    // Find Second parent Clients
52913>>>                    Clear Clients
52914>>>                    Get fsgCode_With_Zeroes sKodPel                 ;                                            5                       ;                                            SysCurXr.Company_Code   ;                                            SysCurXr.Branch_Code    ;                                                    to sClientID
52915>>>
52915>>>                    Move sClientID                  to Clients.Client_Id
52916>>>                    Send Find to Clients_DD Eq 6 // Client_ID
52917>>>                    If (NOT(Found)) Begin
52919>>>                        Set piLathos to 7004
52920>>>                        Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Client not found ID= ' (Trim(sClientID))
52926>>>                        Abort_Transaction
52927>>>                        Goto Read_Next_Kinhsh
52928>>>>
52928>>>                    End
52928>>>>
52928>>>
52928>>>                    // Find first parent Ctypkin
52928>>>                    Move SysCurXr.Company_Code  to Ctypkin.Company_Code
52929>>>                    Move SysCurXr.Branch_Code   to Ctypkin.Branch_Code
52930>>>                    Move SysCurXr.Year_Year     to Ctypkin.Year_Year
52931>>>                    Move iCtypkin               to Ctypkin.Ctypkin_Code
52932>>>                    Send Find to Ctypkin_DD Eq 1
52933>>>                    If (Not(Found)) Begin
52935>>>                        Set piLathos to 7003
52936>>>                        Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Ctypkin not found iCtypkin=' (String(iCtypkin))
52942>>>                        Abort_Transaction
52943>>>                        Goto Read_Next_Kinhsh
52944>>>>
52944>>>                    End
52944>>>>
52944>>>
52944>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_Hmnia      to dHmParast
52945>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_M_Code     to '01'
52946>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Module_From       to '01'
52947>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_axia       to nAxia
52948>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_par        to (Trim(sArPar))
52949>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_sc_code2   to 'EUR'
52950>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cn_code           to sCN
52951>>>
52951>>>                    Send Request_Save to Cmoves_DD
52952>>>
52952>>>                    Get Field_Current_Value Of Cmoves_DD Field Cmoves.Recnum to iCmvRec
52953>>>
52953>>>                    If (iCmvRec) Begin
52955>>>                        Get Compute_all_Fields iCmvRec 1 to rVal
52956>>>                        If (rVal) Begin
52958>>>                                 If (rVal=1) Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Ctypkin not found in Compute_all_Fields'
52965>>>                            Else If (rVal=2) Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Client  not found in Compute_all_Fields'
52973>>>                            Else If (rVal=3) Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Nomisma not found in Compute_all_Fields'
52981>>>                            Else If (rVal=4) Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Client  not found in Compute_all_Fields'
52989>>>                            Else If (rVal=5) Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Cmoves  not found in Compute_all_Fields'
52997>>>                            Abort_Transaction
52998>>>                            Goto Read_Next_Kinhsh
52999>>>>
52999>>>                        End
52999>>>>
52999>>>                    End
52999>>>>
52999>>>                    Else Begin
53000>>>                        Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Cmoves repositioning not found'
53005>>>                        Abort_Transaction
53006>>>                        Goto Read_Next_Kinhsh
53007>>>>
53007>>>                    End
53007>>>>
53007>>>
53007>>>
53007>>>               End // If iKodkin1=9
53007>>>>
53007>>>
53007>>>               END_TRANSACTION
53008>>>
53008>>>               Move (Err) to iErr
53009>>>               If (iErr) Begin
53011>>>                    Get Error_Text iErr to sError
53012>>>                    Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    ¨¦™¢ž£˜ ˜§¦ « ª ¡¢á©œ ª= ' (String(iErr)) '     ' (Trim(sError))
53020>>>                    Unlock
53021>>>>
53021>>>                    Close_Output Channel 9
53023>>>                    Procedure_Return
53024>>>               End
53024>>>>
53024>>>
53024>>>               Read_Next_Kinhsh:
53024>>>               move iError_Object_ID to Error_Object_ID
53025>>>
53025>>>               Readln Channel 1 sLine
53027>>>            Loop
53028>>>>
53028>>>
53028>>>            UNLOCK
53029>>>>
53029>>>
53029>>>            Set Label Of ButtonSub1 to ''
53030>>>
53030>>>                 If (piLathos(Self)=70000) Send Stop_Box 'Btypkin Not found'  ('# '+(String(iInt1)))
53033>>>            Else If (piLathos(Self)=70001) Send Stop_Box 'Client Not found'   ('# '+(String(iInt1)))
53037>>>            Else If (piLathos(Self)=70002) Send Stop_Box 'Baxiokat Not found' ('# '+(String(iInt1)))
53041>>>
53041>>>
53041>>>            Close_Output Channel 9
53043>>>
53043>>>
53043>>>        End_Procedure // Read_Kinhseis
53044>>>
53044>>>
53044>>>        Function Compute_all_Fields Integer aiRecnum Number aiSign Returns Integer
53046>>>            Integer iErr isClosed iInt iWithDeletion iClient iSign
53047>>>            Integer iOneWflag iiPartlNO iExitFlag iMustSaveWCmoves iMustSaveClientYpoloipa
53047>>>            Integer iMustSaveCmoves iMustSaveClient iMyf iInt2 iOneCflag
53047>>>            Integer iMaxDays iAnameneiSxetiko iExeiSxetika iPartlTimol imustsaveofeilh
53047>>>
53047>>>            String  ssPtypparDescr ssSeiraDescr sWCmovesRecr sRecr2 ssPtypparDescrShort
53047>>>            String  sRecr sParticle_CmovesRecr sCtypkinRecr sCn_Code
53047>>>            String  sClientRecr sCmovesRecr sNomisma sFlag sWtypkinRecr
53047>>>            String  sWitemxRecr sWaxRecr sClientID sPerigrafh sParticle_WCmovesRecr
53047>>>
53047>>>            Number  nVatam nGenAm nExtra nPayam nDiscAm nIsotimia
53047>>>            Number  nTotAmBd nTotDiscPms nTotDiscPC nTotAmAd
53047>>>            Number  nAthr1 nAthr2 nAthr3 nAthr4 nAthr5 nAthr6
53047>>>            Number  nPoso nXre nPis nMyf nPosothta nAthr7 nAthr8
53047>>>
53047>>>            Date    dHmnia dLastPis dLastXre dLastXreParast dLastPisParast
53047>>>            String sModule
53047>>>
53047>>>            Clear Cmoves
53048>>>            Move aiRecnum to Cmoves.Recnum
53049>>>            Find Eq Cmoves.recnum
53050>>>>
53050>>>
53050>>>            If (Found) Begin
53052>>>
53052>>>                Relate Cmoves
53053>>>
53053>>>                Get psModule to sModule
53054>>>
53054>>>                Move 1 to iSign
53055>>>
53055>>>                If ((Cmoves.Module_From=sModule) And (Cmoves.Barticl_Recr='') And (Cmoves.Partl_Recr=''))  Begin
53057>>>
53057>>>                    Move Ctypkin.Ctypkin_Recr   to sCtypkinRecr
53058>>>                    move clients.client_recr    to sclientrecr
53059>>>                    Move Cmoves.Cmoves_sc_code2 to sNomisma
53060>>>                    Move (Trim(sNomisma))       to sNomisma
53061>>>
53061>>>                    If (Trim(sCtypkinRecr)='') Begin
53063>>>                        Function_Return 1
53064>>>                    End
53064>>>>
53064>>>                    Else If (Trim(sClientRecr)='') Begin
53067>>>                        Function_Return 2
53068>>>                    End
53068>>>>
53068>>>                    Else If (Trim(sNomisma)='') Begin
53071>>>                        Function_Return 3
53072>>>                    End
53072>>>>
53072>>>
53072>>>
53072>>>                    Move Cmoves.Cmoves_Hmnia    to dHmnia
53073>>>                    Move Cmoves.Cmoves_Axia     to nPoso
53074>>>
53074>>>                    Move 0 to iOneCflag
53075>>>                    Move 0 to iMustSaveCmoves
53076>>>                    Move 0 to iMustSaveClient
53077>>>                    Move 0 to iMustSaveClientYpoloipa
53078>>>                    Move 0 to iAnameneiSxetiko
53079>>>                    Move 0 to imustsaveofeilh
53080>>>                    Move 0 to iMaxDays
53081>>>
53081>>>                    Clear Cflagkin
53082>>>                    Move sCtypkinRecr           to Cflagkin.Ctypkin_Recr
53083>>>                    Find Gt Cflagkin By Index.5 // Cflagkin:Index.5:Ctypkin_Recr+Flag_Numeric+Cflagkin_Recr
53084>>>>
53084>>>                    While ((Found=1) And (sCtypkinRecr=Cflagkin.Ctypkin_Recr))
53088>>>                        Move 1 to iOneCflag
53089>>>                        Move Cflagkin.Cflagkin_Flag to sFlag
53090>>>                        Move (Trim(sFlag)) to sFlag
53091>>>
53091>>>                        Case Begin
53091>>>                            Case (sFlag='1')
53093>>>                                Move 1 to iMustSaveCmoves
53094>>>                            Case Break
53095>>>                            Case (sFlag='2') // Antistrofh Proshmou
53098>>>                                Move (nPoso*iSign*(-1)) to nPoso
53099>>>                            Case Break
53100>>>                            Case (sFlag='3') // Epireazei xreoseis
53103>>>                                Move (nPoso*iSign)  to nXre
53104>>>                                Move 0              to nPis
53105>>>                            Case Break
53106>>>                            Case (sFlag='4') // Epireazei pistoseis
53109>>>                                Move (nPoso*iSign)  to nPis
53110>>>                                Move 0              to nXre
53111>>>                            Case Break
53112>>>                            Case (sFlag='5') // Epireazei Hmeromhnies
53115>>>                                Move 1 to iMustSaveClient
53116>>>                                If (nXre<>0) Begin
53118>>>                                    Move dHmnia to dLastXre
53119>>>                                    Move dHmnia to dLastXreParast
53120>>>                                    Move ''     to dLastPis
53121>>>                                    Move ''     to dLastPisParast
53122>>>                                End
53122>>>>
53122>>>                                Else If (nPis<>0) Begin
53125>>>                                    Move dHmnia to dLastPis
53126>>>                                    Move dHmnia to dLastPisParast
53127>>>                                    Move ''     to dLastXre
53128>>>                                    Move ''     to dLastXreParast
53129>>>                                End
53129>>>>
53129>>>                            Case Break
53130>>>                            Case (sFlag='6') // Epireazei Hmeromhnia teleytaias paraggelias
53133>>>                            Case Break
53134>>>                            Case (sFlag='7') // Epireazei ekkremh axiografa
53137>>>                            Case Break
53138>>>                            Case (sFlag='8') // Epireazei Diamartyrhmena
53141>>>                            Case Break
53142>>>                            Case (sFlag='9') // Epireazei Tziro
53145>>>                            Case Break
53146>>>                            Case (sFlag='10') // Epireazei Apografh xreoshs
53149>>>                            Case Break
53150>>>                            Case (sFlag='11') // Epireazei Apografh Pistosh
53153>>>                            Case Break
53154>>>                            Case (sFlag='12') // Symmetoxh se MYF (Plythos)
53157>>>                                Move iSign to iMyf
53158>>>                            Case Break
53159>>>                            Case (sFlag='13') // Symmetoxh se MYF (Axia)
53162>>>                                Move (nPoso*iSign)  to nMyf
53163>>>                            Case Break
53164>>>                            Case (sFlag='14') // Axies se Xeno sma
53167>>>                                // Blepe sxetika erothmata sthn arxh ths procedure
53167>>>                            Case Break
53168>>>                            Case (sFlag='15') // Aytomath dhmiourgia axiografou
53171>>>                            Case Break
53172>>>                            Case (sFlag='16') // Allagh XreoPistoshs me antistrofh proshmou
53175>>>                                If (nXre<>0) Begin
53177>>>                                    Move (nXre*(-1))    to nPis
53178>>>                                    Move 0              to nXre
53179>>>                                End
53179>>>>
53179>>>                                Else If (nPis<>0) Begin
53182>>>                                    Move (nPis*(-1))    to nXre
53183>>>                                    Move 0              to nPis
53184>>>                                End
53184>>>>
53184>>>                            Case Break
53185>>>                            Case (sFlag='17') // Afairei apo Myf (akyrotika)
53188>>>                                // Thelei exhghsh ti shmainei 'afairei' ?
53188>>>                                // apo posothta? apo axia? apo allou?
53188>>>                            Case Break
53189>>>                            Case (sFlag='23') // Athroisths 1
53192>>>                                Move (nPoso*iSign) to nAthr1
53193>>>                            Case Break
53194>>>                            Case (sFlag='24') // Athroisths 2
53197>>>                                Move (nPoso*iSign) to nAthr2
53198>>>                            Case Break
53199>>>                            Case (sFlag='25') // Athroisths 3
53202>>>                                Move (nPoso*iSign) to nAthr3
53203>>>                            Case Break
53204>>>                            Case (sFlag='26') // Athroisths 4
53207>>>                                Move (nPoso*iSign) to nAthr4
53208>>>                            Case Break
53209>>>                            Case (sFlag='27') // Athroisths 5
53212>>>                                Move (nPoso*iSign) to nAthr5
53213>>>                            Case Break
53214>>>                            Case (sFlag='28') // Athroisths 6
53217>>>                                Move (nPoso*iSign) to nAthr6
53218>>>                            Case Break
53219>>>                            Case (sFlag='29') // Athroisths 7
53222>>>                                Move (nPoso*iSign) to nAthr7
53223>>>                            Case Break
53224>>>                            Case (sFlag='30') // Athroisths 8
53227>>>                                Move (nPoso*iSign) to nAthr8
53228>>>                            Case Break
53229>>>                            Case (sFlag='50') // Anamenei sxetika
53232>>>                                Move 1 to iAnameneiSxetiko
53233>>>                                Move Ctypkin.Max_Days_Sx_Par to iMaxDays
53234>>>                            Case Break
53235>>>                            Case (sFlag='66') // ephreazei synolikh ofeilh
53238>>>                                Move 1 to iMustSaveofeilh
53239>>>                            Case Break
53240>>>                            Case (sFlag='99') // Enhmeronei Ypoloipa
53243>>>                                Move 1 to iMustSaveClientYpoloipa
53244>>>                            Case Break
53245>>>
53245>>>                        Case End
53245>>>
53245>>>                        Find Gt Cflagkin By Index.5 // Cflagkin:Index.5:Ctypkin_Recr+Flag_Numeric+Cflagkin_Recr
53246>>>>
53246>>>                    Loop
53247>>>>
53247>>>                    If ((iOneCflag) And (iMustSaveCmoves)) Begin
53249>>>                        If (nXre<>0) Begin
53251>>>                            Move nXre to Cmoves.Cmoves_Axia
53252>>>                            If (aiSign=1) Begin
53254>>>                                Add (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Code0,dHmnia,nIsotimia))  to Cmoves.Cmoves_x0
53255>>>                                Add (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Code00,dHmnia,nIsotimia)) to Cmoves.Cmoves_x00
53256>>>                                Add (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Coder,dHmnia,nIsotimia))  to Cmoves.Cmoves_x1
53257>>>                                Add nXre to Cmoves.Cmoves_x2
53258>>>                            End
53258>>>>
53258>>>                            Else Begin
53259>>>                                Sub (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Code0,dHmnia,nIsotimia))  From Cmoves.Cmoves_x0
53260>>>                                Sub (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Code00,dHmnia,nIsotimia)) From Cmoves.Cmoves_x00
53261>>>                                Sub (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Coder,dHmnia,nIsotimia))  From Cmoves.Cmoves_x1
53262>>>                                Sub nXre From Cmoves.Cmoves_x2
53263>>>                            End
53263>>>>
53263>>>                        End
53263>>>>
53263>>>                        Else If (nPis<>0) Begin
53266>>>                            Move nPis to Cmoves.Cmoves_Axia
53267>>>                            If (aiSign=1) Begin
53269>>>                                Add (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Code0,dHmnia,nIsotimia))  to Cmoves.Cmoves_p0
53270>>>                                Add (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Code00,dHmnia,nIsotimia)) to Cmoves.Cmoves_p00
53271>>>                                Add (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Coder,dHmnia,nIsotimia))  to Cmoves.Cmoves_p1
53272>>>                                Add nPis to Cmoves.Cmoves_p2
53273>>>                            End
53273>>>>
53273>>>                            Else Begin
53274>>>                                Sub (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Code0,dHmnia,nIsotimia))  From Cmoves.Cmoves_p0
53275>>>                                Sub (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Code00,dHmnia,nIsotimia)) From Cmoves.Cmoves_p00
53276>>>                                Sub (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Coder,dHmnia,nIsotimia))  From Cmoves.Cmoves_p1
53277>>>                                Sub nPis From Cmoves.Cmoves_p2
53278>>>                            End
53278>>>>
53278>>>                        End
53278>>>>
53278>>>
53278>>>                        Move (Trim(sModule)) to Cmoves.Module_From
53279>>>                        If (Trim(sClientRecr)<>'') Begin
53281>>>                            If (iMustSaveClientYpoloipa =1)  Move '1' to Cmoves.Enhm_Ypol_Pel
53284>>>                            If (iMustSaveClient         =1)  Move '1' to Cmoves.Enhm_Hmnies_Pel
53287>>>                            If (iMustSaveofeilh         =1)  Move '1' to Cmoves.Enhm_ofeilh
53290>>>                        End
53290>>>>
53290>>>                        Else Function_Return 4
53292>>>                        ///an enhmeronei synolikh ofeilh pelath
53292>>>                        if (Cmoves.enhm_ofeilh='1') begin
53294>>>                            Add (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) to Clients.Synolikh_ofeilh
53295>>>                            Add (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) to Payresp.Synolikh_ofeilh
53296>>>                        end
53296>>>>
53296>>>                        If (Cmoves.Enhm_Ypol_Pel='1') Begin
53298>>>                            If (Cmoves.Cmoves_x0<>0) Begin
53300>>>                                Add Cmoves.Cmoves_x0 to Clients.Xreosh
53301>>>                                Add Cmoves.Cmoves_x0 to PayResp.Xreosh
53302>>>                            End
53302>>>>
53302>>>                            Else If (Cmoves.Cmoves_p0<>0) Begin
53305>>>                                Add Cmoves.Cmoves_p0 to Clients.Pistosh
53306>>>                                Add Cmoves.Cmoves_p0 to PayResp.Pistosh
53307>>>                            End
53307>>>>
53307>>>                        End
53307>>>>
53307>>>                        If (Cmoves.Enhm_Hmnies_Pel='1') Begin
53309>>>                            If (Cmoves.Cmoves_x0<>0) Begin
53311>>>                                Move Cmoves.Cmoves_Hmnia   to Clients.Last_Xreosh
53312>>>                                Move Cmoves.Cmoves_Hmnia   to PayResp.Last_Xreosh
53313>>>                            End
53313>>>>
53313>>>                            Else If (Cmoves.Cmoves_p0<>0) Begin
53316>>>                                Move Cmoves.Cmoves_Hmnia   to Clients.Last_Pistosh
53317>>>                                Move Cmoves.Cmoves_Hmnia   to PayResp.Last_Pistosh
53318>>>                            End
53318>>>>
53318>>>                        End
53318>>>>
53318>>>                             If ((Cmoves.Cmoves_M_Code='') And (Cmoves.Module_From  <>'')) Move Cmoves.Module_From     to Cmoves.Cmoves_M_Code
53321>>>                        Else If ((Cmoves.Module_From  ='') And (Cmoves.Cmoves_M_Code<>'')) Move Cmoves.Cmoves_M_Code   to Cmoves.Module_From
53325>>>
53325>>>                        If (Ctypkin.Open_Item='1') Move (Cmoves.Axia_Pros_Sysx-Cmoves.Axia_Sysxet) to Cmoves.Axia_Ypol_Sysx
53328>>>                        Else Begin
53329>>>                            Move 0 to Cmoves.Axia_Pros_Sysx
53330>>>                            Move 0 to Cmoves.Axia_Sysxet
53331>>>                            Move 0 to Cmoves.Axia_Ypol_Sysx
53332>>>                        End
53332>>>>
53332>>>
53332>>>                        // js 23/01/2002
53332>>>                        // Enhmerosh Pediou Flag_Ypol to opoio antiprosopeyei
53332>>>                        // to an h eggrafh exei diathesimo ypoloipo pros sysxetish
53332>>>                        Move (Cmoves.Axia_Ypol_Sysx<>0) to Cmoves.Flag_Ypol
53333>>>
53333>>>                        // js 23/01/2002
53333>>>                        // Enhmerosh Pediou Flag_Open to opoio antiprosopeyei
53333>>>                        // an einai xreosh=1, pistosh=2, arnhtikh xreosh=2 arnhtikh Pistosh=1
53333>>>                        // gia na emfanizei ta antistrofa sto copen
53333>>>                        If (Ctypkin.Open_Item='1') Begin
53335>>>                            If ((Cmoves.Cmoves_X0<>0) And ((Cmoves.Cmoves_P0=0))) Begin
53337>>>                                Move 1                          to Cmoves.Flag_Copen
53338>>>                                If (Cmoves.Cmoves_X0<0) Move 2  to Cmoves.Flag_Copen
53341>>>                            End
53341>>>>
53341>>>                            Else If ((Cmoves.Cmoves_P0<>0) And ((Cmoves.Cmoves_X0=0))) Begin
53344>>>                                Move 2                          to Cmoves.Flag_Copen
53345>>>                                If (Cmoves.Cmoves_P0<0) Move 1  to Cmoves.Flag_Copen
53348>>>                            End
53348>>>>
53348>>>                            Else Move 0 to Cmoves.Flag_Copen
53350>>>                        End
53350>>>>
53350>>>                        Else Move 0 to Cmoves.Flag_Copen
53352>>>                        Saverecord Cmoves
53353>>>                    End
53353>>>>
53353>>>                End
53353>>>>
53353>>>            End
53353>>>>
53353>>>            Else Function_Return 5
53355>>>            Function_Return 0
53356>>>        End_Function
53357>>>
53357>>>
53357>>>
53357>>>
53357>>>
53357>>>
53357>>>
53357>>>        //AB-StoreEnd
53357>>>
53357>>>    End_Object    // ButtonSub1
53358>>>
53358>>>    Object TextBoxSub1 is a TextBoxSub
53360>>>        Set Label to "„§ ¢¦šã ˜¨®œå¦¬"
53361>>>        Set Location to 7 5
53362>>>        Set Size to 10 55
53363>>>    End_Object    // TextBoxSub1
53364>>>
53364>>>    Object RadioGroupSub1 is a RadioGroupSub
53366>>>        Set Size to 89 107
53367>>>        Set Location to 28 170
53368>>>        Object Radio1 is a RadioSub
53370>>>            Set Label to "“§œçŸ¬¤¦  ¢ž¨à£é¤"
53371>>>            Set Size to 10 95
53372>>>            Set Location to 10 5
53373>>>        End_Object    // Radio1
53374>>>
53374>>>        Object Radio2 is a RadioSub
53376>>>            Set Label to "œ¢á«œª"
53377>>>            Set Size to 10 95
53378>>>            Set Location to 25 5
53379>>>        End_Object    // Radio2
53380>>>
53380>>>        Object Radio3 is a RadioSub
53382>>>            Set Label to "„¨š˜"
53383>>>            Set Size to 10 95
53384>>>            Set Location to 40 5
53385>>>        End_Object    // Radio3
53386>>>
53386>>>        Object Radio1 is a RadioSub
53388>>>            Set Label to "ƒ„Ž"
53389>>>            Set Size to 10 95
53390>>>            Set Location to 57 5
53391>>>        End_Object    // Radio1
53392>>>
53392>>>        Object Radio2 is a RadioSub
53394>>>            Set Label to "‰ ¤ã©œ ª"
53395>>>            Set Size to 10 95
53396>>>            Set Location to 73 5
53397>>>        End_Object    // Radio2
53398>>>
53398>>>
53398>>>        //AB-StoreStart
53398>>>
53398>>>        Procedure Notify_Select_State integer iToItem integer iFromItem
53400>>>            Set piWhat to iToItem
53401>>>        End_Procedure
53402>>>
53402>>>        // If you set Current_radio you must set this after the
53402>>>        // radio objects have been created AND after Notify_select_State has been
53402>>>        // created. i.e. Set in bottom-code at end!!
53402>>>        //Set Current_Radio to 0
53402>>>
53402>>>
53402>>>        //AB-StoreEnd
53402>>>
53402>>>    End_Object    // RadioGroupSub1
53403>>>
53403>>>
53403>>>    //AB-StoreStart
53403>>>
53403>>>
53403>>>
53403>>>
53403>>>    //AB-StoreEnd
53403>>>
53403>>>End_Object    // tAxio
53404>>>
53404>>>
53404>>>//AB-StoreStart
53404>>>
53404>>>
53404>>>//AB-StoreEnd
53404>>>
53404>>>//AB/ End_Object    // prj
53404>
53404>        //AB-ClientStoreStart
53404>        
53404>        
53404>        //AB-ClientStoreEnd
53404>
53404>
53404>    End_Object  // Client_Area
53405>    
53405>    On_Key Key_Ctrl+Key_1 Send Activate_tAxio To Client_Area
53406>    
53406>    Use DFStdSbr.pkg //  Status-Bar object.
INCLUDING FILE: DFSTDSBR.PKG
53406>>>// 07/23/96 JJT - New Class names
53406>>>// Very prototype global status bar
53406>>>//
53406>>>Use dfMainSt.pkg
INCLUDING FILE: DFMAINST.PKG
53406>>>>>// 07/23/96 JJT - New Class names
53406>>>>>Use dfAstbar.pkg
53406>>>>>
53406>>>>>Class StatusBar is a AppStatusBar
53407>>>>>
53407>>>>>    Procedure Construct_Object
53408>>>>>       Forward Send Construct_Object
53410>>>>>       //
53410>>>>>       Send Add_Item 350  ''     // micro-help
53411>>>>>       Send Add_Item  40  'View:'
53412>>>>>       Set Item_Display_Style To sbNORMAL
53413>>>>>       Send Add_Item 200  ''     // view name
53414>>>>>       Send Add_Item   0  ''     // spring 'normal' to end
53415>>>>>       Set Item_Display_Style To sbNORMAL
53416>>>>>    End_Procedure // Construct_Object
53417>>>>>
53417>>>>>    Procedure Show_View_Name String sName
53418>>>>>        Set Value item 2 to sName
53419>>>>>    End_Procedure
53420>>>>>
53420>>>>>End_Class
53421>>>
53421>>>If (Wait(Self)) Send Deactivate to (Wait(Self))
53424>>>
53424>>>Object oStatusBarSub  is a StatusBar
53426>>>    Use DFTimer // DfTimer Manager Must Have a WindowHandle
53426>>>    
53426>>>    Property Integer piStdPanes Public (PaneCount(Self))
53428>>>    
53428>>>    //Set Value     Item 1 to (ToANSI("„§ ¢¦šã:"))
53428>>>    Set PaneWidth item 1 to 50
53429>>>    
53429>>>    Send AddPane 55  ""        sbLOWERED
53430>>>    Send AddPane 70  ""        sbLOWERED
53431>>>    Send AddPane 55  ""        sbLOWERED
53432>>>    
53432>>>    Procedure pTimer
53434>>>        String lsDay lsHour lsHH lsMM lsSS
53435>>>        Integer liStdPanes lbState
53435>>>    
53435>>>        Get piStdPanes to liStdPanes
53436>>>        Sysdate lsDay lsHH lsMM lsSS
53440>>>        If (Length(lsHH)=1) Insert "0" In lsHH At 1
53444>>>        If (Length(lsMM)=1) Insert "0" In lsMM At 1
53448>>>        If (Length(lsSS)=1) Insert "0" In lsSS At 1
53452>>>        Move (lsHH+":"+lsMM+":"+lsSS) to lsHour
53453>>>        Get Simple_state to lbState
53454>>>        If  Not (lbState) Begin
53456>>>            Set Value Item liStdPanes     to lsHour
53457>>>            Set Value Item (liStdPanes+1) to lsDay
53458>>>        End
53458>>>>
53458>>>    
53458>>>    End_Procedure // pTimer
53459>>>    
53459>>>    
53459>>>    Object oTimerObj Is A DFTimer
53461>>>    
53461>>>        Set Timeout to 1000
53462>>>        Set Timer_Active_State to TRUE
53463>>>        Set Timer_Object to (oStatusBarSub(Current_Object))
53464>>>        Set Timer_Message to pTimer
53465>>>    
53465>>>    End_Object // oTimerOdj
53466>>>End_Object // oStatusBar
53467>>>
53467>>>
53467>
53467>    //AB-PanelStoreStart
53467>    Use StdAbout.pkg // Standard "About" package.
INCLUDING FILE: STDABOUT.PKG
53467>>>//************************************************************************
53467>>>// Confidential Trade Secret.
53467>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
53467>>>// as an unpublished work.  All rights reserved.
53467>>>// DataFlex is a registered trademark of Data Access Corporation.
53467>>>//
53467>>>//************************************************************************
53467>>>//************************************************************************
53467>>>//
53467>>>// $File name  : StdAbout.pkg
53467>>>// $File title : Standard about object package for VDF
53467>>>// Notice      :
53467>>>// $Author(s)  : John Tuohy
53467>>>//
53467>>>// $Rev History
53467>>>//
53467>>>// JT 06/27/97   File created
53467>>>//************************************************************************
53467>>>
53467>>>// This provides a quick and simple way to create an about package for a program.
53467>>>// You need to create a message inside you client area called Activate_About.
53467>>>// Within this message you should send the message DoAbout passing needed
53467>>>// string information.
53467>>>//
53467>>>//       Procedure Activate_About
53467>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
53467>>>//       End_Procedure
53467>>>//    where: sTitle =     Name of application. If none provided, uses caption
53467>>>//                        bar title
53467>>>//           sVersion   = Version Line. If none provided, will be blank
53467>>>//           sCopyRight = Copyright Line. If none provided, will be blank
53467>>>//           sAuthor    = Author name, blank if none provided
53467>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
53467>>>//                        is used.
53467>>>// It is expected that you will place this in your own object package. For
53467>>>// example an order about package may look like this:
53467>>>//
53467>>>//   // OrderAbout.pkg
53467>>>//   Use StdAbout.pkg
53467>>>//   Procedure Activate_About
53467>>>//      Local String sTitle sCopyright sVersion sAuthor
53467>>>//      Move "My Order Entry System" to sTitle
53467>>>//      Move "Version 2.1" to sVersion
53467>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
53467>>>//      Move "John Smith"  to sAuthor
53467>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
53467>>>//   end_procedure
53467>>>//   // end of file.
53467>>>
53467>>>Use DfAbout.pkg
INCLUDING FILE: DFABOUT.PKG
53467>>>>>//************************************************************************
53467>>>>>// Confidential Trade Secret.
53467>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
53467>>>>>// as an unpublished work.  All rights reserved.
53467>>>>>// DataFlex is a registered trademark of Data Access Corporation.
53467>>>>>//
53467>>>>>//************************************************************************
53467>>>>>//************************************************************************
53467>>>>>//
53467>>>>>// $File name  : DfAbout.pkg
53467>>>>>// $File title : About class support
53467>>>>>// Notice      :
53467>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
53467>>>>>//
53467>>>>>// $Rev History
53467>>>>>//
53467>>>>>// JJT 11/5/98    Added version information
53467>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
53467>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
53467>>>>>//                workspace package.
53467>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
53467>>>>>//                class can create this object.
53467>>>>>//                Cleaned up the interface (used correct classes and messages)
53467>>>>>//                Added workspace reporting support to sys-info.
53467>>>>>//                Turned off wrapping in the sys-info editor.
53467>>>>>// KR  ??/??/96   File created
53467>>>>>//************************************************************************
53467>>>>>Use windows.pkg
53467>>>>>Use DFbitmap.pkg
53467>>>>>
53467>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
53468>>>>>
53468>>>>>//****************************************************************************
53468>>>>>// $Module type: FUNCTION
53468>>>>>// $Module name: Network_User_Name
53468>>>>>// $Author     : AK/VOO/KCR
53468>>>>>// Created     : 24-09-96 @ 19:17
53468>>>>>//
53468>>>>>// Description
53468>>>>>//    This function reads the current username of windows and returns that
53468>>>>>//    name or an text unknown user
53468>>>>>//
53468>>>>>// $Rev History
53468>>>>>//    24-09-96  Module header created
53468>>>>>//****************************************************************************
53468>>>>>Function Network_User_Name Returns String
53470>>>>>    Local String sName sLength
53471>>>>>    Local Pointer lpName_Addr lpLength_Addr
53471>>>>>    Local Integer iRetval
53471>>>>>
53471>>>>>    Movestr (Repeat (Character (0), 255)) To sName
53472>>>>>>
53472>>>>>    GetAddress Of sName To lpName_Addr
53473>>>>>    Movestr (DwordToBytes (255)) To sLength
53474>>>>>>
53474>>>>>    GetAddress Of sLength To lpLength_Addr
53475>>>>>
53475>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
53476>>>>>>
53476>>>>>
53476>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
53479>>>>>    Else Function_Return "User Unknown"
53481>>>>>End_Function // Network_User_Name
53482>>>>>
53482>>>>>Type MEMORYSTATUS
53482>>>>>   Field MEMORYSTATUS.dwLength         As Dword // sizeof(MEMORYSTATUS)
53482>>>>>   Field MEMORYSTATUS.dwMemoryLoad     As Dword // percent of memory in use
53482>>>>>   Field MEMORYSTATUS.dwTotalPhys      As Dword // bytes of physical memory
53482>>>>>   Field MEMORYSTATUS.dwAvailPhys      As Dword // free physical memory bytes
53482>>>>>   Field MEMORYSTATUS.dwTotalPageFile  As Dword // bytes of paging file
53482>>>>>   Field MEMORYSTATUS.dwAvailPageFile  As Dword // free bytes of paging file
53482>>>>>   Field MEMORYSTATUS.dwTotalVirtual   As Dword // user bytes of address space
53482>>>>>   Field MEMORYSTATUS.dwAvailVirtual   As Dword // free user bytes
53482>>>>>End_Type // MEMORYSTATUS
53482>>>>>
53482>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
53483>>>>>
53483>>>>>// If a global workspace object exists it will use this variable to store
53483>>>>>// its object id.
53483>>>>>
53483>>>>>Class SysinfoDisplay Is An Edit
53484>>>>>    Procedure Construct_Object
53485>>>>>        forward send construct_object
53487>>>>>
53487>>>>>        Set Location To 6 6
53488>>>>>        Set Size To 110 255
53489>>>>>        Set Read_Only_State To True
53490>>>>>        Set wrap_state to False
53491>>>>>    end_Procedure
53492>>>>>
53492>>>>>    //****************************************************************************
53492>>>>>    // $Module type: PROCEDURE
53492>>>>>    // $Module name: Add_Line
53492>>>>>    // $Author     : VOO
53492>>>>>    // Created     : 06-10-96 @ 15:23
53492>>>>>    //
53492>>>>>    // Description
53492>>>>>    //    This method will add a line to this edit object, it should go simpler
53492>>>>>    //    but it seems to be done this way.
53492>>>>>    //
53492>>>>>    // $Rev History
53492>>>>>    //    06-10-96  Module header created
53492>>>>>    //****************************************************************************
53492>>>>>    Procedure Add_Line String sVal
53493>>>>>        Local Integer iLine
53494>>>>>
53494>>>>>        Moveint (Line_Count (Current_Object)) To iLine
53495>>>>>>
53495>>>>>        If (iLine = 1 And Changed_State (Current_Object) = False) Moveint 0 To iLine
53498>>>>>        Set Value Item iLine To sVal
53499>>>>>    End_Procedure // Add_Line
53500>>>>>
53500>>>>>    //****************************************************************************
53500>>>>>    // $Module type: PROCEDURE
53500>>>>>    // $Module name: Show_Current_Directory
53500>>>>>    // $Author     : VOO
53500>>>>>    // Created     : 06-10-96 @ 15:24
53500>>>>>    //
53500>>>>>    // Description
53500>>>>>    //    This method will show the name of the current directory in the system
53500>>>>>    //    information box
53500>>>>>    //
53500>>>>>    // $Rev History
53500>>>>>    //    06-10-96  Module header created
53500>>>>>    //****************************************************************************
53500>>>>>    Procedure Show_Current_Directory
53501>>>>>        Local String sDir
53502>>>>>
53502>>>>>        Get_Current_Directory To sDir
53503>>>>>        Send Add_Line ("Current Directory: " + sDir)
53504>>>>>    End_Procedure // Show_Current_Directory
53505>>>>>
53505>>>>>    Procedure Show_Windows_Directory
53506>>>>>        Local String sWindir
53507>>>>>
53507>>>>>        Get_Windows_Directory To sWindir
53508>>>>>        Send Add_Line ("Windows Directory: " * sWindir)
53509>>>>>    End_Procedure // Show_Windows_Directory
53510>>>>>
53510>>>>>    Procedure Show_Current_User
53511>>>>>        Send Add_Line ("Network User Name: " * Network_User_Name (Current_Object))
53512>>>>>    End_Procedure // Show_Current_User
53513>>>>>
53513>>>>>    Procedure Show_Number_Format
53514>>>>>        Local Integer iFormat
53515>>>>>
53515>>>>>        Get_Attribute Df_Thousands_Separator To iFormat
53518>>>>>        Send Add_Line ('Thousands Separator: "' - Character (iFormat) - '" (' - String (iFormat) - ')')
53519>>>>>        Get_Number_Format To iFormat
53520>>>>>        Send Add_Line ('Decimal Separator: "' - If (iFormat = 0, '.', ',') - '"')
53521>>>>>    End_Procedure // Show_Number_Format
53522>>>>>
53522>>>>>    Procedure Show_Filelist_Name
53523>>>>>        Local String sFilename
53524>>>>>
53524>>>>>        Get_Attribute Df_Filelist_Name To sFilename
53527>>>>>        Send Add_Line ("Current Filelist: " * sFilename)
53528>>>>>    End_Procedure // Show_Filelist_Name
53529>>>>>
53529>>>>>    Procedure Show_Lock_Delay
53530>>>>>        Local Integer iLockdelay
53531>>>>>
53531>>>>>        Get_Attribute Df_Lock_Delay To iLockdelay
53534>>>>>        Send Add_Line ("Database Locking Delay: " * String (iLockdelay) * "Milliseconds")
53535>>>>>    End_Procedure // Show_Lock_Delay
53536>>>>>
53536>>>>>    Procedure Show_Lock_Timeout
53537>>>>>        Local Integer iLockTimeout
53538>>>>>
53538>>>>>        Get_Attribute Df_Lock_Timeout To iLockTimeout
53541>>>>>        Send Add_Line ("Database Locking Timeout: " * String (iLockTimeout) * "Milliseconds")
53542>>>>>    End_Procedure // Show_Lock_Timeout
53543>>>>>
53543>>>>>    Procedure Show_Screen_Size
53544>>>>>        Local Integer iYscreensize iXscreensize
53545>>>>>
53545>>>>>        Moveint (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
53546>>>>>>
53546>>>>>        Moveint (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
53547>>>>>>
53547>>>>>
53547>>>>>        Send Add_Line ("Video Resolution: " * String (iXscreensize) * "by" * String (iYscreensize))
53548>>>>>    End_Procedure // Show_Screen_Size
53549>>>>>
53549>>>>>    Procedure Show_Page_Size
53550>>>>>        Send Add_Line ("Page End: " * String (Pageend) * "Form Feed: " * String (Pagefeed))
53551>>>>>    End_procedure
53552>>>>>
53552>>>>>    Procedure Show_Date
53553>>>>>        Local Date dToday
53554>>>>>
53554>>>>>        Sysdate4 dToday
53555>>>>>        Send Add_Line ("Current System Date: " * String (dToday))
53556>>>>>    End_procedure // Show_Date
53557>>>>>
53557>>>>>    Procedure Show_Date_Format
53558>>>>>        Local Integer iDateFormat
53559>>>>>        Local String sDateFormat
53559>>>>>
53559>>>>>        Get_Attribute Df_Date_Format To iDateFormat
53562>>>>>        if iDateFormat Eq DF_DATE_USA ;            Movestr "USA" To sDateFormat
53565>>>>>        else if iDateformat Eq DF_DATE_EUROPEAN ;            Movestr "European" To sDateFormat
53569>>>>>        else if iDateformat Eq DF_DATE_MILITARY ;            Movestr "Military" To sDateFormat
53573>>>>>        else ;            Movestr "Unknown Date Type" To sDateFormat
53575>>>>>        Send Add_Line ("Date Format: " * sDateformat)
53576>>>>>    End_Procedure // Show_Date_Format
53577>>>>>
53577>>>>>    Procedure Show_Memavail
53578>>>>>        Local Integer iMem
53579>>>>>
53579>>>>>        Memory iMem
53580>>>>>>
53580>>>>>        Send Add_Line ("Available Memory: " * String (iMem))
53581>>>>>    End_Procedure // Show_Memavail
53582>>>>>
53582>>>>>    Procedure Show_Systemresources
53583>>>>>        Local String sMemoryStatus
53584>>>>>        Local Pointer lpsMemoryStatus
53584>>>>>        Local Integer iVoid
53584>>>>>        Local Dword dwMemoryLoad dwTotalPhys dwAvailPhys dwTotalPageFile dwAvailPageFile dwTotalVirtual dwAvailVirtual
53584>>>>>
53584>>>>>        ZeroType MEMORYSTATUS To sMemoryStatus
53585>>>>>        GetAddress Of sMemoryStatus To lpsMemoryStatus
53586>>>>>
53586>>>>>        Moveint (GlobalMemoryStatus (lpsMemoryStatus)) To iVoid
53587>>>>>>
53587>>>>>
53587>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwMemoryLoad    To dwMemoryLoad
53588>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPhys     To dwTotalPhys
53589>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPhys     To dwAvailPhys
53590>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPageFile To dwTotalPageFile
53591>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPageFile To dwAvailPageFile
53592>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalVirtual  To dwTotalVirtual
53593>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailVirtual  To dwAvailVirtual
53594>>>>>
53594>>>>>        Send Add_Line ("Current memory utilization:" * String (dwMemoryLoad))
53595>>>>>        Send Add_Line ("Percentage available physical memory:" * String (dwAvailPhys / dwTotalPhys * 100.0) - "%")
53596>>>>>        Send Add_Line ("Percentage available pagefile space:" * String (dwAvailPageFile / dwTotalPageFile * 100.0) - "%")
53597>>>>>        Send Add_Line ("Percentage available virtual memory:" * String (dwAvailVirtual / dwTotalVirtual * 100.0) - "%")
53598>>>>>    End_Procedure // Show_Systemresources
53599>>>>>
53599>>>>>    Procedure Show_Registration
53600>>>>>        Local String sRegName
53601>>>>>        Local Integer iSN
53601>>>>>        Registration sRegName iSN
53602>>>>>>
53602>>>>>
53602>>>>>        Send Add_Line ("Serial# : " + (String(iSN)))
53603>>>>>        Send Add_Line ("Reg Name: " + sRegName)
53604>>>>>
53604>>>>>    End_Procedure // Show_Current_Directory
53605>>>>>
53605>>>>>
53605>>>>>
53605>>>>>    //****************************************************************************
53605>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
53605>>>>>    // to the workspace object passing the an object and message to send back
53605>>>>>    // to this object. It is expected that the workspace object will send this
53605>>>>>    // message for every line of information it wants displayed (passing the
53605>>>>>    // information to be displayed
53605>>>>>    //****************************************************************************
53605>>>>>    register_procedure EnumerateWorkspaceData integer hObjId integer hmMessId
53605>>>>>    Procedure Show_WorkspaceInformation
53606>>>>>        If ghoWorkspace ;            Send EnumerateWorkspaceData to ghoWorkspace Current_object Msg_add_Line
53609>>>>>    End_Procedure
53610>>>>>
53610>>>>>    Function VersionStr integer iVer integer iRev integer iBld Returns string
53611>>>>>        Function_Return (string(iVer)-"."-string(iRev)-"."-string(iBld))
53612>>>>>    End_Function
53613>>>>>
53613>>>>>    Procedure Show_Versions
53614>>>>>        local integer iVersion iRevision iBuild
53615>>>>>        Version_information iVersion iRevision iBuild
53617>>>>>        Send Add_Line ("Runtime Version:" * VersionStr(self,iVersion,iRevision,iBuild) )
53618>>>>>        Send Add_Line ("Package Version:" * VersionStr(self,PKG_VERSION, PKG_REVISION, PKG_BUILD) )
53619>>>>>        Send Add_Line ("FMAC Version:"    * VersionStr(self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) )
53620>>>>>    End_Procedure
53621>>>>>
53621>>>>>
53621>>>>>    //***
53621>>>>>    //*** BW
53621>>>>>    //*** Procedure: Show_Drivers
53621>>>>>    //*** Purpose  : Show loaed database drivers
53621>>>>>    //***
53621>>>>>
53621>>>>>    Procedure Show_Drivers
53622>>>>>        Local String  Current_drvr
53623>>>>>        Local String  Loadeddrvrs
53623>>>>>        Local Integer Number_of_drvrs
53623>>>>>        Local Integer Count
53623>>>>>
53623>>>>>        Move "" To Loadeddrvrs
53624>>>>>        Get_attribute DF_NUMBER_DRIVERS To Number_of_drvrs
53627>>>>>        For Count From 1 To Number_of_drvrs
53633>>>>>>
53633>>>>>            Get_attribute DF_DRIVER_NAME Of Count To Current_drvr
53636>>>>>            If (Loadeddrvrs <> "") ;                Move (Append(Loadeddrvrs, ", ")) To Loadeddrvrs
53639>>>>>            Move (Append(Loadeddrvrs, Current_drvr)) To Loadeddrvrs
53640>>>>>        Loop
53641>>>>>>
53641>>>>>        Send Add_Line ("Database driver(s):" * Loadeddrvrs)
53642>>>>>    End_Procedure // Show_Drivers
53643>>>>>
53643>>>>>    //****************************************************************************
53643>>>>>    // $Module type: PROCEDURE
53643>>>>>    // $Module name: Add_Focus
53643>>>>>    // $Author     : VOO
53643>>>>>    // Created     : 24-09-96 @ 19:43
53643>>>>>    //
53643>>>>>    // Description
53643>>>>>    //    During activation we will remove the old information and add the newly
53643>>>>>    //    found systeminformation
53643>>>>>    //
53643>>>>>    // $Rev History
53643>>>>>    //    24-09-96  Module header created
53643>>>>>    //****************************************************************************
53643>>>>>    Procedure Add_Focus Integer hoRoot
53644>>>>>        Forward Send Add_Focus hoRoot
53646>>>>>
53646>>>>>        Send Delete_Data
53647>>>>>        Set Changed_State To False
53648>>>>>        Set Read_Only_State To True
53649>>>>>        Send Show_WorkSpaceInformation // added to show WS info
53650>>>>>        SEnd Show_Drivers
53651>>>>>        Send Show_Current_User
53652>>>>>        Send Show_Windows_Directory
53653>>>>>        Send Show_Current_Directory
53654>>>>>        Send Show_Filelist_Name
53655>>>>>        Send Show_Versions
53656>>>>>        Send Show_Memavail
53657>>>>>        Send Show_Screen_Size
53658>>>>>        Send Show_Page_Size
53659>>>>>        Send Show_Number_Format
53660>>>>>        Send Show_Date_Format
53661>>>>>        Send Show_Lock_Delay
53662>>>>>        Send Show_Lock_Timeout
53663>>>>>        Send Show_Date
53664>>>>>        Send Show_Systemresources
53665>>>>>        Send Show_Registration
53666>>>>>    End_Procedure // Show_All_Info
53667>>>>>
53667>>>>>End_Class // SysinfoDisplay
53668>>>>>
53668>>>>>
53668>>>>>//****************************************************************************
53668>>>>>// $Module type: OBJECT
53668>>>>>// $Module name: Sysinfo_Dialog
53668>>>>>// $Author     : VOO
53668>>>>>// Created     : 24-09-96 @ 18:47
53668>>>>>//
53668>>>>>// Description
53668>>>>>//    This object shows the systeminformation on the screen
53668>>>>>//
53668>>>>>// $Rev History
53668>>>>>//    24-09-96  Module header created
53668>>>>>//****************************************************************************
53668>>>>>Class SysInfoDialog Is A ModalPanel
53669>>>>>    Procedure Construct_Object
53670>>>>>        forward send construct_object
53672>>>>>
53672>>>>>        Set Caption_Bar To True
53673>>>>>        Set Sysmenu_Icon To True
53674>>>>>        Set Label To "System Information"
53675>>>>>        Set Size To 152 270
53676>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
53677>>>>>        Set Minimize_Icon To False
53678>>>>>        Set Maximize_Icon To False
53679>>>>>        Set Border_Style To Border_Dialog
53680>>>>>
53680>>>>>        Object Sysinfo_Display Is A SysInfoDisplay
53682>>>>>        End_Object
53683>>>>>
53683>>>>>        Object Close_Button Is A Button
53685>>>>>            Set Label to "&Close"
53686>>>>>            Set Location To 120 212
53687>>>>>            Set Message item 0 to msg_Close_Panel
53688>>>>>            Set default_action_button to current_object
53689>>>>>        End_Object // Close_Button
53690>>>>>
53690>>>>>        On_Key Kcancel       Send Close_Panel
53691>>>>>        On_Key Key_Alt+Key_C Send Close_Panel
53692>>>>>    End_procedure
53693>>>>>
53693>>>>>End_Class // SysinfoDialog
53694>>>>>
53694>>>>>// Purpose:
53694>>>>>//
53694>>>>>// Ken Ross 12/17/96 5:16PM
53694>>>>>//
53694>>>>>Class AboutDialog Is A ModalPanel
53695>>>>>
53695>>>>>    Procedure construct_object
53696>>>>>        String sVdfRootDir
53697>>>>>        forward send construct_object
53699>>>>>        Set Label to "About..."
53700>>>>>        Set Size to 100 217
53701>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
53702>>>>>
53702>>>>>        Object SysInfo_Dialog is a SysInfoDialog
53704>>>>>        End_Object
53705>>>>>
53705>>>>>        Object oBox is a Container3d
53707>>>>>            Set Border_Style to Border_StaticEdge
53708>>>>>            Set Size to 63 202
53709>>>>>            Set Location to 4 5
53710>>>>>
53710>>>>>            Object AboutGraphic is a BitmapContainer
53712>>>>>                Set Border_Style to Border_None
53713>>>>>                Set Bitmap_Style to Bitmap_Center
53714>>>>>                Set Size to 48 48
53715>>>>>                Set Location to 7 2
53716>>>>>            End_Object    // AboutGraphic
53717>>>>>
53717>>>>>            Object ProductName is a TextBox
53719>>>>>                Set label to "ProductName"
53720>>>>>                Set Size to 10 45
53721>>>>>                Set Location to 8 53
53722>>>>>            End_Object    // ProductName
53723>>>>>
53723>>>>>            Object Version is a TextBox
53725>>>>>                Set label to "Version"
53726>>>>>                Set Size to 10 25
53727>>>>>                Set Location to 21 53
53728>>>>>            End_Object    // Version
53729>>>>>
53729>>>>>            Object Copyright is a TextBox
53731>>>>>                Set label to "Copyright"
53732>>>>>                Set Size to 10 31
53733>>>>>                Set Location to 34 53
53734>>>>>            End_Object    // Copyright
53735>>>>>
53735>>>>>            Object Author is a TextBox
53737>>>>>                Set label to "Author"
53738>>>>>                Set Size to 10 22
53739>>>>>                Set Location to 46 53
53740>>>>>            End_Object    // Author
53741>>>>>
53741>>>>>        End_Object    // oBox
53742>>>>>
53742>>>>>        Object OK_bn is a Button
53744>>>>>            On_Item "&OK" Send Close_Panel
53745>>>>>            Set Size to 14 50
53746>>>>>            Set Location to 71 157
53747>>>>>        End_Object    // OK_bn
53748>>>>>
53748>>>>>        Object SysInfo_bn is a Button
53750>>>>>            On_Item "&System Info" Send Show_Sysinfo
53751>>>>>            Set Size to 14 50
53752>>>>>            Set Location to 71 101
53753>>>>>        End_Object    // SysInfo_bn
53754>>>>>
53754>>>>>        On_Key Kcancel Send KeyAction to (Ok_bn(Current_Object))
53755>>>>>        On_Key Key_Alt+Key_O Send KeyAction to (Ok_bn(Current_Object))
53756>>>>>        On_Key Key_Alt+Key_S Send KeyAction to (SysInfo_bn(Current_Object))
53757>>>>>
53757>>>>>        Get_Profile_String "Defaults" "VdfRootDir" To sVdfRootDir
53760>>>>>        Set logo to (sVdfRootDir +"\Bitmaps\DacAbout.bmp")  // square bitmaps of 42x42 work best
53761>>>>>
53761>>>>>    End_Procedure
53762>>>>>
53762>>>>>    Procedure set productname string sval
53763>>>>>        set label of (productname(oBox(current_object))) to sval
53764>>>>>    End_Procedure
53765>>>>>
53765>>>>>    Procedure set version string sval
53766>>>>>        set label of (version(oBox(current_object))) to sval
53767>>>>>    End_Procedure
53768>>>>>
53768>>>>>    Procedure set copyright string sval
53769>>>>>        set label of (copyright(oBox(current_object))) to sval
53770>>>>>    End_Procedure
53771>>>>>
53771>>>>>    Procedure set author string sval
53772>>>>>        set label of (author(oBox(current_object))) to sval
53773>>>>>    End_Procedure
53774>>>>>
53774>>>>>    // square bitmaps of 42x42 work best
53774>>>>>    //
53774>>>>>    Procedure set logo string sval
53775>>>>>        set bitmap of (aboutgraphic(oBox(current_object))) to sval
53776>>>>>    End_Procedure
53777>>>>>
53777>>>>>    Procedure Show_Sysinfo
53778>>>>>        Send Popup_Modal To (Sysinfo_Dialog(Current_Object))
53779>>>>>    End_Procedure // Show_Sysinfo
53780>>>>>
53780>>>>>End_Class
53781>>>>>
53781>>>>>
53781>>>>>//Object About_Dialog is an AboutDialog
53781>>>>>//    set productname to "Visual DataFlex"
53781>>>>>//    set version to "version 4.0"
53781>>>>>//    set copyright to "Copyright 1997 Data Access Corporation"
53781>>>>>//    set author to ""
53781>>>>>//    set logo to "ablogo.bmp"  // square bitmaps of 42x42 work best
53781>>>>>//End_Object
53781>>>>>
53781>>>>>//Procedure Activate_About
53781>>>>>//   Send Popup_Modal To (About_Dialog (Current_Object))
53781>>>>>//End_Procedure
53781>>>
53781>>>// *************************************************************************
53781>>>//  Public message. This is the default message. It is expected that you will
53781>>>//   create your own message to override this
53781>>>// *************************************************************************
53781>>>
53781>>>Procedure Activate_About
53783>>>   Send DoAbout "" "" "" "" "" ""
53784>>>End_Procedure
53785>>>
53785>>>// *************************************************************************
53785>>>//  Public message. It is expected that you will send this message (most
53785>>>//  likely from Activate_About. This creates an about object, activates it
53785>>>//  and destroys it when done. It is not exepected that you will augment this.
53785>>>// *************************************************************************
53785>>>
53785>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
53787>>>        Local integer hoObj hoMain
53788>>>
53788>>>        // create object
53788>>>        Object About is an AboutDialog
53790>>>            // if no title passed use the label of the main panel
53790>>>            // (if a main panel exists).
53790>>>            if sTitle     eq '' Begin
53792>>>                Get Main_Window to hoMain
53793>>>                if hoMain Get Label of hoMain to sTitle
53796>>>            end
53796>>>>
53796>>>            set productname to sTitle
53797>>>            set version     to sVersion
53798>>>            set copyright   to sCopyRight
53799>>>            set author      to sAuthor
53800>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
53803>>>            Move Current_Object to hoObj // object Id
53804>>>        End_Object
53805>>>        Send Popup to hoObj    // popup the about object
53806>>>        Send Request_Destroy_Object to hoObj // when done, it will be destroyed
53807>>>End_procedure
53808>    //AB-PanelStoreEnd
53808>
53808>
53808>End_Object
53809>
53809>
53809>//AB-StoreStart
53809>
53809>Start_UI
53810>
53810>
53810>
53810>//AB-StoreEnd
53810>
53810>
Summary
Memory Available: 2147483647
Total Errors   : 0
Total Symbols  : 92340
Total Resources: 0
Total Commands : 53809
Total Windows  : 52
Total Pages    : 12
Static Data    : 379283
Message area   : 306305
Total Blocks   : 43233
