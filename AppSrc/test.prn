Compiling Program: L:\Vdf6\Develop\Empor\AppSrc\test.src
Memory Available: 2147483647
1>Use AllEntSc
Using pre-compiled package ALLENTSC
INCLUDING FILE: ALLENTSC.PKI
30325>
30325>Register_Object Client_Area
30325>
30325>//AB-StoreTopStart
30325>Use Workspc.pkg
30325>
30325>//  Set date attributes as needed
30325>Set_Date_Attribute sysdate4_State to (TRUE)
30326>Set_Date_Attribute Date4_State    to (TRUE)
30327>Set_Date_Attribute epoch_value    to 30
30328>
30328>Object ProgramWorkspace is a WorkspaceSub
30330>    Set WorkspaceName to CURRENT$WORKSPACE
30331>    Set kEnter_Next_State to True
30332>//    Set ModuleName    to 'ProgramName' // Special module name.
30332>//    Set HelpName      to 'HelpName.hlp'// Please provide the name of your Windows help file.
30332>End_Object
30333>
30333>Use Help_Ids.inc // Developer should provide this file of help context links.
INCLUDING FILE: HELP_IDS.INC
30333>>>// Help_ids.inc
30333>>>//
30333>>>// Context ids for the order entry system. This uses
30333>>>// help file ordentry.hlp.
30333>>>//
30333>>>// This is a sample version. YOU must supply
30333>>>// the ID values
30333>>>
30333>>>//  Generic Context Ids
30333>>>//
30333>>>
30333>>>// It is expected that file-names ids will be the same as their
30333>>>// filenumber.
30333>>>
30333>>>
30333>>>//  View and selection-list specific context ids
30333>>>//
30333>>>//..........add view, object, selection-list ids here....
30333>Use Std_Help.pkg
INCLUDING FILE: STD_HELP.PKG
30333>>>// STD_HELP.PKG
30333>>>//
30333>>>// Global Help Object
30333>>>//
30333>>>//  Creates all Help Support required to access WINDOWs help system
30333>>>//  with DataFlex. Creates a global object named Help_Object.
30333>>>//
30333>>>//  9/19/97 JJT - Modified to define stadnard help Ids if they are undefined
30333>>>
30333>>>use DFHlpSys // Context Sensitive Help Support
30333>>>
30333>>>
30333>>>// This file needs to be provided by the developer. It will contain
30333>>>// symbolic replacements for the ID integer values used to access the
30333>>>// the windows help file's topics.
30333>>>//
30333>>>use Help_ids.inc
30333>>>
30333>>>// If the following are not defined in help_ids.inc,
30333>>>//  create default 0 values for them
30333>>>Define GeneralHelpId    for    0
30333>>>Define KeysHelpId       for    0
30333>>>Define FileHelpId       for    0
30333>>>Define ErrorHelpId      for    0  // probably not used in VDF
30333>>>Define IndexHelpId      for    0  // probably not used in VDF
30333>>>
30333>>>object Help_Object is a HelpSystem // global help object
30335>>>
30335>>>   Set Help_Id_General to GeneralHelpId    // these should all be defined
30336>>>   Set Help_Id_Index   to IndexHelpId      // in help_ids.inc.
30337>>>   Set Help_Id_Keys    to KeysHelpId       //
30338>>>   Set Help_Id_Files   to FileHelpId       //
30339>>>   Set Help_Id_Errors  to ErrorHelpId      //
30340>>>
30340>>>end_object
30341>
30341>Use WinQlSQL.Sub
INCLUDING FILE: WINQLSQL.SUB
30341>>>Use CrystalReport.pkg
30341>>>
30341>>>
30341>>>
30341>>>Type PEWindowOptions
30341>>>  Field PEWindowOptions.StructSize As Word
30341>>>  Field PEWindowOptions.hasGroupTree As Word
30341>>>  Field PEWindowOptions.canDrillDown As Word
30341>>>  Field PEWindowOptions.hasNavigationControls As Word
30341>>>  Field PEWindowOptions.hasCancelButton As Word
30341>>>  Field PEWindowOptions.hasPrintButton As Word
30341>>>  Field PEWindowOptions.hasExportButton As Word
30341>>>  Field PEWindowOptions.hasZoomControl As Word
30341>>>  Field PEWindowOptions.hasCloseButton As Word
30341>>>  Field PEWindowOptions.hasProgressControls As Word
30341>>>  Field PEWindowOptions.hasSearchButton As Word
30341>>>  Field PEWindowOptions.hasPrintSetupButton As Word
30341>>>  Field PEWindowOptions.hasRefreshButton As Word
30341>>>End_Type // PEWindowOptions
30341>>>
30341>>>External_Function32 PESetWindowOptions "PESetWindowOptions" CRPE32.DLL ;  Integer printJob pointer Options Returns Integer
30342>>>
30342>>>Class CrystalReportSubSQL Is A CrystalReport
30343>>>
30343>>>    Procedure Construct_Object
30344>>>        Forward send Construct_Object
30346>>>        // Everything on except hasGroupTree by default
30346>>>        property integer hasGroupTree 0
30347>>>        property integer canDrillDown 1
30348>>>        property integer hasNavigationControls 1
30349>>>        property integer hasCancelButton 1
30350>>>        property integer hasPrintButton 1
30351>>>        property integer hasExportButton 1
30352>>>        property integer hasZoomControl 1
30353>>>        property integer hasCloseButton 1
30354>>>        property integer hasProgressControls 1
30355>>>        property integer hasSearchButton 1
30356>>>        property integer hasPrintSetupButton 1
30357>>>        property integer hasRefreshButton 1
30358>>>
30358>>>        Set WindowStyle To (WS_MAXIMIZE iOr WS_OVERLAPPEDWINDOW)
30359>>>    End_Procedure // Construct_Object
30360>>>
30360>>>    Procedure OutputToWindow String sTitle Integer iLeft Integer iTop Integer iWidth Integer iHeight Integer iStyle Handle hParent
30361>>>        Integer iPrintJob iResult
30362>>>        String sPEWindowOptions
30362>>>        Pointer pPeWindowOptions
30362>>>
30362>>>        Get PrintJob To iPrintJob
30363>>>        FillType PEWindowOptions with 0     to sPEWindowOptions
30364>>>        put PEWindowOptions_Size            to sPEWindowOptions at PEWindowOptions.StructSize
30365>>>        put (hasGroupTree(self))            to sPEWindowOptions at PEWindowOptions.hasGroupTree
30366>>>        put (canDrillDown(self))            to sPEWindowOptions at PEWindowOptions.canDrillDown
30367>>>        put (hasNavigationControls(self))   to sPEWindowOptions at PEWindowOptions.hasNavigationControls
30368>>>        put (hasCancelButton(self))         to sPEWindowOptions at PEWindowOptions.hasCancelButton
30369>>>        put (hasPrintButton(self))          to sPEWindowOptions at PEWindowOptions.hasPrintButton
30370>>>        put (hasExportButton(self))         to sPEWindowOptions at PEWindowOptions.hasExportButton
30371>>>        put (hasZoomControl(self))          to sPEWindowOptions at PEWindowOptions.hasZoomControl
30372>>>        put (hasCloseButton(self))          to sPEWindowOptions at PEWindowOptions.hasCloseButton
30373>>>        put (hasProgressControls(self))     to sPEWindowOptions at PEWindowOptions.hasProgressControls
30374>>>        put (hasSearchButton(self))         to sPEWindowOptions at PEWindowOptions.hasSearchButton
30375>>>        put (hasPrintSetupButton(self))     to sPEWindowOptions at PEWindowOptions.hasPrintSetupButton
30376>>>        put (hasRefreshButton(self))        to sPEWindowOptions at PEWindowOptions.hasrefreshButton
30377>>>        GetAddress of sPEWindowOptions      to pPEWindowOptions
30378>>>        Move (PESetWindowOptions(iPrintJob, pPEWindowOptions)) to iResult
30379>>>        Forward Send OutputToWindow sTitle iLeft iTop iWidth iHeight iStyle hParent
30381>>>    End_Procedure // OutputToWindow
30382>>>
30382>>>    Procedure Set TmpFileDir String aDir
30383>>>        String lsCurrWspc lsDir
30384>>>
30384>>>//        If (ghoWorkSpace <> 0) Begin
30384>>>//            Get WorkSpaceName of ghoWorkSpace to lsCurrWspc
30384>>>//            Insert "WorkSpaces\" in lsCurrWspc at 1
30384>>>//            Get_Profile_String lsCurrWspc aDir to lsDir
30384>>>//            Set Report_Data_Path to lsDir
30384>>>//        End
30384>>>    End_Procedure
30385>>>
30385>>>    Procedure DoWinQLReport
30386>>>        // This can be used when reports must be able to run in different data directories
30386>>>        Set TmpFileDir to "TmpFileDir"
30387>>>        Forward Send DoWinQLReport
30389>>>    End_Procedure
30390>>>
30390>>>
30390>>>    // This hook procedure is called after the print job has been opened.
30390>>>
30390>>>    Procedure OnInitializeReport000
30391>>>    ////// SOS Na ginei xana OnInitializeReport ///////////
30391>>>
30391>>>        Integer iTables iMax iCount iType
30392>>>        String  sLocation sLocation2 sPath DirSep
30392>>>        String  sNewPath sNewLocation sDataPath sMyLocation
30392>>>
30392>>>//        Open Sysfile
30392>>>
30392>>>        String  sActualSQL
30392>>>        String  sActualTemp
30392>>>        String  sOldSQL
30392>>>        String  sOldTemp
30392>>>        String  sServerName
30392>>>        String  sDatabaseName
30392>>>        String  sUserID
30392>>>
30392>>>//        Move Sysfile.ActualSQL      to sActualSQL
30392>>>//        Move Sysfile.ActualTemp     to sActualTemp
30392>>>//        Move Sysfile.OldSQL         to sOldSQL
30392>>>//        Move Sysfile.OldTemp        to sOldTemp
30392>>>//        Move Sysfile.cServerName    to sServerName
30392>>>//        Move Sysfile.cDatabaseName  to sDatabaseName
30392>>>//        Move Sysfile.cUserID        to sUserID
30392>>>
30392>>> //       Move 'SMS'                 to sOldSQL
30392>>> //       Move 'C:\Dns_tmp\'         to sOldTemp
30392>>> //       Move 'SMSMET'        to sActualSQL      // Database
30392>>> //       Move 'C:\Dns_tmp\'         to sActualTemp
30392>>> //      Move 'SMSMET'        to sServerName    // ODBC
30392>>> //       Move 'SMSMET'        to sDatabaseName  // DataBase
30392>>>     //   Move 'sa'               to sUserID
30392>>>
30392>>>        Move 'SMS'                 to sOldSQL
30393>>>        Move 'C:\Dns_tmp\'         to sOldTemp
30394>>>        Move 'SMSTITAN'             to sActualSQL      // Database
30395>>>        Move 'C:\Dns_tmp\'         to sActualTemp
30396>>>        Move 'SMSTITAN'        to sServerName    // ODBC
30397>>>        Move 'SMSTITAN'        to sDatabaseName  // DataBase
30398>>>
30398>>>
30398>>>        Move (Trim(sActualSQL   )) to sActualSQL
30399>>>        Move (Trim(sActualTemp  )) to sActualTemp
30400>>>        Move (Trim(sOldSQL      )) to sOldSQL
30401>>>        Move (Trim(sOldTemp     )) to sOldTemp
30402>>>        Move (Trim(sServerName  )) to sServerName
30403>>>        Move (Trim(sDatabaseName)) to sDatabaseName
30404>>>        Move (Trim(sUserID      )) to sUserID
30405>>>
30405>>>
30405>>>        Forward Send OnInitializeReport
30407>>>
30407>>>        Move (Sysconf(SYSCONF_DIR_SEPARATOR)) To DirSep
30408>>>        Get NTables To iMax
30409>>>        Decrement iMax
30410>>>        Get Report_Data_Path                                    To sPath
30411>>>        If Not (Right(sPath,1)) Eq DirSep Move (sPath-DirSep)   To sPath
30414>>>        For iCount From 0 To iMax
30420>>>>
30420>>>            Get NthTableLocation iCount         To sLocation
30421>>>            Get Report_Base_File_Name sLocation To sLocation2
30422>>>            Get NthTableDBType           iCount to iType
30423>>>
30423>>>            // An einai type 1 topiko
30423>>>            //               2=SQL
30423>>>            If (iType=2) Begin
30425>>>                If (sLocation contains sOldSQL) Begin
30427>>>                    Move (Replace(sOldSQL,sLocation,sActualSQL))    to sLocation
30428>>>                    Set NthTableLocation iCount                     to (Trim(sLocation))
30429>>>                End
30429>>>>
30429>>>            End
30429>>>>
30429>>>            Else If (iType=1) Begin
30432>>>                If (sLocation contains sOldTemp) Begin
30434>>>                    Move (Replace(sOldTemp,sLocation,sActualTemp))  to sLocation
30435>>>                    Set NthTableLocation iCount                     to (Trim(sLocation))
30436>>>                End
30436>>>>
30436>>>            End
30436>>>>
30436>>>            Set nthTableLogOnServerName     iCount to sServerName     0
30437>>>            Set nthTableLogOnDataBaseName   iCount to sDatabaseName   0
30438>>>            Set nthTableLogOnUserID         iCount to sUserID         0 // 'sa'     0
30439>>>        Loop // For iCount From 0 To iMax
30440>>>>
30440>>>
30440>>>    End_Procedure // OnInitializeReport
30441>>>
30441>>>
30441>>>//                Showln '--------------------------------------------------------'
30441>>>//                Showln iCount
30441>>>//                Showln sLocation
30441>>>//                Showln sPath
30441>>>//                Showln sLocation2
30441>>>//                Showln iType
30441>>>
30441>>>                //If (Trim(LowerCase(sLocation2))='btnemp.dat') Begin
30441>>>                  //Set Report_Data_Path to ''
30441>>>                  //Get NthTableDBType              iCount to iType
30441>>>                    //Set nthTableLogOnPassword       iCount to '123'     0
30441>>>                  //Set NthTableLocation            iCount To "BTNEMP"
30441>>>                    //Set NthTableLocation iCount To (sPath-sLocation2)
30441>>>                  //Get NthTableLocation iCount                 To sMyLocation
30441>>>                  //Move (Replace(sLocation,sMyLocation,''))    To sMyLocation
30441>>>                  //Showln sMyLocation
30441>>>                  //Set NthTableLocation            iCount To sMyLocation
30441>>>                //End
30441>>>
30441>>>
30441>>>
30441>>>    // This hook procedure is called just before a print job is closed.
30441>>>    Procedure OnDeInitializeReport
30442>>>        Forward Send OnDEInitializeReport
30444>>>    End_Procedure // OnDeInitializeReport
30445>>>
30445>>>    // This hook procedure is called just before a the print job is started.
30445>>>    Procedure OnStartPrinting
30446>>>        Forward Send OnStartPrinting
30448>>>    End_Procedure // OnStartPrinting
30449>>>
30449>>>    // This hook procedure is called just after a print job has finished.
30449>>>    Procedure OnStopPrinting
30450>>>        Forward Send OnStopPrinting
30452>>>    End_Procedure // OnStopPrinting
30453>>>
30453>>>
30453>>>End_Class // CrystalReportSubSQL
30454>>>
30454>Integer giWait_Obj
30454>
30454>// General Functions-Procedures and Variables
30454>Use Globals.Inc
INCLUDING FILE: GLOBALS.INC
30454>>>
30454>>>        String  gs_Selected_Company_Code
30454>>>        String  gs_Selected_Branch_Code
30454>>>        Integer gi_Selected_Year
30454>>>        String gs_Selected_Year_Recr
30454>>>        String  gs_Module_Code
30454>>>
30454>>>
30454>>>//Open Currency
30454>>>//Function CurrDigits Global String asCurr Returns Integer
30454>>>//    Integer liDecX
30454>>>//    Clear Currency
30454>>>//    move asCurr to Currency.Currency_C_Code
30454>>>//    Find Eq Currency By Index.1
30454>>>//    move Currency.Currency_Dec to liDecX
30454>>>//    Function_Return liDecX
30454>>>//End_Function // CurrDigits
30454>>>
30454>>>Open Nomisma
INCLUDING FILE: NOMISMA.FD
30456>>>Open SysCurXr
INCLUDING FILE: SYSCURXR.FD
30458>>>
30458>>>Function fiDekadika_Nomismatos Global String asNomisma Returns Integer
30459>>>    Move (Trim(asNomisma)) to asNomisma
30460>>>    Clear Nomisma
30461>>>    If ( asNomisma<>'' ) Move asNomisma         to Nomisma.Nomisma_Code
30464>>>    Else                 Move SysCurXr.C_Code0  to Nomisma.Nomisma_Code
30466>>>    Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
30467>>>>
30467>>>    Function_Return Nomisma.Dekadika
30468>>>End_Function //
30469>>>
30469>>>Function fsgCode_W_Zeroes Global Integer aiCode Integer aiPlaces Returns String
30470>>>    String rVal
30471>>>    Integer iLength iInt
30471>>>    Move aiCode to rVal
30472>>>    Move (trim(rVal)) to rVal
30473>>>    For iInt From 1 to (aiPlaces-(Length(rVal)))
30479>>>>
30479>>>        Move (Insert('0',rVal,1)) to rVal
30480>>>    Loop
30481>>>>
30481>>>    Function_Return rVal
30482>>>End_Function
30483>>>
30483>>>Function fsgCode_n_Zeroes Global number aiCode Integer aiPlaces Returns String
30484>>>    String rVal
30485>>>    Integer iLength iInt ipos
30485>>>    Move aiCode to rVal
30486>>>    Move (trim(rVal)) to rVal
30487>>>    MOVE (aiPlaces-(Length(rVal))) to ipos
30488>>>    For iInt From 1 to ipos
30494>>>>
30494>>>        Move (Insert('0',rVal,1)) to rVal
30495>>>    Loop
30496>>>>
30496>>>    Function_Return rVal
30497>>>End_Function
30498>>>
30498>>>
30498>>>Open Year
INCLUDING FILE: YEAR.FD
30500>>>Procedure EnumDDsForRebuildConstrain for DataDictionary integer aiMsg integer ahId
30501>>>    Send aiMsg to Self
30502>>>End_Procedure
30503>>>
30503>>>Procedure DoRefindYear for baseclass Integer aiPanel Integer aiYearDD
30504>>>    Integer liChanged
30505>>>
30505>>>    If ((aiYearDD = 0) or (Main_File(aiYearDD)<>Year.File_Number)) ;        Procedure_Return (Message_Box("Invalid Year_DD","Developer's Warning",MB_OK,MB_ICONWARNING))
30508>>>    If (Not(Current_Record(aiYearDD))) Begin
30510>>>        Get Should_Save of aiPanel to liChanged
30511>>>        Send Clear to aiYearDD
30512>>>        Move gs_Selected_Company_Code to Year.Company_Code
30513>>>        Move gs_Selected_Branch_Code  to Year.Branch_Code
30514>>>        Move gi_Selected_Year         to Year.Year_Year
30515>>>        Send Find to aiYearDD Eq 1 //Year.Index.1 - company_code+ranch_code+year_year
30516>>>        If (Not(liChanged)) Set Changed_State of aiPanel to False
30519>>>    End
30519>>>>
30519>>>End_Procedure
30520>>>
30520>>>Procedure RebuildConstrainIfYearChanged for baseclass Integer aiPanel String asCurrentYearRecr Integer aiYearDDId
30521>>>    Integer liSrvr
30522>>>    String  lsCurrentYearRecr
30522>>>
30522>>>    If (asCurrentYearRecr <> gs_Selected_Year_Recr) Begin
30524>>>        Broadcast Send EnumDDsForRebuildConstrain to aiPanel msg_Rebuild_Constraints Self
30526>>>    End
30526>>>>
30526>>>    Send DoRefindYear aiPanel aiYearDDId //(Year_DD(Self))
30527>>>    Get Server of aiPanel to liSrvr
30528>>>    // Respects Default values
30528>>>    If (liSrvr) If (Not(Current_Record(liSrvr))) Send Request_Clear to aiPanel
30533>>>End_Procedure
30534>>>
30534>>>//                                       ’¦ View            Property «¦¬ View             ’¦ Year DDO «¦¬ View
30534>>>//                                                          Holds the current year rec0
30534>>>// ‰¢ã©ž : Send RbldConstrIfYearChanged (Gplan_Test(Self))  (psCurrentYearRecr(Self))     (Year_DD(Self))
30534>>>
30534>>>
30534>>>Function fiRefindYear Global Returns Integer
30535>>>    Clear Year
30536>>>    Move gs_Selected_Company_Code to Year.Company_Code
30537>>>    Move gs_Selected_Branch_Code  to Year.Branch_Code
30538>>>    Move gi_Selected_Year         to Year.Year_Year
30539>>>    Find eq Year by Index.1 //company_code+ranch_code+year_year
30540>>>>
30540>>>    Function_Return (Found = 0)
30541>>>End_Function //fiRefindYear
30542>>>
30542>>>Procedure DoRunApplication for Baseclass String sAppName
30543>>>    string sRuntime  lsStr
30544>>>
30544>>>    Append lsStr 'C:\Dns.bat ' sAppName
30546>>>    RunProgram Wait  lsStr
30547>>>
30547>>>//    get_profile_string "defaults" "VDFBinDir" to sRuntime
30547>>>//    append sRuntime "\dfrun " sAppName
30547>>>    Append sRuntime 'C:\Program Files\Accessories\WORDPAD.EXE ' sAppName
30549>>>    runprogram background sRuntime
30550>>>End_procedure // DoRunApplication
30551>>>
30551>>>// Run the Editor
30551>>>Procedure DoRunEditor for Baseclass String asFile
30552>>>    string sRunPath lsWspcName
30553>>>    Move (WorkspaceName(ProgramWorkspace(Self))) to lsWspcName
30554>>>    get_profile_string ("workspaces\"+lsWspcName) "programpath" to sRunPath
30557>>>    //append sRunPath "\Editor "  asFile //// js 15/03/2002 " " lsWspcName
30557>>>    Move (Replace('.',asFile,'')) to asFile
30558>>>    append sRunPath asFile //// js 15/03/2002 " " lsWspcName
30559>>>    send DoRunApplication sRunPath
30560>>>End_Procedure // DoRunEditor
30561>>>
30561>>>//--------------------------------------
30561>>>
30561>>>//start of global functions and procedures
30561>>>
30561>>>
30561>>>//®¨ž© £¦§¦ œå«˜  ˜§æ: ˜) gmoves.dd    :private.update_gmhnes_ghmnies
30561>>>Function gsfFind_Previous Global String lsCode;                                 String lsDelimiter;                                 Returns String
30562>>>         String  lsTemp_Code1 lsTemp_Code2
30563>>>         Integer liCounter
30563>>>
30563>>>         //1.˜­˜å¨œ©ž ¡œ¤é¤
30563>>>         Move (Trim(lsCode)) to lsCode                                  //§® 30.12.345
30564>>>
30564>>>         //2.˜¤« ©«¨¦­ã
30564>>>         For liCounter From 1 to (Length(lsCode))
30570>>>>
30570>>>             Move (Insert(;                           (Mid(lsCode,1,liCounter)),;                           lsTemp_Code1,;                           1;                         )) to lsTemp_Code1                             //§® 543.21.03
30571>>>         Loop
30572>>>>
30572>>>
30572>>>         //3.˜­˜å¨œ©ž ¡œ¤é¤ (›â¤ ®¨œ áœ«˜ , safety only)
30572>>>         Move (Trim(lsTemp_Code1)) to lsTemp_Code1
30573>>>
30573>>>         //4.§˜å¨¤à £æ¤¦ «¦ ›œ¥ æ £â¨¦ª «¦¬ ˜¤«å©«¨¦­¦¬, £œ«á «¦ §¨é«¦ delimiter
30573>>>         Move (Right(;                      lsTemp_Code1,;                      ((Length(lsTemp_Code1))-((Pos(lsDelimiter,lsTemp_Code1))));                    )) to lsTemp_Code1                                  // §® 21.03
30574>>>
30574>>>         //5.¥˜¤á ˜¤« ©«¨¦­ã «¦¬ ˜¤«å©«¨¦­¦¬
30574>>>         For liCounter from 1 to (Length(lsTemp_Code1))
30580>>>>
30580>>>             Move (Insert(;                           (Mid(lsTemp_Code1,1,liCounter)),;                           lsTemp_Code2,;                           1;                         )) to lsTemp_Code2                             //§® 30.12
30581>>>         Loop
30582>>>>
30582>>>
30582>>>         Function_Return (Trim(lsTemp_Code2))
30583>>>End_Function //gsffind_previous
30584>>>
30584>>>
30584>>>Function gifSystem_Check Returns Integer
30585>>>         Integer liF_Gtypkins liF_Garicls liF_Gmoves liF_Gplans liF_Gmhnes liF_Ghmnies
30586>>>         Integer liS_Gtypkins liS_Garicls liS_Gmoves liS_Gplans liS_Gmhnes liS_Ghmnies
30586>>>//       Clear Company
30586>>>//       Find Gt Company.Recnum
30586>>>//       While (Found = 1)
30586>>>//             Add Company.Company_NumGtypkin to liS_Gtypkins § Ÿ˜¤é© ©«¦ sysfile ¤˜ «˜ ¡˜¨˜«áà ˜¬«á
30586>>>//             Add Company.Company_NumGarticl to liS_Garticls
30586>>>//             Add Company.Company_NumGmoves  to liS_Gmoves
30586>>>//             //d Company.Company_NumGtypkin to liS_Gtypkins
30586>>>//             Add Company.Company_NumGplan   to liS_GPlans
30586>>>//             Add Company.Company_NumGmhnes  to liS_Gmhnes
30586>>>//             Add Company.Company_NumGhmnies to liS_Ghmnies
30586>>>//             Find Gt Company.Recnum
30586>>>//       Loop
30586>>>//
30586>>>//       Get_Attribute {attribute} [of {file-handle} ;
30586>>>//                        [{field-num} | {index-num} [{segment-num}]]] ;
30586>>>//                        To {variable}
30586>>>//
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Garticl.File_Number to liF_Garticls
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmoves.File_Number  to liF_Gmoves
30586>>>//       //t_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gplan.File_Number   to liF_Gplans
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmhnes.File_Number  to liF_Gmhnes
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Ghmnies.File_Number to liF_Ghmnies
30586>>>//
30586>>>
30586>>>//       //â¢œš®¦ª DF_FILE_MAX_RECORDS+ £œ records used
30586>>>
30586>>>//       //â¢œš®¦ª last rec0 = sysrec rec0
30586>>>
30586>>>    Function_Return 0
30587>>>End_Function //gifSystem_Check
30588>>>
30588>>>/////////////////////////////////////////////////////////////////
30588>>>//‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª, £œ ž ®à¨åª ›œ¡˜› ¡á  JS
30588>>>Function Sfi_All_Numbers Global Number anValue Integer aiLengthAkeraios Integer aiLengthDekadika Returns String
30589>>>
30589>>>    String  lsRetval lsValue lsAkeraios lsDekadika
30590>>>    Integer liInt liInteger iTimes iStart
30590>>>    Number  lnDecimals
30590>>>
30590>>>    Move (Integer(anValue))                                         to liInteger
30591>>>    Move (Round(AnValue-(Integer(anValue))*(10^aiLengthDekadika)))  to lnDecimals
30592>>>
30592>>>    Move liInteger              to lsAkeraios
30593>>>    Move lnDecimals             to lsDekadika
30594>>>    Move (Trim(lsAkeraios))     to lsAkeraios
30595>>>    Move (Trim(lsDekadika))     to lsDekadika
30596>>>
30596>>>    Move (Length(lsAkeraios)) to iStart
30597>>>    For iTimes From iStart to (aiLengthAkeraios-1)
30603>>>>
30603>>>        Insert "0" in lsAkeraios at 1
30605>>>    Loop
30606>>>>
30606>>>    Move (Trim(lsAkeraios)) to lsAkeraios
30607>>>
30607>>>    Move (Length(lsDekadika)) to iStart
30608>>>    For iTimes From iStart to (aiLengthDekadika-1)
30614>>>>
30614>>>        Move (Append(lsDekadika,"0")) to lsDekadika
30615>>>    Loop
30616>>>>
30616>>>    Move (Trim(lsDekadika)) to lsDekadika
30617>>>
30617>>>    If (aiLengthDekadika=0) Move '' to lsDekadika
30620>>>    Move '' to lsRetVal
30621>>>    Move (Pad((lsAkeraios-lsDekadika),(aiLengthAkeraios+aiLengthDekadika))) to lsRetval
30622>>>    Function_Return lsRetval
30623>>>End_Function //sfi_All_Numbers  ‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª
30624>>>              //                 £œ ž ®à¨åª ›œ¡˜› ¡á (JS)
30624>>>
30624>>>Open Codemast
30626>>>
30626>>>
30626>>>Function gsfCode_Mast Global String lsType String lsValue Returns String
30627>>>         Clear Codemast
30628>>>         Move lsType  to Codemast.Type
30629>>>         Move lsValue to Codemast.Code
30630>>>         Find Eq Codemast by Index.1 //type+code
30631>>>>
30631>>>         Function_Return Codemast.Description
30632>>>End_Function //code_mast
30633>>>
30633>>>
30633>>>Open Branch
INCLUDING FILE: BRANCH.FD
30635>>>Function fsgCode_With_Zeroes Global Integer aiCode    ;                                    Integer aiPlaces  ;                                    String asCompany  ;                                    String asBranch   ;                               Returns String
30636>>>    String rVal
30637>>>    Integer iInt
30637>>>    Clear Branch
30638>>>    Move asCompany  to Branch.Company_Code
30639>>>    Move asBranch   to Branch.Branch_Code
30640>>>    Find Eq Branch by Index.1
30641>>>>
30641>>>    If (Trim(Branch.Tomeas_Code)<>'') Move (Trim(Branch.Tomeas_Code)) to asBranch
30644>>>    Move (Trim(asCompany))  to asCompany
30645>>>    Move (Trim(asBranch))   to asBranch
30646>>>    If (Length(asCompany)=1) Insert '0' In asCompany At 1
30650>>>    If (Length(asBranch) =1) Insert '0' In asBranch  At 1
30654>>>    Move ''                                           to rVal
30655>>>    Move (Sfi_All_Numbers(aiCode,aiPlaces,0))         to rVal
30656>>>    Move (Append((asCompany+'.'+asBranch+'.'),rVal))  to rVal
30657>>>    Move (Trim(rVal))                                 to rVal
30658>>>    Function_Return rVal
30659>>>End_Function
30660>>>
30660>>>Function fsgStripCodeFromID Global String asID Returns Integer
30661>>>      Integer iLen iPos iInt
30662>>>      If (Trim(asID)='') Function_Return 0
30665>>>      Move (Trim  (asID)) to asID
30666>>>      Move (Length(asID)) to iLen
30667>>>      For iInt From 1     to iLen
30673>>>>
30673>>>          If (Mid(asID,1,iInt)='.') Move iInt to iPos
30676>>>      Loop
30677>>>>
30677>>>      Function_Return (Right(asID,(iLen-iPos)))
30678>>>End_Function
30679>>>
30679>>>Function fsCityDescr Global Integer aiCityID Returns String
30680>>>    String rVal
30681>>>    Open Cities
INCLUDING FILE: CITIES.FD
30683>>>    Clear Cities
30684>>>    Move aiCityID to Cities.City_ID
30685>>>    Find Eq Cities By Index.1
30686>>>>
30686>>>    If (Found=1) Move Cities.City_descr to rVal
30689>>>    Else         Move '' to rVal
30691>>>    Function_Return rVal
30692>>>End_Function
30693>>>
30693>>>Function fiTownIDFromCity Global Integer aiCityID Returns Integer
30694>>>    Open Cities
30696>>>    Clear Cities
30697>>>    Move aiCityID to Cities.City_ID
30698>>>    Find Eq Cities By Index.1
30699>>>>
30699>>>    Function_Return Cities.Town_ID
30700>>>End_Function
30701>>>
30701>>>Function fiCountryIDFromTown Global Integer aiTownID Returns Integer
30702>>>    Open Towns
INCLUDING FILE: TOWNS.FD
30704>>>    Clear Towns
30705>>>    Move aiTownID to Towns.Town_ID
30706>>>    Find Eq Towns By Index.1
30707>>>>
30707>>>    Function_Return Towns.Country_ID
30708>>>End_Function
30709>>>
30709>>>Function fsTownDescr Global Integer aiTownID Returns String
30710>>>    String rVal
30711>>>    Open Towns
30713>>>    Clear Towns
30714>>>    Move aiTownID to Towns.Town_ID
30715>>>    Find Eq Towns By Index.1
30716>>>>
30716>>>    If (Found=1) Move Towns.Town_descr to rVal
30719>>>    Else         Move '' to rVal
30721>>>    Function_Return rVal
30722>>>End_Function
30723>>>
30723>>>Function fsCountryDescr Global Integer aiCountryID Returns String
30724>>>    String rVal
30725>>>    Open Country
INCLUDING FILE: COUNTRY.FD
30727>>>    Clear Country
30728>>>    Move aiCountryID to Country.Country_ID
30729>>>    Find Eq Country By Index.1
30730>>>>
30730>>>    If (Found=1) Move Country.Country_descr to rVal
30733>>>    Else         Move '' to rVal
30735>>>    Function_Return rVal
30736>>>End_Function
30737>>>
30737>>>Function fsAreaDescr Global Integer aiAreaID Returns String
30738>>>    String rVal
30739>>>    Open Areas
INCLUDING FILE: AREAS.FD
30741>>>    Clear Areas
30742>>>    Move aiAreaID to Areas.Area_ID
30743>>>    Find Eq Areas By Index.1
30744>>>>
30744>>>    If (Found=1) Move Areas.Area_descr to rVal
30747>>>    Else         Move '' to rVal
30749>>>    Function_Return rVal
30750>>>End_Function
30751>>>
30751>>>Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
30752>>>    Local String rVal lsTmp lsOO lsLL
30753>>>    Local Number lnOO lnLL
30753>>>
30753>>>    Move '' to lsOO
30754>>>    Move '' to lsLL
30755>>>    Move '' to rVal
30756>>>
30756>>>    Move (Integer(anTime))                              to lnOO
30757>>>
30757>>>    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
30758>>>
30758>>>    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
30761>>>    Else         Move (String(lnOO))                    to lsOO
30763>>>    Move (Trim(lsOO))                                   to lsOO
30764>>>
30764>>>    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
30767>>>    Else         Move (String(lnLL))                    to lsLL
30769>>>    Move (Trim(lsLL))                                   to lsLL
30770>>>
30770>>>    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
30771>>>
30771>>>    Move (Trim(rVal)) to rVal
30772>>>
30772>>>    Function_Return rVal
30773>>>End_Function
30774>>>
30774>>>Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
30775>>>    Local Number rVal nOres nLepta
30776>>>    Move (Integer(aiMinutes/60))    to nOres
30777>>>    Move (    Mod(aiMinutes,60))    to nLepta
30778>>>    Move (nOres+(nLepta/100))       to rVal
30779>>>    Function_Return rVal
30780>>>End_Function
30781>>>
30781>>>Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
30782>>>    Local Integer rVal
30783>>>    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
30784>>>    Function_Return rVal
30785>>>End_Function
30786>>>
30786>>>Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;                                                                    Number anEndTime    ;                                                                    Returns Integer
30787>>>    Local Integer rVal iMinStart iMinEnd
30788>>>
30788>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30791>>>
30791>>>    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
30792>>>    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
30793>>>    Move (iMinEnd-iMinStart)                                                     to rVal
30794>>>    Function_Return rVal
30795>>>End_Function
30796>>>
30796>>>
30796>>>Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;                                                                Number anEndTime    ;                                                                Returns Number
30797>>>    Local Integer iTmp
30798>>>    Local Number  rVal
30798>>>
30798>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30801>>>
30801>>>    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
30802>>>    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
30803>>>    Function_Return rVal
30804>>>End_Function
30805>>>
30805>>>
30805>>>
30805>>>Open WitemCL
INCLUDING FILE: WITEMCL.FD
30807>>>Open WitemCld
INCLUDING FILE: WITEMCLD.FD
30809>>>Open WitemxT
INCLUDING FILE: WITEMXT.FD
30811>>>
30811>>>Function fnTeleytaiaTimhAgoras String asPromCode String asItemCode  ;                               Date   adHmnia    Number anQty       ;                               Returns Number
30812>>>  Integer iExodos
30813>>>  Number nPoso nPct
30813>>>  Move 0 to nPoso
30814>>>  Move 0 to nPct
30815>>>  Move 0 to iExodos
30816>>>
30816>>>  Move (Trim(asItemCode)) to asItemCode
30817>>>  Move (Trim(asPromCode)) to asPromCode
30818>>>
30818>>>  // 1.Anazhthsh sto arxeio Witemcld
30818>>>  Clear Witemcld
30819>>>  Move asItemCode to Witemcld.Item_Code
30820>>>  Move asPromCode to Witemcld.Client_Code
30821>>>  Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30822>>>>
30822>>>  While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;                       (Witemcld.Client_Code= asPromCode) And ;                       (iExodos=0))
30826>>>      If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
30828>>>          Move 1 to iExodos
30829>>>               If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
30832>>>          Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
30836>>>      End
30836>>>>
30836>>>      Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30837>>>>
30837>>>  Loop
30838>>>>
30838>>>  If (iExodos) Begin
30840>>>      If (nPoso) Function_Return nPoso
30843>>>      Else Function_Return nPct
30845>>>  End
30845>>>>
30845>>>
30845>>>  // 2.Anazhthsh sto arxeio Witemcl
30845>>>  Clear WitemCL
30846>>>  Move (Trim(asPromCode)) to WitemCL.Client_Code
30847>>>  Move (Trim(asItemCode)) to WitemCL.Item_Code
30848>>>  Find Eq WitemCL By Index.1
30849>>>>
30849>>>  If (Found=1) Function_Return WitemCL.Client_Price
30852>>>
30852>>>  Function_Return 0
30853>>>End_Function
30854>>>
30854>>>
30854>>>Open BtnOrdd
INCLUDING FILE: BTNORDD.FD
30856>>>
30856>>>Function fnTeleytaiaTimhPolhshs String asWitemxRecr String asClientID ;                                String asWitemxCode Date   adHmnia    ;                                String asItemCode   Number anQty      ;                                String asCNCode     Returns Number
30857>>>
30857>>>  Integer iExodos iCheckDeop
30858>>>  Number nPoso nPct
30858>>>
30858>>>  Move (Num_Arguments=7) to iCheckDeop
30859>>>
30859>>>  Move 0 to nPoso
30860>>>  Move 0 to nPct
30861>>>  Move 0 to iExodos
30862>>>
30862>>>  Move (Trim(asItemCode))                 to asItemCode
30863>>>  Move (Trim(asClientID))                 to asClientID
30864>>>  Move (Trim(asWitemxRecr))               to asWitemxRecr
30865>>>  Move (Trim(asWitemxCode))               to asWitemxCode
30866>>>  If (iCheckDeop) Move (Trim(asCNCode))   to asCNCode
30869>>>
30869>>>  // 1. Anazhthsh apo DEOP ef' oson yparxei kodikos ergou
30869>>>  If (iCheckDeop) Begin
30871>>>      Clear btnordd
30872>>>      Move asClientID   to btnordd.vclient_id
30873>>>      Move asCNCode     to btnordd.vcn_code
30874>>>      Move asWitemxCode to btnordd.vitem
30875>>>      Move 0            to btnordd.vactive
30876>>>      Move adHmnia      to btnordd.arxh_date
30877>>>      Find LE btnordd by index.4//client_id+cn_code+item+arxh_date
30878>>>>
30878>>>      If ((found=1) and (asWitemxCode=btnordd.vitem)    and (adHmnia>=btnordd.arxh_date) ;                    and (adHmnia<=btnordd.deop_date)    and (btnordd.vactive=0)          ;                    and (asCNCode=btnordd.vcn_code)) begin
30880>>>          move btnordd.vprice to nPoso
30881>>>          If (nPoso) Function_Return nPoso
30884>>>      End
30884>>>>
30884>>>  End
30884>>>>
30884>>>
30884>>>  // 2.Anazhthsh sto arxeio Witemcld (Timokatalogos Pelath/Eidous)
30884>>>  Clear Witemcld
30885>>>  Move asItemCode to Witemcld.Item_Code
30886>>>  Move asClientID to Witemcld.Client_Code
30887>>>  Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30888>>>>
30888>>>  While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;                       (Witemcld.Client_Code= asClientID) And ;                       (iExodos=0))
30892>>>      If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
30894>>>          Move 1 to iExodos
30895>>>               If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
30898>>>          Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
30902>>>      End
30902>>>>
30902>>>      Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30903>>>>
30903>>>  Loop
30904>>>>
30904>>>  If (iExodos) Begin
30906>>>      If (nPoso) Function_Return nPoso
30909>>>      Else Function_Return nPct
30911>>>  End
30911>>>>
30911>>>
30911>>>
30911>>>  // 3.Anazhthsh sto arxeio Witemxt (Timokatalogos Eidous)
30911>>>  Clear Witemxt
30912>>>  Move SysCurXr.Company_Code  to Witemxt.Company_Code
30913>>>  Move SysCurXr.Branch_Code   to Witemxt.Branch_Code
30914>>>  Move SysCurXr.Year_Year     to Witemxt.Year_Year
30915>>>  Move asWitemxRecr           to Witemxt.Witemx_Recr
30916>>>  Find Gt Witemxt By Index.1 // Witemxt:Index.1
30917>>>>
30917>>>  While ((Found=1) And (Witemxt.Company_Code = SysCurXr.Company_Code) And ;                       (Witemxt.Branch_Code  = SysCurXr.Branch_Code ) And ;                       (Witemxt.Year_Year    = SysCurXr.Year_Year   ) And ;                       (Witemxt.Witemx_Recr  = asWitemxRecr         ) And ;                       (iExodos=0))
30921>>>      If ((adHmnia>=Witemxt.Value_Date) And (anQty<=Witemxt.Qty)) Begin
30923>>>          Move 1 to iExodos
30924>>>               If (Witemxt.Axia0 <>0) Move  Witemxt.Axia0         to nPoso
30927>>>          Else If (Witemxt.PcDisc<>0) Move (Witemxt.PcDisc*(-1))  to nPct
30931>>>      End
30931>>>>
30931>>>      Find Gt Witemxt By Index.1 // Witemxt:Index.1
30932>>>>
30932>>>  Loop
30933>>>>
30933>>>  If (iExodos) Begin
30935>>>      If (nPoso) Function_Return nPoso
30938>>>      Else Function_Return nPct
30940>>>  End
30940>>>>
30940>>>
30940>>>
30940>>>  // 4.Anazhthsh sto arxeio Witemcl (Teleytaia Timh Agoras)
30940>>>  Clear WitemCL
30941>>>  Move (Trim(asClientID)) to WitemCL.Client_Code
30942>>>  Move (Trim(asItemCode)) to WitemCL.Item_Code
30943>>>  Find Eq WitemCL By Index.1
30944>>>>
30944>>>  If (Found=1) Function_Return WitemCL.Client_Price
30947>>>
30947>>>  Function_Return 0
30948>>>End_Function
30949>>>
30949>>>Function fsStripTextFieldFromEnter Global String asStr Returns String
30950>>>    String sEnter
30951>>>    Move '' to sEnter
30952>>>    Move (Trim(asStr)) to asStr
30953>>>    Append sEnter (Character(13)) (Character(10))
30955>>>    Move (Replaces(sEnter,asStr,' ')) to asStr
30956>>>    Function_return (Trim(asStr))
30957>>>End_function
30958>>>
30958>>>
30958>>>//end   of global functions and procedures
30958>>>Use Wait.DG
INCLUDING FILE: WAIT.DG
30958>>>>>USE AllEntSc
30958>>>>>
30958>>>>>//AB-IgnoreEnd
30958>>>>>
30958>>>>>
30958>>>>>//AB-IgnoreEnd
30958>>>>>
30958>>>>>Object Wait is a ModalPanelSub
30960>>>>>
30960>>>>>    //AB-StoreTopStart
30960>>>>>
30960>>>>>    // How to Use It
30960>>>>>    // Get the maximum position of the bar
30960>>>>>    // Move (Bar_Maximum_position(Wait(self))) to iMax
30960>>>>>    //
30960>>>>>    // Set the maximum position of the bar
30960>>>>>    // Set Bar_Maximum_position of (Wait(self)) to iMax
30960>>>>>    //
30960>>>>>    // Start Bar Progress from beginning
30960>>>>>    // Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
30960>>>>>    //
30960>>>>>    // End Bar Progress
30960>>>>>    // Send Bar_Current_Position to (Wait(Self)) iMax iMax iMax False
30960>>>>>    //
30960>>>>>    // Update Bar Progress
30960>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax True OR
30960>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax False
30960>>>>>    // When you want the update to be done for every i (this is slower)
30960>>>>>    // Where i=Counter's current value, icounter=Counter's Max Value and iMax=Bar Max Position
30960>>>>>    //
30960>>>>>    // Display Buttons on the object
30960>>>>>    // Set Button_State of (Wait(Self)) to False/True
30960>>>>>    // If the Progress Bar gets initialized without buttons, it MUST be Deactivated
30960>>>>>    //
30960>>>>>    // Initialization of the Progress Bar
30960>>>>>    // Send Popup to (Wait(Self))
30960>>>>>    //
30960>>>>>    // Deactivation of the Progress Bar
30960>>>>>    // Send Deactivate to (Wait(Self))
30960>>>>>    //
30960>>>>>    // Message during the process
30960>>>>>    // Set Wait_Message of (Wait(Self)) to "Now Processing..."
30960>>>>>    //
30960>>>>>    // Extra Info for button "Info >>"
30960>>>>>    // Send Wait_Details to (Wait(Self)) sFile sDetail bInitData
30960>>>>>    // If sFile<>'' then reads the contents of the file
30960>>>>>    // Else Fills the Edit with the string of sDetail
30960>>>>>    // If bInitData is True then the edit object is cleared first else extra info is appended
30960>>>>>    //
30960>>>>>    // Remarks instead of Progress Bar
30960>>>>>    // Set Button_State of (Wait(Self))     to False
30960>>>>>    // Set BarVisibleState of (Wait(Self))  to 'Remarks' False
30960>>>>>    // Update During Process
30960>>>>>    // Send UpdateWait to (Wait(Self)) 'Remarks'
30960>>>>>
30960>>>>>    //AB-StoreTopEnd
30960>>>>>
30960>>>>>    Set Exit_Application_Local_State to FALSE
30961>>>>>    Set Modal_State to FALSE
30962>>>>>    Set Popup_State to TRUE
30963>>>>>    Set Border_Style to Border_Thick
30964>>>>>    Set Minimize_Icon to FALSE
30965>>>>>    Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
30966>>>>>    Set Size to 138 256
30967>>>>>
30967>>>>>    //AB-DDOStart
30967>>>>>
30967>>>>>
30967>>>>>    //AB-DDOEnd
30967>>>>>
30967>>>>>    Object WaitBar is a ProgressBarSub
30969>>>>>
30969>>>>>        //AB-StoreTopStart
30969>>>>>
30969>>>>>        //AB-StoreTopEnd
30969>>>>>
30969>>>>>        Set Size to 21 243
30970>>>>>        Set Location to 7 4
30971>>>>>
30971>>>>>        //AB-StoreStart
30971>>>>>        Send DoRegSize  self smTopRight
30972>>>>>        //AB-StoreEnd
30972>>>>>
30972>>>>>    End_Object
30973>>>>>
30973>>>>>    Object WaitText is a TextBoxSub
30975>>>>>
30975>>>>>        //AB-StoreTopStart
30975>>>>>
30975>>>>>        //AB-StoreTopEnd
30975>>>>>
30975>>>>>        Set Enabled_State to TRUE
30976>>>>>        Set Label to "Processing"
30977>>>>>        Set FontSize to 4 0
30978>>>>>        Set Size to 10 81
30979>>>>>        Set Location to 36 5
30980>>>>>
30980>>>>>        //AB-StoreStart
30980>>>>>
30980>>>>>        //AB-StoreEnd
30980>>>>>
30980>>>>>    End_Object
30981>>>>>
30981>>>>>    Object bnCancel is a ButtonSub
30983>>>>>
30983>>>>>        //AB-StoreTopStart
30983>>>>>
30983>>>>>        //AB-StoreTopEnd
30983>>>>>
30983>>>>>        Set Default_State to TRUE
30984>>>>>        Set Label to "OK"
30985>>>>>        Set Location to 34 143
30986>>>>>
30986>>>>>        //AB-StoreStart
30986>>>>>
30986>>>>>        Procedure OnClick
30988>>>>>             Send Deactivate to (Wait(Self))
30989>>>>>        End_Procedure
30990>>>>>
30990>>>>>        Send DoRegAlign self amTopRight
30991>>>>>        //AB-StoreEnd
30991>>>>>
30991>>>>>    End_Object
30992>>>>>
30992>>>>>    Object bnDetail is a ButtonSub
30994>>>>>
30994>>>>>        //AB-StoreTopStart
30994>>>>>
30994>>>>>        //AB-StoreTopEnd
30994>>>>>
30994>>>>>        Set Focus_Mode to Pointer_Only
30995>>>>>        Set Label to "Info >>"
30996>>>>>        Set Location to 34 197
30997>>>>>
30997>>>>>        //AB-StoreStart
30997>>>>>
30997>>>>>        Procedure OnClick
30999>>>>>            Delegate Send Show_Details False
31001>>>>>        End_Procedure
31002>>>>>
31002>>>>>        Send DoRegAlign self amTopRight
31003>>>>>        //AB-StoreEnd
31003>>>>>
31003>>>>>    End_Object
31004>>>>>
31004>>>>>    Object LineControlSub1 is a LineControlSub
31006>>>>>
31006>>>>>        //AB-StoreTopStart
31006>>>>>
31006>>>>>        //AB-StoreTopEnd
31006>>>>>
31006>>>>>        Set Size to 2 243
31007>>>>>        Set Location to 54 4
31008>>>>>
31008>>>>>        //AB-StoreStart
31008>>>>>
31008>>>>>        Send DoRegSize  self smTopRight
31009>>>>>        //AB-StoreEnd
31009>>>>>
31009>>>>>    End_Object
31010>>>>>
31010>>>>>    Object WaitEdit is a editSub
31012>>>>>
31012>>>>>        //AB-StoreTopStart
31012>>>>>
31012>>>>>        //AB-StoreTopEnd
31012>>>>>
31012>>>>>        Set Enabled_State to FALSE
31013>>>>>        Set Read_Only_State to TRUE
31014>>>>>        Set Size to 58 243
31015>>>>>        Set Location to 60 4
31016>>>>>        Set Color to clWhite
31017>>>>>
31017>>>>>        //AB-StoreStart
31017>>>>>
31017>>>>>        Send DoRegSize Self amBottomRight
31018>>>>>        Delegate Set Size to 66 256
31020>>>>>
31020>>>>>        //AB-StoreEnd
31020>>>>>
31020>>>>>    End_Object
31021>>>>>
31021>>>>>    Object oTxtAntiBar is a TextBoxSub
31023>>>>>        Set Enabled_State to TRUE
31024>>>>>        Set Visible_State to FALSE
31025>>>>>        Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
31026>>>>>        Set Justification_Mode to (jMode_Center IOR jMode_VCenter)
31027>>>>>        Set Auto_Size_State to FALSE
31028>>>>>        Set FontWeight to 600
31029>>>>>        Set FontSize to 4 0
31030>>>>>        Set Size to 10 209
31031>>>>>        Set Location to 10 4
31032>>>>>        Set TextColor to clNavy
31033>>>>>    End_Object
31034>>>>>
31034>>>>>
31034>>>>>    //AB-StoreStart
31034>>>>>    Property Integer piWaitSize  Public (Size(Self))
31036>>>>>    Property Integer piPrevSize  Public (Size(Self))
31038>>>>>    Property Integer piState     Public False
31040>>>>>
31040>>>>>    Set Locate_Mode to Center_On_Screen
31041>>>>>    Set Destroy_Object_State to True
31042>>>>>
31042>>>>>    Procedure Show_Details Integer bAlways
31044>>>>>        Local Integer liOriSize liSize hiSize hiOriSize lowSize bState
31045>>>>>        Local String sLabel
31045>>>>>        Get Size                to liSize
31046>>>>>        Get piState             to bState
31047>>>>>        Get piWaitSize          to liOriSize
31048>>>>>        Move (Hi(liSize))       to hiSize
31049>>>>>        Move (Low(liSize))      to lowSize
31050>>>>>        Move (Hi(liOriSize))    to hiOriSize
31051>>>>>        If (bAlways) Begin
31053>>>>>            Set piState         to False
31054>>>>>            Move 0              to bState
31055>>>>>        End
31055>>>>>>
31055>>>>>        If bState Begin
31057>>>>>             Set Size to hiOriSize lowSize
31058>>>>>             Set Label of (bnDetail(Self)) to "Info >>"
31059>>>>>        End
31059>>>>>>
31059>>>>>        Else Begin
31060>>>>>             Set Size to 138 lowSize
31061>>>>>             Set Label of (bnDetail(Self)) to "<< Info"
31062>>>>>        End
31062>>>>>>
31062>>>>>        Set piState to (1-bState)
31063>>>>>    End_Procedure
31064>>>>>
31064>>>>>    Procedure Bar_Current_Position Integer iCount Integer iOccurances Integer iMaximum Integer bState
31066>>>>>       If (bState) Begin
31068>>>>>         If (Mod(iCount,(iCount*((Number(iMaximum))/(Number(iOccurances)))))=0) ;            Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
31071>>>>>       End
31071>>>>>>
31071>>>>>       Else Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
31073>>>>>    End_Procedure
31074>>>>>
31074>>>>>    Procedure DoInitialize_WaitBar
31076>>>>>        Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
31077>>>>>    End_Procedure
31078>>>>>
31078>>>>>    Procedure DoTerminate_WaitBar
31080>>>>>        Local Integer iMax
31081>>>>>        Get Maximum_position of (WaitBar(Self)) to iMax
31082>>>>>        Send Bar_Current_Position to (Wait(Self)) iMax iMax Imax False
31083>>>>>    End_Procedure
31084>>>>>
31084>>>>>    Procedure Set Bar_Maximum_Position Integer iMaximum
31086>>>>>         Set Maximum_position of (WaitBar(Self)) to iMaximum
31087>>>>>    End_Procedure
31088>>>>>
31088>>>>>    Function Bar_Maximum_Position Returns Integer
31090>>>>>        Function_Return (Maximum_position(WaitBar(Self)))
31091>>>>>    End_Function
31092>>>>>
31092>>>>>    Procedure Set Bar_Minimum_Position Integer iMinimum
31094>>>>>         Set Minimum_position of (WaitBar(Self)) to iMinimum
31095>>>>>    End_Procedure
31096>>>>>
31096>>>>>    Function Bar_Minimum_Position Returns Integer
31098>>>>>        Function_Return (Minimum_position(WaitBar(Self)))
31099>>>>>    End_Function
31100>>>>>
31100>>>>>    Procedure Set Bar_Step_Value Integer iStep
31102>>>>>         Set Step_Value of (WaitBar(Self)) to iStep
31103>>>>>    End_Procedure
31104>>>>>
31104>>>>>    Function Bar_Step_Value Returns Integer
31106>>>>>        Function_Return (Step_Value(WaitBar(Self)))
31107>>>>>    End_Function
31108>>>>>
31108>>>>>    Procedure Set Wait_Message String sMessage
31110>>>>>        Set Value of (WaitText(Self)) to sMessage
31111>>>>>    End_Procedure
31112>>>>>
31112>>>>>    Procedure Wait_Details String sFile String sDetail Integer bInitData
31114>>>>>        Local Integer liEditId
31115>>>>>        Move (WaitEdit(Self)) to liEditId
31116>>>>>        If bInitData Send Delete_Data to liEditId
31119>>>>>        If sFile ne "" Begin
31121>>>>>           Send Read to liEditId sFile
31122>>>>>           Send Beginning_Of_Data to liEditId
31123>>>>>        End
31123>>>>>>
31123>>>>>        Else Begin
31124>>>>>           Send Insert to liEditId sDetail
31125>>>>>        End
31125>>>>>>
31125>>>>>    End_Procedure
31126>>>>>
31126>>>>>    Procedure OnResize
31128>>>>>        Local Integer liSize liHiSize liPrevSize liHiPrevSize bState liHiLoc liLoc
31129>>>>>        Get Size to liPrevSize
31130>>>>>        Move (Hi(liPrevSize)) to liHiPrevSize
31131>>>>>        Forward Send OnResize
31133>>>>>        Get Location of (WaitEdit(Self)) to liLoc
31134>>>>>        Move (Hi(liLoc)) to liHiLoc
31135>>>>>        Get piState to bState
31136>>>>>        Get Size to liSize
31137>>>>>        Move (Hi(liSize)) to liHiSize
31138>>>>>        If (liHiSize > (liHiLoc +30)) Begin
31140>>>>>            Set Value of (bnDetail(Self)) to "<< Info"
31141>>>>>            If (liHiPrevSize <= (liHiLoc +30)) Set piState to (1-bState)
31144>>>>>        End
31144>>>>>>
31144>>>>>        Else Begin
31145>>>>>            Set Value of (bnDetail(Self)) to "Info >>"
31146>>>>>            If (liHiPrevSize > (liHiLoc +30)) Set piState to (1-bState)
31149>>>>>        End
31149>>>>>>
31149>>>>>    End_Procedure
31150>>>>>
31150>>>>>    Procedure Set Button_State Integer bState
31152>>>>>        If bState Begin
31154>>>>>            Set Caption_Bar to True
31155>>>>>            Set Size to 66 256
31156>>>>>        End
31156>>>>>>
31156>>>>>        Else Begin
31157>>>>>            Set Caption_Bar to False
31158>>>>>            Set Size to 38 256
31159>>>>>        End
31159>>>>>>
31159>>>>>    End_Procedure
31160>>>>>
31160>>>>>    Procedure Set BarVisibleState String sMsg Integer bState
31162>>>>>        Set Visible_State of (oTxtAntiBar(Self)) to (bState = 0)
31163>>>>>        Set Visible_State of (WaitBar(Self))     to (bState = 1)
31164>>>>>        If (bState = 0) Begin
31166>>>>>            Set Size to 24 256
31167>>>>>            Set Location of (oTxtAntiBar(Self)) to 6 5
31168>>>>>        End
31168>>>>>>
31168>>>>>        If sMsg ne "" Set Value of (oTxtAntiBar(Self)) to sMsg
31171>>>>>    End_Procedure
31172>>>>>
31172>>>>>    Procedure Deactivating integer search_mode Returns Integer
31174>>>>>        local integer rval
31175>>>>>        Forward Get MSG_Deactivating search_mode to rval
31177>>>>>        Set Modal_State of (Wait(Self)) to False
31178>>>>>        Set BarVisibleState of (Wait(Self)) to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..." True
31179>>>>>        Procedure_Return rval
31180>>>>>    End_Procedure
31181>>>>>
31181>>>>>    Procedure UpdateWait String sMsg
31183>>>>>        Set Value of (oTxtAntiBar(Self)) to sMsg
31184>>>>>    End_Procedure
31185>>>>>
31185>>>>>
31185>>>>>    Procedure Set Horizontal_Justification Integer aiMode
31187>>>>>        Set Justification_Mode of oTxtAntiBar to (jMode_VCenter IOR aiMode)
31188>>>>>    End_Procedure
31189>>>>>
31189>>>>>
31189>>>>>
31189>>>>>
31189>>>>>
31189>>>>>
31189>>>>>    //AB-StoreEnd
31189>>>>>
31189>>>>>End_Object
31190>>>>>
31190>>>>>
31190>>>>>//AB-StoreStart
31190>>>>>
31190>>>>>//AB-StoreEnd
31190>>>>>
31190>>>>>//AB/ End_Object    // prj
31190>>>
31190>Use Calendar.sl
INCLUDING FILE: CALENDAR.SL
31190>>>//AB/ Project Calendar
31190>>>//AB/ Object prj is a Lookup_Project
31190>>>//AB/     Set ProjectName to "Calendar"
31190>>>//AB/     Set ProjectFileName to "Calendar.sl"
31190>>>
31190>>>// Project Object Structure
31190>>>//   oCalendar is a dbModalPanel
31190>>>//     Container3d1 is a Container3d
31190>>>//       Grid2 is a Grid
31190>>>//       Textbox2 is a Textbox
31190>>>//       Textbox3 is a Textbox
31190>>>//       Textbox4 is a Textbox
31190>>>//       Textbox5 is a Textbox
31190>>>//       Textbox6 is a Textbox
31190>>>//       Textbox7 is a Textbox
31190>>>//       Textbox8 is a Textbox
31190>>>//       LineControl1 is a LineControl
31190>>>//       Container3d2 is a Container3d
31190>>>//         oRght is a BitmapContainer
31190>>>//         oLeft is a BitmapContainer
31190>>>//         oMonth is a Textbox
31190>>>//           oSelectMonth is a FloatingPopupMenu
31190>>>//         oYear is a Textbox
31190>>>//         oSelectYear is a Form
31190>>>//     BitmapContainer3 is a BitmapContainer
31190>>>//     oToday is a Textbox
31190>>>
31190>>>// Register all objects
31190>>>Register_Object BitmapContainer3
31190>>>Register_Object Container3d1
31190>>>Register_Object Container3d2
31190>>>Register_Object Grid2
31190>>>Register_Object LineControl1
31190>>>Register_Object oCalendar
31190>>>Register_Object oLeft
31190>>>Register_Object oMonth
31190>>>Register_Object oRght
31190>>>Register_Object oSelectMonth
31190>>>Register_Object oSelectYear
31190>>>Register_Object oToday
31190>>>Register_Object oYear
31190>>>Register_Object Textbox2
31190>>>Register_Object Textbox3
31190>>>Register_Object Textbox4
31190>>>Register_Object Textbox5
31190>>>Register_Object Textbox6
31190>>>Register_Object Textbox7
31190>>>Register_Object Textbox8
31190>>>
31190>>>
31190>>>
31190>>>//AB-StoreTopStart
31190>>>Use dates.utl
INCLUDING FILE: DATES.UTL
31190>>>>>// **********************************************************************
31190>>>>>// Use Dates.utl    // Date manipulation for VDF and DF3.1
31190>>>>>//
31190>>>>>// by Sture Andersen (sa1@vd.dk)
31190>>>>>//
31190>>>>>// The file contains a number of global functions for manipulating
31190>>>>>// dates. The package may be used with DataFlex 3.1 and Visual DataFlex.
31190>>>>>// This package is public domain.
31190>>>>>//
31190>>>>>// The package file is accompanied by a Word document (dfutil.doc)
31190>>>>>// listing the functions and their use.
31190>>>>>//
31190>>>>>//
31190>>>>>// Create: Fri  06-06-1997 - Merger of s_utl020, 021, 022, 023, 024, 025.
31190>>>>>// Update: Thu  26-06-1997 - Fixes for strange behavior when date4_state is set.
31190>>>>>//                         - Addition of popup_calendar to VDF.
31190>>>>>//         Sun  29-06-1997 - Character mode popup calender.
31190>>>>>//         Fri  04-07-1997 - Function WeekToDate added.
31190>>>>>//         Thu  10-07-1997 - Fixes.
31190>>>>>//         Mon  11-08-1997 - WeekToDate fixed.
31190>>>>>//         Sun  24-08-1997 - Character mode popup calender finished.
31190>>>>>//         Mon  15-12-1997 - Procedure Request_Popup_Calendar added.
31190>>>>>//         Mon  29-12-1997 - Procedures ItemYear2to4, ItemDate2to4 and
31190>>>>>//                           ItemSysdate added.
31190>>>>>//         Mon  29-12-1997 - Procedures FieldYear2to4, FieldDate2to4 and
31190>>>>>//                           FieldSysdate added.
31190>>>>>//         Sun  01-02-1998 - Functions Module_Compile_Date and
31190>>>>>//                           Module_Compile_Time added.
31190>>>>>//         Wed  25-02-1998 - Request_Popup in calendar object now only
31190>>>>>//                           responds if entry_state of the calling object
31190>>>>>//                           is true (VDF version). (No apparent effect)
31190>>>>>//         Sat  28-03-1998 - Added the following functions:
31190>>>>>//                             TS_SysTime      TS_ExtractDate
31190>>>>>//                             TS_ExtractTime  TS_ConvertToString
31190>>>>>//         Tue  26-05-1998 - Procedure TS_UI_Update added
31190>>>>>//         Sat  01-08-1998 - mask_date_window taken into account
31190>>>>>//         Mon  10-08-1998 - Functions Module_Start_Date and
31190>>>>>//                           Module_Start_Time added.
31190>>>>>//         Wed  02-09-1998 - Parameter for Module_Start_Date removed
31190>>>>>//         Mon  12-10-1998 - Portuguese added
31190>>>>>//         Wed  04-11-1998 - TS_TimeEstimator class added
31190>>>>>//         Tue  29-12-1998 - Function DateAsString added
31190>>>>>//         Wed  13-01-1999 - Function DateWeekNumber changed according to
31190>>>>>//                           Kjetil Johanson
31190>>>>>//         Mon  18-01-1999 - Function DateWeekNumber changed according to
31190>>>>>//                           Kjetil Johanson (again)
31190>>>>>//         Tue  19-01-1999 - Changed procedure names in TS_TimeEstimator
31190>>>>>//                           class (Continue->TS_Continue and Pause->
31190>>>>>//                           TS_Pause)
31190>>>>>//         Thu  21-01-1999 - Procedures DateFormatAsString and DateFormatName
31190>>>>>//                           added.
31190>>>>>//                         - Procedures DateCurrentSeparator and
31190>>>>>//                           DateCurrentFormat added.
31190>>>>>//         Tue  13-04-1999 - Julian constants added: Jan1st1900, Jan1st2000
31190>>>>>//                           Jan1st1000 and Jan1st100
31190>>>>>//         Mon  26-04-1999 - Changed procedure FieldYear2to4 and ItemYear2to4
31190>>>>>//                           to trap 3 digit years.
31190>>>>>//         Wed  27-04-1999 - Changed Dutch abbriviated day names (to 2 characters)
31190>>>>>//         Sun  02-05-1999 - Added function TS_Compose2
31190>>>>>//                         - Fixed error in TS_ConvertToString
31190>>>>>//         Tue  01-06-1999 - Added procedure popup_no_export to calendar.
31190>>>>>//         Thu  15-06-1999 - Fixed Date4to2 function and exporting dates
31190>>>>>//                           from the calendar to forms with no form_margin.
31190>>>>>//         Tue  07-09-1999 - Added function DateAsText
31190>>>>>//         Wed  27-10-1999 - Temporary fix for Module_Compile_Date function
31190>>>>>//                           in combination with y2k.
31190>>>>>//         Wed  19-12-1999 - Function StringToDate added.
31190>>>>>//                         - Existing function DateAsString renamed to
31190>>>>>//                           DateToString.
31190>>>>>//         Mon  03-01-2000 - Fix for VDF4. Popup calendar on empty date field
31190>>>>>//                           would result in seeding the calendar on year 100.
31190>>>>>//                           This error was caused by the fact that VDF 4
31190>>>>>//                           ignores SYSDATE4_STATE such that the sysdate
31190>>>>>//                           command returns 03-01-100
31190>>>>>//         Wed  01-02-2000 - Define instead of #REPLACE
31190>>>>>//         Wed  23-08-2000 - Function TS_Module_Compile_Time added
31190>>>>>//
31190>>>>>// NOTE:  There is language dependent string constants in this file.
31190>>>>>//        Currently there are sections for dutch, english, danish, swedish,
31190>>>>>//        norwegian, spanish, german and portuguese
31190>>>>>//
31190>>>>>//        These sections may be identified by searching the symbol LNG_DEFAULT
31190>>>>>//
31190>>>>>// ***********************************************************************
31190>>>>>
31190>>>>>Use ui
31190>>>>>Use Language    // Set default languange if not set by compiler command line
INCLUDING FILE: LANGUAGE.PKG
31190>>>>>>>// Use Language     // Default language setup
31190>>>>>>>// Sets default languange if not set by compiler command line
31190>>>>>>>
31190>>>>>>>define lng_dutch      for 131
31190>>>>>>>define lng_french     for 133 // NOT TRANSLATED. DO NOT SELECT!
31190>>>>>>>define lng_spanish    for 134
31190>>>>>>>define lng_italian    for 139 // NOT TRANSLATED. DO NOT SELECT!
31190>>>>>>>define lng_english    for 144
31190>>>>>>>define lng_danish     for 145
31190>>>>>>>define lng_swedish    for 146
31190>>>>>>>define lng_norwegian  for 147
31190>>>>>>>define lng_Greek    for 148
31190>>>>>>>define lng_german     for 149
31190>>>>>>>define lng_portuguese for 155
31190>>>>>>>define lng_papiamentu for 199 // NOT TRANSLATED. DO NOT SELECT!
31190>>>>>>>
31190>>>>>>>
31190>>>>>>>define lng_default for !@
31190>>>>>>>
31190>>>>>>>  define _LANGUAGE_ for $ENGLISH$
31190>>>>>>>
#REM LANGUAGE SET BY LANGUAGE.PKG: $ENGLISH$
31190>>>>>Use Seq_Chnl    // Defines global sequential device management operations (DAC)
31190>>>>>Use Macros.utl  // Various macros (DESKTOP_SECTION)
INCLUDING FILE: MACROS.UTL
31190>>>>>>>// Use Macros.utl   // Various macros (FOR_EX...)
31190>>>>>>>
31190>>>>>>>//  FOR_EX (extended FOR command)
31190>>>>>>>//  -----------------------------
31190>>>>>>>//> The FOR_EX command is exactly like the standard FOR command except
31190>>>>>>>//> that it will allow you to use keyword "DOWN_TO" instead of "TO" if
31190>>>>>>>//> you need to do a decremental loop.
31190>>>>>>>
31190>>>>>>>
31190>>>>>>>//  DESKTOP_SECTION
31190>>>>>>>//  ---------------
31190>>>>>>>//> The DESKTOP_SECTION/END_DESKTOP_SECTION commands will make a sequence of
31190>>>>>>>//> code compile (or rather instantiate) as if it was situated on the DESKTOP
31190>>>>>>>//> even when it isn't. DESKTOP_SECTION's may not be nested.
31190>>>>>>>
31190>>>>>>>
31190>>>>>>>
31190>>>>>
31190>>>>>// Switches
31190>>>>>
31190>>>>>define DATES_INCLUDE_POPUP for 1   // If set to 0 the popup calendar will not be included
31190>>>>>define DATES_DF31B_EPOCH   for 40  // DF3.1b didn't have an epoch setting. Therefore this symbol defines the epoch value for that version.
31190>>>>>
31190>>>>> define t.calendar.year           for "Year"
31190>>>>> define t.calendar.month          for "Month"
31190>>>>> define t.calendar.day            for "Day"
31190>>>>> define t.calendar.week           for "Wk."
31190>>>>> define t.calendar.calendar_popup for "Calendar Popup"
31190>>>>> define t.calendar.Monday         for "Monday"
31190>>>>> define t.calendar.Tuesday        for "Tuesday"
31190>>>>> define t.calendar.Wednesday      for "Wednesday"
31190>>>>> define t.calendar.Thursday       for "Thursday"
31190>>>>> define t.calendar.Friday         for "Friday"
31190>>>>> define t.calendar.Saturday       for "Saturday"
31190>>>>> define t.calendar.Sunday         for "Sunday"
31190>>>>> define t.calendar.January        for "January"
31190>>>>> define t.calendar.February       for "February"
31190>>>>> define t.calendar.March          for "March"
31190>>>>> define t.calendar.April          for "April"
31190>>>>> define t.calendar.May            for "May"
31190>>>>> define t.calendar.June           for "June"
31190>>>>> define t.calendar.July           for "July"
31190>>>>> define t.calendar.August         for "August"
31190>>>>> define t.calendar.September      for "September"
31190>>>>> define t.calendar.October        for "October"
31190>>>>> define t.calendar.November       for "November"
31190>>>>> define t.calendar.December       for "December"
31190>>>>> define t.calendar.ok             for "OK"
31190>>>>> define t.calendar.Cancel         for "Cancel"
31190>>>>> define t.calendar.Activate       for "Activate popup calendar (Ctrl+D)"
31190>>>>>
31190>>>>>define LargestPossibleDate for 913490 // December 31st 2500
31190>>>>>define Jan1st1900          for 693975
31190>>>>>define Jan1st2000          for 730500
31190>>>>>define Jan1st1000          for 365250
31190>>>>>define Jan1st105           for 38352
31190>>>>>define Jan1st100           for 36525
31190>>>>>
31190>>>>>enumeration_list // Date Segments
31190>>>>>  define DS_DAY
31190>>>>>  define DS_WEEK
31190>>>>>  define DS_MONTH
31190>>>>>  define DS_YEAR
31190>>>>>end_enumeration_list
31190>>>>>
31190>>>>>integer Dates$Year Dates$Month Dates$Day // internal use
31190>>>>>
31190>>>>>procedure DateDecompose global date date# //very internal!!
31191>>>>>  local integer pos1# pos2# format#
31192>>>>>  local string str# sep#
31192>>>>>  get_attribute DF_DATE_FORMAT to format#
31195>>>>>  get_attribute DF_DATE_SEPARATOR to pos1# // overload
31198>>>>>  character pos1# to sep#                  // end overload
31199>>>>>>
31199>>>>>  move date# to str#
31200>>>>>  replace sep# in str# with "$"
31202>>>>>  move strmark to pos1#
31203>>>>>  if [found] begin
31205>>>>>    replace sep# in str# with "$"
31207>>>>>    move strmark to pos2#
31208>>>>>  end
31208>>>>>>
31208>>>>>  else begin
31209>>>>>    move 0 to Dates$Year
31210>>>>>    move 0 to Dates$Month
31211>>>>>    move 0 to Dates$Day
31212>>>>>  end
31212>>>>>>
31212>>>>>  [ found] begin
31214>>>>>>
31214>>>>>    if format# eq DF_DATE_EUROPEAN ;          left str# to Dates$Day    (pos1#-1)
31218>>>>>    if format# eq DF_DATE_USA begin
31220>>>>>          mid  str# to Dates$Day    (pos2#-pos1#-1) (pos1#+1)
31223>>>>>>
31223>>>>>          left str# to Dates$Month  (pos1#-1)
31225>>>>>>
31225>>>>>    end
31225>>>>>>
31225>>>>>    else  mid  str# to Dates$Month  (pos2#-pos1#-1) (pos1#+1)
31229>>>>>
31229>>>>>    if format# eq DF_DATE_MILITARY begin
31231>>>>>          mid  str# to Dates$Day  2 (pos2#+1)
31234>>>>>>
31234>>>>>          left str# to Dates$Year   (pos1#-1)
31236>>>>>>
31236>>>>>    end
31236>>>>>>
31236>>>>>    else  mid  str# to Dates$Year 4 (pos2#+1)
31240>>>>>  end
31240>>>>>>
31240>>>>>end_procedure
31241>>>>>
31241>>>>>function DateCompose global integer day# integer month# integer year# returns date
31242>>>>>  local integer format#
31243>>>>>  local date date#
31243>>>>>  local string sep#
31243>>>>>  ifnot (day#*month#*year#) function_return 0
31246>>>>>  get_attribute DF_DATE_SEPARATOR to format# // overload
31249>>>>>  character format# to sep#                  // end overload
31250>>>>>>
31250>>>>>  get_attribute DF_DATE_FORMAT to format#
31253>>>>>  if day# gt 28 begin
31255>>>>>    if format# eq DF_DATE_EUROPEAN move (date(string(day#)+sep#+string(month#)+sep#+string(year#))) to date# // DMY
31258>>>>>    if format# eq DF_DATE_USA      move (date(string(month#)+sep#+string(day#)+sep#+string(year#))) to date# // MDY
31261>>>>>    if format# eq DF_DATE_MILITARY move (date(string(year#)+sep#+string(month#)+sep#+string(day#))) to date# // YMD
31264>>>>>    send DateDecompose date#
31265>>>>>    if Dates$Month ne month# move (day#-Dates$Day) to day#
31268>>>>>  end
31268>>>>>>
31268>>>>>  if format# eq DF_DATE_EUROPEAN function_return (date(string(day#)+sep#+string(month#)+sep#+string(year#))) // DMY
31271>>>>>  if format# eq DF_DATE_USA function_return (date(string(month#)+sep#+string(day#)+sep#+string(year#))) // MDY
31274>>>>>  function_return (date(string(year#)+sep#+string(month#)+sep#+string(day#))) // YMD
31275>>>>>end_function
31276>>>>>
31276>>>>>function DateFormatName global integer format# returns string
31277>>>>>  if format# eq DF_DATE_EUROPEAN function_return "European"
31280>>>>>  if format# eq DF_DATE_USA      function_return "United States"
31283>>>>>  if format# eq DF_DATE_MILITARY function_return "Military"
31286>>>>>end_function
31287>>>>>
31287>>>>>function DateCurrentSeparator global returns string
31288>>>>>  local integer rval#
31289>>>>>  get_attribute DF_DATE_SEPARATOR to rval#
31292>>>>>  function_return (character(rval#))
31293>>>>>end_function
31294>>>>>
31294>>>>>function DateCurrentFormat global returns integer
31295>>>>>  local integer rval#
31296>>>>>  get_attribute DF_DATE_FORMAT to rval#
31299>>>>>  function_return rval#
31300>>>>>end_function
31301>>>>>
31301>>>>>function DateFormatAsString global integer format# integer long# string sep# returns string
31302>>>>>  local string rval# letter#
31303>>>>>  if format# eq DF_DATE_EUROPEAN move "3342241111" to rval#
31306>>>>>  if format# eq DF_DATE_USA      move "2243341111" to rval#
31309>>>>>  if format# eq DF_DATE_MILITARY move "1111422433" to rval#
31312>>>>>  left t.calendar.year to letter# 1
31314>>>>>>
31314>>>>>  replace "1" in rval# with letter#
31316>>>>>  replace "1" in rval# with letter#
31318>>>>>  ifnot long# move "" to letter#
31321>>>>>  move (replaces("1",rval#,letter#)) to rval#
31322>>>>>  move (replaces("2",rval#,left(t.calendar.month,1))) to rval#
31323>>>>>  move (replaces("3",rval#,left(t.calendar.day,1))) to rval#
31324>>>>>  if sep# eq "" begin
31326>>>>>    get_attribute DF_DATE_SEPARATOR to format#
31329>>>>>    character format# to sep#
31330>>>>>>
31330>>>>>  end
31330>>>>>>
31330>>>>>  move (replaces("4",rval#,sep#)) to rval#
31331>>>>>  function_return rval#
31332>>>>>end_function
31333>>>>>
31333>>>>>function StringToDate global string date# integer format# integer four_digit_year# string sep# returns date
31334>>>>>  local integer sep_len# day# month# year#
31335>>>>>  move (length(sep#)) to sep_len#
31336>>>>>  if four_digit_year# move 4 to four_digit_year#
31339>>>>>  else move 2 to four_digit_year#
31341>>>>>  if format# eq DF_DATE_EUROPEAN begin // DMY
31343>>>>>    move (mid(date#,2,1)) to day#
31344>>>>>    move (mid(date#,2,3+sep_len#)) to month#
31345>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31346>>>>>  end
31346>>>>>>
31346>>>>>  if format# eq DF_DATE_USA begin // MDY
31348>>>>>    move (mid(date#,2,1)) to month#
31349>>>>>    move (mid(date#,2,3+sep_len#)) to year#
31350>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31351>>>>>  end
31351>>>>>>
31351>>>>>  if format# eq DF_DATE_MILITARY begin // YMD
31353>>>>>    move (mid(date#,four_digit_year#,1)) to year#
31354>>>>>    move (mid(date#,2,1+four_digit_year#+sep_len#)) to month#
31355>>>>>    move (mid(date#,2,3+four_digit_year#+sep_len#+sep_len#)) to day#
31356>>>>>  end
31356>>>>>>
31356>>>>>  function_return (DateCompose(day#,month#,year#))
31357>>>>>end_function
31358>>>>>
31358>>>>>function DateToString global date date# integer format# integer four_digit_year# string sep# returns string
31359>>>>>  local string rval# day# month# year#
31360>>>>>  get Date2to4 date# to date#
31361>>>>>  if (integer(date#)) begin
31363>>>>>    send DateDecompose date#
31364>>>>>    move Dates$Day to day#
31365>>>>>    if Dates$Day lt 10 insert "0" in day# at 1
31369>>>>>    move Dates$Month to month#
31370>>>>>    if Dates$Month lt 10 insert "0" in month# at 1
31374>>>>>    move Dates$Year to year#
31375>>>>>    ifnot four_digit_year# move (right(year#,2)) to year#
31378>>>>>    if format# eq DF_DATE_EUROPEAN move (day#+sep#+month#+sep#+year#) to rval# // DMY
31381>>>>>    if format# eq DF_DATE_USA      move (month#+sep#+day#+sep#+year#) to rval# // MDY
31384>>>>>    if format# eq DF_DATE_MILITARY move (year#+sep#+month#+sep#+day#) to rval# // YMD
31387>>>>>  end
31387>>>>>>
31387>>>>>  function_return rval#
31388>>>>>end_function
31389>>>>>
31389>>>>>// Function DateAsString is only here for compatibility with earlier versions.
31389>>>>>// Use function DateToString instead.
31389>>>>>function DateAsString global date date# integer format# integer four_digit_year# string sep# returns string
31390>>>>>  function_return (DateToString(date#,format#,four_digit_year#,sep#))
31391>>>>>end_function
31392>>>>>
31392>>>>>function DateIncrement global date date# integer segment# integer amount# returns date
31393>>>>>  if (date#=0) function_return 0
31396>>>>>  if segment# eq DS_WEEK function_return (date#+(amount#*7)) //weeks
31399>>>>>  if (segment#<>DS_DAY) begin // months or years
31401>>>>>    send DateDecompose date#
31402>>>>>    if segment# eq DS_MONTH begin //months
31404>>>>>      move (Dates$Month+amount#) to Dates$Month
31405>>>>>      if amount# ge 0 function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-1)/12)*12),Dates$Year+((Dates$Month-1)/12)))
31408>>>>>      function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-12)/12)*12),Dates$Year+((Dates$Month-12)/12)))
31409>>>>>    end //years:
31409>>>>>>
31409>>>>>    if segment# eq DS_YEAR function_return (DateCompose(Dates$Day,Dates$Month,Dates$Year+amount#))
31412>>>>>  end
31412>>>>>>
31412>>>>>  else function_return (date#+amount#) //days
31414>>>>>end_function
31415>>>>>
31415>>>>>function DateSegment global date date# integer segment# returns integer
31416>>>>>  send DateDecompose date#
31417>>>>>  if segment# eq DS_DAY   function_return Dates$Day
31420>>>>>  if segment# eq DS_MONTH function_return Dates$Month
31423>>>>>  if segment# eq DS_YEAR  function_return Dates$Year
31426>>>>>end_function
31427>>>>>
31427>>>>>function DateToInteger global date date# returns integer
31428>>>>>  send DateDecompose date#
31429>>>>>  function_return (Dates$Year*100+Dates$Month*100+Dates$Day)
31430>>>>>end_function
31431>>>>>
31431>>>>>function FirstDayInMonth global date date# returns date
31432>>>>>  local integer month# year#
31433>>>>>  move (DateSegment(date#,DS_MONTH)) to month#
31434>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31435>>>>>  function_return (DateCompose(1,month#,year#))
31436>>>>>end_function
31437>>>>>
31437>>>>>function LastDayInMonth global date date# returns date
31438>>>>>  move (DateIncrement(date#,DS_MONTH,1)) to date#
31439>>>>>  function_return (FirstDayInMonth(date#)-1)
31440>>>>>end_function
31441>>>>>
31441>>>>>function FirstDayInYear global date date# returns date
31442>>>>>  local integer year#
31443>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31444>>>>>  function_return (DateCompose(1,1,year#))
31445>>>>>end_function
31446>>>>>
31446>>>>>function LastDayInYear global date date# returns date
31447>>>>>  move (DateIncrement(date#,DS_YEAR,1)) to date#
31448>>>>>  function_return (FirstDayInYear(date#)-1)
31449>>>>>end_function
31450>>>>>
31450>>>>>// Prior to 18/1-99 version of DateWeekNumber
31450>>>>>//function DateWeekNumber global date date# returns integer
31450>>>>>//  local integer week# first_wd# day_of_year# year#
31450>>>>>//  if (date#=0) function_return 0
31450>>>>>//  get Date2to4 date# to date#
31450>>>>>//  move (DateSegment(date#,DS_YEAR)) to year#
31450>>>>>//  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31450>>>>>//  move (date#-FirstDayInYear(date#)) to day_of_year#
31450>>>>>//  move (day_of_year#-1-7+first_wd#) to day_of_year#
31450>>>>>//  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31450>>>>>//  else move 0 to week#
31450>>>>>//  if first_wd# le 4 increment week#
31450>>>>>//  if week# gt 52 begin
31450>>>>>//    move 1 to week#
31450>>>>>//    if first_wd# eq 4 move 53 to week#
31450>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31450>>>>>//  end
31450>>>>>//  if week# eq 0 begin
31450>>>>>//    //get DateWeekNumber (DateIncrement(date#,DS_YEAR,-1)) to first_wd# // Original line
31450>>>>>//    get DateDayNumber  (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#ÿ // changed line
31450>>>>>//    move 52 to week#
31450>>>>>//    if first_wd# eq 4 move 53 to week#
31450>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31450>>>>>//  end
31450>>>>>//  function_return week#
31450>>>>>//end_function
31450>>>>>
31450>>>>>function DateWeekNumber global date date# returns integer
31451>>>>>  local integer week# first_wd# day_of_year# year# wd#
31452>>>>>  if (date#=0) function_return 0
31455>>>>>  get Date2to4 date# to date#
31456>>>>>  // Leap-year test for actual or previous year
31456>>>>>  // Year# only used for selection between 52 and
31456>>>>>  // Therefore get year# from the first day of actual week
31456>>>>>  get DateDayNumber date# to wd#
31457>>>>>  move (DateSegment(date#-wd#+1,DS_YEAR)) to year#
31458>>>>>
31458>>>>>  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31459>>>>>  move (date#-FirstDayInYear(date#)) to day_of_year#
31460>>>>>  move (day_of_year#-1-7+first_wd#) to day_of_year#
31461>>>>>  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31464>>>>>  else move 0 to week#
31466>>>>>  if first_wd# le 4 increment week#
31469>>>>>  if week# gt 52 begin
31471>>>>>    move 1 to week#
31472>>>>>    if first_wd# eq 4 move 53 to week#
31475>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31482>>>>>  end
31482>>>>>>
31482>>>>>  if week# eq 0 begin
31484>>>>>    // Week 52 or 53
31484>>>>>    get DateDayNumber (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#
31485>>>>>    move 52 to week#
31486>>>>>    if first_wd# eq 4 move 53 to week#
31489>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31496>>>>>  end
31496>>>>>>
31496>>>>>  function_return week#
31497>>>>>end_function
31498>>>>>
31498>>>>>function DayName global integer int# returns string
31499>>>>>  if int# eq 1 function_return t.calendar.Monday
31502>>>>>  if int# eq 2 function_return t.calendar.Tuesday
31505>>>>>  if int# eq 3 function_return t.calendar.Wednesday
31508>>>>>  if int# eq 4 function_return t.calendar.Thursday
31511>>>>>  if int# eq 5 function_return t.calendar.Friday
31514>>>>>  if int# eq 6 function_return t.calendar.Saturday
31517>>>>>  if int# eq 7 function_return t.calendar.Sunday
31520>>>>>  function_return ""
31521>>>>>end_function
31522>>>>>
31522>>>>>function DateDayNumber global date date# returns integer
31523>>>>>  local integer rval# // 1=Monday, ... , 7=Sunday
31524>>>>>  get Date2to4 date# to date#
31525>>>>>  move date# to rval#
31526>>>>>  if rval# begin
31528>>>>>    if rval# gt 693975 move (rval#-2) to rval#
31531>>>>>    move (rval#-((rval#/7)*7)) to rval#
31532>>>>>    if rval# eq 0 move 7 to rval#
31535>>>>>  end
31535>>>>>>
31535>>>>>  function_return rval#
31536>>>>>end_function
31537>>>>>
31537>>>>>function DateDayName global date date# returns string
31538>>>>>  function_return (DayName(DateDayNumber(date#)))
31539>>>>>end_function
31540>>>>>
31540>>>>>function YearMaxWeek global integer year# returns integer
31541>>>>>  local integer wk1# wk2#
31542>>>>>  get DateWeekNumber (DateCompose(31,12,year#)) to wk1#
31543>>>>>  get DateWeekNumber (DateCompose(24,12,year#)) to wk2#
31544>>>>>  function_return (wk1# max wk2#)
31545>>>>>end_function
31546>>>>>
31546>>>>>function WeekToDate global integer year# integer week# returns date
31547>>>>>  local date date#
31548>>>>>  move (DateCompose(1,1,year#)) to date#
31549>>>>>  if (DateWeekNumber(date#)) ne 1 move (date#+7) to date# // week 52 or 53
31552>>>>>  move (date#-DateDayNumber(date#)+1) to date# // Now it's a Monday
31553>>>>>  function_return (week#-1*7+date#)
31554>>>>>end_function
31555>>>>>
31555>>>>>function MonthName global integer int# returns string
31556>>>>>  if int# eq  1 function_return t.calendar.January
31559>>>>>  if int# eq  2 function_return t.calendar.February
31562>>>>>  if int# eq  3 function_return t.calendar.March
31565>>>>>  if int# eq  4 function_return t.calendar.April
31568>>>>>  if int# eq  5 function_return t.calendar.May
31571>>>>>  if int# eq  6 function_return t.calendar.June
31574>>>>>  if int# eq  7 function_return t.calendar.July
31577>>>>>  if int# eq  8 function_return t.calendar.August
31580>>>>>  if int# eq  9 function_return t.calendar.September
31583>>>>>  if int# eq 10 function_return t.calendar.October
31586>>>>>  if int# eq 11 function_return t.calendar.November
31589>>>>>  if int# eq 12 function_return t.calendar.December
31592>>>>>  function_return ""
31593>>>>>end_function
31594>>>>>
31594>>>>>function DateMonthName global date date# returns string
31595>>>>>  function_return (MonthName(DateSegment(date#,DS_MONTH)))
31596>>>>>end_function
31597>>>>>
31597>>>>>function DateAsText global date date# string format# returns string
31598>>>>>  if date# eq 0 function_return ""
31601>>>>>  move (replace("#DN",format#,DateDayName(date#)))                  to format#
31602>>>>>  move (replace("#MN",format#,DateMonthName(date#)))                to format#
31603>>>>>  move (replace("#D" ,format#,string(DateSegment(date#,DS_DAY))))   to format#
31604>>>>>  move (replace("#Y" ,format#,string(DateSegment(date#,DS_YEAR))))  to format#
31605>>>>>  move (replace("#M" ,format#,string(DateSegment(date#,DS_MONTH)))) to format#
31606>>>>>  function_return format#
31607>>>>>end_function
31608>>>>>
31608>>>>>function Year2to4 global integer year# returns integer
31609>>>>>  local integer epoch_value#
31610>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31611>>>>>  if year# lt 100 begin
31613>>>>>    if year# gt epoch_value# function_return (year#+1900)
31616>>>>>    function_return (year#+2000)
31617>>>>>  end
31617>>>>>>
31617>>>>>  function_return year# // No conversion done!
31618>>>>>end_function
31619>>>>>
31619>>>>>function Date2to4 global date date# returns date
31620>>>>>  local integer epoch_value#
31621>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31622>>>>>  if date# gt 0 begin // Only if there is a date to convert
31624>>>>>    if (DateSegment(date#,DS_YEAR)) lt 105 begin
31626>>>>>      if Dates$Year gt epoch_value# function_return (DateIncrement(date#,DS_YEAR,1900))
31629>>>>>      function_return (DateIncrement(date#,DS_YEAR,2000))
31630>>>>>    end
31630>>>>>>
31630>>>>>    function_return date# // No conversion done!
31631>>>>>  end
31631>>>>>>
31631>>>>>end_function
31632>>>>>
31632>>>>>function Date4to2 global date date# returns date
31633>>>>>  local integer epoch_value# year#
31634>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31635>>>>>  if date# gt 0 begin // Only if there is a date to convert
31637>>>>>    move (DateSegment(date#,DS_YEAR)) to year#
31638>>>>>    if year# ge 100 begin // Only then conversion is needed!
31640>>>>>      if (year#>=(1900+epoch_value#) and year#<(2000+epoch_value#)) begin
31642>>>>>        if year# lt 2000 function_return (DateIncrement(date#,DS_YEAR,-1900))
31645>>>>>        else             function_return (DateIncrement(date#,DS_YEAR,-2000))
31647>>>>>      end
31647>>>>>>
31647>>>>>      else error 301 "Date is out of epoch range"
31649>>>>>    end
31649>>>>>>
31649>>>>>  end
31649>>>>>>
31649>>>>>  function_return date# // No conversion done!
31650>>>>>end_function
31651>>>>>
31651>>>>>function dSysDate global returns date
31652>>>>>  local date date#
31653>>>>>  sysdate4 date#
31654>>>>>  function_return date#
31655>>>>>end_function
31656>>>>>
31656>>>>>function iSysYear global returns integer
31657>>>>>  local date date#
31658>>>>>  sysdate4 date#
31659>>>>>  function_return (DateSegment(date#,DS_YEAR))
31660>>>>>end_function
31661>>>>>
31661>>>>>procedure ItemSysdate for desktop integer itm#
31662>>>>>  local date date#
31663>>>>>  get value item itm# to date#
31664>>>>>  if date# eq 0 begin
31666>>>>>    sysdate4 date#
31667>>>>>    set changed_value item itm# to date#
31668>>>>>  end
31668>>>>>>
31668>>>>>end_procedure
31669>>>>>
31669>>>>>procedure ItemDate2to4 for desktop integer itm#
31670>>>>>  local integer year#
31671>>>>>  local date date# new_date#
31671>>>>>  get value item itm# to date#
31672>>>>>
31672>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31673>>>>>  if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31676>>>>>  else move date# to new_date#
31678>>>>>
31678>>>>>  move (Date2to4(new_date#)) to new_date#
31679>>>>>  move (DateSegment(new_date#,3)) to year#
31680>>>>>  if (year#>99 and year#<1000) begin
31682>>>>>    error 15 // Illegal entry in this window
31683>>>>>>
31683>>>>>    procedure_return 1
31684>>>>>  end
31684>>>>>>
31684>>>>>  if new_date# ne date# set value item itm# to new_date#
31687>>>>>end_procedure
31688>>>>>
31688>>>>>procedure ItemYear2to4 for desktop integer itm#
31689>>>>>  local integer year# new_year#
31690>>>>>  get value item itm# to year#
31691>>>>>  if (year#>99 and year#<1000) begin
31693>>>>>    error 15 // Illegal entry in this window
31694>>>>>>
31694>>>>>    procedure_return 1
31695>>>>>  end
31695>>>>>>
31695>>>>>  move (Year2to4(year#)) to new_year#
31696>>>>>  if new_year# ne year# set value item itm# to new_year#
31699>>>>>end_procedure
31700>>>>>
31700>>>>> procedure FieldSysdate for DataDictionary integer fld#
31701>>>>>   local date date#
31702>>>>>   get field_current_value fld# to date#
31703>>>>>   if date# eq 0 begin
31705>>>>>     sysdate4 date#
31706>>>>>     set field_changed_value fld# to date#
31707>>>>>   end
31707>>>>>>
31707>>>>> end_procedure
31708>>>>>
31708>>>>> procedure FieldDate2to4 for DataDictionary integer fld#
31709>>>>>   local integer year#
31710>>>>>   local date date# new_date#
31710>>>>>   get field_current_value fld# to date#
31711>>>>>
31711>>>>>   move (DateSegment(date#,DS_YEAR)) to year#
31712>>>>>   if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31715>>>>>   else move date# to new_date#
31717>>>>>
31717>>>>>   move (Date2to4(new_date#)) to new_date#
31718>>>>>   move (DateSegment(new_date#,3)) to year#
31719>>>>>   if (year#>99 and year# <=999) begin
31721>>>>>     error 15 // Illegal entry in this window
31722>>>>>>
31722>>>>>     procedure_return 1
31723>>>>>   end
31723>>>>>>
31723>>>>>   if new_date# ne date# set field_changed_value fld# to new_date#
31726>>>>> end_procedure
31727>>>>>
31727>>>>> procedure FieldYear2to4 for DataDictionary integer fld#
31728>>>>>   local integer year# new_year# changed#
31729>>>>>   get field_current_value fld# to year#
31730>>>>>   get field_changed_state fld# to changed#
31731>>>>>   if changed# begin
31733>>>>>     if (year#>99 and year#<1000) begin
31735>>>>>       error 15 // Illegal entry in this window
31736>>>>>>
31736>>>>>       procedure_return 1
31737>>>>>     end
31737>>>>>>
31737>>>>>     move (Year2to4(year#)) to new_year#
31738>>>>>     if new_year# ne year# set field_changed_value fld# to new_year#
31741>>>>>   end
31741>>>>>>
31741>>>>> end_procedure
31742>>>>>
31742>>>>> function SysDate global returns date
31743>>>>>   function_return (dSysDate())
31744>>>>> end_function
31745>>>>>
31745>>>>>function sSysTime global returns string
31746>>>>>  local integer h# m# s#
31747>>>>>  sysdate4 h# h# m# s#
31751>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31752>>>>>end_function
31753>>>>>
31753>>>>>function TS_SysTime global returns number
31754>>>>>  local integer d# h# m# s#
31755>>>>>  sysdate4 d# h# m# s#
31759>>>>>  function_return (d#*24.0+h#*60+m#*60+s#)
31760>>>>>end_function
31761>>>>>
31761>>>>>//> This function returns a TS value composed from the date and time
31761>>>>>//> passed to it. Note that the time variable must be of the format
31761>>>>>//> "hh:mm:ss".
31761>>>>>function TS_Compose global date date# string time# returns number
31762>>>>>  local integer h# m# s#
31763>>>>>  left time# to h# 2
31765>>>>>>
31765>>>>>  mid time# to m# 2 4
31768>>>>>>
31768>>>>>  mid time# to s# 2 7
31771>>>>>>
31771>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31772>>>>>end_function
31773>>>>>
31773>>>>>function TS_Compose2 global date date# integer h# integer m# integer s# returns number
31774>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31775>>>>>end_function
31776>>>>>
31776>>>>>function TS_ExtractDate global number time# returns date
31777>>>>>  function_return (time#/86400) // 86400=24*60*60
31778>>>>>end_function
31779>>>>>
31779>>>>>function TS_ExtractTime global number time# returns string
31780>>>>>  local integer h# m# s#
31781>>>>>  move (time#-(86400.0*integer(TS_ExtractDate(time#)))) to s#
31782>>>>>  move (s#/3600) to h#
31783>>>>>  move (s#-(h#*3600)) to s#
31784>>>>>  move (s#/60) to m#
31785>>>>>  move (s#-(m#*60)) to s#
31786>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31787>>>>>end_function
31788>>>>>
31788>>>>>function TS_ConvertToString global number time# returns string
31789>>>>>  local date d#
31790>>>>>  move (TS_ExtractDate(time#)) to d#
31791>>>>>  if (integer(d#)) function_return (string(d#)+" "+TS_ExtractTime(time#))
31794>>>>>  else function_return (TS_ExtractTime(time#))
31796>>>>>end_function
31797>>>>>
31797>>>>>function TS_ConvertToStringNoDate global number ts# returns string
31798>>>>>  local integer h# m#
31799>>>>>  move (ts#/3600) to h#
31800>>>>>  move (ts#-(h#*3600)) to ts#
31801>>>>>  move (ts#/60) to m#
31802>>>>>  move (ts#-(m#*60)) to ts#
31803>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(ts#<10,"0","")+string(ts#))
31804>>>>>end_function
31805>>>>>
31805>>>>>// This procedure is used when a TS-variable must be displayed on screen.
31805>>>>>procedure TS_UI_Update global number TS# integer obj1# integer itm1# integer tmp_obj2# integer tmp_itm2#
31806>>>>>  local integer obj2# itm2#
31807>>>>>  if num_arguments gt 3 begin
31809>>>>>    move tmp_obj2# to obj2#
31810>>>>>    move tmp_itm2# to itm2#
31811>>>>>  end
31811>>>>>>
31811>>>>>  else begin
31812>>>>>    move obj1# to obj2#
31813>>>>>    move (itm1#+1) to itm2#
31814>>>>>  end
31814>>>>>>
31814>>>>>  set value of obj1# item itm1# to (TS_ExtractDate(TS#))
31815>>>>>  set value of obj2# item itm2# to (TS_ExtractTime(TS#))
31816>>>>>end_procedure
31817>>>>>
31817>>>>>class TS_TimeEstimator is an array
31818>>>>>  procedure construct_object
31819>>>>>    forward send construct_object
31821>>>>>    set delegation_mode to delegate_to_parent
31822>>>>>    property number  pnTotal   public 0 // Seconds needed to run the loop.
31823>>>>>    property number  pnElapsed public 0 // Seconds elapsed so far.
31824>>>>>    property number  pnLeft    public 0 // Number of seconds left
31825>>>>>    property number  pnStart   public 0
31826>>>>>    property number  pnPause   public 0
31827>>>>>    property number  pnPercent public 0
31828>>>>>    property integer piMin     public 0
31829>>>>>    property integer piMax     public 0
31830>>>>>  end_procedure
31831>>>>>
31831>>>>>  procedure TS_Start integer min# integer max#
31832>>>>>    set piMin to min#
31833>>>>>    set piMax to max#
31834>>>>>    set pnStart to (TS_SysTime())
31835>>>>>    set pnElapsed to 0
31836>>>>>    set pnPercent to 0
31837>>>>>  end_procedure
31838>>>>>
31838>>>>>  procedure TS_Calculate integer pos#
31839>>>>>    local integer min# max#
31840>>>>>    get piMin to min#
31841>>>>>    get piMax to max#
31842>>>>>    set pnElapsed to (TS_SysTime()-pnStart(current_object))
31843>>>>>    set pnTotal   to (pnElapsed(current_object)*(max#-min#)/number(pos#-min#))
31844>>>>>    set pnLeft    to (pnTotal(current_object)-pnElapsed(current_object))
31845>>>>>    set pnPercent to (100.0*(pos#-min#)/(max#-min#))
31846>>>>>  end_procedure
31847>>>>>
31847>>>>>  procedure TS_Pause
31848>>>>>    set pnPause to (TS_SysTime())
31849>>>>>  end_procedure
31850>>>>>
31850>>>>>  procedure TS_Continue
31851>>>>>    set pnStart to (pnStart(current_object)+TS_SysTime()-pnPause(current_object))
31852>>>>>  end_procedure
31853>>>>>end_class
31854>>>>>
31854>>>>>function TS_Module_Compile_Time global string path# returns number
31855>>>>>  local integer pos# day# month# year# seqeof# ch#
31856>>>>>  local string date# str# time#
31856>>>>>  move path# to str#
31857>>>>>  if str# ne "" begin
31859>>>>>    get Seq_New_Channel to ch#   // This method and Seq_Release_Channel are
31860>>>>>    send Seq_Release_Channel ch# // We only need it for a second
31861>>>>>      direct_input channel ch# (trim(str#)+".vd6") // VDF 6
31863>>>>>      [seqeof] direct_input channel ch# (trim(str#)+".vd5") // VDF 5
31865>>>>>    [ seqeof] move 1 to seqeof#
31866>>>>>    [~seqeof] move 0 to seqeof#
31867>>>>>    [~seqeof] readln str#
31868>>>>>    close_input channel ch#
31870>>>>>  end
31870>>>>>>
31870>>>>>  if seqeof# function_return 0
31873>>>>>  pos "," in str# to pos#
31875>>>>>>
31875>>>>>  move (mid(str#,18,pos#+2)) to str#
31876>>>>>  move (integer(mid(str#,2,4))) to day#
31877>>>>>  move (integer(mid(str#,2,1))) to month#
31878>>>>>  move (integer(mid(str#,2,7))) to year#
31879>>>>>  if year# eq 10 begin
31881>>>>>    move (integer(mid(str#,3,7))+1900) to year#
31882>>>>>    move (mid(str#,8,11)) to str#
31883>>>>>  end
31883>>>>>>
31883>>>>>  else move (mid(str#,8,10)) to str#
31885>>>>>  move (DateCompose(day#,month#,year#)) to date#
31886>>>>>  move (Date2to4(date#)) to date#
31887>>>>>  pos ":" in str# to pos#
31889>>>>>>
31889>>>>>  function_return (TS_Compose(date#,mid(str#,8,pos#-2)))
31890>>>>>end_function
31891>>>>>
31891>>>>>string Dates$Module_Compile_Time
31891>>>>>move "" to Dates$Module_Compile_Time
31892>>>>>
31892>>>>>function Module_Compile_Date global returns date
31893>>>>>  local number ts#
31894>>>>>  local string str#
31894>>>>>  get module_name to str# // 'module_name' is most likely the name of the .flx file.
31895>>>>>  get TS_Module_Compile_Time str# to ts#
31896>>>>>  move (TS_ExtractTime(ts#)) to Dates$Module_Compile_Time
31897>>>>>  function_return (TS_ExtractDate(ts#))
31898>>>>>end_function
31899>>>>>
31899>>>>>function Module_Compile_Time global returns string
31900>>>>>  local date grb#
31901>>>>>  // Module_Compile_Date must be called before this one!
31901>>>>>  if Dates$Module_Compile_Time eq "" move (Module_Compile_Date()) to grb#
31904>>>>>  function_return Dates$Module_Compile_Time
31905>>>>>end_function
31906>>>>>
31906>>>>>date   Dates$ModuleStartDate
31906>>>>>string Dates$ModuleStartTime 8
31906>>>>>move (dSysDate()) to Dates$ModuleStartDate
31907>>>>>move (sSysTime()) to Dates$ModuleStartTime
31908>>>>>
31908>>>>>function Module_Start_Date global returns date
31909>>>>>  function_return Dates$ModuleStartDate
31910>>>>>end_function
31911>>>>>
31911>>>>>function Module_Start_Time global returns string
31912>>>>>  function_return Dates$ModuleStartTime
31913>>>>>end_function
31914>>>>>
31914>>>>> register_procedure NotifyPopupCalendarChange date date#
31914>>>>> register_procedure NotifyPopupCalendarSelect date date#
31914>>>>>  use dfAllent
31914>>>>>  class calendar.textbox is a textbox
31915>>>>>    procedure construct_object
31916>>>>>      forward send construct_object
31918>>>>>      Set Auto_Size_State To False
31919>>>>>      Set Justification_Mode To (jMode_vCenter+jMode_Center)
31920>>>>>    end_procedure
31921>>>>>  end_class
31922>>>>>
31922>>>>>  register_object btn1
31922>>>>>  register_object btn6
31922>>>>>
31922>>>>>  class calendar.button is a button
31923>>>>>
31923>>>>>    procedure construct_object
31924>>>>>      forward send construct_object
31926>>>>>      set size to 15 18
31927>>>>>      on_key kleftarrow   send prev_day
31928>>>>>      on_key krightarrow  send next_day
31929>>>>>      on_key kuparrow     send prev_week
31930>>>>>      on_key kdownarrow   send next_week
31931>>>>>      property date p_assigned_date public 0
31932>>>>>    end_procedure
31933>>>>>
31933>>>>>    procedure switch // This makes all 42 buttons act as if they are one focus
31934>>>>>      send activate to (btn1(current_object))
31935>>>>>    end_procedure
31936>>>>>    procedure switch_back
31937>>>>>      send activate to (btn6(current_object))
31938>>>>>    end_procedure
31939>>>>>
31939>>>>>    procedure mouse_down
31940>>>>>      local integer current_object#
31941>>>>>      forward send mouse_down
31943>>>>>      move current_object to current_object#
31944>>>>>      delegate set p_current_date to (p_assigned_date(current_object#))
31946>>>>>    end_procedure
31947>>>>>  end_class
31948>>>>>
31948>>>>>  desktop_section
31954>>>>>    object popup_calendar is a ModalPanel
31956>>>>>      set size to 160 250
31957>>>>>      property date    p_current_date  public 0
31959>>>>>      property integer p_current_year  public -1
31961>>>>>      property integer p_current_month public -1
31963>>>>>      property integer pExportState    public 1
31965>>>>>
31965>>>>>      on_key key_ctrl+key_pgup send prev_year
31966>>>>>      on_key key_ctrl+key_pgdn send next_year
31967>>>>>      on_key          key_pgup send prev_month
31968>>>>>      on_key          key_pgdn send next_month
31969>>>>>      on_key key_ctrl+key_d    send go_today
31970>>>>>      on_key kcancel           send cancel
31971>>>>>
31971>>>>>      object cont3d is a container3d
31973>>>>>        set location to 5 5
31974>>>>>        set size to 120 237
31975>>>>>        object textbox_year is a calendar.textbox
31977>>>>>          set location to 5 5
31978>>>>>          set size to 15 30
31979>>>>>          set border_style to border_staticedge
31980>>>>>          procedure display
31982>>>>>            set value to (p_current_year(current_object))
31983>>>>>          end_procedure
31984>>>>>        end_object
31985>>>>>        object dayname_header is a container3d
31987>>>>>          set location to 5 39
31988>>>>>          set size to 15 126
31989>>>>>          set border_style to border_staticedge
31990>>>>>          procedure initialize
31992>>>>>            local integer itm#
31993>>>>>            for itm# from 0 to 6
31999>>>>>>
31999>>>>>              object txt is a calendar.textbox
32001>>>>>                set size to 12 17
32002>>>>>                set location to 0 (itm#*17.6+1)
32003>>>>>                 set value to (left(DayName(itm#+1),3))
32004>>>>>              end_object
32005>>>>>            loop
32006>>>>>>
32006>>>>>          end_procedure
32007>>>>>          send initialize
32008>>>>>        end_object
32009>>>>>        object weeknumber_header is a container3d
32011>>>>>          set location to 24 5
32012>>>>>          set size     to 89 30
32013>>>>>          set border_style to border_staticedge
32014>>>>>          object obj_id_array is an array
32016>>>>>          end_object
32017>>>>>          procedure initialize
32019>>>>>            local integer itm# obj#
32020>>>>>            move (obj_id_array(current_object)) to obj#
32021>>>>>            for itm# from 0 to 5
32027>>>>>>
32027>>>>>              object txt is a textbox
32029>>>>>                set size to 15 30
32030>>>>>                set location to (itm#*15+1) 1
32031>>>>>                set value of obj# item (item_count(obj#)) to current_object
32032>>>>>              end_object
32033>>>>>            loop
32034>>>>>>
32034>>>>>          end_procedure
32035>>>>>          procedure display
32037>>>>>            local integer itm# obj#
32038>>>>>            local date date# last_date#
32038>>>>>            move (obj_id_array(current_object)) to obj#
32039>>>>>            get p_current_date to date#
32040>>>>>            move (FirstDayInMonth(date#)) to date#
32041>>>>>            move (LastDayInMonth(date#)) to last_date#
32042>>>>>            move (date#-DateDayNumber(date#)+1) to date#
32043>>>>>            for itm# from 0 to 5
32049>>>>>>
32049>>>>>              if (itm#*7+date#) le last_date# ;                set value of (integer(value(obj#,itm#))) to (t.calendar.week*string(DateWeekNumber(itm#*7+date#)))
32052>>>>>              else set value of (integer(value(obj#,itm#))) to ""
32054>>>>>            loop
32055>>>>>>
32055>>>>>          end_procedure
32056>>>>>          send initialize
32057>>>>>        end_object
32058>>>>>        object days_grid is a container3d
32060>>>>>          set location to 23 39
32061>>>>>          set size     to 100 127
32062>>>>>          set border_style to border_none
32063>>>>>          object btn_array is an array
32065>>>>>          end_object
32066>>>>>          procedure initialize
32068>>>>>            local integer row# col# button_array#
32069>>>>>            move (btn_array(current_object)) to button_array#
32070>>>>>            for row# from 0 to 5
32076>>>>>>
32076>>>>>              for col# from 0 to 6
32082>>>>>>
32082>>>>>                object btn is a calendar.button
32084>>>>>                  set location to (row#*15) (col#*18)
32085>>>>>                  set value of button_array# item (item_count(button_array#)) to current_object
32086>>>>>                  on_item "" send move_value_out_ok
32087>>>>>                end_object
32088>>>>>              loop
32089>>>>>>
32089>>>>>            loop
32090>>>>>>
32090>>>>>          end_procedure
32091>>>>>          send initialize
32092>>>>>
32092>>>>>          procedure display.iii integer itm# integer day# integer activate#
32094>>>>>            local integer obj# current_day#
32095>>>>>            move (integer(value(btn_array(current_object),itm#))) to obj#
32096>>>>>            move (DateSegment(p_current_date(current_object),DS_DAY)) to current_day#
32097>>>>>            if activate# begin
32099>>>>>              if day# eq current_day# send activate to obj#
32102>>>>>            end
32102>>>>>>
32102>>>>>            else begin
32103>>>>>              if day# begin
32105>>>>>                set value of obj# to day#
32106>>>>>                set visible_state of obj# to true
32107>>>>>                set p_assigned_date of obj# to (DateCompose(day#,p_current_month(current_object),p_current_year(current_object)))
32108>>>>>              end
32108>>>>>>
32108>>>>>              else set visible_state of obj# to false
32110>>>>>            end
32110>>>>>>
32110>>>>>          end_procedure
32111>>>>>
32111>>>>>          procedure display integer activate#
32113>>>>>            local integer first_item# last_item# itm# day# date#
32114>>>>>            get p_current_date to date#
32115>>>>>            move (FirstDayInMonth(date#)) to date#
32116>>>>>            move (DateDayNumber(date#)-1) to first_item#
32117>>>>>            move (LastDayInMonth(date#)-date#+first_item#) to last_item#
32118>>>>>            ifnot activate# begin
32120>>>>>              for itm# from 0 to (first_item#-1)
32126>>>>>>
32126>>>>>                send display.iii itm# 0 0
32127>>>>>              loop
32128>>>>>>
32128>>>>>            end
32128>>>>>>
32128>>>>>            move 1 to day#
32129>>>>>            for itm# from first_item# to last_item#
32135>>>>>>
32135>>>>>              send display.iii itm# day# activate#
32136>>>>>              increment day#
32137>>>>>            loop
32138>>>>>>
32138>>>>>            ifnot activate# begin
32140>>>>>              for itm# from (last_item#+1) to 41
32146>>>>>>
32146>>>>>                send display.iii itm# 0 0
32147>>>>>              loop
32148>>>>>>
32148>>>>>            end
32148>>>>>>
32148>>>>>          end_procedure
32149>>>>>        end_object
32150>>>>>        object txt_month is a calendar.textbox
32152>>>>>          set size to 12 27
32153>>>>>          set location to 25 185
32154>>>>>          set value to t.calendar.month
32155>>>>>        end_object
32156>>>>>        object btn1 is a button
32158>>>>>          set size to 12 12
32159>>>>>          set location to 40 185
32160>>>>>          on_item "" send prev_month
32161>>>>>          set bitmap to "prev.bmp"
32162>>>>>          procedure switch_back
32164>>>>>            send display_main
32165>>>>>          end_procedure
32166>>>>>        end_object
32167>>>>>        object btn2 is a button
32169>>>>>          set size to 12 12
32170>>>>>          set location to 40 200
32171>>>>>          on_item "" send next_month
32172>>>>>          set bitmap to "next.bmp"
32173>>>>>        end_object
32174>>>>>        object txt_year is a calendar.textbox
32176>>>>>          set size to 12 27
32177>>>>>          set location to 70 185
32178>>>>>          set value to t.calendar.year
32179>>>>>        end_object
32180>>>>>        object btn3 is a button
32182>>>>>          set size to 12 12
32183>>>>>          set location to 85 185
32184>>>>>          on_item "" send prev_year
32185>>>>>          set bitmap to "prev.bmp"
32186>>>>>        end_object
32187>>>>>        object btn4 is a button
32189>>>>>          set size to 12 12
32190>>>>>          set location to 85 200
32191>>>>>          on_item "" send next_year
32192>>>>>          set bitmap to "next.bmp"
32193>>>>>        end_object
32194>>>>>      end_object
32195>>>>>      object btn5 is a button
32197>>>>>        set size to 14 60
32198>>>>>        set location to 129 115
32199>>>>>        on_item t.calendar.ok send move_value_out_ok
32200>>>>>      end_object
32201>>>>>      object btn6 is a button
32203>>>>>        set size to 14 60
32204>>>>>        set location to 129 182
32205>>>>>        on_item t.calendar.cancel send cancel
32206>>>>>        procedure switch
32208>>>>>          send display_main
32209>>>>>        end_procedure
32210>>>>>      end_object
32211>>>>>      procedure next_year
32213>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32214>>>>>        send display_main
32215>>>>>      end_procedure
32216>>>>>      procedure prev_year
32218>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32219>>>>>        send display_main
32220>>>>>      end_procedure
32221>>>>>      procedure next_month
32223>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32224>>>>>        send display_main
32225>>>>>      end_procedure
32226>>>>>      procedure prev_month
32228>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32229>>>>>        send display_main
32230>>>>>      end_procedure
32231>>>>>      procedure next_week
32233>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,1))
32234>>>>>        send display_main
32235>>>>>      end_procedure
32236>>>>>      procedure prev_week
32238>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,-1))
32239>>>>>        send display_main
32240>>>>>      end_procedure
32241>>>>>      procedure next_day
32243>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,1))
32244>>>>>        send display_main
32245>>>>>      end_procedure
32246>>>>>      procedure prev_day
32248>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,-1))
32249>>>>>        send display_main
32250>>>>>      end_procedure
32251>>>>>      procedure go_today
32253>>>>>        local date date#
32254>>>>>        sysdate4 date#
32255>>>>>        set p_current_date to date#
32256>>>>>        send display_main
32257>>>>>      end_procedure
32258>>>>>      property integer invoking_object_id public 0
32260>>>>>      procedure OnChange date date#
32262>>>>>        local integer focus# dm#
32263>>>>>        get invoking_object_id to focus#
32264>>>>>        if focus# gt desktop begin
32266>>>>>          get delegation_mode of focus# to dm#
32267>>>>>          set delegation_mode of focus# to no_delegate_or_error
32268>>>>>          send NotifyPopupCalendarChange to focus# date#
32269>>>>>          set delegation_mode of focus# to dm#
32270>>>>>        end
32270>>>>>>
32270>>>>>      end_procedure
32271>>>>>      procedure display
32273>>>>>        local integer date# month# year#
32274>>>>>        get p_current_date to date#
32275>>>>>        send OnChange date#
32276>>>>>        move (DateSegment(date#,DS_YEAR)) to year#
32277>>>>>        move (DateSegment(date#,DS_MONTH)) to month#
32278>>>>>        if (p_current_year(current_object)<>year# or p_current_month(current_object)<>month#) begin
32280>>>>>          set p_current_year to year#
32281>>>>>          set p_current_month to month#
32282>>>>>          set value to (t.calendar.calendar_popup+", "+MonthName(month#))
32283>>>>>          send display to (textbox_year(cont3d(current_object)))
32284>>>>>          send display to (weeknumber_header(cont3d(current_object)))
32285>>>>>          send display to (days_grid(cont3d(current_object))) 0
32286>>>>>        end
32286>>>>>>
32286>>>>>      end_procedure
32287>>>>>      procedure display_main
32289>>>>>        send display
32290>>>>>        send display to (days_grid(cont3d(current_object))) 1
32291>>>>>      end_procedure
32292>>>>>      procedure popup_no_export
32294>>>>>        set pExportState to false
32295>>>>>        send popup
32296>>>>>        set pExportState to true
32297>>>>>      end_procedure
32298>>>>>
32298>>>>>      procedure popup_group
32300>>>>>        local integer focus#
32301>>>>>        local date date#
32301>>>>>        move (focus(desktop)) to focus#
32302>>>>>        set invoking_object_id to focus#
32303>>>>>        get value of focus# item current to date#
32304>>>>>        ifnot (integer(date#)) move (dSysdate()) to date#
32307>>>>>        move (Date2to4(date#)) to date#
32308>>>>>        set p_current_date to date#
32309>>>>>        send display
32310>>>>>        forward send popup_group
32312>>>>>        send display to (days_grid(cont3d(current_object))) 1
32313>>>>>      end_procedure
32314>>>>>
32314>>>>>      procedure move_value_out
32316>>>>>        local integer focus# dm# margin# datatype#
32317>>>>>        if (pExportState(current_object)) begin
32319>>>>>          get invoking_object_id to focus#
32320>>>>>          if focus# gt desktop begin
32322>>>>>            get delegation_mode of focus# to dm#
32323>>>>>            set delegation_mode of focus# to no_delegate_or_error
32324>>>>>            send NotifyPopupCalendarSelect to focus# (p_current_date(current_object))
32325>>>>>            get form_margin of focus# item current to margin#
32326>>>>>            get form_datatype of focus# item current to datatype#
32327>>>>>            set delegation_mode of focus# to dm#
32328>>>>>            if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to (p_current_date(current_object))
32331>>>>>            else             set value of focus# item current to (Date4to2(p_current_date(current_object)))
32333>>>>>            set item_changed_state of focus# item current to true
32334>>>>>          end
32334>>>>>>
32334>>>>>        end
32334>>>>>>
32334>>>>>      end_procedure
32335>>>>>
32335>>>>>      procedure move_value_out_ok
32337>>>>>        send move_value_out
32338>>>>>        send deactivate
32339>>>>>      end_procedure
32340>>>>>
32340>>>>>      procedure request_popup
32342>>>>>        local integer focus# type# dm#
32343>>>>>        move (focus(desktop)) to focus#
32344>>>>>        if focus# gt desktop begin
32346>>>>>          get delegation_mode of focus# to dm#
32347>>>>>          set delegation_mode of focus# to no_delegate_or_error
32348>>>>>          get form_datatype of focus# item current to type#
32349>>>>>          if (type#=date_window or type#=mask_date_window) send popup
32352>>>>>          set delegation_mode of focus# to dm#
32353>>>>>        end
32353>>>>>>
32353>>>>>      end_procedure
32354>>>>>    end_object
32355>>>>>  end_desktop_section
32357>>>>>  // If the procedure below was not defined "for BaseClass" its symbolic
32357>>>>>  // substitute would become negative (because located on the desktop). This
32357>>>>>  // would result in the toolbar object not being able to handle it. Therefore:
32357>>>>>  procedure request_popup_calendar for BaseClass
32358>>>>>    send request_popup to (popup_calendar(current_object))
32359>>>>>  end_procedure
32360>>>>>  procedure popup_calendar_no_export
32361>>>>>    send popup_no_export to (popup_calendar(current_object))
32362>>>>>  end_procedure
32363>>>>>  register_procedure Add_Toolbar_Button_Bitmap string bmp# string Tip# string StHlp# integer msg# integer obj#
32363>>>>>  procedure Add_Calendar_tbButton integer oTb#
32364>>>>>    send Add_Toolbar_Button_Bitmap to oTb# "DfCalend.bmp" t.calendar.calendar_popup t.calendar.Activate msg_request_popup_calendar
32365>>>>>  end_procedure
32366>>>>> function s.calendar returns integer // Backwards compatible!!
32367>>>>>   function_return (popup_calendar(current_object))
32368>>>>> end_function
32369>>>>>
32369>>>>>// Karl,
32369>>>>>// Structure is as follows,
32369>>>>>//
32369>>>>>// //put this code in the top portion of the view code or in the program
32369>>>>>// code.
32369>>>>>//
32369>>>>>// Type SystemTime
32369>>>>>//   field SystemTime.iYear As Word
32369>>>>>//   field SystemTime.iMonth As Word
32369>>>>>//   field SystemTime.iDayOfWeek As Word
32369>>>>>//   field SystemTime.iDay As Word
32369>>>>>//   field SystemTime.iHour As Word
32369>>>>>//   field SystemTime.iMinute As Word
32369>>>>>//   field SystemTime.iSecond As Word
32369>>>>>//   field SystemTime.iMilliseconds As Word
32369>>>>>// End_Type
32369>>>>>//
32369>>>>>// external_function GetSystemTime "GetSystemTime" kernel32.dll Pointer lpGST Returns VOID_TYPE
32369>>>>>//
32369>>>>>// //put this code in an onClick or wherever
32369>>>>>// procedure onclick
32369>>>>>//   local integer iRetVal
32369>>>>>//   local string TimeData
32369>>>>>//   local pointer GST
32369>>>>>//
32369>>>>>//   ZeroType SystemTime to TimeData
32369>>>>>//   getAddress from TimeData to GST
32369>>>>>//
32369>>>>>//   move (GetSystemTime(GST)) to iRetVal
32369>>>>>// end_procedure
32369>>>>>//
32369>>>>>// To extract the data from the Structure after calling the function use
32369>>>>>// the getbuff command as follows:
32369>>>>>//
32369>>>>>// getbuff from TimeData as SystemTime.IVAL to var
32369>>>>>//
32369>>>>>// where IVAL is one of the vars such as iYear or iDay, etc.
32369>>>>>//
32369>>>>>// OLIVER NELSON
32369>>>>>//
32369>>>>>//
32369>>>
32369>>>//AB-StoreTopEnd
32369>>>
32369>>>//AB-IgnoreStart
32369>>>
32369>>>Use DFAllEnt.pkg
32369>>>
32369>>>
32369>>>//AB-IgnoreEnd
32369>>>
32369>>>CD_Popup_Object oCalendar is a dbModalPanel
32388>>>
32388>>>    //AB-StoreTopStart
32388>>>    on_key kcancel           send cancel
32389>>>    //AB-StoreTopEnd
32389>>>
32389>>>    Set Border_Style to Border_Normal
32390>>>    Set Caption_Bar to FALSE
32391>>>    Set Label to "Ÿ­¢ àì, 2001"
32392>>>    Set Size to 98 123
32393>>>    Set Location to 10 22
32394>>>    Set Color to clWhite
32395>>>
32395>>>    //AB-DDOStart
32395>>>
32395>>>
32395>>>    //AB-DDOEnd
32395>>>
32395>>>    Object Container3d1 is a Container3d
32397>>>        Set Size to 88 135
32398>>>        Set Location to -2 -1
32399>>>        Set Color to clWhite
32400>>>        Set Border_Style to Border_None
32401>>>        Object Grid2 is a Grid
32403>>>
32403>>>            //AB-StoreTopStart
32403>>>            property date    p_current_date     public 0
32405>>>            property integer p_current_year     public -1
32407>>>            property integer p_current_month    public -1
32409>>>            property integer p_selected_day     public -1
32411>>>            property integer pExportState       public 1
32413>>>            property integer invoking_object_id public 0
32415>>>            
32415>>>            Set Border_Style To BORDER_NONE
32416>>>            Set header_visible_state To False
32417>>>            set select_mode to no_select
32418>>>            Set Gridline_mode To GRID_VISIBLE_NONE
32419>>>            
32419>>>            on_key Key_F1 Send Help
32420>>>            on_key key_ctrl+key_pgup send prev_year
32421>>>            on_key key_ctrl+key_pgdn send next_year
32422>>>            on_key          key_pgup send prev_month
32423>>>            on_key          key_pgdn send next_month
32424>>>            on_key key_enter         send move_value_out
32425>>>            on_key key_ctrl+key_d    send go_today
32426>>>            
32426>>>            //AB-StoreTopEnd
32426>>>
32426>>>            Set Color to clWhite
32427>>>            Set CurrentCellColor to clWhite
32428>>>            Set CurrentCellTextColor to clWhite
32429>>>            Set Size to 61 145
32430>>>            Set Location to 30 1
32431>>>            Set Resize_Column_state to FALSE
32432>>>
32432>>>            Set Line_Width to 7 0
32433>>>
32433>>>            Set Form_Width    item 0 to 18
32434>>>            Set Header_Label  item 0 to "­"
32435>>>            
32435>>>            Set Form_Width    item 1 to 18
32436>>>            Set Header_Label  item 1 to "‚â"
32437>>>            
32437>>>            Set Form_Width    item 2 to 18
32438>>>            Set Header_Label  item 2 to "‘à"
32439>>>            
32439>>>            Set Form_Width    item 3 to 18
32440>>>            Set Header_Label  item 3 to "—â"
32441>>>            
32441>>>            Set Form_Width    item 4 to 18
32442>>>            Set Header_Label  item 4 to "â"
32443>>>            
32443>>>            Set Form_Width    item 5 to 18
32444>>>            Set Header_Label  item 5 to "‘¡"
32445>>>            
32445>>>            Set Form_Width    item 6 to 18
32446>>>            Set Header_Label  item 6 to "‚á"
32447>>>            
32447>>>
32447>>>            //AB-StoreStart
32447>>>            
32447>>>            procedure go_today
32449>>>                Date date#
32450>>>                sysdate4 date#
32451>>>                set p_current_date to date#
32452>>>                Send Update_Calendar
32453>>>            end_procedure
32454>>>            
32454>>>            procedure next_month
32456>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32457>>>                Send Update_Calendar
32458>>>            end_procedure
32459>>>            
32459>>>            procedure prev_month
32461>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32462>>>                Send Update_Calendar
32463>>>            end_procedure
32464>>>            
32464>>>            procedure next_year
32466>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32467>>>                Send Update_Calendar
32468>>>            end_procedure
32469>>>            
32469>>>            procedure prev_year
32471>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32472>>>                Send Update_Calendar
32473>>>            end_procedure
32474>>>            
32474>>>            Procedure Activate
32476>>>                Date date#
32477>>>                Forward Send Activate
32479>>>                Set current_item to (p_selected_day(Self))
32480>>>            End_Procedure
32481>>>            
32481>>>            Procedure Update_Calendar
32483>>>                Set Dynamic_Update_State To False
32484>>>                send Fill_List
32485>>>                Set Dynamic_Update_State To True
32486>>>                // Send Update_Label
32486>>>                Set current_item to (p_selected_day(Self))
32487>>>                Send Date_Changing to (oYear(Container3d2(self)))
32488>>>                Send Date_Changing to (oMonth(Container3d2(self)))
32489>>>            End_Procedure
32490>>>            
32490>>>            Procedure Fill_List
32492>>>                Integer iFor prevdate# date# first_item# last_item# day# prev_last# nextdate# next_first#
32493>>>                Integer cur_year# cur_month# cur_day# sel_month# sel_day# sel_year#
32493>>>                Date dToday
32493>>>                Send Delete_Data
32494>>>            
32494>>>                Get p_current_date to date#
32495>>>            
32495>>>                SysDate4 dToday
32496>>>                move (DateSegment(dToday,DS_DAY)) to cur_day#
32497>>>                move (DateSegment(dToday,DS_MONTH)) to cur_month#
32498>>>                move (DateSegment(dToday,DS_YEAR)) to cur_year#
32499>>>            
32499>>>                move (DateSegment(date#,DS_DAY)) to sel_day#
32500>>>                move (DateSegment(date#,DS_MONTH)) to sel_month#
32501>>>                move (DateSegment(date#,DS_YEAR)) to sel_year#
32502>>>                Set p_current_month To sel_month#
32503>>>                Set p_current_year To sel_year#
32504>>>            
32504>>>                move (FirstDayInMonth(date#)) to date#
32505>>>                move (DateDayNumber(date#)-1) to first_item#
32506>>>                move (LastDayInMonth(date#)-date#+first_item#) to last_item#
32507>>>                move (DateIncrement(date#,DS_Month,-1)) To prevdate#
32508>>>                move (DateSegment((LastDayInMonth(prevdate#)),DS_DAY)) to prev_last#
32509>>>            
32509>>>                If (first_item# > 0) Begin
32511>>>                    Move (first_item#-1) to day#
32512>>>                    For iFor from 0 to (first_item#-1)
32518>>>>
32518>>>                        Send Add_Item msg_move_value_out (prev_last#-day#)
32519>>>                        Set Entry_State Item iFor To False
32520>>>                        Set ItemTextColor Item iFor To clGray
32521>>>                        Decrement day#
32522>>>                    Loop
32523>>>>
32523>>>                End
32523>>>>
32523>>>            
32523>>>                Move 1 To day#
32524>>>                For iFor from first_item# to last_item#
32530>>>>
32530>>>                    Send Add_Item Msg_Move_Value_Out day#
32531>>>                    Set Entry_State Item iFor To False
32532>>>                    If ((cur_month# eq sel_month#)and(cur_year# eq sel_year#)and(Day# eq cur_day#)) Set Form_Bitmap Item iFor To "cdate.bmp"
32535>>>                    If Day# eq sel_day# Set p_selected_day To iFor
32538>>>                    Set Form_justification_mode Item iFor To FORM_DISPLAYRIGHT
32539>>>                    Set form_datatype item iFor To mask_numeric_window
32540>>>                    Set form_Mask item iFor To "## "
32541>>>                    Increment day#
32542>>>                Loop
32543>>>>
32543>>>            
32543>>>                move (DateIncrement(date#,DS_Month,1)) To nextdate#
32544>>>                move (DateSegment((LastDayInMonth(nextdate#)),DS_DAY)) to next_first#
32545>>>            
32545>>>                If (last_item# < 41) Begin
32547>>>                    Move 1 to day#
32548>>>                    For iFor from (last_item#+1) to 41
32554>>>>
32554>>>                        Send Add_Item msg_move_value_out day#
32555>>>                        Set Entry_State Item iFor To False
32556>>>                        Set ItemTextColor Item iFor To clGray
32557>>>                        Increment day#
32558>>>                    Loop
32559>>>>
32559>>>                End
32559>>>>
32559>>>            
32559>>>            End_Procedure
32560>>>            
32560>>>            Procedure Help
32562>>>                Send Info_Box ("<Up>, <Dn>, <Lft>, <Rgt> - select date.\n<PgUp>, <PgDn> - select month.\n<Ctrl>+<D> - set current date.\n<Ctrl>+<PgUp>, <PgDn> - Select year.\n\n(c) 2001, SCR. Special thanks to Sture Andersen.") ("Help on Calendar")
32563>>>            End_Procedure
32564>>>            
32564>>>            procedure mouse_click integer window integer char_pos
32566>>>                Send Move_Value_Out
32567>>>                forward send mouse_click window char_pos
32569>>>            end_procedure
32570>>>            
32570>>>            Procedure Move_Value_Out
32572>>>                Integer iYear iMonth iDay iItm
32573>>>                Date Date# next_date# prev_date#
32573>>>                Get Current_Item To iItm
32574>>>                If (pExportState(Self)) Begin
32576>>>                    Get Value Item iItm To iDay
32577>>>                    Get p_current_month to iMonth
32578>>>                    Get p_current_year  to iYear
32579>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32580>>>            
32580>>>                    If ((iItm>27)and(iDay<15)) Begin
32582>>>                        Move (DateCompose(1,iMonth,iYear)) To next_date#
32583>>>                        move (DateIncrement(next_date#,DS_Month,1)) To next_date#
32584>>>                        move (DateSegment(next_date#,DS_MONTH)) to iMonth
32585>>>                        move (DateSegment(next_date#,DS_YEAR)) to iYear
32586>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32587>>>                    End
32587>>>>
32587>>>                    If ((iItm<7)and(iDay>20)) Begin
32589>>>                        Move (DateCompose(1,iMonth,iYear)) To prev_date#
32590>>>                        move (DateIncrement(prev_date#,DS_Month,-1)) To prev_date#
32591>>>                        move (DateSegment(prev_date#,DS_MONTH)) to iMonth
32592>>>                        move (DateSegment(prev_date#,DS_YEAR)) to iYear
32593>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32594>>>                    End
32594>>>>
32594>>>            
32594>>>                    Send Export_Date date#
32595>>>                End
32595>>>>
32595>>>            End_Procedure
32596>>>            
32596>>>            Procedure Export_Date date date#
32598>>>                local integer focus# dm# margin# datatype#
32599>>>                get invoking_object_id to focus#
32600>>>            
32600>>>                if focus# gt desktop begin
32602>>>                     get delegation_mode of focus# to dm#
32603>>>                     set delegation_mode of focus# to no_delegate_or_error
32604>>>                     get form_margin of focus# item current to margin#
32605>>>                     get form_datatype of focus# item current to datatype#
32606>>>                     set delegation_mode of focus# to dm#
32607>>>                     if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to date#
32610>>>                     else             set value of focus# item current to (Date4to2(date#))
32612>>>                     set item_changed_state of focus# item current to true
32613>>>                end
32613>>>>
32613>>>                Send Close_Calendar
32614>>>            End_Procedure
32615>>>            //AB-StoreEnd
32615>>>
32615>>>        End_Object    // Grid2
32616>>>
32616>>>        Object Textbox2 is a Textbox
32618>>>            Set Label to "­"
32619>>>            Set Auto_Size_State to FALSE
32620>>>            Set Transparent_State to TRUE
32621>>>            Set Color to clWhite
32622>>>            Set TextColor to clNavy
32623>>>            Set Location to 19 4
32624>>>            Set Size to 10 15
32625>>>
32625>>>            //AB-StoreStart
32625>>>                                        
32625>>>            Set Label To (left(t.calendar.Monday,2))
32626>>>            //AB-StoreEnd
32626>>>
32626>>>        End_Object    // Textbox2
32627>>>
32627>>>        Object Textbox3 is a Textbox
32629>>>            Set Label to "‚â"
32630>>>            Set Auto_Size_State to FALSE
32631>>>            Set Transparent_State to TRUE
32632>>>            Set Color to clWhite
32633>>>            Set TextColor to clNavy
32634>>>            Set Location to 19 22
32635>>>            Set Size to 10 12
32636>>>
32636>>>            //AB-StoreStart
32636>>>                                        
32636>>>            Set Label To (left(t.calendar.Tuesday,2))
32637>>>            //AB-StoreEnd
32637>>>
32637>>>        End_Object    // Textbox3
32638>>>
32638>>>        Object Textbox4 is a Textbox
32640>>>            Set Label to "‘à"
32641>>>            Set Auto_Size_State to FALSE
32642>>>            Set Transparent_State to TRUE
32643>>>            Set Color to clWhite
32644>>>            Set TextColor to clNavy
32645>>>            Set Location to 19 39
32646>>>            Set Size to 10 15
32647>>>
32647>>>            //AB-StoreStart
32647>>>                                        
32647>>>            Set Label To (left(t.calendar.Wednesday,2))
32648>>>            //AB-StoreEnd
32648>>>
32648>>>        End_Object    // Textbox4
32649>>>
32649>>>        Object Textbox5 is a Textbox
32651>>>            Set Label to "—â"
32652>>>            Set Auto_Size_State to FALSE
32653>>>            Set Transparent_State to TRUE
32654>>>            Set Color to clWhite
32655>>>            Set TextColor to clNavy
32656>>>            Set Location to 19 57
32657>>>            Set Size to 10 17
32658>>>
32658>>>            //AB-StoreStart
32658>>>                                        
32658>>>            Set Label To (left(t.calendar.Thursday,2))
32659>>>            //AB-StoreEnd
32659>>>
32659>>>        End_Object    // Textbox5
32660>>>
32660>>>        Object Textbox6 is a Textbox
32662>>>            Set Label to "â"
32663>>>            Set Auto_Size_State to FALSE
32664>>>            Set Transparent_State to TRUE
32665>>>            Set Color to clWhite
32666>>>            Set TextColor to clNavy
32667>>>            Set Location to 19 76
32668>>>            Set Size to 10 17
32669>>>
32669>>>            //AB-StoreStart
32669>>>                                        
32669>>>            Set Label To (left(t.calendar.Friday,2))
32670>>>            //AB-StoreEnd
32670>>>
32670>>>        End_Object    // Textbox6
32671>>>
32671>>>        Object Textbox7 is a Textbox
32673>>>            Set Label to "‘¡"
32674>>>            Set Auto_Size_State to FALSE
32675>>>            Set Transparent_State to TRUE
32676>>>            Set Color to clWhite
32677>>>            Set TextColor to clNavy
32678>>>            Set Location to 19 91
32679>>>            Set Size to 10 18
32680>>>
32680>>>            //AB-StoreStart
32680>>>                                        
32680>>>            Set Label To (left(t.calendar.Saturday,2))
32681>>>            //AB-StoreEnd
32681>>>
32681>>>        End_Object    // Textbox7
32682>>>
32682>>>        Object Textbox8 is a Textbox
32684>>>            Set Label to "‚á"
32685>>>            Set Auto_Size_State to FALSE
32686>>>            Set Transparent_State to TRUE
32687>>>            Set Color to clWhite
32688>>>            Set TextColor to clNavy
32689>>>            Set Location to 19 109
32690>>>            Set Size to 10 17
32691>>>
32691>>>            //AB-StoreStart
32691>>>                                        
32691>>>            Set Label To (left(t.calendar.Sunday,2))
32692>>>            //AB-StoreEnd
32692>>>
32692>>>        End_Object    // Textbox8
32693>>>
32693>>>        Object LineControl1 is a LineControl
32695>>>            Set Line_Style to lnSINGLE
32696>>>            Set Size to 1 116
32697>>>            Set Location to 28 4
32698>>>
32698>>>            //AB-StoreStart
32698>>>                                        
32698>>>            //AB-StoreEnd
32698>>>
32698>>>        End_Object    // LineControl1
32699>>>
32699>>>        Object Container3d2 is a Container3d
32701>>>            Set Size to 18 131
32702>>>            Set Location to 1 1
32703>>>            Set Color to clNavy
32704>>>            Set Border_Style to Border_None
32705>>>            Object oRght is a BitmapContainer
32707>>>                Set Size to 10 14
32708>>>                Set Location to 4 105
32709>>>                Set Bitmap to "rght.bmp"
32710>>>                Set Border_Style to Border_None
32711>>>
32711>>>                //AB-StoreStart
32711>>>                Procedure Mouse_Down
32713>>>                    Send Next_Month to Grid2
32714>>>                End_Procedure
32715>>>                //AB-StoreEnd
32715>>>
32715>>>            End_Object    // oRght
32716>>>
32716>>>            Object oLeft is a BitmapContainer
32718>>>                Set Size to 10 14
32719>>>                Set Location to 4 3
32720>>>                Set Bitmap to "lft.bmp"
32721>>>                Set Border_Style to Border_None
32722>>>
32722>>>                //AB-StoreStart
32722>>>                Procedure Mouse_Down
32724>>>                    Send Prev_Month to Grid2
32725>>>                End_Procedure
32726>>>                //AB-StoreEnd
32726>>>
32726>>>            End_Object    // oLeft
32727>>>
32727>>>            Object oMonth is a Textbox
32729>>>
32729>>>                //AB-StoreTopStart
32729>>>                Property integer piSelected_Month public 0
32731>>>                //AB-StoreTopEnd
32731>>>
32731>>>                Set Label to "January"
32732>>>                Set Auto_Size_State to FALSE
32733>>>                Set Transparent_State to TRUE
32734>>>                Set Color to clWhite
32735>>>                Set TextColor to clWhite
32736>>>                Set Location to 4 23
32737>>>                Set Size to 10 43
32738>>>                Set FontWeight to 800
32739>>>                Set Justification_Mode to jMode_Center
32740>>>
32740>>>                //AB-StoreStart
32740>>>                                    
32740>>>                Procedure Mouse_Down
32742>>>                    Integer iState
32743>>>                    Get Visible_State of oSelectYear to iState
32744>>>                    If (iState) Send OnKillFocus to oSelectYear
32747>>>                    Send Popup to oSelectMonth
32748>>>                End_Procedure
32749>>>                
32749>>>                Procedure pSelectJan
32751>>>                    Set Label to t.calendar.january
32752>>>                    Set piSelected_Month to 1
32753>>>                    Send Adjust_Calendar
32754>>>                End_Procedure
32755>>>                Procedure pSelectFeb
32757>>>                    Set Label to t.calendar.february
32758>>>                    Set piSelected_Month to 2
32759>>>                    Send Adjust_Calendar
32760>>>                End_Procedure
32761>>>                Procedure pSelectMar
32763>>>                    Set Label to t.calendar.march
32764>>>                    Set piSelected_Month to 3
32765>>>                    Send Adjust_Calendar
32766>>>                End_Procedure
32767>>>                Procedure pSelectApr
32769>>>                    Set Label to t.calendar.april
32770>>>                    Set piSelected_Month to 4
32771>>>                    Send Adjust_Calendar
32772>>>                End_Procedure
32773>>>                Procedure pSelectMay
32775>>>                    Set Label to t.calendar.may
32776>>>                    Set piSelected_Month to 5
32777>>>                    Send Adjust_Calendar
32778>>>                End_Procedure
32779>>>                Procedure pSelectJun
32781>>>                    Set Label to t.calendar.june
32782>>>                    Set piSelected_Month to 6
32783>>>                    Send Adjust_Calendar
32784>>>                End_Procedure
32785>>>                Procedure pSelectJul
32787>>>                    Set Label to t.calendar.july
32788>>>                    Set piSelected_Month to 7
32789>>>                    Send Adjust_Calendar
32790>>>                End_Procedure
32791>>>                Procedure pSelectAug
32793>>>                    Set Label to t.calendar.august
32794>>>                    Set piSelected_Month to 8
32795>>>                    Send Adjust_Calendar
32796>>>                End_Procedure
32797>>>                Procedure pSelectSep
32799>>>                    Set Label to t.calendar.september
32800>>>                    Set piSelected_Month to 9
32801>>>                    Send Adjust_Calendar
32802>>>                End_Procedure
32803>>>                Procedure pSelectOct
32805>>>                    Set Label to t.calendar.october
32806>>>                    Set piSelected_Month to 10
32807>>>                    Send Adjust_Calendar
32808>>>                End_Procedure
32809>>>                Procedure pSelectNov
32811>>>                    Set Label to t.calendar.november
32812>>>                    Set piSelected_Month to 11
32813>>>                    Send Adjust_Calendar
32814>>>                End_Procedure
32815>>>                Procedure pSelectDec
32817>>>                    Set Label to t.calendar.december
32818>>>                    Set piSelected_Month to 12
32819>>>                    Send Adjust_Calendar
32820>>>                End_Procedure
32821>>>                
32821>>>                Object oSelectMonth is a FloatingPopupMenu
32823>>>                    Send Add_Item msg_pSelectJan t.calendar.january
32824>>>                    Send Add_Item msg_pSelectFeb t.calendar.february
32825>>>                    Send Add_Item msg_pSelectMar t.calendar.march
32826>>>                    Send Add_Item msg_pSelectApr t.calendar.april
32827>>>                    Send Add_Item msg_pSelectMay t.calendar.may
32828>>>                    Send Add_Item msg_pSelectJun t.calendar.june
32829>>>                    Send Add_Item msg_pSelectJul t.calendar.july
32830>>>                    Send Add_Item msg_pSelectAug t.calendar.august
32831>>>                    Send Add_Item msg_pSelectSep t.calendar.september
32832>>>                    Send Add_Item msg_pSelectOct t.calendar.october
32833>>>                    Send Add_Item msg_pSelectNov t.calendar.november
32834>>>                    Send Add_Item msg_pSelectDec t.calendar.december
32835>>>                End_Object
32836>>>                
32836>>>                Procedure Adjust_Calendar
32838>>>                    Date date#
32839>>>                    Integer iDay iMonth iYear iItm
32839>>>                    Set Visible_State to false
32840>>>                    Set Visible_State to true
32841>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
32842>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
32843>>>                    Get piSelected_Month to iMonth
32844>>>                    Get Label of oYear to iYear
32845>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32846>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
32847>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
32848>>>                End_Procedure
32849>>>                
32849>>>                Procedure Activating
32851>>>                    Forward Send Activating
32853>>>                    Send Date_Changing
32854>>>                End_Procedure
32855>>>                
32855>>>                Procedure Date_Changing
32857>>>                    Set Visible_State to false
32858>>>                    Set Label to (MonthName(p_current_Month(Grid2(Container3D1(Self)))))
32859>>>                    Set piSelected_Month to (p_current_Month(Grid2(Container3D1(Self))))
32860>>>                    Set Visible_State to true
32861>>>                End_Procedure
32862>>>                
32862>>>                
32862>>>                //AB-StoreEnd
32862>>>
32862>>>            End_Object    // oMonth
32863>>>
32863>>>            Object oYear is a Textbox
32865>>>                Set Label to "2001"
32866>>>                Set Transparent_State to TRUE
32867>>>                Set Color to clWhite
32868>>>                Set TextColor to clWhite
32869>>>                Set Location to 4 77
32870>>>                Set Size to 10 18
32871>>>                Set FontWeight to 800
32872>>>
32872>>>                //AB-StoreStart
32872>>>                                                    
32872>>>                Procedure Mouse_Down
32874>>>                    String sVal
32875>>>                    Get Label to sVal
32876>>>                    Set Value of oSelectYear item 0 to sVal
32877>>>                    Set Visible_State of oSelectYear to True
32878>>>                    Send Activate to (oSelectYear(Self))
32879>>>                End_Procedure
32880>>>                
32880>>>                Procedure Activating
32882>>>                    Forward Send Activating
32884>>>                    Send Date_Changing
32885>>>                End_Procedure
32886>>>                
32886>>>                Procedure Date_Changing
32888>>>                    Set Visible_State to false
32889>>>                    Set Label to (String(p_current_Year(Grid2(Container3D1(Self)))))
32890>>>                    Set Visible_State to true
32891>>>                End_Procedure
32892>>>                //AB-StoreEnd
32892>>>
32892>>>            End_Object    // oYear
32893>>>
32893>>>            Object oSelectYear is a Form
32895>>>
32895>>>                //AB-StoreTopStart
32895>>>                Set Visible_State To False
32896>>>                //AB-StoreTopEnd
32896>>>
32896>>>                Set Size to 10 24
32897>>>                Set Location to 4 75
32898>>>                Set Color to clWhite
32899>>>                Set TextColor to clNavy
32900>>>                Set Form_Border Item 0 to Border_Normal
32901>>>
32901>>>                //AB-StoreStart
32901>>>                                                    
32901>>>                On_Key Key_Enter Send OnKillFocus
32902>>>                On_Key Key_Escape Send OnKillFocus
32903>>>                
32903>>>                Procedure SetFontWeight
32905>>>                    Set Form_FontWeight item 0 to 800
32906>>>                End_Procedure
32907>>>                
32907>>>                Procedure OnKillFocus
32909>>>                    String sVal
32910>>>                    Integer iMonth iDay iYear iItm
32910>>>                    Date date#
32910>>>                    Get Value item 0 to sVal
32911>>>                    Set Visible_State of oYear to false
32912>>>                    Set Label of oYear to sVal
32913>>>                    Set Visible_State of oYear to true
32914>>>                    Set Visible_State to false
32915>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
32916>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
32917>>>                    Get piSelected_Month of oMonth to iMonth
32918>>>                    Get Value item 0 to iYear
32919>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32920>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
32921>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
32922>>>                End_Procedure
32923>>>                
32923>>>                Send SetFontWeight
32924>>>                //AB-StoreEnd
32924>>>
32924>>>            End_Object    // oSelectYear
32925>>>
32925>>>
32925>>>            //AB-StoreStart
32925>>>                            
32925>>>            Procedure Mouse_Down
32927>>>                Integer iState
32928>>>                Get Visible_State of oSelectYear to iState
32929>>>                If (iState) Send OnKillFocus to oSelectYear
32932>>>            End_Procedure
32933>>>            
32933>>>            //AB-StoreEnd
32933>>>
32933>>>        End_Object    // Container3d2
32934>>>
32934>>>
32934>>>        //AB-StoreStart
32934>>>                            
32934>>>        //AB-StoreEnd
32934>>>
32934>>>    End_Object    // Container3d1
32935>>>
32935>>>    Object BitmapContainer3 is a BitmapContainer
32937>>>        Set Size to 9 19
32938>>>        Set Location to 88 3
32939>>>        Set Color to clWhite
32940>>>        Set Bitmap to "cdate.bmp"
32941>>>        Set Border_Style to Border_None
32942>>>
32942>>>        //AB-StoreStart
32942>>>        Procedure Mouse_Down
32944>>>            Send go_today to (Grid2(Container3d1(Self)))
32945>>>            Send Adjust_Label to oToday
32946>>>        End_Procedure
32947>>>        //AB-StoreEnd
32947>>>
32947>>>    End_Object    // BitmapContainer3
32948>>>
32948>>>    Object oToday is a Textbox
32950>>>        Set Label to "Today: 01.01.2001"
32951>>>        Set Auto_Size_State to FALSE
32952>>>        Set Color to clWhite
32953>>>        Set Location to 88 22
32954>>>        Set Size to 8 73
32955>>>        Set FontWeight to 800
32956>>>
32956>>>        //AB-StoreStart
32956>>>        Procedure Mouse_Down
32958>>>            Send go_today to (Grid2(Container3d1(Self)))
32959>>>            Send Adjust_Label
32960>>>        End_Procedure
32961>>>        
32961>>>        Procedure Adjust_Label
32963>>>            date date#
32964>>>            SysDate4 date#
32965>>>            Set Visible_State To false
32966>>>            Set Label         to (t.calendar.today+": "+String(date#))
32967>>>            Set Visible_State To true
32968>>>        End_Procedure
32969>>>        
32969>>>        Procedure Activating
32971>>>            Forward Send Activating
32973>>>            Send Adjust_Label
32974>>>        End_Procedure
32975>>>        //AB-StoreEnd
32975>>>
32975>>>    End_Object    // oToday
32976>>>
32976>>>
32976>>>    //AB-StoreStart
32976>>>                
32976>>>    procedure popup
32978>>>        local integer focus# icItm iYear iMonth
32979>>>        local date date#
32979>>>        move (focus(desktop)) to focus#
32980>>>        set invoking_object_id of (Grid2(Container3d1(self))) to focus#
32981>>>        get value of focus# item current to date#
32982>>>        ifnot (integer(date#)) sysdate date#
32985>>>        move (Date2to4(date#)) to date#
32986>>>        set p_current_date of (Grid2(Container3d1(self))) to date#
32987>>>        send fill_list to (Grid2(Container3d1(self)))
32988>>>        move (DateSegment(date#,DS_YEAR)) to iYear
32989>>>        move (DateSegment(date#,DS_MONTH)) to iMonth
32990>>>        Set Label To (MonthName(iMonth)+', '+String(iYear))
32991>>>        forward send popup
32993>>>    end_procedure
32994>>>    
32994>>>    Procedure Close_Calendar
32996>>>        Send Exit
32997>>>    End_Procedure
32998>>>    //AB-StoreEnd
32998>>>
32998>>>CD_End_Object    // oCalendar
33000>>>>
33000>>>
33000>>>
33000>>>//AB-StoreStart
33000>>>    
33000>>>    
33000>>>//AB-StoreEnd
33000>>>
33000>>>//AB/ End_Object    // prj
33000>Use Dates.Utl
33000>Use Roundfn.Fnc
INCLUDING FILE: ROUNDFN.FNC
33000>>>// ===========================================================================
33000>>>//
33000>>>// The ROUND_NUMBER global function has been designed to return the rounded
33000>>>// value of a given 'numeric' argument at a specified rounding precision.
33000>>>//
33000>>>// ---------------------------------------------------------------------------
33000>>>// This version dispenses with the use of powers (10 ^ n) to perform the
33000>>>// necessary calculations.  It uses a string handling technique instead.
33000>>>// ---------------------------------------------------------------------------
33000>>>//
33000>>>// The function requires two arguments, as follows:-
33000>>>//
33000>>>// (a) The numeric value to be rounded, where the range of valid values is
33000>>>//     +/- 99,999,999,999,999.99999999.
33000>>>//
33000>>>// (b) The rounding precision required.  This must be an integer value in the
33000>>>//     range -13 to +8.  If a value outside this range is used, the nearest
33000>>>//     threshold value is substituted.
33000>>>//
33000>>>//     Values in the range +1 to +7 perform rounding on the decimal part of
33000>>>//     the number.  A value of +8 will perform no rounding at all.  A zero
33000>>>//     value will round to the nearest whole number.  Values -1 to -13 will
33000>>>//     round progressively to the left of the decimal point (a frequent
33000>>>//     requirement in financial reporting).
33000>>>//
33000>>>// If the result of the rounding produces a value outside the valid numeric
33000>>>// range (+/- 99,999,999,999,999.99999999) then a zero value is returned.
33000>>>//
33000>>>// Assumptions:-  The only assumptions made have been that the range of
33000>>>// numeric values and the limit of eight decimal places are unlikely to change
33000>>>// in the forseeable future.
33000>>>//
33000>>>// Examples:-
33000>>>//
33000>>>//  1st Argument      2nd Argument   Return Value
33000>>>//  ------------      ------------   ------------
33000>>>//  123456.87654321         8         123456.87654321
33000>>>//  123456.87654321         2         123456.88
33000>>>// -123456.87654321         2        -123456.88
33000>>>//  123456.98765432         0         123457
33000>>>// -123456.98765432        -1        -123460
33000>>>//  123456.98765432        -2         123500
33000>>>//  123456.98765432        -3         123000
33000>>>//  987654                 -4         990000
33000>>>//  987654                 -5        1000000
33000>>>//  987654                 -6        1000000
33000>>>//  987654                 -7              0
33000>>>//
33000>>>// ===========================================================================
33000>>>
33000>>>
33000>>>Function Round_Number GLOBAL number nVal integer iRnd returns Number
33001>>>
33001>>>  Local Number nAdj
33002>>>
33002>>>  Move 10000000000000 to nAdj
33003>>>
33003>>>  // If the rounding precision falls in the range 0 to 8, then return:-
33003>>>
33003>>>  If (iRnd >= 0) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 / (Number(Left(nAdj, ((iRnd + 1) ;      min 9)))) + nVal / (Number(Left(nAdj, (9 - (iRnd min 8))))) ;        * (Number(Left(nAdj, (9 - (iRnd min 8))))))
33006>>>
33006>>>  // Else, where the rounding precision is in the range -1 to -5, return:-
33006>>>
33006>>>  If (iRnd >= -5) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(Left(nAdj, (Abs(iRnd) + 9)))) ;        * (Number(Left(nAdj, (Abs(iRnd) + 9)))))
33009>>>
33009>>>  // Else, where the rounding precision is in the range -6 to -13, return:-
33009>>>
33009>>>  Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(nAdj)) / (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))) ;        * (Number(nAdj)) * (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))))
33010>>>
33010>>>End_Function
33011>Use Connect.Dg
INCLUDING FILE: CONNECT.DG
33011>>>//AB/ Project Connect
33011>>>//AB/ Object prj is a Dialog_Project
33011>>>//AB/     Set ProjectName to "Connect"
33011>>>//AB/     Set ProjectFileName to "Connect.dg"
33011>>>
33011>>>// Project Object Structure
33011>>>//   Connect is a BasicPanelSub
33011>>>//     BitmapContainer1 is a BitmapContainerSub
33011>>>//     Textbox5 is a TextBoxSub
33011>>>//     ComboForm2 is a ComboFormSub
33011>>>//     Textbox6 is a TextBoxSub
33011>>>//     Form4 is a FormSub
33011>>>//     Textbox7 is a TextBoxSub
33011>>>//     Form5 is a FormSub
33011>>>//     Textbox8 is a TextBoxSub
33011>>>//     Form6 is a FormSub
33011>>>//     CheckBox1 is a CheckBoxSub
33011>>>//     oOK_bn is a ButtonSub
33011>>>//     oCancel_bn is a ButtonSub
33011>>>
33011>>>// Register all objects
33011>>>Register_Object BitmapContainer1
33011>>>Register_Object CheckBox1
33011>>>Register_Object ComboForm2
33011>>>Register_Object Connect
33011>>>Register_Object Form4
33011>>>Register_Object Form5
33011>>>Register_Object Form6
33011>>>Register_Object oCancel_bn
33011>>>Register_Object oOK_bn
33011>>>Register_Object Textbox5
33011>>>Register_Object Textbox6
33011>>>Register_Object Textbox7
33011>>>Register_Object Textbox8
33011>>>
33011>>>
33011>>>
33011>>>//AB-StoreTopStart
33011>>>
33011>>>///#INCLUDE
33011>>>Use mertech.inc
INCLUDING FILE: MERTECH.INC
33011>>>>>USE UI
33011>>>>>
#REM -----------------------------------------------
#REM MERTECH DATA SYSTEMS INC. - WWW.MERTECHDATA.COM
#REM MERTECH.INC VERSION 2.1.9
#REM -----------------------------------------------
33011>>>>>
33011>>>>>
33011>>>>>
33011>>>>>
33011>>>>>
33011>>>>>//
33011>>>>>//
33011>>>>>//
33011>>>>>//
33011>>>>>//
33011>>>>>//-----------------------------------------------
33011>>>>>// SELECT_COLUMNS_FIND <FILE> <START> THRU <END>
33011>>>>>// SELECT_COLUMNS_FIND <FILE> <FIELD>
33011>>>>>// This command will issue a properly commands to define the FETCH attribute status
33011>>>>>// for file fields.
33011>>>>>//
33011>>>>>//------------------------------------------------------------------------------
33011>>>>>// RESET_FETCH_FIELDS <FILE NAME>|<FILE NUMBER> <DF_FETCH_TRUE>|<DF_FETCH_FALSE>
33011>>>>>//
33011>>>>>//
33011>>>>>//-----------------------------
33011>>>>>// SQL_FOR_ONEROW <file number>
33011>>>>>//
33011>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get just
33011>>>>>// one ROW for each DataFlex FIND command issued
33011>>>>>// In this case the DBMS optimizer will generate a query with just one row
33011>>>>>//
33011>>>>>//
33011>>>>>//-------------------------------------------------------------------------------
33011>>>>>// SQL_FOR_SET <file number> MAXROWS <number of rows> CACHE|NOCACHE <return code>
33011>>>>>//
33011>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get a SET of rows.
33011>>>>>// In this case the DBMS optimizer will generate a query with <number of rows> Rows.
33011>>>>>// if CACHE is passed as argument, all these rows will be transfered to ORAFlex and then it will
33011>>>>>// save them in a local CACHE buffer. Just the FIND GT and FIND LT will get local cache.
33011>>>>>// Otherwise, i.e NOCACHE,  ORAFLex won't create a local cache.
33011>>>>>//
33011>>>>>//
33011>>>>>//---------------
33011>>>>>// SQL_SET <stmt>
33011>>>>>//
33011>>>>>//-----------------------------------------
33011>>>>>// SQL_APPEND <stmt1> <stmt2> .... <stmtn>
33011>>>>>//
33011>>>>>//------------
33011>>>>>// SQL_EXECUTE
33011>>>>>//
33011>>>>>//----------------------------------------------------------------------
33011>>>>>// LOCK_TABLE [<FILE NAME>|<FILE NUMBER> <FILE NAME>|<FILE NUMBER> ....]
33011>>>>>//
33011>>>>>// LOCK_TABLE will lock the entire table specified as an argument
33011>>>>>// This command will start a new transaction if it still wasn't done.
33011>>>>>// LOCK_TABLE won't lock the other opened tables or the current rows present
33011>>>>>// in their buffers it will be necessary issue a REREAD command to Lock the current
33011>>>>>// rows and then atualize their buffers
33011>>>>>//
33011>>>>>//
33011>>>>>//-------------------------------------------
33011>>>>>// SQL_CHECK_TABLE <SCHEMA NAME> <TABLE NAME>
33011>>>>>//
33011>>>>>//-------------------------------
33011>>>>>// CREATE_TD_FILE  DFTRUE|DFFALSE
33011>>>>>// SET A GLOBAL ATTRIBUTE TO CREATE THE TD FILE AFTER CLOSING AN OPENED FILE
33011>>>>>//
33011>>>>>//-------------------------------------------------
33011>>>>>// OPEN_INT <DATAFLEX FILE NAME>
33011>>>>>// OPEN_INT <PHYSICAL NAME> AS <DATAFLEX FILE NAME>
33011>>>>>//
33011>>>>>// OPEN_INT will check if the OPEN done is an OPEN AS. IF it's true, OPEN_INT
33011>>>>>// will try to open an intermediate file, if there is one. Otherwise OPEN_INT
33011>>>>>// will issue a OPEN command
33011>>>>>// OPEN_INT must be inserted into FMAC file instead OPEN COMMAND
33011>>>>>//
33011>>>>>//=========================================================================================================
33011>>>>>// SELECT STUFFS
33011>>>>>//--------------
33011>>>>>// SQL_SET_STMT OF FILENAME|FILENUMBER TO <STATMENT1>
33011>>>>>//
33011>>>>>// SQL_APPEND_ OF FILENAME|FILENUMBER TO <STATMENT1> <STATMENT2> ... <STATMENTn>
33011>>>>>//
33011>>>>>//
33011>>>>>// SQL_APPEND_UPDCOL_STMT OF FILENAME|FILENUMBER VALUE EXPRESSION WITH FIELD1 FIELD2 ... FIELDN
33011>>>>>//
33011>>>>>// SQL_PREPARE_STMT OF FILENAME|FILENUMBER
33011>>>>>//
33011>>>>>// SQL_BIND_COLUMN [FILENAME|FILENUMBER] [FIELDNAME|FIELDNUMBER]
33011>>>>>//
33011>>>>>// SQL_BINDCOLUMNS_STMT OF FILENAME|FILENUMBER TO <COLUMN1> <COLUMN2> ... <COLUMNn>
33011>>>>>//
33011>>>>>// SQL_EXECUTE_STMT OF FILENAME|FILENUMBER
33011>>>>>//
33011>>>>>// SQL_COMMIT_STMT
33011>>>>>//
33011>>>>>// SQL_ROLLBACK_STMT
33011>>>>>//
33011>>>>>// SQL_FETCH_NEXT_ROW OF FILENAME|FILENUMBER
33011>>>>>//
33011>>>>>//
33011>>>>>//
33011>>>>>//
33011>>>>>// CALL_STORED_PROCEDURE will call a stored procedure passing arguments
33011>>>>>//
33011>>>>>// FORMAT TO USE : CALL_STORED_PROCEDURE <STORED_PROC_NAME> [PASSING <ARG1> <ARG2> ....<ARGn>]
33011>>>>>//
33011>>>>>//
33011>>>>>//---------------------------------------------------------------------------------------------
33011>>>>>// CALL_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
33011>>>>>// CALL_STORED_FUNCTION will call an Oracle stored function passing arguments
33011>>>>>//
33011>>>>>//---------------------------
33011>>>>>// SQL_TEXT_MESSAGE <MESSAGE>
33011>>>>>// Writes a message inside driver log trace file if this is activated
33011>>>>>//
33011>>>>>//-----------------------------------------------------
33011>>>>>// OUTPUT_INT_FILE FOR <FILE NUMBER> TO <INT FILE NAME>
33011>>>>>// Generating the INT file
33011>>>>>//
33011>>>>>// -----------------------
33011>>>>>// SQL_ERROR_MESSAGE <VAR>
33011>>>>>// SQL_ERROR_MESSAGE retrieve the native error message issued by server for error number 25000
33011>>>>>
33011>>>>>
33011>>>>>//=======================================================================================
33011>>>>>// SQLFlex Commands
33011>>>>>//-----------------
33011>>>>>//
33011>>>>>//-----------------------
33011>>>>>// SQLFlex_REVISION <VAR>
33011>>>>>// Retrieves SQLFlex revision
33011>>>>>//
33011>>>>>//-------------------------------------
33011>>>>>// SET_DATABASE_NAME TO <DATABASE NAME>
33011>>>>>// Sets current database
33011>>>>>//
33011>>>>>//---------------------------
33011>>>>>// GET_DATABASE_NAME TO <VAR>
33011>>>>>// Gets name of current database
33011>>>>>//
33011>>>>>//----------------------------------
33011>>>>>// SET_SCHEMA_NAME TO <SCHEMA NAME>
33011>>>>>// Sets current schema name
33011>>>>>//
33011>>>>>//-------------------------
33011>>>>>// GET_SCHEMA_NAME TO <VAR>
33011>>>>>// Gets current schema name
33011>>>>>//
33011>>>>>//--------------------------------
33011>>>>>// SQL_USEDATABASE <DATABASE NAME>
33011>>>>>// Specifies the current Database
33011>>>>>//
33011>>>>>//----------------------------
33011>>>>>// SET_CURRENT_SERVER TO <VAR>
33011>>>>>// Set the current logged server
33011>>>>>//
33011>>>>>//----------------------------
33011>>>>>// GET_CURRENT_SERVER TO <VAR>
33011>>>>>// Retrieves the current logged server
33011>>>>>//
33011>>>>>//-----------------------------
33011>>>>>// SET_HOST_NAME TO <HOST NAME>
33011>>>>>// Defines current host name
33011>>>>>//
33011>>>>>//-----------------------
33011>>>>>// GET_HOST_NAME TO <VAR>
33011>>>>>// Retrieves the current host name
33011>>>>>//
33011>>>>>//---------------------------------------------------------------
33011>>>>>// LOGIN_SQLFLEX <SERVER NAME> <USER NAME> <PASSWORD> <HOST NAME>
33011>>>>>// Specifies host name during login process
33011>>>>>//
33011>>>>>// SQL_CANCEL_QUERY_STMT
33011>>>>>//
33011>>>>>//========================================
33011>>>>>// SQL SERVER Stored Procedure Call engine
33011>>>>>//----------------------------------------
33011>>>>>//
33011>>>>>//
33011>>>>>
33011>>>>>//
33011>>>>>//--------------------------------------------------------------------------------------------------------------
33011>>>>>// CALL_SQLSERVER_PROCEDURE <procedure name> PASSING <VALUE1|VARIABLE1> [SQLOUT] <VALUE2|VARIABLE2> [SQLOUT] ...
33011>>>>>//
33011>>>>>// Executes a stored procedure. SQLOUT will be used to indicate that the stored procedure
33011>>>>>// returns a parameter. The matching parameter in the stored proceudre must have been created with
33011>>>>>// the keyword OUTPUT. Call all procedures that doesn't returns any query with this syntax
33011>>>>>//
33011>>>>>//
33011>>>>>//
33011>>>>>//-----------------------------------------------------------------------------
33011>>>>>
33011>>>>>
33011>>>>>//=============================================================================
33011>>>>>// ORAFlex Commands
33011>>>>>//-----------------
33011>>>>>//----------------------------
33011>>>>>// ORAFlex_REVISION <VARIABLE>
33011>>>>>// Retrieves ORAFlex revision
33011>>>>>//
33011>>>>>//---------------------------------
33011>>>>>// KEEP_FILES_OPEN OF <SERVER NAME>
33011>>>>>// Keeps all files opened even during a LOGOUT
33011>>>>>//
33011>>>>>//-----------------------------------------------
33011>>>>>// SET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
33011>>>>>// Defines the maximum number of cursors that ORAFlex will be allowed for using
33011>>>>>//
33011>>>>>//-----------------------------------------------
33011>>>>>// GET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
33011>>>>>// Retrieves the maximum number of cursors allowed for ORAFlex use
33011>>>>>//
33011>>>>>//---------------------------------------------
33011>>>>>// GET_OPENED_CURSORS OF <SERVER NAME> TO <VAR>
33011>>>>>// Retrieves the number of opened cursors
33011>>>>>//
33011>>>>>//-----------------------------------------------
33011>>>>>// ACTIVATE_TIME_STAMP OF <SERVER NAME> TO ON|OFF
33011>>>>>// Activates Time stamp for date columns
33011>>>>>//
33011>>>>>//----------------------------------------------------------------------------------------------------
33011>>>>>// CALL_ORACLE_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
33011>>>>>// CALL_ORACLE_STORED_FUNCTION will call an Oracle stored function passing arguments
33011>>>>>//
33011>>>>>//-----------------------------------------------------------------------------
33011>>>>>
33011>>>>>//=============================================================================
33011>>>>>// BUFFER save stuffs
33011>>>>>//-------------------
33011>>>>>
33011>>>>>//-------------------------------------------------------
33011>>>>>// SQL_SAVE_BUFFER_BEGIN OF <FILE NUMBER> TO <CACHE SIZE>
33011>>>>>// Initialize the BUFFER buffer
33011>>>>>//
33011>>>>>//---------------------------------
33011>>>>>// SQL_SAVE_BUFFER OF <FILE NUMBER>
33011>>>>>// Moves field buffer values to cache buffer
33011>>>>>//-------------------------------------
33011>>>>>// SQL_SAVE_BUFFER_END OF <FILE NUMBER>
33011>>>>>// Save rows that remains in cache
33011>>>>>//-----------------------------------------------------------------------------
33011>>>>>
33011>>>
33011>>>//AB-StoreTopEnd
33011>>>
33011>>>//AB-IgnoreStart
33011>>>
33011>>>Use Panel.Sub
33011>>>Use Bitmap.Sub
33011>>>Use Txtbox.Sub
33011>>>Use Cmbfrm.Sub
33011>>>Use Form.Sub
33011>>>Use Chkbox.Sub
33011>>>Use Button.Sub
33011>>>
33011>>>
33011>>>//AB-IgnoreEnd
33011>>>
33011>>>Object Connect is a BasicPanelSub
33013>>>
33013>>>    //AB-StoreTopStart
33013>>>
33013>>>    //AB-StoreTopEnd
33013>>>
33013>>>    Set Sysmenu_Icon to FALSE
33014>>>    Set Minimize_Icon to FALSE
33015>>>    Set Label to "Login"
33016>>>    Set Size to 105 230
33017>>>    Set Location to 20 37
33018>>>
33018>>>    //AB-DDOStart
33018>>>
33018>>>
33018>>>    //AB-DDOEnd
33018>>>
33018>>>    Object BitmapContainer1 is a BitmapContainerSub
33020>>>        Set Size to 21 23
33021>>>        Set Location to 4 4
33022>>>        Set Bitmap to "Login1.bmp"
33023>>>        Set Border_Style to Border_None
33024>>>        Set Bitmap_Style to Bitmap_Center
33025>>>        Set Dialog_Caption to "Select a bitmap file"
33026>>>
33026>>>        //AB-StoreStart
33026>>>
33026>>>
33026>>>
33026>>>
33026>>>        //AB-StoreEnd
33026>>>
33026>>>    End_Object    // BitmapContainer1
33027>>>
33027>>>    Object Textbox5 is a TextBoxSub
33029>>>        Set Label to "Driver:"
33030>>>        Set FontSize to 4 0
33031>>>        Set Location to 6 34
33032>>>        Set Size to 13 40
33033>>>        Set TypeFace to "MS Sans Serif"
33034>>>        Set Enabled_State to TRUE
33035>>>    End_Object    // Textbox5
33036>>>
33036>>>    Object ComboForm2 is a ComboFormSub
33038>>>
33038>>>        //AB-StoreTopStart
33038>>>
33038>>>        Set CapsLock_State to True
33039>>>
33039>>>        //AB-StoreTopEnd
33039>>>
33039>>>        Set Size to 13 85
33040>>>        Set Location to 6 76
33041>>>        Set Label_Col_Offset to 2
33042>>>        Set Label_Justification_Mode to jMode_Right
33043>>>
33043>>>        //AB-StoreStart
33043>>>        Procedure Combo_Fill_List
33045>>>                Local String Availdrv## TempDrv##
33046>>>                Local Integer HowMany i p1## p2##
33046>>>
33046>>>                get_profile_string "WorkSpaces" "CurrentWorkspace" to AvailDrv##
33049>>>                If AvailDrv## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to AvailDrv##
33052>>>                insert "WorkSpaces\" in AvailDrv## at 1
33054>>>                get_profile_string AvailDrv## "AvailableDrivers" to AvailDrv##
33057>>>
33057>>>                Move Availdrv## to Tempdrv##
33058>>>                Repeat
33058>>>>
33058>>>                    Replace "|" in Tempdrv## With ""
33060>>>                    [Found] Increment HowMany
33061>>>                Until [Finderr]
33063>>>
33063>>>                Send Combo_add_Item ""
33064>>>
33064>>>                If HowMany lt 1 Begin
33066>>>                    If Availdrv## ne "" Send Combo_Add_Item (UpperCase(Availdrv##))
33069>>>                End
33069>>>>
33069>>>                Else Begin
33070>>>                    For i From 0 to HowMany
33076>>>>
33076>>>                        If i eq 0 Move 1 to p1##
33079>>>                        Else Begin
33080>>>                            Move ((Pos("|",Availdrv##))+1) to p1##
33081>>>                            Replace "|" in Availdrv## With ","
33083>>>                        End
33083>>>>
33083>>>                        Move ((Pos("|",Availdrv##))) to p2##
33084>>>                        Send Combo_Add_Item (UpperCase(Mid(Availdrv##,(p2##-p1##),p1##)))
33085>>>                    Loop
33086>>>>
33086>>>                End
33086>>>>
33086>>>        End_Procedure
33087>>>
33087>>>        Set Allow_Blank_state to True
33088>>>
33088>>>
33088>>>
33088>>>        //AB-StoreEnd
33088>>>
33088>>>    End_Object    // ComboForm2
33089>>>
33089>>>    Object Textbox6 is a TextBoxSub
33091>>>        Set Label to "Server:"
33092>>>        Set FontSize to 4 0
33093>>>        Set Location to 22 34
33094>>>        Set Size to 13 40
33095>>>        Set TypeFace to "MS Sans Serif"
33096>>>        Set Enabled_State to TRUE
33097>>>    End_Object    // Textbox6
33098>>>
33098>>>    Object Form4 is a FormSub
33100>>>        Set Size to 13 93
33101>>>        Set Location to 22 76
33102>>>        Set Label_Col_Offset to 2
33103>>>        Set Label_Justification_Mode to jMode_Right
33104>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33105>>>    End_Object    // Form4
33106>>>
33106>>>    Object Textbox7 is a TextBoxSub
33108>>>        Set Label to "User Name:"
33109>>>        Set FontSize to 4 0
33110>>>        Set Location to 38 34
33111>>>        Set Size to 13 40
33112>>>        Set TypeFace to "MS Sans Serif"
33113>>>        Set Enabled_State to TRUE
33114>>>    End_Object    // Textbox7
33115>>>
33115>>>    Object Form5 is a FormSub
33117>>>        Set Size to 13 93
33118>>>        Set Location to 38 76
33119>>>        Set Label_Col_Offset to 2
33120>>>        Set Label_Justification_Mode to jMode_Right
33121>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33122>>>    End_Object    // Form5
33123>>>
33123>>>    Object Textbox8 is a TextBoxSub
33125>>>        Set Label to "Password:"
33126>>>        Set FontSize to 4 0
33127>>>        Set Location to 54 34
33128>>>        Set Size to 13 40
33129>>>        Set TypeFace to "MS Sans Serif"
33130>>>        Set Enabled_State to TRUE
33131>>>    End_Object    // Textbox8
33132>>>
33132>>>    Object Form6 is a FormSub
33134>>>        Set Size to 13 93
33135>>>        Set Location to 54 76
33136>>>        Set Label_Col_Offset to 2
33137>>>        Set Label_Justification_Mode to jMode_Right
33138>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33139>>>
33139>>>        //AB-StoreStart
33139>>>        Set Password_State Item 0 to True
33140>>>
33140>>>        //AB-StoreEnd
33140>>>
33140>>>    End_Object    // Form6
33141>>>
33141>>>    Object CheckBox1 is a CheckBoxSub
33143>>>        Set Label to "Save Password"
33144>>>        Set Size to 10 66
33145>>>        Set Location to 73 76
33146>>>        Set Status_Help to "Remember The Password at Next Login"
33147>>>    End_Object    // CheckBox1
33148>>>
33148>>>    Object oOK_bn is a ButtonSub
33150>>>        Set Label to "Co&nnect"
33151>>>        Set Default_State to TRUE
33152>>>        Set Bitmap to "mcr.bmp"
33153>>>        Set Size to 28 33
33154>>>        Set Location to 9 184
33155>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33156>>>
33156>>>        //AB-StoreStart
33156>>>        Procedure OnClick
33158>>>            Set LoginOk to True
33159>>>            Send Stop_Modal_ui
33160>>>        End_Procedure
33161>>>        Set Status_Help to "Connect"
33162>>>        //AB-StoreEnd
33162>>>
33162>>>    End_Object    // oOK_bn
33163>>>
33163>>>    Object oCancel_bn is a ButtonSub
33165>>>        Set Label to "&Cancel"
33166>>>        Set Bitmap to "exit2.bmp"
33167>>>        Set Size to 28 32
33168>>>        Set Location to 39 184
33169>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33170>>>
33170>>>        //AB-StoreStart
33170>>>
33170>>>        ON_KEY KENTER SEND Exit_Application to (Connect(Current_Object))
33171>>>
33171>>>        Procedure OnClick
33173>>>            Set LoginOk to False
33174>>>            Send Exit_Application to (Connect(Current_Object))
33175>>>        End_Procedure
33176>>>
33176>>>        Set Status_Help to "Close Application"
33177>>>
33177>>>
33177>>>        //AB-StoreEnd
33177>>>
33177>>>    End_Object    // oCancel_bn
33178>>>
33178>>>
33178>>>    //AB-StoreStart
33178>>>
33178>>>    Set Modal_State to True
33179>>>
33179>>>    // Now is WorkspaceAware
33179>>>
33179>>>    ON_KEY KENTER SEND OnClick to (oOk_bn(Current_Object))
33180>>>    ON_KEY KSAVE_RECORD SEND OK
33181>>>    ON_KEY KCANCEL SEND EXIT_APPLICATION
33182>>>    ON_KEY KCLOSE_PANEL SEND EXIT_APPLICATION
33183>>>
33183>>>    Set Locate_Mode to Center_On_Screen
33184>>>    Set Exit_Application_Local_State to False
33185>>>    Set Exit_MSG to Exit
33186>>>    Set Description_State to True
33187>>>
33187>>>    Property Integer LoginOk public false
33189>>>
33189>>>    External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;        Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
33190>>>
33190>>>    Function Network_User_Name Returns String
33192>>>        Local String sName sLength
33193>>>        Local Pointer lpName_Addr lpLength_Addr
33193>>>        Local Integer iRetval
33193>>>
33193>>>        Movestr (Repeat (Character (0), 255)) To sName
33194>>>>
33194>>>        GetAddress Of sName To lpName_Addr
33195>>>        Movestr (DwordToBytes (255)) To sLength
33196>>>>
33196>>>        GetAddress Of sLength To lpLength_Addr
33197>>>
33197>>>        Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
33198>>>>
33198>>>
33198>>>        If iRetval Eq 0 Function_Return (CString (sName))
33201>>>        Else Function_Return "User Unknown"
33203>>>    End_Function // Network_User_Name
33204>>>
33204>>>    Function fsCrypto String lsWay String lsOld Returns String
33206>>>        Local String lsNew lsTemp
33207>>>        Local Integer liCount
33207>>>           For liCount From 1 to (Length(lsOld))
33213>>>>
33213>>>               Mid lsOld to lsTemp 1 liCount
33216>>>>
33216>>>               If ((Uppercase(lsWay)) eq 'FORWARD') Begin
33218>>>               If ((Ascii(lsTemp) = 255)) Move (Character(32)) to lsTemp
33221>>>               Else Move (Character(Ascii(lsTemp)+1)) to lsTemp
33223>>>               End
33223>>>>
33223>>>               Else Begin
33224>>>                   If ((Uppercase(lsWay)) eq 'BACKWARD') Begin
33226>>>                       If ((Ascii(lsTemp) = 32)) Move (Character(255)) to lsTemp
33229>>>                       Else Move (Character(Ascii(lsTemp)-1)) to lsTemp
33231>>>                   End
33231>>>>
33231>>>               End
33231>>>>
33231>>>               Append lsNew lsTemp
33232>>>           Loop
33233>>>>
33233>>>        Function_Return (lsNew)
33234>>>    End_Function
33235>>>
33235>>>    Procedure Activating
33237>>>        Local String LoginDriver## LoginServer## LoginUserid## LoginPassword##
33238>>>        Local String LastLogin## LoginSeq##
33238>>>        Local Integer SavePassword##
33238>>>
33238>>>        Forward Send Activating
33240>>>
33240>>>        get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
33243>>>        If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
33246>>>        insert "WorkSpaces\" in LastLogin## at 1
33248>>>        Append LastLogin## "\" (Module_Name(Self)) "\LastLogin"
33251>>>        get_profile_string LastLogin## "LoginDriver" to LoginSeq##
33254>>>
33254>>>        If "|" in LoginSeq## move (left(LoginSeq##,(pos("|",LoginSeq##) -1))) to LoginDriver##
33257>>>        Else Move LoginSeq## to LoginDriver##
33259>>>        get_profile_string LastLogin## "LoginServer"  to LoginServer##
33262>>>        get_profile_string LastLogin## "LoginUserId"  to LoginUserId##
33265>>>        get_profile_string LastLogin## "SavePassword" to SavePassword##
33268>>>        If LoginUserId## eq "" Move (Network_User_Name(Current_Object)) to LoginUserId##
33271>>>
33271>>>        If (((UpperCase(LoginDriver##)) eq "DATAFLEX") or (LoginDriver## eq "")) Begin
33273>>>                Set Value of (ComboForm2(Current_Object)) Item 0 to ""
33274>>>                Set Value of (Form4(Current_Object))      Item 0 to ""
33275>>>        End
33275>>>>
33275>>>        Else Begin
33276>>>            Set Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
33277>>>            Set Value of (Form4(Current_Object))      Item 0 to LoginServer##
33278>>>        End
33278>>>>
33278>>>        Set Value of (Form5(Current_Object))      Item 0 to LoginUserID##
33279>>>        Set Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
33280>>>        If (SavePassword##) Begin
33282>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33283>>>            get_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to LoginPassword##
33287>>>            Set Value of (Form6(Current_Object))      Item 0 to (fsCrypto(Self,"backward",LoginPassword##))
33288>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33289>>>        End
33289>>>>
33289>>>    End_Procedure
33290>>>
33290>>>    Function LoginUser Returns Integer
33292>>>        Integer SavePassword## Size## PasswordOk
33293>>>        String LoginDriver## LoginServer## LoginUserid## LoginPassword## LoginSeq## LastLogin##
33293>>>        String lsLoginDate lsHH lsMM lsSS sDepartment
33293>>>        Integer liOpenCursors
33293>>>
33293>>>        Send Popup_Modal
33294>>>
33294>>>        Get Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
33295>>>        Get Value of (Form4(Current_Object))      Item 0 to LoginServer##
33296>>>        Get Value of (Form5(Current_Object))      Item 0 to LoginUserID##
33297>>>        Get Value of (Form6(Current_Object))      Item 0 to LoginPassword##
33298>>>        Get Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
33299>>>        Set Value of (Form6(Current_Object))      Item 0 to ""
33300>>>
33300>>>    //tolis 03/02/2004
33300>>>        If ((LoginDriver## <> "") and (UpperCase(LoginDriver##)<>"DATAFLEX"))  begin
33302>>>    //        send ignore_error to (error_info_object(current_object)) 25000
33302>>>    //        send ignore_error to (error_info_object(current_object)) 4255
33302>>>    //        send ignore_error to (error_info_object(current_object)) 12293
33302>>>    //        login LoginServer## LoginUserId## LoginPassword## LoginDriver##
33302>>>    //        send trap_error to (error_info_object(current_object)) 25000
33302>>>    //        send trap_error to (error_info_object(current_object)) 4255
33302>>>    //        send trap_error to (error_info_object(current_object)) 12293
33302>>>    //        If LastErr eq 25000 Begin
33302>>>    //            Error LastErr "Invalid Login Information"
33302>>>    //            Set LoginOk to False
33302>>>    //            Send Exit_Application
33302>>>    //        End
33302>>>    //        If LastErr eq 4255 Begin
33302>>>    //            Error LastErr "Invalid Driver Name"
33302>>>    //            Set LoginOk to False
33302>>>    //            Send Exit_Application
33302>>>    //        End
33302>>>    //        If LastErr eq 12293 Begin
33302>>>    //            Error LastErr "(IBM CLI)Database alias name or Database name not found"
33302>>>    //            Set LoginOk to False
33302>>>    //           Send Exit_Application
33302>>>    //      End
33302>>>            Set LoginOk to True
33303>>>    //        If (UpperCase(LoginDriver##) = "ORA_DRV") Begin
33303>>>    //            GET_MAX_OPEN_CURSORS of LoginServer## to liOpenCursors
33303>>>    //            If (liOpenCursors <> 0) SET_MAX_OPEN_CURSORS of LoginServer## to (liOpenCursors+2)
33303>>>    //        End
33303>>>        End
33303>>>>
33303>>>        Else Begin
33304>>>            Set LoginOk to True
33305>>>            Open "Users" as Users
INCLUDING FILE: USERS.FD
33307>>>            Move "DATAFLEX" To LoginDriver##
33308>>>            Move "" to LoginServer##
33309>>>            File_Size Users to Size##
33312>>>            If Size## ne 0 Begin
33314>>>                 Clear Users
33315>>>                 Move LoginUSerId##   to Users.Login_Id
33316>>>                 Find eq Users by Index.1
33317>>>>
33317>>>                 [Finderr] Begin
33319>>>>
33319>>>                    Error 25000 "Unknown User"
33320>>>>
33320>>>                    Set LoginOk to False
33321>>>                    Get LoginOk to PasswordOk
33322>>>                    Function_Return PasswordOk
33323>>>                 End
33323>>>>
33323>>>                 [Found] Begin
33325>>>>
33325>>>                    If (LoginPassword## ne Users.Password) Begin
33327>>>                        Error 25000 "Invalid Password"
33328>>>>
33328>>>                        Set LoginOk to False
33329>>>                        Get LoginOk to PasswordOk
33330>>>                        Function_Return PasswordOk
33331>>>                    End
33331>>>>
33331>>>                    Else Move Users.Departm_Code to sDepartment
33333>>>                    Move (Trim(sDepartment)) to sDepartment
33334>>>                 End
33334>>>>
33334>>>            End
33334>>>>
33334>>>            Close Users
33335>>>
33335>>>
33335>>>    //            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33335>>>    //            Integer bFileExists
33335>>>    //            Get Get_File_Exists  "C:\AutLogIn.txt" To bFileExists
33335>>>    //            If (NOT(bFileExists)) Begin
33335>>>
33335>>>    //                Get Get_File_Exists  "C:\UsrLogin.txt" To bFileExists
33335>>>    //                If (bFileExists) Begin
33335>>>
33335>>>    ////                        If Size## ne 0 Begin
33335>>>
33335>>>    //                            Local String ss1 ss2 ss3 ss4
33335>>>    //                            Local String dd1 dd2 dd3 dd4
33335>>>    //                            Move '' to dd1
33335>>>    //                            Move '' to dd2
33335>>>    //                            Move '' to dd3
33335>>>    //                            Move '' to dd4
33335>>>
33335>>>    //                            Direct_Input Channel 8 "C:\UsrLogin.txt"
33335>>>    //                            Readln Channel 8 ss1 ss2 ss3 ss4
33335>>>    //                            While (Not(Seqeof))
33335>>>    //                                Move (Trim(ss1)) to ss1
33335>>>    //                                Move (Trim(ss2)) to ss2
33335>>>    //                                Move (Trim(ss3)) to ss3
33335>>>    //                                Move (Trim(ss4)) to ss4
33335>>>    //                                Append dd1 '"' ss1 '"'
33335>>>    //                                Append dd2 '"' ss2 '"'
33335>>>    //                                Append dd3 '"' ss3 '"'
33335>>>    //                                Append dd4 '"' ss4 '"'
33335>>>    //                                Login dd1 dd2 dd3 dd4
33335>>>    //                                Readln Channel 8 ss1 ss2 ss3 ss4
33335>>>    //                            Loop
33335>>>
33335>>>
33335>>>    ////                            // Only Filmnet Users Log on to SQL
33335>>>    ////                            If (sDepartment='FILMNET') Begin
33335>>>    ////                                ////// 20/06/2001 js Allagh apo Oracle se SQL server
33335>>>    ////                                ////// login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33335>>>    ////                                login '192.168.128.5'   'sa'    ''   'SQL_DRV'
33335>>>    ////                                login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33335>>>    ////                            End
33335>>>    ////                            Else login '192.168.128.5'      'sa'    ''   'SQL_DRV'
33335>>>    ////                            //Else login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33335>>>
33335>>>    ////                        End
33335>>>    ////                        Else Begin
33335>>>    ////                            ////// 20/06/2001 js Allagh apo Oracle se SQL server
33335>>>    ////                            ///// login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33335>>>    ////                            login '192.168.128.5'       'sa'    ''   'SQL_DRV'
33335>>>    ////                            //login '192.168.128.5'   'EPGDNS'    'DNS'   'SQL_DRV'
33335>>>    ////                            login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33335>>>    ////                        End
33335>>>
33335>>>
33335>>>    //                End
33335>>>
33335>>>    //            End
33335>>>    //            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33335>>>
33335>>>
33335>>>
33335>>>            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33335>>>            //*Integer bFileExists
33335>>>            //*Get Get_File_Exists  "C:\AutLogIn.txt" To bFileExists
33335>>>            //*If (NOT(bFileExists)) Begin
33335>>>            //*    If Size## ne 0 Begin
33335>>>            //*        // Only Filmnet Users Log on to SQL
33335>>>            //*        If (sDepartment='FILMNET') Begin
33335>>>            //*            login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33335>>>            //*            login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33335>>>            //*        End
33335>>>            //*        Else login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33335>>>            //*    End
33335>>>            //*    Else Begin
33335>>>            //*        login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33335>>>            //*        login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33335>>>            //*    End
33335>>>            //*
33335>>>            //*End
33335>>>            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33335>>>
33335>>>
33335>>>
33335>>>        End
33335>>>>
33335>>>
33335>>>        Open Users
33337>>>        //Open "Users" as Users
33337>>>        File_Size Users to Size##
33340>>>        If Size## ne 0 Begin
33342>>>             Clear Users
33343>>>             Move LoginUSerId##   to Users.Login_Id
33344>>>             Find eq Users by Index.1
33345>>>>
33345>>>             [Finderr] Begin
33347>>>>
33347>>>                Error 25000 "Unknown User"
33348>>>>
33348>>>                Set LoginOk to False
33349>>>                Get LoginOk to PasswordOk
33350>>>                Function_Return PasswordOk
33351>>>             End
33351>>>>
33351>>>             [Found] Begin
33353>>>>
33353>>>                If (LoginPassword## ne Users.Password) Begin
33355>>>                    Error 25000 "Invalid Password"
33356>>>>
33356>>>                    Set LoginOk to False
33357>>>                    Get LoginOk to PasswordOk
33358>>>                    Function_Return PasswordOk
33359>>>                End
33359>>>>
33359>>>                Else Move Users.Departm_Code to sDepartment
33361>>>                Move (Trim(sDepartment)) to sDepartment
33362>>>             End
33362>>>>
33362>>>        End
33362>>>>
33362>>>        Close Users
33363>>>
33363>>>        Get LoginOk to PasswordOk
33364>>>        Sysdate lsLoginDate lsHH lsMM lsSS
33368>>>        get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
33371>>>        If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
33374>>>        insert "WorkSpaces\" in LastLogin## at 1
33376>>>        get_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
33379>>>        If ((LoginDriver## ne "") and ((UpperCase(LoginDriver##)) ne "DATAFLEX")) Begin
33381>>>           If Not LoginDriver## in LoginSeq## Begin
33383>>>                 If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
33386>>>                 Else Move (LoginSeq##+"|"+LoginDriver##) to LoginSeq##
33388>>>                 set_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
33391>>>           End
33391>>>>
33391>>>        End
33391>>>>
33391>>>        Append LastLogin## "\" (Module_Name(Self))
33393>>>        Append LastLogin## "\LastLogin"
33394>>>        get_profile_string LastLogin## "LoginDriver" to LoginSeq##
33397>>>
33397>>>        If "|" in LoginSeq## Begin
33399>>>            If ((left(LoginSeq##,(pos("|",LoginSeq##) -1))) ne LoginDriver##) Insert (LoginDriver##+"|") in LoginSeq## at 1
33403>>>        End
33403>>>>
33403>>>        Else Begin
33404>>>            If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
33407>>>            Else If LoginSeq## ne LoginDriver## Insert (LoginDriver##+"|") in LoginSeq## at 1
33412>>>        End
33412>>>>
33412>>>        Left LoginSeq## to LoginSeq## 250
33414>>>>
33414>>>        set_profile_string LastLogin## "LoginDriver" to (UpperCase(LoginSeq##))
33417>>>        set_profile_string LastLogin## "LoginServer" to LoginServer##
33420>>>        set_profile_string LastLogin## "LoginUserId" to LoginUserId##
33423>>>        set_profile_string LastLogin## "SavePassword" to SavePassword##
33426>>>        If lsHH lt 10 Insert 0 in lsHH at 1
33430>>>        If lsMM lt 10 Insert 0 in lsMM at 1
33434>>>        If lsSS lt 10 Insert 0 in lsSS at 1
33438>>>        Append lsLoginDate " - " lsHH ":" lsMM ":" lsSS
33444>>>        set_profile_string LastLogin## "LoginTime" to lsLoginDate
33447>>>        If (SavePassword##) Begin
33449>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33450>>>            set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to (fsCrypto(Self,"forward",LoginPassword##))
33453>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33454>>>        End
33454>>>>
33454>>>        Else Begin
33455>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33456>>>            set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to ""
33459>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33460>>>        End
33460>>>>
33460>>>
33460>>>        Function_Return PasswordOk
33461>>>    End_Function
33462>>>
33462>>>    Procedure Login For Desktop
33463>>>        Local Integer LoginPassword##
33464>>>        Get LoginUser of (Connect(Current_Object)) to LoginPassword##
33465>>>        If Not LoginPassword## Send Exit_Application
33468>>>    End_Procedure
33469>>>
33469>>>    Function CheckLogin For Desktop Returns Integer
33470>>>        Local Integer LoginPassword##
33471>>>        Get LoginUser of (Connect(Current_Object)) to LoginPassword##
33472>>>        Function_Return LoginPassword##
33473>>>    End_Function
33474>>>
33474>>>
33474>>>
33474>>>
33474>>>
33474>>>
33474>>>    //AB-StoreEnd
33474>>>
33474>>>End_Object    // Connect
33475>>>
33475>>>
33475>>>//AB-StoreStart
33475>>>
33475>>>
33475>>>
33475>>>//AB-StoreEnd
33475>>>
33475>>>//AB/ End_Object    // prj
33475>use checkafm.pkg
INCLUDING FILE: CHECKAFM.PKG
33475>>>
33475>>>
33475>>>Function Check_Afm Global String Afm_Num Returns Integer
33476>>>    Integer iii Num1 Num2
33477>>>
33477>>>    Move (Trim(Afm_Num)) To Afm_Num
33478>>>
33478>>>    For iii From 1 To (Length(Trim(Afm_Num)))
33484>>>>
33484>>>        If Not (Mid(Afm_Num,1,iii)) In  "0123456789" Function_Return 3
33487>>>    Loop
33488>>>>
33488>>>
33488>>>    Move (Right(Afm_Num,1)) to Num2
33489>>>
33489>>>    If (Length(Afm_Num)<>9) Function_Return 2
33492>>>
33492>>>    Move 0 to Num1
33493>>>
33493>>>    For iii From 1 to 8
33499>>>>
33499>>>        Add ((Mid(Afm_Num,1,iii)) * (2 ^ (9 - iii))) to Num1
33500>>>    Loop
33501>>>>
33501>>>
33501>>>    Move (Mod(Num1,11)) to Num1
33502>>>    If (Num1=10) Move 0 to Num1
33505>>>
33505>>>    If (Num1=Num2)  Function_Return 0
33508>>>    Else            Function_Return 1
33510>>>End_Function
33511>>>
33511>use checklog.pkg
INCLUDING FILE: CHECKLOG.PKG
33511>>>open syscurgl
INCLUDING FILE: SYSCURGL.FD
33513>>>open syscurxr
33515>>>open gplan
INCLUDING FILE: GPLAN.FD
33517>>>//open gplanl
33517>>>open iteml
INCLUDING FILE: ITEML.FD
33519>>>open cn
INCLUDING FILE: CN.FD
33521>>>open payresp
INCLUDING FILE: PAYRESP.FD
33523>>>open salesmen
INCLUDING FILE: SALESMEN.FD
33525>>>open mhxanik
INCLUDING FILE: MHXANIK.FD
33527>>>open constrct
INCLUDING FILE: CONSTRCT.FD
33529>>>open clients
INCLUDING FILE: CLIENTS.FD
33531>>>open wtypkin
INCLUDING FILE: WTYPKIN.FD
33533>>>open wax
INCLUDING FILE: WAX.FD
33535>>>Function Check_log Global String slog Returns Integer
33536>>>    clear gplan
33537>>>    move syscurxr.company_code to gplan.company_code
33538>>>    move syscurxr.branch_code  to gplan.branch_code
33539>>>    move syscurxr.year_year    to gplan.year_year
33540>>>    move slog                  to gplan.gplan_code
33541>>>    find eq gplan by index.1
33542>>>>
33542>>>    if (found=1) function_return 0
33545>>>    else         function_return 1
33547>>>
33547>>>End_Function
33548>>>
33548>>>Function Check_last Global String slog Returns Integer
33549>>>    clear gplan
33550>>>    move syscurxr.company_code to gplan.company_code
33551>>>    move syscurxr.branch_code  to gplan.branch_code
33552>>>    move syscurxr.year_year    to gplan.year_year
33553>>>    move slog                  to gplan.gplan_code
33554>>>    find eq gplan by index.1
33555>>>>
33555>>>    if ((found=1) and (Gplan.Gplan_Yn_Last = 1)) Function_Return 0
33558>>>    else                                         Function_return 1
33560>>>
33560>>>End_Function
33561>>>
33561>>>Function fsgplandescr String slog Returns string
33562>>>    clear gplan
33563>>>    move syscurgl.company_code to gplan.company_code
33564>>>    move syscurgl.branch_code  to gplan.branch_code
33565>>>    move syscurgl.year_year    to gplan.year_year
33566>>>    move slog                  to gplan.gplan_code
33567>>>    find eq gplan by index.1
33568>>>>
33568>>>    if (found=1) function_return gplan.gplan_descr1
33571>>>    else         function_return ''
33573>>>
33573>>>End_Function
33574>>>
33574>>>//Function fsgplanperi String slog Returns string
33574>>>//    string sdescr
33574>>>//    clear gplanl
33574>>>//    move syscurgl.company_code to  gplanl.company_code
33574>>>//    move syscurgl.branch_code  to  gplanl.branch_code
33574>>>//    move slog                  to  gplanl.gplan_code
33574>>>//    find eq gplanl by index.1
33574>>>//    if (found=1) begin
33574>>>//        move gplanl.gplan_descr1 to sdescr
33574>>>//        function_return sdescr
33574>>>//    end
33574>>>//    else         function_return ''
33574>>>//End_Function
33574>>>
33574>>>
33574>>>
33574>>>Function fsclient string code Returns string
33575>>>    string name
33576>>>    clear clients
33577>>>    move code to clients.client_id
33578>>>    find eq clients by index.6
33579>>>>
33579>>>    if (found) move clients.client_name to name
33582>>>    else       move '' to name
33584>>>    function_return name
33585>>>end_Function
33586>>>
33586>>>Function fspayresp string code Returns string
33587>>>    string name
33588>>>    clear payresp
33589>>>    move code to payresp.presp_id
33590>>>    find eq payresp by index.7
33591>>>>
33591>>>    if (found) move payresp.presp_name to name
33594>>>    else       move '' to name
33596>>>    function_return name
33597>>>end_Function
33598>>>
33598>>>Function fssalesmen string code Returns string
33599>>>    string name
33600>>>    clear salesmen
33601>>>    move code to salesmen.sls_id
33602>>>    find eq salesmen by index.4
33603>>>>
33603>>>    if (found) move salesmen.sls_name to name
33606>>>    else       move '' to name
33608>>>    function_return name
33609>>>end_Function
33610>>>
33610>>>Function fsconstrct string code Returns string
33611>>>    string name
33612>>>    clear constrct
33613>>>    move code to constrct.cnt_id
33614>>>    find eq constrct by index.5
33615>>>>
33615>>>    if (found) move constrct.cnt_name to name
33618>>>    else       move '' to name
33620>>>    function_return name
33621>>>end_Function
33622>>>
33622>>>Function fsmhxanik string code Returns string
33623>>>    string name
33624>>>    clear mhxanik
33625>>>    move code to mhxanik.mhx_id
33626>>>    find eq mhxanik by index.4
33627>>>>
33627>>>    if (found) move mhxanik.mhx_name to name
33630>>>    else       move '' to name
33632>>>    function_return name
33633>>>end_Function
33634>>>
33634>>>
33634>>>Function fsptyppar string code Returns string
33635>>>    string sdescr
33636>>>    clear ptypparl
INCLUDING FILE: PTYPPARL.FD
33637>>>    move syscurxr.company_code to ptypparl.company_code
33638>>>    move syscurxr.branch_code  to ptypparl.branch_code
33639>>> //   move syscurxr.year_year    to ptypparl.year_year
33639>>>    move code                  to ptypparl.ptyppar_code
33640>>>    find eq ptypparl by index.1
33641>>>>
33641>>>    move ptypparl.ptyppar_descr to sdescr
33642>>>    function_return sdescr
33643>>>end_Function
33644>>>
33644>>>Function fsgplan string code Returns string
33645>>>    string sdescr
33646>>>    clear gplan
33647>>>    move syscurxr.company_code to gplan.company_code
33648>>>    move syscurxr.branch_code  to gplan.branch_code
33649>>>    move syscurxr.year_year    to gplan.year_year
33650>>>    move code                  to gplan.gplan_code
33651>>>    find eq gplan by index.1
33652>>>>
33652>>>    move gplan.gplan_descr1    to sdescr
33653>>>    function_return sdescr
33654>>>end_Function
33655>>>
33655>>>Function fsitem string scode Returns string
33656>>>    clear iteml
33657>>>    move scode to iteml.item_code
33658>>>    find eq iteml by index.5
33659>>>>
33659>>>    function_return iteml.item_descr
33660>>>end_Function
33661>>>
33661>>>Function fswax string srecr Returns string
33662>>>    clear wax
33663>>>    move srecr to wax.wax_recr
33664>>>    find eq wax by index.2
33665>>>>
33665>>>    function_return wax.wax_descr
33666>>>end_Function
33667>>>
33667>>>
33667>>>Function fswitemx string code Returns string
33668>>>    string name
33669>>>    clear witemx
INCLUDING FILE: WITEMX.FD
33670>>>    move syscurxr.company_code to witemx.company_code
33671>>>    move syscurxr.branch_code  to witemx.branch_code
33672>>>    move syscurxr.year_year    to witemx.year_year
33673>>>    move code to witemx.witemx_code
33674>>>    find eq witemx by index.5
33675>>>>
33675>>>    move witemx.witemx_descr to name
33676>>>    function_return name
33677>>>end_Function
33678>>>
33678>>>Function fsCNDescr String asItem Returns String
33679>>>    Clear CN
33680>>>    move asItem to CN.CN_Code
33681>>>    Find Eq CN by Index.5
33682>>>>
33682>>>    Function_Return CN.CN_Descr
33683>>>End_Function
33684>>>
33684>>>Function fswtypkin String askin Returns String
33685>>>    Clear Wtypkin
33686>>>    move askin to Wtypkin.wtypkin_code
33687>>>    Find Eq wtypkin by Index.1
33688>>>>
33688>>>    Function_Return Wtypkin.wtypkin_descr
33689>>>End_Function
33690>>>
33690>>>Function FindGtypkinDescr Integer aiCode Returns String
33691>>>    String lsDescr
33692>>>    Clear Gtypkin
INCLUDING FILE: GTYPKIN.FD
33693>>>    Move syscurxr.company_code    to Gtypkin.Company_Code
33694>>>    Move syscurxr.Branch_Code     to Gtypkin.Branch_Code
33695>>>    Move syscurxr.Year_year       to Gtypkin.Year_Year
33696>>>    Move aiCode                   to Gtypkin.Gtypkin_Code
33697>>>    Find eq Gtypkin by Index.1
33698>>>>
33698>>>    [Found] Move Gtypkin.Gtypkin_Descr to lsDescr
33699>>>    Function_Return lsDescr
33700>>>End_Function // FindGtypkinDescr
33701>>>
33701>>>Function FindBtypkinDescr Integer aiCode Returns String
33702>>>    String lsDescr
33703>>>    Clear Btypkin
INCLUDING FILE: BTYPKIN.FD
33704>>>    Move syscurxr.company_code    to Btypkin.Company_Code
33705>>>    Move syscurxr.Branch_Code     to Btypkin.Branch_Code
33706>>>    Move syscurxr.Year_year       to Btypkin.Year_Year
33707>>>    Move aiCode                   to Btypkin.btypkin_Code
33708>>>    Find eq Btypkin by Index.1
33709>>>>
33709>>>    [Found] Move Btypkin.Btypkin_Descr to lsDescr
33710>>>    Function_Return lsDescr
33711>>>End_Function // FindGtypkinDescr
33712>>>
33712>>>
33712>Send Login
33713>Use TranLock
INCLUDING FILE: TRANLOCK.PKG
33713>>>// Statement of purpose:
33713>>>// When using a reread command in VDF you will unfortunately lock many more
33713>>>// files than are necessary.  In order to only lock the files necessary I
33713>>>// use the following procedure to set all files to readonly, manually set
33713>>>// the files being worked on to (default) and then reset all back at the end.
33713>>>// This is what a data dictionary does in a VDF program for it's ddo tree.
33713>>>
33713>>>// The original package is a contribution of another programmer whom I cannot
33713>>>// remember their name (sorry).  The alteration I have done is to make sure that any file
33713>>>// with a non-default filemode will be set back to it's previous setting.
33713>>>
33713>>>Object FileModeArray Is An Array
33715>>>    // 0 = File Number
33715>>>    // 1 = Non-Default FileMode Existing Before Change By ChangeAllFileModes Procedure
33715>>>End_Object
33716>>>
33716>>>Procedure Write_Attribute_Array Integer iFile Integer iFileMode
33717>>>    Integer iCounter hArray iExists
33718>>>    Move (FileModeArray(Self)) To hArray
33719>>>    For iCounter From 0 To 1000
33725>>>>
33725>>>        Get Array_Value Of hArray Item ((iCounter * 2) + 0) To iExists
33726>>>        If (Not(iExists) Or (iExists = iFile)) Begin
33728>>>            Set Array_Value Of hArray Item ((iCounter * 2) + 0) To iFile
33729>>>            Set Array_Value Of hArray Item ((iCounter * 2) + 1) To iFileMode
33730>>>        End
33730>>>>
33730>>>        If (Not(iExists) Or (iExists = iFile)) Break
33733>>>    Loop
33734>>>>
33734>>>End_Procedure
33735>>>
33735>>>Procedure Clear_FileModeArray
33736>>>    Send Delete_Data To (FileModeArray(Self))
33737>>>End_Procedure
33738>>>
33738>>>Function Is_NonStandardFileMode Integer iFile Returns Integer
33739>>>    Integer iCounter iExists iNonStandardFileMode hArray
33740>>>    Move (FileModeArray(Self)) To hArray
33741>>>    For iCounter From 0 To 1000
33747>>>>
33747>>>        Get Array_Value Of hArray Item ((iCounter * 2) + 0) To iExists
33748>>>        If (Not(iExists)) Function_Return 0 // Not Listed In Array
33751>>>        If (iExists = iFile) Begin
33753>>>            Get Array_Value Of hArray Item ((iCounter * 2) + 1) To iNonStandardFileMode
33754>>>            Function_Return iNonStandardFileMode
33755>>>        End
33755>>>>
33755>>>    Loop
33756>>>>
33756>>>    Function_Return
33757>>>End_Function
33758>>>
33758>>>Procedure ChangeAllFileModes Integer iMode
33759>>>    Integer iFile iExistingFileMode iNonStandardFileMode
33760>>>    If (iMode = DF_FileMode_ReadOnly) Send Clear_FileModeArray
33763>>>    Repeat
33763>>>>
33763>>>        // Get Each Opened File, One At A Time...
33763>>>        Get_Attribute DF_File_Next_Opened Of iFile To iFile
33766>>>        If (Not(iFile)) Break
33769>>>        If (iMode = DF_Filemode_ReadOnly) Begin  // Setting All Files To Readonly: Check Alias Stuff
33771>>>            Get_Attribute DF_File_Mode Of iFile To iExistingFileMode
33774>>>            If (iExistingFileMode <> DF_Filemode_Default) Send Write_Attribute_Array iFile iExistingFileMode
33777>>>        End
33777>>>>
33777>>>        If (iMode = DF_Filemode_Default) Begin  // Setting All Files Back To Default
33779>>>            Get Is_NonStandardFileMode iFile To iNonStandardFileMode
33780>>>        End
33780>>>>
33780>>>        If (iNonStandardFileMode) Set_Attribute DF_File_Mode Of iFile To iNonStandardFileMode
33785>>>        Else                      Set_Attribute DF_File_Mode Of iFile To iMode
33789>>>    Loop
33790>>>>
33790>>>End_Procedure
33791>>>
33791>>>// // Comment: Example Of Usage:
33791>>>//    Send ChangeAllFileModes DF_Filemode_ReadOnly  // See Stark.Pkg for This Desktop Procedure
33791>>>// // Comment: Set All Open Files To ReadOnly Except For... (Files Used In Transaction Block)
33791>>>//    Set_Attribute DF_File_Mode Of MyFile1.File_Number To DF_Filemode_Default
33791>>>//    Set_Attribute DF_File_Mode Of MyFile2.File_Number  To DF_Filemode_Default
33791>>>//    Indicate Err False
33791>>>//    Begin_Transaction
33791>>>//
33791>>>//        Clear MyFile1
33791>>>//        Move 1 To MyFile1.Key
33791>>>//        Find EQ MyFile1 By Index.1
33791>>>//        Relate MyFile1
33791>>>//        Add MyFile2.Amount To MyFile1.Amount
33791>>>//        Saverecord MyFile1
33791>>>//        Saverecord MyFile2
33791>>>//        If (Condition) Error 300 "Error Message Here" // Saves Rolled Back
33791>>>//
33791>>>//    End_Transaction
33791>>>//    If (Err) Begin
33791>>>//        Send Info_Box "Errors Were Encountered: No Files Were Altered By This Process (All Changes Rolled Back)"
33791>>>//    End
33791>>>//    Send ChangeAllFileModes DF_Filemode_Default  // Set FileModes Back From Readonly To Normal
INCLUDING FILE: XRHSH.PKG
33791>>//------------------------------
33791>>Use SelectXr.Dg
INCLUDING FILE: SELECTXR.DG
33791>>>>//AB/ Project SelectXr
33791>>>>//AB/     Object prj is a Dialog_Project
33791>>>>//AB/         Set ProjectName to "SelectXr"
33791>>>>//AB/         Set ProjectFileName to "SelectXr.DG"
33791>>>>//AB/         Set GenerateFileName to "NONAME"
33791>>>>
33791>>>>// Project Object Structure
33791>>>>//   oSelectYear is a dbModalPanelSub
33791>>>>//     Company_DD is a DataDictionary
33791>>>>//     Branch_DD is a DataDictionary
33791>>>>//     Year_DD is a DataDictionary
33791>>>>//     Company_Company_Code is a dbFormSub
33791>>>>//     Company_Company_Name is a dbFormSub
33791>>>>//     Branch_Branch_Code is a dbFormSub
33791>>>>//     Branch_Branch_Name is a dbFormSub
33791>>>>//     Year_Year_Year is a dbFormSub
33791>>>>//     Year_Year_Descr is a dbFormSub
33791>>>>//     Year_Year_Entrydate is a dbFormSub
33791>>>>//     oOk_bn is a ButtonSub
33791>>>>//     oCancel_bn is a ButtonSub
33791>>>>//     otxtCompany is a TextBoxSub
33791>>>>//     otxtBranch is a TextBoxSub
33791>>>>//     otxtYear is a TextBoxSub
33791>>>>//     otxtWorkingDay is a TextBoxSub
33791>>>>//     otxtWorkingDay is a TextBoxSub
33791>>>>//     chkxr is a CheckBoxSub
33791>>>>
33791>>>>// Register all objects
33791>>>>Register_Object Branch_Branch_Code
33791>>>>Register_Object Branch_Branch_Name
33791>>>>Register_Object Branch_DD
33791>>>>Register_Object Company_Company_Code
33791>>>>Register_Object Company_Company_Name
33791>>>>Register_Object Company_DD
33791>>>>Register_Object chkxr
33791>>>>Register_Object oCancel_bn
33791>>>>Register_Object oOk_bn
33791>>>>Register_Object oSelectYear
33791>>>>Register_Object otxtBranch
33791>>>>Register_Object otxtCompany
33791>>>>Register_Object otxtWorkingDay
33791>>>>Register_Object otxtYear
33791>>>>Register_Object Year_DD
33791>>>>Register_Object Year_Year_Descr
33791>>>>Register_Object Year_Year_Entrydate
33791>>>>Register_Object Year_Year_Year
33791>>>>
33791>>>>
33791>>>>
33791>>>>    //AB-StoreTopStart
33791>>>>
33791>>>>
33791>>>>
33791>>>>
33791>>>>           String  gs_selected_beto_site
33791>>>>
33791>>>>    Open SysCurXR
33793>>>>    Open Nomisma
33795>>>>
33795>>>>    //AB-StoreTopEnd
33795>>>>
33795>>>>    //AB-IgnoreStart
33795>>>>
33795>>>>    Use DFAllEnt.pkg
33795>>>>    Use dbForm.Sub
33795>>>>    Use Button.Sub
33795>>>>    Use Txtbox.Sub
33795>>>>    Use Chkbox.Sub
33795>>>>
33795>>>>
33795>>>>    Use COMPANY.DD
INCLUDING FILE: COMPANY.DD
33795>>>>>>//DDB-FileStart
33795>>>>>>//DDB-HeaderStart
33795>>>>>>
33795>>>>>>// File Name : COMPANY.DD
33795>>>>>>// Class Name: Company_DataDictionary
33795>>>>>>// Revision  : 62
33795>>>>>>// Version   : 2
33795>>>>>>
33795>>>>>>Use  Windows           // Basic Definitions
33795>>>>>>Use  DataDict          // DataDictionary Class Definition
33795>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
33795>>>>>>
33795>>>>>>Open Company
INCLUDING FILE: COMPANY.FD
33797>>>>>>Open Branch
33799>>>>>>
33799>>>>>>//DDB-HeaderEnd
33799>>>>>>//DDB-ValidationStart
33799>>>>>>
33799>>>>>>Register_Object Company_Company_Doy_VT
33799>>>>>>Register_Object Company_Company_J_Code_VT
33799>>>>>>
33799>>>>>>Object Company_Company_Doy_VT  is a CodeValidationTable
33801>>>>>>    Set Type_Value        To "DOY"
33802>>>>>>    Set Allow_Blank_State To TRUE
33803>>>>>>    //DDB-ValidationCustomStart
33803>>>>>>    //DDB-ValidationCustomEnd
33803>>>>>>End_Object   // Company_Company_Doy_VT
33804>>>>>>
33804>>>>>>Object Company_Company_J_Code_VT  is a CodeValidationTable
33806>>>>>>    Set Type_Value        To "JOB"
33807>>>>>>    Set Allow_Blank_State To TRUE
33808>>>>>>    //DDB-ValidationCustomStart
33808>>>>>>    //DDB-ValidationCustomEnd
33808>>>>>>End_Object   // Company_Company_J_Code_VT
33809>>>>>>//DDB-ValidationEnd
33809>>>>>>//DDB-SelectionStart
33809>>>>>>//DDB/ ExternalSelectionList sl001  sl001.sl
33809>>>>>>Register_Object sl001
33809>>>>>>//DDB-SelectionEnd
33809>>>>>> 
33809>>>>>>Class Company_DataDictionary  is a DataDictionary
33810>>>>>> 
33810>>>>>>    // Update:
33810>>>>>> 
33810>>>>>>    Procedure Update
33811>>>>>>        Forward Send Update
33813>>>>>>        move 'DOY' to company.doy_type
33814>>>>>>        move 'JOB' to company.jcode_type 
33815>>>>>>        // Insert Code Here
33815>>>>>>    End_Procedure   // Update
33816>>>>>> 
33816>>>>>>
33816>>>>>>    // Operation_Not_Allowed:
33816>>>>>>
33816>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
33817>>>>>>        // Insert Code Here
33817>>>>>>        Case Begin
33817>>>>>>             Case (iError_Num = 1001)
33819>>>>>>                  Error 1001 "DDC 051:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª „«˜ ¨œå˜ª!\n\n‰œ¤æª ‰à› ¡æª"
33820>>>>>>>
33820>>>>>>             Case Break
33821>>>>>>
33821>>>>>>             Case Else
33821>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
33823>>>>>>        Case End
33823>>>>>>    End_Procedure   // Operation_Not_Allowed
33824>>>>>>
33824>>>>>>
33824>>>>>>    // Validate_Save:
33824>>>>>>
33824>>>>>>    Function Validate_Save  Returns Integer
33825>>>>>>        Local Integer iReturnVal
33826>>>>>>        Forward Get Validate_Save  To iReturnVal
33828>>>>>>        If (Not(iReturnVal)) Begin
33830>>>>>>            // Insert Code Here
33830>>>>>>            If (Company.Company_Code="") Send Operation_Not_Allowed 1001
33833>>>>>>        End
33833>>>>>>>
33833>>>>>>        Function_Return iReturnVal
33834>>>>>>    End_Function   // Validate_Save
33835>>>>>>
33835>>>>>>
33835>>>>>>    // Define_Fields:
33835>>>>>>    // This procedure is used to set up all data-dictionary rules.
33835>>>>>>
33835>>>>>>    Procedure Define_Fields
33836>>>>>>        Forward Send Define_Fields
33838>>>>>>        //DDB-Generated-Code-Location
33838>>>>>>        //DDB-DefineFieldStart
33838>>>>>>
33838>>>>>>        Set Main_File            To Company.File_Number
33839>>>>>>        Set Cascade_Delete_State To FALSE
33840>>>>>>
33840>>>>>>
33840>>>>>>        // Child (Client) file structure................
33840>>>>>>        Send Add_Client_File  Branch.File_Number
33841>>>>>>
33841>>>>>>        // Field-based properties.......................
33841>>>>>>
33841>>>>>>        // Company.Company_Code
33841>>>>>>        Set Field_Options          Field Company.Company_Code To DD_AUTOFIND   
33842>>>>>>        Set Field_Prompt_Object    Field Company.Company_Code To (sl001(Self))
33843>>>>>>
33843>>>>>>        // Company.Company_Name
33843>>>>>>        Set Field_Options          Field Company.Company_Name To DD_REQUIRED   
33844>>>>>>        Set Field_Prompt_Object    Field Company.Company_Name To (sl001(Self))
33845>>>>>>
33845>>>>>>        // Company.Company_Afm
33845>>>>>>        Set Field_Options          Field Company.Company_Afm To DD_AUTOFIND   
33846>>>>>>
33846>>>>>>        // Company.Company_Addr
33846>>>>>>
33846>>>>>>        // Company.Company_Tk
33846>>>>>>
33846>>>>>>        // Company.Company_Poli
33846>>>>>>
33846>>>>>>        // Company.Company_Doy
33846>>>>>>        Set Field_Value_Table      Field Company.Company_Doy To (Company_Company_Doy_VT(Self))
33847>>>>>>
33847>>>>>>        // Company.Company_J_Code
33847>>>>>>        Set Field_Value_Table      Field Company.Company_J_Code To (Company_Company_J_Code_VT(Self))
33848>>>>>>
33848>>>>>>        // Company.Company_C_Code0
33848>>>>>>
33848>>>>>>        // Company.Company_C_Cod00
33848>>>>>>
33848>>>>>>        // Company.Company_C_Coder
33848>>>>>>
33848>>>>>>        // Company.Company_Tel
33848>>>>>>
33848>>>>>>        // Company.Company_Fax
33848>>>>>>
33848>>>>>>        // Company.Company_Email
33848>>>>>>
33848>>>>>>        // Company.Company_Resp
33848>>>>>>
33848>>>>>>        // Company.Company_Bitmap
33848>>>>>>
33848>>>>>>        // Company.Beto_Site
33848>>>>>>
33848>>>>>>        // Company.Logo
33848>>>>>>
33848>>>>>>        // Company.Doy_Type
33848>>>>>>
33848>>>>>>        // Company.Jcode_Type
33848>>>>>>
33848>>>>>>        // Company.Sap_Code
33848>>>>>>
33848>>>>>>        // Company.Sap_Path
33848>>>>>>
33848>>>>>>        //DDB-DefineFieldEnd
33848>>>>>>    End_Procedure    // Define_Fields
33849>>>>>>
33849>>>>>>    // Field_Defaults:
33849>>>>>>    // This procedure is used to establish default field values.
33849>>>>>>
33849>>>>>>    Procedure Field_Defaults
33850>>>>>>        Forward Send Field_Defaults
33852>>>>>>        //DDB-Generated-Code-Location
33852>>>>>>        //DDB-FieldDefaultStart
33852>>>>>>        //DDB-FieldDefaultEnd
33852>>>>>>    End_Procedure    // Field_Defaults
33853>>>>>>End_Class    // Company_DataDictionary
33854>>>>>>
33854>>>>>>//DDB-Selection-pkg-Start
33854>>>>>>
33854>>>>>>Use sl001.sl         // sl001
INCLUDING FILE: SL001.SL
33854>>>>>>>>//AB/ Project sl001 : Etairies
33854>>>>>>>>//AB/     Object prj is a Lookup_Project
33854>>>>>>>>//AB/         Set ProjectName to "sl001 : Etairies"
33854>>>>>>>>//AB/         Set ProjectFileName to "sl001.SL"
33854>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
33854>>>>>>>>
33854>>>>>>>>// Project Object Structure
33854>>>>>>>>//   sl001 is a dbModalPanel
33854>>>>>>>>//     Company_DD is a DataDictionary
33854>>>>>>>>//     oSelList is a dbList
33854>>>>>>>>//     oOK_bn is a ButtonSub
33854>>>>>>>>//     oCancel_bn is a ButtonSub
33854>>>>>>>>//     oSearch_bn is a ButtonSub
33854>>>>>>>>
33854>>>>>>>>// Register all objects
33854>>>>>>>>Register_Object Company_DD
33854>>>>>>>>Register_Object oCancel_bn
33854>>>>>>>>Register_Object oOK_bn
33854>>>>>>>>Register_Object oSearch_bn
33854>>>>>>>>Register_Object oSelList
33854>>>>>>>>Register_Object sl001
33854>>>>>>>>
33854>>>>>>>>
33854>>>>>>>>    //AB-IgnoreStart
33854>>>>>>>>
33854>>>>>>>>    Use DFAllEnt.pkg
33854>>>>>>>>    Use Button.Sub
33854>>>>>>>>
33854>>>>>>>>
33854>>>>>>>>    Use COMPANY.DD
33854>>>>>>>>    
33854>>>>>>>>    //AB-IgnoreEnd
33854>>>>>>>>
33854>>>>>>>>    CD_Popup_Object sl001 is a dbModalPanel
33873>>>>>>>>        Set Label to "„«˜ ¨åœª"
33874>>>>>>>>        Set Size to 148 297
33875>>>>>>>>        Set Location to 12 27
33876>>>>>>>>
33876>>>>>>>>        //AB-DDOStart
33876>>>>>>>>
33876>>>>>>>>        Object Company_DD is a Company_DataDictionary
33878>>>>>>>>        End_Object    // Company_DD
33879>>>>>>>>
33879>>>>>>>>        Set Main_DD to (Company_DD(self))
33880>>>>>>>>        Set Server to (Company_DD(self))
33881>>>>>>>>
33881>>>>>>>>        //AB-DDOEnd
33881>>>>>>>>
33881>>>>>>>>        Object oSelList is a dbList
33883>>>>>>>>            Set Main_File to Company.File_Number
33884>>>>>>>>            Set Size to 105 280
33885>>>>>>>>            Set Location to 6 6
33886>>>>>>>>
33886>>>>>>>>            Begin_Row
33889>>>>>>>>                Entry_Item Company.Company_code
33890>>>>>>>>                Entry_Item Company.Company_name
33891>>>>>>>>                Entry_Item Company.Company_afm
33892>>>>>>>>            End_Row
33897>>>>>>>>
33897>>>>>>>>            Set Form_Width    item 0 to 42
33898>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
33899>>>>>>>>            
33899>>>>>>>>            Set Form_Width    item 1 to 150
33900>>>>>>>>            Set Header_Label  item 1 to "„§à¤¬£å˜"
33901>>>>>>>>            
33901>>>>>>>>            Set Form_Width    item 2 to 80
33902>>>>>>>>            Set Header_Label  item 2 to "€.”.‹"
33903>>>>>>>>            
33903>>>>>>>>        End_Object    // oSelList
33904>>>>>>>>
33904>>>>>>>>        Object oOK_bn is a ButtonSub
33906>>>>>>>>            Set Label to "&„§ ¢¦šã"
33907>>>>>>>>            Set Location to 115 126
33908>>>>>>>>
33908>>>>>>>>            //AB-StoreStart
33908>>>>>>>>            Procedure OnClick
33910>>>>>>>>                Send OK To (oSelList(current_object))
33911>>>>>>>>            End_Procedure
33912>>>>>>>>            //AB-StoreEnd
33912>>>>>>>>
33912>>>>>>>>        End_Object    // oOK_bn
33913>>>>>>>>
33913>>>>>>>>        Object oCancel_bn is a ButtonSub
33915>>>>>>>>            Set Label to "&€¡ç¨à©ž"
33916>>>>>>>>            Set Location to 115 181
33917>>>>>>>>
33917>>>>>>>>            //AB-StoreStart
33917>>>>>>>>            Procedure OnClick
33919>>>>>>>>                Send Cancel To (oSelList(current_object))
33920>>>>>>>>            End_Procedure
33921>>>>>>>>            //AB-StoreEnd
33921>>>>>>>>
33921>>>>>>>>        End_Object    // oCancel_bn
33922>>>>>>>>
33922>>>>>>>>        Object oSearch_bn is a ButtonSub
33924>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
33925>>>>>>>>            Set Location to 115 236
33926>>>>>>>>
33926>>>>>>>>            //AB-StoreStart
33926>>>>>>>>            Procedure OnClick
33928>>>>>>>>                Send Search To (oSelList(current_object))
33929>>>>>>>>            End_Procedure
33930>>>>>>>>            //AB-StoreEnd
33930>>>>>>>>
33930>>>>>>>>        End_Object    // oSearch_bn
33931>>>>>>>>
33931>>>>>>>>
33931>>>>>>>>        //AB-StoreStart
33931>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To oOk_bn
33932>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To oCancel_bn
33933>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To oSearch_bn
33934>>>>>>>>        //AB-StoreEnd
33934>>>>>>>>
33934>>>>>>>>    CD_End_Object    // sl001
33936>>>>>>>>>
33936>>>>>>>>
33936>>>>>>>>//AB/     End_Object    // prj
33936>>>>>>
33936>>>>>>//DDB-Selection-pkg-End
33936>>>>>>//DDB-FileEnd
33936>>>>    Use BRANCH.DD
INCLUDING FILE: BRANCH.DD
33936>>>>>>//DDB-FileStart
33936>>>>>>//DDB-HeaderStart
33936>>>>>>
33936>>>>>>// File Name : BRANCH.DD
33936>>>>>>// Class Name: Branch_DataDictionary
33936>>>>>>// Revision  : 89
33936>>>>>>// Version   : 2
33936>>>>>>
33936>>>>>>Use  Windows           // Basic Definitions
33936>>>>>>Use  DataDict          // DataDictionary Class Definition
33936>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
33936>>>>>>
33936>>>>>>Open Branch
33938>>>>>>Open Year
33940>>>>>>Open Brzones
INCLUDING FILE: BRZONES.FD
33942>>>>>>Open Tpbranch
INCLUDING FILE: TPBRANCH.FD
33944>>>>>>Open Company
33946>>>>>>Open Sysrecg
INCLUDING FILE: SYSRECG.FD
33948>>>>>>
33948>>>>>>//DDB-HeaderEnd
33948>>>>>>//DDB-ValidationStart
33948>>>>>>
33948>>>>>>Register_Object Branch_Branch_Doy_VT
33948>>>>>>Register_Object Branch_Branch_C_Code0_VT
33948>>>>>>
33948>>>>>>Object Branch_Branch_Doy_VT  is a CodeValidationTable
33950>>>>>>    Set Type_Value        To "DOY"
33951>>>>>>    Set Validate_State    To FALSE
33952>>>>>>    Set Allow_Blank_State To TRUE
33953>>>>>>    //DDB-ValidationCustomStart
33953>>>>>>    //DDB-ValidationCustomEnd
33953>>>>>>End_Object   // Branch_Branch_Doy_VT
33954>>>>>>
33954>>>>>>Object Branch_Branch_C_Code0_VT  is a CodeValidationTable
33956>>>>>>    Set Type_Value        To ""
33957>>>>>>    Set Allow_Blank_State To TRUE
33958>>>>>>    //DDB-ValidationCustomStart
33958>>>>>>    //DDB-ValidationCustomEnd
33958>>>>>>End_Object   // Branch_Branch_C_Code0_VT
33959>>>>>>//DDB-ValidationEnd
33959>>>>>>//DDB-SelectionStart
33959>>>>>>//DDB/ ExternalSelectionList SL002  Sl002.sl
33959>>>>>>Register_Object SL002
33959>>>>>>//DDB-SelectionEnd
33959>>>>>>
33959>>>>>>Class Branch_DataDictionary  is a DataDictionary
33960>>>>>> 
33960>>>>>>    Procedure Save_Main_File
33961>>>>>>        Forward Send Save_Main_File
33963>>>>>>        // Insert Code Here
33963>>>>>>    End_Procedure   // Save_Main_File
33964>>>>>> 
33964>>>>>>    Procedure Creating
33965>>>>>>        Forward Send Creating
33967>>>>>>        // Insert Code Here
33967>>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Branch.Branch_Rec0)))))) to Branch.Branch_Recr
33968>>>>>>    End_Procedure   // Creating
33969>>>>>>
33969>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
33970>>>>>>        // Insert Code Here
33970>>>>>>        Case Begin
33970>>>>>>             Case (iError_Num = 1001)
33972>>>>>>                  Error 1001 "DDC 052:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
33973>>>>>>>
33973>>>>>>             Case Break
33974>>>>>>
33974>>>>>>             Case Else
33974>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
33976>>>>>>        Case End
33976>>>>>>    End_Procedure   // Operation_Not_Allowed
33977>>>>>>
33977>>>>>>
33977>>>>>>    // Validate_Save:
33977>>>>>>
33977>>>>>>    Function Validate_Save  Returns Integer
33978>>>>>>        Local Integer iReturnVal
33979>>>>>>        Forward Get Validate_Save  To iReturnVal
33981>>>>>>        If (Not(iReturnVal)) Begin
33983>>>>>>            // Insert Code Here
33983>>>>>>            If (Branch.Branch_Code="") Send Operation_Not_Allowed 1001
33986>>>>>>        End
33986>>>>>>>
33986>>>>>>        Function_Return iReturnVal
33987>>>>>>    End_Function   // Validate_Save
33988>>>>>>
33988>>>>>>
33988>>>>>>    // Define_Fields:
33988>>>>>>    // This procedure is used to set up all data-dictionary rules.
33988>>>>>>
33988>>>>>>    Procedure Define_Fields
33989>>>>>>        Forward Send Define_Fields
33991>>>>>>        //DDB-Generated-Code-Location
33991>>>>>>        //DDB-DefineFieldStart
33991>>>>>>
33991>>>>>>        Set Main_File            To Branch.File_Number
33992>>>>>>        Set Cascade_Delete_State To FALSE
33993>>>>>>
33993>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
33994>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOENTER     DD_FINDREQ    
33995>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
33996>>>>>>
33996>>>>>>        // Child (Client) file structure................
33996>>>>>>        Send Add_Client_File  Year.File_Number
33997>>>>>>        Send Add_Client_File  Brzones.File_Number
33998>>>>>>        Send Add_Client_File  Tpbranch.File_Number
33999>>>>>>
33999>>>>>>        // Parent (Server) file structure...............
33999>>>>>>        Send Add_Server_File  Company.File_Number
34000>>>>>>
34000>>>>>>        // External (System) file structure.............
34000>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
34001>>>>>>
34001>>>>>>        Define_Auto_Increment  Sysrecg.Branch_Rec0  To Branch.Branch_Rec0
34004>>>>>>
34004>>>>>>        // Field-based properties.......................
34004>>>>>>
34004>>>>>>        // Branch.Company_Code
34004>>>>>>
34004>>>>>>        // Branch.Branch_Code
34004>>>>>>        Set Field_Options          Field Branch.Branch_Code To DD_AUTOFIND   
34005>>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Code To (SL002(Self))
34006>>>>>>        Set Key_Field_State        Field Branch.Branch_Code To TRUE
34007>>>>>>
34007>>>>>>        // Branch.Branch_Rec0
34007>>>>>>
34007>>>>>>        // Branch.Branch_Recr
34007>>>>>>
34007>>>>>>        // Branch.Branch_Name
34007>>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Name To (SL002(Self))
34008>>>>>>
34008>>>>>>        // Branch.Branch_Afm
34008>>>>>>
34008>>>>>>        // Branch.Branch_Addr
34008>>>>>>
34008>>>>>>        // Branch.Branch_Tk
34008>>>>>>
34008>>>>>>        // Branch.Branch_Poli
34008>>>>>>
34008>>>>>>        // Branch.Branch_Doy
34008>>>>>>        Set Field_Value_Table      Field Branch.Branch_Doy To (Branch_Branch_Doy_VT(Self))
34009>>>>>>
34009>>>>>>        // Branch.Branch_J_Code
34009>>>>>>
34009>>>>>>        // Branch.Branch_C_Code0
34009>>>>>>        Set Field_Value_Table      Field Branch.Branch_C_Code0 To (Branch_Branch_C_Code0_VT(Self))
34010>>>>>>
34010>>>>>>        // Branch.Branch_C_Code00
34010>>>>>>
34010>>>>>>        // Branch.Branch_C_Coder
34010>>>>>>
34010>>>>>>        // Branch.Branch_Tel
34010>>>>>>
34010>>>>>>        // Branch.Branch_Fax
34010>>>>>>
34010>>>>>>        // Branch.Branch_Email
34010>>>>>>
34010>>>>>>        // Branch.Branch_Resp
34010>>>>>>
34010>>>>>>        // Branch.Branch_Bitmap
34010>>>>>>
34010>>>>>>        // Branch.Branch_Site
34010>>>>>>
34010>>>>>>        // Branch.Branch_Apoth
34010>>>>>>
34010>>>>>>        // Branch.Beto_Site
34010>>>>>>
34010>>>>>>        // Branch.Path_Exp
34010>>>>>>
34010>>>>>>        // Branch.Exp_Txtname
34010>>>>>>
34010>>>>>>        // Branch.Send_Phone
34010>>>>>>
34010>>>>>>        // Branch.Send_Path_Files
34010>>>>>>
34010>>>>>>        // Branch.Send_Path_Conf
34010>>>>>>
34010>>>>>>        // Branch.Tomeas_Code
34010>>>>>>
34010>>>>>>        // Branch.Ftp_Sec_Retry
34010>>>>>>
34010>>>>>>        // Branch.Ftp_Sec_Exit
34010>>>>>>
34010>>>>>>        // Branch.Ras_Name
34010>>>>>>
34010>>>>>>        // Branch.Ras_Passw
34010>>>>>>
34010>>>>>>        // Branch.Ras_Domain
34010>>>>>>
34010>>>>>>        // Branch.Last_Hmnia_Ekt
34010>>>>>>
34010>>>>>>        // Branch.Deop_Logo
34010>>>>>>
34010>>>>>>        // Branch.Entolh
34010>>>>>>
34010>>>>>>        // Branch.Paragogh
34010>>>>>>
34010>>>>>>        // Branch.Locked_Until
34010>>>>>>
34010>>>>>>        // Branch.Sap_Code
34010>>>>>>
34010>>>>>>        // Branch.Perioxh
34010>>>>>>
34010>>>>>>        // Branch.Egkatastash
34010>>>>>>
34010>>>>>>        //DDB-DefineFieldEnd
34010>>>>>>    End_Procedure    // Define_Fields
34011>>>>>>
34011>>>>>>    // Field_Defaults:
34011>>>>>>    // This procedure is used to establish default field values.
34011>>>>>>
34011>>>>>>    Procedure Field_Defaults
34012>>>>>>        Forward Send Field_Defaults
34014>>>>>>        //DDB-Generated-Code-Location
34014>>>>>>        //DDB-FieldDefaultStart
34014>>>>>>        //DDB-FieldDefaultEnd
34014>>>>>>    End_Procedure    // Field_Defaults
34015>>>>>>End_Class    // Branch_DataDictionary
34016>>>>>>
34016>>>>>>//DDB-Selection-pkg-Start
34016>>>>>>
34016>>>>>>Use Sl002.sl         // SL002
INCLUDING FILE: SL002.SL
34016>>>>>>>>//AB/ Project SL002:Branch
34016>>>>>>>>//AB/ Object prj is a Lookup_Project
34016>>>>>>>>//AB/     Set ProjectName to "SL002:Branch"
34016>>>>>>>>//AB/     Set ProjectFileName to "Sl002.sl"
34016>>>>>>>>
34016>>>>>>>>// Project Object Structure
34016>>>>>>>>//   SL002 is a dbModalPanelSub
34016>>>>>>>>//     Company_DD is a DataDictionary
34016>>>>>>>>//     Branch_DD is a DataDictionary
34016>>>>>>>>//     oSelList is a dbListSub
34016>>>>>>>>//     oOK_bn is a ButtonSub
34016>>>>>>>>//     oCancel_bn is a ButtonSub
34016>>>>>>>>//     oSearch_bn is a ButtonSub
34016>>>>>>>>
34016>>>>>>>>// Register all objects
34016>>>>>>>>Register_Object Branch_DD
34016>>>>>>>>Register_Object Company_DD
34016>>>>>>>>Register_Object oCancel_bn
34016>>>>>>>>Register_Object oOK_bn
34016>>>>>>>>Register_Object oSearch_bn
34016>>>>>>>>Register_Object oSelList
34016>>>>>>>>Register_Object SL002
34016>>>>>>>>
34016>>>>>>>>
34016>>>>>>>>//AB-IgnoreStart
34016>>>>>>>>
34016>>>>>>>>Use DFAllEnt.pkg
34016>>>>>>>>Use dbList.Sub
34016>>>>>>>>Use Button.Sub
34016>>>>>>>>
34016>>>>>>>>
34016>>>>>>>>Use COMPANY.DD
34016>>>>>>>>Use BRANCH.DD
34016>>>>>>>>
34016>>>>>>>>//AB-IgnoreEnd
34016>>>>>>>>
34016>>>>>>>>Object SL002 is a dbModalPanelSub
34018>>>>>>>>
34018>>>>>>>>    //AB-StoreTopStart
34018>>>>>>>>    Property String psFragmaCompanyCode  ""
34020>>>>>>>>    
34020>>>>>>>>    //AB-StoreTopEnd
34020>>>>>>>>
34020>>>>>>>>    Set Minimize_Icon to FALSE
34021>>>>>>>>    Set Label to "“§¦¡˜«˜©«ã£˜«˜"
34022>>>>>>>>    Set Size to 146 430
34023>>>>>>>>    Set Location to 4 5
34024>>>>>>>>    Set Exit_Application_Local_State to FALSE
34025>>>>>>>>    Set Modal_State to FALSE
34026>>>>>>>>
34026>>>>>>>>    //AB-DDOStart
34026>>>>>>>>
34026>>>>>>>>    Object Company_DD is a Company_DataDictionary
34028>>>>>>>>    End_Object    // Company_DD
34029>>>>>>>>
34029>>>>>>>>    Object Branch_DD is a Branch_DataDictionary
34031>>>>>>>>        Set DDO_Server to (Company_DD(self))
34032>>>>>>>>
34032>>>>>>>>        //AB-StoreStart
34032>>>>>>>>        Procedure OnConstrain
34034>>>>>>>>             String lsCompanyCode
34035>>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
34036>>>>>>>>             If (lsCompanyCode <> "") Constrain Branch.Company_code eq lsCompanyCode
34040>>>>>>>>        End_Procedure // OnConstrain
34041>>>>>>>>        
34041>>>>>>>>        
34041>>>>>>>>        
34041>>>>>>>>        //AB-StoreEnd
34041>>>>>>>>
34041>>>>>>>>    End_Object    // Branch_DD
34042>>>>>>>>
34042>>>>>>>>    Set Main_DD to (Branch_DD(self))
34043>>>>>>>>    Set Server to (Branch_DD(self))
34044>>>>>>>>
34044>>>>>>>>    //AB-DDOEnd
34044>>>>>>>>
34044>>>>>>>>    Object oSelList is a dbListSub
34046>>>>>>>>        Set Main_File to Branch.File_Number
34047>>>>>>>>        Set Size to 105 415
34048>>>>>>>>        Set Location to 6 6
34049>>>>>>>>
34049>>>>>>>>        Begin_Row
34052>>>>>>>>            Entry_Item Branch.Branch_code
34053>>>>>>>>            Entry_Item Branch.Branch_name
34054>>>>>>>>            Entry_Item Company.Company_code
34055>>>>>>>>            Entry_Item Company.Company_name
34056>>>>>>>>            Entry_Item Branch.Beto_site
34057>>>>>>>>            Entry_Item Branch.Branch_recr
34058>>>>>>>>        End_Row
34063>>>>>>>>
34063>>>>>>>>        Set Form_Width    item 0 to 60
34064>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
34065>>>>>>>>        
34065>>>>>>>>        Set Form_Width    item 1 to 128
34066>>>>>>>>        Set Header_Label  item 1 to "Ž¤¦£˜"
34067>>>>>>>>        
34067>>>>>>>>        Set Form_Width    item 2 to 69
34068>>>>>>>>        Set Header_Label  item 2 to "‰à› ¡æª „«˜ ¨å˜ª"
34069>>>>>>>>        
34069>>>>>>>>        Set Form_Width    item 3 to 109
34070>>>>>>>>        Set Header_Label  item 3 to "Ž¤¦£˜ „«˜ ¨å˜ª"
34071>>>>>>>>        
34071>>>>>>>>        Set Form_Width    item 4 to 42
34072>>>>>>>>        Set Header_Label  item 4 to "Site"
34073>>>>>>>>        
34073>>>>>>>>        Set Form_Width    item 5 to 0
34074>>>>>>>>        Set Header_Label  item 5 to ""
34075>>>>>>>>        
34075>>>>>>>>
34075>>>>>>>>        //AB-StoreStart
34075>>>>>>>>                
34075>>>>>>>>        Property String psStoreFragmaCompanyCode  ""
34077>>>>>>>>        
34077>>>>>>>>        Procedure Store_Defaults
34079>>>>>>>>            forward send Store_Defaults
34081>>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
34082>>>>>>>>        end_Procedure // Store_Defaults
34083>>>>>>>>        
34083>>>>>>>>        Procedure Restore_Defaults
34085>>>>>>>>            forward send Restore_Defaults
34087>>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
34088>>>>>>>>        end_Procedure // Restore_Defaults
34089>>>>>>>>        
34089>>>>>>>>        Procedure Activating
34091>>>>>>>>            Forward Send Activating
34093>>>>>>>>            Send Rebuild_Constraints to (Branch_DD(self))
34094>>>>>>>>        End_Procedure // Activating
34095>>>>>>>>        
34095>>>>>>>>        Set Column_Options Item 5 to NoEnter True
34096>>>>>>>>        
34096>>>>>>>>        
34096>>>>>>>>        //AB-StoreEnd
34096>>>>>>>>
34096>>>>>>>>    End_Object    // oSelList
34097>>>>>>>>
34097>>>>>>>>    Object oOK_bn is a ButtonSub
34099>>>>>>>>        Set Label to "&„§ ¢¦šã"
34100>>>>>>>>        Set Location to 112 262
34101>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34102>>>>>>>>
34102>>>>>>>>        //AB-StoreStart
34102>>>>>>>>        Procedure OnClick
34104>>>>>>>>            Send OK To (oSelList(current_object))
34105>>>>>>>>        End_Procedure
34106>>>>>>>>        //AB-StoreEnd
34106>>>>>>>>
34106>>>>>>>>    End_Object    // oOK_bn
34107>>>>>>>>
34107>>>>>>>>    Object oCancel_bn is a ButtonSub
34109>>>>>>>>        Set Label to "&€¡ç¨à©ž"
34110>>>>>>>>        Set Location to 112 317
34111>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34112>>>>>>>>
34112>>>>>>>>        //AB-StoreStart
34112>>>>>>>>        Procedure OnClick
34114>>>>>>>>            Send Cancel To (oSelList(current_object))
34115>>>>>>>>        End_Procedure
34116>>>>>>>>        //AB-StoreEnd
34116>>>>>>>>
34116>>>>>>>>    End_Object    // oCancel_bn
34117>>>>>>>>
34117>>>>>>>>    Object oSearch_bn is a ButtonSub
34119>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
34120>>>>>>>>        Set Location to 112 372
34121>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34122>>>>>>>>
34122>>>>>>>>        //AB-StoreStart
34122>>>>>>>>        Procedure OnClick
34124>>>>>>>>            Send Search To (oSelList(current_object))
34125>>>>>>>>        End_Procedure
34126>>>>>>>>        //AB-StoreEnd
34126>>>>>>>>
34126>>>>>>>>    End_Object    // oSearch_bn
34127>>>>>>>>
34127>>>>>>>>
34127>>>>>>>>    //AB-StoreStart
34127>>>>>>>>    
34127>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
34128>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
34129>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
34130>>>>>>>>    
34130>>>>>>>>    
34130>>>>>>>>    
34130>>>>>>>>    //AB-StoreEnd
34130>>>>>>>>
34130>>>>>>>>End_Object    // SL002
34131>>>>>>>>
34131>>>>>>>>//AB/ End_Object    // prj
34131>>>>>>
34131>>>>>>//DDB-Selection-pkg-End
34131>>>>>>//DDB-FileEnd
34131>>>>    Use YEAR.DD
INCLUDING FILE: YEAR.DD
34131>>>>>>//DDB-FileStart
34131>>>>>>//DDB-HeaderStart
34131>>>>>>
34131>>>>>>// File Name : YEAR.DD
34131>>>>>>// Class Name: Year_DataDictionary
34131>>>>>>// Revision  : 119
34131>>>>>>// Version   : 2
34131>>>>>>
34131>>>>>>Use  Windows           // Basic Definitions
34131>>>>>>Use  DataDict          // DataDictionary Class Definition
34131>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
34131>>>>>>
34131>>>>>>Open Year
34133>>>>>>Open Branch
34135>>>>>>Open Syscurxr
34137>>>>>>
34137>>>>>>//DDB-HeaderEnd
34137>>>>>>//DDB-ValidationStart
34137>>>>>>
34137>>>>>>Register_Object Year_Year_C_Code0_VT1
34137>>>>>>Register_Object Year_Year_C_Code00_VT1
34137>>>>>>Register_Object Year_Year_C_Coder_VT1
34137>>>>>>
34137>>>>>>Object Year_Year_C_Code0_VT1  is a CodeValidationTable
34139>>>>>>    Set Type_Value        To "CURRENCY"
34140>>>>>>    //DDB-ValidationCustomStart
34140>>>>>>    //DDB-ValidationCustomEnd
34140>>>>>>End_Object   // Year_Year_C_Code0_VT1
34141>>>>>>
34141>>>>>>Object Year_Year_C_Code00_VT1  is a CodeValidationTable
34143>>>>>>    Set Type_Value        To "CURRENCY"
34144>>>>>>    //DDB-ValidationCustomStart
34144>>>>>>    //DDB-ValidationCustomEnd
34144>>>>>>End_Object   // Year_Year_C_Code00_VT1
34145>>>>>>
34145>>>>>>Object Year_Year_C_Coder_VT1  is a CodeValidationTable
34147>>>>>>    Set Type_Value        To "CURRENCY"
34148>>>>>>    //DDB-ValidationCustomStart
34148>>>>>>    //DDB-ValidationCustomEnd
34148>>>>>>End_Object   // Year_Year_C_Coder_VT1
34149>>>>>>//DDB-ValidationEnd
34149>>>>>>//DDB-SelectionStart
34149>>>>>>//DDB/ ExternalSelectionList SL003  Sl003.sl
34149>>>>>>Register_Object SL003
34149>>>>>>//DDB-SelectionEnd
34149>>>>>>            
34149>>>>>>Class Year_DataDictionary  is a DataDictionary
34150>>>>>>    
34150>>>>>>    Procedure Creating
34151>>>>>>        Forward Send Creating
34153>>>>>>        // Insert Code Here
34153>>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Year.Year_Year)))))) to Year.Year_Recr
34154>>>>>>    End_Procedure   // Creating
34155>>>>>>
34155>>>>>>
34155>>>>>>    // Operation_Not_Allowed:
34155>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
34156>>>>>>        // Insert Code Here
34156>>>>>>        Case Begin    
34156>>>>>>             Case (iError_Num = 1001)
34158>>>>>>                  Error 1001 "DDC 053:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
34159>>>>>>>
34159>>>>>>             Case Break
34160>>>>>>             Case (iError_Num=1002)
34163>>>>>>                Error 1002 "DDC 053:Branch Site ¡˜«œ™˜å¤œ  ©«¦ Year ¡œ¤æ"
34164>>>>>>>
34164>>>>>>             Case Break
34165>>>>>>             Case (iError_Num=1003)
34168>>>>>>                Error 1003 "DDC 053:Company Code=0"
34169>>>>>>>
34169>>>>>>             Case Break
34170>>>>>>             Case (iError_Num=1004)
34173>>>>>>                Error 1004 "DDC 053:Branch Code=0"
34174>>>>>>>
34174>>>>>>             Case Break
34175>>>>>>             Case Else
34175>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
34177>>>>>>        Case End
34177>>>>>>    End_Procedure   // Operation_Not_Allowed
34178>>>>>>
34178>>>>>>
34178>>>>>>    // Update:
34178>>>>>>    // Use this message to effect changes in related-to files. The
34178>>>>>>    // Backout message should be designed to reverse the effects of this
34178>>>>>>    // message. It is invoked while the database is locked.
34178>>>>>>
34178>>>>>>    Procedure Update
34179>>>>>>        Forward Send Update
34181>>>>>>        // Insert Code Here
34181>>>>>>        Move Company.Company_Code   to Year.Company_Code
34182>>>>>>        Move Branch.Branch_Code     to Year.Branch_Code
34183>>>>>>        move branch.beto_site       to year.beto_site
34184>>>>>>
34184>>>>>>        //sos:parametrika apo sysfile?
34184>>>>>>       
34184>>>>>>       // If ((Year.Year_EntryDate-14) < Year.Year_XrhshFrom) Begin
34184>>>>>>       //     Move Year.Year_XrhshFrom to Year.Year_OpenFrom
34184>>>>>>       // End
34184>>>>>>       // Else Begin
34184>>>>>>       //     Move (Year.Year_EntryDate-14) to Year.Year_OpenFrom
34184>>>>>>       // End
34184>>>>>>      //  Move Year.Year_EntryDate      to Year.Year_OpenTo
34184>>>>>>    End_Procedure   // Update
34185>>>>>>
34185>>>>>>    // Validate_Save:
34185>>>>>>
34185>>>>>>    Function Validate_Save  Returns Integer
34186>>>>>>        Local Integer iReturnVal
34187>>>>>>        Forward Get Validate_Save  To iReturnVal
34189>>>>>>        If (Not(iReturnVal)) Begin
34191>>>>>>                 If (Year.Year_Year   = 0) Send Operation_Not_Allowed 1001
34194>>>>>>            Else If (Year.Company_Code='') Send Operation_Not_Allowed 1003
34198>>>>>>            Else If (Year.Branch_Code ='') Send Operation_Not_Allowed 1004
34202>>>>>>        End
34202>>>>>>>
34202>>>>>>        Function_Return iReturnVal
34203>>>>>>    End_Function   // Validate_Save
34204>>>>>>
34204>>>>>>
34204>>>>>>    // Define_Fields:
34204>>>>>>    // This procedure is used to set up all data-dictionary rules.
34204>>>>>>
34204>>>>>>    Procedure Define_Fields
34205>>>>>>        Forward Send Define_Fields
34207>>>>>>        //DDB-Generated-Code-Location
34207>>>>>>        //DDB-DefineFieldStart
34207>>>>>>
34207>>>>>>        Set Main_File            To Year.File_Number
34208>>>>>>        Set Cascade_Delete_State To FALSE
34209>>>>>>
34209>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
34210>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
34211>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
34212>>>>>>
34212>>>>>>        // Parent (Server) file structure...............
34212>>>>>>        Send Add_Server_File  Branch.File_Number
34213>>>>>>
34213>>>>>>        // External (System) file structure.............
34213>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
34214>>>>>>
34214>>>>>>        // Field-based properties.......................
34214>>>>>>
34214>>>>>>        // Year.Company_Code
34214>>>>>>
34214>>>>>>        // Year.Branch_Code
34214>>>>>>
34214>>>>>>        // Year.Year_Year
34214>>>>>>        Set Field_Options          Field Year.Year_Year To DD_AUTOFIND    DD_REQUIRED   
34215>>>>>>        Set Field_Prompt_Object    Field Year.Year_Year To (SL003(Self))
34216>>>>>>        Set Key_Field_State        Field Year.Year_Year To TRUE
34217>>>>>>
34217>>>>>>        // Year.Year_Recr
34217>>>>>>        Set Field_Prompt_Object    Field Year.Year_Recr To (SL003(Self))
34218>>>>>>
34218>>>>>>        // Year.Branch_Recr
34218>>>>>>
34218>>>>>>        // Year.Year_Descr
34218>>>>>>
34218>>>>>>        // Year.Year_Isolfrom
34218>>>>>>
34218>>>>>>        // Year.Year_Isolto
34218>>>>>>
34218>>>>>>        // Year.Year_Openfrom
34218>>>>>>
34218>>>>>>        // Year.Year_Opento
34218>>>>>>
34218>>>>>>        // Year.Year_Entrydate
34218>>>>>>
34218>>>>>>        // Year.Year_Dateaa
34218>>>>>>
34218>>>>>>        // Year.Year_Xrhshfrom
34218>>>>>>
34218>>>>>>        // Year.Year_Xrhshto
34218>>>>>>
34218>>>>>>        // Year.Year_Myflimit
34218>>>>>>
34218>>>>>>        // Year.Year_Numgtypkin
34218>>>>>>
34218>>>>>>        // Year.Year_Numgarticl
34218>>>>>>
34218>>>>>>        // Year.Year_Numgmove
34218>>>>>>
34218>>>>>>        // Year.Year_Numgplan
34218>>>>>>
34218>>>>>>        // Year.Year_Numgformat
34218>>>>>>
34218>>>>>>        // Year.Year_Numgthaa
34218>>>>>>
34218>>>>>>        // Year.Year_Numgopen
34218>>>>>>
34218>>>>>>        // Year.Year_Numbtypkin
34218>>>>>>
34218>>>>>>        // Year.Year_Numbaxio
34218>>>>>>
34218>>>>>>        // Year.Year_Numbarticl
34218>>>>>>
34218>>>>>>        // Year.Year_Numbmove
34218>>>>>>
34218>>>>>>        // Year.Year_Delimiter
34218>>>>>>
34218>>>>>>        // Year.Year_Printer
34218>>>>>>
34218>>>>>>        // Year.Year_Valid_Char
34218>>>>>>
34218>>>>>>        // Year.Year_C_Code0
34218>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0 To "dbComboFormSub"
34219>>>>>>        Set Field_Value_Table      Field Year.Year_C_Code0 To (Year_Year_C_Code0_VT1(Self))
34220>>>>>>
34220>>>>>>        // Year.Year_C_Code00
34220>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00 To "dbComboFormSub"
34221>>>>>>        Set Field_Value_Table      Field Year.Year_C_Code00 To (Year_Year_C_Code00_VT1(Self))
34222>>>>>>
34222>>>>>>        // Year.Year_C_Coder
34222>>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder To "dbComboFormSub"
34223>>>>>>        Set Field_Value_Table      Field Year.Year_C_Coder To (Year_Year_C_Coder_VT1(Self))
34224>>>>>>
34224>>>>>>        // Year.Beto_Site
34224>>>>>>
34224>>>>>>        // Year.Clients_Plafon
34224>>>>>>
34224>>>>>>        // Year.Payresp_Plafon
34224>>>>>>
34224>>>>>>        // Year.Clients_Ofeilh
34224>>>>>>
34224>>>>>>        // Year.Payresp_Ofeilh
34224>>>>>>
34224>>>>>>        // Year.Working
34224>>>>>>
34224>>>>>>        //DDB-DefineFieldEnd
34224>>>>>>
34224>>>>>>        Set Main_File            To Year.File_Number
34225>>>>>>        Set Cascade_Delete_State To FALSE
34226>>>>>>
34226>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
34227>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
34228>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
34229>>>>>>
34229>>>>>>        // Child (Client) file structure................
34229>>>>>>
34229>>>>>>        // Parent (Server) file structure...............
34229>>>>>>        Send Add_Server_File  Branch.File_Number
34230>>>>>>
34230>>>>>>        // Field-based properties.......................
34230>>>>>>
34230>>>>>>        // Year.Company_Code
34230>>>>>>
34230>>>>>>        // Year.Branch_Code
34230>>>>>>
34230>>>>>>        // Year.Year_Year
34230>>>>>>        Set Field_Label_Long       Field Year.Year_Year           To "•¨ã©ž"
34231>>>>>>        Set Field_Label_Short      Field Year.Year_Year           To "•¨ã©ž"
34232>>>>>>        Set Field_Options          Field Year.Year_Year           To DD_REQUIRED
34233>>>>>>        //Set Field_Prompt_Object    Field Year.Year_Year           To (SL053(Self))
34233>>>>>>
34233>>>>>>        // Year.Year_Descr
34233>>>>>>        Set Field_Label_Long       Field Year.Year_Descr          To "œ¨ š¨˜­ã •¨ã©žª"
34234>>>>>>        Set Field_Label_Short      Field Year.Year_Descr          To "œ¨.•¨ã©žª"
34235>>>>>>
34235>>>>>>        // Year.Year_C_Code0
34235>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0        To "dbComboForm"
34236>>>>>>        Set Field_Label_Long       Field Year.Year_C_Code0        To "‰ç¨ ¦ Œæ£ ©£˜"
34237>>>>>>        Set Field_Label_Short      Field Year.Year_C_Code0        To "‰¬¨.Œ¦£ ©£˜"
34238>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code0        To (Year_Year_C_Code0_VT(Self))
34238>>>>>>
34238>>>>>>        // Year.Year_C_Code00
34238>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00       To "dbComboForm"
34239>>>>>>        Set Field_Label_Long       Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
34240>>>>>>        Set Field_Label_Short      Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
34241>>>>>>        //Set Field_Options          Field Year.Year_C_Code00       To DD_REQUIRED
34241>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code00       To (Year_Year_C_Code1_VT(Self))
34241>>>>>>
34241>>>>>>        // Year.Year_C_Coder
34241>>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder        To "dbComboForm"
34242>>>>>>        Set Field_Label_Long       Field Year.Year_C_Coder        To "Œæ£ ©£˜ REPORTING"
34243>>>>>>        Set Field_Label_Short      Field Year.Year_C_Coder        To "Œæ£ ©£˜ REP"
34244>>>>>>        //Set Field_Options          Field Year.Year_C_Coder        To DD_REQUIRED
34244>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Coder        To (Year_Year_C_Coder_VT(Self))
34244>>>>>>
34244>>>>>>        // Year.Year_Isolfrom
34244>>>>>>        Set Field_Label_Long       Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
34245>>>>>>        Set Field_Label_Short      Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
34246>>>>>>
34246>>>>>>        // Year.Year_Isolto
34246>>>>>>        Set Field_Label_Long       Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
34247>>>>>>        Set Field_Label_Short      Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
34248>>>>>>
34248>>>>>>        // Year.Year_Openfrom
34248>>>>>>        Set Field_Label_Long       Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
34249>>>>>>        Set Field_Label_Short      Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
34250>>>>>>
34250>>>>>>        // Year.Year_Opento
34250>>>>>>        Set Field_Label_Long       Field Year.Year_Opento         To "„šš¨˜­âª „àª"
34251>>>>>>        Set Field_Label_Short      Field Year.Year_Opento         To "„šš¨˜­âª „àª"
34252>>>>>>
34252>>>>>>        // Year.Year_Entrydate
34252>>>>>>        Set Field_Label_Long       Field Year.Year_Entrydate      To "†£œ¨¦£ž¤å˜ „¨š˜©å˜ª"
34253>>>>>>        Set Field_Label_Short      Field Year.Year_Entrydate      To "†£/¤å˜ „¨š˜©å˜ª"
34254>>>>>>
34254>>>>>>        // Year.Year_Dateaa
34254>>>>>>
34254>>>>>>        // Year.Year_Xrhshfrom
34254>>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
34255>>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
34256>>>>>>
34256>>>>>>        // Year.Year_Xrhshto
34256>>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
34257>>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
34258>>>>>>
34258>>>>>>        // Year.Year_Myflimit
34258>>>>>>        Set Field_Label_Long       Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
34259>>>>>>        Set Field_Label_Short      Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
34260>>>>>>
34260>>>>>>        // Year.Year_Numgtypkin
34260>>>>>>        Set Field_Options          Field Year.Year_Numgtypkin     To DD_DISPLAYONLY
34261>>>>>>
34261>>>>>>        // Year.Year_Numgarticl
34261>>>>>>        Set Field_Options          Field Year.Year_Numgarticl     To DD_DISPLAYONLY
34262>>>>>>
34262>>>>>>        // Year.Year_Numgmove
34262>>>>>>        Set Field_Options          Field Year.Year_Numgmove       To DD_DISPLAYONLY
34263>>>>>>
34263>>>>>>        // Year.Year_Numgplan
34263>>>>>>        Set Field_Options          Field Year.Year_Numgplan       To DD_DISPLAYONLY
34264>>>>>>
34264>>>>>>        // Year.Year_Numgformat
34264>>>>>>        Set Field_Options          Field Year.Year_Numgformat     To DD_DISPLAYONLY
34265>>>>>>
34265>>>>>>        // Year.Year_Numgthaa
34265>>>>>>        Set Field_Options          Field Year.Year_Numgthaa       To DD_DISPLAYONLY
34266>>>>>>
34266>>>>>>        // Year.Year_Numgopen
34266>>>>>>        Set Field_Options          Field Year.Year_Numgopen       To DD_DISPLAYONLY
34267>>>>>>
34267>>>>>>        // Year.Year_Numbaxio
34267>>>>>>        Set Field_Options          Field Year.Year_Numbaxio       To DD_DISPLAYONLY
34268>>>>>>
34268>>>>>>        // Year.Year_Numbarticl
34268>>>>>>        Set Field_Options          Field Year.Year_Numbarticl     To DD_DISPLAYONLY
34269>>>>>>
34269>>>>>>        // Year.Year_Numbmove
34269>>>>>>        Set Field_Options          Field Year.Year_Numbmove       To DD_DISPLAYONLY
34270>>>>>>
34270>>>>>>        // Year.Year_Delimiter
34270>>>>>>        Set Status_Help            Field Year.Year_Delimiter      To "ƒ ˜®à¨ ©« ¡æ š ˜ «¦ Š‘ «žª •¨ã©œàª"
34271>>>>>>
34271>>>>>>        // Year.Year_Printer
34271>>>>>>
34271>>>>>>        // Year.Year_Valid_Char
34271>>>>>>
34271>>>>>>    End_Procedure    // Define_Fields
34272>>>>>>
34272>>>>>>    // Field_Defaults:
34272>>>>>>    // This procedure is used to establish default field values.
34272>>>>>>
34272>>>>>>    Procedure Field_Defaults
34273>>>>>>        Forward Send Field_Defaults
34275>>>>>>        //DDB-Generated-Code-Location
34275>>>>>>        //DDB-FieldDefaultStart
34275>>>>>>        //DDB-FieldDefaultEnd
34275>>>>>>        Set Field_Changed_Value   Field Year.Year_Delimiter      To "."
34276>>>>>>        Set Field_Changed_Value   Field Year.Year_Printer        To "LPT1:"
34277>>>>>>        Set Field_Changed_Value   Field Year.Year_Valid_Char     To "1234567890"
34278>>>>>>    End_Procedure    // Field_Defaults
34279>>>>>>
34279>>>>>>End_Class    // Year_DataDictionary
34280>>>>>>//DDB-Selection-pkg-Start
34280>>>>>>
34280>>>>>>Use Sl003.sl         // SL003
INCLUDING FILE: SL003.SL
34280>>>>>>>>//AB/ Project SL003:Year
34280>>>>>>>>//AB/ Object prj is a Lookup_Project
34280>>>>>>>>//AB/     Set ProjectName to "SL003:Year"
34280>>>>>>>>//AB/     Set ProjectFileName to "Sl003.sl"
34280>>>>>>>>
34280>>>>>>>>// Project Object Structure
34280>>>>>>>>//   SL003 is a dbModalPanelSub
34280>>>>>>>>//     Company_DD is a DataDictionary
34280>>>>>>>>//     Branch_DD is a DataDictionary
34280>>>>>>>>//     Year_DD is a DataDictionary
34280>>>>>>>>//     oSelList is a dbListSub
34280>>>>>>>>//     oOK_bn is a ButtonSub
34280>>>>>>>>//     oCancel_bn is a ButtonSub
34280>>>>>>>>//     oSearch_bn is a ButtonSub
34280>>>>>>>>
34280>>>>>>>>// Register all objects
34280>>>>>>>>Register_Object Branch_DD
34280>>>>>>>>Register_Object Company_DD
34280>>>>>>>>Register_Object oCancel_bn
34280>>>>>>>>Register_Object oOK_bn
34280>>>>>>>>Register_Object oSearch_bn
34280>>>>>>>>Register_Object oSelList
34280>>>>>>>>Register_Object SL003
34280>>>>>>>>Register_Object Year_DD
34280>>>>>>>>
34280>>>>>>>>
34280>>>>>>>>//AB-IgnoreStart
34280>>>>>>>>
34280>>>>>>>>Use DFAllEnt.pkg
34280>>>>>>>>Use dbList.Sub
34280>>>>>>>>Use Button.Sub
34280>>>>>>>>
34280>>>>>>>>
34280>>>>>>>>Use COMPANY.DD
34280>>>>>>>>Use BRANCH.DD
34280>>>>>>>>Use YEAR.DD
34280>>>>>>>>
34280>>>>>>>>//AB-IgnoreEnd
34280>>>>>>>>
34280>>>>>>>>CD_Popup_Object SL003 is a dbModalPanelSub
34299>>>>>>>>
34299>>>>>>>>    //AB-StoreTopStart
34299>>>>>>>>    Property String psFragmaCompanyCode  ""
34301>>>>>>>>    Property String psFragmaBranchCode   ""
34303>>>>>>>>    property integer pifragmaactive public 0
34305>>>>>>>>    //AB-StoreTopEnd
34305>>>>>>>>
34305>>>>>>>>    Set Minimize_Icon to FALSE
34306>>>>>>>>    Set Label to "•¨ã©œ ª"
34307>>>>>>>>    Set Size to 149 449
34308>>>>>>>>    Set Location to 4 7
34309>>>>>>>>    Set Exit_Application_Local_State to FALSE
34310>>>>>>>>    Set Modal_State to FALSE
34311>>>>>>>>
34311>>>>>>>>    //AB-DDOStart
34311>>>>>>>>
34311>>>>>>>>    Object Company_DD is a Company_DataDictionary
34313>>>>>>>>    End_Object    // Company_DD
34314>>>>>>>>
34314>>>>>>>>    Object Branch_DD is a Branch_DataDictionary
34316>>>>>>>>        Set DDO_Server to (Company_DD(self))
34317>>>>>>>>    End_Object    // Branch_DD
34318>>>>>>>>
34318>>>>>>>>    Object Year_DD is a Year_DataDictionary
34320>>>>>>>>        Set DDO_Server to (Branch_DD(self))
34321>>>>>>>>
34321>>>>>>>>        //AB-StoreStart
34321>>>>>>>>        Procedure OnConstrain
34323>>>>>>>>             String lsCompanyCode lsBranchCode
34324>>>>>>>>             integer iactive
34324>>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
34325>>>>>>>>             get pifragmaactive to iactive
34326>>>>>>>>             If (lsCompanyCode <> "") Begin
34328>>>>>>>>                Get psFragmaBranchCode  to lsBranchCode
34329>>>>>>>>                Constrain Year.Company_Code eq lsCompanyCode
34331>>>>>>>>                If (lsBranchCode <> "") Constrain Year.Branch_code eq lsBranchCode
34335>>>>>>>>             End
34335>>>>>>>>>
34335>>>>>>>>             if (iactive = 0) constrain year.working ne 1
34339>>>>>>>>        End_Procedure // OnConstrain
34340>>>>>>>>        
34340>>>>>>>>        
34340>>>>>>>>        
34340>>>>>>>>        
34340>>>>>>>>        
34340>>>>>>>>        //AB-StoreEnd
34340>>>>>>>>
34340>>>>>>>>    End_Object    // Year_DD
34341>>>>>>>>
34341>>>>>>>>    Set Main_DD to (Year_DD(self))
34342>>>>>>>>    Set Server to (Year_DD(self))
34343>>>>>>>>
34343>>>>>>>>    //AB-DDOEnd
34343>>>>>>>>
34343>>>>>>>>    Object oSelList is a dbListSub
34345>>>>>>>>        Set Main_File to Year.File_Number
34346>>>>>>>>        Set Size to 105 433
34347>>>>>>>>        Set Location to 6 6
34348>>>>>>>>
34348>>>>>>>>        Begin_Row
34351>>>>>>>>            Entry_Item Year.Year_year
34352>>>>>>>>            Entry_Item Company.Company_code
34353>>>>>>>>            Entry_Item Company.Company_name
34354>>>>>>>>            Entry_Item Branch.Branch_code
34355>>>>>>>>            Entry_Item Branch.Branch_name
34356>>>>>>>>        End_Row
34361>>>>>>>>
34361>>>>>>>>        Set Form_Width    item 0 to 36
34362>>>>>>>>        Set Header_Label  item 0 to "•¨ã©ž :          "
34363>>>>>>>>        
34363>>>>>>>>        Set Form_Width    item 1 to 71
34364>>>>>>>>        Set Header_Label  item 1 to "‰à› ¡æª „«˜ ¨å˜ª"
34365>>>>>>>>        
34365>>>>>>>>        Set Form_Width    item 2 to 136
34366>>>>>>>>        Set Header_Label  item 2 to "Ž¤¦£˜ „«˜ ¨å˜ª"
34367>>>>>>>>        
34367>>>>>>>>        Set Form_Width    item 3 to 73
34368>>>>>>>>        Set Header_Label  item 3 to "‰à› ¡æª “§¦¡/«¦ª"
34369>>>>>>>>        
34369>>>>>>>>        Set Form_Width    item 4 to 109
34370>>>>>>>>        Set Header_Label  item 4 to "Ž¤¦£˜ “§¦¡/«¦ª"
34371>>>>>>>>        
34371>>>>>>>>
34371>>>>>>>>        //AB-StoreStart
34371>>>>>>>>                                                
34371>>>>>>>>        Property String psStoreFragmaCompanyCode  ""
34373>>>>>>>>        Property String psStoreFragmaBranchCode   ""
34375>>>>>>>>        
34375>>>>>>>>        Procedure Store_Defaults
34377>>>>>>>>            forward send Store_Defaults
34379>>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
34380>>>>>>>>            Set psStoreFragmaBranchCode  to (psFragmaBranchCode(Self))
34381>>>>>>>>        end_Procedure // Store_Defaults
34382>>>>>>>>        
34382>>>>>>>>        Procedure Restore_Defaults
34384>>>>>>>>            forward send Restore_Defaults
34386>>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
34387>>>>>>>>            Set psFragmaBranchCode  to (psStoreFragmaBranchCode(self))
34388>>>>>>>>        end_Procedure // Restore_Defaults
34389>>>>>>>>        
34389>>>>>>>>        Procedure Activating
34391>>>>>>>>            Forward Send Activating
34393>>>>>>>>            Send Rebuild_Constraints to (Year_DD(self))
34394>>>>>>>>        End_Procedure // Activating
34395>>>>>>>>        
34395>>>>>>>>        
34395>>>>>>>>        
34395>>>>>>>>        //AB-StoreEnd
34395>>>>>>>>
34395>>>>>>>>    End_Object    // oSelList
34396>>>>>>>>
34396>>>>>>>>    Object oOK_bn is a ButtonSub
34398>>>>>>>>        Set Label to "&„§ ¢¦šã"
34399>>>>>>>>        Set Location to 112 280
34400>>>>>>>>
34400>>>>>>>>        //AB-StoreStart
34400>>>>>>>>        Procedure OnClick
34402>>>>>>>>            Send OK To (oSelList(current_object))
34403>>>>>>>>        End_Procedure
34404>>>>>>>>        //AB-StoreEnd
34404>>>>>>>>
34404>>>>>>>>    End_Object    // oOK_bn
34405>>>>>>>>
34405>>>>>>>>    Object oCancel_bn is a ButtonSub
34407>>>>>>>>        Set Label to "&€¡ç¨à©ž"
34408>>>>>>>>        Set Location to 112 335
34409>>>>>>>>
34409>>>>>>>>        //AB-StoreStart
34409>>>>>>>>        Procedure OnClick
34411>>>>>>>>            Send Cancel To (oSelList(current_object))
34412>>>>>>>>        End_Procedure
34413>>>>>>>>        //AB-StoreEnd
34413>>>>>>>>
34413>>>>>>>>    End_Object    // oCancel_bn
34414>>>>>>>>
34414>>>>>>>>    Object oSearch_bn is a ButtonSub
34416>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
34417>>>>>>>>        Set Location to 112 390
34418>>>>>>>>
34418>>>>>>>>        //AB-StoreStart
34418>>>>>>>>        Procedure OnClick
34420>>>>>>>>            Send Search To (oSelList(current_object))
34421>>>>>>>>        End_Procedure
34422>>>>>>>>        //AB-StoreEnd
34422>>>>>>>>
34422>>>>>>>>    End_Object    // oSearch_bn
34423>>>>>>>>
34423>>>>>>>>
34423>>>>>>>>    //AB-StoreStart
34423>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
34424>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
34425>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
34426>>>>>>>>    
34426>>>>>>>>    
34426>>>>>>>>    
34426>>>>>>>>    //AB-StoreEnd
34426>>>>>>>>
34426>>>>>>>>CD_End_Object    // SL003
34428>>>>>>>>>
34428>>>>>>>>
34428>>>>>>>>//AB/ End_Object    // prj
34428>>>>>>
34428>>>>>>//DDB-Selection-pkg-End
34428>>>>>>//DDB-FileEnd
34428>>>>
34428>>>>    //AB-IgnoreEnd
34428>>>>
34428>>>>    Object oSelectYear is a dbModalPanelSub
34430>>>>
34430>>>>        //AB-StoreTopStart
34430>>>>
34430>>>>        Property String  psSelectedYearRecr  ''
34432>>>>        Property Integer piChangeState False
34434>>>>
34434>>>>        //AB-StoreTopEnd
34434>>>>
34434>>>>        Set Minimize_Icon to FALSE
34435>>>>        Set Label to "„§ ¢¦šã „«˜ ¨œå˜ª - “§¦¡˜«˜©«ã£˜«¦ª - •¨ã©žª"
34436>>>>        Set Size to 111 372
34437>>>>        Set Location to 60 40
34438>>>>        Set Color to 12232306
34439>>>>        Set Popup_State to TRUE
34440>>>>
34440>>>>        //AB-DDOStart
34440>>>>
34440>>>>        Object Company_DD is a Company_DataDictionary
34442>>>>
34442>>>>            //AB-StoreStart
34442>>>>            Set Foreign_Field_Options DD_KEYFIELD                   to DD_Clear_Field_Options DD_FindReq
34443>>>>            Set Foreign_Field_Options DD_INDEXFIELD                 to DD_Clear_Field_Options DD_FindReq
34444>>>>            Set Foreign_Field_Options Field Company.Company_Name    to DD_DisplayOnly
34445>>>>
34445>>>>
34445>>>>
34445>>>>            //AB-StoreEnd
34445>>>>
34445>>>>        End_Object    // Company_DD
34446>>>>
34446>>>>        Object Branch_DD is a Branch_DataDictionary
34448>>>>            Set DDO_Server to (Company_DD(self))
34449>>>>
34449>>>>            //AB-StoreStart
34449>>>>            Set Foreign_Field_Options DD_KEYFIELD   to DD_Clear_Field_Options DD_FindReq
34450>>>>            Set Foreign_Field_Options DD_INDEXFIELD to DD_Clear_Field_Options DD_FindReq
34451>>>>
34451>>>>            Set Foreign_Field_Options DD_KEYFIELD   to DD_AutoFind_GE
34452>>>>            Set Foreign_Field_Options DD_INDEXFIELD to DD_AutoFind_GE
34453>>>>
34453>>>>            Set Foreign_Field_Options Field Branch.Branch_Name to DD_DisplayOnly
34454>>>>            //AB-StoreEnd
34454>>>>
34454>>>>        End_Object    // Branch_DD
34455>>>>
34455>>>>        Object Year_DD is a Year_DataDictionary
34457>>>>            Set DDO_Server to (Branch_DD(self))
34458>>>>
34458>>>>            //AB-StoreStart
34458>>>>
34458>>>>            Set Field_Options Field Year.Year_Descr to DD_DisplayOnly
34459>>>>            Set Field_Options Field Year.Year_Year to DD_AutoFind_GE
34460>>>>
34460>>>>            Function Validate_Delete Returns Integer
34462>>>>                Function_Return 1
34463>>>>            End_Function
34464>>>>
34464>>>>            //AB-StoreEnd
34464>>>>
34464>>>>        End_Object    // Year_DD
34465>>>>
34465>>>>        Set Main_DD to (Year_DD(self))
34466>>>>        Set Server to (Year_DD(self))
34467>>>>
34467>>>>        //AB-DDOEnd
34467>>>>
34467>>>>        Object Company_Company_Code is a dbFormSub
34469>>>>            Entry_Item Company.Company_code
34470>>>>            Set Size to 13 71
34471>>>>            Set Location to 9 112
34472>>>>            Set Label_Col_Offset to 2
34473>>>>            Set Label_Justification_Mode to jMode_Right
34474>>>>            Set Prompt_Button_Mode to pb_PromptOn
34475>>>>            Set Auto_Clear_Deo_State to FALSE
34476>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34477>>>>
34477>>>>            //AB-StoreStart
34477>>>>
34477>>>>            Set Prompt_Object to (sl001(Self))
34478>>>>
34478>>>>
34478>>>>            //AB-StoreEnd
34478>>>>
34478>>>>        End_Object    // Company_Company_Code
34479>>>>
34479>>>>        Object Company_Company_Name is a dbFormSub
34481>>>>            Entry_Item Company.Company_name
34482>>>>            Set Size to 13 168
34483>>>>            Set Location to 9 188
34484>>>>            Set Label_Col_Offset to 2
34485>>>>            Set Label_Justification_Mode to jMode_Right
34486>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34487>>>>
34487>>>>            //AB-StoreStart
34487>>>>
34487>>>>            //AB-StoreEnd
34487>>>>
34487>>>>        End_Object    // Company_Company_Name
34488>>>>
34488>>>>        Object Branch_Branch_Code is a dbFormSub
34490>>>>            Entry_Item Branch.Branch_code
34491>>>>            Set Size to 13 71
34492>>>>            Set Location to 23 112
34493>>>>            Set Label_Col_Offset to 2
34494>>>>            Set Label_Justification_Mode to jMode_Right
34495>>>>            Set Prompt_Button_Mode to pb_PromptOn
34496>>>>            Set Auto_Clear_Deo_State to FALSE
34497>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34498>>>>
34498>>>>            //AB-StoreStart
34498>>>>            Set Prompt_Object to (sl002(Self))
34499>>>>
34499>>>>            Procedure Prompt_CallBack Integer hPrompt
34501>>>>                string lsCompanyCode
34502>>>>                Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
34503>>>>                Set psFragmaCompanyCode of hPrompt to lsCompanyCode
34504>>>>            End_Procedure
34505>>>>
34505>>>>
34505>>>>
34505>>>>
34505>>>>            //AB-StoreEnd
34505>>>>
34505>>>>        End_Object    // Branch_Branch_Code
34506>>>>
34506>>>>        Object Branch_Branch_Name is a dbFormSub
34508>>>>            Entry_Item Branch.Branch_name
34509>>>>            Set Size to 13 168
34510>>>>            Set Location to 23 188
34511>>>>            Set Label_Justification_Mode to jMode_Right
34512>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34513>>>>
34513>>>>            //AB-StoreStart
34513>>>>
34513>>>>
34513>>>>            //AB-StoreEnd
34513>>>>
34513>>>>        End_Object    // Branch_Branch_Name
34514>>>>
34514>>>>        Object Year_Year_Year is a dbFormSub
34516>>>>            Entry_Item Year.Year_year
34517>>>>            Set Size to 13 71
34518>>>>            Set Location to 37 112
34519>>>>            Set Label_Col_Offset to 2
34520>>>>            Set Label_Justification_Mode to jMode_Right
34521>>>>            Set Prompt_Button_Mode to pb_PromptOn
34522>>>>            Set Auto_Clear_Deo_State to FALSE
34523>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34524>>>>
34524>>>>            //AB-StoreStart
34524>>>>            Set Prompt_Object to (sl003(Self))
34525>>>>
34525>>>>            Procedure Prompt_CallBack Integer hPrompt
34527>>>>                String lsCompanyCode lsBranchCode
34528>>>>                integer icheck
34528>>>>                get checked_state of (chkxr(self)) to icheck
34529>>>>                Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
34530>>>>                Get Field_Current_Value of Branch_DD  Field Branch.Branch_Code   to lsBranchCode
34531>>>>                Set psFragmaCompanyCode of hPrompt to lsCompanyCode
34532>>>>                Set psFragmaBranchCode  of hPrompt to lsBranchCode
34533>>>>                set pifragmaactive      of hPrompt to icheck
34534>>>>            End_Procedure
34535>>>>
34535>>>>
34535>>>>
34535>>>>
34535>>>>
34535>>>>
34535>>>>            //AB-StoreEnd
34535>>>>
34535>>>>        End_Object    // Year_Year_Year
34536>>>>
34536>>>>        Object Year_Year_Descr is a dbFormSub
34538>>>>            Entry_Item Year.Year_descr
34539>>>>            Set Size to 13 168
34540>>>>            Set Location to 37 188
34541>>>>            Set Label_Col_Offset to 2
34542>>>>            Set Label_Justification_Mode to jMode_Right
34543>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34544>>>>
34544>>>>            //AB-StoreStart
34544>>>>
34544>>>>            //AB-StoreEnd
34544>>>>
34544>>>>        End_Object    // Year_Year_Descr
34545>>>>
34545>>>>        Object Year_Year_Entrydate is a dbFormSub
34547>>>>            Entry_Item Year.Year_entrydate
34548>>>>            Set Size to 13 71
34549>>>>            Set Location to 52 112
34550>>>>            Set Label_Col_Offset to 2
34551>>>>            Set Label_Justification_Mode to jMode_Right
34552>>>>            Set Auto_Clear_Deo_State to FALSE
34553>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34554>>>>        End_Object    // Year_Year_Entrydate
34555>>>>
34555>>>>        Object oOk_bn is a ButtonSub
34557>>>>            Set Label to "€§¦›¦®ã (F2)"
34558>>>>            Set Size to 17 54
34559>>>>            Set Location to 74 188
34560>>>>            Set Form_FontHeight Item 0 to 14
34561>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34562>>>>
34562>>>>            //AB-StoreStart
34562>>>>
34562>>>>            Procedure OnClick
34564>>>>                Delegate Send AcceptTheValues
34566>>>>            End_Procedure
34567>>>>
34567>>>>
34567>>>>
34567>>>>
34567>>>>            //AB-StoreEnd
34567>>>>
34567>>>>        End_Object    // oOk_bn
34568>>>>
34568>>>>        Object oCancel_bn is a ButtonSub
34570>>>>            Set Label to "„¥¦›¦ª "
34571>>>>            Set Size to 17 54
34572>>>>            Set Location to 74 302
34573>>>>            Set Form_FontHeight Item 0 to 14
34574>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34575>>>>
34575>>>>            //AB-StoreStart
34575>>>>
34575>>>>            Procedure OnClick
34577>>>>               Send Exit_Application to oSelectYear
34578>>>>            End_Procedure
34579>>>>
34579>>>>
34579>>>>
34579>>>>            //AB-StoreEnd
34579>>>>
34579>>>>        End_Object    // oCancel_bn
34580>>>>
34580>>>>        Object otxtCompany is a TextBoxSub
34582>>>>            Set Label to "„«˜ ¨œå˜"
34583>>>>            Set Auto_Size_State to FALSE
34584>>>>            Set Color to 12232306
34585>>>>            Set FontSize to 14 8
34586>>>>            Set Location to 9 10
34587>>>>            Set Size to 10 35
34588>>>>            Set FontWeight to 600
34589>>>>            Set TypeFace to "MS Sans Serif"
34590>>>>            Set Enabled_State to TRUE
34591>>>>        End_Object    // otxtCompany
34592>>>>
34592>>>>        Object otxtBranch is a TextBoxSub
34594>>>>            Set Label to "“§¦¡˜«˜©«ã£˜«˜"
34595>>>>            Set Auto_Size_State to FALSE
34596>>>>            Set Color to 12232306
34597>>>>            Set FontSize to 14 8
34598>>>>            Set Location to 23 10
34599>>>>            Set Size to 10 63
34600>>>>            Set FontWeight to 600
34601>>>>            Set TypeFace to "MS Sans Serif"
34602>>>>            Set Enabled_State to TRUE
34603>>>>        End_Object    // otxtBranch
34604>>>>
34604>>>>        Object otxtYear is a TextBoxSub
34606>>>>            Set Label to "•¨ã©ž :          "
34607>>>>            Set Auto_Size_State to FALSE
34608>>>>            Set Color to 12232306
34609>>>>            Set FontSize to 14 8
34610>>>>            Set Location to 38 10
34611>>>>            Set Size to 10 40
34612>>>>            Set FontWeight to 600
34613>>>>            Set TypeFace to "MS Sans Serif"
34614>>>>            Set Enabled_State to TRUE
34615>>>>        End_Object    // otxtYear
34616>>>>
34616>>>>        Object otxtWorkingDay is a TextBoxSub
34618>>>>            Set Label to "†£/¤å˜ „¨š˜©å˜ª"
34619>>>>            Set Auto_Size_State to FALSE
34620>>>>            Set Color to 12232306
34621>>>>            Set FontSize to 14 8
34622>>>>            Set Location to 52 10
34623>>>>            Set Size to 10 63
34624>>>>            Set FontWeight to 600
34625>>>>            Set TypeFace to "MS Sans Serif"
34626>>>>            Set Enabled_State to TRUE
34627>>>>        End_Object    // otxtWorkingDay
34628>>>>
34628>>>>        Object otxtWorkingDay is a TextBoxSub
34630>>>>            Set Label to "Ž¢œª ¦  ®¨ã©œ ª"
34631>>>>            Set Auto_Size_State to FALSE
34632>>>>            Set Color to 12232306
34633>>>>            Set FontSize to 14 8
34634>>>>            Set Location to 79 9
34635>>>>            Set Size to 10 63
34636>>>>            Set FontWeight to 600
34637>>>>            Set TypeFace to "MS Sans Serif"
34638>>>>            Set Enabled_State to TRUE
34639>>>>        End_Object    // otxtWorkingDay
34640>>>>
34640>>>>        Object chkxr is a CheckBoxSub
34642>>>>            Set Size to 13 22
34643>>>>            Set Location to 79 113
34644>>>>            Set Color to 12232306
34645>>>>        End_Object    // chkxr
34646>>>>
34646>>>>
34646>>>>        //AB-StoreStart
34646>>>>
34646>>>>        On_Key Key_Ctrl+Key_X Send None
34647>>>>        On_Key Key_Alt+Key_X  Send None
34648>>>>
34648>>>>        Function ifSelect_Xrhsh Returns String
34650>>>>            String  lsRecord_id
34651>>>>            Set psSelectedYearRecr to gs_Selected_Year_Recr
34652>>>>            send popup_modal
34653>>>>            Get psSelectedYearRecr to lsRecord_id
34654>>>>            Function_return lsRecord_Id
34655>>>>        End_Function
34656>>>>
34656>>>>        Procedure AcceptTheValues
34658>>>>            Integer iRetVal liYearDD liCompanyDD liBranchDD
34659>>>>            String ldcheck lsYearRecr lsSite sCname sBname sYname sNom1 sNom2 sNom3
34659>>>>            Date ldYearXrhsh_From ldYearXrhsh_To
34659>>>>            Move Year_DD to liYearDD
34660>>>>            Get Field_Current_Value of liYearDD Field Year.Year_EntryDate to ldcheck
34661>>>>            if (ldcheck = "") ;                Get Message_Box "ƒœ¤ œ§ ¢â¥˜«œ ©à©«ã ž£œ¨¦£ž¤å˜." "¨¦©¦®ã" MB_OK MB_ICONWARNING to iRetVal
34664>>>>            else begin
34665>>>>                Get Field_Current_Value of liYearDD Field Year.Year_XrhshFrom   to ldYearXrhsh_From
34666>>>>                Get Field_Current_Value of liYearDD Field Year.Year_XrhshTo     to ldYearXrhsh_To
34667>>>>                if ((ldcheck < ldYearXrhsh_From) or (ldcheck > ldYearXrhsh_To)) ;                    Get Message_Box "†£œ¨/¤å˜ œ¡«éª ¦¨åà¤" "¨¦©¦®ã" MB_OK MB_ICONWARNING to iRetVal
34670>>>>                else begin
34671>>>>                    Move Company_DD to liCompanyDD
34672>>>>                    Move Branch_DD  to liBranchDD
34673>>>>                    Move Year_DD    to liYearDD
34674>>>>                    send Request_Save to liYearDD
34675>>>>                    Get Field_Current_Value of liCompanyDD Field Company.Company_Code to gs_Selected_Company_Code
34676>>>>                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_Code   to gs_Selected_Branch_Code
34677>>>>
34677>>>>                    Get Field_Current_Value of liBranchDD  Field Branch.Beto_Site   to gs_Selected_Beto_Site
34678>>>>
34678>>>>                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_Site   to lsSite
34679>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_Year       to gi_Selected_Year
34680>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_Recr       to lsYearRecr
34681>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_C_Code0    to sNom1
34682>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_C_Code00   to sNom2
34683>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_C_CodeR    to sNom3
34684>>>>
34684>>>>                    Get Field_Current_Value of liCompanyDD Field Company.Company_Name to sCname
34685>>>>                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_name   to sBname
34686>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_Descr      to sYname
34687>>>>
34687>>>>
34687>>>>                    Local String    sCode
34687>>>>                    Local Integer   iBreak
34687>>>>                    Move 0 to iBreak
34688>>>>                    Clear Nomisma
34689>>>>                    Find Gt Nomisma.Recnum
34690>>>>>
34690>>>>                    While ((Found=1) And (iBreak=0))
34694>>>>                        If (Nomisma.Einai_Euro='1') Begin
34696>>>>                            Move 1 to iBreak
34697>>>>                            Move Nomisma.Nomisma_Code to sCode
34698>>>>                        End
34698>>>>>
34698>>>>                        If (Not(iBreak)) Find Gt Nomisma.Recnum
34701>>>>                    Loop
34702>>>>>
34702>>>>                    Move (Trim(sCode)) to sCode
34703>>>>
34703>>>>
34703>>>>                    Reread SysCurXR
34707>>>>                    Move gs_Selected_Company_Code   to SysCurXR.Company_Code
34708>>>>                    Move gs_Selected_beto_site      to SysCurXR.beto_site
34709>>>>                    Move gs_Selected_Branch_Code    to SysCurXR.Branch_Code
34710>>>>                    Move gi_Selected_Year           to SysCurXR.Year_Year
34711>>>>                    Move lsYearRecr                 to SysCurXR.Year_Recr
34712>>>>                    Move lsSite                     to SysCurXR.Branch_Site
34713>>>>
34713>>>>                    Move sCname                     to SysCurXR.Company_Name
34714>>>>                    Move sBname                     to SysCurXR.Branch_Name
34715>>>>                    Move sYname                     to SysCurXR.Year_Descr
34716>>>>
34716>>>>                    Move ldYearXrhsh_From           to SysCurXr.Year_XrhshFrom
34717>>>>                    Move ldYearXrhsh_To             to SysCurXr.Year_XrhshTo
34718>>>>
34718>>>>                    Move  (Trim(sNom1))             to SysCurXR.C_Code0
34719>>>>                    Move  (Trim(sNom2))             to SysCurXR.C_Code00
34720>>>>                    Move  (Trim(sNom3))             to SysCurXR.C_CodeR
34721>>>>
34721>>>>                    Move sCode                      to SysCurXR.Euro_Code
34722>>>>
34722>>>>                    Saverecord SysCurXR
34723>>>>                    Unlock
34724>>>>>
34724>>>>
34724>>>>                    Move lsYearRecr                 to gs_Selected_Year_Recr
34725>>>>                    Set psSelectedYearRecr          to lsYearRecr
34726>>>>
34726>>>>                    Send Stop_Modal_ui
34727>>>>
34727>>>>                    Set kEnter_Next_State of ghoWorkSpace to TRUE
34728>>>>                End
34728>>>>>
34728>>>>            end
34728>>>>>
34728>>>>        End_Procedure
34729>>>>
34729>>>>        Set Locate_Mode to Center_On_Screen
34730>>>>
34730>>>>        On_Key KCancel      Send KeyAction to (oCancel_Bn(Self))
34731>>>>        On_Key KClose_Panel Send KeyAction to (oCancel_Bn(Self))
34732>>>>        On_Key Ksave_record send KeyAction to (oOK_Bn(Self))
34733>>>>
34733>>>>        On_Key Key_alt+Key_A send KeyAction to (oOK_Bn(Self))
34734>>>>        On_Key Key_alt+Key_Q send KeyAction to (oCancel_Bn(Self))
34735>>>>
34735>>>>
34735>>>>
34735>>>>
34735>>>>
34735>>>>
34735>>>>
34735>>>>        //AB-StoreEnd
34735>>>>
34735>>>>    End_Object    // oSelectYear
34736>>>>
34736>>>>
34736>>>>    //AB-StoreStart
34736>>>>
34736>>>>
34736>>>>    //AB-StoreEnd
34736>>>>
34736>>>>//AB/     End_Object    // prj
34736>>
34736>>Procedure Epelexe_Xrhsh
34737>>    Integer liCompanyDD liBranchDD liYearDD liYear liModalId
34738>>    String lsCompany lsBranch lsWhatXrhsh
34738>>    Move oSelectYear to liModalId
34739>>    Get ifSelect_Xrhsh Of liModalId to lsWhatXrhsh
34740>>    if (Trim(lsWhatXrhsh)='') Send Exit_Application
34743>>End_Procedure
34744>>
34744>>Procedure Allaxe_Xrhsh
34745>>    Integer rVal liModalId iID
34746>>    If (Close_All_Views(Self,True)=0) Begin
34748>>        Move oSelectYear to liModalId
34749>>        Send Epelexe_Xrhsh
34750>>    End
34750>>>
34750>>End_Procedure
34751>>
34751>>On_Key Key_Ctrl+Key_X Send Allaxe_Xrhsh
34752>>On_Key Key_Alt+Key_X  Send Allaxe_Xrhsh
34753>>
34753>>Send Epelexe_Xrhsh
34754>>//------------------------------
34754>>
34754>Set Button_State    of (Wait(Self)) to False
34755>Set BarVisibleState of (Wait(Self)) to '' False
34756>Send Popup                          to (Wait(Self))
34757>Send UpdateWait to (Wait(Self))     '˜¨˜¡˜¢é §œ¨ £â¤œ«œ. „¢œš®¦ª ˜¨®œåà¤ œ­˜¨£¦šãª'
34758>
34758>Use Menu_Sec.Sub
INCLUDING FILE: MENU_SEC.SUB
34758>>>
34758>>>Use Idiotht.pkg
INCLUDING FILE: IDIOTHT.PKG
34758>>>>>
34758>>>>>Open Users
34760>>>>>Open UserGrps
INCLUDING FILE: USERGRPS.FD
34762>>>>>Open Pedia
INCLUDING FILE: PEDIA.FD
34764>>>>>Open Arxeia
INCLUDING FILE: ARXEIA.FD
34766>>>>>Open GrpPedia
INCLUDING FILE: GRPPEDIA.FD
34768>>>>>Open GrpPed0
INCLUDING FILE: GRPPED0.FD
34770>>>>>Open GrpArx
INCLUDING FILE: GRPARX.FD
34772>>>>>Open GrpArx0
INCLUDING FILE: GRPARX0.FD
34774>>>>>Open ViewFlds
INCLUDING FILE: VIEWFLDS.FD
34776>>>>>Open Oth
INCLUDING FILE: OTH.FD
34778>>>>>Open GrpOth
INCLUDING FILE: GRPOTH.FD
34780>>>>>Open GrpOth0
INCLUDING FILE: GRPOTH0.FD
34782>>>>>Open Departm
INCLUDING FILE: DEPARTM.FD
34784>>>>>
34784>>>>>
34784>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
34785>>>>>
34785>>>>>Function Network_User_Name Returns String
34786>>>>>    Local String sName sLength
34787>>>>>    Local Pointer lpName_Addr lpLength_Addr
34787>>>>>    Local Integer iRetval
34787>>>>>    Movestr (Repeat (Character (0), 255)) To sName
34788>>>>>>
34788>>>>>    GetAddress Of sName To lpName_Addr
34789>>>>>    Movestr (DwordToBytes (255)) To sLength
34790>>>>>>
34790>>>>>    GetAddress Of sLength To lpLength_Addr
34791>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
34792>>>>>>
34792>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
34795>>>>>    Else Function_Return "User Unknown"
34797>>>>>End_Function // Network_User_Name
34798>>>>>
34798>>>>>Function fsGetOfficePath Global Returns String
34799>>>>>    String sRegistryKeyPath sRegOfficePath
34800>>>>>    Set_Registry_Root                                                   to HKEY_LOCAL_MACHINE "Software"
34801>>>>>    Move "Microsoft\Office\9.0\Word"                                    to sRegistryKeyPath
34802>>>>>    Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path"    to sRegOfficePath
34806>>>>>    Move (Trim(sRegOfficePath))                                         to sRegOfficePath
34807>>>>>    If (sRegOfficePath='') Begin
34809>>>>>        Move "Microsoft\Office\8.0\Word"                                to sRegistryKeyPath
34810>>>>>        Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34814>>>>>        Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34815>>>>>        If (sRegOfficePath='') Begin
34817>>>>>            Move "Microsoft\Office\7.0\Word"                             to sRegistryKeyPath
34818>>>>>            Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34822>>>>>            Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34823>>>>>            If (sRegOfficePath='') Begin
34825>>>>>                Move "Microsoft\Office\10.0\Word"                                to sRegistryKeyPath
34826>>>>>                Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34830>>>>>                Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34831>>>>>            End
34831>>>>>>
34831>>>>>        End
34831>>>>>>
34831>>>>>    End
34831>>>>>>
34831>>>>>    Function_Return sRegOfficePath
34832>>>>>End_Procedure
34833>>>>>
34833>>>>>
34833>>>>>Function fsGetLastDir Global Returns String
34834>>>>>    String sRegistryKeyPath sRegDir sUserName
34835>>>>>    Get Network_User_Name to sUserName
34836>>>>>
34836>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
34839>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
34842>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
34844>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
34846>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
34847>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
34848>>>>>    Get_profile_string sRegistryKeyPath "Path" to sRegDir
34851>>>>>    Function_Return sRegDir
34852>>>>>End_Procedure
34853>>>>>
34853>>>>>Function fiPutLastDir Global String asDirectory Returns Integer
34854>>>>>    String sRegistryKeyPath sRegDir sUserName
34855>>>>>    Get Network_User_Name to sUserName
34856>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
34859>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
34862>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
34864>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
34866>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
34867>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
34868>>>>>    Set_profile_string sRegistryKeyPath "Path" to asDirectory
34871>>>>>    Function_Return 0
34872>>>>>End_Procedure
34873>>>>>
34873>>>>>
34873>>>>>Function fsVresExt Global String asFileName Returns String
34874>>>>>    String rVal
34875>>>>>    Integer iPos iLen
34875>>>>>    Move (UpperCase(asFileName)) to asFileName
34876>>>>>    Move (Trim(asFileName)) to asFileName
34877>>>>>    Move 0 to iPos
34878>>>>>    For iLen from 1 to (length(asFileName))
34884>>>>>>
34884>>>>>        If (Mid(asFileName,1,iLen)='.') Move iLen to iPos
34887>>>>>    Loop
34888>>>>>>
34888>>>>>    If (Not(iPos)) Function_Return ''
34891>>>>>    Move (Right(asFileName,(Length(asFileName)-iPos))) to rVal
34892>>>>>    Move (Trim(rVal)) to rVal
34893>>>>>    Function_Return rVal
34894>>>>>End_Function
34895>>>>>
34895>>>>>
34895>>>>>Function fiScreenFieldStatus Global String asViewName String asDbFormName Returns Integer
34896>>>>>    Integer rVal iUser iGroup
34897>>>>>    String  sUser sRecr
34897>>>>>    Move (Trim(asViewName))     to asViewName
34898>>>>>    Move (Trim(asDbFormName))   to asDbFormName
34899>>>>>
34899>>>>>    If ((asViewName<>'') And (asDbFormName<>'')) Begin
34901>>>>>        Get fsLoginUserID to sUser
34902>>>>>        Clear Users
34903>>>>>        Move sUser        to Users.Login_ID
34904>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
34905>>>>>>
34905>>>>>        If (Found=1) Begin
34907>>>>>            Move Users.User_ID  to iUser
34908>>>>>            Move Users.Grp_ID   to iGroup
34909>>>>>            Clear GrpOth
34910>>>>>            Move iUser          to GrpOth.User_ID
34911>>>>>            Move asViewName     to GrpOth.View_Name
34912>>>>>            Move asDbFormName   to GrpOth.Scr_Field_Name
34913>>>>>            Find eq GrpOth by Index.2 // GrpOth:Index.2:User_ID+View_Name+Scr_Field_Name
34914>>>>>>
34914>>>>>            If (Found=1) Begin
34916>>>>>                // rVal=1 ==> NO READ ALLOWED
34916>>>>>                // rVal=2 ==> NO EDIT BUT CAN COPY
34916>>>>>                // rVal=3 ==> NO EDIT AND NO COPY
34916>>>>>                If (GrpOth.Allow_Read <>'1') Move 1 to rVal
34919>>>>>                Else Begin
34920>>>>>                    If (GrpOth.Allow_Change<>'1') Begin
34922>>>>>                        If (GrpOth.Allow_Copy<>'1') Move 3 to rVal
34925>>>>>                        Else                        Move 2 to rVal
34927>>>>>                    End
34927>>>>>>
34927>>>>>                End
34927>>>>>>
34927>>>>>            End
34927>>>>>>
34927>>>>>            Else Begin
34928>>>>>                Clear GrpOth0
34929>>>>>                Move iGroup         to GrpOth0.Group_ID
34930>>>>>                Move asViewName     to GrpOth0.View_Name
34931>>>>>                Move asDbFormName   to GrpOth0.Scr_Field_Name
34932>>>>>
34932>>>>>                Find eq GrpOth0 by Index.2 // GrpOth0:Index.2:Group_ID+View_Name+Scr_Field_Name
34933>>>>>>
34933>>>>>                If (Found=1) Begin
34935>>>>>                    // rVal=1 ==> NO READ ALLOWED
34935>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
34935>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
34935>>>>>                    If (GrpOth0.Allow_Read <>'1') Move 1 to rVal
34938>>>>>                    Else Begin
34939>>>>>                        If (GrpOth0.Allow_Change<>'1') Begin
34941>>>>>                            If (GrpOth0.Allow_Copy<>'1') Move 3 to rVal
34944>>>>>                            Else                         Move 2 to rVal
34946>>>>>                        End
34946>>>>>>
34946>>>>>                    End
34946>>>>>>
34946>>>>>                End
34946>>>>>>
34946>>>>>                Else Move 0 to rVal
34948>>>>>            End
34948>>>>>>
34948>>>>>        End
34948>>>>>>
34948>>>>>        Else Move 0 to rVal
34950>>>>>    End
34950>>>>>>
34950>>>>>    Function_Return rVal
34951>>>>>End_Function
34952>>>>>
34952>>>>>Function fiFieldStatus Global Integer aiFileNumber Integer aiFieldNumber Returns Integer
34953>>>>>    Integer rVal iUser iGroup
34954>>>>>    String  sUser sRecr
34954>>>>>    If ((aiFileNumber) And (aiFieldNumber)) Begin
34956>>>>>        Get fsLoginUserID to sUser
34957>>>>>        Clear Users
34958>>>>>        Move sUser        to Users.Login_ID
34959>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
34960>>>>>>
34960>>>>>        If (Found=1) Begin
34962>>>>>            Move Users.User_ID  to iUser
34963>>>>>            Move Users.Grp_ID   to iGroup
34964>>>>>            Clear Pedia
34965>>>>>            Move aiFileNumber  to Pedia.Arxeio_ID
34966>>>>>            Move aiFieldNumber to Pedia.Pedio_Number
34967>>>>>            Find eq Pedia By Index.1 // Pedia:Index.1:Arxeio_ID+Pedio_Number
34968>>>>>>
34968>>>>>            If (Found=1) Begin
34970>>>>>                Move (Trim(Pedia.Pedio_Recr))   to sRecr
34971>>>>>                // Find Combination User/File/Field in GRPPEDIA
34971>>>>>                Clear GrpPedia
34972>>>>>                Move iUser                      to GrpPedia.User_ID
34973>>>>>                Move (Trim(sRecr))              to GrpPedia.Pedio_Recr
34974>>>>>                Find eq GrpPedia by Index.4 // GrpPedia:Index.4:Pedio_Recr + User_ID
34975>>>>>>
34975>>>>>                If (Found=1) Begin
34977>>>>>                    // rVal=1 ==> NO READ ALLOWED
34977>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
34977>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
34977>>>>>                    If (GrpPedia.Allow_Read <>'1') Move 1 to rVal
34980>>>>>                    Else Begin
34981>>>>>                        If (GrpPedia.Allow_Change<>'1') Begin
34983>>>>>                            If (GrpPedia.Allow_Copy<>'1')   Move 3 to rVal
34986>>>>>                            Else                            Move 2 to rVal
34988>>>>>                        End
34988>>>>>>
34988>>>>>                    End
34988>>>>>>
34988>>>>>                End
34988>>>>>>
34988>>>>>                Else Begin
34989>>>>>                    // Find Combination UserGrps/File/Field in GRPPED0
34989>>>>>                    Clear GrpPed0
34990>>>>>                    Move iGroup         to GrpPed0.Group_ID
34991>>>>>                    Move (Trim(sRecr))  to GrpPed0.Pedio_Recr
34992>>>>>                    Find eq GrpPed0 by Index.4 // GrpPed0:Index.4:Pedio_Recr + Group_ID
34993>>>>>>
34993>>>>>                    If (Found=1) Begin
34995>>>>>                        // rVal=1 ==> NO READ ALLOWED
34995>>>>>                        // rVal=2 ==> NO EDIT BUT CAN COPY
34995>>>>>                        // rVal=3 ==> NO EDIT AND NO COPY
34995>>>>>                        If (GrpPed0.Allow_Read <>'1') Move 1 to rVal
34998>>>>>                        Else Begin
34999>>>>>                            If (GrpPed0.Allow_Change<>'1') Begin
35001>>>>>                                If (GrpPed0.Allow_Copy<>'1')   Move 3 to rVal
35004>>>>>                                Else                           Move 2 to rVal
35006>>>>>                            End
35006>>>>>>
35006>>>>>                        End
35006>>>>>>
35006>>>>>                    End
35006>>>>>>
35006>>>>>                End
35006>>>>>>
35006>>>>>            End
35006>>>>>>
35006>>>>>            Else Begin
35007>>>>>                Move 0 to rVal
35008>>>>>            End
35008>>>>>>
35008>>>>>        End
35008>>>>>>
35008>>>>>        Else Begin
35009>>>>>            Move 0 to rVal
35010>>>>>        End
35010>>>>>>
35010>>>>>    End
35010>>>>>>
35010>>>>>    Function_Return rVal
35011>>>>>End_Function
35012>>>>>
35012>>>>>Function fsReturnFileFromPath Global String asFullPath Returns String
35013>>>>>    String rVal lsDirSep
35014>>>>>    Integer iPos iMet iLen iCnt
35014>>>>>    Move (Trim(asFullPath))                 To rVal
35015>>>>>    Move (Sysconf(SYSCONF_DIR_SEPARATOR))   To lsDirSep
35016>>>>>    If (rVal Contains lsDirSep) Begin
35018>>>>>        Move (Length(rVal)) to iLen
35019>>>>>        Move iLen to iCnt
35020>>>>>        While iCnt Gt 0
35024>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Begin
35026>>>>>                If (iCnt=iLen) Function_Return asFullPath
35029>>>>>                Else Function_Return (Right(rVal,(iLen-iCnt)))
35031>>>>>            End
35031>>>>>>
35031>>>>>            Decrement iCnt
35032>>>>>        End // While iCnt Gt 0
35033>>>>>>
35033>>>>>    End
35033>>>>>>
35033>>>>>    Else  Function_Return (Trim(asFullPath))
35035>>>>>    Function_Return rVal
35036>>>>>End_Function
35037>>>>>
35037>>>>>Function fsReturnDirectoriesFromPath Global String asFullPath Returns String
35038>>>>>    String rVal lsDirSep
35039>>>>>    Integer iPos iMet iLen iCnt
35039>>>>>    Move (Trim(asFullPath))                 To rVal
35040>>>>>    Move (Sysconf(SYSCOnF_DIR_SEPARATOR))   To lsDirSep
35041>>>>>    If (rVal Contains lsDirSep) Begin
35043>>>>>        Move (Length(rVal)) to iLen
35044>>>>>        Move iLen to iCnt
35045>>>>>        While iCnt Gt 0
35049>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Function_Return (Left(rVal,iCnt))
35052>>>>>            Decrement iCnt
35053>>>>>        End // While iCnt Gt 0
35054>>>>>>
35054>>>>>    End
35054>>>>>>
35054>>>>>    Function_Return rVal
35055>>>>>End_Function
35056>>>>>
35056>>>>>//Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
35056>>>>>//    Local String rVal lsTmp lsOO lsLL
35056>>>>>//    Local Number lnOO lnLL
35056>>>>>
35056>>>>>//    Move '' to lsOO
35056>>>>>//    Move '' to lsLL
35056>>>>>//    Move '' to rVal
35056>>>>>
35056>>>>>//    Move (Integer(anTime))                              to lnOO
35056>>>>>//    ////////////////////////////////////////////
35056>>>>>//    // sos sos sos jsjsjsjsjs yannis 30/03/2000
35056>>>>>//    //If ((lnOO=24) and (lnll=0)) Move 0 to lnOO
35056>>>>>//    ////////////////////////////////////////////
35056>>>>>
35056>>>>>//    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
35056>>>>>
35056>>>>>//    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
35056>>>>>//    Else         Move (String(lnOO))                    to lsOO
35056>>>>>//    Move (Trim(lsOO))                                   to lsOO
35056>>>>>
35056>>>>>//    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
35056>>>>>//    Else         Move (String(lnLL))                    to lsLL
35056>>>>>//    Move (Trim(lsLL))                                   to lsLL
35056>>>>>
35056>>>>>//    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
35056>>>>>
35056>>>>>//    Move (Trim(rVal)) to rVal
35056>>>>>
35056>>>>>//    Function_Return rVal
35056>>>>>//End_Function
35056>>>>>
35056>>>>>//Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
35056>>>>>//    Local Number rVal nOres nLepta
35056>>>>>//    Move (Integer(aiMinutes/60))    to nOres
35056>>>>>//    Move (    Mod(aiMinutes,60))    to nLepta
35056>>>>>//    Move (nOres+(nLepta/100))       to rVal
35056>>>>>//    Function_Return rVal
35056>>>>>//End_Function
35056>>>>>
35056>>>>>//Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
35056>>>>>//    Local Integer rVal
35056>>>>>//    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
35056>>>>>//    Function_Return rVal
35056>>>>>//End_Function
35056>>>>>
35056>>>>>//Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;
35056>>>>>//                                                                    Number anEndTime    ;
35056>>>>>//                                                                    Returns Integer
35056>>>>>//    Local Integer rVal iMinStart iMinEnd
35056>>>>>
35056>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
35056>>>>>
35056>>>>>//    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
35056>>>>>//    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
35056>>>>>//    Move (iMinEnd-iMinStart)                                                     to rVal
35056>>>>>//    Function_Return rVal
35056>>>>>//End_Function
35056>>>>>
35056>>>>>
35056>>>>>//Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;
35056>>>>>//                                                                Number anEndTime    ;
35056>>>>>//                                                                Returns Number
35056>>>>>//    Local Integer iTmp
35056>>>>>//    Local Number  rVal
35056>>>>>
35056>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
35056>>>>>
35056>>>>>//    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
35056>>>>>//    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
35056>>>>>//    Function_Return rVal
35056>>>>>//End_Function
35056>>>>>
35056>>>>>
35056>>>>>Function fsLoginUserID Global Returns String
35057>>>>>    Local String LastLogin# LoginUserid#
35058>>>>>    get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin#
35061>>>>>    If LastLogin# eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin#
35064>>>>>    insert "WorkSpaces\" in LastLogin# at 1
35066>>>>>    Append LastLogin# "\" (Module_Name(Self)) "\LastLogin"
35069>>>>>    get_profile_string LastLogin# "LoginUserId"  to LoginUserId#
35072>>>>>    Trim LoginUserID# to LoginUserID#
35073>>>>>>
35073>>>>>    If LoginUserId# eq "" Move (Network_User_Name(Current_Object)) to LoginUserId#
35076>>>>>    Function_Return LoginUserID#
35077>>>>>End_Function
35078>>>>>
35078>>>>>Function fiWriteRegistryLastSDFPath Global String asLastPath Returns Integer
35079>>>>>    Integer rVal
35080>>>>>    String  lsCurrentWksp
35080>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35083>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35086>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35088>>>>>    // Œœ¦ ¡¢œ ›   - Last_SDF_Path -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
35088>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
35088>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
35091>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
35094>>>>>    Function_Return rVal
35095>>>>>End_Function
35096>>>>>
35096>>>>>
35096>>>>>Function fsReadRegistryLastSDFPath Global Returns String
35097>>>>>    String rVal lsCurrentWksp
35098>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35101>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35104>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35106>>>>>    // Œœ¦ ¡¢œ ›   - LastParastUsed -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
35106>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
35106>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
35109>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
35112>>>>>    Function_Return (Trim(rVal))
35113>>>>>End_Function
35114>>>>>
35114>>>>>
35114>>>>>Function fiWriteRegistryLastMCryptPath Global String asLastPath Returns Integer
35115>>>>>    Integer rVal
35116>>>>>    String  lsCurrentWksp
35116>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35119>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35122>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35124>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
35127>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
35130>>>>>    Function_Return rVal
35131>>>>>End_Function
35132>>>>>
35132>>>>>
35132>>>>>Function fsReadRegistryLastMCryptPath Global Returns String
35133>>>>>    String rVal lsCurrentWksp
35134>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35137>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35140>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35142>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
35145>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
35148>>>>>    Function_Return (Trim(rVal))
35149>>>>>End_Function
35150>>>>>
35150>>>>>Function fiWriteRegistryLastWEBPath Global String asLastPath Returns Integer
35151>>>>>    Integer rVal
35152>>>>>    String  lsCurrentWksp
35152>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35155>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35158>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35160>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
35163>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
35166>>>>>    Function_Return rVal
35167>>>>>End_Function
35168>>>>>
35168>>>>>
35168>>>>>Function fsReadRegistryLastWEBPath Global Returns String
35169>>>>>    String rVal lsCurrentWksp
35170>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35173>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35176>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35178>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
35181>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
35184>>>>>    Function_Return (Trim(rVal))
35185>>>>>End_Function
35186>>>>>
35186>>>>>Function fsReadRegistryFEMRootDir Global Returns String
35187>>>>>    String rVal lsCurrentWksp
35188>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35191>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35194>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35196>>>>>    Append lsCurrentWksp "\FEM"
35197>>>>>    Get_Profile_String lsCurrentWksp "RootDir"  to rVal
35200>>>>>    Function_Return (Trim(rVal))
35201>>>>>End_Function
35202>>>>>
35202>>>>>Function fsReadRegistryFEMDevicePath Global Returns String
35203>>>>>    String rVal lsCurrentWksp
35204>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35207>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35210>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35212>>>>>    Append lsCurrentWksp "\FEM"
35213>>>>>    Get_Profile_String lsCurrentWksp "DevicePath"  to rVal
35216>>>>>    Function_Return (Trim(rVal))
35217>>>>>End_Function
35218>>>>>
35218>>>>>Function fiWriteRegistryFEMRootDir Global Returns Integer
35219>>>>>    Integer rVal
35220>>>>>    String  lsCurrentWksp
35220>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35223>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35226>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35228>>>>>    Append lsCurrentWksp "\FEM"
35229>>>>>    Set_Profile_String lsCurrentWksp "RootDir"  to "C:\FEM_ROOT\"
35232>>>>>    Function_Return rVal
35233>>>>>End_Function
35234>>>>>
35234>>>>>Function fiWriteRegistryFEMDevicePath Global Returns Integer
35235>>>>>    Integer rVal
35236>>>>>    String  lsCurrentWksp
35236>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35239>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35242>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35244>>>>>    Append lsCurrentWksp "\FEM"
35245>>>>>    Set_Profile_String lsCurrentWksp "DevicePath"  to "C:\FEM_ROOT\Device_File1.dat"
35248>>>>>    Function_Return rVal
35249>>>>>End_Function
35250>>>>>
35250>>>>>
35250>>>>>
35250>>>>>
35250>>>>>
35250>>>>>Function fig_Is_Admin Global Returns Integer
35251>>>>>    String sUser
35252>>>>>    Integer rVal
35252>>>>>    Get fsLoginUserID to sUser
35253>>>>>    Move (trim(sUser)) to sUser
35254>>>>>    Clear Users
35255>>>>>    Move sUser to Users.Login_ID
35256>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35257>>>>>>
35257>>>>>    Move Users.Admin_Rights to rVal
35258>>>>>    Function_Return rVal
35259>>>>>End_Function
35260>>>>>
35260>>>>>Function fig_The_User_Group Global Returns Integer
35261>>>>>    String sUser
35262>>>>>    Get fsLoginUserID   to sUser
35263>>>>>    Move (trim(sUser))  to sUser
35264>>>>>    Clear Users
35265>>>>>    Move sUser          to Users.Login_ID
35266>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35267>>>>>>
35267>>>>>    Clear UserGrps
35268>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
35269>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
35270>>>>>>
35270>>>>>    Function_Return UserGrps.Grp_ID
35271>>>>>End_Function
35272>>>>>
35272>>>>>Function fsg_The_User_Department Global Returns String
35273>>>>>    String sUser
35274>>>>>    Get fsLoginUserID   to sUser
35275>>>>>    Move (trim(sUser))  to sUser
35276>>>>>    Clear Users
35277>>>>>    Move sUser          to Users.Login_ID
35278>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35279>>>>>>
35279>>>>>    Clear Departm
35280>>>>>    Move Users.Departm_Code   to Departm.Code
35281>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
35282>>>>>>
35282>>>>>    Function_Return Departm.Code
35283>>>>>End_Function
35284>>>>>
35284>>>>>
35284>>>>>Function fig_Is_Specific_Admin Global String asUser Returns Integer
35285>>>>>    Integer rVal
35286>>>>>    Move (trim(asUser)) to asUser
35287>>>>>    Clear Users
35288>>>>>    Move asUser to Users.Login_ID
35289>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35290>>>>>>
35290>>>>>    Move Users.Admin_Rights to rVal
35291>>>>>    Function_Return rVal
35292>>>>>End_Function
35293>>>>>
35293>>>>>Function fig_The_Specific_User_Group Global String asUser Returns Integer
35294>>>>>    Move (trim(asUser))  to asUser
35295>>>>>    Clear Users
35296>>>>>    Move asUser          to Users.Login_ID
35297>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35298>>>>>>
35298>>>>>    Clear UserGrps
35299>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
35300>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
35301>>>>>>
35301>>>>>    Function_Return UserGrps.Grp_ID
35302>>>>>End_Function
35303>>>>>
35303>>>>>Function fsg_The_Specific_User_Department Global String asUser Returns String
35304>>>>>    Move (trim(asUser))  to asUser
35305>>>>>    Clear Users
35306>>>>>    Move asUser          to Users.Login_ID
35307>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35308>>>>>>
35308>>>>>    Clear Departm
35309>>>>>    Move Users.Departm_Code   to Departm.Code
35310>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
35311>>>>>>
35311>>>>>    Function_Return Departm.Code
35312>>>>>End_Function
35313>>>>>
35313>>>>>
35313>>>
35313>>>Class ViewPopupMenu_Sec Is A ViewPopupMenu
35314>>>
35314>>>    Open Sysfile
INCLUDING FILE: SYSFILE.FD
35316>>>    Open Users
35318>>>    Open Views
INCLUDING FILE: VIEWS.FD
35320>>>    Open GrpViews
INCLUDING FILE: GRPVIEWS.FD
35322>>>    Open GrpView0
INCLUDING FILE: GRPVIEW0.FD
35324>>>    Open Arxeia
35326>>>    Open GrpArx
35328>>>
35328>>>    Function Find_User_Rights_In_Class String asView Returns Integer
35329>>>        String  lsView lsLogin
35330>>>        Integer liUser  liViews iGroup
35330>>>
35330>>>        Move (fsLoginUserID())      to lsLogin
35331>>>        Move (Trim(ToOEM(asView)))  to lsView
35332>>>
35332>>>        //////  /////////////////////////////////////
35332>>>        Clear Users
35333>>>        Move lsLogin    to Users.Login_ID
35334>>>
35334>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
35335>>>>
35335>>>        If (Found=1)  Begin
35337>>>            Move Users.User_ID  to liUser
35338>>>            Move Users.Grp_ID   to iGroup
35339>>>        End
35339>>>>
35339>>>        Else Function_Return 0
35341>>>
35341>>>        Clear Views
35342>>>        Move (Trim(lsView)) to Views.Menu_Name
35343>>>        Find eq Views by Index.2 // Views:Index.2:Views.Menu_Name
35344>>>>
35344>>>        If (Found=1) Begin
35346>>>            Move Views.View_ID to liViews
35347>>>            Clear GrpViews
35348>>>            Move liUser    to GrpViews.User_ID
35349>>>            Move liViews   to GrpViews.View_ID
35350>>>            Find Eq GrpViews by Index.1 // GrpViews:Index.1:GrpViews.User_ID+GrpViews.View_ID
35351>>>>
35351>>>            If (Found=1) Begin // And (liUser=GrpViews.User_ID) And (liViews=GrpViews.View_ID)) Begin
35353>>>                Function_Return (GrpViews.Allow_Read<>'1')
35354>>>            End
35354>>>>
35354>>>            Else Begin
35355>>>                Clear GrpView0
35356>>>                Move iGroup    to GrpView0.Group_ID
35357>>>                Move liViews   to GrpView0.View_ID
35358>>>                Find eq GrpView0 by Index.1 // GrpView0:Index.1:Group_ID+View_ID
35359>>>>
35359>>>                If (Found=1) Begin
35361>>>                    Function_Return (GrpView0.Allow_Read<>'1')
35362>>>                End
35362>>>>
35362>>>                Else         Function_Return 0
35364>>>            End
35364>>>>
35364>>>        End
35364>>>>
35364>>>        Else Function_Return 0
35366>>>    End_Function
35367>>>
35367>>>//    Procedure Enhmerose_Views_File_In_Class
35367>>>//        Integer liCount liInt liLastNo
35367>>>//        String lsStr
35367>>>//        Get Item_Count to liCount
35367>>>//        // find last view_id
35367>>>//        Clear Views
35367>>>//        Move 9999 to Views.View_ID
35367>>>//        Find lt Views by index.1 // view_id
35367>>>//        If (Found=1)    Move Views.View_ID  to liLastNo
35367>>>//        Else            Move 0              to liLastNo
35367>>>//        For liInt From 0 to (liCount-1)
35367>>>//            Get Value item liInt to lsStr
35367>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
35367>>>//            //Move (Trim(lsStr)) to lsStr
35367>>>//            If (lsStr<>'') Begin
35367>>>//                Clear Views
35367>>>//                Move lsStr to Views.Menu_Name
35367>>>//                Find eq Views by index.2 // Views.Menu_Name
35367>>>//                If (NOT(Found)) Begin
35367>>>//                    Add 1 to liLastNo
35367>>>//                    Move liLastNo to Views.View_ID
35367>>>//                    Saverecord Views
35367>>>//                End
35367>>>//            End
35367>>>//        Loop
35367>>>//        For liInt From 0 to (liCount-1)
35367>>>//            Get Value item liInt to lsStr
35367>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
35367>>>//            //Move (Trim(lsStr)) to lsStr
35367>>>//            If (lsStr<>'') Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
35367>>>//        Loop
35367>>>//    End_procedure
35367>>>
35367>>>    Procedure OnInitMenu
35368>>>        Integer liCount liInt liLastNo
35369>>>        String lsStr
35369>>>
35369>>>        Get Item_Count to liCount
35370>>>
35370>>>        // find last view_id
35370>>>        Clear Views
35371>>>        Move 9999 to Views.View_ID
35372>>>        Find lt Views by index.1 // view_id
35373>>>>
35373>>>        If (Found=1)    Move Views.View_ID  to liLastNo
35376>>>        Else            Move 0              to liLastNo
35378>>>        For liInt From 0 to (liCount-1)
35384>>>>
35384>>>            Get Value item liInt to lsStr
35385>>>            Move (Trim(lsStr)) to lsStr
35386>>>            If ((lsStr<>'') and (Length(lsStr)>2)) Begin
35388>>>                Clear Views
35389>>>                Move (ToOEM(lsStr)) to Views.Menu_Name
35390>>>                Find eq Views by index.2 // Views.Menu_Name
35391>>>>
35391>>>                If (NOT(Found)) Begin
35393>>>                    Add 1 to liLastNo
35394>>>                    Move liLastNo to Views.View_ID
35395>>>                    //Move (ToOEM(lsStr)) to Views.Menu_Name
35395>>>                    Saverecord Views
35396>>>                End
35396>>>>
35396>>>            End
35396>>>>
35396>>>        Loop
35397>>>>
35397>>>        For liInt From 0 to (liCount-1)
35403>>>>
35403>>>            Get Value item liInt to lsStr
35404>>>            Move (Trim(lsStr)) to lsStr
35405>>>            Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
35406>>>        Loop
35407>>>>
35407>>>
35407>>>    End_procedure
35408>>>
35408>>>//    Procedure End_Construct_Object
35408>>>//        Forward Send End_Construct_Object
35408>>>//        Send Enhmerose_Views_File_In_Class
35408>>>//    End_Procedure
35408>>>
35408>>>End_Class //ButtonSub
35409>>>
35409>>>
35409>
35409>//------------------------------
35409>Use Flexole
INCLUDING FILE: FLEXOLE.PKG
35409>>>//****************************************************************************
35409>>>//
35409>>>// $File name  : FlexOLE
35409>>>// $File title : Base class for OLE Automation in DataFlex under win95/NT
35409>>>// Notice      : Copyright (c) ADB-UTVECKLING AB 1996-1998
35409>>>// $Author     : JW, SF
35409>>>// $System     : DFOLE
35409>>>// Created     : 96-05-30 @ 18.12.51
35409>>>// $Last Rev   : 96-10-09 @ 14.59.35
35409>>>//
35409>>>// $Description
35409>>>// This file contains the complete FlexOLE OLE2 implementation in DataFlex.
35409>>>// Including all DLL interface declarations and DataFlex classes
35409>>>//
35409>>>// $Rev History
35409>>>//   96-05-30 File header created
35409>>>//
35409>>>//****************************************************************************
35409>>>
35409>>>USE DLL
35409>>>USE FOLE_API
INCLUDING FILE: FOLE_API.PKG
35409>>>>>//****************************************************************************
35409>>>>>//
35409>>>>>// $File name  : FOLE_API
35409>>>>>// $File title : API for FlexOLE
35409>>>>>// Notice      : Copyright (c) ADB-UTVECKLING AB 1996-1998
35409>>>>>// $Author     : JW, SF
35409>>>>>// $System     : FlexOLE
35409>>>>>// Created     : 96-05-30 @ 18.12.51
35409>>>>>// $Last Rev   : 96-10-09 @ 14.59.35
35409>>>>>//
35409>>>>>// $Description
35409>>>>>//  DLL interface declarations
35409>>>>>//
35409>>>>>// $Rev History
35409>>>>>//   96-05-30 File header created
35409>>>>>//
35409>>>>>//****************************************************************************
35409>>>>>
35409>>>>>
35409>>>>>USE DLL
35409>>>>>
35409>>>>>// Global variable for OLE
35409>>>>>Integer WM_DFOCXEVENT // This is the message sent from the DLL
35409>>>>>Integer WM_DFOCXNOTIFYEVENT // This is the notify message sent from the DLL
35409>>>>>
35409>>>>>//Global integer for objectId
35409>>>>>Integer oOLEVariantId
35409>>>>>
35409>>>>>
35409>>>>>
35409>>>>>// Optional param for OLEVariant.
35409>>>>>// For optional parameters, pass OLE_VT_OPTIONAL instead of an OLEVariant
35409>>>>>
35409>>>>>// DISP_E_PARAMNOTFOUND is the constant used together with OLE_VT_ERROR
35409>>>>>// to signify that this parameter is optional and not specified.
35409>>>>>// It is only used internally, DON'T use it directly, see above constant.
35409>>>>>
35409>>>>>// The current maximum size of strings, used both for String and OLEVariant with OLE_VT_BSTR
35409>>>>>
35409>>>>>// Null terminating for C strings
35409>>>>>
35409>>>>>// Alias data types
35409>>>>>                            // but since DataFlex has no substitute data type
35409>>>>>                            // it is internally casted back and forth
35409>>>>>                            // into an Integer
35409>>>>>                            // NOTE! Might be changed to a one char string
35409>>>>>
35409>>>>>
35409>>>>>
35409>>>>>// Pointers to vars needs to be inside a Type to use GetAddress...
35409>>>>>// It looks like we have to create these anyway (to compile cleanly)
35409>>>>>
35409>>>>>
35409>>>>>Type TP_OLEVariant
35409>>>>>    Field Variant.vt     as DWORD      // An OLE_VT_XXX constant
35409>>>>>    Field Variant.iVal   as DWORD      // If vt is OLE_VT_I2 this field contains a Short value
35409>>>>>    Field Variant.lVal   as DWORD      // If vt is OLE_VT_I4 this field contains an Integer value
35409>>>>>    Field Variant.fltVal as Char 10    // If vt is OLE_VT_R4 this field contains a ShortReal value
35409>>>>>    Field Variant.dblVal as Char 20    // If vt is OLE_VT_R8 this field contains a Real value
35409>>>>>    Field Variant.cyVal  as Char 25    // If vt is OLE_VT_CY this field contains a Currency value
35409>>>>>    Field Variant.dtVal  as Date       // If vt is OLE_VT_DATE this field contains a Date value
35409>>>>>    Field Variant.strVal as Char 255   // If vt is OLE_VT_BSTR this field contains a pointer to a String
35409>>>>>    Field Variant.dspVal as LPDISPATCH // If vt is OLE_VT_DISPATCH this field contains an LPDISPATCH
35409>>>>>    Field Variant.errVal as OLEError   // If vt is OLE_VT_ERROR this field contains an OLEError
35409>>>>>    Field Variant.blVal  as Bool       // If vt is OLE_VT_BOOL this field contains a Bool value
35409>>>>>    Field Variant.uknVal as LPIUNKNOWN // If vt is OLE_VT_UNKNOWN this field contains an LPIUnknown
35409>>>>>    Field Variant.ui1Val as DWORD      // If vt is OLE_VT_UI1 this field contains a UChar value
35409>>>>>End_Type
35409>>>>>
35409>>>>>
35409>>>>>// VARIANT constants used with the vt field in an OLEVariant type
35409>>>>>
35409>>>>>
35409>>>>>
35409>>>>>// SetFocus/KillFocus event, sent in wParam of WM_DFOCXNOTIFYEVENT
35409>>>>>
35409>>>>>// Used to register the OCX event notification messages
35409>>>>>External_Function32 RegisterWindowMessage "RegisterWindowMessageA" USER32.DLL;                    String sWM_MSG;                    Returns Integer
35410>>>>>
35410>>>>>// External functions providing access to DFOLECLN.DLL
35410>>>>>// These functions are normally not accessed directly, they are
35410>>>>>// rather accessed through an Automation_Client/OCX_Client derived class/object
35410>>>>>
35410>>>>>//********DLL Interface OLE Auto General Functions************
35410>>>>>
35410>>>>>External_Function32 CreateAutomationClient "CreateAutomationClient" DFOLECLN.DLL;                    Returns DWORD
35411>>>>>
35411>>>>>
35411>>>>>External_Function32 DestroyAutomationClient "DestroyAutomationClient" DFOLECLN.DLL;                    Integer clientId;                    Returns DWORD
35412>>>>>
35412>>>>>External_Function32 CreateAutoClientDispatch "CreateAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    String progIdStr;                    Returns DWORD
35413>>>>>
35413>>>>>External_Function32 AttachAutoClientDispatch "AttachAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    LPDispatch disp;                    Integer addRef;                    Returns DWORD
35414>>>>>
35414>>>>>External_Function32 AttachAutoClientActiveObject "AttachAutoClientActiveObject" DFOLECLN.DLL;                    Integer clientId;                    String progIdStr;                    Returns DWORD
35415>>>>>
35415>>>>>External_Function32 ReleaseAutoClientDispatch "ReleaseAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    Returns DWORD
35416>>>>>
35416>>>>>External_Function32 GetAutoClientDispatch "GetAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    Returns LPDispatch
35417>>>>>
35417>>>>>//********DLL Interface OLE Auto Get Property Functions**************
35417>>>>>
35417>>>>>External_Function32 GetAutoClientBoolProperty "GetAutoClientBoolProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
35418>>>>>
35418>>>>>External_Function32 GetAutoClientCurrencyProperty "GetAutoClientCurrencyProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
35419>>>>>
35419>>>>>External_Function32 GetAutoClientDateProperty "GetAutoClientDateProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Date
35420>>>>>
35420>>>>>External_Function32 GetAutoClientLPDispatchProperty "GetAutoClientLPDispatchProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns LPDispatch
35421>>>>>
35421>>>>>External_Function32 GetAutoClientRealProperty "GetAutoClientRealProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
35422>>>>>
35422>>>>>External_Function32 GetAutoClientShortRealProperty "GetAutoClientShortRealProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Real
35423>>>>>
35423>>>>>External_Function32 GetAutoClientIntegerProperty "GetAutoClientIntegerProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
35424>>>>>
35424>>>>>External_Function32 GetAutoClientShortProperty "GetAutoClientShortProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Integer
35425>>>>>
35425>>>>>
35425>>>>>External_Function32 GetAutoClientStringProperty "GetAutoClientStringProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns DWORD
35426>>>>>
35426>>>>>External_Function32 GetAutoClientOLEVariantProperty "GetAutoClientOLEVariantProperty" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    LPOLEVar destVar;                    Returns  LPOLEVar
35427>>>>>
35427>>>>>
35427>>>>>//********DLL Interface OLE Auto Set Property Functions**************
35427>>>>>
35427>>>>>External_Function32 SetAutoClientBoolProperty "SetAutoClientBoolProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    DWORD    prop;                    Returns DWORD
35428>>>>>
35428>>>>>External_Function32 SetAutoClientCurrencyProperty "SetAutoClientCurrencyProperty" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    String prop;                    Returns  DWORD
35429>>>>>
35429>>>>>External_Function32 SetAutoClientDateProperty "SetAutoClientDateProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Date    prop;                    Returns DWORD
35430>>>>>
35430>>>>>External_Function32 SetAutoClientLPDispatchProperty "SetAutoClientLPDispatchProperty" DFOLECLN.DLL;                    Integer    clientId;                    DWORD    dwDispId;                    LPDispatch prop;                    Returns    DWORD
35431>>>>>
35431>>>>>External_Function32 SetAutoClientRealProperty "SetAutoClientRealProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    String   prop;                    Returns DWORD
35432>>>>>
35432>>>>>External_Function32 SetAutoClientShortRealProperty "SetAutoClientShortRealProperty" DFOLECLN.DLL;                    Integer   clientId;                    DWORD   dwDispId;                    String prop;                    Returns   DWORD
35433>>>>>
35433>>>>>External_Function32 SetAutoClientIntegerProperty "SetAutoClientIntegerProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    DWORD prop;                    Returns DWORD
35434>>>>>
35434>>>>>External_Function32 SetAutoClientShortProperty "SetAutoClientShortProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Integer   prop;                    Returns DWORD
35435>>>>>
35435>>>>>External_Function32 SetAutoClientStringProperty "SetAutoClientStringProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    String  prop;                    Returns DWORD
35436>>>>>
35436>>>>>External_Function32 SetAutoClientOLEVariantProperty "SetAutoClientOLEVariantProperty" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    String prop;                    Returns  DWORD
35437>>>>>
35437>>>>>
35437>>>>>//******DLL Interface OLE Auto Pre Invoke Functions**************
35437>>>>>
35437>>>>>External_Function32 DeclareAutoClientInvokeParams "DeclareAutoClientInvokeParams" DFOLECLN.DLL;                    Integer clientId;                    DWORD nrOfParams;                    Returns DWORD
35438>>>>>
35438>>>>>External_Function32 DefineAutoClientBoolParam "DefineAutoClientBoolParam" DFOLECLN.DLL;                    Integer clientId;                    DWORD    param;                    Returns DWORD
35439>>>>>
35439>>>>>External_Function32 DefineAutoClientCurrencyParam "DefineAutoClientCurrencyParam" DFOLECLN.DLL;                    Integer clientId;                    String  param;                    Returns DWORD
35440>>>>>
35440>>>>>External_Function32 DefineAutoClientDateParam "DefineAutoClientDateParam" DFOLECLN.DLL;                    Integer clientId;                    Date    param;                    Returns DWORD
35441>>>>>
35441>>>>>External_Function32 DefineAutoClientRealParam "DefineAutoClientRealParam" DFOLECLN.DLL;                    Integer clientId;                    String    param;                    Returns DWORD
35442>>>>>
35442>>>>>External_Function32 DefineAutoClientShortRealParam "DefineAutoClientShortRealParam" DFOLECLN.DLL;                    Integer   clientId;                    String param;                    Returns   DWORD
35443>>>>>
35443>>>>>External_Function32 DefineAutoClientIntegerParam "DefineAutoClientIntegerParam" DFOLECLN.DLL;                    Integer clientId;                    DWORD param;                    Returns DWORD
35444>>>>>
35444>>>>>External_Function32 DefineAutoClientShortParam "DefineAutoClientShortParam" DFOLECLN.DLL;                    Integer clientId;                    Integer   param;                    Returns DWORD
35445>>>>>
35445>>>>>External_Function32 DefineAutoClientLPDispatchParam "DefineAutoClientLPDispatchParam" DFOLECLN.DLL;                    Integer clientId;                    LPDispatch param;                    Returns DWORD
35446>>>>>
35446>>>>>External_Function32 DefineAutoClientStringParam "DefineAutoClientStringParam" DFOLECLN.DLL;                    Integer clientId;                    String  param;                    Returns DWORD
35447>>>>>
35447>>>>>External_Function32 DefineAutoClientOLEVariantParam "DefineAutoClientOLEVariantParam" DFOLECLN.DLL;                    Integer  clientId;                    OLEVariant param;                    Returns  DWORD
35448>>>>>
35448>>>>>//********DLL Interface OLE Auto Invoke Functions*********************
35448>>>>>
35448>>>>>External_Function32 InvokeAutoClientVoidFunction "InvokeAutoClientVoidFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
35449>>>>>
35449>>>>>External_Function32 InvokeAutoClientBoolFunction "InvokeAutoClientBoolFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
35450>>>>>
35450>>>>>External_Function32 InvokeAutoClientCurrencyFunction "InvokeAutoClientCurrencyFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
35451>>>>>
35451>>>>>External_Function32 InvokeAutoClientDateFunction "InvokeAutoClientDateFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Date
35452>>>>>
35452>>>>>External_Function32 InvokeAutoClientLPDispatchFunction "InvokeAutoClientLPDispatchFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns LPDispatch
35453>>>>>
35453>>>>>External_Function32 InvokeAutoClientRealFunction "InvokeAutoClientRealFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
35454>>>>>
35454>>>>>External_Function32 InvokeAutoClientShortRealFunction "InvokeAutoClientShortRealFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
35455>>>>>
35455>>>>>External_Function32 InvokeAutoClientIntegerFunction "InvokeAutoClientIntegerFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
35456>>>>>
35456>>>>>External_Function32 InvokeAutoClientShortFunction "InvokeAutoClientShortFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Integer
35457>>>>>
35457>>>>>External_Function32 InvokeAutoClientStringFunction "InvokeAutoClientStringFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer  destStr;                    Returns Integer
35458>>>>>
35458>>>>>
35458>>>>>External_Function32 InvokeAutoClientOLEVariantFunction "InvokeAutoClientOLEVariantFunction" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    LPOLEVar destVar;                    Returns  Integer
35459>>>>>
35459>>>>>//********DLL Interface OLE Control Functions*********************
35459>>>>>
35459>>>>>
35459>>>>>External_Function32 CreateOCXClient "CreateOCXClient" DFOLECLN.DLL;                    Returns Integer
35460>>>>>
35460>>>>>
35460>>>>>External_Function32 CreateOCXControl "CreateOCXControl" DFOLECLN.DLL;                    Integer iCId;                    Pointer pPar;                    String  sCId;                    String  sCap;                    Dword   wSty;                    String  sLic;                    String  sFile;                    Returns Integer
35461>>>>>
35461>>>>>External_Function32 DestroyOCXControl "DestroyOCXControl" DFOLECLN.DLL;                    Integer iClientId;                    Returns Integer
35462>>>>>
35462>>>>>External_Function32 GetOCXEventBoolParam "GetOCXEventBoolParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Integer
35463>>>>>
35463>>>>>External_Function32 GetOCXEventCurrencyParam "GetOCXEventCurrencyParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer destStr;                    Returns Integer
35464>>>>>
35464>>>>>External_Function32 GetOCXEventDateParam "GetOCXEventDateParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Date
35465>>>>>
35465>>>>>External_Function32 GetOCXEventRealParam "GetOCXEventRealParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer destStr;                    Returns Integer
35466>>>>>
35466>>>>>External_Function32 GetOCXEventShortRealParam "GetOCXEventShortRealParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer destStr;                    Returns Integer
35467>>>>>
35467>>>>>External_Function32 GetOCXEventIntegerParam "GetOCXEventIntegerParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Integer
35468>>>>>
35468>>>>>External_Function32 GetOCXEventShortParam "GetOCXEventShortParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Integer
35469>>>>>
35469>>>>>External_Function32 GetOCXEventStringParam "GetOCXEventStringParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer pDestStr;                    Returns Integer
35470>>>>>
35470>>>>>External_Function32 GetOCXEventOLEVariantParam "GetOCXEventOLEVariantParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    LPOLEVAR pDestVar;                    Returns Integer
35471>>>>>
35471>>>>>External_Function32 EnableOCXControl "EnableOCXControl" DFOLECLN.DLL;                    Integer iClientId;                    BOOL bEnable;                    Returns Integer
35472>>>>>
35472>>>>>External_Function32 GetOCXControlCaption "GetOCXControlCaption" DFOLECLN.DLL;                    Integer iClientId;                    Pointer lpDestStr;                    Returns Integer
35473>>>>>
35473>>>>>External_Function32 SetOCXControlCaption "SetOCXControlCaption" DFOLECLN.DLL;                    Integer iClientId;                    String  sCaption;                    Returns Integer
35474>>>>>
35474>>>>>External_Function32 LoadOlePicture "LoadOlePicture" DFOLECLN.DLL;                    String  sFilename;                    Returns LPDispatch
35475>>>>>
35475>>>>>External_Function32 ReleaseComPointer "ReleaseComPtr" DFOLECLN.DLL;                    LPIUnknown  comPtr;                    Returns Integer
35476>>>>>
35476>>>>>External_Function32 DFOleInit "DFOleInit" DFOLECLN.DLL;                    Returns Integer
35477>>>>>
35477>>>>>External_Function32 DFOleUninit "DFOleUninit" DFOLECLN.DLL;                    Returns Integer
35478>>>>>
35478>>>>>External_Function32 AlterOCXEventParam "AlterOCXEventParam" DFOLECLN.DLL;                    Pointer  pdispParams;                    Integer iparam;                    OLEVariant vNewValue;                    Returns  Integer
35479>>>>>
35479>>>>>
35479>>>>>
35479>>>>>// This command is only used internaly and should NOT be used by the developer
35479>>>>>
35479>>>USE DFEXTCLM
35479>>>USE EXTFRM
35479>>>USE DBEXTFRM
35479>>>
35479>>>//**********
35479>>>//*** Error messages***
35479>>>//**********
35479>>>
35479>>>    Enum_List
35479>>>        Define OLE_SV_LANG
35479>>>        Define OLE_US_LANG
35479>>>    End_Enum_List
35479>>>
35479>>>    Define OLE_CURR_LANG For OLE_US_LANG
35479>>>
35479>>>        //*** US
INCLUDING FILE: FLXOLEUS.INC
35479>>>>
35479>>>
35479>>>
35479>>>// This class encapsulates the behaviour of an OLEVariant, and simplifies
35479>>>// tasks involved working with the OLEVariant.
35479>>>Class cOLEVariant is an array
35480>>>    Procedure Construct_Object
35481>>>        Forward Send Construct_Object
35483>>>        Local Integer iRetVal
35484>>>        Move (DFOleInit()) to iRetVal
35485>>>        Send OCXInit
35486>>>    End_Procedure
35487>>>
35487>>>    Procedure Destroy_Object
35488>>>        Local Integer iRetVal
35489>>>        Move (DFOleUninit()) to iRetVal
35490>>>        Forward Send Destroy_Object
35492>>>    End_Procedure
35493>>>
35493>>>    Procedure OCXInit
35494>>>        Move (RegisterWindowMessage("WM_DFOCXEVENT")) to WM_DFOCXEVENT
35495>>>        Move (RegisterWindowMessage("WM_DFOCXNOTIFYEVENT")) to WM_DFOCXNOTIFYEVENT
35496>>>    End_Procedure
35497>>>
35497>>>    Function GetType  OLEVariant var Returns DWORD
35498>>>        Local DWORD varVt
35499>>>        GetBuff from var at Variant.vt to varVt
35500>>>        Function_Return varVt
35501>>>    End_Function
35502>>>
35502>>>    Function GetShort OLEVariant var Returns Integer
35503>>>        Local Integer iVal
35504>>>        GetBuff from var at Variant.iVal to iVal
35505>>>        Function_Return iVal
35506>>>    End_Function
35507>>>
35507>>>    Function GetInteger OLEVariant var Returns Integer
35508>>>        Local Integer lVal
35509>>>        GetBuff from var at Variant.lVal to lVal
35510>>>        Function_Return lVal
35511>>>    End_Function
35512>>>
35512>>>    Function GetFloat OLEVariant var Returns OLEReal
35513>>>        Local OLEReal fltVal
35514>>>        GetBuff_String from var at Variant.fltVal to fltVal
35515>>>        Function_Return fltVal
35516>>>    End_Function
35517>>>
35517>>>    Function GetDouble OLEVariant var Returns OLEReal
35518>>>        Local OLEReal dblVal
35519>>>        GetBuff_String from var at Variant.dblVal to dblVal
35520>>>        Function_Return dblVal
35521>>>    End_Function
35522>>>
35522>>>    Function GetCurrency OLEVariant var Returns Number
35523>>>        Local Number cyVal
35524>>>        GetBuff_String from var at Variant.cyVal to cyVal
35525>>>        Function_Return cyVal
35526>>>    End_Function
35527>>>
35527>>>    Function GetDate OLEVariant var Returns Date
35528>>>        Local Date dtVal
35529>>>        GetBuff from var at Variant.dtVal to dtVal
35530>>>        Function_Return dtVal
35531>>>    End_Function
35532>>>
35532>>>    Function GetString OLEVariant var Returns String
35533>>>        Local String strVal
35534>>>        GetBuff_String from var at Variant.strVal to strVal
35535>>>        Function_Return strVal
35536>>>    End_Function
35537>>>
35537>>>    Function GetLPDispatch OLEVariant var Returns LPDispatch
35538>>>        Local LPDispatch dspVal
35539>>>        GetBuff from var at Variant.dspVal to dspVal
35540>>>        Function_Return dspVal
35541>>>    End_Function
35542>>>
35542>>>    Function GetOLEError OLEVariant var Returns OLEError
35543>>>        Local OLEError errVal
35544>>>        GetBuff from var at Variant.errVal to errVal
35545>>>        Function_Return errVal
35546>>>    End_Function
35547>>>
35547>>>    Function GetBool OLEVariant var Returns Bool
35548>>>        Local Bool blVal
35549>>>        GetBuff from var at Variant.blVal to blVal
35550>>>        Function_Return blVal
35551>>>    End_Function
35552>>>
35552>>>    Function GetLPIUnknown OLEVariant var Returns LPIUnknown
35553>>>        Local LPIUnknown uknVal
35554>>>        GetBuff from var at Variant.uknVal to uknVal
35555>>>        Function_Return uknVal
35556>>>    End_Function
35557>>>
35557>>>    Function GetUChar OLEVariant var Returns UChar
35558>>>        Local UChar ui1Val
35559>>>        GetBuff from var at Variant.ui1Val to ui1Val
35560>>>        Function_Return ui1Val
35561>>>    End_Function
35562>>>
35562>>>    Function GetValue OLEVariant var Returns String
35563>>>        Local DWORD vt
35564>>>        Local String retVal
35564>>>        Get GetType var to vt
35565>>>             If vt Eq OLE_VT_I2        Get GetShort var to retVal
35568>>>        Else If vt Eq OLE_VT_I4        Get GetInteger var to retVal
35572>>>        Else If vt Eq OLE_VT_R4        Get GetFloat var to retVal
35576>>>        Else If vt Eq OLE_VT_R8        Get GetDouble var to retVal
35580>>>        Else If vt Eq OLE_VT_CY        Get GetCurrency var to retVal
35584>>>        Else If vt Eq OLE_VT_DATE      Get GetDate var to retVal
35588>>>        Else If vt Eq OLE_VT_BSTR      Get GetString var to retVal
35592>>>        Else If vt Eq OLE_VT_DISPATCH  Get GetLPDispatch var to retVal
35596>>>        Else If vt Eq OLE_VT_ERROR     Get GetOLEError var to retVal
35600>>>        Else If vt Eq OLE_VT_BOOL      Get GetBool var to retVal
35604>>>        Else If vt Eq OLE_VT_UNKNOWN   Get GetLPIUnknown var to retVal
35608>>>        Else If vt Eq OLE_VT_UI1       Get GetUChar var to retVal
35612>>>        Function_Return retVal
35613>>>    End_Function
35614>>>
35614>>>    Function PutValue DWORD vt String val Returns OLEVariant
35615>>>        Inst_OLEVariant var
35617>>>        Put vt to var at Variant.vt
35618>>>             If vt Eq OLE_VT_I2        Put (Integer(val)) to var at Variant.iVal
35621>>>        Else If vt Eq OLE_VT_I4        Put (Integer(val)) to var at Variant.lVal
35625>>>        Else If vt Eq OLE_VT_R4        Put_String val to var at Variant.fltVal
35629>>>        Else If vt Eq OLE_VT_R8        Put_String val to var at Variant.dblVal
35633>>>        Else If vt Eq OLE_VT_CY        Put_String val to var at Variant.cyVal
35637>>>        Else If vt Eq OLE_VT_DATE      Put (Date(val)) to var at Variant.dtVal
35641>>>        Else If vt Eq OLE_VT_BSTR      Put_String val to var at Variant.strVal
35645>>>        Else If vt Eq OLE_VT_DISPATCH  Put (LPDispatch(val)) to var at Variant.dspVal
35649>>>        Else If vt Eq OLE_VT_ERROR     Put (OLEError(val)) to var at Variant.errVal
35653>>>        Else If vt Eq OLE_VT_BOOL      Put (Bool(val)) to var at Variant.blVal
35657>>>        Else If vt Eq OLE_VT_UNKNOWN   Put (LPIUnknown(val)) to var at Variant.uknVal
35661>>>        Else If vt Eq OLE_VT_UI1       Put (UChar(val)) to var at Variant.ui1Val
35665>>>        Else begin
35666>>>            Put OLE_VT_ERROR to var at Variant.vt
35667>>>            Put DISP_E_PARAMNOTFOUND to var at Variant.errVal
35668>>>        End
35668>>>>
35668>>>        Function_Return var
35669>>>    End_Function
35670>>>
35670>>>End_Class
35671>>>
35671>>>// The one and only cOLEVariant helper object
35671>>>Object oOLEVariant is a cOLEVariant
35673>>>        Move Current_Object to oOLEVariantId
35674>>>End_Object
35675>>>
35675>>>//Command so we get nicer code for the events, only used internally
35675>>>
35675>>>// Command to extract the value of an OLEVariant no matter what datatype its currently holding
35675>>>
35675>>>// Command to both set the datatype and value to an OLEVariant
35675>>>
35675>>>
35675>>>// The OLE Base class, all OLE classes are derived from this class
35675>>>// Defines basic functionality and conversation with DLL interface
35675>>>
35675>>>Class cCOM_IDispatch is a Message
35676>>>
35676>>>    Procedure DefineCOM_IDispatch
35677>>>        Property String  progIdStr Public ""
35678>>>        Property Integer ClientId Public 0
35679>>>        Property Integer AutoAddRef Public 0
35680>>>    End_Procedure
35681>>>
35681>>>// GetProperty functions
35681>>>    Function GetIntegerProperty DWORD dwDispId returns Integer
35682>>>        Local Integer lpropVal iClientId
35683>>>        Get clientId to iClientId
35684>>>        Move (GetAutoClientIntegerProperty (iClientId,dwDispId)) to lpropVal
35685>>>        Function_Return lpropVal
35686>>>    End_Function
35687>>>
35687>>>    Function GetShortProperty DWORD dwDispId returns Integer
35688>>>        Local Integer lpropVal iClientId
35689>>>        Get clientId to iClientId
35690>>>        Move (GetAutoClientShortProperty (iClientId,dwDispId)) to lpropVal
35691>>>        Function_Return lpropVal
35692>>>    End_Function
35693>>>
35693>>>    Function GetBoolProperty DWORD dwDispId returns BOOL
35694>>>        Local BOOL lpropVal
35695>>>        Local Integer iClientId
35695>>>        Get clientId to iClientId
35696>>>        Move (GetAutoClientBoolProperty (iClientId,dwDispId)) to lpropVal
35697>>>        Function_Return lpropVal
35698>>>    End_Function
35699>>>
35699>>>    Function GetCurrencyProperty DWORD dwDispId returns Number
35700>>>        Local Number lpropVal
35701>>>        Local String lsProp
35701>>>        Local Integer iClientId iRetVal
35701>>>        Local Pointer llpsprop
35701>>>        Get clientId to iClientId
35702>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lsProp
35703>>>        GetAddress of lsprop to llpsprop
35704>>>        Move (GetAutoClientCurrencyProperty (iClientId,dwDispId,llpsprop)) to iRetVal
35705>>>        Move lsProp to lpropVal
35706>>>        Function_Return lpropVal
35707>>>    End_Function
35708>>>
35708>>>    Function GetDateProperty DWORD dwDispId returns Date
35709>>>        Local Date lpropVal
35710>>>        Local Integer iClientId
35710>>>        Get clientId to iClientId
35711>>>        Move (GetAutoClientDateProperty (iClientId,dwDispId)) to lpropVal
35712>>>        Function_Return lpropVal
35713>>>    End_Function
35714>>>
35714>>>    Function GetLPDispatchProperty DWORD dwDispId returns Date
35715>>>        Local LPDispatch lpropVal
35716>>>        Local Integer iClientId
35716>>>        Get clientId to iClientId
35717>>>        Move (GetAutoClientLPDispatchProperty (iClientId,dwDispId)) to lpropVal
35718>>>        Function_Return lpropVal
35719>>>    End_Function
35720>>>
35720>>>    Function GetRealProperty DWORD dwDispId returns OLEReal
35721>>>        Local OLEReal lpropVal
35722>>>        Local Integer iClientId iRetVal
35722>>>        Local String lsProp
35722>>>        Local Pointer llpsprop
35722>>>        Get clientId to iClientId
35723>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lsProp
35724>>>        GetAddress of lsprop to llpsprop
35725>>>        Move (GetAutoClientRealProperty (iClientId,dwDispId,llpsprop)) to iRetVal
35726>>>        Move lsProp to lpropVal
35727>>>        Function_Return lpropVal
35728>>>    End_Function
35729>>>
35729>>>    Function GetShortRealProperty DWORD dwDispId returns OLEReal
35730>>>        Local OLEReal lpropVal
35731>>>        Local Integer iClientId iRetVal
35731>>>        Local String lsProp
35731>>>        Local Pointer llpsprop
35731>>>        Get clientId to iClientId
35732>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lsProp
35733>>>        GetAddress of lsprop to llpsprop
35734>>>        Move (GetAutoClientShortRealProperty (iClientId,dwDispId,llpsprop)) to iRetVal
35735>>>        Move lsProp to lpropVal
35736>>>        Function_Return lpropVal
35737>>>    End_Function
35738>>>
35738>>>    Function GetStringProperty DWORD dwDispId returns String
35739>>>        Local String lpropVal
35740>>>        Local Integer iClientId iRetVal
35740>>>        Local Pointer llppropVal
35740>>>        Get clientId to iClientId
35741>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lpropVal
35742>>>        GetAddress of lpropVal to llppropval
35743>>>        Move (GetAutoClientStringProperty (iClientId,dwDispId,llppropVal)) to iRetVal
35744>>>        Function_Return (CString(lpropVal))
35745>>>    End_Function
35746>>>
35746>>>    Function GetOLEVariantProperty DWORD dwDispId returns OLEVariant
35747>>>        Local OLEVariant lpropVal
35748>>>        Local Integer iClientId iRetVal
35748>>>        Local Pointer llppropVal
35748>>>        Get clientId to iClientId
35749>>>        ZeroType TP_OLEVariant to lpropVal
35750>>>        GetAddress of lpropVal to llppropval
35751>>>        Move (GetAutoClientOLEVariantProperty (iClientId,dwDispId,llppropVal)) to iRetVal
35752>>>        Function_Return lpropVal
35753>>>    End_Function
35754>>>
35754>>>// SetProperty procedures
35754>>>    Procedure SetIntegerProperty DWORD dwDispId Integer lpropVal
35755>>>        Local Integer iClientId iRetVal
35756>>>        Get ClientId to iClientId
35757>>>        Move (SetAutoClientIntegerProperty (iClientId,dwDispId,lpropVal)) to iRetVal
35758>>>    End_Procedure
35759>>>
35759>>>    Procedure SetShortProperty DWORD dwDispId Integer lpropVal
35760>>>        Local Integer iClientId iRetVal
35761>>>        Get ClientId to iClientId
35762>>>        Move (SetAutoClientShortProperty (iClientId,dwDispId,lpropVal)) to iRetVal
35763>>>    End_Procedure
35764>>>
35764>>>    Procedure SetBoolProperty DWORD dwDispId BOOL lpropVal
35765>>>        Local Integer iClientId iRetVal
35766>>>        Get ClientId to iClientId
35767>>>        Move (SetAutoClientShortProperty (iClientId,dwDispId,lpropVal)) to iRetVal
35768>>>    End_Procedure
35769>>>
35769>>>    Procedure SetCurrencyProperty DWORD dwDispId Number lpropVal
35770>>>        Local Integer iClientId iRetVal
35771>>>        Local String lsprop
35771>>>        Get ClientId to iClientId
35772>>>        Move lpropVal to lsprop
35773>>>        Move (SetAutoClientCurrencyProperty(iClientId,dwDispId,lsprop)) to iRetVal
35774>>>    End_Procedure
35775>>>
35775>>>    Procedure SetDateProperty DWORD dwDispId Date lpropVal
35776>>>        Local Integer iClientId iRetVal
35777>>>        Get ClientId to iClientId
35778>>>        Move (SetAutoClientDateProperty(iClientId,dwDispId,lpropVal)) to iRetVal
35779>>>    End_Procedure
35780>>>
35780>>>    Procedure SetLPDispatchProperty DWORD dwDispId LPDispatch lpropVal
35781>>>        Local Integer iClientId iRetVal
35782>>>        Get ClientId to iClientId
35783>>>        Move (SetAutoClientLPDispatchProperty(iClientId,dwDispId,lpropVal)) to iRetVal
35784>>>    End_Procedure
35785>>>
35785>>>    Procedure SetRealProperty DWORD dwDispId OLEReal lpropVal
35786>>>        Local Integer iClientId iRetVal
35787>>>        Local String lsprop
35787>>>        Get ClientId to iClientId
35788>>>        Move lpropVal to lsprop
35789>>>        Move (SetAutoClientRealProperty(iClientId,dwDispId,lsprop)) to iRetVal
35790>>>    End_Procedure
35791>>>
35791>>>    Procedure SetShortRealProperty DWORD dwDispId OLEReal lpropVal
35792>>>        Local Integer iClientId iRetVal
35793>>>        Local String lsprop
35793>>>        Get ClientId to iClientId
35794>>>        Move lpropVal to lsprop
35795>>>        Move (SetAutoClientShortRealProperty(iClientId,dwDispId,lsprop)) to iRetVal
35796>>>    End_Procedure
35797>>>
35797>>>    Procedure SetStringProperty DWORD dwDispId String lpropVal
35798>>>        Local Integer iClientId iRetVal
35799>>>        Get ClientId to iClientId
35800>>>        Move (SetAutoClientStringProperty(iClientId,dwDispId,lpropVal)) to iRetVal
35801>>>    End_Procedure
35802>>>
35802>>>    Procedure SetOLEVariantProperty DWORD dwDispId OLEVariant lpropVal
35803>>>        Local Integer iClientId iRetVal
35804>>>        Get ClientId to iClientId
35805>>>        If (Length(lpropval)) Lt TP_OLEVariant_Size;            Get PutValue of oOLEVariantId OLE_VT_ERROR DISP_E_PARAMNOTFOUND to lpropVal
35808>>>        Move (SetAutoClientOLEVariantProperty(iClientId,dwDispId,lpropVal)) to iRetVal
35809>>>    End_Procedure
35810>>>
35810>>>// Pre-Invoke functions
35810>>>    Procedure DeclareParams Integer nrOfParams
35811>>>        Local Integer iClientId iRetVal
35812>>>        Get ClientId to iCLientId
35813>>>        Move (DeclareAutoClientInvokeParams(iClientId,nrOfParams)) to iRetVal
35814>>>    End_Procedure
35815>>>
35815>>>    Procedure DefineIntegerParam Integer param
35816>>>        Local Integer iClientId iRetVal
35817>>>        Get ClientId to iClientId
35818>>>        Move (DefineAutoClientIntegerParam(iClientId,param)) to iRetVal
35819>>>    End_Procedure
35820>>>
35820>>>    Procedure DefineShortParam Integer param
35821>>>        Local Integer iClientId iRetVal
35822>>>        Get ClientId to iClientId
35823>>>        Move (DefineAutoClientShortParam(iClientId,param)) to iRetVal
35824>>>    End_Procedure
35825>>>
35825>>>    Procedure DefineBoolParam BOOL param
35826>>>        Local Integer iClientId iRetVal
35827>>>        Get ClientId to iClientId
35828>>>        Move (DefineAutoClientBoolParam(iClientId,param)) to iRetVal
35829>>>    End_Procedure
35830>>>
35830>>>    Procedure DefineCurrencyParam Number param
35831>>>        Local Integer iClientId iRetVal
35832>>>        Local String lsparam
35832>>>        Get ClientId to iClientId
35833>>>        Move param to lsparam
35834>>>        Move (DefineAutoClientCurrencyParam(iClientId,lsparam)) to iRetVal
35835>>>    End_Procedure
35836>>>
35836>>>    Procedure DefineDateParam Date param
35837>>>        Local Integer iClientId iRetVal
35838>>>        Get ClientId to iClientId
35839>>>        Move (DefineAutoClientDateParam(iClientId,param)) to iRetVal
35840>>>    End_Procedure
35841>>>
35841>>>    Procedure DefineLPDispatchParam LPDispatch param
35842>>>        Local Integer iClientId iRetVal
35843>>>        Get ClientId to iClientId
35844>>>        Move (DefineAutoClientLPDispatchParam(iClientId,param)) to iRetVal
35845>>>    End_Procedure
35846>>>
35846>>>    Procedure DefineRealParam OLEReal param
35847>>>        Local Integer iClientId iRetVal
35848>>>        Local String lsparam
35848>>>        Get ClientId to iClientId
35849>>>        Move param to lsparam
35850>>>        Move (DefineAutoClientRealParam(iClientId,lsparam)) to iRetVal
35851>>>    End_Procedure
35852>>>
35852>>>    Procedure DefineShortRealParam OLEReal param
35853>>>        Local Integer iClientId iRetVal
35854>>>        Local String lsparam
35854>>>        Get ClientId to iClientId
35855>>>        Move param to lsparam
35856>>>        Move (DefineAutoClientShortRealParam(iClientId,lsparam)) to iRetVal
35857>>>    End_Procedure
35858>>>
35858>>>    Procedure DefineStringParam String param
35859>>>        Local Integer iClientId iRetVal
35860>>>        Get ClientId to iClientId
35861>>>        Append param OLENull
35862>>>        Move (DefineAutoClientStringParam(iClientId,param)) to iRetVal
35863>>>    End_Procedure
35864>>>
35864>>>    Procedure DefineOLEVariantParam OLEVariant param
35865>>>        Local Integer iClientId iRetVal
35866>>>        Get ClientId to iClientId
35867>>>        If (Length(param)) Lt TP_OLEVariant_Size ;            Get PutValue of oOLEVariantId OLE_VT_ERROR DISP_E_PARAMNOTFOUND to param
35870>>>        Move (DefineAutoClientOLEVariantParam(iClientId,param)) to iRetVal
35871>>>    End_Procedure
35872>>>
35872>>>// Invoke functions
35872>>>    Procedure InvokeVoidFunction DWORD dwDispId
35873>>>        Local Integer iClientId iRetVal
35874>>>        Get ClientId to iClientId
35875>>>        Move (InvokeAutoClientVoidFunction(iClientId,dwDispId)) to iRetVal
35876>>>    End_Procedure
35877>>>
35877>>>    Function InvokeIntegerFunction DWORD dwDispId returns Integer
35878>>>        Local Integer iClientId iRetVal
35879>>>        Get ClientId to iClientId
35880>>>        Move (InvokeAutoClientIntegerFunction(iClientId,dwDispId)) to iRetVal
35881>>>        Function_Return iRetVal
35882>>>    End_Function
35883>>>
35883>>>    Function InvokeShortFunction DWORD dwDispId returns Integer
35884>>>        Local Integer iClientId iRetVal
35885>>>        Get ClientId to iClientId
35886>>>        Move (InvokeAutoClientShortFunction(iClientId,dwDispId)) to iRetVal
35887>>>        Function_Return iRetVal
35888>>>    End_Function
35889>>>
35889>>>    Function InvokeBoolFunction DWORD dwDispId returns BOOL
35890>>>        Local Integer iClientId iRetVal
35891>>>        Get ClientId to iClientId
35892>>>        Move (InvokeAutoClientBoolFunction(iClientId,dwDispId)) to iRetVal
35893>>>        Function_Return iRetVal
35894>>>    End_Function
35895>>>
35895>>>    Function InvokeCurrencyFunction DWORD dwDispId returns Number
35896>>>        Local Integer iClientId iRetVal
35897>>>        Local Number nRetVal
35897>>>        Local String sRetVal
35897>>>        Local Pointer psRetVal
35897>>>        Get ClientId to iClientId
35898>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
35899>>>        GetAddress of sRetVal to psRetVal
35900>>>        Move (InvokeAutoClientCurrencyFunction(iClientId,dwDispId,psRetVal)) to iRetVal
35901>>>        Move sRetVal to nRetVal
35902>>>        Function_Return nRetVal
35903>>>    End_Function
35904>>>
35904>>>    Function InvokeDateFunction DWORD dwDispId returns Date
35905>>>        Local Integer iClientId
35906>>>        Local Date dRetVal
35906>>>        Get ClientId to iClientId
35907>>>        Move (InvokeAutoClientDateFunction(iClientId,dwDispId)) to dRetVal
35908>>>        Function_Return dRetVal
35909>>>    End_Function
35910>>>
35910>>>    Function InvokeLPDispatchFunction DWORD dwDispId returns LPDispatch
35911>>>        Local Integer iClientId
35912>>>        Local LPDispatch lpdRetVal
35912>>>        Get ClientId to iClientId
35913>>>        Move (InvokeAutoClientLPDispatchFunction(iClientId,dwDispId)) to lpdRetVal
35914>>>        Function_Return lpdRetVal
35915>>>    End_Function
35916>>>
35916>>>    Function InvokeRealFunction DWORD dwDispId returns OLEReal
35917>>>        Local Integer iClientId iRetVal
35918>>>        Local OLEReal rRetVal
35918>>>        Local String sRetVal
35918>>>        Local Pointer psRetVal
35918>>>        Get ClientId to iClientId
35919>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
35920>>>        GetAddress of sRetVal to psRetVal
35921>>>        Move (InvokeAutoClientRealFunction(iClientId,dwDispId,psRetVal)) to iRetVal
35922>>>        Move sRetVal to rRetVal
35923>>>        Function_Return rRetVal
35924>>>    End_Function
35925>>>
35925>>>    Function InvokeShortRealFunction DWORD dwDispId returns OLEReal
35926>>>        Local Integer iClientId iRetVal
35927>>>        Local OLEReal rRetVal
35927>>>        Local String sRetVal
35927>>>        Local Pointer psRetVal
35927>>>        Get ClientId to iClientId
35928>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
35929>>>        GetAddress of sRetVal to psRetVal
35930>>>        Move (InvokeAutoClientShortRealFunction(iClientId,dwDispId,psRetVal)) to iRetVal
35931>>>        Move sRetVal to rRetVal
35932>>>        Function_Return rRetVal
35933>>>    End_Function
35934>>>
35934>>>    Function InvokeStringFunction DWORD dwDispId returns String
35935>>>        Local Integer iClientId iRetVal
35936>>>        Local String sRetVal
35936>>>        Local Pointer psRetVal
35936>>>        Get ClientId to iClientId
35937>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
35938>>>        GetAddress of sRetVal to psRetVal
35939>>>        Move (InvokeAutoClientStringFunction(iClientId,dwDispId,psRetVal)) to iRetVal
35940>>>        Function_Return (CString(sRetVal))
35941>>>    End_Function
35942>>>
35942>>>    Function InvokeOleVariantFunction DWORD dwDispId returns OLEVariant
35943>>>        Local Integer iClientId iRetVal
35944>>>        Local OLEVariant vRetVal
35944>>>        Local Pointer pvRetVal
35944>>>        Get ClientId to iClientId
35945>>>        ZeroType TP_OLEVariant to vRetVal
35946>>>        GetAddress of vRetVal to pvRetVal
35947>>>        Move (InvokeAutoClientOLEVariantFunction(iClientId,dwDispId,pvRetVal)) to iRetVal
35948>>>        Function_Return vRetVal
35949>>>    End_Function
35950>>>
35950>>>
35950>>>// Event parameter functions, might be moved to cOCX_Client_Mixin or similar
35950>>>    Function GetEventIntegerParam DWORD lParam DWORD iPara returns Integer
35951>>>        Local Integer iRetVal
35952>>>        Move (GetOCXEventIntegerParam(lParam,iPara)) to iRetVal
35953>>>        Function_Return iRetVal
35954>>>    End_Function
35955>>>
35955>>>    Function GetEventShortParam DWORD lParam DWORD iPara returns Integer
35956>>>        Local Integer iRetVal
35957>>>        Move (GetOCXEventShortParam(lParam,iPara)) to iRetVal
35958>>>        Function_Return iRetVal
35959>>>    End_Function
35960>>>
35960>>>    Function GetEventBoolParam DWORD lParam DWORD iPara returns Bool
35961>>>        Local Bool iRetVal
35962>>>        Move (GetOCXEventBoolParam(lParam,iPara)) to iRetVal
35963>>>        Function_Return iRetVal
35964>>>    End_Function
35965>>>
35965>>>    Function GetEventCurrencyParam DWORD lParam DWORD iPara returns Currency
35966>>>        Local Integer iretVal
35967>>>        Local Currency cRetVal
35967>>>        Local String destStr
35967>>>        Local Pointer pdestStr
35967>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
35968>>>        GetAddress of destStr to pdestStr
35969>>>        Move (GetOCXEventCurrencyParam(lParam,iPara,pdestStr)) to iRetVal
35970>>>        Move (CString(destStr)) to cRetVal
35971>>>        Function_Return cRetVal
35972>>>    End_Function
35973>>>
35973>>>    Function GetEventDateParam DWORD lParam DWORD iPara returns Date
35974>>>        Local Date dRetVal
35975>>>        Move (GetOCXEventDateParam(lParam,iPara)) to dRetVal
35976>>>        Function_Return dRetVal
35977>>>    End_Function
35978>>>
35978>>>    Function GetEventLPDispatchParam DWORD lParam DWORD iPara returns LPDispatch
35979>>>        Local LPDispatch lpRetVal
35980>>>        Get GetEventIntegerParam lParam iPara to lpRetVal
35981>>>        Function_Return lpRetVal
35982>>>    End_Function
35983>>>
35983>>>    Function GetEventRealParam DWORD lParam DWORD iPara returns OLEReal
35984>>>        Local Integer iretVal
35985>>>        Local OLEReal rRetVal
35985>>>        Local String destStr
35985>>>        Local Pointer pdestStr
35985>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
35986>>>        GetAddress of destStr to pdestStr
35987>>>        Move (GetOCXEventRealParam(lParam,iPara,pdestStr)) to iRetVal
35988>>>        Move (CString(destStr)) to rRetVal
35989>>>        Function_Return rRetVal
35990>>>    End_Function
35991>>>
35991>>>    Function GetEventShortRealParam DWORD lParam DWORD iPara returns ShortReal
35992>>>        Local Integer iretVal
35993>>>        Local ShortReal rRetVal
35993>>>        Local String destStr
35993>>>        Local Pointer pdestStr
35993>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
35994>>>        GetAddress of destStr to pdestStr
35995>>>        Move (GetOCXEventShortRealParam(lParam,iPara,pdestStr)) to iRetVal
35996>>>        Move (CString(destStr)) to rRetVal
35997>>>        Function_Return rRetVal
35998>>>    End_Function
35999>>>
35999>>>    Function GetEventStringParam DWORD lParam DWORD iPara returns String
36000>>>        Local Integer iretVal
36001>>>        Local String sRetVal
36001>>>        Local Pointer psRetVal
36001>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
36002>>>        GetAddress of sRetVal to psRetVal
36003>>>        Move (GetOCXEventStringParam(lParam,iPara,psRetVal)) to iRetVal
36004>>>        Function_Return (CString(sRetVal))
36005>>>    End_Function
36006>>>
36006>>>    Function GetEventOLEVariantParam DWORD lParam DWORD iPara returns OLEVariant
36007>>>        Local Integer iretVal
36008>>>        Inst_OLEVariant vRetVal
36009>>>        Local Pointer pvRetVal
36009>>>        GetAddress of vRetVal to pvRetVal
36010>>>        Move (GetOCXEventOLEVariantParam(lParam,iPara,pvRetVal)) to iRetVal
36011>>>        Function_Return vRetVal
36012>>>    End_Function
36013>>>
36013>>>End_Class
36014>>>
36014>>>
36014>>>// The OLE Automation base class,
36014>>>// which all automation classes are derived from
36014>>>
36014>>>Class Automation_Client is a cCOM_IDispatch
36015>>>    Procedure Construct_Object
36016>>>        Forward Send Construct_Object
36018>>>        Send DefineCOM_IDispatch
36019>>>        Local Integer iClientId
36020>>>        Move (CreateAutomationClient()) To iClientId
36021>>>        If iClientId Eq 0 Begin
36023>>>            Set ClientId to 0
36024>>>            Error 1002 DFOLEError1002
36025>>>>
36025>>>        End
36025>>>>
36025>>>        Else Set ClientId To iClientId
36027>>>        End_Procedure
36028>>>
36028>>>    Procedure Destroy_Object
36029>>>        Local Integer iRetVal iClientId
36030>>>        Get ClientId to iClientId
36031>>>        Move (DestroyAutomationClient(iClientId)) to iRetVal
36032>>>        Forward Send Destroy_Object
36034>>>    End_Procedure
36035>>>
36035>>>    Procedure CreateDispatch
36036>>>                Local Integer iRetVal
36037>>>                Local Integer iClientId
36037>>>        Local String sCLSID
36037>>>        Get progIdStr to sCLSID
36038>>>        Append sCLSID OLENull
36039>>>
36039>>>                Get clientId to iClientId
36040>>>        Move (CreateAutoClientDispatch (iClientId,sCLSID)) To iRetVal
36041>>>                If iRetVal Eq 0 Begin
36043>>>            Error 1000 DFOLEError1000
36044>>>>
36044>>>                End
36044>>>>
36044>>>        End_Procedure
36045>>>
36045>>>        Procedure AttachDispatch LPDispatch pdisp
36046>>>                Local Integer iRetVal
36047>>>                Local Integer iClientId
36047>>>                Local Integer bAutoAddRef
36047>>>                Get clientId to iClientId
36048>>>                Get AutoAddRef to bAutoAddRef
36049>>>                Move (AttachAutoClientDispatch (iClientId,pdisp,bAutoAddRef)) To iRetVal
36050>>>                If iRetVal Eq 0 Begin
36052>>>                Error 1001 DFOLEError1001
36053>>>>
36053>>>                End
36053>>>>
36053>>>    End_Procedure
36054>>>
36054>>>    Function AttachActiveObject Returns Bool
36055>>>                Local Bool bRetVal
36056>>>                Local Integer iClientId
36056>>>                Local String sCLSID
36056>>>                Get progIdStr to sCLSID
36057>>>                Append sCLSID OLENull
36058>>>                Get clientId to iClientId
36059>>>                Move (AttachAutoClientActiveObject (iClientId,sCLSID)) To bRetVal
36060>>>                Function_Return bRetVal
36061>>>    End_Function
36062>>>
36062>>>    Procedure ReleaseDispatch
36063>>>        Local Integer iRetVal
36064>>>        Local Integer iClientId
36064>>>        Get clientId to iClientId
36065>>>        Move (ReleaseAutoClientDispatch (iClientId)) to iRetVal
36066>>>    End_Procedure
36067>>>
36067>>>    Function GetDispatch returns LPDispatch
36068>>>        Local LPDispatch retVal
36069>>>        Local Integer iClientId
36069>>>        Get clientId to iClientId
36070>>>        Move (GetAutoClientDispatch(iClientId)) to retVal
36071>>>        Function_Return retVal
36072>>>    End_Function
36073>>>
36073>>>End_Class
36074>>>
36074>>>
36074>>>//     cCom_IDispatch  External_Class_Mixin
36074>>>//                 |       |    
36074>>>//                 |       cOCXNavigation_Mixin
36074>>>//                 |         |    
36074>>>//               cOCX_Client_Mixin
36074>>>//                        |    |
36074>>>//                        |    |
36074>>>// Form_External_Control  |    |   dbForm_External_Control
36074>>>//                 |      |    |        |  
36074>>>//                OCX_Client   dbOCX_Client
36074>>>
36074>>>
36074>>>
36074>>>// The focus navigation mixin class for ActiveX controls
36074>>>Class cOCX_Navigation_Class_Mixin is a Mixin 
36075>>>    Import_Class_Protocol External_Class_Mixin
36076>>>    Register_Procedure WMDF_DFOCXNotifyEvent
36076>>>
36076>>>    Procedure WMDF_DFOCXNotifyEvent Integer wParam Integer lParam
36077>>>        ON_EVENT WM_DFOCX_FOCUSCHANGE Fire OCXFocusChange
36080>>>    End_Procedure
36081>>>
36081>>>    Procedure OCXFocusChange Integer lParam
36082>>>        If (lParam);            Send External_SetFocus
36085>>>        Else;            Send External_KillFocus
36087>>>    End_Procedure
36088>>>
36088>>>    //Provided just to cancel the External_Class_Mixin implementation
36088>>>    //It actually gets cancelled in the cOCX_Clint_Mixin, but hey!?
36088>>>    Procedure Page_Object Integer state
36089>>>        Forward Send Page_Object state        
36091>>>    End_Procedure
36092>>>
36092>>>    Procedure Enable_Window integer iState
36093>>>      // Here we switch iState again, for backwards compatibility
36093>>>      Set OcxShadow_State to (Not(iState))
36094>>>    End_procedure
36095>>>
36095>>>End_Class
36096>>>
36096>>>
36096>>>//The standard OCX class mixin, it is the 
36096>>>// OCX base class which all OLE Controls are derived from (read mixin'd)
36096>>>Class cOCX_Client_Mixin is a Mixin
36097>>>
36097>>>    Import_Class_Protocol cCOM_IDispatch
36098>>>    Import_Class_Protocol cOCX_Navigation_Class_Mixin
36099>>>    Register_Procedure WMDF_DFOCXEVENT Integer wParam Integer lParam
36099>>>
36099>>>    Procedure DefineOCX_Client
36100>>>        Send DefineCOM_IDispatch
36101>>>        Local Integer iClientId
36102>>>        Property integer Private.OCXShadowState Public 0
36103>>>        Property String  Private.OCXCaption Public ""
36104>>>        Property String  OCXLicense Public ""
36105>>>        Property String  OCXPropFile Public ""
36106>>>        Move (CreateOCXClient()) to iclientId
36107>>>                Set ClientId to iClientId
36108>>>        Send Use_Parent_Color
36109>>>    End_Procedure
36110>>>
36110>>>    Function OCXShadow_State Returns Integer
36111>>>        Local Integer bEnabled
36112>>>        Get Private.OCXShadowState to bEnabled
36113>>>        Function_Return bEnabled
36114>>>    End_Function
36115>>>
36115>>>    Procedure Set OCXShadow_State Integer bEnable
36116>>>        Local integer hWnd iSuccess iCLientId
36117>>>        Set Private.OCXShadowState to bEnable
36118>>>        Get clientId to iClientId
36119>>>        If bEnable;            Move (false) to bEnable
36122>>>        else;            Move (true) to bEnable
36124>>>        Get Window_Handle to hWnd
36125>>>        If hWnd;            Move (EnableOCXControl(iClientId,bEnable)) To iSuccess
36128>>>    End_Procedure
36129>>>
36129>>>    Procedure SetOCXCaption String sCaption
36130>>>        Local Integer iClientId iRetVal
36131>>>        Get ClientId to iClientId
36132>>>        Append sCaption OLENull
36133>>>        Move (SetOCXControlCaption(iClientId,sCaption)) to iRetVal
36134>>>        If (Not(iRetVal));            Error 1004 DFOLEError1004
36137>>>        Else;            Set Private.OCXCaption to sCaption
36139>>>    End_Procedure
36140>>>
36140>>>    Function GetOCXCaption Returns String
36141>>>        Local Integer iClientId iRetVal
36142>>>        Local String destStr
36142>>>        Local Pointer lpDestStr
36142>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
36143>>>        GetAddress of destStr to lpDestStr
36144>>>        Move (GetOCXControlCaption(iClientId,lpDestStr)) to iRetVal
36145>>>        If (not(iRetVal));            Error 1004 DFOLEError1004
36148>>>        Set Private.OCXCaption to (CString(destStr))
36149>>>        Function_Return (Private.OCXCaption(Current_Object))
36150>>>    End_Function
36151>>>
36151>>>    Procedure SET OCXCaption String sCaption
36152>>>        If (Window_Handle(Current_Object));            Send SetOCXCaption sCaption
36155>>>        Else;            Set Private.OCXCaption to sCaption
36157>>>    End_Procedure
36158>>>
36158>>>    Function OCXCaption Returns String
36159>>>        If (Window_Handle(Current_Object));            Function_Return (GetOCXCaption(Current_Object))
36162>>>        Else;            Function_Return (Private.OCXCaption(Current_Object))
36164>>>    End_Procedure
36165>>>
36165>>>    // To avoid flickering during resize operations
36165>>>    Procedure Use_Parent_Color
36166>>>        Local Integer Clr Txtclr Backclr
36167>>>        Delegate Get Object_Color To Clr
36169>>>        Move (Hi(Clr)) To Txtclr
36170>>>        Move (Low(Clr)) To Backclr
36171>>>        Set Object_Color To Txtclr Backclr
36172>>>    End_Procedure
36173>>>
36173>>>    Procedure Page_Object integer iState
36174>>>        Forward Send Page_Object iState
36176>>>        If iState Eq (True) Send LoadOCX
36179>>>    End_Procedure
36180>>>
36180>>>    Procedure Remove_Object
36181>>>        Send UnloadOCX
36182>>>        Forward send Remove_Object
36184>>>    End_Procedure
36185>>>
36185>>>    Procedure LoadOCX
36186>>>        Local Pointer HWnd
36187>>>        Local Integer iCLientId iRetVal iVisible iShadow dwSty
36187>>>        Local String sPrgId lic sCap sPropFile
36187>>>        Send PreCreateOCX
36188>>>        Get ClientId to iClientId
36189>>>        Get Window_Handle to hwnd
36190>>>        Get progIdStr to sPrgId
36191>>>        Append sPrgId OLENull
36192>>>        Get Private.OCXCaption To sCap
36193>>>        Append sCap OLENull
36194>>>        Get OCXLicense To Lic
36195>>>        Append Lic OLENull
36196>>>        Get OCXPropFile To sPropFile
36197>>>        Append sPropfile OLENull
36198>>>        Get Visible_State to iVisible
36199>>>        If (iVisible) Move WS_VISIBLE to dwSty
36202>>>        Else Move 0 to dwSty
36204>>>        Get Private.OCXShadowState to iShadow
36205>>>        If (iShadow) Move (dwSty ior WS_DISABLED) to dwSty
36208>>>        Move (dwSty ior WS_TABSTOP) to dwSty
36209>>>        Move (CreateOCXControl(iClientId,HWnd,sPrgId,sCap,dwSty,lic,sPropFile)) to iRetVal
36210>>>        Send PostCreateOCX
36211>>>    End_Procedure
36212>>>
36212>>>    Procedure UnloadOCX
36213>>>        Local Integer iRetVal
36214>>>                Local Integer iClientId
36214>>>                Get ClientId to iClientId
36215>>>                Move (DestroyOCXControl(iClientId)) to iRetVal
36216>>>    End_Procedure
36217>>>
36217>>>    //This procedure is triggered before the OCX control is created
36217>>>    Procedure PreCreateOCX
36218>>>    End_Procedure
36219>>>
36219>>>    //This procedure is triggered after the OCX control is created but
36219>>>    //before it's shown
36219>>>    Procedure PostCreateOCX
36220>>>    End_Procedure
36221>>>End_Class
36222>>>
36222>>>// The non data aware OCX class
36222>>>// Derive from this class if you DON'T want your ActiveX control to be data aware
36222>>>Class OCX_Client is a FormExternalControl
36223>>>    Import_Class_Protocol cOCX_Client_Mixin
36224>>>
36224>>>    //These allows us to use the VDF standard 'Value' to get and set the
36224>>>    // caption of the ActiveX control (e.g. Get/Set Value to someVariable)
36224>>>
36224>>>    Procedure Set ControlValue string sVal
36225>>>        Set OCXCaption to sVal
36226>>>    End_Procedure
36227>>>
36227>>>    Function Value Integer item_number Returns String
36228>>>        Function_Return (OCXCaption(Current_Object))
36229>>>    End_Function
36230>>>
36230>>>End_Class
36231>>>
36231>>>
36231>>>// The Data aware OCX class
36231>>>// Derive from this class if you want your ActiveX control to be data aware
36231>>>Class dbOCX_Client is a dbFormExternalControl
36232>>>    Import_Class_Protocol cOCX_Client_Mixin
36233>>>
36233>>>    Procedure DefinedbOCX_Client
36234>>>        Send DefineOCX_Client
36235>>>        Property String  Private.OCXdbValue public ""
36236>>>    End_Procedure
36237>>>
36237>>>    Procedure Set ControlValue string sVal
36238>>>        If (Window_Handle(Current_Object));            Send OnRefreshDbOcxValue sVal
36241>>>    End_Procedure
36242>>>
36242>>>    Function ControlValue Returns String
36243>>>        Function_Return (Private.OCXDbValue(Current_Object))
36244>>>    End_Function
36245>>>
36245>>>    //Triggered when the database value has changed,
36245>>>    // and the ActiveX control needs to be updated
36245>>>    //Override and perform necessary updating to the OCX
36245>>>    Procedure OnRefreshDbOcxValue String sVal
36246>>>    End_Procedure
36247>>>
36247>>>    //Should be called when the ActiveX control's value has changed,
36247>>>    // and the database value needs to be updated
36247>>>    Procedure UpdateDbOcxValue String sVal
36248>>>        Set Private.OCXdbValue to sVal
36249>>>        Send ControlValueChanged
36250>>>    End_Procedure
36251>>>
36251>>>End_Class
36252>>>
36252>>>
36252>>>// Command for common declarations of ActiveX control classes, only used internally
36252>>>
36252>>>
36252>>>Use FontDisp
INCLUDING FILE: FONTDISP.PKG
36252>>>>>// OLEStdFont Charset Constants
36252>>>>>Enum_List
36252>>>>>        Define OLEANSI_CHARSET for 0 
36252>>>>>        Define OLEDEFAULT_CHARSET for 1
36252>>>>>        Define OLESYMBOL_CHARSET for 2
36252>>>>>End_Enum_List
36252>>>>>
36252>>>>>
36252>>>>>// CLSID:{BEF6E003-A874-101A-8BBA-00AA00300CAB}
36252>>>>>// ProgId: 
36252>>>>>Class OLEFontMixin is a Automation_Client
36253>>>>>
36253>>>>>        Function StdFontName Returns String
36254>>>>>                Local String lpropVal
36255>>>>>                Get GetStringProperty 0 to lpropVal
36256>>>>>                Function_Return lpropVal
36257>>>>>        End_Function
36258>>>>>
36258>>>>>        Procedure SET StdFontName String lpropVal
36259>>>>>                Send SetStringProperty 0 lpropVal
36260>>>>>        End_Procedure
36261>>>>>
36261>>>>>        Function StdFontSize Returns Currency
36262>>>>>                Local Currency lpropVal
36263>>>>>                Get GetCurrencyProperty 2 to lpropVal
36264>>>>>                Function_Return lpropVal
36265>>>>>        End_Function
36266>>>>>
36266>>>>>        Procedure SET StdFontSize Currency lpropVal
36267>>>>>                Send SetCurrencyProperty 2 lpropVal
36268>>>>>        End_Procedure
36269>>>>>
36269>>>>>        Function StdFontBold Returns Bool
36270>>>>>                Local Bool lpropVal
36271>>>>>                Get GetBoolProperty 3 to lpropVal
36272>>>>>                Function_Return lpropVal
36273>>>>>        End_Function
36274>>>>>
36274>>>>>        Procedure SET StdFontBold Bool lpropVal
36275>>>>>                Send SetBoolProperty 3 lpropVal
36276>>>>>        End_Procedure
36277>>>>>
36277>>>>>        Function StdFontItalic Returns Bool
36278>>>>>                Local Bool lpropVal
36279>>>>>                Get GetBoolProperty 4 to lpropVal
36280>>>>>                Function_Return lpropVal
36281>>>>>        End_Function
36282>>>>>
36282>>>>>        Procedure SET StdFontItalic Bool lpropVal
36283>>>>>                Send SetBoolProperty 4 lpropVal
36284>>>>>        End_Procedure
36285>>>>>
36285>>>>>        Function StdFontUnderline Returns Bool
36286>>>>>                Local Bool lpropVal
36287>>>>>                Get GetBoolProperty 5 to lpropVal
36288>>>>>                Function_Return lpropVal
36289>>>>>        End_Function
36290>>>>>
36290>>>>>        Procedure SET StdFontUnderline Bool lpropVal
36291>>>>>                Send SetBoolProperty 5 lpropVal
36292>>>>>        End_Procedure
36293>>>>>
36293>>>>>        Function StdFontStrikethrough Returns Bool
36294>>>>>                Local Bool lpropVal
36295>>>>>                Get GetBoolProperty 6 to lpropVal
36296>>>>>                Function_Return lpropVal
36297>>>>>        End_Function
36298>>>>>
36298>>>>>        Procedure SET StdFontStrikethrough Bool lpropVal
36299>>>>>                Send SetBoolProperty 6 lpropVal
36300>>>>>        End_Procedure
36301>>>>>
36301>>>>>        Function StdFontWeight Returns Integer
36302>>>>>                Local Integer lpropVal
36303>>>>>                Get GetShortProperty 7 to lpropVal
36304>>>>>                Function_Return lpropVal
36305>>>>>        End_Function
36306>>>>>
36306>>>>>        Procedure SET StdFontWeight Integer lpropVal
36307>>>>>                Send SetShortProperty 7 lpropVal
36308>>>>>        End_Procedure
36309>>>>>
36309>>>>>        Function StdFontCharset Returns Integer
36310>>>>>                Local Integer lpropVal
36311>>>>>                Get GetShortProperty 8 to lpropVal
36312>>>>>                Function_Return lpropVal
36313>>>>>        End_Function
36314>>>>>
36314>>>>>        Procedure SET StdFontCharset Integer lpropVal
36315>>>>>                Send SetShortProperty 8 lpropVal
36316>>>>>        End_Procedure
36317>>>>>
36317>>>>>End_Class
36318>>>>>
36318>>>>>// CoClass CLSID:{0BE35203-8F91-11CE-9DE3-00AA004BB851}
36318>>>>>// ProgId: StdFont
36318>>>>>// Number of impl.Types:1
36318>>>>>// Referenced class Font
36318>>>>>Class OLEStdFont is a Automation_Client
36319>>>>>        Import_Class_Protocol OLEFontMixin
36320>>>>>
36320>>>>>        Procedure Construct_Object
36321>>>>>                Forward Send Construct_Object
36323>>>>>                Set progIdStr to "StdFont"
36324>>>>>        End_Procedure
36325>>>>>End_Class
36326>>>Use PicDisp
INCLUDING FILE: PICDISP.PKG
36326>>>>>
36326>>>>>// Picture Type Constants
36326>>>>>//Enum_List
36326>>>>>        Define OLEPICTYPE_UNINITIALIZED for -1 // Uninitialized
36326>>>>>        Define OLEPICTYPE_NONE for 0 // None
36326>>>>>        Define OLEPICTYPE_BITMAP for 1 // Bitmap
36326>>>>>        Define OLEPICTYPE_METAFILE for 2 // Windows Metafile
36326>>>>>        Define OLEPICTYPE_ICON for 3 // Icon
36326>>>>>        Define OLEPICTYPE_ENHMETAFILE for 4 // Enhanced Metafile
36326>>>>>//End_Enum_List
36326>>>>>
36326>>>>>// CLSID:{7BF80981-BF32-101A-8BBB-00AA00300CAB}
36326>>>>>// ProgId: 
36326>>>>>Class OLEPictureMixin is a Automation_Client
36327>>>>>
36327>>>>>        Function StdPictureHandle Returns OLE_HANDLE
36328>>>>>                Local OLE_HANDLE lpropVal
36329>>>>>                Get GetIntegerProperty 0 to lpropVal
36330>>>>>                Function_Return lpropVal
36331>>>>>        End_Function
36332>>>>>
36332>>>>>        Function StdPicturehPal Returns OLE_HANDLE
36333>>>>>                Local OLE_HANDLE lpropVal
36334>>>>>                Get GetIntegerProperty 2 to lpropVal
36335>>>>>                Function_Return lpropVal
36336>>>>>        End_Function
36337>>>>>
36337>>>>>        Procedure SET StdPicturehPal OLE_HANDLE lpropVal
36338>>>>>                Send SetIntegerProperty 2 lpropVal
36339>>>>>        End_Procedure
36340>>>>>
36340>>>>>        Function StdPictureType Returns Integer
36341>>>>>                Local Integer lpropVal
36342>>>>>                Get GetShortProperty 3 to lpropVal
36343>>>>>                Function_Return lpropVal
36344>>>>>        End_Function
36345>>>>>
36345>>>>>        Function StdPictureWidth Returns OLE_XSIZE_HIMETRIC
36346>>>>>                Local OLE_XSIZE_HIMETRIC lpropVal
36347>>>>>                Get GetIntegerProperty 4 to lpropVal
36348>>>>>                Function_Return lpropVal
36349>>>>>        End_Function
36350>>>>>
36350>>>>>        Function StdPictureHeight Returns OLE_YSIZE_HIMETRIC
36351>>>>>                Local OLE_YSIZE_HIMETRIC lpropVal
36352>>>>>                Get GetIntegerProperty 5 to lpropVal
36353>>>>>                Function_Return lpropVal
36354>>>>>        End_Function
36355>>>>>
36355>>>>>        Procedure StdPictureRender DWORD lhdc DWORD lx DWORD ly DWORD lcx DWORD lcy OLE_XPOS_HIMETRIC lxSrc OLE_YPOS_HIMETRIC lySrc OLE_XSIZE_HIMETRIC lcxSrc OLE_YSIZE_HIMETRIC lcySrc LPOLE_RECT lprcWBounds
36356>>>>>                Send DeclareParams 10
36357>>>>>                Send DefineIntegerParam lhdc
36358>>>>>                Send DefineIntegerParam lx
36359>>>>>                Send DefineIntegerParam ly
36360>>>>>                Send DefineIntegerParam lcx
36361>>>>>                Send DefineIntegerParam lcy
36362>>>>>                Send DefineIntegerParam lxSrc
36363>>>>>                Send DefineIntegerParam lySrc
36364>>>>>                Send DefineIntegerParam lcxSrc
36365>>>>>                Send DefineIntegerParam lcySrc
36366>>>>>                Send DefineIntegerParam lprcWBounds
36367>>>>>                Send InvokeVoidFunction 6
36368>>>>>        End_Procedure 
36369>>>>>
36369>>>>>End_Class
36370>>>>>
36370>>>>>// CoClass CLSID:{0BE35204-8F91-11CE-9DE3-00AA004BB851}
36370>>>>>// ProgId: StdPicture
36370>>>>>// Number of impl.Types:1
36370>>>>>// Referenced class Picture
36370>>>>>Class OLEStdPicture is a Automation_Client
36371>>>>>        Import_Class_Protocol OLEPictureMixin
36372>>>>>
36372>>>>>        Procedure Construct_Object
36373>>>>>                Forward Send Construct_Object
36375>>>>>                Set progIdStr to "StdPicture"
36376>>>>>        End_Procedure
36377>>>>>End_Class
36378>Use DPDlg    // Full Path Directory Picker
INCLUDING FILE: DPDLG.PKG
36378>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\DPDLG.OCX
36378>>>// Generated by FlexOLE Class Generator Friday, November 10, 2000 17:30:33
36378>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
36378>>>
36378>>>//Enum_List
36378>>>    Define OLEdpdDesktop        for  0 // Desktop
36378>>>    Define OLEdpdControlPanel   for  1 // Control Panel
36378>>>    Define OLEdpdDesktopDir     for  2 // Desktop Directory
36378>>>    Define OLEdpdMyComputer     for  3 // My Computer
36378>>>    Define OLEdpdFontDir        for  4 // Font Directory
36378>>>    Define OLEdpdNetwork        for  5 // Network Neighborhood
36378>>>    Define OLEdpdPrinters       for  6 // Printers
36378>>>    Define OLEdpdPrograms       for  7 // Programs
36378>>>    Define OLEdpdRecent         for  8 // Recent
36378>>>    Define OLEdpdRecycleBin     for  9 // Recycle Bin
36378>>>    Define OLEdpdSendTo         for 10 // Send To
36378>>>    Define OLEdpdStartMenu      for 11 // Start Menu
36378>>>    Define OLEdpdStartUp        for 12 // Start Up
36378>>>    Define OLEdpdTemplates      for 13 // Templates
36378>>>    Define OLEdpdCustom         for 14 // Custom Root
36378>>>//End_Enum_List
36378>>>
36378>>>// Dispatch interface for DPDlg Control
36378>>>// CLSID:{BE5AB244-F888-11D0-9F5E-B42103C10710}
36378>>>// ProgId:
36378>>>Class OLE_DDPDlg is a Message
36379>>>
36379>>>        Function DPDlgBrowseForComputer Returns Bool
36380>>>                Local Bool lpropVal
36381>>>                Get GetBoolProperty 1 to lpropVal
36382>>>                Function_Return lpropVal
36383>>>        End_Function
36384>>>
36384>>>        Procedure SET DPDlgBrowseForComputer Bool lpropVal
36385>>>                Send SetBoolProperty 1 lpropVal
36386>>>        End_Procedure
36387>>>
36387>>>        Function DPDlgBrowseForPrinter Returns Bool
36388>>>                Local Bool lpropVal
36389>>>                Get GetBoolProperty 2 to lpropVal
36390>>>                Function_Return lpropVal
36391>>>        End_Function
36392>>>
36392>>>        Procedure SET DPDlgBrowseForPrinter Bool lpropVal
36393>>>                Send SetBoolProperty 2 lpropVal
36394>>>        End_Procedure
36395>>>
36395>>>        Function DPDlgDontGoBelowDomain Returns Bool
36396>>>                Local Bool lpropVal
36397>>>                Get GetBoolProperty 3 to lpropVal
36398>>>                Function_Return lpropVal
36399>>>        End_Function
36400>>>
36400>>>        Procedure SET DPDlgDontGoBelowDomain Bool lpropVal
36401>>>                Send SetBoolProperty 3 lpropVal
36402>>>        End_Procedure
36403>>>
36403>>>        Function DPDlgReturnFSAncestors Returns Bool
36404>>>                Local Bool lpropVal
36405>>>                Get GetBoolProperty 4 to lpropVal
36406>>>                Function_Return lpropVal
36407>>>        End_Function
36408>>>
36408>>>        Procedure SET DPDlgReturnFSAncestors Bool lpropVal
36409>>>                Send SetBoolProperty 4 lpropVal
36410>>>        End_Procedure
36411>>>
36411>>>        Function DPDlgReturnOnlyFSDirs Returns Bool
36412>>>                Local Bool lpropVal
36413>>>                Get GetBoolProperty 5 to lpropVal
36414>>>                Function_Return lpropVal
36415>>>        End_Function
36416>>>
36416>>>        Procedure SET DPDlgReturnOnlyFSDirs Bool lpropVal
36417>>>                Send SetBoolProperty 5 lpropVal
36418>>>        End_Procedure
36419>>>
36419>>>        Function DPDlgRoot Returns OLE_ROOTSHORT
36420>>>                Local OLE_ROOTSHORT lpropVal
36421>>>                Get GetIntegerProperty 6 to lpropVal
36422>>>                Function_Return lpropVal
36423>>>        End_Function
36424>>>
36424>>>        Procedure SET DPDlgRoot OLE_ROOTSHORT lpropVal
36425>>>                Send SetIntegerProperty 6 lpropVal
36426>>>        End_Procedure
36427>>>
36427>>>        Function DPDlghWnd Returns OLE_HANDLE
36428>>>                Local OLE_HANDLE lpropVal
36429>>>                Get GetIntegerProperty -515 to lpropVal
36430>>>                Function_Return lpropVal
36431>>>        End_Function
36432>>>
36432>>>        Procedure SET DPDlghWnd OLE_HANDLE lpropVal
36433>>>                Send SetIntegerProperty -515 lpropVal
36434>>>        End_Procedure
36435>>>
36435>>>        Function DPDlgIcon Returns LPDispatch
36436>>>                Local LPDispatch lpropVal
36437>>>                Get GetLPDispatchProperty 7 to lpropVal
36438>>>                Function_Return lpropVal
36439>>>        End_Function
36440>>>
36440>>>        Procedure SET DPDlgIcon LPDispatch lpropVal
36441>>>                Send SetLPDispatchProperty 7 lpropVal
36442>>>        End_Procedure
36443>>>
36443>>>        Function DPDlgFolder Returns String
36444>>>                Local String lpropVal
36445>>>                Get GetStringProperty 8 to lpropVal
36446>>>                Function_Return lpropVal
36447>>>        End_Function
36448>>>
36448>>>        Procedure SET DPDlgFolder String lpropVal
36449>>>                Send SetStringProperty 8 lpropVal
36450>>>        End_Procedure
36451>>>
36451>>>        Function DPDlgCaption Returns String
36452>>>                Local String lpropVal
36453>>>                Get GetStringProperty -518 to lpropVal
36454>>>                Function_Return lpropVal
36455>>>        End_Function
36456>>>
36456>>>        Procedure SET DPDlgCaption String lpropVal
36457>>>                Send SetStringProperty -518 lpropVal
36458>>>        End_Procedure
36459>>>
36459>>>        Function DPDlg_Caption Returns String
36460>>>                Local String lpropVal
36461>>>                Get GetStringProperty 0 to lpropVal
36462>>>                Function_Return lpropVal
36463>>>        End_Function
36464>>>
36464>>>        Procedure SET DPDlg_Caption String lpropVal
36465>>>                Send SetStringProperty 0 lpropVal
36466>>>        End_Procedure
36467>>>
36467>>>        Function DPDlgPath Returns String
36468>>>                Local String lpropVal
36469>>>                Get GetStringProperty 9 to lpropVal
36470>>>                Function_Return lpropVal
36471>>>        End_Function
36472>>>
36472>>>        Procedure SET DPDlgPath String lpropVal
36473>>>                Send SetStringProperty 9 lpropVal
36474>>>        End_Procedure
36475>>>
36475>>>        Function DPDlgCustomRoot Returns String
36476>>>                Local String lpropVal
36477>>>                Get GetStringProperty 10 to lpropVal
36478>>>                Function_Return lpropVal
36479>>>        End_Function
36480>>>
36480>>>        Procedure SET DPDlgCustomRoot String lpropVal
36481>>>                Send SetStringProperty 10 lpropVal
36482>>>        End_Procedure
36483>>>
36483>>>        Function DPDlgShow Returns Bool
36484>>>                Local Bool lretVal
36485>>>                Get InvokeBoolFunction 11 to lretVal
36486>>>                Function_Return lretVal
36487>>>        End_Function
36488>>>
36488>>>        Procedure DPDlgAboutBox
36489>>>                Send InvokeVoidFunction -552
36490>>>        End_Procedure
36491>>>
36491>>>End_Class
36492>>>
36492>>>// Event interface for DPDlg Control
36492>>>// CLSID:{BE5AB245-F888-11D0-9F5E-B42103C10710}
36492>>>// ProgId:
36492>>>Class OLE_DDPDlgEvents is a Message
36493>>>
36493>>>        Procedure OnDPDlgFolderSelected String lPath Bool lAllow
36494>>>        End_Procedure
36495>>>
36495>>>End_Class
36496>>>
36496>>>// DPDlg Control
36496>>>// CoClass CLSID:{BE5AB246-F888-11D0-9F5E-B42103C10710}
36496>>>// ProgId: DPDLG.DPDlgCtrl.1
36496>>>// Number of impl.Types:2
36496>>>// Referenced class _DDPDlg
36496>>>// Referenced class _DDPDlgEvents
36496>>>Class OLEDPDlg is a OCX_Client
36497>>>        Import_Class_Protocol OLE_DDPDlg
36498>>>        Import_Class_Protocol OLE_DDPDlgEvents
36499>>>
36499>>>        Procedure Construct_Object
36500>>>                Forward Send Construct_Object
36502>>>                Send DefineOCX_Client
36503>>>                Set progIdStr to "DPDLG.DPDlgCtrl.1"
36504>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEDPDlg"
36507>>>        End_Procedure
36508>>>
36508>>>        Procedure PreDPDlgFolderSelected Integer lParam
36509>>>                Local String lPath
36510>>>                Local Bool lAllow
36510>>>                Get GetEventStringParam lParam 0 to lPath
36511>>>                Get GetEventBoolParam lParam 1 to lAllow
36512>>>                Send OnDPDlgFolderSelected lPath lAllow
36513>>>        End_Procedure
36514>>>
36514>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
36515>>>                ON_EVENT 1 Fire PreDPDlgFolderSelected
36518>>>        End_Procedure
36519>>>End_Class
36520>>>
36520>>>// DPDlg Control
36520>>>// CoClass CLSID:{BE5AB246-F888-11D0-9F5E-B42103C10710}
36520>>>// ProgId: DPDLG.DPDlgCtrl.1
36520>>>// Number of impl.Types:2
36520>>>// Referenced class _DDPDlg
36520>>>// Referenced class _DDPDlgEvents
36520>>>Class dbOLEDPDlg is a dbOCX_Client
36521>>>        Import_Class_Protocol OLE_DDPDlg
36522>>>        Import_Class_Protocol OLE_DDPDlgEvents
36523>>>
36523>>>        Procedure Construct_Object
36524>>>                Forward Send Construct_Object
36526>>>                Send DefineDbOCX_Client
36527>>>                Set progIdStr to "DPDLG.DPDlgCtrl.1"
36528>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEDPDlg"
36531>>>        End_Procedure
36532>>>
36532>>>        Procedure PreDPDlgFolderSelected Integer lParam
36533>>>                Local String lPath
36534>>>                Local Bool lAllow
36534>>>                Get GetEventStringParam lParam 0 to lPath
36535>>>                Get GetEventBoolParam lParam 1 to lAllow
36536>>>                Send OnDPDlgFolderSelected lPath lAllow
36537>>>        End_Procedure
36538>>>
36538>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
36539>>>                ON_EVENT 1 Fire PreDPDlgFolderSelected
36542>>>        End_Procedure
36543>>>End_Class
36544>Use RasxDll  // Ras Package
INCLUDING FILE: RASXDLL.PKG
36544>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\RASX.DLL
36544>>>// Generated by FlexOLE Class Generator Friday, November 08, 2002 15:47:23
36544>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
36544>>>
36544>>>//Enum_List
36544>>>    Define OLERasActionNone         for 0 // No action
36544>>>    Define OLERasActionConnect      for 1 // Connect server
36544>>>    Define OLERasActionGetEntry     for 2 // Get phonebook entry
36544>>>    Define OLERasActionDisconnect   for 3 // Hang up (disconnect from server)
36544>>>    Define OLERasActionRefresh      for 4 // Refresh entries list
36544>>>    Define OLERasActionCreateEntry  for 5 // Create phonebook entry
36544>>>    Define OLERasActionEditEntry    for 6 // Edit phonebook entry
36544>>>//End_Enum_List
36544>>>
36544>>>// IRasXCom Interface
36544>>>// CLSID:{8E71552C-4915-11D3-B4C3-0020AFD69DE6}
36544>>>// ProgId:
36544>>>Class OLEIRasXCom is a Automation_Client
36545>>>
36545>>>// Sets or returns the filename of the phonebook to use.
36545>>>        Function RasXComPhoneBook Returns String
36546>>>                Local String lpropVal
36547>>>                Get GetStringProperty 1 to lpropVal
36548>>>                Function_Return lpropVal
36549>>>        End_Function
36550>>>
36550>>>// Sets or returns the filename of the phonebook to use.
36550>>>        Procedure SET RasXComPhoneBook String lpropVal
36551>>>                Send SetStringProperty 1 lpropVal
36552>>>        End_Procedure
36553>>>
36553>>>// Sets or returns the phone number to dial.
36553>>>        Function RasXComPhoneNumber Returns String
36554>>>                Local String lpropVal
36555>>>                Get GetStringProperty 2 to lpropVal
36556>>>                Function_Return lpropVal
36557>>>        End_Function
36558>>>
36558>>>// Sets or returns the phone number to dial.
36558>>>        Procedure SET RasXComPhoneNumber String lpropVal
36559>>>                Send SetStringProperty 2 lpropVal
36560>>>        End_Procedure
36561>>>
36561>>>// Sets or returns the name to use when logging on.
36561>>>        Function RasXComLogonName Returns String
36562>>>                Local String lpropVal
36563>>>                Get GetStringProperty 3 to lpropVal
36564>>>                Function_Return lpropVal
36565>>>        End_Function
36566>>>
36566>>>// Sets or returns the name to use when logging on.
36566>>>        Procedure SET RasXComLogonName String lpropVal
36567>>>                Send SetStringProperty 3 lpropVal
36568>>>        End_Procedure
36569>>>
36569>>>// Sets or returns the password to use.
36569>>>        Function RasXComLogonPassword Returns String
36570>>>                Local String lpropVal
36571>>>                Get GetStringProperty 4 to lpropVal
36572>>>                Function_Return lpropVal
36573>>>        End_Function
36574>>>
36574>>>// Sets or returns the password to use.
36574>>>        Procedure SET RasXComLogonPassword String lpropVal
36575>>>                Send SetStringProperty 4 lpropVal
36576>>>        End_Procedure
36577>>>
36577>>>// Sets or returns the phone number that a server should call back for certain kinds of verification.
36577>>>        Function RasXComCallbackNumber Returns String
36578>>>                Local String lpropVal
36579>>>                Get GetStringProperty 5 to lpropVal
36580>>>                Function_Return lpropVal
36581>>>        End_Function
36582>>>
36582>>>// Sets or returns the phone number that a server should call back for certain kinds of verification.
36582>>>        Procedure SET RasXComCallbackNumber String lpropVal
36583>>>                Send SetStringProperty 5 lpropVal
36584>>>        End_Procedure
36585>>>
36585>>>// Sets or returns the name of the current phone book entry.
36585>>>        Function RasXComEntryName Returns String
36586>>>                Local String lpropVal
36587>>>                Get GetStringProperty 6 to lpropVal
36588>>>                Function_Return lpropVal
36589>>>        End_Function
36590>>>
36590>>>// Sets or returns the name of the current phone book entry.
36590>>>        Procedure SET RasXComEntryName String lpropVal
36591>>>                Send SetStringProperty 6 lpropVal
36592>>>        End_Procedure
36593>>>
36593>>>// Sets or returns the domain to use for user authentication.
36593>>>        Function RasXComDomain Returns String
36594>>>                Local String lpropVal
36595>>>                Get GetStringProperty 7 to lpropVal
36596>>>                Function_Return lpropVal
36597>>>        End_Function
36598>>>
36598>>>// Sets or returns the domain to use for user authentication.
36598>>>        Procedure SET RasXComDomain String lpropVal
36599>>>                Send SetStringProperty 7 lpropVal
36600>>>        End_Procedure
36601>>>
36601>>>// Determines if methods are blocking.
36601>>>        Function RasXComBlocking Returns Bool
36602>>>                Local Bool lpropVal
36603>>>                Get GetBoolProperty 8 to lpropVal
36604>>>                Function_Return lpropVal
36605>>>        End_Function
36606>>>
36606>>>// Determines if methods are blocking.
36606>>>        Procedure SET RasXComBlocking Bool lpropVal
36607>>>                Send SetBoolProperty 8 lpropVal
36608>>>        End_Procedure
36609>>>
36609>>>// Returns the version of the control.
36609>>>        Function RasXComVersion Returns String
36610>>>                Local String lpropVal
36611>>>                Get GetStringProperty 9 to lpropVal
36612>>>                Function_Return lpropVal
36613>>>        End_Function
36614>>>
36614>>>// Returns the number of names in the current phonebook.
36614>>>        Function RasXComEntryCount Returns Integer
36615>>>                Local Integer lpropVal
36616>>>                Get GetShortProperty 10 to lpropVal
36617>>>                Function_Return lpropVal
36618>>>        End_Function
36619>>>
36619>>>// Returns whether or not RAS services are available.
36619>>>        Function RasXComRASAvailable Returns Bool
36620>>>                Local Bool lpropVal
36621>>>                Get GetBoolProperty 11 to lpropVal
36622>>>                Function_Return lpropVal
36623>>>        End_Function
36624>>>
36624>>>// Holds the last error number reported.
36624>>>        Function RasXComLastError Returns Integer
36625>>>                Local Integer lpropVal
36626>>>                Get GetShortProperty 12 to lpropVal
36627>>>                Function_Return lpropVal
36628>>>        End_Function
36629>>>
36629>>>// Returns the last method executed.
36629>>>        Function RasXComLastMethod Returns OLE_MethodsEnum
36630>>>                Local OLE_MethodsEnum lpropVal
36631>>>                Get GetIntegerProperty 13 to lpropVal
36632>>>                Function_Return lpropVal
36633>>>        End_Function
36634>>>
36634>>>// Holds a description of the last error number reported.
36634>>>        Function RasXComLastErrorString Returns String
36635>>>                Local String lpropVal
36636>>>                Get GetStringProperty 14 to lpropVal
36637>>>                Function_Return lpropVal
36638>>>        End_Function
36639>>>
36639>>>// The current state of the control.
36639>>>        Function RasXComState Returns Integer
36640>>>                Local Integer lpropVal
36641>>>                Get GetShortProperty 15 to lpropVal
36642>>>                Function_Return lpropVal
36643>>>        End_Function
36644>>>
36644>>>// A user-friendly version of the current state of the control.
36644>>>        Function RasXComStateString Returns String
36645>>>                Local String lpropVal
36646>>>                Get GetStringProperty 16 to lpropVal
36647>>>                Function_Return lpropVal
36648>>>        End_Function
36649>>>
36649>>>// Returns the RAS handle of a connection.
36649>>>        Function RasXComHandle Returns DWORD
36650>>>                Local DWORD lpropVal
36651>>>                Get GetIntegerProperty 17 to lpropVal
36652>>>                Function_Return lpropVal
36653>>>        End_Function
36654>>>
36654>>>// Returns whether or not a connection is active.
36654>>>        Function RasXComEntryConnected Returns Bool
36655>>>                Local Bool lpropVal
36656>>>                Get GetBoolProperty 18 to lpropVal
36657>>>                Function_Return lpropVal
36658>>>        End_Function
36659>>>
36659>>>// Returns the list of names in a phone book.
36659>>>        Function RasXComEntryList Integer lIndex Returns String
36660>>>                Local String lpropVal
36661>>>                Send DeclareParams 1
36662>>>                Send DefineShortParam lIndex
36663>>>                Get GetStringProperty 19 to lpropVal
36664>>>                Function_Return lpropVal
36665>>>        End_Function
36666>>>
36666>>>// Holds licensing information.
36666>>>        Function RasXComLicenseKey Returns String
36667>>>                Local String lpropVal
36668>>>                Get GetStringProperty 20 to lpropVal
36669>>>                Function_Return lpropVal
36670>>>        End_Function
36671>>>
36671>>>// Holds licensing information.
36671>>>        Procedure SET RasXComLicenseKey String lpropVal
36672>>>                Send SetStringProperty 20 lpropVal
36673>>>        End_Procedure
36674>>>
36674>>>// Connects to a server.
36674>>>        Procedure RasXComConnect
36675>>>                Send InvokeVoidFunction 22
36676>>>        End_Procedure
36677>>>
36677>>>// Disconnects (logs off) from the server.
36677>>>        Procedure RasXComDisconnect
36678>>>                Send InvokeVoidFunction 23
36679>>>        End_Procedure
36680>>>
36680>>>// Retrives an entry from the current phonebook.
36680>>>        Procedure RasXComGetEntry
36681>>>                Send InvokeVoidFunction 24
36682>>>        End_Procedure
36683>>>
36683>>>// Creates and entry in the current phone book.
36683>>>        Procedure RasXComCreateEntry
36684>>>                Send InvokeVoidFunction 25
36685>>>        End_Procedure
36686>>>
36686>>>// Allows the user to edit a RAS phone book entry.
36686>>>        Procedure RasXComEditEntry
36687>>>                Send InvokeVoidFunction 26
36688>>>        End_Procedure
36689>>>
36689>>>// Resets the component to its original state and re-loads the phone book.
36689>>>        Procedure RasXComRefresh
36690>>>                Send InvokeVoidFunction -550
36691>>>        End_Procedure
36692>>>
36692>>>// Displays About Box.
36692>>>        Procedure RasXComAbout
36693>>>                Send InvokeVoidFunction -552
36694>>>        End_Procedure
36695>>>
36695>>>// Allows object to unload without disconnecting the current connection.
36695>>>        Function RasXComDisconnectOnDestroy Returns Bool
36696>>>                Local Bool lpropVal
36697>>>                Get GetBoolProperty 28 to lpropVal
36698>>>                Function_Return lpropVal
36699>>>        End_Function
36700>>>
36700>>>// Allows object to unload without disconnecting the current connection.
36700>>>        Procedure SET RasXComDisconnectOnDestroy Bool lpropVal
36701>>>                Send SetBoolProperty 28 lpropVal
36702>>>        End_Procedure
36703>>>
36703>>>// Sets or returns an object reference to an object supporting the Fast Notification interface.
36703>>>        Function RasXComNotificationObject Returns LPDispatch
36704>>>                Local LPDispatch lpropVal
36705>>>                Get GetLPDispatchProperty 27 to lpropVal
36706>>>                Function_Return lpropVal
36707>>>        End_Function
36708>>>
36708>>>// Sets or returns an object reference to an object supporting the Fast Notification interface.
36708>>>        Procedure SET RasXComNotificationObject LPDispatch lpropVal
36709>>>                Send SetLPDispatchProperty 27 lpropVal
36710>>>        End_Procedure
36711>>>
36711>>>// Returns the version of the control.
36711>>>        Procedure SET RasXComVersion String lpropVal
36712>>>                Send SetStringProperty 9 lpropVal
36713>>>        End_Procedure
36714>>>
36714>>>End_Class
36715>>>
36715>>>// _IRasXComEvents Interface
36715>>>// CLSID:{8E71552E-4915-11D3-B4C3-0020AFD69DE6}
36715>>>// ProgId:
36715>>>Class OLE_IRasXComEvents is a Automation_Client
36716>>>
36716>>>// Fired when a method finishes.
36716>>>        Procedure RasXComDone OLE_MethodsEnum lLastMethod Integer lErrorCode String lErrorString
36717>>>                Send DeclareParams 3
36718>>>                Send DefineIntegerParam lLastMethod
36719>>>                Send DefineShortParam lErrorCode
36720>>>                Send DefineStringParam lErrorString
36721>>>                Send InvokeVoidFunction 1
36722>>>        End_Procedure
36723>>>
36723>>>// Fired when the control's internal state changes.
36723>>>        Procedure RasXComStateChanged Integer lNewState Integer lOldState
36724>>>                Send DeclareParams 2
36725>>>                Send DefineShortParam lNewState
36726>>>                Send DefineShortParam lOldState
36727>>>                Send InvokeVoidFunction 2
36728>>>        End_Procedure
36729>>>
36729>>>End_Class
36730>>>
36730>>>// RasXCom Class
36730>>>// CoClass CLSID:{8E71552D-4915-11D3-B4C3-0020AFD69DE6}
36730>>>// ProgId: Mabry.RasXCom.1
36730>>>// Number of impl.Types:2
36730>>>// Referenced class IRasXCom
36730>>>// Referenced class _IRasXComEvents
36730>>>Class OLERasXCom is a Automation_Client
36731>>>        Import_Class_Protocol OLEIRasXCom
36732>>>        Import_Class_Protocol OLE_IRasXComEvents
36733>>>
36733>>>        Procedure Construct_Object
36734>>>                Forward Send Construct_Object
36736>>>        Set progIdStr to "Mabry.RasXCom"
36737>>>        End_Procedure
36738>>>End_Class
36739>>>
36739>>>// IRasXComNotify Interface
36739>>>// CLSID:{40B44160-49E0-11D3-B4C3-0020AFD69DE6}
36739>>>// ProgId:
36739>>>Class OLEIRasXComNotify is a Automation_Client
36740>>>
36740>>>// Done
36740>>>        Procedure IRasXComNotifyDone LPDispatch lPackageObject OLE_MethodsEnum lLastMethod Integer lErrorCode String lErrorString
36741>>>                Send DeclareParams 4
36742>>>                Send DefineLPDispatchParam lPackageObject
36743>>>                Send DefineIntegerParam lLastMethod
36744>>>                Send DefineShortParam lErrorCode
36745>>>                Send DefineStringParam lErrorString
36746>>>                Send InvokeVoidFunction 1
36747>>>        End_Procedure
36748>>>
36748>>>// Fired when the control's internal state changes.
36748>>>        Procedure IRasXComNotifyStateChanged LPDispatch lPackageObject Integer lNewState Integer lOldState
36749>>>                Send DeclareParams 3
36750>>>                Send DefineLPDispatchParam lPackageObject
36751>>>                Send DefineShortParam lNewState
36752>>>                Send DefineShortParam lOldState
36753>>>                Send InvokeVoidFunction 2
36754>>>        End_Procedure
36755>>>
36755>>>End_Class
36756>Use Xfind    // Recursive Directory FILE FINDER
INCLUDING FILE: XFIND.PKG
36756>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\XFIND10DEMO.OCX
36756>>>// Generated by FlexOLE Class Generator Friday, November 10, 2000 16:23:24
36756>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
36756>>>
36756>>>// Dispatch interface for xfind Control
36756>>>// CLSID:{DF5A0221-37A0-11D4-881C-E7F891A83074}
36756>>>// ProgId: 
36756>>>Class OLEIxfind is a Message
36757>>>
36757>>>        Procedure xfindAboutBox
36758>>>                Send InvokeVoidFunction -552
36759>>>        End_Procedure 
36760>>>
36760>>>        Function xfindSearchString Returns String
36761>>>                Local String lpropVal
36762>>>                Get GetStringProperty 6 to lpropVal
36763>>>                Function_Return lpropVal
36764>>>        End_Function
36765>>>
36765>>>        Procedure SET xfindSearchString String lpropVal
36766>>>                Send SetStringProperty 6 lpropVal
36767>>>        End_Procedure
36768>>>
36768>>>        Function xfindSearchFrom Returns String
36769>>>                Local String lpropVal
36770>>>                Get GetStringProperty 7 to lpropVal
36771>>>                Function_Return lpropVal
36772>>>        End_Function
36773>>>
36773>>>        Procedure SET xfindSearchFrom String lpropVal
36774>>>                Send SetStringProperty 7 lpropVal
36775>>>        End_Procedure
36776>>>
36776>>>        Function xfindSearchSubDirs Returns Bool
36777>>>                Local Bool lpropVal
36778>>>                Get GetBoolProperty 8 to lpropVal
36779>>>                Function_Return lpropVal
36780>>>        End_Function
36781>>>
36781>>>        Procedure SET xfindSearchSubDirs Bool lpropVal
36782>>>                Send SetBoolProperty 8 lpropVal
36783>>>        End_Procedure
36784>>>
36784>>>        Procedure xfindStartSearching
36785>>>                Send InvokeVoidFunction 2
36786>>>        End_Procedure 
36787>>>
36787>>>        Function xfindIsSearching Returns Bool
36788>>>                Local Bool lpropVal
36789>>>                Get GetBoolProperty 5 to lpropVal
36790>>>                Function_Return lpropVal
36791>>>        End_Function
36792>>>
36792>>>        Procedure xfindAbortSearch
36793>>>                Send InvokeVoidFunction 9
36794>>>        End_Procedure 
36795>>>
36795>>>        Function xfindFileName Returns String
36796>>>                Local String lpropVal
36797>>>                Get GetStringProperty 3 to lpropVal
36798>>>                Function_Return lpropVal
36799>>>        End_Function
36800>>>
36800>>>        Function xfindFileSize Returns DWORD
36801>>>                Local DWORD lpropVal
36802>>>                Get GetIntegerProperty 4 to lpropVal
36803>>>                Function_Return lpropVal
36804>>>        End_Function
36805>>>
36805>>>End_Class
36806>>>
36806>>>// Events interface for xfind Control
36806>>>// CLSID:{DF5A0223-37A0-11D4-881C-E7F891A83074}
36806>>>// ProgId: 
36806>>>Class OLEIxfindEvents is a Message
36807>>>
36807>>>        Procedure OnxfindActivate
36808>>>        End_Procedure
36809>>>
36809>>>        Procedure OnxfindClick
36810>>>        End_Procedure
36811>>>
36811>>>        Procedure OnxfindCreate
36812>>>        End_Procedure
36813>>>
36813>>>        Procedure OnxfindDblClick
36814>>>        End_Procedure
36815>>>
36815>>>        Procedure OnxfindDestroy
36816>>>        End_Procedure
36817>>>
36817>>>        Procedure OnxfindDeactivate
36818>>>        End_Procedure
36819>>>
36819>>>        Procedure OnxfindKeyPress Integer lKey
36820>>>        End_Procedure
36821>>>
36821>>>        Procedure OnxfindPaint
36822>>>        End_Procedure
36823>>>
36823>>>        Procedure OnxfindFinishedSearch
36824>>>        End_Procedure
36825>>>
36825>>>        Procedure OnxfindFoundFile
36826>>>        End_Procedure
36827>>>
36827>>>End_Class
36828>>>
36828>>>// xfind Control
36828>>>// CoClass CLSID:{DF5A0225-37A0-11D4-881C-E7F891A83074}
36828>>>// ProgId: xfind10.xfind
36828>>>// Number of impl.Types:2
36828>>>// Referenced class Ixfind
36828>>>// Referenced class IxfindEvents
36828>>>Class OLExfind is a OCX_Client
36829>>>        Import_Class_Protocol OLEIxfind
36830>>>        Import_Class_Protocol OLEIxfindEvents
36831>>>
36831>>>        Procedure Construct_Object
36832>>>                Forward Send Construct_Object
36834>>>                Send DefineOCX_Client
36835>>>                Set progIdStr to "xfind10.xfind"
36836>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLExfind"
36839>>>        End_Procedure
36840>>>
36840>>>        Procedure PrexfindKeyPress Integer lParam
36841>>>                Local Integer lKey
36842>>>                Get GetEventShortParam lParam 0 to lKey
36843>>>                Send OnxfindKeyPress lKey
36844>>>        End_Procedure
36845>>>
36845>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
36846>>>                ON_EVENT 1 Fire OnxfindActivate
36849>>>                ON_EVENT 2 Fire OnxfindClick
36852>>>                ON_EVENT 3 Fire OnxfindCreate
36855>>>                ON_EVENT 5 Fire OnxfindDblClick
36858>>>                ON_EVENT 6 Fire OnxfindDestroy
36861>>>                ON_EVENT 7 Fire OnxfindDeactivate
36864>>>                ON_EVENT 11 Fire PrexfindKeyPress
36867>>>                ON_EVENT 16 Fire OnxfindPaint
36870>>>                ON_EVENT 4 Fire OnxfindFinishedSearch
36873>>>                ON_EVENT 8 Fire OnxfindFoundFile
36876>>>        End_Procedure
36877>>>End_Class
36878>>>
36878>>>// xfind Control
36878>>>// CoClass CLSID:{DF5A0225-37A0-11D4-881C-E7F891A83074}
36878>>>// ProgId: xfind10.xfind
36878>>>// Number of impl.Types:2
36878>>>// Referenced class Ixfind
36878>>>// Referenced class IxfindEvents
36878>>>Class dbOLExfind is a dbOCX_Client
36879>>>        Import_Class_Protocol OLEIxfind
36880>>>        Import_Class_Protocol OLEIxfindEvents
36881>>>
36881>>>        Procedure Construct_Object
36882>>>                Forward Send Construct_Object
36884>>>                Send DefineDbOCX_Client
36885>>>                Set progIdStr to "xfind10.xfind"
36886>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLExfind"
36889>>>        End_Procedure
36890>>>
36890>>>        Procedure PrexfindKeyPress Integer lParam
36891>>>                Local Integer lKey
36892>>>                Get GetEventShortParam lParam 0 to lKey
36893>>>                Send OnxfindKeyPress lKey
36894>>>        End_Procedure
36895>>>
36895>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
36896>>>                ON_EVENT 1 Fire OnxfindActivate
36899>>>                ON_EVENT 2 Fire OnxfindClick
36902>>>                ON_EVENT 3 Fire OnxfindCreate
36905>>>                ON_EVENT 5 Fire OnxfindDblClick
36908>>>                ON_EVENT 6 Fire OnxfindDestroy
36911>>>                ON_EVENT 7 Fire OnxfindDeactivate
36914>>>                ON_EVENT 11 Fire PrexfindKeyPress
36917>>>                ON_EVENT 16 Fire OnxfindPaint
36920>>>                ON_EVENT 4 Fire OnxfindFinishedSearch
36923>>>                ON_EVENT 8 Fire OnxfindFoundFile
36926>>>        End_Procedure
36927>>>End_Class
36928>Use EZFTP    // Ftp Package
INCLUDING FILE: EZFTP.PKG
36928>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\EZFTP.OCX
36928>>>// Generated by FlexOLE Class Generator Thursday, December 28, 2000 13:30:32
36928>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
36928>>>
36928>>>// Dispatch interface for EZFTP Control
36928>>>// CLSID:{6580F765-7819-11CF-B86C-444553540000}
36928>>>// ProgId:
36928>>>Class OLE_DEZFTP is a Message
36929>>>
36929>>>        Function EZFTPRemoteAddress Returns String
36930>>>                Local String lpropVal
36931>>>                Get GetStringProperty 1 to lpropVal
36932>>>                Function_Return lpropVal
36933>>>        End_Function
36934>>>
36934>>>        Procedure SET EZFTPRemoteAddress String lpropVal
36935>>>                Send SetStringProperty 1 lpropVal
36936>>>        End_Procedure
36937>>>
36937>>>        Function EZFTPLocalFile Returns String
36938>>>                Local String lpropVal
36939>>>                Get GetStringProperty 2 to lpropVal
36940>>>                Function_Return lpropVal
36941>>>        End_Function
36942>>>
36942>>>        Procedure SET EZFTPLocalFile String lpropVal
36943>>>                Send SetStringProperty 2 lpropVal
36944>>>        End_Procedure
36945>>>
36945>>>        Function EZFTPRemoteFile Returns String
36946>>>                Local String lpropVal
36947>>>                Get GetStringProperty 3 to lpropVal
36948>>>                Function_Return lpropVal
36949>>>        End_Function
36950>>>
36950>>>        Procedure SET EZFTPRemoteFile String lpropVal
36951>>>                Send SetStringProperty 3 lpropVal
36952>>>        End_Procedure
36953>>>
36953>>>        Function EZFTPUserName Returns String
36954>>>                Local String lpropVal
36955>>>                Get GetStringProperty 4 to lpropVal
36956>>>                Function_Return lpropVal
36957>>>        End_Function
36958>>>
36958>>>        Procedure SET EZFTPUserName String lpropVal
36959>>>                Send SetStringProperty 4 lpropVal
36960>>>        End_Procedure
36961>>>
36961>>>        Function EZFTPPassword Returns String
36962>>>                Local String lpropVal
36963>>>                Get GetStringProperty 5 to lpropVal
36964>>>                Function_Return lpropVal
36965>>>        End_Function
36966>>>
36966>>>        Procedure SET EZFTPPassword String lpropVal
36967>>>                Send SetStringProperty 5 lpropVal
36968>>>        End_Procedure
36969>>>
36969>>>        Function EZFTPBinary Returns Bool
36970>>>                Local Bool lpropVal
36971>>>                Get GetBoolProperty 6 to lpropVal
36972>>>                Function_Return lpropVal
36973>>>        End_Function
36974>>>
36974>>>        Procedure SET EZFTPBinary Bool lpropVal
36975>>>                Send SetBoolProperty 6 lpropVal
36976>>>        End_Procedure
36977>>>
36977>>>        Function EZFTPRemoteDirectory Returns String
36978>>>                Local String lpropVal
36979>>>                Get GetStringProperty 9 to lpropVal
36980>>>                Function_Return lpropVal
36981>>>        End_Function
36982>>>
36982>>>        Procedure SET EZFTPRemoteDirectory String lpropVal
36983>>>                Send SetStringProperty 9 lpropVal
36984>>>        End_Procedure
36985>>>
36985>>>        Function EZFTPProfessionalEdition Returns Bool
36986>>>                Local Bool lpropVal
36987>>>                Get GetBoolProperty 10 to lpropVal
36988>>>                Function_Return lpropVal
36989>>>        End_Function
36990>>>
36990>>>        Procedure SET EZFTPProfessionalEdition Bool lpropVal
36991>>>                Send SetBoolProperty 10 lpropVal
36992>>>        End_Procedure
36993>>>
36993>>>        Function EZFTPUseCache Returns Bool
36994>>>                Local Bool lpropVal
36995>>>                Get GetBoolProperty 7 to lpropVal
36996>>>                Function_Return lpropVal
36997>>>        End_Function
36998>>>
36998>>>        Procedure SET EZFTPUseCache Bool lpropVal
36999>>>                Send SetBoolProperty 7 lpropVal
37000>>>        End_Procedure
37001>>>
37001>>>        Function EZFTPCancelTransfer Returns Bool
37002>>>                Local Bool lpropVal
37003>>>                Get GetBoolProperty 8 to lpropVal
37004>>>                Function_Return lpropVal
37005>>>        End_Function
37006>>>
37006>>>        Procedure SET EZFTPCancelTransfer Bool lpropVal
37007>>>                Send SetBoolProperty 8 lpropVal
37008>>>        End_Procedure
37009>>>
37009>>>        Procedure EZFTPConnect
37010>>>                Send InvokeVoidFunction 11
37011>>>        End_Procedure
37012>>>
37012>>>        Procedure EZFTPDisconnect
37013>>>                Send InvokeVoidFunction 12
37014>>>        End_Procedure
37015>>>
37015>>>        Procedure EZFTPGetFile
37016>>>                Send InvokeVoidFunction 13
37017>>>        End_Procedure
37018>>>
37018>>>        Procedure EZFTPPutFile
37019>>>                Send InvokeVoidFunction 14
37020>>>        End_Procedure
37021>>>
37021>>>        Procedure EZFTPDeleteFile String lFileName
37022>>>                Send DeclareParams 1
37023>>>                Send DefineStringParam lFileName
37024>>>                Send InvokeVoidFunction 15
37025>>>        End_Procedure
37026>>>
37026>>>        Procedure EZFTPRenameFile String lOldName String lNewName
37027>>>                Send DeclareParams 2
37028>>>                Send DefineStringParam lOldName
37029>>>                Send DefineStringParam lNewName
37030>>>                Send InvokeVoidFunction 16
37031>>>        End_Procedure
37032>>>
37032>>>        Procedure EZFTPMkDir String lDirectoryName
37033>>>                Send DeclareParams 1
37034>>>                Send DefineStringParam lDirectoryName
37035>>>                Send InvokeVoidFunction 17
37036>>>        End_Procedure
37037>>>
37037>>>        Procedure EZFTPRmDir String lDirectoryName
37038>>>                Send DeclareParams 1
37039>>>                Send DefineStringParam lDirectoryName
37040>>>                Send InvokeVoidFunction 18
37041>>>        End_Procedure
37042>>>
37042>>>        Procedure EZFTPGetDirectory String lFileName
37043>>>                Send DeclareParams 1
37044>>>                Send DefineStringParam lFileName
37045>>>                Send InvokeVoidFunction 19
37046>>>        End_Procedure
37047>>>
37047>>>        Procedure EZFTPAboutBox
37048>>>                Send InvokeVoidFunction -552
37049>>>        End_Procedure
37050>>>
37050>>>End_Class
37051>>>
37051>>>// Event interface for EZFTP Control
37051>>>// CLSID:{6580F766-7819-11CF-B86C-444553540000}
37051>>>// ProgId:
37051>>>Class OLE_DEZFTPEvents is a Message
37052>>>
37052>>>        Procedure OnEZFTPNextDirectoryEntry String lFileName DWORD lAttributes OLEReal lLength
37053>>>        End_Procedure
37054>>>
37054>>>        Procedure OnEZFTPTransferProgress DWORD lBytesTransferred DWORD lTotalBytes
37055>>>        End_Procedure
37056>>>
37056>>>End_Class
37057>>>
37057>>>// EZFTP Control
37057>>>// CoClass CLSID:{6580F767-7819-11CF-B86C-444553540000}
37057>>>// ProgId: EZFTP.EZFTPCtrl.1
37057>>>// Number of impl.Types:2
37057>>>// Referenced class _DEZFTP
37057>>>// Referenced class _DEZFTPEvents
37057>>>
37057>>>Class OLEEZFTP is a OCX_Client
37058>>>        Import_Class_Protocol OLE_DEZFTP
37059>>>        Import_Class_Protocol OLE_DEZFTPEvents
37060>>>
37060>>>        Procedure Construct_Object
37061>>>                Forward Send Construct_Object
37063>>>                Send DefineOCX_Client
37064>>>                Set progIdStr to "EZFTP.EZFTPCtrl.1"
37065>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEEZFTP"
37068>>>        End_Procedure
37069>>>
37069>>>        Procedure PreEZFTPNextDirectoryEntry Integer lParam
37070>>>                Local String lFileName
37071>>>                Local DWORD lAttributes
37071>>>                Local OLEReal lLength
37071>>>                Get GetEventStringParam lParam 0 to lFileName
37072>>>                Get GetEventIntegerParam lParam 1 to lAttributes
37073>>>                Get GetEventRealParam lParam 2 to lLength
37074>>>                Send OnEZFTPNextDirectoryEntry lFileName lAttributes lLength
37075>>>        End_Procedure
37076>>>
37076>>>        Procedure PreEZFTPTransferProgress Integer lParam
37077>>>                Local DWORD lBytesTransferred
37078>>>                Local DWORD lTotalBytes
37078>>>                Get GetEventIntegerParam lParam 0 to lBytesTransferred
37079>>>                Get GetEventIntegerParam lParam 1 to lTotalBytes
37080>>>                Send OnEZFTPTransferProgress lBytesTransferred lTotalBytes
37081>>>        End_Procedure
37082>>>
37082>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
37083>>>                ON_EVENT 1 Fire PreEZFTPNextDirectoryEntry
37086>>>                ON_EVENT 2 Fire PreEZFTPTransferProgress
37089>>>        End_Procedure
37090>>>End_Class
37091>>>
37091>>>// EZFTP Control
37091>>>// CoClass CLSID:{6580F767-7819-11CF-B86C-444553540000}
37091>>>// ProgId: EZFTP.EZFTPCtrl.1
37091>>>// Number of impl.Types:2
37091>>>// Referenced class _DEZFTP
37091>>>// Referenced class _DEZFTPEvents
37091>>>Class dbOLEEZFTP is a dbOCX_Client
37092>>>        Import_Class_Protocol OLE_DEZFTP
37093>>>        Import_Class_Protocol OLE_DEZFTPEvents
37094>>>
37094>>>        Procedure Construct_Object
37095>>>                Forward Send Construct_Object
37097>>>                Send DefineDbOCX_Client
37098>>>                Set progIdStr to "EZFTP.EZFTPCtrl.1"
37099>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEEZFTP"
37102>>>        End_Procedure
37103>>>
37103>>>        Procedure PreEZFTPNextDirectoryEntry Integer lParam
37104>>>                Local String lFileName
37105>>>                Local DWORD lAttributes
37105>>>                Local OLEReal lLength
37105>>>                Get GetEventStringParam lParam 0 to lFileName
37106>>>                Get GetEventIntegerParam lParam 1 to lAttributes
37107>>>                Get GetEventRealParam lParam 2 to lLength
37108>>>                Send OnEZFTPNextDirectoryEntry lFileName lAttributes lLength
37109>>>        End_Procedure
37110>>>
37110>>>        Procedure PreEZFTPTransferProgress Integer lParam
37111>>>                Local DWORD lBytesTransferred
37112>>>                Local DWORD lTotalBytes
37112>>>                Get GetEventIntegerParam lParam 0 to lBytesTransferred
37113>>>                Get GetEventIntegerParam lParam 1 to lTotalBytes
37114>>>                Send OnEZFTPTransferProgress lBytesTransferred lTotalBytes
37115>>>        End_Procedure
37116>>>
37116>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
37117>>>                ON_EVENT 1 Fire PreEZFTPNextDirectoryEntry
37120>>>                ON_EVENT 2 Fire PreEZFTPTransferProgress
37123>>>        End_Procedure
37124>>>End_Class
37125>Use dvFTP    // Ftp Package
INCLUDING FILE: DVFTP.PKG
37125>>>// DVFTP.PKG - Internet File Transfer Protocol (FTP) functions
37125>>>//             for Visual Dataflex
37125>>>//
37125>>>// Created by: Marcel J. Zwiebel
37125>>>//             Dataview - The Netherlands
37125>>>// E-mail    : marcel@dataview-sc.com
37125>>>// CIS id    : 100273,2473
37125>>>// Web URL   : http://www.dataview-sc.com
37125>>>//
37125>>>// Date      : 28/07/1997 
37125>>>
37125>>>Use Windows.pkg
37125>>>Use DLL.pkg
37125>>>
37125>>>// register external functions of the dvftp.dll
37125>>>
37125>>>
37125>>>// function   : dvInternetAttemptConnect
37125>>>//
37125>>>// description: Attemps to make a connection to the Internet. If the user has a dialup-connection
37125>>>//              to an Internet Service Provider (ISP) and the computer is not connected to this 
37125>>>//              ISP, the standard dialup dialog box will be evoked.
37125>>>//                   
37125>>>// parameters : none
37125>>>//
37125>>>// returns    : integer - Is 0 (ok) or error-number.
37125>>>//
37125>>>External_Function dvInternetAttemptConnect "dvInternetAttemptConnect" DVFTP.DLL ;     Returns Integer
37126>>>
37126>>>
37126>>>// function   : dvInternetOpen
37126>>>//
37126>>>// description: Initializes the application's use of the WIN32 Internet functions.
37126>>>//
37126>>>// parameters : none
37126>>>//
37126>>>// returns    : integer - Is 0 (ok) or error-number.
37126>>>//
37126>>>External_Function dvInternetOpen "dvInternetOpen" DVFTP.DLL ;     Returns Integer
37127>>>
37127>>>
37127>>>// function   : dvInternetConnect
37127>>>//
37127>>>// description: Opens an FTP-session with a server.
37127>>>//
37127>>>// parameters : string ServerName - Can be a DNS-name (for example: ftp.daccess.com) or 
37127>>>//                                  an ip-number (for example: 145.58.31.4).
37127>>>//              string UserName   - Login-name for the server, can be empty for 
37127>>>//                                  "anonymous" login (default for most FTP servers).
37127>>>//              string Password   - Password for the server, can be empty for 
37127>>>//                                  "anonymous" login (default for most FTP servers).
37127>>>//              integer Firewall  - Must be 1 for connecting through a SOCKS firewall
37127>>>//                                  server, otherwise 0.
37127>>>//
37127>>>// returns    : integer - Is 0 (ok) or error-number.
37127>>>//
37127>>>External_Function dvInternetConnect "dvInternetConnect" DVFTP.DLL ;     String szServerName String szUserName String szPassword Integer iFirewall;     Returns Integer
37128>>>
37128>>>
37128>>>// function   : dvFtpSetCurrentDirectory
37128>>>//
37128>>>// description: Changes to a different working directory on the FTP server.
37128>>>//
37128>>>// parameters : string directory - Name of the directory to change to on the remote system. 
37128>>>//                                 This can be either a fully qualified path or a name 
37128>>>//                                 relative to the current directory. 
37128>>>//                                 A backslash (\) or forward slash (/) can be used as the 
37128>>>//                                 directory separator for either name. dvFtpSetCurrentDirectory
37128>>>//                                 translates the directory name separators to the appropriate 
37128>>>//                                 character before they are used. 
37128>>>//                                 Use dvFtpGetCurrentDirectory to determine the remote site's 
37128>>>//                                 current working directory (not all remote systems use a
37128>>>//                                 hierarchical naming scheme for directories).
37128>>>//
37128>>>// returns    : integer - Is 0 (ok) or error-number.
37128>>>//
37128>>>External_Function dvFtpSetCurrentDirectory "dvFtpSetCurrentDirectory" DVFTP.DLL ;     String szDirectory Returns Integer
37129>>>
37129>>>
37129>>>// function   : dvFtpGetCurrentDirectory
37129>>>//
37129>>>// description: Retrieves the current directory for the specified FTP session.
37129>>>//
37129>>>// parameters : none
37129>>>//
37129>>>// returns    : string - Name of the current directory.
37129>>>//
37129>>>External_Function dvFtpGetCurrentDirectory "dvFtpGetCurrentDirectory" DVFTP.DLL ;     Returns String
37130>>>
37130>>>
37130>>>// function   : dvFtpCreateDirectory
37130>>>//
37130>>>// description: Creates a new directory on the FTP server. 
37130>>>//
37130>>>// parameters : string Directory - The name of the directory to create on the remote system.
37130>>>//                                 This can be either a fully qualified path or a name 
37130>>>//                                 relative to the current directory. 
37130>>>//                                 A backslash (\) or forward slash (/) can be used as the 
37130>>>//                                 directory separator for either name. dvFtpCreateDirectory
37130>>>//                                 translates the directory name separators to the appropriate 
37130>>>//                                 character before they are used. 
37130>>>//                                 Use dvFtpGetCurrentDirectory to determine the remote site's 
37130>>>//                                 current working directory (not all remote systems use a
37130>>>//                                 hierarchical naming scheme for directories).
37130>>>//
37130>>>// returns    : integer - Is 0 (ok) or error-number.
37130>>>//
37130>>>External_Function dvFtpCreateDirectory "dvFtpCreateDirectory" DVFTP.DLL ;     String szDirectory Returns Integer
37131>>>
37131>>>
37131>>>// function   : dvFtpRemoveDirectory
37131>>>//
37131>>>// description: Removes the specified directory on the FTP server. 
37131>>>//
37131>>>// parameters : string Directory - The name of the directory to remove on the remote system.
37131>>>//                                 This can be either a fully qualified path or a name 
37131>>>//                                 relative to the current directory. 
37131>>>//                                 A backslash (\) or forward slash (/) can be used as the 
37131>>>//                                 directory separator for either name. dvFtpRemoveDirectory
37131>>>//                                 translates the directory name separators to the appropriate 
37131>>>//                                 character before they are used. 
37131>>>//                                 Use dvFtpGetCurrentDirectory to determine the remote site's 
37131>>>//                                 current working directory (not all remote systems use a
37131>>>//                                 hierarchical naming scheme for directories).
37131>>>//
37131>>>// returns    : integer - Is 0 (ok) or error-number.
37131>>>//
37131>>>External_Function dvFtpRemoveDirectory "dvFtpRemoveDirectory" DVFTP.DLL ;     String szDirectory Returns Integer
37132>>>
37132>>>
37132>>>// function   : dvFtpFindFirstFile
37132>>>//
37132>>>// description: Searches the specified directory of the given FTP session.
37132>>>//
37132>>>// parameters : string FileSelect - A valid directory path or file name (wildcards allowed) for
37132>>>//                                  the FTP server's file system. If the string is empty the 
37132>>>//                                  first file in the current directory on the server will be 
37132>>>//                                  searched for. 
37132>>>//              integer UseCache  - Indicates using the local computer's cache.
37132>>>//                                  If the value is 0 then the the cache will be used. 
37132>>>//                                  If the value is 1 then a download of the requested file, 
37132>>>//                                  object, or directory listing from the origin server will be 
37132>>>//                                  forced, not from the cache.
37132>>>//
37132>>>// returns    : string - Name of the first file found or empty when no files found. When the 
37132>>>//                       searched directory is empty the string "directory is empty" is returned.
37132>>>//
37132>>>External_Function dvFtpFindFirstFile "dvFtpFindFirstFile" DVFTP.DLL ;     String szFileSelect Integer iUseCache Returns String
37133>>>
37133>>>
37133>>>// function   : dvFtpFindNextFile
37133>>>//
37133>>>// description: Continues a file search started as a result of executing dvFtpFindFirstFile.
37133>>>//
37133>>>// parameters : none
37133>>>//
37133>>>// returns    : string - Name of the next file found or empty when no more files are found.
37133>>>//
37133>>>External_Function dvFtpFindNextFile "dvFtpFindNextFile" DVFTP.DLL ;     Returns String
37134>>>
37134>>>
37134>>>// function   : dvFtpDeleteFile
37134>>>//
37134>>>// description: Deletes a file stored on the FTP server. 
37134>>>//
37134>>>// parameters : string FileSelect - Name of the file to be deleted.
37134>>>//                                  Can be file names relative to the current directory. 
37134>>>//                                  A backslash (\) or forward slash (/) can be used as 
37134>>>//                                  the directory separator. dvFtpDeleteFile translates the 
37134>>>//                                  directory name separators to the appropriate character 
37134>>>//                                  before they are used. 
37134>>>//
37134>>>// returns    : integer - Is 0 (ok) or error-number.
37134>>>//
37134>>>External_Function dvFtpDeleteFile "dvFtpDeleteFile" DVFTP.DLL ;     String szFileSelect Returns Integer
37135>>>
37135>>>
37135>>>// function   : dvFtpRenameFile
37135>>>//
37135>>>// description: Renames a file stored on the FTP server. 
37135>>>//
37135>>>// parameters : string Existing - The name of the file that will have its name changed on the
37135>>>//                                remote FTP server. 
37135>>>//              string New      - The new name for the remote file. 
37135>>>//
37135>>>//                                Both names can be relative to the current directory. A backslash 
37135>>>//                                (\) or forward slash (/) can be used as the directory separator 
37135>>>//                                for either name. dvFtpRenameFile translates the directory name 
37135>>>//                                separators to the appropriate character before they are used. 
37135>>>//
37135>>>// returns    : integer - Is 0 (ok) or error-number.
37135>>>//
37135>>>External_Function dvFtpRenameFile "dvFtpRenameFile" DVFTP.DLL ;     String szExisting String szNew Returns Integer
37136>>>
37136>>>
37136>>>// function   : dvFtpGetFile
37136>>>//
37136>>>// description: Retrieves a file from the FTP server and stores it under the specified file name, 
37136>>>//              creating a new local file in the process. 
37136>>>//
37136>>>// parameters : string  RemoteFile   - The name of the file to retrieve from the remote system. 
37136>>>//              string  NewFile      - The name of the file to create on the local system. 
37136>>>//              integer FailIfExists - Boolean flag that indicates whether the function should 
37136>>>//                                     proceed if a local file of the specified name already exists. 
37136>>>//                                     If value is 1 and the local file exists, dvFtpGetFile fails. 
37136>>>//              integer FileType     - Indicates the transfer method.
37136>>>//                                     If the value is 0 then the function transfers the file using 
37136>>>//                                     FTP's ASCII (Type A) transfer method. Control and formatting 
37136>>>//                                     information is converted to local equivalents. 
37136>>>//                                     If the value is 1 then the function transfers the file using 
37136>>>//                                     FTP's Image (Type I) transfer method. The file is transferred 
37136>>>//                                     exactly as it exists with no changes. 
37136>>>//
37136>>>// returns    : integer - Is 0 (ok) or error-number.
37136>>>//
37136>>>External_Function dvFtpGetFile "dvFtpGetFile" DVFTP.DLL ;     String szRemoteFile String szNewFile Integer bFailIfExists Integer iFileType Returns Integer
37137>>>
37137>>>
37137>>>// function   : dvFtpPutFile
37137>>>//
37137>>>// description: Stores a file on the FTP server. 
37137>>>//
37137>>>// parameters : string  LocalFile     - The name of the file to send from the local system. 
37137>>>//              string  NewRemoteFile - The name of the file to create on the remote system.
37137>>>//              integer FileType      - Indicates the transfer method.
37137>>>//                                      If the value is 0 then the function transfers the 
37137>>>//                                      file as ASCII. 
37137>>>//                                      If the value is 1 then the function transfres the
37137>>>//                                      file as binary. 
37137>>>//
37137>>>// returns    : integer - Is 0 (ok) or error-number.
37137>>>//
37137>>>External_Function dvFtpPutFile "dvFtpPutFile" DVFTP.DLL ;     String szLocalFile String szNewRemoteFile Integer iFileType Returns Integer
37138>>>
37138>>>
37138>>>
37138>>>// The following functions give common file-information after performing dvFtpFindFirstFile
37138>>>// and dvFtpFindNextFile. Because the FTP protocol provides no standard means of enumerating, 
37138>>>// some of the common information about files, such as file creation date and time, is not 
37138>>>// always available or correct. When this happens, dvFtpFindFirstFile and dvFtpFindNextFile 
37138>>>// fill in unavailable information with a best guess based on available information. For example,
37138>>>// creation and last access dates will often be the same as the file's modification date.
37138>>>
37138>>>
37138>>>// function   : dvFtpFilename
37138>>>//
37138>>>// description: The name of the file. 
37138>>>//
37138>>>// parameters : none
37138>>>//
37138>>>// returns    : string - Name of the file
37138>>>//
37138>>>External_Function dvFtpFilename "dvFtpFilename" DVFTP.DLL ;     Returns String
37139>>>
37139>>>
37139>>>// function   : dvFtpAlternateFilename
37139>>>//
37139>>>// description: An alternative name for the file. This name is in the classic 8.3 (filename.ext)
37139>>>//              filename format.
37139>>>//
37139>>>// parameters : none
37139>>>//
37139>>>// returns    : string - Alternate name for the file. If the file has a long filename, the complete 
37139>>>//                       name can be retrieved by the dvFtpFilename function, and the 8.3 format
37139>>>//                       truncated version of the name can be retrieved with this function. Otherwise, 
37139>>>//                       this function returns an empty string.
37139>>>//
37139>>>External_Function dvFtpAlternateFilename "dvFtpAlternateFilename" DVFTP.DLL ;     Returns String
37140>>>
37140>>>
37140>>>// function   : dvFtpFileCreated
37140>>>//              
37140>>>// description: The date/time the file was created in 24-hour format.
37140>>>//
37140>>>// parameters : integer DateFormat - The format of the date to be retrieved.
37140>>>//                                   If value is 0 then US-formatted date is returned (mm/dd/yyyy).
37140>>>//                                   If value is 1 then European-formatted date is returned (dd/mm/yyyy).
37140>>>//                                   If value is 2 then military-formatted date is returned (yyyy.mm.dd).
37140>>>//
37140>>>// returns    : string - The file creation-date/time
37140>>>//
37140>>>External_Function dvFtpFileCreated "dvFtpFileCreated" DVFTP.DLL ;     Integer iDateFormat Returns String
37141>>>
37141>>>
37141>>>// function   : dvFtpFileAccessed
37141>>>//              
37141>>>// description: The last date/time the file was accessed in 24-hour format.
37141>>>//
37141>>>// parameters : integer DateFormat - The format of the date to be retrieved.
37141>>>//                                   If value is 0 then US-formatted date is returned (mm/dd/yyyy).
37141>>>//                                   If value is 1 then European-formatted date is returned (dd/mm/yyyy).
37141>>>//                                   If value is 2 then military-formatted date is returned (yyyy.mm.dd).
37141>>>//
37141>>>// returns    : string - The last file access-date/time
37141>>>//
37141>>>External_Function dvFtpFileAccessed "dvFtpFileAccessed" DVFTP.DLL ;     Integer iDateFormat Returns String
37142>>>
37142>>>
37142>>>// function   : dvFtpFileWritten
37142>>>//              
37142>>>// description: The last date/time the file was written to in 24-hour format.
37142>>>//
37142>>>// parameters : integer DateFormat - The format of the date to be retrieved.
37142>>>//                                   If value is 0 then US-formatted date is returned (mm/dd/yyyy).
37142>>>//                                   If value is 1 then European-formatted date is returned (dd/mm/yyyy).
37142>>>//                                   If value is 2 then military-formatted date is returned (yyyy.mm.dd).
37142>>>//
37142>>>// returns    : string - The last file written to-date/time
37142>>>//
37142>>>External_Function dvFtpFileWritten "dvFtpFileWritten" DVFTP.DLL ;     Integer iDateFormat Returns String
37143>>>
37143>>>
37143>>>// function   : dvFtpFileSize
37143>>>//              
37143>>>// description: The size of the file in bytes.
37143>>>//
37143>>>// parameters : none
37143>>>//
37143>>>// returns    : integer - Filesize in bytes.
37143>>>//
37143>>>External_Function dvFtpFileSize "dvFtpFileSize" DVFTP.DLL ;     Returns Integer
37144>>>
37144>>>
37144>>>// function   : dvFtpIsDirectory
37144>>>//              
37144>>>// description: The file is an directory.
37144>>>//
37144>>>// parameters : none
37144>>>//
37144>>>// returns    : integer - If value is 1 the file is directory, otherwise 0 will be returned.
37144>>>//
37144>>>External_Function dvFtpIsDirectory "dvFtpIsDirectory" DVFTP.DLL ;     Returns Integer
37145>>>
37145>>>
37145>>>// function   : dvGetServerMsg
37145>>>//              
37145>>>// description: Gets the returned message from the FTP server (error-number will
37145>>>//              be 12003 "extended error").
37145>>>//
37145>>>// parameters : none
37145>>>//
37145>>>// returns    : string - Return message from the FTP server.
37145>>>//
37145>>>External_Function dvGetServerMsg "dvGetServerMsg" DVFTP.DLL;     Returns String
37146>>>
37146>>>
37146>>>// error-numbers returned
37146>>>//
37146>>>// 12001  "out of handles"            
37146>>>// 12002  "timeout"
37146>>>// 12003  "extended error"
37146>>>// 12004  "internal error"            
37146>>>// 12005  "invalid url"               
37146>>>// 12006  "unrecognized scheme"       
37146>>>// 12007  "name not resolved"         
37146>>>// 12008  "protocol not found"        
37146>>>// 12009  "invalid option"            
37146>>>// 12010  "bad option length"         
37146>>>// 12011  "option not settable"      
37146>>>// 12012  "shutdown"                  
37146>>>// 12013  "incorrect user name"       
37146>>>// 12014  "incorrect password"
37146>>>// 12015  "login failure"             
37146>>>// 12016  "invalid operation"         
37146>>>// 12017  "operation cancelled"       
37146>>>// 12018  "incorrect handle type"     
37146>>>// 12019  "incorrect handle state"
37146>>>// 12020  "not proxy request"         
37146>>>// 12021  "registry value not found"
37146>>>// 12022  "bad registry parameter"    
37146>>>// 12023  "no direct access"          
37146>>>// 12024  "no context"                
37146>>>// 12025  "no callback"               
37146>>>// 12026  "request pending"           
37146>>>// 12027  "incorrect format"          
37146>>>// 12028  "item not found"            
37146>>>// 12029  "cannot connect"            
37146>>>// 12030  "connection aborted"        
37146>>>// 12031  "connection reset"          
37146>>>// 12032  "force retry"               
37146>>>// 12033  "invalid proxy request"     
37146>>>// 12034  "need ui"                   
37146>>>// 12036  "handle exists"             
37146>>>// 12037  "sec cert date invalid"     
37146>>>// 12038  "sec cert cn invalid"       
37146>>>// 12039  "http to https on redir"    
37146>>>// 12040  "https to http on_redir"    
37146>>>// 12041  "mixed security"            
37146>>>// 12042  "chg post is non secure"    
37146>>>// 12043  "post is non_secure"        
37146>>>// 12044  "client auth cert needed"   
37146>>>// 12045  "invalid ca"                
37146>>>// 12046  "client auth not setup"     
37146>>>// 12047  "async thread failed"       
37146>>>// 12048  "redirect scheme change"    
37146>>>// 12049  "dialog pending"            
37146>>>// 12050  "retry dialog"              
37146>>>// 12110  "ftp transfer in progress"  
37146>>>// 12111  "ftp dropped"               
37146>>>// 12112  "ftp no passive mode"       
37146>>>// 12157  "security channel error"    
37146>>>// 12158  "unable to cache file"      
37146>>>// 12159  "tcpip not installed"       
37146>>>// 12163  "disconnected"              
37146>>>// 12164  "server unreachable"        
37146>>>// 12165  "proxy server unreachable"  
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>>>
37146>Use DVDIALER // Vdf6 Dialer
INCLUDING FILE: DVDIALER.PKG
37146>>>// DVDIALER.PKG - Automatic dialing functions for dial-up access to the Internet
37146>>>//
37146>>>// Created by: Marcel J. Zwiebel
37146>>>//             Dataview - The Netherlands
37146>>>// E-mail    : marcel@dataview-sc.com
37146>>>// Web URL   : http://www.dataview-sc.com
37146>>>//
37146>>>// Date      : 03/24/1999
37146>>>
37146>>>Use Windows.pkg
37146>>>Use DLL.pkg 
37146>>>
37146>>>
37146>>>// register external functions of the dvdailer.dll
37146>>>
37146>>>
37146>>>// function   : dvInternetGetConnectedState
37146>>>//
37146>>>// description: Retrieves the connected state of the local system.
37146>>>//                   
37146>>>// parameters : none
37146>>>//
37146>>>// returns    : integer - value 1 = the local system is (currently) connected by a modem to the Internet.
37146>>>//                              2 = the local system uses a local area network to connect to the Internet.
37146>>>//                              3 = the local system uses a proxy server to connect to the Internet.
37146>>>//                              4 = the local system's modem is busy with a non-Internet connection.
37146>>>//                              0 = there is no Internet connection.
37146>>>//
37146>>>External_Function32 dvInternetGetConnectedState "dvInternetGetConnectedState" DVDIALER.DLL Returns Integer
37147>>>
37147>>>
37147>>>// function   : dvInternetAutodial
37147>>>//
37147>>>// description: Automatically causes the modem to dial the default Internet connection.
37147>>>//              Use the function dvInternetAutodialHangup to hangup this connection.
37147>>>//                   
37147>>>// parameters : none
37147>>>//
37147>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
37147>>>//
37147>>>External_Function32 dvInternetAutodial "dvInternetAutodial" DVDIALER.DLL Returns Integer
37148>>>
37148>>>
37148>>>// function   : dvInternetAutodialHangup
37148>>>//
37148>>>// description: Disconnects an automatic dial-up connection invoked by dvInternetAutodial. 
37148>>>//                   
37148>>>// parameters : none
37148>>>//
37148>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
37148>>>//
37148>>>External_Function32 dvInternetAutodialHangup "dvInternetAutodialHangup" DVDIALER.DLL Returns Integer
37149>>>
37149>>>
37149>>>// function   : dvInternetDial
37149>>>//
37149>>>// description: Initiates a connection to the Internet using a modem connection and a phonebook entry.
37149>>>//              Use the function dvInternetHangup to hangup this connection.
37149>>>//                   
37149>>>// parameters : string - The name of the dial-up connection to use (phonebook entry).
37149>>>//
37149>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
37149>>>//
37149>>>External_Function32 dvInternetDial "dvInternetDial" DVDIALER.DLL String szConnectiontoid Returns Integer
37150>>>
37150>>>
37150>>>// function   : dvInternetHangup
37150>>>//
37150>>>// description: Instructs the modem to disconnect from the Internet (connection invoked by dvInternetDial). 
37150>>>//              
37150>>>// parameters : none
37150>>>//
37150>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
37150>>>//
37150>>>External_Function32 dvInternetHangUp "dvInternetHangUp" DVDIALER.DLL Returns Integer
37151>>>
37151>>>
37151>>>
37151>>>
37151>>>
37151>>>
37151>>>
37151>>>
37151>>>
37151>>>
37151>>>
37151>>>
37151>//------------------------------
37151>
37151>//AB-StoreTopEnd
37151>
37151>
37151>Object Main is a Panelsub
37153>    Set Label To "test"
37154>    Use jsMenu.mn //  Menu package.
INCLUDING FILE: JSMENU.MN
37154>>>
37154>>>DFCreate_Menu Main_Menu
37157>>>
37157>>>    Property String psMenuModule Public ''
37159>>>
37159>>>    DFCreate_Menu "Ž‚€‹‹€ „ˆƒˆ‰Ž" View1_PopupMenu IS A ViewPopupMenu
37163>>>    //    On_Item 'item' Send Activate_item
37163>>>//        On_Item 'SAP ' Send Activate_vsap
37163>>>//        on_item "ˆ©¦çš ¦ œ¢˜«é¤  "               send activate_r6_2
37163>>>//        on_item "„¥˜šàšã ¬§¦¢¦å§à¤ SAP "            send activate_renhypol
37163>>>//          On_Item '€¢¢˜šã ‘«¦ ®œåà¤ ˜¨˜©«˜« ¡é¤' Send Activate_vallagh
37163>>>//        On_Item '„¤›¦› ˜¡ ¤ã©œ ª' Send Activate_rtehn
37163>>>//        On_Item '„å›ž' Send Activate_item
37163>>>//        On_Item "metasx"      Send Activate_v014
37163>>>//        On_Item 'Partcle' Send Activate_particle
37163>>>//        On_Item 'Stoixeia Emporias' Send Activate_StoixEmp2
37163>>>//          On_Item '¡˜¨«œ¢œª ' Send Activate_r6_1hm
37163>>>//          On_Item 'metaf' Send Activate_rmetafth
37163>>>//          On_Item '„¤ž¢ ¡åà©ž sls' Send Activate_r6_52
37163>>>//        On_Item 'Enh sap'        Send Activate_Enhsap
37163>>>//        On_Item "vwKartel"          Send Activate_vwKartel
37163>>>//        On_Item "Parastatika"       Send Activate_Ptyppar
37163>>>//        On_Item "Ctypkin"           Send Activate_vwCytpkin
37163>>>//        On_Item "Cflagkin"          Send Activate_Cflagkin
37163>>>//        On_Item "tOpenItems"          Send Activate_tOpItem
37163>>>//        On_Item "tOpItDEL"            Send Activate_tOpItDel
37163>>>//        On_Item '€¥ æš¨˜­˜' Send Activate_v037
37163>>>//        On_Item '‹œ«˜­¦¨á …à¤é¤' Send Activate_enhbrzones
37163>>>//        On_Item 'FixTxt' Send Activate_FixTxt
37163>>>//        On_Item "Enhmerosh Cmoves apo Bmove Recr" Send Activate_Enhcmbm
37163>>>//        On_Item "„«˜ ¨åœª-“§¦¡˜«˜©«ã£˜«˜" Send Activate_v3
37163>>>//        On_Item "LockTest"                Send Activate_LockTest
37163>>>//        On_Item "V192"                Send Activate_v192
37163>>>//        On_Item "V14a"                Send Activate_v14a
37163>>>//        On_Item "Ektyp Axiog"         Send Activate_r36a
37163>>>//        On_Item "V192"                Send Activate_V192
37163>>>//        On_Item "FTP"                 Send Activate_FtpView
37163>>>//        On_Item "Read Ascii"          Send Activate_Taxio
37163>>>//        On_Item "Delt. Parag"         Send Activate_vw051
37163>>>//        On_Item "PRN Delt. Parag"     Send Activate_rvDorder
37163>>>//        On_Item "Programmatismos"     Send Activate_vw062
37163>>>//        On_Item "Xrhsh"               Send Activate_V3
37163>>>//        On_Item "Particle"            Send Activate_Particle
37163>>>//        On_Item "V041"                Send Activate_v041
37163>>>//        On_Item "rvApotEr"                Send Activate_rvApotEr
37163>>>//        On_Item "v21"                   Send Activate_V21
37163>>>//        On_Item "Clients"             Send Activate_vwClients
37163>>>//        On_Item "Cmoves"              Send Activate_vwCmoves
37163>>>//        On_Item "Codemast"            Send Activate_Types_Maint
37163>>>//        On_Item "Export"              Send Activate_vwExport
37163>>>//          on_item "„¡«ç§à©ž €§¦Ÿœ£˜« ¡¦ç „¨šà¤ ‘¬š¡œ¤«¨à« ¡ã " send activate_r100_ab
37163>>>//          on_item "„Œ†‹„—‘† „‚—Œ ‹„ ‘—‘’Ž “„“‡“ŒŽ Š†—‹—Œ"  send activate_EnhcnID
37163>>>
37163>>>//        On_Item "DEOP"     Send Activate_V193
37163>>>        On_Item "†‹„ŽŠŽ‚ˆ€‰„‘"                  Send Activate_R6_4G
37164>>>//        On_Item "Open Items"          Send Activate_Copen
37164>>>//        On_Item "Karteles"            Send Activate_vwkartel
37164>>>//        On_Item "r100_3"              Send Activate_r100_3
37164>>>//        On_Item "Gefyres Titana"      Send Activate_tAxio
37164>>>//        On_Item "Step 1"              Send Activate_v192
37164>>>//        On_Item "Step 2"              Send Activate_v014
37164>>>
37164>>>//        On_Item "rMhtrAxio"           Send Activate_RMHTRAXIO
37164>>>//          On_Item "Batch Enhm"        Send Activate_tOpItem
37164>>>//          On_Item "salesman"        Send Activate_r108_3
37164>>>
37164>>>//        On_Item "Enhlikiosh Pelaton"                Send Activate_r6_5
37164>>>
37164>>>
37164>>>        Procedure OnInitMenu
37166>>>            Forward Send OnInitMenu
37168>>>            Set psMenuModule to '01'
37169>>>        End_Procedure
37170>>>
37170>>>    End_Pull_Down // &View
37172>>>
37172>>>//    DFCreate_Menu "Programmata module 02 Agores" View2_PopupMenu IS A ViewPopupMenu
37172>>>//        On_Item "Particle"      Send Activate_Particle
37172>>>//        On_Item "Parastatika"   Send Activate_Ptyppar
37172>>>//        On_Item "Ctypkin"       Send Activate_vwCytpkin
37172>>>//        On_Item "Cflagkin"       Send Activate_Cflagkin
37172>>>//        On_Item "Hmgio"                Send Activate_Hmgio
37172>>>//        Procedure OnInitMenu
37172>>>//            Forward Send OnInitMenu
37172>>>//            Set psMenuModule to '02'
37172>>>//        End_Procedure
37172>>>//    End_Pull_Down // &View
37172>>>
37172>>>    DFCreate_Menu "Programmata module 03 Apothiki" ApothView3_PopupMenu IS A ViewPopupMenu
37176>>>//        On_Item "Kinapoth"           Send Activate_v182s
37176>>>//        On_Item "Hmgio"                Send Activate_Hmgio
37176>>>//        On_Item "aXIOeXOFL"           Send Activate_aXIOeXOFL
37176>>>//        On_Item "rv037c"                Send Activate_rv037c
37176>>>//        On_Item 'Metafora Ypoloipon' Send Activate_r17_1
37176>>>
37176>>>//        Procedure OnInitMenu
37176>>>//          Forward Send OnInitMenu
37176>>>//          Set psMenuModule to '03'
37176>>>//        End_Procedure
37176>>>
37176>>>    End_Pull_Down // &View
37178>>>
37178>>>
37178>>>//    DFCreate_Menu "ƒ ˜®œå¨ ©ž €¥ ¦š¨á­à¤" Axiografa_Main_PopupMenu IS A ViewPopupMenu
37178>>>
37178>>>//        On_Item "Barticl"   Send Activate_V036
37178>>>//        On_Item "Btypkin"   Send Activate_V031
37178>>>//        On_Item "Baxiokat"   Send Activate_V034
37178>>>
37178>>>//        Procedure OnInitMenu
37178>>>//            Forward Send OnInitMenu
37178>>>//            Set psMenuModule to '04'
37178>>>//        End_Procedure
37178>>>
37178>>> //   End_Pull_Down // &View
37178>>>
37178>>>End_Menu // Main_Menu
37180>>>
37180>>>Register_Object Client_Area
37180>    
37180>    Use Ewbtnbar.pkg //  Tool-Bar object.
INCLUDING FILE: EWBTNBAR.PKG
37180>>>// 23/07/1998 SPY
37180>>>
37180>>>Use DFMainBt  // dfMain_ButtonBar
INCLUDING FILE: DFMAINBT.PKG
37180>>>>>//-------------------------------------------------------------------------
37180>>>>>// DFMainBt.pkg - DfMain_ButtonBar class
37180>>>>>//
37180>>>>>//
37180>>>>>// 07/23/96 JJT - New Class names
37180>>>>>//-------------------------------------------------------------------------
37180>>>>>
37180>>>>>Use DfPanel // dfapp_buttonbar
37180>>>>>
37180>>>>>Class ToolBar is a AppToolBar
37181>>>>>
37181>>>>>    Function Is_Function Integer MsgId Integer ObjId Integer DelegateFg Returns Integer
37182>>>>>      Local integer rval MainObj#
37183>>>>>      Get Main_Panel_id to MainObj#
37184>>>>>      If (ObjId>Desktop AND MainObj#) ;         Get Is_Function of MainObj# MsgId ObjId DelegateFg to rVal
37187>>>>>      Function_Return rVal
37188>>>>>    End_Function
37189>>>>>
37189>>>>>    Procedure Redirect_Button_Message integer Itm
37190>>>>>         Local integer Msg# Aux# rval Understood
37191>>>>>         If (Shadow_State(Current_Object,itm)) Procedure_Return
37194>>>>>         Get Message   item itm  to Msg#
37195>>>>>         Get Aux_Value item itm  to Aux#
37196>>>>>         If Msg# Begin
37198>>>>>           If Aux# eq 0 Begin
37200>>>>>              Get Focus to Aux#
37201>>>>>              Get Is_Function Get_DEO_Object Aux# TRUE to Understood
37202>>>>>              If Not Understood Move 0 to Aux#
37205>>>>>           End
37205>>>>>>
37205>>>>>           If Aux# Get Msg# of Aux# to rval
37208>>>>>           Procedure_return rval
37209>>>>>         end
37209>>>>>>
37209>>>>>    End_Procedure // Redirect_Message
37210>>>>>
37210>>>>>End_Class
37211>>>>>
37211>>>>>
37211>>>Use Dates.utl
37211>>>
37211>>>Register_Object CalendarEz
37211>>>Register_Procedure Activate_Sort_Vw
37211>>>Register_Procedure DoPrintScreen
37211>>>
37211>>>Procedure doPopupCalendar
37213>>>    Send request_popup to (Popup_calendar(Self))
37214>>>End_Procedure
37215>>>
37215>>>Procedure doRebuild
37217>>>    Send Activate_Sort_Vw To (Client_Area(Main(Self)))
37218>>>End_Procedure
37219>>>
37219>>>Procedure doExit_Application
37221>>>    send Exit_Application to desktop
37222>>>End_Procedure
37223>>>
37223>>>Procedure DoRefresh_Grids
37225>>>    Integer liObj
37226>>>    
37226>>>    Move (Focus(Desktop)) to liObj
37227>>>    If (Base_class(liObj) = list_class) Send beginning_of_data to liObj
37230>>>End_Procedure
37231>>>
37231>>>Procedure DoPopupCalc
37233>>>    Runprogram background "Calc.exe"
37234>>>End_Procedure
37235>>>
37235>>>Procedure DoPopupSetup
37237>>>    string sRunPath
37238>>>    get_profile_string "workspaces\ad" "dfparamspath" to sRunPath
37241>>>    append sRunPath "\dfparams"
37242>>>    send DoRunApplication sRunPath
37243>>>End_Procedure
37244>>>
37244>>>Object oMyWinPrint is an DF_PRINTER
37246>>>    Procedure DFPrint
37248>>>        Integer iRetVal
37249>>>        Get DFGetPrintDialogFlags To iRetVal
37250>>>        If iRetVal Begin
37252>>>            Send DFPrintDoc
37253>>>            Send DFClearDoc
37254>>>        End
37254>>>>
37254>>>    End_Procedure
37255>>>    Move Current_Object to WinPrintId
37256>>>End_Object
37257>>>
37257>>>
37257>>>Procedure DoPrint
37259>>>    Send DfPrint to (oMyWinPrint(Self))
37260>>>End_Procedure
37261>>>
37261>>>Procedure DoShowPropertiesPage
37263>>>   If (Close_All_Views(Self,True)=0) Send Activate_View to (piPropertiesObjectId(self))
37266>>>End_Procedure
37267>>>
37267>>>   //  Button bar object.
37267>>>//
37267>>>Object Tool_Bar is a ToolBar     
37269>>>    
37269>>>    Property Integer piOutputDestination Public 0
37271>>>
37271>>>    Send ImageList_Add 'bgn.bmp'      // 0
37272>>>    Send ImageList_Add 'end.bmp'      // 1
37273>>>    Send ImageList_Add 'next.bmp'     // 2
37274>>>    Send ImageList_Add 'prev.bmp'     // 3
37275>>>    Send ImageList_Add 'clr.bmp'      // 4
37276>>>    Send ImageList_Add 'clra.bmp'     // 5
37277>>>    Send ImageList_Add 'calend.bmp'   // 6
37278>>>    Send ImageList_Add 'Abfile.bmp'   // 7
37279>>>    Send ImageList_Add 'Dbexplor.bmp' // 8
37280>>>    Send ImageList_Add 'Ddb_find.bmp' // 9
37281>>>    Send ImageList_Add 'Abup.bmp'     // 10
37282>>>    Send ImageList_Add 'Arrow2.bmp'   // 11
37283>>>    Send ImageList_Add 'Save1.bmp'    // 12
37284>>>    Send ImageList_Add 'Exitm.bmp'    // 13
37285>>>    Send ImageList_Add 'include.bmp'  // 14
37286>>>    Send ImageList_Add 'Zoom_m1.bmp'  // 15
37287>>>    Send ImageList_Add 'Zoom2mg.bmp'  // 16
37288>>>    Send ImageList_Add 'DbeRefrh.Bmp' // 17
37289>>>    Send ImageList_Add 'calc1.bmp'    // 18
37290>>>    Send ImageList_Add 'print_m0.bmp' // 19
37291>>>    Send ImageList_Add 'Abcodeed.bmp' // 20
37292>>>    Send ImageList_Add 'vuur.bmp'     // 21
37293>>>    //Send ImageList_Add 'wmsui329.bmp' // 22
37293>>>
37293>>>    send Add_button (ico_user+0) msg_beginning_of_data
37294>>>    Send Add_ToolTip "€¨®ã €¨®œå¦¬ (Ctrl+Home)"
37295>>>    Set  Status_Help To '¨å©¡œ  «ž¤ ¨é«ž „šš¨˜­ã (Ctrl+Home)'
37296>>>
37296>>>    send Add_button (ico_user+3) msg_find_previous
37297>>>    Send Add_ToolTip "¨¦žš¦ç£œ¤ž „šš¨˜­ã (F7)"
37298>>>    Set  Status_Help To '¨å©¡œ  «ž¤ ¨¦žš¦ç£œ¤ž „šš¨˜­ã (F7)'
37299>>>
37299>>>    send Add_button (ico_user+10) msg_find_GE
37300>>>    Send Add_ToolTip "€¤˜ã«ž©ž (F9)"
37301>>>    Set  Status_Help To '¨å©¡œ  «ž¤ „šš¨˜­ã á©œ  «à¤ ‘«¦ ®œåà¤ (F9)'
37302>>>
37302>>>    send Add_button (ico_user+2) msg_find_next
37303>>>    Send Add_ToolTip "„§æ£œ¤ž „šš¨˜­ã (F8)"
37304>>>    Set  Status_Help To '¨å©¡œ  «ž¤ „§æ£œ¤ž „šš¨˜­ã (F8)'
37305>>>
37305>>>    send Add_button (ico_user+1) msg_end_of_data
37306>>>    Send Add_ToolTip "’â¢¦ª €¨®œå¦¬ (Ctrl+End)"
37307>>>    Set  Status_Help To '¨å©¡œ  «ž¤ ’œ¢œ¬«˜å˜ „šš¨˜­ã (Ctrl+End)'
37308>>>
37308>>>    send Add_space
37309>>>
37309>>>    send Add_button ico_std_find msg_prompt
37310>>>    Send Add_ToolTip "Šå©«˜ (F4)"
37311>>>    Set  Status_Help To '‹§¦¨œåª ¤˜ ›œåª æ¢œª « ª › ˜Ÿâ© £œª œ§ ¢¦šâª (F4)'
37312>>>
37312>>>    send Add_button (ico_User+15) msg_zoom
37313>>>    Send Add_ToolTip "Z¦¦£ (Alt+F9)"
37314>>>    Set  Status_Help To '‹§¦¨œåª ¤˜ ›œåª §¨æ©Ÿœ«œª §¢ž¨¦­¦¨åœª (Alt+F9)'
37315>>>
37315>>>    send Add_button (ico_user+6) msg_doPopupCalendar
37316>>>    Send Add_ToolTip "†£œ¨¦¢æš ¦"
37317>>>    Set  Status_Help To "†£œ¨¦¢æš ¦ ƒ ˜Ÿâ© £¦ £æ¤¦ ©œ §œ›å˜-†£œ¨¦£ž¤åœª"
37318>>>
37318>>>    send Add_space
37319>>>
37319>>>    send Add_button (ico_user+4) msg_request_clear
37320>>>    Send Add_ToolTip "€¡ç¨à©ž (F5)"
37321>>>    Set  Status_Help To '€¡ç¨à©ž «¨â®¦¬©˜ª œšš¨˜­ãª / ¨æ©Ÿœ©ž ¤â˜ª œšš¨˜­ãª (F5)'
37322>>>
37322>>>    send Add_button (ico_user+5) msg_request_clear_all
37323>>>    Send Add_ToolTip "Ž¢ ¡ã €¡ç¨à©ž (Ctrl+F5)"
37324>>>    Set  Status_Help To 'Ž¢ ¡ã ˜¡ç¨à©ž «à¤ ›œ›¦£â¤à¤ ©«ž¤ æ¯ž §¦¬ › ˜®œ ¨åœ«˜  ¦ ®¨ã©«žª (Ctrl+F5)'
37325>>>
37325>>>    send Add_button (ico_user+17) msg_DoRefresh_Grids
37326>>>    Send Add_ToolTip "€¤˜¤âà©ž ƒœ›¦£â¤à¤ (Ctrl+Home)"
37327>>>    Set  Status_Help To '€¤˜¤œé¤œ  «˜ ›œ›¦£â¤˜ ©«˜ Grids (Ctrl+Home)'
37328>>>
37328>>>    send Add_space
37329>>>
37329>>>    send Add_button ico_std_filesave msg_request_save
37330>>>    Send Add_ToolTip "„šš¨˜­ã+€¡ç¨à©ž (F2)"
37331>>>    Set  Status_Help To '‘éœ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã ©«¦ ˜¨®œå¦ (F2)'
37332>>>
37332>>>    send Add_button ico_std_delete msg_request_delete
37333>>>    Send Add_ToolTip "ƒ ˜š¨˜­ã (Shift+F2)"
37334>>>    Set  Status_Help To 'ƒ ˜š¨á­œ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã ˜§æ «¦ ˜¨®œå¦ (Shift+F2)'
37335>>>
37335>>>    send Add_button (ico_user+12) msg_request_save_no_clear
37336>>>    Send Add_ToolTip "„šš¨˜­ã (F12)"
37337>>>    Set  Status_Help To '‘éœ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã ©«¦ ˜¨®œå¦ ®à¨åª ¤˜ ¡˜Ÿ˜¨åœ  «˜ ›œ›¦£â¤˜ (F12)'
37338>>>
37338>>>    send Add_space
37339>>>
37339>>>    send Add_button ico_std_cut msg_cut
37340>>>    Send Add_ToolTip "€§¦¡¦§ã"
37341>>>    Set  Status_Help To "€§¦¡æ§«œ  «¦ œ§ ¢œš£â¤¦ ¡¦££á«  ¡˜  «¦ ¡¨˜«áœ  ©«¦ Clipboard"
37342>>>
37342>>>    send Add_button ico_std_copy msg_copy
37343>>>    Send Add_ToolTip "€¤« š¨˜­ã"
37344>>>    Set  Status_Help To "€¤« š¨á­œ  «¦ œ§ ¢œš£â¤¦ ¡¦££á«  ¡˜  «¦ ¡¨˜«áœ  ©«¦ Clipboard"
37345>>>
37345>>>    send Add_button ico_std_paste msg_paste
37346>>>    Send Add_ToolTip "„ ©˜šàšã"
37347>>>    Set  Status_Help To "„ ©ášœ  §œ¨ œ®æ£œ¤˜ ˜§æ «¦ Clipboard"
37348>>>
37348>>>    //send Add_button (ico_user+19) msg_DoPrint
37348>>>    send Add_button ICO_STD_PRINT msg_DoPrint
37349>>>    Send Add_ToolTip "„¡«ç§à©ž"
37350>>>    Set  Status_Help To "„¡«¬§é©œ ª ‰œ £â¤à¤"
37351>>>
37351>>>    send Add_space              
37352>>>
37352>>>    //send Add_button (ico_user+20) msg_DoPrintScreen
37352>>>    send Add_button ICO_STD_PRINTPRE msg_DoPrintScreen
37353>>>    Send Add_ToolTip "„¡«ç§à©ž ¦Ÿæ¤žª"
37354>>>    Set  Status_Help To "„¡«ç§à©ž ¦Ÿæ¤žª ©«¦ Clipboard ã ©«¦¤ „¡«à§à«ã"
37355>>>    
37355>>>    Object oOutputSelector Is A ComboFormSub
37357>>>       Set Entry_State Item 0 to FALSE
37358>>>       Set Combo_Sort_State to FALSE
37359>>>       Set GuiLocation to 1 480
37360>>>       Set Size to 14 55
37361>>>       Set Status_Help to "„§â¢œ¥œ §¦¬ Ÿ˜ šå¤œ  ž œ¡«ç§à©ž «žª ¦Ÿæ¤žª"
37362>>>       Set Focus_Mode to Pointer_Only
37363>>>       Set Skip_State to True
37364>>>       
37364>>>       Procedure Combo_Fill_List
37366>>>       
37366>>>           Send Combo_Add_Item '„¡«¬§à«ãª'
37367>>>           Send Combo_Add_Item 'Clipboard'
37368>>>       
37368>>>       End_Procedure
37369>>>       
37369>>>       Procedure OnChange
37371>>>           String liValue
37372>>>           
37372>>>           Get Value Item 0 to liValue 
37373>>>           If (Combo_Value(Self,0) = liValue) Set piOutputDestination to 0
37376>>>           Else If (Combo_Value(Self,1) = liValue) Set piOutputDestination to 1
37380>>>       End_Procedure
37381>>>       
37381>>>    End_Object   // oReportSelector
37382>>>    
37382>>>    For WindowIndex from 1 to 12
37388>>>>
37388>>>        send Add_space              
37389>>>    Loop
37390>>>>
37390>>>
37390>>>    send Add_button (ico_user+7) msg_DoRebuild
37391>>>    Send Add_ToolTip "„§ › æ¨Ÿà©ž á©žª ƒœ›¦£â¤à¤"
37392>>>    Set  Status_Help To "€¤˜¡˜«˜©¡œ¬ã «à¤ ˆndexes (Reindex) ¡˜  ¡˜Ÿ˜¨ ©£æª «¦¬ª (CleanUp) ˜¤ ®¨œ áœ«˜ "
37393>>>
37393>>>    send Add_button (ico_user+18) msg_DoPopupCalc
37394>>>    Send Add_ToolTip "€¨ Ÿ£¦£ž®˜¤ã"
37395>>>    Set  Status_Help To ""
37396>>>
37396>>>    send Add_button (ico_user+21) msg_DoPopupSetup
37397>>>    Send Add_ToolTip "Setup Client"
37398>>>    Set  Status_Help To "Machine Settings Network Parameter"
37399>>>
37399>>>    send Add_space
37400>>>
37400>>>    send Add_button ico_std_properties msg_DoShowPropertiesPage
37401>>>    Send Add_ToolTip "ˆ› æ«ž«œª"
37402>>>    Set  Status_Help To "ˆ› æ«ž«œª ¡˜  ®˜¨˜¡«ž¨ ©« ¡á «žª œ­˜¨£¦šãª"
37403>>>
37403>>>    send Add_button ico_std_help msg_Help_On_Topic
37404>>>    Send Add_ToolTip "¦ãŸœ ˜ (F1)"
37405>>>    Set  Status_Help To "‰¢ã©ž ©¬©«ã£˜«¦ª ™¦žŸœå˜ª (F1)"
37406>>>
37406>>>    send Add_space
37407>>>
37407>>>    send Add_button (ico_user+13) msg_Exit_Application
37408>>>    Send Add_ToolTip "„¥¦›¦ª (Alt+F4)"
37409>>>    Set  Status_Help To "„¥¦›¦ ˜§æ „­˜¨£¦šã (Alt+F4)"
37410>>>
37410>>>    Procedure DoPrintScreen
37412>>>        Integer iVoid aiWhereTo
37413>>>        
37413>>>        Get piOutputDestination to aiWhereTo
37414>>>        If (aiWhereTo = 0) Send Print_Screen to Desktop ""
37417>>>        Else If (aiWhereTo = 1) Move (Keybd_Event(VK_SNAPSHOT, 0, 0, 0)) To iVoid
37421>>>    End_Procedure
37422>>>
37422>>>
37422>>>    Procedure Redirect_Button_Message integer Itm
37424>>>        Integer msg# liObj liCls
37425>>>        
37425>>>        Get Message   item itm  to Msg#
37426>>>        If (Msg_DoRebuild = Msg#)  Send DoRebuild
37429>>>        Else If (msg_Help_On_Topic = Msg#) Send Help_On_Topic
37433>>>        Else If (msg_Exit_Application = Msg#) Send Exit_Application
37437>>>        Else If (msg_DoPopupCalc = Msg#) Send DoPopupCalc
37441>>>        Else If (msg_DoPrintScreen = Msg#) Send DoPrintScreen
37445>>>        Else If (msg_DoShowPropertiesPage = Msg#) Send DoShowPropertiesPage
37449>>>        Else If (msg_DoPopupSetup = Msg#) Send DoPopupSetup
37453>>>        Else Forward Send Redirect_Button_Message Itm
37456>>>    End_Procedure // Redirect_Message
37457>>>
37457>>>    Procedure DoChangeToolBarIcon Integer iItem Integer iImageIndex
37459>>>        Integer hoClient
37460>>>        
37460>>>        Delegate Get Client_Id To hoClient
37462>>>        Delegate Set Client_Id To 0
37464>>>        //----Changes the Icon
37464>>>        //Set Toolbar_State To False
37464>>>        //Set Form_Image_Index Item iItem To iImageIndex
37464>>>        //Set Toolbar_State To True
37464>>>        //----Changes the Shadow_State
37464>>>        Set Shadow_State Item iItem To iImageIndex
37465>>>        Delegate Set Client_Id To hoClient
37467>>>    End_Procedure // DoChangeToolBarIcon
37468>>>
37468>>>    Procedure Page_Object Integer iState
37470>>>      Integer hoCurrentObject
37471>>>      
37471>>>      Forward Send Page_Object iState
37473>>>      Move (Self) to hoCurrentObject
37474>>>      Send Add_Focus To (oOutputSelector(SELF)) hoCurrentObject
37475>>>    End_Procedure   // Page_Object
37476>>>
37476>>>    
37476>>>    Procedure Page Integer iState
37478>>>        Forward Send Page iState
37480>>>        Set Shadow_State Item 40 to (piPropertiesObjectId(Main_Menu(Self))=0)
37481>>>        If iState Begin
37483>>>             //Set Timer_Active_State Of (oToolBarTimer (Self)) To True
37483>>>        End
37483>>>>
37483>>>    End_Procedure
37484>>>    
37484>>>//    Object oToolBarTimer Is A DfTimer
37484>>>//        Procedure OnTimer
37484>>>//           Local Integer hoFocus bIsDeo bState hoToolBar bIsModal
37484>>>//           
37484>>>//           Get Focus To hoFocus
37484>>>//           If hoFocus Gt Desktop Begin
37484>>>//                Get Is_Function Get_Modal_State hoFocus Dftrue To bIsModal
37484>>>//                // **WvA: 11-10-1999, we should not check the DEO object any more if 
37484>>>//                //                    if it is a modal panel, this could throw up error messages.
37484>>>//                If (bIsModal = DfFalse) Begin
37484>>>//                  Get Is_Function Get_DEO_Object hoFocus Dftrue To bIsDeo
37484>>>//                End
37484>>>//                Move (bIsDeo = Dffalse Or bIsModal = Dftrue) To bState
37484>>>//                Move (Parent (Self)) To hoToolBar
37484>>>//                If (pbToolbarWasDisabled (hoToolBar)) Ne bState Begin
37484>>>//                   Set pbToolbarWasDisabled Of hoToolBar To bState
37484>>>//                   Set Shadow_State Of hoToolBar Item 0 To bState
37484>>>//                   Set Shadow_State Of hoToolBar Item 1 To bState
37484>>>//                   Set Shadow_State Of hoToolBar Item 2 To bState
37484>>>//                   Set Shadow_State Of hoToolBar Item 3 To bState
37484>>>//                   Set Shadow_State Of hoToolBar Item 5 To bState
37484>>>//                   Set Shadow_State Of hoToolBar Item 6 To bState
37484>>>//                   Set Shadow_State Of hoToolBar Item 7 To bState
37484>>>//                   Set Shadow_State Of hoToolBar Item 9 To bState
37484>>>//                   Set Shadow_State Of hoToolBar Item 10 To bState
37484>>>//                End
37484>>>//           End
37484>>>//       End_Procedure // OnTimer
37484>>>//   End_Object // oToolBarTimer
37484>>>   
37484>>>End_Object
37485>>>
37485>>>
37485>    
37485>    Object Client_Area is a AppClientAreasub
37487>
37487>        //AB-ClientStoreTopStart
37487>        String Plhktro_BIP  Plhktro_Esc  Plhktro_N11  Plhktro_N00  Plhktro_FS  Plhktro_AAA  Plhktro_DSI
37487>        String Plhktro_SO   Plhktro_DC4     //expanded for 1 line
37487>        String Plhktro_SI   Plhktro_DC2     //condesed
37487>        String Plhktro_PAV                  //underline
37487>        String Plhktro_EEE  Plhktro_FFF     //emphasized
37487>        String Plhktro_GGG  Plhktro_HHH     //double strike
37487>        String Plhktro_WWW                  //expanded
37487>        string Plhktro_Q Plhktro_160
37487>        
37487>        
37487>        Integer giviewid
37487>        String  gsviewname
37487>        
37487>        Use DD_Sec.Sub
INCLUDING FILE: DD_SEC.SUB
37487>>>
37487>>>Open Sysfile
37489>>>Open UserGrps
37491>>>Open Users
37493>>>Open Views
37495>>>Open GrpViews
37497>>>Open Arxeia
37499>>>Open GrpArx
37501>>>Open GrpArx0
37503>>>Open GrpView0
37505>>>
37505>>>Use DD.Sub
37505>>>
37505>>>Class Datadictionary_Sec  Is A DatadictionarySub
37506>>>
37506>>>
37506>>>    Procedure Construct_Object
37507>>>        Forward Send Construct_Object
37509>>>        Property Integer cpiUpdate              0
37510>>>        Property Integer cpiBackout             0
37511>>>        Property Integer cpiEditing             0
37512>>>        Property Integer cpiFileNumber          0
37513>>>        Property String  cpsFileName            ''
37514>>>        Property String  cpsLoginID             ''
37515>>>        Property Integer cpiCannot_Read         0
37516>>>        Property Integer cpiCannot_Create       0
37517>>>        Property Integer cpiCannot_Delete       0
37518>>>        Property Integer cpiCannot_Edit         0
37519>>>        Property Integer piFN                   0
37520>>>    End_Procedure
37521>>>
37521>>>//    Procedure Save_Main_File
37521>>>//        If (Operation_Origin<>Self) Begin
37521>>>//            If Indirect_File.Recnum Eq 0 Procedure_Return
37521>>>//        End
37521>>>//        Forward Send Save_Main_File
37521>>>//    End_Procedure
37521>>>
37521>>>
37521>>>
37521>>>    Function Validate_Save Returns Integer
37522>>>        Integer rVal
37523>>>        Forward Get Validate_Save to rVal
37525>>>        If (Not(rVal)) Begin
37527>>>            Get cpiCannot_Read to rVal
37528>>>            If (Not(rVal)) Begin
37530>>>                Set cpiEditing to ((cpiBackout(Self)=1) and (cpiUpdate(Self)=1))
37531>>>                If (cpiEditing(Self)=1) Get cpiCannot_Edit      to rVal
37534>>>                Else                    Get cpiCannot_Create    to rVal
37536>>>            End
37536>>>>
37536>>>            If (rVal) Send Operation_Not_Allowed rVal
37539>>>        End
37539>>>>
37539>>>        Function_Return rVal
37540>>>    End_Function
37541>>>
37541>>>    Function Validate_Delete Returns Integer
37542>>>        Integer rVal
37543>>>        Forward Get Validate_Delete to rVal
37545>>>        If (Not(rVal)) Begin
37547>>>            Get cpiCannot_Read to rVal
37548>>>            If (Not(rVal)) Get cpiCannot_Delete to rVal
37551>>>            If (rVal) Send Operation_Not_Allowed rVal
37554>>>        End
37554>>>>
37554>>>        Function_Return rVal
37555>>>    End_Function
37556>>>
37556>>>    Procedure End_Construct_Object
37557>>>        Integer liSrv rVal
37558>>>        String lsStr
37558>>>        Forward Send End_Construct_Object
37560>>>        Get Main_File                                   To liSrv
37561>>>        Set cpiFileNumber                               To liSrv
37562>>>        Get_Attribute DF_FILE_PHYSICAL_NAME Of liSrv    To lsStr
37565>>>        Set cpsFileName                                 To (Trim(Uppercase(lsStr)))
37566>>>        Set cpsLoginID                                  To (fsLoginUserID())
37567>>>        Send Find_User_Rights
37568>>>        Set piFN to lisrv
37569>>>    End_Procedure
37570>>>
37570>>>    Procedure Find_User_Rights
37571>>>        String lsArxeio lsLogin
37572>>>        Integer liUser liArxeio iGroup
37572>>>
37572>>>        Get cpiFileNumber   to liArxeio
37573>>>        Get cpsFileName     to lsArxeio
37574>>>        Get cpsLoginID      to lsLogin
37575>>>
37575>>>        Clear Users
37576>>>        Move lsLogin    to Users.Login_ID
37577>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
37578>>>>
37578>>>        If (Found=1)  Begin
37580>>>            Move Users.User_ID  to liUser
37581>>>            Move Users.Grp_ID   to iGroup
37582>>>        End
37582>>>>
37582>>>        //Else Send Operation_Not_Allowed 9999
37582>>>
37582>>>        Clear Arxeia
37583>>>
37583>>>        Move liArxeio to Arxeia.Arxeio_ID
37584>>>        Find eq Arxeia by Index.1 // Arxeia:Index.1:Arxeia.Arxeio_ID
37585>>>>
37585>>>
37585>>>        If (Found=1) Begin
37587>>>            Move Arxeia.Arxeio_ID to liArxeio
37588>>>
37588>>>            Clear GrpArx
37589>>>            Move liUser     to GrpArx.User_ID
37590>>>            Move liArxeio   to GrpArx.Arxeio_ID
37591>>>            Find eq GrpArx by Index.1 // GrpArx:Index.1:GrpArx.User_ID+GrpArx.Arxeio_ID
37592>>>>
37592>>>            If (Found=1) Begin
37594>>>               If (GrpArx.Allow_Read  ='1') Set cpiCannot_Read   to 0
37597>>>               Else                         Set cpiCannot_Read   to 10003
37599>>>               If (GrpArx.Allow_Create='1') Set cpiCannot_Create to 0
37602>>>               Else                         Set cpiCannot_Create to 10000
37604>>>               If (GrpArx.Allow_Change='1') Set cpiCannot_Edit   to 0
37607>>>               Else                         Set cpiCannot_Edit   to 10001
37609>>>               If (GrpArx.Allow_Delete='1') Set cpiCannot_Delete to 0
37612>>>               Else                         Set cpiCannot_Delete to 10002
37614>>>            End
37614>>>>
37614>>>            Else Begin
37615>>>                Clear GrpArx0
37616>>>                Move iGroup   to GrpArx0.Group_ID
37617>>>                Move liArxeio to GrpArx0.Arxeio_ID
37618>>>                Find eq GrpArx0 by Index.1 // GrpArx0:Index.1:Group_ID+Arxeio_ID
37619>>>>
37619>>>                If (Found=1) Begin
37621>>>                    If (GrpArx0.Allow_Read  ='1')   Set cpiCannot_Read   to 0
37624>>>                    Else                            Set cpiCannot_Read   to 20003
37626>>>                    If (GrpArx0.Allow_Create='1')   Set cpiCannot_Create to 0
37629>>>                    Else                            Set cpiCannot_Create to 20000
37631>>>                    If (GrpArx0.Allow_Change='1')   Set cpiCannot_Edit   to 0
37634>>>                    Else                            Set cpiCannot_Edit   to 20001
37636>>>                    If (GrpArx0.Allow_Delete='1')   Set cpiCannot_Delete to 0
37639>>>                    Else                            Set cpiCannot_Delete to 20002
37641>>>                End
37641>>>>
37641>>>                Else Begin
37642>>>                    Set cpiCannot_Read   to 0
37643>>>                    Set cpiCannot_Edit   to 0
37644>>>                    Set cpiCannot_Create to 0
37645>>>                    Set cpiCannot_Delete to 0
37646>>>                End
37646>>>>
37646>>>            End
37646>>>>
37646>>>        End
37646>>>>
37646>>>        Else Begin
37647>>>            // €¤ ›œ¤ ™¨œŸœ  «¦ ˜¨®œ ¦ «¦«œ Ÿœà¨¦¬£œ ¦«  ¦ ®¨ž©«žª œ®œ  §¨¦©™˜©ž ©'˜¬«¦
37647>>>            Set cpiCannot_Read   to 0
37648>>>            Set cpiCannot_Edit   to 0
37649>>>            Set cpiCannot_Create to 0
37650>>>            Set cpiCannot_Delete to 0
37651>>>        End
37651>>>>
37651>>>    End_Procedure
37652>>>
37652>>>    Procedure Clear_main_file
37653>>>        Forward Send Clear_main_file
37655>>>        Set cpiBackout to 0
37656>>>        Set cpiUpdate  to 0
37657>>>    End_Procedure
37658>>>
37658>>>    Procedure Update
37659>>>        Forward Send Update
37661>>>        Set cpiUpdate to 1
37662>>>    End_Procedure
37663>>>
37663>>>    Procedure Backout
37664>>>        Forward Send Backout
37666>>>        Set cpiBackout to 1
37667>>>    End_Procedure
37668>>>
37668>>>    Procedure OnConstrain
37669>>>        Integer rVal liSrv
37670>>>        Forward Send OnConstrain
37672>>>        Get cpiFileNumber  To liSrv
37673>>>        Move liSrv         To Filenumber
37674>>>        Get cpiCannot_Read to rVal
37675>>>        If (rVal) Constrain Indirect_File.Recnum eq 0
37679>>>    End_Procedure
37680>>>
37680>>>    Procedure Operation_Not_Allowed  Integer iError_Num
37681>>>        String sLektiko
37682>>>        Move '' to sLektiko
37683>>>
37683>>>             If iError_Num eq 10000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
37686>>>        Else If iError_Num eq 10001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Users permissions. Check with your Administrator"    to sLektiko
37690>>>        Else If iError_Num eq 10002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
37694>>>        Else If iError_Num eq 10003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
37698>>>        Else If iError_Num eq 20000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
37702>>>        Else If iError_Num eq 20001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Group permissions. Check with your Administrator"    to sLektiko
37706>>>        Else If iError_Num eq 20002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
37710>>>        Else If iError_Num eq 20003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
37714>>>        Else If iError_Num eq  9999 Move "Unknown User in Users File"                                                                                    to sLektiko
37718>>>        Else If iError_Num eq 20101 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Change its Data"                 to sLektiko
37722>>>        Else If iError_Num eq 20102 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Delete It"                       to sLektiko
37726>>>        Append sLektiko '\nFile = ' (String(cpiFileNumber(Self))) ' - ' (CpsFileName(Self))
37730>>>
37730>>>             If iError_Num eq 10000 Error 10000 sLektiko
37733>>>        Else If iError_Num eq 10001 Error 10001 sLektiko
37737>>>        Else If iError_Num eq 10002 Error 10002 sLektiko
37741>>>        Else If iError_Num eq 10003 Error 10003 sLektiko
37745>>>        Else If iError_Num eq 20000 Error 20000 sLektiko
37749>>>        Else If iError_Num eq 20001 Error 20001 sLektiko
37753>>>        Else If iError_Num eq 20002 Error 20002 sLektiko
37757>>>        Else If iError_Num eq 20003 Error 20003 sLektiko
37761>>>        Else If iError_Num eq  9999 Error  9999 sLektiko
37765>>>        Else If iError_Num eq 20101 Error 20101 sLektiko
37769>>>        Else If iError_Num eq 20102 Error 20102 sLektiko
37773>>>
37773>>>        Else Forward Send Operation_Not_Allowed  iError_Num
37776>>>    End_Procedure   // Operation_Not_Allowed
37777>>>
37777>>>
37777>>>End_Class //Datadictionary_Sec
37778>        use dbviews.sub
INCLUDING FILE: DBVIEWS.SUB
37778>>>
37778>>>Class DbviewSubs Is A DbviewSub
37779>>>
37779>>>    Procedure Construct_Object
37780>>>        Integer iPos iCount
37781>>>        Forward Send Construct_Object
37783>>>
37783>>>        Property String     psMyViewName    Public ''
37784>>>        Property Integer    piMyViewID      Public  0
37785>>>
37785>>>        Get Name            to gsViewName
37786>>>        Get Object_ID       to giViewID
37787>>>
37787>>>        Move 0 to iPos
37788>>>        For iCount From 1 to (Length(gsViewName))
37794>>>>
37794>>>            If (Mid(gsViewName,1,iCount)='.') Move iCount to iPos
37797>>>        Loop
37798>>>>
37798>>>        Move (Right(gsViewName,(Length(gsViewName)-iPos))) to gsViewName
37799>>>        Move (Trim(gsViewName)) to gsViewName
37800>>>
37800>>>        Set psMyViewName    to (Trim(gsViewName))
37801>>>        Set piMyViewID      to giViewID
37802>>>
37802>>>    End_Procedure
37803>>>
37803>>>    Procedure End_Construct_Object
37804>>>        Integer iFileNumber iFieldNumber iUser iColor iLimit iBase iCurr iCol iDeo iPos
37805>>>        Integer iObj iPrototype iColumn iItem iInt iFieldStatus iCurCol iCount
37805>>>        String  sFileName sFieldName sUser sRecr sStr sDbFormName sViewLabel sDeo svn
37805>>>
37805>>>        Forward Send End_Construct_Object
37807>>>
37807>>>
37807>>>        Get psMyViewName        to gsViewName
37808>>>        Get piMyViewID          to giViewID
37809>>>        Get Label Of giViewID   to sViewLabel
37810>>>        Move (Trim(sViewLabel)) to sViewLabel
37811>>>
37811>>>        Clear Oth
37812>>>        Move gsViewName to Oth.View_Name
37813>>>        Find eq Oth By Index.2 // Oth:Index.2:View_Name
37814>>>>
37814>>>        If (Not(Found)) Begin
37816>>>            Move sViewLabel to Oth.View_Label
37817>>>            Move giViewID    to Oth.View_ID
37818>>>            Saverecord Oth
37819>>>        End
37819>>>>
37819>>>
37819>>>    End_Procedure //End_Construct_Object
37820>>>
37820>>>End_Class //dbviewSubs
37821>>>
37821>>>
37821>        use dbforms.sub
INCLUDING FILE: DBFORMS.SUB
37821>>>
37821>>>Class dbFormSubs Is a dbFormSub
37822>>>
37822>>>//    Register_Procedure Set psMyViewName
37822>>>//    Register_Function      psMyViewName Returns String
37822>>>//    Register_Procedure Set piMyViewID
37822>>>//    Register_Function      piMyViewID   Returns Integer
37822>>>
37822>>>    Procedure End_Construct_Object
37823>>>        Integer iFileNumber iFieldNumber iServer
37824>>>        Integer iPos icount iColor iFieldStatus iFileNumber2
37824>>>        String  sStr sDbFormName sViewLabel
37824>>>
37824>>>        Forward Send End_Construct_Object
37826>>>
37826>>>        //If (SysRec.Scr_Fld_Lock='1') Begin
37826>>>
37826>>>            Get Name            to sDbFormName
37827>>>            Get psMyViewName    to gsViewName
37828>>>            Get piMyViewID      to giViewID
37829>>>
37829>>>            Move 0 to iPos
37830>>>            For iCount From 1 to (Length(sDbFormName))
37836>>>>
37836>>>                If (Mid(sDbFormName,1,iCount)='.') Move iCount to iPos
37839>>>            Loop
37840>>>>
37840>>>            Move (Right(sDbFormName,(Length(sDbFormName)-iPos))) to sDbFormName
37841>>>            Move (Trim(sDbFormName)) to sDbFormName
37842>>>
37842>>>            Move (Trim(gsViewName)) to gsViewName
37843>>>
37843>>>            Clear Oth
37844>>>            Move gsViewName to Oth.View_Name
37845>>>            Find eq Oth By Index.2 // Oth:Index.2:View_Name
37846>>>>
37846>>>            Move Oth.View_Label to sViewLabel
37847>>>            Move (Trim(sViewLabel)) to sViewLabel
37848>>>
37848>>>            Clear ViewFlds
37849>>>            Move gsViewName     to ViewFlds.View_Name
37850>>>            Move sDbFormName    to ViewFlds.Scr_Field_Name
37851>>>            Find eq ViewFlds By Index.1 // ViewFlds:Index.1:View_Name+Scr_Field_Name
37852>>>>
37852>>>            If (Not(Found)) Begin
37854>>>                Reread Sysrec
INCLUDING FILE: SYSREC.FD
37858>>>                Move (SysRec.Viewflds_Rec0+1) to ViewFlds.ViewFlds_Rec0
37859>>>                Move (SysRec.Viewflds_Rec0+1) to SysRec.ViewFlds_Rec0
37860>>>                Saverecord SysRec
37861>>>                UnLock
37862>>>>
37862>>>                Move sViewLabel to ViewFlds.View_Label
37863>>>                Saverecord ViewFlds
37864>>>            End
37864>>>>
37864>>>            Else If ((Trim(ViewFlds.View_Label)='') And (sViewLabel<>'')) Begin
37867>>>                Reread ViewFlds
37871>>>                Move sViewLabel to ViewFlds.View_Label
37872>>>                Saverecord ViewFlds
37873>>>                Unlock
37874>>>>
37874>>>            End
37874>>>>
37874>>>            Move (fiScreenFieldStatus(gsViewName,sDbFormName))  to iFieldStatus
37875>>>
37875>>>
37875>>>        // iFieldStatus=0 ==> EVERYTHING IS ALLOWED
37875>>>        // iFieldStatus=1 ==> NO READ ALLOWED
37875>>>        // iFieldStatus=2 ==> NO EDIT BUT CAN COPY
37875>>>        // iFieldStatus=3 ==> NO EDIT AND NO COPY
37875>>>        If (Not(iFieldStatus)) Begin
37877>>>            ////// Field is NORMAL ////////
37877>>>        End
37877>>>>
37877>>>        Else Begin
37878>>>            If (iFieldStatus=1) Begin
37880>>>                ////// Field is NO DISPLAY ////////
37880>>>                Set Enabled_State   Item 0 to False
37881>>>                Set Entry_State     Item 0 to False
37882>>>                Get Color                  to iColor
37883>>>                Set TextColor              to iColor
37884>>>            End
37884>>>>
37884>>>            Else Begin
37885>>>                If (iFieldStatus=2) Begin
37887>>>                    ////// Field is NO EDIT  /////////
37887>>>                    Get Server                                      to iServer
37888>>>                    Get Data_File   Item 0                          to iFileNumber
37889>>>                    If (iServer) Get piFN of iServer                to iFileNumber2
37892>>>
37892>>>                    // €¤ ¦ server œå¤˜  › ˜­¦¨œ« ¡æª ˜§¦ «¦¤ ˜¨ Ÿ£¦ «¦¬ datafile «¦¬ §œ› ¦¬
37892>>>                    // «¦«œ «¦ §œ›å¦ œå¤˜  £§˜£§áª ¡˜  «¦ Noput ›œ¤ §˜ œ  ¦§¦«œ ¡æ™¦¬£œ «¦ Enter
37892>>>                    If (iFileNumber=iFileNumber2)   Set Item_Option Item 0  to Noput True
37895>>>                    Else                            Set Item_Option Item 0  to NoEnter True
37897>>>                End
37897>>>>
37897>>>                Else Begin
37898>>>                    If (iFieldStatus=3) Begin
37900>>>                        ////// Field is NO EDIT AND NO COPY     /////////
37900>>>                        Set Enabled_State   Item 0 to False
37901>>>                        Set Entry_State     Item 0 to False
37902>>>                        Set Shadow_State    Item 0 to True
37903>>>                    End
37903>>>>
37903>>>                End
37903>>>>
37903>>>            End
37903>>>>
37903>>>        End
37903>>>>
37903>>>     End_Procedure
37904>>>
37904>>>End_Class //DbformSubs
37905>>>
37905>        
37905>        Use Stbarpsc.pkg
INCLUDING FILE: STBARPSC.PKG
37905>>>Use DFStatBr.pkg
37905>>>
37905>>>Class BasicPanelStatusBarSub is a BasicStatusBar
37906>>>
37906>>>    Procedure Construct_Object
37907>>>        Forward Send Construct_Object
37909>>>        Property Integer Status_Help_Item Public 0
37910>>>        Property Integer Menu_Simple_State public TRUE
37911>>>        Property Integer Menu_status_State public False
37912>>>        Property Integer Old_Simple_State  public false
37913>>>        Property String  Old_Status_Value  public ''
37914>>>        Set Attach_Parent_State To TRUE
37915>>>        Delegate Set StatusBar_id To Self
37917>>>    End_Procedure
37918>>>
37918>>>    Procedure SET Status_Help_Value String sHelp
37919>>>        Local Integer iPart
37920>>>        Get Status_Help_Item To iPart
37921>>>        Set Value item iPart To sHelp
37922>>>    End_Procedure
37923>>>
37923>>>    Function Status_Help_Value Returns String
37924>>>        Local Integer iPart
37925>>>        Local String sHelp
37925>>>        Get Status_Help_Item To iPart
37926>>>        Get Value item iPart To sHelp
37927>>>        Function_Return sHelp
37928>>>    End_Procedure
37929>>>
37929>>>    Procedure Initialize_Menu
37930>>>       Local integer iState OldState
37931>>>       If Not (Menu_Status_state(Self)) Begin
37933>>>          Get Simple_State to OldState
37934>>>          Set Old_Simple_State to OldState
37935>>>          If OldState   Set Old_Status_Value to (Simple_Value(Self))
37938>>>          Else          Set Old_Status_Value to (Status_Help_Value(Self))
37940>>>          Set Simple_State to (Menu_Simple_State(Self))
37941>>>          Set Menu_Status_State to TRUE
37942>>>       End
37942>>>>
37942>>>    End_Procedure
37943>>>
37943>>>    Procedure Exit_Menu
37944>>>       Local Integer OldState
37945>>>       Local String OldVal
37945>>>       If (Menu_Status_state(Self)) Begin
37947>>>          Get Old_Simple_State to OldState
37948>>>          Set Simple_State     to OldState
37949>>>          Get old_status_Value to oldVal
37950>>>          If OldState ;             Set Simple_Value to OldVal
37953>>>          Else ;             Set Status_Help_Value to OldVal
37955>>>          Set Menu_Status_State to FALSE
37956>>>       End
37956>>>>
37956>>>    End_Procedure // Exit_Menu
37957>>>
37957>>>    Procedure Show_Status_Help String sHelp
37958>>>        Local Integer iState
37959>>>        Get Simple_State to iState
37960>>>        If NOT iState Set Status_Help_Value To sHelp
37963>>>        Else          Set Simple_Value      To sHelp
37965>>>    End_Procedure
37966>>>
37966>>>    Function Current_Status_Help Returns String
37967>>>        Local Integer iState
37968>>>        Local String sHelp
37968>>>        Get Simple_State to iState
37969>>>        If NOT iState Get Status_Help_Value To sHelp
37972>>>        Else          Get Simple_Value      To sHelp
37974>>>        Function_Return sHelp
37975>>>    End_Function
37976>>>
37976>>>
37976>>>End_Class
37977>        
37977>        Open Nomisma
37979>        Open Isotimia
INCLUDING FILE: ISOTIMIA.FD
37981>        
37981>        Function fngConvertPoso Global String asNomismaCodeApo Number anPoso ;                                       String asNomismaCodeSe  Date   adHmnia;                                       Number nIsotimia  Returns Number
37982>        
37982>            Number rVal nApo_Euro_Isot nSe_Euro_Isot
37983>            Integer iApo_Einai_Euro_Zone iApo_Einai_DRX iApo_Einai_Euro iDekadika_Apo
37983>            Integer iSe_Einai_Euro_Zone  iSe_Einai_DRX  iSe_Einai_Euro  iDekadika_Se
37983>            String  sCode
37983>        
37983>            If (asNomismaCodeApo=asNomismaCodeSe) Function_Return anPoso
37986>        
37986>            Clear Nomisma
37987>            Move (Trim(asNomismaCodeApo)) to Nomisma.Nomisma_Code
37988>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
37989>            Move Nomisma.Euro_Zone      to iApo_Einai_Euro_Zone
37990>            Move Nomisma.Einai_DRX      to iApo_Einai_DRX
37991>            Move Nomisma.Einai_EURO     to iApo_Einai_Euro
37992>            Move Nomisma.KL_ISOT_EURO   to nApo_Euro_Isot
37993>            Move Nomisma.Dekadika       to iDekadika_Apo
37994>            // 1. An to nomisma APO den einai ths zonhs euro prepei na vrethei h isotimia tou
37994>            If ((NOT(iApo_Einai_Euro_Zone)) And (nApo_Euro_Isot=0))  Begin
37996>                If (adHmnia='') Sysdate            adHmnia
37999>                Move (Trim(asNomismaCodeApo))   to sCode
38000>                Clear Isotimia
38001>                Move sCode                      to Isotimia.Nomisma_Code
38002>                Move (adHmnia+1)                to Isotimia.Isotimia_Hmnia
38003>                Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
38004>                Move Isotimia.Isotimia_Euro     to nApo_Euro_Isot
38005>            End
38005>        
38005>            Clear Nomisma
38006>            Move (Trim(asNomismaCodeSe)) to Nomisma.Nomisma_Code
38007>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
38008>            Move Nomisma.Euro_Zone      to iSe_Einai_Euro_Zone
38009>            Move Nomisma.Einai_DRX      to iSe_Einai_DRX
38010>            Move Nomisma.Einai_EURO     to iSe_Einai_Euro
38011>            Move Nomisma.KL_ISOT_EURO   to nSe_Euro_Isot
38012>            Move Nomisma.Dekadika       to iDekadika_Se
38013>            // 2. An to nomisma SE den einai ths zonhs euro prepei na vrethei h isotimia tou
38013>            If ((NOT(iSe_Einai_Euro_Zone)) And (nSe_Euro_Isot=0)) Begin
38015>                If (adHmnia='') Sysdate            adHmnia
38018>                Move (Trim(asNomismaCodeSe))    to sCode
38019>                Clear Isotimia
38020>                Move sCode                      to Isotimia.Nomisma_Code
38021>                Move (adHmnia+1)                to Isotimia.Isotimia_Hmnia
38022>                Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
38023>                Move Isotimia.Isotimia_Euro     to nSe_Euro_Isot
38024>            End
38024>        
38024>            Calc (anPoso/nApo_Euro_Isot) to rVal
38025>            Move (Round_Number(rVal,6)) to rVal
38026>            Calc (rVal*nSe_Euro_Isot) to rVal
38027>            Move (Round_Number(rVal,iDekadika_Se)) to rVal
38028>        
38028>            Function_Return rVal
38029>        End_Function
38030>        
38030>        Register_Object oStatusBarSub
38030>        
38030>        Open Syscurxr
38032>        Open SysFile
38034>        Open Sysrecc
INCLUDING FILE: SYSRECC.FD
38036>        Open Sysrecb
INCLUDING FILE: SYSRECB.FD
38038>        Open Sysrecw
INCLUDING FILE: SYSRECW.FD
38040>        
38040>        Procedure Reset_All_Files_Except_System
38042>            Local Integer File# Open# File_Number# liInt iMax iWait isSystem
38043>            Local String Physicalname# DisplayName# Logicalname# Rootname#
38043>            Move 0 To File#
38044>            Repeat
38044>              Get_Attribute Df_File_Next_Opened Of File# To File#
38047>              If (File#) Begin
38049>                Get_Attribute DF_FILE_IS_SYSTEM_FILE    Of File# To isSystem
38052>                If (NOT(isSystem)) Clear File#
38055>              End
38055>            Until File# Eq 0
38057>        End_Procedure
38058>        use v037.vw
INCLUDING FILE: V037.VW
38058>>>//AB/ Project V037:BAXIO
38058>>>//AB/     Object prj is a View_Project
38058>>>//AB/         Set ProjectName to "V037:BAXIO"
38058>>>//AB/         Set ProjectFileName to "V037.VW"
38058>>>
38058>>>// Project Object Structure
38058>>>//   VW037 is a dbViewSub
38058>>>//     Btypkin_DD is a DataDictionary
38058>>>//     Baxiokat_DD is a DataDictionary
38058>>>//     Barticl_DD is a DataDictionary
38058>>>//     Baxio_DD is a DataDictionary
38058>>>//     Syscurxr_DD is a DataDictionary
38058>>>//     Bmove_DD is a DataDictionary
38058>>>//     Baxiokat_Baxiokat_Code is a dbFormSub
38058>>>//     Baxiokat_Baxiokat_Descr is a dbFormSub
38058>>>//     Baxio_Baxio_Code is a dbFormSub
38058>>>//     Baxio_Baxio_Status is a dbFormSub
38058>>>//     Baxio_Baxio_Place is a dbFormSub
38058>>>//     dbTbDlgAxio is a dbTabDialogSub
38058>>>//       TP_Additional is a dbTabPage
38058>>>//         dbGrpObligate is a dbGroupSub
38058>>>//           Baxio_Baxio_Hmnial is a dbFormSub
38058>>>//           Baxio_Baxio_V4 is a dbFormSub
38058>>>//           Rate0 is a dbFormSub
38058>>>//           Rate00 is a dbFormSub
38058>>>//           RateR is a dbFormSub
38058>>>//           TextBoxSub3 is a TextBoxSub
38058>>>//           TextBoxSub4 is a TextBoxSub
38058>>>//           TextBoxSub5 is a TextBoxSub
38058>>>//           txtnom1 is a TextBoxSub
38058>>>//           txtnom2 is a TextBoxSub
38058>>>//           txtnom3 is a TextBoxSub
38058>>>//           Baxio_Baxio_C_Code2 is a dbFormSub
38058>>>//         dbGrpOptional is a dbGroupSub
38058>>>//           Baxio_Baxio_Ekdoths is a dbFormSub
38058>>>//           Baxio_Baxio_Ekdothse is a dbFormSub
38058>>>//           Baxio_Baxio_Sediatagh is a dbFormSub
38058>>>//           Baxio_Baxio_Sdiataghe is a dbFormSub
38058>>>//           Baxio_Baxio_Banka is a dbComboFormSub
38058>>>//           Baxio_Baxio_No is a dbFormSub
38058>>>//           Baxio_Baxio_From is a dbComboFormSub
38058>>>//           Baxio_Baxio_Topos is a dbComboFormSub
38058>>>//           Baxio_Baxio_Opistho is a dbEditSub
38058>>>//           TextBoxSub6 is a TextBoxSub
38058>>>//           TextBoxSub7 is a TextBoxSub
38058>>>//           TextBoxSub8 is a TextBoxSub
38058>>>//           TextBoxSub9 is a TextBoxSub
38058>>>//           TextBoxSub10 is a TextBoxSub
38058>>>//           TextBoxSub11 is a TextBoxSub
38058>>>//           TextBoxSub12 is a TextBoxSub
38058>>>//           Textbox3 is a Textbox
38058>>>//           Textbox4 is a Textbox
38058>>>//       TP_Status is a dbTabPage
38058>>>//         dbGrpEispraktea is a dbGroupSub
38058>>>//           Baxio_Baxio_Fbarticl is a dbFormSub
38058>>>//           Baxio_Baxio_Code_In is a dbFormSub
38058>>>//           Baxio_Baxio_Epon_In is a dbFormSub
38058>>>//           dbFrmHmnia is a dbFormSub
38058>>>//           dbFrmNo is a dbFormSub
38058>>>//           dbFrmGtypkin is a dbFormSub
38058>>>//           TextBoxSub18 is a TextBoxSub
38058>>>//           TextBoxSub19 is a TextBoxSub
38058>>>//           TextBoxSub24 is a TextBoxSub
38058>>>//           TextBoxSub27 is a TextBoxSub
38058>>>//           TextBoxSub30 is a TextBoxSub
38058>>>//         dbGrpPlhrotea is a dbGroupSub
38058>>>//           Baxio_Baxio_Lbarticl is a dbFormSub
38058>>>//           Baxio_Baxio_Code_Out is a dbFormSub
38058>>>//           Baxio_Baxio_Epon_Out is a dbFormSub
38058>>>//           dbFrmHmnia is a dbFormSub
38058>>>//           dbFrmNo is a dbFormSub
38058>>>//           dbFrmGtypkin is a dbFormSub
38058>>>//           TextBoxSub20 is a TextBoxSub
38058>>>//           TextBoxSub21 is a TextBoxSub
38058>>>//           TextBoxSub25 is a TextBoxSub
38058>>>//           TextBoxSub28 is a TextBoxSub
38058>>>//           TextBoxSub31 is a TextBoxSub
38058>>>//         dbGrpCurrentStat is a dbGroupSub
38058>>>//           Baxio_Baxio_Lcode is a dbFormSub
38058>>>//           Baxio_Baxio_Lepon is a dbFormSub
38058>>>//           Baxio_Baxio_Lpar is a dbFormSub
38058>>>//           dbFrmHmnia is a dbFormSub
38058>>>//           dbFrmNo is a dbFormSub
38058>>>//           dbFrmGtypkin is a dbFormSub
38058>>>//           TextBoxSub22 is a TextBoxSub
38058>>>//           TextBoxSub23 is a TextBoxSub
38058>>>//           TextBoxSub26 is a TextBoxSub
38058>>>//           TextBoxSub29 is a TextBoxSub
38058>>>//           TextBoxSub32 is a TextBoxSub
38058>>>//       TP_Bmove is a dbTabPage
38058>>>//         grdBmove is a dbGridSub
38058>>>//     dbGrpYear is a dbGroupSub
38058>>>//       Company_Company_Name is a dbFormSub
38058>>>//       Branch_Branch_Name is a dbFormSub
38058>>>//       Year_Year_Year is a dbFormSub
38058>>>//       otxtCompany is a TextBoxSub
38058>>>//       otxtBranch is a TextBoxSub
38058>>>//       otxtYear is a TextBoxSub
38058>>>//     TextBoxSub1 is a TextBoxSub
38058>>>//     TextBoxSub2 is a TextBoxSub
38058>>>//     TextBoxSub13 is a TextBoxSub
38058>>>//     TextBoxSub14 is a TextBoxSub
38058>>>
38058>>>// Register all objects
38058>>>Register_Object Barticl_DD
38058>>>Register_Object Baxio_Baxio_Banka
38058>>>Register_Object Baxio_Baxio_C_Code2
38058>>>Register_Object Baxio_Baxio_Code
38058>>>Register_Object Baxio_Baxio_Code_In
38058>>>Register_Object Baxio_Baxio_Code_Out
38058>>>Register_Object Baxio_Baxio_Ekdoths
38058>>>Register_Object Baxio_Baxio_Ekdothse
38058>>>Register_Object Baxio_Baxio_Epon_In
38058>>>Register_Object Baxio_Baxio_Epon_Out
38058>>>Register_Object Baxio_Baxio_Fbarticl
38058>>>Register_Object Baxio_Baxio_From
38058>>>Register_Object Baxio_Baxio_Hmnial
38058>>>Register_Object Baxio_Baxio_Lbarticl
38058>>>Register_Object Baxio_Baxio_Lcode
38058>>>Register_Object Baxio_Baxio_Lepon
38058>>>Register_Object Baxio_Baxio_Lpar
38058>>>Register_Object Baxio_Baxio_No
38058>>>Register_Object Baxio_Baxio_Opistho
38058>>>Register_Object Baxio_Baxio_Place
38058>>>Register_Object Baxio_Baxio_Sdiataghe
38058>>>Register_Object Baxio_Baxio_Sediatagh
38058>>>Register_Object Baxio_Baxio_Status
38058>>>Register_Object Baxio_Baxio_Topos
38058>>>Register_Object Baxio_Baxio_V4
38058>>>Register_Object Baxio_DD
38058>>>Register_Object Baxiokat_Baxiokat_Code
38058>>>Register_Object Baxiokat_Baxiokat_Descr
38058>>>Register_Object Baxiokat_DD
38058>>>Register_Object Bmove_DD
38058>>>Register_Object Branch_Branch_Name
38058>>>Register_Object Btypkin_DD
38058>>>Register_Object Company_Company_Name
38058>>>Register_Object dbFrmGtypkin
38058>>>Register_Object dbFrmHmnia
38058>>>Register_Object dbFrmNo
38058>>>Register_Object dbGrpCurrentStat
38058>>>Register_Object dbGrpEispraktea
38058>>>Register_Object dbGrpObligate
38058>>>Register_Object dbGrpOptional
38058>>>Register_Object dbGrpPlhrotea
38058>>>Register_Object dbGrpYear
38058>>>Register_Object dbTbDlgAxio
38058>>>Register_Object grdBmove
38058>>>Register_Object otxtBranch
38058>>>Register_Object otxtCompany
38058>>>Register_Object otxtYear
38058>>>Register_Object Rate0
38058>>>Register_Object Rate00
38058>>>Register_Object RateR
38058>>>Register_Object Syscurxr_DD
38058>>>Register_Object TextBoxSub1
38058>>>Register_Object TextBoxSub10
38058>>>Register_Object TextBoxSub11
38058>>>Register_Object TextBoxSub12
38058>>>Register_Object TextBoxSub13
38058>>>Register_Object TextBoxSub14
38058>>>Register_Object TextBoxSub18
38058>>>Register_Object TextBoxSub19
38058>>>Register_Object TextBoxSub2
38058>>>Register_Object TextBoxSub20
38058>>>Register_Object TextBoxSub21
38058>>>Register_Object TextBoxSub22
38058>>>Register_Object TextBoxSub23
38058>>>Register_Object TextBoxSub24
38058>>>Register_Object TextBoxSub25
38058>>>Register_Object TextBoxSub26
38058>>>Register_Object TextBoxSub27
38058>>>Register_Object TextBoxSub28
38058>>>Register_Object TextBoxSub29
38058>>>Register_Object TextBoxSub3
38058>>>Register_Object TextBoxSub30
38058>>>Register_Object TextBoxSub31
38058>>>Register_Object TextBoxSub32
38058>>>Register_Object TextBoxSub4
38058>>>Register_Object TextBoxSub5
38058>>>Register_Object TextBoxSub6
38058>>>Register_Object TextBoxSub7
38058>>>Register_Object TextBoxSub8
38058>>>Register_Object TextBoxSub9
38058>>>Register_Object Textbox3
38058>>>Register_Object Textbox4
38058>>>Register_Object TP_Additional
38058>>>Register_Object TP_Bmove
38058>>>Register_Object TP_Status
38058>>>Register_Object txtnom1
38058>>>Register_Object txtnom2
38058>>>Register_Object txtnom3
38058>>>Register_Object VW037
38058>>>Register_Object Year_Year_Year
38058>>>
38058>>>
38058>>>//AB/     AppBuild VIEW
38058>>>
38058>>>    //AB-IgnoreStart
38058>>>
38058>>>    Use dbView.Sub
38058>>>    Use DFAllEnt.pkg
38058>>>    Use dbForm.Sub
38058>>>    Use dbTabdlg.Sub
38058>>>    Use dbGroup.Sub
38058>>>    Use Txtbox.Sub
38058>>>    Use dbCmbfrm.Sub
38058>>>    Use dbEdit.Sub
38058>>>    Use dbGrid.Sub
38058>>>
38058>>>    Use BTYPKIN.DD
INCLUDING FILE: BTYPKIN.DD
38058>>>>>//DDB-FileStart
38058>>>>>//DDB-HeaderStart
38058>>>>>
38058>>>>>// File Name : BTYPKIN.DD
38058>>>>>// Class Name: Btypkin_DataDictionary
38058>>>>>// Revision  : 110
38058>>>>>// Version   : 2
38058>>>>>
38058>>>>>Use  Windows           // Basic Definitions
38058>>>>>Use  DataDict          // DataDictionary Class Definition
38058>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38058>>>>>
38058>>>>>Open Btypkin
38060>>>>>Open Bflagkin
INCLUDING FILE: BFLAGKIN.FD
38062>>>>>Open Bkinkat
INCLUDING FILE: BKINKAT.FD
38064>>>>>Open Barticl
INCLUDING FILE: BARTICL.FD
38066>>>>>Open Sysrecb
38068>>>>>
38068>>>>>//DDB-HeaderEnd
38068>>>>>//DDB-ValidationStart
38068>>>>>
38068>>>>>//DDB/ ExternalValidationTable Bfile_VT  Baxio.pkg
38068>>>>>
38068>>>>>Register_Object Bfile_VT
38068>>>>>Register_Object Btypkin_Btypkin_Anti_Xp_VT
38068>>>>>Use Baxio.pkg        // Bfile_VT
INCLUDING FILE: BAXIO.PKG
38068>>>>>>>// **************************************************************************
38068>>>>>>>// *Code Style   : Object                                                   *
38068>>>>>>>// *Name         : Baxio.vts                                                *
38068>>>>>>>// *Revision     : 1                                                        *
38068>>>>>>>// *Main File    :                                                          *
38068>>>>>>>// *Location     : \Home.Win\Easyware\ED\Appsrc                             *
38068>>>>>>>// *Creation Date: 01/09/99                                                 *
38068>>>>>>>// *Last Update  :                                                          *
38068>>>>>>>// *Author       : JA                                                       *
38068>>>>>>>// *Includes     :                                                          *
38068>>>>>>>// *Comments     : œ¨ â®œ  æ¢˜ «˜ static validation tables «¦¬             *
38068>>>>>>>// *             : module «à¤ ˜¥ ¦š¨á­à¤.                                   *
38068>>>>>>>// *             :                                                          *
38068>>>>>>>// *             :                                                          *
38068>>>>>>>// *Returns      :                                                          *
38068>>>>>>>// *             :                                                          *
38068>>>>>>>// *‰nown bugs   :                                                          *
38068>>>>>>>// *             :                                                          *
38068>>>>>>>// *Improvements :                                                          *
38068>>>>>>>// *             :                                                          *
38068>>>>>>>// *             :                                                          *
38068>>>>>>>// **************************************************************************
38068>>>>>>>// *                        A N A L Y S I S                                 *
38068>>>>>>>// **************************************************************************
38068>>>>>>>// *                                                                        *
38068>>>>>>>// **************************************************************************
38068>>>>>>>
38068>>>>>>>
38068>>>>>>>//Set Allow_Blank_State To TRUE
38068>>>>>>>
38068>>>>>>>//used by: 1. baxiokat.baxiokat_type
38068>>>>>>>Object Baxiokat_Type_VT  is a DescriptionValidationTable
38070>>>>>>>       set table_title to "„å›¦ª €¥ ¦š¨á­¦¬"
38071>>>>>>>       Procedure Fill_List
38073>>>>>>>                 Forward Send Fill_List
38075>>>>>>>                 Send Add_Table_Value  "1"  "„ ©§¨˜¡«â¦"
38076>>>>>>>                 send add_table_value  "2"  "¢ž¨à«â¦"
38077>>>>>>>       End_Procedure //fill_list
38078>>>>>>>End_Object   //Baxiokat_Type_VT
38079>>>>>>>
38079>>>>>>>
38079>>>>>>>//¡˜«˜©«á©œ ª ˜¥ ¦š¨á­à¤
38079>>>>>>>//used by: 1. bkinkat.baxio_stat_from :¡˜«á©«˜©ž ˜§æ
38079>>>>>>>//         2. bkinkat.baxio_stat_to   :¡˜«á©«˜©ž ©â
38079>>>>>>>//         3. baxio.baxio_status      :¡˜«á©«˜©ž
38079>>>>>>>//â¤˜ ˜¥ æš¨˜­¦ œå¤˜  § Ÿ˜¤æ ¤˜ ™¨œŸœå ©« ª §˜¨˜¡á«à 3 ¡˜«˜©«á©œ ª:
38079>>>>>>>Object Baxio_Status_VT  is a DescriptionValidationTable
38081>>>>>>>       set table_title to "‰˜«˜©«á©œ ª €¥ ¦š¨á­à¤"
38082>>>>>>>       Procedure Fill_List
38084>>>>>>>                 Forward Send Fill_List
38086>>>>>>>                 Send Add_Table_Value  "1"  "„¡¡¨œ£âª"
38087>>>>>>>                 Send Add_Table_Value  "2"  "„¥¦­¢ž£â¤¦"
38088>>>>>>>                 Send Add_Table_Value  "3"  "ƒ ˜£˜¨«¬¨ž£â¤¦"
38089>>>>>>>                 Send Add_Table_Value  "4"  "’˜£œå¦"
38090>>>>>>>                 Send Add_Table_Value  "5"  "ƒœ©£œ¬£â¤¦"
38091>>>>>>>
38091>>>>>>>       End_Procedure // fill_list
38092>>>>>>>End_Object   //Baxio_Status_VT1
38093>>>>>>>
38093>>>>>>>
38093>>>>>>>
38093>>>>>>>//used by: 1. btypkin.btypkin_anti1
38093>>>>>>>//         2. btypkin.btypkin_anti2
38093>>>>>>>//         3. baxio.baxio_file_in
38093>>>>>>>//         4. baxio.baxio_file_out
38093>>>>>>>//         5. baxio.baxio_lfile
38093>>>>>>>Object Bfile_VT  is a DescriptionValidationTable
38095>>>>>>>       set table_title to "‘¬¤˜¢¢˜©æ£œ¤¦ª/˜¨˜¢ã§«žª ˜§æ"
38096>>>>>>>       Procedure Fill_List
38098>>>>>>>                 Forward Send Fill_List
38100>>>>>>>                 Send Add_Table_Value  "-1" "ƒœ¤ “§á¨®œ "
38101>>>>>>>                 Send Add_Table_Value  "0"  "Data Entry"
38102>>>>>>>                 Send Add_Table_Value  "1"  "Š¦š˜¨ ˜©£é¤ ‚Š"
38103>>>>>>>                 send add_table_value  "2"  "”¦¨â˜ª"
38104>>>>>>>                 Send Add_Table_Value  "3"  "¨¦£žŸœ¬«é¤"
38105>>>>>>>                 Send Add_Table_Value  "5"  "Ž ‘¬¤˜¢¢˜©æ£œ¤¦ª"
38106>>>>>>>                 Send Add_Table_Value  "6"  "’œ¢.˜¨˜¢ã§«žª"
38107>>>>>>>       End_Procedure // fill_list
38108>>>>>>>End_Object   // Btypkin_Btypkin_Anti_VT
38109>>>>>>>
38109>>>>>
38109>>>>>Object Btypkin_Btypkin_Anti_Xp_VT  is a DescriptionValidationTable
38111>>>>>
38111>>>>>    Procedure Fill_List
38113>>>>>        Forward Send Fill_List
38115>>>>>        Send Add_Table_Value  "1"  "•¨œé¤œ«˜ "
38116>>>>>        Send Add_Table_Value  "2"  " ©«é¤œ«˜ "
38117>>>>>    End_Procedure    // Fill_List
38118>>>>>    //DDB-ValidationCustomStart
38118>>>>>    //DDB-ValidationCustomEnd
38118>>>>>End_Object   // Btypkin_Btypkin_Anti_Xp_VT
38119>>>>>//DDB-ValidationEnd
38119>>>>>//DDB-SelectionStart
38119>>>>>//DDB/ ExternalSelectionList SL031  SL031.SL
38119>>>>>//DDB/ ExternalSelectionList sl007  sl007.SL
38119>>>>>//DDB/ ExternalSelectionList sl007r  sl007r.SL
38119>>>>>Register_Object SL031
38119>>>>>Register_Object sl007
38119>>>>>Register_Object sl007r
38119>>>>>//DDB-SelectionEnd
38119>>>>>
38119>>>>>// JSJSJSJS 24/01/2001 Register_Object SL056 //¢å©«˜ gplan
38119>>>>>//Register_Object SL056 //¢å©«˜ vendor
38119>>>>>
38119>>>>>
38119>>>>>Open SysCurXr
38121>>>>>
38121>>>>>Open Barticl //©œ«á¨œ  prompt objects
38123>>>>>// JSJSJSJS 24/01/2001 Open Gtypkin //™¨å©¡œ  rec0 ©«ž¤ update, externalyy updated, lock on save
38123>>>>>//Open Ctypkin //™¨å©¡œ  rec0 ©«ž¤ update, externalyy updated, lock on save
38123>>>>>//Open Vtypkin //™¨å©¡œ  rec0 ©«ž¤ update, externalyy updated, lock on save
38123>>>>>
38123>>>>>
38123>>>>>// JSJSJSJS 24/01/2001 Use SL056.SL //¢å©«˜ gplan
38123>>>>>//Use SL102.SL //¢å©«˜ customer
38123>>>>>//Use SL???.SL //¢å©«˜ vendor
38123>>>>>Use sl100.sl // Clients selection list
INCLUDING FILE: SL100.SL
38123>>>>>>>//AB/ Project SL100:PELATES
38123>>>>>>>//AB/     Object prj is a Lookup_Project
38123>>>>>>>//AB/         Set ProjectName to "SL100:PELATES"
38123>>>>>>>//AB/         Set ProjectFileName to "SL100.SL"
38123>>>>>>>
38123>>>>>>>// Project Object Structure
38123>>>>>>>//   sl100 is a dbModalPanelSub
38123>>>>>>>//     Clients_DD is a DataDictionary
38123>>>>>>>//     oSelList is a dbListSub
38123>>>>>>>//     oOK_bn is a ButtonSub
38123>>>>>>>//     oCancel_bn is a ButtonSub
38123>>>>>>>//     oSearch_bn is a ButtonSub
38123>>>>>>>
38123>>>>>>>// Register all objects
38123>>>>>>>Register_Object Clients_DD
38123>>>>>>>Register_Object oCancel_bn
38123>>>>>>>Register_Object oOK_bn
38123>>>>>>>Register_Object oSearch_bn
38123>>>>>>>Register_Object oSelList
38123>>>>>>>Register_Object sl100
38123>>>>>>>
38123>>>>>>>
38123>>>>>>>    //AB-IgnoreStart
38123>>>>>>>
38123>>>>>>>    Use DFAllEnt.pkg
38123>>>>>>>    Use dbList.Sub
38123>>>>>>>    Use Button.Sub
38123>>>>>>>
38123>>>>>>>
38123>>>>>>>    Use CLIENTS.DD
INCLUDING FILE: CLIENTS.DD
38123>>>>>>>>>//DDB-FileStart
38123>>>>>>>>>//DDB-HeaderStart
38123>>>>>>>>>
38123>>>>>>>>>// File Name : CLIENTS.DD
38123>>>>>>>>>// Class Name: Clients_DataDictionary
38123>>>>>>>>>// Revision  : 235
38123>>>>>>>>>// Version   : 2
38123>>>>>>>>>
38123>>>>>>>>>Use  Windows           // Basic Definitions
38123>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
38123>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38123>>>>>>>>>
38123>>>>>>>>>Open Clients
38125>>>>>>>>>Open Cmoves
INCLUDING FILE: CMOVES.FD
38127>>>>>>>>>Open Particle
INCLUDING FILE: PARTICLE.FD
38129>>>>>>>>>Open Cmovesa
INCLUDING FILE: CMOVESA.FD
38131>>>>>>>>>Open Cn
38133>>>>>>>>>Open Particll
INCLUDING FILE: PARTICLL.FD
38135>>>>>>>>>Open Clnbank
INCLUDING FILE: CLNBANK.FD
38137>>>>>>>>>Open Tpclient
INCLUDING FILE: TPCLIENT.FD
38139>>>>>>>>>Open Clorder
INCLUDING FILE: CLORDER.FD
38141>>>>>>>>>Open Clitem
INCLUDING FILE: CLITEM.FD
38143>>>>>>>>>Open Cities
38145>>>>>>>>>Open Areas
38147>>>>>>>>>Open Payresp
38149>>>>>>>>>Open Syscurxr
38151>>>>>>>>>Open Sysrecc
38153>>>>>>>>>Open Ptypparl
38155>>>>>>>>>
38155>>>>>>>>>//DDB-HeaderEnd
38155>>>>>>>>>//DDB-ValidationStart
38155>>>>>>>>>
38155>>>>>>>>>Register_Object Clients_Client_Doy_VT
38155>>>>>>>>>Register_Object Clients_Client_Job_VT
38155>>>>>>>>>Register_Object Clients_Client_Categfpa_VT
38155>>>>>>>>>Register_Object Clients_Client_Catjob_VT1
38155>>>>>>>>>Register_Object Clients_Client_Idiot_VT
38155>>>>>>>>>Register_Object Clients_Feregios_VT
38155>>>>>>>>>
38155>>>>>>>>>Object Clients_Client_Doy_VT  is a CodeValidationTable
38157>>>>>>>>>    Set Type_Value        To "DOY"
38158>>>>>>>>>    Set Validate_State    To FALSE
38159>>>>>>>>>    Set Allow_Blank_State To TRUE
38160>>>>>>>>>    Set Table_Title       To "ƒ.Ž.“"
38161>>>>>>>>>    //DDB-ValidationCustomStart
38161>>>>>>>>>    //DDB-ValidationCustomEnd
38161>>>>>>>>>End_Object   // Clients_Client_Doy_VT
38162>>>>>>>>>
38162>>>>>>>>>Object Clients_Client_Job_VT  is a CodeValidationTable
38164>>>>>>>>>    Set Type_Value        To "JOB"
38165>>>>>>>>>    Set Validate_State    To FALSE
38166>>>>>>>>>    Set Allow_Blank_State To TRUE
38167>>>>>>>>>    Set Table_Title       To "„§˜ššâ¢£˜«˜"
38168>>>>>>>>>    //DDB-ValidationCustomStart
38168>>>>>>>>>    //DDB-ValidationCustomEnd
38168>>>>>>>>>End_Object   // Clients_Client_Job_VT
38169>>>>>>>>>
38169>>>>>>>>>Object Clients_Client_Categfpa_VT  is a CodeValidationTable
38171>>>>>>>>>    Set Type_Value        To "VAT_STATUS"
38172>>>>>>>>>    Set Validate_State    To FALSE
38173>>>>>>>>>    Set Allow_Blank_State To TRUE
38174>>>>>>>>>    //DDB-ValidationCustomStart
38174>>>>>>>>>    //DDB-ValidationCustomEnd
38174>>>>>>>>>End_Object   // Clients_Client_Categfpa_VT
38175>>>>>>>>>
38175>>>>>>>>>Object Clients_Client_Catjob_VT1  is a CodeValidationTable
38177>>>>>>>>>    Set Type_Value        To "JOB"
38178>>>>>>>>>    Set Validate_State    To FALSE
38179>>>>>>>>>    Set Allow_Blank_State To TRUE
38180>>>>>>>>>    //DDB-ValidationCustomStart
38180>>>>>>>>>    //DDB-ValidationCustomEnd
38180>>>>>>>>>End_Object   // Clients_Client_Catjob_VT1
38181>>>>>>>>>
38181>>>>>>>>>Object Clients_Client_Idiot_VT  is a CodeValidationTable
38183>>>>>>>>>    Set Type_Value        To "IDIOT"
38184>>>>>>>>>    Set Validate_State    To FALSE
38185>>>>>>>>>    Set Allow_Blank_State To TRUE
38186>>>>>>>>>    Set Table_Title       To "€¨®œå¦ ˆ› ¦«ã«à¤"
38187>>>>>>>>>    //DDB-ValidationCustomStart
38187>>>>>>>>>    //DDB-ValidationCustomEnd
38187>>>>>>>>>End_Object   // Clients_Client_Idiot_VT
38188>>>>>>>>>
38188>>>>>>>>>Object Clients_Feregios_VT  is a CodeValidationTable
38190>>>>>>>>>    Set Type_Value        To "FEREGIOS"
38191>>>>>>>>>    Set Allow_Blank_State To TRUE
38192>>>>>>>>>    Set Table_Title       To "ƒœå¡«œª ”œ¨œšš¬æ«ž«˜ª ”¦¨âà¤"
38193>>>>>>>>>    //DDB-ValidationCustomStart
38193>>>>>>>>>    //DDB-ValidationCustomEnd
38193>>>>>>>>>End_Object   // Clients_Feregios_VT
38194>>>>>>>>>//DDB-ValidationEnd
38194>>>>>>>>>//DDB-SelectionStart
38194>>>>>>>>>//DDB/ ExternalSelectionList sl100  sl100.SL
38194>>>>>>>>>Register_Object sl100
38194>>>>>>>>>//DDB-SelectionEnd
38194>>>>>>>>>Open Sysfile
38196>>>>>>>>>open year
38198>>>>>>>>>
38198>>>>>>>>>Class Clients_DataDictionary  is a DataDictionary_Sec
38199>>>>>>>>>
38199>>>>>>>>>    Procedure Construct_Object
38200>>>>>>>>>        Forward Send Construct_Object
38202>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
38203>>>>>>>>>        Property Integer piCheckPlaf        Public 0
38204>>>>>>>>>    End_Procedure
38205>>>>>>>>>
38205>>>>>>>>>    // Backout:
38205>>>>>>>>>    Procedure Backout
38206>>>>>>>>>        Forward Send Backout
38208>>>>>>>>>        // Insert Code Here
38208>>>>>>>>>    End_Procedure   // Backout
38209>>>>>>>>>
38209>>>>>>>>>
38209>>>>>>>>>
38209>>>>>>>>>    Procedure Update
38210>>>>>>>>>        Forward Send Update
38212>>>>>>>>>        // Insert Code Here
38212>>>>>>>>>        Move SysCurXR.Company_Code  to Clients.Company_Code
38213>>>>>>>>>        Move SysCurXR.Branch_Code   to Clients.Branch_Code
38214>>>>>>>>>        Move SysCurXR.Year_Year     to Clients.Year_Year
38215>>>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
38215>>>>>>>>>        Move (Clients.Xreosh-Clients.Pistosh)   to Clients.Ypoloipo
38216>>>>>>>>>        Move (Clients.Plafon-Clients.Ypoloipo)  to Clients.Overhead
38217>>>>>>>>>
38217>>>>>>>>>        //Move Clients.Client_Address     to Clients.Client_LastUpd
38217>>>>>>>>>
38217>>>>>>>>>        //betolink
38217>>>>>>>>>        Move SysCurXR.Beto_Site      to Clients.Client_SiteW
38218>>>>>>>>>        Move Clients.Client_Rec0     to Clients.Client_SN
38219>>>>>>>>>        Move Clients.Client_id       to Clients.Client_Repm
38220>>>>>>>>>        Move Clients.Company_Code    to Clients.CLIENT_COMPANY
38221>>>>>>>>>        Move Clients.Client_id       to Clients.Client_RepMatch
38222>>>>>>>>>     //   Move (gsfCode_Mast('JOB',Clients.Client_CatJob)) to Clients.Client_Job
38222>>>>>>>>>    End_Procedure   // Update
38223>>>>>>>>>
38223>>>>>>>>>
38223>>>>>>>>>    Procedure Creating
38224>>>>>>>>>        date ddate iYes
38225>>>>>>>>>        Forward Send Creating
38227>>>>>>>>>        // Insert Code Here
38227>>>>>>>>>
38227>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Clients.Client_Rec0))))));                                    to Clients.Client_Recr
38228>>>>>>>>>        Move '1'                    to Clients.Client_Active
38229>>>>>>>>>        get fsgCode_With_Zeroes Clients.Client_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to Clients.Client_ID
38230>>>>>>>>>        sysdate4 ddate
38231>>>>>>>>>        move ddate                  to Clients.Client_Hmnia
38232>>>>>>>>>// gts 19-12-05 ›œ¤ §˜åœ  §¦¬Ÿœ¤á £ã§àª Ÿœ©/¤ ¡ž 
38232>>>>>>>>>//        clear year
38232>>>>>>>>>//        move syscurxr.company_code  to year.company_code
38232>>>>>>>>>//        move syscurxr.branch_code   to year.branch_code
38232>>>>>>>>>//        move syscurxr.year_year     to year.year_year
38232>>>>>>>>>//        find eq year by index.1
38232>>>>>>>>>//        If (found=1) begin
38232>>>>>>>>>//            move year.clients_plafon to clients.plafon
38232>>>>>>>>>//            move year.clients_ofeilh to clients.orio_syn_ofeilh
38232>>>>>>>>>//        end
38232>>>>>>>>>    End_Procedure   // Creating
38233>>>>>>>>>
38233>>>>>>>>>    Function Validate_Save  Returns Integer
38234>>>>>>>>>        Integer iReturnVal iCheck iYes
38235>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
38237>>>>>>>>>        If (Not(iReturnVal)) Begin
38239>>>>>>>>>
38239>>>>>>>>>            If (clients.is_eksoter <> '1') begin
38241>>>>>>>>>                If (Clients.Is_Xondr='1') Begin
38243>>>>>>>>>                    If (Sysfile.Check_Afm=1) Begin
38245>>>>>>>>>                        Move (Check_AFM(Clients.Client_Afm)) to iCheck
38246>>>>>>>>>                        If (iCheck) Begin
38248>>>>>>>>>                                 If (iCheck=1) Move 4001 to iReturnVal
38251>>>>>>>>>                            Else If (iCheck=2) Move 4002 to iReturnVal
38255>>>>>>>>>                            Else If (iCheck=3) Move 4003 to iReturnVal
38259>>>>>>>>>                        End
38259>>>>>>>>>>
38259>>>>>>>>>                    End
38259>>>>>>>>>>
38259>>>>>>>>>                End
38259>>>>>>>>>>
38259>>>>>>>>>            End
38259>>>>>>>>>>
38259>>>>>>>>>
38259>>>>>>>>>            If (piCheckPlaf(Self)=1) Begin
38261>>>>>>>>>                If ((Clients.Plafon>0) And ((Clients.Ypoloipo+Clients.Posa_Apo_Dap)>Clients.Plafon)) Begin
38263>>>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4000 Clients' to iYes
38264>>>>>>>>>                    If (iYes=MBR_NO) Error 4004 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž' //Move 4004 to iReturnVal
38267>>>>>>>>>                End
38267>>>>>>>>>>
38267>>>>>>>>>                Else If ((PayResp.Plafon<>0) And (PayResp.Plafon<=PayResp.Synolikh_Ofeilh)) Begin
38270>>>>>>>>>                    Get YesNo_Box 'Ž ¬§œçŸ¬¤¦ª §¢ž¨à£ãª ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž\nŒ˜ ©¬¤œ®å©à ©«ž¤ ›ž£ ¦¬¨šå˜ œšš¨˜­ãª §œ¢á«ž;' to iYes
38271>>>>>>>>>                    If (iYes=MBR_NO) Error 4005 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
38274>>>>>>>>>                End
38274>>>>>>>>>>
38274>>>>>>>>>                Else If ((Clients.Orio_Syn_Ofeilh>0) And (Clients.Synolikh_Ofeilh>Clients.Orio_Syn_Ofeilh)) Begin
38277>>>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4001 Clients' to iYes
38278>>>>>>>>>                    If (iYes=MBR_NO) Error 4005 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
38281>>>>>>>>>                End
38281>>>>>>>>>>
38281>>>>>>>>>                Else If ((Clients.Orio_Syn_Ofeilh>0) And (PayResp.Orio_Syn_Ofeilh>0) And (Clients.Synolikh_Ofeilh>Payresp.Orio_Syn_Ofeilh)) Begin
38284>>>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4002 Clients' to iYes
38285>>>>>>>>>                    If (iYes=MBR_NO) Error 4006 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'   //Move 4006 to iReturnVal
38288>>>>>>>>>                End
38288>>>>>>>>>>
38288>>>>>>>>>                If ((Clients.Plafon>0) And ((Clients.Ypoloipo+Clients.Posa_Apo_Parag)>Clients.Plafon)) Begin
38290>>>>>>>>>                    Send Info_Box '’˜ §¦©á «à¤ ž£œ¨ž©åà¤ §˜¨˜ššœ¢ é¤\n¬§œ¨™˜å¤¦¬¤ «¦ › ˜Ÿâ© £¦ ¬§æ¢¦ §¦\n™á©ž §¢˜­æ¤ «¦¬ §œ¢á«ž' '¨¦©¦®ã !!!'
38291>>>>>>>>>                End
38291>>>>>>>>>>
38291>>>>>>>>>            End
38291>>>>>>>>>>
38291>>>>>>>>>
38291>>>>>>>>>            If (iReturnVal) Begin
38293>>>>>>>>>                Send Operation_Not_Allowed iReturnVal
38294>>>>>>>>>            End
38294>>>>>>>>>>
38294>>>>>>>>>        End
38294>>>>>>>>>>
38294>>>>>>>>>        Function_Return iReturnVal
38295>>>>>>>>>    End_Function   // Validate_Save
38296>>>>>>>>>
38296>>>>>>>>>
38296>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
38297>>>>>>>>>        String lsError_Message
38298>>>>>>>>>
38298>>>>>>>>>        Case Begin
38298>>>>>>>>>            Case (iError_Num = 4001)
38300>>>>>>>>>                Move "DDC 100: Š˜¤Ÿ˜©£â¤¦ €”‹ œ¢á«ž" ;                    to lsError_Message
38301>>>>>>>>>              Case Break
38302>>>>>>>>>            Case (iError_Num = 4002)
38305>>>>>>>>>                Move "DDC 100: ’¦ €”‹ œ¢á«ž ›œ¤ œå¤˜  9 ¯ã­ ¦" ;                    to lsError_Message
38306>>>>>>>>>              Case Break
38307>>>>>>>>>            Case (iError_Num = 4003)
38310>>>>>>>>>                Move "DDC 100: €¡˜«á¢¢ž¢¦ª ®˜¨˜¡«ã¨˜ª ©«¦ €”‹ œ¢á«ž" ;                    to lsError_Message
38311>>>>>>>>>              Case Break
38312>>>>>>>>>            Case (iError_Num = 4004)
38315>>>>>>>>>                Move "DDC 100: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ §œ¢á«ž" ;                    to lsError_Message
38316>>>>>>>>>              Case Break
38317>>>>>>>>>            Case (iError_Num = 4005)
38320>>>>>>>>>                Move "DDC 100: † ©¬¤¦¢ ¡ã ¦­œ ¢ã ¬§œ¨™˜å¤œ \n«¦ æ¨ ¦ ©¬¤¦¢ ¡ãª ¦­œ ¢ãª" ;                    to lsError_Message
38321>>>>>>>>>              Case Break
38322>>>>>>>>>            Case (iError_Num = 4006)
38325>>>>>>>>>                Move "DDC 100: † ©¬¤¦¢ ¡ã ¦­œ ¢ã ¬§œ¨™˜å¤œ \n«¦ æ¨ ¦ ©¬¤¦¢ ¡ãª ¦­œ ¢ãª «¦¬ “§œ¬Ÿç¤¦¬" ;                    to lsError_Message
38326>>>>>>>>>              Case Break
38327>>>>>>>>>
38327>>>>>>>>>            Case Else
38327>>>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
38329>>>>>>>>>        Case End
38329>>>>>>>>>
38329>>>>>>>>>        Error iError_Num lsError_Message
38330>>>>>>>>>>
38330>>>>>>>>>    End_Procedure // operation_not_allowed
38331>>>>>>>>>
38331>>>>>>>>>
38331>>>>>>>>>    // Define_Fields:
38331>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
38331>>>>>>>>>
38331>>>>>>>>>    Procedure Define_Fields
38332>>>>>>>>>        Forward Send Define_Fields
38334>>>>>>>>>        //DDB-Generated-Code-Location
38334>>>>>>>>>        //DDB-DefineFieldStart
38334>>>>>>>>>
38334>>>>>>>>>        Set Main_File            To Clients.File_Number
38335>>>>>>>>>        Set Cascade_Delete_State To FALSE
38336>>>>>>>>>
38336>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
38337>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
38338>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38339>>>>>>>>>
38339>>>>>>>>>        // Child (Client) file structure................
38339>>>>>>>>>        Send Add_Client_File  Cmoves.File_Number
38340>>>>>>>>>        Send Add_Client_File  Particle.File_Number
38341>>>>>>>>>        Send Add_Client_File  Cmovesa.File_Number
38342>>>>>>>>>        Send Add_Client_File  Cn.File_Number
38343>>>>>>>>>        Send Add_Client_File  Particll.File_Number
38344>>>>>>>>>        Send Add_Client_File  Clnbank.File_Number
38345>>>>>>>>>        Send Add_Client_File  Tpclient.File_Number
38346>>>>>>>>>        Send Add_Client_File  Clorder.File_Number
38347>>>>>>>>>        Send Add_Client_File  Clitem.File_Number
38348>>>>>>>>>
38348>>>>>>>>>        // Parent (Server) file structure...............
38348>>>>>>>>>        Send Add_Server_File  Cities.File_Number
38349>>>>>>>>>        Send Add_Server_File  Areas.File_Number
38350>>>>>>>>>        Send Add_Server_File  Payresp.File_Number
38351>>>>>>>>>
38351>>>>>>>>>        // External (System) file structure.............
38351>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
38352>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
38353>>>>>>>>>        Send Add_System_File  Ptypparl.File_Number  DD_LOCK_ON_ALL
38354>>>>>>>>>
38354>>>>>>>>>        Define_Auto_Increment  Sysrecc.Client_Rec0  To Clients.Client_Rec0
38357>>>>>>>>>
38357>>>>>>>>>        // Field-based properties.......................
38357>>>>>>>>>
38357>>>>>>>>>        // Clients.Company_Code
38357>>>>>>>>>
38357>>>>>>>>>        // Clients.Branch_Code
38357>>>>>>>>>
38357>>>>>>>>>        // Clients.Year_Year
38357>>>>>>>>>
38357>>>>>>>>>        // Clients.Custprom_Code
38357>>>>>>>>>
38357>>>>>>>>>        // Clients.Client_Id
38357>>>>>>>>>        Set Field_Options          Field Clients.Client_Id To DD_AUTOFIND    DD_NOPUT      
38358>>>>>>>>>        Set Field_Prompt_Object    Field Clients.Client_Id To (sl100(Self))
38359>>>>>>>>>        Set Key_Field_State        Field Clients.Client_Id To TRUE
38360>>>>>>>>>
38360>>>>>>>>>        // Clients.Client_Name
38360>>>>>>>>>        Set Field_Prompt_Object    Field Clients.Client_Name To (sl100(Self))
38361>>>>>>>>>
38361>>>>>>>>>        // Clients.Client_Afm
38361>>>>>>>>>        Set Field_Options          Field Clients.Client_Afm To DD_AUTOFIND   
38362>>>>>>>>>
38362>>>>>>>>>        // Clients.Client_Rec0
38362>>>>>>>>>        Set Field_Options          Field Clients.Client_Rec0 To DD_AUTOFIND   
38363>>>>>>>>>
38363>>>>>>>>>        // Clients.Custprom_Recr
38363>>>>>>>>>
38363>>>>>>>>>        // Clients.Client_Recr
38363>>>>>>>>>        Set Field_Options          Field Clients.Client_Recr To DD_AUTOFIND   
38364>>>>>>>>>
38364>>>>>>>>>        // Clients.Last_Xreosh
38364>>>>>>>>>
38364>>>>>>>>>        // Clients.Last_Pistosh
38364>>>>>>>>>
38364>>>>>>>>>        // Clients.Last_Order
38364>>>>>>>>>        Set Field_Class_Name       Field Clients.Last_Order To "dbComboFormSub"
38365>>>>>>>>>
38365>>>>>>>>>        // Clients.Client_Doy
38365>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Doy To (Clients_Client_Doy_VT(Self))
38366>>>>>>>>>
38366>>>>>>>>>        // Clients.Client_Address
38366>>>>>>>>>
38366>>>>>>>>>        // Clients.Client_City_Id
38366>>>>>>>>>
38366>>>>>>>>>        // Clients.Client_Area
38366>>>>>>>>>
38366>>>>>>>>>        // Clients.Client_Job
38366>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Job To (Clients_Client_Job_VT(Self))
38367>>>>>>>>>
38367>>>>>>>>>        // Clients.Client_Respons
38367>>>>>>>>>
38367>>>>>>>>>        // Clients.Client_Zipcode
38367>>>>>>>>>
38367>>>>>>>>>        // Clients.Client_Phone
38367>>>>>>>>>
38367>>>>>>>>>        // Clients.Client_Fax
38367>>>>>>>>>
38367>>>>>>>>>        // Clients.Client_Mobile
38367>>>>>>>>>
38367>>>>>>>>>        // Clients.Client_Aoh
38367>>>>>>>>>
38367>>>>>>>>>        // Clients.Client_Email
38367>>>>>>>>>
38367>>>>>>>>>        // Clients.Client_Class
38367>>>>>>>>>
38367>>>>>>>>>        // Clients.Client_Details
38367>>>>>>>>>
38367>>>>>>>>>        // Clients.Client_Sitew
38367>>>>>>>>>
38367>>>>>>>>>        // Clients.Client_Codem
38367>>>>>>>>>
38367>>>>>>>>>        // Clients.Client_Categfpa
38367>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Categfpa To (Clients_Client_Categfpa_VT(Self))
38368>>>>>>>>>
38368>>>>>>>>>        // Clients.Client_Fpa
38368>>>>>>>>>
38368>>>>>>>>>        // Clients.Client_Public
38368>>>>>>>>>
38368>>>>>>>>>        // Clients.Client_Sn
38368>>>>>>>>>
38368>>>>>>>>>        // Clients.Client_Repm
38368>>>>>>>>>
38368>>>>>>>>>        // Clients.Client_Active
38368>>>>>>>>>
38368>>>>>>>>>        // Clients.Client_Reported
38368>>>>>>>>>
38368>>>>>>>>>        // Clients.Client_Pelprom
38368>>>>>>>>>
38368>>>>>>>>>        // Clients.Client_Lastupd
38368>>>>>>>>>
38368>>>>>>>>>        // Clients.Client_Markexp
38368>>>>>>>>>
38368>>>>>>>>>        // Clients.Client_Catjob
38368>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Catjob To (Clients_Client_Catjob_VT1(Self))
38369>>>>>>>>>
38369>>>>>>>>>        // Clients.Is_Promhtheyths
38369>>>>>>>>>
38369>>>>>>>>>        // Clients.Xreosh
38369>>>>>>>>>
38369>>>>>>>>>        // Clients.Pistosh
38369>>>>>>>>>
38369>>>>>>>>>        // Clients.Ypoloipo
38369>>>>>>>>>
38369>>>>>>>>>        // Clients.Plafon
38369>>>>>>>>>
38369>>>>>>>>>        // Clients.Overhead
38369>>>>>>>>>
38369>>>>>>>>>        // Clients.Client_Company
38369>>>>>>>>>
38369>>>>>>>>>        // Clients.Client_Repmatch
38369>>>>>>>>>
38369>>>>>>>>>        // Clients.Client_Hmnia
38369>>>>>>>>>
38369>>>>>>>>>        // Clients.Client_Presp
38369>>>>>>>>>
38369>>>>>>>>>        // Clients.Client_Locked
38369>>>>>>>>>
38369>>>>>>>>>        // Clients.Synolikh_Ofeilh
38369>>>>>>>>>
38369>>>>>>>>>        // Clients.Client_Idiot
38369>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Idiot To (Clients_Client_Idiot_VT(Self))
38370>>>>>>>>>
38370>>>>>>>>>        // Clients.Client_Add_No
38370>>>>>>>>>
38370>>>>>>>>>        // Clients.Client_Nomos
38370>>>>>>>>>
38370>>>>>>>>>        // Clients.Client_Xora
38370>>>>>>>>>
38370>>>>>>>>>        // Clients.Polh_Recr
38370>>>>>>>>>
38370>>>>>>>>>        // Clients.Presp_Id
38370>>>>>>>>>
38370>>>>>>>>>        // Clients.Sum_Pct_Tpcl
38370>>>>>>>>>
38370>>>>>>>>>        // Clients.Is_Client
38370>>>>>>>>>
38370>>>>>>>>>        // Clients.Sysxetish
38370>>>>>>>>>
38370>>>>>>>>>        // Clients.Poso_Se_Apait
38370>>>>>>>>>
38370>>>>>>>>>        // Clients.Client_Glcode
38370>>>>>>>>>
38370>>>>>>>>>        // Clients.Is_Eksoter
38370>>>>>>>>>
38370>>>>>>>>>        // Clients.Is_Xondr
38370>>>>>>>>>
38370>>>>>>>>>        // Clients.Orio_Syn_Ofeilh
38370>>>>>>>>>
38370>>>>>>>>>        // Clients.Posa_Apo_Dap
38370>>>>>>>>>
38370>>>>>>>>>        // Clients.Client_Doybtm
38370>>>>>>>>>
38370>>>>>>>>>        // Clients.Posa_Apo_Parag
38370>>>>>>>>>
38370>>>>>>>>>        // Clients.Client_Ptyppar
38370>>>>>>>>>
38370>>>>>>>>>        // Clients.Client_Seira
38370>>>>>>>>>
38370>>>>>>>>>        // Clients.Hpso
38370>>>>>>>>>
38370>>>>>>>>>        // Clients.Hpal
38370>>>>>>>>>
38370>>>>>>>>>        // Clients.Feregios
38370>>>>>>>>>        Set Field_Value_Table      Field Clients.Feregios To (Clients_Feregios_VT(Self))
38371>>>>>>>>>
38371>>>>>>>>>        // Clients.Diakin
38371>>>>>>>>>
38371>>>>>>>>>        // Clients.Status
38371>>>>>>>>>
38371>>>>>>>>>        // Clients.Anal
38371>>>>>>>>>
38371>>>>>>>>>        // Clients.Endoomil
38371>>>>>>>>>
38371>>>>>>>>>        // Clients.Npdd
38371>>>>>>>>>
38371>>>>>>>>>        // Clients.Sap_Hmnia
38371>>>>>>>>>
38371>>>>>>>>>        //DDB-DefineFieldEnd
38371>>>>>>>>>    End_Procedure    // Define_Fields
38372>>>>>>>>>
38372>>>>>>>>>    // Field_Defaults:
38372>>>>>>>>>    // This procedure is used to establish default field values.
38372>>>>>>>>>
38372>>>>>>>>>    Procedure Field_Defaults
38373>>>>>>>>>        Forward Send Field_Defaults
38375>>>>>>>>>        //DDB-Generated-Code-Location
38375>>>>>>>>>        //DDB-FieldDefaultStart
38375>>>>>>>>>        Set Field_Changed_Value   Field Clients.Client_Doy To "0"
38376>>>>>>>>>        //DDB-FieldDefaultEnd
38376>>>>>>>>>    End_Procedure    // Field_Defaults
38377>>>>>>>>>
38377>>>>>>>>>End_Class    // Clients_DataDictionary
38378>>>>>>>>>//DDB-Selection-pkg-Start
38378>>>>>>>>>
38378>>>>>>>>>Use sl100.SL         // sl100
38378>>>>>>>>>
38378>>>>>>>>>//DDB-Selection-pkg-End
38378>>>>>>>>>//DDB-FileEnd
38378>>>>>>>    
38378>>>>>>>    //AB-IgnoreEnd
38378>>>>>>>
38378>>>>>>>    Object sl100 is a dbModalPanelSub
38380>>>>>>>
38380>>>>>>>        //AB-StoreTopStart
38380>>>>>>>        
38380>>>>>>>        Property String     FragmaClient        Public ''
38382>>>>>>>        Property String     psIsPromhtheyths    Public ''
38384>>>>>>>        Property Integer    piMustConstrain     Public  0
38386>>>>>>>        Property String     psModule            Public ''
38388>>>>>>>        
38388>>>>>>>        //AB-StoreTopEnd
38388>>>>>>>
38388>>>>>>>        Set Label to "(Xlate(Label(Self)))"
38389>>>>>>>        Set Size to 252 509
38390>>>>>>>        Set Location to 4 5
38391>>>>>>>
38391>>>>>>>        //AB-DDOStart
38391>>>>>>>
38391>>>>>>>        Object Clients_DD is a Clients_DataDictionary
38393>>>>>>>
38393>>>>>>>            //AB-StoreTopStart
38393>>>>>>>                                            
38393>>>>>>>            //AB-StoreTopEnd
38393>>>>>>>
38393>>>>>>>
38393>>>>>>>            //AB-StoreStart
38393>>>>>>>                                            
38393>>>>>>>            Begin_Constraints
38395>>>>>>>                     If (psModule(Self)='01') BEGIN
38397>>>>>>>                        Constrain Clients.is_Client        Eq '1'
38399>>>>>>>                     end
38399>>>>>>>>
38399>>>>>>>                     Else If (psModule(Self)='02') begin
38402>>>>>>>                        Constrain Clients.is_Promhtheyths  Eq '1'
38404>>>>>>>                     end
38404>>>>>>>>
38404>>>>>>>            End_Constraints
38407>>>>>>>            
38407>>>>>>>            
38407>>>>>>>            
38407>>>>>>>            
38407>>>>>>>            
38407>>>>>>>            //AB-StoreEnd
38407>>>>>>>
38407>>>>>>>        End_Object    // Clients_DD
38408>>>>>>>
38408>>>>>>>        Set Main_DD to (Clients_DD(self))
38409>>>>>>>        Set Server to (Clients_DD(self))
38410>>>>>>>
38410>>>>>>>        //AB-DDOEnd
38410>>>>>>>
38410>>>>>>>        Object oSelList is a dbListSub
38412>>>>>>>            Set Main_File to Clients.File_Number
38413>>>>>>>            Set Size to 204 496
38414>>>>>>>            Set Location to 7 5
38415>>>>>>>            Set Auto_Index_State to FALSE
38416>>>>>>>
38416>>>>>>>            Begin_Row
38419>>>>>>>                Entry_Item Clients.Client_id
38420>>>>>>>                Entry_Item Clients.Client_name
38421>>>>>>>                Entry_Item Clients.Client_afm
38422>>>>>>>                Entry_Item Clients.Last_xreosh
38423>>>>>>>                Entry_Item Clients.Last_pistosh
38424>>>>>>>                Entry_Item Clients.Last_order
38425>>>>>>>                Entry_Item Clients.Is_client
38426>>>>>>>                Entry_Item Clients.Is_promhtheyths
38427>>>>>>>            End_Row
38432>>>>>>>
38432>>>>>>>            Set Form_Width    item 0 to 64
38433>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
38434>>>>>>>            
38434>>>>>>>            Set Form_Width    item 1 to 133
38435>>>>>>>            Set Header_Label  item 1 to "„§à¤¬£å˜"
38436>>>>>>>            
38436>>>>>>>            Set Form_Width    item 2 to 62
38437>>>>>>>            Set Header_Label  item 2 to "€”‹"
38438>>>>>>>            
38438>>>>>>>            Set Form_Width    item 3 to 60
38439>>>>>>>            Set Header_Label  item 3 to "’œ¢. •¨âà©ž"
38440>>>>>>>            
38440>>>>>>>            Set Form_Width    item 4 to 60
38441>>>>>>>            Set Header_Label  item 4 to "’œ¢. å©«à©ž"
38442>>>>>>>            
38442>>>>>>>            Set Form_Width    item 5 to 60
38443>>>>>>>            Set Header_Label  item 5 to "’œ¢. ˜¨˜š"
38444>>>>>>>            
38444>>>>>>>            Set Form_Width    item 6 to 26
38445>>>>>>>            Set Header_Label  item 6 to "œ¢"
38446>>>>>>>            Set Column_Checkbox_State  item 6 to True
38447>>>>>>>            
38447>>>>>>>            Set Form_Width    item 7 to 26
38448>>>>>>>            Set Header_Label  item 7 to "¨¦£"
38449>>>>>>>            Set Column_Checkbox_State  item 7 to True
38450>>>>>>>            
38450>>>>>>>
38450>>>>>>>            //AB-StoreStart
38450>>>>>>>                                                                    
38450>>>>>>>            //Property String StoreFragmaClient   Public ''
38450>>>>>>>            //Property String StorePsModule       Public ''
38450>>>>>>>            
38450>>>>>>>            //Procedure Store_Defaults
38450>>>>>>>            //    Forward Send Store_Defaults
38450>>>>>>>            //    Set StoreFragmaClient   to (FragmaClient(Self))
38450>>>>>>>            //    Set StorePsModule       to (psModule    (Self))
38450>>>>>>>            //End_Procedure
38450>>>>>>>            
38450>>>>>>>            //Procedure ReStore_Defaults
38450>>>>>>>            //    Forward Send ReStore_Defaults
38450>>>>>>>            //    Set FragmaClient to (StoreFragmaClient(Self))
38450>>>>>>>            //    Set psModule     to (StorePsModule    (Self))
38450>>>>>>>            //End_Procedure
38450>>>>>>>            
38450>>>>>>>            Set Column_Option Item 6 to NoEnter True
38451>>>>>>>            Set Column_Option Item 7 to NoEnter True
38452>>>>>>>            
38452>>>>>>>            Procedure Activating
38454>>>>>>>                Forward Send Activating
38456>>>>>>>                Set Auto_Index_State to True
38457>>>>>>>            End_Procedure
38458>>>>>>>            
38458>>>>>>>            Procedure Activate
38460>>>>>>>                Send Rebuild_Constraints    to Clients_DD
38461>>>>>>>                If (FragmaClient(Self)<>'') Begin
38463>>>>>>>                    Clear Clients
38464>>>>>>>                    Move (FragmaClient(Self)) to Clients.Client_ID
38465>>>>>>>                    Find Eq Clients By Index.6
38466>>>>>>>>
38466>>>>>>>                    If (Found) Send Request_Find to Clients_DD Eq Clients.File_Number 6
38469>>>>>>>                End
38469>>>>>>>>
38469>>>>>>>                Forward Send Activate
38471>>>>>>>            End_procedure
38472>>>>>>>            
38472>>>>>>>            
38472>>>>>>>            
38472>>>>>>>            
38472>>>>>>>            //AB-StoreEnd
38472>>>>>>>
38472>>>>>>>        End_Object    // oSelList
38473>>>>>>>
38473>>>>>>>        Object oOK_bn is a ButtonSub
38475>>>>>>>            Set Label to "&„§ ¢¦šã"
38476>>>>>>>            Set Location to 218 341
38477>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38478>>>>>>>
38478>>>>>>>            //AB-StoreStart
38478>>>>>>>            Procedure OnClick
38480>>>>>>>                Send OK To (oSelList(current_object))
38481>>>>>>>            End_Procedure
38482>>>>>>>            //AB-StoreEnd
38482>>>>>>>
38482>>>>>>>        End_Object    // oOK_bn
38483>>>>>>>
38483>>>>>>>        Object oCancel_bn is a ButtonSub
38485>>>>>>>            Set Label to "&€¡ç¨à©ž"
38486>>>>>>>            Set Location to 218 396
38487>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38488>>>>>>>
38488>>>>>>>            //AB-StoreStart
38488>>>>>>>            Procedure OnClick
38490>>>>>>>                Send Cancel To (oSelList(current_object))
38491>>>>>>>            End_Procedure
38492>>>>>>>            //AB-StoreEnd
38492>>>>>>>
38492>>>>>>>        End_Object    // oCancel_bn
38493>>>>>>>
38493>>>>>>>        Object oSearch_bn is a ButtonSub
38495>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
38496>>>>>>>            Set Location to 218 451
38497>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38498>>>>>>>
38498>>>>>>>            //AB-StoreStart
38498>>>>>>>            Procedure OnClick
38500>>>>>>>                Send Search To (oSelList(current_object))
38501>>>>>>>            End_Procedure
38502>>>>>>>            //AB-StoreEnd
38502>>>>>>>
38502>>>>>>>        End_Object    // oSearch_bn
38503>>>>>>>
38503>>>>>>>
38503>>>>>>>        //AB-StoreStart
38503>>>>>>>        
38503>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
38504>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
38505>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
38506>>>>>>>        
38506>>>>>>>        Set Modal_State to True
38507>>>>>>>        Set Locate_Mode to Center_On_Screen
38508>>>>>>>        
38508>>>>>>>        
38508>>>>>>>        Procedure Activating Returns Integer
38510>>>>>>>            Integer rVal
38511>>>>>>>            Forward Get Msg_Activating to rVal
38513>>>>>>>                 if (psmodule(self)='01') set label of sl100 to '‰˜«á¢¦š¦ª œ¢˜«é¤'
38516>>>>>>>            else if (psmodule(self)='02') set label of sl100 to '‰˜«á¢¦š¦ª ¨¦£žŸœ¬«é¤'
38520>>>>>>>            Procedure_Return rVal
38521>>>>>>>        End_procedure
38522>>>>>>>        
38522>>>>>>>        
38522>>>>>>>        
38522>>>>>>>        
38522>>>>>>>        
38522>>>>>>>        
38522>>>>>>>        
38522>>>>>>>        
38522>>>>>>>        
38522>>>>>>>        //AB-StoreEnd
38522>>>>>>>
38522>>>>>>>    End_Object    // sl100
38523>>>>>>>
38523>>>>>>>//AB/     End_Object    // prj
38523>>>>>
38523>>>>>//*********************************************************************************
38523>>>>>//*          A N A L Y S I S                                                      *
38523>>>>>//*********************************************************************************
38523>>>>>//† ¡áŸœ ¡å¤ž©ž ˜¥ ¦š¨á­à¤ ˜§¦«œ¢œå £å˜ ©¬¤˜¢¢˜šã.
38523>>>>>//„§¦£â¤àª ¦¨åœ«˜  £¦¤¦©ã£˜¤«˜ â¤˜ª ©¬¤˜¢¢˜©æ£œ¤¦ª
38523>>>>>
38523>>>>>//’é¨˜, ¦  › á­¦¨¦  «ç§¦  ©¬¤˜¢¢˜©¦£â¤à¤ §¦¬ ¬§¦©«ž¨åœ  «¦ ©ç©«ž£˜ ©ã£œ¨˜, œå¤˜ 
38523>>>>>//¦  œ¥ãª : 1  "Š¦š˜¨ ˜©£æª ‚Š : contsrained ¢å©«˜ gplan apo-eos Btypkin.Gplan_Code_Apo
38523>>>>>//                                                               Btypkin.Gplan_Code_Apo
38523>>>>>//                               ©«ž¤ §œ¨å§«à©ž ˜¬«ã, ¦ ¢¦š˜¨ ˜©£æª §¦¬ Ÿ˜ œ§ ¢œšœå
38523>>>>>//                               ©«¦ barticl, Ÿ˜ "­áœ " «ž¤ ®¨âà©ž/§å©«à©ž §¦¬ â®¦¬£œ
38523>>>>>//                               ›ž¢é©œ  ©«¦ §œ›å¦ Btypkin.Btypkin_Anti_Xp.
38523>>>>>//          2  "œ¢á«žª        : ¢å©«˜ customer
38523>>>>>//          3  "¨¦£žŸœ¬«ãª    : ¢å©«˜ vendor
38523>>>>>//          4  "Š¦ §¦å         : œá¤ «¦ modula ˜¥ ¦š¨á­à¤ §¦¬¢žŸœå ˜¬«æ¤¦£˜,
38523>>>>>//                               «æ«œ «¦¤ ©¬¤˜¢¢˜©æ£œ¤¦ ˜§¢éª «¦¤ §¢ž¡«¨¦¢¦š¦ç£œ.
38523>>>>>
38523>>>>>//† ©¬¤˜¢¢˜šã šå¤œ«˜  £œ ˜¥ æš¨˜­˜, á¨˜ §¨â§œ  ¤˜ š¤à¨å¦¬£œ œá¤ Ÿ˜ › ˜¡ ¤ã©¦¬£œ
38523>>>>>//£æ¤¦¤ 1 «ç§¦ ˜¥ ¦š¨á­à¤, ã §¦¢¢¦çª (§œ›å¦ Btypkin.Baxiokat_Code).
38523>>>>>//„á¤ ˜¬«æ œå¤˜  0, «æ«œ ©«¦ grid «¦¬ bmove ¦ user £˜ª ›ž¢é¤œ  baxiokat,
38523>>>>>//˜¢¢¦ éª «¦ §œ›å¦ œå¤˜  ¡¢œ ›à£â¤¦.
38523>>>>>
38523>>>>>Class Btypkin_DataDictionary  is a DataDictionary_Sec
38524>>>>>
38524>>>>>    Procedure Construct_Object
38525>>>>>              Forward Send Construct_Object
38527>>>>>
38527>>>>>              //object id «é¤ ddo servers š ˜ «á barticl+bmove+baxio+baxiokat
38527>>>>>              //©œ«á¨¦¤«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
38527>>>>>              //®¨ž© £œç¦¬¤ ©«ž¤ private.exit_btypkin_code
38527>>>>>              //š ˜ ¤˜ ©œ«á¨¦¬¤ «¦ visual interface
38527>>>>>              Property Integer piBarticl_dd  0
38528>>>>>              Property Integer piBmove_dd    0
38529>>>>>              Property Integer piBaxio_dd    0
38530>>>>>              Property Integer piBaxiokat_dd 0
38531>>>>>              Property Integer piMustNOTConstrain Public 0
38532>>>>>    End_Procedure   //construct_object
38533>>>>>
38533>>>>>//      //private
38533>>>>>//      //¡˜¢œå«˜  ˜§¦ «ž¤ private.Exit_Btypkin_Code
38533>>>>>//      Procedure private.Set_Prompt_Objects_of_all_Connected_DEOs Integer liPrompt_Object_id ;
38533>>>>>//                                                                 Integer liField            ;
38533>>>>>//                                                                 Integer iMustConstrain     ;
38533>>>>>//                                                                 String  sPelProm
38533>>>>>//                Integer iMax iCount iDEO liTemp liBarticl_dd iPelListID
38533>>>>>
38533>>>>>//                Move (sl100(Self)) to iPelListID
38533>>>>>//             //   den exei nohma giati den kanoyn tipota sthn lista
38533>>>>>//             //   If (iPelListID) Set piMustConstrain     Of iPelListID to 0
38533>>>>>//             //   If (iPelListID) Set psIsPromhtheyths    Of iPelListID to ''
38533>>>>>
38533>>>>>//                Get piBarticl_dd to liBarticl_dd
38533>>>>>//                If (liBarticl_dd <> 0);
38533>>>>>//                Begin //œá¤ æ¤«àª ¬§á¨®œ  client ddo £œ main file «¦ barticl
38533>>>>>//                     Get Data_Set_User_Interface_Count of liBarticl_dd to iMax
38533>>>>>//                     Decrement iMax
38533>>>>>//                     For iCount from 0 to iMax
38533>>>>>//                         Move (Data_Set_User_Interface(liBarticl_dd ,iCount)) to iDEO
38533>>>>>//                         Get Data_Field of iDEO Item 0 to liTemp
38533>>>>>//                         If (liTemp = liField);
38533>>>>>//                         Begin //œá¤ ™¨ž¡˜ deo (dfform?) §¦¬ ˜¤˜­â¨œ«˜  ©«¦ §œ›å¦ ©¬¤˜¢¢˜©æ£œ¤¦ª
38533>>>>>//                            If (liPrompt_Object_id <> 0);
38533>>>>>//                               Begin
38533>>>>>//                                  Set Prompt_Object      of iDEO to liPrompt_Object_id
38533>>>>>//                                  Set Prompt_Button_Mode of iDEO to PB_promptOn
38533>>>>>//                                  If (iMustConstrain) Begin
38533>>>>>//                                  //   den exei nohma giati den kanoyn tipota sthn lista
38533>>>>>//                                  //  If (liPrompt_Object_id) Set piMustConstrain     Of liPrompt_Object_id to iMustConstrain
38533>>>>>//                                  //  If (liPrompt_Object_id) Set psIsPromhtheyths    Of liPrompt_Object_id to sPelProm
38533>>>>>//                                  End
38533>>>>>//                            End
38533>>>>>//                            Else Begin
38533>>>>>//                                Set Prompt_Object      of iDEO to 0
38533>>>>>//                                Set Prompt_Button_Mode of iDEO to PB_promptOff
38533>>>>>//                            End
38533>>>>>//                         End
38533>>>>>//                     Loop
38533>>>>>//                End
38533>>>>>//      End_Procedure //private.set_prompt_objects_of_all_connected_dEOS
38533>>>>>
38533>>>>>
38533>>>>>//    //private
38533>>>>>//    //¡˜¢œå«˜  ˜§æ: iexit «¦¬ btypkin_code
38533>>>>>//    //¡˜¢œå    «ã¤: private.Set_Prompt_Objects_of_all_Connected_DEOS
38533>>>>>//    //©œ«á¨œ      : «á prompt objects š ˜ «¦ barticl_anti, ˜¤á¢¦š˜ £œ «¦ btypkin_anti.
38533>>>>>//    Procedure private.Exit_Btypkin_Code Integer liField Integer liBtypkin_Code
38533>>>>>//              Integer liBtypkin_Anti1 liBaxiokat_Num liBtypkin_Anti2
38533>>>>>//              Integer liBaxiokat_dd liBarticl_dd
38533>>>>>//              String lsBarticlCode1
38533>>>>>
38533>>>>>//            // btypkin_anti
38533>>>>>//            // "-1" "ƒâ¤ “§á¨®œ "
38533>>>>>//            // "0"  "Data Entry"
38533>>>>>//            // "1"  "Š¦š˜¨ ˜©£é¤ ‚Š"
38533>>>>>//            // "2"  "”¦¨â˜ª"
38533>>>>>//            // "3"  "¨¦£žŸœ¬«é¤"
38533>>>>>//            // "5"  "Ž ‘¬¤˜¢¢˜©æ£œ¤¦ª"
38533>>>>>//            // "6"  "’œ¢.˜¨˜¢ã§«žª"
38533>>>>>
38533>>>>>
38533>>>>>
38533>>>>>//              Get Field_Current_Value Field Btypkin.Btypkin_Anti1 to liBtypkin_Anti1
38533>>>>>//              Get Field_Current_Value Field Btypkin.Btypkin_Anti2 to liBtypkin_Anti2
38533>>>>>//              Case Begin
38533>>>>>//                   Case (liBtypkin_Anti1 = 1) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ š¢
38533>>>>>//                         Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0 Field Barticl.Barticl_Code1 0 ''
38533>>>>>//                   Case Break
38533>>>>>
38533>>>>>//                   Case (liBtypkin_Anti1 = 2) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §œ¢á«œª
38533>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code1 1 ''
38533>>>>>//                   Case Break
38533>>>>>
38533>>>>>//                   Case (liBtypkin_Anti1 = 3) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §¨¦£žŸœ¬«âª=> ¢ ©«˜ §œ¢˜«à¤
38533>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code1 1 '1'
38533>>>>>//                   Case Break
38533>>>>>
38533>>>>>//                   Case Else //=4 ¢¦ §¦å:©¬¤˜¢¢˜©æ£œ¤¦ª £œ user manual data entry
38533>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0  Field Barticl.Barticl_Code1 0 ''
38533>>>>>//                   Case Break
38533>>>>>//              Case End
38533>>>>>
38533>>>>>//              Case Begin
38533>>>>>//                   Case (liBtypkin_Anti2 = 1) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ š¢
38533>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0 Field Barticl.Barticl_Code2 0 ''
38533>>>>>//                   Case Break
38533>>>>>
38533>>>>>//                   Case (liBtypkin_Anti2 = 2) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §œ¢á«œª
38533>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code2 1 ''
38533>>>>>//                   Case Break
38533>>>>>
38533>>>>>//                   Case (liBtypkin_Anti2 = 3) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §¨¦£žŸœ¬«âª=> Š ©«˜ œ¢˜«é¤
38533>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code2 1 '1'
38533>>>>>//                   Case Break
38533>>>>>
38533>>>>>//                   Case Else //=4 ¢¦ §¦å:©¬¤˜¢¢˜©æ£œ¤¦ª £œ user manual data entry
38533>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0  Field Barticl.Barticl_Code2 0 ''
38533>>>>>//                   Case Break
38533>>>>>//              Case End
38533>>>>>//    End_Procedure //private.exit_btypkin_code
38533>>>>>
38533>>>>>//    // New_Current_Record:
38533>>>>>
38533>>>>>//    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
38533>>>>>//        Integer liBtypkinCodeFldNum
38533>>>>>//        Forward Send New_Current_Record  iOldRec iNewRec
38533>>>>>//        Get_FieldNumber Btypkin.Btypkin_Code to liBtypkinCodeFldNum
38533>>>>>//        Send private.Exit_Btypkin_Code liBtypkinCodeFldNum Btypkin.Btypkin_Code
38533>>>>>//        // Insert Code Here
38533>>>>>//    End_Procedure   // New_Current_Record
38533>>>>>
38533>>>>>
38533>>>>>    //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
38533>>>>>    //™) ˜¤áš¤à©ž properties
38533>>>>>    //š) › ˜®œå¨ ©ž calculated §œ›åà¤
38533>>>>>    //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
38533>>>>>    //œ) œ¤ž£â¨à©ž properties after
38533>>>>>    Procedure Update
38534>>>>>
38534>>>>>              Forward Send Update
38536>>>>>
38536>>>>>              //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
38536>>>>>                Move SysCurXR.Company_Code  to Btypkin.Company_Code
38537>>>>>                Move SysCurXR.Branch_Code   to Btypkin.Branch_Code
38538>>>>>                Move SysCurXR.Year_Year     to Btypkin.Year_Year
38539>>>>>                Move SysCurXR.Year_Recr     to Btypkin.Year_Recr
38540>>>>>
38540>>>>>              //™) ˜¤áš¤à©ž properties
38540>>>>>
38540>>>>>              //š) › ˜®œå¨ ©ž calculated §œ›åà¤
38540>>>>>              //š.1:Gplan_Code_Apo1 (conditional)
38540>>>>>              //š.2:Gplan_Code_Eos1 (conditional)
38540>>>>>              If (Btypkin.Btypkin_Anti1 <> 1);              Begin //æ®  ˜§¦ šœ¤ ¡ã ¢¦š ©« ¡ã
38542>>>>>             // gts 02/12/04 oxi gia titana
38542>>>>>             //      Move "" to Btypkin.Gplan_Code_Apo1
38542>>>>>             //      Move "" to Btypkin.Gplan_Code_Eos1
38542>>>>>              End
38542>>>>>>
38542>>>>>
38542>>>>>              //š.3:Gplan_Code_Apo2 (conditional)
38542>>>>>              //š.4:Gplan_Code_Eos2 (conditional)
38542>>>>>              If (Btypkin.Btypkin_Anti2 <> 1);              Begin //æ®  ˜§¦ šœ¤ ¡ã ¢¦š ©« ¡ã
38544>>>>>                   Move "" to Btypkin.Gplan_Code_Apo2
38545>>>>>                   Move "" to Btypkin.Gplan_Code_Eos2
38546>>>>>              End
38546>>>>>>
38546>>>>>
38546>>>>>              //š.3:gtypkin_rec0 (conditional)
38546>>>>>              Case Begin
38546>>>>>                   Case (Btypkin.Gtypkin_Code <> 0) //œ¤ž£œ¨é¤œ  šœ¤ ¡ã ¢¦š ©« ¡ã
38548>>>>>//jsjsjs 24/01/2001
38548>>>>>//                         Clear Gtypkin
38548>>>>>//                         Move Btypkin.Company_Code to Gtypkin.Company_Code
38548>>>>>//                         Move Btypkin.Branch_Code  to Gtypkin.Branch_Code
38548>>>>>//                         Move Btypkin.Year_Year    to Gtypkin.Year_Year
38548>>>>>//                         Move Btypkin.Gtypkin_Code to Gtypkin.Gtypkin_Code
38548>>>>>//                         Find Eq Gtypkin by Index.1 //company_code+branch_code+year_year+gtypkin_code
38548>>>>>//                         If (Found = 1) Move Gtypkin.Gtypkin_Rec0 to Btypkin.Gtypkin_Rec0
38548>>>>>//                         Else           Send Operation_Not_Allowed 3001 //›â¤ ™¨âŸž¡œ «¦ gtypkin_rec0, please reindex
38548>>>>>//jsjsjs 24/01/2001
38548>>>>>                   Case Break
38549>>>>>                   Case Else                        //›â¤ œ¤ž£œ¨é¤œ  šœ¤ ¡ã ¢¦š ©« ¡ã
38549>>>>>                         Move 0 to Btypkin.Gtypkin_Rec0
38550>>>>>              Case End
38550>>>>>
38550>>>>>              //š.4:ctypkin_rec0 (conditional)
38550>>>>>              Case Begin
38550>>>>>                   Case (Btypkin.Ctypkin_Code <> 0) //œ¤ž£œ¨é¤œ  §œ¢á«œª
38552>>>>>                         Clear Ctypkin
INCLUDING FILE: CTYPKIN.FD
38553>>>>>                         Move Btypkin.Company_Code to Ctypkin.Company_Code
38554>>>>>                         Move Btypkin.Branch_Code  to Ctypkin.Branch_Code
38555>>>>>                         Move Btypkin.Year_Year    to Ctypkin.Year_Year
38556>>>>>                         Move Btypkin.Ctypkin_Code to Ctypkin.Ctypkin_Code
38557>>>>>                         Find Eq Ctypkin by Index.1 //company_code+branch_code+year_year+Ctypkin_code
38558>>>>>>
38558>>>>>                         If (Found = 1) Begin
38560>>>>>                            Move Ctypkin.Ctypkin_Rec0 to Btypkin.Ctypkin_Rec0
38561>>>>>                            Move Ctypkin.Ctypkin_Recr to Btypkin.Ctypkin_Recr
38562>>>>>                         End
38562>>>>>>
38562>>>>>                         Else           Send Operation_Not_Allowed 3002 //›â¤ ™¨âŸž¡œ «¦ Ctypkin_rec0, please reindex
38564>>>>>                   Case Break
38565>>>>>                   Case Else                        //›â¤ œ¤ž£œ¨é¤œ  §œ¢á«œª
38565>>>>>                         Move  0 to Btypkin.Ctypkin_Rec0
38566>>>>>                         Move '' to Btypkin.Ctypkin_Recr
38567>>>>>              Case End
38567>>>>>
38567>>>>>              //š.5:vtypkin_rec0 (conditional)
38567>>>>>              Case Begin
38567>>>>>                   Case (Btypkin.Vtypkin_Code <> 0) //œ¤ž£œ¨é¤œ  §¨¦£žŸœ¬«âª
38569>>>>>                         //Clear Vtypkin
38569>>>>>                         //Move Btypkin.Company_Code to Vtypkin.Company_Code
38569>>>>>                         //Move Btypkin.Branch_Code  to Vtypkin.Branch_Code
38569>>>>>                         //Move Btypkin.Year_Year    to Vtypkin.Year_Year
38569>>>>>                         //Move Btypkin.Vtypkin_Code to Vtypkin.Vtypkin_Code
38569>>>>>                         //Find Eq Vtypkin by Index.1 //company_code+branch_code+year_year+Vtypkin_code
38569>>>>>                         //If (Found = 1) Move Vtypkin.Vtypkin_Rec0 to Btypkin.Vtypkin_Rec0
38569>>>>>                         //Else           Send Operation_Not_Allowed 3003 //›â¤ ™¨âŸž¡œ «¦ Vtypkin_rec0, please reindex
38569>>>>>                   Case Break
38570>>>>>                   Case Else                        //›â¤ œ¤ž£œ¨é¤œ  §¨¦£žŸœ¬«âª
38570>>>>>                         Move 0 to Btypkin.Vtypkin_Rec0
38571>>>>>              Case End
38571>>>>>
38571>>>>>              //š.6:btypkin_l_hmnia (conditional)
38571>>>>>              If (Btypkin.Btypkin_L_No = 0) Move 0 to Btypkin.Btypkin_L_Hmnia
38574>>>>>
38574>>>>>
38574>>>>>              //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
38574>>>>>
38574>>>>>              //œ) œ¤ž£â¨à©ž properties after
38574>>>>>    End_Procedure //update
38575>>>>>
38575>>>>>    Procedure Creating
38576>>>>>              Forward Send Creating
38578>>>>>              //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBtypkin //˜¨ Ÿ£æª á¨Ÿ¨à¤ «žª ®¨ã©žª
38578>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Btypkin.Btypkin_Rec0)))))) to Btypkin.Btypkin_Recr
38579>>>>>    End_Procedure //creating
38580>>>>>
38580>>>>>//    Procedure OnConstrain
38580>>>>>//        Set piMustNOTConstrain to True
38580>>>>>        
38580>>>>>//        If (piMustNOTConstrain(Self)) Begin
38580>>>>>//        End
38580>>>>>//        Else Begin
38580>>>>>//            Constrain Btypkin.Company_Code  eq SysCurXR.Company_Code
38580>>>>>//            Constrain Btypkin.Branch_Code   eq SysCurXR.Branch_Code
38580>>>>>//            Constrain Btypkin.Year_Year     eq SysCurXR.Year_Year
38580>>>>>//        End
38580>>>>>//    End_Procedure
38580>>>>>
38580>>>>>
38580>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
38581>>>>>              String lsError_Message
38582>>>>>              Case Begin
38582>>>>>                   //˜§æ validate save
38582>>>>>                   Case (iError_Num = 1001)
38584>>>>>                        //Move ("DDC 141:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n† «¨¦§¦§¦åž©ž œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");
38584>>>>>                        //to lsError_Message
38584>>>>>                   Case Break
38585>>>>>                   Case (iError_Num = 1100)
38588>>>>>                        Move "DDC 141:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
38589>>>>>                        Case Break
38590>>>>>
38590>>>>>                   //˜§æ validate delete
38590>>>>>                   Case (iError_Num = 2001)
38593>>>>>                        //Clear Codemast
38593>>>>>                        //Move ("DDC 141:€›ç¤˜«ž ž › ˜š¨˜­ã !\n\n† › ˜š¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");
38593>>>>>                        //to lsError_Message
38593>>>>>                   Case Break
38594>>>>>                   Case (iError_Num = 2100)
38597>>>>>                        Move "DDC 141:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
38598>>>>>                        Case Break
38599>>>>>
38599>>>>>                   //˜§æ update
38599>>>>>                   Case (iError_Num = 3001)
38602>>>>>                        Move ("DDC 141:ƒâ¤ ™¨âŸž¡œ ž ˜¤«å©«¦ ®ž ¡å¤ž©ž «žª ‚œ¤ ¡ãª Š¦š ©« ¡ãª !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
38603>>>>>                   Case Break
38604>>>>>                   Case (iError_Num = 3002)
38607>>>>>                        Move ("DDC 141:ƒâ¤ ™¨âŸž¡œ ž ˜¤«å©«¦ ®ž ¡å¤ž©ž «é¤ œ¢˜«é¤ !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
38608>>>>>                   Case Break
38609>>>>>                   Case (iError_Num = 3003)
38612>>>>>                        Move ("DDC 141:ƒâ¤ ™¨âŸž¡œ ž ˜¤«å©«¦ ®ž ¡å¤ž©ž «é¤ ¨¦£žŸœ¬«é¤ !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
38613>>>>>                   Case Break
38614>>>>>
38614>>>>>
38614>>>>>
38614>>>>>                   Case Else
38614>>>>>                        Forward Send Operation_Not_Allowed iError_Num
38616>>>>>              Case End
38616>>>>>
38616>>>>>              Error iError_Num lsError_Message
38617>>>>>>
38617>>>>>    End_Procedure // operation_not_allowed
38618>>>>>
38618>>>>>
38618>>>>>//    //1001:
38618>>>>>//    //˜§˜š¦¨œçœ«˜  «¦ btypkin ¤˜ ˜¢¢áœ  parent year
38618>>>>>//    Function Validate_Save Returns Integer
38618>>>>>//             Integer iReturnVal
38618>>>>>
38618>>>>>//             Forward Get Validate_Save to iReturnVal
38618>>>>>
38618>>>>>//             If (Not(iReturnVal));
38618>>>>>//             Begin
38618>>>>>//                  //1100:cby = globals
38618>>>>>//                  If ( ;
38618>>>>>//                      (Not(Btypkin.Company_Code = SysCurXR.Company_Code))or ;
38618>>>>>//                      (Not(Btypkin.Branch_Code  = SysCurXR.Branch_Code)) or ;
38618>>>>>//                      (Not(Btypkin.Year_Year    = SysCurXR.Year_Year))      ;
38618>>>>>//                      )                                                   Send Operation_Not_Allowed 1100
38618>>>>>//             End //«â¢¦ª ¡é› ¡˜ validation
38618>>>>>//             Function_Return iReturnVal
38618>>>>>//    End_Function   // validate_save
38618>>>>>
38618>>>>>
38618>>>>>//    //2001:
38618>>>>>//    Function Validate_Delete  Returns Integer
38618>>>>>//             Integer iReturnVal
38618>>>>>//             Forward Get Validate_Delete  To iReturnVal
38618>>>>>//             If (Not(iReturnVal));
38618>>>>>//             Begin
38618>>>>>
38618>>>>>//                  //2100:cby = globals
38618>>>>>//                  If ( ;
38618>>>>>//                      (Not(Btypkin.Company_Code = SysCurXR.Company_Code))or ;
38618>>>>>//                      (Not(Btypkin.Branch_Code  = SysCurXR.Branch_Code)) or ;
38618>>>>>//                      (Not(Btypkin.Year_Year    = SysCurXR.Year_Year))      ;
38618>>>>>//                      )                                                   Send Operation_Not_Allowed 2100
38618>>>>>//             End //«â¢¦ª ¡é› ¡˜ validation
38618>>>>>//             Function_Return iReturnVal
38618>>>>>//    End_Function   // Validate_Delete
38618>>>>>
38618>>>>>
38618>>>>>    Procedure Define_Fields
38619>>>>>        Forward Send Define_Fields
38621>>>>>        //DDB-Generated-Code-Location
38621>>>>>        //DDB-DefineFieldStart
38621>>>>>
38621>>>>>        Set Main_File            To Btypkin.File_Number
38622>>>>>        Set Cascade_Delete_State To FALSE
38623>>>>>
38623>>>>>
38623>>>>>        // Child (Client) file structure................
38623>>>>>        Send Add_Client_File  Bflagkin.File_Number
38624>>>>>        Send Add_Client_File  Bkinkat.File_Number
38625>>>>>        Send Add_Client_File  Barticl.File_Number
38626>>>>>
38626>>>>>        // External (System) file structure.............
38626>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
38627>>>>>
38627>>>>>        Define_Auto_Increment  Sysrecb.Btypkin_Rec0  To Btypkin.Btypkin_Rec0
38630>>>>>
38630>>>>>        // Field-based properties.......................
38630>>>>>
38630>>>>>        // Btypkin.Company_Code
38630>>>>>        //DDB/ Comment_Short       Field Btypkin.Company_Code To "„¤ž£œ¨é¤œ«˜  ©«ž¤ update"
38630>>>>>
38630>>>>>        // Btypkin.Branch_Code
38630>>>>>        //DDB/ Comment_Short       Field Btypkin.Branch_Code To "„¤ž£œ¨é¤œ«˜  ©«ž¤ update"
38630>>>>>
38630>>>>>        // Btypkin.Year_Year
38630>>>>>        //DDB/ Comment_Short       Field Btypkin.Year_Year To "„¤ž£œ¨é¤œ«˜  ©«ž¤ update"
38630>>>>>
38630>>>>>        // Btypkin.Btypkin_Code
38630>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Code To (SL031(Self))
38631>>>>>
38631>>>>>        // Btypkin.Btypkin_Rec0
38631>>>>>
38631>>>>>        // Btypkin.Btypkin_Recr
38631>>>>>
38631>>>>>        // Btypkin.Year_Recr
38631>>>>>
38631>>>>>        // Btypkin.Btypkin_Descr
38631>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Descr To (SL031(Self))
38632>>>>>
38632>>>>>        // Btypkin.Gtypkin_Code
38632>>>>>
38632>>>>>        // Btypkin.Ctypkin_Code
38632>>>>>        Set Field_Prompt_Object    Field Btypkin.Ctypkin_Code To (sl007(Self))
38633>>>>>
38633>>>>>        // Btypkin.Vtypkin_Code
38633>>>>>
38633>>>>>        // Btypkin.Gtypkin_Rec0
38633>>>>>
38633>>>>>        // Btypkin.Ctypkin_Rec0
38633>>>>>
38633>>>>>        // Btypkin.Vtypkin_Rec0
38633>>>>>
38633>>>>>        // Btypkin.Btypkin_Anti1
38633>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti1 To (Bfile_VT(Self))
38634>>>>>
38634>>>>>        // Btypkin.Gplan_Code_Apo1
38634>>>>>
38634>>>>>        // Btypkin.Gplan_Code_Eos1
38634>>>>>
38634>>>>>        // Btypkin.Btypkin_Anti2
38634>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti2 To (Bfile_VT(Self))
38635>>>>>
38635>>>>>        // Btypkin.Gplan_Code_Apo2
38635>>>>>
38635>>>>>        // Btypkin.Gplan_Code_Eos2
38635>>>>>
38635>>>>>        // Btypkin.Bflagkin_Num
38635>>>>>
38635>>>>>        // Btypkin.Bkinkat_Num
38635>>>>>        //DDB/ Comment_Short       Field Btypkin.Bkinkat_Num To "“§¦¢¦šåœ«˜  ©«ž¤ update «¦¬ bkinkat."
38635>>>>>
38635>>>>>        // Btypkin.Btypkin_Anti_Xp
38635>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti_Xp To (Btypkin_Btypkin_Anti_Xp_VT(Self))
38636>>>>>
38636>>>>>        // Btypkin.Btypkin_Printer
38636>>>>>
38636>>>>>        // Btypkin.Btypkin_Pdescr
38636>>>>>
38636>>>>>        // Btypkin.Btypkin_Form
38636>>>>>
38636>>>>>        // Btypkin.Btypkin_L_No
38636>>>>>
38636>>>>>        // Btypkin.Btypkin_L_Hmnia
38636>>>>>        Set Field_Mask_Type        Field Btypkin.Btypkin_L_Hmnia To MASK_DATE_WINDOW
38637>>>>>
38637>>>>>        // Btypkin.Btypkin_Seira
38637>>>>>
38637>>>>>        // Btypkin.Btypkin_Abr
38637>>>>>
38637>>>>>        // Btypkin.Btypkin_Flag01
38637>>>>>        //DDB/ Comment_Short       Field Btypkin.Btypkin_Flag01 To "“§¦¢¦šåœ«˜  ©«ž¤ update/backout «¦¬ bflagkin."
38637>>>>>
38637>>>>>        // Btypkin.Btypkin_Flag02
38637>>>>>
38637>>>>>        // Btypkin.Btypkin_Flag03
38637>>>>>
38637>>>>>        // Btypkin.Btypkin_Flag04
38637>>>>>
38637>>>>>        // Btypkin.Btypkin_Flag05
38637>>>>>        Set Field_Checkbox_Values  Field Btypkin.Btypkin_Flag05 To "1"  "0"
38638>>>>>
38638>>>>>        // Btypkin.Btypkin_Flag06
38638>>>>>
38638>>>>>        // Btypkin.Btypkin_Flag07
38638>>>>>
38638>>>>>        // Btypkin.Btypkin_Flag08
38638>>>>>
38638>>>>>        // Btypkin.Btypkin_Flag09
38638>>>>>
38638>>>>>        // Btypkin.Btypkin_Flag10
38638>>>>>
38638>>>>>        // Btypkin.Btypkin_Flag11
38638>>>>>
38638>>>>>        // Btypkin.Btypkin_Flag12
38638>>>>>
38638>>>>>        // Btypkin.Btypkin_Flag13
38638>>>>>
38638>>>>>        // Btypkin.Btypkin_Flag14
38638>>>>>
38638>>>>>        // Btypkin.Btypkin_Flag15
38638>>>>>
38638>>>>>        // Btypkin.Btypkin_Flag16
38638>>>>>
38638>>>>>        // Btypkin.Btypkin_Flag17
38638>>>>>
38638>>>>>        // Btypkin.Btypkin_Flag18
38638>>>>>
38638>>>>>        // Btypkin.Btypkin_Flag19
38638>>>>>
38638>>>>>        // Btypkin.Btypkin_Flag20
38638>>>>>
38638>>>>>        // Btypkin.Btypkin_Sign
38638>>>>>        Set Field_Checkbox_Values  Field Btypkin.Btypkin_Sign To "1"  "-1"
38639>>>>>
38639>>>>>        // Btypkin.Ctypkin_Recr
38639>>>>>        Set Field_Prompt_Object    Field Btypkin.Ctypkin_Recr To (sl007r(Self))
38640>>>>>
38640>>>>>        // Btypkin.Label
38640>>>>>
38640>>>>>        //DDB-DefineFieldEnd
38640>>>>>
38640>>>>>        Set Main_File            To Btypkin.File_Number
38641>>>>>        Set Cascade_Delete_State To FALSE
38642>>>>>
38642>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
38643>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
38644>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38645>>>>>
38645>>>>>        // Child (Client) file structure................
38645>>>>>        Send Add_Client_File  Bflagkin.File_Number
38646>>>>>        Send Add_Client_File  Barticl.File_Number
38647>>>>>        Send Add_Client_File  Bkinkat.File_Number
38648>>>>>
38648>>>>>        // External (System) file structure.............
38648>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
38649>>>>>        //Send Add_System_File  Gtypkin.File_Number  DD_LOCK_ON_SAVE
38649>>>>>
38649>>>>>        Define_Auto_Increment  Sysrecb.Btypkin_Rec0  To Btypkin.Btypkin_Rec0
38652>>>>>
38652>>>>>        // Field-based properties.......................
38652>>>>>
38652>>>>>        // Btypkin.Company_Code
38652>>>>>
38652>>>>>        // Btypkin.Branch_Code
38652>>>>>
38652>>>>>        // Btypkin.Year_Year
38652>>>>>
38652>>>>>        // Btypkin.Btypkin_Code
38652>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Code     To "‰à› ¡æª ‰å¤ž©žª"
38653>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Code     To "‰å¤ž©ž"
38654>>>>>        Set Field_Options          Field Btypkin.Btypkin_Code     To DD_AUTOFIND    DD_REQUIRED
38655>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Code     To (sl031(Self))
38656>>>>>        Set Key_Field_State        Field Btypkin.Btypkin_Code     To TRUE
38657>>>>>
38657>>>>>        // Btypkin.Btypkin_Rec0
38657>>>>>        Set Field_Options          Field Btypkin.Btypkin_Rec0     To DD_AUTOFIND    DD_NOPUT       DD_REQUIRED
38658>>>>>        Set Key_Field_State        Field Btypkin.Btypkin_Rec0     To TRUE
38659>>>>>
38659>>>>>        // Btypkin.Year_Rec0
38659>>>>>
38659>>>>>        // Btypkin.Btypkin_Descr
38659>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Descr    To "œ¨ š¨˜­ã ‰å¤ž©žª"
38660>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Descr    To "œ¨ š¨˜­ã"
38661>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Descr    To (sl031(Self))
38662>>>>>
38662>>>>>        // Btypkin.Gtypkin_Code
38662>>>>>        Set Field_Label_Long       Field Btypkin.Gtypkin_Code     To "‰å¤ž©ž ‚Š"
38663>>>>>        Set Field_Label_Short      Field Btypkin.Gtypkin_Code     To "‰å¤ž©ž ‚Š"
38664>>>>>        //Set Field_Prompt_Object    Field Btypkin.Gtypkin_Code     To (SL055(Self))
38664>>>>>
38664>>>>>        // Btypkin.Ctypkin_Code
38664>>>>>        Set Field_Label_Long       Field Btypkin.Ctypkin_Code     To "‰å¤ž©ž œ¢˜«é¤"
38665>>>>>        Set Field_Label_Short      Field Btypkin.Ctypkin_Code     To "‰å¤ž©ž œ¢˜«é¤"
38666>>>>>
38666>>>>>        // Btypkin.Vtypkin_Code
38666>>>>>        Set Field_Label_Long       Field Btypkin.Vtypkin_Code     To "‰å¤ž©ž ¨¦£žŸœ¬«é¤"
38667>>>>>        Set Field_Label_Short      Field Btypkin.Vtypkin_Code     To "‰å¤ž©ž ¨¦£žŸœ¬«é¤"
38668>>>>>
38668>>>>>        // Btypkin.Gtypkin_Rec0
38668>>>>>        Set Field_Options          Field Btypkin.Gtypkin_Rec0     To DD_DISPLAYONLY
38669>>>>>
38669>>>>>        // Btypkin.Ctypkin_Rec0
38669>>>>>        Set Field_Options          Field Btypkin.Ctypkin_Rec0     To DD_DISPLAYONLY
38670>>>>>
38670>>>>>        // Btypkin.Vtypkin_Rec0
38670>>>>>        Set Field_Options          Field Btypkin.Vtypkin_Rec0     To DD_DISPLAYONLY
38671>>>>>
38671>>>>>        // Btypkin.Btypkin_Anti1
38671>>>>>        Set Field_Class_Name       Field Btypkin.Btypkin_Anti1    To "dbComboForm_EZ"
38672>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Anti1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª ˜§¦ ˜¨®œå¦:"
38673>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Anti1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª"
38674>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti1    To (Bfile_VT(Self))
38675>>>>>
38675>>>>>        // Btypkin.Gplan_Code_Apo1
38675>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Apo1  To "€§¦ ‰à› ¡æ ‚Š"
38676>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Apo1  To "€§¦ ‰à› ¡æ ‚Š"
38677>>>>>
38677>>>>>        // Btypkin.Gplan_Code_Eos1
38677>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Eos1  To "„àª ‰à› ¡æ ‚Š"
38678>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Eos1  To "„àª ‰à› ¡æ ‚Š"
38679>>>>>
38679>>>>>        // Btypkin.Btypkin_Anti2
38679>>>>>        Set Field_Class_Name       Field Btypkin.Btypkin_Anti2    To "dbComboForm_EZ"
38680>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Anti2    To "˜¨˜¢ã§«žª ˜§¦ ˜¨®œå¦:"
38681>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Anti2    To "˜¨˜¢ã§«žª"
38682>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti2    To (Bfile_VT(Self))
38683>>>>>
38683>>>>>        // Btypkin.Gplan_Code_Apo2
38683>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Apo2  To "€§¦ ‰à› ¡æ ‚Š"
38684>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Apo2  To "€§¦ ‰à› ¡æ ‚Š"
38685>>>>>
38685>>>>>        // Btypkin.Gplan_Code_Eos2
38685>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Eos2  To "„àª ‰à› ¡æ ‚Š"
38686>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Eos2  To "„àª ‰à› ¡æ ‚Š"
38687>>>>>
38687>>>>>        // Btypkin.Bflagkin_Num
38687>>>>>        Set Field_Label_Long       Field Btypkin.Bflagkin_Num     To "¢ãŸ¦ª Flags"
38688>>>>>        Set Field_Label_Short      Field Btypkin.Bflagkin_Num     To "¢ãŸ¦ª Flags"
38689>>>>>        Set Field_Options          Field Btypkin.Bflagkin_Num     To DD_DISPLAYONLY
38690>>>>>
38690>>>>>        // Btypkin.Bkinkat_Num
38690>>>>>        Set Field_Label_Long       Field Btypkin.Bkinkat_Num      To "¢ãŸ¦ª ‰˜«žš¦¨ é¤ €¥ é¤"
38691>>>>>        Set Field_Label_Short      Field Btypkin.Bkinkat_Num      To "¢ãŸ¦ª ‰˜«.€¥ é¤"
38692>>>>>        Set Field_Options          Field Btypkin.Bkinkat_Num      To DD_DISPLAYONLY
38693>>>>>
38693>>>>>        // Btypkin.Btypkin_Anti_Xp
38693>>>>>        Set Field_Class_Name       Field Btypkin.Btypkin_Anti_Xp  To "dbComboForm_EZ"
38694>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Anti_Xp  To "Ž ©¬¤˜¢¢˜©æ£œ¤¦ª:"
38695>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Anti_Xp  To "• ‘¬¤˜¢¢˜©¦£â¤¦¬"
38696>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti_Xp  To (Btypkin_Btypkin_Anti_Xp_VT(Self))
38697>>>>>
38697>>>>>        // Btypkin.Btypkin_Printer
38697>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Printer  To "ƒ œçŸ¬¤©ž „¡«¬§à«ã"
38698>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Printer  To "„¡«¬§à«ãª"
38699>>>>>
38699>>>>>        // Btypkin.Btypkin_Pdescr
38699>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Pdescr   To "’å«¢¦ª „¡«ç§à©žª"
38700>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Pdescr   To "’å«¢¦ª „¡«ç§à©žª"
38701>>>>>
38701>>>>>        // Btypkin.Btypkin_Form
38701>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Form     To "”æ¨£˜ „¡«ç§à©žª"
38702>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Form     To "”æ¨£˜"
38703>>>>>
38703>>>>>        // Btypkin.Btypkin_L_No
38703>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_L_No     To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª"
38704>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_L_No     To "’œ¢.€¨."
38705>>>>>        //Set Field_Options          Field Btypkin.Btypkin_L_No     To DD_DISPLAYONLY
38705>>>>>
38705>>>>>        // Btypkin.Btypkin_L_Hmnia
38705>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_L_Hmnia  To "’œ¢œ¬«˜å˜ †£/¤å˜"
38706>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_L_Hmnia  To "’œ¢.†£/¤å˜"
38707>>>>>        Set Field_Options          Field Btypkin.Btypkin_L_Hmnia  To DD_DISPLAYONLY
38708>>>>>
38708>>>>>        // Btypkin.Btypkin_Seira
38708>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Seira    To "‘œ ¨á"
38709>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Seira    To "‘œ ¨á"
38710>>>>>
38710>>>>>        // Btypkin.Btypkin_Abr
38710>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Abr      To "‘¬¤«¦£¦š¨˜­å˜"
38711>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Abr      To "‘¬¤«/­å˜"
38712>>>>>
38712>>>>>        // Btypkin.Btypkin_Flag01
38712>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag01   To DD_DISPLAYONLY
38713>>>>>
38713>>>>>        // Btypkin.Btypkin_Flag02
38713>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag02   To DD_DISPLAYONLY
38714>>>>>
38714>>>>>        // Btypkin.Btypkin_Flag03
38714>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag03   To DD_DISPLAYONLY
38715>>>>>
38715>>>>>        // Btypkin.Btypkin_Flag04
38715>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag04   To DD_DISPLAYONLY
38716>>>>>
38716>>>>>        // Btypkin.Btypkin_Flag05
38716>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag05   To DD_DISPLAYONLY
38717>>>>>
38717>>>>>        // Btypkin.Btypkin_Flag06
38717>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag06   To DD_DISPLAYONLY
38718>>>>>
38718>>>>>        // Btypkin.Btypkin_Flag07
38718>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag07   To DD_DISPLAYONLY
38719>>>>>
38719>>>>>        // Btypkin.Btypkin_Flag08
38719>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag08   To DD_DISPLAYONLY
38720>>>>>
38720>>>>>        // Btypkin.Btypkin_Flag09
38720>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag09   To DD_DISPLAYONLY
38721>>>>>
38721>>>>>        // Btypkin.Btypkin_Flag10
38721>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag10   To DD_DISPLAYONLY
38722>>>>>
38722>>>>>        // Btypkin.Btypkin_Flag11
38722>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag11   To DD_DISPLAYONLY
38723>>>>>
38723>>>>>        // Btypkin.Btypkin_Flag12
38723>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag12   To DD_DISPLAYONLY
38724>>>>>
38724>>>>>        // Btypkin.Btypkin_Flag13
38724>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag13   To DD_DISPLAYONLY
38725>>>>>
38725>>>>>        // Btypkin.Btypkin_Flag14
38725>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag14   To DD_DISPLAYONLY
38726>>>>>
38726>>>>>        // Btypkin.Btypkin_Flag15
38726>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag15   To DD_DISPLAYONLY
38727>>>>>
38727>>>>>        // Btypkin.Btypkin_Flag16
38727>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag16   To DD_DISPLAYONLY
38728>>>>>
38728>>>>>        // Btypkin.Btypkin_Flag17
38728>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag17   To DD_DISPLAYONLY
38729>>>>>
38729>>>>>        // Btypkin.Btypkin_Flag18
38729>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag18   To DD_DISPLAYONLY
38730>>>>>
38730>>>>>        // Btypkin.Btypkin_Flag19
38730>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag19   To DD_DISPLAYONLY
38731>>>>>
38731>>>>>        // Btypkin.Btypkin_Flag20
38731>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag20   To DD_DISPLAYONLY
38732>>>>>
38732>>>>>    End_Procedure    // Define_Fields
38733>>>>>
38733>>>>>
38733>>>>>
38733>>>>>    // Field_Defaults:
38733>>>>>    // This procedure is used to establish default field values.
38733>>>>>
38733>>>>>    Procedure Field_Defaults
38734>>>>>        Forward Send Field_Defaults
38736>>>>>        //DDB-Generated-Code-Location
38736>>>>>        //DDB-FieldDefaultStart
38736>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Anti1 To 0
38737>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Anti2 To 0
38738>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Anti_Xp To 1
38739>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Flag05 To 0
38740>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Sign To 1
38741>>>>>        //DDB-FieldDefaultEnd
38741>>>>>    End_Procedure    // Field_Defaults
38742>>>>>End_Class    // Btypkin_DataDictionary
38743>>>>>//DDB-Selection-pkg-Start
38743>>>>>
38743>>>>>Use SL031.SL         // SL031
INCLUDING FILE: SL031.SL
38743>>>>>>>//AB/ Project SL031:BTYPKIN
38743>>>>>>>//AB/     Object prj is a Lookup_Project
38743>>>>>>>//AB/         Set ProjectName to "SL031:BTYPKIN"
38743>>>>>>>//AB/         Set ProjectFileName to "SL031.SL"
38743>>>>>>>
38743>>>>>>>// Project Object Structure
38743>>>>>>>//   SL031 is a dbModalPanelSub
38743>>>>>>>//     Btypkin_DD is a DataDictionary
38743>>>>>>>//     oSelList is a dbListSub
38743>>>>>>>//     oOK_bn is a ButtonSub
38743>>>>>>>//     oCancel_bn is a ButtonSub
38743>>>>>>>//     oSearch_bn is a ButtonSub
38743>>>>>>>
38743>>>>>>>// Register all objects
38743>>>>>>>Register_Object Btypkin_DD
38743>>>>>>>Register_Object oCancel_bn
38743>>>>>>>Register_Object oOK_bn
38743>>>>>>>Register_Object oSearch_bn
38743>>>>>>>Register_Object oSelList
38743>>>>>>>Register_Object SL031
38743>>>>>>>
38743>>>>>>>
38743>>>>>>>    //AB-IgnoreStart
38743>>>>>>>
38743>>>>>>>    Use DFAllEnt.pkg
38743>>>>>>>    Use dbList.Sub
38743>>>>>>>    Use Button.Sub
38743>>>>>>>
38743>>>>>>>
38743>>>>>>>    Use BTYPKIN.DD
38743>>>>>>>    
38743>>>>>>>    //AB-IgnoreEnd
38743>>>>>>>
38743>>>>>>>    CD_Popup_Object SL031 is a dbModalPanelSub
38762>>>>>>>        set label to "‰ ¤ã©œ ª  €¥ ¦š¨á­à¤" 
38763>>>>>>>        Set Size to 213 506
38764>>>>>>>        Set Location to 4 5
38765>>>>>>>        Set Exit_Application_Local_State to FALSE
38766>>>>>>>        Set Modal_State to FALSE
38767>>>>>>>
38767>>>>>>>        //AB-DDOStart
38767>>>>>>>
38767>>>>>>>        Object Btypkin_DD is a Btypkin_DataDictionary
38769>>>>>>>        End_Object    // Btypkin_DD
38770>>>>>>>
38770>>>>>>>        Set Main_DD to (Btypkin_DD(self))
38771>>>>>>>        Set Server to (Btypkin_DD(self))
38772>>>>>>>
38772>>>>>>>        //AB-DDOEnd
38772>>>>>>>
38772>>>>>>>        Object oSelList is a dbListSub
38774>>>>>>>            Set Main_File to Btypkin.File_Number
38775>>>>>>>            Set Size to 173 491
38776>>>>>>>            Set Location to 3 6
38777>>>>>>>
38777>>>>>>>            Begin_Row
38780>>>>>>>                Entry_Item Btypkin.Btypkin_code
38781>>>>>>>                Entry_Item Btypkin.Btypkin_descr
38782>>>>>>>                Entry_Item Btypkin.Gtypkin_code
38783>>>>>>>                Entry_Item Btypkin.Ctypkin_code
38784>>>>>>>                Entry_Item Btypkin.Vtypkin_code
38785>>>>>>>                Entry_Item Btypkin.Btypkin_anti_xp
38786>>>>>>>            End_Row
38791>>>>>>>
38791>>>>>>>            Set Form_Width    item 0 to 39
38792>>>>>>>            set header_label  item 0 to "‰å¤ž©ž" 
38793>>>>>>>            
38793>>>>>>>            Set Form_Width    item 1 to 186
38794>>>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
38795>>>>>>>            
38795>>>>>>>            Set Form_Width    item 2 to 57
38796>>>>>>>            set header_label  item 2 to "‰å¤ž©ž ‚Š" 
38797>>>>>>>            
38797>>>>>>>            Set Form_Width    item 3 to 69
38798>>>>>>>            set header_label  item 3 to "‰ ¤ã©œ ª œ¢˜«é¤        " 
38799>>>>>>>            
38799>>>>>>>            Set Form_Width    item 4 to 59
38800>>>>>>>            set header_label  item 4 to "‰å¤ž©ž ¨¦£." 
38801>>>>>>>            
38801>>>>>>>            Set Form_Width    item 5 to 71
38802>>>>>>>            set header_label  item 5 to "• ‘¬¤˜¢¢˜©¦£." 
38803>>>>>>>            
38803>>>>>>>        End_Object    // oSelList
38804>>>>>>>
38804>>>>>>>        Object oOK_bn is a ButtonSub
38806>>>>>>>            set label to "&„§ ¢¦šã" 
38807>>>>>>>            Set Location to 177 337
38808>>>>>>>
38808>>>>>>>            //AB-StoreStart
38808>>>>>>>            Procedure OnClick
38810>>>>>>>                Send OK To oSelList
38811>>>>>>>            End_Procedure
38812>>>>>>>            //AB-StoreEnd
38812>>>>>>>
38812>>>>>>>        End_Object    // oOK_bn
38813>>>>>>>
38813>>>>>>>        Object oCancel_bn is a ButtonSub
38815>>>>>>>            set label to "&€¡ç¨à©ž" 
38816>>>>>>>            Set Location to 177 393
38817>>>>>>>
38817>>>>>>>            //AB-StoreStart
38817>>>>>>>            Procedure OnClick
38819>>>>>>>                Send Cancel To oSelList
38820>>>>>>>            End_Procedure
38821>>>>>>>            //AB-StoreEnd
38821>>>>>>>
38821>>>>>>>        End_Object    // oCancel_bn
38822>>>>>>>
38822>>>>>>>        Object oSearch_bn is a ButtonSub
38824>>>>>>>            set label to "€&¤˜ã«ž©ž" 
38825>>>>>>>            Set Location to 177 447
38826>>>>>>>
38826>>>>>>>            //AB-StoreStart
38826>>>>>>>            Procedure OnClick
38828>>>>>>>                Send Search To oSelList
38829>>>>>>>            End_Procedure
38830>>>>>>>            //AB-StoreEnd
38830>>>>>>>
38830>>>>>>>        End_Object    // oSearch_bn
38831>>>>>>>
38831>>>>>>>
38831>>>>>>>        //AB-StoreStart
38831>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
38832>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
38833>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
38834>>>>>>>        
38834>>>>>>>        //AB-StoreEnd
38834>>>>>>>
38834>>>>>>>    CD_End_Object    // SL031
38836>>>>>>>>
38836>>>>>>>
38836>>>>>>>//AB/     End_Object    // prj
38836>>>>>Use sl007.SL         // sl007
INCLUDING FILE: SL007.SL
38836>>>>>>>//AB/ Project Ctypkin : sl007
38836>>>>>>>//AB/ Object prj is a Lookup_Project
38836>>>>>>>//AB/     Set ProjectName to "Ctypkin : sl007"
38836>>>>>>>//AB/     Set ProjectFileName to "sl007.SL"
38836>>>>>>>//AB/     Set GenerateFileName to "NONAME"
38836>>>>>>>
38836>>>>>>>// Project Object Structure
38836>>>>>>>//   sl007 is a dbModalPanelSub
38836>>>>>>>//     Ctypkin_DD is a DataDictionary
38836>>>>>>>//     oSelList is a dbListSub
38836>>>>>>>//     oOK_bn is a ButtonSub
38836>>>>>>>//     oCancel_bn is a ButtonSub
38836>>>>>>>//     oSearch_bn is a ButtonSub
38836>>>>>>>
38836>>>>>>>// Register all objects
38836>>>>>>>Register_Object Ctypkin_DD
38836>>>>>>>Register_Object oCancel_bn
38836>>>>>>>Register_Object oOK_bn
38836>>>>>>>Register_Object oSearch_bn
38836>>>>>>>Register_Object oSelList
38836>>>>>>>Register_Object sl007
38836>>>>>>>
38836>>>>>>>
38836>>>>>>>//AB-IgnoreStart
38836>>>>>>>
38836>>>>>>>Use DFAllEnt.pkg
38836>>>>>>>Use dbList.Sub
38836>>>>>>>Use Button.Sub
38836>>>>>>>
38836>>>>>>>
38836>>>>>>>Use CTYPKIN.DD
INCLUDING FILE: CTYPKIN.DD
38836>>>>>>>>>//DDB-FileStart
38836>>>>>>>>>//DDB-HeaderStart
38836>>>>>>>>>
38836>>>>>>>>>// File Name : CTYPKIN.DD
38836>>>>>>>>>// Class Name: Ctypkin_DataDictionary
38836>>>>>>>>>// Revision  : 70
38836>>>>>>>>>// Version   : 2
38836>>>>>>>>>
38836>>>>>>>>>Use  Windows           // Basic Definitions
38836>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
38836>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38836>>>>>>>>>
38836>>>>>>>>>Open Ctypkin
38838>>>>>>>>>Open Cmoves
38840>>>>>>>>>Open Cflagkin
INCLUDING FILE: CFLAGKIN.FD
38842>>>>>>>>>Open Ptypparl
38844>>>>>>>>>Open Ptyppar
INCLUDING FILE: PTYPPAR.FD
38846>>>>>>>>>Open Hmctyp
INCLUDING FILE: HMCTYP.FD
38848>>>>>>>>>Open Cmovesa
38850>>>>>>>>>Open Sysrecc
38852>>>>>>>>>Open Syscurxr
38854>>>>>>>>>
38854>>>>>>>>>//DDB-HeaderEnd
38854>>>>>>>>>//DDB-ValidationStart
38854>>>>>>>>>
38854>>>>>>>>>Register_Object Ctypkin_Ctypkin_Module_VT
38854>>>>>>>>>
38854>>>>>>>>>Object Ctypkin_Ctypkin_Module_VT  is a CodeValidationTable
38856>>>>>>>>>    Set Type_Value        To "MODULE"
38857>>>>>>>>>    //DDB-ValidationCustomStart
38857>>>>>>>>>    //DDB-ValidationCustomEnd
38857>>>>>>>>>End_Object   // Ctypkin_Ctypkin_Module_VT
38858>>>>>>>>>//DDB-ValidationEnd
38858>>>>>>>>>//DDB-SelectionStart
38858>>>>>>>>>//DDB/ ExternalSelectionList sl007  sl007.SL
38858>>>>>>>>>Register_Object sl007
38858>>>>>>>>>//DDB-SelectionEnd
38858>>>>>>>>>
38858>>>>>>>>>Class Ctypkin_DataDictionary  is a DataDictionary
38859>>>>>>>>>         
38859>>>>>>>>>    Procedure Construct_Object
38860>>>>>>>>>        Forward Send Construct_Object
38862>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
38863>>>>>>>>>    End_Procedure
38864>>>>>>>>>
38864>>>>>>>>>    Procedure Save_Main_File
38865>>>>>>>>>        If (Operation_Origin<>Self) Begin
38867>>>>>>>>>            If Ctypkin.Recnum Eq 0 Procedure_Return
38870>>>>>>>>>        End
38870>>>>>>>>>>
38870>>>>>>>>>        Forward Send Save_Main_File
38872>>>>>>>>>    End_Procedure
38873>>>>>>>>>
38873>>>>>>>>>     Procedure Creating
38874>>>>>>>>>        Forward Send Creating
38876>>>>>>>>>        // Insert Code Here
38876>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Ctypkin.Ctypkin_Rec0)))))) to Ctypkin.Ctypkin_Recr
38877>>>>>>>>>    End_Procedure   // Creating
38878>>>>>>>>>
38878>>>>>>>>>
38878>>>>>>>>>    // Define_Fields:
38878>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
38878>>>>>>>>>
38878>>>>>>>>>    Procedure Define_Fields
38879>>>>>>>>>        Forward Send Define_Fields
38881>>>>>>>>>        //DDB-Generated-Code-Location
38881>>>>>>>>>        //DDB-DefineFieldStart
38881>>>>>>>>>
38881>>>>>>>>>        Set Main_File            To Ctypkin.File_Number
38882>>>>>>>>>        Set Cascade_Delete_State To FALSE
38883>>>>>>>>>
38883>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
38884>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
38885>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38886>>>>>>>>>
38886>>>>>>>>>        // Child (Client) file structure................
38886>>>>>>>>>        Send Add_Client_File  Cmoves.File_Number
38887>>>>>>>>>        Send Add_Client_File  Cflagkin.File_Number
38888>>>>>>>>>        Send Add_Client_File  Ptypparl.File_Number
38889>>>>>>>>>        Send Add_Client_File  Ptyppar.File_Number
38890>>>>>>>>>        Send Add_Client_File  Hmctyp.File_Number
38891>>>>>>>>>        Send Add_Client_File  Cmovesa.File_Number
38892>>>>>>>>>
38892>>>>>>>>>        // External (System) file structure.............
38892>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
38893>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
38894>>>>>>>>>
38894>>>>>>>>>        Define_Auto_Increment  Sysrecc.Ctypkin_Rec0  To Ctypkin.Ctypkin_Rec0
38897>>>>>>>>>
38897>>>>>>>>>        // Field-based properties.......................
38897>>>>>>>>>
38897>>>>>>>>>        // Ctypkin.Company_Code
38897>>>>>>>>>
38897>>>>>>>>>        // Ctypkin.Branch_Code
38897>>>>>>>>>
38897>>>>>>>>>        // Ctypkin.Year_Year
38897>>>>>>>>>
38897>>>>>>>>>        // Ctypkin.Ctypkin_Code
38897>>>>>>>>>        Set Field_Options          Field Ctypkin.Ctypkin_Code To DD_AUTOFIND   
38898>>>>>>>>>        Set Field_Prompt_Object    Field Ctypkin.Ctypkin_Code To (sl007(Self))
38899>>>>>>>>>        Set Key_Field_State        Field Ctypkin.Ctypkin_Code To TRUE
38900>>>>>>>>>
38900>>>>>>>>>        // Ctypkin.Ctypkin_Rec0
38900>>>>>>>>>
38900>>>>>>>>>        // Ctypkin.Ctypkin_Recr
38900>>>>>>>>>
38900>>>>>>>>>        // Ctypkin.Year_Recr
38900>>>>>>>>>
38900>>>>>>>>>        // Ctypkin.Ctypkin_Descr
38900>>>>>>>>>        Set Field_Prompt_Object    Field Ctypkin.Ctypkin_Descr To (sl007(Self))
38901>>>>>>>>>
38901>>>>>>>>>        // Ctypkin.Ctypkin_Anti
38901>>>>>>>>>
38901>>>>>>>>>        // Ctypkin.Ctypkin_Flags
38901>>>>>>>>>
38901>>>>>>>>>        // Ctypkin.Ctypkin_Module
38901>>>>>>>>>        Set Field_Value_Table      Field Ctypkin.Ctypkin_Module To (Ctypkin_Ctypkin_Module_VT(Self))
38902>>>>>>>>>
38902>>>>>>>>>        // Ctypkin.Open_Item
38902>>>>>>>>>
38902>>>>>>>>>        // Ctypkin.Check_Overhead
38902>>>>>>>>>
38902>>>>>>>>>        // Ctypkin.Max_Days_Sx_Par
38902>>>>>>>>>
38902>>>>>>>>>        // Ctypkin.Singular
38902>>>>>>>>>
38902>>>>>>>>>        // Ctypkin.Sub
38902>>>>>>>>>
38902>>>>>>>>>        // Ctypkin.Subreport
38902>>>>>>>>>
38902>>>>>>>>>        //DDB-DefineFieldEnd
38902>>>>>>>>>    End_Procedure    // Define_Fields
38903>>>>>>>>>
38903>>>>>>>>>    // Field_Defaults:
38903>>>>>>>>>    // This procedure is used to establish default field values.
38903>>>>>>>>>
38903>>>>>>>>>    Procedure Field_Defaults
38904>>>>>>>>>        Forward Send Field_Defaults
38906>>>>>>>>>        //DDB-Generated-Code-Location
38906>>>>>>>>>        //DDB-FieldDefaultStart
38906>>>>>>>>>        //DDB-FieldDefaultEnd
38906>>>>>>>>>    End_Procedure    // Field_Defaults
38907>>>>>>>>>
38907>>>>>>>>>End_Class    // Ctypkin_DataDictionary
38908>>>>>>>>>//DDB-Selection-pkg-Start
38908>>>>>>>>>
38908>>>>>>>>>Use sl007.SL         // sl007
38908>>>>>>>>>
38908>>>>>>>>>//DDB-Selection-pkg-End
38908>>>>>>>>>//DDB-FileEnd
38908>>>>>>>
38908>>>>>>>//AB-IgnoreEnd
38908>>>>>>>
38908>>>>>>>Object sl007 is a dbModalPanelSub
38910>>>>>>>
38910>>>>>>>    //AB-StoreTopStart
38910>>>>>>>    Property String psModule Public ''
38912>>>>>>>    
38912>>>>>>>    //AB-StoreTopEnd
38912>>>>>>>
38912>>>>>>>    Set Label to "‰ ¤ã©œ ª    "
38913>>>>>>>    Set Size to 148 350
38914>>>>>>>    Set Location to 4 7
38915>>>>>>>    Set Exit_Application_Local_State to FALSE
38916>>>>>>>    Set Modal_State to FALSE
38917>>>>>>>
38917>>>>>>>    //AB-DDOStart
38917>>>>>>>
38917>>>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
38919>>>>>>>
38919>>>>>>>        //AB-StoreStart
38919>>>>>>>                                
38919>>>>>>>        Begin_Constraints
38921>>>>>>>            If (psModule(sl007(Self))<>'') Constrain Ctypkin.Ctypkin_Module eq (psModule(sl007(Self)))
38925>>>>>>>        End_Constraints
38928>>>>>>>        
38928>>>>>>>        
38928>>>>>>>        
38928>>>>>>>        
38928>>>>>>>        //AB-StoreEnd
38928>>>>>>>
38928>>>>>>>    End_Object    // Ctypkin_DD
38929>>>>>>>
38929>>>>>>>    Set Main_DD to (Ctypkin_DD(self))
38930>>>>>>>    Set Server to (Ctypkin_DD(self))
38931>>>>>>>
38931>>>>>>>    //AB-DDOEnd
38931>>>>>>>
38931>>>>>>>    Object oSelList is a dbListSub
38933>>>>>>>        Set Main_File to Ctypkin.File_Number
38934>>>>>>>        Set Size to 105 335
38935>>>>>>>        Set Location to 6 6
38936>>>>>>>
38936>>>>>>>        Begin_Row
38939>>>>>>>            Entry_Item Ctypkin.Ctypkin_code
38940>>>>>>>            Entry_Item Ctypkin.Ctypkin_descr
38941>>>>>>>        End_Row
38946>>>>>>>
38946>>>>>>>        Set Form_Width    item 0 to 71
38947>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª ‰ ¤ã©œàª"
38948>>>>>>>        
38948>>>>>>>        Set Form_Width    item 1 to 255
38949>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã ‰ ¤ã©œàª"
38950>>>>>>>        
38950>>>>>>>
38950>>>>>>>        //AB-StoreStart
38950>>>>>>>                    
38950>>>>>>>                    
38950>>>>>>>        Procedure Activate
38952>>>>>>>            Forward Send Activate
38954>>>>>>>            Send Beginning_Of_Data to oSelList True
38955>>>>>>>        End_Procedure
38956>>>>>>>        
38956>>>>>>>        
38956>>>>>>>        
38956>>>>>>>        
38956>>>>>>>        //AB-StoreEnd
38956>>>>>>>
38956>>>>>>>    End_Object    // oSelList
38957>>>>>>>
38957>>>>>>>    Object oOK_bn is a ButtonSub
38959>>>>>>>        Set Label to "&„§ ¢¦šã"
38960>>>>>>>        Set Location to 113 171
38961>>>>>>>
38961>>>>>>>        //AB-StoreStart
38961>>>>>>>        Procedure OnClick
38963>>>>>>>            Send OK To (oSelList(current_object))
38964>>>>>>>        End_Procedure
38965>>>>>>>        //AB-StoreEnd
38965>>>>>>>
38965>>>>>>>    End_Object    // oOK_bn
38966>>>>>>>
38966>>>>>>>    Object oCancel_bn is a ButtonSub
38968>>>>>>>        Set Label to "&€¡ç¨à©ž"
38969>>>>>>>        Set Location to 113 226
38970>>>>>>>
38970>>>>>>>        //AB-StoreStart
38970>>>>>>>        Procedure OnClick
38972>>>>>>>            Send Cancel To (oSelList(current_object))
38973>>>>>>>        End_Procedure
38974>>>>>>>        //AB-StoreEnd
38974>>>>>>>
38974>>>>>>>    End_Object    // oCancel_bn
38975>>>>>>>
38975>>>>>>>    Object oSearch_bn is a ButtonSub
38977>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
38978>>>>>>>        Set Location to 113 281
38979>>>>>>>
38979>>>>>>>        //AB-StoreStart
38979>>>>>>>        Procedure OnClick
38981>>>>>>>            Send Search To (oSelList(current_object))
38982>>>>>>>        End_Procedure
38983>>>>>>>        //AB-StoreEnd
38983>>>>>>>
38983>>>>>>>    End_Object    // oSearch_bn
38984>>>>>>>
38984>>>>>>>
38984>>>>>>>    //AB-StoreStart
38984>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
38985>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
38986>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
38987>>>>>>>    
38987>>>>>>>    Procedure Activate Returns Integer
38989>>>>>>>        Integer rVal
38990>>>>>>>        Send Rebuild_Constraints to Ctypkin_DD
38991>>>>>>>        Forward Get Msg_Activate to rVal
38993>>>>>>>        Procedure_Return rVal
38994>>>>>>>    End_Procedure
38995>>>>>>>    
38995>>>>>>>    //AB-StoreEnd
38995>>>>>>>
38995>>>>>>>End_Object    // sl007
38996>>>>>>>
38996>>>>>>>//AB/ End_Object    // prj
38996>>>>>Use sl007r.SL        // sl007r
INCLUDING FILE: SL007R.SL
38996>>>>>>>//AB/ Project sl007r:Ctypkin lookup with RecR 1st Col
38996>>>>>>>//AB/     Object prj is a Lookup_Project
38996>>>>>>>//AB/         Set ProjectName to "sl007r:Ctypkin lookup with RecR 1st Col"
38996>>>>>>>//AB/         Set ProjectFileName to "sl007r.SL"
38996>>>>>>>//AB/         Set GenerateFileName to "NONAME"
38996>>>>>>>
38996>>>>>>>// Project Object Structure
38996>>>>>>>//   sl007r is a dbModalPanelSub
38996>>>>>>>//     Ctypkin_DD is a DataDictionary
38996>>>>>>>//     oSelList is a dbListSub
38996>>>>>>>//     oOK_bn is a ButtonSub
38996>>>>>>>//     oCancel_bn is a ButtonSub
38996>>>>>>>//     oSearch_bn is a ButtonSub
38996>>>>>>>
38996>>>>>>>// Register all objects
38996>>>>>>>Register_Object Ctypkin_DD
38996>>>>>>>Register_Object oCancel_bn
38996>>>>>>>Register_Object oOK_bn
38996>>>>>>>Register_Object oSearch_bn
38996>>>>>>>Register_Object oSelList
38996>>>>>>>Register_Object sl007r
38996>>>>>>>
38996>>>>>>>
38996>>>>>>>    //AB-IgnoreStart
38996>>>>>>>
38996>>>>>>>    Use DFAllEnt.pkg
38996>>>>>>>    Use dbList.Sub
38996>>>>>>>    Use Button.Sub
38996>>>>>>>
38996>>>>>>>
38996>>>>>>>    Use CTYPKIN.DD
38996>>>>>>>    
38996>>>>>>>    //AB-IgnoreEnd
38996>>>>>>>
38996>>>>>>>    CD_Popup_Object sl007r is a dbModalPanelSub
39015>>>>>>>        Set Label to "Ctypkin"
39016>>>>>>>        Set Size to 148 480
39017>>>>>>>        Set Location to 12 16
39018>>>>>>>        Set Exit_Application_Local_State to FALSE
39019>>>>>>>        Set Modal_State to FALSE
39020>>>>>>>
39020>>>>>>>        //AB-DDOStart
39020>>>>>>>
39020>>>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
39022>>>>>>>        End_Object    // Ctypkin_DD
39023>>>>>>>
39023>>>>>>>        Set Main_DD to (Ctypkin_DD(self))
39024>>>>>>>        Set Server to (Ctypkin_DD(self))
39025>>>>>>>
39025>>>>>>>        //AB-DDOEnd
39025>>>>>>>
39025>>>>>>>        Object oSelList is a dbListSub
39027>>>>>>>            Set Main_File to Ctypkin.File_Number
39028>>>>>>>            Set Size to 105 465
39029>>>>>>>            Set Location to 6 6
39030>>>>>>>
39030>>>>>>>            Begin_Row
39033>>>>>>>                Entry_Item Ctypkin.Ctypkin_recr
39034>>>>>>>                Entry_Item Ctypkin.Ctypkin_code
39035>>>>>>>                Entry_Item Ctypkin.Ctypkin_descr
39036>>>>>>>                Entry_Item Ctypkin.Ctypkin_anti
39037>>>>>>>            End_Row
39042>>>>>>>
39042>>>>>>>            Set Form_Width    item 0 to 72
39043>>>>>>>            Set Header_Label  item 0 to "RecR"
39044>>>>>>>            
39044>>>>>>>            Set Form_Width    item 1 to 58
39045>>>>>>>            Set Header_Label  item 1 to "Ctypkin code"
39046>>>>>>>            
39046>>>>>>>            Set Form_Width    item 2 to 209
39047>>>>>>>            Set Header_Label  item 2 to "Ctypkin descr"
39048>>>>>>>            
39048>>>>>>>            Set Form_Width    item 3 to 120
39049>>>>>>>            Set Header_Label  item 3 to "Ctypkin anti"
39050>>>>>>>            
39050>>>>>>>
39050>>>>>>>            //AB-StoreStart
39050>>>>>>>            
39050>>>>>>>            Set Column_Option Item 0 to Noenter True
39051>>>>>>>            
39051>>>>>>>            //AB-StoreEnd
39051>>>>>>>
39051>>>>>>>        End_Object    // oSelList
39052>>>>>>>
39052>>>>>>>        Object oOK_bn is a ButtonSub
39054>>>>>>>            set label to "&„§ ¢¦šã" 
39055>>>>>>>            Set Location to 114 312
39056>>>>>>>
39056>>>>>>>            //AB-StoreStart
39056>>>>>>>            Procedure OnClick
39058>>>>>>>                Send OK To (oSelList(current_object))
39059>>>>>>>            End_Procedure
39060>>>>>>>            //AB-StoreEnd
39060>>>>>>>
39060>>>>>>>        End_Object    // oOK_bn
39061>>>>>>>
39061>>>>>>>        Object oCancel_bn is a ButtonSub
39063>>>>>>>            set label to "&€¡ç¨à©ž" 
39064>>>>>>>            Set Location to 114 367
39065>>>>>>>
39065>>>>>>>            //AB-StoreStart
39065>>>>>>>            Procedure OnClick
39067>>>>>>>                Send Cancel To (oSelList(current_object))
39068>>>>>>>            End_Procedure
39069>>>>>>>            //AB-StoreEnd
39069>>>>>>>
39069>>>>>>>        End_Object    // oCancel_bn
39070>>>>>>>
39070>>>>>>>        Object oSearch_bn is a ButtonSub
39072>>>>>>>            set label to "€&¤˜ã«ž©ž" 
39073>>>>>>>            Set Location to 114 422
39074>>>>>>>
39074>>>>>>>            //AB-StoreStart
39074>>>>>>>            Procedure OnClick
39076>>>>>>>                Send Search To (oSelList(current_object))
39077>>>>>>>            End_Procedure
39078>>>>>>>            //AB-StoreEnd
39078>>>>>>>
39078>>>>>>>        End_Object    // oSearch_bn
39079>>>>>>>
39079>>>>>>>
39079>>>>>>>        //AB-StoreStart
39079>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39080>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39081>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39082>>>>>>>        //AB-StoreEnd
39082>>>>>>>
39082>>>>>>>    CD_End_Object    // sl007r
39084>>>>>>>>
39084>>>>>>>
39084>>>>>>>//AB/     End_Object    // prj
39084>>>>>
39084>>>>>//DDB-Selection-pkg-End
39084>>>>>//DDB-FileEnd
39084>>>    Use BAXIOKAT.DD
INCLUDING FILE: BAXIOKAT.DD
39084>>>>>//DDB-FileStart
39084>>>>>//DDB-HeaderStart
39084>>>>>
39084>>>>>// File Name : BAXIOKAT.DD
39084>>>>>// Class Name: Baxiokat_DataDictionary
39084>>>>>// Revision  : 45
39084>>>>>// Version   : 2
39084>>>>>
39084>>>>>Use  Windows           // Basic Definitions
39084>>>>>Use  DataDict          // DataDictionary Class Definition
39084>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39084>>>>>
39084>>>>>Open Baxiokat
INCLUDING FILE: BAXIOKAT.FD
39086>>>>>Open Baxio
INCLUDING FILE: BAXIO.FD
39088>>>>>Open Bkinkat
39090>>>>>Open Tpclient
39092>>>>>Open Tperga
INCLUDING FILE: TPERGA.FD
39094>>>>>Open Tparticl
INCLUDING FILE: TPARTICL.FD
39096>>>>>Open Sysrecb
39098>>>>>
39098>>>>>//DDB-HeaderEnd
39098>>>>>//DDB-ValidationStart
39098>>>>>
39098>>>>>//DDB/ ExternalValidationTable Baxiokat_Type_VT  BAXIO.PKG
39098>>>>>
39098>>>>>Register_Object Baxiokat_Type_VT
39098>>>>>Register_Object Baxiokat_Baxiokat_Yn5390_VT
39098>>>>>Register_Object Baxiokat_Baxiokat_Bank_VT
39098>>>>>Register_Object Baxiokat_Baxiokat_Formul_VT
39098>>>>>Use BAXIO.PKG        // Baxiokat_Type_VT
39098>>>>>
39098>>>>>Object Baxiokat_Baxiokat_Yn5390_VT  is a DescriptionValidationTable
39100>>>>>
39100>>>>>    Procedure Fill_List
39102>>>>>        Forward Send Fill_List
39104>>>>>        Send Add_Table_Value  "0"  "Ž® "
39105>>>>>        Send Add_Table_Value  "1"  "Œ˜ "
39106>>>>>    End_Procedure    // Fill_List
39107>>>>>    //DDB-ValidationCustomStart
39107>>>>>    //DDB-ValidationCustomEnd
39107>>>>>End_Object   // Baxiokat_Baxiokat_Yn5390_VT
39108>>>>>
39108>>>>>Object Baxiokat_Baxiokat_Bank_VT  is a CodeValidationTable
39110>>>>>    Set Type_Value        To "BANK"
39111>>>>>    Set Allow_Blank_State To TRUE
39112>>>>>    //DDB-ValidationCustomStart
39112>>>>>    //DDB-ValidationCustomEnd
39112>>>>>End_Object   // Baxiokat_Baxiokat_Bank_VT
39113>>>>>
39113>>>>>Object Baxiokat_Baxiokat_Formul_VT  is a DescriptionValidationTable
39115>>>>>    Set Allow_Blank_State To TRUE
39116>>>>>
39116>>>>>    Procedure Fill_List
39118>>>>>        Forward Send Fill_List
39120>>>>>        Send Add_Table_Value  "0"  ""
39121>>>>>        Send Add_Table_Value  "1"  "’ç§¦ª 1"
39122>>>>>        Send Add_Table_Value  "2"  "’ç§¦ª 2"
39123>>>>>    End_Procedure    // Fill_List
39124>>>>>    //DDB-ValidationCustomStart
39124>>>>>    //DDB-ValidationCustomEnd
39124>>>>>End_Object   // Baxiokat_Baxiokat_Formul_VT
39125>>>>>//DDB-ValidationEnd
39125>>>>>//DDB-SelectionStart
39125>>>>>//DDB/ ExternalSelectionList SL034  SL034.SL
39125>>>>>Register_Object SL034
39125>>>>>//DDB-SelectionEnd
39125>>>>>
39125>>>>>Open Syscurxr
39127>>>>>Open Btypkin
39129>>>>>Open Bkinkat
39131>>>>>
39131>>>>>
39131>>>>>// Apo Baxio_DD
39131>>>>>Register_Function private.Default_Axio_C_Code2 Returns String
39131>>>>>//
39131>>>>>
39131>>>>>Class Baxiokat_DataDictionary  is a DataDictionary_Sec
39132>>>>>
39132>>>>>     Procedure Creating
39133>>>>>        Forward Send Creating
39135>>>>>        // Insert Code Here
39135>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Baxiokat.Baxiokat_Rec0)))))) to Baxiokat.Baxiokat_Recr
39136>>>>>    End_Procedure   // Creating
39137>>>>>
39137>>>>>     Procedure Construct_Object
39138>>>>>               Forward Send Construct_Object
39140>>>>>
39140>>>>>               //object id «é¤ ddo servers š ˜ «á barticl+bmove+baxio+baxiokat
39140>>>>>               //©œ«á¨¦¤«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
39140>>>>>               //®¨ž© £œç¦¬¤ ©«ž¤ private.exit_btypkin_code
39140>>>>>               //š ˜ ¤˜ ©œ«á¨¦¬¤ «¦ visual interface
39140>>>>>               Property Integer piBarticl_dd  0
39141>>>>>               Property Integer piBmove_dd    0
39142>>>>>               Property Integer piBaxio_dd    0
39143>>>>>               Property Integer piBtypkin_dd 0
39144>>>>>     End_Procedure   //construct_object
39145>>>>>
39145>>>>>
39145>>>>>     //private
39145>>>>>     //¡˜¢œå«˜  ˜§æ: iexit «¦¬ baxiokat_code
39145>>>>>     //©œ«á¨œ      : «ž¤ default « £ã «¦¬ baxio_c_code2, ˜¤á¢¦š˜ £œ «¦ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
39145>>>>>     Procedure private.Exit_Baxiokat_Code Integer liField Integer liBaxiokat_Code
39146>>>>>               String lsBaxio_C_Code_2
39147>>>>>        PROCEDURE_RETURN
39148>>>>>//jsjsjs 24/01/2001
39148>>>>>//               Get File_Field_Current_Value File_Field Year.Year_C_Code0 to lsBaxio_C_Code_2
39148>>>>>
39148>>>>>//               Set Field_Changed_Value of (piBaxio_dd(Self)) Field Baxio.Baxio_C_Code2 to  lsBaxio_C_Code_2 //(private.Default_Axio_C_Code2((piBAxio_dd(Self))))
39148>>>>>//jsjsjs 24/01/2001
39148>>>>>     End_Procedure //private.exit_baxiokat_code
39149>>>>>
39149>>>>>
39149>>>>>    //private
39149>>>>>    //¡˜¢œå«˜  ˜§æ:
39149>>>>>    //©œ«á¨œ : «ž¤ default value to baxiokat_code, ˜¤á¢¦š˜ £œ «¦ btypkin.baxiokat_num
39149>>>>>    Procedure private.Entry_Baxiokat_Code Integer liField Integer liBaxiokat_Code
39150>>>>>              Integer liBtypkin_dd liBkinkat_Num liBtypkin_Rec0
39151>>>>>
39151>>>>>        PROCEDURE_RETURN
39152>>>>>
39152>>>>>
39152>>>>>    End_Procedure //private.entry_gtypkin_code
39153>>>>>
39153>>>>>
39153>>>>>
39153>>>>>
39153>>>>>    Procedure Update
39154>>>>>          Forward Send Update
39156>>>>>          If (Baxiokat.Baxiokat_Yn5390 = 0);          Begin //œá¤ ›â¤ œå¤˜  £ž®˜¤¦š¨˜­ž£â¤œª œ§ «˜šâª, £ž›â¤ ©œ æ¢˜ «˜ ©®œ« ¡á §œ›å˜
39158>>>>>               Move "" to Baxiokat.Baxiokat_Bank
39159>>>>>               Move "" to Baxiokat.Baxiokat_Lno
39160>>>>>               Move 0  to Baxiokat.Baxiokat_Formul
39161>>>>>          End
39161>>>>>>
39161>>>>>    End_Procedure
39162>>>>>
39162>>>>>
39162>>>>>    Procedure Define_Fields
39163>>>>>        Forward Send Define_Fields
39165>>>>>        //DDB-Generated-Code-Location
39165>>>>>        //DDB-DefineFieldStart
39165>>>>>
39165>>>>>        Set Main_File            To Baxiokat.File_Number
39166>>>>>        Set Cascade_Delete_State To FALSE
39167>>>>>
39167>>>>>
39167>>>>>        // Child (Client) file structure................
39167>>>>>        Send Add_Client_File  Baxio.File_Number
39168>>>>>        Send Add_Client_File  Bkinkat.File_Number
39169>>>>>        Send Add_Client_File  Tpclient.File_Number
39170>>>>>        Send Add_Client_File  Tperga.File_Number
39171>>>>>        Send Add_Client_File  Tparticl.File_Number
39172>>>>>
39172>>>>>        // External (System) file structure.............
39172>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
39173>>>>>
39173>>>>>        Define_Auto_Increment  Sysrecb.Baxiokat_Rec0  To Baxiokat.Baxiokat_Rec0
39176>>>>>
39176>>>>>        // Field-based properties.......................
39176>>>>>
39176>>>>>        // Baxiokat.Baxiokat_Code
39176>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Code To (SL034(Self))
39177>>>>>
39177>>>>>        // Baxiokat.Baxiokat_Descr
39177>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Descr To (SL034(Self))
39178>>>>>
39178>>>>>        // Baxiokat.Baxiokat_Rec0
39178>>>>>
39178>>>>>        // Baxiokat.Baxiokat_Recr
39178>>>>>
39178>>>>>        // Baxiokat.Baxiokat_Type
39178>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Type To (Baxiokat_Type_VT(Self))
39179>>>>>
39179>>>>>        // Baxiokat.Baxio_Lcode
39179>>>>>        //DDB/ Comment_Short       Field Baxiokat.Baxio_Lcode To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ creating/deleting «¦¬ baxio)"
39179>>>>>
39179>>>>>        // Baxiokat.Baxiokat_Yn5390
39179>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Yn5390 To (Baxiokat_Baxiokat_Yn5390_VT(Self))
39180>>>>>
39180>>>>>        // Baxiokat.Baxiokat_Bank
39180>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Bank To (Baxiokat_Baxiokat_Bank_VT(Self))
39181>>>>>
39181>>>>>        // Baxiokat.Baxiokat_Lno
39181>>>>>
39181>>>>>        // Baxiokat.Baxiokat_Formul
39181>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Formul To (Baxiokat_Baxiokat_Formul_VT(Self))
39182>>>>>
39182>>>>>        //DDB-DefineFieldEnd
39182>>>>>
39182>>>>>        Set Main_File            To Baxiokat.File_Number
39183>>>>>        Set Cascade_Delete_State To FALSE
39184>>>>>
39184>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
39185>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
39186>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39187>>>>>
39187>>>>>        // Child (Client) file structure................
39187>>>>>        Send Add_Client_File  Baxio.File_Number
39188>>>>>        Send Add_Client_File  Bkinkat.File_Number
39189>>>>>
39189>>>>>        // External (System) file structure.............
39189>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
39190>>>>>
39190>>>>>        Define_Auto_Increment  Sysrecb.Baxiokat_Rec0  To Baxiokat.Baxiokat_Rec0
39193>>>>>
39193>>>>>        // Field-based properties.......................
39193>>>>>
39193>>>>>        // Baxiokat.Baxiokat_Code
39193>>>>>        Set Field_Entry_msg        Field Baxiokat.Baxiokat_Code   To private.Entry_Baxiokat_Code
39194>>>>>        Set Field_Exit_msg         Field Baxiokat.Baxiokat_Code   To private.Exit_Baxiokat_Code
39195>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Code   To "‰à› ¡æª „å›¦¬ª €¥ ¦š¨á­¦¬"
39196>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Code   To "„å›¦ª"
39197>>>>>        Set Field_Options          Field Baxiokat.Baxiokat_Code   To DD_AUTOFIND    DD_REQUIRED
39198>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Code   To (SL034(Self))
39199>>>>>        Set Key_Field_State        Field Baxiokat.Baxiokat_Code   To TRUE
39200>>>>>
39200>>>>>        // Baxiokat.Baxiokat_Descr
39200>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Descr  To "œ¨ š¨˜­ã „å›¦¬ª €¥ ¦š¨á­¦¬"
39201>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Descr  To "œ¨ š¨˜­ã"
39202>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Descr  To (SL034(Self))
39203>>>>>
39203>>>>>        // Baxiokat.Baxiokat_Rec0
39203>>>>>        Set Field_Options          Field Baxiokat.Baxiokat_Rec0   To DD_AUTOFIND    DD_REQUIRED
39204>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Rec0   To (SL034(Self))
39205>>>>>        Set Key_Field_State        Field Baxiokat.Baxiokat_Rec0   To TRUE
39206>>>>>
39206>>>>>        // Baxiokat.Baxiokat_Type
39206>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Type   To "dbComboForm_EZ"
39207>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Type   To "„ ©§¨˜¡«â¦/¢ž¨à«â¦"
39208>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Type   To "„ ©./¢ã¨."
39209>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Type   To (Baxiokat_Type_VT(Self))
39210>>>>>
39210>>>>>        // Baxiokat.Baxio_Lcode
39210>>>>>        Set Field_Label_Long       Field Baxiokat.Baxio_Lcode     To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª €¥ ¦šá­¦¬"
39211>>>>>        Set Field_Label_Short      Field Baxiokat.Baxio_Lcode     To "’œ¢.€¨ Ÿ£æª"
39212>>>>>        //Set Field_Options          Field Baxiokat.Baxio_Lcode     To DD_DISPLAYONLY
39212>>>>>
39212>>>>>        // Baxiokat.Baxiokat_Yn5390
39212>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Yn5390 To "dbComboForm_EZ"
39213>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Yn5390 To "‹ž®˜¤¦š¨˜­ž£â¤œª „§ «˜šâª ?"
39214>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Yn5390 To "‹ž®/¡âª „§ «˜šâª"
39215>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Yn5390 To (Baxiokat_Baxiokat_Yn5390_VT(Self))
39216>>>>>
39216>>>>>        // Baxiokat.Baxiokat_Bank
39216>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Bank   To "dbComboForm_EZ"
39217>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Bank   To "’¨á§œ˜"
39218>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Bank   To "’¨á§œ˜"
39219>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Bank   To (Baxiokat_Baxiokat_Bank_VT(Self))
39220>>>>>
39220>>>>>        // Baxiokat.Baxiokat_Lno
39220>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Lno    To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª"
39221>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Lno    To "’œ¢.€¨ Ÿ£æª"
39222>>>>>
39222>>>>>        // Baxiokat.Baxiokat_Formul
39222>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Formul To "dbComboForm_EZ"
39223>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Formul To "€¢šæ¨ Ÿ£¦ª Check Digit"
39224>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Formul To "Check Digit"
39225>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Formul To (Baxiokat_Baxiokat_Formul_VT(Self))
39226>>>>>
39226>>>>>    End_Procedure    // Define_Fields
39227>>>>>
39227>>>>>
39227>>>>>    Procedure Field_Defaults
39228>>>>>        Forward Send Field_Defaults
39230>>>>>        //DDB-Generated-Code-Location
39230>>>>>        //DDB-FieldDefaultStart
39230>>>>>        //DDB-FieldDefaultEnd
39230>>>>>        Set Field_Changed_Value   Field Baxiokat.Baxiokat_Yn5390 To 0
39231>>>>>    End_Procedure    // Field_Defaults
39232>>>>>
39232>>>>>End_Class    // Baxiokat_DataDictionary
39233>>>>>//DDB-Selection-pkg-Start
39233>>>>>
39233>>>>>Use SL034.SL         // SL034
INCLUDING FILE: SL034.SL
39233>>>>>>>//AB/ Project SL034:BAXIOKAT
39233>>>>>>>//AB/ Object prj is a Lookup_Project
39233>>>>>>>//AB/     Set ProjectName to "SL034:BAXIOKAT"
39233>>>>>>>//AB/     Set ProjectFileName to "SL034.SL"
39233>>>>>>>//AB/     Set GenerateFileName to "NONAME"
39233>>>>>>>
39233>>>>>>>// Project Object Structure
39233>>>>>>>//   SL034 is a dbModalPanelSub
39233>>>>>>>//     Baxiokat_DD is a DataDictionary
39233>>>>>>>//     oSelList is a dbListSub
39233>>>>>>>//     oOK_bn is a ButtonSub
39233>>>>>>>//     oCancel_bn is a ButtonSub
39233>>>>>>>//     oSearch_bn is a ButtonSub
39233>>>>>>>
39233>>>>>>>// Register all objects
39233>>>>>>>Register_Object Baxiokat_DD
39233>>>>>>>Register_Object oCancel_bn
39233>>>>>>>Register_Object oOK_bn
39233>>>>>>>Register_Object oSearch_bn
39233>>>>>>>Register_Object oSelList
39233>>>>>>>Register_Object SL034
39233>>>>>>>
39233>>>>>>>
39233>>>>>>>//AB-IgnoreStart
39233>>>>>>>
39233>>>>>>>Use DFAllEnt.pkg
39233>>>>>>>Use dbList.Sub
39233>>>>>>>Use Button.Sub
39233>>>>>>>
39233>>>>>>>
39233>>>>>>>Use BAXIOKAT.DD
39233>>>>>>>
39233>>>>>>>//AB-IgnoreEnd
39233>>>>>>>
39233>>>>>>>CD_Popup_Object SL034 is a dbModalPanelSub
39252>>>>>>>    set label to "‰˜«žš¦¨åœª €¥ ¦š¨á­à¤" 
39253>>>>>>>    Set Size to 206 347
39254>>>>>>>    Set Location to 4 5
39255>>>>>>>    Set Exit_Application_Local_State to FALSE
39256>>>>>>>    Set Modal_State to FALSE
39257>>>>>>>
39257>>>>>>>    //AB-DDOStart
39257>>>>>>>
39257>>>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
39259>>>>>>>    End_Object    // Baxiokat_DD
39260>>>>>>>
39260>>>>>>>    Set Main_DD to (Baxiokat_DD(self))
39261>>>>>>>    Set Server to (Baxiokat_DD(self))
39262>>>>>>>
39262>>>>>>>    //AB-DDOEnd
39262>>>>>>>
39262>>>>>>>    Object oSelList is a dbListSub
39264>>>>>>>        Set Main_File to Baxiokat.File_Number
39265>>>>>>>        Set Size to 164 335
39266>>>>>>>        Set Location to 5 4
39267>>>>>>>
39267>>>>>>>        Begin_Row
39270>>>>>>>            Entry_Item Baxiokat.Baxiokat_code
39271>>>>>>>            Entry_Item Baxiokat.Baxiokat_descr
39272>>>>>>>            Entry_Item Baxiokat.Baxiokat_type
39273>>>>>>>            Entry_Item (Export_Code_Description(Self,2,Baxiokat.Baxiokat_type))
39274>>>>>>>        End_Row
39279>>>>>>>
39279>>>>>>>        Set Form_Width    item 0 to 55
39280>>>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
39281>>>>>>>
39281>>>>>>>        Set Form_Width    item 1 to 172
39282>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
39283>>>>>>>
39283>>>>>>>        Set Form_Width    item 2 to 16
39284>>>>>>>        set header_label  item 2 to "’ç§¦ª" 
39285>>>>>>>
39285>>>>>>>        Set Form_Width    item 3 to 83
39286>>>>>>>        set header_label  item 3 to "„ ©./¢ž¨." 
39287>>>>>>>
39287>>>>>>>    End_Object    // oSelList
39288>>>>>>>
39288>>>>>>>    Object oOK_bn is a ButtonSub
39290>>>>>>>        set label to "&„§ ¢¦šã" 
39291>>>>>>>        Set Location to 172 180
39292>>>>>>>
39292>>>>>>>        //AB-StoreStart
39292>>>>>>>        Procedure OnClick
39294>>>>>>>            Send OK To oSelList
39295>>>>>>>        End_Procedure
39296>>>>>>>        //AB-StoreEnd
39296>>>>>>>
39296>>>>>>>    End_Object    // oOK_bn
39297>>>>>>>
39297>>>>>>>    Object oCancel_bn is a ButtonSub
39299>>>>>>>        set label to "&€¡ç¨à©ž" 
39300>>>>>>>        Set Location to 172 234
39301>>>>>>>
39301>>>>>>>        //AB-StoreStart
39301>>>>>>>        Procedure OnClick
39303>>>>>>>            Send Cancel To oSelList
39304>>>>>>>        End_Procedure
39305>>>>>>>        //AB-StoreEnd
39305>>>>>>>
39305>>>>>>>    End_Object    // oCancel_bn
39306>>>>>>>
39306>>>>>>>    Object oSearch_bn is a ButtonSub
39308>>>>>>>        set label to "€&¤˜ã«ž©ž" 
39309>>>>>>>        Set Location to 172 289
39310>>>>>>>
39310>>>>>>>        //AB-StoreStart
39310>>>>>>>        Procedure OnClick
39312>>>>>>>            Send Search To oSelList
39313>>>>>>>        End_Procedure
39314>>>>>>>        //AB-StoreEnd
39314>>>>>>>
39314>>>>>>>    End_Object    // oSearch_bn
39315>>>>>>>
39315>>>>>>>
39315>>>>>>>    //AB-StoreStart
39315>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
39316>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
39317>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
39318>>>>>>>    //AB-StoreEnd
39318>>>>>>>
39318>>>>>>>CD_End_Object    // SL034
39320>>>>>>>>
39320>>>>>>>
39320>>>>>>>//AB/ End_Object    // prj
39320>>>>>
39320>>>>>//DDB-Selection-pkg-End
39320>>>>>//DDB-FileEnd
39320>>>    Use BARTICL.DD
INCLUDING FILE: BARTICL.DD
39320>>>>>//DDB-FileStart
39320>>>>>//DDB-HeaderStart
39320>>>>>
39320>>>>>// File Name : BARTICL.DD
39320>>>>>// Class Name: Barticl_DataDictionary
39320>>>>>// Revision  : 76
39320>>>>>// Version   : 2
39320>>>>>
39320>>>>>Use  Windows           // Basic Definitions
39320>>>>>Use  DataDict          // DataDictionary Class Definition
39320>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39320>>>>>
39320>>>>>Open Barticl
39322>>>>>Open Bmove
INCLUDING FILE: BMOVE.FD
39324>>>>>Open Bsum
INCLUDING FILE: BSUM.FD
39326>>>>>Open Btypkin
39328>>>>>Open Sysrecb
39330>>>>>Open Cn
39332>>>>>
39332>>>>>//DDB-HeaderEnd
39332>>>>>//DDB-ValidationStart
39332>>>>>
39332>>>>>Register_Object Barticl_Barticl_M_Code_VT
39332>>>>>
39332>>>>>Object Barticl_Barticl_M_Code_VT  is a CodeValidationTable
39334>>>>>    Set Type_Value        To "MODULE"
39335>>>>>    Set Allow_Blank_State To TRUE
39336>>>>>    //DDB-ValidationCustomStart
39336>>>>>    //DDB-ValidationCustomEnd
39336>>>>>End_Object   // Barticl_Barticl_M_Code_VT
39337>>>>>//DDB-ValidationEnd
39337>>>>>//DDB-SelectionStart
39337>>>>>//DDB/ ExternalSelectionList Barticl  Barticl.SL
39337>>>>>//DDB/ ExternalSelectionList sl041  sl041.SL
39337>>>>>Register_Object Barticl
39337>>>>>Register_Object sl041
39337>>>>>//DDB-SelectionEnd
39337>>>>>
39337>>>>>Class Barticl_DataDictionary  is a DataDictionary_Sec
39338>>>>>
39338>>>>>    Procedure Shmera integer iField  Date dDate
39339>>>>>        Local Integer Changed
39340>>>>>        Get Field_Changed_State iField to Changed
39341>>>>>        If (Changed=0 AND dDate =0) Begin
39343>>>>>            SysDate4 dDate
39344>>>>>            Set Field_Default_Value iField to dDate
39345>>>>>        End
39345>>>>>>
39345>>>>>    End_Procedure   // Shmera
39346>>>>>
39346>>>>>    Procedure Save_Main_File
39347>>>>>        If (Barticl.Cn_Code<>'') Begin  
39349>>>>>            Clear Cn   
39350>>>>>            Move Barticl.Cn_Code to Cn.Cn_Code
39351>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code  
39352>>>>>>
39352>>>>>            Move Cn.Cn_Sls_ID     to Barticl.Sls_ID
39353>>>>>            Move Cn.Cn_Presp_ID   to Barticl.Presp_ID
39354>>>>>            Move Cn.CN_Cnt_ID     to Barticl.Cnt_ID
39355>>>>>        End
39355>>>>>>
39355>>>>>        Forward Send Save_Main_File
39357>>>>>    End_Procedure   // Save_Main_File
39358>>>>>
39358>>>>>      Procedure private.Initialize_Properties
39359>>>>>                 //£ž›œ¤ ©£æª §˜¢˜ é¤
39359>>>>>                 Set psB_Btypkin_Recr    to ''
39360>>>>>                 Set pdB_Barticl_Hmnia   to 0
39361>>>>>                 Set piB_Barticl_No      to 0
39362>>>>>                 Set psB_Barticl_Code1   to ""
39363>>>>>
39363>>>>>                 Set pdB_Garticl_Hmnia   to 0  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
39364>>>>>                 Set piB_Garticl_No      to 0
39365>>>>>                 Set psB_Garticl_Aitiol  to ""
39366>>>>>
39366>>>>>                 //£ž›œ¤ ©£æª ¤âà¤
39366>>>>>                 Set psA_Btypkin_Recr    to ''
39367>>>>>                 Set pdA_Barticl_Hmnia   to 0
39368>>>>>                 Set piA_Barticl_No      to 0
39369>>>>>                 Set psA_Barticl_Code1   to ""
39370>>>>>
39370>>>>>                 Set pdA_Garticl_Hmnia   to 0  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
39371>>>>>                 Set piA_Garticl_No      to 0
39372>>>>>                 Set psA_Garticl_Aitiol  to ""
39373>>>>>
39373>>>>>                 Set psB_Gplan_Code to ""
39374>>>>>                 Set psA_Gplan_Code to ""
39375>>>>>
39375>>>>>      End_Procedure //private.Initialize_Properties
39376>>>>>
39376>>>>>
39376>>>>>      Procedure Construct_Object
39377>>>>>                Forward Send Construct_Object
39379>>>>>
39379>>>>>                Property String  psA_Btypkin_Recr     ''
39380>>>>>                Property Date    pdA_Barticl_Hmnia    0
39381>>>>>                Property Integer piA_Barticl_No       0
39382>>>>>                Property String  psB_Barticl_Code1    ""
39383>>>>>
39383>>>>>                Property String  psB_Btypkin_Recr     ''
39384>>>>>                Property Date    pdB_Barticl_Hmnia    0
39385>>>>>                Property Integer piB_Barticl_No       0
39386>>>>>                Property String  psA_Barticl_Code1    ""
39387>>>>>
39387>>>>>                Property Date    pdA_Garticl_Hmnia    0 //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
39388>>>>>                Property Integer piA_Garticl_No       0
39389>>>>>                Property String  psA_Garticl_Aitiol   ''
39390>>>>>
39390>>>>>                Property Date    pdB_Garticl_Hmnia    0 //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
39391>>>>>                Property Integer piB_Garticl_No       0
39392>>>>>                Property String  psB_Garticl_Aitiol   ''
39393>>>>>
39393>>>>>
39393>>>>>                Property Integer piBaxio_dd           0 //object id «¦¬ ddo server š ˜ «¦ baxio
39394>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
39394>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ ???
39394>>>>>                Property Integer piBaxiokat_dd        0 //object id «¦¬ ddo server š ˜ «¦ baxio
39395>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
39395>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ ???
39395>>>>>                Property Integer piBmove_dd           0 //object id «¦¬ ddo server š ˜ «¦ bmove
39396>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
39396>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ cascade update
39396>>>>>                Property Integer piBtypkin_dd         0 //object id «¦¬ ddo server š ˜ «¦ btypkin
39397>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
39397>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ cascade update
39397>>>>>
39397>>>>>                Property String  psB_Gplan_Code
39398>>>>>                Property String  psA_Gplan_Code
39399>>>>>
39399>>>>>
39399>>>>>                Property Integer piCreated_Barticl 0 //©œ«á¨œ«˜  ©«ž¤ creating,
39400>>>>>                                                     //®¨ž© £¦§¦ œå«˜  ©«ž¤ update+validate_save ¡˜ 
39400>>>>>                                                     //£ž›œ¤åœ«˜  ©«ž¤ request_save «¦¬ bmove
39400>>>>>
39400>>>>>                Property  Integer piDo_GL_Maintainance       0 //object id «žª business process
39401>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «ã¤ šœ¤ ¡ã ¢¦š ©« ¡ã
39401>>>>>                Property  Integer piDo_CUSTOMER_Maintainance 0 //object id «žª business process
39402>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §œ¢á«œª
39402>>>>>                Property  Integer piDo_VENDOR_Maintainance   0 //object id «žª business process
39403>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §¨¦£žŸœ¬«âª
39403>>>>>      End_Procedure   //construct_object
39404>>>>>
39404>>>>>      Procedure Update
39405>>>>>                Integer liBAxio_dd liBaxiokat_dd
39406>>>>>                Forward Send Update
39408>>>>>
39408>>>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
39408>>>>>                Move Syscurxr.Company_Code  to Barticl.Company_Code
39409>>>>>                Move Syscurxr.Branch_Code   to Barticl.Branch_Code
39410>>>>>                Move Syscurxr.Year_Year     to Barticl.Year_Year
39411>>>>>                Move Btypkin.Btypkin_Code   to Barticl.Btypkin_Code
39412>>>>>
39412>>>>>
39412>>>>>                //™) ˜¤áš¤à©ž properties
39412>>>>>                Get piBaxio_dd    to liBaxio_dd    //«¦ ddo §¦¬ "©œ¨™å¨œ " «¦ baxio
39413>>>>>                Get piBaxiokat_dd to liBaxiokat_dd //«¦ ddo §¦¬ "©œ¨™å¨œ " «¦ baxiokat
39414>>>>>
39414>>>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
39414>>>>>                //š.1:btypkin.btypkin_L_Hmnia //«œ¢œ¬«˜å˜ ž£œ¨¦£ž¤å˜
39414>>>>>                 Move (Barticl.Barticl_Hmnia Max Btypkin.Btypkin_L_Hmnia) to Btypkin.Btypkin_L_Hmnia
39415>>>>>
39415>>>>>                Case Begin
39415>>>>>                    Case (Btypkin.Btypkin_Anti2 = 5) //§˜¨˜¢ã§«žª œå¤˜  ¦ å› ¦ª ¦ ©¬¤˜¢¢˜©æ£œ¤¦ª
39417>>>>>                        Move Barticl.Barticl_Code1 to Barticl.Barticl_Code2
39418>>>>>                        Move Barticl.Barticl_Epon1 to Barticl.Barticl_Epon2
39419>>>>>                      Case Break
39420>>>>>                    Case (Btypkin.Btypkin_Anti2 = (-1)) //›â¤ ¬§á¨®œ  §˜¨˜¢ã§«žª
39423>>>>>                        Move ""                    to Barticl.Barticl_Code2
39424>>>>>                        Move ""                    to Barticl.Barticl_Epon2
39425>>>>>                      Case Break
39426>>>>>                Case End
39426>>>>>
39426>>>>>
39426>>>>>                Case Begin
39426>>>>>                    Case ((Btypkin.Btypkin_Anti1=2) Or (Btypkin.Btypkin_Anti1=3))
39428>>>>>                        Clear Clients
39429>>>>>                        Move Barticl.Barticl_Code1 to Clients.Client_ID
39430>>>>>                        Find Eq Clients by Index.6 //Client_ID
39431>>>>>>
39431>>>>>                        If (Found = 1) Move Clients.Client_Recr to Barticl.Client_Mrecr
39434>>>>>                        Else Send Operation_Not_Allowed 3002 //›â¤ ™¨âŸž¡œ «¦ Master Customer_rec0, please reindex
39436>>>>>                      Case Break
39437>>>>>                Case End
39437>>>>>
39437>>>>>                If (Btypkin.Gtypkin_Code <> 0);                Begin //œá¤ ž ¡å¤ž©ž œ¤ž£œ¨é¤œ  «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã, ®¨œ á¦£˜  ¦§à›ã§¦«œ
39439>>>>>                      //master gplan rec0
39439>>>>>                      Case Begin
39439>>>>>                           Case (Btypkin.Btypkin_Anti1 = 1) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ š¢
39441>>>>>//jsjsjs 24/01/2001
39441>>>>>//                                Clear Gplan
39441>>>>>//                                Move Barticl.Company_Code  to Gplan.Company_Code
39441>>>>>//                                Move Barticl.Branch_Code   to Gplan.Branch_Code
39441>>>>>//                                Move Barticl.Year_Year     to Gplan.Year_Year
39441>>>>>//                                Move Barticl.Barticl_Code1 to Gplan.Gplan_Code
39441>>>>>//                                Find Eq Gplan by Index.1 //company_code+branch_code+year_year+Gplan_code
39441>>>>>//                                If (Found = 1) Move Gplan.Gplan_Rec0 to Barticl.Gplan_Mrec0
39441>>>>>//                                Else           Send Operation_Not_Allowed 3001 //›â¤ ™¨âŸž¡œ «¦ Master Gplan_rec0
39441>>>>>//jsjsjs 24/01/2001
39441>>>>>                           Case Break
39442>>>>>                           Case Else                        //=4 ¢¦ §¦å:©¬¤˜¢¢˜©æ£œ¤¦ª £œ user manual data entry
39442>>>>>                                Move 0 to Barticl.Gplan_Mrec0
39443>>>>>                      Case End
39443>>>>>                End   //please check the logic
39443>>>>>>
39443>>>>>
39443>>>>>
39443>>>>>                //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
39443>>>>>
39443>>>>>                //œ) œ¤ž£â¨à©ž properties after (˜§æ parent buffers!)
39443>>>>>                Set psA_Btypkin_Recr    to Btypkin.Btypkin_Recr
39444>>>>>                Set pdA_Barticl_Hmnia   to Barticl.Barticl_Hmnia
39445>>>>>                Set piA_Barticl_No      to Barticl.Barticl_No
39446>>>>>                Set psA_Barticl_Code1   to Barticl.Barticl_Code1
39447>>>>>
39447>>>>>                Set pdA_Garticl_Hmnia   to Barticl.Barticl_Hmnia  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
39448>>>>>                Set piA_Garticl_No      to Barticl.Barticl_No
39449>>>>>                Set psA_Garticl_Aitiol  to Barticl.Barticl_Aitiol
39450>>>>>
39450>>>>>      End_Procedure   //update
39451>>>>>
39451>>>>>
39451>>>>>      Procedure Backout
39452>>>>>                Forward Send Backout
39454>>>>>
39454>>>>>                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
39454>>>>>                Set psB_Btypkin_Recr    to Barticl.Btypkin_Recr
39455>>>>>                Set pdB_Barticl_Hmnia   to Barticl.Barticl_Hmnia
39456>>>>>                Set piB_Barticl_No      to Barticl.Barticl_No
39457>>>>>                Set psB_Barticl_Code1   to Barticl.Barticl_Code1
39458>>>>>
39458>>>>>                Set pdB_Garticl_Hmnia   to Barticl.Barticl_Hmnia  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
39459>>>>>                Set piB_Garticl_No      to Barticl.Barticl_No
39460>>>>>                Set psB_Garticl_Aitiol  to Barticl.Barticl_Aitiol
39461>>>>>      End_Procedure   // backout
39462>>>>>
39462>>>>>
39462>>>>>      Procedure Creating
39463>>>>>                Forward Send Creating
39465>>>>>
39465>>>>>                //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBarticl //˜¨ Ÿ£æª á¨Ÿ¨à¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
39465>>>>>
39465>>>>>            Move (Append('',((Trim(SysCurXR.Branch_Site))+;                            (Trim(String(Barticl.Barticl_Rec0)))))) to Barticl.Barticl_Recr
39466>>>>>
39466>>>>>                If (Barticl.Barticl_M_Code='') Move gs_Module_Code to Barticl.Barticl_M_Code
39469>>>>>
39469>>>>>                //************************************************************************
39469>>>>>                //flag 5:˜¬«æ£˜«ž ˜¨åŸ£ž©ž                                               *
39469>>>>>                //************************************************************************
39469>>>>>                If (Btypkin.Btypkin_Flag05 = TRUE);                     Begin //«¦ á¨Ÿ¨¦ â®œ  ˜¬«æ£˜«ž ˜¨åŸ£ž©ž
39471>>>>>                      Add 1 to Btypkin.Btypkin_L_No
39472>>>>>                      Move Btypkin.Btypkin_L_No  to Barticl.Barticl_No
39473>>>>>                     End
39473>>>>>>
39473>>>>>                Else Begin //«¦ á¨Ÿ¨¦ â®œ  ®œ ¨¦¡å¤ž«ž ˜¨åŸ£ž©ž
39474>>>>>                     End
39474>>>>>>
39474>>>>>
39474>>>>>                Set piCreated_Barticl to TRUE
39475>>>>>      End_Procedure //creating
39476>>>>>
39476>>>>>
39476>>>>>      Procedure Deleting
39477>>>>>                Forward Send Deleting
39479>>>>>
39479>>>>>                //jsjsjs 24/01/2001 Sub 1 from Year.Year_NumBarticl //˜¨ Ÿ£æª á¨Ÿ¨à¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
39479>>>>>                If (Btypkin.Btypkin_L_No = Barticl.Barticl_No);                Begin //œá¤ › ˜š¨á­à «¦¤ «œ¢œ¬«˜å¦ ˜¨ Ÿ£æª !!! sos pleas check the logic!
39481>>>>>                  Sub 1 from Btypkin.Btypkin_L_No
39482>>>>>                  // js 05/09/2002
39482>>>>>                  Saverecord Btypkin
39483>>>>>                End
39483>>>>>>
39483>>>>>      End_Procedure //deleting
39484>>>>>
39484>>>>>
39484>>>>>      Procedure Operation_Not_Allowed Integer iError_Num
39485>>>>>                String lsError_Message
39486>>>>>                Case Begin
39486>>>>>                     //˜§æ validate save
39486>>>>>                     Case (iError_Num = 1001)
39488>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž †£œ¨¦£ž¤å˜ !\n\n‹ ¡¨æ«œ¨ž «žª œ¤á¨¥œàª ®¨ã©œàª ("+;                          (String(SysCurXr.Year_XrhshFrom))+")") to lsError_Message
39489>>>>>                     Case Break
39490>>>>>                     Case (iError_Num = 1002)
39493>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž †£œ¨¦£ž¤å˜ !\n\n‹œš˜¢ç«œ¨ž «žª ¢ã¥œàª ®¨ã©œàª ("+;                          (String(SysCurXr.Year_XrhshTo))+")") to lsError_Message
39494>>>>>                     Case Break
39495>>>>>                     Case (iError_Num = 1003)
39498>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "ƒâ¤ œ§ «¨â§œ«˜  ˜¢˜šã «ç§¦¬ ¡å¤ž©žª!");                          to lsError_Message
39499>>>>>                     Case Break
39500>>>>>                     Case (iError_Num = 1004)
39503>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n† ž£œ¨¦£ž¤å˜ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ «¦ á¨Ÿ¨¦!");                          to lsError_Message
39504>>>>>                     Case Break
39505>>>>>                     Case (iError_Num = 1005)
39508>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\nŽ ˜¨ Ÿ£æª «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ «¦ á¨Ÿ¨¦!");                          to lsError_Message
39509>>>>>                     Case Break
39510>>>>>                     Case (iError_Num = 1006)
39513>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n† ˜ « ¦¢¦šå˜ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ «¦ á¨Ÿ¨¦!");                          to lsError_Message
39514>>>>>                     Case Break
39515>>>>>                     Case (iError_Num = 1007)
39518>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n‹ž›œ¤ ¡æª ˜¨ Ÿ£æª §˜¨˜©«˜« ¡¦ç !");                          to lsError_Message
39519>>>>>                     Case Break
39520>>>>>                     Case (iError_Num = 1008)
39523>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "ƒâ¤ œ§ «¨â§œ«˜  ˜¢˜šã ©¬¤˜¢¢˜©¦£â¤¦¬!");                          to lsError_Message
39524>>>>>                     Case Break
39525>>>>>                     Case (iError_Num = 1009)
39528>>>>>                          Clear Codemast
39529>>>>>                          Move "MODULE" to Codemast.Type
39530>>>>>                          Move Barticl.Barticl_M_Code to Codemast.Code
39531>>>>>                          Find Eq Codemast by Index.1 //type+code
39532>>>>>>
39532>>>>>                          Move ("DDC 036:€›ç¤˜«ž ž „šš¨˜­ã\n\n(’¦ á¨Ÿ¨¦ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§æ "+;                          (Trim(Codemast.Description))+" )") to lsError_Message
39533>>>>>                     Case Break
39534>>>>>                     Case (iError_Num = 1011)
39537>>>>>                          Move ("DDC 036:€›ç¤˜«ž ž „šš¨˜­ã\n\n(ƒœ¤ â®œ  ¦¨ ©Ÿœå «¦ ¡ç¡¢à£˜!)");                          to lsError_Message
39538>>>>>                     Case Break
39539>>>>>                     Case (iError_Num = 1100)
39542>>>>>                          Move "DDC 036:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
39543>>>>>                          Case Break
39544>>>>>                     
39544>>>>>                     Case (iError_Num = 2100)
39547>>>>>                          Move "DDC 036:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
39548>>>>>                          Case Break
39549>>>>>
39549>>>>>                   //˜§æ update
39549>>>>>                   Case (iError_Num = 3001)
39552>>>>>                        Move ("DDC 036:ƒâ¤ ™¨âŸž¡œ ¦ ¡à› ¡æª "+ (Trim(Barticl.Barticl_Code1)) + " ©«ã ‚œ¤ ¡ã Š¦š ©« ¡ã !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
39553>>>>>                   Case Break
39554>>>>>                   Case (iError_Num = 3002)
39557>>>>>                        Move ("DDC 036:ƒâ¤ ™¨âŸž¡œ ¦ ¡à› ¡æª "+ (Trim(Barticl.Barticl_Code1)) + " ©«ã ‚œ¤ ¡ã Š¦š ©« ¡ã š ˜ «¦¤ œ¢á«ž !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
39558>>>>>                   Case Break
39559>>>>>                   Case (iError_Num = 3003)
39562>>>>>                        Move ("DDC 036:ƒâ¤ ™¨âŸž¡œ ¦ ¡à› ¡æª "+ (Trim(Barticl.Barticl_Code1)) + " ©«ã ‚œ¤ ¡ã Š¦š ©« ¡ã š ˜ «¦¤ ¨¦£žŸœ¬«ã !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
39563>>>>>                   Case Break
39564>>>>>
39564>>>>>                     Case Else
39564>>>>>                          Forward Send Operation_Not_Allowed iError_Num
39566>>>>>                Case End
39566>>>>>
39566>>>>>                Error iError_Num lsError_Message
39567>>>>>>
39567>>>>>      End_Procedure // operation_not_allowed
39568>>>>>
39568>>>>>      Function Validate_Save Returns Integer
39569>>>>>               Integer iReturnVal
39570>>>>>
39570>>>>>               Forward Get Validate_Save to iReturnVal
39572>>>>>               //Set piCreated_Barticl to 0
39572>>>>>
39572>>>>>               If (Not(iReturnVal));               Begin
39574>>>>>                //1001+1002:â¢œš®¦  ž£œ¨¦£ž¤å˜ª
39574>>>>>                If (Not(Barticl.Barticl_Hmnia >= SysCurXr.Year_XrhshFrom )) Send Operation_Not_Allowed 1001
39577>>>>>                If (Not(Barticl.Barticl_Hmnia <= SysCurXr.Year_XrhshTo   )) Send Operation_Not_Allowed 1002
39580>>>>>
39580>>>>>                //1007:â¢œš®¦ª ˜¨ Ÿ£¦ç §˜¨˜©«˜« ¡¦ç
39580>>>>>                If (Not(Barticl.Barticl_No     >  0                  )) Send Operation_Not_Allowed 1007
39583>>>>>                
39583>>>>>                
39583>>>>>                //1011:â¢œš®¦ª £ã ¡œ¤¦ç module œšš¨˜­ãª
39583>>>>>                If (Trim(Barticl.Barticl_M_Code)="")       Send Operation_Not_Allowed 1011
39586>>>>>                //---------«â¢¦ª œ¢âš®à¤ create & edit barticl record----------------------
39586>>>>>
39586>>>>>                //---------â¢œš®¦  create barticl record----------------------
39586>>>>>                //sososo £ž§àª §¨œ§œ  ¤˜ §˜ ¥à £œ «ž¤ current record ????
39586>>>>>                If (Barticl.Recnum =  0);                Begin //œá¤ ›ž£ ¦¬¨šé ¤â¦ record
39588>>>>>                End   //«â¢¦ª œ¢âš®à¤ ›ž£ ¦¬¨šå˜ª ¤â¦¬ barticl record
39588>>>>>>
39588>>>>>
39588>>>>>                //---------â¢œš®¦  editing existing barticl records-------------------
39588>>>>>                Else;                Begin //edit an existing record
39589>>>>>                      //1003:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent btypkin record
39589>>>>>                      If (Not;                          ((psB_Btypkin_Recr(Self)) = Btypkin.Btypkin_Recr);                         )                                              Send Operation_Not_Allowed 1003
39592>>>>>                      //1004:«¨¦§¦§¦åž©ž (edit) barticl_hmnia £æ¤¦¤ ˜§æ barticl_dd
39592>>>>>                      If (;                           ((pdB_Barticl_Hmnia(Self))     <> Barticl.Barticl_Hmnia) and;                           ((Main_File(OPERATION_ORIGIN)) <> Barticl.File_Number);                         )                                              Send Operation_Not_Allowed 1004
39595>>>>>                      //1005:«¨¦§¦§¦åž©ž (edit) barticl_no £æ¤¦¤ ˜§æ barticl_dd
39595>>>>>                      If (;                           ((piB_Barticl_No   (Self))     <> Barticl.Barticl_No) and;                           ((Main_File(OPERATION_ORIGIN)) <> Barticl.File_Number);                         )                                              Send Operation_Not_Allowed 1005
39598>>>>>
39598>>>>>
39598>>>>>                      //1006:«¨¦§¦§¦åž©ž (edit) barticl_aitiol £æ¤¦¤ ˜§æ barticl_dd
39598>>>>>                      If (;                           ((psB_Garticl_Aitiol(Self))    <> Barticl.Barticl_Aitiol) and;                           ((Main_File(OPERATION_ORIGIN)) <> Barticl.File_Number) ;                         )                                              Send Operation_Not_Allowed 1006
39601>>>>>
39601>>>>>
39601>>>>>
39601>>>>>                      //1008:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã barticl_code1 (©¬¤˜¢¢˜©¦£â¤¦¬)
39601>>>>>                      If (Not;                          ((psB_Barticl_Code1(Self)) = Barticl.Barticl_Code1);                         )                                              Send Operation_Not_Allowed 1008
39604>>>>>                End   //«â¢¦ª œ¢âš®à¤ editing existing barticl record
39604>>>>>>
39604>>>>>                If ( ;                    (Not(Barticl.Company_Code = Syscurxr.Company_Code)) or;                    (Not(Barticl.Branch_Code  = Syscurxr.Branch_Code )) or;                    (Not(Barticl.Year_Year    = Syscurxr.Year_Year   ));                    )                                                   Send Operation_Not_Allowed 1100
39607>>>>>
39607>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
39607>>>>>>
39607>>>>>               Function_Return iReturnVal
39608>>>>>      End_Function   // validate_save
39609>>>>>
39609>>>>>
39609>>>>>      Function Validate_Delete  Returns Integer
39610>>>>>               Integer iReturnVal
39611>>>>>               Forward Get Validate_Delete  To iReturnVal
39613>>>>>               If (Not(iReturnVal));               Begin
39615>>>>>                    If ( ;                        (Not(Barticl.Company_Code = Syscurxr.Company_Code)) or;                        (Not(Barticl.Branch_Code  = Syscurxr.Branch_Code )) or;                        (Not(Barticl.Year_Year    = Syscurxr.Year_Year   ));                        )                                                   Send Operation_Not_Allowed 2100
39618>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
39618>>>>>>
39618>>>>>               Function_Return iReturnVal
39619>>>>>      End_Function   // Validate_Delete
39620>>>>>
39620>>>>>
39620>>>>>
39620>>>>>      Procedure Request_Save
39621>>>>>               Integer liGarticl_Rec0 liCmove_Rec0 liVmove_Rec0 iErrorObj
39622>>>>>
39622>>>>>               Send private.Initialize_Properties //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties
39623>>>>>
39623>>>>>               //ž cascade update «¨â®œ  £æ¤¦¤ ©œ existing barticl records
39623>>>>>               //æ«˜¤ ›ž£ ¦¬¨šé ¤â¦ record, «æ«œ ›â¤ ®¨œ á¦£˜  «å§¦«˜
39623>>>>>               If ((Current_Record(Self)) = 0) Begin
39625>>>>>                    Forward Send Request_Save
39627>>>>>                    Send private.Initialize_Properties //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties
39628>>>>>                    Procedure_Return
39629>>>>>               End
39629>>>>>>
39629>>>>>
39629>>>>>               //æ«˜¤ ¡á¤à edit existing record, §¨â§œ  ¤˜ «¨â®à «ž¤ cascade update
39629>>>>>               //š ˜ ¤˜ â¤ž£œ¨é©à (œá¤ ­¬© ¡á ®¨œ áœ«˜ ) «˜ child bmoves
39629>>>>>               //£œ « ª ˜¢¢˜šâª «à¤ 3 foreign §œ›åà¤ «¦¬ barticl
39629>>>>>               //(btypkin_code+barticl_hmnia+barticl_no)
39629>>>>>               //§¨æª «¦ §˜¨æ¤ ›â¤ œ§ «¨â§œ«˜  ˜¢¢˜šã «¦¬ btypkin.
39629>>>>>
39629>>>>>               BEGIN_TRANSACTION
39630>>>>>               Move Error_Object_ID to iErrorObj
39631>>>>>               Forward Send Request_Save
39633>>>>>
39633>>>>>               //˜¤áš¤à©ž rec0's «à¤ ˜¤«å©«¦ ®à¤ articl's «à¤ ¢¦ §é¤ modules
39633>>>>>               Get Field_Current_Value Field Barticl.Garticl_Rec0 to liGarticl_Rec0
39634>>>>>               Get Field_Current_Value Field Barticl.Carticl_Rec0 to liCmove_Rec0
39635>>>>>               Get Field_Current_Value Field Barticl.Varticl_Rec0 to liVmove_Rec0
39636>>>>>
39636>>>>>               Send private.Transaction_Cascade_Update_Bmove //cascade œ¤ž£â¨à©ž bmove
39637>>>>>
39637>>>>>               END_TRANSACTION
39638>>>>>               Move iErrorObj to Error_Object_ID
39639>>>>>               Send private.Initialize_Properties //£ž›œ¤ ©£æª properties š ˜ œ§æ£œ¤ž ¡å¤ž©ž
39640>>>>>
39640>>>>>               //œ§˜¤˜­¦¨á «¦¬ system indicator err
39640>>>>>               Indicate Err False
39641>>>>>     End_Procedure   // request_save
39642>>>>>
39642>>>>>
39642>>>>>     //ž ¨¦¬«å¤˜ ˜¬«ã ˜¤˜¢˜£™á¤œ  ¤˜ ¡á¤œ  cascade update ©«¦ bmove
39642>>>>>     //¡˜¢œå«˜  ˜§æ «ã¤ request save, £â©˜ ˜§æ transaction, £æ¤¦¤ š ˜ existing barticl records.
39642>>>>>     //œ§ ©«¨â­œ  ¢áŸž :
39642>>>>>     Procedure private.Transaction_Cascade_Update_Bmove
39643>>>>>               Integer liBmove_dd
39644>>>>>
39644>>>>>               //§˜¢˜ âª ¡˜  ¤âœª « £âª «¦¬ barticl
39644>>>>>               String   lsB_Btypkin_Recr     lsA_Btypkin_Recr
39644>>>>>               Date     ldB_Barticl_Hmnia    ldA_Barticl_Hmnia
39644>>>>>               Integer  liB_Barticl_No       liA_Barticl_No
39644>>>>>
39644>>>>>               //˜¤áš¤à©ž §˜¢˜ é¤ « £é¤ barticl
39644>>>>>               Get psB_Btypkin_Recr    to lsB_Btypkin_Recr
39645>>>>>               Get pdB_Barticl_Hmnia   to ldB_Barticl_Hmnia
39646>>>>>               Get piB_Barticl_No      to liB_Barticl_No
39647>>>>>
39647>>>>>               //˜¤áš¤à©ž ¤âà¤ « £é¤ barticl
39647>>>>>               Get psA_Btypkin_Recr    to lsA_Btypkin_Recr
39648>>>>>               Get pdA_Barticl_Hmnia   to ldA_Barticl_Hmnia
39649>>>>>               Get piA_Barticl_No      to liA_Barticl_No
39650>>>>>
39650>>>>>               //œá¤ æ¢œª ¦  « £âª before+after œå¤˜  å©œª,
39650>>>>>               //«æ«œ ›â¤ £§˜å¤à ¡˜Ÿæ¢¦¬ ©«¦¤ ¡æ§¦ ¤˜ «¨â¥à,
39650>>>>>               //˜¢¢á ­œçšà ...«¨â®¦¤«˜ª!
39650>>>>>               If (;                    (lsB_Btypkin_Recr   = lsA_Btypkin_Recr   ) and;                    (ldB_Barticl_Hmnia  = ldA_Barticl_Hmnia  ) and;                    (liB_Barticl_No     = liA_Barticl_No     )    ;                   ) Begin
39652>>>>>                      Procedure_Return
39653>>>>>                     End
39653>>>>>>
39653>>>>>
39653>>>>>
39653>>>>>               //**************************************************************************
39653>>>>>               //02.rebuild constraints, ¢æšà «à¤ ¡¢á©œà¤
39653>>>>>               //**************************************************************************
39653>>>>>               Get piBmove_dd           to liBmove_dd
39654>>>>>               Send Rebuild_Constraints to (piBtypkin_dd(Self))
39655>>>>>               Send Rebuild_Constraints to Self
39656>>>>>               Send Rebuild_Constraints to (piBaxio_dd  (Self))
39657>>>>>               Send Rebuild_Constraints to liBmove_dd
39658>>>>>
39658>>>>>               //**************************************************************************
39658>>>>>               //03.©á¨à©ž Bmove
39658>>>>>               //**************************************************************************
39658>>>>>               Send Clear to liBmove_dd
39659>>>>>               Send Find to liBmove_dd FIRST_RECORD 3 //barticl_recr+bmove_rec0
39660>>>>>               While (Found=1)
39664>>>>>                      Send Request_Save to liBmove_dd
39665>>>>>                      Send Find to liBmove_dd NEXT_RECORD 3 //Barticl_recr+Bmove_rec0
39666>>>>>               Loop
39667>>>>>>
39667>>>>>               Send Find to liBmove_dd FIRST_RECORD 3 //barticl_rec0+bmove_rec0
39668>>>>>               //send check_arthro_for_ypol (› æ«  £§¦¨œå ¤˜ ˜¢¢á¥œ   ©¦« £å˜ !)
39668>>>>>     End_Procedure //private.transaction_cascade_update_bmove
39669>>>>>
39669>>>>>
39669>>>>>
39669>>>>>     //ž ¨¦¬«å¤˜ ˜¬«ã ˜¤˜¢˜£™á¤œ  ¤˜ œ¤ž£œ¨é©œ  æ©˜ ˜§¦ «˜ ¬§æ¢¦ §˜ 3 modules «¦¬ ©¬©«ã£˜«¦ª
39669>>>>>     //§¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤.
39669>>>>>     //¡˜¢œå«˜  ˜§æ «åª request save & delete, £â©˜ ˜§æ transaction.
39669>>>>>     //œ§ ©«¨â­œ  ¢áŸž :
39669>>>>>     Procedure private.Transaction_Update_Other_Modules Integer liGarticl_Rec0;                                                        Integer liCmove_Rec0;                                                        Integer liVmove_Rec0;                                                        Integer liMode
39670>>>>>
39670>>>>>               Integer liDo_GL_Maintainance liDo_CUSTOMER_Maintainance liDo_VENDOR_Maintainance
39671>>>>>               Integer liMust_Update_GL     liMust_Update_CUSTOMER     liMust_Update_VENDOR
39671>>>>>
39671>>>>>               //4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
39671>>>>>               Integer liFlag02 liFlag03 liFlag04 liFlag05
39671>>>>>
39671>>>>>               //œç¨œ©ž «à¤ ¢¦ §é¤ modules §¦¬ §¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤
39671>>>>>               Get File_Field_Current_Value File_Field Btypkin.Gtypkin_Rec0   to liMust_Update_GL
39672>>>>>               Get File_Field_Current_Value File_Field Btypkin.Ctypkin_Rec0   to liMust_Update_CUSTOMER
39673>>>>>               Get File_Field_Current_Value File_Field Btypkin.Vtypkin_Rec0   to liMust_Update_VENDOR
39674>>>>>
39674>>>>>               //˜¤áš¤à©ž «à¤ 4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
39674>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag02 to liFlag02
39675>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag03 to liFlag03
39676>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag04 to liFlag04
39677>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag05 to liFlag05
39678>>>>>
39678>>>>>     End_Procedure //private.transaction_update_other_modules
39679>>>>>
39679>>>>>
39679>>>>>    Procedure Define_Fields
39680>>>>>        Forward Send Define_Fields
39682>>>>>        //DDB-Generated-Code-Location
39682>>>>>        //DDB-DefineFieldStart
39682>>>>>
39682>>>>>        Set Main_File            To Barticl.File_Number
39683>>>>>        Set Cascade_Delete_State To FALSE
39684>>>>>
39684>>>>>
39684>>>>>        // Child (Client) file structure................
39684>>>>>        Send Add_Client_File  Bmove.File_Number
39685>>>>>        Send Add_Client_File  Bsum.File_Number
39686>>>>>
39686>>>>>        // Parent (Server) file structure...............
39686>>>>>        Send Add_Server_File  Btypkin.File_Number
39687>>>>>
39687>>>>>        // External (System) file structure.............
39687>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
39688>>>>>        Send Add_System_File  Cn.File_Number  DD_LOCK_ON_ALL
39689>>>>>
39689>>>>>        Define_Auto_Increment  Sysrecb.Barticl_Rec0  To Barticl.Barticl_Rec0
39692>>>>>
39692>>>>>        // Field-based properties.......................
39692>>>>>
39692>>>>>        // Barticl.Company_Code
39692>>>>>
39692>>>>>        // Barticl.Branch_Code
39692>>>>>
39692>>>>>        // Barticl.Year_Year
39692>>>>>
39692>>>>>        // Barticl.Btypkin_Code
39692>>>>>
39692>>>>>        // Barticl.Barticl_Hmnia
39692>>>>>        Set Field_Entry_msg        Field Barticl.Barticl_Hmnia To Shmera
39693>>>>>        Set Field_Mask_Type        Field Barticl.Barticl_Hmnia To MASK_DATE_WINDOW
39694>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_Hmnia To (Barticl(Self))
39695>>>>>
39695>>>>>        // Barticl.Barticl_No
39695>>>>>
39695>>>>>        // Barticl.Barticl_Rec0
39695>>>>>
39695>>>>>        // Barticl.Barticl_Recr
39695>>>>>
39695>>>>>        // Barticl.Btypkin_Recr
39695>>>>>
39695>>>>>        // Barticl.Barticl_Code1
39695>>>>>
39695>>>>>        // Barticl.Barticl_Epon1
39695>>>>>
39695>>>>>        // Barticl.Barticl_Code2
39695>>>>>
39695>>>>>        // Barticl.Barticl_Epon2
39695>>>>>
39695>>>>>        // Barticl.Barticl_Aitiol
39695>>>>>
39695>>>>>        // Barticl.Barticl_Sv2
39695>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Sv2 To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
39695>>>>>
39695>>>>>        // Barticl.Barticl_Sv0
39695>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Sv0 To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
39695>>>>>
39695>>>>>        // Barticl.Barticl_Sv00
39695>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Sv00 To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
39695>>>>>
39695>>>>>        // Barticl.Barticl_Svr
39695>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Svr To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
39695>>>>>
39695>>>>>        // Barticl.Barticl_Lines
39695>>>>>
39695>>>>>        // Barticl.Barticl_Bmovela
39695>>>>>
39695>>>>>        // Barticl.Barticl_M_Code
39695>>>>>        Set Field_Value_Table      Field Barticl.Barticl_M_Code To (Barticl_Barticl_M_Code_VT(Self))
39696>>>>>
39696>>>>>        // Barticl.Garticl_Rec0
39696>>>>>
39696>>>>>        // Barticl.Carticl_Rec0
39696>>>>>
39696>>>>>        // Barticl.Varticl_Rec0
39696>>>>>
39696>>>>>        // Barticl.Gmove_Mrec0
39696>>>>>
39696>>>>>        // Barticl.Gplan_Mrec0
39696>>>>>
39696>>>>>        // Barticl.Client_Mrecr
39696>>>>>
39696>>>>>        // Barticl.Barticl_Ekleise
39696>>>>>
39696>>>>>        // Barticl.Cmoves_Recr
39696>>>>>
39696>>>>>        // Barticl.Isotimia
39696>>>>>
39696>>>>>        // Barticl.Cn_Code
39696>>>>>        Set Field_Prompt_Object    Field Barticl.Cn_Code To (sl041(Self))
39697>>>>>
39697>>>>>        // Barticl.Cn_Descr
39697>>>>>
39697>>>>>        // Barticl.Cn_Recr
39697>>>>>
39697>>>>>        // Barticl.Sls_Id
39697>>>>>
39697>>>>>        // Barticl.Cnt_Id
39697>>>>>
39697>>>>>        // Barticl.Presp_Id
39697>>>>>
39697>>>>>        // Barticl.Se_Logik
39697>>>>>
39697>>>>>        // Barticl.Sxolia1
39697>>>>>
39697>>>>>        // Barticl.Sxolia2
39697>>>>>
39697>>>>>        // Barticl.Partl_Akyr_Recr
39697>>>>>
39697>>>>>        //DDB-DefineFieldEnd
39697>>>>>
39697>>>>>//        Set Main_File            To Barticl.File_Number
39697>>>>>
39697>>>>>//        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
39697>>>>>//        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
39697>>>>>//        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39697>>>>>
39697>>>>>//        // Child (Client) file structure................
39697>>>>>//        Send Add_Client_File  Bsum.File_Number
39697>>>>>//        Send Add_Client_File  Bmove.File_Number
39697>>>>>
39697>>>>>//        // Parent (Server) file structure...............
39697>>>>>//        Send Add_Server_File  Btypkin.File_Number
39697>>>>>
39697>>>>>//        // External (System) file structure.............
39697>>>>>//        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
39697>>>>>//        //Send Add_System_File  Gplan.File_Number  DD_LOCK_ON_SAVE
39697>>>>>
39697>>>>>//        Define_Auto_Increment  Sysrecb.Barticl_Rec0  To Barticl.Barticl_Rec0
39697>>>>>
39697>>>>>        // Field-based properties.......................
39697>>>>>
39697>>>>>        // Barticl.Company_Code
39697>>>>>
39697>>>>>        // Barticl.Branch_Code
39697>>>>>
39697>>>>>        // Barticl.Year_Year
39697>>>>>
39697>>>>>        // Barticl.Btypkin_Code
39697>>>>>
39697>>>>>        // Barticl.Barticl_Hmnia
39697>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Hmnia    To "†£/¤å˜"
39698>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Hmnia    To "†£/¤å˜"
39699>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_Hmnia    To (Barticl(Self))
39700>>>>>
39700>>>>>        // Barticl.Barticl_No
39700>>>>>        Set Field_Label_Long       Field Barticl.Barticl_No       To "€¨ Ÿ£æª"
39701>>>>>        Set Field_Label_Short      Field Barticl.Barticl_No       To "€¨ Ÿ£æª"
39702>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_No       To (Barticl(Self))
39703>>>>>
39703>>>>>        // Barticl.Barticl_Rec0
39703>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_Rec0     To (Barticl(Self))
39704>>>>>        Set Key_Field_State        Field Barticl.Barticl_Rec0     To TRUE
39705>>>>>
39705>>>>>        // Barticl.Btypkin_Rec0
39705>>>>>
39705>>>>>        // Barticl.Barticl_Code1
39705>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Code1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª"
39706>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Code1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª"
39707>>>>>
39707>>>>>        // Barticl.Barticl_Epon1
39707>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Epon1    To "„§à¤¬£å˜"
39708>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Epon1    To "„§à¤¬£å˜"
39709>>>>>
39709>>>>>        // Barticl.Barticl_Code2
39709>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Code2    To "˜¨˜¢ã§«žª"
39710>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Code2    To "˜¨˜¢ã§«žª"
39711>>>>>
39711>>>>>        // Barticl.Barticl_Epon2
39711>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Epon2    To "„§à¤¬£å˜"
39712>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Epon2    To "„§à¤¬£å˜"
39713>>>>>
39713>>>>>        // Barticl.Barticl_Aitiol
39713>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Aitiol   To "€ « ¦¢¦šå˜"
39714>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Aitiol   To "€ « ¦¢¦šå˜"
39715>>>>>
39715>>>>>        // Barticl.Barticl_Sv2
39715>>>>>        Set Field_Options          Field Barticl.Barticl_Sv2      To DD_DISPLAYONLY
39716>>>>>
39716>>>>>        // Barticl.Barticl_Sv0
39716>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Sv0      To "‘ç¤¦¢˜ €¥ é¤ ‘œ ‰ç¨ ¦ Œæ£ ©£˜ •¨ã©žª"
39717>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Sv0      To "‘ç¤¦¢˜"
39718>>>>>        Set Field_Options          Field Barticl.Barticl_Sv0      To DD_DISPLAYONLY
39719>>>>>
39719>>>>>        // Barticl.Barticl_Sv00
39719>>>>>        Set Field_Options          Field Barticl.Barticl_Sv00     To DD_DISPLAYONLY
39720>>>>>
39720>>>>>        // Barticl.Barticl_Svr
39720>>>>>        Set Field_Options          Field Barticl.Barticl_Svr      To DD_DISPLAYONLY
39721>>>>>
39721>>>>>        // Barticl.Barticl_Lines
39721>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Lines    To "’œ£á® ˜"
39722>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Lines    To "’œ£á® ˜"
39723>>>>>        Set Field_Options          Field Barticl.Barticl_Lines    To DD_DISPLAYONLY
39724>>>>>
39724>>>>>        // Barticl.Barticl_Bmovela
39724>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Bmovela  To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª ‚¨˜££ãª"
39725>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Bmovela  To "’œ¢. €¨.‚¨˜££ãª"
39726>>>>>        Set Field_Options          Field Barticl.Barticl_Bmovela  To DD_DISPLAYONLY
39727>>>>>
39727>>>>>        // Barticl.Barticl_M_Code
39727>>>>>        Set Field_Label_Long       Field Barticl.Barticl_M_Code   To "Module „šš¨˜­ãª"
39728>>>>>        Set Field_Label_Short      Field Barticl.Barticl_M_Code   To "Module „šš¨˜­ãª"
39729>>>>>        Set Field_Options          Field Barticl.Barticl_M_Code   To DD_DISPLAYONLY
39730>>>>>        Set Field_Value_Table      Field Barticl.Barticl_M_Code   To (Barticl_Barticl_M_Code_VT(Self))
39731>>>>>
39731>>>>>        // Barticl.Garticl_Rec0
39731>>>>>        Set Field_Options          Field Barticl.Garticl_Rec0     To DD_DISPLAYONLY
39732>>>>>
39732>>>>>        // Barticl.Carticl_Rec0
39732>>>>>        Set Field_Options          Field Barticl.Carticl_Rec0     To DD_DISPLAYONLY
39733>>>>>
39733>>>>>        // Barticl.Varticl_Rec0
39733>>>>>        Set Field_Options          Field Barticl.Varticl_Rec0     To DD_DISPLAYONLY
39734>>>>>
39734>>>>>        // Barticl.Gmove_Mrec0
39734>>>>>        Set Field_Options          Field Barticl.Gmove_Mrec0      To DD_DISPLAYONLY
39735>>>>>
39735>>>>>        // Barticl.Gplan_Mrec0
39735>>>>>        Set Field_Options          Field Barticl.Gplan_Mrec0      To DD_DISPLAYONLY
39736>>>>>
39736>>>>>    End_Procedure    // Define_Fields
39737>>>>>
39737>>>>>
39737>>>>>    Procedure Field_Defaults
39738>>>>>        Forward Send Field_Defaults
39740>>>>>        //DDB-Generated-Code-Location
39740>>>>>        //DDB-FieldDefaultStart
39740>>>>>        //DDB-FieldDefaultEnd
39740>>>>>    End_Procedure    // Field_Defaults
39741>>>>>
39741>>>>>End_Class    // Barticl_DataDictionary
39742>>>>>//DDB-Selection-pkg-Start
39742>>>>>
39742>>>>>Use Barticl.SL       // Barticl
INCLUDING FILE: BARTICL.SL
39742>>>>>>>//AB/ Project Barticl:Lookup
39742>>>>>>>//AB/ Object prj is a Lookup_Project
39742>>>>>>>//AB/     Set ProjectName to "Barticl:Lookup"
39742>>>>>>>//AB/     Set ProjectFileName to "Barticl.SL"
39742>>>>>>>
39742>>>>>>>// Project Object Structure
39742>>>>>>>//   Barticl is a dbModalPanelSub
39742>>>>>>>//     Btypkin_DD2 is a Btypkin_DataDictionary
39742>>>>>>>//     Btypkin_DD is a DataDictionary
39742>>>>>>>//     Barticl_DD is a DataDictionary
39742>>>>>>>//     Country_DD is a DataDictionary
39742>>>>>>>//     Towns_DD is a DataDictionary
39742>>>>>>>//     Cities_DD is a DataDictionary
39742>>>>>>>//     Areas_DD is a DataDictionary
39742>>>>>>>//     Payresp_DD is a DataDictionary
39742>>>>>>>//     Clients_DD is a DataDictionary
39742>>>>>>>//     oSelList is a dbListSub
39742>>>>>>>//     Btypkin_Btypkin_Code is a dbFormSub
39742>>>>>>>//     Btypkin_Btypkin_Descr is a dbFormSub
39742>>>>>>>//     Clients_Client_Name is a dbFormSub
39742>>>>>>>//     cSyDateForm1 is a cSyDateForm
39742>>>>>>>//     chkOpen is a CheckBoxSub
39742>>>>>>>//     ButtonSub1 is a ButtonSub
39742>>>>>>>//     oOK_bn is a ButtonSub
39742>>>>>>>//     oCancel_bn is a ButtonSub
39742>>>>>>>
39742>>>>>>>// Register all objects
39742>>>>>>>Register_Object Areas_DD
39742>>>>>>>Register_Object Barticl
39742>>>>>>>Register_Object Barticl_DD
39742>>>>>>>Register_Object Btypkin_Btypkin_Code
39742>>>>>>>Register_Object Btypkin_Btypkin_Descr
39742>>>>>>>Register_Object Btypkin_DD
39742>>>>>>>Register_Object Btypkin_DD2
39742>>>>>>>Register_Object ButtonSub1
39742>>>>>>>Register_Object Cities_DD
39742>>>>>>>Register_Object Clients_Client_Name
39742>>>>>>>Register_Object Clients_DD
39742>>>>>>>Register_Object Country_DD
39742>>>>>>>Register_Object chkOpen
39742>>>>>>>Register_Object cSyDateForm1
39742>>>>>>>Register_Object oCancel_bn
39742>>>>>>>Register_Object oOK_bn
39742>>>>>>>Register_Object oSelList
39742>>>>>>>Register_Object Payresp_DD
39742>>>>>>>Register_Object Towns_DD
39742>>>>>>>
39742>>>>>>>
39742>>>>>>>//AB-IgnoreStart
39742>>>>>>>
39742>>>>>>>Use DFAllEnt.pkg
39742>>>>>>>Use dbList.Sub
39742>>>>>>>Use dbForm.Sub
39742>>>>>>>Use cSyDateForm.Pkg
INCLUDING FILE: CSYDATEFORM.PKG
39742>>>>>>>>>Use cSyDateIntelliMix.pkg
INCLUDING FILE: CSYDATEINTELLIMIX.PKG
39742>>>>>>>>>>>Use cOutlook.Sl // Needed for date prompt.
INCLUDING FILE: COUTLOOK.SL
39742>>>>>>>>>>>>>//AB/ Project Calendar Outlook
39742>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
39742>>>>>>>>>>>>>//AB/         Set ProjectName to "Calendar Outlook"
39742>>>>>>>>>>>>>//AB/         Set ProjectFileName to "coutlook.sl"
39742>>>>>>>>>>>>>
39742>>>>>>>>>>>>>// Project Object Structure
39742>>>>>>>>>>>>>//   oCalendar is a BasicPanelSub
39742>>>>>>>>>>>>>//     Container3d1 is a Container3d
39742>>>>>>>>>>>>>//       Grid2 is a Grid
39742>>>>>>>>>>>>>//         cOutlookFloatingMenu is a FloatingPopupMenu
39742>>>>>>>>>>>>>//       Textbox2 is a Textbox
39742>>>>>>>>>>>>>//       Textbox3 is a Textbox
39742>>>>>>>>>>>>>//       Textbox4 is a Textbox
39742>>>>>>>>>>>>>//       Textbox5 is a Textbox
39742>>>>>>>>>>>>>//       Textbox6 is a Textbox
39742>>>>>>>>>>>>>//       Textbox7 is a Textbox
39742>>>>>>>>>>>>>//       Textbox8 is a Textbox
39742>>>>>>>>>>>>>//       LineControl1 is a LineControl
39742>>>>>>>>>>>>>//       Container3d2 is a Container3d
39742>>>>>>>>>>>>>//         oRght is a BitmapContainer
39742>>>>>>>>>>>>>//         oLeft is a BitmapContainer
39742>>>>>>>>>>>>>//         oMonth is a Textbox
39742>>>>>>>>>>>>>//           oSelectMonth is a FloatingPopupMenu
39742>>>>>>>>>>>>>//         oCalendarYear is a Textbox
39742>>>>>>>>>>>>>//         oSelectCalendarYear is a Form
39742>>>>>>>>>>>>>//     BitmapContainer3 is a BitmapContainer
39742>>>>>>>>>>>>>//     oToday is a Textbox
39742>>>>>>>>>>>>>//     oCloseCalendar_bn is a BitmapContainer
39742>>>>>>>>>>>>>//     Help_Container is a Container3d
39742>>>>>>>>>>>>>//       Help_Info is a Edit
39742>>>>>>>>>>>>>//         HelpFloatingMenu is a FloatingPopupMenu
39742>>>>>>>>>>>>>
39742>>>>>>>>>>>>>// Register all objects
39742>>>>>>>>>>>>>Register_Object BitmapContainer3
39742>>>>>>>>>>>>>Register_Object Container3d1
39742>>>>>>>>>>>>>Register_Object Container3d2
39742>>>>>>>>>>>>>Register_Object cOutlookFloatingMenu
39742>>>>>>>>>>>>>Register_Object Grid2
39742>>>>>>>>>>>>>Register_Object Help_Container
39742>>>>>>>>>>>>>Register_Object Help_Info
39742>>>>>>>>>>>>>Register_Object HelpFloatingMenu
39742>>>>>>>>>>>>>Register_Object LineControl1
39742>>>>>>>>>>>>>Register_Object oCalendar
39742>>>>>>>>>>>>>Register_Object oCalendarYear
39742>>>>>>>>>>>>>Register_Object oCloseCalendar_bn
39742>>>>>>>>>>>>>Register_Object oLeft
39742>>>>>>>>>>>>>Register_Object oMonth
39742>>>>>>>>>>>>>Register_Object oRght
39742>>>>>>>>>>>>>Register_Object oSelectCalendarYear
39742>>>>>>>>>>>>>Register_Object oSelectMonth
39742>>>>>>>>>>>>>Register_Object oToday
39742>>>>>>>>>>>>>Register_Object Textbox2
39742>>>>>>>>>>>>>Register_Object Textbox3
39742>>>>>>>>>>>>>Register_Object Textbox4
39742>>>>>>>>>>>>>Register_Object Textbox5
39742>>>>>>>>>>>>>Register_Object Textbox6
39742>>>>>>>>>>>>>Register_Object Textbox7
39742>>>>>>>>>>>>>Register_Object Textbox8
39742>>>>>>>>>>>>>
39742>>>>>>>>>>>>>
39742>>>>>>>>>>>>>
39742>>>>>>>>>>>>>    //AB-StoreTopStart
39742>>>>>>>>>>>>>    Use dates.utl
39742>>>>>>>>>>>>>
39742>>>>>>>>>>>>>
39742>>>>>>>>>>>>>    //AB-StoreTopEnd
39742>>>>>>>>>>>>>
39742>>>>>>>>>>>>>    //AB-IgnoreStart
39742>>>>>>>>>>>>>
39742>>>>>>>>>>>>>    Use Panel.Sub
39742>>>>>>>>>>>>>    Use DFAllEnt.pkg
39742>>>>>>>>>>>>>
39742>>>>>>>>>>>>>
39742>>>>>>>>>>>>>
39742>>>>>>>>>>>>>    //AB-IgnoreEnd
39742>>>>>>>>>>>>>
39742>>>>>>>>>>>>>    Object oCalendar is a BasicPanelSub
39744>>>>>>>>>>>>>        Set Border_Style to Border_Normal
39745>>>>>>>>>>>>>        Set Caption_Bar to FALSE
39746>>>>>>>>>>>>>        Set Label to "January, 2001"
39747>>>>>>>>>>>>>        Set Size to 98 123
39748>>>>>>>>>>>>>        Set Location to 10 22
39749>>>>>>>>>>>>>        Set Color to clWhite
39750>>>>>>>>>>>>>        Set Exit_Application_Local_State to TRUE
39751>>>>>>>>>>>>>        Set Popup_State to TRUE
39752>>>>>>>>>>>>>
39752>>>>>>>>>>>>>        //AB-DDOStart
39752>>>>>>>>>>>>>
39752>>>>>>>>>>>>>
39752>>>>>>>>>>>>>        //AB-DDOEnd
39752>>>>>>>>>>>>>
39752>>>>>>>>>>>>>        Object Container3d1 is a Container3d
39754>>>>>>>>>>>>>            Set Size to 88 135
39755>>>>>>>>>>>>>            Set Location to -2 -1
39756>>>>>>>>>>>>>            Set Color to clWhite
39757>>>>>>>>>>>>>            Set Border_Style to Border_None
39758>>>>>>>>>>>>>            Object Grid2 is a Grid
39760>>>>>>>>>>>>>
39760>>>>>>>>>>>>>                //AB-StoreTopStart
39760>>>>>>>>>>>>>                property date    p_current_date     0
39762>>>>>>>>>>>>>                property integer p_current_year     -1
39764>>>>>>>>>>>>>                property integer p_current_month    -1
39766>>>>>>>>>>>>>                property integer p_selected_day     -1
39768>>>>>>>>>>>>>                property integer pExportState       1
39770>>>>>>>>>>>>>                property integer invoking_object_id 0
39772>>>>>>>>>>>>>                Property integer piCurrentDayItem   -1
39774>>>>>>>>>>>>>
39774>>>>>>>>>>>>>                Set Border_Style To BORDER_NONE
39775>>>>>>>>>>>>>                Set header_visible_state To False
39776>>>>>>>>>>>>>                set select_mode to no_select
39777>>>>>>>>>>>>>                Set Gridline_mode To GRID_VISIBLE_NONE
39778>>>>>>>>>>>>>
39778>>>>>>>>>>>>>                on_key Key_F1 Send Help
39779>>>>>>>>>>>>>                on_key key_ctrl+key_pgup send prev_year
39780>>>>>>>>>>>>>                on_key key_ctrl+key_pgdn send next_year
39781>>>>>>>>>>>>>                on_key          key_pgup send prev_month
39782>>>>>>>>>>>>>                on_key          key_pgdn send next_month
39783>>>>>>>>>>>>>                on_key key_enter         send move_value_out
39784>>>>>>>>>>>>>                on_key key_ctrl+key_d    send go_today
39785>>>>>>>>>>>>>                on_key key_ctrl+key_y    send Change_Year
39786>>>>>>>>>>>>>
39786>>>>>>>>>>>>>                //AB-StoreTopEnd
39786>>>>>>>>>>>>>
39786>>>>>>>>>>>>>                Set Color to clWhite
39787>>>>>>>>>>>>>                Set CurrentCellColor to clWhite
39788>>>>>>>>>>>>>                Set CurrentCellTextColor to clWhite
39789>>>>>>>>>>>>>                Set Size to 61 145
39790>>>>>>>>>>>>>                Set Location to 30 1
39791>>>>>>>>>>>>>                Set Resize_Column_state to FALSE
39792>>>>>>>>>>>>>
39792>>>>>>>>>>>>>                Set Line_Width to 7 0
39793>>>>>>>>>>>>>
39793>>>>>>>>>>>>>                Set Form_Width    item 0 to 18
39794>>>>>>>>>>>>>                Set Header_Label  item 0 to "Mo"
39795>>>>>>>>>>>>>
39795>>>>>>>>>>>>>                Set Form_Width    item 1 to 18
39796>>>>>>>>>>>>>                Set Header_Label  item 1 to "Tu"
39797>>>>>>>>>>>>>
39797>>>>>>>>>>>>>                Set Form_Width    item 2 to 18
39798>>>>>>>>>>>>>                Set Header_Label  item 2 to "We"
39799>>>>>>>>>>>>>
39799>>>>>>>>>>>>>                Set Form_Width    item 3 to 18
39800>>>>>>>>>>>>>                Set Header_Label  item 3 to "Th"
39801>>>>>>>>>>>>>
39801>>>>>>>>>>>>>                Set Form_Width    item 4 to 18
39802>>>>>>>>>>>>>                Set Header_Label  item 4 to "Fr"
39803>>>>>>>>>>>>>
39803>>>>>>>>>>>>>                Set Form_Width    item 5 to 18
39804>>>>>>>>>>>>>                Set Header_Label  item 5 to "Sa"
39805>>>>>>>>>>>>>
39805>>>>>>>>>>>>>                Set Form_Width    item 6 to 18
39806>>>>>>>>>>>>>                Set Header_Label  item 6 to "Su"
39807>>>>>>>>>>>>>
39807>>>>>>>>>>>>>
39807>>>>>>>>>>>>>                //AB-StoreStart
39807>>>>>>>>>>>>>
39807>>>>>>>>>>>>>                Procedure Change_Year
39809>>>>>>>>>>>>>                    Send Mouse_Down to (oCalendarYear(Container3d2(Self)))
39810>>>>>>>>>>>>>                End_Procedure // Change_Year
39811>>>>>>>>>>>>>
39811>>>>>>>>>>>>>                procedure go_today
39813>>>>>>>>>>>>>                    Date date#
39814>>>>>>>>>>>>>                    sysdate4 date#
39815>>>>>>>>>>>>>                    set p_current_date to date#
39816>>>>>>>>>>>>>                    Send Update_Calendar
39817>>>>>>>>>>>>>                end_procedure
39818>>>>>>>>>>>>>
39818>>>>>>>>>>>>>                procedure next_month
39820>>>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
39821>>>>>>>>>>>>>                    Send Update_Calendar
39822>>>>>>>>>>>>>                end_procedure
39823>>>>>>>>>>>>>
39823>>>>>>>>>>>>>                procedure prev_month
39825>>>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
39826>>>>>>>>>>>>>                    Send Update_Calendar
39827>>>>>>>>>>>>>                end_procedure
39828>>>>>>>>>>>>>
39828>>>>>>>>>>>>>                procedure next_year
39830>>>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
39831>>>>>>>>>>>>>                    Send Update_Calendar
39832>>>>>>>>>>>>>                end_procedure
39833>>>>>>>>>>>>>
39833>>>>>>>>>>>>>                procedure prev_year
39835>>>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
39836>>>>>>>>>>>>>                    Send Update_Calendar
39837>>>>>>>>>>>>>                end_procedure
39838>>>>>>>>>>>>>
39838>>>>>>>>>>>>>                Procedure Activate
39840>>>>>>>>>>>>>                    Date date#
39841>>>>>>>>>>>>>                    Forward Send Activate
39843>>>>>>>>>>>>>                    Set current_item to (p_selected_day(Self))
39844>>>>>>>>>>>>>                End_Procedure
39845>>>>>>>>>>>>>
39845>>>>>>>>>>>>>                Procedure Update_Calendar
39847>>>>>>>>>>>>>                    Set Dynamic_Update_State To False
39848>>>>>>>>>>>>>                    send Fill_List
39849>>>>>>>>>>>>>                    Set Dynamic_Update_State To True
39850>>>>>>>>>>>>>                    // Send Update_Label
39850>>>>>>>>>>>>>                    Set current_item to (p_selected_day(Self))
39851>>>>>>>>>>>>>                    Send Date_Changing to (oCalendarYear(Container3d2(self)))
39852>>>>>>>>>>>>>                    Send Date_Changing to (oMonth(Container3d2(self)))
39853>>>>>>>>>>>>>                End_Procedure
39854>>>>>>>>>>>>>
39854>>>>>>>>>>>>>                Procedure Fill_List
39856>>>>>>>>>>>>>                    Integer iFor prevdate# date# first_item# last_item# day# prev_last# nextdate# next_first#
39857>>>>>>>>>>>>>                    Integer cur_year# cur_month# cur_day# sel_month# sel_day# sel_year#
39857>>>>>>>>>>>>>                    Date dToday
39857>>>>>>>>>>>>>                    Send Delete_Data
39858>>>>>>>>>>>>>
39858>>>>>>>>>>>>>                    Get p_current_date to date#
39859>>>>>>>>>>>>>
39859>>>>>>>>>>>>>                    SysDate4 dToday
39860>>>>>>>>>>>>>                    move (DateSegment(dToday,DS_DAY)) to cur_day#
39861>>>>>>>>>>>>>                    move (DateSegment(dToday,DS_MONTH)) to cur_month#
39862>>>>>>>>>>>>>                    move (DateSegment(dToday,DS_YEAR)) to cur_year#
39863>>>>>>>>>>>>>
39863>>>>>>>>>>>>>                    move (DateSegment(date#,DS_DAY)) to sel_day#
39864>>>>>>>>>>>>>                    move (DateSegment(date#,DS_MONTH)) to sel_month#
39865>>>>>>>>>>>>>                    move (DateSegment(date#,DS_YEAR)) to sel_year#
39866>>>>>>>>>>>>>                    Set p_current_month To sel_month#
39867>>>>>>>>>>>>>                    Set p_current_year To sel_year#
39868>>>>>>>>>>>>>
39868>>>>>>>>>>>>>                    move (FirstDayInMonth(date#)) to date#
39869>>>>>>>>>>>>>                    move (DateDayNumber(date#)-1) to first_item#
39870>>>>>>>>>>>>>                    move (LastDayInMonth(date#)-date#+first_item#) to last_item#
39871>>>>>>>>>>>>>                    move (DateIncrement(date#,DS_Month,-1)) To prevdate#
39872>>>>>>>>>>>>>                    move (DateSegment((LastDayInMonth(prevdate#)),DS_DAY)) to prev_last#
39873>>>>>>>>>>>>>
39873>>>>>>>>>>>>>                    If (first_item# > 0) Begin
39875>>>>>>>>>>>>>                        Move (first_item#-1) to day#
39876>>>>>>>>>>>>>                        For iFor from 0 to (first_item#-1)
39882>>>>>>>>>>>>>>
39882>>>>>>>>>>>>>                            Send Add_Item msg_move_value_out (prev_last#-day#)
39883>>>>>>>>>>>>>                            Set Entry_State Item iFor To False
39884>>>>>>>>>>>>>                            Set ItemTextColor Item iFor To clGray
39885>>>>>>>>>>>>>                            Decrement day#
39886>>>>>>>>>>>>>                        Loop
39887>>>>>>>>>>>>>>
39887>>>>>>>>>>>>>                    End
39887>>>>>>>>>>>>>>
39887>>>>>>>>>>>>>
39887>>>>>>>>>>>>>                    Move 1 To day#
39888>>>>>>>>>>>>>                    For iFor from first_item# to last_item#
39894>>>>>>>>>>>>>>
39894>>>>>>>>>>>>>                        Send Add_Item Msg_Move_Value_Out day#
39895>>>>>>>>>>>>>                        Set Entry_State Item iFor To False
39896>>>>>>>>>>>>>                        If ((cur_month# eq sel_month#)and(cur_year# eq sel_year#)and(Day# eq cur_day#)) Begin
39898>>>>>>>>>>>>>                            Set Form_Bitmap Item iFor To "cdate.bmp"
39899>>>>>>>>>>>>>                            Set piCurrentDayItem to iFor
39900>>>>>>>>>>>>>                        End
39900>>>>>>>>>>>>>>
39900>>>>>>>>>>>>>                        If Day# eq sel_day# Set p_selected_day To iFor
39903>>>>>>>>>>>>>                        Set Form_justification_mode Item iFor To FORM_DISPLAYRIGHT
39904>>>>>>>>>>>>>                        Set form_datatype item iFor To mask_numeric_window
39905>>>>>>>>>>>>>                        Set form_Mask item iFor To "## "
39906>>>>>>>>>>>>>                        Increment day#
39907>>>>>>>>>>>>>                    Loop
39908>>>>>>>>>>>>>>
39908>>>>>>>>>>>>>
39908>>>>>>>>>>>>>                    move (DateIncrement(date#,DS_Month,1)) To nextdate#
39909>>>>>>>>>>>>>                    move (DateSegment((LastDayInMonth(nextdate#)),DS_DAY)) to next_first#
39910>>>>>>>>>>>>>
39910>>>>>>>>>>>>>                    If (last_item# < 41) Begin
39912>>>>>>>>>>>>>                        Move 1 to day#
39913>>>>>>>>>>>>>                        For iFor from (last_item#+1) to 41
39919>>>>>>>>>>>>>>
39919>>>>>>>>>>>>>                            Send Add_Item msg_move_value_out day#
39920>>>>>>>>>>>>>                            Set Entry_State Item iFor To False
39921>>>>>>>>>>>>>                            Set ItemTextColor Item iFor To clGray
39922>>>>>>>>>>>>>                            Increment day#
39923>>>>>>>>>>>>>                        Loop
39924>>>>>>>>>>>>>>
39924>>>>>>>>>>>>>                    End
39924>>>>>>>>>>>>>>
39924>>>>>>>>>>>>>
39924>>>>>>>>>>>>>                End_Procedure
39925>>>>>>>>>>>>>
39925>>>>>>>>>>>>>                Procedure Help
39927>>>>>>>>>>>>>                    //Send Info_Box ("<Up>, <Dn>, <Lft>, <Rgt> - select date.\n<PgUp>, <PgDn> - select month.\n<Ctrl>+<D> - set current date.\n<Ctrl>+<Y> - select year.\n<Ctrl>+<PgUp>, <PgDn> - Select year.") ("Help on Calendar")
39927>>>>>>>>>>>>>                    Set Visible_State of Help_Container to True
39928>>>>>>>>>>>>>                    Set Enabled_State of Help_Container to True
39929>>>>>>>>>>>>>                    Send Activate to Help_Container
39930>>>>>>>>>>>>>                End_Procedure
39931>>>>>>>>>>>>>
39931>>>>>>>>>>>>>                procedure mouse_click integer window integer char_pos
39933>>>>>>>>>>>>>                    Send Move_Value_Out
39934>>>>>>>>>>>>>                    forward send mouse_click window char_pos
39936>>>>>>>>>>>>>                end_procedure
39937>>>>>>>>>>>>>
39937>>>>>>>>>>>>>                Procedure Move_Value_Out
39939>>>>>>>>>>>>>                    Integer iYear iMonth iDay iItm
39940>>>>>>>>>>>>>                    Date Date# next_date# prev_date#
39940>>>>>>>>>>>>>                    Get Current_Item To iItm
39941>>>>>>>>>>>>>                    If (pExportState(Self)) Begin
39943>>>>>>>>>>>>>                        Get Value Item iItm To iDay
39944>>>>>>>>>>>>>                        Get p_current_month to iMonth
39945>>>>>>>>>>>>>                        Get p_current_year  to iYear
39946>>>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
39947>>>>>>>>>>>>>
39947>>>>>>>>>>>>>                        If ((iItm>27)and(iDay<15)) Begin
39949>>>>>>>>>>>>>                            Move (DateCompose(1,iMonth,iYear)) To next_date#
39950>>>>>>>>>>>>>                            move (DateIncrement(next_date#,DS_Month,1)) To next_date#
39951>>>>>>>>>>>>>                            move (DateSegment(next_date#,DS_MONTH)) to iMonth
39952>>>>>>>>>>>>>                            move (DateSegment(next_date#,DS_YEAR)) to iYear
39953>>>>>>>>>>>>>                            move (DateCompose(iDay,iMonth,iYear)) to date#
39954>>>>>>>>>>>>>                        End
39954>>>>>>>>>>>>>>
39954>>>>>>>>>>>>>                        If ((iItm<7)and(iDay>20)) Begin
39956>>>>>>>>>>>>>                            Move (DateCompose(1,iMonth,iYear)) To prev_date#
39957>>>>>>>>>>>>>                            move (DateIncrement(prev_date#,DS_Month,-1)) To prev_date#
39958>>>>>>>>>>>>>                            move (DateSegment(prev_date#,DS_MONTH)) to iMonth
39959>>>>>>>>>>>>>                            move (DateSegment(prev_date#,DS_YEAR)) to iYear
39960>>>>>>>>>>>>>                            move (DateCompose(iDay,iMonth,iYear)) to date#
39961>>>>>>>>>>>>>                        End
39961>>>>>>>>>>>>>>
39961>>>>>>>>>>>>>
39961>>>>>>>>>>>>>                        Send Export_Date date#
39962>>>>>>>>>>>>>                    End
39962>>>>>>>>>>>>>>
39962>>>>>>>>>>>>>                End_Procedure
39963>>>>>>>>>>>>>
39963>>>>>>>>>>>>>                Procedure Export_Date date date#
39965>>>>>>>>>>>>>                    local integer focus# dm# margin# datatype#
39966>>>>>>>>>>>>>                    get invoking_object_id to focus#
39967>>>>>>>>>>>>>
39967>>>>>>>>>>>>>                    if focus# gt desktop begin
39969>>>>>>>>>>>>>                         get delegation_mode of focus# to dm#
39970>>>>>>>>>>>>>                         set delegation_mode of focus# to no_delegate_or_error
39971>>>>>>>>>>>>>                         get form_margin of focus# item current to margin#
39972>>>>>>>>>>>>>                         get form_datatype of focus# item current to datatype#
39973>>>>>>>>>>>>>                         set delegation_mode of focus# to dm#
39974>>>>>>>>>>>>>                         if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to date#
39977>>>>>>>>>>>>>                         else             set value of focus# item current to (Date4to2(date#))
39979>>>>>>>>>>>>>                         set item_changed_state of focus# item current to true
39980>>>>>>>>>>>>>                    end
39980>>>>>>>>>>>>>>
39980>>>>>>>>>>>>>                    Send Close_Calendar
39981>>>>>>>>>>>>>                End_Procedure
39982>>>>>>>>>>>>>
39982>>>>>>>>>>>>>                Object cOutlookFloatingMenu is a FloatingPopupMenu
39984>>>>>>>>>>>>>
39984>>>>>>>>>>>>>                    Procedure Close_Calendar
39986>>>>>>>>>>>>>                        Send Close_Calendar to (oCalendar(Self))
39987>>>>>>>>>>>>>                    End_Procedure // Close_Calendar
39988>>>>>>>>>>>>>
39988>>>>>>>>>>>>>                    Send Add_item msg_go_today         t.calendar.today
39989>>>>>>>>>>>>>                    Send Add_item msg_None             ""
39990>>>>>>>>>>>>>                    Send Add_Item msg_prev_year        t.calendar.PrevYear
39991>>>>>>>>>>>>>                    Send Add_Item msg_next_year        t.calendar.NextYear
39992>>>>>>>>>>>>>                    Send Add_Item msg_prev_month       t.calendar.PrevMonth
39993>>>>>>>>>>>>>                    Send Add_Item msg_next_month       t.calendar.NextMonth
39994>>>>>>>>>>>>>                    Send Add_item msg_None             ""
39995>>>>>>>>>>>>>                    Send Add_Item msg_move_value_out   t.calendar.Select
39996>>>>>>>>>>>>>                    Send Add_item msg_None             ""
39997>>>>>>>>>>>>>                    Send Add_item msg_Close_Calendar   t.calendar.Cancel
39998>>>>>>>>>>>>>                End_Object // cOutlookFloatingMenu
39999>>>>>>>>>>>>>
39999>>>>>>>>>>>>>                Set floating_menu_object to (cOutlookFloatingMenu(Self))
40000>>>>>>>>>>>>>
40000>>>>>>>>>>>>>                procedure item_change integer fromi integer toi returns integer
40002>>>>>>>>>>>>>                    Integer new_item liMonth
40003>>>>>>>>>>>>>                    Date    ldSysdate
40003>>>>>>>>>>>>>                    forward get msg_item_change fromi toi to new_item
40005>>>>>>>>>>>>>                    If (Focus(Desktop) = Self) Begin
40007>>>>>>>>>>>>>                        If (new_item >= 0) Begin
40009>>>>>>>>>>>>>                            Sysdate4 ldSysdate
40010>>>>>>>>>>>>>                            Move (TheMonthSegment(ldSysdate)) to liMonth
40011>>>>>>>>>>>>>                            If ((p_current_month(Self) = liMonth) and (piCurrentDayItem(Self) = fromi)) Set Form_Bitmap Item fromi to "Cdate.bmp"
40014>>>>>>>>>>>>>                            Else Set Form_Bitmap Item fromi to ""
40016>>>>>>>>>>>>>                            If (((p_current_month(Self) = liMonth) and (piCurrentDayItem(Self) <> new_item)) or;                                 (p_current_month(Self) <> liMonth)) Set Form_Bitmap Item new_item   to "Cdate1.bmp"
40019>>>>>>>>>>>>>                        End
40019>>>>>>>>>>>>>>
40019>>>>>>>>>>>>>                    End
40019>>>>>>>>>>>>>>
40019>>>>>>>>>>>>>                    procedure_return new_item
40020>>>>>>>>>>>>>                End_Procedure // Current_Item
40021>>>>>>>>>>>>>
40021>>>>>>>>>>>>>
40021>>>>>>>>>>>>>
40021>>>>>>>>>>>>>                //AB-StoreEnd
40021>>>>>>>>>>>>>
40021>>>>>>>>>>>>>            End_Object    // Grid2
40022>>>>>>>>>>>>>
40022>>>>>>>>>>>>>            Object Textbox2 is a Textbox
40024>>>>>>>>>>>>>                Set Label to "Mo"
40025>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
40026>>>>>>>>>>>>>                Set Transparent_State to TRUE
40027>>>>>>>>>>>>>                Set Color to clWhite
40028>>>>>>>>>>>>>                Set TextColor to clNavy
40029>>>>>>>>>>>>>                Set Location to 19 4
40030>>>>>>>>>>>>>                Set Size to 10 15
40031>>>>>>>>>>>>>
40031>>>>>>>>>>>>>                //AB-StoreStart
40031>>>>>>>>>>>>>
40031>>>>>>>>>>>>>                Set Label To (left(t.calendar.Monday,2))
40032>>>>>>>>>>>>>                //AB-StoreEnd
40032>>>>>>>>>>>>>
40032>>>>>>>>>>>>>            End_Object    // Textbox2
40033>>>>>>>>>>>>>
40033>>>>>>>>>>>>>            Object Textbox3 is a Textbox
40035>>>>>>>>>>>>>                Set Label to "Tu"
40036>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
40037>>>>>>>>>>>>>                Set Transparent_State to TRUE
40038>>>>>>>>>>>>>                Set Color to clWhite
40039>>>>>>>>>>>>>                Set TextColor to clNavy
40040>>>>>>>>>>>>>                Set Location to 19 22
40041>>>>>>>>>>>>>                Set Size to 10 12
40042>>>>>>>>>>>>>
40042>>>>>>>>>>>>>                //AB-StoreStart
40042>>>>>>>>>>>>>
40042>>>>>>>>>>>>>                Set Label To (left(t.calendar.Tuesday,2))
40043>>>>>>>>>>>>>                //AB-StoreEnd
40043>>>>>>>>>>>>>
40043>>>>>>>>>>>>>            End_Object    // Textbox3
40044>>>>>>>>>>>>>
40044>>>>>>>>>>>>>            Object Textbox4 is a Textbox
40046>>>>>>>>>>>>>                Set Label to "We"
40047>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
40048>>>>>>>>>>>>>                Set Transparent_State to TRUE
40049>>>>>>>>>>>>>                Set Color to clWhite
40050>>>>>>>>>>>>>                Set TextColor to clNavy
40051>>>>>>>>>>>>>                Set Location to 19 39
40052>>>>>>>>>>>>>                Set Size to 10 15
40053>>>>>>>>>>>>>
40053>>>>>>>>>>>>>                //AB-StoreStart
40053>>>>>>>>>>>>>
40053>>>>>>>>>>>>>                Set Label To (left(t.calendar.Wednesday,2))
40054>>>>>>>>>>>>>                //AB-StoreEnd
40054>>>>>>>>>>>>>
40054>>>>>>>>>>>>>            End_Object    // Textbox4
40055>>>>>>>>>>>>>
40055>>>>>>>>>>>>>            Object Textbox5 is a Textbox
40057>>>>>>>>>>>>>                Set Label to "Th"
40058>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
40059>>>>>>>>>>>>>                Set Transparent_State to TRUE
40060>>>>>>>>>>>>>                Set Color to clWhite
40061>>>>>>>>>>>>>                Set TextColor to clNavy
40062>>>>>>>>>>>>>                Set Location to 19 57
40063>>>>>>>>>>>>>                Set Size to 10 17
40064>>>>>>>>>>>>>
40064>>>>>>>>>>>>>                //AB-StoreStart
40064>>>>>>>>>>>>>
40064>>>>>>>>>>>>>                Set Label To (left(t.calendar.Thursday,2))
40065>>>>>>>>>>>>>                //AB-StoreEnd
40065>>>>>>>>>>>>>
40065>>>>>>>>>>>>>            End_Object    // Textbox5
40066>>>>>>>>>>>>>
40066>>>>>>>>>>>>>            Object Textbox6 is a Textbox
40068>>>>>>>>>>>>>                Set Label to "Fr"
40069>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
40070>>>>>>>>>>>>>                Set Transparent_State to TRUE
40071>>>>>>>>>>>>>                Set Color to clWhite
40072>>>>>>>>>>>>>                Set TextColor to clNavy
40073>>>>>>>>>>>>>                Set Location to 19 76
40074>>>>>>>>>>>>>                Set Size to 10 17
40075>>>>>>>>>>>>>
40075>>>>>>>>>>>>>                //AB-StoreStart
40075>>>>>>>>>>>>>
40075>>>>>>>>>>>>>                Set Label To (left(t.calendar.Friday,2))
40076>>>>>>>>>>>>>                //AB-StoreEnd
40076>>>>>>>>>>>>>
40076>>>>>>>>>>>>>            End_Object    // Textbox6
40077>>>>>>>>>>>>>
40077>>>>>>>>>>>>>            Object Textbox7 is a Textbox
40079>>>>>>>>>>>>>                Set Label to "Sa"
40080>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
40081>>>>>>>>>>>>>                Set Transparent_State to TRUE
40082>>>>>>>>>>>>>                Set Color to clWhite
40083>>>>>>>>>>>>>                Set TextColor to clNavy
40084>>>>>>>>>>>>>                Set Location to 19 91
40085>>>>>>>>>>>>>                Set Size to 10 18
40086>>>>>>>>>>>>>
40086>>>>>>>>>>>>>                //AB-StoreStart
40086>>>>>>>>>>>>>
40086>>>>>>>>>>>>>                Set Label To (left(t.calendar.Saturday,2))
40087>>>>>>>>>>>>>                //AB-StoreEnd
40087>>>>>>>>>>>>>
40087>>>>>>>>>>>>>            End_Object    // Textbox7
40088>>>>>>>>>>>>>
40088>>>>>>>>>>>>>            Object Textbox8 is a Textbox
40090>>>>>>>>>>>>>                Set Label to "Su"
40091>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
40092>>>>>>>>>>>>>                Set Transparent_State to TRUE
40093>>>>>>>>>>>>>                Set Color to clWhite
40094>>>>>>>>>>>>>                Set TextColor to clNavy
40095>>>>>>>>>>>>>                Set Location to 19 109
40096>>>>>>>>>>>>>                Set Size to 10 17
40097>>>>>>>>>>>>>
40097>>>>>>>>>>>>>                //AB-StoreStart
40097>>>>>>>>>>>>>
40097>>>>>>>>>>>>>                Set Label To (left(t.calendar.Sunday,2))
40098>>>>>>>>>>>>>                //AB-StoreEnd
40098>>>>>>>>>>>>>
40098>>>>>>>>>>>>>            End_Object    // Textbox8
40099>>>>>>>>>>>>>
40099>>>>>>>>>>>>>            Object LineControl1 is a LineControl
40101>>>>>>>>>>>>>                Set Line_Style to lnSINGLE
40102>>>>>>>>>>>>>                Set Size to 1 116
40103>>>>>>>>>>>>>                Set Location to 28 4
40104>>>>>>>>>>>>>
40104>>>>>>>>>>>>>                //AB-StoreStart
40104>>>>>>>>>>>>>
40104>>>>>>>>>>>>>                //AB-StoreEnd
40104>>>>>>>>>>>>>
40104>>>>>>>>>>>>>            End_Object    // LineControl1
40105>>>>>>>>>>>>>
40105>>>>>>>>>>>>>            Object Container3d2 is a Container3d
40107>>>>>>>>>>>>>                Set Size to 18 131
40108>>>>>>>>>>>>>                Set Location to 1 1
40109>>>>>>>>>>>>>                Set Color to clNavy
40110>>>>>>>>>>>>>                Set Border_Style to Border_None
40111>>>>>>>>>>>>>                Object oRght is a BitmapContainer
40113>>>>>>>>>>>>>                    Set Size to 10 14
40114>>>>>>>>>>>>>                    Set Location to 4 105
40115>>>>>>>>>>>>>                    Set Bitmap to "rght.bmp"
40116>>>>>>>>>>>>>                    Set Border_Style to Border_None
40117>>>>>>>>>>>>>
40117>>>>>>>>>>>>>                    //AB-StoreStart
40117>>>>>>>>>>>>>                    Procedure Mouse_Down
40119>>>>>>>>>>>>>                        Send Next_Month to Grid2
40120>>>>>>>>>>>>>                    End_Procedure
40121>>>>>>>>>>>>>                    //AB-StoreEnd
40121>>>>>>>>>>>>>
40121>>>>>>>>>>>>>                End_Object    // oRght
40122>>>>>>>>>>>>>
40122>>>>>>>>>>>>>                Object oLeft is a BitmapContainer
40124>>>>>>>>>>>>>                    Set Size to 10 14
40125>>>>>>>>>>>>>                    Set Location to 4 3
40126>>>>>>>>>>>>>                    Set Bitmap to "lft.bmp"
40127>>>>>>>>>>>>>                    Set Border_Style to Border_None
40128>>>>>>>>>>>>>
40128>>>>>>>>>>>>>                    //AB-StoreStart
40128>>>>>>>>>>>>>                    Procedure Mouse_Down
40130>>>>>>>>>>>>>                        Send Prev_Month to Grid2
40131>>>>>>>>>>>>>                    End_Procedure
40132>>>>>>>>>>>>>                    //AB-StoreEnd
40132>>>>>>>>>>>>>
40132>>>>>>>>>>>>>                End_Object    // oLeft
40133>>>>>>>>>>>>>
40133>>>>>>>>>>>>>                Object oMonth is a Textbox
40135>>>>>>>>>>>>>
40135>>>>>>>>>>>>>                    //AB-StoreTopStart
40135>>>>>>>>>>>>>                    Property integer piSelected_Month public 0
40137>>>>>>>>>>>>>                    //AB-StoreTopEnd
40137>>>>>>>>>>>>>
40137>>>>>>>>>>>>>                    Set Label to "January"
40138>>>>>>>>>>>>>                    Set Auto_Size_State to FALSE
40139>>>>>>>>>>>>>                    Set Transparent_State to TRUE
40140>>>>>>>>>>>>>                    Set Color to clWhite
40141>>>>>>>>>>>>>                    Set TextColor to clWhite
40142>>>>>>>>>>>>>                    Set Location to 4 19
40143>>>>>>>>>>>>>                    Set Size to 10 46
40144>>>>>>>>>>>>>                    Set FontWeight to 800
40145>>>>>>>>>>>>>                    Set Justification_Mode to jMode_Center
40146>>>>>>>>>>>>>
40146>>>>>>>>>>>>>                    //AB-StoreStart
40146>>>>>>>>>>>>>
40146>>>>>>>>>>>>>                    Procedure Mouse_Down
40148>>>>>>>>>>>>>                        Integer iState
40149>>>>>>>>>>>>>                        Get Visible_State of oSelectCalendarYear to iState
40150>>>>>>>>>>>>>                        If (iState) Send OnKillFocus to oSelectCalendarYear
40153>>>>>>>>>>>>>                        Send Popup to oSelectMonth
40154>>>>>>>>>>>>>                    End_Procedure
40155>>>>>>>>>>>>>
40155>>>>>>>>>>>>>                    Procedure pSelectJan
40157>>>>>>>>>>>>>                        Set Label to t.calendar.january
40158>>>>>>>>>>>>>                        Set piSelected_Month to 1
40159>>>>>>>>>>>>>                        Send Adjust_Calendar
40160>>>>>>>>>>>>>                    End_Procedure
40161>>>>>>>>>>>>>                    Procedure pSelectFeb
40163>>>>>>>>>>>>>                        Set Label to t.calendar.february
40164>>>>>>>>>>>>>                        Set piSelected_Month to 2
40165>>>>>>>>>>>>>                        Send Adjust_Calendar
40166>>>>>>>>>>>>>                    End_Procedure
40167>>>>>>>>>>>>>                    Procedure pSelectMar
40169>>>>>>>>>>>>>                        Set Label to t.calendar.march
40170>>>>>>>>>>>>>                        Set piSelected_Month to 3
40171>>>>>>>>>>>>>                        Send Adjust_Calendar
40172>>>>>>>>>>>>>                    End_Procedure
40173>>>>>>>>>>>>>                    Procedure pSelectApr
40175>>>>>>>>>>>>>                        Set Label to t.calendar.april
40176>>>>>>>>>>>>>                        Set piSelected_Month to 4
40177>>>>>>>>>>>>>                        Send Adjust_Calendar
40178>>>>>>>>>>>>>                    End_Procedure
40179>>>>>>>>>>>>>                    Procedure pSelectMay
40181>>>>>>>>>>>>>                        Set Label to t.calendar.may
40182>>>>>>>>>>>>>                        Set piSelected_Month to 5
40183>>>>>>>>>>>>>                        Send Adjust_Calendar
40184>>>>>>>>>>>>>                    End_Procedure
40185>>>>>>>>>>>>>                    Procedure pSelectJun
40187>>>>>>>>>>>>>                        Set Label to t.calendar.june
40188>>>>>>>>>>>>>                        Set piSelected_Month to 6
40189>>>>>>>>>>>>>                        Send Adjust_Calendar
40190>>>>>>>>>>>>>                    End_Procedure
40191>>>>>>>>>>>>>                    Procedure pSelectJul
40193>>>>>>>>>>>>>                        Set Label to t.calendar.july
40194>>>>>>>>>>>>>                        Set piSelected_Month to 7
40195>>>>>>>>>>>>>                        Send Adjust_Calendar
40196>>>>>>>>>>>>>                    End_Procedure
40197>>>>>>>>>>>>>                    Procedure pSelectAug
40199>>>>>>>>>>>>>                        Set Label to t.calendar.august
40200>>>>>>>>>>>>>                        Set piSelected_Month to 8
40201>>>>>>>>>>>>>                        Send Adjust_Calendar
40202>>>>>>>>>>>>>                    End_Procedure
40203>>>>>>>>>>>>>                    Procedure pSelectSep
40205>>>>>>>>>>>>>                        Set Label to t.calendar.september
40206>>>>>>>>>>>>>                        Set piSelected_Month to 9
40207>>>>>>>>>>>>>                        Send Adjust_Calendar
40208>>>>>>>>>>>>>                    End_Procedure
40209>>>>>>>>>>>>>                    Procedure pSelectOct
40211>>>>>>>>>>>>>                        Set Label to t.calendar.october
40212>>>>>>>>>>>>>                        Set piSelected_Month to 10
40213>>>>>>>>>>>>>                        Send Adjust_Calendar
40214>>>>>>>>>>>>>                    End_Procedure
40215>>>>>>>>>>>>>                    Procedure pSelectNov
40217>>>>>>>>>>>>>                        Set Label to t.calendar.november
40218>>>>>>>>>>>>>                        Set piSelected_Month to 11
40219>>>>>>>>>>>>>                        Send Adjust_Calendar
40220>>>>>>>>>>>>>                    End_Procedure
40221>>>>>>>>>>>>>                    Procedure pSelectDec
40223>>>>>>>>>>>>>                        Set Label to t.calendar.december
40224>>>>>>>>>>>>>                        Set piSelected_Month to 12
40225>>>>>>>>>>>>>                        Send Adjust_Calendar
40226>>>>>>>>>>>>>                    End_Procedure
40227>>>>>>>>>>>>>
40227>>>>>>>>>>>>>                    Object oSelectMonth is a FloatingPopupMenu
40229>>>>>>>>>>>>>                        Send Add_Item msg_pSelectJan t.calendar.january
40230>>>>>>>>>>>>>                        Send Add_Item msg_pSelectFeb t.calendar.february
40231>>>>>>>>>>>>>                        Send Add_Item msg_pSelectMar t.calendar.march
40232>>>>>>>>>>>>>                        Send Add_Item msg_pSelectApr t.calendar.april
40233>>>>>>>>>>>>>                        Send Add_Item msg_pSelectMay t.calendar.may
40234>>>>>>>>>>>>>                        Send Add_Item msg_pSelectJun t.calendar.june
40235>>>>>>>>>>>>>                        Send Add_Item msg_pSelectJul t.calendar.july
40236>>>>>>>>>>>>>                        Send Add_Item msg_pSelectAug t.calendar.august
40237>>>>>>>>>>>>>                        Send Add_Item msg_pSelectSep t.calendar.september
40238>>>>>>>>>>>>>                        Send Add_Item msg_pSelectOct t.calendar.october
40239>>>>>>>>>>>>>                        Send Add_Item msg_pSelectNov t.calendar.november
40240>>>>>>>>>>>>>                        Send Add_Item msg_pSelectDec t.calendar.december
40241>>>>>>>>>>>>>                    End_Object
40242>>>>>>>>>>>>>
40242>>>>>>>>>>>>>                    Procedure Adjust_Calendar
40244>>>>>>>>>>>>>                        Date date#
40245>>>>>>>>>>>>>                        Integer iDay iMonth iYear iItm
40245>>>>>>>>>>>>>                        Set Visible_State to false
40246>>>>>>>>>>>>>                        Set Visible_State to true
40247>>>>>>>>>>>>>                        Get Current_Item of (Grid2(Container3D1(Self))) to iItm
40248>>>>>>>>>>>>>                        Get value of (Grid2(Container3D1(Self))) item iItm to iDay
40249>>>>>>>>>>>>>                        Get piSelected_Month to iMonth
40250>>>>>>>>>>>>>                        Get Label of oCalendarYear to iYear
40251>>>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
40252>>>>>>>>>>>>>                        Set p_current_date of (Grid2(Container3D1(Self))) to date#
40253>>>>>>>>>>>>>                        Send Update_Calendar to (Grid2(Container3D1(Self)))
40254>>>>>>>>>>>>>                    End_Procedure
40255>>>>>>>>>>>>>
40255>>>>>>>>>>>>>                    Procedure Activating
40257>>>>>>>>>>>>>                        Forward Send Activating
40259>>>>>>>>>>>>>                        Send Date_Changing
40260>>>>>>>>>>>>>                    End_Procedure
40261>>>>>>>>>>>>>
40261>>>>>>>>>>>>>                    Procedure Date_Changing
40263>>>>>>>>>>>>>                        Set Visible_State to false
40264>>>>>>>>>>>>>                        Set Label to (MonthName(p_current_Month(Grid2(Container3D1(Self)))))
40265>>>>>>>>>>>>>                        Set piSelected_Month to (p_current_Month(Grid2(Container3D1(Self))))
40266>>>>>>>>>>>>>                        Set Visible_State to true
40267>>>>>>>>>>>>>                    End_Procedure
40268>>>>>>>>>>>>>
40268>>>>>>>>>>>>>
40268>>>>>>>>>>>>>
40268>>>>>>>>>>>>>                    //AB-StoreEnd
40268>>>>>>>>>>>>>
40268>>>>>>>>>>>>>                End_Object    // oMonth
40269>>>>>>>>>>>>>
40269>>>>>>>>>>>>>                Object oCalendarYear is a Textbox
40271>>>>>>>>>>>>>                    Set Label to "2001"
40272>>>>>>>>>>>>>                    Set Transparent_State to TRUE
40273>>>>>>>>>>>>>                    Set Color to clWhite
40274>>>>>>>>>>>>>                    Set TextColor to clWhite
40275>>>>>>>>>>>>>                    Set Location to 4 77
40276>>>>>>>>>>>>>                    Set Size to 10 18
40277>>>>>>>>>>>>>                    Set FontWeight to 800
40278>>>>>>>>>>>>>
40278>>>>>>>>>>>>>                    //AB-StoreStart
40278>>>>>>>>>>>>>
40278>>>>>>>>>>>>>                    Procedure Mouse_Down
40280>>>>>>>>>>>>>                        String sVal
40281>>>>>>>>>>>>>                        Get Label to sVal
40282>>>>>>>>>>>>>                        Set Value of oSelectCalendarYear item 0 to sVal
40283>>>>>>>>>>>>>                        Set Visible_State of oSelectCalendarYear to True
40284>>>>>>>>>>>>>                        Send Activate to (oSelectCalendarYear(Self))
40285>>>>>>>>>>>>>                    End_Procedure
40286>>>>>>>>>>>>>
40286>>>>>>>>>>>>>                    Procedure Activating
40288>>>>>>>>>>>>>                        Forward Send Activating
40290>>>>>>>>>>>>>                        Send Date_Changing
40291>>>>>>>>>>>>>                    End_Procedure
40292>>>>>>>>>>>>>
40292>>>>>>>>>>>>>                    Procedure Date_Changing
40294>>>>>>>>>>>>>                        Set Visible_State to false
40295>>>>>>>>>>>>>                        Set Label to (String(p_current_Year(Grid2(Container3D1(Self)))))
40296>>>>>>>>>>>>>                        Set Visible_State to true
40297>>>>>>>>>>>>>                    End_Procedure
40298>>>>>>>>>>>>>
40298>>>>>>>>>>>>>                    //AB-StoreEnd
40298>>>>>>>>>>>>>
40298>>>>>>>>>>>>>                End_Object    // oCalendarYear
40299>>>>>>>>>>>>>
40299>>>>>>>>>>>>>                Object oSelectCalendarYear is a Form
40301>>>>>>>>>>>>>
40301>>>>>>>>>>>>>                    //AB-StoreTopStart
40301>>>>>>>>>>>>>                    Set Visible_State To False
40302>>>>>>>>>>>>>                    //AB-StoreTopEnd
40302>>>>>>>>>>>>>
40302>>>>>>>>>>>>>                    Set Size to 10 24
40303>>>>>>>>>>>>>                    Set Location to 4 75
40304>>>>>>>>>>>>>                    Set Color to clWhite
40305>>>>>>>>>>>>>                    Set TextColor to clNavy
40306>>>>>>>>>>>>>                    Set Form_Border Item 0 to Border_Normal
40307>>>>>>>>>>>>>
40307>>>>>>>>>>>>>                    //AB-StoreStart
40307>>>>>>>>>>>>>
40307>>>>>>>>>>>>>                    On_Key Key_Enter Send OnKillFocus
40308>>>>>>>>>>>>>                    On_Key Key_Escape Send OnKillFocus
40309>>>>>>>>>>>>>
40309>>>>>>>>>>>>>                    Procedure SetFontWeight
40311>>>>>>>>>>>>>                        Set Form_FontWeight item 0 to 800
40312>>>>>>>>>>>>>                    End_Procedure
40313>>>>>>>>>>>>>
40313>>>>>>>>>>>>>                    Procedure OnKillFocus
40315>>>>>>>>>>>>>                        String sVal
40316>>>>>>>>>>>>>                        Integer iMonth iDay iYear iItm
40316>>>>>>>>>>>>>                        Date date#
40316>>>>>>>>>>>>>                        Get Value item 0 to sVal
40317>>>>>>>>>>>>>                        Set Visible_State of oCalendarYear to false
40318>>>>>>>>>>>>>                        Set Label of oCalendarYear to sVal
40319>>>>>>>>>>>>>                        Set Visible_State of oCalendarYear to true
40320>>>>>>>>>>>>>                        Set Visible_State to false
40321>>>>>>>>>>>>>                        Get Current_Item of (Grid2(Container3D1(Self))) to iItm
40322>>>>>>>>>>>>>                        Get value of (Grid2(Container3D1(Self))) item iItm to iDay
40323>>>>>>>>>>>>>                        Get piSelected_Month of oMonth to iMonth
40324>>>>>>>>>>>>>                        Get Value item 0 to iYear
40325>>>>>>>>>>>>>                        If (iYear = 0) Move 2000 to iYear
40328>>>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
40329>>>>>>>>>>>>>                        Set p_current_date of (Grid2(Container3D1(Self))) to date#
40330>>>>>>>>>>>>>                        Send Update_Calendar to (Grid2(Container3D1(Self)))
40331>>>>>>>>>>>>>                        Send Activate        to (Grid2(Container3D1(Self)))
40332>>>>>>>>>>>>>                    End_Procedure
40333>>>>>>>>>>>>>
40333>>>>>>>>>>>>>                    Send SetFontWeight
40334>>>>>>>>>>>>>
40334>>>>>>>>>>>>>
40334>>>>>>>>>>>>>
40334>>>>>>>>>>>>>                    //AB-StoreEnd
40334>>>>>>>>>>>>>
40334>>>>>>>>>>>>>                End_Object    // oSelectCalendarYear
40335>>>>>>>>>>>>>
40335>>>>>>>>>>>>>
40335>>>>>>>>>>>>>                //AB-StoreStart
40335>>>>>>>>>>>>>
40335>>>>>>>>>>>>>                Procedure Mouse_Down
40337>>>>>>>>>>>>>                    Integer iState
40338>>>>>>>>>>>>>                    Get Visible_State of oSelectCalendarYear to iState
40339>>>>>>>>>>>>>                    If (iState) Send OnKillFocus to oSelectCalendarYear
40342>>>>>>>>>>>>>                End_Procedure
40343>>>>>>>>>>>>>
40343>>>>>>>>>>>>>
40343>>>>>>>>>>>>>                //AB-StoreEnd
40343>>>>>>>>>>>>>
40343>>>>>>>>>>>>>            End_Object    // Container3d2
40344>>>>>>>>>>>>>
40344>>>>>>>>>>>>>
40344>>>>>>>>>>>>>            //AB-StoreStart
40344>>>>>>>>>>>>>
40344>>>>>>>>>>>>>
40344>>>>>>>>>>>>>            //AB-StoreEnd
40344>>>>>>>>>>>>>
40344>>>>>>>>>>>>>        End_Object    // Container3d1
40345>>>>>>>>>>>>>
40345>>>>>>>>>>>>>        Object BitmapContainer3 is a BitmapContainer
40347>>>>>>>>>>>>>            Set Size to 9 19
40348>>>>>>>>>>>>>            Set Location to 88 3
40349>>>>>>>>>>>>>            Set Color to clWhite
40350>>>>>>>>>>>>>            Set Bitmap to "cdate.bmp"
40351>>>>>>>>>>>>>            Set Border_Style to Border_None
40352>>>>>>>>>>>>>
40352>>>>>>>>>>>>>            //AB-StoreStart
40352>>>>>>>>>>>>>            Procedure Mouse_Down
40354>>>>>>>>>>>>>                Send go_today to (Grid2(Container3d1(Self)))
40355>>>>>>>>>>>>>                Send Adjust_Label to oToday
40356>>>>>>>>>>>>>            End_Procedure
40357>>>>>>>>>>>>>            //AB-StoreEnd
40357>>>>>>>>>>>>>
40357>>>>>>>>>>>>>        End_Object    // BitmapContainer3
40358>>>>>>>>>>>>>
40358>>>>>>>>>>>>>        Object oToday is a Textbox
40360>>>>>>>>>>>>>            Set Label to "Today: 01.01.2001"
40361>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
40362>>>>>>>>>>>>>            Set Color to clWhite
40363>>>>>>>>>>>>>            Set Location to 88 22
40364>>>>>>>>>>>>>            Set Size to 8 70
40365>>>>>>>>>>>>>            Set FontWeight to 800
40366>>>>>>>>>>>>>
40366>>>>>>>>>>>>>            //AB-StoreStart
40366>>>>>>>>>>>>>            Procedure Mouse_Down
40368>>>>>>>>>>>>>                Send go_today to (Grid2(Container3d1(Self)))
40369>>>>>>>>>>>>>                Send Adjust_Label
40370>>>>>>>>>>>>>            End_Procedure
40371>>>>>>>>>>>>>
40371>>>>>>>>>>>>>            Procedure Adjust_Label
40373>>>>>>>>>>>>>                date date#
40374>>>>>>>>>>>>>                SysDate4 date#
40375>>>>>>>>>>>>>                Set Visible_State To false
40376>>>>>>>>>>>>>                Set Label         to (t.calendar.today+": "+String(date#))
40377>>>>>>>>>>>>>                Set Visible_State To true
40378>>>>>>>>>>>>>            End_Procedure
40379>>>>>>>>>>>>>
40379>>>>>>>>>>>>>            Procedure Activating
40381>>>>>>>>>>>>>                Forward Send Activating
40383>>>>>>>>>>>>>                Send Adjust_Label
40384>>>>>>>>>>>>>            End_Procedure
40385>>>>>>>>>>>>>            //AB-StoreEnd
40385>>>>>>>>>>>>>
40385>>>>>>>>>>>>>        End_Object    // oToday
40386>>>>>>>>>>>>>
40386>>>>>>>>>>>>>        Object oCloseCalendar_bn is a BitmapContainer
40388>>>>>>>>>>>>>            Set Size to 9 10
40389>>>>>>>>>>>>>            Set Location to 88 112
40390>>>>>>>>>>>>>            Set Bitmap to "Cdate1.bmp"
40391>>>>>>>>>>>>>            Set Bitmap_Style to Bitmap_Center
40392>>>>>>>>>>>>>
40392>>>>>>>>>>>>>            //AB-StoreStart
40392>>>>>>>>>>>>>
40392>>>>>>>>>>>>>            Procedure Mouse_Up
40394>>>>>>>>>>>>>                Send Close_Calendar
40395>>>>>>>>>>>>>            End_Procedure // Mouse_Up
40396>>>>>>>>>>>>>
40396>>>>>>>>>>>>>
40396>>>>>>>>>>>>>
40396>>>>>>>>>>>>>
40396>>>>>>>>>>>>>            //AB-StoreEnd
40396>>>>>>>>>>>>>
40396>>>>>>>>>>>>>        End_Object    // oCloseCalendar_bn
40397>>>>>>>>>>>>>
40397>>>>>>>>>>>>>
40397>>>>>>>>>>>>>        //AB-StoreStart
40397>>>>>>>>>>>>>
40397>>>>>>>>>>>>>        Set Block_Mouse_State to True
40398>>>>>>>>>>>>>        Set Popup_State to True
40399>>>>>>>>>>>>>        Set Locate_Mode to Popup_Locate
40400>>>>>>>>>>>>>
40400>>>>>>>>>>>>>        procedure popup
40402>>>>>>>>>>>>>            local integer focus# icItm iYear iMonth
40403>>>>>>>>>>>>>            local date date#
40403>>>>>>>>>>>>>            move (focus(desktop)) to focus#
40404>>>>>>>>>>>>>            set invoking_object_id of (Grid2(Container3d1(self))) to focus#
40405>>>>>>>>>>>>>            get value of focus# item current to date#
40406>>>>>>>>>>>>>            ifnot (integer(date#)) sysdate date#
40409>>>>>>>>>>>>>            move (Date2to4(date#)) to date#
40410>>>>>>>>>>>>>            set p_current_date of (Grid2(Container3d1(self))) to date#
40411>>>>>>>>>>>>>            send fill_list to (Grid2(Container3d1(self)))
40412>>>>>>>>>>>>>            move (DateSegment(date#,DS_YEAR)) to iYear
40413>>>>>>>>>>>>>            move (DateSegment(date#,DS_MONTH)) to iMonth
40414>>>>>>>>>>>>>            Set Label To (MonthName(iMonth)+', '+String(iYear))
40415>>>>>>>>>>>>>            forward send popup
40417>>>>>>>>>>>>>        end_procedure
40418>>>>>>>>>>>>>
40418>>>>>>>>>>>>>        Procedure Close_Calendar
40420>>>>>>>>>>>>>            Send Exit
40421>>>>>>>>>>>>>        End_Procedure // Close_Calendar
40422>>>>>>>>>>>>>
40422>>>>>>>>>>>>>        Object Help_Container is a Container3d
40424>>>>>>>>>>>>>            Set Location to 0 0
40425>>>>>>>>>>>>>            Set Size     to 98 122
40426>>>>>>>>>>>>>            Set Visible_State to False
40427>>>>>>>>>>>>>            Set Enabled_State to False
40428>>>>>>>>>>>>>            Set Border_Style to Border_None
40429>>>>>>>>>>>>>            Set TextColor to clNavy
40430>>>>>>>>>>>>>
40430>>>>>>>>>>>>>            Object Help_Info is an Edit
40432>>>>>>>>>>>>>                Set Location to 0 0
40433>>>>>>>>>>>>>                Set Size     to 98 122
40434>>>>>>>>>>>>>                Set read_only_state to true
40435>>>>>>>>>>>>>                Set Border_Style to Border_None
40436>>>>>>>>>>>>>                Set scroll_bar_visible_state to False
40437>>>>>>>>>>>>>                Set FontWeight to 800
40438>>>>>>>>>>>>>
40438>>>>>>>>>>>>>                Procedure ReadHelpComments
40440>>>>>>>>>>>>>                    String lsFile
40441>>>>>>>>>>>>>
40441>>>>>>>>>>>>>                    Get_File_Path "Calendar.txt" to lsFile
40442>>>>>>>>>>>>>                    If (lsFile <> "") Send read lsFile
40445>>>>>>>>>>>>>                End_Procedure // ReadHelpComments
40446>>>>>>>>>>>>>
40446>>>>>>>>>>>>>                Procedure SetComments
40448>>>>>>>>>>>>>                    Send append_text "Help on Calendar"
40449>>>>>>>>>>>>>                    Send Insert ""
40450>>>>>>>>>>>>>                    Send Insert ""
40451>>>>>>>>>>>>>                    Send append_text "1.<Up>,<Dn>,<Lft>,<Rgt>"
40452>>>>>>>>>>>>>                    Send Insert ""
40453>>>>>>>>>>>>>                    Send append_text "  - select date."
40454>>>>>>>>>>>>>                    Send Insert ""
40455>>>>>>>>>>>>>                    Send append_text "2.<PgUp>,<PgDn>"
40456>>>>>>>>>>>>>                    Send Insert ""
40457>>>>>>>>>>>>>                    Send append_text "  - select month."
40458>>>>>>>>>>>>>                    Send Insert ""
40459>>>>>>>>>>>>>                    Send append_text "3.<Ctrl>+<D>"
40460>>>>>>>>>>>>>                    Send Insert ""
40461>>>>>>>>>>>>>                    Send append_text "  - set current date."
40462>>>>>>>>>>>>>                    Send Insert ""
40463>>>>>>>>>>>>>                    Send append_text "4.<Ctrl>+<Y>"
40464>>>>>>>>>>>>>                    Send Insert ""
40465>>>>>>>>>>>>>                    Send append_text "  - Change year."
40466>>>>>>>>>>>>>                    Send Insert ""
40467>>>>>>>>>>>>>                    Send append_text "5.<Ctrl>+<PgUp>,<PgDn>"
40468>>>>>>>>>>>>>                    Send Insert ""
40469>>>>>>>>>>>>>                    Send append_text "  - Select year."
40470>>>>>>>>>>>>>                End_procedure // SetComments
40471>>>>>>>>>>>>>
40471>>>>>>>>>>>>>                //Send SetComments
40471>>>>>>>>>>>>>                Set Color     to clWhite
40472>>>>>>>>>>>>>                Set TextColor to clNavy
40473>>>>>>>>>>>>>
40473>>>>>>>>>>>>>                Procedure OnSetFocus
40475>>>>>>>>>>>>>                    Send ReadHelpComments
40476>>>>>>>>>>>>>                End_Procedure
40477>>>>>>>>>>>>>
40477>>>>>>>>>>>>>                Object HelpFloatingMenu is a FloatingPopupMenu
40479>>>>>>>>>>>>>
40479>>>>>>>>>>>>>                    Procedure Close_Help
40481>>>>>>>>>>>>>                        Send Close_Help to Help_Container
40482>>>>>>>>>>>>>                    End_Procedure // Close_Calendar
40483>>>>>>>>>>>>>
40483>>>>>>>>>>>>>                    Send Add_item msg_Close_Help   t.calendar.Ok
40484>>>>>>>>>>>>>                End_Object // cOutlookFloatingMenu
40485>>>>>>>>>>>>>
40485>>>>>>>>>>>>>                Procedure Mouse_Up2 Integer aiWindow Integer aiChar_Pos
40487>>>>>>>>>>>>>                    Send Popup to HelpFloatingMenu
40488>>>>>>>>>>>>>                End_Procedure // Mouse_Up2
40489>>>>>>>>>>>>>
40489>>>>>>>>>>>>>            End_Object
40490>>>>>>>>>>>>>
40490>>>>>>>>>>>>>            Procedure Close_Help
40492>>>>>>>>>>>>>                Send Delete_Data to Help_Info
40493>>>>>>>>>>>>>                Set Visible_State to False
40494>>>>>>>>>>>>>                Set Enabled_State to False
40495>>>>>>>>>>>>>                Send Activate to (Grid2(Container3D1(Self)))
40496>>>>>>>>>>>>>            End_Procedure // Close_Help
40497>>>>>>>>>>>>>
40497>>>>>>>>>>>>>            On_Key kCancel Send Close_Help
40498>>>>>>>>>>>>>            On_Key Key_F1  Send Close_Help
40499>>>>>>>>>>>>>            On_Key kEnter  Send Close_Help
40500>>>>>>>>>>>>>        End_Object // Help_Info
40501>>>>>>>>>>>>>
40501>>>>>>>>>>>>>        on_key kcancel           send Close_Calendar
40502>>>>>>>>>>>>>
40502>>>>>>>>>>>>>
40502>>>>>>>>>>>>>
40502>>>>>>>>>>>>>
40502>>>>>>>>>>>>>
40502>>>>>>>>>>>>>
40502>>>>>>>>>>>>>        //AB-StoreEnd
40502>>>>>>>>>>>>>
40502>>>>>>>>>>>>>    End_Object    // oCalendar
40503>>>>>>>>>>>>>
40503>>>>>>>>>>>>>
40503>>>>>>>>>>>>>    //AB-StoreStart
40503>>>>>>>>>>>>>
40503>>>>>>>>>>>>>    Procedure Request_Popup_cOutlookCalendar for BaseClass
40504>>>>>>>>>>>>>        Integer focus# type# dm#
40505>>>>>>>>>>>>>
40505>>>>>>>>>>>>>        move (focus(desktop)) to focus#
40506>>>>>>>>>>>>>        if focus# gt desktop begin
40508>>>>>>>>>>>>>          get delegation_mode of focus# to dm#
40509>>>>>>>>>>>>>          set delegation_mode of focus# to no_delegate_or_error
40510>>>>>>>>>>>>>          get form_datatype of focus# item current to type#
40511>>>>>>>>>>>>>          if (type#=date_window or type#=mask_date_window) send popup to oCalendar
40514>>>>>>>>>>>>>          set delegation_mode of focus# to dm#
40515>>>>>>>>>>>>>        end
40515>>>>>>>>>>>>>>
40515>>>>>>>>>>>>>    End_Procedure
40516>>>>>>>>>>>>>
40516>>>>>>>>>>>>>    On_Key Key_Ctrl+Key_F1 Send Request_Popup_cOutlookCalendar
40517>>>>>>>>>>>>>    On_Key Key_Ctrl+Key_H  Send Request_Popup_cOutlookCalendar
40518>>>>>>>>>>>>>
40518>>>>>>>>>>>>>
40518>>>>>>>>>>>>>    //AB-StoreEnd
40518>>>>>>>>>>>>>
40518>>>>>>>>>>>>>//AB/     End_Object    // prj
40518>>>>>>>>>>>Use Dates.Utl
40518>>>>>>>>>>>
40518>>>>>>>>>>>   Define cStatusHelp       for "F4 = Calendar. T = Today, B = Begin of month, E = End of month."
40518>>>>>>>>>>>   Define cDateToday        for "T"
40518>>>>>>>>>>>   Define cDateBeginOfMonth for "B"
40518>>>>>>>>>>>   Define cDateEndOfMonth   for "E"
40518>>>>>>>>>>>
40518>>>>>>>>>>>Class cSyIntelliSense_Date_Mixin is a Message
40519>>>>>>>>>>>   Procedure DoDefineIntelliSenseDateMixin
40520>>>>>>>>>>>      Property Date    pdOriginal_Value          Public 0
40521>>>>>>>>>>>      Property Integer pbIntelliSense_Date_State Public dfTrue
40522>>>>>>>>>>>      Property Integer pbEnableCalendarPrompt    Public dfTrue
40523>>>>>>>>>>>      On_Key KUpArrow         Send DoAddOneDay
40524>>>>>>>>>>>      On_Key KDownArrow       Send DoSubOneDay
40525>>>>>>>>>>>   End_Procedure // DoDefineIntelliSenseDateMixin
40526>>>>>>>>>>>
40526>>>>>>>>>>>   Procedure DoAddOneDay
40527>>>>>>>>>>>        Integer rVal
40528>>>>>>>>>>>        Date dHmnia
40528>>>>>>>>>>>
40528>>>>>>>>>>>        Get Value Item 0 to dHmnia
40529>>>>>>>>>>>        Add 1 to dHmnia
40530>>>>>>>>>>>        Set Value Item 0 to dHmnia
40531>>>>>>>>>>>    End_Procedure // Add_One_Day
40532>>>>>>>>>>>
40532>>>>>>>>>>>    Procedure DoSubOneDay
40533>>>>>>>>>>>        Integer rVal
40534>>>>>>>>>>>        Date dHmnia
40534>>>>>>>>>>>
40534>>>>>>>>>>>        Get Value Item 0 to dHmnia
40535>>>>>>>>>>>        Sub 1 to dHmnia
40536>>>>>>>>>>>        Set Value Item 0 to dHmnia
40537>>>>>>>>>>>    End_Procedure // Add_One_Day
40538>>>>>>>>>>>
40538>>>>>>>>>>>   // **WvA: Augmented to store the current date-value before any changes are made
40538>>>>>>>>>>>   Procedure Entering returns Integer
40539>>>>>>>>>>>      Integer iRetVal
40540>>>>>>>>>>>      Date    dOriginal
40540>>>>>>>>>>>      Forward Get Msg_Entering to iRetVal
40542>>>>>>>>>>>      If (iRetVal = 0) Begin
40544>>>>>>>>>>>         Send DoStoreOriginalDate
40545>>>>>>>>>>>      End
40545>>>>>>>>>>>>
40545>>>>>>>>>>>      Procedure_Return iRetVal
40546>>>>>>>>>>>   End_Procedure // Entering
40547>>>>>>>>>>>
40547>>>>>>>>>>>   //**WvA: This procedure is augmented to see if the user entered a 1 or 2 digit
40547>>>>>>>>>>>   //       value with the intention to only change the day-part of the current date.
40547>>>>>>>>>>>   Procedure Next
40548>>>>>>>>>>>      Send DoIntelliSenseDate
40549>>>>>>>>>>>      Forward Send Next
40551>>>>>>>>>>>   End_Procedure // Next
40552>>>>>>>>>>>
40552>>>>>>>>>>>   // **WvA: Store the current date-value before any changes are made
40552>>>>>>>>>>>   Procedure DoStoreOriginalDate
40553>>>>>>>>>>>      Date    dOriginal
40554>>>>>>>>>>>      //If (pbIntelliSense_Date_State(Self)) Begin
40554>>>>>>>>>>>         Get Value Item 0 to dOriginal
40555>>>>>>>>>>>         Set pdOriginal_Value to dOriginal
40556>>>>>>>>>>>      //End
40556>>>>>>>>>>>   End_Procedure // DoStoreOriginalDate
40557>>>>>>>>>>>
40557>>>>>>>>>>>   Procedure DoIntelliSenseDate
40558>>>>>>>>>>>      Integer iCurrent iStored iDaysOffSet iSep iDate_Format bChanged iYear
40559>>>>>>>>>>>      Date    dCurrent dOriginal
40559>>>>>>>>>>>      String  sStored  sCurrent sSep sMask
40559>>>>>>>>>>>
40559>>>>>>>>>>>      Get Item_Changed_State Item 0 to bChanged
40560>>>>>>>>>>>      Get pdOriginal_Value to dOriginal
40561>>>>>>>>>>>      If (pbIntelliSense_Date_State(Self) And (bChanged)) Begin
40563>>>>>>>>>>>         If (dOriginal Eq 0) Sysdate4 dOriginal
40566>>>>>>>>>>>
40566>>>>>>>>>>>         // We need the masked value, because the normal value is corrected by the runtime for
40566>>>>>>>>>>>         // USA dates.
40566>>>>>>>>>>>         Get Masked_Value Item 0 to sCurrent // getting a 2 digit entered date to a datavariable results in an error.
40567>>>>>>>>>>>         Move (Replaces(" ",sCurrent,"")) to sCurrent
40568>>>>>>>>>>>         Get_Attribute DF_DATE_SEPARATOR to iSep
40571>>>>>>>>>>>         Move (Character(iSep)) to sSep
40572>>>>>>>>>>>
40572>>>>>>>>>>>         // Although the sep value is "/" in the European date format, the mask seperator is "-".
40572>>>>>>>>>>>         Move (Replaces("-",sCurrent,sSep)) to sCurrent
40573>>>>>>>>>>>         Move (sSep+sSep) to sMask
40574>>>>>>>>>>>
40574>>>>>>>>>>>         // Now check if the user just entered a day or a day and a month.
40574>>>>>>>>>>>         // Something very special is going on here. We are interpreting a string, so the format
40574>>>>>>>>>>>         // will always be the same, even for USA or Military dates. "99//" where 9 can be any number
40574>>>>>>>>>>>         //If ( (length(sCurrent) > 2) And (Right(sCurrent,2) = sMask)  ) Begin
40574>>>>>>>>>>>         If ((length(sCurrent) <= 4) And (Right(sCurrent,2) = sMask)) Begin
40576>>>>>>>>>>>            Move (replace(sMask,sCurrent,"")) to sCurrent
40577>>>>>>>>>>>            Move sCurrent to iCurrent
40578>>>>>>>>>>>            If ((iCurrent >= 1) And (iCurrent <= 31)) Begin
40580>>>>>>>>>>>               Get_Attribute DF_DATE_FORMAT to iDate_Format
40583>>>>>>>>>>>               If (iDate_Format = DF_DATE_USA) Begin
40585>>>>>>>>>>>                  Move (Mid( String(dOriginal),2,4)) to iDaysOffSet
40586>>>>>>>>>>>               End
40586>>>>>>>>>>>>
40586>>>>>>>>>>>               Else If (iDate_Format = DF_DATE_EUROPEAN) Begin
40589>>>>>>>>>>>                  Move (Left( String(dOriginal),2 )) to iDaysOffSet
40590>>>>>>>>>>>               End
40590>>>>>>>>>>>>
40590>>>>>>>>>>>               Else If (iDate_Format = DF_DATE_MILITARY) Begin
40593>>>>>>>>>>>                  Move (Right( String(dOriginal),2 )) to iDaysOffSet
40594>>>>>>>>>>>               End
40594>>>>>>>>>>>>
40594>>>>>>>>>>>               Set Value Item 0 to (Date(dOriginal - iDaysOffSet + iCurrent))
40595>>>>>>>>>>>            End // Let the runtime handle the error if value not in the range 1..31
40595>>>>>>>>>>>>
40595>>>>>>>>>>>         End
40595>>>>>>>>>>>>
40595>>>>>>>>>>>         Else If ((length(sCurrent) > 4) And (Right(sCurrent,1) = sSep)) Begin
40598>>>>>>>>>>>            Get_Attribute DF_DATE_FORMAT to iDate_Format
40601>>>>>>>>>>>            If ((iDate_Format = DF_DATE_USA) Or (iDate_Format = DF_DATE_EUROPEAN)) Begin
40603>>>>>>>>>>>               Move (Right(dOriginal,4)) to iYear
40604>>>>>>>>>>>            End
40604>>>>>>>>>>>>
40604>>>>>>>>>>>            Else If (iDate_Format = DF_DATE_MILITARY) Begin
40607>>>>>>>>>>>               Move (Left(dOriginal,4))  to iYear
40608>>>>>>>>>>>            End
40608>>>>>>>>>>>>
40608>>>>>>>>>>>            Set Value Item 0 to (Date(sCurrent + String(iYear)))
40609>>>>>>>>>>>         End
40609>>>>>>>>>>>>
40609>>>>>>>>>>>      End
40609>>>>>>>>>>>>
40609>>>>>>>>>>>   End_Procedure // DoIntelliSenseDate
40610>>>>>>>>>>>
40610>>>>>>>>>>>   Procedure Key Integer iKey Returns Integer
40611>>>>>>>>>>>      Date dToday dTemp
40612>>>>>>>>>>>      Sysdate4 dToday
40613>>>>>>>>>>>
40613>>>>>>>>>>>      If ((Character(iKey) EQ cDateToday) OR (Character(iKey) EQ Lowercase(cDateToday))) Begin
40615>>>>>>>>>>>         Set Value to dToday
40616>>>>>>>>>>>      End
40616>>>>>>>>>>>>
40616>>>>>>>>>>>      Else If ((Character(iKey) EQ cDateBeginOfMonth) OR (Character(iKey) EQ Lowercase(cDateBeginOfMonth))) Begin
40619>>>>>>>>>>>         Get FirstDayInMonth dToday to dTemp
40620>>>>>>>>>>>         Set Value to dTemp
40621>>>>>>>>>>>      End
40621>>>>>>>>>>>>
40621>>>>>>>>>>>      Else If ((Character(iKey) EQ cDateEndOfMonth) OR (Character(iKey) EQ Lowercase(cDateEndOfMonth))) Begin
40624>>>>>>>>>>>         Get LastDayInMonth dToday to dTemp
40625>>>>>>>>>>>         Set Value to dTemp
40626>>>>>>>>>>>      End
40626>>>>>>>>>>>>
40626>>>>>>>>>>>      Else Forward Send Key iKey
40629>>>>>>>>>>>   End_procedure
40630>>>>>>>>>>>
40630>>>>>>>>>>>End_Class // cSyIntelliSense_Date_Mixin
40631>>>>>>>>>
40631>>>>>>>>>Class cSyDateForm Is A FormSub
40632>>>>>>>>>   Procedure Construct_Object
40633>>>>>>>>>      Forward Send Construct_Object
40635>>>>>>>>>
40635>>>>>>>>>      Set Prompt_Button_Mode   to PB_PromptOn
40636>>>>>>>>>      Set Form_Datatype Item 0 to Mask_Date_Window
40637>>>>>>>>>
40637>>>>>>>>>      Send DoDefineIntelliSenseDateMixin
40638>>>>>>>>>
40638>>>>>>>>>      On_Key kPrompt Send Prompt
40639>>>>>>>>>
40639>>>>>>>>>      Set Prompt_Object to (oCalendar(Self))
40640>>>>>>>>>      Set Status_Help   to cStatusHelp
40641>>>>>>>>>
40641>>>>>>>>>   End_Procedure // Construct_Object
40642>>>>>>>>>
40642>>>>>>>>>   Import_Class_Protocol cSyIntelliSense_Date_Mixin
40643>>>>>>>>>
40643>>>>>>>>>//   Function Form_Datatype Integer iItem Returns Integer
40643>>>>>>>>>//      Integer iDatatype
40643>>>>>>>>>//
40643>>>>>>>>>//      If (iItem = Current) Begin
40643>>>>>>>>>//         Get Current_Item to iItem
40643>>>>>>>>>//      End
40643>>>>>>>>>//
40643>>>>>>>>>//      Forward Get Form_Datatype Item iItem to iDataType
40643>>>>>>>>>//
40643>>>>>>>>>//      Function_Return iDatatype
40643>>>>>>>>>//   End_Function // Form_Datatype
40643>>>>>>>>>
40643>>>>>>>>>End_Class // cSyDateForm
40644>>>>>>>Use Chkbox.Sub
40644>>>>>>>Use Button.Sub
40644>>>>>>>
40644>>>>>>>
40644>>>>>>>Use BTYPKIN.DD
40644>>>>>>>Use BARTICL.DD
40644>>>>>>>Use COUNTRY.DD
INCLUDING FILE: COUNTRY.DD
40644>>>>>>>>>//DDB-FileStart
40644>>>>>>>>>//DDB-HeaderStart
40644>>>>>>>>>
40644>>>>>>>>>// File Name : COUNTRY.DD
40644>>>>>>>>>// Class Name: Country_DataDictionary
40644>>>>>>>>>// Revision  : 3
40644>>>>>>>>>// Version   : 2
40644>>>>>>>>>
40644>>>>>>>>>Use  Windows           // Basic Definitions
40644>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
40644>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
40644>>>>>>>>>
40644>>>>>>>>>Open Country
40646>>>>>>>>>Open Towns
40648>>>>>>>>>
40648>>>>>>>>>//DDB-HeaderEnd
40648>>>>>>>>>//DDB-SelectionStart
40648>>>>>>>>>//DDB/ ExternalSelectionList sl058  sl058.SL
40648>>>>>>>>>Register_Object sl058
40648>>>>>>>>>//DDB-SelectionEnd
40648>>>>>>>>>
40648>>>>>>>>>Class Country_DataDictionary  is a DataDictionary_Sec
40649>>>>>>>>>
40649>>>>>>>>>    // Define_Fields:
40649>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
40649>>>>>>>>>
40649>>>>>>>>>    Procedure Define_Fields
40650>>>>>>>>>        Forward Send Define_Fields
40652>>>>>>>>>        //DDB-Generated-Code-Location
40652>>>>>>>>>        //DDB-DefineFieldStart
40652>>>>>>>>>
40652>>>>>>>>>        Set Main_File            To Country.File_Number
40653>>>>>>>>>        Set Cascade_Delete_State To FALSE
40654>>>>>>>>>
40654>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
40655>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
40656>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
40657>>>>>>>>>
40657>>>>>>>>>        // Child (Client) file structure................
40657>>>>>>>>>        Send Add_Client_File  Towns.File_Number
40658>>>>>>>>>
40658>>>>>>>>>        // Field-based properties.......................
40658>>>>>>>>>
40658>>>>>>>>>        // Country.Country_Id
40658>>>>>>>>>        Set Field_Options          Field Country.Country_Id To DD_AUTOFIND   
40659>>>>>>>>>        Set Field_Prompt_Object    Field Country.Country_Id To (sl058(Self))
40660>>>>>>>>>
40660>>>>>>>>>        // Country.Country_Descr
40660>>>>>>>>>        Set Field_Prompt_Object    Field Country.Country_Descr To (sl058(Self))
40661>>>>>>>>>
40661>>>>>>>>>        //DDB-DefineFieldEnd
40661>>>>>>>>>    End_Procedure    // Define_Fields
40662>>>>>>>>>
40662>>>>>>>>>    // Field_Defaults:
40662>>>>>>>>>    // This procedure is used to establish default field values.
40662>>>>>>>>>
40662>>>>>>>>>    Procedure Field_Defaults
40663>>>>>>>>>        Forward Send Field_Defaults
40665>>>>>>>>>        //DDB-Generated-Code-Location
40665>>>>>>>>>        //DDB-FieldDefaultStart
40665>>>>>>>>>        //DDB-FieldDefaultEnd
40665>>>>>>>>>    End_Procedure    // Field_Defaults
40666>>>>>>>>>
40666>>>>>>>>>End_Class    // Country_DataDictionary
40667>>>>>>>>>//DDB-Selection-pkg-Start
40667>>>>>>>>>
40667>>>>>>>>>Use sl058.SL         // sl058
INCLUDING FILE: SL058.SL
40667>>>>>>>>>>>//AB/ Project sl058 : Countries - Xores
40667>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
40667>>>>>>>>>>>//AB/         Set ProjectName to "sl058 : Countries - Xores"
40667>>>>>>>>>>>//AB/         Set ProjectFileName to "sl058.SL"
40667>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
40667>>>>>>>>>>>
40667>>>>>>>>>>>// Project Object Structure
40667>>>>>>>>>>>//   sl058 is a dbModalPanelSub
40667>>>>>>>>>>>//     Country_DD is a DataDictionary
40667>>>>>>>>>>>//     oSelList is a dbListSub
40667>>>>>>>>>>>//     oOK_bn is a ButtonSub
40667>>>>>>>>>>>//     oCancel_bn is a ButtonSub
40667>>>>>>>>>>>//     oSearch_bn is a ButtonSub
40667>>>>>>>>>>>
40667>>>>>>>>>>>// Register all objects
40667>>>>>>>>>>>Register_Object Country_DD
40667>>>>>>>>>>>Register_Object oCancel_bn
40667>>>>>>>>>>>Register_Object oOK_bn
40667>>>>>>>>>>>Register_Object oSearch_bn
40667>>>>>>>>>>>Register_Object oSelList
40667>>>>>>>>>>>Register_Object sl058
40667>>>>>>>>>>>
40667>>>>>>>>>>>
40667>>>>>>>>>>>    //AB-IgnoreStart
40667>>>>>>>>>>>
40667>>>>>>>>>>>    Use DFAllEnt.pkg
40667>>>>>>>>>>>    Use dbList.Sub
40667>>>>>>>>>>>    Use Button.Sub
40667>>>>>>>>>>>
40667>>>>>>>>>>>
40667>>>>>>>>>>>    Use Country.DD
40667>>>>>>>>>>>    
40667>>>>>>>>>>>    //AB-IgnoreEnd
40667>>>>>>>>>>>
40667>>>>>>>>>>>    Object sl058 is a dbModalPanelSub
40669>>>>>>>>>>>        Set Label to "•é¨œª"
40670>>>>>>>>>>>        Set Size to 148 297
40671>>>>>>>>>>>        Set Location to 6 10
40672>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
40673>>>>>>>>>>>        Set Modal_State to FALSE
40674>>>>>>>>>>>
40674>>>>>>>>>>>        //AB-DDOStart
40674>>>>>>>>>>>
40674>>>>>>>>>>>        Object Country_DD is a Country_DataDictionary
40676>>>>>>>>>>>        End_Object    // Country_DD
40677>>>>>>>>>>>
40677>>>>>>>>>>>        Set Main_DD to (Country_DD(self))
40678>>>>>>>>>>>        Set Server to (Country_DD(self))
40679>>>>>>>>>>>
40679>>>>>>>>>>>        //AB-DDOEnd
40679>>>>>>>>>>>
40679>>>>>>>>>>>        Object oSelList is a dbListSub
40681>>>>>>>>>>>            Set Main_File to Country.File_Number
40682>>>>>>>>>>>            Set Size to 105 280
40683>>>>>>>>>>>            Set Location to 6 6
40684>>>>>>>>>>>
40684>>>>>>>>>>>            Begin_Row
40687>>>>>>>>>>>                Entry_Item Country.Country_id
40688>>>>>>>>>>>                Entry_Item Country.Country_descr
40689>>>>>>>>>>>            End_Row
40694>>>>>>>>>>>
40694>>>>>>>>>>>            Set Form_Width    item 0 to 87
40695>>>>>>>>>>>            Set Header_Label  item 0 to "‰à›"
40696>>>>>>>>>>>            
40696>>>>>>>>>>>            Set Form_Width    item 1 to 183
40697>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
40698>>>>>>>>>>>            
40698>>>>>>>>>>>        End_Object    // oSelList
40699>>>>>>>>>>>
40699>>>>>>>>>>>        Object oOK_bn is a ButtonSub
40701>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
40702>>>>>>>>>>>            Set Location to 115 126
40703>>>>>>>>>>>
40703>>>>>>>>>>>            //AB-StoreStart
40703>>>>>>>>>>>            Procedure OnClick
40705>>>>>>>>>>>                Send OK To (oSelList(current_object))
40706>>>>>>>>>>>            End_Procedure
40707>>>>>>>>>>>            //AB-StoreEnd
40707>>>>>>>>>>>
40707>>>>>>>>>>>        End_Object    // oOK_bn
40708>>>>>>>>>>>
40708>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
40710>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
40711>>>>>>>>>>>            Set Location to 115 181
40712>>>>>>>>>>>
40712>>>>>>>>>>>            //AB-StoreStart
40712>>>>>>>>>>>            Procedure OnClick
40714>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
40715>>>>>>>>>>>            End_Procedure
40716>>>>>>>>>>>            //AB-StoreEnd
40716>>>>>>>>>>>
40716>>>>>>>>>>>        End_Object    // oCancel_bn
40717>>>>>>>>>>>
40717>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
40719>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
40720>>>>>>>>>>>            Set Location to 115 236
40721>>>>>>>>>>>
40721>>>>>>>>>>>            //AB-StoreStart
40721>>>>>>>>>>>            Procedure OnClick
40723>>>>>>>>>>>                Send Search To (oSelList(current_object))
40724>>>>>>>>>>>            End_Procedure
40725>>>>>>>>>>>            //AB-StoreEnd
40725>>>>>>>>>>>
40725>>>>>>>>>>>        End_Object    // oSearch_bn
40726>>>>>>>>>>>
40726>>>>>>>>>>>
40726>>>>>>>>>>>        //AB-StoreStart
40726>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
40727>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
40728>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
40729>>>>>>>>>>>        //AB-StoreEnd
40729>>>>>>>>>>>
40729>>>>>>>>>>>    End_Object    // sl058
40730>>>>>>>>>>>
40730>>>>>>>>>>>//AB/     End_Object    // prj
40730>>>>>>>>>
40730>>>>>>>>>//DDB-Selection-pkg-End
40730>>>>>>>>>//DDB-FileEnd
40730>>>>>>>Use TOWNS.DD
INCLUDING FILE: TOWNS.DD
40730>>>>>>>>>//DDB-FileStart
40730>>>>>>>>>//DDB-HeaderStart
40730>>>>>>>>>
40730>>>>>>>>>// File Name : TOWNS.DD
40730>>>>>>>>>// Class Name: Towns_DataDictionary
40730>>>>>>>>>// Revision  : 8
40730>>>>>>>>>// Version   : 2
40730>>>>>>>>>
40730>>>>>>>>>Use  Windows           // Basic Definitions
40730>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
40730>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
40730>>>>>>>>>
40730>>>>>>>>>Open Towns
40732>>>>>>>>>Open Cities
40734>>>>>>>>>Open Country
40736>>>>>>>>>
40736>>>>>>>>>//DDB-HeaderEnd
40736>>>>>>>>>//DDB-SelectionStart
40736>>>>>>>>>//DDB/ ExternalSelectionList sl057  sl057.SL
40736>>>>>>>>>Register_Object sl057
40736>>>>>>>>>//DDB-SelectionEnd
40736>>>>>>>>>
40736>>>>>>>>>Class Towns_DataDictionary  is a DataDictionary_Sec
40737>>>>>>>>>
40737>>>>>>>>>    Procedure Save_Main_File
40738>>>>>>>>>        If (Operation_Origin<>Self) Begin
40740>>>>>>>>>            If Towns.Recnum Eq 0 Procedure_Return
40743>>>>>>>>>        End
40743>>>>>>>>>>
40743>>>>>>>>>        Forward Send Save_Main_File
40745>>>>>>>>>    End_Procedure
40746>>>>>>>>>
40746>>>>>>>>>
40746>>>>>>>>>    // Define_Fields:
40746>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
40746>>>>>>>>>
40746>>>>>>>>>    Procedure Define_Fields
40747>>>>>>>>>        Forward Send Define_Fields
40749>>>>>>>>>        //DDB-Generated-Code-Location
40749>>>>>>>>>        //DDB-DefineFieldStart
40749>>>>>>>>>
40749>>>>>>>>>        Set Main_File            To Towns.File_Number
40750>>>>>>>>>        Set Cascade_Delete_State To FALSE
40751>>>>>>>>>
40751>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   to DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
40752>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD to DD_NOPUT       DD_FINDREQ    
40753>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    to DD_DISPLAYONLY
40754>>>>>>>>>
40754>>>>>>>>>        // Child (Client) file structure................
40754>>>>>>>>>        Send Add_Client_File  Cities.File_Number
40755>>>>>>>>>
40755>>>>>>>>>        // Parent (Server) file structure...............
40755>>>>>>>>>        Send Add_Server_File  Country.File_Number
40756>>>>>>>>>
40756>>>>>>>>>        // Field-based properties.......................
40756>>>>>>>>>
40756>>>>>>>>>        // Towns.Country_Id
40756>>>>>>>>>        Set Key_Field_State        Field Towns.Country_Id To TRUE
40757>>>>>>>>>
40757>>>>>>>>>        // Towns.Town_Id
40757>>>>>>>>>        Set Field_Options          Field Towns.Town_Id To DD_AUTOFIND   
40758>>>>>>>>>        Set Field_Prompt_Object    Field Towns.Town_Id To (sl057(Self))
40759>>>>>>>>>
40759>>>>>>>>>        // Towns.Town_Descr
40759>>>>>>>>>        Set Field_Prompt_Object    Field Towns.Town_Descr To (sl057(Self))
40760>>>>>>>>>
40760>>>>>>>>>        //DDB-DefineFieldEnd
40760>>>>>>>>>    End_Procedure    // Define_Fields
40761>>>>>>>>>
40761>>>>>>>>>    // Field_Defaults:
40761>>>>>>>>>    // This procedure is used to establish default field values.
40761>>>>>>>>>
40761>>>>>>>>>    Procedure Field_Defaults
40762>>>>>>>>>        Forward Send Field_Defaults
40764>>>>>>>>>        //DDB-Generated-Code-Location
40764>>>>>>>>>        //DDB-FieldDefaultStart
40764>>>>>>>>>        //DDB-FieldDefaultEnd
40764>>>>>>>>>    End_Procedure    // Field_Defaults
40765>>>>>>>>>
40765>>>>>>>>>End_Class    // Towns_DataDictionary
40766>>>>>>>>>//DDB-Selection-pkg-Start
40766>>>>>>>>>
40766>>>>>>>>>Use sl057.SL         // sl057
INCLUDING FILE: SL057.SL
40766>>>>>>>>>>>//AB/ Project sl057 : Towns -Nomoi - Eyr Perioxes
40766>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
40766>>>>>>>>>>>//AB/         Set ProjectName to "sl057 : Towns -Nomoi - Eyr Perioxes"
40766>>>>>>>>>>>//AB/         Set ProjectFileName to "sl057.SL"
40766>>>>>>>>>>>
40766>>>>>>>>>>>// Project Object Structure
40766>>>>>>>>>>>//   sl057 is a dbModalPanelSub
40766>>>>>>>>>>>//     Country_DD is a DataDictionary
40766>>>>>>>>>>>//     Towns_DD is a DataDictionary
40766>>>>>>>>>>>//     oSelList is a dbListSub
40766>>>>>>>>>>>//     oOK_bn is a ButtonSub
40766>>>>>>>>>>>//     oCancel_bn is a ButtonSub
40766>>>>>>>>>>>//     oSearch_bn is a ButtonSub
40766>>>>>>>>>>>
40766>>>>>>>>>>>// Register all objects
40766>>>>>>>>>>>Register_Object Country_DD
40766>>>>>>>>>>>Register_Object oCancel_bn
40766>>>>>>>>>>>Register_Object oOK_bn
40766>>>>>>>>>>>Register_Object oSearch_bn
40766>>>>>>>>>>>Register_Object oSelList
40766>>>>>>>>>>>Register_Object sl057
40766>>>>>>>>>>>Register_Object Towns_DD
40766>>>>>>>>>>>
40766>>>>>>>>>>>
40766>>>>>>>>>>>    //AB-IgnoreStart
40766>>>>>>>>>>>
40766>>>>>>>>>>>    Use DFAllEnt.pkg
40766>>>>>>>>>>>    Use dbList.Sub
40766>>>>>>>>>>>    Use Button.Sub
40766>>>>>>>>>>>
40766>>>>>>>>>>>
40766>>>>>>>>>>>    Use COUNTRY.DD
40766>>>>>>>>>>>    Use TOWNS.DD
40766>>>>>>>>>>>    
40766>>>>>>>>>>>    //AB-IgnoreEnd
40766>>>>>>>>>>>
40766>>>>>>>>>>>    Object sl057 is a dbModalPanelSub
40768>>>>>>>>>>>        Set Label to "Œ¦£¦å - „¬¨ç«œ¨œª §œ¨ ¦®âª"
40769>>>>>>>>>>>        Set Size to 148 297
40770>>>>>>>>>>>        Set Location to 6 10
40771>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
40772>>>>>>>>>>>        Set Modal_State to FALSE
40773>>>>>>>>>>>
40773>>>>>>>>>>>        //AB-DDOStart
40773>>>>>>>>>>>
40773>>>>>>>>>>>        Object Country_DD is a Country_DataDictionary
40775>>>>>>>>>>>        End_Object    // Country_DD
40776>>>>>>>>>>>
40776>>>>>>>>>>>        Object Towns_DD is a Towns_DataDictionary
40778>>>>>>>>>>>            Set DDO_Server to (Country_DD(self))
40779>>>>>>>>>>>        End_Object    // Towns_DD
40780>>>>>>>>>>>
40780>>>>>>>>>>>        Set Main_DD to (Towns_DD(self))
40781>>>>>>>>>>>        Set Server to (Towns_DD(self))
40782>>>>>>>>>>>
40782>>>>>>>>>>>        //AB-DDOEnd
40782>>>>>>>>>>>
40782>>>>>>>>>>>        Object oSelList is a dbListSub
40784>>>>>>>>>>>            Set Main_File to Towns.File_Number
40785>>>>>>>>>>>            Set Size to 105 280
40786>>>>>>>>>>>            Set Location to 6 6
40787>>>>>>>>>>>
40787>>>>>>>>>>>            Begin_Row
40790>>>>>>>>>>>                Entry_Item Towns.Town_id
40791>>>>>>>>>>>                Entry_Item Towns.Town_descr
40792>>>>>>>>>>>                Entry_Item Country.Country_descr
40793>>>>>>>>>>>            End_Row
40798>>>>>>>>>>>
40798>>>>>>>>>>>            Set Form_Width    item 0 to 43
40799>>>>>>>>>>>            Set Header_Label  item 0 to "‰à›"
40800>>>>>>>>>>>            
40800>>>>>>>>>>>            Set Form_Width    item 1 to 137
40801>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
40802>>>>>>>>>>>            
40802>>>>>>>>>>>            Set Form_Width    item 2 to 94
40803>>>>>>>>>>>            Set Header_Label  item 2 to "•é¨˜"
40804>>>>>>>>>>>            
40804>>>>>>>>>>>        End_Object    // oSelList
40805>>>>>>>>>>>
40805>>>>>>>>>>>        Object oOK_bn is a ButtonSub
40807>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
40808>>>>>>>>>>>            Set Location to 115 126
40809>>>>>>>>>>>
40809>>>>>>>>>>>            //AB-StoreStart
40809>>>>>>>>>>>            Procedure OnClick
40811>>>>>>>>>>>                Send OK To (oSelList(current_object))
40812>>>>>>>>>>>            End_Procedure
40813>>>>>>>>>>>            //AB-StoreEnd
40813>>>>>>>>>>>
40813>>>>>>>>>>>        End_Object    // oOK_bn
40814>>>>>>>>>>>
40814>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
40816>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
40817>>>>>>>>>>>            Set Location to 115 181
40818>>>>>>>>>>>
40818>>>>>>>>>>>            //AB-StoreStart
40818>>>>>>>>>>>            Procedure OnClick
40820>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
40821>>>>>>>>>>>            End_Procedure
40822>>>>>>>>>>>            //AB-StoreEnd
40822>>>>>>>>>>>
40822>>>>>>>>>>>        End_Object    // oCancel_bn
40823>>>>>>>>>>>
40823>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
40825>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
40826>>>>>>>>>>>            Set Location to 115 236
40827>>>>>>>>>>>
40827>>>>>>>>>>>            //AB-StoreStart
40827>>>>>>>>>>>            Procedure OnClick
40829>>>>>>>>>>>                Send Search To (oSelList(current_object))
40830>>>>>>>>>>>            End_Procedure
40831>>>>>>>>>>>            //AB-StoreEnd
40831>>>>>>>>>>>
40831>>>>>>>>>>>        End_Object    // oSearch_bn
40832>>>>>>>>>>>
40832>>>>>>>>>>>
40832>>>>>>>>>>>        //AB-StoreStart
40832>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
40833>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
40834>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
40835>>>>>>>>>>>        //AB-StoreEnd
40835>>>>>>>>>>>
40835>>>>>>>>>>>    End_Object    // sl057
40836>>>>>>>>>>>
40836>>>>>>>>>>>//AB/     End_Object    // prj
40836>>>>>>>>>
40836>>>>>>>>>//DDB-Selection-pkg-End
40836>>>>>>>>>//DDB-FileEnd
40836>>>>>>>Use CITIES.DD
INCLUDING FILE: CITIES.DD
40836>>>>>>>>>//DDB-FileStart
40836>>>>>>>>>//DDB-HeaderStart
40836>>>>>>>>>
40836>>>>>>>>>// File Name : CITIES.DD
40836>>>>>>>>>// Class Name: Cities_DataDictionary
40836>>>>>>>>>// Revision  : 14
40836>>>>>>>>>// Version   : 2
40836>>>>>>>>>
40836>>>>>>>>>Use  Windows           // Basic Definitions
40836>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
40836>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
40836>>>>>>>>>
40836>>>>>>>>>Open Cities
40838>>>>>>>>>Open Clients
40840>>>>>>>>>Open Towns
40842>>>>>>>>>
40842>>>>>>>>>//DDB-HeaderEnd
40842>>>>>>>>>//DDB-SelectionStart
40842>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.SL
40842>>>>>>>>>Register_Object sl198
40842>>>>>>>>>//DDB-SelectionEnd
40842>>>>>>>>>
40842>>>>>>>>>Class Cities_DataDictionary  is a DataDictionary_Sec
40843>>>>>>>>>
40843>>>>>>>>>    // Define_Fields:
40843>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
40843>>>>>>>>>
40843>>>>>>>>>    Procedure Define_Fields
40844>>>>>>>>>        Forward Send Define_Fields
40846>>>>>>>>>        //DDB-Generated-Code-Location
40846>>>>>>>>>        //DDB-DefineFieldStart
40846>>>>>>>>>
40846>>>>>>>>>        Set Main_File            To Cities.File_Number
40847>>>>>>>>>        Set Cascade_Delete_State To FALSE
40848>>>>>>>>>
40848>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
40849>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
40850>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
40851>>>>>>>>>
40851>>>>>>>>>        // Child (Client) file structure................
40851>>>>>>>>>        Send Add_Client_File  Clients.File_Number
40852>>>>>>>>>
40852>>>>>>>>>        // Parent (Server) file structure...............
40852>>>>>>>>>        Send Add_Server_File  Towns.File_Number
40853>>>>>>>>>
40853>>>>>>>>>        // Field-based properties.......................
40853>>>>>>>>>
40853>>>>>>>>>        // Cities.City_Id
40853>>>>>>>>>        Set Field_Options          Field Cities.City_Id To DD_AUTOFIND   
40854>>>>>>>>>        Set Field_Prompt_Object    Field Cities.City_Id To (sl198(Self))
40855>>>>>>>>>        Set Key_Field_State        Field Cities.City_Id To TRUE
40856>>>>>>>>>
40856>>>>>>>>>        // Cities.City_Descr
40856>>>>>>>>>        Set Field_Prompt_Object    Field Cities.City_Descr To (sl198(Self))
40857>>>>>>>>>
40857>>>>>>>>>        // Cities.Town_Id
40857>>>>>>>>>
40857>>>>>>>>>        //DDB-DefineFieldEnd
40857>>>>>>>>>    End_Procedure    // Define_Fields
40858>>>>>>>>>
40858>>>>>>>>>    // Field_Defaults:
40858>>>>>>>>>    // This procedure is used to establish default field values.
40858>>>>>>>>>
40858>>>>>>>>>    Procedure Field_Defaults
40859>>>>>>>>>        Forward Send Field_Defaults
40861>>>>>>>>>        //DDB-Generated-Code-Location
40861>>>>>>>>>        //DDB-FieldDefaultStart
40861>>>>>>>>>        //DDB-FieldDefaultEnd
40861>>>>>>>>>    End_Procedure    // Field_Defaults
40862>>>>>>>>>
40862>>>>>>>>>End_Class    // Cities_DataDictionary
40863>>>>>>>>>//DDB-Selection-pkg-Start
40863>>>>>>>>>
40863>>>>>>>>>Use sl198.SL         // sl198
INCLUDING FILE: SL198.SL
40863>>>>>>>>>>>//AB/ Project sl198:cities
40863>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
40863>>>>>>>>>>>//AB/     Set ProjectName to "sl198:cities"
40863>>>>>>>>>>>//AB/     Set ProjectFileName to "sl198.SL"
40863>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
40863>>>>>>>>>>>
40863>>>>>>>>>>>// Project Object Structure
40863>>>>>>>>>>>//   sl198 is a dbModalPanelSub
40863>>>>>>>>>>>//     Cities_DD is a DataDictionary
40863>>>>>>>>>>>//     oSelList is a dbListSub
40863>>>>>>>>>>>//     oOK_bn is a ButtonSub
40863>>>>>>>>>>>//     oCancel_bn is a ButtonSub
40863>>>>>>>>>>>//     oSearch_bn is a ButtonSub
40863>>>>>>>>>>>
40863>>>>>>>>>>>// Register all objects
40863>>>>>>>>>>>Register_Object Cities_DD
40863>>>>>>>>>>>Register_Object oCancel_bn
40863>>>>>>>>>>>Register_Object oOK_bn
40863>>>>>>>>>>>Register_Object oSearch_bn
40863>>>>>>>>>>>Register_Object oSelList
40863>>>>>>>>>>>Register_Object sl198
40863>>>>>>>>>>>
40863>>>>>>>>>>>
40863>>>>>>>>>>>//AB-IgnoreStart
40863>>>>>>>>>>>
40863>>>>>>>>>>>Use DFAllEnt.pkg
40863>>>>>>>>>>>Use dbList.Sub
40863>>>>>>>>>>>Use Button.Sub
40863>>>>>>>>>>>
40863>>>>>>>>>>>
40863>>>>>>>>>>>Use CITIES.DD
40863>>>>>>>>>>>
40863>>>>>>>>>>>//AB-IgnoreEnd
40863>>>>>>>>>>>
40863>>>>>>>>>>>Object sl198 is a dbModalPanelSub
40865>>>>>>>>>>>    Set Label to "€¨®œå¦ æ¢œà¤"
40866>>>>>>>>>>>    Set Size to 148 297
40867>>>>>>>>>>>    Set Location to 4 5
40868>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
40869>>>>>>>>>>>    Set Modal_State to FALSE
40870>>>>>>>>>>>
40870>>>>>>>>>>>    //AB-DDOStart
40870>>>>>>>>>>>
40870>>>>>>>>>>>    Object Cities_DD is a Cities_DataDictionary
40872>>>>>>>>>>>
40872>>>>>>>>>>>        //AB-StoreStart
40872>>>>>>>>>>>                
40872>>>>>>>>>>>                
40872>>>>>>>>>>>        //AB-StoreEnd
40872>>>>>>>>>>>
40872>>>>>>>>>>>    End_Object    // Cities_DD
40873>>>>>>>>>>>
40873>>>>>>>>>>>    Set Main_DD to (Cities_DD(self))
40874>>>>>>>>>>>    Set Server to (Cities_DD(self))
40875>>>>>>>>>>>
40875>>>>>>>>>>>    //AB-DDOEnd
40875>>>>>>>>>>>
40875>>>>>>>>>>>    Object oSelList is a dbListSub
40877>>>>>>>>>>>        Set Main_File to Cities.File_Number
40878>>>>>>>>>>>        Set Size to 105 280
40879>>>>>>>>>>>        Set Location to 6 6
40880>>>>>>>>>>>
40880>>>>>>>>>>>        Begin_Row
40883>>>>>>>>>>>            Entry_Item Cities.City_id
40884>>>>>>>>>>>            Entry_Item Cities.City_descr
40885>>>>>>>>>>>        End_Row
40890>>>>>>>>>>>
40890>>>>>>>>>>>        Set Form_Width    item 0 to 50
40891>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
40892>>>>>>>>>>>        
40892>>>>>>>>>>>        Set Form_Width    item 1 to 221
40893>>>>>>>>>>>        Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
40894>>>>>>>>>>>        
40894>>>>>>>>>>>
40894>>>>>>>>>>>        //AB-StoreStart
40894>>>>>>>>>>>        
40894>>>>>>>>>>>        Set Column_Option Item 0 to NoEnter True
40895>>>>>>>>>>>        
40895>>>>>>>>>>>        
40895>>>>>>>>>>>        
40895>>>>>>>>>>>        
40895>>>>>>>>>>>        
40895>>>>>>>>>>>        //AB-StoreEnd
40895>>>>>>>>>>>
40895>>>>>>>>>>>    End_Object    // oSelList
40896>>>>>>>>>>>
40896>>>>>>>>>>>    Object oOK_bn is a ButtonSub
40898>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
40899>>>>>>>>>>>        Set Location to 115 126
40900>>>>>>>>>>>
40900>>>>>>>>>>>        //AB-StoreStart
40900>>>>>>>>>>>        Procedure OnClick
40902>>>>>>>>>>>            Send OK To (oSelList(current_object))
40903>>>>>>>>>>>        End_Procedure
40904>>>>>>>>>>>        //AB-StoreEnd
40904>>>>>>>>>>>
40904>>>>>>>>>>>    End_Object    // oOK_bn
40905>>>>>>>>>>>
40905>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
40907>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
40908>>>>>>>>>>>        Set Location to 115 181
40909>>>>>>>>>>>
40909>>>>>>>>>>>        //AB-StoreStart
40909>>>>>>>>>>>        Procedure OnClick
40911>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
40912>>>>>>>>>>>        End_Procedure
40913>>>>>>>>>>>        //AB-StoreEnd
40913>>>>>>>>>>>
40913>>>>>>>>>>>    End_Object    // oCancel_bn
40914>>>>>>>>>>>
40914>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
40916>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
40917>>>>>>>>>>>        Set Location to 115 236
40918>>>>>>>>>>>
40918>>>>>>>>>>>        //AB-StoreStart
40918>>>>>>>>>>>        Procedure OnClick
40920>>>>>>>>>>>            Send Search To (oSelList(current_object))
40921>>>>>>>>>>>        End_Procedure
40922>>>>>>>>>>>        //AB-StoreEnd
40922>>>>>>>>>>>
40922>>>>>>>>>>>    End_Object    // oSearch_bn
40923>>>>>>>>>>>
40923>>>>>>>>>>>
40923>>>>>>>>>>>    //AB-StoreStart
40923>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
40924>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
40925>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
40926>>>>>>>>>>>    //AB-StoreEnd
40926>>>>>>>>>>>
40926>>>>>>>>>>>End_Object    // sl198
40927>>>>>>>>>>>
40927>>>>>>>>>>>//AB/ End_Object    // prj
40927>>>>>>>>>
40927>>>>>>>>>//DDB-Selection-pkg-End
40927>>>>>>>>>//DDB-FileEnd
40927>>>>>>>Use AREAS.DD
INCLUDING FILE: AREAS.DD
40927>>>>>>>>>//DDB-FileStart
40927>>>>>>>>>//DDB-HeaderStart
40927>>>>>>>>>
40927>>>>>>>>>// File Name : AREAS.DD
40927>>>>>>>>>// Class Name: Areas_DataDictionary
40927>>>>>>>>>// Revision  : 8
40927>>>>>>>>>// Version   : 2
40927>>>>>>>>>
40927>>>>>>>>>Use  Windows           // Basic Definitions
40927>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
40927>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
40927>>>>>>>>>
40927>>>>>>>>>Open Areas
40929>>>>>>>>>Open Clients
40931>>>>>>>>>
40931>>>>>>>>>//DDB-HeaderEnd
40931>>>>>>>>>//DDB-SelectionStart
40931>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
40931>>>>>>>>>Register_Object sl197
40931>>>>>>>>>//DDB-SelectionEnd
40931>>>>>>>>>
40931>>>>>>>>>Class Areas_DataDictionary  is a DataDictionary_Sec
40932>>>>>>>>>
40932>>>>>>>>>    // Define_Fields:
40932>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
40932>>>>>>>>>
40932>>>>>>>>>    Procedure Define_Fields
40933>>>>>>>>>        Forward Send Define_Fields
40935>>>>>>>>>        //DDB-Generated-Code-Location
40935>>>>>>>>>        //DDB-DefineFieldStart
40935>>>>>>>>>
40935>>>>>>>>>        Set Main_File            To Areas.File_Number
40936>>>>>>>>>        Set Cascade_Delete_State To FALSE
40937>>>>>>>>>
40937>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
40938>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
40939>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
40940>>>>>>>>>
40940>>>>>>>>>        // Child (Client) file structure................
40940>>>>>>>>>        Send Add_Client_File  Clients.File_Number
40941>>>>>>>>>
40941>>>>>>>>>        // Field-based properties.......................
40941>>>>>>>>>
40941>>>>>>>>>        // Areas.Area_Id
40941>>>>>>>>>        Set Field_Options          Field Areas.Area_Id To DD_AUTOFIND   
40942>>>>>>>>>        Set Field_Prompt_Object    Field Areas.Area_Id To (sl197(Self))
40943>>>>>>>>>
40943>>>>>>>>>        // Areas.Area_Descr
40943>>>>>>>>>        Set Field_Prompt_Object    Field Areas.Area_Descr To (sl197(Self))
40944>>>>>>>>>
40944>>>>>>>>>        // Areas.Area_Site
40944>>>>>>>>>
40944>>>>>>>>>        //DDB-DefineFieldEnd
40944>>>>>>>>>    End_Procedure    // Define_Fields
40945>>>>>>>>>
40945>>>>>>>>>    // Field_Defaults:
40945>>>>>>>>>    // This procedure is used to establish default field values.
40945>>>>>>>>>
40945>>>>>>>>>    Procedure Field_Defaults
40946>>>>>>>>>        Forward Send Field_Defaults
40948>>>>>>>>>        //DDB-Generated-Code-Location
40948>>>>>>>>>        //DDB-FieldDefaultStart
40948>>>>>>>>>        //DDB-FieldDefaultEnd
40948>>>>>>>>>    End_Procedure    // Field_Defaults
40949>>>>>>>>>
40949>>>>>>>>>End_Class    // Areas_DataDictionary
40950>>>>>>>>>//DDB-Selection-pkg-Start
40950>>>>>>>>>
40950>>>>>>>>>Use sl197.SL         // sl197
INCLUDING FILE: SL197.SL
40950>>>>>>>>>>>//AB/ Project sl197:areas
40950>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
40950>>>>>>>>>>>//AB/         Set ProjectName to "sl197:areas"
40950>>>>>>>>>>>//AB/         Set ProjectFileName to "sl197.SL"
40950>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
40950>>>>>>>>>>>
40950>>>>>>>>>>>// Project Object Structure
40950>>>>>>>>>>>//   sl197 is a dbModalPanelSub
40950>>>>>>>>>>>//     Areas_DD is a DataDictionary
40950>>>>>>>>>>>//     oSelList is a dbListSub
40950>>>>>>>>>>>//     oOK_bn is a ButtonSub
40950>>>>>>>>>>>//     oCancel_bn is a ButtonSub
40950>>>>>>>>>>>//     oSearch_bn is a ButtonSub
40950>>>>>>>>>>>
40950>>>>>>>>>>>// Register all objects
40950>>>>>>>>>>>Register_Object Areas_DD
40950>>>>>>>>>>>Register_Object oCancel_bn
40950>>>>>>>>>>>Register_Object oOK_bn
40950>>>>>>>>>>>Register_Object oSearch_bn
40950>>>>>>>>>>>Register_Object oSelList
40950>>>>>>>>>>>Register_Object sl197
40950>>>>>>>>>>>
40950>>>>>>>>>>>
40950>>>>>>>>>>>    //AB-IgnoreStart
40950>>>>>>>>>>>
40950>>>>>>>>>>>    Use DFAllEnt.pkg
40950>>>>>>>>>>>    Use dbList.Sub
40950>>>>>>>>>>>    Use Button.Sub
40950>>>>>>>>>>>
40950>>>>>>>>>>>
40950>>>>>>>>>>>    Use AREAS.DD
40950>>>>>>>>>>>    
40950>>>>>>>>>>>    //AB-IgnoreEnd
40950>>>>>>>>>>>
40950>>>>>>>>>>>    Object sl197 is a dbModalPanelSub
40952>>>>>>>>>>>
40952>>>>>>>>>>>        //AB-StoreTopStart
40952>>>>>>>>>>>                    
40952>>>>>>>>>>>        //AB-StoreTopEnd
40952>>>>>>>>>>>
40952>>>>>>>>>>>        Set Label to "€¨®œå¦ œ¨ ¦®é¤"
40953>>>>>>>>>>>        Set Size to 148 297
40954>>>>>>>>>>>        Set Location to 4 5
40955>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
40956>>>>>>>>>>>        Set Modal_State to FALSE
40957>>>>>>>>>>>
40957>>>>>>>>>>>        //AB-DDOStart
40957>>>>>>>>>>>
40957>>>>>>>>>>>        Object Areas_DD is a Areas_DataDictionary
40959>>>>>>>>>>>
40959>>>>>>>>>>>            //AB-StoreStart
40959>>>>>>>>>>>                                    
40959>>>>>>>>>>>            //AB-StoreEnd
40959>>>>>>>>>>>
40959>>>>>>>>>>>        End_Object    // Areas_DD
40960>>>>>>>>>>>
40960>>>>>>>>>>>        Set Main_DD to (Areas_DD(self))
40961>>>>>>>>>>>        Set Server to (Areas_DD(self))
40962>>>>>>>>>>>
40962>>>>>>>>>>>        //AB-DDOEnd
40962>>>>>>>>>>>
40962>>>>>>>>>>>        Object oSelList is a dbListSub
40964>>>>>>>>>>>            Set Main_File to Areas.File_Number
40965>>>>>>>>>>>            Set Ordering to 2
40966>>>>>>>>>>>            Set Size to 105 280
40967>>>>>>>>>>>            Set Location to 5 5
40968>>>>>>>>>>>            Set Export_Item_State to TRUE
40969>>>>>>>>>>>
40969>>>>>>>>>>>            Begin_Row
40972>>>>>>>>>>>                Entry_Item Areas.Area_id
40973>>>>>>>>>>>                Entry_Item Areas.Area_descr
40974>>>>>>>>>>>                Entry_Item Areas.Area_site
40975>>>>>>>>>>>            End_Row
40980>>>>>>>>>>>
40980>>>>>>>>>>>            Set Form_Width    item 0 to 45
40981>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
40982>>>>>>>>>>>            
40982>>>>>>>>>>>            Set Form_Width    item 1 to 192
40983>>>>>>>>>>>            Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
40984>>>>>>>>>>>            
40984>>>>>>>>>>>            Set Form_Width    item 2 to 35
40985>>>>>>>>>>>            Set Header_Label  item 2 to "’¦£â˜ª"
40986>>>>>>>>>>>            
40986>>>>>>>>>>>
40986>>>>>>>>>>>            //AB-StoreStart
40986>>>>>>>>>>>            
40986>>>>>>>>>>>            Set Column_Option Item 0 to NoEnter True
40987>>>>>>>>>>>            
40987>>>>>>>>>>>            
40987>>>>>>>>>>>            //AB-StoreEnd
40987>>>>>>>>>>>
40987>>>>>>>>>>>        End_Object    // oSelList
40988>>>>>>>>>>>
40988>>>>>>>>>>>        Object oOK_bn is a ButtonSub
40990>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
40991>>>>>>>>>>>            Set Location to 115 126
40992>>>>>>>>>>>
40992>>>>>>>>>>>            //AB-StoreStart
40992>>>>>>>>>>>            Procedure OnClick
40994>>>>>>>>>>>                Send OK To (oSelList(current_object))
40995>>>>>>>>>>>            End_Procedure
40996>>>>>>>>>>>            //AB-StoreEnd
40996>>>>>>>>>>>
40996>>>>>>>>>>>        End_Object    // oOK_bn
40997>>>>>>>>>>>
40997>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
40999>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
41000>>>>>>>>>>>            Set Location to 115 181
41001>>>>>>>>>>>
41001>>>>>>>>>>>            //AB-StoreStart
41001>>>>>>>>>>>            Procedure OnClick
41003>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
41004>>>>>>>>>>>            End_Procedure
41005>>>>>>>>>>>            //AB-StoreEnd
41005>>>>>>>>>>>
41005>>>>>>>>>>>        End_Object    // oCancel_bn
41006>>>>>>>>>>>
41006>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
41008>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
41009>>>>>>>>>>>            Set Location to 115 236
41010>>>>>>>>>>>
41010>>>>>>>>>>>            //AB-StoreStart
41010>>>>>>>>>>>            Procedure OnClick
41012>>>>>>>>>>>                Send Search To (oSelList(current_object))
41013>>>>>>>>>>>            End_Procedure
41014>>>>>>>>>>>            //AB-StoreEnd
41014>>>>>>>>>>>
41014>>>>>>>>>>>        End_Object    // oSearch_bn
41015>>>>>>>>>>>
41015>>>>>>>>>>>
41015>>>>>>>>>>>        //AB-StoreStart
41015>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
41016>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
41017>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
41018>>>>>>>>>>>        
41018>>>>>>>>>>>        
41018>>>>>>>>>>>        
41018>>>>>>>>>>>        
41018>>>>>>>>>>>        
41018>>>>>>>>>>>        //AB-StoreEnd
41018>>>>>>>>>>>
41018>>>>>>>>>>>    End_Object    // sl197
41019>>>>>>>>>>>
41019>>>>>>>>>>>//AB/     End_Object    // prj
41019>>>>>>>>>
41019>>>>>>>>>//DDB-Selection-pkg-End
41019>>>>>>>>>//DDB-FileEnd
41019>>>>>>>Use PAYRESP.DD
INCLUDING FILE: PAYRESP.DD
41019>>>>>>>>>//DDB-FileStart
41019>>>>>>>>>//DDB-HeaderStart
41019>>>>>>>>>
41019>>>>>>>>>// File Name : PAYRESP.DD
41019>>>>>>>>>// Class Name: Payresp_DataDictionary
41019>>>>>>>>>// Revision  : 78
41019>>>>>>>>>// Version   : 2
41019>>>>>>>>>
41019>>>>>>>>>Use  Windows           // Basic Definitions
41019>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
41019>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41019>>>>>>>>>
41019>>>>>>>>>Open Payresp
41021>>>>>>>>>Open Prspbank
INCLUDING FILE: PRSPBANK.FD
41023>>>>>>>>>Open Tppresp
INCLUDING FILE: TPPRESP.FD
41025>>>>>>>>>Open Clients
41027>>>>>>>>>Open Sysrecc
41029>>>>>>>>>
41029>>>>>>>>>//DDB-HeaderEnd
41029>>>>>>>>>//DDB-ValidationStart
41029>>>>>>>>>
41029>>>>>>>>>Register_Object Payresp_Presp_Doy_VT
41029>>>>>>>>>Register_Object Payresp_Presp_Categfpa_VT
41029>>>>>>>>>Register_Object Payresp_Feregios_VT
41029>>>>>>>>>
41029>>>>>>>>>Object Payresp_Presp_Doy_VT  is a CodeValidationTable
41031>>>>>>>>>    Set Type_Value        To "DOY"
41032>>>>>>>>>    Set Allow_Blank_State To TRUE
41033>>>>>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
41034>>>>>>>>>    //DDB-ValidationCustomStart
41034>>>>>>>>>    //DDB-ValidationCustomEnd
41034>>>>>>>>>End_Object   // Payresp_Presp_Doy_VT
41035>>>>>>>>>
41035>>>>>>>>>Object Payresp_Presp_Categfpa_VT  is a CodeValidationTable
41037>>>>>>>>>    Set Type_Value        To "VAT_STATUS"
41038>>>>>>>>>    Set Validate_State    To FALSE
41039>>>>>>>>>    Set Allow_Blank_State To TRUE
41040>>>>>>>>>    //DDB-ValidationCustomStart
41040>>>>>>>>>    //DDB-ValidationCustomEnd
41040>>>>>>>>>End_Object   // Payresp_Presp_Categfpa_VT
41041>>>>>>>>>
41041>>>>>>>>>Object Payresp_Feregios_VT  is a CodeValidationTable
41043>>>>>>>>>    Set Type_Value        To "FEREGIOS"
41044>>>>>>>>>    Set Allow_Blank_State To TRUE
41045>>>>>>>>>    Set Table_Title       To "ƒœå¡«œª ”œ¨œšš¬æ«ž«˜ª ”¦¨âà¤"
41046>>>>>>>>>    //DDB-ValidationCustomStart
41046>>>>>>>>>    //DDB-ValidationCustomEnd
41046>>>>>>>>>End_Object   // Payresp_Feregios_VT
41047>>>>>>>>>//DDB-ValidationEnd
41047>>>>>>>>>//DDB-SelectionStart
41047>>>>>>>>>//DDB/ ExternalSelectionList sl111  sl111.SL
41047>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
41047>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
41047>>>>>>>>>Register_Object sl111
41047>>>>>>>>>Register_Object sl198
41047>>>>>>>>>Register_Object sl197
41047>>>>>>>>>//DDB-SelectionEnd
41047>>>>>>>>>
41047>>>>>>>>>Open Year      
41049>>>>>>>>>
41049>>>>>>>>>Class Payresp_DataDictionary  is a DataDictionary_Sec
41050>>>>>>>>>
41050>>>>>>>>>    Procedure Construct_Object
41051>>>>>>>>>        Forward Send Construct_Object
41053>>>>>>>>>        Property Integer piCheckPlaf        Public 0
41054>>>>>>>>>    End_procedure
41055>>>>>>>>>
41055>>>>>>>>>    Procedure Update
41056>>>>>>>>>        Forward Send Update
41058>>>>>>>>>        Move SysCurXR.Company_Code  to payresp.Company_Code
41059>>>>>>>>>        Move SysCurXR.Branch_Code   to payresp.Branch_Code
41060>>>>>>>>>        Move SysCurXR.Year_Year     to payresp.Year_Year
41061>>>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
41061>>>>>>>>>        Move (payresp.Xreosh-payresp.Pistosh)   to payresp.Ypoloipo
41062>>>>>>>>>        Move (payresp.Plafon-payresp.ypoloipo)  to payresp.Overhead
41063>>>>>>>>>
41063>>>>>>>>>        //betolink
41063>>>>>>>>>        Move SysCurXR.Beto_Site      to payresp.presp_SiteW
41064>>>>>>>>>        Move payresp.presp_Rec0      to payresp.presp_SN
41065>>>>>>>>>        Move payresp.presp_id        to payresp.presp_Repm
41066>>>>>>>>>
41066>>>>>>>>>    End_Procedure   // Update
41067>>>>>>>>>
41067>>>>>>>>>     Procedure Creating
41068>>>>>>>>>        Forward Send Creating
41070>>>>>>>>>        // Insert Code Here
41070>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(payresp.presp_Rec0))))));                                    to payresp.presp_Recr
41071>>>>>>>>>        Move '1'                    to payresp.presp_Active
41072>>>>>>>>>        get fsgCode_With_Zeroes payresp.presp_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to payresp.presp_ID
41073>>>>>>>>>        clear year
41074>>>>>>>>>        move syscurxr.branch_code   to year.branch_code
41075>>>>>>>>>        move syscurxr.company_code  to year.company_code
41076>>>>>>>>>        move syscurxr.year_year     to YEAR.year_year
41077>>>>>>>>>        find eq year by index.1
41078>>>>>>>>>>
41078>>>>>>>>>        if (found=1) begin
41080>>>>>>>>>            move year.payresp_plafon to payresp.plafon
41081>>>>>>>>>            move year.payresp_ofeilh to payresp.orio_syn_ofeilh
41082>>>>>>>>>        end
41082>>>>>>>>>>
41082>>>>>>>>>    End_Procedure   // Creating
41083>>>>>>>>>
41083>>>>>>>>>   Function Validate_Save  Returns Integer
41084>>>>>>>>>        Integer iReturnVal iCheck iYes
41085>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
41087>>>>>>>>>        If (Not(iReturnVal)) Begin
41089>>>>>>>>>
41089>>>>>>>>>            If (Sysfile.Check_Afm=1) Begin
41091>>>>>>>>>                Move (Check_AFM(payresp.presp_Afm)) to iCheck
41092>>>>>>>>>                If (iCheck) Begin
41094>>>>>>>>>                         If (iCheck=1) Move 4001 to iReturnVal
41097>>>>>>>>>                    Else If (iCheck=2) Move 4002 to iReturnVal
41101>>>>>>>>>                    Else If (iCheck=3) Move 4003 to iReturnVal
41105>>>>>>>>>                End
41105>>>>>>>>>>
41105>>>>>>>>>            End
41105>>>>>>>>>>
41105>>>>>>>>>
41105>>>>>>>>>           If (piCheckPlaf(Self)=1) Begin
41107>>>>>>>>>                If ((PayResp.Plafon>0) And ((PayResp.Ypoloipo+PayResp.Posa_Apo_Dap)>PayResp.Plafon)) Begin
41109>>>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 5000 Payresp'  to iYes
41110>>>>>>>>>                        If (iYes=MBR_NO) Error 4004 'DDC111: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4004 to iReturnVal
41113>>>>>>>>>                End
41113>>>>>>>>>>
41113>>>>>>>>>                Else If ((PayResp.Orio_Syn_Ofeilh>0) And (PayResp.Synolikh_Ofeilh>PayResp.Orio_Syn_Ofeilh)) Begin
41116>>>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 5001 Payresp' to iYes
41117>>>>>>>>>                        If (iYes=MBR_NO) Error 4005 'DDC111: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
41120>>>>>>>>>                End
41120>>>>>>>>>>
41120>>>>>>>>>           End
41120>>>>>>>>>>
41120>>>>>>>>>        If (iReturnVal) Send Operation_Not_Allowed iReturnVal
41123>>>>>>>>>        End
41123>>>>>>>>>>
41123>>>>>>>>>        Function_Return iReturnVal
41124>>>>>>>>>    End_Function   // Validate_Save
41125>>>>>>>>>
41125>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
41126>>>>>>>>>        String lsError_Message
41127>>>>>>>>>        Case Begin
41127>>>>>>>>>            Case (iError_Num = 4001)
41129>>>>>>>>>                Move "DDC 100: Š˜¤Ÿ˜©£â¤¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤" to lsError_Message
41130>>>>>>>>>              Case Break
41131>>>>>>>>>            Case (iError_Num = 4002)
41134>>>>>>>>>                Move "DDC 100: ’¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤ ›œ¤ œå¤˜  9 ¯ã­ ¦" to lsError_Message
41135>>>>>>>>>              Case Break
41136>>>>>>>>>            Case (iError_Num = 4003)
41139>>>>>>>>>                Move "DDC 100: €¡˜«á¢¢ž¢¦ª ®˜¨˜¡«ã¨˜ª ©«¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤ " to lsError_Message
41140>>>>>>>>>              Case Break
41141>>>>>>>>>            Case (iError_Num = 4004)
41144>>>>>>>>>                Move "DDC 100: „š ¤œ ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç" to lsError_Message
41145>>>>>>>>>              Case Break
41146>>>>>>>>>            Case (iError_Num = 4005)
41149>>>>>>>>>                Move "DDC 100: „š ¤œ ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª" to lsError_Message
41150>>>>>>>>>              Case Break
41151>>>>>>>>>            Case Else
41151>>>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
41153>>>>>>>>>        Case End
41153>>>>>>>>>        Error iError_Num lsError_Message
41154>>>>>>>>>>
41154>>>>>>>>>    End_Procedure // operation_not_allowed
41155>>>>>>>>>
41155>>>>>>>>>
41155>>>>>>>>>
41155>>>>>>>>>    Procedure Define_Fields
41156>>>>>>>>>        Forward Send Define_Fields
41158>>>>>>>>>        //DDB-Generated-Code-Location
41158>>>>>>>>>        //DDB-DefineFieldStart
41158>>>>>>>>>
41158>>>>>>>>>        Set Main_File            To Payresp.File_Number
41159>>>>>>>>>        Set Cascade_Delete_State To FALSE
41160>>>>>>>>>
41160>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41161>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41162>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41163>>>>>>>>>
41163>>>>>>>>>        // Child (Client) file structure................
41163>>>>>>>>>        Send Add_Client_File  Prspbank.File_Number
41164>>>>>>>>>        Send Add_Client_File  Tppresp.File_Number
41165>>>>>>>>>        Send Add_Client_File  Clients.File_Number
41166>>>>>>>>>
41166>>>>>>>>>        // External (System) file structure.............
41166>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
41167>>>>>>>>>
41167>>>>>>>>>        Define_Auto_Increment  Sysrecc.Payresp_Rec0  To Payresp.Presp_Rec0
41170>>>>>>>>>
41170>>>>>>>>>        // Field-based properties.......................
41170>>>>>>>>>
41170>>>>>>>>>        // Payresp.Company_Code
41170>>>>>>>>>
41170>>>>>>>>>        // Payresp.Branch_Code
41170>>>>>>>>>
41170>>>>>>>>>        // Payresp.Year_Year
41170>>>>>>>>>
41170>>>>>>>>>        // Payresp.Custprom_Code
41170>>>>>>>>>
41170>>>>>>>>>        // Payresp.Presp_Id
41170>>>>>>>>>        Set Field_Options          Field Payresp.Presp_Id To DD_AUTOFIND    DD_NOPUT      
41171>>>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Id To (sl111(Self))
41172>>>>>>>>>        Set Key_Field_State        Field Payresp.Presp_Id To TRUE
41173>>>>>>>>>
41173>>>>>>>>>        // Payresp.Presp_Name
41173>>>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Name To (sl111(Self))
41174>>>>>>>>>
41174>>>>>>>>>        // Payresp.Presp_Afm
41174>>>>>>>>>
41174>>>>>>>>>        // Payresp.Presp_Rec0
41174>>>>>>>>>
41174>>>>>>>>>        // Payresp.Custprom_Recr
41174>>>>>>>>>
41174>>>>>>>>>        // Payresp.Presp_Recr
41174>>>>>>>>>
41174>>>>>>>>>        // Payresp.Last_Xreosh
41174>>>>>>>>>
41174>>>>>>>>>        // Payresp.Last_Pistosh
41174>>>>>>>>>
41174>>>>>>>>>        // Payresp.Last_Order
41174>>>>>>>>>
41174>>>>>>>>>        // Payresp.Presp_Doy
41174>>>>>>>>>        Set Field_Value_Table      Field Payresp.Presp_Doy To (Payresp_Presp_Doy_VT(Self))
41175>>>>>>>>>
41175>>>>>>>>>        // Payresp.Presp_Address
41175>>>>>>>>>
41175>>>>>>>>>        // Payresp.Presp_City_Id
41175>>>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_City_Id To (sl198(Self))
41176>>>>>>>>>
41176>>>>>>>>>        // Payresp.Presp_Area
41176>>>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Area To (sl197(Self))
41177>>>>>>>>>
41177>>>>>>>>>        // Payresp.Presp_Job
41177>>>>>>>>>
41177>>>>>>>>>        // Payresp.Presp_Respons
41177>>>>>>>>>
41177>>>>>>>>>        // Payresp.Presp_Zipcode
41177>>>>>>>>>
41177>>>>>>>>>        // Payresp.Presp_Phone
41177>>>>>>>>>
41177>>>>>>>>>        // Payresp.Presp_Fax
41177>>>>>>>>>
41177>>>>>>>>>        // Payresp.Presp_Mobile
41177>>>>>>>>>
41177>>>>>>>>>        // Payresp.Presp_Aoh
41177>>>>>>>>>
41177>>>>>>>>>        // Payresp.Presp_Email
41177>>>>>>>>>
41177>>>>>>>>>        // Payresp.Presp_Class
41177>>>>>>>>>
41177>>>>>>>>>        // Payresp.Presp_Details
41177>>>>>>>>>
41177>>>>>>>>>        // Payresp.Presp_Sitew
41177>>>>>>>>>
41177>>>>>>>>>        // Payresp.Presp_Codem
41177>>>>>>>>>
41177>>>>>>>>>        // Payresp.Presp_Categfpa
41177>>>>>>>>>        Set Field_Value_Table      Field Payresp.Presp_Categfpa To (Payresp_Presp_Categfpa_VT(Self))
41178>>>>>>>>>
41178>>>>>>>>>        // Payresp.Presp_Fpa
41178>>>>>>>>>
41178>>>>>>>>>        // Payresp.Presp_Public
41178>>>>>>>>>
41178>>>>>>>>>        // Payresp.Presp_Sn
41178>>>>>>>>>
41178>>>>>>>>>        // Payresp.Presp_Repm
41178>>>>>>>>>
41178>>>>>>>>>        // Payresp.Presp_Active
41178>>>>>>>>>
41178>>>>>>>>>        // Payresp.Presp_Reported
41178>>>>>>>>>
41178>>>>>>>>>        // Payresp.Presp_Pelprom
41178>>>>>>>>>
41178>>>>>>>>>        // Payresp.Presp_Lastupd
41178>>>>>>>>>
41178>>>>>>>>>        // Payresp.Presp_Markexp
41178>>>>>>>>>
41178>>>>>>>>>        // Payresp.Presp_Catjob
41178>>>>>>>>>
41178>>>>>>>>>        // Payresp.Is_Promhtheyths
41178>>>>>>>>>
41178>>>>>>>>>        // Payresp.Xreosh
41178>>>>>>>>>
41178>>>>>>>>>        // Payresp.Pistosh
41178>>>>>>>>>
41178>>>>>>>>>        // Payresp.Ypoloipo
41178>>>>>>>>>
41178>>>>>>>>>        // Payresp.Plafon
41178>>>>>>>>>
41178>>>>>>>>>        // Payresp.Overhead
41178>>>>>>>>>
41178>>>>>>>>>        // Payresp.Presp_Add_No
41178>>>>>>>>>
41178>>>>>>>>>        // Payresp.Presp_Nomos
41178>>>>>>>>>
41178>>>>>>>>>        // Payresp.Presp_Xora
41178>>>>>>>>>
41178>>>>>>>>>        // Payresp.Polh_Recr
41178>>>>>>>>>
41178>>>>>>>>>        // Payresp.Synolikh_Ofeilh
41178>>>>>>>>>
41178>>>>>>>>>        // Payresp.Stoxos_Ipal
41178>>>>>>>>>
41178>>>>>>>>>        // Payresp.Stoxos_Ipso
41178>>>>>>>>>
41178>>>>>>>>>        // Payresp.Poso_Se_Apait
41178>>>>>>>>>
41178>>>>>>>>>        // Payresp.Orio_Syn_Ofeilh
41178>>>>>>>>>
41178>>>>>>>>>        // Payresp.Posa_Apo_Dap
41178>>>>>>>>>
41178>>>>>>>>>        // Payresp.Feregios
41178>>>>>>>>>        Set Field_Value_Table      Field Payresp.Feregios To (Payresp_Feregios_VT(Self))
41179>>>>>>>>>
41179>>>>>>>>>        //DDB-DefineFieldEnd
41179>>>>>>>>>    End_Procedure    // Define_Fields
41180>>>>>>>>>
41180>>>>>>>>>    // Field_Defaults:
41180>>>>>>>>>    // This procedure is used to establish default field values.
41180>>>>>>>>>
41180>>>>>>>>>    Procedure Field_Defaults
41181>>>>>>>>>        Forward Send Field_Defaults
41183>>>>>>>>>        //DDB-Generated-Code-Location
41183>>>>>>>>>        //DDB-FieldDefaultStart
41183>>>>>>>>>        Set Field_Changed_Value   Field Payresp.Presp_Doy To "0"
41184>>>>>>>>>        //DDB-FieldDefaultEnd
41184>>>>>>>>>    End_Procedure    // Field_Defaults
41185>>>>>>>>>
41185>>>>>>>>>End_Class    // Payresp_DataDictionary
41186>>>>>>>>>//DDB-Selection-pkg-Start
41186>>>>>>>>>
41186>>>>>>>>>Use sl111.SL         // sl111
INCLUDING FILE: SL111.SL
41186>>>>>>>>>>>//AB/ Project sl111
41186>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
41186>>>>>>>>>>>//AB/     Set ProjectName to "sl111"
41186>>>>>>>>>>>//AB/     Set ProjectFileName to "sl111.SL"
41186>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
41186>>>>>>>>>>>
41186>>>>>>>>>>>// Project Object Structure
41186>>>>>>>>>>>//   sl111 is a dbModalPanelSub
41186>>>>>>>>>>>//     Payresp_DD is a DataDictionary
41186>>>>>>>>>>>//     oSelList is a dbListSub
41186>>>>>>>>>>>//     oOK_bn is a ButtonSub
41186>>>>>>>>>>>//     oCancel_bn is a ButtonSub
41186>>>>>>>>>>>//     oSearch_bn is a ButtonSub
41186>>>>>>>>>>>
41186>>>>>>>>>>>// Register all objects
41186>>>>>>>>>>>Register_Object oCancel_bn
41186>>>>>>>>>>>Register_Object oOK_bn
41186>>>>>>>>>>>Register_Object oSearch_bn
41186>>>>>>>>>>>Register_Object oSelList
41186>>>>>>>>>>>Register_Object Payresp_DD
41186>>>>>>>>>>>Register_Object sl111
41186>>>>>>>>>>>
41186>>>>>>>>>>>
41186>>>>>>>>>>>//AB-IgnoreStart
41186>>>>>>>>>>>
41186>>>>>>>>>>>Use DFAllEnt.pkg
41186>>>>>>>>>>>Use dbList.Sub
41186>>>>>>>>>>>Use Button.Sub
41186>>>>>>>>>>>
41186>>>>>>>>>>>
41186>>>>>>>>>>>Use PAYRESP.DD
41186>>>>>>>>>>>
41186>>>>>>>>>>>//AB-IgnoreEnd
41186>>>>>>>>>>>
41186>>>>>>>>>>>Object sl111 is a dbModalPanelSub
41188>>>>>>>>>>>    Set Label to "“§œçŸ¬¤¦  ¢ž¨à£é¤ "
41189>>>>>>>>>>>    Set Size to 148 443
41190>>>>>>>>>>>    Set Location to 4 5
41191>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
41192>>>>>>>>>>>    Set Modal_State to FALSE
41193>>>>>>>>>>>
41193>>>>>>>>>>>    //AB-DDOStart
41193>>>>>>>>>>>
41193>>>>>>>>>>>    Object Payresp_DD is a Payresp_DataDictionary
41195>>>>>>>>>>>    End_Object    // Payresp_DD
41196>>>>>>>>>>>
41196>>>>>>>>>>>    Set Main_DD to (Payresp_DD(self))
41197>>>>>>>>>>>    Set Server to (Payresp_DD(self))
41198>>>>>>>>>>>
41198>>>>>>>>>>>    //AB-DDOEnd
41198>>>>>>>>>>>
41198>>>>>>>>>>>    Object oSelList is a dbListSub
41200>>>>>>>>>>>        Set Main_File to Payresp.File_Number
41201>>>>>>>>>>>        Set Size to 105 430
41202>>>>>>>>>>>        Set Location to 6 6
41203>>>>>>>>>>>
41203>>>>>>>>>>>        Begin_Row
41206>>>>>>>>>>>            Entry_Item Payresp.Presp_id
41207>>>>>>>>>>>            Entry_Item Payresp.Presp_name
41208>>>>>>>>>>>            Entry_Item Payresp.Presp_afm
41209>>>>>>>>>>>            Entry_Item Payresp.Presp_address
41210>>>>>>>>>>>            Entry_Item Payresp.Presp_phone
41211>>>>>>>>>>>        End_Row
41216>>>>>>>>>>>
41216>>>>>>>>>>>        Set Form_Width    item 0 to 60
41217>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
41218>>>>>>>>>>>        
41218>>>>>>>>>>>        Set Form_Width    item 1 to 106
41219>>>>>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
41220>>>>>>>>>>>        
41220>>>>>>>>>>>        Set Form_Width    item 2 to 60
41221>>>>>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
41222>>>>>>>>>>>        
41222>>>>>>>>>>>        Set Form_Width    item 3 to 135
41223>>>>>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
41224>>>>>>>>>>>        
41224>>>>>>>>>>>        Set Form_Width    item 4 to 60
41225>>>>>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
41226>>>>>>>>>>>        
41226>>>>>>>>>>>    End_Object    // oSelList
41227>>>>>>>>>>>
41227>>>>>>>>>>>    Object oOK_bn is a ButtonSub
41229>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
41230>>>>>>>>>>>        Set Location to 113 277
41231>>>>>>>>>>>
41231>>>>>>>>>>>        //AB-StoreStart
41231>>>>>>>>>>>        Procedure OnClick
41233>>>>>>>>>>>            Send OK To (oSelList(current_object))
41234>>>>>>>>>>>        End_Procedure
41235>>>>>>>>>>>        //AB-StoreEnd
41235>>>>>>>>>>>
41235>>>>>>>>>>>    End_Object    // oOK_bn
41236>>>>>>>>>>>
41236>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
41238>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
41239>>>>>>>>>>>        Set Location to 113 332
41240>>>>>>>>>>>
41240>>>>>>>>>>>        //AB-StoreStart
41240>>>>>>>>>>>        Procedure OnClick
41242>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
41243>>>>>>>>>>>        End_Procedure
41244>>>>>>>>>>>        //AB-StoreEnd
41244>>>>>>>>>>>
41244>>>>>>>>>>>    End_Object    // oCancel_bn
41245>>>>>>>>>>>
41245>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
41247>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
41248>>>>>>>>>>>        Set Location to 113 387
41249>>>>>>>>>>>
41249>>>>>>>>>>>        //AB-StoreStart
41249>>>>>>>>>>>        Procedure OnClick
41251>>>>>>>>>>>            Send Search To (oSelList(current_object))
41252>>>>>>>>>>>        End_Procedure
41253>>>>>>>>>>>        //AB-StoreEnd
41253>>>>>>>>>>>
41253>>>>>>>>>>>    End_Object    // oSearch_bn
41254>>>>>>>>>>>
41254>>>>>>>>>>>
41254>>>>>>>>>>>    //AB-StoreStart
41254>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
41255>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
41256>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
41257>>>>>>>>>>>    //AB-StoreEnd
41257>>>>>>>>>>>
41257>>>>>>>>>>>End_Object    // sl111
41258>>>>>>>>>>>
41258>>>>>>>>>>>//AB/ End_Object    // prj
41258>>>>>>>>>Use sl198.sl         // sl198
41258>>>>>>>>>Use sl197.SL         // sl197
41258>>>>>>>>>
41258>>>>>>>>>//DDB-Selection-pkg-End
41258>>>>>>>>>//DDB-FileEnd
41258>>>>>>>Use CLIENTS.DD
41258>>>>>>>
41258>>>>>>>//AB-IgnoreEnd
41258>>>>>>>
41258>>>>>>>Object Barticl is a dbModalPanelSub
41260>>>>>>>
41260>>>>>>>    //AB-StoreTopStart
41260>>>>>>>    
41260>>>>>>>    Property Integer    piWhat              Public  0
41262>>>>>>>    Property Integer    FragmaTypkinCode    Public  0
41264>>>>>>>    Property Integer    piIsOpen            Public  0
41266>>>>>>>    Property String     FragmaClientID      Public ''
41268>>>>>>>    Property String     FragmaClientEpon    Public ''
41270>>>>>>>    Property Date       FragmaHmnia         Public ''
41272>>>>>>>    
41272>>>>>>>    Object Btypkin_DD2 is a Btypkin_DataDictionary
41274>>>>>>>    End_Object
41275>>>>>>>    
41275>>>>>>>    
41275>>>>>>>    //AB-StoreTopEnd
41275>>>>>>>
41275>>>>>>>    Set Label to "‰ ¤ã©œ ª €¥ ¦š¨á­à¤"
41276>>>>>>>    Set Size to 289 519
41277>>>>>>>    Set Location to 2 5
41278>>>>>>>    Set Exit_Application_Local_State to FALSE
41279>>>>>>>    Set Modal_State to FALSE
41280>>>>>>>
41280>>>>>>>    //AB-DDOStart
41280>>>>>>>
41280>>>>>>>    Object Btypkin_DD is a Btypkin_DataDictionary
41282>>>>>>>    End_Object    // Btypkin_DD
41283>>>>>>>
41283>>>>>>>    Object Barticl_DD is a Barticl_DataDictionary
41285>>>>>>>        Set DDO_Server to (Btypkin_DD(self))
41286>>>>>>>
41286>>>>>>>        //AB-StoreStart
41286>>>>>>>                    
41286>>>>>>>        Begin_Constraints
41288>>>>>>>            Integer iTypkinCode iWhat isOpen
41289>>>>>>>            String  sClientID sClientEpon
41289>>>>>>>            Date    dHmnia
41289>>>>>>>        
41289>>>>>>>            Get FragmaTypkinCode    to iTypkinCode
41290>>>>>>>            Get FragmaClientID      to sClientID
41291>>>>>>>            Get FragmaClientEpon    to sClientEpon
41292>>>>>>>            Get FragmaHmnia         to dHmnia
41293>>>>>>>            Get piIsOpen            to isOpen
41294>>>>>>>        
41294>>>>>>>            If (iTypkinCode<>'') Begin
41296>>>>>>>                If (sClientID<>'') Begin
41298>>>>>>>                    Set Ordering Of Barticl_DD to 8
41299>>>>>>>                    // Comp+Br+Year+Btypkin_Code+Epon1+Hmnia+Recnum
41299>>>>>>>                    Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
41301>>>>>>>                    Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
41303>>>>>>>                    Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
41305>>>>>>>                    Constrain Barticl.Btypkin_Code  Eq iTypkinCode
41307>>>>>>>                    Constrain Barticl.Barticl_Epon1 Eq sClientEpon
41309>>>>>>>                    If (dHmnia<>'') Constrain Barticl.Barticl_Hmnia Eq dHmnia
41313>>>>>>>                End
41313>>>>>>>>
41313>>>>>>>                Else Begin
41314>>>>>>>                    Set Ordering Of Barticl_DD to 11
41315>>>>>>>                    // Comp+Br+Year+Btypkin_Code+Hmnia+Epon1+Recnum
41315>>>>>>>                    Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
41317>>>>>>>                    Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
41319>>>>>>>                    Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
41321>>>>>>>                    Constrain Barticl.Btypkin_Code  Eq iTypkinCode
41323>>>>>>>                    If (dHmnia<>'') Constrain Barticl.Barticl_Hmnia Eq dHmnia
41327>>>>>>>                End
41327>>>>>>>>
41327>>>>>>>            End
41327>>>>>>>>
41327>>>>>>>            Else If (dHmnia<>'') Begin
41330>>>>>>>                Set Ordering Of Barticl_DD to 9
41331>>>>>>>                // Comp+Br+Year+Hmnia+Epon1+Recnum
41331>>>>>>>                Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
41333>>>>>>>                Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
41335>>>>>>>                Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
41337>>>>>>>                Constrain Barticl.Barticl_Hmnia Eq dHmnia
41339>>>>>>>                If (sClientID<>'') Constrain Barticl.Barticl_Epon1 Eq sClientEpon
41343>>>>>>>            End
41343>>>>>>>>
41343>>>>>>>            Else If (sClientID<>'') Begin
41346>>>>>>>                Set Ordering Of Barticl_DD to 8
41347>>>>>>>                // Comp+Br+Year+Epon1+Hmnia+Recnum
41347>>>>>>>                Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
41349>>>>>>>                Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
41351>>>>>>>                Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
41353>>>>>>>                Constrain Barticl.Barticl_Epon1 Eq sClientEpon
41355>>>>>>>            End
41355>>>>>>>>
41355>>>>>>>            Else Begin
41356>>>>>>>                Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
41358>>>>>>>                Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
41360>>>>>>>                Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
41362>>>>>>>            End
41362>>>>>>>>
41362>>>>>>>            If (isOpen) Constrain Barticl.Barticl_Ekleise NE '1'
41366>>>>>>>        End_Constraints
41369>>>>>>>        
41369>>>>>>>        
41369>>>>>>>        
41369>>>>>>>        
41369>>>>>>>        
41369>>>>>>>        
41369>>>>>>>        
41369>>>>>>>        
41369>>>>>>>        
41369>>>>>>>        
41369>>>>>>>        
41369>>>>>>>        
41369>>>>>>>        
41369>>>>>>>        
41369>>>>>>>        //AB-StoreEnd
41369>>>>>>>
41369>>>>>>>    End_Object    // Barticl_DD
41370>>>>>>>
41370>>>>>>>    Object Country_DD is a Country_DataDictionary
41372>>>>>>>    End_Object    // Country_DD
41373>>>>>>>
41373>>>>>>>    Object Towns_DD is a Towns_DataDictionary
41375>>>>>>>        Set DDO_Server to (Country_DD(self))
41376>>>>>>>    End_Object    // Towns_DD
41377>>>>>>>
41377>>>>>>>    Object Cities_DD is a Cities_DataDictionary
41379>>>>>>>        Set DDO_Server to (Towns_DD(self))
41380>>>>>>>    End_Object    // Cities_DD
41381>>>>>>>
41381>>>>>>>    Object Areas_DD is a Areas_DataDictionary
41383>>>>>>>    End_Object    // Areas_DD
41384>>>>>>>
41384>>>>>>>    Object Payresp_DD is a Payresp_DataDictionary
41386>>>>>>>    End_Object    // Payresp_DD
41387>>>>>>>
41387>>>>>>>    Object Clients_DD is a Clients_DataDictionary
41389>>>>>>>        Set DDO_Server to (Cities_DD(self))
41390>>>>>>>        Set DDO_Server to (Areas_DD(self))
41391>>>>>>>        Set DDO_Server to (Payresp_DD(self))
41392>>>>>>>    End_Object    // Clients_DD
41393>>>>>>>
41393>>>>>>>    Set Main_DD to (Barticl_DD(self))
41394>>>>>>>    Set Server to (Barticl_DD(self))
41395>>>>>>>
41395>>>>>>>    //AB-DDOEnd
41395>>>>>>>
41395>>>>>>>    Object oSelList is a dbListSub
41397>>>>>>>        Set Main_File to Barticl.File_Number
41398>>>>>>>        Set Size to 219 505
41399>>>>>>>        Set Location to 6 6
41400>>>>>>>
41400>>>>>>>        Begin_Row
41403>>>>>>>            Entry_Item Barticl.Barticl_no
41404>>>>>>>            Entry_Item Barticl.Barticl_hmnia
41405>>>>>>>            Entry_Item Btypkin.Btypkin_code
41406>>>>>>>            Entry_Item Btypkin.Btypkin_descr
41407>>>>>>>            Entry_Item Barticl.Barticl_code1
41408>>>>>>>            Entry_Item Barticl.Barticl_epon1
41409>>>>>>>            Entry_Item Barticl.Barticl_sv0
41410>>>>>>>            Entry_Item Barticl.Barticl_ekleise
41411>>>>>>>        End_Row
41416>>>>>>>
41416>>>>>>>        Set Form_Width    item 0 to 53
41417>>>>>>>        Set Header_Label  item 0 to "€¨ Ÿ£æª"
41418>>>>>>>        
41418>>>>>>>        Set Form_Width    item 1 to 48
41419>>>>>>>        Set Header_Label  item 1 to "†£œ¨/¤å˜"
41420>>>>>>>        
41420>>>>>>>        Set Form_Width    item 2 to 39
41421>>>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž"
41422>>>>>>>        
41422>>>>>>>        Set Form_Width    item 3 to 100
41423>>>>>>>        Set Header_Label  item 3 to "œ¨ š¨˜­ã"
41424>>>>>>>        
41424>>>>>>>        Set Form_Width    item 4 to 60
41425>>>>>>>        Set Header_Label  item 4 to "‘¬¤˜¢/¤¦ª"
41426>>>>>>>        
41426>>>>>>>        Set Form_Width    item 5 to 122
41427>>>>>>>        Set Header_Label  item 5 to "„§à¤¬£å˜"
41428>>>>>>>        
41428>>>>>>>        Set Form_Width    item 6 to 60
41429>>>>>>>        Set Header_Label  item 6 to "¦©æ"
41430>>>>>>>        
41430>>>>>>>        Set Form_Width    item 7 to 16
41431>>>>>>>        Set Header_Label  item 7 to "‰"
41432>>>>>>>        Set Column_Checkbox_State  item 7 to True
41433>>>>>>>        
41433>>>>>>>
41433>>>>>>>        //AB-StoreStart
41433>>>>>>>                                                
41433>>>>>>>        //Property Integer StoreFragmaTypkinCode  Public 0
41433>>>>>>>        //Property String  StoreFragmaClientID    Public ''
41433>>>>>>>        //Property String  StoreFragmaClientEpon  Public ''
41433>>>>>>>        //Property Date    StoreFragmaHmnia       Public ''
41433>>>>>>>        
41433>>>>>>>        Procedure End_Construct_Object
41435>>>>>>>            Integer iDecimals
41436>>>>>>>            Forward Send End_Construct_Object
41438>>>>>>>            Get fiDekadika_Nomismatos SysCurXr.C_Code0   to    iDecimals
41439>>>>>>>            Set Points Item 6 to iDecimals
41440>>>>>>>            Set Numeric_Mask Item 6 to 14 iDecimals ' ,*'
41441>>>>>>>        End_Procedure
41442>>>>>>>        
41442>>>>>>>        //Procedure Store_Defaults
41442>>>>>>>        //       Forward Send Store_Defaults
41442>>>>>>>        //       Set StoreFragmaTypkinCode    to (FragmaTypkinCode(Self))
41442>>>>>>>        //       Set StoreFragmaClientID      to (FragmaClientID  (Self))
41442>>>>>>>        //       Set StoreFragmaClientEpon    to (FragmaClientEpon(Self))
41442>>>>>>>        //       Set StoreFragmaHmnia         to (FragmaHmnia     (Self))
41442>>>>>>>        //End_Procedure
41442>>>>>>>        
41442>>>>>>>        //Procedure ReStore_Defaults
41442>>>>>>>        //       Forward Send ReStore_Defaults
41442>>>>>>>        //       Set FragmaTypkinCode to (StoreFragmaTypkinCode(Self))
41442>>>>>>>        //       Set FragmaClientID   to (StoreFragmaClientID  (Self))
41442>>>>>>>        //       Set FragmaClientEpon to (StoreFragmaClientEpon(Self))
41442>>>>>>>        //       Set FragmaHmnia      to (StoreFragmaHmnia     (Self))
41442>>>>>>>        //End_Procedure
41442>>>>>>>        
41442>>>>>>>        Procedure Activate
41444>>>>>>>            Send Keyaction to ButtonSub1
41445>>>>>>>            Forward Send Activate
41447>>>>>>>        End_procedure
41448>>>>>>>        
41448>>>>>>>        Procedure Activating
41450>>>>>>>            Forward Send Activating
41452>>>>>>>            Set Auto_Index_State to True
41453>>>>>>>        End_Procedure
41454>>>>>>>        
41454>>>>>>>        
41454>>>>>>>        
41454>>>>>>>        
41454>>>>>>>        
41454>>>>>>>        
41454>>>>>>>        
41454>>>>>>>        
41454>>>>>>>        
41454>>>>>>>        
41454>>>>>>>        
41454>>>>>>>        
41454>>>>>>>        
41454>>>>>>>        
41454>>>>>>>        
41454>>>>>>>        
41454>>>>>>>        
41454>>>>>>>        
41454>>>>>>>        
41454>>>>>>>        
41454>>>>>>>        
41454>>>>>>>        //AB-StoreEnd
41454>>>>>>>
41454>>>>>>>    End_Object    // oSelList
41455>>>>>>>
41455>>>>>>>    Object Btypkin_Btypkin_Code is a dbFormSub
41457>>>>>>>        Entry_Item Btypkin.Btypkin_code
41458>>>>>>>        Set Label to "’ç§¦ª ‰å¤ž©žª"
41459>>>>>>>        Set Size to 13 49
41460>>>>>>>        Set Location to 229 84
41461>>>>>>>        Set Label_Col_Offset to 5
41462>>>>>>>        Set Label_Justification_Mode to jMode_Right
41463>>>>>>>
41463>>>>>>>        //AB-StoreStart
41463>>>>>>>                                                                                            
41463>>>>>>>        Set Server to (Btypkin_DD2(Self))
41464>>>>>>>        
41464>>>>>>>        Procedure Key Integer iKey
41466>>>>>>>            Integer iRetVal
41467>>>>>>>            Forward Send Key iKey
41469>>>>>>>            If (iKey=277) Send Clear to Btypkin_DD2
41472>>>>>>>        End_Procedure
41473>>>>>>>        
41473>>>>>>>        
41473>>>>>>>        //AB-StoreEnd
41473>>>>>>>
41473>>>>>>>    End_Object    // Btypkin_Btypkin_Code
41474>>>>>>>
41474>>>>>>>    Object Btypkin_Btypkin_Descr is a dbFormSub
41476>>>>>>>        Entry_Item Btypkin.Btypkin_descr
41477>>>>>>>        Set Size to 13 133
41478>>>>>>>        Set Location to 229 139
41479>>>>>>>        Set Color to clBtnFace
41480>>>>>>>        Set Label_Col_Offset to 2
41481>>>>>>>        Set Label_Justification_Mode to jMode_Right
41482>>>>>>>        Set Enabled_State to FALSE
41483>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
41484>>>>>>>        Set Shadow_State Item 0 to TRUE
41485>>>>>>>
41485>>>>>>>        //AB-StoreStart
41485>>>>>>>        Set Server to (Btypkin_DD2(Self))
41486>>>>>>>        
41486>>>>>>>        //AB-StoreEnd
41486>>>>>>>
41486>>>>>>>    End_Object    // Btypkin_Btypkin_Descr
41487>>>>>>>
41487>>>>>>>    Object Clients_Client_Name is a dbFormSub
41489>>>>>>>        Entry_Item Clients.Client_name
41490>>>>>>>        Set Server to (Clients_DD(self))
41491>>>>>>>        Set Label to "‘¬¤˜¢¢˜©æ£œ¤¦ª"
41492>>>>>>>        Set Size to 13 188
41493>>>>>>>        Set Location to 244 84
41494>>>>>>>        Set Label_Col_Offset to 5
41495>>>>>>>        Set Label_Justification_Mode to jMode_Right
41496>>>>>>>
41496>>>>>>>        //AB-StoreStart
41496>>>>>>>                                                                                            
41496>>>>>>>        Procedure Key Integer iKey
41498>>>>>>>            Integer iRetVal
41499>>>>>>>            Forward Send Key iKey
41501>>>>>>>            If (iKey=277) Send Clear to Clients_DD
41504>>>>>>>        End_Procedure
41505>>>>>>>        
41505>>>>>>>        //AB-StoreEnd
41505>>>>>>>
41505>>>>>>>    End_Object    // Clients_Client_Name
41506>>>>>>>
41506>>>>>>>    Object cSyDateForm1 is a cSyDateForm
41508>>>>>>>        Set Label to "†£œ¨¦£ž¤å˜"
41509>>>>>>>        Set Size to 13 66
41510>>>>>>>        Set Location to 258 84
41511>>>>>>>        Set Label_Col_Offset to 5
41512>>>>>>>        Set Label_Justification_Mode to jMode_Right
41513>>>>>>>        Set Form_Mask Item 0 to "dd/MM/yyyy"
41514>>>>>>>
41514>>>>>>>        //AB-StoreStart
41514>>>>>>>                                                                                            
41514>>>>>>>        On_Key KClear Send ClearMe
41515>>>>>>>        
41515>>>>>>>        Procedure ClearMe
41517>>>>>>>            Set Value Item 0 to ''
41518>>>>>>>        End_Procedure
41519>>>>>>>        
41519>>>>>>>        //AB-StoreEnd
41519>>>>>>>
41519>>>>>>>    End_Object    // cSyDateForm1
41520>>>>>>>
41520>>>>>>>    Object chkOpen is a CheckBoxSub
41522>>>>>>>        Set Label to "‹æ¤¦ ˜¤¦ ®«á"
41523>>>>>>>        Set Size to 10 62
41524>>>>>>>        Set Location to 260 156
41525>>>>>>>    End_Object    // chkOpen
41526>>>>>>>
41526>>>>>>>    Object ButtonSub1 is a ButtonSub
41528>>>>>>>        Set Label to "œ¨ æ¨ ©œ"
41529>>>>>>>        Set Size to 13 52
41530>>>>>>>        Set Location to 258 219
41531>>>>>>>
41531>>>>>>>        //AB-StoreStart
41531>>>>>>>                            
41531>>>>>>>        Procedure OnClick
41533>>>>>>>            String  sEpon sID
41534>>>>>>>            Integer iTypkin isOpen
41534>>>>>>>            Date    dHmnia
41534>>>>>>>        
41534>>>>>>>            Get Value Of cSyDateForm1 Item 0                                  to dHmnia
41535>>>>>>>            Get Field_Current_Value Of Clients_DD  Field Clients.Client_ID    to sID
41536>>>>>>>            Get Field_Current_Value Of Clients_DD  Field Clients.Client_Name  to sEpon
41537>>>>>>>            Get Field_Current_Value Of Btypkin_DD2 Field Btypkin.Btypkin_Code to iTypkin
41538>>>>>>>        
41538>>>>>>>            Get Checked_State Of chkOpen to isOpen
41539>>>>>>>        
41539>>>>>>>            Set FragmaTypkinCode    to iTypkin
41540>>>>>>>            Set FragmaClientID      to sID
41541>>>>>>>            Set FragmaClientEpon    to sEpon
41542>>>>>>>            Set FragmaHmnia         to dHmnia
41543>>>>>>>            Set piIsOpen            to isOpen
41544>>>>>>>        
41544>>>>>>>            Send Rebuild_Constraints    to Barticl_DD
41545>>>>>>>            Send Beginning_Of_Data      to oSelList True
41546>>>>>>>        End_Procedure // OnClick
41547>>>>>>>        
41547>>>>>>>        
41547>>>>>>>        
41547>>>>>>>        //AB-StoreEnd
41547>>>>>>>
41547>>>>>>>    End_Object    // ButtonSub1
41548>>>>>>>
41548>>>>>>>    Object oOK_bn is a ButtonSub
41550>>>>>>>        Set Label to "&„§ ¢¦šã"
41551>>>>>>>        Set Size to 13 50
41552>>>>>>>        Set Location to 258 406
41553>>>>>>>        Set Focus_Mode to Pointer_Only
41554>>>>>>>
41554>>>>>>>        //AB-StoreStart
41554>>>>>>>        Procedure OnClick
41556>>>>>>>            Send OK To (oSelList(current_object))
41557>>>>>>>        End_Procedure
41558>>>>>>>        //AB-StoreEnd
41558>>>>>>>
41558>>>>>>>    End_Object    // oOK_bn
41559>>>>>>>
41559>>>>>>>    Object oCancel_bn is a ButtonSub
41561>>>>>>>        Set Label to "&€¡ç¨à©ž"
41562>>>>>>>        Set Size to 13 50
41563>>>>>>>        Set Location to 258 461
41564>>>>>>>        Set Focus_Mode to Pointer_Only
41565>>>>>>>
41565>>>>>>>        //AB-StoreStart
41565>>>>>>>        Procedure OnClick
41567>>>>>>>            Send Cancel To (oSelList(current_object))
41568>>>>>>>        End_Procedure
41569>>>>>>>        //AB-StoreEnd
41569>>>>>>>
41569>>>>>>>    End_Object    // oCancel_bn
41570>>>>>>>
41570>>>>>>>
41570>>>>>>>    //AB-StoreStart
41570>>>>>>>    
41570>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
41571>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
41572>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
41573>>>>>>>    
41573>>>>>>>    Set Modal_State to True
41574>>>>>>>    
41574>>>>>>>    Procedure Activate
41576>>>>>>>        If (FragmaTypkinCode(Self)<>0) Begin
41578>>>>>>>            Send Clear to Btypkin_DD2
41579>>>>>>>            Move (FragmaTypkinCode(Self)) to Btypkin.Btypkin_Code
41580>>>>>>>            Send Find to Btypkin_DD2 Eq 1
41581>>>>>>>        End
41581>>>>>>>>
41581>>>>>>>        Else Send Clear to Btypkin_DD2
41583>>>>>>>        If (FragmaClientID(Self)<>'') Begin
41585>>>>>>>            Send Clear to Clients_DD
41586>>>>>>>            Move (FragmaClientID(Self)) to Clients.Client_ID
41587>>>>>>>            Send Find to Clients_DD Eq 6
41588>>>>>>>        End
41588>>>>>>>>
41588>>>>>>>        Else Send Clear to Clients_DD
41590>>>>>>>        If (FragmaHmnia(Self)<>'') Set Value Of cSyDateForm1 Item 0 to (FragmaHmnia(Self))
41593>>>>>>>        Else                       Set Value Of cSyDateForm1 Item 0 to ''
41595>>>>>>>        Forward Send Activate
41597>>>>>>>    End_Procedure
41598>>>>>>>    
41598>>>>>>>    //AB-StoreEnd
41598>>>>>>>
41598>>>>>>>End_Object    // Barticl
41599>>>>>>>
41599>>>>>>>//AB/ End_Object    // prj
41599>>>>>Use sl041.SL         // sl041
INCLUDING FILE: SL041.SL
41599>>>>>>>//AB/ Project CN : sl041
41599>>>>>>>//AB/     Object prj is a Lookup_Project
41599>>>>>>>//AB/         Set ProjectName to "CN : sl041"
41599>>>>>>>//AB/         Set ProjectFileName to "sl041.SL"
41599>>>>>>>//AB/         Set GenerateFileName to "NONAME"
41599>>>>>>>
41599>>>>>>>// Project Object Structure
41599>>>>>>>//   sl041 is a dbModalPanelSub
41599>>>>>>>//     Clients_DD is a DataDictionary
41599>>>>>>>//     Cn_DD is a DataDictionary
41599>>>>>>>//     oSelList is a dbListSub
41599>>>>>>>//     oOK_bn is a ButtonSub
41599>>>>>>>//     oCancel_bn is a ButtonSub
41599>>>>>>>//     oSearch_bn is a ButtonSub
41599>>>>>>>
41599>>>>>>>// Register all objects
41599>>>>>>>Register_Object Clients_DD
41599>>>>>>>Register_Object Cn_DD
41599>>>>>>>Register_Object oCancel_bn
41599>>>>>>>Register_Object oOK_bn
41599>>>>>>>Register_Object oSearch_bn
41599>>>>>>>Register_Object oSelList
41599>>>>>>>Register_Object sl041
41599>>>>>>>
41599>>>>>>>
41599>>>>>>>    //AB-IgnoreStart
41599>>>>>>>
41599>>>>>>>    Use DFAllEnt.pkg
41599>>>>>>>    Use dbList.Sub
41599>>>>>>>    Use Button.Sub
41599>>>>>>>
41599>>>>>>>
41599>>>>>>>    Use CLIENTS.DD
41599>>>>>>>    Use CN.DD
INCLUDING FILE: CN.DD
41599>>>>>>>>>//DDB-FileStart
41599>>>>>>>>>//DDB-HeaderStart
41599>>>>>>>>>
41599>>>>>>>>>// File Name : CN.DD
41599>>>>>>>>>// Class Name: Cn_DataDictionary
41599>>>>>>>>>// Revision  : 89
41599>>>>>>>>>// Version   : 2
41599>>>>>>>>>
41599>>>>>>>>>Use  Windows           // Basic Definitions
41599>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
41599>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41599>>>>>>>>>
41599>>>>>>>>>Open Cn
41601>>>>>>>>>Open Cnzones
INCLUDING FILE: CNZONES.FD
41603>>>>>>>>>Open Tperga
41605>>>>>>>>>Open Btnordh
INCLUDING FILE: BTNORDH.FD
41607>>>>>>>>>Open Dorderh
INCLUDING FILE: DORDERH.FD
41609>>>>>>>>>Open Clients
41611>>>>>>>>>Open Salesmen
41613>>>>>>>>>Open Mhxanik
41615>>>>>>>>>Open Constrct
41617>>>>>>>>>Open Sysrecc
41619>>>>>>>>>Open Syscurxr
41621>>>>>>>>>
41621>>>>>>>>>//DDB-HeaderEnd
41621>>>>>>>>>//DDB-ValidationStart
41621>>>>>>>>>
41621>>>>>>>>>Register_Object Cn_Cn_Categfpa_VT1
41621>>>>>>>>>Register_Object Cn_Tropos_Metaf_VT
41621>>>>>>>>>Register_Object Cn_Eidos_Cn_VT
41621>>>>>>>>>Register_Object Cn_Yesno_VT
41621>>>>>>>>>
41621>>>>>>>>>Object Cn_Cn_Categfpa_VT1  is a CodeValidationTable
41623>>>>>>>>>    Set Type_Value        To "VAT_STATUS"
41624>>>>>>>>>    Set Validate_State    To FALSE
41625>>>>>>>>>    Set Allow_Blank_State To TRUE
41626>>>>>>>>>    //DDB-ValidationCustomStart
41626>>>>>>>>>    //DDB-ValidationCustomEnd
41626>>>>>>>>>End_Object   // Cn_Cn_Categfpa_VT1
41627>>>>>>>>>
41627>>>>>>>>>Object Cn_Tropos_Metaf_VT  is a CodeValidationTable
41629>>>>>>>>>    Set Type_Value        To "FORTOSH"
41630>>>>>>>>>    Set Allow_Blank_State To TRUE
41631>>>>>>>>>    Set Table_Title       To "’¨æ§¦  ‹œ«˜­¦¨áª"
41632>>>>>>>>>    //DDB-ValidationCustomStart
41632>>>>>>>>>    //DDB-ValidationCustomEnd
41632>>>>>>>>>End_Object   // Cn_Tropos_Metaf_VT
41633>>>>>>>>>
41633>>>>>>>>>Object Cn_Eidos_Cn_VT  is a CodeValidationTable
41635>>>>>>>>>    Set Type_Value        To "EIDOSCN"
41636>>>>>>>>>    Set Allow_Blank_State To TRUE
41637>>>>>>>>>    Set Table_Title       To "„å›¦ª „¨š¦¬"
41638>>>>>>>>>    //DDB-ValidationCustomStart
41638>>>>>>>>>    //DDB-ValidationCustomEnd
41638>>>>>>>>>End_Object   // Cn_Eidos_Cn_VT
41639>>>>>>>>>
41639>>>>>>>>>Object Cn_Yesno_VT  is a CodeValidationTable
41641>>>>>>>>>    Set Type_Value        To "YESNO"
41642>>>>>>>>>    Set Allow_Blank_State To TRUE
41643>>>>>>>>>    //DDB-ValidationCustomStart
41643>>>>>>>>>    //DDB-ValidationCustomEnd
41643>>>>>>>>>End_Object   // Cn_Yesno_VT
41644>>>>>>>>>//DDB-ValidationEnd
41644>>>>>>>>>//DDB-SelectionStart
41644>>>>>>>>>//DDB/ ExternalSelectionList sl041  sl041.sl
41644>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
41644>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
41644>>>>>>>>>Register_Object sl041
41644>>>>>>>>>Register_Object sl198
41644>>>>>>>>>Register_Object sl197
41644>>>>>>>>>//DDB-SelectionEnd
41644>>>>>>>>>
41644>>>>>>>>>Class Cn_DataDictionary  is a DataDictionary_Sec
41645>>>>>>>>>
41645>>>>>>>>>
41645>>>>>>>>>    Procedure Update
41646>>>>>>>>>        Forward Send Update
41648>>>>>>>>>        // Insert Code Here
41648>>>>>>>>>        Move SysCurXR.Company_Code  to CN.Company_Code
41649>>>>>>>>>        Move SysCurXR.Branch_Code   to CN.Branch_Code
41650>>>>>>>>>        Move SysCurXR.Year_Year     to CN.Year_Year
41651>>>>>>>>>        //Move Custprom.Custprom_Code to CN.Custprom_Code
41651>>>>>>>>>        Move Clients.Client_ID      to CN.Client_ID
41652>>>>>>>>>
41652>>>>>>>>>        Move SysCurXR.Beto_Site      to CN.Cn_SiteW
41653>>>>>>>>>        Move Cn.Cn_Rec0              to CN.Cn_SN
41654>>>>>>>>>        Move Cn.Client_id            to Cn.Cn_clientid
41655>>>>>>>>>        Move Cn.cn_code              to Cn.Cn_Repmatch
41656>>>>>>>>>        Move Cn.Cn_Code              to Cn.Constraction_ID
41657>>>>>>>>>        Move PayResp.Presp_ID        to Cn.Cn_Presp_ID
41658>>>>>>>>>        Move Salesmen.Sls_ID         to Cn.Cn_Sls_ID
41659>>>>>>>>>        Move Constrct.Cnt_ID         to Cn.Cn_Cnt_ID
41660>>>>>>>>>        Move mhxanik.mhx_id          to Cn.mhxanik_ID
41661>>>>>>>>>    End_Procedure   // Update
41662>>>>>>>>>
41662>>>>>>>>>     Procedure Creating
41663>>>>>>>>>        Forward Send Creating
41665>>>>>>>>>        // Insert Code Here
41665>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(CN.CN_Rec0)))))) to CN.CN_Recr
41666>>>>>>>>>        Get fsgCode_With_Zeroes CN.CN_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to CN.CN_Code
41667>>>>>>>>>    End_Procedure   // Creating
41668>>>>>>>>>
41668>>>>>>>>>
41668>>>>>>>>>
41668>>>>>>>>>    // Define_Fields:
41668>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41668>>>>>>>>>
41668>>>>>>>>>    Procedure Define_Fields
41669>>>>>>>>>        Forward Send Define_Fields
41671>>>>>>>>>        //DDB-Generated-Code-Location
41671>>>>>>>>>        //DDB-DefineFieldStart
41671>>>>>>>>>
41671>>>>>>>>>        Set Main_File            To Cn.File_Number
41672>>>>>>>>>        Set Cascade_Delete_State To FALSE
41673>>>>>>>>>
41673>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41674>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41675>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41676>>>>>>>>>
41676>>>>>>>>>        // Child (Client) file structure................
41676>>>>>>>>>        Send Add_Client_File  Cnzones.File_Number
41677>>>>>>>>>        Send Add_Client_File  Tperga.File_Number
41678>>>>>>>>>        Send Add_Client_File  Btnordh.File_Number
41679>>>>>>>>>        Send Add_Client_File  Dorderh.File_Number
41680>>>>>>>>>
41680>>>>>>>>>        // Parent (Server) file structure...............
41680>>>>>>>>>        Send Add_Server_File  Clients.File_Number
41681>>>>>>>>>        Send Add_Server_File  Salesmen.File_Number
41682>>>>>>>>>        Send Add_Server_File  Mhxanik.File_Number
41683>>>>>>>>>        Send Add_Server_File  Constrct.File_Number
41684>>>>>>>>>
41684>>>>>>>>>        // External (System) file structure.............
41684>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
41685>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
41686>>>>>>>>>
41686>>>>>>>>>        Define_Auto_Increment  Sysrecc.Cn_Rec0  To Cn.Cn_Rec0
41689>>>>>>>>>
41689>>>>>>>>>        // Field-based properties.......................
41689>>>>>>>>>
41689>>>>>>>>>        // Cn.Company_Code
41689>>>>>>>>>
41689>>>>>>>>>        // Cn.Branch_Code
41689>>>>>>>>>
41689>>>>>>>>>        // Cn.Year_Year
41689>>>>>>>>>
41689>>>>>>>>>        // Cn.Custprom_Code
41689>>>>>>>>>
41689>>>>>>>>>        // Cn.Client_Id
41689>>>>>>>>>
41689>>>>>>>>>        // Cn.Cn_Code
41689>>>>>>>>>        Set Field_Options          Field Cn.Cn_Code To DD_AUTOFIND    DD_NOPUT      
41690>>>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_Code To (sl041(Self))
41691>>>>>>>>>        Set Key_Field_State        Field Cn.Cn_Code To TRUE
41692>>>>>>>>>
41692>>>>>>>>>        // Cn.Client_Recr
41692>>>>>>>>>
41692>>>>>>>>>        // Cn.Cn_Rec0
41692>>>>>>>>>
41692>>>>>>>>>        // Cn.Cn_Recr
41692>>>>>>>>>
41692>>>>>>>>>        // Cn.Cn_Descr
41692>>>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_Descr To (sl041(Self))
41693>>>>>>>>>
41693>>>>>>>>>        // Cn.Cn_Address
41693>>>>>>>>>
41693>>>>>>>>>        // Cn.Cn_Zipcode
41693>>>>>>>>>
41693>>>>>>>>>        // Cn.Cn_City
41693>>>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_City To (sl198(Self))
41694>>>>>>>>>
41694>>>>>>>>>        // Cn.Cn_Area
41694>>>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_Area To (sl197(Self))
41695>>>>>>>>>
41695>>>>>>>>>        // Cn.Cn_License
41695>>>>>>>>>
41695>>>>>>>>>        // Cn.Cn_Responsible
41695>>>>>>>>>
41695>>>>>>>>>        // Cn.Cn_Cnt_Recr
41695>>>>>>>>>
41695>>>>>>>>>        // Cn.Cn_Cnt_Id
41695>>>>>>>>>
41695>>>>>>>>>        // Cn.Cn_Phone
41695>>>>>>>>>
41695>>>>>>>>>        // Cn.Cn_Zone
41695>>>>>>>>>
41695>>>>>>>>>        // Cn.Cn_Sls_Recr
41695>>>>>>>>>
41695>>>>>>>>>        // Cn.Cn_Sls_Id
41695>>>>>>>>>
41695>>>>>>>>>        // Cn.Cn_Details
41695>>>>>>>>>
41695>>>>>>>>>        // Cn.Cn_Distance
41695>>>>>>>>>
41695>>>>>>>>>        // Cn.Cn_Pump
41695>>>>>>>>>
41695>>>>>>>>>        // Cn.Cn_Pumplicense
41695>>>>>>>>>
41695>>>>>>>>>        // Cn.Cn_Totalstats
41695>>>>>>>>>
41695>>>>>>>>>        // Cn.Cn_Analstats
41695>>>>>>>>>
41695>>>>>>>>>        // Cn.Cn_Coated
41695>>>>>>>>>
41695>>>>>>>>>        // Cn.Cn_Sitew
41695>>>>>>>>>
41695>>>>>>>>>        // Cn.Cn_Clientmatch
41695>>>>>>>>>
41695>>>>>>>>>        // Cn.Cn_Codematch
41695>>>>>>>>>
41695>>>>>>>>>        // Cn.Cn_Pumpid
41695>>>>>>>>>
41695>>>>>>>>>        // Cn.Cn_Clientid
41695>>>>>>>>>
41695>>>>>>>>>        // Cn.Cn_Sn
41695>>>>>>>>>
41695>>>>>>>>>        // Cn.Cn_Repmatch
41695>>>>>>>>>
41695>>>>>>>>>        // Cn.Cn_Active
41695>>>>>>>>>        Set Field_Checkbox_Values  Field Cn.Cn_Active To "A"  "F"
41696>>>>>>>>>
41696>>>>>>>>>        // Cn.Cn_Reported
41696>>>>>>>>>
41696>>>>>>>>>        // Cn.Cn_Lastupdated
41696>>>>>>>>>
41696>>>>>>>>>        // Cn.Cn_Markexp
41696>>>>>>>>>
41696>>>>>>>>>        // Cn.Cn_Vdetails
41696>>>>>>>>>
41696>>>>>>>>>        // Cn.Cn_Vticket
41696>>>>>>>>>
41696>>>>>>>>>        // Cn.Constraction_Id
41696>>>>>>>>>
41696>>>>>>>>>        // Cn.Cn_Presp_Id
41696>>>>>>>>>
41696>>>>>>>>>        // Cn.Cn_Presp_Recr
41696>>>>>>>>>
41696>>>>>>>>>        // Cn.Cn_Add_No
41696>>>>>>>>>
41696>>>>>>>>>        // Cn.Cn_Nomos
41696>>>>>>>>>
41696>>>>>>>>>        // Cn.Cn_Xora
41696>>>>>>>>>
41696>>>>>>>>>        // Cn.Polh_Recr
41696>>>>>>>>>
41696>>>>>>>>>        // Cn.Lic_Number
41696>>>>>>>>>
41696>>>>>>>>>        // Cn.Lic_Date
41696>>>>>>>>>        Set Field_Mask_Type        Field Cn.Lic_Date To MASK_DATE_WINDOW
41697>>>>>>>>>
41697>>>>>>>>>        // Cn.Lic_Lixi
41697>>>>>>>>>        Set Field_Mask_Type        Field Cn.Lic_Lixi To MASK_DATE_WINDOW
41698>>>>>>>>>
41698>>>>>>>>>        // Cn.Lic_Auth
41698>>>>>>>>>
41698>>>>>>>>>        // Cn.Cn_Start_Date
41698>>>>>>>>>        Set Field_Mask_Type        Field Cn.Cn_Start_Date To MASK_DATE_WINDOW
41699>>>>>>>>>
41699>>>>>>>>>        // Cn.Cn_End_Date
41699>>>>>>>>>        Set Field_Mask_Type        Field Cn.Cn_End_Date To MASK_DATE_WINDOW
41700>>>>>>>>>
41700>>>>>>>>>        // Cn.Cn_Categfpa
41700>>>>>>>>>        Set Field_Value_Table      Field Cn.Cn_Categfpa To (Cn_Cn_Categfpa_VT1(Self))
41701>>>>>>>>>
41701>>>>>>>>>        // Cn.Cn_Tpay
41701>>>>>>>>>
41701>>>>>>>>>        // Cn.Mhxanik_Id
41701>>>>>>>>>
41701>>>>>>>>>        // Cn.Sum_Pct_Tper
41701>>>>>>>>>
41701>>>>>>>>>        // Cn.Cn_M3
41701>>>>>>>>>
41701>>>>>>>>>        // Cn.Aa_Deop
41701>>>>>>>>>
41701>>>>>>>>>        // Cn.Hm_Tel_Fortio
41701>>>>>>>>>        Set Field_Mask_Type        Field Cn.Hm_Tel_Fortio To MASK_DATE_WINDOW
41702>>>>>>>>>
41702>>>>>>>>>        // Cn.Tel_Fortio_No
41702>>>>>>>>>
41702>>>>>>>>>        // Cn.Tropos_Metaf
41702>>>>>>>>>        Set Field_Value_Table      Field Cn.Tropos_Metaf To (Cn_Tropos_Metaf_VT(Self))
41703>>>>>>>>>
41703>>>>>>>>>        // Cn.Eidos_Cn
41703>>>>>>>>>        Set Field_Value_Table      Field Cn.Eidos_Cn To (Cn_Eidos_Cn_VT(Self))
41704>>>>>>>>>
41704>>>>>>>>>        // Cn.Polhths_Constr
41704>>>>>>>>>
41704>>>>>>>>>        // Cn.Polhths_Mhx
41704>>>>>>>>>
41704>>>>>>>>>        // Cn.Hm_Prot_Fortio
41704>>>>>>>>>        Set Field_Mask_Type        Field Cn.Hm_Prot_Fortio To MASK_DATE_WINDOW
41705>>>>>>>>>
41705>>>>>>>>>        // Cn.Mesoskyklos
41705>>>>>>>>>
41705>>>>>>>>>        // Cn.Diodia
41705>>>>>>>>>
41705>>>>>>>>>        // Cn.Yesno
41705>>>>>>>>>        Set Field_Value_Table      Field Cn.Yesno To (Cn_Yesno_VT(Self))
41706>>>>>>>>>
41706>>>>>>>>>        // Cn.Dateeggy
41706>>>>>>>>>        Set Field_Mask_Type        Field Cn.Dateeggy To MASK_DATE_WINDOW
41707>>>>>>>>>
41707>>>>>>>>>        // Cn.Cn_Branch
41707>>>>>>>>>
41707>>>>>>>>>        //DDB-DefineFieldEnd
41707>>>>>>>>>    End_Procedure    // Define_Fields
41708>>>>>>>>>
41708>>>>>>>>>    // Field_Defaults:
41708>>>>>>>>>    // This procedure is used to establish default field values.
41708>>>>>>>>>          
41708>>>>>>>>>    Procedure Field_Defaults
41709>>>>>>>>>        Forward Send Field_Defaults
41711>>>>>>>>>        //DDB-Generated-Code-Location
41711>>>>>>>>>        //DDB-FieldDefaultStart
41711>>>>>>>>>        Set Field_Changed_Value   Field Cn.Cn_Active To "A"
41712>>>>>>>>>        //DDB-FieldDefaultEnd
41712>>>>>>>>>    End_Procedure    // Field_Defaults
41713>>>>>>>>>
41713>>>>>>>>>End_Class    // Cn_DataDictionary
41714>>>>>>>>>//DDB-Selection-pkg-Start
41714>>>>>>>>>
41714>>>>>>>>>Use sl041.sl         // sl041
41714>>>>>>>>>Use sl198.sl         // sl198
41714>>>>>>>>>Use sl197.SL         // sl197
41714>>>>>>>>>
41714>>>>>>>>>//DDB-Selection-pkg-End
41714>>>>>>>>>//DDB-FileEnd
41714>>>>>>>    
41714>>>>>>>    //AB-IgnoreEnd
41714>>>>>>>
41714>>>>>>>    Object sl041 is a dbModalPanelSub
41716>>>>>>>
41716>>>>>>>        //AB-StoreTopStart
41716>>>>>>>        Property String FragmaClient_ID Public ''
41718>>>>>>>        
41718>>>>>>>        //AB-StoreTopEnd
41718>>>>>>>
41718>>>>>>>        Set Label to "„§ ¢¦šã „¨šà¤"
41719>>>>>>>        Set Size to 249 500
41720>>>>>>>        Set Location to 2 6
41721>>>>>>>        Set Exit_Application_Local_State to FALSE
41722>>>>>>>        Set Modal_State to FALSE
41723>>>>>>>
41723>>>>>>>        //AB-DDOStart
41723>>>>>>>
41723>>>>>>>        Object Clients_DD is a Clients_DataDictionary
41725>>>>>>>
41725>>>>>>>            //AB-StoreStart
41725>>>>>>>                                                                                                                                                                                                                                        
41725>>>>>>>                                                                                                                                                                                                                                        
41725>>>>>>>                                                                                                                                                                                                                                        
41725>>>>>>>            //AB-StoreEnd
41725>>>>>>>
41725>>>>>>>        End_Object    // Clients_DD
41726>>>>>>>
41726>>>>>>>        Object Cn_DD is a Cn_DataDictionary
41728>>>>>>>            Set DDO_Server to (Clients_DD(self))
41729>>>>>>>
41729>>>>>>>            //AB-StoreStart
41729>>>>>>>                                            
41729>>>>>>>            Begin_Constraints
41731>>>>>>>                String sID
41732>>>>>>>                Get FragmaClient_ID to sID
41733>>>>>>>                If (sID<>'') begin
41735>>>>>>>                    set ordering to 4
41736>>>>>>>                    Constrain CN.Client_ID eq sID
41738>>>>>>>                end
41738>>>>>>>>
41738>>>>>>>                ELSE SET ORDERING TO -1
41740>>>>>>>            End_Constraints
41743>>>>>>>            
41743>>>>>>>            
41743>>>>>>>            
41743>>>>>>>            
41743>>>>>>>            
41743>>>>>>>            
41743>>>>>>>            
41743>>>>>>>            
41743>>>>>>>            
41743>>>>>>>            
41743>>>>>>>            
41743>>>>>>>            
41743>>>>>>>            
41743>>>>>>>            
41743>>>>>>>            
41743>>>>>>>            //AB-StoreEnd
41743>>>>>>>
41743>>>>>>>        End_Object    // Cn_DD
41744>>>>>>>
41744>>>>>>>        Set Main_DD to (Cn_DD(self))
41745>>>>>>>        Set Server to (Cn_DD(self))
41746>>>>>>>
41746>>>>>>>        //AB-DDOEnd
41746>>>>>>>
41746>>>>>>>        Object oSelList is a dbListSub
41748>>>>>>>            Set Main_File to Cn.File_Number
41749>>>>>>>            Set Ordering to 4
41750>>>>>>>            Set Size to 209 481
41751>>>>>>>            Set Location to 6 6
41752>>>>>>>            Set Auto_Index_State to FALSE
41753>>>>>>>
41753>>>>>>>            Begin_Row
41756>>>>>>>                Entry_Item Cn.Cn_code
41757>>>>>>>                Entry_Item Cn.Cn_descr
41758>>>>>>>                Entry_Item Cn.Client_id
41759>>>>>>>                Entry_Item Clients.Client_name
41760>>>>>>>                Entry_Item Cn.Cn_active
41761>>>>>>>            End_Row
41766>>>>>>>
41766>>>>>>>            Set Form_Width    item 0 to 61
41767>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª „¨š¦¬"
41768>>>>>>>            
41768>>>>>>>            Set Form_Width    item 1 to 185
41769>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã „¨š¦¬"
41770>>>>>>>            
41770>>>>>>>            Set Form_Width    item 2 to 60
41771>>>>>>>            Set Header_Label  item 2 to "‰à›.œ¢á«ž"
41772>>>>>>>            
41772>>>>>>>            Set Form_Width    item 3 to 123
41773>>>>>>>            Set Header_Label  item 3 to "„§à¤¬£å˜ œ¢á«ž"
41774>>>>>>>            
41774>>>>>>>            Set Form_Width    item 4 to 44
41775>>>>>>>            Set Header_Label  item 4 to "‘œ „¥â¢ ¥ž"
41776>>>>>>>            Set Column_Checkbox_State  item 4 to True
41777>>>>>>>            
41777>>>>>>>
41777>>>>>>>            //AB-StoreStart
41777>>>>>>>                                            
41777>>>>>>>            Property String StoreFragmaClient_ID Public ''
41779>>>>>>>            
41779>>>>>>>            Procedure Store_Defaults
41781>>>>>>>                   Forward Send Store_Defaults
41783>>>>>>>                   Set StoreFragmaClient_ID to (FragmaClient_ID(Self))
41784>>>>>>>            End_Procedure
41785>>>>>>>            
41785>>>>>>>            Procedure ReStore_Defaults
41787>>>>>>>                   Forward Send ReStore_Defaults
41789>>>>>>>                   Set FragmaClient_ID to (StoreFragmaClient_ID(Self))
41790>>>>>>>            End_Procedure
41791>>>>>>>            
41791>>>>>>>            Procedure Activating Returns Integer
41793>>>>>>>                Integer rVal
41794>>>>>>>                Forward Get Msg_Activating to rVal
41796>>>>>>>                set auto_index_state to true
41797>>>>>>>                SET ORDERING TO -1
41798>>>>>>>                Procedure_Return rVal
41799>>>>>>>            End_Procedure
41800>>>>>>>            
41800>>>>>>>            
41800>>>>>>>            
41800>>>>>>>            
41800>>>>>>>            
41800>>>>>>>            
41800>>>>>>>            
41800>>>>>>>            
41800>>>>>>>            
41800>>>>>>>            
41800>>>>>>>            
41800>>>>>>>            
41800>>>>>>>            
41800>>>>>>>            
41800>>>>>>>            
41800>>>>>>>            
41800>>>>>>>            
41800>>>>>>>            
41800>>>>>>>            //AB-StoreEnd
41800>>>>>>>
41800>>>>>>>        End_Object    // oSelList
41801>>>>>>>
41801>>>>>>>        Object oOK_bn is a ButtonSub
41803>>>>>>>            Set Label to "&„§ ¢¦šã"
41804>>>>>>>            Set Location to 219 327
41805>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
41806>>>>>>>
41806>>>>>>>            //AB-StoreStart
41806>>>>>>>            Procedure OnClick
41808>>>>>>>                Send OK To (oSelList(current_object))
41809>>>>>>>            End_Procedure
41810>>>>>>>            //AB-StoreEnd
41810>>>>>>>
41810>>>>>>>        End_Object    // oOK_bn
41811>>>>>>>
41811>>>>>>>        Object oCancel_bn is a ButtonSub
41813>>>>>>>            Set Label to "&€¡ç¨à©ž"
41814>>>>>>>            Set Location to 219 383
41815>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
41816>>>>>>>
41816>>>>>>>            //AB-StoreStart
41816>>>>>>>            Procedure OnClick
41818>>>>>>>                Send Cancel To (oSelList(current_object))
41819>>>>>>>            End_Procedure
41820>>>>>>>            //AB-StoreEnd
41820>>>>>>>
41820>>>>>>>        End_Object    // oCancel_bn
41821>>>>>>>
41821>>>>>>>        Object oSearch_bn is a ButtonSub
41823>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
41824>>>>>>>            Set Location to 219 437
41825>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
41826>>>>>>>
41826>>>>>>>            //AB-StoreStart
41826>>>>>>>            Procedure OnClick
41828>>>>>>>                Send Search To (oSelList(current_object))
41829>>>>>>>            End_Procedure
41830>>>>>>>            //AB-StoreEnd
41830>>>>>>>
41830>>>>>>>        End_Object    // oSearch_bn
41831>>>>>>>
41831>>>>>>>
41831>>>>>>>        //AB-StoreStart
41831>>>>>>>                        
41831>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
41832>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
41833>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
41834>>>>>>>        Set Modal_State to True
41835>>>>>>>        Procedure Activating Returns Integer
41837>>>>>>>            Integer rVal
41838>>>>>>>            Forward Get Msg_Activating to rVal
41840>>>>>>>            Send Rebuild_Constraints to (CN_DD(Self))
41841>>>>>>>            Send Beginning_Of_Data to oSelList
41842>>>>>>>            Procedure_Return rVal
41843>>>>>>>        End_Procedure
41844>>>>>>>        
41844>>>>>>>        procedure page integer pagemode
41846>>>>>>>            forward send page pagemode
41848>>>>>>>            set location to 40,40
41849>>>>>>>        end_procedure
41850>>>>>>>        
41850>>>>>>>        
41850>>>>>>>        
41850>>>>>>>        
41850>>>>>>>        
41850>>>>>>>        
41850>>>>>>>        
41850>>>>>>>        
41850>>>>>>>        
41850>>>>>>>        
41850>>>>>>>        
41850>>>>>>>        
41850>>>>>>>        
41850>>>>>>>        
41850>>>>>>>        
41850>>>>>>>        
41850>>>>>>>        
41850>>>>>>>        
41850>>>>>>>        //AB-StoreEnd
41850>>>>>>>
41850>>>>>>>    End_Object    // sl041
41851>>>>>>>
41851>>>>>>>//AB/     End_Object    // prj
41851>>>>>
41851>>>>>//DDB-Selection-pkg-End
41851>>>>>//DDB-FileEnd
41851>>>    Use BAXIO.DD
INCLUDING FILE: BAXIO.DD
41851>>>>>//DDB-FileStart
41851>>>>>//DDB-HeaderStart
41851>>>>>
41851>>>>>// File Name : BAXIO.DD
41851>>>>>// Class Name: Baxio_DataDictionary
41851>>>>>// Revision  : 112
41851>>>>>// Version   : 2
41851>>>>>
41851>>>>>Use  Windows           // Basic Definitions
41851>>>>>Use  DataDict          // DataDictionary Class Definition
41851>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41851>>>>>
41851>>>>>Open Baxio
41853>>>>>Open Bmove
41855>>>>>Open Baxiokat
41857>>>>>Open Sysrecb
41859>>>>>
41859>>>>>//DDB-HeaderEnd
41859>>>>>//DDB-ValidationStart
41859>>>>>
41859>>>>>//DDB/ ExternalValidationTable Baxio_Status_VT  Baxio.pkg
41859>>>>>//DDB/ ExternalValidationTable Bfile_VT  Baxio.pkg
41859>>>>>
41859>>>>>Register_Object Baxio_Status_VT
41859>>>>>Register_Object Baxio_Baxio_Place_VT
41859>>>>>Register_Object Bfile_VT
41859>>>>>Register_Object Baxio_Baxio_Bank_VT
41859>>>>>Register_Object Baxio_Baxio_Banka_VT
41859>>>>>Register_Object Baxio_Baxio_From_VT
41859>>>>>Register_Object Baxio_Baxio_Topos_VT1
41859>>>>>Use Baxio.pkg        // Baxio_Status_VT, Bfile_VT
41859>>>>>
41859>>>>>Object Baxio_Baxio_Place_VT  is a CodeValidationTable
41861>>>>>    Set Type_Value        To "BAXIOPLACE"
41862>>>>>    //DDB-ValidationCustomStart
41862>>>>>    //DDB-ValidationCustomEnd
41862>>>>>End_Object   // Baxio_Baxio_Place_VT
41863>>>>>
41863>>>>>Object Baxio_Baxio_Bank_VT  is a CodeValidationTable
41865>>>>>    Set Type_Value        To "BANK"
41866>>>>>    Set Allow_Blank_State To TRUE
41867>>>>>    //DDB-ValidationCustomStart
41867>>>>>    //DDB-ValidationCustomEnd
41867>>>>>End_Object   // Baxio_Baxio_Bank_VT
41868>>>>>
41868>>>>>Object Baxio_Baxio_Banka_VT  is a CodeValidationTable
41870>>>>>    Set Type_Value        To "BANK"
41871>>>>>    Set Allow_Blank_State To TRUE
41872>>>>>    //DDB-ValidationCustomStart
41872>>>>>    //DDB-ValidationCustomEnd
41872>>>>>End_Object   // Baxio_Baxio_Banka_VT
41873>>>>>
41873>>>>>Object Baxio_Baxio_From_VT  is a DescriptionValidationTable
41875>>>>>    Set Allow_Blank_State To TRUE
41876>>>>>    Set Table_Title       To "€¥ æš¨˜­¦  ›å¦¬ / «¨å«¦¬"
41877>>>>>
41877>>>>>    Procedure Fill_List
41879>>>>>        Forward Send Fill_List
41881>>>>>        Send Add_Table_Value  "0"  "ˆ›å¦¬"
41882>>>>>        Send Add_Table_Value  "1"  "’¨å«¦¬"
41883>>>>>    End_Procedure    // Fill_List
41884>>>>>    //DDB-ValidationCustomStart
41884>>>>>    //DDB-ValidationCustomEnd
41884>>>>>End_Object   // Baxio_Baxio_From_VT
41885>>>>>
41885>>>>>Object Baxio_Baxio_Topos_VT1  is a DescriptionValidationTable
41887>>>>>    Set Allow_Blank_State To TRUE
41888>>>>>    Set Table_Title       To "€¥ æš¨˜­¦ €«« ¡ãª / „§˜¨®å˜ª"
41889>>>>>
41889>>>>>    Procedure Fill_List
41891>>>>>        Forward Send Fill_List
41893>>>>>        Send Add_Table_Value  "0"  "€«« ¡ãª"
41894>>>>>        Send Add_Table_Value  "1"  "„§˜¨®å˜ª"
41895>>>>>    End_Procedure    // Fill_List
41896>>>>>    //DDB-ValidationCustomStart
41896>>>>>    //DDB-ValidationCustomEnd
41896>>>>>End_Object   // Baxio_Baxio_Topos_VT1
41897>>>>>//DDB-ValidationEnd
41897>>>>>//DDB-SelectionStart
41897>>>>>//DDB/ ExternalSelectionList SL037  SL037.SL
41897>>>>>//DDB/ ExternalSelectionList slNomism  slnomism.sl
41897>>>>>Register_Object SL037
41897>>>>>Register_Object slNomism
41897>>>>>//DDB-SelectionEnd
41897>>>>>
41897>>>>>Class Baxio_DataDictionary  is a DataDictionary_Sec
41898>>>>>
41898>>>>>      Procedure Construct_Object
41899>>>>>                Forward Send Construct_Object
41901>>>>>
41901>>>>>                //btypkin related properties:
41901>>>>>                //œ¤ž£œ¨é¤¦¤«˜  ©«ã¤: update «¦¬ bmove,
41901>>>>>                //£ž›œ¤å¦¤«˜   ©«ž¤: request save & delete «¦¬ bmove.
41901>>>>>                Property Integer piBtypkin_Flag03 0
41902>>>>>                Property Integer piBtypkin_Flag04 0
41903>>>>>                Property Integer pifromxrhsh      0
41904>>>>>
41904>>>>>                //baxio related properties:
41904>>>>>                //œ¤ž£œ¨é¤œ«˜     ©«ž¤: creating,
41904>>>>>                //®¨ž© £¦§¦ œå«˜  ©«ž¤: update «¦¬ bmove š ˜ ¤˜ œ¤œ¨š¦§¦ ã©œ  «ž¤ private.created_baxio «¦¬ bmove,
41904>>>>>                //£ž›œ¤åœ«˜      ©«ž¤: request save & delete «¦¬ bmove.
41904>>>>>                Property Integer piCreated_Baxio  0
41905>>>>>
41905>>>>>                //œ¤ž£œ¨é¤¦¤«˜     ©«ž¤: backout,
41905>>>>>                //®¨ž© £¦§¦ ¦ç¤«˜  ©«ž¤: validate_save š ˜ «¦¤ â¢œš®¦ editing «¦¬ baxio,
41905>>>>>                //£ž›œ¤å¦¤«˜      ©«ž¤: request save & delete «¦¬ bmove.
41905>>>>>                Property Number  pnB_Baxio_V2      0
41906>>>>>                Property Number  pnB_Baxio_V0      0
41907>>>>>                Property Number  pnB_Baxio_V00     0
41908>>>>>                Property Number  pnB_Baxio_Vr      0
41909>>>>>                Property String  psB_Baxio_C_Code2 ""
41910>>>>>                Property Integer piB_Baxio_Status  0
41911>>>>>                Property Integer piB_Baxio_Place   0
41912>>>>>
41912>>>>>                //properties š ˜ œ¢âš®¦¬ª ˜¢˜ššãª parent records:
41912>>>>>                //œ¤ž£œ¨é¤¦¤«˜     ©«ž¤:backout,
41912>>>>>                //®¨ž© £¦§¦ ¦ç¤«˜  ©«ž¤: validate_save š ˜ «¦¤ â¢œš®¦ editing «à¤ §œ›åà¤,
41912>>>>>                //£ž›œ¤å¦¤«˜      ©«ž¤: request save & delete «¦¬ bmove.
41912>>>>>                Property Integer piB_Baxiokat_Code 0
41913>>>>>                Property Integer piB_Year_Year     0
41914>>>>>                Property Integer piMustNOTConstrain Public 0
41915>>>>>      End_Procedure //construct_object
41916>>>>>
41916>>>>>
41916>>>>>
41916>>>>>//    Function fngConvertPoso_Baxio String asNomismaCodeApo ;
41916>>>>>//                            Number anPoso           ;
41916>>>>>//                            String asNomismaCodeSe  ;
41916>>>>>//                            Date   adHmnia          ;
41916>>>>>//                            Number nIsotimia  Returns Number
41916>>>>>
41916>>>>>//        Number rVal nApo_Euro_Isot nSe_Euro_Isot
41916>>>>>//        Integer iApo_Einai_Euro_Zone iApo_Einai_DRX iApo_Einai_Euro iDekadika_Apo
41916>>>>>//        Integer iSe_Einai_Euro_Zone  iSe_Einai_DRX  iSe_Einai_Euro  iDekadika_Se
41916>>>>>
41916>>>>>//        If (asNomismaCodeApo=asNomismaCodeSe) Function_Return anPoso
41916>>>>>
41916>>>>>//        Clear Nomisma
41916>>>>>//        Move (Trim(asNomismaCodeApo)) to Nomisma.Nomisma_Code
41916>>>>>//        Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
41916>>>>>//        Move Nomisma.Euro_Zone      to iApo_Einai_Euro_Zone
41916>>>>>//        Move Nomisma.Einai_DRX      to iApo_Einai_DRX
41916>>>>>//        Move Nomisma.Einai_EURO     to iApo_Einai_Euro
41916>>>>>//        Move Nomisma.KL_ISOT_EURO   to nApo_Euro_Isot
41916>>>>>//        Move Nomisma.Dekadika       to iDekadika_Apo
41916>>>>>
41916>>>>>//        Clear Nomisma
41916>>>>>//        Move (Trim(asNomismaCodeSe)) to Nomisma.Nomisma_Code
41916>>>>>//        Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
41916>>>>>//        Move Nomisma.Euro_Zone      to iSe_Einai_Euro_Zone
41916>>>>>//        Move Nomisma.Einai_DRX      to iSe_Einai_DRX
41916>>>>>//        Move Nomisma.Einai_EURO     to iSe_Einai_Euro
41916>>>>>//        Move Nomisma.KL_ISOT_EURO   to nSe_Euro_Isot
41916>>>>>//        Move Nomisma.Dekadika       to iDekadika_Se
41916>>>>>
41916>>>>>//        //05a. ??ÿ??? ? --> ??? 
41916>>>>>//        Calc (anPoso/nApo_Euro_Isot) to rVal
41916>>>>>//        Move (Round_Number(rVal,6)) to rVal
41916>>>>>//        //05b. ???         --> ??ÿ??? ?™ *
41916>>>>>//        Calc (rVal*nSe_Euro_Isot) to rVal
41916>>>>>//        Move (Round_Number(rVal,iDekadika_Se)) to rVal
41916>>>>>//        Function_Return rVal
41916>>>>>//    End_Function
41916>>>>>
41916>>>>>
41916>>>>>
41916>>>>>      //¡˜Ÿ¦¨åœ  «ž¤ default « £ã «¦¬ ¤¦£å©£˜«¦ª ˜¤á¢¦š˜ £œ «¦ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
41916>>>>>      Function Default_Axio_C_Code2 Returns String
41917>>>>>               String lsBaxio_C_Code_2
41918>>>>>               //Get File_Field_Current_Value File_Field SyscurXr.C_Code0 to lsBaxio_C_Code_2
41918>>>>>               Move SyscurXr.C_Code0 to lsBaxio_C_Code_2
41919>>>>>               Function_Return (Trim(lsBaxio_C_Code_2))
41920>>>>>      End_Function //default_axio_c_code2
41921>>>>>
41921>>>>>
41921>>>>>      // js 09/02/2002 den yparxei enhmerosh ton nomismatvn xrhshs
41921>>>>>      Procedure Convert_Axio_Values
41922>>>>>
41922>>>>>                Integer liBtypkin_Flag03 liBtypkin_Flag04
41923>>>>>
41923>>>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_Code0    ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_Rate0       to Baxio.Baxio_V0
41924>>>>>
41924>>>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_Code00   ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_Rate00      to Baxio.Baxio_V00
41925>>>>>
41925>>>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_CodeR    ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_RateR       to Baxio.Baxio_VR
41926>>>>>
41926>>>>>
41926>>>>>//                Move (fngConvertPoso_Baxio(Self,Baxio.Baxio_C_Code2,   ;
41926>>>>>//                                     Baxio.Baxio_V2,        ;
41926>>>>>//                                     SyscurXr.C_Code0,      ;
41926>>>>>//                                     Baxio.Baxio_HmniaE,    ;
41926>>>>>//                                     Baxio.Baxio_Rate0)     ;
41926>>>>>//                                    ) to Baxio.Baxio_V0
41926>>>>>//                If (liBtypkin_Flag03 = TRUE);
41926>>>>>//                     Begin
41926>>>>>//                      //˜¥å˜ 2-->00
41926>>>>>//                      Move (fngConvertPoso_Baxio(Self, Baxio.Baxio_C_Code2, ;
41926>>>>>//                                            Baxio.Baxio_V2,      ;
41926>>>>>//                                            SyscurXr.C_Code00,   ;
41926>>>>>//                                            Baxio.Baxio_HmniaE,  ;
41926>>>>>//                                            Baxio.Baxio_Rate00)  ;
41926>>>>>//                                          ) to Baxio.Baxio_V00
41926>>>>>//                     End
41926>>>>>//                Else Begin
41926>>>>>//                      Move 0            to Baxio.Baxio_V00
41926>>>>>//                     End
41926>>>>>//                If (liBtypkin_Flag04 = TRUE);
41926>>>>>//                     Begin
41926>>>>>//                      //˜¥å˜ 2-->r
41926>>>>>//                      Move (fngConvertPoso_Baxio(Self,Baxio.Baxio_C_Code2, ;
41926>>>>>//                                       Baxio.Baxio_V2,      ;
41926>>>>>//                                       SyscurXr.C_CodeR,    ;
41926>>>>>//                                       Baxio.Baxio_HmniaE,  ;
41926>>>>>//                                       Baxio.Baxio_RateR)   ;
41926>>>>>//                                      ) to Baxio.Baxio_VR
41926>>>>>//                     End
41926>>>>>//                Else Begin
41926>>>>>//                      Move 0            to Baxio.Baxio_VR
41926>>>>>//                     End
41926>>>>>      End_Procedure
41927>>>>>
41927>>>>>
41927>>>>>
41927>>>>>      Procedure Constrain
41928>>>>>                Forward Send Constrain
41930>>>>>                If (piMustNOTConstrain(Self)=1) Begin
41932>>>>>                End 
41932>>>>>>
41932>>>>>                else If (piMustNOTConstrain(Self)=2) Begin 
41935>>>>>                    Constrain Baxio.Company_Code Eq Syscurxr.Company_Code
41937>>>>>                    Constrain Baxio.Branch_Code  Eq Syscurxr.Branch_Code
41939>>>>>                end    
41939>>>>>>
41939>>>>>                Else Begin
41940>>>>>                    Constrain Baxio.Company_Code Eq Syscurxr.Company_Code
41942>>>>>                    Constrain Baxio.Branch_Code  Eq Syscurxr.Branch_Code
41944>>>>>                    Constrain Baxio.Year_Year    Eq Syscurxr.Year_Year
41946>>>>>                End
41946>>>>>>
41946>>>>>      End_Procedure   //constrain
41947>>>>>
41947>>>>>
41947>>>>>      //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
41947>>>>>      //™) ˜¤áš¤à©ž properties
41947>>>>>      //š) › ˜®œå¨ ©ž calculated §œ›åà¤
41947>>>>>      //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
41947>>>>>      //œ) œ¤ž£â¨à©ž properties after
41947>>>>>      Procedure Update
41948>>>>>                Forward Send Update
41950>>>>>                
41950>>>>>                If (Baxio.Baxio_C_Code2='') Move SyscurXr.C_Code0 to Baxio.Baxio_C_Code2
41953>>>>>                
41953>>>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
41953>>>>>                Move Syscurxr.Company_Code  to Baxio.Company_Code
41954>>>>>                Move Syscurxr.Branch_Code   to Baxio.Branch_Code
41955>>>>>                Move Syscurxr.Year_Year     to Baxio.Year_Year
41956>>>>>                Move Syscurxr.Year_Recr     to Baxio.Year_Recr
41957>>>>>                Move Baxiokat.Baxiokat_Code to Baxio.Baxiokat_Code
41958>>>>>
41958>>>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
41958>>>>>                //š01:œ¥ ¦¨ ©£¦ç, «˜ §¢ž¨à«â˜ ›â¤ â®¦¬¤ ©«¦ ®œå˜ §˜¨˜¢¢˜™ãª
41958>>>>>                If (Baxiokat.Baxiokat_Type = 2);                Begin //˜¥ æš¨˜­˜ §¢ž¨à«â˜
41960>>>>>                     Move "" to Baxio.Baxio_Code_In
41961>>>>>                     Move "" to Baxio.Baxio_Epon_In
41962>>>>>                     Move 0  to Baxio.Baxio_Fpar_In
41963>>>>>                End
41963>>>>>>
41963>>>>>                //š02:yyyy + mm + dd ¢ã¥žª š ˜ «˜ reports
41963>>>>>                Move (TheYearSegment (Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_YYYY
41964>>>>>                Move (TheMonthSegment(Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_MM
41965>>>>>                Move (TheDaySegment  (Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_DD
41966>>>>>
41966>>>>>                //š03:§¨é«¦ª & «œ¢œ¬«˜å¦ª §˜¨˜¢ã§«žª
41966>>>>>                If (Baxio.Baxio_Lcode = "");                Begin
41968>>>>>                     Move (-1) to Baxio.Baxio_File_Out
41969>>>>>                     Move ""   to Baxio.Baxio_Code_Out
41970>>>>>                     Move ""   to Baxio.Baxio_Epon_Out
41971>>>>>                     Move ""   to Baxio.Baxio_Fpar_Out
41972>>>>>
41972>>>>>                     Move (-1) to Baxio.Baxio_Lfile
41973>>>>>                     Move ""   to Baxio.Baxio_Lepon
41974>>>>>                     Move ""   to Baxio.Baxio_Lpar
41975>>>>>                End
41975>>>>>>
41975>>>>>      End_Procedure //update
41976>>>>>
41976>>>>>
41976>>>>>      Procedure Backout
41977>>>>>                Forward Send Backout
41979>>>>>
41979>>>>>                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
41979>>>>>                Set pnB_Baxio_V2      to Baxio.Baxio_V2
41980>>>>>                Set pnB_Baxio_V0      to Baxio.Baxio_V0
41981>>>>>                Set pnB_Baxio_V00     to Baxio.Baxio_V00
41982>>>>>                Set pnB_Baxio_Vr      to Baxio.Baxio_Vr
41983>>>>>                Set psB_Baxio_C_Code2 to Baxio.Baxio_C_Code2
41984>>>>>                Set piB_Baxio_Status  to Baxio.Baxio_Status
41985>>>>>                Set piB_Baxio_Place   to Baxio.Baxio_Place
41986>>>>>                Set piB_Baxiokat_Code to Baxio.Baxiokat_Code    //š ˜ â¢œš®¦ ˜¢˜ššãª parent
41987>>>>>                Set piB_Year_Year     to Baxio.Year_Year        //š ˜ â¢œš®¦ ˜¢˜ššãª parent
41988>>>>>      End_Procedure //backout
41989>>>>>
41989>>>>>
41989>>>>>      Procedure New_Current_Record Integer liOld_Record Integer liNew_Record
41990>>>>>                Forward Send New_Current_Record liOld_Record liNew_Record
41992>>>>>                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
41992>>>>>                Set pnB_Baxio_V2      to Baxio.Baxio_V2
41993>>>>>                Set pnB_Baxio_V0      to Baxio.Baxio_V0
41994>>>>>                Set pnB_Baxio_V00     to Baxio.Baxio_V00
41995>>>>>                Set pnB_Baxio_Vr      to Baxio.Baxio_Vr
41996>>>>>                Set psB_Baxio_C_Code2 to Baxio.Baxio_C_Code2
41997>>>>>                Set piB_Baxio_Status  to Baxio.Baxio_Status
41998>>>>>                Set piB_Baxiokat_Code to Baxio.Baxiokat_Code    //š ˜ â¢œš®¦ ˜¢˜ššãª parent
41999>>>>>                Set piB_Year_Year     to Baxio.Year_Year        //š ˜ â¢œš®¦ ˜¢˜ššãª parent
42000>>>>>      End_Procedure //new_current_record
42001>>>>>
42001>>>>>
42001>>>>>      Procedure Creating
42002>>>>>                Forward Send Creating
42004>>>>>
42004>>>>>                //˜¨ Ÿ£æª ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
42004>>>>>                //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBaxio
42004>>>>>
42004>>>>>                //«œ¢œ¬«˜å¦ª ¡à› ¡æª ˜¨ Ÿ£æª ˜¥ ¦š¨á­¦¬
42004>>>>>                Add 1 to Baxiokat.Baxio_Lcode
42005>>>>>                Move Baxiokat.Baxio_Lcode to Baxio.Baxio_Code
42006>>>>>
42006>>>>>                //«¦ property ˜¬«æ œ¤œ¨š¦§¦ œå «ž¤ private.created_baxio
42006>>>>>                //£â©à «žª update ©«¦ bmove
42006>>>>>                Set piCreated_Baxio to TRUE
42007>>>>>
42007>>>>>//
42007>>>>>//                Move SysCurXr.C_Code0 to Baxio.Baxio_C_Code2
42007>>>>>
42007>>>>>                Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                 (Trim(String(Baxio.Baxio_Rec0)))))) to Baxio.Baxio_Recr
42008>>>>>
42008>>>>>      End_Procedure //creating
42009>>>>>
42009>>>>>
42009>>>>>      Procedure Operation_Not_Allowed Integer iError_Num
42010>>>>>                String lsError_Message
42011>>>>>                Case Begin
42011>>>>>                     //˜§æ validate save
42011>>>>>                     Case (iError_Num = 1001)
42013>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  ¦§à©›ã§¦«œ ž£œ¨¦£ž¤å˜ ¢ã¥œàª!");                          to lsError_Message
42014>>>>>                     Case Break
42015>>>>>                     Case (iError_Num = 1002)
42018>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
42019>>>>>                     Case Break
42020>>>>>                     Case (iError_Num = 1003)
42023>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  ¦§à©›ã§¦«œ ¤æ£ ©£˜!");                          to lsError_Message
42024>>>>>                     Case Break
42025>>>>>                     Case (iError_Num = 1004)
42028>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
42029>>>>>                     Case Break
42030>>>>>                     Case (iError_Num = 1005)
42033>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
42034>>>>>                     Case Break
42035>>>>>                     Case (iError_Num = 1006)
42038>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ Reporting).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
42039>>>>>                     Case Break
42040>>>>>
42040>>>>>                     Case (iError_Num = 1007)
42043>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\nŒâ˜ €¥ æš¨˜­˜ ›ž£ ¦¬¨š¦ç¤«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
42044>>>>>                     Case Break
42045>>>>>                     Case (iError_Num = 1008)
42048>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n’¦ ¤æ£ ©£˜ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
42049>>>>>                     Case Break
42050>>>>>                     Case (iError_Num = 1009)
42053>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
42054>>>>>                     Case Break
42055>>>>>                     Case (iError_Num = 1010)
42058>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©žª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
42059>>>>>                     Case Break
42060>>>>>                     Case (iError_Num = 1011)
42063>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜ •¨ã©žª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
42064>>>>>                     Case Break
42065>>>>>                     Case (iError_Num = 1012)
42068>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (Œæ£ ©£˜ Reporting) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
42069>>>>>                     Case Break
42070>>>>>                     Case (iError_Num = 1013)
42073>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n’¦ ˜¥ æš¨˜­¦ â®œ  œ¥¦­¢žŸœå !");                          to lsError_Message
42074>>>>>                     Case Break
42075>>>>>
42075>>>>>                     Case (iError_Num = 1014)
42078>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ ›â¤ œ§ «¨â§œ«˜  ¤˜ ˜¢¢á¥œ  ¡˜«žš¦¨å˜!");                          to lsError_Message
42079>>>>>                     Case Break
42080>>>>>                     Case (iError_Num = 1015)
42083>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ ›â¤ œ§ «¨â§œ«˜  ¤˜ ˜¢¢á¥œ  ®¨ã©ž!");                          to lsError_Message
42084>>>>>                     Case Break
42085>>>>>                     Case (iError_Num = 1100)
42088>>>>>                          Move "DDC 037:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
42089>>>>>                          Case Break
42090>>>>>
42090>>>>>                     //˜§æ validate delete
42090>>>>>                     Case (iError_Num = 2007)
42093>>>>>                          Move ("DDC 037:€›ç¤˜«ž ž › ˜š¨˜­ã !\n\n’¦ €¥ æš¨˜­¦ › ˜š¨á­œ«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
42094>>>>>                     Case Break
42095>>>>>                     Case (iError_Num = 2100)
42098>>>>>                          Move "DDC 037:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
42099>>>>>                          Case Break
42100>>>>>
42100>>>>>                     Case Else
42100>>>>>                          Forward Send Operation_Not_Allowed iError_Num
42102>>>>>                Case End
42102>>>>>
42102>>>>>                Error iError_Num lsError_Message
42103>>>>>>
42103>>>>>      End_Procedure // operation_not_allowed
42104>>>>>
42104>>>>>      //1001:baxio_hmnial > 0
42104>>>>>      //1002:baxio_v2 > 0            (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ œšš¨˜­ãª
42104>>>>>      //1003:baxio_c_code2 <> ""     (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ £ã¤ â®œ  ¤æ£ ©£˜)
42104>>>>>
42104>>>>>      //1004:baxio_v0 > 0            (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©žª
42104>>>>>      //1005:baxio_v00 > 0 if flag 3 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ›œ¬«œ¨œç¦¤ ¤æ£ ©£˜ ®¨ã©žª
42104>>>>>      //1006:baxio_vr > 0  of flag 4 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ reporting
42104>>>>>
42104>>>>>
42104>>>>>      //1007:›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬ œ§ «¨â§œ«˜  £æ¤¦¤ ˜§¦ «¦ bmove_dd, ›ž¢˜›ã §¨â§œ 
42104>>>>>      //       If (baxio.recnum=0) then operation_origin must be = bmove_dd
42104>>>>>      //1008:«¨¦§¦§¦åž©ž (edit) baxio_c_code2 £æ¤¦¤ ˜§æ bmove_dd
42104>>>>>      //1009:«¨¦§¦§¦åž©ž (edit) baxio_v2      £æ¤¦¤ ˜§æ bmove_dd
42104>>>>>      //1010:«¨¦§¦§¦åž©ž (edit) baxio_v0      £æ¤¦¤ ˜§æ bmove_dd
42104>>>>>      //1011:«¨¦§¦§¦åž©ž (edit) baxio_v00     £æ¤¦¤ ˜§æ bmove_dd
42104>>>>>      //1012:«¨¦§¦§¦åž©ž (edit) baxio_vr      £æ¤¦¤ ˜§æ bmove_dd
42104>>>>>
42104>>>>>      //1013:œá¤ «¦ status œå¤˜  œ¥¦­¢ž£â¤¦, ˜§˜š¦¨œçœ¦¤«˜  æ¢˜ «˜ §œ¨˜ «â¨à edits
42104>>>>>
42104>>>>>      //1014:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent baxiokat record
42104>>>>>      //1015:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent year     record
42104>>>>>      Function Validate_Save Returns Integer
42105>>>>>               Integer iReturnVal
42106>>>>>
42106>>>>>               Forward Get Validate_Save to iReturnVal
42108>>>>>
42108>>>>>               If (Not(iReturnVal));               Begin
42110>>>>>
42110>>>>>                //---------â¢œš®¦  ›ž£ ¦¬¨šå˜ª ¤â¦¬ baxio record----------------------
42110>>>>>                //sososo £ž§àª §¨œ§œ  ¤˜ §˜ ¥à £œ «ž¤ current record ????
42110>>>>>                If (Baxio.Recnum =  0);                Begin //œá¤ ›ž£ ¦¬¨šé ¤â¦ record
42112>>>>>                      //1007:â¢œš®¦ª ›ž£ ¦¬¨šå˜ª ¤â¦¬ ˜¥ ¦š¨á­¦¬ ˜§¦ «¦ baxio_dd
42112>>>>>
42112>>>>>                      If (pifromxrhsh(Self)=0) Begin
42114>>>>>                        If (Not((Main_File(OPERATION_ORIGIN)) =  Bmove.File_Number)) Send Operation_Not_Allowed 1007
42117>>>>>                      End
42117>>>>>>
42117>>>>>                End   //«â¢¦ª œ¢âš®à¤ ›ž£ ¦¬¨šå˜ª ¤â¦¬ baxio record
42117>>>>>>
42117>>>>>
42117>>>>>
42117>>>>>                //---------â¢œš®¦  editing existing baxio records---------------------
42117>>>>>                Else;                Begin //edit an existing record
42118>>>>>                      //1008:«¨¦§¦§¦åž©ž (edit) baxio_c_code2 £æ¤¦¤ ˜§æ bmove_dd
42118>>>>>
42118>>>>>                      If (pifromxrhsh(Self)=0) Begin
42120>>>>>
42120>>>>>                        If (;                            ((psB_Baxio_C_Code2(Self))     <> Baxio.Baxio_C_Code2) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1008
42123>>>>>                        //1009:«¨¦§¦§¦åž©ž (edit) baxio_v2 £æ¤¦¤ ˜§æ bmove_dd
42123>>>>>                        If (;                            ((pnB_Baxio_V2(Self))          <> Baxio.Baxio_V2      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1009
42126>>>>>                        //1010:«¨¦§¦§¦åž©ž (edit) baxio_v0 £æ¤¦¤ ˜§æ bmove_dd
42126>>>>>                        If (;                            ((pnB_Baxio_V0(Self))          <> Baxio.Baxio_V0      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1010
42129>>>>>                        //1011:«¨¦§¦§¦åž©ž (edit) baxio_v00 £æ¤¦¤ ˜§æ bmove_dd
42129>>>>>                        If (;                            ((pnB_Baxio_V00(Self))         <> Baxio.Baxio_V00     ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1011
42132>>>>>                        //1012:«¨¦§¦§¦åž©ž (edit) baxio_vr £æ¤¦¤ ˜§æ bmove_dd
42132>>>>>                        If (;                            ((pnB_Baxio_Vr(Self))          <> Baxio.Baxio_Vr      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1012
42135>>>>>
42135>>>>>                      End
42135>>>>>>
42135>>>>>                        // Egine rem 20/12/2001 giati an orisoume sta metrhta gia paradeigma
42135>>>>>                        // oti to status SE einai exoflhmeno, tote xtypaei to validation sto
42135>>>>>                        // kleisimo toy barticle. Alloste den vlepoume giati den mporei na
42135>>>>>                        // anoigokleisei
42135>>>>>//                      //1013:œá¤ «¦ status œå¤˜  œ¥¦­¢ž£â¤¦, ˜§˜š¦¨œç¦¤«˜  æ¢˜ «˜ §œ¨˜ «â¨à edits ˜§¦ «¦ bmove
42135>>>>>//                      If (;
42135>>>>>//                           ((piB_Baxio_Status(Self))      = 2                    ) and;
42135>>>>>//                           ((Main_File(OPERATION_ORIGIN)) =  Bmove.File_Number);
42135>>>>>//                         )                                                       Send Operation_Not_Allowed 1013
42135>>>>>
42135>>>>>                      If (pifromxrhsh(Self)=0) Begin
42137>>>>>                        //1014:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent baxiokat record
42137>>>>>                        If (Not;                            ((piB_Baxiokat_Code(Self)) =  Baxiokat.Baxiokat_Code);                            )                                                       Send Operation_Not_Allowed 1014
42140>>>>>
42140>>>>>                        //1015:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent year record
42140>>>>>                        If (Not;                            ((piB_Year_Year    (Self)) =  SysCurXr.Year_Year        );                            )                                                       Send Operation_Not_Allowed 1015
42143>>>>>                      End
42143>>>>>>
42143>>>>>                End   //«â¢¦ª œ¢âš®à¤ editing existing baxio records
42143>>>>>>
42143>>>>>
42143>>>>>                //¢¦§¦å â¢œš®¦ 
42143>>>>>                //1001:baxio_hmnial > 0
42143>>>>>                If (Not(Baxio.Baxio_Hmnial > 0 ))   Send Operation_Not_Allowed 1001
42146>>>>>                //1002:baxio_v2 > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ œšš¨˜­ãª
42146>>>>>                If (Not(Baxio.Baxio_V2 > 0))         Send Operation_Not_Allowed 1002
42149>>>>>                //1003:baxio_c_code2 <> ""
42149>>>>>                If (Not(Baxio.Baxio_C_Code2 <>""))    Send Operation_Not_Allowed 1003
42152>>>>>                //1004:baxio_v0 > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
42152>>>>>//--------------If (Not(Baxio.Baxio_V0 > 0))         Send Operation_Not_Allowed 1004
42152>>>>>                //1005:baxio_v00> 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ›œ¬«œ¨œç¦¤ ¤æ£ ©£˜ ®¨ã©œàª
42152>>>>>//--------------If (Not(Baxio.Baxio_V00> 0))         Send Operation_Not_Allowed 1005
42152>>>>>                //1006:baxio_vr > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ reporting
42152>>>>>//--------------If (Not(Baxio.Baxio_VR > 0))         Send Operation_Not_Allowed 1006
42152>>>>>                //1100:cby = globals
42152>>>>>
42152>>>>>                If (pifromxrhsh(Self)=0) Begin
42154>>>>>
42154>>>>>                    If ( ;                        (Not(Baxio.Company_Code = SyscurXr.Company_Code)) or;                        (Not(Baxio.Branch_Code  = SyscurXr.Branch_Code )) or;                        (Not(Baxio.Year_Year    = SyscurXr.Year_Year   ));                        )                                                   Send Operation_Not_Allowed 1100
42157>>>>>
42157>>>>>               End
42157>>>>>>
42157>>>>>
42157>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
42157>>>>>>
42157>>>>>               Function_Return iReturnVal
42158>>>>>      End_Function //validate_save
42159>>>>>
42159>>>>>
42159>>>>>      //2007:ž › ˜š¨˜­ã ˜¥ ¦š¨á­¦¬ œ§ «¨â§œ«˜  £æ¤¦¤ ˜§¦ «¦ bmove_dd
42159>>>>>      Function Validate_Delete  Returns Integer
42160>>>>>               Integer iReturnVal
42161>>>>>               Forward Get Validate_Delete  To iReturnVal
42163>>>>>               If (Not(iReturnVal));               Begin
42165>>>>>
42165>>>>>                  //2007:â¢œš®¦ª › ˜š¨˜­ãª ˜¥ ¦š¨á­¦¬ (£æ¤¦¤ ˜§¦ bmove_dd)
42165>>>>>                  If ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number)          Send Operation_Not_Allowed 2007
42168>>>>>
42168>>>>>                  //2100:cby = globals
42168>>>>>                  If ( ;                      (Not(Baxio.Company_Code = Syscurxr.Company_Code)) or;                      (Not(Baxio.Branch_Code  = Syscurxr.Branch_Code )) or;                      (Not(Baxio.Year_Year    = Syscurxr.Year_Year        ));                      )                                                   Send Operation_Not_Allowed 2100
42171>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
42171>>>>>>
42171>>>>>               Function_Return iReturnVal
42172>>>>>      End_Function //validate_delete
42173>>>>>
42173>>>>>
42173>>>>>//------------------------------------------------------------------
42173>>>>>    Procedure Define_Fields
42174>>>>>        Forward Send Define_Fields
42176>>>>>        //DDB-Generated-Code-Location
42176>>>>>        //DDB-DefineFieldStart
42176>>>>>
42176>>>>>        Set Main_File            To Baxio.File_Number
42177>>>>>        Set Cascade_Delete_State To FALSE
42178>>>>>
42178>>>>>
42178>>>>>        // Child (Client) file structure................
42178>>>>>        Send Add_Client_File  Bmove.File_Number
42179>>>>>
42179>>>>>        // Parent (Server) file structure...............
42179>>>>>        Send Add_Server_File  Baxiokat.File_Number
42180>>>>>
42180>>>>>        // External (System) file structure.............
42180>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
42181>>>>>
42181>>>>>        Define_Auto_Increment  Sysrecb.Baxio_Rec0  To Baxio.Baxio_Rec0
42184>>>>>
42184>>>>>        // Field-based properties.......................
42184>>>>>
42184>>>>>        // Baxio.Company_Code
42184>>>>>
42184>>>>>        // Baxio.Branch_Code
42184>>>>>
42184>>>>>        // Baxio.Year_Year
42184>>>>>
42184>>>>>        // Baxio.Baxiokat_Code
42184>>>>>
42184>>>>>        // Baxio.Baxio_Code
42184>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Code To (SL037(Self))
42185>>>>>
42185>>>>>        // Baxio.Baxio_Rec0
42185>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Rec0 To (SL037(Self))
42186>>>>>
42186>>>>>        // Baxio.Year_Recr
42186>>>>>
42186>>>>>        // Baxio.Baxiokat_Recr
42186>>>>>
42186>>>>>        // Baxio.Baxio_Recr
42186>>>>>
42186>>>>>        // Baxio.Baxio_Status
42186>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Status To (Baxio_Status_VT(Self))
42187>>>>>
42187>>>>>        // Baxio.Baxio_Place
42187>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Place To (Baxio_Baxio_Place_VT(Self))
42188>>>>>
42188>>>>>        // Baxio.Baxio_File_In
42188>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_In To (Bfile_VT(Self))
42189>>>>>
42189>>>>>        // Baxio.Baxio_Code_In
42189>>>>>        //DDB/ Comment_Short       Field Baxio.Baxio_Code_In To "To BIAXIOKAT_FILE ¡˜Ÿ¦¨åœ  «ž¤ ©®œ« ¡ã ¢å©«˜"
42189>>>>>
42189>>>>>        // Baxio.Baxio_Epon_In
42189>>>>>
42189>>>>>        // Baxio.Baxio_Fpar_In
42189>>>>>
42189>>>>>        // Baxio.Baxio_File_Out
42189>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_Out To (Bfile_VT(Self))
42190>>>>>
42190>>>>>        // Baxio.Baxio_Code_Out
42190>>>>>
42190>>>>>        // Baxio.Baxio_Epon_Out
42190>>>>>
42190>>>>>        // Baxio.Baxio_Fpar_Out
42190>>>>>
42190>>>>>        // Baxio.Baxio_Lfile
42190>>>>>
42190>>>>>        // Baxio.Baxio_Lcode
42190>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Lcode To (Bfile_VT(Self))
42191>>>>>
42191>>>>>        // Baxio.Baxio_Lepon
42191>>>>>
42191>>>>>        // Baxio.Baxio_Lpar
42191>>>>>
42191>>>>>        // Baxio.Baxio_Bank00000
42191>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Bank00000 To (Baxio_Baxio_Bank_VT(Self))
42192>>>>>
42192>>>>>        // Baxio.Baxio_Hmniae
42192>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniae To (SL037(Self))
42193>>>>>
42193>>>>>        // Baxio.Baxio_Hmniap000
42193>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniap000 To (SL037(Self))
42194>>>>>
42194>>>>>        // Baxio.Baxio_Hmnial
42194>>>>>        //DDB/ Comment_Short       Field Baxio.Baxio_Hmnial To "†£/¤å˜ Šã¥žª:"
42194>>>>>
42194>>>>>        // Baxio.Baxio_Ekdoths
42194>>>>>
42194>>>>>        // Baxio.Baxio_Ekdothse
42194>>>>>
42194>>>>>        // Baxio.Baxio_Sediatagh
42194>>>>>
42194>>>>>        // Baxio.Baxio_Sdiataghe
42194>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Sdiataghe To (SL037(Self))
42195>>>>>
42195>>>>>        // Baxio.Baxio_Banka
42195>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Banka To (Baxio_Baxio_Banka_VT(Self))
42196>>>>>
42196>>>>>        // Baxio.Baxio_Opistho
42196>>>>>
42196>>>>>        // Baxio.Baxio_No
42196>>>>>
42196>>>>>        // Baxio.Baxio_V2
42196>>>>>
42196>>>>>        // Baxio.Baxio_V0
42196>>>>>
42196>>>>>        // Baxio.Baxio_V00
42196>>>>>
42196>>>>>        // Baxio.Baxio_Vr
42196>>>>>
42196>>>>>        // Baxio.Baxio_Rate0
42196>>>>>
42196>>>>>        // Baxio.Baxio_Rate00
42196>>>>>
42196>>>>>        // Baxio.Baxio_Rater
42196>>>>>
42196>>>>>        // Baxio.Baxio_C_Code2
42196>>>>>        Set Field_Entry_msg        Field Baxio.Baxio_C_Code2 To get_Default_Axio_C_Code2
42197>>>>>        Set Field_Options          Field Baxio.Baxio_C_Code2 To DD_CAPSLOCK   
42198>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_C_Code2 To (slNomism(Self))
42199>>>>>
42199>>>>>        // Baxio.Baxio_Lixi_Yyyy
42199>>>>>
42199>>>>>        // Baxio.Baxio_Lixi_Mm
42199>>>>>
42199>>>>>        // Baxio.Baxio_Lixi_Dd
42199>>>>>
42199>>>>>        // Baxio.Baxio_Bmove_Laa
42199>>>>>
42199>>>>>        // Baxio.Baxio_Desm
42199>>>>>
42199>>>>>        // Baxio.Baxio_From
42199>>>>>        Set Field_Value_Table      Field Baxio.Baxio_From To (Baxio_Baxio_From_VT(Self))
42200>>>>>
42200>>>>>        // Baxio.Baxio_Topos
42200>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Topos To (Baxio_Baxio_Topos_VT1(Self))
42201>>>>>
42201>>>>>        //DDB-DefineFieldEnd
42201>>>>>
42201>>>>>        Set Main_File            To Baxio.File_Number
42202>>>>>        Set Cascade_Delete_State To FALSE
42203>>>>>
42203>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
42204>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
42205>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
42206>>>>>
42206>>>>>        // Child (Client) file structure................
42206>>>>>        Send Add_Client_File  Bmove.File_Number
42207>>>>>
42207>>>>>        // Parent (Server) file structure...............
42207>>>>>        Send Add_Server_File  Baxiokat.File_Number
42208>>>>>
42208>>>>>        // External (System) file structure.............
42208>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
42209>>>>>
42209>>>>>        Define_Auto_Increment  Sysrecb.Baxio_Rec0  To Baxio.Baxio_Rec0
42212>>>>>
42212>>>>>        // Field-based properties.......................
42212>>>>>
42212>>>>>        // Baxio.Company_Code
42212>>>>>
42212>>>>>        // Baxio.Branch_Code
42212>>>>>
42212>>>>>        // Baxio.Year_Year
42212>>>>>
42212>>>>>        // Baxio.Baxiokat_Code
42212>>>>>
42212>>>>>        // Baxio.Baxio_Code
42212>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Code         To "‰à› ¡æª €¥ ¦š¨á­¦¬"
42213>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Code         To "‰à› ¡æª"
42214>>>>>        Set Field_Options          Field Baxio.Baxio_Code         To DD_AUTOFIND    DD_NOPUT
42215>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Code         To (sl037(Self))
42216>>>>>        Set Key_Field_State        Field Baxio.Baxio_Code         To TRUE
42217>>>>>
42217>>>>>        // Baxio.Baxio_Rec0
42217>>>>>        Set Field_Options          Field Baxio.Baxio_Rec0         To DD_AUTOFIND    DD_REQUIRED
42218>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Rec0         To (sl037(Self))
42219>>>>>        Set Key_Field_State        Field Baxio.Baxio_Rec0         To TRUE
42220>>>>>
42220>>>>>        // Baxio.Year_Rec0
42220>>>>>
42220>>>>>        // Baxio.Baxiokat_Rec0
42220>>>>>
42220>>>>>        // Baxio.Baxio_Status
42220>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Status       To "dbComboForm_EZ"
42221>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Status       To "‰˜«á©«˜©ž"
42222>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Status       To "‰˜«á©«˜©ž"
42223>>>>>        Set Field_Options  Field Baxio.Baxio_Status  To DD_DISPLAYONLY
42224>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Status       To (Baxio_Status_VT(Self))
42225>>>>>
42225>>>>>        // Baxio.Baxio_Place
42225>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Place        To "dbComboForm_EZ"
42226>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Place        To "„¬¨å©¡œ«˜ "
42227>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Place        To "„¬¨å©¡œ«˜ "
42228>>>>>        Set Field_Options          Field Baxio.Baxio_Place        To DD_DISPLAYONLY
42229>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Place        To (Baxio_Baxio_Place_VT(Self))
42230>>>>>
42230>>>>>        // Baxio.Baxio_File_In
42230>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_In      To (Bfile_VT(Self))
42231>>>>>
42231>>>>>        // Baxio.Baxio_Code_In
42231>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Code_In      To "˜¨œ¢ã­Ÿž €§æ"
42232>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Code_In      To "˜¨œ¢ã­Ÿž €§æ"
42233>>>>>        Set Field_Options          Field Baxio.Baxio_Code_In      To DD_DISPLAYONLY
42234>>>>>
42234>>>>>        // Baxio.Baxio_Epon_In
42234>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Epon_In      To "„§à¤¬£å˜"
42235>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Epon_In      To "„§à¤¬£å˜"
42236>>>>>        Set Field_Options          Field Baxio.Baxio_Epon_In      To DD_DISPLAYONLY
42237>>>>>
42237>>>>>        // Baxio.Baxio_Fpar_In
42237>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Fpar_In      To "˜¨/¡æ ˜¨˜¢˜™ãª"
42238>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Fpar_In      To "˜¨/¡æ ˜¨˜¢."
42239>>>>>        Set Field_Options          Field Baxio.Baxio_Fpar_In      To DD_DISPLAYONLY
42240>>>>>
42240>>>>>        // Baxio.Baxio_File_Out
42240>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_Out     To (Bfile_VT(Self))
42241>>>>>
42241>>>>>        // Baxio.Baxio_Code_Out
42241>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Code_Out     To "¨é«¦ª ˜¨˜¢ã§«žª"
42242>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Code_Out     To "¨é«¦ª ˜¨˜¢ã§«žª"
42243>>>>>        Set Field_Options          Field Baxio.Baxio_Code_Out     To DD_DISPLAYONLY
42244>>>>>
42244>>>>>        // Baxio.Baxio_Epon_Out
42244>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Epon_Out     To "„§à¤¬£å˜"
42245>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Epon_Out     To "„§à¤¬£å˜"
42246>>>>>        Set Field_Options          Field Baxio.Baxio_Epon_Out     To DD_DISPLAYONLY
42247>>>>>
42247>>>>>        // Baxio.Baxio_Fpar_Out
42247>>>>>        Set Field_Options          Field Baxio.Baxio_Fpar_Out     To DD_DISPLAYONLY
42248>>>>>
42248>>>>>        // Baxio.Baxio_Lfile
42248>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Lfile        To (Bfile_VT(Self))
42249>>>>>
42249>>>>>        // Baxio.Baxio_Lcode
42249>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Lcode        To "’œ¢œ¬«˜å¦ª ˜¨˜¢ã§«žª"
42250>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Lcode        To "’œ¢.˜¨˜¢ã§«žª"
42251>>>>>        Set Field_Options          Field Baxio.Baxio_Lcode        To DD_DISPLAYONLY
42252>>>>>
42252>>>>>        // Baxio.Baxio_Lepon
42252>>>>>        Set Field_Options          Field Baxio.Baxio_Lepon        To DD_DISPLAYONLY
42253>>>>>
42253>>>>>        // Baxio.Baxio_Lpar
42253>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Lpar         To "˜¨/¡æ ˜¨á›¦©žª"
42254>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Lpar         To "˜¨/¡æ ˜¨á›¦©žª"
42255>>>>>        Set Field_Options          Field Baxio.Baxio_Lpar         To DD_DISPLAYONLY
42256>>>>>
42256>>>>>        // Baxio.Baxio_Bank00000
42256>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Bank00000    To "dbComboForm_EZ"
42257>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Bank00000    To (Baxio_Baxio_Bank_VT(Self))
42258>>>>>
42258>>>>>        // Baxio.Baxio_Hmniae
42258>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmniae       To "dbSpinForm_EZ"
42259>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmniae       To "†£/¤å˜ „¡›¦©žª"
42260>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmniae       To "†£/¤å˜ „¡›¦©žª"
42261>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniae       To (sl037(Self))
42262>>>>>
42262>>>>>        // Baxio.Baxio_Hmniap000
42262>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmniap000    To "dbSpinForm_EZ"
42263>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmniap000    To "†£/¤å˜ ˜¨˜¢˜™ãª"
42264>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmniap000    To "†£/¤å˜ ˜¨˜¢˜™ãª"
42265>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniap000    To (sl037(Self))
42266>>>>>
42266>>>>>        // Baxio.Baxio_Hmnial
42266>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmnial       To "dbSpinForm_EZ"
42267>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmnial       To "†£/¤å˜ Šã¥žª"
42268>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmnial       To "†£/¤å˜ Šã¥žª"
42269>>>>>        Set Field_Options          Field Baxio.Baxio_Hmnial       To DD_REQUIRED
42270>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmnial       To (sl037(Self))
42271>>>>>
42271>>>>>        // Baxio.Baxio_Ekdoths
42271>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Ekdoths      To "€¨® ¡æª „¡›æ«žª"
42272>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Ekdoths      To "€¨®.„¡›æ«žª"
42273>>>>>
42273>>>>>        // Baxio.Baxio_Ekdothse
42273>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Ekdothse     To "„§à¤¬£å˜ €¨® ¡¦ç „¡›æ«ž"
42274>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Ekdothse     To "„§à¤¬£å˜"
42275>>>>>
42275>>>>>        // Baxio.Baxio_Sediatagh
42275>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Sediatagh    To "‘œ ƒ ˜«˜šã"
42276>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Sediatagh    To "‘œ ƒ ˜«˜šã"
42277>>>>>
42277>>>>>        // Baxio.Baxio_Sdiataghe
42277>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Sdiataghe    To "„§à¤¬£å˜ €¨® ¡¦ç ƒ ¡˜ ¦ç®¦¬"
42278>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Sdiataghe    To "„§à¤¬£å˜"
42279>>>>>
42279>>>>>        // Baxio.Baxio_Banka
42279>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Banka        To "dbComboForm_EZ"
42280>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Banka        To "’¨á§œ˜"
42281>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Banka        To "’¨á§œ˜"
42282>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Banka        To (Baxio_Baxio_Banka_VT(Self))
42283>>>>>
42283>>>>>        // Baxio.Baxio_Opistho
42283>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Opistho      To "Š¦ §¦å Ž§ ©Ÿ¦š¨á­¦ "
42284>>>>>
42284>>>>>        // Baxio.Baxio_No
42284>>>>>        Set Field_Label_Long       Field Baxio.Baxio_No           To "€¨ Ÿ£æª"
42285>>>>>        Set Field_Label_Short      Field Baxio.Baxio_No           To "€¨ Ÿ£æª"
42286>>>>>
42286>>>>>        // Baxio.Baxio_V2
42286>>>>>        Set Field_Label_Long       Field Baxio.Baxio_V2           To "¦©æ"
42287>>>>>        Set Field_Label_Short      Field Baxio.Baxio_V2           To "¦©æ"
42288>>>>>        Set Field_Options          Field Baxio.Baxio_V2           To DD_REQUIRED
42289>>>>>
42289>>>>>        // Baxio.Baxio_V0
42289>>>>>        Set Field_Label_Long       Field Baxio.Baxio_V0           To "¦©æ ‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª"
42290>>>>>        Set Field_Label_Short      Field Baxio.Baxio_V0           To "¦©æ(‰¬¨. Œæ£.•¨.)"
42291>>>>>
42291>>>>>        // Baxio.Baxio_V00
42291>>>>>        Set Field_Label_Long       Field Baxio.Baxio_V00          To "¦©æ ƒœ¬«œ¨œç¦¤  Œæ£ ©£˜ •¨ã©œàª"
42292>>>>>        Set Field_Label_Short      Field Baxio.Baxio_V00          To "¦©æ(ƒœ¬«. Œæ£.•¨.)"
42293>>>>>
42293>>>>>        // Baxio.Baxio_Vr
42293>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Vr           To "¦©æ Œæ£ ©£˜ Reporting"
42294>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Vr           To "¦©æ( Œæ£.Rep.)"
42295>>>>>
42295>>>>>        // Baxio.Baxio_Rate0
42295>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Rate0        To "Rate 1"
42296>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Rate0        To "Rate 1"
42297>>>>>
42297>>>>>        // Baxio.Baxio_Rate00
42297>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Rate00       To "Rate 2"
42298>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Rate00       To "Rate 2"
42299>>>>>
42299>>>>>        // Baxio.Baxio_Rater
42299>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Rater        To "Rate 3"
42300>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Rater        To "Rate 3"
42301>>>>>
42301>>>>>        // Baxio.Baxio_C_Code2
42301>>>>>        Set Field_Class_Name       Field Baxio.Baxio_C_Code2      To "dbComboForm_EZ"
42302>>>>>        Set Field_Label_Long       Field Baxio.Baxio_C_Code2      To "Œæ£ ©£˜"
42303>>>>>        Set Field_Label_Short      Field Baxio.Baxio_C_Code2      To "Œæ£ ©£˜"
42304>>>>>        Set Field_Options          Field Baxio.Baxio_C_Code2      To DD_REQUIRED
42305>>>>>
42305>>>>>        // Baxio.Baxio_Lixi_Yyyy
42305>>>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Yyyy    To DD_DISPLAYONLY
42306>>>>>
42306>>>>>        // Baxio.Baxio_Lixi_Mm
42306>>>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Mm      To DD_DISPLAYONLY
42307>>>>>
42307>>>>>        // Baxio.Baxio_Lixi_Dd
42307>>>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Dd      To DD_DISPLAYONLY
42308>>>>>
42308>>>>>        // Baxio.Baxio_Bmove_Laa
42308>>>>>        Set Field_Options          Field Baxio.Baxio_Bmove_Laa    To DD_DISPLAYONLY
42309>>>>>
42309>>>>>    End_Procedure    // Define_Fields
42310>>>>>
42310>>>>>
42310>>>>>    Procedure Field_Defaults
42311>>>>>        Forward Send Field_Defaults
42313>>>>>        //DDB-Generated-Code-Location
42313>>>>>        //DDB-FieldDefaultStart
42313>>>>>        Set Field_Changed_Value   Field Baxio.Baxio_Status To 1
42314>>>>>        Set Field_Changed_Value   Field Baxio.Baxio_Place To 1
42315>>>>>        //DDB-FieldDefaultEnd
42315>>>>>    End_Procedure    // Field_Defaults
42316>>>>>
42316>>>>>End_Class    // Baxio_DataDictionary
42317>>>>>//DDB-Selection-pkg-Start
42317>>>>>
42317>>>>>Use SL037.SL         // SL037
INCLUDING FILE: SL037.SL
42317>>>>>>>//AB/ Project SL037:BAXIO
42317>>>>>>>//AB/ Object prj is a Lookup_Project
42317>>>>>>>//AB/     Set ProjectName to "SL037:BAXIO"
42317>>>>>>>//AB/     Set ProjectFileName to "SL037.SL"
42317>>>>>>>
42317>>>>>>>// Project Object Structure
42317>>>>>>>//   SL037 is a dbModalPanelSub
42317>>>>>>>//     Baxiokat_DD is a DataDictionary
42317>>>>>>>//     Baxio_DD is a DataDictionary
42317>>>>>>>//     oSelList is a dbListSub
42317>>>>>>>//     TextBoxSub1 is a TextBoxSub
42317>>>>>>>//     cSyDateForm1 is a cSyDateForm
42317>>>>>>>//     TextBoxSub2 is a TextBoxSub
42317>>>>>>>//     cSyDateForm2 is a cSyDateForm
42317>>>>>>>//     TextBoxSub4 is a TextBoxSub
42317>>>>>>>//     TextBoxSub5 is a TextBoxSub
42317>>>>>>>//     FormSub1 is a FormSub
42317>>>>>>>//     FormSub2 is a FormSub
42317>>>>>>>//     FormSub3 is a FormSub
42317>>>>>>>//     FormSub4 is a FormSub
42317>>>>>>>//     ButtonSub1 is a ButtonSub
42317>>>>>>>//     oOK_bn is a ButtonSub
42317>>>>>>>
42317>>>>>>>// Register all objects
42317>>>>>>>Register_Object Baxio_DD
42317>>>>>>>Register_Object Baxiokat_DD
42317>>>>>>>Register_Object ButtonSub1
42317>>>>>>>Register_Object cSyDateForm1
42317>>>>>>>Register_Object cSyDateForm2
42317>>>>>>>Register_Object FormSub1
42317>>>>>>>Register_Object FormSub2
42317>>>>>>>Register_Object FormSub3
42317>>>>>>>Register_Object FormSub4
42317>>>>>>>Register_Object oOK_bn
42317>>>>>>>Register_Object oSelList
42317>>>>>>>Register_Object SL037
42317>>>>>>>Register_Object TextBoxSub1
42317>>>>>>>Register_Object TextBoxSub2
42317>>>>>>>Register_Object TextBoxSub4
42317>>>>>>>Register_Object TextBoxSub5
42317>>>>>>>
42317>>>>>>>
42317>>>>>>>
42317>>>>>>>//AB-StoreTopStart
42317>>>>>>>    
42317>>>>>>>Use sl100.sl
42317>>>>>>>
42317>>>>>>>
42317>>>>>>>//AB-StoreTopEnd
42317>>>>>>>
42317>>>>>>>//AB-IgnoreStart
42317>>>>>>>
42317>>>>>>>Use DFAllEnt.pkg
42317>>>>>>>Use dbList.Sub
42317>>>>>>>Use Txtbox.Sub
42317>>>>>>>Use cSyDateForm.Pkg
42317>>>>>>>Use Form.Sub
42317>>>>>>>Use Button.Sub
42317>>>>>>>
42317>>>>>>>
42317>>>>>>>Use BAXIOKAT.DD
42317>>>>>>>Use BAXIO.DD
42317>>>>>>>
42317>>>>>>>//AB-IgnoreEnd
42317>>>>>>>
42317>>>>>>>Object SL037 is a dbModalPanelSub
42319>>>>>>>
42319>>>>>>>    //AB-StoreTopStart
42319>>>>>>>                        
42319>>>>>>>    Property Integer piFragmaBaxiokatRec0 Public  0
42321>>>>>>>    Property Integer piFragmaBaxiokatCode Public  0
42323>>>>>>>    Property Integer piFragmaBaxioStatus  Public  0
42325>>>>>>>    Property Integer piFragmaBaxioPlace   Public  0
42327>>>>>>>    Property string  psfragmaclient       Public ''
42329>>>>>>>    Property String  psFragmaBaxioStatus  Public ''
42331>>>>>>>    Property String  psEkdoths            Public ''
42333>>>>>>>    Property String  psApodekths          Public ''
42335>>>>>>>    Property Date pdApo                   Public ''
42337>>>>>>>    Property Date pdEos                   Public ''
42339>>>>>>>    
42339>>>>>>>    //AB-StoreTopEnd
42339>>>>>>>
42339>>>>>>>    Set Label to "‰˜«á¢¦š¦ª €¥ ¦š¨á­à¤"
42340>>>>>>>    Set Size to 287 527
42341>>>>>>>    Set Location to 2 3
42342>>>>>>>    Set Exit_Application_Local_State to FALSE
42343>>>>>>>    Set Modal_State to FALSE
42344>>>>>>>
42344>>>>>>>    //AB-DDOStart
42344>>>>>>>
42344>>>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
42346>>>>>>>    End_Object    // Baxiokat_DD
42347>>>>>>>
42347>>>>>>>    Object Baxio_DD is a Baxio_DataDictionary
42349>>>>>>>        Set DDO_Server to (Baxiokat_DD(self))
42350>>>>>>>
42350>>>>>>>        //AB-StoreStart
42350>>>>>>>                                                    
42350>>>>>>>        Function fiIsOK Returns Integer
42352>>>>>>>            String lsBaxioStatus sclient
42353>>>>>>>            Get psFragmaBaxioStatus  to lsBaxioStatus
42354>>>>>>>            Get psfragmaclient       to sclient
42355>>>>>>>            If (Trim(sClient)='') Begin
42357>>>>>>>                If (lsBaxioStatus Contains Baxio.Baxio_Status) Function_Return 1
42360>>>>>>>            End
42360>>>>>>>>
42360>>>>>>>            Else Begin
42361>>>>>>>                If (baxio.baxio_desm Eq sClient And lsBaxioStatus Contains Baxio.Baxio_Status) Function_Return 1
42364>>>>>>>            End
42364>>>>>>>>
42364>>>>>>>            Function_Return 0
42365>>>>>>>        End_Function
42366>>>>>>>        
42366>>>>>>>        Procedure OnConstrain
42368>>>>>>>        
42368>>>>>>>            Integer liBaxiokatCode liBaxioStatus liBaxioPlace
42369>>>>>>>            string  sclient lsBaxioStatus sApodekths sEkdoths
42369>>>>>>>            Date    dApo dEos
42369>>>>>>>        
42369>>>>>>>            Forward Send OnConstrain
42371>>>>>>>        
42371>>>>>>>            Get piFragmaBaxiokatCode    to liBaxiokatCode
42372>>>>>>>            Get psFragmaBaxioStatus     to lsBaxioStatus
42373>>>>>>>            Get piFragmaBaxioPlace      to liBaxioPlace
42374>>>>>>>        
42374>>>>>>>            Get psApodekths             to sApodekths
42375>>>>>>>            Get psEkdoths               to sEkdoths
42376>>>>>>>            Get pdApo                   to dApo
42377>>>>>>>            Get pdEos                   to dEos
42378>>>>>>>        
42378>>>>>>>            If (liBaxioKatCode <> 0) Begin
42380>>>>>>>                Constrain Baxio.Baxiokat_Code eq liBaxiokatCode
42382>>>>>>>                If (liBaxioPlace  <> 0)  Constrain Baxio.Baxio_Place eq liBaxioPlace
42386>>>>>>>                If (lsBaxioStatus <> '') Constrain Baxio as (fiIsOK(Self)=1)
42389>>>>>>>            End
42389>>>>>>>>
42389>>>>>>>        
42389>>>>>>>            If (sApodekths  <>'') Constrain Baxio.Baxio_Code_Out    Eq sApodekths
42393>>>>>>>            If (sEkdoths    <>'') Constrain Baxio.Baxio_Code_In     Eq sEkdoths
42397>>>>>>>            If (dApo        <>'') Constrain Baxio.Baxio_HmniaL      Ge dApo
42401>>>>>>>            If (dEos        <>'') Constrain Baxio.Baxio_HmniaL      Le dEos
42405>>>>>>>        
42405>>>>>>>        End_Procedure // OnConstrain
42406>>>>>>>        
42406>>>>>>>        
42406>>>>>>>        
42406>>>>>>>        
42406>>>>>>>        
42406>>>>>>>        
42406>>>>>>>        
42406>>>>>>>        
42406>>>>>>>        
42406>>>>>>>        
42406>>>>>>>        
42406>>>>>>>        
42406>>>>>>>        
42406>>>>>>>        //AB-StoreEnd
42406>>>>>>>
42406>>>>>>>    End_Object    // Baxio_DD
42407>>>>>>>
42407>>>>>>>    Set Main_DD to (Baxio_DD(self))
42408>>>>>>>    Set Server to (Baxio_DD(self))
42409>>>>>>>
42409>>>>>>>    //AB-DDOEnd
42409>>>>>>>
42409>>>>>>>    Object oSelList is a dbListSub
42411>>>>>>>        Set Main_File to Baxio.File_Number
42412>>>>>>>        Set Size to 228 514
42413>>>>>>>        Set Location to 4 6
42414>>>>>>>
42414>>>>>>>        Begin_Row
42417>>>>>>>            Entry_Item Baxio.Baxio_code
42418>>>>>>>            Entry_Item Baxio.Baxio_epon_in
42419>>>>>>>            Entry_Item Baxio.Baxio_epon_out
42420>>>>>>>            Entry_Item Baxiokat.Baxiokat_descr
42421>>>>>>>            Entry_Item Baxio.Baxio_hmnial
42422>>>>>>>            Entry_Item Baxio.Baxio_v2
42423>>>>>>>            Entry_Item Baxio.Baxio_banka
42424>>>>>>>            Entry_Item (Export_Code_Description(Self,6,Baxio.Baxio_banka))
42425>>>>>>>            Entry_Item Baxio.Baxio_no
42426>>>>>>>        End_Row
42431>>>>>>>
42431>>>>>>>        Set Form_Width    item 0 to 41
42432>>>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
42433>>>>>>>        
42433>>>>>>>        Set Form_Width    item 1 to 98
42434>>>>>>>        Set Header_Label  item 1 to "„¡›æ«žª"
42435>>>>>>>        
42435>>>>>>>        Set Form_Width    item 2 to 94
42436>>>>>>>        Set Header_Label  item 2 to "€§¦›â¡«žª"
42437>>>>>>>        
42437>>>>>>>        Set Form_Width    item 3 to 75
42438>>>>>>>        Set Header_Label  item 3 to "œ¨ š¨˜­ã"
42439>>>>>>>        
42439>>>>>>>        Set Form_Width    item 4 to 47
42440>>>>>>>        Set Header_Label  item 4 to "Šã¥ž"
42441>>>>>>>        
42441>>>>>>>        Set Form_Width    item 5 to 48
42442>>>>>>>        Set Header_Label  item 5 to "¦©æ"
42443>>>>>>>        
42443>>>>>>>        Set Form_Width    item 6 to 12
42444>>>>>>>        Set Header_Label  item 6 to "‰à› ¡æª ’¨á§œ˜"
42445>>>>>>>        
42445>>>>>>>        Set Form_Width    item 7 to 42
42446>>>>>>>        Set Header_Label  item 7 to "’¨á§œ˜"
42447>>>>>>>        
42447>>>>>>>        Set Form_Width    item 8 to 53
42448>>>>>>>        Set Header_Label  item 8 to "€¨ Ÿ£æª"
42449>>>>>>>        
42449>>>>>>>
42449>>>>>>>        //AB-StoreStart
42449>>>>>>>                
42449>>>>>>>        Property Integer piStoreFragmaBaxiokatRec0 Public 0
42451>>>>>>>        Property Integer piStoreFragmaBaxiokatCode Public 0
42453>>>>>>>        Property Integer piStoreFragmaBaxioStatus  Public 0
42455>>>>>>>        Property Integer piStoreFragmaBaxioPlace   Public 0
42457>>>>>>>        Property String  psStoreFragmaBaxioStatus  Public ''
42459>>>>>>>        
42459>>>>>>>        Procedure Store_Defaults
42461>>>>>>>            Forward Send Store_Defaults
42463>>>>>>>            Set piStoreFragmaBaxiokatRec0 to (piFragmaBaxiokatRec0(Self))
42464>>>>>>>            Set piStoreFragmaBaxiokatCode to (piFragmaBaxiokatCode(Self))
42465>>>>>>>            Set piStoreFragmaBaxioStatus  to (piFragmaBaxioStatus(Self))
42466>>>>>>>            Set piStoreFragmaBaxioPlace   to (piFragmaBaxioPlace(Self))
42467>>>>>>>            Set psStoreFragmaBaxioStatus  to (psFragmaBaxioStatus(Self))
42468>>>>>>>        End_Procedure // Store_Defaults
42469>>>>>>>        
42469>>>>>>>        Procedure Restore_Defaults
42471>>>>>>>            Forward Send Restore_Defaults
42473>>>>>>>            Set piFragmaBaxiokatRec0 to (piStoreFragmaBaxiokatRec0(Self))
42474>>>>>>>            Set piFragmaBaxiokatCode to (piStoreFragmaBaxiokatCode(Self))
42475>>>>>>>            Set piFragmaBaxioStatus  to (piStoreFragmaBaxioStatus(Self))
42476>>>>>>>            Set piFragmaBaxioPlace   to (piStoreFragmaBaxioPlace(Self))
42477>>>>>>>            Set psFragmaBaxioStatus  to (psStoreFragmaBaxioStatus(Self))
42478>>>>>>>        End_Procedure // Restore_Defaults
42479>>>>>>>        
42479>>>>>>>        Procedure Activating
42481>>>>>>>            Forward Send Activating
42483>>>>>>>         //   Set Auto_Index_State        to True
42483>>>>>>>            Send Rebuild_Constraints    to Baxio_DD
42484>>>>>>>        End_Procedure
42485>>>>>>>        
42485>>>>>>>        Procedure End_Construct_Object
42487>>>>>>>            Integer iDecs
42488>>>>>>>            Forward Send End_Construct_Object
42490>>>>>>>            Get fiDekadika_Nomismatos SysCurXr.C_Code0  to    iDecs
42491>>>>>>>            Set Points Item 5 to iDecs
42492>>>>>>>            Set Numeric_Mask Item 5 to 10 iDecs ' ,*'
42493>>>>>>>        End_Procedure
42494>>>>>>>        
42494>>>>>>>        
42494>>>>>>>        
42494>>>>>>>        
42494>>>>>>>        
42494>>>>>>>        
42494>>>>>>>        
42494>>>>>>>        
42494>>>>>>>        
42494>>>>>>>        
42494>>>>>>>        
42494>>>>>>>        //AB-StoreEnd
42494>>>>>>>
42494>>>>>>>    End_Object    // oSelList
42495>>>>>>>
42495>>>>>>>    Object TextBoxSub1 is a TextBoxSub
42497>>>>>>>        Set Label to "Šã¥ž ˜§¦"
42498>>>>>>>        Set Location to 241 7
42499>>>>>>>        Set Size to 10 35
42500>>>>>>>        Set TypeFace to "MS Sans Serif"
42501>>>>>>>    End_Object    // TextBoxSub1
42502>>>>>>>
42502>>>>>>>    Object cSyDateForm1 is a cSyDateForm
42504>>>>>>>        Set Size to 13 66
42505>>>>>>>        Set Location to 240 45
42506>>>>>>>        Set Label_Col_Offset to 2
42507>>>>>>>        Set Label_Justification_Mode to jMode_Right
42508>>>>>>>        Set Form_Mask Item 0 to "d/M/yyyy"
42509>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42510>>>>>>>
42510>>>>>>>        //AB-StoreStart
42510>>>>>>>                                                    
42510>>>>>>>        Procedure Key Integer iKey
42512>>>>>>>            Integer iRetVal
42513>>>>>>>            Forward Send Key iKey
42515>>>>>>>            If (iKey=277) Begin
42517>>>>>>>                Set Value Item 0 to ''
42518>>>>>>>                //Send KeyAction to ButtonSub1
42518>>>>>>>            End
42518>>>>>>>>
42518>>>>>>>        End_Procedure
42519>>>>>>>        
42519>>>>>>>        
42519>>>>>>>        //AB-StoreEnd
42519>>>>>>>
42519>>>>>>>    End_Object    // cSyDateForm1
42520>>>>>>>
42520>>>>>>>    Object TextBoxSub2 is a TextBoxSub
42522>>>>>>>        Set Label to "Šã¥ž œàª"
42523>>>>>>>        Set Location to 258 7
42524>>>>>>>        Set Size to 10 35
42525>>>>>>>        Set TypeFace to "MS Sans Serif"
42526>>>>>>>    End_Object    // TextBoxSub2
42527>>>>>>>
42527>>>>>>>    Object cSyDateForm2 is a cSyDateForm
42529>>>>>>>        Set Size to 13 66
42530>>>>>>>        Set Location to 256 45
42531>>>>>>>        Set Label_Col_Offset to 2
42532>>>>>>>        Set Label_Justification_Mode to jMode_Right
42533>>>>>>>        Set Form_Mask Item 0 to "d/M/yyyy"
42534>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42535>>>>>>>
42535>>>>>>>        //AB-StoreStart
42535>>>>>>>                                                    
42535>>>>>>>        Procedure Key Integer iKey
42537>>>>>>>            Integer iRetVal
42538>>>>>>>            Forward Send Key iKey
42540>>>>>>>            If (iKey=277) Begin
42542>>>>>>>                Set Value Item 0 to ''
42543>>>>>>>                //Send KeyAction to ButtonSub1
42543>>>>>>>            End
42543>>>>>>>>
42543>>>>>>>        End_Procedure
42544>>>>>>>        
42544>>>>>>>        
42544>>>>>>>        //AB-StoreEnd
42544>>>>>>>
42544>>>>>>>    End_Object    // cSyDateForm2
42545>>>>>>>
42545>>>>>>>    Object TextBoxSub4 is a TextBoxSub
42547>>>>>>>        Set Label to "„¡›æ«žª"
42548>>>>>>>        Set Location to 241 118
42549>>>>>>>        Set Size to 10 33
42550>>>>>>>        Set TypeFace to "MS Sans Serif"
42551>>>>>>>    End_Object    // TextBoxSub4
42552>>>>>>>
42552>>>>>>>    Object TextBoxSub5 is a TextBoxSub
42554>>>>>>>        Set Label to "€§¦›â¡«žª"
42555>>>>>>>        Set Location to 258 118
42556>>>>>>>        Set Size to 10 39
42557>>>>>>>        Set TypeFace to "MS Sans Serif"
42558>>>>>>>    End_Object    // TextBoxSub5
42559>>>>>>>
42559>>>>>>>    Object FormSub1 is a FormSub
42561>>>>>>>        Set Size to 13 77
42562>>>>>>>        Set Location to 240 159
42563>>>>>>>        Set Label_Col_Offset to 2
42564>>>>>>>        Set Prompt_Button_Mode to pb_PromptOn
42565>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42566>>>>>>>
42566>>>>>>>        //AB-StoreStart
42566>>>>>>>                                                    
42566>>>>>>>        Set Prompt_Object to (sl100(Self))
42567>>>>>>>        
42567>>>>>>>        Procedure OnChange
42569>>>>>>>            String s1
42570>>>>>>>            Get Value Item 0 to s1
42571>>>>>>>            Set Value Of FormSub2 Item 0 to (fsClient(Self,s1))
42572>>>>>>>            Set psEkdoths to s1
42573>>>>>>>        End_Procedure
42574>>>>>>>        
42574>>>>>>>        
42574>>>>>>>        
42574>>>>>>>        
42574>>>>>>>        
42574>>>>>>>        
42574>>>>>>>        
42574>>>>>>>        //AB-StoreEnd
42574>>>>>>>
42574>>>>>>>    End_Object    // FormSub1
42575>>>>>>>
42575>>>>>>>    Object FormSub2 is a FormSub
42577>>>>>>>        Set Size to 13 187
42578>>>>>>>        Set Location to 240 240
42579>>>>>>>        Set Color to clBtnFace
42580>>>>>>>        Set Label_Col_Offset to 2
42581>>>>>>>        Set Enabled_State to FALSE
42582>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42583>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
42584>>>>>>>        Set Shadow_State Item 0 to TRUE
42585>>>>>>>    End_Object    // FormSub2
42586>>>>>>>
42586>>>>>>>    Object FormSub3 is a FormSub
42588>>>>>>>        Set Size to 13 77
42589>>>>>>>        Set Location to 256 159
42590>>>>>>>        Set Label_Col_Offset to 2
42591>>>>>>>        Set Prompt_Button_Mode to pb_PromptOn
42592>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42593>>>>>>>
42593>>>>>>>        //AB-StoreStart
42593>>>>>>>                                                    
42593>>>>>>>        Set Prompt_Object to (sl100(Self))
42594>>>>>>>        
42594>>>>>>>        Procedure OnChange
42596>>>>>>>            String s1
42597>>>>>>>            Get Value Item 0 to s1
42598>>>>>>>            Set Value Of FormSub4 Item 0 to (fsClient(Self,s1))
42599>>>>>>>            Set psApodekths to s1
42600>>>>>>>        End_Procedure
42601>>>>>>>        
42601>>>>>>>        
42601>>>>>>>        
42601>>>>>>>        
42601>>>>>>>        
42601>>>>>>>        
42601>>>>>>>        
42601>>>>>>>        //AB-StoreEnd
42601>>>>>>>
42601>>>>>>>    End_Object    // FormSub3
42602>>>>>>>
42602>>>>>>>    Object FormSub4 is a FormSub
42604>>>>>>>        Set Size to 13 187
42605>>>>>>>        Set Location to 256 240
42606>>>>>>>        Set Color to clBtnFace
42607>>>>>>>        Set Label_Col_Offset to 2
42608>>>>>>>        Set Enabled_State to FALSE
42609>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42610>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
42611>>>>>>>        Set Shadow_State Item 0 to TRUE
42612>>>>>>>    End_Object    // FormSub4
42613>>>>>>>
42613>>>>>>>    Object ButtonSub1 is a ButtonSub
42615>>>>>>>        Set Label to "œ¨ æ¨ ©œ"
42616>>>>>>>        Set Size to 14 43
42617>>>>>>>        Set Location to 256 430
42618>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42619>>>>>>>
42619>>>>>>>        //AB-StoreStart
42619>>>>>>>                                                    
42619>>>>>>>        Procedure OnClick
42621>>>>>>>            Date dApo dEos
42622>>>>>>>            Get Value Of cSyDateForm1 Item 0 to dApo
42623>>>>>>>            Get Value Of cSyDateForm2 Item 0 to dEos
42624>>>>>>>            Set pdApo to dApo
42625>>>>>>>            Set pdEos to dEos
42626>>>>>>>            Send Rebuild_Constraints to Baxio_DD
42627>>>>>>>            Send Beginning_Of_Data to oSelList True
42628>>>>>>>        End_Procedure // OnClick
42629>>>>>>>        
42629>>>>>>>        
42629>>>>>>>        
42629>>>>>>>        
42629>>>>>>>        
42629>>>>>>>        
42629>>>>>>>        
42629>>>>>>>        
42629>>>>>>>        
42629>>>>>>>        
42629>>>>>>>        
42629>>>>>>>        
42629>>>>>>>        
42629>>>>>>>        //AB-StoreEnd
42629>>>>>>>
42629>>>>>>>    End_Object    // ButtonSub1
42630>>>>>>>
42630>>>>>>>    Object oOK_bn is a ButtonSub
42632>>>>>>>        Set Label to "&„§ ¢¦šã"
42633>>>>>>>        Set Size to 14 43
42634>>>>>>>        Set Location to 256 478
42635>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42636>>>>>>>
42636>>>>>>>        //AB-StoreStart
42636>>>>>>>        Procedure OnClick
42638>>>>>>>            Send OK To oSelList
42639>>>>>>>        End_Procedure
42640>>>>>>>        //AB-StoreEnd
42640>>>>>>>
42640>>>>>>>    End_Object    // oOK_bn
42641>>>>>>>
42641>>>>>>>
42641>>>>>>>    //AB-StoreStart
42641>>>>>>>                        
42641>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
42642>>>>>>>    
42642>>>>>>>    Procedure Request_Cancel
42644>>>>>>>        Set Value Of cSyDateForm1 Item 0 to ''
42645>>>>>>>        Set Value Of cSyDateForm2 Item 0 to ''
42646>>>>>>>        Set Value Of FormSub1     Item 0 to ''
42647>>>>>>>        Set Value Of FormSub2     Item 0 to ''
42648>>>>>>>        Forward Send Request_Cancel
42650>>>>>>>    End_Procedure
42651>>>>>>>    
42651>>>>>>>    
42651>>>>>>>    
42651>>>>>>>    
42651>>>>>>>    
42651>>>>>>>    //AB-StoreEnd
42651>>>>>>>
42651>>>>>>>End_Object    // SL037
42652>>>>>>>
42652>>>>>>>
42652>>>>>>>//AB-StoreStart
42652>>>>>>>    
42652>>>>>>>//AB-StoreEnd
42652>>>>>>>
42652>>>>>>>//AB/ End_Object    // prj
42652>>>>>Use slnomism.sl      // slNomism
INCLUDING FILE: SLNOMISM.SL
42652>>>>>>>//AB/ Project slNomism
42652>>>>>>>//AB/ Object prj is a Lookup_Project
42652>>>>>>>//AB/     Set ProjectName to "slNomism"
42652>>>>>>>//AB/     Set ProjectFileName to "slNomism.SL"
42652>>>>>>>//AB/     Set GenerateFileName to "NONAME"
42652>>>>>>>
42652>>>>>>>// Project Object Structure
42652>>>>>>>//   slNomism is a dbModalPanelSub
42652>>>>>>>//     Nomisma_DD is a DataDictionary
42652>>>>>>>//     oSelList is a dbListSub
42652>>>>>>>//     oOK_bn is a ButtonSub
42652>>>>>>>//     oSearch_bn is a ButtonSub
42652>>>>>>>
42652>>>>>>>// Register all objects
42652>>>>>>>Register_Object Nomisma_DD
42652>>>>>>>Register_Object oOK_bn
42652>>>>>>>Register_Object oSearch_bn
42652>>>>>>>Register_Object oSelList
42652>>>>>>>Register_Object slNomism
42652>>>>>>>
42652>>>>>>>
42652>>>>>>>//AB-IgnoreStart
42652>>>>>>>
42652>>>>>>>Use DFAllEnt.pkg
42652>>>>>>>Use dbList.Sub
42652>>>>>>>Use Button.Sub
42652>>>>>>>
42652>>>>>>>
42652>>>>>>>Use NOMISMA.DD
INCLUDING FILE: NOMISMA.DD
42652>>>>>>>>>//DDB-FileStart
42652>>>>>>>>>//DDB-HeaderStart
42652>>>>>>>>>
42652>>>>>>>>>// File Name : NOMISMA.DD
42652>>>>>>>>>// Class Name: Nomisma_DataDictionary
42652>>>>>>>>>// Revision  : 52
42652>>>>>>>>>// Version   : 2
42652>>>>>>>>>
42652>>>>>>>>>Use  Windows           // Basic Definitions
42652>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
42652>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
42652>>>>>>>>>
42652>>>>>>>>>Open Nomisma
42654>>>>>>>>>Open Isotimia
42656>>>>>>>>>Open Particle
42658>>>>>>>>>
42658>>>>>>>>>//DDB-HeaderEnd
42658>>>>>>>>>//DDB-ValidationStart
42658>>>>>>>>>
42658>>>>>>>>>Register_Object Nomisma_Nomisma_Type_VT
42658>>>>>>>>>Register_Object Nomisma_Nomisma_Sign0_VT
42658>>>>>>>>>Register_Object Nomisma_Nomisma_Sign00_VT
42658>>>>>>>>>Register_Object Nomisma_Nomisma_Signr_VT
42658>>>>>>>>>
42658>>>>>>>>>Object Nomisma_Nomisma_Type_VT  is a DescriptionValidationTable
42660>>>>>>>>>
42660>>>>>>>>>    Procedure Fill_List
42662>>>>>>>>>        Forward Send Fill_List
42664>>>>>>>>>        Send Add_Table_Value  "1"  "Book1"
42665>>>>>>>>>        Send Add_Table_Value  "2"  "Book2"
42666>>>>>>>>>        Send Add_Table_Value  "3"  "Reporting"
42667>>>>>>>>>        Send Add_Table_Value  "0"  "Other"
42668>>>>>>>>>    End_Procedure    // Fill_List
42669>>>>>>>>>    //DDB-ValidationCustomStart
42669>>>>>>>>>    //DDB-ValidationCustomEnd
42669>>>>>>>>>End_Object   // Nomisma_Nomisma_Type_VT
42670>>>>>>>>>
42670>>>>>>>>>Object Nomisma_Nomisma_Sign0_VT  is a DescriptionValidationTable
42672>>>>>>>>>
42672>>>>>>>>>    Procedure Fill_List
42674>>>>>>>>>        Forward Send Fill_List
42676>>>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
42677>>>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
42678>>>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨œ¯ £¦"
42679>>>>>>>>>    End_Procedure    // Fill_List
42680>>>>>>>>>    //DDB-ValidationCustomStart
42680>>>>>>>>>    //DDB-ValidationCustomEnd
42680>>>>>>>>>End_Object   // Nomisma_Nomisma_Sign0_VT
42681>>>>>>>>>
42681>>>>>>>>>Object Nomisma_Nomisma_Sign00_VT  is a DescriptionValidationTable
42683>>>>>>>>>
42683>>>>>>>>>    Procedure Fill_List
42685>>>>>>>>>        Forward Send Fill_List
42687>>>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
42688>>>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
42689>>>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨â¯ £¦"
42690>>>>>>>>>    End_Procedure    // Fill_List
42691>>>>>>>>>    //DDB-ValidationCustomStart
42691>>>>>>>>>    //DDB-ValidationCustomEnd
42691>>>>>>>>>End_Object   // Nomisma_Nomisma_Sign00_VT
42692>>>>>>>>>
42692>>>>>>>>>Object Nomisma_Nomisma_Signr_VT  is a DescriptionValidationTable
42694>>>>>>>>>
42694>>>>>>>>>    Procedure Fill_List
42696>>>>>>>>>        Forward Send Fill_List
42698>>>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
42699>>>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
42700>>>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨â¯ £¦"
42701>>>>>>>>>    End_Procedure    // Fill_List
42702>>>>>>>>>    //DDB-ValidationCustomStart
42702>>>>>>>>>    //DDB-ValidationCustomEnd
42702>>>>>>>>>End_Object   // Nomisma_Nomisma_Signr_VT
42703>>>>>>>>>//DDB-ValidationEnd
42703>>>>>>>>>//DDB-SelectionStart
42703>>>>>>>>>//DDB/ ExternalSelectionList sl059  sl059.sl
42703>>>>>>>>>Register_Object sl059
42703>>>>>>>>>//DDB-SelectionEnd
42703>>>>>>>>>
42703>>>>>>>>>Class Nomisma_DataDictionary  is a DataDictionary_Sec
42704>>>>>>>>>
42704>>>>>>>>>    Procedure Construct_Object
42705>>>>>>>>>        Forward Send Construct_Object
42707>>>>>>>>>        Property String psOldCode Public ''
42708>>>>>>>>>    End_procedure
42709>>>>>>>>>
42709>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
42710>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
42712>>>>>>>>>        Set psOldCode to Nomisma.Nomisma_Code
42713>>>>>>>>>    End_Procedure   // New_Current_Record
42714>>>>>>>>>
42714>>>>>>>>>    Procedure Save_Main_File
42715>>>>>>>>>        If ((Operation_Origin<>Self) And;             (Nomisma.Recnum=0)) Procedure_Return
42718>>>>>>>>>        Forward Send Save_Main_File
42720>>>>>>>>>    End_Procedure   // Save_Main_File
42721>>>>>>>>>
42721>>>>>>>>>    Function Validate_Save  Returns Integer
42722>>>>>>>>>        Local Integer iReturnVal 
42723>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
42725>>>>>>>>>        If (Not(iReturnVal)) ;            Begin
42727>>>>>>>>>                     If  Nomisma.nomisma_Code eq ''                 Move 6220 to iReturnVal
42730>>>>>>>>>                Else If (Nomisma.Nomisma_Code <>(psOldCode(Self)) And ;                         (psOldCode(Self)<>''))  Move 6030 to iReturnVal
42734>>>>>>>>>                if iReturnVal Send Operation_Not_Allowed iReturnVal
42737>>>>>>>>>            End
42737>>>>>>>>>>
42737>>>>>>>>>        Function_Return iReturnVal
42738>>>>>>>>>    End_Function   // Validate_Save
42739>>>>>>>>>
42739>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
42740>>>>>>>>>             if iError_num eq 6220 error 6220 "Œ¦£ ©£˜«˜ => ‰à› ¡æª ¡œ¤æª "
42743>>>>>>>>>        Else if iError_num eq 6030 error 6030 "„§ ¢â¥«œ ¤æ£ ©£˜ ˜§¦ «ž¤ ¢å©«˜ £œ (F4)\nž §˜«ã©«œ §¨é«˜ F5 ©«¦ ž›ž ¬§á¨®¦¤\nà©«œ ¤˜ ¡˜Ÿ˜¨å©œ  ž ˜¨® ¡ã «¦¬ « £ã\n§¨å¤ œ§ ¢â¥œ«œ á¢¢¦"
42747>>>>>>>>>        //Else if iError_num eq 6030 error 6030 "ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ©«¦ ¡à› ¡æ ¤¦£å©£˜«¦ª"
42747>>>>>>>>>        else Forward Send Operation_Not_Allowed  iError_Num
42750>>>>>>>>>    End_Procedure   // Operation_Not_Allowed
42751>>>>>>>>>
42751>>>>>>>>>    Procedure Update
42752>>>>>>>>>        Forward Send Update
42754>>>>>>>>>        // Insert Code Here
42754>>>>>>>>>        SYSDATE NOMISMA.LUP
42755>>>>>>>>>    End_Procedure   // Update
42756>>>>>>>>>
42756>>>>>>>>>    Procedure Creating
42757>>>>>>>>>        Forward Send Creating
42759>>>>>>>>>        // Insert Code Here
42759>>>>>>>>>        SYSDATE NOMISMA.FUP
42760>>>>>>>>>    End_Procedure   // Creating
42761>>>>>>>>>
42761>>>>>>>>>    // Define_Fields:
42761>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
42761>>>>>>>>>
42761>>>>>>>>>    Procedure Define_Fields
42762>>>>>>>>>        Forward Send Define_Fields
42764>>>>>>>>>        //DDB-Generated-Code-Location
42764>>>>>>>>>        //DDB-DefineFieldStart
42764>>>>>>>>>
42764>>>>>>>>>        Set Main_File            To Nomisma.File_Number
42765>>>>>>>>>        Set Cascade_Delete_State To FALSE
42766>>>>>>>>>
42766>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
42767>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
42768>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
42769>>>>>>>>>
42769>>>>>>>>>        // Child (Client) file structure................
42769>>>>>>>>>        Send Add_Client_File  Isotimia.File_Number
42770>>>>>>>>>        Send Add_Client_File  Particle.File_Number
42771>>>>>>>>>
42771>>>>>>>>>        // Field-based properties.......................
42771>>>>>>>>>
42771>>>>>>>>>        // Nomisma.Nomisma_Code
42771>>>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Code To DD_AUTOFIND    DD_CAPSLOCK   
42772>>>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Code To (sl059(Self))
42773>>>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Code To TRUE
42774>>>>>>>>>
42774>>>>>>>>>        // Nomisma.Nomisma_Descr
42774>>>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Descr To DD_CAPSLOCK   
42775>>>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Descr To (sl059(Self))
42776>>>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Descr To TRUE
42777>>>>>>>>>
42777>>>>>>>>>        // Nomisma.Nomisma_Short
42777>>>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Short To DD_CAPSLOCK   
42778>>>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Short To (sl059(Self))
42779>>>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Short To TRUE
42780>>>>>>>>>
42780>>>>>>>>>        // Nomisma.Dekadika
42780>>>>>>>>>
42780>>>>>>>>>        // Nomisma.Fup
42780>>>>>>>>>
42780>>>>>>>>>        // Nomisma.Lup
42780>>>>>>>>>
42780>>>>>>>>>        // Nomisma.Euro_Zone
42780>>>>>>>>>
42780>>>>>>>>>        // Nomisma.Einai_Drx
42780>>>>>>>>>
42780>>>>>>>>>        // Nomisma.Einai_Euro
42780>>>>>>>>>
42780>>>>>>>>>        // Nomisma.Monades
42780>>>>>>>>>
42780>>>>>>>>>        // Nomisma.Kl_Isot_Euro
42780>>>>>>>>>
42780>>>>>>>>>        // Nomisma.Nomisma_Type
42780>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Type To (Nomisma_Nomisma_Type_VT(Self))
42781>>>>>>>>>
42781>>>>>>>>>        // Nomisma.Nomisma_Sign0
42781>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Sign0 To (Nomisma_Nomisma_Sign0_VT(Self))
42782>>>>>>>>>
42782>>>>>>>>>        // Nomisma.Nomisma_Sign00
42782>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Sign00 To (Nomisma_Nomisma_Sign00_VT(Self))
42783>>>>>>>>>
42783>>>>>>>>>        // Nomisma.Nomisma_Signr
42783>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Signr To (Nomisma_Nomisma_Signr_VT(Self))
42784>>>>>>>>>
42784>>>>>>>>>        //DDB-DefineFieldEnd
42784>>>>>>>>>    End_Procedure    // Define_Fields
42785>>>>>>>>>
42785>>>>>>>>>    // Field_Defaults:
42785>>>>>>>>>    // This procedure is used to establish default field values.
42785>>>>>>>>>
42785>>>>>>>>>    Procedure Field_Defaults
42786>>>>>>>>>        Forward Send Field_Defaults
42788>>>>>>>>>        //DDB-Generated-Code-Location
42788>>>>>>>>>        //DDB-FieldDefaultStart
42788>>>>>>>>>        //DDB-FieldDefaultEnd
42788>>>>>>>>>    End_Procedure    // Field_Defaults
42789>>>>>>>>>
42789>>>>>>>>>End_Class    // Nomisma_DataDictionary
42790>>>>>>>>>//DDB-Selection-pkg-Start
42790>>>>>>>>>
42790>>>>>>>>>Use sl059.sl         // sl059
INCLUDING FILE: SL059.SL
42790>>>>>>>>>>>//AB/ Project sl059
42790>>>>>>>>>>>//AB/     Object prj is a LOOKUP_Project
42790>>>>>>>>>>>//AB/         Set ProjectName to "sl059"
42790>>>>>>>>>>>//AB/         Set ProjectFileName to "sl059.SL"
42790>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
42790>>>>>>>>>>>
42790>>>>>>>>>>>    //AB-IgnoreStart
42790>>>>>>>>>>>
42790>>>>>>>>>>>
42790>>>>>>>>>>>
42790>>>>>>>>>>>
42790>>>>>>>>>>>    Use NOMISMA.DD
42790>>>>>>>>>>>
42790>>>>>>>>>>>    //AB-IgnoreEnd
42790>>>>>>>>>>>
42790>>>>>>>>>>>    CD_Popup_Object sl059 is a dbModalPanelSub
42809>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
42810>>>>>>>>>>>        Set Modal_State to FALSE
42811>>>>>>>>>>>        Set Popup_State to FALSE
42812>>>>>>>>>>>        Set Minimize_Icon to FALSE
42813>>>>>>>>>>>        set label to "Œ¦£å©£˜«˜" 
42814>>>>>>>>>>>        Set Size to 148 295
42815>>>>>>>>>>>        Set Location to 4 5
42816>>>>>>>>>>>
42816>>>>>>>>>>>        //AB-DDOStart
42816>>>>>>>>>>>
42816>>>>>>>>>>>        Object Nomisma_DD is a Nomisma_DataDictionary
42818>>>>>>>>>>>        End_Object    // Nomisma_DD
42819>>>>>>>>>>>
42819>>>>>>>>>>>        Set Main_DD to (Nomisma_DD(Current_Object))
42820>>>>>>>>>>>        Set Server to (Nomisma_DD(Current_Object))
42821>>>>>>>>>>>
42821>>>>>>>>>>>        //AB-DDOEnd
42821>>>>>>>>>>>
42821>>>>>>>>>>>        Object oSelList is a dbListSub
42823>>>>>>>>>>>            Set Main_File to Nomisma.File_Number
42824>>>>>>>>>>>            Set Size to 105 278
42825>>>>>>>>>>>            Set Location to 6 6
42826>>>>>>>>>>>
42826>>>>>>>>>>>            Begin_Row
42829>>>>>>>>>>>                Entry_Item Nomisma.Nomisma_code
42830>>>>>>>>>>>                Entry_Item Nomisma.Nomisma_descr
42831>>>>>>>>>>>                Entry_Item Nomisma.Nomisma_short
42832>>>>>>>>>>>                Entry_Item Nomisma.Dekadika
42833>>>>>>>>>>>            End_Row
42838>>>>>>>>>>>
42838>>>>>>>>>>>            Set Form_Width    item 0 to 45
42839>>>>>>>>>>>            set header_label  item 0 to "‰à› ¡¦ª" 
42840>>>>>>>>>>>
42840>>>>>>>>>>>            Set Form_Width    item 1 to 115
42841>>>>>>>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
42842>>>>>>>>>>>
42842>>>>>>>>>>>            Set Form_Width    item 2 to 58
42843>>>>>>>>>>>            set header_label  item 2 to "‘ç¤«¦£ž" 
42844>>>>>>>>>>>
42844>>>>>>>>>>>            Set Form_Width    item 3 to 54
42845>>>>>>>>>>>            set header_label  item 3 to "ƒœ¡˜› ¡á" 
42846>>>>>>>>>>>
42846>>>>>>>>>>>        End_Object    // oSelList
42847>>>>>>>>>>>
42847>>>>>>>>>>>        Object oOK_bn is a ButtonSub
42849>>>>>>>>>>>            set label to "&„§ ¢¦šã" 
42850>>>>>>>>>>>            Set Location to 113 124
42851>>>>>>>>>>>
42851>>>>>>>>>>>            //AB-StoreStart
42851>>>>>>>>>>>            Procedure OnClick
42853>>>>>>>>>>>                Send OK To (oSelList(current_object))
42854>>>>>>>>>>>            End_Procedure
42855>>>>>>>>>>>            //AB-StoreEnd
42855>>>>>>>>>>>
42855>>>>>>>>>>>        End_Object    // oOK_bn
42856>>>>>>>>>>>
42856>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
42858>>>>>>>>>>>            set label to "&€¡ç¨à©ž" 
42859>>>>>>>>>>>            Set Location to 113 179
42860>>>>>>>>>>>
42860>>>>>>>>>>>            //AB-StoreStart
42860>>>>>>>>>>>            Procedure OnClick
42862>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
42863>>>>>>>>>>>            End_Procedure
42864>>>>>>>>>>>            //AB-StoreEnd
42864>>>>>>>>>>>
42864>>>>>>>>>>>        End_Object    // oCancel_bn
42865>>>>>>>>>>>
42865>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
42867>>>>>>>>>>>            set label to "€&¤˜ã«ž©ž" 
42868>>>>>>>>>>>            Set Location to 113 234
42869>>>>>>>>>>>
42869>>>>>>>>>>>            //AB-StoreStart
42869>>>>>>>>>>>            Procedure OnClick
42871>>>>>>>>>>>                Send Search To (oSelList(current_object))
42872>>>>>>>>>>>            End_Procedure
42873>>>>>>>>>>>            //AB-StoreEnd
42873>>>>>>>>>>>
42873>>>>>>>>>>>        End_Object    // oSearch_bn
42874>>>>>>>>>>>
42874>>>>>>>>>>>
42874>>>>>>>>>>>        //AB-StoreStart
42874>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
42875>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
42876>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
42877>>>>>>>>>>>        //AB-StoreEnd
42877>>>>>>>>>>>
42877>>>>>>>>>>>    CD_End_Object    // sl059
42879>>>>>>>>>>>>
42879>>>>>>>>>>>
42879>>>>>>>>>>>//AB/     End_Object    // prj
42879>>>>>>>>>
42879>>>>>>>>>//DDB-Selection-pkg-End
42879>>>>>>>>>//DDB-FileEnd
42879>>>>>>>
42879>>>>>>>//AB-IgnoreEnd
42879>>>>>>>
42879>>>>>>>Object slNomism is a dbModalPanelSub
42881>>>>>>>
42881>>>>>>>    //AB-StoreTopStart
42881>>>>>>>    
42881>>>>>>>    
42881>>>>>>>    
42881>>>>>>>    //AB-StoreTopEnd
42881>>>>>>>
42881>>>>>>>    Set Label to "Œ¦£å©£˜«˜"
42882>>>>>>>    Set Size to 175 397
42883>>>>>>>    Set Location to 5 7
42884>>>>>>>    Set Exit_Application_Local_State to FALSE
42885>>>>>>>    Set Modal_State to FALSE
42886>>>>>>>
42886>>>>>>>    //AB-DDOStart
42886>>>>>>>
42886>>>>>>>    Object Nomisma_DD is a Nomisma_DataDictionary
42888>>>>>>>    End_Object    // Nomisma_DD
42889>>>>>>>
42889>>>>>>>    Set Main_DD to (Nomisma_DD(self))
42890>>>>>>>    Set Server to (Nomisma_DD(self))
42891>>>>>>>
42891>>>>>>>    //AB-DDOEnd
42891>>>>>>>
42891>>>>>>>    Object oSelList is a dbListSub
42893>>>>>>>        Set Main_File to Nomisma.File_Number
42894>>>>>>>        Set Size to 130 382
42895>>>>>>>        Set Location to 6 6
42896>>>>>>>
42896>>>>>>>        Begin_Row
42899>>>>>>>            Entry_Item Nomisma.Nomisma_code
42900>>>>>>>            Entry_Item Nomisma.Nomisma_descr
42901>>>>>>>            Entry_Item Nomisma.Dekadika
42902>>>>>>>            Entry_Item Nomisma.Euro_zone
42903>>>>>>>            Entry_Item Nomisma.Einai_drx
42904>>>>>>>            Entry_Item Nomisma.Einai_euro
42905>>>>>>>        End_Row
42910>>>>>>>
42910>>>>>>>        Set Form_Width    item 0 to 49
42911>>>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
42912>>>>>>>        
42912>>>>>>>        Set Form_Width    item 1 to 115
42913>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
42914>>>>>>>        
42914>>>>>>>        Set Form_Width    item 2 to 47
42915>>>>>>>        Set Header_Label  item 2 to "ƒœ¡˜› ¡á"
42916>>>>>>>        
42916>>>>>>>        Set Form_Width    item 3 to 55
42917>>>>>>>        Set Header_Label  item 3 to "…é¤ž EURO"
42918>>>>>>>        Set Column_Checkbox_State  item 3 to True
42919>>>>>>>        
42919>>>>>>>        Set Form_Width    item 4 to 55
42920>>>>>>>        Set Header_Label  item 4 to "„å¤˜  ƒ•"
42921>>>>>>>        Set Column_Checkbox_State  item 4 to True
42922>>>>>>>        
42922>>>>>>>        Set Form_Width    item 5 to 55
42923>>>>>>>        Set Header_Label  item 5 to "„å¤˜  „¬¨é"
42924>>>>>>>        Set Column_Checkbox_State  item 5 to True
42925>>>>>>>        
42925>>>>>>>
42925>>>>>>>        //AB-StoreStart
42925>>>>>>>        
42925>>>>>>>        //AB-StoreEnd
42925>>>>>>>
42925>>>>>>>    End_Object    // oSelList
42926>>>>>>>
42926>>>>>>>    Object oOK_bn is a ButtonSub
42928>>>>>>>        Set Label to "&„§ ¢¦šã"
42929>>>>>>>        Set Location to 140 279
42930>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42931>>>>>>>
42931>>>>>>>        //AB-StoreStart
42931>>>>>>>        Procedure OnClick
42933>>>>>>>            Send OK To (oSelList(current_object))
42934>>>>>>>        End_Procedure
42935>>>>>>>        //AB-StoreEnd
42935>>>>>>>
42935>>>>>>>    End_Object    // oOK_bn
42936>>>>>>>
42936>>>>>>>    Object oSearch_bn is a ButtonSub
42938>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
42939>>>>>>>        Set Location to 140 339
42940>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42941>>>>>>>
42941>>>>>>>        //AB-StoreStart
42941>>>>>>>        
42941>>>>>>>        Procedure OnClick
42943>>>>>>>            Send Search To (oSelList(current_object))
42944>>>>>>>        End_Procedure
42945>>>>>>>        
42945>>>>>>>        
42945>>>>>>>        Set Visible_State to False
42946>>>>>>>        Set Enabled_State to False
42947>>>>>>>        //AB-StoreEnd
42947>>>>>>>
42947>>>>>>>    End_Object    // oSearch_bn
42948>>>>>>>
42948>>>>>>>
42948>>>>>>>    //AB-StoreStart
42948>>>>>>>    
42948>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
42949>>>>>>>    
42949>>>>>>>    On_Key Key_Alt+Key_s Send KeyAction To (oSearch_bn(current_object))
42950>>>>>>>    
42950>>>>>>>    
42950>>>>>>>    
42950>>>>>>>    
42950>>>>>>>    //AB-StoreEnd
42950>>>>>>>
42950>>>>>>>End_Object    // slNomism
42951>>>>>>>
42951>>>>>>>//AB/ End_Object    // prj
42951>>>>>
42951>>>>>//DDB-Selection-pkg-End
42951>>>>>//DDB-FileEnd
42951>>>    Use SYSCURXR.DD
INCLUDING FILE: SYSCURXR.DD
42951>>>>>//DDB-FileStart
42951>>>>>//DDB-HeaderStart
42951>>>>>
42951>>>>>// File Name : SYSCURXR.DD
42951>>>>>// Class Name: Syscurxr_DataDictionary
42951>>>>>// Revision  : 8
42951>>>>>// Version   : 2
42951>>>>>
42951>>>>>Use  Windows           // Basic Definitions
42951>>>>>Use  DataDict          // DataDictionary Class Definition
42951>>>>>Use  DDvalTbl          // Validation Table Class Definitions
42951>>>>>
42951>>>>>Open Syscurxr
42953>>>>>
42953>>>>>//DDB-HeaderEnd
42953>>>>>
42953>>>>>Class Syscurxr_DataDictionary  is a DataDictionary_Sec
42954>>>>>
42954>>>>>    // Define_Fields:
42954>>>>>    // This procedure is used to set up all data-dictionary rules.
42954>>>>>
42954>>>>>    Procedure Define_Fields
42955>>>>>        Forward Send Define_Fields
42957>>>>>        //DDB-Generated-Code-Location
42957>>>>>        //DDB-DefineFieldStart
42957>>>>>
42957>>>>>        Set Main_File            To Syscurxr.File_Number
42958>>>>>
42958>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
42959>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
42960>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
42961>>>>>
42961>>>>>        // Field-based properties.......................
42961>>>>>
42961>>>>>        // Syscurxr.Company_Code
42961>>>>>
42961>>>>>        // Syscurxr.Branch_Code
42961>>>>>
42961>>>>>        // Syscurxr.Year_Year
42961>>>>>
42961>>>>>        // Syscurxr.Branch_Site
42961>>>>>
42961>>>>>        // Syscurxr.Year_Recr
42961>>>>>
42961>>>>>        // Syscurxr.Company_Name
42961>>>>>
42961>>>>>        // Syscurxr.Branch_Name
42961>>>>>
42961>>>>>        // Syscurxr.Year_Descr
42961>>>>>
42961>>>>>        // Syscurxr.C_Code0
42961>>>>>
42961>>>>>        // Syscurxr.C_Code00
42961>>>>>
42961>>>>>        // Syscurxr.C_Coder
42961>>>>>
42961>>>>>        // Syscurxr.Year_Xrhshfrom
42961>>>>>
42961>>>>>        // Syscurxr.Year_Xrhshto
42961>>>>>
42961>>>>>        // Syscurxr.Beto_Site
42961>>>>>
42961>>>>>        // Syscurxr.Euro_Code
42961>>>>>
42961>>>>>        //DDB-DefineFieldEnd
42961>>>>>    End_Procedure    // Define_Fields
42962>>>>>
42962>>>>>    // Field_Defaults:
42962>>>>>    // This procedure is used to establish default field values.
42962>>>>>
42962>>>>>    Procedure Field_Defaults
42963>>>>>        Forward Send Field_Defaults
42965>>>>>        //DDB-Generated-Code-Location
42965>>>>>        //DDB-FieldDefaultStart
42965>>>>>        //DDB-FieldDefaultEnd
42965>>>>>    End_Procedure    // Field_Defaults
42966>>>>>
42966>>>>>End_Class    // Syscurxr_DataDictionary
42967>>>>>//DDB-FileEnd
42967>>>    Use BMOVE.DD
INCLUDING FILE: BMOVE.DD
42967>>>>>//DDB-FileStart
42967>>>>>//DDB-HeaderStart
42967>>>>>
42967>>>>>// File Name : BMOVE.DD
42967>>>>>// Class Name: Bmove_DataDictionary
42967>>>>>// Revision  : 49
42967>>>>>// Version   : 2
42967>>>>>
42967>>>>>Use  Windows           // Basic Definitions
42967>>>>>Use  DataDict          // DataDictionary Class Definition
42967>>>>>Use  DDvalTbl          // Validation Table Class Definitions
42967>>>>>
42967>>>>>Open Bmove
42969>>>>>Open Barticl
42971>>>>>Open Baxio
42973>>>>>Open Sysrecb
42975>>>>>Open Bkinkat
42977>>>>>Open Bsum
42979>>>>>
42979>>>>>//DDB-HeaderEnd
42979>>>>>
42979>>>>>      //§ Ÿ˜¤¦å ©¬¤›¬˜©£¦å « £é¤ «à¤ bkinkat.baxio_stat_from + bkinkat.baxio_stat_to
42979>>>>>      //  ˜§¦          ©œ
42979>>>>>      //    0           0    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
42979>>>>>      //    0           1    â ©˜šàšã ©«¦ ®˜¨«¦­¬¢á¡ ¦ (create a new baxio (33.90))
42979>>>>>      //    0           2    â¥˜šàšã ˜§¦ ®˜¨«¦­¬¢á¡ ¦  (create a new baxio (53.90))
42979>>>>>
42979>>>>>      //    1           0    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
42979>>>>>      //    1           1    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
42979>>>>>      //    1           2    â¥˜šàšã ˜§¦ ®˜¨«¦­¬¢á¡ ¦
42979>>>>>
42979>>>>>      //    2           0    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
42979>>>>>      //    2           1    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
42979>>>>>      //    2           2    £œ«˜™å™˜©ž §® ˜§¦ «¨á§œ˜ ©œ «¨á§œ˜
42979>>>>>
42979>>>>>
42979>>>>>//Register_Object SL056 //¢å©«˜ gplan
42979>>>>>//Register_Object SL102 //¢å©«˜ customer
42979>>>>>//gister_Object SL056   //¢å©«˜ vendor
42979>>>>>
42979>>>>>Open SysCurXr
42981>>>>>Open Baxiokat
42983>>>>>Open Btypkin
42985>>>>>Open Bkinkat
42987>>>>>Open Baxio
42989>>>>>
42989>>>>>//Use i:\homewin.dev\easyware.vis\gl\appsrc\doGlMntn.Bp //œ¤ž£â¨à©ž šœ¤ ¡ãª ¢¦š ©« ¡ãª
42989>>>>>//jsjsjsjs 24/01/2001 Use                                       doGlMntn.Bp //œ¤ž£â¨à©ž šœ¤ ¡ãª ¢¦š ©« ¡ãª
42989>>>>>
42989>>>>>//Use                                doCUMntn.Bp //œ¤ž£â¨à©ž §œ¢˜«é¤
42989>>>>>//Use                                doVEMntn.Bp //œ¤ž£â¨à©ž §¨¦£žŸœ¬«é¤
42989>>>>>
42989>>>>>Class Bmove_DataDictionary  is a DataDictionary_Sec
42990>>>>>
42990>>>>>      Procedure Construct_Object
42991>>>>>                Forward Send Construct_Object
42993>>>>>
42993>>>>>                Property Integer piCan_Create_Baxio (FALSE)
42994>>>>>
42994>>>>>                //object id «é¤ ddo servers š ˜ «á barticl+bmove+baxio+baxiokat
42994>>>>>                //©œ«á¨¦¤«˜  ˜§¦ «ž¤ end_construct
42994>>>>>                //®¨ž© £œç¦¬¤ ©«ž¤ private.exit_btypkin_code
42994>>>>>                //š ˜ ¤˜ ©œ«á¨¦¬¤ «¦ visual interface
42994>>>>>                Property Integer piBarticl_dd        0
42995>>>>>                Property Integer piBaxio_dd          0
42996>>>>>                Property Integer piBtypkin_dd        0
42997>>>>>                Property Integer piBaxiokat_dd       0
42998>>>>>                Property Integer piBaxio_Status_From 0
42999>>>>>                Property Integer piBaxio_Status_To   0
43000>>>>>
43000>>>>>                Property Integer piCreated_Bmove  0 //©œ«á¨œ«˜  ©«ž¤ creating,
43001>>>>>                                                    //®¨ž© £¦§¦ œå«˜  ©«ž¤ update+validate_save ¡˜ 
43001>>>>>                                                    //£ž›œ¤åœ«˜  ©«ž¤ request_save & delete «¦¬ bmove
43001>>>>>
43001>>>>>                Property Integer piB_Baxio_Status  0
43002>>>>>                Property Integer piA_Baxio_Status  0
43003>>>>>
43003>>>>>                //19 §˜¢˜ âª « £âª
43003>>>>>                Property  Integer piB_Garticl_Rec0           0
43004>>>>>                Property  Integer piB_Gtypkin_Rec0           0
43005>>>>>                Property  Date    pdB_Garticl_Hmnia          0
43006>>>>>                Property  Integer piB_Garticl_No             0
43007>>>>>                Property  String  psB_Garticl_C_Code2        0
43008>>>>>                Property  Number  pnB_Garticl_Rate0          0
43009>>>>>                Property  Number  pnB_Garticl_Rate00         0
43010>>>>>                Property  Number  pnB_Garticl_RateR          0
43011>>>>>                Property  String  psB_Garticl_Aitiol         0
43012>>>>>
43012>>>>>                Property  Integer piB_Gmove_Master_Rec0      0
43013>>>>>                Property  Integer piB_Gplan_Master_Rec0      0
43014>>>>>                Property  Number  pnB_Gmove_Master_X2        0
43015>>>>>                Property  Number  pnB_Gmove_Master_P2        0
43016>>>>>                Property  String  psB_Gmove_Master_Aitiol    0
43017>>>>>
43017>>>>>                Property  Integer piB_Gmove_Slave_Rec0       0
43018>>>>>                Property  Integer piB_Gplan_Slave_Rec0       0
43019>>>>>                Property  Number  pnB_Gmove_Slave_X2         0
43020>>>>>                Property  Number  pnB_Gmove_Slave_P2         0
43021>>>>>                Property  String  psB_Gmove_Slave_Aitiol     0
43022>>>>>
43022>>>>>                //19 ¤âœª « £âª
43022>>>>>                Property  Integer piA_Garticl_Rec0           0
43023>>>>>                Property  Integer piA_Gtypkin_Rec0           0
43024>>>>>                Property  Date    pdA_Garticl_Hmnia          0
43025>>>>>                Property  Integer piA_Garticl_No             0
43026>>>>>                Property  String  psA_Garticl_C_Code2        0
43027>>>>>                Property  Number  pnA_Garticl_Rate0          0
43028>>>>>                Property  Number  pnA_Garticl_Rate00         0
43029>>>>>                Property  Number  pnA_Garticl_RateR          0
43030>>>>>                Property  String  psA_Garticl_Aitiol         0
43031>>>>>
43031>>>>>                Property  Integer piA_Gmove_Master_Rec0      0
43032>>>>>                Property  Integer piA_Gplan_Master_Rec0      0
43033>>>>>                Property  Number  pnA_Gmove_Master_X2        0
43034>>>>>                Property  Number  pnA_Gmove_Master_P2        0
43035>>>>>                Property  String  psA_Gmove_Master_Aitiol    0
43036>>>>>
43036>>>>>                Property  Integer piA_Gmove_Slave_Rec0       0
43037>>>>>                Property  Integer piA_Gplan_Slave_Rec0       0
43038>>>>>                Property  Number  pnA_Gmove_Slave_X2         0
43039>>>>>                Property  Number  pnA_Gmove_Slave_P2         0
43040>>>>>                Property  String  psA_Gmove_Slave_Aitiol     0
43041>>>>>
43041>>>>>                Property  Integer piDo_GL_Maintainance       0 //object id «žª business process
43042>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «ã¤ šœ¤ ¡ã ¢¦š ©« ¡ã
43042>>>>>                Property  Integer piDo_CUSTOMER_Maintainance 0 //object id «žª business process
43043>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §œ¢á«œª
43043>>>>>                Property  Integer piDo_VENDOR_Maintainance   0 //object id «žª business process
43044>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §¨¦£žŸœ¬«âª
43044>>>>>
43044>>>>>                //3 properties š ˜ «ž¤ feedback œ¤ž£â¨à©ž ˜§¦ «ž¤ š¢
43044>>>>>                Property Integer  piF_Garticl_Rec0           0
43045>>>>>                Property Integer  piF_Gmove_Master_Rec0      0
43046>>>>>                Property Integer  piF_Gmove_Slave_Rec0       0
43047>>>>>
43047>>>>>                Property Integer  piUpdate                   0
43048>>>>>                Property Integer  piBackout                  0
43049>>>>>
43049>>>>>                //properties š ˜ «ž¤ procedural œ¤ž£â¨à©ž «¦¬ bsum
43049>>>>>                Property String   psB_Barticl_Recr           ''
43050>>>>>                Property String   psB_Baxiokat_Recr          ''
43051>>>>>                Property Number   pnB_Baxio_V2               0
43052>>>>>                Property Number   pnB_Baxio_V0               0
43053>>>>>                Property Number   pnB_Baxio_V00              0
43054>>>>>                Property Number   pnB_Baxio_VR               0
43055>>>>>
43055>>>>>                Property String   psA_Barticl_Recr           ''
43056>>>>>                Property String   psA_Baxiokat_Recr          ''
43057>>>>>                Property Number   pnA_Baxio_V2               0
43058>>>>>                Property Number   pnA_Baxio_V0               0
43059>>>>>                Property Number   pnA_Baxio_V00              0
43060>>>>>                Property Number   pnA_Baxio_VR               0
43061>>>>>
43061>>>>>                //booleans §¦¬ ›ž¢é¤¦¬¤ «˜ operations §¦¬ Ÿ˜ šå¤¦¬¤ ©«ž¤ š¢
43061>>>>>                Property Integer  piGarticl_Delete          0 //©œ«á¨œ«˜  ©«ž¤ backout
43062>>>>>                Property Integer  piGarticl_Edit            0 //˜¤«åŸœ«¦ «¦¬ create (update)
43063>>>>>                Property Integer  piGarticl_Create          0 //©œ«á¨œ«˜  ©«ž¤ update
43064>>>>>
43064>>>>>                Property Integer  piMaster_Gmove_Delete     0 //©œ«á¨œ«˜  ©«ž¤ backout
43065>>>>>                Property Integer  piMaster_Gmove_Edit       0 //˜¤«åŸœ«¦ «¦¬ create (update)
43066>>>>>                Property Integer  piMaster_Gmove_Create     0 //©œ«á¨œ«˜  ©«ž¤ private.creating_barticl
43067>>>>>
43067>>>>>                Property Integer  piSlave_Gmove_Delete      0 //©œ«á¨¦¤«˜  ©«ž¤ update_bsum
43068>>>>>                Property Integer  piSlave_Gmove_Edit        0 //©œ«á¨¦¤«˜  ©«ž¤ update_bsum
43069>>>>>                Property Integer  piSlave_Gmove_Create      0 //©œ«á¨¦¤«˜  ©«ž¤ update_bsum
43070>>>>>                
43070>>>>>                Property Integer    piMustNotConstrain      0
43071>>>>>                
43071>>>>>                
43071>>>>>      End_Procedure   //construct_object
43072>>>>>
43072>>>>>
43072>>>>>
43072>>>>>      //****************************************************************************************
43072>>>>>      //**************P R O C E D U R A L    „ Œ † ‹„  — ‘ †    B S U M************************
43072>>>>>      //****************************************************************************************
43072>>>>>
43072>>>>>
43072>>>>>      //¡˜¢œå«˜  ˜§æ save+delete_main_file, «˜ œ£§¢œ¡æ£œ¤˜ ˜¨®œå˜ œå¤˜  locked
43072>>>>>      //¡˜  transaction is enabled !
43072>>>>>      //œ§å©žª â®à current record ©œ æ¢˜ «˜ parents.
43072>>>>>      //¡˜¢œå «ž¤ private.update_bsum
43072>>>>>      //œ§ ©«¨â­œ  «˜ œ¥ãª ¢áŸž:6001:˜¡˜«á¢¢ž¢¦ §¨æ©ž£¦ (¢áŸ¦ª ¡é› ¡˜ª)
43072>>>>>      //                        6002:ƒâ¤ â«¨œ¥œ ¦ç«œ update ¦ç«œ backout !
43072>>>>>      //œ§å©žª ˜§¦ ¢áŸ¦ª «¦¬ ¡é› ¡˜, £§¦¨œå ¤˜ ›é©œ  ¡˜  Error 10001 "Wrong Num Arguments!\n\nPlease Call Solution!"
43072>>>>>
43072>>>>>      //¡˜¢œå «ž¤ private.update_bsum 1 ­¦¨á š ˜ backout (˜­˜å¨œ©ž §˜¢˜ é¤ « £é¤) ¡˜ 
43072>>>>>      //                              1 ­¦¨á š ˜ update  (§¨æ©Ÿœ©ž ¤âà¤ « £é¤)
43072>>>>>      //œ¢âš®¦¤«˜  æ¢œª ¦  §˜¨á£œ«¨¦  before+after œá¤ œå¤˜  å©œª,
43072>>>>>      //¦§æ«œ ›â¤ œ¤ž£œ¨é¤à    ‰ € ‡ Ž Š Ž “    «¦ bsum (§® ¡á¤à £æ¤¦¤ ˜¢¢˜šã ˜ « ¦¢¦šå˜ª)
43072>>>>>      Procedure private.Trexe Returns Integer
43073>>>>>                Integer liBackout liUpdate
43074>>>>>
43074>>>>>                String  lsB_Barticl_Recr lsB_Baxiokat_Recr
43074>>>>>                Number  lnB_Baxio_V2
43074>>>>>                Number  lnB_Baxio_V0
43074>>>>>                Number  lnB_Baxio_V00
43074>>>>>                Number  lnB_Baxio_VR
43074>>>>>
43074>>>>>                String  lsA_Barticl_Recr lsA_Baxiokat_Recr
43074>>>>>                Number  lnA_Baxio_V2
43074>>>>>                Number  lnA_Baxio_V0
43074>>>>>                Number  lnA_Baxio_V00
43074>>>>>                Number  lnA_Baxio_VR
43074>>>>>
43074>>>>>                //˜¤áš¤à©ž ¡˜«á©«˜©žª «¦¬ ddo
43074>>>>>                Get piBackout to liBackout
43075>>>>>                Get piUpdate  to liUpdate
43076>>>>>
43076>>>>>                //š ˜ ¢æš¦¬ª ˜©­˜¢œå˜ª, â¢œš®¦ª backout & update
43076>>>>>                If (;                     (liBAckout = 0) and;                     (liUpdate  = 0);                   ) Begin
43078>>>>>                      Send Operation_Not_Allowed 6002 //"ƒâ¤ â«¨œ¥œ ¦ç«œ update ¦ç«œ backout !"
43079>>>>>                      //Procedure_Return    //› ˜¡¦§ã «¦¬ transaction! (£á¢¢¦¤ «œ¢œåàª ˜§åŸ˜¤¦, but who knows!
43079>>>>>                     End
43079>>>>>>
43079>>>>>
43079>>>>>                //˜¤áš¤à©ž §˜¢˜ é¤ « £é¤
43079>>>>>                Get psB_Barticl_Recr  to lsB_Barticl_Recr
43080>>>>>                Get psB_Baxiokat_Recr to lsB_Baxiokat_Recr
43081>>>>>                Get pnB_Baxio_V2      to lnB_Baxio_V2
43082>>>>>                Get pnB_Baxio_V0      to lnB_Baxio_V0
43083>>>>>                Get pnB_Baxio_V00     to lnB_Baxio_V00
43084>>>>>                Get pnB_Baxio_VR      to lnB_Baxio_VR
43085>>>>>
43085>>>>>                //˜¤áš¤à©ž ¤âà¤ « £é¤
43085>>>>>                Get psA_Barticl_Recr  to lsA_Barticl_Recr
43086>>>>>                Get psA_Baxiokat_Recr to lsA_Baxiokat_Recr
43087>>>>>                Get pnA_Baxio_V2      to lnA_Baxio_V2
43088>>>>>                Get pnA_Baxio_V0      to lnA_Baxio_V0
43089>>>>>                Get pnA_Baxio_V00     to lnA_Baxio_V00
43090>>>>>                Get pnA_Baxio_VR      to lnA_Baxio_VR
43091>>>>>
43091>>>>>                //œá¤ æ¢œª ¦  §˜¨á£œ«¨¦  before+after œå¤˜  å©œª,
43091>>>>>                //«æ«œ ›â¤ £§˜å¤à ¡˜Ÿæ¢¦¬ ©«ž¤ œ¤ž£â¨à©ž  ©¦¬šåà¤,
43091>>>>>                //˜¢¢á ­œçšà ...«¨â®¦¤«˜ª!
43091>>>>>                //sosos £ã§àª §¨â§œ  ¤˜ œ¢œš¥à gtypkin + gplan slave master ?
43091>>>>>                If (;                     (lsB_Barticl_Recr  =lsA_Barticl_Recr ) and;                     (lsB_Baxiokat_Recr =lsA_Baxiokat_Recr) and;                     (lnB_Baxio_V2      =lnA_Baxio_V2)      and;                     (lnB_Baxio_V0      =lnA_Baxio_V0)      and;                     (lnB_Baxio_V00     =lnA_Baxio_V00)     and;                     (lnB_Baxio_VR      =lnA_Baxio_VR)         ;                    ) Begin
43093>>>>>                       Procedure_Return
43094>>>>>                      End
43094>>>>>>
43094>>>>>
43094>>>>>                //˜­˜å¨œ©ž §˜¢˜ é¤ « £é¤
43094>>>>>                If (liBackout = 1);                Begin
43096>>>>>                     Send private.Update_Bsum lsB_Barticl_Recr;                                              lsB_Baxiokat_Recr;                                              lnB_Baxio_V2;                                              lnB_Baxio_V0;                                              lnB_Baxio_V00;                                              lnB_Baxio_VR;                                              (-1)
43097>>>>>                End //if (libackout = 1)
43097>>>>>>
43097>>>>>
43097>>>>>                //§¨æ©Ÿœ©ž ¤âà¤ « £é¤
43097>>>>>                If (liUpdate = 1);                Begin
43099>>>>>                     Send private.Update_Bsum lsA_Barticl_Recr;                                              lsA_Baxiokat_Recr;                                              lnA_Baxio_V2;                                              lnA_Baxio_V0;                                              lnA_Baxio_V00;                                              lnA_Baxio_VR;                                              1
43100>>>>>                End //if (liupdate = 1)
43100>>>>>>
43100>>>>>      End_Procedure //private.trexe
43101>>>>>
43101>>>>>
43101>>>>>      //¡˜¢œå«˜  ˜§æ «ž¤ prepare_to_update_bsum
43101>>>>>      //¡˜Ÿ¦¨åœ  «¦ slave operation
43101>>>>>      Procedure private.Update_Bsum String lsBarticl_Recr;                                    String lsBaxiokat_Recr;                                    Number  lnV2;                                    Number  lnV0;                                    Number  lnV00;                                    Number  lnVR;                                    Integer liSign
43102>>>>>
43102>>>>>                Integer liSlave_Gmove_Create //¡˜Ÿ˜¨á š ˜ ¢æš¦¬ª compilation
43103>>>>>
43103>>>>>                //š ˜ ¢æš¦¬ª ˜©­˜¢œå˜ª, £ã¤ «¬®æ¤ ¥œ§œ¨á©à «¦¬ª 255 ®˜¨˜¡«ã¨œª
43103>>>>>                If (Num_Arguments <> 7 ) Error 10001 "Wrong Num Arguments!\n\nPlease Call Solution!"
43106>>>>>
43106>>>>>                //**************************************************************************
43106>>>>>                //01.¬§¦¢¦š ©£æª & â¢œš®¦ª §¨¦©ã£¦¬ (+ ã -)
43106>>>>>                //**************************************************************************
43106>>>>>                If (;                     ((Abs(liSign)) <> 1 );                   ) Begin
43108>>>>>                      Send Operation_Not_Allowed 6001 //˜¡˜«á¢¢ž¢¦ §¨æ©ž£¦ (¢áŸ¦ª ¡é› ¡˜ª)
43109>>>>>                                                      //› ˜¡¦§ã «¦¬ transaction!
43109>>>>>                     End
43109>>>>>>
43109>>>>>                Move (lnV2  * liSign) to lnV2
43110>>>>>                Move (lnV0  * liSign) to lnV0
43111>>>>>                Move (lnV00 * liSign) to lnV00
43112>>>>>                Move (lnVR  * liSign) to lnVR
43113>>>>>
43113>>>>>                //**************************************************************************
43113>>>>>                //02.œ¤ž£â¨à©ž bsum
43113>>>>>                //**************************************************************************
43113>>>>>
43113>>>>>                //02.1:œç¨œ©ž/›ž£ ¦¬¨šå˜ & œ¤ž£â¨à©ž bsum
43113>>>>>                Clear Bsum
43114>>>>>                Move lsBarticl_Recr  to Bsum.Barticl_Recr
43115>>>>>                Move lsBaxiokat_Recr to Bsum.Baxiokat_Recr
43116>>>>>                Find Eq Bsum by Index.1 //barticl_recr+baxiokat_recr !!!!!!
43117>>>>>>
43117>>>>>                If (Found=0);                Begin //˜¨®ã ›ž£ ¦¬¨šå˜s ¤â¦¬ record bsum
43119>>>>>
43119>>>>>                      // jsjsjs 27/01/2001
43119>>>>>                      Add 1 to SysrecB.Bsum_Rec0
43120>>>>>                      Saverecord SysrecB
43121>>>>>                      Move SysrecB.Bsum_Rec0  to Bsum.Bsum_Rec0
43122>>>>>                      Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                        (Trim(String(Bsum.Bsum_Rec0)))))) to Bsum.Bsum_Recr
43123>>>>>
43123>>>>>                      //Add 1 to SysrecB.Bsum_Rec0
43123>>>>>                      //Saverecord SysrecB
43123>>>>>                      //§¨¦©¦®ã ! ›â¤ â®à rec mhdenia  ! ! !
43123>>>>>                      //Move SysrecB.Bsum_Rec0       to Bsum.Bsum_Rec0
43123>>>>>                      //œ¤ž£â¨à©ž £ã related §œ›åà¤
43123>>>>>                      //§¨¦©¦®ã ! ›â¤ â®à £ã related §œ›å˜ ! ! !
43123>>>>>                      Set piSlave_Gmove_Create to 1  //›ž£ ¦¬¨šå˜ ¤â¦¬ gmove slave record
43124>>>>>                      Move 1 to liSlave_Gmove_Create //¡˜Ÿ˜¨á š ˜ ¢æš¦¬ª compilation
43125>>>>>                End //«â¢¦ª ›ž£ ¦¬¨šå˜s ¤â¦¬ record bsum
43125>>>>>>
43125>>>>>
43125>>>>>                //02.2:œ¤ž£â¨à©ž bsum (update+backout)
43125>>>>>
43125>>>>>                //02.3:©é© £¦ ã › ˜š¨˜­ã «¦¬ bsum
43125>>>>>
43125>>>>>                If (;                     (Bsum.Bsum_SV2 + lnV2  = 0) and;                     ((piUpdate(Self))      = 0);                   );                Begin
43127>>>>>                     Delete Bsum
43128>>>>>                     Set piSlave_Gmove_Delete  to 1 //› ˜š¨˜­ã gmove slave record
43129>>>>>                End
43129>>>>>>
43129>>>>>                Else;                Begin
43130>>>>>                     Add lnV2  to Bsum.Bsum_SV2
43131>>>>>                     Add lnV0  to Bsum.Bsum_SV0
43132>>>>>                     Add lnV00 to Bsum.Bsum_SV00
43133>>>>>                     Add lnVR  to Bsum.Bsum_SVR
43134>>>>>                     Saverecord Bsum
43135>>>>>                     Set piSlave_Gmove_Edit    to (Not(liSlave_Gmove_Create)) //edit gmove slave record
43136>>>>>                End
43136>>>>>>
43136>>>>>
43136>>>>>      End_Procedure //private.update_bsum
43137>>>>>      //****************************************************************************************
43137>>>>>      //**************P R O C E D U R A L    „ Œ † ‹„  — ‘ †    B S U M************************
43137>>>>>      //****************************************************************************************
43137>>>>>
43137>>>>>
43137>>>>>      //private
43137>>>>>      //¡˜¢œå«˜  ˜§æ request save & delete, ˜¡¨ ™éª §¨å¤ ¡˜  £œ«á «¦ forward send
43137>>>>>      Procedure private.Initialize_Properties
43138>>>>>                Integer liBarticl_dd liBaxio_dd
43139>>>>>
43139>>>>>                //barticl related properties
43139>>>>>                Get piBarticl_dd to liBarticl_dd
43140>>>>>                If (liBarticl_dd <> 0);                Begin //œá¤ æ¤«àª ™¨å©¡à ¡á§¦ ¦ barticl_server_ddo
43142>>>>>                     Set piCreated_Barticl of liBarticl_dd to 0
43143>>>>>                End
43143>>>>>>
43143>>>>>                Else Error 10000 "Bmove does not have a Barticl Server ! ! !"
43145>>>>>
43145>>>>>                //baxio   related properties
43145>>>>>                Get piBaxio_dd to liBaxio_dd
43146>>>>>                If (liBaxio_dd <> 0);                Begin //œá¤ æ¤«àª ™¨å©¡à ¡á§¦ ¦ baxio_server_ddo
43148>>>>>                     Set piCreated_Baxio   of liBaxio_dd to 0
43149>>>>>                     Set pnB_Baxio_V2      of liBaxio_dd to 0
43150>>>>>                     Set pnB_Baxio_V0      of liBaxio_dd to 0
43151>>>>>                     Set pnB_Baxio_V00     of liBaxio_dd to 0
43152>>>>>                     Set pnB_Baxio_Vr      of liBaxio_dd to 0
43153>>>>>                     Set psB_Baxio_C_Code2 of liBaxio_dd to ""
43154>>>>>                     Set piB_Baxio_Status  of liBaxio_dd to 0
43155>>>>>                     Set piB_Baxiokat_Code of liBaxio_dd to 0
43156>>>>>                     Set piB_Year_Year     of liBaxio_dd to 0
43157>>>>>                     Set piBtypkin_Flag03  of liBaxio_dd to 0
43158>>>>>                     Set piBtypkin_Flag04  of liBaxio_dd to 0
43159>>>>>                End
43159>>>>>>
43159>>>>>                Else Error 10000 "Bmove does not have a Baxio Server ! ! !"
43161>>>>>
43161>>>>>                Set piCreated_Bmove  to 0 //©œ«á¨œ«˜  ©«ž¤ creating,
43162>>>>>
43162>>>>>                //£ž›œ¤ ©£æª 19 §˜¢˜ é¤ « £é¤
43162>>>>>                Set piB_Garticl_Rec0         to 0
43163>>>>>                Set piB_Gtypkin_Rec0         to 0
43164>>>>>                Set pdB_Garticl_Hmnia        to 0
43165>>>>>                Set piB_Garticl_No           to 0
43166>>>>>                Set psB_Garticl_C_Code2      to 0
43167>>>>>                Set pnB_Garticl_Rate0        to 0
43168>>>>>                Set pnB_Garticl_Rate00       to 0
43169>>>>>                Set pnB_Garticl_RateR        to 0
43170>>>>>                Set psB_Garticl_Aitiol       to 0
43171>>>>>
43171>>>>>                Set piB_Gmove_Master_Rec0    to 0
43172>>>>>                Set piB_Gplan_Master_Rec0    to 0
43173>>>>>                Set pnB_Gmove_Master_X2      to 0
43174>>>>>                Set pnB_Gmove_Master_P2      to 0
43175>>>>>                Set psB_Gmove_Master_Aitiol  to 0
43176>>>>>
43176>>>>>                Set piB_Gmove_Slave_Rec0     to 0
43177>>>>>                Set piB_Gplan_Slave_Rec0     to 0
43178>>>>>                Set pnB_Gmove_Slave_X2       to 0
43179>>>>>                Set pnB_Gmove_Slave_P2       to 0
43180>>>>>                Set psB_Gmove_Slave_Aitiol   to 0
43181>>>>>
43181>>>>>                //£ž›œ¤ ©£æª 19 ¤âà¤ « £é¤
43181>>>>>                Set piA_Garticl_Rec0         to 0
43182>>>>>                Set piA_Gtypkin_Rec0         to 0
43183>>>>>                Set pdA_Garticl_Hmnia        to 0
43184>>>>>                Set piA_Garticl_No           to 0
43185>>>>>                Set psA_Garticl_C_Code2      to 0
43186>>>>>                Set pnA_Garticl_Rate0        to 0
43187>>>>>                Set pnA_Garticl_Rate00       to 0
43188>>>>>                Set pnA_Garticl_RateR        to 0
43189>>>>>                Set psA_Garticl_Aitiol       to 0
43190>>>>>
43190>>>>>                Set piA_Gmove_Master_Rec0    to 0
43191>>>>>                Set piA_Gplan_Master_Rec0    to 0
43192>>>>>                Set pnA_Gmove_Master_X2      to 0
43193>>>>>                Set pnA_Gmove_Master_P2      to 0
43194>>>>>                Set psA_Gmove_Master_Aitiol  to 0
43195>>>>>
43195>>>>>                Set piA_Gmove_Slave_Rec0     to 0
43196>>>>>                Set piA_Gplan_Slave_Rec0     to 0
43197>>>>>                Set pnA_Gmove_Slave_X2       to 0
43198>>>>>                Set pnA_Gmove_Slave_P2       to 0
43199>>>>>                Set psA_Gmove_Slave_Aitiol   to 0
43200>>>>>
43200>>>>>                Set piBaxio_Status_From      to 0
43201>>>>>                Set piBaxio_Status_To        to 0
43202>>>>>
43202>>>>>                //3 properties š ˜ «ž¤ feedback œ¤ž£â¨à©ž ˜§¦ «ž¤ š¢
43202>>>>>                Set piF_Garticl_Rec0         to 0
43203>>>>>                Set piF_Gmove_Master_Rec0    to 0
43204>>>>>                Set piF_Gmove_Slave_Rec0     to 0
43205>>>>>
43205>>>>>                Set piUpdate                 to 0
43206>>>>>                Set piBackout                to 0
43207>>>>>
43207>>>>>                //properties š ˜ «ž¤ procedural œ¤ž£â¨à©ž «¦¬ bsum
43207>>>>>                Set psB_Barticl_Recr         to ''
43208>>>>>                Set psB_Baxiokat_Recr        to ''
43209>>>>>                Set pnB_Baxio_V2             to 0
43210>>>>>                Set pnB_Baxio_V0             to 0
43211>>>>>                Set pnB_Baxio_V00            to 0
43212>>>>>                Set pnB_Baxio_VR             to 0
43213>>>>>
43213>>>>>                Set psA_Barticl_Recr         to ''
43214>>>>>                Set psA_Baxiokat_Recr        to ''
43215>>>>>                Set pnA_Baxio_V2             to 0
43216>>>>>                Set pnA_Baxio_V0             to 0
43217>>>>>                Set pnA_Baxio_V00            to 0
43218>>>>>                Set pnA_Baxio_VR             to 0
43219>>>>>
43219>>>>>                //booleans §¦¬ ›ž¢é¤¦¬¤ «˜ operations §¦¬ Ÿ˜ šå¤œ  ©«¦¤ š¢
43219>>>>>                Set  piGarticl_Delete         to  0
43220>>>>>                Set  piGarticl_Edit           to  0
43221>>>>>                Set  piGarticl_Create         to  0
43222>>>>>
43222>>>>>                Set  piMaster_Gmove_Delete    to  0
43223>>>>>                Set  piMaster_Gmove_Edit      to  0
43224>>>>>                Set  piMaster_Gmove_Create    to  0
43225>>>>>
43225>>>>>                Set  piSlave_Gmove_Delete     to  0
43226>>>>>                Set  piSlave_Gmove_Edit       to  0
43227>>>>>                Set  piSlave_Gmove_Create     to  0
43228>>>>>      End_Procedure //private.Initialize_Properties
43229>>>>>
43229>>>>>
43229>>>>>      //private
43229>>>>>      //¡˜¢œå«˜  ˜§¦ «ž¤ update
43229>>>>>      Procedure private.Creating_Barticl
43230>>>>>      End_Procedure //private.creating_barticl
43231>>>>>
43231>>>>>
43231>>>>>      //private
43231>>>>>      //¡˜¢œå«˜  ˜§¦ «ž¤ update, ˜­¦ç â®œ  ™¨œå kinkat record
43231>>>>>      Procedure private.Creating_Baxio
43232>>>>>                Integer liCan_Create_Baxio //¡˜Ÿ˜¨á š ˜ ¢æš¦¬ª compilation only
43233>>>>>
43233>>>>>                //¡˜«'˜¨®áª ¤â˜ axio records ›ž£ ¦¬¨š¦ç¤«˜  £æ¤¦¤ æ«˜¤ :
43233>>>>>                //˜) œå¤˜  œ ©§¨˜¡«â˜ + «¦ bkinkat œ§ «¨â§œ  ›ž£ ¦¬¨šå˜, ã
43233>>>>>                //™) œå¤˜  §¢ž¨à«â˜   + «¦ bkinkat œ§ «¨â§œ  ›ž£ ¦¬¨šå˜.
43233>>>>>                //æ«˜¤ ›ž£ ¦¬¨š¦ç£œ ¤â˜ axio records, «æ«œ:
43233>>>>>                //˜)œ¤ž£â¨à©ž §œ›åà¤ first in, £æ¤¦ š ˜ œ ©§¨˜¡«â˜
43233>>>>>                //™)œ¤ž£â¨à©ž §œ›åà¤ first out, £æ¤¦ š ˜ §¢ž¨à«â˜
43233>>>>>                //š) §œ›å˜ status + place (˜¬«á «œ¢ ¡á «˜ œ¤ž£œ¨é¤à ©«ž¤ update)
43233>>>>>                Case Begin
43233>>>>>                     //›ž£ ¦¬¨šå˜ ˜¥ ¦š¨á­¦¬ œ ©§¨˜¡«â¦¬, œ¡¡¨œ£âª ©«¦ ®˜¨«¦­¬¢á¡ ¦
43233>>>>>                     Case ((Baxiokat.Baxiokat_Type = 1) and (Bkinkat.Bkinkat_Yn_New = 1))
43235>>>>>                          Move Btypkin.Btypkin_Anti1   to Baxio.Baxio_File_In
43236>>>>>                          Move Barticl.Barticl_Code1   to Baxio.Baxio_Code_In
43237>>>>>                          Move Barticl.Barticl_Epon1   to Baxio.Baxio_Epon_In
43238>>>>>                          Move Barticl.Barticl_Recr    to Baxio.Baxio_Fpar_In
43239>>>>>
43239>>>>>                          Move (-1)                    to Baxio.Baxio_File_Out //›â¤ ¬§á¨®œ 
43240>>>>>                          Move ""                      to Baxio.Baxio_Code_Out
43241>>>>>                          Move ""                      to Baxio.Baxio_Epon_Out
43242>>>>>                          Move 0                       to Baxio.Baxio_Fpar_Out
43243>>>>>                     Case Break
43244>>>>>
43244>>>>>                     //›ž£ ¦¬¨šå˜ ˜¥ ¦š¨á­¦¬ §¢ž¨à«â¦¬, œ¡¡¨œ£âª ©«¦ bkinkat_plac_to
43244>>>>>                     Case ((Baxiokat.Baxiokat_Type = 2) and (Bkinkat.Bkinkat_Yn_New = 1))
43247>>>>>                          Move (-1)                    to Baxio.Baxio_File_In  //›â¤ ¬§á¨®œ 
43248>>>>>                          Move ""                      to Baxio.Baxio_Code_In
43249>>>>>                          Move ""                      to Baxio.Baxio_Epon_In
43250>>>>>                          Move 0                       to Baxio.Baxio_Fpar_In
43251>>>>>
43251>>>>>                          Move Btypkin.Btypkin_Anti1   to Baxio.Baxio_File_Out
43252>>>>>                          Move Barticl.Barticl_Code1   to Baxio.Baxio_Code_Out
43253>>>>>                          Move Barticl.Barticl_Epon1   to Baxio.Baxio_Epon_Out
43254>>>>>                          Move Barticl.Barticl_Recr    to Baxio.Baxio_Fpar_Out
43255>>>>>                     Case Break
43256>>>>>
43256>>>>>                     Case Else //§¨¦­˜¤éª ¡á«  ›â¤ §áœ  ¡˜¢á
43256>>>>>                          Send Operation_Not_Allowed 3001 //›â¤ œ§ «¨â§œ«˜  ž ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬
43257>>>>>                Case End
43257>>>>>
43257>>>>>                If (Trim(Baxio.Baxio_C_Code2)='') Move (Trim(SysCurXr.C_Code0)) to Baxio.Baxio_C_Code2
43260>>>>>                Move barticl.barticl_hmnia  to baxio.baxio_hmniae
43261>>>>>                //›œç«œ¨¦ª â¢œš®¦ª ›ž£ ¦¬¨šå˜ª ¤â¦¬ ˜¥ ¦š¨á­¦¬ ˜§æ «¦ bkinkay_yn_create !
43261>>>>>                Get piCan_Create_Baxio to liCan_Create_Baxio //¡˜Ÿ˜¨á š ˜ ¢æš¦¬ª compilation only
43262>>>>>                If (liCan_Create_Baxio = FALSE) Send Operation_Not_Allowed 3001 //›â¤ œ§ «¨â§œ«˜  ž ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬
43265>>>>>      End_Procedure //private.creating_baxio
43266>>>>>
43266>>>>>
43266>>>>>//      //private
43266>>>>>//      //™¨å©¡œ  ˜§æ «¦ bsum «¦ gmove slave rec0
43266>>>>>//      //¡˜¢œå«˜  ˜§æ update+backout ?
43266>>>>>//      Function private.fiBsum_Gmove_Srec0 String lsBarticl_Recr ;
43266>>>>>//                                          String lsBaxiokat_Recr;
43266>>>>>//                                          Returns Integer
43266>>>>>//               Clear Bsum
43266>>>>>//               Move lsBarticl_Recr  to Bsum.Barticl_Recr
43266>>>>>//               Move lsBaxiokat_Recr to Bsum.Baxiokat_Recr
43266>>>>>//               Find Eq Bsum by Index.1 //barticl_recr+baxiokat_recr
43266>>>>>//               Function_Return Bsum.Gmove_Srec0
43266>>>>>//      End_Function //private.fibsum_gmove_srec0
43266>>>>>
43266>>>>>
43266>>>>>      //private
43266>>>>>      //™¨å©¡œ  œá¤ ž ©¬š¡œ¡¨ £â¤ž btypkin ¡ ¤œå «¦ libaxiokat_code
43266>>>>>      //¡˜¢œå«˜  ˜§æ update+validate_save
43266>>>>>      Function private.fiBkinkat_Baxiokat_Code String lsBtypkin_Recr;                                               Integer liBaxiokat_Code;                                               Returns Integer
43267>>>>>               Clear Bkinkat
43268>>>>>               Move SysCurXr.Company_Code   to Bkinkat.Company_Code
43269>>>>>               Move SysCurXr.Branch_Code    to Bkinkat.Branch_Code
43270>>>>>               Move SysCurXr.Year_Year      to Bkinkat.Year_year
43271>>>>>               Move lsBtypkin_Recr          to Bkinkat.Btypkin_Recr
43272>>>>>               Move liBaxiokat_Code         to Bkinkat.Baxiokat_Code
43273>>>>>               Find Eq Bkinkat by Index.3 //Company+Branch+Year+btypkin_recr+baxiokat_code
43274>>>>>>
43274>>>>>               If (Found = 0) Begin
43276>>>>>                               Set piBaxio_Status_From to (-1)
43277>>>>>                               Set piBaxio_Status_To   to (-1)
43278>>>>>                               Function_Return 0
43279>>>>>                              End
43279>>>>>>
43279>>>>>               Set piBaxio_Status_From to Bkinkat.Baxio_Stat_From
43280>>>>>               Set piBaxio_Status_To   to Bkinkat.Baxio_Stat_To
43281>>>>>
43281>>>>>
43281>>>>>               Function_Return Bkinkat.Baxiokat_Code
43282>>>>>      End_Function //private.fibkinkat_baxiokat_code
43283>>>>>
43283>>>>>
43283>>>>>      //¡˜¢œå«˜  ˜§æ update & backout
43283>>>>>      //¡˜  œ¤ž£œ¨é¤œ  « ª ©¬¤¦¢ ¡âª ˜¥åœª «¦¬ barticl
43283>>>>>      Procedure private.Adjust_Balances Integer liSign;                                        Number  lnBaxio_V2;                                        Number  lnBaxio_V0;                                        Number  lnBaxio_V00;                                        Number  lnBaxio_VR
43284>>>>>                If (;                     ((Abs(liSign)) <> 1 );                   ) Begin
43286>>>>>                      Error 10000 "€¡˜«á¢¢ž¢¦ §¨æ©ž£¦, ¢áŸ¦ª ¡é› ¡˜" //› ˜¡¦§ã «¦¬ transaction!
43287>>>>>>
43287>>>>>                      Procedure_Return
43288>>>>>                     End
43288>>>>>>
43288>>>>>
43288>>>>>                 //¤æ£ ©£˜ œšš¨˜­ãª
43288>>>>>                Add (lnBaxio_V2  * liSign) to Barticl.Barticl_SV2
43289>>>>>
43289>>>>>                //¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©žª
43289>>>>>                Add (lnBaxio_V0  * liSign) to Barticl.Barticl_SV0
43290>>>>>
43290>>>>>                //›œ¬«œ¨œç¦¤ ¤æ£ ©£˜ ®¨ã©žª
43290>>>>>                Add (lnBaxio_V00 * liSign) to Barticl.Barticl_SV00
43291>>>>>
43291>>>>>                //¤æ£ ©£˜ reporting
43291>>>>>                Add (lnBaxio_VR  * liSign) to Barticl.Barticl_SVR
43292>>>>>      End_Procedure //private.adjust_balances
43293>>>>>
43293>>>>>
43293>>>>>
43293>>>>>
43293>>>>>      //æ¢˜ «˜ ddo ˜¬«ãª «ãª ¡¢á©žª, œ¤ž£œ¨é¤¦¬¤ «˜ 4 parents ¡˜  «¦¤ œ¬˜«æ «¦¬ª
43293>>>>>      //£œ æ¢˜ «˜ ddo id's
43293>>>>>      //œ§å©žª §¨â§œ  ¤˜ ¬§á¨®¦¬¤ ¡˜  ¦  3 bpo's š ˜ «ž¤ œ¤ž£â¨à©ž «à¤ ¢¦ §é¤ modules
43293>>>>>      Procedure End_Construct_Object
43294>>>>>                Integer liBtypkin_dd liBarticl_dd liBaxio_dd liBaxiokat_dd
43295>>>>>
43295>>>>>                Forward Send End_Construct_Object
43297>>>>>
43297>>>>>                Move (Find_Server_DDO(Self        ,Barticl.File_Number )) to liBarticl_dd
43298>>>>>                Move (Find_Server_DDO(Self        ,Baxio.File_Number   )) to liBaxio_dd
43299>>>>>                Move (Find_Server_DDO(liBarticl_dd,Btypkin.File_Number )) to liBtypkin_dd
43300>>>>>                Move (Find_Server_DDO(liBaxio_dd  ,Baxiokat.File_Number)) to liBaxiokat_dd
43301>>>>>
43301>>>>>                //object id «žª business process §¦¬ œ¤ž£œ¨é¤œ  «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã
43301>>>>>                //jsjsjs 24/01/2001 Set piDo_GL_Maintainance       to (oDo_GL_Maintainance      (Self))
43301>>>>>
43301>>>>>                //object id «žª business process §¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §œ¢á«œª
43301>>>>>//------------->Set piDo_CUSTOMER_Maintainance to (oDo_CUSTOMER_Maintainance(Self))
43301>>>>>
43301>>>>>                //object id «žª business process §¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §¨¦£žŸœ¬«âª
43301>>>>>//------------->Set piDo_VENDOR_Maintainance   to (oDo_VENDOR_Maintainance  (Self))
43301>>>>>
43301>>>>>                //â¢œš®¦  ¬§¦®¨œà« ¡ãª ç§˜¨¥žª ¡˜  «à¤ 4 ddo'w
43301>>>>>                If (liBarticl_dd  = 0) Error 10000 "Bmove does not have a Barticl  Server ! ! !"
43304>>>>>                If (liBaxio_dd    = 0) Error 10000 "Bmove does not have a Baxio    Server ! ! !"
43307>>>>>                If (liBtypkin_dd  = 0) Error 10000 "Bmove does not have a Btypkin  Server ! ! !"
43310>>>>>                If (liBaxiokat_dd = 0) Error 10000 "Bmove does not have a Baxiokat Server ! ! !"
43313>>>>>
43313>>>>>                //properties › ¡á «¦¬
43313>>>>>                //æ§¦¬ «˜ ®¨ž© £¦§¦ é, Ÿ˜ £§¦¨¦ç©˜ ¤˜ â¡˜¤˜ «ž¤ å› ˜ ›¦¬¢œ á £œ «ž¤ file_field_value ?
43313>>>>>                //æ®  ©« ª §œ¨ §«é©œ ª §¦¬ › ˜®œ ¨å¦£˜¦ properties !
43313>>>>>                Set piBarticl_dd                  to liBarticl_dd
43314>>>>>                Set piBaxio_dd                    to liBaxio_dd
43315>>>>>                Set piBtypkin_dd                  to liBtypkin_dd
43316>>>>>                Set piBaxiokat_dd                 to liBaxiokat_dd
43317>>>>>
43317>>>>>                //properties «¦¬ btypkin
43317>>>>>                Set piBarticl_dd  of liBtypkin_dd to liBarticl_dd
43318>>>>>                Set piBmove_dd    of liBtypkin_dd to Self
43319>>>>>                Set piBaxio_dd    of liBtypkin_dd to liBaxio_dd
43320>>>>>                Set piBaxiokat_dd of liBtypkin_dd to liBaxiokat_dd
43321>>>>>
43321>>>>>                //properties «¦¬ baxiokat
43321>>>>>                Set piBarticl_dd  of liBaxiokat_dd to liBarticl_dd
43322>>>>>                Set piBmove_dd    of liBaxiokat_dd to Self
43323>>>>>                Set piBaxio_dd    of liBaxiokat_dd to liBaxio_dd
43324>>>>>                Set piBtypkin_dd  of liBaxiokat_dd to liBtypkin_dd
43325>>>>>
43325>>>>>                //properties «¦¬ barticl
43325>>>>>                Set piBmove_dd    of liBarticl_dd  to Self
43326>>>>>                Set piBaxio_dd    of liBarticl_dd  to liBaxio_dd
43327>>>>>                Set piBtypkin_dd  of liBarticl_dd  to liBtypkin_dd
43328>>>>>                Set piBaxiokat_dd of liBarticl_dd  to liBaxiokat_dd
43329>>>>>
43329>>>>>      End_Procedure   //end_construct_object
43330>>>>>
43330>>>>>      //£á¢¢¦¤ œå¤˜  á®¨ž©«ž, › æ«  §á¤«˜ «¦ bmove_dd «¦ › ˜®œ ¨å¦£˜ 
43330>>>>>      //œå«˜  ©˜¤ detail «¦¬ barticl, œå«˜  ©˜¤ detail «¦¬ baxio !
43330>>>>>      //ã constrain Ÿ˜ £¦¬ ®¨œ ˜©Ÿœå £æ¤¦¤ œá¤ â®à main server «¦ bmove_dd ! ! !
43330>>>>>      Procedure Constrain
43331>>>>>            Forward Send Constrain
43333>>>>>            If (piMustNotConstrain(Self)=2) Begin
43335>>>>>                Constrain Bmove.Company_Code  eq SysCurXR.Company_Code
43337>>>>>                Constrain Bmove.Branch_Code   eq SysCurXR.Branch_Code
43339>>>>>            End
43339>>>>>>
43339>>>>>            Else Begin
43340>>>>>                Constrain Bmove.Company_Code  eq SysCurXR.Company_Code
43342>>>>>                Constrain Bmove.Branch_Code   eq SysCurXR.Branch_Code
43344>>>>>                Constrain Bmove.Year_Year     eq SysCurXR.Year_Year
43346>>>>>            End
43346>>>>>>
43346>>>>>      End_Procedure   //constrain
43347>>>>>
43347>>>>>
43347>>>>>      //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
43347>>>>>      //™) ˜¤áš¤à©ž properties
43347>>>>>      //š) › ˜®œå¨ ©ž calculated §œ›åà¤
43347>>>>>      //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
43347>>>>>      //œ) œ¤ž£â¨à©ž properties after
43347>>>>>      Procedure Update
43348>>>>>                Integer liTemp
43349>>>>>                Integer liBarticl_dd      liBaxio_dd
43349>>>>>                Integer liCreated_Barticl liCreated_Baxio
43349>>>>>                String  lsGplan_Slave_Code
43349>>>>>
43349>>>>>                Forward Send Update
43351>>>>>
43351>>>>>                //0)š ˜ ¢æš¦¬ª  › ˜ «œ¨æ«ž«˜ª, æ¢¦ª ¦ ¡é› ¡˜ª
43351>>>>>                //«é¤ creating baxio + barticl  (?) «¨â®œ  «é¨˜, ˜§¦ «ž¤ update «¦¬ bmove ! ! !
43351>>>>>                //§¨é«˜ œ¤«¦§åà bkikat
43351>>>>>                Move (private.fiBkinkat_Baxiokat_Code(Self,;                                    Btypkin.Btypkin_Recr,;                                    Baxiokat.Baxiokat_Code);                     ) to liTemp
43352>>>>>                If (liTemp = 0) Send Operation_Not_Allowed 3002 //›â¤ œ§ «¨â§œ«˜  ž ¡å¤ž©ž baxiokat_code £œ «¦ btypkin
43355>>>>>
43355>>>>>
43355>>>>>                //***********************************************************
43355>>>>>                //*    ˜§æ œ›é ¡˜  ¡á«à, â®à §¢â¦¤ active bkinkat record    *
43355>>>>>                //***********************************************************
43355>>>>>
43355>>>>>
43355>>>>>                //œç¨œ©ž «à¤ 2 server ddo's
43355>>>>>                Get piBarticl_dd to liBarticl_dd
43356>>>>>                Get piBaxio_dd   to liBaxio_dd
43357>>>>>
43357>>>>>                //œ¤ž£â¨à©ž «¦¬ parent barticl dd
43357>>>>>                If (liBarticl_dd <> 0);                Begin
43359>>>>>                    Get piCreated_Barticl of liBarticl_dd to liCreated_Barticl
43360>>>>>                    If (liCreated_Barticl = TRUE)  Send private.Creating_Barticl
43363>>>>>                End
43363>>>>>>
43363>>>>>                Else Error 10000 "Bmove does not have a Barticl Server ! ! !"
43365>>>>>
43365>>>>>                //œ¤ž£â¨à©ž «¦¬ parent baxio dd
43365>>>>>                If (liBaxio_dd   <> 0);                Begin
43367>>>>>                    Get piCreated_Baxio   of liBaxio_dd   to liCreated_Baxio
43368>>>>>                    If (liCreated_Baxio   = TRUE)  Send private.Creating_Baxio
43371>>>>>                    Set piBtypkin_Flag03 of liBaxio_dd to Btypkin.Btypkin_Flag03
43372>>>>>                    Set piBtypkin_Flag04 of liBaxio_dd to Btypkin.Btypkin_Flag04
43373>>>>>                End
43373>>>>>>
43373>>>>>                Else Error 10000 "Bmove does not have a Baxio Server ! ! !"
43375>>>>>
43375>>>>>// jsjsjs sos energopoihsh xenou nomismatos 29/11/2001
43375>>>>>//                //***************************************************************************
43375>>>>>//                //============================================================================
43375>>>>>//                //||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
43375>>>>>//                //£œ«˜«¨¦§ã «žª ˜¥å˜ª ˜§æ ¤æ£ ©£˜ œšš¨˜­ãª (2) ©«˜ ¢¦ §á 3 ¤¦£å©£˜«˜  (0+00+r)
43375>>>>>//                Move 1                  to Baxio.Baxio_Rate0 //sosososo §¨¦©à¨ ¤á, £æ¤¦¤ ˜¥ æš¨˜­˜ ©œ ›¨®
43375>>>>>//                Move SysCurXr.C_Code0   to Baxio.Baxio_C_Code2 //sosososo §¨¦©à¨ ¤á, £æ¤¦¤ ˜¥ æš¨˜­˜ ©œ ›¨®
43375>>>>>//                //***************************************************************************
43375>>>>>//                //============================================================================
43375>>>>>//                //||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
43375>>>>>// jsjsjs sos energopoihsh xenou nomismatos 29/11/2001
43375>>>>>
43375>>>>>                Send Convert_Axio_Values to liBaxio_dd
43376>>>>>
43376>>>>>
43376>>>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
43376>>>>>                Move SysCurXr.Company_Code  to Bmove.Company_Code
43377>>>>>                Move SysCurXr.Branch_Code   to Bmove.Branch_Code
43378>>>>>                Move SysCurXr.Year_Year     to Bmove.Year_Year
43379>>>>>                Move Baxio.Baxio_Code       to Bmove.Baxio_Code
43380>>>>>                Move Btypkin.Btypkin_Code   to Bmove.Btypkin_Code
43381>>>>>                Move Btypkin.Btypkin_Recr   to Bmove.Btypkin_Recr
43382>>>>>                Move Barticl.Barticl_Hmnia  to Bmove.Barticl_Hmnia
43383>>>>>                Move Barticl.Barticl_No     to Bmove.Barticl_No
43384>>>>>
43384>>>>>                Move Barticl.Sls_ID         to Bmove.Sls_ID
43385>>>>>                Move Barticl.Presp_ID       to Bmove.Presp_ID
43386>>>>>                Move Barticl.Cnt_ID         to Bmove.Cnt_ID
43387>>>>>
43387>>>>>
43387>>>>>                //™) ˜¤áš¤à©ž properties
43387>>>>>
43387>>>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
43387>>>>>
43387>>>>>                //š.01:œ¤ž£â¨à©ž §œ›åà¤ previous §˜¨˜¢ã§«žª «¦¬ bmove š ˜ æ¢˜ «˜ ˜¥ æš¨˜­˜
43387>>>>>                //     §¨¦«¦ç ˜¢¢á¥à «˜ last §œ›å˜ «¦¬ baxio, «˜ ¡¨˜«áà ©«˜
43387>>>>>                //     previous §œ›å˜ «¦¬ bmove,
43387>>>>>                //     é©«œ ©«ž¤ deleting ¤˜ «˜ œ§˜¤˜­â¨à
43387>>>>>                Move Baxio.Baxio_Lfile      to  Bmove.Baxio_Pfile
43388>>>>>                Move Baxio.Baxio_Lcode      to  Bmove.Baxio_Pcode
43389>>>>>                Move Baxio.Baxio_Lepon      to  Bmove.Baxio_Pepon
43390>>>>>                Move Baxio.Baxio_Lpar       to  Bmove.Baxio_Ppar
43391>>>>>
43391>>>>>                //š.02:œ¤ž£â¨à©ž §œ›åà¤ last («œ¢œ¬«˜å¦ª §˜¨˜¢ã§«žª) «¦¬ baxio š ˜ æ¢˜ «˜ ˜¥ æš¨˜­˜
43391>>>>>
43391>>>>>// ----------------------------------------------------------------------------
43391>>>>>// js 24/02/2002    Ayth h periptosh den isxyei xoris elegxo giati otan afora
43391>>>>>//                  plhromh dikh mas o promhtheyths mpainei sto 1o koutaki dhladh
43391>>>>>//                  ston ekdoth kai paramenei kenos o apodekths (Code2).
43391>>>>>//                  Otan loipon menei kenos o apodekths den enhmeronei Lcode
43391>>>>>//                  kai an den enhmerosei Lcode tote apo to Baxio_DD katharizontai
43391>>>>>//                  ola ta _Out pedia
43391>>>>>
43391>>>>>//                Move Btypkin.Btypkin_Anti2  to Baxio.Baxio_Lfile
43391>>>>>//                Move Barticl.Barticl_Code2  to Baxio.Baxio_Lcode
43391>>>>>//                Move Barticl.Barticl_Epon2  to Baxio.Baxio_Lepon
43391>>>>>//                Move Barticl.Barticl_Recr   to Baxio.Baxio_Lpar
43391>>>>>
43391>>>>>                If (Baxiokat.Baxiokat_Type = 2) Begin
43393>>>>>                    If (Trim(Barticl.Barticl_Code2)<>'') Begin
43395>>>>>                        Move Btypkin.Btypkin_Anti2  to Baxio.Baxio_Lfile
43396>>>>>                        Move Barticl.Barticl_Code2  to Baxio.Baxio_Lcode
43397>>>>>                        Move Barticl.Barticl_Epon2  to Baxio.Baxio_Lepon
43398>>>>>                        Move Barticl.Barticl_Recr   to Baxio.Baxio_Lpar
43399>>>>>                    End
43399>>>>>>
43399>>>>>                    Else Begin
43400>>>>>                        Move Btypkin.Btypkin_Anti1  to Baxio.Baxio_Lfile
43401>>>>>                        Move Barticl.Barticl_Code1  to Baxio.Baxio_Lcode
43402>>>>>                        Move Barticl.Barticl_Epon1  to Baxio.Baxio_Lepon
43403>>>>>                        Move Barticl.Barticl_Recr   to Baxio.Baxio_Lpar
43404>>>>>                    End
43404>>>>>>
43404>>>>>                End
43404>>>>>>
43404>>>>>                Else If (Baxiokat.Baxiokat_Type = 1) Begin
43407>>>>>                    // js 24/02/2002 PARATHRHSEIS
43407>>>>>                    // Edo den kanoume elegxo giati an einai eisprakteo (xoris metavivash)
43407>>>>>                    // tote epeidh den anoigei to Code2 ex orismou tha einai kena
43407>>>>>                    // An tora einai eispraktea pros metavivash tote ex orismou
43407>>>>>                    // to Code2 exei timh apo thn othonh opote kai tha enhmerosei
43407>>>>>                    // me Lcode h update tou Baxio_DD
43407>>>>>                    // to kolpo edo einai oti apitoume apo ton xrhsth sthn periptosh
43407>>>>>                    // metavivashs na plhktrologhsei ston ekdoth KAI ston apodekth
43407>>>>>                    // ton idio kodiko tou promhtheyth ston opoio metavivazei thn epitagh
43407>>>>>
43407>>>>>                    // Ayto prepei sto epomeno version na allaxei opos epishs kai to gegonos
43407>>>>>                    // oti menei panta keno to pedio tou paralhpth stis eispraktees apo pelath
43407>>>>>                    // eno theoro oti tha prepe na mpainei h 'etairia' opos epishs kai
43407>>>>>                    // stis epitages plhrotees dikes mas menei keno o ekdoths pou pali
43407>>>>>                    // tha'prepe na'maste 'emeis' (Mia kartella dhladh opou h 'etairia mas'
43407>>>>>                    // tha emfanizetai kai pelaths kai promhtheyths.
43407>>>>>                    // js 24/02/2002 Parathrhseis
43407>>>>>                    Move Btypkin.Btypkin_Anti2  to Baxio.Baxio_Lfile
43408>>>>>                    Move Barticl.Barticl_Code2  to Baxio.Baxio_Lcode
43409>>>>>                    Move Barticl.Barticl_Epon2  to Baxio.Baxio_Lepon
43410>>>>>                    Move Barticl.Barticl_Recr   to Baxio.Baxio_Lpar
43411>>>>>                End
43411>>>>>>
43411>>>>>
43411>>>>>// ----------------------------------------------------------------------------
43411>>>>>
43411>>>>>                //š.03:œ¤ž£â¨à©ž §œ›åà¤ first out (§¨é«¦ª §˜¨˜¢ã§«žª) «¦¬ baxio š ˜ æ¢˜ «˜ ˜¥ æš¨˜­˜
43411>>>>>                //     ¡˜  œ­'æ©¦¤ ›â¤ â®¦¬¤ ã›ž œ¤ž£œ¨àŸœå,
43411>>>>>                //     ›ž¢˜›ã §¨æ¡œ «˜  š ˜ «ž¤ §¨é«ž £œ«˜™å™˜©ž-œ¥˜šàšã
43411>>>>>                If (;                     (Baxio.Baxio_Code_Out = "" );                   );                Begin
43413>>>>>                      Move Btypkin.Btypkin_Anti2   to Baxio.Baxio_File_Out
43414>>>>>                      Move Barticl.Barticl_Code2   to Baxio.Baxio_Code_Out
43415>>>>>                      Move Barticl.Barticl_Epon2   to Baxio.Baxio_Epon_Out
43416>>>>>                      Move Barticl.Barticl_Recr    to Baxio.Baxio_Fpar_Out
43417>>>>>                End
43417>>>>>>
43417>>>>>
43417>>>>>                //š.04:œ¤ž£â¨à©ž §œ›åà¤ status + place «¦¬ baxio, ˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž (bkinkat)
43417>>>>>                Move Bkinkat.Baxio_Stat_To  to Baxio.Baxio_Status //¡˜«á©«˜©ž :˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž
43418>>>>>                Move Bkinkat.Baxio_Plac_To  to Baxio.Baxio_Place  //œ¬¨å¡œ«˜ :˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž
43419>>>>>
43419>>>>>//                //š.05:©«¦ ®œå˜ slave gplan rec0
43419>>>>>//                Case Begin
43419>>>>>//                     Case (Btypkin.Gtypkin_Code <> 0) //œá¤ ž ¡å¤ž©ž œ¤ž£œ¨é¤œ  ‚Š
43419>>>>>////jsjsjs 24/01/2001
43419>>>>>////                          Clear Gplan
43419>>>>>////                          Move Company.Company_Code    to Gplan.Company_Code
43419>>>>>////                          Move Branch.Branch_Code      to Gplan.Branch_Code
43419>>>>>////                          Move Year.Year_Year          to Gplan.Year_Year
43419>>>>>////                          Move Bkinkat.Bkinkat_GplnCod to Gplan.Gplan_Code
43419>>>>>////                          Find Eq Gplan by Index.1 //company_code+branch_code+year_year+Gplan_code
43419>>>>>////                          If (Found = 1) Move Gplan.Gplan_Rec0 to Bmove.Gplan_SRec0
43419>>>>>////                          Else           Send Operation_Not_Allowed 3001 //›â¤ ™¨âŸž¡œ «¦ slave gplan_rec0
43419>>>>>////jsjsjs 24/01/2001
43419>>>>>//                     Case Break //æ® , › æ«  £§¦¨œå ¤˜ œ¤ž£œ¨é¤œ ¡˜  á¢¢˜ modules
43419>>>>>
43419>>>>>//                     Case (Btypkin.Ctypkin_Code <> 0) //œá¤ ž ¡å¤ž©ž œ¤ž£œ¨é¤œ  §œ¢á«œª
43419>>>>>//                     Case Break
43419>>>>>
43419>>>>>//                     Case (Btypkin.Vtypkin_Code <> 0) //œá¤ ž ¡å¤ž©ž œ¤ž£œ¨é¤œ  §¨¦£žŸœ¬«âª
43419>>>>>//                     Case Break
43419>>>>>
43419>>>>>//                     Case Else                        //›â¤ œ¤ž£œ¨é¤œ«˜  ¡˜¤â¤˜ ˜§¦ «˜ 3 modules
43419>>>>>//                          Move 0 to Bmove.Gplan_SRec0
43419>>>>>//                Case End
43419>>>>>
43419>>>>>                //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
43419>>>>>                Send private.Adjust_Balances (1);                                             Baxio.Baxio_V2;                                             Baxio.Baxio_V0;                                             Baxio.Baxio_V00;                                             Baxio.Baxio_VR
43420>>>>>
43420>>>>>//                //œ) œ¤ž£â¨à©ž properties after (˜§æ parent buffers!)
43420>>>>>//                Set piA_Garticl_Rec0         to Barticl.Garticl_Rec0
43420>>>>>//                Set piA_Gtypkin_Rec0         to Btypkin.Gtypkin_Rec0
43420>>>>>//                Set pdA_Garticl_Hmnia        to Barticl.Barticl_Hmnia
43420>>>>>//                Set piA_Garticl_No           to Barticl.Barticl_No
43420>>>>>//                Set psA_Garticl_C_Code2      to Baxio.Baxio_C_Code2
43420>>>>>//                Set pnA_Garticl_Rate0        to Baxio.Baxio_Rate0
43420>>>>>//                Set pnA_Garticl_Rate00       to Baxio.Baxio_Rate00
43420>>>>>//                Set pnA_Garticl_RateR        to Baxio.Baxio_RateR
43420>>>>>//                Set psA_Garticl_Aitiol       to Barticl.Barticl_Aitiol
43420>>>>>
43420>>>>>//                Set piA_Gmove_Master_Rec0    to Barticl.Gmove_Mrec0
43420>>>>>//                Set piA_Gplan_Master_Rec0    to Barticl.Gplan_Mrec0
43420>>>>>
43420>>>>>                //â¢œš®¦ª §¨¦©ã£¦¬
43420>>>>>                //If ((Abs(Btypkin.Btypkin_Sign)) <> 1) Error 10000 "To Btypkin Sign œå¤˜  ¢áŸ¦ª !"
43420>>>>>
43420>>>>>                Case Begin
43420>>>>>                     Case (Btypkin.Btypkin_Anti_Xp = 1) //®¨âà©ž master, §å©«à©ž slave
43422>>>>>//                          Set pnA_Gmove_Master_X2 to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
43422>>>>>//                          Set pnA_Gmove_Master_P2 to 0
43422>>>>>//                          Set pnA_Gmove_Slave_X2  to 0
43422>>>>>//                          Set pnA_Gmove_Slave_P2  to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
43422>>>>>                     Case Break
43423>>>>>                     Case (Btypkin.Btypkin_Anti_Xp = 2) // §å©«à©ž master, ®¨âà©ž slave
43426>>>>>//                          Set pnA_Gmove_Master_X2 to 0
43426>>>>>//                          Set pnA_Gmove_Master_P2 to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
43426>>>>>//                          Set pnA_Gmove_Slave_X2  to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
43426>>>>>//                          Set pnA_Gmove_Slave_P2  to 0
43426>>>>>                     Case Break
43427>>>>>                     Case Else
43427>>>>>                          Error 10000 "To Btypkin XP œå¤˜  ¢áŸ¦ª!"
43428>>>>>>
43428>>>>>                Case End
43428>>>>>//                Set psA_Gmove_Master_Aitiol  to Barticl.Barticl_Aitiol
43428>>>>>
43428>>>>>//                Set piA_Gmove_Slave_Rec0     to (private.fiBsum_Gmove_Srec0(Self,;
43428>>>>>//                                                                            Barticl.Barticl_Rec0,;
43428>>>>>//                                                                            Baxiokat.Baxiokat_Rec0))
43428>>>>>//                Set piA_Gplan_Slave_Rec0     to Bmove.Gplan_Srec0
43428>>>>>//                Set psA_Gmove_Slave_Aitiol   to Barticl.Barticl_Aitiol
43428>>>>>
43428>>>>>                Set piUpdate to 1
43429>>>>>
43429>>>>>                //properties š ˜ «ž¤ procedural œ¤ž£â¨à©ž «¦¬ bsum
43429>>>>>                Set psA_Barticl_Recr         to Barticl.Barticl_Recr
43430>>>>>                Set psA_Baxiokat_Recr        to Baxiokat.Baxiokat_Recr
43431>>>>>                Set pnA_Baxio_V2             to Baxio.Baxio_V2
43432>>>>>                Set pnA_Baxio_V0             to Baxio.Baxio_V0
43433>>>>>                Set pnA_Baxio_V00            to Baxio.Baxio_V00
43434>>>>>                Set pnA_Baxio_VR             to Baxio.Baxio_VR
43435>>>>>
43435>>>>>//                //booleans §¦¬ ›ž¢é¤¦¬¤ «˜ operations §¦¬ Ÿ˜ šå¤¦¬¤ ©«ã¤ š¢
43435>>>>>//                If (Barticl.Garticl_Rec0 = 0);
43435>>>>>//                Begin //«¦ barticl ›â¤ â®œ  ©¬¤›œŸœå £œ master gmove
43435>>>>>//                     If (Barticl.Gmove_Mrec0 <> 0) Error 10000 "Master Gmove <> 0 !"
43435>>>>>//                     Set  piGarticl_Create         to  1
43435>>>>>//                     Set  piMaster_Gmove_Create    to  1
43435>>>>>//                End
43435>>>>>//                Set piGarticl_Edit      to  (Not(piGarticl_Create     (Self)))
43435>>>>>//                Set piMaster_Gmove_Edit to  (Not(piMaster_Gmove_Create(Self)))
43435>>>>>      End_Procedure   //update
43436>>>>>
43436>>>>>
43436>>>>>      Procedure Backout
43437>>>>>                Forward Send Backout
43439>>>>>
43439>>>>>                //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
43439>>>>>                Send private.Adjust_Balances (-1);                                             Baxio.Baxio_V2;                                             Baxio.Baxio_V0;                                             Baxio.Baxio_V00;                                             Baxio.Baxio_VR
43440>>>>>
43440>>>>>
43440>>>>>
43440>>>>>                //******************************
43440>>>>>                //prosoxi ! allagi sto bmove def gia na exo kai ayta ta pedia !!!
43440>>>>>                //******************************
43440>>>>>
43440>>>>>//                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
43440>>>>>//                Set piB_Garticl_Rec0         to Barticl.Garticl_Rec0
43440>>>>>//                Set piB_Gtypkin_Rec0         to Btypkin.Gtypkin_Rec0
43440>>>>>//                Set pdB_Garticl_Hmnia        to Bmove.Barticl_Hmnia     //sosososo
43440>>>>>//                Set piB_Garticl_No           to Bmove.Barticl_No        //sosososo
43440>>>>>//                Set psB_Garticl_C_Code2      to Baxio.Baxio_C_Code2
43440>>>>>//                Set pnB_Garticl_Rate0        to Baxio.Baxio_Rate0
43440>>>>>//                Set pnB_Garticl_Rate00       to Baxio.Baxio_Rate00
43440>>>>>//                Set pnB_Garticl_RateR        to Baxio.Baxio_RateR
43440>>>>>//                Set psB_Garticl_Aitiol       to Barticl.Barticl_Aitiol
43440>>>>>
43440>>>>>//                Set piB_Gmove_Master_Rec0    to Barticl.Gmove_Mrec0
43440>>>>>//                Set piB_Gplan_Master_Rec0    to Barticl.Gplan_Mrec0
43440>>>>>
43440>>>>>                //â¢œš®¦ª §¨¦©ã£¦¬
43440>>>>>                //If ((Abs(Btypkin.Btypkin_Sign)) <> 1) Error 10000 "To Btypkin Sign œå¤˜  ¢áŸ¦ª !"
43440>>>>>
43440>>>>>                Case Begin
43440>>>>>                     Case (Btypkin.Btypkin_Anti_Xp = 1) //®¨âà©ž master, §å©«à©ž slave
43442>>>>>//                          Set pnB_Gmove_Master_X2 to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
43442>>>>>//                          Set pnB_Gmove_Master_P2 to 0
43442>>>>>//                          Set pnB_Gmove_Slave_X2  to 0
43442>>>>>//                          Set pnB_Gmove_Slave_P2  to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
43442>>>>>                     Case Break
43443>>>>>                     Case (Btypkin.Btypkin_Anti_Xp = 2) // §å©«à©ž master, ®¨âà©ž slave
43446>>>>>//                          Set pnB_Gmove_Master_X2 to 0
43446>>>>>//                          Set pnB_Gmove_Master_P2 to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
43446>>>>>//                          Set pnB_Gmove_Slave_X2  to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
43446>>>>>//                          Set pnB_Gmove_Slave_P2  to 0
43446>>>>>                     Case Break
43447>>>>>                     Case Else
43447>>>>>                          Error 10000 "To Btypkin XP œå¤˜  ¢áŸ¦ª!"
43448>>>>>>
43448>>>>>                Case End
43448>>>>>//                Set psB_Gmove_Master_Aitiol  to Barticl.Barticl_Aitiol
43448>>>>>
43448>>>>>//                Set piB_Gmove_Slave_Rec0     to (private.fiBsum_Gmove_Srec0(Self,;
43448>>>>>//                                                                            Barticl.Barticl_Rec0,;
43448>>>>>//                                                                            Baxiokat.Baxiokat_Rec0))
43448>>>>>
43448>>>>>//                Set piB_Gplan_Slave_Rec0     to Bmove.Gplan_Srec0
43448>>>>>//                Set psB_Gmove_Slave_Aitiol   to Barticl.Barticl_Aitiol
43448>>>>>
43448>>>>>                Set piBackout to 1
43449>>>>>
43449>>>>>                //properties š ˜ «ž¤ procedural œ¤ž£â¨à©ž «¦¬ bsum
43449>>>>>                Set psB_Barticl_Recr         to Barticl.Barticl_Recr
43450>>>>>                Set psB_Baxiokat_Recr        to Baxiokat.Baxiokat_Recr
43451>>>>>                Set pnB_Baxio_V2             to Baxio.Baxio_V2
43452>>>>>                Set pnB_Baxio_V0             to Baxio.Baxio_V0
43453>>>>>                Set pnB_Baxio_V00            to Baxio.Baxio_V00
43454>>>>>                Set pnB_Baxio_VR             to Baxio.Baxio_VR
43455>>>>>
43455>>>>>
43455>>>>>//                //booleans §¦¬ ›ž¢é¤¦¬¤ «¦ operation §¦¬ Ÿ˜ šå¤œ  ©«ã¤ š¢
43455>>>>>//                Case Begin
43455>>>>>//                     Case  (Barticl.Barticl_Lines = 0) //œá¤ › ˜š¨á­à «ž¤ «œ¢œ¬«˜å˜ š¨˜££ã «¦¬ barticl, «æ«œ Ÿ˜ › ˜š¨á¯à ¡˜  «¦ garticl
43455>>>>>//                           Set  piGarticl_Delete         to  1
43455>>>>>//                           Set  piMaster_Gmove_Delete    to  1
43455>>>>>//                     Case Break
43455>>>>>//                     Case  (Barticl.Barticl_Lines > 0) //˜¢¢¦ éª Ÿ˜ ¡á¤à edit ©«¦ garticl
43455>>>>>//                           Set  piGarticl_Edit           to  1
43455>>>>>//                           Set  piMaster_Gmove_Edit      to  1
43455>>>>>//                     Case Break
43455>>>>>//                     Case  (Barticl.Barticl_Lines < 0) //§¨æ™¢ž£˜, ¡á«  «¨â®œ 
43455>>>>>//                           Send Operation_Not_Allowed 9999 //«¨â¥«œ ¦¢ ¡á â¢œš®¦ ™á©žª
43455>>>>>//                     Case Break
43455>>>>>//                Case End
43455>>>>>
43455>>>>>/////////////////////Case (Barticl.Garticl_Rec0 = 0) //«¦ barticl ›â¤ â®œ  ©¬¤›œŸœå £œ master gmove
43455>>>>>/////////////////////     //If (Barticl.Gmove_Mrec0 <> 0) Error 1000 " djfdfsdds"
43455>>>>>/////////////////////Case Break
43455>>>>>      End_Procedure   // backout
43456>>>>>
43456>>>>>
43456>>>>>      Procedure Creating
43457>>>>>                Integer liBaxio_Status_From liBaxio_Status_To
43458>>>>>
43458>>>>>                Forward Send Creating
43460>>>>>
43460>>>>>            Move (Append('',((Trim(SysCurXR.Branch_Site))+;                             (Trim(String(Bmove.Bmove_Rec0)))))) to Bmove.Bmove_Recr
43461>>>>>
43461>>>>>
43461>>>>>                //˜¨ Ÿ£æª ¡ ¤ã©œà¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
43461>>>>>                //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBmove
43461>>>>>
43461>>>>>                //˜¨ Ÿ£æª š¨˜££é¤ barticl
43461>>>>>                Add 1 to Barticl.Barticl_Lines
43462>>>>>
43462>>>>>                //˜/˜ š¨˜££ãª á¨Ÿ¨¦¬
43462>>>>>                Add 1 to Barticl.Barticl_BmoveLa
43463>>>>>                Move Barticl.Barticl_BmoveLa to Bmove.Bmove_AA
43464>>>>>
43464>>>>>                //˜/˜ ¡å¤ž©žª ˜¥ ¦š¨á­¦¬
43464>>>>>                Add 1 to Baxio.Baxio_Bmove_Laa
43465>>>>>                Move Baxio.Baxio_Bmove_Laa to Bmove.Baxio_AA
43466>>>>>
43466>>>>>                //pourqua ??????
43466>>>>>                Get piBaxio_Status_From to liBaxio_Status_From
43467>>>>>                Get piBaxio_Status_To   to liBaxio_Status_To
43468>>>>>                //Set biBaxio_Status of liBaxio_dd to liBaxio_Status_From
43468>>>>>      End_Procedure //creating
43469>>>>>
43469>>>>>
43469>>>>>      Procedure Deleting
43470>>>>>                Integer liTemp
43471>>>>>
43471>>>>>                //œá¤ › ˜š¨á­à «ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬,
43471>>>>>                //æ¢˜ œå¤˜  ok, œå«œ «¦ ¡á¤à ˜§¦ «¦ bmove, œå«œ ˜§¦ «¦ barticl,
43471>>>>>                //œå«œ «œ¢ ¡á ˜§æ ¦§¦¬›ã§¦«œ !
43471>>>>>                //œá¤ æ£àª ›â¤ › ˜š¨á­à «ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬, ˜¢¢á ¡á§¦ ˜ á¢¢ž,
43471>>>>>                //§¨â§œ  ¤˜ › ˜¡æ¯à «¦ transaction, ˜¤˜¥á¨«ž«˜ ˜§¦ §¦ç «¦ â®à ¡˜¢â©œ .
43471>>>>>                //˜¬«æ ™â™˜ ˜ œ¢âš®œ«˜  ¡˜  ©«ž¤ validate delete, ˜¢¢á ¦¬© ˜©« ¡á §¨â§œ 
43471>>>>>                //¤˜ œ¢œšŸœå œ›é, › æ«  ž › ˜š¨˜­ã £§¦¨œå ¤˜ ¥œ¡ ¤ã©œ  ˜§æ cascade delete
43471>>>>>                //«¦¬ barticl.
43471>>>>>                //£œ á¢¢˜ ¢æš ˜ œ¤œ¨š¦§¦ é «ž¤ validate delete æ«˜¤ ž › ˜š¨˜­ã
43471>>>>>                //›â¤ ¥œ¡ ¤áœ  ˜§¦ «¦ bmove !
43471>>>>>                If (OPERATION_ORIGIN <> (Self));                Begin
43473>>>>>                     Get Validate_Delete to liTemp
43474>>>>>                     If (liTemp <> 0) Send Operation_Not_Allowed liTemp //á®¨ž©«¦
43477>>>>>                End
43477>>>>>>
43477>>>>>
43477>>>>>                Forward Send Deleting
43479>>>>>
43479>>>>>                //§¨é«˜ œ¤«¦§åà bkinkat
43479>>>>>                Move (private.fiBkinkat_Baxiokat_Code(Self,;                                    Btypkin.Btypkin_Recr,;                                    Baxiokat.Baxiokat_Code);                     ) to liTemp
43480>>>>>                If (liTemp = 0) Send Operation_Not_Allowed 4002 //›â¤ œ§ «¨â§œ«˜  ž ¡å¤ž©ž baxiokat_code £œ «¦ btypkin
43483>>>>>
43483>>>>>
43483>>>>>                //***********************************************************
43483>>>>>                //*    ˜§æ œ›é ¡˜  ¡á«à, â®à §¢â¦¤ active bkinkat record    *
43483>>>>>                //***********************************************************
43483>>>>>
43483>>>>>                //˜¨ Ÿ£æª ¡ ¤ã©œà¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
43483>>>>>                //jsjsjs 24/01/2001 Sub 1 from Year.Year_NumBmove
43483>>>>>
43483>>>>>                //˜¨ Ÿ£æª š¨˜££é¤ barticl
43483>>>>>                Sub 1 from Barticl.Barticl_Lines
43484>>>>>
43484>>>>>                //˜/˜ š¨˜££ãª á¨Ÿ¨¦¬
43484>>>>>                If (Bmove.Bmove_AA = Barticl.Barticl_BmoveLa);                Sub 1 from Barticl.Barticl_BmoveLa
43487>>>>>
43487>>>>>                //˜/˜ ¡å¤ž©žª ˜¥ ¦š¨á­¦¬
43487>>>>>                If (Bmove.Baxio_AA = Baxio.Baxio_Bmove_Laa);                Sub 1 from Baxio.Baxio_Bmove_Laa
43490>>>>>
43490>>>>>                //š.03:œ¤ž£â¨à©ž §œ›åà¤ status + place, ˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž (bkinkat)
43490>>>>>                //     ›ž¢˜›ã œ§˜¤˜­â¨à «¦ status ¡˜  «¦ place ˜§¦ œ¡â  §¦¬ «˜ §ã¨˜.
43490>>>>>                //     ™œ™˜åàª, › ˜š¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬
43490>>>>>                Move Bkinkat.Baxio_Stat_From to Baxio.Baxio_Status //¡˜«á©«˜ž :˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž
43491>>>>>                Move Bkinkat.Baxio_Plac_From to Baxio.Baxio_Place  //œ¬¨å¡œ«˜ :˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž
43492>>>>>
43492>>>>>                //œ›é Ÿ˜ §¨â§œ  ¤˜ ™á¢à ¡˜  «¦¤ §¨¦žš¦ç£œ¤¦ ˜§¦›â¡«ž ! ! ! !
43492>>>>>                //     ž œ¤ž£â¨à©ž §œ›åà¤ previous «¦¬ bmove š ˜ æ¢˜ «˜ ˜¥ æš¨˜­˜
43492>>>>>                //     âš ¤œ ©«ž¤ update §¨¦«¦ç ˜¢¢á¥à «˜ last §œ›å˜ «¦¬ baxio,
43492>>>>>                //     «˜ ¡¨˜«áà ©«˜
43492>>>>>                //     previous §œ›å˜ «¦¬ bmove,
43492>>>>>                //     â«©  é©«œ ©«ž¤ deleteig ¤˜ «˜ œ§˜¤˜­â¨à ©«¦ baxio
43492>>>>>                Move Bmove.Baxio_Pfile to Baxio.Baxio_Lfile
43493>>>>>                Move Bmove.Baxio_Pcode to Baxio.Baxio_Lcode
43494>>>>>                Move Bmove.Baxio_Pepon to Baxio.Baxio_Lepon
43495>>>>>                Move Bmove.Baxio_Ppar  to Baxio.Baxio_Lpar
43496>>>>>
43496>>>>>                // js 05/09/2002
43496>>>>>                Saverecord Barticl
43497>>>>>                Saverecord Baxio
43498>>>>>
43498>>>>>      End_Procedure //deleting
43499>>>>>
43499>>>>>
43499>>>>>      Procedure Save_Main_File
43500>>>>>                Forward Send Save_Main_File
43502>>>>>                Send private.Trexe //procedural › ˜®œå¨ ©ž bsums
43503>>>>>      End_Procedure//save_main_file
43504>>>>>
43504>>>>>
43504>>>>>      Procedure Delete_Main_File
43505>>>>>                Integer liTemp
43506>>>>>
43506>>>>>                Forward Send Delete_Main_File
43508>>>>>                Send private.Trexe //procedural › ˜®œå¨ ©ž bsums
43509>>>>>
43509>>>>>                //œá¤ › ˜š¨á­à «ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬, «æ«œ Ÿ˜ › ˜š¨á¯à ¡˜  ˜¬«æ
43509>>>>>                //¦¬© ˜©« ¡á ˜§æ œ›é ¡˜  £æ¤¦¤ ˜§¦ œ›é šå¤œ«˜  ž › ˜š¨˜­ã ˜¥ ¦š¨á­¦¬,
43509>>>>>                //œå¤˜  ¢¦ §æ¤ ž deleteing «¦¬ baxio !
43509>>>>>                If (Baxio.Baxio_Bmove_Laa = 0);                Begin
43511>>>>>
43511>>>>>                     //˜¨ Ÿ£æª ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
43511>>>>>                     //jsjsjs 26/01/2001
43511>>>>>                     //Sub 1 from Year.Year_NumBaxio
43511>>>>>
43511>>>>>                     //«œ¢œ¬«˜å˜ª ¡à› ¡æª ˜¨ Ÿ£æª ˜¥ ¦š¨á­¦¬
43511>>>>>                     If (Baxiokat.Baxio_Lcode = Baxio.Baxio_Code);                     Sub 1 from Baxiokat.Baxio_Lcode
43514>>>>>
43514>>>>>                     Delete Baxio
43515>>>>>                End
43515>>>>>>
43515>>>>>      End_Procedure //delete_main_file
43516>>>>>
43516>>>>>
43516>>>>>      Procedure Operation_Not_Allowed Integer iError_Num
43517>>>>>                String lsError_Message
43518>>>>>                Case Begin
43518>>>>>                     //˜§æ validate save
43518>>>>>                     Case (iError_Num = 5555)
43520>>>>>                          Move ("† ˜§¦Ÿã¡œ¬©ž ˜¡¬¨éŸž¡œ ˜§¦ «¦¤ ®¨ã©«ž");                          to lsError_Message
43521>>>>>                     Case Break
43522>>>>>                     Case (iError_Num = 1001)
43525>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n† «¨¦§¦§¦åž©ž œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");                          to lsError_Message
43526>>>>>                     Case Break
43527>>>>>                     Case (iError_Num = 1004)
43530>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n† ¡å¤ž©ž œ§ «¨â§œ«˜  £æ¤¦¤ £œ ¤â˜ ˜¥ æš¨˜­¦ !");                          to lsError_Message
43531>>>>>                     Case Break
43532>>>>>                     Case (iError_Num = 1005)
43535>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n† ¡å¤ž©ž œ§ «¨â§œ«˜  £æ¤¦¤ ©œ ¬§á¨®¦¤ ˜¥ æš¨˜­¦ !");                          to lsError_Message
43536>>>>>                     Case Break
43537>>>>>                     Case (iError_Num = 1006)
43540>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n’¦ barticl â®œ  «¨¦§¦§¦ žŸœå!");                          to lsError_Message
43541>>>>>                     Case Break
43542>>>>>                     Case (iError_Num = 1100)
43545>>>>>                          Move "DDC 44:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
43546>>>>>                     Case Break
43547>>>>>
43547>>>>>                     //˜§æ validate delete
43547>>>>>                     Case (iError_Num = 2001)
43550>>>>>                          Move ("DDC 44:€›ç¤˜«ž ž › ˜š¨˜­ã !\n\n† › ˜š¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");                          to lsError_Message
43551>>>>>                     Case Break
43552>>>>>                     Case (iError_Num = 2100)
43555>>>>>                          Move "DDC 44:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
43556>>>>>                     Case Break
43557>>>>>
43557>>>>>                     //˜§æ update
43557>>>>>                     Case (iError_Num = 3001)
43560>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\nƒâ¤ œ§ «¨â§œ«˜  ž ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬ !");                          to lsError_Message
43561>>>>>                     Case Break
43562>>>>>                     Case (iError_Num = 3002)
43565>>>>>                          Move ("DDC 44:‹ã €§¦›œ¡«æª «ç§¦ª €¥ ¦š¨á­¦¬ š ˜ «ž¤ ‰å¤ž©ž !\n\n‹œ "+(Trim(Btypkin.Btypkin_Descr))+;                          " ›â¤ ¡ ¤¦ç¤«˜  " + (Trim(Baxiokat.Baxiokat_Descr)));                          to lsError_Message
43566>>>>>                     Case Break
43567>>>>>
43567>>>>>                     //˜§æ deleting
43567>>>>>                     Case (iError_Num = 4002)
43570>>>>>                          Move ("DDC 44:‹ã €§¦›œ¡«æª «ç§¦ª €¥ ¦š¨á­¦¬ š ˜ «ž¤ ƒ ˜š¨˜­ã !\n\n‹œ "+(Trim(Btypkin.Btypkin_Descr))+;                          " ›â¤ ¡ ¤¦ç¤«˜  " + (Trim(Baxiokat.Baxiokat_Descr)));                          to lsError_Message
43571>>>>>                     Case Break
43572>>>>>
43572>>>>>                     //˜§æ private.Transaction_Update_Other_Modules
43572>>>>>                     Case (iError_Num = 5001) //›â¤ £§æ¨œ©˜ ¤˜ ¥˜¤˜™¨é barticl by recnum!
43575>>>>>                          Move ("DDC 44:Transaction Aborted! (Barticl Recnum Not Found)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
43576>>>>>                     Case Break
43577>>>>>                     Case (iError_Num = 5002) //›â¤ £§æ¨œ©˜ ¤˜ ¥˜¤˜™¨é bsum by recnum!
43580>>>>>                          Move ("DDC 44:Transaction Aborted! (Bsum Recnum Not Found)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
43581>>>>>                     Case Break
43582>>>>>                     Case (iError_Num = 5003) //«¦ create master âš ¤œ ©œ ã›ž ©¬¤›œ›œ£â¤¦ barticl
43585>>>>>                          Move ("DDC 44:Transaction Aborted! (Create Master on Connected B Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
43586>>>>>                     Case Break
43587>>>>>                     Case (iError_Num = 5004) //«¦ create master âš ¤œ ©œ £ã Ÿœ« ¡á gl records
43590>>>>>                          Move ("DDC 44:Transaction Aborted! (Create Master on Non Positive GL Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
43591>>>>>                     Case Break
43592>>>>>                     Case (iError_Num = 5005) //«¦ edit master âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤˜ barticl records
43595>>>>>                          Move ("DDC 44:Transaction Aborted! (Edit Master on Non Connected B Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
43596>>>>>                     Case Break
43597>>>>>                     Case (iError_Num = 5006) //«¦ edit master ›â¤ âš ¤œ ©«˜ å› ˜ master records
43600>>>>>                          Move ("DDC 44:Transaction Aborted! (Edit Master not on Same Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
43601>>>>>                     Case Break
43602>>>>>                     Case (iError_Num = 5007) //«¦ create slave âš ¤œ ©œ œå¤˜  ã›ž ©¬¤›œ›œ£â¤¦ bsum
43605>>>>>                          Move ("DDC 44:Transaction Aborted! (Create Slave on Connected B Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
43606>>>>>                     Case Break
43607>>>>>                     Case (iError_Num = 5008) //«¦ create slave âš ¤œ ©œ £ã Ÿœ« ¡æ gl record
43610>>>>>                          Move ("DDC 44:Transaction Aborted! (Create Slave on Non Positive GL Record)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
43611>>>>>                     Case Break
43612>>>>>                     Case (iError_Num = 5009) //«¦ edit slave âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤¦ record
43615>>>>>                          Move ("DDC 44:Transaction Aborted! (Edit Slave on Non Connected B Record)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
43616>>>>>                     Case Break
43617>>>>>                     Case (iError_Num = 5010) //«¦ edit slave ›â¤ âš ¤œ ©«¦ å› ¦ slave record
43620>>>>>                          Move ("DDC 44:Transaction Aborted! (Edit Slave not on Same Record)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
43621>>>>>                     Case Break
43622>>>>>                     Case (iError_Num = 5011) //«¦ delete master âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤˜ records
43625>>>>>                          Move ("DDC 44:Transaction Aborted! (Delete Master on Non Connected B Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
43626>>>>>                     Case Break
43627>>>>>                     Case (iError_Num = 5012) //«¦ delete master ›â¤ â›à©œ £ž›œ¤ ¡á master records «žª š¢
43630>>>>>                          Move ("DDC 44:Transaction Aborted! (Delete Master not with 0 GL Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
43631>>>>>                     Case Break
43632>>>>>
43632>>>>>                     //˜§æ private.trexe (save+delete main file)
43632>>>>>                     Case (iError_Num = 6001) //¢áŸ¦ª «¦¬ ¡é› ¡˜
43635>>>>>                          Move ("DDC 44:Transaction Aborted! (€¡˜«á¢¢ž¢¦ §¨æ©ž£¦)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «ž¢œ­à¤ã©«œ ©«ž¤ Solution!") to lsError_Message
43636>>>>>                     Case Break
43637>>>>>                     Case (iError_Num = 6002) //¢áŸ¦ª «¦¬ ¡é› ¡˜
43640>>>>>                          Move ("DDC 44:Transaction Aborted! (update=0 + backout=0)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «ž¢œ­à¤ã©«œ ©«ž¤ Solution!") to lsError_Message
43641>>>>>                     Case Break
43642>>>>>
43642>>>>>                     Case Else
43642>>>>>                          Forward Send Operation_Not_Allowed iError_Num
43644>>>>>                Case End
43644>>>>>
43644>>>>>                Error iError_Num lsError_Message
43645>>>>>>
43645>>>>>      End_Procedure // operation_not_allowed
43646>>>>>
43646>>>>>
43646>>>>>
43646>>>>>
43646>>>>>     //1001:Baxio_AA = baxio_bmove_laa (editing £æ¤¦¤ ©«¦¤ «œ¢œ¬«˜å¦ ˜˜ ¡å¤ž©žª «¦¬ ˜¥ ¦š¨á­¦¬)
43646>>>>>     //1002:create a new bmove £æ¤¦¤ œá¤ «¦ baxio_status <> œ¥¦­¢ž£â¤¦
43646>>>>>     //1003:˜§˜š¦¨œçœ«˜  «¦ bmove ¤˜ ˜¢¢áœ  parent barticl
43646>>>>>     //1004:˜§˜š¦¨œçœ«˜  «¦ bmove ¤˜ ˜¢¢áœ  parent baxiokat
43646>>>>>     //1005:œá¤ ž ¡å¤ž©ž ž«áœ  ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬
43646>>>>>     //     ¡˜  ¡á¤à create bmove, §¨â§œ  ¤˜ â®à ¡á¤œ  ¡˜  create baxio
43646>>>>>     //1006:›â¤ œ§ «¨â§œ«˜  save ©«¦ bmove, œá¤ «¦ barticl â®œ  šå¤œ  edit
43646>>>>>     //     ¡˜  ›â¤ â®œ  «¨â¥œ  ž request_save
43646>>>>>     //1007
43646>>>>>     //1008
43646>>>>>     //?1009:m_code:ž œšš¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ˜§¦ ¦ module §¦¬ «ž¤ ›ž£ ¦ç¨šž©œ
43646>>>>>      Function Validate_Save Returns Integer
43647>>>>>               Integer iReturnVal liBarticl_dd_Changed isNO
43648>>>>>
43648>>>>>               Forward Get Validate_Save to iReturnVal
43650>>>>>
43650>>>>>               If (Not(iReturnVal));               Begin
43652>>>>>
43652>>>>>//                If (Baxio.Baxio_HmniaL<Barticl.Barticl_Hmnia) Begin
43652>>>>>//                    Get YesNo_Box '† ž£œ¨¦£ž¤å˜ «žª œ§ «˜šãª œå¤˜ \n§¨¦šœ¤â©«œ¨ž «žª ž£œ¨¦£ž¤å˜ª «¦¬ §˜¨˜©«˜« ¡¦ç.\nŒ˜ ©¬¤œ®å©à ?' to isNO
43652>>>>>//                    If (isNO=MBR_NO) Send Operation_Not_Allowed 5555
43652>>>>>//                End
43652>>>>>
43652>>>>>                //---------â¢œš®¦  ›ž£ ¦¬¨šå˜ª ¤â¦¬ bmove record----------------------
43652>>>>>                If (Bmove.Recnum =  0);                Begin //œá¤ ›ž£ ¦¬¨šé ¤â¦ bmove record
43654>>>>>                      //1005:š ˜ ¤˜ ›œ®Ÿé «ž¤ ›ž£ ¦¬¨šå˜ ¤â¦¬ baxio record, §¨â§œ :
43654>>>>>                      //     1.œá¤ ž ¡å¤ž©ž ž«áœ  «ž¤ ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬,
43654>>>>>                      //       «æ«œ §¨â§œ  ¤˜ â®à æ¤«àª ¡á¤œ  ¡˜  create baxio.
43654>>>>>                      //     2.œá¤ ž ¡å¤ž©ž ›â¤ ž«áœ  «ž¤ ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬,
43654>>>>>                      //       «æ«œ ›â¤ §¨â§œ  ¤˜ â®à ¡á¤œ  ¡˜  create baxio.
43654>>>>>                      If ((piCan_Create_Baxio(Self)) = TRUE);                      Begin
43656>>>>>                      If (Not(;                              ((piCreated_Baxio(piBaxio_dd(Self))) = TRUE);                         )) Send Operation_Not_Allowed 1004 //ž ¡å¤ž©ž œ§ «¨â§œ«˜  £æ¤¦¤ £œ ¤â˜ ˜¥ æ§š¨˜­¦
43659>>>>>                      End
43659>>>>>>
43659>>>>>                      Else;                      Begin
43660>>>>>                      If (Not(;                              ((piCreated_Baxio(piBaxio_dd(Self))) = FALSE);                         )) Send Operation_Not_Allowed 1005 //ž ¡å¤ž©ž œ§ «¨â§œ«˜  £æ¤¦¤ ©œ ¬§á¨®¦¤ ˜¥ æ§š¨˜­¦
43663>>>>>                      End
43663>>>>>>
43663>>>>>
43663>>>>>                      //1002:create a new bmove £æ¤¦¤ œá¤ «¦ baxio_status <> œ¥¦­¢ž£â¤¦
43663>>>>>                      //If (Not(;
43663>>>>>                      //        (Baxio.Baxio_Old_Status <> 2);
43663>>>>>                      //   )) Send Operation_Not_Allowed 1002
43663>>>>>                End   //«â¢¦ª œ¢âš®à¤ ›ž£ ¦¬¨šå˜ª ¤â¦¬ bmove record
43663>>>>>>
43663>>>>>
43663>>>>>
43663>>>>>                //---------â¢œš®¦  editing existing bmove records---------------------
43663>>>>>                Else;                Begin //edit an existing record
43664>>>>>                      //1001:Baxio_AA = baxio_bmove_laa (editing £æ¤¦¤ ©«¦¤ «œ¢œ¬«˜å¦ ˜˜ ¡å¤ž©žª «¦¬ ˜¥ ¦š¨á­¦¬)
43664>>>>>                      If (Not(;                              (Baxio.Baxio_Bmove_Laa = Bmove.Baxio_AA);                         )) Send Operation_Not_Allowed 1001
43667>>>>>                End   //«â¢¦ª œ¢âš®à¤ editing existing bmove records
43667>>>>>>
43667>>>>>
43667>>>>>/////////////// js 07/08/2001  07-08-2001
43667>>>>>             // Ž ¡à› ¡˜ª ˜¬«¦ª £§ž¡œ remarks š ˜«  ž ¢¦š ¡ž £˜ª £œ©à «¦¬ ˜¤¦ ¥œ / ¡¢œ ©œ
43667>>>>>             // ¡˜  «¦ ©«ž© £¦ «žª œ­˜¨£¦šžª œ ¤˜  «œ«¦ ˜ §¦¬ ›œ¤ š ¤œ«˜  ˜¢¢ à©ž
43667>>>>>             // ˜§¦ ˜¢¢¦ ©ž£œ ¦ ©«¦ Barticl, ¡˜  œ§ §¢œ¦¤ ™˜¨˜œ  ¦«˜¤ ˜¤¦ š¦¡¢œ ¤œ 
43667>>>>>             // «¦ §˜¨˜©«˜« ¡¦ (§¨¦­˜¤àª š ˜«  £ž›œ¤ ¦¬¤ «˜ properties §¨¦ ¡˜  £œ«˜
43667>>>>>             // ˜§¦ «ž¤ private.Initialize_Properties
43667>>>>>//                //1006:›â¤ œ§ «¨â§œ«˜  save ©«¦ bmove, œá¤ «¦ barticl â®œ  šå¤œ  edit
43667>>>>>//                //     ¡˜  ›â¤ â®œ  «¨â¥œ  ž request_save
43667>>>>>//                Get Changed_State of (piBarticl_dd(Self)) to liBarticl_dd_Changed
43667>>>>>//                If (liBarticl_dd_Changed = TRUE) Send Operation_Not_Allowed 1006
43667>>>>>/////////////// js 07/08/2001  07-08-2001
43667>>>>>
43667>>>>>
43667>>>>>
43667>>>>>
43667>>>>>                //1100:cby = globals
43667>>>>>                If ( ;                    (Not(Bmove.Company_Code = SysCurXr.Company_Code)) or;                    (Not(Bmove.Branch_Code  = SysCurXr.Branch_Code )) or;                    (Not(Bmove.Year_Year    = SysCurXr.Year_Year   ));                    )                                                   Send Operation_Not_Allowed 1100
43670>>>>>
43670>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
43670>>>>>>
43670>>>>>               Function_Return iReturnVal
43671>>>>>      End_Function //validate_save
43672>>>>>
43672>>>>>
43672>>>>>      //2001:Baxio_AA = baxio_bmove_laa (delete £æ¤¦¤ «¦¤ «œ¢œ¬«˜å¦ ˜˜ ¡å¤ž©žª «¦¬ ˜¥ ¦š¨á­¦¬)
43672>>>>>      Function Validate_Delete  Returns Integer
43673>>>>>               Integer iReturnVal
43674>>>>>               Forward Get Validate_Delete  To iReturnVal
43676>>>>>               If (Not(iReturnVal));               Begin
43678>>>>>
43678>>>>>                //2001:â¢œš®¦ª «œ¢œ¬«˜å¦¬ ˜˜ ¡å¤ž©žª ˜¥ ¦š¨á­¦¬
43678>>>>>                If (Not(Bmove.Baxio_AA = Baxio.Baxio_Bmove_Laa))       Send Operation_Not_Allowed 2001
43681>>>>>                If ( ;                    (Not(Bmove.Company_Code = SysCurXr.Company_Code)) or;                    (Not(Bmove.Branch_Code  = SysCurXr.Branch_Code )) or;                    (Not(Bmove.Year_Year    = SysCurXr.Year_Year   ));                    )                                                   Send Operation_Not_Allowed 2100
43684>>>>>
43684>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
43684>>>>>>
43684>>>>>               Function_Return iReturnVal
43685>>>>>      End_Function //validate_delete
43686>>>>>
43686>>>>>
43686>>>>>      Procedure Request_Save
43687>>>>>                Integer liBaxiokat_Code liBaxio_Allow_Foreign_New_Save_State iErrorObj
43688>>>>>                String  lsBtypkin_Recr
43688>>>>>                //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties §¦¬ ˜­¦¨¦ç¤ «¦ transaction
43688>>>>>                Send private.Initialize_Properties
43689>>>>>                //˜¤áš¤à©ž «¨â®¦¬©˜ª ¡˜«á©«˜©žª «¦¬ baxio_dd
43689>>>>>                Get Allow_Foreign_New_Save_State of (piBaxio_dd(Self)) to liBaxio_Allow_Foreign_New_Save_State
43690>>>>>
43690>>>>>                //«¦ bkinkat_yn_new ¨¬Ÿ£åœ  œá¤ Ÿ˜ ¡á¤à œ ©˜šàšã ¤â¦¬ ˜¥ ¦š¨á­¦¬
43690>>>>>                Get File_Field_Current_Value File_Field Btypkin.Btypkin_Recr   to lsBtypkin_Recr
43691>>>>>                Get File_Field_Current_Value File_Field Baxiokat.Baxiokat_Code to liBaxiokat_Code
43692>>>>>
43692>>>>>                Clear Bkinkat
43693>>>>>                Move SysCurXr.Company_Code   to Bkinkat.Company_Code
43694>>>>>                Move SysCurXr.Branch_Code    to Bkinkat.Branch_Code
43695>>>>>                Move SysCurXr.Year_Year      to Bkinkat.Year_Year
43696>>>>>                Move lsBtypkin_Recr  to Bkinkat.Btypkin_Recr
43697>>>>>                Move liBaxiokat_Code to Bkinkat.Baxiokat_Code
43698>>>>>                Find Eq Bkinkat by Index.3 //company+branch+Year+btypkin_recr+baxiokat_code
43699>>>>>>
43699>>>>>                If (Found = 0) Begin //›â¤ œ§ «¨â§œ«˜  ž ¡å¤ž©ž baxiokat_code £œ «¦ btypkin
43701>>>>>                                Send Operation_Not_Allowed 3002
43702>>>>>                               End
43702>>>>>>
43702>>>>>
43702>>>>>                If (Bkinkat.Bkinkat_YN_New  = TRUE);                     Begin //œ ©˜šàšã ¤â¦¬ ˜¥ ¦š¨á­¦¬, á¨˜ œ§ «¨â§à «¦ create ©«¦ baxio
43704>>>>>                      Set Allow_Foreign_New_Save_State of (piBaxio_dd(Self)) to TRUE
43705>>>>>                      Set piCan_Create_Baxio                                 to TRUE
43706>>>>>                     End
43706>>>>>>
43706>>>>>                Else Begin //› ˜¡å¤ž©ž ¬§á¨®¦¤«¦ª ˜¥ ¦š¨á­¦¬, á¨˜ ›â¤ œ§ «¨â§à «¦ create ©«¦ baxio
43707>>>>>                      Set Allow_Foreign_New_Save_State of (piBaxio_dd(Self)) to FALSE
43708>>>>>                      Set piCan_Create_Baxio                                 to FALSE
43709>>>>>                     End
43709>>>>>>
43709>>>>>
43709>>>>>                Forward Send Request_Save
43711>>>>>
43711>>>>>                //œ§˜¤˜¤˜­¦¨á ˜¨® ¡ãª ¡˜«á©«˜©žª «¦¬ baxio_dd
43711>>>>>                Set Allow_Foreign_New_Save_State of (piBaxio_dd(Self)) to liBaxio_Allow_Foreign_New_Save_State
43712>>>>>                Set Smart_Filemode_State to True
43713>>>>>                //£ž›œ¤ ©£æª properties š ˜ œ§æ£œ¤ž ¡å¤ž©ž
43713>>>>>                Send private.Initialize_Properties
43714>>>>>                //œ§˜¤˜­¦¨á «¦¬ system indicator err
43714>>>>>                Indicate Err False
43715>>>>>      End_Procedure //request_save
43716>>>>>
43716>>>>>
43716>>>>>      Procedure Request_Delete
43717>>>>>                Integer iErrorObj
43718>>>>>                Send private.Initialize_Properties //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties
43719>>>>>                Forward Send Request_Delete
43721>>>>>                Send private.Initialize_Properties //£ž›œ¤ ©£æª properties š ˜ œ§æ£œ¤ž ¡å¤ž©ž
43722>>>>>                //œ§˜¤˜­¦¨á «¦¬ system indicator err
43722>>>>>                Indicate Err False
43723>>>>>      End_Procedure   //request_delete
43724>>>>>
43724>>>>>
43724>>>>>//      //ž ¨¦¬«å¤˜ ˜¬«ã ˜¤˜¢˜£™á¤œ  ¤˜ œ¤ž£œ¨é©œ  æ©˜ ˜§¦ «˜ ¬§æ¢¦ §˜ 3 modules «¦¬ ©¬©«ã£˜«¦ª
43724>>>>>//      //§¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤.
43724>>>>>//      //¡˜¢œå«˜  ˜§æ « ª request save & delete, £â©˜ ˜§æ transaction.
43724>>>>>//      //œ§ ©«¨â­œ  ¢áŸž : 5001 - 5012 š ˜ «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã
43724>>>>>//      Procedure private.Transaction_Update_Other_Modules
43724>>>>>//                Integer liDo_GL_Maintainance liDo_CUSTOMER_Maintainance liDo_VENDOR_Maintainance
43724>>>>>//                Integer liMust_Update_GL     liMust_Update_CUSTOMER     liMust_Update_VENDOR
43724>>>>>
43724>>>>>//                //š ˜ «ž¤ œç¨œ©ž «¦¬ bsum
43724>>>>>//                String lsBaxiokat_Recr
43724>>>>>
43724>>>>>//                //final values, š ˜ «ã¤ feedback œ¤ž£â¨à©ž «¦¬ barticl & bsum ˜§¦ «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã
43724>>>>>//                Integer liF_Garticl_Rec0 liF_Gmove_Master_Rec0 liF_Gmove_Slave_Rec0
43724>>>>>
43724>>>>>//                //final values, š ˜ «ã¤ feedback œ¤ž£â¨à©ž «¦¬ barticl ˜§¦ «¦çª §œ¢á«œª
43724>>>>>//                Integer liF_Carticl_Rec0 liF_Cmove_Rec0
43724>>>>>
43724>>>>>//                //final values, š ˜ «ã¤ feedback œ¤ž£â¨à©ž «¦¬ barticl ˜§¦ «¦çª §¨¦£žŸœ¬«âª
43724>>>>>//                Integer liF_Varticl_Rec0 liF_Vmove_Rec0
43724>>>>>
43724>>>>>//               //4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
43724>>>>>//               Integer liFlag02 liFlag03 liFlag04 liFlag05
43724>>>>>
43724>>>>>
43724>>>>>//                //œç¨œ©ž «à¤ ¢¦ §é¤ modules §¦¬ §¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤
43724>>>>>//                Get Field_Current_Value of (piBtypkin_dd(Self)) Field Btypkin.Gtypkin_Rec0 to liMust_Update_GL
43724>>>>>//                Get Field_Current_Value of (piBtypkin_dd(Self)) Field Btypkin.Ctypkin_Rec0 to liMust_Update_CUSTOMER
43724>>>>>//                Get Field_Current_Value of (piBtypkin_dd(Self)) Field Btypkin.Vtypkin_Rec0 to liMust_Update_VENDOR
43724>>>>>
43724>>>>>//               //˜¤áš¤à©ž «à¤ 4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
43724>>>>>//               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag02 to liFlag02
43724>>>>>//               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag03 to liFlag03
43724>>>>>//               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag04 to liFlag04
43724>>>>>//               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag05 to liFlag05
43724>>>>>
43724>>>>>
43724>>>>>//                //                                                  s  l  a  v  e  = bsum
43724>>>>>//                //                                        edit        create        delete
43724>>>>>//                //                                       -----        ------        ------
43724>>>>>//                // master garticl + gmove     edit         x            x              x
43724>>>>>//                //                            create                    x
43724>>>>>//                //                            delete                                   x
43724>>>>>//                // slave  gmove               edit         x            x              x
43724>>>>>//                //                            create                    x
43724>>>>>//                //                            delete                                   x
43724>>>>>
43724>>>>>
43724>>>>>//                If (;
43724>>>>>//                    ( liMust_Update_Gl     > 0                   ) and;
43724>>>>>//                    ((pnB_Baxio_V2(Self)) <> (pnA_Baxio_V2(Self)));
43724>>>>>//                   );
43724>>>>>//                Begin //edit œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ ˜¥å˜ v2 !
43724>>>>>//                //***************************************************************************
43724>>>>>//                //*  €  • †    „ Œ † ‹ „  — ‘ † ‘    ‚ „ Œ ˆ ‰ † ‘    Š Ž ‚ ˆ ‘ ’ ˆ ‰ † ‘ *
43724>>>>>//                //***************************************************************************
43724>>>>>//                //œ­'æ©¦¤ «¦ bmove record ©éŸž¡œ/› ˜š¨á­ž¡œ ¡˜¤¦¤ ¡á, §¨¦®à¨áà ©«ž¤ bpo
43724>>>>>//                //š ˜ «ž¤ œ¤ž£â¨à©ž «žª šœ¤ ¡ãª ¢¦š ©« ¡ãª, œá¤ æ£àª ®¨œ áœ«˜ ]
43724>>>>>
43724>>>>>//// jsjsjs 24/01/2001
43724>>>>>////                Send Transaction_BCVWmove_Update_GL to (piDo_GL_Maintainance(Self)) (Self);
43724>>>>>////                                                                                    liFlag02;
43724>>>>>////                                                                                    liFlag03;
43724>>>>>////                                                                                    liFlag04;
43724>>>>>////                                                                                    liFlag05
43724>>>>>//// jsjsjs 24/01/2001
43724>>>>>
43724>>>>>//                //œ­'æ©¦¤ ¡˜  «¦ bmove record ©éŸž¡œ/› ˜š¨á­ž¡œ ¡˜¤¦¤ ¡á,
43724>>>>>//                //¡˜  ž bpo â«¨œ¥œ ®à¨åª error,  ¡˜«˜®à¨é «¦ transaction
43724>>>>>//                //¡˜  œ¤ž£œ¨é¤à «© ©®œ« ¡á ˜¨®œå˜, › ˜™á¦¤«˜ª «˜
43724>>>>>//                //3 properties §¦¬ â®œ  œ§ ©«¨â¯œ  ž bpo œ¤ž£â¨à©žª «žª š¢
43724>>>>>//                Get piF_Garticl_Rec0      to liF_Garticl_Rec0       //barticl
43724>>>>>//                Get piF_Gmove_Master_Rec0 to liF_Gmove_Master_Rec0  //barticl
43724>>>>>//                Get piF_Gmove_Slave_Rec0  to liF_Gmove_Slave_Rec0   //bmove
43724>>>>>
43724>>>>>//                //œ¤ž£â¨à©ž bmove & barticl & bsum š ˜ « ª œšš¨˜­âª ©«á á¢¢˜ modules
43724>>>>>//                //œç¨œ©ž barticl, › æ«  œå¤˜  ˜§˜¨˜å«ž«¦ ©œ æ¢˜ «˜ operations
43724>>>>>//                Clear Barticl
43724>>>>>//                Get Current_Record of (piBarticl_dd(Self)) to Barticl.Recnum
43724>>>>>//                Find Eq Barticl.Recnum
43724>>>>>//                If (Found = 0);
43724>>>>>//                Begin //›â¤ £§æ¨œ©˜ ¤˜ ™¨é barticl by recnum
43724>>>>>//                      Send Operation_Not_Allowed 5001
43724>>>>>//                End
43724>>>>>
43724>>>>>//                //=======================================================================
43724>>>>>//                //œ­'æ©¦¤ ¡á¤à create or edit ©«¦ bmove,
43724>>>>>//                //™á©œ  «¦¬ §å¤˜¡˜ ©«¦ master ¡á¤à create or edit
43724>>>>>//                If ((piUpdate(Self)) = TRUE);
43724>>>>>//                Begin
43724>>>>>//                     //œç¨œ©ž bsum, «¦ ¦§¦å¦ ®¨œ áœ«˜  £æ¤¦¤ œ›é ¡˜  æ®  ©«ž¤ ¦¢ ¡ã › ˜š¨˜­ã «¦¬ garticl
43724>>>>>//                     Get Field_Current_Value of (piBaxiokat_dd(Self)) Field Baxiokat.Baxiokat_Recr to lsBaxiokat_Recr
43724>>>>>//                     Clear Bsum
43724>>>>>//                     Move Barticl.Barticl_Recr to Bsum.Barticl_Recr
43724>>>>>//                     Move lsBaxiokat_Recr      to Bsum.Baxiokat_Recr
43724>>>>>//                     Find Eq Bsum by Index.1 //barticl_recr+baxiokat_recr !!!!!!
43724>>>>>//                     If (Found=0);
43724>>>>>//                     Begin //›â¤ £§æ¨œ©˜ ¤˜ ™¨é bsum by recnum
43724>>>>>//                           Send Operation_Not_Allowed 5002
43724>>>>>//                     End
43724>>>>>
43724>>>>>//                     //œ¤ž£â¨à©ž master (create or edit)
43724>>>>>//                     Case Begin
43724>>>>>//                          //©«¦ create master, §¨â§œ  ž ©ç¤›œ©ž ¤© šå¤œ  «é¨˜,
43724>>>>>//                          //›ž¢˜›ã §¨â§œ  ¡˜  «˜ 2 §œ›å˜ ¤˜ œå¤˜  0,
43724>>>>>//                          //œ¤é «˜ master records «žª š¢ §¨â§œ  ¤˜ â®¦¬¤ Ÿœ« ¡ã « £ã.
43724>>>>>//                          Case ((piGarticl_Create(Self)) = TRUE)
43724>>>>>//                               If (;
43724>>>>>//                                    (Barticl.Garticl_Rec0 <> 0) or;
43724>>>>>//                                    (Barticl.Gmove_Mrec0  <> 0);
43724>>>>>//                                  ) Send Operation_Not_Allowed 5003 //«¦ create master âš ¤œ ©œ ã›ž ©¬¤›œ›œ£â¤¦ barticl
43724>>>>>//                               If (;
43724>>>>>//                                    (liF_Garticl_Rec0       <= 0) or;
43724>>>>>//                                    (liF_Gmove_Master_Rec0  <= 0);
43724>>>>>//                                  ) Send Operation_Not_Allowed 5004 //«¦ create master âš ¤œ ©œ £ã Ÿœ« ¡á gl records
43724>>>>>//                               Move liF_Garticl_Rec0      to Barticl.Garticl_Rec0 //©ç¤›œ©ž £œ garticl
43724>>>>>//                               Move liF_Gmove_Master_Rec0 to Barticl.Gmove_Mrec0  //©ç¤›œ©ž £œ master gmove
43724>>>>>//                               Saverecord Barticl
43724>>>>>//                          Case Break
43724>>>>>
43724>>>>>//                          //©«¦ edit master, §¨â§œ  ž ©ç¤›œ©ž ã›ž ¤˜ ¬§á¨®œ ,
43724>>>>>//                          //›ž¢˜›ã §¨â§œ  ¡˜  «˜ 2 §œ›å˜ ¤˜ œå¤˜  > 0
43724>>>>>//                          //¡˜  £á¢ ©«˜ ¤˜ © š¦¬¨œ¬«¦ç£œ æ«  ¡á¤˜£œ œ¤ž£â¨à©ž «žª š¢ ©«˜ å› ˜ master records
43724>>>>>//                          Case Else
43724>>>>>//                               If (;
43724>>>>>//                                    (Barticl.Garticl_Rec0 <= 0) or;
43724>>>>>//                                    (Barticl.Gmove_Mrec0  <= 0);
43724>>>>>//                                  ) Send Operation_Not_Allowed 5005 //«¦ edit master âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤˜ records
43724>>>>>//                               If (;
43724>>>>>//                                    (liF_Garticl_Rec0      <> Barticl.Garticl_Rec0) or;
43724>>>>>//                                    (liF_Gmove_Master_Rec0 <> Barticl.Gmove_Mrec0 );
43724>>>>>//                                  ) Send Operation_Not_Allowed 5006 //«¦ edit master ›â¤ âš ¤œ ©«˜ å› ˜ master records
43724>>>>>//                          Case Break
43724>>>>>//                     Case End //«â¢¦ª œ¤ž£â¨à©žª master
43724>>>>>
43724>>>>>//                     //œ¤ž£â¨à©ž slave (create or edit)
43724>>>>>//                     Case Begin
43724>>>>>//                          //©«¦ create slave, §¨â§œ  ž ©ç¤›œ©ž ¤˜ šå¤œ  «é¨˜,
43724>>>>>//                          //›ž¢˜›ã §¨â§œ  «o 1 §œ›åo ¤˜ œå¤˜  0,
43724>>>>>//                          //œ¤é «o slave record «žª š¢ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã « £ã.
43724>>>>>//                          Case ((piSlave_Gmove_Create(Self)) = TRUE)
43724>>>>>//                               If (Bsum.Gmove_Srec0 <> 0);
43724>>>>>//                                    Send Operation_Not_Allowed 5007 //«¦ create slave âš ¤œ ©œ œå¤˜  ã›ž ©¬¤›œ›œ£â¤¦ bsum
43724>>>>>//                               If (liF_Gmove_Slave_Rec0  <= 0);
43724>>>>>//                                    Send Operation_Not_Allowed 5008 //«¦ create slave âš ¤œ ©œ £ã Ÿœ« ¡æ gl record
43724>>>>>//                               Move liF_Gmove_Slave_Rec0  to Bsum.Gmove_Srec0     //©ç¤›œ©ž £œ slave gmove
43724>>>>>//                               Saverecord Bsum
43724>>>>>//                          Case Break
43724>>>>>
43724>>>>>//                          //©«¦ edit slave, §¨â§œ  ž ©ç¤›œ©ž ã›ž ¤˜ ¬§á¨®œ ,
43724>>>>>//                          //›ž¢˜›ã §¨â§œ  «¦ 1 §œ›å¦ ¤˜ œå¤˜  > 0
43724>>>>>//                          //¡˜  £á¢ ©«˜ ¤˜ © š¦¬¨œ¬«¦ç£œ æ«  ¡á¤˜£œ œ¤ž£â¨à©ž «žª š¢ ©«¦ å› ¦ slave record
43724>>>>>//                          Case Else
43724>>>>>//                               If (Bsum.Gmove_Srec0 =  0);
43724>>>>>//                                    Send Operation_Not_Allowed 5009 //«¦ edit slave âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤¦ record
43724>>>>>//                               If (liF_Gmove_Slave_Rec0  <> Bsum.Gmove_Srec0);
43724>>>>>//                                    Send Operation_Not_Allowed 5010 //«¦ edit slave ›â¤ âš ¤œ ©«¦ å› ¦ slave record
43724>>>>>//                          Case Break
43724>>>>>//                     Case End //«â¢¦ª œ¤ž£â¨à©žª slave
43724>>>>>//                End //«â¢¦ª œ¤ž£â¨à©žª edit or create bmove & barticl & bsum š ˜ « ª œšš¨˜­âª ©«á á¢¢˜ modules
43724>>>>>//                //=======================================================================
43724>>>>>
43724>>>>>//                //œ­'æ©¦¤ ©™ã¤à «ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ barticl,
43724>>>>>//                //®à¨åª æ£àª ¤˜ ©™ã©à ˜¬«æ,
43724>>>>>//                //£ž›œ¤åà ©«¦ barticl «¦ Garticl_Rec0 & Gmove_Mrec0,
43724>>>>>//                //š ˜ ¤˜ ˜§¦©¬¤›â©à «¦ barticl ˜§¦ «¦ garticl & «¦ gmove
43724>>>>>//                If ((piGarticl_Delete(Self)) = TRUE);
43724>>>>>//                Begin
43724>>>>>//                     //©«¦ delete master, §¨â§œ  ž ©ç¤›œ©ž ã›ž ¤˜ ¬§á¨®œ ,
43724>>>>>//                     //›ž¢˜›ã §¨â§œ  ¡˜  «˜ 2 §œ›å˜ ¤˜ œå¤˜  > 0
43724>>>>>//                     //¡˜  £á¢ ©«˜ ¤˜ © š¦¬¨œ¬«¦ç£œ æ«  «˜ master records «žª š¢ œå¤˜  £ž›œ¤ ¡á
43724>>>>>//                     If (;
43724>>>>>//                          (Barticl.Garticl_Rec0 <= 0) or;
43724>>>>>//                          (Barticl.Gmove_Mrec0  <= 0);
43724>>>>>//                        ) Send Operation_Not_Allowed 5011 //«¦ delete master âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤˜ records
43724>>>>>//                     If (;
43724>>>>>//                          (liF_Garticl_Rec0      <> 0) or;
43724>>>>>//                          (liF_Gmove_Master_Rec0 <> 0);
43724>>>>>//                        ) Send Operation_Not_Allowed 5012 //«¦ delete master ›â¤ â›à©œ £ž›œ¤ ¡á master records «žª š¢
43724>>>>>//                     Move liF_Garticl_Rec0      to Barticl.Garticl_Rec0 //˜§¦©ç¤›œ©ž £œ garticl
43724>>>>>//                     Move liF_Gmove_Master_Rec0 to Barticl.Gmove_Mrec0  //˜§¦˜ç¤›œ©ž £œ master gmove
43724>>>>>//                     Saverecord Barticl
43724>>>>>//                End //«â¢¦ª ˜§¦©ç¤›œ©žª barticl ˜§¦ garticl & gmove
43724>>>>>//                //****************************************************************************
43724>>>>>//                //* ’ „ Š Ž ‘    „ Œ † ‹ „  — ‘ † ‘    ‚ „ Œ ˆ ‰ † ‘    Š Ž ‚ ˆ ‘ ’ ˆ ‰ † ‘ *
43724>>>>>//                //****************************************************************************
43724>>>>>//                End //if (liMust_Update_Gl > 0) and ...
43724>>>>>
43724>>>>>
43724>>>>>
43724>>>>>//                If (liMust_Update_CUSTOMER > 0);
43724>>>>>//                Begin
43724>>>>>//                //****************************************************************************
43724>>>>>//                //*  €  • †    „ Œ † ‹ „  — ‘ † ‘     „ Š € ’ — Œ                         *
43724>>>>>//                //****************************************************************************
43724>>>>>//                //****************************************************************************
43724>>>>>//                //* ’ „ Š Ž ‘    „ Œ † ‹ „  — ‘ † ‘     „ Š € ’ — Œ                        *
43724>>>>>//                //****************************************************************************
43724>>>>>//                End //if (liMust_Update_CUSTOMER > 0)
43724>>>>>
43724>>>>>
43724>>>>>
43724>>>>>//                If (liMust_Update_VENDOR  > 0);
43724>>>>>//                Begin
43724>>>>>//                //****************************************************************************
43724>>>>>//                //*  €  • †    „ Œ † ‹ „  — ‘ † ‘      Ž ‹ † ‡ „ “ ’ — Œ                 *
43724>>>>>//                //****************************************************************************
43724>>>>>//                //****************************************************************************
43724>>>>>//                //* ’ „ Š Ž ‘    „ Œ † ‹ „  — ‘ † ‘      Ž ‹ † ‡ „ “ ’ — Œ                *
43724>>>>>//                //****************************************************************************
43724>>>>>//                End //if (liMust_Update_VENDOR > 0)
43724>>>>>
43724>>>>>//      End_Procedure //private.transaction_update_other_modules
43724>>>>>
43724>>>>>
43724>>>>>              //§˜¨'æ¢¦ §¦¬ œå¤˜  ..›ç¤˜£ž, ›â¤ §˜å¦¬¤ › æ«  «˜ §œ›å˜ œå¤˜  display only ! ¡˜  foreign fields
43724>>>>>              //Set File_Field_Entry File_Field Barticl.Garticl_Rec0 FALSE to liF_Garticl_Rec0
43724>>>>>              //Set File_Field_Entry File_Field Barticl.Gmove_Mrec0  FALSE to liF_Gmove_Master_Rec0
43724>>>>>              //Set File_Field_Entry File_Field Barticl.Gplan_Mrec0  FALSE to liF_Gplan_Master_Rec0
43724>>>>>
43724>>>>>              //Set File_Field_Entry File_Field Bmove.Gmove_Srec0    FALSE to liF_Gmove_Slave_Rec0
43724>>>>>              //Set File_Field_Entry File_Field Bmove.Gplan_Srec0    FALSE to liF_Gplan_Slave_Rec0
43724>>>>>
43724>>>>>              //Set File_Field_Changed_Value File_Field Barticl.Garticl_Rec0 to liF_Garticl_Rec0
43724>>>>>               //Set File_Field_Changed_Value File_Field Barticl.Gmove_Mrec0  to liF_Gmove_Master_Rec0
43724>>>>>              //Set File_Field_Changed_Value File_Field Barticl.Gplan_Mrec0  to liF_Gplan_Master_Rec0
43724>>>>>
43724>>>>>               //Set Field_Changed_Value      Field      Bmove.Gmove_Srec0    to liF_Gmove_Slave_Rec0
43724>>>>>               //Set Field_Changed_Value      Field      Bmove.Gplan_Srec0    to liF_Gplan_Slave_Rec0
43724>>>>>
43724>>>>>
43724>>>>>               //Forward Send Request_Save
43724>>>>>
43724>>>>>
43724>>>>>
43724>>>>>
43724>>>>>
43724>>>>>//--------------------------------------------------------------------------------
43724>>>>>    Procedure Define_Fields
43725>>>>>        Forward Send Define_Fields
43727>>>>>        //DDB-Generated-Code-Location
43727>>>>>        //DDB-DefineFieldStart
43727>>>>>
43727>>>>>        Set Main_File            To Bmove.File_Number
43728>>>>>        Set Cascade_Delete_State To FALSE
43729>>>>>
43729>>>>>
43729>>>>>        // Parent (Server) file structure...............
43729>>>>>        Send Add_Server_File  Barticl.File_Number
43730>>>>>        Send Add_Server_File  Baxio.File_Number
43731>>>>>
43731>>>>>        // External (System) file structure.............
43731>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
43732>>>>>        Send Add_System_File  Bkinkat.File_Number  DD_LOCK_ON_ALL
43733>>>>>        Send Add_System_File  Bsum.File_Number  DD_LOCK_ON_ALL
43734>>>>>
43734>>>>>        Define_Auto_Increment  Sysrecb.Bmove_Rec0  To Bmove.Bmove_Rec0
43737>>>>>
43737>>>>>        // Field-based properties.......................
43737>>>>>
43737>>>>>        // Bmove.Company_Code
43737>>>>>
43737>>>>>        // Bmove.Branch_Code
43737>>>>>
43737>>>>>        // Bmove.Year_Year
43737>>>>>
43737>>>>>        // Bmove.Btypkin_Code
43737>>>>>
43737>>>>>        // Bmove.Barticl_Hmnia
43737>>>>>
43737>>>>>        // Bmove.Barticl_No
43737>>>>>
43737>>>>>        // Bmove.Baxio_Code
43737>>>>>
43737>>>>>        // Bmove.Barticl_Recr
43737>>>>>
43737>>>>>        // Bmove.Baxio_Recr
43737>>>>>
43737>>>>>        // Bmove.Bmove_Rec0
43737>>>>>
43737>>>>>        // Bmove.Bmove_Recr
43737>>>>>
43737>>>>>        // Bmove.Bmove_Aa
43737>>>>>
43737>>>>>        // Bmove.Baxio_Aa
43737>>>>>
43737>>>>>        // Bmove.Gplan_Srec0
43737>>>>>
43737>>>>>        // Bmove.Baxio_Pfile
43737>>>>>
43737>>>>>        // Bmove.Baxio_Pcode
43737>>>>>
43737>>>>>        // Bmove.Baxio_Pepon
43737>>>>>
43737>>>>>        // Bmove.Baxio_Ppar
43737>>>>>
43737>>>>>        // Bmove.Btypkin_Recr
43737>>>>>
43737>>>>>        // Bmove.Sls_Id
43737>>>>>
43737>>>>>        // Bmove.Cnt_Id
43737>>>>>
43737>>>>>        // Bmove.Presp_Id
43737>>>>>
43737>>>>>        // Bmove.Bmove_M_Code
43737>>>>>
43737>>>>>        // Bmove.Cmoves_Recr
43737>>>>>
43737>>>>>        // Bmove.Exei_Enhmerosei
43737>>>>>
43737>>>>>        // Bmove.Hmnia_Enhmeros
43737>>>>>
43737>>>>>        //DDB-DefineFieldEnd
43737>>>>>
43737>>>>>        Set Main_File            To Bmove.File_Number
43738>>>>>        Set Cascade_Delete_State To FALSE
43739>>>>>
43739>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
43740>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
43741>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43742>>>>>
43742>>>>>        // Parent (Server) file structure...............
43742>>>>>        Send Add_Server_File  Baxio.File_Number
43743>>>>>        Send Add_Server_File  Barticl.File_Number
43744>>>>>
43744>>>>>        // External (System) file structure.............
43744>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
43745>>>>>        Send Add_System_File  Bkinkat.File_Number  DD_LOCK_ON_ALL
43746>>>>>        Send Add_System_File  Bsum.File_Number  DD_LOCK_ON_ALL
43747>>>>>
43747>>>>>        Define_Auto_Increment  Sysrecb.Bmove_Rec0  To Bmove.Bmove_Rec0
43750>>>>>
43750>>>>>        // Field-based properties.......................
43750>>>>>
43750>>>>>        // Bmove.Company_Code
43750>>>>>
43750>>>>>        // Bmove.Branch_Code
43750>>>>>
43750>>>>>        // Bmove.Year_Year
43750>>>>>
43750>>>>>        // Bmove.Btypkin_Code
43750>>>>>
43750>>>>>        // Bmove.Barticl_Hmnia
43750>>>>>
43750>>>>>        // Bmove.Barticl_No
43750>>>>>
43750>>>>>        // Bmove.Barticl_Rec0
43750>>>>>
43750>>>>>        // Bmove.Baxio_Rec0
43750>>>>>
43750>>>>>        // Bmove.Bmove_Rec0
43750>>>>>
43750>>>>>        // Bmove.Bmove_Aa
43750>>>>>        Set Field_Options          Field Bmove.Bmove_Aa           To DD_DISPLAYONLY
43751>>>>>
43751>>>>>        // Bmove.Baxio_Aa
43751>>>>>        Set Field_Options          Field Bmove.Baxio_Aa           To DD_DISPLAYONLY
43752>>>>>
43752>>>>>        // Bmove.Gplan_Srec0
43752>>>>>        Set Field_Options          Field Bmove.Gplan_Srec0        To DD_DISPLAYONLY
43753>>>>>
43753>>>>>        // Bmove.Baxio_Pfile
43753>>>>>
43753>>>>>        // Bmove.Baxio_Pcode
43753>>>>>
43753>>>>>        // Bmove.Baxio_Pepon
43753>>>>>
43753>>>>>        // Bmove.Baxio_Ppar
43753>>>>>
43753>>>>>    End_Procedure    // Define_Fields
43754>>>>>
43754>>>>>
43754>>>>>    Procedure Field_Defaults
43755>>>>>        Forward Send Field_Defaults
43757>>>>>        //DDB-Generated-Code-Location
43757>>>>>        //DDB-FieldDefaultStart
43757>>>>>        //DDB-FieldDefaultEnd
43757>>>>>    End_Procedure    // Field_Defaults
43758>>>>>
43758>>>>>End_Class    // Bmove_DataDictionary
43759>>>>>//DDB-FileEnd
43759>>>    
43759>>>    //AB-IgnoreEnd
43759>>>
43759>>>    ACTIVATE_VIEW Activate_VW037 FOR VW037
43763>>>
43763>>>    Object VW037 is a dbViewSub
43765>>>
43765>>>        //AB-StoreTopStart
43765>>>                                
43765>>>        //AB-StoreTopEnd
43765>>>
43765>>>        Set Label to "V037:€¥ æš¨˜­˜"
43766>>>        Set Size to 278 515
43767>>>        Set Location to 0 5
43768>>>
43768>>>        //AB-DDOStart
43768>>>
43768>>>        Object Btypkin_DD is a Btypkin_DataDictionary
43770>>>
43770>>>            //AB-StoreStart
43770>>>                                                                                                                                                                                
43770>>>            Set Field_Prompt_Object Field Btypkin.Btypkin_Code to None
43771>>>            
43771>>>            
43771>>>            
43771>>>            //AB-StoreEnd
43771>>>
43771>>>        End_Object    // Btypkin_DD
43772>>>
43772>>>        Object Baxiokat_DD is a Baxiokat_DataDictionary
43774>>>
43774>>>            //AB-StoreStart
43774>>>                                                                                                                                                                                
43774>>>            Set Field_Options Field Baxiokat.Baxiokat_Code  to DD_Clear_Field_Options DD_Required
43775>>>            
43775>>>            Set Foreign_Field_Options DD_IndexField         to DD_Clear_Field_Options DD_FindReq
43776>>>            Set Foreign_Field_Options DD_KeyField           to DD_Clear_Field_Options DD_FindReq
43777>>>            
43777>>>            
43777>>>            //AB-StoreEnd
43777>>>
43777>>>        End_Object    // Baxiokat_DD
43778>>>
43778>>>        Object Barticl_DD is a Barticl_DataDictionary
43780>>>            Set DDO_Server to (Btypkin_DD(self))
43781>>>
43781>>>            //AB-StoreStart
43781>>>                                                                                                                                                                                
43781>>>            Set Field_Prompt_Object Field Barticl.Barticl_Hmnia to None
43782>>>            Set Field_Prompt_Object Field Barticl.Barticl_No    to None
43783>>>            
43783>>>            //AB-StoreEnd
43783>>>
43783>>>        End_Object    // Barticl_DD
43784>>>
43784>>>        Object Baxio_DD is a Baxio_DataDictionary
43786>>>            Set DDO_Server to (Baxiokat_DD(self))
43787>>>
43787>>>            //AB-StoreStart
43787>>>            set pimustnotconstrain to 2
43788>>>            Function Validate_Save Returns Integer
43790>>>                Integer rVal
43791>>>                Forward Get Validate_Save to rVal
43793>>>                If (Not(rval)) If (Not(Current_Record(Self))) Move 1 to rVal
43798>>>                Function_Return rVal
43799>>>            End_Procedure // Validate_Save
43800>>>            
43800>>>            
43800>>>            // AYTA ENERGOPOIOYNTAI MONO GIA KOZANH KAI APENERGOPOIOYME THN
43800>>>            // VALIDATE_SAVE APO PANO
43800>>>            // GIA NA MPORESEI NA DIAGRAPSEI 2PLO PERASMENA SOMATA
43800>>>            // APO 2PLH METAFORA AXIOGRAFON STHN ALLAGH THS XRHSHS
43800>>>            //Function Validate_Delete  Returns Integer
43800>>>            //       Integer iReturnVal
43800>>>            //       Function_Return iReturnVal
43800>>>            //End_Function //validate_delete
43800>>>            
43800>>>            //Procedure Request_Save
43800>>>            //End_Procedure
43800>>>            
43800>>>            
43800>>>            
43800>>>            
43800>>>            
43800>>>            
43800>>>            
43800>>>            //AB-StoreEnd
43800>>>
43800>>>        End_Object    // Baxio_DD
43801>>>
43801>>>        Object Syscurxr_DD is a Syscurxr_DataDictionary
43803>>>        End_Object    // Syscurxr_DD
43804>>>
43804>>>        Object Bmove_DD is a Bmove_DataDictionary
43806>>>            Set DDO_Server to (Barticl_DD(self))
43807>>>            Set DDO_Server to (Baxio_DD(self))
43808>>>            Set Constrain_File to Baxio.File_Number
43809>>>
43809>>>            //AB-StoreStart
43809>>>            set pimustnotconstrain to 2
43810>>>            Set Ordering to 4
43811>>>            
43811>>>            Function Validate_Save Returns Integer
43813>>>                Function_Return 1
43814>>>            End_Procedure // Validate_Save
43815>>>            
43815>>>            Function Validate_Delete  Returns Integer
43817>>>                Function_Return 1
43818>>>            End_Function // Validate_Delete
43819>>>            
43819>>>            
43819>>>            
43819>>>            
43819>>>            
43819>>>            
43819>>>            //AB-StoreEnd
43819>>>
43819>>>        End_Object    // Bmove_DD
43820>>>
43820>>>        Set Main_DD to (Baxio_DD(self))
43821>>>        Set Server to (Baxio_DD(self))
43822>>>
43822>>>        //AB-DDOEnd
43822>>>
43822>>>        Object Baxiokat_Baxiokat_Code is a dbFormSub
43824>>>            Entry_Item Baxiokat.Baxiokat_code
43825>>>            Set Size to 13 42
43826>>>            Set Location to 36 41
43827>>>            Set Label_Col_Offset to 35
43828>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
43829>>>        End_Object    // Baxiokat_Baxiokat_Code
43830>>>
43830>>>        Object Baxiokat_Baxiokat_Descr is a dbFormSub
43832>>>            Entry_Item Baxiokat.Baxiokat_descr
43833>>>            Set Size to 13 182
43834>>>            Set Location to 36 86
43835>>>            Set Label_Col_Offset to 2
43836>>>            Set Label_Justification_Mode to jMode_Right
43837>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
43838>>>        End_Object    // Baxiokat_Baxiokat_Descr
43839>>>
43839>>>        Object Baxio_Baxio_Code is a dbFormSub
43841>>>            Entry_Item Baxio.Baxio_code
43842>>>            Set Size to 13 116
43843>>>            Set Location to 50 41
43844>>>            Set Label_Col_Offset to 35
43845>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
43846>>>
43846>>>            //AB-StoreStart
43846>>>                                                                                                                                                                                
43846>>>            Procedure Prompt_Callback Integer hPrompt
43848>>>                Integer liBaxiokatCode
43849>>>                Get Field_Current_Value of Baxiokat_DD Field Baxiokat.Baxiokat_Code to liBaxiokatCode
43850>>>                Set piFragmaBaxiokatCode of hPrompt to liBaxiokatCode
43851>>>                Set Auto_Index_State of hPrompt to False
43852>>>            End_Procedure // Prompt_Callback
43853>>>            
43853>>>            
43853>>>            
43853>>>            
43853>>>            
43853>>>            
43853>>>            //AB-StoreEnd
43853>>>
43853>>>        End_Object    // Baxio_Baxio_Code
43854>>>
43854>>>        Object Baxio_Baxio_Status is a dbFormSub
43856>>>
43856>>>            //AB-StoreTopStart
43856>>>                                                                                                                                                                                
43856>>>            Function Show_Status_Descr Returns String
43858>>>                Integer iValue iSrv iField iObj liStatusId
43859>>>                String sDesc sVal
43859>>>                If (Current_Record(Baxio_DD(Self))) Begin
43861>>>                    Get Server of Baxio_Baxio_Status to iSrv
43862>>>                    Get_FieldNumber Baxio.Baxio_Status to iField
43863>>>                    Get Field_Current_Value of iSrv Field Baxio.Baxio_Status to sVal
43864>>>                    Move Baxio_Status_VT to iObj
43865>>>                    If (iObj) get Find_Code_Description of iObj sVal to sDesc
43868>>>                    Function_Return sDesc
43869>>>                End
43869>>>>
43869>>>            End_Function // Show_Status_Descr
43870>>>            
43870>>>            //AB-StoreTopEnd
43870>>>
43870>>>            Entry_Item (Show_Status_Descr(Self))
43871>>>            Set Size to 13 116
43872>>>            Set Location to 36 340
43873>>>            Set Label_Col_Offset to 50
43874>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
43875>>>
43875>>>            //AB-StoreStart
43875>>>                                                                                                                                                                                
43875>>>                                                                                                                                                                                
43875>>>            //AB-StoreEnd
43875>>>
43875>>>        End_Object    // Baxio_Baxio_Status
43876>>>
43876>>>        Object Baxio_Baxio_Place is a dbFormSub
43878>>>
43878>>>            //AB-StoreTopStart
43878>>>                                                                                                                                                                                
43878>>>            Function Show_Place_Descr Returns String
43880>>>                Integer iValue iSrv iField iObj liStatusId
43881>>>                String sDesc sVal
43881>>>                If (Current_Record(Baxio_DD(Self))) Begin
43883>>>                    Get Server of Baxio_Baxio_Place to iSrv
43884>>>                    Get_FieldNumber Baxio.Baxio_Place to iField
43885>>>                    Get Field_Current_Value of iSrv Field Baxio.Baxio_Place to sVal
43886>>>                    Move Baxio_Baxio_Place_VT to iObj
43887>>>                    If (iObj) get Find_Code_Description of iObj sVal to sDesc
43890>>>                    Function_Return sDesc
43891>>>                End
43891>>>>
43891>>>            End_Function // Show_Place_Descr
43892>>>            
43892>>>            //AB-StoreTopEnd
43892>>>
43892>>>            Entry_Item (Show_Place_Descr(Self))
43893>>>            Set Size to 13 116
43894>>>            Set Location to 50 340
43895>>>            Set Label_Col_Offset to 50
43896>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
43897>>>
43897>>>            //AB-StoreStart
43897>>>                                                                                                                                                                                
43897>>>                                                                                                                                                                                
43897>>>                                                                                                                                                                                
43897>>>                                                                                                                                                                                
43897>>>                                                                                                                                                                                
43897>>>                                                                                                                                                                                
43897>>>            //AB-StoreEnd
43897>>>
43897>>>        End_Object    // Baxio_Baxio_Place
43898>>>
43898>>>        Object dbTbDlgAxio is a dbTabDialogSub
43900>>>            Set Size to 191 507
43901>>>            Set Location to 70 2
43902>>>            Object TP_Additional is a dbTabPage
43904>>>                Set Label to "¨æ©Ÿœ«˜"
43905>>>                Object dbGrpObligate is a dbGroupSub
43907>>>                    Set Label to "“§¦®¨œà« ¡á ‘«¦ ®œå˜"
43908>>>                    Set Size to 60 492
43909>>>                    Set Location to 3 4
43910>>>                    Set TextColor to clNavy
43911>>>                    Object Baxio_Baxio_Hmnial is a dbFormSub
43913>>>                        Entry_Item Baxio.Baxio_hmnial
43914>>>                        Set Size to 13 66
43915>>>                        Set Location to 10 82
43916>>>                        Set Label_Col_Offset to 70
43917>>>                        Set Form_TypeFace Item 0 to "MS Sans Serif"
43918>>>                    End_Object    // Baxio_Baxio_Hmnial
43919>>>
43919>>>                    Object Baxio_Baxio_V4 is a dbFormSub
43921>>>                        Entry_Item Baxio.Baxio_v2
43922>>>                        Set Size to 13 66
43923>>>                        Set Location to 40 82
43924>>>                        Set Label_Col_Offset to 70
43925>>>                        Set Form_TypeFace Item 0 to "MS Sans Serif"
43926>>>
43926>>>                        //AB-StoreStart
43926>>>                                                                                                                                                                                                                                                                                                                                                                                            
43926>>>                        //Set Points Item 0 to 0
43926>>>                        //Set Numeric_Mask Item 0 to 14  0 ' ,*'
43926>>>                        
43926>>>                        Procedure End_Construct_Object
43928>>>                            Integer iDecimals
43929>>>                            Forward Send End_Construct_Object
43931>>>                            Get fiDekadika_Nomismatos  SysCurXr.C_Code0  to    iDecimals
43932>>>                            Set Points Item 0 to iDecimals
43933>>>                            Set Numeric_Mask Item 0 to 14 iDecimals ' ,*'
43934>>>                        End_Procedure
43935>>>                        
43935>>>                        
43935>>>                        //AB-StoreEnd
43935>>>
43935>>>                    End_Object    // Baxio_Baxio_V4
43936>>>
43936>>>                    Object Rate0 is a dbFormSub
43938>>>                        Entry_Item Baxio.Baxio_rate0
43939>>>                        Set Size to 13 46
43940>>>                        Set Location to 11 440
43941>>>                        Set Label_Col_Offset to 35
43942>>>                        Set Form_TypeFace Item 0 to "MS Sans Serif"
43943>>>
43943>>>                        //AB-StoreStart
43943>>>                                                                                                                                                                                                                                                                                                                                                                                            
43943>>>                        Set Points Item 0 to 0
43944>>>                        Set Visible_State to False
43945>>>                        Set Enabled_State to False
43946>>>                        
43946>>>                        
43946>>>                        
43946>>>                        //AB-StoreEnd
43946>>>
43946>>>                    End_Object    // Rate0
43947>>>
43947>>>                    Object Rate00 is a dbFormSub
43949>>>                        Entry_Item Baxio.Baxio_rate00
43950>>>                        Set Size to 13 46
43951>>>                        Set Location to 26 440
43952>>>                        Set Label_Col_Offset to 35
43953>>>                        Set Form_TypeFace Item 0 to "MS Sans Serif"
43954>>>
43954>>>                        //AB-StoreStart
43954>>>                                                                                                                                                                                                                                                                                                                                                                                            
43954>>>                        Set Points Item 0 to 2
43955>>>                        Set Visible_State to False
43956>>>                        Set Enabled_State to False
43957>>>                        
43957>>>                        //AB-StoreEnd
43957>>>
43957>>>                    End_Object    // Rate00
43958>>>
43958>>>                    Object RateR is a dbFormSub
43960>>>                        Entry_Item Baxio.Baxio_rater
43961>>>                        Set Size to 13 46
43962>>>                        Set Location to 41 440
43963>>>                        Set Label_Col_Offset to 35
43964>>>                        Set Form_TypeFace Item 0 to "MS Sans Serif"
43965>>>
43965>>>                        //AB-StoreStart
43965>>>                                                                                                                                                                                                                                                                                                                                                                                            
43965>>>                        Set Points Item 0 to 2
43966>>>                        Set Visible_State to False
43967>>>                        Set Enabled_State to False
43968>>>                        
43968>>>                        
43968>>>                        //AB-StoreEnd
43968>>>
43968>>>                    End_Object    // RateR
43969>>>
43969>>>                    Object TextBoxSub3 is a TextBoxSub
43971>>>                        Set Label to "†£/¤å˜ Šã¥žª"
43972>>>                        Set Location to 11 18
43973>>>                        Set Size to 10 57
43974>>>                        Set TypeFace to "MS Sans Serif"
43975>>>                    End_Object    // TextBoxSub3
43976>>>
43976>>>                    Object TextBoxSub4 is a TextBoxSub
43978>>>                        Set Label to "Œæ£ ©£˜"
43979>>>                        Set Location to 24 18
43980>>>                        Set Size to 10 32
43981>>>                        Set TypeFace to "MS Sans Serif"
43982>>>                    End_Object    // TextBoxSub4
43983>>>
43983>>>                    Object TextBoxSub5 is a TextBoxSub
43985>>>                        Set Label to "¦©æ"
43986>>>                        Set Location to 39 18
43987>>>                        Set Size to 10 32
43988>>>                        Set TypeFace to "MS Sans Serif"
43989>>>                    End_Object    // TextBoxSub5
43990>>>
43990>>>                    Object txtnom1 is a TextBoxSub
43992>>>                        Set Label to "ˆ©¦« £å˜1"
43993>>>                        Set Location to 13 405
43994>>>                        Set Size to 10 31
43995>>>                        Set TypeFace to "MS Sans Serif"
43996>>>
43996>>>                        //AB-StoreStart
43996>>>                        Set Visible_State to False
43997>>>                        
43997>>>                        //AB-StoreEnd
43997>>>
43997>>>                    End_Object    // txtnom1
43998>>>
43998>>>                    Object txtnom2 is a TextBoxSub
44000>>>                        Set Label to "ˆ©¦« £å˜2"
44001>>>                        Set Location to 28 405
44002>>>                        Set Size to 10 31
44003>>>                        Set TypeFace to "MS Sans Serif"
44004>>>
44004>>>                        //AB-StoreStart
44004>>>                        Set Visible_State to False
44005>>>                        
44005>>>                        //AB-StoreEnd
44005>>>
44005>>>                    End_Object    // txtnom2
44006>>>
44006>>>                    Object txtnom3 is a TextBoxSub
44008>>>                        Set Label to "ˆ©¦« £å˜3"
44009>>>                        Set Location to 43 405
44010>>>                        Set Size to 10 31
44011>>>                        Set TypeFace to "MS Sans Serif"
44012>>>
44012>>>                        //AB-StoreStart
44012>>>                        Set Visible_State to False
44013>>>                        
44013>>>                        //AB-StoreEnd
44013>>>
44013>>>                    End_Object    // txtnom3
44014>>>
44014>>>                    Object Baxio_Baxio_C_Code2 is a dbFormSub
44016>>>
44016>>>                        //AB-StoreTopStart
44016>>>                        //Procedure Set_The_Decimal_Points
44016>>>                        //    Integer iContID
44016>>>                        //    String  sCode sPartlRecr
44016>>>                        //    date    dHmnia
44016>>>                        
44016>>>                        //    Move (dbGrpObligate(TP_Additional(dbtbDlgAxio(Self)))) to iContID
44016>>>                        
44016>>>                        //    Get Field_Current_Value Of Baxio_DD Field Baxio.Baxio_Sc_Code2 to sCode
44016>>>                        //    Move (Trim(sCode))  to sCode
44016>>>                        
44016>>>                        //    Clear Nomisma
44016>>>                        //    Move sCode to Nomisma.Nomisma_Code
44016>>>                        //    Find eq Nomisma by Index.1
44016>>>                        //    Set Points          Of (Axia(iContID)) Item  0 to Nomisma.Dekadika
44016>>>                        //    Set Numeric_Mask    Of (Axia(iContID)) Item  0 to 12 Nomisma.Dekadika "*,"
44016>>>                        
44016>>>                        //    Get Label Of (TxtNom1(iContID)) Item 0 to sCode
44016>>>                        //    Move (Trim(sCode))  to sCode
44016>>>                        //    Clear Nomisma
44016>>>                        //    Move sCode to Nomisma.Nomisma_Code
44016>>>                        //    Find eq Nomisma by Index.1
44016>>>                        //    Set Points          Of (X0(iContID)) Item  0 to Nomisma.Dekadika
44016>>>                        //    Set Points          Of (P0(iContID)) Item  0 to Nomisma.Dekadika
44016>>>                        //    Set Numeric_Mask Of (X0(iContID))          Item  0  to 12 Nomisma.Dekadika "*,"
44016>>>                        //    Set Numeric_Mask Of (P0(iContID))          Item  0  to 12 Nomisma.Dekadika "*,"
44016>>>                        
44016>>>                        //    Get Label Of (TxtNom2(iContID)) Item 0 to sCode
44016>>>                        //    Move (Trim(sCode))  to sCode
44016>>>                        //    Clear Nomisma
44016>>>                        //    Move sCode to Nomisma.Nomisma_Code
44016>>>                        //    Find eq Nomisma by Index.1
44016>>>                        //    Set Points          Of (X00(iContID)) Item  0 to Nomisma.Dekadika
44016>>>                        //    Set Numeric_Mask Of (X00(iContID))         Item  0  to 12 Nomisma.Dekadika "*,"
44016>>>                        //    Set Points          Of (P00(iContID)) Item  0 to Nomisma.Dekadika
44016>>>                        //    Set Numeric_Mask Of (P00(iContID))         Item  0  to 12 Nomisma.Dekadika "*,"
44016>>>                        
44016>>>                        //    Get Label Of (TxtNom3(iContID)) Item 0 to sCode
44016>>>                        //    Move (Trim(sCode))  to sCode
44016>>>                        //    Clear Nomisma
44016>>>                        //    Move sCode to Nomisma.Nomisma_Code
44016>>>                        //    Find eq Nomisma by Index.1
44016>>>                        //    Set Points          Of (X1(iContID)) Item  0 to     Nomisma.Dekadika
44016>>>                        //    Set Numeric_Mask Of (X1(iContID))    Item  0 to 12  Nomisma.Dekadika "*,"
44016>>>                        //    Set Points          Of (P1(iContID)) Item  0 to     Nomisma.Dekadika
44016>>>                        //    Set Numeric_Mask Of (P1(iContID))    Item  0 to 12  Nomisma.Dekadika "*,"
44016>>>                        //End_procedure
44016>>>                        
44016>>>                        
44016>>>                        //AB-StoreTopEnd
44016>>>
44016>>>                        Entry_Item Baxio.Baxio_c_code2
44017>>>                        Set Size to 13 66
44018>>>                        Set Location to 25 82
44019>>>                        Set Label_Col_Offset to 2
44020>>>                        Set Label_Justification_Mode to jMode_Right
44021>>>                        Set Prompt_Button_Mode to pb_PromptOff
44022>>>                        Set Form_TypeFace Item 0 to "MS Sans Serif"
44023>>>
44023>>>                        //AB-StoreStart
44023>>>                                                                                                                                                                                                                                                                                                                                                                                            
44023>>>                        //Procedure OnChange
44023>>>                        //    Send Set_The_Decimal_Points
44023>>>                        //End_Procedure
44023>>>                        
44023>>>                        
44023>>>                        //AB-StoreEnd
44023>>>
44023>>>                    End_Object    // Baxio_Baxio_C_Code2
44024>>>
44024>>>                End_Object    // dbGrpObligate
44025>>>
44025>>>                Object dbGrpOptional is a dbGroupSub
44027>>>                    Set Label to "¨¦˜ ¨œ« ¡á ‘«¦ ®œå˜"
44028>>>                    Set Size to 106 492
44029>>>                    Set Location to 65 4
44030>>>                    Set TextColor to clNavy
44031>>>                    Object Baxio_Baxio_Ekdoths is a dbFormSub
44033>>>                        Entry_Item Baxio.Baxio_ekdoths
44034>>>                        Set Size to 13 126
44035>>>                        Set Location to 10 81
44036>>>                        Set Label_Col_Offset to 70
44037>>>                        Set Form_TypeFace Item 0 to "MS Sans Serif"
44038>>>                    End_Object    // Baxio_Baxio_Ekdoths
44039>>>
44039>>>                    Object Baxio_Baxio_Ekdothse is a dbFormSub
44041>>>                        Entry_Item Baxio.Baxio_ekdothse
44042>>>                        Set Size to 13 208
44043>>>                        Set Location to 10 264
44044>>>                        Set Label_Col_Offset to 35
44045>>>                        Set Form_TypeFace Item 0 to "MS Sans Serif"
44046>>>                    End_Object    // Baxio_Baxio_Ekdothse
44047>>>
44047>>>                    Object Baxio_Baxio_Sediatagh is a dbFormSub
44049>>>                        Entry_Item Baxio.Baxio_sediatagh
44050>>>                        Set Size to 13 126
44051>>>                        Set Location to 26 81
44052>>>                        Set Label_Col_Offset to 70
44053>>>                        Set Form_TypeFace Item 0 to "MS Sans Serif"
44054>>>                    End_Object    // Baxio_Baxio_Sediatagh
44055>>>
44055>>>                    Object Baxio_Baxio_Sdiataghe is a dbFormSub
44057>>>                        Entry_Item Baxio.Baxio_sdiataghe
44058>>>                        Set Size to 13 208
44059>>>                        Set Location to 26 264
44060>>>                        Set Label_Col_Offset to 35
44061>>>                        Set Form_TypeFace Item 0 to "MS Sans Serif"
44062>>>                    End_Object    // Baxio_Baxio_Sdiataghe
44063>>>
44063>>>                    Object Baxio_Baxio_Banka is a dbComboFormSub
44065>>>                        Entry_Item Baxio.Baxio_banka
44066>>>                        Set Size to 13 126
44067>>>                        Set Location to 40 81
44068>>>                        Set Label_Col_Offset to 70
44069>>>                    End_Object    // Baxio_Baxio_Banka
44070>>>
44070>>>                    Object Baxio_Baxio_No is a dbFormSub
44072>>>                        Entry_Item Baxio.Baxio_no
44073>>>                        Set Size to 13 126
44074>>>                        Set Location to 55 81
44075>>>                        Set Label_Col_Offset to 70
44076>>>                        Set Form_TypeFace Item 0 to "MS Sans Serif"
44077>>>                    End_Object    // Baxio_Baxio_No
44078>>>
44078>>>                    Object Baxio_Baxio_From is a dbComboFormSub
44080>>>                        Entry_Item Baxio.Baxio_from
44081>>>                        Set Size to 13 54
44082>>>                        Set Location to 70 81
44083>>>                        Set Label_Col_Offset to 2
44084>>>
44084>>>                        //AB-StoreStart
44084>>>                                                                                                                                                                                                    
44084>>>                        Procedure Combo_Fill_List
44086>>>                            Send Combo_Add_Item  "ˆ›å¦¬" "0"
44087>>>                            Send Combo_Add_Item  "’¨å«¦¬" "1"
44088>>>                        End_Procedure
44089>>>                        
44089>>>                        
44089>>>                        
44089>>>                        
44089>>>                        
44089>>>                        
44089>>>                        //AB-StoreEnd
44089>>>
44089>>>                    End_Object    // Baxio_Baxio_From
44090>>>
44090>>>                    Object Baxio_Baxio_Topos is a dbComboFormSub
44092>>>                        Entry_Item Baxio.Baxio_topos
44093>>>                        Set Size to 13 54
44094>>>                        Set Location to 84 81
44095>>>                        Set Label_Col_Offset to 2
44096>>>
44096>>>                        //AB-StoreStart
44096>>>                        Procedure Combo_Fill_List
44098>>>                            Send Combo_Add_Item  "€«« ¡ãª" "0"
44099>>>                            Send Combo_Add_Item  "„§˜¨®å˜ª" "1"
44100>>>                        End_Procedure
44101>>>                        
44101>>>                        
44101>>>                        
44101>>>                        
44101>>>                        
44101>>>                        
44101>>>                        //AB-StoreEnd
44101>>>
44101>>>                    End_Object    // Baxio_Baxio_Topos
44102>>>
44102>>>                    Object Baxio_Baxio_Opistho is a dbEditSub
44104>>>                        Entry_Item Baxio.Baxio_opistho
44105>>>                        Set Size to 48 211
44106>>>                        Set Location to 50 263
44107>>>                    End_Object    // Baxio_Baxio_Opistho
44108>>>
44108>>>                    Object TextBoxSub6 is a TextBoxSub
44110>>>                        Set Label to "€¨® ¡æª „¡›æ«žª:"
44111>>>                        Set Location to 11 10
44112>>>                        Set Size to 10 63
44113>>>                        Set TypeFace to "MS Sans Serif"
44114>>>                    End_Object    // TextBoxSub6
44115>>>
44115>>>                    Object TextBoxSub7 is a TextBoxSub
44117>>>                        Set Label to "‘œ ƒ ˜«˜šã:"
44118>>>                        Set Location to 25 10
44119>>>                        Set Size to 10 56
44120>>>                        Set TypeFace to "MS Sans Serif"
44121>>>                    End_Object    // TextBoxSub7
44122>>>
44122>>>                    Object TextBoxSub8 is a TextBoxSub
44124>>>                        Set Label to "’¨á§œ˜"
44125>>>                        Set Location to 40 10
44126>>>                        Set Size to 10 35
44127>>>                        Set TypeFace to "MS Sans Serif"
44128>>>                    End_Object    // TextBoxSub8
44129>>>
44129>>>                    Object TextBoxSub9 is a TextBoxSub
44131>>>                        Set Label to "€¨ Ÿ£æª"
44132>>>                        Set Location to 55 10
44133>>>                        Set Size to 10 47
44134>>>                        Set TypeFace to "MS Sans Serif"
44135>>>                    End_Object    // TextBoxSub9
44136>>>
44136>>>                    Object TextBoxSub10 is a TextBoxSub
44138>>>                        Set Label to "„§à¤¬£å˜"
44139>>>                        Set Location to 12 224
44140>>>                        Set Size to 10 36
44141>>>                        Set TypeFace to "MS Sans Serif"
44142>>>                    End_Object    // TextBoxSub10
44143>>>
44143>>>                    Object TextBoxSub11 is a TextBoxSub
44145>>>                        Set Label to "„§à¤¬£å˜"
44146>>>                        Set Location to 28 224
44147>>>                        Set Size to 10 36
44148>>>                        Set TypeFace to "MS Sans Serif"
44149>>>                    End_Object    // TextBoxSub11
44150>>>
44150>>>                    Object TextBoxSub12 is a TextBoxSub
44152>>>                        Set Label to "Š¦ §¦å Ž§ ©Ÿ¦š¨á­¦ "
44153>>>                        Set Location to 41 265
44154>>>                        Set Size to 10 79
44155>>>                        Set TypeFace to "MS Sans Serif"
44156>>>                    End_Object    // TextBoxSub12
44157>>>
44157>>>                    Object Textbox3 is a Textbox
44159>>>                        Set Label to "ˆ›å¦¬/’¨å«¦¬"
44160>>>                        Set Location to 71 10
44161>>>                        Set Size to 10 46
44162>>>                        Set TypeFace to "MS Sans Serif"
44163>>>                    End_Object    // Textbox3
44164>>>
44164>>>                    Object Textbox4 is a Textbox
44166>>>                        Set Label to "€«« ¡ãª/„§˜¨®å˜ª"
44167>>>                        Set Location to 86 10
44168>>>                        Set Size to 10 63
44169>>>                        Set TypeFace to "MS Sans Serif"
44170>>>                    End_Object    // Textbox4
44171>>>
44171>>>                End_Object    // dbGrpOptional
44172>>>
44172>>>
44172>>>                //AB-StoreStart
44172>>>                set label to "‘«â¢œ®¦ª/‘é£˜ €¥ ¦š¨á­¦¬"
44173>>>                
44173>>>                //AB-StoreEnd
44173>>>
44173>>>            End_Object    // TP_Additional
44174>>>
44174>>>            Object TP_Status is a dbTabPage
44176>>>                Set Label to "‰˜«á©«˜©ž"
44177>>>                Object dbGrpEispraktea is a dbGroupSub
44179>>>                    Set Label to "„ ©§¨˜¡«â˜"
44180>>>                    Set Size to 44 493
44181>>>                    Set Location to 4 3
44182>>>                    Set TextColor to clNavy
44183>>>                    Object Baxio_Baxio_Fbarticl is a dbFormSub
44185>>>
44185>>>                        //AB-StoreTopStart
44185>>>                        Procedure Find_Barticls
44187>>>                            Integer liBarticlRec0 liWhichBarticl
44188>>>                            Date ldHmnia
44188>>>                            String liNo liBtypkin
44188>>>                        
44188>>>                            Move Barticl.Barticl_Rec0 to liBarticlRec0
44189>>>                        
44189>>>                            Get Field_Current_Value of Baxio_DD Field Baxio.Baxio_Fpar_In to liWhichBarticl
44190>>>                            If (liWhichBarticl <> 0) Begin
44192>>>                                Clear Barticl
44193>>>                                Move liWhichBarticl to Barticl.Barticl_Rec0
44194>>>                                Find eq Barticl by Index.2
44195>>>>
44195>>>                                [Found] Begin
44197>>>>
44197>>>                                    Move Barticl.Barticl_Hmnia   to ldHmnia
44198>>>                                    Move Barticl.Barticl_No      to liNo
44199>>>                                    Move Barticl.Btypkin_Code    to liBtypkin
44200>>>                                End
44200>>>>
44200>>>                            End
44200>>>>
44200>>>                            Set Value of dbfrmHmnia   Item 0 to ldHmnia
44201>>>                            Set Value of dbfrmNo      Item 0 to liNo
44202>>>                            Set Value of dbfrmGtypkin Item 0 to liBtypkin
44203>>>                        
44203>>>                            Move "" to ldHmnia
44204>>>                            Move "" to liNo
44205>>>                            Move "" to liBtypkin
44206>>>                        
44206>>>                            Get Field_Current_Value of Baxio_DD Field Baxio.Baxio_Fpar_Out to liWhichBarticl
44207>>>                            If (liWhichBarticl <> 0) Begin
44209>>>                                Clear Barticl
44210>>>                                Move liWhichBarticl to Barticl.Barticl_Rec0
44211>>>                                Find eq Barticl by Index.2
44212>>>>
44212>>>                                [Found] Begin
44214>>>>
44214>>>                                    Move Barticl.Barticl_Hmnia   to ldHmnia
44215>>>                                    Move Barticl.Barticl_No      to liNo
44216>>>                                    Move Barticl.Btypkin_Code    to liBtypkin
44217>>>                                End
44217>>>>
44217>>>                            End
44217>>>>
44217>>>                            Set Value of (dbfrmHmnia(dbGrpPlhrotea(Self)))   Item 0 to ldHmnia
44218>>>                            Set Value of (dbfrmNo(dbGrpPlhrotea(Self)))      Item 0 to liNo
44219>>>                            Set Value of (dbfrmGtypkin(dbGrpPlhrotea(Self))) Item 0 to liBtypkin
44220>>>                        
44220>>>                            Move "" to ldHmnia
44221>>>                            Move "" to liNo
44222>>>                            Move "" to liBtypkin
44223>>>                        
44223>>>                            Get Field_Current_Value of Baxio_DD Field Baxio.Baxio_Lpar to liWhichBarticl
44224>>>                            If (liWhichBarticl <> 0) Begin
44226>>>                                Clear Barticl
44227>>>                                Move liWhichBarticl to Barticl.Barticl_Rec0
44228>>>                                Find eq Barticl by Index.2
44229>>>>
44229>>>                                [Found] Begin
44231>>>>
44231>>>                                    Move Barticl.Barticl_Hmnia   to ldHmnia
44232>>>                                    Move Barticl.Barticl_No      to liNo
44233>>>                                    Move Barticl.Btypkin_Code    to liBtypkin
44234>>>                                End
44234>>>>
44234>>>                            End
44234>>>>
44234>>>                            Set Value of (dbfrmHmnia(dbGrpCurrentStat(Self)))   Item 0 to ldHmnia
44235>>>                            Set Value of (dbfrmNo(dbGrpCurrentStat(Self)))      Item 0 to liNo
44236>>>                            Set Value of (dbfrmGtypkin(dbGrpCurrentStat(Self))) Item 0 to liBtypkin
44237>>>                        
44237>>>                            Clear Barticl
44238>>>                            Move liBarticlRec0 to Barticl.Barticl_Rec0
44239>>>                            Find eq Barticl by Index.2
44240>>>>
44240>>>                        End_Procedure
44241>>>                        
44241>>>                        //AB-StoreTopEnd
44241>>>
44241>>>                        Entry_Item Baxio.Baxio_fpar_in
44242>>>                        Set Size to 13 90
44243>>>                        Set Location to 10 109
44244>>>                        Set Label_Col_Offset to 90
44245>>>                        Set Form_TypeFace Item 0 to "MS Sans Serif"
44246>>>
44246>>>                        //AB-StoreStart
44246>>>                                                                                                                                                                                                                                                                                                                                                                                            
44246>>>                        Procedure Refresh Integer iMode
44248>>>                            Forward Send Refresh iMode
44250>>>                            Send Find_Barticls
44251>>>                        End_Procedure // Refresh
44252>>>                        
44252>>>                        
44252>>>                        
44252>>>                        
44252>>>                        
44252>>>                        //AB-StoreEnd
44252>>>
44252>>>                    End_Object    // Baxio_Baxio_Fbarticl
44253>>>
44253>>>                    Object Baxio_Baxio_Code_In is a dbFormSub
44255>>>                        Entry_Item Baxio.Baxio_code_in
44256>>>                        Set Size to 13 126
44257>>>                        Set Location to 24 109
44258>>>                        Set Label_Col_Offset to 90
44259>>>                        Set Form_TypeFace Item 0 to "MS Sans Serif"
44260>>>                    End_Object    // Baxio_Baxio_Code_In
44261>>>
44261>>>                    Object Baxio_Baxio_Epon_In is a dbFormSub
44263>>>                        Entry_Item Baxio.Baxio_epon_in
44264>>>                        Set Size to 13 192
44265>>>                        Set Location to 24 283
44266>>>                        Set Color to clBtnFace
44267>>>                        Set Label_Col_Offset to 40
44268>>>                        Set Enabled_State to FALSE
44269>>>                        Set Form_TypeFace Item 0 to "MS Sans Serif"
44270>>>                        Set Item_Shadow_State Item 0 to TRUE
44271>>>                        Set Shadow_State Item 0 to TRUE
44272>>>                    End_Object    // Baxio_Baxio_Epon_In
44273>>>
44273>>>                    Object dbFrmHmnia is a dbFormSub
44275>>>                        Set Size to 13 65
44276>>>                        Set Location to 10 231
44277>>>                        Set Color to clBtnFace
44278>>>                        Set Label_Col_Offset to 2
44279>>>                        Set Label_Justification_Mode to jMode_Right
44280>>>                        Set Enabled_State to FALSE
44281>>>                        Set Form_TypeFace Item 0 to "MS Sans Serif"
44282>>>                        Set Item_Shadow_State Item 0 to TRUE
44283>>>                        Set Shadow_State Item 0 to TRUE
44284>>>                    End_Object    // dbFrmHmnia
44285>>>
44285>>>                    Object dbFrmNo is a dbFormSub
44287>>>                        Set Size to 13 65
44288>>>                        Set Location to 10 318
44289>>>                        Set Color to clBtnFace
44290>>>                        Set Label_Col_Offset to 2
44291>>>                        Set Label_Justification_Mode to jMode_Right
44292>>>                        Set Enabled_State to FALSE
44293>>>                        Set Form_TypeFace Item 0 to "MS Sans Serif"
44294>>>                        Set Item_Shadow_State Item 0 to TRUE
44295>>>                        Set Shadow_State Item 0 to TRUE
44296>>>                    End_Object    // dbFrmNo
44297>>>
44297>>>                    Object dbFrmGtypkin is a dbFormSub
44299>>>                        Set Label to "‰å¤ž©ž"
44300>>>                        Set Size to 13 57
44301>>>                        Set Location to 10 418
44302>>>                        Set Color to clBtnFace
44303>>>                        Set Label_Col_Offset to 2
44304>>>                        Set Label_Justification_Mode to jMode_Right
44305>>>                        Set Enabled_State to FALSE
44306>>>                        Set Form_TypeFace Item 0 to "MS Sans Serif"
44307>>>                        Set Item_Shadow_State Item 0 to TRUE
44308>>>                        Set Shadow_State Item 0 to TRUE
44309>>>                    End_Object    // dbFrmGtypkin
44310>>>
44310>>>                    Object TextBoxSub18 is a TextBoxSub
44312>>>                        Set Label to "˜¨/¡æ ˜¨˜¢˜™ãª:"
44313>>>                        Set Location to 12 18
44314>>>                        Set Size to 10 69
44315>>>                        Set TypeFace to "MS Sans Serif"
44316>>>                    End_Object    // TextBoxSub18
44317>>>
44317>>>                    Object TextBoxSub19 is a TextBoxSub
44319>>>                        Set Label to "˜¨˜¢ã­Ÿž¡œ ˜§æ:"
44320>>>                        Set Location to 25 18
44321>>>                        Set Size to 10 67
44322>>>                        Set TypeFace to "MS Sans Serif"
44323>>>                    End_Object    // TextBoxSub19
44324>>>
44324>>>                    Object TextBoxSub24 is a TextBoxSub
44326>>>                        Set Label to "†£-¤å˜"
44327>>>                        Set Location to 12 201
44328>>>                        Set Size to 10 26
44329>>>                        Set TypeFace to "MS Sans Serif"
44330>>>                    End_Object    // TextBoxSub24
44331>>>
44331>>>                    Object TextBoxSub27 is a TextBoxSub
44333>>>                        Set Label to "„§à¤¬£å˜"
44334>>>                        Set Location to 26 239
44335>>>                        Set Size to 10 39
44336>>>                        Set TypeFace to "MS Sans Serif"
44337>>>                    End_Object    // TextBoxSub27
44338>>>
44338>>>                    Object TextBoxSub30 is a TextBoxSub
44340>>>                        Set Label to "Œ¦:"
44341>>>                        Set Location to 11 298
44342>>>                        Set Size to 10 15
44343>>>                        Set TypeFace to "MS Sans Serif"
44344>>>                    End_Object    // TextBoxSub30
44345>>>
44345>>>                End_Object    // dbGrpEispraktea
44346>>>
44346>>>                Object dbGrpPlhrotea is a dbGroupSub
44348>>>                    Set Label to "„ ©§¨˜¡«â˜/¢ž¨à«â˜"
44349>>>                    Set Size to 44 493
44350>>>                    Set Location to 51 3
44351>>>                    Set TextColor to clNavy
44352>>>                    Object Baxio_Baxio_Lbarticl is a dbFormSub
44354>>>                        Entry_Item Baxio.Baxio_fpar_out
44355>>>                        Set Size to 13 90
44356>>>                        Set Location to 10 109
44357>>>                        Set Label_Col_Offset to 90
44358>>>                        Set Form_TypeFace Item 0 to "MS Sans Serif"
44359>>>                    End_Object    // Baxio_Baxio_Lbarticl
44360>>>
44360>>>                    Object Baxio_Baxio_Code_Out is a dbFormSub
44362>>>                        Entry_Item Baxio.Baxio_code_out
44363>>>                        Set Size to 13 126
44364>>>                        Set Location to 25 109
44365>>>                        Set Label_Col_Offset to 90
44366>>>                        Set Form_TypeFace Item 0 to "MS Sans Serif"
44367>>>                    End_Object    // Baxio_Baxio_Code_Out
44368>>>
44368>>>                    Object Baxio_Baxio_Epon_Out is a dbFormSub
44370>>>                        Entry_Item Baxio.Baxio_epon_out
44371>>>                        Set Size to 13 192
44372>>>                        Set Location to 25 283
44373>>>                        Set Color to clBtnFace
44374>>>                        Set Label_Col_Offset to 40
44375>>>                        Set Enabled_State to FALSE
44376>>>                        Set Form_TypeFace Item 0 to "MS Sans Serif"
44377>>>                        Set Item_Shadow_State Item 0 to TRUE
44378>>>                        Set Shadow_State Item 0 to TRUE
44379>>>                    End_Object    // Baxio_Baxio_Epon_Out
44380>>>
44380>>>                    Object dbFrmHmnia is a dbFormSub
44382>>>                        Set Size to 13 65
44383>>>                        Set Location to 10 231
44384>>>                        Set Color to clBtnFace
44385>>>                        Set Label_Col_Offset to 2
44386>>>                        Set Label_Justification_Mode to jMode_Right
44387>>>                        Set Enabled_State to FALSE
44388>>>                        Set Form_TypeFace Item 0 to "MS Sans Serif"
44389>>>                        Set Item_Shadow_State Item 0 to TRUE
44390>>>                        Set Shadow_State Item 0 to TRUE
44391>>>                    End_Object    // dbFrmHmnia
44392>>>
44392>>>                    Object dbFrmNo is a dbFormSub
44394>>>                        Set Size to 13 65
44395>>>                        Set Location to 10 318
44396>>>                        Set Color to clBtnFace
44397>>>                        Set Label_Col_Offset to 2
44398>>>                        Set Label_Justification_Mode to jMode_Right
44399>>>                        Set Enabled_State to FALSE
44400>>>                        Set Form_TypeFace Item 0 to "MS Sans Serif"
44401>>>                        Set Item_Shadow_State Item 0 to TRUE
44402>>>                        Set Shadow_State Item 0 to TRUE
44403>>>                    End_Object    // dbFrmNo
44404>>>
44404>>>                    Object dbFrmGtypkin is a dbFormSub
44406>>>                        Set Label to "‰å¤ž©ž"
44407>>>                        Set Size to 13 57
44408>>>                        Set Location to 10 418
44409>>>                        Set Color to clBtnFace
44410>>>                        Set Label_Col_Offset to 2
44411>>>                        Set Label_Justification_Mode to jMode_Right
44412>>>                        Set Enabled_State to FALSE
44413>>>                        Set Form_TypeFace Item 0 to "MS Sans Serif"
44414>>>                        Set Item_Shadow_State Item 0 to TRUE
44415>>>                        Set Shadow_State Item 0 to TRUE
44416>>>                    End_Object    // dbFrmGtypkin
44417>>>
44417>>>                    Object TextBoxSub20 is a TextBoxSub
44419>>>                        Set Label to "˜¨/¡æ ˜¨á›¦©žª:"
44420>>>                        Set Location to 10 19
44421>>>                        Set Size to 10 71
44422>>>                        Set TypeFace to "MS Sans Serif"
44423>>>                    End_Object    // TextBoxSub20
44424>>>
44424>>>                    Object TextBoxSub21 is a TextBoxSub
44426>>>                        Set Label to "¨é«¦ª ˜¨˜¢ã§«žª:"
44427>>>                        Set Location to 24 19
44428>>>                        Set Size to 10 78
44429>>>                        Set TypeFace to "MS Sans Serif"
44430>>>                    End_Object    // TextBoxSub21
44431>>>
44431>>>                    Object TextBoxSub25 is a TextBoxSub
44433>>>                        Set Label to "†£-¤å˜"
44434>>>                        Set Location to 10 201
44435>>>                        Set Size to 10 26
44436>>>                        Set TypeFace to "MS Sans Serif"
44437>>>                    End_Object    // TextBoxSub25
44438>>>
44438>>>                    Object TextBoxSub28 is a TextBoxSub
44440>>>                        Set Label to "„§à¤¬£å˜"
44441>>>                        Set Location to 27 237
44442>>>                        Set Size to 10 41
44443>>>                        Set TypeFace to "MS Sans Serif"
44444>>>                    End_Object    // TextBoxSub28
44445>>>
44445>>>                    Object TextBoxSub31 is a TextBoxSub
44447>>>                        Set Label to "Œ¦:"
44448>>>                        Set Location to 12 298
44449>>>                        Set Size to 9 15
44450>>>                        Set TypeFace to "MS Sans Serif"
44451>>>                    End_Object    // TextBoxSub31
44452>>>
44452>>>                End_Object    // dbGrpPlhrotea
44453>>>
44453>>>                Object dbGrpCurrentStat is a dbGroupSub
44455>>>                    Set Label to "’¨â®¦¬©˜ ‰˜«á©«˜©ž"
44456>>>                    Set Size to 44 493
44457>>>                    Set Location to 98 3
44458>>>                    Set TextColor to clNavy
44459>>>                    Object Baxio_Baxio_Lcode is a dbFormSub
44461>>>                        Entry_Item Baxio.Baxio_lcode
44462>>>                        Set Size to 13 126
44463>>>                        Set Location to 24 109
44464>>>                        Set Label_Col_Offset to 90
44465>>>                        Set Form_TypeFace Item 0 to "MS Sans Serif"
44466>>>                    End_Object    // Baxio_Baxio_Lcode
44467>>>
44467>>>                    Object Baxio_Baxio_Lepon is a dbFormSub
44469>>>                        Entry_Item Baxio.Baxio_lepon
44470>>>                        Set Size to 13 192
44471>>>                        Set Location to 24 283
44472>>>                        Set Color to clBtnFace
44473>>>                        Set Label_Col_Offset to 40
44474>>>                        Set Enabled_State to FALSE
44475>>>                        Set Form_TypeFace Item 0 to "MS Sans Serif"
44476>>>                        Set Item_Shadow_State Item 0 to TRUE
44477>>>                        Set Shadow_State Item 0 to TRUE
44478>>>                    End_Object    // Baxio_Baxio_Lepon
44479>>>
44479>>>                    Object Baxio_Baxio_Lpar is a dbFormSub
44481>>>                        Entry_Item Baxio.Baxio_lpar
44482>>>                        Set Size to 13 90
44483>>>                        Set Location to 9 109
44484>>>                        Set Label_Col_Offset to 90
44485>>>                        Set Form_TypeFace Item 0 to "MS Sans Serif"
44486>>>                    End_Object    // Baxio_Baxio_Lpar
44487>>>
44487>>>                    Object dbFrmHmnia is a dbFormSub
44489>>>                        Set Size to 13 65
44490>>>                        Set Location to 10 231
44491>>>                        Set Color to clBtnFace
44492>>>                        Set Label_Col_Offset to 2
44493>>>                        Set Label_Justification_Mode to jMode_Right
44494>>>                        Set Enabled_State to FALSE
44495>>>                        Set Form_TypeFace Item 0 to "MS Sans Serif"
44496>>>                        Set Item_Shadow_State Item 0 to TRUE
44497>>>                        Set Shadow_State Item 0 to TRUE
44498>>>                    End_Object    // dbFrmHmnia
44499>>>
44499>>>                    Object dbFrmNo is a dbFormSub
44501>>>                        Set Size to 13 65
44502>>>                        Set Location to 10 318
44503>>>                        Set Color to clBtnFace
44504>>>                        Set Label_Col_Offset to 2
44505>>>                        Set Label_Justification_Mode to jMode_Right
44506>>>                        Set Enabled_State to FALSE
44507>>>                        Set Form_TypeFace Item 0 to "MS Sans Serif"
44508>>>                        Set Item_Shadow_State Item 0 to TRUE
44509>>>                        Set Shadow_State Item 0 to TRUE
44510>>>                    End_Object    // dbFrmNo
44511>>>
44511>>>                    Object dbFrmGtypkin is a dbFormSub
44513>>>                        Set Label to "‰å¤ž©ž"
44514>>>                        Set Size to 13 57
44515>>>                        Set Location to 10 418
44516>>>                        Set Color to clBtnFace
44517>>>                        Set Label_Col_Offset to 2
44518>>>                        Set Label_Justification_Mode to jMode_Right
44519>>>                        Set Enabled_State to FALSE
44520>>>                        Set Form_TypeFace Item 0 to "MS Sans Serif"
44521>>>                        Set Item_Shadow_State Item 0 to TRUE
44522>>>                        Set Shadow_State Item 0 to TRUE
44523>>>                    End_Object    // dbFrmGtypkin
44524>>>
44524>>>                    Object TextBoxSub22 is a TextBoxSub
44526>>>                        Set Label to "’œ¢œ¬«˜å¦ ˜¨/¡æ:"
44527>>>                        Set Location to 11 13
44528>>>                        Set Size to 10 68
44529>>>                        Set TypeFace to "MS Sans Serif"
44530>>>                    End_Object    // TextBoxSub22
44531>>>
44531>>>                    Object TextBoxSub23 is a TextBoxSub
44533>>>                        Set Label to "’œ¢œ¬«˜å¦ª ˜¨˜¢ã§«žª:"
44534>>>                        Set Location to 24 13
44535>>>                        Set Size to 10 90
44536>>>                        Set TypeFace to "MS Sans Serif"
44537>>>                    End_Object    // TextBoxSub23
44538>>>
44538>>>                    Object TextBoxSub26 is a TextBoxSub
44540>>>                        Set Label to "†£-¤å˜"
44541>>>                        Set Location to 11 200
44542>>>                        Set Size to 10 27
44543>>>                        Set TypeFace to "MS Sans Serif"
44544>>>                    End_Object    // TextBoxSub26
44545>>>
44545>>>                    Object TextBoxSub29 is a TextBoxSub
44547>>>                        Set Label to "„§à¤¬£å˜"
44548>>>                        Set Location to 26 239
44549>>>                        Set Size to 10 40
44550>>>                        Set TypeFace to "MS Sans Serif"
44551>>>                    End_Object    // TextBoxSub29
44552>>>
44552>>>                    Object TextBoxSub32 is a TextBoxSub
44554>>>                        Set Label to "Œ¦:"
44555>>>                        Set Location to 11 297
44556>>>                        Set Size to 10 15
44557>>>                        Set TypeFace to "MS Sans Serif"
44558>>>                    End_Object    // TextBoxSub32
44559>>>
44559>>>                End_Object    // dbGrpCurrentStat
44560>>>
44560>>>
44560>>>                //AB-StoreStart
44560>>>                set label to "Š¦ §á ‘«¦ ®œå˜"
44561>>>                
44561>>>                //AB-StoreEnd
44561>>>
44561>>>            End_Object    // TP_Status
44562>>>
44562>>>            Object TP_Bmove is a dbTabPage
44564>>>                Set Label to "‰å¤ž©ž"
44565>>>                Object grdBmove is a dbGridSub
44567>>>                    Set Main_File to Bmove.File_Number
44568>>>                    Set Server to (Bmove_DD(self))
44569>>>                    Set Ordering to 4
44570>>>                    Set Size to 159 489
44571>>>                    Set Location to 7 5
44572>>>                    Set Wrap_State to TRUE
44573>>>                    Set Read_Only_State to TRUE
44574>>>
44574>>>                    Begin_Row
44577>>>                        Entry_Item Btypkin.Btypkin_code
44578>>>                        Entry_Item Btypkin.Btypkin_descr
44579>>>                        Entry_Item Barticl.Barticl_hmnia
44580>>>                        Entry_Item Barticl.Barticl_no
44581>>>                        Entry_Item Barticl.Barticl_code1
44582>>>                        Entry_Item Barticl.Barticl_code2
44583>>>                    End_Row
44588>>>
44588>>>                    Set Form_Width    item 0 to 38
44589>>>                    Set Header_Label  item 0 to "‰å¤ž©ž"
44590>>>                    
44590>>>                    Set Form_Width    item 1 to 197
44591>>>                    Set Header_Label  item 1 to "œ¨ š¨˜­ã"
44592>>>                    
44592>>>                    Set Form_Width    item 2 to 45
44593>>>                    Set Header_Label  item 2 to "†£-¤å˜"
44594>>>                    
44594>>>                    Set Form_Width    item 3 to 45
44595>>>                    Set Header_Label  item 3 to "€¨ Ÿ£æª"
44596>>>                    
44596>>>                    Set Form_Width    item 4 to 82
44597>>>                    Set Header_Label  item 4 to "‘¬¤˜¢¢˜©©æ£œ¤¦ª"
44598>>>                    
44598>>>                    Set Form_Width    item 5 to 76
44599>>>                    Set Header_Label  item 5 to "˜¨˜¢ã§«žª"
44600>>>                    
44600>>>
44600>>>                    //AB-StoreStart
44600>>>                                                                                                                                                                                                                                                                                                                        
44600>>>                    Procedure Set Col_Entry_State Integer iItem Integer iState
44602>>>                        Integer liPrototype
44603>>>                        Get Prototype_Object to liPrototype
44604>>>                        Set Entry_State of liPrototype Item iItem to iState
44605>>>                    End_Procedure // Col_Entry_State
44606>>>                    
44606>>>                    Set Col_Entry_State to 0 False
44607>>>                    Set Col_Entry_State to 1 False
44608>>>                    Set Col_Entry_State to 2 False
44609>>>                    Set Col_Entry_State to 3 False
44610>>>                    Set Col_Entry_State to 4 False
44611>>>                    Set Col_Entry_State to 5 False
44612>>>                    
44612>>>                    Procedure Mouse_Up Integer aiWindow Integer iChar_Pos
44614>>>                    End_Procedure // Mouse_Up
44615>>>                    
44615>>>                    Procedure Request_Clear_All
44617>>>                    End_Procedure // Request_Clear_All
44618>>>                    
44618>>>                    
44618>>>                    
44618>>>                    
44618>>>                    
44618>>>                    
44618>>>                    //AB-StoreEnd
44618>>>
44618>>>                End_Object    // grdBmove
44619>>>
44619>>>
44619>>>                //AB-StoreStart
44619>>>                set label to "‰ ¤ã©œ ª    "
44620>>>                //AB-StoreEnd
44620>>>
44620>>>            End_Object    // TP_Bmove
44621>>>
44621>>>        End_Object    // dbTbDlgAxio
44622>>>
44622>>>        Object dbGrpYear is a dbGroupSub
44624>>>            Set Size to 26 505
44625>>>            Set Location to 2 3
44626>>>            Object Company_Company_Name is a dbFormSub
44628>>>                Entry_Item Syscurxr.Company_name
44629>>>                Set Server to (Syscurxr_DD(self))
44630>>>                Set Size to 13 139
44631>>>                Set Location to 9 47
44632>>>                Set Color to clBtnFace
44633>>>                Set Label_Col_Offset to 2
44634>>>                Set Label_Justification_Mode to jMode_Right
44635>>>                Set Enabled_State to FALSE
44636>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
44637>>>                Set Item_Shadow_State Item 0 to TRUE
44638>>>                Set Shadow_State Item 0 to TRUE
44639>>>            End_Object    // Company_Company_Name
44640>>>
44640>>>            Object Branch_Branch_Name is a dbFormSub
44642>>>                Entry_Item Syscurxr.Branch_name
44643>>>                Set Server to (Syscurxr_DD(self))
44644>>>                Set Size to 13 141
44645>>>                Set Location to 9 241
44646>>>                Set Color to clBtnFace
44647>>>                Set Label_Col_Offset to 2
44648>>>                Set Label_Justification_Mode to jMode_Right
44649>>>                Set Enabled_State to FALSE
44650>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
44651>>>                Set Item_Shadow_State Item 0 to TRUE
44652>>>                Set Shadow_State Item 0 to TRUE
44653>>>            End_Object    // Branch_Branch_Name
44654>>>
44654>>>            Object Year_Year_Year is a dbFormSub
44656>>>                Entry_Item Syscurxr.Year_year
44657>>>                Set Server to (Syscurxr_DD(self))
44658>>>                Set Size to 13 61
44659>>>                Set Location to 9 440
44660>>>                Set Color to clBtnFace
44661>>>                Set Label_Col_Offset to 2
44662>>>                Set Label_Justification_Mode to jMode_Right
44663>>>                Set Enabled_State to FALSE
44664>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
44665>>>                Set Item_Shadow_State Item 0 to TRUE
44666>>>                Set Shadow_State Item 0 to TRUE
44667>>>
44667>>>                //AB-StoreStart
44667>>>                                                                                                                                                                                                                                                    
44667>>>                                                                                                                                                                                                                                                    
44667>>>                                                                                                                                                                                                                                                    
44667>>>                //AB-StoreEnd
44667>>>
44667>>>            End_Object    // Year_Year_Year
44668>>>
44668>>>            Object otxtCompany is a TextBoxSub
44670>>>                Set Label to "„«˜ ¨œå˜"
44671>>>                Set Auto_Size_State to FALSE
44672>>>                Set TextColor to clNavy
44673>>>                Set FontSize to 4 0
44674>>>                Set Location to 10 8
44675>>>                Set Size to 10 31
44676>>>                Set FontWeight to 800
44677>>>                Set Justification_Mode to jMode_Right
44678>>>                Set TypeFace to "MS Sans Serif"
44679>>>                Set Enabled_State to TRUE
44680>>>            End_Object    // otxtCompany
44681>>>
44681>>>            Object otxtBranch is a TextBoxSub
44683>>>                Set Label to "“§¦¡/£˜ :"
44684>>>                Set Auto_Size_State to FALSE
44685>>>                Set TextColor to clNavy
44686>>>                Set FontSize to 4 0
44687>>>                Set Location to 10 200
44688>>>                Set Size to 10 31
44689>>>                Set FontWeight to 800
44690>>>                Set Justification_Mode to jMode_Right
44691>>>                Set TypeFace to "MS Sans Serif"
44692>>>                Set Enabled_State to TRUE
44693>>>            End_Object    // otxtBranch
44694>>>
44694>>>            Object otxtYear is a TextBoxSub
44696>>>                Set Label to "•¨ã©ž :          "
44697>>>                Set Auto_Size_State to FALSE
44698>>>                Set TextColor to clNavy
44699>>>                Set FontSize to 4 0
44700>>>                Set Location to 10 408
44701>>>                Set Size to 10 24
44702>>>                Set FontWeight to 800
44703>>>                Set Justification_Mode to jMode_Right
44704>>>                Set TypeFace to "MS Sans Serif"
44705>>>                Set Enabled_State to TRUE
44706>>>            End_Object    // otxtYear
44707>>>
44707>>>        End_Object    // dbGrpYear
44708>>>
44708>>>        Object TextBoxSub1 is a TextBoxSub
44710>>>            Set Label to "„å›¦ª"
44711>>>            Set Location to 36 5
44712>>>            Set Size to 10 35
44713>>>            Set TypeFace to "MS Sans Serif"
44714>>>        End_Object    // TextBoxSub1
44715>>>
44715>>>        Object TextBoxSub2 is a TextBoxSub
44717>>>            Set Label to "‰à› ¡æª"
44718>>>            Set Location to 49 5
44719>>>            Set Size to 10 33
44720>>>            Set TypeFace to "MS Sans Serif"
44721>>>        End_Object    // TextBoxSub2
44722>>>
44722>>>        Object TextBoxSub13 is a TextBoxSub
44724>>>            Set Label to "‰˜«á©«˜©ž"
44725>>>            Set Location to 37 285
44726>>>            Set Size to 10 51
44727>>>            Set TypeFace to "MS Sans Serif"
44728>>>        End_Object    // TextBoxSub13
44729>>>
44729>>>        Object TextBoxSub14 is a TextBoxSub
44731>>>            Set Label to "¨å©¡œ«˜ "
44732>>>            Set Location to 49 285
44733>>>            Set Size to 12 39
44734>>>            Set TypeFace to "MS Sans Serif"
44735>>>        End_Object    // TextBoxSub14
44736>>>
44736>>>
44736>>>        //AB-StoreStart
44736>>>                                
44736>>>                                
44736>>>        //AB-StoreEnd
44736>>>
44736>>>    End_Object    // VW037
44737>>>
44737>>>//AB/     End_Object    // prj
INCLUDING FILE: FEM.PKG
44737>>///////////////////////////////////////////////
44737>>// Ginetai #Include sto Program //
44737>>///////////////////////////////////////////////
44737>>Use Idiotht.pkg
44737>>
44737>>Integer igC
44737>>String  sgC sgFull sgRootDir sgDevicePath
44737>>Move 0 to igC
44738>>
44738>>Move (fsReadRegistryFEMRootDir   ()) To sgRootDir
44739>>Move (fsReadRegistryFEMDevicePath()) To sgDevicePath
44740>>
44740>>// An den yparxoun ta settings sto registry (apo Setup Egkatastashs)
44740>>// Tote ta ftiaxnoume me ex orismou C:\FEM_ROOT\ & C:\FEM_ROOT\Device_File1.dat
44740>>// mesa apo tis 2 parakato functions (sto Idiotht.pkg)
44740>>If (Trim(sgRootDir)   ='') Get fiWriteRegistryFEMRootDir    to iGC
44743>>If (Trim(sgDevicePath)='') Get fiWriteRegistryFEMDevicePath to iGC
44746>>//
44746>>
44746>>// ** START ** Function ths forologikhs ektypotikhs mhxanhs
44746>>External_Function32 FSL_Command "FSL_Command" rapidsign.dll;                    String  sBaseDir    ;                    String  sCommand    ;                    String  sDevFile    ;                    String  sParam1     ;                    String  sParam2     ;                    Returns Integer
44747>>
44747>>External_Function32 FSL_SignDocument "FSL_SignDocument" rapidsign.dll;                    String  sDevFile    ;                    String  sParam      ;                    String  sResult     ;                    Returns Integer
44748>>// ** END ** Function ths forologikhs ektypotikhs mhxanhs
44748>>
44748>>
44748>>// ** START ** Gemisma global string me escape xarakthron gia afairesh tous apo to ascii ths forologikhs
44748>>Move '' to sgC
44749>>For igC From 1 to 254
44755>>>
44755>>    If ((igC<32) Or ((igC>175) And (igC<224)) Or (igC>240)) Begin
44757>>        Move (Append(sgC,Character(igC))) to sgC
44758>>    End
44758>>>
44758>>Loop
44759>>>
44759>>// ** END ** Gemisma escape xarakthron gia afairesh tous apo to ascii ths forologikhs
44759>>
44759>>
44759>>Function fiEtoimaseTaAscii Returns Integer
44761>>    Integer iFileExist iii iii2 isOK
44762>>    String  sLine sLine2 sLetter sLetter2
44762>>    // 1. Check if file was outputed (C:\##Parast.txt)
44762>>    Get Get_File_Exists 'C:\##Parast.txt' to iFileExist
44763>>    If (Not(iFileExist)) Function_Return 12556
44766>>
44766>>    // 2. Check if file is outputed but empty
44766>>    Direct_Input Channel 7 "C:\##Parast.txt"
44768>>    If (Seqeof) Begin
44770>>        Close_Input Channel 7
44772>>        Function_Return 12557
44773>>    End
44773>>>
44773>>
44773>>    // 3. Strip file from escape sequences
44773>>    Direct_Output Channel 9 "C:\##Parast0.txt"
44775>>    Repeat
44775>>>
44775>>        Readln Channel 7 sLine
44777>>        For iii From 1 to (Length(sgC))
44783>>>
44783>>            Move (Replaces((Mid(sgC,1,iii)),sLine,' ')) to sLine
44784>>        Loop
44785>>>
44785>>        Writeln Channel 9 sLine
44788>>    Until (Seqeof)
44790>>    Close_Input Channel 7
44792>>    Close_Output Channel 9
44794>>
44794>>    // 4. Check if new ascii without escape
44794>>    //    sequences is outputed (C:\##Parast0.txt)
44794>>    Get Get_File_Exists 'C:\##Parast0.txt' to iFileExist
44795>>    If (Not(iFileExist)) Function_Return 12558
44798>>
44798>>    // 5. Check if new file is outputed but empty
44798>>    Direct_Input Channel 7 "C:\##Parast0.txt"
44800>>    If (Seqeof) Begin
44802>>        Close_Input Channel 7
44804>>        Function_Return 12559
44805>>    End
44805>>>
44805>>
44805>>    // 6. Convert file to ELOT
44805>>    Direct_Output Channel 9 "C:\##Parast1.txt"
44807>>    Repeat
44807>>>
44807>>        Readln Channel 7        sLine
44809>>        Move (ToAnsi(sLine)) to sLine2
44810>>        Writeln Channel 9       sLine2
44813>>    Until (Seqeof)
44815>>    Close_Input  Channel 7
44817>>    Close_Output Channel 9
44819>>
44819>>    // 7. Check if converted ELOT ascii is outputed (C:\##Parast1.txt)
44819>>    Get Get_File_Exists 'C:\##Parast1.txt' to iFileExist
44820>>    If (Not(iFileExist)) Function_Return 12560
44823>>
44823>>    // 8. Check if converted ELOT ascii is NOT Empty
44823>>    Direct_Input Channel 7 "C:\##Parast1.txt"
44825>>    If (Seqeof) Begin
44827>>        Close_Output Channel 7
44829>>        Function_Return 12561
44830>>    End
44830>>>
44830>>    Close_Output Channel 7
44832>>
44832>>    Function_Return 1 // Everything OK
44833>>End_function
44834>>
44834>>Function fiPareYpografh Returns String
44836>>    Integer iFileExist iii iii2 isOK
44837>>    String  sLine sLine2 sLetter sLetter2
44837>>    Move 0 to isOK
44838>>
44838>>    Move (FSL_Command(sgRootDir,'SIGN',sgDevicePath ,'C:\##Parast1.txt','C:\##Signature.txt')) to isOK
44839>>    If (isOK<>0) Function_Return ''
44842>>
44842>>    Direct_Input Channel 7 'C:\##Signature.txt'
44844>>    If (Seqeof) Function_Return '12562'
44847>>    Readln Channel 7 sLine
44849>>    Move (Trim(sLine)) to sLine
44850>>    If (Length(sLine)<>77) Function_Return '12563'
44853>>
44853>>    EraseFile "C:\##Parast*.txt"
44854>>>
44854>>    EraseFile "C:\##Signature.txt"
44855>>>
44855>>
44855>>    Function_return (Trim(sLine))
44856>>End_function
44857>>
44857>>Function fiVgaleZ Returns Integer
44859>>    Integer isOK
44860>>    Move 0 to isOK
44861>>    Move (FSL_Command(sgRootDir,'Z',sgDevicePath ,'','')) to isOK
44862>>    Function_return isOK
44863>>    // 0= ok
44863>>End_function
44864>>
44864>>Function fiShowCTL Returns Integer
44866>>    Integer isOK
44867>>    Move 0 to isOK
44868>>    Move (FSL_Command(sgRootDir,'CTL',sgDevicePath ,'','')) to isOK
44869>>    Function_return isOK
44870>>    // 0= ok
44870>>End_function
44871>>
44871>>Use RptVwFem.Sub
INCLUDING FILE: RPTVWFEM.SUB
44871>>>>Use DFRptvw.pkg
44871>>>>Use dbRptvw.pkg
INCLUDING FILE: DBRPTVW.PKG
44871>>>>>>
44871>>>>>>Use Windows
44871>>>>>>Use DfPanel
44871>>>>>>Use EnClient
44871>>>>>>Use DFNav_mx
44871>>>>>>Use dfConfrm
44871>>>>>>Use dfRptVw
44871>>>>>>Use DFGSINI
44871>>>>>>
44871>>>>>>Class dbReportAppClient_ is a ReportView STARTMAC ECstart
44872>>>>>>    Import_Class_Protocol Entry_Client
44873>>>>>>    //  Defeat the activating augmentation for auto-locate
44873>>>>>>    Procedure Activating Returns Integer
44874>>>>>>      local integer RVal
44875>>>>>>      forward get MSG_activating to rVal
44877>>>>>>      Procedure_Return rVal
44878>>>>>>    End_Procedure
44879>>>>>>End_Class // dbReportAppClient_
44880>>>>>>
44880>>>>>>Class dbReportAppView_ is a dbReportAppClient_
44881>>>>>>  import_Class_protocol entry_view_Client
44882>>>>>>End_Class // dbReportAppView_
44883>>>>>>
44883>>>>>>
44883>>>>>>Class dbReportView is a dbReportAppView_
44884>>>>>>
44884>>>>>>     Procedure Construct_Object
44885>>>>>>      Forward Send Construct_Object No_Image
44887>>>>>>      Send Define_DFNavigation  // GUI navigate changes
44888>>>>>>      // dialog views get activated as popup objects.
44888>>>>>>      set Dso_Detach_Mode to Detach_Always
44889>>>>>>
44889>>>>>>      Set Verify_Data_Loss_Msg TO GET_No_Confirmation
44890>>>>>>      Set Verify_Delete_Msg    TO GET_No_Confirmation
44891>>>>>>      Set Verify_Save_Msg      TO GET_No_Confirmation
44892>>>>>>      Set Verify_Exit_Msg      TO GET_No_confirmation
44893>>>>>>      //
44893>>>>>>      // This reportview-client will almost always be a modalpanel, therefore minimizing
44893>>>>>>      // is out of the question...
44893>>>>>>      Set Minimize_Icon To False
44894>>>>>>      Set Maximize_Icon To False
44895>>>>>>   End_Procedure // Construct_Object
44896>>>>>>
44896>>>>>>   Procedure Request_Delete
44897>>>>>>   End_Procedure // request_delete
44898>>>>>>
44898>>>>>>   Procedure Request_Save
44899>>>>>>   End_Procedure // request_save
44900>>>>>>
44900>>>>>>   Function Exit_Application_Check Returns Integer
44901>>>>>>     Function_return 0
44902>>>>>>   End_Function
44903>>>>>>
44903>>>>>>   Import_Class_Protocol DFNavigate_Mixin
44904>>>>>>
44904>>>>>>  //  Returns TRUE to indicate that this is a DEO. This is used by
44904>>>>>>  //  delegation to figure out if you are within a DEO and should therefore
44904>>>>>>  //  send a DEO message. DEO clients set this true
44904>>>>>>  Function DEO_Object Returns integer
44905>>>>>>    Function_Return 1
44906>>>>>>  End_Function // DEO_Object
44907>>>>>>
44907>>>>>>  //
44907>>>>>>  //  Activate message for views that:
44907>>>>>>  //  1. restores the view if it is minimized
44907>>>>>>  //  2. Maintains the current scope's focus.
44907>>>>>>  //
44907>>>>>>  Procedure Activate_current_scope
44908>>>>>>    If ( View_mode(Current_Object)=VIEWMODE_ICONIZE ) ;       Set view_mode to viewmode_normal
44911>>>>>>    Set Current_Scope to Current_Object
44912>>>>>>  End_Procedure // Activate_current_scope
44913>>>>>>
44913>>>>>>  //  Pass full object name - return the relative name
44913>>>>>>  //  e.g.,  Main.View.Obj1 --> Obj1
44913>>>>>>  Function Local_Object_name string nm returns string
44914>>>>>>     local integer ps
44915>>>>>>     Repeat
44915>>>>>>>
44915>>>>>>       pos "." in nm to ps
44917>>>>>>>
44917>>>>>>       If ps eq 0 function_return nm
44920>>>>>>       increment ps
44921>>>>>>       Mid Nm to Nm 255 ps
44924>>>>>>>
44924>>>>>>     Loop
44925>>>>>>>
44925>>>>>>  end_function
44926>>>>>>
44926>>>>>>  //  Take string "#1,#2" and return integer hi #1 + #2
44926>>>>>>  Function Parse_Complex string sVal returns integer
44927>>>>>>     Local integer ps
44928>>>>>>     Pos "," in sVal to ps
44930>>>>>>>
44930>>>>>>     if ps ;        Function_Return ( integer(left(sVal,ps-1))*65536 + ;                          integer(mid(sVal,255,ps+1)) )
44933>>>>>>  End_Function // Parse_Complex
44934>>>>>>
44934>>>>>>  // Convert a complex integer to a string "hi,Low"
44934>>>>>>  //
44934>>>>>>  Function Complex_to_String integer i1 returns string
44935>>>>>>     function_return ( string(hi(i1)) - "," - String(low(i1)) )
44936>>>>>>  End_function
44937>>>>>>
44937>>>>>>
44937>>>>>>  // *WvA: I don't want to save locations of a reportview noted in the registry.
44937>>>>>>  // These printing dialogs are centered on the panel anyway, so it doesn't make any
44937>>>>>>  // sense to clutter up the registry with this kind of nonsense.
44937>>>>>>  ////
44937>>>>>>  ////  Save View information to dfwin.ini file. Save as:
44937>>>>>>  ////  View_ObjectName=LOC:Row,Col  e.g., Cust_Ent=LOC:10,20
44937>>>>>>  ////     Leaving room for growth here.
44937>>>>>>  ////
44937>>>>>>  Procedure Save_Environment
44938>>>>>>  //   Local String nm Vn st
44938>>>>>>  //   Local Integer H
44938>>>>>>  //
44938>>>>>>  //   Get System_Profile_String "SaveEnvironment" to St
44938>>>>>>  //   Move (Uppercase(trim(st))) to st
44938>>>>>>  //   If (st="YES" or st="ON" or st="TRUE") Begin
44938>>>>>>  //     // Note with the 3.05 version we will have problems if the view has
44938>>>>>>  //     // been maximized and then iconized. We still don't know what the normal
44938>>>>>>  //     // size/loc is when maximized. We will take a chance and assume that an
44938>>>>>>  //     // iconized view is always non-zoomed (since views don't support the zoom
44938>>>>>>  //     // button).
44938>>>>>>  //     If (View_mode(Current_Object)<>VIEWMODE_ZOOM) Begin
44938>>>>>>  //
44938>>>>>>  //       Get Name to Vn // full name of object
44938>>>>>>  //       Get Local_Object_Name Vn to Vn   // just get the local name
44938>>>>>>  //       Get GUILocation to H             // complex location
44938>>>>>>  //       Get Complex_to_String h to nm    // convert complex to "hi,low"
44938>>>>>>  //       Set System_Profile_String VN to ("LOC:"+Nm)
44938>>>>>>  //     End
44938>>>>>>  //   End
44938>>>>>>  //
44938>>>>>>  End_Procedure
44939>>>>>>  //
44939>>>>>>  //// Augment to check for view string in .INI. Currently, if found
44939>>>>>>  //// set the location
44939>>>>>>  ////
44939>>>>>>  Procedure Load_Environment
44940>>>>>>  //   Local String nm Vn Lc
44940>>>>>>  //   Local Integer H ps
44940>>>>>>  //   // see above for reasoning on this
44940>>>>>>  //   If (View_mode(Current_Object)=VIEWMODE_NORMAL) Begin
44940>>>>>>  //     Get Name to Vn
44940>>>>>>  //     Get Local_Object_Name Vn to Vn
44940>>>>>>  //     Get System_Profile_String Vn to Nm
44940>>>>>>  //     IF Nm ne '' Begin
44940>>>>>>  //        Pos "LOC:" in Nm to Ps   // look for LOC:row,col
44940>>>>>>  //        If Ps Begin
44940>>>>>>  //           Mid Nm to Lc 255 (Ps+4)
44940>>>>>>  //           Pos " " in Lc to ps
44940>>>>>>  //           if Ps left lc to lc (ps-1)
44940>>>>>>  //           Get Parse_Complex lc to H
44940>>>>>>  //           Set GUILocation to (Hi(H)) (Low(H))
44940>>>>>>  //           Send Adjust_Logicals
44940>>>>>>  //        End
44940>>>>>>  //     End
44940>>>>>>  //   End
44940>>>>>>  End_Procedure
44941>>>>>>
44941>>>>>>  Function View_Changed returns Integer
44942>>>>>>     Local Integer Changed
44943>>>>>>     Broadcast Get Data_Set_Should_Save to Changed // Ask for changes in Data-sets
44945>>>>>>     Function_Return Changed
44946>>>>>>  End_Function
44947>>>>>>
44947>>>>>>  Procedure Notify_Exit_Application
44948>>>>>>    Send Save_Environment
44949>>>>>>  End_procedure
44950>>>>>>
44950>>>>>>  Procedure End_Construct_Object
44951>>>>>>     Send Load_Environment
44952>>>>>>     //Send Define_SysMenu
44952>>>>>>     Forward Send End_Construct_Object
44954>>>>>>  End_Procedure // End_Construct_Object
44955>>>>>>
44955>>>>>>  Procedure Close_Client
44956>>>>>>     Send Exit_Function
44957>>>>>>  End_Procedure
44958>>>>>>
44958>>>>>>  Procedure Entering_Scope returns Integer
44959>>>>>>     Local Integer rVal
44960>>>>>>     Forward Get MSG_Entering_Scope to rVal
44962>>>>>>     If not rVal send Show_View_Name (Label(Current_Object))
44965>>>>>>  End_Procedure
44966>>>>>>
44966>>>>>>  Procedure Exiting_Scope integer whereto returns Integer
44967>>>>>>     Local Integer rVal
44968>>>>>>     Forward Get MSG_Exiting_Scope whereto to rVal
44970>>>>>>     If not rVal Send Show_View_Name ''
44973>>>>>>  End_Procedure
44974>>>>>>
44974>>>>>>  Procedure Show_view_Name string sHelp
44975>>>>>>     Local Integer rVal Id
44976>>>>>>     Get Statusbar_id to id
44977>>>>>>     If Id Send Show_View_Name to Id sHelp
44980>>>>>>  End_Procedure
44981>>>>>>
44981>>>>>>  Function Should_Save_Recursive returns integer
44982>>>>>>    Function_return (View_Changed(Current_Object))
44983>>>>>>  End_Function
44984>>>>>>
44984>>>>>>End_Class // dbReportView
44985>>>>
44985>>>>Use RptVW.Sub
INCLUDING FILE: RPTVW.SUB
44985>>>>>>Use DFRptvw.pkg
44985>>>>>>Use dbRptvw.pkg
44985>>>>>>
44985>>>>>>Class ReportViewSub is a ReportView
44986>>>>>>
44986>>>>>>    Procedure Construct_Object
44987>>>>>>        Forward Send Construct_Object
44989>>>>>>        Property Integer Server 0
44990>>>>>>    End_Procedure // Construct_Object
44991>>>>>>
44991>>>>>>    Procedure Page Integer PageMode
44992>>>>>>        Integer hWnd
44993>>>>>>        Forward Send Page PageMode
44995>>>>>>        Get Window_Handle to hWnd
44996>>>>>>        If (hWnd) Begin
44998>>>>>>            Send GreekSysMenu
44999>>>>>>        End
44999>>>>>>>
44999>>>>>>    End_Procedure
45000>>>>>>
45000>>>>>>    Procedure Close_Panel
45001>>>>>>        Local Integer liScope
45002>>>>>>        Move (Prior_Scope(Desktop)) To liScope
45003>>>>>>        Move (Scope_Focus(liScope)) To liScope
45004>>>>>>        Forward Send Close_Panel
45006>>>>>>        Send Activate To liScope
45007>>>>>>    End_Procedure // Close_Panel
45008>>>>>>
45008>>>>>>End_Class
45009>>>>>>
45009>>>>>>Class dbReportViewSub is a dbReportView
45010>>>>>>
45010>>>>>>    Procedure Construct_Object
45011>>>>>>        Forward Send Construct_Object
45013>>>>>>        Property Integer Server 0
45014>>>>>>    End_Procedure // Construct_Object
45015>>>>>>
45015>>>>>>    Procedure Page Integer PageMode
45016>>>>>>        Integer hWnd
45017>>>>>>        Forward Send Page PageMode
45019>>>>>>        Get Window_Handle to hWnd
45020>>>>>>        If (hWnd) Begin
45022>>>>>>            Send GreekSysMenu
45023>>>>>>        End
45023>>>>>>>
45023>>>>>>    End_Procedure
45024>>>>>>
45024>>>>>>    Procedure Close_Panel
45025>>>>>>        Local Integer liScope
45026>>>>>>        Move (Prior_Scope(Desktop)) To liScope
45027>>>>>>        Move (Scope_Focus(liScope)) To liScope
45028>>>>>>        Forward Send Close_Panel
45030>>>>>>        Send Activate To liScope
45031>>>>>>    End_Procedure // Close_Panel
45032>>>>>>End_Class
45033>>>>>>
45033>>>>
45033>>>>Class ReportViewFEMSub is a ReportViewSub    
45034>>>>
45034>>>>    Procedure Construct_Object
45035>>>>        Forward Send Construct_Object
45037>>>>
45037>>>>        Property Integer    piIsReportCancelled     Public  0
45038>>>>        Property Integer    piAsciiOrPrinter        Public  0
45039>>>>    
45039>>>>    End_Procedure
45040>>>>    
45040>>>>
45040>>>>// ‡˜ â§¨œ§œ ž procedure ˜¬«ž
45040>>>>//
45040>>>>//    Procedure StartReport
45040>>>>//        send Gemise_Escape_Characters
45040>>>>//        String Whme_APO sRecr
45040>>>>//        integer wnees wclose
45040>>>>//        Local Integer iOutputDevice
45040>>>>//        Local String  FileName
45040>>>>//        local integer inew_state
45040>>>>//        Get Output_Device_Mode To iOutputDevice
45040>>>>//        get new_state to inew_state
45040>>>>//        set piprinter to 0
45040>>>>//        //?????????????????????????????????????????????
45040>>>>//        Get Output_Device_Mode To iOutputDevice
45040>>>>
45040>>>>//        If iOutputDevice EQ PRINT_TO_WINDOW Begin
45040>>>>//            Set piAsciiOrPrinter    to 0
45040>>>>//            Make_Temp_File "TXT" FileName
45040>>>>//            Move (".\" - FileName)  To FileName
45040>>>>//            Set Output_Device_Name  To FileName
45040>>>>//        End
45040>>>>//        Else Begin
45040>>>>
45040>>>>//            If (Sysfile.Use_Sql_Reports='1') Begin
45040>>>>//                If (piAsciiOrPrinter(Self)=0) Error 7000 'ƒœ¤ ©œ«á¨˜«œ «¦ piAsciiOrPrinter\n(ƒœ¤ §¨¦©› ¦¨å©«ž¡œ ˜¤ ˜­¦¨á ASCII ã „¡«¬§à«ã)'
45040>>>>//            End
45040>>>>
45040>>>>//            Get psRecr Of TIMOLOGIO_BasicReport to sRecr
45040>>>>//            Move (Trim(sRecr)) to sRecr
45040>>>>
45040>>>>//            If (sRecr='') Error 7003 'ƒœ¤ ¬§á¨®œ  Recr š ˜ «¦ §˜¨˜©«˜« ¡æ'
45040>>>>
45040>>>>//            Clear Particle
45040>>>>//            Move sRecr to Particle.Partl_Recr
45040>>>>//            Find Eq Particle by index.2
45040>>>>//            If (Not(Found)) Error 7001 'ƒœ¤ ™¨âŸž¡œ «¦ §˜¨˜©«˜« ¡æ'
45040>>>>
45040>>>>//            Clear Pseira
45040>>>>//            Move SyscurXr.Company_Code  to Pseira.Company_Code
45040>>>>//            Move SyscurXr.Branch_Code   to Pseira.Branch_Code
45040>>>>//            Move Particle.Ptyppar_Code  to Pseira.Ptyppar_Code
45040>>>>//            Move Particle.Pseira_Seira  to Pseira.Pseira_Seira
45040>>>>//            Find Eq Pseira By Index.1 // Pseira:Index.1:Company_Code+Branch_Code+Year_Year+Ptyppar_Code+Pseira_Seira
45040>>>>//            If (Not(Found)) Error 7002 'ƒœ¤ ™¨âŸž¡œ ž ©œ ¨á'
45040>>>>
45040>>>>//            If (piAsciiOrPrinter(Self)=1) Begin
45040>>>>//                // 1= Output ©œ Ascii
45040>>>>//                Set Output_Device_Name  To 'C:\##Parast.txt'
45040>>>>//            End
45040>>>>//            Else If (piAsciiOrPrinter(Self)=2) Begin
45040>>>>//                // 2= Output ©œ Printer
45040>>>>//                Set Output_Device_Name  To Pseira.Pseira_Printer
45040>>>>//            End
45040>>>>//            Else Error 7004 '’¦ Flag piAsciiOrPrinter ›œ¤ œå¤˜  ©à©«æ'
45040>>>>//        End
45040>>>>
45040>>>>//        Send Run_Report  //record
45040>>>>
45040>>>>//        If iOutputDevice EQ PRINT_TO_WINDOW Begin
45040>>>>//            RunProgram background "notepad" FileName
45040>>>>//            EraseFile FileName
45040>>>>//        End
45040>>>>
45040>>>>//    End_Procedure   // StartReport
45040>>>>
45040>>>>
45040>>>>End_Class
45041>>>>
45041>>>>Class dbReportViewFEMSub is a dbReportViewSub
45042>>>>    Procedure Construct_Object
45043>>>>        Forward Send Construct_Object
45045>>>>
45045>>>>        Property Integer    piIsReportCancelled     Public  0
45046>>>>        Property Integer    piAsciiOrPrinter        Public  0
45047>>>>    
45047>>>>    End_Procedure
45048>>>>End_Class
45049>>>>
45049>>Use BasrpFem.Sub
INCLUDING FILE: BASRPFEM.SUB
45049>>>>Use Dfrpt.pkg
45049>>>>
45049>>>>Use BasicRpt.Sub
INCLUDING FILE: BASICRPT.SUB
45049>>>>>>Use Dfrpt.pkg
45049>>>>>>
45049>>>>>>Class BasicReportSub is a BasicReport
45050>>>>>>
45050>>>>>>    Procedure Start_Log
45051>>>>>>        Send Log_Status ("Starting Report:"+Report_Title(Current_Object))
45052>>>>>>    End_Procedure // Start_Log
45053>>>>>>
45053>>>>>>    Procedure End_Log
45054>>>>>>        Send Log_Status ("Ending Report:  " + Report_Title(Current_Object))
45055>>>>>>    End_Procedure // End_Log
45056>>>>>>
45056>>>>>>    Procedure Error_Log_Status integer ErrNum integer Err_Line string ErrMsg
45057>>>>>>        Send Log_Status ("Error #"* String(ErrNum) + "." * ErrMsg)
45058>>>>>>    End_Procedure // Error_Log_Status
45059>>>>>>
45059>>>>>>    Procedure Update_Status_Page
45060>>>>>>        If (Page_End(Current_Object)) EQ 0 ;             Send Update_Status ("Record: " + String(Page_Count(Current_Object)))
45063>>>>>>        Else Send Update_Status ("Page: "   + String(Page_Count(Current_Object)))
45065>>>>>>    End_Procedure // Update_Status_Page
45066>>>>>>
45066>>>>>>    Procedure onError integer ErrNum integer Err_Line string ErrMsg
45067>>>>>>        If (Display_Error_State(Self)) Send End_Status
45070>>>>>>        Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
45071>>>>>>>
45071>>>>>>    End_procedure
45072>>>>>>
45072>>>>>>    Function Report_Interrupt Returns Integer
45073>>>>>>        Integer rVal
45074>>>>>>        String Mess
45074>>>>>>        If (Error_Check_State(Current_Object)) ;            Move "„£­˜¤å©«ž¡œ œ¤˜ ©­á¢£˜ ¡˜«˜ «ž¤ œ§œ¥œ¨š˜©å˜. Œ˜ › ˜¡¦§œå ž œ¡«ç§à©ž ?" to Mess
45077>>>>>>        Else   Move  "Œ˜ ˜¡¬¨é©à «ž¤ œ¡«ç§à©ž ?" to Mess
45079>>>>>>        Get YesNo_Box Mess "ƒ ˜¡¦§ã „§œ¥œ¨š˜©å˜ª" to rVal
45080>>>>>>        If (rVal=MBR_YES) Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
45083>>>>>>        Function_Return (Rval=MBR_YES)
45084>>>>>>    End_Function  // Report_Interrupt
45085>>>>>>
45085>>>>>>
45085>>>>>>    Procedure Initialize_Output_Device
45086>>>>>>        string sopenpath
45087>>>>>>        get_attribute Df_Open_path to sopenpath
45090>>>>>>        set_attribute Df_Open_path to ""
45093>>>>>>        Direct_Output (Output_Device(current_Object))
45094>>>>>>        Set_Attribute DF_open_path to sopenpath
45097>>>>>>    End_procedure
45098>>>>>>End_Class // BasicReportSub
45099>>>>>>
45099>>>>>>Class WinReportSub is a WinReport
45100>>>>>>
45100>>>>>>    Procedure Start_Log
45101>>>>>>        Send Log_Status ("Start Report:"+Report_Title(Current_Object))
45102>>>>>>    End_Procedure // Start_Log
45103>>>>>>
45103>>>>>>    Procedure End_Log
45104>>>>>>        Send Log_Status ("End Report:  " + Report_Title(Current_Object))
45105>>>>>>    End_Procedure // End_Log
45106>>>>>>
45106>>>>>>    Procedure Error_Log_Status integer ErrNum integer Err_Line string ErrMsg
45107>>>>>>        Send Log_Status ("Error #"* String(ErrNum) + "." * ErrMsg)
45108>>>>>>    End_Procedure // Error_Log_Status
45109>>>>>>
45109>>>>>>    Procedure Update_Status_Page
45110>>>>>>        If (Page_End(Current_Object)) EQ 0 ;            Send Update_Status ("Record: " + String(Page_Count(Current_Object)))
45113>>>>>>        Else Send Update_Status ("Page: " + String(Page_Count(Current_Object)))
45115>>>>>>    End_Procedure // Update_Status_Page
45116>>>>>>
45116>>>>>>    Procedure onError integer ErrNum integer Err_Line string ErrMsg
45117>>>>>>        If (Display_Error_State(Self)) Send End_Status
45120>>>>>>        Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
45121>>>>>>>
45121>>>>>>    End_procedure
45122>>>>>>
45122>>>>>>    Function Report_Interrupt Returns Integer
45123>>>>>>        Integer rVal
45124>>>>>>        String Mess
45124>>>>>>        If (Error_Check_State(Current_Object)) ;            Move "„£­˜¤å©«ž¡œ œ¤˜ ©­á¢£˜ ¡˜«˜ «ž¤ œ§œ¥œ¨š˜©å˜. Œ˜ › ˜¡¦§œå ž œ¡«ç§à©ž ?" to Mess
45127>>>>>>        Else   Move  "Œ˜ ˜¡¬¨é©à «ž¤ œ¡«ç§à©ž ?" to Mess
45129>>>>>>        Get YesNo_Box Mess "ƒ ˜¡¦§ã „§œ¥œ¨š˜©å˜ª" to rVal
45130>>>>>>        If (rVal=MBR_YES) Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
45133>>>>>>        Function_Return (Rval=MBR_YES)
45134>>>>>>    End_Function  // Report_Interrupt
45135>>>>>>
45135>>>>>>    Procedure Initialize_Output_Device
45136>>>>>>        string sopenpath
45137>>>>>>        get_attribute Df_Open_path to sopenpath
45140>>>>>>        set_attribute Df_Open_path to ""
45143>>>>>>        Direct_Output (Output_Device(current_Object))
45144>>>>>>        Set_Attribute DF_open_path to sopenpath
45147>>>>>>    End_procedure
45148>>>>>>
45148>>>>>>End_Class // WinReportSub
45149>>>>>>
45149>>>>
45149>>>>Class BasicReportFemSub is a BasicReportSub
45150>>>>
45150>>>>    Function Starting_Main_Report Returns Integer
45151>>>>        Integer   iRetVal iindexr14_1
45152>>>>        Forward Get Starting_Main_Report to iRetval
45154>>>>        If (Report_View_Id(Self)) Set piIsReportCancelled Of (Report_View_Id(Self)) to 0
45157>>>>        Function_Return iRetval
45158>>>>    End_Function
45159>>>>
45159>>>>    Procedure Ending_Report
45160>>>>        Integer isCancelled
45161>>>>        Get Cancelled_State         to isCancelled
45162>>>>        //If Already with error do not touch
45162>>>>        If (Report_View_Id(Self)) Begin
45164>>>>            If (piIsReportCancelled(Report_View_Id(Self))<>1) Begin
45166>>>>                Set piIsReportCancelled Of (Report_View_ID(Self)) to (isCancelled=1)
45167>>>>                Error 9999 '€¡ç¨à©ž „¡«ç§à©žª'
45168>>>>>
45168>>>>            End
45168>>>>>
45168>>>>            Else Error 7777 '‘­á¢£˜ ¡˜«á «ž¤ œ¡«ç§à©ž'
45170>>>>        End
45170>>>>>
45170>>>>        Forward Send Ending_Report
45172>>>>    End_Procedure
45173>>>>
45173>>>>    Procedure onError integer ErrNum integer Err_Line string ErrMsg
45174>>>>        If (Display_Error_State(Self)) Send End_Status
45177>>>>        Set piIsReportCancelled Of (Report_View_ID(Self)) to 1
45178>>>>        Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
45179>>>>>
45179>>>>    End_procedure
45180>>>>
45180>>>>    Function Report_Interrupt Returns Integer
45181>>>>        Integer rVal
45182>>>>        String Mess
45182>>>>        If (Error_Check_State(Current_Object)) ;            Move "„£­˜¤å©«ž¡œ œ¤˜ ©­á¢£˜ ¡˜«˜ «ž¤ œ§œ¥œ¨š˜©å˜. Œ˜ › ˜¡¦§œå ž œ¡«ç§à©ž ?" to Mess
45185>>>>        Else   Move  "Œ˜ ˜¡¬¨é©à «ž¤ œ¡«ç§à©ž ?" to Mess
45187>>>>        Get YesNo_Box Mess "ƒ ˜¡¦§ã „§œ¥œ¨š˜©å˜ª" to rVal
45188>>>>        If (rVal=MBR_YES) Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
45191>>>>        Function_Return (Rval=MBR_YES)
45192>>>>    End_Function  // Report_Interrupt
45193>>>>
45193>>>>
45193>>>>
45193>>>>End_Class
45194>>>>
45194>>>>Class WinReportFEMSub is a WinReportSUB
45195>>>>
45195>>>>    Function Starting_Main_Report Returns Integer
45196>>>>        Integer   iRetVal iindexr14_1
45197>>>>        Forward Get Starting_Main_Report to iRetval
45199>>>>        If (Report_View_Id(Self)) Set piIsReportCancelled Of (Report_View_Id(Self)) to 0
45202>>>>        Function_Return iRetval
45203>>>>    End_Function
45204>>>>
45204>>>>    Procedure Ending_Report
45205>>>>        Integer isCancelled
45206>>>>        Get Cancelled_State         to isCancelled
45207>>>>        //If Already with error do not touch
45207>>>>        If (Report_View_Id(Self)) Begin
45209>>>>            If (piIsReportCancelled(Report_View_Id(Self))<>1) Begin
45211>>>>                Set piIsReportCancelled Of (Report_View_ID(Self)) to (isCancelled=1)
45212>>>>                Error 9999 '€¡ç¨à©ž „¡«ç§à©žª'
45213>>>>>
45213>>>>            End
45213>>>>>
45213>>>>            Else Error 7777 '‘­á¢£˜ ¡˜«á «ž¤ œ¡«ç§à©ž'
45215>>>>        End
45215>>>>>
45215>>>>        Forward Send Ending_Report
45217>>>>    End_Procedure
45218>>>>
45218>>>>    Procedure onError integer ErrNum integer Err_Line string ErrMsg
45219>>>>        If (Display_Error_State(Self)) Send End_Status
45222>>>>        Set piIsReportCancelled Of (Report_View_ID(Self)) to 1
45223>>>>        Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
45224>>>>>
45224>>>>    End_procedure  
45225>>>>
45225>>>>    Function Report_Interrupt Returns Integer
45226>>>>        Integer rVal
45227>>>>        String Mess
45227>>>>        If (Error_Check_State(Current_Object)) ;            Move "„£­˜¤å©«ž¡œ œ¤˜ ©­á¢£˜ ¡˜«˜ «ž¤ œ§œ¥œ¨š˜©å˜. Œ˜ › ˜¡¦§œå ž œ¡«ç§à©ž ?" to Mess
45230>>>>        Else   Move  "Œ˜ ˜¡¬¨é©à «ž¤ œ¡«ç§à©ž ?" to Mess
45232>>>>        Get YesNo_Box Mess "ƒ ˜¡¦§ã „§œ¥œ¨š˜©å˜ª" to rVal
45233>>>>        If (rVal=MBR_YES) Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
45236>>>>        Function_Return (Rval=MBR_YES)
45237>>>>    End_Function  // Report_Interrupt
45238>>>>
45238>>>>End_Class
45239>>>>
45239>>
45239>        
45239>        //AB-ClientStoreTopEnd
45239>
45239>        //  Include all views
45239>
45239>        //  Include all reports
45239>        Use r6_4G.RV                                                                        
INCLUDING FILE: R6_4G.RV
45239>>>//AB/ Project r6_4G: hmerologiakes kinhsis pelatvn Hm
45239>>>//AB/     Object prj is a Report_Project
45239>>>//AB/         Set ProjectName to "r6_4G: hmerologiakes kinhsis pelatvn Hm"
45239>>>//AB/         Set ProjectFileName to "r6_4G.RV"
45239>>>
45239>>>// Project Object Structure
45239>>>//   r6_4G is a ReportViewSub
45239>>>//     GroupSub1 is a GroupSub
45239>>>//       frcustfrom is a FormSub
45239>>>//       frcustto is a FormSub
45239>>>//       TextBoxSub1 is a TextBoxSub
45239>>>//       TextBoxSub2 is a TextBoxSub
45239>>>//       FormSub5 is a FormSub
45239>>>//       FormSub6 is a FormSub
45239>>>//     GroupSub3 is a GroupSub
45239>>>//       FormSub3 is a FormSub
45239>>>//       FormSub4 is a FormSub
45239>>>//     GroupSub2 is a GroupSub
45239>>>//       FormSub1 is a FormSub
45239>>>//       FormSub2 is a FormSub
45239>>>//       TextBoxSub3 is a TextBoxSub
45239>>>//       TextBoxSub4 is a TextBoxSub
45239>>>//     RadioGroupSub5 is a RadioGroupSub
45239>>>//       Radio5 is a RadioSub
45239>>>//       Radio6 is a RadioSub
45239>>>//       Radio7 is a RadioSub
45239>>>//     RadioGroupSub3 is a RadioGroupSub
45239>>>//       RadioSub1 is a RadioSub
45239>>>//       RadioSub2 is a RadioSub
45239>>>//       TextBoxSub7 is a TextBoxSub
45239>>>//       TextBoxSub8 is a TextBoxSub
45239>>>//     RadioGroupSub4 is a RadioGroupSub
45239>>>//       RadioSub3 is a RadioSub
45239>>>//       RadioSub4 is a RadioSub
45239>>>//       TextBoxSub9 is a TextBoxSub
45239>>>//       TextBoxSub10 is a TextBoxSub
45239>>>//     LineControlSub1 is a LineControlSub
45239>>>//     ButtonSub1 is a ButtonSub
45239>>>//     ButtonSub2 is a ButtonSub
45239>>>//     Hmerologio_BasicReport is a BasicReport
45239>>>//       Ctypkin_DD is a Ctypkin_DataDictionary
45239>>>//       Hmgio_DD is a Hmgio_DataDictionary
45239>>>//       HmCtyp_DD is a HmCtyp_DataDictionary
45239>>>//       Cmoves_DD is a Cmoves_DataDictionary
45239>>>
45239>>>// Register all objects
45239>>>Register_Object ButtonSub1
45239>>>Register_Object ButtonSub2
45239>>>Register_Object Cmoves_DD
45239>>>Register_Object Ctypkin_DD
45239>>>Register_Object FormSub1
45239>>>Register_Object FormSub2
45239>>>Register_Object FormSub3
45239>>>Register_Object FormSub4
45239>>>Register_Object FormSub5
45239>>>Register_Object FormSub6
45239>>>Register_Object frcustfrom
45239>>>Register_Object frcustto
45239>>>Register_Object GroupSub1
45239>>>Register_Object GroupSub2
45239>>>Register_Object GroupSub3
45239>>>Register_Object HmCtyp_DD
45239>>>Register_Object Hmerologio_BasicReport
45239>>>Register_Object Hmgio_DD
45239>>>Register_Object LineControlSub1
45239>>>Register_Object Radio5
45239>>>Register_Object Radio6
45239>>>Register_Object Radio7
45239>>>Register_Object RadioGroupSub3
45239>>>Register_Object RadioGroupSub4
45239>>>Register_Object RadioGroupSub5
45239>>>Register_Object RadioSub1
45239>>>Register_Object RadioSub2
45239>>>Register_Object RadioSub3
45239>>>Register_Object RadioSub4
45239>>>Register_Object r6_4G
45239>>>Register_Object TextBoxSub1
45239>>>Register_Object TextBoxSub10
45239>>>Register_Object TextBoxSub2
45239>>>Register_Object TextBoxSub3
45239>>>Register_Object TextBoxSub4
45239>>>Register_Object TextBoxSub7
45239>>>Register_Object TextBoxSub8
45239>>>Register_Object TextBoxSub9
45239>>>
45239>>>
45239>>>//AB/     Report View
45239>>>
45239>>>
45239>>>    //AB-StoreTopStart
45239>>>    Use  cmoves.dd
INCLUDING FILE: CMOVES.DD
45239>>>>>//DDB-FileStart
45239>>>>>//DDB-HeaderStart
45239>>>>>
45239>>>>>// File Name : CMOVES.DD
45239>>>>>// Class Name: Cmoves_DataDictionary
45239>>>>>// Revision  : 143
45239>>>>>// Version   : 2
45239>>>>>
45239>>>>>Use  Windows           // Basic Definitions
45239>>>>>Use  DataDict          // DataDictionary Class Definition
45239>>>>>Use  DDvalTbl          // Validation Table Class Definitions
45239>>>>>
45239>>>>>Open Cmoves
45241>>>>>Open Copen
INCLUDING FILE: COPEN.FD
45243>>>>>Open Ctypkin
45245>>>>>Open Clients
45247>>>>>Open Sysrecc
45249>>>>>Open Syscurxr
45251>>>>>
45251>>>>>//DDB-HeaderEnd
45251>>>>>//DDB-SelectionStart
45251>>>>>//DDB/ ExternalSelectionList sl006  sl006.SL
45251>>>>>//DDB/ ExternalSelectionList slNomism  slnomism.sl
45251>>>>>//DDB/ ExternalSelectionList sl041  sl041.SL
45251>>>>>Register_Object sl006
45251>>>>>Register_Object slNomism
45251>>>>>Register_Object sl041
45251>>>>>//DDB-SelectionEnd
45251>>>>> 
45251>>>>>Use Payresp.DD
45251>>>>>Use PmsSxet.DD
INCLUDING FILE: PMSSXET.DD
45251>>>>>>>//DDB-FileStart
45251>>>>>>>//DDB-HeaderStart
45251>>>>>>>
45251>>>>>>>// File Name : PMSSXET.DD
45251>>>>>>>// Class Name: PmsSxet_DataDictionary
45251>>>>>>>// Revision  : 27
45251>>>>>>>// Version   : 2
45251>>>>>>>
45251>>>>>>>Use  Windows           // Basic Definitions
45251>>>>>>>Use  DataDict          // DataDictionary Class Definition
45251>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
45251>>>>>>>
45251>>>>>>>Open Pmssxet
INCLUDING FILE: PMSSXET.FD
45253>>>>>>>Open Pmoves
INCLUDING FILE: PMOVES.FD
45255>>>>>>>Open Psxetika
INCLUDING FILE: PSXETIKA.FD
45257>>>>>>>Open Pmoves
45259>>>>>>>
45259>>>>>>>//DDB-HeaderEnd
45259>>>>>>>
45259>>>>>>>Use bpEnYpol.dg
INCLUDING FILE: BPENYPOL.DG
45259>>>>>>>>>//AB/ Project bpEnYpol
45259>>>>>>>>>//AB/ Object prj is a Dialog_Project
45259>>>>>>>>>//AB/     Set ProjectName to "bpEnYpol"
45259>>>>>>>>>//AB/     Set ProjectFileName to "bpEnYpol.DG"
45259>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
45259>>>>>>>>>
45259>>>>>>>>>// Project Object Structure
45259>>>>>>>>>//   bpEnYpol is a BusinessProcessSub
45259>>>>>>>>>
45259>>>>>>>>>// Register all objects
45259>>>>>>>>>Register_Object bpEnYpol
45259>>>>>>>>>
45259>>>>>>>>>
45259>>>>>>>>>//AB-IgnoreStart
45259>>>>>>>>>
45259>>>>>>>>>Use Bproces.Sub
45259>>>>>>>>>
45259>>>>>>>>>
45259>>>>>>>>>//AB-IgnoreEnd
45259>>>>>>>>>
45259>>>>>>>>>Object bpEnYpol is a BusinessProcessSub
45261>>>>>>>>>
45261>>>>>>>>>    //AB-StoreTopStart
45261>>>>>>>>>
45261>>>>>>>>>    Open Pmoves
45263>>>>>>>>>    Open Psxetika
45265>>>>>>>>>
45265>>>>>>>>>    Set Status_Panel_State to False
45266>>>>>>>>>    //Set Allow_Cancel_State  to True
45266>>>>>>>>>    Set Display_Error_State to True
45267>>>>>>>>>    //Set Process_Title to "               "
45267>>>>>>>>>    //Set Status_Log_id to (status_log(Self)) //Use statlog.pkg
45267>>>>>>>>>    //Set Status_log_state to True
45267>>>>>>>>>
45267>>>>>>>>>    Property Integer    piFromAkyrosh       Public  0
45269>>>>>>>>>    Property Integer    piLathos            Public  0
45271>>>>>>>>>    Property Number     pnQty               Public  0
45273>>>>>>>>>    Property Integer    piCurrentPartl      Public  0
45275>>>>>>>>>    Property Integer    piCurrentPmoves     Public  0
45277>>>>>>>>>    Property Integer    piCurrentPmsSxet    Public  0
45279>>>>>>>>>    Property String     psRecr              Public ''
45281>>>>>>>>>
45281>>>>>>>>>
45281>>>>>>>>>    //AB-StoreTopEnd
45281>>>>>>>>>
45281>>>>>>>>>    Set Size to 60 100
45282>>>>>>>>>    Set Location to 4 5
45283>>>>>>>>>
45283>>>>>>>>>    //AB-DDOStart
45283>>>>>>>>>
45283>>>>>>>>>
45283>>>>>>>>>    //AB-DDOEnd
45283>>>>>>>>>
45283>>>>>>>>>
45283>>>>>>>>>    //AB-StoreStart
45283>>>>>>>>>
45283>>>>>>>>>    Function fiUpdate_Pmoves_Qty String asRecr Number anQty Integer aiDoNotOpen Returns Integer
45285>>>>>>>>>        Clear Pmoves
45286>>>>>>>>>        Move asRecr to Pmoves.Pms_Recr
45287>>>>>>>>>        Find Eq Pmoves by index.2
45288>>>>>>>>>>
45288>>>>>>>>>        If (Found) Begin
45290>>>>>>>>>            If ((Pmoves.Timol_Qty+anQty) > Pmoves.Pms_Qty)      Function_Return 40001
45293>>>>>>>>>            Else Begin
45294>>>>>>>>>                Add anQty to Pmoves.Timol_Qty
45295>>>>>>>>>                Move (Pmoves.Pms_Qty-Pmoves.Timol_Qty) to Pmoves.Timol_Ypol
45296>>>>>>>>>                If (Pmoves.Timol_Ypol>Pmoves.Pms_Qty)  Function_Return 40003
45299>>>>>>>>>                Saverecord Pmoves
45300>>>>>>>>>
45300>>>>>>>>>                Clear Particle
45301>>>>>>>>>                Move Pmoves.Partl_Recr to Particle.Partl_Recr
45302>>>>>>>>>                Find Eq Particle by Index.2
45303>>>>>>>>>>
45303>>>>>>>>>                If (Found) Begin
45305>>>>>>>>>                   // Reread
45305>>>>>>>>>                    Add anQty to Particle.Timol_Qty
45306>>>>>>>>>                    If (Particle.Partl_TotTem>0) Begin
45308>>>>>>>>>                        Move (Particle.Partl_TotTem-Particle.Timol_Qty)     to Particle.Timol_Ypol
45309>>>>>>>>>
45309>>>>>>>>>                        If (aiDoNotOpen=1)  Move 1                          to Particle.Partl_Timol
45312>>>>>>>>>                        Else                Move (Particle.Timol_Ypol=0 )   to Particle.Partl_Timol
45314>>>>>>>>>
45314>>>>>>>>>                    End
45314>>>>>>>>>>
45314>>>>>>>>>                    Else Move 0 to Particle.Partl_Timol
45316>>>>>>>>>                    Saverecord Particle
45317>>>>>>>>>                   // Unlock
45317>>>>>>>>>                End
45317>>>>>>>>>>
45317>>>>>>>>>                Else Function_Return 40002
45319>>>>>>>>>            End
45319>>>>>>>>>>
45319>>>>>>>>>        End
45319>>>>>>>>>>
45319>>>>>>>>>        Else Function_Return 40000
45321>>>>>>>>>        Function_Return 0
45322>>>>>>>>>    End_Function
45323>>>>>>>>>
45323>>>>>>>>>    Procedure OnProcess
45325>>>>>>>>>        Integer iLathos iSub iAkyro
45326>>>>>>>>>        String  sCurr sRecr sPmoveRecr sParticleRecr
45326>>>>>>>>>        Number  nQty nQty2
45326>>>>>>>>>
45326>>>>>>>>>        Set piLathos        to 0
45327>>>>>>>>>        Get pnQty           to nQty2
45328>>>>>>>>>        Get psRecr          to sRecr
45329>>>>>>>>>        Get piFromAkyrosh   to iAkyro
45330>>>>>>>>>
45330>>>>>>>>>        // An h posothta einai setarismenh thetika shmainei pos klhthike
45330>>>>>>>>>        // apo thn Update tou PmsSxet, allios an erthei arnhtikh apo thn Backout
45330>>>>>>>>>        // Prepei na to xeroume gia thn periptosh tou akyrotikou, opou tha trexei
45330>>>>>>>>>        // apanota h function kai tha antistrpsei to proshmo ths posothtas.
45330>>>>>>>>>        Move (nQty2<0)   to iSub
45331>>>>>>>>>
45331>>>>>>>>>
45331>>>>>>>>>        Get fiUpdate_Pmoves_Qty sRecr nQty2 0 to iLathos
45332>>>>>>>>>
45332>>>>>>>>>        If (iLathos) Begin
45334>>>>>>>>>            Set piLathos to iLathos
45335>>>>>>>>>            Procedure_Return
45336>>>>>>>>>        End
45336>>>>>>>>>>
45336>>>>>>>>>
45336>>>>>>>>>
45336>>>>>>>>>        // js 30/08/2002 Enhmerosh ena bhma pio piso sthn periptosh pou
45336>>>>>>>>>        // h enhmerosh ton pmoves apo backout kai update tou PmsSxet,
45336>>>>>>>>>        // afora Akyrotiko. (DAP --> TIM --> AKYROTIKO). Erxomaste dhladh edo apo
45336>>>>>>>>>        // AKYROTIKO na enhmerosoume tis posothtes tou TIMOLOGIOU.
45336>>>>>>>>>        // Sthn periptosh ayth prepei na kanoume ta exhs:
45336>>>>>>>>>        // 1. Eyresh ton sxetikon tou trxontos pmove TIMOLOGIOU
45336>>>>>>>>>        // 2. Antistrofh tou proshmou ths posothtas tous
45336>>>>>>>>>        // 3. Eyresh tou arxikou Pmoves (DAP) kai enhmerosh posothtas kinhshs
45336>>>>>>>>>
45336>>>>>>>>>        If (iAkyro) Begin
45338>>>>>>>>>            Clear Pmoves
45339>>>>>>>>>            Move sRecr to Pmoves.Pms_Recr
45340>>>>>>>>>            Find Eq Pmoves by index.2
45341>>>>>>>>>>
45341>>>>>>>>>            If (Found) Begin
45343>>>>>>>>>                Clear PmsSxet
45344>>>>>>>>>                Move sRecr to PmsSxet.Pms_Recr
45345>>>>>>>>>                Find Gt PmsSxet by Index.1
45346>>>>>>>>>>
45346>>>>>>>>>                While ((Found=1) And (PmsSxet.Pms_Recr=sRecr))
45350>>>>>>>>>                    Move PmsSxet.Sxetiko_Recr   to sCurr
45351>>>>>>>>>                    Move PmsSxet.Posothta       to nQty
45352>>>>>>>>>                    If (iSub) Begin
45354>>>>>>>>>                        // An Exei erthei apo Backout tou PmsSxet (to gnorizoume apo thn posothta
45354>>>>>>>>>                        // h opoia sto property einai arnhtikh) tote gyrname thn posothta tou
45354>>>>>>>>>                        // PmsSxet thetikh (Ousiastika thn afhnoume opos einai dhladh).
45354>>>>>>>>>                    End
45354>>>>>>>>>>
45354>>>>>>>>>                    Else Begin
45355>>>>>>>>>                        // An Exei erthei apo Update tou PmsSxet (to gnorizoume apo thn posothta
45355>>>>>>>>>                        // h opoia sto property einai thetikh) tote gyrname thn posothta tou
45355>>>>>>>>>                        // PmsSxet arnhtikh.
45355>>>>>>>>>                        Move (nQty*(-1)) to nQty
45356>>>>>>>>>                    End
45356>>>>>>>>>>
45356>>>>>>>>>
45356>>>>>>>>>                    //Get fiUpdate_Pmoves_Qty sCurr nQty 1 to iLathos
45356>>>>>>>>>                    // 07/01/2003 //
45356>>>>>>>>>                    Get fiUpdate_Pmoves_Qty sCurr nQty 0 to iLathos
45357>>>>>>>>>
45357>>>>>>>>>                    If (iLathos) Begin
45359>>>>>>>>>                        Set piLathos to (iLathos+3)
45360>>>>>>>>>                        // An Gyrisei Pmoves Not Found      (40000) To kanoume 40003
45360>>>>>>>>>                        // An Gyrisei problhma sto ypoloipo (40001) To kanoume 40004
45360>>>>>>>>>                        // An Gyrisei problhma sto particle (40002) To kanoume 40005
45360>>>>>>>>>                        // An Gyrisei problhma sto particle (40003) To kanoume 40006
45360>>>>>>>>>                        Procedure_Return
45361>>>>>>>>>                    End
45361>>>>>>>>>>
45361>>>>>>>>>
45361>>>>>>>>>                    Clear PmsSxet
45362>>>>>>>>>                    Move sRecr      to PmsSxet.Pms_Recr
45363>>>>>>>>>                    Move sCurr      to PmsSxet.Sxetiko_Recr
45364>>>>>>>>>                    Find Eq PmsSxet by Index.1
45365>>>>>>>>>>
45365>>>>>>>>>                    Find Gt PmsSxet by Index.1
45366>>>>>>>>>>
45366>>>>>>>>>                Loop
45367>>>>>>>>>>
45367>>>>>>>>>            End
45367>>>>>>>>>>
45367>>>>>>>>>            Else Set piLathos to 40007
45369>>>>>>>>>        End
45369>>>>>>>>>>
45369>>>>>>>>>
45369>>>>>>>>>        If (piLathos(Self)<>0) Procedure_Return
45372>>>>>>>>>
45372>>>>>>>>>    End_Procedure
45373>>>>>>>>>
45373>>>>>>>>>    Procedure OnError integer error_info string errMsg
45375>>>>>>>>>    End_Procedure
45376>>>>>>>>>
45376>>>>>>>>>    Procedure Start_Process
45378>>>>>>>>>        Forward Send Start_Process
45380>>>>>>>>>    End_Procedure
45381>>>>>>>>>
45381>>>>>>>>>    Procedure End_Process
45383>>>>>>>>>        Forward Send End_Process
45385>>>>>>>>>        If (piCurrentPartl(Self)) Begin
45387>>>>>>>>>            Clear Particle
45388>>>>>>>>>            Move (piCurrentPartl(Self)) to Particle.Recnum
45389>>>>>>>>>            Find Eq Particle.Recnum
45390>>>>>>>>>>
45390>>>>>>>>>        End
45390>>>>>>>>>>
45390>>>>>>>>>        If (piCurrentPmoves(Self)) Begin
45392>>>>>>>>>            Clear Pmoves
45393>>>>>>>>>            Move (piCurrentPmoves(Self)) to Pmoves.Recnum
45394>>>>>>>>>            Find Eq Pmoves.Recnum
45395>>>>>>>>>>
45395>>>>>>>>>        End
45395>>>>>>>>>>
45395>>>>>>>>>        If (piCurrentPmsSxet(Self)<>0) Begin
45397>>>>>>>>>            Clear PmsSxet
45398>>>>>>>>>            Move (piCurrentPmsSxet(Self)) to PmsSxet.Recnum
45399>>>>>>>>>            Find Eq PmsSxet.Recnum
45400>>>>>>>>>>
45400>>>>>>>>>        End
45400>>>>>>>>>>
45400>>>>>>>>>    End_Procedure
45401>>>>>>>>>
45401>>>>>>>>>    //AB-StoreEnd
45401>>>>>>>>>
45401>>>>>>>>>End_Object    // bpEnYpol
45402>>>>>>>>>
45402>>>>>>>>>//AB/ End_Object    // prj
45402>>>>>>>Use MyArray.dg
INCLUDING FILE: MYARRAY.DG
45402>>>>>>>>>//AB/ Project MyArray
45402>>>>>>>>>//AB/     Object prj is a Dialog_Project
45402>>>>>>>>>//AB/         Set ProjectName to "MyArray"
45402>>>>>>>>>//AB/         Set ProjectFileName to "MyArray.DG"
45402>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
45402>>>>>>>>>
45402>>>>>>>>>// Project Object Structure
45402>>>>>>>>>//   Psx_Array is a BusinessProcessSub
45402>>>>>>>>>//     Ctypkin_DD2 is a Ctypkin_DataDictionary
45402>>>>>>>>>//     Wtypkin_DD2 is a Wtypkin_DataDictionary
45402>>>>>>>>>//     Ptyppar_DD2 is a Ptyppar_DataDictionary
45402>>>>>>>>>//     Country_DD2 is a Country_DataDictionary
45402>>>>>>>>>//     Towns_DD2 is a Towns_DataDictionary
45402>>>>>>>>>//     Cities_DD2 is a Cities_DataDictionary
45402>>>>>>>>>//     Areas_DD2 is a Areas_DataDictionary
45402>>>>>>>>>//     Payresp_DD2 is a Payresp_DataDictionary
45402>>>>>>>>>//     Clients_DD2 is a Clients_DataDictionary
45402>>>>>>>>>//     Nomisma_DD2 is a Nomisma_DataDictionary
45402>>>>>>>>>//     Particle_DD2 is a Particle_DataDictionary
45402>>>>>>>>>//     Ctypkin_DD is a Ctypkin_DataDictionary
45402>>>>>>>>>//     Wtypkin_DD is a Wtypkin_DataDictionary
45402>>>>>>>>>//     Ptyppar_DD is a Ptyppar_DataDictionary
45402>>>>>>>>>//     Country_DD is a Country_DataDictionary
45402>>>>>>>>>//     Towns_DD is a Towns_DataDictionary
45402>>>>>>>>>//     Cities_DD is a Cities_DataDictionary
45402>>>>>>>>>//     Areas_DD is a Areas_DataDictionary
45402>>>>>>>>>//     Payresp_DD is a Payresp_DataDictionary
45402>>>>>>>>>//     Clients_DD is a Clients_DataDictionary
45402>>>>>>>>>//     Nomisma_DD is a Nomisma_DataDictionary
45402>>>>>>>>>//     Particle_DD is a Particle_DataDictionary
45402>>>>>>>>>//     Psxetika_DD is a Psxetika_DataDictionary
45402>>>>>>>>>
45402>>>>>>>>>// Register all objects
45402>>>>>>>>>Register_Object Areas_DD
45402>>>>>>>>>Register_Object Areas_DD2
45402>>>>>>>>>Register_Object Cities_DD
45402>>>>>>>>>Register_Object Cities_DD2
45402>>>>>>>>>Register_Object Clients_DD
45402>>>>>>>>>Register_Object Clients_DD2
45402>>>>>>>>>Register_Object Country_DD
45402>>>>>>>>>Register_Object Country_DD2
45402>>>>>>>>>Register_Object Ctypkin_DD
45402>>>>>>>>>Register_Object Ctypkin_DD2
45402>>>>>>>>>Register_Object Nomisma_DD
45402>>>>>>>>>Register_Object Nomisma_DD2
45402>>>>>>>>>Register_Object Particle_DD
45402>>>>>>>>>Register_Object Particle_DD2
45402>>>>>>>>>Register_Object Payresp_DD
45402>>>>>>>>>Register_Object Payresp_DD2
45402>>>>>>>>>Register_Object Psx_Array
45402>>>>>>>>>Register_Object Psxetika_DD
45402>>>>>>>>>Register_Object Ptyppar_DD
45402>>>>>>>>>Register_Object Ptyppar_DD2
45402>>>>>>>>>Register_Object Towns_DD
45402>>>>>>>>>Register_Object Towns_DD2
45402>>>>>>>>>Register_Object Wtypkin_DD
45402>>>>>>>>>Register_Object Wtypkin_DD2
45402>>>>>>>>>
45402>>>>>>>>>
45402>>>>>>>>>
45402>>>>>>>>>    //AB-StoreTopStart
45402>>>>>>>>>
45402>>>>>>>>>    Use CTYPKIN.DD
45402>>>>>>>>>    Use WTYPKIN.DD
INCLUDING FILE: WTYPKIN.DD
45402>>>>>>>>>>>//DDB-FileStart
45402>>>>>>>>>>>//DDB-HeaderStart
45402>>>>>>>>>>>
45402>>>>>>>>>>>// File Name : WTYPKIN.DD
45402>>>>>>>>>>>// Class Name: Wtypkin_DataDictionary
45402>>>>>>>>>>>// Revision  : 49
45402>>>>>>>>>>>// Version   : 2
45402>>>>>>>>>>>
45402>>>>>>>>>>>Use  Windows           // Basic Definitions
45402>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
45402>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
45402>>>>>>>>>>>
45402>>>>>>>>>>>Open Wtypkin
45404>>>>>>>>>>>Open Ptyppar
45406>>>>>>>>>>>Open Wcmoves
INCLUDING FILE: WCMOVES.FD
45408>>>>>>>>>>>Open Hmwtyp
INCLUDING FILE: HMWTYP.FD
45410>>>>>>>>>>>Open Wflagkin
INCLUDING FILE: WFLAGKIN.FD
45412>>>>>>>>>>>Open Sysrecw
45414>>>>>>>>>>>Open Syscurxr
45416>>>>>>>>>>>
45416>>>>>>>>>>>//DDB-HeaderEnd
45416>>>>>>>>>>>//DDB-ValidationStart
45416>>>>>>>>>>>
45416>>>>>>>>>>>Register_Object Wtypkin_Wtypkin_Module_VT
45416>>>>>>>>>>>
45416>>>>>>>>>>>Object Wtypkin_Wtypkin_Module_VT  is a CodeValidationTable
45418>>>>>>>>>>>    Set Type_Value        To "MODULE"
45419>>>>>>>>>>>    //DDB-ValidationCustomStart
45419>>>>>>>>>>>    //DDB-ValidationCustomEnd
45419>>>>>>>>>>>End_Object   // Wtypkin_Wtypkin_Module_VT
45420>>>>>>>>>>>//DDB-ValidationEnd
45420>>>>>>>>>>>//DDB-SelectionStart
45420>>>>>>>>>>>//DDB/ ExternalSelectionList sl029a  sl029a.SL
45420>>>>>>>>>>>Register_Object sl029a
45420>>>>>>>>>>>//DDB-SelectionEnd
45420>>>>>>>>>>>
45420>>>>>>>>>>>Class Wtypkin_DataDictionary  is a DataDictionary
45421>>>>>>>>>>>               
45421>>>>>>>>>>>    Procedure Construct_Object
45422>>>>>>>>>>>        Forward Send Construct_Object
45424>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
45425>>>>>>>>>>>    End_Procedure
45426>>>>>>>>>>>
45426>>>>>>>>>>>    Procedure Save_Main_File
45427>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
45429>>>>>>>>>>>            If Wtypkin.Recnum Eq 0 Procedure_Return
45432>>>>>>>>>>>        End
45432>>>>>>>>>>>>
45432>>>>>>>>>>>        Forward Send Save_Main_File
45434>>>>>>>>>>>    End_Procedure
45435>>>>>>>>>>>
45435>>>>>>>>>>>
45435>>>>>>>>>>>     Procedure Creating
45436>>>>>>>>>>>        Forward Send Creating
45438>>>>>>>>>>>        // Insert Code Here
45438>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wtypkin.Wtypkin_Rec0)))))) to Wtypkin.Wtypkin_Recr
45439>>>>>>>>>>>    End_Procedure   // Creating
45440>>>>>>>>>>>
45440>>>>>>>>>>>    // Define_Fields:
45440>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
45440>>>>>>>>>>>
45440>>>>>>>>>>>    Procedure Define_Fields
45441>>>>>>>>>>>        Forward Send Define_Fields
45443>>>>>>>>>>>        //DDB-Generated-Code-Location
45443>>>>>>>>>>>        //DDB-DefineFieldStart
45443>>>>>>>>>>>
45443>>>>>>>>>>>        Set Main_File            To Wtypkin.File_Number
45444>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
45445>>>>>>>>>>>
45445>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
45446>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
45447>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
45448>>>>>>>>>>>
45448>>>>>>>>>>>        // Child (Client) file structure................
45448>>>>>>>>>>>        Send Add_Client_File  Ptyppar.File_Number
45449>>>>>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
45450>>>>>>>>>>>        Send Add_Client_File  Hmwtyp.File_Number
45451>>>>>>>>>>>        Send Add_Client_File  Wflagkin.File_Number
45452>>>>>>>>>>>
45452>>>>>>>>>>>        // External (System) file structure.............
45452>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
45453>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
45454>>>>>>>>>>>
45454>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Wtypkin_Rec0  To Wtypkin.Wtypkin_Rec0
45457>>>>>>>>>>>
45457>>>>>>>>>>>        // Field-based properties.......................
45457>>>>>>>>>>>
45457>>>>>>>>>>>        // Wtypkin.Company_Code
45457>>>>>>>>>>>
45457>>>>>>>>>>>        // Wtypkin.Branch_Code
45457>>>>>>>>>>>
45457>>>>>>>>>>>        // Wtypkin.Year_Year
45457>>>>>>>>>>>
45457>>>>>>>>>>>        // Wtypkin.Wtypkin_Code
45457>>>>>>>>>>>        Set Field_Options          Field Wtypkin.Wtypkin_Code To DD_AUTOFIND   
45458>>>>>>>>>>>        Set Field_Prompt_Object    Field Wtypkin.Wtypkin_Code To (sl029a(Self))
45459>>>>>>>>>>>        Set Key_Field_State        Field Wtypkin.Wtypkin_Code To TRUE
45460>>>>>>>>>>>
45460>>>>>>>>>>>        // Wtypkin.Wtypkin_Rec0
45460>>>>>>>>>>>        Set Field_Options          Field Wtypkin.Wtypkin_Rec0 To DD_AUTOFIND   
45461>>>>>>>>>>>
45461>>>>>>>>>>>        // Wtypkin.Wtypkin_Recr
45461>>>>>>>>>>>
45461>>>>>>>>>>>        // Wtypkin.Year_Recr
45461>>>>>>>>>>>
45461>>>>>>>>>>>        // Wtypkin.Wtypkin_Descr
45461>>>>>>>>>>>        Set Field_Prompt_Object    Field Wtypkin.Wtypkin_Descr To (sl029a(Self))
45462>>>>>>>>>>>
45462>>>>>>>>>>>        // Wtypkin.Wtypkin_Anti
45462>>>>>>>>>>>
45462>>>>>>>>>>>        // Wtypkin.Wtypkin_Module
45462>>>>>>>>>>>        Set Field_Value_Table      Field Wtypkin.Wtypkin_Module To (Wtypkin_Wtypkin_Module_VT(Self))
45463>>>>>>>>>>>
45463>>>>>>>>>>>        // Wtypkin.Max_Days_Sx_Par
45463>>>>>>>>>>>
45463>>>>>>>>>>>        //DDB-DefineFieldEnd
45463>>>>>>>>>>>    End_Procedure    // Define_Fields
45464>>>>>>>>>>>
45464>>>>>>>>>>>    // Field_Defaults:
45464>>>>>>>>>>>    // This procedure is used to establish default field values.
45464>>>>>>>>>>>
45464>>>>>>>>>>>    Procedure Field_Defaults
45465>>>>>>>>>>>        Forward Send Field_Defaults
45467>>>>>>>>>>>        //DDB-Generated-Code-Location
45467>>>>>>>>>>>        //DDB-FieldDefaultStart
45467>>>>>>>>>>>        //DDB-FieldDefaultEnd
45467>>>>>>>>>>>    End_Procedure    // Field_Defaults
45468>>>>>>>>>>>
45468>>>>>>>>>>>End_Class    // Wtypkin_DataDictionary
45469>>>>>>>>>>>//DDB-Selection-pkg-Start
45469>>>>>>>>>>>
45469>>>>>>>>>>>Use sl029a.SL        // sl029a
INCLUDING FILE: SL029A.SL
45469>>>>>>>>>>>>>//AB/ Project sl029a:wtypkin
45469>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
45469>>>>>>>>>>>>>//AB/         Set ProjectName to "sl029a:wtypkin"
45469>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl029a.SL"
45469>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
45469>>>>>>>>>>>>>
45469>>>>>>>>>>>>>// Project Object Structure
45469>>>>>>>>>>>>>//   sl029a is a dbModalPanelSub
45469>>>>>>>>>>>>>//     Wtypkin_DD is a DataDictionary
45469>>>>>>>>>>>>>//     oSelList is a dbListSub
45469>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
45469>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
45469>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
45469>>>>>>>>>>>>>
45469>>>>>>>>>>>>>// Register all objects
45469>>>>>>>>>>>>>Register_Object oCancel_bn
45469>>>>>>>>>>>>>Register_Object oOK_bn
45469>>>>>>>>>>>>>Register_Object oSearch_bn
45469>>>>>>>>>>>>>Register_Object oSelList
45469>>>>>>>>>>>>>Register_Object sl029a
45469>>>>>>>>>>>>>Register_Object Wtypkin_DD
45469>>>>>>>>>>>>>
45469>>>>>>>>>>>>>
45469>>>>>>>>>>>>>    //AB-IgnoreStart
45469>>>>>>>>>>>>>
45469>>>>>>>>>>>>>    Use DFAllEnt.pkg
45469>>>>>>>>>>>>>    Use dbList.Sub
45469>>>>>>>>>>>>>    Use Button.Sub
45469>>>>>>>>>>>>>
45469>>>>>>>>>>>>>
45469>>>>>>>>>>>>>    Use WTYPKIN.DD
45469>>>>>>>>>>>>>    
45469>>>>>>>>>>>>>    //AB-IgnoreEnd
45469>>>>>>>>>>>>>
45469>>>>>>>>>>>>>    Object sl029a is a dbModalPanelSub
45471>>>>>>>>>>>>>        set label to "Ž¨ ©£æª ‰ ¤ã©œà¤ €§¦Ÿã¡žª" 
45472>>>>>>>>>>>>>        Set Size to 148 297
45473>>>>>>>>>>>>>        Set Location to 4 5
45474>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
45475>>>>>>>>>>>>>        Set Modal_State to FALSE
45476>>>>>>>>>>>>>
45476>>>>>>>>>>>>>        //AB-DDOStart
45476>>>>>>>>>>>>>
45476>>>>>>>>>>>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
45478>>>>>>>>>>>>>        End_Object    // Wtypkin_DD
45479>>>>>>>>>>>>>
45479>>>>>>>>>>>>>        Set Main_DD to (Wtypkin_DD(self))
45480>>>>>>>>>>>>>        Set Server to (Wtypkin_DD(self))
45481>>>>>>>>>>>>>
45481>>>>>>>>>>>>>        //AB-DDOEnd
45481>>>>>>>>>>>>>
45481>>>>>>>>>>>>>        Object oSelList is a dbListSub
45483>>>>>>>>>>>>>            Set Main_File to Wtypkin.File_Number
45484>>>>>>>>>>>>>            Set Size to 105 280
45485>>>>>>>>>>>>>            Set Location to 6 6
45486>>>>>>>>>>>>>
45486>>>>>>>>>>>>>            Begin_Row
45489>>>>>>>>>>>>>                Entry_Item Wtypkin.Wtypkin_code
45490>>>>>>>>>>>>>                Entry_Item Wtypkin.Wtypkin_descr
45491>>>>>>>>>>>>>            End_Row
45496>>>>>>>>>>>>>
45496>>>>>>>>>>>>>            Set Form_Width    item 0 to 60
45497>>>>>>>>>>>>>            set header_label  item 0 to "‰à› ¡¦ª" 
45498>>>>>>>>>>>>>            
45498>>>>>>>>>>>>>            Set Form_Width    item 1 to 212
45499>>>>>>>>>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
45500>>>>>>>>>>>>>            
45500>>>>>>>>>>>>>        End_Object    // oSelList
45501>>>>>>>>>>>>>
45501>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
45503>>>>>>>>>>>>>            set label to "&„§ ¢¦šã" 
45504>>>>>>>>>>>>>            Set Location to 115 126
45505>>>>>>>>>>>>>
45505>>>>>>>>>>>>>            //AB-StoreStart
45505>>>>>>>>>>>>>            Procedure OnClick
45507>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
45508>>>>>>>>>>>>>            End_Procedure
45509>>>>>>>>>>>>>            //AB-StoreEnd
45509>>>>>>>>>>>>>
45509>>>>>>>>>>>>>        End_Object    // oOK_bn
45510>>>>>>>>>>>>>
45510>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
45512>>>>>>>>>>>>>            set label to "&€¡ç¨à©ž" 
45513>>>>>>>>>>>>>            Set Location to 115 181
45514>>>>>>>>>>>>>
45514>>>>>>>>>>>>>            //AB-StoreStart
45514>>>>>>>>>>>>>            Procedure OnClick
45516>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
45517>>>>>>>>>>>>>            End_Procedure
45518>>>>>>>>>>>>>            //AB-StoreEnd
45518>>>>>>>>>>>>>
45518>>>>>>>>>>>>>        End_Object    // oCancel_bn
45519>>>>>>>>>>>>>
45519>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
45521>>>>>>>>>>>>>            set label to "€&¤˜ã«ž©ž" 
45522>>>>>>>>>>>>>            Set Location to 115 236
45523>>>>>>>>>>>>>
45523>>>>>>>>>>>>>            //AB-StoreStart
45523>>>>>>>>>>>>>            Procedure OnClick
45525>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
45526>>>>>>>>>>>>>            End_Procedure
45527>>>>>>>>>>>>>            //AB-StoreEnd
45527>>>>>>>>>>>>>
45527>>>>>>>>>>>>>        End_Object    // oSearch_bn
45528>>>>>>>>>>>>>
45528>>>>>>>>>>>>>
45528>>>>>>>>>>>>>        //AB-StoreStart
45528>>>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
45529>>>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
45530>>>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
45531>>>>>>>>>>>>>        //AB-StoreEnd
45531>>>>>>>>>>>>>
45531>>>>>>>>>>>>>    End_Object    // sl029a
45532>>>>>>>>>>>>>
45532>>>>>>>>>>>>>//AB/     End_Object    // prj
45532>>>>>>>>>>>
45532>>>>>>>>>>>//DDB-Selection-pkg-End
45532>>>>>>>>>>>//DDB-FileEnd
45532>>>>>>>>>    Use PTYPPAR.DD
INCLUDING FILE: PTYPPAR.DD
45532>>>>>>>>>>>//DDB-FileStart
45532>>>>>>>>>>>//DDB-HeaderStart
45532>>>>>>>>>>>
45532>>>>>>>>>>>// File Name : PTYPPAR.DD
45532>>>>>>>>>>>// Class Name: Ptyppar_DataDictionary
45532>>>>>>>>>>>// Revision  : 88
45532>>>>>>>>>>>// Version   : 2
45532>>>>>>>>>>>
45532>>>>>>>>>>>Use  Windows           // Basic Definitions
45532>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
45532>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
45532>>>>>>>>>>>
45532>>>>>>>>>>>Open Ptyppar
45534>>>>>>>>>>>Open Particle
45536>>>>>>>>>>>Open Pseira
INCLUDING FILE: PSEIRA.FD
45538>>>>>>>>>>>Open Ptypmet
INCLUDING FILE: PTYPMET.FD
45540>>>>>>>>>>>Open Ptypparh
INCLUDING FILE: PTYPPARH.FD
45542>>>>>>>>>>>Open Ctypkin
45544>>>>>>>>>>>Open Wtypkin
45546>>>>>>>>>>>Open Sysrecp
INCLUDING FILE: SYSRECP.FD
45548>>>>>>>>>>>Open Syscurxr
45550>>>>>>>>>>>
45550>>>>>>>>>>>//DDB-HeaderEnd
45550>>>>>>>>>>>//DDB-ValidationStart
45550>>>>>>>>>>>
45550>>>>>>>>>>>Register_Object Ptyppar_Year_Recr_VT
45550>>>>>>>>>>>Register_Object Ptyppar_Ptyppar_Is_What_VT
45550>>>>>>>>>>>Register_Object Ptyppar_Ptyppar_Module_VT
45550>>>>>>>>>>>Register_Object Ptyppar_Ti_Typonei_Pms_VT1
45550>>>>>>>>>>>
45550>>>>>>>>>>>Object Ptyppar_Year_Recr_VT  is a DescriptionValidationTable
45552>>>>>>>>>>>    Set Allow_Blank_State To TRUE
45553>>>>>>>>>>>
45553>>>>>>>>>>>    Procedure Fill_List
45555>>>>>>>>>>>        Forward Send Fill_List
45557>>>>>>>>>>>        Send Add_Table_Value  ""  "ƒœ¤ ‘¬££œ«â®œ "
45558>>>>>>>>>>>        Send Add_Table_Value  "1"  "¨¦©Ÿœ« ¡á"
45559>>>>>>>>>>>        Send Add_Table_Value  "2"  "€­˜ ¨œ« ¡á"
45560>>>>>>>>>>>    End_Procedure    // Fill_List
45561>>>>>>>>>>>    //DDB-ValidationCustomStart
45561>>>>>>>>>>>    //DDB-ValidationCustomEnd
45561>>>>>>>>>>>End_Object   // Ptyppar_Year_Recr_VT
45562>>>>>>>>>>>
45562>>>>>>>>>>>Object Ptyppar_Ptyppar_Is_What_VT  is a DescriptionValidationTable
45564>>>>>>>>>>>
45564>>>>>>>>>>>    Procedure Fill_List
45566>>>>>>>>>>>        Forward Send Fill_List
45568>>>>>>>>>>>        Send Add_Table_Value  "1"  "€š¦¨á"
45569>>>>>>>>>>>        Send Add_Table_Value  "2"  "é¢ž©ž"
45570>>>>>>>>>>>        Send Add_Table_Value  "3"  "€ŠŠŽ"
45571>>>>>>>>>>>    End_Procedure    // Fill_List
45572>>>>>>>>>>>    //DDB-ValidationCustomStart
45572>>>>>>>>>>>    //DDB-ValidationCustomEnd
45572>>>>>>>>>>>End_Object   // Ptyppar_Ptyppar_Is_What_VT
45573>>>>>>>>>>>
45573>>>>>>>>>>>Object Ptyppar_Ptyppar_Module_VT  is a CodeValidationTable
45575>>>>>>>>>>>    Set Type_Value        To "MODULE"
45576>>>>>>>>>>>    Set Allow_Blank_State To TRUE
45577>>>>>>>>>>>    //DDB-ValidationCustomStart
45577>>>>>>>>>>>    //DDB-ValidationCustomEnd
45577>>>>>>>>>>>End_Object   // Ptyppar_Ptyppar_Module_VT
45578>>>>>>>>>>>
45578>>>>>>>>>>>Object Ptyppar_Ti_Typonei_Pms_VT1  is a DescriptionValidationTable
45580>>>>>>>>>>>    Set Allow_Blank_State To TRUE
45581>>>>>>>>>>>
45581>>>>>>>>>>>    Procedure Fill_List
45583>>>>>>>>>>>        Forward Send Fill_List
45585>>>>>>>>>>>        Send Add_Table_Value  ""  "¦©æ«ž«œª ¡˜  €¥åœª"
45586>>>>>>>>>>>        Send Add_Table_Value  "1"  "¦©æ«ž«œª"
45587>>>>>>>>>>>        Send Add_Table_Value  "2"  "€¥åœª"
45588>>>>>>>>>>>    End_Procedure    // Fill_List
45589>>>>>>>>>>>    //DDB-ValidationCustomStart
45589>>>>>>>>>>>    //DDB-ValidationCustomEnd
45589>>>>>>>>>>>End_Object   // Ptyppar_Ti_Typonei_Pms_VT1
45590>>>>>>>>>>>//DDB-ValidationEnd
45590>>>>>>>>>>>//DDB-SelectionStart
45590>>>>>>>>>>>//DDB/ ExternalSelectionList sl012  sl012.SL
45590>>>>>>>>>>>Register_Object sl012
45590>>>>>>>>>>>//DDB-SelectionEnd
45590>>>>>>>>>>>
45590>>>>>>>>>>>Class Ptyppar_DataDictionary  is a DataDictionary_Sec
45591>>>>>>>>>>>
45591>>>>>>>>>>>    Procedure Construct_Object
45592>>>>>>>>>>>        Forward Send Construct_Object
45594>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
45595>>>>>>>>>>>        Property Integer piOldCtypkin       Public 0
45596>>>>>>>>>>>        Property Integer piOldWtypkin       Public 0
45597>>>>>>>>>>>    End_Procedure
45598>>>>>>>>>>>
45598>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
45599>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
45601>>>>>>>>>>>        Set piOldCtypkin to Ctypkin.Ctypkin_Code
45602>>>>>>>>>>>        Set piOldWtypkin to Wtypkin.Wtypkin_Code
45603>>>>>>>>>>>    End_Procedure   // New_Current_Record
45604>>>>>>>>>>>
45604>>>>>>>>>>>    Procedure OnConstrain
45605>>>>>>>>>>>        If (piMustNotConstrain(Self)=0) Begin
45607>>>>>>>>>>>            Constrain Ptyppar.Company_Code  eq SysCurXR.Company_Code
45609>>>>>>>>>>>            Constrain Ptyppar.Branch_Code   eq SysCurXR.Branch_Code
45611>>>>>>>>>>>        End
45611>>>>>>>>>>>>
45611>>>>>>>>>>>    End_Procedure
45612>>>>>>>>>>>
45612>>>>>>>>>>>    Procedure Clear_Main_File
45613>>>>>>>>>>>        Forward Send Clear_Main_File
45615>>>>>>>>>>>        Set piOldCtypkin to 0
45616>>>>>>>>>>>        Set piOldWtypkin to 0
45617>>>>>>>>>>>    End_Procedure
45618>>>>>>>>>>>
45618>>>>>>>>>>>    Procedure Save_Main_File
45619>>>>>>>>>>>        Integer isAdmin iYes
45620>>>>>>>>>>>        String  sStr
45620>>>>>>>>>>>        Get fig_Is_Admin to isAdmin
45621>>>>>>>>>>>
45621>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
45623>>>>>>>>>>>            If Ptyppar.Recnum Eq 0 Procedure_Return
45626>>>>>>>>>>>        End
45626>>>>>>>>>>>>
45626>>>>>>>>>>>        If (Operation_Origin=Self) Begin
45628>>>>>>>>>>>            If ((piOldCtypkin(Self)<>0) And (piOldCtypkin(Self)<>Ctypkin.Ctypkin_Code)) Begin
45630>>>>>>>>>>>                If (Not(isAdmin)) Error 1001 'ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ¡å¤ž©žª §œ¢á«ž'
45633>>>>>>>>>>>                Else Begin
45634>>>>>>>>>>>                    Move '' to sStr
45635>>>>>>>>>>>                    Append sStr '€¤ ˜¢¢á¥œ«œ ¡å¤ž©ž, £§¦¨œå ¤˜ œ§ž¨œá©œ  ã›ž ¡˜«˜®à¨ž£â¤˜ §˜¨˜©«˜« ¡á\n «˜ ¦§¦å˜ â®¦¬¤ ­« ˜®«œå £œ « ª §˜¢ âª ¡ ¤ã©œ ª §¦¬ «é¨˜ ˜¢¢áœ«œ\n„å©«œ ™â™˜ ¦  §àª Ÿâ¢œ«œ ¤˜ ©¬¤œ®å©à ?'
45636>>>>>>>>>>>                    Get YesNo_Box sStr to iYes
45637>>>>>>>>>>>                    If (iYes=MBR_NO) Error 1000 '€¡¬¨éŸž¡œ ž › ˜› ¡˜©å˜ ˜¢¢˜šãª ˜§¦ «¦¤ ®¨ã©«ž'
45640>>>>>>>>>>>                End
45640>>>>>>>>>>>>
45640>>>>>>>>>>>            End // If ((piOldCtypkin(Self)<>0) And (piOldCtypkin(Self)<>Ctypkin.Ctypkin_Code))
45640>>>>>>>>>>>>
45640>>>>>>>>>>>            If ((piOldWtypkin(Self)<>0) And (piOldWtypkin(Self)<>Wtypkin.Wtypkin_Code)) Begin
45642>>>>>>>>>>>                If (Not(isAdmin)) Error 1002 'ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ¡å¤ž©žª ˜§¦Ÿã¡žª'
45645>>>>>>>>>>>                Else Begin
45646>>>>>>>>>>>                    Move '' to sStr
45647>>>>>>>>>>>                    Append sStr '€¤ ˜¢¢á¥œ«œ ¡å¤ž©ž, £§¦¨œå ¤˜ œ§ž¨œá©œ  ã›ž ¡˜«˜®à¨ž£â¤˜ §˜¨˜©«˜« ¡á\n «˜ ¦§¦å˜ â®¦¬¤ ­« ˜®«œå £œ « ª §˜¢ âª ¡ ¤ã©œ ª §¦¬ «é¨˜ ˜¢¢áœ«œ\n„å©«œ ™â™˜ ¦  §àª Ÿâ¢œ«œ ¤˜ ©¬¤œ®å©à ?'
45648>>>>>>>>>>>                    Get YesNo_Box sStr to iYes
45649>>>>>>>>>>>                    If (iYes=MBR_NO) Error 1000 '€¡¬¨éŸž¡œ ž › ˜› ¡˜©å˜ ˜¢¢˜šãª ˜§¦ «¦¤ ®¨ã©«ž'
45652>>>>>>>>>>>                End
45652>>>>>>>>>>>>
45652>>>>>>>>>>>            End // ((piOldWtypkin(Self)<>0) And (piOldWtypkin(Self)<>Wtypkin.Wtypkin_Code))
45652>>>>>>>>>>>>
45652>>>>>>>>>>>        End // If (Operation_Origin=Self)
45652>>>>>>>>>>>>
45652>>>>>>>>>>>        Forward Send Save_Main_File
45654>>>>>>>>>>>    End_Procedure // Save_Main_File
45655>>>>>>>>>>>
45655>>>>>>>>>>>
45655>>>>>>>>>>>    Procedure Update
45656>>>>>>>>>>>        Forward Send Update
45658>>>>>>>>>>>        // Insert Code Here
45658>>>>>>>>>>>//        If (piMustNotConstrain(Self)=0) Begin
45658>>>>>>>>>>>            Move SysCurXR.Company_Code  to Ptyppar.Company_Code
45659>>>>>>>>>>>            Move SysCurXR.Branch_Code   to Ptyppar.Branch_Code
45660>>>>>>>>>>>//        end
45660>>>>>>>>>>>//        Move SysCurXR.Year_Year     to Ptyppar.Year_Year
45660>>>>>>>>>>>//        Move SysCurXR.Year_Recr     to Ptyppar.Year_Recr
45660>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code   to Ptyppar.Ctypkin_Code
45661>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code   to Ptyppar.Wtypkin_Code
45662>>>>>>>>>>>        if (ptyppar.sysxet_ptyppar='');            move '' to ptyppar.sysx_ptyp_recr
45665>>>>>>>>>>>    End_Procedure   // Update
45666>>>>>>>>>>>
45666>>>>>>>>>>>    Procedure Creating
45667>>>>>>>>>>>        Forward Send Creating
45669>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Ptyppar.Ptyppar_Rec0)))))) to Ptyppar.Ptyppar_Recr
45670>>>>>>>>>>>    End_Procedure   // Creating
45671>>>>>>>>>>>
45671>>>>>>>>>>>
45671>>>>>>>>>>>    // Define_Fields:
45671>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
45671>>>>>>>>>>>    Procedure Define_Fields
45672>>>>>>>>>>>        Forward Send Define_Fields
45674>>>>>>>>>>>        //DDB-Generated-Code-Location
45674>>>>>>>>>>>        //DDB-DefineFieldStart
45674>>>>>>>>>>>
45674>>>>>>>>>>>        Set Main_File            To Ptyppar.File_Number
45675>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
45676>>>>>>>>>>>
45676>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
45677>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
45678>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
45679>>>>>>>>>>>
45679>>>>>>>>>>>        // Child (Client) file structure................
45679>>>>>>>>>>>        Send Add_Client_File  Particle.File_Number
45680>>>>>>>>>>>        Send Add_Client_File  Pseira.File_Number
45681>>>>>>>>>>>        Send Add_Client_File  Ptypmet.File_Number
45682>>>>>>>>>>>        Send Add_Client_File  Ptypparh.File_Number
45683>>>>>>>>>>>
45683>>>>>>>>>>>        // Parent (Server) file structure...............
45683>>>>>>>>>>>        Send Add_Server_File  Ctypkin.File_Number
45684>>>>>>>>>>>        Send Add_Server_File  Wtypkin.File_Number
45685>>>>>>>>>>>
45685>>>>>>>>>>>        // External (System) file structure.............
45685>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
45686>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
45687>>>>>>>>>>>
45687>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Ptyppar_Rec0  To Ptyppar.Ptyppar_Rec0
45690>>>>>>>>>>>
45690>>>>>>>>>>>        // Field-based properties.......................
45690>>>>>>>>>>>
45690>>>>>>>>>>>        // Ptyppar.Company_Code
45690>>>>>>>>>>>
45690>>>>>>>>>>>        // Ptyppar.Branch_Code
45690>>>>>>>>>>>
45690>>>>>>>>>>>        // Ptyppar.Year_Year
45690>>>>>>>>>>>
45690>>>>>>>>>>>        // Ptyppar.Ctypkin_Code
45690>>>>>>>>>>>
45690>>>>>>>>>>>        // Ptyppar.Wtypkin_Code
45690>>>>>>>>>>>
45690>>>>>>>>>>>        // Ptyppar.Year_Recr
45690>>>>>>>>>>>        Set Field_Value_Table      Field Ptyppar.Year_Recr To (Ptyppar_Year_Recr_VT(Self))
45691>>>>>>>>>>>
45691>>>>>>>>>>>        // Ptyppar.Ctypkin_Recr
45691>>>>>>>>>>>
45691>>>>>>>>>>>        // Ptyppar.Wtypkin_Recr
45691>>>>>>>>>>>
45691>>>>>>>>>>>        // Ptyppar.Ptyppar_Code
45691>>>>>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Code To DD_AUTOFIND   
45692>>>>>>>>>>>        Set Field_Prompt_Object    Field Ptyppar.Ptyppar_Code To (sl012(Self))
45693>>>>>>>>>>>        Set Key_Field_State        Field Ptyppar.Ptyppar_Code To TRUE
45694>>>>>>>>>>>
45694>>>>>>>>>>>        // Ptyppar.Ptyppar_Rec0
45694>>>>>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Rec0 To DD_AUTOFIND   
45695>>>>>>>>>>>
45695>>>>>>>>>>>        // Ptyppar.Ptyppar_Descr
45695>>>>>>>>>>>        Set Field_Prompt_Object    Field Ptyppar.Ptyppar_Descr To (sl012(Self))
45696>>>>>>>>>>>
45696>>>>>>>>>>>        // Ptyppar.Ptyppar_Recr
45696>>>>>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Recr To DD_AUTOFIND   
45697>>>>>>>>>>>
45697>>>>>>>>>>>        // Ptyppar.Ptyppar_Is_What
45697>>>>>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ptyppar_Is_What To (Ptyppar_Ptyppar_Is_What_VT(Self))
45698>>>>>>>>>>>
45698>>>>>>>>>>>        // Ptyppar.Ptyppar_Module
45698>>>>>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ptyppar_Module To (Ptyppar_Ptyppar_Module_VT(Self))
45699>>>>>>>>>>>
45699>>>>>>>>>>>        // Ptyppar.Ptyppar_Abrev
45699>>>>>>>>>>>
45699>>>>>>>>>>>        // Ptyppar.Ftiaxnei_Tpay
45699>>>>>>>>>>>        Set Field_Class_Name       Field Ptyppar.Ftiaxnei_Tpay To "dbCheckBoxsub"
45700>>>>>>>>>>>
45700>>>>>>>>>>>        // Ptyppar.Ti_Typonei_Pms
45700>>>>>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ti_Typonei_Pms To (Ptyppar_Ti_Typonei_Pms_VT1(Self))
45701>>>>>>>>>>>
45701>>>>>>>>>>>        // Ptyppar.Einai_Paroxh_Yp
45701>>>>>>>>>>>        Set Field_Checkbox_Values  Field Ptyppar.Einai_Paroxh_Yp To "1"  "0"
45702>>>>>>>>>>>        Set Field_Class_Name       Field Ptyppar.Einai_Paroxh_Yp To "dbCheckBoxsub"
45703>>>>>>>>>>>
45703>>>>>>>>>>>        // Ptyppar.Gtypkin_Code
45703>>>>>>>>>>>
45703>>>>>>>>>>>        // Ptyppar.Sysxet_Ptyppar
45703>>>>>>>>>>>
45703>>>>>>>>>>>        // Ptyppar.Sysx_Ptyp_Recr
45703>>>>>>>>>>>
45703>>>>>>>>>>>        // Ptyppar.Check_Posa_Plaf
45703>>>>>>>>>>>
45703>>>>>>>>>>>        // Ptyppar.Singular
45703>>>>>>>>>>>
45703>>>>>>>>>>>        // Ptyppar.Sub
45703>>>>>>>>>>>
45703>>>>>>>>>>>        // Ptyppar.Constrain
45703>>>>>>>>>>>
45703>>>>>>>>>>>        // Ptyppar.Label
45703>>>>>>>>>>>
45703>>>>>>>>>>>        // Ptyppar.Label1
45703>>>>>>>>>>>
45703>>>>>>>>>>>        // Ptyppar.Sap
45703>>>>>>>>>>>
45703>>>>>>>>>>>        // Ptyppar.Is_Xondr
45703>>>>>>>>>>>
45703>>>>>>>>>>>        //DDB-DefineFieldEnd
45703>>>>>>>>>>>    End_Procedure    // Define_Fields
45704>>>>>>>>>>>
45704>>>>>>>>>>>    // Field_Defaults:
45704>>>>>>>>>>>    // This procedure is used to establish default field values.
45704>>>>>>>>>>>
45704>>>>>>>>>>>    Procedure Field_Defaults
45705>>>>>>>>>>>        Forward Send Field_Defaults
45707>>>>>>>>>>>        //DDB-Generated-Code-Location
45707>>>>>>>>>>>        //DDB-FieldDefaultStart
45707>>>>>>>>>>>        Set Field_Changed_Value   Field Ptyppar.Ftiaxnei_Tpay To "1"
45708>>>>>>>>>>>        Set Field_Changed_Value   Field Ptyppar.Einai_Paroxh_Yp To 0
45709>>>>>>>>>>>        //DDB-FieldDefaultEnd
45709>>>>>>>>>>>    End_Procedure    // Field_Defaults
45710>>>>>>>>>>>
45710>>>>>>>>>>>End_Class    // Ptyppar_DataDictionary
45711>>>>>>>>>>>//DDB-Selection-pkg-Start
45711>>>>>>>>>>>
45711>>>>>>>>>>>Use sl012.SL         // sl012
INCLUDING FILE: SL012.SL
45711>>>>>>>>>>>>>//AB/ Project sl012 : Ptyppar
45711>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
45711>>>>>>>>>>>>>//AB/     Set ProjectName to "sl012 : Ptyppar"
45711>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl012.SL"
45711>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
45711>>>>>>>>>>>>>
45711>>>>>>>>>>>>>// Project Object Structure
45711>>>>>>>>>>>>>//   sl012 is a dbModalPanelSub
45711>>>>>>>>>>>>>//     Ctypkin_DD is a DataDictionary
45711>>>>>>>>>>>>>//     Wtypkin_DD is a DataDictionary
45711>>>>>>>>>>>>>//     Ptyppar_DD is a DataDictionary
45711>>>>>>>>>>>>>//     oSelList is a dbListSub
45711>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
45711>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
45711>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
45711>>>>>>>>>>>>>
45711>>>>>>>>>>>>>// Register all objects
45711>>>>>>>>>>>>>Register_Object Ctypkin_DD
45711>>>>>>>>>>>>>Register_Object oCancel_bn
45711>>>>>>>>>>>>>Register_Object oOK_bn
45711>>>>>>>>>>>>>Register_Object oSearch_bn
45711>>>>>>>>>>>>>Register_Object oSelList
45711>>>>>>>>>>>>>Register_Object Ptyppar_DD
45711>>>>>>>>>>>>>Register_Object sl012
45711>>>>>>>>>>>>>Register_Object Wtypkin_DD
45711>>>>>>>>>>>>>
45711>>>>>>>>>>>>>
45711>>>>>>>>>>>>>//AB-IgnoreStart
45711>>>>>>>>>>>>>
45711>>>>>>>>>>>>>Use DFAllEnt.pkg
45711>>>>>>>>>>>>>Use dbList.Sub
45711>>>>>>>>>>>>>Use Button.Sub
45711>>>>>>>>>>>>>
45711>>>>>>>>>>>>>
45711>>>>>>>>>>>>>Use CTYPKIN.DD
45711>>>>>>>>>>>>>Use WTYPKIN.DD
45711>>>>>>>>>>>>>Use PTYPPAR.DD
45711>>>>>>>>>>>>>
45711>>>>>>>>>>>>>//AB-IgnoreEnd
45711>>>>>>>>>>>>>
45711>>>>>>>>>>>>>Object sl012 is a dbModalPanelSub
45713>>>>>>>>>>>>>
45713>>>>>>>>>>>>>    //AB-StoreTopStart
45713>>>>>>>>>>>>>    Property String psModule Public ''
45715>>>>>>>>>>>>>    Property integer pifromclient Public 0
45717>>>>>>>>>>>>>    
45717>>>>>>>>>>>>>    //AB-StoreTopEnd
45717>>>>>>>>>>>>>
45717>>>>>>>>>>>>>    Set Label to "’ç§¦  §˜¨˜©«˜« ¡é¤"
45718>>>>>>>>>>>>>    Set Size to 203 490
45719>>>>>>>>>>>>>    Set Location to 4 4
45720>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
45721>>>>>>>>>>>>>    Set Modal_State to FALSE
45722>>>>>>>>>>>>>
45722>>>>>>>>>>>>>    //AB-DDOStart
45722>>>>>>>>>>>>>
45722>>>>>>>>>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
45724>>>>>>>>>>>>>    End_Object    // Ctypkin_DD
45725>>>>>>>>>>>>>
45725>>>>>>>>>>>>>    Object Wtypkin_DD is a Wtypkin_DataDictionary
45727>>>>>>>>>>>>>    End_Object    // Wtypkin_DD
45728>>>>>>>>>>>>>
45728>>>>>>>>>>>>>    Object Ptyppar_DD is a Ptyppar_DataDictionary
45730>>>>>>>>>>>>>        Set DDO_Server to (Ctypkin_DD(self))
45731>>>>>>>>>>>>>        Set DDO_Server to (Wtypkin_DD(self))
45732>>>>>>>>>>>>>
45732>>>>>>>>>>>>>        //AB-StoreStart
45732>>>>>>>>>>>>>        
45732>>>>>>>>>>>>>        Procedure OnConstrain
45734>>>>>>>>>>>>>            Forward Send OnConstrain
45736>>>>>>>>>>>>>            If (psModule(Self)<>'') Begin
45738>>>>>>>>>>>>>                Constrain Ptyppar.Ptyppar_Module eq (psModule(Self))
45740>>>>>>>>>>>>>            End
45740>>>>>>>>>>>>>>
45740>>>>>>>>>>>>>            If (pifromclient(self)=1) Begin
45742>>>>>>>>>>>>>                Constrain Ptyppar.constrain eq '1'
45744>>>>>>>>>>>>>            End
45744>>>>>>>>>>>>>>
45744>>>>>>>>>>>>>        End_Procedure
45745>>>>>>>>>>>>>        
45745>>>>>>>>>>>>>        
45745>>>>>>>>>>>>>        
45745>>>>>>>>>>>>>        
45745>>>>>>>>>>>>>        //AB-StoreEnd
45745>>>>>>>>>>>>>
45745>>>>>>>>>>>>>    End_Object    // Ptyppar_DD
45746>>>>>>>>>>>>>
45746>>>>>>>>>>>>>    Set Main_DD to (Ptyppar_DD(self))
45747>>>>>>>>>>>>>    Set Server to (Ptyppar_DD(self))
45748>>>>>>>>>>>>>
45748>>>>>>>>>>>>>    //AB-DDOEnd
45748>>>>>>>>>>>>>
45748>>>>>>>>>>>>>    Object oSelList is a dbListSub
45750>>>>>>>>>>>>>        Set Main_File to Ptyppar.File_Number
45751>>>>>>>>>>>>>        Set Size to 161 474
45752>>>>>>>>>>>>>        Set Location to 6 6
45753>>>>>>>>>>>>>
45753>>>>>>>>>>>>>        Begin_Row
45756>>>>>>>>>>>>>            Entry_Item Ptyppar.Ptyppar_code
45757>>>>>>>>>>>>>            Entry_Item Ptyppar.Ptyppar_descr
45758>>>>>>>>>>>>>            Entry_Item Ctypkin.Ctypkin_descr
45759>>>>>>>>>>>>>            Entry_Item Wtypkin.Wtypkin_descr
45760>>>>>>>>>>>>>        End_Row
45765>>>>>>>>>>>>>
45765>>>>>>>>>>>>>        Set Form_Width    item 0 to 77
45766>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à›. ˜¨˜©«˜« ¡¦ç"
45767>>>>>>>>>>>>>        
45767>>>>>>>>>>>>>        Set Form_Width    item 1 to 125
45768>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
45769>>>>>>>>>>>>>        
45769>>>>>>>>>>>>>        Set Form_Width    item 2 to 137
45770>>>>>>>>>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž"
45771>>>>>>>>>>>>>        
45771>>>>>>>>>>>>>        Set Form_Width    item 3 to 129
45772>>>>>>>>>>>>>        Set Header_Label  item 3 to "‰å¤ž©ž €§¦Ÿã¡žª"
45773>>>>>>>>>>>>>        
45773>>>>>>>>>>>>>
45773>>>>>>>>>>>>>        //AB-StoreStart
45773>>>>>>>>>>>>>        
45773>>>>>>>>>>>>>        Procedure Activate
45775>>>>>>>>>>>>>            Forward Send Activate
45777>>>>>>>>>>>>>            Send Rebuild_Constraints to Ptyppar_DD
45778>>>>>>>>>>>>>            Send Beginning_Of_Data to oSelList True
45779>>>>>>>>>>>>>        End_Procedure
45780>>>>>>>>>>>>>        
45780>>>>>>>>>>>>>        //AB-StoreEnd
45780>>>>>>>>>>>>>
45780>>>>>>>>>>>>>    End_Object    // oSelList
45781>>>>>>>>>>>>>
45781>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
45783>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
45784>>>>>>>>>>>>>        Set Location to 171 323
45785>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45786>>>>>>>>>>>>>
45786>>>>>>>>>>>>>        //AB-StoreStart
45786>>>>>>>>>>>>>        Procedure OnClick
45788>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
45789>>>>>>>>>>>>>        End_Procedure
45790>>>>>>>>>>>>>        //AB-StoreEnd
45790>>>>>>>>>>>>>
45790>>>>>>>>>>>>>    End_Object    // oOK_bn
45791>>>>>>>>>>>>>
45791>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
45793>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
45794>>>>>>>>>>>>>        Set Location to 171 377
45795>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45796>>>>>>>>>>>>>
45796>>>>>>>>>>>>>        //AB-StoreStart
45796>>>>>>>>>>>>>        Procedure OnClick
45798>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
45799>>>>>>>>>>>>>        End_Procedure
45800>>>>>>>>>>>>>        //AB-StoreEnd
45800>>>>>>>>>>>>>
45800>>>>>>>>>>>>>    End_Object    // oCancel_bn
45801>>>>>>>>>>>>>
45801>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
45803>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
45804>>>>>>>>>>>>>        Set Location to 171 433
45805>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45806>>>>>>>>>>>>>
45806>>>>>>>>>>>>>        //AB-StoreStart
45806>>>>>>>>>>>>>        Procedure OnClick
45808>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
45809>>>>>>>>>>>>>        End_Procedure
45810>>>>>>>>>>>>>        //AB-StoreEnd
45810>>>>>>>>>>>>>
45810>>>>>>>>>>>>>    End_Object    // oSearch_bn
45811>>>>>>>>>>>>>
45811>>>>>>>>>>>>>
45811>>>>>>>>>>>>>    //AB-StoreStart
45811>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
45812>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
45813>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
45814>>>>>>>>>>>>>    
45814>>>>>>>>>>>>>    
45814>>>>>>>>>>>>>    //AB-StoreEnd
45814>>>>>>>>>>>>>
45814>>>>>>>>>>>>>End_Object    // sl012
45815>>>>>>>>>>>>>
45815>>>>>>>>>>>>>//AB/ End_Object    // prj
45815>>>>>>>>>>>
45815>>>>>>>>>>>//DDB-Selection-pkg-End
45815>>>>>>>>>>>//DDB-FileEnd
45815>>>>>>>>>    Use PSEIRA.DD
INCLUDING FILE: PSEIRA.DD
45815>>>>>>>>>>>//DDB-FileStart
45815>>>>>>>>>>>//DDB-HeaderStart
45815>>>>>>>>>>>
45815>>>>>>>>>>>// File Name : PSEIRA.DD
45815>>>>>>>>>>>// Class Name: Pseira_DataDictionary
45815>>>>>>>>>>>// Revision  : 34
45815>>>>>>>>>>>// Version   : 2
45815>>>>>>>>>>>
45815>>>>>>>>>>>Use  Windows           // Basic Definitions
45815>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
45815>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
45815>>>>>>>>>>>
45815>>>>>>>>>>>Open Pseira
45817>>>>>>>>>>>Open Ptyppar
45819>>>>>>>>>>>Open Sysrecp
45821>>>>>>>>>>>Open Syscurxr
45823>>>>>>>>>>>
45823>>>>>>>>>>>//DDB-HeaderEnd
45823>>>>>>>>>>>//DDB-SelectionStart
45823>>>>>>>>>>>//DDB/ ExternalSelectionList sl013  sl013.SL
45823>>>>>>>>>>>Register_Object sl013
45823>>>>>>>>>>>//DDB-SelectionEnd
45823>>>>>>>>>>>
45823>>>>>>>>>>>Class Pseira_DataDictionary  is a DataDictionary
45824>>>>>>>>>>>
45824>>>>>>>>>>>    Procedure Save_Main_File
45825>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
45827>>>>>>>>>>>            If Pseira.Recnum Eq 0 Procedure_Return
45830>>>>>>>>>>>        End
45830>>>>>>>>>>>>
45830>>>>>>>>>>>        Forward Send Save_Main_File
45832>>>>>>>>>>>    End_Procedure
45833>>>>>>>>>>>
45833>>>>>>>>>>>    Procedure Update
45834>>>>>>>>>>>        Forward Send Update
45836>>>>>>>>>>>        // Insert Code Here
45836>>>>>>>>>>>        Move SysCurXR.Company_Code  to Pseira.Company_Code
45837>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Pseira.Branch_Code
45838>>>>>>>>>>>        Move SysCurXR.Year_Year     to Pseira.Year_Year
45839>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code   to Pseira.Ctypkin_Code
45840>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code   to Pseira.Wtypkin_Code
45841>>>>>>>>>>>        Move Ptyppar.Ptyppar_Code   to Pseira.Ptyppar_Code
45842>>>>>>>>>>>    End_Procedure   // Update
45843>>>>>>>>>>>
45843>>>>>>>>>>>
45843>>>>>>>>>>>     Procedure Creating
45844>>>>>>>>>>>        Forward Send Creating
45846>>>>>>>>>>>        // Insert Code Here
45846>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Pseira.Pseira_Rec0)))))) to Pseira.Pseira_Recr
45847>>>>>>>>>>>    End_Procedure   // Creating
45848>>>>>>>>>>>
45848>>>>>>>>>>>
45848>>>>>>>>>>>    // Define_Fields:
45848>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
45848>>>>>>>>>>>
45848>>>>>>>>>>>    Procedure Define_Fields
45849>>>>>>>>>>>        Forward Send Define_Fields
45851>>>>>>>>>>>        //DDB-Generated-Code-Location
45851>>>>>>>>>>>        //DDB-DefineFieldStart
45851>>>>>>>>>>>
45851>>>>>>>>>>>        Set Main_File            To Pseira.File_Number
45852>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
45853>>>>>>>>>>>
45853>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
45854>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
45855>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
45856>>>>>>>>>>>
45856>>>>>>>>>>>        // Parent (Server) file structure...............
45856>>>>>>>>>>>        Send Add_Server_File  Ptyppar.File_Number
45857>>>>>>>>>>>
45857>>>>>>>>>>>        // External (System) file structure.............
45857>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
45858>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
45859>>>>>>>>>>>
45859>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Pseira_Rec0  To Pseira.Pseira_Rec0
45862>>>>>>>>>>>
45862>>>>>>>>>>>        // Field-based properties.......................
45862>>>>>>>>>>>
45862>>>>>>>>>>>        // Pseira.Company_Code
45862>>>>>>>>>>>
45862>>>>>>>>>>>        // Pseira.Branch_Code
45862>>>>>>>>>>>
45862>>>>>>>>>>>        // Pseira.Year_Year
45862>>>>>>>>>>>
45862>>>>>>>>>>>        // Pseira.Ctypkin_Code
45862>>>>>>>>>>>
45862>>>>>>>>>>>        // Pseira.Wtypkin_Code
45862>>>>>>>>>>>
45862>>>>>>>>>>>        // Pseira.Ptyppar_Code
45862>>>>>>>>>>>
45862>>>>>>>>>>>        // Pseira.Ptyppar_Recr
45862>>>>>>>>>>>
45862>>>>>>>>>>>        // Pseira.Pseira_Seira
45862>>>>>>>>>>>        Set Field_Options          Field Pseira.Pseira_Seira To DD_AUTOFIND   
45863>>>>>>>>>>>        Set Field_Prompt_Object    Field Pseira.Pseira_Seira To (sl013(Self))
45864>>>>>>>>>>>
45864>>>>>>>>>>>        // Pseira.Pseira_Rec0
45864>>>>>>>>>>>        Set Field_Options          Field Pseira.Pseira_Rec0 To DD_AUTOFIND   
45865>>>>>>>>>>>        Set Field_Prompt_Object    Field Pseira.Pseira_Rec0 To (sl013(Self))
45866>>>>>>>>>>>
45866>>>>>>>>>>>        // Pseira.Pseira_Recr
45866>>>>>>>>>>>        Set Field_Options          Field Pseira.Pseira_Recr To DD_AUTOFIND   
45867>>>>>>>>>>>        Set Field_Prompt_Object    Field Pseira.Pseira_Recr To (sl013(Self))
45868>>>>>>>>>>>
45868>>>>>>>>>>>        // Pseira.Pseira_Printer
45868>>>>>>>>>>>
45868>>>>>>>>>>>        // Pseira.Pseira_Form
45868>>>>>>>>>>>
45868>>>>>>>>>>>        // Pseira.Pseira_Autonum
45868>>>>>>>>>>>
45868>>>>>>>>>>>        // Pseira.Autonum_Plus
45868>>>>>>>>>>>
45868>>>>>>>>>>>        // Pseira.Autonum_Minus
45868>>>>>>>>>>>
45868>>>>>>>>>>>        // Pseira.Auto_Plus_Last
45868>>>>>>>>>>>
45868>>>>>>>>>>>        //DDB-DefineFieldEnd
45868>>>>>>>>>>>    End_Procedure    // Define_Fields
45869>>>>>>>>>>>
45869>>>>>>>>>>>    // Field_Defaults:
45869>>>>>>>>>>>    // This procedure is used to establish default field values.
45869>>>>>>>>>>>
45869>>>>>>>>>>>    Procedure Field_Defaults
45870>>>>>>>>>>>        Forward Send Field_Defaults
45872>>>>>>>>>>>        //DDB-Generated-Code-Location
45872>>>>>>>>>>>        //DDB-FieldDefaultStart
45872>>>>>>>>>>>        //DDB-FieldDefaultEnd
45872>>>>>>>>>>>    End_Procedure    // Field_Defaults
45873>>>>>>>>>>>
45873>>>>>>>>>>>End_Class    // Pseira_DataDictionary
45874>>>>>>>>>>>//DDB-Selection-pkg-Start
45874>>>>>>>>>>>
45874>>>>>>>>>>>Use sl013.SL         // sl013
INCLUDING FILE: SL013.SL
45874>>>>>>>>>>>>>//AB/ Project sl013:SeiraP
45874>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
45874>>>>>>>>>>>>>//AB/         Set ProjectName to "sl013:SeiraP"
45874>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl013.SL"
45874>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
45874>>>>>>>>>>>>>
45874>>>>>>>>>>>>>// Project Object Structure
45874>>>>>>>>>>>>>//   sl013 is a dbModalPanelSub
45874>>>>>>>>>>>>>//     Ctypkin_DD is a DataDictionary
45874>>>>>>>>>>>>>//     Wtypkin_DD is a DataDictionary
45874>>>>>>>>>>>>>//     Ptyppar_DD is a DataDictionary
45874>>>>>>>>>>>>>//     Pseira_DD is a DataDictionary
45874>>>>>>>>>>>>>//     oSelList is a dbListSub
45874>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
45874>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
45874>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
45874>>>>>>>>>>>>>
45874>>>>>>>>>>>>>// Register all objects
45874>>>>>>>>>>>>>Register_Object Ctypkin_DD
45874>>>>>>>>>>>>>Register_Object oCancel_bn
45874>>>>>>>>>>>>>Register_Object oOK_bn
45874>>>>>>>>>>>>>Register_Object oSearch_bn
45874>>>>>>>>>>>>>Register_Object oSelList
45874>>>>>>>>>>>>>Register_Object Pseira_DD
45874>>>>>>>>>>>>>Register_Object Ptyppar_DD
45874>>>>>>>>>>>>>Register_Object sl013
45874>>>>>>>>>>>>>Register_Object Wtypkin_DD
45874>>>>>>>>>>>>>
45874>>>>>>>>>>>>>
45874>>>>>>>>>>>>>    //AB-IgnoreStart
45874>>>>>>>>>>>>>
45874>>>>>>>>>>>>>    Use DFAllEnt.pkg
45874>>>>>>>>>>>>>    Use dbList.Sub
45874>>>>>>>>>>>>>    Use Button.Sub
45874>>>>>>>>>>>>>
45874>>>>>>>>>>>>>
45874>>>>>>>>>>>>>    Use CTYPKIN.DD
45874>>>>>>>>>>>>>    Use WTYPKIN.DD
45874>>>>>>>>>>>>>    Use PTYPPAR.DD
45874>>>>>>>>>>>>>    Use PSEIRA.DD
45874>>>>>>>>>>>>>    
45874>>>>>>>>>>>>>    //AB-IgnoreEnd
45874>>>>>>>>>>>>>
45874>>>>>>>>>>>>>    Object sl013 is a dbModalPanelSub
45876>>>>>>>>>>>>>
45876>>>>>>>>>>>>>        //AB-StoreTopStart
45876>>>>>>>>>>>>>        Property String FragmaPtyppar_Recr Public ''
45878>>>>>>>>>>>>>        
45878>>>>>>>>>>>>>        //AB-StoreTopEnd
45878>>>>>>>>>>>>>
45878>>>>>>>>>>>>>        Set Label to "‰˜«á¢¦š¦ª ‘œ ¨é¤"
45879>>>>>>>>>>>>>        Set Size to 148 214
45880>>>>>>>>>>>>>        Set Location to 1 7
45881>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
45882>>>>>>>>>>>>>        Set Modal_State to FALSE
45883>>>>>>>>>>>>>
45883>>>>>>>>>>>>>        //AB-DDOStart
45883>>>>>>>>>>>>>
45883>>>>>>>>>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
45885>>>>>>>>>>>>>        End_Object    // Ctypkin_DD
45886>>>>>>>>>>>>>
45886>>>>>>>>>>>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
45888>>>>>>>>>>>>>        End_Object    // Wtypkin_DD
45889>>>>>>>>>>>>>
45889>>>>>>>>>>>>>        Object Ptyppar_DD is a Ptyppar_DataDictionary
45891>>>>>>>>>>>>>            Set DDO_Server to (Ctypkin_DD(self))
45892>>>>>>>>>>>>>            Set DDO_Server to (Wtypkin_DD(self))
45893>>>>>>>>>>>>>        End_Object    // Ptyppar_DD
45894>>>>>>>>>>>>>
45894>>>>>>>>>>>>>        Object Pseira_DD is a Pseira_DataDictionary
45896>>>>>>>>>>>>>            Set DDO_Server to (Ptyppar_DD(self))
45897>>>>>>>>>>>>>
45897>>>>>>>>>>>>>            //AB-StoreStart
45897>>>>>>>>>>>>>            Procedure OnConstrain
45899>>>>>>>>>>>>>                String sID
45900>>>>>>>>>>>>>                Forward Send OnConstrain
45902>>>>>>>>>>>>>                Get FragmaPtyppar_Recr to sID
45903>>>>>>>>>>>>>                Move (trim(sID)) to sID
45904>>>>>>>>>>>>>                If (sID<>'') Constrain Pseira.Ptyppar_Recr eq sID
45908>>>>>>>>>>>>>            End_procedure
45909>>>>>>>>>>>>>            
45909>>>>>>>>>>>>>            //AB-StoreEnd
45909>>>>>>>>>>>>>
45909>>>>>>>>>>>>>        End_Object    // Pseira_DD
45910>>>>>>>>>>>>>
45910>>>>>>>>>>>>>        Set Main_DD to (Pseira_DD(self))
45911>>>>>>>>>>>>>        Set Server to (Pseira_DD(self))
45912>>>>>>>>>>>>>
45912>>>>>>>>>>>>>        //AB-DDOEnd
45912>>>>>>>>>>>>>
45912>>>>>>>>>>>>>        Object oSelList is a dbListSub
45914>>>>>>>>>>>>>            Set Main_File to Pseira.File_Number
45915>>>>>>>>>>>>>            Set Size to 105 197
45916>>>>>>>>>>>>>            Set Location to 6 6
45917>>>>>>>>>>>>>
45917>>>>>>>>>>>>>            Begin_Row
45920>>>>>>>>>>>>>                Entry_Item Pseira.Pseira_seira
45921>>>>>>>>>>>>>                Entry_Item Pseira.Pseira_printer
45922>>>>>>>>>>>>>                Entry_Item Pseira.Pseira_autonum
45923>>>>>>>>>>>>>            End_Row
45928>>>>>>>>>>>>>
45928>>>>>>>>>>>>>            Set Form_Width    item 0 to 40
45929>>>>>>>>>>>>>            Set Header_Label  item 0 to "‘œ ¨á"
45930>>>>>>>>>>>>>            
45930>>>>>>>>>>>>>            Set Form_Width    item 1 to 135
45931>>>>>>>>>>>>>            Set Header_Label  item 1 to "„¡«¬§à«ãª"
45932>>>>>>>>>>>>>            
45932>>>>>>>>>>>>>            Set Form_Width    item 2 to 16
45933>>>>>>>>>>>>>            Set Header_Label  item 2 to "Autonum"
45934>>>>>>>>>>>>>            Set Column_Checkbox_State  item 2 to True
45935>>>>>>>>>>>>>            
45935>>>>>>>>>>>>>
45935>>>>>>>>>>>>>            //AB-StoreStart
45935>>>>>>>>>>>>>                    
45935>>>>>>>>>>>>>            Property String StoreFragmaPtyppar_Recr Public ''
45937>>>>>>>>>>>>>            
45937>>>>>>>>>>>>>            Procedure Store_Defaults
45939>>>>>>>>>>>>>                   Forward Send Store_Defaults
45941>>>>>>>>>>>>>                   Set StoreFragmaPtyppar_Recr to (FragmaPtyppar_Recr(Self))
45942>>>>>>>>>>>>>            End_Procedure
45943>>>>>>>>>>>>>            
45943>>>>>>>>>>>>>            Procedure ReStore_Defaults
45945>>>>>>>>>>>>>                   Forward Send ReStore_Defaults
45947>>>>>>>>>>>>>                   Set FragmaPtyppar_Recr to (StoreFragmaPtyppar_Recr(Self))
45948>>>>>>>>>>>>>            End_Procedure
45949>>>>>>>>>>>>>            
45949>>>>>>>>>>>>>            Procedure Activating
45951>>>>>>>>>>>>>                Forward Send Activating
45953>>>>>>>>>>>>>                Send Rebuild_Constraints to (Pseira_DD(Self))
45954>>>>>>>>>>>>>            End_Procedure
45955>>>>>>>>>>>>>            
45955>>>>>>>>>>>>>            
45955>>>>>>>>>>>>>            //AB-StoreEnd
45955>>>>>>>>>>>>>
45955>>>>>>>>>>>>>        End_Object    // oSelList
45956>>>>>>>>>>>>>
45956>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
45958>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
45959>>>>>>>>>>>>>            Set Location to 114 42
45960>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
45961>>>>>>>>>>>>>
45961>>>>>>>>>>>>>            //AB-StoreStart
45961>>>>>>>>>>>>>            Procedure OnClick
45963>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
45964>>>>>>>>>>>>>            End_Procedure
45965>>>>>>>>>>>>>            //AB-StoreEnd
45965>>>>>>>>>>>>>
45965>>>>>>>>>>>>>        End_Object    // oOK_bn
45966>>>>>>>>>>>>>
45966>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
45968>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
45969>>>>>>>>>>>>>            Set Location to 114 98
45970>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
45971>>>>>>>>>>>>>
45971>>>>>>>>>>>>>            //AB-StoreStart
45971>>>>>>>>>>>>>            Procedure OnClick
45973>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
45974>>>>>>>>>>>>>            End_Procedure
45975>>>>>>>>>>>>>            //AB-StoreEnd
45975>>>>>>>>>>>>>
45975>>>>>>>>>>>>>        End_Object    // oCancel_bn
45976>>>>>>>>>>>>>
45976>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
45978>>>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
45979>>>>>>>>>>>>>            Set Location to 114 153
45980>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
45981>>>>>>>>>>>>>
45981>>>>>>>>>>>>>            //AB-StoreStart
45981>>>>>>>>>>>>>            Procedure OnClick
45983>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
45984>>>>>>>>>>>>>            End_Procedure
45985>>>>>>>>>>>>>            //AB-StoreEnd
45985>>>>>>>>>>>>>
45985>>>>>>>>>>>>>        End_Object    // oSearch_bn
45986>>>>>>>>>>>>>
45986>>>>>>>>>>>>>
45986>>>>>>>>>>>>>        //AB-StoreStart
45986>>>>>>>>>>>>>            
45986>>>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
45987>>>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
45988>>>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
45989>>>>>>>>>>>>>        
45989>>>>>>>>>>>>>        
45989>>>>>>>>>>>>>        
45989>>>>>>>>>>>>>        
45989>>>>>>>>>>>>>        
45989>>>>>>>>>>>>>        
45989>>>>>>>>>>>>>        
45989>>>>>>>>>>>>>        
45989>>>>>>>>>>>>>        //AB-StoreEnd
45989>>>>>>>>>>>>>
45989>>>>>>>>>>>>>    End_Object    // sl013
45990>>>>>>>>>>>>>
45990>>>>>>>>>>>>>//AB/     End_Object    // prj
45990>>>>>>>>>>>
45990>>>>>>>>>>>//DDB-Selection-pkg-End
45990>>>>>>>>>>>//DDB-FileEnd
45990>>>>>>>>>    Use NOMISMA.DD
45990>>>>>>>>>    Use COUNTRY.DD
45990>>>>>>>>>    Use TOWNS.DD
45990>>>>>>>>>    Use CITIES.DD
45990>>>>>>>>>    Use PAYRESP.DD
45990>>>>>>>>>    Use AREAS.DD
45990>>>>>>>>>    Use CLIENTS.DD
45990>>>>>>>>>    Use PARTICLE.DD
INCLUDING FILE: PARTICLE.DD
45990>>>>>>>>>>>//DDB-FileStart
45990>>>>>>>>>>>//DDB-HeaderStart
45990>>>>>>>>>>>
45990>>>>>>>>>>>// File Name : PARTICLE.DD
45990>>>>>>>>>>>// Class Name: Particle_DataDictionary
45990>>>>>>>>>>>// Revision  : 255
45990>>>>>>>>>>>// Version   : 2
45990>>>>>>>>>>>
45990>>>>>>>>>>>Use  Windows           // Basic Definitions
45990>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
45990>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
45990>>>>>>>>>>>
45990>>>>>>>>>>>Open Particle
45992>>>>>>>>>>>Open Pmoves
45994>>>>>>>>>>>Open Tparticl
45996>>>>>>>>>>>Open Partlfpa
INCLUDING FILE: PARTLFPA.FD
45998>>>>>>>>>>>Open Pmovesl
INCLUDING FILE: PMOVESL.FD
46000>>>>>>>>>>>Open Psxetika
46002>>>>>>>>>>>Open Clients
46004>>>>>>>>>>>Open Ptyppar
46006>>>>>>>>>>>Open Nomisma
46008>>>>>>>>>>>Open Sysrecp
46010>>>>>>>>>>>Open Syscurxr
46012>>>>>>>>>>>Open Pseira
46014>>>>>>>>>>>Open Cn
46016>>>>>>>>>>>Open Partlfpa
46018>>>>>>>>>>>Open Clorder
46020>>>>>>>>>>>Open Clorderd
INCLUDING FILE: CLORDERD.FD
46022>>>>>>>>>>>Open Ypoprosf
INCLUDING FILE: YPOPROSF.FD
46024>>>>>>>>>>>Open Psxetika
46026>>>>>>>>>>>Open Pmoves
46028>>>>>>>>>>>
46028>>>>>>>>>>>//DDB-HeaderEnd
46028>>>>>>>>>>>//DDB-ValidationStart
46028>>>>>>>>>>>
46028>>>>>>>>>>>Register_Object Particle_Tropos_Diakin_VT
46028>>>>>>>>>>>Register_Object Particle_Skopos_Diakin_VT
46028>>>>>>>>>>>Register_Object Particle_Tropos_Plhromhs_VT
46028>>>>>>>>>>>
46028>>>>>>>>>>>Object Particle_Tropos_Diakin_VT  is a CodeValidationTable
46030>>>>>>>>>>>    Set Type_Value        To "SEND_TERMS"
46031>>>>>>>>>>>    Set Allow_Blank_State To TRUE
46032>>>>>>>>>>>    //DDB-ValidationCustomStart
46032>>>>>>>>>>>    //DDB-ValidationCustomEnd
46032>>>>>>>>>>>End_Object   // Particle_Tropos_Diakin_VT
46033>>>>>>>>>>>
46033>>>>>>>>>>>Object Particle_Skopos_Diakin_VT  is a CodeValidationTable
46035>>>>>>>>>>>    Set Type_Value        To "SKOPOS"
46036>>>>>>>>>>>    Set Allow_Blank_State To TRUE
46037>>>>>>>>>>>    //DDB-ValidationCustomStart
46037>>>>>>>>>>>    //DDB-ValidationCustomEnd
46037>>>>>>>>>>>End_Object   // Particle_Skopos_Diakin_VT
46038>>>>>>>>>>>
46038>>>>>>>>>>>Object Particle_Tropos_Plhromhs_VT  is a CodeValidationTable
46040>>>>>>>>>>>    Set Type_Value        To "PAY_TERMS"
46041>>>>>>>>>>>    Set Validate_State    To FALSE
46042>>>>>>>>>>>    Set Allow_Blank_State To TRUE
46043>>>>>>>>>>>    //DDB-ValidationCustomStart
46043>>>>>>>>>>>    //DDB-ValidationCustomEnd
46043>>>>>>>>>>>End_Object   // Particle_Tropos_Plhromhs_VT
46044>>>>>>>>>>>//DDB-ValidationEnd
46044>>>>>>>>>>>//DDB-SelectionStart
46044>>>>>>>>>>>//DDB/ ExternalSelectionList sl041  sl041.SL
46044>>>>>>>>>>>//DDB/ ExternalSelectionList sl014  sl014.SL
46044>>>>>>>>>>>//DDB/ ExternalSelectionList sl054  sl054.SL
46044>>>>>>>>>>>//DDB/ ExternalSelectionList sl053  sl053.SL
46044>>>>>>>>>>>//DDB/ ExternalSelectionList sl064  sl064.SL
46044>>>>>>>>>>>Register_Object sl041
46044>>>>>>>>>>>Register_Object sl014
46044>>>>>>>>>>>Register_Object sl054
46044>>>>>>>>>>>Register_Object sl053
46044>>>>>>>>>>>Register_Object sl064
46044>>>>>>>>>>>//DDB-SelectionEnd
46044>>>>>>>>>>>
46044>>>>>>>>>>>//Object oValidateSeira is a FileValidationTable
46044>>>>>>>>>>>//    Set Table_Title         to "„§ ¢¦šã ‘œ ¨áª ˜¨˜©«˜« ¡¦ç"
46044>>>>>>>>>>>//    Set Main_File           to Pseira.File_Number
46044>>>>>>>>>>>//    Set Code_Field          to  8 //Pseira.Pseira_Seira
46044>>>>>>>>>>>//    Set Description_Field   to 11 //Pseira.Pseira_Printer
46044>>>>>>>>>>>//    Set Ordering            to  1
46044>>>>>>>>>>>//    Set Static_State to False
46044>>>>>>>>>>>//End_Object
46044>>>>>>>>>>>
46044>>>>>>>>>>>Open Cars
INCLUDING FILE: CARS.FD
46046>>>>>>>>>>>Open Drivers
INCLUDING FILE: DRIVERS.FD
46048>>>>>>>>>>>Open Pumps
INCLUDING FILE: PUMPS.FD
46050>>>>>>>>>>>Open SysCurXr
46052>>>>>>>>>>>
46052>>>>>>>>>>>Class Particle_DataDictionary  is a DataDictionary_Sec
46053>>>>>>>>>>>
46053>>>>>>>>>>>    Function fsVresAntliaDescr String asOxhmaCode Returns String
46054>>>>>>>>>>>        String rVal
46055>>>>>>>>>>>        Clear Pumps
46056>>>>>>>>>>>        Move SysCurXr.Company_Code  to Pumps.Pump_Company
46057>>>>>>>>>>>        Move asOxhmaCode            to Pumps.Pump_ID
46058>>>>>>>>>>>        Find Eq Pumps By Index.1 // Pump_Company + Pump_ID
46059>>>>>>>>>>>>
46059>>>>>>>>>>>        If (Found) Move (Trim(Pumps.Pump_Descr)) to rVal
46062>>>>>>>>>>>        Else Move '' to rVal
46064>>>>>>>>>>>        Function_Return rVal
46065>>>>>>>>>>>    End_Function
46066>>>>>>>>>>>
46066>>>>>>>>>>>    Function fsVresOxhmaDescr String asOxhmaCode Returns String
46067>>>>>>>>>>>        String rVal
46068>>>>>>>>>>>        Clear Cars
46069>>>>>>>>>>>        Move SysCurXr.Company_Code  to Cars.Car_Company
46070>>>>>>>>>>>        Move asOxhmaCode            to Cars.Car_ID
46071>>>>>>>>>>>        Find Eq Cars By Index.1 // Car_Company + Car_ID
46072>>>>>>>>>>>>
46072>>>>>>>>>>>
46072>>>>>>>>>>>        If (Found) Move (Trim(Cars.Car_License)) to rVal
46075>>>>>>>>>>>        Else Move '' to rVal
46077>>>>>>>>>>>        Function_Return rVal
46078>>>>>>>>>>>    End_Function
46079>>>>>>>>>>>
46079>>>>>>>>>>>    Function fsVresDriverCode String asOxhmaCode Returns String
46080>>>>>>>>>>>        String rVal
46081>>>>>>>>>>>        Clear Cars
46082>>>>>>>>>>>        Move SysCurXr.Company_Code  to Cars.Car_Company
46083>>>>>>>>>>>        Move asOxhmaCode            to Cars.Car_ID
46084>>>>>>>>>>>        Find Eq Cars By Index.1 // Car_Company + Car_ID
46085>>>>>>>>>>>>
46085>>>>>>>>>>>        If (Found)  Move (Trim(Cars.Car_DriverID)) to rVal
46088>>>>>>>>>>>        Else        Move '' to rVal
46090>>>>>>>>>>>        Function_Return rVal
46091>>>>>>>>>>>    End_Function
46092>>>>>>>>>>>
46092>>>>>>>>>>>    Function fsVresDriverDescr String asDriverCode Returns String
46093>>>>>>>>>>>        String rVal
46094>>>>>>>>>>>        Clear Drivers
46095>>>>>>>>>>>        Move SysCurXr.Company_Code  to Drivers.Driver_Company
46096>>>>>>>>>>>        Move asDriverCode           to Drivers.Driver_ID
46097>>>>>>>>>>>        Find Eq Drivers By Index.1 // Driver_Company + Driver_ID
46098>>>>>>>>>>>>
46098>>>>>>>>>>>        If (Found) Move (Trim(Drivers.Driver_Name)) to rVal
46101>>>>>>>>>>>        Else Move '' to rVal
46103>>>>>>>>>>>        Function_Return rVal
46104>>>>>>>>>>>    End_Function
46105>>>>>>>>>>>
46105>>>>>>>>>>>    Procedure Construct_Object
46106>>>>>>>>>>>        Forward Send Construct_Object
46108>>>>>>>>>>>        Property String     psOldCode       Public ''
46109>>>>>>>>>>>        Property Integer    piPmovesID      Public  0
46110>>>>>>>>>>>        Property String     psOldUserID     Public ''
46111>>>>>>>>>>>        Property Integer    piOldSelected   Public  0
46112>>>>>>>>>>>        Property Integer    piFromMetasx    Public  0 
46113>>>>>>>>>>>        Property Integer    PifromBhma1     Public  0 
46114>>>>>>>>>>>    End_procedure
46115>>>>>>>>>>>
46115>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
46116>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
46118>>>>>>>>>>>        Set psOldCode       to Particle.Nomisma_Code
46119>>>>>>>>>>>        Set psOldUserID     to Particle.Partl_ToposF
46120>>>>>>>>>>>        Set piOldSelected   to Particle.Partl_Selected
46121>>>>>>>>>>>    End_Procedure   // New_Current_Record
46122>>>>>>>>>>>
46122>>>>>>>>>>>    Procedure Shmera integer iField  Date dDate
46123>>>>>>>>>>>        Local Integer Changed
46124>>>>>>>>>>>        Get Field_Changed_State iField to Changed
46125>>>>>>>>>>>        If (Changed=0 AND dDate =0) Begin
46127>>>>>>>>>>>            SysDate4 dDate
46128>>>>>>>>>>>            Set Field_Default_Value iField to dDate
46129>>>>>>>>>>>        End
46129>>>>>>>>>>>>
46129>>>>>>>>>>>    End_Procedure   // Shmera
46130>>>>>>>>>>>
46130>>>>>>>>>>>    Procedure Shmera_Ora integer iField  Number nOra
46131>>>>>>>>>>>        Local Integer Changed
46132>>>>>>>>>>>        Date dDate
46132>>>>>>>>>>>        Number nHour nMin
46132>>>>>>>>>>>        Get Field_Changed_State iField to Changed
46133>>>>>>>>>>>        If (Changed=0 AND nOra =0) Begin
46135>>>>>>>>>>>            SysDate4 dDate nHour nMin
46138>>>>>>>>>>>            Set Field_Default_Value iField to (nHour+(nMin/100))
46139>>>>>>>>>>>        End
46139>>>>>>>>>>>>
46139>>>>>>>>>>>    End_Procedure   // Shmera
46140>>>>>>>>>>>
46140>>>>>>>>>>>    Procedure Shmera_Ora_String integer iField  String asOra
46141>>>>>>>>>>>        Local Integer Changed
46142>>>>>>>>>>>        Date dDate
46142>>>>>>>>>>>        Number nHour nMin nTotal
46142>>>>>>>>>>>        String sOra sMin
46142>>>>>>>>>>>        Get Field_Changed_State iField to Changed
46143>>>>>>>>>>>        If (Changed=0 AND asOra='') Begin
46145>>>>>>>>>>>            SysDate4 dDate nHour nMin
46148>>>>>>>>>>>            Move (nHour+(nMin/100)) to nTotal
46149>>>>>>>>>>>            Set Field_Default_Value iField to (fsConvert_Time_Number_To_String_With_Zeroes(nTotal))
46150>>>>>>>>>>>        End
46150>>>>>>>>>>>>
46150>>>>>>>>>>>    End_Procedure   // Shmera
46151>>>>>>>>>>>
46151>>>>>>>>>>>    Procedure Save_Main_File
46152>>>>>>>>>>>        String  sCodeApo sCodeEos sOldUserID sCurrentUserID
46153>>>>>>>>>>>        Integer iBreak iPmoves iSelected iOldSelected
46153>>>>>>>>>>>        Number  nPoso nPosoEuro nIsotimia nPosothtaKin
46153>>>>>>>>>>>        Date    dHmnia
46153>>>>>>>>>>>
46153>>>>>>>>>>>        If ((Operation_Origin<>Self) And ;            (Particle.Recnum=0)) Procedure_Return
46156>>>>>>>>>>>
46156>>>>>>>>>>>        If (Particle.Cn_Code<>'') Begin
46158>>>>>>>>>>>            Clear Cn
46159>>>>>>>>>>>            Move Particle.Cn_Code   to Cn.Cn_Code
46160>>>>>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
46161>>>>>>>>>>>>
46161>>>>>>>>>>>            If (Found) Begin
46163>>>>>>>>>>>                Move Cn.Cn_Sls_ID       to Particle.Sls_ID
46164>>>>>>>>>>>                Move Cn.CN_Cnt_ID       to Particle.Cnt_ID
46165>>>>>>>>>>>                Move Cn.CN_Recr         to Particle.CN_Recr
46166>>>>>>>>>>>            End
46166>>>>>>>>>>>>
46166>>>>>>>>>>>            Else Begin
46167>>>>>>>>>>>                Move ''                 to Particle.Sls_ID
46168>>>>>>>>>>>                Move ''                 to Particle.Cnt_ID
46169>>>>>>>>>>>                Move ''                 to Particle.CN_Recr
46170>>>>>>>>>>>            End
46170>>>>>>>>>>>>
46170>>>>>>>>>>>        End
46170>>>>>>>>>>>>
46170>>>>>>>>>>>        Else Begin
46171>>>>>>>>>>>            Move ''                 to Particle.Sls_ID
46172>>>>>>>>>>>            Move ''                 to Particle.Cnt_ID
46173>>>>>>>>>>>            Move ''                 to Particle.CN_Recr
46174>>>>>>>>>>>        End
46174>>>>>>>>>>>>
46174>>>>>>>>>>>
46174>>>>>>>>>>>        Move Pmoves.Recnum              to iPmoves
46175>>>>>>>>>>>
46175>>>>>>>>>>>        Move Particle.Partl_Selected    to iSelected
46176>>>>>>>>>>>        Get piOldSelected               to iOldSelected
46177>>>>>>>>>>>        Get fsLoginUserID               to sCurrentUserID
46178>>>>>>>>>>>        Get psOldUserID                 to sOldUserID
46179>>>>>>>>>>>
46179>>>>>>>>>>>        If (Particle.Partl_Disctof<>0) Begin
46181>>>>>>>>>>>            If (sOldUserID='') Move sCurrentUserID to Particle.Partl_Toposf
46184>>>>>>>>>>>        End
46184>>>>>>>>>>>>
46184>>>>>>>>>>>        Else Begin
46185>>>>>>>>>>>            Move '' to Particle.Partl_Toposf
46186>>>>>>>>>>>        End
46186>>>>>>>>>>>>
46186>>>>>>>>>>>
46186>>>>>>>>>>>        Move 0 to nPosothtaKin
46187>>>>>>>>>>>
46187>>>>>>>>>>>        //If (iSelected<>iOldSelected) Begin
46187>>>>>>>>>>>        If ((piFromMetasx(Self)) Or (iSelected<>iOldSelected))Begin
46189>>>>>>>>>>>            If ((Particle.Partl_Toposf=sCurrentUserID) Or (Particle.Partl_Toposf='')) Begin
46191>>>>>>>>>>>                If (iSelected) Begin
46193>>>>>>>>>>>                    Clear Pmoves
46194>>>>>>>>>>>                    Move Particle.Partl_Recr to Pmoves.Partl_Recr
46195>>>>>>>>>>>                    Find Gt Pmoves by index.3
46196>>>>>>>>>>>>
46196>>>>>>>>>>>                    While ((Found=1) And (Pmoves.Partl_Recr=Particle.Partl_Recr))
46200>>>>>>>>>>>                        Move Pmoves.Timol_Ypol  to Pmoves.Qty_Kinhshs
46201>>>>>>>>>>>                        Add  Pmoves.Timol_Ypol  to nPosothtaKin
46202>>>>>>>>>>>                        Move 1              to Pmoves.Pms_Selected
46203>>>>>>>>>>>                        Saverecord Pmoves
46204>>>>>>>>>>>                        Find Gt Pmoves by index.3
46205>>>>>>>>>>>>
46205>>>>>>>>>>>                    Loop
46206>>>>>>>>>>>>
46206>>>>>>>>>>>                    Move sCurrentUserID to Particle.Partl_Toposf
46207>>>>>>>>>>>                    Move nPosothtaKin   to Particle.Partl_Disctof
46208>>>>>>>>>>>                End
46208>>>>>>>>>>>>
46208>>>>>>>>>>>                Else Begin
46209>>>>>>>>>>>                    Clear Pmoves
46210>>>>>>>>>>>                    Move Particle.Partl_Recr to Pmoves.Partl_Recr
46211>>>>>>>>>>>                    Find Gt Pmoves by index.3
46212>>>>>>>>>>>>
46212>>>>>>>>>>>                    While ((Found=1) And (Pmoves.Partl_Recr=Particle.Partl_Recr))
46216>>>>>>>>>>>                        Move 0 to Pmoves.Qty_Kinhshs
46217>>>>>>>>>>>                        Move 0 to Pmoves.Pms_Selected
46218>>>>>>>>>>>                        Saverecord Pmoves
46219>>>>>>>>>>>                        Find Gt Pmoves by index.3
46220>>>>>>>>>>>>
46220>>>>>>>>>>>                    Loop
46221>>>>>>>>>>>>
46221>>>>>>>>>>>                    Move '' to Particle.Partl_Toposf
46222>>>>>>>>>>>                    Move 0  to Particle.Partl_Disctof
46223>>>>>>>>>>>                End
46223>>>>>>>>>>>>
46223>>>>>>>>>>>
46223>>>>>>>>>>>//                // js 11/04/2003
46223>>>>>>>>>>>//                If (iPmoves) Begin
46223>>>>>>>>>>>//                    Clear Pmoves
46223>>>>>>>>>>>//                    Move iPmoves to Pmoves.Recnum
46223>>>>>>>>>>>//                    Find Eq Pmoves.Recnum
46223>>>>>>>>>>>//                End
46223>>>>>>>>>>>
46223>>>>>>>>>>>            End
46223>>>>>>>>>>>>
46223>>>>>>>>>>>            Set piFromMetasx to 0
46224>>>>>>>>>>>        End
46224>>>>>>>>>>>>
46224>>>>>>>>>>>
46224>>>>>>>>>>>        Forward Send Save_Main_File
46226>>>>>>>>>>>
46226>>>>>>>>>>>    End_Procedure   // Save_Main_File
46227>>>>>>>>>>>
46227>>>>>>>>>>>
46227>>>>>>>>>>>    Procedure Calc_The_Totals
46228>>>>>>>>>>>        Number nPct nPoso nAxia nTmp
46229>>>>>>>>>>>
46229>>>>>>>>>>>        Move (Particle.Partl_AMDISCPMS  + ;              Particle.Partl_TotDiscPc)         to Particle.Partl_DiscAm
46230>>>>>>>>>>>
46230>>>>>>>>>>>        Move (Particle.Partl_TotAmBD    - ;              Particle.Partl_DiscAm)            to Particle.Partl_TotAmAd
46231>>>>>>>>>>>
46231>>>>>>>>>>>        Move (Particle.Partl_TotAmAd    + ;              Particle.Partl_Extra)             to Particle.Partl_GenAm
46232>>>>>>>>>>>
46232>>>>>>>>>>>        If ((Particle.Partl_Extra<>0) And (Particle.Partl_ExtraVatP<>0)) Begin
46234>>>>>>>>>>>            Move (Round(Particle.Partl_Extra        *;                        Particle.Partl_ExtraVatP    /;                  100))                         to Particle.Partl_ExtraVat
46235>>>>>>>>>>>        End
46235>>>>>>>>>>>>
46235>>>>>>>>>>>
46235>>>>>>>>>>>        If ((Particle.Partl_TotDiscPC<>0) And (Particle.Disc_Vat_Pct<>0)) Begin
46237>>>>>>>>>>>            Move (Round(Particle.Partl_TotDiscPC    *;                        Particle.Disc_Vat_Pct       /;                  100))                         to Particle.Disc_Vat_Poso
46238>>>>>>>>>>>        End
46238>>>>>>>>>>>>
46238>>>>>>>>>>>
46238>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
46238>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
46238>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
46238>>>>>>>>>>>        If (Sysfile.Fpa_On_Total=0) Begin
46240>>>>>>>>>>>            Move (Particle.Partl_Vatam-Particle.Disc_Vat_Poso+Particle.Partl_ExtraVat) ;                to Particle.Total_Vat_Poso
46241>>>>>>>>>>>        End
46241>>>>>>>>>>>>
46241>>>>>>>>>>>        Else Begin
46242>>>>>>>>>>>            If (Particle.Fpa_On_Total<>0) ;                Move (Particle.Fpa_On_Total-Particle.Disc_Vat_Poso+Particle.Partl_ExtraVat) ;                    to Particle.Total_Vat_Poso
46245>>>>>>>>>>>            Else ;                Move (Particle.Partl_Vatam-Particle.Disc_Vat_Poso+Particle.Partl_ExtraVat) ;                    to Particle.Total_Vat_Poso
46247>>>>>>>>>>>        End
46247>>>>>>>>>>>>
46247>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
46247>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
46247>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
46247>>>>>>>>>>>
46247>>>>>>>>>>>        Move (Particle.Partl_GenAm      + ;              Particle.Total_Vat_Poso ) to Particle.Partl_PayAm
46248>>>>>>>>>>>
46248>>>>>>>>>>>        If (Particle.PARTL_TOTTEM>0) Begin
46250>>>>>>>>>>>            Move (Particle.PARTL_TOTTEM-Particle.Timol_Qty) ;                                            to Particle.Timol_Ypol
46251>>>>>>>>>>>
46251>>>>>>>>>>>            Move (Particle.Timol_Ypol=0)    to Particle.Partl_Timol
46252>>>>>>>>>>>
46252>>>>>>>>>>>        End
46252>>>>>>>>>>>>
46252>>>>>>>>>>>        Else Move 0 to Particle.Partl_Timol
46254>>>>>>>>>>>
46254>>>>>>>>>>>        Move Particle.Partl_TotAmAD  to nAxia
46255>>>>>>>>>>>        Move Particle.Parakrat_Pct   to nPct
46256>>>>>>>>>>>        Move (Round_Number(((nAxia*nPct)/100),2)) to nTmp
46257>>>>>>>>>>>        Move nTmp to Particle.Parakrat_Poso
46258>>>>>>>>>>>    End_Procedure
46259>>>>>>>>>>>
46259>>>>>>>>>>>    Procedure Find_The_Rate
46260>>>>>>>>>>>        String  sCode sWhat
46261>>>>>>>>>>>        Integer iRateID
46261>>>>>>>>>>>        Number nEuro nIsot nRate
46261>>>>>>>>>>>        Date dHmnia
46261>>>>>>>>>>>        Move Nomisma.Nomisma_Code                   to sCode
46262>>>>>>>>>>>        If (Trim(sCode)='') Move SysCurXr.C_Code0   to sCode
46265>>>>>>>>>>>        Move Particle.Partl_Hmnia       to dHmnia
46266>>>>>>>>>>>        Move Particle.Isotimia          to nIsot
46267>>>>>>>>>>>        If (nIsot=0) Begin
46269>>>>>>>>>>>            If (dHmnia='') Sysdate dHmnia
46272>>>>>>>>>>>            Move (Trim(sCode)) to sCode
46273>>>>>>>>>>>            Clear Isotimia
46274>>>>>>>>>>>            Move sCode      to Isotimia.Nomisma_Code
46275>>>>>>>>>>>            Move (dHmnia+1) to Isotimia.Isotimia_Hmnia
46276>>>>>>>>>>>            Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
46277>>>>>>>>>>>>
46277>>>>>>>>>>>            If (Nomisma.Einai_Drx) Move 1 to Particle.Isotimia
46280>>>>>>>>>>>            Else Begin
46281>>>>>>>>>>>                Case Begin
46281>>>>>>>>>>>                    case (isotimia.poia_metatrepei='€') // Agora
46283>>>>>>>>>>>                        Move Isotimia.Isotimia_Agora to Particle.Isotimia
46284>>>>>>>>>>>                        Case Break
46285>>>>>>>>>>>                    case (isotimia.poia_metatrepei='') // Polhsh
46288>>>>>>>>>>>                        Move Isotimia.Isotimia_Polhsh to Particle.Isotimia
46289>>>>>>>>>>>                        Case Break
46290>>>>>>>>>>>                    Case (Isotimia.Poia_Metatrepei='F') // Fixing
46293>>>>>>>>>>>                        Move Isotimia.Isotimia_Fixing to Particle.Isotimia
46294>>>>>>>>>>>                        Case Break
46295>>>>>>>>>>>                    Case (Isotimia.Poia_Metatrepei='P') // Private
46298>>>>>>>>>>>                        Move Isotimia.Isotimia_Privat to Particle.Isotimia
46299>>>>>>>>>>>                        Case Break
46300>>>>>>>>>>>                Case End
46300>>>>>>>>>>>            End
46300>>>>>>>>>>>>
46300>>>>>>>>>>>        End
46300>>>>>>>>>>>>
46300>>>>>>>>>>>        Else Begin
46301>>>>>>>>>>>            If (dHmnia='') Sysdate      dHmnia
46304>>>>>>>>>>>            Move (Trim(sCode))      to  sCode
46305>>>>>>>>>>>            Clear Nomisma
46306>>>>>>>>>>>            Move sCode              to Nomisma.Nomisma_Code
46307>>>>>>>>>>>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
46308>>>>>>>>>>>>
46308>>>>>>>>>>>            If (Nomisma.Einai_Drx) Move 1 to Particle.Isotimia
46311>>>>>>>>>>>        End
46311>>>>>>>>>>>>
46311>>>>>>>>>>>    End_Procedure
46312>>>>>>>>>>>
46312>>>>>>>>>>>    Procedure Update
46313>>>>>>>>>>>        String  sCodeApo sCodeEos
46314>>>>>>>>>>>        String  sCar sCarDescr sDriver sDriverDescr
46314>>>>>>>>>>>        Integer iBreak iPmovesID
46314>>>>>>>>>>>        Number  nPoso nPosoEuro nIsotimia
46314>>>>>>>>>>>        Date    dHmnia
46314>>>>>>>>>>>
46314>>>>>>>>>>>        Forward Send Update
46316>>>>>>>>>>>
46316>>>>>>>>>>>        Send Find_The_Rate
46317>>>>>>>>>>>
46317>>>>>>>>>>>        Move SysCurXR.Company_Code  to Particle.Company_Code
46318>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Particle.Branch_Code
46319>>>>>>>>>>>        Move SysCurXR.Year_Year     to Particle.Year_Year
46320>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code   to Particle.Ctypkin_Code
46321>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code   to Particle.Wtypkin_Code
46322>>>>>>>>>>>        //Move Custprom.Custprom_Code to Particle.Custprom_Code
46322>>>>>>>>>>>        Move Clients.Client_ID      to Particle.Client_ID
46323>>>>>>>>>>>        Move Ptyppar.Ptyppar_Code   to Particle.Ptyppar_Code
46324>>>>>>>>>>>        Move Ptyppar.Ptyppar_Module to Particle.Partl_Module
46325>>>>>>>>>>>
46325>>>>>>>>>>>        Move Payresp.Presp_ID       to Particle.Presp_ID
46326>>>>>>>>>>>
46326>>>>>>>>>>>        Send Calc_The_Totals
46327>>>>>>>>>>>
46327>>>>>>>>>>>        Move    Particle.Oxhma_Code             to sCar
46328>>>>>>>>>>>        Get     fsVresOxhmaDescr sCar           to Particle.Oxhma_Descr
46329>>>>>>>>>>>        Get     fsVresDriverCode sCar           to Particle.Odhgos_Code
46330>>>>>>>>>>>        Move    Particle.Odhgos_Code            to sDriver
46331>>>>>>>>>>>        Get     fsVresDriverDescr sDriver       to Particle.Odhgos_Name
46332>>>>>>>>>>>        Move    Particle.Antlia_Code            to sCar
46333>>>>>>>>>>>        Get     fsVresAntliaDescr sCar          to sCarDescr
46334>>>>>>>>>>>        Move    sCarDescr                       to Particle.Antlia_Descr
46335>>>>>>>>>>>
46335>>>>>>>>>>>
46335>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
46335>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
46335>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
46335>>>>>>>>>>>//        If (Particle.Partl_ExtraVat) Begin
46335>>>>>>>>>>>//            Clear PartlFpa
46335>>>>>>>>>>>//            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
46335>>>>>>>>>>>//            Move Particle.Partl_ExtraVatP   to PartlFpa.Fpa_Pososto
46335>>>>>>>>>>>//            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
46335>>>>>>>>>>>//            Add Particle.Partl_ExtraVat     to PartlFpa.PartlFpa_Poso
46335>>>>>>>>>>>//            Saverecord PartlFpa
46335>>>>>>>>>>>//        End
46335>>>>>>>>>>>
46335>>>>>>>>>>>//        If (Particle.Disc_Vat_Poso) Begin
46335>>>>>>>>>>>//            Clear PartlFpa
46335>>>>>>>>>>>//            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
46335>>>>>>>>>>>//            Move Particle.Disc_Vat_Pct      to PartlFpa.Fpa_Pososto
46335>>>>>>>>>>>//            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
46335>>>>>>>>>>>//            Add Particle.Disc_Vat_Poso      to PartlFpa.PartlFpa_Poso
46335>>>>>>>>>>>//            Saverecord PartlFpa
46335>>>>>>>>>>>//        End
46335>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
46335>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
46335>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
46335>>>>>>>>>>>
46335>>>>>>>>>>>        // 01/10/2001 Mphke edo anti gia thn creating gia na kalipsei to problhma
46335>>>>>>>>>>>        // pou proekeipte an gia kapoio logo den symplhrvnotan seira kai o arithmos
46335>>>>>>>>>>>        // emene 0 eprepe na sbhstoun OLA ta lines kai to idio to parastatiko gia na
46335>>>>>>>>>>>        // xanatrexei o kodikas elegxou seiras kai arithmou
46335>>>>>>>>>>>        // Tora trexei sthn Update (giati sthn Save_Main_File kanei validation
46335>>>>>>>>>>>        // PRIN kai kobei thn eggrafh epeidh o arithmos einai 0
46335>>>>>>>>>>>        If ( ((Operation_Origin=Self) Or                 ;             (Operation_Origin=(piPmovesID(Self)))) And  ;             (Particle.Partl_No=0)) Send Kathorise_Thn_Seira
46338>>>>>>>>>>>        // 01/10/2001
46338>>>>>>>>>>>    End_Procedure   // Update
46339>>>>>>>>>>>
46339>>>>>>>>>>>    Procedure Backout
46340>>>>>>>>>>>        Forward Send Backout
46342>>>>>>>>>>>        Send Calc_The_Totals
46343>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
46343>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
46343>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
46343>>>>>>>>>>>//        If (Particle.Partl_ExtraVat) Begin
46343>>>>>>>>>>>//            Clear PartlFpa
46343>>>>>>>>>>>//            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
46343>>>>>>>>>>>//            Move Particle.Partl_ExtraVatP   to PartlFpa.Fpa_Pososto
46343>>>>>>>>>>>//            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
46343>>>>>>>>>>>//            Sub Particle.Partl_ExtraVat   From PartlFpa.PartlFpa_Poso
46343>>>>>>>>>>>//            Saverecord PartlFpa
46343>>>>>>>>>>>//            If (PartlFpa.PartlFpa_Poso=0) Delete PartlFpa
46343>>>>>>>>>>>//        End
46343>>>>>>>>>>>
46343>>>>>>>>>>>//        If (Particle.Disc_Vat_Poso) Begin
46343>>>>>>>>>>>//            Clear PartlFpa
46343>>>>>>>>>>>//            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
46343>>>>>>>>>>>//            Move Particle.Disc_Vat_Pct      to PartlFpa.Fpa_Pososto
46343>>>>>>>>>>>//            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
46343>>>>>>>>>>>//            Sub Particle.Disc_Vat_Poso    From PartlFpa.PartlFpa_Poso
46343>>>>>>>>>>>//            Saverecord PartlFpa
46343>>>>>>>>>>>//            If (PartlFpa.PartlFpa_Poso=0) Delete PartlFpa
46343>>>>>>>>>>>//        End
46343>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
46343>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
46343>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
46343>>>>>>>>>>>    End_Procedure
46344>>>>>>>>>>>
46344>>>>>>>>>>>    Procedure Kathorise_Thn_Seira
46345>>>>>>>>>>>        Integer iNextNo iSeiraRecnum iPtypparRecnum
46346>>>>>>>>>>>
46346>>>>>>>>>>>//       js 25/04/2002 Prosthikh gia na ypostirixei ektyposh promhtheyton
46346>>>>>>>>>>>        If (Ptyppar.Ptyppar_Is_What='2') Begin
46348>>>>>>>>>>>            Clear Pseira
46349>>>>>>>>>>>            Move SysCurXr.Company_Code  to Pseira.Company_Code
46350>>>>>>>>>>>            Move SysCurXr.Branch_Code   to Pseira.Branch_Code
46351>>>>>>>>>>>            //Move SysCurXr.Year_Year     to Pseira.Year_Year
46351>>>>>>>>>>>            //Move Ctypkin.Ctypkin_Code   to Pseira.Ctypkin_Code
46351>>>>>>>>>>>            //Move Wtypkin.Wtypkin_Code   to Pseira.Wtypkin_Code
46351>>>>>>>>>>>            Move Ptyppar.Ptyppar_Code   to Pseira.Ptyppar_Code
46352>>>>>>>>>>>            Move Particle.Pseira_Seira  to Pseira.Pseira_Seira
46353>>>>>>>>>>>            Find eq Pseira By Index.1 // Pseira:Index.1:Company_Code+Branch_Code+Year_Year+;
46354>>>>>>>>>>>>
46354>>>>>>>>>>>                                    //                Ctypkin_Code+Wtypkin_Code+Ptyppar_Code+Seira_Seira
46354>>>>>>>>>>>            If (Found=1) Begin
46356>>>>>>>>>>>                // €¤ ž ©œ ¨˜ œ ¤˜  autonum ¡˜  «¦ §˜¨˜©«˜« ¡¦ œ ¤˜  «¬§¦¬ 2 —Š†‘†
46356>>>>>>>>>>>                If ((Pseira.Pseira_Autonum  = 1)    And ;                    (Particle.Partl_No      = 0 )) Begin
46358>>>>>>>>>>>                    Move (Pseira.Autonum_Minus-1) to iNextNo
46359>>>>>>>>>>>                    Move (Pseira.Autonum_Minus-1) to Pseira.Autonum_Minus
46360>>>>>>>>>>>                    Saverecord Pseira
46361>>>>>>>>>>>                    Move iNextNo to Particle.Partl_No
46362>>>>>>>>>>>                End
46362>>>>>>>>>>>>
46362>>>>>>>>>>>            End
46362>>>>>>>>>>>>
46362>>>>>>>>>>>        End
46362>>>>>>>>>>>>
46362>>>>>>>>>>>        Else Begin
46363>>>>>>>>>>>//       js 25/04/2002 Prosthikh gia na ypostirixei ektyposh promhtheyton
46363>>>>>>>>>>>            If ((Ptyppar.Ptyppar_Is_What='1') And (Trim(Ptyppar.Sysxet_Ptyppar)<>'')) Begin
46365>>>>>>>>>>>                Move (Random(-10000000)-1) To Particle.Partl_No
46366>>>>>>>>>>>            End
46366>>>>>>>>>>>>
46366>>>>>>>>>>>        End
46366>>>>>>>>>>>>
46366>>>>>>>>>>>    End_Procedure
46367>>>>>>>>>>>
46367>>>>>>>>>>>    Procedure Creating
46368>>>>>>>>>>>        Integer iNextNo
46369>>>>>>>>>>>        String  sNo sSeira
46369>>>>>>>>>>>        Forward Send Creating
46371>>>>>>>>>>>        // Insert Code Here
46371>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                         (Trim(String(Particle.Partl_Rec0)))))) to Particle.Partl_Recr
46372>>>>>>>>>>>
46372>>>>>>>>>>>        If (Particle.Disc_Vat_Pct   =0) Move 19 to Particle.Disc_Vat_Pct
46375>>>>>>>>>>>        If (Particle.Partl_ExtraVatP=0) Move 19 to Particle.Partl_ExtraVatP
46378>>>>>>>>>>>
46378>>>>>>>>>>>        Move Clients.Ypoloipo to Particle.Prohg_Ypol
46379>>>>>>>>>>>
46379>>>>>>>>>>>        If ((Trim(Ptyppar.Ti_Typonei_Pms)<>'2') And (Trim(Particle.Cn_Code)<>'')) Begin
46381>>>>>>>>>>>            Clear Cn
46382>>>>>>>>>>>            Move Particle.Cn_Code   to Cn.Cn_Code
46383>>>>>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
46384>>>>>>>>>>>>
46384>>>>>>>>>>>            If (Found) Begin
46386>>>>>>>>>>>                Move Particle.Partl_No      to sNo
46387>>>>>>>>>>>                Move Particle.Pseira_Seira  to sSeira
46388>>>>>>>>>>>                Move (Trim(sNo))            to sNo
46389>>>>>>>>>>>                Move (Trim(sSeira))         to sSeira
46390>>>>>>>>>>>                if (cn.hm_prot_fortio='')   Move Particle.Partl_Hmnia   to Cn.Hm_prot_Fortio
46393>>>>>>>>>>>                Move Particle.Partl_Hmnia   to Cn.Hm_Tel_Fortio
46394>>>>>>>>>>>                Move (Trim(sSeira+' '+sNo)) to Cn.Tel_Fortio_No
46395>>>>>>>>>>>                Saverecord CN
46396>>>>>>>>>>>            End
46396>>>>>>>>>>>>
46396>>>>>>>>>>>        End 
46396>>>>>>>>>>>>
46396>>>>>>>>>>>        // sta deltia apostolhs bhma1 den theloyme na ginetai elegxos opos
46396>>>>>>>>>>>        // kai sta aytonoma deltia apostolhs
46396>>>>>>>>>>>        if (PifromBhma1(self)=0) begin
46398>>>>>>>>>>>            if (clients.client_ptyppar='100') begin
46400>>>>>>>>>>>                if (ptyppar.is_xondr<>'1');                    error 5716 '‘œ œ¢á«ž •¦¤›¨ ¡ãª ›œ¤ £§¦¨œåª ¤˜ ¡æ¯œ ª ˜¨˜©«˜« ¡æ Š ˜¤ ¡ãª !!' 
46403>>>>>>>>>>>            end
46403>>>>>>>>>>>>
46403>>>>>>>>>>>            else if (clients.client_ptyppar='113') begin 
46406>>>>>>>>>>>                if (ptyppar.is_xondr='1');                    error 5717 '‘œ œ¢á«ž Š ˜¤ ¡ãª ›œ¤ £§¦¨œåª ¤˜ ¡æ¯œ ª ˜¨˜©«˜« ¡æ •¦¤›¨ ¡ãª !!' 
46409>>>>>>>>>>>            end
46409>>>>>>>>>>>>
46409>>>>>>>>>>>        End
46409>>>>>>>>>>>>
46409>>>>>>>>>>>    End_Procedure   // Creating
46410>>>>>>>>>>>
46410>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
46411>>>>>>>>>>>        String sStr
46412>>>>>>>>>>>        Move '' to sStr
46413>>>>>>>>>>>        Append sStr "DDC 14: ’¦ §˜¨˜©«˜« ¡æ §œ¨ â®œ  œ¤˜ œå›¦ª «¦ ¦§¦å¦\n"
46414>>>>>>>>>>>        Append sStr "§˜¨¦¬© áœ  ¡å¤ž©ž §¨¦ª £œ«˜©®ž£˜« ©£æ ˜§¦ «¦¤ ®¨ã©«ž\n"
46415>>>>>>>>>>>        Append sStr Particle.Partl_Toposf ". ˜«ã©«œ F5 £œ«˜ «¦ Ž‰"
46417>>>>>>>>>>>
46417>>>>>>>>>>>             If (iError_Num = 1001) Error 1001 "DDC 14: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ˜¨˜©«˜« ¡¦ç"
46420>>>>>>>>>>>        Else If (iError_Num = 1002) Error 1002 "DDC 14: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ”¦¨â˜"
46424>>>>>>>>>>>        Else If (iError_Num = 1003) Error 1003 "DDC 14: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã Œ¦£å©£˜«¦ª"
46428>>>>>>>>>>>        Else If (iError_Num = 1004) Error 1004 "DDC 14: †£œ¨¦£ž¤å˜ §˜¨˜©«˜« ¡¦ç ¡œ¤ã"
46432>>>>>>>>>>>        Else If (iError_Num = 1005) Error 1005 "DDC 14: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
46436>>>>>>>>>>>        Else If (iError_Num = 1006) Error 1006 "DDC 14: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
46440>>>>>>>>>>>        Else If (iError_Num = 1007) Error 1007 "DDC 14: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
46444>>>>>>>>>>>        Else If (iError_Num = 1008) Error 1008 "DDC 14: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
46448>>>>>>>>>>>        Else If (iError_Num = 1009) Error 1009 "DDC 14: ƒœ¤ œå¤˜  œ­ ¡«ã ž › ˜š¨˜­ã \n„®œ  ›ž£ ¦¬¨šžŸœå £œ«˜©®ž£˜« ©£â¤¦ §˜¨˜©«˜« ¡æ"
46452>>>>>>>>>>>        Else If (iError_Num = 1010) Error 1010 "DDC 14: † é¨˜ §¨â§œ  ¤˜ ›¦Ÿœå\n£œ 2 ¯ž­å˜ š ˜ «ž¤ é¨˜ ¡˜  2 š ˜ «˜ ¢œ§«á"
46456>>>>>>>>>>>        Else If (iError_Num = 1011) Error 1011 "DDC 14: †£œ¨¦£ž¤å˜ §¨¦šœ¤â©«œ¨ž «žª «œ¢œ¬«˜å˜ª œ¡«ç§à©žª"
46460>>>>>>>>>>>        Else If (iError_Num = 1012) Error 1012 sStr
46464>>>>>>>>>>>        Else If (iError_Num = 1055) Error 1055 "DDC 14: †£œ¨¦£ž¤åœª œ¡«æª ¦¨åà¤ ®¨ã©žª"
46468>>>>>>>>>>>        Else If (iError_Num = 1060) Error 1060 "DDC 14: ˜¨˜©«˜« ¡æ £œ«˜©®ž£˜« ©£â¤¦.\nƒœ¤ œ§ «¨â§œ«˜  ¦§¦ ˜›ã§¦«œ ˜¢¢˜šã ©«¦ ®œåà¤"
46472>>>>>>>>>>>        Else If (iError_Num = 1061) Error 1061 "DDC 14: ˜¨˜©«˜« ¡æ £œ«˜©®ž£˜« ©£â¤¦.\nƒœ¤ œ§ «¨â§œ«˜  ¤˜ › ˜š¨˜­œå"
46476>>>>>>>>>>>        Else If (iError_Num = 6040) Error 6040 "DDC 14: ƒœ¤ â®œ  §¨¦©› ¦¨ ©«œå ¡à› ¡æª ¤¦£å©£˜«¦ª"
46480>>>>>>>>>>>        Else If (iError_Num = 6050) Error 6050 "DDC 14: Ž œ¢á«žª ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž"
46484>>>>>>>>>>>        Else If (iError_Num = 6051) Error 6051 "DDC 14: ’¦ §˜¨˜©«˜« ¡æ ¡ ¤œå ˜¥åœª ˜¢¢á «¦ ©ç¤¦¢¦ «à¤ ˜¥ é¤ «¦¬ œå¤˜  £ž›œ¤ ¡æ"
46488>>>>>>>>>>>        Else If (iError_Num = 6060) Error 6060 "DDC 14: Ž “§œçŸ¬¤¦ª ¢ž¨à£é¤ ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž"
46492>>>>>>>>>>>        Else If (iError_Num = 1110) Error 1110 "DDC 14: †£/¤å˜ §˜¨˜©«˜« ¡¦ç <= †£/¤å˜ª ¡¢œ ©å£˜«¦ª\nƒœ¤ œ§ «¨â§œ«˜  ¡˜££å˜ «¨¦§¦§¦åž©ž ©«¦ §˜¨˜©«˜« ¡æ"
46496>>>>>>>>>>>        Else If (iError_Num = 1065) Error 1065 "DDC 14: Ž €¨ Ÿ£æª «¦¬ §˜¨˜©«˜« ¡¦ç \nƒ„Œ §¨â§œ  ¡˜  ›œ¤ £§¦¨œå ¤˜ œå¤˜  £ž›œ¤ ¡æª"
46500>>>>>>>>>>>        Else If (iError_Num = 1099) Error 1099 "DDC 14: ‰˜«žš¦¨å˜ œ¢á«ž › ˜­¦¨œ« ¡ã ¡˜«žš¦¨å˜ª ˜¨˜©«˜« ¡¦ç.\n„¢œš®¦ª ¡˜«žš¦¨å˜ª Š ˜¤ ¡ãª / •¦¤›¨ ¡ãª"
46504>>>>>>>>>>>        Else Forward Send Operation_Not_Allowed  iError_Num
46507>>>>>>>>>>>    End_Procedure   // Operation_Not_Allowed
46508>>>>>>>>>>>
46508>>>>>>>>>>>    Function Validate_Save Returns Integer
46509>>>>>>>>>>>        Number nqty
46510>>>>>>>>>>>        Integer iReturnVal iYes
46510>>>>>>>>>>>        String  sCurrentUserID sOldUserID
46510>>>>>>>>>>>
46510>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
46512>>>>>>>>>>>
46512>>>>>>>>>>>        If (Not(iReturnVal)) Begin
46514>>>>>>>>>>>                 If (Ptyppar.Recnum      = 0)   Move 1001 to iReturnVal
46517>>>>>>>>>>>            Else If (Clients.Recnum      = 0)   Move 1002 to iReturnVal
46521>>>>>>>>>>>            Else If (Nomisma.Recnum      = 0)   Move 1003 to iReturnVal
46525>>>>>>>>>>>            Else If (Particle.Partl_Hmnia='')   Move 1004 to iReturnVal
46529>>>>>>>>>>>            Else If  Nomisma.nomisma_Code eq '' Move 6040 to iReturnVal
46533>>>>>>>>>>>          //  else if (clients.is_xondr ne ptyppar.is_xondr) move 1099 to iReturnVal
46533>>>>>>>>>>>            Else Begin
46534>>>>>>>>>>>//                If ((Clients.Plafon>0) And (Clients.OverHead<1) And (Sysfile.Over_OverHead<>'1')) Begin
46534>>>>>>>>>>>//                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
46534>>>>>>>>>>>//                    If (iYes=MBR_NO) Move 6050 to iReturnVal
46534>>>>>>>>>>>//                End
46534>>>>>>>>>>>//                Else If ((Clients.Plafon>0) And (PayResp.Plafon>0) And (PayResp.OverHead<1) And (Sysfile.Over_OverHead<>'1')) Begin
46534>>>>>>>>>>>//                    Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
46534>>>>>>>>>>>//                    If (iYes=MBR_NO) Move 6060 to iReturnVal
46534>>>>>>>>>>>//                End
46534>>>>>>>>>>>//                Else If ((PayResp.Plafon>0) And (PayResp.OverHead<1) And (Sysfile.Over_OverHead<>'1')) begin
46534>>>>>>>>>>>//                    Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
46534>>>>>>>>>>>//                    If (iYes=MBR_NO) Move 6060 to iReturnVal
46534>>>>>>>>>>>//                End
46534>>>>>>>>>>>
46534>>>>>>>>>>>                If ((Particle.Partl_Hmnia<SYSCURXR.YEAR_XRHSHFROM) Or ;                    (Particle.Partl_Hmnia>SYSCURXR.YEAR_XRHSHTO))     ;                                                Move 1055 to iReturnVal
46537>>>>>>>>>>>                Else Begin
46538>>>>>>>>>>>                    If (Particle.Partl_Disctof<>0) Begin
46540>>>>>>>>>>>                        Get fsLoginUserID to sCurrentUserID
46541>>>>>>>>>>>                        Get psOldUserID   to sOldUserID
46542>>>>>>>>>>>                        If (sOldUserID<>'') Begin
46544>>>>>>>>>>>                            If (sOldUserID<>sCurrentUserID) Move 1012 to iReturnVal
46547>>>>>>>>>>>                        End
46547>>>>>>>>>>>>
46547>>>>>>>>>>>                        //Else Move sCurrentUserID to Particle.Partl_Toposf
46547>>>>>>>>>>>                    End
46547>>>>>>>>>>>>
46547>>>>>>>>>>>                    //Else Move '' to Particle.Partl_Toposf
46547>>>>>>>>>>>                End
46547>>>>>>>>>>>>
46547>>>>>>>>>>>            End
46547>>>>>>>>>>>>
46547>>>>>>>>>>>/////////////////////////////////////////////////////////////////////////////
46547>>>>>>>>>>>// js 26/08/2002 Erothsh: Pos tha piaso ena parastatiko to opoio kinei
46547>>>>>>>>>>>//               axies alla katalhgei na exei geniko synolo 0 (an p.x.
46547>>>>>>>>>>>//               ginoun ekptoseis 100%.
46547>>>>>>>>>>>//               Apanthsh: To piano edo me ton oro oti den mporei na kopsei
46547>>>>>>>>>>>//               timologio m'ena eidos mono to opoio exei ekptosh 100%, opote
46547>>>>>>>>>>>//               ef'oson tha yparxoun pano apo ena eidos, to eidos me thn
46547>>>>>>>>>>>//               ekptosh prepei na kataxorithei san 2o kai meta.POTE proto
46547>>>>>>>>>>>//               giati etsi tha exei 0 to synolo tou parastatikou kai tha
46547>>>>>>>>>>>//               varesei to validation.
46547>>>>>>>>>>>
46547>>>>>>>>>>>// Rem giati sthn fash metasxhmatismou apo DAP se TIM den yparxoun times sto DAP
46547>>>>>>>>>>>// opote kai to TIM pou paragetai den exei times (Eno leme pos TIM xoris times den ginetai
46547>>>>>>>>>>>// Bebaia edo mporoume na elegxoume epipleon an to paragomeno erxetai apo metasxhmatismo
46547>>>>>>>>>>>// opote kai tha to afhname. NA TO DOUME.
46547>>>>>>>>>>>//            Else If ((Sysfile.Mhdeniko_Partl=0) And (Ptyppar.Ti_Typonei_Pms<>'1') And ;
46547>>>>>>>>>>>//                     (Particle.Partl_Payam=0)   And (Particle.Partl_NoOfLines>0)) ;
46547>>>>>>>>>>>//                    Move 6051 to iReturnVal
46547>>>>>>>>>>>
46547>>>>>>>>>>>/////////////////////////////////////////////////////////////////////////////
46547>>>>>>>>>>>
46547>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
46550>>>>>>>>>>>        End
46550>>>>>>>>>>>>
46550>>>>>>>>>>>        Function_Return iReturnVal
46551>>>>>>>>>>>    End_Function   // Validate_Save
46552>>>>>>>>>>>
46552>>>>>>>>>>>
46552>>>>>>>>>>>    Function Validate_Delete  Returns Integer
46553>>>>>>>>>>>        Integer iReturnVal
46554>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
46556>>>>>>>>>>>        If (Not(iReturnVal)) Begin
46558>>>>>>>>>>>            If (Particle.Partl_Timol = 1) Move 1009 to iReturnVal
46561>>>>>>>>>>>            Else If ( (Sysfile.Hm_Kleisimatos<>'') And ;                      (Particle.Partl_Hmnia<=Sysfile.Hm_Kleisimatos) ) ;                     Move 1110 to iReturnVal
46565>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
46568>>>>>>>>>>>        End
46568>>>>>>>>>>>>
46568>>>>>>>>>>>        Function_Return iReturnVal
46569>>>>>>>>>>>    End_Function   // Validate_Delete
46570>>>>>>>>>>>
46570>>>>>>>>>>>
46570>>>>>>>>>>>    // Define_Fields:
46570>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
46570>>>>>>>>>>>
46570>>>>>>>>>>>    Procedure Define_Fields
46571>>>>>>>>>>>        Forward Send Define_Fields
46573>>>>>>>>>>>        //DDB-Generated-Code-Location
46573>>>>>>>>>>>        //DDB-DefineFieldStart
46573>>>>>>>>>>>
46573>>>>>>>>>>>        Set Main_File            To Particle.File_Number
46574>>>>>>>>>>>
46574>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
46575>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
46576>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
46577>>>>>>>>>>>
46577>>>>>>>>>>>        // Child (Client) file structure................
46577>>>>>>>>>>>        Send Add_Client_File  Pmoves.File_Number
46578>>>>>>>>>>>        Send Add_Client_File  Tparticl.File_Number
46579>>>>>>>>>>>        Send Add_Client_File  Partlfpa.File_Number
46580>>>>>>>>>>>        Send Add_Client_File  Pmovesl.File_Number
46581>>>>>>>>>>>        Send Add_Client_File  Psxetika.File_Number
46582>>>>>>>>>>>
46582>>>>>>>>>>>        // Parent (Server) file structure...............
46582>>>>>>>>>>>        Send Add_Server_File  Clients.File_Number
46583>>>>>>>>>>>        Send Add_Server_File  Ptyppar.File_Number
46584>>>>>>>>>>>        Send Add_Server_File  Nomisma.File_Number
46585>>>>>>>>>>>
46585>>>>>>>>>>>        // External (System) file structure.............
46585>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_NEW_SAVE
46586>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
46587>>>>>>>>>>>        Send Add_System_File  Pseira.File_Number  DD_LOCK_ON_ALL
46588>>>>>>>>>>>        Send Add_System_File  Cn.File_Number  DD_LOCK_ON_ALL
46589>>>>>>>>>>>        Send Add_System_File  Partlfpa.File_Number  DD_LOCK_ON_ALL
46590>>>>>>>>>>>        Send Add_System_File  Clorder.File_Number  DD_LOCK_ON_ALL
46591>>>>>>>>>>>        Send Add_System_File  Clorderd.File_Number  DD_LOCK_ON_ALL
46592>>>>>>>>>>>        Send Add_System_File  Ypoprosf.File_Number  DD_LOCK_ON_ALL
46593>>>>>>>>>>>        Send Add_System_File  Psxetika.File_Number  DD_LOCK_ON_ALL
46594>>>>>>>>>>>        Send Add_System_File  Pmoves.File_Number  DD_LOCK_ON_ALL
46595>>>>>>>>>>>
46595>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Particle_Rec0  To Particle.Partl_Rec0
46598>>>>>>>>>>>
46598>>>>>>>>>>>        // Field-based properties.......................
46598>>>>>>>>>>>
46598>>>>>>>>>>>        // Particle.Company_Code
46598>>>>>>>>>>>
46598>>>>>>>>>>>        // Particle.Branch_Code
46598>>>>>>>>>>>
46598>>>>>>>>>>>        // Particle.Year_Year
46598>>>>>>>>>>>
46598>>>>>>>>>>>        // Particle.Ctypkin_Code
46598>>>>>>>>>>>
46598>>>>>>>>>>>        // Particle.Wtypkin_Code
46598>>>>>>>>>>>
46598>>>>>>>>>>>        // Particle.Ptyppar_Code
46598>>>>>>>>>>>
46598>>>>>>>>>>>        // Particle.Pseira_Seira
46598>>>>>>>>>>>
46598>>>>>>>>>>>        // Particle.Custprom_Code
46598>>>>>>>>>>>
46598>>>>>>>>>>>        // Particle.Client_Id
46598>>>>>>>>>>>
46598>>>>>>>>>>>        // Particle.Partl_No
46598>>>>>>>>>>>
46598>>>>>>>>>>>        // Particle.Cn_Recr
46598>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Cn_Recr To (sl041(Self))
46599>>>>>>>>>>>
46599>>>>>>>>>>>        // Particle.Pseira_Recr
46599>>>>>>>>>>>
46599>>>>>>>>>>>        // Particle.Partl_Hmnia
46599>>>>>>>>>>>        Set Field_Entry_msg        Field Particle.Partl_Hmnia To Shmera
46600>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Partl_Hmnia To (sl014(Self))
46601>>>>>>>>>>>
46601>>>>>>>>>>>        // Particle.Partl_Rec0
46601>>>>>>>>>>>        Set Field_Options          Field Particle.Partl_Rec0 To DD_AUTOFIND   
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Particle.Partl_Lastno
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Particle.Partl_Tdiakin
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Particle.Partl_Car
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Particle.Partl_Reldoc
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Particle.Partl_Toposf
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Particle.Partl_Toposa
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Particle.Partl_Troposa
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Particle.Partl_Tof
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Particle.Partl_Disctof
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Particle.Partl_Disccl
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Particle.Partl_Autodisc
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Particle.Partl_Time
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Particle.Partl_Totambd
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Particle.Partl_Amdiscpms
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Particle.Partl_Totdiscpc
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Particle.Partl_Discam
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Particle.Partl_Totamad
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Particle.Partl_Vatpct
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Particle.Partl_Vatam
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Particle.Partl_Genam
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Particle.Partl_Extra
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Particle.Partl_Extravatp
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Particle.Partl_Extravat
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Particle.Partl_Payam
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Particle.Partl_Befypol
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Particle.Partl_Currypol
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Particle.Partl_Tottem
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Particle.Partl_Det
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Particle.Partl_Recr
46602>>>>>>>>>>>        Set Field_Options          Field Particle.Partl_Recr To DD_AUTOFIND   
46603>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Partl_Recr To (sl014(Self))
46604>>>>>>>>>>>
46604>>>>>>>>>>>        // Particle.Cn_Code
46604>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Cn_Code To (sl041(Self))
46605>>>>>>>>>>>
46605>>>>>>>>>>>        // Particle.Client_Recr
46605>>>>>>>>>>>
46605>>>>>>>>>>>        // Particle.Ptyppar_Recr
46605>>>>>>>>>>>
46605>>>>>>>>>>>        // Particle.Partl_Ekleise
46605>>>>>>>>>>>
46605>>>>>>>>>>>        // Particle.Partl_Ekl_Recr
46605>>>>>>>>>>>
46605>>>>>>>>>>>        // Particle.Partl_Ektyposh
46605>>>>>>>>>>>
46605>>>>>>>>>>>        // Particle.Partl_Akyrosh
46605>>>>>>>>>>>
46605>>>>>>>>>>>        // Particle.Partl_Akyr_Recr
46605>>>>>>>>>>>
46605>>>>>>>>>>>        // Particle.Partl_Nooflines
46605>>>>>>>>>>>
46605>>>>>>>>>>>        // Particle.Cmoves_Recr
46605>>>>>>>>>>>
46605>>>>>>>>>>>        // Particle.Nomisma_Code
46605>>>>>>>>>>>
46605>>>>>>>>>>>        // Particle.Isotimia
46605>>>>>>>>>>>
46605>>>>>>>>>>>        // Particle.Wcmoves_Recr
46605>>>>>>>>>>>
46605>>>>>>>>>>>        // Particle.Partl_Module
46605>>>>>>>>>>>
46605>>>>>>>>>>>        // Particle.Partl_Timol
46605>>>>>>>>>>>        Set Field_Mask             Field Particle.Partl_Timol To "#"
46606>>>>>>>>>>>        Set Field_Mask_Type        Field Particle.Partl_Timol To MASK_NUMERIC_WINDOW
46607>>>>>>>>>>>
46607>>>>>>>>>>>        // Particle.Partl_Selected
46607>>>>>>>>>>>
46607>>>>>>>>>>>        // Particle.Partl_Tim_Recr
46607>>>>>>>>>>>
46607>>>>>>>>>>>        // Particle.Partl_Vsn
46607>>>>>>>>>>>
46607>>>>>>>>>>>        // Particle.Sls_Id
46607>>>>>>>>>>>
46607>>>>>>>>>>>        // Particle.Presp_Id
46607>>>>>>>>>>>
46607>>>>>>>>>>>        // Particle.Cnt_Id
46607>>>>>>>>>>>
46607>>>>>>>>>>>        // Particle.Topos_Apostolhs
46607>>>>>>>>>>>
46607>>>>>>>>>>>        // Particle.Tropos_Diakin
46607>>>>>>>>>>>        Set Field_Class_Name       Field Particle.Tropos_Diakin To "dbComboFormsub"
46608>>>>>>>>>>>        Set Field_Value_Table      Field Particle.Tropos_Diakin To (Particle_Tropos_Diakin_VT(Self))
46609>>>>>>>>>>>
46609>>>>>>>>>>>        // Particle.Ora_Apostolhs
46609>>>>>>>>>>>        Set Field_Entry_msg        Field Particle.Ora_Apostolhs To Shmera_Ora_String
46610>>>>>>>>>>>        Set Field_Mask             Field Particle.Ora_Apostolhs To "##:##"
46611>>>>>>>>>>>
46611>>>>>>>>>>>        // Particle.Skopos_Diakin
46611>>>>>>>>>>>        Set Field_Class_Name       Field Particle.Skopos_Diakin To "dbComboFormsub"
46612>>>>>>>>>>>        Set Field_Value_Table      Field Particle.Skopos_Diakin To (Particle_Skopos_Diakin_VT(Self))
46613>>>>>>>>>>>
46613>>>>>>>>>>>        // Particle.Tropos_Plhromhs
46613>>>>>>>>>>>        Set Field_Value_Table      Field Particle.Tropos_Plhromhs To (Particle_Tropos_Plhromhs_VT(Self))
46614>>>>>>>>>>>
46614>>>>>>>>>>>        // Particle.Odhgos_Code
46614>>>>>>>>>>>
46614>>>>>>>>>>>        // Particle.Odhgos_Name
46614>>>>>>>>>>>
46614>>>>>>>>>>>        // Particle.Oxhma_Code
46614>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Oxhma_Code To (sl054(Self))
46615>>>>>>>>>>>
46615>>>>>>>>>>>        // Particle.Oxhma_Descr
46615>>>>>>>>>>>
46615>>>>>>>>>>>        // Particle.Antlia_Code
46615>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Antlia_Code To (sl053(Self))
46616>>>>>>>>>>>
46616>>>>>>>>>>>        // Particle.Antlia_Descr
46616>>>>>>>>>>>
46616>>>>>>>>>>>        // Particle.Partl_Euro
46616>>>>>>>>>>>
46616>>>>>>>>>>>        // Particle.Disc_Vat_Pct
46616>>>>>>>>>>>
46616>>>>>>>>>>>        // Particle.Disc_Vat_Poso
46616>>>>>>>>>>>
46616>>>>>>>>>>>        // Particle.Total_Vat_Poso
46616>>>>>>>>>>>
46616>>>>>>>>>>>        // Particle.Exei_Sxetika
46616>>>>>>>>>>>
46616>>>>>>>>>>>        // Particle.Aitiol
46616>>>>>>>>>>>
46616>>>>>>>>>>>        // Particle.Max_Days_Date
46616>>>>>>>>>>>
46616>>>>>>>>>>>        // Particle.Timol_Qty
46616>>>>>>>>>>>
46616>>>>>>>>>>>        // Particle.Timol_Ypol
46616>>>>>>>>>>>
46616>>>>>>>>>>>        // Particle.Epilogh_Ekkrem
46616>>>>>>>>>>>
46616>>>>>>>>>>>        // Particle.No_Print_Module
46616>>>>>>>>>>>        //DDB/ Comment_Short       Field Particle.No_Print_Module To "Œ˜ £ž¤ «¬§é¤œ«˜  (˜§¦ ˜¢¢¦ ¡ç¡¢à£˜ §.®.§˜¨˜š ©œ ¨¦£)"
46616>>>>>>>>>>>
46616>>>>>>>>>>>        // Particle.Prohg_Ypol
46616>>>>>>>>>>>
46616>>>>>>>>>>>        // Particle.Trex_Ypol
46616>>>>>>>>>>>
46616>>>>>>>>>>>        // Particle.Parakrat_Pct
46616>>>>>>>>>>>
46616>>>>>>>>>>>        // Particle.Parakrat_Poso
46616>>>>>>>>>>>
46616>>>>>>>>>>>        // Particle.Cms_Parak_Recr
46616>>>>>>>>>>>
46616>>>>>>>>>>>        // Particle.Enhm_Logik
46616>>>>>>>>>>>
46616>>>>>>>>>>>        // Particle.Se_Logik
46616>>>>>>>>>>>
46616>>>>>>>>>>>        // Particle.Akyro
46616>>>>>>>>>>>
46616>>>>>>>>>>>        // Particle.Zone_Id
46616>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Zone_Id To (sl064(Self))
46617>>>>>>>>>>>
46617>>>>>>>>>>>        // Particle.Fpa_On_Total
46617>>>>>>>>>>>
46617>>>>>>>>>>>        // Particle.Ss_Arithmos
46617>>>>>>>>>>>
46617>>>>>>>>>>>        // Particle.Sap_Hmnia
46617>>>>>>>>>>>        Set Field_Mask_Type        Field Particle.Sap_Hmnia To MASK_DATE_WINDOW
46618>>>>>>>>>>>
46618>>>>>>>>>>>        //DDB-DefineFieldEnd
46618>>>>>>>>>>>    End_Procedure    // Define_Fields
46619>>>>>>>>>>>
46619>>>>>>>>>>>    // Field_Defaults:
46619>>>>>>>>>>>    // This procedure is used to establish default field values.
46619>>>>>>>>>>>
46619>>>>>>>>>>>    Procedure Field_Defaults
46620>>>>>>>>>>>        Forward Send Field_Defaults
46622>>>>>>>>>>>        //DDB-Generated-Code-Location
46622>>>>>>>>>>>        //DDB-FieldDefaultStart
46622>>>>>>>>>>>        //DDB-FieldDefaultEnd
46622>>>>>>>>>>>        Set Field_Changed_Value Field Particle.Nomisma_Code to SyscurXr.C_Code0
46623>>>>>>>>>>>    End_Procedure    // Field_Defaults
46624>>>>>>>>>>>
46624>>>>>>>>>>>End_Class    // Particle_DataDictionary
46625>>>>>>>>>>>//DDB-Selection-pkg-Start
46625>>>>>>>>>>>
46625>>>>>>>>>>>Use sl041.SL         // sl041
46625>>>>>>>>>>>Use sl014.SL         // sl014
INCLUDING FILE: SL014.SL
46625>>>>>>>>>>>>>//AB/ Project sl014:Particle Lookup
46625>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
46625>>>>>>>>>>>>>//AB/     Set ProjectName to "sl014:Particle Lookup"
46625>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl014.SL"
46625>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
46625>>>>>>>>>>>>>
46625>>>>>>>>>>>>>// Project Object Structure
46625>>>>>>>>>>>>>//   sl014 is a dbModalPanelSub
46625>>>>>>>>>>>>>//     Ctypkin_DD is a DataDictionary
46625>>>>>>>>>>>>>//     Wtypkin_DD is a DataDictionary
46625>>>>>>>>>>>>>//     Ptyppar_DD is a DataDictionary
46625>>>>>>>>>>>>>//     Clients_DD is a DataDictionary
46625>>>>>>>>>>>>>//     Nomisma_DD is a DataDictionary
46625>>>>>>>>>>>>>//     Particle_DD is a DataDictionary
46625>>>>>>>>>>>>>//     oSelList is a dbListSub
46625>>>>>>>>>>>>>//     cSyDateForm1 is a cSyDateForm
46625>>>>>>>>>>>>>//     FormSub1 is a FormSub
46625>>>>>>>>>>>>>//     FormSub3 is a FormSub
46625>>>>>>>>>>>>>//     FormSub2 is a FormSub
46625>>>>>>>>>>>>>//     FormSub4 is a FormSub
46625>>>>>>>>>>>>>//     FormSub5 is a FormSub
46625>>>>>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
46625>>>>>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
46625>>>>>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
46625>>>>>>>>>>>>>//     ButtonSub1 is a ButtonSub
46625>>>>>>>>>>>>>//     oOk_bn is a ButtonSub
46625>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
46625>>>>>>>>>>>>>//     TextBoxSub4 is a TextBoxSub
46625>>>>>>>>>>>>>
46625>>>>>>>>>>>>>// Register all objects
46625>>>>>>>>>>>>>Register_Object ButtonSub1
46625>>>>>>>>>>>>>Register_Object Clients_DD
46625>>>>>>>>>>>>>Register_Object Ctypkin_DD
46625>>>>>>>>>>>>>Register_Object cSyDateForm1
46625>>>>>>>>>>>>>Register_Object FormSub1
46625>>>>>>>>>>>>>Register_Object FormSub2
46625>>>>>>>>>>>>>Register_Object FormSub3
46625>>>>>>>>>>>>>Register_Object FormSub4
46625>>>>>>>>>>>>>Register_Object FormSub5
46625>>>>>>>>>>>>>Register_Object Nomisma_DD
46625>>>>>>>>>>>>>Register_Object oOk_bn
46625>>>>>>>>>>>>>Register_Object oSearch_bn
46625>>>>>>>>>>>>>Register_Object oSelList
46625>>>>>>>>>>>>>Register_Object Particle_DD
46625>>>>>>>>>>>>>Register_Object Ptyppar_DD
46625>>>>>>>>>>>>>Register_Object sl014
46625>>>>>>>>>>>>>Register_Object TextBoxSub1
46625>>>>>>>>>>>>>Register_Object TextBoxSub2
46625>>>>>>>>>>>>>Register_Object TextBoxSub3
46625>>>>>>>>>>>>>Register_Object TextBoxSub4
46625>>>>>>>>>>>>>Register_Object Wtypkin_DD
46625>>>>>>>>>>>>>
46625>>>>>>>>>>>>>
46625>>>>>>>>>>>>>
46625>>>>>>>>>>>>>//AB-StoreTopStart
46625>>>>>>>>>>>>>            
46625>>>>>>>>>>>>>Open PtypparL
46627>>>>>>>>>>>>>
46627>>>>>>>>>>>>>Use sl100.sl
46627>>>>>>>>>>>>>Use sl012.sl
46627>>>>>>>>>>>>>
46627>>>>>>>>>>>>>//AB-StoreTopEnd
46627>>>>>>>>>>>>>
46627>>>>>>>>>>>>>//AB-IgnoreStart
46627>>>>>>>>>>>>>
46627>>>>>>>>>>>>>Use DFAllEnt.pkg
46627>>>>>>>>>>>>>Use dbList.Sub
46627>>>>>>>>>>>>>Use cSyDateForm.Pkg
46627>>>>>>>>>>>>>Use Form.Sub
46627>>>>>>>>>>>>>Use Txtbox.Sub
46627>>>>>>>>>>>>>Use Button.Sub
46627>>>>>>>>>>>>>
46627>>>>>>>>>>>>>
46627>>>>>>>>>>>>>Use CTYPKIN.DD
46627>>>>>>>>>>>>>Use WTYPKIN.DD
46627>>>>>>>>>>>>>Use PTYPPAR.DD
46627>>>>>>>>>>>>>Use CLIENTS.DD
46627>>>>>>>>>>>>>Use NOMISMA.DD
46627>>>>>>>>>>>>>Use PARTICLE.DD
46627>>>>>>>>>>>>>
46627>>>>>>>>>>>>>//AB-IgnoreEnd
46627>>>>>>>>>>>>>
46627>>>>>>>>>>>>>Object sl014 is a dbModalPanelSub
46629>>>>>>>>>>>>>
46629>>>>>>>>>>>>>    //AB-StoreTopStart
46629>>>>>>>>>>>>>                                
46629>>>>>>>>>>>>>    Property String psModule        Public ''
46631>>>>>>>>>>>>>    Property String psClient        Public ''
46633>>>>>>>>>>>>>    Property String psPtyppar       Public ''
46635>>>>>>>>>>>>>    Property String psCtypkin       Public ''
46637>>>>>>>>>>>>>    Property String psWtypkin       Public ''
46639>>>>>>>>>>>>>    Property String psPtypparRecr   Public ''
46641>>>>>>>>>>>>>    Property Integer Pino           Public 0
46643>>>>>>>>>>>>>    Property Date   pdHmnia         Public ''
46645>>>>>>>>>>>>>    
46645>>>>>>>>>>>>>    //AB-StoreTopEnd
46645>>>>>>>>>>>>>
46645>>>>>>>>>>>>>    Set Label to "˜¨˜©«˜« ¡á"
46646>>>>>>>>>>>>>    Set Size to 294 523
46647>>>>>>>>>>>>>    Set Location to 0 3
46648>>>>>>>>>>>>>    Set Color to 12363657
46649>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
46650>>>>>>>>>>>>>    Set Modal_State to FALSE
46651>>>>>>>>>>>>>
46651>>>>>>>>>>>>>    //AB-DDOStart
46651>>>>>>>>>>>>>
46651>>>>>>>>>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
46653>>>>>>>>>>>>>    End_Object    // Ctypkin_DD
46654>>>>>>>>>>>>>
46654>>>>>>>>>>>>>    Object Wtypkin_DD is a Wtypkin_DataDictionary
46656>>>>>>>>>>>>>    End_Object    // Wtypkin_DD
46657>>>>>>>>>>>>>
46657>>>>>>>>>>>>>    Object Ptyppar_DD is a Ptyppar_DataDictionary
46659>>>>>>>>>>>>>        Set DDO_Server to (Ctypkin_DD(self))
46660>>>>>>>>>>>>>        Set DDO_Server to (Wtypkin_DD(self))
46661>>>>>>>>>>>>>    End_Object    // Ptyppar_DD
46662>>>>>>>>>>>>>
46662>>>>>>>>>>>>>    Object Clients_DD is a Clients_DataDictionary
46664>>>>>>>>>>>>>    End_Object    // Clients_DD
46665>>>>>>>>>>>>>
46665>>>>>>>>>>>>>    Object Nomisma_DD is a Nomisma_DataDictionary
46667>>>>>>>>>>>>>    End_Object    // Nomisma_DD
46668>>>>>>>>>>>>>
46668>>>>>>>>>>>>>    Object Particle_DD is a Particle_DataDictionary
46670>>>>>>>>>>>>>        Set DDO_Server to (Clients_DD(self))
46671>>>>>>>>>>>>>        Set DDO_Server to (Ptyppar_DD(self))
46672>>>>>>>>>>>>>        Set DDO_Server to (Nomisma_DD(self))
46673>>>>>>>>>>>>>
46673>>>>>>>>>>>>>        //AB-StoreStart
46673>>>>>>>>>>>>>                                                        
46673>>>>>>>>>>>>>        Procedure OnConstrain
46675>>>>>>>>>>>>>            String  sPtyppar sWtypkin sCtypkin sClientID sPtypparRecr
46676>>>>>>>>>>>>>            Date    dHmnia
46676>>>>>>>>>>>>>            Integer Ino
46676>>>>>>>>>>>>>            Get psClient        to sClientID
46677>>>>>>>>>>>>>            Get psPtyppar       to sPtyppar
46678>>>>>>>>>>>>>            Get psPtypparRecr   to sPtypparRecr
46679>>>>>>>>>>>>>            Get psCtypkin       to sCtypkin
46680>>>>>>>>>>>>>            Get psWtypkin       to sWtypkin
46681>>>>>>>>>>>>>            Get Value Of cSyDateForm1 Item 0 to dHmnia
46682>>>>>>>>>>>>>            get Pino            to Ino
46683>>>>>>>>>>>>>            If (sClientID<>'') Begin
46685>>>>>>>>>>>>>                If (sPtypparRecr<>'') Begin
46687>>>>>>>>>>>>>                    Set Ordering to 1
46688>>>>>>>>>>>>>                    Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
46690>>>>>>>>>>>>>                    Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
46692>>>>>>>>>>>>>                    Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
46694>>>>>>>>>>>>>                    Constrain Particle.CustProm_Code    Eq ''
46696>>>>>>>>>>>>>                    Constrain Particle.Client_ID        Eq sClientID
46698>>>>>>>>>>>>>                    Constrain Particle.Ctypkin_Code     Eq sCtypkin
46700>>>>>>>>>>>>>                    Constrain Particle.Wtypkin_Code     Eq sWtypkin
46702>>>>>>>>>>>>>                    Constrain Particle.Ptyppar_Code     Eq sPtyppar
46704>>>>>>>>>>>>>                    If (dHmnia<>'') ;                        Constrain Particle.Partl_Hmnia  Eq dHmnia
46708>>>>>>>>>>>>>                    If (Ino<>0) ;                        Constrain Particle.Partl_no     Eq Ino
46712>>>>>>>>>>>>>                End
46712>>>>>>>>>>>>>>
46712>>>>>>>>>>>>>                Else Begin
46713>>>>>>>>>>>>>                    Set Ordering to 13
46714>>>>>>>>>>>>>                    Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
46716>>>>>>>>>>>>>                    Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
46718>>>>>>>>>>>>>                    Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
46720>>>>>>>>>>>>>                    Constrain Particle.Client_ID        Eq sClientID
46722>>>>>>>>>>>>>                    If (dHmnia<>'') ;                        Constrain Particle.Partl_Hmnia  Eq dHmnia
46726>>>>>>>>>>>>>                    If (Ino<>0) ;                        Constrain Particle.Partl_no     Eq Ino
46730>>>>>>>>>>>>>                End
46730>>>>>>>>>>>>>>
46730>>>>>>>>>>>>>            End
46730>>>>>>>>>>>>>>
46730>>>>>>>>>>>>>            Else If (sPtypparRecr<>'') Begin
46733>>>>>>>>>>>>>                Set Ordering to 12
46734>>>>>>>>>>>>>                Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
46736>>>>>>>>>>>>>                Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
46738>>>>>>>>>>>>>                Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
46740>>>>>>>>>>>>>                Constrain Particle.Partl_Module     Eq (psModule(Self))
46742>>>>>>>>>>>>>                Constrain Particle.Ptyppar_Recr     Eq sPtypparRecr
46744>>>>>>>>>>>>>                If (dHmnia<>'') ;                    Constrain Particle.Partl_Hmnia  Eq dHmnia
46748>>>>>>>>>>>>>                If (Ino<>0) ;                    Constrain Particle.Partl_no     Eq Ino
46752>>>>>>>>>>>>>            End
46752>>>>>>>>>>>>>>
46752>>>>>>>>>>>>>            Else  Begin
46753>>>>>>>>>>>>>                Set Ordering to 14
46754>>>>>>>>>>>>>                Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
46756>>>>>>>>>>>>>                Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
46758>>>>>>>>>>>>>                Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
46760>>>>>>>>>>>>>                Constrain Particle.Partl_Module     Eq (psModule(Self))
46762>>>>>>>>>>>>>                If (dHmnia<>'') ;                    Constrain Particle.Partl_Hmnia  Eq dHmnia
46766>>>>>>>>>>>>>                If (Ino<>0) ;                    Constrain Particle.Partl_no     Eq Ino
46770>>>>>>>>>>>>>            End
46770>>>>>>>>>>>>>>
46770>>>>>>>>>>>>>        
46770>>>>>>>>>>>>>        End_Procedure
46771>>>>>>>>>>>>>        
46771>>>>>>>>>>>>>        
46771>>>>>>>>>>>>>        
46771>>>>>>>>>>>>>        
46771>>>>>>>>>>>>>        
46771>>>>>>>>>>>>>        
46771>>>>>>>>>>>>>        
46771>>>>>>>>>>>>>        
46771>>>>>>>>>>>>>        
46771>>>>>>>>>>>>>        
46771>>>>>>>>>>>>>        
46771>>>>>>>>>>>>>        
46771>>>>>>>>>>>>>        
46771>>>>>>>>>>>>>        
46771>>>>>>>>>>>>>        
46771>>>>>>>>>>>>>        
46771>>>>>>>>>>>>>        
46771>>>>>>>>>>>>>        //AB-StoreEnd
46771>>>>>>>>>>>>>
46771>>>>>>>>>>>>>    End_Object    // Particle_DD
46772>>>>>>>>>>>>>
46772>>>>>>>>>>>>>    Set Main_DD to (Particle_DD(self))
46773>>>>>>>>>>>>>    Set Server to (Particle_DD(self))
46774>>>>>>>>>>>>>
46774>>>>>>>>>>>>>    //AB-DDOEnd
46774>>>>>>>>>>>>>
46774>>>>>>>>>>>>>    Object oSelList is a dbListSub
46776>>>>>>>>>>>>>        Set Main_File to Particle.File_Number
46777>>>>>>>>>>>>>        Set Size to 208 511
46778>>>>>>>>>>>>>        Set Location to 6 5
46779>>>>>>>>>>>>>        Set Auto_Index_State to FALSE
46780>>>>>>>>>>>>>
46780>>>>>>>>>>>>>        Begin_Row
46783>>>>>>>>>>>>>            Entry_Item Particle.Partl_hmnia
46784>>>>>>>>>>>>>            Entry_Item Ptyppar.Ptyppar_descr
46785>>>>>>>>>>>>>            Entry_Item Particle.Pseira_seira
46786>>>>>>>>>>>>>            Entry_Item Particle.Partl_no
46787>>>>>>>>>>>>>            Entry_Item Clients.Client_id
46788>>>>>>>>>>>>>            Entry_Item Clients.Client_name
46789>>>>>>>>>>>>>            Entry_Item Particle.Partl_payam
46790>>>>>>>>>>>>>            Entry_Item Particle.Partl_ekleise
46791>>>>>>>>>>>>>        End_Row
46796>>>>>>>>>>>>>
46796>>>>>>>>>>>>>        Set Form_Width    item 0 to 55
46797>>>>>>>>>>>>>        Set Header_Label  item 0 to "†£œ¨/¤å˜"
46798>>>>>>>>>>>>>        
46798>>>>>>>>>>>>>        Set Form_Width    item 1 to 100
46799>>>>>>>>>>>>>        Set Header_Label  item 1 to "˜¨˜©«˜« ¡æ"
46800>>>>>>>>>>>>>        
46800>>>>>>>>>>>>>        Set Form_Width    item 2 to 36
46801>>>>>>>>>>>>>        Set Header_Label  item 2 to "‘œ ¨á"
46802>>>>>>>>>>>>>        
46802>>>>>>>>>>>>>        Set Form_Width    item 3 to 55
46803>>>>>>>>>>>>>        Set Header_Label  item 3 to "€¨ Ÿ£æª"
46804>>>>>>>>>>>>>        
46804>>>>>>>>>>>>>        Set Form_Width    item 4 to 57
46805>>>>>>>>>>>>>        Set Header_Label  item 4 to "‰à› ¡æª"
46806>>>>>>>>>>>>>        
46806>>>>>>>>>>>>>        Set Form_Width    item 5 to 140
46807>>>>>>>>>>>>>        Set Header_Label  item 5 to "œ¢á«žª / ¨¦£žŸœ¬«ãª"
46808>>>>>>>>>>>>>        
46808>>>>>>>>>>>>>        Set Form_Width    item 6 to 48
46809>>>>>>>>>>>>>        Set Header_Label  item 6 to "€¥å˜"
46810>>>>>>>>>>>>>        
46810>>>>>>>>>>>>>        Set Form_Width    item 7 to 16
46811>>>>>>>>>>>>>        Set Header_Label  item 7 to "K"
46812>>>>>>>>>>>>>        Set Column_Checkbox_State  item 7 to True
46813>>>>>>>>>>>>>        
46813>>>>>>>>>>>>>
46813>>>>>>>>>>>>>        //AB-StoreStart
46813>>>>>>>>>>>>>        Set Column_Option       Item  1 to NoEnter  True
46814>>>>>>>>>>>>>        Procedure End_Construct_Object
46816>>>>>>>>>>>>>            Integer iDecimals
46817>>>>>>>>>>>>>            Forward Send End_Construct_Object
46819>>>>>>>>>>>>>            Get fiDekadika_Nomismatos SysCurXr.C_Code0   to    iDecimals
46820>>>>>>>>>>>>>            Set Points Item 6 to iDecimals
46821>>>>>>>>>>>>>            Set Numeric_Mask Item 6 to 14 iDecimals ' ,*'
46822>>>>>>>>>>>>>        End_Procedure
46823>>>>>>>>>>>>>        
46823>>>>>>>>>>>>>        
46823>>>>>>>>>>>>>        Procedure Activate
46825>>>>>>>>>>>>>            Send Keyaction to ButtonSub1
46826>>>>>>>>>>>>>            Forward Send Activate
46828>>>>>>>>>>>>>        End_procedure
46829>>>>>>>>>>>>>        
46829>>>>>>>>>>>>>        Procedure Activating
46831>>>>>>>>>>>>>            Forward Send Activating
46833>>>>>>>>>>>>>            Set Auto_Index_State to True
46834>>>>>>>>>>>>>        End_Procedure
46835>>>>>>>>>>>>>        
46835>>>>>>>>>>>>>        
46835>>>>>>>>>>>>>        
46835>>>>>>>>>>>>>        
46835>>>>>>>>>>>>>        //AB-StoreEnd
46835>>>>>>>>>>>>>
46835>>>>>>>>>>>>>    End_Object    // oSelList
46836>>>>>>>>>>>>>
46836>>>>>>>>>>>>>    Object cSyDateForm1 is a cSyDateForm
46838>>>>>>>>>>>>>        Set Size to 13 85
46839>>>>>>>>>>>>>        Set Location to 222 54
46840>>>>>>>>>>>>>        Set Label_Col_Offset to 2
46841>>>>>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
46842>>>>>>>>>>>>>        Set Form_Mask Item 0 to "d/M/yyyy"
46843>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
46844>>>>>>>>>>>>>
46844>>>>>>>>>>>>>        //AB-StoreStart
46844>>>>>>>>>>>>>                                                                                                        
46844>>>>>>>>>>>>>        Procedure Key Integer iKey
46846>>>>>>>>>>>>>            Integer iRetVal
46847>>>>>>>>>>>>>            Forward Send Key iKey
46849>>>>>>>>>>>>>            If (iKey=277) Begin
46851>>>>>>>>>>>>>                Send Clear_Me
46852>>>>>>>>>>>>>            End
46852>>>>>>>>>>>>>>
46852>>>>>>>>>>>>>        End_Procedure
46853>>>>>>>>>>>>>        
46853>>>>>>>>>>>>>        Procedure Clear_Me
46855>>>>>>>>>>>>>            Set Value Item 0 to ''
46856>>>>>>>>>>>>>            Send KeyAction to ButtonSub1
46857>>>>>>>>>>>>>        End_Procedure
46858>>>>>>>>>>>>>        
46858>>>>>>>>>>>>>        Procedure Exiting00000
46860>>>>>>>>>>>>>            Forward Send Exiting
46862>>>>>>>>>>>>>            Send KeyAction to ButtonSub1
46863>>>>>>>>>>>>>        End_procedure
46864>>>>>>>>>>>>>        
46864>>>>>>>>>>>>>        
46864>>>>>>>>>>>>>        
46864>>>>>>>>>>>>>        //AB-StoreEnd
46864>>>>>>>>>>>>>
46864>>>>>>>>>>>>>    End_Object    // cSyDateForm1
46865>>>>>>>>>>>>>
46865>>>>>>>>>>>>>    Object FormSub1 is a FormSub
46867>>>>>>>>>>>>>        Set Size to 13 85
46868>>>>>>>>>>>>>        Set Location to 236 54
46869>>>>>>>>>>>>>        Set Label_Col_Offset to 2
46870>>>>>>>>>>>>>        Set Prompt_Button_Mode to pb_PromptOn
46871>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
46872>>>>>>>>>>>>>
46872>>>>>>>>>>>>>        //AB-StoreStart
46872>>>>>>>>>>>>>                                                                                                
46872>>>>>>>>>>>>>        Set Prompt_Object to (sl012(Self))
46873>>>>>>>>>>>>>        
46873>>>>>>>>>>>>>        Procedure Prompt
46875>>>>>>>>>>>>>            String sModule
46876>>>>>>>>>>>>>            Get psModule Of (sl012(Self)) to sModule
46877>>>>>>>>>>>>>            Set psModule Of (sl012(Self)) to (psModule(Self))
46878>>>>>>>>>>>>>            Forward Send Prompt
46880>>>>>>>>>>>>>            Set psModule Of (sl012(Self)) to sModule
46881>>>>>>>>>>>>>        End_Procedure
46882>>>>>>>>>>>>>        
46882>>>>>>>>>>>>>        Procedure OnChange
46884>>>>>>>>>>>>>            String s1
46885>>>>>>>>>>>>>            Get Value Item 0 to s1
46886>>>>>>>>>>>>>            Set Value Of FormSub3 Item 0 to (fsPtyppar(Self,s1))
46887>>>>>>>>>>>>>            Clear Ptypparl
46888>>>>>>>>>>>>>            Move Syscurxr.Company_Code  to ptypparl.Company_Code
46889>>>>>>>>>>>>>            Move Syscurxr.Branch_Code   to ptypparl.Branch_Code
46890>>>>>>>>>>>>>            Move s1                     to Ptypparl.Ptyppar_Code
46891>>>>>>>>>>>>>            Find Eq Ptypparl by index.1
46892>>>>>>>>>>>>>>
46892>>>>>>>>>>>>>            Set psPtyppar       to s1
46893>>>>>>>>>>>>>            Set psPtypparRecr   to Ptypparl.Ptyppar_Recr
46894>>>>>>>>>>>>>            Set psWtypkin       to PtypparL.Wtypkin_Code
46895>>>>>>>>>>>>>            Set psCtypkin       to PtypparL.Ctypkin_Code
46896>>>>>>>>>>>>>        End_Procedure
46897>>>>>>>>>>>>>        
46897>>>>>>>>>>>>>        
46897>>>>>>>>>>>>>        
46897>>>>>>>>>>>>>        
46897>>>>>>>>>>>>>        
46897>>>>>>>>>>>>>        
46897>>>>>>>>>>>>>        
46897>>>>>>>>>>>>>        //AB-StoreEnd
46897>>>>>>>>>>>>>
46897>>>>>>>>>>>>>    End_Object    // FormSub1
46898>>>>>>>>>>>>>
46898>>>>>>>>>>>>>    Object FormSub3 is a FormSub
46900>>>>>>>>>>>>>        Set Size to 13 195
46901>>>>>>>>>>>>>        Set Location to 236 145
46902>>>>>>>>>>>>>        Set Color to 12363657
46903>>>>>>>>>>>>>        Set Label_Col_Offset to 2
46904>>>>>>>>>>>>>        Set Enabled_State to FALSE
46905>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
46906>>>>>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
46907>>>>>>>>>>>>>        Set Shadow_State Item 0 to TRUE
46908>>>>>>>>>>>>>    End_Object    // FormSub3
46909>>>>>>>>>>>>>
46909>>>>>>>>>>>>>    Object FormSub2 is a FormSub
46911>>>>>>>>>>>>>        Set Size to 13 85
46912>>>>>>>>>>>>>        Set Location to 250 54
46913>>>>>>>>>>>>>        Set Label_Col_Offset to 2
46914>>>>>>>>>>>>>        Set Prompt_Button_Mode to pb_PromptOn
46915>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
46916>>>>>>>>>>>>>
46916>>>>>>>>>>>>>        //AB-StoreStart
46916>>>>>>>>>>>>>                                                                                                
46916>>>>>>>>>>>>>        Set Prompt_Object to (sl100(Self))
46917>>>>>>>>>>>>>        
46917>>>>>>>>>>>>>        Procedure Prompt
46919>>>>>>>>>>>>>            String sModule
46920>>>>>>>>>>>>>            Get psModule Of (sl100(Self)) to sModule
46921>>>>>>>>>>>>>            Set psModule Of (sl100(Self)) to (psModule(Self))
46922>>>>>>>>>>>>>            Forward Send Prompt
46924>>>>>>>>>>>>>            Set psModule Of (sl100(Self)) to sModule
46925>>>>>>>>>>>>>        End_Procedure
46926>>>>>>>>>>>>>        
46926>>>>>>>>>>>>>        Procedure OnChange
46928>>>>>>>>>>>>>            String s1
46929>>>>>>>>>>>>>            Get Value Item 0 to s1
46930>>>>>>>>>>>>>            Set Value Of FormSub4 Item 0 to (fsClient(Self,s1))
46931>>>>>>>>>>>>>            Set psClient to s1
46932>>>>>>>>>>>>>        End_Procedure
46933>>>>>>>>>>>>>        
46933>>>>>>>>>>>>>        
46933>>>>>>>>>>>>>        
46933>>>>>>>>>>>>>        
46933>>>>>>>>>>>>>        
46933>>>>>>>>>>>>>        
46933>>>>>>>>>>>>>        
46933>>>>>>>>>>>>>        //AB-StoreEnd
46933>>>>>>>>>>>>>
46933>>>>>>>>>>>>>    End_Object    // FormSub2
46934>>>>>>>>>>>>>
46934>>>>>>>>>>>>>    Object FormSub4 is a FormSub
46936>>>>>>>>>>>>>        Set Size to 13 195
46937>>>>>>>>>>>>>        Set Location to 250 145
46938>>>>>>>>>>>>>        Set Color to 12363657
46939>>>>>>>>>>>>>        Set Label_Col_Offset to 2
46940>>>>>>>>>>>>>        Set Enabled_State to FALSE
46941>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
46942>>>>>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
46943>>>>>>>>>>>>>        Set Shadow_State Item 0 to TRUE
46944>>>>>>>>>>>>>    End_Object    // FormSub4
46945>>>>>>>>>>>>>
46945>>>>>>>>>>>>>    Object FormSub5 is a FormSub
46947>>>>>>>>>>>>>        Set Size to 13 85
46948>>>>>>>>>>>>>        Set Location to 263 54
46949>>>>>>>>>>>>>        Set Label_Col_Offset to 2
46950>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
46951>>>>>>>>>>>>>
46951>>>>>>>>>>>>>        //AB-StoreStart
46951>>>>>>>>>>>>>        Procedure OnChange
46953>>>>>>>>>>>>>            integer ino
46954>>>>>>>>>>>>>            Get Value Item 0 to ino
46955>>>>>>>>>>>>>            Set pino to ino
46956>>>>>>>>>>>>>        End_Procedure
46957>>>>>>>>>>>>>        
46957>>>>>>>>>>>>>        
46957>>>>>>>>>>>>>        
46957>>>>>>>>>>>>>        
46957>>>>>>>>>>>>>        
46957>>>>>>>>>>>>>        
46957>>>>>>>>>>>>>        
46957>>>>>>>>>>>>>        
46957>>>>>>>>>>>>>        
46957>>>>>>>>>>>>>        
46957>>>>>>>>>>>>>        
46957>>>>>>>>>>>>>        //AB-StoreEnd
46957>>>>>>>>>>>>>
46957>>>>>>>>>>>>>    End_Object    // FormSub5
46958>>>>>>>>>>>>>
46958>>>>>>>>>>>>>    Object TextBoxSub1 is a TextBoxSub
46960>>>>>>>>>>>>>        Set Label to "†£œ¨/¤å˜"
46961>>>>>>>>>>>>>        Set Color to 12363657
46962>>>>>>>>>>>>>        Set Location to 222 5
46963>>>>>>>>>>>>>        Set Size to 10 35
46964>>>>>>>>>>>>>        Set TypeFace to "MS Sans Serif"
46965>>>>>>>>>>>>>    End_Object    // TextBoxSub1
46966>>>>>>>>>>>>>
46966>>>>>>>>>>>>>    Object TextBoxSub2 is a TextBoxSub
46968>>>>>>>>>>>>>        Set Label to "˜¨˜©«/¡æ"
46969>>>>>>>>>>>>>        Set Color to 12363657
46970>>>>>>>>>>>>>        Set Location to 237 4
46971>>>>>>>>>>>>>        Set Size to 10 41
46972>>>>>>>>>>>>>        Set TypeFace to "MS Sans Serif"
46973>>>>>>>>>>>>>    End_Object    // TextBoxSub2
46974>>>>>>>>>>>>>
46974>>>>>>>>>>>>>    Object TextBoxSub3 is a TextBoxSub
46976>>>>>>>>>>>>>        Set Label to "”¦¨â˜ª"
46977>>>>>>>>>>>>>        Set Color to 12363657
46978>>>>>>>>>>>>>        Set Location to 252 4
46979>>>>>>>>>>>>>        Set Size to 10 31
46980>>>>>>>>>>>>>        Set TypeFace to "MS Sans Serif"
46981>>>>>>>>>>>>>    End_Object    // TextBoxSub3
46982>>>>>>>>>>>>>
46982>>>>>>>>>>>>>    Object ButtonSub1 is a ButtonSub
46984>>>>>>>>>>>>>        Set Label to "œ¨ æ¨ ©œ"
46985>>>>>>>>>>>>>        Set Size to 13 50
46986>>>>>>>>>>>>>        Set Location to 252 355
46987>>>>>>>>>>>>>        Set Form_FontWeight Item 0 to 600
46988>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
46989>>>>>>>>>>>>>
46989>>>>>>>>>>>>>        //AB-StoreStart
46989>>>>>>>>>>>>>                
46989>>>>>>>>>>>>>        Procedure OnClick
46991>>>>>>>>>>>>>            Send Rebuild_Constraints to Particle_DD
46992>>>>>>>>>>>>>            Send Beginning_Of_Data to oSelList True
46993>>>>>>>>>>>>>        End_Procedure // OnClick
46994>>>>>>>>>>>>>        
46994>>>>>>>>>>>>>        
46994>>>>>>>>>>>>>        
46994>>>>>>>>>>>>>        
46994>>>>>>>>>>>>>        
46994>>>>>>>>>>>>>        //AB-StoreEnd
46994>>>>>>>>>>>>>
46994>>>>>>>>>>>>>    End_Object    // ButtonSub1
46995>>>>>>>>>>>>>
46995>>>>>>>>>>>>>    Object oOk_bn is a ButtonSub
46997>>>>>>>>>>>>>
46997>>>>>>>>>>>>>        //AB-StoreTopStart
46997>>>>>>>>>>>>>                
46997>>>>>>>>>>>>>        //AB-StoreTopEnd
46997>>>>>>>>>>>>>
46997>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
46998>>>>>>>>>>>>>        Set Location to 252 412
46999>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
47000>>>>>>>>>>>>>
47000>>>>>>>>>>>>>        //AB-StoreStart
47000>>>>>>>>>>>>>                
47000>>>>>>>>>>>>>        Procedure OnClick
47002>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
47003>>>>>>>>>>>>>        End_Procedure
47004>>>>>>>>>>>>>        
47004>>>>>>>>>>>>>        //AB-StoreEnd
47004>>>>>>>>>>>>>
47004>>>>>>>>>>>>>    End_Object    // oOk_bn
47005>>>>>>>>>>>>>
47005>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
47007>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
47008>>>>>>>>>>>>>        Set Size to 13 50
47009>>>>>>>>>>>>>        Set Location to 252 466
47010>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
47011>>>>>>>>>>>>>
47011>>>>>>>>>>>>>        //AB-StoreStart
47011>>>>>>>>>>>>>        Procedure OnClick
47013>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
47014>>>>>>>>>>>>>        End_Procedure
47015>>>>>>>>>>>>>        //AB-StoreEnd
47015>>>>>>>>>>>>>
47015>>>>>>>>>>>>>    End_Object    // oSearch_bn
47016>>>>>>>>>>>>>
47016>>>>>>>>>>>>>    Object TextBoxSub4 is a TextBoxSub
47018>>>>>>>>>>>>>        Set Label to "€¨ Ÿ£æª"
47019>>>>>>>>>>>>>        Set Color to 12363657
47020>>>>>>>>>>>>>        Set Location to 265 4
47021>>>>>>>>>>>>>        Set Size to 10 31
47022>>>>>>>>>>>>>        Set TypeFace to "MS Sans Serif"
47023>>>>>>>>>>>>>    End_Object    // TextBoxSub4
47024>>>>>>>>>>>>>
47024>>>>>>>>>>>>>
47024>>>>>>>>>>>>>    //AB-StoreStart
47024>>>>>>>>>>>>>                                
47024>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
47025>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
47026>>>>>>>>>>>>>    
47026>>>>>>>>>>>>>    Set Locate_Mode to Center_On_Screen
47027>>>>>>>>>>>>>    Set Modal_State to True
47028>>>>>>>>>>>>>    
47028>>>>>>>>>>>>>    Procedure Request_Cancel
47030>>>>>>>>>>>>>        Set Value Of cSyDateForm1 Item 0 to ''
47031>>>>>>>>>>>>>        Send Clear to Particle_DD
47032>>>>>>>>>>>>>        Forward Send Request_Cancel
47034>>>>>>>>>>>>>    End_Procedure
47035>>>>>>>>>>>>>    
47035>>>>>>>>>>>>>    
47035>>>>>>>>>>>>>    
47035>>>>>>>>>>>>>    
47035>>>>>>>>>>>>>    
47035>>>>>>>>>>>>>    
47035>>>>>>>>>>>>>    
47035>>>>>>>>>>>>>    
47035>>>>>>>>>>>>>    
47035>>>>>>>>>>>>>    
47035>>>>>>>>>>>>>    
47035>>>>>>>>>>>>>    
47035>>>>>>>>>>>>>    
47035>>>>>>>>>>>>>    
47035>>>>>>>>>>>>>    
47035>>>>>>>>>>>>>    
47035>>>>>>>>>>>>>    
47035>>>>>>>>>>>>>    
47035>>>>>>>>>>>>>    
47035>>>>>>>>>>>>>    
47035>>>>>>>>>>>>>    //AB-StoreEnd
47035>>>>>>>>>>>>>
47035>>>>>>>>>>>>>End_Object    // sl014
47036>>>>>>>>>>>>>
47036>>>>>>>>>>>>>
47036>>>>>>>>>>>>>//AB-StoreStart
47036>>>>>>>>>>>>>            
47036>>>>>>>>>>>>>            
47036>>>>>>>>>>>>>//AB-StoreEnd
47036>>>>>>>>>>>>>
47036>>>>>>>>>>>>>//AB/ End_Object    // prj
47036>>>>>>>>>>>Use sl054.SL         // sl054
INCLUDING FILE: SL054.SL
47036>>>>>>>>>>>>>//AB/ Project sl054:cars
47036>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
47036>>>>>>>>>>>>>//AB/     Set ProjectName to "sl054:cars"
47036>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl054.SL"
47036>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
47036>>>>>>>>>>>>>
47036>>>>>>>>>>>>>// Project Object Structure
47036>>>>>>>>>>>>>//   sl054 is a dbModalPanelSub
47036>>>>>>>>>>>>>//     Cars_DD is a DataDictionary
47036>>>>>>>>>>>>>//     oSelList is a dbListSub
47036>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
47036>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
47036>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
47036>>>>>>>>>>>>>
47036>>>>>>>>>>>>>// Register all objects
47036>>>>>>>>>>>>>Register_Object Cars_DD
47036>>>>>>>>>>>>>Register_Object oCancel_bn
47036>>>>>>>>>>>>>Register_Object oOK_bn
47036>>>>>>>>>>>>>Register_Object oSearch_bn
47036>>>>>>>>>>>>>Register_Object oSelList
47036>>>>>>>>>>>>>Register_Object sl054
47036>>>>>>>>>>>>>
47036>>>>>>>>>>>>>
47036>>>>>>>>>>>>>//AB-IgnoreStart
47036>>>>>>>>>>>>>
47036>>>>>>>>>>>>>Use DFAllEnt.pkg
47036>>>>>>>>>>>>>Use dbList.Sub
47036>>>>>>>>>>>>>Use Button.Sub
47036>>>>>>>>>>>>>
47036>>>>>>>>>>>>>
47036>>>>>>>>>>>>>Use Cars.DD
INCLUDING FILE: CARS.DD
47036>>>>>>>>>>>>>>>//DDB-FileStart
47036>>>>>>>>>>>>>>>//DDB-HeaderStart
47036>>>>>>>>>>>>>>>
47036>>>>>>>>>>>>>>>// File Name : CARS.DD
47036>>>>>>>>>>>>>>>// Class Name: Cars_DataDictionary
47036>>>>>>>>>>>>>>>// Revision  : 9
47036>>>>>>>>>>>>>>>// Version   : 2
47036>>>>>>>>>>>>>>>
47036>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
47036>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
47036>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
47036>>>>>>>>>>>>>>>
47036>>>>>>>>>>>>>>>Open Cars
47038>>>>>>>>>>>>>>>
47038>>>>>>>>>>>>>>>//DDB-HeaderEnd
47038>>>>>>>>>>>>>>>//DDB-ValidationStart
47038>>>>>>>>>>>>>>>
47038>>>>>>>>>>>>>>>Register_Object Cars_Ctype_Id_VT
47038>>>>>>>>>>>>>>>
47038>>>>>>>>>>>>>>>Object Cars_Ctype_Id_VT  is a CodeValidationTable
47040>>>>>>>>>>>>>>>    Set Type_Value        To "PUMPSTYPE"
47041>>>>>>>>>>>>>>>    Set Validate_State    To FALSE
47042>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
47043>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
47043>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
47043>>>>>>>>>>>>>>>End_Object   // Cars_Ctype_Id_VT
47044>>>>>>>>>>>>>>>//DDB-ValidationEnd
47044>>>>>>>>>>>>>>>//DDB-SelectionStart
47044>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl054  sl054.SL
47044>>>>>>>>>>>>>>>Register_Object sl054
47044>>>>>>>>>>>>>>>//DDB-SelectionEnd
47044>>>>>>>>>>>>>>>
47044>>>>>>>>>>>>>>>Class Cars_DataDictionary  is a DataDictionary_Sec
47045>>>>>>>>>>>>>>>
47045>>>>>>>>>>>>>>>    // Update:
47045>>>>>>>>>>>>>>>
47045>>>>>>>>>>>>>>>    Procedure Update
47046>>>>>>>>>>>>>>>        Forward Send Update
47048>>>>>>>>>>>>>>>        move syscurxr.company_code  to cars.car_company
47049>>>>>>>>>>>>>>>        move syscurxr.beto_site     to cars.car_bsite
47050>>>>>>>>>>>>>>>        // Insert Code Here
47050>>>>>>>>>>>>>>>    End_Procedure   // Update
47051>>>>>>>>>>>>>>>
47051>>>>>>>>>>>>>>>
47051>>>>>>>>>>>>>>>    // Define_Fields:
47051>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
47051>>>>>>>>>>>>>>>
47051>>>>>>>>>>>>>>>    Procedure Define_Fields
47052>>>>>>>>>>>>>>>        Forward Send Define_Fields
47054>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
47054>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
47054>>>>>>>>>>>>>>>
47054>>>>>>>>>>>>>>>        Set Main_File            To Cars.File_Number
47055>>>>>>>>>>>>>>>
47055>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
47056>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
47057>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
47058>>>>>>>>>>>>>>>
47058>>>>>>>>>>>>>>>        // Field-based properties.......................
47058>>>>>>>>>>>>>>>
47058>>>>>>>>>>>>>>>        // Cars.Car_Recnum
47058>>>>>>>>>>>>>>>
47058>>>>>>>>>>>>>>>        // Cars.Car_Company
47058>>>>>>>>>>>>>>>
47058>>>>>>>>>>>>>>>        // Cars.Car_Id
47058>>>>>>>>>>>>>>>        Set Field_Options          Field Cars.Car_Id To DD_AUTOFIND   
47059>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cars.Car_Id To (sl054(Self))
47060>>>>>>>>>>>>>>>        Set Key_Field_State        Field Cars.Car_Id To TRUE
47061>>>>>>>>>>>>>>>
47061>>>>>>>>>>>>>>>        // Cars.Car_Descr
47061>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cars.Car_Descr To (sl054(Self))
47062>>>>>>>>>>>>>>>
47062>>>>>>>>>>>>>>>        // Cars.Car_License
47062>>>>>>>>>>>>>>>
47062>>>>>>>>>>>>>>>        // Cars.Car_Driverrecn
47062>>>>>>>>>>>>>>>
47062>>>>>>>>>>>>>>>        // Cars.Car_Details
47062>>>>>>>>>>>>>>>
47062>>>>>>>>>>>>>>>        // Cars.Car_Maxm3
47062>>>>>>>>>>>>>>>
47062>>>>>>>>>>>>>>>        // Cars.Car_Sitew
47062>>>>>>>>>>>>>>>
47062>>>>>>>>>>>>>>>        // Cars.Car_Tare
47062>>>>>>>>>>>>>>>
47062>>>>>>>>>>>>>>>        // Cars.Car_Codematch
47062>>>>>>>>>>>>>>>
47062>>>>>>>>>>>>>>>        // Cars.Car_Driverid
47062>>>>>>>>>>>>>>>
47062>>>>>>>>>>>>>>>        // Cars.Car_Sn
47062>>>>>>>>>>>>>>>
47062>>>>>>>>>>>>>>>        // Cars.Car_Lastupdated
47062>>>>>>>>>>>>>>>
47062>>>>>>>>>>>>>>>        // Cars.Car_Markexp
47062>>>>>>>>>>>>>>>
47062>>>>>>>>>>>>>>>        // Cars.Car_748tare1
47062>>>>>>>>>>>>>>>
47062>>>>>>>>>>>>>>>        // Cars.Car_748tare2
47062>>>>>>>>>>>>>>>
47062>>>>>>>>>>>>>>>        // Cars.Car_748sign
47062>>>>>>>>>>>>>>>
47062>>>>>>>>>>>>>>>        // Cars.Car_Bsite
47062>>>>>>>>>>>>>>>
47062>>>>>>>>>>>>>>>        // Cars.Ctype_Id
47062>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Cars.Ctype_Id To "dbComboFormsub"
47063>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Cars.Ctype_Id To (Cars_Ctype_Id_VT(Self))
47064>>>>>>>>>>>>>>>
47064>>>>>>>>>>>>>>>        // Cars.Pagio
47064>>>>>>>>>>>>>>>
47064>>>>>>>>>>>>>>>        // Cars.Parakrat
47064>>>>>>>>>>>>>>>
47064>>>>>>>>>>>>>>>        // Cars.Car_What
47064>>>>>>>>>>>>>>>
47064>>>>>>>>>>>>>>>        // Cars.Car_Lc
47064>>>>>>>>>>>>>>>
47064>>>>>>>>>>>>>>>        // Cars.Car_Ln
47064>>>>>>>>>>>>>>>
47064>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
47064>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
47065>>>>>>>>>>>>>>>
47065>>>>>>>>>>>>>>>    // Field_Defaults:
47065>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
47065>>>>>>>>>>>>>>>
47065>>>>>>>>>>>>>>>    Procedure Field_Defaults
47066>>>>>>>>>>>>>>>        Forward Send Field_Defaults
47068>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
47068>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
47068>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
47068>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
47069>>>>>>>>>>>>>>>
47069>>>>>>>>>>>>>>>End_Class    // Cars_DataDictionary
47070>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
47070>>>>>>>>>>>>>>>
47070>>>>>>>>>>>>>>>Use sl054.SL         // sl054
47070>>>>>>>>>>>>>>>
47070>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
47070>>>>>>>>>>>>>>>//DDB-FileEnd
47070>>>>>>>>>>>>>
47070>>>>>>>>>>>>>//AB-IgnoreEnd
47070>>>>>>>>>>>>>
47070>>>>>>>>>>>>>Object sl054 is a dbModalPanelSub
47072>>>>>>>>>>>>>    Set Label to "€¨®œå¦ Ž®ž£á«à¤"
47073>>>>>>>>>>>>>    Set Size to 148 420
47074>>>>>>>>>>>>>    Set Location to 4 5
47075>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
47076>>>>>>>>>>>>>    Set Modal_State to FALSE
47077>>>>>>>>>>>>>
47077>>>>>>>>>>>>>    //AB-DDOStart
47077>>>>>>>>>>>>>
47077>>>>>>>>>>>>>    Object Cars_DD is a Cars_DataDictionary
47079>>>>>>>>>>>>>    End_Object    // Cars_DD
47080>>>>>>>>>>>>>
47080>>>>>>>>>>>>>    Set Main_DD to (Cars_DD(self))
47081>>>>>>>>>>>>>    Set Server to (Cars_DD(self))
47082>>>>>>>>>>>>>
47082>>>>>>>>>>>>>    //AB-DDOEnd
47082>>>>>>>>>>>>>
47082>>>>>>>>>>>>>    Object oSelList is a dbListSub
47084>>>>>>>>>>>>>        Set Main_File to Cars.File_Number
47085>>>>>>>>>>>>>        Set Size to 105 403
47086>>>>>>>>>>>>>        Set Location to 6 6
47087>>>>>>>>>>>>>
47087>>>>>>>>>>>>>        Begin_Row
47090>>>>>>>>>>>>>            Entry_Item Cars.Car_id
47091>>>>>>>>>>>>>            Entry_Item Cars.Car_descr
47092>>>>>>>>>>>>>            Entry_Item Cars.Car_license
47093>>>>>>>>>>>>>            Entry_Item Cars.Car_maxm3
47094>>>>>>>>>>>>>            Entry_Item Cars.Car_driverid
47095>>>>>>>>>>>>>        End_Row
47100>>>>>>>>>>>>>
47100>>>>>>>>>>>>>        Set Form_Width    item 0 to 80
47101>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à›.Ž®ã£˜«¦ª"
47102>>>>>>>>>>>>>        
47102>>>>>>>>>>>>>        Set Form_Width    item 1 to 120
47103>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
47104>>>>>>>>>>>>>        
47104>>>>>>>>>>>>>        Set Form_Width    item 2 to 80
47105>>>>>>>>>>>>>        Set Header_Label  item 2 to "€¨ Ÿ.‰¬¡¢¦­¦¨å˜ª"
47106>>>>>>>>>>>>>        
47106>>>>>>>>>>>>>        Set Form_Width    item 3 to 50
47107>>>>>>>>>>>>>        Set Header_Label  item 3 to "Max.m3"
47108>>>>>>>>>>>>>        
47108>>>>>>>>>>>>>        Set Form_Width    item 4 to 65
47109>>>>>>>>>>>>>        Set Header_Label  item 4 to "‰à›.Ž›žš¦ç"
47110>>>>>>>>>>>>>        
47110>>>>>>>>>>>>>    End_Object    // oSelList
47111>>>>>>>>>>>>>
47111>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
47113>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
47114>>>>>>>>>>>>>        Set Location to 114 249
47115>>>>>>>>>>>>>
47115>>>>>>>>>>>>>        //AB-StoreStart
47115>>>>>>>>>>>>>        Procedure OnClick
47117>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
47118>>>>>>>>>>>>>        End_Procedure
47119>>>>>>>>>>>>>        //AB-StoreEnd
47119>>>>>>>>>>>>>
47119>>>>>>>>>>>>>    End_Object    // oOK_bn
47120>>>>>>>>>>>>>
47120>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
47122>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
47123>>>>>>>>>>>>>        Set Location to 114 305
47124>>>>>>>>>>>>>
47124>>>>>>>>>>>>>        //AB-StoreStart
47124>>>>>>>>>>>>>        Procedure OnClick
47126>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
47127>>>>>>>>>>>>>        End_Procedure
47128>>>>>>>>>>>>>        //AB-StoreEnd
47128>>>>>>>>>>>>>
47128>>>>>>>>>>>>>    End_Object    // oCancel_bn
47129>>>>>>>>>>>>>
47129>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
47131>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
47132>>>>>>>>>>>>>        Set Location to 114 359
47133>>>>>>>>>>>>>
47133>>>>>>>>>>>>>        //AB-StoreStart
47133>>>>>>>>>>>>>        Procedure OnClick
47135>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
47136>>>>>>>>>>>>>        End_Procedure
47137>>>>>>>>>>>>>        //AB-StoreEnd
47137>>>>>>>>>>>>>
47137>>>>>>>>>>>>>    End_Object    // oSearch_bn
47138>>>>>>>>>>>>>
47138>>>>>>>>>>>>>
47138>>>>>>>>>>>>>    //AB-StoreStart
47138>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
47139>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
47140>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
47141>>>>>>>>>>>>>    //AB-StoreEnd
47141>>>>>>>>>>>>>
47141>>>>>>>>>>>>>End_Object    // sl054
47142>>>>>>>>>>>>>
47142>>>>>>>>>>>>>//AB/ End_Object    // prj
47142>>>>>>>>>>>Use sl053.SL         // sl053
INCLUDING FILE: SL053.SL
47142>>>>>>>>>>>>>//AB/ Project sl053:pumps
47142>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
47142>>>>>>>>>>>>>//AB/     Set ProjectName to "sl053:pumps"
47142>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl053.SL"
47142>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
47142>>>>>>>>>>>>>
47142>>>>>>>>>>>>>// Project Object Structure
47142>>>>>>>>>>>>>//   sl053 is a dbModalPanelSub
47142>>>>>>>>>>>>>//     Pumps_DD is a DataDictionary
47142>>>>>>>>>>>>>//     oSelList is a dbListSub
47142>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
47142>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
47142>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
47142>>>>>>>>>>>>>
47142>>>>>>>>>>>>>// Register all objects
47142>>>>>>>>>>>>>Register_Object oCancel_bn
47142>>>>>>>>>>>>>Register_Object oOK_bn
47142>>>>>>>>>>>>>Register_Object oSearch_bn
47142>>>>>>>>>>>>>Register_Object oSelList
47142>>>>>>>>>>>>>Register_Object Pumps_DD
47142>>>>>>>>>>>>>Register_Object sl053
47142>>>>>>>>>>>>>
47142>>>>>>>>>>>>>
47142>>>>>>>>>>>>>//AB-IgnoreStart
47142>>>>>>>>>>>>>
47142>>>>>>>>>>>>>Use DFAllEnt.pkg
47142>>>>>>>>>>>>>Use dbList.Sub
47142>>>>>>>>>>>>>Use Button.Sub
47142>>>>>>>>>>>>>
47142>>>>>>>>>>>>>
47142>>>>>>>>>>>>>Use Pumps.DD
INCLUDING FILE: PUMPS.DD
47142>>>>>>>>>>>>>>>//DDB-FileStart
47142>>>>>>>>>>>>>>>//DDB-HeaderStart
47142>>>>>>>>>>>>>>>
47142>>>>>>>>>>>>>>>// File Name : PUMPS.DD
47142>>>>>>>>>>>>>>>// Class Name: Pumps_DataDictionary
47142>>>>>>>>>>>>>>>// Revision  : 13
47142>>>>>>>>>>>>>>>// Version   : 2
47142>>>>>>>>>>>>>>>
47142>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
47142>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
47142>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
47142>>>>>>>>>>>>>>>
47142>>>>>>>>>>>>>>>Open Pumps
47144>>>>>>>>>>>>>>>
47144>>>>>>>>>>>>>>>//DDB-HeaderEnd
47144>>>>>>>>>>>>>>>//DDB-ValidationStart
47144>>>>>>>>>>>>>>>
47144>>>>>>>>>>>>>>>Register_Object Pumps_Ctype_Id_VT
47144>>>>>>>>>>>>>>>
47144>>>>>>>>>>>>>>>Object Pumps_Ctype_Id_VT  is a CodeValidationTable
47146>>>>>>>>>>>>>>>    Set Type_Value        To "PUMPSTYPE"
47147>>>>>>>>>>>>>>>    Set Validate_State    To FALSE
47148>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
47149>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
47149>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
47149>>>>>>>>>>>>>>>End_Object   // Pumps_Ctype_Id_VT
47150>>>>>>>>>>>>>>>//DDB-ValidationEnd
47150>>>>>>>>>>>>>>>//DDB-SelectionStart
47150>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl053  sl053.SL
47150>>>>>>>>>>>>>>>Register_Object sl053
47150>>>>>>>>>>>>>>>//DDB-SelectionEnd
47150>>>>>>>>>>>>>>>
47150>>>>>>>>>>>>>>>Class Pumps_DataDictionary  is a DataDictionary_Sec
47151>>>>>>>>>>>>>>>
47151>>>>>>>>>>>>>>>    // Update:
47151>>>>>>>>>>>>>>>
47151>>>>>>>>>>>>>>>    Procedure Update
47152>>>>>>>>>>>>>>>        Forward Send Update
47154>>>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to Pumps.Pump_Company
47155>>>>>>>>>>>>>>>        Move SysCurXR.Beto_Site     to Pumps.Pump_SiteW
47156>>>>>>>>>>>>>>>    End_Procedure   // Update
47157>>>>>>>>>>>>>>>
47157>>>>>>>>>>>>>>>
47157>>>>>>>>>>>>>>>    // Define_Fields:
47157>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
47157>>>>>>>>>>>>>>>
47157>>>>>>>>>>>>>>>    Procedure Define_Fields
47158>>>>>>>>>>>>>>>        Forward Send Define_Fields
47160>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
47160>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
47160>>>>>>>>>>>>>>>
47160>>>>>>>>>>>>>>>        Set Main_File            To Pumps.File_Number
47161>>>>>>>>>>>>>>>
47161>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
47162>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
47163>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
47164>>>>>>>>>>>>>>>
47164>>>>>>>>>>>>>>>        // Field-based properties.......................
47164>>>>>>>>>>>>>>>
47164>>>>>>>>>>>>>>>        // Pumps.Pump_Recnum
47164>>>>>>>>>>>>>>>
47164>>>>>>>>>>>>>>>        // Pumps.Pump_Company
47164>>>>>>>>>>>>>>>
47164>>>>>>>>>>>>>>>        // Pumps.Pump_Id
47164>>>>>>>>>>>>>>>        Set Field_Options          Field Pumps.Pump_Id To DD_AUTOFIND   
47165>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Pumps.Pump_Id To (sl053(Self))
47166>>>>>>>>>>>>>>>        Set Key_Field_State        Field Pumps.Pump_Id To TRUE
47167>>>>>>>>>>>>>>>
47167>>>>>>>>>>>>>>>        // Pumps.Pump_Descr
47167>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Pumps.Pump_Descr To (sl053(Self))
47168>>>>>>>>>>>>>>>
47168>>>>>>>>>>>>>>>        // Pumps.Pump_License
47168>>>>>>>>>>>>>>>
47168>>>>>>>>>>>>>>>        // Pumps.Pump_Mhkos
47168>>>>>>>>>>>>>>>
47168>>>>>>>>>>>>>>>        // Pumps.Pump_Mhkosch
47168>>>>>>>>>>>>>>>
47168>>>>>>>>>>>>>>>        // Pumps.Pump_Codematch
47168>>>>>>>>>>>>>>>
47168>>>>>>>>>>>>>>>        // Pumps.Pump_Sitew
47168>>>>>>>>>>>>>>>
47168>>>>>>>>>>>>>>>        // Pumps.Pump_Driver
47168>>>>>>>>>>>>>>>
47168>>>>>>>>>>>>>>>        // Pumps.Pump_Bsite
47168>>>>>>>>>>>>>>>
47168>>>>>>>>>>>>>>>        // Pumps.Ctype_Id
47168>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Pumps.Ctype_Id To "dbComboFormsub"
47169>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Pumps.Ctype_Id To (Pumps_Ctype_Id_VT(Self))
47170>>>>>>>>>>>>>>>
47170>>>>>>>>>>>>>>>        // Pumps.Pagiomin
47170>>>>>>>>>>>>>>>
47170>>>>>>>>>>>>>>>        // Pumps.Pricem3
47170>>>>>>>>>>>>>>>
47170>>>>>>>>>>>>>>>        // Pumps.Parakrat
47170>>>>>>>>>>>>>>>
47170>>>>>>>>>>>>>>>        // Pumps.Pump_What
47170>>>>>>>>>>>>>>>
47170>>>>>>>>>>>>>>>        // Pumps.Pump_Lc
47170>>>>>>>>>>>>>>>
47170>>>>>>>>>>>>>>>        // Pumps.Pump_Ln
47170>>>>>>>>>>>>>>>
47170>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
47170>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
47171>>>>>>>>>>>>>>>
47171>>>>>>>>>>>>>>>    // Field_Defaults:
47171>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
47171>>>>>>>>>>>>>>>
47171>>>>>>>>>>>>>>>    Procedure Field_Defaults
47172>>>>>>>>>>>>>>>        Forward Send Field_Defaults
47174>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
47174>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
47174>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
47174>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
47175>>>>>>>>>>>>>>>
47175>>>>>>>>>>>>>>>End_Class    // Pumps_DataDictionary
47176>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
47176>>>>>>>>>>>>>>>
47176>>>>>>>>>>>>>>>Use sl053.SL         // sl053
47176>>>>>>>>>>>>>>>
47176>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
47176>>>>>>>>>>>>>>>//DDB-FileEnd
47176>>>>>>>>>>>>>
47176>>>>>>>>>>>>>//AB-IgnoreEnd
47176>>>>>>>>>>>>>
47176>>>>>>>>>>>>>Object sl053 is a dbModalPanelSub
47178>>>>>>>>>>>>>    Set Label to "€¨®œå¦ €¤«¢ é¤"
47179>>>>>>>>>>>>>    Set Size to 148 325
47180>>>>>>>>>>>>>    Set Location to 4 5
47181>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
47182>>>>>>>>>>>>>    Set Modal_State to FALSE
47183>>>>>>>>>>>>>
47183>>>>>>>>>>>>>    //AB-DDOStart
47183>>>>>>>>>>>>>
47183>>>>>>>>>>>>>    Object Pumps_DD is a Pumps_DataDictionary
47185>>>>>>>>>>>>>    End_Object    // Pumps_DD
47186>>>>>>>>>>>>>
47186>>>>>>>>>>>>>    Set Main_DD to (Pumps_DD(self))
47187>>>>>>>>>>>>>    Set Server to (Pumps_DD(self))
47188>>>>>>>>>>>>>
47188>>>>>>>>>>>>>    //AB-DDOEnd
47188>>>>>>>>>>>>>
47188>>>>>>>>>>>>>    Object oSelList is a dbListSub
47190>>>>>>>>>>>>>        Set Main_File to Pumps.File_Number
47191>>>>>>>>>>>>>        Set Size to 105 309
47192>>>>>>>>>>>>>        Set Location to 6 6
47193>>>>>>>>>>>>>
47193>>>>>>>>>>>>>        Begin_Row
47196>>>>>>>>>>>>>            Entry_Item Pumps.Pump_id
47197>>>>>>>>>>>>>            Entry_Item Pumps.Pump_descr
47198>>>>>>>>>>>>>            Entry_Item Pumps.Pump_license
47199>>>>>>>>>>>>>            Entry_Item Pumps.Pump_mhkos
47200>>>>>>>>>>>>>        End_Row
47205>>>>>>>>>>>>>
47205>>>>>>>>>>>>>        Set Form_Width    item 0 to 70
47206>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª €¤«¢å˜ª"
47207>>>>>>>>>>>>>        
47207>>>>>>>>>>>>>        Set Form_Width    item 1 to 120
47208>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
47209>>>>>>>>>>>>>        
47209>>>>>>>>>>>>>        Set Form_Width    item 2 to 65
47210>>>>>>>>>>>>>        Set Header_Label  item 2 to " ¤˜¡å›˜"
47211>>>>>>>>>>>>>        
47211>>>>>>>>>>>>>        Set Form_Width    item 3 to 46
47212>>>>>>>>>>>>>        Set Header_Label  item 3 to "‹ã¡¦ª"
47213>>>>>>>>>>>>>        
47213>>>>>>>>>>>>>    End_Object    // oSelList
47214>>>>>>>>>>>>>
47214>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
47216>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
47217>>>>>>>>>>>>>        Set Location to 114 157
47218>>>>>>>>>>>>>
47218>>>>>>>>>>>>>        //AB-StoreStart
47218>>>>>>>>>>>>>        Procedure OnClick
47220>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
47221>>>>>>>>>>>>>        End_Procedure
47222>>>>>>>>>>>>>        //AB-StoreEnd
47222>>>>>>>>>>>>>
47222>>>>>>>>>>>>>    End_Object    // oOK_bn
47223>>>>>>>>>>>>>
47223>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
47225>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
47226>>>>>>>>>>>>>        Set Location to 114 212
47227>>>>>>>>>>>>>
47227>>>>>>>>>>>>>        //AB-StoreStart
47227>>>>>>>>>>>>>        Procedure OnClick
47229>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
47230>>>>>>>>>>>>>        End_Procedure
47231>>>>>>>>>>>>>        //AB-StoreEnd
47231>>>>>>>>>>>>>
47231>>>>>>>>>>>>>    End_Object    // oCancel_bn
47232>>>>>>>>>>>>>
47232>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
47234>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
47235>>>>>>>>>>>>>        Set Location to 114 267
47236>>>>>>>>>>>>>
47236>>>>>>>>>>>>>        //AB-StoreStart
47236>>>>>>>>>>>>>        Procedure OnClick
47238>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
47239>>>>>>>>>>>>>        End_Procedure
47240>>>>>>>>>>>>>        //AB-StoreEnd
47240>>>>>>>>>>>>>
47240>>>>>>>>>>>>>    End_Object    // oSearch_bn
47241>>>>>>>>>>>>>
47241>>>>>>>>>>>>>
47241>>>>>>>>>>>>>    //AB-StoreStart
47241>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
47242>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
47243>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
47244>>>>>>>>>>>>>    //AB-StoreEnd
47244>>>>>>>>>>>>>
47244>>>>>>>>>>>>>End_Object    // sl053
47245>>>>>>>>>>>>>
47245>>>>>>>>>>>>>//AB/ End_Object    // prj
47245>>>>>>>>>>>Use sl064.SL         // sl064
INCLUDING FILE: SL064.SL
47245>>>>>>>>>>>>>//AB/ Project sl064 : Zones
47245>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
47245>>>>>>>>>>>>>//AB/     Set ProjectName to "sl064 : Zones"
47245>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl064.SL"
47245>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
47245>>>>>>>>>>>>>
47245>>>>>>>>>>>>>// Project Object Structure
47245>>>>>>>>>>>>>//   sl064 is a dbModalPanelSub
47245>>>>>>>>>>>>>//     Zones_DD is a DataDictionary
47245>>>>>>>>>>>>>//     oSelList is a dbListSub
47245>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
47245>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
47245>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
47245>>>>>>>>>>>>>
47245>>>>>>>>>>>>>// Register all objects
47245>>>>>>>>>>>>>Register_Object oCancel_bn
47245>>>>>>>>>>>>>Register_Object oOK_bn
47245>>>>>>>>>>>>>Register_Object oSearch_bn
47245>>>>>>>>>>>>>Register_Object oSelList
47245>>>>>>>>>>>>>Register_Object sl064
47245>>>>>>>>>>>>>Register_Object Zones_DD
47245>>>>>>>>>>>>>
47245>>>>>>>>>>>>>
47245>>>>>>>>>>>>>//AB-IgnoreStart
47245>>>>>>>>>>>>>
47245>>>>>>>>>>>>>Use DFAllEnt.pkg
47245>>>>>>>>>>>>>Use dbList.Sub
47245>>>>>>>>>>>>>Use Button.Sub
47245>>>>>>>>>>>>>
47245>>>>>>>>>>>>>
47245>>>>>>>>>>>>>Use ZONES.DD
INCLUDING FILE: ZONES.DD
47245>>>>>>>>>>>>>>>//DDB-FileStart
47245>>>>>>>>>>>>>>>//DDB-HeaderStart
47245>>>>>>>>>>>>>>>
47245>>>>>>>>>>>>>>>// File Name : ZONES.DD
47245>>>>>>>>>>>>>>>// Class Name: Zones_DataDictionary
47245>>>>>>>>>>>>>>>// Revision  : 4
47245>>>>>>>>>>>>>>>// Version   : 2
47245>>>>>>>>>>>>>>>
47245>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
47245>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
47245>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
47245>>>>>>>>>>>>>>>
47245>>>>>>>>>>>>>>>Open Zones
INCLUDING FILE: ZONES.FD
47247>>>>>>>>>>>>>>>Open Brzones
47249>>>>>>>>>>>>>>>
47249>>>>>>>>>>>>>>>//DDB-HeaderEnd
47249>>>>>>>>>>>>>>>//DDB-SelectionStart
47249>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl064  sl064.SL
47249>>>>>>>>>>>>>>>Register_Object sl064
47249>>>>>>>>>>>>>>>//DDB-SelectionEnd
47249>>>>>>>>>>>>>>>
47249>>>>>>>>>>>>>>>Class Zones_DataDictionary  is a DataDictionary_Sec
47250>>>>>>>>>>>>>>>
47250>>>>>>>>>>>>>>>    // Define_Fields:
47250>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
47250>>>>>>>>>>>>>>>
47250>>>>>>>>>>>>>>>    Procedure Define_Fields
47251>>>>>>>>>>>>>>>        Forward Send Define_Fields
47253>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
47253>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
47253>>>>>>>>>>>>>>>
47253>>>>>>>>>>>>>>>        Set Main_File            To Zones.File_Number
47254>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
47255>>>>>>>>>>>>>>>
47255>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
47256>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
47257>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
47258>>>>>>>>>>>>>>>
47258>>>>>>>>>>>>>>>        // Child (Client) file structure................
47258>>>>>>>>>>>>>>>        Send Add_Client_File  Brzones.File_Number
47259>>>>>>>>>>>>>>>
47259>>>>>>>>>>>>>>>        // Field-based properties.......................
47259>>>>>>>>>>>>>>>
47259>>>>>>>>>>>>>>>        // Zones.Zone_Id
47259>>>>>>>>>>>>>>>        Set Field_Options          Field Zones.Zone_Id To DD_AUTOFIND   
47260>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Zones.Zone_Id To (sl064(Self))
47261>>>>>>>>>>>>>>>        Set Key_Field_State        Field Zones.Zone_Id To TRUE
47262>>>>>>>>>>>>>>>
47262>>>>>>>>>>>>>>>        // Zones.Zone_Descr
47262>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Zones.Zone_Descr To (sl064(Self))
47263>>>>>>>>>>>>>>>
47263>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
47263>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
47264>>>>>>>>>>>>>>>
47264>>>>>>>>>>>>>>>    // Field_Defaults:
47264>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
47264>>>>>>>>>>>>>>>
47264>>>>>>>>>>>>>>>    Procedure Field_Defaults
47265>>>>>>>>>>>>>>>        Forward Send Field_Defaults
47267>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
47267>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
47267>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
47267>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
47268>>>>>>>>>>>>>>>
47268>>>>>>>>>>>>>>>End_Class    // Zones_DataDictionary
47269>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
47269>>>>>>>>>>>>>>>
47269>>>>>>>>>>>>>>>Use sl064.SL         // sl064
47269>>>>>>>>>>>>>>>
47269>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
47269>>>>>>>>>>>>>>>//DDB-FileEnd
47269>>>>>>>>>>>>>
47269>>>>>>>>>>>>>//AB-IgnoreEnd
47269>>>>>>>>>>>>>
47269>>>>>>>>>>>>>CD_Popup_Object sl064 is a dbModalPanelSub
47288>>>>>>>>>>>>>    Set Label to "…é¤œª"
47289>>>>>>>>>>>>>    Set Size to 148 297
47290>>>>>>>>>>>>>    Set Location to 4 5
47291>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
47292>>>>>>>>>>>>>    Set Modal_State to FALSE
47293>>>>>>>>>>>>>
47293>>>>>>>>>>>>>    //AB-DDOStart
47293>>>>>>>>>>>>>
47293>>>>>>>>>>>>>    Object Zones_DD is a Zones_DataDictionary
47295>>>>>>>>>>>>>    End_Object    // Zones_DD
47296>>>>>>>>>>>>>
47296>>>>>>>>>>>>>    Set Main_DD to (Zones_DD(self))
47297>>>>>>>>>>>>>    Set Server to (Zones_DD(self))
47298>>>>>>>>>>>>>
47298>>>>>>>>>>>>>    //AB-DDOEnd
47298>>>>>>>>>>>>>
47298>>>>>>>>>>>>>    Object oSelList is a dbListSub
47300>>>>>>>>>>>>>        Set Main_File to Zones.File_Number
47301>>>>>>>>>>>>>        Set Size to 105 280
47302>>>>>>>>>>>>>        Set Location to 6 6
47303>>>>>>>>>>>>>
47303>>>>>>>>>>>>>        Begin_Row
47306>>>>>>>>>>>>>            Entry_Item Zones.Zone_id
47307>>>>>>>>>>>>>            Entry_Item Zones.Zone_descr
47308>>>>>>>>>>>>>        End_Row
47313>>>>>>>>>>>>>
47313>>>>>>>>>>>>>        Set Form_Width    item 0 to 73
47314>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
47315>>>>>>>>>>>>>        
47315>>>>>>>>>>>>>        Set Form_Width    item 1 to 199
47316>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
47317>>>>>>>>>>>>>        
47317>>>>>>>>>>>>>    End_Object    // oSelList
47318>>>>>>>>>>>>>
47318>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
47320>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
47321>>>>>>>>>>>>>        Set Location to 115 126
47322>>>>>>>>>>>>>
47322>>>>>>>>>>>>>        //AB-StoreStart
47322>>>>>>>>>>>>>        Procedure OnClick
47324>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
47325>>>>>>>>>>>>>        End_Procedure
47326>>>>>>>>>>>>>        //AB-StoreEnd
47326>>>>>>>>>>>>>
47326>>>>>>>>>>>>>    End_Object    // oOK_bn
47327>>>>>>>>>>>>>
47327>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
47329>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
47330>>>>>>>>>>>>>        Set Location to 115 181
47331>>>>>>>>>>>>>
47331>>>>>>>>>>>>>        //AB-StoreStart
47331>>>>>>>>>>>>>        Procedure OnClick
47333>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
47334>>>>>>>>>>>>>        End_Procedure
47335>>>>>>>>>>>>>        //AB-StoreEnd
47335>>>>>>>>>>>>>
47335>>>>>>>>>>>>>    End_Object    // oCancel_bn
47336>>>>>>>>>>>>>
47336>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
47338>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
47339>>>>>>>>>>>>>        Set Location to 115 236
47340>>>>>>>>>>>>>
47340>>>>>>>>>>>>>        //AB-StoreStart
47340>>>>>>>>>>>>>        Procedure OnClick
47342>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
47343>>>>>>>>>>>>>        End_Procedure
47344>>>>>>>>>>>>>        //AB-StoreEnd
47344>>>>>>>>>>>>>
47344>>>>>>>>>>>>>    End_Object    // oSearch_bn
47345>>>>>>>>>>>>>
47345>>>>>>>>>>>>>
47345>>>>>>>>>>>>>    //AB-StoreStart
47345>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
47346>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
47347>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
47348>>>>>>>>>>>>>    //AB-StoreEnd
47348>>>>>>>>>>>>>
47348>>>>>>>>>>>>>CD_End_Object    // sl064
47350>>>>>>>>>>>>>>
47350>>>>>>>>>>>>>
47350>>>>>>>>>>>>>//AB/ End_Object    // prj
47350>>>>>>>>>>>
47350>>>>>>>>>>>//DDB-Selection-pkg-End
47350>>>>>>>>>>>//DDB-FileEnd
47350>>>>>>>>>    Use WAPOKAT.DD
INCLUDING FILE: WAPOKAT.DD
47350>>>>>>>>>>>//DDB-FileStart
47350>>>>>>>>>>>//DDB-HeaderStart
47350>>>>>>>>>>>
47350>>>>>>>>>>>// File Name : WAPOKAT.DD
47350>>>>>>>>>>>// Class Name: Wapokat_DataDictionary
47350>>>>>>>>>>>// Revision  : 21
47350>>>>>>>>>>>// Version   : 2
47350>>>>>>>>>>>
47350>>>>>>>>>>>Use  Windows           // Basic Definitions
47350>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
47350>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
47350>>>>>>>>>>>
47350>>>>>>>>>>>Open Wapokat
INCLUDING FILE: WAPOKAT.FD
47352>>>>>>>>>>>Open Wapomast
INCLUDING FILE: WAPOMAST.FD
47354>>>>>>>>>>>Open Sysrecw
47356>>>>>>>>>>>Open Syscurxr
47358>>>>>>>>>>>
47358>>>>>>>>>>>//DDB-HeaderEnd
47358>>>>>>>>>>>//DDB-SelectionStart
47358>>>>>>>>>>>//DDB/ ExternalSelectionList sl022  sl022.SL
47358>>>>>>>>>>>Register_Object sl022
47358>>>>>>>>>>>//DDB-SelectionEnd
47358>>>>>>>>>>>
47358>>>>>>>>>>>Class Wapokat_DataDictionary  is a DataDictionary
47359>>>>>>>>>>>
47359>>>>>>>>>>>    // Update:
47359>>>>>>>>>>>    Procedure Update
47360>>>>>>>>>>>        Forward Send Update
47362>>>>>>>>>>>        // Insert Code Here
47362>>>>>>>>>>>//        Move SysCurXR.Company_Code   to Wapokat.Company_Code
47362>>>>>>>>>>>//        Move SysCurXR.Branch_Code     to Wapokat.Branch_Code
47362>>>>>>>>>>>//        Move SysCurXR.Year_Year         to Wapokat.Year_Year
47362>>>>>>>>>>>    End_Procedure   // Update
47363>>>>>>>>>>> 
47363>>>>>>>>>>>     Procedure Creating
47364>>>>>>>>>>>        Forward Send Creating
47366>>>>>>>>>>>        // Insert Code Here
47366>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wapokat.Wapokat_Rec0)))))) to Wapokat.Wapokat_Recr
47367>>>>>>>>>>>    End_Procedure   // Creating
47368>>>>>>>>>>>
47368>>>>>>>>>>>
47368>>>>>>>>>>>    // Define_Fields:
47368>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
47368>>>>>>>>>>>
47368>>>>>>>>>>>    Procedure Define_Fields
47369>>>>>>>>>>>        Forward Send Define_Fields
47371>>>>>>>>>>>        //DDB-Generated-Code-Location
47371>>>>>>>>>>>        //DDB-DefineFieldStart
47371>>>>>>>>>>>
47371>>>>>>>>>>>        Set Main_File            To Wapokat.File_Number
47372>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
47373>>>>>>>>>>>
47373>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
47374>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
47375>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
47376>>>>>>>>>>>
47376>>>>>>>>>>>        // Child (Client) file structure................
47376>>>>>>>>>>>        Send Add_Client_File  Wapomast.File_Number
47377>>>>>>>>>>>
47377>>>>>>>>>>>        // External (System) file structure.............
47377>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
47378>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
47379>>>>>>>>>>>
47379>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Wapokat_Rec0  To Wapokat.Wapokat_Rec0
47382>>>>>>>>>>>
47382>>>>>>>>>>>        // Field-based properties.......................
47382>>>>>>>>>>>
47382>>>>>>>>>>>        // Wapokat.Wapokat_Code
47382>>>>>>>>>>>        Set Field_Options          Field Wapokat.Wapokat_Code To DD_AUTOFIND   
47383>>>>>>>>>>>        Set Field_Prompt_Object    Field Wapokat.Wapokat_Code To (sl022(Self))
47384>>>>>>>>>>>
47384>>>>>>>>>>>        // Wapokat.Wapokat_Rec0
47384>>>>>>>>>>>        Set Field_Options          Field Wapokat.Wapokat_Rec0 To DD_AUTOFIND   
47385>>>>>>>>>>>
47385>>>>>>>>>>>        // Wapokat.Wapokat_Descr
47385>>>>>>>>>>>        Set Field_Prompt_Object    Field Wapokat.Wapokat_Descr To (sl022(Self))
47386>>>>>>>>>>>
47386>>>>>>>>>>>        // Wapokat.Wapokat_Recr
47386>>>>>>>>>>>        Set Field_Options          Field Wapokat.Wapokat_Recr To DD_AUTOFIND   
47387>>>>>>>>>>>
47387>>>>>>>>>>>        // Wapokat.Enhm_Sap
47387>>>>>>>>>>>
47387>>>>>>>>>>>        // Wapokat.Sap_Descr
47387>>>>>>>>>>>
47387>>>>>>>>>>>        // Wapokat.Gl
47387>>>>>>>>>>>
47387>>>>>>>>>>>        // Wapokat.Glzz
47387>>>>>>>>>>>
47387>>>>>>>>>>>        // Wapokat.Oximm1
47387>>>>>>>>>>>
47387>>>>>>>>>>>        //DDB-DefineFieldEnd
47387>>>>>>>>>>>    End_Procedure    // Define_Fields
47388>>>>>>>>>>>
47388>>>>>>>>>>>    // Field_Defaults:
47388>>>>>>>>>>>    // This procedure is used to establish default field values.
47388>>>>>>>>>>>
47388>>>>>>>>>>>    Procedure Field_Defaults
47389>>>>>>>>>>>        Forward Send Field_Defaults
47391>>>>>>>>>>>        //DDB-Generated-Code-Location
47391>>>>>>>>>>>        //DDB-FieldDefaultStart
47391>>>>>>>>>>>        //DDB-FieldDefaultEnd
47391>>>>>>>>>>>    End_Procedure    // Field_Defaults
47392>>>>>>>>>>>
47392>>>>>>>>>>>End_Class    // Wapokat_DataDictionary
47393>>>>>>>>>>>//DDB-Selection-pkg-Start
47393>>>>>>>>>>>
47393>>>>>>>>>>>Use sl022.SL         // sl022
INCLUDING FILE: SL022.SL
47393>>>>>>>>>>>>>//AB/ Project sl022:kathg-apothkon
47393>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
47393>>>>>>>>>>>>>//AB/     Set ProjectName to "sl022:kathg-apothkon"
47393>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl022.SL"
47393>>>>>>>>>>>>>
47393>>>>>>>>>>>>>// Project Object Structure
47393>>>>>>>>>>>>>//   sl022 is a dbModalPanelSub
47393>>>>>>>>>>>>>//     Wapokat_DD is a DataDictionary
47393>>>>>>>>>>>>>//     oSelList is a dbListSub
47393>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
47393>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
47393>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
47393>>>>>>>>>>>>>
47393>>>>>>>>>>>>>// Register all objects
47393>>>>>>>>>>>>>Register_Object oCancel_bn
47393>>>>>>>>>>>>>Register_Object oOK_bn
47393>>>>>>>>>>>>>Register_Object oSearch_bn
47393>>>>>>>>>>>>>Register_Object oSelList
47393>>>>>>>>>>>>>Register_Object sl022
47393>>>>>>>>>>>>>Register_Object Wapokat_DD
47393>>>>>>>>>>>>>
47393>>>>>>>>>>>>>
47393>>>>>>>>>>>>>//AB-IgnoreStart
47393>>>>>>>>>>>>>
47393>>>>>>>>>>>>>Use DFAllEnt.pkg
47393>>>>>>>>>>>>>Use dbList.Sub
47393>>>>>>>>>>>>>Use Button.Sub
47393>>>>>>>>>>>>>
47393>>>>>>>>>>>>>
47393>>>>>>>>>>>>>Use WAPOKAT.DD
47393>>>>>>>>>>>>>
47393>>>>>>>>>>>>>//AB-IgnoreEnd
47393>>>>>>>>>>>>>
47393>>>>>>>>>>>>>CD_Popup_Object sl022 is a dbModalPanelSub
47412>>>>>>>>>>>>>    set label to "‰˜«žš¦¨åœª €§¦Ÿž¡é¤" 
47413>>>>>>>>>>>>>    Set Size to 148 297
47414>>>>>>>>>>>>>    Set Location to 12 19
47415>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
47416>>>>>>>>>>>>>    Set Modal_State to FALSE
47417>>>>>>>>>>>>>
47417>>>>>>>>>>>>>    //AB-DDOStart
47417>>>>>>>>>>>>>
47417>>>>>>>>>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
47419>>>>>>>>>>>>>    End_Object    // Wapokat_DD
47420>>>>>>>>>>>>>
47420>>>>>>>>>>>>>    Set Main_DD to (Wapokat_DD(self))
47421>>>>>>>>>>>>>    Set Server to (Wapokat_DD(self))
47422>>>>>>>>>>>>>
47422>>>>>>>>>>>>>    //AB-DDOEnd
47422>>>>>>>>>>>>>
47422>>>>>>>>>>>>>    Object oSelList is a dbListSub
47424>>>>>>>>>>>>>        Set Main_File to Wapokat.File_Number
47425>>>>>>>>>>>>>        Set Size to 105 280
47426>>>>>>>>>>>>>        Set Location to 6 6
47427>>>>>>>>>>>>>
47427>>>>>>>>>>>>>        Begin_Row
47430>>>>>>>>>>>>>            Entry_Item Wapokat.Wapokat_code
47431>>>>>>>>>>>>>            Entry_Item Wapokat.Wapokat_descr
47432>>>>>>>>>>>>>        End_Row
47437>>>>>>>>>>>>>
47437>>>>>>>>>>>>>        Set Form_Width    item 0 to 42
47438>>>>>>>>>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
47439>>>>>>>>>>>>>        
47439>>>>>>>>>>>>>        Set Form_Width    item 1 to 228
47440>>>>>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
47441>>>>>>>>>>>>>        
47441>>>>>>>>>>>>>    End_Object    // oSelList
47442>>>>>>>>>>>>>
47442>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
47444>>>>>>>>>>>>>        set label to "&„§ ¢¦šã" 
47445>>>>>>>>>>>>>        Set Location to 115 126
47446>>>>>>>>>>>>>
47446>>>>>>>>>>>>>        //AB-StoreStart
47446>>>>>>>>>>>>>        Procedure OnClick
47448>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
47449>>>>>>>>>>>>>        End_Procedure
47450>>>>>>>>>>>>>        //AB-StoreEnd
47450>>>>>>>>>>>>>
47450>>>>>>>>>>>>>    End_Object    // oOK_bn
47451>>>>>>>>>>>>>
47451>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
47453>>>>>>>>>>>>>        set label to "&€¡ç¨à©ž" 
47454>>>>>>>>>>>>>        Set Location to 115 181
47455>>>>>>>>>>>>>
47455>>>>>>>>>>>>>        //AB-StoreStart
47455>>>>>>>>>>>>>        Procedure OnClick
47457>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
47458>>>>>>>>>>>>>        End_Procedure
47459>>>>>>>>>>>>>        //AB-StoreEnd
47459>>>>>>>>>>>>>
47459>>>>>>>>>>>>>    End_Object    // oCancel_bn
47460>>>>>>>>>>>>>
47460>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
47462>>>>>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
47463>>>>>>>>>>>>>        Set Location to 115 236
47464>>>>>>>>>>>>>
47464>>>>>>>>>>>>>        //AB-StoreStart
47464>>>>>>>>>>>>>        Procedure OnClick
47466>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
47467>>>>>>>>>>>>>        End_Procedure
47468>>>>>>>>>>>>>        //AB-StoreEnd
47468>>>>>>>>>>>>>
47468>>>>>>>>>>>>>    End_Object    // oSearch_bn
47469>>>>>>>>>>>>>
47469>>>>>>>>>>>>>
47469>>>>>>>>>>>>>    //AB-StoreStart
47469>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
47470>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
47471>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
47472>>>>>>>>>>>>>    //AB-StoreEnd
47472>>>>>>>>>>>>>
47472>>>>>>>>>>>>>CD_End_Object    // sl022
47474>>>>>>>>>>>>>>
47474>>>>>>>>>>>>>
47474>>>>>>>>>>>>>//AB/ End_Object    // prj
47474>>>>>>>>>>>
47474>>>>>>>>>>>//DDB-Selection-pkg-End
47474>>>>>>>>>>>//DDB-FileEnd
47474>>>>>>>>>    Use WAPOMAST.DD
INCLUDING FILE: WAPOMAST.DD
47474>>>>>>>>>>>//DDB-FileStart
47474>>>>>>>>>>>//DDB-HeaderStart
47474>>>>>>>>>>>
47474>>>>>>>>>>>// File Name : WAPOMAST.DD
47474>>>>>>>>>>>// Class Name: Wapomast_DataDictionary
47474>>>>>>>>>>>// Revision  : 13
47474>>>>>>>>>>>// Version   : 2
47474>>>>>>>>>>>
47474>>>>>>>>>>>Use  Windows           // Basic Definitions
47474>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
47474>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
47474>>>>>>>>>>>
47474>>>>>>>>>>>Open Wapomast
47476>>>>>>>>>>>Open Wax
47478>>>>>>>>>>>Open Wapokat
47480>>>>>>>>>>>Open Sysrecw
47482>>>>>>>>>>>
47482>>>>>>>>>>>//DDB-HeaderEnd
47482>>>>>>>>>>>//DDB-SelectionStart
47482>>>>>>>>>>>//DDB/ ExternalSelectionList sl023  sl023.SL
47482>>>>>>>>>>>Register_Object sl023
47482>>>>>>>>>>>//DDB-SelectionEnd
47482>>>>>>>>>>>
47482>>>>>>>>>>>Class Wapomast_DataDictionary  is a DataDictionary
47483>>>>>>>>>>>    // Update:
47483>>>>>>>>>>>    Procedure Update
47484>>>>>>>>>>>        Forward Send Update
47486>>>>>>>>>>>        // Insert Code Here
47486>>>>>>>>>>>//        Move SysCurXR.Company_Code   to Wapomast.Company_Code
47486>>>>>>>>>>>//        Move SysCurXR.Branch_Code     to Wapomast.Branch_Code
47486>>>>>>>>>>>//        Move SysCurXR.Year_Year         to Wapomast.Year_Year
47486>>>>>>>>>>>        Move Wapokat.Wapokat_Code   to Wapomast.Wapokat_Code
47487>>>>>>>>>>>    End_Procedure   // Update
47488>>>>>>>>>>> 
47488>>>>>>>>>>>     Procedure Creating
47489>>>>>>>>>>>        Forward Send Creating
47491>>>>>>>>>>>        // Insert Code Here
47491>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wapomast.Wapomast_Rec0)))))) to Wapomast.Wapomast_Recr
47492>>>>>>>>>>>    End_Procedure   // Creating
47493>>>>>>>>>>>
47493>>>>>>>>>>>
47493>>>>>>>>>>>    // Define_Fields:
47493>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
47493>>>>>>>>>>>
47493>>>>>>>>>>>    Procedure Define_Fields
47494>>>>>>>>>>>        Forward Send Define_Fields
47496>>>>>>>>>>>        //DDB-Generated-Code-Location
47496>>>>>>>>>>>        //DDB-DefineFieldStart
47496>>>>>>>>>>>
47496>>>>>>>>>>>        Set Main_File            To Wapomast.File_Number
47497>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
47498>>>>>>>>>>>
47498>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
47499>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
47500>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
47501>>>>>>>>>>>
47501>>>>>>>>>>>        // Child (Client) file structure................
47501>>>>>>>>>>>        Send Add_Client_File  Wax.File_Number
47502>>>>>>>>>>>
47502>>>>>>>>>>>        // Parent (Server) file structure...............
47502>>>>>>>>>>>        Send Add_Server_File  Wapokat.File_Number
47503>>>>>>>>>>>
47503>>>>>>>>>>>        // External (System) file structure.............
47503>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
47504>>>>>>>>>>>
47504>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Wapomast_Rec0  To Wapomast.Wapomast_Rec0
47507>>>>>>>>>>>
47507>>>>>>>>>>>        // Field-based properties.......................
47507>>>>>>>>>>>
47507>>>>>>>>>>>        // Wapomast.Wapokat_Code
47507>>>>>>>>>>>
47507>>>>>>>>>>>        // Wapomast.Wapokat_Recr
47507>>>>>>>>>>>
47507>>>>>>>>>>>        // Wapomast.Wapomast_Code
47507>>>>>>>>>>>        Set Field_Options          Field Wapomast.Wapomast_Code To DD_AUTOFIND   
47508>>>>>>>>>>>        Set Field_Prompt_Object    Field Wapomast.Wapomast_Code To (sl023(Self))
47509>>>>>>>>>>>
47509>>>>>>>>>>>        // Wapomast.Wapomast_Rec0
47509>>>>>>>>>>>        Set Field_Options          Field Wapomast.Wapomast_Rec0 To DD_AUTOFIND   
47510>>>>>>>>>>>
47510>>>>>>>>>>>        // Wapomast.Wapomast_Descr
47510>>>>>>>>>>>        Set Field_Prompt_Object    Field Wapomast.Wapomast_Descr To (sl023(Self))
47511>>>>>>>>>>>
47511>>>>>>>>>>>        // Wapomast.Wapomast_Recr
47511>>>>>>>>>>>        Set Field_Options          Field Wapomast.Wapomast_Recr To DD_AUTOFIND   
47512>>>>>>>>>>>
47512>>>>>>>>>>>        //DDB-DefineFieldEnd
47512>>>>>>>>>>>    End_Procedure    // Define_Fields
47513>>>>>>>>>>>
47513>>>>>>>>>>>    // Field_Defaults:
47513>>>>>>>>>>>    // This procedure is used to establish default field values.
47513>>>>>>>>>>>
47513>>>>>>>>>>>    Procedure Field_Defaults
47514>>>>>>>>>>>        Forward Send Field_Defaults
47516>>>>>>>>>>>        //DDB-Generated-Code-Location
47516>>>>>>>>>>>        //DDB-FieldDefaultStart
47516>>>>>>>>>>>        //DDB-FieldDefaultEnd
47516>>>>>>>>>>>    End_Procedure    // Field_Defaults
47517>>>>>>>>>>>
47517>>>>>>>>>>>End_Class    // Wapomast_DataDictionary
47518>>>>>>>>>>>//DDB-Selection-pkg-Start
47518>>>>>>>>>>>
47518>>>>>>>>>>>Use sl023.SL         // sl023
INCLUDING FILE: SL023.SL
47518>>>>>>>>>>>>>//AB/ Project sl023:apothkes
47518>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
47518>>>>>>>>>>>>>//AB/     Set ProjectName to "sl023:apothkes"
47518>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl023.SL"
47518>>>>>>>>>>>>>
47518>>>>>>>>>>>>>// Project Object Structure
47518>>>>>>>>>>>>>//   sl023 is a dbModalPanelSub
47518>>>>>>>>>>>>>//     Wapokat_DD is a DataDictionary
47518>>>>>>>>>>>>>//     Wapomast_DD is a DataDictionary
47518>>>>>>>>>>>>>//     oSelList is a dbListSub
47518>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
47518>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
47518>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
47518>>>>>>>>>>>>>
47518>>>>>>>>>>>>>// Register all objects
47518>>>>>>>>>>>>>Register_Object oCancel_bn
47518>>>>>>>>>>>>>Register_Object oOK_bn
47518>>>>>>>>>>>>>Register_Object oSearch_bn
47518>>>>>>>>>>>>>Register_Object oSelList
47518>>>>>>>>>>>>>Register_Object sl023
47518>>>>>>>>>>>>>Register_Object Wapokat_DD
47518>>>>>>>>>>>>>Register_Object Wapomast_DD
47518>>>>>>>>>>>>>
47518>>>>>>>>>>>>>
47518>>>>>>>>>>>>>//AB-IgnoreStart
47518>>>>>>>>>>>>>
47518>>>>>>>>>>>>>Use DFAllEnt.pkg
47518>>>>>>>>>>>>>Use dbList.Sub
47518>>>>>>>>>>>>>Use Button.Sub
47518>>>>>>>>>>>>>
47518>>>>>>>>>>>>>
47518>>>>>>>>>>>>>Use WAPOKAT.DD
47518>>>>>>>>>>>>>Use WAPOMAST.DD
47518>>>>>>>>>>>>>
47518>>>>>>>>>>>>>//AB-IgnoreEnd
47518>>>>>>>>>>>>>
47518>>>>>>>>>>>>>Object sl023 is a dbModalPanelSub
47520>>>>>>>>>>>>>
47520>>>>>>>>>>>>>    //AB-StoreTopStart
47520>>>>>>>>>>>>>    property string psapokat public ''
47522>>>>>>>>>>>>>    //AB-StoreTopEnd
47522>>>>>>>>>>>>>
47522>>>>>>>>>>>>>    Set Label to "€§¦Ÿã¡œª"
47523>>>>>>>>>>>>>    Set Size to 126 260
47524>>>>>>>>>>>>>    Set Location to 4 19
47525>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
47526>>>>>>>>>>>>>    Set Modal_State to FALSE
47527>>>>>>>>>>>>>
47527>>>>>>>>>>>>>    //AB-DDOStart
47527>>>>>>>>>>>>>
47527>>>>>>>>>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
47529>>>>>>>>>>>>>    End_Object    // Wapokat_DD
47530>>>>>>>>>>>>>
47530>>>>>>>>>>>>>    Object Wapomast_DD is a Wapomast_DataDictionary
47532>>>>>>>>>>>>>        Set DDO_Server to (Wapokat_DD(self))
47533>>>>>>>>>>>>>
47533>>>>>>>>>>>>>        //AB-StoreStart
47533>>>>>>>>>>>>>        
47533>>>>>>>>>>>>>        begin_constraints
47535>>>>>>>>>>>>>          if (psapokat(self) <> '') constrain wapomast.wapokat_code eq (psapokat(self))
47539>>>>>>>>>>>>>        
47539>>>>>>>>>>>>>        end_constraints
47542>>>>>>>>>>>>>        
47542>>>>>>>>>>>>>        //AB-StoreEnd
47542>>>>>>>>>>>>>
47542>>>>>>>>>>>>>    End_Object    // Wapomast_DD
47543>>>>>>>>>>>>>
47543>>>>>>>>>>>>>    Set Main_DD to (Wapomast_DD(self))
47544>>>>>>>>>>>>>    Set Server to (Wapomast_DD(self))
47545>>>>>>>>>>>>>
47545>>>>>>>>>>>>>    //AB-DDOEnd
47545>>>>>>>>>>>>>
47545>>>>>>>>>>>>>    Object oSelList is a dbListSub
47547>>>>>>>>>>>>>        Set Main_File to Wapomast.File_Number
47548>>>>>>>>>>>>>        Set Server to (Wapokat_DD(self))
47549>>>>>>>>>>>>>        Set Size to 89 240
47550>>>>>>>>>>>>>        Set Location to 6 6
47551>>>>>>>>>>>>>
47551>>>>>>>>>>>>>        Begin_Row
47554>>>>>>>>>>>>>            Entry_Item Wapomast.Wapomast_code
47555>>>>>>>>>>>>>            Entry_Item Wapomast.Wapomast_descr
47556>>>>>>>>>>>>>        End_Row
47561>>>>>>>>>>>>>
47561>>>>>>>>>>>>>        Set Form_Width    item 0 to 70
47562>>>>>>>>>>>>>        Set Header_Label  item 0 to "€§¦Ÿã¡ž      :"
47563>>>>>>>>>>>>>        
47563>>>>>>>>>>>>>        Set Form_Width    item 1 to 160
47564>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
47565>>>>>>>>>>>>>        
47565>>>>>>>>>>>>>
47565>>>>>>>>>>>>>        //AB-StoreStart
47565>>>>>>>>>>>>>                    
47565>>>>>>>>>>>>>                    
47565>>>>>>>>>>>>>        //AB-StoreEnd
47565>>>>>>>>>>>>>
47565>>>>>>>>>>>>>    End_Object    // oSelList
47566>>>>>>>>>>>>>
47566>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
47568>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
47569>>>>>>>>>>>>>        Set Location to 92 81
47570>>>>>>>>>>>>>
47570>>>>>>>>>>>>>        //AB-StoreStart
47570>>>>>>>>>>>>>        Procedure OnClick
47572>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
47573>>>>>>>>>>>>>        End_Procedure
47574>>>>>>>>>>>>>        //AB-StoreEnd
47574>>>>>>>>>>>>>
47574>>>>>>>>>>>>>    End_Object    // oOK_bn
47575>>>>>>>>>>>>>
47575>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
47577>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
47578>>>>>>>>>>>>>        Set Location to 92 135
47579>>>>>>>>>>>>>
47579>>>>>>>>>>>>>        //AB-StoreStart
47579>>>>>>>>>>>>>        Procedure OnClick
47581>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
47582>>>>>>>>>>>>>        End_Procedure
47583>>>>>>>>>>>>>        //AB-StoreEnd
47583>>>>>>>>>>>>>
47583>>>>>>>>>>>>>    End_Object    // oCancel_bn
47584>>>>>>>>>>>>>
47584>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
47586>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
47587>>>>>>>>>>>>>        Set Location to 92 191
47588>>>>>>>>>>>>>
47588>>>>>>>>>>>>>        //AB-StoreStart
47588>>>>>>>>>>>>>        Procedure OnClick
47590>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
47591>>>>>>>>>>>>>        End_Procedure
47592>>>>>>>>>>>>>        //AB-StoreEnd
47592>>>>>>>>>>>>>
47592>>>>>>>>>>>>>    End_Object    // oSearch_bn
47593>>>>>>>>>>>>>
47593>>>>>>>>>>>>>
47593>>>>>>>>>>>>>    //AB-StoreStart
47593>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
47594>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
47595>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
47596>>>>>>>>>>>>>    
47596>>>>>>>>>>>>>    procedure activate
47598>>>>>>>>>>>>>        send rebuild_constraints to wapomast_dd
47599>>>>>>>>>>>>>        send beginning_of_data to osellist true
47600>>>>>>>>>>>>>        forward send activate
47602>>>>>>>>>>>>>    end_procedure
47603>>>>>>>>>>>>>    
47603>>>>>>>>>>>>>    
47603>>>>>>>>>>>>>    //AB-StoreEnd
47603>>>>>>>>>>>>>
47603>>>>>>>>>>>>>End_Object    // sl023
47604>>>>>>>>>>>>>
47604>>>>>>>>>>>>>//AB/ End_Object    // prj
47604>>>>>>>>>>>
47604>>>>>>>>>>>//DDB-Selection-pkg-End
47604>>>>>>>>>>>//DDB-FileEnd
47604>>>>>>>>>    Use WAX.DD
INCLUDING FILE: WAX.DD
47604>>>>>>>>>>>//DDB-FileStart
47604>>>>>>>>>>>//DDB-HeaderStart
47604>>>>>>>>>>>
47604>>>>>>>>>>>// File Name : WAX.DD
47604>>>>>>>>>>>// Class Name: Wax_DataDictionary
47604>>>>>>>>>>>// Revision  : 39
47604>>>>>>>>>>>// Version   : 2
47604>>>>>>>>>>>
47604>>>>>>>>>>>Use  Windows           // Basic Definitions
47604>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
47604>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
47604>>>>>>>>>>>
47604>>>>>>>>>>>Open Wax
47606>>>>>>>>>>>Open Pmoves
47608>>>>>>>>>>>Open Wcmoves
47610>>>>>>>>>>>Open Wam
INCLUDING FILE: WAM.FD
47612>>>>>>>>>>>Open Pmovesl
47614>>>>>>>>>>>Open Wapomast
47616>>>>>>>>>>>Open Sysrecw
47618>>>>>>>>>>>Open Syscurxr
47620>>>>>>>>>>>
47620>>>>>>>>>>>//DDB-HeaderEnd
47620>>>>>>>>>>>//DDB-SelectionStart
47620>>>>>>>>>>>//DDB/ ExternalSelectionList Wax  Wax.SL
47620>>>>>>>>>>>Register_Object Wax
47620>>>>>>>>>>>//DDB-SelectionEnd
47620>>>>>>>>>>>
47620>>>>>>>>>>>Open Units
INCLUDING FILE: UNITS.FD
47622>>>>>>>>>>>Open Wapokat
47624>>>>>>>>>>>Open WitemKat
INCLUDING FILE: WITEMKAT.FD
47626>>>>>>>>>>>
47626>>>>>>>>>>>Class Wax_DataDictionary  is a DataDictionary_Sec
47627>>>>>>>>>>>
47627>>>>>>>>>>>    Procedure Construct_Object
47628>>>>>>>>>>>        Forward Send Construct_Object
47630>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
47631>>>>>>>>>>>    End_Procedure //construct_object
47632>>>>>>>>>>>
47632>>>>>>>>>>>    Procedure OnConstrain
47633>>>>>>>>>>>        Forward Send OnConstrain
47635>>>>>>>>>>>        If (piMustNOTConstrain(Self)) Begin
47637>>>>>>>>>>>        End
47637>>>>>>>>>>>>
47637>>>>>>>>>>>        Else Begin
47638>>>>>>>>>>>            Constrain Wax.Company_Code  eq SysCurXR.Company_Code
47640>>>>>>>>>>>            Constrain Wax.Branch_Code   eq SysCurXR.Branch_Code
47642>>>>>>>>>>>            Constrain Wax.Year_Year     eq SysCurXR.Year_Year
47644>>>>>>>>>>>        End
47644>>>>>>>>>>>>
47644>>>>>>>>>>>    End_Procedure
47645>>>>>>>>>>>
47645>>>>>>>>>>>
47645>>>>>>>>>>>    // Update:
47645>>>>>>>>>>>    Procedure Update
47646>>>>>>>>>>>        Forward Send Update
47648>>>>>>>>>>>        // Insert Code Here
47648>>>>>>>>>>>        Move SysCurXR.Company_Code  to Wax.Company_Code
47649>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Wax.Branch_Code
47650>>>>>>>>>>>        Move SysCurXR.Year_Year     to Wax.Year_Year
47651>>>>>>>>>>>        Move SysCurXR.Year_Recr     to Wax.Year_Recr
47652>>>>>>>>>>>        Move Wapokat.Wapokat_Code   to Wax.Wapokat_Code
47653>>>>>>>>>>>        Move Wapomast.Wapomast_Code to Wax.Wapomast_Code
47654>>>>>>>>>>>    End_Procedure   // Update
47655>>>>>>>>>>>
47655>>>>>>>>>>>     Procedure Creating
47656>>>>>>>>>>>        Forward Send Creating
47658>>>>>>>>>>>        // Insert Code Here
47658>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wax.Wax_Rec0)))))) to Wax.Wax_Recr
47659>>>>>>>>>>>    End_Procedure   // Creating
47660>>>>>>>>>>>
47660>>>>>>>>>>>
47660>>>>>>>>>>>
47660>>>>>>>>>>>    // Define_Fields:
47660>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
47660>>>>>>>>>>>
47660>>>>>>>>>>>    Procedure Define_Fields
47661>>>>>>>>>>>        Forward Send Define_Fields
47663>>>>>>>>>>>        //DDB-Generated-Code-Location
47663>>>>>>>>>>>        //DDB-DefineFieldStart
47663>>>>>>>>>>>
47663>>>>>>>>>>>        Set Main_File            To Wax.File_Number
47664>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
47665>>>>>>>>>>>
47665>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
47666>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
47667>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
47668>>>>>>>>>>>
47668>>>>>>>>>>>        // Child (Client) file structure................
47668>>>>>>>>>>>        Send Add_Client_File  Pmoves.File_Number
47669>>>>>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
47670>>>>>>>>>>>        Send Add_Client_File  Wam.File_Number
47671>>>>>>>>>>>        Send Add_Client_File  Pmovesl.File_Number
47672>>>>>>>>>>>
47672>>>>>>>>>>>        // Parent (Server) file structure...............
47672>>>>>>>>>>>        Send Add_Server_File  Wapomast.File_Number
47673>>>>>>>>>>>
47673>>>>>>>>>>>        // External (System) file structure.............
47673>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
47674>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
47675>>>>>>>>>>>
47675>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Wax_Rec0  To Wax.Wax_Rec0
47678>>>>>>>>>>>
47678>>>>>>>>>>>        // Field-based properties.......................
47678>>>>>>>>>>>
47678>>>>>>>>>>>        // Wax.Company_Code
47678>>>>>>>>>>>
47678>>>>>>>>>>>        // Wax.Branch_Code
47678>>>>>>>>>>>
47678>>>>>>>>>>>        // Wax.Year_Year
47678>>>>>>>>>>>
47678>>>>>>>>>>>        // Wax.Wapokat_Code
47678>>>>>>>>>>>
47678>>>>>>>>>>>        // Wax.Wapomast_Code
47678>>>>>>>>>>>
47678>>>>>>>>>>>        // Wax.Wax_Code
47678>>>>>>>>>>>        Set Field_Options          Field Wax.Wax_Code To DD_AUTOFIND   
47679>>>>>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Code To (Wax(Self))
47680>>>>>>>>>>>
47680>>>>>>>>>>>        // Wax.Year_Recr
47680>>>>>>>>>>>
47680>>>>>>>>>>>        // Wax.Wapomast_Recr
47680>>>>>>>>>>>
47680>>>>>>>>>>>        // Wax.Wax_Rec0
47680>>>>>>>>>>>        Set Field_Options          Field Wax.Wax_Rec0 To DD_AUTOFIND   
47681>>>>>>>>>>>
47681>>>>>>>>>>>        // Wax.Wax_Recr
47681>>>>>>>>>>>        Set Field_Options          Field Wax.Wax_Recr To DD_AUTOFIND   
47682>>>>>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Recr To (Wax(Self))
47683>>>>>>>>>>>
47683>>>>>>>>>>>        // Wax.Wax_Descr
47683>>>>>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Descr To (Wax(Self))
47684>>>>>>>>>>>
47684>>>>>>>>>>>        //DDB-DefineFieldEnd
47684>>>>>>>>>>>    End_Procedure    // Define_Fields
47685>>>>>>>>>>>
47685>>>>>>>>>>>    // Field_Defaults:
47685>>>>>>>>>>>    // This procedure is used to establish default field values.
47685>>>>>>>>>>>
47685>>>>>>>>>>>    Procedure Field_Defaults
47686>>>>>>>>>>>        Forward Send Field_Defaults
47688>>>>>>>>>>>        //DDB-Generated-Code-Location
47688>>>>>>>>>>>        //DDB-FieldDefaultStart
47688>>>>>>>>>>>        //DDB-FieldDefaultEnd
47688>>>>>>>>>>>    End_Procedure    // Field_Defaults
47689>>>>>>>>>>>
47689>>>>>>>>>>>End_Class    // Wax_DataDictionary
47690>>>>>>>>>>>//DDB-Selection-pkg-Start
47690>>>>>>>>>>>
47690>>>>>>>>>>>Use Wax.SL           // Wax
INCLUDING FILE: WAX.SL
47690>>>>>>>>>>>>>//AB/ Project Wax:Lookup Apothikhs
47690>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
47690>>>>>>>>>>>>>//AB/     Set ProjectName to "Wax:Lookup Apothikhs"
47690>>>>>>>>>>>>>//AB/     Set ProjectFileName to "Wax.SL"
47690>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
47690>>>>>>>>>>>>>
47690>>>>>>>>>>>>>// Project Object Structure
47690>>>>>>>>>>>>>//   Wax is a dbModalPanelSub
47690>>>>>>>>>>>>>//     Wapokat_DD is a DataDictionary
47690>>>>>>>>>>>>>//     Wapomast_DD is a DataDictionary
47690>>>>>>>>>>>>>//     Wax_DD is a DataDictionary
47690>>>>>>>>>>>>>//     oSelList is a dbListSub
47690>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
47690>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
47690>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
47690>>>>>>>>>>>>>
47690>>>>>>>>>>>>>// Register all objects
47690>>>>>>>>>>>>>Register_Object oCancel_bn
47690>>>>>>>>>>>>>Register_Object oOK_bn
47690>>>>>>>>>>>>>Register_Object oSearch_bn
47690>>>>>>>>>>>>>Register_Object oSelList
47690>>>>>>>>>>>>>Register_Object Wapokat_DD
47690>>>>>>>>>>>>>Register_Object Wapomast_DD
47690>>>>>>>>>>>>>Register_Object Wax
47690>>>>>>>>>>>>>Register_Object Wax_DD
47690>>>>>>>>>>>>>
47690>>>>>>>>>>>>>
47690>>>>>>>>>>>>>//AB-IgnoreStart
47690>>>>>>>>>>>>>
47690>>>>>>>>>>>>>Use DFAllEnt.pkg
47690>>>>>>>>>>>>>Use dbList.Sub
47690>>>>>>>>>>>>>Use Button.Sub
47690>>>>>>>>>>>>>
47690>>>>>>>>>>>>>
47690>>>>>>>>>>>>>Use WAPOKAT.DD
47690>>>>>>>>>>>>>Use WAPOMAST.DD
47690>>>>>>>>>>>>>Use WAX.DD
47690>>>>>>>>>>>>>
47690>>>>>>>>>>>>>//AB-IgnoreEnd
47690>>>>>>>>>>>>>
47690>>>>>>>>>>>>>Object Wax is a dbModalPanelSub
47692>>>>>>>>>>>>>
47692>>>>>>>>>>>>>    //AB-StoreTopStart
47692>>>>>>>>>>>>>                                    
47692>>>>>>>>>>>>>    Property Integer    piMustConstrain Public  0
47694>>>>>>>>>>>>>    Property Integer    piYear          Public  0
47696>>>>>>>>>>>>>    Property String     psCompany       Public ''
47698>>>>>>>>>>>>>    Property String     psBranch        Public ''
47700>>>>>>>>>>>>>    Property String     psWapokat       Public ''
47702>>>>>>>>>>>>>    
47702>>>>>>>>>>>>>    //AB-StoreTopEnd
47702>>>>>>>>>>>>>
47702>>>>>>>>>>>>>    Set Label to "‰˜«á¢¦š¦ª €§¦Ÿž¡é¤"
47703>>>>>>>>>>>>>    Set Size to 148 355
47704>>>>>>>>>>>>>    Set Location to 8 21
47705>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
47706>>>>>>>>>>>>>    Set Modal_State to FALSE
47707>>>>>>>>>>>>>
47707>>>>>>>>>>>>>    //AB-DDOStart
47707>>>>>>>>>>>>>
47707>>>>>>>>>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
47709>>>>>>>>>>>>>    End_Object    // Wapokat_DD
47710>>>>>>>>>>>>>
47710>>>>>>>>>>>>>    Object Wapomast_DD is a Wapomast_DataDictionary
47712>>>>>>>>>>>>>        Set DDO_Server to (Wapokat_DD(self))
47713>>>>>>>>>>>>>    End_Object    // Wapomast_DD
47714>>>>>>>>>>>>>
47714>>>>>>>>>>>>>    Object Wax_DD is a Wax_DataDictionary
47716>>>>>>>>>>>>>        Set DDO_Server to (Wapomast_DD(self))
47717>>>>>>>>>>>>>
47717>>>>>>>>>>>>>        //AB-StoreStart
47717>>>>>>>>>>>>>        
47717>>>>>>>>>>>>>        Begin_Constraints
47719>>>>>>>>>>>>>            Integer iMustConstrain iYear
47720>>>>>>>>>>>>>            String  sCompany sBranch sWapokat
47720>>>>>>>>>>>>>            Get piMustConstrain to iMustConstrain
47721>>>>>>>>>>>>>            If (iMustConstrain) Begin
47723>>>>>>>>>>>>>                Get piYear     to  iYear
47724>>>>>>>>>>>>>                Get psCompany  to  sCompany
47725>>>>>>>>>>>>>                Get psBranch   to  sBranch
47726>>>>>>>>>>>>>                Get psWapokat  to  sWapokat
47727>>>>>>>>>>>>>                If (sCompany<>'') Begin
47729>>>>>>>>>>>>>                    Constrain Wax.Company_Code eq sCompany
47731>>>>>>>>>>>>>                    If (sBranch<>'') Begin
47733>>>>>>>>>>>>>                        Constrain Wax.Branch_Code eq sBranch
47735>>>>>>>>>>>>>                        If (iYear<>0) Begin
47737>>>>>>>>>>>>>                            Constrain Wax.Year_Year eq iYear
47739>>>>>>>>>>>>>                            If (sWapokat<>'') Begin
47741>>>>>>>>>>>>>                                Constrain Wax.Wapokat_Code eq sWapokat
47743>>>>>>>>>>>>>                            End
47743>>>>>>>>>>>>>>
47743>>>>>>>>>>>>>                        End
47743>>>>>>>>>>>>>>
47743>>>>>>>>>>>>>                    End
47743>>>>>>>>>>>>>>
47743>>>>>>>>>>>>>                End
47743>>>>>>>>>>>>>>
47743>>>>>>>>>>>>>            End
47743>>>>>>>>>>>>>>
47743>>>>>>>>>>>>>        End_Constraints
47746>>>>>>>>>>>>>        
47746>>>>>>>>>>>>>        
47746>>>>>>>>>>>>>        
47746>>>>>>>>>>>>>        
47746>>>>>>>>>>>>>        
47746>>>>>>>>>>>>>        
47746>>>>>>>>>>>>>        //AB-StoreEnd
47746>>>>>>>>>>>>>
47746>>>>>>>>>>>>>    End_Object    // Wax_DD
47747>>>>>>>>>>>>>
47747>>>>>>>>>>>>>    Set Main_DD to (Wax_DD(self))
47748>>>>>>>>>>>>>    Set Server to (Wax_DD(self))
47749>>>>>>>>>>>>>
47749>>>>>>>>>>>>>    //AB-DDOEnd
47749>>>>>>>>>>>>>
47749>>>>>>>>>>>>>    Object oSelList is a dbListSub
47751>>>>>>>>>>>>>        Set Main_File to Wax.File_Number
47752>>>>>>>>>>>>>        Set Size to 105 340
47753>>>>>>>>>>>>>        Set Location to 5 6
47754>>>>>>>>>>>>>
47754>>>>>>>>>>>>>        Begin_Row
47757>>>>>>>>>>>>>            Entry_Item Wax.Wax_recr
47758>>>>>>>>>>>>>            Entry_Item Wax.Wax_code
47759>>>>>>>>>>>>>            Entry_Item Wax.Wax_descr
47760>>>>>>>>>>>>>        End_Row
47765>>>>>>>>>>>>>
47765>>>>>>>>>>>>>        Set Form_Width    item 0 to 33
47766>>>>>>>>>>>>>        Set Header_Label  item 0 to "Recr"
47767>>>>>>>>>>>>>        
47767>>>>>>>>>>>>>        Set Form_Width    item 1 to 80
47768>>>>>>>>>>>>>        Set Header_Label  item 1 to "‰à› ¡æª"
47769>>>>>>>>>>>>>        
47769>>>>>>>>>>>>>        Set Form_Width    item 2 to 219
47770>>>>>>>>>>>>>        Set Header_Label  item 2 to "œ¨ š¨˜­ã"
47771>>>>>>>>>>>>>        
47771>>>>>>>>>>>>>
47771>>>>>>>>>>>>>        //AB-StoreStart
47771>>>>>>>>>>>>>        
47771>>>>>>>>>>>>>        Procedure Activate
47773>>>>>>>>>>>>>            Send Rebuild_Constraints to Wax_DD
47774>>>>>>>>>>>>>            Send Beginning_Of_Data to oSelList True
47775>>>>>>>>>>>>>            Forward Send Activate
47777>>>>>>>>>>>>>        End_procedure
47778>>>>>>>>>>>>>        
47778>>>>>>>>>>>>>        //AB-StoreEnd
47778>>>>>>>>>>>>>
47778>>>>>>>>>>>>>    End_Object    // oSelList
47779>>>>>>>>>>>>>
47779>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
47781>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
47782>>>>>>>>>>>>>        Set Location to 113 186
47783>>>>>>>>>>>>>
47783>>>>>>>>>>>>>        //AB-StoreStart
47783>>>>>>>>>>>>>        Procedure OnClick
47785>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
47786>>>>>>>>>>>>>        End_Procedure
47787>>>>>>>>>>>>>        //AB-StoreEnd
47787>>>>>>>>>>>>>
47787>>>>>>>>>>>>>    End_Object    // oOK_bn
47788>>>>>>>>>>>>>
47788>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
47790>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
47791>>>>>>>>>>>>>        Set Location to 113 241
47792>>>>>>>>>>>>>
47792>>>>>>>>>>>>>        //AB-StoreStart
47792>>>>>>>>>>>>>        Procedure OnClick
47794>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
47795>>>>>>>>>>>>>        End_Procedure
47796>>>>>>>>>>>>>        //AB-StoreEnd
47796>>>>>>>>>>>>>
47796>>>>>>>>>>>>>    End_Object    // oCancel_bn
47797>>>>>>>>>>>>>
47797>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
47799>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
47800>>>>>>>>>>>>>        Set Location to 113 296
47801>>>>>>>>>>>>>
47801>>>>>>>>>>>>>        //AB-StoreStart
47801>>>>>>>>>>>>>        Procedure OnClick
47803>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
47804>>>>>>>>>>>>>        End_Procedure
47805>>>>>>>>>>>>>        //AB-StoreEnd
47805>>>>>>>>>>>>>
47805>>>>>>>>>>>>>    End_Object    // oSearch_bn
47806>>>>>>>>>>>>>
47806>>>>>>>>>>>>>
47806>>>>>>>>>>>>>    //AB-StoreStart
47806>>>>>>>>>>>>>                                    
47806>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
47807>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
47808>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
47809>>>>>>>>>>>>>    
47809>>>>>>>>>>>>>    
47809>>>>>>>>>>>>>    
47809>>>>>>>>>>>>>    
47809>>>>>>>>>>>>>    
47809>>>>>>>>>>>>>    
47809>>>>>>>>>>>>>    //AB-StoreEnd
47809>>>>>>>>>>>>>
47809>>>>>>>>>>>>>End_Object    // Wax
47810>>>>>>>>>>>>>
47810>>>>>>>>>>>>>//AB/ End_Object    // prj
47810>>>>>>>>>>>
47810>>>>>>>>>>>//DDB-Selection-pkg-End
47810>>>>>>>>>>>//DDB-FileEnd
47810>>>>>>>>>    Use UNITS.DD
INCLUDING FILE: UNITS.DD
47810>>>>>>>>>>>//DDB-FileStart
47810>>>>>>>>>>>//DDB-HeaderStart
47810>>>>>>>>>>>
47810>>>>>>>>>>>// File Name : UNITS.DD
47810>>>>>>>>>>>// Class Name: Units_DataDictionary
47810>>>>>>>>>>>// Revision  : 17
47810>>>>>>>>>>>// Version   : 2
47810>>>>>>>>>>>
47810>>>>>>>>>>>Use  Windows           // Basic Definitions
47810>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
47810>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
47810>>>>>>>>>>>
47810>>>>>>>>>>>Open Units
47812>>>>>>>>>>>Open Item
INCLUDING FILE: ITEM.FD
47814>>>>>>>>>>>Open Sysrecw
47816>>>>>>>>>>>Open Syscurxr
47818>>>>>>>>>>>
47818>>>>>>>>>>>//DDB-HeaderEnd
47818>>>>>>>>>>>//DDB-SelectionStart
47818>>>>>>>>>>>//DDB/ ExternalSelectionList sl025  sl025.SL
47818>>>>>>>>>>>Register_Object sl025
47818>>>>>>>>>>>//DDB-SelectionEnd
47818>>>>>>>>>>>
47818>>>>>>>>>>>Class Units_DataDictionary  is a DataDictionary
47819>>>>>>>>>>>
47819>>>>>>>>>>>    Procedure Save_Main_File
47820>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
47822>>>>>>>>>>>            If Units.Recnum Eq 0 Procedure_Return
47825>>>>>>>>>>>        End
47825>>>>>>>>>>>>
47825>>>>>>>>>>>        Forward Send Save_Main_File
47827>>>>>>>>>>>    End_Procedure
47828>>>>>>>>>>>
47828>>>>>>>>>>>
47828>>>>>>>>>>>     Procedure Creating
47829>>>>>>>>>>>        Forward Send Creating
47831>>>>>>>>>>>        // Insert Code Here
47831>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Units.Units_Rec0)))))) to Units.Units_Recr
47832>>>>>>>>>>>    End_Procedure   // Creating
47833>>>>>>>>>>>
47833>>>>>>>>>>>
47833>>>>>>>>>>>
47833>>>>>>>>>>>    // Define_Fields:
47833>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
47833>>>>>>>>>>>
47833>>>>>>>>>>>    Procedure Define_Fields
47834>>>>>>>>>>>        Forward Send Define_Fields
47836>>>>>>>>>>>        //DDB-Generated-Code-Location
47836>>>>>>>>>>>        //DDB-DefineFieldStart
47836>>>>>>>>>>>
47836>>>>>>>>>>>        Set Main_File            To Units.File_Number
47837>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
47838>>>>>>>>>>>
47838>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
47839>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
47840>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
47841>>>>>>>>>>>
47841>>>>>>>>>>>        // Child (Client) file structure................
47841>>>>>>>>>>>        Send Add_Client_File  Item.File_Number
47842>>>>>>>>>>>
47842>>>>>>>>>>>        // External (System) file structure.............
47842>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
47843>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
47844>>>>>>>>>>>
47844>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Units_Rec0  To Units.Units_Rec0
47847>>>>>>>>>>>
47847>>>>>>>>>>>        // Field-based properties.......................
47847>>>>>>>>>>>
47847>>>>>>>>>>>        // Units.Units_Code
47847>>>>>>>>>>>        Set Field_Options          Field Units.Units_Code To DD_AUTOFIND   
47848>>>>>>>>>>>        Set Field_Prompt_Object    Field Units.Units_Code To (sl025(Self))
47849>>>>>>>>>>>
47849>>>>>>>>>>>        // Units.Units_Rec0
47849>>>>>>>>>>>        Set Field_Options          Field Units.Units_Rec0 To DD_AUTOFIND   
47850>>>>>>>>>>>
47850>>>>>>>>>>>        // Units.Units_Descr
47850>>>>>>>>>>>        Set Field_Prompt_Object    Field Units.Units_Descr To (sl025(Self))
47851>>>>>>>>>>>
47851>>>>>>>>>>>        // Units.Units_Recr
47851>>>>>>>>>>>        Set Field_Options          Field Units.Units_Recr To DD_AUTOFIND   
47852>>>>>>>>>>>
47852>>>>>>>>>>>        //DDB-DefineFieldEnd
47852>>>>>>>>>>>    End_Procedure    // Define_Fields
47853>>>>>>>>>>>
47853>>>>>>>>>>>    // Field_Defaults:
47853>>>>>>>>>>>    // This procedure is used to establish default field values.
47853>>>>>>>>>>>
47853>>>>>>>>>>>    Procedure Field_Defaults
47854>>>>>>>>>>>        Forward Send Field_Defaults
47856>>>>>>>>>>>        //DDB-Generated-Code-Location
47856>>>>>>>>>>>        //DDB-FieldDefaultStart
47856>>>>>>>>>>>        //DDB-FieldDefaultEnd
47856>>>>>>>>>>>    End_Procedure    // Field_Defaults
47857>>>>>>>>>>>
47857>>>>>>>>>>>End_Class    // Units_DataDictionary
47858>>>>>>>>>>>//DDB-Selection-pkg-Start
47858>>>>>>>>>>>
47858>>>>>>>>>>>Use sl025.SL         // sl025
INCLUDING FILE: SL025.SL
47858>>>>>>>>>>>>>//AB/ Project sl025
47858>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
47858>>>>>>>>>>>>>//AB/     Set ProjectName to "sl025"
47858>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl025.SL"
47858>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
47858>>>>>>>>>>>>>
47858>>>>>>>>>>>>>// Project Object Structure
47858>>>>>>>>>>>>>//   sl025 is a dbModalPanelSub
47858>>>>>>>>>>>>>//     Units_DD is a DataDictionary
47858>>>>>>>>>>>>>//     oSelList is a dbListSub
47858>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
47858>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
47858>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
47858>>>>>>>>>>>>>
47858>>>>>>>>>>>>>// Register all objects
47858>>>>>>>>>>>>>Register_Object oCancel_bn
47858>>>>>>>>>>>>>Register_Object oOK_bn
47858>>>>>>>>>>>>>Register_Object oSearch_bn
47858>>>>>>>>>>>>>Register_Object oSelList
47858>>>>>>>>>>>>>Register_Object sl025
47858>>>>>>>>>>>>>Register_Object Units_DD
47858>>>>>>>>>>>>>
47858>>>>>>>>>>>>>
47858>>>>>>>>>>>>>//AB-IgnoreStart
47858>>>>>>>>>>>>>
47858>>>>>>>>>>>>>Use DFAllEnt.pkg
47858>>>>>>>>>>>>>Use dbList.Sub
47858>>>>>>>>>>>>>Use Button.Sub
47858>>>>>>>>>>>>>
47858>>>>>>>>>>>>>
47858>>>>>>>>>>>>>Use UNITS.DD
47858>>>>>>>>>>>>>
47858>>>>>>>>>>>>>//AB-IgnoreEnd
47858>>>>>>>>>>>>>
47858>>>>>>>>>>>>>Object sl025 is a dbModalPanelSub
47860>>>>>>>>>>>>>    set label to "‹¦¤á›œª ‹â«¨ž©žª" 
47861>>>>>>>>>>>>>    Set Size to 148 297
47862>>>>>>>>>>>>>    Set Location to 4 5
47863>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
47864>>>>>>>>>>>>>    Set Modal_State to FALSE
47865>>>>>>>>>>>>>
47865>>>>>>>>>>>>>    //AB-DDOStart
47865>>>>>>>>>>>>>
47865>>>>>>>>>>>>>    Object Units_DD is a Units_DataDictionary
47867>>>>>>>>>>>>>    End_Object    // Units_DD
47868>>>>>>>>>>>>>
47868>>>>>>>>>>>>>    Set Main_DD to (Units_DD(self))
47869>>>>>>>>>>>>>    Set Server to (Units_DD(self))
47870>>>>>>>>>>>>>
47870>>>>>>>>>>>>>    //AB-DDOEnd
47870>>>>>>>>>>>>>
47870>>>>>>>>>>>>>    Object oSelList is a dbListSub
47872>>>>>>>>>>>>>        set main_file to units.file_number 
47873>>>>>>>>>>>>>        Set Size to 105 280
47874>>>>>>>>>>>>>        Set Location to 6 6
47875>>>>>>>>>>>>>
47875>>>>>>>>>>>>>        Begin_Row
47878>>>>>>>>>>>>>            entry_item units.units_code 
47879>>>>>>>>>>>>>            entry_item units.units_descr 
47880>>>>>>>>>>>>>        End_Row
47885>>>>>>>>>>>>>
47885>>>>>>>>>>>>>        Set Form_Width    item 0 to 91
47886>>>>>>>>>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
47887>>>>>>>>>>>>>        
47887>>>>>>>>>>>>>        Set Form_Width    item 1 to 180
47888>>>>>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
47889>>>>>>>>>>>>>        
47889>>>>>>>>>>>>>    End_Object    // oSelList
47890>>>>>>>>>>>>>
47890>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
47892>>>>>>>>>>>>>        set label to "&„§ ¢¦šã" 
47893>>>>>>>>>>>>>        Set Location to 115 126
47894>>>>>>>>>>>>>
47894>>>>>>>>>>>>>        //AB-StoreStart
47894>>>>>>>>>>>>>        Procedure OnClick
47896>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
47897>>>>>>>>>>>>>        End_Procedure
47898>>>>>>>>>>>>>        //AB-StoreEnd
47898>>>>>>>>>>>>>
47898>>>>>>>>>>>>>    End_Object    // oOK_bn
47899>>>>>>>>>>>>>
47899>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
47901>>>>>>>>>>>>>        set label to "&€¡ç¨à©ž" 
47902>>>>>>>>>>>>>        Set Location to 115 181
47903>>>>>>>>>>>>>
47903>>>>>>>>>>>>>        //AB-StoreStart
47903>>>>>>>>>>>>>        Procedure OnClick
47905>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
47906>>>>>>>>>>>>>        End_Procedure
47907>>>>>>>>>>>>>        //AB-StoreEnd
47907>>>>>>>>>>>>>
47907>>>>>>>>>>>>>    End_Object    // oCancel_bn
47908>>>>>>>>>>>>>
47908>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
47910>>>>>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
47911>>>>>>>>>>>>>        Set Location to 115 236
47912>>>>>>>>>>>>>
47912>>>>>>>>>>>>>        //AB-StoreStart
47912>>>>>>>>>>>>>        Procedure OnClick
47914>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
47915>>>>>>>>>>>>>        End_Procedure
47916>>>>>>>>>>>>>        //AB-StoreEnd
47916>>>>>>>>>>>>>
47916>>>>>>>>>>>>>    End_Object    // oSearch_bn
47917>>>>>>>>>>>>>
47917>>>>>>>>>>>>>
47917>>>>>>>>>>>>>    //AB-StoreStart
47917>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
47918>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
47919>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
47920>>>>>>>>>>>>>    //AB-StoreEnd
47920>>>>>>>>>>>>>
47920>>>>>>>>>>>>>End_Object    // sl025
47921>>>>>>>>>>>>>
47921>>>>>>>>>>>>>//AB/ End_Object    // prj
47921>>>>>>>>>>>
47921>>>>>>>>>>>//DDB-Selection-pkg-End
47921>>>>>>>>>>>//DDB-FileEnd
47921>>>>>>>>>    Use WITEMKAT.DD
INCLUDING FILE: WITEMKAT.DD
47921>>>>>>>>>>>//DDB-FileStart
47921>>>>>>>>>>>//DDB-HeaderStart
47921>>>>>>>>>>>
47921>>>>>>>>>>>// File Name : WITEMKAT.DD
47921>>>>>>>>>>>// Class Name: Witemkat_DataDictionary
47921>>>>>>>>>>>// Revision  : 25
47921>>>>>>>>>>>// Version   : 2
47921>>>>>>>>>>>
47921>>>>>>>>>>>Use  Windows           // Basic Definitions
47921>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
47921>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
47921>>>>>>>>>>>
47921>>>>>>>>>>>Open Witemkat
47923>>>>>>>>>>>Open Item
47925>>>>>>>>>>>Open Sysrecw
47927>>>>>>>>>>>Open Syscurxr
47929>>>>>>>>>>>
47929>>>>>>>>>>>//DDB-HeaderEnd
47929>>>>>>>>>>>//DDB-SelectionStart
47929>>>>>>>>>>>//DDB/ ExternalSelectionList sl024  sl024.SL
47929>>>>>>>>>>>//DDB/ ExternalSelectionList sl150  sl150.SL
47929>>>>>>>>>>>Register_Object sl024
47929>>>>>>>>>>>Register_Object sl150
47929>>>>>>>>>>>//DDB-SelectionEnd
47929>>>>>>>>>>>
47929>>>>>>>>>>>Class Witemkat_DataDictionary  is a DataDictionary
47930>>>>>>>>>>>
47930>>>>>>>>>>>     Procedure Creating
47931>>>>>>>>>>>        Forward Send Creating
47933>>>>>>>>>>>        // Insert Code Here
47933>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(WitemKat.WitemKat_Rec0)))))) to WitemKat.WitemKat_Recr
47934>>>>>>>>>>>    End_Procedure   // Creating
47935>>>>>>>>>>>   
47935>>>>>>>>>>>    Function Validate_Save  Returns Integer
47936>>>>>>>>>>>        Local Integer iReturnVal icheck
47937>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
47939>>>>>>>>>>>        If (Not(iReturnVal)) Begin
47941>>>>>>>>>>>            // Insert Code Here
47941>>>>>>>>>>>//           if (witemkat.codegl <> '') begin
47941>>>>>>>>>>>//              Move (Check_log(witemkat.codegl)) to iCheck  
47941>>>>>>>>>>>//              if (icheck) Move 24001 to iReturnVal 
47941>>>>>>>>>>>//           end
47941>>>>>>>>>>>           If (iReturnVal) Send Operation_Not_Allowed iReturnVal
47944>>>>>>>>>>>        End
47944>>>>>>>>>>>>
47944>>>>>>>>>>>        Function_Return iReturnVal
47945>>>>>>>>>>>    End_Function   // Validate_Save
47946>>>>>>>>>>> 
47946>>>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
47947>>>>>>>>>>>        String lsError_Message
47948>>>>>>>>>>>        Case Begin
47948>>>>>>>>>>>            Case (iError_Num = 24001)
47950>>>>>>>>>>>                Move "DDC 24: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ¡˜«žš¦¨å˜ª œå›¦¬ª" to lsError_Message
47951>>>>>>>>>>>              Case Break
47952>>>>>>>>>>>            Case Else
47952>>>>>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
47954>>>>>>>>>>>        Case End
47954>>>>>>>>>>>        Error iError_Num lsError_Message
47955>>>>>>>>>>>>
47955>>>>>>>>>>>    End_Procedure // operation_not_allowed
47956>>>>>>>>>>>
47956>>>>>>>>>>>
47956>>>>>>>>>>>
47956>>>>>>>>>>>    // Define_Fields:
47956>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
47956>>>>>>>>>>>
47956>>>>>>>>>>>    Procedure Define_Fields
47957>>>>>>>>>>>        Forward Send Define_Fields
47959>>>>>>>>>>>        //DDB-Generated-Code-Location
47959>>>>>>>>>>>        //DDB-DefineFieldStart
47959>>>>>>>>>>>
47959>>>>>>>>>>>        Set Main_File            To Witemkat.File_Number
47960>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
47961>>>>>>>>>>>
47961>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
47962>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
47963>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
47964>>>>>>>>>>>
47964>>>>>>>>>>>        // Child (Client) file structure................
47964>>>>>>>>>>>        Send Add_Client_File  Item.File_Number
47965>>>>>>>>>>>
47965>>>>>>>>>>>        // External (System) file structure.............
47965>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
47966>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
47967>>>>>>>>>>>
47967>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Witemkat_Rec0  To Witemkat.Witemkat_Rec0
47970>>>>>>>>>>>
47970>>>>>>>>>>>        // Field-based properties.......................
47970>>>>>>>>>>>
47970>>>>>>>>>>>        // Witemkat.Witemkat_Code
47970>>>>>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Code To DD_AUTOFIND   
47971>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemkat.Witemkat_Code To (sl024(Self))
47972>>>>>>>>>>>
47972>>>>>>>>>>>        // Witemkat.Witemkat_Rec0
47972>>>>>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Rec0 To DD_AUTOFIND   
47973>>>>>>>>>>>
47973>>>>>>>>>>>        // Witemkat.Witemkat_Descr
47973>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemkat.Witemkat_Descr To (sl024(Self))
47974>>>>>>>>>>>
47974>>>>>>>>>>>        // Witemkat.Witemkat_Recr
47974>>>>>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Recr To DD_AUTOFIND   
47975>>>>>>>>>>>
47975>>>>>>>>>>>        // Witemkat.Codeglpol
47975>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemkat.Codeglpol To (sl150(Self))
47976>>>>>>>>>>>
47976>>>>>>>>>>>        // Witemkat.Codeglago
47976>>>>>>>>>>>
47976>>>>>>>>>>>        //DDB-DefineFieldEnd
47976>>>>>>>>>>>    End_Procedure    // Define_Fields
47977>>>>>>>>>>>
47977>>>>>>>>>>>    // Field_Defaults:
47977>>>>>>>>>>>    // This procedure is used to establish default field values.
47977>>>>>>>>>>>
47977>>>>>>>>>>>    Procedure Field_Defaults
47978>>>>>>>>>>>        Forward Send Field_Defaults
47980>>>>>>>>>>>        //DDB-Generated-Code-Location
47980>>>>>>>>>>>        //DDB-FieldDefaultStart
47980>>>>>>>>>>>        //DDB-FieldDefaultEnd
47980>>>>>>>>>>>    End_Procedure    // Field_Defaults
47981>>>>>>>>>>>
47981>>>>>>>>>>>End_Class    // Witemkat_DataDictionary
47982>>>>>>>>>>>//DDB-Selection-pkg-Start
47982>>>>>>>>>>>
47982>>>>>>>>>>>Use sl024.SL         // sl024
INCLUDING FILE: SL024.SL
47982>>>>>>>>>>>>>//AB/ Project sl024:kathgories eidon
47982>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
47982>>>>>>>>>>>>>//AB/     Set ProjectName to "sl024:kathgories eidon"
47982>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl024.SL"
47982>>>>>>>>>>>>>
47982>>>>>>>>>>>>>// Project Object Structure
47982>>>>>>>>>>>>>//   sl024 is a dbModalPanelSub
47982>>>>>>>>>>>>>//     Witemkat_DD is a DataDictionary
47982>>>>>>>>>>>>>//     oSelList is a dbListSub
47982>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
47982>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
47982>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
47982>>>>>>>>>>>>>
47982>>>>>>>>>>>>>// Register all objects
47982>>>>>>>>>>>>>Register_Object oCancel_bn
47982>>>>>>>>>>>>>Register_Object oOK_bn
47982>>>>>>>>>>>>>Register_Object oSearch_bn
47982>>>>>>>>>>>>>Register_Object oSelList
47982>>>>>>>>>>>>>Register_Object sl024
47982>>>>>>>>>>>>>Register_Object Witemkat_DD
47982>>>>>>>>>>>>>
47982>>>>>>>>>>>>>
47982>>>>>>>>>>>>>//AB-IgnoreStart
47982>>>>>>>>>>>>>
47982>>>>>>>>>>>>>Use DFAllEnt.pkg
47982>>>>>>>>>>>>>Use dbList.Sub
47982>>>>>>>>>>>>>Use Button.Sub
47982>>>>>>>>>>>>>
47982>>>>>>>>>>>>>
47982>>>>>>>>>>>>>Use WITEMKAT.DD
47982>>>>>>>>>>>>>
47982>>>>>>>>>>>>>//AB-IgnoreEnd
47982>>>>>>>>>>>>>
47982>>>>>>>>>>>>>Object sl024 is a dbModalPanelSub
47984>>>>>>>>>>>>>    Set Label to "‰˜«žš¦¨åœª „ ›é¤"
47985>>>>>>>>>>>>>    Set Size to 217 375
47986>>>>>>>>>>>>>    Set Location to 4 5
47987>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
47988>>>>>>>>>>>>>    Set Modal_State to FALSE
47989>>>>>>>>>>>>>
47989>>>>>>>>>>>>>    //AB-DDOStart
47989>>>>>>>>>>>>>
47989>>>>>>>>>>>>>    Object Witemkat_DD is a Witemkat_DataDictionary
47991>>>>>>>>>>>>>    End_Object    // Witemkat_DD
47992>>>>>>>>>>>>>
47992>>>>>>>>>>>>>    Set Main_DD to (Witemkat_DD(self))
47993>>>>>>>>>>>>>    Set Server to (Witemkat_DD(self))
47994>>>>>>>>>>>>>
47994>>>>>>>>>>>>>    //AB-DDOEnd
47994>>>>>>>>>>>>>
47994>>>>>>>>>>>>>    Object oSelList is a dbListSub
47996>>>>>>>>>>>>>        Set Main_File to Witemkat.File_Number
47997>>>>>>>>>>>>>        Set Size to 175 357
47998>>>>>>>>>>>>>        Set Location to 6 6
47999>>>>>>>>>>>>>
47999>>>>>>>>>>>>>        Begin_Row
48002>>>>>>>>>>>>>            Entry_Item Witemkat.Witemkat_code
48003>>>>>>>>>>>>>            Entry_Item Witemkat.Witemkat_descr
48004>>>>>>>>>>>>>        End_Row
48009>>>>>>>>>>>>>
48009>>>>>>>>>>>>>        Set Form_Width    item 0 to 124
48010>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
48011>>>>>>>>>>>>>        
48011>>>>>>>>>>>>>        Set Form_Width    item 1 to 223
48012>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
48013>>>>>>>>>>>>>        
48013>>>>>>>>>>>>>    End_Object    // oSelList
48014>>>>>>>>>>>>>
48014>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
48016>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
48017>>>>>>>>>>>>>        Set Location to 186 210
48018>>>>>>>>>>>>>
48018>>>>>>>>>>>>>        //AB-StoreStart
48018>>>>>>>>>>>>>        Procedure OnClick
48020>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
48021>>>>>>>>>>>>>        End_Procedure
48022>>>>>>>>>>>>>        //AB-StoreEnd
48022>>>>>>>>>>>>>
48022>>>>>>>>>>>>>    End_Object    // oOK_bn
48023>>>>>>>>>>>>>
48023>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
48025>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
48026>>>>>>>>>>>>>        Set Location to 186 265
48027>>>>>>>>>>>>>
48027>>>>>>>>>>>>>        //AB-StoreStart
48027>>>>>>>>>>>>>        Procedure OnClick
48029>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
48030>>>>>>>>>>>>>        End_Procedure
48031>>>>>>>>>>>>>        //AB-StoreEnd
48031>>>>>>>>>>>>>
48031>>>>>>>>>>>>>    End_Object    // oCancel_bn
48032>>>>>>>>>>>>>
48032>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
48034>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
48035>>>>>>>>>>>>>        Set Location to 186 320
48036>>>>>>>>>>>>>
48036>>>>>>>>>>>>>        //AB-StoreStart
48036>>>>>>>>>>>>>        Procedure OnClick
48038>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
48039>>>>>>>>>>>>>        End_Procedure
48040>>>>>>>>>>>>>        //AB-StoreEnd
48040>>>>>>>>>>>>>
48040>>>>>>>>>>>>>    End_Object    // oSearch_bn
48041>>>>>>>>>>>>>
48041>>>>>>>>>>>>>
48041>>>>>>>>>>>>>    //AB-StoreStart
48041>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
48042>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
48043>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
48044>>>>>>>>>>>>>    //AB-StoreEnd
48044>>>>>>>>>>>>>
48044>>>>>>>>>>>>>End_Object    // sl024
48045>>>>>>>>>>>>>
48045>>>>>>>>>>>>>//AB/ End_Object    // prj
48045>>>>>>>>>>>Use sl150.SL         // sl150
INCLUDING FILE: SL150.SL
48045>>>>>>>>>>>>>//AB/ Project sl150:GL Gplan
48045>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
48045>>>>>>>>>>>>>//AB/         Set ProjectName to "sl150:GL Gplan"
48045>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl150.SL"
48045>>>>>>>>>>>>>
48045>>>>>>>>>>>>>// Project Object Structure
48045>>>>>>>>>>>>>//   sl150 is a dbModalPanelSub
48045>>>>>>>>>>>>>//     Gplan_DD is a DataDictionary
48045>>>>>>>>>>>>>//     oSelList is a dbListSub
48045>>>>>>>>>>>>>//     oOK_bn is a Button
48045>>>>>>>>>>>>>//     oCancel_bn is a Button
48045>>>>>>>>>>>>>//     oSearch_bn is a Button
48045>>>>>>>>>>>>>
48045>>>>>>>>>>>>>// Register all objects
48045>>>>>>>>>>>>>Register_Object Gplan_DD
48045>>>>>>>>>>>>>Register_Object oCancel_bn
48045>>>>>>>>>>>>>Register_Object oOK_bn
48045>>>>>>>>>>>>>Register_Object oSearch_bn
48045>>>>>>>>>>>>>Register_Object oSelList
48045>>>>>>>>>>>>>Register_Object sl150
48045>>>>>>>>>>>>>
48045>>>>>>>>>>>>>
48045>>>>>>>>>>>>>    //AB-IgnoreStart
48045>>>>>>>>>>>>>
48045>>>>>>>>>>>>>    Use DFAllEnt.pkg
48045>>>>>>>>>>>>>    Use dbList.Sub
48045>>>>>>>>>>>>>
48045>>>>>>>>>>>>>
48045>>>>>>>>>>>>>    Use GPLAN.DD
INCLUDING FILE: GPLAN.DD
48045>>>>>>>>>>>>>>>//DDB-FileStart
48045>>>>>>>>>>>>>>>//DDB-HeaderStart
48045>>>>>>>>>>>>>>>
48045>>>>>>>>>>>>>>>// File Name : GPLAN.DD
48045>>>>>>>>>>>>>>>// Class Name: Gplan_DataDictionary
48045>>>>>>>>>>>>>>>// Revision  : 131
48045>>>>>>>>>>>>>>>// Version   : 2
48045>>>>>>>>>>>>>>>
48045>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
48045>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
48045>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48045>>>>>>>>>>>>>>>
48045>>>>>>>>>>>>>>>Open Gplan
48047>>>>>>>>>>>>>>>Open Gmovea
INCLUDING FILE: GMOVEA.FD
48049>>>>>>>>>>>>>>>Open Gplanmod
INCLUDING FILE: GPLANMOD.FD
48051>>>>>>>>>>>>>>>Open Gmhnes
INCLUDING FILE: GMHNES.FD
48053>>>>>>>>>>>>>>>Open Gmove
INCLUDING FILE: GMOVE.FD
48055>>>>>>>>>>>>>>>Open Gvatd
INCLUDING FILE: GVATD.FD
48057>>>>>>>>>>>>>>>Open Gpmoves
INCLUDING FILE: GPMOVES.FD
48059>>>>>>>>>>>>>>>Open Sysrecg
48061>>>>>>>>>>>>>>>Open Syscurgl
48063>>>>>>>>>>>>>>>
48063>>>>>>>>>>>>>>>//DDB-HeaderEnd
48063>>>>>>>>>>>>>>>//DDB-ValidationStart
48063>>>>>>>>>>>>>>>
48063>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_O_Code_VT
48063>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Yn_VT
48063>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Xpm_VT
48063>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Doy_VT
48063>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_J_Code_VT
48063>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_C_Code2_VT
48063>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_I_A_Code_VT2
48063>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Myf_Sum_VT
48063>>>>>>>>>>>>>>>
48063>>>>>>>>>>>>>>>Object Gplan_Gplan_O_Code_VT  is a CodeValidationTable
48065>>>>>>>>>>>>>>>    Set Type_Value        To "OMADA"
48066>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
48067>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
48067>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
48067>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_O_Code_VT
48068>>>>>>>>>>>>>>>
48068>>>>>>>>>>>>>>>Object Gplan_Gplan_Yn_VT  is a CodeValidationTable
48070>>>>>>>>>>>>>>>    Set Type_Value        To "YESNO"
48071>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
48071>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
48071>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Yn_VT
48072>>>>>>>>>>>>>>>
48072>>>>>>>>>>>>>>>Object Gplan_Gplan_Xpm_VT  is a DescriptionValidationTable
48074>>>>>>>>>>>>>>>
48074>>>>>>>>>>>>>>>    Procedure Fill_List
48076>>>>>>>>>>>>>>>        Forward Send Fill_List
48078>>>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "•¨œ¦ç£œ¤¦ª"
48079>>>>>>>>>>>>>>>        Send Add_Table_Value  "2"  " ©«¦ç£œ¤¦ª"
48080>>>>>>>>>>>>>>>        Send Add_Table_Value  "3"  "‹ ¡«æª"
48081>>>>>>>>>>>>>>>    End_Procedure    // Fill_List
48082>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
48082>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
48082>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Xpm_VT
48083>>>>>>>>>>>>>>>
48083>>>>>>>>>>>>>>>Object Gplan_Gplan_Doy_VT  is a CodeValidationTable
48085>>>>>>>>>>>>>>>    Set Type_Value        To "DOY"
48086>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
48087>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
48087>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
48087>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Doy_VT
48088>>>>>>>>>>>>>>>
48088>>>>>>>>>>>>>>>Object Gplan_Gplan_J_Code_VT  is a CodeValidationTable
48090>>>>>>>>>>>>>>>    Set Type_Value        To "JOB"
48091>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
48092>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
48092>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
48092>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_J_Code_VT
48093>>>>>>>>>>>>>>>
48093>>>>>>>>>>>>>>>Object Gplan_Gplan_C_Code2_VT  is a CodeValidationTable
48095>>>>>>>>>>>>>>>    Set Type_Value        To "CURRENCY"
48096>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
48097>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
48097>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
48097>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_C_Code2_VT
48098>>>>>>>>>>>>>>>
48098>>>>>>>>>>>>>>>Object Gplan_Gplan_I_A_Code_VT2  is a CodeValidationTable
48100>>>>>>>>>>>>>>>    Set Type_Value        To "AITIOL"
48101>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
48102>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
48102>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
48102>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_I_A_Code_VT2
48103>>>>>>>>>>>>>>>
48103>>>>>>>>>>>>>>>Object Gplan_Gplan_Myf_Sum_VT  is a CodeValidationTable
48105>>>>>>>>>>>>>>>    Set Type_Value        To "MYF"
48106>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
48106>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
48106>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Myf_Sum_VT
48107>>>>>>>>>>>>>>>//DDB-ValidationEnd
48107>>>>>>>>>>>>>>>//DDB-SelectionStart
48107>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl150  sl150.sl
48107>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList Gtypkin  Gtypkin.sl
48107>>>>>>>>>>>>>>>Register_Object sl150
48107>>>>>>>>>>>>>>>Register_Object Gtypkin
48107>>>>>>>>>>>>>>>//DDB-SelectionEnd
48107>>>>>>>>>>>>>>>Use arrays.Sub
48107>>>>>>>>>>>>>>>
48107>>>>>>>>>>>>>>>Use Gmovea.dd //®¨œ áœ«˜  ¦§à›ã§¦«œ, › æ«  œå¤˜  alias file ¡˜ 
INCLUDING FILE: GMOVEA.DD
48107>>>>>>>>>>>>>>>>>//DDB-FileStart
48107>>>>>>>>>>>>>>>>>//DDB-HeaderStart
48107>>>>>>>>>>>>>>>>>
48107>>>>>>>>>>>>>>>>>// File Name : GMOVEA.DD
48107>>>>>>>>>>>>>>>>>// Class Name: Gmovea_DataDictionary
48107>>>>>>>>>>>>>>>>>// Revision  : 17
48107>>>>>>>>>>>>>>>>>// Version   : 2
48107>>>>>>>>>>>>>>>>>
48107>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
48107>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
48107>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48107>>>>>>>>>>>>>>>>>
48107>>>>>>>>>>>>>>>>>Open Gmovea
48109>>>>>>>>>>>>>>>>>Open Gopen
INCLUDING FILE: GOPEN.FD
48111>>>>>>>>>>>>>>>>>Open Garticl
INCLUDING FILE: GARTICL.FD
48113>>>>>>>>>>>>>>>>>Open Gplan
48115>>>>>>>>>>>>>>>>>
48115>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
48115>>>>>>>>>>>>>>>>>
48115>>>>>>>>>>>>>>>>>//open master file
48115>>>>>>>>>>>>>>>>>Open Gmove
48117>>>>>>>>>>>>>>>>>
48117>>>>>>>>>>>>>>>>>//define alias-master condition
48117>>>>>>>>>>>>>>>>>Set_Attribute DF_FILE_ALIAS of Gmovea.File_Number to DF_FILE_IS_ALIAS
48120>>>>>>>>>>>>>>>>>Set_Attribute DF_FILE_ALIAS of Gmove.File_Number  to DF_FILE_IS_MASTER
48123>>>>>>>>>>>>>>>>>
48123>>>>>>>>>>>>>>>>>//clear all relationships from the alias file
48123>>>>>>>>>>>>>>>>>Set_Relate Gmovea.Garticl_Recr to |FN0,0
48124>>>>>>>>>>>>>>>>>>
48124>>>>>>>>>>>>>>>>>Set_Relate Gmovea.Gplan_Recr   to |FN0,0
48125>>>>>>>>>>>>>>>>>>
48125>>>>>>>>>>>>>>>>>
48125>>>>>>>>>>>>>>>>>
48125>>>>>>>>>>>>>>>>>Class Gmovea_DataDictionary  is a DataDictionary_Sec
48126>>>>>>>>>>>>>>>>>
48126>>>>>>>>>>>>>>>>>
48126>>>>>>>>>>>>>>>>>      //private
48126>>>>>>>>>>>>>>>>>      //œ¤ž£œ¨é¤œ  «˜ 13 §œ›å˜ open item
48126>>>>>>>>>>>>>>>>>      //¡˜¢œå«˜  ˜§æ update
48126>>>>>>>>>>>>>>>>>      Procedure private.Do_Compute_Open_Itemsa
48127>>>>>>>>>>>>>>>>>                Case Begin
48127>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_X0 > 0) //˜«æ­ ¦ ®¨œà©« ¡æ record
48129>>>>>>>>>>>>>>>>>                          Move "+"                                                 to Gmovea.Gmove_Topen
48130>>>>>>>>>>>>>>>>>                          Move (     Gmovea.Gmove_X0  - Gmovea.Gmove_Open_Sx0) to Gmovea.Gmove_Open_Yx0
48131>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yp0
48132>>>>>>>>>>>>>>>>>                     Case Break
48133>>>>>>>>>>>>>>>>>
48133>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_X0 < 0) //¯œ¬«¦- ®¨œà©« ¡æ record
48136>>>>>>>>>>>>>>>>>                          Move "-"                                                 to Gmovea.Gmove_Topen
48137>>>>>>>>>>>>>>>>>                          Move ((Abs(Gmovea.Gmove_X0))- Gmovea.Gmove_Open_Sp0) to Gmovea.Gmove_Open_Yp0
48138>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yx0
48139>>>>>>>>>>>>>>>>>                     Case Break
48140>>>>>>>>>>>>>>>>>
48140>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_P0 > 0) //˜«æ­ ¦ § ©«à« ¡æ record
48143>>>>>>>>>>>>>>>>>                          Move "-"                                                 to Gmovea.Gmove_Topen
48144>>>>>>>>>>>>>>>>>                          Move (     Gmovea.Gmove_P0  - Gmovea.Gmove_Open_Sp0) to Gmovea.Gmove_Open_Yp0
48145>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yx0
48146>>>>>>>>>>>>>>>>>                     Case Break
48147>>>>>>>>>>>>>>>>>
48147>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_P0 < 0) //¯œç«¦- ®¨œà©« ¡æ record
48150>>>>>>>>>>>>>>>>>                          Move "+"                                                 to Gmovea.Gmove_Topen
48151>>>>>>>>>>>>>>>>>                          Move ((Abs(Gmovea.Gmove_P0))- Gmovea.Gmove_Open_Sx0) to Gmovea.Gmove_Open_Yx0
48152>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yp0
48153>>>>>>>>>>>>>>>>>                     Case Break
48154>>>>>>>>>>>>>>>>>                Case End
48154>>>>>>>>>>>>>>>>>      End_Procedure //private.do_compute_open_itemsa
48155>>>>>>>>>>>>>>>>>
48155>>>>>>>>>>>>>>>>>
48155>>>>>>>>>>>>>>>>>
48155>>>>>>>>>>>>>>>>>      //private
48155>>>>>>>>>>>>>>>>>      //œ¢âš®œ  «˜ 13 §œ›å˜ open item
48155>>>>>>>>>>>>>>>>>      //¡˜¢œå«˜  ˜§æ validate save
48155>>>>>>>>>>>>>>>>>      Function  private.fi_Validate_Open_Itemsa Returns Integer
48156>>>>>>>>>>>>>>>>>
48156>>>>>>>>>>>>>>>>>                 //1101+1102+1103+1104:â¢œš®¦  £ã ˜¨¤ž« ¡é¤ ¬§¦¢¦å§à¤ §¨¦ª ©¬©®â« ©ž ¡˜  ©¬©®œ« ©Ÿâ¤«à¤ §¦©é¤
48156>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 >= 0                       )) Function_Return 1101
48159>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 >= 0                       )) Function_Return 1102
48162>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 >= 0                       )) Function_Return 1103
48165>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 >= 0                       )) Function_Return 1104
48168>>>>>>>>>>>>>>>>>
48168>>>>>>>>>>>>>>>>>                 Case Begin
48168>>>>>>>>>>>>>>>>>                      //1105+1106+1107+1108:â¢œš®¦  š ˜ ˜«æ­ ¦ ®¨œà©« ¡æ record
48168>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_X0 > 0)
48170>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 <=      Gmovea.Gmove_X0  )) Function_Return 1105
48173>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 <=      Gmovea.Gmove_X0  )) Function_Return 1106
48176>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0  = 0                       )) Function_Return 1107
48179>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0  = 0                       )) Function_Return 1108
48182>>>>>>>>>>>>>>>>>                      Case Break
48183>>>>>>>>>>>>>>>>>                      //1109+1110+1111+1112:â¢œš®¦  š ˜ ¯œ¬«¦- ®¨œà©« ¡æ record
48183>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_X0 < 0)
48186>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0  = 0                       )) Function_Return 1109
48189>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0  = 0                       )) Function_Return 1110
48192>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 <= (Abs(Gmovea.Gmove_X0)))) Function_Return 1111
48195>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 <= (Abs(Gmovea.Gmove_X0)))) Function_Return 1112
48198>>>>>>>>>>>>>>>>>                      Case Break
48199>>>>>>>>>>>>>>>>>                      //1113+1114+1115+1116:â¢œš®¦  š ˜ ˜«æ­ ¦ § ©«à« ¡æ record
48199>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_P0 > 0)
48202>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0  = 0                       )) Function_Return 1113
48205>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0  = 0                       )) Function_Return 1114
48208>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 <=      Gmovea.Gmove_P0  )) Function_Return 1115
48211>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 <=      Gmovea.Gmove_P0  )) Function_Return 1116
48214>>>>>>>>>>>>>>>>>                      Case Break
48215>>>>>>>>>>>>>>>>>                      //1117+1118+1119+1120:â¢œš®¦  š ˜ ¯œç«¦- ®¨œà©« ¡æ record
48215>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_P0 < 0)
48218>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 <= (Abs(Gmovea.Gmove_P0)))) Function_Return 1117
48221>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 <= (Abs(Gmovea.Gmove_P0)))) Function_Return 1118
48224>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0  = 0                       )) Function_Return 1119
48227>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0  = 0                       )) Function_Return 1120
48230>>>>>>>>>>>>>>>>>                      Case Break
48231>>>>>>>>>>>>>>>>>                 Case End
48231>>>>>>>>>>>>>>>>>
48231>>>>>>>>>>>>>>>>>                 Function_Return 0 //æ¢˜ ok
48232>>>>>>>>>>>>>>>>>      End_Function //private.fi_validate_open_itemsa
48233>>>>>>>>>>>>>>>>>
48233>>>>>>>>>>>>>>>>>    Procedure Update
48234>>>>>>>>>>>>>>>>>          Send private.Do_Compute_Open_Itemsa
48235>>>>>>>>>>>>>>>>>    End_Procedure //update
48236>>>>>>>>>>>>>>>>>
48236>>>>>>>>>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
48237>>>>>>>>>>>>>>>>>              String lsError_Message
48238>>>>>>>>>>>>>>>>>              Case Begin
48238>>>>>>>>>>>>>>>>>                   //˜§æ validate save
48238>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1101)
48240>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ œå¤˜  ˜¨¤ž« ¡æ !");                        to lsError_Message
48241>>>>>>>>>>>>>>>>>                   Case Break
48242>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1102)
48245>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ œå¤˜  ˜¨¤ž« ¡æ !");                        to lsError_Message
48246>>>>>>>>>>>>>>>>>                   Case Break
48247>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1103)
48250>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª œå¤˜  ˜¨¤ž« ¡ã !");                        to lsError_Message
48251>>>>>>>>>>>>>>>>>                   Case Break
48252>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1104)
48255>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª œå¤˜  ˜¨¤ž« ¡ã !");                        to lsError_Message
48256>>>>>>>>>>>>>>>>>                   Case Break
48257>>>>>>>>>>>>>>>>>                   //---------------------------------------Ÿœ« ¡âª ®¨œé©œ ª-----------------
48257>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1105)
48260>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã ®¨âà©ž !");                        to lsError_Message
48261>>>>>>>>>>>>>>>>>                   Case Break
48262>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1106)
48265>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã ®¨âà©ž !");                        to lsError_Message
48266>>>>>>>>>>>>>>>>>                   Case Break
48267>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1107)
48270>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ !");                        to lsError_Message
48271>>>>>>>>>>>>>>>>>                   Case Break
48272>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1108)
48275>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
48276>>>>>>>>>>>>>>>>>                   Case Break
48277>>>>>>>>>>>>>>>>>                   //---------------------------------------˜¨¤ž« ¡âª ®¨œé©œ ª---------------
48277>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1109)
48280>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ!");                        to lsError_Message
48281>>>>>>>>>>>>>>>>>                   Case Break
48282>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1110)
48285>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
48286>>>>>>>>>>>>>>>>>                   Case Break
48287>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1111)
48290>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª ®¨âà©žª !");                        to lsError_Message
48291>>>>>>>>>>>>>>>>>                   Case Break
48292>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1112)
48295>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª ®¨âà©žª !");                        to lsError_Message
48296>>>>>>>>>>>>>>>>>                   Case Break
48297>>>>>>>>>>>>>>>>>                   //---------------------------------------Ÿœ« ¡âª § ©«é©œ ª----------------
48297>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1113)
48300>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ !");                        to lsError_Message
48301>>>>>>>>>>>>>>>>>                   Case Break
48302>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1114)
48305>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
48306>>>>>>>>>>>>>>>>>                   Case Break
48307>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1115)
48310>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã §å©«à©ž !");                        to lsError_Message
48311>>>>>>>>>>>>>>>>>                   Case Break
48312>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1116)
48315>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã §å©«à©ž !");                        to lsError_Message
48316>>>>>>>>>>>>>>>>>                   Case Break
48317>>>>>>>>>>>>>>>>>                   //---------------------------------------˜¨àž« ¡âª § ©«é©œ ª----------------
48317>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1117)
48320>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ!");                        to lsError_Message
48321>>>>>>>>>>>>>>>>>                   Case Break
48322>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1118)
48325>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
48326>>>>>>>>>>>>>>>>>                   Case Break
48327>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1119)
48330>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª §å©«à©žª !");                        to lsError_Message
48331>>>>>>>>>>>>>>>>>                   Case Break
48332>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1120) //soso ayto den xoraei display stin othoni !
48335>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª §å©«à©žª !");                        to lsError_Message
48336>>>>>>>>>>>>>>>>>                   Case Break
48337>>>>>>>>>>>>>>>>>
48337>>>>>>>>>>>>>>>>>
48337>>>>>>>>>>>>>>>>>                   //˜§æ validate delete
48337>>>>>>>>>>>>>>>>>                   Case (iError_Num = 2001)
48340>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n˜¨˜¡˜¢é ¡˜¢â©˜«œ «ž¤ Solution !");                        to lsError_Message
48341>>>>>>>>>>>>>>>>>                   Case Break
48342>>>>>>>>>>>>>>>>>
48342>>>>>>>>>>>>>>>>>                   Case Else
48342>>>>>>>>>>>>>>>>>                        Forward Send Operation_Not_Allowed iError_Num
48344>>>>>>>>>>>>>>>>>              Case End
48344>>>>>>>>>>>>>>>>>
48344>>>>>>>>>>>>>>>>>              Error iError_Num lsError_Message
48345>>>>>>>>>>>>>>>>>>
48345>>>>>>>>>>>>>>>>>    End_Procedure   //operation_not_allowed
48346>>>>>>>>>>>>>>>>>
48346>>>>>>>>>>>>>>>>>
48346>>>>>>>>>>>>>>>>>    Function Validate_Save Returns Integer
48347>>>>>>>>>>>>>>>>>             Integer iReturnVal liOpen_Itemsa
48348>>>>>>>>>>>>>>>>>             Forward Get Validate_Save to iReturnVal
48350>>>>>>>>>>>>>>>>>
48350>>>>>>>>>>>>>>>>>             If (Not(iReturnVal));             Begin
48352>>>>>>>>>>>>>>>>>             //1101-1120:â¢œš®¦  open item
48352>>>>>>>>>>>>>>>>>              Move (private.fi_Validate_Open_Itemsa(Self)) to liOpen_Itemsa
48353>>>>>>>>>>>>>>>>>              If (liOpen_Itemsa <> 0) Send Operation_Not_Allowed liOpen_Itemsa
48356>>>>>>>>>>>>>>>>>             End //«â¢¦ª ¡é› ¡˜ validation
48356>>>>>>>>>>>>>>>>>>
48356>>>>>>>>>>>>>>>>>
48356>>>>>>>>>>>>>>>>>
48356>>>>>>>>>>>>>>>>>             Function_Return iReturnVal
48357>>>>>>>>>>>>>>>>>    End_Function //validate_save
48358>>>>>>>>>>>>>>>>>
48358>>>>>>>>>>>>>>>>>
48358>>>>>>>>>>>>>>>>>    //2001:«¦ alias Gmovea ›â¤ œ§ «¨â§œ  ‰ € ‹ ˆ €   › ˜š¨˜­ã
48358>>>>>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
48359>>>>>>>>>>>>>>>>>             Send Operation_Not_Allowed 2001 //¢áŸ¦ª «¦¬ ¡é› ¡˜ !!!
48360>>>>>>>>>>>>>>>>>    End_Function //validate_delete
48361>>>>>>>>>>>>>>>>>
48361>>>>>>>>>>>>>>>>>
48361>>>>>>>>>>>>>>>>>    // Define_Fields:
48361>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48361>>>>>>>>>>>>>>>>>
48361>>>>>>>>>>>>>>>>>    Procedure Define_Fields
48362>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
48364>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48364>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
48364>>>>>>>>>>>>>>>>>
48364>>>>>>>>>>>>>>>>>        Set Main_File            To Gmovea.File_Number
48365>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
48366>>>>>>>>>>>>>>>>>
48366>>>>>>>>>>>>>>>>>
48366>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
48366>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gopen.File_Number
48367>>>>>>>>>>>>>>>>>
48367>>>>>>>>>>>>>>>>>        // Parent (Server) file structure...............
48367>>>>>>>>>>>>>>>>>        Send Add_Server_File  Garticl.File_Number
48368>>>>>>>>>>>>>>>>>        Send Add_Server_File  Gplan.File_Number
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Field-based properties.......................
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Company_Code
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Branch_Code
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Year_Year
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Code
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Garticl_Hmnia
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Garticl_No
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Garticl_Recr
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Recr
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Rec0
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Code
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Aitiol
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X0
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P0
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X0k
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P0k
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X00
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P00
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X00k
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P00k
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X1
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P1
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X2
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P2
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X2k
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P2k
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Xr
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Pr
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Xrk
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Prk
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Dlixis
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_A_Code
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gthhmgio_Code
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Aa
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx0
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp0
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx0
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp0
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx1
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp1
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx1
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp1
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx2
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp2
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx2
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp2
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Sc_Code2
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Aopen
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Topen
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Kk
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gthhmgio_Period
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Yn_Myfp
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Yn_Myfa
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Myf_Sump
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Myf_Suma
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag01
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag02
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag03
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag04
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag05
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag06
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag07
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag08
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag09
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag10
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag11
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag12
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag13
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag14
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag15
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag16
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag17
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag18
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag19
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag20
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Year_Recr
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Recr
48369>>>>>>>>>>>>>>>>>
48369>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
48369>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
48370>>>>>>>>>>>>>>>>>
48370>>>>>>>>>>>>>>>>>    // Field_Defaults:
48370>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
48370>>>>>>>>>>>>>>>>>
48370>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
48371>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
48373>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48373>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
48373>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
48373>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
48374>>>>>>>>>>>>>>>>>End_Class    // Gmovea_DataDictionary
48375>>>>>>>>>>>>>>>>>//DDB-FileEnd
48375>>>>>>>>>>>>>>>              //©«ž¤ begin_transaction §¨¦¡˜¢œå deadlock
48375>>>>>>>>>>>>>>>
48375>>>>>>>>>>>>>>>Class Gplan_DataDictionary  is a DataDictionary_Sec
48376>>>>>>>>>>>>>>>
48376>>>>>>>>>>>>>>>    Procedure Construct_Object
48377>>>>>>>>>>>>>>>        Forward Send Construct_Object
48379>>>>>>>>>>>>>>>        Object oarrayGplan_Aux is a cPinakas
48381>>>>>>>>>>>>>>>        End_Object
48382>>>>>>>>>>>>>>>        Property Integer    pioarray_Gplan_Aux (oarrayGplan_Aux(self))
48383>>>>>>>>>>>>>>>        Property String     psValidChars ""
48384>>>>>>>>>>>>>>>        Property Integer    piMustNOTConstrain Public 0 
48385>>>>>>>>>>>>>>>        Property String     psBranch 
48386>>>>>>>>>>>>>>>    End_Procedure   // Construct_Object
48387>>>>>>>>>>>>>>>
48387>>>>>>>>>>>>>>>    Procedure OnConstrain
48388>>>>>>>>>>>>>>>        Forward Send OnConstrain
48390>>>>>>>>>>>>>>>        If (piMustNOTConstrain(Self)) Begin
48392>>>>>>>>>>>>>>>        End
48392>>>>>>>>>>>>>>>>
48392>>>>>>>>>>>>>>>        Else Begin
48393>>>>>>>>>>>>>>>            Constrain Gplan.Company_Code  eq SysCurGL.Company_Code
48395>>>>>>>>>>>>>>>            Constrain Gplan.Branch_Code   eq SysCurGL.Branch_Code
48397>>>>>>>>>>>>>>>        End
48397>>>>>>>>>>>>>>>>
48397>>>>>>>>>>>>>>>    End_Procedure
48398>>>>>>>>>>>>>>>
48398>>>>>>>>>>>>>>>    Procedure Update
48399>>>>>>>>>>>>>>>        Forward Send Update
48401>>>>>>>>>>>>>>>        // Insert Code Here
48401>>>>>>>>>>>>>>>        Move SysCurGL.Company_Code  to Gplan.Company_Code
48402>>>>>>>>>>>>>>>        Move SysCurGL.Branch_Code   to Gplan.Branch_Code
48403>>>>>>>>>>>>>>>        Move SysCurGL.Year_Year     to Gplan.Year_Year
48404>>>>>>>>>>>>>>>        Move SysCurGL.Year_Recr     to Gplan.Year_Recr
48405>>>>>>>>>>>>>>>    End_Procedure   // Update
48406>>>>>>>>>>>>>>>
48406>>>>>>>>>>>>>>>    Procedure Creating
48407>>>>>>>>>>>>>>>        Forward Send Creating
48409>>>>>>>>>>>>>>>        // Insert Code Here
48409>>>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurGL.Branch_Site))+;                         (Trim(String(Gplan.Gplan_Rec0)))))) to Gplan.Gplan_Recr
48410>>>>>>>>>>>>>>>    End_Procedure   // Creating
48411>>>>>>>>>>>>>>>
48411>>>>>>>>>>>>>>>
48411>>>>>>>>>>>>>>>//////////////////////////////////////
48411>>>>>>>>>>>>>>>//////////////////////////////////////
48411>>>>>>>>>>>>>>>
48411>>>>>>>>>>>>>>>    Function fiCheckValidChars String asGplanCode String asValChars Returns Integer
48412>>>>>>>>>>>>>>>        String lsChar
48413>>>>>>>>>>>>>>>        Integer liLen liCharPos rVal
48413>>>>>>>>>>>>>>>        If (asGplanCode <> "") Begin
48415>>>>>>>>>>>>>>>            Move (Trim(asGplanCode)) to asGplanCode
48416>>>>>>>>>>>>>>>            Move (Length(asGplanCode)) to liLen
48417>>>>>>>>>>>>>>>            For liCharPos From 1 to liLen
48423>>>>>>>>>>>>>>>>
48423>>>>>>>>>>>>>>>               Move (Mid(asGplanCode,1,liCharPos)) to lsChar
48424>>>>>>>>>>>>>>>               If (Not(asValChars contains lsChar)) Begin
48426>>>>>>>>>>>>>>>                    Set psValidChars to asValChars
48427>>>>>>>>>>>>>>>                    Function_Return 1001
48428>>>>>>>>>>>>>>>               End
48428>>>>>>>>>>>>>>>>
48428>>>>>>>>>>>>>>>            Loop
48429>>>>>>>>>>>>>>>>
48429>>>>>>>>>>>>>>>        End
48429>>>>>>>>>>>>>>>>
48429>>>>>>>>>>>>>>>        Function_Return rVal
48430>>>>>>>>>>>>>>>    End_Function // fiCheckValidChars
48431>>>>>>>>>>>>>>>
48431>>>>>>>>>>>>>>>    // private_Do_Restore_Fields:
48431>>>>>>>>>>>>>>>    Procedure private_Do_Restore_Fields for Gplan_DataDictionary
48432>>>>>>>>>>>>>>>        // Insert Code Here
48432>>>>>>>>>>>>>>>        Local Integer lioarray_Gplan_Aux##
48433>>>>>>>>>>>>>>>        Local Integer liFile##
48433>>>>>>>>>>>>>>>        Local Integer liField_Count##
48433>>>>>>>>>>>>>>>        Local Integer liField_Type##
48433>>>>>>>>>>>>>>>        Local Integer liField##
48433>>>>>>>>>>>>>>>
48433>>>>>>>>>>>>>>>        Get pioarray_Gplan_Aux to lioarray_Gplan_Aux##
48434>>>>>>>>>>>>>>>        Get Main_File to liFile##
48435>>>>>>>>>>>>>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of liFile## to liField_Count##
48438>>>>>>>>>>>>>>>
48438>>>>>>>>>>>>>>>
48438>>>>>>>>>>>>>>>        For liField## from 0 to (liField_Count##-1)
48444>>>>>>>>>>>>>>>>
48444>>>>>>>>>>>>>>>            //Get_Attribute DF_FIELD_TYPE of iFile iField to iField_Type
48444>>>>>>>>>>>>>>>            move liField## to Fieldindex
48445>>>>>>>>>>>>>>>            Get Array_Value of lioarray_Gplan_Aux## Item (liField##+1) to Gplan.Company_Code&
48446>>>>>>>>>>>>>>>        Loop
48447>>>>>>>>>>>>>>>>
48447>>>>>>>>>>>>>>>        Send Delete_Data to lioarray_Gplan_Aux##
48448>>>>>>>>>>>>>>>    End_Procedure   // private_Do_Restore_Fields
48449>>>>>>>>>>>>>>>
48449>>>>>>>>>>>>>>>    // private_Do_Keep_Fields:
48449>>>>>>>>>>>>>>>
48449>>>>>>>>>>>>>>>    Procedure private_Do_Keep_Fields for Gplan_DataDictionary
48450>>>>>>>>>>>>>>>        // Insert Code Here
48450>>>>>>>>>>>>>>>        Local Integer lioarray_Gplan_Aux##
48451>>>>>>>>>>>>>>>        Local Integer liFile##
48451>>>>>>>>>>>>>>>        Local Integer liField_Count##
48451>>>>>>>>>>>>>>>        Local Integer liField_Type##
48451>>>>>>>>>>>>>>>        Local Integer liField##
48451>>>>>>>>>>>>>>>
48451>>>>>>>>>>>>>>>        Get pioarray_Gplan_Aux to lioarray_Gplan_Aux##
48452>>>>>>>>>>>>>>>        Get Main_File to liFile##
48453>>>>>>>>>>>>>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of liFile## to liField_Count##
48456>>>>>>>>>>>>>>>
48456>>>>>>>>>>>>>>>        Send Delete_Data to lioarray_Gplan_Aux##
48457>>>>>>>>>>>>>>>        Send Add_Item to lioarray_Gplan_Aux## 0 //sos.sos
48458>>>>>>>>>>>>>>>
48458>>>>>>>>>>>>>>>        For liField## from 0 to (liField_Count##-1)
48464>>>>>>>>>>>>>>>>
48464>>>>>>>>>>>>>>>            //Get_Attribute DF_FIELD_TYPE of iFile iField to iField_Type
48464>>>>>>>>>>>>>>>            move liField## to Fieldindex
48465>>>>>>>>>>>>>>>            Send Add_Item to lioarray_Gplan_Aux## Gplan.Company_Code&
48466>>>>>>>>>>>>>>>        Loop
48467>>>>>>>>>>>>>>>>
48467>>>>>>>>>>>>>>>    End_Procedure   // private_Do_Keep_Fields
48468>>>>>>>>>>>>>>>
48468>>>>>>>>>>>>>>>    // Request_Save:
48468>>>>>>>>>>>>>>>
48468>>>>>>>>>>>>>>>
48468>>>>>>>>>>>>>>>
48468>>>>>>>>>>>>>>>//-----------------------------------------------------------------------------
48468>>>>>>>>>>>>>>>    FUNCTION Compute_Bathmos for Gplan_DataDictionary STRING KODIKOS## RETURNS INTEGER
48469>>>>>>>>>>>>>>>             LOCAL INTEGER BATHMOS##
48470>>>>>>>>>>>>>>>             REPEAT
48470>>>>>>>>>>>>>>>>
48470>>>>>>>>>>>>>>>                   REPLACE "." IN KODIKOS## WITH ""
48472>>>>>>>>>>>>>>>                   [FOUND] INCREMENT BATHMOS##
48473>>>>>>>>>>>>>>>             UNTIL (FINDERR=1)
48475>>>>>>>>>>>>>>>             FUNCTION_RETURN (BATHMOS##+1)
48476>>>>>>>>>>>>>>>    END_FUNCTION //compute_bathmos
48477>>>>>>>>>>>>>>>
48477>>>>>>>>>>>>>>>    FUNCTION Find_Previous for Gplan_DataDictionary STRING LS_CODE1## RETURNS STRING
48478>>>>>>>>>>>>>>>        LOCAL STRING LS_TEMP_CODE1## LS_TEMP_CODE2##
48479>>>>>>>>>>>>>>>        LOCAL INTEGER LI_COUNTER##
48479>>>>>>>>>>>>>>>
48479>>>>>>>>>>>>>>>        FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_CODE1##))
48485>>>>>>>>>>>>>>>>
48485>>>>>>>>>>>>>>>             INSERT (MID(LS_CODE1##,1,LI_COUNTER##)) IN LS_TEMP_CODE1## AT 1
48487>>>>>>>>>>>>>>>        LOOP
48488>>>>>>>>>>>>>>>>
48488>>>>>>>>>>>>>>>        MOVE (RIGHT(LS_TEMP_CODE1##,(LENGTH(LS_TEMP_CODE1##)-(POS(".",LS_TEMP_CODE1##))))) ;             TO LS_TEMP_CODE1##
48489>>>>>>>>>>>>>>>        FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_TEMP_CODE1##))
48495>>>>>>>>>>>>>>>>
48495>>>>>>>>>>>>>>>            INSERT (MID(LS_TEMP_CODE1##,1,LI_COUNTER##)) IN LS_TEMP_CODE2## AT 1
48497>>>>>>>>>>>>>>>        LOOP
48498>>>>>>>>>>>>>>>>
48498>>>>>>>>>>>>>>>        FUNCTION_RETURN LS_TEMP_CODE2##
48499>>>>>>>>>>>>>>>    END_FUNCTION
48500>>>>>>>>>>>>>>>
48500>>>>>>>>>>>>>>>    FUNCTION fiCheck_Format STRING  LS_CODE1##;                            STRING  LS_MASK##;                            INTEGER LI_BATHMOS##;                            RETURNS INTEGER
48501>>>>>>>>>>>>>>>             String  LS_TEMP_CODE1## LS_TEMP_CODE2## LS_MASK2##
48502>>>>>>>>>>>>>>>             Integer LI_COUNTER## LI_BATHMOS1##
48502>>>>>>>>>>>>>>>             Move (Trim(ls_Code1##)) to ls_Code1##
48503>>>>>>>>>>>>>>>             Move (Trim(ls_Mask##))  to ls_Mask##
48504>>>>>>>>>>>>>>>             FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_MASK##))
48510>>>>>>>>>>>>>>>>
48510>>>>>>>>>>>>>>>                  IF ((MID(LS_MASK##,1,LI_COUNTER##)) = ".") INCREMENT LI_BATHMOS1##
48513>>>>>>>>>>>>>>>                  IF (LI_BATHMOS1## < LI_BATHMOS##) ;                  INSERT (MID(LS_MASK##,1,LI_COUNTER##)) IN LS_MASK2## AT LI_COUNTER##
48517>>>>>>>>>>>>>>>             LOOP
48518>>>>>>>>>>>>>>>>
48518>>>>>>>>>>>>>>>             IF (;                  (LENGTH(LS_CODE1##)) <> (LENGTH(LS_MASK2##));                ) FUNCTION_RETURN 1000
48521>>>>>>>>>>>>>>>             FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_MASK2##))
48527>>>>>>>>>>>>>>>>
48527>>>>>>>>>>>>>>>                  IF (;                      ((MID(LS_MASK2##,1,LI_COUNTER##)) = ".") AND;                      ((MID(LS_CODE1##,1,LI_COUNTER##)) <> ".");                     ) FUNCTION_RETURN 1000
48530>>>>>>>>>>>>>>>             LOOP
48531>>>>>>>>>>>>>>>>
48531>>>>>>>>>>>>>>>             FUNCTION_RETURN 0
48532>>>>>>>>>>>>>>>    END_FUNCTION //fiCHECK_FORMAT
48533>>>>>>>>>>>>>>>
48533>>>>>>>>>>>>>>>    Function fiBackward_Check for Gplan_DataDictionary String LsGplanCode_Back integer liBathmos Returns Integer
48534>>>>>>>>>>>>>>>        Integer liGplan_Yn_Last
48535>>>>>>>>>>>>>>>        Number liGplanRecnum
48535>>>>>>>>>>>>>>>        String LsSearch_CodePrevious
48535>>>>>>>>>>>>>>>
48535>>>>>>>>>>>>>>>        if (liBathmos > 1) begin
48537>>>>>>>>>>>>>>>
48537>>>>>>>>>>>>>>>            move (Current_Record(Self)) to liGplanRecnum
48538>>>>>>>>>>>>>>>            move gplan.Gplan_Yn_Last to liGplan_Yn_Last
48539>>>>>>>>>>>>>>>            Send private_Do_Keep_Fields
48540>>>>>>>>>>>>>>>
48540>>>>>>>>>>>>>>>            Move (Find_Previous(self,lsGplanCode_Back)) to lsSearch_CodePrevious
48541>>>>>>>>>>>>>>>
48541>>>>>>>>>>>>>>>            clear Gplan
48542>>>>>>>>>>>>>>>            move gs_Selected_Company_Code  to Gplan.Company_Code
48543>>>>>>>>>>>>>>>            move gs_Selected_Branch_Code   to Gplan.Branch_Code
48544>>>>>>>>>>>>>>>            move gi_Selected_Year          to Gplan.Year_Year
48545>>>>>>>>>>>>>>>            move lsSearch_CodePrevious     to Gplan.Gplan_Code
48546>>>>>>>>>>>>>>>            Find eq Gplan by index.1 // pkid
48547>>>>>>>>>>>>>>>>
48547>>>>>>>>>>>>>>>            If (Found = 0) begin
48549>>>>>>>>>>>>>>>                clear gplan
48550>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
48551>>>>>>>>>>>>>>>                find eq gplan.recnum
48552>>>>>>>>>>>>>>>>
48552>>>>>>>>>>>>>>>                Send private_Do_Restore_Fields
48553>>>>>>>>>>>>>>>                Function_return  7001 //return to fiValidate
48554>>>>>>>>>>>>>>>            end
48554>>>>>>>>>>>>>>>>
48554>>>>>>>>>>>>>>>            else begin
48555>>>>>>>>>>>>>>>               // The  previous logar marked last  and current greater bathmos
48555>>>>>>>>>>>>>>>               if   (Gplan.Gplan_yn_Last = 1) begin
48557>>>>>>>>>>>>>>>                   Send private_Do_Restore_Fields
48558>>>>>>>>>>>>>>>                   Function_return 7003
48559>>>>>>>>>>>>>>>               end
48559>>>>>>>>>>>>>>>>
48559>>>>>>>>>>>>>>>               clear gplan
48560>>>>>>>>>>>>>>>               move liGplanRecnum to gplan.recnum
48561>>>>>>>>>>>>>>>               find eq gplan.recnum
48562>>>>>>>>>>>>>>>>
48562>>>>>>>>>>>>>>>               Send private_Do_Restore_Fields
48563>>>>>>>>>>>>>>>               function_Return 0 //ok
48564>>>>>>>>>>>>>>>            end
48564>>>>>>>>>>>>>>>>
48564>>>>>>>>>>>>>>>        end
48564>>>>>>>>>>>>>>>>
48564>>>>>>>>>>>>>>>        Function_Return 0
48565>>>>>>>>>>>>>>>    End_Function  // fiBackward_Check
48566>>>>>>>>>>>>>>>    //-----------------------------------------------------------------------------
48566>>>>>>>>>>>>>>>
48566>>>>>>>>>>>>>>>
48566>>>>>>>>>>>>>>>    //-----------------------------------------------------------------------------
48566>>>>>>>>>>>>>>>    FUNCTION fiForward_Check for Gplan_DataDictionary STRING LS_GplanCode integer liMode Returns Integer
48567>>>>>>>>>>>>>>>        String lsNext_Anoep
48568>>>>>>>>>>>>>>>        Integer liGplan_Yn_Last
48568>>>>>>>>>>>>>>>        Number liGplanRecnum
48568>>>>>>>>>>>>>>>
48568>>>>>>>>>>>>>>>
48568>>>>>>>>>>>>>>>        //move gplan.recnum to liGplanRecnum
48568>>>>>>>>>>>>>>>        move (Current_Record(Self)) to liGplanRecnum
48569>>>>>>>>>>>>>>>        move gplan.Gplan_Code to lsNext_Anoep
48570>>>>>>>>>>>>>>>        move gplan.Gplan_Yn_Last to liGplan_Yn_Last
48571>>>>>>>>>>>>>>>        Send private_Do_Keep_Fields
48572>>>>>>>>>>>>>>>
48572>>>>>>>>>>>>>>>        if (liGplan_Yn_Last = 1)  begin
48574>>>>>>>>>>>>>>>            find gt gplan by index.1
48575>>>>>>>>>>>>>>>>
48575>>>>>>>>>>>>>>>            if (found = 0) begin
48577>>>>>>>>>>>>>>>                clear gplan
48578>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
48579>>>>>>>>>>>>>>>                find eq gplan.recnum
48580>>>>>>>>>>>>>>>>
48580>>>>>>>>>>>>>>>                Send private_Do_Restore_Fields
48581>>>>>>>>>>>>>>>            end
48581>>>>>>>>>>>>>>>>
48581>>>>>>>>>>>>>>>            else begin
48582>>>>>>>>>>>>>>>                // The Current and the previous logar marked last
48582>>>>>>>>>>>>>>>                if (Gplan.Gplan_Anoep = lsNext_Anoep) begin
48584>>>>>>>>>>>>>>>                    clear gplan
48585>>>>>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
48586>>>>>>>>>>>>>>>                    find eq gplan.recnum
48587>>>>>>>>>>>>>>>>
48587>>>>>>>>>>>>>>>                    Send private_Do_Restore_Fields
48588>>>>>>>>>>>>>>>                    Function_return 7004
48589>>>>>>>>>>>>>>>                end
48589>>>>>>>>>>>>>>>>
48589>>>>>>>>>>>>>>>                else begin
48590>>>>>>>>>>>>>>>                    clear gplan
48591>>>>>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
48592>>>>>>>>>>>>>>>                    find eq gplan.recnum
48593>>>>>>>>>>>>>>>>
48593>>>>>>>>>>>>>>>                    Send private_Do_Restore_Fields
48594>>>>>>>>>>>>>>>                end
48594>>>>>>>>>>>>>>>>
48594>>>>>>>>>>>>>>>            end
48594>>>>>>>>>>>>>>>>
48594>>>>>>>>>>>>>>>        end
48594>>>>>>>>>>>>>>>>
48594>>>>>>>>>>>>>>>
48594>>>>>>>>>>>>>>>        if (liMode = 1) begin
48596>>>>>>>>>>>>>>>            find gt gplan by index.1
48597>>>>>>>>>>>>>>>>
48597>>>>>>>>>>>>>>>            if (Found = 0) begin
48599>>>>>>>>>>>>>>>                clear gplan
48600>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
48601>>>>>>>>>>>>>>>                find eq gplan.recnum
48602>>>>>>>>>>>>>>>>
48602>>>>>>>>>>>>>>>                Send private_Do_Restore_Fields
48603>>>>>>>>>>>>>>>            end
48603>>>>>>>>>>>>>>>>
48603>>>>>>>>>>>>>>>            else begin
48604>>>>>>>>>>>>>>>                if (Gplan.Gplan_Anoep = lsNext_Anoep) begin
48606>>>>>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
48607>>>>>>>>>>>>>>>                    find eq gplan.recnum
48608>>>>>>>>>>>>>>>>
48608>>>>>>>>>>>>>>>                    Send private_Do_Restore_Fields
48609>>>>>>>>>>>>>>>                    Function_return 7010 //called from validate delete
48610>>>>>>>>>>>>>>>                end
48610>>>>>>>>>>>>>>>>
48610>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
48611>>>>>>>>>>>>>>>                find eq gplan.recnum
48612>>>>>>>>>>>>>>>>
48612>>>>>>>>>>>>>>>                //Send private_Do_Restore_Fields
48612>>>>>>>>>>>>>>>            end
48612>>>>>>>>>>>>>>>>
48612>>>>>>>>>>>>>>>        end
48612>>>>>>>>>>>>>>>>
48612>>>>>>>>>>>>>>>        Function_return 0
48613>>>>>>>>>>>>>>>    End_Function // fiForward_Check
48614>>>>>>>>>>>>>>>
48614>>>>>>>>>>>>>>>
48614>>>>>>>>>>>>>>>    Function private_Man_Gplan_Code for Gplan_DataDictionary integer liField## String lsGplan_Code integer liModeGplan Returns Integer
48615>>>>>>>>>>>>>>>
48615>>>>>>>>>>>>>>>        // Insert Code Here
48615>>>>>>>>>>>>>>>        Integer liCounter liPosition liLength liBathmos liRetVal
48616>>>>>>>>>>>>>>>        string lsMask lsCkeckChar lsSearchCode
48616>>>>>>>>>>>>>>>
48616>>>>>>>>>>>>>>>        Trim lsGplan_code to lsGplan_code
48617>>>>>>>>>>>>>>>>
48617>>>>>>>>>>>>>>>        Move lsGplan_Code to lsSearchCode
48618>>>>>>>>>>>>>>>    Search_Again:
48618>>>>>>>>>>>>>>>        clear Gformat
INCLUDING FILE: GFORMAT.FD
48619>>>>>>>>>>>>>>>        move SysCurGL.Company_Code  to Gformat.Company_Code
48620>>>>>>>>>>>>>>>        move SysCurGL.Branch_Code   to Gformat.Branch_Code
48621>>>>>>>>>>>>>>>        move SysCurGL.Year_Year     to Gformat.Year_Year
48622>>>>>>>>>>>>>>>        move lsSearchCode           to Gformat.Gformat_Code
48623>>>>>>>>>>>>>>>        Find eq Gformat by index.1
48624>>>>>>>>>>>>>>>>
48624>>>>>>>>>>>>>>>
48624>>>>>>>>>>>>>>>        if (Found = 1) begin
48626>>>>>>>>>>>>>>>            Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
48627>>>>>>>>>>>>>>>            Move (fiCheck_Format(self,lsGplan_Code,gformat.gformat_mask,liBathmos)) to liRetVal
48628>>>>>>>>>>>>>>>            if (liRetVal = 0) begin
48630>>>>>>>>>>>>>>>                Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
48631>>>>>>>>>>>>>>>                if (liModeGplan = 0) Begin
48633>>>>>>>>>>>>>>>                    if (Not(Current_Record(self))) begin
48635>>>>>>>>>>>>>>>                        set field_default_value field Gplan.gplan_Bathmos to libathmos //from deo
48636>>>>>>>>>>>>>>>                    end
48636>>>>>>>>>>>>>>>>
48636>>>>>>>>>>>>>>>                end
48636>>>>>>>>>>>>>>>>
48636>>>>>>>>>>>>>>>                if (libathmos > 1) begin
48638>>>>>>>>>>>>>>>                    Move (Find_Previous(self,lsGplan_Code)) to lsSearchCode
48639>>>>>>>>>>>>>>>                    if (liModeGplan = 0) Begin
48641>>>>>>>>>>>>>>>                        if (Not(Current_Record(self))) begin
48643>>>>>>>>>>>>>>>                            set field_default_value field Gplan.gplan_Anoep to lsSearchCode //from Deo
48644>>>>>>>>>>>>>>>                        End
48644>>>>>>>>>>>>>>>>
48644>>>>>>>>>>>>>>>                    End
48644>>>>>>>>>>>>>>>>
48644>>>>>>>>>>>>>>>                end
48644>>>>>>>>>>>>>>>>
48644>>>>>>>>>>>>>>>            function_return 0
48645>>>>>>>>>>>>>>>            end
48645>>>>>>>>>>>>>>>>
48645>>>>>>>>>>>>>>>            else begin
48646>>>>>>>>>>>>>>>                function_return 127
48647>>>>>>>>>>>>>>>            end
48647>>>>>>>>>>>>>>>>
48647>>>>>>>>>>>>>>>        end
48647>>>>>>>>>>>>>>>>
48647>>>>>>>>>>>>>>>        else begin
48648>>>>>>>>>>>>>>>            Move (Compute_Bathmos(self,lsSearchCode)) to liBathmos
48649>>>>>>>>>>>>>>>            if ((liBathmos-1) <> 0) begin
48651>>>>>>>>>>>>>>>                Move (Find_Previous(self,lsSearchCode)) to lsSearchCode
48652>>>>>>>>>>>>>>>                Goto Search_Again
48653>>>>>>>>>>>>>>>>
48653>>>>>>>>>>>>>>>            end
48653>>>>>>>>>>>>>>>>
48653>>>>>>>>>>>>>>>            else begin
48654>>>>>>>>>>>>>>>                clear Gformat
48655>>>>>>>>>>>>>>>                move SysCurGL.Company_Code  to Gformat.Company_Code
48656>>>>>>>>>>>>>>>                move SysCurGL.Branch_Code   to Gformat.Branch_Code
48657>>>>>>>>>>>>>>>                move SysCurGL.Year_Year     to Gformat.Year_Year
48658>>>>>>>>>>>>>>>                move "@@"                   to Gformat.Gformat_Code
48659>>>>>>>>>>>>>>>                Find eq Gformat by index.1 // pkid
48660>>>>>>>>>>>>>>>>
48660>>>>>>>>>>>>>>>//* to be a function
48660>>>>>>>>>>>>>>>                Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
48661>>>>>>>>>>>>>>>                Move (fiCheck_Format(self,lsGplan_Code,gformat.gformat_mask,liBathmos)) to liRetVal
48662>>>>>>>>>>>>>>>                if (liRetVal = 0) begin
48664>>>>>>>>>>>>>>>                    Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
48665>>>>>>>>>>>>>>>                    if (liModeGplan = 0) Begin
48667>>>>>>>>>>>>>>>                        if (Not(Current_Record(self))) begin
48669>>>>>>>>>>>>>>>                            set field_default_value field Gplan.gplan_Bathmos to libathmos //from Deo
48670>>>>>>>>>>>>>>>                        end
48670>>>>>>>>>>>>>>>>
48670>>>>>>>>>>>>>>>                    end
48670>>>>>>>>>>>>>>>>
48670>>>>>>>>>>>>>>>                    if (libathmos > 1) begin
48672>>>>>>>>>>>>>>>                        Move (Find_Previous(self,lsGplan_Code)) to lsSearchCode
48673>>>>>>>>>>>>>>>                        if (liModeGplan = 0) Begin
48675>>>>>>>>>>>>>>>                            if (Not(Current_Record(self))) begin
48677>>>>>>>>>>>>>>>                                set field_default_value field Gplan.gplan_Anoep to lsSearchCode //from Deo
48678>>>>>>>>>>>>>>>                            end
48678>>>>>>>>>>>>>>>>
48678>>>>>>>>>>>>>>>                        end
48678>>>>>>>>>>>>>>>>
48678>>>>>>>>>>>>>>>                    end
48678>>>>>>>>>>>>>>>>
48678>>>>>>>>>>>>>>>                function_return 0
48679>>>>>>>>>>>>>>>                end
48679>>>>>>>>>>>>>>>>
48679>>>>>>>>>>>>>>>                else begin
48680>>>>>>>>>>>>>>>                    function_return 127
48681>>>>>>>>>>>>>>>                end
48681>>>>>>>>>>>>>>>>
48681>>>>>>>>>>>>>>>
48681>>>>>>>>>>>>>>>                //* emd to be a function
48681>>>>>>>>>>>>>>>                function_return 0
48682>>>>>>>>>>>>>>>            end
48682>>>>>>>>>>>>>>>>
48682>>>>>>>>>>>>>>>        end
48682>>>>>>>>>>>>>>>>
48682>>>>>>>>>>>>>>>        Function_return 0    //ok
48683>>>>>>>>>>>>>>>    End_Function   // private_Man_Gplan_Code
48684>>>>>>>>>>>>>>>
48684>>>>>>>>>>>>>>>
48684>>>>>>>>>>>>>>>
48684>>>>>>>>>>>>>>>    // fiValidateGplanFields:
48684>>>>>>>>>>>>>>>
48684>>>>>>>>>>>>>>>    Function fiValidateGplanFields for Gplan_DataDictionary integer liField string lsFieldvalue Returns Integer
48685>>>>>>>>>>>>>>>        String  sName lsAnoep lsGplan_Code
48686>>>>>>>>>>>>>>>        Integer iMainFile liGplanRecnum liReturnVal liReturnValb liBathmos1
48686>>>>>>>>>>>>>>>        String lsValidChar lsDelimiter
48686>>>>>>>>>>>>>>>
48686>>>>>>>>>>>>>>>        Get Main_File to iMainFile
48687>>>>>>>>>>>>>>>        Get_Attribute DF_FIELD_NAME of iMainFile liField to sName
48690>>>>>>>>>>>>>>>
48690>>>>>>>>>>>>>>>        If (sName = 'GPLAN_CODE') Begin
48692>>>>>>>>>>>>>>>            move (trim(lsFieldvalue)) to lsFieldvalue //from deo
48693>>>>>>>>>>>>>>>            if (lsFieldvalue <>  "") begin //new
48695>>>>>>>>>>>>>>>                Move SyscurGL.Year_Valid_Char to lsValidChar
48696>>>>>>>>>>>>>>>                Move SyscurGL.Year_Delimiter  to lsDelimiter
48697>>>>>>>>>>>>>>>                Move (fiCheckValidChars(Self,lsFieldvalue,((Trim(lsValidChar))+(Trim(lsDelimiter))))) to liReturnVal
48698>>>>>>>>>>>>>>>                if (liReturnVal = '1001') begin
48700>>>>>>>>>>>>>>>                               error liReturnVal ("‹ž ˜§¦›œ¡«æª ®˜¨˜¡«ã¨˜ª š ˜ ¡à› ¡æ Š.‘ !\n\n€§¦›œ¡«¦å ®˜¨˜¡«ã¨œª : '" + (psValidChars(Self)) + "'")
48701>>>>>>>>>>>>>>>>
48701>>>>>>>>>>>>>>>                               Function_Return liReturnVal
48702>>>>>>>>>>>>>>>                            end
48702>>>>>>>>>>>>>>>>
48702>>>>>>>>>>>>>>>
48702>>>>>>>>>>>>>>>                Move (private_Man_Gplan_Code(self,liField,lsFieldvalue,0)) to liReturnVal
48703>>>>>>>>>>>>>>>                if (lireturnval <> 0) begin
48705>>>>>>>>>>>>>>>                                        error 127 ("ŠáŸ¦ª £¦¨­ã ¡à› ¡¦ç !\n\n"+Gplan.Gplan_Code)
48706>>>>>>>>>>>>>>>>
48706>>>>>>>>>>>>>>>                                        function_return 127
48707>>>>>>>>>>>>>>>                                      end
48707>>>>>>>>>>>>>>>>
48707>>>>>>>>>>>>>>>
48707>>>>>>>>>>>>>>>                get field_current_value field Gplan.gplan_Code to lsGplan_Code
48708>>>>>>>>>>>>>>>                get field_current_value field Gplan.gplan_Bathmos to liBathmos1
48709>>>>>>>>>>>>>>>                get field_current_value field Gplan.gplan_anoep to lsAnoep
48710>>>>>>>>>>>>>>>                Move (fiBackward_Check(self,lsGplan_Code,liBathmos1)) to liReturnValb
48711>>>>>>>>>>>>>>>                if (liReturnValb = '7001') begin
48713>>>>>>>>>>>>>>>                                               error 7001 "ƒœ¤ ¬§á¨®œ  ¦ §œ¨ ¢ž§« ¡æª ™˜Ÿ£æª !"
48714>>>>>>>>>>>>>>>>
48714>>>>>>>>>>>>>>>                                               Function_Return 8001
48715>>>>>>>>>>>>>>>                                            end
48715>>>>>>>>>>>>>>>>
48715>>>>>>>>>>>>>>>                if (liReturnValb = '7002') begin
48717>>>>>>>>>>>>>>>                                               error 7002 "“§á¨®œ  ¡à› ¡æª «œ¢œ¬«˜å¦¬ ™˜Ÿ£¦ç !"
48718>>>>>>>>>>>>>>>>
48718>>>>>>>>>>>>>>>                                               Function_Return 8002
48719>>>>>>>>>>>>>>>                                          end
48719>>>>>>>>>>>>>>>>
48719>>>>>>>>>>>>>>>                if (liReturnValb = '7003') begin
48721>>>>>>>>>>>>>>>                                               error 7003 "Ž §¨¦žš¦ç£œ¤¦ª œå¤˜  «œ¢œ¬«˜å¦¬ ™˜Ÿ£¦ç !"
48722>>>>>>>>>>>>>>>>
48722>>>>>>>>>>>>>>>                                               Function_Return 8003
48723>>>>>>>>>>>>>>>                                          end
48723>>>>>>>>>>>>>>>>
48723>>>>>>>>>>>>>>>
48723>>>>>>>>>>>>>>>                Move (fiForward_Check(self,lsGplan_Code,0)) to liReturnValb
48724>>>>>>>>>>>>>>>                if (liReturnValb = '7004') begin
48726>>>>>>>>>>>>>>>                                               error 7004 "“§á¨®œ  ¦ ˜¤é«œ¨¦ª ™˜Ÿ£æª !"
48727>>>>>>>>>>>>>>>>
48727>>>>>>>>>>>>>>>                                               Function_Return 8004
48728>>>>>>>>>>>>>>>                                            end
48728>>>>>>>>>>>>>>>>
48728>>>>>>>>>>>>>>>
48728>>>>>>>>>>>>>>>            end
48728>>>>>>>>>>>>>>>>
48728>>>>>>>>>>>>>>>            else Function_Return 0  //exit function ok!!!
48730>>>>>>>>>>>>>>>         end
48730>>>>>>>>>>>>>>>>
48730>>>>>>>>>>>>>>>         function_return 0
48731>>>>>>>>>>>>>>>    End_Function   // fiValidateGplanFields
48732>>>>>>>>>>>>>>>
48732>>>>>>>>>>>>>>>
48732>>>>>>>>>>>>>>>//-----------------------------------------------Save Operation ----------------------------------------------------
48732>>>>>>>>>>>>>>>
48732>>>>>>>>>>>>>>>
48732>>>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
48733>>>>>>>>>>>>>>>        //Forward Send Operation_Not_Allowed  iError_Num
48733>>>>>>>>>>>>>>>        // Insert Code Here
48733>>>>>>>>>>>>>>>                 if iError_num eq 127  error 127 ((Trim(Gplan.Gplan_Code))+" Wrong Format !!!! \n\n")
48736>>>>>>>>>>>>>>>            Else if iError_num eq 128  error 128 ("Not a valid Data Entry.  Account is Missing !!!!\n\n"+Gplan.Gplan_Code)
48740>>>>>>>>>>>>>>>            Else if iError_num eq 129  error 129 ("Not a valid Data Entry.  Bathmos is Missing !!!!\n\n"+Gplan.Gplan_Code)
48744>>>>>>>>>>>>>>>            Else if iError_num eq 130  error 130 ("Not a valid Data Entry.  Previews Account is Missing !!!!\n\n"+Gplan.Gplan_Code)
48748>>>>>>>>>>>>>>>            Else if iError_num eq 1100  error 1100 "DDC:150 - ‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
48752>>>>>>>>>>>>>>>            Else if iError_num eq 2100  error 2100 "DDC:150 - ‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
48756>>>>>>>>>>>>>>>            Else if iError_num eq 7001 error 8001 ("Anoep Does not Exist !!!!\n\n"+Gplan.Gplan_Code)
48760>>>>>>>>>>>>>>>            Else if iError_num eq 7002 error 8002 ("Last Exists\n\n!!!! "+Gplan.Gplan_Code)
48764>>>>>>>>>>>>>>>            Else if iError_num eq 7003 error 8003 ("Previous batmos is last  !!!!\n\n"+Gplan.Gplan_Code)
48768>>>>>>>>>>>>>>>            Else if iError_num eq 7004 error 8004 ("Greater bathmos exists  !!!!\n\n"+Gplan.Gplan_Code)
48772>>>>>>>>>>>>>>>            Else if iError_num eq 7010 error 7010 ("Greater bathmos exists  !!!!\n\n"+Gplan.Gplan_Code)
48776>>>>>>>>>>>>>>>            Else if (iError_num = 1001) error 1001 ("‹ž ˜§¦›œ¡«æª ®˜¨˜¡«ã¨˜ª š ˜ ¡à› ¡æ Š.‘ !\n\n€§¦›œ¡«¦å ®˜¨˜¡«ã¨œª : '" + (psValidChars(Self)) + "'")
48780>>>>>>>>>>>>>>>            Else Forward Send Operation_Not_Allowed  iError_Num
48783>>>>>>>>>>>>>>>    End_Procedure
48784>>>>>>>>>>>>>>>
48784>>>>>>>>>>>>>>>
48784>>>>>>>>>>>>>>>    Procedure Clear_From_Bpo
48785>>>>>>>>>>>>>>>        Clear Gplan
48786>>>>>>>>>>>>>>>    End_Procedure
48787>>>>>>>>>>>>>>>
48787>>>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
48788>>>>>>>>>>>>>>>        Local Integer iReturnVal iField##
48789>>>>>>>>>>>>>>>        locaL string lsVal##
48789>>>>>>>>>>>>>>>
48789>>>>>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
48791>>>>>>>>>>>>>>>
48791>>>>>>>>>>>>>>>
48791>>>>>>>>>>>>>>>        If (Not(iReturnVal))Begin
48793>>>>>>>>>>>>>>>        //    If (Not(Current_Record(Self))) Move (fiCheckValidChars(Self,Gplan.Gplan_Code,((Trim(Year.Year_Valid_Char))+(Trim(Year.Year_Delimiter))))) to iReturnVal
48793>>>>>>>>>>>>>>>        //    If (iReturnVal) Send Operation_Not_Allowed iReturnVal
48793>>>>>>>>>>>>>>>            If (Gplan.Gplan_Code    = "") Send Operation_Not_Allowed 128
48796>>>>>>>>>>>>>>>            If (Gplan.Gplan_Bathmos = 0 ) Send Operation_Not_Allowed 129
48799>>>>>>>>>>>>>>>            If (;                 (Gplan.Gplan_Bathmos <> 1) and;                 (Gplan.Gplan_Anoep = "");               ) Send Operation_Not_Allowed 130
48802>>>>>>>>>>>>>>>            For iField## from 4 to 4   // Field number for Starting and Ending pp's ???????
48808>>>>>>>>>>>>>>>>
48808>>>>>>>>>>>>>>>
48808>>>>>>>>>>>>>>>                Move (private_Man_Gplan_Code(self,iField##,Gplan.Gplan_Code,1))     to iReturnVal
48809>>>>>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
48812>>>>>>>>>>>>>>>
48812>>>>>>>>>>>>>>>                Move (fiBACKWARD_CHECK(self,Gplan.Gplan_Code,Gplan.Gplan_Bathmos)) to iReturnVal
48813>>>>>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
48816>>>>>>>>>>>>>>>
48816>>>>>>>>>>>>>>>                Move (fiFORWARD_CHECK(self,Gplan.Gplan_Code,0))                     to iReturnVal
48817>>>>>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
48820>>>>>>>>>>>>>>>
48820>>>>>>>>>>>>>>>            Loop
48821>>>>>>>>>>>>>>>>
48821>>>>>>>>>>>>>>>              //1100:cby = globals
48821>>>>>>>>>>>>>>>              If ( ;                   (Not(Gplan.Company_Code = SysCurGL.Company_Code)) or;                   (Not(Gplan.Branch_Code  = SysCurGL.Branch_Code )) ;                  ) Send Operation_Not_Allowed 1100
48824>>>>>>>>>>>>>>>        End
48824>>>>>>>>>>>>>>>>
48824>>>>>>>>>>>>>>>        Function_Return iReturnVal
48825>>>>>>>>>>>>>>>    End_Function
48826>>>>>>>>>>>>>>>
48826>>>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
48827>>>>>>>>>>>>>>>        Local Integer iReturnVal liReturnValb##
48828>>>>>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
48830>>>>>>>>>>>>>>>
48830>>>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
48832>>>>>>>>>>>>>>>            // Insert Code Here
48832>>>>>>>>>>>>>>>               Move (fiFORWARD_CHECK(Self,Gplan.Gplan_Code,1)) to liReturnValb##
48833>>>>>>>>>>>>>>>               If (liReturnValb##>1) Send Operation_Not_Allowed liReturnValb##
48836>>>>>>>>>>>>>>>              //2100:cby = globals
48836>>>>>>>>>>>>>>>              If ( ;                   (Not(Gplan.Company_Code = SysCurGL.Company_Code)) or;                   (Not(Gplan.Branch_Code  = SysCurGL.Branch_Code )) ;                  ) Send Operation_Not_Allowed 2100
48839>>>>>>>>>>>>>>>        End
48839>>>>>>>>>>>>>>>>
48839>>>>>>>>>>>>>>>
48839>>>>>>>>>>>>>>>        Function_Return iReturnVal
48840>>>>>>>>>>>>>>>    End_Function
48841>>>>>>>>>>>>>>>
48841>>>>>>>>>>>>>>>
48841>>>>>>>>>>>>>>>//    Procedure Update
48841>>>>>>>>>>>>>>>//        Forward Send Update
48841>>>>>>>>>>>>>>>//        // Insert Code Here
48841>>>>>>>>>>>>>>>//        Move Company.Company_Code  to Gplan.Company_Code
48841>>>>>>>>>>>>>>>//        Move Branch.Branch_Code    to Gplan.Branch_Code
48841>>>>>>>>>>>>>>>//        Move Year.Year_Year        to Gplan.Year_Year
48841>>>>>>>>>>>>>>>//        Add 1 to Year.Year_NumGplan //˜¨ Ÿ£æª ¢¦š˜¨ ˜©£é¤ «žª ®¨ã©žª
48841>>>>>>>>>>>>>>>//    End_Procedure   // Update
48841>>>>>>>>>>>>>>>
48841>>>>>>>>>>>>>>>//    Procedure Backout
48841>>>>>>>>>>>>>>>//        Forward Send Backout
48841>>>>>>>>>>>>>>>//        Sub 1 from Year.Year_NumGplan //˜¨ Ÿ£æª ¢¦š˜¨ ˜©£é¤ «žª ®¨ã©žª
48841>>>>>>>>>>>>>>>//    End_Procedure //deleting
48841>>>>>>>>>>>>>>>
48841>>>>>>>>>>>>>>>
48841>>>>>>>>>>>>>>>
48841>>>>>>>>>>>>>>>    // Define_Fields:
48841>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48841>>>>>>>>>>>>>>>
48841>>>>>>>>>>>>>>>    Procedure Define_Fields
48842>>>>>>>>>>>>>>>        Forward Send Define_Fields
48844>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48844>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
48844>>>>>>>>>>>>>>>
48844>>>>>>>>>>>>>>>        Set Main_File            To Gplan.File_Number
48845>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
48846>>>>>>>>>>>>>>>
48846>>>>>>>>>>>>>>>
48846>>>>>>>>>>>>>>>        // Child (Client) file structure................
48846>>>>>>>>>>>>>>>        Send Add_Client_File  Gmovea.File_Number
48847>>>>>>>>>>>>>>>        Send Add_Client_File  Gplanmod.File_Number
48848>>>>>>>>>>>>>>>        Send Add_Client_File  Gmhnes.File_Number
48849>>>>>>>>>>>>>>>        Send Add_Client_File  Gmove.File_Number
48850>>>>>>>>>>>>>>>        Send Add_Client_File  Gvatd.File_Number
48851>>>>>>>>>>>>>>>        Send Add_Client_File  Gpmoves.File_Number
48852>>>>>>>>>>>>>>>
48852>>>>>>>>>>>>>>>        // External (System) file structure.............
48852>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
48853>>>>>>>>>>>>>>>        Send Add_System_File  Syscurgl.File_Number  DD_LOCK_ON_ALL
48854>>>>>>>>>>>>>>>
48854>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gplan_Rec0  To Gplan.Gplan_Rec0
48857>>>>>>>>>>>>>>>
48857>>>>>>>>>>>>>>>        // Field-based properties.......................
48857>>>>>>>>>>>>>>>
48857>>>>>>>>>>>>>>>        // Gplan.Company_Code
48857>>>>>>>>>>>>>>>
48857>>>>>>>>>>>>>>>        // Gplan.Branch_Code
48857>>>>>>>>>>>>>>>
48857>>>>>>>>>>>>>>>        // Gplan.Year_Year
48857>>>>>>>>>>>>>>>
48857>>>>>>>>>>>>>>>        // Gplan.Gplan_Code
48857>>>>>>>>>>>>>>>        Set Field_Exit_msg         Field Gplan.Gplan_Code To get_fiValidateGplanFields
48858>>>>>>>>>>>>>>>        Set Field_Options          Field Gplan.Gplan_Code To DD_AUTOFIND    DD_REQUIRED   
48859>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Code To (sl150(Self))
48860>>>>>>>>>>>>>>>
48860>>>>>>>>>>>>>>>        // Gplan.Gplan_Rec0
48860>>>>>>>>>>>>>>>
48860>>>>>>>>>>>>>>>        // Gplan.Year_Recr
48860>>>>>>>>>>>>>>>
48860>>>>>>>>>>>>>>>        // Gplan.Gplan_Descr1
48860>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Descr1 To (sl150(Self))
48861>>>>>>>>>>>>>>>
48861>>>>>>>>>>>>>>>        // Gplan.Gplan_Descr2
48861>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Descr2 To (sl150(Self))
48862>>>>>>>>>>>>>>>
48862>>>>>>>>>>>>>>>        // Gplan.Gplan_Bathmos
48862>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Bathmos To "Calulated"
48862>>>>>>>>>>>>>>>
48862>>>>>>>>>>>>>>>        // Gplan.Gplan_Anoep
48862>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Anoep To "Calulated"
48862>>>>>>>>>>>>>>>
48862>>>>>>>>>>>>>>>        // Gplan.Gplan_O_Code
48862>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_O_Code To "dbComboFormSub"
48863>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_O_Code To (Gplan_Gplan_O_Code_VT(Self))
48864>>>>>>>>>>>>>>>
48864>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Xfer
48864>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Xfer To "dbComboFormSub"
48865>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Xfer To (Gplan_Gplan_Yn_VT(Self))
48866>>>>>>>>>>>>>>>
48866>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Last
48866>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Last To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1013)"
48866>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Last To "dbComboFormSub"
48867>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Last To (Gplan_Gplan_Yn_VT(Self))
48868>>>>>>>>>>>>>>>
48868>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Kin
48868>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Kin To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1014)"
48868>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Kin To "dbComboFormSub"
48869>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Kin To (Gplan_Gplan_Yn_VT(Self))
48870>>>>>>>>>>>>>>>
48870>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Kk
48870>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Kk To "dbComboFormSub"
48871>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Kk To (Gplan_Gplan_Yn_VT(Self))
48872>>>>>>>>>>>>>>>
48872>>>>>>>>>>>>>>>        // Gplan.Gplan_Xpm
48872>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Xpm To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1015+1016)"
48872>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Xpm To "dbComboFormSub"
48873>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Xpm To (Gplan_Gplan_Xpm_VT(Self))
48874>>>>>>>>>>>>>>>
48874>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Xy
48874>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Xy To "•¨ž© £¦§¦ œå«˜  ©«ž¤ private.trexe «¦¬ Gmove (1017)"
48874>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Xy To "dbComboFormSub"
48875>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Xy To (Gplan_Gplan_Yn_VT(Self))
48876>>>>>>>>>>>>>>>
48876>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Py
48876>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Py To "•¨ž© £¦§¦ œå«˜  ©«ž¤ private.trexe «¦¬ Gmove (1018)"
48876>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Py To "dbComboFormSub"
48877>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Py To (Gplan_Gplan_Yn_VT(Self))
48878>>>>>>>>>>>>>>>
48878>>>>>>>>>>>>>>>        // Gplan.Gplan_Fpaent
48878>>>>>>>>>>>>>>>
48878>>>>>>>>>>>>>>>        // Gplan.Gplan_Fpaent_Yn
48878>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Fpaent_Yn To (Gplan_Gplan_Yn_VT(Self))
48879>>>>>>>>>>>>>>>
48879>>>>>>>>>>>>>>>        // Gplan.Gplan_Afm
48879>>>>>>>>>>>>>>>
48879>>>>>>>>>>>>>>>        // Gplan.Gplan_Addr
48879>>>>>>>>>>>>>>>
48879>>>>>>>>>>>>>>>        // Gplan.Gplan_Tk
48879>>>>>>>>>>>>>>>
48879>>>>>>>>>>>>>>>        // Gplan.Gplan_Poli
48879>>>>>>>>>>>>>>>
48879>>>>>>>>>>>>>>>        // Gplan.Gplan_Doy
48879>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Doy To "dbComboFormSub"
48880>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Doy To (Gplan_Gplan_Doy_VT(Self))
48881>>>>>>>>>>>>>>>
48881>>>>>>>>>>>>>>>        // Gplan.Gplan_J_Code
48881>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_J_Code To "dbComboFormSub"
48882>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_J_Code To (Gplan_Gplan_J_Code_VT(Self))
48883>>>>>>>>>>>>>>>
48883>>>>>>>>>>>>>>>        // Gplan.Gplan_C_Code2
48883>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_C_Code2 To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1019)"
48883>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_C_Code2 To "dbComboFormSub"
48884>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_C_Code2 To (Gplan_Gplan_C_Code2_VT(Self))
48885>>>>>>>>>>>>>>>
48885>>>>>>>>>>>>>>>        // Gplan.Gplan_Tel
48885>>>>>>>>>>>>>>>
48885>>>>>>>>>>>>>>>        // Gplan.Gplan_Email
48885>>>>>>>>>>>>>>>
48885>>>>>>>>>>>>>>>        // Gplan.Gplan_Resp
48885>>>>>>>>>>>>>>>
48885>>>>>>>>>>>>>>>        // Gplan.Gplan_Bitmap
48885>>>>>>>>>>>>>>>
48885>>>>>>>>>>>>>>>        // Gplan.Gplan_Rep_Code
48885>>>>>>>>>>>>>>>
48885>>>>>>>>>>>>>>>        // Gplan.Gplan_Rep_Pct
48885>>>>>>>>>>>>>>>
48885>>>>>>>>>>>>>>>        // Gplan.Gplan_I_Xy_Code
48885>>>>>>>>>>>>>>>
48885>>>>>>>>>>>>>>>        // Gplan.Gplan_I_Py_Code
48885>>>>>>>>>>>>>>>
48885>>>>>>>>>>>>>>>        // Gplan.Gplan_I_Ctypkin
48885>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_I_Ctypkin To (Gtypkin(Self))
48886>>>>>>>>>>>>>>>
48886>>>>>>>>>>>>>>>        // Gplan.Gplan_I_A_Code
48886>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_I_A_Code To "dbComboFormSub"
48887>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_I_A_Code To (Gplan_Gplan_I_A_Code_VT2(Self))
48888>>>>>>>>>>>>>>>
48888>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Myfp
48888>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Myfp To "dbComboFormSub"
48889>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Myfp To (Gplan_Gplan_Yn_VT(Self))
48890>>>>>>>>>>>>>>>
48890>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Myfa
48890>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Myfa To "dbComboFormSub"
48891>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Myfa To (Gplan_Gplan_Yn_VT(Self))
48892>>>>>>>>>>>>>>>
48892>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfnump
48892>>>>>>>>>>>>>>>
48892>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfvalp
48892>>>>>>>>>>>>>>>
48892>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfnuma
48892>>>>>>>>>>>>>>>
48892>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfvala
48892>>>>>>>>>>>>>>>
48892>>>>>>>>>>>>>>>        // Gplan.Gplan_Myf_Sump
48892>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Myf_Sump To "‰˜Ÿ¦¨åœ  œá¤ ¦  ®¨œé©œ ª/§ ©«é©œ ª Ÿ˜ ˜Ÿ¨¦ ©«¦ç¤ ©«ž¤ ‹“”"
48892>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Myf_Sump To "dbComboFormSub"
48893>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Myf_Sump To (Gplan_Gplan_Myf_Sum_VT(Self))
48894>>>>>>>>>>>>>>>
48894>>>>>>>>>>>>>>>        // Gplan.Gplan_Myf_Suma
48894>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Myf_Suma To "dbComboFormSub"
48895>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Myf_Suma To (Gplan_Gplan_Myf_Sum_VT(Self))
48896>>>>>>>>>>>>>>>
48896>>>>>>>>>>>>>>>        // Gplan.Gplan_Sx0
48896>>>>>>>>>>>>>>>
48896>>>>>>>>>>>>>>>        // Gplan.Gplan_Sp0
48896>>>>>>>>>>>>>>>
48896>>>>>>>>>>>>>>>        // Gplan.Gplan_Sx00
48896>>>>>>>>>>>>>>>
48896>>>>>>>>>>>>>>>        // Gplan.Gplan_Sp00
48896>>>>>>>>>>>>>>>
48896>>>>>>>>>>>>>>>        // Gplan.Gplan_Sxr
48896>>>>>>>>>>>>>>>
48896>>>>>>>>>>>>>>>        // Gplan.Gplan_Spr
48896>>>>>>>>>>>>>>>
48896>>>>>>>>>>>>>>>        // Gplan.Gplan_Sx2
48896>>>>>>>>>>>>>>>
48896>>>>>>>>>>>>>>>        // Gplan.Gplan_Sp2
48896>>>>>>>>>>>>>>>
48896>>>>>>>>>>>>>>>        // Gplan.Gplan_Gmhnnorec
48896>>>>>>>>>>>>>>>
48896>>>>>>>>>>>>>>>        // Gplan.Gplan_Recr
48896>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Recr To (sl150(Self))
48897>>>>>>>>>>>>>>>
48897>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
48897>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
48898>>>>>>>>>>>>>>>
48898>>>>>>>>>>>>>>>    // Field_Defaults:
48898>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
48898>>>>>>>>>>>>>>>
48898>>>>>>>>>>>>>>>    Procedure Field_Defaults
48899>>>>>>>>>>>>>>>        Forward Send Field_Defaults
48901>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48901>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
48901>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Xfer To 0
48902>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Last To 0
48903>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Kin To 1
48904>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Kk To 0
48905>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Xpm To 3
48906>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Xy To 1
48907>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Py To 1
48908>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Fpaent_Yn To 0
48909>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Rep_Pct To 100
48910>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Myfp To 0
48911>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Myfa To 0
48912>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
48912>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
48913>>>>>>>>>>>>>>>End_Class    // Gplan_DataDictionary
48914>>>>>>>>>>>>>>>
48914>>>>>>>>>>>>>>>
48914>>>>>>>>>>>>>>>
48914>>>>>>>>>>>>>>>
48914>>>>>>>>>>>>>>>
48914>>>>>>>>>>>>>>>
48914>>>>>>>>>>>>>>>
48914>>>>>>>>>>>>>>>
48914>>>>>>>>>>>>>>>
48914>>>>>>>>>>>>>>>
48914>>>>>>>>>>>>>>>
48914>>>>>>>>>>>>>>>
48914>>>>>>>>>>>>>>>
48914>>>>>>>>>>>>>>>
48914>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
48914>>>>>>>>>>>>>>>
48914>>>>>>>>>>>>>>>Use sl150.sl         // sl150
48914>>>>>>>>>>>>>>>Use Gtypkin.sl       // Gtypkin
INCLUDING FILE: GTYPKIN.SL
48914>>>>>>>>>>>>>>>>>//AB/ Project gtypkin:Gtypkin
48914>>>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
48914>>>>>>>>>>>>>>>>>//AB/         Set ProjectName to "gtypkin:Gtypkin"
48914>>>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "gtypkin.SL"
48914>>>>>>>>>>>>>>>>>
48914>>>>>>>>>>>>>>>>>// Project Object Structure
48914>>>>>>>>>>>>>>>>>//   gtypkin is a dbModalPanel
48914>>>>>>>>>>>>>>>>>//     Gthhmgio_DD is a DataDictionary
48914>>>>>>>>>>>>>>>>>//     Gtypkin_DD is a DataDictionary
48914>>>>>>>>>>>>>>>>>//     oSelList is a dbList
48914>>>>>>>>>>>>>>>>>//     oOK_bn is a Button
48914>>>>>>>>>>>>>>>>>//     oCancel_bn is a Button
48914>>>>>>>>>>>>>>>>>//     oSearch_bn is a Button
48914>>>>>>>>>>>>>>>>>
48914>>>>>>>>>>>>>>>>>// Register all objects
48914>>>>>>>>>>>>>>>>>Register_Object Gthhmgio_DD
48914>>>>>>>>>>>>>>>>>Register_Object Gtypkin_DD
48914>>>>>>>>>>>>>>>>>Register_Object gtypkin
48914>>>>>>>>>>>>>>>>>Register_Object oCancel_bn
48914>>>>>>>>>>>>>>>>>Register_Object oOK_bn
48914>>>>>>>>>>>>>>>>>Register_Object oSearch_bn
48914>>>>>>>>>>>>>>>>>Register_Object oSelList
48914>>>>>>>>>>>>>>>>>
48914>>>>>>>>>>>>>>>>>
48914>>>>>>>>>>>>>>>>>    //AB-IgnoreStart
48914>>>>>>>>>>>>>>>>>
48914>>>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
48914>>>>>>>>>>>>>>>>>
48914>>>>>>>>>>>>>>>>>
48914>>>>>>>>>>>>>>>>>    Use GTHHMGIO.DD
INCLUDING FILE: GTHHMGIO.DD
48914>>>>>>>>>>>>>>>>>>>//DDB-FileStart
48914>>>>>>>>>>>>>>>>>>>//DDB-HeaderStart
48914>>>>>>>>>>>>>>>>>>>
48914>>>>>>>>>>>>>>>>>>>// File Name : GTHHMGIO.DD
48914>>>>>>>>>>>>>>>>>>>// Class Name: Gthhmgio_DataDictionary
48914>>>>>>>>>>>>>>>>>>>// Revision  : 33
48914>>>>>>>>>>>>>>>>>>>// Version   : 2
48914>>>>>>>>>>>>>>>>>>>
48914>>>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
48914>>>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
48914>>>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48914>>>>>>>>>>>>>>>>>>>
48914>>>>>>>>>>>>>>>>>>>Open Gthhmgio
INCLUDING FILE: GTHHMGIO.FD
48916>>>>>>>>>>>>>>>>>>>Open Gtypkin
48918>>>>>>>>>>>>>>>>>>>Open Gthaa
INCLUDING FILE: GTHAA.FD
48920>>>>>>>>>>>>>>>>>>>Open Sysrecg
48922>>>>>>>>>>>>>>>>>>>
48922>>>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
48922>>>>>>>>>>>>>>>>>>>//DDB-ValidationStart
48922>>>>>>>>>>>>>>>>>>>
48922>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio_Gthhmgio_Period_VT
48922>>>>>>>>>>>>>>>>>>>
48922>>>>>>>>>>>>>>>>>>>Object Gthhmgio_Gthhmgio_Period_VT  is a CodeValidationTable
48924>>>>>>>>>>>>>>>>>>>    Set Type_Value        To "PERIOD"
48925>>>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
48925>>>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
48925>>>>>>>>>>>>>>>>>>>End_Object   // Gthhmgio_Gthhmgio_Period_VT
48926>>>>>>>>>>>>>>>>>>>//DDB-ValidationEnd
48926>>>>>>>>>>>>>>>>>>>//DDB-SelectionStart
48926>>>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList Gthhmgio  Gthhmgio.SL
48926>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio
48926>>>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
48926>>>>>>>>>>>>>>>>>>>
48926>>>>>>>>>>>>>>>>>>>Class Gthhmgio_DataDictionary  is a DataDictionary_Sec
48927>>>>>>>>>>>>>>>>>>>
48927>>>>>>>>>>>>>>>>>>>
48927>>>>>>>>>>>>>>>>>>>    // Define_Fields:
48927>>>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48927>>>>>>>>>>>>>>>>>>>
48927>>>>>>>>>>>>>>>>>>>    Procedure Define_Fields
48928>>>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
48930>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48930>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
48930>>>>>>>>>>>>>>>>>>>
48930>>>>>>>>>>>>>>>>>>>        Set Main_File            To Gthhmgio.File_Number
48931>>>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
48932>>>>>>>>>>>>>>>>>>>
48932>>>>>>>>>>>>>>>>>>>
48932>>>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
48932>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gtypkin.File_Number
48933>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gthaa.File_Number
48934>>>>>>>>>>>>>>>>>>>
48934>>>>>>>>>>>>>>>>>>>        // External (System) file structure.............
48934>>>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
48935>>>>>>>>>>>>>>>>>>>
48935>>>>>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gthhmgio_Rec0  To Gthhmgio.Gthhmgio_Rec0
48938>>>>>>>>>>>>>>>>>>>
48938>>>>>>>>>>>>>>>>>>>        // Field-based properties.......................
48938>>>>>>>>>>>>>>>>>>>
48938>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Code
48938>>>>>>>>>>>>>>>>>>>        Set Field_Options          Field Gthhmgio.Gthhmgio_Code To DD_AUTOFIND   
48939>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gthhmgio.Gthhmgio_Code To (Gthhmgio(Self))
48940>>>>>>>>>>>>>>>>>>>        Set Key_Field_State        Field Gthhmgio.Gthhmgio_Code To TRUE
48941>>>>>>>>>>>>>>>>>>>
48941>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Rec0
48941>>>>>>>>>>>>>>>>>>>
48941>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Descr
48941>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gthhmgio.Gthhmgio_Descr To (Gthhmgio(Self))
48942>>>>>>>>>>>>>>>>>>>
48942>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Period
48942>>>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gthhmgio.Gthhmgio_Period To (Gthhmgio_Gthhmgio_Period_VT(Self))
48943>>>>>>>>>>>>>>>>>>>
48943>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Recr
48943>>>>>>>>>>>>>>>>>>>        Set Field_Options          Field Gthhmgio.Gthhmgio_Recr To DD_AUTOFIND   
48944>>>>>>>>>>>>>>>>>>>        Set Key_Field_State        Field Gthhmgio.Gthhmgio_Recr To TRUE
48945>>>>>>>>>>>>>>>>>>>
48945>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
48945>>>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
48946>>>>>>>>>>>>>>>>>>>
48946>>>>>>>>>>>>>>>>>>>    // Field_Defaults:
48946>>>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
48946>>>>>>>>>>>>>>>>>>>
48946>>>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
48947>>>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
48949>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48949>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
48949>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
48949>>>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
48950>>>>>>>>>>>>>>>>>>>End_Class    // Gthhmgio_DataDictionary
48951>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
48951>>>>>>>>>>>>>>>>>>>
48951>>>>>>>>>>>>>>>>>>>Use Gthhmgio.SL      // Gthhmgio
INCLUDING FILE: GTHHMGIO.SL
48951>>>>>>>>>>>>>>>>>>>>>//AB/ Project Gthhmgio:Gthhmgio
48951>>>>>>>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
48951>>>>>>>>>>>>>>>>>>>>>//AB/         Set ProjectName to "Gthhmgio:Gthhmgio"
48951>>>>>>>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "Gthhmgio.SL"
48951>>>>>>>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
48951>>>>>>>>>>>>>>>>>>>>>
48951>>>>>>>>>>>>>>>>>>>>>// Project Object Structure
48951>>>>>>>>>>>>>>>>>>>>>//   Gthhmgio is a dbModalPanel
48951>>>>>>>>>>>>>>>>>>>>>//     Gthhmgio_DD is a DataDictionary
48951>>>>>>>>>>>>>>>>>>>>>//     oSelList is a dbList
48951>>>>>>>>>>>>>>>>>>>>>//     oOK_bn is a Button
48951>>>>>>>>>>>>>>>>>>>>>//     oCancel_bn is a Button
48951>>>>>>>>>>>>>>>>>>>>>//     oSearch_bn is a Button
48951>>>>>>>>>>>>>>>>>>>>>
48951>>>>>>>>>>>>>>>>>>>>>// Register all objects
48951>>>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio_DD
48951>>>>>>>>>>>>>>>>>>>>>Register_Object oCancel_bn
48951>>>>>>>>>>>>>>>>>>>>>Register_Object oOK_bn
48951>>>>>>>>>>>>>>>>>>>>>Register_Object oSearch_bn
48951>>>>>>>>>>>>>>>>>>>>>Register_Object oSelList
48951>>>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio
48951>>>>>>>>>>>>>>>>>>>>>
48951>>>>>>>>>>>>>>>>>>>>>
48951>>>>>>>>>>>>>>>>>>>>>    //AB-IgnoreStart
48951>>>>>>>>>>>>>>>>>>>>>
48951>>>>>>>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
48951>>>>>>>>>>>>>>>>>>>>>
48951>>>>>>>>>>>>>>>>>>>>>
48951>>>>>>>>>>>>>>>>>>>>>    Use GTHHMGIO.DD
48951>>>>>>>>>>>>>>>>>>>>>
48951>>>>>>>>>>>>>>>>>>>>>    //AB-IgnoreEnd
48951>>>>>>>>>>>>>>>>>>>>>
48951>>>>>>>>>>>>>>>>>>>>>    CD_Popup_Object Gthhmgio is a dbModalPanel
48970>>>>>>>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
48971>>>>>>>>>>>>>>>>>>>>>        Set Label to "Šå©«˜ †£œ¨¦¢¦šåà¤"
48972>>>>>>>>>>>>>>>>>>>>>        Set Size to 148 297
48973>>>>>>>>>>>>>>>>>>>>>        Set Location to 4 5
48974>>>>>>>>>>>>>>>>>>>>>
48974>>>>>>>>>>>>>>>>>>>>>        //AB-DDOStart
48974>>>>>>>>>>>>>>>>>>>>>
48974>>>>>>>>>>>>>>>>>>>>>        Object Gthhmgio_DD is a Gthhmgio_DataDictionary
48976>>>>>>>>>>>>>>>>>>>>>        End_Object    // Gthhmgio_DD
48977>>>>>>>>>>>>>>>>>>>>>
48977>>>>>>>>>>>>>>>>>>>>>        Set Main_DD to (Gthhmgio_DD(self))
48978>>>>>>>>>>>>>>>>>>>>>        Set Server to (Gthhmgio_DD(self))
48979>>>>>>>>>>>>>>>>>>>>>
48979>>>>>>>>>>>>>>>>>>>>>        //AB-DDOEnd
48979>>>>>>>>>>>>>>>>>>>>>
48979>>>>>>>>>>>>>>>>>>>>>        Object oSelList is a dbList
48981>>>>>>>>>>>>>>>>>>>>>            Set Main_File to Gthhmgio.File_Number
48982>>>>>>>>>>>>>>>>>>>>>            Set Size to 105 280
48983>>>>>>>>>>>>>>>>>>>>>            Set Location to 6 6
48984>>>>>>>>>>>>>>>>>>>>>
48984>>>>>>>>>>>>>>>>>>>>>            Begin_Row
48987>>>>>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_code
48988>>>>>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_descr
48989>>>>>>>>>>>>>>>>>>>>>            End_Row
48994>>>>>>>>>>>>>>>>>>>>>
48994>>>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 52
48995>>>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
48996>>>>>>>>>>>>>>>>>>>>>
48996>>>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 220
48997>>>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
48998>>>>>>>>>>>>>>>>>>>>>
48998>>>>>>>>>>>>>>>>>>>>>        End_Object    // oSelList
48999>>>>>>>>>>>>>>>>>>>>>
48999>>>>>>>>>>>>>>>>>>>>>        Object oOK_bn is a Button
49001>>>>>>>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
49002>>>>>>>>>>>>>>>>>>>>>            Set Location to 111 127
49003>>>>>>>>>>>>>>>>>>>>>
49003>>>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
49003>>>>>>>>>>>>>>>>>>>>>            Procedure OnClick
49005>>>>>>>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
49006>>>>>>>>>>>>>>>>>>>>>            End_Procedure
49007>>>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
49007>>>>>>>>>>>>>>>>>>>>>
49007>>>>>>>>>>>>>>>>>>>>>        End_Object    // oOK_bn
49008>>>>>>>>>>>>>>>>>>>>>
49008>>>>>>>>>>>>>>>>>>>>>        Object oCancel_bn is a Button
49010>>>>>>>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
49011>>>>>>>>>>>>>>>>>>>>>            Set Location to 111 181
49012>>>>>>>>>>>>>>>>>>>>>
49012>>>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
49012>>>>>>>>>>>>>>>>>>>>>            Procedure OnClick
49014>>>>>>>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
49015>>>>>>>>>>>>>>>>>>>>>            End_Procedure
49016>>>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
49016>>>>>>>>>>>>>>>>>>>>>
49016>>>>>>>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
49017>>>>>>>>>>>>>>>>>>>>>
49017>>>>>>>>>>>>>>>>>>>>>        Object oSearch_bn is a Button
49019>>>>>>>>>>>>>>>>>>>>>            Set Label to "&€¤˜ã«ž©ž..."
49020>>>>>>>>>>>>>>>>>>>>>            Set Location to 111 237
49021>>>>>>>>>>>>>>>>>>>>>
49021>>>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
49021>>>>>>>>>>>>>>>>>>>>>            Procedure OnClick
49023>>>>>>>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
49024>>>>>>>>>>>>>>>>>>>>>            End_Procedure
49025>>>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
49025>>>>>>>>>>>>>>>>>>>>>
49025>>>>>>>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
49026>>>>>>>>>>>>>>>>>>>>>
49026>>>>>>>>>>>>>>>>>>>>>
49026>>>>>>>>>>>>>>>>>>>>>        //AB-StoreStart
49026>>>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
49027>>>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
49028>>>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
49029>>>>>>>>>>>>>>>>>>>>>        //AB-StoreEnd
49029>>>>>>>>>>>>>>>>>>>>>
49029>>>>>>>>>>>>>>>>>>>>>    CD_End_Object    // Gthhmgio
49031>>>>>>>>>>>>>>>>>>>>>>
49031>>>>>>>>>>>>>>>>>>>>>
49031>>>>>>>>>>>>>>>>>>>>>//AB/     End_Object    // prj
49031>>>>>>>>>>>>>>>>>>>
49031>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
49031>>>>>>>>>>>>>>>>>>>//DDB-FileEnd
49031>>>>>>>>>>>>>>>>>    Use GTYPKIN.DD
INCLUDING FILE: GTYPKIN.DD
49031>>>>>>>>>>>>>>>>>>>//DDB-FileStart
49031>>>>>>>>>>>>>>>>>>>//DDB-HeaderStart
49031>>>>>>>>>>>>>>>>>>>
49031>>>>>>>>>>>>>>>>>>>// File Name : GTYPKIN.DD
49031>>>>>>>>>>>>>>>>>>>// Class Name: Gtypkin_DataDictionary
49031>>>>>>>>>>>>>>>>>>>// Revision  : 45
49031>>>>>>>>>>>>>>>>>>>// Version   : 2
49031>>>>>>>>>>>>>>>>>>>
49031>>>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
49031>>>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
49031>>>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49031>>>>>>>>>>>>>>>>>>>
49031>>>>>>>>>>>>>>>>>>>Open Gtypkin
49033>>>>>>>>>>>>>>>>>>>Open Garticl
49035>>>>>>>>>>>>>>>>>>>Open Gflagkin
INCLUDING FILE: GFLAGKIN.FD
49037>>>>>>>>>>>>>>>>>>>Open Gparticl
INCLUDING FILE: GPARTICL.FD
49039>>>>>>>>>>>>>>>>>>>Open Gthhmgio
49041>>>>>>>>>>>>>>>>>>>Open Sysrecg
49043>>>>>>>>>>>>>>>>>>>
49043>>>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
49043>>>>>>>>>>>>>>>>>>>//DDB-SelectionStart
49043>>>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList gtypkin  gtypkin.SL
49043>>>>>>>>>>>>>>>>>>>Register_Object gtypkin
49043>>>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
49043>>>>>>>>>>>>>>>>>>>Open SysCurGL
49045>>>>>>>>>>>>>>>>>>>
49045>>>>>>>>>>>>>>>>>>>Class Gtypkin_DataDictionary  is a DataDictionary_Sec
49046>>>>>>>>>>>>>>>>>>>
49046>>>>>>>>>>>>>>>>>>>    Procedure Entry_Order_Date  Integer iField  Date dDate
49047>>>>>>>>>>>>>>>>>>>         // Add a default date if the field is blank
49047>>>>>>>>>>>>>>>>>>>         Integer Changed
49048>>>>>>>>>>>>>>>>>>>         Get Field_Changed_State iField to Changed
49049>>>>>>>>>>>>>>>>>>>         If (Changed=0 AND dDate =0) Begin
49051>>>>>>>>>>>>>>>>>>>             SysDate4 dDate
49052>>>>>>>>>>>>>>>>>>>             Set Field_Default_Value iField to dDate
49053>>>>>>>>>>>>>>>>>>>         End
49053>>>>>>>>>>>>>>>>>>>>
49053>>>>>>>>>>>>>>>>>>>    End_Procedure
49054>>>>>>>>>>>>>>>>>>>
49054>>>>>>>>>>>>>>>>>>>    Procedure Construct_Object
49055>>>>>>>>>>>>>>>>>>>        Forward Send Construct_Object
49057>>>>>>>>>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
49058>>>>>>>>>>>>>>>>>>>        Property Date    pdDefault_Hmnia    Public 0
49059>>>>>>>>>>>>>>>>>>>        Property Integer piRate             Public 0
49060>>>>>>>>>>>>>>>>>>>        Property Integer piGthhmgio_dd      Public 0
49061>>>>>>>>>>>>>>>>>>>    End_Procedure   // Construct_Object
49062>>>>>>>>>>>>>>>>>>>
49062>>>>>>>>>>>>>>>>>>>//    Procedure OnConstrain
49062>>>>>>>>>>>>>>>>>>>//        Forward Send OnConstrain
49062>>>>>>>>>>>>>>>>>>>//        If (piMustNOTConstrain(Self)) Begin
49062>>>>>>>>>>>>>>>>>>>//        End
49062>>>>>>>>>>>>>>>>>>>//        Else Begin
49062>>>>>>>>>>>>>>>>>>>//            Constrain Gtypkin.Company_Code  eq SysCurGL.Company_Code
49062>>>>>>>>>>>>>>>>>>>//            Constrain Gtypkin.Branch_Code   eq SysCurGL.Branch_Code
49062>>>>>>>>>>>>>>>>>>>//            Constrain Gtypkin.Year_Year     eq SysCurGL.Year_Year
49062>>>>>>>>>>>>>>>>>>>//        End
49062>>>>>>>>>>>>>>>>>>>//    End_Procedure
49062>>>>>>>>>>>>>>>>>>>
49062>>>>>>>>>>>>>>>>>>>    Procedure Update
49063>>>>>>>>>>>>>>>>>>>        Forward Send Update
49065>>>>>>>>>>>>>>>>>>>        // Insert Code Here
49065>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Company_Code  to Gtypkin.Company_Code
49066>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Branch_Code   to Gtypkin.Branch_Code
49067>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Year_Year     to Gtypkin.Year_Year
49068>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Year_Recr     to Gtypkin.Year_Recr
49069>>>>>>>>>>>>>>>>>>>        Move Gthhmgio.Gthhmgio_Code to Gtypkin.Gthhmgio_Code
49070>>>>>>>>>>>>>>>>>>>    End_Procedure   // Update
49071>>>>>>>>>>>>>>>>>>>
49071>>>>>>>>>>>>>>>>>>>    Procedure Creating
49072>>>>>>>>>>>>>>>>>>>        Forward Send Creating
49074>>>>>>>>>>>>>>>>>>>        // Insert Code Here
49074>>>>>>>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurGL.Branch_Site))+;                         (Trim(String(Gtypkin.Gtypkin_Rec0)))))) to Gtypkin.Gtypkin_Recr
49075>>>>>>>>>>>>>>>>>>>    End_Procedure   // Creating
49076>>>>>>>>>>>>>>>>>>>
49076>>>>>>>>>>>>>>>>>>>
49076>>>>>>>>>>>>>>>>>>>
49076>>>>>>>>>>>>>>>>>>>//----------------------------------------------------------------------------
49076>>>>>>>>>>>>>>>>>>>
49076>>>>>>>>>>>>>>>>>>>//    Procedure Creating
49076>>>>>>>>>>>>>>>>>>>//              Forward Send Creating
49076>>>>>>>>>>>>>>>>>>>//              Add 1 to Year.Year_NumGtypkin //˜¨ Ÿ£æª «ç§à¤ ¡ ¤ã©œà¤ «žª ®¨ã©žª
49076>>>>>>>>>>>>>>>>>>>//    End_Procedure //creating
49076>>>>>>>>>>>>>>>>>>>//    Procedure Deleting
49076>>>>>>>>>>>>>>>>>>>//              Forward Send Deleting
49076>>>>>>>>>>>>>>>>>>>//              Sub 1 from Year.Year_NumGtypkin //˜¨ Ÿ£æª «ç§à¤ ¡ ¤ã©œà¤ «žª ®¨ã©žª
49076>>>>>>>>>>>>>>>>>>>//    End_Procedure //deleting
49076>>>>>>>>>>>>>>>>>>>
49076>>>>>>>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
49077>>>>>>>>>>>>>>>>>>>        Integer iReturnVal
49078>>>>>>>>>>>>>>>>>>>        Forward Get Validate_Save To iReturnVal
49080>>>>>>>>>>>>>>>>>>>//        If (Not(iReturnVal)) Begin
49080>>>>>>>>>>>>>>>>>>>//            //1100:cby = globals
49080>>>>>>>>>>>>>>>>>>>//            If ( ;
49080>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Company_Code = SysCurGL.Company_Code)) or;
49080>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Branch_Code  = SysCurGL.Branch_Code )) or;
49080>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Year_Year    = SysCurGL.Year_Year   ));
49080>>>>>>>>>>>>>>>>>>>//                ) Send Operation_Not_Allowed 1100
49080>>>>>>>>>>>>>>>>>>>//        End
49080>>>>>>>>>>>>>>>>>>>        Function_Return iReturnVal
49081>>>>>>>>>>>>>>>>>>>    End_Function   //validate_save
49082>>>>>>>>>>>>>>>>>>>
49082>>>>>>>>>>>>>>>>>>>
49082>>>>>>>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
49083>>>>>>>>>>>>>>>>>>>        Integer iReturnVal
49084>>>>>>>>>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
49086>>>>>>>>>>>>>>>>>>>//        If (Not(iReturnVal)) Begin
49086>>>>>>>>>>>>>>>>>>>//            //2100:cby = globals
49086>>>>>>>>>>>>>>>>>>>//            If ( ;
49086>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Company_Code = SysCurGL.Company_Code)) or;
49086>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Branch_Code  = SysCurGL.Branch_Code )) or;
49086>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Year_Year    = SysCurGL.Year_Year   ));
49086>>>>>>>>>>>>>>>>>>>//                ) Send Operation_Not_Allowed 2100
49086>>>>>>>>>>>>>>>>>>>//        End
49086>>>>>>>>>>>>>>>>>>>        Function_Return iReturnVal
49087>>>>>>>>>>>>>>>>>>>    End_Function   // validate_delete
49088>>>>>>>>>>>>>>>>>>>
49088>>>>>>>>>>>>>>>>>>>
49088>>>>>>>>>>>>>>>>>>>
49088>>>>>>>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
49089>>>>>>>>>>>>>>>>>>>              Case Begin
49089>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1100)
49091>>>>>>>>>>>>>>>>>>>                        Error 1100 "DDC 151:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
49092>>>>>>>>>>>>>>>>>>>>
49092>>>>>>>>>>>>>>>>>>>                        Case Break
49093>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 2100)
49096>>>>>>>>>>>>>>>>>>>                        Error 2100 "DDC 151:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
49097>>>>>>>>>>>>>>>>>>>>
49097>>>>>>>>>>>>>>>>>>>                        Case Break
49098>>>>>>>>>>>>>>>>>>>                   Case Else
49098>>>>>>>>>>>>>>>>>>>                        Forward Send Operation_Not_Allowed  iError_Num
49100>>>>>>>>>>>>>>>>>>>              Case End
49100>>>>>>>>>>>>>>>>>>>    End_Procedure   //operation_not_allowed
49101>>>>>>>>>>>>>>>>>>>
49101>>>>>>>>>>>>>>>>>>>
49101>>>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
49102>>>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
49104>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
49104>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
49104>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
49104>>>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
49105>>>>>>>>>>>>>>>>>>>
49105>>>>>>>>>>>>>>>>>>>
49105>>>>>>>>>>>>>>>>>>>
49105>>>>>>>>>>>>>>>>>>>    // Define_Fields:
49105>>>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49105>>>>>>>>>>>>>>>>>>>
49105>>>>>>>>>>>>>>>>>>>    Procedure Define_Fields
49106>>>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
49108>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
49108>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
49108>>>>>>>>>>>>>>>>>>>
49108>>>>>>>>>>>>>>>>>>>        Set Main_File            To Gtypkin.File_Number
49109>>>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
49110>>>>>>>>>>>>>>>>>>>
49110>>>>>>>>>>>>>>>>>>>
49110>>>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
49110>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Garticl.File_Number
49111>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gflagkin.File_Number
49112>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gparticl.File_Number
49113>>>>>>>>>>>>>>>>>>>
49113>>>>>>>>>>>>>>>>>>>        // Parent (Server) file structure...............
49113>>>>>>>>>>>>>>>>>>>        Send Add_Server_File  Gthhmgio.File_Number
49114>>>>>>>>>>>>>>>>>>>
49114>>>>>>>>>>>>>>>>>>>        // External (System) file structure.............
49114>>>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
49115>>>>>>>>>>>>>>>>>>>
49115>>>>>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gtypkin_Rec0  To Gtypkin.Gtypkin_Rec0
49118>>>>>>>>>>>>>>>>>>>
49118>>>>>>>>>>>>>>>>>>>        // Field-based properties.......................
49118>>>>>>>>>>>>>>>>>>>
49118>>>>>>>>>>>>>>>>>>>        // Gtypkin.Company_Code
49118>>>>>>>>>>>>>>>>>>>
49118>>>>>>>>>>>>>>>>>>>        // Gtypkin.Branch_Code
49118>>>>>>>>>>>>>>>>>>>
49118>>>>>>>>>>>>>>>>>>>        // Gtypkin.Year_Year
49118>>>>>>>>>>>>>>>>>>>
49118>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Code
49118>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gtypkin.Gtypkin_Code To (gtypkin(Self))
49119>>>>>>>>>>>>>>>>>>>
49119>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Rec0
49119>>>>>>>>>>>>>>>>>>>
49119>>>>>>>>>>>>>>>>>>>        // Gtypkin.Year_Recr
49119>>>>>>>>>>>>>>>>>>>
49119>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gthhmgio_Code
49119>>>>>>>>>>>>>>>>>>>
49119>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gthhmgio_Recr
49119>>>>>>>>>>>>>>>>>>>
49119>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Descr
49119>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gtypkin.Gtypkin_Descr To (gtypkin(Self))
49120>>>>>>>>>>>>>>>>>>>
49120>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Anti
49120>>>>>>>>>>>>>>>>>>>
49120>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Printer
49120>>>>>>>>>>>>>>>>>>>
49120>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Form
49120>>>>>>>>>>>>>>>>>>>
49120>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_L_No
49120>>>>>>>>>>>>>>>>>>>
49120>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_L_Hmnia
49120>>>>>>>>>>>>>>>>>>>
49120>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Seira
49120>>>>>>>>>>>>>>>>>>>
49120>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Abr
49120>>>>>>>>>>>>>>>>>>>
49120>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag01
49120>>>>>>>>>>>>>>>>>>>
49120>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag02
49120>>>>>>>>>>>>>>>>>>>
49120>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag03
49120>>>>>>>>>>>>>>>>>>>
49120>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag04
49120>>>>>>>>>>>>>>>>>>>
49120>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag05
49120>>>>>>>>>>>>>>>>>>>
49120>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag06
49120>>>>>>>>>>>>>>>>>>>
49120>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag07
49120>>>>>>>>>>>>>>>>>>>
49120>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag08
49120>>>>>>>>>>>>>>>>>>>
49120>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag09
49120>>>>>>>>>>>>>>>>>>>
49120>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag10
49120>>>>>>>>>>>>>>>>>>>
49120>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag11
49120>>>>>>>>>>>>>>>>>>>
49120>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag12
49120>>>>>>>>>>>>>>>>>>>
49120>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag13
49120>>>>>>>>>>>>>>>>>>>
49120>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag14
49120>>>>>>>>>>>>>>>>>>>
49120>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag15
49120>>>>>>>>>>>>>>>>>>>
49120>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag16
49120>>>>>>>>>>>>>>>>>>>
49120>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag17
49120>>>>>>>>>>>>>>>>>>>
49120>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag18
49120>>>>>>>>>>>>>>>>>>>
49120>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag19
49120>>>>>>>>>>>>>>>>>>>
49120>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag20
49120>>>>>>>>>>>>>>>>>>>
49120>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Recr
49120>>>>>>>>>>>>>>>>>>>
49120>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
49120>>>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
49121>>>>>>>>>>>>>>>>>>>End_Class    // Gtypkin_DataDictionary
49122>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
49122>>>>>>>>>>>>>>>>>>>
49122>>>>>>>>>>>>>>>>>>>Use gtypkin.SL       // gtypkin
49122>>>>>>>>>>>>>>>>>>>
49122>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
49122>>>>>>>>>>>>>>>>>>>//DDB-FileEnd
49122>>>>>>>>>>>>>>>>>    
49122>>>>>>>>>>>>>>>>>    //AB-IgnoreEnd
49122>>>>>>>>>>>>>>>>>
49122>>>>>>>>>>>>>>>>>    CD_Popup_Object gtypkin is a dbModalPanel
49141>>>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
49142>>>>>>>>>>>>>>>>>        Set Label to "Šå©«˜ ‰ ¤ã©œà¤"
49143>>>>>>>>>>>>>>>>>        Set Size to 171 467
49144>>>>>>>>>>>>>>>>>        Set Location to 4 5
49145>>>>>>>>>>>>>>>>>
49145>>>>>>>>>>>>>>>>>        //AB-DDOStart
49145>>>>>>>>>>>>>>>>>
49145>>>>>>>>>>>>>>>>>        Object Gthhmgio_DD is a Gthhmgio_DataDictionary
49147>>>>>>>>>>>>>>>>>        End_Object    // Gthhmgio_DD
49148>>>>>>>>>>>>>>>>>
49148>>>>>>>>>>>>>>>>>        Object Gtypkin_DD is a Gtypkin_DataDictionary
49150>>>>>>>>>>>>>>>>>            Set DDO_Server to (Gthhmgio_DD(self))
49151>>>>>>>>>>>>>>>>>        End_Object    // Gtypkin_DD
49152>>>>>>>>>>>>>>>>>
49152>>>>>>>>>>>>>>>>>        Set Main_DD to (Gtypkin_DD(self))
49153>>>>>>>>>>>>>>>>>        Set Server to (Gtypkin_DD(self))
49154>>>>>>>>>>>>>>>>>
49154>>>>>>>>>>>>>>>>>        //AB-DDOEnd
49154>>>>>>>>>>>>>>>>>
49154>>>>>>>>>>>>>>>>>        Object oSelList is a dbList
49156>>>>>>>>>>>>>>>>>            Set Main_File to Gtypkin.File_Number
49157>>>>>>>>>>>>>>>>>            Set Size to 132 450
49158>>>>>>>>>>>>>>>>>            Set Location to 6 6
49159>>>>>>>>>>>>>>>>>
49159>>>>>>>>>>>>>>>>>            Begin_Row
49162>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_code
49163>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_descr
49164>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_abr
49165>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_seira
49166>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_code
49167>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_descr
49168>>>>>>>>>>>>>>>>>            End_Row
49173>>>>>>>>>>>>>>>>>
49173>>>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 40
49174>>>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
49175>>>>>>>>>>>>>>>>>            
49175>>>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 150
49176>>>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
49177>>>>>>>>>>>>>>>>>            
49177>>>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 68
49178>>>>>>>>>>>>>>>>>            Set Header_Label  item 2 to "‘¬¤«¦£¦š¨˜­å˜"
49179>>>>>>>>>>>>>>>>>            
49179>>>>>>>>>>>>>>>>>            Set Form_Width    item 3 to 30
49180>>>>>>>>>>>>>>>>>            Set Header_Label  item 3 to "‘œ ¨á"
49181>>>>>>>>>>>>>>>>>            
49181>>>>>>>>>>>>>>>>>            Set Form_Width    item 4 to 55
49182>>>>>>>>>>>>>>>>>            Set Header_Label  item 4 to "‰à› ¡æª †£/š ¦¬"
49183>>>>>>>>>>>>>>>>>            
49183>>>>>>>>>>>>>>>>>            Set Form_Width    item 5 to 99
49184>>>>>>>>>>>>>>>>>            Set Header_Label  item 5 to "œ¨ š¨˜­ã †£/šå¦¬"
49185>>>>>>>>>>>>>>>>>            
49185>>>>>>>>>>>>>>>>>        End_Object    // oSelList
49186>>>>>>>>>>>>>>>>>
49186>>>>>>>>>>>>>>>>>        Object oOK_bn is a Button
49188>>>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
49189>>>>>>>>>>>>>>>>>            Set Location to 140 298
49190>>>>>>>>>>>>>>>>>
49190>>>>>>>>>>>>>>>>>            //AB-StoreStart
49190>>>>>>>>>>>>>>>>>            Procedure OnClick
49192>>>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
49193>>>>>>>>>>>>>>>>>            End_Procedure
49194>>>>>>>>>>>>>>>>>            //AB-StoreEnd
49194>>>>>>>>>>>>>>>>>
49194>>>>>>>>>>>>>>>>>        End_Object    // oOK_bn
49195>>>>>>>>>>>>>>>>>
49195>>>>>>>>>>>>>>>>>        Object oCancel_bn is a Button
49197>>>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
49198>>>>>>>>>>>>>>>>>            Set Location to 140 353
49199>>>>>>>>>>>>>>>>>
49199>>>>>>>>>>>>>>>>>            //AB-StoreStart
49199>>>>>>>>>>>>>>>>>            Procedure OnClick
49201>>>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
49202>>>>>>>>>>>>>>>>>            End_Procedure
49203>>>>>>>>>>>>>>>>>            //AB-StoreEnd
49203>>>>>>>>>>>>>>>>>
49203>>>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
49204>>>>>>>>>>>>>>>>>
49204>>>>>>>>>>>>>>>>>        Object oSearch_bn is a Button
49206>>>>>>>>>>>>>>>>>            Set Label to "&€¤˜ã«ž©ž..."
49207>>>>>>>>>>>>>>>>>            Set Location to 140 408
49208>>>>>>>>>>>>>>>>>
49208>>>>>>>>>>>>>>>>>            //AB-StoreStart
49208>>>>>>>>>>>>>>>>>            Procedure OnClick
49210>>>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
49211>>>>>>>>>>>>>>>>>            End_Procedure
49212>>>>>>>>>>>>>>>>>            //AB-StoreEnd
49212>>>>>>>>>>>>>>>>>
49212>>>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
49213>>>>>>>>>>>>>>>>>
49213>>>>>>>>>>>>>>>>>
49213>>>>>>>>>>>>>>>>>        //AB-StoreStart
49213>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
49214>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
49215>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
49216>>>>>>>>>>>>>>>>>        //AB-StoreEnd
49216>>>>>>>>>>>>>>>>>
49216>>>>>>>>>>>>>>>>>    CD_End_Object    // gtypkin
49218>>>>>>>>>>>>>>>>>>
49218>>>>>>>>>>>>>>>>>
49218>>>>>>>>>>>>>>>>>//AB/     End_Object    // prj
49218>>>>>>>>>>>>>>>
49218>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
49218>>>>>>>>>>>>>>>//DDB-FileEnd
49218>>>>>>>>>>>>>    
49218>>>>>>>>>>>>>    //AB-IgnoreEnd
49218>>>>>>>>>>>>>
49218>>>>>>>>>>>>>    CD_Popup_Object sl150 is a dbModalPanelSub
49237>>>>>>>>>>>>>
49237>>>>>>>>>>>>>        //AB-StoreTopStart
49237>>>>>>>>>>>>>        Property Integer piFragmaLast -1
49239>>>>>>>>>>>>>        Property String  psFragmaFromCode ""
49241>>>>>>>>>>>>>        Property String  psFragmaToCode ""
49243>>>>>>>>>>>>>        
49243>>>>>>>>>>>>>        //AB-StoreTopEnd
49243>>>>>>>>>>>>>
49243>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
49244>>>>>>>>>>>>>        Set Label to "Šå©«˜ Š¦š˜¨ ˜©£é¤"
49245>>>>>>>>>>>>>        Set Size to 204 393
49246>>>>>>>>>>>>>        Set Location to 5 16
49247>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
49248>>>>>>>>>>>>>        Set Modal_State to FALSE
49249>>>>>>>>>>>>>
49249>>>>>>>>>>>>>        //AB-DDOStart
49249>>>>>>>>>>>>>
49249>>>>>>>>>>>>>        Object Gplan_DD is a Gplan_DataDictionary
49251>>>>>>>>>>>>>
49251>>>>>>>>>>>>>            //AB-StoreStart
49251>>>>>>>>>>>>>                        
49251>>>>>>>>>>>>>            Procedure OnConstrain
49253>>>>>>>>>>>>>                Integer liFragmaLast
49254>>>>>>>>>>>>>                String lsFragmaFromCode lsFragmaToCode
49254>>>>>>>>>>>>>                Get piFragmaLast     to liFragmaLast
49255>>>>>>>>>>>>>                Get psFragmaFromCode to lsFragmaFromCode
49256>>>>>>>>>>>>>                Get psFragmaToCode   to lsFragmaToCode
49257>>>>>>>>>>>>>                If (liFragmaLast <> -1)     Constrain Gplan.Gplan_Yn_Last eq liFragmaLast
49261>>>>>>>>>>>>>                If (lsFragmaFromCode <> "") Constrain Gplan.Gplan_Code    ge lsFragmaFromCode
49265>>>>>>>>>>>>>                If (lsFragmaToCode <> "")   Constrain Gplan.Gplan_Code    le lsFragmaToCode
49269>>>>>>>>>>>>>            End_Procedure // OnConstrain
49270>>>>>>>>>>>>>            
49270>>>>>>>>>>>>>            
49270>>>>>>>>>>>>>            //AB-StoreEnd
49270>>>>>>>>>>>>>
49270>>>>>>>>>>>>>        End_Object    // Gplan_DD
49271>>>>>>>>>>>>>
49271>>>>>>>>>>>>>        Set Main_DD to (Gplan_DD(self))
49272>>>>>>>>>>>>>        Set Server to (Gplan_DD(self))
49273>>>>>>>>>>>>>
49273>>>>>>>>>>>>>        //AB-DDOEnd
49273>>>>>>>>>>>>>
49273>>>>>>>>>>>>>        Object oSelList is a dbListSub
49275>>>>>>>>>>>>>            Set Main_File to Gplan.File_Number
49276>>>>>>>>>>>>>            Set Ordering to 3
49277>>>>>>>>>>>>>            Set Size to 164 378
49278>>>>>>>>>>>>>            Set Location to 4 6
49279>>>>>>>>>>>>>
49279>>>>>>>>>>>>>            Begin_Row
49282>>>>>>>>>>>>>                Entry_Item Gplan.Gplan_code
49283>>>>>>>>>>>>>                Entry_Item Gplan.Gplan_descr1
49284>>>>>>>>>>>>>                Entry_Item Gplan.Gplan_bathmos
49285>>>>>>>>>>>>>                Entry_Item Gplan.Gplan_yn_last
49286>>>>>>>>>>>>>            End_Row
49291>>>>>>>>>>>>>
49291>>>>>>>>>>>>>            Set Form_Width    item 0 to 105
49292>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
49293>>>>>>>>>>>>>            
49293>>>>>>>>>>>>>            Set Form_Width    item 1 to 212
49294>>>>>>>>>>>>>            Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
49295>>>>>>>>>>>>>            
49295>>>>>>>>>>>>>            Set Form_Width    item 2 to 34
49296>>>>>>>>>>>>>            Set Header_Label  item 2 to "˜Ÿ£æª"
49297>>>>>>>>>>>>>            
49297>>>>>>>>>>>>>            Set Form_Width    item 3 to 19
49298>>>>>>>>>>>>>            Set Header_Label  item 3 to " ’"
49299>>>>>>>>>>>>>            Set Column_Checkbox_State  item 3 to True
49300>>>>>>>>>>>>>            
49300>>>>>>>>>>>>>
49300>>>>>>>>>>>>>            //AB-StoreStart
49300>>>>>>>>>>>>>                        
49300>>>>>>>>>>>>>            Property String piStoredFragmaLast -1
49302>>>>>>>>>>>>>            Property String psStoredFragmaFromCode ""
49304>>>>>>>>>>>>>            Property String psStoredFragmaToCode ""
49306>>>>>>>>>>>>>            
49306>>>>>>>>>>>>>            Procedure Store_Defaults
49308>>>>>>>>>>>>>                forward send Store_Defaults
49310>>>>>>>>>>>>>                Set piStoredFragmaLast     to (piFragmaLast(Self))
49311>>>>>>>>>>>>>                Set psStoredFragmaFromCode to (psFragmaFromCode(Self))
49312>>>>>>>>>>>>>                Set psStoredFragmaToCode   to (psFragmaToCode(Self))
49313>>>>>>>>>>>>>            end_Procedure // Store_Defaults
49314>>>>>>>>>>>>>            
49314>>>>>>>>>>>>>            Procedure Restore_Defaults
49316>>>>>>>>>>>>>                forward send Restore_Defaults
49318>>>>>>>>>>>>>                Set piFragmaLast     to (piStoredFragmaLast(self))
49319>>>>>>>>>>>>>                Set psFragmaFromCode to (psStoredFragmaFromCode(self))
49320>>>>>>>>>>>>>                Set psFragmaToCode   to (psStoredFragmaToCode(self))
49321>>>>>>>>>>>>>            end_Procedure // Restore_Defaults
49322>>>>>>>>>>>>>            
49322>>>>>>>>>>>>>            Procedure Activating
49324>>>>>>>>>>>>>                Forward Send Activating
49326>>>>>>>>>>>>>                Send Rebuild_Constraints to (Gplan_DD(self))
49327>>>>>>>>>>>>>            End_Procedure // Activating
49328>>>>>>>>>>>>>            
49328>>>>>>>>>>>>>            
49328>>>>>>>>>>>>>            
49328>>>>>>>>>>>>>            
49328>>>>>>>>>>>>>            //AB-StoreEnd
49328>>>>>>>>>>>>>
49328>>>>>>>>>>>>>        End_Object    // oSelList
49329>>>>>>>>>>>>>
49329>>>>>>>>>>>>>        Object oOK_bn is a Button
49331>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
49332>>>>>>>>>>>>>            Set Location to 170 226
49333>>>>>>>>>>>>>
49333>>>>>>>>>>>>>            //AB-StoreStart
49333>>>>>>>>>>>>>            Procedure OnClick
49335>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
49336>>>>>>>>>>>>>            End_Procedure
49337>>>>>>>>>>>>>            //AB-StoreEnd
49337>>>>>>>>>>>>>
49337>>>>>>>>>>>>>        End_Object    // oOK_bn
49338>>>>>>>>>>>>>
49338>>>>>>>>>>>>>        Object oCancel_bn is a Button
49340>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
49341>>>>>>>>>>>>>            Set Location to 170 279
49342>>>>>>>>>>>>>
49342>>>>>>>>>>>>>            //AB-StoreStart
49342>>>>>>>>>>>>>            Procedure OnClick
49344>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
49345>>>>>>>>>>>>>            End_Procedure
49346>>>>>>>>>>>>>            //AB-StoreEnd
49346>>>>>>>>>>>>>
49346>>>>>>>>>>>>>        End_Object    // oCancel_bn
49347>>>>>>>>>>>>>
49347>>>>>>>>>>>>>        Object oSearch_bn is a Button
49349>>>>>>>>>>>>>            Set Label to "&€¤˜ã«ž©ž..."
49350>>>>>>>>>>>>>            Set Location to 170 334
49351>>>>>>>>>>>>>
49351>>>>>>>>>>>>>            //AB-StoreStart
49351>>>>>>>>>>>>>            Procedure OnClick
49353>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
49354>>>>>>>>>>>>>            End_Procedure
49355>>>>>>>>>>>>>            //AB-StoreEnd
49355>>>>>>>>>>>>>
49355>>>>>>>>>>>>>        End_Object    // oSearch_bn
49356>>>>>>>>>>>>>
49356>>>>>>>>>>>>>
49356>>>>>>>>>>>>>        //AB-StoreStart
49356>>>>>>>>>>>>>                
49356>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
49357>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
49358>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
49359>>>>>>>>>>>>>        
49359>>>>>>>>>>>>>        
49359>>>>>>>>>>>>>        
49359>>>>>>>>>>>>>        //AB-StoreEnd
49359>>>>>>>>>>>>>
49359>>>>>>>>>>>>>    CD_End_Object    // sl150
49361>>>>>>>>>>>>>>
49361>>>>>>>>>>>>>
49361>>>>>>>>>>>>>//AB/     End_Object    // prj
49361>>>>>>>>>>>
49361>>>>>>>>>>>//DDB-Selection-pkg-End
49361>>>>>>>>>>>//DDB-FileEnd
49361>>>>>>>>>    Use FPA.DD
INCLUDING FILE: FPA.DD
49361>>>>>>>>>>>//DDB-FileStart
49361>>>>>>>>>>>//DDB-HeaderStart
49361>>>>>>>>>>>
49361>>>>>>>>>>>// File Name : FPA.DD
49361>>>>>>>>>>>// Class Name: Fpa_DataDictionary
49361>>>>>>>>>>>// Revision  : 34
49361>>>>>>>>>>>// Version   : 2
49361>>>>>>>>>>>
49361>>>>>>>>>>>Use  Windows           // Basic Definitions
49361>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
49361>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49361>>>>>>>>>>>
49361>>>>>>>>>>>Open Fpa
INCLUDING FILE: FPA.FD
49363>>>>>>>>>>>Open Iteml
49365>>>>>>>>>>>Open Partlfpa
49367>>>>>>>>>>>Open Item
49369>>>>>>>>>>>
49369>>>>>>>>>>>//DDB-HeaderEnd
49369>>>>>>>>>>>//DDB-SelectionStart
49369>>>>>>>>>>>//DDB/ ExternalSelectionList Fpa  Fpa.SL
49369>>>>>>>>>>>//DDB/ ExternalSelectionList sl150  sl150.SL
49369>>>>>>>>>>>Register_Object Fpa
49369>>>>>>>>>>>Register_Object sl150
49369>>>>>>>>>>>//DDB-SelectionEnd
49369>>>>>>>>>>>
49369>>>>>>>>>>>Class Fpa_DataDictionary  is a DataDictionary_Sec
49370>>>>>>>>>>> 
49370>>>>>>>>>>>    // Validate_Save:
49370>>>>>>>>>>> 
49370>>>>>>>>>>>    Function Validate_Save  Returns Integer
49371>>>>>>>>>>>        Local Integer iReturnVal icheck
49372>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
49374>>>>>>>>>>>        If (Not(iReturnVal)) Begin
49376>>>>>>>>>>>            // Insert Code Here
49376>>>>>>>>>>>         //  if (fpa.agora_codegl <> '') begin
49376>>>>>>>>>>>         //     Move (Check_log(fpa.agora_codegl)) to iCheck  
49376>>>>>>>>>>>         //     if (icheck) Move 104001 to iReturnVal 
49376>>>>>>>>>>>         //  end
49376>>>>>>>>>>>         //  if (fpa.polhsh_codegl <> '') begin
49376>>>>>>>>>>>         //     Move (Check_log(fpa.polhsh_codegl)) to iCheck  
49376>>>>>>>>>>>         //     if (icheck) Move 104002 to iReturnVal
49376>>>>>>>>>>>         //  end   
49376>>>>>>>>>>>         //  If (iReturnVal) Send Operation_Not_Allowed iReturnVal
49376>>>>>>>>>>>        End
49376>>>>>>>>>>>>
49376>>>>>>>>>>>        Function_Return iReturnVal
49377>>>>>>>>>>>    End_Function   // Validate_Save
49378>>>>>>>>>>> 
49378>>>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
49379>>>>>>>>>>>        String lsError_Message
49380>>>>>>>>>>>        Case Begin
49380>>>>>>>>>>>            Case (iError_Num = 104001)
49382>>>>>>>>>>>                Move "DDC 104: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ”..€ ˜š¦¨é¤" to lsError_Message
49383>>>>>>>>>>>              Case Break
49384>>>>>>>>>>>            Case (iError_Num = 104002)
49387>>>>>>>>>>>                Move "DDC 104: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ”..€ §à¢ã©œà¤" to lsError_Message
49388>>>>>>>>>>>              Case Break
49389>>>>>>>>>>>            Case Else
49389>>>>>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
49391>>>>>>>>>>>        Case End
49391>>>>>>>>>>>        Error iError_Num lsError_Message
49392>>>>>>>>>>>>
49392>>>>>>>>>>>    End_Procedure // operation_not_allowed
49393>>>>>>>>>>>
49393>>>>>>>>>>>    // Define_Fields:
49393>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49393>>>>>>>>>>>
49393>>>>>>>>>>>    Procedure Define_Fields
49394>>>>>>>>>>>        Forward Send Define_Fields
49396>>>>>>>>>>>        //DDB-Generated-Code-Location
49396>>>>>>>>>>>        //DDB-DefineFieldStart
49396>>>>>>>>>>>
49396>>>>>>>>>>>        Set Main_File            To Fpa.File_Number
49397>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
49398>>>>>>>>>>>
49398>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49399>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49400>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49401>>>>>>>>>>>
49401>>>>>>>>>>>        // Child (Client) file structure................
49401>>>>>>>>>>>        Send Add_Client_File  Iteml.File_Number
49402>>>>>>>>>>>        Send Add_Client_File  Partlfpa.File_Number
49403>>>>>>>>>>>        Send Add_Client_File  Item.File_Number
49404>>>>>>>>>>>
49404>>>>>>>>>>>        // Field-based properties.......................
49404>>>>>>>>>>>
49404>>>>>>>>>>>        // Fpa.Fpa_Pososto
49404>>>>>>>>>>>        Set Field_Options          Field Fpa.Fpa_Pososto To DD_AUTOFIND    DD_REQUIRED   
49405>>>>>>>>>>>        Set Field_Prompt_Object    Field Fpa.Fpa_Pososto To (Fpa(Self))
49406>>>>>>>>>>>        Set Key_Field_State        Field Fpa.Fpa_Pososto To TRUE
49407>>>>>>>>>>>
49407>>>>>>>>>>>        // Fpa.Fpa_Descr
49407>>>>>>>>>>>        Set Field_Options          Field Fpa.Fpa_Descr To DD_AUTOFIND   
49408>>>>>>>>>>>        Set Field_Prompt_Object    Field Fpa.Fpa_Descr To (Fpa(Self))
49409>>>>>>>>>>>
49409>>>>>>>>>>>        // Fpa.Agora_Codegl
49409>>>>>>>>>>>        Set Field_Prompt_Object    Field Fpa.Agora_Codegl To (sl150(Self))
49410>>>>>>>>>>>
49410>>>>>>>>>>>        // Fpa.Polhsh_Codegl
49410>>>>>>>>>>>
49410>>>>>>>>>>>        //DDB-DefineFieldEnd
49410>>>>>>>>>>>    End_Procedure    // Define_Fields
49411>>>>>>>>>>>
49411>>>>>>>>>>>    // Field_Defaults:
49411>>>>>>>>>>>    // This procedure is used to establish default field values.
49411>>>>>>>>>>>
49411>>>>>>>>>>>    Procedure Field_Defaults
49412>>>>>>>>>>>        Forward Send Field_Defaults
49414>>>>>>>>>>>        //DDB-Generated-Code-Location
49414>>>>>>>>>>>        //DDB-FieldDefaultStart
49414>>>>>>>>>>>        //DDB-FieldDefaultEnd
49414>>>>>>>>>>>    End_Procedure    // Field_Defaults
49415>>>>>>>>>>>
49415>>>>>>>>>>>End_Class    // Fpa_DataDictionary
49416>>>>>>>>>>>//DDB-Selection-pkg-Start
49416>>>>>>>>>>>
49416>>>>>>>>>>>Use Fpa.SL           // Fpa
INCLUDING FILE: FPA.SL
49416>>>>>>>>>>>>>//AB/ Project Fpa:Lookup
49416>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
49416>>>>>>>>>>>>>//AB/     Set ProjectName to "Fpa:Lookup"
49416>>>>>>>>>>>>>//AB/     Set ProjectFileName to "Fpa.SL"
49416>>>>>>>>>>>>>
49416>>>>>>>>>>>>>// Project Object Structure
49416>>>>>>>>>>>>>//   Fpa is a dbModalPanelSub
49416>>>>>>>>>>>>>//     Fpa_DD is a DataDictionary
49416>>>>>>>>>>>>>//     oSelList is a dbListSub
49416>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
49416>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
49416>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
49416>>>>>>>>>>>>>
49416>>>>>>>>>>>>>// Register all objects
49416>>>>>>>>>>>>>Register_Object Fpa
49416>>>>>>>>>>>>>Register_Object Fpa_DD
49416>>>>>>>>>>>>>Register_Object oCancel_bn
49416>>>>>>>>>>>>>Register_Object oOK_bn
49416>>>>>>>>>>>>>Register_Object oSearch_bn
49416>>>>>>>>>>>>>Register_Object oSelList
49416>>>>>>>>>>>>>
49416>>>>>>>>>>>>>
49416>>>>>>>>>>>>>//AB-IgnoreStart
49416>>>>>>>>>>>>>
49416>>>>>>>>>>>>>Use DFAllEnt.pkg
49416>>>>>>>>>>>>>Use dbList.Sub
49416>>>>>>>>>>>>>Use Button.Sub
49416>>>>>>>>>>>>>
49416>>>>>>>>>>>>>
49416>>>>>>>>>>>>>Use FPA.DD
49416>>>>>>>>>>>>>
49416>>>>>>>>>>>>>//AB-IgnoreEnd
49416>>>>>>>>>>>>>
49416>>>>>>>>>>>>>CD_Popup_Object Fpa is a dbModalPanelSub
49435>>>>>>>>>>>>>    set label to "¦©¦©«á ”..€." 
49436>>>>>>>>>>>>>    Set Size to 148 181
49437>>>>>>>>>>>>>    Set Location to 4 5
49438>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
49439>>>>>>>>>>>>>    Set Modal_State to FALSE
49440>>>>>>>>>>>>>
49440>>>>>>>>>>>>>    //AB-DDOStart
49440>>>>>>>>>>>>>
49440>>>>>>>>>>>>>    Object Fpa_DD is a Fpa_DataDictionary
49442>>>>>>>>>>>>>    End_Object    // Fpa_DD
49443>>>>>>>>>>>>>
49443>>>>>>>>>>>>>    Set Main_DD to (Fpa_DD(self))
49444>>>>>>>>>>>>>    Set Server to (Fpa_DD(self))
49445>>>>>>>>>>>>>
49445>>>>>>>>>>>>>    //AB-DDOEnd
49445>>>>>>>>>>>>>
49445>>>>>>>>>>>>>    Object oSelList is a dbListSub
49447>>>>>>>>>>>>>        Set Main_File to Fpa.File_Number
49448>>>>>>>>>>>>>        Set Size to 105 165
49449>>>>>>>>>>>>>        Set Location to 6 6
49450>>>>>>>>>>>>>
49450>>>>>>>>>>>>>        Begin_Row
49453>>>>>>>>>>>>>            Entry_Item Fpa.Fpa_pososto
49454>>>>>>>>>>>>>            Entry_Item Fpa.Fpa_descr
49455>>>>>>>>>>>>>        End_Row
49460>>>>>>>>>>>>>
49460>>>>>>>>>>>>>        Set Form_Width    item 0 to 66
49461>>>>>>>>>>>>>        set header_label  item 0 to "% ”€" 
49462>>>>>>>>>>>>>        
49462>>>>>>>>>>>>>        Set Form_Width    item 1 to 90
49463>>>>>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
49464>>>>>>>>>>>>>        
49464>>>>>>>>>>>>>    End_Object    // oSelList
49465>>>>>>>>>>>>>
49465>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
49467>>>>>>>>>>>>>        set label to "&„§ ¢¦šã" 
49468>>>>>>>>>>>>>        Set Size to 14 46
49469>>>>>>>>>>>>>        Set Location to 113 26
49470>>>>>>>>>>>>>
49470>>>>>>>>>>>>>        //AB-StoreStart
49470>>>>>>>>>>>>>        Procedure OnClick
49472>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
49473>>>>>>>>>>>>>        End_Procedure
49474>>>>>>>>>>>>>        //AB-StoreEnd
49474>>>>>>>>>>>>>
49474>>>>>>>>>>>>>    End_Object    // oOK_bn
49475>>>>>>>>>>>>>
49475>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
49477>>>>>>>>>>>>>        set label to "&€¡ç¨à©ž" 
49478>>>>>>>>>>>>>        Set Size to 14 46
49479>>>>>>>>>>>>>        Set Location to 113 75
49480>>>>>>>>>>>>>
49480>>>>>>>>>>>>>        //AB-StoreStart
49480>>>>>>>>>>>>>        Procedure OnClick
49482>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
49483>>>>>>>>>>>>>        End_Procedure
49484>>>>>>>>>>>>>        //AB-StoreEnd
49484>>>>>>>>>>>>>
49484>>>>>>>>>>>>>    End_Object    // oCancel_bn
49485>>>>>>>>>>>>>
49485>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
49487>>>>>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
49488>>>>>>>>>>>>>        Set Size to 14 46
49489>>>>>>>>>>>>>        Set Location to 113 126
49490>>>>>>>>>>>>>
49490>>>>>>>>>>>>>        //AB-StoreStart
49490>>>>>>>>>>>>>        Procedure OnClick
49492>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
49493>>>>>>>>>>>>>        End_Procedure
49494>>>>>>>>>>>>>        //AB-StoreEnd
49494>>>>>>>>>>>>>
49494>>>>>>>>>>>>>    End_Object    // oSearch_bn
49495>>>>>>>>>>>>>
49495>>>>>>>>>>>>>
49495>>>>>>>>>>>>>    //AB-StoreStart
49495>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49496>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49497>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49498>>>>>>>>>>>>>    //AB-StoreEnd
49498>>>>>>>>>>>>>
49498>>>>>>>>>>>>>CD_End_Object    // Fpa
49500>>>>>>>>>>>>>>
49500>>>>>>>>>>>>>
49500>>>>>>>>>>>>>//AB/ End_Object    // prj
49500>>>>>>>>>>>Use sl150.SL         // sl150
49500>>>>>>>>>>>
49500>>>>>>>>>>>//DDB-Selection-pkg-End
49500>>>>>>>>>>>//DDB-FileEnd
49500>>>>>>>>>    Use ITEM.DD
INCLUDING FILE: ITEM.DD
49500>>>>>>>>>>>//DDB-FileStart
49500>>>>>>>>>>>//DDB-HeaderStart
49500>>>>>>>>>>>
49500>>>>>>>>>>>// File Name : ITEM.DD
49500>>>>>>>>>>>// Class Name: Item_DataDictionary
49500>>>>>>>>>>>// Revision  : 63
49500>>>>>>>>>>>// Version   : 2
49500>>>>>>>>>>>
49500>>>>>>>>>>>Use  Windows           // Basic Definitions
49500>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
49500>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49500>>>>>>>>>>>
49500>>>>>>>>>>>Open Item
49502>>>>>>>>>>>Open Witemx
49504>>>>>>>>>>>Open Witemcl
49506>>>>>>>>>>>Open Itemtehn
INCLUDING FILE: ITEMTEHN.FD
49508>>>>>>>>>>>Open Units
49510>>>>>>>>>>>Open Witemkat
49512>>>>>>>>>>>Open Fpa
49514>>>>>>>>>>>Open Sysrecw
49516>>>>>>>>>>>Open Witemx
49518>>>>>>>>>>>
49518>>>>>>>>>>>//DDB-HeaderEnd
49518>>>>>>>>>>>//DDB-ValidationStart
49518>>>>>>>>>>>
49518>>>>>>>>>>>Register_Object Item_Item_Qual_VT
49518>>>>>>>>>>>Register_Object Item_Item_Analysh_VT
49518>>>>>>>>>>>
49518>>>>>>>>>>>Object Item_Item_Qual_VT  is a CodeValidationTable
49520>>>>>>>>>>>    Set Type_Value        To "QUAL"
49521>>>>>>>>>>>    Set Validate_State    To FALSE
49522>>>>>>>>>>>    Set Allow_Blank_State To TRUE
49523>>>>>>>>>>>    //DDB-ValidationCustomStart
49523>>>>>>>>>>>    //DDB-ValidationCustomEnd
49523>>>>>>>>>>>End_Object   // Item_Item_Qual_VT
49524>>>>>>>>>>>
49524>>>>>>>>>>>Object Item_Item_Analysh_VT  is a CodeValidationTable
49526>>>>>>>>>>>    Set Type_Value        To "ITEMANAL"
49527>>>>>>>>>>>    Set Table_Title       To "€¤á¢¬©ž „å›¦¬ª"
49528>>>>>>>>>>>    //DDB-ValidationCustomStart
49528>>>>>>>>>>>    //DDB-ValidationCustomEnd
49528>>>>>>>>>>>End_Object   // Item_Item_Analysh_VT
49529>>>>>>>>>>>//DDB-ValidationEnd
49529>>>>>>>>>>>//DDB-SelectionStart
49529>>>>>>>>>>>//DDB/ ExternalSelectionList SL22s  sl22s.sl
49529>>>>>>>>>>>//DDB/ ExternalSelectionList sl022  sl022.SL
49529>>>>>>>>>>>Register_Object SL22s
49529>>>>>>>>>>>Register_Object sl022
49529>>>>>>>>>>>//DDB-SelectionEnd
49529>>>>>>>>>>>
49529>>>>>>>>>>>Class Item_DataDictionary  is a DataDictionary
49530>>>>>>>>>>>
49530>>>>>>>>>>>    Procedure Update
49531>>>>>>>>>>>        Forward Send Update
49533>>>>>>>>>>>        Move Witemkat.Witemkat_Code to Item.Witemkat_Code
49534>>>>>>>>>>>        Move Units.Units_Code       to Item.Units_Code
49535>>>>>>>>>>>    End_Procedure   // Update
49536>>>>>>>>>>>
49536>>>>>>>>>>>    Procedure Creating
49537>>>>>>>>>>>        Date dHmnia
49538>>>>>>>>>>>        Forward Send Creating
49540>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                         (Trim(String(Item.Item_Rec0)))))) to Item.Item_Recr
49541>>>>>>>>>>>        
49541>>>>>>>>>>>        Clear Branch
49542>>>>>>>>>>>        Move SysCurXR.Company_Code    to Branch.Company_Code
49543>>>>>>>>>>>        Find Gt Branch By Index.1 
49544>>>>>>>>>>>>
49544>>>>>>>>>>>        While ((Found=1) And (Branch.Company_Code=SysCurXR.Company_Code))
49548>>>>>>>>>>>            Clear Witemx
49549>>>>>>>>>>>            Move SysCurXR.Company_Code      to Witemx.Company_Code
49550>>>>>>>>>>>            Move Branch.Branch_Code         to Witemx.Branch_Code
49551>>>>>>>>>>>            Move SysCurXR.Year_Year         to Witemx.Year_Year
49552>>>>>>>>>>>            Move SysCurXR.Year_Year         to Witemx.Witemx_YearDesc
49553>>>>>>>>>>>            Move SysCurXR.Year_Recr         to Witemx.Year_Recr
49554>>>>>>>>>>>            Move Witemkat.Witemkat_Code     to Witemx.Witemkat_Code
49555>>>>>>>>>>>            Move Units.Units_Code           to Witemx.Units_Code
49556>>>>>>>>>>>            Move Item.Item_Code             to Witemx.Item_Code
49557>>>>>>>>>>>            Move Item.Item_Code             to Witemx.Witemx_Code
49558>>>>>>>>>>>            Move Item.Item_Descr            to Witemx.Witemx_Descr
49559>>>>>>>>>>>            Move Item.Wapokat_Code          to Witemx.ITEM_APOKAT_COD
49560>>>>>>>>>>>            Move Item.link1                 to Witemx.link1
49561>>>>>>>>>>>            Move Item.link2                 to Witemx.link2
49562>>>>>>>>>>>            Move Item.Item_Recr             to Witemx.Item_Recr
49563>>>>>>>>>>>            Move (Sysrecw.Witemx_Rec0+1)    to Witemx.Witemx_Rec0
49564>>>>>>>>>>>            Move (Sysrecw.Witemx_Rec0+1)    to Sysrecw.Witemx_Rec0
49565>>>>>>>>>>>            Move (Append('',((Trim(SysCurXR.Branch_Site))+;                           (Trim(String(Witemx.Witemx_Rec0)))))) ;                                          to Witemx.Witemx_Recr
49566>>>>>>>>>>>            Saverecord Sysrecw
49567>>>>>>>>>>>            Saverecord Witemx
49568>>>>>>>>>>>            
49568>>>>>>>>>>>            Find Gt Branch By Index.1 
49569>>>>>>>>>>>>
49569>>>>>>>>>>>        Loop
49570>>>>>>>>>>>>
49570>>>>>>>>>>>    End_Procedure   // Creating
49571>>>>>>>>>>>
49571>>>>>>>>>>>
49571>>>>>>>>>>>    // Define_Fields:
49571>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49571>>>>>>>>>>>
49571>>>>>>>>>>>    Procedure Define_Fields
49572>>>>>>>>>>>        Forward Send Define_Fields
49574>>>>>>>>>>>        //DDB-Generated-Code-Location
49574>>>>>>>>>>>        //DDB-DefineFieldStart
49574>>>>>>>>>>>
49574>>>>>>>>>>>        Set Main_File            To Item.File_Number
49575>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
49576>>>>>>>>>>>
49576>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49577>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49578>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49579>>>>>>>>>>>
49579>>>>>>>>>>>        // Child (Client) file structure................
49579>>>>>>>>>>>        Send Add_Client_File  Witemx.File_Number
49580>>>>>>>>>>>        Send Add_Client_File  Witemcl.File_Number
49581>>>>>>>>>>>        Send Add_Client_File  Itemtehn.File_Number
49582>>>>>>>>>>>
49582>>>>>>>>>>>        // Parent (Server) file structure...............
49582>>>>>>>>>>>        Send Add_Server_File  Units.File_Number
49583>>>>>>>>>>>        Send Add_Server_File  Witemkat.File_Number
49584>>>>>>>>>>>        Send Add_Server_File  Fpa.File_Number
49585>>>>>>>>>>>
49585>>>>>>>>>>>        // External (System) file structure.............
49585>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
49586>>>>>>>>>>>        Send Add_System_File  Witemx.File_Number  DD_LOCK_ON_ALL
49587>>>>>>>>>>>
49587>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Item_Rec0  To Item.Item_Rec0
49590>>>>>>>>>>>
49590>>>>>>>>>>>        // Field-based properties.......................
49590>>>>>>>>>>>
49590>>>>>>>>>>>        // Item.Units_Code
49590>>>>>>>>>>>
49590>>>>>>>>>>>        // Item.Units_Recr
49590>>>>>>>>>>>
49590>>>>>>>>>>>        // Item.Witemkat_Code
49590>>>>>>>>>>>
49590>>>>>>>>>>>        // Item.Witemkat_Recr
49590>>>>>>>>>>>
49590>>>>>>>>>>>        // Item.Item_Code
49590>>>>>>>>>>>        Set Field_Options          Field Item.Item_Code To DD_AUTOFIND   
49591>>>>>>>>>>>        Set Field_Prompt_Object    Field Item.Item_Code To (SL22s(Self))
49592>>>>>>>>>>>        Set Key_Field_State        Field Item.Item_Code To TRUE
49593>>>>>>>>>>>
49593>>>>>>>>>>>        // Item.Item_Rec0
49593>>>>>>>>>>>        Set Field_Options          Field Item.Item_Rec0 To DD_AUTOFIND   
49594>>>>>>>>>>>
49594>>>>>>>>>>>        // Item.Item_Descr
49594>>>>>>>>>>>        Set Field_Prompt_Object    Field Item.Item_Descr To (SL22s(Self))
49595>>>>>>>>>>>
49595>>>>>>>>>>>        // Item.Item_Recr
49595>>>>>>>>>>>        Set Field_Options          Field Item.Item_Recr To DD_AUTOFIND   
49596>>>>>>>>>>>
49596>>>>>>>>>>>        // Item.Fpa_Pososto
49596>>>>>>>>>>>        Set Key_Field_State        Field Item.Fpa_Pososto To TRUE
49597>>>>>>>>>>>
49597>>>>>>>>>>>        // Item.Item_Qual
49597>>>>>>>>>>>        Set Field_Value_Table      Field Item.Item_Qual To (Item_Item_Qual_VT(Self))
49598>>>>>>>>>>>
49598>>>>>>>>>>>        // Item.Wapokat_Code
49598>>>>>>>>>>>        Set Field_Prompt_Object    Field Item.Wapokat_Code To (sl022(Self))
49599>>>>>>>>>>>
49599>>>>>>>>>>>        // Item.Item_Analysh
49599>>>>>>>>>>>        Set Field_Class_Name       Field Item.Item_Analysh To "dbComboFormsub"
49600>>>>>>>>>>>        Set Field_Value_Table      Field Item.Item_Analysh To (Item_Item_Analysh_VT(Self))
49601>>>>>>>>>>>
49601>>>>>>>>>>>        // Item.Item_Orio
49601>>>>>>>>>>>
49601>>>>>>>>>>>        // Item.Codeglpol
49601>>>>>>>>>>>
49601>>>>>>>>>>>        // Item.Codeglago
49601>>>>>>>>>>>
49601>>>>>>>>>>>        // Item.Link1
49601>>>>>>>>>>>
49601>>>>>>>>>>>        // Item.Link2
49601>>>>>>>>>>>
49601>>>>>>>>>>>        // Item.Group
49601>>>>>>>>>>>
49601>>>>>>>>>>>        // Item.Sap
49601>>>>>>>>>>>
49601>>>>>>>>>>>        //DDB-DefineFieldEnd
49601>>>>>>>>>>>    End_Procedure    // Define_Fields
49602>>>>>>>>>>>
49602>>>>>>>>>>>    // Field_Defaults:
49602>>>>>>>>>>>    // This procedure is used to establish default field values.
49602>>>>>>>>>>>
49602>>>>>>>>>>>    Procedure Field_Defaults
49603>>>>>>>>>>>        Forward Send Field_Defaults
49605>>>>>>>>>>>        //DDB-Generated-Code-Location
49605>>>>>>>>>>>        //DDB-FieldDefaultStart
49605>>>>>>>>>>>        Set Field_Changed_Value   Field Item.Item_Analysh To "0"
49606>>>>>>>>>>>        //DDB-FieldDefaultEnd
49606>>>>>>>>>>>    End_Procedure    // Field_Defaults
49607>>>>>>>>>>>
49607>>>>>>>>>>>End_Class    // Item_DataDictionary
49608>>>>>>>>>>>//DDB-Selection-pkg-Start
49608>>>>>>>>>>>
49608>>>>>>>>>>>Use sl22s.sl         // SL22s
INCLUDING FILE: SL22S.SL
49608>>>>>>>>>>>>>//AB/ Project SL22s:ITEM
49608>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
49608>>>>>>>>>>>>>//AB/         Set ProjectName to "SL22s:ITEM"
49608>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl22s.sl"
49608>>>>>>>>>>>>>
49608>>>>>>>>>>>>>// Project Object Structure
49608>>>>>>>>>>>>>//   SL22s is a dbModalPanel
49608>>>>>>>>>>>>>//     Witemkat_DD is a DataDictionary
49608>>>>>>>>>>>>>//     Units_DD is a DataDictionary
49608>>>>>>>>>>>>>//     Fpa_DD is a DataDictionary
49608>>>>>>>>>>>>>//     Item_DD is a DataDictionary
49608>>>>>>>>>>>>>//     oSelList is a dbListSub
49608>>>>>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
49608>>>>>>>>>>>>>//     ocode is a FormSub
49608>>>>>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
49608>>>>>>>>>>>>>//     operi is a FormSub
49608>>>>>>>>>>>>>//     RadioGroupSub1 is a RadioGroupSub
49608>>>>>>>>>>>>>//       Radio1 is a RadioSub
49608>>>>>>>>>>>>>//       Radio2 is a RadioSub
49608>>>>>>>>>>>>>//     ButtonSub1 is a ButtonSub
49608>>>>>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
49608>>>>>>>>>>>>>//     ocodekat is a FormSub
49608>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
49608>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
49608>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
49608>>>>>>>>>>>>>
49608>>>>>>>>>>>>>// Register all objects
49608>>>>>>>>>>>>>Register_Object ButtonSub1
49608>>>>>>>>>>>>>Register_Object Fpa_DD
49608>>>>>>>>>>>>>Register_Object Item_DD
49608>>>>>>>>>>>>>Register_Object oCancel_bn
49608>>>>>>>>>>>>>Register_Object ocode
49608>>>>>>>>>>>>>Register_Object ocodekat
49608>>>>>>>>>>>>>Register_Object oOK_bn
49608>>>>>>>>>>>>>Register_Object operi
49608>>>>>>>>>>>>>Register_Object oSearch_bn
49608>>>>>>>>>>>>>Register_Object oSelList
49608>>>>>>>>>>>>>Register_Object Radio1
49608>>>>>>>>>>>>>Register_Object Radio2
49608>>>>>>>>>>>>>Register_Object RadioGroupSub1
49608>>>>>>>>>>>>>Register_Object SL22s
49608>>>>>>>>>>>>>Register_Object TextBoxSub1
49608>>>>>>>>>>>>>Register_Object TextBoxSub2
49608>>>>>>>>>>>>>Register_Object TextBoxSub3
49608>>>>>>>>>>>>>Register_Object Units_DD
49608>>>>>>>>>>>>>Register_Object Witemkat_DD
49608>>>>>>>>>>>>>
49608>>>>>>>>>>>>>
49608>>>>>>>>>>>>>
49608>>>>>>>>>>>>>    //AB-StoreTopStart
49608>>>>>>>>>>>>>                                
49608>>>>>>>>>>>>>                                
49608>>>>>>>>>>>>>    //AB-StoreTopEnd
49608>>>>>>>>>>>>>
49608>>>>>>>>>>>>>    //AB-IgnoreStart
49608>>>>>>>>>>>>>
49608>>>>>>>>>>>>>    Use DFAllEnt.pkg
49608>>>>>>>>>>>>>    Use dbList.Sub
49608>>>>>>>>>>>>>    Use Txtbox.Sub
49608>>>>>>>>>>>>>    Use Form.Sub
49608>>>>>>>>>>>>>    Use Rgroup.Sub
49608>>>>>>>>>>>>>    Use Radio.Sub
49608>>>>>>>>>>>>>    Use Button.Sub
49608>>>>>>>>>>>>>
49608>>>>>>>>>>>>>
49608>>>>>>>>>>>>>    Use WITEMKAT.DD
49608>>>>>>>>>>>>>    Use UNITS.DD
49608>>>>>>>>>>>>>    Use FPA.DD
49608>>>>>>>>>>>>>    Use ITEM.DD
49608>>>>>>>>>>>>>    
49608>>>>>>>>>>>>>    //AB-IgnoreEnd
49608>>>>>>>>>>>>>
49608>>>>>>>>>>>>>    CD_Popup_Object SL22s is a dbModalPanel
49627>>>>>>>>>>>>>
49627>>>>>>>>>>>>>        //AB-StoreTopStart
49627>>>>>>>>>>>>>        Property String     pscode                  ''
49629>>>>>>>>>>>>>        Property String     psperi                  ''
49631>>>>>>>>>>>>>        Property Integer    piContains_Or_Starts     0
49633>>>>>>>>>>>>>        Property String     pscodekat               ''
49635>>>>>>>>>>>>>        
49635>>>>>>>>>>>>>        //AB-StoreTopEnd
49635>>>>>>>>>>>>>
49635>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
49636>>>>>>>>>>>>>        Set Label to "€¨®œå¦ „ ›é¤"
49637>>>>>>>>>>>>>        Set Size to 270 484
49638>>>>>>>>>>>>>        Set Location to 5 7
49639>>>>>>>>>>>>>
49639>>>>>>>>>>>>>        //AB-DDOStart
49639>>>>>>>>>>>>>
49639>>>>>>>>>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
49641>>>>>>>>>>>>>        End_Object    // Witemkat_DD
49642>>>>>>>>>>>>>
49642>>>>>>>>>>>>>        Object Units_DD is a Units_DataDictionary
49644>>>>>>>>>>>>>        End_Object    // Units_DD
49645>>>>>>>>>>>>>
49645>>>>>>>>>>>>>        Object Fpa_DD is a Fpa_DataDictionary
49647>>>>>>>>>>>>>        End_Object    // Fpa_DD
49648>>>>>>>>>>>>>
49648>>>>>>>>>>>>>        Object Item_DD is a Item_DataDictionary
49650>>>>>>>>>>>>>
49650>>>>>>>>>>>>>            //AB-StoreTopStart
49650>>>>>>>>>>>>>            Function fiPeriexei Returns Integer
49652>>>>>>>>>>>>>                       String lsperi lscode  lscodekat
49653>>>>>>>>>>>>>                       Integer rVal liContains_Or_Starts
49653>>>>>>>>>>>>>                       Move 0 to rVal
49654>>>>>>>>>>>>>                       Get piContains_Or_Starts to liContains_Or_Starts
49655>>>>>>>>>>>>>                       Get psperi to lsperi
49656>>>>>>>>>>>>>                       Get pscode to lscode
49657>>>>>>>>>>>>>                       Get pscodekat to lscodekat
49658>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
49659>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
49660>>>>>>>>>>>>>                  //     Move (Trim(lscodekat)) to lscodekat
49660>>>>>>>>>>>>>                       If (liContains_Or_Starts=0) Begin
49662>>>>>>>>>>>>>                           If ((Trim(item.item_descr)) Contains lsperi) Begin
49664>>>>>>>>>>>>>                               If ((Trim(item.item_code)) Contains lscode) Move 1 to rVal
49667>>>>>>>>>>>>>                           End
49667>>>>>>>>>>>>>>
49667>>>>>>>>>>>>>            
49667>>>>>>>>>>>>>                       End
49667>>>>>>>>>>>>>>
49667>>>>>>>>>>>>>                       Else Begin
49668>>>>>>>>>>>>>                           If (Left(item.item_descr,(Length(lsperi)))=lsperi) Begin
49670>>>>>>>>>>>>>                               If (Left(item.item_code,(Length(lscode)))=lscode) Move 1 to rVal
49673>>>>>>>>>>>>>                           End
49673>>>>>>>>>>>>>>
49673>>>>>>>>>>>>>            
49673>>>>>>>>>>>>>                       End
49673>>>>>>>>>>>>>>
49673>>>>>>>>>>>>>                       Function_Return rVal
49674>>>>>>>>>>>>>                   End_Function
49675>>>>>>>>>>>>>            
49675>>>>>>>>>>>>>                   Function fiArxizeiperi Returns Integer
49677>>>>>>>>>>>>>                       String lsperi
49678>>>>>>>>>>>>>                       Get psperi to lsperi
49679>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
49680>>>>>>>>>>>>>                       Function_Return (Left(item.item_descr,(Length(lsperi)))=lsperi)
49681>>>>>>>>>>>>>                   End_Function
49682>>>>>>>>>>>>>            
49682>>>>>>>>>>>>>                   Function fiArxizeicode Returns Integer
49684>>>>>>>>>>>>>                       String lscode lscodekat
49685>>>>>>>>>>>>>                       Get pscode to lscode
49686>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
49687>>>>>>>>>>>>>                       Function_Return (Left(item.item_code,(Length(lscode)))=lscode)
49688>>>>>>>>>>>>>                   End_Function
49689>>>>>>>>>>>>>            
49689>>>>>>>>>>>>>            //AB-StoreTopEnd
49689>>>>>>>>>>>>>
49689>>>>>>>>>>>>>            Set DDO_Server to (Units_DD(self))
49690>>>>>>>>>>>>>            Set DDO_Server to (Witemkat_DD(self))
49691>>>>>>>>>>>>>            Set DDO_Server to (Fpa_DD(self))
49692>>>>>>>>>>>>>
49692>>>>>>>>>>>>>            //AB-StoreStart
49692>>>>>>>>>>>>>                                                                                                
49692>>>>>>>>>>>>>                                                                                                
49692>>>>>>>>>>>>>                                                                                                
49692>>>>>>>>>>>>>            Begin_Constraints
49694>>>>>>>>>>>>>               String lsperi lscode lsvalue lstype lscodekat
49695>>>>>>>>>>>>>               Integer liContains_Or_Starts
49695>>>>>>>>>>>>>             //  Get FragmaItem  to lsValue
49695>>>>>>>>>>>>>            
49695>>>>>>>>>>>>>                   Get psperi  to lsperi
49696>>>>>>>>>>>>>                   Get pscode  to lscode
49697>>>>>>>>>>>>>                   Get pscodekat  to lscodekat
49698>>>>>>>>>>>>>                   Get piContains_Or_Starts to liContains_Or_Starts
49699>>>>>>>>>>>>>                   Move (Trim(lsperi)) to lsperi
49700>>>>>>>>>>>>>                   Move (Trim(lscode)) to lscode
49701>>>>>>>>>>>>>                   Move (Trim(lscodekat)) to lscodekat
49702>>>>>>>>>>>>>                   If ((lsperi<>'') and (lscode<>'')) begin
49704>>>>>>>>>>>>>                        set ordering to 5
49705>>>>>>>>>>>>>                        Constrain item as (fiPeriexei(Self)=1)
49706>>>>>>>>>>>>>                   end
49706>>>>>>>>>>>>>>
49706>>>>>>>>>>>>>                   Else Begin
49707>>>>>>>>>>>>>                      If (liContains_Or_Starts=0) Begin
49709>>>>>>>>>>>>>                        If (lsperi<>'') begin
49711>>>>>>>>>>>>>                            set ordering to 3
49712>>>>>>>>>>>>>                            Constrain item.item_descr Contains lsperi
49714>>>>>>>>>>>>>                        end
49714>>>>>>>>>>>>>>
49714>>>>>>>>>>>>>                        Else If (lscode<>'') begin
49717>>>>>>>>>>>>>                            set ordering to 5
49718>>>>>>>>>>>>>                            Constrain item.item_code Contains lscode
49720>>>>>>>>>>>>>                        end
49720>>>>>>>>>>>>>>
49720>>>>>>>>>>>>>                      End
49720>>>>>>>>>>>>>>
49720>>>>>>>>>>>>>                      Else Begin
49721>>>>>>>>>>>>>                           If (lsperi<>'') begin
49723>>>>>>>>>>>>>                                set ordering to 3
49724>>>>>>>>>>>>>                                Constrain item as (fiArxizeiperi(Self)=1) //item.item_descr
49725>>>>>>>>>>>>>                           end
49725>>>>>>>>>>>>>>
49725>>>>>>>>>>>>>                           Else If (lscode<>'') begin
49728>>>>>>>>>>>>>                                set ordering to 5
49729>>>>>>>>>>>>>                                Constrain item as (fiArxizeicode(Self)=1) //item.item_code
49730>>>>>>>>>>>>>                           end
49730>>>>>>>>>>>>>>
49730>>>>>>>>>>>>>                      End
49730>>>>>>>>>>>>>>
49730>>>>>>>>>>>>>                   End
49730>>>>>>>>>>>>>>
49730>>>>>>>>>>>>>                   If (lscodekat<>'') Constrain item.witemkat_code Contains lscodekat
49734>>>>>>>>>>>>>            
49734>>>>>>>>>>>>>            End_Constraints
49737>>>>>>>>>>>>>            
49737>>>>>>>>>>>>>            
49737>>>>>>>>>>>>>            
49737>>>>>>>>>>>>>            
49737>>>>>>>>>>>>>            //AB-StoreEnd
49737>>>>>>>>>>>>>
49737>>>>>>>>>>>>>        End_Object    // Item_DD
49738>>>>>>>>>>>>>
49738>>>>>>>>>>>>>        Set Main_DD to (Item_DD(self))
49739>>>>>>>>>>>>>        Set Server to (Item_DD(self))
49740>>>>>>>>>>>>>
49740>>>>>>>>>>>>>        //AB-DDOEnd
49740>>>>>>>>>>>>>
49740>>>>>>>>>>>>>        Object oSelList is a dbListSub
49742>>>>>>>>>>>>>            Set Main_File to Item.File_Number
49743>>>>>>>>>>>>>            Set Ordering to 5
49744>>>>>>>>>>>>>            Set Size to 190 475
49745>>>>>>>>>>>>>            Set Location to -1 2
49746>>>>>>>>>>>>>            Set Color to 14280447
49747>>>>>>>>>>>>>            Set CurrentRowColor to 11783679
49748>>>>>>>>>>>>>            Set CurrentCellColor to 11783679
49749>>>>>>>>>>>>>            Set Auto_Index_State to FALSE
49750>>>>>>>>>>>>>
49750>>>>>>>>>>>>>            Begin_Row
49753>>>>>>>>>>>>>                Entry_Item Item.Item_code
49754>>>>>>>>>>>>>                Entry_Item Item.Item_descr
49755>>>>>>>>>>>>>                Entry_Item Item.Witemkat_code
49756>>>>>>>>>>>>>                Entry_Item Witemkat.Witemkat_descr
49757>>>>>>>>>>>>>                Entry_Item Item.Item_qual
49758>>>>>>>>>>>>>                Entry_Item Fpa.Fpa_pososto
49759>>>>>>>>>>>>>            End_Row
49764>>>>>>>>>>>>>
49764>>>>>>>>>>>>>            Set Form_Width    item 0 to 60
49765>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à›. „å›¦¬ª"
49766>>>>>>>>>>>>>            
49766>>>>>>>>>>>>>            Set Form_Width    item 1 to 140
49767>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
49768>>>>>>>>>>>>>            
49768>>>>>>>>>>>>>            Set Form_Width    item 2 to 70
49769>>>>>>>>>>>>>            Set Header_Label  item 2 to "‰à›. ‰˜«žš¦¨å˜ª"
49770>>>>>>>>>>>>>            
49770>>>>>>>>>>>>>            Set Form_Width    item 3 to 88
49771>>>>>>>>>>>>>            Set Header_Label  item 3 to "œ¨ š¨˜­ã ‰˜«žš."
49772>>>>>>>>>>>>>            
49772>>>>>>>>>>>>>            Set Form_Width    item 4 to 64
49773>>>>>>>>>>>>>            Set Header_Label  item 4 to "¦ æ«ž«˜"
49774>>>>>>>>>>>>>            
49774>>>>>>>>>>>>>            Set Form_Width    item 5 to 45
49775>>>>>>>>>>>>>            Set Header_Label  item 5 to "‰˜«.”..€"
49776>>>>>>>>>>>>>            
49776>>>>>>>>>>>>>
49776>>>>>>>>>>>>>            //AB-StoreStart
49776>>>>>>>>>>>>>            
49776>>>>>>>>>>>>>            Property String Store_Fragma_Items public ""
49778>>>>>>>>>>>>>            
49778>>>>>>>>>>>>>            set export_item_state to true
49779>>>>>>>>>>>>>            
49779>>>>>>>>>>>>>            Procedure Activating
49781>>>>>>>>>>>>>               Forward send Activating
49783>>>>>>>>>>>>>               Send Rebuild_Constraints to (Item_DD(Self))
49784>>>>>>>>>>>>>            End_Procedure
49785>>>>>>>>>>>>>            
49785>>>>>>>>>>>>>            Function Child_Exiting Integer iWhere Returns Integer
49787>>>>>>>>>>>>>                local integer Rval
49788>>>>>>>>>>>>>                Forward get Child_Exiting iWhere  to Rval
49790>>>>>>>>>>>>>                set value of (ocode   (self))   to ''
49791>>>>>>>>>>>>>                set value of (operi   (self))   to ''
49792>>>>>>>>>>>>>                set value of (ocodekat(self))   to ''
49793>>>>>>>>>>>>>                set psperi                      to ''
49794>>>>>>>>>>>>>                set pscode                      to ''
49795>>>>>>>>>>>>>                set pscodekat                   to ''
49796>>>>>>>>>>>>>                function_return Rval // if non-zero do not enter
49797>>>>>>>>>>>>>            End_function
49798>>>>>>>>>>>>>            
49798>>>>>>>>>>>>>            
49798>>>>>>>>>>>>>            
49798>>>>>>>>>>>>>            
49798>>>>>>>>>>>>>            
49798>>>>>>>>>>>>>            
49798>>>>>>>>>>>>>            
49798>>>>>>>>>>>>>            
49798>>>>>>>>>>>>>            
49798>>>>>>>>>>>>>            
49798>>>>>>>>>>>>>            
49798>>>>>>>>>>>>>            
49798>>>>>>>>>>>>>            
49798>>>>>>>>>>>>>            
49798>>>>>>>>>>>>>            
49798>>>>>>>>>>>>>            
49798>>>>>>>>>>>>>            
49798>>>>>>>>>>>>>            
49798>>>>>>>>>>>>>            
49798>>>>>>>>>>>>>            
49798>>>>>>>>>>>>>            //AB-StoreEnd
49798>>>>>>>>>>>>>
49798>>>>>>>>>>>>>        End_Object    // oSelList
49799>>>>>>>>>>>>>
49799>>>>>>>>>>>>>        Object TextBoxSub1 is a TextBoxSub
49801>>>>>>>>>>>>>            Set Label to "‘á¨à©ž ‰à› ¡¦ç ‚ á"
49802>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
49803>>>>>>>>>>>>>            Set Location to 192 6
49804>>>>>>>>>>>>>            Set Size to 13 78
49805>>>>>>>>>>>>>        End_Object    // TextBoxSub1
49806>>>>>>>>>>>>>
49806>>>>>>>>>>>>>        Object ocode is a FormSub
49808>>>>>>>>>>>>>            Set Size to 13 197
49809>>>>>>>>>>>>>            Set Location to 192 79
49810>>>>>>>>>>>>>            Set Label_Col_Offset to 2
49811>>>>>>>>>>>>>
49811>>>>>>>>>>>>>            //AB-StoreStart
49811>>>>>>>>>>>>>                                                
49811>>>>>>>>>>>>>            Procedure OnKILLFOCUS
49813>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
49814>>>>>>>>>>>>>            End_Procedure
49815>>>>>>>>>>>>>            
49815>>>>>>>>>>>>>            
49815>>>>>>>>>>>>>            
49815>>>>>>>>>>>>>            
49815>>>>>>>>>>>>>            //AB-StoreEnd
49815>>>>>>>>>>>>>
49815>>>>>>>>>>>>>        End_Object    // ocode
49816>>>>>>>>>>>>>
49816>>>>>>>>>>>>>        Object TextBoxSub2 is a TextBoxSub
49818>>>>>>>>>>>>>            Set Label to "‘á¨à©ž œ¨ š¨˜­ãª "
49819>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
49820>>>>>>>>>>>>>            Set Location to 207 6
49821>>>>>>>>>>>>>            Set Size to 13 83
49822>>>>>>>>>>>>>        End_Object    // TextBoxSub2
49823>>>>>>>>>>>>>
49823>>>>>>>>>>>>>        Object operi is a FormSub
49825>>>>>>>>>>>>>            Set Size to 13 197
49826>>>>>>>>>>>>>            Set Location to 207 79
49827>>>>>>>>>>>>>            Set Label_Col_Offset to 2
49828>>>>>>>>>>>>>
49828>>>>>>>>>>>>>            //AB-StoreStart
49828>>>>>>>>>>>>>                                                
49828>>>>>>>>>>>>>            Procedure OnKILLFOCUS
49830>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
49831>>>>>>>>>>>>>            End_Procedure
49832>>>>>>>>>>>>>            
49832>>>>>>>>>>>>>            
49832>>>>>>>>>>>>>            
49832>>>>>>>>>>>>>            
49832>>>>>>>>>>>>>            //AB-StoreEnd
49832>>>>>>>>>>>>>
49832>>>>>>>>>>>>>        End_Object    // operi
49833>>>>>>>>>>>>>
49833>>>>>>>>>>>>>        Object RadioGroupSub1 is a RadioGroupSub
49835>>>>>>>>>>>>>            Set Size to 32 77
49836>>>>>>>>>>>>>            Set Location to 193 277
49837>>>>>>>>>>>>>            Object Radio1 is a RadioSub
49839>>>>>>>>>>>>>                Set Label to "œ¨ â®œ«˜ "
49840>>>>>>>>>>>>>                Set Size to 10 53
49841>>>>>>>>>>>>>                Set Location to 7 5
49842>>>>>>>>>>>>>            End_Object    // Radio1
49843>>>>>>>>>>>>>
49843>>>>>>>>>>>>>            Object Radio2 is a RadioSub
49845>>>>>>>>>>>>>                Set Label to "€¨®åœ  €§æ"
49846>>>>>>>>>>>>>                Set Size to 10 51
49847>>>>>>>>>>>>>                Set Location to 21 5
49848>>>>>>>>>>>>>            End_Object    // Radio2
49849>>>>>>>>>>>>>
49849>>>>>>>>>>>>>
49849>>>>>>>>>>>>>            //AB-StoreStart
49849>>>>>>>>>>>>>                                                
49849>>>>>>>>>>>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
49851>>>>>>>>>>>>>                Set piContains_Or_Starts to iToItem
49852>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
49853>>>>>>>>>>>>>            End_Procedure
49854>>>>>>>>>>>>>            
49854>>>>>>>>>>>>>            
49854>>>>>>>>>>>>>            
49854>>>>>>>>>>>>>            
49854>>>>>>>>>>>>>            //AB-StoreEnd
49854>>>>>>>>>>>>>
49854>>>>>>>>>>>>>        End_Object    // RadioGroupSub1
49855>>>>>>>>>>>>>
49855>>>>>>>>>>>>>        Object ButtonSub1 is a ButtonSub
49857>>>>>>>>>>>>>            Set Label to "Search"
49858>>>>>>>>>>>>>            Set Size to 28 37
49859>>>>>>>>>>>>>            Set Location to 198 357
49860>>>>>>>>>>>>>            Set Form_FontWeight Item 0 to 800
49861>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "ms sans serif"
49862>>>>>>>>>>>>>
49862>>>>>>>>>>>>>            //AB-StoreStart
49862>>>>>>>>>>>>>                                                                                                
49862>>>>>>>>>>>>>            Set Visible_State to False
49863>>>>>>>>>>>>>            
49863>>>>>>>>>>>>>            Procedure OnClick
49865>>>>>>>>>>>>>                Forward Send OnClick
49867>>>>>>>>>>>>>                Set pscode  to (Value(ocode(Self),0))
49868>>>>>>>>>>>>>                Set psperi  to (Value(operi(Self),0))
49869>>>>>>>>>>>>>                Set pscodekat  to (Value(ocodekat(Self),0))
49870>>>>>>>>>>>>>                send Rebuild_Constraints    to (item_DD(Self))
49871>>>>>>>>>>>>>                Send Beginning_Of_Data      to oSelList True
49872>>>>>>>>>>>>>            End_Procedure // OnClick
49873>>>>>>>>>>>>>            
49873>>>>>>>>>>>>>            
49873>>>>>>>>>>>>>            
49873>>>>>>>>>>>>>            
49873>>>>>>>>>>>>>            
49873>>>>>>>>>>>>>            
49873>>>>>>>>>>>>>            
49873>>>>>>>>>>>>>            
49873>>>>>>>>>>>>>            
49873>>>>>>>>>>>>>            
49873>>>>>>>>>>>>>            
49873>>>>>>>>>>>>>            
49873>>>>>>>>>>>>>            
49873>>>>>>>>>>>>>            //AB-StoreEnd
49873>>>>>>>>>>>>>
49873>>>>>>>>>>>>>        End_Object    // ButtonSub1
49874>>>>>>>>>>>>>
49874>>>>>>>>>>>>>        Object TextBoxSub3 is a TextBoxSub
49876>>>>>>>>>>>>>            Set Label to "‰à›.‰˜«žš¦¨å˜ª ‚ á"
49877>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
49878>>>>>>>>>>>>>            Set Location to 221 5
49879>>>>>>>>>>>>>            Set Size to 13 78
49880>>>>>>>>>>>>>        End_Object    // TextBoxSub3
49881>>>>>>>>>>>>>
49881>>>>>>>>>>>>>        Object ocodekat is a FormSub
49883>>>>>>>>>>>>>            Set Size to 13 197
49884>>>>>>>>>>>>>            Set Location to 221 78
49885>>>>>>>>>>>>>            Set Label_Col_Offset to 2
49886>>>>>>>>>>>>>
49886>>>>>>>>>>>>>            //AB-StoreStart
49886>>>>>>>>>>>>>                                                
49886>>>>>>>>>>>>>            Procedure OnKILLFOCUS
49888>>>>>>>>>>>>>               Send KeyAction to ButtonSub1
49889>>>>>>>>>>>>>            End_Procedure
49890>>>>>>>>>>>>>            
49890>>>>>>>>>>>>>            
49890>>>>>>>>>>>>>            
49890>>>>>>>>>>>>>            //AB-StoreEnd
49890>>>>>>>>>>>>>
49890>>>>>>>>>>>>>        End_Object    // ocodekat
49891>>>>>>>>>>>>>
49891>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
49893>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
49894>>>>>>>>>>>>>            Set Location to 237 316
49895>>>>>>>>>>>>>
49895>>>>>>>>>>>>>            //AB-StoreStart
49895>>>>>>>>>>>>>            Procedure OnClick
49897>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
49898>>>>>>>>>>>>>            End_Procedure
49899>>>>>>>>>>>>>            //AB-StoreEnd
49899>>>>>>>>>>>>>
49899>>>>>>>>>>>>>        End_Object    // oOK_bn
49900>>>>>>>>>>>>>
49900>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
49902>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
49903>>>>>>>>>>>>>            Set Location to 237 371
49904>>>>>>>>>>>>>
49904>>>>>>>>>>>>>            //AB-StoreStart
49904>>>>>>>>>>>>>            Procedure OnClick
49906>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
49907>>>>>>>>>>>>>            End_Procedure
49908>>>>>>>>>>>>>            //AB-StoreEnd
49908>>>>>>>>>>>>>
49908>>>>>>>>>>>>>        End_Object    // oCancel_bn
49909>>>>>>>>>>>>>
49909>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
49911>>>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
49912>>>>>>>>>>>>>            Set Location to 237 426
49913>>>>>>>>>>>>>
49913>>>>>>>>>>>>>            //AB-StoreStart
49913>>>>>>>>>>>>>            Procedure OnClick
49915>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
49916>>>>>>>>>>>>>            End_Procedure
49917>>>>>>>>>>>>>            //AB-StoreEnd
49917>>>>>>>>>>>>>
49917>>>>>>>>>>>>>        End_Object    // oSearch_bn
49918>>>>>>>>>>>>>
49918>>>>>>>>>>>>>
49918>>>>>>>>>>>>>        //AB-StoreStart
49918>>>>>>>>>>>>>                
49918>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
49919>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
49920>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
49921>>>>>>>>>>>>>        
49921>>>>>>>>>>>>>        Set Locate_Mode to Center_On_Screen
49922>>>>>>>>>>>>>        
49922>>>>>>>>>>>>>        
49922>>>>>>>>>>>>>        
49922>>>>>>>>>>>>>        
49922>>>>>>>>>>>>>        
49922>>>>>>>>>>>>>        
49922>>>>>>>>>>>>>        
49922>>>>>>>>>>>>>        
49922>>>>>>>>>>>>>        
49922>>>>>>>>>>>>>        
49922>>>>>>>>>>>>>        
49922>>>>>>>>>>>>>        
49922>>>>>>>>>>>>>        //AB-StoreEnd
49922>>>>>>>>>>>>>
49922>>>>>>>>>>>>>    CD_End_Object    // SL22s
49924>>>>>>>>>>>>>>
49924>>>>>>>>>>>>>
49924>>>>>>>>>>>>>
49924>>>>>>>>>>>>>    //AB-StoreStart
49924>>>>>>>>>>>>>                                
49924>>>>>>>>>>>>>                                
49924>>>>>>>>>>>>>                                
49924>>>>>>>>>>>>>                                
49924>>>>>>>>>>>>>                                
49924>>>>>>>>>>>>>                                
49924>>>>>>>>>>>>>                                
49924>>>>>>>>>>>>>                                
49924>>>>>>>>>>>>>                                
49924>>>>>>>>>>>>>                                
49924>>>>>>>>>>>>>    //AB-StoreEnd
49924>>>>>>>>>>>>>
49924>>>>>>>>>>>>>//AB/     End_Object    // prj
49924>>>>>>>>>>>Use sl022.SL         // sl022
49924>>>>>>>>>>>
49924>>>>>>>>>>>//DDB-Selection-pkg-End
49924>>>>>>>>>>>//DDB-FileEnd
49924>>>>>>>>>    Use WITEMX.DD
INCLUDING FILE: WITEMX.DD
49924>>>>>>>>>>>//DDB-FileStart
49924>>>>>>>>>>>//DDB-HeaderStart
49924>>>>>>>>>>>
49924>>>>>>>>>>>// File Name : WITEMX.DD
49924>>>>>>>>>>>// Class Name: Witemx_DataDictionary
49924>>>>>>>>>>>// Revision  : 77
49924>>>>>>>>>>>// Version   : 2
49924>>>>>>>>>>>
49924>>>>>>>>>>>Use  Windows           // Basic Definitions
49924>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
49924>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49924>>>>>>>>>>>
49924>>>>>>>>>>>Open Witemx
49926>>>>>>>>>>>Open Witemxt
49928>>>>>>>>>>>Open Pmoves
49930>>>>>>>>>>>Open Wam
49932>>>>>>>>>>>Open Pmovesl
49934>>>>>>>>>>>Open Witemxen
INCLUDING FILE: WITEMXEN.FD
49936>>>>>>>>>>>Open Camovedd
INCLUDING FILE: CAMOVEDD.FD
49938>>>>>>>>>>>Open Wcmoves
49940>>>>>>>>>>>Open Item
49942>>>>>>>>>>>Open Sysrecw
49944>>>>>>>>>>>Open Syscurxr
49946>>>>>>>>>>>
49946>>>>>>>>>>>//DDB-HeaderEnd
49946>>>>>>>>>>>//DDB-SelectionStart
49946>>>>>>>>>>>//DDB/ ExternalSelectionList SL17  sl17.SL
49946>>>>>>>>>>>Register_Object SL17
49946>>>>>>>>>>>//DDB-SelectionEnd
49946>>>>>>>>>>>
49946>>>>>>>>>>>Class Witemx_DataDictionary  is a DataDictionary
49947>>>>>>>>>>>
49947>>>>>>>>>>>    Procedure Construct_Object
49948>>>>>>>>>>>        Forward Send Construct_Object
49950>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
49951>>>>>>>>>>>    End_Procedure //construct_object
49952>>>>>>>>>>>
49952>>>>>>>>>>>    Procedure OnConstrain
49953>>>>>>>>>>>        Forward Send OnConstrain
49955>>>>>>>>>>>        If (piMustNOTConstrain(Self)) Begin
49957>>>>>>>>>>>        End
49957>>>>>>>>>>>>
49957>>>>>>>>>>>        Else Begin
49958>>>>>>>>>>>            Constrain Witemx.Company_Code  eq SysCurXR.Company_Code
49960>>>>>>>>>>>            Constrain Witemx.Branch_Code   eq SysCurXR.Branch_Code
49962>>>>>>>>>>>            Constrain Witemx.Year_Year     eq SysCurXR.Year_Year
49964>>>>>>>>>>>        End
49964>>>>>>>>>>>>
49964>>>>>>>>>>>    End_Procedure
49965>>>>>>>>>>>
49965>>>>>>>>>>>    Procedure Save_Main_File
49966>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
49968>>>>>>>>>>>            If Witemx.Recnum Eq 0 Procedure_Return
49971>>>>>>>>>>>        End
49971>>>>>>>>>>>>
49971>>>>>>>>>>>        Forward Send Save_Main_File
49973>>>>>>>>>>>    End_Procedure
49974>>>>>>>>>>>
49974>>>>>>>>>>>    // Update:
49974>>>>>>>>>>>    Procedure Update
49975>>>>>>>>>>>        Forward Send Update
49977>>>>>>>>>>>        // Insert Code Here
49977>>>>>>>>>>>        Move SysCurXR.Company_Code  to Witemx.Company_Code
49978>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Witemx.Branch_Code
49979>>>>>>>>>>>        Move SysCurXR.Year_Year     to Witemx.Year_Year
49980>>>>>>>>>>>        Move SysCurXR.Year_Recr     to Witemx.Year_Recr
49981>>>>>>>>>>>        Move Witemkat.Witemkat_Code to Witemx.Witemkat_Code
49982>>>>>>>>>>>        Move Units.Units_Code       to Witemx.Units_Code
49983>>>>>>>>>>>        Move Item.Item_Code         to Witemx.Item_Code
49984>>>>>>>>>>>        Move Item.Item_Code         to Witemx.Witemx_Code
49985>>>>>>>>>>>        Move Item.Item_Descr        to Witemx.Witemx_Descr
49986>>>>>>>>>>>        Move Item.Wapokat_Code      to Witemx.ITEM_APOKAT_COD 
49987>>>>>>>>>>>        Move Item.link1             to witemx.link1
49988>>>>>>>>>>>        move Item.link2             to witemx.link2
49989>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Xre/Witemx.Qty_Xre),4))  to Witemx.Mesosta_Xre
49990>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Pis/Witemx.Qty_Pis),4))  to Witemx.Mesosta_Pis
49991>>>>>>>>>>>    End_Procedure   // Update
49992>>>>>>>>>>>
49992>>>>>>>>>>>
49992>>>>>>>>>>>    Procedure Backout
49993>>>>>>>>>>>        Forward Send Backout
49995>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Xre/Witemx.Qty_Xre),4))  to Witemx.Mesosta_Xre
49996>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Pis/Witemx.Qty_Pis),4))  to Witemx.Mesosta_Pis
49997>>>>>>>>>>>    End_Procedure   // Update
49998>>>>>>>>>>>
49998>>>>>>>>>>>    Procedure Creating
49999>>>>>>>>>>>        Forward Send Creating
50001>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                       (Trim(String(Witemx.Witemx_Rec0)))))) to Witemx.Witemx_Recr
50002>>>>>>>>>>>    End_Procedure   // Creating
50003>>>>>>>>>>>
50003>>>>>>>>>>>
50003>>>>>>>>>>>
50003>>>>>>>>>>>    // Define_Fields:
50003>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
50003>>>>>>>>>>>
50003>>>>>>>>>>>    Procedure Define_Fields
50004>>>>>>>>>>>        Forward Send Define_Fields
50006>>>>>>>>>>>        //DDB-Generated-Code-Location
50006>>>>>>>>>>>        //DDB-DefineFieldStart
50006>>>>>>>>>>>
50006>>>>>>>>>>>        Set Main_File            To Witemx.File_Number
50007>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
50008>>>>>>>>>>>
50008>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
50009>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
50010>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
50011>>>>>>>>>>>
50011>>>>>>>>>>>        // Child (Client) file structure................
50011>>>>>>>>>>>        Send Add_Client_File  Witemxt.File_Number
50012>>>>>>>>>>>        Send Add_Client_File  Pmoves.File_Number
50013>>>>>>>>>>>        Send Add_Client_File  Wam.File_Number
50014>>>>>>>>>>>        Send Add_Client_File  Pmovesl.File_Number
50015>>>>>>>>>>>        Send Add_Client_File  Witemxen.File_Number
50016>>>>>>>>>>>        Send Add_Client_File  Camovedd.File_Number
50017>>>>>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
50018>>>>>>>>>>>
50018>>>>>>>>>>>        // Parent (Server) file structure...............
50018>>>>>>>>>>>        Send Add_Server_File  Item.File_Number
50019>>>>>>>>>>>
50019>>>>>>>>>>>        // External (System) file structure.............
50019>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
50020>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
50021>>>>>>>>>>>
50021>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Witemx_Rec0  To Witemx.Witemx_Rec0
50024>>>>>>>>>>>
50024>>>>>>>>>>>        // Field-based properties.......................
50024>>>>>>>>>>>
50024>>>>>>>>>>>        // Witemx.Company_Code
50024>>>>>>>>>>>
50024>>>>>>>>>>>        // Witemx.Branch_Code
50024>>>>>>>>>>>
50024>>>>>>>>>>>        // Witemx.Year_Year
50024>>>>>>>>>>>
50024>>>>>>>>>>>        // Witemx.Units_Code
50024>>>>>>>>>>>
50024>>>>>>>>>>>        // Witemx.Witemkat_Code
50024>>>>>>>>>>>
50024>>>>>>>>>>>        // Witemx.Item_Code
50024>>>>>>>>>>>
50024>>>>>>>>>>>        // Witemx.Witemx_Code
50024>>>>>>>>>>>        Set Field_Options          Field Witemx.Witemx_Code To DD_AUTOFIND   
50025>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Code To (SL17(Self))
50026>>>>>>>>>>>        Set Key_Field_State        Field Witemx.Witemx_Code To TRUE
50027>>>>>>>>>>>
50027>>>>>>>>>>>        // Witemx.Witemx_Recr
50027>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Recr To (SL17(Self))
50028>>>>>>>>>>>
50028>>>>>>>>>>>        // Witemx.Year_Recr
50028>>>>>>>>>>>
50028>>>>>>>>>>>        // Witemx.Item_Recr
50028>>>>>>>>>>>
50028>>>>>>>>>>>        // Witemx.Witemx_Descr
50028>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Descr To (SL17(Self))
50029>>>>>>>>>>>
50029>>>>>>>>>>>        // Witemx.Witemx_Rec0
50029>>>>>>>>>>>
50029>>>>>>>>>>>        // Witemx.Witemx_Yeardesc
50029>>>>>>>>>>>
50029>>>>>>>>>>>        // Witemx.Item_Apokat_Cod
50029>>>>>>>>>>>
50029>>>>>>>>>>>        // Witemx.Qty_Xre
50029>>>>>>>>>>>
50029>>>>>>>>>>>        // Witemx.Qty_Pis
50029>>>>>>>>>>>
50029>>>>>>>>>>>        // Witemx.Axia_Xre
50029>>>>>>>>>>>
50029>>>>>>>>>>>        // Witemx.Axia_Pis
50029>>>>>>>>>>>
50029>>>>>>>>>>>        // Witemx.Mesosta_Xre
50029>>>>>>>>>>>
50029>>>>>>>>>>>        // Witemx.Mesosta_Pis
50029>>>>>>>>>>>
50029>>>>>>>>>>>        // Witemx.Link1
50029>>>>>>>>>>>
50029>>>>>>>>>>>        // Witemx.Link2
50029>>>>>>>>>>>
50029>>>>>>>>>>>        //DDB-DefineFieldEnd
50029>>>>>>>>>>>    End_Procedure    // Define_Fields
50030>>>>>>>>>>>
50030>>>>>>>>>>>    // Field_Defaults:
50030>>>>>>>>>>>    // This procedure is used to establish default field values.
50030>>>>>>>>>>>
50030>>>>>>>>>>>    Procedure Field_Defaults
50031>>>>>>>>>>>        Forward Send Field_Defaults
50033>>>>>>>>>>>        //DDB-Generated-Code-Location
50033>>>>>>>>>>>        //DDB-FieldDefaultStart
50033>>>>>>>>>>>        //DDB-FieldDefaultEnd
50033>>>>>>>>>>>    End_Procedure    // Field_Defaults
50034>>>>>>>>>>>
50034>>>>>>>>>>>End_Class    // Witemx_DataDictionary
50035>>>>>>>>>>>//DDB-Selection-pkg-Start
50035>>>>>>>>>>>
50035>>>>>>>>>>>Use sl17.SL          // SL17
INCLUDING FILE: SL17.SL
50035>>>>>>>>>>>>>//AB/ Project SL17:witemx
50035>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
50035>>>>>>>>>>>>>//AB/         Set ProjectName to "SL17:witemx"
50035>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl17.SL"
50035>>>>>>>>>>>>>
50035>>>>>>>>>>>>>// Project Object Structure
50035>>>>>>>>>>>>>//   SL17 is a dbModalPanelSub
50035>>>>>>>>>>>>>//     Units_DD is a DataDictionary
50035>>>>>>>>>>>>>//     Witemkat_DD is a DataDictionary
50035>>>>>>>>>>>>>//     Fpa_DD is a DataDictionary
50035>>>>>>>>>>>>>//     Item_DD is a DataDictionary
50035>>>>>>>>>>>>>//     Witemx_DD is a DataDictionary
50035>>>>>>>>>>>>>//     oSelList is a dbListSub
50035>>>>>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
50035>>>>>>>>>>>>>//     ocode is a FormSub
50035>>>>>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
50035>>>>>>>>>>>>>//     operi is a FormSub
50035>>>>>>>>>>>>>//     RadioGroupSub1 is a RadioGroupSub
50035>>>>>>>>>>>>>//       Radio1 is a RadioSub
50035>>>>>>>>>>>>>//       Radio2 is a RadioSub
50035>>>>>>>>>>>>>//     ButtonSub1 is a ButtonSub
50035>>>>>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
50035>>>>>>>>>>>>>//     ocodekat is a FormSub
50035>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
50035>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
50035>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
50035>>>>>>>>>>>>>//     btnwitemcl is a ButtonSub
50035>>>>>>>>>>>>>
50035>>>>>>>>>>>>>// Register all objects
50035>>>>>>>>>>>>>Register_Object ButtonSub1
50035>>>>>>>>>>>>>Register_Object btnwitemcl
50035>>>>>>>>>>>>>Register_Object Fpa_DD
50035>>>>>>>>>>>>>Register_Object Item_DD
50035>>>>>>>>>>>>>Register_Object oCancel_bn
50035>>>>>>>>>>>>>Register_Object ocode
50035>>>>>>>>>>>>>Register_Object ocodekat
50035>>>>>>>>>>>>>Register_Object oOK_bn
50035>>>>>>>>>>>>>Register_Object operi
50035>>>>>>>>>>>>>Register_Object oSearch_bn
50035>>>>>>>>>>>>>Register_Object oSelList
50035>>>>>>>>>>>>>Register_Object Radio1
50035>>>>>>>>>>>>>Register_Object Radio2
50035>>>>>>>>>>>>>Register_Object RadioGroupSub1
50035>>>>>>>>>>>>>Register_Object SL17
50035>>>>>>>>>>>>>Register_Object TextBoxSub1
50035>>>>>>>>>>>>>Register_Object TextBoxSub2
50035>>>>>>>>>>>>>Register_Object TextBoxSub3
50035>>>>>>>>>>>>>Register_Object Units_DD
50035>>>>>>>>>>>>>Register_Object Witemkat_DD
50035>>>>>>>>>>>>>Register_Object Witemx_DD
50035>>>>>>>>>>>>>
50035>>>>>>>>>>>>>
50035>>>>>>>>>>>>>
50035>>>>>>>>>>>>>    //AB-StoreTopStart
50035>>>>>>>>>>>>>    use dg186.dg
INCLUDING FILE: DG186.DG
50035>>>>>>>>>>>>>>>//AB/ Project dg186
50035>>>>>>>>>>>>>>>//AB/     Object prj is a Dialog_Project
50035>>>>>>>>>>>>>>>//AB/         Set ProjectName to "dg186"
50035>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "dg186.DG"
50035>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
50035>>>>>>>>>>>>>>>
50035>>>>>>>>>>>>>>>// Project Object Structure
50035>>>>>>>>>>>>>>>//   dg186 is a dbModalPanelSub
50035>>>>>>>>>>>>>>>//     Witemkat_DD is a DataDictionary
50035>>>>>>>>>>>>>>>//     Units_DD is a DataDictionary
50035>>>>>>>>>>>>>>>//     Fpa_DD is a DataDictionary
50035>>>>>>>>>>>>>>>//     Item_DD is a DataDictionary
50035>>>>>>>>>>>>>>>//     Witemcl_DD is a DataDictionary
50035>>>>>>>>>>>>>>>//     The_Table is a dbGrid
50035>>>>>>>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
50035>>>>>>>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
50035>>>>>>>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
50035>>>>>>>>>>>>>>>//     ocode is a FormSub
50035>>>>>>>>>>>>>>>//     operi is a FormSub
50035>>>>>>>>>>>>>>>//     ocodeprom is a FormSub
50035>>>>>>>>>>>>>>>//     RadioGroupSub1 is a RadioGroupSub
50035>>>>>>>>>>>>>>>//       Radio1 is a RadioSub
50035>>>>>>>>>>>>>>>//       Radio2 is a RadioSub
50035>>>>>>>>>>>>>>>//     ButtonSub1 is a ButtonSub
50035>>>>>>>>>>>>>>>//     btnwitemcl is a ButtonSub
50035>>>>>>>>>>>>>>>
50035>>>>>>>>>>>>>>>// Register all objects
50035>>>>>>>>>>>>>>>Register_Object ButtonSub1
50035>>>>>>>>>>>>>>>Register_Object btnwitemcl
50035>>>>>>>>>>>>>>>Register_Object dg186
50035>>>>>>>>>>>>>>>Register_Object Fpa_DD
50035>>>>>>>>>>>>>>>Register_Object Item_DD
50035>>>>>>>>>>>>>>>Register_Object ocode
50035>>>>>>>>>>>>>>>Register_Object ocodeprom
50035>>>>>>>>>>>>>>>Register_Object operi
50035>>>>>>>>>>>>>>>Register_Object Radio1
50035>>>>>>>>>>>>>>>Register_Object Radio2
50035>>>>>>>>>>>>>>>Register_Object RadioGroupSub1
50035>>>>>>>>>>>>>>>Register_Object TextBoxSub1
50035>>>>>>>>>>>>>>>Register_Object TextBoxSub2
50035>>>>>>>>>>>>>>>Register_Object TextBoxSub3
50035>>>>>>>>>>>>>>>Register_Object The_Table
50035>>>>>>>>>>>>>>>Register_Object Units_DD
50035>>>>>>>>>>>>>>>Register_Object Witemcl_DD
50035>>>>>>>>>>>>>>>Register_Object Witemkat_DD
50035>>>>>>>>>>>>>>>
50035>>>>>>>>>>>>>>>
50035>>>>>>>>>>>>>>>
50035>>>>>>>>>>>>>>>    //AB-StoreTopStart
50035>>>>>>>>>>>>>>>    open clients
50037>>>>>>>>>>>>>>>    use sl17.sl
50037>>>>>>>>>>>>>>>    //AB-StoreTopEnd
50037>>>>>>>>>>>>>>>
50037>>>>>>>>>>>>>>>    //AB-IgnoreStart
50037>>>>>>>>>>>>>>>
50037>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
50037>>>>>>>>>>>>>>>    Use Txtbox.Sub
50037>>>>>>>>>>>>>>>    Use Form.Sub
50037>>>>>>>>>>>>>>>    Use Rgroup.Sub
50037>>>>>>>>>>>>>>>    Use Radio.Sub
50037>>>>>>>>>>>>>>>    Use Button.Sub
50037>>>>>>>>>>>>>>>
50037>>>>>>>>>>>>>>>
50037>>>>>>>>>>>>>>>    Use WITEMKAT.DD
50037>>>>>>>>>>>>>>>    Use UNITS.DD
50037>>>>>>>>>>>>>>>    Use FPA.DD
50037>>>>>>>>>>>>>>>    Use ITEM.DD
50037>>>>>>>>>>>>>>>    Use WITEMCL.DD
INCLUDING FILE: WITEMCL.DD
50037>>>>>>>>>>>>>>>>>//DDB-FileStart
50037>>>>>>>>>>>>>>>>>//DDB-HeaderStart
50037>>>>>>>>>>>>>>>>>
50037>>>>>>>>>>>>>>>>>// File Name : WITEMCL.DD
50037>>>>>>>>>>>>>>>>>// Class Name: Witemcl_DataDictionary
50037>>>>>>>>>>>>>>>>>// Revision  : 16
50037>>>>>>>>>>>>>>>>>// Version   : 2
50037>>>>>>>>>>>>>>>>>
50037>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
50037>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
50037>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
50037>>>>>>>>>>>>>>>>>
50037>>>>>>>>>>>>>>>>>Open Witemcl
50039>>>>>>>>>>>>>>>>>Open Witemcld
50041>>>>>>>>>>>>>>>>>Open Item
50043>>>>>>>>>>>>>>>>>Open Sysrecw
50045>>>>>>>>>>>>>>>>>
50045>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
50045>>>>>>>>>>>>>>>>>//DDB-SelectionStart
50045>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList SL100  sl100.sl
50045>>>>>>>>>>>>>>>>>Register_Object SL100
50045>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
50045>>>>>>>>>>>>>>>>>
50045>>>>>>>>>>>>>>>>>Class Witemcl_DataDictionary  is a DataDictionary_Sec
50046>>>>>>>>>>>>>>>>> 
50046>>>>>>>>>>>>>>>>>    // Update:
50046>>>>>>>>>>>>>>>>> 
50046>>>>>>>>>>>>>>>>>    Procedure Update
50047>>>>>>>>>>>>>>>>>        Forward Send Update  
50049>>>>>>>>>>>>>>>>>        move item.item_descr to witemcl.item_descr
50050>>>>>>>>>>>>>>>>>    End_Procedure   // Update
50051>>>>>>>>>>>>>>>>> 
50051>>>>>>>>>>>>>>>>>
50051>>>>>>>>>>>>>>>>>    // Define_Fields:
50051>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
50051>>>>>>>>>>>>>>>>>
50051>>>>>>>>>>>>>>>>>    Procedure Define_Fields
50052>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
50054>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
50054>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
50054>>>>>>>>>>>>>>>>>
50054>>>>>>>>>>>>>>>>>        Set Main_File            To Witemcl.File_Number
50055>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
50056>>>>>>>>>>>>>>>>>
50056>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
50057>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
50058>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
50059>>>>>>>>>>>>>>>>>
50059>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
50059>>>>>>>>>>>>>>>>>        Send Add_Client_File  Witemcld.File_Number
50060>>>>>>>>>>>>>>>>>
50060>>>>>>>>>>>>>>>>>        // Parent (Server) file structure...............
50060>>>>>>>>>>>>>>>>>        Send Add_Server_File  Item.File_Number
50061>>>>>>>>>>>>>>>>>
50061>>>>>>>>>>>>>>>>>        // External (System) file structure.............
50061>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
50062>>>>>>>>>>>>>>>>>
50062>>>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Witemcl_Rec0  To Witemcl.Rec0
50065>>>>>>>>>>>>>>>>>
50065>>>>>>>>>>>>>>>>>        // Field-based properties.......................
50065>>>>>>>>>>>>>>>>>
50065>>>>>>>>>>>>>>>>>        // Witemcl.Item_Code
50065>>>>>>>>>>>>>>>>>
50065>>>>>>>>>>>>>>>>>        // Witemcl.Client_Code
50065>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemcl.Client_Code To (SL100(Self))
50066>>>>>>>>>>>>>>>>>
50066>>>>>>>>>>>>>>>>>        // Witemcl.Client_Itemcode
50066>>>>>>>>>>>>>>>>>
50066>>>>>>>>>>>>>>>>>        // Witemcl.Client_Date
50066>>>>>>>>>>>>>>>>>        Set Field_Mask_Type        Field Witemcl.Client_Date To MASK_DATE_WINDOW
50067>>>>>>>>>>>>>>>>>
50067>>>>>>>>>>>>>>>>>        // Witemcl.Client_Price
50067>>>>>>>>>>>>>>>>>        Set Field_Mask_Type        Field Witemcl.Client_Price To MASK_NUMERIC_WINDOW
50068>>>>>>>>>>>>>>>>>
50068>>>>>>>>>>>>>>>>>        // Witemcl.Item_Descr
50068>>>>>>>>>>>>>>>>>
50068>>>>>>>>>>>>>>>>>        // Witemcl.Rec0
50068>>>>>>>>>>>>>>>>>
50068>>>>>>>>>>>>>>>>>        // Witemcl.Is_Client
50068>>>>>>>>>>>>>>>>>
50068>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
50068>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
50069>>>>>>>>>>>>>>>>>
50069>>>>>>>>>>>>>>>>>    // Field_Defaults:
50069>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
50069>>>>>>>>>>>>>>>>>
50069>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
50070>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
50072>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
50072>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
50072>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
50072>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
50073>>>>>>>>>>>>>>>>>
50073>>>>>>>>>>>>>>>>>End_Class    // Witemcl_DataDictionary
50074>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
50074>>>>>>>>>>>>>>>>>
50074>>>>>>>>>>>>>>>>>Use sl100.sl         // SL100
50074>>>>>>>>>>>>>>>>>
50074>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
50074>>>>>>>>>>>>>>>>>//DDB-FileEnd
50074>>>>>>>>>>>>>>>    
50074>>>>>>>>>>>>>>>    //AB-IgnoreEnd
50074>>>>>>>>>>>>>>>
50074>>>>>>>>>>>>>>>    Object dg186 is a dbModalPanelSub
50076>>>>>>>>>>>>>>>
50076>>>>>>>>>>>>>>>        //AB-StoreTopStart
50076>>>>>>>>>>>>>>>        Function fsclient string code Returns string
50078>>>>>>>>>>>>>>>            string name
50079>>>>>>>>>>>>>>>            clear clients
50080>>>>>>>>>>>>>>>            move code to clients.client_id
50081>>>>>>>>>>>>>>>            find eq clients by index.6
50082>>>>>>>>>>>>>>>>
50082>>>>>>>>>>>>>>>            move clients.client_name to name
50083>>>>>>>>>>>>>>>            function_return name
50084>>>>>>>>>>>>>>>        end_Function
50085>>>>>>>>>>>>>>>        
50085>>>>>>>>>>>>>>>        Property String     pscode                  ''
50087>>>>>>>>>>>>>>>        Property String     psperi                  ''
50089>>>>>>>>>>>>>>>        Property Integer    piContains_Or_Starts     0
50091>>>>>>>>>>>>>>>        Property String     pscodeprom              ''
50093>>>>>>>>>>>>>>>        
50093>>>>>>>>>>>>>>>        
50093>>>>>>>>>>>>>>>        //AB-StoreTopEnd
50093>>>>>>>>>>>>>>>
50093>>>>>>>>>>>>>>>        Set Label to "‘¬©®œ«å©œ ª „ ›é¤ €§¦Ÿã¡žª"
50094>>>>>>>>>>>>>>>        Set Size to 289 527
50095>>>>>>>>>>>>>>>        Set Location to 0 2
50096>>>>>>>>>>>>>>>
50096>>>>>>>>>>>>>>>        //AB-DDOStart
50096>>>>>>>>>>>>>>>
50096>>>>>>>>>>>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
50098>>>>>>>>>>>>>>>        End_Object    // Witemkat_DD
50099>>>>>>>>>>>>>>>
50099>>>>>>>>>>>>>>>        Object Units_DD is a Units_DataDictionary
50101>>>>>>>>>>>>>>>        End_Object    // Units_DD
50102>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>        Object Fpa_DD is a Fpa_DataDictionary
50104>>>>>>>>>>>>>>>        End_Object    // Fpa_DD
50105>>>>>>>>>>>>>>>
50105>>>>>>>>>>>>>>>        Object Item_DD is a Item_DataDictionary
50107>>>>>>>>>>>>>>>            Set DDO_Server to (Units_DD(self))
50108>>>>>>>>>>>>>>>            Set DDO_Server to (Witemkat_DD(self))
50109>>>>>>>>>>>>>>>            Set DDO_Server to (Fpa_DD(self))
50110>>>>>>>>>>>>>>>        End_Object    // Item_DD
50111>>>>>>>>>>>>>>>
50111>>>>>>>>>>>>>>>        Object Witemcl_DD is a Witemcl_DataDictionary
50113>>>>>>>>>>>>>>>
50113>>>>>>>>>>>>>>>            //AB-StoreTopStart
50113>>>>>>>>>>>>>>>            Function fiPeriexei Returns Integer
50115>>>>>>>>>>>>>>>                       String lsperi lscode  lscodeprom
50116>>>>>>>>>>>>>>>                       Integer rVal liContains_Or_Starts
50116>>>>>>>>>>>>>>>                       Move 0 to rVal
50117>>>>>>>>>>>>>>>                       Get piContains_Or_Starts to liContains_Or_Starts
50118>>>>>>>>>>>>>>>                       Get psperi to lsperi
50119>>>>>>>>>>>>>>>                       Get pscode to lscode
50120>>>>>>>>>>>>>>>                       Get pscodeprom to lscodeprom
50121>>>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
50122>>>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
50123>>>>>>>>>>>>>>>                  //     Move (Trim(lscodekat)) to lscodekat
50123>>>>>>>>>>>>>>>                       If (liContains_Or_Starts=0) Begin
50125>>>>>>>>>>>>>>>                           If ((Trim(witemcl.item_descr)) Contains lsperi) Begin
50127>>>>>>>>>>>>>>>                               If ((Trim(witemcl.item_code)) Contains lscode) Move 1 to rVal
50130>>>>>>>>>>>>>>>                           End
50130>>>>>>>>>>>>>>>>
50130>>>>>>>>>>>>>>>            
50130>>>>>>>>>>>>>>>                       End
50130>>>>>>>>>>>>>>>>
50130>>>>>>>>>>>>>>>                       Else Begin
50131>>>>>>>>>>>>>>>                           If (Left(witemcl.item_descr,(Length(lsperi)))=lsperi) Begin
50133>>>>>>>>>>>>>>>                               If (Left(witemcl.item_code,(Length(lscode)))=lscode) Move 1 to rVal
50136>>>>>>>>>>>>>>>                           End
50136>>>>>>>>>>>>>>>>
50136>>>>>>>>>>>>>>>            
50136>>>>>>>>>>>>>>>                       End
50136>>>>>>>>>>>>>>>>
50136>>>>>>>>>>>>>>>                       Function_Return rVal
50137>>>>>>>>>>>>>>>                   End_Function
50138>>>>>>>>>>>>>>>            
50138>>>>>>>>>>>>>>>                   Function fiArxizeiperi Returns Integer
50140>>>>>>>>>>>>>>>                       String lsperi
50141>>>>>>>>>>>>>>>                       Get psperi to lsperi
50142>>>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
50143>>>>>>>>>>>>>>>                       Function_Return (Left(witemcl.item_descr,(Length(lsperi)))=lsperi)
50144>>>>>>>>>>>>>>>                   End_Function
50145>>>>>>>>>>>>>>>            
50145>>>>>>>>>>>>>>>                   Function fiArxizeicode Returns Integer
50147>>>>>>>>>>>>>>>                       String lscode lscodeprom
50148>>>>>>>>>>>>>>>                       Get pscode to lscode
50149>>>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
50150>>>>>>>>>>>>>>>                       Function_Return (Left(witemcl.item_code,(Length(lscode)))=lscode)
50151>>>>>>>>>>>>>>>                   End_Function
50152>>>>>>>>>>>>>>>            
50152>>>>>>>>>>>>>>>            //AB-StoreTopEnd
50152>>>>>>>>>>>>>>>
50152>>>>>>>>>>>>>>>            Set DDO_Server to (Item_DD(self))
50153>>>>>>>>>>>>>>>
50153>>>>>>>>>>>>>>>            //AB-StoreStart
50153>>>>>>>>>>>>>>>                                                                
50153>>>>>>>>>>>>>>>                                                                
50153>>>>>>>>>>>>>>>            Begin_Constraints
50155>>>>>>>>>>>>>>>               String lsperi lscode lsvalue lstype lscodeprom
50156>>>>>>>>>>>>>>>               Integer liContains_Or_Starts
50156>>>>>>>>>>>>>>>                   Get psperi  to lsperi
50157>>>>>>>>>>>>>>>                   Get pscode  to lscode
50158>>>>>>>>>>>>>>>                   Get pscodeprom  to lscodeprom
50159>>>>>>>>>>>>>>>                   Get piContains_Or_Starts to liContains_Or_Starts
50160>>>>>>>>>>>>>>>                   Move (Trim(lsperi)) to lsperi
50161>>>>>>>>>>>>>>>                   Move (Trim(lscode)) to lscode
50162>>>>>>>>>>>>>>>                   Move (Trim(lscodeprom)) to lscodeprom
50163>>>>>>>>>>>>>>>                   If ((lsperi<>'') and ;                      (lscode<>'')) Constrain witemcl as (fiPeriexei(Self)=1)
50166>>>>>>>>>>>>>>>                   Else Begin
50167>>>>>>>>>>>>>>>                      If (liContains_Or_Starts=0) Begin
50169>>>>>>>>>>>>>>>                      If (lsperi<>'') Constrain witemcl.item_descr Contains lsperi
50173>>>>>>>>>>>>>>>                      Else If (lscode<>'') Constrain witemcl.item_code Contains lscode
50178>>>>>>>>>>>>>>>                      End
50178>>>>>>>>>>>>>>>>
50178>>>>>>>>>>>>>>>                   Else Begin
50179>>>>>>>>>>>>>>>                       If (lsperi<>'') Constrain witemcl as (fiArxizeiperi(Self)=1) //witemcl.item_descr
50182>>>>>>>>>>>>>>>                       Else If (lscode<>'') Constrain witemcl as (fiArxizeicode(Self)=1) //witemcl.item_code
50186>>>>>>>>>>>>>>>                       End
50186>>>>>>>>>>>>>>>>
50186>>>>>>>>>>>>>>>                   End
50186>>>>>>>>>>>>>>>>
50186>>>>>>>>>>>>>>>                   If (lscodeprom<>'') Constrain witemcl.client_itemcode Contains lscodeprom
50190>>>>>>>>>>>>>>>            
50190>>>>>>>>>>>>>>>            End_Constraints
50193>>>>>>>>>>>>>>>            
50193>>>>>>>>>>>>>>>            
50193>>>>>>>>>>>>>>>            //AB-StoreEnd
50193>>>>>>>>>>>>>>>
50193>>>>>>>>>>>>>>>        End_Object    // Witemcl_DD
50194>>>>>>>>>>>>>>>
50194>>>>>>>>>>>>>>>        Set Main_DD to (Witemcl_DD(self))
50195>>>>>>>>>>>>>>>        Set Server to (Witemcl_DD(self))
50196>>>>>>>>>>>>>>>
50196>>>>>>>>>>>>>>>        //AB-DDOEnd
50196>>>>>>>>>>>>>>>
50196>>>>>>>>>>>>>>>        Object The_Table is a dbGrid
50198>>>>>>>>>>>>>>>            Set Main_File to Witemcl.File_Number
50199>>>>>>>>>>>>>>>            Set Size to 201 519
50200>>>>>>>>>>>>>>>            Set Location to 3 2
50201>>>>>>>>>>>>>>>            Set Color to 14280447
50202>>>>>>>>>>>>>>>            Set CurrentRowColor to 11783679
50203>>>>>>>>>>>>>>>            Set CurrentCellColor to 11783679
50204>>>>>>>>>>>>>>>            Set Wrap_State to TRUE
50205>>>>>>>>>>>>>>>
50205>>>>>>>>>>>>>>>            Begin_Row
50208>>>>>>>>>>>>>>>                Entry_Item Witemcl.Item_code
50209>>>>>>>>>>>>>>>                Entry_Item Witemcl.Client_itemcode
50210>>>>>>>>>>>>>>>                Entry_Item Witemcl.Item_descr
50211>>>>>>>>>>>>>>>                Entry_Item Witemcl.Client_code
50212>>>>>>>>>>>>>>>                Entry_Item (fsclient(self,witemcl.client_code))
50213>>>>>>>>>>>>>>>            End_Row
50218>>>>>>>>>>>>>>>
50218>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 100
50219>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª „å›¦¬ª"
50220>>>>>>>>>>>>>>>            
50220>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 100
50221>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "„å›¦ª ¨¦£žŸœ¬«ã"
50222>>>>>>>>>>>>>>>            
50222>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 200
50223>>>>>>>>>>>>>>>            Set Header_Label  item 2 to "œ¨ š¨˜­ã „å›¦¬ª"
50224>>>>>>>>>>>>>>>            
50224>>>>>>>>>>>>>>>            Set Form_Width    item 3 to 0
50225>>>>>>>>>>>>>>>            Set Header_Label  item 3 to ""
50226>>>>>>>>>>>>>>>            
50226>>>>>>>>>>>>>>>            Set Form_Width    item 4 to 111
50227>>>>>>>>>>>>>>>            Set Header_Label  item 4 to "¨¦£žŸœ¬«ãª"
50228>>>>>>>>>>>>>>>            
50228>>>>>>>>>>>>>>>
50228>>>>>>>>>>>>>>>            //AB-StoreStart
50228>>>>>>>>>>>>>>>            Set Column_Option Item 3 to NoEnter True
50229>>>>>>>>>>>>>>>            //set read_only_state to true
50229>>>>>>>>>>>>>>>            set no_create_state to true
50230>>>>>>>>>>>>>>>            set no_delete_state to true
50231>>>>>>>>>>>>>>>            //AB-StoreEnd
50231>>>>>>>>>>>>>>>
50231>>>>>>>>>>>>>>>        End_Object    // The_Table
50232>>>>>>>>>>>>>>>
50232>>>>>>>>>>>>>>>        Object TextBoxSub1 is a TextBoxSub
50234>>>>>>>>>>>>>>>            Set Label to "‘á¨à©ž ‰à› ¡¦ç ‚ á"
50235>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
50236>>>>>>>>>>>>>>>            Set Location to 208 5
50237>>>>>>>>>>>>>>>            Set Size to 13 78
50238>>>>>>>>>>>>>>>        End_Object    // TextBoxSub1
50239>>>>>>>>>>>>>>>
50239>>>>>>>>>>>>>>>        Object TextBoxSub2 is a TextBoxSub
50241>>>>>>>>>>>>>>>            Set Label to "‘á¨à©ž œ¨ š¨˜­ãª "
50242>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
50243>>>>>>>>>>>>>>>            Set Location to 223 5
50244>>>>>>>>>>>>>>>            Set Size to 13 83
50245>>>>>>>>>>>>>>>        End_Object    // TextBoxSub2
50246>>>>>>>>>>>>>>>
50246>>>>>>>>>>>>>>>        Object TextBoxSub3 is a TextBoxSub
50248>>>>>>>>>>>>>>>            Set Label to "„å›¦ª ¨¦£žŸœ¬«ã ‚ á"
50249>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
50250>>>>>>>>>>>>>>>            Set Location to 237 5
50251>>>>>>>>>>>>>>>            Set Size to 13 78
50252>>>>>>>>>>>>>>>        End_Object    // TextBoxSub3
50253>>>>>>>>>>>>>>>
50253>>>>>>>>>>>>>>>        Object ocode is a FormSub
50255>>>>>>>>>>>>>>>            Set Size to 13 197
50256>>>>>>>>>>>>>>>            Set Location to 209 91
50257>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
50258>>>>>>>>>>>>>>>
50258>>>>>>>>>>>>>>>            //AB-StoreStart
50258>>>>>>>>>>>>>>>                                                                                                                                                                                                    
50258>>>>>>>>>>>>>>>            Procedure OnKILLFOCUS
50260>>>>>>>>>>>>>>>               Send KeyAction to ButtonSub1
50261>>>>>>>>>>>>>>>            End_Procedure
50262>>>>>>>>>>>>>>>            
50262>>>>>>>>>>>>>>>            
50262>>>>>>>>>>>>>>>            
50262>>>>>>>>>>>>>>>            
50262>>>>>>>>>>>>>>>            //AB-StoreEnd
50262>>>>>>>>>>>>>>>
50262>>>>>>>>>>>>>>>        End_Object    // ocode
50263>>>>>>>>>>>>>>>
50263>>>>>>>>>>>>>>>        Object operi is a FormSub
50265>>>>>>>>>>>>>>>            Set Size to 13 197
50266>>>>>>>>>>>>>>>            Set Location to 223 91
50267>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
50268>>>>>>>>>>>>>>>
50268>>>>>>>>>>>>>>>            //AB-StoreStart
50268>>>>>>>>>>>>>>>                                                                                                                                                                                                    
50268>>>>>>>>>>>>>>>            Procedure OnKILLFOCUS
50270>>>>>>>>>>>>>>>              Send KeyAction to ButtonSub1
50271>>>>>>>>>>>>>>>            End_Procedure
50272>>>>>>>>>>>>>>>            
50272>>>>>>>>>>>>>>>            
50272>>>>>>>>>>>>>>>            
50272>>>>>>>>>>>>>>>            
50272>>>>>>>>>>>>>>>            //AB-StoreEnd
50272>>>>>>>>>>>>>>>
50272>>>>>>>>>>>>>>>        End_Object    // operi
50273>>>>>>>>>>>>>>>
50273>>>>>>>>>>>>>>>        Object ocodeprom is a FormSub
50275>>>>>>>>>>>>>>>            Set Size to 13 197
50276>>>>>>>>>>>>>>>            Set Location to 238 91
50277>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
50278>>>>>>>>>>>>>>>
50278>>>>>>>>>>>>>>>            //AB-StoreStart
50278>>>>>>>>>>>>>>>                                                                                                                                                                                                    
50278>>>>>>>>>>>>>>>            Procedure OnKILLFOCUS
50280>>>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
50281>>>>>>>>>>>>>>>            End_Procedure
50282>>>>>>>>>>>>>>>            
50282>>>>>>>>>>>>>>>            
50282>>>>>>>>>>>>>>>            
50282>>>>>>>>>>>>>>>            //AB-StoreEnd
50282>>>>>>>>>>>>>>>
50282>>>>>>>>>>>>>>>        End_Object    // ocodeprom
50283>>>>>>>>>>>>>>>
50283>>>>>>>>>>>>>>>        Object RadioGroupSub1 is a RadioGroupSub
50285>>>>>>>>>>>>>>>            Set Size to 32 77
50286>>>>>>>>>>>>>>>            Set Location to 209 296
50287>>>>>>>>>>>>>>>            Object Radio1 is a RadioSub
50289>>>>>>>>>>>>>>>                Set Label to "œ¨ â®œ«˜ "
50290>>>>>>>>>>>>>>>                Set Size to 10 53
50291>>>>>>>>>>>>>>>                Set Location to 7 5
50292>>>>>>>>>>>>>>>            End_Object    // Radio1
50293>>>>>>>>>>>>>>>
50293>>>>>>>>>>>>>>>            Object Radio2 is a RadioSub
50295>>>>>>>>>>>>>>>                Set Label to "€¨®åœ  €§æ"
50296>>>>>>>>>>>>>>>                Set Size to 10 51
50297>>>>>>>>>>>>>>>                Set Location to 21 5
50298>>>>>>>>>>>>>>>            End_Object    // Radio2
50299>>>>>>>>>>>>>>>
50299>>>>>>>>>>>>>>>
50299>>>>>>>>>>>>>>>            //AB-StoreStart
50299>>>>>>>>>>>>>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
50299>>>>>>>>>>>>>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
50301>>>>>>>>>>>>>>>                //iToItem=0 => Contains, =1 => Starts with
50301>>>>>>>>>>>>>>>                Set piContains_Or_Starts to iToItem
50302>>>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
50303>>>>>>>>>>>>>>>            End_Procedure
50304>>>>>>>>>>>>>>>            
50304>>>>>>>>>>>>>>>            // If you set Current_radio you must set this after the
50304>>>>>>>>>>>>>>>            // radio objects have been created AND after Notify_select_State has been
50304>>>>>>>>>>>>>>>            // created. i.e. Set in bottom-code at end!!
50304>>>>>>>>>>>>>>>            //Set Current_Radio to 0
50304>>>>>>>>>>>>>>>            
50304>>>>>>>>>>>>>>>            
50304>>>>>>>>>>>>>>>            //AB-StoreEnd
50304>>>>>>>>>>>>>>>
50304>>>>>>>>>>>>>>>        End_Object    // RadioGroupSub1
50305>>>>>>>>>>>>>>>
50305>>>>>>>>>>>>>>>        Object ButtonSub1 is a ButtonSub
50307>>>>>>>>>>>>>>>            Set Label to "Search"
50308>>>>>>>>>>>>>>>            Set Size to 28 37
50309>>>>>>>>>>>>>>>            Set Location to 210 413
50310>>>>>>>>>>>>>>>            Set Form_FontWeight Item 0 to 800
50311>>>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "ms sans serif"
50312>>>>>>>>>>>>>>>
50312>>>>>>>>>>>>>>>            //AB-StoreStart
50312>>>>>>>>>>>>>>>                                        
50312>>>>>>>>>>>>>>>            Set Visible_State to False
50313>>>>>>>>>>>>>>>            
50313>>>>>>>>>>>>>>>            Procedure OnClick
50315>>>>>>>>>>>>>>>                Forward Send OnClick
50317>>>>>>>>>>>>>>>                Set pscode  to (Value(ocode(Self),0))
50318>>>>>>>>>>>>>>>                Set psperi  to (Value(operi(Self),0))
50319>>>>>>>>>>>>>>>                Set pscodeprom  to (Value(ocodeprom(Self),0))
50320>>>>>>>>>>>>>>>                send Rebuild_Constraints    to (witemcl_DD(Self))
50321>>>>>>>>>>>>>>>                Send Beginning_Of_Data      to the_table
50322>>>>>>>>>>>>>>>            End_Procedure // OnClick
50323>>>>>>>>>>>>>>>            
50323>>>>>>>>>>>>>>>            
50323>>>>>>>>>>>>>>>            
50323>>>>>>>>>>>>>>>            
50323>>>>>>>>>>>>>>>            
50323>>>>>>>>>>>>>>>            
50323>>>>>>>>>>>>>>>            
50323>>>>>>>>>>>>>>>            
50323>>>>>>>>>>>>>>>            
50323>>>>>>>>>>>>>>>            
50323>>>>>>>>>>>>>>>            
50323>>>>>>>>>>>>>>>            
50323>>>>>>>>>>>>>>>            
50323>>>>>>>>>>>>>>>            
50323>>>>>>>>>>>>>>>            
50323>>>>>>>>>>>>>>>            //AB-StoreEnd
50323>>>>>>>>>>>>>>>
50323>>>>>>>>>>>>>>>        End_Object    // ButtonSub1
50324>>>>>>>>>>>>>>>
50324>>>>>>>>>>>>>>>        Object btnwitemcl is a ButtonSub
50326>>>>>>>>>>>>>>>
50326>>>>>>>>>>>>>>>            //AB-StoreTopStart
50326>>>>>>>>>>>>>>>                                                                                    
50326>>>>>>>>>>>>>>>            //AB-StoreTopEnd
50326>>>>>>>>>>>>>>>
50326>>>>>>>>>>>>>>>            Set Label to "ButtonSub1"
50327>>>>>>>>>>>>>>>            Set Bitmap to "Filesys3.bmp"
50328>>>>>>>>>>>>>>>            Set Size to 22 25
50329>>>>>>>>>>>>>>>            Set Location to 214 482
50330>>>>>>>>>>>>>>>            Set Focus_Mode to Pointer_Only
50331>>>>>>>>>>>>>>>
50331>>>>>>>>>>>>>>>            //AB-StoreStart
50331>>>>>>>>>>>>>>>                                                                                    
50331>>>>>>>>>>>>>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«¦ œ¬¨œ«ã¨ ¦ „ ›é¤"
50332>>>>>>>>>>>>>>>            
50332>>>>>>>>>>>>>>>            Procedure OnClick
50334>>>>>>>>>>>>>>>                String  scode speri
50335>>>>>>>>>>>>>>>                Get value of (ocode(self)) to scode
50336>>>>>>>>>>>>>>>                Get value of (operi(self)) to speri
50337>>>>>>>>>>>>>>>                set pscode of (sl17(self)) to scode
50338>>>>>>>>>>>>>>>                set psperi of (sl17(self)) to speri
50339>>>>>>>>>>>>>>>                send request_cancel to dg186
50340>>>>>>>>>>>>>>>            End_Procedure // OnClick
50341>>>>>>>>>>>>>>>            
50341>>>>>>>>>>>>>>>            
50341>>>>>>>>>>>>>>>            
50341>>>>>>>>>>>>>>>            
50341>>>>>>>>>>>>>>>            
50341>>>>>>>>>>>>>>>            
50341>>>>>>>>>>>>>>>            
50341>>>>>>>>>>>>>>>            
50341>>>>>>>>>>>>>>>            
50341>>>>>>>>>>>>>>>            
50341>>>>>>>>>>>>>>>            
50341>>>>>>>>>>>>>>>            
50341>>>>>>>>>>>>>>>            
50341>>>>>>>>>>>>>>>            
50341>>>>>>>>>>>>>>>            
50341>>>>>>>>>>>>>>>            
50341>>>>>>>>>>>>>>>            
50341>>>>>>>>>>>>>>>            
50341>>>>>>>>>>>>>>>            
50341>>>>>>>>>>>>>>>            
50341>>>>>>>>>>>>>>>            
50341>>>>>>>>>>>>>>>            //AB-StoreEnd
50341>>>>>>>>>>>>>>>
50341>>>>>>>>>>>>>>>        End_Object    // btnwitemcl
50342>>>>>>>>>>>>>>>
50342>>>>>>>>>>>>>>>
50342>>>>>>>>>>>>>>>        //AB-StoreStart
50342>>>>>>>>>>>>>>>        Procedure Activating
50344>>>>>>>>>>>>>>>           integer rval
50345>>>>>>>>>>>>>>>           set value of (ocode(self)) to (pscode(self))
50346>>>>>>>>>>>>>>>           set value of (operi(self)) to (psperi(self))
50347>>>>>>>>>>>>>>>           Send Rebuild_Constraints to (witemcl_DD(Self))
50348>>>>>>>>>>>>>>>           Forward send Activating
50350>>>>>>>>>>>>>>>        
50350>>>>>>>>>>>>>>>        End_Procedure
50351>>>>>>>>>>>>>>>        
50351>>>>>>>>>>>>>>>        
50351>>>>>>>>>>>>>>>        
50351>>>>>>>>>>>>>>>        
50351>>>>>>>>>>>>>>>        
50351>>>>>>>>>>>>>>>        
50351>>>>>>>>>>>>>>>        //AB-StoreEnd
50351>>>>>>>>>>>>>>>
50351>>>>>>>>>>>>>>>    End_Object    // dg186
50352>>>>>>>>>>>>>>>
50352>>>>>>>>>>>>>>>
50352>>>>>>>>>>>>>>>    //AB-StoreStart
50352>>>>>>>>>>>>>>>        
50352>>>>>>>>>>>>>>>    //AB-StoreEnd
50352>>>>>>>>>>>>>>>
50352>>>>>>>>>>>>>>>//AB/     End_Object    // prj
50352>>>>>>>>>>>>>    //AB-StoreTopEnd
50352>>>>>>>>>>>>>
50352>>>>>>>>>>>>>    //AB-IgnoreStart
50352>>>>>>>>>>>>>
50352>>>>>>>>>>>>>    Use DFAllEnt.pkg
50352>>>>>>>>>>>>>    Use dbList.Sub
50352>>>>>>>>>>>>>    Use Txtbox.Sub
50352>>>>>>>>>>>>>    Use Form.Sub
50352>>>>>>>>>>>>>    Use Rgroup.Sub
50352>>>>>>>>>>>>>    Use Radio.Sub
50352>>>>>>>>>>>>>    Use Button.Sub
50352>>>>>>>>>>>>>
50352>>>>>>>>>>>>>
50352>>>>>>>>>>>>>    Use UNITS.DD
50352>>>>>>>>>>>>>    Use WITEMKAT.DD
50352>>>>>>>>>>>>>    Use FPA.DD
50352>>>>>>>>>>>>>    Use ITEM.DD
50352>>>>>>>>>>>>>    Use WITEMX.DD
50352>>>>>>>>>>>>>    
50352>>>>>>>>>>>>>    //AB-IgnoreEnd
50352>>>>>>>>>>>>>
50352>>>>>>>>>>>>>    Object SL17 is a dbModalPanelSub
50354>>>>>>>>>>>>>
50354>>>>>>>>>>>>>        //AB-StoreTopStart
50354>>>>>>>>>>>>>                
50354>>>>>>>>>>>>>        Property String     pscode                  ''
50356>>>>>>>>>>>>>        Property String     psperi                  ''
50358>>>>>>>>>>>>>        Property Integer    piContains_Or_Starts     0
50360>>>>>>>>>>>>>        Property String     pscodekat               ''
50362>>>>>>>>>>>>>        
50362>>>>>>>>>>>>>        //AB-StoreTopEnd
50362>>>>>>>>>>>>>
50362>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
50363>>>>>>>>>>>>>        Set Label to "„¬¨œ«ã¨ ¦ €¨®œå¦¬ „ ›é¤"
50364>>>>>>>>>>>>>        Set Size to 266 484
50365>>>>>>>>>>>>>        Set Location to 9 14
50366>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
50367>>>>>>>>>>>>>        Set Modal_State to FALSE
50368>>>>>>>>>>>>>
50368>>>>>>>>>>>>>        //AB-DDOStart
50368>>>>>>>>>>>>>
50368>>>>>>>>>>>>>        Object Units_DD is a Units_DataDictionary
50370>>>>>>>>>>>>>        End_Object    // Units_DD
50371>>>>>>>>>>>>>
50371>>>>>>>>>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
50373>>>>>>>>>>>>>        End_Object    // Witemkat_DD
50374>>>>>>>>>>>>>
50374>>>>>>>>>>>>>        Object Fpa_DD is a Fpa_DataDictionary
50376>>>>>>>>>>>>>        End_Object    // Fpa_DD
50377>>>>>>>>>>>>>
50377>>>>>>>>>>>>>        Object Item_DD is a Item_DataDictionary
50379>>>>>>>>>>>>>
50379>>>>>>>>>>>>>            //AB-StoreTopStart
50379>>>>>>>>>>>>>                                                                                                    
50379>>>>>>>>>>>>>                                                                                                    
50379>>>>>>>>>>>>>            //AB-StoreTopEnd
50379>>>>>>>>>>>>>
50379>>>>>>>>>>>>>            Set DDO_Server to (Units_DD(self))
50380>>>>>>>>>>>>>            Set DDO_Server to (Witemkat_DD(self))
50381>>>>>>>>>>>>>            Set DDO_Server to (Fpa_DD(self))
50382>>>>>>>>>>>>>
50382>>>>>>>>>>>>>            //AB-StoreStart
50382>>>>>>>>>>>>>                                                                                                    
50382>>>>>>>>>>>>>                                                                                                    
50382>>>>>>>>>>>>>                                                                                                    
50382>>>>>>>>>>>>>                                                                                                    
50382>>>>>>>>>>>>>                                                                                                    
50382>>>>>>>>>>>>>                                                                                                    
50382>>>>>>>>>>>>>                                                                                                    
50382>>>>>>>>>>>>>                                                                                                    
50382>>>>>>>>>>>>>            //AB-StoreEnd
50382>>>>>>>>>>>>>
50382>>>>>>>>>>>>>        End_Object    // Item_DD
50383>>>>>>>>>>>>>
50383>>>>>>>>>>>>>        Object Witemx_DD is a Witemx_DataDictionary
50385>>>>>>>>>>>>>
50385>>>>>>>>>>>>>            //AB-StoreTopStart
50385>>>>>>>>>>>>>            Function fiPeriexei Returns Integer
50387>>>>>>>>>>>>>                       String lsperi lscode  lscodekat
50388>>>>>>>>>>>>>                       Integer rVal liContains_Or_Starts
50388>>>>>>>>>>>>>                       Move 0 to rVal
50389>>>>>>>>>>>>>                       Get piContains_Or_Starts to liContains_Or_Starts
50390>>>>>>>>>>>>>                       Get psperi to lsperi
50391>>>>>>>>>>>>>                       Get pscode to lscode
50392>>>>>>>>>>>>>                       Get pscodekat to lscodekat
50393>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
50394>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
50395>>>>>>>>>>>>>                       If (liContains_Or_Starts=0) Begin
50397>>>>>>>>>>>>>                           If ((Trim(witemx.witemx_descr)) Contains lsperi) Begin
50399>>>>>>>>>>>>>                               If ((Trim(witemx.witemx_code)) Contains lscode) Move 1 to rVal
50402>>>>>>>>>>>>>                           End
50402>>>>>>>>>>>>>>
50402>>>>>>>>>>>>>                       End
50402>>>>>>>>>>>>>>
50402>>>>>>>>>>>>>                       Else Begin
50403>>>>>>>>>>>>>                           If (Left(witemx.witemx_descr,(Length(lsperi)))=lsperi) Begin
50405>>>>>>>>>>>>>                               If (Left(witemx.witemx_code,(Length(lscode)))=lscode) Move 1 to rVal
50408>>>>>>>>>>>>>                           End
50408>>>>>>>>>>>>>>
50408>>>>>>>>>>>>>                       End
50408>>>>>>>>>>>>>>
50408>>>>>>>>>>>>>                       Function_Return rVal
50409>>>>>>>>>>>>>                   End_Function
50410>>>>>>>>>>>>>            
50410>>>>>>>>>>>>>                   Function fiArxizeiperi Returns Integer
50412>>>>>>>>>>>>>                       String lsperi
50413>>>>>>>>>>>>>                       Get psperi to lsperi
50414>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
50415>>>>>>>>>>>>>                       Function_Return (Left(witemx.witemx_descr,(Length(lsperi)))=lsperi)
50416>>>>>>>>>>>>>                   End_Function
50417>>>>>>>>>>>>>            
50417>>>>>>>>>>>>>                   Function fiArxizeicode Returns Integer
50419>>>>>>>>>>>>>                       String lscode lscodekat
50420>>>>>>>>>>>>>                       Get pscode to lscode
50421>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
50422>>>>>>>>>>>>>                       Function_Return (Left(witemx.witemx_code,(Length(lscode)))=lscode)
50423>>>>>>>>>>>>>                   End_Function
50424>>>>>>>>>>>>>            //AB-StoreTopEnd
50424>>>>>>>>>>>>>
50424>>>>>>>>>>>>>            Set DDO_Server to (Item_DD(self))
50425>>>>>>>>>>>>>
50425>>>>>>>>>>>>>            //AB-StoreStart
50425>>>>>>>>>>>>>                                                                                
50425>>>>>>>>>>>>>            Begin_Constraints
50427>>>>>>>>>>>>>               String lsperi lscode lsvalue lstype lscodekat
50428>>>>>>>>>>>>>               Integer liContains_Or_Starts
50428>>>>>>>>>>>>>               Get psperi               to lsperi
50429>>>>>>>>>>>>>               Get pscode               to lscode
50430>>>>>>>>>>>>>               Get pscodekat            to lscodekat
50431>>>>>>>>>>>>>               Get piContains_Or_Starts to liContains_Or_Starts
50432>>>>>>>>>>>>>               Move (Trim(lsperi))      to lsperi
50433>>>>>>>>>>>>>               Move (Trim(lscode))      to lscode
50434>>>>>>>>>>>>>               Move (Trim(lscodekat))   to lscodekat
50435>>>>>>>>>>>>>               Set Ordering to 4
50436>>>>>>>>>>>>>               If ((lsperi<>'') and (lscode<>'')) Begin
50438>>>>>>>>>>>>>                    Set Ordering to 4
50439>>>>>>>>>>>>>                    Constrain witemx as (fiPeriexei(Self)=1)
50440>>>>>>>>>>>>>               End
50440>>>>>>>>>>>>>>
50440>>>>>>>>>>>>>               Else Begin
50441>>>>>>>>>>>>>                  If (liContains_Or_Starts=0) Begin
50443>>>>>>>>>>>>>                        If (lsperi<>'') Begin
50445>>>>>>>>>>>>>                            Set Ordering to 3
50446>>>>>>>>>>>>>                            Constrain witemx.witemx_descr Contains lsperi
50448>>>>>>>>>>>>>                        End
50448>>>>>>>>>>>>>>
50448>>>>>>>>>>>>>                        Else If (lscode<>'') Begin
50451>>>>>>>>>>>>>                            Set Ordering to 4
50452>>>>>>>>>>>>>                            Constrain witemx.witemx_code Contains lscode
50454>>>>>>>>>>>>>                        End
50454>>>>>>>>>>>>>>
50454>>>>>>>>>>>>>                  End
50454>>>>>>>>>>>>>>
50454>>>>>>>>>>>>>                  Else Begin
50455>>>>>>>>>>>>>                        If (lsperi<>'') Begin
50457>>>>>>>>>>>>>                            Set Ordering to 3
50458>>>>>>>>>>>>>                            Constrain witemx as (fiArxizeiperi(Self)=1) //witemx.witemx_descr
50459>>>>>>>>>>>>>                        End
50459>>>>>>>>>>>>>>
50459>>>>>>>>>>>>>                        Else If (lscode<>'') Begin
50462>>>>>>>>>>>>>                            Set Ordering to 4
50463>>>>>>>>>>>>>                            Constrain witemx as (fiArxizeicode(Self)=1) //witemx.witemx_code
50464>>>>>>>>>>>>>                        End
50464>>>>>>>>>>>>>>
50464>>>>>>>>>>>>>                  End
50464>>>>>>>>>>>>>>
50464>>>>>>>>>>>>>                  If (lscodekat<>'') Begin
50466>>>>>>>>>>>>>                        Constrain witemx.witemkat_code Contains lscodekat
50468>>>>>>>>>>>>>                  End
50468>>>>>>>>>>>>>>
50468>>>>>>>>>>>>>               End
50468>>>>>>>>>>>>>>
50468>>>>>>>>>>>>>            End_Constraints
50471>>>>>>>>>>>>>            
50471>>>>>>>>>>>>>            
50471>>>>>>>>>>>>>            //AB-StoreEnd
50471>>>>>>>>>>>>>
50471>>>>>>>>>>>>>        End_Object    // Witemx_DD
50472>>>>>>>>>>>>>
50472>>>>>>>>>>>>>        Set Main_DD to (Witemx_DD(self))
50473>>>>>>>>>>>>>        Set Server to (Witemx_DD(self))
50474>>>>>>>>>>>>>
50474>>>>>>>>>>>>>        //AB-DDOEnd
50474>>>>>>>>>>>>>
50474>>>>>>>>>>>>>        Object oSelList is a dbListSub
50476>>>>>>>>>>>>>            Set Main_File to Witemx.File_Number
50477>>>>>>>>>>>>>            Set Ordering to 5
50478>>>>>>>>>>>>>            Set Size to 190 475
50479>>>>>>>>>>>>>            Set Location to 1 1
50480>>>>>>>>>>>>>            Set Color to 14280447
50481>>>>>>>>>>>>>            Set CurrentRowColor to 11783679
50482>>>>>>>>>>>>>            Set CurrentCellColor to 11783679
50483>>>>>>>>>>>>>            Set Auto_Index_State to FALSE
50484>>>>>>>>>>>>>
50484>>>>>>>>>>>>>            Begin_Row
50487>>>>>>>>>>>>>                Entry_Item Witemx.Witemx_code
50488>>>>>>>>>>>>>                Entry_Item Witemx.Witemx_descr
50489>>>>>>>>>>>>>                Entry_Item Witemx.Witemkat_code
50490>>>>>>>>>>>>>                Entry_Item Witemkat.Witemkat_descr
50491>>>>>>>>>>>>>                Entry_Item Item.Item_qual
50492>>>>>>>>>>>>>                Entry_Item Fpa.Fpa_pososto
50493>>>>>>>>>>>>>            End_Row
50498>>>>>>>>>>>>>
50498>>>>>>>>>>>>>            Set Form_Width    item 0 to 60
50499>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à›. „å›¦¬ª"
50500>>>>>>>>>>>>>            
50500>>>>>>>>>>>>>            Set Form_Width    item 1 to 140
50501>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
50502>>>>>>>>>>>>>            
50502>>>>>>>>>>>>>            Set Form_Width    item 2 to 70
50503>>>>>>>>>>>>>            Set Header_Label  item 2 to "‰à›. ‰˜«žš¦¨å˜ª"
50504>>>>>>>>>>>>>            
50504>>>>>>>>>>>>>            Set Form_Width    item 3 to 88
50505>>>>>>>>>>>>>            Set Header_Label  item 3 to "œ¨ š¨˜­ã ‰˜«žš."
50506>>>>>>>>>>>>>            
50506>>>>>>>>>>>>>            Set Form_Width    item 4 to 64
50507>>>>>>>>>>>>>            Set Header_Label  item 4 to "¦ æ«ž«˜"
50508>>>>>>>>>>>>>            
50508>>>>>>>>>>>>>            Set Form_Width    item 5 to 45
50509>>>>>>>>>>>>>            Set Header_Label  item 5 to "‰˜«.”..€"
50510>>>>>>>>>>>>>            
50510>>>>>>>>>>>>>
50510>>>>>>>>>>>>>            //AB-StoreStart
50510>>>>>>>>>>>>>            Property String Store_Fragma_Items public ""
50512>>>>>>>>>>>>>            set export_item_state to true
50513>>>>>>>>>>>>>            
50513>>>>>>>>>>>>>            Procedure End_Construct_Object
50515>>>>>>>>>>>>>                Forward Send End_Construct_Object
50517>>>>>>>>>>>>>                Set Color               to 14280447
50518>>>>>>>>>>>>>                Set CurrentRowColor     to 11783679
50519>>>>>>>>>>>>>                Set CurrentCellColor    to 11783679
50520>>>>>>>>>>>>>            End_Procedure
50521>>>>>>>>>>>>>            
50521>>>>>>>>>>>>>            Procedure Activating Returns Integer
50523>>>>>>>>>>>>>                Integer rVal
50524>>>>>>>>>>>>>                Forward Get Msg_Activating to rVal
50526>>>>>>>>>>>>>                set auto_index_state to true
50527>>>>>>>>>>>>>                Procedure_Return rVal
50528>>>>>>>>>>>>>            End_Procedure
50529>>>>>>>>>>>>>            
50529>>>>>>>>>>>>>            procedure move_value_out
50531>>>>>>>>>>>>>                forward send move_value_out
50533>>>>>>>>>>>>>                set value of (ocode(self)) to ''
50534>>>>>>>>>>>>>                set value of (operi(self)) to ''
50535>>>>>>>>>>>>>                set value of (ocodekat(self)) to ''
50536>>>>>>>>>>>>>                set psperi to ''
50537>>>>>>>>>>>>>                set pscode to ''
50538>>>>>>>>>>>>>                set pscodekat to ''
50539>>>>>>>>>>>>>            end_procedure
50540>>>>>>>>>>>>>            
50540>>>>>>>>>>>>>            
50540>>>>>>>>>>>>>            
50540>>>>>>>>>>>>>            
50540>>>>>>>>>>>>>            
50540>>>>>>>>>>>>>            
50540>>>>>>>>>>>>>            
50540>>>>>>>>>>>>>            
50540>>>>>>>>>>>>>            
50540>>>>>>>>>>>>>            //AB-StoreEnd
50540>>>>>>>>>>>>>
50540>>>>>>>>>>>>>        End_Object    // oSelList
50541>>>>>>>>>>>>>
50541>>>>>>>>>>>>>        Object TextBoxSub1 is a TextBoxSub
50543>>>>>>>>>>>>>            Set Label to "‘á¨à©ž ¡à› ¡¦ç š ˜"
50544>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
50545>>>>>>>>>>>>>            Set Location to 192 6
50546>>>>>>>>>>>>>            Set Size to 13 69
50547>>>>>>>>>>>>>        End_Object    // TextBoxSub1
50548>>>>>>>>>>>>>
50548>>>>>>>>>>>>>        Object ocode is a FormSub
50550>>>>>>>>>>>>>            Set Size to 13 197
50551>>>>>>>>>>>>>            Set Location to 192 79
50552>>>>>>>>>>>>>            Set Label_Col_Offset to 2
50553>>>>>>>>>>>>>
50553>>>>>>>>>>>>>            //AB-StoreStart
50553>>>>>>>>>>>>>            
50553>>>>>>>>>>>>>            
50553>>>>>>>>>>>>>            
50553>>>>>>>>>>>>>            
50553>>>>>>>>>>>>>            
50553>>>>>>>>>>>>>            
50553>>>>>>>>>>>>>            
50553>>>>>>>>>>>>>            
50553>>>>>>>>>>>>>            //AB-StoreEnd
50553>>>>>>>>>>>>>
50553>>>>>>>>>>>>>        End_Object    // ocode
50554>>>>>>>>>>>>>
50554>>>>>>>>>>>>>        Object TextBoxSub2 is a TextBoxSub
50556>>>>>>>>>>>>>            Set Label to "‘á¨à©ž §œ¨ š¨˜­ãª "
50557>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
50558>>>>>>>>>>>>>            Set Location to 207 6
50559>>>>>>>>>>>>>            Set Size to 13 71
50560>>>>>>>>>>>>>        End_Object    // TextBoxSub2
50561>>>>>>>>>>>>>
50561>>>>>>>>>>>>>        Object operi is a FormSub
50563>>>>>>>>>>>>>            Set Size to 13 197
50564>>>>>>>>>>>>>            Set Location to 207 79
50565>>>>>>>>>>>>>            Set Label_Col_Offset to 2
50566>>>>>>>>>>>>>
50566>>>>>>>>>>>>>            //AB-StoreStart
50566>>>>>>>>>>>>>            
50566>>>>>>>>>>>>>            
50566>>>>>>>>>>>>>            
50566>>>>>>>>>>>>>            
50566>>>>>>>>>>>>>            
50566>>>>>>>>>>>>>            
50566>>>>>>>>>>>>>            
50566>>>>>>>>>>>>>            //AB-StoreEnd
50566>>>>>>>>>>>>>
50566>>>>>>>>>>>>>        End_Object    // operi
50567>>>>>>>>>>>>>
50567>>>>>>>>>>>>>        Object RadioGroupSub1 is a RadioGroupSub
50569>>>>>>>>>>>>>            Set Size to 32 77
50570>>>>>>>>>>>>>            Set Location to 191 279
50571>>>>>>>>>>>>>            Object Radio1 is a RadioSub
50573>>>>>>>>>>>>>                Set Label to "œ¨ â®œ«˜ "
50574>>>>>>>>>>>>>                Set Size to 10 53
50575>>>>>>>>>>>>>                Set Location to 7 5
50576>>>>>>>>>>>>>            End_Object    // Radio1
50577>>>>>>>>>>>>>
50577>>>>>>>>>>>>>            Object Radio2 is a RadioSub
50579>>>>>>>>>>>>>                Set Label to "€¨®åœ  €§¦"
50580>>>>>>>>>>>>>                Set Size to 10 52
50581>>>>>>>>>>>>>                Set Location to 21 5
50582>>>>>>>>>>>>>            End_Object    // Radio2
50583>>>>>>>>>>>>>
50583>>>>>>>>>>>>>
50583>>>>>>>>>>>>>            //AB-StoreStart
50583>>>>>>>>>>>>>            
50583>>>>>>>>>>>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
50585>>>>>>>>>>>>>                Set piContains_Or_Starts to iToItem
50586>>>>>>>>>>>>>            End_Procedure
50587>>>>>>>>>>>>>            
50587>>>>>>>>>>>>>            
50587>>>>>>>>>>>>>            
50587>>>>>>>>>>>>>            
50587>>>>>>>>>>>>>            
50587>>>>>>>>>>>>>            //AB-StoreEnd
50587>>>>>>>>>>>>>
50587>>>>>>>>>>>>>        End_Object    // RadioGroupSub1
50588>>>>>>>>>>>>>
50588>>>>>>>>>>>>>        Object ButtonSub1 is a ButtonSub
50590>>>>>>>>>>>>>            Set Label to "œ¨ æ¨ ©œ"
50591>>>>>>>>>>>>>            Set Size to 15 197
50592>>>>>>>>>>>>>            Set Location to 236 79
50593>>>>>>>>>>>>>            Set Form_FontWeight Item 0 to 800
50594>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "ms sans serif"
50595>>>>>>>>>>>>>
50595>>>>>>>>>>>>>            //AB-StoreStart
50595>>>>>>>>>>>>>            
50595>>>>>>>>>>>>>            Procedure OnClick
50597>>>>>>>>>>>>>                Forward Send OnClick
50599>>>>>>>>>>>>>                Set pscode      to (Value(ocode(Self),0))
50600>>>>>>>>>>>>>                Set psperi      to (Value(operi(Self),0))
50601>>>>>>>>>>>>>                Set pscodekat   to (Value(ocodekat(Self),0))
50602>>>>>>>>>>>>>                send Rebuild_Constraints    to (witemx_DD(Self))
50603>>>>>>>>>>>>>                Send Beginning_Of_Data      to oSelList True
50604>>>>>>>>>>>>>            End_Procedure // OnClick
50605>>>>>>>>>>>>>            
50605>>>>>>>>>>>>>            
50605>>>>>>>>>>>>>            //AB-StoreEnd
50605>>>>>>>>>>>>>
50605>>>>>>>>>>>>>        End_Object    // ButtonSub1
50606>>>>>>>>>>>>>
50606>>>>>>>>>>>>>        Object TextBoxSub3 is a TextBoxSub
50608>>>>>>>>>>>>>            Set Label to "‰à›. ¡˜«žš¦¨å˜ª š ˜"
50609>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
50610>>>>>>>>>>>>>            Set Location to 221 5
50611>>>>>>>>>>>>>            Set Size to 13 70
50612>>>>>>>>>>>>>        End_Object    // TextBoxSub3
50613>>>>>>>>>>>>>
50613>>>>>>>>>>>>>        Object ocodekat is a FormSub
50615>>>>>>>>>>>>>            Set Size to 13 197
50616>>>>>>>>>>>>>            Set Location to 221 79
50617>>>>>>>>>>>>>            Set Label_Col_Offset to 2
50618>>>>>>>>>>>>>
50618>>>>>>>>>>>>>            //AB-StoreStart
50618>>>>>>>>>>>>>            
50618>>>>>>>>>>>>>            
50618>>>>>>>>>>>>>            
50618>>>>>>>>>>>>>            
50618>>>>>>>>>>>>>            
50618>>>>>>>>>>>>>            
50618>>>>>>>>>>>>>            
50618>>>>>>>>>>>>>            //AB-StoreEnd
50618>>>>>>>>>>>>>
50618>>>>>>>>>>>>>        End_Object    // ocodekat
50619>>>>>>>>>>>>>
50619>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
50621>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
50622>>>>>>>>>>>>>            Set Location to 232 318
50623>>>>>>>>>>>>>
50623>>>>>>>>>>>>>            //AB-StoreStart
50623>>>>>>>>>>>>>            Procedure OnClick
50625>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
50626>>>>>>>>>>>>>            End_Procedure
50627>>>>>>>>>>>>>            //AB-StoreEnd
50627>>>>>>>>>>>>>
50627>>>>>>>>>>>>>        End_Object    // oOK_bn
50628>>>>>>>>>>>>>
50628>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
50630>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
50631>>>>>>>>>>>>>            Set Location to 232 373
50632>>>>>>>>>>>>>
50632>>>>>>>>>>>>>            //AB-StoreStart
50632>>>>>>>>>>>>>            Procedure OnClick
50634>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
50635>>>>>>>>>>>>>            End_Procedure
50636>>>>>>>>>>>>>            //AB-StoreEnd
50636>>>>>>>>>>>>>
50636>>>>>>>>>>>>>        End_Object    // oCancel_bn
50637>>>>>>>>>>>>>
50637>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
50639>>>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
50640>>>>>>>>>>>>>            Set Location to 232 428
50641>>>>>>>>>>>>>
50641>>>>>>>>>>>>>            //AB-StoreStart
50641>>>>>>>>>>>>>            Procedure OnClick
50643>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
50644>>>>>>>>>>>>>            End_Procedure
50645>>>>>>>>>>>>>            //AB-StoreEnd
50645>>>>>>>>>>>>>
50645>>>>>>>>>>>>>        End_Object    // oSearch_bn
50646>>>>>>>>>>>>>
50646>>>>>>>>>>>>>        Object btnwitemcl is a ButtonSub
50648>>>>>>>>>>>>>
50648>>>>>>>>>>>>>            //AB-StoreTopStart
50648>>>>>>>>>>>>>            
50648>>>>>>>>>>>>>            //AB-StoreTopEnd
50648>>>>>>>>>>>>>
50648>>>>>>>>>>>>>            Set Label to "ButtonSub1"
50649>>>>>>>>>>>>>            Set Bitmap to "Filesys3.bmp"
50650>>>>>>>>>>>>>            Set Size to 22 25
50651>>>>>>>>>>>>>            Set Location to 196 443
50652>>>>>>>>>>>>>            Set Focus_Mode to Pointer_Only
50653>>>>>>>>>>>>>
50653>>>>>>>>>>>>>            //AB-StoreStart
50653>>>>>>>>>>>>>            
50653>>>>>>>>>>>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«¦ œ¬¨œ«ã¨ ¦ „ ›é¤ / ¨¦£žŸœ¬«ã"
50654>>>>>>>>>>>>>            
50654>>>>>>>>>>>>>            Procedure OnClick
50656>>>>>>>>>>>>>                String  scode speri
50657>>>>>>>>>>>>>                Get value of (ocode(self)) to scode
50658>>>>>>>>>>>>>                Get value of (operi(self)) to speri
50659>>>>>>>>>>>>>                set pscode of (dg186(self)) to scode
50660>>>>>>>>>>>>>                set psperi of (dg186(self)) to speri
50661>>>>>>>>>>>>>               Send popup_modal to (dg186(self))
50662>>>>>>>>>>>>>            End_Procedure // OnClick
50663>>>>>>>>>>>>>            
50663>>>>>>>>>>>>>            
50663>>>>>>>>>>>>>            
50663>>>>>>>>>>>>>            
50663>>>>>>>>>>>>>            
50663>>>>>>>>>>>>>            
50663>>>>>>>>>>>>>            
50663>>>>>>>>>>>>>            
50663>>>>>>>>>>>>>            
50663>>>>>>>>>>>>>            
50663>>>>>>>>>>>>>            
50663>>>>>>>>>>>>>            
50663>>>>>>>>>>>>>            
50663>>>>>>>>>>>>>            
50663>>>>>>>>>>>>>            
50663>>>>>>>>>>>>>            
50663>>>>>>>>>>>>>            
50663>>>>>>>>>>>>>            
50663>>>>>>>>>>>>>            
50663>>>>>>>>>>>>>            
50663>>>>>>>>>>>>>            
50663>>>>>>>>>>>>>            
50663>>>>>>>>>>>>>            
50663>>>>>>>>>>>>>            //AB-StoreEnd
50663>>>>>>>>>>>>>
50663>>>>>>>>>>>>>        End_Object    // btnwitemcl
50664>>>>>>>>>>>>>
50664>>>>>>>>>>>>>
50664>>>>>>>>>>>>>        //AB-StoreStart
50664>>>>>>>>>>>>>                
50664>>>>>>>>>>>>>        Set Locate_Mode to Center_On_Screen
50665>>>>>>>>>>>>>        
50665>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
50666>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
50667>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
50668>>>>>>>>>>>>>        
50668>>>>>>>>>>>>>        Procedure Activate
50670>>>>>>>>>>>>>            Send Rebuild_Constraints    to Witemx_DD
50671>>>>>>>>>>>>>            Send Beginning_Of_Data      to oSelList True
50672>>>>>>>>>>>>>            Forward Send Activate
50674>>>>>>>>>>>>>        End_Procedure
50675>>>>>>>>>>>>>        
50675>>>>>>>>>>>>>        procedure request_cancel
50677>>>>>>>>>>>>>            forward send request_cancel
50679>>>>>>>>>>>>>            set value of (ocode(self)) to ''
50680>>>>>>>>>>>>>            set value of (operi(self)) to ''
50681>>>>>>>>>>>>>            set value of (ocodekat(self)) to ''
50682>>>>>>>>>>>>>            Set psperi  to ''
50683>>>>>>>>>>>>>            Set pscode  to ''
50684>>>>>>>>>>>>>            Set pscodekat TO ''
50685>>>>>>>>>>>>>        end_procedure
50686>>>>>>>>>>>>>        
50686>>>>>>>>>>>>>        
50686>>>>>>>>>>>>>        
50686>>>>>>>>>>>>>        
50686>>>>>>>>>>>>>        
50686>>>>>>>>>>>>>        
50686>>>>>>>>>>>>>        
50686>>>>>>>>>>>>>        
50686>>>>>>>>>>>>>        
50686>>>>>>>>>>>>>        //AB-StoreEnd
50686>>>>>>>>>>>>>
50686>>>>>>>>>>>>>    End_Object    // SL17
50687>>>>>>>>>>>>>
50687>>>>>>>>>>>>>
50687>>>>>>>>>>>>>    //AB-StoreStart
50687>>>>>>>>>>>>>    
50687>>>>>>>>>>>>>    
50687>>>>>>>>>>>>>    
50687>>>>>>>>>>>>>    
50687>>>>>>>>>>>>>    
50687>>>>>>>>>>>>>    
50687>>>>>>>>>>>>>    
50687>>>>>>>>>>>>>    
50687>>>>>>>>>>>>>    
50687>>>>>>>>>>>>>    
50687>>>>>>>>>>>>>    
50687>>>>>>>>>>>>>    
50687>>>>>>>>>>>>>    //AB-StoreEnd
50687>>>>>>>>>>>>>
50687>>>>>>>>>>>>>//AB/     End_Object    // prj
50687>>>>>>>>>>>
50687>>>>>>>>>>>//DDB-Selection-pkg-End
50687>>>>>>>>>>>//DDB-FileEnd
50687>>>>>>>>>    Use PMOVES.DD
INCLUDING FILE: PMOVES.DD
50687>>>>>>>>>>>//DDB-FileStart
50687>>>>>>>>>>>//DDB-HeaderStart
50687>>>>>>>>>>>
50687>>>>>>>>>>>// File Name : PMOVES.DD
50687>>>>>>>>>>>// Class Name: Pmoves_DataDictionary
50687>>>>>>>>>>>// Revision  : 144
50687>>>>>>>>>>>// Version   : 2
50687>>>>>>>>>>>
50687>>>>>>>>>>>Use  Windows           // Basic Definitions
50687>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
50687>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
50687>>>>>>>>>>>
50687>>>>>>>>>>>Open Pmoves
50689>>>>>>>>>>>Open Pmsdtl
INCLUDING FILE: PMSDTL.FD
50691>>>>>>>>>>>Open Pmssxet
50693>>>>>>>>>>>Open Wax
50695>>>>>>>>>>>Open Witemx
50697>>>>>>>>>>>Open Particle
50699>>>>>>>>>>>Open Sysrecp
50701>>>>>>>>>>>Open Syscurxr
50703>>>>>>>>>>>Open Partlfpa
50705>>>>>>>>>>>Open Clorder
50707>>>>>>>>>>>Open Clorderd
50709>>>>>>>>>>>Open Btnemp
INCLUDING FILE: BTNEMP.FD
50711>>>>>>>>>>>
50711>>>>>>>>>>>//DDB-HeaderEnd
50711>>>>>>>>>>>Open Fpa
50713>>>>>>>>>>>Open PartlFpa
50715>>>>>>>>>>>Open Item
50717>>>>>>>>>>>Open Wtypkin
50719>>>>>>>>>>>Open Witemkat
50721>>>>>>>>>>>Open Wapomast
50723>>>>>>>>>>>Open Wapokat
50725>>>>>>>>>>>Open Payresp
50727>>>>>>>>>>>
50727>>>>>>>>>>>Class Pmoves_DataDictionary  is a DataDictionary_Sec
50728>>>>>>>>>>>
50728>>>>>>>>>>>    // Delete_Main_File:
50728>>>>>>>>>>>
50728>>>>>>>>>>>    Procedure Delete_Main_File
50729>>>>>>>>>>>        clear btnemp
50730>>>>>>>>>>>        move pmoves.pms_recr to btnemp.pms_recr
50731>>>>>>>>>>>        find ge btnemp by index.11
50732>>>>>>>>>>>>
50732>>>>>>>>>>>        if ((found=1) and (pmoves.pms_recr=btnemp.pms_recr)) begin
50734>>>>>>>>>>>           move 0 to btnemp.pms_recr
50735>>>>>>>>>>>           saverecord btnemp
50736>>>>>>>>>>>        end
50736>>>>>>>>>>>>
50736>>>>>>>>>>>        Forward Send Delete_Main_File
50738>>>>>>>>>>>        // Insert Code Here
50738>>>>>>>>>>>    End_Procedure   // Delete_Main_File
50739>>>>>>>>>>>
50739>>>>>>>>>>>
50739>>>>>>>>>>>    Procedure Construct_Object
50740>>>>>>>>>>>        Forward Send Construct_Object
50742>>>>>>>>>>>        Property Number  pnoQty         Public  0
50743>>>>>>>>>>>        Property integer pifromclorder  Public  0
50744>>>>>>>>>>>        Property Integer piCheckZeroFpa Public  0
50745>>>>>>>>>>>        Property Integer piPmsSxetID    Public  0
50746>>>>>>>>>>>        Property integer piFromMetasx   Public  0
50747>>>>>>>>>>>        Property String  psOldItem      Public ''
50748>>>>>>>>>>>    End_Procedure
50749>>>>>>>>>>>
50749>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
50750>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
50752>>>>>>>>>>>        Set pnoQty      to Pmoves.Pms_Qty
50753>>>>>>>>>>>        Set psOldItem   to Item.Item_Code
50754>>>>>>>>>>>    End_Procedure   // New_Current_Record
50755>>>>>>>>>>>
50755>>>>>>>>>>>    Procedure Save_Main_File
50756>>>>>>>>>>>        Integer iYes
50757>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
50759>>>>>>>>>>>            If Pmoves.Recnum Eq 0 Procedure_Return
50762>>>>>>>>>>>        End
50762>>>>>>>>>>>>
50762>>>>>>>>>>>
50762>>>>>>>>>>>        If ((Operation_Origin=Self) And (piCheckZeroFpa(Self))) Begin
50764>>>>>>>>>>>            // Elegxos FPA
50764>>>>>>>>>>>            // An typonei otidhpote ektos apo 1 (mono Posothtes)
50764>>>>>>>>>>>            If ((Ptyppar.Ti_Typonei_Pms<>'1')   And ;                (Pmoves.Pms_Vatam=0)            And ;                (Operation_Mode<>MODE_DELETING)) Begin
50766>>>>>>>>>>>                Move (YesNo_Box("¦©æ ”€ £ž›œ¤ ¡æ. Œ˜ ©¬¤œ®å©à ;", ;                                     "¨¦©¦®ã",  MB_DEFBUTTON2) ) to iYes
50767>>>>>>>>>>>                If (iYes=MBR_NO)  Send Operation_Not_Allowed 8000
50770>>>>>>>>>>>            End
50770>>>>>>>>>>>>
50770>>>>>>>>>>>        End
50770>>>>>>>>>>>>
50770>>>>>>>>>>>        Forward Send Save_Main_File
50772>>>>>>>>>>>    End_Procedure
50773>>>>>>>>>>>
50773>>>>>>>>>>>    Function fnTeleytaiaTimh Returns Number
50774>>>>>>>>>>>        Number  rVal nQty
50775>>>>>>>>>>>        String  sClientID sWitemxCode
50775>>>>>>>>>>>        Date    dHmnia
50775>>>>>>>>>>>        String  sWhat sRecr sClientCode sItemCode sCN
50775>>>>>>>>>>>
50775>>>>>>>>>>>        Get File_Field_Current_Value File_Field Ptyppar.Ptyppar_Is_What to sWhat
50776>>>>>>>>>>>        If (Trim(sWhat)='1') Begin
50778>>>>>>>>>>>            // 1=€š¦¨œª
50778>>>>>>>>>>>            Get File_Field_Current_Value File_Field Witemx.Witemx_Recr      to sRecr
50779>>>>>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Pms_Qty          to nQty
50780>>>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_Hmnia    to dHmnia
50781>>>>>>>>>>>            Get File_Field_Current_Value File_Field Item.Item_Code          to sItemCode
50782>>>>>>>>>>>            Get File_Field_Current_Value File_Field Clients.Client_ID       to sClientCode
50783>>>>>>>>>>>            // Sto arxeio Globals.inc
50783>>>>>>>>>>>            Get fnTeleytaiaTimhAgoras sClientCode sItemCode dHmnia nQty to rVal
50784>>>>>>>>>>>        End
50784>>>>>>>>>>>>
50784>>>>>>>>>>>        Else If (Trim(sWhat)='2') Begin
50787>>>>>>>>>>>            // 2=à¢ã©œ ª
50787>>>>>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Pms_Qty          to nQty
50788>>>>>>>>>>>            Get File_Field_Current_Value File_Field Item.Item_Code          to sItemCode
50789>>>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_Hmnia    to dHmnia
50790>>>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Cn_Code        to sCN
50791>>>>>>>>>>>            Get File_Field_Current_Value File_Field Witemx.Witemx_Recr      to sRecr
50792>>>>>>>>>>>            Get File_Field_Current_Value File_Field Clients.Client_ID       to sClientID
50793>>>>>>>>>>>            Get File_Field_Current_Value File_Field Witemx.Witemx_Code      to sWitemxCode
50794>>>>>>>>>>>            // Sto arxeio Globals.inc
50794>>>>>>>>>>>            Get fnTeleytaiaTimhPolhshs sRecr sClientID sWitemxCode dHmnia sItemCode nQty sCN to rVal
50795>>>>>>>>>>>        End
50795>>>>>>>>>>>>
50795>>>>>>>>>>>        Function_Return rVal
50796>>>>>>>>>>>    End_Function
50797>>>>>>>>>>>
50797>>>>>>>>>>>    Procedure Creating
50798>>>>>>>>>>>        Forward Send Creating
50800>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Pmoves.Pms_Rec0)))))) to Pmoves.Pms_Recr
50801>>>>>>>>>>>    End_Procedure   // Creating
50802>>>>>>>>>>>
50802>>>>>>>>>>>    Procedure Update
50803>>>>>>>>>>>        Integer iDecimals
50804>>>>>>>>>>>        Number  nInt nFpaOnTotal
50804>>>>>>>>>>>        String  sCurrentUser
50804>>>>>>>>>>>
50804>>>>>>>>>>>        Forward Send Update
50806>>>>>>>>>>>
50806>>>>>>>>>>>        Move SysCurXR.Company_Code                          to Pmoves.Company_Code
50807>>>>>>>>>>>        Move SysCurXR.Branch_Code                           to Pmoves.Branch_Code
50808>>>>>>>>>>>        Move SysCurXR.Year_Year                             to Pmoves.Year_Year
50809>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code                           to Pmoves.Ctypkin_Code
50810>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code                           to Pmoves.Wtypkin_Code
50811>>>>>>>>>>>
50811>>>>>>>>>>>        Move Witemkat.Witemkat_Code                         to Pmoves.Witemkat_Code
50812>>>>>>>>>>>        Move Item.Item_Code                                 to Pmoves.Item_Code
50813>>>>>>>>>>>        Move Witemx.Witemx_Code                             to Pmoves.Witemx_Code
50814>>>>>>>>>>>        Move Wapokat.Wapokat_Code                           to Pmoves.Wapokat_Code
50815>>>>>>>>>>>        Move Wapomast.Wapomast_Code                         to Pmoves.Wapomast_Code
50816>>>>>>>>>>>        Move Wax.Wax_Code                                   to Pmoves.Wax_Code
50817>>>>>>>>>>>
50817>>>>>>>>>>>        //Move Custprom.Custprom_Code                         to Pmoves.Custprom_Code
50817>>>>>>>>>>>        Move Clients.Client_ID                              to Pmoves.Client_ID
50818>>>>>>>>>>>        Move Ptyppar.Ptyppar_Code                           to Pmoves.Ptyppar_Code
50819>>>>>>>>>>>        Move Ptyppar.TI_TYPONEI_PMS                         to Pmoves.TI_TYPONEI_PMS
50820>>>>>>>>>>>        Move Particle.PSeira_Seira                          to Pmoves.Pseira_Seira
50821>>>>>>>>>>>
50821>>>>>>>>>>>        Move Nomisma.Nomisma_Code                           to Pmoves.Pms_Sc_Code2
50822>>>>>>>>>>>        Move Nomisma.Dekadika                               To iDecimals
50823>>>>>>>>>>>
50823>>>>>>>>>>>        Move Particle.CN_Code                               to Pmoves.CN_Code
50824>>>>>>>>>>>        Move Particle.Partl_No                              to Pmoves.Partl_No
50825>>>>>>>>>>>        Move Particle.Partl_Hmnia                           to Pmoves.Partl_Hmnia
50826>>>>>>>>>>>        Move Particle.Partl_Module                          to Pmoves.Pms_Module
50827>>>>>>>>>>>        Move Particle.Partl_Rec0                            to Pmoves.Partl_Rec0
50828>>>>>>>>>>>
50828>>>>>>>>>>>        Move Particle.Sls_ID                                to Pmoves.Sls_ID
50829>>>>>>>>>>>        Move Particle.Presp_ID                              to Pmoves.Presp_ID
50830>>>>>>>>>>>        Move Particle.Cnt_ID                                to Pmoves.Cnt_ID
50831>>>>>>>>>>>        Move Item.Units_Code                                to Pmoves.Pms_UnitCode
50832>>>>>>>>>>>        move witemx.witemx_descr                            to pmoves.witemx_descr
50833>>>>>>>>>>>        move ptyppar.ptyppar_descr                          to pmoves.ptyppar_descr
50834>>>>>>>>>>>        move clients.client_name                            to pmoves.client_name
50835>>>>>>>>>>>
50835>>>>>>>>>>>        if (Trim(pmoves.pump_id)='') ;            move particle.antlia_code                       to pmoves.pump_id
50838>>>>>>>>>>>        If (Trim(pmoves.car_id)='') ;            move particle.oxhma_code                        to pmoves.car_id
50841>>>>>>>>>>>        If (Trim(pmoves.zone)='') ;            move particle.zone_id                           to pmoves.zone
50844>>>>>>>>>>>
50844>>>>>>>>>>>      //  if (particle.zone_id='') move pmoves.zone           to particle.zone_id
50844>>>>>>>>>>>      //  else move particle.Zone_ID                          to pmoves.Zone
50844>>>>>>>>>>>
50844>>>>>>>>>>>        Move (Pmoves.Pms_Qty-Pmoves.Timol_Qty)              to Pmoves.Timol_Ypol
50845>>>>>>>>>>>
50845>>>>>>>>>>>        Move (Pmoves.Qty_Kinhshs>0)                         to Pmoves.pms_Selected
50846>>>>>>>>>>>
50846>>>>>>>>>>>        Move (Round_Number((Pmoves.Pms_Qty*Pmoves.Pms_UnitPrice),iDecimals))    ;                                                            to Pmoves.Pms_Ambd
50847>>>>>>>>>>>
50847>>>>>>>>>>>        If (Pmoves.Pms_PctDisc<>0) ;            Move (Round_Number((Pmoves.Pms_Ambd*Pmoves.Pms_PctDisc/100),iDecimals)) ;                                                            to Pmoves.Pms_Discam
50850>>>>>>>>>>>        Else ;            Move (Round_Number( ((Pmoves.Pms_Discam/Pmoves.Pms_Ambd)*100),iDecimals)) ;                                                            to Pmoves.Pms_PctDisc
50852>>>>>>>>>>>
50852>>>>>>>>>>>        Move (Pmoves.Pms_Ambd-Pmoves.Pms_Discam)            to Pmoves.Pms_Amaftdisc
50853>>>>>>>>>>>
50853>>>>>>>>>>>        Move (Round_Number((Pmoves.Pms_Amaftdisc*Pmoves.Pms_Vatpct/100),iDecimals));                                                            to Pmoves.Pms_Vatam
50854>>>>>>>>>>>        Move (Pmoves.Pms_Amaftdisc+Pmoves.Pms_Vatam)        to Pmoves.Pms_Payable
50855>>>>>>>>>>>        Move Pmoves.Pms_Payable                             to Pmoves.Pms_Axia
50856>>>>>>>>>>>
50856>>>>>>>>>>>        Add Pmoves.Pms_Qty                                  to Particle.Partl_TotTem
50857>>>>>>>>>>>        Add Pmoves.Timol_Qty                                to Particle.Timol_Qty
50858>>>>>>>>>>>
50858>>>>>>>>>>>        Add Pmoves.Pms_Ambd                                 to Particle.Partl_TotAmBD
50859>>>>>>>>>>>        Add Pmoves.Pms_DiscAm                               to Particle.Partl_AMDISCPMS
50860>>>>>>>>>>>        Add Pmoves.Pms_Amaftdisc                            to Particle.Partl_TotAmAd
50861>>>>>>>>>>>        Add 1                                               to Particle.Partl_NoOfLines
50862>>>>>>>>>>>
50862>>>>>>>>>>>        // An einai parastatiko polhshs kai to ptyppar einai flagarismeno oti
50862>>>>>>>>>>>        // prepei na enhmerosh to pedio Clients.Posa_apo_dap
50862>>>>>>>>>>>        // tote theoroume oti ypoxreotika prepei na vroume timh apo
50862>>>>>>>>>>>        // function timokatalogon kai na thn krathsoume sto pedio
50862>>>>>>>>>>>        // Pmoves.Posa_apo_dap
50862>>>>>>>>>>>        If ((Ptyppar.Ptyppar_Is_What='2') And (Ptyppar.Check_Posa_Plaf='1')) Begin
50864>>>>>>>>>>>            // An to pedio Particle.Partl_Vsn einai 0 tote shmainei
50864>>>>>>>>>>>            // oti den einai parastatiko metasxhmatismeno (px D.AP) ara
50864>>>>>>>>>>>            // h update prepei na prosthesei sto antistoixo pedio client
50864>>>>>>>>>>>            // An omos einai metasxhmatismeno (px apo D.AP tora einai
50864>>>>>>>>>>>            // Timologio) tote  prepei h update na afairesei apo to pedio
50864>>>>>>>>>>>            // tou client dioti to arxiko D.AP eixe prosthesei.
50864>>>>>>>>>>>
50864>>>>>>>>>>>            Move (Round_Number(Pmoves.Pms_Payable,2)) to Pmoves.Posa_Apo_Dap
50865>>>>>>>>>>>
50865>>>>>>>>>>>            If (Particle.Partl_Vsn=0) Begin
50867>>>>>>>>>>>                Add Pmoves.Posa_Apo_Dap to Clients.Posa_Apo_Dap
50868>>>>>>>>>>>                Add Pmoves.Posa_Apo_Dap to Payresp.Posa_Apo_Dap
50869>>>>>>>>>>>            End
50869>>>>>>>>>>>>
50869>>>>>>>>>>>            Else Begin
50870>>>>>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Clients.Posa_Apo_Dap
50871>>>>>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Payresp.Posa_Apo_Dap
50872>>>>>>>>>>>            End
50872>>>>>>>>>>>>
50872>>>>>>>>>>>        End
50872>>>>>>>>>>>>
50872>>>>>>>>>>>
50872>>>>>>>>>>>        Add Pmoves.Qty_Kinhshs  to Particle.Partl_Disctof
50873>>>>>>>>>>>
50873>>>>>>>>>>>
50873>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
50873>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
50873>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
50873>>>>>>>>>>>        Add Pmoves.Pms_Vatam            to Particle.Partl_Vatam
50874>>>>>>>>>>>
50874>>>>>>>>>>>        Clear PartlFpa
50875>>>>>>>>>>>        Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
50876>>>>>>>>>>>        Move Pmoves.Pms_VatPct          to PartlFpa.Fpa_Pososto
50877>>>>>>>>>>>        Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
50878>>>>>>>>>>>>
50878>>>>>>>>>>>        Add Pmoves.Pms_Vatam            to PartlFpa.PartlFpa_Poso
50879>>>>>>>>>>>        Add Pmoves.Pms_Amaftdisc        to PartlFpa.Poso_Pro_Fpa
50880>>>>>>>>>>>        Saverecord PartlFpa
50881>>>>>>>>>>>
50881>>>>>>>>>>>        Move 0 to nFpaOnTotal
50882>>>>>>>>>>>        Clear PartlFpa
50883>>>>>>>>>>>        Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
50884>>>>>>>>>>>        Find Gt PartlFpa By Index.1
50885>>>>>>>>>>>>
50885>>>>>>>>>>>        While ((Found=1) And (PartlFpa.Partl_Recr=Particle.Partl_Recr))
50889>>>>>>>>>>>            Move (Round_Number(((PartlFpa.Fpa_Pososto*PartlFpa.Poso_Pro_Fpa)/100),2)) to PartlFpa.POSO_FPA
50890>>>>>>>>>>>            Move (PartlFpa.Poso_Pro_Fpa+PartlFpa.POSO_FPA) to PartlFpa.POSO_ME_FPA
50891>>>>>>>>>>>            Saverecord PartlFpa
50892>>>>>>>>>>>            Add PartlFpa.POSO_FPA to nFpaOnTotal
50893>>>>>>>>>>>            Find Gt PartlFpa By Index.1
50894>>>>>>>>>>>>
50894>>>>>>>>>>>        Loop
50895>>>>>>>>>>>>
50895>>>>>>>>>>>
50895>>>>>>>>>>>        Move nFpaOnTotal to Particle.Fpa_On_Total
50896>>>>>>>>>>>
50896>>>>>>>>>>>    End_Procedure   // Update
50897>>>>>>>>>>>
50897>>>>>>>>>>>    // Backout:
50897>>>>>>>>>>>    Procedure Backout
50898>>>>>>>>>>>        Number nFpaOnTotal
50899>>>>>>>>>>>        Forward Send Backout
50901>>>>>>>>>>>
50901>>>>>>>>>>>        Sub Pmoves.Pms_Qty        From Particle.Partl_TotTem
50902>>>>>>>>>>>        Sub Pmoves.Timol_Qty      From Particle.Timol_Qty
50903>>>>>>>>>>>        Sub Pmoves.Pms_Ambd       From Particle.Partl_TotAmBD
50904>>>>>>>>>>>        Sub Pmoves.Pms_DiscAm     From Particle.Partl_AMDISCPMS
50905>>>>>>>>>>>        Sub Pmoves.Pms_Amaftdisc  From Particle.Partl_TotAmAd
50906>>>>>>>>>>>        Sub 1                     From Particle.Partl_NoOfLines
50907>>>>>>>>>>>
50907>>>>>>>>>>>        // An einai parastatiko polhshs kai to ptyppar einai flagarismeno oti
50907>>>>>>>>>>>        // prepei na enhmerosh to pedio Clients.Posa_apo_dap
50907>>>>>>>>>>>        // tote theoroume oti ypoxreotika prepei na vroume timh sto pedio
50907>>>>>>>>>>>        // Pmoves.Posa_apo_dap
50907>>>>>>>>>>>        If ((Ptyppar.Ptyppar_Is_What='2') And (Ptyppar.Check_Posa_Plaf='1')) Begin
50909>>>>>>>>>>>            // An to pedio Particle.Partl_Vsn einai 0 tote shmainei
50909>>>>>>>>>>>            // oti den einai parastatiko metasxhmatismeno (px D.AP) ara
50909>>>>>>>>>>>            // h backout prepei na afairesei apo antistoixo pedio client
50909>>>>>>>>>>>            // An omos einai metasxhmatismeno (px apo D.AP tora einai
50909>>>>>>>>>>>            // Timologio) tote  prepei h backout na prosthesi sto pedio
50909>>>>>>>>>>>            // tou client dioti to arxiko D.AP eixe afairethei.
50909>>>>>>>>>>>            If (Particle.Partl_Vsn=0) Begin
50911>>>>>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Clients.Posa_Apo_Dap
50912>>>>>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Payresp.Posa_Apo_Dap
50913>>>>>>>>>>>            End
50913>>>>>>>>>>>>
50913>>>>>>>>>>>            Else Begin
50914>>>>>>>>>>>                Add Pmoves.Posa_Apo_Dap to Clients.Posa_Apo_Dap
50915>>>>>>>>>>>                Add Pmoves.Posa_Apo_Dap to Payresp.Posa_Apo_Dap
50916>>>>>>>>>>>            End
50916>>>>>>>>>>>>
50916>>>>>>>>>>>        End
50916>>>>>>>>>>>>
50916>>>>>>>>>>>
50916>>>>>>>>>>>        Sub Pmoves.Qty_Kinhshs From Particle.Partl_Disctof
50917>>>>>>>>>>>
50917>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
50917>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
50917>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
50917>>>>>>>>>>>        Sub Pmoves.Pms_Vatam      From Particle.Partl_Vatam
50918>>>>>>>>>>>
50918>>>>>>>>>>>        Clear PartlFpa
50919>>>>>>>>>>>        Move Particle.Partl_Recr    to PartlFpa.Partl_Recr
50920>>>>>>>>>>>        Move Pmoves.Pms_VatPct      to PartlFpa.Fpa_Pososto
50921>>>>>>>>>>>        Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
50922>>>>>>>>>>>>
50922>>>>>>>>>>>        Sub Pmoves.Pms_Vatam      From PartlFpa.PartlFpa_Poso
50923>>>>>>>>>>>        Sub Pmoves.Pms_Amaftdisc  From PartlFpa.Poso_Pro_Fpa
50924>>>>>>>>>>>        Saverecord PartlFpa
50925>>>>>>>>>>>
50925>>>>>>>>>>>        Move 0 to nFpaOnTotal
50926>>>>>>>>>>>        Clear PartlFpa
50927>>>>>>>>>>>        Move Particle.Partl_Recr  to PartlFpa.Partl_Recr
50928>>>>>>>>>>>        Find Gt PartlFpa By Index.1
50929>>>>>>>>>>>>
50929>>>>>>>>>>>        While ((Found=1) And (PartlFpa.Partl_Recr=Particle.Partl_Recr))
50933>>>>>>>>>>>            Move (Round_Number(((PartlFpa.Fpa_Pososto*PartlFpa.Poso_Pro_Fpa)/100),2)) to PartlFpa.POSO_FPA
50934>>>>>>>>>>>            Move (PartlFpa.Poso_Pro_Fpa+PartlFpa.POSO_FPA) to PartlFpa.POSO_ME_FPA
50935>>>>>>>>>>>            Saverecord PartlFpa
50936>>>>>>>>>>>            Add PartlFpa.POSO_FPA to nFpaOnTotal
50937>>>>>>>>>>>            Find Gt PartlFpa By Index.1
50938>>>>>>>>>>>>
50938>>>>>>>>>>>        Loop
50939>>>>>>>>>>>>
50939>>>>>>>>>>>
50939>>>>>>>>>>>        Move nFpaOnTotal to Particle.Fpa_On_Total
50940>>>>>>>>>>>
50940>>>>>>>>>>>
50940>>>>>>>>>>>    End_Procedure   // Backout
50941>>>>>>>>>>>
50941>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
50942>>>>>>>>>>>             If (iError_Num = 1001) Error 1001 "DDC 18: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ©«¦ Wax"
50945>>>>>>>>>>>        Else If (iError_Num = 1002) Error 1002 "DDC 18: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ©«¦ Witemx"
50949>>>>>>>>>>>        Else If (iError_Num = 1003) Error 1003 "DDC 18: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ©«¦ Particle"
50953>>>>>>>>>>>        Else If (iError_Num = 1004) Error 1004 "DDC 18: ¦©æ«ž«˜ „å›¦¬ª ‹ž›œ¤ ¡ã\nƒ ˜š¨á¯«œ ˜¤ Ÿâ¢œ«œ, «ž š¨˜££ã «¦¬ œå›¦¬ª"
50957>>>>>>>>>>>        Else If (iError_Num = 1005) Error 1005 "DDC 18: ¦©æ §¨¦ „¡§«à©žª ‹ž›œ¤ ¡æ"
50961>>>>>>>>>>>        Else If (iError_Num = 1006) Error 1006 "DDC 18: ¦©æ §¨¦ ”€ ‹ž›œ¤ ¡æ"
50965>>>>>>>>>>>        Else If (iError_Num = 1007) Error 1007 "DDC 18: ¦©æ ¢ž¨à«â¦ „å›¦¬ª ‹ž›œ¤ ¡æ"
50969>>>>>>>>>>>        Else If (iError_Num = 1009) Error 1009 "DDC 18: ƒœ¤ œå¤˜  œ­ ¡«ã ž › ˜š¨˜­ã \n„®œ  ›ž£ ¦¬¨šžŸœå £œ«˜©®ž£˜« ©£â¤¦ §˜¨˜©«˜« ¡æ"
50973>>>>>>>>>>>        Else If (iError_Num = 1010) Error 1010 "DDC 18: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ §œ¢á«ž"
50977>>>>>>>>>>>        Else If (iError_Num = 1011) Error 1011 "DDC 18: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ ¬§. §¢ž¨à£ãª"
50981>>>>>>>>>>>        Else If (iError_Num = 1012) Error 1012 "DDC 18: ’¦ œå›¦ª ˜¬«æ §¨¦ã¢Ÿœ ˜§¦ £œ«˜©®ž£˜« ©£æ ¡˜  ›œ¤ › ˜š¨á­œ«˜ .\nƒ ˜š¨á¯«œ «¦ §˜¨˜©«˜« ¡æ ¡˜  ¥˜¤˜£œ«˜©®ž£˜«å©«œ «¦ ˜¨® ¡æ."
50985>>>>>>>>>>>        Else If (iError_Num = 1013) Error 1013 "DDC 18: ’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\n‰ ¤ãŸž¡œ §¦©æ«ž«˜ > ˜§¦ «ž › ˜Ÿâ© £ž"
50989>>>>>>>>>>>        Else If (iError_Num = 1111) Error 1111 "DDC 18: ƒœ¤ â®œ  ¡˜«˜®à¨žŸœå ©«¦ ©ç©«ž£˜ «â«¦ ¦ §¦©¦©«æ ”€"
50993>>>>>>>>>>>        Else If (iError_Num = 1105) Error 1105 "DDC 18: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
50997>>>>>>>>>>>        Else If (iError_Num = 1106) Error 1106 "DDC 18: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
51001>>>>>>>>>>>        Else If (iError_Num = 1107) Error 1107 "DDC 18: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
51005>>>>>>>>>>>        Else If (iError_Num = 1108) Error 1108 "DDC 18: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
51009>>>>>>>>>>>        Else If (iError_Num = 1110) Error 1110 "DDC 18: †£/¤å˜ §˜¨˜©«˜« ¡¦ç <= †£/¤å˜ª ¡¢œ ©å£˜«¦ª\nƒœ¤ œ§ «¨â§œ«˜  ¡˜££å˜ «¨¦§¦§¦åž©ž ©«¦ §˜¨˜©«˜« ¡æ"
51013>>>>>>>>>>>        Else If (iError_Num = 6001) Error 6001 "DDC 18: ƒœ¤ §¨¦¡ç§«œ  §¦©¦ ˜§¦ « £¦¡˜«á¢¦š¦"
51017>>>>>>>>>>>        Else If (iError_Num = 7000) Error 7000 "DDC 18: ¨¦â¨®œ«˜  ˜§¦ ˜¨˜ššœ¢å˜. † š¨˜££ã ˜¬«ã £æ¤¦ › ˜š¨á­œ«˜ "
51021>>>>>>>>>>>        Else If (iError_Num = 7001) Error 7001 "DDC 18: ’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ."
51025>>>>>>>>>>>        Else If (iError_Num = 7005) Error 7005 "DDC 18: † §¦©æ«ž«˜ ›œ¤ «¨¦§¦§¦ œå«˜  š ˜«  §¨¦ã¢Ÿœ ˜§¦ £œ«˜©®ž£˜« ©£æ.\nƒ ˜š¨á¯«œ «¦ §˜¨˜©«˜« ¡æ ¡˜  ¥˜¤˜£œ«˜©®ž£˜«å©«œ «¦ ˜¨® ¡æ."
51029>>>>>>>>>>>        Else If (iError_Num = 8000) Error 8000 "DDC 18: €¡¬¨éŸž¡œ ž ¡˜«˜®é¨ž©ž «¦¬ œå›¦¬ª ˜§¦ «¦¤ ®¨ã©«ž\n‹œ«˜ «¦ Ž‰, §˜«ã©«œ F5"
51033>>>>>>>>>>>        Else If (iError_Num = 8001) Error 8001 "DDC 18: ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã œå›¦¬ª\n‹œ«˜ «¦ Ž‰, §˜«ã©«œ F5"
51037>>>>>>>>>>>        Else If (iError_Num = 6655) Error 6655 "DDC 18: ¨¦¡ç§«œ  ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž > ˜¨® ¡ãª §¦©æ«ž«˜ª"
51041>>>>>>>>>>>        Else Forward Send Operation_Not_Allowed  iError_Num
51044>>>>>>>>>>>    End_Procedure   // Operation_Not_Allowed
51045>>>>>>>>>>>
51045>>>>>>>>>>>    Function Validate_Save  Returns Integer
51046>>>>>>>>>>>        Integer iReturnVal iFpaRecnum iYes
51047>>>>>>>>>>>        Number  nInt nqty nQtyKin
51047>>>>>>>>>>>        String  sUserID sOldUserID sOldItem
51047>>>>>>>>>>>
51047>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
51049>>>>>>>>>>>
51049>>>>>>>>>>>        If (Not(iReturnVal)) Begin
51051>>>>>>>>>>>
51051>>>>>>>>>>>//////////////////////////////////////////////////////////////////////////////////////
51051>>>>>>>>>>>        // Egine rem o kodikas pou elegxei to pososto fpa giati sto shmeio ayto
51051>>>>>>>>>>>        // dhmiourgouse parenergeia an o xrhsths allaze to pososto fpa pou erxotan
51051>>>>>>>>>>>        // apo to eidos, tote allaze kai sto record tou eidous
51051>>>>>>>>>>>
51051>>>>>>>>>>>//            If (Pmoves.Pms_VatPct) Begin
51051>>>>>>>>>>>//                Move Fpa.Recnum to iFpaRecnum
51051>>>>>>>>>>>//                Clear Fpa
51051>>>>>>>>>>>//                Move Pmoves.Pms_VatPct      to Fpa.Fpa_Pososto
51051>>>>>>>>>>>//                Find eq Fpa By Index.1 // Fpa:Index.1:Fpa_Pososto
51051>>>>>>>>>>>//                If (Not(Found)) Move 1111 to iReturnVal
51051>>>>>>>>>>>//                If (iFpaRecnum) Begin
51051>>>>>>>>>>>//                    Clear Fpa
51051>>>>>>>>>>>//                    Move iFpaRecnum to Fpa.Recnum
51051>>>>>>>>>>>//                    Find Eq Fpa.Recnum
51051>>>>>>>>>>>//                End
51051>>>>>>>>>>>//            End
51051>>>>>>>>>>>//////////////////////////////////////////////////////////////////////////////////////
51051>>>>>>>>>>>
51051>>>>>>>>>>>                 If (Wax.Recnum          =0) Move 1001 to iReturnVal
51054>>>>>>>>>>>            Else If (Witemx.Recnum       =0) Move 1002 to iReturnVal
51058>>>>>>>>>>>            Else If (Particle.Recnum     =0) Move 1003 to iReturnVal
51062>>>>>>>>>>>            Else If (Pmoves.Pms_Qty      =0) Move 1004 to iReturnVal
51066>>>>>>>>>>>            Else If ( (Sysfile.Hm_Kleisimatos<>'') And ;                      (Particle.Partl_Hmnia<=Sysfile.Hm_Kleisimatos) ) ;                     Move 1110 to iReturnVal
51070>>>>>>>>>>>            Else Begin
51071>>>>>>>>>>>                //If (Pmoves.Timol_Ypol<0)                        Move 7001 to iReturnVal
51071>>>>>>>>>>>                If (Pmoves.Qty_Kinhshs>Pmoves.Timol_Ypol)  Move 1013 to iReturnVal
51074>>>>>>>>>>>                Else If (Pmoves.Timol_Ypol>Pmoves.Pms_Qty)      Move 6655 to iReturnVal
51078>>>>>>>>>>>                // SOS SOS SOS 24/10/2002 ¨¦©¦¨ ¤˜ Off š ˜«  ®«¬§˜œ  ©« ª ˜¤«¢ œª
51078>>>>>>>>>>>
51078>>>>>>>>>>>//                Else If ((Ptyppar.Ptyppar_Is_What='2') And (Ptyppar.Check_Posa_Plaf='1')) Begin
51078>>>>>>>>>>>//                    If (Pmoves.Posa_Apo_Dap=0) Begin
51078>>>>>>>>>>>//                        Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
51078>>>>>>>>>>>//                        If (iYes=MBR_NO) Move 6001 to iReturnVal
51078>>>>>>>>>>>//                    End
51078>>>>>>>>>>>//                End
51078>>>>>>>>>>>//                Else If ((Clients.Plafon>0) And ;
51078>>>>>>>>>>>//                    ((Clients.Ypoloipo+Pmoves.Posa_Apo_Dap)>Clients.Plafon) And ;
51078>>>>>>>>>>>//                    (Ptyppar.Check_Posa_Plaf='1')) Begin
51078>>>>>>>>>>>//                        Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
51078>>>>>>>>>>>//                        If (iYes=MBR_NO) Move 1010 to iReturnVal
51078>>>>>>>>>>>//                End
51078>>>>>>>>>>>//                Else If ((PayResp.Plafon>0) And ;
51078>>>>>>>>>>>//                        ((PayResp.Ypoloipo+Pmoves.Posa_Apo_Dap)>PayResp.Plafon) And ;
51078>>>>>>>>>>>//                         (Ptyppar.Check_Posa_Plaf='1')) Begin
51078>>>>>>>>>>>//                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
51078>>>>>>>>>>>//                        If (iYes=MBR_NO) Move 1011 to iReturnVal
51078>>>>>>>>>>>//                End
51078>>>>>>>>>>>                Else If ((pmoves.clorderd_recr <> '') and (pifromclorder(self)<>1)) begin //?? Pmoves ???ÿ????š???? ? ???????êœ??
51081>>>>>>>>>>>                    get pnoqty to nqty
51082>>>>>>>>>>>                    if (nqty <> pmoves.pms_qty)                 Move 7000 to iReturnVal
51085>>>>>>>>>>>                End
51085>>>>>>>>>>>>
51085>>>>>>>>>>>
51085>>>>>>>>>>>                Else If ((Pmoves.Qty_Ypol=1) And (piFromMetasx(Self)=0)) begin
51088>>>>>>>>>>>                    // js 28/08/2002
51088>>>>>>>>>>>                    // To pedio Qty_Ypol xrhsimopoihtai gia na flagarei an ena Pmove
51088>>>>>>>>>>>                    // exei proelthei apo metasxhmatismo (Eite sygkentrotika, eite analytika)
51088>>>>>>>>>>>                    // To xrhsimopoihsame ayto gia na mhn anoixtei neo pedio.
51088>>>>>>>>>>>                    // An loipon exei proelthei apo metasxhmatismo DEN epitrepetai tropopoihsh
51088>>>>>>>>>>>                    // ths posothtas tou ap' eutheias alla mono meso ths posothtas mias
51088>>>>>>>>>>>                    // sygkekrimenhs eggrafhs tou arxeiou PmsSxet
51088>>>>>>>>>>>                    If (Operation_Origin=Self) Begin
51090>>>>>>>>>>>                        get pnoqty to nqty
51091>>>>>>>>>>>                        if (nqty <> pmoves.pms_qty)             Move 7005 to iReturnVal
51094>>>>>>>>>>>                        // js 22/12/2003
51094>>>>>>>>>>>                        // Epishs DEN epitrepetai allagh eidous
51094>>>>>>>>>>>                        // Pianoume to bug pou se metasxhmatismeno parastatiko
51094>>>>>>>>>>>                        // mporouse na allaxei to eidos me F7/F8
51094>>>>>>>>>>>                        Get psOldItem to sOldItem
51095>>>>>>>>>>>                        If (Item.Item_Code<>sOldItem) Move 8001 to iReturnVal
51098>>>>>>>>>>>                    End
51098>>>>>>>>>>>>
51098>>>>>>>>>>>                End
51098>>>>>>>>>>>>
51098>>>>>>>>>>>            End
51098>>>>>>>>>>>>
51098>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
51101>>>>>>>>>>>        End
51101>>>>>>>>>>>>
51101>>>>>>>>>>>        Function_Return iReturnVal
51102>>>>>>>>>>>    End_Function   // Validate_Save
51103>>>>>>>>>>>
51103>>>>>>>>>>>    Function Validate_Delete  Returns Integer
51104>>>>>>>>>>>        Integer iReturnVal
51105>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
51107>>>>>>>>>>>        If (Not(iReturnVal)) Begin
51109>>>>>>>>>>>            If (Particle.Partl_Timol=1) Move 1009 to iReturnVal
51112>>>>>>>>>>>            Else If ( (Sysfile.Hm_Kleisimatos<>'') And ;                      (Particle.Partl_Hmnia<=Sysfile.Hm_Kleisimatos) ) ;                Move 1110 to iReturnVal
51116>>>>>>>>>>>            Else If ((pmoves.qty_ypol=1) And (Operation_Origin=Self)) Move 1012 to iReturnVal
51120>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
51123>>>>>>>>>>>        End
51123>>>>>>>>>>>>
51123>>>>>>>>>>>        Function_Return iReturnVal
51124>>>>>>>>>>>    End_Function   // Validate_Delete
51125>>>>>>>>>>>
51125>>>>>>>>>>>    Procedure Set_UnitPrice integer iField  Number nNum
51126>>>>>>>>>>>        Local Integer   Changed
51127>>>>>>>>>>>        Local Number    nInt
51127>>>>>>>>>>>        Get Field_Changed_State iField to Changed
51128>>>>>>>>>>>        If (Changed=0 AND nNum=0) Begin
51130>>>>>>>>>>>            Get fnTeleytaiaTimh to nInt
51131>>>>>>>>>>>            Set Field_Default_Value iField to nInt
51132>>>>>>>>>>>        End
51132>>>>>>>>>>>>
51132>>>>>>>>>>>    End_Procedure   // Shmera
51133>>>>>>>>>>>
51133>>>>>>>>>>>    Procedure Set_Discount integer iField  Number nNum
51134>>>>>>>>>>>        Local Integer Changed
51135>>>>>>>>>>>        Local Number nInt
51135>>>>>>>>>>>        Get Field_Changed_State iField to Changed
51136>>>>>>>>>>>        If (Changed=0 AND nNum=0) Begin
51138>>>>>>>>>>>            Get fnTeleytaiaTimh to nInt
51139>>>>>>>>>>>            If (nInt<0) Begin
51141>>>>>>>>>>>                Move (nInt*(-1)) to nInt
51142>>>>>>>>>>>                Set Field_Default_Value iField to nInt
51143>>>>>>>>>>>            End
51143>>>>>>>>>>>>
51143>>>>>>>>>>>        End
51143>>>>>>>>>>>>
51143>>>>>>>>>>>    End_Procedure   // Shmera
51144>>>>>>>>>>>
51144>>>>>>>>>>>    Procedure Set_FPA integer iField  Number nNum
51145>>>>>>>>>>>        Local Integer Changed
51146>>>>>>>>>>>        Local Number nInt
51146>>>>>>>>>>>        Get Field_Changed_State iField to Changed
51147>>>>>>>>>>>        If (Changed=0 AND nNum=0) Begin
51149>>>>>>>>>>>            Move Item.Fpa_Pososto to nInt
51150>>>>>>>>>>>            Set Field_Default_Value iField to nInt
51151>>>>>>>>>>>        End
51151>>>>>>>>>>>>
51151>>>>>>>>>>>    End_Procedure   // Shmera
51152>>>>>>>>>>>
51152>>>>>>>>>>>    // Define_Fields:
51152>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
51152>>>>>>>>>>>
51152>>>>>>>>>>>    Procedure Define_Fields
51153>>>>>>>>>>>        Forward Send Define_Fields
51155>>>>>>>>>>>        //DDB-Generated-Code-Location
51155>>>>>>>>>>>        //DDB-DefineFieldStart
51155>>>>>>>>>>>
51155>>>>>>>>>>>        Set Main_File            To Pmoves.File_Number
51156>>>>>>>>>>>
51156>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
51157>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
51158>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51159>>>>>>>>>>>
51159>>>>>>>>>>>        // Child (Client) file structure................
51159>>>>>>>>>>>        Send Add_Client_File  Pmsdtl.File_Number
51160>>>>>>>>>>>        Send Add_Client_File  Pmssxet.File_Number
51161>>>>>>>>>>>
51161>>>>>>>>>>>        // Parent (Server) file structure...............
51161>>>>>>>>>>>        Send Add_Server_File  Wax.File_Number
51162>>>>>>>>>>>        Send Add_Server_File  Witemx.File_Number
51163>>>>>>>>>>>        Send Add_Server_File  Particle.File_Number
51164>>>>>>>>>>>
51164>>>>>>>>>>>        // External (System) file structure.............
51164>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_NEW_SAVE
51165>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
51166>>>>>>>>>>>        Send Add_System_File  Partlfpa.File_Number  DD_LOCK_ON_ALL
51167>>>>>>>>>>>        Send Add_System_File  Clorder.File_Number  DD_LOCK_ON_ALL
51168>>>>>>>>>>>        Send Add_System_File  Clorderd.File_Number  DD_LOCK_ON_ALL
51169>>>>>>>>>>>        Send Add_System_File  Btnemp.File_Number  DD_LOCK_ON_ALL
51170>>>>>>>>>>>
51170>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Pmoves_Rec0  To Pmoves.Pms_Rec0
51173>>>>>>>>>>>
51173>>>>>>>>>>>        // Field-based properties.......................
51173>>>>>>>>>>>
51173>>>>>>>>>>>        // Pmoves.Company_Code
51173>>>>>>>>>>>
51173>>>>>>>>>>>        // Pmoves.Branch_Code
51173>>>>>>>>>>>
51173>>>>>>>>>>>        // Pmoves.Year_Year
51173>>>>>>>>>>>
51173>>>>>>>>>>>        // Pmoves.Ctypkin_Code
51173>>>>>>>>>>>
51173>>>>>>>>>>>        // Pmoves.Wtypkin_Code
51173>>>>>>>>>>>
51173>>>>>>>>>>>        // Pmoves.Custprom_Code
51173>>>>>>>>>>>
51173>>>>>>>>>>>        // Pmoves.Client_Id
51173>>>>>>>>>>>
51173>>>>>>>>>>>        // Pmoves.Cn_Code
51173>>>>>>>>>>>
51173>>>>>>>>>>>        // Pmoves.Ptyppar_Code
51173>>>>>>>>>>>
51173>>>>>>>>>>>        // Pmoves.Partl_Hmnia
51173>>>>>>>>>>>
51173>>>>>>>>>>>        // Pmoves.Pseira_Seira
51173>>>>>>>>>>>
51173>>>>>>>>>>>        // Pmoves.Partl_No
51173>>>>>>>>>>>
51173>>>>>>>>>>>        // Pmoves.Partl_Rec0
51173>>>>>>>>>>>
51173>>>>>>>>>>>        // Pmoves.Witemkat_Code
51173>>>>>>>>>>>
51173>>>>>>>>>>>        // Pmoves.Units_Code
51173>>>>>>>>>>>
51173>>>>>>>>>>>        // Pmoves.Item_Code
51173>>>>>>>>>>>
51173>>>>>>>>>>>        // Pmoves.Witemx_Code
51173>>>>>>>>>>>
51173>>>>>>>>>>>        // Pmoves.Wapokat_Code
51173>>>>>>>>>>>
51173>>>>>>>>>>>        // Pmoves.Wapomast_Code
51173>>>>>>>>>>>
51173>>>>>>>>>>>        // Pmoves.Wax_Code
51173>>>>>>>>>>>
51173>>>>>>>>>>>        // Pmoves.Wax_Recr
51173>>>>>>>>>>>
51173>>>>>>>>>>>        // Pmoves.Witemx_Recr
51173>>>>>>>>>>>
51173>>>>>>>>>>>        // Pmoves.Partl_Recr
51173>>>>>>>>>>>
51173>>>>>>>>>>>        // Pmoves.Pms_Rec0
51173>>>>>>>>>>>        Set Field_Options          Field Pmoves.Pms_Rec0 To DD_AUTOFIND   
51174>>>>>>>>>>>
51174>>>>>>>>>>>        // Pmoves.Pms_No
51174>>>>>>>>>>>
51174>>>>>>>>>>>        // Pmoves.Pms_Recr
51174>>>>>>>>>>>
51174>>>>>>>>>>>        // Pmoves.Pms_Unitcode
51174>>>>>>>>>>>
51174>>>>>>>>>>>        // Pmoves.Pms_Qty
51174>>>>>>>>>>>
51174>>>>>>>>>>>        // Pmoves.Pms_Unitprice
51174>>>>>>>>>>>        Set Field_Entry_msg        Field Pmoves.Pms_Unitprice To Set_UnitPrice
51175>>>>>>>>>>>
51175>>>>>>>>>>>        // Pmoves.Pms_Ambd
51175>>>>>>>>>>>
51175>>>>>>>>>>>        // Pmoves.Pms_Pctdisc
51175>>>>>>>>>>>        Set Field_Entry_msg        Field Pmoves.Pms_Pctdisc To Set_Discount
51176>>>>>>>>>>>
51176>>>>>>>>>>>        // Pmoves.Pms_Discam
51176>>>>>>>>>>>
51176>>>>>>>>>>>        // Pmoves.Pms_Amaftdisc
51176>>>>>>>>>>>
51176>>>>>>>>>>>        // Pmoves.Pms_Vatpct
51176>>>>>>>>>>>        Set Field_Entry_msg        Field Pmoves.Pms_Vatpct To Set_FPA
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_Vatam
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_Exrampct
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_Exdet
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_Payable
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_Axia
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_X0
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_P0
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_X00
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_P00
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_X1
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_P1
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_X2
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_P2
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_Dlixis
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_A_Code
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_Status_E
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_Status_A
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_S0
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_Ys0
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_S1
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_Ys1
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_S2
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_Ys2
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_Sc_Code2
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_Open
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_Aopen
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_M_Code
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_Yn_Myf
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_Myf_Axia
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_Kk
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_C_Code2
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_Cn_Code
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Wcmoves_Recr
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_Module
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Btnl2_Recr
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Btnemp_Recr
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Btarticle_Recr
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Sls_Id
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Presp_Id
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Cnt_Id
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Mhxanik_Id
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Extra_Epimer
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Ekpt_Epimer
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Clorderd_Recr
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Witemx_Descr
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Ptyppar_Descr
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Ti_Typonei_Pms
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Timol_Qty
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Timol_Ypol
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Posa_Apo_Dap
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Qty_Ypol
51177>>>>>>>>>>>
51177>>>>>>>>>>>        // Pmoves.Pms_Selected
51177>>>>>>>>>>>        Set Field_Class_Name       Field Pmoves.Pms_Selected To "dbCheckBoxsub"
51178>>>>>>>>>>>
51178>>>>>>>>>>>        // Pmoves.Qty_Kinhshs
51178>>>>>>>>>>>
51178>>>>>>>>>>>        // Pmoves.Sx_Parast
51178>>>>>>>>>>>
51178>>>>>>>>>>>        // Pmoves.Sx_Hmnia
51178>>>>>>>>>>>
51178>>>>>>>>>>>        // Pmoves.Sx_Seira
51178>>>>>>>>>>>
51178>>>>>>>>>>>        // Pmoves.Sx_Arithmos
51178>>>>>>>>>>>
51178>>>>>>>>>>>        // Pmoves.Pump_Id
51178>>>>>>>>>>>
51178>>>>>>>>>>>        // Pmoves.Car_Id
51178>>>>>>>>>>>
51178>>>>>>>>>>>        // Pmoves.Item_Ypot
51178>>>>>>>>>>>
51178>>>>>>>>>>>        // Pmoves.Qty_Return
51178>>>>>>>>>>>
51178>>>>>>>>>>>        // Pmoves.Client_Name
51178>>>>>>>>>>>
51178>>>>>>>>>>>        // Pmoves.Zone
51178>>>>>>>>>>>
51178>>>>>>>>>>>        //DDB-DefineFieldEnd
51178>>>>>>>>>>>    End_Procedure    // Define_Fields
51179>>>>>>>>>>>
51179>>>>>>>>>>>    // Field_Defaults:
51179>>>>>>>>>>>    // This procedure is used to establish default field values.
51179>>>>>>>>>>>
51179>>>>>>>>>>>    Procedure Field_Defaults
51180>>>>>>>>>>>        Forward Send Field_Defaults
51182>>>>>>>>>>>        //DDB-Generated-Code-Location
51182>>>>>>>>>>>        //DDB-FieldDefaultStart
51182>>>>>>>>>>>        //DDB-FieldDefaultEnd
51182>>>>>>>>>>>        //Set Field_Changed_Value Field Pmoves.Pms_VatPct to Item.Fpa_Pososto
51182>>>>>>>>>>>    End_Procedure    // Field_Defaults
51183>>>>>>>>>>>
51183>>>>>>>>>>>End_Class    // Pmoves_DataDictionary
51184>>>>>>>>>>>//DDB-FileEnd
51184>>>>>>>>>    Use PmsDtl.DD
INCLUDING FILE: PMSDTL.DD
51184>>>>>>>>>>>//DDB-FileStart
51184>>>>>>>>>>>//DDB-HeaderStart
51184>>>>>>>>>>>
51184>>>>>>>>>>>// File Name : PmsDtl.DD
51184>>>>>>>>>>>// Class Name: Pmsdtl_DataDictionary
51184>>>>>>>>>>>// Revision  : 0
51184>>>>>>>>>>>// Version   : 2
51184>>>>>>>>>>>
51184>>>>>>>>>>>Use  Windows           // Basic Definitions
51184>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
51184>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51184>>>>>>>>>>>
51184>>>>>>>>>>>Open Pmsdtl
51186>>>>>>>>>>>Open Pmoves
51188>>>>>>>>>>>
51188>>>>>>>>>>>//DDB-HeaderEnd
51188>>>>>>>>>>>
51188>>>>>>>>>>>Class Pmsdtl_DataDictionary  is a DataDictionary_Sec
51189>>>>>>>>>>>
51189>>>>>>>>>>>    // Define_Fields:
51189>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
51189>>>>>>>>>>>
51189>>>>>>>>>>>    Procedure Define_Fields
51190>>>>>>>>>>>        Forward Send Define_Fields
51192>>>>>>>>>>>        //DDB-Generated-Code-Location
51192>>>>>>>>>>>        //DDB-DefineFieldStart
51192>>>>>>>>>>>
51192>>>>>>>>>>>        Set Main_File            To Pmsdtl.File_Number
51193>>>>>>>>>>>
51193>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
51194>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
51195>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51196>>>>>>>>>>>
51196>>>>>>>>>>>        // Parent (Server) file structure...............
51196>>>>>>>>>>>        Send Add_Server_File  Pmoves.File_Number
51197>>>>>>>>>>>
51197>>>>>>>>>>>        // Field-based properties.......................
51197>>>>>>>>>>>
51197>>>>>>>>>>>        // Pmsdtl.Pms_Recr
51197>>>>>>>>>>>        Set Field_Options          Field Pmsdtl.Pms_Recr To DD_AUTOFIND   
51198>>>>>>>>>>>        Set Key_Field_State        Field Pmsdtl.Pms_Recr To TRUE
51199>>>>>>>>>>>
51199>>>>>>>>>>>        // Pmsdtl.Line1
51199>>>>>>>>>>>
51199>>>>>>>>>>>        // Pmsdtl.Line2
51199>>>>>>>>>>>
51199>>>>>>>>>>>        // Pmsdtl.Line3
51199>>>>>>>>>>>
51199>>>>>>>>>>>        // Pmsdtl.Line4
51199>>>>>>>>>>>
51199>>>>>>>>>>>        // Pmsdtl.Line5
51199>>>>>>>>>>>
51199>>>>>>>>>>>        //DDB-DefineFieldEnd
51199>>>>>>>>>>>    End_Procedure    // Define_Fields
51200>>>>>>>>>>>
51200>>>>>>>>>>>    // Field_Defaults:
51200>>>>>>>>>>>    // This procedure is used to establish default field values.
51200>>>>>>>>>>>
51200>>>>>>>>>>>    Procedure Field_Defaults
51201>>>>>>>>>>>        Forward Send Field_Defaults
51203>>>>>>>>>>>        //DDB-Generated-Code-Location
51203>>>>>>>>>>>        //DDB-FieldDefaultStart
51203>>>>>>>>>>>        //DDB-FieldDefaultEnd
51203>>>>>>>>>>>    End_Procedure    // Field_Defaults
51204>>>>>>>>>>>
51204>>>>>>>>>>>End_Class    // Pmsdtl_DataDictionary
51205>>>>>>>>>>>//DDB-FileEnd
51205>>>>>>>>>    Use BAXIOKAT.DD
51205>>>>>>>>>    Use SYSCURXR.DD
51205>>>>>>>>>    Use PMSSXET.DD
51205>>>>>>>>>    Use SALESMEN.DD
INCLUDING FILE: SALESMEN.DD
51205>>>>>>>>>>>//DDB-FileStart
51205>>>>>>>>>>>//DDB-HeaderStart
51205>>>>>>>>>>>
51205>>>>>>>>>>>// File Name : SALESMEN.DD
51205>>>>>>>>>>>// Class Name: Salesmen_DataDictionary
51205>>>>>>>>>>>// Revision  : 57
51205>>>>>>>>>>>// Version   : 2
51205>>>>>>>>>>>
51205>>>>>>>>>>>Use  Windows           // Basic Definitions
51205>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
51205>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51205>>>>>>>>>>>
51205>>>>>>>>>>>Open Salesmen
51207>>>>>>>>>>>Open Cn
51209>>>>>>>>>>>Open Sysrecc
51211>>>>>>>>>>>
51211>>>>>>>>>>>//DDB-HeaderEnd
51211>>>>>>>>>>>//DDB-ValidationStart
51211>>>>>>>>>>>
51211>>>>>>>>>>>Register_Object Salesmen_Sls_Doy_VT
51211>>>>>>>>>>>
51211>>>>>>>>>>>Object Salesmen_Sls_Doy_VT  is a CodeValidationTable
51213>>>>>>>>>>>    Set Type_Value        To "DOY"
51214>>>>>>>>>>>    Set Allow_Blank_State To TRUE
51215>>>>>>>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
51216>>>>>>>>>>>    //DDB-ValidationCustomStart
51216>>>>>>>>>>>    //DDB-ValidationCustomEnd
51216>>>>>>>>>>>End_Object   // Salesmen_Sls_Doy_VT
51217>>>>>>>>>>>//DDB-ValidationEnd
51217>>>>>>>>>>>//DDB-SelectionStart
51217>>>>>>>>>>>//DDB/ ExternalSelectionList sl108  sl108.sl
51217>>>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
51217>>>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
51217>>>>>>>>>>>Register_Object sl108
51217>>>>>>>>>>>Register_Object sl198
51217>>>>>>>>>>>Register_Object sl197
51217>>>>>>>>>>>//DDB-SelectionEnd
51217>>>>>>>>>>>
51217>>>>>>>>>>>Class Salesmen_DataDictionary  is a DataDictionary_Sec
51218>>>>>>>>>>> 
51218>>>>>>>>>>>    // Save_Main_File:
51218>>>>>>>>>>> 
51218>>>>>>>>>>>    Procedure Save_Main_File
51219>>>>>>>>>>>        If ((Operation_Origin<>Self) And (Salesmen.Sls_ID='')) Procedure_Return
51222>>>>>>>>>>>        Forward Send Save_Main_File
51224>>>>>>>>>>>    End_Procedure   // Save_Main_File
51225>>>>>>>>>>> 
51225>>>>>>>>>>>    // Define_Fields:
51225>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
51225>>>>>>>>>>>     Procedure Update
51226>>>>>>>>>>>        Forward Send Update
51228>>>>>>>>>>>        // Insert Code Here
51228>>>>>>>>>>>        Move SysCurXR.Company_Code  to salesmen.Company_Code
51229>>>>>>>>>>>        Move SysCurXR.Branch_Code   to salesmen.Branch_Code
51230>>>>>>>>>>>        Move SysCurXR.Year_Year     to salesmen.Year_Year
51231>>>>>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
51231>>>>>>>>>>>        Move (salesmen.Xreosh-salesmen.Pistosh)   to salesmen.Ypoloipo
51232>>>>>>>>>>>        Move (salesmen.Plafon-salesmen.ypoloipo)  to salesmen.Overhead
51233>>>>>>>>>>>
51233>>>>>>>>>>>        //Move Clients.Client_Address     to Clients.Client_LastUpd
51233>>>>>>>>>>>
51233>>>>>>>>>>>        //betolink
51233>>>>>>>>>>>        Move SysCurXR.Beto_Site      to salesmen.sls_SiteW
51234>>>>>>>>>>>        Move salesmen.sls_Rec0       to salesmen.sls_SN
51235>>>>>>>>>>>        Move salesmen.sls_id         to salesmen.sls_Repm
51236>>>>>>>>>>>
51236>>>>>>>>>>>    End_Procedure   // Update
51237>>>>>>>>>>>
51237>>>>>>>>>>>     Procedure Creating
51238>>>>>>>>>>>        Forward Send Creating
51240>>>>>>>>>>>        // Insert Code Here
51240>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(salesmen.sls_Rec0))))));                                    to salesmen.sls_Recr
51241>>>>>>>>>>>        Move '1'                    to salesmen.sls_Active
51242>>>>>>>>>>>        get fsgCode_With_Zeroes salesmen.sls_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to salesmen.sls_ID
51243>>>>>>>>>>>    End_Procedure   // Creating
51244>>>>>>>>>>>
51244>>>>>>>>>>>    Procedure Define_Fields
51245>>>>>>>>>>>        Forward Send Define_Fields
51247>>>>>>>>>>>        //DDB-Generated-Code-Location
51247>>>>>>>>>>>        //DDB-DefineFieldStart
51247>>>>>>>>>>>
51247>>>>>>>>>>>        Set Main_File            To Salesmen.File_Number
51248>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
51249>>>>>>>>>>>
51249>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
51250>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
51251>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51252>>>>>>>>>>>
51252>>>>>>>>>>>        // Child (Client) file structure................
51252>>>>>>>>>>>        Send Add_Client_File  Cn.File_Number
51253>>>>>>>>>>>
51253>>>>>>>>>>>        // External (System) file structure.............
51253>>>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
51254>>>>>>>>>>>
51254>>>>>>>>>>>        Define_Auto_Increment  Sysrecc.Salesmen_Rec0  To Salesmen.Sls_Rec0
51257>>>>>>>>>>>
51257>>>>>>>>>>>        // Field-based properties.......................
51257>>>>>>>>>>>
51257>>>>>>>>>>>        // Salesmen.Company_Code
51257>>>>>>>>>>>
51257>>>>>>>>>>>        // Salesmen.Branch_Code
51257>>>>>>>>>>>
51257>>>>>>>>>>>        // Salesmen.Year_Year
51257>>>>>>>>>>>
51257>>>>>>>>>>>        // Salesmen.Sls_Id
51257>>>>>>>>>>>        Set Field_Options          Field Salesmen.Sls_Id To DD_AUTOFIND    DD_FINDREQ    
51258>>>>>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Id To (sl108(Self))
51259>>>>>>>>>>>        Set Key_Field_State        Field Salesmen.Sls_Id To TRUE
51260>>>>>>>>>>>
51260>>>>>>>>>>>        // Salesmen.Sls_Name
51260>>>>>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Name To (sl108(Self))
51261>>>>>>>>>>>
51261>>>>>>>>>>>        // Salesmen.Sls_Afm
51261>>>>>>>>>>>
51261>>>>>>>>>>>        // Salesmen.Sls_Rec0
51261>>>>>>>>>>>
51261>>>>>>>>>>>        // Salesmen.Sls_Recr
51261>>>>>>>>>>>
51261>>>>>>>>>>>        // Salesmen.Last_Xreosh
51261>>>>>>>>>>>
51261>>>>>>>>>>>        // Salesmen.Last_Pistosh
51261>>>>>>>>>>>
51261>>>>>>>>>>>        // Salesmen.Last_Order
51261>>>>>>>>>>>
51261>>>>>>>>>>>        // Salesmen.Sls_Doy
51261>>>>>>>>>>>        Set Field_Value_Table      Field Salesmen.Sls_Doy To (Salesmen_Sls_Doy_VT(Self))
51262>>>>>>>>>>>
51262>>>>>>>>>>>        // Salesmen.Sls_Address
51262>>>>>>>>>>>
51262>>>>>>>>>>>        // Salesmen.Sls_City
51262>>>>>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_City To (sl198(Self))
51263>>>>>>>>>>>
51263>>>>>>>>>>>        // Salesmen.Sls_Area
51263>>>>>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Area To (sl197(Self))
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Sls_Job
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Sls_Respons
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Sls_Zipcode
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Sls_Phone
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Sls_Fax
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Sls_Mobile
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Sls_Aoh
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Sls_Email
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Sls_Class
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Sls_Details
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Sls_Sitew
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Sls_Codem
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Sls_Categfpa
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Sls_Fpa
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Sls_Public
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Sls_Sn
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Sls_Repm
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Sls_Active
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Sls_Reported
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Sls_Lastupd
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Sls_Markexp
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Sls_Catjob
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Xreosh
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Pistosh
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Ypoloipo
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Plafon
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Overhead
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Sls_Add_No
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Sls_Nomos
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Sls_Xora
51264>>>>>>>>>>>
51264>>>>>>>>>>>        // Salesmen.Polh_Recr
51264>>>>>>>>>>>
51264>>>>>>>>>>>        //DDB-DefineFieldEnd
51264>>>>>>>>>>>    End_Procedure    // Define_Fields
51265>>>>>>>>>>>
51265>>>>>>>>>>>    // Field_Defaults:
51265>>>>>>>>>>>    // This procedure is used to establish default field values.
51265>>>>>>>>>>>
51265>>>>>>>>>>>    Procedure Field_Defaults
51266>>>>>>>>>>>        Forward Send Field_Defaults
51268>>>>>>>>>>>        //DDB-Generated-Code-Location
51268>>>>>>>>>>>        //DDB-FieldDefaultStart
51268>>>>>>>>>>>        Set Field_Changed_Value   Field Salesmen.Sls_Doy To "0"
51269>>>>>>>>>>>        //DDB-FieldDefaultEnd
51269>>>>>>>>>>>    End_Procedure    // Field_Defaults
51270>>>>>>>>>>>
51270>>>>>>>>>>>End_Class    // Salesmen_DataDictionary
51271>>>>>>>>>>>//DDB-Selection-pkg-Start
51271>>>>>>>>>>>
51271>>>>>>>>>>>Use sl108.sl         // sl108
INCLUDING FILE: SL108.SL
51271>>>>>>>>>>>>>//AB/ Project sl108:polhtes
51271>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
51271>>>>>>>>>>>>>//AB/     Set ProjectName to "sl108:polhtes"
51271>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl108.SL"
51271>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
51271>>>>>>>>>>>>>
51271>>>>>>>>>>>>>// Project Object Structure
51271>>>>>>>>>>>>>//   sl108 is a dbModalPanelSub
51271>>>>>>>>>>>>>//     Salesmen_DD is a DataDictionary
51271>>>>>>>>>>>>>//     oSelList is a dbListSub
51271>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
51271>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
51271>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
51271>>>>>>>>>>>>>
51271>>>>>>>>>>>>>// Register all objects
51271>>>>>>>>>>>>>Register_Object oCancel_bn
51271>>>>>>>>>>>>>Register_Object oOK_bn
51271>>>>>>>>>>>>>Register_Object oSearch_bn
51271>>>>>>>>>>>>>Register_Object oSelList
51271>>>>>>>>>>>>>Register_Object Salesmen_DD
51271>>>>>>>>>>>>>Register_Object sl108
51271>>>>>>>>>>>>>
51271>>>>>>>>>>>>>
51271>>>>>>>>>>>>>//AB-IgnoreStart
51271>>>>>>>>>>>>>
51271>>>>>>>>>>>>>Use DFAllEnt.pkg
51271>>>>>>>>>>>>>Use dbList.Sub
51271>>>>>>>>>>>>>Use Button.Sub
51271>>>>>>>>>>>>>
51271>>>>>>>>>>>>>
51271>>>>>>>>>>>>>Use SALESMEN.DD
51271>>>>>>>>>>>>>
51271>>>>>>>>>>>>>//AB-IgnoreEnd
51271>>>>>>>>>>>>>
51271>>>>>>>>>>>>>Object sl108 is a dbModalPanelSub
51273>>>>>>>>>>>>>    Set Label to "‹ž«¨é¦ à¢ž«é¤"
51274>>>>>>>>>>>>>    Set Size to 148 421
51275>>>>>>>>>>>>>    Set Location to 4 5
51276>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
51277>>>>>>>>>>>>>    Set Modal_State to FALSE
51278>>>>>>>>>>>>>
51278>>>>>>>>>>>>>    //AB-DDOStart
51278>>>>>>>>>>>>>
51278>>>>>>>>>>>>>    Object Salesmen_DD is a Salesmen_DataDictionary
51280>>>>>>>>>>>>>    End_Object    // Salesmen_DD
51281>>>>>>>>>>>>>
51281>>>>>>>>>>>>>    Set Main_DD to (Salesmen_DD(self))
51282>>>>>>>>>>>>>    Set Server to (Salesmen_DD(self))
51283>>>>>>>>>>>>>
51283>>>>>>>>>>>>>    //AB-DDOEnd
51283>>>>>>>>>>>>>
51283>>>>>>>>>>>>>    Object oSelList is a dbListSub
51285>>>>>>>>>>>>>        Set Main_File to Salesmen.File_Number
51286>>>>>>>>>>>>>        Set Size to 105 408
51287>>>>>>>>>>>>>        Set Location to 6 6
51288>>>>>>>>>>>>>
51288>>>>>>>>>>>>>        Begin_Row
51291>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_id
51292>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_name
51293>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_afm
51294>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_address
51295>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_phone
51296>>>>>>>>>>>>>        End_Row
51301>>>>>>>>>>>>>
51301>>>>>>>>>>>>>        Set Form_Width    item 0 to 60
51302>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
51303>>>>>>>>>>>>>        
51303>>>>>>>>>>>>>        Set Form_Width    item 1 to 100
51304>>>>>>>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
51305>>>>>>>>>>>>>        
51305>>>>>>>>>>>>>        Set Form_Width    item 2 to 60
51306>>>>>>>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
51307>>>>>>>>>>>>>        
51307>>>>>>>>>>>>>        Set Form_Width    item 3 to 125
51308>>>>>>>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
51309>>>>>>>>>>>>>        
51309>>>>>>>>>>>>>        Set Form_Width    item 4 to 54
51310>>>>>>>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
51311>>>>>>>>>>>>>        
51311>>>>>>>>>>>>>    End_Object    // oSelList
51312>>>>>>>>>>>>>
51312>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
51314>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
51315>>>>>>>>>>>>>        Set Location to 117 255
51316>>>>>>>>>>>>>
51316>>>>>>>>>>>>>        //AB-StoreStart
51316>>>>>>>>>>>>>        Procedure OnClick
51318>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
51319>>>>>>>>>>>>>        End_Procedure
51320>>>>>>>>>>>>>        //AB-StoreEnd
51320>>>>>>>>>>>>>
51320>>>>>>>>>>>>>    End_Object    // oOK_bn
51321>>>>>>>>>>>>>
51321>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
51323>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
51324>>>>>>>>>>>>>        Set Location to 117 310
51325>>>>>>>>>>>>>
51325>>>>>>>>>>>>>        //AB-StoreStart
51325>>>>>>>>>>>>>        Procedure OnClick
51327>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
51328>>>>>>>>>>>>>        End_Procedure
51329>>>>>>>>>>>>>        //AB-StoreEnd
51329>>>>>>>>>>>>>
51329>>>>>>>>>>>>>    End_Object    // oCancel_bn
51330>>>>>>>>>>>>>
51330>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
51332>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
51333>>>>>>>>>>>>>        Set Location to 117 365
51334>>>>>>>>>>>>>
51334>>>>>>>>>>>>>        //AB-StoreStart
51334>>>>>>>>>>>>>        Procedure OnClick
51336>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
51337>>>>>>>>>>>>>        End_Procedure
51338>>>>>>>>>>>>>        //AB-StoreEnd
51338>>>>>>>>>>>>>
51338>>>>>>>>>>>>>    End_Object    // oSearch_bn
51339>>>>>>>>>>>>>
51339>>>>>>>>>>>>>
51339>>>>>>>>>>>>>    //AB-StoreStart
51339>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
51340>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
51341>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
51342>>>>>>>>>>>>>    //AB-StoreEnd
51342>>>>>>>>>>>>>
51342>>>>>>>>>>>>>End_Object    // sl108
51343>>>>>>>>>>>>>
51343>>>>>>>>>>>>>//AB/ End_Object    // prj
51343>>>>>>>>>>>Use sl198.sl         // sl198
51343>>>>>>>>>>>Use sl197.SL         // sl197
51343>>>>>>>>>>>
51343>>>>>>>>>>>//DDB-Selection-pkg-End
51343>>>>>>>>>>>//DDB-FileEnd
51343>>>>>>>>>    Use CONSTRCT.DD
INCLUDING FILE: CONSTRCT.DD
51343>>>>>>>>>>>//DDB-FileStart
51343>>>>>>>>>>>//DDB-HeaderStart
51343>>>>>>>>>>>
51343>>>>>>>>>>>// File Name : CONSTRCT.DD
51343>>>>>>>>>>>// Class Name: Constrct_DataDictionary
51343>>>>>>>>>>>// Revision  : 49
51343>>>>>>>>>>>// Version   : 2
51343>>>>>>>>>>>
51343>>>>>>>>>>>Use  Windows           // Basic Definitions
51343>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
51343>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51343>>>>>>>>>>>
51343>>>>>>>>>>>Open Constrct
51345>>>>>>>>>>>Open Cn
51347>>>>>>>>>>>Open Sysrecc
51349>>>>>>>>>>>
51349>>>>>>>>>>>//DDB-HeaderEnd
51349>>>>>>>>>>>//DDB-ValidationStart
51349>>>>>>>>>>>
51349>>>>>>>>>>>Register_Object Constrct_Cnt_Doy_VT1
51349>>>>>>>>>>>
51349>>>>>>>>>>>Object Constrct_Cnt_Doy_VT1  is a CodeValidationTable
51351>>>>>>>>>>>    Set Type_Value        To "DOY"
51352>>>>>>>>>>>    Set Allow_Blank_State To TRUE
51353>>>>>>>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
51354>>>>>>>>>>>    //DDB-ValidationCustomStart
51354>>>>>>>>>>>    //DDB-ValidationCustomEnd
51354>>>>>>>>>>>End_Object   // Constrct_Cnt_Doy_VT1
51355>>>>>>>>>>>//DDB-ValidationEnd
51355>>>>>>>>>>>//DDB-SelectionStart
51355>>>>>>>>>>>//DDB/ ExternalSelectionList sl109  sl109.SL
51355>>>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
51355>>>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
51355>>>>>>>>>>>Register_Object sl109
51355>>>>>>>>>>>Register_Object sl198
51355>>>>>>>>>>>Register_Object sl197
51355>>>>>>>>>>>//DDB-SelectionEnd
51355>>>>>>>>>>>
51355>>>>>>>>>>>Class Constrct_DataDictionary  is a DataDictionary_Sec
51356>>>>>>>>>>>    Procedure Update
51357>>>>>>>>>>>        Forward Send Update
51359>>>>>>>>>>>        // Insert Code Here
51359>>>>>>>>>>>        Move SysCurXR.Company_Code  to constrct.Company_Code
51360>>>>>>>>>>>        Move SysCurXR.Branch_Code   to constrct.Branch_Code
51361>>>>>>>>>>>        Move SysCurXR.Year_Year     to constrct.Year_Year
51362>>>>>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
51362>>>>>>>>>>>        Move (constrct.Xreosh-Constrct.Pistosh)   to Constrct.Ypoloipo
51363>>>>>>>>>>>        Move (constrct.Plafon-Constrct.Ypoloipo)  to Constrct.Overhead
51364>>>>>>>>>>>
51364>>>>>>>>>>>        //betolink
51364>>>>>>>>>>>        Move SysCurXR.Beto_Site      to Constrct.cnt_SiteW
51365>>>>>>>>>>>        Move Constrct.cnt_Rec0        to Constrct.cnt_SN
51366>>>>>>>>>>>        Move Constrct.cnt_id          to constrct.cnt_Repm
51367>>>>>>>>>>>
51367>>>>>>>>>>>    End_Procedure   // Update
51368>>>>>>>>>>>
51368>>>>>>>>>>>     Procedure Creating
51369>>>>>>>>>>>        Forward Send Creating
51371>>>>>>>>>>>        // Insert Code Here
51371>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Constrct.cnt_Rec0))))));                                    to Constrct.Cnt_Recr
51372>>>>>>>>>>>        Move '1'                    to Constrct.Cnt_Active
51373>>>>>>>>>>>        Get fsgCode_With_Zeroes Constrct.Cnt_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to Constrct.cnt_ID
51374>>>>>>>>>>>    End_Procedure   // Creating
51375>>>>>>>>>>>
51375>>>>>>>>>>>
51375>>>>>>>>>>>    Procedure Define_Fields
51376>>>>>>>>>>>        Forward Send Define_Fields
51378>>>>>>>>>>>        //DDB-Generated-Code-Location
51378>>>>>>>>>>>        //DDB-DefineFieldStart
51378>>>>>>>>>>>
51378>>>>>>>>>>>        Set Main_File            To Constrct.File_Number
51379>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
51380>>>>>>>>>>>
51380>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
51381>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
51382>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51383>>>>>>>>>>>
51383>>>>>>>>>>>        // Child (Client) file structure................
51383>>>>>>>>>>>        Send Add_Client_File  Cn.File_Number
51384>>>>>>>>>>>
51384>>>>>>>>>>>        // External (System) file structure.............
51384>>>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
51385>>>>>>>>>>>
51385>>>>>>>>>>>        Define_Auto_Increment  Sysrecc.Constrct_Rec0  To Constrct.Cnt_Rec0
51388>>>>>>>>>>>
51388>>>>>>>>>>>        // Field-based properties.......................
51388>>>>>>>>>>>
51388>>>>>>>>>>>        // Constrct.Company_Code
51388>>>>>>>>>>>
51388>>>>>>>>>>>        // Constrct.Branch_Code
51388>>>>>>>>>>>
51388>>>>>>>>>>>        // Constrct.Year_Year
51388>>>>>>>>>>>
51388>>>>>>>>>>>        // Constrct.Cnt_Id
51388>>>>>>>>>>>        Set Field_Options          Field Constrct.Cnt_Id To DD_AUTOFIND    DD_NOPUT      
51389>>>>>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_Id To (sl109(Self))
51390>>>>>>>>>>>        Set Key_Field_State        Field Constrct.Cnt_Id To TRUE
51391>>>>>>>>>>>
51391>>>>>>>>>>>        // Constrct.Cnt_Name
51391>>>>>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_Name To (sl109(Self))
51392>>>>>>>>>>>
51392>>>>>>>>>>>        // Constrct.Cnt_Afm
51392>>>>>>>>>>>
51392>>>>>>>>>>>        // Constrct.Cnt_Rec0
51392>>>>>>>>>>>
51392>>>>>>>>>>>        // Constrct.Cnt_Recr
51392>>>>>>>>>>>
51392>>>>>>>>>>>        // Constrct.Last_Xreosh
51392>>>>>>>>>>>
51392>>>>>>>>>>>        // Constrct.Last_Pistosh
51392>>>>>>>>>>>
51392>>>>>>>>>>>        // Constrct.Last_Order
51392>>>>>>>>>>>
51392>>>>>>>>>>>        // Constrct.Cnt_Doy
51392>>>>>>>>>>>        Set Field_Value_Table      Field Constrct.Cnt_Doy To (Constrct_Cnt_Doy_VT1(Self))
51393>>>>>>>>>>>
51393>>>>>>>>>>>        // Constrct.Cnt_Address
51393>>>>>>>>>>>
51393>>>>>>>>>>>        // Constrct.Cnt_City
51393>>>>>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_City To (sl198(Self))
51394>>>>>>>>>>>
51394>>>>>>>>>>>        // Constrct.Cnt_Area
51394>>>>>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_Area To (sl197(Self))
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Cnt_Job
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Cnt_Respons
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Cnt_Zipcode
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Cnt_Phone
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Cnt_Fax
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Cnt_Mobile
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Cnt_Aoh
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Cnt_Email
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Cnt_Class
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Cnt_Details
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Cnt_Sitew
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Cnt_Codem
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Cnt_Categfpa
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Cnt_Fpa
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Cnt_Public
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Cnt_Sn
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Cnt_Repm
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Cnt_Active
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Cnt_Reported
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Cnt_Pelprom
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Cnt_Lastupdated
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Cnt_Markexp
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Cnt_Catjob
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Xreosh
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Pistosh
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Ypoloipo
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Plafon
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Overhead
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Cnt_Add_No
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Cnt_Nomos
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Cnt_Xora
51395>>>>>>>>>>>
51395>>>>>>>>>>>        // Constrct.Polh_Recr
51395>>>>>>>>>>>
51395>>>>>>>>>>>        //DDB-DefineFieldEnd
51395>>>>>>>>>>>    End_Procedure    // Define_Fields
51396>>>>>>>>>>>
51396>>>>>>>>>>>    // Field_Defaults:
51396>>>>>>>>>>>    // This procedure is used to establish default field values.
51396>>>>>>>>>>>
51396>>>>>>>>>>>    Procedure Field_Defaults
51397>>>>>>>>>>>        Forward Send Field_Defaults
51399>>>>>>>>>>>        //DDB-Generated-Code-Location
51399>>>>>>>>>>>        //DDB-FieldDefaultStart
51399>>>>>>>>>>>        Set Field_Changed_Value   Field Constrct.Cnt_Doy To "0"
51400>>>>>>>>>>>        //DDB-FieldDefaultEnd
51400>>>>>>>>>>>    End_Procedure    // Field_Defaults
51401>>>>>>>>>>>
51401>>>>>>>>>>>End_Class    // Constrct_DataDictionary
51402>>>>>>>>>>>//DDB-Selection-pkg-Start
51402>>>>>>>>>>>
51402>>>>>>>>>>>Use sl109.SL         // sl109
INCLUDING FILE: SL109.SL
51402>>>>>>>>>>>>>//AB/ Project sl109
51402>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
51402>>>>>>>>>>>>>//AB/     Set ProjectName to "sl109"
51402>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl109.SL"
51402>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
51402>>>>>>>>>>>>>
51402>>>>>>>>>>>>>// Project Object Structure
51402>>>>>>>>>>>>>//   sl109 is a dbModalPanelSub
51402>>>>>>>>>>>>>//     Constrct_DD is a DataDictionary
51402>>>>>>>>>>>>>//     oSelList is a dbListSub
51402>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
51402>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
51402>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
51402>>>>>>>>>>>>>
51402>>>>>>>>>>>>>// Register all objects
51402>>>>>>>>>>>>>Register_Object Constrct_DD
51402>>>>>>>>>>>>>Register_Object oCancel_bn
51402>>>>>>>>>>>>>Register_Object oOK_bn
51402>>>>>>>>>>>>>Register_Object oSearch_bn
51402>>>>>>>>>>>>>Register_Object oSelList
51402>>>>>>>>>>>>>Register_Object sl109
51402>>>>>>>>>>>>>
51402>>>>>>>>>>>>>
51402>>>>>>>>>>>>>//AB-IgnoreStart
51402>>>>>>>>>>>>>
51402>>>>>>>>>>>>>Use DFAllEnt.pkg
51402>>>>>>>>>>>>>Use dbList.Sub
51402>>>>>>>>>>>>>Use Button.Sub
51402>>>>>>>>>>>>>
51402>>>>>>>>>>>>>
51402>>>>>>>>>>>>>Use CONSTRCT.DD
51402>>>>>>>>>>>>>
51402>>>>>>>>>>>>>//AB-IgnoreEnd
51402>>>>>>>>>>>>>
51402>>>>>>>>>>>>>Object sl109 is a dbModalPanelSub
51404>>>>>>>>>>>>>    Set Label to "„¨š¦¢á™¦  "
51405>>>>>>>>>>>>>    Set Size to 148 427
51406>>>>>>>>>>>>>    Set Location to 4 5
51407>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
51408>>>>>>>>>>>>>    Set Modal_State to FALSE
51409>>>>>>>>>>>>>
51409>>>>>>>>>>>>>    //AB-DDOStart
51409>>>>>>>>>>>>>
51409>>>>>>>>>>>>>    Object Constrct_DD is a Constrct_DataDictionary
51411>>>>>>>>>>>>>    End_Object    // Constrct_DD
51412>>>>>>>>>>>>>
51412>>>>>>>>>>>>>    Set Main_DD to (Constrct_DD(self))
51413>>>>>>>>>>>>>    Set Server to (Constrct_DD(self))
51414>>>>>>>>>>>>>
51414>>>>>>>>>>>>>    //AB-DDOEnd
51414>>>>>>>>>>>>>
51414>>>>>>>>>>>>>    Object oSelList is a dbListSub
51416>>>>>>>>>>>>>        Set Main_File to Constrct.File_Number
51417>>>>>>>>>>>>>        Set Size to 105 415
51418>>>>>>>>>>>>>        Set Location to 6 6
51419>>>>>>>>>>>>>
51419>>>>>>>>>>>>>        Begin_Row
51422>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_id
51423>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_name
51424>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_afm
51425>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_address
51426>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_phone
51427>>>>>>>>>>>>>        End_Row
51432>>>>>>>>>>>>>
51432>>>>>>>>>>>>>        Set Form_Width    item 0 to 70
51433>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
51434>>>>>>>>>>>>>        
51434>>>>>>>>>>>>>        Set Form_Width    item 1 to 100
51435>>>>>>>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
51436>>>>>>>>>>>>>        
51436>>>>>>>>>>>>>        Set Form_Width    item 2 to 50
51437>>>>>>>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
51438>>>>>>>>>>>>>        
51438>>>>>>>>>>>>>        Set Form_Width    item 3 to 135
51439>>>>>>>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
51440>>>>>>>>>>>>>        
51440>>>>>>>>>>>>>        Set Form_Width    item 4 to 52
51441>>>>>>>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
51442>>>>>>>>>>>>>        
51442>>>>>>>>>>>>>    End_Object    // oSelList
51443>>>>>>>>>>>>>
51443>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
51445>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
51446>>>>>>>>>>>>>        Set Location to 116 261
51447>>>>>>>>>>>>>
51447>>>>>>>>>>>>>        //AB-StoreStart
51447>>>>>>>>>>>>>        Procedure OnClick
51449>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
51450>>>>>>>>>>>>>        End_Procedure
51451>>>>>>>>>>>>>        //AB-StoreEnd
51451>>>>>>>>>>>>>
51451>>>>>>>>>>>>>    End_Object    // oOK_bn
51452>>>>>>>>>>>>>
51452>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
51454>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
51455>>>>>>>>>>>>>        Set Location to 116 315
51456>>>>>>>>>>>>>
51456>>>>>>>>>>>>>        //AB-StoreStart
51456>>>>>>>>>>>>>        Procedure OnClick
51458>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
51459>>>>>>>>>>>>>        End_Procedure
51460>>>>>>>>>>>>>        //AB-StoreEnd
51460>>>>>>>>>>>>>
51460>>>>>>>>>>>>>    End_Object    // oCancel_bn
51461>>>>>>>>>>>>>
51461>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
51463>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
51464>>>>>>>>>>>>>        Set Location to 116 371
51465>>>>>>>>>>>>>
51465>>>>>>>>>>>>>        //AB-StoreStart
51465>>>>>>>>>>>>>        Procedure OnClick
51467>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
51468>>>>>>>>>>>>>        End_Procedure
51469>>>>>>>>>>>>>        //AB-StoreEnd
51469>>>>>>>>>>>>>
51469>>>>>>>>>>>>>    End_Object    // oSearch_bn
51470>>>>>>>>>>>>>
51470>>>>>>>>>>>>>
51470>>>>>>>>>>>>>    //AB-StoreStart
51470>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
51471>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
51472>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
51473>>>>>>>>>>>>>    //AB-StoreEnd
51473>>>>>>>>>>>>>
51473>>>>>>>>>>>>>End_Object    // sl109
51474>>>>>>>>>>>>>
51474>>>>>>>>>>>>>//AB/ End_Object    // prj
51474>>>>>>>>>>>Use sl198.sl         // sl198
51474>>>>>>>>>>>Use sl197.SL         // sl197
51474>>>>>>>>>>>
51474>>>>>>>>>>>//DDB-Selection-pkg-End
51474>>>>>>>>>>>//DDB-FileEnd
51474>>>>>>>>>    Use CN.DD
51474>>>>>>>>>    Use PSXETIKA.DD
INCLUDING FILE: PSXETIKA.DD
51474>>>>>>>>>>>//DDB-FileStart
51474>>>>>>>>>>>//DDB-HeaderStart
51474>>>>>>>>>>>
51474>>>>>>>>>>>// File Name : PSXETIKA.DD
51474>>>>>>>>>>>// Class Name: Psxetika_DataDictionary
51474>>>>>>>>>>>// Revision  : 14
51474>>>>>>>>>>>// Version   : 2
51474>>>>>>>>>>>
51474>>>>>>>>>>>Use  Windows           // Basic Definitions
51474>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
51474>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51474>>>>>>>>>>>
51474>>>>>>>>>>>Open Psxetika
51476>>>>>>>>>>>Open Particle
51478>>>>>>>>>>>Open Sysrecp
51480>>>>>>>>>>>
51480>>>>>>>>>>>//DDB-HeaderEnd
51480>>>>>>>>>>>
51480>>>>>>>>>>>Class Psxetika_DataDictionary  is a DataDictionary_Sec
51481>>>>>>>>>>>
51481>>>>>>>>>>>    Procedure Creating
51482>>>>>>>>>>>        Integer iNextNo
51483>>>>>>>>>>>        Forward Send Creating
51485>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Psxetika.Psxetika_Rec0)))))) to Psxetika.Psxetika_Recr
51486>>>>>>>>>>>    End_Procedure   // Creating
51487>>>>>>>>>>>
51487>>>>>>>>>>>    Procedure Update
51488>>>>>>>>>>>        Forward Send Update
51490>>>>>>>>>>>        Move SysCurXR.Company_Code  to Psxetika.Company_Code
51491>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Psxetika.Branch_Code
51492>>>>>>>>>>>        Move SysCurXR.Year_Year     to Psxetika.Year_Year
51493>>>>>>>>>>>        Move Clients.Client_ID      to Psxetika.Client_ID
51494>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code   to Psxetika.Ctypkin_Code
51495>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code   to Psxetika.Wtypkin_Code
51496>>>>>>>>>>>        Move Ptyppar.Ptyppar_Code   to Psxetika.Ptyppar_Code
51497>>>>>>>>>>>        Move Particle.Partl_Hmnia   to Psxetika.Partl_Hmnia
51498>>>>>>>>>>>        Move Particle.Pseira_Seira  to Psxetika.Pseira_Seira
51499>>>>>>>>>>>        Move Particle.Partl_No      to Psxetika.Partl_No
51500>>>>>>>>>>>    End_Procedure   // Update
51501>>>>>>>>>>>
51501>>>>>>>>>>>
51501>>>>>>>>>>>    Procedure Request_Save
51502>>>>>>>>>>>        Number  nQty
51503>>>>>>>>>>>        String  sParticleRecr sPsxetikaRecr
51503>>>>>>>>>>>
51503>>>>>>>>>>>        Forward Send Request_Save
51505>>>>>>>>>>>
51505>>>>>>>>>>>        Get File_Field_Current_Value File_Field Particle.Partl_Recr     to sParticleRecr
51506>>>>>>>>>>>        Get File_Field_Current_Value File_Field Psxetika.Psx_Partl_Recr to sPsxetikaRecr
51507>>>>>>>>>>>        If ((Trim(sParticleRecr)<>'') And (Trim(sPsxetikaRecr)<>'')) Begin
51509>>>>>>>>>>>            Get File_Field_Current_Value File_Field Psxetika.Pms_Sx_Qty to nQty
51510>>>>>>>>>>>            If (nQty=0) Begin
51512>>>>>>>>>>>                // An h posothta pou menei apo to athroisma posothtas ton Pmoves Sxetika
51512>>>>>>>>>>>                // Mhdenisei, ayto shmainei pos den yparxoun alla Pmoves Sxetika, ara
51512>>>>>>>>>>>                // prepei na diagrafei ayto to Psxetika record kai to antistrofo tou.
51512>>>>>>>>>>>                Delete Psxetika
51513>>>>>>>>>>>                Clear Psxetika
51514>>>>>>>>>>>                Move sPsxetikaRecr  to Psxetika.Partl_Recr
51515>>>>>>>>>>>                Move sParticleRecr  to Psxetika.Psx_Partl_Recr
51516>>>>>>>>>>>                Find Eq Psxetika by Index.4
51517>>>>>>>>>>>>
51517>>>>>>>>>>>                If (Found) Delete Psxetika
51520>>>>>>>>>>>            End
51520>>>>>>>>>>>>
51520>>>>>>>>>>>        End
51520>>>>>>>>>>>>
51520>>>>>>>>>>>    End_Procedure
51521>>>>>>>>>>>
51521>>>>>>>>>>>
51521>>>>>>>>>>>    // Define_Fields:
51521>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
51521>>>>>>>>>>>
51521>>>>>>>>>>>    Procedure Define_Fields
51522>>>>>>>>>>>        Forward Send Define_Fields
51524>>>>>>>>>>>        //DDB-Generated-Code-Location
51524>>>>>>>>>>>        //DDB-DefineFieldStart
51524>>>>>>>>>>>
51524>>>>>>>>>>>        Set Main_File            To Psxetika.File_Number
51525>>>>>>>>>>>
51525>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
51526>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
51527>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51528>>>>>>>>>>>
51528>>>>>>>>>>>        // Parent (Server) file structure...............
51528>>>>>>>>>>>        Send Add_Server_File  Particle.File_Number
51529>>>>>>>>>>>
51529>>>>>>>>>>>        // External (System) file structure.............
51529>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
51530>>>>>>>>>>>
51530>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Psxetika_Rec0  To Psxetika.Psxetika_Rec0
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Field-based properties.......................
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Company_Code
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Branch_Code
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Year_Year
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Ctypkin_Code
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Wtypkin_Code
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Ptyppar_Code
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Pseira_Seira
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Custprom_Code
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Client_Id
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Partl_No
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Partl_Hmnia
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Partl_Recr
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Psx_Partl_Recr
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Psxetika_Recr
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Psxetika_Rec0
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Sx_Company_Code
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Sx_Branch_Code
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Sx_Year_Year
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Sx_Ctypkin_Code
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Sx_Wtypkin_Code
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Sx_Ptyppar_Code
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Sx_Pseira_Seira
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Sx_Custpromcode
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Sx_Client_Id
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Sx_Partl_No
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Sx_Partl_Hmnia
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Sx_Ctypkin_Desc
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Sx_Wtypkin_Desc
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Sx_Ptyppar_Desc
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Sx_Custpromdesc
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Sx_Client_Desc
51533>>>>>>>>>>>
51533>>>>>>>>>>>        // Psxetika.Pms_Sx_Qty
51533>>>>>>>>>>>
51533>>>>>>>>>>>        //DDB-DefineFieldEnd
51533>>>>>>>>>>>    End_Procedure    // Define_Fields
51534>>>>>>>>>>>
51534>>>>>>>>>>>    // Field_Defaults:
51534>>>>>>>>>>>    // This procedure is used to establish default field values.
51534>>>>>>>>>>>
51534>>>>>>>>>>>    Procedure Field_Defaults
51535>>>>>>>>>>>        Forward Send Field_Defaults
51537>>>>>>>>>>>        //DDB-Generated-Code-Location
51537>>>>>>>>>>>        //DDB-FieldDefaultStart
51537>>>>>>>>>>>        //DDB-FieldDefaultEnd
51537>>>>>>>>>>>    End_Procedure    // Field_Defaults
51538>>>>>>>>>>>
51538>>>>>>>>>>>End_Class    // Psxetika_DataDictionary
51539>>>>>>>>>>>//DDB-FileEnd
51539>>>>>>>>>    Use TPARTICL.DD
INCLUDING FILE: TPARTICL.DD
51539>>>>>>>>>>>//DDB-FileStart
51539>>>>>>>>>>>//DDB-HeaderStart
51539>>>>>>>>>>>
51539>>>>>>>>>>>// File Name : TPARTICL.DD
51539>>>>>>>>>>>// Class Name: Tparticl_DataDictionary
51539>>>>>>>>>>>// Revision  : 28
51539>>>>>>>>>>>// Version   : 2
51539>>>>>>>>>>>
51539>>>>>>>>>>>Use  Windows           // Basic Definitions
51539>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
51539>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51539>>>>>>>>>>>
51539>>>>>>>>>>>Open Tparticl
51541>>>>>>>>>>>Open Particle
51543>>>>>>>>>>>Open Baxiokat
51545>>>>>>>>>>>Open Sysrecc
51547>>>>>>>>>>>
51547>>>>>>>>>>>//DDB-HeaderEnd
51547>>>>>>>>>>>//DDB-ValidationStart
51547>>>>>>>>>>>
51547>>>>>>>>>>>Register_Object Mera_Tou_Mhna_VT
51547>>>>>>>>>>>
51547>>>>>>>>>>>Object Mera_Tou_Mhna_VT  is a CodeValidationTable
51549>>>>>>>>>>>    Set Type_Value        To "HMERES"
51550>>>>>>>>>>>    Set Allow_Blank_State To TRUE
51551>>>>>>>>>>>    //DDB-ValidationCustomStart
51551>>>>>>>>>>>    //DDB-ValidationCustomEnd
51551>>>>>>>>>>>End_Object   // Mera_Tou_Mhna_VT
51552>>>>>>>>>>>//DDB-ValidationEnd
51552>>>>>>>>>>>
51552>>>>>>>>>>>Class Tparticl_DataDictionary  is a DataDictionary_Sec
51553>>>>>>>>>>>
51553>>>>>>>>>>>    Procedure Construct_Object
51554>>>>>>>>>>>        Forward Send Construct_Object
51556>>>>>>>>>>>        Property Integer piParticleID Public 0
51557>>>>>>>>>>>        Property Integer piBaxiokatID Public 0
51558>>>>>>>>>>>    End_Procedure
51559>>>>>>>>>>>
51559>>>>>>>>>>>    Procedure End_Construct_Object
51560>>>>>>>>>>>        Integer iID
51561>>>>>>>>>>>        Forward Send End_Construct_Object
51563>>>>>>>>>>>        Move (Find_Server_DDO(Self,Particle.File_Number )) to iID
51564>>>>>>>>>>>        Set piParticleID to iID
51565>>>>>>>>>>>        Move (Find_Server_DDO(Self,Baxiokat.File_Number )) to iID
51566>>>>>>>>>>>        Set piBaxiokatID to iID
51567>>>>>>>>>>>    End_Procedure
51568>>>>>>>>>>>
51568>>>>>>>>>>>    Procedure Calc_All_The_Fields
51569>>>>>>>>>>>        Number  nSynolo nPoso nPososto naxia
51570>>>>>>>>>>>        Date    dHmniaPlhromhs dHmniaParalabhs dHmniaTimologiou
51570>>>>>>>>>>>        Date    dProkeiptei dProsDate dAddDate dStartDate dEndDate
51570>>>>>>>>>>>        Integer iMeresXaritos iMeratouMhna iMeresParalabhs iID iInt iAdd
51570>>>>>>>>>>>        Integer iMeresPlhroteo iCode iXhmero iMhnasTimologiou  iMet
51570>>>>>>>>>>>
51570>>>>>>>>>>>        Get piBaxiokatID                                                to iID
51571>>>>>>>>>>>        Get Field_Current_Value Of iID Field Baxiokat.Baxiokat_Code     to iCode
51572>>>>>>>>>>>
51572>>>>>>>>>>>
51572>>>>>>>>>>>        Get piParticleID                                                to iID
51573>>>>>>>>>>>        Get Field_Current_Value Of iID Field Particle.Partl_Payam       to nSynolo
51574>>>>>>>>>>>        Get Field_Current_Value Of iID Field Particle.Partl_Hmnia       to dHmniaTimologiou
51575>>>>>>>>>>>        Get Field_Current_Value        Field TParticl.Pct_Epi_Synolou   to nPososto
51576>>>>>>>>>>>        Get Field_Current_Value        Field TParticl.Paralabh_Meres    to iMeresParalabhs
51577>>>>>>>>>>>        Get Field_Current_Value        Field TParticl.Xarhtos_Meres     to iMeresXaritos
51578>>>>>>>>>>>        Get Field_Current_Value        Field TParticl.Plhroteo_Meres    to iMeresPlhroteo
51579>>>>>>>>>>>
51579>>>>>>>>>>>        //////////////////////////////////////////////////////////////////////////
51579>>>>>>>>>>>        /////        10 (x)     -      10 (y)         /          30 (z)      /////
51579>>>>>>>>>>>        /////  iMeresParalabhs    iMeresXaritos              iMeresPlhroteo  /////
51579>>>>>>>>>>>        //////////////////////////////////////////////////////////////////////////
51579>>>>>>>>>>>
51579>>>>>>>>>>>        //  1. Kathorise thn 1h tou mhna, hmeromhniaka
51579>>>>>>>>>>>        Move ('01'+'/'+(String(TheMonthSegment(dHmniaTimologiou)))+'/'+;                       (String(TheYearSegment(dHmniaTimologiou)))) to dStartDate
51580>>>>>>>>>>>
51580>>>>>>>>>>>//        //  2. Vres thn Hmeromhnia paralabhs (Teleytaia hmera tou epomenou y hmerou
51580>>>>>>>>>>>//        //     sthn opoia meta tha prosthesoume tis hmeres paralabhs (x) )
51580>>>>>>>>>>>//        Move dStartDate to dHmniaParalabhs
51580>>>>>>>>>>>//        While (dHmniaParalabhs<(dHmniaTimologiou+iMeresXaritos))
51580>>>>>>>>>>>//            Add iMeresXaritos to dHmniaParalabhs
51580>>>>>>>>>>>//        Loop
51580>>>>>>>>>>>//        Add iMeresParalabhs to dHmniaParalabhs
51580>>>>>>>>>>>
51580>>>>>>>>>>>//        //  3. Vres thn Hmeromhnia Lhxhs ths epitaghs  (Teleytaia hmera tou trxontos y hmerou
51580>>>>>>>>>>>//        //     sthn opoia meta tha prosthesoume tis hmeres plhroteo (z) )
51580>>>>>>>>>>>//        Move dStartDate to dHmniaPlhromhs
51580>>>>>>>>>>>//        While (dHmniaPlhromhs<dHmniaTimologiou)
51580>>>>>>>>>>>//            Add iMeresXaritos to dHmniaPlhromhs
51580>>>>>>>>>>>//        Loop
51580>>>>>>>>>>>//        Add iMeresPlhroteo  to dHmniaPlhromhs
51580>>>>>>>>>>>
51580>>>>>>>>>>>        //  2. Vres thn Hmeromhnia  ths teleytaias hmera tou trexontos y hmerou
51580>>>>>>>>>>>        Move dStartDate to dHmniaParalabhs
51581>>>>>>>>>>>        If (iMeresXaritos<>0) Begin
51583>>>>>>>>>>>            While (dHmniaParalabhs<dHmniaTimologiou)
51587>>>>>>>>>>>                Add iMeresXaritos   to dHmniaParalabhs
51588>>>>>>>>>>>            Loop
51589>>>>>>>>>>>>
51589>>>>>>>>>>>        End
51589>>>>>>>>>>>>
51589>>>>>>>>>>>        Move dHmniaParalabhs    to dHmniaPlhromhs
51590>>>>>>>>>>>
51590>>>>>>>>>>>        Add (iMeresParalabhs-1) to dHmniaParalabhs
51591>>>>>>>>>>>        Add (iMeresPlhroteo-1)  to dHmniaPlhromhs
51592>>>>>>>>>>>
51592>>>>>>>>>>>        // Ypologise prota to poso bash posostou se sxesh me synolo parastatikou
51592>>>>>>>>>>>        Move (Round_number((nSynolo*nPososto/100),2))   to naxia
51593>>>>>>>>>>>
51593>>>>>>>>>>>        Set Field_Changed_Value Field TParticl.Poso     to naxia
51594>>>>>>>>>>>        Set Field_Changed_Value Field TParticl.Paralabh to dHmniaParalabhs
51595>>>>>>>>>>>        Set Field_Changed_Value Field TParticl.Exoflhsh to dHmniaPlhromhs
51596>>>>>>>>>>>
51596>>>>>>>>>>>    End_Procedure
51597>>>>>>>>>>>
51597>>>>>>>>>>>
51597>>>>>>>>>>>    Procedure Creating
51598>>>>>>>>>>>        Forward Send Creating
51600>>>>>>>>>>>        // Insert Code Here
51600>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Tparticl.Tparticl_Rec0))))));                                    to Tparticl.Tparticl_Recr
51601>>>>>>>>>>>    End_Procedure   // Creating
51602>>>>>>>>>>>
51602>>>>>>>>>>>
51602>>>>>>>>>>>    Procedure Save_Main_File
51603>>>>>>>>>>>        If (tparticl.isok <> '1') move ' ' to tparticl.isok
51606>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
51608>>>>>>>>>>>            If tparticl.Recnum Eq 0 Procedure_Return
51611>>>>>>>>>>>        End
51611>>>>>>>>>>>>
51611>>>>>>>>>>>      Forward Send Save_Main_File
51613>>>>>>>>>>>    End_Procedure   // Save_Main_File
51614>>>>>>>>>>>
51614>>>>>>>>>>>
51614>>>>>>>>>>>    // Define_Fields:
51614>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
51614>>>>>>>>>>>
51614>>>>>>>>>>>    Procedure Define_Fields
51615>>>>>>>>>>>        Forward Send Define_Fields
51617>>>>>>>>>>>        //DDB-Generated-Code-Location
51617>>>>>>>>>>>        //DDB-DefineFieldStart
51617>>>>>>>>>>>
51617>>>>>>>>>>>        Set Main_File            To Tparticl.File_Number
51618>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
51619>>>>>>>>>>>
51619>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
51620>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
51621>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51622>>>>>>>>>>>
51622>>>>>>>>>>>        // Parent (Server) file structure...............
51622>>>>>>>>>>>        Send Add_Server_File  Particle.File_Number
51623>>>>>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
51624>>>>>>>>>>>
51624>>>>>>>>>>>        // External (System) file structure.............
51624>>>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
51625>>>>>>>>>>>
51625>>>>>>>>>>>        Define_Auto_Increment  Sysrecc.Tparticl_Rec0  To Tparticl.Tparticl_Rec0
51628>>>>>>>>>>>
51628>>>>>>>>>>>        // Field-based properties.......................
51628>>>>>>>>>>>
51628>>>>>>>>>>>        // Tparticl.Partl_Recr
51628>>>>>>>>>>>
51628>>>>>>>>>>>        // Tparticl.Baxiokat_Code
51628>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Baxiokat_Code To Calc_All_The_Fields
51629>>>>>>>>>>>
51629>>>>>>>>>>>        // Tparticl.Pct_Epi_Synolou
51629>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Pct_Epi_Synolou To Calc_All_The_Fields
51630>>>>>>>>>>>
51630>>>>>>>>>>>        // Tparticl.Paralabh_Meres
51630>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Paralabh_Meres To Calc_All_The_Fields
51631>>>>>>>>>>>
51631>>>>>>>>>>>        // Tparticl.Xarhtos_Meres
51631>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Xarhtos_Meres To Calc_All_The_Fields
51632>>>>>>>>>>>
51632>>>>>>>>>>>        // Tparticl.Plhroteo_Meres
51632>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Plhroteo_Meres To Calc_All_The_Fields
51633>>>>>>>>>>>
51633>>>>>>>>>>>        // Tparticl.Tparticl_Rec0
51633>>>>>>>>>>>
51633>>>>>>>>>>>        // Tparticl.Tparticl_Recr
51633>>>>>>>>>>>
51633>>>>>>>>>>>        // Tparticl.Mera_Tou_Mhna
51633>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Mera_Tou_Mhna To Calc_All_The_Fields
51634>>>>>>>>>>>        Set Field_Value_Table      Field Tparticl.Mera_Tou_Mhna To (Mera_Tou_Mhna_VT(Self))
51635>>>>>>>>>>>
51635>>>>>>>>>>>        // Tparticl.Poso
51635>>>>>>>>>>>
51635>>>>>>>>>>>        // Tparticl.Paralabh
51635>>>>>>>>>>>
51635>>>>>>>>>>>        // Tparticl.Exoflhsh
51635>>>>>>>>>>>
51635>>>>>>>>>>>        // Tparticl.Isok
51635>>>>>>>>>>>
51635>>>>>>>>>>>        //DDB-DefineFieldEnd
51635>>>>>>>>>>>    End_Procedure    // Define_Fields
51636>>>>>>>>>>>
51636>>>>>>>>>>>    // Field_Defaults:
51636>>>>>>>>>>>    // This procedure is used to establish default field values.
51636>>>>>>>>>>>
51636>>>>>>>>>>>    Procedure Field_Defaults
51637>>>>>>>>>>>        Forward Send Field_Defaults
51639>>>>>>>>>>>        //DDB-Generated-Code-Location
51639>>>>>>>>>>>        //DDB-FieldDefaultStart
51639>>>>>>>>>>>        //DDB-FieldDefaultEnd
51639>>>>>>>>>>>    End_Procedure    // Field_Defaults
51640>>>>>>>>>>>
51640>>>>>>>>>>>End_Class    // Tparticl_DataDictionary
51641>>>>>>>>>>>//DDB-FileEnd
51641>>>>>>>>>    Use PARTLFPA.DD
INCLUDING FILE: PARTLFPA.DD
51641>>>>>>>>>>>//DDB-FileStart
51641>>>>>>>>>>>//DDB-HeaderStart
51641>>>>>>>>>>>
51641>>>>>>>>>>>// File Name : PARTLFPA.DD
51641>>>>>>>>>>>// Class Name: Partlfpa_DataDictionary
51641>>>>>>>>>>>// Revision  : 7
51641>>>>>>>>>>>// Version   : 2
51641>>>>>>>>>>>
51641>>>>>>>>>>>Use  Windows           // Basic Definitions
51641>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
51641>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51641>>>>>>>>>>>
51641>>>>>>>>>>>Open Partlfpa
51643>>>>>>>>>>>Open Particle
51645>>>>>>>>>>>Open Fpa
51647>>>>>>>>>>>
51647>>>>>>>>>>>//DDB-HeaderEnd
51647>>>>>>>>>>> 
51647>>>>>>>>>>>Class Partlfpa_DataDictionary  is a DataDictionary_Sec
51648>>>>>>>>>>>
51648>>>>>>>>>>>
51648>>>>>>>>>>>    // Define_Fields:
51648>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
51648>>>>>>>>>>>
51648>>>>>>>>>>>    Procedure Define_Fields
51649>>>>>>>>>>>        Forward Send Define_Fields
51651>>>>>>>>>>>        //DDB-Generated-Code-Location
51651>>>>>>>>>>>        //DDB-DefineFieldStart
51651>>>>>>>>>>>
51651>>>>>>>>>>>        Set Main_File            To Partlfpa.File_Number
51652>>>>>>>>>>>
51652>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
51653>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
51654>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51655>>>>>>>>>>>
51655>>>>>>>>>>>        // Parent (Server) file structure...............
51655>>>>>>>>>>>        Send Add_Server_File  Particle.File_Number
51656>>>>>>>>>>>        Send Add_Server_File  Fpa.File_Number
51657>>>>>>>>>>>
51657>>>>>>>>>>>        // Field-based properties.......................
51657>>>>>>>>>>>
51657>>>>>>>>>>>        // Partlfpa.Partl_Recr
51657>>>>>>>>>>>
51657>>>>>>>>>>>        // Partlfpa.Fpa_Pososto
51657>>>>>>>>>>>
51657>>>>>>>>>>>        // Partlfpa.Partlfpa_Poso
51657>>>>>>>>>>>
51657>>>>>>>>>>>        // Partlfpa.Poso_Pro_Ekpt
51657>>>>>>>>>>>
51657>>>>>>>>>>>        // Partlfpa.Poso_Ekpt
51657>>>>>>>>>>>
51657>>>>>>>>>>>        // Partlfpa.Poso_Pro_Fpa
51657>>>>>>>>>>>
51657>>>>>>>>>>>        // Partlfpa.Poso_Fpa
51657>>>>>>>>>>>
51657>>>>>>>>>>>        // Partlfpa.Poso_Me_Fpa
51657>>>>>>>>>>>
51657>>>>>>>>>>>        //DDB-DefineFieldEnd
51657>>>>>>>>>>>    End_Procedure    // Define_Fields
51658>>>>>>>>>>>
51658>>>>>>>>>>>    // Field_Defaults:
51658>>>>>>>>>>>    // This procedure is used to establish default field values.
51658>>>>>>>>>>>
51658>>>>>>>>>>>    Procedure Field_Defaults
51659>>>>>>>>>>>        Forward Send Field_Defaults
51661>>>>>>>>>>>        //DDB-Generated-Code-Location
51661>>>>>>>>>>>        //DDB-FieldDefaultStart
51661>>>>>>>>>>>        //DDB-FieldDefaultEnd
51661>>>>>>>>>>>    End_Procedure    // Field_Defaults
51662>>>>>>>>>>>
51662>>>>>>>>>>>End_Class    // Partlfpa_DataDictionary
51663>>>>>>>>>>>//DDB-FileEnd
51663>>>>>>>>>
51663>>>>>>>>>    //AB-StoreTopEnd
51663>>>>>>>>>
51663>>>>>>>>>    //AB-IgnoreStart
51663>>>>>>>>>
51663>>>>>>>>>    Use Bproces.Sub
51663>>>>>>>>>
51663>>>>>>>>>
51663>>>>>>>>>    //AB-IgnoreEnd
51663>>>>>>>>>
51663>>>>>>>>>    Object Psx_Array is a BusinessProcessSub
51665>>>>>>>>>
51665>>>>>>>>>        //AB-StoreTopStart
51665>>>>>>>>>
51665>>>>>>>>>        Property    String  psParticleRecr0 Public ''
51667>>>>>>>>>        Property    String  psPsxetikaRecr0 Public ''
51669>>>>>>>>>        Property    String  psClient_Desc   Public ''
51671>>>>>>>>>        Property    String  psPtyppar_Desc  Public ''
51673>>>>>>>>>        Property    String  psSeira_Seira   Public ''
51675>>>>>>>>>        Property    Date    pdPartl_Hmnia   Public ''
51677>>>>>>>>>        Property    Integer piPartl_No      Public  0
51679>>>>>>>>>        Property    Number  pnPosothta      Public  0
51681>>>>>>>>>
51681>>>>>>>>>        Object Ctypkin_DD2 is a Ctypkin_DataDictionary
51683>>>>>>>>>        End_Object    // Ctypkin_DD2
51684>>>>>>>>>
51684>>>>>>>>>        Object Wtypkin_DD2 is a Wtypkin_DataDictionary
51686>>>>>>>>>        End_Object    // Wtypkin_DD2
51687>>>>>>>>>
51687>>>>>>>>>        Object Ptyppar_DD2 is a Ptyppar_DataDictionary
51689>>>>>>>>>            Set DDO_Server to (Ctypkin_DD2(self))
51690>>>>>>>>>            Set DDO_Server to (Wtypkin_DD2(self))
51691>>>>>>>>>        End_Object    // Ptyppar_DD2
51692>>>>>>>>>
51692>>>>>>>>>        Object Country_DD2 is a Country_DataDictionary
51694>>>>>>>>>        End_Object    // Country_DD2
51695>>>>>>>>>
51695>>>>>>>>>        Object Towns_DD2 is a Towns_DataDictionary
51697>>>>>>>>>            Set DDO_Server to (Country_DD2(self))
51698>>>>>>>>>        End_Object    // Towns_DD2
51699>>>>>>>>>
51699>>>>>>>>>        Object Cities_DD2 is a Cities_DataDictionary
51701>>>>>>>>>            Set DDO_Server to (Towns_DD2(self))
51702>>>>>>>>>        End_Object    // Cities_DD2
51703>>>>>>>>>
51703>>>>>>>>>        Object Areas_DD2 is a Areas_DataDictionary
51705>>>>>>>>>        End_Object    // Areas_DD2
51706>>>>>>>>>
51706>>>>>>>>>        Object Payresp_DD2 is a Payresp_DataDictionary
51708>>>>>>>>>        End_Object    // Payresp_DD2
51709>>>>>>>>>
51709>>>>>>>>>        Object Clients_DD2 is a Clients_DataDictionary
51711>>>>>>>>>            Set DDO_Server to (Cities_DD2(self))
51712>>>>>>>>>            Set DDO_Server to (Areas_DD2(self))
51713>>>>>>>>>            Set DDO_Server to (Payresp_DD2(self))
51714>>>>>>>>>        End_Object    // Clients_DD2
51715>>>>>>>>>
51715>>>>>>>>>        Object Nomisma_DD2 is a Nomisma_DataDictionary
51717>>>>>>>>>        End_Object    // Nomisma_DD2
51718>>>>>>>>>
51718>>>>>>>>>        Object Particle_DD2 is a Particle_DataDictionary
51720>>>>>>>>>            Set DDO_Server to (Clients_DD2(self))
51721>>>>>>>>>            Set DDO_Server to (Ptyppar_DD2(self))
51722>>>>>>>>>            Set DDO_Server to (Nomisma_DD2(self))
51723>>>>>>>>>        End_Object    // Particle_DD2
51724>>>>>>>>>
51724>>>>>>>>>
51724>>>>>>>>>        /////////////////////////////////////////////
51724>>>>>>>>>
51724>>>>>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
51726>>>>>>>>>        End_Object    // Ctypkin_DD
51727>>>>>>>>>
51727>>>>>>>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
51729>>>>>>>>>        End_Object    // Wtypkin_DD
51730>>>>>>>>>
51730>>>>>>>>>        Object Ptyppar_DD is a Ptyppar_DataDictionary
51732>>>>>>>>>            Set DDO_Server to (Ctypkin_DD(self))
51733>>>>>>>>>            Set DDO_Server to (Wtypkin_DD(self))
51734>>>>>>>>>        End_Object    // Ptyppar_DD
51735>>>>>>>>>
51735>>>>>>>>>        Object Country_DD is a Country_DataDictionary
51737>>>>>>>>>        End_Object    // Country_DD
51738>>>>>>>>>
51738>>>>>>>>>        Object Towns_DD is a Towns_DataDictionary
51740>>>>>>>>>            Set DDO_Server to (Country_DD(self))
51741>>>>>>>>>        End_Object    // Towns_DD
51742>>>>>>>>>
51742>>>>>>>>>        Object Cities_DD is a Cities_DataDictionary
51744>>>>>>>>>            Set DDO_Server to (Towns_DD(self))
51745>>>>>>>>>        End_Object    // Cities_DD
51746>>>>>>>>>
51746>>>>>>>>>        Object Areas_DD is a Areas_DataDictionary
51748>>>>>>>>>        End_Object    // Areas_DD
51749>>>>>>>>>
51749>>>>>>>>>        Object Payresp_DD is a Payresp_DataDictionary
51751>>>>>>>>>        End_Object    // Payresp_DD
51752>>>>>>>>>
51752>>>>>>>>>        Object Clients_DD is a Clients_DataDictionary
51754>>>>>>>>>            Set DDO_Server to (Cities_DD(self))
51755>>>>>>>>>            Set DDO_Server to (Areas_DD(self))
51756>>>>>>>>>            Set DDO_Server to (Payresp_DD(self))
51757>>>>>>>>>        End_Object    // Clients_DD
51758>>>>>>>>>
51758>>>>>>>>>        Object Nomisma_DD is a Nomisma_DataDictionary
51760>>>>>>>>>        End_Object    // Nomisma_DD
51761>>>>>>>>>
51761>>>>>>>>>        Object Particle_DD is a Particle_DataDictionary
51763>>>>>>>>>            Set DDO_Server to (Clients_DD(self))
51764>>>>>>>>>            Set DDO_Server to (Ptyppar_DD(self))
51765>>>>>>>>>            Set DDO_Server to (Nomisma_DD(self))
51766>>>>>>>>>        End_Object    // Particle_DD
51767>>>>>>>>>
51767>>>>>>>>>        Object Psxetika_DD is a Psxetika_DataDictionary
51769>>>>>>>>>            Set DDO_Server      to (Particle_DD(self))
51770>>>>>>>>>            Set Constrain_File  to Particle.File_Number
51771>>>>>>>>>        End_Object
51772>>>>>>>>>
51772>>>>>>>>>
51772>>>>>>>>>        //AB-StoreTopEnd
51772>>>>>>>>>
51772>>>>>>>>>        Set Size to 60 100
51773>>>>>>>>>
51773>>>>>>>>>        //AB-DDOStart
51773>>>>>>>>>
51773>>>>>>>>>
51773>>>>>>>>>        //AB-DDOEnd
51773>>>>>>>>>
51773>>>>>>>>>
51773>>>>>>>>>        //AB-StoreStart
51773>>>>>>>>>
51773>>>>>>>>>        Procedure Find_Sxetika_Data String asParentRecr
51775>>>>>>>>>            String  sClient_Desc sPtyppar_Desc sPseira_Seira
51776>>>>>>>>>            Date    dPartl_Hmnia
51776>>>>>>>>>            Integer iPartl_No
51776>>>>>>>>>
51776>>>>>>>>>            Send Clear          to Particle_DD2
51777>>>>>>>>>            Move asParentRecr   to Particle.Partl_Recr
51778>>>>>>>>>            Send Find           to Particle_DD2 Eq 2
51779>>>>>>>>>
51779>>>>>>>>>            Get Field_Current_Value Of Clients_DD2  Field Clients.Client_Name   to sClient_Desc
51780>>>>>>>>>            Get Field_Current_Value Of Ptyppar_DD2  Field Ptyppar.Ptyppar_Descr to sPtyppar_Desc
51781>>>>>>>>>            Get Field_Current_Value Of Particle_DD2 Field Particle.Pseira_Seira to sPseira_Seira
51782>>>>>>>>>            Get Field_Current_Value Of Particle_DD2 Field Particle.Partl_Hmnia  to dPartl_Hmnia
51783>>>>>>>>>            Get Field_Current_Value Of Particle_DD2 Field Particle.Partl_No     to iPartl_No
51784>>>>>>>>>
51784>>>>>>>>>            Set psPtyppar_Desc      to sPtyppar_Desc
51785>>>>>>>>>            Set psClient_Desc       to sClient_Desc
51786>>>>>>>>>            Set psSeira_Seira       to sPseira_Seira
51787>>>>>>>>>            Set pdPartl_Hmnia       to dPartl_Hmnia
51788>>>>>>>>>            Set piPartl_No          to iPartl_No
51789>>>>>>>>>        End_Procedure
51790>>>>>>>>>
51790>>>>>>>>>
51790>>>>>>>>>        Procedure Make_The_Record
51792>>>>>>>>>
51792>>>>>>>>>            Set psPtyppar_Desc      to ''
51793>>>>>>>>>            Set psClient_Desc       to ''
51794>>>>>>>>>            Set psSeira_Seira       to ''
51795>>>>>>>>>            Set pdPartl_Hmnia       to ''
51796>>>>>>>>>            Set piPartl_No          to 0
51797>>>>>>>>>
51797>>>>>>>>>            Clear Psxetika
51798>>>>>>>>>            Move (psParticleRecr0(Self)) to Psxetika.Partl_Recr
51799>>>>>>>>>            Move (psPsxetikaRecr0(Self)) to Psxetika.Psx_Partl_Recr
51800>>>>>>>>>            Find Eq Psxetika by index.4
51801>>>>>>>>>>
51801>>>>>>>>>
51801>>>>>>>>>            If (Not(Found)) Begin
51803>>>>>>>>>
51803>>>>>>>>>                Send Find_Sxetika_Data (psPsxetikaRecr0(Self))
51804>>>>>>>>>
51804>>>>>>>>>                Send Clear to Particle_DD
51805>>>>>>>>>                Send Clear to Psxetika_DD
51806>>>>>>>>>
51806>>>>>>>>>                // Vres ton mpampa
51806>>>>>>>>>                Move (psParticleRecr0(Self)) to Particle.Partl_Recr
51807>>>>>>>>>                Send Find to Particle_DD Eq 2
51808>>>>>>>>>
51808>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Psx_Partl_Recr    ;                                                to (psPsxetikaRecr0(Self))
51809>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Client_Desc    ;                                                to (psClient_Desc(Self))
51810>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Ptyppar_Desc   ;                                                to (psPtyppar_Desc(Self))
51811>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_Hmnia    ;                                                to (pdPartl_Hmnia(Self))
51812>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_No       ;                                                to (piPartl_No(Self))
51813>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.SX_Pseira_Seira   ;                                                to (psSeira_Seira(Self))
51814>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Pms_Sx_Qty        ;                                                to (pnPosothta(Self))
51815>>>>>>>>>
51815>>>>>>>>>                Send Request_Save               to Psxetika_DD
51816>>>>>>>>>
51816>>>>>>>>>
51816>>>>>>>>>                // Make also 2nd Record
51816>>>>>>>>>                Clear Psxetika
51817>>>>>>>>>                Move (psPsxetikaRecr0(Self)) to Psxetika.Partl_Recr
51818>>>>>>>>>                Move (psParticleRecr0(Self)) to Psxetika.Psx_Partl_Recr
51819>>>>>>>>>                Find Eq Psxetika by index.4
51820>>>>>>>>>>
51820>>>>>>>>>
51820>>>>>>>>>                If (Not(Found)) Begin
51822>>>>>>>>>
51822>>>>>>>>>                    Send Find_Sxetika_Data (psParticleRecr0(Self))
51823>>>>>>>>>
51823>>>>>>>>>                    Send Clear to Particle_DD
51824>>>>>>>>>                    Send Clear to Psxetika_DD
51825>>>>>>>>>
51825>>>>>>>>>                    Move (psPsxetikaRecr0(Self)) to Particle.Partl_Recr
51826>>>>>>>>>                    Send Find to Particle_DD Eq 2
51827>>>>>>>>>
51827>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Psx_Partl_Recr    ;                                                    to (psParticleRecr0(Self))
51828>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Client_Desc    ;                                                    to (psClient_Desc(Self))
51829>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Ptyppar_Desc   ;                                                    to (psPtyppar_Desc(Self))
51830>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_Hmnia    ;                                                    to (pdPartl_Hmnia(Self))
51831>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_No       ;                                                    to (piPartl_No(Self))
51832>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.SX_Pseira_Seira   ;                                                    to (psSeira_Seira(Self))
51833>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Pms_Sx_Qty        ;                                                    to (pnPosothta(Self))
51834>>>>>>>>>                    Send Request_Save               to Psxetika_DD
51835>>>>>>>>>                End
51835>>>>>>>>>>
51835>>>>>>>>>            End
51835>>>>>>>>>>
51835>>>>>>>>>        End_Procedure
51836>>>>>>>>>
51836>>>>>>>>>        //AB-StoreEnd
51836>>>>>>>>>
51836>>>>>>>>>    End_Object    // Psx_Array
51837>>>>>>>>>
51837>>>>>>>>>
51837>>>>>>>>>    //AB-StoreStart
51837>>>>>>>>>
51837>>>>>>>>>    //AB-StoreEnd
51837>>>>>>>>>
51837>>>>>>>>>//AB/     End_Object    // prj
51837>>>>>>>//Use bpMakeSx.dg
51837>>>>>>>
51837>>>>>>>Class PmsSxet_DataDictionary  is a DataDictionary_Sec
51838>>>>>>>
51838>>>>>>>    Procedure Construct_Object
51839>>>>>>>        Forward Send Construct_Object
51841>>>>>>>        Property Integer piFromCreate   Public 0
51842>>>>>>>    End_Procedure
51843>>>>>>>
51843>>>>>>>    Procedure Creating
51844>>>>>>>        Forward Send Creating
51846>>>>>>>        Set piFromCreate to 1
51847>>>>>>>    End_Procedure
51848>>>>>>>
51848>>>>>>>    Procedure Update
51849>>>>>>>        String  sRecr1 sRecr2 sPmsSxet
51850>>>>>>>        Number  nQty
51850>>>>>>>        Integer iLathos iCurrentPmoves iAkyro iCurrentPmsSxet iCurrentPartl
51850>>>>>>>
51850>>>>>>>        Forward Send Update
51852>>>>>>>
51852>>>>>>>        Move (Trim(Particle.Partl_LastNo)='1')  to iAkyro
51853>>>>>>>        Move Particle.Partl_Recr                to sRecr1
51854>>>>>>>        Move Pmoves.Recnum                      to iCurrentPmoves
51855>>>>>>>        Move PmsSxet.Recnum                     to iCurrentPmsSxet
51856>>>>>>>        Move PmsSxet.Arx_Partl_Recr             to sRecr2
51857>>>>>>>        Move PmsSxet.Posothta                   to nQty
51858>>>>>>>        Move Particle.Recnum                    to iCurrentPartl
51859>>>>>>>
51859>>>>>>>
51859>>>>>>>        If (piFromCreate(Self)<>1) Begin
51861>>>>>>>            Add nQty to Pmoves.Pms_Qty
51862>>>>>>>            Saverecord Pmoves
51863>>>>>>>
51863>>>>>>>            Set pnQty               Of bpEnYpol to nQty
51864>>>>>>>            Set psRecr              Of bpEnYpol to PmsSxet.Sxetiko_Recr
51865>>>>>>>            Set piFromAkyrosh       Of bpEnYpol to (iAkyro=1)
51866>>>>>>>            Set piCurrentPartl      Of bpEnYpol to iCurrentPartl
51867>>>>>>>            Set piCurrentPmoves     Of bpEnYpol to iCurrentPmoves
51868>>>>>>>            Set piCurrentPmsSxet    Of bpEnYpol to iCurrentPmsSxet
51869>>>>>>>            Send DoProcess          to bpEnYpol
51870>>>>>>>
51870>>>>>>>            Get piLathos            Of bpEnYpol to iLathos
51871>>>>>>>
51871>>>>>>>                 If (iLathos=40000) Error 8000 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
51874>>>>>>>            Else If (iLathos=40001) Error 8001 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
51878>>>>>>>            Else If (iLathos=40002) Error 8002 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
51882>>>>>>>            Else If (iLathos=40003) Error 8003 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
51886>>>>>>>            Else If (iLathos=40004) Error 8004 '’¦ §¨à«˜¨® ¡æ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
51890>>>>>>>            Else If (iLathos=40005) Error 8005 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
51894>>>>>>>            Else If (iLathos=40006) Error 8006 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
51898>>>>>>>
51898>>>>>>>        End
51898>>>>>>>>
51898>>>>>>>
51898>>>>>>>        // Epanafora posothtas giati afou trexei h backout me timh px 3 eno h update exei timh 4
51898>>>>>>>        // sthn epanatopothethsh ths bpenypol xanavriskei to current pmssxet record
51898>>>>>>>        // kai xanei thn posothta thn kainourgia opote epanerxetai me thn posothta ths
51898>>>>>>>        // backout pou einai 3.
51898>>>>>>>        Move nQty to PmsSxet.Posothta
51899>>>>>>>
51899>>>>>>>
51899>>>>>>>        Clear Psxetika
51900>>>>>>>        Move sRecr1 to Psxetika.Partl_Recr
51901>>>>>>>        Move sRecr2 to Psxetika.Psx_Partl_Recr
51902>>>>>>>        Find Eq Psxetika by index.4
51903>>>>>>>>
51903>>>>>>>        If (Found) Begin
51905>>>>>>>            Add nQty to Psxetika.Pms_Sx_Qty
51906>>>>>>>            Saverecord Psxetika
51907>>>>>>>        End
51907>>>>>>>>
51907>>>>>>>
51907>>>>>>>        Clear Psxetika
51908>>>>>>>        Move sRecr2 to Psxetika.Partl_Recr
51909>>>>>>>        Move sRecr1 to Psxetika.Psx_Partl_Recr
51910>>>>>>>        Find Eq Psxetika by index.4
51911>>>>>>>>
51911>>>>>>>        If (Found) Begin
51913>>>>>>>            Add nQty to Psxetika.Pms_Sx_Qty
51914>>>>>>>            Saverecord Psxetika
51915>>>>>>>        End
51915>>>>>>>>
51915>>>>>>>    End_Procedure
51916>>>>>>>
51916>>>>>>>    Procedure Backout
51917>>>>>>>        String  sRecr1 sRecr2 sPmsSxet
51918>>>>>>>        Number  nQty
51918>>>>>>>        Integer iLathos iCurrentPmoves iAkyro iCurrentPmsSxet iCurrentPartl
51918>>>>>>>
51918>>>>>>>        Move (Trim(Particle.Partl_LastNo)='1')  to iAkyro
51919>>>>>>>        Move Particle.Partl_Recr                to sRecr1
51920>>>>>>>        Move Pmoves.Recnum                      to iCurrentPmoves
51921>>>>>>>        Move PmsSxet.Recnum                     to iCurrentPmsSxet
51922>>>>>>>        Move PmsSxet.Arx_Partl_Recr             to sRecr2
51923>>>>>>>        Move PmsSxet.Posothta                   to nQty
51924>>>>>>>        Move Particle.Recnum                    to iCurrentPartl
51925>>>>>>>
51925>>>>>>>        Forward Send Backout
51927>>>>>>>
51927>>>>>>>        Set pnQty               Of bpEnYpol to (nQty*(-1))
51928>>>>>>>        Set psRecr              Of bpEnYpol to PmsSxet.Sxetiko_Recr
51929>>>>>>>        Set piFromAkyrosh       Of bpEnYpol to (iAkyro=1)
51930>>>>>>>        Set piCurrentPartl      Of bpEnYpol to iCurrentPartl
51931>>>>>>>        Set piCurrentPmoves     Of bpEnYpol to iCurrentPmoves
51932>>>>>>>        Set piCurrentPmsSxet    Of bpEnYpol to iCurrentPmsSxet
51933>>>>>>>        Send DoProcess          to bpEnYpol
51934>>>>>>>
51934>>>>>>>        Get piLathos            Of bpEnYpol to iLathos
51935>>>>>>>
51935>>>>>>>             If (iLathos=40000) Error 8000 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nBackout PmsSxet'
51938>>>>>>>        Else If (iLathos=40001) Error 8001 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nBackout PmsSxet'
51942>>>>>>>        Else If (iLathos=40002) Error 8002 'ƒœ¤ ™¨âŸž¡œ Particle\nBackout PmsSxet'
51946>>>>>>>        Else If (iLathos=40003) Error 8003 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nBackout PmsSxet'
51950>>>>>>>        Else If (iLathos=40004) Error 8004 '’¦ §¨à«˜¨® ¡æ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nBackout PmsSxet'
51954>>>>>>>        Else If (iLathos=40005) Error 8005 'ƒœ¤ ™¨âŸž¡œ Particle\nBackout PmsSxet'
51958>>>>>>>        Else If (iLathos=40006) Error 8006 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  > ˜¨® ¡ã §¦©æ«ž«˜.\nBackout PmsSxet'
51962>>>>>>>        Else If (iLathos=40007) Error 8007 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nBackout PmsSxet'
51966>>>>>>>
51966>>>>>>>        Clear Psxetika
51967>>>>>>>        Move sRecr1 to Psxetika.Partl_Recr
51968>>>>>>>        Move sRecr2 to Psxetika.Psx_Partl_Recr
51969>>>>>>>        Find Eq Psxetika by index.4
51970>>>>>>>>
51970>>>>>>>        If (Found) Begin
51972>>>>>>>            Sub nQty from Psxetika.Pms_Sx_Qty
51973>>>>>>>            Saverecord Psxetika
51974>>>>>>>        End
51974>>>>>>>>
51974>>>>>>>
51974>>>>>>>        Clear Psxetika
51975>>>>>>>        Move sRecr2 to Psxetika.Partl_Recr
51976>>>>>>>        Move sRecr1 to Psxetika.Psx_Partl_Recr
51977>>>>>>>        Find Eq Psxetika by index.4
51978>>>>>>>>
51978>>>>>>>        If (Found) Begin
51980>>>>>>>            Sub nQty from Psxetika.Pms_Sx_Qty
51981>>>>>>>            Saverecord Psxetika
51982>>>>>>>        End
51982>>>>>>>>
51982>>>>>>>    End_Procedure
51983>>>>>>>
51983>>>>>>>    Procedure Request_Save
51984>>>>>>>        Integer iInt iLathos iMustDelete iCurrentPmoves iAkyro iCurrentPmsSxet iCurrentPartl
51985>>>>>>>        String  sParticleRecr sPmsSxetRecr sPmovesRecr sArxPartlRecr sRecr1 sRecr2 sPmsSxet
51985>>>>>>>        Number  nQty
51985>>>>>>>
51985>>>>>>>        Set piFromCreate to 0
51986>>>>>>>
51986>>>>>>>        Forward Send Request_Save
51988>>>>>>>
51988>>>>>>>        If (piFromCreate(Self)=1) Begin
51990>>>>>>>            Set piFromCreate                                                to 0
51991>>>>>>>
51991>>>>>>>            Get File_Field_Current_Value File_Field Particle.Recnum         to iCurrentPartl
51992>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_Recr     to sParticleRecr
51993>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Pms_Recr         to sPmovesRecr
51994>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Recnum           to iCurrentPmoves
51995>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Recnum          to iCurrentPmsSxet
51996>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Sxetiko_Recr    to sPmsSxetRecr
51997>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Arx_Partl_Recr  to sArxPartlRecr
51998>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Posothta        to nQty
51999>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_LastNo   to iAkyro
52000>>>>>>>            Move (iAkyro=1)                                                 to iAkyro
52001>>>>>>>
52001>>>>>>>            Set pnQty               Of bpEnYpol to nQty
52002>>>>>>>            Set psRecr              Of bpEnYpol to sPmsSxetRecr
52003>>>>>>>            Set piFromAkyrosh       Of bpEnYpol to (iAkyro=1)
52004>>>>>>>            Set piCurrentPartl      Of bpEnYpol to iCurrentPartl
52005>>>>>>>            Set piCurrentPmoves     Of bpEnYpol to iCurrentPmoves
52006>>>>>>>            Set piCurrentPmsSxet    Of bpEnYpol to iCurrentPmsSxet
52007>>>>>>>            Send DoProcess          to bpEnYpol
52008>>>>>>>            Get piLathos            Of bpEnYpol to iLathos
52009>>>>>>>
52009>>>>>>>                 If (iLathos=40000) Error 8000 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
52012>>>>>>>            Else If (iLathos=40001) Error 8001 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
52016>>>>>>>            Else If (iLathos=40002) Error 8002 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
52020>>>>>>>            Else If (iLathos=40003) Error 8003 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
52024>>>>>>>            Else If (iLathos=40004) Error 8004 '’¦ §¨à«˜¨® ¡æ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
52028>>>>>>>            Else If (iLathos=40005) Error 8005 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
52032>>>>>>>            Else If (iLathos=40006) Error 8006 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  > ˜¨® ¡ã §¦©æ«ž«˜.\nUpdate PmsSxet'
52036>>>>>>>            Else If (iLathos=40007) Error 8007 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
52040>>>>>>>
52040>>>>>>>            Set psParticleRecr0     Of Psx_Array to sParticleRecr
52041>>>>>>>            Set psPsxetikaRecr0     Of Psx_Array to sArxPartlRecr
52042>>>>>>>            Set pnPosothta          Of Psx_Array to nQty
52043>>>>>>>            Send Make_The_Record    Of Psx_Array
52044>>>>>>>
52044>>>>>>>            // Xana vres tis eggrafes
52044>>>>>>>            Clear Particle
52045>>>>>>>            Move sParticleRecr  to Particle.Partl_Recr
52046>>>>>>>            Find Eq Particle by index.2
52047>>>>>>>>
52047>>>>>>>
52047>>>>>>>            Clear Pmoves
52048>>>>>>>            Move sPmovesRecr    to Pmoves.Pms_Recr
52049>>>>>>>            Find Eq Pmoves by index.2
52050>>>>>>>>
52050>>>>>>>
52050>>>>>>>            Clear PmsSxet
52051>>>>>>>            Move sPmovesRecr    to PmsSxet.Pms_Recr
52052>>>>>>>            Move sPmsSxetRecr   to PmsSxet.Sxetiko_Recr
52053>>>>>>>            Find Eq PmsSxet by Index.1
52054>>>>>>>>
52054>>>>>>>
52054>>>>>>>        End
52054>>>>>>>>
52054>>>>>>>    End_Procedure
52055>>>>>>>
52055>>>>>>>
52055>>>>>>>    Procedure Define_Fields
52056>>>>>>>        Forward Send Define_Fields
52058>>>>>>>        //DDB-Generated-Code-Location
52058>>>>>>>        //DDB-DefineFieldStart
52058>>>>>>>
52058>>>>>>>        Set Main_File            To Pmssxet.File_Number
52059>>>>>>>
52059>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
52060>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
52061>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
52062>>>>>>>
52062>>>>>>>        // Parent (Server) file structure...............
52062>>>>>>>        Send Add_Server_File  Pmoves.File_Number
52063>>>>>>>
52063>>>>>>>        // External (System) file structure.............
52063>>>>>>>        Send Add_System_File  Psxetika.File_Number  DD_LOCK_ON_ALL
52064>>>>>>>        Send Add_System_File  Pmoves.File_Number  DD_LOCK_ON_ALL
52065>>>>>>>
52065>>>>>>>        // Field-based properties.......................
52065>>>>>>>
52065>>>>>>>        // Pmssxet.Pms_Recr
52065>>>>>>>
52065>>>>>>>        // Pmssxet.Sxetiko_Recr
52065>>>>>>>
52065>>>>>>>        // Pmssxet.Posothta
52065>>>>>>>
52065>>>>>>>        // Pmssxet.Arx_Partl_Recr
52065>>>>>>>
52065>>>>>>>        // Pmssxet.Sx_Parast
52065>>>>>>>
52065>>>>>>>        // Pmssxet.Sx_Hmnia
52065>>>>>>>
52065>>>>>>>        // Pmssxet.Sx_Foreas
52065>>>>>>>
52065>>>>>>>        // Pmssxet.Sx_Arithmos
52065>>>>>>>
52065>>>>>>>        // Pmssxet.Sx_Seira
52065>>>>>>>
52065>>>>>>>        // Pmssxet.Sx_Posothta
52065>>>>>>>
52065>>>>>>>        //DDB-DefineFieldEnd
52065>>>>>>>    End_Procedure    // Define_Fields
52066>>>>>>>
52066>>>>>>>    Procedure Field_Defaults
52067>>>>>>>        Forward Send Field_Defaults
52069>>>>>>>        //DDB-Generated-Code-Location
52069>>>>>>>        //DDB-FieldDefaultStart
52069>>>>>>>        //DDB-FieldDefaultEnd
52069>>>>>>>    End_Procedure    // Field_Defaults
52070>>>>>>>
52070>>>>>>>End_Class    // Pmssxet_DataDictionary
52071>>>>>>>//DDB-FileEnd
52071>>>>>
52071>>>>>Class Cmoves_DataDictionary  is a DataDictionary
52072>>>>>
52072>>>>>    Procedure Construct_Object
52073>>>>>        Forward Send Construct_Object
52075>>>>>        Property Integer piFromBP           Public 0
52076>>>>>        Property Integer piNotMoveSyscurXr  Public 0   
52077>>>>>        Property Integer piFromSysxet       Public 0   
52078>>>>>        Property Integer piFromxrhsh        Public 0  //œ¤›œ ¥ž ¦«  œ¨®œ«˜  ˜§¦ £œ«˜­¦¨á ¬§¦¢¦å§à¤
52079>>>>>    End_Procedure
52080>>>>>
52080>>>>>    Function Validate_Save  Returns Integer
52081>>>>>        Integer iReturnVal iOpen_Items iCheck ifromxrhsh iYes
52082>>>>>        String sModule
52082>>>>>        get pifromxrhsh to ifromxrhsh
52083>>>>>        Forward Get Validate_Save  To iReturnVal
52085>>>>>        If (Not(iReturnVal)) Begin
52087>>>>>            if (cmoves.cmoves_recr='')  Send Operation_Not_Allowed 3263
52090>>>>>            Clear Branch
52091>>>>>            Move SyscurXr.Company_Code  to Branch.Company_Code
52092>>>>>            Move SyscurXr.Branch_Code   to Branch.Branch_Code
52093>>>>>            Find Eq Branch By Index.1
52094>>>>>>
52094>>>>>            If (Not(Found)) Move 6666 to iReturnVal
52097>>>>>            Else If ((Branch.Locked_Until<>'') And (Cmoves.Cmoves_Hmnia<=Branch.Locked_Until)) Move 6667 to iReturnVal
52101>>>>>            
52101>>>>>            If (Cmoves.Axia_Ypol_Sysx<0) Begin
52103>>>>>                Move 10101 to iReturnVal
52104>>>>>            End
52104>>>>>>
52104>>>>>            Else Begin
52105>>>>>                
52105>>>>>                Move Ctypkin.Check_Overhead to iCheck
52106>>>>>                If (iCheck) Begin
52108>>>>>                    If ((Clients.Plafon>0) And (Clients.Overhead<0) And (Sysfile.Over_Overhead<>'1')) Begin
52110>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 3000 Cmoves' to iYes
52111>>>>>                        If (iYes=MBR_NO) Move 11170 to iReturnVal
52114>>>>>                    End
52114>>>>>>
52114>>>>>                    Else If ((PayResp.Plafon>0) And (PayResp.Overhead<0) And (Sysfile.Over_Overhead<>'1')) Begin
52117>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 3001 Cmoves' to iYes
52118>>>>>                        If (iYes=MBR_NO) Move 11171 to iReturnVal
52121>>>>>                    End
52121>>>>>>
52121>>>>>                End
52121>>>>>>
52121>>>>>                
52121>>>>>                If (iReturnVal) Send Operation_Not_Allowed iReturnVal
52124>>>>>                
52124>>>>>                If ((Cmoves.Prn_Theor='1') And (piFromBP(Self)<>1)) Move 22278 to iReturnVal
52127>>>>>                Else If ((Clients.Client_Locked='1') And (piFromBP(Self)<>1)) Move 11172 to iReturnVal
52131>>>>>                
52131>>>>>                // ˜¤ œ¨®œ«˜  ˜§¦ £œ«˜­¦¨á ¬§¦¢¦å§à¤ £ž¤ «¦¤ ¡¦™œ ª ã ˜§¦ open items (©¬©®œ« ©œ ª)
52131>>>>>                Else If ((Cmoves.Cmoves_Hmnia<syscurxr.Year_Xrhshfrom and ifromxrhsh<>1 And (piFromSysxet(Self)<>1)) Or ;                         (Cmoves.Cmoves_Hmnia>Syscurxr.Year_Xrhshto and ifromxrhsh<>1 And (piFromSysxet(Self)<>1))) Move 22277 to iReturnVal
52135>>>>>                Else Begin
52136>>>>>                    If (Cmoves.Module_From='') Move 22250 to iReturnVal
52139>>>>>                    Else Begin
52140>>>>>                        If (piFromBP(Self)<>1) Begin // €¤ ›œ¤ §¨¦œ¨®œ«˜  ˜§¦ « ª 2 Business Process
52142>>>>>                            If (Cmoves.Module_From<>gs_Module_Code) Move 22288 to iReturnVal
52145>>>>>                            Else If (Cmoves.Recnum<>0) Begin // €¤ ›œ¤ ¡˜¤œ  create ¤œ˜ œšš¨˜­ž
52148>>>>>                                If (Cmoves.Barticl_Recr<>'') Move 22284 to iReturnVal
52151>>>>>                                Else If (Cmoves.Partl_Recr  <>'') Begin
52154>>>>>                                    If (Cmoves.Module_From='01') Move 22283 to iReturnVal
52157>>>>>                                    Else If (Cmoves.Module_From='02') Move 22282 to iReturnVal
52161>>>>>                                End
52161>>>>>>
52161>>>>>                            End
52161>>>>>>
52161>>>>>                        End
52161>>>>>>
52161>>>>>                    End
52161>>>>>>
52161>>>>>                End
52161>>>>>>
52161>>>>>            End
52161>>>>>>
52161>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
52164>>>>>        End
52164>>>>>>
52164>>>>>        Function_Return iReturnVal
52165>>>>>    End_Function   // Validate_Save
52166>>>>>
52166>>>>>    Function Validate_Delete  Returns Integer
52167>>>>>        Integer iReturnVal
52168>>>>>        String sModule
52168>>>>>        Forward Get Validate_Delete  To iReturnVal
52170>>>>>        If (Not(iReturnVal)) Begin
52172>>>>>
52172>>>>>            Clear Branch
52173>>>>>            Move SyscurXr.Company_Code  to Branch.Company_Code
52174>>>>>            Move SyscurXr.Branch_Code   to Branch.Branch_Code
52175>>>>>            Find Eq Branch By Index.1
52176>>>>>>
52176>>>>>            If (Not(Found)) Move 6668 to iReturnVal
52179>>>>>            Else If ((Branch.Locked_Until<>'') And (Cmoves.Cmoves_Hmnia<=Branch.Locked_Until)) Move 6669 to iReturnVal
52183>>>>>            
52183>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
52186>>>>>            
52186>>>>>            If (Cmoves.Prn_Theor='1') Move 22279 to iReturnVal
52189>>>>>            Else If (piFromBP(Self)<>1) Begin
52192>>>>>                If (Cmoves.Module_From<>gs_Module_Code) Move 22289 to iReturnVal
52195>>>>>                Else Begin
52196>>>>>                    If (Cmoves.Barticl_Recr<>'') Move 22287 to iReturnVal
52199>>>>>                    Else If (Cmoves.Partl_Recr  <>'') Begin
52202>>>>>                        If (Cmoves.Module_From='01') Move 22286 to iReturnVal
52205>>>>>                        Else If (Cmoves.Module_From='02') Move 22285 to iReturnVal
52209>>>>>                    End
52209>>>>>>
52209>>>>>                End
52209>>>>>>
52209>>>>>            End
52209>>>>>>
52209>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
52212>>>>>        End
52212>>>>>>
52212>>>>>        Function_Return iReturnVal
52213>>>>>    End_Function   // Validate_Delete
52214>>>>>
52214>>>>>    Procedure Save_Main_File
52215>>>>>        If (Operation_Origin<>Self) Begin
52217>>>>>            If Cmoves.Recnum Eq 0 Procedure_Return
52220>>>>>        End
52220>>>>>>
52220>>>>>        If (Cmoves.Cn_Code<>'') Begin
52222>>>>>            Clear Cn
52223>>>>>            Move Cmoves.Cn_Code to Cn.Cn_Code
52224>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
52225>>>>>>
52225>>>>>            Move Cn.Cn_Sls_ID      to Cmoves.Sls_ID
52226>>>>>            Move cn.Mhxanik_id     to Cmoves.Mhxanik_Id
52227>>>>>            Move Cn.CN_Cnt_ID      to Cmoves.Cnt_ID
52228>>>>>            Move Cn.Cn_Recr        to Cmoves.Cn_Recr
52229>>>>>        End
52229>>>>>>
52229>>>>>        Else Begin
52230>>>>>            Move ''     to Cmoves.Sls_ID
52231>>>>>            Move ''     to Cmoves.Cnt_ID
52232>>>>>            Move ''     to Cmoves.Cn_Recr
52233>>>>>            Move ''     to Cmoves.Mhxanik_id
52234>>>>>        End
52234>>>>>>
52234>>>>>        Forward Send Save_Main_File
52236>>>>>    End_Procedure   // Save_Main_File
52237>>>>>
52237>>>>>
52237>>>>>    Procedure Update
52238>>>>>        String sNomisma
52239>>>>>        Forward Send Update
52241>>>>>        
52241>>>>>        If (piNotMoveSyscurXr(Self)=0) Begin
52243>>>>>            Move SysCurXR.Company_Code      to Cmoves.Company_Code
52244>>>>>            Move SysCurXR.Branch_Code       to Cmoves.Branch_Code
52245>>>>>        End
52245>>>>>>
52245>>>>>        
52245>>>>>        //˜¤ šå¤œ«˜  £œ«˜­¦¨á ¬§¦¢¦å§à¤
52245>>>>>        if (pifromxrhsh(self)=1)            Move (SysCurXR.Year_Year+1) to Cmoves.Year_Year
52248>>>>>        else If (piNotMoveSyscurXr(Self)=0) Move SysCurXR.Year_Year     to Cmoves.Year_Year
52252>>>>>        
52252>>>>>        //Move Custprom.Custprom_Code to Cmoves.Custprom_Code
52252>>>>>        Move Clients.Client_ID          to Cmoves.Client_ID
52253>>>>>        Move Clients.Client_Name        to Cmoves.Client_Name
52254>>>>>        Move Ctypkin.Ctypkin_Descr      to Cmoves.Ctypkin_Descr
52255>>>>>
52255>>>>>        // js 28/03/2002 Gia na mhn allazei sta Copen me to Ctypkin tou CmovesA
52255>>>>>        If (Cmoves.Ctypkin_Code='') ;            Move Ctypkin.Ctypkin_Code   to Cmoves.Ctypkin_Code
52258>>>>>
52258>>>>>
52258>>>>>        Move payresp.presp_ID           to Cmoves.Presp_ID
52259>>>>>
52259>>>>>        ///an enhmeronei synolikh ofeilh pelath
52259>>>>>        if (Cmoves.enhm_ofeilh='1') begin
52261>>>>>            Add (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) to Clients.Synolikh_ofeilh
52262>>>>>            Add (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) to Payresp.Synolikh_ofeilh
52263>>>>>        end
52263>>>>>>
52263>>>>>
52263>>>>>        If (Cmoves.Enhm_Ypol_Pel='1') Begin
52265>>>>>            If (Cmoves.Cmoves_x0<>0) Begin
52267>>>>>                Add Cmoves.Cmoves_x0 to Clients.Xreosh
52268>>>>>                Add Cmoves.Cmoves_x0 to PayResp.Xreosh
52269>>>>>            End
52269>>>>>>
52269>>>>>            Else If (Cmoves.Cmoves_p0<>0) Begin
52272>>>>>                Add Cmoves.Cmoves_p0 to Clients.Pistosh
52273>>>>>                Add Cmoves.Cmoves_p0 to PayResp.Pistosh
52274>>>>>            End
52274>>>>>>
52274>>>>>        End
52274>>>>>>
52274>>>>>        If (Cmoves.Enhm_Hmnies_Pel='1') Begin
52276>>>>>            If (Cmoves.Cmoves_x0<>0) Begin
52278>>>>>                Move Cmoves.Cmoves_Hmnia   to Clients.Last_Xreosh
52279>>>>>                Move Cmoves.Cmoves_Hmnia   to PayResp.Last_Xreosh
52280>>>>>            End
52280>>>>>>
52280>>>>>            Else If (Cmoves.Cmoves_p0<>0) Begin
52283>>>>>                Move Cmoves.Cmoves_Hmnia   to Clients.Last_Pistosh
52284>>>>>                Move Cmoves.Cmoves_Hmnia   to PayResp.Last_Pistosh
52285>>>>>            End
52285>>>>>>
52285>>>>>        End
52285>>>>>>
52285>>>>>
52285>>>>>             If ((Cmoves.Cmoves_M_Code='') And (Cmoves.Module_From  <>'')) Move Cmoves.Module_From     to Cmoves.Cmoves_M_Code
52288>>>>>        Else If ((Cmoves.Module_From  ='') And (Cmoves.Cmoves_M_Code<>'')) Move Cmoves.Cmoves_M_Code   to Cmoves.Module_From
52292>>>>>
52292>>>>>        If (Ctypkin.Open_Item='1') Move (Cmoves.Axia_Pros_Sysx-Cmoves.Axia_Sysxet) to Cmoves.Axia_Ypol_Sysx
52295>>>>>        Else Begin
52296>>>>>            Move 0 to Cmoves.Axia_Pros_Sysx
52297>>>>>            Move 0 to Cmoves.Axia_Sysxet
52298>>>>>            Move 0 to Cmoves.Axia_Ypol_Sysx
52299>>>>>        End
52299>>>>>>
52299>>>>>
52299>>>>>        // js 23/01/2002
52299>>>>>        // Enhmerosh Pediou Flag_Ypol to opoio antiprosopeyei
52299>>>>>        // to an h eggrafh exei diathesimo ypoloipo pros sysxetish
52299>>>>>        Move (Cmoves.Axia_Ypol_Sysx<>0) to Cmoves.Flag_Ypol
52300>>>>>
52300>>>>>        // js 23/01/2002
52300>>>>>        // Enhmerosh Pediou Flag_Open to opoio antiprosopeyei
52300>>>>>        // an einai xreosh=1, pistosh=2, arnhtikh xreosh=2 arnhtikh Pistosh=1
52300>>>>>        // gia na emfanizei ta antistrofa sto copen
52300>>>>>        If (Ctypkin.Open_Item='1') Begin
52302>>>>>            If ((Cmoves.Cmoves_X0<>0) And ((Cmoves.Cmoves_P0=0))) Begin
52304>>>>>                Move 1                          to Cmoves.Flag_Copen
52305>>>>>                If (Cmoves.Cmoves_X0<0) Move 2  to Cmoves.Flag_Copen
52308>>>>>            End
52308>>>>>>
52308>>>>>            Else If ((Cmoves.Cmoves_P0<>0) And ((Cmoves.Cmoves_X0=0))) Begin
52311>>>>>                Move 2                          to Cmoves.Flag_Copen
52312>>>>>                If (Cmoves.Cmoves_P0<0) Move 1  to Cmoves.Flag_Copen
52315>>>>>            End
52315>>>>>>
52315>>>>>            Else Move 0 to Cmoves.Flag_Copen
52317>>>>>        End
52317>>>>>>
52317>>>>>        Else Move 0 to Cmoves.Flag_Copen
52319>>>>>    End_Procedure   // Update
52320>>>>>
52320>>>>>    Procedure Backout
52321>>>>>        Forward Send Backout
52323>>>>>
52323>>>>>        if (Cmoves.enhm_ofeilh='1') begin
52325>>>>>            sub (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) from Clients.Synolikh_ofeilh
52326>>>>>            sub (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) from Payresp.Synolikh_ofeilh
52327>>>>>        end
52327>>>>>>
52327>>>>>
52327>>>>>//        if (Cmoves.enhm_ofeilh='2') begin
52327>>>>>//            sub ((Cmoves.Cmoves_x0-Cmoves.cmoves_p0)*-1) from Clients.Synolikh_ofeilh
52327>>>>>//            sub ((Cmoves.Cmoves_x0-Cmoves.cmoves_p0)*-1) from Payresp.Synolikh_ofeilh
52327>>>>>//        end
52327>>>>>
52327>>>>>        If (Cmoves.Enhm_Ypol_Pel='1') Begin
52329>>>>>            If (Cmoves.Cmoves_x0<>0) Begin
52331>>>>>                Sub Cmoves.Cmoves_x0 From Clients.Xreosh
52332>>>>>                Sub Cmoves.Cmoves_x0 From PayResp.Xreosh
52333>>>>>            End
52333>>>>>>
52333>>>>>            Else If (Cmoves.Cmoves_p0<>0) Begin
52336>>>>>                Sub Cmoves.Cmoves_p0 From Clients.Pistosh
52337>>>>>                Sub Cmoves.Cmoves_p0 From PayResp.Pistosh
52338>>>>>            End
52338>>>>>>
52338>>>>>        End
52338>>>>>>
52338>>>>>    End_Procedure
52339>>>>>
52339>>>>>    Procedure Creating
52340>>>>>        Forward Send Creating
52342>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Cmoves.Cmoves_Rec0)))))) to Cmoves.Cmoves_Recr
52343>>>>>
52343>>>>>        //If ((Cmoves.Module_From='' ) Or (piFromBP(Self)<>1)) Move gs_Module_Code to Cmoves.Module_From
52343>>>>>
52343>>>>>        If (Ctypkin.Open_Item ='1') Begin
52345>>>>>                 If (Cmoves.Cmoves_x0<>0) Move (Abs(Cmoves.Cmoves_x0)) to Cmoves.Axia_Pros_Sysx
52348>>>>>            Else If (Cmoves.Cmoves_p0<>0) Move (Abs(Cmoves.Cmoves_p0)) to Cmoves.Axia_Pros_Sysx
52352>>>>>        End
52352>>>>>>
52352>>>>>    End_Procedure   // Creating
52353>>>>>
52353>>>>>
52353>>>>>
52353>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
52354>>>>>        String lsError_Message
52355>>>>>
52355>>>>>        Case Begin
52355>>>>>            
52355>>>>>            Case (iError_Num = 3263)
52357>>>>>                Move "DDC 006: ‘­á¢£˜ 6666 €›ç¤˜«ž ž œšš¨˜­ž!\n‰œ¤æ Cmoverecr!! Protem !!" to lsError_Message
52358>>>>>            Case Break
52359>>>>>            
52359>>>>>            Case (iError_Num = 6666)
52362>>>>>                Move "DDC 006: ‘­á¢£˜ 6666 €›ç¤˜«ž ž œšš¨˜­ž!\nƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ ¬§¦¡˜«˜©«ž£á«à¤" to lsError_Message
52363>>>>>            Case Break
52364>>>>>
52364>>>>>            Case (iError_Num = 6667)
52367>>>>>                Move "DDC 006: ‘­á¢£˜ 6667 €›ç¤˜«ž ž œšš¨˜­ž!\n†£/¤å˜ ¡å¤ž©žª §¨¦šœ¤â©«œ¨ž ž£/¤å˜ª ¡¢œ ›é£˜«¦ª" to lsError_Message
52368>>>>>            Case Break
52369>>>>>
52369>>>>>            Case (iError_Num = 6668)
52372>>>>>                Move "DDC 006: ‘­á¢£˜ 6668 €›ç¤˜«ž ž › ˜š¨˜­ã!\nƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ ¬§¦¡˜«˜©«ž£á«à¤" to lsError_Message
52373>>>>>            Case Break
52374>>>>>
52374>>>>>            Case (iError_Num = 6669)
52377>>>>>                Move "DDC 006: ‘­á¢£˜ 6669 €›ç¤˜«ž ž › ˜š¨˜­ã!\n†£/¤å˜ ¡å¤ž©žª §¨¦šœ¤â©«œ¨ž ž£/¤å˜ª ¡¢œ ›é£˜«¦ª" to lsError_Message
52378>>>>>            Case Break
52379>>>>>
52379>>>>>            Case (iError_Num = 22277)
52382>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n†£œ¨¦£ž¤åœª œ¡«æª ¦¨åà¤ ®¨ã©žª" to lsError_Message
52383>>>>>            Case Break
52384>>>>>
52384>>>>>            Case (iError_Num = 22278)
52387>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ã!\n\„®œ  «¬§àŸœ  Ÿœà¨ž£â¤¦" to lsError_Message
52388>>>>>            Case Break
52389>>>>>
52389>>>>>            Case (iError_Num = 22279)
52392>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\„®œ  «¬§àŸœ  Ÿœà¨ž£â¤¦" to lsError_Message
52393>>>>>            Case Break
52394>>>>>
52394>>>>>            Case (iError_Num = 11170)
52397>>>>>                Move "DDC 006:’¦ § ©«à« ¡æ æ¨ ¦ «¦¬ ­¦¨â˜ â®œ  œ¥˜¤«¢žŸœå" to lsError_Message
52398>>>>>            Case Break
52399>>>>>
52399>>>>>            Case (iError_Num = 11171)
52402>>>>>                Move "DDC 006:’¦ § ©«à« ¡æ æ¨ ¦ «¦¬ “§. ¢ž¨à£é¤ â®œ  œ¥˜¤«¢žŸœå" to lsError_Message
52403>>>>>            Case Break
52404>>>>>
52404>>>>>            Case (iError_Num = 11172)
52407>>>>>                Move "DDC 006:Ž ­¦¨â˜ª œå¤˜  ¡¢œ ›à£â¤¦ª ¢æšà § ©«à« ¡¦ç ¦¨å¦¬" to lsError_Message
52408>>>>>            Case Break
52409>>>>>
52409>>>>>            Case (iError_Num = 22288)
52412>>>>>                Clear Codemast
52413>>>>>                Move "MODULE" to Codemast.Type
52414>>>>>                Move Cmoves.Module_From to Codemast.Code
52415>>>>>                Find Eq Codemast by Index.1 //type+code
52416>>>>>>
52416>>>>>                Move ("DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n(† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ "+;                (Trim(Codemast.Description))+" )") to lsError_Message
52417>>>>>            Case Break
52418>>>>>
52418>>>>>            Case (iError_Num = 22250)
52421>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n’¦ ¡ç¡¢à£˜ (Module) «žª œšš¨˜­ãª œå¤˜  ¡œ¤æ" to lsError_Message
52422>>>>>            Case Break
52423>>>>>
52423>>>>>            Case (iError_Num = 22284)
52426>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ «˜ €¥ æš¨˜­˜" to lsError_Message
52427>>>>>            Case Break
52428>>>>>            Case (iError_Num = 22283)
52431>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ « ª à¢ã©œ ª" to lsError_Message
52432>>>>>            Case Break
52433>>>>>            Case (iError_Num = 22282)
52436>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ « ª €š¦¨âª" to lsError_Message
52437>>>>>            Case Break
52438>>>>>
52438>>>>>            //˜§æ validate delete
52438>>>>>            Case (iError_Num = 22289)
52441>>>>>                Clear Codemast
52442>>>>>                Move "MODULE" to Codemast.Type
52443>>>>>                Move Cmoves.Module_From to Codemast.Code
52444>>>>>                Find Eq Codemast by Index.1 //type+code
52445>>>>>>
52445>>>>>                Move ("DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n(† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ "+;                (Trim(Codemast.Description))+" )") to lsError_Message
52446>>>>>            Case Break
52447>>>>>
52447>>>>>            Case (iError_Num = 22287)
52450>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ «˜ €¥ æš¨˜­˜" to lsError_Message
52451>>>>>            Case Break
52452>>>>>            Case (iError_Num = 22286)
52455>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ « ª à¢ã©œ ª" to lsError_Message
52456>>>>>            Case Break
52457>>>>>            Case (iError_Num = 22285)
52460>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ « ª €š¦¨âª" to lsError_Message
52461>>>>>            Case Break
52462>>>>>
52462>>>>>            //â¢œš®¦  open items
52462>>>>>            Case (iError_Num = 10101)
52465>>>>>                Move ("DDC 006:€¡˜«á¢¢ž¢ž „šš¨˜­ã.\n\n"+;                "’¦ ©¬©®œ« ©£â¤¦ §¦©æ œå¤˜  £œš˜¢ç«œ¨¦\n˜§¦ «¦ ˜¨® ¡á › ˜Ÿâ© £¦ §¨¦ª ©¬©®â« ©ž");                to lsError_Message
52466>>>>>            Case Break
52467>>>>>
52467>>>>>            Case Else
52467>>>>>                Forward Send Operation_Not_Allowed iError_Num
52469>>>>>        Case End
52469>>>>>
52469>>>>>        Error iError_Num lsError_Message
52470>>>>>>
52470>>>>>    End_Procedure // operation_not_allowed
52471>>>>>
52471>>>>>
52471>>>>>    // Define_Fields:
52471>>>>>    // This procedure is used to set up all data-dictionary rules.
52471>>>>>
52471>>>>>    Procedure Define_Fields
52472>>>>>        Forward Send Define_Fields
52474>>>>>        //DDB-Generated-Code-Location
52474>>>>>        //DDB-DefineFieldStart
52474>>>>>
52474>>>>>        Set Main_File            To Cmoves.File_Number
52475>>>>>        Set Cascade_Delete_State To FALSE
52476>>>>>
52476>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
52477>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
52478>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
52479>>>>>
52479>>>>>        // Child (Client) file structure................
52479>>>>>        Send Add_Client_File  Copen.File_Number
52480>>>>>
52480>>>>>        // Parent (Server) file structure...............
52480>>>>>        Send Add_Server_File  Ctypkin.File_Number
52481>>>>>        Send Add_Server_File  Clients.File_Number
52482>>>>>
52482>>>>>        // External (System) file structure.............
52482>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_NEW_SAVE_DELETE
52483>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
52484>>>>>
52484>>>>>        Define_Auto_Increment  Sysrecc.Cmoves_Rec0  To Cmoves.Cmoves_Rec0
52487>>>>>
52487>>>>>        // Field-based properties.......................
52487>>>>>
52487>>>>>        // Cmoves.Company_Code
52487>>>>>
52487>>>>>        // Cmoves.Branch_Code
52487>>>>>
52487>>>>>        // Cmoves.Year_Year
52487>>>>>
52487>>>>>        // Cmoves.Custprom_Code
52487>>>>>
52487>>>>>        // Cmoves.Client_Id
52487>>>>>
52487>>>>>        // Cmoves.Ctypkin_Code
52487>>>>>
52487>>>>>        // Cmoves.Cmoves_Recr
52487>>>>>
52487>>>>>        // Cmoves.Cmoves_Rec0
52487>>>>>        Set Field_Options          Field Cmoves.Cmoves_Rec0 To DD_AUTOFIND   
52488>>>>>        Set Field_Prompt_Object    Field Cmoves.Cmoves_Rec0 To (sl006(Self))
52489>>>>>
52489>>>>>        // Cmoves.Cmoves_Hmnia
52489>>>>>        Set Field_Prompt_Object    Field Cmoves.Cmoves_Hmnia To (sl006(Self))
52490>>>>>
52490>>>>>        // Cmoves.Ctypkin_Recr
52490>>>>>
52490>>>>>        // Cmoves.Cmoves_Par
52490>>>>>
52490>>>>>        // Cmoves.Partl_Recr
52490>>>>>        //DDB/ Comment_Short       Field Cmoves.Partl_Recr To "‘¬¤›œ©ž record £œ ¡ç¡¢à£˜ à¢ã©œà¤"
52490>>>>>
52490>>>>>        // Cmoves.Cmoves_Axia
52490>>>>>
52490>>>>>        // Cmoves.Cmoves_X0
52490>>>>>
52490>>>>>        // Cmoves.Cmoves_P0
52490>>>>>
52490>>>>>        // Cmoves.Cmoves_X00
52490>>>>>
52490>>>>>        // Cmoves.Cmoves_P00
52490>>>>>
52490>>>>>        // Cmoves.Cmoves_X1
52490>>>>>
52490>>>>>        // Cmoves.Cmoves_P1
52490>>>>>
52490>>>>>        // Cmoves.Cmoves_X2
52490>>>>>
52490>>>>>        // Cmoves.Cmoves_P2
52490>>>>>
52490>>>>>        // Cmoves.Cmoves_Dlixis
52490>>>>>
52490>>>>>        // Cmoves.Cmoves_A_Code
52490>>>>>
52490>>>>>        // Cmoves.Cmoves_Status_E
52490>>>>>
52490>>>>>        // Cmoves.Cmoves_Status_A
52490>>>>>
52490>>>>>        // Cmoves.Cmoves_S0
52490>>>>>
52490>>>>>        // Cmoves.Cmoves_Ys0
52490>>>>>
52490>>>>>        // Cmoves.Cmoves_S1
52490>>>>>
52490>>>>>        // Cmoves.Cmoves_Ys1
52490>>>>>
52490>>>>>        // Cmoves.Cmoves_S2
52490>>>>>
52490>>>>>        // Cmoves.Cmoves_Ys2
52490>>>>>
52490>>>>>        // Cmoves.Cmoves_Sc_Code2
52490>>>>>        Set Field_Prompt_Object    Field Cmoves.Cmoves_Sc_Code2 To (slNomism(Self))
52491>>>>>
52491>>>>>        // Cmoves.Cmoves_Open
52491>>>>>
52491>>>>>        // Cmoves.Cmoves_Aopen
52491>>>>>
52491>>>>>        // Cmoves.Cmoves_M_Code
52491>>>>>
52491>>>>>        // Cmoves.Cmoves_Yn_Myf
52491>>>>>
52491>>>>>        // Cmoves.Cmoves_Myf_Axia
52491>>>>>
52491>>>>>        // Cmoves.Cmoves_Kk
52491>>>>>
52491>>>>>        // Cmoves.Cmoves_C_Code2
52491>>>>>
52491>>>>>        // Cmoves.Cn_Code
52491>>>>>        Set Field_Prompt_Object    Field Cmoves.Cn_Code To (sl041(Self))
52492>>>>>
52492>>>>>        // Cmoves.Client_Recr
52492>>>>>
52492>>>>>        // Cmoves.Barticl_Recr
52492>>>>>
52492>>>>>        // Cmoves.Cmoves_Qty
52492>>>>>
52492>>>>>        // Cmoves.Cmove_Totambd0
52492>>>>>
52492>>>>>        // Cmoves.Cmove_Discam0
52492>>>>>
52492>>>>>        // Cmoves.Cmove_Totamad0
52492>>>>>
52492>>>>>        // Cmoves.Cmove_Vatam0
52492>>>>>
52492>>>>>        // Cmoves.Cmove_Extra0
52492>>>>>
52492>>>>>        // Cmoves.Cmove_Totambd00
52492>>>>>
52492>>>>>        // Cmoves.Cmove_Discam00
52492>>>>>
52492>>>>>        // Cmoves.Cmove_Totamad00
52492>>>>>
52492>>>>>        // Cmoves.Cmove_Vatam00
52492>>>>>
52492>>>>>        // Cmoves.Cmove_Extra00
52492>>>>>
52492>>>>>        // Cmoves.Cmove_Totambd1
52492>>>>>
52492>>>>>        // Cmoves.Cmove_Discam1
52492>>>>>
52492>>>>>        // Cmoves.Cmove_Totamad1
52492>>>>>
52492>>>>>        // Cmoves.Cmove_Vatam1
52492>>>>>
52492>>>>>        // Cmoves.Cmove_Extra1
52492>>>>>
52492>>>>>        // Cmoves.Module_From
52492>>>>>
52492>>>>>        // Cmoves.Parast_Abrev
52492>>>>>
52492>>>>>        // Cmoves.Enhm_Ypol_Pel
52492>>>>>
52492>>>>>        // Cmoves.Enhm_Hmnies_Pel
52492>>>>>
52492>>>>>        // Cmoves.Sls_Id
52492>>>>>
52492>>>>>        // Cmoves.Presp_Id
52492>>>>>
52492>>>>>        // Cmoves.Cnt_Id
52492>>>>>
52492>>>>>        // Cmoves.Cmoves_Open_Sx0
52492>>>>>
52492>>>>>        // Cmoves.Cmoves_Open_Sp0
52492>>>>>
52492>>>>>        // Cmoves.Cmoves_Open_Yx0
52492>>>>>
52492>>>>>        // Cmoves.Cmoves_Open_Yp0
52492>>>>>
52492>>>>>        // Cmoves.Cmoves_Open_Sx1
52492>>>>>
52492>>>>>        // Cmoves.Cmoves_Open_Sp1
52492>>>>>
52492>>>>>        // Cmoves.Cmoves_Open_Sx2
52492>>>>>
52492>>>>>        // Cmoves.Cmoves_Open_Sp2
52492>>>>>
52492>>>>>        // Cmoves.Cmoves_Topen
52492>>>>>
52492>>>>>        // Cmoves.Cn_Recr
52492>>>>>
52492>>>>>        // Cmoves.Axia_Pros_Sysx
52492>>>>>
52492>>>>>        // Cmoves.Axia_Sysxet
52492>>>>>
52492>>>>>        // Cmoves.Axia_Ypol_Sysx
52492>>>>>
52492>>>>>        // Cmoves.Axia_Pros_Sys00
52492>>>>>
52492>>>>>        // Cmoves.Axia_Sysxet00
52492>>>>>
52492>>>>>        // Cmoves.Axia_Ypol_Sys00
52492>>>>>
52492>>>>>        // Cmoves.Axia_Pros_Sysr
52492>>>>>
52492>>>>>        // Cmoves.Axia_Sysxetr
52492>>>>>
52492>>>>>        // Cmoves.Axia_Ypol_Sysr
52492>>>>>
52492>>>>>        // Cmoves.Mhxanik_Id
52492>>>>>
52492>>>>>        // Cmoves.Prn_Theor
52492>>>>>
52492>>>>>        // Cmoves.Is_Closed
52492>>>>>
52492>>>>>        // Cmoves.Flag_Copen
52492>>>>>
52492>>>>>        // Cmoves.Flag_Ypol
52492>>>>>
52492>>>>>        // Cmoves.Ctypkin_Descr
52492>>>>>
52492>>>>>        // Cmoves.Client_Name
52492>>>>>
52492>>>>>        // Cmoves.Enhm_Ofeilh
52492>>>>>
52492>>>>>        // Cmoves.Sap_Hmnia
52492>>>>>
52492>>>>>        //DDB-DefineFieldEnd
52492>>>>>    End_Procedure    // Define_Fields
52493>>>>>
52493>>>>>    // Field_Defaults:
52493>>>>>    // This procedure is used to establish default field values.
52493>>>>>
52493>>>>>    Procedure Field_Defaults
52494>>>>>        Forward Send Field_Defaults
52496>>>>>        //DDB-Generated-Code-Location
52496>>>>>        //DDB-FieldDefaultStart
52496>>>>>        //DDB-FieldDefaultEnd
52496>>>>>    End_Procedure    // Field_Defaults
52497>>>>>
52497>>>>>End_Class    // Cmoves_DataDictionary
52498>>>>>//DDB-Selection-pkg-Start
52498>>>>>
52498>>>>>Use sl006.SL         // sl006
INCLUDING FILE: SL006.SL
52498>>>>>>>//AB/ Project sl006:Cmoves lookup
52498>>>>>>>//AB/ Object prj is a Lookup_Project
52498>>>>>>>//AB/     Set ProjectName to "sl006:Cmoves lookup"
52498>>>>>>>//AB/     Set ProjectFileName to "sl006.SL"
52498>>>>>>>//AB/     Set GenerateFileName to "NONAME"
52498>>>>>>>
52498>>>>>>>// Project Object Structure
52498>>>>>>>//   sl006 is a dbModalPanelSub
52498>>>>>>>//     Ctypkin_DD is a DataDictionary
52498>>>>>>>//     Clients_DD is a DataDictionary
52498>>>>>>>//     Cmoves_DD is a DataDictionary
52498>>>>>>>//     oSelList is a dbListSub
52498>>>>>>>//     oOK_bn is a ButtonSub
52498>>>>>>>//     oCancel_bn is a ButtonSub
52498>>>>>>>//     oSearch_bn is a ButtonSub
52498>>>>>>>//     Cmoves_Axia_Pros_Sysx is a dbFormSub
52498>>>>>>>//     Cmoves_Axia_Sysxet is a dbFormSub
52498>>>>>>>//     Cmoves_Axia_Ypol_Sysx is a dbFormSub
52498>>>>>>>//     TextBoxSub1 is a TextBoxSub
52498>>>>>>>//     TextBoxSub2 is a TextBoxSub
52498>>>>>>>//     TextBoxSub3 is a TextBoxSub
52498>>>>>>>//     RadioGroupSub2 is a RadioGroupSub
52498>>>>>>>//       Radio4 is a RadioSub
52498>>>>>>>//       Radio5 is a RadioSub
52498>>>>>>>//       Radio6 is a RadioSub
52498>>>>>>>
52498>>>>>>>// Register all objects
52498>>>>>>>Register_Object Clients_DD
52498>>>>>>>Register_Object Cmoves_Axia_Pros_Sysx
52498>>>>>>>Register_Object Cmoves_Axia_Sysxet
52498>>>>>>>Register_Object Cmoves_Axia_Ypol_Sysx
52498>>>>>>>Register_Object Cmoves_DD
52498>>>>>>>Register_Object Ctypkin_DD
52498>>>>>>>Register_Object oCancel_bn
52498>>>>>>>Register_Object oOK_bn
52498>>>>>>>Register_Object oSearch_bn
52498>>>>>>>Register_Object oSelList
52498>>>>>>>Register_Object Radio4
52498>>>>>>>Register_Object Radio5
52498>>>>>>>Register_Object Radio6
52498>>>>>>>Register_Object RadioGroupSub2
52498>>>>>>>Register_Object sl006
52498>>>>>>>Register_Object TextBoxSub1
52498>>>>>>>Register_Object TextBoxSub2
52498>>>>>>>Register_Object TextBoxSub3
52498>>>>>>>
52498>>>>>>>
52498>>>>>>>//AB-IgnoreStart
52498>>>>>>>
52498>>>>>>>Use DFAllEnt.pkg
52498>>>>>>>Use dbList.Sub
52498>>>>>>>Use Button.Sub
52498>>>>>>>Use dbForm.Sub
52498>>>>>>>Use Txtbox.Sub
52498>>>>>>>Use Rgroup.Sub
52498>>>>>>>Use Radio.Sub
52498>>>>>>>
52498>>>>>>>
52498>>>>>>>Use CTYPKIN.DD
52498>>>>>>>Use CLIENTS.DD
52498>>>>>>>Use CMOVES.DD
52498>>>>>>>
52498>>>>>>>//AB-IgnoreEnd
52498>>>>>>>
52498>>>>>>>Object sl006 is a dbModalPanelSub
52500>>>>>>>
52500>>>>>>>    //AB-StoreTopStart
52500>>>>>>>                                        
52500>>>>>>>    Property String     psModule    Public ''
52502>>>>>>>    Property String     psClientID  Public ''
52504>>>>>>>    Property Date       pdApo       public ''
52506>>>>>>>    Property Date       pdEos       public ''
52508>>>>>>>    Property Integer    piXr_Or_Pi  public  0
52510>>>>>>>    Property Integer    piWhat      public  0
52512>>>>>>>    
52512>>>>>>>    //AB-StoreTopEnd
52512>>>>>>>
52512>>>>>>>    Set Label to "‰ ¤ã©œ ª ”¦¨âà¤"
52513>>>>>>>    Set Size to 270 519
52514>>>>>>>    Set Location to 5 7
52515>>>>>>>    Set Exit_Application_Local_State to FALSE
52516>>>>>>>    Set Modal_State to FALSE
52517>>>>>>>
52517>>>>>>>    //AB-DDOStart
52517>>>>>>>
52517>>>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
52519>>>>>>>    End_Object    // Ctypkin_DD
52520>>>>>>>
52520>>>>>>>    Object Clients_DD is a Clients_DataDictionary
52522>>>>>>>    End_Object    // Clients_DD
52523>>>>>>>
52523>>>>>>>    Object Cmoves_DD is a Cmoves_DataDictionary
52525>>>>>>>        Set DDO_Server to (Ctypkin_DD(self))
52526>>>>>>>        Set DDO_Server to (Clients_DD(self))
52527>>>>>>>
52527>>>>>>>        //AB-StoreStart
52527>>>>>>>        
52527>>>>>>>        Begin_Constraints
52529>>>>>>>        
52529>>>>>>>            Constrain Cmoves.Company_Code   Eq SyscurXr.Company_Code
52531>>>>>>>            Constrain Cmoves.Year_Year      Eq SyscurXr.Year_Year
52533>>>>>>>        
52533>>>>>>>            If (psClientID(Self)<>'')   Constrain Cmoves.Client_ID      Eq (psClientID(Self))
52537>>>>>>>            If (pdApo(Self)<>'')        Constrain Cmoves.Cmoves_Hmnia   Ge (pdApo(Self))
52541>>>>>>>            If (pdEos(Self)<>'')        Constrain Cmoves.Cmoves_Hmnia   Le (pdEos(Self))
52545>>>>>>>        
52545>>>>>>>            Constrain Cmoves.Module_From    Eq (psModule(Self))
52547>>>>>>>        
52547>>>>>>>                 If (piWhat(Self)=1) Constrain Cmoves.Flag_Ypol Eq 1
52551>>>>>>>            Else If (piWhat(Self)=2) Constrain Cmoves.Flag_Ypol Eq 0
52556>>>>>>>        
52556>>>>>>>        End_Constraints
52559>>>>>>>        
52559>>>>>>>        
52559>>>>>>>        
52559>>>>>>>        
52559>>>>>>>        
52559>>>>>>>        
52559>>>>>>>        
52559>>>>>>>        
52559>>>>>>>        
52559>>>>>>>        
52559>>>>>>>        
52559>>>>>>>        
52559>>>>>>>        
52559>>>>>>>        
52559>>>>>>>        
52559>>>>>>>        
52559>>>>>>>        
52559>>>>>>>        
52559>>>>>>>        
52559>>>>>>>        
52559>>>>>>>        
52559>>>>>>>        
52559>>>>>>>        
52559>>>>>>>        
52559>>>>>>>        
52559>>>>>>>        
52559>>>>>>>        //AB-StoreEnd
52559>>>>>>>
52559>>>>>>>    End_Object    // Cmoves_DD
52560>>>>>>>
52560>>>>>>>    Set Main_DD to (Cmoves_DD(self))
52561>>>>>>>    Set Server to (Cmoves_DD(self))
52562>>>>>>>
52562>>>>>>>    //AB-DDOEnd
52562>>>>>>>
52562>>>>>>>    Object oSelList is a dbListSub
52564>>>>>>>
52564>>>>>>>        //AB-StoreTopStart
52564>>>>>>>                                                                                                                                                                                                                                                                                                                            
52564>>>>>>>        //AB-StoreTopEnd
52564>>>>>>>
52564>>>>>>>        Set Main_File to Cmoves.File_Number
52565>>>>>>>        Set Ordering to 4
52566>>>>>>>        Set Size to 199 505
52567>>>>>>>        Set Location to 31 7
52568>>>>>>>        Set Auto_Index_State to FALSE
52569>>>>>>>
52569>>>>>>>        Begin_Row
52572>>>>>>>            Entry_Item Cmoves.Cmoves_hmnia
52573>>>>>>>            Entry_Item Cmoves.Cmoves_par
52574>>>>>>>            Entry_Item Ctypkin.Ctypkin_descr
52575>>>>>>>            Entry_Item Clients.Client_name
52576>>>>>>>            Entry_Item Cmoves.Cmoves_axia
52577>>>>>>>            Entry_Item Cmoves.Cmoves_sc_code2
52578>>>>>>>            Entry_Item Cmoves.Branch_code
52579>>>>>>>        End_Row
52584>>>>>>>
52584>>>>>>>        Set Form_Width    item 0 to 57
52585>>>>>>>        Set Header_Label  item 0 to "†£œ¨/¤å˜"
52586>>>>>>>        
52586>>>>>>>        Set Form_Width    item 1 to 121
52587>>>>>>>        Set Header_Label  item 1 to "€ « ¦¢¦šå˜"
52588>>>>>>>        
52588>>>>>>>        Set Form_Width    item 2 to 65
52589>>>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž"
52590>>>>>>>        
52590>>>>>>>        Set Form_Width    item 3 to 107
52591>>>>>>>        Set Header_Label  item 3 to "‘¬¤˜¢¢˜©æ£œ¤¦ª"
52592>>>>>>>        
52592>>>>>>>        Set Form_Width    item 4 to 63
52593>>>>>>>        Set Header_Label  item 4 to " €¥å˜"
52594>>>>>>>        
52594>>>>>>>        Set Form_Width    item 5 to 42
52595>>>>>>>        Set Header_Label  item 5 to "Œæ£ ©£˜"
52596>>>>>>>        
52596>>>>>>>        Set Form_Width    item 6 to 45
52597>>>>>>>        Set Header_Label  item 6 to "“§¦¡/£˜"
52598>>>>>>>        
52598>>>>>>>
52598>>>>>>>        //AB-StoreStart
52598>>>>>>>                                                                                                                                                                                                                                                                                                                            
52598>>>>>>>        Procedure End_Construct_Object
52600>>>>>>>            String  sNom
52601>>>>>>>            Integer iDecs
52601>>>>>>>            Forward Send End_Construct_Object
52603>>>>>>>            Move SysCurxr.C_Code0 to sNom
52604>>>>>>>            Clear Nomisma
52605>>>>>>>            Move sNom to Nomisma.Nomisma_Code
52606>>>>>>>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
52607>>>>>>>>
52607>>>>>>>            If (Found=1)    Move Nomisma.Dekadika to iDecs
52610>>>>>>>            Else            Move 0 to iDecs
52612>>>>>>>        
52612>>>>>>>            // Ž¨ ¦¬£œ §àª ˜¤ «¦ ™˜© ¡æ ¤¦£ ©£˜ ®¨ã©žª ƒ„Œ œ®œ  ›œ¡˜› ¡á
52612>>>>>>>            // «æ«œ œ¥' ¦¨ ©£¦ç ™á¦¬£œ œ£œ ª 2
52612>>>>>>>            If (iDecs=0) Move 2 to iDecs
52615>>>>>>>            //
52615>>>>>>>        
52615>>>>>>>            Set Points          Item 4 to       iDecs
52616>>>>>>>            Set Numeric_Mask    Item 4 to 14    iDecs '*, '
52617>>>>>>>        End_Procedure
52618>>>>>>>        
52618>>>>>>>        
52618>>>>>>>        
52618>>>>>>>        
52618>>>>>>>        
52618>>>>>>>        //AB-StoreEnd
52618>>>>>>>
52618>>>>>>>    End_Object    // oSelList
52619>>>>>>>
52619>>>>>>>    Object oOK_bn is a ButtonSub
52621>>>>>>>        Set Label to "&„§ ¢¦šã"
52622>>>>>>>        Set Location to 236 350
52623>>>>>>>
52623>>>>>>>        //AB-StoreStart
52623>>>>>>>        Procedure OnClick
52625>>>>>>>            Send OK To (oSelList(current_object))
52626>>>>>>>        End_Procedure
52627>>>>>>>        //AB-StoreEnd
52627>>>>>>>
52627>>>>>>>    End_Object    // oOK_bn
52628>>>>>>>
52628>>>>>>>    Object oCancel_bn is a ButtonSub
52630>>>>>>>        Set Label to "&€¡ç¨à©ž"
52631>>>>>>>        Set Location to 236 404
52632>>>>>>>
52632>>>>>>>        //AB-StoreStart
52632>>>>>>>        Procedure OnClick
52634>>>>>>>            Send Cancel To (oSelList(current_object))
52635>>>>>>>        End_Procedure
52636>>>>>>>        //AB-StoreEnd
52636>>>>>>>
52636>>>>>>>    End_Object    // oCancel_bn
52637>>>>>>>
52637>>>>>>>    Object oSearch_bn is a ButtonSub
52639>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
52640>>>>>>>        Set Location to 236 460
52641>>>>>>>
52641>>>>>>>        //AB-StoreStart
52641>>>>>>>        Procedure OnClick
52643>>>>>>>            Send Search To (oSelList(current_object))
52644>>>>>>>        End_Procedure
52645>>>>>>>        //AB-StoreEnd
52645>>>>>>>
52645>>>>>>>    End_Object    // oSearch_bn
52646>>>>>>>
52646>>>>>>>    Object Cmoves_Axia_Pros_Sysx is a dbFormSub
52648>>>>>>>        Entry_Item Cmoves.Axia_pros_sysx
52649>>>>>>>        Set Size to 13 54
52650>>>>>>>        Set Location to 236 24
52651>>>>>>>        Set Color to clBtnFace
52652>>>>>>>        Set Label_Col_Offset to 2
52653>>>>>>>        Set Label_Justification_Mode to jMode_Right
52654>>>>>>>        Set Enabled_State to FALSE
52655>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
52656>>>>>>>        Set Shadow_State Item 0 to TRUE
52657>>>>>>>
52657>>>>>>>        //AB-StoreStart
52657>>>>>>>        Set points item 0 to 2
52658>>>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
52659>>>>>>>        
52659>>>>>>>        //AB-StoreEnd
52659>>>>>>>
52659>>>>>>>    End_Object    // Cmoves_Axia_Pros_Sysx
52660>>>>>>>
52660>>>>>>>    Object Cmoves_Axia_Sysxet is a dbFormSub
52662>>>>>>>        Entry_Item Cmoves.Axia_sysxet
52663>>>>>>>        Set Size to 13 54
52664>>>>>>>        Set Location to 236 140
52665>>>>>>>        Set Color to clBtnFace
52666>>>>>>>        Set Label_Col_Offset to 2
52667>>>>>>>        Set Label_Justification_Mode to jMode_Right
52668>>>>>>>        Set Enabled_State to FALSE
52669>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
52670>>>>>>>        Set Shadow_State Item 0 to TRUE
52671>>>>>>>
52671>>>>>>>        //AB-StoreStart
52671>>>>>>>        Set points item 0 to 2
52672>>>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
52673>>>>>>>        
52673>>>>>>>        //AB-StoreEnd
52673>>>>>>>
52673>>>>>>>    End_Object    // Cmoves_Axia_Sysxet
52674>>>>>>>
52674>>>>>>>    Object Cmoves_Axia_Ypol_Sysx is a dbFormSub
52676>>>>>>>        Entry_Item Cmoves.Axia_ypol_sysx
52677>>>>>>>        Set Size to 13 54
52678>>>>>>>        Set Location to 236 248
52679>>>>>>>        Set Color to clBtnFace
52680>>>>>>>        Set Label_Col_Offset to 2
52681>>>>>>>        Set Label_Justification_Mode to jMode_Right
52682>>>>>>>        Set Enabled_State to FALSE
52683>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
52684>>>>>>>        Set Shadow_State Item 0 to TRUE
52685>>>>>>>
52685>>>>>>>        //AB-StoreStart
52685>>>>>>>                                                                                                    
52685>>>>>>>        Set points item 0 to 2
52686>>>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
52687>>>>>>>        
52687>>>>>>>        //AB-StoreEnd
52687>>>>>>>
52687>>>>>>>    End_Object    // Cmoves_Axia_Ypol_Sysx
52688>>>>>>>
52688>>>>>>>    Object TextBoxSub1 is a TextBoxSub
52690>>>>>>>        Set Label to "€¥å˜"
52691>>>>>>>        Set Location to 238 7
52692>>>>>>>        Set Size to 10 15
52693>>>>>>>    End_Object    // TextBoxSub1
52694>>>>>>>
52694>>>>>>>    Object TextBoxSub2 is a TextBoxSub
52696>>>>>>>        Set Label to "‘¬©®œ« ©£â¤ž"
52697>>>>>>>        Set Location to 238 89
52698>>>>>>>        Set Size to 10 49
52699>>>>>>>    End_Object    // TextBoxSub2
52700>>>>>>>
52700>>>>>>>    Object TextBoxSub3 is a TextBoxSub
52702>>>>>>>        Set Label to "ƒ ˜Ÿâ© £ž"
52703>>>>>>>        Set Location to 238 210
52704>>>>>>>        Set Size to 10 35
52705>>>>>>>    End_Object    // TextBoxSub3
52706>>>>>>>
52706>>>>>>>    Object RadioGroupSub2 is a RadioGroupSub
52708>>>>>>>        Set Label to "„§ ¢¦šã ‰ ¤ã©œà¤"
52709>>>>>>>        Set Size to 24 497
52710>>>>>>>        Set Location to 3 9
52711>>>>>>>        Object Radio4 is a RadioSub
52713>>>>>>>            Set Label to "Ž¢œª"
52714>>>>>>>            Set Size to 10 37
52715>>>>>>>            Set Location to 10 97
52716>>>>>>>        End_Object    // Radio4
52717>>>>>>>
52717>>>>>>>        Object Radio5 is a RadioSub
52719>>>>>>>            Set Label to "‹œ ¬§æ¢¦ §¦ ©¬©®â« ©žª"
52720>>>>>>>            Set Size to 10 97
52721>>>>>>>            Set Location to 10 167
52722>>>>>>>        End_Object    // Radio5
52723>>>>>>>
52723>>>>>>>        Object Radio6 is a RadioSub
52725>>>>>>>            Set Label to "•à¨åª ¬§æ¢¦ §¦ ©¬©®â« ©žª"
52726>>>>>>>            Set Size to 10 111
52727>>>>>>>            Set Location to 10 278
52728>>>>>>>        End_Object    // Radio6
52729>>>>>>>
52729>>>>>>>
52729>>>>>>>        //AB-StoreStart
52729>>>>>>>                                                                                        
52729>>>>>>>        Procedure Notify_Select_State integer iToItem integer iFromItem
52731>>>>>>>            Set piWhat to iToItem
52732>>>>>>>            Send Rebuild_Constraints to Cmoves_DD
52733>>>>>>>            Send Beginning_Of_Data To oSelList True
52734>>>>>>>        End_Procedure
52735>>>>>>>        
52735>>>>>>>        Set Current_Radio to 1
52736>>>>>>>        
52736>>>>>>>        
52736>>>>>>>        
52736>>>>>>>        
52736>>>>>>>        //AB-StoreEnd
52736>>>>>>>
52736>>>>>>>    End_Object    // RadioGroupSub2
52737>>>>>>>
52737>>>>>>>
52737>>>>>>>    //AB-StoreStart
52737>>>>>>>                                        
52737>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
52738>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
52739>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
52740>>>>>>>    
52740>>>>>>>    Set Modal_State to True
52741>>>>>>>    
52741>>>>>>>    Procedure Activate
52743>>>>>>>        String  sNom
52744>>>>>>>        Integer iDecs rVal
52744>>>>>>>        Set piWhat to 1
52745>>>>>>>        Set Current_Radio Of RadioGroupSub2 to 1
52746>>>>>>>        Forward Send Activate
52748>>>>>>>        Send Rebuild_Constraints        to Cmoves_DD
52749>>>>>>>        Send Beginning_Of_Data          to oSelList True
52750>>>>>>>    End_procedure
52751>>>>>>>    
52751>>>>>>>    
52751>>>>>>>    
52751>>>>>>>    
52751>>>>>>>    
52751>>>>>>>    
52751>>>>>>>    
52751>>>>>>>    
52751>>>>>>>    
52751>>>>>>>    
52751>>>>>>>    
52751>>>>>>>    
52751>>>>>>>    
52751>>>>>>>    
52751>>>>>>>    
52751>>>>>>>    
52751>>>>>>>    
52751>>>>>>>    
52751>>>>>>>    
52751>>>>>>>    
52751>>>>>>>    
52751>>>>>>>    
52751>>>>>>>    
52751>>>>>>>    
52751>>>>>>>    
52751>>>>>>>    
52751>>>>>>>    //AB-StoreEnd
52751>>>>>>>
52751>>>>>>>End_Object    // sl006
52752>>>>>>>
52752>>>>>>>//AB/ End_Object    // prj
52752>>>>>Use slnomism.sl      // slNomism
52752>>>>>Use sl041.SL         // sl041
52752>>>>>
52752>>>>>//DDB-Selection-pkg-End
52752>>>>>//DDB-FileEnd
52752>>>    open clients
52754>>>    use  ctypkin.dd
52754>>>    open syscurxr
52756>>>    Use  Hmgio.dd
INCLUDING FILE: HMGIO.DD
52756>>>>>//DDB-FileStart
52756>>>>>//DDB-HeaderStart
52756>>>>>
52756>>>>>// File Name : HMGIO.DD
52756>>>>>// Class Name: Hmgio_DataDictionary
52756>>>>>// Revision  : 8
52756>>>>>// Version   : 2
52756>>>>>
52756>>>>>Use  Windows           // Basic Definitions
52756>>>>>Use  DataDict          // DataDictionary Class Definition
52756>>>>>Use  DDvalTbl          // Validation Table Class Definitions
52756>>>>>
52756>>>>>Open Hmgio
INCLUDING FILE: HMGIO.FD
52758>>>>>Open Hmctyp
52760>>>>>Open Sysrecc
52762>>>>>
52762>>>>>//DDB-HeaderEnd
52762>>>>>//DDB-ValidationStart
52762>>>>>
52762>>>>>Register_Object Hmgio_Hmgio_Module_VT
52762>>>>>
52762>>>>>Object Hmgio_Hmgio_Module_VT  is a CodeValidationTable
52764>>>>>    Set Type_Value        To "MODULE"
52765>>>>>    Set Validate_State    To FALSE
52766>>>>>    Set Allow_Blank_State To TRUE
52767>>>>>    //DDB-ValidationCustomStart
52767>>>>>    //DDB-ValidationCustomEnd
52767>>>>>End_Object   // Hmgio_Hmgio_Module_VT
52768>>>>>//DDB-ValidationEnd
52768>>>>>//DDB-SelectionStart
52768>>>>>//DDB/ ExternalSelectionList Hmgio  Hmgio.SL
52768>>>>>Register_Object Hmgio
52768>>>>>//DDB-SelectionEnd
52768>>>>>
52768>>>>>Class Hmgio_DataDictionary  is a DataDictionary_Sec
52769>>>>>
52769>>>>>    // Define_Fields:
52769>>>>>    // This procedure is used to set up all data-dictionary rules.
52769>>>>>
52769>>>>>    Procedure Define_Fields
52770>>>>>        Forward Send Define_Fields
52772>>>>>        //DDB-Generated-Code-Location
52772>>>>>        //DDB-DefineFieldStart
52772>>>>>
52772>>>>>        Set Main_File            To Hmgio.File_Number
52773>>>>>        Set Cascade_Delete_State To FALSE
52774>>>>>
52774>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
52775>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
52776>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
52777>>>>>
52777>>>>>        // Child (Client) file structure................
52777>>>>>        Send Add_Client_File  Hmctyp.File_Number
52778>>>>>
52778>>>>>        // External (System) file structure.............
52778>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
52779>>>>>
52779>>>>>        Define_Auto_Increment  Sysrecc.Hmgio_Code  To Hmgio.Hmgio_Code
52782>>>>>
52782>>>>>        // Field-based properties.......................
52782>>>>>
52782>>>>>        // Hmgio.Hmgio_Code
52782>>>>>        Set Field_Options          Field Hmgio.Hmgio_Code To DD_AUTOFIND   
52783>>>>>        Set Field_Prompt_Object    Field Hmgio.Hmgio_Code To (Hmgio(Self))
52784>>>>>        Set Key_Field_State        Field Hmgio.Hmgio_Code To TRUE
52785>>>>>
52785>>>>>        // Hmgio.Hmgio_Descr
52785>>>>>        Set Field_Prompt_Object    Field Hmgio.Hmgio_Descr To (Hmgio(Self))
52786>>>>>
52786>>>>>        // Hmgio.Hmgio_Module
52786>>>>>        Set Field_Value_Table      Field Hmgio.Hmgio_Module To (Hmgio_Hmgio_Module_VT(Self))
52787>>>>>
52787>>>>>        //DDB-DefineFieldEnd
52787>>>>>    End_Procedure    // Define_Fields
52788>>>>>
52788>>>>>    // Field_Defaults:
52788>>>>>    // This procedure is used to establish default field values.
52788>>>>>
52788>>>>>    Procedure Field_Defaults
52789>>>>>        Forward Send Field_Defaults
52791>>>>>        //DDB-Generated-Code-Location
52791>>>>>        //DDB-FieldDefaultStart
52791>>>>>        //DDB-FieldDefaultEnd
52791>>>>>    End_Procedure    // Field_Defaults
52792>>>>>
52792>>>>>End_Class    // Hmgio_DataDictionary
52793>>>>>//DDB-Selection-pkg-Start
52793>>>>>
52793>>>>>Use Hmgio.SL         // Hmgio
INCLUDING FILE: HMGIO.SL
52793>>>>>>>//AB/ Project Hmgio:Lookup
52793>>>>>>>//AB/ Object prj is a Lookup_Project
52793>>>>>>>//AB/     Set ProjectName to "Hmgio:Lookup"
52793>>>>>>>//AB/     Set ProjectFileName to "Hmgio.SL"
52793>>>>>>>//AB/     Set GenerateFileName to "NONAME"
52793>>>>>>>
52793>>>>>>>// Project Object Structure
52793>>>>>>>//   Hmgio is a dbModalPanelSub
52793>>>>>>>//     Hmgio_DD is a DataDictionary
52793>>>>>>>//     oSelList is a dbListSub
52793>>>>>>>//     oOK_bn is a ButtonSub
52793>>>>>>>//     oCancel_bn is a ButtonSub
52793>>>>>>>//     oSearch_bn is a ButtonSub
52793>>>>>>>
52793>>>>>>>// Register all objects
52793>>>>>>>Register_Object Hmgio
52793>>>>>>>Register_Object Hmgio_DD
52793>>>>>>>Register_Object oCancel_bn
52793>>>>>>>Register_Object oOK_bn
52793>>>>>>>Register_Object oSearch_bn
52793>>>>>>>Register_Object oSelList
52793>>>>>>>
52793>>>>>>>
52793>>>>>>>//AB-IgnoreStart
52793>>>>>>>
52793>>>>>>>Use DFAllEnt.pkg
52793>>>>>>>Use dbList.Sub
52793>>>>>>>Use Button.Sub
52793>>>>>>>
52793>>>>>>>
52793>>>>>>>Use HMGIO.DD
52793>>>>>>>
52793>>>>>>>//AB-IgnoreEnd
52793>>>>>>>
52793>>>>>>>Object Hmgio is a dbModalPanelSub
52795>>>>>>>
52795>>>>>>>    //AB-StoreTopStart
52795>>>>>>>    Property String psModule Public ''
52797>>>>>>>    
52797>>>>>>>    //AB-StoreTopEnd
52797>>>>>>>
52797>>>>>>>    Set Label to "†£œ¨¦¢æš ˜"
52798>>>>>>>    Set Size to 200 297
52799>>>>>>>    Set Location to 4 5
52800>>>>>>>    Set Exit_Application_Local_State to FALSE
52801>>>>>>>    Set Modal_State to FALSE
52802>>>>>>>
52802>>>>>>>    //AB-DDOStart
52802>>>>>>>
52802>>>>>>>    Object Hmgio_DD is a Hmgio_DataDictionary
52804>>>>>>>
52804>>>>>>>        //AB-StoreStart
52804>>>>>>>        Function fiEggrafh_OK Returns Integer
52806>>>>>>>            Integer rVal
52807>>>>>>>            String sModule
52807>>>>>>>            Get psModule to sModule
52808>>>>>>>            If ((hmgio.Hmgio_Module=smodule) Or (hmgio.Hmgio_Module='04')) Move 1 to rVal
52811>>>>>>>            Function_Return rVal
52812>>>>>>>        End_Function
52813>>>>>>>        
52813>>>>>>>        Begin_Constraints
52815>>>>>>>             Constrain hmgio as (fiEggrafh_OK(Self)=1)
52816>>>>>>>        End_Constraints
52819>>>>>>>        
52819>>>>>>>        
52819>>>>>>>        
52819>>>>>>>        
52819>>>>>>>        
52819>>>>>>>        //AB-StoreEnd
52819>>>>>>>
52819>>>>>>>    End_Object    // Hmgio_DD
52820>>>>>>>
52820>>>>>>>    Set Main_DD to (Hmgio_DD(self))
52821>>>>>>>    Set Server to (Hmgio_DD(self))
52822>>>>>>>
52822>>>>>>>    //AB-DDOEnd
52822>>>>>>>
52822>>>>>>>    Object oSelList is a dbListSub
52824>>>>>>>        Set Main_File to Hmgio.File_Number
52825>>>>>>>        Set Size to 161 280
52826>>>>>>>        Set Location to 6 6
52827>>>>>>>        Set Auto_Index_State to FALSE
52828>>>>>>>
52828>>>>>>>        Begin_Row
52831>>>>>>>            Entry_Item Hmgio.Hmgio_code
52832>>>>>>>            Entry_Item Hmgio.Hmgio_descr
52833>>>>>>>        End_Row
52838>>>>>>>
52838>>>>>>>        Set Form_Width    item 0 to 84
52839>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
52840>>>>>>>        
52840>>>>>>>        Set Form_Width    item 1 to 188
52841>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
52842>>>>>>>        
52842>>>>>>>
52842>>>>>>>        //AB-StoreStart
52842>>>>>>>                                    
52842>>>>>>>        Procedure Activate
52844>>>>>>>            Forward Send Activate
52846>>>>>>>            Send Rebuild_Constraints to Hmgio_DD
52847>>>>>>>            Send Beginning_Of_Data to oSelList True
52848>>>>>>>        End_Procedure
52849>>>>>>>        
52849>>>>>>>        //AB-StoreEnd
52849>>>>>>>
52849>>>>>>>    End_Object    // oSelList
52850>>>>>>>
52850>>>>>>>    Object oOK_bn is a ButtonSub
52852>>>>>>>        Set Label to "&„§ ¢¦šã"
52853>>>>>>>        Set Location to 169 131
52854>>>>>>>
52854>>>>>>>        //AB-StoreStart
52854>>>>>>>        Procedure OnClick
52856>>>>>>>            Send OK To (oSelList(current_object))
52857>>>>>>>        End_Procedure
52858>>>>>>>        //AB-StoreEnd
52858>>>>>>>
52858>>>>>>>    End_Object    // oOK_bn
52859>>>>>>>
52859>>>>>>>    Object oCancel_bn is a ButtonSub
52861>>>>>>>        Set Label to "&€¡ç¨à©ž"
52862>>>>>>>        Set Location to 169 185
52863>>>>>>>
52863>>>>>>>        //AB-StoreStart
52863>>>>>>>        Procedure OnClick
52865>>>>>>>            Send Cancel To (oSelList(current_object))
52866>>>>>>>        End_Procedure
52867>>>>>>>        //AB-StoreEnd
52867>>>>>>>
52867>>>>>>>    End_Object    // oCancel_bn
52868>>>>>>>
52868>>>>>>>    Object oSearch_bn is a ButtonSub
52870>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
52871>>>>>>>        Set Location to 169 241
52872>>>>>>>
52872>>>>>>>        //AB-StoreStart
52872>>>>>>>        Procedure OnClick
52874>>>>>>>            Send Search To (oSelList(current_object))
52875>>>>>>>        End_Procedure
52876>>>>>>>        //AB-StoreEnd
52876>>>>>>>
52876>>>>>>>    End_Object    // oSearch_bn
52877>>>>>>>
52877>>>>>>>
52877>>>>>>>    //AB-StoreStart
52877>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
52878>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
52879>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
52880>>>>>>>    
52880>>>>>>>    //AB-StoreEnd
52880>>>>>>>
52880>>>>>>>End_Object    // Hmgio
52881>>>>>>>
52881>>>>>>>//AB/ End_Object    // prj
52881>>>>>
52881>>>>>//DDB-Selection-pkg-End
52881>>>>>//DDB-FileEnd
52881>>>    Use  HmCtyp.dd
INCLUDING FILE: HMCTYP.DD
52881>>>>>//DDB-FileStart
52881>>>>>//DDB-HeaderStart
52881>>>>>
52881>>>>>// File Name : HMCTYP.DD
52881>>>>>// Class Name: Hmctyp_DataDictionary
52881>>>>>// Revision  : 4
52881>>>>>// Version   : 2
52881>>>>>
52881>>>>>Use  Windows           // Basic Definitions
52881>>>>>Use  DataDict          // DataDictionary Class Definition
52881>>>>>Use  DDvalTbl          // Validation Table Class Definitions
52881>>>>>
52881>>>>>Open Hmctyp
52883>>>>>Open Hmgio
52885>>>>>Open Ctypkin
52887>>>>>
52887>>>>>//DDB-HeaderEnd
52887>>>>>
52887>>>>>Class Hmctyp_DataDictionary  is a DataDictionary_Sec
52888>>>>>
52888>>>>>    // Update:
52888>>>>>
52888>>>>>    Procedure Update
52889>>>>>        Forward Send Update
52891>>>>>        // Insert Code Here
52891>>>>>        Move SysCurXR.Company_Code  to HmCtyp.Company_Code
52892>>>>>        Move SysCurXR.Branch_Code   to HmCtyp.Branch_Code
52893>>>>>        Move SysCurXR.Year_Year     to HmCtyp.Year_Year
52894>>>>>        Move Ctypkin.Ctypkin_Code   to HmCtyp.Ctypkin_Code
52895>>>>>    End_Procedure   // Update
52896>>>>>
52896>>>>>
52896>>>>>    // Define_Fields:
52896>>>>>    // This procedure is used to set up all data-dictionary rules.
52896>>>>>
52896>>>>>    Procedure Define_Fields
52897>>>>>        Forward Send Define_Fields
52899>>>>>        //DDB-Generated-Code-Location
52899>>>>>        //DDB-DefineFieldStart
52899>>>>>
52899>>>>>        Set Main_File            To Hmctyp.File_Number
52900>>>>>        Set Cascade_Delete_State To FALSE
52901>>>>>
52901>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
52902>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
52903>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
52904>>>>>
52904>>>>>        // Parent (Server) file structure...............
52904>>>>>        Send Add_Server_File  Hmgio.File_Number
52905>>>>>        Send Add_Server_File  Ctypkin.File_Number
52906>>>>>
52906>>>>>        // Field-based properties.......................
52906>>>>>
52906>>>>>        // Hmctyp.Hmgio_Code
52906>>>>>
52906>>>>>        // Hmctyp.Ctypkin_Recr
52906>>>>>
52906>>>>>        // Hmctyp.Company_Code
52906>>>>>
52906>>>>>        // Hmctyp.Branch_Code
52906>>>>>
52906>>>>>        // Hmctyp.Year_Year
52906>>>>>
52906>>>>>        // Hmctyp.Ctypkin_Code
52906>>>>>
52906>>>>>        //DDB-DefineFieldEnd
52906>>>>>    End_Procedure    // Define_Fields
52907>>>>>
52907>>>>>    // Field_Defaults:
52907>>>>>    // This procedure is used to establish default field values.
52907>>>>>
52907>>>>>    Procedure Field_Defaults
52908>>>>>        Forward Send Field_Defaults
52910>>>>>        //DDB-Generated-Code-Location
52910>>>>>        //DDB-FieldDefaultStart
52910>>>>>        //DDB-FieldDefaultEnd
52910>>>>>    End_Procedure    // Field_Defaults
52911>>>>>
52911>>>>>End_Class    // Hmctyp_DataDictionary
52912>>>>>//DDB-FileEnd
52912>>>    use  hmgio.sl
52912>>>    use  sl100.sl
52912>>>    USE SL002.SL
52912>>>    //AB-StoreTopEnd
52912>>>
52912>>>    //AB-IgnoreStart
52912>>>
52912>>>    Use Rptvw.Sub
52912>>>    Use Group.Sub
52912>>>    Use Form.Sub
52912>>>    Use Txtbox.Sub
52912>>>    Use Rgroup.Sub
52912>>>    Use Radio.Sub
52912>>>    Use Line.Sub
52912>>>    Use Button.Sub
52912>>>
52912>>>    //AB-IgnoreEnd
52912>>>
52912>>>    ACTIVATE_VIEW Activate_r6_4G FOR r6_4G
52916>>>
52916>>>    Object r6_4G is a ReportViewSub
52918>>>
52918>>>        //AB-StoreTopStart
52918>>>        Property Integer Sort_IndexR6_4 Public 1
52920>>>        property string psdatetor6_4##
52922>>>        property string psdatefromr6_4##
52924>>>        property string pscustfromr6_4##
52926>>>        property string pscusttor6_4##
52928>>>        property string psctypkinfromr6_4##
52930>>>        property string psctypkintor6_4##
52932>>>        property number xapo## public 0
52934>>>        property number papo## public 0
52936>>>        property number fpa## public 0
52938>>>        property string psbranch public ''
52940>>>        property number net## public 0
52942>>>        property integer pisub## public 0
52944>>>        property integer picount##
52946>>>        property integer epilr6_4## public 0
52948>>>        property integer pifragma##
52950>>>        Property integer piHmgio## Public 0
52952>>>        Property String psModule Public ''
52954>>>        
52954>>>        property number xapoHMER## public 0
52956>>>        property number papoHMER## public 0
52958>>>        property number fpaHMER## public 0
52960>>>        property number netHMER## public 0
52962>>>        
52962>>>        
52962>>>        //AB-StoreTopEnd
52962>>>
52962>>>        Set Label to "†£œ¨¦¢¦š ˜¡âª ‰ ¤ã©œ ª    "
52963>>>        Set Size to 229 293
52964>>>        Set Location to 7 31
52965>>>
52965>>>        //AB-DDOStart
52965>>>
52965>>>
52965>>>        //AB-DDOEnd
52965>>>
52965>>>        Object GroupSub1 is a GroupSub
52967>>>            Set Label to "„§ ¢¦šã ”¦¨âà¤"
52968>>>            Set Size to 46 280
52969>>>            Set Location to 2 3
52970>>>            Object frcustfrom is a FormSub
52972>>>
52972>>>                //AB-StoreTopStart
52972>>>                                                                                                                                                                                                                                                                                                                                                                                        
52972>>>                //AB-StoreTopEnd
52972>>>
52972>>>                Set Size to 13 71
52973>>>                Set Location to 10 60
52974>>>                Set Label_Col_Offset to 2
52975>>>                Set Label_Justification_Mode to jMode_Right
52976>>>                Set Prompt_Button_Mode to pb_PromptOn
52977>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
52978>>>
52978>>>                //AB-StoreStart
52978>>>                Set Prompt_Object to (Sl100(Current_object))
52979>>>                Procedure Prompt_Callback integer hPrompt
52981>>>                    set Export_Column of hPrompt to 0
52982>>>                    Set Initial_Column of hPrompt to 0
52983>>>                
52983>>>                end_procedure
52984>>>                
52984>>>                procedure onchange
52986>>>                    string sclient
52987>>>                    get value item 0 to sclient
52988>>>                    Move (fsclient(Self,sclient)) to sclient
52989>>>                    set value of (formsub5(self)) to sclient
52990>>>                end_procedure
52991>>>                
52991>>>                procedure prompt
52993>>>                    Set psModule Of (sl100(Self)) to (psModule(Self))
52994>>>                    Forward Send Prompt
52996>>>                end_procedure
52997>>>                
52997>>>                
52997>>>                
52997>>>                
52997>>>                
52997>>>                
52997>>>                
52997>>>                
52997>>>                
52997>>>                
52997>>>                
52997>>>                
52997>>>                
52997>>>                //AB-StoreEnd
52997>>>
52997>>>            End_Object    // frcustfrom
52998>>>
52998>>>            Object frcustto is a FormSub
53000>>>
53000>>>                //AB-StoreTopStart
53000>>>                                                                                                                                                                                                                                                                                                                                                                                        
53000>>>                //AB-StoreTopEnd
53000>>>
53000>>>                Set Size to 13 71
53001>>>                Set Location to 29 60
53002>>>                Set Label_Col_Offset to 2
53003>>>                Set Label_Justification_Mode to jMode_Right
53004>>>                Set Prompt_Button_Mode to pb_PromptOn
53005>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
53006>>>
53006>>>                //AB-StoreStart
53006>>>                Set Prompt_Object to (Sl100(Current_object))
53007>>>                Procedure Prompt_Callback integer hPrompt
53009>>>                    set Export_Column of hPrompt to 0
53010>>>                    Set Initial_Column of hPrompt to 0
53011>>>                end_procedure
53012>>>                
53012>>>                
53012>>>                procedure onchange
53014>>>                    string sclient
53015>>>                    get value item 0 to sclient
53016>>>                    Move (fsclient(Self,sclient)) to sclient
53017>>>                    set value of (formsub6(self)) to sclient
53018>>>                end_procedure
53019>>>                
53019>>>                procedure prompt
53021>>>                    Set psModule Of (sl100(Self)) to (psModule(Self))
53022>>>                    Forward Send Prompt
53024>>>                end_procedure
53025>>>                
53025>>>                
53025>>>                
53025>>>                
53025>>>                
53025>>>                
53025>>>                
53025>>>                //AB-StoreEnd
53025>>>
53025>>>            End_Object    // frcustto
53026>>>
53026>>>            Object TextBoxSub1 is a TextBoxSub
53028>>>                Set Label to "€§æ ‰à› ¡æ :"
53029>>>                Set Auto_Size_State to FALSE
53030>>>                Set FontSize to 4 0
53031>>>                Set Location to 10 5
53032>>>                Set Size to 10 48
53033>>>                Set TypeFace to "MS Sans Serif"
53034>>>                Set Enabled_State to TRUE
53035>>>            End_Object    // TextBoxSub1
53036>>>
53036>>>            Object TextBoxSub2 is a TextBoxSub
53038>>>                Set Label to "„àª ‰à› ¡æ :"
53039>>>                Set Auto_Size_State to FALSE
53040>>>                Set FontSize to 4 0
53041>>>                Set Location to 27 5
53042>>>                Set Size to 13 47
53043>>>                Set TypeFace to "MS Sans Serif"
53044>>>                Set Enabled_State to TRUE
53045>>>            End_Object    // TextBoxSub2
53046>>>
53046>>>            Object FormSub5 is a FormSub
53048>>>                Set Size to 13 143
53049>>>                Set Location to 10 133
53050>>>                Set Label_Col_Offset to 2
53051>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
53052>>>
53052>>>                //AB-StoreStart
53052>>>                set enabled_state to false
53053>>>                //AB-StoreEnd
53053>>>
53053>>>            End_Object    // FormSub5
53054>>>
53054>>>            Object FormSub6 is a FormSub
53056>>>                Set Size to 13 143
53057>>>                Set Location to 29 133
53058>>>                Set Label_Col_Offset to 2
53059>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
53060>>>
53060>>>                //AB-StoreStart
53060>>>                set enabled_state to false
53061>>>                //AB-StoreEnd
53061>>>
53061>>>            End_Object    // FormSub6
53062>>>
53062>>>        End_Object    // GroupSub1
53063>>>
53063>>>        Object GroupSub3 is a GroupSub
53065>>>            Set Label to "„§ ¢¦šã †£œ¨¦¢¦šå¦¬"
53066>>>            Set Size to 29 279
53067>>>            Set Location to 49 3
53068>>>            Object FormSub3 is a FormSub
53070>>>                Set Size to 13 62
53071>>>                Set Location to 12 61
53072>>>                Set Label_Col_Offset to 2
53073>>>                Set Prompt_Button_Mode to pb_PromptOn
53074>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
53075>>>
53075>>>                //AB-StoreStart
53075>>>                Set Prompt_Object to (hmgio(Current_object))
53076>>>                Set Numeric_Mask Item 0 to 2 0 '*, '
53077>>>                Procedure Prompt_Callback integer hPrompt
53079>>>                    set Export_Column of hPrompt to 0
53080>>>                    Set Initial_Column of hPrompt to 0
53081>>>                end_procedure
53082>>>                
53082>>>                procedure onchange
53084>>>                    string whmgio
53085>>>                    get value item 0 to whmgio
53086>>>                    move whmgio to hmgio.hmgio_code
53087>>>                    find eq hmgio by index.1
53088>>>>
53088>>>                    if (found);                        set value of (formsub4(self)) to hmgio.hmgio_descr
53091>>>                    else;                        set value of (formsub4(self)) to ''
53093>>>                end_procedure
53094>>>                
53094>>>                
53094>>>                procedure prompt
53096>>>                    set psmodule of (hmgio(self)) to (psmodule(self))
53097>>>                    forward send prompt
53099>>>                end_procedure
53100>>>                
53100>>>                
53100>>>                
53100>>>                //AB-StoreEnd
53100>>>
53100>>>            End_Object    // FormSub3
53101>>>
53101>>>            Object FormSub4 is a FormSub
53103>>>                Set Size to 13 144
53104>>>                Set Location to 11 126
53105>>>                Set Label_Col_Offset to 2
53106>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
53107>>>
53107>>>                //AB-StoreStart
53107>>>                set enabled_state to false
53108>>>                //AB-StoreEnd
53108>>>
53108>>>            End_Object    // FormSub4
53109>>>
53109>>>        End_Object    // GroupSub3
53110>>>
53110>>>        Object GroupSub2 is a GroupSub
53112>>>            Set Label to "„§ ¢¦šã †£œ¨¦£ž¤å˜ª ‰ ¤ã©œà¤"
53113>>>            Set Size to 28 280
53114>>>            Set Location to 81 3
53115>>>            Object FormSub1 is a FormSub
53117>>>
53117>>>                //AB-StoreTopStart
53117>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
53117>>>                //AB-StoreTopEnd
53117>>>
53117>>>                Set Size to 13 65
53118>>>                Set Location to 9 60
53119>>>                Set Label_Col_Offset to 2
53120>>>                Set Label_Justification_Mode to jMode_Right
53121>>>                Set Prompt_Button_Mode to pb_PromptOn
53122>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
53123>>>
53123>>>                //AB-StoreStart
53123>>>                set Form_Datatype item 0 to mask_date_window
53124>>>                set prompt_object to (ocalendar(self))
53125>>>                
53125>>>                
53125>>>                //AB-StoreEnd
53125>>>
53125>>>            End_Object    // FormSub1
53126>>>
53126>>>            Object FormSub2 is a FormSub
53128>>>
53128>>>                //AB-StoreTopStart
53128>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
53128>>>                //AB-StoreTopEnd
53128>>>
53128>>>                Set Size to 13 68
53129>>>                Set Location to 10 200
53130>>>                Set Label_Col_Offset to 2
53131>>>                Set Label_Justification_Mode to jMode_Right
53132>>>                Set Prompt_Button_Mode to pb_PromptOn
53133>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
53134>>>
53134>>>                //AB-StoreStart
53134>>>                set Form_Datatype item 0 to mask_date_window
53135>>>                set prompt_object to (ocalendar(self))
53136>>>                
53136>>>                
53136>>>                //AB-StoreEnd
53136>>>
53136>>>            End_Object    // FormSub2
53137>>>
53137>>>            Object TextBoxSub3 is a TextBoxSub
53139>>>                Set Label to "€§æ †£/¤å˜ :"
53140>>>                Set Auto_Size_State to FALSE
53141>>>                Set FontSize to 4 0
53142>>>                Set Location to 11 6
53143>>>                Set Size to 10 40
53144>>>                Set TypeFace to "MS Sans Serif"
53145>>>                Set Enabled_State to TRUE
53146>>>            End_Object    // TextBoxSub3
53147>>>
53147>>>            Object TextBoxSub4 is a TextBoxSub
53149>>>                Set Label to "„àª †£¤å˜  :"
53150>>>                Set Auto_Size_State to FALSE
53151>>>                Set FontSize to 4 0
53152>>>                Set Location to 11 149
53153>>>                Set Size to 10 47
53154>>>                Set TypeFace to "MS Sans Serif"
53155>>>                Set Enabled_State to TRUE
53156>>>            End_Object    // TextBoxSub4
53157>>>
53157>>>        End_Object    // GroupSub2
53158>>>
53158>>>        Object RadioGroupSub5 is a RadioGroupSub
53160>>>            Set Size to 54 77
53161>>>            Set Location to 113 2
53162>>>            Object Radio5 is a RadioSub
53164>>>                Set Label to "ƒ¨®"
53165>>>                Set Size to 10 26
53166>>>                Set Location to 10 5
53167>>>
53167>>>                //AB-StoreStart
53167>>>                set label to syscurxr.c_code0
53168>>>                //AB-StoreEnd
53168>>>
53168>>>            End_Object    // Radio5
53169>>>
53169>>>            Object Radio6 is a RadioSub
53171>>>                Set Label to "Œ¦£2"
53172>>>                Set Size to 10 32
53173>>>                Set Location to 25 5
53174>>>
53174>>>                //AB-StoreStart
53174>>>                set label to syscurxr.c_code00
53175>>>                
53175>>>                //AB-StoreEnd
53175>>>
53175>>>            End_Object    // Radio6
53176>>>
53176>>>            Object Radio7 is a RadioSub
53178>>>                Set Label to "Œ¦£3"
53179>>>                Set Size to 10 32
53180>>>                Set Location to 40 5
53181>>>
53181>>>                //AB-StoreStart
53181>>>                set label to syscurxr.c_coder
53182>>>                //AB-StoreEnd
53182>>>
53182>>>            End_Object    // Radio7
53183>>>
53183>>>
53183>>>            //AB-StoreStart
53183>>>                                    
53183>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
53185>>>                Forward Send Notify_Select_State  itoitem  ifromitem
53187>>>                If itoItem Eq 0 ;                    Set epilr6_4## to 1
53190>>>                Else If itoitem Eq 1;                    Set epilr6_4## to 1
53194>>>                Else If itoItem Eq 2 ;                    Set epilr6_4## to 1
53198>>>                //for augmentation
53198>>>            End_Procedure
53199>>>            
53199>>>            
53199>>>            
53199>>>            
53199>>>            
53199>>>            
53199>>>            
53199>>>            
53199>>>            
53199>>>            
53199>>>            
53199>>>            
53199>>>            
53199>>>            
53199>>>            //AB-StoreEnd
53199>>>
53199>>>        End_Object    // RadioGroupSub5
53200>>>
53200>>>        Object RadioGroupSub3 is a RadioGroupSub
53202>>>
53202>>>            //AB-StoreTopStart
53202>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
53202>>>            //AB-StoreTopEnd
53202>>>
53202>>>            Set Label to "’˜¥ ¤æ£ž©ž £œ "
53203>>>            Set Size to 42 136
53204>>>            Set Location to 169 93
53205>>>            Object RadioSub1 is a RadioSub
53207>>>                Set Size to 10 13
53208>>>                Set Location to 10 118
53209>>>            End_Object    // RadioSub1
53210>>>
53210>>>            Object RadioSub2 is a RadioSub
53212>>>                Set Size to 10 13
53213>>>                Set Location to 26 118
53214>>>            End_Object    // RadioSub2
53215>>>
53215>>>            Object TextBoxSub7 is a TextBoxSub
53217>>>                Set Label to "‰à› ¡æ  : "
53218>>>                Set Auto_Size_State to FALSE
53219>>>                Set FontSize to 4 0
53220>>>                Set Location to 10 5
53221>>>                Set Size to 12 97
53222>>>                Set TypeFace to "MS Sans Serif"
53223>>>                Set Enabled_State to TRUE
53224>>>            End_Object    // TextBoxSub7
53225>>>
53225>>>            Object TextBoxSub8 is a TextBoxSub
53227>>>                Set Label to "Ž¤¦£˜©å˜  : "
53228>>>                Set Auto_Size_State to FALSE
53229>>>                Set FontSize to 4 0
53230>>>                Set Location to 23 4
53231>>>                Set Size to 12 97
53232>>>                Set TypeFace to "MS Sans Serif"
53233>>>                Set Enabled_State to TRUE
53234>>>            End_Object    // TextBoxSub8
53235>>>
53235>>>
53235>>>            //AB-StoreStart
53235>>>            set enabled_state to false
53236>>>            Procedure Notify_Select_State  Integer iNewItem  Integer iOldItem
53238>>>                Forward Send Notify_Select_State  iNewItem  iOldItem
53240>>>                Set Sort_IndexR6_4  To (iNewItem + 1)
53241>>>            End_Procedure
53242>>>            
53242>>>            
53242>>>            
53242>>>            
53242>>>            //AB-StoreEnd
53242>>>
53242>>>        End_Object    // RadioGroupSub3
53243>>>
53243>>>        Object RadioGroupSub4 is a RadioGroupSub
53245>>>
53245>>>            //AB-StoreTopStart
53245>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
53245>>>            //AB-StoreTopEnd
53245>>>
53245>>>            Set Label to "„¡«ç&§à©ž"
53246>>>            Set Size to 42 78
53247>>>            Set Location to 169 3
53248>>>            Object RadioSub3 is a RadioSub
53250>>>                Set Size to 10 13
53251>>>                Set Location to 12 63
53252>>>            End_Object    // RadioSub3
53253>>>
53253>>>            Object RadioSub4 is a RadioSub
53255>>>                Set Size to 10 13
53256>>>                Set Location to 28 63
53257>>>            End_Object    // RadioSub4
53258>>>
53258>>>            Object TextBoxSub9 is a TextBoxSub
53260>>>                Set Label to "ŽŸæ¤ž :"
53261>>>                Set Auto_Size_State to FALSE
53262>>>                Set FontSize to 4 0
53263>>>                Set Location to 10 5
53264>>>                Set Size to 12 45
53265>>>                Set TypeFace to "MS Sans Serif"
53266>>>                Set Enabled_State to TRUE
53267>>>            End_Object    // TextBoxSub9
53268>>>
53268>>>            Object TextBoxSub10 is a TextBoxSub
53270>>>                Set Label to "„¡«¬§à«ãª : "
53271>>>                Set Auto_Size_State to FALSE
53272>>>                Set FontSize to 4 0
53273>>>                Set Location to 24 5
53274>>>                Set Size to 12 45
53275>>>                Set TypeFace to "MS Sans Serif"
53276>>>                Set Enabled_State to TRUE
53277>>>            End_Object    // TextBoxSub10
53278>>>
53278>>>
53278>>>            //AB-StoreStart
53278>>>            Procedure Notify_Select_State  Integer iNewItem  Integer iOldItem
53280>>>                Forward Send Notify_Select_State  iNewItem  iOldItem
53282>>>                If iNewItem EQ 0 Set Output_Device_Mode  To PRINT_TO_WINDOW
53285>>>                Else             Set Output_Device_Mode  To PRINT_TO_PRINTER
53287>>>            End_Procedure
53288>>>            //AB-StoreEnd
53288>>>
53288>>>        End_Object    // RadioGroupSub4
53289>>>
53289>>>        Object LineControlSub1 is a LineControlSub
53291>>>            Set Line_Style to lnSINGLE
53292>>>            Set Size to 2 288
53293>>>            Set Location to 113 0
53294>>>        End_Object    // LineControlSub1
53295>>>
53295>>>        Object ButtonSub1 is a ButtonSub
53297>>>
53297>>>            //AB-StoreTopStart
53297>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
53297>>>            //AB-StoreTopEnd
53297>>>
53297>>>            Set Label to "„¥¦›¦ª "
53298>>>            Set Size to 18 53
53299>>>            Set Location to 193 233
53300>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
53301>>>
53301>>>            //AB-StoreStart
53301>>>            Procedure OnClick
53303>>>                Send Request_Cancel
53304>>>            End_Procedure
53305>>>            //AB-StoreEnd
53305>>>
53305>>>        End_Object    // ButtonSub1
53306>>>
53306>>>        Object ButtonSub2 is a ButtonSub
53308>>>
53308>>>            //AB-StoreTopStart
53308>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
53308>>>            //AB-StoreTopEnd
53308>>>
53308>>>            Set Label to "„¡«â¢œ©ž"
53309>>>            Set Size to 18 53
53310>>>            Set Location to 171 233
53311>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
53312>>>
53312>>>            //AB-StoreStart
53312>>>            Procedure OnClick
53314>>>            
53314>>>                integer epil## listatus## whmgio
53315>>>                string dateapo## dateeos## msgstr
53315>>>            
INCLUDING FILE: RVIR6_4B.PKG
/HEADERR6_4
Image 2, HEADERR6_4
!                                                                                                         ‘œ¢å›˜:  ___
„«˜ ¨å˜: ________________________          “§¦¡˜«á©«ž£˜: _________________________                          •¨ã©ž :  __________
                                           _______________________________________
                                           ________________________________________________________   Œæ£ ©£˜ Report ____
                                           †£œ¨¦£.„¡«ç§à©žª:  __/__/____
  --------------------------------------------------------------------------------------------------------------------------------------
„§ ¢¦šã †£œ¨¦£ž¤å˜ª - €§æ [__/__/____]  „àª [__/__/____]
 †£œ¨/¤å˜  ˜¨˜©«˜« ¡æ           ‰à› ¡æª        „§à¤¬£å˜                          ¦©æ          ”..€           •¨âà©ž         å©«à©ž
----------------------------------------------------------------------------------------------------------------------------------------
/SubHeaderR6_4
Image 3, SUBHEADERR6_4
/bodyr6_4
Image 4, BODYR6_4
__/__/__  _____________________ _______________ ________________________ _ ___,___,___.__  __,___,___.__  ___,___,___.__  ___,___,___.__
/Bodyr6_4a
Image 5, BODYR6_4A
                                                  ________________________ ___,___,___.__  __,___,___.__  ___,___,___.__  ___,___,___.__
/subtotalr6_4
Image 6, SUBTOTALR6_4
----------------------------------------------------------------------------------------------------------------------------------------
                                  ‘ç¤¦¢˜  †£â¨˜ª : __/__/__                ___,___,___.__  __,___,___.__  ___,___,___.__  ___,___,___.__
/totalr6_4
Image 7, TOTALR6_4
========================================================================================================================================
                                  ‚œ¤ ¡á ‘ç¤¦¢˜  :                         ___,___,___.__  __,___,___.__  ___,___,___.__  ___,___,___.__
========================================================================================================================================
!
/FooterR6_4
Image 8, FOOTERR6_4
/*
53315>>>>
53315>>>            
53315>>>            
53315>>>                move 0 to listatus##
53316>>>                Get value of (formsub1(GroupSub2(Self)))    item 0 to dateapo##
53317>>>                Get value of (formsub2(GroupSub2(Self)))    item 0 to dateeos##
53318>>>                Get value of (formsub3(GroupSub3(Self)))    item 0 to whmgio
53319>>>                if (whmgio = 0) begin
53321>>>                      move "" to msgstr
53322>>>                      move 1 to listatus##
53323>>>                      move "‘­á¢£˜ !! ƒâ¤ „§ ¢â¥˜«œ †£œ¨¦¢æš ¦ !!" to msgstr 
53324>>>                      error 999 msgstr
53325>>>>
53325>>>                end
53325>>>>
53325>>>                     if (dateapo## ne "") begin
53327>>>                       if ((dateapo## < syscurxr.year_xrhshfrom) or (dateapo## > syscurxr.year_xrhshto)) begin
53329>>>                          move "" to msgstr
53330>>>                          move 1 to listatus##
53331>>>                          move "†£/¤åœª „§ ¢¦šãª „¡«æª Ž¨åà¤ •¨ã©žª" to msgstr 
53332>>>                          error 999 msgstr
53333>>>>
53333>>>            
53333>>>                       end
53333>>>>
53333>>>                     end
53333>>>>
53333>>>            
53333>>>                      if (dateeos## ne "") begin
53335>>>                       if ((dateeos## < syscurxr.year_xrhshfrom) or (dateeos## > syscurxr.year_xrhshto)) begin
53337>>>                          move "" to msgstr
53338>>>                           move 1 to listatus##
53339>>>                          move "†£/¤åœª „§ ¢¦šãª „¡«æª Ž¨åà¤ •¨ã©žª" to msgstr 
53340>>>                          error 999 msgstr
53341>>>>
53341>>>                       end
53341>>>>
53341>>>                      end
53341>>>>
53341>>>               if (listatus## = 0) begin
53343>>>                     Send startreport
53344>>>               end
53344>>>>
53344>>>            
53344>>>            
53344>>>            End_Procedure
53345>>>            
53345>>>            
53345>>>            
53345>>>            
53345>>>            
53345>>>            
53345>>>            
53345>>>            
53345>>>            
53345>>>            
53345>>>            
53345>>>            
53345>>>            
53345>>>            
53345>>>            
53345>>>            
53345>>>            
53345>>>            
53345>>>            
53345>>>            
53345>>>            
53345>>>            
53345>>>            //AB-StoreEnd
53345>>>
53345>>>        End_Object    // ButtonSub2
53346>>>
53346>>>
53346>>>        //AB-StoreStart
53346>>>        //Set Verify_Exit_Msg To Get_No_Confirmation
53346>>>        Procedure Activate_View Returns Integer
53348>>>            String sStr sModule StrDisp
53349>>>            Integer rVal
53349>>>        
53349>>>            set value of (formsub1(groupsub2(current_object))) to syscurxr.year_xrhshfrom
53350>>>            set value of (formsub2(groupsub2(current_object))) to syscurxr.year_xrhshto
53351>>>            Forward Get Msg_Activate_View to rVal
53353>>>            Get psMenuModule  Of Main_Menu  to sModule
53354>>>            Set psModule                    to sModule
53355>>>        
53355>>>            // ‰à› ¡˜ª §¦¬ ˜­¦¨˜ «¦ constrain «à¤ ©«¦ ®œ à¤ «¦¬ view ¦§àª §˜¨˜©«˜« ¡á
53355>>>            // ž ¡ ¤ã©œ ª §¦¬ „„ˆ ¤˜ œå¤˜  constrain ˜¤˜¢¦š˜ £œ «¦ ¡ç¡¢à£˜ ˜§¦
53355>>>            // «¦ ¦§¦ ¦ ¡˜¢œå«˜  «¦ view. .•. ˜¤ ¡¢žŸœå ˜§¦ à¢ã©œ ª/œ¢á«œª ¤˜ £ž¤
53355>>>            // ­˜å¤¦¤«˜  ©«˜ §˜¨˜©«˜« ¡á «˜ ctypkin €š¦¨é¤ ¡¢§....
53355>>>        
53355>>>            if (psmodule(self) = "01");                 set label of r6_4g to "†£œ¨¦¢¦š ˜¡âª ‰ ¤ã©œ ª œ¢˜«é¤              "
53358>>>            if (psmodule(self) = "02");                 set label of r6_4g to "†£œ¨¦¢¦š ˜¡âª ‰ ¤ã©œ ª ¨¦£žŸœ¬«é¤          "
53361>>>        
53361>>>            if (psmodule(self) = "01");                 Set Report_Title of (Hmerologio_BasicReport(self)) to  "†£œ¨¦¢¦š ˜¡âª ‰ ¤ã©œ ª œ¢˜«é¤                      "
53364>>>            if (psmodule(self) = "02");                 Set Report_Title of (Hmerologio_BasicReport(self)) to  "†£œ¨¦¢¦š ˜¡âª ‰ ¤ã©œ ª ¨¦£žŸœ¬«é¤                   "
53367>>>        End_Procedure
53368>>>        Procedure StartReport
53370>>>            Integer iOutputDevice
53371>>>        
53371>>>            String  FileName
53371>>>            string lsdatetor6_4##
53371>>>            string lsdatefromr6_4##
53371>>>            string lsctypkinfromr6_4##
53371>>>            string lsctypkintor6_4##
53371>>>            string limonthr6_4##
53371>>>            string lscustfromr6_4##
53371>>>            string lscusttor6_4##
53371>>>            integer lizeror6_4##
53371>>>            integer epil##
53371>>>            string datehh## datemm## dateyy## dateapo## dateeos##
53371>>>            Integer iiHmgio##
53371>>>        
53371>>>            Get Output_Device_Mode To iOutputDevice
53372>>>            If iOutputDevice EQ PRINT_TO_WINDOW Begin
53374>>>               Make_Temp_File "TXT" FileName
53375>>>               Move (".\" - FileName)  To FileName
53376>>>               Set Output_Device_Name  To FileName
53377>>>            End
53377>>>>
53377>>>            Else ;            Set Output_Device_Name  To "Lpt1:"
53379>>>        
53379>>>           // Collection Of selection Criteria from VIEW
53379>>>           Get value of (frcustfrom(GroupSub1(Self)))    item 0 to lscustfromr6_4##
53380>>>           Get value of (frcustto(GroupSub1(Self)))      item 0 to lscusttor6_4##
53381>>>           Get value of (FormSub1(GroupSub2(Self)))      item 0 to lsDatefromr6_4##
53382>>>           Get value of (FormSub2(GroupSub2(Self)))      item 0 to lsDatetor6_4##
53383>>>           Get value of (FormSub3(GroupSub3(Self)))      item 0 to iiHmgio## //HMGIO
53384>>>           set pscustfromr6_4##         to lscustfromr6_4##
53385>>>           set pscusttor6_4##           to lscusttor6_4##
53386>>>           set psctypkinfromr6_4##      to lsctypkinfromr6_4##
53387>>>           Set piHmgio## to iiHmgio##
53388>>>        
53388>>>           get epilr6_4##               to epil##
53389>>>           move lsdatetor6_4##          to dateeos##
53390>>>           move lsdatefromr6_4##        to dateapo##
53391>>>           if (dateeos## eq 0) begin
53393>>>             move 31 to datehh##
53394>>>             move 12 to datemm##
53395>>>             move syscurxr.year_year    to dateyy##
53396>>>             Append dateeos## datehh##
53397>>>             append dateeos## datemm##
53398>>>             append dateeos## dateyy##
53399>>>            end
53399>>>>
53399>>>        
53399>>>            if (dateapo## eq 0) begin
53401>>>              move 01 to datehh##
53402>>>              move 01 to datemm##
53403>>>              move syscurxr.year_year  to dateyy##
53404>>>              append dateapo## datehh##
53405>>>              append dateapo## "/"
53406>>>              append dateapo## datemm##
53407>>>              append dateapo## "/"
53408>>>              append dateapo## dateyy##
53409>>>           end
53409>>>>
53409>>>           set psdatefromr6_4## to dateapo##
53410>>>           set psdatetor6_4##   to dateeos##
53411>>>        //   ------------------------------------------------------------------------------
53411>>>        
53411>>>           Send Run_Report
53412>>>           If iOutputDevice EQ PRINT_TO_WINDOW Begin
53414>>>               RunProgram background "notepad" FileName
53415>>>               EraseFile FileName
53416>>>>
53416>>>            End
53416>>>>
53416>>>        End_Procedure
53417>>>        
53417>>>        
53417>>>        Object Hmerologio_BasicReport is a BasicReport
53419>>>        
53419>>>                Object Ctypkin_DD is a Ctypkin_DataDictionary
53421>>>                End_Object    // Ctypkin_DD
53422>>>        
53422>>>                Object Hmgio_DD is a Hmgio_DataDictionary
53424>>>                End_Object    // Hmgio_DD
53425>>>        
53425>>>                Object HmCtyp_DD is a HmCtyp_DataDictionary
53427>>>                    Set DDO_Server to (Ctypkin_DD(Self))
53428>>>                    Set DDO_Server to (Hmgio_DD(Self))
53429>>>                    Begin_Constraints
53431>>>                        Integer iHmgio##
53432>>>                        get piHmgio##    to iHmgio##
53433>>>                        if iHmgio## ne 0 Constrain Hmctyp.Hmgio_code eq iHmgio##
53437>>>                    End_Constraints
53440>>>                End_Object    // HmCtyp_DD
53441>>>        
53441>>>        
53441>>>                Object Cmoves_DD is a Cmoves_DataDictionary
53443>>>                   Property String psRecr Public ''
53445>>>                   Function fiMasKanei Returns Integer
53447>>>                        Integer rVal
53448>>>                        If cmoves.ctypkin_Recr In (psRecr(Self)) Move 1 to rVal
53451>>>                        Else Move 0 to rval
53453>>>                        Function_Return rVal
53454>>>                    End_Function
53455>>>                   begin_constraints
53457>>>                     date ddate
53458>>>                     string lscustfromr6_4## lscusttor6_4## lsdatetor6_4##
53458>>>                     string lsctypkinfromr6_4## lsctypkintor6_4##
53458>>>                     get psdatetor6_4##       to lsdatetor6_4##
53459>>>                     get pscustfromr6_4##     to lscustfromr6_4##
53460>>>                     get pscusttor6_4##       to lscusttor6_4##
53461>>>                     get psctypkinfromr6_4##  to lsctypkinfromr6_4##
53462>>>                     get psctypkintor6_4##    to lsctypkintor6_4##
53463>>>                     if  (lscustfromr6_4##<>'') set ordering to 13
53466>>>                     else                       set ordering to 3
53468>>>                     Constrain cmoves.company_code eq syscurxr.company_code
53470>>>                     Constrain cmoves.branch_code  eq syscurxr.branch_code
53472>>>                     Constrain cmoves.year_year    eq syscurxr.year_year
53474>>>                     move syscurxr.year_xrhshfrom to ddate
53475>>>                     constrain cmoves.cmoves_hmnia ge ddate
53477>>>        
53477>>>                     if lscustfromr6_4##    ne "" Constrain cmoves.client_id ge lscustfromr6_4##
53481>>>                     if lscusttor6_4##      ne "" Constrain cmoves.client_id le lscusttor6_4##
53485>>>                     if lsdatetor6_4##      ne "" Constrain cmoves.cmoves_hmnia le lsdatetor6_4##
53489>>>                     Constrain cmoves As (fiMasKanei(self)=1)
53490>>>                   end_constraints
53493>>>        
53493>>>                End_Object
53494>>>        
53494>>>            Set Server To (cmoves_DD(Current_Object))
53495>>>        
53495>>>            report_breaks cmoves.cmoves_hmnia
53508>>>        
53508>>>            Function Starting_Report Returns Integer
53510>>>              set xapo## to 0
53511>>>              set papo## to 0
53512>>>              set fpa##  to 0
53513>>>              set net##  to 0
53514>>>              set picount## to 0
53515>>>              set pifragma## to 0
53516>>>              set xapoHMER## to 0
53517>>>              set papoHMER## to 0
53518>>>              set fpaHMER##  to 0
53519>>>              set netHMER##  to 0
53520>>>              Zero_SubTotals subtotalr6_4.2  subtotalr6_4.3  subtotalr6_4.4  subtotalr6_4.5
53524>>>              Zero_SubTotals totalr6_4.1 totalr6_4.2 totalr6_4.3  totalr6_4.4
53528>>>              Zero_SubTotals bodyr6_4a.2 bodyr6_4a.3 bodyr6_4a.4  bodyr6_4a.5
53532>>>            End_Function
53533>>>        
53533>>>        
53533>>>            Function Starting_Main_Report Returns Integer
53535>>>              Local Integer iRetVal
53536>>>              string sstr
53536>>>              move '' to sstr
53537>>>              set xapo## to 0
53538>>>              set papo## to 0
53539>>>              set fpa##  to 0
53540>>>              set net##  to 0
53541>>>              set picount## to 0
53542>>>              set pifragma## to 0
53543>>>        
53543>>>              Zero_SubTotals subtotalr6_4.2  subtotalr6_4.3  subtotalr6_4.4  subtotalr6_4.5
53547>>>              Zero_SubTotals totalr6_4.1 totalr6_4.2 totalr6_4.3  totalr6_4.4
53551>>>              Zero_SubTotals bodyr6_4a.2 bodyr6_4a.3 bodyr6_4a.4  bodyr6_4a.5
53555>>>        
53555>>>        //      blankform bodyr6_4a.1 thru bodyr6_4a.5
53555>>>              blankform bodyr6_4.1 thru bodyr6_4.9
53556>>>>
53556>>>        //      blankform subtotalr6_4.1 thru subtotalr6_4.5
53556>>>        //      blankform totalr6_4.1    thru totalr6_4.4
53556>>>              Forward Get Starting_Main_Report to iRetval
53558>>>        
53558>>>              set page_end to 60
53559>>>              set page_feed  to 66
53560>>>              Send Rebuild_Constraints to Hmgio_DD
53561>>>              Send Rebuild_Constraints to HmCtyp_DD
53562>>>              Send Find to Hmctyp_dd First_Record 1
53563>>>              While (Found)
53567>>>                    Append sStr Hmctyp.ctypkin_recr ','
53569>>>                    Send Find to Hmctyp_dd Next_Record 1
53570>>>              Loop
53571>>>>
53571>>>              Set psRecr of cmoves_DD to sStr
53572>>>              Send Rebuild_Constraints to Cmoves_DD
53573>>>              Send Find to (cmoves_dd(self)) First_Record 3
53574>>>              Report_Index BY 3 //hmeromhnia eggrafon
53576>>>            End_Function
53577>>>        
53577>>>           Procedure_Section Page_Top as Headerr6_4
53582>>>              Local Integer iPage ihmgio##
53582>>>              string lsvalue## epil##
53582>>>              date ddate
53582>>>              sysdate4 ddate
53583>>>              get epilr6_4## to epil##
53584>>>              get piHmgio##    to iHmgio##
53585>>>              Get Page_Count to headerr6_4.1
53586>>>              move syscurxr.company_name to headerr6_4.2
53587>>>              move syscurxr.branch_name   to headerr6_4.3
53588>>>              move syscurxr.year_year       to headerr6_4.4
53589>>>              if (psmodule(self)='01') ;                 print '†‹„ŽŠŽ‚ˆ€‰„‘ ‰ˆŒ†‘„ˆ‘ „Š€’—Œ' to headerr6_4.5
53592>>>              else ;                 print '†‹„ŽŠŽ‚ˆ€‰„‘ ‰ˆŒ†‘„ˆ‘ Ž‹†‡„“’—Œ' to headerr6_4.5
53594>>>              move (trim(hmgio.hmgio_descr)) to  headerr6_4.6
53595>>>              case Begin
53595>>>                    Case (epil## = 1)
53597>>>                      print syscurxr.c_code0 to headerr6_4.7
53598>>>                      Case Break
53599>>>                    Case (epil## = 2)
53602>>>                      print syscurxr.c_code0 to headerr6_4.7
53603>>>                      Case Break
53604>>>                    Case (epil## = 3)
53607>>>                      print syscurxr.c_code0 to headerr6_4.7
53608>>>                     Case Break
53609>>>        
53609>>>              Case End
53609>>>              move ddate           to headerr6_4.8
53610>>>              get psdatefromr6_4## to headerr6_4.9
53611>>>              get psdatetor6_4##   to headerr6_4.10
53612>>>              OutPut_PageCheck
53613>>>           End_Procedure
53614>>>        
53614>>>           Procedure_Section SubHeader1 as Subheaderr6_4
53619>>>               OutPut_PageCheck
53620>>>           end_procedure
53621>>>        
53621>>>           Procedure_Section  Body as Bodyr6_4
53626>>>        
53626>>>               number xre## pis## xtot##  nfpa## nnet## nexo##  xrehmer## pishmer##  nfpahmer## nnethmer##
53626>>>               integer lisub## epil## licount##
53626>>>               string lsdatefromr6_4## lsdatetor6_4##
53626>>>               get psdatefromr6_4## to lsdatefromr6_4##
53627>>>               get psdatetor6_4##   to lsdatetor6_4##
53628>>>               get epilr6_4## to epil##
53629>>>                Integer iHmgio##
53629>>>                get piHmgio##    to iHmgio##
53630>>>                send update_status ('”¦¨â˜ª' + ":" + string(cmoves.client_id))
53631>>>                if (cmoves.cmoves_hmnia lt lsdatefromr6_4##) begin
53633>>>                       get xapo## to xre##
53634>>>                       get papo## to pis##
53635>>>                       get fpa## to nfpa##
53636>>>                       get net## to nnet##
53637>>>        
53637>>>                       if (epil## eq 1) begin
53639>>>                         add cmoves.cmoves_x0 to xre##
53640>>>                         add cmoves.cmoves_p0 to pis##
53641>>>                         add cmoves.cmove_totamad0  to nnet##
53642>>>                         add cmoves.cmove_vatam0    to nfpa##
53643>>>        
53643>>>                       end
53643>>>>
53643>>>                       set xapo## to xre##
53644>>>                       set papo## to pis##
53645>>>                       set net##  to nnet##
53646>>>                       set fpa##  to nfpa##
53647>>>                   end
53647>>>>
53647>>>                   else begin
53648>>>                       set pisub## to 1
53649>>>                   end
53649>>>>
53649>>>                   /////////////////////////
53649>>>                   relate cmoves
53650>>>                   get pisub## to lisub##
53651>>>                   get picount## to licount##
53652>>>                   if (lisub## = 1 and licount## = 0 ) begin
53654>>>                      set picount## to 1
53655>>>                      get xapo## to xre##
53656>>>                      get papo## to pis##
53657>>>                      get net## to nnet##
53658>>>                      get fpa## to nfpa##
53659>>>                      move "„¡ ‹œ«˜­¦¨áª" to bodyr6_4a.1
53660>>>                      print nnet## to bodyr6_4a.2
53661>>>                      print nfpa## to bodyr6_4a.3
53662>>>                      print xre## to bodyr6_4a.4
53663>>>                      print pis## to bodyr6_4a.5
53664>>>                      output bodyr6_4a
53665>>>                   end
53665>>>>
53665>>>                      if (lisub## = 1) begin
53667>>>                        print cmoves.cmoves_hmnia to bodyr6_4.1
53668>>>                        print ''                  to bodyr6_4.5
53669>>>                        print (trim(cmoves.cmoves_par)) to bodyr6_4.2
53670>>>                        print (trim(clients.client_id)) to bodyr6_4.3
53671>>>                        print (trim(clients.client_name)) to bodyr6_4.4
53672>>>                        get xapo## to xre##
53673>>>                        get papo## to pis##
53674>>>                        get fpa##  to nfpa##
53675>>>                        get net## to nnet##
53676>>>                        get xapohmer## to xrehmer##
53677>>>                        get papohmer## to pishmer##
53678>>>                        get fpahmer## to nfpahmer##
53679>>>                        get nethmer## to nnethmer##
53680>>>        
53680>>>                       if (epil## eq 1) begin
53682>>>                         print cmoves.cmoves_x0 to bodyr6_4.8
53683>>>                         print cmoves.cmoves_p0 to bodyr6_4.9
53684>>>                         print cmoves.cmove_totamad0 to bodyr6_4.6
53685>>>                         print cmoves.cmove_vatam0 to bodyr6_4.7
53686>>>                         add cmoves.cmoves_x0 to xrehmer##
53687>>>                         add cmoves.cmoves_p0 to pishmer##
53688>>>                         add cmoves.cmove_totamad0  to nnethmer##
53689>>>                         add cmoves.cmove_vatam0    to nfpahmer##
53690>>>        
53690>>>                         output_pagecheck
53691>>>        
53691>>>        
53691>>>                       set xapohmer## to xrehmer##
53692>>>                       set papohmer## to pishmer##
53693>>>                       set nethmer##  to nnethmer##
53694>>>                       set fpahmer##  to nfpahmer##
53695>>>        
53695>>>        
53695>>>        
53695>>>                       end
53695>>>>
53695>>>                        set fpa## to nfpa##
53696>>>                        set net## to nnet##
53697>>>                        set xapo## to xre##
53698>>>                        set papo## to pis##
53699>>>                     end
53699>>>>
53699>>>        
53699>>>        
53699>>>            End_Procedure
53700>>>        
53700>>>        
53700>>>           Procedure_Section  subtotal1 as subtotalr6_4
53705>>>               string lsdatetor6_4##
53705>>>               string lsdatefromr6_4##
53705>>>               integer epil## lisub## licount## lifragma##
53705>>>               number xre## pis## xtot## nfpa## nnet## nexo##
53705>>>               number xrehmer## pishmer## nfpahmer## nnethmer##
53705>>>        
53705>>>               get pisub## to lisub##
53706>>>               get epilr6_4## to epil##
53707>>>               get picount## to licount##
53708>>>               if (lisub## = 1 and licount## = 1) begin
53710>>>                      get  fpahmer## to nfpahmer##
53711>>>                      get  nethmer## to nnethmer##
53712>>>                      get xapohmer## to  xrehmer##
53713>>>                      get papohmer## to  pishmer##
53714>>>                      print    bodyr6_4.1 to subtotalr6_4.1
53715>>>                      print nnethmer## to SubtotalR6_4.2
53716>>>                      print nfpahmer## to SubtotalR6_4.3
53717>>>                      print xrehmer## to SubtotalR6_4.4
53718>>>                      print pishmer## to SubtotalR6_4.5
53719>>>                      output_pagecheck
53720>>>                      set  fpahmer## to  0
53721>>>                      set  nethmer## to  0
53722>>>                      set xapohmer## to  0
53723>>>                      set papohmer## to  0
53724>>>        
53724>>>        
53724>>>                   //   subtotal bodyr6_4.6 to SubtotalR6_4.2
53724>>>                   //   subtotal bodyr6_4.7 to SubtotalR6_4.3
53724>>>                   //   subtotal bodyr6_4.8 to SubtotalR6_4.4
53724>>>                   //   subtotal bodyr6_4.9 to SubtotalR6_4.5
53724>>>                   //   output_pagecheck
53724>>>               end
53724>>>>
53724>>>           end_Procedure
53725>>>        
53725>>>           Procedure_Section  total as totalr6_4
53730>>>               number xtot## xre## pis## nfpa## nexo## nnet##
53730>>>               get  xapo## to xre##
53731>>>               get papo## to pis##
53732>>>               get fpa## to nfpa##
53733>>>               get net## to nnet##
53734>>>               integer epil##
53734>>>               get epilr6_4## to epil##
53735>>>               Zero_SubTotals totalr6_4.1 totalr6_4.2 totalr6_4.3  totalr6_4.4
53739>>>               subtotal SubtotalR6_4.2 to totalr6_4.1
53741>>>               subtotal SubtotalR6_4.3 to totalr6_4.2
53743>>>               subtotal SubtotalR6_4.4 to totalr6_4.3
53745>>>               subtotal SubtotalR6_4.5 to totalr6_4.4
53747>>>               move (xre## + totalr6_4.3) to xre##
53748>>>               move (pis## + totalr6_4.4) to pis##
53749>>>               move (nnet## + totalr6_4.1) to nnet##
53750>>>               move (nfpa## + totalr6_4.2) to nfpa##
53751>>>        
53751>>>               print nnet## to totalr6_4.1
53752>>>               print nfpa## to totalr6_4.2
53753>>>               print  xre## to totalr6_4.3
53754>>>               print  pis## to totalr6_4.4
53755>>>               output_pagecheck
53756>>>          end_Procedure
53757>>>        
53757>>>           Procedure_Section Page_Bottom as Footerr6_4
53766>>>           End_Procedure
53767>>>        
53767>>>        
53767>>>           Procedure Ending_Report
53769>>>              blankform bodyr6_4a.1 thru bodyr6_4a.5
53770>>>>
53770>>>              blankform bodyr6_4.1 thru bodyr6_4.9
53771>>>>
53771>>>              blankform subtotalr6_4.1 thru subtotalr6_4.5
53772>>>>
53772>>>              blankform totalr6_4.1    thru totalr6_4.4
53773>>>>
53773>>>              set xapo## to 0
53774>>>              set papo## to 0
53775>>>              set fpa## to 0
53776>>>              set net## to 0
53777>>>              set pisub## to 0
53778>>>              set picount## to 0
53779>>>              set pifragma## to 0
53780>>>           End_Procedure
53781>>>        
53781>>>        
53781>>>        End_Object
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        
53782>>>        //AB-StoreEnd
53782>>>
53782>>>    End_Object    // r6_4G
53783>>>
53783>>>
53783>>>    //AB-StoreStart
53783>>>                                
53783>>>                                
53783>>>                                
53783>>>                                
53783>>>                                
53783>>>                                
53783>>>                                
53783>>>                                
53783>>>                                
53783>>>                                
53783>>>                                
53783>>>                                
53783>>>                                
53783>>>                                
53783>>>                                
53783>>>                                
53783>>>                                
53783>>>                                
53783>>>                                
53783>>>                                
53783>>>                                
53783>>>                                
53783>>>                                
53783>>>                                
53783>>>                                
53783>>>                                
53783>>>                                
53783>>>                                
53783>>>                                
53783>>>                                
53783>>>    //AB-StoreEnd
53783>>>
53783>>>//AB/     End_Object    // prj
53783>
53783>        //AB-ClientStoreStart
53783>        
53783>        
53783>        
53783>        
53783>        
53783>        //AB-ClientStoreEnd
53783>
53783>
53783>    End_Object  // Client_Area
53784>    
53784>    Use DFStdSbr.pkg //  Status-Bar object.
INCLUDING FILE: DFSTDSBR.PKG
53784>>>// 07/23/96 JJT - New Class names
53784>>>// Very prototype global status bar
53784>>>//
53784>>>Use dfMainSt.pkg
INCLUDING FILE: DFMAINST.PKG
53784>>>>>// 07/23/96 JJT - New Class names
53784>>>>>Use dfAstbar.pkg
53784>>>>>
53784>>>>>Class StatusBar is a AppStatusBar
53785>>>>>
53785>>>>>    Procedure Construct_Object
53786>>>>>       Forward Send Construct_Object
53788>>>>>       //
53788>>>>>       Send Add_Item 350  ''     // micro-help
53789>>>>>       Send Add_Item  40  'View:'
53790>>>>>       Set Item_Display_Style To sbNORMAL
53791>>>>>       Send Add_Item 200  ''     // view name
53792>>>>>       Send Add_Item   0  ''     // spring 'normal' to end
53793>>>>>       Set Item_Display_Style To sbNORMAL
53794>>>>>    End_Procedure // Construct_Object
53795>>>>>
53795>>>>>    Procedure Show_View_Name String sName
53796>>>>>        Set Value item 2 to sName
53797>>>>>    End_Procedure
53798>>>>>
53798>>>>>End_Class
53799>>>
53799>>>If (Wait(Self)) Send Deactivate to (Wait(Self))
53802>>>
53802>>>Object oStatusBarSub  is a StatusBar
53804>>>    Use DFTimer // DfTimer Manager Must Have a WindowHandle
53804>>>    
53804>>>    Property Integer piStdPanes Public (PaneCount(Self))
53806>>>    
53806>>>    //Set Value     Item 1 to (ToANSI("„§ ¢¦šã:"))
53806>>>    Set PaneWidth item 1 to 50
53807>>>    
53807>>>    Send AddPane 55  ""        sbLOWERED
53808>>>    Send AddPane 70  ""        sbLOWERED
53809>>>    Send AddPane 55  ""        sbLOWERED
53810>>>    
53810>>>    Procedure pTimer
53812>>>        String lsDay lsHour lsHH lsMM lsSS
53813>>>        Integer liStdPanes lbState
53813>>>    
53813>>>        Get piStdPanes to liStdPanes
53814>>>        Sysdate lsDay lsHH lsMM lsSS
53818>>>        If (Length(lsHH)=1) Insert "0" In lsHH At 1
53822>>>        If (Length(lsMM)=1) Insert "0" In lsMM At 1
53826>>>        If (Length(lsSS)=1) Insert "0" In lsSS At 1
53830>>>        Move (lsHH+":"+lsMM+":"+lsSS) to lsHour
53831>>>        Get Simple_state to lbState
53832>>>        If  Not (lbState) Begin
53834>>>            Set Value Item liStdPanes     to lsHour
53835>>>            Set Value Item (liStdPanes+1) to lsDay
53836>>>        End
53836>>>>
53836>>>    
53836>>>    End_Procedure // pTimer
53837>>>    
53837>>>    
53837>>>    Object oTimerObj Is A DFTimer
53839>>>        Set Timeout to 1000
53840>>>        Set Timer_Active_State to TRUE
53841>>>        Set Timer_Object to (oStatusBarSub(Current_Object))
53842>>>        Set Timer_Message to pTimer
53843>>>    End_Object // oTimerOdj
53844>>>End_Object // oStatusBar
53845>>>
53845>>>
53845>
53845>    //AB-PanelStoreStart
53845>    Use StdAbout.pkg // Standard "About" package.
INCLUDING FILE: STDABOUT.PKG
53845>>>//************************************************************************
53845>>>// Confidential Trade Secret.
53845>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
53845>>>// as an unpublished work.  All rights reserved.
53845>>>// DataFlex is a registered trademark of Data Access Corporation.
53845>>>//
53845>>>//************************************************************************
53845>>>//************************************************************************
53845>>>//
53845>>>// $File name  : StdAbout.pkg
53845>>>// $File title : Standard about object package for VDF
53845>>>// Notice      :
53845>>>// $Author(s)  : John Tuohy
53845>>>//
53845>>>// $Rev History
53845>>>//
53845>>>// JT 06/27/97   File created
53845>>>//************************************************************************
53845>>>
53845>>>// This provides a quick and simple way to create an about package for a program.
53845>>>// You need to create a message inside you client area called Activate_About.
53845>>>// Within this message you should send the message DoAbout passing needed
53845>>>// string information.
53845>>>//
53845>>>//       Procedure Activate_About
53845>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
53845>>>//       End_Procedure
53845>>>//    where: sTitle =     Name of application. If none provided, uses caption
53845>>>//                        bar title
53845>>>//           sVersion   = Version Line. If none provided, will be blank
53845>>>//           sCopyRight = Copyright Line. If none provided, will be blank
53845>>>//           sAuthor    = Author name, blank if none provided
53845>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
53845>>>//                        is used.
53845>>>// It is expected that you will place this in your own object package. For
53845>>>// example an order about package may look like this:
53845>>>//
53845>>>//   // OrderAbout.pkg
53845>>>//   Use StdAbout.pkg
53845>>>//   Procedure Activate_About
53845>>>//      Local String sTitle sCopyright sVersion sAuthor
53845>>>//      Move "My Order Entry System" to sTitle
53845>>>//      Move "Version 2.1" to sVersion
53845>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
53845>>>//      Move "John Smith"  to sAuthor
53845>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
53845>>>//   end_procedure
53845>>>//   // end of file.
53845>>>
53845>>>Use DfAbout.pkg
INCLUDING FILE: DFABOUT.PKG
53845>>>>>//************************************************************************
53845>>>>>// Confidential Trade Secret.
53845>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
53845>>>>>// as an unpublished work.  All rights reserved.
53845>>>>>// DataFlex is a registered trademark of Data Access Corporation.
53845>>>>>//
53845>>>>>//************************************************************************
53845>>>>>//************************************************************************
53845>>>>>//
53845>>>>>// $File name  : DfAbout.pkg
53845>>>>>// $File title : About class support
53845>>>>>// Notice      :
53845>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
53845>>>>>//
53845>>>>>// $Rev History
53845>>>>>//
53845>>>>>// JJT 11/5/98    Added version information
53845>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
53845>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
53845>>>>>//                workspace package.
53845>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
53845>>>>>//                class can create this object.
53845>>>>>//                Cleaned up the interface (used correct classes and messages)
53845>>>>>//                Added workspace reporting support to sys-info.
53845>>>>>//                Turned off wrapping in the sys-info editor.
53845>>>>>// KR  ??/??/96   File created
53845>>>>>//************************************************************************
53845>>>>>Use windows.pkg
53845>>>>>Use DFbitmap.pkg
53845>>>>>
53845>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
53846>>>>>
53846>>>>>//****************************************************************************
53846>>>>>// $Module type: FUNCTION
53846>>>>>// $Module name: Network_User_Name
53846>>>>>// $Author     : AK/VOO/KCR
53846>>>>>// Created     : 24-09-96 @ 19:17
53846>>>>>//
53846>>>>>// Description
53846>>>>>//    This function reads the current username of windows and returns that
53846>>>>>//    name or an text unknown user
53846>>>>>//
53846>>>>>// $Rev History
53846>>>>>//    24-09-96  Module header created
53846>>>>>//****************************************************************************
53846>>>>>Function Network_User_Name Returns String
53848>>>>>    Local String sName sLength
53849>>>>>    Local Pointer lpName_Addr lpLength_Addr
53849>>>>>    Local Integer iRetval
53849>>>>>
53849>>>>>    Movestr (Repeat (Character (0), 255)) To sName
53850>>>>>>
53850>>>>>    GetAddress Of sName To lpName_Addr
53851>>>>>    Movestr (DwordToBytes (255)) To sLength
53852>>>>>>
53852>>>>>    GetAddress Of sLength To lpLength_Addr
53853>>>>>
53853>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
53854>>>>>>
53854>>>>>
53854>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
53857>>>>>    Else Function_Return "User Unknown"
53859>>>>>End_Function // Network_User_Name
53860>>>>>
53860>>>>>Type MEMORYSTATUS
53860>>>>>   Field MEMORYSTATUS.dwLength         As Dword // sizeof(MEMORYSTATUS)
53860>>>>>   Field MEMORYSTATUS.dwMemoryLoad     As Dword // percent of memory in use
53860>>>>>   Field MEMORYSTATUS.dwTotalPhys      As Dword // bytes of physical memory
53860>>>>>   Field MEMORYSTATUS.dwAvailPhys      As Dword // free physical memory bytes
53860>>>>>   Field MEMORYSTATUS.dwTotalPageFile  As Dword // bytes of paging file
53860>>>>>   Field MEMORYSTATUS.dwAvailPageFile  As Dword // free bytes of paging file
53860>>>>>   Field MEMORYSTATUS.dwTotalVirtual   As Dword // user bytes of address space
53860>>>>>   Field MEMORYSTATUS.dwAvailVirtual   As Dword // free user bytes
53860>>>>>End_Type // MEMORYSTATUS
53860>>>>>
53860>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
53861>>>>>
53861>>>>>// If a global workspace object exists it will use this variable to store
53861>>>>>// its object id.
53861>>>>>
53861>>>>>Class SysinfoDisplay Is An Edit
53862>>>>>    Procedure Construct_Object
53863>>>>>        forward send construct_object
53865>>>>>
53865>>>>>        Set Location To 6 6
53866>>>>>        Set Size To 110 255
53867>>>>>        Set Read_Only_State To True
53868>>>>>        Set wrap_state to False
53869>>>>>    end_Procedure
53870>>>>>
53870>>>>>    //****************************************************************************
53870>>>>>    // $Module type: PROCEDURE
53870>>>>>    // $Module name: Add_Line
53870>>>>>    // $Author     : VOO
53870>>>>>    // Created     : 06-10-96 @ 15:23
53870>>>>>    //
53870>>>>>    // Description
53870>>>>>    //    This method will add a line to this edit object, it should go simpler
53870>>>>>    //    but it seems to be done this way.
53870>>>>>    //
53870>>>>>    // $Rev History
53870>>>>>    //    06-10-96  Module header created
53870>>>>>    //****************************************************************************
53870>>>>>    Procedure Add_Line String sVal
53871>>>>>        Local Integer iLine
53872>>>>>
53872>>>>>        Moveint (Line_Count (Current_Object)) To iLine
53873>>>>>>
53873>>>>>        If (iLine = 1 And Changed_State (Current_Object) = False) Moveint 0 To iLine
53876>>>>>        Set Value Item iLine To sVal
53877>>>>>    End_Procedure // Add_Line
53878>>>>>
53878>>>>>    //****************************************************************************
53878>>>>>    // $Module type: PROCEDURE
53878>>>>>    // $Module name: Show_Current_Directory
53878>>>>>    // $Author     : VOO
53878>>>>>    // Created     : 06-10-96 @ 15:24
53878>>>>>    //
53878>>>>>    // Description
53878>>>>>    //    This method will show the name of the current directory in the system
53878>>>>>    //    information box
53878>>>>>    //
53878>>>>>    // $Rev History
53878>>>>>    //    06-10-96  Module header created
53878>>>>>    //****************************************************************************
53878>>>>>    Procedure Show_Current_Directory
53879>>>>>        Local String sDir
53880>>>>>
53880>>>>>        Get_Current_Directory To sDir
53881>>>>>        Send Add_Line ("Current Directory: " + sDir)
53882>>>>>    End_Procedure // Show_Current_Directory
53883>>>>>
53883>>>>>    Procedure Show_Windows_Directory
53884>>>>>        Local String sWindir
53885>>>>>
53885>>>>>        Get_Windows_Directory To sWindir
53886>>>>>        Send Add_Line ("Windows Directory: " * sWindir)
53887>>>>>    End_Procedure // Show_Windows_Directory
53888>>>>>
53888>>>>>    Procedure Show_Current_User
53889>>>>>        Send Add_Line ("Network User Name: " * Network_User_Name (Current_Object))
53890>>>>>    End_Procedure // Show_Current_User
53891>>>>>
53891>>>>>    Procedure Show_Number_Format
53892>>>>>        Local Integer iFormat
53893>>>>>
53893>>>>>        Get_Attribute Df_Thousands_Separator To iFormat
53896>>>>>        Send Add_Line ('Thousands Separator: "' - Character (iFormat) - '" (' - String (iFormat) - ')')
53897>>>>>        Get_Number_Format To iFormat
53898>>>>>        Send Add_Line ('Decimal Separator: "' - If (iFormat = 0, '.', ',') - '"')
53899>>>>>    End_Procedure // Show_Number_Format
53900>>>>>
53900>>>>>    Procedure Show_Filelist_Name
53901>>>>>        Local String sFilename
53902>>>>>
53902>>>>>        Get_Attribute Df_Filelist_Name To sFilename
53905>>>>>        Send Add_Line ("Current Filelist: " * sFilename)
53906>>>>>    End_Procedure // Show_Filelist_Name
53907>>>>>
53907>>>>>    Procedure Show_Lock_Delay
53908>>>>>        Local Integer iLockdelay
53909>>>>>
53909>>>>>        Get_Attribute Df_Lock_Delay To iLockdelay
53912>>>>>        Send Add_Line ("Database Locking Delay: " * String (iLockdelay) * "Milliseconds")
53913>>>>>    End_Procedure // Show_Lock_Delay
53914>>>>>
53914>>>>>    Procedure Show_Lock_Timeout
53915>>>>>        Local Integer iLockTimeout
53916>>>>>
53916>>>>>        Get_Attribute Df_Lock_Timeout To iLockTimeout
53919>>>>>        Send Add_Line ("Database Locking Timeout: " * String (iLockTimeout) * "Milliseconds")
53920>>>>>    End_Procedure // Show_Lock_Timeout
53921>>>>>
53921>>>>>    Procedure Show_Screen_Size
53922>>>>>        Local Integer iYscreensize iXscreensize
53923>>>>>
53923>>>>>        Moveint (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
53924>>>>>>
53924>>>>>        Moveint (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
53925>>>>>>
53925>>>>>
53925>>>>>        Send Add_Line ("Video Resolution: " * String (iXscreensize) * "by" * String (iYscreensize))
53926>>>>>    End_Procedure // Show_Screen_Size
53927>>>>>
53927>>>>>    Procedure Show_Page_Size
53928>>>>>        Send Add_Line ("Page End: " * String (Pageend) * "Form Feed: " * String (Pagefeed))
53929>>>>>    End_procedure
53930>>>>>
53930>>>>>    Procedure Show_Date
53931>>>>>        Local Date dToday
53932>>>>>
53932>>>>>        Sysdate4 dToday
53933>>>>>        Send Add_Line ("Current System Date: " * String (dToday))
53934>>>>>    End_procedure // Show_Date
53935>>>>>
53935>>>>>    Procedure Show_Date_Format
53936>>>>>        Local Integer iDateFormat
53937>>>>>        Local String sDateFormat
53937>>>>>
53937>>>>>        Get_Attribute Df_Date_Format To iDateFormat
53940>>>>>        if iDateFormat Eq DF_DATE_USA ;            Movestr "USA" To sDateFormat
53943>>>>>        else if iDateformat Eq DF_DATE_EUROPEAN ;            Movestr "European" To sDateFormat
53947>>>>>        else if iDateformat Eq DF_DATE_MILITARY ;            Movestr "Military" To sDateFormat
53951>>>>>        else ;            Movestr "Unknown Date Type" To sDateFormat
53953>>>>>        Send Add_Line ("Date Format: " * sDateformat)
53954>>>>>    End_Procedure // Show_Date_Format
53955>>>>>
53955>>>>>    Procedure Show_Memavail
53956>>>>>        Local Integer iMem
53957>>>>>
53957>>>>>        Memory iMem
53958>>>>>>
53958>>>>>        Send Add_Line ("Available Memory: " * String (iMem))
53959>>>>>    End_Procedure // Show_Memavail
53960>>>>>
53960>>>>>    Procedure Show_Systemresources
53961>>>>>        Local String sMemoryStatus
53962>>>>>        Local Pointer lpsMemoryStatus
53962>>>>>        Local Integer iVoid
53962>>>>>        Local Dword dwMemoryLoad dwTotalPhys dwAvailPhys dwTotalPageFile dwAvailPageFile dwTotalVirtual dwAvailVirtual
53962>>>>>
53962>>>>>        ZeroType MEMORYSTATUS To sMemoryStatus
53963>>>>>        GetAddress Of sMemoryStatus To lpsMemoryStatus
53964>>>>>
53964>>>>>        Moveint (GlobalMemoryStatus (lpsMemoryStatus)) To iVoid
53965>>>>>>
53965>>>>>
53965>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwMemoryLoad    To dwMemoryLoad
53966>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPhys     To dwTotalPhys
53967>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPhys     To dwAvailPhys
53968>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPageFile To dwTotalPageFile
53969>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPageFile To dwAvailPageFile
53970>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalVirtual  To dwTotalVirtual
53971>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailVirtual  To dwAvailVirtual
53972>>>>>
53972>>>>>        Send Add_Line ("Current memory utilization:" * String (dwMemoryLoad))
53973>>>>>        Send Add_Line ("Percentage available physical memory:" * String (dwAvailPhys / dwTotalPhys * 100.0) - "%")
53974>>>>>        Send Add_Line ("Percentage available pagefile space:" * String (dwAvailPageFile / dwTotalPageFile * 100.0) - "%")
53975>>>>>        Send Add_Line ("Percentage available virtual memory:" * String (dwAvailVirtual / dwTotalVirtual * 100.0) - "%")
53976>>>>>    End_Procedure // Show_Systemresources
53977>>>>>
53977>>>>>    Procedure Show_Registration
53978>>>>>        Local String sRegName
53979>>>>>        Local Integer iSN
53979>>>>>        Registration sRegName iSN
53980>>>>>>
53980>>>>>
53980>>>>>        Send Add_Line ("Serial# : " + (String(iSN)))
53981>>>>>        Send Add_Line ("Reg Name: " + sRegName)
53982>>>>>
53982>>>>>    End_Procedure // Show_Current_Directory
53983>>>>>
53983>>>>>
53983>>>>>
53983>>>>>    //****************************************************************************
53983>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
53983>>>>>    // to the workspace object passing the an object and message to send back
53983>>>>>    // to this object. It is expected that the workspace object will send this
53983>>>>>    // message for every line of information it wants displayed (passing the
53983>>>>>    // information to be displayed
53983>>>>>    //****************************************************************************
53983>>>>>    register_procedure EnumerateWorkspaceData integer hObjId integer hmMessId
53983>>>>>    Procedure Show_WorkspaceInformation
53984>>>>>        If ghoWorkspace ;            Send EnumerateWorkspaceData to ghoWorkspace Current_object Msg_add_Line
53987>>>>>    End_Procedure
53988>>>>>
53988>>>>>    Function VersionStr integer iVer integer iRev integer iBld Returns string
53989>>>>>        Function_Return (string(iVer)-"."-string(iRev)-"."-string(iBld))
53990>>>>>    End_Function
53991>>>>>
53991>>>>>    Procedure Show_Versions
53992>>>>>        local integer iVersion iRevision iBuild
53993>>>>>        Version_information iVersion iRevision iBuild
53995>>>>>        Send Add_Line ("Runtime Version:" * VersionStr(self,iVersion,iRevision,iBuild) )
53996>>>>>        Send Add_Line ("Package Version:" * VersionStr(self,PKG_VERSION, PKG_REVISION, PKG_BUILD) )
53997>>>>>        Send Add_Line ("FMAC Version:"    * VersionStr(self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) )
53998>>>>>    End_Procedure
53999>>>>>
53999>>>>>
53999>>>>>    //***
53999>>>>>    //*** BW
53999>>>>>    //*** Procedure: Show_Drivers
53999>>>>>    //*** Purpose  : Show loaed database drivers
53999>>>>>    //***
53999>>>>>
53999>>>>>    Procedure Show_Drivers
54000>>>>>        Local String  Current_drvr
54001>>>>>        Local String  Loadeddrvrs
54001>>>>>        Local Integer Number_of_drvrs
54001>>>>>        Local Integer Count
54001>>>>>
54001>>>>>        Move "" To Loadeddrvrs
54002>>>>>        Get_attribute DF_NUMBER_DRIVERS To Number_of_drvrs
54005>>>>>        For Count From 1 To Number_of_drvrs
54011>>>>>>
54011>>>>>            Get_attribute DF_DRIVER_NAME Of Count To Current_drvr
54014>>>>>            If (Loadeddrvrs <> "") ;                Move (Append(Loadeddrvrs, ", ")) To Loadeddrvrs
54017>>>>>            Move (Append(Loadeddrvrs, Current_drvr)) To Loadeddrvrs
54018>>>>>        Loop
54019>>>>>>
54019>>>>>        Send Add_Line ("Database driver(s):" * Loadeddrvrs)
54020>>>>>    End_Procedure // Show_Drivers
54021>>>>>
54021>>>>>    //****************************************************************************
54021>>>>>    // $Module type: PROCEDURE
54021>>>>>    // $Module name: Add_Focus
54021>>>>>    // $Author     : VOO
54021>>>>>    // Created     : 24-09-96 @ 19:43
54021>>>>>    //
54021>>>>>    // Description
54021>>>>>    //    During activation we will remove the old information and add the newly
54021>>>>>    //    found systeminformation
54021>>>>>    //
54021>>>>>    // $Rev History
54021>>>>>    //    24-09-96  Module header created
54021>>>>>    //****************************************************************************
54021>>>>>    Procedure Add_Focus Integer hoRoot
54022>>>>>        Forward Send Add_Focus hoRoot
54024>>>>>
54024>>>>>        Send Delete_Data
54025>>>>>        Set Changed_State To False
54026>>>>>        Set Read_Only_State To True
54027>>>>>        Send Show_WorkSpaceInformation // added to show WS info
54028>>>>>        SEnd Show_Drivers
54029>>>>>        Send Show_Current_User
54030>>>>>        Send Show_Windows_Directory
54031>>>>>        Send Show_Current_Directory
54032>>>>>        Send Show_Filelist_Name
54033>>>>>        Send Show_Versions
54034>>>>>        Send Show_Memavail
54035>>>>>        Send Show_Screen_Size
54036>>>>>        Send Show_Page_Size
54037>>>>>        Send Show_Number_Format
54038>>>>>        Send Show_Date_Format
54039>>>>>        Send Show_Lock_Delay
54040>>>>>        Send Show_Lock_Timeout
54041>>>>>        Send Show_Date
54042>>>>>        Send Show_Systemresources
54043>>>>>        Send Show_Registration
54044>>>>>    End_Procedure // Show_All_Info
54045>>>>>
54045>>>>>End_Class // SysinfoDisplay
54046>>>>>
54046>>>>>
54046>>>>>//****************************************************************************
54046>>>>>// $Module type: OBJECT
54046>>>>>// $Module name: Sysinfo_Dialog
54046>>>>>// $Author     : VOO
54046>>>>>// Created     : 24-09-96 @ 18:47
54046>>>>>//
54046>>>>>// Description
54046>>>>>//    This object shows the systeminformation on the screen
54046>>>>>//
54046>>>>>// $Rev History
54046>>>>>//    24-09-96  Module header created
54046>>>>>//****************************************************************************
54046>>>>>Class SysInfoDialog Is A ModalPanel
54047>>>>>    Procedure Construct_Object
54048>>>>>        forward send construct_object
54050>>>>>
54050>>>>>        Set Caption_Bar To True
54051>>>>>        Set Sysmenu_Icon To True
54052>>>>>        Set Label To "System Information"
54053>>>>>        Set Size To 152 270
54054>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
54055>>>>>        Set Minimize_Icon To False
54056>>>>>        Set Maximize_Icon To False
54057>>>>>        Set Border_Style To Border_Dialog
54058>>>>>
54058>>>>>        Object Sysinfo_Display Is A SysInfoDisplay
54060>>>>>        End_Object
54061>>>>>
54061>>>>>        Object Close_Button Is A Button
54063>>>>>            Set Label to "&Close"
54064>>>>>            Set Location To 120 212
54065>>>>>            Set Message item 0 to msg_Close_Panel
54066>>>>>            Set default_action_button to current_object
54067>>>>>        End_Object // Close_Button
54068>>>>>
54068>>>>>        On_Key Kcancel       Send Close_Panel
54069>>>>>        On_Key Key_Alt+Key_C Send Close_Panel
54070>>>>>    End_procedure
54071>>>>>
54071>>>>>End_Class // SysinfoDialog
54072>>>>>
54072>>>>>// Purpose:
54072>>>>>//
54072>>>>>// Ken Ross 12/17/96 5:16PM
54072>>>>>//
54072>>>>>Class AboutDialog Is A ModalPanel
54073>>>>>
54073>>>>>    Procedure construct_object
54074>>>>>        String sVdfRootDir
54075>>>>>        forward send construct_object
54077>>>>>        Set Label to "About..."
54078>>>>>        Set Size to 100 217
54079>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
54080>>>>>
54080>>>>>        Object SysInfo_Dialog is a SysInfoDialog
54082>>>>>        End_Object
54083>>>>>
54083>>>>>        Object oBox is a Container3d
54085>>>>>            Set Border_Style to Border_StaticEdge
54086>>>>>            Set Size to 63 202
54087>>>>>            Set Location to 4 5
54088>>>>>
54088>>>>>            Object AboutGraphic is a BitmapContainer
54090>>>>>                Set Border_Style to Border_None
54091>>>>>                Set Bitmap_Style to Bitmap_Center
54092>>>>>                Set Size to 48 48
54093>>>>>                Set Location to 7 2
54094>>>>>            End_Object    // AboutGraphic
54095>>>>>
54095>>>>>            Object ProductName is a TextBox
54097>>>>>                Set label to "ProductName"
54098>>>>>                Set Size to 10 45
54099>>>>>                Set Location to 8 53
54100>>>>>            End_Object    // ProductName
54101>>>>>
54101>>>>>            Object Version is a TextBox
54103>>>>>                Set label to "Version"
54104>>>>>                Set Size to 10 25
54105>>>>>                Set Location to 21 53
54106>>>>>            End_Object    // Version
54107>>>>>
54107>>>>>            Object Copyright is a TextBox
54109>>>>>                Set label to "Copyright"
54110>>>>>                Set Size to 10 31
54111>>>>>                Set Location to 34 53
54112>>>>>            End_Object    // Copyright
54113>>>>>
54113>>>>>            Object Author is a TextBox
54115>>>>>                Set label to "Author"
54116>>>>>                Set Size to 10 22
54117>>>>>                Set Location to 46 53
54118>>>>>            End_Object    // Author
54119>>>>>
54119>>>>>        End_Object    // oBox
54120>>>>>
54120>>>>>        Object OK_bn is a Button
54122>>>>>            On_Item "&OK" Send Close_Panel
54123>>>>>            Set Size to 14 50
54124>>>>>            Set Location to 71 157
54125>>>>>        End_Object    // OK_bn
54126>>>>>
54126>>>>>        Object SysInfo_bn is a Button
54128>>>>>            On_Item "&System Info" Send Show_Sysinfo
54129>>>>>            Set Size to 14 50
54130>>>>>            Set Location to 71 101
54131>>>>>        End_Object    // SysInfo_bn
54132>>>>>
54132>>>>>        On_Key Kcancel Send KeyAction to (Ok_bn(Current_Object))
54133>>>>>        On_Key Key_Alt+Key_O Send KeyAction to (Ok_bn(Current_Object))
54134>>>>>        On_Key Key_Alt+Key_S Send KeyAction to (SysInfo_bn(Current_Object))
54135>>>>>
54135>>>>>        Get_Profile_String "Defaults" "VdfRootDir" To sVdfRootDir
54138>>>>>        Set logo to (sVdfRootDir +"\Bitmaps\DacAbout.bmp")  // square bitmaps of 42x42 work best
54139>>>>>
54139>>>>>    End_Procedure
54140>>>>>
54140>>>>>    Procedure set productname string sval
54141>>>>>        set label of (productname(oBox(current_object))) to sval
54142>>>>>    End_Procedure
54143>>>>>
54143>>>>>    Procedure set version string sval
54144>>>>>        set label of (version(oBox(current_object))) to sval
54145>>>>>    End_Procedure
54146>>>>>
54146>>>>>    Procedure set copyright string sval
54147>>>>>        set label of (copyright(oBox(current_object))) to sval
54148>>>>>    End_Procedure
54149>>>>>
54149>>>>>    Procedure set author string sval
54150>>>>>        set label of (author(oBox(current_object))) to sval
54151>>>>>    End_Procedure
54152>>>>>
54152>>>>>    // square bitmaps of 42x42 work best
54152>>>>>    //
54152>>>>>    Procedure set logo string sval
54153>>>>>        set bitmap of (aboutgraphic(oBox(current_object))) to sval
54154>>>>>    End_Procedure
54155>>>>>
54155>>>>>    Procedure Show_Sysinfo
54156>>>>>        Send Popup_Modal To (Sysinfo_Dialog(Current_Object))
54157>>>>>    End_Procedure // Show_Sysinfo
54158>>>>>
54158>>>>>End_Class
54159>>>>>
54159>>>>>
54159>>>>>//Object About_Dialog is an AboutDialog
54159>>>>>//    set productname to "Visual DataFlex"
54159>>>>>//    set version to "version 4.0"
54159>>>>>//    set copyright to "Copyright 1997 Data Access Corporation"
54159>>>>>//    set author to ""
54159>>>>>//    set logo to "ablogo.bmp"  // square bitmaps of 42x42 work best
54159>>>>>//End_Object
54159>>>>>
54159>>>>>//Procedure Activate_About
54159>>>>>//   Send Popup_Modal To (About_Dialog (Current_Object))
54159>>>>>//End_Procedure
54159>>>
54159>>>// *************************************************************************
54159>>>//  Public message. This is the default message. It is expected that you will
54159>>>//   create your own message to override this
54159>>>// *************************************************************************
54159>>>
54159>>>Procedure Activate_About
54161>>>   Send DoAbout "" "" "" "" "" ""
54162>>>End_Procedure
54163>>>
54163>>>// *************************************************************************
54163>>>//  Public message. It is expected that you will send this message (most
54163>>>//  likely from Activate_About. This creates an about object, activates it
54163>>>//  and destroys it when done. It is not exepected that you will augment this.
54163>>>// *************************************************************************
54163>>>
54163>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
54165>>>        Local integer hoObj hoMain
54166>>>
54166>>>        // create object
54166>>>        Object About is an AboutDialog
54168>>>            // if no title passed use the label of the main panel
54168>>>            // (if a main panel exists).
54168>>>            if sTitle     eq '' Begin
54170>>>                Get Main_Window to hoMain
54171>>>                if hoMain Get Label of hoMain to sTitle
54174>>>            end
54174>>>>
54174>>>            set productname to sTitle
54175>>>            set version     to sVersion
54176>>>            set copyright   to sCopyRight
54177>>>            set author      to sAuthor
54178>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
54181>>>            Move Current_Object to hoObj // object Id
54182>>>        End_Object
54183>>>        Send Popup to hoObj    // popup the about object
54184>>>        Send Request_Destroy_Object to hoObj // when done, it will be destroyed
54185>>>End_procedure
54186>    Use Tooltip.Inc
INCLUDING FILE: TOOLTIP.INC
54186>>>Use Tooltip.pkg
54186>>>
54186>>>object StandardToolTip is a StandardToolTip000
54188>>>    move (current_object) to DefaultTooltipHintID
54189>>>end_object
54190>>>
54190>>>object ToolTipTimer is a ToolTipTimer000
54192>>>    move (current_object) to TooltipControllerID
54193>>>end_object
54194>    
54194>    
54194>    
54194>    
54194>    //AB-PanelStoreEnd
54194>
54194>
54194>End_Object
54195>
54195>
54195>//AB-StoreStart
54195>set bitmap of (client_area(main(self))) to "protem1.bmp"
54196>
54196>Send DoStoreFileModeInfo to ghoFileModeInfo
54197>
54197>
54197>Start_UI
54198>
54198>
54198>
54198>
54198>
54198>
54198>
54198>
54198>
54198>
54198>
54198>
54198>
54198>
54198>
54198>
54198>//AB-StoreEnd
54198>
54198>
Summary
Memory Available: 2147483647
Total Errors   : 0
Total Symbols  : 28755
Total Resources: 0
Total Commands : 54197
Total Windows  : 34
Total Pages    : 8
Static Data    : 375892
Message area   : 312260
Total Blocks   : 17849
