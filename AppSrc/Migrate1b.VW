//AB/ Project Migrate1b
//AB/ Object prj is a View_Project
//AB/     Set ProjectName to "Migrate1b"
//AB/     Set ProjectFileName to "Migrate1b.VW"
//AB/     Set GenerateFileName to "NONAME"

// Project Object Structure
//   Migrate1b is a dbViewSubs
//     Country_DD is a DataDictionary
//     Towns_DD is a DataDictionary
//     Cities_DD is a DataDictionary
//     Areas_DD is a DataDictionary
//     Payresp_DD is a DataDictionary
//     Clients_DD is a DataDictionary
//     frmYpoloipo is a FormSub
//     TeleytaiaKinhshApo is a cSyDateForm
//     chkAFM is a CheckBoxSub
//     EnarxhErgouApo is a cSyDateForm
//     EnarxhSkyrApo is a cSyDateForm
//     chkEither is a CheckBoxSub
//     ButtonSub1 is a ButtonSub
//     ButtonSub3 is a ButtonSub
//     chkIsozErg is a CheckBoxSub
//     ButtonSub7 is a ButtonSub
//     ButtonSub8 is a ButtonSub
//     frmFileName is a FormSub
//     ButtonSub5 is a ButtonSub
//     ButtonSub6 is a ButtonSub
//     TextBoxSub1 is a TextBoxSub
//     TextBoxSub4 is a TextBoxSub
//     TextBoxSub6 is a TextBoxSub
//     TextBoxSub8 is a TextBoxSub
//     TextBoxSub10 is a TextBoxSub
//     SaveAsDialog1 is a SaveAsDialog
//     TextBoxSub11 is a TextBoxSub
//     TextBoxSub12 is a TextBoxSub
//     TextBoxSub13 is a TextBoxSub
//     TextBoxSub15 is a TextBoxSub
//     TextBoxSub17 is a TextBoxSub
//     TextBoxSub18 is a TextBoxSub
//     chkNines is a CheckBoxSub
//     chkZeroes is a CheckBoxSub
//     chkStars is a CheckBoxSub
//     chkBlanks is a CheckBoxSub
//     frmCreateDate is a cSyDateForm
//     TextBoxSub19 is a TextBoxSub
//     frmOfeilh is a FormSub
//     TextBoxSub20 is a TextBoxSub
//     Rpt1_Report is a CrystalReportSubSQL
//     RepMakeYpolErga is a CrystalReportSubSQL

// Register all objects
Register_Object Areas_DD
Register_Object ButtonSub1
Register_Object ButtonSub3
Register_Object ButtonSub5
Register_Object ButtonSub6
Register_Object ButtonSub7
Register_Object ButtonSub8
Register_Object Cities_DD
Register_Object Clients_DD
Register_Object Country_DD
Register_Object chkAFM
Register_Object chkBlanks
Register_Object chkEither
Register_Object chkIsozErg
Register_Object chkNines
Register_Object chkStars
Register_Object chkZeroes
Register_Object EnarxhErgouApo
Register_Object EnarxhSkyrApo
Register_Object frmCreateDate
Register_Object frmFileName
Register_Object frmOfeilh
Register_Object frmYpoloipo
Register_Object Migrate1b
Register_Object Payresp_DD
Register_Object RepMakeYpolErga
Register_Object Rpt1_Report
Register_Object SaveAsDialog1
Register_Object TeleytaiaKinhshApo
Register_Object TextBoxSub1
Register_Object TextBoxSub10
Register_Object TextBoxSub11
Register_Object TextBoxSub12
Register_Object TextBoxSub13
Register_Object TextBoxSub15
Register_Object TextBoxSub17
Register_Object TextBoxSub18
Register_Object TextBoxSub19
Register_Object TextBoxSub20
Register_Object TextBoxSub4
Register_Object TextBoxSub6
Register_Object TextBoxSub8
Register_Object Towns_DD


//AB/ AppBuild VIEW


//AB-StoreTopStart
        
Open tmplg
Open tmpPagia
Open Cmoves
Open Clients
Open CN
Open Constrct
Open Mhxanik
Open Payresp
Open Salesmen
Open Cities
Open Towns
Open Country
Open Areas
Open BtnOrdH
Open Branch
Open SyscurXR
Open MINOMOS
Open MIDHMOS
Open MIDRAST


//AB-StoreTopEnd

//AB-IgnoreStart

Use dbViews.Sub
Use DFAllEnt.pkg
Use Form.Sub
Use cSyDateForm.Pkg
Use Chkbox.Sub
Use Button.Sub
Use Txtbox.Sub

Use COUNTRY.DD
Use TOWNS.DD
Use CITIES.DD
Use AREAS.DD
Use PAYRESP.DD
Use CLIENTS.DD

//AB-IgnoreEnd

ACTIVATE_VIEW Activate_Migrate1b FOR Migrate1b

Object Migrate1b is a dbViewSubs

    //AB-StoreTopStart
                
    Open rptmp
    
    //Object MyExcel is a Excel
    //    procedure End_construct_object
    //        forward send End_construct_object
    //    end_procedure
    //End_Object
    
    Property Handle     jhoExcelApp     public 0
    Property Handle     jhoWorkbooks    public 0
    Property Handle     jhoWorkbook     public 0
    Property Handle     jhoSheets       public 0
    Property Handle     jhoRange        public 0
    Property Boolean    jbVisible       public 0 // by default, make Excel visible like DDE interface
    
    Register_Object RepMakeYpolErga
    
    //AB-StoreTopEnd

    Set Label to "Ñ•òö‡ö„ Ñöö®ò≠È§"
    Set Size to 382 421
    Set Location to 7 12

    //AB-DDOStart

    Object Country_DD is a Country_DataDictionary
    End_Object    // Country_DD

    Object Towns_DD is a Towns_DataDictionary
        Set DDO_Server to (Country_DD(self))
    End_Object    // Towns_DD

    Object Cities_DD is a Cities_DataDictionary
        Set DDO_Server to (Towns_DD(self))
    End_Object    // Cities_DD

    Object Areas_DD is a Areas_DataDictionary
    End_Object    // Areas_DD

    Object Payresp_DD is a Payresp_DataDictionary
    End_Object    // Payresp_DD

    Object Clients_DD is a Clients_DataDictionary
        Set DDO_Server to (Cities_DD(self))
        Set DDO_Server to (Areas_DD(self))
        Set DDO_Server to (Payresp_DD(self))
    End_Object    // Clients_DD

    Set Main_DD to (Clients_DD(self))
    Set Server to (Clients_DD(self))

    //AB-DDOEnd

    Object frmYpoloipo is a FormSub
        Set Size to 13 66
        Set Location to 55 9
        Set Label_Col_Offset to 2
        Set Form_TypeFace Item 0 to "MS Sans Serif"
    End_Object    // frmYpoloipo

    Object TeleytaiaKinhshApo is a cSyDateForm
        Set Size to 13 66
        Set Location to 55 95
        Set Label_Col_Offset to 2
        Set Label_Justification_Mode to jMode_Right
        Set Form_Mask Item 0 to "dd/MM/yyyy"
        Set Form_TypeFace Item 0 to "MS Sans Serif"
    End_Object    // TeleytaiaKinhshApo

    Object chkAFM is a CheckBoxSub
        Set Label to "Ñ•òö‡ö„ ô·©ú† Äîã ö†ò ßú¢·´ú™ £ú valid Äîã"
        Set Size to 10 180
        Set Location to 47 201
        Set Auto_Size_State to FALSE
        Set Checked_State to TRUE
    End_Object    // chkAFM

    Object EnarxhErgouApo is a cSyDateForm
        Set Size to 13 66
        Set Location to 126 13
        Set Label_Col_Offset to 2
        Set Label_Justification_Mode to jMode_Right
        Set Form_Mask Item 0 to "dd/MM/yyyy"
        Set Form_TypeFace Item 0 to "MS Sans Serif"
    End_Object    // EnarxhErgouApo

    Object EnarxhSkyrApo is a cSyDateForm
        Set Size to 13 66
        Set Location to 126 99
        Set Label_Col_Offset to 2
        Set Label_Justification_Mode to jMode_Right
        Set Form_Mask Item 0 to "dd/MM/yyyy"
        Set Form_TypeFace Item 0 to "MS Sans Serif"
    End_Object    // EnarxhSkyrApo

    Object chkEither is a CheckBoxSub
        Set Label to "éâ ò§ ßú®§·ú† û £†ò òß¶ ´†™ û£ú®¶£û§Âú™ ‚§ò®•û™"
        Set Size to 10 189
        Set Location to 126 204
        Set Auto_Size_State to FALSE
        Set Checked_State to TRUE
    End_Object    // chkEither

    Object ButtonSub1 is a ButtonSub

        //AB-StoreTopStart
                            
        //AB-StoreTopEnd

        Set Label to "ãò®°·®†©£ò Ñöö®ò≠È§"
        Set Size to 15 393
        Set Location to 144 12
        Set Focus_Mode to Pointer_Only
        Set Form_FontWeight Item 0 to 600
        Set Form_TypeFace Item 0 to "MS Sans Serif"

        //AB-StoreStart
                            
        Set Label to 'ãò®°·®†©£ò Ñöö®ò≠È§ èú¢ò´È§'
        
        Procedure OnClick
            String  sLabel sPelaths sTxt Zeroes Stars Nines Blanks
            Integer iFs iInt iProblem iCounter iCount iBad
            Integer iCheckAFM iChkNines iChkZeroes iChkBlanks iChkStars
            Integer i1 i2 i3 i4 i5 iCheckClients iCheckErga iCheckPresp
            Date    dApo0001 dEos0001 dEnarxhApo dEnarxhEos dSkyrodApo dSkyrodEos
            Date    dCreateDate
            Number  nYpoloipo nOfeilh
        
            Get Label   to sLabel
            Move ""     to sTxt
        
            Get Value Of frmYpoloipo        Item 0 to nYpoloipo
            Get Value Of TeleytaiaKinhshApo Item 0 to dApo0001
            Get Value Of frmOfeilh          Item 0 to nOfeilh
            Get Value Of frmCreateDate      Item 0 to dCreateDate
        
            Get Checked_State Of chkAFM to iCheckAFM
        
            Move 0 to iProblem
            Move 0 to iInt
            Move 0 to iCounter
            Move 0 to iCount
        
            Move "000000"   to Zeroes
            Move "*"        to Stars
            Move "999999"   to Nines
        
            File_Size Clients to iFs
            Clear Clients
            Lock
            Find GE Clients.Recnum
            While (Found)
                Add 1 to iInt
        
                Number NewOfeilhFromAging
                Clear rptmp
                Move "01"               to rptmp.Company_Code
                Move ""                 to rptmp.Branch_Code
                Move Clients.Client_ID  to rptmp.ID1
                Move "5"                to rptmp.Seira
                Find Eq rptmp By Index.1
        
                Move rptmp.Mhnas_Trex        to NewOfeilhFromAging
                //If (Found) Move rptmp.Mhnas_Trex        to NewOfeilhFromAging
                //Else       Move Clients.Synolikh_Ofeilh to NewOfeilhFromAging
        
                Integer isGood isYpoloipoOK isOfeilhOK
                Move 1 to isGood
        
                Move ("èú¢·´û™ "+String(iInt)+' òßÊ '+String(iFS)+"...  úß†¢‚öû©ò§ "+String(iCounter)+" Ñöö®ò≠‚™" ) to sTxt
                Move (Trim(sTxt)) to sTxt
                Set Label to sTxt
        
                If (nYpoloipo<>0) Begin
                    If      (Clients.Ypoloipo <  0)         Move 1 to isYpoloipoOK
                    Else If (Clients.Ypoloipo < nYpoloipo)  Move 0 to isYpoloipoOK
                    Else                                    Move 1 to isYpoloipoOK
                End
                Else                                        Move 1 to isYpoloipoOK
        
                If (nOfeilh<>0) Begin
                    If      (NewOfeilhFromAging <  0)      Move 1 to isOfeilhOK
                    Else If (NewOfeilhFromAging < nOfeilh) Move 0 to isOfeilhOK
                    Else                                   Move 1 to isOfeilhOK
                End
                Else                                       Move 1 to isOfeilhOK
        
                If ((isYpoloipoOK=0) And (isOfeilhOK=0)) Move 0 to isGood
        
                If ((dApo0001<>"") And (isGood=1)) Begin
                    Clear Cmoves
                    Move Clients.Client_ID  to Cmoves.Client_ID
                    Move dApo0001           to Cmoves.Cmoves_Hmnia
                    Find GE Cmoves By Index.4
                    If (NOT((Found) And ;
                            (Clients.Client_ID=Cmoves.Client_ID) And ;
                            (Cmoves.Cmoves_Hmnia>=dApo0001))) Move 0 to isGood
                End
                If ((dEos0001<>"") And (isGood=1))  Begin
                    Clear Cmoves
                    Move Clients.Client_ID  to Cmoves.Client_ID
                    Move dEos0001           to Cmoves.Cmoves_Hmnia
                    Move "ZZZZZZZZZ"        to Cmoves.Cmoves_Recr
                    Find LE Cmoves By Index.4
                    If (NOT((Found) And ;
                            (Clients.Client_ID=Cmoves.Client_ID) And ;
                            (Cmoves.Cmoves_Hmnia<=dEos0001))) Move 0 to isGood
                End
        
        
                If ( (dCreateDate<>"") And (Clients.Client_Hmnia<dCreateDate)) Move 0 to isGood
        
        
                Get Checked_State Of chkNines   to iChkNines
                Get Checked_State Of chkZeroes  to iChkZeroes
                Get Checked_State Of chkStars   to iChkStars
                Get Checked_State Of chkBlanks  to iChkBlanks
        
                If ((iChkZeroes=1) And (Clients.Client_AFM Contains Zeroes)) Move 0 to isGood
                If ((iChkNines =1) And (Clients.Client_AFM Contains Nines )) Move 0 to isGood
                If ((iChkStars =1) And (Clients.Client_AFM Contains Stars )) Move 0 to isGood
                If ((iChkBlanks=1) And (Trim(Clients.Client_AFM)=""       )) Move 0 to isGood
        
                If (isGood=1) Begin
                    Add  1  to iCounter
        
                    Move 1  to Clients.ExportFlag
                    Sysdate    Clients.ExportDate
                    Saverecord Clients
        
                    // PAYRESP
                    Clear Payresp
                    Move Clients.Presp_ID to Payresp.Presp_ID
                    Find Eq Payresp By Index.7
                    If (Found) Begin
                        Move 1  to Payresp.ExportFlag
                        Sysdate    Payresp.ExportDate
                        Saverecord Payresp
                    End
        
                    // ERGA
                    Get Value Of EnarxhErgouApo to dEnarxhApo
                    Get Value Of EnarxhSkyrApo  to dSkyrodApo
        
                    Clear CN
                    Move Clients.Client_ID to CN.Client_ID
                    Find GE CN By Index.4
                    While ((Found) And (CN.Client_ID=Clients.Client_ID))
                        Integer iAmOK iAmOK2
        
                        Move 0 to iAmOK
                        Move 0 to iAmOK2
        
                        Integer isChecked
                        Get Checked_State of chkEither to isChecked
        
                        If (isChecked) Begin
                            Move 0 to isGood
                            If ((Trim(dEnarxhApo)="") And (Trim(dSkyrodApo)="")) Move 1 to isGood
                            Else If ( ((dEnarxhApo>"") And (CN.Cn_start_date >=dEnarxhApo)) Or ;
                                      ((dSkyrodApo>"") And (CN.Hm_prot_fortio>=dSkyrodApo)) ) Move 1 to isGood
                        End
                        Else Begin
                            Move 1 to isGood
                            If ((dEnarxhApo>"") And (CN.Cn_start_date <dEnarxhApo)) Move 0 to isGood
                            If ((dSkyrodApo>"") And (CN.Hm_prot_fortio<dSkyrodApo)) Move 0 to isGood
                        End
        
                        If (isGood=1) Begin
                            Move 1  to CN.ExportFlag
                            Sysdate    CN.ExportDate
                            Saverecord CN
        
                            Clear Constrct
                            Move CN.CN_Cnt_ID to Constrct.Cnt_ID
                            Find Eq Constrct By Index.5
                            If (Found) Begin
                                Move 1  to Constrct.ExportFlag
                                Sysdate    Constrct.ExportDate
                                Saverecord Constrct
                            End
        
                            Clear Mhxanik
                            Move CN.Mhxanik_ID to Mhxanik.Mhx_ID
                            Find Eq Mhxanik By Index.4
                            If (Found) Begin
                                Move 1  to Mhxanik.ExportFlag
                                Sysdate    Mhxanik.ExportDate
                                Saverecord Mhxanik
                            End
        
                            Clear Salesmen
                            Move CN.CN_SLS_ID to Salesmen.SLS_ID
                            Find Eq Salesmen By Index.4
                            If (Found) Begin
                                Move 1  to Salesmen.ExportFlag
                                Sysdate    Salesmen.ExportDate
                                Saverecord Salesmen
                            End
                        End
                        Find GT CN By Index.4
                    Loop
                End
                Find GT Clients.Recnum
            Loop
            Unlock
            Send Info_Box 'Ü É†òõ†°ò©Âò é¢¶°¢û®Èüû°ú' 'è¢û®¶≠¶®Âò'
            Set Label to sLabel
        End_Procedure // OnClick
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        //AB-StoreEnd

    End_Object    // ButtonSub1

    Object ButtonSub3 is a ButtonSub

        //AB-StoreTopStart
                                                                                                                                                                                    
        //AB-StoreTopEnd

        Set Label to "çú£ò®°·®†©£ò Ó¢‡§ ´‡§ úöö®ò≠È§"
        Set Size to 14 269
        Set Location to 163 75
        Set Focus_Mode to Pointer_Only
        Set Form_TypeFace Item 0 to "MS Sans Serif"

        //AB-StoreStart
                                                                                                                                                                                    
        Set Label to 'çú£ò®°·®†©£ò Ó¢‡§ ´‡§ úöö®ò≠È§ èú¢ò´È§'
        
        Procedure OnClick
            String  sLabel sPelaths sTxt
            Integer iFs iInt iProblem iCounter iCount
            Integer i1 i2 i3 i4 i5 iCheckClients iCheckErga iCheckPresp
            Date    dApo0001 dEos0001 dEnarxhApo dEnarxhEos dSkyrodApo dSkyrodEos
            Number  nYpoloipo
        
            Get Label   to sLabel
            Move ""     to sTxt
        
            Get Value Of frmYpoloipo        Item 0 to nYpoloipo
            Get Value Of TeleytaiaKinhshApo Item 0 to dApo0001
        
            Move 0 to iProblem
            Move 0 to iInt
            Move 0 to iCounter
            Move 0 to iCount
        
            File_Size Clients to iFs
            Clear Clients
            Find GE Clients.Recnum
            While (Found)
                Add 1 to iInt
        
                Integer isGood
                Move 1 to isGood
        
                Move ("èú¢·´û™ "+String(iInt)+' òßÊ '+String(iFS)+"...  úß†¢‚öû©ò§ "+String(iCounter)+" Ñöö®ò≠‚™" ) to sTxt
                Move (Trim(sTxt)) to sTxt
                Set Label to sTxt
        
                If ((nYpoloipo<>0) And (Clients.Ypoloipo = 0)) Move 0 to isGood
        
                If ((dApo0001<>"") And (isGood=1)) Begin
                    Clear Cmoves
                    Move Clients.Client_ID  to Cmoves.Client_ID
                    Move dApo0001           to Cmoves.Cmoves_Hmnia
                    Find GE Cmoves By Index.4
                    If (NOT((Found) And ;
                            (Clients.Client_ID=Cmoves.Client_ID) And ;
                            (Cmoves.Cmoves_Hmnia>=dApo0001))) Move 0 to isGood
                End
                If ((dEos0001<>"") And (isGood=1))  Begin
                    Clear Cmoves
                    Move Clients.Client_ID  to Cmoves.Client_ID
                    Move dEos0001           to Cmoves.Cmoves_Hmnia
                    Move "ZZZZZZZZZ"        to Cmoves.Cmoves_Recr
                    Find LE Cmoves By Index.4
                    If (NOT((Found) And ;
                            (Clients.Client_ID=Cmoves.Client_ID) And ;
                            (Cmoves.Cmoves_Hmnia<=dEos0001))) Move 0 to isGood
                End
        
                If (isGood=1) Begin
        
                    Reread
        
                    Add  1  to iCounter
                    Move 0  to Clients.ExportFlag
                    Move "" to Clients.ExportDate
                    Saverecord Clients
        
                    // PAYRESP
                    Clear Payresp
                    Move Clients.Presp_ID to Payresp.Presp_ID
                    Find Eq Payresp By Index.7
                    If (Found) Begin
                        Move 0  to Payresp.ExportFlag
                        Move "" to Payresp.ExportDate
                        Saverecord Payresp
                    End
        
                    // ERGA
                    Get Value Of EnarxhErgouApo to dEnarxhApo
                    Get Value Of EnarxhSkyrApo  to dSkyrodApo
        
                    Clear CN
                    Move Clients.Client_ID to CN.Client_ID
                    Find GE CN By Index.4
                    While ((Found) And (CN.Client_ID=Clients.Client_ID))
                        Move 1 to isGood
        
                        If ((dEnarxhApo>"") And (CN.Cn_start_date   >"") And (CN.Cn_start_date  <dEnarxhApo)) Move 0 to isGood
                        If ((dSkyrodApo>"") And (CN.Hm_prot_fortio  >"") And (CN.Hm_prot_fortio <dSkyrodApo)) Move 0 to isGood
        
                        If (isGood=1) Begin
                            Move 0  to CN.ExportFlag
                            Move "" to CN.ExportDate
                            Saverecord CN
        
                            Clear Constrct
                            Move CN.CN_Cnt_ID to Constrct.Cnt_ID
                            Find Eq Constrct By Index.5
                            If (Found) Begin
                                Move 0  to ConstrCT.ExportFlag
                                Move "" to ConstrCT.ExportDate
                                Saverecord Constrct
                            End
        
                            Clear Mhxanik
                            Move CN.Mhxanik_ID to Mhxanik.Mhx_ID
                            Find Eq Mhxanik By Index.4
                            If (Found) Begin
                                Move 0  to Mhxanik.ExportFlag
                                Move "" to Mhxanik.ExportDate
                                Saverecord Mhxanik
                            End
        
                            Clear Salesmen
                            Move CN.CN_SLS_ID to Salesmen.SLS_ID
                            Find Eq Salesmen By Index.4
                            If (Found) Begin
                                Move 0  to Salesmen.ExportFlag
                                Move "" to Salesmen.ExportDate
                                Saverecord Salesmen
                            End
                        End
                        Find GT CN By Index.4
                    Loop
        
                    Unlock
        
                End
                Find GT Clients.Recnum
            Loop
        
            Send Info_Box 'Ü É†òõ†°ò©Âò é¢¶°¢û®Èüû°ú' 'è¢û®¶≠¶®Âò'
            Set Label to sLabel
        End_Procedure // OnClick
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        //AB-StoreEnd

    End_Object    // ButtonSub3

    Object chkIsozErg is a CheckBoxSub
        Set Size to 10 9
        Set Location to 226 135
    End_Object    // chkIsozErg

    Object ButtonSub7 is a ButtonSub

        //AB-StoreTopStart
                                                                
        //AB-StoreTopEnd

        Set Label to "ìß¶¢Êöû©ú ìßÊ¢¶†ßò °ò† ã·®°ò®ú Î®öò"
        Set Size to 14 252
        Set Location to 223 152
        Set Form_FontWeight Item 0 to 600
        Set Form_TypeFace Item 0 to "MS Sans Serif"

        //AB-StoreStart
                                                                
        Procedure OnClick
            Integer isChecked iFS iCount
            String sCode sLabel sMess sName
            Number n1 n2 n3 n4 nXr nPi
        
            Get Checked_State Of chkIsozErg to isChecked
            If (Not(isChecked)) Procedure_Return
        
            Get Label to sLabel
        
            Send RunErgaReport Of RepMakeYpolErga
        
            Move 0 to iCount
        
            Direct_Input Channel 9 "c:\TitanMig\IsozErg.txt"
        
            While (Not(Seqeof))
                Read    Channel 9 sCode sName n1 n2 n3 n4 nXr nPi
                If (Trim(sCode)='') Goto Telos_EdoIsozErga
        
        
                Set Label to (Trim(sCode))
        
        
                If ((nXr-nPi)<>0.00) Begin
        
                    Add 1 to iCount
        
                    Clear CN
                    Move sCode to CN.CN_Code
                    Find EQ CN By Index.5
                    If (Found) Begin
        
                        Set Label to (Trim(sCode)+"  "+Trim(Left(CN.CN_Descr,15)))
        
                        Reread
        
                        Move 1  to CN.ExportFlag
                        Sysdate    CN.ExportDate
                        Saverecord CN
        
                        Clear Clients
                        Move CN.Client_ID to Clients.Client_ID
                        Find Eq Clients By Index.6
                        If (Found) Begin
                            Move 1  to Clients.ExportFlag
                            Sysdate    Clients.ExportDate
                            Saverecord Clients
                        End
        
                        Clear Constrct
                        Move CN.CN_Cnt_ID to Constrct.Cnt_ID
                        Find Eq Constrct By Index.5
                        If (Found) Begin
                            Move 1  to Constrct.ExportFlag
                            Sysdate    Constrct.ExportDate
                            Saverecord Constrct
                        End
        
                        Clear Mhxanik
                        Move CN.Mhxanik_ID to Mhxanik.Mhx_ID
                        Find Eq Mhxanik By Index.4
                        If (Found) Begin
                            Move 1  to Mhxanik.ExportFlag
                            Sysdate    Mhxanik.ExportDate
                            Saverecord Mhxanik
                        End
        
                        Clear Salesmen
                        Move CN.CN_SLS_ID to Salesmen.SLS_ID
                        Find Eq Salesmen By Index.4
                        If (Found) Begin
                            Move 1  to Salesmen.ExportFlag
                            Sysdate    Salesmen.ExportDate
                            Saverecord Salesmen
                        End
                        Unlock
                    End
                End
                Readln  Channel 9
            Loop
        
            Telos_EdoIsozErga:
            Close_Input Channel 9
        
            Send Info_Box ("Å®‚üû°ò§ "+String(iCount)+" Î®öò") "è¢û®¶≠¶®Âò"
        
            Set Label to sLabel
        
        End_Procedure // OnClick
        
        
        
        
        
        
        
        
        
        
        
        
        
        //AB-StoreEnd

    End_Object    // ButtonSub7

    Object ButtonSub8 is a ButtonSub

        //AB-StoreTopStart
                                                                                                
        //AB-StoreTopEnd

        Set Label to "çú£·®°ò®ú Î®öò £ú ìßÊ¢¶†ßò"
        Set Size to 14 209
        Set Location to 238 171
        Set Focus_Mode to Pointer_Only
        Set Form_TypeFace Item 0 to "MS Sans Serif"

        //AB-StoreStart
                                                                                                
        Procedure OnClick
            Integer isChecked iFS iCount
            String sCode sLabel sMess sName
            Number n1 n2 n3 n4 nXr nPi
        
            Get Checked_State Of chkIsozErg to isChecked
            If (Not(isChecked)) Procedure_Return
        
            Get Label to sLabel
        
            Send RunErgaReport Of RepMakeYpolErga
        
            Move 0 to iCount
        
            Direct_Input Channel 9 "c:\TitanMig\IsozErg.txt"
        
            While (Not(Seqeof))
                Read    Channel 9 sCode sName n1 n2 n3 n4 nXr nPi
                If (Trim(sCode)='') Goto Telos_EdoIsozErga00
        
        
                Set Label to (Trim(sCode))
        
        
                If ((nXr-nPi)<>0.00) Begin
        
                    Add 1 to iCount
        
                    Clear CN
                    Move sCode to CN.CN_Code
                    Find EQ CN By Index.5
                    If (Found) Begin
        
                        Set Label to (Trim(sCode)+"  "+Trim(Left(CN.CN_Descr,15)))
        
                        Reread
        
                        Move 0  to CN.ExportFlag
                        Move "" to CN.ExportDate
                        Saverecord CN
        
                        Clear Constrct
                        Move CN.CN_Cnt_ID to Constrct.Cnt_ID
                        Find Eq Constrct By Index.5
                        If (Found) Begin
                            Move 0  to Constrct.ExportFlag
                            Move "" to Constrct.ExportDate
                            Saverecord Constrct
                        End
        
                        Clear Mhxanik
                        Move CN.Mhxanik_ID to Mhxanik.Mhx_ID
                        Find Eq Mhxanik By Index.4
                        If (Found) Begin
                            Move 0  to Mhxanik.ExportFlag
                            Move "" to Mhxanik.ExportDate
                            Saverecord Mhxanik
                        End
        
                        Clear Salesmen
                        Move CN.CN_SLS_ID to Salesmen.SLS_ID
                        Find Eq Salesmen By Index.4
                        If (Found) Begin
                            Move 0  to Salesmen.ExportFlag
                            Move "" to Salesmen.ExportDate
                            Saverecord Salesmen
                        End
                        Unlock
                    End
                End
                Readln  Channel 9
            Loop
        
            Telos_EdoIsozErga00:
            Close_Input Channel 9
        
            Send Info_Box ("Å®‚üû°ò§ "+String(iCount)+" Î®öò") "è¢û®¶≠¶®Âò"
        
            Set Label to sLabel
        
        End_Procedure // OnClick
        
        
        
        
        
        
        
        
        
        
        
        
        
        //AB-StoreEnd

    End_Object    // ButtonSub8

    Object frmFileName is a FormSub

        //AB-StoreTopStart
                                                                                                                                                                                                                                                                                                                                                                                                
        //AB-StoreTopEnd

        Set Size to 13 187
        Set Location to 294 131
        Set Label_Col_Offset to 2
        Set Prompt_Button_Mode to pb_PromptOn
        Set Form_TypeFace Item 0 to "MS Sans Serif"
        Set Value Item 0 to "C:\TitanMig\ExcCust.csv"

        //AB-StoreStart
                                                                                                                                                                                                                                                                                                                                                                                                
        Procedure Prompt
            Boolean bSave
            String sFileTitle sFileName
            Get Show_Dialog Of (SaveAsDialog1(Self)) To bSave
            If (bSave) Begin
                Get File_Title Of (SaveAsDialog1(Self)) To sFileTitle
                Get File_Name  Of (SaveAsDialog1(Self)) To sFileName
                Set Value Of frmFileName Item 0 To sFileName
            End
        End_Procedure
        
        //AB-StoreEnd

    End_Object    // frmFileName

    Object ButtonSub5 is a ButtonSub

        //AB-StoreTopStart
                                                                        
        Property String psNotFoundClientDhmos Public ""
        Property String psNotFoundClientNomos Public ""
        Property String psNotFoundClientDrast Public ""
        Property String psNotFoundClientTrPlh Public ""
        
        Property String psNotFoundErgoDhmos Public ""
        Property String psNotFoundErgoNomos Public ""
        Property String psNotFoundErgoDrast Public ""
        Property String psNotFoundErgoTrPlh Public ""
        
        Property String psNotFoundPrespDhmos Public ""
        Property String psNotFoundPrespNomos Public ""
        Property String psNotFoundPrespDrast Public ""
        Property String psNotFoundPrespTrPlh Public ""
        
        Property String psNotFoundMhxanDhmos Public ""
        Property String psNotFoundMhxanNomos Public ""
        Property String psNotFoundMhxanDrast Public ""
        Property String psNotFoundMhxanTrPlh Public ""
        
        Property String psNotFoundConstrDhmos Public ""
        Property String psNotFoundConstrNomos Public ""
        Property String psNotFoundConstrDrast Public ""
        Property String psNotFoundConstrTrPlh Public ""
        
        Property String psNotFoundSalesDhmos Public ""
        Property String psNotFoundSalesNomos Public ""
        Property String psNotFoundSalesDrast Public ""
        Property String psNotFoundSalesTrPlh Public ""
        
        
        Function fsTropoiPlhromhsPelath String asOurCode Returns String
            String sTheirCode
        
            If      (asOurCode="K000") Move "G000" to sTheirCode
            Else If (asOurCode="K030") Move "G030" to sTheirCode
            Else If (asOurCode="K060") Move "G060" to sTheirCode
            Else If (asOurCode="K090") Move "G090" to sTheirCode
            Else If (asOurCode="K120") Move "G120" to sTheirCode
            Else If (asOurCode="K150") Move "G150" to sTheirCode
            Else If (asOurCode="K180") Move "G180" to sTheirCode
            Else If (asOurCode="K210") Move "G210" to sTheirCode
            Else If (asOurCode="K240") Move "G240" to sTheirCode
            Else If (asOurCode="K270") Move "G270" to sTheirCode
            Else If (asOurCode="K300") Move "G300" to sTheirCode
            Else If (asOurCode="K330") Move "G330" to sTheirCode
            Else If (asOurCode="K360") Move "G360" to sTheirCode
            Else Begin
                Set psNotFoundClientTrPlh to (Trim("*** (AW+BN) "+asOurCode))
                Move "ZZZZ" to sTheirCode
            End
            Function_Return sTheirCode
        End_Function
        
        
        //AB-StoreTopEnd

        Set Label to "EXPORT TO FILES"
        Set Size to 20 273
        Set Location to 311 71
        Set Focus_Mode to Pointer_Only
        Set Form_FontWeight Item 0 to 600
        Set Form_TypeFace Item 0 to "MS Sans Serif"

        //AB-StoreStart
                                                                        
        Procedure OnClick
            String sFilename sLabel
            Integer bIsCreated
            Integer iWhat iVal
            Get Label to sLabel
            Get Value Of frmFileName Item 0 to sFilename
            If (Trim(sFilename)="") Begin
                Send Stop_Box "í¶ Ê§¶£ò ´¶¨ ò®úÂ¶¨ úÂ§ò† °ú§Ê" "ë≠·¢£ò 1002"
                Procedure_Return
            End
        
            Direct_Output Channel 9 sFilename
        
            String sFileName2
            Move "C:\TitanMig\Mhxanik.csv" to sFileName2
            Direct_Output Channel 7 sFilename2
        
            String sFileName3
            Move "C:\TitanMig\Constrct.csv" to sFileName3
            Direct_Output Channel 8 sFilename3
        
            String sFileName4
            Move "C:\TitanMig\Salesmen.csv" to sFileName4
            Direct_Output Channel 6 sFilename4
        
            Integer iCnt iFS
            Move 0 to iCnt
            File_Size Clients to iFS
            String sMess
        
            Clear Clients
            Find GE Clients.Recnum
            While (Found)
            //Move 1 to Clients.ExportFlag
            //Find GE Clients By Index.12
            //While ((Found) And (Clients.ExportFlag=1))
            //While (iCnt<100)
                Add 1 to iCnt
                Move (String(iCnt)+"/"+String(iFS)) to sMess
                //Showln "1... " iCnt "  "  (Trim(Clients.Client_ID)) "  Index.12 --> Flag="  Clients.EXPORTFLAG "  Status=" (Trim(Clients.ExportStatus))  "  Date=" (Trim(Clients.ExportDate))  "  Recnum=" (Trim(Clients.Recnum))
                Set Label to sMess  //(Trim(Clients.Client_ID)+"  "+Trim(Clients.Client_Name))
        
                If (Clients.ExportFlag=1) Send OutputClient
        
                //Send OutputClient
                //Showln "2... " iCnt "  "  (Trim(Clients.Client_ID)) "  Index.12 --> Flag="  Clients.EXPORTFLAG "  Status=" (Trim(Clients.ExportStatus))  "  Date=" (Trim(Clients.ExportDate))  "  Recnum=" (Trim(Clients.Recnum))
                //Find GT Clients By Index.12
                Find GT Clients.Recnum
                //Showln "3.. "  iCnt "  "  (Trim(Clients.Client_ID)) "  Index.12 --> Flag="  Clients.EXPORTFLAG "  Status=" (Trim(Clients.ExportStatus))  "  Date=" (Trim(Clients.ExportDate))  "  Recnum=" (Trim(Clients.Recnum))
            Loop
            //Showln "EXIT... "  iCnt "  "  (Trim(Clients.Client_ID)) "  Index.12 --> Flag="  Clients.EXPORTFLAG "  Status=" (Trim(Clients.ExportStatus))  "  Date=" (Trim(Clients.ExportDate))  "  Recnum=" (Trim(Clients.Recnum))
        
            Close_Output Channel 9
            Close_Output Channel 8
            Close_Output Channel 7
            Close_Output Channel 6
            Set Label to sLabel
            Send Info_Box "Process Finished, the Excel file is saved" "Information"
        End_Procedure // OnClick
        
        
        Procedure OutputClient
            String  sClientID sDeli sPrespID
            Integer iCheckAFM iRecnum
        
            Move Clients.Recnum     to iRecnum
            Move Clients.Client_ID  to sClientID
        
            Move ","                to sDeli
        
            Set psNotFoundClientDhmos to ""
            Set psNotFoundClientNomos to ""
            Set psNotFoundClientDrast to ""
            Set psNotFoundClientTrPlh to ""
        
            Get Checked_State Of ChkAFM to iCheckAFM
        
            Integer iSkipThisClient
            String sPrevClientByAFM sPrevPrespByAFM
        
            Move 0 to iSkipThisClient
            Move Clients.Client_ID  to sPrevClientByAFM
            Move Clients.Presp_ID   to sPrevPrespByAFM
        
            If (iCheckAFM=1) Begin
                If (Check_AFM(Clients.Client_Afm)=0) Begin
                    Clear tmplg
                    Move Clients.Client_AFM to tmplg.Gplan_Code
                    Find Eq tmplg By Index.1
                    If (Found) Begin
        
                        // An yparxei pelaths me idio AFM pou epexergasthkame
                        // prohgoymena tote that xrhsimopoihsoume ta stoixeia
                        // aytou tou pelath, kai s' ayton tha desoume kai ta erga
                        Clear Clients
                        Move (Trim(tmplg.Gmove_Aitiol)) to Clients.Client_ID
                        Find Eq Clients By Index.6
                        //
                        //
                    End
                    Else Begin
                        Clear tmplg
                        Move Clients.Client_AFM to  tmplg.Gplan_Code
                        Move Clients.Client_ID  to  tmplg.Gmove_Aitiol
                        Move Clients.Presp_ID   to  tmplg.String1
                        Saverecord tmplg
                    End
                End
            End
        
        
            // Find if Client and Presp have same AFM to skip presp
            String sAFM1 sAFM2
            Move (Check_AFM(Clients.Client_Afm)) to sAFM1
            Clear Payresp
            Move Clients.Presp_ID to Payresp.Presp_ID
            Find Eq Payresp By Index.7
            Move (Check_AFM(Payresp.Presp_Afm)) to sAFM2
            Integer iSkipPresp
            Move (Trim(sAFM1)=Trim(sAFM2)) to iSkipPresp
        
        
            //---
            Write   Channel 9   '"'
            Write   Channel 9   'Y001'
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column B  é£·õò ä¶öò®†ò©£¶Á (ß.Æ. ßú¢·´û™, Ship - to °¢ß)
            Write   Channel 9   '"'
            Write   Channel 9   (Trim(Clients.Client_ID))
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column C  èò¢ò†Ê™ °Á®†¶™ °‡õ†°Ê™ ßú¢·´û SAP
            Write   Channel 9   sDeli // End of Excel Column D  ë¨£ß¢û®È§ú´ò† ö†ò ´¶¨™ Ship - to
        
            If (iSkipPresp=1) Begin
                Write   Channel 9   '"'
                Write   Channel 9   (Trim(Clients.Presp_ID))
                Write   Channel 9   '"'
            End
            Write   Channel 9   sDeli // End of Excel Column E  ëú ßú®Âß´‡©û ß¶¨ ¶ ß¢û®‡´„™ õ†ò≠‚®ú† òßÊ ´¶§ Operational Customer, ©´¶§ Operational ¶®Âùú´ò† ¶ ß¢û®‡´„™
        
            Move (Trim(Clients.Presp_ID)) to sPrespID
            Write   Channel 9   sDeli // End of Excel Column F  ëú ßú®Âß´‡©û ß¶¨ ¶ ß¢û®‡´„™ õ†ò≠‚®ú† òßÊ ´¶§ Operational Customer, ©´¶§ Operational ¶®Âùú´ò† ¶ ß¢û®‡´„™
            Write   Channel 9   sDeli // End of Excel Column G  ëú ßú®Âß´‡©û ß¶¨ ¶ ß¢û®‡´„™ õ†ò≠‚®ú† òßÊ ´¶§ Operational Customer, ©´¶§ Operational ¶®Âùú´ò† ¶ ß¢û®‡´„™
            Write   Channel 9   sDeli // End of Excel Column H  é®Âùú´ò† ¶ ú®ö¶¢·ô¶™ & Æ®û©†£¶ß¶†úÂ´ò† ¶ °‡õ†°Ê™ ß¶¨ ‚Æú† °ò´òÆ‡®ûüúÂ ©´¶ ò®ÆúÂ¶ "Customer Master Records_GR Others"
            Write   Channel 9   sDeli // End of Excel Column I  é®Âùú´ò† ¶ £ûÆò§†°Ê™ & Æ®û©†£¶ß¶†úÂ´ò† ¶ °‡õ†°Ê™ ß¶¨ ‚Æú† °ò´òÆ‡®ûüúÂ ©´¶ ò®ÆúÂ¶ "Customer Master Records_GR Others"
            Write   Channel 9   sDeli // End of Excel Column J  é®Âùú´ò† ¶ ß‡¢û´„™ & Æ®û©†£¶ß¶†úÂ´ò† ¶ °‡õ†°Ê™ ß¶¨ ‚Æú† °ò´òÆ‡®ûüúÂ ©´¶ ò®ÆúÂ¶ £ú´·ß´‡©û™ ß‡¢û´È§
            Write   Channel 9   '"'
            Write   Channel 9   'GR02'
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column K  â‡õ†°Ê™ Ñ´ò†®Âò™ Ñ¢¢·õò™
            Write   Channel 9   '"'
            Write   Channel 9   'GR02'
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column L é®öò§†©£Ê™ è‡¢„©ú‡§ Ñ¢¢·õò™
            Write   Channel 9   '"'
            Write   Channel 9   '03'
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column M âò§·¢† É†ò§¶£„™
            Write   Channel 9   '"'
            Write   Channel 9   '04'
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column N í£„£ò (Segment)
            String s1 sLianikh
            If      (Clients.Client_ptyppar='113')              Move "Z009" to s1
            Else If (Clients.Client_Name Contains "â/ç")        Move "Z006" to s1
            Else If (Clients.Client_Name Contains "ÉÜãéëàé")    Move "Z008" to s1
            Else                                                Move "Z005" to s1
            Move s1 to sLianikh
            Write   Channel 9   '"'
            Write   Channel 9   (Trim(s1))
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column O  Ñ´ò†®†°„ §¶£†°„ ¶§´Ê´û´ò
            Write   Channel 9   '"'
            Write   Channel 9   (Trim(Left(Clients.Client_Name,35)))
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column P  Ó§¶£ò ßú¢·´û
            Move "" to s1
            If (Trim(Mid(Clients.Client_Name,35,36))<>"") Move ('"'+Trim(Mid(Clients.Client_Name,35,36))+'"') to s1
            Write   Channel 9   (Trim(s1))
            Write   Channel 9   sDeli // End of Excel Column Q  ë¨£ß¢û®‡£ò´†°Ê ßúõÂ¶ ©ú ßú®Âß´‡©û ß¶¨ £„°¶™ ´¶¨ ßúõÂ¶¨ Name 1 õú§ úÂ§ò† úßò®°‚™
            Move "" to s1
            If (Trim(Mid(Clients.Client_Name,35,71))<>"") Move ('"'+Trim(Mid(Clients.Client_Name,35,71))+'"') to s1
            Write   Channel 9   (Trim(s1))
            Write   Channel 9   sDeli // End of Excel Column R  è¢„®û™ úß‡§¨£Âò ßú¢·´û
            Write   Channel 9   sDeli // End of Excel Column S
            Write   Channel 9   sDeli // End of Excel Column T  ë¨§´¶£Âò ¶§Ê£ò´¶™ ßú¢·´û - Æ®û©†£¶ß¶†úÂ´ò† ö†ò ö®„ö¶®û ò§òù„´û©û
            Write   Channel 9   sDeli // End of Excel Column U  ë¨§´¶£Âò ¶§Ê£ò´¶™ ßú¢·´û „ ´Â´¢¶™ ú´ò†®Âò™ - Æ®û©†£¶ß¶†úÂ´ò† ö†ò ö®„ö¶®û ò§òù„´û©û
            Write   Channel 9   '"'
            Write   Channel 9   (Trim(Clients.Client_Address))
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column V  éõÊ™ ßú¢·´û
            Write   Channel 9   '"'
            Write   Channel 9   (Trim(Clients.Client_add_no))
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column W  Ä®†ü£Ê™
            Write   Channel 9   '"'
            Write   Channel 9   (Trim(Clients.Client_Zipcode))
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column X  í.â.
            Move "" to s1
            Clear Areas
            Move Clients.Client_Area to Areas.Area_id
            Find Eq Areas By Index.1
            Clear MIDHMOS
            Move (Trim(Areas.Area_Descr)) to MIDHMOS.Dhmos
            Find EQ MIDHMOS By Index.1
            If (Found)  Move (Trim(MIDHMOS.Dhmos))  to s1
            Else Begin
                Set psNotFoundClientDhmos to ("*** (Y) "+Trim(Areas.Area_Descr))
                Move "ZZZZ"               to s1
            End
            Write   Channel 9   '"'
            Write   Channel 9   s1
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column Y  É„£¶™
            Move "GR" to s1
            String sIsGreece
            Move s1 to sIsGreece
            Write   Channel 9   '"'
            Write   Channel 9   (Trim(s1))
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column Z  ïÈ®ò
            Move "" to s1
            Clear Cities
            Move Clients.Client_City_ID to cities.City_id
            Find Eq Cities By Index.1
            Clear MINOMOS
            Move (Trim(Cities.City_Descr)) to MINOMOS.DESCR
            Find EQ MINOMOS By Index.2
            If (Found)  Move (Trim(MINOMOS.CODE)) to s1
            Else Begin
                Set psNotFoundClientNomos to ("*** (AA) "+Trim(Cities.City_Descr))
                Move "ZZZZ"               to s1
            End
            Write   Channel 9   '"'
            Write   Channel 9   s1
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column AA å¶£Ê™
            Write   Channel 9   sDeli // End of Excel Column AB Éû£¶´†°„ Ñ§Ê´û´ò
            Write   Channel 9   '"'
            Write   Channel 9   'EL'
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column AC Ç¢È©©ò
            Write   Channel 9   '"'
            Write   Channel 9   (Trim(Clients.Client_Phone))
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column AD íû¢‚≠‡§¶ ßú¢·´û (âò´òÆÈ®û©û ßú®†©©Ê´ú®‡§ ´û¢ú≠È§‡§ ©´¶ sheet Communication)
            Write   Channel 9   '"'
            Write   Channel 9   (Trim(Clients.Client_Mobile))
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column AE "â†§û´Ê ßú¢·´û (âò´òÆÈ®û©û ßú®†©©Ê´ú®‡§ °†§û´È§ ©´¶ sheet Communication)
            Write   Channel 9   '"'
            Write   Channel 9   (Trim(Clients.Client_Fax))
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column AF Fax ßú¢·´û (âò´òÆÈ®û©û ßú®†©©Ê´ú®‡§ fax ©´¶ sheet Communication)
            Write   Channel 9   '"'
            Write   Channel 9   (Trim(Clients.Client_email))
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column AG Email ßú¢·´û (âò´òÆÈ®û©û ßú®†©©Ê´ú®‡§ e-mail ©´¶ sheet Communication)
            Write   Channel 9   sDeli // End of Excel Column AH ë¨£ß¢û®È§ú´ò† ¶ reference °‡õ†°Ê™ ß®¶£ûüú¨´„ ú·§ ¶ ßú¢·´û™ úÂ§ò† °ò† ß®¶£ûüú¨´„™
        
            Clear Codemast
            Move "JOB"              to Codemast.Type
            Move Clients.Client_Job to Codemast.Code
            Find Eq Codemast By Index.1
            Clear MIDRAST
            Move (Trim(Codemast.Description)) to MIDRAST.Descr
            Find Eq MIDRAST By Index.2
            If (Found) Move MIDRAST.Code to s1
            Else Begin
                Set psNotFoundClientDrast to ("*** (AI) "+Trim(Codemast.Description))
                Move "ZZZZ" to s1
            End
            Write   Channel 9   '"'
            Write   Channel 9   s1
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column AI É®ò©´û®†Ê´û´ò ßú¢·´û
        
            Write   Channel 9   '"'
            Write   Channel 9   (Trim(Clients.Client_AFM))
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column AJ "Äîã ìß¶Æ®ú‡´†°Ê ö†ò GR ßú¢·´ú™
            Move ("EL"+Trim(Clients.Client_AFM)) to s1
            Write   Channel 9   '"'
            Write   Channel 9   (Trim(s1))
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column AK EL+Äîã ìß¶Æ®ú‡´†°Ê ö†ò ßú¢·´ú™ Ñ¨®‡ßò‰°„™ Î§‡©û™
            Write   Channel 9   sDeli // End of Excel Column AL Éû£¶´†°„ Ñ§Ê´û´ò
            Write   Channel 9   sDeli // End of Excel Column AM Sales Office
            Write   Channel 9   sDeli // End of Excel Column AN Sales Group
            Write   Channel 9   sDeli // End of Excel Column AO Ñ®ö¶¢·ô¶™ / ãûÆò§†°Ê™
            Write   Channel 9   '"'
            Write   Channel 9   'EUR'
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column AP åÊ£†©£ò ßÈ¢û©û™
            Write   Channel 9   '"'
            Write   Channel 9   '1'
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column AQ è®¶©õ†¶®Âùú† ´û§ õ†òõ†°ò©Âò ´†£¶õÊ´û©û™
            Write   Channel 9   '"'
            Write   Channel 9   '1'
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column AR è®¶©õ†¶®Âùú† ´û§ ¶£·õò ©´ò´†©´†°È§ ßú¢·´û
            Write   Channel 9   '"'
            Write   Channel 9   '11'
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column AS ë¨§ü„°û òß¶©´¶¢„™
            Write   Channel 9   sDeli // End of Excel Column AT Ñ®ö¶©´·©†¶ ´®¶≠¶õ†©Âò™
            Write   Channel 9   '"'
            Write   Channel 9   'X'
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column AU ë¨£ß¢û®È§ú´ò† ú·§ û õ†òõ†°ò©Âò ´†£¶õÊ´û©û™ ß®òö£ò´¶ß¶†úÂ´ò† ö†ò ´¶§ ßú¢·´û
            Write   Channel 9   sDeli // End of Excel Column AV Incoterms
            Write   Channel 9   '"'
            Write   Channel 9   (Trim(fsTropoiPlhromhsPelath(Self,Trim(Clients.Polh_recr))))
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column AW Ó®¶† è¢û®‡£„™
            If (sLianikh="Z009")  Move "02" to s1
            Else                  Move "01" to s1
            Write   Channel 9   '"'
            Write   Channel 9   (Trim(s1))
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column Aï é£òõ¶ß¶Âû©û ö†ò ´¶§ ß®¶©õ†¶®†©£Ê ¢¶öò®†ò©£¶Á ú©Êõ‡§
            Write   Channel 9   '"'
            Write   Channel 9   'GR'
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column AY ïÈ®ò ≠¶®¶¢Êöû©û™
            Write   Channel 9   '"'
            Write   Channel 9   'MWST'
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column AÖ âò´ûö¶®Âò ≠Ê®¶¨
            Write   Channel 9   '"'
            Write   Channel 9   '0'
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column ÅA âò´ûö¶®†¶ß¶Âû©û ≠Ê®¶¨
            Write   Channel 9   sDeli // End of Excel Column ÅB Ä®. î¶®´ûöÈ§
            Write   Channel 9   sDeli // End of Excel Column ÅC ê¨ü£Ê™ èò®·õ¶©û™
            Write   Channel 9   sDeli // End of Excel Column ÅD íòÆÁ´û´ò Ñ°≠Ê®´‡©û™
            Write   Channel 9   sDeli // End of Excel Column ÅE Ñ¢¢ú†ß‚™ î¶®´Â¶
            Write   Channel 9   sDeli // End of Excel Column ÅF ã‚ö†©´û è¶©Ê´û´ò èò®·õ¶©û™
            Write   Channel 9   sDeli // End of Excel Column ÅG â‡õ†°Ê™ Î®ö¶¨ èú¢·´û
            Write   Channel 9   sDeli // End of Excel Column ÅH Ä®. Íõú†ò™ Î®ö¶¨
            Write   Channel 9   sDeli // End of Excel Column ÅI Ü£. Íõú†ò™ Î®ö¶¨
            Write   Channel 9   '"'
            Write   Channel 9   '3000000000'
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column ÅJ ä¶öò®†ò©£Ê™ ë¨£≠‡§Âò™
            Write   Channel 9   '"'
            Write   Channel 9   'R02'
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column ÅK é£òõ¶ß¶Âû©û ßú¢ò´È§ ö†ò ©°¶ß¶Á™ cash flow
            Write   Channel 9   sDeli // End of Excel Column ÅL É†ò©Á§õú©û âú§´®†°È§ - ìß¶°ò´·©´û£ò. ë¨£ß¢û®È§ú´ò† ö†ò Ê¢ò ´ò ‚®öò (header Ship - to) °ò† ¨ß¶ ‚®öò (ship - to)
            Write   Channel 9   sDeli // End of Excel Column ÅM ã‚ü¶õ¶™ ß¢û®‡£„™ ???
            Write   Channel 9   '"'
            Write   Channel 9   (Trim(fsTropoiPlhromhsPelath(Self,Trim(Clients.Polh_recr))))
            Write   Channel 9   '"'
            Write   Channel 9   sDeli // End of Excel Column ÅN
            //---
            Write   Channel 9   '"'
            Write   Channel 9   (Trim(psNotFoundClientDhmos(Self)))
            Write   Channel 9   '"'
            Write   Channel 9   sDeli
        
            Write   Channel 9   '"'
            Write   Channel 9   (Trim(psNotFoundClientNomos(Self)))
            Write   Channel 9   '"'
            Write   Channel 9   sDeli
        
            Write   Channel 9   '"'
            Write   Channel 9   (Trim(psNotFoundClientTrPlh(Self)))
            Write   Channel 9   '"'
            Write   Channel 9   sDeli
        
            Write   Channel 9   '"'
            Write   Channel 9   (Trim(psNotFoundClientDrast(Self)))
            Write   Channel 9   '"'
            //Write   Channel 9   sDeli
        
            //---
            Writeln Channel 9
        
            Send OutputPresp (Trim(sPrespID))
        
            // Ta erga tha pane me ton kodiko pelath pou diavazoume kai oxi
            // me ton endexomeno kodiko pelath pou pro yphrxe bash AFM kai
            // tou opoiou xrhsimopoihsame ta stoixeia tou.
            // Theloume ta erga tou pelath me allo kodiko alla idio AFM
            // Na desoune ston proto kodiko pelath pou vrethike me ayto to AFM
            Send OutputCN    (Trim(sClientID))
        
            // Aparaithth epanatopothethsh sto geniko loop
            // ton pelaton bash recnum afou endexetai na allaxame
            // trexon recod pelath and to afm tou yparxei hdh se allo pelath
            Clear Clients
            Move iRecnum to Clients.Recnum
            Find Eq Clients.Recnum
        
        End_Procedure
        
        
        
        Procedure OutputPresp String asPrespID
            String sPrespID s1
        
            Set psNotFoundPrespDhmos to ""
            Set psNotFoundPrespNomos to ""
            Set psNotFoundPrespDrast to ""
            Set psNotFoundPrespTrPlh to ""
        
            Clear Payresp
            Move asPrespID to Payresp.Presp_ID
            Find GE Payresp By Index.7
            While ((Found) And (Payresp.Presp_ID=asPrespID))
                String sDeli
                Move ","                to sDeli
                Move Payresp.Presp_ID   to sPrespID
                //---
                Write   Channel 9   '"'
                Write   Channel 9   'Y012'
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column B  é£·õò ä¶öò®†ò©£¶Á (ß.Æ. ßú¢·´û™, Ship - to °¢ß)
                Write   Channel 9   '"'
                Write   Channel 9   (Trim(Payresp.Presp_ID))
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column C  èò¢ò†Ê™ °Á®†¶™ °‡õ†°Ê™ ßú¢·´û SAP
                Write   Channel 9   sDeli // End of Excel Column D  ë¨£ß¢û®È§ú´ò† ö†ò ´¶¨™ Ship - to
                Write   Channel 9   sDeli // End of Excel Column E  ëú ßú®Âß´‡©û ß¶¨ ¶ ß¢û®‡´„™ õ†ò≠‚®ú† òßÊ ´¶§ Operational Customer, ©´¶§ Operational ¶®Âùú´ò† ¶ ß¢û®‡´„™
                Write   Channel 9   sDeli // End of Excel Column F  ëú ßú®Âß´‡©û ß¶¨ ¶ ß¢û®‡´„™ õ†ò≠‚®ú† òßÊ ´¶§ Operational Customer, ©´¶§ Operational ¶®Âùú´ò† ¶ ß¢û®‡´„™
                Write   Channel 9   sDeli // End of Excel Column G  ëú ßú®Âß´‡©û ß¶¨ ¶ ß¢û®‡´„™ õ†ò≠‚®ú† òßÊ ´¶§ Operational Customer, ©´¶§ Operational ¶®Âùú´ò† ¶ ß¢û®‡´„™
                Write   Channel 9   sDeli // End of Excel Column H  é®Âùú´ò† ¶ ú®ö¶¢·ô¶™ & Æ®û©†£¶ß¶†úÂ´ò† ¶ °‡õ†°Ê™ ß¶¨ ‚Æú† °ò´òÆ‡®ûüúÂ ©´¶ ò®ÆúÂ¶ "Customer Master Records_GR Others"
                Write   Channel 9   sDeli // End of Excel Column I  é®Âùú´ò† ¶ £ûÆò§†°Ê™ & Æ®û©†£¶ß¶†úÂ´ò† ¶ °‡õ†°Ê™ ß¶¨ ‚Æú† °ò´òÆ‡®ûüúÂ ©´¶ ò®ÆúÂ¶ "Customer Master Records_GR Others"
                Write   Channel 9   sDeli // End of Excel Column J  é®Âùú´ò† ¶ ß‡¢û´„™ & Æ®û©†£¶ß¶†úÂ´ò† ¶ °‡õ†°Ê™ ß¶¨ ‚Æú† °ò´òÆ‡®ûüúÂ ©´¶ ò®ÆúÂ¶ £ú´·ß´‡©û™ ß‡¢û´È§
                Write   Channel 9   '"'
                Write   Channel 9   'GR02'
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column K  â‡õ†°Ê™ Ñ´ò†®Âò™ Ñ¢¢·õò™
                Write   Channel 9   '"'
                Write   Channel 9   'GR02'
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column L é®öò§†©£Ê™ è‡¢„©ú‡§ Ñ¢¢·õò™
                Write   Channel 9   '"'
                Write   Channel 9   '03'
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column M âò§·¢† É†ò§¶£„™
                Write   Channel 9   '"'
                Write   Channel 9   '04'
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column N í£„£ò (Segment)
                Write   Channel 9   sDeli // End of Excel Column O  Ñ´ò†®†°„ §¶£†°„ ¶§´Ê´û´ò
                Write   Channel 9   '"'
                Write   Channel 9   (Trim(Left(Payresp.Presp_Name,35)))
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column P  Ó§¶£ò ìß. è¢û®
                Move "" to s1
                If (Trim(Mid(Payresp.Presp_Name,35,36))<>"") Move ('"'+Trim(Mid(Payresp.Presp_Name,35,36))+'"') to s1
                Write   Channel 9   (Trim(s1))
                Write   Channel 9   sDeli // End of Excel Column Q  ë¨£ß¢û®‡£ò´†°Ê ßúõÂ¶ ©ú ßú®Âß´‡©û ß¶¨ £„°¶™ ´¶¨ ßúõÂ¶¨ Name 1 õú§ úÂ§ò† úßò®°‚™
                Move "" to s1
                If (Trim(Mid(Payresp.Presp_Name,35,71))<>"") Move ('"'+Trim(Mid(Payresp.Presp_Name,35,71))+'"') to s1
                Write   Channel 9   (Trim(s1))
                Write   Channel 9   sDeli // End of Excel Column R  è¢„®û™ úß‡§¨£Âò ßú¢·´û
                Write   Channel 9   sDeli // End of Excel Column S
                Write   Channel 9   sDeli // End of Excel Column T  ë¨§´¶£Âò ¶§Ê£ò´¶™ ßú¢·´û - Æ®û©†£¶ß¶†úÂ´ò† ö†ò ö®„ö¶®û ò§òù„´û©û
                Write   Channel 9   sDeli // End of Excel Column U  ë¨§´¶£Âò ¶§Ê£ò´¶™ ßú¢·´û „ ´Â´¢¶™ ú´ò†®Âò™ - Æ®û©†£¶ß¶†úÂ´ò† ö†ò ö®„ö¶®û ò§òù„´û©û
                Write   Channel 9   '"'
                Write   Channel 9   (Trim(Payresp.Presp_Address))
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column V  éõÊ™ ßú¢·´û
                Write   Channel 9   '"'
                Write   Channel 9   (Trim(Payresp.Presp_add_no))
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column W  Ä®†ü£Ê™
                Write   Channel 9   '"'
                Write   Channel 9   (Trim(Payresp.Presp_Zipcode))
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column X  í.â.
        
                Move "" to s1
                Clear Areas
                Move Payresp.Presp_Area to Areas.Area_id
                Find Eq Areas By Index.1
                Clear MIDHMOS
                Move (Trim(Areas.Area_Descr)) to MIDHMOS.Dhmos
                Find EQ MIDHMOS By Index.1
                If (Found)  Move (Trim(MIDHMOS.Dhmos))  to s1
                Else Begin
                    Set psNotFoundPrespDhmos to ("*** (Y) "+Trim(Areas.Area_Descr))
                    Move "ZZZZ"              to s1
                End
                Write   Channel 9   '"'
                Write   Channel 9   s1
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column Y  É„£¶™
        
                Move "GR" to s1
                String sIsGreece
                Move s1 to sIsGreece
                Write   Channel 9   '"'
                Write   Channel 9   (Trim(s1))
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column Z  ïÈ®ò
        
        
                Move "" to s1
                Clear Cities
                Move Payresp.Presp_City_ID to cities.City_id
                Find Eq Cities By Index.1
                Clear MINOMOS
                Move (Trim(Cities.City_Descr)) to MINOMOS.DESCR
                Find EQ MINOMOS By Index.2
                If (Found)  Move (Trim(MINOMOS.CODE)) to s1
                Else Begin
                    Set psNotFoundPrespNomos to ("*** (AA) "+Trim(Cities.City_Descr))
                    Move "ZZZZ"              to s1
                End
                Write   Channel 9   '"'
                Write   Channel 9   s1
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column AA å¶£Ê™
                Write   Channel 9   sDeli // End of Excel Column AB Éû£¶´†°„ Ñ§Ê´û´ò
                Write   Channel 9   '"'
                Write   Channel 9   'EL'
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column AC Ç¢È©©ò
                Write   Channel 9   '"'
                Write   Channel 9   (Trim(Payresp.Presp_Phone))
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column AD íû¢‚≠‡§¶ ßú¢·´û (âò´òÆÈ®û©û ßú®†©©Ê´ú®‡§ ´û¢ú≠È§‡§ ©´¶ sheet Communication)
                Write   Channel 9   '"'
                Write   Channel 9   (Trim(Payresp.Presp_Mobile))
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column AE "â†§û´Ê ßú¢·´û (âò´òÆÈ®û©û ßú®†©©Ê´ú®‡§ °†§û´È§ ©´¶ sheet Communication)
                Write   Channel 9   '"'
                Write   Channel 9   (Trim(Payresp.Presp_Fax))
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column AF Fax ßú¢·´û (âò´òÆÈ®û©û ßú®†©©Ê´ú®‡§ fax ©´¶ sheet Communication)
                Write   Channel 9   '"'
                Write   Channel 9   (Trim(Payresp.Presp_email))
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column AG Email ßú¢·´û (âò´òÆÈ®û©û ßú®†©©Ê´ú®‡§ e-mail ©´¶ sheet Communication)
                Write   Channel 9   sDeli // End of Excel Column AH ë¨£ß¢û®È§ú´ò† ¶ reference °‡õ†°Ê™ ß®¶£ûüú¨´„ ú·§ ¶ ßú¢·´û™ úÂ§ò† °ò† ß®¶£ûüú¨´„™
        
                Clear Codemast
                Move "JOB"              to Codemast.Type
                Move Payresp.Presp_Job to Codemast.Code
                Find Eq Codemast By Index.1
                Clear MIDRAST
                Move (Trim(Codemast.Description)) to MIDRAST.Descr
                Find Eq MIDRAST By Index.2
                If (Found) Move MIDRAST.Code to s1
                Else Begin
                    Set psNotFoundPrespDrast to ("*** (AI) "+Trim(Codemast.Description))
                    Move "ZZZZ" to s1
                End
                Write   Channel 9   '"'
                Write   Channel 9   s1
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column AI É®ò©´û®†Ê´û´ò ßú¢·´û
        
                Write   Channel 9   '"'
                Write   Channel 9   (Trim(Payresp.Presp_AFM))
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column AJ "Äîã ìß¶Æ®ú‡´†°Ê ö†ò GR ßú¢·´ú™
                Move ("EL"+Trim(Payresp.Presp_AFM)) to s1
                Write   Channel 9   '"'
                Write   Channel 9   (Trim(s1))
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column AK EL+Äîã ìß¶Æ®ú‡´†°Ê ö†ò ßú¢·´ú™ Ñ¨®‡ßò‰°„™ Î§‡©û™
                Write   Channel 9   sDeli // End of Excel Column AL Éû£¶´†°„ Ñ§Ê´û´ò
                Write   Channel 9   sDeli // End of Excel Column AM Sales Office
                Write   Channel 9   sDeli // End of Excel Column AN Sales Group
                Write   Channel 9   sDeli // End of Excel Column AO Ñ®ö¶¢·ô¶™ / ãûÆò§†°Ê™
                Write   Channel 9   '"'
                Write   Channel 9   'EUR'
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column AP åÊ£†©£ò ßÈ¢û©û™
                Write   Channel 9   '"'
                Write   Channel 9   '1'
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column AQ è®¶©õ†¶®Âùú† ´û§ õ†òõ†°ò©Âò ´†£¶õÊ´û©û™
                Write   Channel 9   '"'
                Write   Channel 9   '1'
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column AR è®¶©õ†¶®Âùú† ´û§ ¶£·õò ©´ò´†©´†°È§ ßú¢·´û
                Write   Channel 9   '"'
                Write   Channel 9   '11'
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column AS ë¨§ü„°û òß¶©´¶¢„™
                Write   Channel 9   sDeli // End of Excel Column AT Ñ®ö¶©´·©†¶ ´®¶≠¶õ†©Âò™
                Write   Channel 9   sDeli // End of Excel Column AU ë¨£ß¢û®È§ú´ò† ú·§ û õ†òõ†°ò©Âò ´†£¶õÊ´û©û™ ß®òö£ò´¶ß¶†úÂ´ò† ö†ò ´¶§ ßú¢·´û
                Write   Channel 9   sDeli // End of Excel Column AV Incoterms
                Write   Channel 9   sDeli // End of Excel Column AW Ó®¶† è¢û®‡£„™
                Write   Channel 9   sDeli // End of Excel Column Aï é£òõ¶ß¶Âû©û ö†ò ´¶§ ß®¶©õ†¶®†©£Ê ¢¶öò®†ò©£¶Á ú©Êõ‡§
                Write   Channel 9   '"'
                Write   Channel 9   'GR'
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column AY ïÈ®ò ≠¶®¶¢Êöû©û™
                Write   Channel 9   '"'
                Write   Channel 9   'MWST'
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column AÖ âò´ûö¶®Âò ≠Ê®¶¨
                Write   Channel 9   '"'
                Write   Channel 9   '0'
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column ÅA âò´ûö¶®†¶ß¶Âû©û ≠Ê®¶¨
                Write   Channel 9   sDeli // End of Excel Column ÅB Ä®. î¶®´ûöÈ§
                Write   Channel 9   sDeli // End of Excel Column ÅC ê¨ü£Ê™ èò®·õ¶©û™
                Write   Channel 9   sDeli // End of Excel Column ÅD íòÆÁ´û´ò Ñ°≠Ê®´‡©û™
                Write   Channel 9   sDeli // End of Excel Column ÅE Ñ¢¢ú†ß‚™ î¶®´Â¶
                Write   Channel 9   sDeli // End of Excel Column ÅF ã‚ö†©´û è¶©Ê´û´ò èò®·õ¶©û™
                Write   Channel 9   sDeli // End of Excel Column ÅG â‡õ†°Ê™ Î®ö¶¨ èú¢·´û
                Write   Channel 9   sDeli // End of Excel Column ÅH Ä®. Íõú†ò™ Î®ö¶¨
                Write   Channel 9   sDeli // End of Excel Column ÅI Ü£. Íõú†ò™ Î®ö¶¨
                Write   Channel 9   '"'
                Write   Channel 9   '3000000000'
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column ÅJ ä¶öò®†ò©£Ê™ ë¨£≠‡§Âò™
                Write   Channel 9   '"'
                Write   Channel 9   'R02'
                Write   Channel 9   '"'
                Write   Channel 9   sDeli // End of Excel Column ÅK é£òõ¶ß¶Âû©û ßú¢ò´È§ ö†ò ©°¶ß¶Á™ cash flow
                Write   Channel 9   sDeli // End of Excel Column ÅL É†ò©Á§õú©û âú§´®†°È§ - ìß¶°ò´·©´û£ò. ë¨£ß¢û®È§ú´ò† ö†ò Ê¢ò ´ò ‚®öò (header Ship - to) °ò† ¨ß¶ ‚®öò (ship - to)
                Write   Channel 9   sDeli // End of Excel Column ÅM ã‚ü¶õ¶™ ß¢û®‡£„™
                Write   Channel 9   sDeli // End of Excel Column ÅN Terms of Payment
                //---
        
                Write   Channel 9   '"'
                Write   Channel 9   (Trim(psNotFoundPrespDhmos(Self)))
                Write   Channel 9   '"'
                Write   Channel 9   sDeli
        
                Write   Channel 9   '"'
                Write   Channel 9   (Trim(psNotFoundPrespNomos(Self)))
                Write   Channel 9   '"'
                Write   Channel 9   sDeli
        
                Write   Channel 9   '"'
                Write   Channel 9   (Trim(psNotFoundPrespTrPlh(Self)))
                Write   Channel 9   '"'
                Write   Channel 9   sDeli
        
                Write   Channel 9   '"'
                Write   Channel 9   (Trim(psNotFoundPrespDrast(Self)))
                Write   Channel 9   '"'
                //Write   Channel 9   sDeli
        
                //---
                Writeln Channel 9
        
                Find GT Payresp By Index.7
        
            Loop
        End_Procedure
        
        
        Procedure OutputCN String asClientID
        
            String sSLS sCNT sMHX
        
            Clear CN
            Move asClientID to CN.Client_ID
            Find GE CN By Index.4 // Client_ID+CN_Code
            While ((Found) And (CN.Client_ID=asClientID))
        
                If (CN.ExportFlag=1) Begin
        
                    Set psNotFoundErgoDhmos to ""
                    Set psNotFoundErgoNomos to ""
                    Set psNotFoundErgoDrast to ""
                    Set psNotFoundErgoTrPlh to ""
        
        
                    //If (CN.CN_Code="01.AC.03565") Begin
                    //    Showln "01.AC.03565"
                    //End
        
                    String sDeli
                    Move "," to sDeli
                    //---
                    Write   Channel 9   '"'
                    Write   Channel 9   'Y005'
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli // End of Excel Column B  é£·õò ä¶öò®†ò©£¶Á (ß.Æ. ßú¢·´û™, Ship - to °¢ß)
                    Write   Channel 9   '"'
                    Write   Channel 9   (Trim(CN.CN_Code))
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli // End of Excel Column C  èò¢ò†Ê™ °Á®†¶™ °‡õ†°Ê™ Ñ®ö¶¨
                    Write   Channel 9   '"'
                    Write   Channel 9   (Trim(CN.Client_ID))
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli // End of Excel Column D  â‡õ. èú¢·´û
                    Write   Channel 9   sDeli // End of Excel Column E  ëú ßú®Âß´‡©û ß¶¨ ¶ ß¢û®‡´„™ õ†ò≠‚®ú† òßÊ ´¶§ Operational Customer, ©´¶§ Operational ¶®Âùú´ò† ¶ ß¢û®‡´„™
                    Write   Channel 9   sDeli // End of Excel Column F  ëú ßú®Âß´‡©û ß¶¨ ¶ ß¢û®‡´„™ õ†ò≠‚®ú† òßÊ ´¶§ Operational Customer, ©´¶§ Operational ¶®Âùú´ò† ¶ ß¢û®‡´„™
                    Write   Channel 9   sDeli // End of Excel Column G  ëú ßú®Âß´‡©û ß¶¨ ¶ ß¢û®‡´„™ õ†ò≠‚®ú† òßÊ ´¶§ Operational Customer, ©´¶§ Operational ¶®Âùú´ò† ¶ ß¢û®‡´„™
        
                    Clear Constrct
                    Move CN.CN_Cnt_Recr to Constrct.Cnt_Recr
                    Find Eq Constrct By Index.2
                    Write   Channel 9   '"'
                    Write   Channel 9   (Trim(Constrct.Cnt_ID))
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli // End of Excel Column H  é®Âùú´ò† ¶ ú®ö¶¢·ô¶™ & Æ®û©†£¶ß¶†úÂ´ò† ¶ °‡õ†°Ê™ ß¶¨ ‚Æú† °ò´òÆ‡®ûüúÂ ©´¶ ò®ÆúÂ¶ "Customer Master Records_GR Others"
        
                    Write   Channel 9   '"'
                    Write   Channel 9   (Trim(CN.Mhxanik_ID))
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli // End of Excel Column I  é®Âùú´ò† ¶ £ûÆò§†°Ê™ & Æ®û©†£¶ß¶†úÂ´ò† ¶ °‡õ†°Ê™ ß¶¨ ‚Æú† °ò´òÆ‡®ûüúÂ ©´¶ ò®ÆúÂ¶ "Customer Master Records_GR Others"
        
                    Clear Salesmen
                    Move CN.CN_Sls_Recr to Salesmen.Sls_Recr
                    Find Eq Salesmen By Index.2
                    Write   Channel 9   '"'
                    Write   Channel 9   (Trim(Salesmen.Sls_ID))
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli // End of Excel Column J  é®Âùú´ò† ¶ ß‡¢û´„™ & Æ®û©†£¶ß¶†úÂ´ò† ¶ °‡õ†°Ê™ ß¶¨ ‚Æú† °ò´òÆ‡®ûüúÂ ©´¶ ò®ÆúÂ¶ £ú´·ß´‡©û™ ß‡¢û´È§
        
                    Move (Trim(Salesmen.Sls_ID))    to sSLS
                    Move (Trim(Constrct.Cnt_ID))    to sCNT
                    Move (Trim(CN.Mhxanik_ID))      to sMHX
        
        
                    Write   Channel 9   '"'
                    Write   Channel 9   'GR02'
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli // End of Excel Column K  â‡õ†°Ê™ Ñ´ò†®Âò™ Ñ¢¢·õò™
                    Write   Channel 9   '"'
                    Write   Channel 9   'GR02'
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli // End of Excel Column L é®öò§†©£Ê™ è‡¢„©ú‡§ Ñ¢¢·õò™
                    Write   Channel 9   '"'
                    Write   Channel 9   '03'
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli // End of Excel Column M âò§·¢† É†ò§¶£„™
                    Write   Channel 9   '"'
                    Write   Channel 9   '04'
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli // End of Excel Column N í£„£ò (Segment)
                    Write   Channel 9   sDeli // End of Excel Column O  Ñ´ò†®†°„ §¶£†°„ ¶§´Ê´û´ò
                    Write   Channel 9   '"'
                    Write   Channel 9   (Trim(Left(CN.CN_Descr,35)))
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli // End of Excel Column P  èú®†ö®ò≠û Ñ®ö¶¨
                    String s1
                    Move "" to s1
                    If (Trim(Mid(CN.CN_Descr,35,36))<>"") Move ('"'+Trim(Mid(CN.CN_Descr,35,36))+'"') to s1
                    Write   Channel 9   (Trim(s1))
                    Write   Channel 9   sDeli // End of Excel Column Q  ë¨£ß¢û®‡£ò´†°Ê ßúõÂ¶ ©ú ßú®Âß´‡©û ß¶¨ £„°¶™ ´¶¨ ßúõÂ¶¨ Name 1 õú§ úÂ§ò† úßò®°‚™
                    Move "" to s1
                    If (Trim(Mid(CN.CN_Descr,35,71))<>"") Move ('"'+Trim(Mid(CN.CN_Descr,35,71))+'"') to s1
                    Write   Channel 9   (Trim(s1))
                    Write   Channel 9   sDeli // End of Excel Column R  è¢„®û™ úß‡§¨£Âò ßú¢·´û
                    Write   Channel 9   sDeli // End of Excel Column S
                    Write   Channel 9   sDeli // End of Excel Column T  ë¨§´¶£Âò ¶§Ê£ò´¶™ ßú¢·´û - Æ®û©†£¶ß¶†úÂ´ò† ö†ò ö®„ö¶®û ò§òù„´û©û
                    Write   Channel 9   sDeli // End of Excel Column U  ë¨§´¶£Âò ¶§Ê£ò´¶™ ßú¢·´û „ ´Â´¢¶™ ú´ò†®Âò™ - Æ®û©†£¶ß¶†úÂ´ò† ö†ò ö®„ö¶®û ò§òù„´û©û
                    Write   Channel 9   '"'
                    Write   Channel 9   (Trim(CN.CN_Address))
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli // End of Excel Column V  éõÊ™ ßú¢·´û
                    Write   Channel 9   '"'
                    Write   Channel 9   (Trim(CN.CN_add_no))
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli // End of Excel Column W  Ä®†ü£Ê™
                    Write   Channel 9   '"'
                    Write   Channel 9   (Trim(CN.CN_Zipcode))
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli // End of Excel Column X  í.â.
        
                    //If (CN.CN_Code="01.AC.03565") Begin
                    //    Showln "01.AC.03565"
                    //End
        
                    Move "" to s1
                    Clear Areas
                    Move CN.CN_Area to Areas.Area_id
                    Find Eq Areas By Index.1
                    Clear MIDHMOS
                    Move (Trim(Areas.Area_Descr)) to MIDHMOS.Dhmos
                    Find EQ MIDHMOS By Index.1
                    If (Found)  Move (Trim(MIDHMOS.Dhmos))  to s1
                    Else Begin
                        Set psNotFoundErgoDhmos to ("*** (Y) "+Trim(Areas.Area_Descr))
                        Move "ZZZZ"             to s1
                    End
                    Write   Channel 9   '"'
                    Write   Channel 9   s1
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli // End of Excel Column Y  É„£¶™
        
                    Move "GR" to s1
                    String sIsGreece
                    Move s1 to sIsGreece
                    Write   Channel 9   '"'
                    Write   Channel 9   (Trim(s1))
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli // End of Excel Column Z  ïÈ®ò
        
                    Move "" to s1
                    Clear Cities
                    Move CN.CN_City to cities.City_id
                    Find Eq Cities By Index.1
                    Clear MINOMOS
                    Move (Trim(Cities.City_Descr)) to MINOMOS.DESCR
                    Find EQ MINOMOS By Index.2
                    If (Found)  Move (Trim(MINOMOS.CODE)) to s1
                    Else Begin
                        Set psNotFoundErgoNomos to ("*** (AA) "+Trim(Cities.City_Descr))
                        Move "ZZZZ"             to s1
                    End
                    Write   Channel 9   '"'
                    Write   Channel 9   s1
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli // End of Excel Column AA å¶£Ê™
                    Write   Channel 9   sDeli // End of Excel Column AB Éû£¶´†°„ Ñ§Ê´û´ò
                    Write   Channel 9   sDeli // End of Excel Column AC Ç¢È©©ò
                    Write   Channel 9   sDeli // End of Excel Column AD íû¢‚≠‡§¶ ßú¢·´û (âò´òÆÈ®û©û ßú®†©©Ê´ú®‡§ ´û¢ú≠È§‡§ ©´¶ sheet Communication)
                    Write   Channel 9   sDeli // End of Excel Column AE "â†§û´Ê ßú¢·´û (âò´òÆÈ®û©û ßú®†©©Ê´ú®‡§ °†§û´È§ ©´¶ sheet Communication)
                    Write   Channel 9   sDeli // End of Excel Column AF Fax ßú¢·´û (âò´òÆÈ®û©û ßú®†©©Ê´ú®‡§ fax ©´¶ sheet Communication)
                    Write   Channel 9   sDeli // End of Excel Column AG Email ßú¢·´û (âò´òÆÈ®û©û ßú®†©©Ê´ú®‡§ e-mail ©´¶ sheet Communication)
                    Write   Channel 9   sDeli // End of Excel Column AH ë¨£ß¢û®È§ú´ò† ¶ reference °‡õ†°Ê™ ß®¶£ûüú¨´„ ú·§ ¶ ßú¢·´û™ úÂ§ò† °ò† ß®¶£ûüú¨´„™
                    Write   Channel 9   sDeli // End of Excel Column AI É®ò©´û®†Ê´û´ò ßú¢·´û
                    Write   Channel 9   sDeli // End of Excel Column AJ "Äîã ìß¶Æ®ú‡´†°Ê ö†ò GR ßú¢·´ú™
                    Write   Channel 9   sDeli // End of Excel Column AK EL+Äîã ìß¶Æ®ú‡´†°Ê ö†ò ßú¢·´ú™ Ñ¨®‡ßò‰°„™ Î§‡©û™
                    Write   Channel 9   sDeli // End of Excel Column AL Éû£¶´†°„ Ñ§Ê´û´ò
        
                    Clear Branch
                    Move CN.Company_Code    to Branch.Company_Code
                    Move CN.Branch_Code     to Branch.Branch_Code
                    Find Eq Branch By Index.1
                    Write   Channel 9   '"'
                    Write   Channel 9   (Trim(Branch.Branch_Resp))
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli // End of Excel Column AM Sales Office
                    Write   Channel 9   '"'
                    Write   Channel 9   (Trim(Branch.Branch_Bitmap))
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli // End of Excel Column AN Sales Group
                    Write   Channel 9   sDeli // End of Excel Column AO Customer Group Ñ®ö¶¢·ô¶™ / ãûÆò§†°Ê™
                    Write   Channel 9   '"'
                    Write   Channel 9   'EUR'
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli // End of Excel Column AP åÊ£†©£ò ßÈ¢û©û™
                    Write   Channel 9   '"'
                    Write   Channel 9   '1'
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli // End of Excel Column AQ è®¶©õ†¶®Âùú† ´û§ õ†òõ†°ò©Âò ´†£¶õÊ´û©û™
                    Write   Channel 9   '"'
                    Write   Channel 9   '1'
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli // End of Excel Column AR è®¶©õ†¶®Âùú† ´û§ ¶£·õò ©´ò´†©´†°È§ ßú¢·´û
                    Write   Channel 9   '"'
                    Write   Channel 9   '11'
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli // End of Excel Column AS ë¨§ü„°û òß¶©´¶¢„™
                    Write   Channel 9   '"'
                    Write   Channel 9   (Trim(Branch.Branch_Email))
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli // End of Excel Column AT Ñ®ö¶©´·©†¶ ´®¶≠¶õ†©Âò™
                    Write   Channel 9   '"'
                    Write   Channel 9   'X'
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli // End of Excel Column AU ë¨£ß¢û®È§ú´ò† ú·§ û õ†òõ†°ò©Âò ´†£¶õÊ´û©û™ ß®òö£ò´¶ß¶†úÂ´ò† ö†ò ´¶§ ßú¢·´û
                    Write   Channel 9   sDeli // End of Excel Column AV Incoterms
                    Write   Channel 9   sDeli // End of Excel Column AW Ó®¶† è¢û®‡£„™
                    Write   Channel 9   sDeli // End of Excel Column Aï é£òõ¶ß¶Âû©û ö†ò ´¶§ ß®¶©õ†¶®†©£Ê ¢¶öò®†ò©£¶Á ú©Êõ‡§
                    Write   Channel 9   '"'
                    Write   Channel 9   'GR'
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli // End of Excel Column AY ïÈ®ò ≠¶®¶¢Êöû©û™
                    Write   Channel 9   '"'
                    Write   Channel 9   'MWST'
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli // End of Excel Column AÖ âò´ûö¶®Âò ≠Ê®¶¨
                    Write   Channel 9   '"'
                    Write   Channel 9   '0'
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli // End of Excel Column ÅA âò´ûö¶®†¶ß¶Âû©û ≠Ê®¶¨
                    Write   Channel 9   sDeli // End of Excel Column ÅB Ä®. î¶®´ûöÈ§
                    Write   Channel 9   sDeli // End of Excel Column ÅC ê¨ü£Ê™ èò®·õ¶©û™
                    Write   Channel 9   sDeli // End of Excel Column ÅD íòÆÁ´û´ò Ñ°≠Ê®´‡©û™
        
                    Move "" to s1
                    Date dHm
                    Move "31/12/2100" to dHm
                    Clear BtnOrdH
                    Move asClientID     to BtnOrdH.Client_ID
                    Move CN.CN_Code     to BtnOrdH.CN_Code
                    Move dHm            to BtnOrdH.Deop_Lhxh
                    Move "ZZZZZZZZZZ"   to BtnOrdH.AA_Deop
                    Move "ZZZZZZZZZZ"   to BtnOrdH.Recr
                    Find LE BtnOrdH By Index.6
                    If ((Found) And (BtnOrdH.Client_ID=asClientID) And (BtnOrdH.CN_Code=CN.CN_Code)) Begin
                        Move ('"'+String(Btnordh.Eleiph)+'"') to s1
                    End
                    Write   Channel 9   (Trim(s1))
                    Write   Channel 9   sDeli // End of Excel Column ÅE Ñ¢¢ú†ß‚™ î¶®´Â¶
        
                    Write   Channel 9   sDeli // End of Excel Column ÅF ã‚ö†©´û è¶©Ê´û´ò èò®·õ¶©û™
                    Write   Channel 9   sDeli // End of Excel Column ÅG â‡õ†°Ê™ Î®ö¶¨ èú¢·´û
                    Write   Channel 9   sDeli // End of Excel Column ÅH Ä®. Íõú†ò™ Î®ö¶¨
                    Write   Channel 9   sDeli // End of Excel Column ÅI Ü£. Íõú†ò™ Î®ö¶¨
                    Write   Channel 9   sDeli // End of Excel Column ÅJ ä¶öò®†ò©£Ê™ ë¨£≠‡§Âò™
                    Write   Channel 9   sDeli // End of Excel Column ÅK é£òõ¶ß¶Âû©û ßú¢ò´È§ ö†ò ©°¶ß¶Á™ cash flow
                    Write   Channel 9   sDeli // End of Excel Column ÅL É†ò©Á§õú©û âú§´®†°È§ - ìß¶°ò´·©´û£ò. ë¨£ß¢û®È§ú´ò† ö†ò Ê¢ò ´ò ‚®öò (header Ship - to) °ò† ¨ß¶ ‚®öò (ship - to)
                    Write   Channel 9   sDeli // End of Excel Column ÅM ã‚ü¶õ¶™ ß¢û®‡£„™ ???
                    Write   Channel 9   sDeli // End of Excel Column ÅN
                    //---
        
                    Write   Channel 9   '"'
                    Write   Channel 9   (Trim(psNotFoundErgoDhmos(Self)))
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli
        
                    Write   Channel 9   '"'
                    Write   Channel 9   (Trim(psNotFoundErgoNomos(Self)))
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli
        
                    Write   Channel 9   '"'
                    Write   Channel 9   (Trim(psNotFoundErgoTrPlh(Self)))
                    Write   Channel 9   '"'
                    Write   Channel 9   sDeli
        
                    Write   Channel 9   '"'
                    Write   Channel 9   (Trim(psNotFoundErgoDrast(Self)))
                    Write   Channel 9   '"'
                    //Write   Channel 9   sDeli
        
                    //---
                    Writeln Channel 9
        
        
                    Send Output_Others
        
                End // If (CN.Exportflag=1)
        
                Find GT CN By Index.4 // Client_ID+CN_Code
            Loop
        End_Procedure
        
        
        Procedure Output_Others
            String sDeli s1
            Move "," to sDeli
        
            Set psNotFoundMhxanDhmos to ""
            Set psNotFoundMhxanNomos to ""
            Set psNotFoundMhxanDrast to ""
            Set psNotFoundMhxanTrPlh to ""
        
            Set psNotFoundConstrDhmos to ""
            Set psNotFoundConstrNomos to ""
            Set psNotFoundConstrDrast to ""
            Set psNotFoundConstrTrPlh to ""
        
            Set psNotFoundSalesDhmos to ""
            Set psNotFoundSalesNomos to ""
            Set psNotFoundSalesDrast to ""
            Set psNotFoundSalesTrPlh to ""
        
            If (CN.Mhxanik_ID<>"") Begin
                Clear Mhxanik
                Move CN.Mhxanik_ID to Mhxanik.Mhx_ID
                Find Eq Mhxanik By Index.4
                If (Found) Begin
                    Clear tmpPagia
                    Move "02"           to tmpPagia.Company_Code
                    Move CN.Mhxanik_ID  to tmpPagia.Pagia_Code
                    Find Eq tmpPagia By Index.1
                    If (Not(Found)) Begin
                        Saverecord tmpPagia
                        //---
                        Write   Channel 7   '"'
                        Write   Channel 7   '02'
                        Write   Channel 7   '"'
                        Write   Channel 7   sDeli // End of Excel Column B  é£·õò ä¶öò®†ò©£¶Á (ß.Æ. ßú¢·´û™, Ship - to °¢ß)
                        Write   Channel 7   '"'
                        Write   Channel 7   (Trim(Mhxanik.Mhx_ID))
                        Write   Channel 7   '"'
                        Write   Channel 7   sDeli // End of Excel Column C  èò¢ò†Ê™ °Á®†¶™ °‡õ†°Ê™ ßú¢·´û SAP
                        Write   Channel 7   sDeli // End of Excel Column D  ë¨£ß¢û®È§ú´ò† ö†ò ´¶¨™ Ship - to
                        Write   Channel 7   sDeli // End of Excel Column E  ëú ßú®Âß´‡©û ß¶¨ ¶ ß¢û®‡´„™ õ†ò≠‚®ú† òßÊ ´¶§ Operational Customer, ©´¶§ Operational ¶®Âùú´ò† ¶ ß¢û®‡´„™
                        Write   Channel 7   sDeli // End of Excel Column F  ëú ßú®Âß´‡©û ß¶¨ ¶ ß¢û®‡´„™ õ†ò≠‚®ú† òßÊ ´¶§ Operational Customer, ©´¶§ Operational ¶®Âùú´ò† ¶ ß¢û®‡´„™
                        Write   Channel 7   '"'
                        Write   Channel 7   (Trim(Left(Mhxanik.Mhx_Name,35)))
                        Write   Channel 7   '"'
                        Write   Channel 7   sDeli // End of Excel Column G  Ó§¶£ò ìß. è¢û®
                        Move "" to s1
                        If (Trim(Mid(Mhxanik.Mhx_Name,35,36))<>"") Move ('"'+Trim(Mid(Mhxanik.Mhx_Name,35,36))+'"') to s1
                        Write   Channel 7   (Trim(s1))
                        Write   Channel 7   sDeli // End of Excel Column H  ë¨£ß¢û®‡£ò´†°Ê ßúõÂ¶ ©ú ßú®Âß´‡©û ß¶¨ £„°¶™ ´¶¨ ßúõÂ¶¨ Name 1 õú§ úÂ§ò† úßò®°‚™
                        Write   Channel 7   sDeli // End of Excel Column I  é®Âùú´ò† ¶ £ûÆò§†°Ê™ & Æ®û©†£¶ß¶†úÂ´ò† ¶ °‡õ†°Ê™ ß¶¨ ‚Æú† °ò´òÆ‡®ûüúÂ ©´¶ ò®ÆúÂ¶ "Customer Master Records_GR Others"
                        Write   Channel 7   sDeli // End of Excel Column J  é®Âùú´ò† ¶ ß‡¢û´„™ & Æ®û©†£¶ß¶†úÂ´ò† ¶ °‡õ†°Ê™ ß¶¨ ‚Æú† °ò´òÆ‡®ûüúÂ ©´¶ ò®ÆúÂ¶ £ú´·ß´‡©û™ ß‡¢û´È§
        
                        Write   Channel 7   '"'
                        Write   Channel 7   (Trim(Mhxanik.Mhx_Address))
                        Write   Channel 7   '"'
                        Write   Channel 7   sDeli // End of Excel Column K  éõÊ™ ßú¢·´û
                        Write   Channel 7   '"'
                        Write   Channel 7   (Trim(Mhxanik.Mhx_add_no))
                        Write   Channel 7   '"'
                        Write   Channel 7   sDeli // End of Excel Column L  Ä®†ü£Ê™
                        Write   Channel 7   '"'
                        Write   Channel 7   (Trim(Mhxanik.Mhx_Zipcode))
                        Write   Channel 7   '"'
                        Write   Channel 7   sDeli // End of Excel Column M  í.â.
        
                        Move "" to s1
                        Clear Areas
                        Move Mhxanik.Mhx_Area to Areas.Area_id
                        Find Eq Areas By Index.1
                        Clear MIDHMOS
                        Move (Trim(Areas.Area_Descr)) to MIDHMOS.Dhmos
                        Find EQ MIDHMOS By Index.1
                        If (Found)  Move (Trim(MIDHMOS.Dhmos))  to s1
                        Else Begin
                            Set psNotFoundMhxanDhmos to ("*** (N) "+Trim(Areas.Area_Descr))
                            Move "ZZZZ"              to s1
                        End
                        Write   Channel 7   '"'
                        Write   Channel 7   s1
                        Write   Channel 7   '"'
                        Write   Channel 7   sDeli // End of Excel Column N  É„£¶™
        
                        Move "GR" to s1
                        String sIsGreece
                        Move s1 to sIsGreece
                        Write   Channel 7   '"'
                        Write   Channel 7   (Trim(s1))
                        Write   Channel 7   '"'
                        Write   Channel 7   sDeli // End of Excel Column O  ïÈ®ò
        
        
                        Move "" to s1
                        Clear Cities
                        Move Mhxanik.Mhx_City to cities.City_id
                        Find Eq Cities By Index.1
                        Clear MINOMOS
                        Move (Trim(Cities.City_Descr)) to MINOMOS.DESCR
                        Find EQ MINOMOS By Index.2
                        If (Found)  Move (Trim(MINOMOS.CODE)) to s1
                        Else Begin
                            Set psNotFoundMhxanNomos to ("*** (P) "+Trim(Cities.City_Descr))
                            Move "ZZZZ"              to s1
                        End
                        Write   Channel 7   '"'
                        Write   Channel 7   s1
                        Write   Channel 7   '"'
                        Write   Channel 7   sDeli // End of Excel Column P
                        Write   Channel 7   sDeli // End of Excel Column Q
                        Write   Channel 7   sDeli // End of Excel Column R
                        Write   Channel 7   '"'
                        Write   Channel 7   (Trim(Mhxanik.Mhx_Phone))
                        Write   Channel 7   '"'
                        Write   Channel 7   sDeli // End of Excel Column S
                        Write   Channel 7   '"'
                        Write   Channel 7   (Trim(Mhxanik.Mhx_Mobile))
                        Write   Channel 7   '"'
                        Write   Channel 7   sDeli // End of Excel Column T
                        Write   Channel 7   '"'
                        Write   Channel 7   (Trim(Mhxanik.Mhx_Fax))
                        Write   Channel 7   '"'
                        Write   Channel 7   sDeli // End of Excel Column U
                        Write   Channel 7   '"'
                        Write   Channel 7   (Trim(Mhxanik.Mhx_Email))
                        Write   Channel 7   '"'
                        Write   Channel 7   sDeli // End of Excel Column V
                        Write   Channel 7   sDeli // End of Excel Column W
                        Write   Channel 7   '"'
                        Write   Channel 7   (Trim(Mhxanik.Mhx_AFM))
                        Write   Channel 7   '"'
                        Write   Channel 7   sDeli // End of Excel Column X
                        Write   Channel 7   '"'
                        Write   Channel 7   ("EL"+Trim(Mhxanik.Mhx_AFM))
                        Write   Channel 7   '"'
                        Write   Channel 7   sDeli // End of Excel Column Y
                        Write   Channel 7   sDeli // End of Excel Column Z
                        Write   Channel 7   sDeli // End of Excel Column AA
                        //---
        
                        Write   Channel 7   '"'
                        Write   Channel 7   (Trim(psNotFoundMhxanDhmos(Self)))
                        Write   Channel 7   '"'
                        Write   Channel 7   sDeli
        
                        Write   Channel 7   '"'
                        Write   Channel 7   (Trim(psNotFoundMhxanNomos(Self)))
                        Write   Channel 7   '"'
                        Write   Channel 7   sDeli
        
                        Write   Channel 7   '"'
                        Write   Channel 7   (Trim(psNotFoundMhxanTrPlh(Self)))
                        Write   Channel 7   '"'
                        Write   Channel 7   sDeli
        
                        Write   Channel 7   '"'
                        Write   Channel 7   (Trim(psNotFoundMhxanDrast(Self)))
                        Write   Channel 7   '"'
                        //Write   Channel 7   sDeli
        
                        //---
                        Writeln Channel 7
                    End // If not found tmpPagia
                End // If (Found) Begin
            End // If (CN.Mhxanik_ID<>"") Begin
        
        
        
            If (CN.CN_CNT_ID<>"") Begin
                Clear Constrct
                Move CN.CN_CNT_ID to Constrct.CNT_ID
                Find Eq Constrct By Index.5
                If (Found) Begin
                    //---
                    Clear tmpPagia
                    Move "03"           to tmpPagia.Company_Code
                    Move CN.CN_CNT_ID   to tmpPagia.Pagia_Code
                    Find Eq tmpPagia By Index.1
                    If (Not(Found)) Begin
                        Saverecord tmpPagia
                        //---
                        Write   Channel 8   '"'
                        Write   Channel 8   '03'
                        Write   Channel 8   '"'
                        Write   Channel 8   sDeli // End of Excel Column B  é£·õò ä¶öò®†ò©£¶Á (ß.Æ. ßú¢·´û™, Ship - to °¢ß)
                        Write   Channel 8   '"'
                        Write   Channel 8   (Trim(Constrct.CNT_ID))
                        Write   Channel 8   '"'
                        Write   Channel 8   sDeli // End of Excel Column C  èò¢ò†Ê™ °Á®†¶™ °‡õ†°Ê™ ßú¢·´û SAP
                        Write   Channel 8   sDeli // End of Excel Column D  ë¨£ß¢û®È§ú´ò† ö†ò ´¶¨™ Ship - to
                        Write   Channel 8   sDeli // End of Excel Column E  ëú ßú®Âß´‡©û ß¶¨ ¶ ß¢û®‡´„™ õ†ò≠‚®ú† òßÊ ´¶§ Operational Customer, ©´¶§ Operational ¶®Âùú´ò† ¶ ß¢û®‡´„™
                        Write   Channel 8   sDeli // End of Excel Column F  ëú ßú®Âß´‡©û ß¶¨ ¶ ß¢û®‡´„™ õ†ò≠‚®ú† òßÊ ´¶§ Operational Customer, ©´¶§ Operational ¶®Âùú´ò† ¶ ß¢û®‡´„™
                        Write   Channel 8   '"'
                        Write   Channel 8   (Trim(Left(Constrct.CNT_Name,35)))
                        Write   Channel 8   '"'
                        Write   Channel 8   sDeli // End of Excel Column G  Ó§¶£ò ìß. è¢û®
                        Move "" to s1
                        If (Trim(Mid(Constrct.CNT_Name,35,36))<>"") Move ('"'+Trim(Mid(Constrct.CNT_Name,35,36))+'"') to s1
                        Write   Channel 8   (Trim(s1))
                        Write   Channel 8   sDeli // End of Excel Column H  ë¨£ß¢û®‡£ò´†°Ê ßúõÂ¶ ©ú ßú®Âß´‡©û ß¶¨ £„°¶™ ´¶¨ ßúõÂ¶¨ Name 1 õú§ úÂ§ò† úßò®°‚™
                        Write   Channel 8   sDeli // End of Excel Column I  é®Âùú´ò† ¶ £ûÆò§†°Ê™ & Æ®û©†£¶ß¶†úÂ´ò† ¶ °‡õ†°Ê™ ß¶¨ ‚Æú† °ò´òÆ‡®ûüúÂ ©´¶ ò®ÆúÂ¶ "Customer Master Records_GR Others"
                        Write   Channel 8   sDeli // End of Excel Column J  é®Âùú´ò† ¶ ß‡¢û´„™ & Æ®û©†£¶ß¶†úÂ´ò† ¶ °‡õ†°Ê™ ß¶¨ ‚Æú† °ò´òÆ‡®ûüúÂ ©´¶ ò®ÆúÂ¶ £ú´·ß´‡©û™ ß‡¢û´È§
        
                        Write   Channel 8   '"'
                        Write   Channel 8   (Trim(Constrct.CNT_Address))
                        Write   Channel 8   '"'
                        Write   Channel 8   sDeli // End of Excel Column K  éõÊ™ ßú¢·´û
                        Write   Channel 8   '"'
                        Write   Channel 8   (Trim(Constrct.CNT_add_no))
                        Write   Channel 8   '"'
                        Write   Channel 8   sDeli // End of Excel Column L  Ä®†ü£Ê™
                        Write   Channel 8   '"'
                        Write   Channel 8   (Trim(Constrct.CNT_Zipcode))
                        Write   Channel 8   '"'
                        Write   Channel 8   sDeli // End of Excel Column M  í.â.
        
                        Move "" to s1
                        Clear Areas
                        Move Constrct.CNT_Area to Areas.Area_id
                        Find Eq Areas By Index.1
                        Clear MIDHMOS
                        Move (Trim(Areas.Area_Descr)) to MIDHMOS.Dhmos
                        Find EQ MIDHMOS By Index.1
                        If (Found)  Move (Trim(MIDHMOS.Dhmos))  to s1
                        Else Begin
                            Set psNotFoundConstrDhmos to ("*** (N) "+Trim(Areas.Area_Descr))
                            Move "ZZZZ"              to s1
                        End
                        Write   Channel 8   '"'
                        Write   Channel 8   s1
                        Write   Channel 8   '"'
                        Write   Channel 8   sDeli // End of Excel Column N  É„£¶™
        
                        Move "GR" to s1
                        Move s1 to sIsGreece
                        Write   Channel 8   '"'
                        Write   Channel 8   (Trim(s1))
                        Write   Channel 8   '"'
                        Write   Channel 8   sDeli // End of Excel Column O  ïÈ®ò
        
                        Move "" to s1
                        Clear Cities
                        Move Constrct.CNT_City to cities.City_id
                        Find Eq Cities By Index.1
                        Clear MINOMOS
                        Move (Trim(Cities.City_Descr)) to MINOMOS.DESCR
                        Find EQ MINOMOS By Index.2
                        If (Found)  Move (Trim(MINOMOS.CODE)) to s1
                        Else Begin
                            Set psNotFoundConstrNomos to ("*** (P) "+Trim(Cities.City_Descr))
                            Move "ZZZZ"              to s1
                        End
                        Write   Channel 8   '"'
                        Write   Channel 8   s1
                        Write   Channel 8   '"'
                        Write   Channel 8   sDeli // End of Excel Column P
                        Write   Channel 8   sDeli // End of Excel Column Q
                        Write   Channel 8   sDeli // End of Excel Column R
                        Write   Channel 8   '"'
                        Write   Channel 8   (Trim(Constrct.CNT_Phone))
                        Write   Channel 8   '"'
                        Write   Channel 8   sDeli // End of Excel Column S
                        Write   Channel 8   '"'
                        Write   Channel 8   (Trim(Constrct.CNT_Mobile))
                        Write   Channel 8   '"'
                        Write   Channel 8   sDeli // End of Excel Column T
                        Write   Channel 8   '"'
                        Write   Channel 8   (Trim(Constrct.CNT_Fax))
                        Write   Channel 8   '"'
                        Write   Channel 8   sDeli // End of Excel Column U
                        Write   Channel 8   '"'
                        Write   Channel 8   (Trim(Constrct.CNT_Email))
                        Write   Channel 8   '"'
                        Write   Channel 8   sDeli // End of Excel Column V
                        Write   Channel 8   sDeli // End of Excel Column W
                        Write   Channel 8   '"'
                        Write   Channel 8   (Trim(Constrct.CNT_AFM))
                        Write   Channel 8   '"'
                        Write   Channel 8   sDeli // End of Excel Column X
                        Write   Channel 8   '"'
                        Write   Channel 8   ("EL"+Trim(Constrct.CNT_AFM))
                        Write   Channel 8   '"'
                        Write   Channel 8   sDeli // End of Excel Column Y
                        Write   Channel 8   sDeli // End of Excel Column Z
                        Write   Channel 8   sDeli // End of Excel Column AA
                        //---
        
                        Write   Channel 8   '"'
                        Write   Channel 8   (Trim(psNotFoundConstrDhmos(Self)))
                        Write   Channel 8   '"'
                        Write   Channel 8   sDeli
        
                        Write   Channel 8   '"'
                        Write   Channel 8   (Trim(psNotFoundConstrNomos(Self)))
                        Write   Channel 8   '"'
                        Write   Channel 8   sDeli
        
                        Write   Channel 8   '"'
                        Write   Channel 8   (Trim(psNotFoundConstrTrPlh(Self)))
                        Write   Channel 8   '"'
                        Write   Channel 8   sDeli
        
                        Write   Channel 8   '"'
                        Write   Channel 8   (Trim(psNotFoundConstrDrast(Self)))
                        Write   Channel 8   '"'
                        //Write   Channel 8   sDeli
        
                        //---
                        Writeln Channel 8
                    End // If not found tmpPagia
                End // If (Found) Begin
            End // If (CN.CN_CNT_ID<>"") Begin
        
        
        
            If (CN.CN_SLS_ID<>"") Begin
                Clear Salesmen
                Move CN.CN_SLS_ID to Salesmen.SLS_ID
                Find Eq Salesmen By Index.4
                If (Found) Begin
                    //---
                    Clear tmpPagia
                    Move "04"           to tmpPagia.Company_Code
                    Move CN.CN_SLS_ID   to tmpPagia.Pagia_Code
                    Find Eq tmpPagia By Index.1
                    If (Not(Found)) Begin
                        Saverecord tmpPagia
                        //---
                        Write   Channel 6   '"'
                        Write   Channel 6   '04'
                        Write   Channel 6   '"'
                        Write   Channel 6   sDeli // End of Excel Column B  é£·õò ä¶öò®†ò©£¶Á (ß.Æ. ßú¢·´û™, Ship - to °¢ß)
                        Write   Channel 6   '"'
                        Write   Channel 6   (Trim(Salesmen.SLS_ID))
                        Write   Channel 6   '"'
                        Write   Channel 6   sDeli // End of Excel Column C  èò¢ò†Ê™ °Á®†¶™ °‡õ†°Ê™ ßú¢·´û SAP
                        Write   Channel 6   sDeli // End of Excel Column D  ë¨£ß¢û®È§ú´ò† ö†ò ´¶¨™ Ship - to
                        Write   Channel 6   sDeli // End of Excel Column E  ëú ßú®Âß´‡©û ß¶¨ ¶ ß¢û®‡´„™ õ†ò≠‚®ú† òßÊ ´¶§ Operational Customer, ©´¶§ Operational ¶®Âùú´ò† ¶ ß¢û®‡´„™
                        Write   Channel 6   sDeli // End of Excel Column F  ëú ßú®Âß´‡©û ß¶¨ ¶ ß¢û®‡´„™ õ†ò≠‚®ú† òßÊ ´¶§ Operational Customer, ©´¶§ Operational ¶®Âùú´ò† ¶ ß¢û®‡´„™
                        Write   Channel 6   '"'
                        Write   Channel 6   (Trim(Left(Salesmen.SLS_Name,35)))
                        Write   Channel 6   '"'
                        Write   Channel 6   sDeli // End of Excel Column G  Ó§¶£ò ìß. è¢û®
                        Move "" to s1
                        If (Trim(Mid(Salesmen.SLS_Name,35,36))<>"") Move ('"'+Trim(Mid(Salesmen.SLS_Name,35,36))+'"') to s1
                        Write   Channel 6   (Trim(s1))
                        Write   Channel 6   sDeli // End of Excel Column H  ë¨£ß¢û®‡£ò´†°Ê ßúõÂ¶ ©ú ßú®Âß´‡©û ß¶¨ £„°¶™ ´¶¨ ßúõÂ¶¨ Name 1 õú§ úÂ§ò† úßò®°‚™
                        Write   Channel 6   sDeli // End of Excel Column I  é®Âùú´ò† ¶ £ûÆò§†°Ê™ & Æ®û©†£¶ß¶†úÂ´ò† ¶ °‡õ†°Ê™ ß¶¨ ‚Æú† °ò´òÆ‡®ûüúÂ ©´¶ ò®ÆúÂ¶ "Customer Master Records_GR Others"
                        Write   Channel 6   sDeli // End of Excel Column J  é®Âùú´ò† ¶ ß‡¢û´„™ & Æ®û©†£¶ß¶†úÂ´ò† ¶ °‡õ†°Ê™ ß¶¨ ‚Æú† °ò´òÆ‡®ûüúÂ ©´¶ ò®ÆúÂ¶ £ú´·ß´‡©û™ ß‡¢û´È§
        
                        Write   Channel 6   '"'
                        Write   Channel 6   (Trim(Salesmen.SLS_Address))
                        Write   Channel 6   '"'
                        Write   Channel 6   sDeli // End of Excel Column K  éõÊ™ ßú¢·´û
                        Write   Channel 6   '"'
                        Write   Channel 6   (Trim(Salesmen.SLS_add_no))
                        Write   Channel 6   '"'
                        Write   Channel 6   sDeli // End of Excel Column L  Ä®†ü£Ê™
                        Write   Channel 6   '"'
                        Write   Channel 6   (Trim(Salesmen.SLS_Zipcode))
                        Write   Channel 6   '"'
                        Write   Channel 6   sDeli // End of Excel Column M  í.â.
        
                        Move "" to s1
                        Clear Areas
                        Move Salesmen.SLS_Area to Areas.Area_id
                        Find Eq Areas By Index.1
                        Clear MIDHMOS
                        Move (Trim(Areas.Area_Descr)) to MIDHMOS.Dhmos
                        Find EQ MIDHMOS By Index.1
                        If (Found)  Move (Trim(MIDHMOS.Dhmos))  to s1
                        Else Begin
                            Set psNotFoundSalesDhmos to ("*** (N) "+Trim(Areas.Area_Descr))
                            Move "ZZZZ"              to s1
                        End
                        Write   Channel 6   '"'
                        Write   Channel 6   s1
                        Write   Channel 6   '"'
                        Write   Channel 6   sDeli // End of Excel Column N  É„£¶™
        
                        Move "GR" to s1
                        Move s1 to sIsGreece
                        Write   Channel 6   '"'
                        Write   Channel 6   (Trim(s1))
                        Write   Channel 6   '"'
                        Write   Channel 6   sDeli // End of Excel Column O  ïÈ®ò
        
                        Move "" to s1
                        Clear Cities
                        Move Salesmen.SLS_City to cities.City_id
                        Find Eq Cities By Index.1
                        Clear MINOMOS
                        Move (Trim(Cities.City_Descr)) to MINOMOS.DESCR
                        Find EQ MINOMOS By Index.2
                        If (Found)  Move (Trim(MINOMOS.CODE)) to s1
                        Else Begin
                            Set psNotFoundSalesNomos to ("*** (P) "+Trim(Cities.City_Descr))
                            Move "ZZZZ"              to s1
                        End
                        Write   Channel 6   '"'
                        Write   Channel 6   s1
                        Write   Channel 6   '"'
                        Write   Channel 6   sDeli // End of Excel Column P
                        Write   Channel 6   sDeli // End of Excel Column Q
                        Write   Channel 6   sDeli // End of Excel Column R
                        Write   Channel 6   '"'
                        Write   Channel 6   (Trim(Salesmen.SLS_Phone))
                        Write   Channel 6   '"'
                        Write   Channel 6   sDeli // End of Excel Column S
                        Write   Channel 6   '"'
                        Write   Channel 6   (Trim(Salesmen.SLS_Mobile))
                        Write   Channel 6   '"'
                        Write   Channel 6   sDeli // End of Excel Column T
                        Write   Channel 6   '"'
                        Write   Channel 6   (Trim(Salesmen.SLS_Fax))
                        Write   Channel 6   '"'
                        Write   Channel 6   sDeli // End of Excel Column U
                        Write   Channel 6   '"'
                        Write   Channel 6   (Trim(Salesmen.SLS_Email))
                        Write   Channel 6   '"'
                        Write   Channel 6   sDeli // End of Excel Column V
                        Write   Channel 6   sDeli // End of Excel Column W
                        Write   Channel 6   '"'
                        Write   Channel 6   (Trim(Salesmen.SLS_AFM))
                        Write   Channel 6   '"'
                        Write   Channel 6   sDeli // End of Excel Column X
                        Write   Channel 6   '"'
                        Write   Channel 6   ("EL"+Trim(Salesmen.SLS_AFM))
                        Write   Channel 6   '"'
                        Write   Channel 6   sDeli // End of Excel Column Y
                        Write   Channel 6   sDeli // End of Excel Column Z
                        Write   Channel 6   sDeli // End of Excel Column AA
                        //---
        
                        Write   Channel 6   '"'
                        Write   Channel 6   (Trim(psNotFoundSalesDhmos(Self)))
                        Write   Channel 6   '"'
                        Write   Channel 6   sDeli
        
                        Write   Channel 6   '"'
                        Write   Channel 6   (Trim(psNotFoundSalesNomos(Self)))
                        Write   Channel 6   '"'
                        Write   Channel 6   sDeli
        
                        Write   Channel 6   '"'
                        Write   Channel 6   (Trim(psNotFoundSalesTrPlh(Self)))
                        Write   Channel 6   '"'
                        Write   Channel 6   sDeli
        
                        Write   Channel 6   '"'
                        Write   Channel 6   (Trim(psNotFoundSalesDrast(Self)))
                        Write   Channel 6   '"'
                        //Write   Channel 6   sDeli
        
                        //---
                        Writeln Channel 6
                    End // If not found tmpPagia
                End // If (Found) Begin
            End // If (CN.CN_SLS_ID<>"") Begin
        
        
        End_Procedure
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        //AB-StoreEnd

    End_Object    // ButtonSub5

    Object ButtonSub6 is a ButtonSub

        //AB-StoreTopStart
                                                                                                                                                                                                        
        //AB-StoreTopEnd

        Set Label to "Zerofile and Rebuild MINOMOS-MIDHMOS-MIDRAST"
        Set Size to 14 201
        Set Location to 339 107
        Set Focus_Mode to Pointer_Only
        Set Form_TypeFace Item 0 to "MS Sans Serif"

        //AB-StoreStart
                                                                                                                                                                                                        
        Set Visible_State to False
        Set Enabled_State to False
        
        Procedure OnClick
            Open MINOMOS Mode DF_EXCLUSIVE
            Open MIDHMOS Mode DF_EXCLUSIVE
            Open MIDRAST Mode DF_EXCLUSIVE
            Zerofile MINOMOS
            Zerofile MIDHMOS
            Zerofile MIDRAST
            Open MINOMOS Mode DF_SHARE
            Open MIDHMOS Mode DF_SHARE
            Open MIDRAST Mode DF_SHARE
        End_Procedure // OnClick
        
        
        //AB-StoreEnd

    End_Object    // ButtonSub6

    Object TextBoxSub1 is a TextBoxSub
        Set Label to "íú¢ú¨´òÂò âÂ§û©û Äß¶"
        Set Auto_Size_State to FALSE
        Set Location to 44 95
        Set Size to 10 81
        Set TypeFace to "MS Sans Serif"
    End_Object    // TextBoxSub1

    Object TextBoxSub4 is a TextBoxSub
        Set Label to "ìßÊ¢¶†ß¶  > òß¶"
        Set Auto_Size_State to FALSE
        Set Location to 44 9
        Set Size to 10 59
        Set TypeFace to "MS Sans Serif"
    End_Object    // TextBoxSub4

    Object TextBoxSub6 is a TextBoxSub
        Set Label to "Î§ò®•û Î®ö¶¨ Äß¶"
        Set Auto_Size_State to FALSE
        Set Location to 113 13
        Set Size to 10 81
        Set TypeFace to "MS Sans Serif"
    End_Object    // TextBoxSub6

    Object TextBoxSub8 is a TextBoxSub
        Set Label to "Î§ò®•û ë°¨®¶õ‚´û©û™ Äß¶"
        Set Auto_Size_State to FALSE
        Set Location to 113 99
        Set Size to 10 94
        Set TypeFace to "MS Sans Serif"
    End_Object    // TextBoxSub8

    Object TextBoxSub10 is a TextBoxSub
        Set Label to "Ó§¶£ò ò®ÆúÂ¶¨"
        Set Auto_Size_State to FALSE
        Set Location to 294 75
        Set Size to 10 56
        Set TypeFace to "MS Sans Serif"
    End_Object    // TextBoxSub10

    Object SaveAsDialog1 is a SaveAsDialog
        Set Location to 292 33

        //AB-StoreStart
        //Show_Dialog is a predefined function method in the SaveAsDialog class
        //get Show_Dialog to an integer variable to call the SaveAsDialog
        //
        //DoCallSaveAsDialog is NOT a predefined method in the SaveAsDialog class
        //DoCallSaveAsDialog it is just used an example
        //you can send DoCallSaveAsDialog from another object, such as a button
        //
        //Procedure DoCallSaveAsDialog
        //    integer iVoid
        //    get Show_Dialog of SaveAsDialog1 to iVoid
        //End_Procedure  // DoCallSaveAsDialog
        //AB-StoreEnd

    End_Object    // SaveAsDialog1

    Object TextBoxSub11 is a TextBoxSub
        Set Label to "Ñß†¢¶ö„ èú¢ò´È§ (°ò† ìßúÁü¨§‡§ è¢û®‡£È§ / Î®ö‡§ / ãûÆò§†°È§ / Ñ®ö¶¢·ô‡§)"
        Set Auto_Size_State to FALSE
        Set Color to clNavy
        Set TextColor to clWhite
        Set FontSize to 14 8
        Set Location to 10 0
        Set Size to 10 313
        Set FontWeight to 600
        Set Justification_Mode to jMode_Center
        Set TypeFace to "MS Sans Serif"
    End_Object    // TextBoxSub11

    Object TextBoxSub12 is a TextBoxSub
        Set Label to "îÂ¢´®ò Ñß†¢¶ö„™ èú¢ò´È§"
        Set Auto_Size_State to FALSE
        Set Color to clLtGray
        Set TextColor to clNavy
        Set FontSize to 14 8
        Set Location to 31 -4
        Set Size to 10 313
        Set FontWeight to 600
        Set Justification_Mode to jMode_Center
        Set TypeFace to "MS Sans Serif"
    End_Object    // TextBoxSub12

    Object TextBoxSub13 is a TextBoxSub
        Set Label to "îÂ¢´®ò Ñß†¢¶ö„™ Î®ö‡§"
        Set Auto_Size_State to FALSE
        Set Color to clLtGray
        Set TextColor to clMaroon
        Set FontSize to 14 8
        Set Location to 97 4
        Set Size to 10 308
        Set FontWeight to 600
        Set Justification_Mode to jMode_Center
        Set TypeFace to "MS Sans Serif"
    End_Object    // TextBoxSub13

    Object TextBoxSub15 is a TextBoxSub
        Set Label to "ÑçÄÇóÇÜ ÉÑÉéãÑåóå"
        Set Auto_Size_State to FALSE
        Set Color to clLtGray
        Set TextColor to clMaroon
        Set FontSize to 14 8
        Set Location to 268 -1
        Set Size to 10 313
        Set FontWeight to 600
        Set Justification_Mode to jMode_Center
        Set TypeFace to "MS Sans Serif"
    End_Object    // TextBoxSub15

    Object TextBoxSub17 is a TextBoxSub
        Set Label to "Ä§ú•·®´û´û Ñß†¢¶ö„ Î®ö‡§ (é¢ò ´ò Î®öò £ú ¨ßÊ¢¶†ß¶ ò§ú•ò®´„´¶¨ èú¢·´û)"
        Set Auto_Size_State to FALSE
        Set Color to clLtGray
        Set TextColor to clMaroon
        Set FontSize to 14 8
        Set Location to 206 3
        Set Size to 10 308
        Set FontWeight to 600
        Set Justification_Mode to jMode_Center
        Set TypeFace to "MS Sans Serif"
    End_Object    // TextBoxSub17

    Object TextBoxSub18 is a TextBoxSub
        Set Label to "ãò®°·®†©£ò Ó¢‡§ ´‡§ Î®ö‡§ £ú ìßÊ¢¶†ß¶ ©´¶ à©¶ùÁö†¶ Î®ö‡§"
        Set Location to 222 14
        Set Size to 18 115
        Set Justification_Mode to jMode_Left
        Set TypeFace to "MS Sans Serif"
    End_Object    // TextBoxSub18

    Object chkNines is a CheckBoxSub
        Set Label to "Äîã - Ñ•òÂ®ú©ú 999999"
        Set Size to 10 93
        Set Location to 60 201
        Set Auto_Size_State to FALSE
        Set Checked_State to TRUE
    End_Object    // chkNines

    Object chkZeroes is a CheckBoxSub
        Set Label to "Äîã - Ñ•òÂ®ú©ú 000000"
        Set Size to 10 98
        Set Location to 59 301
        Set Auto_Size_State to FALSE
        Set Checked_State to TRUE
    End_Object    // chkZeroes

    Object chkStars is a CheckBoxSub
        Set Label to "Äîã - Ñ•òÂ®ú©ú *"
        Set Size to 12 73
        Set Location to 71 201
        Set Auto_Size_State to FALSE
        Set Checked_State to TRUE
    End_Object    // chkStars

    Object chkBlanks is a CheckBoxSub
        Set Label to "Äîã - Ñ•òÂ®ú©ú âú§ò"
        Set Size to 12 90
        Set Location to 71 301
        Set Auto_Size_State to FALSE
        Set Checked_State to TRUE
    End_Object    // chkBlanks

    Object frmCreateDate is a cSyDateForm
        Set Size to 13 66
        Set Location to 80 95
        Set Label_Col_Offset to 2
        Set Label_Justification_Mode to jMode_Right
        Set Form_Mask Item 0 to "dd/MM/yyyy"
        Set Form_TypeFace Item 0 to "MS Sans Serif"
    End_Object    // frmCreateDate

    Object TextBoxSub19 is a TextBoxSub
        Set Label to "é≠ú†¢„  > òß¶"
        Set Auto_Size_State to FALSE
        Set Location to 69 9
        Set Size to 10 59
        Set TypeFace to "MS Sans Serif"
    End_Object    // TextBoxSub19

    Object frmOfeilh is a FormSub
        Set Size to 13 66
        Set Location to 80 9
        Set Label_Col_Offset to 2
        Set Form_TypeFace Item 0 to "MS Sans Serif"
    End_Object    // frmOfeilh

    Object TextBoxSub20 is a TextBoxSub
        Set Label to "Ä§¶†ö£‚§¶™ ãú´· ´û§"
        Set Auto_Size_State to FALSE
        Set Location to 69 94
        Set Size to 10 73
        Set TypeFace to "MS Sans Serif"
    End_Object    // TextBoxSub20


    //AB-StoreStart
                
    Procedure Activate_View Returns Integer
        Integer rVal
        Forward Get MSG_Activate_View to rVal
    
        SEND IGNORE_ERROR TO ERROR_INFO_OBJECT 4358
        Make_Directory "C:\TitanMig"
        SEND TRAP_ERROR TO ERROR_INFO_OBJECT 4358
    
        Open tmpPagia Mode DF_EXCLUSIVE
        Zerofile tmpPagia
        Open tmpPagia Mode DF_SHARE
    
        Open tmplg Mode DF_EXCLUSIVE
        Zerofile tmplg
        Open tmplg Mode DF_SHARE
    
    //    Open MINOMOS Mode DF_EXCLUSIVE
    //    Open MIDHMOS Mode DF_EXCLUSIVE
    //    Open MIDRAST Mode DF_EXCLUSIVE
    //    Zerofile MINOMOS
    //    Zerofile MIDHMOS
    //    Zerofile MIDRAST
    //    Open MINOMOS Mode DF_SHARE
    //    Open MIDHMOS Mode DF_SHARE
    //    Open MIDRAST Mode DF_SHARE
    //    Send Fill_The_Files
        Procedure_Return rVal
    End_Procedure
    
    //Procedure Fill_The_Files
    //    String File_Dhmoi File_Nomoi File_Drasthr vs1 vs2
    
    //    Move "C:\TitanMig\NomoiNP.txt"  to File_Nomoi
    //    Move "C:\TitanMig\DhmoiNP.txt"  to File_Dhmoi
    //    Move "C:\TitanMig\DrasthNP.txt" to File_Drasthr
    
    
    //    Direct_Input Channel 8 File_Dhmoi
    //    Readln Channel 8 vs1
    //    While (Not(Seqeof))
    //        Clear MIDHMOS
    //        Move (Trim(ToOEM(vs1))) to MIDHMOS.Dhmos
    //        Saverecord MIDHMOS
    //        //--
    //        Readln Channel 8 vs1
    //    Loop
    //    Close_Output Channel 8
    
    
    //    Direct_Input Channel 8 File_Nomoi
    //    Readln Channel 8 vs1 vs2
    //    While (Not(Seqeof))
    //        Move (Replaces("·",vs2 ,"ò" ))  to vs2
    //        Move (Replaces("Í",vs2 ,"Ä" ))  to vs2
    //        Move (Replaces("‚",vs2 ,"ú" ))  to vs2
    //        Move (Replaces("Î",vs2 ,"Ñ" ))  to vs2
    //        Move (Replaces("Â",vs2 ,"†" ))  to vs2
    //        Move (Replaces("Ì",vs2 ,"à" ))  to vs2
    //        Move (Replaces("„",vs2 ,"û" ))  to vs2
    //        Move (Replaces("Ï",vs2 ,"Ü" ))  to vs2
    //        Move (Replaces("Ê",vs2 ,"¶" ))  to vs2
    //        Move (Replaces("Ó",vs2 ,"é" ))  to vs2
    //        Move (Replaces("È",vs2 ,"‡" ))  to vs2
    //        Move (Replaces("",vs2 ,"ó" ))  to vs2
    //        Move (Replaces("Á",vs2 ,"¨" ))  to vs2
    //        Move (Replaces("Ô",vs2 ,"ì" ))  to vs2
    //        //--
    //        Move (Uppercase(vs2))           to vs2
    //        //--
    //        Clear MINOMOS
    //        Move (Trim(vs1)) to MINOMOS.Code
    //        Move (Trim(vs2)) to MINOMOS.Descr
    //        Saverecord  MINOMOS
    //        //--
    //        Readln Channel 8 vs1 vs2
    //    Loop
    //    Close_Output Channel 8
    
    
    //    Direct_Input Channel 8 File_Drasthr
    //    Readln Channel 8 vs1 vs2
    //    While (Not(Seqeof))
    //        Move (Replaces("·",vs2 ,"ò" ))  to vs2
    //        Move (Replaces("Í",vs2 ,"Ä" ))  to vs2
    //        Move (Replaces("‚",vs2 ,"ú" ))  to vs2
    //        Move (Replaces("Î",vs2 ,"Ñ" ))  to vs2
    //        Move (Replaces("Â",vs2 ,"†" ))  to vs2
    //        Move (Replaces("Ì",vs2 ,"à" ))  to vs2
    //        Move (Replaces("„",vs2 ,"û" ))  to vs2
    //        Move (Replaces("Ï",vs2 ,"Ü" ))  to vs2
    //        Move (Replaces("Ê",vs2 ,"¶" ))  to vs2
    //        Move (Replaces("Ó",vs2 ,"é" ))  to vs2
    //        Move (Replaces("È",vs2 ,"‡" ))  to vs2
    //        Move (Replaces("",vs2 ,"ó" ))  to vs2
    //        Move (Replaces("Á",vs2 ,"¨" ))  to vs2
    //        Move (Replaces("Ô",vs2 ,"ì" ))  to vs2
    //        //--
    //        Move (Uppercase(vs2))           to vs2
    //        //--
    //        Clear MIDRAST
    //        Move (Trim(ToANSI(vs1))) to MIDRAST.Code
    //        Move (Trim(ToANSI(vs2))) to MIDRAST.Descr
    //        Saverecord  MIDRAST
    //        //--
    //        Readln Channel 8 vs1 vs2
    //    Loop
    //    Close_Output Channel 8
    //End_Procedure
    
    
    Object Rpt1_Report is a CrystalReportSubSQL
        Property Integer ReportReady Public False
    
        Procedure RunRpt1Report
            Send Cursor_Wait To (Cursor_Control(Self))
            Set Output_Destination  To PRINT_TO_WINDOW
            Send Run_report
            Send Cursor_Ready To (Cursor_Control(Self))
        End_procedure // RunRpt1Report
    
    
        Set Report_Name to "MiMarked.rpt"
        Set Report_View_id To (Parent(Self))
    
        set WindowStyle to (WS_VISIBLE ior WS_THICKFRAME ior ;
                            WS_SYSMENU ior WS_MAXIMIZEBOX ior ;
                            WS_MINIMIZEBOX ior WS_MAXIMIZE)
    
         Procedure OnStartPrinting
            String  FileName
            Integer FileType Destination
    
            If Destination EQ WQL_PRINT_TO_WINDOW   Set ReportReady To False
            Else                                    Set ReportReady To True
    
         End_procedure // OnStartPrinting
    
         Procedure OnStopPrinting
              Set ZoomPreviewWindow to PE_ZOOM_FULL_SIZE
         End_procedure // OnStopPrinting
    
    End_Object // Rpt1_Report
    
    
    //Object RepMakeYpolErga00 is a CrystalReportSubSQL
    
    //    Set Report_Name                 to "IsozErg.rpt"
    //    Set Report_View_id              to (Parent(Self))
    //    Set Output_Destination          to WQL_PRINT_TO_FILE
    //    Set ExportFileName              to "c:\TitanMig\IsozErg.txt"
    //    Set UseReportNumberFormat_State to True
    //    Set ExportFormatType            to WQL_CommaSeparatedType
    //    Set FieldDelimiter              to ","
    //    Set StringDelimiter             to '"'
    //    Set UseReportDateFormat_State   To True
    
    //    Procedure OnStartPrinting
    //        date datef datet  apo eos
    //        local string  lscatypes Startantlian Endantlian sstr flysh1 flysh2
    //        Local integer Starthmen Endhmen FileType Destination SortOrder sepil
    //        Local String  Selection module FileName StartantliaNumber EndantliaNumber
    //        Local Integer NumSortFields CurSortField SortDirection wdate iok iwhat
    //        local string sbranch slabel startapon endapon
    //        Integer iint icheck icount irec
    //        string  stext scode sname
    
    //        Move syscurxr.year_xrhshfrom    to starthmen
    //        Move syscurxr.year_xrhshto      to Endhmen
    
    
    
    //        Set formula "formula1" to "01"
    
    //        Append Selection (If(Selection <> "", " and ", "")) "{cmoves.company_code} = " '"' (Trim(syscurxr.company_code)) '"'
    //        Append Selection (If(Selection <> "", " and ", "")) "{cmoves.year_year} = " '' (syscurxr.year_year) ''
    //        Append Selection (If(Selection <> "", " and ", "")) "{cmoves.cmoves_hmnia} >= " '' (winql_date(starthmen))''
    //        Append Selection (If(Selection <> "", " and ", "")) "{cmoves.cmoves_hmnia} <= " '' (winql_date(Endhmen))''
    //        Append Selection (If(Selection <> "", " and ", "")) "{cmoves.cmoves_axia} <>  " '' (0) ''
    
    //        Set SelectionFormula To Selection
    
    //    End_procedure // OnStartPrinting
    //End_object // CustWQLReport
    
    
    
    
    Object RepMakeYpolErga is a CrystalReportSubSQL
    
        Procedure OnStartPrinting
            Local String  Startclients Endclients startsls startpayresp startjob
            Local Integer FileType Destination SortOrder NumSortFields CurSortField
            Local Integer SortDirection stat IYPOL starthmen Endhmen iyes
            string smodule sepil sbranch Selection FileName slabel sjob  sdoy
            date ddate
            Integer iint icheck icount irec
            string  stext scode sname
    
            Move syscurxr.year_xrhshfrom    to starthmen
            Move syscurxr.year_xrhshto      to Endhmen
    
            Move "01"               to sModule
            Set formula "formula1"  to "01"
    
            Move "" To Selection
    
            Append Selection (If(Selection <> "", " and ", "")) "{cmoves.company_code} = " '"' (Trim(syscurxr.company_code)) '"'
            Append Selection (If(Selection <> "", " and ", "")) "{cmoves.year_year} = " '' (syscurxr.year_year) ''
            Append Selection (If(Selection <> "", " and ", "")) "{cmoves.cmoves_hmnia} >= " '' (winql_date(starthmen))''
            Append Selection (If(Selection <> "", " and ", "")) "{cmoves.cmoves_hmnia} <= " '' (winql_date(Endhmen))''
            Append Selection (If(Selection <> "", " and ", "")) "{cmoves.cmoves_axia} <>  " '' (0) ''
    
            Move 1                  to sepil
            set formula "fmodule"   to (winql_string(smodule))
            set formula "fepil"     to sepil
            set formula "fapo"     to (winql_date(starthmen ))
            set formula "feos"     to (winql_date(endhmen   ))
    
            Set SelectionFormula To Selection
    
        End_procedure // OnStartPrinting
    
        Procedure RunErgaReport
            Set Report_Name                 to "IsozErg.rpt"
            Set Report_View_id              to (Parent(Self))
            Set Output_Destination          to WQL_PRINT_TO_FILE
            Set ExportFileName              to "c:\TitanMig\IsozErg.txt"
            Set UseReportNumberFormat_State to True
            Set ExportFormatType            to WQL_CommaSeparatedType
            Set FieldDelimiter              to ","
            Set StringDelimiter             to '"'
            Set UseReportDateFormat_State   To True
    
            Send Run_report
    
        End_procedure // RunCustReport
    End_object // CustWQLReport
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    //AB-StoreEnd

End_Object    // Migrate1b


//AB-StoreStart
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
//AB-StoreEnd

//AB/ End_Object    // prj
