Compiling Program: C:\Vdf6\Develop\Empor\AppSrc\#fem.src
Memory Available: 2147483647
1>Use AllEntSc
Using pre-compiled package ALLENTSC
INCLUDING FILE: ALLENTSC.PKI
30262>
30262>Register_Object Client_Area
30262>
30262>//AB-StoreTopStart
30262>Use Workspc.pkg
30262>
30262>//  Set date attributes as needed
30262>Set_Date_Attribute sysdate4_State to (TRUE)
30263>Set_Date_Attribute Date4_State    to (TRUE)
30264>Set_Date_Attribute epoch_value    to 30
30265>
30265>Object ProgramWorkspace is a WorkspaceSub
30267>    Set WorkspaceName to CURRENT$WORKSPACE
30268>    Set kEnter_Next_State to True
30269>//    Set ModuleName    to 'ProgramName' // Special module name.
30269>//    Set HelpName      to 'HelpName.hlp'// Please provide the name of your Windows help file.
30269>End_Object
30270>
30270>Use Help_Ids.inc // Developer should provide this file of help context links.
INCLUDING FILE: HELP_IDS.INC
30270>>>// Help_ids.inc
30270>>>//
30270>>>// Context ids for the order entry system. This uses
30270>>>// help file ordentry.hlp.
30270>>>//
30270>>>// This is a sample version. YOU must supply
30270>>>// the ID values
30270>>>
30270>>>//  Generic Context Ids
30270>>>//
30270>>>
30270>>>// It is expected that file-names ids will be the same as their
30270>>>// filenumber.
30270>>>
30270>>>
30270>>>//  View and selection-list specific context ids
30270>>>//
30270>>>//..........add view, object, selection-list ids here....
30270>Use Std_Help.pkg
INCLUDING FILE: STD_HELP.PKG
30270>>>// STD_HELP.PKG
30270>>>//
30270>>>// Global Help Object
30270>>>//
30270>>>//  Creates all Help Support required to access WINDOWs help system
30270>>>//  with DataFlex. Creates a global object named Help_Object.
30270>>>//
30270>>>//  9/19/97 JJT - Modified to define stadnard help Ids if they are undefined
30270>>>
30270>>>use DFHlpSys // Context Sensitive Help Support
30270>>>
30270>>>
30270>>>// This file needs to be provided by the developer. It will contain
30270>>>// symbolic replacements for the ID integer values used to access the
30270>>>// the windows help file's topics.
30270>>>//
30270>>>use Help_ids.inc
30270>>>
30270>>>// If the following are not defined in help_ids.inc,
30270>>>//  create default 0 values for them
30270>>>Define GeneralHelpId    for    0
30270>>>Define KeysHelpId       for    0
30270>>>Define FileHelpId       for    0
30270>>>Define ErrorHelpId      for    0  // probably not used in VDF
30270>>>Define IndexHelpId      for    0  // probably not used in VDF
30270>>>
30270>>>object Help_Object is a HelpSystem // global help object
30272>>>
30272>>>   Set Help_Id_General to GeneralHelpId    // these should all be defined
30273>>>   Set Help_Id_Index   to IndexHelpId      // in help_ids.inc.
30274>>>   Set Help_Id_Keys    to KeysHelpId       //
30275>>>   Set Help_Id_Files   to FileHelpId       //
30276>>>   Set Help_Id_Errors  to ErrorHelpId      //
30277>>>
30277>>>end_object
30278>Use WinQlSQL.Sub
INCLUDING FILE: WINQLSQL.SUB
30278>>>Use CrystalReport.pkg
30278>>>
30278>>>
30278>>>
30278>>>Type PEWindowOptions
30278>>>  Field PEWindowOptions.StructSize As Word
30278>>>  Field PEWindowOptions.hasGroupTree As Word
30278>>>  Field PEWindowOptions.canDrillDown As Word
30278>>>  Field PEWindowOptions.hasNavigationControls As Word
30278>>>  Field PEWindowOptions.hasCancelButton As Word
30278>>>  Field PEWindowOptions.hasPrintButton As Word
30278>>>  Field PEWindowOptions.hasExportButton As Word
30278>>>  Field PEWindowOptions.hasZoomControl As Word
30278>>>  Field PEWindowOptions.hasCloseButton As Word
30278>>>  Field PEWindowOptions.hasProgressControls As Word
30278>>>  Field PEWindowOptions.hasSearchButton As Word
30278>>>  Field PEWindowOptions.hasPrintSetupButton As Word
30278>>>  Field PEWindowOptions.hasRefreshButton As Word
30278>>>End_Type // PEWindowOptions
30278>>>
30278>>>External_Function32 PESetWindowOptions "PESetWindowOptions" CRPE32.DLL ;  Integer printJob pointer Options Returns Integer
30279>>>
30279>>>Class CrystalReportSubSQL Is A CrystalReport
30280>>>
30280>>>    Procedure Construct_Object
30281>>>        Forward send Construct_Object
30283>>>        // Everything on except hasGroupTree by default
30283>>>        property integer hasGroupTree 0
30284>>>        property integer canDrillDown 1
30285>>>        property integer hasNavigationControls 1
30286>>>        property integer hasCancelButton 1
30287>>>        property integer hasPrintButton 1
30288>>>        property integer hasExportButton 1
30289>>>        property integer hasZoomControl 1
30290>>>        property integer hasCloseButton 1
30291>>>        property integer hasProgressControls 1
30292>>>        property integer hasSearchButton 1
30293>>>        property integer hasPrintSetupButton 1
30294>>>        property integer hasRefreshButton 1
30295>>>
30295>>>        Set WindowStyle To (WS_MAXIMIZE iOr WS_OVERLAPPEDWINDOW)
30296>>>    End_Procedure // Construct_Object
30297>>>
30297>>>    Procedure OutputToWindow String sTitle Integer iLeft Integer iTop Integer iWidth Integer iHeight Integer iStyle Handle hParent
30298>>>        Integer iPrintJob iResult
30299>>>        String sPEWindowOptions
30299>>>        Pointer pPeWindowOptions
30299>>>
30299>>>        Get PrintJob To iPrintJob
30300>>>        FillType PEWindowOptions with 0     to sPEWindowOptions
30301>>>        put PEWindowOptions_Size            to sPEWindowOptions at PEWindowOptions.StructSize
30302>>>        put (hasGroupTree(self))            to sPEWindowOptions at PEWindowOptions.hasGroupTree
30303>>>        put (canDrillDown(self))            to sPEWindowOptions at PEWindowOptions.canDrillDown
30304>>>        put (hasNavigationControls(self))   to sPEWindowOptions at PEWindowOptions.hasNavigationControls
30305>>>        put (hasCancelButton(self))         to sPEWindowOptions at PEWindowOptions.hasCancelButton
30306>>>        put (hasPrintButton(self))          to sPEWindowOptions at PEWindowOptions.hasPrintButton
30307>>>        put (hasExportButton(self))         to sPEWindowOptions at PEWindowOptions.hasExportButton
30308>>>        put (hasZoomControl(self))          to sPEWindowOptions at PEWindowOptions.hasZoomControl
30309>>>        put (hasCloseButton(self))          to sPEWindowOptions at PEWindowOptions.hasCloseButton
30310>>>        put (hasProgressControls(self))     to sPEWindowOptions at PEWindowOptions.hasProgressControls
30311>>>        put (hasSearchButton(self))         to sPEWindowOptions at PEWindowOptions.hasSearchButton
30312>>>        put (hasPrintSetupButton(self))     to sPEWindowOptions at PEWindowOptions.hasPrintSetupButton
30313>>>        put (hasRefreshButton(self))        to sPEWindowOptions at PEWindowOptions.hasrefreshButton
30314>>>        GetAddress of sPEWindowOptions      to pPEWindowOptions
30315>>>        Move (PESetWindowOptions(iPrintJob, pPEWindowOptions)) to iResult
30316>>>        Forward Send OutputToWindow sTitle iLeft iTop iWidth iHeight iStyle hParent
30318>>>    End_Procedure // OutputToWindow
30319>>>
30319>>>    Procedure Set TmpFileDir String aDir
30320>>>        String lsCurrWspc lsDir
30321>>>
30321>>>//        If (ghoWorkSpace <> 0) Begin
30321>>>//            Get WorkSpaceName of ghoWorkSpace to lsCurrWspc
30321>>>//            Insert "WorkSpaces\" in lsCurrWspc at 1
30321>>>//            Get_Profile_String lsCurrWspc aDir to lsDir
30321>>>//            Set Report_Data_Path to lsDir
30321>>>//        End
30321>>>    End_Procedure
30322>>>
30322>>>    Procedure DoWinQLReport
30323>>>        // This can be used when reports must be able to run in different data directories
30323>>>        Set TmpFileDir to "TmpFileDir"
30324>>>        Forward Send DoWinQLReport
30326>>>    End_Procedure
30327>>>
30327>>>    // This hook procedure is called after the print job has been opened.
30327>>>    Procedure OnInitializeReport
30328>>>        Integer iTables iMax iCount iType
30329>>>        String  sLocation sLocation2 sPath DirSep
30329>>>        String  sNewPath sNewLocation sDataPath sMyLocation
30329>>>        Forward Send OnInitializeReport
30331>>>            Move (Sysconf(SYSCONF_DIR_SEPARATOR)) To DirSep
30332>>>            Get NTables To iMax
30333>>>            Decrement iMax
30334>>>            Get Report_Data_Path                                    To sPath
30335>>>            If Not (Right(sPath,1)) Eq DirSep Move (sPath-DirSep)   To sPath
30338>>>            For iCount From 0 To iMax
30344>>>>
30344>>>                //Get NthTableLocation iCount         To sLocation
30344>>>                //Get Report_Base_File_Name sLocation To sLocation2
30344>>>                //Set NthTableLocation iCount         To (sPath-sLocation2)
30344>>>                //Get NthTableDBType           iCount to iType
30344>>>                //Showln '--------------------------------------------------------'
30344>>>                //Showln iCount
30344>>>                //Showln sLocation
30344>>>                //Showln sPath
30344>>>                //Showln sLocation2
30344>>>                //Showln iType
30344>>>
30344>>>                //If (Trim(LowerCase(sLocation2))='btnemp.dat') Begin
30344>>>                  //Set Report_Data_Path to ''
30344>>>                  //Get NthTableDBType              iCount to iType
30344>>>                  Set nthTableLogOnServerName     iCount to 'SMSNT' 0
30345>>>                  Set nthTableLogOnDataBaseName   iCount to 'SMS'   0
30346>>>                    //Set nthTableLogOnUserID         iCount to 'dbo'     0
30346>>>                    //Set nthTableLogOnPassword       iCount to '123'     0
30346>>>                  //Set NthTableLocation            iCount To "BTNEMP"
30346>>>                    //Set NthTableLocation iCount To (sPath-sLocation2)
30346>>>                  //Get NthTableLocation iCount                 To sMyLocation
30346>>>                  //Move (Replace(sLocation,sMyLocation,''))    To sMyLocation
30346>>>                  //Showln sMyLocation
30346>>>                  //Set NthTableLocation            iCount To sMyLocation
30346>>>                //End
30346>>>
30346>>>            Loop // For iCount From 0 To iMax
30347>>>>
30347>>>    End_Procedure // OnInitializeReport
30348>>>
30348>>>    // This hook procedure is called just before a print job is closed.
30348>>>    Procedure OnDeInitializeReport
30349>>>        Forward Send OnDEInitializeReport
30351>>>    End_Procedure // OnDeInitializeReport
30352>>>
30352>>>    // This hook procedure is called just before a the print job is started.
30352>>>    Procedure OnStartPrinting
30353>>>        Forward Send OnStartPrinting
30355>>>    End_Procedure // OnStartPrinting
30356>>>
30356>>>    // This hook procedure is called just after a print job has finished.
30356>>>    Procedure OnStopPrinting
30357>>>        Forward Send OnStopPrinting
30359>>>    End_Procedure // OnStopPrinting
30360>>>
30360>>>
30360>>>End_Class // CrystalReportSubSQL
30361>>>
30361>Integer giWait_Obj
30361>
30361>// General Functions-Procedures and Variables
30361>Use Globals.Inc
INCLUDING FILE: GLOBALS.INC
30361>>>
30361>>>        String  gs_Selected_Company_Code
30361>>>        String  gs_Selected_Branch_Code
30361>>>        Integer gi_Selected_Year
30361>>>        String gs_Selected_Year_Recr
30361>>>        String  gs_Module_Code
30361>>>
30361>>>
30361>>>//Open Currency
30361>>>//Function CurrDigits Global String asCurr Returns Integer
30361>>>//    Integer liDecX
30361>>>//    Clear Currency
30361>>>//    move asCurr to Currency.Currency_C_Code
30361>>>//    Find Eq Currency By Index.1
30361>>>//    move Currency.Currency_Dec to liDecX
30361>>>//    Function_Return liDecX
30361>>>//End_Function // CurrDigits
30361>>>
30361>>>Open Nomisma
INCLUDING FILE: NOMISMA.FD
30363>>>Open SysCurXr
INCLUDING FILE: SYSCURXR.FD
30365>>>
30365>>>Function fiDekadika_Nomismatos Global String asNomisma Returns Integer
30366>>>    Move (Trim(asNomisma)) to asNomisma
30367>>>    Clear Nomisma
30368>>>    If ( asNomisma<>'' ) Move asNomisma         to Nomisma.Nomisma_Code
30371>>>    Else                 Move SysCurXr.C_Code0  to Nomisma.Nomisma_Code
30373>>>    Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
30374>>>>
30374>>>    Function_Return Nomisma.Dekadika
30375>>>End_Function //
30376>>>
30376>>>Function fsgCode_W_Zeroes Global Integer aiCode Integer aiPlaces Returns String
30377>>>    String rVal
30378>>>    Integer iLength iInt
30378>>>    Move aiCode to rVal
30379>>>    Move (trim(rVal)) to rVal
30380>>>    For iInt From 1 to (aiPlaces-(Length(rVal)))
30386>>>>
30386>>>        Move (Insert('0',rVal,1)) to rVal
30387>>>    Loop
30388>>>>
30388>>>    Function_Return rVal
30389>>>End_Function
30390>>>
30390>>>Function fsgCode_n_Zeroes Global number aiCode Integer aiPlaces Returns String
30391>>>    String rVal
30392>>>    Integer iLength iInt ipos
30392>>>    Move aiCode to rVal
30393>>>    Move (trim(rVal)) to rVal
30394>>>    MOVE (aiPlaces-(Length(rVal))) to ipos
30395>>>    For iInt From 1 to ipos
30401>>>>
30401>>>        Move (Insert('0',rVal,1)) to rVal
30402>>>    Loop
30403>>>>
30403>>>    Function_Return rVal
30404>>>End_Function
30405>>>
30405>>>
30405>>>Open Year
INCLUDING FILE: YEAR.FD
30407>>>Procedure EnumDDsForRebuildConstrain for DataDictionary integer aiMsg integer ahId
30408>>>    Send aiMsg to Self
30409>>>End_Procedure
30410>>>
30410>>>Procedure DoRefindYear for baseclass Integer aiPanel Integer aiYearDD
30411>>>    Integer liChanged
30412>>>
30412>>>    If ((aiYearDD = 0) or (Main_File(aiYearDD)<>Year.File_Number)) ;        Procedure_Return (Message_Box("Invalid Year_DD","Developer's Warning",MB_OK,MB_ICONWARNING))
30415>>>    If (Not(Current_Record(aiYearDD))) Begin
30417>>>        Get Should_Save of aiPanel to liChanged
30418>>>        Send Clear to aiYearDD
30419>>>        Move gs_Selected_Company_Code to Year.Company_Code
30420>>>        Move gs_Selected_Branch_Code  to Year.Branch_Code
30421>>>        Move gi_Selected_Year         to Year.Year_Year
30422>>>        Send Find to aiYearDD Eq 1 //Year.Index.1 - company_code+ranch_code+year_year
30423>>>        If (Not(liChanged)) Set Changed_State of aiPanel to False
30426>>>    End
30426>>>>
30426>>>End_Procedure
30427>>>
30427>>>Procedure RebuildConstrainIfYearChanged for baseclass Integer aiPanel String asCurrentYearRecr Integer aiYearDDId
30428>>>    Integer liSrvr
30429>>>    String  lsCurrentYearRecr
30429>>>
30429>>>    If (asCurrentYearRecr <> gs_Selected_Year_Recr) Begin
30431>>>        Broadcast Send EnumDDsForRebuildConstrain to aiPanel msg_Rebuild_Constraints Self
30433>>>    End
30433>>>>
30433>>>    Send DoRefindYear aiPanel aiYearDDId //(Year_DD(Self))
30434>>>    Get Server of aiPanel to liSrvr
30435>>>    // Respects Default values
30435>>>    If (liSrvr) If (Not(Current_Record(liSrvr))) Send Request_Clear to aiPanel
30440>>>End_Procedure
30441>>>
30441>>>//                                       ’¦ View            Property «¦¬ View             ’¦ Year DDO «¦¬ View
30441>>>//                                                          Holds the current year rec0
30441>>>// ‰¢ã©ž : Send RbldConstrIfYearChanged (Gplan_Test(Self))  (psCurrentYearRecr(Self))     (Year_DD(Self))
30441>>>
30441>>>
30441>>>Function fiRefindYear Global Returns Integer
30442>>>    Clear Year
30443>>>    Move gs_Selected_Company_Code to Year.Company_Code
30444>>>    Move gs_Selected_Branch_Code  to Year.Branch_Code
30445>>>    Move gi_Selected_Year         to Year.Year_Year
30446>>>    Find eq Year by Index.1 //company_code+ranch_code+year_year
30447>>>>
30447>>>    Function_Return (Found = 0)
30448>>>End_Function //fiRefindYear
30449>>>
30449>>>Procedure DoRunApplication for Baseclass String sAppName
30450>>>    string sRuntime  lsStr
30451>>>
30451>>>    Append lsStr 'C:\Dns.bat ' sAppName
30453>>>    RunProgram Wait  lsStr
30454>>>
30454>>>//    get_profile_string "defaults" "VDFBinDir" to sRuntime
30454>>>//    append sRuntime "\dfrun " sAppName
30454>>>    Append sRuntime 'C:\Program Files\Accessories\WORDPAD.EXE ' sAppName
30456>>>    runprogram background sRuntime
30457>>>End_procedure // DoRunApplication
30458>>>
30458>>>// Run the Editor
30458>>>Procedure DoRunEditor for Baseclass String asFile
30459>>>    string sRunPath lsWspcName
30460>>>    Move (WorkspaceName(ProgramWorkspace(Self))) to lsWspcName
30461>>>    get_profile_string ("workspaces\"+lsWspcName) "programpath" to sRunPath
30464>>>    //append sRunPath "\Editor "  asFile //// js 15/03/2002 " " lsWspcName
30464>>>    Move (Replace('.',asFile,'')) to asFile
30465>>>    append sRunPath asFile //// js 15/03/2002 " " lsWspcName
30466>>>    send DoRunApplication sRunPath
30467>>>End_Procedure // DoRunEditor
30468>>>
30468>>>//--------------------------------------
30468>>>
30468>>>//start of global functions and procedures
30468>>>
30468>>>
30468>>>//®¨ž© £¦§¦ œå«˜  ˜§æ: ˜) gmoves.dd    :private.update_gmhnes_ghmnies
30468>>>Function gsfFind_Previous Global String lsCode;                                 String lsDelimiter;                                 Returns String
30469>>>         String  lsTemp_Code1 lsTemp_Code2
30470>>>         Integer liCounter
30470>>>
30470>>>         //1.˜­˜å¨œ©ž ¡œ¤é¤
30470>>>         Move (Trim(lsCode)) to lsCode                                  //§® 30.12.345
30471>>>
30471>>>         //2.˜¤« ©«¨¦­ã
30471>>>         For liCounter From 1 to (Length(lsCode))
30477>>>>
30477>>>             Move (Insert(;                           (Mid(lsCode,1,liCounter)),;                           lsTemp_Code1,;                           1;                         )) to lsTemp_Code1                             //§® 543.21.03
30478>>>         Loop
30479>>>>
30479>>>
30479>>>         //3.˜­˜å¨œ©ž ¡œ¤é¤ (›â¤ ®¨œ áœ«˜ , safety only)
30479>>>         Move (Trim(lsTemp_Code1)) to lsTemp_Code1
30480>>>
30480>>>         //4.§˜å¨¤à £æ¤¦ «¦ ›œ¥ æ £â¨¦ª «¦¬ ˜¤«å©«¨¦­¦¬, £œ«á «¦ §¨é«¦ delimiter
30480>>>         Move (Right(;                      lsTemp_Code1,;                      ((Length(lsTemp_Code1))-((Pos(lsDelimiter,lsTemp_Code1))));                    )) to lsTemp_Code1                                  // §® 21.03
30481>>>
30481>>>         //5.¥˜¤á ˜¤« ©«¨¦­ã «¦¬ ˜¤«å©«¨¦­¦¬
30481>>>         For liCounter from 1 to (Length(lsTemp_Code1))
30487>>>>
30487>>>             Move (Insert(;                           (Mid(lsTemp_Code1,1,liCounter)),;                           lsTemp_Code2,;                           1;                         )) to lsTemp_Code2                             //§® 30.12
30488>>>         Loop
30489>>>>
30489>>>
30489>>>         Function_Return (Trim(lsTemp_Code2))
30490>>>End_Function //gsffind_previous
30491>>>
30491>>>
30491>>>Function gifSystem_Check Returns Integer
30492>>>         Integer liF_Gtypkins liF_Garicls liF_Gmoves liF_Gplans liF_Gmhnes liF_Ghmnies
30493>>>         Integer liS_Gtypkins liS_Garicls liS_Gmoves liS_Gplans liS_Gmhnes liS_Ghmnies
30493>>>//       Clear Company
30493>>>//       Find Gt Company.Recnum
30493>>>//       While (Found = 1)
30493>>>//             Add Company.Company_NumGtypkin to liS_Gtypkins § Ÿ˜¤é© ©«¦ sysfile ¤˜ «˜ ¡˜¨˜«áà ˜¬«á
30493>>>//             Add Company.Company_NumGarticl to liS_Garticls
30493>>>//             Add Company.Company_NumGmoves  to liS_Gmoves
30493>>>//             //d Company.Company_NumGtypkin to liS_Gtypkins
30493>>>//             Add Company.Company_NumGplan   to liS_GPlans
30493>>>//             Add Company.Company_NumGmhnes  to liS_Gmhnes
30493>>>//             Add Company.Company_NumGhmnies to liS_Ghmnies
30493>>>//             Find Gt Company.Recnum
30493>>>//       Loop
30493>>>//
30493>>>//       Get_Attribute {attribute} [of {file-handle} ;
30493>>>//                        [{field-num} | {index-num} [{segment-num}]]] ;
30493>>>//                        To {variable}
30493>>>//
30493>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30493>>>//       Get_Attribute DF_FILE_RECORDS_USED of Garticl.File_Number to liF_Garticls
30493>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmoves.File_Number  to liF_Gmoves
30493>>>//       //t_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30493>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gplan.File_Number   to liF_Gplans
30493>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmhnes.File_Number  to liF_Gmhnes
30493>>>//       Get_Attribute DF_FILE_RECORDS_USED of Ghmnies.File_Number to liF_Ghmnies
30493>>>//
30493>>>
30493>>>//       //â¢œš®¦ª DF_FILE_MAX_RECORDS+ £œ records used
30493>>>
30493>>>//       //â¢œš®¦ª last rec0 = sysrec rec0
30493>>>
30493>>>    Function_Return 0
30494>>>End_Function //gifSystem_Check
30495>>>
30495>>>/////////////////////////////////////////////////////////////////
30495>>>//‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª, £œ ž ®à¨åª ›œ¡˜› ¡á  JS
30495>>>Function Sfi_All_Numbers Global Number anValue Integer aiLengthAkeraios Integer aiLengthDekadika Returns String
30496>>>
30496>>>    String  lsRetval lsValue lsAkeraios lsDekadika
30497>>>    Integer liInt liInteger iTimes iStart
30497>>>    Number  lnDecimals
30497>>>
30497>>>    Move (Integer(anValue))                                         to liInteger
30498>>>    Move (Round(AnValue-(Integer(anValue))*(10^aiLengthDekadika)))  to lnDecimals
30499>>>
30499>>>    Move liInteger              to lsAkeraios
30500>>>    Move lnDecimals             to lsDekadika
30501>>>    Move (Trim(lsAkeraios))     to lsAkeraios
30502>>>    Move (Trim(lsDekadika))     to lsDekadika
30503>>>
30503>>>    Move (Length(lsAkeraios)) to iStart
30504>>>    For iTimes From iStart to (aiLengthAkeraios-1)
30510>>>>
30510>>>        Insert "0" in lsAkeraios at 1
30512>>>    Loop
30513>>>>
30513>>>    Move (Trim(lsAkeraios)) to lsAkeraios
30514>>>
30514>>>    Move (Length(lsDekadika)) to iStart
30515>>>    For iTimes From iStart to (aiLengthDekadika-1)
30521>>>>
30521>>>        Move (Append(lsDekadika,"0")) to lsDekadika
30522>>>    Loop
30523>>>>
30523>>>    Move (Trim(lsDekadika)) to lsDekadika
30524>>>
30524>>>    If (aiLengthDekadika=0) Move '' to lsDekadika
30527>>>    Move '' to lsRetVal
30528>>>    Move (Pad((lsAkeraios-lsDekadika),(aiLengthAkeraios+aiLengthDekadika))) to lsRetval
30529>>>    Function_Return lsRetval
30530>>>End_Function //sfi_All_Numbers  ‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª
30531>>>              //                 £œ ž ®à¨åª ›œ¡˜› ¡á (JS)
30531>>>
30531>>>Open Codemast
30533>>>
30533>>>
30533>>>Function gsfCode_Mast Global String lsType String lsValue Returns String
30534>>>         Clear Codemast
30535>>>         Move lsType  to Codemast.Type
30536>>>         Move lsValue to Codemast.Code
30537>>>         Find Eq Codemast by Index.1 //type+code
30538>>>>
30538>>>         Function_Return Codemast.Description
30539>>>End_Function //code_mast
30540>>>
30540>>>
30540>>>Open Branch
INCLUDING FILE: BRANCH.FD
30542>>>Function fsgCode_With_Zeroes Global Integer aiCode    ;                                    Integer aiPlaces  ;                                    String asCompany  ;                                    String asBranch   ;                               Returns String
30543>>>    String rVal
30544>>>    Integer iInt
30544>>>    Clear Branch
30545>>>    Move asCompany  to Branch.Company_Code
30546>>>    Move asBranch   to Branch.Branch_Code
30547>>>    Find Eq Branch by Index.1
30548>>>>
30548>>>    If (Trim(Branch.Tomeas_Code)<>'') Move (Trim(Branch.Tomeas_Code)) to asBranch
30551>>>    Move (Trim(asCompany))  to asCompany
30552>>>    Move (Trim(asBranch))   to asBranch
30553>>>    If (Length(asCompany)=1) Insert '0' In asCompany At 1
30557>>>    If (Length(asBranch) =1) Insert '0' In asBranch  At 1
30561>>>    Move ''                                           to rVal
30562>>>    Move (Sfi_All_Numbers(aiCode,aiPlaces,0))         to rVal
30563>>>    Move (Append((asCompany+'.'+asBranch+'.'),rVal))  to rVal
30564>>>    Move (Trim(rVal))                                 to rVal
30565>>>    Function_Return rVal
30566>>>End_Function
30567>>>
30567>>>Function fsgStripCodeFromID Global String asID Returns Integer
30568>>>      Integer iLen iPos iInt
30569>>>      If (Trim(asID)='') Function_Return 0
30572>>>      Move (Trim  (asID)) to asID
30573>>>      Move (Length(asID)) to iLen
30574>>>      For iInt From 1     to iLen
30580>>>>
30580>>>          If (Mid(asID,1,iInt)='.') Move iInt to iPos
30583>>>      Loop
30584>>>>
30584>>>      Function_Return (Right(asID,(iLen-iPos)))
30585>>>End_Function
30586>>>
30586>>>Function fsCityDescr Global Integer aiCityID Returns String
30587>>>    String rVal
30588>>>    Open Cities
INCLUDING FILE: CITIES.FD
30590>>>    Clear Cities
30591>>>    Move aiCityID to Cities.City_ID
30592>>>    Find Eq Cities By Index.1
30593>>>>
30593>>>    If (Found=1) Move Cities.City_descr to rVal
30596>>>    Else         Move '' to rVal
30598>>>    Function_Return rVal
30599>>>End_Function
30600>>>
30600>>>Function fiTownIDFromCity Global Integer aiCityID Returns Integer
30601>>>    Open Cities
30603>>>    Clear Cities
30604>>>    Move aiCityID to Cities.City_ID
30605>>>    Find Eq Cities By Index.1
30606>>>>
30606>>>    Function_Return Cities.Town_ID
30607>>>End_Function
30608>>>
30608>>>Function fiCountryIDFromTown Global Integer aiTownID Returns Integer
30609>>>    Open Towns
INCLUDING FILE: TOWNS.FD
30611>>>    Clear Towns
30612>>>    Move aiTownID to Towns.Town_ID
30613>>>    Find Eq Towns By Index.1
30614>>>>
30614>>>    Function_Return Towns.Country_ID
30615>>>End_Function
30616>>>
30616>>>Function fsTownDescr Global Integer aiTownID Returns String
30617>>>    String rVal
30618>>>    Open Towns
30620>>>    Clear Towns
30621>>>    Move aiTownID to Towns.Town_ID
30622>>>    Find Eq Towns By Index.1
30623>>>>
30623>>>    If (Found=1) Move Towns.Town_descr to rVal
30626>>>    Else         Move '' to rVal
30628>>>    Function_Return rVal
30629>>>End_Function
30630>>>
30630>>>Function fsCountryDescr Global Integer aiCountryID Returns String
30631>>>    String rVal
30632>>>    Open Country
INCLUDING FILE: COUNTRY.FD
30634>>>    Clear Country
30635>>>    Move aiCountryID to Country.Country_ID
30636>>>    Find Eq Country By Index.1
30637>>>>
30637>>>    If (Found=1) Move Country.Country_descr to rVal
30640>>>    Else         Move '' to rVal
30642>>>    Function_Return rVal
30643>>>End_Function
30644>>>
30644>>>Function fsAreaDescr Global Integer aiAreaID Returns String
30645>>>    String rVal
30646>>>    Open Areas
INCLUDING FILE: AREAS.FD
30648>>>    Clear Areas
30649>>>    Move aiAreaID to Areas.Area_ID
30650>>>    Find Eq Areas By Index.1
30651>>>>
30651>>>    If (Found=1) Move Areas.Area_descr to rVal
30654>>>    Else         Move '' to rVal
30656>>>    Function_Return rVal
30657>>>End_Function
30658>>>
30658>>>Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
30659>>>    Local String rVal lsTmp lsOO lsLL
30660>>>    Local Number lnOO lnLL
30660>>>
30660>>>    Move '' to lsOO
30661>>>    Move '' to lsLL
30662>>>    Move '' to rVal
30663>>>
30663>>>    Move (Integer(anTime))                              to lnOO
30664>>>
30664>>>    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
30665>>>
30665>>>    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
30668>>>    Else         Move (String(lnOO))                    to lsOO
30670>>>    Move (Trim(lsOO))                                   to lsOO
30671>>>
30671>>>    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
30674>>>    Else         Move (String(lnLL))                    to lsLL
30676>>>    Move (Trim(lsLL))                                   to lsLL
30677>>>
30677>>>    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
30678>>>
30678>>>    Move (Trim(rVal)) to rVal
30679>>>
30679>>>    Function_Return rVal
30680>>>End_Function
30681>>>
30681>>>Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
30682>>>    Local Number rVal nOres nLepta
30683>>>    Move (Integer(aiMinutes/60))    to nOres
30684>>>    Move (    Mod(aiMinutes,60))    to nLepta
30685>>>    Move (nOres+(nLepta/100))       to rVal
30686>>>    Function_Return rVal
30687>>>End_Function
30688>>>
30688>>>Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
30689>>>    Local Integer rVal
30690>>>    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
30691>>>    Function_Return rVal
30692>>>End_Function
30693>>>
30693>>>Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;                                                                    Number anEndTime    ;                                                                    Returns Integer
30694>>>    Local Integer rVal iMinStart iMinEnd
30695>>>
30695>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30698>>>
30698>>>    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
30699>>>    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
30700>>>    Move (iMinEnd-iMinStart)                                                     to rVal
30701>>>    Function_Return rVal
30702>>>End_Function
30703>>>
30703>>>
30703>>>Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;                                                                Number anEndTime    ;                                                                Returns Number
30704>>>    Local Integer iTmp
30705>>>    Local Number  rVal
30705>>>
30705>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30708>>>
30708>>>    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
30709>>>    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
30710>>>    Function_Return rVal
30711>>>End_Function
30712>>>
30712>>>
30712>>>
30712>>>Open WitemCL
INCLUDING FILE: WITEMCL.FD
30714>>>Open WitemCld
INCLUDING FILE: WITEMCLD.FD
30716>>>Open WitemxT
INCLUDING FILE: WITEMXT.FD
30718>>>
30718>>>Function fnTeleytaiaTimhAgoras String asPromCode String asItemCode  ;                               Date   adHmnia    Number anQty       ;                               Returns Number
30719>>>  Integer iExodos
30720>>>  Number nPoso nPct
30720>>>  Move 0 to nPoso
30721>>>  Move 0 to nPct
30722>>>  Move 0 to iExodos
30723>>>
30723>>>  Move (Trim(asItemCode)) to asItemCode
30724>>>  Move (Trim(asPromCode)) to asPromCode
30725>>>
30725>>>  // 1.Anazhthsh sto arxeio Witemcld
30725>>>  Clear Witemcld
30726>>>  Move asItemCode to Witemcld.Item_Code
30727>>>  Move asPromCode to Witemcld.Client_Code
30728>>>  Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30729>>>>
30729>>>  While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;                       (Witemcld.Client_Code= asPromCode) And ;                       (iExodos=0))
30733>>>      If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
30735>>>          Move 1 to iExodos
30736>>>               If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
30739>>>          Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
30743>>>      End
30743>>>>
30743>>>      Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30744>>>>
30744>>>  Loop
30745>>>>
30745>>>  If (iExodos) Begin
30747>>>      If (nPoso) Function_Return nPoso
30750>>>      Else Function_Return nPct
30752>>>  End
30752>>>>
30752>>>
30752>>>  // 2.Anazhthsh sto arxeio Witemcl
30752>>>  Clear WitemCL
30753>>>  Move (Trim(asPromCode)) to WitemCL.Client_Code
30754>>>  Move (Trim(asItemCode)) to WitemCL.Item_Code
30755>>>  Find Eq WitemCL By Index.1
30756>>>>
30756>>>  If (Found=1) Function_Return WitemCL.Client_Price
30759>>>
30759>>>  Function_Return 0
30760>>>End_Function
30761>>>
30761>>>Open BtnOrdd
INCLUDING FILE: BTNORDD.FD
30763>>>Function fnTeleytaiaTimhPolhshs String asWitemxRecr String asClientID ;                                String asWitemxCode Date   adHmnia    ;                                String asItemCode   Number anQty      ;                                String asCNCode     Returns Number
30764>>>
30764>>>  Integer iExodos iCheckDeop
30765>>>  Number nPoso nPct
30765>>>
30765>>>  Move (Num_Arguments=7) to iCheckDeop
30766>>>
30766>>>  Move 0 to nPoso
30767>>>  Move 0 to nPct
30768>>>  Move 0 to iExodos
30769>>>
30769>>>  Move (Trim(asItemCode))                 to asItemCode
30770>>>  Move (Trim(asClientID))                 to asClientID
30771>>>  Move (Trim(asWitemxRecr))               to asWitemxRecr
30772>>>  Move (Trim(asWitemxCode))               to asWitemxCode
30773>>>  If (iCheckDeop) Move (Trim(asCNCode))   to asCNCode
30776>>>
30776>>>  // 1. Anazhthsh apo DEOP ef' oson yparxei kodikos ergou
30776>>>  If (iCheckDeop) Begin
30778>>>      Clear btnordd
30779>>>      Move asClientID   to btnordd.vclient_id
30780>>>      Move asCNCode     to btnordd.vcn_code
30781>>>      Move asWitemxCode to btnordd.vitem
30782>>>      Move 0            to btnordd.vactive
30783>>>      Move adHmnia      to btnordd.arxh_date
30784>>>      Find LE btnordd by index.4//client_id+cn_code+item+arxh_date
30785>>>>
30785>>>      If ((found=1) and (asWitemxCode=btnordd.vitem)    and (adHmnia>=btnordd.arxh_date) ;                    and (adHmnia<=btnordd.deop_date)    and (btnordd.vactive=0)          ;                    and (asCNCode=btnordd.vcn_code)) begin
30787>>>          move btnordd.vprice to nPoso
30788>>>          If (nPoso) Function_Return nPoso
30791>>>      End
30791>>>>
30791>>>  End
30791>>>>
30791>>>
30791>>>  // 2.Anazhthsh sto arxeio Witemcld (Timokatalogos Pelath/Eidous)
30791>>>  Clear Witemcld
30792>>>  Move asItemCode to Witemcld.Item_Code
30793>>>  Move asClientID to Witemcld.Client_Code
30794>>>  Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30795>>>>
30795>>>  While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;                       (Witemcld.Client_Code= asClientID) And ;                       (iExodos=0))
30799>>>      If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
30801>>>          Move 1 to iExodos
30802>>>               If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
30805>>>          Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
30809>>>      End
30809>>>>
30809>>>      Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30810>>>>
30810>>>  Loop
30811>>>>
30811>>>  If (iExodos) Begin
30813>>>      If (nPoso) Function_Return nPoso
30816>>>      Else Function_Return nPct
30818>>>  End
30818>>>>
30818>>>
30818>>>
30818>>>  // 3.Anazhthsh sto arxeio Witemxt (Timokatalogos Eidous)
30818>>>  Clear Witemxt
30819>>>  Move SysCurXr.Company_Code  to Witemxt.Company_Code
30820>>>  Move SysCurXr.Branch_Code   to Witemxt.Branch_Code
30821>>>  Move SysCurXr.Year_Year     to Witemxt.Year_Year
30822>>>  Move asWitemxRecr           to Witemxt.Witemx_Recr
30823>>>  Find Gt Witemxt By Index.1 // Witemxt:Index.1
30824>>>>
30824>>>  While ((Found=1) And (Witemxt.Company_Code = SysCurXr.Company_Code) And ;                       (Witemxt.Branch_Code  = SysCurXr.Branch_Code ) And ;                       (Witemxt.Year_Year    = SysCurXr.Year_Year   ) And ;                       (Witemxt.Witemx_Recr  = asWitemxRecr         ) And ;                       (iExodos=0))
30828>>>      If ((adHmnia>=Witemxt.Value_Date) And (anQty<=Witemxt.Qty)) Begin
30830>>>          Move 1 to iExodos
30831>>>               If (Witemxt.Axia0 <>0) Move  Witemxt.Axia0         to nPoso
30834>>>          Else If (Witemxt.PcDisc<>0) Move (Witemxt.PcDisc*(-1))  to nPct
30838>>>      End
30838>>>>
30838>>>      Find Gt Witemxt By Index.1 // Witemxt:Index.1
30839>>>>
30839>>>  Loop
30840>>>>
30840>>>  If (iExodos) Begin
30842>>>      If (nPoso) Function_Return nPoso
30845>>>      Else Function_Return nPct
30847>>>  End
30847>>>>
30847>>>
30847>>>
30847>>>  // 4.Anazhthsh sto arxeio Witemcl (Teleytaia Timh Agoras)
30847>>>  Clear WitemCL
30848>>>  Move (Trim(asClientID)) to WitemCL.Client_Code
30849>>>  Move (Trim(asItemCode)) to WitemCL.Item_Code
30850>>>  Find Eq WitemCL By Index.1
30851>>>>
30851>>>  If (Found=1) Function_Return WitemCL.Client_Price
30854>>>
30854>>>  Function_Return 0
30855>>>End_Function
30856>>>
30856>>>Function fsStripTextFieldFromEnter Global String asStr Returns String
30857>>>    String sEnter
30858>>>    Move '' to sEnter
30859>>>    Move (Trim(asStr)) to asStr
30860>>>    Append sEnter (Character(13)) (Character(10))
30862>>>    Move (Replaces(sEnter,asStr,' ')) to asStr
30863>>>    Function_return (Trim(asStr))
30864>>>End_function
30865>>>
30865>>>
30865>>>//end   of global functions and procedures
30865>>>Use Wait.DG
INCLUDING FILE: WAIT.DG
30865>>>>>USE AllEntSc
30865>>>>>
30865>>>>>//AB-IgnoreEnd
30865>>>>>
30865>>>>>
30865>>>>>//AB-IgnoreEnd
30865>>>>>
30865>>>>>Object Wait is a ModalPanelSub
30867>>>>>
30867>>>>>    //AB-StoreTopStart
30867>>>>>
30867>>>>>    // How to Use It
30867>>>>>    // Get the maximum position of the bar
30867>>>>>    // Move (Bar_Maximum_position(Wait(self))) to iMax
30867>>>>>    //
30867>>>>>    // Set the maximum position of the bar
30867>>>>>    // Set Bar_Maximum_position of (Wait(self)) to iMax
30867>>>>>    //
30867>>>>>    // Start Bar Progress from beginning
30867>>>>>    // Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
30867>>>>>    //
30867>>>>>    // End Bar Progress
30867>>>>>    // Send Bar_Current_Position to (Wait(Self)) iMax iMax iMax False
30867>>>>>    //
30867>>>>>    // Update Bar Progress
30867>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax True OR
30867>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax False
30867>>>>>    // When you want the update to be done for every i (this is slower)
30867>>>>>    // Where i=Counter's current value, icounter=Counter's Max Value and iMax=Bar Max Position
30867>>>>>    //
30867>>>>>    // Display Buttons on the object
30867>>>>>    // Set Button_State of (Wait(Self)) to False/True
30867>>>>>    // If the Progress Bar gets initialized without buttons, it MUST be Deactivated
30867>>>>>    //
30867>>>>>    // Initialization of the Progress Bar
30867>>>>>    // Send Popup to (Wait(Self))
30867>>>>>    //
30867>>>>>    // Deactivation of the Progress Bar
30867>>>>>    // Send Deactivate to (Wait(Self))
30867>>>>>    //
30867>>>>>    // Message during the process
30867>>>>>    // Set Wait_Message of (Wait(Self)) to "Now Processing..."
30867>>>>>    //
30867>>>>>    // Extra Info for button "Info >>"
30867>>>>>    // Send Wait_Details to (Wait(Self)) sFile sDetail bInitData
30867>>>>>    // If sFile<>'' then reads the contents of the file
30867>>>>>    // Else Fills the Edit with the string of sDetail
30867>>>>>    // If bInitData is True then the edit object is cleared first else extra info is appended
30867>>>>>    //
30867>>>>>    // Remarks instead of Progress Bar
30867>>>>>    // Set Button_State of (Wait(Self))     to False
30867>>>>>    // Set BarVisibleState of (Wait(Self))  to 'Remarks' False
30867>>>>>    // Update During Process
30867>>>>>    // Send UpdateWait to (Wait(Self)) 'Remarks'
30867>>>>>
30867>>>>>    //AB-StoreTopEnd
30867>>>>>
30867>>>>>    Set Exit_Application_Local_State to FALSE
30868>>>>>    Set Modal_State to FALSE
30869>>>>>    Set Popup_State to TRUE
30870>>>>>    Set Border_Style to Border_Thick
30871>>>>>    Set Minimize_Icon to FALSE
30872>>>>>    Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
30873>>>>>    Set Size to 138 256
30874>>>>>
30874>>>>>    //AB-DDOStart
30874>>>>>
30874>>>>>
30874>>>>>    //AB-DDOEnd
30874>>>>>
30874>>>>>    Object WaitBar is a ProgressBarSub
30876>>>>>
30876>>>>>        //AB-StoreTopStart
30876>>>>>
30876>>>>>        //AB-StoreTopEnd
30876>>>>>
30876>>>>>        Set Size to 21 243
30877>>>>>        Set Location to 7 4
30878>>>>>
30878>>>>>        //AB-StoreStart
30878>>>>>        Send DoRegSize  self smTopRight
30879>>>>>        //AB-StoreEnd
30879>>>>>
30879>>>>>    End_Object
30880>>>>>
30880>>>>>    Object WaitText is a TextBoxSub
30882>>>>>
30882>>>>>        //AB-StoreTopStart
30882>>>>>
30882>>>>>        //AB-StoreTopEnd
30882>>>>>
30882>>>>>        Set Enabled_State to TRUE
30883>>>>>        Set Label to "Processing"
30884>>>>>        Set FontSize to 4 0
30885>>>>>        Set Size to 10 81
30886>>>>>        Set Location to 36 5
30887>>>>>
30887>>>>>        //AB-StoreStart
30887>>>>>
30887>>>>>        //AB-StoreEnd
30887>>>>>
30887>>>>>    End_Object
30888>>>>>
30888>>>>>    Object bnCancel is a ButtonSub
30890>>>>>
30890>>>>>        //AB-StoreTopStart
30890>>>>>
30890>>>>>        //AB-StoreTopEnd
30890>>>>>
30890>>>>>        Set Default_State to TRUE
30891>>>>>        Set Label to "OK"
30892>>>>>        Set Location to 34 143
30893>>>>>
30893>>>>>        //AB-StoreStart
30893>>>>>
30893>>>>>        Procedure OnClick
30895>>>>>             Send Deactivate to (Wait(Self))
30896>>>>>        End_Procedure
30897>>>>>
30897>>>>>        Send DoRegAlign self amTopRight
30898>>>>>        //AB-StoreEnd
30898>>>>>
30898>>>>>    End_Object
30899>>>>>
30899>>>>>    Object bnDetail is a ButtonSub
30901>>>>>
30901>>>>>        //AB-StoreTopStart
30901>>>>>
30901>>>>>        //AB-StoreTopEnd
30901>>>>>
30901>>>>>        Set Focus_Mode to Pointer_Only
30902>>>>>        Set Label to "Info >>"
30903>>>>>        Set Location to 34 197
30904>>>>>
30904>>>>>        //AB-StoreStart
30904>>>>>
30904>>>>>        Procedure OnClick
30906>>>>>            Delegate Send Show_Details False
30908>>>>>        End_Procedure
30909>>>>>
30909>>>>>        Send DoRegAlign self amTopRight
30910>>>>>        //AB-StoreEnd
30910>>>>>
30910>>>>>    End_Object
30911>>>>>
30911>>>>>    Object LineControlSub1 is a LineControlSub
30913>>>>>
30913>>>>>        //AB-StoreTopStart
30913>>>>>
30913>>>>>        //AB-StoreTopEnd
30913>>>>>
30913>>>>>        Set Size to 2 243
30914>>>>>        Set Location to 54 4
30915>>>>>
30915>>>>>        //AB-StoreStart
30915>>>>>
30915>>>>>        Send DoRegSize  self smTopRight
30916>>>>>        //AB-StoreEnd
30916>>>>>
30916>>>>>    End_Object
30917>>>>>
30917>>>>>    Object WaitEdit is a editSub
30919>>>>>
30919>>>>>        //AB-StoreTopStart
30919>>>>>
30919>>>>>        //AB-StoreTopEnd
30919>>>>>
30919>>>>>        Set Enabled_State to FALSE
30920>>>>>        Set Read_Only_State to TRUE
30921>>>>>        Set Size to 58 243
30922>>>>>        Set Location to 60 4
30923>>>>>        Set Color to clWhite
30924>>>>>
30924>>>>>        //AB-StoreStart
30924>>>>>
30924>>>>>        Send DoRegSize Self amBottomRight
30925>>>>>        Delegate Set Size to 66 256
30927>>>>>
30927>>>>>        //AB-StoreEnd
30927>>>>>
30927>>>>>    End_Object
30928>>>>>
30928>>>>>    Object oTxtAntiBar is a TextBoxSub
30930>>>>>        Set Enabled_State to TRUE
30931>>>>>        Set Visible_State to FALSE
30932>>>>>        Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
30933>>>>>        Set Justification_Mode to (jMode_Center IOR jMode_VCenter)
30934>>>>>        Set Auto_Size_State to FALSE
30935>>>>>        Set FontWeight to 600
30936>>>>>        Set FontSize to 4 0
30937>>>>>        Set Size to 10 209
30938>>>>>        Set Location to 10 4
30939>>>>>        Set TextColor to clNavy
30940>>>>>    End_Object
30941>>>>>
30941>>>>>
30941>>>>>    //AB-StoreStart
30941>>>>>    Property Integer piWaitSize  Public (Size(Self))
30943>>>>>    Property Integer piPrevSize  Public (Size(Self))
30945>>>>>    Property Integer piState     Public False
30947>>>>>
30947>>>>>    Set Locate_Mode to Center_On_Screen
30948>>>>>    Set Destroy_Object_State to True
30949>>>>>
30949>>>>>    Procedure Show_Details Integer bAlways
30951>>>>>        Local Integer liOriSize liSize hiSize hiOriSize lowSize bState
30952>>>>>        Local String sLabel
30952>>>>>        Get Size                to liSize
30953>>>>>        Get piState             to bState
30954>>>>>        Get piWaitSize          to liOriSize
30955>>>>>        Move (Hi(liSize))       to hiSize
30956>>>>>        Move (Low(liSize))      to lowSize
30957>>>>>        Move (Hi(liOriSize))    to hiOriSize
30958>>>>>        If (bAlways) Begin
30960>>>>>            Set piState         to False
30961>>>>>            Move 0              to bState
30962>>>>>        End
30962>>>>>>
30962>>>>>        If bState Begin
30964>>>>>             Set Size to hiOriSize lowSize
30965>>>>>             Set Label of (bnDetail(Self)) to "Info >>"
30966>>>>>        End
30966>>>>>>
30966>>>>>        Else Begin
30967>>>>>             Set Size to 138 lowSize
30968>>>>>             Set Label of (bnDetail(Self)) to "<< Info"
30969>>>>>        End
30969>>>>>>
30969>>>>>        Set piState to (1-bState)
30970>>>>>    End_Procedure
30971>>>>>
30971>>>>>    Procedure Bar_Current_Position Integer iCount Integer iOccurances Integer iMaximum Integer bState
30973>>>>>       If (bState) Begin
30975>>>>>         If (Mod(iCount,(iCount*((Number(iMaximum))/(Number(iOccurances)))))=0) ;            Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
30978>>>>>       End
30978>>>>>>
30978>>>>>       Else Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
30980>>>>>    End_Procedure
30981>>>>>
30981>>>>>    Procedure DoInitialize_WaitBar
30983>>>>>        Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
30984>>>>>    End_Procedure
30985>>>>>
30985>>>>>    Procedure DoTerminate_WaitBar
30987>>>>>        Local Integer iMax
30988>>>>>        Get Maximum_position of (WaitBar(Self)) to iMax
30989>>>>>        Send Bar_Current_Position to (Wait(Self)) iMax iMax Imax False
30990>>>>>    End_Procedure
30991>>>>>
30991>>>>>    Procedure Set Bar_Maximum_Position Integer iMaximum
30993>>>>>         Set Maximum_position of (WaitBar(Self)) to iMaximum
30994>>>>>    End_Procedure
30995>>>>>
30995>>>>>    Function Bar_Maximum_Position Returns Integer
30997>>>>>        Function_Return (Maximum_position(WaitBar(Self)))
30998>>>>>    End_Function
30999>>>>>
30999>>>>>    Procedure Set Bar_Minimum_Position Integer iMinimum
31001>>>>>         Set Minimum_position of (WaitBar(Self)) to iMinimum
31002>>>>>    End_Procedure
31003>>>>>
31003>>>>>    Function Bar_Minimum_Position Returns Integer
31005>>>>>        Function_Return (Minimum_position(WaitBar(Self)))
31006>>>>>    End_Function
31007>>>>>
31007>>>>>    Procedure Set Bar_Step_Value Integer iStep
31009>>>>>         Set Step_Value of (WaitBar(Self)) to iStep
31010>>>>>    End_Procedure
31011>>>>>
31011>>>>>    Function Bar_Step_Value Returns Integer
31013>>>>>        Function_Return (Step_Value(WaitBar(Self)))
31014>>>>>    End_Function
31015>>>>>
31015>>>>>    Procedure Set Wait_Message String sMessage
31017>>>>>        Set Value of (WaitText(Self)) to sMessage
31018>>>>>    End_Procedure
31019>>>>>
31019>>>>>    Procedure Wait_Details String sFile String sDetail Integer bInitData
31021>>>>>        Local Integer liEditId
31022>>>>>        Move (WaitEdit(Self)) to liEditId
31023>>>>>        If bInitData Send Delete_Data to liEditId
31026>>>>>        If sFile ne "" Begin
31028>>>>>           Send Read to liEditId sFile
31029>>>>>           Send Beginning_Of_Data to liEditId
31030>>>>>        End
31030>>>>>>
31030>>>>>        Else Begin
31031>>>>>           Send Insert to liEditId sDetail
31032>>>>>        End
31032>>>>>>
31032>>>>>    End_Procedure
31033>>>>>
31033>>>>>    Procedure OnResize
31035>>>>>        Local Integer liSize liHiSize liPrevSize liHiPrevSize bState liHiLoc liLoc
31036>>>>>        Get Size to liPrevSize
31037>>>>>        Move (Hi(liPrevSize)) to liHiPrevSize
31038>>>>>        Forward Send OnResize
31040>>>>>        Get Location of (WaitEdit(Self)) to liLoc
31041>>>>>        Move (Hi(liLoc)) to liHiLoc
31042>>>>>        Get piState to bState
31043>>>>>        Get Size to liSize
31044>>>>>        Move (Hi(liSize)) to liHiSize
31045>>>>>        If (liHiSize > (liHiLoc +30)) Begin
31047>>>>>            Set Value of (bnDetail(Self)) to "<< Info"
31048>>>>>            If (liHiPrevSize <= (liHiLoc +30)) Set piState to (1-bState)
31051>>>>>        End
31051>>>>>>
31051>>>>>        Else Begin
31052>>>>>            Set Value of (bnDetail(Self)) to "Info >>"
31053>>>>>            If (liHiPrevSize > (liHiLoc +30)) Set piState to (1-bState)
31056>>>>>        End
31056>>>>>>
31056>>>>>    End_Procedure
31057>>>>>
31057>>>>>    Procedure Set Button_State Integer bState
31059>>>>>        If bState Begin
31061>>>>>            Set Caption_Bar to True
31062>>>>>            Set Size to 66 256
31063>>>>>        End
31063>>>>>>
31063>>>>>        Else Begin
31064>>>>>            Set Caption_Bar to False
31065>>>>>            Set Size to 38 256
31066>>>>>        End
31066>>>>>>
31066>>>>>    End_Procedure
31067>>>>>
31067>>>>>    Procedure Set BarVisibleState String sMsg Integer bState
31069>>>>>        Set Visible_State of (oTxtAntiBar(Self)) to (bState = 0)
31070>>>>>        Set Visible_State of (WaitBar(Self))     to (bState = 1)
31071>>>>>        If (bState = 0) Begin
31073>>>>>            Set Size to 24 256
31074>>>>>            Set Location of (oTxtAntiBar(Self)) to 6 5
31075>>>>>        End
31075>>>>>>
31075>>>>>        If sMsg ne "" Set Value of (oTxtAntiBar(Self)) to sMsg
31078>>>>>    End_Procedure
31079>>>>>
31079>>>>>    Procedure Deactivating integer search_mode Returns Integer
31081>>>>>        local integer rval
31082>>>>>        Forward Get MSG_Deactivating search_mode to rval
31084>>>>>        Set Modal_State of (Wait(Self)) to False
31085>>>>>        Set BarVisibleState of (Wait(Self)) to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..." True
31086>>>>>        Procedure_Return rval
31087>>>>>    End_Procedure
31088>>>>>
31088>>>>>    Procedure UpdateWait String sMsg
31090>>>>>        Set Value of (oTxtAntiBar(Self)) to sMsg
31091>>>>>    End_Procedure
31092>>>>>
31092>>>>>
31092>>>>>    Procedure Set Horizontal_Justification Integer aiMode
31094>>>>>        Set Justification_Mode of oTxtAntiBar to (jMode_VCenter IOR aiMode)
31095>>>>>    End_Procedure
31096>>>>>
31096>>>>>
31096>>>>>
31096>>>>>
31096>>>>>
31096>>>>>
31096>>>>>    //AB-StoreEnd
31096>>>>>
31096>>>>>End_Object
31097>>>>>
31097>>>>>
31097>>>>>//AB-StoreStart
31097>>>>>
31097>>>>>//AB-StoreEnd
31097>>>>>
31097>>>>>//AB/ End_Object    // prj
31097>>>
31097>Use Calendar.sl
INCLUDING FILE: CALENDAR.SL
31097>>>//AB/ Project Calendar
31097>>>//AB/ Object prj is a Lookup_Project
31097>>>//AB/     Set ProjectName to "Calendar"
31097>>>//AB/     Set ProjectFileName to "Calendar.sl"
31097>>>
31097>>>// Project Object Structure
31097>>>//   oCalendar is a dbModalPanel
31097>>>//     Container3d1 is a Container3d
31097>>>//       Grid2 is a Grid
31097>>>//       Textbox2 is a Textbox
31097>>>//       Textbox3 is a Textbox
31097>>>//       Textbox4 is a Textbox
31097>>>//       Textbox5 is a Textbox
31097>>>//       Textbox6 is a Textbox
31097>>>//       Textbox7 is a Textbox
31097>>>//       Textbox8 is a Textbox
31097>>>//       LineControl1 is a LineControl
31097>>>//       Container3d2 is a Container3d
31097>>>//         oRght is a BitmapContainer
31097>>>//         oLeft is a BitmapContainer
31097>>>//         oMonth is a Textbox
31097>>>//           oSelectMonth is a FloatingPopupMenu
31097>>>//         oYear is a Textbox
31097>>>//         oSelectYear is a Form
31097>>>//     BitmapContainer3 is a BitmapContainer
31097>>>//     oToday is a Textbox
31097>>>
31097>>>// Register all objects
31097>>>Register_Object BitmapContainer3
31097>>>Register_Object Container3d1
31097>>>Register_Object Container3d2
31097>>>Register_Object Grid2
31097>>>Register_Object LineControl1
31097>>>Register_Object oCalendar
31097>>>Register_Object oLeft
31097>>>Register_Object oMonth
31097>>>Register_Object oRght
31097>>>Register_Object oSelectMonth
31097>>>Register_Object oSelectYear
31097>>>Register_Object oToday
31097>>>Register_Object oYear
31097>>>Register_Object Textbox2
31097>>>Register_Object Textbox3
31097>>>Register_Object Textbox4
31097>>>Register_Object Textbox5
31097>>>Register_Object Textbox6
31097>>>Register_Object Textbox7
31097>>>Register_Object Textbox8
31097>>>
31097>>>
31097>>>
31097>>>//AB-StoreTopStart
31097>>>Use dates.utl
INCLUDING FILE: DATES.UTL
31097>>>>>// **********************************************************************
31097>>>>>// Use Dates.utl    // Date manipulation for VDF and DF3.1
31097>>>>>//
31097>>>>>// by Sture Andersen (sa1@vd.dk)
31097>>>>>//
31097>>>>>// The file contains a number of global functions for manipulating
31097>>>>>// dates. The package may be used with DataFlex 3.1 and Visual DataFlex.
31097>>>>>// This package is public domain.
31097>>>>>//
31097>>>>>// The package file is accompanied by a Word document (dfutil.doc)
31097>>>>>// listing the functions and their use.
31097>>>>>//
31097>>>>>//
31097>>>>>// Create: Fri  06-06-1997 - Merger of s_utl020, 021, 022, 023, 024, 025.
31097>>>>>// Update: Thu  26-06-1997 - Fixes for strange behavior when date4_state is set.
31097>>>>>//                         - Addition of popup_calendar to VDF.
31097>>>>>//         Sun  29-06-1997 - Character mode popup calender.
31097>>>>>//         Fri  04-07-1997 - Function WeekToDate added.
31097>>>>>//         Thu  10-07-1997 - Fixes.
31097>>>>>//         Mon  11-08-1997 - WeekToDate fixed.
31097>>>>>//         Sun  24-08-1997 - Character mode popup calender finished.
31097>>>>>//         Mon  15-12-1997 - Procedure Request_Popup_Calendar added.
31097>>>>>//         Mon  29-12-1997 - Procedures ItemYear2to4, ItemDate2to4 and
31097>>>>>//                           ItemSysdate added.
31097>>>>>//         Mon  29-12-1997 - Procedures FieldYear2to4, FieldDate2to4 and
31097>>>>>//                           FieldSysdate added.
31097>>>>>//         Sun  01-02-1998 - Functions Module_Compile_Date and
31097>>>>>//                           Module_Compile_Time added.
31097>>>>>//         Wed  25-02-1998 - Request_Popup in calendar object now only
31097>>>>>//                           responds if entry_state of the calling object
31097>>>>>//                           is true (VDF version). (No apparent effect)
31097>>>>>//         Sat  28-03-1998 - Added the following functions:
31097>>>>>//                             TS_SysTime      TS_ExtractDate
31097>>>>>//                             TS_ExtractTime  TS_ConvertToString
31097>>>>>//         Tue  26-05-1998 - Procedure TS_UI_Update added
31097>>>>>//         Sat  01-08-1998 - mask_date_window taken into account
31097>>>>>//         Mon  10-08-1998 - Functions Module_Start_Date and
31097>>>>>//                           Module_Start_Time added.
31097>>>>>//         Wed  02-09-1998 - Parameter for Module_Start_Date removed
31097>>>>>//         Mon  12-10-1998 - Portuguese added
31097>>>>>//         Wed  04-11-1998 - TS_TimeEstimator class added
31097>>>>>//         Tue  29-12-1998 - Function DateAsString added
31097>>>>>//         Wed  13-01-1999 - Function DateWeekNumber changed according to
31097>>>>>//                           Kjetil Johanson
31097>>>>>//         Mon  18-01-1999 - Function DateWeekNumber changed according to
31097>>>>>//                           Kjetil Johanson (again)
31097>>>>>//         Tue  19-01-1999 - Changed procedure names in TS_TimeEstimator
31097>>>>>//                           class (Continue->TS_Continue and Pause->
31097>>>>>//                           TS_Pause)
31097>>>>>//         Thu  21-01-1999 - Procedures DateFormatAsString and DateFormatName
31097>>>>>//                           added.
31097>>>>>//                         - Procedures DateCurrentSeparator and
31097>>>>>//                           DateCurrentFormat added.
31097>>>>>//         Tue  13-04-1999 - Julian constants added: Jan1st1900, Jan1st2000
31097>>>>>//                           Jan1st1000 and Jan1st100
31097>>>>>//         Mon  26-04-1999 - Changed procedure FieldYear2to4 and ItemYear2to4
31097>>>>>//                           to trap 3 digit years.
31097>>>>>//         Wed  27-04-1999 - Changed Dutch abbriviated day names (to 2 characters)
31097>>>>>//         Sun  02-05-1999 - Added function TS_Compose2
31097>>>>>//                         - Fixed error in TS_ConvertToString
31097>>>>>//         Tue  01-06-1999 - Added procedure popup_no_export to calendar.
31097>>>>>//         Thu  15-06-1999 - Fixed Date4to2 function and exporting dates
31097>>>>>//                           from the calendar to forms with no form_margin.
31097>>>>>//         Tue  07-09-1999 - Added function DateAsText
31097>>>>>//         Wed  27-10-1999 - Temporary fix for Module_Compile_Date function
31097>>>>>//                           in combination with y2k.
31097>>>>>//         Wed  19-12-1999 - Function StringToDate added.
31097>>>>>//                         - Existing function DateAsString renamed to
31097>>>>>//                           DateToString.
31097>>>>>//         Mon  03-01-2000 - Fix for VDF4. Popup calendar on empty date field
31097>>>>>//                           would result in seeding the calendar on year 100.
31097>>>>>//                           This error was caused by the fact that VDF 4
31097>>>>>//                           ignores SYSDATE4_STATE such that the sysdate
31097>>>>>//                           command returns 03-01-100
31097>>>>>//         Wed  01-02-2000 - Define instead of #REPLACE
31097>>>>>//         Wed  23-08-2000 - Function TS_Module_Compile_Time added
31097>>>>>//
31097>>>>>// NOTE:  There is language dependent string constants in this file.
31097>>>>>//        Currently there are sections for dutch, english, danish, swedish,
31097>>>>>//        norwegian, spanish, german and portuguese
31097>>>>>//
31097>>>>>//        These sections may be identified by searching the symbol LNG_DEFAULT
31097>>>>>//
31097>>>>>// ***********************************************************************
31097>>>>>
31097>>>>>Use ui
31097>>>>>Use Language    // Set default languange if not set by compiler command line
INCLUDING FILE: LANGUAGE.PKG
31097>>>>>>>// Use Language     // Default language setup
31097>>>>>>>// Sets default languange if not set by compiler command line
31097>>>>>>>
31097>>>>>>>define lng_dutch      for 131
31097>>>>>>>define lng_french     for 133 // NOT TRANSLATED. DO NOT SELECT!
31097>>>>>>>define lng_spanish    for 134
31097>>>>>>>define lng_italian    for 139 // NOT TRANSLATED. DO NOT SELECT!
31097>>>>>>>define lng_english    for 144
31097>>>>>>>define lng_danish     for 145
31097>>>>>>>define lng_swedish    for 146
31097>>>>>>>define lng_norwegian  for 147
31097>>>>>>>define lng_Greek    for 148
31097>>>>>>>define lng_german     for 149
31097>>>>>>>define lng_portuguese for 155
31097>>>>>>>define lng_papiamentu for 199 // NOT TRANSLATED. DO NOT SELECT!
31097>>>>>>>
31097>>>>>>>
31097>>>>>>>define lng_default for !@
31097>>>>>>>
31097>>>>>>>  define _LANGUAGE_ for $ENGLISH$
31097>>>>>>>
#REM LANGUAGE SET BY LANGUAGE.PKG: $ENGLISH$
31097>>>>>Use Seq_Chnl    // Defines global sequential device management operations (DAC)
31097>>>>>Use Macros.utl  // Various macros (DESKTOP_SECTION)
INCLUDING FILE: MACROS.UTL
31097>>>>>>>// Use Macros.utl   // Various macros (FOR_EX...)
31097>>>>>>>
31097>>>>>>>//  FOR_EX (extended FOR command)
31097>>>>>>>//  -----------------------------
31097>>>>>>>//> The FOR_EX command is exactly like the standard FOR command except
31097>>>>>>>//> that it will allow you to use keyword "DOWN_TO" instead of "TO" if
31097>>>>>>>//> you need to do a decremental loop.
31097>>>>>>>
31097>>>>>>>
31097>>>>>>>//  DESKTOP_SECTION
31097>>>>>>>//  ---------------
31097>>>>>>>//> The DESKTOP_SECTION/END_DESKTOP_SECTION commands will make a sequence of
31097>>>>>>>//> code compile (or rather instantiate) as if it was situated on the DESKTOP
31097>>>>>>>//> even when it isn't. DESKTOP_SECTION's may not be nested.
31097>>>>>>>
31097>>>>>>>
31097>>>>>>>
31097>>>>>
31097>>>>>// Switches
31097>>>>>
31097>>>>>define DATES_INCLUDE_POPUP for 1   // If set to 0 the popup calendar will not be included
31097>>>>>define DATES_DF31B_EPOCH   for 40  // DF3.1b didn't have an epoch setting. Therefore this symbol defines the epoch value for that version.
31097>>>>>
31097>>>>> define t.calendar.year           for "Year"
31097>>>>> define t.calendar.month          for "Month"
31097>>>>> define t.calendar.day            for "Day"
31097>>>>> define t.calendar.week           for "Wk."
31097>>>>> define t.calendar.calendar_popup for "Calendar Popup"
31097>>>>> define t.calendar.Monday         for "Monday"
31097>>>>> define t.calendar.Tuesday        for "Tuesday"
31097>>>>> define t.calendar.Wednesday      for "Wednesday"
31097>>>>> define t.calendar.Thursday       for "Thursday"
31097>>>>> define t.calendar.Friday         for "Friday"
31097>>>>> define t.calendar.Saturday       for "Saturday"
31097>>>>> define t.calendar.Sunday         for "Sunday"
31097>>>>> define t.calendar.January        for "January"
31097>>>>> define t.calendar.February       for "February"
31097>>>>> define t.calendar.March          for "March"
31097>>>>> define t.calendar.April          for "April"
31097>>>>> define t.calendar.May            for "May"
31097>>>>> define t.calendar.June           for "June"
31097>>>>> define t.calendar.July           for "July"
31097>>>>> define t.calendar.August         for "August"
31097>>>>> define t.calendar.September      for "September"
31097>>>>> define t.calendar.October        for "October"
31097>>>>> define t.calendar.November       for "November"
31097>>>>> define t.calendar.December       for "December"
31097>>>>> define t.calendar.ok             for "OK"
31097>>>>> define t.calendar.Cancel         for "Cancel"
31097>>>>> define t.calendar.Activate       for "Activate popup calendar (Ctrl+D)"
31097>>>>>
31097>>>>>define LargestPossibleDate for 913490 // December 31st 2500
31097>>>>>define Jan1st1900          for 693975
31097>>>>>define Jan1st2000          for 730500
31097>>>>>define Jan1st1000          for 365250
31097>>>>>define Jan1st105           for 38352
31097>>>>>define Jan1st100           for 36525
31097>>>>>
31097>>>>>enumeration_list // Date Segments
31097>>>>>  define DS_DAY
31097>>>>>  define DS_WEEK
31097>>>>>  define DS_MONTH
31097>>>>>  define DS_YEAR
31097>>>>>end_enumeration_list
31097>>>>>
31097>>>>>integer Dates$Year Dates$Month Dates$Day // internal use
31097>>>>>
31097>>>>>procedure DateDecompose global date date# //very internal!!
31098>>>>>  local integer pos1# pos2# format#
31099>>>>>  local string str# sep#
31099>>>>>  get_attribute DF_DATE_FORMAT to format#
31102>>>>>  get_attribute DF_DATE_SEPARATOR to pos1# // overload
31105>>>>>  character pos1# to sep#                  // end overload
31106>>>>>>
31106>>>>>  move date# to str#
31107>>>>>  replace sep# in str# with "$"
31109>>>>>  move strmark to pos1#
31110>>>>>  if [found] begin
31112>>>>>    replace sep# in str# with "$"
31114>>>>>    move strmark to pos2#
31115>>>>>  end
31115>>>>>>
31115>>>>>  else begin
31116>>>>>    move 0 to Dates$Year
31117>>>>>    move 0 to Dates$Month
31118>>>>>    move 0 to Dates$Day
31119>>>>>  end
31119>>>>>>
31119>>>>>  [ found] begin
31121>>>>>>
31121>>>>>    if format# eq DF_DATE_EUROPEAN ;          left str# to Dates$Day    (pos1#-1)
31125>>>>>    if format# eq DF_DATE_USA begin
31127>>>>>          mid  str# to Dates$Day    (pos2#-pos1#-1) (pos1#+1)
31130>>>>>>
31130>>>>>          left str# to Dates$Month  (pos1#-1)
31132>>>>>>
31132>>>>>    end
31132>>>>>>
31132>>>>>    else  mid  str# to Dates$Month  (pos2#-pos1#-1) (pos1#+1)
31136>>>>>
31136>>>>>    if format# eq DF_DATE_MILITARY begin
31138>>>>>          mid  str# to Dates$Day  2 (pos2#+1)
31141>>>>>>
31141>>>>>          left str# to Dates$Year   (pos1#-1)
31143>>>>>>
31143>>>>>    end
31143>>>>>>
31143>>>>>    else  mid  str# to Dates$Year 4 (pos2#+1)
31147>>>>>  end
31147>>>>>>
31147>>>>>end_procedure
31148>>>>>
31148>>>>>function DateCompose global integer day# integer month# integer year# returns date
31149>>>>>  local integer format#
31150>>>>>  local date date#
31150>>>>>  local string sep#
31150>>>>>  ifnot (day#*month#*year#) function_return 0
31153>>>>>  get_attribute DF_DATE_SEPARATOR to format# // overload
31156>>>>>  character format# to sep#                  // end overload
31157>>>>>>
31157>>>>>  get_attribute DF_DATE_FORMAT to format#
31160>>>>>  if day# gt 28 begin
31162>>>>>    if format# eq DF_DATE_EUROPEAN move (date(string(day#)+sep#+string(month#)+sep#+string(year#))) to date# // DMY
31165>>>>>    if format# eq DF_DATE_USA      move (date(string(month#)+sep#+string(day#)+sep#+string(year#))) to date# // MDY
31168>>>>>    if format# eq DF_DATE_MILITARY move (date(string(year#)+sep#+string(month#)+sep#+string(day#))) to date# // YMD
31171>>>>>    send DateDecompose date#
31172>>>>>    if Dates$Month ne month# move (day#-Dates$Day) to day#
31175>>>>>  end
31175>>>>>>
31175>>>>>  if format# eq DF_DATE_EUROPEAN function_return (date(string(day#)+sep#+string(month#)+sep#+string(year#))) // DMY
31178>>>>>  if format# eq DF_DATE_USA function_return (date(string(month#)+sep#+string(day#)+sep#+string(year#))) // MDY
31181>>>>>  function_return (date(string(year#)+sep#+string(month#)+sep#+string(day#))) // YMD
31182>>>>>end_function
31183>>>>>
31183>>>>>function DateFormatName global integer format# returns string
31184>>>>>  if format# eq DF_DATE_EUROPEAN function_return "European"
31187>>>>>  if format# eq DF_DATE_USA      function_return "United States"
31190>>>>>  if format# eq DF_DATE_MILITARY function_return "Military"
31193>>>>>end_function
31194>>>>>
31194>>>>>function DateCurrentSeparator global returns string
31195>>>>>  local integer rval#
31196>>>>>  get_attribute DF_DATE_SEPARATOR to rval#
31199>>>>>  function_return (character(rval#))
31200>>>>>end_function
31201>>>>>
31201>>>>>function DateCurrentFormat global returns integer
31202>>>>>  local integer rval#
31203>>>>>  get_attribute DF_DATE_FORMAT to rval#
31206>>>>>  function_return rval#
31207>>>>>end_function
31208>>>>>
31208>>>>>function DateFormatAsString global integer format# integer long# string sep# returns string
31209>>>>>  local string rval# letter#
31210>>>>>  if format# eq DF_DATE_EUROPEAN move "3342241111" to rval#
31213>>>>>  if format# eq DF_DATE_USA      move "2243341111" to rval#
31216>>>>>  if format# eq DF_DATE_MILITARY move "1111422433" to rval#
31219>>>>>  left t.calendar.year to letter# 1
31221>>>>>>
31221>>>>>  replace "1" in rval# with letter#
31223>>>>>  replace "1" in rval# with letter#
31225>>>>>  ifnot long# move "" to letter#
31228>>>>>  move (replaces("1",rval#,letter#)) to rval#
31229>>>>>  move (replaces("2",rval#,left(t.calendar.month,1))) to rval#
31230>>>>>  move (replaces("3",rval#,left(t.calendar.day,1))) to rval#
31231>>>>>  if sep# eq "" begin
31233>>>>>    get_attribute DF_DATE_SEPARATOR to format#
31236>>>>>    character format# to sep#
31237>>>>>>
31237>>>>>  end
31237>>>>>>
31237>>>>>  move (replaces("4",rval#,sep#)) to rval#
31238>>>>>  function_return rval#
31239>>>>>end_function
31240>>>>>
31240>>>>>function StringToDate global string date# integer format# integer four_digit_year# string sep# returns date
31241>>>>>  local integer sep_len# day# month# year#
31242>>>>>  move (length(sep#)) to sep_len#
31243>>>>>  if four_digit_year# move 4 to four_digit_year#
31246>>>>>  else move 2 to four_digit_year#
31248>>>>>  if format# eq DF_DATE_EUROPEAN begin // DMY
31250>>>>>    move (mid(date#,2,1)) to day#
31251>>>>>    move (mid(date#,2,3+sep_len#)) to month#
31252>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31253>>>>>  end
31253>>>>>>
31253>>>>>  if format# eq DF_DATE_USA begin // MDY
31255>>>>>    move (mid(date#,2,1)) to month#
31256>>>>>    move (mid(date#,2,3+sep_len#)) to year#
31257>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31258>>>>>  end
31258>>>>>>
31258>>>>>  if format# eq DF_DATE_MILITARY begin // YMD
31260>>>>>    move (mid(date#,four_digit_year#,1)) to year#
31261>>>>>    move (mid(date#,2,1+four_digit_year#+sep_len#)) to month#
31262>>>>>    move (mid(date#,2,3+four_digit_year#+sep_len#+sep_len#)) to day#
31263>>>>>  end
31263>>>>>>
31263>>>>>  function_return (DateCompose(day#,month#,year#))
31264>>>>>end_function
31265>>>>>
31265>>>>>function DateToString global date date# integer format# integer four_digit_year# string sep# returns string
31266>>>>>  local string rval# day# month# year#
31267>>>>>  get Date2to4 date# to date#
31268>>>>>  if (integer(date#)) begin
31270>>>>>    send DateDecompose date#
31271>>>>>    move Dates$Day to day#
31272>>>>>    if Dates$Day lt 10 insert "0" in day# at 1
31276>>>>>    move Dates$Month to month#
31277>>>>>    if Dates$Month lt 10 insert "0" in month# at 1
31281>>>>>    move Dates$Year to year#
31282>>>>>    ifnot four_digit_year# move (right(year#,2)) to year#
31285>>>>>    if format# eq DF_DATE_EUROPEAN move (day#+sep#+month#+sep#+year#) to rval# // DMY
31288>>>>>    if format# eq DF_DATE_USA      move (month#+sep#+day#+sep#+year#) to rval# // MDY
31291>>>>>    if format# eq DF_DATE_MILITARY move (year#+sep#+month#+sep#+day#) to rval# // YMD
31294>>>>>  end
31294>>>>>>
31294>>>>>  function_return rval#
31295>>>>>end_function
31296>>>>>
31296>>>>>// Function DateAsString is only here for compatibility with earlier versions.
31296>>>>>// Use function DateToString instead.
31296>>>>>function DateAsString global date date# integer format# integer four_digit_year# string sep# returns string
31297>>>>>  function_return (DateToString(date#,format#,four_digit_year#,sep#))
31298>>>>>end_function
31299>>>>>
31299>>>>>function DateIncrement global date date# integer segment# integer amount# returns date
31300>>>>>  if (date#=0) function_return 0
31303>>>>>  if segment# eq DS_WEEK function_return (date#+(amount#*7)) //weeks
31306>>>>>  if (segment#<>DS_DAY) begin // months or years
31308>>>>>    send DateDecompose date#
31309>>>>>    if segment# eq DS_MONTH begin //months
31311>>>>>      move (Dates$Month+amount#) to Dates$Month
31312>>>>>      if amount# ge 0 function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-1)/12)*12),Dates$Year+((Dates$Month-1)/12)))
31315>>>>>      function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-12)/12)*12),Dates$Year+((Dates$Month-12)/12)))
31316>>>>>    end //years:
31316>>>>>>
31316>>>>>    if segment# eq DS_YEAR function_return (DateCompose(Dates$Day,Dates$Month,Dates$Year+amount#))
31319>>>>>  end
31319>>>>>>
31319>>>>>  else function_return (date#+amount#) //days
31321>>>>>end_function
31322>>>>>
31322>>>>>function DateSegment global date date# integer segment# returns integer
31323>>>>>  send DateDecompose date#
31324>>>>>  if segment# eq DS_DAY   function_return Dates$Day
31327>>>>>  if segment# eq DS_MONTH function_return Dates$Month
31330>>>>>  if segment# eq DS_YEAR  function_return Dates$Year
31333>>>>>end_function
31334>>>>>
31334>>>>>function DateToInteger global date date# returns integer
31335>>>>>  send DateDecompose date#
31336>>>>>  function_return (Dates$Year*100+Dates$Month*100+Dates$Day)
31337>>>>>end_function
31338>>>>>
31338>>>>>function FirstDayInMonth global date date# returns date
31339>>>>>  local integer month# year#
31340>>>>>  move (DateSegment(date#,DS_MONTH)) to month#
31341>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31342>>>>>  function_return (DateCompose(1,month#,year#))
31343>>>>>end_function
31344>>>>>
31344>>>>>function LastDayInMonth global date date# returns date
31345>>>>>  move (DateIncrement(date#,DS_MONTH,1)) to date#
31346>>>>>  function_return (FirstDayInMonth(date#)-1)
31347>>>>>end_function
31348>>>>>
31348>>>>>function FirstDayInYear global date date# returns date
31349>>>>>  local integer year#
31350>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31351>>>>>  function_return (DateCompose(1,1,year#))
31352>>>>>end_function
31353>>>>>
31353>>>>>function LastDayInYear global date date# returns date
31354>>>>>  move (DateIncrement(date#,DS_YEAR,1)) to date#
31355>>>>>  function_return (FirstDayInYear(date#)-1)
31356>>>>>end_function
31357>>>>>
31357>>>>>// Prior to 18/1-99 version of DateWeekNumber
31357>>>>>//function DateWeekNumber global date date# returns integer
31357>>>>>//  local integer week# first_wd# day_of_year# year#
31357>>>>>//  if (date#=0) function_return 0
31357>>>>>//  get Date2to4 date# to date#
31357>>>>>//  move (DateSegment(date#,DS_YEAR)) to year#
31357>>>>>//  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31357>>>>>//  move (date#-FirstDayInYear(date#)) to day_of_year#
31357>>>>>//  move (day_of_year#-1-7+first_wd#) to day_of_year#
31357>>>>>//  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31357>>>>>//  else move 0 to week#
31357>>>>>//  if first_wd# le 4 increment week#
31357>>>>>//  if week# gt 52 begin
31357>>>>>//    move 1 to week#
31357>>>>>//    if first_wd# eq 4 move 53 to week#
31357>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31357>>>>>//  end
31357>>>>>//  if week# eq 0 begin
31357>>>>>//    //get DateWeekNumber (DateIncrement(date#,DS_YEAR,-1)) to first_wd# // Original line
31357>>>>>//    get DateDayNumber  (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#ÿ // changed line
31357>>>>>//    move 52 to week#
31357>>>>>//    if first_wd# eq 4 move 53 to week#
31357>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31357>>>>>//  end
31357>>>>>//  function_return week#
31357>>>>>//end_function
31357>>>>>
31357>>>>>function DateWeekNumber global date date# returns integer
31358>>>>>  local integer week# first_wd# day_of_year# year# wd#
31359>>>>>  if (date#=0) function_return 0
31362>>>>>  get Date2to4 date# to date#
31363>>>>>  // Leap-year test for actual or previous year
31363>>>>>  // Year# only used for selection between 52 and
31363>>>>>  // Therefore get year# from the first day of actual week
31363>>>>>  get DateDayNumber date# to wd#
31364>>>>>  move (DateSegment(date#-wd#+1,DS_YEAR)) to year#
31365>>>>>
31365>>>>>  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31366>>>>>  move (date#-FirstDayInYear(date#)) to day_of_year#
31367>>>>>  move (day_of_year#-1-7+first_wd#) to day_of_year#
31368>>>>>  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31371>>>>>  else move 0 to week#
31373>>>>>  if first_wd# le 4 increment week#
31376>>>>>  if week# gt 52 begin
31378>>>>>    move 1 to week#
31379>>>>>    if first_wd# eq 4 move 53 to week#
31382>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31389>>>>>  end
31389>>>>>>
31389>>>>>  if week# eq 0 begin
31391>>>>>    // Week 52 or 53
31391>>>>>    get DateDayNumber (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#
31392>>>>>    move 52 to week#
31393>>>>>    if first_wd# eq 4 move 53 to week#
31396>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31403>>>>>  end
31403>>>>>>
31403>>>>>  function_return week#
31404>>>>>end_function
31405>>>>>
31405>>>>>function DayName global integer int# returns string
31406>>>>>  if int# eq 1 function_return t.calendar.Monday
31409>>>>>  if int# eq 2 function_return t.calendar.Tuesday
31412>>>>>  if int# eq 3 function_return t.calendar.Wednesday
31415>>>>>  if int# eq 4 function_return t.calendar.Thursday
31418>>>>>  if int# eq 5 function_return t.calendar.Friday
31421>>>>>  if int# eq 6 function_return t.calendar.Saturday
31424>>>>>  if int# eq 7 function_return t.calendar.Sunday
31427>>>>>  function_return ""
31428>>>>>end_function
31429>>>>>
31429>>>>>function DateDayNumber global date date# returns integer
31430>>>>>  local integer rval# // 1=Monday, ... , 7=Sunday
31431>>>>>  get Date2to4 date# to date#
31432>>>>>  move date# to rval#
31433>>>>>  if rval# begin
31435>>>>>    if rval# gt 693975 move (rval#-2) to rval#
31438>>>>>    move (rval#-((rval#/7)*7)) to rval#
31439>>>>>    if rval# eq 0 move 7 to rval#
31442>>>>>  end
31442>>>>>>
31442>>>>>  function_return rval#
31443>>>>>end_function
31444>>>>>
31444>>>>>function DateDayName global date date# returns string
31445>>>>>  function_return (DayName(DateDayNumber(date#)))
31446>>>>>end_function
31447>>>>>
31447>>>>>function YearMaxWeek global integer year# returns integer
31448>>>>>  local integer wk1# wk2#
31449>>>>>  get DateWeekNumber (DateCompose(31,12,year#)) to wk1#
31450>>>>>  get DateWeekNumber (DateCompose(24,12,year#)) to wk2#
31451>>>>>  function_return (wk1# max wk2#)
31452>>>>>end_function
31453>>>>>
31453>>>>>function WeekToDate global integer year# integer week# returns date
31454>>>>>  local date date#
31455>>>>>  move (DateCompose(1,1,year#)) to date#
31456>>>>>  if (DateWeekNumber(date#)) ne 1 move (date#+7) to date# // week 52 or 53
31459>>>>>  move (date#-DateDayNumber(date#)+1) to date# // Now it's a Monday
31460>>>>>  function_return (week#-1*7+date#)
31461>>>>>end_function
31462>>>>>
31462>>>>>function MonthName global integer int# returns string
31463>>>>>  if int# eq  1 function_return t.calendar.January
31466>>>>>  if int# eq  2 function_return t.calendar.February
31469>>>>>  if int# eq  3 function_return t.calendar.March
31472>>>>>  if int# eq  4 function_return t.calendar.April
31475>>>>>  if int# eq  5 function_return t.calendar.May
31478>>>>>  if int# eq  6 function_return t.calendar.June
31481>>>>>  if int# eq  7 function_return t.calendar.July
31484>>>>>  if int# eq  8 function_return t.calendar.August
31487>>>>>  if int# eq  9 function_return t.calendar.September
31490>>>>>  if int# eq 10 function_return t.calendar.October
31493>>>>>  if int# eq 11 function_return t.calendar.November
31496>>>>>  if int# eq 12 function_return t.calendar.December
31499>>>>>  function_return ""
31500>>>>>end_function
31501>>>>>
31501>>>>>function DateMonthName global date date# returns string
31502>>>>>  function_return (MonthName(DateSegment(date#,DS_MONTH)))
31503>>>>>end_function
31504>>>>>
31504>>>>>function DateAsText global date date# string format# returns string
31505>>>>>  if date# eq 0 function_return ""
31508>>>>>  move (replace("#DN",format#,DateDayName(date#)))                  to format#
31509>>>>>  move (replace("#MN",format#,DateMonthName(date#)))                to format#
31510>>>>>  move (replace("#D" ,format#,string(DateSegment(date#,DS_DAY))))   to format#
31511>>>>>  move (replace("#Y" ,format#,string(DateSegment(date#,DS_YEAR))))  to format#
31512>>>>>  move (replace("#M" ,format#,string(DateSegment(date#,DS_MONTH)))) to format#
31513>>>>>  function_return format#
31514>>>>>end_function
31515>>>>>
31515>>>>>function Year2to4 global integer year# returns integer
31516>>>>>  local integer epoch_value#
31517>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31518>>>>>  if year# lt 100 begin
31520>>>>>    if year# gt epoch_value# function_return (year#+1900)
31523>>>>>    function_return (year#+2000)
31524>>>>>  end
31524>>>>>>
31524>>>>>  function_return year# // No conversion done!
31525>>>>>end_function
31526>>>>>
31526>>>>>function Date2to4 global date date# returns date
31527>>>>>  local integer epoch_value#
31528>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31529>>>>>  if date# gt 0 begin // Only if there is a date to convert
31531>>>>>    if (DateSegment(date#,DS_YEAR)) lt 105 begin
31533>>>>>      if Dates$Year gt epoch_value# function_return (DateIncrement(date#,DS_YEAR,1900))
31536>>>>>      function_return (DateIncrement(date#,DS_YEAR,2000))
31537>>>>>    end
31537>>>>>>
31537>>>>>    function_return date# // No conversion done!
31538>>>>>  end
31538>>>>>>
31538>>>>>end_function
31539>>>>>
31539>>>>>function Date4to2 global date date# returns date
31540>>>>>  local integer epoch_value# year#
31541>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31542>>>>>  if date# gt 0 begin // Only if there is a date to convert
31544>>>>>    move (DateSegment(date#,DS_YEAR)) to year#
31545>>>>>    if year# ge 100 begin // Only then conversion is needed!
31547>>>>>      if (year#>=(1900+epoch_value#) and year#<(2000+epoch_value#)) begin
31549>>>>>        if year# lt 2000 function_return (DateIncrement(date#,DS_YEAR,-1900))
31552>>>>>        else             function_return (DateIncrement(date#,DS_YEAR,-2000))
31554>>>>>      end
31554>>>>>>
31554>>>>>      else error 301 "Date is out of epoch range"
31556>>>>>    end
31556>>>>>>
31556>>>>>  end
31556>>>>>>
31556>>>>>  function_return date# // No conversion done!
31557>>>>>end_function
31558>>>>>
31558>>>>>function dSysDate global returns date
31559>>>>>  local date date#
31560>>>>>  sysdate4 date#
31561>>>>>  function_return date#
31562>>>>>end_function
31563>>>>>
31563>>>>>function iSysYear global returns integer
31564>>>>>  local date date#
31565>>>>>  sysdate4 date#
31566>>>>>  function_return (DateSegment(date#,DS_YEAR))
31567>>>>>end_function
31568>>>>>
31568>>>>>procedure ItemSysdate for desktop integer itm#
31569>>>>>  local date date#
31570>>>>>  get value item itm# to date#
31571>>>>>  if date# eq 0 begin
31573>>>>>    sysdate4 date#
31574>>>>>    set changed_value item itm# to date#
31575>>>>>  end
31575>>>>>>
31575>>>>>end_procedure
31576>>>>>
31576>>>>>procedure ItemDate2to4 for desktop integer itm#
31577>>>>>  local integer year#
31578>>>>>  local date date# new_date#
31578>>>>>  get value item itm# to date#
31579>>>>>
31579>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31580>>>>>  if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31583>>>>>  else move date# to new_date#
31585>>>>>
31585>>>>>  move (Date2to4(new_date#)) to new_date#
31586>>>>>  move (DateSegment(new_date#,3)) to year#
31587>>>>>  if (year#>99 and year#<1000) begin
31589>>>>>    error 15 // Illegal entry in this window
31590>>>>>>
31590>>>>>    procedure_return 1
31591>>>>>  end
31591>>>>>>
31591>>>>>  if new_date# ne date# set value item itm# to new_date#
31594>>>>>end_procedure
31595>>>>>
31595>>>>>procedure ItemYear2to4 for desktop integer itm#
31596>>>>>  local integer year# new_year#
31597>>>>>  get value item itm# to year#
31598>>>>>  if (year#>99 and year#<1000) begin
31600>>>>>    error 15 // Illegal entry in this window
31601>>>>>>
31601>>>>>    procedure_return 1
31602>>>>>  end
31602>>>>>>
31602>>>>>  move (Year2to4(year#)) to new_year#
31603>>>>>  if new_year# ne year# set value item itm# to new_year#
31606>>>>>end_procedure
31607>>>>>
31607>>>>> procedure FieldSysdate for DataDictionary integer fld#
31608>>>>>   local date date#
31609>>>>>   get field_current_value fld# to date#
31610>>>>>   if date# eq 0 begin
31612>>>>>     sysdate4 date#
31613>>>>>     set field_changed_value fld# to date#
31614>>>>>   end
31614>>>>>>
31614>>>>> end_procedure
31615>>>>>
31615>>>>> procedure FieldDate2to4 for DataDictionary integer fld#
31616>>>>>   local integer year#
31617>>>>>   local date date# new_date#
31617>>>>>   get field_current_value fld# to date#
31618>>>>>
31618>>>>>   move (DateSegment(date#,DS_YEAR)) to year#
31619>>>>>   if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31622>>>>>   else move date# to new_date#
31624>>>>>
31624>>>>>   move (Date2to4(new_date#)) to new_date#
31625>>>>>   move (DateSegment(new_date#,3)) to year#
31626>>>>>   if (year#>99 and year# <=999) begin
31628>>>>>     error 15 // Illegal entry in this window
31629>>>>>>
31629>>>>>     procedure_return 1
31630>>>>>   end
31630>>>>>>
31630>>>>>   if new_date# ne date# set field_changed_value fld# to new_date#
31633>>>>> end_procedure
31634>>>>>
31634>>>>> procedure FieldYear2to4 for DataDictionary integer fld#
31635>>>>>   local integer year# new_year# changed#
31636>>>>>   get field_current_value fld# to year#
31637>>>>>   get field_changed_state fld# to changed#
31638>>>>>   if changed# begin
31640>>>>>     if (year#>99 and year#<1000) begin
31642>>>>>       error 15 // Illegal entry in this window
31643>>>>>>
31643>>>>>       procedure_return 1
31644>>>>>     end
31644>>>>>>
31644>>>>>     move (Year2to4(year#)) to new_year#
31645>>>>>     if new_year# ne year# set field_changed_value fld# to new_year#
31648>>>>>   end
31648>>>>>>
31648>>>>> end_procedure
31649>>>>>
31649>>>>> function SysDate global returns date
31650>>>>>   function_return (dSysDate())
31651>>>>> end_function
31652>>>>>
31652>>>>>function sSysTime global returns string
31653>>>>>  local integer h# m# s#
31654>>>>>  sysdate4 h# h# m# s#
31658>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31659>>>>>end_function
31660>>>>>
31660>>>>>function TS_SysTime global returns number
31661>>>>>  local integer d# h# m# s#
31662>>>>>  sysdate4 d# h# m# s#
31666>>>>>  function_return (d#*24.0+h#*60+m#*60+s#)
31667>>>>>end_function
31668>>>>>
31668>>>>>//> This function returns a TS value composed from the date and time
31668>>>>>//> passed to it. Note that the time variable must be of the format
31668>>>>>//> "hh:mm:ss".
31668>>>>>function TS_Compose global date date# string time# returns number
31669>>>>>  local integer h# m# s#
31670>>>>>  left time# to h# 2
31672>>>>>>
31672>>>>>  mid time# to m# 2 4
31675>>>>>>
31675>>>>>  mid time# to s# 2 7
31678>>>>>>
31678>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31679>>>>>end_function
31680>>>>>
31680>>>>>function TS_Compose2 global date date# integer h# integer m# integer s# returns number
31681>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31682>>>>>end_function
31683>>>>>
31683>>>>>function TS_ExtractDate global number time# returns date
31684>>>>>  function_return (time#/86400) // 86400=24*60*60
31685>>>>>end_function
31686>>>>>
31686>>>>>function TS_ExtractTime global number time# returns string
31687>>>>>  local integer h# m# s#
31688>>>>>  move (time#-(86400.0*integer(TS_ExtractDate(time#)))) to s#
31689>>>>>  move (s#/3600) to h#
31690>>>>>  move (s#-(h#*3600)) to s#
31691>>>>>  move (s#/60) to m#
31692>>>>>  move (s#-(m#*60)) to s#
31693>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31694>>>>>end_function
31695>>>>>
31695>>>>>function TS_ConvertToString global number time# returns string
31696>>>>>  local date d#
31697>>>>>  move (TS_ExtractDate(time#)) to d#
31698>>>>>  if (integer(d#)) function_return (string(d#)+" "+TS_ExtractTime(time#))
31701>>>>>  else function_return (TS_ExtractTime(time#))
31703>>>>>end_function
31704>>>>>
31704>>>>>function TS_ConvertToStringNoDate global number ts# returns string
31705>>>>>  local integer h# m#
31706>>>>>  move (ts#/3600) to h#
31707>>>>>  move (ts#-(h#*3600)) to ts#
31708>>>>>  move (ts#/60) to m#
31709>>>>>  move (ts#-(m#*60)) to ts#
31710>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(ts#<10,"0","")+string(ts#))
31711>>>>>end_function
31712>>>>>
31712>>>>>// This procedure is used when a TS-variable must be displayed on screen.
31712>>>>>procedure TS_UI_Update global number TS# integer obj1# integer itm1# integer tmp_obj2# integer tmp_itm2#
31713>>>>>  local integer obj2# itm2#
31714>>>>>  if num_arguments gt 3 begin
31716>>>>>    move tmp_obj2# to obj2#
31717>>>>>    move tmp_itm2# to itm2#
31718>>>>>  end
31718>>>>>>
31718>>>>>  else begin
31719>>>>>    move obj1# to obj2#
31720>>>>>    move (itm1#+1) to itm2#
31721>>>>>  end
31721>>>>>>
31721>>>>>  set value of obj1# item itm1# to (TS_ExtractDate(TS#))
31722>>>>>  set value of obj2# item itm2# to (TS_ExtractTime(TS#))
31723>>>>>end_procedure
31724>>>>>
31724>>>>>class TS_TimeEstimator is an array
31725>>>>>  procedure construct_object
31726>>>>>    forward send construct_object
31728>>>>>    set delegation_mode to delegate_to_parent
31729>>>>>    property number  pnTotal   public 0 // Seconds needed to run the loop.
31730>>>>>    property number  pnElapsed public 0 // Seconds elapsed so far.
31731>>>>>    property number  pnLeft    public 0 // Number of seconds left
31732>>>>>    property number  pnStart   public 0
31733>>>>>    property number  pnPause   public 0
31734>>>>>    property number  pnPercent public 0
31735>>>>>    property integer piMin     public 0
31736>>>>>    property integer piMax     public 0
31737>>>>>  end_procedure
31738>>>>>
31738>>>>>  procedure TS_Start integer min# integer max#
31739>>>>>    set piMin to min#
31740>>>>>    set piMax to max#
31741>>>>>    set pnStart to (TS_SysTime())
31742>>>>>    set pnElapsed to 0
31743>>>>>    set pnPercent to 0
31744>>>>>  end_procedure
31745>>>>>
31745>>>>>  procedure TS_Calculate integer pos#
31746>>>>>    local integer min# max#
31747>>>>>    get piMin to min#
31748>>>>>    get piMax to max#
31749>>>>>    set pnElapsed to (TS_SysTime()-pnStart(current_object))
31750>>>>>    set pnTotal   to (pnElapsed(current_object)*(max#-min#)/number(pos#-min#))
31751>>>>>    set pnLeft    to (pnTotal(current_object)-pnElapsed(current_object))
31752>>>>>    set pnPercent to (100.0*(pos#-min#)/(max#-min#))
31753>>>>>  end_procedure
31754>>>>>
31754>>>>>  procedure TS_Pause
31755>>>>>    set pnPause to (TS_SysTime())
31756>>>>>  end_procedure
31757>>>>>
31757>>>>>  procedure TS_Continue
31758>>>>>    set pnStart to (pnStart(current_object)+TS_SysTime()-pnPause(current_object))
31759>>>>>  end_procedure
31760>>>>>end_class
31761>>>>>
31761>>>>>function TS_Module_Compile_Time global string path# returns number
31762>>>>>  local integer pos# day# month# year# seqeof# ch#
31763>>>>>  local string date# str# time#
31763>>>>>  move path# to str#
31764>>>>>  if str# ne "" begin
31766>>>>>    get Seq_New_Channel to ch#   // This method and Seq_Release_Channel are
31767>>>>>    send Seq_Release_Channel ch# // We only need it for a second
31768>>>>>      direct_input channel ch# (trim(str#)+".vd6") // VDF 6
31770>>>>>      [seqeof] direct_input channel ch# (trim(str#)+".vd5") // VDF 5
31772>>>>>    [ seqeof] move 1 to seqeof#
31773>>>>>    [~seqeof] move 0 to seqeof#
31774>>>>>    [~seqeof] readln str#
31775>>>>>    close_input channel ch#
31777>>>>>  end
31777>>>>>>
31777>>>>>  if seqeof# function_return 0
31780>>>>>  pos "," in str# to pos#
31782>>>>>>
31782>>>>>  move (mid(str#,18,pos#+2)) to str#
31783>>>>>  move (integer(mid(str#,2,4))) to day#
31784>>>>>  move (integer(mid(str#,2,1))) to month#
31785>>>>>  move (integer(mid(str#,2,7))) to year#
31786>>>>>  if year# eq 10 begin
31788>>>>>    move (integer(mid(str#,3,7))+1900) to year#
31789>>>>>    move (mid(str#,8,11)) to str#
31790>>>>>  end
31790>>>>>>
31790>>>>>  else move (mid(str#,8,10)) to str#
31792>>>>>  move (DateCompose(day#,month#,year#)) to date#
31793>>>>>  move (Date2to4(date#)) to date#
31794>>>>>  pos ":" in str# to pos#
31796>>>>>>
31796>>>>>  function_return (TS_Compose(date#,mid(str#,8,pos#-2)))
31797>>>>>end_function
31798>>>>>
31798>>>>>string Dates$Module_Compile_Time
31798>>>>>move "" to Dates$Module_Compile_Time
31799>>>>>
31799>>>>>function Module_Compile_Date global returns date
31800>>>>>  local number ts#
31801>>>>>  local string str#
31801>>>>>  get module_name to str# // 'module_name' is most likely the name of the .flx file.
31802>>>>>  get TS_Module_Compile_Time str# to ts#
31803>>>>>  move (TS_ExtractTime(ts#)) to Dates$Module_Compile_Time
31804>>>>>  function_return (TS_ExtractDate(ts#))
31805>>>>>end_function
31806>>>>>
31806>>>>>function Module_Compile_Time global returns string
31807>>>>>  local date grb#
31808>>>>>  // Module_Compile_Date must be called before this one!
31808>>>>>  if Dates$Module_Compile_Time eq "" move (Module_Compile_Date()) to grb#
31811>>>>>  function_return Dates$Module_Compile_Time
31812>>>>>end_function
31813>>>>>
31813>>>>>date   Dates$ModuleStartDate
31813>>>>>string Dates$ModuleStartTime 8
31813>>>>>move (dSysDate()) to Dates$ModuleStartDate
31814>>>>>move (sSysTime()) to Dates$ModuleStartTime
31815>>>>>
31815>>>>>function Module_Start_Date global returns date
31816>>>>>  function_return Dates$ModuleStartDate
31817>>>>>end_function
31818>>>>>
31818>>>>>function Module_Start_Time global returns string
31819>>>>>  function_return Dates$ModuleStartTime
31820>>>>>end_function
31821>>>>>
31821>>>>> register_procedure NotifyPopupCalendarChange date date#
31821>>>>> register_procedure NotifyPopupCalendarSelect date date#
31821>>>>>  use dfAllent
31821>>>>>  class calendar.textbox is a textbox
31822>>>>>    procedure construct_object
31823>>>>>      forward send construct_object
31825>>>>>      Set Auto_Size_State To False
31826>>>>>      Set Justification_Mode To (jMode_vCenter+jMode_Center)
31827>>>>>    end_procedure
31828>>>>>  end_class
31829>>>>>
31829>>>>>  register_object btn1
31829>>>>>  register_object btn6
31829>>>>>
31829>>>>>  class calendar.button is a button
31830>>>>>
31830>>>>>    procedure construct_object
31831>>>>>      forward send construct_object
31833>>>>>      set size to 15 18
31834>>>>>      on_key kleftarrow   send prev_day
31835>>>>>      on_key krightarrow  send next_day
31836>>>>>      on_key kuparrow     send prev_week
31837>>>>>      on_key kdownarrow   send next_week
31838>>>>>      property date p_assigned_date public 0
31839>>>>>    end_procedure
31840>>>>>
31840>>>>>    procedure switch // This makes all 42 buttons act as if they are one focus
31841>>>>>      send activate to (btn1(current_object))
31842>>>>>    end_procedure
31843>>>>>    procedure switch_back
31844>>>>>      send activate to (btn6(current_object))
31845>>>>>    end_procedure
31846>>>>>
31846>>>>>    procedure mouse_down
31847>>>>>      local integer current_object#
31848>>>>>      forward send mouse_down
31850>>>>>      move current_object to current_object#
31851>>>>>      delegate set p_current_date to (p_assigned_date(current_object#))
31853>>>>>    end_procedure
31854>>>>>  end_class
31855>>>>>
31855>>>>>  desktop_section
31861>>>>>    object popup_calendar is a ModalPanel
31863>>>>>      set size to 160 250
31864>>>>>      property date    p_current_date  public 0
31866>>>>>      property integer p_current_year  public -1
31868>>>>>      property integer p_current_month public -1
31870>>>>>      property integer pExportState    public 1
31872>>>>>
31872>>>>>      on_key key_ctrl+key_pgup send prev_year
31873>>>>>      on_key key_ctrl+key_pgdn send next_year
31874>>>>>      on_key          key_pgup send prev_month
31875>>>>>      on_key          key_pgdn send next_month
31876>>>>>      on_key key_ctrl+key_d    send go_today
31877>>>>>      on_key kcancel           send cancel
31878>>>>>
31878>>>>>      object cont3d is a container3d
31880>>>>>        set location to 5 5
31881>>>>>        set size to 120 237
31882>>>>>        object textbox_year is a calendar.textbox
31884>>>>>          set location to 5 5
31885>>>>>          set size to 15 30
31886>>>>>          set border_style to border_staticedge
31887>>>>>          procedure display
31889>>>>>            set value to (p_current_year(current_object))
31890>>>>>          end_procedure
31891>>>>>        end_object
31892>>>>>        object dayname_header is a container3d
31894>>>>>          set location to 5 39
31895>>>>>          set size to 15 126
31896>>>>>          set border_style to border_staticedge
31897>>>>>          procedure initialize
31899>>>>>            local integer itm#
31900>>>>>            for itm# from 0 to 6
31906>>>>>>
31906>>>>>              object txt is a calendar.textbox
31908>>>>>                set size to 12 17
31909>>>>>                set location to 0 (itm#*17.6+1)
31910>>>>>                 set value to (left(DayName(itm#+1),3))
31911>>>>>              end_object
31912>>>>>            loop
31913>>>>>>
31913>>>>>          end_procedure
31914>>>>>          send initialize
31915>>>>>        end_object
31916>>>>>        object weeknumber_header is a container3d
31918>>>>>          set location to 24 5
31919>>>>>          set size     to 89 30
31920>>>>>          set border_style to border_staticedge
31921>>>>>          object obj_id_array is an array
31923>>>>>          end_object
31924>>>>>          procedure initialize
31926>>>>>            local integer itm# obj#
31927>>>>>            move (obj_id_array(current_object)) to obj#
31928>>>>>            for itm# from 0 to 5
31934>>>>>>
31934>>>>>              object txt is a textbox
31936>>>>>                set size to 15 30
31937>>>>>                set location to (itm#*15+1) 1
31938>>>>>                set value of obj# item (item_count(obj#)) to current_object
31939>>>>>              end_object
31940>>>>>            loop
31941>>>>>>
31941>>>>>          end_procedure
31942>>>>>          procedure display
31944>>>>>            local integer itm# obj#
31945>>>>>            local date date# last_date#
31945>>>>>            move (obj_id_array(current_object)) to obj#
31946>>>>>            get p_current_date to date#
31947>>>>>            move (FirstDayInMonth(date#)) to date#
31948>>>>>            move (LastDayInMonth(date#)) to last_date#
31949>>>>>            move (date#-DateDayNumber(date#)+1) to date#
31950>>>>>            for itm# from 0 to 5
31956>>>>>>
31956>>>>>              if (itm#*7+date#) le last_date# ;                set value of (integer(value(obj#,itm#))) to (t.calendar.week*string(DateWeekNumber(itm#*7+date#)))
31959>>>>>              else set value of (integer(value(obj#,itm#))) to ""
31961>>>>>            loop
31962>>>>>>
31962>>>>>          end_procedure
31963>>>>>          send initialize
31964>>>>>        end_object
31965>>>>>        object days_grid is a container3d
31967>>>>>          set location to 23 39
31968>>>>>          set size     to 100 127
31969>>>>>          set border_style to border_none
31970>>>>>          object btn_array is an array
31972>>>>>          end_object
31973>>>>>          procedure initialize
31975>>>>>            local integer row# col# button_array#
31976>>>>>            move (btn_array(current_object)) to button_array#
31977>>>>>            for row# from 0 to 5
31983>>>>>>
31983>>>>>              for col# from 0 to 6
31989>>>>>>
31989>>>>>                object btn is a calendar.button
31991>>>>>                  set location to (row#*15) (col#*18)
31992>>>>>                  set value of button_array# item (item_count(button_array#)) to current_object
31993>>>>>                  on_item "" send move_value_out_ok
31994>>>>>                end_object
31995>>>>>              loop
31996>>>>>>
31996>>>>>            loop
31997>>>>>>
31997>>>>>          end_procedure
31998>>>>>          send initialize
31999>>>>>
31999>>>>>          procedure display.iii integer itm# integer day# integer activate#
32001>>>>>            local integer obj# current_day#
32002>>>>>            move (integer(value(btn_array(current_object),itm#))) to obj#
32003>>>>>            move (DateSegment(p_current_date(current_object),DS_DAY)) to current_day#
32004>>>>>            if activate# begin
32006>>>>>              if day# eq current_day# send activate to obj#
32009>>>>>            end
32009>>>>>>
32009>>>>>            else begin
32010>>>>>              if day# begin
32012>>>>>                set value of obj# to day#
32013>>>>>                set visible_state of obj# to true
32014>>>>>                set p_assigned_date of obj# to (DateCompose(day#,p_current_month(current_object),p_current_year(current_object)))
32015>>>>>              end
32015>>>>>>
32015>>>>>              else set visible_state of obj# to false
32017>>>>>            end
32017>>>>>>
32017>>>>>          end_procedure
32018>>>>>
32018>>>>>          procedure display integer activate#
32020>>>>>            local integer first_item# last_item# itm# day# date#
32021>>>>>            get p_current_date to date#
32022>>>>>            move (FirstDayInMonth(date#)) to date#
32023>>>>>            move (DateDayNumber(date#)-1) to first_item#
32024>>>>>            move (LastDayInMonth(date#)-date#+first_item#) to last_item#
32025>>>>>            ifnot activate# begin
32027>>>>>              for itm# from 0 to (first_item#-1)
32033>>>>>>
32033>>>>>                send display.iii itm# 0 0
32034>>>>>              loop
32035>>>>>>
32035>>>>>            end
32035>>>>>>
32035>>>>>            move 1 to day#
32036>>>>>            for itm# from first_item# to last_item#
32042>>>>>>
32042>>>>>              send display.iii itm# day# activate#
32043>>>>>              increment day#
32044>>>>>            loop
32045>>>>>>
32045>>>>>            ifnot activate# begin
32047>>>>>              for itm# from (last_item#+1) to 41
32053>>>>>>
32053>>>>>                send display.iii itm# 0 0
32054>>>>>              loop
32055>>>>>>
32055>>>>>            end
32055>>>>>>
32055>>>>>          end_procedure
32056>>>>>        end_object
32057>>>>>        object txt_month is a calendar.textbox
32059>>>>>          set size to 12 27
32060>>>>>          set location to 25 185
32061>>>>>          set value to t.calendar.month
32062>>>>>        end_object
32063>>>>>        object btn1 is a button
32065>>>>>          set size to 12 12
32066>>>>>          set location to 40 185
32067>>>>>          on_item "" send prev_month
32068>>>>>          set bitmap to "prev.bmp"
32069>>>>>          procedure switch_back
32071>>>>>            send display_main
32072>>>>>          end_procedure
32073>>>>>        end_object
32074>>>>>        object btn2 is a button
32076>>>>>          set size to 12 12
32077>>>>>          set location to 40 200
32078>>>>>          on_item "" send next_month
32079>>>>>          set bitmap to "next.bmp"
32080>>>>>        end_object
32081>>>>>        object txt_year is a calendar.textbox
32083>>>>>          set size to 12 27
32084>>>>>          set location to 70 185
32085>>>>>          set value to t.calendar.year
32086>>>>>        end_object
32087>>>>>        object btn3 is a button
32089>>>>>          set size to 12 12
32090>>>>>          set location to 85 185
32091>>>>>          on_item "" send prev_year
32092>>>>>          set bitmap to "prev.bmp"
32093>>>>>        end_object
32094>>>>>        object btn4 is a button
32096>>>>>          set size to 12 12
32097>>>>>          set location to 85 200
32098>>>>>          on_item "" send next_year
32099>>>>>          set bitmap to "next.bmp"
32100>>>>>        end_object
32101>>>>>      end_object
32102>>>>>      object btn5 is a button
32104>>>>>        set size to 14 60
32105>>>>>        set location to 129 115
32106>>>>>        on_item t.calendar.ok send move_value_out_ok
32107>>>>>      end_object
32108>>>>>      object btn6 is a button
32110>>>>>        set size to 14 60
32111>>>>>        set location to 129 182
32112>>>>>        on_item t.calendar.cancel send cancel
32113>>>>>        procedure switch
32115>>>>>          send display_main
32116>>>>>        end_procedure
32117>>>>>      end_object
32118>>>>>      procedure next_year
32120>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32121>>>>>        send display_main
32122>>>>>      end_procedure
32123>>>>>      procedure prev_year
32125>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32126>>>>>        send display_main
32127>>>>>      end_procedure
32128>>>>>      procedure next_month
32130>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32131>>>>>        send display_main
32132>>>>>      end_procedure
32133>>>>>      procedure prev_month
32135>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32136>>>>>        send display_main
32137>>>>>      end_procedure
32138>>>>>      procedure next_week
32140>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,1))
32141>>>>>        send display_main
32142>>>>>      end_procedure
32143>>>>>      procedure prev_week
32145>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,-1))
32146>>>>>        send display_main
32147>>>>>      end_procedure
32148>>>>>      procedure next_day
32150>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,1))
32151>>>>>        send display_main
32152>>>>>      end_procedure
32153>>>>>      procedure prev_day
32155>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,-1))
32156>>>>>        send display_main
32157>>>>>      end_procedure
32158>>>>>      procedure go_today
32160>>>>>        local date date#
32161>>>>>        sysdate4 date#
32162>>>>>        set p_current_date to date#
32163>>>>>        send display_main
32164>>>>>      end_procedure
32165>>>>>      property integer invoking_object_id public 0
32167>>>>>      procedure OnChange date date#
32169>>>>>        local integer focus# dm#
32170>>>>>        get invoking_object_id to focus#
32171>>>>>        if focus# gt desktop begin
32173>>>>>          get delegation_mode of focus# to dm#
32174>>>>>          set delegation_mode of focus# to no_delegate_or_error
32175>>>>>          send NotifyPopupCalendarChange to focus# date#
32176>>>>>          set delegation_mode of focus# to dm#
32177>>>>>        end
32177>>>>>>
32177>>>>>      end_procedure
32178>>>>>      procedure display
32180>>>>>        local integer date# month# year#
32181>>>>>        get p_current_date to date#
32182>>>>>        send OnChange date#
32183>>>>>        move (DateSegment(date#,DS_YEAR)) to year#
32184>>>>>        move (DateSegment(date#,DS_MONTH)) to month#
32185>>>>>        if (p_current_year(current_object)<>year# or p_current_month(current_object)<>month#) begin
32187>>>>>          set p_current_year to year#
32188>>>>>          set p_current_month to month#
32189>>>>>          set value to (t.calendar.calendar_popup+", "+MonthName(month#))
32190>>>>>          send display to (textbox_year(cont3d(current_object)))
32191>>>>>          send display to (weeknumber_header(cont3d(current_object)))
32192>>>>>          send display to (days_grid(cont3d(current_object))) 0
32193>>>>>        end
32193>>>>>>
32193>>>>>      end_procedure
32194>>>>>      procedure display_main
32196>>>>>        send display
32197>>>>>        send display to (days_grid(cont3d(current_object))) 1
32198>>>>>      end_procedure
32199>>>>>      procedure popup_no_export
32201>>>>>        set pExportState to false
32202>>>>>        send popup
32203>>>>>        set pExportState to true
32204>>>>>      end_procedure
32205>>>>>
32205>>>>>      procedure popup_group
32207>>>>>        local integer focus#
32208>>>>>        local date date#
32208>>>>>        move (focus(desktop)) to focus#
32209>>>>>        set invoking_object_id to focus#
32210>>>>>        get value of focus# item current to date#
32211>>>>>        ifnot (integer(date#)) move (dSysdate()) to date#
32214>>>>>        move (Date2to4(date#)) to date#
32215>>>>>        set p_current_date to date#
32216>>>>>        send display
32217>>>>>        forward send popup_group
32219>>>>>        send display to (days_grid(cont3d(current_object))) 1
32220>>>>>      end_procedure
32221>>>>>
32221>>>>>      procedure move_value_out
32223>>>>>        local integer focus# dm# margin# datatype#
32224>>>>>        if (pExportState(current_object)) begin
32226>>>>>          get invoking_object_id to focus#
32227>>>>>          if focus# gt desktop begin
32229>>>>>            get delegation_mode of focus# to dm#
32230>>>>>            set delegation_mode of focus# to no_delegate_or_error
32231>>>>>            send NotifyPopupCalendarSelect to focus# (p_current_date(current_object))
32232>>>>>            get form_margin of focus# item current to margin#
32233>>>>>            get form_datatype of focus# item current to datatype#
32234>>>>>            set delegation_mode of focus# to dm#
32235>>>>>            if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to (p_current_date(current_object))
32238>>>>>            else             set value of focus# item current to (Date4to2(p_current_date(current_object)))
32240>>>>>            set item_changed_state of focus# item current to true
32241>>>>>          end
32241>>>>>>
32241>>>>>        end
32241>>>>>>
32241>>>>>      end_procedure
32242>>>>>
32242>>>>>      procedure move_value_out_ok
32244>>>>>        send move_value_out
32245>>>>>        send deactivate
32246>>>>>      end_procedure
32247>>>>>
32247>>>>>      procedure request_popup
32249>>>>>        local integer focus# type# dm#
32250>>>>>        move (focus(desktop)) to focus#
32251>>>>>        if focus# gt desktop begin
32253>>>>>          get delegation_mode of focus# to dm#
32254>>>>>          set delegation_mode of focus# to no_delegate_or_error
32255>>>>>          get form_datatype of focus# item current to type#
32256>>>>>          if (type#=date_window or type#=mask_date_window) send popup
32259>>>>>          set delegation_mode of focus# to dm#
32260>>>>>        end
32260>>>>>>
32260>>>>>      end_procedure
32261>>>>>    end_object
32262>>>>>  end_desktop_section
32264>>>>>  // If the procedure below was not defined "for BaseClass" its symbolic
32264>>>>>  // substitute would become negative (because located on the desktop). This
32264>>>>>  // would result in the toolbar object not being able to handle it. Therefore:
32264>>>>>  procedure request_popup_calendar for BaseClass
32265>>>>>    send request_popup to (popup_calendar(current_object))
32266>>>>>  end_procedure
32267>>>>>  procedure popup_calendar_no_export
32268>>>>>    send popup_no_export to (popup_calendar(current_object))
32269>>>>>  end_procedure
32270>>>>>  register_procedure Add_Toolbar_Button_Bitmap string bmp# string Tip# string StHlp# integer msg# integer obj#
32270>>>>>  procedure Add_Calendar_tbButton integer oTb#
32271>>>>>    send Add_Toolbar_Button_Bitmap to oTb# "DfCalend.bmp" t.calendar.calendar_popup t.calendar.Activate msg_request_popup_calendar
32272>>>>>  end_procedure
32273>>>>> function s.calendar returns integer // Backwards compatible!!
32274>>>>>   function_return (popup_calendar(current_object))
32275>>>>> end_function
32276>>>>>
32276>>>>>// Karl,
32276>>>>>// Structure is as follows,
32276>>>>>//
32276>>>>>// //put this code in the top portion of the view code or in the program
32276>>>>>// code.
32276>>>>>//
32276>>>>>// Type SystemTime
32276>>>>>//   field SystemTime.iYear As Word
32276>>>>>//   field SystemTime.iMonth As Word
32276>>>>>//   field SystemTime.iDayOfWeek As Word
32276>>>>>//   field SystemTime.iDay As Word
32276>>>>>//   field SystemTime.iHour As Word
32276>>>>>//   field SystemTime.iMinute As Word
32276>>>>>//   field SystemTime.iSecond As Word
32276>>>>>//   field SystemTime.iMilliseconds As Word
32276>>>>>// End_Type
32276>>>>>//
32276>>>>>// external_function GetSystemTime "GetSystemTime" kernel32.dll Pointer lpGST Returns VOID_TYPE
32276>>>>>//
32276>>>>>// //put this code in an onClick or wherever
32276>>>>>// procedure onclick
32276>>>>>//   local integer iRetVal
32276>>>>>//   local string TimeData
32276>>>>>//   local pointer GST
32276>>>>>//
32276>>>>>//   ZeroType SystemTime to TimeData
32276>>>>>//   getAddress from TimeData to GST
32276>>>>>//
32276>>>>>//   move (GetSystemTime(GST)) to iRetVal
32276>>>>>// end_procedure
32276>>>>>//
32276>>>>>// To extract the data from the Structure after calling the function use
32276>>>>>// the getbuff command as follows:
32276>>>>>//
32276>>>>>// getbuff from TimeData as SystemTime.IVAL to var
32276>>>>>//
32276>>>>>// where IVAL is one of the vars such as iYear or iDay, etc.
32276>>>>>//
32276>>>>>// OLIVER NELSON
32276>>>>>//
32276>>>>>//
32276>>>
32276>>>//AB-StoreTopEnd
32276>>>
32276>>>//AB-IgnoreStart
32276>>>
32276>>>Use DFAllEnt.pkg
32276>>>
32276>>>
32276>>>//AB-IgnoreEnd
32276>>>
32276>>>CD_Popup_Object oCalendar is a dbModalPanel
32295>>>
32295>>>    //AB-StoreTopStart
32295>>>    on_key kcancel           send cancel
32296>>>    //AB-StoreTopEnd
32296>>>
32296>>>    Set Border_Style to Border_Normal
32297>>>    Set Caption_Bar to FALSE
32298>>>    Set Label to "Ÿ­¢ àì, 2001"
32299>>>    Set Size to 98 123
32300>>>    Set Location to 10 22
32301>>>    Set Color to clWhite
32302>>>
32302>>>    //AB-DDOStart
32302>>>
32302>>>
32302>>>    //AB-DDOEnd
32302>>>
32302>>>    Object Container3d1 is a Container3d
32304>>>        Set Size to 88 135
32305>>>        Set Location to -2 -1
32306>>>        Set Color to clWhite
32307>>>        Set Border_Style to Border_None
32308>>>        Object Grid2 is a Grid
32310>>>
32310>>>            //AB-StoreTopStart
32310>>>            property date    p_current_date     public 0
32312>>>            property integer p_current_year     public -1
32314>>>            property integer p_current_month    public -1
32316>>>            property integer p_selected_day     public -1
32318>>>            property integer pExportState       public 1
32320>>>            property integer invoking_object_id public 0
32322>>>            
32322>>>            Set Border_Style To BORDER_NONE
32323>>>            Set header_visible_state To False
32324>>>            set select_mode to no_select
32325>>>            Set Gridline_mode To GRID_VISIBLE_NONE
32326>>>            
32326>>>            on_key Key_F1 Send Help
32327>>>            on_key key_ctrl+key_pgup send prev_year
32328>>>            on_key key_ctrl+key_pgdn send next_year
32329>>>            on_key          key_pgup send prev_month
32330>>>            on_key          key_pgdn send next_month
32331>>>            on_key key_enter         send move_value_out
32332>>>            on_key key_ctrl+key_d    send go_today
32333>>>            
32333>>>            //AB-StoreTopEnd
32333>>>
32333>>>            Set Color to clWhite
32334>>>            Set CurrentCellColor to clWhite
32335>>>            Set CurrentCellTextColor to clWhite
32336>>>            Set Size to 61 145
32337>>>            Set Location to 30 1
32338>>>            Set Resize_Column_state to FALSE
32339>>>
32339>>>            Set Line_Width to 7 0
32340>>>
32340>>>            Set Form_Width    item 0 to 18
32341>>>            Set Header_Label  item 0 to "­"
32342>>>            
32342>>>            Set Form_Width    item 1 to 18
32343>>>            Set Header_Label  item 1 to "‚â"
32344>>>            
32344>>>            Set Form_Width    item 2 to 18
32345>>>            Set Header_Label  item 2 to "‘à"
32346>>>            
32346>>>            Set Form_Width    item 3 to 18
32347>>>            Set Header_Label  item 3 to "—â"
32348>>>            
32348>>>            Set Form_Width    item 4 to 18
32349>>>            Set Header_Label  item 4 to "â"
32350>>>            
32350>>>            Set Form_Width    item 5 to 18
32351>>>            Set Header_Label  item 5 to "‘¡"
32352>>>            
32352>>>            Set Form_Width    item 6 to 18
32353>>>            Set Header_Label  item 6 to "‚á"
32354>>>            
32354>>>
32354>>>            //AB-StoreStart
32354>>>            
32354>>>            procedure go_today
32356>>>                Date date#
32357>>>                sysdate4 date#
32358>>>                set p_current_date to date#
32359>>>                Send Update_Calendar
32360>>>            end_procedure
32361>>>            
32361>>>            procedure next_month
32363>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32364>>>                Send Update_Calendar
32365>>>            end_procedure
32366>>>            
32366>>>            procedure prev_month
32368>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32369>>>                Send Update_Calendar
32370>>>            end_procedure
32371>>>            
32371>>>            procedure next_year
32373>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32374>>>                Send Update_Calendar
32375>>>            end_procedure
32376>>>            
32376>>>            procedure prev_year
32378>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32379>>>                Send Update_Calendar
32380>>>            end_procedure
32381>>>            
32381>>>            Procedure Activate
32383>>>                Date date#
32384>>>                Forward Send Activate
32386>>>                Set current_item to (p_selected_day(Self))
32387>>>            End_Procedure
32388>>>            
32388>>>            Procedure Update_Calendar
32390>>>                Set Dynamic_Update_State To False
32391>>>                send Fill_List
32392>>>                Set Dynamic_Update_State To True
32393>>>                // Send Update_Label
32393>>>                Set current_item to (p_selected_day(Self))
32394>>>                Send Date_Changing to (oYear(Container3d2(self)))
32395>>>                Send Date_Changing to (oMonth(Container3d2(self)))
32396>>>            End_Procedure
32397>>>            
32397>>>            Procedure Fill_List
32399>>>                Integer iFor prevdate# date# first_item# last_item# day# prev_last# nextdate# next_first#
32400>>>                Integer cur_year# cur_month# cur_day# sel_month# sel_day# sel_year#
32400>>>                Date dToday
32400>>>                Send Delete_Data
32401>>>            
32401>>>                Get p_current_date to date#
32402>>>            
32402>>>                SysDate4 dToday
32403>>>                move (DateSegment(dToday,DS_DAY)) to cur_day#
32404>>>                move (DateSegment(dToday,DS_MONTH)) to cur_month#
32405>>>                move (DateSegment(dToday,DS_YEAR)) to cur_year#
32406>>>            
32406>>>                move (DateSegment(date#,DS_DAY)) to sel_day#
32407>>>                move (DateSegment(date#,DS_MONTH)) to sel_month#
32408>>>                move (DateSegment(date#,DS_YEAR)) to sel_year#
32409>>>                Set p_current_month To sel_month#
32410>>>                Set p_current_year To sel_year#
32411>>>            
32411>>>                move (FirstDayInMonth(date#)) to date#
32412>>>                move (DateDayNumber(date#)-1) to first_item#
32413>>>                move (LastDayInMonth(date#)-date#+first_item#) to last_item#
32414>>>                move (DateIncrement(date#,DS_Month,-1)) To prevdate#
32415>>>                move (DateSegment((LastDayInMonth(prevdate#)),DS_DAY)) to prev_last#
32416>>>            
32416>>>                If (first_item# > 0) Begin
32418>>>                    Move (first_item#-1) to day#
32419>>>                    For iFor from 0 to (first_item#-1)
32425>>>>
32425>>>                        Send Add_Item msg_move_value_out (prev_last#-day#)
32426>>>                        Set Entry_State Item iFor To False
32427>>>                        Set ItemTextColor Item iFor To clGray
32428>>>                        Decrement day#
32429>>>                    Loop
32430>>>>
32430>>>                End
32430>>>>
32430>>>            
32430>>>                Move 1 To day#
32431>>>                For iFor from first_item# to last_item#
32437>>>>
32437>>>                    Send Add_Item Msg_Move_Value_Out day#
32438>>>                    Set Entry_State Item iFor To False
32439>>>                    If ((cur_month# eq sel_month#)and(cur_year# eq sel_year#)and(Day# eq cur_day#)) Set Form_Bitmap Item iFor To "cdate.bmp"
32442>>>                    If Day# eq sel_day# Set p_selected_day To iFor
32445>>>                    Set Form_justification_mode Item iFor To FORM_DISPLAYRIGHT
32446>>>                    Set form_datatype item iFor To mask_numeric_window
32447>>>                    Set form_Mask item iFor To "## "
32448>>>                    Increment day#
32449>>>                Loop
32450>>>>
32450>>>            
32450>>>                move (DateIncrement(date#,DS_Month,1)) To nextdate#
32451>>>                move (DateSegment((LastDayInMonth(nextdate#)),DS_DAY)) to next_first#
32452>>>            
32452>>>                If (last_item# < 41) Begin
32454>>>                    Move 1 to day#
32455>>>                    For iFor from (last_item#+1) to 41
32461>>>>
32461>>>                        Send Add_Item msg_move_value_out day#
32462>>>                        Set Entry_State Item iFor To False
32463>>>                        Set ItemTextColor Item iFor To clGray
32464>>>                        Increment day#
32465>>>                    Loop
32466>>>>
32466>>>                End
32466>>>>
32466>>>            
32466>>>            End_Procedure
32467>>>            
32467>>>            Procedure Help
32469>>>                Send Info_Box ("<Up>, <Dn>, <Lft>, <Rgt> - select date.\n<PgUp>, <PgDn> - select month.\n<Ctrl>+<D> - set current date.\n<Ctrl>+<PgUp>, <PgDn> - Select year.\n\n(c) 2001, SCR. Special thanks to Sture Andersen.") ("Help on Calendar")
32470>>>            End_Procedure
32471>>>            
32471>>>            procedure mouse_click integer window integer char_pos
32473>>>                Send Move_Value_Out
32474>>>                forward send mouse_click window char_pos
32476>>>            end_procedure
32477>>>            
32477>>>            Procedure Move_Value_Out
32479>>>                Integer iYear iMonth iDay iItm
32480>>>                Date Date# next_date# prev_date#
32480>>>                Get Current_Item To iItm
32481>>>                If (pExportState(Self)) Begin
32483>>>                    Get Value Item iItm To iDay
32484>>>                    Get p_current_month to iMonth
32485>>>                    Get p_current_year  to iYear
32486>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32487>>>            
32487>>>                    If ((iItm>27)and(iDay<15)) Begin
32489>>>                        Move (DateCompose(1,iMonth,iYear)) To next_date#
32490>>>                        move (DateIncrement(next_date#,DS_Month,1)) To next_date#
32491>>>                        move (DateSegment(next_date#,DS_MONTH)) to iMonth
32492>>>                        move (DateSegment(next_date#,DS_YEAR)) to iYear
32493>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32494>>>                    End
32494>>>>
32494>>>                    If ((iItm<7)and(iDay>20)) Begin
32496>>>                        Move (DateCompose(1,iMonth,iYear)) To prev_date#
32497>>>                        move (DateIncrement(prev_date#,DS_Month,-1)) To prev_date#
32498>>>                        move (DateSegment(prev_date#,DS_MONTH)) to iMonth
32499>>>                        move (DateSegment(prev_date#,DS_YEAR)) to iYear
32500>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32501>>>                    End
32501>>>>
32501>>>            
32501>>>                    Send Export_Date date#
32502>>>                End
32502>>>>
32502>>>            End_Procedure
32503>>>            
32503>>>            Procedure Export_Date date date#
32505>>>                local integer focus# dm# margin# datatype#
32506>>>                get invoking_object_id to focus#
32507>>>            
32507>>>                if focus# gt desktop begin
32509>>>                     get delegation_mode of focus# to dm#
32510>>>                     set delegation_mode of focus# to no_delegate_or_error
32511>>>                     get form_margin of focus# item current to margin#
32512>>>                     get form_datatype of focus# item current to datatype#
32513>>>                     set delegation_mode of focus# to dm#
32514>>>                     if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to date#
32517>>>                     else             set value of focus# item current to (Date4to2(date#))
32519>>>                     set item_changed_state of focus# item current to true
32520>>>                end
32520>>>>
32520>>>                Send Close_Calendar
32521>>>            End_Procedure
32522>>>            //AB-StoreEnd
32522>>>
32522>>>        End_Object    // Grid2
32523>>>
32523>>>        Object Textbox2 is a Textbox
32525>>>            Set Label to "­"
32526>>>            Set Auto_Size_State to FALSE
32527>>>            Set Transparent_State to TRUE
32528>>>            Set Color to clWhite
32529>>>            Set TextColor to clNavy
32530>>>            Set Location to 19 4
32531>>>            Set Size to 10 15
32532>>>
32532>>>            //AB-StoreStart
32532>>>                                        
32532>>>            Set Label To (left(t.calendar.Monday,2))
32533>>>            //AB-StoreEnd
32533>>>
32533>>>        End_Object    // Textbox2
32534>>>
32534>>>        Object Textbox3 is a Textbox
32536>>>            Set Label to "‚â"
32537>>>            Set Auto_Size_State to FALSE
32538>>>            Set Transparent_State to TRUE
32539>>>            Set Color to clWhite
32540>>>            Set TextColor to clNavy
32541>>>            Set Location to 19 22
32542>>>            Set Size to 10 12
32543>>>
32543>>>            //AB-StoreStart
32543>>>                                        
32543>>>            Set Label To (left(t.calendar.Tuesday,2))
32544>>>            //AB-StoreEnd
32544>>>
32544>>>        End_Object    // Textbox3
32545>>>
32545>>>        Object Textbox4 is a Textbox
32547>>>            Set Label to "‘à"
32548>>>            Set Auto_Size_State to FALSE
32549>>>            Set Transparent_State to TRUE
32550>>>            Set Color to clWhite
32551>>>            Set TextColor to clNavy
32552>>>            Set Location to 19 39
32553>>>            Set Size to 10 15
32554>>>
32554>>>            //AB-StoreStart
32554>>>                                        
32554>>>            Set Label To (left(t.calendar.Wednesday,2))
32555>>>            //AB-StoreEnd
32555>>>
32555>>>        End_Object    // Textbox4
32556>>>
32556>>>        Object Textbox5 is a Textbox
32558>>>            Set Label to "—â"
32559>>>            Set Auto_Size_State to FALSE
32560>>>            Set Transparent_State to TRUE
32561>>>            Set Color to clWhite
32562>>>            Set TextColor to clNavy
32563>>>            Set Location to 19 57
32564>>>            Set Size to 10 17
32565>>>
32565>>>            //AB-StoreStart
32565>>>                                        
32565>>>            Set Label To (left(t.calendar.Thursday,2))
32566>>>            //AB-StoreEnd
32566>>>
32566>>>        End_Object    // Textbox5
32567>>>
32567>>>        Object Textbox6 is a Textbox
32569>>>            Set Label to "â"
32570>>>            Set Auto_Size_State to FALSE
32571>>>            Set Transparent_State to TRUE
32572>>>            Set Color to clWhite
32573>>>            Set TextColor to clNavy
32574>>>            Set Location to 19 76
32575>>>            Set Size to 10 17
32576>>>
32576>>>            //AB-StoreStart
32576>>>                                        
32576>>>            Set Label To (left(t.calendar.Friday,2))
32577>>>            //AB-StoreEnd
32577>>>
32577>>>        End_Object    // Textbox6
32578>>>
32578>>>        Object Textbox7 is a Textbox
32580>>>            Set Label to "‘¡"
32581>>>            Set Auto_Size_State to FALSE
32582>>>            Set Transparent_State to TRUE
32583>>>            Set Color to clWhite
32584>>>            Set TextColor to clNavy
32585>>>            Set Location to 19 91
32586>>>            Set Size to 10 18
32587>>>
32587>>>            //AB-StoreStart
32587>>>                                        
32587>>>            Set Label To (left(t.calendar.Saturday,2))
32588>>>            //AB-StoreEnd
32588>>>
32588>>>        End_Object    // Textbox7
32589>>>
32589>>>        Object Textbox8 is a Textbox
32591>>>            Set Label to "‚á"
32592>>>            Set Auto_Size_State to FALSE
32593>>>            Set Transparent_State to TRUE
32594>>>            Set Color to clWhite
32595>>>            Set TextColor to clNavy
32596>>>            Set Location to 19 109
32597>>>            Set Size to 10 17
32598>>>
32598>>>            //AB-StoreStart
32598>>>                                        
32598>>>            Set Label To (left(t.calendar.Sunday,2))
32599>>>            //AB-StoreEnd
32599>>>
32599>>>        End_Object    // Textbox8
32600>>>
32600>>>        Object LineControl1 is a LineControl
32602>>>            Set Line_Style to lnSINGLE
32603>>>            Set Size to 1 116
32604>>>            Set Location to 28 4
32605>>>
32605>>>            //AB-StoreStart
32605>>>                                        
32605>>>            //AB-StoreEnd
32605>>>
32605>>>        End_Object    // LineControl1
32606>>>
32606>>>        Object Container3d2 is a Container3d
32608>>>            Set Size to 18 131
32609>>>            Set Location to 1 1
32610>>>            Set Color to clNavy
32611>>>            Set Border_Style to Border_None
32612>>>            Object oRght is a BitmapContainer
32614>>>                Set Size to 10 14
32615>>>                Set Location to 4 105
32616>>>                Set Bitmap to "rght.bmp"
32617>>>                Set Border_Style to Border_None
32618>>>
32618>>>                //AB-StoreStart
32618>>>                Procedure Mouse_Down
32620>>>                    Send Next_Month to Grid2
32621>>>                End_Procedure
32622>>>                //AB-StoreEnd
32622>>>
32622>>>            End_Object    // oRght
32623>>>
32623>>>            Object oLeft is a BitmapContainer
32625>>>                Set Size to 10 14
32626>>>                Set Location to 4 3
32627>>>                Set Bitmap to "lft.bmp"
32628>>>                Set Border_Style to Border_None
32629>>>
32629>>>                //AB-StoreStart
32629>>>                Procedure Mouse_Down
32631>>>                    Send Prev_Month to Grid2
32632>>>                End_Procedure
32633>>>                //AB-StoreEnd
32633>>>
32633>>>            End_Object    // oLeft
32634>>>
32634>>>            Object oMonth is a Textbox
32636>>>
32636>>>                //AB-StoreTopStart
32636>>>                Property integer piSelected_Month public 0
32638>>>                //AB-StoreTopEnd
32638>>>
32638>>>                Set Label to "January"
32639>>>                Set Auto_Size_State to FALSE
32640>>>                Set Transparent_State to TRUE
32641>>>                Set Color to clWhite
32642>>>                Set TextColor to clWhite
32643>>>                Set Location to 4 23
32644>>>                Set Size to 10 43
32645>>>                Set FontWeight to 800
32646>>>                Set Justification_Mode to jMode_Center
32647>>>
32647>>>                //AB-StoreStart
32647>>>                                    
32647>>>                Procedure Mouse_Down
32649>>>                    Integer iState
32650>>>                    Get Visible_State of oSelectYear to iState
32651>>>                    If (iState) Send OnKillFocus to oSelectYear
32654>>>                    Send Popup to oSelectMonth
32655>>>                End_Procedure
32656>>>                
32656>>>                Procedure pSelectJan
32658>>>                    Set Label to t.calendar.january
32659>>>                    Set piSelected_Month to 1
32660>>>                    Send Adjust_Calendar
32661>>>                End_Procedure
32662>>>                Procedure pSelectFeb
32664>>>                    Set Label to t.calendar.february
32665>>>                    Set piSelected_Month to 2
32666>>>                    Send Adjust_Calendar
32667>>>                End_Procedure
32668>>>                Procedure pSelectMar
32670>>>                    Set Label to t.calendar.march
32671>>>                    Set piSelected_Month to 3
32672>>>                    Send Adjust_Calendar
32673>>>                End_Procedure
32674>>>                Procedure pSelectApr
32676>>>                    Set Label to t.calendar.april
32677>>>                    Set piSelected_Month to 4
32678>>>                    Send Adjust_Calendar
32679>>>                End_Procedure
32680>>>                Procedure pSelectMay
32682>>>                    Set Label to t.calendar.may
32683>>>                    Set piSelected_Month to 5
32684>>>                    Send Adjust_Calendar
32685>>>                End_Procedure
32686>>>                Procedure pSelectJun
32688>>>                    Set Label to t.calendar.june
32689>>>                    Set piSelected_Month to 6
32690>>>                    Send Adjust_Calendar
32691>>>                End_Procedure
32692>>>                Procedure pSelectJul
32694>>>                    Set Label to t.calendar.july
32695>>>                    Set piSelected_Month to 7
32696>>>                    Send Adjust_Calendar
32697>>>                End_Procedure
32698>>>                Procedure pSelectAug
32700>>>                    Set Label to t.calendar.august
32701>>>                    Set piSelected_Month to 8
32702>>>                    Send Adjust_Calendar
32703>>>                End_Procedure
32704>>>                Procedure pSelectSep
32706>>>                    Set Label to t.calendar.september
32707>>>                    Set piSelected_Month to 9
32708>>>                    Send Adjust_Calendar
32709>>>                End_Procedure
32710>>>                Procedure pSelectOct
32712>>>                    Set Label to t.calendar.october
32713>>>                    Set piSelected_Month to 10
32714>>>                    Send Adjust_Calendar
32715>>>                End_Procedure
32716>>>                Procedure pSelectNov
32718>>>                    Set Label to t.calendar.november
32719>>>                    Set piSelected_Month to 11
32720>>>                    Send Adjust_Calendar
32721>>>                End_Procedure
32722>>>                Procedure pSelectDec
32724>>>                    Set Label to t.calendar.december
32725>>>                    Set piSelected_Month to 12
32726>>>                    Send Adjust_Calendar
32727>>>                End_Procedure
32728>>>                
32728>>>                Object oSelectMonth is a FloatingPopupMenu
32730>>>                    Send Add_Item msg_pSelectJan t.calendar.january
32731>>>                    Send Add_Item msg_pSelectFeb t.calendar.february
32732>>>                    Send Add_Item msg_pSelectMar t.calendar.march
32733>>>                    Send Add_Item msg_pSelectApr t.calendar.april
32734>>>                    Send Add_Item msg_pSelectMay t.calendar.may
32735>>>                    Send Add_Item msg_pSelectJun t.calendar.june
32736>>>                    Send Add_Item msg_pSelectJul t.calendar.july
32737>>>                    Send Add_Item msg_pSelectAug t.calendar.august
32738>>>                    Send Add_Item msg_pSelectSep t.calendar.september
32739>>>                    Send Add_Item msg_pSelectOct t.calendar.october
32740>>>                    Send Add_Item msg_pSelectNov t.calendar.november
32741>>>                    Send Add_Item msg_pSelectDec t.calendar.december
32742>>>                End_Object
32743>>>                
32743>>>                Procedure Adjust_Calendar
32745>>>                    Date date#
32746>>>                    Integer iDay iMonth iYear iItm
32746>>>                    Set Visible_State to false
32747>>>                    Set Visible_State to true
32748>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
32749>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
32750>>>                    Get piSelected_Month to iMonth
32751>>>                    Get Label of oYear to iYear
32752>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32753>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
32754>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
32755>>>                End_Procedure
32756>>>                
32756>>>                Procedure Activating
32758>>>                    Forward Send Activating
32760>>>                    Send Date_Changing
32761>>>                End_Procedure
32762>>>                
32762>>>                Procedure Date_Changing
32764>>>                    Set Visible_State to false
32765>>>                    Set Label to (MonthName(p_current_Month(Grid2(Container3D1(Self)))))
32766>>>                    Set piSelected_Month to (p_current_Month(Grid2(Container3D1(Self))))
32767>>>                    Set Visible_State to true
32768>>>                End_Procedure
32769>>>                
32769>>>                
32769>>>                //AB-StoreEnd
32769>>>
32769>>>            End_Object    // oMonth
32770>>>
32770>>>            Object oYear is a Textbox
32772>>>                Set Label to "2001"
32773>>>                Set Transparent_State to TRUE
32774>>>                Set Color to clWhite
32775>>>                Set TextColor to clWhite
32776>>>                Set Location to 4 77
32777>>>                Set Size to 10 18
32778>>>                Set FontWeight to 800
32779>>>
32779>>>                //AB-StoreStart
32779>>>                                                    
32779>>>                Procedure Mouse_Down
32781>>>                    String sVal
32782>>>                    Get Label to sVal
32783>>>                    Set Value of oSelectYear item 0 to sVal
32784>>>                    Set Visible_State of oSelectYear to True
32785>>>                    Send Activate to (oSelectYear(Self))
32786>>>                End_Procedure
32787>>>                
32787>>>                Procedure Activating
32789>>>                    Forward Send Activating
32791>>>                    Send Date_Changing
32792>>>                End_Procedure
32793>>>                
32793>>>                Procedure Date_Changing
32795>>>                    Set Visible_State to false
32796>>>                    Set Label to (String(p_current_Year(Grid2(Container3D1(Self)))))
32797>>>                    Set Visible_State to true
32798>>>                End_Procedure
32799>>>                //AB-StoreEnd
32799>>>
32799>>>            End_Object    // oYear
32800>>>
32800>>>            Object oSelectYear is a Form
32802>>>
32802>>>                //AB-StoreTopStart
32802>>>                Set Visible_State To False
32803>>>                //AB-StoreTopEnd
32803>>>
32803>>>                Set Size to 10 24
32804>>>                Set Location to 4 75
32805>>>                Set Color to clWhite
32806>>>                Set TextColor to clNavy
32807>>>                Set Form_Border Item 0 to Border_Normal
32808>>>
32808>>>                //AB-StoreStart
32808>>>                                                    
32808>>>                On_Key Key_Enter Send OnKillFocus
32809>>>                On_Key Key_Escape Send OnKillFocus
32810>>>                
32810>>>                Procedure SetFontWeight
32812>>>                    Set Form_FontWeight item 0 to 800
32813>>>                End_Procedure
32814>>>                
32814>>>                Procedure OnKillFocus
32816>>>                    String sVal
32817>>>                    Integer iMonth iDay iYear iItm
32817>>>                    Date date#
32817>>>                    Get Value item 0 to sVal
32818>>>                    Set Visible_State of oYear to false
32819>>>                    Set Label of oYear to sVal
32820>>>                    Set Visible_State of oYear to true
32821>>>                    Set Visible_State to false
32822>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
32823>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
32824>>>                    Get piSelected_Month of oMonth to iMonth
32825>>>                    Get Value item 0 to iYear
32826>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32827>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
32828>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
32829>>>                End_Procedure
32830>>>                
32830>>>                Send SetFontWeight
32831>>>                //AB-StoreEnd
32831>>>
32831>>>            End_Object    // oSelectYear
32832>>>
32832>>>
32832>>>            //AB-StoreStart
32832>>>                            
32832>>>            Procedure Mouse_Down
32834>>>                Integer iState
32835>>>                Get Visible_State of oSelectYear to iState
32836>>>                If (iState) Send OnKillFocus to oSelectYear
32839>>>            End_Procedure
32840>>>            
32840>>>            //AB-StoreEnd
32840>>>
32840>>>        End_Object    // Container3d2
32841>>>
32841>>>
32841>>>        //AB-StoreStart
32841>>>                            
32841>>>        //AB-StoreEnd
32841>>>
32841>>>    End_Object    // Container3d1
32842>>>
32842>>>    Object BitmapContainer3 is a BitmapContainer
32844>>>        Set Size to 9 19
32845>>>        Set Location to 88 3
32846>>>        Set Color to clWhite
32847>>>        Set Bitmap to "cdate.bmp"
32848>>>        Set Border_Style to Border_None
32849>>>
32849>>>        //AB-StoreStart
32849>>>        Procedure Mouse_Down
32851>>>            Send go_today to (Grid2(Container3d1(Self)))
32852>>>            Send Adjust_Label to oToday
32853>>>        End_Procedure
32854>>>        //AB-StoreEnd
32854>>>
32854>>>    End_Object    // BitmapContainer3
32855>>>
32855>>>    Object oToday is a Textbox
32857>>>        Set Label to "Today: 01.01.2001"
32858>>>        Set Auto_Size_State to FALSE
32859>>>        Set Color to clWhite
32860>>>        Set Location to 88 22
32861>>>        Set Size to 8 73
32862>>>        Set FontWeight to 800
32863>>>
32863>>>        //AB-StoreStart
32863>>>        Procedure Mouse_Down
32865>>>            Send go_today to (Grid2(Container3d1(Self)))
32866>>>            Send Adjust_Label
32867>>>        End_Procedure
32868>>>        
32868>>>        Procedure Adjust_Label
32870>>>            date date#
32871>>>            SysDate4 date#
32872>>>            Set Visible_State To false
32873>>>            Set Label         to (t.calendar.today+": "+String(date#))
32874>>>            Set Visible_State To true
32875>>>        End_Procedure
32876>>>        
32876>>>        Procedure Activating
32878>>>            Forward Send Activating
32880>>>            Send Adjust_Label
32881>>>        End_Procedure
32882>>>        //AB-StoreEnd
32882>>>
32882>>>    End_Object    // oToday
32883>>>
32883>>>
32883>>>    //AB-StoreStart
32883>>>                
32883>>>    procedure popup
32885>>>        local integer focus# icItm iYear iMonth
32886>>>        local date date#
32886>>>        move (focus(desktop)) to focus#
32887>>>        set invoking_object_id of (Grid2(Container3d1(self))) to focus#
32888>>>        get value of focus# item current to date#
32889>>>        ifnot (integer(date#)) sysdate date#
32892>>>        move (Date2to4(date#)) to date#
32893>>>        set p_current_date of (Grid2(Container3d1(self))) to date#
32894>>>        send fill_list to (Grid2(Container3d1(self)))
32895>>>        move (DateSegment(date#,DS_YEAR)) to iYear
32896>>>        move (DateSegment(date#,DS_MONTH)) to iMonth
32897>>>        Set Label To (MonthName(iMonth)+', '+String(iYear))
32898>>>        forward send popup
32900>>>    end_procedure
32901>>>    
32901>>>    Procedure Close_Calendar
32903>>>        Send Exit
32904>>>    End_Procedure
32905>>>    //AB-StoreEnd
32905>>>
32905>>>CD_End_Object    // oCalendar
32907>>>>
32907>>>
32907>>>
32907>>>//AB-StoreStart
32907>>>    
32907>>>    
32907>>>//AB-StoreEnd
32907>>>
32907>>>//AB/ End_Object    // prj
32907>Use Dates.Utl
32907>use roundfn.fnc
INCLUDING FILE: ROUNDFN.FNC
32907>>>// ===========================================================================
32907>>>//
32907>>>// The ROUND_NUMBER global function has been designed to return the rounded
32907>>>// value of a given 'numeric' argument at a specified rounding precision.
32907>>>//
32907>>>// ---------------------------------------------------------------------------
32907>>>// This version dispenses with the use of powers (10 ^ n) to perform the
32907>>>// necessary calculations.  It uses a string handling technique instead.
32907>>>// ---------------------------------------------------------------------------
32907>>>//
32907>>>// The function requires two arguments, as follows:-
32907>>>//
32907>>>// (a) The numeric value to be rounded, where the range of valid values is
32907>>>//     +/- 99,999,999,999,999.99999999.
32907>>>//
32907>>>// (b) The rounding precision required.  This must be an integer value in the
32907>>>//     range -13 to +8.  If a value outside this range is used, the nearest
32907>>>//     threshold value is substituted.
32907>>>//
32907>>>//     Values in the range +1 to +7 perform rounding on the decimal part of
32907>>>//     the number.  A value of +8 will perform no rounding at all.  A zero
32907>>>//     value will round to the nearest whole number.  Values -1 to -13 will
32907>>>//     round progressively to the left of the decimal point (a frequent
32907>>>//     requirement in financial reporting).
32907>>>//
32907>>>// If the result of the rounding produces a value outside the valid numeric
32907>>>// range (+/- 99,999,999,999,999.99999999) then a zero value is returned.
32907>>>//
32907>>>// Assumptions:-  The only assumptions made have been that the range of
32907>>>// numeric values and the limit of eight decimal places are unlikely to change
32907>>>// in the forseeable future.
32907>>>//
32907>>>// Examples:-
32907>>>//
32907>>>//  1st Argument      2nd Argument   Return Value
32907>>>//  ------------      ------------   ------------
32907>>>//  123456.87654321         8         123456.87654321
32907>>>//  123456.87654321         2         123456.88
32907>>>// -123456.87654321         2        -123456.88
32907>>>//  123456.98765432         0         123457
32907>>>// -123456.98765432        -1        -123460
32907>>>//  123456.98765432        -2         123500
32907>>>//  123456.98765432        -3         123000
32907>>>//  987654                 -4         990000
32907>>>//  987654                 -5        1000000
32907>>>//  987654                 -6        1000000
32907>>>//  987654                 -7              0
32907>>>//
32907>>>// ===========================================================================
32907>>>
32907>>>
32907>>>Function Round_Number GLOBAL number nVal integer iRnd returns Number
32908>>>
32908>>>  Local Number nAdj
32909>>>
32909>>>  Move 10000000000000 to nAdj
32910>>>
32910>>>  // If the rounding precision falls in the range 0 to 8, then return:-
32910>>>
32910>>>  If (iRnd >= 0) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 / (Number(Left(nAdj, ((iRnd + 1) ;      min 9)))) + nVal / (Number(Left(nAdj, (9 - (iRnd min 8))))) ;        * (Number(Left(nAdj, (9 - (iRnd min 8))))))
32913>>>
32913>>>  // Else, where the rounding precision is in the range -1 to -5, return:-
32913>>>
32913>>>  If (iRnd >= -5) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(Left(nAdj, (Abs(iRnd) + 9)))) ;        * (Number(Left(nAdj, (Abs(iRnd) + 9)))))
32916>>>
32916>>>  // Else, where the rounding precision is in the range -6 to -13, return:-
32916>>>
32916>>>  Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(nAdj)) / (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))) ;        * (Number(nAdj)) * (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))))
32917>>>
32917>>>End_Function
32918>use checkafm.pkg
INCLUDING FILE: CHECKAFM.PKG
32918>>>
32918>>>
32918>>>Function Check_Afm Global String Afm_Num Returns Integer
32919>>>    Integer iii Num1 Num2
32920>>>
32920>>>    Move (Trim(Afm_Num)) To Afm_Num
32921>>>    Move (Right(Afm_Num,1)) to Num2
32922>>>
32922>>>    If (Length(Afm_Num)<>9) Function_Return 2
32925>>>
32925>>>    For iii From 1 To (Length(Trim(Afm_Num)))
32931>>>>
32931>>>        If Not (Mid(Afm_Num,1,iii)) In  "0123456789" Function_Return 3
32934>>>    Loop
32935>>>>
32935>>>
32935>>>    Move 0 to Num1
32936>>>
32936>>>    For iii From 1 to 8
32942>>>>
32942>>>        Add ((Mid(Afm_Num,1,iii)) * (2 ^ (9 - iii))) to Num1
32943>>>    Loop
32944>>>>
32944>>>
32944>>>    Move (Mod(Num1,11)) to Num1
32945>>>    If (Num1=10) Move 0 to Num1
32948>>>
32948>>>    If (Num1=Num2)  Function_Return 0
32951>>>    Else            Function_Return 1
32953>>>End_Function
32954>>>
32954>use checklog.pkg
INCLUDING FILE: CHECKLOG.PKG
32954>>>open syscurgl
INCLUDING FILE: SYSCURGL.FD
32956>>>open syscurxr
32958>>>open gplan
INCLUDING FILE: GPLAN.FD
32960>>>open iteml
INCLUDING FILE: ITEML.FD
32962>>>open cn
INCLUDING FILE: CN.FD
32964>>>open payresp
INCLUDING FILE: PAYRESP.FD
32966>>>open salesmen
INCLUDING FILE: SALESMEN.FD
32968>>>open mhxanik
INCLUDING FILE: MHXANIK.FD
32970>>>open constrct
INCLUDING FILE: CONSTRCT.FD
32972>>>open clients
INCLUDING FILE: CLIENTS.FD
32974>>>open wtypkin
INCLUDING FILE: WTYPKIN.FD
32976>>>open wax
INCLUDING FILE: WAX.FD
32978>>>Function Check_log Global String slog Returns Integer
32979>>>    clear gplan
32980>>>    move syscurxr.company_code to gplan.company_code
32981>>>    move syscurxr.branch_code  to gplan.branch_code
32982>>>    move syscurxr.year_year    to gplan.year_year
32983>>>    move slog                  to gplan.gplan_code
32984>>>    find eq gplan by index.1
32985>>>>
32985>>>    if (found=1) function_return 0
32988>>>    else         function_return 1
32990>>>
32990>>>End_Function
32991>>>
32991>>>Function Check_last Global String slog Returns Integer
32992>>>    clear gplan
32993>>>    move syscurxr.company_code to gplan.company_code
32994>>>    move syscurxr.branch_code  to gplan.branch_code
32995>>>    move syscurxr.year_year    to gplan.year_year
32996>>>    move slog                  to gplan.gplan_code
32997>>>    find eq gplan by index.1
32998>>>>
32998>>>    if ((found=1) and (Gplan.Gplan_Yn_Last = 1)) Function_Return 0
33001>>>    else                                         Function_return 1
33003>>>
33003>>>End_Function
33004>>>
33004>>>Function fsgplandescr String slog Returns string
33005>>>    clear gplan
33006>>>    move syscurgl.company_code to gplan.company_code
33007>>>    move syscurgl.branch_code  to gplan.branch_code
33008>>>    move syscurgl.year_year    to gplan.year_year
33009>>>    move slog                  to gplan.gplan_code
33010>>>    find eq gplan by index.1
33011>>>>
33011>>>    if (found=1) function_return gplan.gplan_descr1
33014>>>    else         function_return ''
33016>>>
33016>>>End_Function
33017>>>
33017>>>Function fsclient string code Returns string
33018>>>    string name
33019>>>    clear clients
33020>>>    move code to clients.client_id
33021>>>    find eq clients by index.6
33022>>>>
33022>>>    if (found) move clients.client_name to name
33025>>>    else       move '' to name
33027>>>    function_return name
33028>>>end_Function
33029>>>
33029>>>Function fspayresp string code Returns string
33030>>>    string name
33031>>>    clear payresp
33032>>>    move code to payresp.presp_id
33033>>>    find eq payresp by index.7
33034>>>>
33034>>>    if (found) move payresp.presp_name to name
33037>>>    else       move '' to name
33039>>>    function_return name
33040>>>end_Function
33041>>>
33041>>>Function fssalesmen string code Returns string
33042>>>    string name
33043>>>    clear salesmen
33044>>>    move code to salesmen.sls_id
33045>>>    find eq salesmen by index.4
33046>>>>
33046>>>    if (found) move salesmen.sls_name to name
33049>>>    else       move '' to name
33051>>>    function_return name
33052>>>end_Function
33053>>>
33053>>>Function fsconstrct string code Returns string
33054>>>    string name
33055>>>    clear constrct
33056>>>    move code to constrct.cnt_id
33057>>>    find eq constrct by index.5
33058>>>>
33058>>>    if (found) move constrct.cnt_name to name
33061>>>    else       move '' to name
33063>>>    function_return name
33064>>>end_Function
33065>>>
33065>>>Function fsmhxanik string code Returns string
33066>>>    string name
33067>>>    clear mhxanik
33068>>>    move code to mhxanik.mhx_id
33069>>>    find eq mhxanik by index.4
33070>>>>
33070>>>    if (found) move mhxanik.mhx_name to name
33073>>>    else       move '' to name
33075>>>    function_return name
33076>>>end_Function
33077>>>
33077>>>
33077>>>Function fsptyppar string code Returns string
33078>>>    string sdescr
33079>>>    clear ptypparl
INCLUDING FILE: PTYPPARL.FD
33080>>>    move syscurxr.company_code to ptypparl.company_code
33081>>>    move syscurxr.branch_code  to ptypparl.branch_code
33082>>>    move syscurxr.year_year    to ptypparl.year_year
33083>>>    move code                  to ptypparl.ptyppar_code
33084>>>    find eq ptypparl by index.1
33085>>>>
33085>>>    move ptypparl.ptyppar_descr to sdescr
33086>>>    function_return sdescr
33087>>>end_Function
33088>>>
33088>>>Function fsgplan string code Returns string
33089>>>    string sdescr
33090>>>    clear gplan
33091>>>    move syscurxr.company_code to gplan.company_code
33092>>>    move syscurxr.branch_code  to gplan.branch_code
33093>>>    move syscurxr.year_year    to gplan.year_year
33094>>>    move code                  to gplan.gplan_code
33095>>>    find eq gplan by index.1
33096>>>>
33096>>>    move gplan.gplan_descr1    to sdescr
33097>>>    function_return sdescr
33098>>>end_Function
33099>>>
33099>>>Function fsitem string scode Returns string
33100>>>    clear iteml
33101>>>    move scode to iteml.item_code
33102>>>    find eq iteml by index.5
33103>>>>
33103>>>    function_return iteml.item_descr
33104>>>end_Function
33105>>>
33105>>>Function fswax string srecr Returns string
33106>>>    clear wax
33107>>>    move srecr to wax.wax_recr
33108>>>    find eq wax by index.2
33109>>>>
33109>>>    function_return wax.wax_descr
33110>>>end_Function
33111>>>
33111>>>
33111>>>Function fswitemx string code Returns string
33112>>>    string name
33113>>>    clear witemx
INCLUDING FILE: WITEMX.FD
33114>>>    move syscurxr.company_code to witemx.company_code
33115>>>    move syscurxr.branch_code  to witemx.branch_code
33116>>>    move syscurxr.year_year    to witemx.year_year
33117>>>    move code to witemx.witemx_code
33118>>>    find eq witemx by index.5
33119>>>>
33119>>>    move witemx.witemx_descr to name
33120>>>    function_return name
33121>>>end_Function
33122>>>
33122>>>Function fsCNDescr String asItem Returns String
33123>>>    Clear CN
33124>>>    move asItem to CN.CN_Code
33125>>>    Find Eq CN by Index.5
33126>>>>
33126>>>    Function_Return CN.CN_Descr
33127>>>End_Function
33128>>>
33128>>>Function fswtypkin String askin Returns String
33129>>>    Clear Wtypkin
33130>>>    move askin to Wtypkin.wtypkin_code
33131>>>    Find Eq wtypkin by Index.1
33132>>>>
33132>>>    Function_Return Wtypkin.wtypkin_descr
33133>>>End_Function
33134>>>
33134>>>Function FindGtypkinDescr Integer aiCode Returns String
33135>>>    String lsDescr
33136>>>    Clear Gtypkin
INCLUDING FILE: GTYPKIN.FD
33137>>>    Move syscurxr.company_code    to Gtypkin.Company_Code
33138>>>    Move syscurxr.Branch_Code     to Gtypkin.Branch_Code
33139>>>    Move syscurxr.Year_year       to Gtypkin.Year_Year
33140>>>    Move aiCode                   to Gtypkin.Gtypkin_Code
33141>>>    Find eq Gtypkin by Index.1
33142>>>>
33142>>>    [Found] Move Gtypkin.Gtypkin_Descr to lsDescr
33143>>>    Function_Return lsDescr
33144>>>End_Function // FindGtypkinDescr
33145>>>
33145>>>Function FindBtypkinDescr Integer aiCode Returns String
33146>>>    String lsDescr
33147>>>    Clear Btypkin
INCLUDING FILE: BTYPKIN.FD
33148>>>    Move syscurxr.company_code    to Btypkin.Company_Code
33149>>>    Move syscurxr.Branch_Code     to Btypkin.Branch_Code
33150>>>    Move syscurxr.Year_year       to Btypkin.Year_Year
33151>>>    Move aiCode                   to Btypkin.btypkin_Code
33152>>>    Find eq Btypkin by Index.1
33153>>>>
33153>>>    [Found] Move Btypkin.Btypkin_Descr to lsDescr
33154>>>    Function_Return lsDescr
33155>>>End_Function // FindGtypkinDescr
33156>>>
33156>>>
33156>Use Connect.Dg
INCLUDING FILE: CONNECT.DG
33156>>>//AB/ Project Connect
33156>>>//AB/ Object prj is a Dialog_Project
33156>>>//AB/     Set ProjectName to "Connect"
33156>>>//AB/     Set ProjectFileName to "CONNECT.DG"
33156>>>
33156>>>// Project Object Structure
33156>>>//   Connect is a BasicPanelSub
33156>>>//     BitmapContainer1 is a BitmapContainerSub
33156>>>//     Textbox5 is a TextBoxSub
33156>>>//     ComboForm2 is a ComboFormSub
33156>>>//     Textbox6 is a TextBoxSub
33156>>>//     Form4 is a FormSub
33156>>>//     Textbox7 is a TextBoxSub
33156>>>//     Form5 is a FormSub
33156>>>//     Textbox8 is a TextBoxSub
33156>>>//     Form6 is a FormSub
33156>>>//     CheckBox1 is a CheckBoxSub
33156>>>//     oOK_bn is a ButtonSub
33156>>>//     oCancel_bn is a ButtonSub
33156>>>
33156>>>// Register all objects
33156>>>Register_Object BitmapContainer1
33156>>>Register_Object CheckBox1
33156>>>Register_Object ComboForm2
33156>>>Register_Object Connect
33156>>>Register_Object Form4
33156>>>Register_Object Form5
33156>>>Register_Object Form6
33156>>>Register_Object oCancel_bn
33156>>>Register_Object oOK_bn
33156>>>Register_Object Textbox5
33156>>>Register_Object Textbox6
33156>>>Register_Object Textbox7
33156>>>Register_Object Textbox8
33156>>>
33156>>>
33156>>>
33156>>>//AB-StoreTopStart
33156>>>
33156>>>///#INCLUDE
33156>>>Use mertech.inc
INCLUDING FILE: MERTECH.INC
33156>>>>>USE UI
33156>>>>>
#REM -----------------------------------------------
#REM MERTECH DATA SYSTEMS INC. - WWW.MERTECHDATA.COM
#REM MERTECH.INC VERSION 2.1.9
#REM -----------------------------------------------
33156>>>>>
33156>>>>>
33156>>>>>
33156>>>>>
33156>>>>>
33156>>>>>//
33156>>>>>//
33156>>>>>//
33156>>>>>//
33156>>>>>//
33156>>>>>//-----------------------------------------------
33156>>>>>// SELECT_COLUMNS_FIND <FILE> <START> THRU <END>
33156>>>>>// SELECT_COLUMNS_FIND <FILE> <FIELD>
33156>>>>>// This command will issue a properly commands to define the FETCH attribute status
33156>>>>>// for file fields.
33156>>>>>//
33156>>>>>//------------------------------------------------------------------------------
33156>>>>>// RESET_FETCH_FIELDS <FILE NAME>|<FILE NUMBER> <DF_FETCH_TRUE>|<DF_FETCH_FALSE>
33156>>>>>//
33156>>>>>//
33156>>>>>//-----------------------------
33156>>>>>// SQL_FOR_ONEROW <file number>
33156>>>>>//
33156>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get just
33156>>>>>// one ROW for each DataFlex FIND command issued
33156>>>>>// In this case the DBMS optimizer will generate a query with just one row
33156>>>>>//
33156>>>>>//
33156>>>>>//-------------------------------------------------------------------------------
33156>>>>>// SQL_FOR_SET <file number> MAXROWS <number of rows> CACHE|NOCACHE <return code>
33156>>>>>//
33156>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get a SET of rows.
33156>>>>>// In this case the DBMS optimizer will generate a query with <number of rows> Rows.
33156>>>>>// if CACHE is passed as argument, all these rows will be transfered to ORAFlex and then it will
33156>>>>>// save them in a local CACHE buffer. Just the FIND GT and FIND LT will get local cache.
33156>>>>>// Otherwise, i.e NOCACHE,  ORAFLex won't create a local cache.
33156>>>>>//
33156>>>>>//
33156>>>>>//---------------
33156>>>>>// SQL_SET <stmt>
33156>>>>>//
33156>>>>>//-----------------------------------------
33156>>>>>// SQL_APPEND <stmt1> <stmt2> .... <stmtn>
33156>>>>>//
33156>>>>>//------------
33156>>>>>// SQL_EXECUTE
33156>>>>>//
33156>>>>>//----------------------------------------------------------------------
33156>>>>>// LOCK_TABLE [<FILE NAME>|<FILE NUMBER> <FILE NAME>|<FILE NUMBER> ....]
33156>>>>>//
33156>>>>>// LOCK_TABLE will lock the entire table specified as an argument
33156>>>>>// This command will start a new transaction if it still wasn't done.
33156>>>>>// LOCK_TABLE won't lock the other opened tables or the current rows present
33156>>>>>// in their buffers it will be necessary issue a REREAD command to Lock the current
33156>>>>>// rows and then atualize their buffers
33156>>>>>//
33156>>>>>//
33156>>>>>//-------------------------------------------
33156>>>>>// SQL_CHECK_TABLE <SCHEMA NAME> <TABLE NAME>
33156>>>>>//
33156>>>>>//-------------------------------
33156>>>>>// CREATE_TD_FILE  DFTRUE|DFFALSE
33156>>>>>// SET A GLOBAL ATTRIBUTE TO CREATE THE TD FILE AFTER CLOSING AN OPENED FILE
33156>>>>>//
33156>>>>>//-------------------------------------------------
33156>>>>>// OPEN_INT <DATAFLEX FILE NAME>
33156>>>>>// OPEN_INT <PHYSICAL NAME> AS <DATAFLEX FILE NAME>
33156>>>>>//
33156>>>>>// OPEN_INT will check if the OPEN done is an OPEN AS. IF it's true, OPEN_INT
33156>>>>>// will try to open an intermediate file, if there is one. Otherwise OPEN_INT
33156>>>>>// will issue a OPEN command
33156>>>>>// OPEN_INT must be inserted into FMAC file instead OPEN COMMAND
33156>>>>>//
33156>>>>>//=========================================================================================================
33156>>>>>// SELECT STUFFS
33156>>>>>//--------------
33156>>>>>// SQL_SET_STMT OF FILENAME|FILENUMBER TO <STATMENT1>
33156>>>>>//
33156>>>>>// SQL_APPEND_ OF FILENAME|FILENUMBER TO <STATMENT1> <STATMENT2> ... <STATMENTn>
33156>>>>>//
33156>>>>>//
33156>>>>>// SQL_APPEND_UPDCOL_STMT OF FILENAME|FILENUMBER VALUE EXPRESSION WITH FIELD1 FIELD2 ... FIELDN
33156>>>>>//
33156>>>>>// SQL_PREPARE_STMT OF FILENAME|FILENUMBER
33156>>>>>//
33156>>>>>// SQL_BIND_COLUMN [FILENAME|FILENUMBER] [FIELDNAME|FIELDNUMBER]
33156>>>>>//
33156>>>>>// SQL_BINDCOLUMNS_STMT OF FILENAME|FILENUMBER TO <COLUMN1> <COLUMN2> ... <COLUMNn>
33156>>>>>//
33156>>>>>// SQL_EXECUTE_STMT OF FILENAME|FILENUMBER
33156>>>>>//
33156>>>>>// SQL_COMMIT_STMT
33156>>>>>//
33156>>>>>// SQL_ROLLBACK_STMT
33156>>>>>//
33156>>>>>// SQL_FETCH_NEXT_ROW OF FILENAME|FILENUMBER
33156>>>>>//
33156>>>>>//
33156>>>>>//
33156>>>>>//
33156>>>>>// CALL_STORED_PROCEDURE will call a stored procedure passing arguments
33156>>>>>//
33156>>>>>// FORMAT TO USE : CALL_STORED_PROCEDURE <STORED_PROC_NAME> [PASSING <ARG1> <ARG2> ....<ARGn>]
33156>>>>>//
33156>>>>>//
33156>>>>>//---------------------------------------------------------------------------------------------
33156>>>>>// CALL_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
33156>>>>>// CALL_STORED_FUNCTION will call an Oracle stored function passing arguments
33156>>>>>//
33156>>>>>//---------------------------
33156>>>>>// SQL_TEXT_MESSAGE <MESSAGE>
33156>>>>>// Writes a message inside driver log trace file if this is activated
33156>>>>>//
33156>>>>>//-----------------------------------------------------
33156>>>>>// OUTPUT_INT_FILE FOR <FILE NUMBER> TO <INT FILE NAME>
33156>>>>>// Generating the INT file
33156>>>>>//
33156>>>>>// -----------------------
33156>>>>>// SQL_ERROR_MESSAGE <VAR>
33156>>>>>// SQL_ERROR_MESSAGE retrieve the native error message issued by server for error number 25000
33156>>>>>
33156>>>>>
33156>>>>>//=======================================================================================
33156>>>>>// SQLFlex Commands
33156>>>>>//-----------------
33156>>>>>//
33156>>>>>//-----------------------
33156>>>>>// SQLFlex_REVISION <VAR>
33156>>>>>// Retrieves SQLFlex revision
33156>>>>>//
33156>>>>>//-------------------------------------
33156>>>>>// SET_DATABASE_NAME TO <DATABASE NAME>
33156>>>>>// Sets current database
33156>>>>>//
33156>>>>>//---------------------------
33156>>>>>// GET_DATABASE_NAME TO <VAR>
33156>>>>>// Gets name of current database
33156>>>>>//
33156>>>>>//----------------------------------
33156>>>>>// SET_SCHEMA_NAME TO <SCHEMA NAME>
33156>>>>>// Sets current schema name
33156>>>>>//
33156>>>>>//-------------------------
33156>>>>>// GET_SCHEMA_NAME TO <VAR>
33156>>>>>// Gets current schema name
33156>>>>>//
33156>>>>>//--------------------------------
33156>>>>>// SQL_USEDATABASE <DATABASE NAME>
33156>>>>>// Specifies the current Database
33156>>>>>//
33156>>>>>//----------------------------
33156>>>>>// SET_CURRENT_SERVER TO <VAR>
33156>>>>>// Set the current logged server
33156>>>>>//
33156>>>>>//----------------------------
33156>>>>>// GET_CURRENT_SERVER TO <VAR>
33156>>>>>// Retrieves the current logged server
33156>>>>>//
33156>>>>>//-----------------------------
33156>>>>>// SET_HOST_NAME TO <HOST NAME>
33156>>>>>// Defines current host name
33156>>>>>//
33156>>>>>//-----------------------
33156>>>>>// GET_HOST_NAME TO <VAR>
33156>>>>>// Retrieves the current host name
33156>>>>>//
33156>>>>>//---------------------------------------------------------------
33156>>>>>// LOGIN_SQLFLEX <SERVER NAME> <USER NAME> <PASSWORD> <HOST NAME>
33156>>>>>// Specifies host name during login process
33156>>>>>//
33156>>>>>// SQL_CANCEL_QUERY_STMT
33156>>>>>//
33156>>>>>//========================================
33156>>>>>// SQL SERVER Stored Procedure Call engine
33156>>>>>//----------------------------------------
33156>>>>>//
33156>>>>>//
33156>>>>>
33156>>>>>//
33156>>>>>//--------------------------------------------------------------------------------------------------------------
33156>>>>>// CALL_SQLSERVER_PROCEDURE <procedure name> PASSING <VALUE1|VARIABLE1> [SQLOUT] <VALUE2|VARIABLE2> [SQLOUT] ...
33156>>>>>//
33156>>>>>// Executes a stored procedure. SQLOUT will be used to indicate that the stored procedure
33156>>>>>// returns a parameter. The matching parameter in the stored proceudre must have been created with
33156>>>>>// the keyword OUTPUT. Call all procedures that doesn't returns any query with this syntax
33156>>>>>//
33156>>>>>//
33156>>>>>//
33156>>>>>//-----------------------------------------------------------------------------
33156>>>>>
33156>>>>>
33156>>>>>//=============================================================================
33156>>>>>// ORAFlex Commands
33156>>>>>//-----------------
33156>>>>>//----------------------------
33156>>>>>// ORAFlex_REVISION <VARIABLE>
33156>>>>>// Retrieves ORAFlex revision
33156>>>>>//
33156>>>>>//---------------------------------
33156>>>>>// KEEP_FILES_OPEN OF <SERVER NAME>
33156>>>>>// Keeps all files opened even during a LOGOUT
33156>>>>>//
33156>>>>>//-----------------------------------------------
33156>>>>>// SET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
33156>>>>>// Defines the maximum number of cursors that ORAFlex will be allowed for using
33156>>>>>//
33156>>>>>//-----------------------------------------------
33156>>>>>// GET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
33156>>>>>// Retrieves the maximum number of cursors allowed for ORAFlex use
33156>>>>>//
33156>>>>>//---------------------------------------------
33156>>>>>// GET_OPENED_CURSORS OF <SERVER NAME> TO <VAR>
33156>>>>>// Retrieves the number of opened cursors
33156>>>>>//
33156>>>>>//-----------------------------------------------
33156>>>>>// ACTIVATE_TIME_STAMP OF <SERVER NAME> TO ON|OFF
33156>>>>>// Activates Time stamp for date columns
33156>>>>>//
33156>>>>>//----------------------------------------------------------------------------------------------------
33156>>>>>// CALL_ORACLE_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
33156>>>>>// CALL_ORACLE_STORED_FUNCTION will call an Oracle stored function passing arguments
33156>>>>>//
33156>>>>>//-----------------------------------------------------------------------------
33156>>>>>
33156>>>>>//=============================================================================
33156>>>>>// BUFFER save stuffs
33156>>>>>//-------------------
33156>>>>>
33156>>>>>//-------------------------------------------------------
33156>>>>>// SQL_SAVE_BUFFER_BEGIN OF <FILE NUMBER> TO <CACHE SIZE>
33156>>>>>// Initialize the BUFFER buffer
33156>>>>>//
33156>>>>>//---------------------------------
33156>>>>>// SQL_SAVE_BUFFER OF <FILE NUMBER>
33156>>>>>// Moves field buffer values to cache buffer
33156>>>>>//-------------------------------------
33156>>>>>// SQL_SAVE_BUFFER_END OF <FILE NUMBER>
33156>>>>>// Save rows that remains in cache
33156>>>>>//-----------------------------------------------------------------------------
33156>>>>>
33156>>>
33156>>>//AB-StoreTopEnd
33156>>>
33156>>>//AB-IgnoreStart
33156>>>
33156>>>Use Panel.Sub
33156>>>Use Bitmap.Sub
33156>>>Use Txtbox.Sub
33156>>>Use Cmbfrm.Sub
33156>>>Use Form.Sub
33156>>>Use Chkbox.Sub
33156>>>Use Button.Sub
33156>>>
33156>>>
33156>>>//AB-IgnoreEnd
33156>>>
33156>>>Object Connect is a BasicPanelSub
33158>>>
33158>>>    //AB-StoreTopStart
33158>>>
33158>>>    //AB-StoreTopEnd
33158>>>
33158>>>    Set Sysmenu_Icon to FALSE
33159>>>    Set Minimize_Icon to FALSE
33160>>>    Set Label to "Login"
33161>>>    Set Size to 105 230
33162>>>    Set Location to 20 37
33163>>>
33163>>>    //AB-DDOStart
33163>>>
33163>>>
33163>>>    //AB-DDOEnd
33163>>>
33163>>>    Object BitmapContainer1 is a BitmapContainerSub
33165>>>        Set Size to 21 23
33166>>>        Set Location to 4 4
33167>>>        Set Bitmap to "Login1.bmp"
33168>>>        Set Border_Style to Border_None
33169>>>        Set Bitmap_Style to Bitmap_Center
33170>>>        Set Dialog_Caption to "Select a bitmap file"
33171>>>
33171>>>        //AB-StoreStart
33171>>>
33171>>>
33171>>>
33171>>>
33171>>>        //AB-StoreEnd
33171>>>
33171>>>    End_Object    // BitmapContainer1
33172>>>
33172>>>    Object Textbox5 is a TextBoxSub
33174>>>        Set Label to "Driver:"
33175>>>        Set FontSize to 4 0
33176>>>        Set Location to 6 34
33177>>>        Set Size to 13 40
33178>>>        Set Enabled_State to TRUE
33179>>>    End_Object    // Textbox5
33180>>>
33180>>>    Object ComboForm2 is a ComboFormSub
33182>>>
33182>>>        //AB-StoreTopStart
33182>>>
33182>>>        Set CapsLock_State to True
33183>>>
33183>>>        //AB-StoreTopEnd
33183>>>
33183>>>        Set Size to 13 85
33184>>>        Set Location to 6 76
33185>>>        Set Label_Col_Offset to 2
33186>>>        Set Label_Justification_Mode to jMode_Right
33187>>>
33187>>>        //AB-StoreStart
33187>>>        Procedure Combo_Fill_List
33189>>>                Local String Availdrv## TempDrv##
33190>>>                Local Integer HowMany i p1## p2##
33190>>>
33190>>>                get_profile_string "WorkSpaces" "CurrentWorkspace" to AvailDrv##
33193>>>                If AvailDrv## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to AvailDrv##
33196>>>                insert "WorkSpaces\" in AvailDrv## at 1
33198>>>                get_profile_string AvailDrv## "AvailableDrivers" to AvailDrv##
33201>>>
33201>>>                Move Availdrv## to Tempdrv##
33202>>>                Repeat
33202>>>>
33202>>>                    Replace "|" in Tempdrv## With ""
33204>>>                    [Found] Increment HowMany
33205>>>                Until [Finderr]
33207>>>
33207>>>                Send Combo_add_Item ""
33208>>>
33208>>>                If HowMany lt 1 Begin
33210>>>                    If Availdrv## ne "" Send Combo_Add_Item (UpperCase(Availdrv##))
33213>>>                End
33213>>>>
33213>>>                Else Begin
33214>>>                    For i From 0 to HowMany
33220>>>>
33220>>>                        If i eq 0 Move 1 to p1##
33223>>>                        Else Begin
33224>>>                            Move ((Pos("|",Availdrv##))+1) to p1##
33225>>>                            Replace "|" in Availdrv## With ","
33227>>>                        End
33227>>>>
33227>>>                        Move ((Pos("|",Availdrv##))) to p2##
33228>>>                        Send Combo_Add_Item (UpperCase(Mid(Availdrv##,(p2##-p1##),p1##)))
33229>>>                    Loop
33230>>>>
33230>>>                End
33230>>>>
33230>>>        End_Procedure
33231>>>
33231>>>        Set Allow_Blank_state to True
33232>>>
33232>>>
33232>>>
33232>>>        //AB-StoreEnd
33232>>>
33232>>>    End_Object    // ComboForm2
33233>>>
33233>>>    Object Textbox6 is a TextBoxSub
33235>>>        Set Label to "Server:"
33236>>>        Set FontSize to 4 0
33237>>>        Set Location to 22 34
33238>>>        Set Size to 13 40
33239>>>        Set Enabled_State to TRUE
33240>>>    End_Object    // Textbox6
33241>>>
33241>>>    Object Form4 is a FormSub
33243>>>        Set Size to 13 93
33244>>>        Set Location to 22 76
33245>>>        Set Label_Col_Offset to 2
33246>>>        Set Label_Justification_Mode to jMode_Right
33247>>>    End_Object    // Form4
33248>>>
33248>>>    Object Textbox7 is a TextBoxSub
33250>>>        Set Label to "User Name:"
33251>>>        Set FontSize to 4 0
33252>>>        Set Location to 38 34
33253>>>        Set Size to 13 40
33254>>>        Set Enabled_State to TRUE
33255>>>    End_Object    // Textbox7
33256>>>
33256>>>    Object Form5 is a FormSub
33258>>>        Set Size to 13 93
33259>>>        Set Location to 38 76
33260>>>        Set Label_Col_Offset to 2
33261>>>        Set Label_Justification_Mode to jMode_Right
33262>>>    End_Object    // Form5
33263>>>
33263>>>    Object Textbox8 is a TextBoxSub
33265>>>        Set Label to "Password:"
33266>>>        Set FontSize to 4 0
33267>>>        Set Location to 54 34
33268>>>        Set Size to 13 40
33269>>>        Set Enabled_State to TRUE
33270>>>    End_Object    // Textbox8
33271>>>
33271>>>    Object Form6 is a FormSub
33273>>>        Set Size to 13 93
33274>>>        Set Location to 54 76
33275>>>        Set Label_Col_Offset to 2
33276>>>        Set Label_Justification_Mode to jMode_Right
33277>>>
33277>>>        //AB-StoreStart
33277>>>        Set Password_State Item 0 to True
33278>>>
33278>>>        //AB-StoreEnd
33278>>>
33278>>>    End_Object    // Form6
33279>>>
33279>>>    Object CheckBox1 is a CheckBoxSub
33281>>>        Set Label to "Save Password"
33282>>>        Set Size to 10 66
33283>>>        Set Location to 73 76
33284>>>        Set Status_Help to "Remember The Password at Next Login"
33285>>>    End_Object    // CheckBox1
33286>>>
33286>>>    Object oOK_bn is a ButtonSub
33288>>>        Set Label to "Co&nnect"
33289>>>        Set Default_State to TRUE
33290>>>        Set Bitmap to "mcr.bmp"
33291>>>        Set Size to 28 33
33292>>>        Set Location to 9 184
33293>>>
33293>>>        //AB-StoreStart
33293>>>        Procedure OnClick
33295>>>            Set LoginOk to True
33296>>>            Send Stop_Modal_ui
33297>>>        End_Procedure
33298>>>        Set Status_Help to "Connect"
33299>>>        //AB-StoreEnd
33299>>>
33299>>>    End_Object    // oOK_bn
33300>>>
33300>>>    Object oCancel_bn is a ButtonSub
33302>>>        Set Label to "&Cancel"
33303>>>        Set Bitmap to "exit2.bmp"
33304>>>        Set Size to 28 32
33305>>>        Set Location to 39 184
33306>>>
33306>>>        //AB-StoreStart
33306>>>
33306>>>        ON_KEY KENTER SEND Exit_Application to (Connect(Current_Object))
33307>>>
33307>>>        Procedure OnClick
33309>>>            Set LoginOk to False
33310>>>            Send Exit_Application to (Connect(Current_Object))
33311>>>        End_Procedure
33312>>>
33312>>>        Set Status_Help to "Close Application"
33313>>>
33313>>>
33313>>>        //AB-StoreEnd
33313>>>
33313>>>    End_Object    // oCancel_bn
33314>>>
33314>>>
33314>>>    //AB-StoreStart
33314>>>
33314>>>    Set Modal_State to True
33315>>>
33315>>>    // Now is WorkspaceAware
33315>>>
33315>>>    ON_KEY KENTER SEND OnClick to (oOk_bn(Current_Object))
33316>>>    ON_KEY KSAVE_RECORD SEND OK
33317>>>    ON_KEY KCANCEL SEND EXIT_APPLICATION
33318>>>    ON_KEY KCLOSE_PANEL SEND EXIT_APPLICATION
33319>>>
33319>>>    Set Locate_Mode to Center_On_Screen
33320>>>    Set Exit_Application_Local_State to False
33321>>>    Set Exit_MSG to Exit
33322>>>    Set Description_State to True
33323>>>
33323>>>    Property Integer LoginOk public false
33325>>>
33325>>>    External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;        Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
33326>>>
33326>>>    Function Network_User_Name Returns String
33328>>>        Local String sName sLength
33329>>>        Local Pointer lpName_Addr lpLength_Addr
33329>>>        Local Integer iRetval
33329>>>
33329>>>        Movestr (Repeat (Character (0), 255)) To sName
33330>>>>
33330>>>        GetAddress Of sName To lpName_Addr
33331>>>        Movestr (DwordToBytes (255)) To sLength
33332>>>>
33332>>>        GetAddress Of sLength To lpLength_Addr
33333>>>
33333>>>        Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
33334>>>>
33334>>>
33334>>>        If iRetval Eq 0 Function_Return (CString (sName))
33337>>>        Else Function_Return "User Unknown"
33339>>>    End_Function // Network_User_Name
33340>>>
33340>>>    Function fsCrypto String lsWay String lsOld Returns String
33342>>>        Local String lsNew lsTemp
33343>>>        Local Integer liCount
33343>>>           For liCount From 1 to (Length(lsOld))
33349>>>>
33349>>>               Mid lsOld to lsTemp 1 liCount
33352>>>>
33352>>>               If ((Uppercase(lsWay)) eq 'FORWARD') Begin
33354>>>               If ((Ascii(lsTemp) = 255)) Move (Character(32)) to lsTemp
33357>>>               Else Move (Character(Ascii(lsTemp)+1)) to lsTemp
33359>>>               End
33359>>>>
33359>>>               Else Begin
33360>>>                   If ((Uppercase(lsWay)) eq 'BACKWARD') Begin
33362>>>                       If ((Ascii(lsTemp) = 32)) Move (Character(255)) to lsTemp
33365>>>                       Else Move (Character(Ascii(lsTemp)-1)) to lsTemp
33367>>>                   End
33367>>>>
33367>>>               End
33367>>>>
33367>>>               Append lsNew lsTemp
33368>>>           Loop
33369>>>>
33369>>>        Function_Return (lsNew)
33370>>>    End_Function
33371>>>
33371>>>    Procedure Activating
33373>>>        Local String LoginDriver## LoginServer## LoginUserid## LoginPassword##
33374>>>        Local String LastLogin## LoginSeq##
33374>>>        Local Integer SavePassword##
33374>>>
33374>>>        Forward Send Activating
33376>>>
33376>>>        get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
33379>>>        If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
33382>>>        insert "WorkSpaces\" in LastLogin## at 1
33384>>>        Append LastLogin## "\" (Module_Name(Self)) "\LastLogin"
33387>>>        get_profile_string LastLogin## "LoginDriver" to LoginSeq##
33390>>>
33390>>>        If "|" in LoginSeq## move (left(LoginSeq##,(pos("|",LoginSeq##) -1))) to LoginDriver##
33393>>>        Else Move LoginSeq## to LoginDriver##
33395>>>        get_profile_string LastLogin## "LoginServer"  to LoginServer##
33398>>>        get_profile_string LastLogin## "LoginUserId"  to LoginUserId##
33401>>>        get_profile_string LastLogin## "SavePassword" to SavePassword##
33404>>>        If LoginUserId## eq "" Move (Network_User_Name(Current_Object)) to LoginUserId##
33407>>>
33407>>>        If (((UpperCase(LoginDriver##)) eq "DATAFLEX") or (LoginDriver## eq "")) Begin
33409>>>                Set Value of (ComboForm2(Current_Object)) Item 0 to ""
33410>>>                Set Value of (Form4(Current_Object))      Item 0 to ""
33411>>>        End
33411>>>>
33411>>>        Else Begin
33412>>>            Set Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
33413>>>            Set Value of (Form4(Current_Object))      Item 0 to LoginServer##
33414>>>        End
33414>>>>
33414>>>        Set Value of (Form5(Current_Object))      Item 0 to LoginUserID##
33415>>>        Set Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
33416>>>        If (SavePassword##) Begin
33418>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33419>>>            get_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to LoginPassword##
33423>>>            Set Value of (Form6(Current_Object))      Item 0 to (fsCrypto(Self,"backward",LoginPassword##))
33424>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33425>>>        End
33425>>>>
33425>>>    End_Procedure
33426>>>
33426>>>    Function LoginUser Returns Integer
33428>>>        Integer SavePassword## Size## PasswordOk
33429>>>        String LoginDriver## LoginServer## LoginUserid## LoginPassword## LoginSeq## LastLogin##
33429>>>        String lsLoginDate lsHH lsMM lsSS sDepartment
33429>>>        Integer liOpenCursors
33429>>>
33429>>>        Send Popup_Modal
33430>>>
33430>>>        Get Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
33431>>>        Get Value of (Form4(Current_Object))      Item 0 to LoginServer##
33432>>>        Get Value of (Form5(Current_Object))      Item 0 to LoginUserID##
33433>>>        Get Value of (Form6(Current_Object))      Item 0 to LoginPassword##
33434>>>        Get Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
33435>>>        Set Value of (Form6(Current_Object))      Item 0 to ""
33436>>>
33436>>>        If ((LoginDriver## <> "") and (UpperCase(LoginDriver##)<>"DATAFLEX"))  begin
33438>>>            send ignore_error to (error_info_object(current_object)) 25000
33439>>>            send ignore_error to (error_info_object(current_object)) 4255
33440>>>            send ignore_error to (error_info_object(current_object)) 12293
33441>>>            login LoginServer## LoginUserId## LoginPassword## LoginDriver##
33443>>>            send trap_error to (error_info_object(current_object)) 25000
33444>>>            send trap_error to (error_info_object(current_object)) 4255
33445>>>            send trap_error to (error_info_object(current_object)) 12293
33446>>>            If LastErr eq 25000 Begin
33448>>>                Error LastErr "Invalid Login Information"
33449>>>>
33449>>>                Set LoginOk to False
33450>>>                Send Exit_Application
33451>>>            End
33451>>>>
33451>>>            If LastErr eq 4255 Begin
33453>>>                Error LastErr "Invalid Driver Name"
33454>>>>
33454>>>                Set LoginOk to False
33455>>>                Send Exit_Application
33456>>>            End
33456>>>>
33456>>>            If LastErr eq 12293 Begin
33458>>>                Error LastErr "(IBM CLI)Database alias name or Database name not found"
33459>>>>
33459>>>                Set LoginOk to False
33460>>>                Send Exit_Application
33461>>>            End
33461>>>>
33461>>>            Set LoginOk to True
33462>>>            If (UpperCase(LoginDriver##) = "ORA_DRV") Begin
33464>>>                GET_MAX_OPEN_CURSORS of LoginServer## to liOpenCursors
33477>>>                If (liOpenCursors <> 0) SET_MAX_OPEN_CURSORS of LoginServer## to (liOpenCursors+2)
33490>>>            End
33490>>>>
33490>>>        End
33490>>>>
33490>>>        Else Begin
33491>>>            Set LoginOk to True
33492>>>            Open "Users" as Users
INCLUDING FILE: USERS.FD
33494>>>            Move "DATAFLEX" To LoginDriver##
33495>>>            Move "" to LoginServer##
33496>>>            File_Size Users to Size##
33499>>>            If Size## ne 0 Begin
33501>>>                 Clear Users
33502>>>                 Move LoginUSerId##   to Users.Login_Id
33503>>>                 Find eq Users by Index.1
33504>>>>
33504>>>                 [Finderr] Begin
33506>>>>
33506>>>                    Error 25000 "Unknown User"
33507>>>>
33507>>>                    Set LoginOk to False
33508>>>                    Get LoginOk to PasswordOk
33509>>>                    Function_Return PasswordOk
33510>>>                 End
33510>>>>
33510>>>                 [Found] Begin
33512>>>>
33512>>>                    If (LoginPassword## ne Users.Password) Begin
33514>>>                        Error 25000 "Invalid Password"
33515>>>>
33515>>>                        Set LoginOk to False
33516>>>                        Get LoginOk to PasswordOk
33517>>>                        Function_Return PasswordOk
33518>>>                    End
33518>>>>
33518>>>                    Else Move Users.Departm_Code to sDepartment
33520>>>                    Move (Trim(sDepartment)) to sDepartment
33521>>>                 End
33521>>>>
33521>>>            End
33521>>>>
33521>>>            Close Users
33522>>>
33522>>>
33522>>>    //            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33522>>>    //            Integer bFileExists
33522>>>    //            Get Get_File_Exists  "C:\AutLogIn.txt" To bFileExists
33522>>>    //            If (NOT(bFileExists)) Begin
33522>>>
33522>>>    //                Get Get_File_Exists  "C:\UsrLogin.txt" To bFileExists
33522>>>    //                If (bFileExists) Begin
33522>>>
33522>>>    ////                        If Size## ne 0 Begin
33522>>>
33522>>>    //                            Local String ss1 ss2 ss3 ss4
33522>>>    //                            Local String dd1 dd2 dd3 dd4
33522>>>    //                            Move '' to dd1
33522>>>    //                            Move '' to dd2
33522>>>    //                            Move '' to dd3
33522>>>    //                            Move '' to dd4
33522>>>
33522>>>    //                            Direct_Input Channel 8 "C:\UsrLogin.txt"
33522>>>    //                            Readln Channel 8 ss1 ss2 ss3 ss4
33522>>>    //                            While (Not(Seqeof))
33522>>>    //                                Move (Trim(ss1)) to ss1
33522>>>    //                                Move (Trim(ss2)) to ss2
33522>>>    //                                Move (Trim(ss3)) to ss3
33522>>>    //                                Move (Trim(ss4)) to ss4
33522>>>    //                                Append dd1 '"' ss1 '"'
33522>>>    //                                Append dd2 '"' ss2 '"'
33522>>>    //                                Append dd3 '"' ss3 '"'
33522>>>    //                                Append dd4 '"' ss4 '"'
33522>>>    //                                Login dd1 dd2 dd3 dd4
33522>>>    //                                Readln Channel 8 ss1 ss2 ss3 ss4
33522>>>    //                            Loop
33522>>>
33522>>>
33522>>>    ////                            // Only Filmnet Users Log on to SQL
33522>>>    ////                            If (sDepartment='FILMNET') Begin
33522>>>    ////                                ////// 20/06/2001 js Allagh apo Oracle se SQL server
33522>>>    ////                                ////// login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33522>>>    ////                                login '192.168.128.5'   'sa'    ''   'SQL_DRV'
33522>>>    ////                                login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33522>>>    ////                            End
33522>>>    ////                            Else login '192.168.128.5'      'sa'    ''   'SQL_DRV'
33522>>>    ////                            //Else login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33522>>>
33522>>>    ////                        End
33522>>>    ////                        Else Begin
33522>>>    ////                            ////// 20/06/2001 js Allagh apo Oracle se SQL server
33522>>>    ////                            ///// login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33522>>>    ////                            login '192.168.128.5'       'sa'    ''   'SQL_DRV'
33522>>>    ////                            //login '192.168.128.5'   'EPGDNS'    'DNS'   'SQL_DRV'
33522>>>    ////                            login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33522>>>    ////                        End
33522>>>
33522>>>
33522>>>    //                End
33522>>>
33522>>>    //            End
33522>>>    //            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33522>>>
33522>>>
33522>>>
33522>>>            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33522>>>            //*Integer bFileExists
33522>>>            //*Get Get_File_Exists  "C:\AutLogIn.txt" To bFileExists
33522>>>            //*If (NOT(bFileExists)) Begin
33522>>>            //*    If Size## ne 0 Begin
33522>>>            //*        // Only Filmnet Users Log on to SQL
33522>>>            //*        If (sDepartment='FILMNET') Begin
33522>>>            //*            login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33522>>>            //*            login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33522>>>            //*        End
33522>>>            //*        Else login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33522>>>            //*    End
33522>>>            //*    Else Begin
33522>>>            //*        login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33522>>>            //*        login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33522>>>            //*    End
33522>>>            //*
33522>>>            //*End
33522>>>            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33522>>>
33522>>>
33522>>>
33522>>>        End
33522>>>>
33522>>>
33522>>>        Get LoginOk to PasswordOk
33523>>>        Sysdate lsLoginDate lsHH lsMM lsSS
33527>>>        get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
33530>>>        If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
33533>>>        insert "WorkSpaces\" in LastLogin## at 1
33535>>>        get_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
33538>>>        If ((LoginDriver## ne "") and ((UpperCase(LoginDriver##)) ne "DATAFLEX")) Begin
33540>>>           If Not LoginDriver## in LoginSeq## Begin
33542>>>                 If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
33545>>>                 Else Move (LoginSeq##+"|"+LoginDriver##) to LoginSeq##
33547>>>                 set_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
33550>>>           End
33550>>>>
33550>>>        End
33550>>>>
33550>>>        Append LastLogin## "\" (Module_Name(Self))
33552>>>        Append LastLogin## "\LastLogin"
33553>>>        get_profile_string LastLogin## "LoginDriver" to LoginSeq##
33556>>>
33556>>>        If "|" in LoginSeq## Begin
33558>>>            If ((left(LoginSeq##,(pos("|",LoginSeq##) -1))) ne LoginDriver##) Insert (LoginDriver##+"|") in LoginSeq## at 1
33562>>>        End
33562>>>>
33562>>>        Else Begin
33563>>>            If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
33566>>>            Else If LoginSeq## ne LoginDriver## Insert (LoginDriver##+"|") in LoginSeq## at 1
33571>>>        End
33571>>>>
33571>>>        Left LoginSeq## to LoginSeq## 250
33573>>>>
33573>>>        set_profile_string LastLogin## "LoginDriver" to (UpperCase(LoginSeq##))
33576>>>        set_profile_string LastLogin## "LoginServer" to LoginServer##
33579>>>        set_profile_string LastLogin## "LoginUserId" to LoginUserId##
33582>>>        set_profile_string LastLogin## "SavePassword" to SavePassword##
33585>>>        If lsHH lt 10 Insert 0 in lsHH at 1
33589>>>        If lsMM lt 10 Insert 0 in lsMM at 1
33593>>>        If lsSS lt 10 Insert 0 in lsSS at 1
33597>>>        Append lsLoginDate " - " lsHH ":" lsMM ":" lsSS
33603>>>        set_profile_string LastLogin## "LoginTime" to lsLoginDate
33606>>>        If (SavePassword##) Begin
33608>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33609>>>            set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to (fsCrypto(Self,"forward",LoginPassword##))
33612>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33613>>>        End
33613>>>>
33613>>>        Else Begin
33614>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33615>>>            set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to ""
33618>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33619>>>        End
33619>>>>
33619>>>
33619>>>        Function_Return PasswordOk
33620>>>    End_Function
33621>>>
33621>>>    Procedure Login For Desktop
33622>>>        Local Integer LoginPassword##
33623>>>        Get LoginUser of (Connect(Current_Object)) to LoginPassword##
33624>>>        If Not LoginPassword## Send Exit_Application
33627>>>    End_Procedure
33628>>>
33628>>>    Function CheckLogin For Desktop Returns Integer
33629>>>        Local Integer LoginPassword##
33630>>>        Get LoginUser of (Connect(Current_Object)) to LoginPassword##
33631>>>        Function_Return LoginPassword##
33632>>>    End_Function
33633>>>
33633>>>
33633>>>
33633>>>    //AB-StoreEnd
33633>>>
33633>>>End_Object    // Connect
33634>>>
33634>>>
33634>>>//AB-StoreStart
33634>>>
33634>>>
33634>>>
33634>>>//AB-StoreEnd
33634>>>
33634>>>//AB/ End_Object    // prj
33634>Send Login
33635>Set Button_State    of (Wait(Self)) to False
33636>Set BarVisibleState of (Wait(Self)) to '' False
33637>Send Popup                          to (Wait(Self))
33638>Send UpdateWait to (Wait(Self))     '˜¨˜¡˜¢é œ¨ £â¤œ«œ. „¢œš®¦ª ˜¨®œåà¤ œ­˜¨£¦šãª'
33639>
33639>Use Menu_Sec.Sub
INCLUDING FILE: MENU_SEC.SUB
33639>>>
33639>>>Use Idiotht.pkg
INCLUDING FILE: IDIOTHT.PKG
33639>>>>>
33639>>>>>Open Users
33641>>>>>Open UserGrps
INCLUDING FILE: USERGRPS.FD
33643>>>>>Open Pedia
INCLUDING FILE: PEDIA.FD
33645>>>>>Open Arxeia
INCLUDING FILE: ARXEIA.FD
33647>>>>>Open GrpPedia
INCLUDING FILE: GRPPEDIA.FD
33649>>>>>Open GrpPed0
INCLUDING FILE: GRPPED0.FD
33651>>>>>Open GrpArx
INCLUDING FILE: GRPARX.FD
33653>>>>>Open GrpArx0
INCLUDING FILE: GRPARX0.FD
33655>>>>>Open ViewFlds
INCLUDING FILE: VIEWFLDS.FD
33657>>>>>Open Oth
INCLUDING FILE: OTH.FD
33659>>>>>Open GrpOth
INCLUDING FILE: GRPOTH.FD
33661>>>>>Open GrpOth0
INCLUDING FILE: GRPOTH0.FD
33663>>>>>Open Departm
INCLUDING FILE: DEPARTM.FD
33665>>>>>
33665>>>>>
33665>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
33666>>>>>
33666>>>>>Function Network_User_Name Returns String
33667>>>>>    Local String sName sLength
33668>>>>>    Local Pointer lpName_Addr lpLength_Addr
33668>>>>>    Local Integer iRetval
33668>>>>>    Movestr (Repeat (Character (0), 255)) To sName
33669>>>>>>
33669>>>>>    GetAddress Of sName To lpName_Addr
33670>>>>>    Movestr (DwordToBytes (255)) To sLength
33671>>>>>>
33671>>>>>    GetAddress Of sLength To lpLength_Addr
33672>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
33673>>>>>>
33673>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
33676>>>>>    Else Function_Return "User Unknown"
33678>>>>>End_Function // Network_User_Name
33679>>>>>
33679>>>>>Function fsGetOfficePath Global Returns String
33680>>>>>    String sRegistryKeyPath sRegOfficePath
33681>>>>>    Set_Registry_Root                                                   to HKEY_LOCAL_MACHINE "Software"
33682>>>>>    Move "Microsoft\Office\9.0\Word"                                    to sRegistryKeyPath
33683>>>>>    Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path"    to sRegOfficePath
33687>>>>>    Move (Trim(sRegOfficePath))                                         to sRegOfficePath
33688>>>>>    If (sRegOfficePath='') Begin
33690>>>>>        Move "Microsoft\Office\8.0\Word"                                to sRegistryKeyPath
33691>>>>>        Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
33695>>>>>        Move (Trim(sRegOfficePath))                                     to sRegOfficePath
33696>>>>>        If (sRegOfficePath='') Begin
33698>>>>>            Move "Microsoft\Office\7.0\Word"                             to sRegistryKeyPath
33699>>>>>            Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
33703>>>>>            Move (Trim(sRegOfficePath))                                     to sRegOfficePath
33704>>>>>            If (sRegOfficePath='') Begin
33706>>>>>                Move "Microsoft\Office\10.0\Word"                                to sRegistryKeyPath
33707>>>>>                Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
33711>>>>>                Move (Trim(sRegOfficePath))                                     to sRegOfficePath
33712>>>>>            End
33712>>>>>>
33712>>>>>        End
33712>>>>>>
33712>>>>>    End
33712>>>>>>
33712>>>>>    Function_Return sRegOfficePath
33713>>>>>End_Procedure
33714>>>>>
33714>>>>>
33714>>>>>Function fsGetLastDir Global Returns String
33715>>>>>    String sRegistryKeyPath sRegDir sUserName
33716>>>>>    Get Network_User_Name to sUserName
33717>>>>>
33717>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
33720>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
33723>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
33725>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
33727>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
33728>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
33729>>>>>    Get_profile_string sRegistryKeyPath "Path" to sRegDir
33732>>>>>    Function_Return sRegDir
33733>>>>>End_Procedure
33734>>>>>
33734>>>>>Function fiPutLastDir Global String asDirectory Returns Integer
33735>>>>>    String sRegistryKeyPath sRegDir sUserName
33736>>>>>    Get Network_User_Name to sUserName
33737>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
33740>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
33743>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
33745>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
33747>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
33748>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
33749>>>>>    Set_profile_string sRegistryKeyPath "Path" to asDirectory
33752>>>>>    Function_Return 0
33753>>>>>End_Procedure
33754>>>>>
33754>>>>>
33754>>>>>Function fsVresExt Global String asFileName Returns String
33755>>>>>    String rVal
33756>>>>>    Integer iPos iLen
33756>>>>>    Move (UpperCase(asFileName)) to asFileName
33757>>>>>    Move (Trim(asFileName)) to asFileName
33758>>>>>    Move 0 to iPos
33759>>>>>    For iLen from 1 to (length(asFileName))
33765>>>>>>
33765>>>>>        If (Mid(asFileName,1,iLen)='.') Move iLen to iPos
33768>>>>>    Loop
33769>>>>>>
33769>>>>>    If (Not(iPos)) Function_Return ''
33772>>>>>    Move (Right(asFileName,(Length(asFileName)-iPos))) to rVal
33773>>>>>    Move (Trim(rVal)) to rVal
33774>>>>>    Function_Return rVal
33775>>>>>End_Function
33776>>>>>
33776>>>>>
33776>>>>>Function fiScreenFieldStatus Global String asViewName String asDbFormName Returns Integer
33777>>>>>    Integer rVal iUser iGroup
33778>>>>>    String  sUser sRecr
33778>>>>>    Move (Trim(asViewName))     to asViewName
33779>>>>>    Move (Trim(asDbFormName))   to asDbFormName
33780>>>>>
33780>>>>>    If ((asViewName<>'') And (asDbFormName<>'')) Begin
33782>>>>>        Get fsLoginUserID to sUser
33783>>>>>        Clear Users
33784>>>>>        Move sUser        to Users.Login_ID
33785>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
33786>>>>>>
33786>>>>>        If (Found=1) Begin
33788>>>>>            Move Users.User_ID  to iUser
33789>>>>>            Move Users.Grp_ID   to iGroup
33790>>>>>            Clear GrpOth
33791>>>>>            Move iUser          to GrpOth.User_ID
33792>>>>>            Move asViewName     to GrpOth.View_Name
33793>>>>>            Move asDbFormName   to GrpOth.Scr_Field_Name
33794>>>>>            Find eq GrpOth by Index.2 // GrpOth:Index.2:User_ID+View_Name+Scr_Field_Name
33795>>>>>>
33795>>>>>            If (Found=1) Begin
33797>>>>>                // rVal=1 ==> NO READ ALLOWED
33797>>>>>                // rVal=2 ==> NO EDIT BUT CAN COPY
33797>>>>>                // rVal=3 ==> NO EDIT AND NO COPY
33797>>>>>                If (GrpOth.Allow_Read <>'1') Move 1 to rVal
33800>>>>>                Else Begin
33801>>>>>                    If (GrpOth.Allow_Change<>'1') Begin
33803>>>>>                        If (GrpOth.Allow_Copy<>'1') Move 3 to rVal
33806>>>>>                        Else                        Move 2 to rVal
33808>>>>>                    End
33808>>>>>>
33808>>>>>                End
33808>>>>>>
33808>>>>>            End
33808>>>>>>
33808>>>>>            Else Begin
33809>>>>>                Clear GrpOth0
33810>>>>>                Move iGroup         to GrpOth0.Group_ID
33811>>>>>                Move asViewName     to GrpOth0.View_Name
33812>>>>>                Move asDbFormName   to GrpOth0.Scr_Field_Name
33813>>>>>
33813>>>>>                Find eq GrpOth0 by Index.2 // GrpOth0:Index.2:Group_ID+View_Name+Scr_Field_Name
33814>>>>>>
33814>>>>>                If (Found=1) Begin
33816>>>>>                    // rVal=1 ==> NO READ ALLOWED
33816>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
33816>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
33816>>>>>                    If (GrpOth0.Allow_Read <>'1') Move 1 to rVal
33819>>>>>                    Else Begin
33820>>>>>                        If (GrpOth0.Allow_Change<>'1') Begin
33822>>>>>                            If (GrpOth0.Allow_Copy<>'1') Move 3 to rVal
33825>>>>>                            Else                         Move 2 to rVal
33827>>>>>                        End
33827>>>>>>
33827>>>>>                    End
33827>>>>>>
33827>>>>>                End
33827>>>>>>
33827>>>>>                Else Move 0 to rVal
33829>>>>>            End
33829>>>>>>
33829>>>>>        End
33829>>>>>>
33829>>>>>        Else Move 0 to rVal
33831>>>>>    End
33831>>>>>>
33831>>>>>    Function_Return rVal
33832>>>>>End_Function
33833>>>>>
33833>>>>>Function fiFieldStatus Global Integer aiFileNumber Integer aiFieldNumber Returns Integer
33834>>>>>    Integer rVal iUser iGroup
33835>>>>>    String  sUser sRecr
33835>>>>>    If ((aiFileNumber) And (aiFieldNumber)) Begin
33837>>>>>        Get fsLoginUserID to sUser
33838>>>>>        Clear Users
33839>>>>>        Move sUser        to Users.Login_ID
33840>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
33841>>>>>>
33841>>>>>        If (Found=1) Begin
33843>>>>>            Move Users.User_ID  to iUser
33844>>>>>            Move Users.Grp_ID   to iGroup
33845>>>>>            Clear Pedia
33846>>>>>            Move aiFileNumber  to Pedia.Arxeio_ID
33847>>>>>            Move aiFieldNumber to Pedia.Pedio_Number
33848>>>>>            Find eq Pedia By Index.1 // Pedia:Index.1:Arxeio_ID+Pedio_Number
33849>>>>>>
33849>>>>>            If (Found=1) Begin
33851>>>>>                Move (Trim(Pedia.Pedio_Recr))   to sRecr
33852>>>>>                // Find Combination User/File/Field in GRPPEDIA
33852>>>>>                Clear GrpPedia
33853>>>>>                Move iUser                      to GrpPedia.User_ID
33854>>>>>                Move (Trim(sRecr))              to GrpPedia.Pedio_Recr
33855>>>>>                Find eq GrpPedia by Index.4 // GrpPedia:Index.4:Pedio_Recr + User_ID
33856>>>>>>
33856>>>>>                If (Found=1) Begin
33858>>>>>                    // rVal=1 ==> NO READ ALLOWED
33858>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
33858>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
33858>>>>>                    If (GrpPedia.Allow_Read <>'1') Move 1 to rVal
33861>>>>>                    Else Begin
33862>>>>>                        If (GrpPedia.Allow_Change<>'1') Begin
33864>>>>>                            If (GrpPedia.Allow_Copy<>'1')   Move 3 to rVal
33867>>>>>                            Else                            Move 2 to rVal
33869>>>>>                        End
33869>>>>>>
33869>>>>>                    End
33869>>>>>>
33869>>>>>                End
33869>>>>>>
33869>>>>>                Else Begin
33870>>>>>                    // Find Combination UserGrps/File/Field in GRPPED0
33870>>>>>                    Clear GrpPed0
33871>>>>>                    Move iGroup         to GrpPed0.Group_ID
33872>>>>>                    Move (Trim(sRecr))  to GrpPed0.Pedio_Recr
33873>>>>>                    Find eq GrpPed0 by Index.4 // GrpPed0:Index.4:Pedio_Recr + Group_ID
33874>>>>>>
33874>>>>>                    If (Found=1) Begin
33876>>>>>                        // rVal=1 ==> NO READ ALLOWED
33876>>>>>                        // rVal=2 ==> NO EDIT BUT CAN COPY
33876>>>>>                        // rVal=3 ==> NO EDIT AND NO COPY
33876>>>>>                        If (GrpPed0.Allow_Read <>'1') Move 1 to rVal
33879>>>>>                        Else Begin
33880>>>>>                            If (GrpPed0.Allow_Change<>'1') Begin
33882>>>>>                                If (GrpPed0.Allow_Copy<>'1')   Move 3 to rVal
33885>>>>>                                Else                           Move 2 to rVal
33887>>>>>                            End
33887>>>>>>
33887>>>>>                        End
33887>>>>>>
33887>>>>>                    End
33887>>>>>>
33887>>>>>                End
33887>>>>>>
33887>>>>>            End
33887>>>>>>
33887>>>>>            Else Begin
33888>>>>>                Move 0 to rVal
33889>>>>>            End
33889>>>>>>
33889>>>>>        End
33889>>>>>>
33889>>>>>        Else Begin
33890>>>>>            Move 0 to rVal
33891>>>>>        End
33891>>>>>>
33891>>>>>    End
33891>>>>>>
33891>>>>>    Function_Return rVal
33892>>>>>End_Function
33893>>>>>
33893>>>>>Function fsReturnFileFromPath Global String asFullPath Returns String
33894>>>>>    String rVal lsDirSep
33895>>>>>    Integer iPos iMet iLen iCnt
33895>>>>>    Move (Trim(asFullPath))                 To rVal
33896>>>>>    Move (Sysconf(SYSCONF_DIR_SEPARATOR))   To lsDirSep
33897>>>>>    If (rVal Contains lsDirSep) Begin
33899>>>>>        Move (Length(rVal)) to iLen
33900>>>>>        Move iLen to iCnt
33901>>>>>        While iCnt Gt 0
33905>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Begin
33907>>>>>                If (iCnt=iLen) Function_Return asFullPath
33910>>>>>                Else Function_Return (Right(rVal,(iLen-iCnt)))
33912>>>>>            End
33912>>>>>>
33912>>>>>            Decrement iCnt
33913>>>>>        End // While iCnt Gt 0
33914>>>>>>
33914>>>>>    End
33914>>>>>>
33914>>>>>    Else  Function_Return (Trim(asFullPath))
33916>>>>>    Function_Return rVal
33917>>>>>End_Function
33918>>>>>
33918>>>>>Function fsReturnDirectoriesFromPath Global String asFullPath Returns String
33919>>>>>    String rVal lsDirSep
33920>>>>>    Integer iPos iMet iLen iCnt
33920>>>>>    Move (Trim(asFullPath))                 To rVal
33921>>>>>    Move (Sysconf(SYSCOnF_DIR_SEPARATOR))   To lsDirSep
33922>>>>>    If (rVal Contains lsDirSep) Begin
33924>>>>>        Move (Length(rVal)) to iLen
33925>>>>>        Move iLen to iCnt
33926>>>>>        While iCnt Gt 0
33930>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Function_Return (Left(rVal,iCnt))
33933>>>>>            Decrement iCnt
33934>>>>>        End // While iCnt Gt 0
33935>>>>>>
33935>>>>>    End
33935>>>>>>
33935>>>>>    Function_Return rVal
33936>>>>>End_Function
33937>>>>>
33937>>>>>//Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
33937>>>>>//    Local String rVal lsTmp lsOO lsLL
33937>>>>>//    Local Number lnOO lnLL
33937>>>>>
33937>>>>>//    Move '' to lsOO
33937>>>>>//    Move '' to lsLL
33937>>>>>//    Move '' to rVal
33937>>>>>
33937>>>>>//    Move (Integer(anTime))                              to lnOO
33937>>>>>//    ////////////////////////////////////////////
33937>>>>>//    // sos sos sos jsjsjsjsjs yannis 30/03/2000
33937>>>>>//    //If ((lnOO=24) and (lnll=0)) Move 0 to lnOO
33937>>>>>//    ////////////////////////////////////////////
33937>>>>>
33937>>>>>//    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
33937>>>>>
33937>>>>>//    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
33937>>>>>//    Else         Move (String(lnOO))                    to lsOO
33937>>>>>//    Move (Trim(lsOO))                                   to lsOO
33937>>>>>
33937>>>>>//    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
33937>>>>>//    Else         Move (String(lnLL))                    to lsLL
33937>>>>>//    Move (Trim(lsLL))                                   to lsLL
33937>>>>>
33937>>>>>//    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
33937>>>>>
33937>>>>>//    Move (Trim(rVal)) to rVal
33937>>>>>
33937>>>>>//    Function_Return rVal
33937>>>>>//End_Function
33937>>>>>
33937>>>>>//Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
33937>>>>>//    Local Number rVal nOres nLepta
33937>>>>>//    Move (Integer(aiMinutes/60))    to nOres
33937>>>>>//    Move (    Mod(aiMinutes,60))    to nLepta
33937>>>>>//    Move (nOres+(nLepta/100))       to rVal
33937>>>>>//    Function_Return rVal
33937>>>>>//End_Function
33937>>>>>
33937>>>>>//Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
33937>>>>>//    Local Integer rVal
33937>>>>>//    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
33937>>>>>//    Function_Return rVal
33937>>>>>//End_Function
33937>>>>>
33937>>>>>//Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;
33937>>>>>//                                                                    Number anEndTime    ;
33937>>>>>//                                                                    Returns Integer
33937>>>>>//    Local Integer rVal iMinStart iMinEnd
33937>>>>>
33937>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
33937>>>>>
33937>>>>>//    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
33937>>>>>//    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
33937>>>>>//    Move (iMinEnd-iMinStart)                                                     to rVal
33937>>>>>//    Function_Return rVal
33937>>>>>//End_Function
33937>>>>>
33937>>>>>
33937>>>>>//Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;
33937>>>>>//                                                                Number anEndTime    ;
33937>>>>>//                                                                Returns Number
33937>>>>>//    Local Integer iTmp
33937>>>>>//    Local Number  rVal
33937>>>>>
33937>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
33937>>>>>
33937>>>>>//    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
33937>>>>>//    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
33937>>>>>//    Function_Return rVal
33937>>>>>//End_Function
33937>>>>>
33937>>>>>
33937>>>>>Function fsLoginUserID Global Returns String
33938>>>>>    Local String LastLogin# LoginUserid#
33939>>>>>    get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin#
33942>>>>>    If LastLogin# eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin#
33945>>>>>    insert "WorkSpaces\" in LastLogin# at 1
33947>>>>>    Append LastLogin# "\" (Module_Name(Self)) "\LastLogin"
33950>>>>>    get_profile_string LastLogin# "LoginUserId"  to LoginUserId#
33953>>>>>    Trim LoginUserID# to LoginUserID#
33954>>>>>>
33954>>>>>    If LoginUserId# eq "" Move (Network_User_Name(Current_Object)) to LoginUserId#
33957>>>>>    Function_Return LoginUserID#
33958>>>>>End_Function
33959>>>>>
33959>>>>>Function fiWriteRegistryLastSDFPath Global String asLastPath Returns Integer
33960>>>>>    Integer rVal
33961>>>>>    String  lsCurrentWksp
33961>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33964>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33967>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33969>>>>>    // Œœ¦ ¡¢œ ›   - Last_SDF_Path -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
33969>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
33969>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
33972>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
33975>>>>>    Function_Return rVal
33976>>>>>End_Function
33977>>>>>
33977>>>>>
33977>>>>>Function fsReadRegistryLastSDFPath Global Returns String
33978>>>>>    String rVal lsCurrentWksp
33979>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33982>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33985>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33987>>>>>    // Œœ¦ ¡¢œ ›   - LastParastUsed -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
33987>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
33987>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
33990>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
33993>>>>>    Function_Return (Trim(rVal))
33994>>>>>End_Function
33995>>>>>
33995>>>>>
33995>>>>>Function fiWriteRegistryLastMCryptPath Global String asLastPath Returns Integer
33996>>>>>    Integer rVal
33997>>>>>    String  lsCurrentWksp
33997>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34000>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34003>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34005>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
34008>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
34011>>>>>    Function_Return rVal
34012>>>>>End_Function
34013>>>>>
34013>>>>>
34013>>>>>Function fsReadRegistryLastMCryptPath Global Returns String
34014>>>>>    String rVal lsCurrentWksp
34015>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34018>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34021>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34023>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
34026>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
34029>>>>>    Function_Return (Trim(rVal))
34030>>>>>End_Function
34031>>>>>
34031>>>>>Function fiWriteRegistryLastWEBPath Global String asLastPath Returns Integer
34032>>>>>    Integer rVal
34033>>>>>    String  lsCurrentWksp
34033>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34036>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34039>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34041>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
34044>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
34047>>>>>    Function_Return rVal
34048>>>>>End_Function
34049>>>>>
34049>>>>>
34049>>>>>Function fsReadRegistryLastWEBPath Global Returns String
34050>>>>>    String rVal lsCurrentWksp
34051>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34054>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34057>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34059>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
34062>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
34065>>>>>    Function_Return (Trim(rVal))
34066>>>>>End_Function
34067>>>>>
34067>>>>>Function fsReadRegistryFEMRootDir Global Returns String
34068>>>>>    String rVal lsCurrentWksp
34069>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34072>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34075>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34077>>>>>
34077>>>>>    Append lsCurrentWksp "\FEM"
34078>>>>>
34078>>>>>    Get_Profile_String lsCurrentWksp "RootDir"  to rVal
34081>>>>>    Function_Return (Trim(rVal))
34082>>>>>End_Function
34083>>>>>
34083>>>>>Function fsReadRegistryFEMDevicePath Global Returns String
34084>>>>>    String rVal lsCurrentWksp
34085>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34088>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34091>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34093>>>>>    Append lsCurrentWksp "\FEM"
34094>>>>>    Get_Profile_String lsCurrentWksp "DevicePath"  to rVal
34097>>>>>    Function_Return (Trim(rVal))
34098>>>>>End_Function
34099>>>>>
34099>>>>>Function fig_Is_Admin Global Returns Integer
34100>>>>>    String sUser
34101>>>>>    Integer rVal
34101>>>>>    Get fsLoginUserID to sUser
34102>>>>>    Move (trim(sUser)) to sUser
34103>>>>>    Clear Users
34104>>>>>    Move sUser to Users.Login_ID
34105>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
34106>>>>>>
34106>>>>>    Move Users.Admin_Rights to rVal
34107>>>>>    Function_Return rVal
34108>>>>>End_Function
34109>>>>>
34109>>>>>Function fig_The_User_Group Global Returns Integer
34110>>>>>    String sUser
34111>>>>>    Get fsLoginUserID   to sUser
34112>>>>>    Move (trim(sUser))  to sUser
34113>>>>>    Clear Users
34114>>>>>    Move sUser          to Users.Login_ID
34115>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
34116>>>>>>
34116>>>>>    Clear UserGrps
34117>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
34118>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
34119>>>>>>
34119>>>>>    Function_Return UserGrps.Grp_ID
34120>>>>>End_Function
34121>>>>>
34121>>>>>Function fsg_The_User_Department Global Returns String
34122>>>>>    String sUser
34123>>>>>    Get fsLoginUserID   to sUser
34124>>>>>    Move (trim(sUser))  to sUser
34125>>>>>    Clear Users
34126>>>>>    Move sUser          to Users.Login_ID
34127>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
34128>>>>>>
34128>>>>>    Clear Departm
34129>>>>>    Move Users.Departm_Code   to Departm.Code
34130>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
34131>>>>>>
34131>>>>>    Function_Return Departm.Code
34132>>>>>End_Function
34133>>>>>
34133>>>>>
34133>>>>>Function fig_Is_Specific_Admin Global String asUser Returns Integer
34134>>>>>    Integer rVal
34135>>>>>    Move (trim(asUser)) to asUser
34136>>>>>    Clear Users
34137>>>>>    Move asUser to Users.Login_ID
34138>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
34139>>>>>>
34139>>>>>    Move Users.Admin_Rights to rVal
34140>>>>>    Function_Return rVal
34141>>>>>End_Function
34142>>>>>
34142>>>>>Function fig_The_Specific_User_Group Global String asUser Returns Integer
34143>>>>>    Move (trim(asUser))  to asUser
34144>>>>>    Clear Users
34145>>>>>    Move asUser          to Users.Login_ID
34146>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
34147>>>>>>
34147>>>>>    Clear UserGrps
34148>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
34149>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
34150>>>>>>
34150>>>>>    Function_Return UserGrps.Grp_ID
34151>>>>>End_Function
34152>>>>>
34152>>>>>Function fsg_The_Specific_User_Department Global String asUser Returns String
34153>>>>>    Move (trim(asUser))  to asUser
34154>>>>>    Clear Users
34155>>>>>    Move asUser          to Users.Login_ID
34156>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
34157>>>>>>
34157>>>>>    Clear Departm
34158>>>>>    Move Users.Departm_Code   to Departm.Code
34159>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
34160>>>>>>
34160>>>>>    Function_Return Departm.Code
34161>>>>>End_Function
34162>>>>>
34162>>>>>
34162>>>
34162>>>Class ViewPopupMenu_Sec Is A ViewPopupMenu
34163>>>
34163>>>    Open Sysfile
INCLUDING FILE: SYSFILE.FD
34165>>>    Open Users
34167>>>    Open Views
INCLUDING FILE: VIEWS.FD
34169>>>    Open GrpViews
INCLUDING FILE: GRPVIEWS.FD
34171>>>    Open GrpView0
INCLUDING FILE: GRPVIEW0.FD
34173>>>    Open Arxeia
34175>>>    Open GrpArx
34177>>>
34177>>>    Function Find_User_Rights_In_Class String asView Returns Integer
34178>>>        String  lsView lsLogin
34179>>>        Integer liUser  liViews iGroup
34179>>>
34179>>>        Move (fsLoginUserID())      to lsLogin
34180>>>        Move (Trim(ToOEM(asView)))  to lsView
34181>>>
34181>>>        //////  /////////////////////////////////////
34181>>>        Clear Users
34182>>>        Move lsLogin    to Users.Login_ID
34183>>>
34183>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
34184>>>>
34184>>>        If (Found=1)  Begin
34186>>>            Move Users.User_ID  to liUser
34187>>>            Move Users.Grp_ID   to iGroup
34188>>>        End
34188>>>>
34188>>>        Else Function_Return 0
34190>>>
34190>>>        Clear Views
34191>>>        Move (Trim(lsView)) to Views.Menu_Name
34192>>>        Find eq Views by Index.2 // Views:Index.2:Views.Menu_Name
34193>>>>
34193>>>        If (Found=1) Begin
34195>>>            Move Views.View_ID to liViews
34196>>>            Clear GrpViews
34197>>>            Move liUser    to GrpViews.User_ID
34198>>>            Move liViews   to GrpViews.View_ID
34199>>>            Find Eq GrpViews by Index.1 // GrpViews:Index.1:GrpViews.User_ID+GrpViews.View_ID
34200>>>>
34200>>>            If (Found=1) Begin // And (liUser=GrpViews.User_ID) And (liViews=GrpViews.View_ID)) Begin
34202>>>                Function_Return (GrpViews.Allow_Read<>'1')
34203>>>            End
34203>>>>
34203>>>            Else Begin
34204>>>                Clear GrpView0
34205>>>                Move iGroup    to GrpView0.Group_ID
34206>>>                Move liViews   to GrpView0.View_ID
34207>>>                Find eq GrpView0 by Index.1 // GrpView0:Index.1:Group_ID+View_ID
34208>>>>
34208>>>                If (Found=1) Begin
34210>>>                    Function_Return (GrpView0.Allow_Read<>'1')
34211>>>                End
34211>>>>
34211>>>                Else         Function_Return 0
34213>>>            End
34213>>>>
34213>>>        End
34213>>>>
34213>>>        Else Function_Return 0
34215>>>    End_Function
34216>>>
34216>>>//    Procedure Enhmerose_Views_File_In_Class
34216>>>//        Integer liCount liInt liLastNo
34216>>>//        String lsStr
34216>>>//        Get Item_Count to liCount
34216>>>//        // find last view_id
34216>>>//        Clear Views
34216>>>//        Move 9999 to Views.View_ID
34216>>>//        Find lt Views by index.1 // view_id
34216>>>//        If (Found=1)    Move Views.View_ID  to liLastNo
34216>>>//        Else            Move 0              to liLastNo
34216>>>//        For liInt From 0 to (liCount-1)
34216>>>//            Get Value item liInt to lsStr
34216>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
34216>>>//            //Move (Trim(lsStr)) to lsStr
34216>>>//            If (lsStr<>'') Begin
34216>>>//                Clear Views
34216>>>//                Move lsStr to Views.Menu_Name
34216>>>//                Find eq Views by index.2 // Views.Menu_Name
34216>>>//                If (NOT(Found)) Begin
34216>>>//                    Add 1 to liLastNo
34216>>>//                    Move liLastNo to Views.View_ID
34216>>>//                    Saverecord Views
34216>>>//                End
34216>>>//            End
34216>>>//        Loop
34216>>>//        For liInt From 0 to (liCount-1)
34216>>>//            Get Value item liInt to lsStr
34216>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
34216>>>//            //Move (Trim(lsStr)) to lsStr
34216>>>//            If (lsStr<>'') Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
34216>>>//        Loop
34216>>>//    End_procedure
34216>>>
34216>>>    Procedure OnInitMenu
34217>>>        Integer liCount liInt liLastNo
34218>>>        String lsStr
34218>>>
34218>>>        Get Item_Count to liCount
34219>>>
34219>>>        // find last view_id
34219>>>        Clear Views
34220>>>        Move 9999 to Views.View_ID
34221>>>        Find lt Views by index.1 // view_id
34222>>>>
34222>>>        If (Found=1)    Move Views.View_ID  to liLastNo
34225>>>        Else            Move 0              to liLastNo
34227>>>        For liInt From 0 to (liCount-1)
34233>>>>
34233>>>            Get Value item liInt to lsStr
34234>>>            Move (Trim(lsStr)) to lsStr
34235>>>            If ((lsStr<>'') and (Length(lsStr)>2)) Begin
34237>>>                Clear Views
34238>>>                Move (ToOEM(lsStr)) to Views.Menu_Name
34239>>>                Find eq Views by index.2 // Views.Menu_Name
34240>>>>
34240>>>                If (NOT(Found)) Begin
34242>>>                    Add 1 to liLastNo
34243>>>                    Move liLastNo to Views.View_ID
34244>>>                    //Move (ToOEM(lsStr)) to Views.Menu_Name
34244>>>                    Saverecord Views
34245>>>                End
34245>>>>
34245>>>            End
34245>>>>
34245>>>        Loop
34246>>>>
34246>>>        For liInt From 0 to (liCount-1)
34252>>>>
34252>>>            Get Value item liInt to lsStr
34253>>>            Move (Trim(lsStr)) to lsStr
34254>>>            Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
34255>>>        Loop
34256>>>>
34256>>>
34256>>>    End_procedure
34257>>>
34257>>>//    Procedure End_Construct_Object
34257>>>//        Forward Send End_Construct_Object
34257>>>//        Send Enhmerose_Views_File_In_Class
34257>>>//    End_Procedure
34257>>>
34257>>>End_Class //ButtonSub
34258>>>
34258>>>
34258>open bttmp1
INCLUDING FILE: BTTMP1.FD
34260>Use TranLock
INCLUDING FILE: TRANLOCK.PKG
34260>>>// Statement of purpose:
34260>>>// When using a reread command in VDF you will unfortunately lock many more
34260>>>// files than are necessary.  In order to only lock the files necessary I
34260>>>// use the following procedure to set all files to readonly, manually set
34260>>>// the files being worked on to (default) and then reset all back at the end.
34260>>>// This is what a data dictionary does in a VDF program for it's ddo tree.
34260>>>
34260>>>// The original package is a contribution of another programmer whom I cannot
34260>>>// remember their name (sorry).  The alteration I have done is to make sure that any file
34260>>>// with a non-default filemode will be set back to it's previous setting.
34260>>>
34260>>>Object FileModeArray Is An Array
34262>>>    // 0 = File Number
34262>>>    // 1 = Non-Default FileMode Existing Before Change By ChangeAllFileModes Procedure
34262>>>End_Object
34263>>>
34263>>>Procedure Write_Attribute_Array Integer iFile Integer iFileMode
34264>>>    Integer iCounter hArray iExists
34265>>>    Move (FileModeArray(Self)) To hArray
34266>>>    For iCounter From 0 To 1000
34272>>>>
34272>>>        Get Array_Value Of hArray Item ((iCounter * 2) + 0) To iExists
34273>>>        If (Not(iExists) Or (iExists = iFile)) Begin
34275>>>            Set Array_Value Of hArray Item ((iCounter * 2) + 0) To iFile
34276>>>            Set Array_Value Of hArray Item ((iCounter * 2) + 1) To iFileMode
34277>>>        End
34277>>>>
34277>>>        If (Not(iExists) Or (iExists = iFile)) Break
34280>>>    Loop
34281>>>>
34281>>>End_Procedure
34282>>>
34282>>>Procedure Clear_FileModeArray
34283>>>    Send Delete_Data To (FileModeArray(Self))
34284>>>End_Procedure
34285>>>
34285>>>Function Is_NonStandardFileMode Integer iFile Returns Integer
34286>>>    Integer iCounter iExists iNonStandardFileMode hArray
34287>>>    Move (FileModeArray(Self)) To hArray
34288>>>    For iCounter From 0 To 1000
34294>>>>
34294>>>        Get Array_Value Of hArray Item ((iCounter * 2) + 0) To iExists
34295>>>        If (Not(iExists)) Function_Return 0 // Not Listed In Array
34298>>>        If (iExists = iFile) Begin
34300>>>            Get Array_Value Of hArray Item ((iCounter * 2) + 1) To iNonStandardFileMode
34301>>>            Function_Return iNonStandardFileMode
34302>>>        End
34302>>>>
34302>>>    Loop
34303>>>>
34303>>>    Function_Return
34304>>>End_Function
34305>>>
34305>>>Procedure ChangeAllFileModes Integer iMode
34306>>>    Integer iFile iExistingFileMode iNonStandardFileMode
34307>>>    If (iMode = DF_FileMode_ReadOnly) Send Clear_FileModeArray
34310>>>    Repeat
34310>>>>
34310>>>        // Get Each Opened File, One At A Time...
34310>>>        Get_Attribute DF_File_Next_Opened Of iFile To iFile
34313>>>        If (Not(iFile)) Break
34316>>>        If (iMode = DF_Filemode_ReadOnly) Begin  // Setting All Files To Readonly: Check Alias Stuff
34318>>>            Get_Attribute DF_File_Mode Of iFile To iExistingFileMode
34321>>>            If (iExistingFileMode <> DF_Filemode_Default) Send Write_Attribute_Array iFile iExistingFileMode
34324>>>        End
34324>>>>
34324>>>        If (iMode = DF_Filemode_Default) Begin  // Setting All Files Back To Default
34326>>>            Get Is_NonStandardFileMode iFile To iNonStandardFileMode
34327>>>        End
34327>>>>
34327>>>        If (iNonStandardFileMode) Set_Attribute DF_File_Mode Of iFile To iNonStandardFileMode
34332>>>        Else                      Set_Attribute DF_File_Mode Of iFile To iMode
34336>>>    Loop
34337>>>>
34337>>>End_Procedure
34338>>>
34338>>>// // Comment: Example Of Usage:
34338>>>//    Send ChangeAllFileModes DF_Filemode_ReadOnly  // See Stark.Pkg for This Desktop Procedure
34338>>>// // Comment: Set All Open Files To ReadOnly Except For... (Files Used In Transaction Block)
34338>>>//    Set_Attribute DF_File_Mode Of MyFile1.File_Number To DF_Filemode_Default
34338>>>//    Set_Attribute DF_File_Mode Of MyFile2.File_Number  To DF_Filemode_Default
34338>>>//    Indicate Err False
34338>>>//    Begin_Transaction
34338>>>//
34338>>>//        Clear MyFile1
34338>>>//        Move 1 To MyFile1.Key
34338>>>//        Find EQ MyFile1 By Index.1
34338>>>//        Relate MyFile1
34338>>>//        Add MyFile2.Amount To MyFile1.Amount
34338>>>//        Saverecord MyFile1
34338>>>//        Saverecord MyFile2
34338>>>//        If (Condition) Error 300 "Error Message Here" // Saves Rolled Back
34338>>>//
34338>>>//    End_Transaction
34338>>>//    If (Err) Begin
34338>>>//        Send Info_Box "Errors Were Encountered: No Files Were Altered By This Process (All Changes Rolled Back)"
34338>>>//    End
34338>>>//    Send ChangeAllFileModes DF_Filemode_Default  // Set FileModes Back From Readonly To Normal
34338>Use GridUtil.Utl
INCLUDING FILE: GRIDUTIL.UTL
34338>>>// Use GridUtil.utl // Grid and List utilities
34338>>>
34338>>>//> This package provides a number of functions working on objects of the
34338>>>//> Grid class (VDF) and List class (character mode DF). On the other hand
34338>>>//> it does not work with dbGrid (VDF) class or Table classes (character
34338>>>//> mode DF).
34338>>>//>
34338>>>//> Rather than having these function inplemented in a subclass of the
34338>>>//> Grid- or List classes I have made global functions and procedures
34338>>>//> that all takes the objects ID as the first parameter.
34338>>>//>
34338>>>//> To sort the contents of a grid by the contents of column column# use:
34338>>>//>
34338>>>//>    procedure Grid_SortByColumn global integer oGrd# integer column#
34338>>>//>
34338>>>//> The set the entry_state of all items in a grid in one go use:
34338>>>//>
34338>>>//>    procedure Grid_SetEntryState global integer obj# integer st#
34338>>>//>
34338>>>//> To figure out the number of the first item in the current row use:
34338>>>//>
34338>>>//>    function Grid_BaseItem global integer obj# returns integer
34338>>>//>
34338>>>//> To figure out the current column use:
34338>>>//>
34338>>>//>    function Grid_CurrentColumn global integer obj# returns integer
34338>>>//>
34338>>>//> And finally, to figure out the number of columns use:
34338>>>//>
34338>>>//>    function Grid_Columns global integer obj# returns integer
34338>>>//>
34338>>>
34338>>>Use Base.utl     // Item_Property command, Various macros (FOR_EX...), cArray, cSet and cStack classes
INCLUDING FILE: BASE.UTL
34338>>>>>// Use Base.utl     // Item_Property command, Various macros (FOR_EX...), cArray, cSet and cStack classes
34338>>>>>
34338>>>>>// This purpose of this package is to relieve me of having to remember which
34338>>>>>// package exactly holds a particular command or class.
34338>>>>>
34338>>>>>Use Array.utl    // Item_Property command
INCLUDING FILE: ARRAY.UTL
34338>>>>>>>// Use Array.utl    // Item_Property command
34338>>>>>>>
34338>>>>>>>// This package defines three commands ITEM_PROPERTY_LIST, ITEM_PROPERTY
34338>>>>>>>// and END_ITEM_PROPERTY_LIST. They should be used like this:
34338>>>>>>>//
34338>>>>>>>//          object oTest is an Array
34338>>>>>>>//            item_property_list
34338>>>>>>>//              item_property string  pItem_Label
34338>>>>>>>//              item_property integer pItem_Type
34338>>>>>>>//              item_property string  pItem_Default
34338>>>>>>>//            end_item_property_list // IF IN CLASS REPEAT CLASS NAME HERE!
34338>>>>>>>//          end_object
34338>>>>>>>//
34338>>>>>>>// You will now be able to write code like:
34338>>>>>>>//
34338>>>>>>>//          set pItem_Label   item 2 to "Amazing"
34338>>>>>>>//          get pItem_Default item 0 to sVar
34338>>>>>>>//
34338>>>>>>>// Note that you do not need to sub-class the array in order to fo this.
34338>>>>>>>// The ITEM_PROPERTY command structure simply defines a number of messages
34338>>>>>>>// that lets you set the values of the array using your own names.
34338>>>>>>>//
34338>>>>>>>// In a normal array you may get the number of items by using the Item_Count
34338>>>>>>>// function. Of course you may still do that, but you would more likely
34338>>>>>>>// want to retrieve the number of 'rows' currently in the array. For this
34338>>>>>>>// purpose the END_ITEM_PROPERTY_LIST command defines a function called
34338>>>>>>>// Row_Count.
34338>>>>>>>//
34338>>>>>>>// In an empty array the Row_Count function returns 0 (surprise). Having
34338>>>>>>>// set just one of the values of the 1'st row (row number 0) the Row_Count
34338>>>>>>>// function will return 1.
34338>>>>>>>//
34338>>>>>>>// If you want to define item_properties as part of a class definition
34338>>>>>>>// you should NOT define them inside procedure construct_object as you
34338>>>>>>>// would with normal properties. Instead it looks like this:
34338>>>>>>>//
34338>>>>>>>//          class cTest is an Array
34338>>>>>>>//            item_property_list
34338>>>>>>>//              item_property string  pItem_Label
34338>>>>>>>//              item_property integer pItem_Type
34338>>>>>>>//              item_property string  pItem_Default
34338>>>>>>>//            end_item_property_list cTest // NOTE: Class name as parameter!
34338>>>>>>>//          end_class
34338>>>>>>>
34338>>>>>>>use ui
34338>>>>>>>
34338>>>>>>>Enumeration_List // Symbols used internally by the item_property command
34338>>>>>>>  define EA$INTEGER
34338>>>>>>>  define EA$STRING
34338>>>>>>>  define EA$REAL
34338>>>>>>>  define EA$NUMBER
34338>>>>>>>  define EA$DATE
34338>>>>>>>End_Enumeration_List
34338>>>>>>>
34338>>>>>>>
34338>>>>>>>
34338>>>>>>>
34338>>>>>>>
34338>>>>>>>
34338>>>>>>>
34338>>>>>>>
34338>>>>>>>
34338>>>>>>>
34338>>>>>>>procedure Clone_Array global integer source# integer target#
34339>>>>>>>  local integer itm# max#
34340>>>>>>>  move (item_count(source#)) to max#
34341>>>>>>>  send delete_data to target#
34342>>>>>>>  for itm# from 0 to (max#-1)
34348>>>>>>>>
34348>>>>>>>    set value of target# item itm# to (value(source#,itm#))
34349>>>>>>>  loop
34350>>>>>>>>
34350>>>>>>>end_procedure
34351>>>>>Use Macros.utl   // Various macros (FOR_EX...)
34351>>>>>Use Set.utl      // cArray, cSet and cStack classes
INCLUDING FILE: SET.UTL
34351>>>>>>>// Use Set.utl      // cArray, cSet and cStack classes
34351>>>>>>>
34351>>>>>>>use ui
34351>>>>>>>Use DestObj.pkg  // DAW - Defines request_destroy_object
34351>>>>>>>
34351>>>>>>>class cArray is an Array
34352>>>>>>>  procedure construct_object integer img#
34353>>>>>>>    forward send construct_object img#
34355>>>>>>>    set delegation_mode to delegate_to_parent
34356>>>>>>>  end_procedure
34357>>>>>>>end_class // cArray
34358>>>>>>>
34358>>>>>>>class cArray2d is a cArray
34359>>>>>>>  function iObjectID.i integer x# returns integer
34360>>>>>>>    local integer obj#
34361>>>>>>>    get value item x# to obj#
34362>>>>>>>    ifnot obj# begin
34364>>>>>>>      object oArray2d is a cArray no_image
34366>>>>>>>        move current_object to obj#
34367>>>>>>>      end_object
34368>>>>>>>      set value item x# to obj#
34369>>>>>>>    end
34369>>>>>>>>
34369>>>>>>>    function_return obj#
34370>>>>>>>  end_function
34371>>>>>>>  procedure set Value.ii integer x# integer y# string value#
34372>>>>>>>    local integer obj#
34373>>>>>>>    get iObjectID.i x# to obj#
34374>>>>>>>    set value of obj# item y# to value#
34375>>>>>>>  end_procedure
34376>>>>>>>  function Value.ii integer x# integer y# returns string
34377>>>>>>>    local integer obj#
34378>>>>>>>    get value item x# to obj#
34379>>>>>>>    if obj# function_return (value(obj#,y#))
34382>>>>>>>    function_return 0
34383>>>>>>>  end_function
34384>>>>>>>  procedure reset
34385>>>>>>>    local integer itm# max# obj#
34386>>>>>>>    get item_count to max#
34387>>>>>>>    for itm# from 0 to (max#-1)
34393>>>>>>>>
34393>>>>>>>      get value item itm# to obj#
34394>>>>>>>      if obj# send request_destroy_object to obj#
34397>>>>>>>    loop
34398>>>>>>>>
34398>>>>>>>    send delete_data
34399>>>>>>>  end_procedure
34400>>>>>>>end_class // cArray2d
34401>>>>>>>
34401>>>>>>>class cArray3d is a cArray2d
34402>>>>>>>  function iObjectID.ii integer x# integer y# returns integer
34403>>>>>>>    local integer obj#
34404>>>>>>>    get Value.ii x# y# to obj#
34405>>>>>>>    ifnot obj# begin
34407>>>>>>>      object oArray3d is a cArray no_image
34409>>>>>>>        move current_object to obj#
34410>>>>>>>      end_object
34411>>>>>>>      set Value.ii x# y# to obj#
34412>>>>>>>    end
34412>>>>>>>>
34412>>>>>>>    function_return obj#
34413>>>>>>>  end_function
34414>>>>>>>  procedure set Value.iii integer x# integer y# integer z# string value#
34415>>>>>>>    local integer obj#
34416>>>>>>>    get iObjectID.ii x# y# to obj#
34417>>>>>>>    set value of obj# item z# to value#
34418>>>>>>>  end_procedure
34419>>>>>>>  function Value.iii integer x# integer y# integer z# returns string
34420>>>>>>>    local integer obj#
34421>>>>>>>    get value item x# to obj#
34422>>>>>>>    if obj# begin
34424>>>>>>>      get value of obj# item y# to obj#
34425>>>>>>>      if obj# function_return (value(obj#,z#))
34428>>>>>>>    end
34428>>>>>>>>
34428>>>>>>>    function_return 0
34429>>>>>>>  end_function
34430>>>>>>>  procedure reset
34431>>>>>>>    local integer xmax# ymax# x# y# yobj# zobj#
34432>>>>>>>    get item_count to xmax#
34433>>>>>>>    for x# from 0 to (xmax#-1)
34439>>>>>>>>
34439>>>>>>>      get value item x# to yobj#
34440>>>>>>>      if yobj# begin
34442>>>>>>>        get item_count of yobj# to ymax#
34443>>>>>>>        for y# from 0 to (ymax#-1)
34449>>>>>>>>
34449>>>>>>>          get value of yobj# item y# to zobj#
34450>>>>>>>          if zobj# send request_destroy_object to zobj#
34453>>>>>>>        loop
34454>>>>>>>>
34454>>>>>>>      end
34454>>>>>>>>
34454>>>>>>>    loop
34455>>>>>>>>
34455>>>>>>>    forward send reset
34457>>>>>>>  end_procedure
34458>>>>>>>end_class // cArray3d
34459>>>>>>>
34459>>>>>>>class cSet is an cArray
34460>>>>>>>  function element_find string sVar returns integer
34461>>>>>>>    local integer max# itm#
34462>>>>>>>    get item_count to max#
34463>>>>>>>    move 0 to itm#
34464>>>>>>>    while itm# lt max#
34468>>>>>>>      if sVar eq (value(current_object,itm#)) function_return itm# // Dirty exit
34471>>>>>>>      increment itm#
34472>>>>>>>    end
34473>>>>>>>>
34473>>>>>>>    function_return -1
34474>>>>>>>  end_function
34475>>>>>>>
34475>>>>>>>  procedure element_add string sVar
34476>>>>>>>    if (element_find(current_object,sVar)=-1) set value item (item_count(current_object)) to sVar
34479>>>>>>>  end_procedure
34480>>>>>>>
34480>>>>>>>  procedure element_remove string sVar
34481>>>>>>>    local integer itm#
34482>>>>>>>    get element_find sVar to itm#
34483>>>>>>>    if itm# ge 0 send delete_item itm#
34486>>>>>>>  end_procedure
34487>>>>>>>
34487>>>>>>>  function iAddOrFind_Element string sVar returns integer
34488>>>>>>>    local integer rval#
34489>>>>>>>    get element_find sVar to rval#
34490>>>>>>>    if rval# eq -1 begin
34492>>>>>>>      get item_count to rval#
34493>>>>>>>      set value item rval# to sVar
34494>>>>>>>    end
34494>>>>>>>>
34494>>>>>>>    function_return rval#
34495>>>>>>>  end_function
34496>>>>>>>
34496>>>>>>>//// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
34496>>>>>>>//// Original procedures (optimized) are mentioned for compatibility:
34496>>>>>>>//
34496>>>>>>>//function find_element string sVar returns integer
34496>>>>>>>//  local integer max# itm#
34496>>>>>>>//  get item_count to max#
34496>>>>>>>//  move 0 to itm#
34496>>>>>>>//  while itm# lt max#
34496>>>>>>>//    if sVar eq (value(current_object,itm#)) function_return itm# // Dirty exit
34496>>>>>>>//    increment itm#
34496>>>>>>>//  end
34496>>>>>>>//  function_return -1
34496>>>>>>>//end_function
34496>>>>>>>//
34496>>>>>>>//procedure Add_Element string sVar returns integer
34496>>>>>>>//  local integer rval#
34496>>>>>>>//  get find_element sVar to rval#
34496>>>>>>>//  if rval# lt 0 get item_count to rval#
34496>>>>>>>//  set array_value item rval# to sVar
34496>>>>>>>//  procedure_return rval#
34496>>>>>>>//end_procedure
34496>>>>>>>//
34496>>>>>>>//procedure Remove_Element string sVar
34496>>>>>>>//  local integer itm#
34496>>>>>>>//  get Find_Element item sVar to itm#
34496>>>>>>>//  if itm# gt -1 send delete_item itm#
34496>>>>>>>//end_procedure
34496>>>>>>>//// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
34496>>>>>>>end_class
34497>>>>>>>
34497>>>>>>>class cStack is an cArray
34498>>>>>>>  function Stack_Empty returns integer
34499>>>>>>>    function_return (item_count(current_object)=0)
34500>>>>>>>  end_function
34501>>>>>>>  // *** Integer interface **************************************
34501>>>>>>>  procedure Push.i integer value#
34502>>>>>>>    set value item (item_count(current_object)) to value#
34503>>>>>>>  end_procedure
34504>>>>>>>  function iPop returns integer
34505>>>>>>>    local integer rval# itm#
34506>>>>>>>    move (item_count(current_object)-1) to itm#
34507>>>>>>>    get value item itm# to rval#
34508>>>>>>>    send delete_item itm#
34509>>>>>>>    function_return rval#
34510>>>>>>>  end_function
34511>>>>>>>  function iCopy returns integer
34512>>>>>>>    function_return (value(current_object,item_count(current_object)-1))
34513>>>>>>>  end_function
34514>>>>>>>  // *** String interface ***************************************
34514>>>>>>>  procedure Push.s string value#
34515>>>>>>>    set value item (item_count(current_object)) to value#
34516>>>>>>>  end_procedure
34517>>>>>>>  function sPop returns string
34518>>>>>>>    local integer itm#
34519>>>>>>>    local string rval#
34519>>>>>>>    move (item_count(current_object)-1) to itm#
34520>>>>>>>    get value item itm# to rval#
34521>>>>>>>    send delete_item itm#
34522>>>>>>>    function_return rval#
34523>>>>>>>  end_function
34524>>>>>>>  function sCopy returns string
34525>>>>>>>    function_return (value(current_object,item_count(current_object)-1))
34526>>>>>>>  end_function
34527>>>>>>>end_class
34528>>>>>
34528>>>Use Strings.utl  // String manipulation for VDF and 3.1
INCLUDING FILE: STRINGS.UTL
34528>>>>>// **********************************************************************
34528>>>>>// Use Strings.utl  // String manipulation for VDF and 3.1
34528>>>>>//
34528>>>>>// By Sture Andersen
34528>>>>>//
34528>>>>>// The file contains a number of global functions for manipulating
34528>>>>>// strings and converting numbers to strings. The package may be used
34528>>>>>// with DataFlex 3.1 and Visual DataFlex. This package is public domain.
34528>>>>>//
34528>>>>>//
34528>>>>>// Create: Fri  23-05-1997 - Merger of s_utl002, 006.
34528>>>>>// Update: Tue  25-08-1997 - Introduced fixes from Magnus Bergh
34528>>>>>//         Sun  14-12-1997 - Added the following functions:
34528>>>>>//                             ExtractWord           ExtractInteger
34528>>>>>//                             HowManyWords          HowManyIntegers
34528>>>>>//                             ExtractItemNeg        IsIntegerPresent
34528>>>>>//         Tue  31-03-1998 - Added the following functions:
34528>>>>>//                             Text_RemoveTrailingCr Text_CompressSubstCr
34528>>>>>//                             Text_RTrim            Text_Format.sii
34528>>>>>//                             Text_Trim             Text_FormattedLine.i
34528>>>>>//                             Text_Compress
34528>>>>>//         Fri  06-11-1998 - Added function InsertThousandsSep
34528>>>>>//         Sun  14-02-1999 - Added function Byte_ToHex
34528>>>>>//         Wed  27-04-1999 - Added function CurrentDecimalSeparator
34528>>>>>//
34528>>>>>// ***********************************************************************
34528>>>>>
34528>>>>>// Returns the string of length len# inside which src# is right justified:
34528>>>>>Function RightShift global string src# integer len# returns string
34529>>>>>  trim src# to src#
34530>>>>>>
34530>>>>>  if (length(src#)) lt len# insert (left(pad("",len#),len#-length(src#))) in src# at 1
34534>>>>>  function_return (left(src#,len#))
34535>>>>>End_Function
34536>>>>>
34536>>>>>// Returns the string of length len# inside which src# is centered:
34536>>>>>Function CenterString global string src# integer len# returns string
34537>>>>>  trim src# to src#
34538>>>>>>
34538>>>>>  if (length(src#)) lt len# insert (left(pad("",len#),len#-length(src#)/2)) in src# at 1
34542>>>>>  function_return (left(src#,len#))
34543>>>>>End_Function
34544>>>>>
34544>>>>>// Returns all characters to the right of position pos# (including the character at
34544>>>>>// posistion pos#)
34544>>>>>Function RightFromPos global string str# integer pos# returns string
34545>>>>>  function_return (right(str#,length(str#)-pos#+1))
34546>>>>>End_Function
34547>>>>>
34547>>>>>// Number converting functions:
34547>>>>>
34547>>>>>integer NumToStringConversionMode#
34547>>>>>
34547>>>>>move NUMTOSTR_THOUSANDS_SEPARATOR_OFF to NumToStringConversionMode#
34548>>>>>
34548>>>>>procedure set pNumToStringConversionMode integer value#
34549>>>>>  move value# to NumToStringConversionMode#
34550>>>>>end_procedure
34551>>>>>
34551>>>>>function InsertThousandsSep global string str# returns string
34552>>>>>  local integer pos# tmp#
34553>>>>>  local string sep#
34553>>>>>  trim str# to str#
34554>>>>>>
34554>>>>>  get_attribute DF_DECIMAL_SEPARATOR to pos#
34557>>>>>  character pos# to sep#
34558>>>>>>
34558>>>>>  move (pos(sep#,str#)) to pos#
34559>>>>>  ifnot pos# move (length(str#)+1) to pos#
34562>>>>>  get_attribute DF_THOUSANDS_SEPARATOR to tmp#
34565>>>>>  character tmp# to sep# // End overload
34566>>>>>>
34566>>>>>  while pos# gt 4
34570>>>>>    move (pos#-3) to pos#
34571>>>>>    insert sep# in str# at pos#
34573>>>>>  loop
34574>>>>>>
34574>>>>>  function_return str#
34575>>>>>end_function
34576>>>>>
34576>>>>>// Calling the function below will convert the number stored in src# to a
34576>>>>>// string containing dcp# decimals rounding excess decimals. Parameter dcp#
34576>>>>>// may be negative. The expression (NumToStr(1789,-3)) will evaluate to "2000".
34576>>>>>// The functions in this package all respects the value of global attribute
34576>>>>>// DF_DECIMAL_SEPARATOR.
34576>>>>>Function NumToStr global number src# integer dcp# returns string
34577>>>>>  local integer pos#
34578>>>>>  local string rval# radix#
34578>>>>>  if dcp# lt 0 function_return (NumToStr(src#*(10^dcp#),0)+left("00000000",-dcp#))
34581>>>>>  if src# ge 0 move (src#+(0.5/(10^dcp#))) to src#
34584>>>>>  else move (src#-(0.5/(10^dcp#))) to src#
34586>>>>>  get_attribute DF_DECIMAL_SEPARATOR to pos# // Overload
34589>>>>>  character pos# to radix# // End overload
34590>>>>>>
34590>>>>>  move src# to rval#
34591>>>>>  ifnot (pos(radix#,rval#)) append rval# radix#
34594>>>>>
34594>>>>>  append rval# "00000000"
34595>>>>>
34595>>>>>  move (pos(radix#,rval#)) to pos#
34596>>>>>  if dcp# eq 0 decrement pos#
34599>>>>>  move (left(rval#,pos#+dcp#)) to rval#
34600>>>>>  if NumToStringConversionMode# move (InsertThousandsSep(rval#)) to rval#
34603>>>>>  function_return rval#
34604>>>>>End_Function
34605>>>>>
34605>>>>>// This function is the same as NumToStr except that you have to specify
34605>>>>>// the length of the target string (len#). The number will be right
34605>>>>>// justified accordingly. Post-fix `R' means right justify:
34605>>>>>Function NumToStrR global number src# integer dcp# integer len# returns string
34606>>>>>  function_return (RightShift(NumToStr(src#,dcp#),len#))
34607>>>>>End_Function
34608>>>>>
34608>>>>>// This function is the same as NumToStrR except that you do not specify
34608>>>>>// the number of decimals:
34608>>>>>Function IntToStrR global number src# integer len# returns string
34609>>>>>  function_return (NumToStrR(src#,0,len#)) // Fixed, Magnus Bergh
34610>>>>>End_Function
34611>>>>>
34611>>>>>// Is the same as IntToStrR, except that leading blanks are substituted
34611>>>>>// for leading zeros (zf=zero fill):
34611>>>>>Function IntToStrRzf global number src# integer len# returns string
34612>>>>>  function_return (replaces(" ",NumToStrR(src#,0,len#),"0")) // Fixed, Magnus Bergh
34613>>>>>End_Function
34614>>>>>
34614>>>>>// Use this to obtain the number of the least significant "non zero
34614>>>>>// decimal in src#. 0.702 will return 3 while 100 will return -2:
34614>>>>>Function NumberOfDecs global number src# returns integer
34615>>>>>  local integer count#
34616>>>>>  local string tmp# radix#
34616>>>>>  if src# eq 0 function_return 0 // Special case
34619>>>>>  move src# to tmp# // This removes superflous decimals
34620>>>>>  get_attribute DF_DECIMAL_SEPARATOR to count# // Overload
34623>>>>>  character count# to radix# // End overload
34624>>>>>>
34624>>>>>  if radix# in src# function_return (length(tmp#)-pos(radix#,tmp#))
34627>>>>>  move 0 to count#
34628>>>>>  while (right(tmp#,1)="0")
34632>>>>>    move (left(tmp#,length(tmp#)-1)) to tmp#
34633>>>>>    decrement count#
34634>>>>>  end
34635>>>>>>
34635>>>>>  function_return count#
34636>>>>>End_Function
34637>>>>>
34637>>>>>function CurrentDecimalSeparator global returns string
34638>>>>>  local integer rval#
34639>>>>>  get_attribute DF_DECIMAL_SEPARATOR to rval#
34642>>>>>  function_return (character(rval#))
34643>>>>>end_function
34644>>>>>
34644>>>>>
34644>>>>>// StripFromLastOccurance takes two strings (src# and val#) as
34644>>>>>// arguments. src# is scanned backwards for occurrances of substring
34644>>>>>// val#. If found, the function will return a string equal to src#
34644>>>>>// truncated at the first character of the right most occurance of substring
34644>>>>>// val#.
34644>>>>>//
34644>>>>>// StripFromLastOccurance("To be or not to be...","be") = "To be or not to "
34644>>>>>// StripFromLastOccurance("Mary had a little lamb","white") = ""
34644>>>>>// StripFromLastOccurance("Mary had a little lamb","") = "Mary had a little lamb"
34644>>>>>//
34644>>>>>Function StripFromLastOccurance global string src# string val# returns string
34645>>>>>  local integer len# search_len#
34646>>>>>  local string tmp#
34646>>>>>  length val# to search_len#
34647>>>>>>
34647>>>>>  if search_len# eq 0 function_return src#
34650>>>>>  repeat
34650>>>>>>
34650>>>>>    length src# to len#
34651>>>>>>
34651>>>>>    if len# le search_len# function_return ""
34654>>>>>    move (right(src#,search_len#)) to tmp#
34655>>>>>    if tmp# eq val# function_return (left(src#,len#-search_len#))
34658>>>>>    move (left(src#,len#-1)) to src#
34659>>>>>  loop
34660>>>>>>
34660>>>>>End_Function
34661>>>>>
34661>>>>>Function GetFromLastOccurance global string src# string val# returns string
34662>>>>>  function_return (replace(StripFromLastOccurance(src#,val#),src#,""))
34663>>>>>End_Function
34664>>>>>
34664>>>>>// (ExtractWord("item1 item2"," ",0)) = ""
34664>>>>>// (ExtractWord("item1 item2"," ",1)) = "item1"
34664>>>>>// (ExtractWord("item1 item2"," ",2)) = "item2"
34664>>>>>// (ExtractWord("item1 item2"," ",3)) = ""
34664>>>>>// (ExtractWord(" item1 item2 "," ",x)) =
34664>>>>>//                       (ExtractWord("item1 item2"," ",x))
34664>>>>>//
34664>>>>>                         //        source     delimiters  item number
34664>>>>>Function ExtractWord global string src# string dlm# integer itm# returns string
34665>>>>>  local integer count# pos# in_item# len#
34666>>>>>  local string rval# atom#
34666>>>>>  move "" to rval#
34667>>>>>  move 0 to count#
34668>>>>>  move 0 to in_item#
34669>>>>>  move (length(src#)) to len#
34670>>>>>  for pos# from 1 to len#
34676>>>>>>
34676>>>>>    mid src# to atom# 1 pos#
34679>>>>>>
34679>>>>>    if in_item# begin
34681>>>>>      if atom# in dlm# move 0 to in_item#
34684>>>>>      else if count# eq itm# append rval# atom#
34688>>>>>    end
34688>>>>>>
34688>>>>>    else begin
34689>>>>>      ifnot atom# in dlm# begin
34691>>>>>        increment count#
34692>>>>>        move 1 to in_item#
34693>>>>>        if count# eq itm# move atom# to rval#
34696>>>>>      end
34696>>>>>>
34696>>>>>    end
34696>>>>>>
34696>>>>>  loop
34697>>>>>>
34697>>>>>  function_return rval#
34698>>>>>End_Function
34699>>>>>Function ExtractItem global string src# string dlm# integer itm# returns string
34700>>>>>  Function_Return (ExtractWord(src#,dlm#,itm#))
34701>>>>>End_Function
34702>>>>>                          //        source     delimiters
34702>>>>>Function HowManyWords global string src# string dlm# returns integer
34703>>>>>  local integer count# pos# in_item# len#
34704>>>>>  local string atom#
34704>>>>>  move 0 to count#
34705>>>>>  move 0 to in_item#
34706>>>>>  move (length(src#)) to len#
34707>>>>>  for pos# from 1 to len#
34713>>>>>>
34713>>>>>    mid src# to atom# 1 pos#
34716>>>>>>
34716>>>>>    if in_item# begin
34718>>>>>      if atom# in dlm# move 0 to in_item#
34721>>>>>    end
34721>>>>>>
34721>>>>>    else begin
34722>>>>>      ifnot atom# in dlm# begin
34724>>>>>        increment count#
34725>>>>>        move 1 to in_item#
34726>>>>>      end
34726>>>>>>
34726>>>>>    end
34726>>>>>>
34726>>>>>  loop
34727>>>>>>
34727>>>>>  function_return count#
34728>>>>>end_function
34729>>>>>Function HowManyItems global string src# string dlm# returns integer
34730>>>>>  function_return (HowManyWords(src#,dlm#))
34731>>>>>End_Function
34732>>>>>                            //        source     legal char  item number
34732>>>>>function ExtractItemNeg global string src# string lch# integer itm# returns string
34733>>>>>  local integer count# pos# in_item? len#
34734>>>>>  local string rval# atom#
34734>>>>>  move "" to rval#
34735>>>>>  move 0 to count#
34736>>>>>  move 0 to in_item?
34737>>>>>  move (length(src#)) to len#
34738>>>>>  for pos# from 1 to len#
34744>>>>>>
34744>>>>>    mid src# to atom# 1 pos#
34747>>>>>>
34747>>>>>    if in_item? begin
34749>>>>>      ifnot atom# in lch# move 0 to in_item?
34752>>>>>      else if count# eq itm# append rval# atom#
34756>>>>>    end
34756>>>>>>
34756>>>>>    else begin
34757>>>>>      if atom# in lch# begin
34759>>>>>        increment count#
34760>>>>>        move 1 to in_item?
34761>>>>>        if count# eq itm# move atom# to rval#
34764>>>>>      end
34764>>>>>>
34764>>>>>    end
34764>>>>>>
34764>>>>>  loop
34765>>>>>>
34765>>>>>  function_return rval#
34766>>>>>end_function
34767>>>>>
34767>>>>>// ExtractInteger("123 456 789",0) = 0
34767>>>>>// ExtractInteger("123 456 789",2) = 456
34767>>>>>// ExtractInteger("123 456 789",4) = 0
34767>>>>>
34767>>>>>function ExtractInteger global string str# integer itm# returns integer
34768>>>>>  function_return (integer(ExtractItemNeg(str#,"0123456789",itm#)))
34769>>>>>end_function
34770>>>>>
34770>>>>>function HowManyIntegers global string str# returns integer
34771>>>>>  local integer rval# pos# len# in_int?
34772>>>>>  move 0 to in_int? //in integer?
34773>>>>>  move 0 to rval#
34774>>>>>  move (length(str#)) to len#
34775>>>>>  for pos# from 1 to len#
34781>>>>>>
34781>>>>>    if (mid(str#,1,pos#)) in "0123456789" begin
34783>>>>>      ifnot in_int? begin
34785>>>>>        increment rval#
34786>>>>>        move 1 to in_int?
34787>>>>>      end
34787>>>>>>
34787>>>>>    end
34787>>>>>>
34787>>>>>    else if in_int? move 0 to in_int?
34791>>>>>  loop
34792>>>>>>
34792>>>>>  function_return rval#
34793>>>>>end_function
34794>>>>>
34794>>>>>function IsIntegerPresent global string str# integer int# returns integer
34795>>>>>  local integer max# itm#
34796>>>>>  if str# eq "" function_return 0
34799>>>>>  move (HowManyIntegers(str#)) to max#
34800>>>>>  for itm# from 1 to max#
34806>>>>>>
34806>>>>>    if (ExtractInteger(str#,itm#)=int#) function_return 1
34809>>>>>  loop
34810>>>>>>
34810>>>>>  function_return 0
34811>>>>>end_function
34812>>>>>
34812>>>>>function AddIntegerToString global string str# integer int# returns string
34813>>>>>  function_return (trim(str#+" "+string(int#)))
34814>>>>>end_function
34815>>>>>
34815>>>>>// This function is used to compose a new string from an existing string. This
34815>>>>>// is similar to the way Windows 95 generates 8.3 file names.
34815>>>>>
34815>>>>>//    For example:    StringIncrementId("STURE",8) = "STURE ~1"
34815>>>>>//                    StringIncrementId("STURE ~1",8) = "STURE ~2"
34815>>>>>//                    StringIncrementId("STURE ~2",8) = "STURE ~3"
34815>>>>>//                    etc...
34815>>>>>function StringIncrementId global string id# integer len# returns string
34816>>>>>  local string char#
34817>>>>>  if (mid(id#,1,len#-1)) eq "~" begin
34819>>>>>    move (mid(id#,1,len#)) to char#
34820>>>>>    if (ascii(char#)) lt 93 function_return (overstrike(character(ascii(char#)+1),id#,len#))
34823>>>>>    else function_return ""
34825>>>>>  end
34825>>>>>>
34825>>>>>  function_return (overstrike("~1",id#,len#-1))
34826>>>>>end_function
34827>>>>>
34827>>>>>function StringUppercaseFirstLetters global string str# returns string
34828>>>>>  local integer len# pos# in_word#
34829>>>>>  local string rval# char#
34829>>>>>  move (lowercase(Str#)) to str#
34830>>>>>  move (length(str#)) to len#
34831>>>>>  move 0 to in_word#
34832>>>>>  for pos# from 1 to len#
34838>>>>>>
34838>>>>>    move (mid(str#,1,pos#)) to char#
34839>>>>>    if char# eq "" move 0 to in_word#
34842>>>>>    else begin
34843>>>>>      ifnot in_word# begin
34845>>>>>        uppercase char# to char#
34846>>>>>>
34846>>>>>        move 1 to in_word#
34847>>>>>      end
34847>>>>>>
34847>>>>>    end
34847>>>>>>
34847>>>>>    move (rval#+char#) to rval#
34848>>>>>  loop
34849>>>>>>
34849>>>>>  function_return rval#
34850>>>>>end_function
34851>>>>>
34851>>>>>function StringLeftBut global string str# integer but# returns string
34852>>>>>  function_return (left(str#,length(str#)-but#))
34853>>>>>end_function
34854>>>>>function StringRightBut global string str# integer but# returns string
34855>>>>>  function_return (right(str#,length(str#)-but#))
34856>>>>>end_function
34857>>>>>
34857>>>>>function StringConsistsOf global string src# string tpl# returns integer
34858>>>>>  local integer count# len#
34859>>>>>  trim src# to src#
34860>>>>>>
34860>>>>>  move (length(src#)) to len#
34861>>>>>  for count# from 1 to len#
34867>>>>>>
34867>>>>>    ifnot (mid(src#,1,count#)) in tpl# function_return 0
34870>>>>>  loop
34871>>>>>>
34871>>>>>  function_return 1
34872>>>>>end_function
34873>>>>>
34873>>>>>function RemoveDblBlanks global string str# returns string
34874>>>>>  local integer fin#
34875>>>>>  move 0 to fin#
34876>>>>>  repeat
34876>>>>>>
34876>>>>>    move (replaces("  ",str#," ")) to str#
34877>>>>>    ifnot "  " in str# move 1 to fin#
34880>>>>>  until fin#
34882>>>>>  function_return str#
34883>>>>>end_function
34884>>>>>
34884>>>>>function Byte_ToHex global integer byte# returns string
34885>>>>>  function_return (mid("0123456789ABCDEF",1,byte#/16+1)+mid("0123456789ABCDEF",1,byte# iand 15+1))
34886>>>>>end_function
34887>>>>>
34887>>>>>function Text_RemoveTrailingCr global string str# returns string
34888>>>>>  local integer fin# char#
34889>>>>>  move 0 to fin#
34890>>>>>  repeat
34890>>>>>>
34890>>>>>    if str# eq "" function_return ""
34893>>>>>    if (right(str#,1)=character(10) or right(str#,1)=" " or right(str#,1)=character(13)) move (left(str#,(length(str#)-1))) to str#
34896>>>>>    else move 1 to fin#
34898>>>>>  until fin#
34900>>>>>  function_return str#
34901>>>>>end_function
34902>>>>>
34902>>>>>function Text_RTrim global string str# returns string
34903>>>>>  move (rtrim(replaces(character(255),str#," "))) to str#
34904>>>>>  function_return (Text_RemoveTrailingCr(str#))
34905>>>>>end_function
34906>>>>>
34906>>>>>function Text_Trim global string str# returns string
34907>>>>>  move (trim(replaces(character(255),str#," "))) to str#
34908>>>>>  function_return (Text_RemoveTrailingCr(str#))
34909>>>>>end_function
34910>>>>>
34910>>>>>function Text_Compress global string str# returns string
34911>>>>>  move (replaces(character(10),str#," ")) to str#
34912>>>>>  trim str# to str#
34913>>>>>>
34913>>>>>  move (RemoveDblBlanks(str#)) to str#
34914>>>>>  function_return str#
34915>>>>>end_function
34916>>>>>
34916>>>>>function Text_CompressSubstCr global string str# string new_line# returns string
34917>>>>>  function_return (RemoveDblBlanks(trim(replaces(character(10),Text_RemoveTrailingCr(str#),new_line#))))
34918>>>>>end_function
34919>>>>>
34919>>>>>class cText_Formatter is an array
34920>>>>>  procedure construct_object integer img#
34921>>>>>    forward send construct_object img#
34923>>>>>    property integer pRmargin         public 40
34924>>>>>    property integer pCompress_state  public 0
34925>>>>>    property integer pTrim_state      public 1 // 0=no trim, 1=trim, 2=rtrim
34926>>>>>    property integer pSubst_below_32_state  public 0
34927>>>>>  end_procedure
34928>>>>>
34928>>>>>  procedure add_item.s string str#
34929>>>>>    local integer char#
34930>>>>>    if (pSubst_below_32_state(current_object)) begin
34932>>>>>      for char# from 0 to 31
34938>>>>>>
34938>>>>>        move (replaces(character(char#),str#," ")) to str#
34939>>>>>      loop
34940>>>>>>
34940>>>>>    end
34940>>>>>>
34940>>>>>    set array_value item (item_count(current_object)) to str#
34941>>>>>  end_procedure
34942>>>>>
34942>>>>>  function split_word string str# integer len# returns string
34943>>>>>    local integer pos#
34944>>>>>    local string rval#
34944>>>>>    move (pos("-",str#)) to pos#
34945>>>>>    if (pos# and pos#<=len#) move (replace("-",str#," ")) to rval#
34948>>>>>    else begin
34949>>>>>      move (left(str#,len#)) to rval#
34950>>>>>      move (rval#+" "+replace(rval#,str#,"")) to rval#
34951>>>>>    end
34951>>>>>>
34951>>>>>    function_return rval# // The space in the return value indicates
34952>>>>>  end_function            // where to split the word
34953>>>>>
34953>>>>>  procedure format.s string str#
34954>>>>>    local integer Trim_state# done# pRmargin# word_done# pos# max# len#
34955>>>>>    local string word# line# lf# left# char#
34955>>>>>
34955>>>>>    //pre-format:
34955>>>>>    get pTrim_state to Trim_state#
34956>>>>>    if Trim_state# eq 1 move (Text_Trim(str#)) to str#
34959>>>>>    else if Trim_state# eq 2 move (Text_RTrim(str#)) to str#
34963>>>>>    if (pCompress_state(current_object)) move (Text_Compress(str#)) to str#
34966>>>>>
34966>>>>>    move (character(10)) to lf#
34967>>>>>    get pRmargin to pRmargin#
34968>>>>>    if pRmargin# gt 1 begin // Otherwise nothing makes sense!
34970>>>>>      move 0 to done#
34971>>>>>      move "" to line#
34972>>>>>      move 1 to pos#
34973>>>>>      move (length(str#)) to max#
34974>>>>>      repeat
34974>>>>>>
34974>>>>>
34974>>>>>        move "" to word#
34975>>>>>        move 0 to word_done#
34976>>>>>        repeat
34976>>>>>>
34976>>>>>          if pos# gt max# move 1 to word_done#
34979>>>>>          else begin
34980>>>>>            mid str# to char# 1 pos#
34983>>>>>>
34983>>>>>            if char# eq lf# begin // Line feed
34985>>>>>              if word# eq "" begin
34987>>>>>                move lf# to word#
34988>>>>>                increment pos#
34989>>>>>              end
34989>>>>>>
34989>>>>>              move 1 to word_done#
34990>>>>>            end
34990>>>>>>
34990>>>>>            else begin
34991>>>>>              if char# eq "" begin
34993>>>>>                if word# eq "" increment pos#
34996>>>>>                else move 1 to word_done#
34998>>>>>              end
34998>>>>>>
34998>>>>>              else begin
34999>>>>>                move (word#+char#) to word#
35000>>>>>                increment pos#
35001>>>>>              end
35001>>>>>>
35001>>>>>            end
35001>>>>>>
35001>>>>>          end
35001>>>>>>
35001>>>>>        until word_done#
35003>>>>>
35003>>>>>        if word# eq "" move 1 to done# // We're done!
35006>>>>>        else begin
35007>>>>>          if word# eq lf# begin // If hard return:
35009>>>>>            send add_item.s line#
35010>>>>>            move "" to line#
35011>>>>>          end
35011>>>>>>
35011>>>>>          else begin //
35012>>>>>            if (length(line#)+length(word#)+1) gt pRmargin# begin // Soft new line
35014>>>>>              if line# ne "" begin
35016>>>>>                send add_item.s line# // Could be that word is longer that pRmargin
35017>>>>>                move "" to line#
35018>>>>>              end
35018>>>>>>
35018>>>>>              if (length(word#)) gt pRmargin# begin // Word IS longer that line!
35020>>>>>                repeat
35020>>>>>>
35020>>>>>                  if line# eq "" move (pRmargin#-1) to len#
35023>>>>>                  else move (pRmargin#-length(line#)-2) to len#
35025>>>>>                  move (split_word(current_object,word#,len#)) to word#
35026>>>>>                  move (ExtractItem(word#," ",1)) to left#
35027>>>>>                  move (ExtractItem(word#," ",2)) to word#
35028>>>>>                  if word# eq "" move left# to line#
35031>>>>>                  else send add_item.s (left#+"-")
35033>>>>>                until word# eq ""
35035>>>>>              end
35035>>>>>>
35035>>>>>              else move word# to line#
35037>>>>>            end
35037>>>>>>
35037>>>>>            else begin
35038>>>>>              if line# ne "" move (line#+" "+word#) to line# // add word to line
35041>>>>>              else move word# to line#
35043>>>>>            end
35043>>>>>>
35043>>>>>          end
35043>>>>>>
35043>>>>>        end
35043>>>>>>
35043>>>>>      until done#
35045>>>>>      if line# ne "" send add_item.s line#
35048>>>>>    end
35048>>>>>>
35048>>>>>  end_procedure
35049>>>>>end_class
35050>>>>>
35050>>>>>object oText_Formatter is a cText_Formatter no_image
35052>>>>>  set pSubst_below_32_state to true
35053>>>>>end_object
35054>>>>>
35054>>>>>function Text_Format.sii global string str# integer width# integer reset# returns integer
35055>>>>>  local integer obj#
35056>>>>>  move (oText_Formatter(current_object)) to obj#
35057>>>>>  if reset# send delete_data to obj#
35060>>>>>  set pRmargin of obj# to width#
35061>>>>>  send format.s to obj# str#
35062>>>>>  function_return (item_count(obj#))
35063>>>>>end_function
35064>>>>>
35064>>>>>function Text_FormattedLine.i global integer line# returns string
35065>>>>>  function_return (string_value(oText_Formatter(current_object),line#))
35066>>>>>end_function
35067>>>
35067>>>//desktop_section
35067>>>  object oGridMoveSelectedListItems is an cArray no_image
35069>>>  end_object
35070>>>//end_desktop_section
35070>>>
35070>>>//> Procedure Grid_CopySelectedListItems is meant for List objects or grid's
35070>>>//> with only one column
35070>>>procedure Grid_CopySelectedListItems global integer source_grid# integer target_grid# integer all_items# integer delete_from_source#
35071>>>  local integer max# itm# select# obj# delete_itm#
35072>>>  local string fn#
35072>>>  move (oGridMoveSelectedListItems(current_object)) to obj#
35073>>>  get item_count of source_grid# to max#
35074>>>  for itm# from 0 to (max#-1) // Copy selected items
35080>>>>
35080>>>    ifnot all_items# get select_state of source_grid# item itm# to select#
35083>>>    if (select# or all_items#) begin
35085>>>      get value of source_grid# item itm# to fn#
35086>>>      send add_item to target_grid# msg_none fn#
35087>>>      set value of obj# item (item_count(obj#)) to itm#
35088>>>    end
35088>>>>
35088>>>  loop
35089>>>>
35089>>>  if all_items# send delete_data to source_grid#
35092>>>  else begin
35093>>>    get item_count of obj# to max#
35094>>>    for_ex itm# from (max#-1) down_to 0 // Remove selected items
35101>>>      get value of obj# item itm# to delete_itm#
35102>>>      send delete_item to source_grid# delete_itm#
35103>>>    loop
35104>>>>
35104>>>  end
35104>>>>
35104>>>  send delete_data to obj#
35105>>>  send sort_items to source_grid#
35106>>>  send sort_items to target_grid#
35107>>>  set dynamic_update_state of source_grid# to true
35108>>>  set dynamic_update_state of target_grid# to true
35109>>>end_procedure
35110>>>
35110>>>//> Function Grid_Columns takes the object ID of a Grid or List
35110>>>//> object and returns the number of columns in that object.
35110>>>function Grid_Columns global integer obj# returns integer
35111>>>  local integer lw#
35112>>>  get matrix_size of obj# to lw#
35113>>>  function_return (low(lw#))
35114>>>end_function
35115>>>
35115>>>function Grid_CurrentColumn global integer obj# returns integer
35116>>>  local integer columns# ci# base#
35117>>>  get Grid_Columns obj# to columns#
35118>>>  get current_item of obj# to ci#
35119>>>  move ((ci#/columns#)*columns#) to base#
35120>>>  function_return (ci#-base#)
35121>>>end_function
35122>>>
35122>>>function Grid_BaseItem global integer obj# returns integer
35123>>>  local integer columns# ci#
35124>>>//#IFDEF IS$WINDOWS
35124>>>  get Grid_Columns obj# to columns#
35125>>>  get current_item of obj# to ci#
35126>>>  function_return ((ci#/columns#)*columns#)
35127>>>//#ELSE
35127>>>//#ENDIF
35127>>>end_function
35128>>>
35128>>>function Grid_ItemBaseItem global integer obj# integer ci# returns integer
35129>>>  local integer columns#
35130>>>  get Grid_Columns obj# to columns#
35131>>>  function_return ((ci#/columns#)*columns#)
35132>>>end_function
35133>>>
35133>>>//> Set Entry_State for all items in a Grid
35133>>>procedure Grid_SetEntryState global integer obj# integer st#
35134>>>  local integer itm# max#
35135>>>  get item_count of obj# to max#
35136>>>  for itm# from 0 to (max#-1)
35142>>>>
35142>>>    set entry_state of obj# item itm# to st#
35143>>>  loop
35144>>>>
35144>>>end_procedure
35145>>>
35145>>>//> What is the number of the base item of row row#
35145>>>function Grid_RowBaseItem global integer obj# integer row# returns integer
35146>>>  local integer columns#
35147>>>  get Grid_Columns obj# to columns#
35148>>>  function_return (row#*columns#)
35149>>>end_function
35150>>>
35150>>>//> Return the number of the row that includes the current_item
35150>>>function Grid_CurrentRow global integer obj# returns integer
35151>>>  local integer ci#
35152>>>  get current_item of obj# to ci#
35153>>>  function_return (ci#/Grid_Columns(obj#))
35154>>>end_function
35155>>>
35155>>>//> Return the number of rows currently in the Grid
35155>>>function Grid_RowCount global integer obj# returns integer
35156>>>  local integer columns#
35157>>>  get Grid_Columns obj# to columns#
35158>>>  function_return (item_count(obj#)/columns#)
35159>>>end_function
35160>>>
35160>>>procedure Grid_SwapRows global integer obj# integer row1# integer row2#
35161>>>  local integer base1# base2# itm# max#
35162>>>  local string str#
35162>>>  get Grid_RowBaseItem obj# row1# to base1#
35163>>>  get Grid_RowBaseItem obj# row2# to base2#
35164>>>  get Grid_Columns obj# to max#
35165>>>  for itm# from 0 to (max#-1)
35171>>>>
35171>>>    // value
35171>>>    get value of obj# item (base1#+itm#) to str#
35172>>>    set value of obj# item (base1#+itm#) to (value(obj#,base2#+itm#))
35173>>>    set value of obj# item (base2#+itm#) to str#
35174>>>    // entry_state
35174>>>    get entry_state of obj# item (base1#+itm#) to str#
35175>>>    set entry_state of obj# item (base1#+itm#) to (entry_state(obj#,base2#+itm#))
35176>>>    set entry_state of obj# item (base2#+itm#) to str#
35177>>>      // color
35177>>>      get itemcolor of obj# item (base1#+itm#) to str#
35178>>>      set itemcolor of obj# item (base1#+itm#) to (itemcolor(obj#,base2#+itm#))
35179>>>      set itemcolor of obj# item (base2#+itm#) to str#
35180>>>    // checkbox_item_state
35180>>>    get checkbox_item_state of obj# item (base1#+itm#) to str#
35181>>>    set checkbox_item_state of obj# item (base1#+itm#) to (checkbox_item_state(obj#,base2#+itm#))
35182>>>    set checkbox_item_state of obj# item (base2#+itm#) to str#
35183>>>    // aux_value
35183>>>    get aux_value of obj# item (base1#+itm#) to str#
35184>>>    set aux_value of obj# item (base1#+itm#) to (aux_value(obj#,base2#+itm#))
35185>>>    set aux_value of obj# item (base2#+itm#) to str#
35186>>>    // select_state
35186>>>    get select_state of obj# item (base1#+itm#) to str#
35187>>>    set select_state of obj# item (base1#+itm#) to (select_state(obj#,base2#+itm#))
35188>>>    set select_state of obj# item (base2#+itm#) to str#
35189>>>  loop
35190>>>>
35190>>>end_procedure
35191>>>
35191>>>
35191>>>// Use like this (from within a Grid object):
35191>>>//
35191>>>//   procedure MoveItemUp
35191>>>//     send Grid_SwapCurrentRowUp self
35191>>>//   end_procedure
35191>>>//   procedure MoveItemDown
35191>>>//     send Grid_SwapCurrentRowDown self
35191>>>//   end_procedure
35191>>>//   on_key key_ctrl+key_up_arrow   send MoveItemUp
35191>>>//   on_key key_ctrl+key_down_arrow send MoveItemDown
35191>>>//
35191>>>procedure Grid_SwapCurrentRowUp global integer obj#
35192>>>  local integer cr# ci#
35193>>>  get Grid_CurrentRow obj# to cr#
35194>>>  if cr# gt 0 begin
35196>>>    get Current_Item of obj# to ci#
35197>>>    send Grid_SwapRows obj# cr# (cr#-1)
35198>>>    set Current_Item of obj# to (ci#-Grid_Columns(obj#))
35199>>>  end
35199>>>>
35199>>>end_procedure
35200>>>procedure Grid_SwapCurrentRowDown global integer obj#
35201>>>  local integer cr# ci#
35202>>>  get Grid_CurrentRow obj# to cr#
35203>>>  if cr# lt (Grid_RowCount(obj#)-1) begin
35205>>>    get Current_Item of obj# to ci#
35206>>>    send Grid_SwapRows obj# cr# (cr#+1)
35207>>>    set Current_Item of obj# to (ci#+Grid_Columns(obj#))
35208>>>  end
35208>>>>
35208>>>end_procedure
35209>>>
35209>>>//desktop_section
35209>>>   Use FieldInf     // Global field info objects and abstract field types
INCLUDING FILE: FIELDINF.PKG
35209>>>>>//**********************************************************************
35209>>>>>// Use FieldInf     // Global field info objects
35209>>>>>//
35209>>>>>// By Sture Andersen
35209>>>>>//
35209>>>>>// Create:  Wed  28-01-1997
35209>>>>>// Update:  Tue  11-02-1997 - Abstract field thing added
35209>>>>>//          Thu  20-02-1997 - Register_abstract_field_label may now be
35209>>>>>//                            be used with only one argument (does nothing)
35209>>>>>//          Thu  04-03-1997 - ascii_window and date_window are now defined
35209>>>>>//                            if not already (for use with CM)
35209>>>>>//          Tue  22-04-1997 - File_Display_Name_Array added
35209>>>>>//          Tue  29-04-1997 - Changed REGISTER_FIELD_LABEL command
35209>>>>>//          Wed  04-02-1998 - Functions gl_generic_form_margin and
35209>>>>>//                            gl_generic_form_datatype added
35209>>>>>//          Fri  29-01-1999 - DataDictionary_Class property moved to here
35209>>>>>//                            from dynamo.utl.
35209>>>>>//          Wed  17-02-1999 - Class cVirtualFields added.
35209>>>>>//          Mon  15-03-1999 - DataDictionary classes are now used when
35209>>>>>//                            determining field labels
35209>>>>>//
35209>>>>>// Purpose: To provide a global mechanism for registering field labels.
35209>>>>>//          If used with APS, db-controls will automatically obtain their
35209>>>>>//          labels from here, unless they are set manually or they are
35209>>>>>//          specifically told not to.
35209>>>>>//
35209>>>>>//          The package also let's you define abstract field types for
35209>>>>>//          use with non-db controls or for overriding the definition of
35209>>>>>//          DBMS fields. A classical example of the latter is that while
35209>>>>>//          your data field is defined to have 4 decimal points you
35209>>>>>//          really want the field to display with only 3.
35209>>>>>//
35209>>>>>//          You set these global informations using the four commands
35209>>>>>//          listed here:
35209>>>>>//
35209>>>>>//      1   REGISTER_FIELD_LABEL dffile.field <field label> ;
35209>>>>>//                                   [<grid label> [<status help>]]
35209>>>>>//
35209>>>>>//      2   REGISTER_ABSTRACT_FIELD_TYPE <un-typed abstract_id> ;
35209>>>>>//                                       <length> <data_type>
35209>>>>>//
35209>>>>>//      3   MODIFY_FIELD_TYPE dffile.field <abstract_id>
35209>>>>>//
35209>>>>>//      4   REGISTER_FILE_ALIAS <master_dffile> <shadow_dffile>
35209>>>>>//
35209>>>>>//          As you can see it is possible to register status help lines.
35209>>>>>//          This was implemented since it felt to natural to do so. APS
35209>>>>>//          will make use of such registrations only if used with the
35209>>>>>//          aps.DataDictionary and only if status help has not been
35209>>>>>//          registered the standard DD way.
35209>>>>>//
35209>>>>>//
35209>>>>>// Note:    This package makes permanent use of compile-time variable J$.
35209>>>>>//          If this is in conflict with your application source it is
35209>>>>>//          easily changed since it is only referenced from within this
35209>>>>>//          file.
35209>>>>>//
35209>>>>>//**********************************************************************
35209>>>>>
35209>>>>>Use ui
35209>>>>>Use Seq_Chnl     // Defines global sequential device management operations (DAC)
35209>>>>>Use Array.utl    // Item_Property command
35209>>>>>Use Macros.utl   // Various macros (DESKTOP_SECTION)
35209>>>>>
35209>>>>>class cFieldInfoStuff is an array
35210>>>>>  function array_id.i integer file# returns integer
35211>>>>>    local integer rval#
35212>>>>>    get value item file# to rval#
35213>>>>>    ifnot rval# begin
35215>>>>>      object fldinf.array is an array
35217>>>>>        move current_object to rval#
35218>>>>>      end_object
35219>>>>>      set value item file# to rval#
35220>>>>>    end
35220>>>>>>
35220>>>>>    function_return rval#
35221>>>>>  end_function
35222>>>>>  procedure set string_value.ii integer file# integer field# string str#
35223>>>>>    set value of (array_id.i(current_object,file#)) item field# to str#
35224>>>>>  end_procedure
35225>>>>>  function string_value.ii integer file# integer field# returns string
35226>>>>>    local integer arr#
35227>>>>>    get value item file# to arr#
35228>>>>>    if arr# function_return (value(arr#,field#))
35231>>>>>    function_return ""
35232>>>>>  end_function
35233>>>>>  procedure set integer_value.ii integer file# integer field# integer int#
35234>>>>>    set value of (array_id.i(current_object,file#)) item field# to int#
35235>>>>>  end_procedure
35236>>>>>  function integer_value.ii integer file# integer field# returns integer
35237>>>>>    local integer arr#
35238>>>>>    get value item file# to arr#
35239>>>>>    if arr# function_return (value(arr#,field#))
35242>>>>>    function_return 0
35243>>>>>  end_function
35244>>>>>
35244>>>>>  //> The purpose of the make_alias procedure is to redirect references
35244>>>>>  //> to file number <alias#> refer to file number <master#> instead.
35244>>>>>  procedure make_alias integer master# integer alias#
35245>>>>>    local integer master_arr#
35246>>>>>    get array_id.i master# to master_arr#
35247>>>>>    set value item alias# to master_arr#
35248>>>>>  end_procedure
35249>>>>>end_class
35250>>>>>
35250>>>>>integer field_labels_array#  grid_labels_array# status_help_array#
35250>>>>>integer form_datatype_array# form_margin_array# abstract_array#
35250>>>>>
35250>>>>>object field_labels_array is a cFieldInfoStuff
35252>>>>>  move current_object to field_labels_array#
35253>>>>>end_object
35254>>>>>object grid_labels_array is a cFieldInfoStuff
35256>>>>>  move current_object to grid_labels_array#
35257>>>>>end_object
35258>>>>>object status_help_array is a cFieldInfoStuff
35260>>>>>  move current_object to status_help_array#
35261>>>>>end_object
35262>>>>>object form_datatype_array is a cFieldInfoStuff
35264>>>>>  move current_object to form_datatype_array#
35265>>>>>end_object
35266>>>>>object form_margin_array is a cFieldInfoStuff
35268>>>>>  move current_object to form_margin_array#
35269>>>>>end_object
35270>>>>>object abtract_array is a cFieldInfoStuff
35272>>>>>  // If a DBMS field (file,field) has an entry in this array it means
35272>>>>>  // that its corresponding form_datatype and form_margin should be
35272>>>>>  // looked up in the other arrays rather than using its original values.
35272>>>>>  move current_object to abstract_array#
35273>>>>>end_object
35274>>>>>object capslocked_array is a cFieldInfoStuff
35276>>>>>//  move current_object to abstract_array#
35276>>>>>end_object
35277>>>>>
35277>>>>>// Prefix "gl_" means "global"
35277>>>>>function gl_field_label for desktop integer file# integer field# returns string
35278>>>>>  local string rval#
35279>>>>>  move (string_value.ii(field_labels_array#,file#,field#)) to rval#
35280>>>>>  if rval# eq "" begin
35282>>>>>    get_attribute df_field_name of file# field# to rval#
35285>>>>>    move (replaces("_",rval#," ")) to rval#
35286>>>>>    move (lowercase(rval#)) to rval#
35287>>>>>    move (overstrike(uppercase(left(rval#,1)),rval#,1)) to rval#
35288>>>>>    set string_value.ii of field_labels_array# file# field# to rval#
35289>>>>>  end
35289>>>>>>
35289>>>>>  function_return rval#
35290>>>>>end_function
35291>>>>>function gl_grid_label for desktop integer file# integer field# returns string
35292>>>>>  local string rval#
35293>>>>>  move (string_value.ii(grid_labels_array#,file#,field#)) to rval#
35294>>>>>  if rval# eq "" begin
35296>>>>>    get_attribute df_field_name of file# field# to rval#
35299>>>>>    move (replaces("_",rval#," ")) to rval#
35300>>>>>    move (lowercase(rval#)) to rval#
35301>>>>>    move (overstrike(uppercase(left(rval#,1)),rval#,1)) to rval#
35302>>>>>    set string_value.ii of grid_labels_array# file# field# to rval#
35303>>>>>  end
35303>>>>>>
35303>>>>>  function_return rval#
35304>>>>>end_function
35305>>>>>function gl_status_help for desktop integer file# integer field# returns string
35306>>>>>  function_return (string_value.ii(status_help_array#,file#,field#))
35307>>>>>end_function
35308>>>>>function gl_datatype for desktop integer file# integer field# returns integer
35309>>>>>  function_return (integer_value.ii(form_datatype_array#,file#,field#))
35310>>>>>end_function
35311>>>>>function gl_margin for desktop integer file# integer field# returns integer
35312>>>>>  function_return (integer_value.ii(form_margin_array#,file#,field#))
35313>>>>>end_function
35314>>>>>function gl_abstract for desktop integer file# integer field# returns integer
35315>>>>>  function_return (integer_value.ii(abstract_array#,file#,field#))
35316>>>>>end_function
35317>>>>>
35317>>>>>
35317>>>>>// REGISTER_FIELD_LABEL dffile.field <field label> ;
35317>>>>>//                              [<grid label> [<status help>]]
35317>>>>>
35317>>>>>
35317>>>>>
35317>>>>>//  REGISTER_ABSTRACT_FIELD_TYPE <un-typed name> ;
35317>>>>>//                                            <margin> <data_type>
35317>>>>>
35317>>>>>
35317>>>>>
35317>>>>>//  REGISTER_ABSTRACT_FIELD_LABEL <previously un-typed name> ;
35317>>>>>//                             <field label> [<grid label> [<status help>]]
35317>>>>>//
35317>>>>>//  Registrations done with the REGISTER_ABSTRACT_FIELD_LABEL are not
35317>>>>>//  currently used by APS
35317>>>>>
35317>>>>>
35317>>>>>
35317>>>>>//  MODIFY_FIELD_TYPE dffile.field <abstract_id>
35317>>>>>
35317>>>>>
35317>>>>>//  REGISTER_FILE_ALIAS <master_dffile> <shadow_dffile>
35317>>>>>
35317>>>>>
35317>>>>>
35317>>>>>  function gl_generic_form_datatype global integer file# integer field# returns integer
35318>>>>>    local integer type# rval#
35319>>>>>    get_attribute DF_FIELD_TYPE of file# field# to type#
35322>>>>>    if type# eq DF_ASCII function_return ascii_window
35325>>>>>    if type# eq DF_DATE  function_return date_window
35328>>>>>    if type# eq DF_BCD begin
35330>>>>>      get_attribute DF_FIELD_PRECISION of file# field# to rval#
35333>>>>>      function_return rval#
35334>>>>>    end
35334>>>>>>
35334>>>>>    function_return ascii_window // DF_OVERLAP DF_TEXT DF_BINARY
35335>>>>>  end_function
35336>>>>>
35336>>>>>  function gl_generic_form_margin global integer file# integer field# returns integer
35337>>>>>    local integer datatype# len#
35338>>>>>    move (gl_generic_form_datatype(file#,field#)) to datatype#
35339>>>>>    if datatype# eq date_window function_return 10
35342>>>>>    get_attribute DF_FIELD_LENGTH of file# field# to len#
35345>>>>>    if datatype# eq ascii_window function_return len#
35348>>>>>    function_return (len#+1) // Room for comma
35349>>>>>  end_function
35350>>>>>
35350>>>>>  function gl_effective_form_datatype global integer file# integer field# returns integer
35351>>>>>    local integer abstract#
35352>>>>>    get gl_abstract file# field# to abstract#
35353>>>>>    if abstract# function_return (gl_datatype(current_object,0,abstract#))
35356>>>>>    function_return (gl_generic_form_datatype(file#,field#))
35357>>>>>  end_function
35358>>>>>  function gl_effective_form_margin global integer file# integer field# returns integer
35359>>>>>    local integer rval#
35360>>>>>    get gl_margin file# field# to rval#
35361>>>>>    if rval# function_return rval#
35364>>>>>    function_return (gl_generic_form_margin(file#,field#))
35365>>>>>  end_function
35366>>>>>
35366>>>>>register_abstract_field_type aft_ascii2       2 ascii_window
35368>>>>>register_abstract_field_type aft_ascii3       3 ascii_window
35370>>>>>register_abstract_field_type aft_ascii4       4 ascii_window
35372>>>>>register_abstract_field_type aft_ascii5       5 ascii_window
35374>>>>>register_abstract_field_type aft_ascii6       6 ascii_window
35376>>>>>register_abstract_field_type aft_ascii10     10 ascii_window
35378>>>>>register_abstract_field_type aft_ascii15     15 ascii_window
35380>>>>>register_abstract_field_type aft_ascii20     20 ascii_window
35382>>>>>register_abstract_field_type aft_ascii25     25 ascii_window
35384>>>>>register_abstract_field_type aft_ascii30     30 ascii_window
35386>>>>>register_abstract_field_type aft_ascii35     35 ascii_window
35388>>>>>register_abstract_field_type aft_ascii40     40 ascii_window
35390>>>>>register_abstract_field_type aft_ascii50     50 ascii_window
35392>>>>>register_abstract_field_type aft_ascii80     80 ascii_window
35394>>>>>register_abstract_field_type aft_numeric1.2   4 2 // Length 4, 2 decimal points
35396>>>>>register_abstract_field_type aft_numeric2.0   2 0 // Length 2, 0 decimal points
35398>>>>>register_abstract_field_type aft_numeric2.1   4 1 // Length 4, 1 decimal points
35400>>>>>register_abstract_field_type aft_numeric2.2   4 2 // Length 4, 1 decimal points
35402>>>>>register_abstract_field_type aft_numeric3.0   3 0 // Length 3, 0 decimal points
35404>>>>>register_abstract_field_type aft_numeric4.0   4 0 // Length 4, 0 decimal points
35406>>>>>register_abstract_field_type aft_numeric4.2   7 2 // Length 7, 2 decimal points
35408>>>>>register_abstract_field_type aft_numeric6.0   6 0 // Length 6, 0 decimal points
35410>>>>>register_abstract_field_type aft_numeric8.0   8 0 // Length 8, 0 decimal points
35412>>>>>register_abstract_field_type aft_numeric10.0 10 0 // Length 10, 0 decimal points
35414>>>>>register_abstract_field_type aft_date        10 date_window
35416>>>>>register_abstract_field_type aft_boolean      1 0
35418>>>>>
35418>>>>>
35418>>>>>// An extra feature allows specifying a replacement to the user display name
35418>>>>>// of files (df_File_Display_Name). APS makes no use of such registrations.
35418>>>>>//
35418>>>>>//   REGISTER_FILE_DISPLAY_NAME dffile <string>
35418>>>>>
35418>>>>>desktop_section
35423>>>>> object File_Display_Name_Array is an array
35425>>>>> end_object
35426>>>>>end_desktop_section
35428>>>>>procedure set File_Display_Name global integer file# string name#
35429>>>>>  set value of (File_Display_Name_Array(current_object)) item file# to name#
35430>>>>>end_procedure
35431>>>>>function File_Display_Name global integer file# returns string
35432>>>>>  local string rval#
35433>>>>>  move (value(File_Display_Name_Array(current_object),file#)) to rval#
35434>>>>>  if rval# eq "" begin
35436>>>>>    get_attribute df_File_Display_Name of file# to rval#
35439>>>>>    set File_Display_Name file# to rval#
35440>>>>>  end
35440>>>>>>
35440>>>>>  function_return rval#
35441>>>>>end_function
35442>>>>>
35442>>>>>
35442>>>>>// In order for the aps_ObjectDynamo class to be able to use the
35442>>>>>// generic DD-classes a few lines is needed that will allow us to
35442>>>>>// register which classes to use when creating DDO's for the various
35442>>>>>// data files.
35442>>>>>//
35442>>>>>// Use like this:
35442>>>>>//
35442>>>>>//   set DataDictionary_Class OrderHdr.file_number to U_OrderHdr_DD
35442>>>>>//
35442>>>>>
35442>>>>>desktop_section
35447>>>>> object oDataDictionary_Class_Array is an array
35449>>>>> end_object
35450>>>>>end_desktop_section
35452>>>>>function DataDictionary_Class global integer file# returns integer
35453>>>>>  function_return (value(oDataDictionary_Class_Array(current_object),file#))
35454>>>>>end_function
35455>>>>>procedure set DataDictionary_Class global integer file# integer class#
35456>>>>>  set value of (oDataDictionary_Class_Array(current_object)) item file# to class#
35457>>>>>end_procedure
35458>>>>>
35458>>>>>desktop_section
35463>>>>> object oDataDictionary_Object_Array is an array
35465>>>>> end_object
35466>>>>>end_desktop_section
35468>>>>>function DataDictionary_Object global integer file# returns integer
35469>>>>>  function_return (value(oDataDictionary_Object_Array(current_object),file#))
35470>>>>>end_function
35471>>>>>procedure set DataDictionary_Object global integer file# integer obj#
35472>>>>>  set value of (oDataDictionary_Object_Array(current_object)) item file# to obj#
35473>>>>>end_procedure
35474>>>>>
35474>>>>>function iDD_Object global integer file# returns integer
35475>>>>>  local integer rval# class# current_object#
35476>>>>>  get DataDictionary_Object file# to rval#
35477>>>>>  ifnot rval# begin
35479>>>>>    get DataDictionary_Class file# to class#
35480>>>>>    if class# begin
35482>>>>>      name class# U_fieldinf_class             // Cannot be understoodÄÄÄÄÄ¿
35482>>>>>      move current_object to current_object#   // Push current_object       ³
35483>>>>>      move desktop to current_object           // Create at desktop         ³
35484>>>>>      object dynamo_object is a fieldinf_class // Create an object of classÄÙ
35486>>>>>        move current_object to rval#           // Get the object ID to rval#
35487>>>>>      end_object                               //
35488>>>>>      move current_object# to current_object   // Pop current_object
35489>>>>>      set DataDictionary_Object file# to rval# // Register the new object
35490>>>>>    end
35490>>>>>>
35490>>>>>  end
35490>>>>>>
35490>>>>>  function_return rval#
35491>>>>>end_function
35492>>>>>
35492>>>>>class cVirtualFields is an array
35493>>>>>  procedure construct_object integer img#
35494>>>>>    forward send construct_object img#
35496>>>>>    set delegation_mode to delegate_to_parent
35497>>>>>    property integer pMainFile              public 0
35498>>>>>    property integer private.pCurrentRecord public -1
35499>>>>>    property string  pUserName              public "Un-named"
35500>>>>>  end_procedure
35501>>>>>  item_property_list
35501>>>>>    item_property integer piFieldActive.i
35501>>>>>    item_property string  psFieldLabel.i
35501>>>>>    item_property string  psFieldLabel_Short.i
35501>>>>>    item_property integer piFieldType.i
35501>>>>>    item_property integer piFieldLength.i
35501>>>>>    item_property integer piFieldDecPoint.i
35501>>>>>    item_property integer piFieldCapslock.i
35501>>>>>    item_property integer piFieldLoadMessage.i
35501>>>>>    item_property integer piFieldLoadObject.i
35501>>>>>    item_property string  psFieldValue.i
35501>>>>>    item_property integer piFieldDirty.i
35501>>>>>  end_item_property_list cVirtualFields // When in class, class neame must be repeated here
35585>>>>>  procedure SetAllFieldsDirty integer state#
35586>>>>>    local integer max# field#
35587>>>>>    get row_count to max#
35588>>>>>    for field# from 0 to (max#-1)
35594>>>>>>
35594>>>>>      set piFieldDirty.i field# to state#
35595>>>>>    loop
35596>>>>>>
35596>>>>>  end_procedure
35597>>>>>  procedure set pCurrentRecord integer rec#
35598>>>>>    local integer field# prev_rec#
35599>>>>>    get private.pCurrentRecord to prev_rec#
35600>>>>>    if rec# ne prev_rec# send SetAllFieldsDirty dftrue
35603>>>>>    set private.pCurrentRecord to prev_rec#
35604>>>>>  end_procedure
35605>>>>>  function pCurrentRecord returns integer
35606>>>>>    function_return (private.pCurrentRecord(current_object))
35607>>>>>  end_function
35608>>>>>  procedure LoadFieldValue integer field#
35609>>>>>    local integer get# obj#
35610>>>>>    local string str#
35610>>>>>    get piFieldLoadMessage.i field# to get#
35611>>>>>    get piFieldLoadObject.i  field# to obj#
35612>>>>>    if obj# get get# of obj# to str#
35615>>>>>    else get get# to str#
35617>>>>>    set psFieldValue.i field# to str#
35618>>>>>    set piFieldDirty.i field# to dffalse
35619>>>>>  end_procedure
35620>>>>>  procedure CheckCurrentRecord
35621>>>>>    local integer file# rec#
35622>>>>>    get pMainFile to file#
35623>>>>>    if file# begin
35625>>>>>      get_field_value file# 0 to rec#
35628>>>>>      if rec# ne (private.pCurrentRecord(current_object)) set pCurrentRecord to rec#
35631>>>>>    end
35631>>>>>>
35631>>>>>  end_procedure
35632>>>>>  function sFieldValue.i integer field# returns string
35633>>>>>    send CheckCurrentRecord
35634>>>>>    if (piFieldDirty.i(current_object,field#)) send LoadFieldValue field#
35637>>>>>    function_return (psFieldValue.i(current_object,field#))
35638>>>>>  end_function
35639>>>>>  procedure define_field integer field# string Label# string Label_Short# integer Type# integer Length# integer DecPoint# integer LoadMessage# integer LoadObjectTmp#
35640>>>>>    local integer LoadObject#
35641>>>>>    if num_arguments gt 7 move LoadObjectTmp# to LoadObject#
35644>>>>>    else move 0 to LoadObject#
35646>>>>>    set psFieldLabel.i field# to Label#
35647>>>>>
35647>>>>>    if Label_Short# ne "" ;         set psFieldLabel_Short.i field# to Label_Short#
35650>>>>>    else set psFieldLabel_Short.i field# to Label#
35652>>>>>
35652>>>>>    set piFieldType.i        field# to Type#
35653>>>>>    set piFieldLength.i      field# to Length#
35654>>>>>    set piFieldDecPoint.i    field# to DecPoint#
35655>>>>>    set piFieldLoadMessage.i field# to LoadMessage#
35656>>>>>    set piFieldLoadObject.i  field# to LoadObject#
35657>>>>>    set piFieldDirty.i       field# to dftrue
35658>>>>>    set piFieldActive.i      field# to dftrue
35659>>>>>    set piFieldCapslock.i    field# to dffalse
35660>>>>>  end_procedure
35661>>>>>end_class
35662>>>>>
35662>>>>>integer oFieldInf_VitualFields#
35662>>>>>object oFieldInf_VitualFields is an array
35664>>>>>  move current_object to oFieldInf_VitualFields#
35665>>>>>end_object
35666>>>>>
35666>>>>>function FieldInf_VirtualFields_Object global integer file# returns integer
35667>>>>>  function_return (value(oFieldInf_VitualFields#,file#))
35668>>>>>end_function
35669>>>>>procedure set FieldInf_VirtualFields_Object global integer file# integer value#
35670>>>>>  set value of (oFieldInf_VitualFields#) item file# to value#
35671>>>>>end_procedure
35672>>>>>
35672>>>>>function FieldInf_FieldType global integer file# integer field# returns integer
35673>>>>>  local integer fieldtype#
35674>>>>>  if field# lt 256 get_attribute DF_FIELD_TYPE of file# field# to fieldtype#
35679>>>>>  else move (piFieldType.i(FieldInf_VirtualFields_Object(file#),field#-256)) to fieldtype#
35681>>>>>  function_return fieldtype#
35682>>>>>end_function
35683>>>>>function FieldInf_FieldValue global integer file# integer field# returns string
35684>>>>>  local integer fi# fn#
35685>>>>>  local string rval#
35685>>>>>  move fieldindex to fi#
35686>>>>>  move fieldnumber to fn#
35687>>>>>  if field# lt 256 get_field_value file# field# to rval#
35692>>>>>  else move (sFieldValue.i(FieldInf_VirtualFields_Object(file#),field#-256)) to rval#
35694>>>>>  move fi#  to fieldindex
35695>>>>>  move fn# to fieldnumber
35696>>>>>  function_return rval#
35697>>>>>end_function
35698>>>>>function FieldInf_DecPoints global integer file# integer field# returns string
35699>>>>>  local integer rval#
35700>>>>>//  if field# lt 256 get_attribute DF_FIELD_PRECISION of file# field# to rval#
35700>>>>>  if field# lt 256 get gl_effective_form_datatype file# field# to rval#
35703>>>>>  else move (piFieldDecPoint.i(FieldInf_VirtualFields_Object(file#),field#-256)) to rval#
35705>>>>>  function_return rval#
35706>>>>>end_function
35707>>>>>function FieldInf_FieldLabel_Long global integer file# integer field# returns string
35708>>>>>  local integer dd#
35709>>>>>  local string rval#
35709>>>>>  move (string_value.ii(field_labels_array#,file#,field#)) to rval#
35710>>>>>  if field# lt 256 begin
35712>>>>>    if rval# eq "" begin // No global label was assigned
35714>>>>>        get iDD_Object file# to dd#
35715>>>>>        if dd# get Field_Label_Long of dd# field# to rval#
35718>>>>>        if rval# eq "" get gl_field_label file# field# to rval#
35721>>>>>    end
35721>>>>>>
35721>>>>>  end
35721>>>>>>
35721>>>>>  else move (psFieldLabel.i(FieldInf_VirtualFields_Object(file#),field#-256)) to rval#
35723>>>>>  function_return rval#
35724>>>>>end_function
35725>>>>>function FieldInf_FieldLabel_Short global integer file# integer field# returns string
35726>>>>>  local integer dd#
35727>>>>>  local string rval#
35727>>>>>  if field# lt 256 begin
35729>>>>>    move (string_value.ii(grid_labels_array#,file#,field#)) to rval#
35730>>>>>    if rval# eq "" begin // No global label was assigned
35732>>>>>        get iDD_Object file# to dd#
35733>>>>>        if dd# get Field_Label_Short of dd# field# to rval#
35736>>>>>        if rval# eq "" get gl_grid_label file# field# to rval#
35739>>>>>    end
35739>>>>>>
35739>>>>>  end
35739>>>>>>
35739>>>>>  else move (psFieldLabel_Short.i(FieldInf_VirtualFields_Object(file#),field#-256)) to rval#
35741>>>>>  function_return rval#
35742>>>>>end_function
35743>>>   object oGridPrepare is a cArray
35745>>>     property integer piNextPrevious public 1
35747>>>     item_property_list
35747>>>       item_property string  psHeaderLabel.i
35747>>>       item_property integer piAbstractOrFile.i
35747>>>       item_property integer piField.i
35747>>>     end_item_property_list
35792>>>     procedure add_column string label# integer abstract# integer field#
35794>>>       local integer row#
35795>>>       get row_count to row#
35796>>>       set psHeaderLabel.i row# to label#
35797>>>       set piAbstractOrFile.i row# to abstract#
35798>>>       set piField.i row# to field#
35799>>>     end_procedure
35800>>>     procedure reset
35802>>>       send delete_data
35803>>>       set piNextPrevious to 1
35804>>>     end_procedure
35805>>>     procedure apply_settings integer obj# integer DoColor#
35807>>>       local integer row# max#
35808>>>       get row_count to max#
35809>>>       set line_width of obj# to max# 0
35810>>>       for row# from 0 to (max#-1)
35816>>>>
35816>>>         set header_label of obj# row# to (psHeaderLabel.i(current_object,row#))
35817>>>         if (piField.i(current_object,row#)) eq -1 ;           set form_margin of obj# row# to (integer_value.ii(form_margin_array#,0,piAbstractOrFile.i(current_object,row#)))
35820>>>         else set form_margin of obj# row# to (gl_effective_form_margin(piAbstractOrFile.i(current_object,row#),piField.i(current_object,row#)))
35822>>>       loop
35823>>>>
35823>>>       set select_mode of obj# to no_select
35824>>>       if DoColor# begin
35826>>>         set highlight_row_state of obj# to true
35827>>>         set highlight_row_color of obj# to (rgb(0,255,255))
35828>>>         set current_item_color of obj# to (rgb(0,255,255))
35829>>>       end
35829>>>>
35829>>>       if (piNextPrevious(current_object)) begin
35831>>>         move current_object to max# // Overload
35832>>>         move obj# to current_object
35833>>>         on_key knext_item send switch
35834>>>         on_key kprevious_item send switch_back
35835>>>         move max# to current_object
35836>>>       end
35836>>>>
35836>>>     end_procedure
35837>>>   end_object // oGridPrepare
35838>>>   procedure GridPrepare_Reset global
35839>>>     send reset to (oGridPrepare(current_object))
35840>>>   end_procedure
35841>>>   procedure GridPrepare_AddCheckBoxColumn global
35842>>>     send add_column to (oGridPrepare(current_object)) "" AFT_ASCII3 -1
35843>>>   end_procedure
35844>>>   procedure GridPrepare_AddColumn global string label# integer abstract#
35845>>>     send add_column to (oGridPrepare(current_object)) label# abstract# -1
35846>>>   end_procedure
35847>>>   procedure GridPrepare_AddColumnFileField global string label# integer file# integer field#
35848>>>     send add_column to (oGridPrepare(current_object)) label# file# field#
35849>>>   end_procedure
35850>>>   procedure GridPrepare_Apply global integer obj# integer DoColor#
35851>>>     local integer tmp#
35852>>>     if num_arguments gt 1 move DoColor# to tmp#
35855>>>     else move 1 to tmp#
35857>>>     send apply_settings to (oGridPrepare(current_object)) obj# tmp#
35858>>>     send GridPrepare_Reset
35859>>>   end_procedure
35860>>>  // Here is a temporary array used for storing different values while
35860>>>  // a grid is being sorted.
35860>>>  object oSortGrid_Data is a cArray no_image
35862>>>    property integer piCurrentGridID public 0 // Not used
35864>>>    property integer piCurrentRow    public 0
35866>>>    property integer piCurrentColumn public 0
35868>>>    object oSortedData is a cArray no_image
35870>>>    end_object
35871>>>    object oAuxValues is a cArray no_image
35873>>>    end_object
35874>>>    object oEntryStates is a cArray no_image
35876>>>    end_object
35877>>>    object oSelectStates is a cArray no_image
35879>>>    end_object
35880>>>     object oItemColors is a cArray no_image
35882>>>     end_object
35883>>>    object oCheckboxItemStates is a cArray no_image
35885>>>    end_object
35886>>>    // Get data out of the grid to this structure
35886>>>    procedure reset
35888>>>      send delete_data
35889>>>      send delete_data to (oAuxValues(current_object))
35890>>>      send delete_data to (oSortedData(current_object))
35891>>>      send delete_data to (oEntryStates(current_object))
35892>>>      send delete_data to (oSelectStates(current_object))
35893>>>      send delete_data to (oCheckboxItemStates(current_object))
35894>>>    //send delete_data to (oMessages(current_object))
35894>>>      send delete_data to (oItemColors(current_object))
35895>>>      set piCurrentGridID to 0
35896>>>      set piCurrentRow to 0
35897>>>      set piCurrentColumn to 0
35898>>>    end_procedure
35899>>>    // Get data from grid
35899>>>    procedure load_grid_data integer oGrd#
35901>>>      local integer max# itm# AuxValues# EntryStates# ci# cc# columns#
35902>>>      local integer SelectStates# CheckboxItemStates# ItemColors#
35902>>>      move (oAuxValues(current_object)) to AuxValues#
35903>>>      move (oEntryStates(current_object)) to EntryStates#
35904>>>      move (oSelectStates(current_object)) to SelectStates#
35905>>>      move (oCheckboxItemStates(current_object)) to CheckboxItemStates#
35906>>>      move (oItemColors(current_object)) to ItemColors#
35907>>>      send delete_data
35908>>>      send delete_data to AuxValues#
35909>>>      send delete_data to EntryStates#
35910>>>      send delete_data to SelectStates#
35911>>>      send delete_data to CheckboxItemStates#
35912>>>      send delete_data to ItemColors#
35913>>>      set piCurrentGridID to oGrd#
35914>>>      get item_count of oGrd# to max#
35915>>>      for itm# from 0 to (max#-1)
35921>>>>
35921>>>        set value item itm# to (value(oGrd#,itm#))
35922>>>        set value of AuxValues# item itm# to (aux_value(oGrd#,itm#))
35923>>>        set value of EntryStates# item itm# to (entry_state(oGrd#,itm#))
35924>>>        set value of SelectStates# item itm# to (select_state(oGrd#,itm#))
35925>>>        set value of CheckboxItemStates# item itm# to (checkbox_item_state(oGrd#,itm#))
35926>>>        set value of ItemColors# item itm# to (ItemColor(oGrd#,itm#))
35927>>>      loop
35928>>>>
35928>>>      get current_item of oGrd# to ci#
35929>>>      get Grid_Columns oGrd# to columns#
35930>>>      set piCurrentRow    to (ci#/columns#)
35931>>>      set piCurrentColumn to (ci#-(columns#*piCurrentRow(current_object)))
35932>>>    end_procedure
35933>>>    register_function iSpecialSortValueOnColumn.i integer column# returns integer
35933>>>    register_function sSortValue.ii integer column# integer itm# returns string
35933>>>    procedure sort_data integer oGrd# integer column#
35935>>>      local integer sort_arr# row# max# columns# itm# st# custom#
35936>>>      local string value#
35936>>>      move (oSortedData(current_object)) to sort_arr#
35937>>>      send delete_data to sort_arr#
35938>>>      get Grid_Columns oGrd# to columns#
35939>>>      get item_count of oGrd# to max#
35940>>>      get delegation_mode of oGrd# to st#
35941>>>      set delegation_mode of oGrd# to NO_DELEGATE_OR_ERROR
35942>>>      get iSpecialSortValueOnColumn.i of oGrd# column# to custom#
35943>>>      set delegation_mode of oGrd# to st#
35944>>>      move (max#/columns#) to max# // Number of rows#
35945>>>      for row# from 0 to (max#-1)
35951>>>>
35951>>>        move (row#*columns#+column#) to itm#
35952>>>        if custom# get sSortValue.ii of oGrd# column# itm# to value#
35955>>>        else get value of oGrd# item itm# to value#
35957>>>        move (value#+IntToStrR(row#,6)) to value#
35958>>>        set value of sort_arr# item row# to value#
35959>>>      loop
35960>>>>
35960>>>      send sort_items to sort_arr# //ASCENDING
35961>>>    end_procedure
35962>>>    procedure fill_grid integer oGrd#
35964>>>      local integer sort_arr# row# max# itm# columns# itm_min# itm_max# cr#
35965>>>      local integer grid_row#
35965>>>      local integer EntryStates# AuxValues# grid_itm#
35965>>>      local integer SelectStates# CheckboxItemStates# ItemColors#
35965>>>      local string value#
35965>>>      move (oSortedData(current_object)) to sort_arr#
35966>>>      move (oAuxValues(current_object)) to AuxValues#
35967>>>      move (oEntryStates(current_object)) to EntryStates#
35968>>>      move (oSelectStates(current_object)) to SelectStates#
35969>>>      move (oCheckboxItemStates(current_object)) to CheckboxItemStates#
35970>>>      move (oItemColors(current_object)) to ItemColors#
35971>>>      send delete_data to oGrd#
35972>>>      get Grid_Columns oGrd# to columns#
35973>>>      get item_count of sort_arr# to max#
35974>>>      get piCurrentRow to cr#
35975>>>      move 0 to grid_itm#
35976>>>      for row# from 0 to (max#-1)
35982>>>>
35982>>>        move (right(value(sort_arr#,row#),6)) to grid_row#
35983>>>        if grid_row# eq cr# set piCurrentRow to row#
35986>>>        move (grid_row#*columns#) to itm_min#
35987>>>        move (itm_min#+columns#-1) to itm_max#
35988>>>        for itm# from itm_min# to itm_max#
35994>>>>
35994>>>          send add_item to oGrd# msg_none (value(current_object,itm#))
35995>>>          set checkbox_item_state of oGrd# item grid_itm# to (value(CheckboxItemStates#,itm#))
35996>>>          set select_state of oGrd# item grid_itm# to (value(SelectStates#,itm#))
35997>>>          set aux_value of oGrd# item grid_itm# to (value(AuxValues#,itm#))
35998>>>          set entry_state of oGrd# item grid_itm# to (value(EntryStates#,itm#))
35999>>>          set itemcolor of oGrd# item grid_itm# to (value(ItemColors#,itm#))
36000>>>          increment grid_itm#
36001>>>        loop
36002>>>>
36002>>>      loop
36003>>>>
36003>>>    end_procedure
36004>>>    procedure Sort_Grid integer oGrd# integer column#
36006>>>      local integer cr# cc# columns#
36007>>>       send cursor_wait to (cursor_control(current_object))
36008>>>      set dynamic_update_state of oGrd# to false
36009>>>      send reset
36010>>>      send load_grid_data oGrd#
36011>>>      send sort_data oGrd# column#
36012>>>      send fill_grid oGrd#
36013>>>      set dynamic_update_state of oGrd# to true
36014>>>      get piCurrentRow to cr#
36015>>>      get piCurrentColumn to cc#
36016>>>      get Grid_Columns oGrd# to columns#
36017>>>      set current_item of oGrd# to (columns#*cr#+cc#)
36018>>>      send reset
36019>>>       send cursor_ready to (cursor_control(current_object))
36020>>>    end_procedure
36021>>>  end_object // oSortGrid_Data
36022>>>//end_desktop_section
36022>>>
36022>>>procedure Grid_SortByColumn global integer oGrd# integer column#
36023>>>  send Sort_Grid to (oSortGrid_Data(current_object)) oGrd# column#
36024>>>end_procedure
36025>>>
36025>>>procedure Grid_AddCheckBoxItem global integer oGrd# integer iState
36026>>>  local integer iItm
36027>>>  get item_count of oGrd# to iItm
36028>>>  send add_item to oGrd# msg_none ""
36029>>>  set checkbox_item_state of oGrd# item iItm to DFTRUE
36030>>>  set select_state of oGrd# item iItm to iState
36031>>>end_procedure
36032>>>procedure Grid_RowMakeSelectable global integer oGrd#
36033>>>end_procedure
36034>>>procedure Grid_RowSelectAll global integer oGrd#
36035>>>  local integer iRow iMax
36036>>>  get Grid_RowCount oGrd# to iMax
36037>>>  decrement iMax
36038>>>  for iRow from 0 to iMax
36044>>>>
36044>>>    set select_state of oGrd# item (Grid_RowBaseItem(oGrd#,iRow)) to DFTRUE
36045>>>  loop
36046>>>>
36046>>>end_procedure
36047>>>procedure Grid_RowDeselectAll global integer oGrd#
36048>>>  local integer iRow iMax
36049>>>  get Grid_RowCount oGrd# to iMax
36050>>>  decrement iMax
36051>>>  for iRow from 0 to iMax
36057>>>>
36057>>>    set select_state of oGrd# item (Grid_RowBaseItem(oGrd#,iRow)) to DFFALSE
36058>>>  loop
36059>>>>
36059>>>end_procedure
36060>>>procedure Grid_RowSelectInvert global integer oGrd#
36061>>>  local integer iRow iMax iSelect iBase
36062>>>  get Grid_RowCount oGrd# to iMax
36063>>>  decrement iMax
36064>>>  for iRow from 0 to iMax
36070>>>>
36070>>>    move (Grid_RowBaseItem(oGrd#,iRow)) to iBase
36071>>>    get select_state of oGrd# item iBase to iSelect
36072>>>    set select_state of oGrd# item iBase to (not(iSelect))
36073>>>  loop
36074>>>>
36074>>>end_procedure
36075>>>procedure Grid_RowSelectCostum global integer oGrd# integer iGet
36076>>>  local integer iRow iMax iSelect iBase
36077>>>  get Grid_RowCount oGrd# to iMax
36078>>>  decrement iMax
36079>>>  for iRow from 0 to iMax
36085>>>>
36085>>>    move (Grid_RowBaseItem(oGrd#,iRow)) to iBase
36086>>>    get iGet of oGrd# iRow iBase to iSelect
36087>>>    set select_state of oGrd# item iBase to iSelect
36088>>>  loop
36089>>>>
36089>>>end_procedure
36090>>>procedure Grid_RowCallBackSelected global integer oGrd# integer iMsg
36091>>>  local integer iRow iMax iBase iSelect
36092>>>  get Grid_RowCount oGrd# to iMax
36093>>>  decrement iMax
36094>>>  for iRow from 0 to iMax
36100>>>>
36100>>>    move (Grid_RowBaseItem(oGrd#,iRow)) to iBase
36101>>>    get select_state of oGrd# item iBase to iSelect
36102>>>    if iSelect send iMsg to oGrd# iRow iBase
36105>>>  loop
36106>>>>
36106>>>end_procedure
36107>>>
36107>>>// procedure row_change integer iRowFrom integer iRowTo
36107>>>// end_procedure
36107>>>// procedure item_change integer iItm1 integer iItm2 returns integer
36107>>>//   local integer iRval iColumns
36107>>>//   get Grid_Columns current_object to iColumns
36107>>>//   forward get msg_item_change iItm1 iItm2 to iRval
36107>>>//   if (iItm1/iColumns) ne (iItm2/iColumns) send row_change (iItm1/iColumns) (iItm2/iColumns)
36107>>>//   procedure_return iRval
36107>>>// end_procedure
36107>>>
36107>>>// procedure select_toggling integer itm# integer i#
36107>>>//   local integer ci# iColumns
36107>>>//   get Grid_Columns current_object to iColumns
36107>>>//   get current_item to ci#
36107>>>//   move ((ci#/iColumns)*iColumns) to ci# // Redirect to first column
36107>>>//   forward send select_toggling ci# i#
36107>>>// end_procedure
36107>>>
36107>Use rptVw.Sub
INCLUDING FILE: RPTVW.SUB
36107>>>Use DFRptvw.pkg
36107>>>Use dbRptvw.pkg
INCLUDING FILE: DBRPTVW.PKG
36107>>>>>
36107>>>>>Use Windows
36107>>>>>Use DfPanel
36107>>>>>Use EnClient
36107>>>>>Use DFNav_mx
36107>>>>>Use dfConfrm
36107>>>>>Use dfRptVw
36107>>>>>Use DFGSINI
36107>>>>>
36107>>>>>Class dbReportAppClient_ is a ReportView STARTMAC ECstart
36108>>>>>    Import_Class_Protocol Entry_Client
36109>>>>>    //  Defeat the activating augmentation for auto-locate
36109>>>>>    Procedure Activating Returns Integer
36110>>>>>      local integer RVal
36111>>>>>      forward get MSG_activating to rVal
36113>>>>>      Procedure_Return rVal
36114>>>>>    End_Procedure
36115>>>>>End_Class // dbReportAppClient_
36116>>>>>
36116>>>>>Class dbReportAppView_ is a dbReportAppClient_
36117>>>>>  import_Class_protocol entry_view_Client
36118>>>>>End_Class // dbReportAppView_
36119>>>>>
36119>>>>>
36119>>>>>Class dbReportView is a dbReportAppView_
36120>>>>>
36120>>>>>     Procedure Construct_Object
36121>>>>>      Forward Send Construct_Object No_Image
36123>>>>>      Send Define_DFNavigation  // GUI navigate changes
36124>>>>>      // dialog views get activated as popup objects.
36124>>>>>      set Dso_Detach_Mode to Detach_Always
36125>>>>>
36125>>>>>      Set Verify_Data_Loss_Msg TO GET_No_Confirmation
36126>>>>>      Set Verify_Delete_Msg    TO GET_No_Confirmation
36127>>>>>      Set Verify_Save_Msg      TO GET_No_Confirmation
36128>>>>>      Set Verify_Exit_Msg      TO GET_No_confirmation
36129>>>>>      //
36129>>>>>      // This reportview-client will almost always be a modalpanel, therefore minimizing
36129>>>>>      // is out of the question...
36129>>>>>      Set Minimize_Icon To False
36130>>>>>      Set Maximize_Icon To False
36131>>>>>   End_Procedure // Construct_Object
36132>>>>>
36132>>>>>   Procedure Request_Delete
36133>>>>>   End_Procedure // request_delete
36134>>>>>
36134>>>>>   Procedure Request_Save
36135>>>>>   End_Procedure // request_save
36136>>>>>
36136>>>>>   Function Exit_Application_Check Returns Integer
36137>>>>>     Function_return 0
36138>>>>>   End_Function
36139>>>>>
36139>>>>>   Import_Class_Protocol DFNavigate_Mixin
36140>>>>>
36140>>>>>  //  Returns TRUE to indicate that this is a DEO. This is used by
36140>>>>>  //  delegation to figure out if you are within a DEO and should therefore
36140>>>>>  //  send a DEO message. DEO clients set this true
36140>>>>>  Function DEO_Object Returns integer
36141>>>>>    Function_Return 1
36142>>>>>  End_Function // DEO_Object
36143>>>>>
36143>>>>>  //
36143>>>>>  //  Activate message for views that:
36143>>>>>  //  1. restores the view if it is minimized
36143>>>>>  //  2. Maintains the current scope's focus.
36143>>>>>  //
36143>>>>>  Procedure Activate_current_scope
36144>>>>>    If ( View_mode(Current_Object)=VIEWMODE_ICONIZE ) ;       Set view_mode to viewmode_normal
36147>>>>>    Set Current_Scope to Current_Object
36148>>>>>  End_Procedure // Activate_current_scope
36149>>>>>
36149>>>>>  //  Pass full object name - return the relative name
36149>>>>>  //  e.g.,  Main.View.Obj1 --> Obj1
36149>>>>>  Function Local_Object_name string nm returns string
36150>>>>>     local integer ps
36151>>>>>     Repeat
36151>>>>>>
36151>>>>>       pos "." in nm to ps
36153>>>>>>
36153>>>>>       If ps eq 0 function_return nm
36156>>>>>       increment ps
36157>>>>>       Mid Nm to Nm 255 ps
36160>>>>>>
36160>>>>>     Loop
36161>>>>>>
36161>>>>>  end_function
36162>>>>>
36162>>>>>  //  Take string "#1,#2" and return integer hi #1 + #2
36162>>>>>  Function Parse_Complex string sVal returns integer
36163>>>>>     Local integer ps
36164>>>>>     Pos "," in sVal to ps
36166>>>>>>
36166>>>>>     if ps ;        Function_Return ( integer(left(sVal,ps-1))*65536 + ;                          integer(mid(sVal,255,ps+1)) )
36169>>>>>  End_Function // Parse_Complex
36170>>>>>
36170>>>>>  // Convert a complex integer to a string "hi,Low"
36170>>>>>  //
36170>>>>>  Function Complex_to_String integer i1 returns string
36171>>>>>     function_return ( string(hi(i1)) - "," - String(low(i1)) )
36172>>>>>  End_function
36173>>>>>
36173>>>>>
36173>>>>>  // *WvA: I don't want to save locations of a reportview noted in the registry.
36173>>>>>  // These printing dialogs are centered on the panel anyway, so it doesn't make any
36173>>>>>  // sense to clutter up the registry with this kind of nonsense.
36173>>>>>  ////
36173>>>>>  ////  Save View information to dfwin.ini file. Save as:
36173>>>>>  ////  View_ObjectName=LOC:Row,Col  e.g., Cust_Ent=LOC:10,20
36173>>>>>  ////     Leaving room for growth here.
36173>>>>>  ////
36173>>>>>  Procedure Save_Environment
36174>>>>>  //   Local String nm Vn st
36174>>>>>  //   Local Integer H
36174>>>>>  //
36174>>>>>  //   Get System_Profile_String "SaveEnvironment" to St
36174>>>>>  //   Move (Uppercase(trim(st))) to st
36174>>>>>  //   If (st="YES" or st="ON" or st="TRUE") Begin
36174>>>>>  //     // Note with the 3.05 version we will have problems if the view has
36174>>>>>  //     // been maximized and then iconized. We still don't know what the normal
36174>>>>>  //     // size/loc is when maximized. We will take a chance and assume that an
36174>>>>>  //     // iconized view is always non-zoomed (since views don't support the zoom
36174>>>>>  //     // button).
36174>>>>>  //     If (View_mode(Current_Object)<>VIEWMODE_ZOOM) Begin
36174>>>>>  //
36174>>>>>  //       Get Name to Vn // full name of object
36174>>>>>  //       Get Local_Object_Name Vn to Vn   // just get the local name
36174>>>>>  //       Get GUILocation to H             // complex location
36174>>>>>  //       Get Complex_to_String h to nm    // convert complex to "hi,low"
36174>>>>>  //       Set System_Profile_String VN to ("LOC:"+Nm)
36174>>>>>  //     End
36174>>>>>  //   End
36174>>>>>  //
36174>>>>>  End_Procedure
36175>>>>>  //
36175>>>>>  //// Augment to check for view string in .INI. Currently, if found
36175>>>>>  //// set the location
36175>>>>>  ////
36175>>>>>  Procedure Load_Environment
36176>>>>>  //   Local String nm Vn Lc
36176>>>>>  //   Local Integer H ps
36176>>>>>  //   // see above for reasoning on this
36176>>>>>  //   If (View_mode(Current_Object)=VIEWMODE_NORMAL) Begin
36176>>>>>  //     Get Name to Vn
36176>>>>>  //     Get Local_Object_Name Vn to Vn
36176>>>>>  //     Get System_Profile_String Vn to Nm
36176>>>>>  //     IF Nm ne '' Begin
36176>>>>>  //        Pos "LOC:" in Nm to Ps   // look for LOC:row,col
36176>>>>>  //        If Ps Begin
36176>>>>>  //           Mid Nm to Lc 255 (Ps+4)
36176>>>>>  //           Pos " " in Lc to ps
36176>>>>>  //           if Ps left lc to lc (ps-1)
36176>>>>>  //           Get Parse_Complex lc to H
36176>>>>>  //           Set GUILocation to (Hi(H)) (Low(H))
36176>>>>>  //           Send Adjust_Logicals
36176>>>>>  //        End
36176>>>>>  //     End
36176>>>>>  //   End
36176>>>>>  End_Procedure
36177>>>>>
36177>>>>>  Function View_Changed returns Integer
36178>>>>>     Local Integer Changed
36179>>>>>     Broadcast Get Data_Set_Should_Save to Changed // Ask for changes in Data-sets
36181>>>>>     Function_Return Changed
36182>>>>>  End_Function
36183>>>>>
36183>>>>>  Procedure Notify_Exit_Application
36184>>>>>    Send Save_Environment
36185>>>>>  End_procedure
36186>>>>>
36186>>>>>  Procedure End_Construct_Object
36187>>>>>     Send Load_Environment
36188>>>>>     //Send Define_SysMenu
36188>>>>>     Forward Send End_Construct_Object
36190>>>>>  End_Procedure // End_Construct_Object
36191>>>>>
36191>>>>>  Procedure Close_Client
36192>>>>>     Send Exit_Function
36193>>>>>  End_Procedure
36194>>>>>
36194>>>>>  Procedure Entering_Scope returns Integer
36195>>>>>     Local Integer rVal
36196>>>>>     Forward Get MSG_Entering_Scope to rVal
36198>>>>>     If not rVal send Show_View_Name (Label(Current_Object))
36201>>>>>  End_Procedure
36202>>>>>
36202>>>>>  Procedure Exiting_Scope integer whereto returns Integer
36203>>>>>     Local Integer rVal
36204>>>>>     Forward Get MSG_Exiting_Scope whereto to rVal
36206>>>>>     If not rVal Send Show_View_Name ''
36209>>>>>  End_Procedure
36210>>>>>
36210>>>>>  Procedure Show_view_Name string sHelp
36211>>>>>     Local Integer rVal Id
36212>>>>>     Get Statusbar_id to id
36213>>>>>     If Id Send Show_View_Name to Id sHelp
36216>>>>>  End_Procedure
36217>>>>>
36217>>>>>  Function Should_Save_Recursive returns integer
36218>>>>>    Function_return (View_Changed(Current_Object))
36219>>>>>  End_Function
36220>>>>>
36220>>>>>End_Class // dbReportView
36221>>>
36221>>>Class ReportViewSub is a ReportView
36222>>>
36222>>>    Procedure Construct_Object
36223>>>        Forward Send Construct_Object
36225>>>        Property Integer Server 0
36226>>>    End_Procedure // Construct_Object
36227>>>
36227>>>    Procedure Page Integer PageMode
36228>>>        Integer hWnd
36229>>>        Forward Send Page PageMode
36231>>>        Get Window_Handle to hWnd
36232>>>        If (hWnd) Begin
36234>>>            Send GreekSysMenu
36235>>>        End
36235>>>>
36235>>>    End_Procedure
36236>>>
36236>>>    Procedure Close_Panel
36237>>>        Local Integer liScope
36238>>>        Move (Prior_Scope(Desktop)) To liScope
36239>>>        Move (Scope_Focus(liScope)) To liScope
36240>>>        Forward Send Close_Panel
36242>>>        Send Activate To liScope
36243>>>    End_Procedure // Close_Panel
36244>>>
36244>>>End_Class
36245>>>
36245>>>Class dbReportViewSub is a dbReportView
36246>>>
36246>>>    Procedure Construct_Object
36247>>>        Forward Send Construct_Object
36249>>>        Property Integer Server 0
36250>>>    End_Procedure // Construct_Object
36251>>>
36251>>>    Procedure Page Integer PageMode
36252>>>        Integer hWnd
36253>>>        Forward Send Page PageMode
36255>>>        Get Window_Handle to hWnd
36256>>>        If (hWnd) Begin
36258>>>            Send GreekSysMenu
36259>>>        End
36259>>>>
36259>>>    End_Procedure
36260>>>
36260>>>    Procedure Close_Panel
36261>>>        Local Integer liScope
36262>>>        Move (Prior_Scope(Desktop)) To liScope
36263>>>        Move (Scope_Focus(liScope)) To liScope
36264>>>        Forward Send Close_Panel
36266>>>        Send Activate To liScope
36267>>>    End_Procedure // Close_Panel
36268>>>End_Class
36269>>>
36269>
36269>//------------------------------
36269>Use Flexole
INCLUDING FILE: FLEXOLE.PKG
36269>>>//****************************************************************************
36269>>>//
36269>>>// $File name  : FlexOLE
36269>>>// $File title : Base class for OLE Automation in DataFlex under win95/NT
36269>>>// Notice      : Copyright (c) ADB-UTVECKLING AB 1996-1998
36269>>>// $Author     : JW, SF
36269>>>// $System     : DFOLE
36269>>>// Created     : 96-05-30 @ 18.12.51
36269>>>// $Last Rev   : 96-10-09 @ 14.59.35
36269>>>//
36269>>>// $Description
36269>>>// This file contains the complete FlexOLE OLE2 implementation in DataFlex.
36269>>>// Including all DLL interface declarations and DataFlex classes
36269>>>//
36269>>>// $Rev History
36269>>>//   96-05-30 File header created
36269>>>//
36269>>>//****************************************************************************
36269>>>
36269>>>USE DLL
36269>>>USE FOLE_API
INCLUDING FILE: FOLE_API.PKG
36269>>>>>//****************************************************************************
36269>>>>>//
36269>>>>>// $File name  : FOLE_API
36269>>>>>// $File title : API for FlexOLE
36269>>>>>// Notice      : Copyright (c) ADB-UTVECKLING AB 1996-1998
36269>>>>>// $Author     : JW, SF
36269>>>>>// $System     : FlexOLE
36269>>>>>// Created     : 96-05-30 @ 18.12.51
36269>>>>>// $Last Rev   : 96-10-09 @ 14.59.35
36269>>>>>//
36269>>>>>// $Description
36269>>>>>//  DLL interface declarations
36269>>>>>//
36269>>>>>// $Rev History
36269>>>>>//   96-05-30 File header created
36269>>>>>//
36269>>>>>//****************************************************************************
36269>>>>>
36269>>>>>
36269>>>>>USE DLL
36269>>>>>
36269>>>>>// Global variable for OLE
36269>>>>>Integer WM_DFOCXEVENT // This is the message sent from the DLL
36269>>>>>Integer WM_DFOCXNOTIFYEVENT // This is the notify message sent from the DLL
36269>>>>>
36269>>>>>//Global integer for objectId
36269>>>>>Integer oOLEVariantId
36269>>>>>
36269>>>>>
36269>>>>>
36269>>>>>// Optional param for OLEVariant.
36269>>>>>// For optional parameters, pass OLE_VT_OPTIONAL instead of an OLEVariant
36269>>>>>
36269>>>>>// DISP_E_PARAMNOTFOUND is the constant used together with OLE_VT_ERROR
36269>>>>>// to signify that this parameter is optional and not specified.
36269>>>>>// It is only used internally, DON'T use it directly, see above constant.
36269>>>>>
36269>>>>>// The current maximum size of strings, used both for String and OLEVariant with OLE_VT_BSTR
36269>>>>>
36269>>>>>// Null terminating for C strings
36269>>>>>
36269>>>>>// Alias data types
36269>>>>>                            // but since DataFlex has no substitute data type
36269>>>>>                            // it is internally casted back and forth
36269>>>>>                            // into an Integer
36269>>>>>                            // NOTE! Might be changed to a one char string
36269>>>>>
36269>>>>>
36269>>>>>
36269>>>>>// Pointers to vars needs to be inside a Type to use GetAddress...
36269>>>>>// It looks like we have to create these anyway (to compile cleanly)
36269>>>>>
36269>>>>>
36269>>>>>Type TP_OLEVariant
36269>>>>>    Field Variant.vt     as DWORD      // An OLE_VT_XXX constant
36269>>>>>    Field Variant.iVal   as DWORD      // If vt is OLE_VT_I2 this field contains a Short value
36269>>>>>    Field Variant.lVal   as DWORD      // If vt is OLE_VT_I4 this field contains an Integer value
36269>>>>>    Field Variant.fltVal as Char 10    // If vt is OLE_VT_R4 this field contains a ShortReal value
36269>>>>>    Field Variant.dblVal as Char 20    // If vt is OLE_VT_R8 this field contains a Real value
36269>>>>>    Field Variant.cyVal  as Char 25    // If vt is OLE_VT_CY this field contains a Currency value
36269>>>>>    Field Variant.dtVal  as Date       // If vt is OLE_VT_DATE this field contains a Date value
36269>>>>>    Field Variant.strVal as Char 255   // If vt is OLE_VT_BSTR this field contains a pointer to a String
36269>>>>>    Field Variant.dspVal as LPDISPATCH // If vt is OLE_VT_DISPATCH this field contains an LPDISPATCH
36269>>>>>    Field Variant.errVal as OLEError   // If vt is OLE_VT_ERROR this field contains an OLEError
36269>>>>>    Field Variant.blVal  as Bool       // If vt is OLE_VT_BOOL this field contains a Bool value
36269>>>>>    Field Variant.uknVal as LPIUNKNOWN // If vt is OLE_VT_UNKNOWN this field contains an LPIUnknown
36269>>>>>    Field Variant.ui1Val as DWORD      // If vt is OLE_VT_UI1 this field contains a UChar value
36269>>>>>End_Type
36269>>>>>
36269>>>>>
36269>>>>>// VARIANT constants used with the vt field in an OLEVariant type
36269>>>>>
36269>>>>>
36269>>>>>
36269>>>>>// SetFocus/KillFocus event, sent in wParam of WM_DFOCXNOTIFYEVENT
36269>>>>>
36269>>>>>// Used to register the OCX event notification messages
36269>>>>>External_Function32 RegisterWindowMessage "RegisterWindowMessageA" USER32.DLL;                    String sWM_MSG;                    Returns Integer
36270>>>>>
36270>>>>>// External functions providing access to DFOLECLN.DLL
36270>>>>>// These functions are normally not accessed directly, they are
36270>>>>>// rather accessed through an Automation_Client/OCX_Client derived class/object
36270>>>>>
36270>>>>>//********DLL Interface OLE Auto General Functions************
36270>>>>>
36270>>>>>External_Function32 CreateAutomationClient "CreateAutomationClient" DFOLECLN.DLL;                    Returns DWORD
36271>>>>>
36271>>>>>
36271>>>>>External_Function32 DestroyAutomationClient "DestroyAutomationClient" DFOLECLN.DLL;                    Integer clientId;                    Returns DWORD
36272>>>>>
36272>>>>>External_Function32 CreateAutoClientDispatch "CreateAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    String progIdStr;                    Returns DWORD
36273>>>>>
36273>>>>>External_Function32 AttachAutoClientDispatch "AttachAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    LPDispatch disp;                    Integer addRef;                    Returns DWORD
36274>>>>>
36274>>>>>External_Function32 AttachAutoClientActiveObject "AttachAutoClientActiveObject" DFOLECLN.DLL;                    Integer clientId;                    String progIdStr;                    Returns DWORD
36275>>>>>
36275>>>>>External_Function32 ReleaseAutoClientDispatch "ReleaseAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    Returns DWORD
36276>>>>>
36276>>>>>External_Function32 GetAutoClientDispatch "GetAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    Returns LPDispatch
36277>>>>>
36277>>>>>//********DLL Interface OLE Auto Get Property Functions**************
36277>>>>>
36277>>>>>External_Function32 GetAutoClientBoolProperty "GetAutoClientBoolProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
36278>>>>>
36278>>>>>External_Function32 GetAutoClientCurrencyProperty "GetAutoClientCurrencyProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
36279>>>>>
36279>>>>>External_Function32 GetAutoClientDateProperty "GetAutoClientDateProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Date
36280>>>>>
36280>>>>>External_Function32 GetAutoClientLPDispatchProperty "GetAutoClientLPDispatchProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns LPDispatch
36281>>>>>
36281>>>>>External_Function32 GetAutoClientRealProperty "GetAutoClientRealProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
36282>>>>>
36282>>>>>External_Function32 GetAutoClientShortRealProperty "GetAutoClientShortRealProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Real
36283>>>>>
36283>>>>>External_Function32 GetAutoClientIntegerProperty "GetAutoClientIntegerProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
36284>>>>>
36284>>>>>External_Function32 GetAutoClientShortProperty "GetAutoClientShortProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Integer
36285>>>>>
36285>>>>>
36285>>>>>External_Function32 GetAutoClientStringProperty "GetAutoClientStringProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns DWORD
36286>>>>>
36286>>>>>External_Function32 GetAutoClientOLEVariantProperty "GetAutoClientOLEVariantProperty" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    LPOLEVar destVar;                    Returns  LPOLEVar
36287>>>>>
36287>>>>>
36287>>>>>//********DLL Interface OLE Auto Set Property Functions**************
36287>>>>>
36287>>>>>External_Function32 SetAutoClientBoolProperty "SetAutoClientBoolProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    DWORD    prop;                    Returns DWORD
36288>>>>>
36288>>>>>External_Function32 SetAutoClientCurrencyProperty "SetAutoClientCurrencyProperty" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    String prop;                    Returns  DWORD
36289>>>>>
36289>>>>>External_Function32 SetAutoClientDateProperty "SetAutoClientDateProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Date    prop;                    Returns DWORD
36290>>>>>
36290>>>>>External_Function32 SetAutoClientLPDispatchProperty "SetAutoClientLPDispatchProperty" DFOLECLN.DLL;                    Integer    clientId;                    DWORD    dwDispId;                    LPDispatch prop;                    Returns    DWORD
36291>>>>>
36291>>>>>External_Function32 SetAutoClientRealProperty "SetAutoClientRealProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    String   prop;                    Returns DWORD
36292>>>>>
36292>>>>>External_Function32 SetAutoClientShortRealProperty "SetAutoClientShortRealProperty" DFOLECLN.DLL;                    Integer   clientId;                    DWORD   dwDispId;                    String prop;                    Returns   DWORD
36293>>>>>
36293>>>>>External_Function32 SetAutoClientIntegerProperty "SetAutoClientIntegerProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    DWORD prop;                    Returns DWORD
36294>>>>>
36294>>>>>External_Function32 SetAutoClientShortProperty "SetAutoClientShortProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Integer   prop;                    Returns DWORD
36295>>>>>
36295>>>>>External_Function32 SetAutoClientStringProperty "SetAutoClientStringProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    String  prop;                    Returns DWORD
36296>>>>>
36296>>>>>External_Function32 SetAutoClientOLEVariantProperty "SetAutoClientOLEVariantProperty" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    String prop;                    Returns  DWORD
36297>>>>>
36297>>>>>
36297>>>>>//******DLL Interface OLE Auto Pre Invoke Functions**************
36297>>>>>
36297>>>>>External_Function32 DeclareAutoClientInvokeParams "DeclareAutoClientInvokeParams" DFOLECLN.DLL;                    Integer clientId;                    DWORD nrOfParams;                    Returns DWORD
36298>>>>>
36298>>>>>External_Function32 DefineAutoClientBoolParam "DefineAutoClientBoolParam" DFOLECLN.DLL;                    Integer clientId;                    DWORD    param;                    Returns DWORD
36299>>>>>
36299>>>>>External_Function32 DefineAutoClientCurrencyParam "DefineAutoClientCurrencyParam" DFOLECLN.DLL;                    Integer clientId;                    String  param;                    Returns DWORD
36300>>>>>
36300>>>>>External_Function32 DefineAutoClientDateParam "DefineAutoClientDateParam" DFOLECLN.DLL;                    Integer clientId;                    Date    param;                    Returns DWORD
36301>>>>>
36301>>>>>External_Function32 DefineAutoClientRealParam "DefineAutoClientRealParam" DFOLECLN.DLL;                    Integer clientId;                    String    param;                    Returns DWORD
36302>>>>>
36302>>>>>External_Function32 DefineAutoClientShortRealParam "DefineAutoClientShortRealParam" DFOLECLN.DLL;                    Integer   clientId;                    String param;                    Returns   DWORD
36303>>>>>
36303>>>>>External_Function32 DefineAutoClientIntegerParam "DefineAutoClientIntegerParam" DFOLECLN.DLL;                    Integer clientId;                    DWORD param;                    Returns DWORD
36304>>>>>
36304>>>>>External_Function32 DefineAutoClientShortParam "DefineAutoClientShortParam" DFOLECLN.DLL;                    Integer clientId;                    Integer   param;                    Returns DWORD
36305>>>>>
36305>>>>>External_Function32 DefineAutoClientLPDispatchParam "DefineAutoClientLPDispatchParam" DFOLECLN.DLL;                    Integer clientId;                    LPDispatch param;                    Returns DWORD
36306>>>>>
36306>>>>>External_Function32 DefineAutoClientStringParam "DefineAutoClientStringParam" DFOLECLN.DLL;                    Integer clientId;                    String  param;                    Returns DWORD
36307>>>>>
36307>>>>>External_Function32 DefineAutoClientOLEVariantParam "DefineAutoClientOLEVariantParam" DFOLECLN.DLL;                    Integer  clientId;                    OLEVariant param;                    Returns  DWORD
36308>>>>>
36308>>>>>//********DLL Interface OLE Auto Invoke Functions*********************
36308>>>>>
36308>>>>>External_Function32 InvokeAutoClientVoidFunction "InvokeAutoClientVoidFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
36309>>>>>
36309>>>>>External_Function32 InvokeAutoClientBoolFunction "InvokeAutoClientBoolFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
36310>>>>>
36310>>>>>External_Function32 InvokeAutoClientCurrencyFunction "InvokeAutoClientCurrencyFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
36311>>>>>
36311>>>>>External_Function32 InvokeAutoClientDateFunction "InvokeAutoClientDateFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Date
36312>>>>>
36312>>>>>External_Function32 InvokeAutoClientLPDispatchFunction "InvokeAutoClientLPDispatchFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns LPDispatch
36313>>>>>
36313>>>>>External_Function32 InvokeAutoClientRealFunction "InvokeAutoClientRealFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
36314>>>>>
36314>>>>>External_Function32 InvokeAutoClientShortRealFunction "InvokeAutoClientShortRealFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
36315>>>>>
36315>>>>>External_Function32 InvokeAutoClientIntegerFunction "InvokeAutoClientIntegerFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
36316>>>>>
36316>>>>>External_Function32 InvokeAutoClientShortFunction "InvokeAutoClientShortFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Integer
36317>>>>>
36317>>>>>External_Function32 InvokeAutoClientStringFunction "InvokeAutoClientStringFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer  destStr;                    Returns Integer
36318>>>>>
36318>>>>>
36318>>>>>External_Function32 InvokeAutoClientOLEVariantFunction "InvokeAutoClientOLEVariantFunction" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    LPOLEVar destVar;                    Returns  Integer
36319>>>>>
36319>>>>>//********DLL Interface OLE Control Functions*********************
36319>>>>>
36319>>>>>
36319>>>>>External_Function32 CreateOCXClient "CreateOCXClient" DFOLECLN.DLL;                    Returns Integer
36320>>>>>
36320>>>>>
36320>>>>>External_Function32 CreateOCXControl "CreateOCXControl" DFOLECLN.DLL;                    Integer iCId;                    Pointer pPar;                    String  sCId;                    String  sCap;                    Dword   wSty;                    String  sLic;                    String  sFile;                    Returns Integer
36321>>>>>
36321>>>>>External_Function32 DestroyOCXControl "DestroyOCXControl" DFOLECLN.DLL;                    Integer iClientId;                    Returns Integer
36322>>>>>
36322>>>>>External_Function32 GetOCXEventBoolParam "GetOCXEventBoolParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Integer
36323>>>>>
36323>>>>>External_Function32 GetOCXEventCurrencyParam "GetOCXEventCurrencyParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer destStr;                    Returns Integer
36324>>>>>
36324>>>>>External_Function32 GetOCXEventDateParam "GetOCXEventDateParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Date
36325>>>>>
36325>>>>>External_Function32 GetOCXEventRealParam "GetOCXEventRealParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer destStr;                    Returns Integer
36326>>>>>
36326>>>>>External_Function32 GetOCXEventShortRealParam "GetOCXEventShortRealParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer destStr;                    Returns Integer
36327>>>>>
36327>>>>>External_Function32 GetOCXEventIntegerParam "GetOCXEventIntegerParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Integer
36328>>>>>
36328>>>>>External_Function32 GetOCXEventShortParam "GetOCXEventShortParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Integer
36329>>>>>
36329>>>>>External_Function32 GetOCXEventStringParam "GetOCXEventStringParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer pDestStr;                    Returns Integer
36330>>>>>
36330>>>>>External_Function32 GetOCXEventOLEVariantParam "GetOCXEventOLEVariantParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    LPOLEVAR pDestVar;                    Returns Integer
36331>>>>>
36331>>>>>External_Function32 EnableOCXControl "EnableOCXControl" DFOLECLN.DLL;                    Integer iClientId;                    BOOL bEnable;                    Returns Integer
36332>>>>>
36332>>>>>External_Function32 GetOCXControlCaption "GetOCXControlCaption" DFOLECLN.DLL;                    Integer iClientId;                    Pointer lpDestStr;                    Returns Integer
36333>>>>>
36333>>>>>External_Function32 SetOCXControlCaption "SetOCXControlCaption" DFOLECLN.DLL;                    Integer iClientId;                    String  sCaption;                    Returns Integer
36334>>>>>
36334>>>>>External_Function32 LoadOlePicture "LoadOlePicture" DFOLECLN.DLL;                    String  sFilename;                    Returns LPDispatch
36335>>>>>
36335>>>>>External_Function32 ReleaseComPointer "ReleaseComPtr" DFOLECLN.DLL;                    LPIUnknown  comPtr;                    Returns Integer
36336>>>>>
36336>>>>>External_Function32 DFOleInit "DFOleInit" DFOLECLN.DLL;                    Returns Integer
36337>>>>>
36337>>>>>External_Function32 DFOleUninit "DFOleUninit" DFOLECLN.DLL;                    Returns Integer
36338>>>>>
36338>>>>>External_Function32 AlterOCXEventParam "AlterOCXEventParam" DFOLECLN.DLL;                    Pointer  pdispParams;                    Integer iparam;                    OLEVariant vNewValue;                    Returns  Integer
36339>>>>>
36339>>>>>
36339>>>>>
36339>>>>>// This command is only used internaly and should NOT be used by the developer
36339>>>>>
36339>>>USE DFEXTCLM
36339>>>USE EXTFRM
36339>>>USE DBEXTFRM
36339>>>
36339>>>//**********
36339>>>//*** Error messages***
36339>>>//**********
36339>>>
36339>>>    Enum_List
36339>>>        Define OLE_SV_LANG
36339>>>        Define OLE_US_LANG
36339>>>    End_Enum_List
36339>>>
36339>>>    Define OLE_CURR_LANG For OLE_US_LANG
36339>>>
36339>>>        //*** US
INCLUDING FILE: FLXOLEUS.INC
36339>>>>
36339>>>
36339>>>
36339>>>// This class encapsulates the behaviour of an OLEVariant, and simplifies
36339>>>// tasks involved working with the OLEVariant.
36339>>>Class cOLEVariant is an array
36340>>>    Procedure Construct_Object
36341>>>        Forward Send Construct_Object
36343>>>        Local Integer iRetVal
36344>>>        Move (DFOleInit()) to iRetVal
36345>>>        Send OCXInit
36346>>>    End_Procedure
36347>>>
36347>>>    Procedure Destroy_Object
36348>>>        Local Integer iRetVal
36349>>>        Move (DFOleUninit()) to iRetVal
36350>>>        Forward Send Destroy_Object
36352>>>    End_Procedure
36353>>>
36353>>>    Procedure OCXInit
36354>>>        Move (RegisterWindowMessage("WM_DFOCXEVENT")) to WM_DFOCXEVENT
36355>>>        Move (RegisterWindowMessage("WM_DFOCXNOTIFYEVENT")) to WM_DFOCXNOTIFYEVENT
36356>>>    End_Procedure
36357>>>
36357>>>    Function GetType  OLEVariant var Returns DWORD
36358>>>        Local DWORD varVt
36359>>>        GetBuff from var at Variant.vt to varVt
36360>>>        Function_Return varVt
36361>>>    End_Function
36362>>>
36362>>>    Function GetShort OLEVariant var Returns Integer
36363>>>        Local Integer iVal
36364>>>        GetBuff from var at Variant.iVal to iVal
36365>>>        Function_Return iVal
36366>>>    End_Function
36367>>>
36367>>>    Function GetInteger OLEVariant var Returns Integer
36368>>>        Local Integer lVal
36369>>>        GetBuff from var at Variant.lVal to lVal
36370>>>        Function_Return lVal
36371>>>    End_Function
36372>>>
36372>>>    Function GetFloat OLEVariant var Returns OLEReal
36373>>>        Local OLEReal fltVal
36374>>>        GetBuff_String from var at Variant.fltVal to fltVal
36375>>>        Function_Return fltVal
36376>>>    End_Function
36377>>>
36377>>>    Function GetDouble OLEVariant var Returns OLEReal
36378>>>        Local OLEReal dblVal
36379>>>        GetBuff_String from var at Variant.dblVal to dblVal
36380>>>        Function_Return dblVal
36381>>>    End_Function
36382>>>
36382>>>    Function GetCurrency OLEVariant var Returns Number
36383>>>        Local Number cyVal
36384>>>        GetBuff_String from var at Variant.cyVal to cyVal
36385>>>        Function_Return cyVal
36386>>>    End_Function
36387>>>
36387>>>    Function GetDate OLEVariant var Returns Date
36388>>>        Local Date dtVal
36389>>>        GetBuff from var at Variant.dtVal to dtVal
36390>>>        Function_Return dtVal
36391>>>    End_Function
36392>>>
36392>>>    Function GetString OLEVariant var Returns String
36393>>>        Local String strVal
36394>>>        GetBuff_String from var at Variant.strVal to strVal
36395>>>        Function_Return strVal
36396>>>    End_Function
36397>>>
36397>>>    Function GetLPDispatch OLEVariant var Returns LPDispatch
36398>>>        Local LPDispatch dspVal
36399>>>        GetBuff from var at Variant.dspVal to dspVal
36400>>>        Function_Return dspVal
36401>>>    End_Function
36402>>>
36402>>>    Function GetOLEError OLEVariant var Returns OLEError
36403>>>        Local OLEError errVal
36404>>>        GetBuff from var at Variant.errVal to errVal
36405>>>        Function_Return errVal
36406>>>    End_Function
36407>>>
36407>>>    Function GetBool OLEVariant var Returns Bool
36408>>>        Local Bool blVal
36409>>>        GetBuff from var at Variant.blVal to blVal
36410>>>        Function_Return blVal
36411>>>    End_Function
36412>>>
36412>>>    Function GetLPIUnknown OLEVariant var Returns LPIUnknown
36413>>>        Local LPIUnknown uknVal
36414>>>        GetBuff from var at Variant.uknVal to uknVal
36415>>>        Function_Return uknVal
36416>>>    End_Function
36417>>>
36417>>>    Function GetUChar OLEVariant var Returns UChar
36418>>>        Local UChar ui1Val
36419>>>        GetBuff from var at Variant.ui1Val to ui1Val
36420>>>        Function_Return ui1Val
36421>>>    End_Function
36422>>>
36422>>>    Function GetValue OLEVariant var Returns String
36423>>>        Local DWORD vt
36424>>>        Local String retVal
36424>>>        Get GetType var to vt
36425>>>             If vt Eq OLE_VT_I2        Get GetShort var to retVal
36428>>>        Else If vt Eq OLE_VT_I4        Get GetInteger var to retVal
36432>>>        Else If vt Eq OLE_VT_R4        Get GetFloat var to retVal
36436>>>        Else If vt Eq OLE_VT_R8        Get GetDouble var to retVal
36440>>>        Else If vt Eq OLE_VT_CY        Get GetCurrency var to retVal
36444>>>        Else If vt Eq OLE_VT_DATE      Get GetDate var to retVal
36448>>>        Else If vt Eq OLE_VT_BSTR      Get GetString var to retVal
36452>>>        Else If vt Eq OLE_VT_DISPATCH  Get GetLPDispatch var to retVal
36456>>>        Else If vt Eq OLE_VT_ERROR     Get GetOLEError var to retVal
36460>>>        Else If vt Eq OLE_VT_BOOL      Get GetBool var to retVal
36464>>>        Else If vt Eq OLE_VT_UNKNOWN   Get GetLPIUnknown var to retVal
36468>>>        Else If vt Eq OLE_VT_UI1       Get GetUChar var to retVal
36472>>>        Function_Return retVal
36473>>>    End_Function
36474>>>
36474>>>    Function PutValue DWORD vt String val Returns OLEVariant
36475>>>        Inst_OLEVariant var
36477>>>        Put vt to var at Variant.vt
36478>>>             If vt Eq OLE_VT_I2        Put (Integer(val)) to var at Variant.iVal
36481>>>        Else If vt Eq OLE_VT_I4        Put (Integer(val)) to var at Variant.lVal
36485>>>        Else If vt Eq OLE_VT_R4        Put_String val to var at Variant.fltVal
36489>>>        Else If vt Eq OLE_VT_R8        Put_String val to var at Variant.dblVal
36493>>>        Else If vt Eq OLE_VT_CY        Put_String val to var at Variant.cyVal
36497>>>        Else If vt Eq OLE_VT_DATE      Put (Date(val)) to var at Variant.dtVal
36501>>>        Else If vt Eq OLE_VT_BSTR      Put_String val to var at Variant.strVal
36505>>>        Else If vt Eq OLE_VT_DISPATCH  Put (LPDispatch(val)) to var at Variant.dspVal
36509>>>        Else If vt Eq OLE_VT_ERROR     Put (OLEError(val)) to var at Variant.errVal
36513>>>        Else If vt Eq OLE_VT_BOOL      Put (Bool(val)) to var at Variant.blVal
36517>>>        Else If vt Eq OLE_VT_UNKNOWN   Put (LPIUnknown(val)) to var at Variant.uknVal
36521>>>        Else If vt Eq OLE_VT_UI1       Put (UChar(val)) to var at Variant.ui1Val
36525>>>        Else begin
36526>>>            Put OLE_VT_ERROR to var at Variant.vt
36527>>>            Put DISP_E_PARAMNOTFOUND to var at Variant.errVal
36528>>>        End
36528>>>>
36528>>>        Function_Return var
36529>>>    End_Function
36530>>>
36530>>>End_Class
36531>>>
36531>>>// The one and only cOLEVariant helper object
36531>>>Object oOLEVariant is a cOLEVariant
36533>>>        Move Current_Object to oOLEVariantId
36534>>>End_Object
36535>>>
36535>>>//Command so we get nicer code for the events, only used internally
36535>>>
36535>>>// Command to extract the value of an OLEVariant no matter what datatype its currently holding
36535>>>
36535>>>// Command to both set the datatype and value to an OLEVariant
36535>>>
36535>>>
36535>>>// The OLE Base class, all OLE classes are derived from this class
36535>>>// Defines basic functionality and conversation with DLL interface
36535>>>
36535>>>Class cCOM_IDispatch is a Message
36536>>>
36536>>>    Procedure DefineCOM_IDispatch
36537>>>        Property String  progIdStr Public ""
36538>>>        Property Integer ClientId Public 0
36539>>>        Property Integer AutoAddRef Public 0
36540>>>    End_Procedure
36541>>>
36541>>>// GetProperty functions
36541>>>    Function GetIntegerProperty DWORD dwDispId returns Integer
36542>>>        Local Integer lpropVal iClientId
36543>>>        Get clientId to iClientId
36544>>>        Move (GetAutoClientIntegerProperty (iClientId,dwDispId)) to lpropVal
36545>>>        Function_Return lpropVal
36546>>>    End_Function
36547>>>
36547>>>    Function GetShortProperty DWORD dwDispId returns Integer
36548>>>        Local Integer lpropVal iClientId
36549>>>        Get clientId to iClientId
36550>>>        Move (GetAutoClientShortProperty (iClientId,dwDispId)) to lpropVal
36551>>>        Function_Return lpropVal
36552>>>    End_Function
36553>>>
36553>>>    Function GetBoolProperty DWORD dwDispId returns BOOL
36554>>>        Local BOOL lpropVal
36555>>>        Local Integer iClientId
36555>>>        Get clientId to iClientId
36556>>>        Move (GetAutoClientBoolProperty (iClientId,dwDispId)) to lpropVal
36557>>>        Function_Return lpropVal
36558>>>    End_Function
36559>>>
36559>>>    Function GetCurrencyProperty DWORD dwDispId returns Number
36560>>>        Local Number lpropVal
36561>>>        Local String lsProp
36561>>>        Local Integer iClientId iRetVal
36561>>>        Local Pointer llpsprop
36561>>>        Get clientId to iClientId
36562>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lsProp
36563>>>        GetAddress of lsprop to llpsprop
36564>>>        Move (GetAutoClientCurrencyProperty (iClientId,dwDispId,llpsprop)) to iRetVal
36565>>>        Move lsProp to lpropVal
36566>>>        Function_Return lpropVal
36567>>>    End_Function
36568>>>
36568>>>    Function GetDateProperty DWORD dwDispId returns Date
36569>>>        Local Date lpropVal
36570>>>        Local Integer iClientId
36570>>>        Get clientId to iClientId
36571>>>        Move (GetAutoClientDateProperty (iClientId,dwDispId)) to lpropVal
36572>>>        Function_Return lpropVal
36573>>>    End_Function
36574>>>
36574>>>    Function GetLPDispatchProperty DWORD dwDispId returns Date
36575>>>        Local LPDispatch lpropVal
36576>>>        Local Integer iClientId
36576>>>        Get clientId to iClientId
36577>>>        Move (GetAutoClientLPDispatchProperty (iClientId,dwDispId)) to lpropVal
36578>>>        Function_Return lpropVal
36579>>>    End_Function
36580>>>
36580>>>    Function GetRealProperty DWORD dwDispId returns OLEReal
36581>>>        Local OLEReal lpropVal
36582>>>        Local Integer iClientId iRetVal
36582>>>        Local String lsProp
36582>>>        Local Pointer llpsprop
36582>>>        Get clientId to iClientId
36583>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lsProp
36584>>>        GetAddress of lsprop to llpsprop
36585>>>        Move (GetAutoClientRealProperty (iClientId,dwDispId,llpsprop)) to iRetVal
36586>>>        Move lsProp to lpropVal
36587>>>        Function_Return lpropVal
36588>>>    End_Function
36589>>>
36589>>>    Function GetShortRealProperty DWORD dwDispId returns OLEReal
36590>>>        Local OLEReal lpropVal
36591>>>        Local Integer iClientId iRetVal
36591>>>        Local String lsProp
36591>>>        Local Pointer llpsprop
36591>>>        Get clientId to iClientId
36592>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lsProp
36593>>>        GetAddress of lsprop to llpsprop
36594>>>        Move (GetAutoClientShortRealProperty (iClientId,dwDispId,llpsprop)) to iRetVal
36595>>>        Move lsProp to lpropVal
36596>>>        Function_Return lpropVal
36597>>>    End_Function
36598>>>
36598>>>    Function GetStringProperty DWORD dwDispId returns String
36599>>>        Local String lpropVal
36600>>>        Local Integer iClientId iRetVal
36600>>>        Local Pointer llppropVal
36600>>>        Get clientId to iClientId
36601>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lpropVal
36602>>>        GetAddress of lpropVal to llppropval
36603>>>        Move (GetAutoClientStringProperty (iClientId,dwDispId,llppropVal)) to iRetVal
36604>>>        Function_Return (CString(lpropVal))
36605>>>    End_Function
36606>>>
36606>>>    Function GetOLEVariantProperty DWORD dwDispId returns OLEVariant
36607>>>        Local OLEVariant lpropVal
36608>>>        Local Integer iClientId iRetVal
36608>>>        Local Pointer llppropVal
36608>>>        Get clientId to iClientId
36609>>>        ZeroType TP_OLEVariant to lpropVal
36610>>>        GetAddress of lpropVal to llppropval
36611>>>        Move (GetAutoClientOLEVariantProperty (iClientId,dwDispId,llppropVal)) to iRetVal
36612>>>        Function_Return lpropVal
36613>>>    End_Function
36614>>>
36614>>>// SetProperty procedures
36614>>>    Procedure SetIntegerProperty DWORD dwDispId Integer lpropVal
36615>>>        Local Integer iClientId iRetVal
36616>>>        Get ClientId to iClientId
36617>>>        Move (SetAutoClientIntegerProperty (iClientId,dwDispId,lpropVal)) to iRetVal
36618>>>    End_Procedure
36619>>>
36619>>>    Procedure SetShortProperty DWORD dwDispId Integer lpropVal
36620>>>        Local Integer iClientId iRetVal
36621>>>        Get ClientId to iClientId
36622>>>        Move (SetAutoClientShortProperty (iClientId,dwDispId,lpropVal)) to iRetVal
36623>>>    End_Procedure
36624>>>
36624>>>    Procedure SetBoolProperty DWORD dwDispId BOOL lpropVal
36625>>>        Local Integer iClientId iRetVal
36626>>>        Get ClientId to iClientId
36627>>>        Move (SetAutoClientShortProperty (iClientId,dwDispId,lpropVal)) to iRetVal
36628>>>    End_Procedure
36629>>>
36629>>>    Procedure SetCurrencyProperty DWORD dwDispId Number lpropVal
36630>>>        Local Integer iClientId iRetVal
36631>>>        Local String lsprop
36631>>>        Get ClientId to iClientId
36632>>>        Move lpropVal to lsprop
36633>>>        Move (SetAutoClientCurrencyProperty(iClientId,dwDispId,lsprop)) to iRetVal
36634>>>    End_Procedure
36635>>>
36635>>>    Procedure SetDateProperty DWORD dwDispId Date lpropVal
36636>>>        Local Integer iClientId iRetVal
36637>>>        Get ClientId to iClientId
36638>>>        Move (SetAutoClientDateProperty(iClientId,dwDispId,lpropVal)) to iRetVal
36639>>>    End_Procedure
36640>>>
36640>>>    Procedure SetLPDispatchProperty DWORD dwDispId LPDispatch lpropVal
36641>>>        Local Integer iClientId iRetVal
36642>>>        Get ClientId to iClientId
36643>>>        Move (SetAutoClientLPDispatchProperty(iClientId,dwDispId,lpropVal)) to iRetVal
36644>>>    End_Procedure
36645>>>
36645>>>    Procedure SetRealProperty DWORD dwDispId OLEReal lpropVal
36646>>>        Local Integer iClientId iRetVal
36647>>>        Local String lsprop
36647>>>        Get ClientId to iClientId
36648>>>        Move lpropVal to lsprop
36649>>>        Move (SetAutoClientRealProperty(iClientId,dwDispId,lsprop)) to iRetVal
36650>>>    End_Procedure
36651>>>
36651>>>    Procedure SetShortRealProperty DWORD dwDispId OLEReal lpropVal
36652>>>        Local Integer iClientId iRetVal
36653>>>        Local String lsprop
36653>>>        Get ClientId to iClientId
36654>>>        Move lpropVal to lsprop
36655>>>        Move (SetAutoClientShortRealProperty(iClientId,dwDispId,lsprop)) to iRetVal
36656>>>    End_Procedure
36657>>>
36657>>>    Procedure SetStringProperty DWORD dwDispId String lpropVal
36658>>>        Local Integer iClientId iRetVal
36659>>>        Get ClientId to iClientId
36660>>>        Move (SetAutoClientStringProperty(iClientId,dwDispId,lpropVal)) to iRetVal
36661>>>    End_Procedure
36662>>>
36662>>>    Procedure SetOLEVariantProperty DWORD dwDispId OLEVariant lpropVal
36663>>>        Local Integer iClientId iRetVal
36664>>>        Get ClientId to iClientId
36665>>>        If (Length(lpropval)) Lt TP_OLEVariant_Size;            Get PutValue of oOLEVariantId OLE_VT_ERROR DISP_E_PARAMNOTFOUND to lpropVal
36668>>>        Move (SetAutoClientOLEVariantProperty(iClientId,dwDispId,lpropVal)) to iRetVal
36669>>>    End_Procedure
36670>>>
36670>>>// Pre-Invoke functions
36670>>>    Procedure DeclareParams Integer nrOfParams
36671>>>        Local Integer iClientId iRetVal
36672>>>        Get ClientId to iCLientId
36673>>>        Move (DeclareAutoClientInvokeParams(iClientId,nrOfParams)) to iRetVal
36674>>>    End_Procedure
36675>>>
36675>>>    Procedure DefineIntegerParam Integer param
36676>>>        Local Integer iClientId iRetVal
36677>>>        Get ClientId to iClientId
36678>>>        Move (DefineAutoClientIntegerParam(iClientId,param)) to iRetVal
36679>>>    End_Procedure
36680>>>
36680>>>    Procedure DefineShortParam Integer param
36681>>>        Local Integer iClientId iRetVal
36682>>>        Get ClientId to iClientId
36683>>>        Move (DefineAutoClientShortParam(iClientId,param)) to iRetVal
36684>>>    End_Procedure
36685>>>
36685>>>    Procedure DefineBoolParam BOOL param
36686>>>        Local Integer iClientId iRetVal
36687>>>        Get ClientId to iClientId
36688>>>        Move (DefineAutoClientBoolParam(iClientId,param)) to iRetVal
36689>>>    End_Procedure
36690>>>
36690>>>    Procedure DefineCurrencyParam Number param
36691>>>        Local Integer iClientId iRetVal
36692>>>        Local String lsparam
36692>>>        Get ClientId to iClientId
36693>>>        Move param to lsparam
36694>>>        Move (DefineAutoClientCurrencyParam(iClientId,lsparam)) to iRetVal
36695>>>    End_Procedure
36696>>>
36696>>>    Procedure DefineDateParam Date param
36697>>>        Local Integer iClientId iRetVal
36698>>>        Get ClientId to iClientId
36699>>>        Move (DefineAutoClientDateParam(iClientId,param)) to iRetVal
36700>>>    End_Procedure
36701>>>
36701>>>    Procedure DefineLPDispatchParam LPDispatch param
36702>>>        Local Integer iClientId iRetVal
36703>>>        Get ClientId to iClientId
36704>>>        Move (DefineAutoClientLPDispatchParam(iClientId,param)) to iRetVal
36705>>>    End_Procedure
36706>>>
36706>>>    Procedure DefineRealParam OLEReal param
36707>>>        Local Integer iClientId iRetVal
36708>>>        Local String lsparam
36708>>>        Get ClientId to iClientId
36709>>>        Move param to lsparam
36710>>>        Move (DefineAutoClientRealParam(iClientId,lsparam)) to iRetVal
36711>>>    End_Procedure
36712>>>
36712>>>    Procedure DefineShortRealParam OLEReal param
36713>>>        Local Integer iClientId iRetVal
36714>>>        Local String lsparam
36714>>>        Get ClientId to iClientId
36715>>>        Move param to lsparam
36716>>>        Move (DefineAutoClientShortRealParam(iClientId,lsparam)) to iRetVal
36717>>>    End_Procedure
36718>>>
36718>>>    Procedure DefineStringParam String param
36719>>>        Local Integer iClientId iRetVal
36720>>>        Get ClientId to iClientId
36721>>>        Append param OLENull
36722>>>        Move (DefineAutoClientStringParam(iClientId,param)) to iRetVal
36723>>>    End_Procedure
36724>>>
36724>>>    Procedure DefineOLEVariantParam OLEVariant param
36725>>>        Local Integer iClientId iRetVal
36726>>>        Get ClientId to iClientId
36727>>>        If (Length(param)) Lt TP_OLEVariant_Size ;            Get PutValue of oOLEVariantId OLE_VT_ERROR DISP_E_PARAMNOTFOUND to param
36730>>>        Move (DefineAutoClientOLEVariantParam(iClientId,param)) to iRetVal
36731>>>    End_Procedure
36732>>>
36732>>>// Invoke functions
36732>>>    Procedure InvokeVoidFunction DWORD dwDispId
36733>>>        Local Integer iClientId iRetVal
36734>>>        Get ClientId to iClientId
36735>>>        Move (InvokeAutoClientVoidFunction(iClientId,dwDispId)) to iRetVal
36736>>>    End_Procedure
36737>>>
36737>>>    Function InvokeIntegerFunction DWORD dwDispId returns Integer
36738>>>        Local Integer iClientId iRetVal
36739>>>        Get ClientId to iClientId
36740>>>        Move (InvokeAutoClientIntegerFunction(iClientId,dwDispId)) to iRetVal
36741>>>        Function_Return iRetVal
36742>>>    End_Function
36743>>>
36743>>>    Function InvokeShortFunction DWORD dwDispId returns Integer
36744>>>        Local Integer iClientId iRetVal
36745>>>        Get ClientId to iClientId
36746>>>        Move (InvokeAutoClientShortFunction(iClientId,dwDispId)) to iRetVal
36747>>>        Function_Return iRetVal
36748>>>    End_Function
36749>>>
36749>>>    Function InvokeBoolFunction DWORD dwDispId returns BOOL
36750>>>        Local Integer iClientId iRetVal
36751>>>        Get ClientId to iClientId
36752>>>        Move (InvokeAutoClientBoolFunction(iClientId,dwDispId)) to iRetVal
36753>>>        Function_Return iRetVal
36754>>>    End_Function
36755>>>
36755>>>    Function InvokeCurrencyFunction DWORD dwDispId returns Number
36756>>>        Local Integer iClientId iRetVal
36757>>>        Local Number nRetVal
36757>>>        Local String sRetVal
36757>>>        Local Pointer psRetVal
36757>>>        Get ClientId to iClientId
36758>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
36759>>>        GetAddress of sRetVal to psRetVal
36760>>>        Move (InvokeAutoClientCurrencyFunction(iClientId,dwDispId,psRetVal)) to iRetVal
36761>>>        Move sRetVal to nRetVal
36762>>>        Function_Return nRetVal
36763>>>    End_Function
36764>>>
36764>>>    Function InvokeDateFunction DWORD dwDispId returns Date
36765>>>        Local Integer iClientId
36766>>>        Local Date dRetVal
36766>>>        Get ClientId to iClientId
36767>>>        Move (InvokeAutoClientDateFunction(iClientId,dwDispId)) to dRetVal
36768>>>        Function_Return dRetVal
36769>>>    End_Function
36770>>>
36770>>>    Function InvokeLPDispatchFunction DWORD dwDispId returns LPDispatch
36771>>>        Local Integer iClientId
36772>>>        Local LPDispatch lpdRetVal
36772>>>        Get ClientId to iClientId
36773>>>        Move (InvokeAutoClientLPDispatchFunction(iClientId,dwDispId)) to lpdRetVal
36774>>>        Function_Return lpdRetVal
36775>>>    End_Function
36776>>>
36776>>>    Function InvokeRealFunction DWORD dwDispId returns OLEReal
36777>>>        Local Integer iClientId iRetVal
36778>>>        Local OLEReal rRetVal
36778>>>        Local String sRetVal
36778>>>        Local Pointer psRetVal
36778>>>        Get ClientId to iClientId
36779>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
36780>>>        GetAddress of sRetVal to psRetVal
36781>>>        Move (InvokeAutoClientRealFunction(iClientId,dwDispId,psRetVal)) to iRetVal
36782>>>        Move sRetVal to rRetVal
36783>>>        Function_Return rRetVal
36784>>>    End_Function
36785>>>
36785>>>    Function InvokeShortRealFunction DWORD dwDispId returns OLEReal
36786>>>        Local Integer iClientId iRetVal
36787>>>        Local OLEReal rRetVal
36787>>>        Local String sRetVal
36787>>>        Local Pointer psRetVal
36787>>>        Get ClientId to iClientId
36788>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
36789>>>        GetAddress of sRetVal to psRetVal
36790>>>        Move (InvokeAutoClientShortRealFunction(iClientId,dwDispId,psRetVal)) to iRetVal
36791>>>        Move sRetVal to rRetVal
36792>>>        Function_Return rRetVal
36793>>>    End_Function
36794>>>
36794>>>    Function InvokeStringFunction DWORD dwDispId returns String
36795>>>        Local Integer iClientId iRetVal
36796>>>        Local String sRetVal
36796>>>        Local Pointer psRetVal
36796>>>        Get ClientId to iClientId
36797>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
36798>>>        GetAddress of sRetVal to psRetVal
36799>>>        Move (InvokeAutoClientStringFunction(iClientId,dwDispId,psRetVal)) to iRetVal
36800>>>        Function_Return (CString(sRetVal))
36801>>>    End_Function
36802>>>
36802>>>    Function InvokeOleVariantFunction DWORD dwDispId returns OLEVariant
36803>>>        Local Integer iClientId iRetVal
36804>>>        Local OLEVariant vRetVal
36804>>>        Local Pointer pvRetVal
36804>>>        Get ClientId to iClientId
36805>>>        ZeroType TP_OLEVariant to vRetVal
36806>>>        GetAddress of vRetVal to pvRetVal
36807>>>        Move (InvokeAutoClientOLEVariantFunction(iClientId,dwDispId,pvRetVal)) to iRetVal
36808>>>        Function_Return vRetVal
36809>>>    End_Function
36810>>>
36810>>>
36810>>>// Event parameter functions, might be moved to cOCX_Client_Mixin or similar
36810>>>    Function GetEventIntegerParam DWORD lParam DWORD iPara returns Integer
36811>>>        Local Integer iRetVal
36812>>>        Move (GetOCXEventIntegerParam(lParam,iPara)) to iRetVal
36813>>>        Function_Return iRetVal
36814>>>    End_Function
36815>>>
36815>>>    Function GetEventShortParam DWORD lParam DWORD iPara returns Integer
36816>>>        Local Integer iRetVal
36817>>>        Move (GetOCXEventShortParam(lParam,iPara)) to iRetVal
36818>>>        Function_Return iRetVal
36819>>>    End_Function
36820>>>
36820>>>    Function GetEventBoolParam DWORD lParam DWORD iPara returns Bool
36821>>>        Local Bool iRetVal
36822>>>        Move (GetOCXEventBoolParam(lParam,iPara)) to iRetVal
36823>>>        Function_Return iRetVal
36824>>>    End_Function
36825>>>
36825>>>    Function GetEventCurrencyParam DWORD lParam DWORD iPara returns Currency
36826>>>        Local Integer iretVal
36827>>>        Local Currency cRetVal
36827>>>        Local String destStr
36827>>>        Local Pointer pdestStr
36827>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
36828>>>        GetAddress of destStr to pdestStr
36829>>>        Move (GetOCXEventCurrencyParam(lParam,iPara,pdestStr)) to iRetVal
36830>>>        Move (CString(destStr)) to cRetVal
36831>>>        Function_Return cRetVal
36832>>>    End_Function
36833>>>
36833>>>    Function GetEventDateParam DWORD lParam DWORD iPara returns Date
36834>>>        Local Date dRetVal
36835>>>        Move (GetOCXEventDateParam(lParam,iPara)) to dRetVal
36836>>>        Function_Return dRetVal
36837>>>    End_Function
36838>>>
36838>>>    Function GetEventLPDispatchParam DWORD lParam DWORD iPara returns LPDispatch
36839>>>        Local LPDispatch lpRetVal
36840>>>        Get GetEventIntegerParam lParam iPara to lpRetVal
36841>>>        Function_Return lpRetVal
36842>>>    End_Function
36843>>>
36843>>>    Function GetEventRealParam DWORD lParam DWORD iPara returns OLEReal
36844>>>        Local Integer iretVal
36845>>>        Local OLEReal rRetVal
36845>>>        Local String destStr
36845>>>        Local Pointer pdestStr
36845>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
36846>>>        GetAddress of destStr to pdestStr
36847>>>        Move (GetOCXEventRealParam(lParam,iPara,pdestStr)) to iRetVal
36848>>>        Move (CString(destStr)) to rRetVal
36849>>>        Function_Return rRetVal
36850>>>    End_Function
36851>>>
36851>>>    Function GetEventShortRealParam DWORD lParam DWORD iPara returns ShortReal
36852>>>        Local Integer iretVal
36853>>>        Local ShortReal rRetVal
36853>>>        Local String destStr
36853>>>        Local Pointer pdestStr
36853>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
36854>>>        GetAddress of destStr to pdestStr
36855>>>        Move (GetOCXEventShortRealParam(lParam,iPara,pdestStr)) to iRetVal
36856>>>        Move (CString(destStr)) to rRetVal
36857>>>        Function_Return rRetVal
36858>>>    End_Function
36859>>>
36859>>>    Function GetEventStringParam DWORD lParam DWORD iPara returns String
36860>>>        Local Integer iretVal
36861>>>        Local String sRetVal
36861>>>        Local Pointer psRetVal
36861>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
36862>>>        GetAddress of sRetVal to psRetVal
36863>>>        Move (GetOCXEventStringParam(lParam,iPara,psRetVal)) to iRetVal
36864>>>        Function_Return (CString(sRetVal))
36865>>>    End_Function
36866>>>
36866>>>    Function GetEventOLEVariantParam DWORD lParam DWORD iPara returns OLEVariant
36867>>>        Local Integer iretVal
36868>>>        Inst_OLEVariant vRetVal
36869>>>        Local Pointer pvRetVal
36869>>>        GetAddress of vRetVal to pvRetVal
36870>>>        Move (GetOCXEventOLEVariantParam(lParam,iPara,pvRetVal)) to iRetVal
36871>>>        Function_Return vRetVal
36872>>>    End_Function
36873>>>
36873>>>End_Class
36874>>>
36874>>>
36874>>>// The OLE Automation base class,
36874>>>// which all automation classes are derived from
36874>>>
36874>>>Class Automation_Client is a cCOM_IDispatch
36875>>>    Procedure Construct_Object
36876>>>        Forward Send Construct_Object
36878>>>        Send DefineCOM_IDispatch
36879>>>        Local Integer iClientId
36880>>>        Move (CreateAutomationClient()) To iClientId
36881>>>        If iClientId Eq 0 Begin
36883>>>            Set ClientId to 0
36884>>>            Error 1002 DFOLEError1002
36885>>>>
36885>>>        End
36885>>>>
36885>>>        Else Set ClientId To iClientId
36887>>>        End_Procedure
36888>>>
36888>>>    Procedure Destroy_Object
36889>>>        Local Integer iRetVal iClientId
36890>>>        Get ClientId to iClientId
36891>>>        Move (DestroyAutomationClient(iClientId)) to iRetVal
36892>>>        Forward Send Destroy_Object
36894>>>    End_Procedure
36895>>>
36895>>>    Procedure CreateDispatch
36896>>>                Local Integer iRetVal
36897>>>                Local Integer iClientId
36897>>>        Local String sCLSID
36897>>>        Get progIdStr to sCLSID
36898>>>        Append sCLSID OLENull
36899>>>
36899>>>                Get clientId to iClientId
36900>>>        Move (CreateAutoClientDispatch (iClientId,sCLSID)) To iRetVal
36901>>>                If iRetVal Eq 0 Begin
36903>>>            Error 1000 DFOLEError1000
36904>>>>
36904>>>                End
36904>>>>
36904>>>        End_Procedure
36905>>>
36905>>>        Procedure AttachDispatch LPDispatch pdisp
36906>>>                Local Integer iRetVal
36907>>>                Local Integer iClientId
36907>>>                Local Integer bAutoAddRef
36907>>>                Get clientId to iClientId
36908>>>                Get AutoAddRef to bAutoAddRef
36909>>>                Move (AttachAutoClientDispatch (iClientId,pdisp,bAutoAddRef)) To iRetVal
36910>>>                If iRetVal Eq 0 Begin
36912>>>                Error 1001 DFOLEError1001
36913>>>>
36913>>>                End
36913>>>>
36913>>>    End_Procedure
36914>>>
36914>>>    Function AttachActiveObject Returns Bool
36915>>>                Local Bool bRetVal
36916>>>                Local Integer iClientId
36916>>>                Local String sCLSID
36916>>>                Get progIdStr to sCLSID
36917>>>                Append sCLSID OLENull
36918>>>                Get clientId to iClientId
36919>>>                Move (AttachAutoClientActiveObject (iClientId,sCLSID)) To bRetVal
36920>>>                Function_Return bRetVal
36921>>>    End_Function
36922>>>
36922>>>    Procedure ReleaseDispatch
36923>>>        Local Integer iRetVal
36924>>>        Local Integer iClientId
36924>>>        Get clientId to iClientId
36925>>>        Move (ReleaseAutoClientDispatch (iClientId)) to iRetVal
36926>>>    End_Procedure
36927>>>
36927>>>    Function GetDispatch returns LPDispatch
36928>>>        Local LPDispatch retVal
36929>>>        Local Integer iClientId
36929>>>        Get clientId to iClientId
36930>>>        Move (GetAutoClientDispatch(iClientId)) to retVal
36931>>>        Function_Return retVal
36932>>>    End_Function
36933>>>
36933>>>End_Class
36934>>>
36934>>>
36934>>>//     cCom_IDispatch  External_Class_Mixin
36934>>>//                 |       |    
36934>>>//                 |       cOCXNavigation_Mixin
36934>>>//                 |         |    
36934>>>//               cOCX_Client_Mixin
36934>>>//                        |    |
36934>>>//                        |    |
36934>>>// Form_External_Control  |    |   dbForm_External_Control
36934>>>//                 |      |    |        |  
36934>>>//                OCX_Client   dbOCX_Client
36934>>>
36934>>>
36934>>>
36934>>>// The focus navigation mixin class for ActiveX controls
36934>>>Class cOCX_Navigation_Class_Mixin is a Mixin 
36935>>>    Import_Class_Protocol External_Class_Mixin
36936>>>    Register_Procedure WMDF_DFOCXNotifyEvent
36936>>>
36936>>>    Procedure WMDF_DFOCXNotifyEvent Integer wParam Integer lParam
36937>>>        ON_EVENT WM_DFOCX_FOCUSCHANGE Fire OCXFocusChange
36940>>>    End_Procedure
36941>>>
36941>>>    Procedure OCXFocusChange Integer lParam
36942>>>        If (lParam);            Send External_SetFocus
36945>>>        Else;            Send External_KillFocus
36947>>>    End_Procedure
36948>>>
36948>>>    //Provided just to cancel the External_Class_Mixin implementation
36948>>>    //It actually gets cancelled in the cOCX_Clint_Mixin, but hey!?
36948>>>    Procedure Page_Object Integer state
36949>>>        Forward Send Page_Object state        
36951>>>    End_Procedure
36952>>>
36952>>>    Procedure Enable_Window integer iState
36953>>>      // Here we switch iState again, for backwards compatibility
36953>>>      Set OcxShadow_State to (Not(iState))
36954>>>    End_procedure
36955>>>
36955>>>End_Class
36956>>>
36956>>>
36956>>>//The standard OCX class mixin, it is the 
36956>>>// OCX base class which all OLE Controls are derived from (read mixin'd)
36956>>>Class cOCX_Client_Mixin is a Mixin
36957>>>
36957>>>    Import_Class_Protocol cCOM_IDispatch
36958>>>    Import_Class_Protocol cOCX_Navigation_Class_Mixin
36959>>>    Register_Procedure WMDF_DFOCXEVENT Integer wParam Integer lParam
36959>>>
36959>>>    Procedure DefineOCX_Client
36960>>>        Send DefineCOM_IDispatch
36961>>>        Local Integer iClientId
36962>>>        Property integer Private.OCXShadowState Public 0
36963>>>        Property String  Private.OCXCaption Public ""
36964>>>        Property String  OCXLicense Public ""
36965>>>        Property String  OCXPropFile Public ""
36966>>>        Move (CreateOCXClient()) to iclientId
36967>>>                Set ClientId to iClientId
36968>>>        Send Use_Parent_Color
36969>>>    End_Procedure
36970>>>
36970>>>    Function OCXShadow_State Returns Integer
36971>>>        Local Integer bEnabled
36972>>>        Get Private.OCXShadowState to bEnabled
36973>>>        Function_Return bEnabled
36974>>>    End_Function
36975>>>
36975>>>    Procedure Set OCXShadow_State Integer bEnable
36976>>>        Local integer hWnd iSuccess iCLientId
36977>>>        Set Private.OCXShadowState to bEnable
36978>>>        Get clientId to iClientId
36979>>>        If bEnable;            Move (false) to bEnable
36982>>>        else;            Move (true) to bEnable
36984>>>        Get Window_Handle to hWnd
36985>>>        If hWnd;            Move (EnableOCXControl(iClientId,bEnable)) To iSuccess
36988>>>    End_Procedure
36989>>>
36989>>>    Procedure SetOCXCaption String sCaption
36990>>>        Local Integer iClientId iRetVal
36991>>>        Get ClientId to iClientId
36992>>>        Append sCaption OLENull
36993>>>        Move (SetOCXControlCaption(iClientId,sCaption)) to iRetVal
36994>>>        If (Not(iRetVal));            Error 1004 DFOLEError1004
36997>>>        Else;            Set Private.OCXCaption to sCaption
36999>>>    End_Procedure
37000>>>
37000>>>    Function GetOCXCaption Returns String
37001>>>        Local Integer iClientId iRetVal
37002>>>        Local String destStr
37002>>>        Local Pointer lpDestStr
37002>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
37003>>>        GetAddress of destStr to lpDestStr
37004>>>        Move (GetOCXControlCaption(iClientId,lpDestStr)) to iRetVal
37005>>>        If (not(iRetVal));            Error 1004 DFOLEError1004
37008>>>        Set Private.OCXCaption to (CString(destStr))
37009>>>        Function_Return (Private.OCXCaption(Current_Object))
37010>>>    End_Function
37011>>>
37011>>>    Procedure SET OCXCaption String sCaption
37012>>>        If (Window_Handle(Current_Object));            Send SetOCXCaption sCaption
37015>>>        Else;            Set Private.OCXCaption to sCaption
37017>>>    End_Procedure
37018>>>
37018>>>    Function OCXCaption Returns String
37019>>>        If (Window_Handle(Current_Object));            Function_Return (GetOCXCaption(Current_Object))
37022>>>        Else;            Function_Return (Private.OCXCaption(Current_Object))
37024>>>    End_Procedure
37025>>>
37025>>>    // To avoid flickering during resize operations
37025>>>    Procedure Use_Parent_Color
37026>>>        Local Integer Clr Txtclr Backclr
37027>>>        Delegate Get Object_Color To Clr
37029>>>        Move (Hi(Clr)) To Txtclr
37030>>>        Move (Low(Clr)) To Backclr
37031>>>        Set Object_Color To Txtclr Backclr
37032>>>    End_Procedure
37033>>>
37033>>>    Procedure Page_Object integer iState
37034>>>        Forward Send Page_Object iState
37036>>>        If iState Eq (True) Send LoadOCX
37039>>>    End_Procedure
37040>>>
37040>>>    Procedure Remove_Object
37041>>>        Send UnloadOCX
37042>>>        Forward send Remove_Object
37044>>>    End_Procedure
37045>>>
37045>>>    Procedure LoadOCX
37046>>>        Local Pointer HWnd
37047>>>        Local Integer iCLientId iRetVal iVisible iShadow dwSty
37047>>>        Local String sPrgId lic sCap sPropFile
37047>>>        Send PreCreateOCX
37048>>>        Get ClientId to iClientId
37049>>>        Get Window_Handle to hwnd
37050>>>        Get progIdStr to sPrgId
37051>>>        Append sPrgId OLENull
37052>>>        Get Private.OCXCaption To sCap
37053>>>        Append sCap OLENull
37054>>>        Get OCXLicense To Lic
37055>>>        Append Lic OLENull
37056>>>        Get OCXPropFile To sPropFile
37057>>>        Append sPropfile OLENull
37058>>>        Get Visible_State to iVisible
37059>>>        If (iVisible) Move WS_VISIBLE to dwSty
37062>>>        Else Move 0 to dwSty
37064>>>        Get Private.OCXShadowState to iShadow
37065>>>        If (iShadow) Move (dwSty ior WS_DISABLED) to dwSty
37068>>>        Move (dwSty ior WS_TABSTOP) to dwSty
37069>>>        Move (CreateOCXControl(iClientId,HWnd,sPrgId,sCap,dwSty,lic,sPropFile)) to iRetVal
37070>>>        Send PostCreateOCX
37071>>>    End_Procedure
37072>>>
37072>>>    Procedure UnloadOCX
37073>>>        Local Integer iRetVal
37074>>>                Local Integer iClientId
37074>>>                Get ClientId to iClientId
37075>>>                Move (DestroyOCXControl(iClientId)) to iRetVal
37076>>>    End_Procedure
37077>>>
37077>>>    //This procedure is triggered before the OCX control is created
37077>>>    Procedure PreCreateOCX
37078>>>    End_Procedure
37079>>>
37079>>>    //This procedure is triggered after the OCX control is created but
37079>>>    //before it's shown
37079>>>    Procedure PostCreateOCX
37080>>>    End_Procedure
37081>>>End_Class
37082>>>
37082>>>// The non data aware OCX class
37082>>>// Derive from this class if you DON'T want your ActiveX control to be data aware
37082>>>Class OCX_Client is a FormExternalControl
37083>>>    Import_Class_Protocol cOCX_Client_Mixin
37084>>>
37084>>>    //These allows us to use the VDF standard 'Value' to get and set the
37084>>>    // caption of the ActiveX control (e.g. Get/Set Value to someVariable)
37084>>>
37084>>>    Procedure Set ControlValue string sVal
37085>>>        Set OCXCaption to sVal
37086>>>    End_Procedure
37087>>>
37087>>>    Function Value Integer item_number Returns String
37088>>>        Function_Return (OCXCaption(Current_Object))
37089>>>    End_Function
37090>>>
37090>>>End_Class
37091>>>
37091>>>
37091>>>// The Data aware OCX class
37091>>>// Derive from this class if you want your ActiveX control to be data aware
37091>>>Class dbOCX_Client is a dbFormExternalControl
37092>>>    Import_Class_Protocol cOCX_Client_Mixin
37093>>>
37093>>>    Procedure DefinedbOCX_Client
37094>>>        Send DefineOCX_Client
37095>>>        Property String  Private.OCXdbValue public ""
37096>>>    End_Procedure
37097>>>
37097>>>    Procedure Set ControlValue string sVal
37098>>>        If (Window_Handle(Current_Object));            Send OnRefreshDbOcxValue sVal
37101>>>    End_Procedure
37102>>>
37102>>>    Function ControlValue Returns String
37103>>>        Function_Return (Private.OCXDbValue(Current_Object))
37104>>>    End_Function
37105>>>
37105>>>    //Triggered when the database value has changed,
37105>>>    // and the ActiveX control needs to be updated
37105>>>    //Override and perform necessary updating to the OCX
37105>>>    Procedure OnRefreshDbOcxValue String sVal
37106>>>    End_Procedure
37107>>>
37107>>>    //Should be called when the ActiveX control's value has changed,
37107>>>    // and the database value needs to be updated
37107>>>    Procedure UpdateDbOcxValue String sVal
37108>>>        Set Private.OCXdbValue to sVal
37109>>>        Send ControlValueChanged
37110>>>    End_Procedure
37111>>>
37111>>>End_Class
37112>>>
37112>>>
37112>>>// Command for common declarations of ActiveX control classes, only used internally
37112>>>
37112>>>
37112>>>Use FontDisp
INCLUDING FILE: FONTDISP.PKG
37112>>>>>// OLEStdFont Charset Constants
37112>>>>>Enum_List
37112>>>>>        Define OLEANSI_CHARSET for 0 
37112>>>>>        Define OLEDEFAULT_CHARSET for 1
37112>>>>>        Define OLESYMBOL_CHARSET for 2
37112>>>>>End_Enum_List
37112>>>>>
37112>>>>>
37112>>>>>// CLSID:{BEF6E003-A874-101A-8BBA-00AA00300CAB}
37112>>>>>// ProgId: 
37112>>>>>Class OLEFontMixin is a Automation_Client
37113>>>>>
37113>>>>>        Function StdFontName Returns String
37114>>>>>                Local String lpropVal
37115>>>>>                Get GetStringProperty 0 to lpropVal
37116>>>>>                Function_Return lpropVal
37117>>>>>        End_Function
37118>>>>>
37118>>>>>        Procedure SET StdFontName String lpropVal
37119>>>>>                Send SetStringProperty 0 lpropVal
37120>>>>>        End_Procedure
37121>>>>>
37121>>>>>        Function StdFontSize Returns Currency
37122>>>>>                Local Currency lpropVal
37123>>>>>                Get GetCurrencyProperty 2 to lpropVal
37124>>>>>                Function_Return lpropVal
37125>>>>>        End_Function
37126>>>>>
37126>>>>>        Procedure SET StdFontSize Currency lpropVal
37127>>>>>                Send SetCurrencyProperty 2 lpropVal
37128>>>>>        End_Procedure
37129>>>>>
37129>>>>>        Function StdFontBold Returns Bool
37130>>>>>                Local Bool lpropVal
37131>>>>>                Get GetBoolProperty 3 to lpropVal
37132>>>>>                Function_Return lpropVal
37133>>>>>        End_Function
37134>>>>>
37134>>>>>        Procedure SET StdFontBold Bool lpropVal
37135>>>>>                Send SetBoolProperty 3 lpropVal
37136>>>>>        End_Procedure
37137>>>>>
37137>>>>>        Function StdFontItalic Returns Bool
37138>>>>>                Local Bool lpropVal
37139>>>>>                Get GetBoolProperty 4 to lpropVal
37140>>>>>                Function_Return lpropVal
37141>>>>>        End_Function
37142>>>>>
37142>>>>>        Procedure SET StdFontItalic Bool lpropVal
37143>>>>>                Send SetBoolProperty 4 lpropVal
37144>>>>>        End_Procedure
37145>>>>>
37145>>>>>        Function StdFontUnderline Returns Bool
37146>>>>>                Local Bool lpropVal
37147>>>>>                Get GetBoolProperty 5 to lpropVal
37148>>>>>                Function_Return lpropVal
37149>>>>>        End_Function
37150>>>>>
37150>>>>>        Procedure SET StdFontUnderline Bool lpropVal
37151>>>>>                Send SetBoolProperty 5 lpropVal
37152>>>>>        End_Procedure
37153>>>>>
37153>>>>>        Function StdFontStrikethrough Returns Bool
37154>>>>>                Local Bool lpropVal
37155>>>>>                Get GetBoolProperty 6 to lpropVal
37156>>>>>                Function_Return lpropVal
37157>>>>>        End_Function
37158>>>>>
37158>>>>>        Procedure SET StdFontStrikethrough Bool lpropVal
37159>>>>>                Send SetBoolProperty 6 lpropVal
37160>>>>>        End_Procedure
37161>>>>>
37161>>>>>        Function StdFontWeight Returns Integer
37162>>>>>                Local Integer lpropVal
37163>>>>>                Get GetShortProperty 7 to lpropVal
37164>>>>>                Function_Return lpropVal
37165>>>>>        End_Function
37166>>>>>
37166>>>>>        Procedure SET StdFontWeight Integer lpropVal
37167>>>>>                Send SetShortProperty 7 lpropVal
37168>>>>>        End_Procedure
37169>>>>>
37169>>>>>        Function StdFontCharset Returns Integer
37170>>>>>                Local Integer lpropVal
37171>>>>>                Get GetShortProperty 8 to lpropVal
37172>>>>>                Function_Return lpropVal
37173>>>>>        End_Function
37174>>>>>
37174>>>>>        Procedure SET StdFontCharset Integer lpropVal
37175>>>>>                Send SetShortProperty 8 lpropVal
37176>>>>>        End_Procedure
37177>>>>>
37177>>>>>End_Class
37178>>>>>
37178>>>>>// CoClass CLSID:{0BE35203-8F91-11CE-9DE3-00AA004BB851}
37178>>>>>// ProgId: StdFont
37178>>>>>// Number of impl.Types:1
37178>>>>>// Referenced class Font
37178>>>>>Class OLEStdFont is a Automation_Client
37179>>>>>        Import_Class_Protocol OLEFontMixin
37180>>>>>
37180>>>>>        Procedure Construct_Object
37181>>>>>                Forward Send Construct_Object
37183>>>>>                Set progIdStr to "StdFont"
37184>>>>>        End_Procedure
37185>>>>>End_Class
37186>>>Use PicDisp
INCLUDING FILE: PICDISP.PKG
37186>>>>>
37186>>>>>// Picture Type Constants
37186>>>>>//Enum_List
37186>>>>>        Define OLEPICTYPE_UNINITIALIZED for -1 // Uninitialized
37186>>>>>        Define OLEPICTYPE_NONE for 0 // None
37186>>>>>        Define OLEPICTYPE_BITMAP for 1 // Bitmap
37186>>>>>        Define OLEPICTYPE_METAFILE for 2 // Windows Metafile
37186>>>>>        Define OLEPICTYPE_ICON for 3 // Icon
37186>>>>>        Define OLEPICTYPE_ENHMETAFILE for 4 // Enhanced Metafile
37186>>>>>//End_Enum_List
37186>>>>>
37186>>>>>// CLSID:{7BF80981-BF32-101A-8BBB-00AA00300CAB}
37186>>>>>// ProgId: 
37186>>>>>Class OLEPictureMixin is a Automation_Client
37187>>>>>
37187>>>>>        Function StdPictureHandle Returns OLE_HANDLE
37188>>>>>                Local OLE_HANDLE lpropVal
37189>>>>>                Get GetIntegerProperty 0 to lpropVal
37190>>>>>                Function_Return lpropVal
37191>>>>>        End_Function
37192>>>>>
37192>>>>>        Function StdPicturehPal Returns OLE_HANDLE
37193>>>>>                Local OLE_HANDLE lpropVal
37194>>>>>                Get GetIntegerProperty 2 to lpropVal
37195>>>>>                Function_Return lpropVal
37196>>>>>        End_Function
37197>>>>>
37197>>>>>        Procedure SET StdPicturehPal OLE_HANDLE lpropVal
37198>>>>>                Send SetIntegerProperty 2 lpropVal
37199>>>>>        End_Procedure
37200>>>>>
37200>>>>>        Function StdPictureType Returns Integer
37201>>>>>                Local Integer lpropVal
37202>>>>>                Get GetShortProperty 3 to lpropVal
37203>>>>>                Function_Return lpropVal
37204>>>>>        End_Function
37205>>>>>
37205>>>>>        Function StdPictureWidth Returns OLE_XSIZE_HIMETRIC
37206>>>>>                Local OLE_XSIZE_HIMETRIC lpropVal
37207>>>>>                Get GetIntegerProperty 4 to lpropVal
37208>>>>>                Function_Return lpropVal
37209>>>>>        End_Function
37210>>>>>
37210>>>>>        Function StdPictureHeight Returns OLE_YSIZE_HIMETRIC
37211>>>>>                Local OLE_YSIZE_HIMETRIC lpropVal
37212>>>>>                Get GetIntegerProperty 5 to lpropVal
37213>>>>>                Function_Return lpropVal
37214>>>>>        End_Function
37215>>>>>
37215>>>>>        Procedure StdPictureRender DWORD lhdc DWORD lx DWORD ly DWORD lcx DWORD lcy OLE_XPOS_HIMETRIC lxSrc OLE_YPOS_HIMETRIC lySrc OLE_XSIZE_HIMETRIC lcxSrc OLE_YSIZE_HIMETRIC lcySrc LPOLE_RECT lprcWBounds
37216>>>>>                Send DeclareParams 10
37217>>>>>                Send DefineIntegerParam lhdc
37218>>>>>                Send DefineIntegerParam lx
37219>>>>>                Send DefineIntegerParam ly
37220>>>>>                Send DefineIntegerParam lcx
37221>>>>>                Send DefineIntegerParam lcy
37222>>>>>                Send DefineIntegerParam lxSrc
37223>>>>>                Send DefineIntegerParam lySrc
37224>>>>>                Send DefineIntegerParam lcxSrc
37225>>>>>                Send DefineIntegerParam lcySrc
37226>>>>>                Send DefineIntegerParam lprcWBounds
37227>>>>>                Send InvokeVoidFunction 6
37228>>>>>        End_Procedure 
37229>>>>>
37229>>>>>End_Class
37230>>>>>
37230>>>>>// CoClass CLSID:{0BE35204-8F91-11CE-9DE3-00AA004BB851}
37230>>>>>// ProgId: StdPicture
37230>>>>>// Number of impl.Types:1
37230>>>>>// Referenced class Picture
37230>>>>>Class OLEStdPicture is a Automation_Client
37231>>>>>        Import_Class_Protocol OLEPictureMixin
37232>>>>>
37232>>>>>        Procedure Construct_Object
37233>>>>>                Forward Send Construct_Object
37235>>>>>                Set progIdStr to "StdPicture"
37236>>>>>        End_Procedure
37237>>>>>End_Class
37238>Use DPDlg    // Full Path Directory Picker
INCLUDING FILE: DPDLG.PKG
37238>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\DPDLG.OCX
37238>>>// Generated by FlexOLE Class Generator Friday, November 10, 2000 17:30:33
37238>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
37238>>>
37238>>>//Enum_List
37238>>>    Define OLEdpdDesktop        for  0 // Desktop
37238>>>    Define OLEdpdControlPanel   for  1 // Control Panel
37238>>>    Define OLEdpdDesktopDir     for  2 // Desktop Directory
37238>>>    Define OLEdpdMyComputer     for  3 // My Computer
37238>>>    Define OLEdpdFontDir        for  4 // Font Directory
37238>>>    Define OLEdpdNetwork        for  5 // Network Neighborhood
37238>>>    Define OLEdpdPrinters       for  6 // Printers
37238>>>    Define OLEdpdPrograms       for  7 // Programs
37238>>>    Define OLEdpdRecent         for  8 // Recent
37238>>>    Define OLEdpdRecycleBin     for  9 // Recycle Bin
37238>>>    Define OLEdpdSendTo         for 10 // Send To
37238>>>    Define OLEdpdStartMenu      for 11 // Start Menu
37238>>>    Define OLEdpdStartUp        for 12 // Start Up
37238>>>    Define OLEdpdTemplates      for 13 // Templates
37238>>>    Define OLEdpdCustom         for 14 // Custom Root
37238>>>//End_Enum_List
37238>>>
37238>>>// Dispatch interface for DPDlg Control
37238>>>// CLSID:{BE5AB244-F888-11D0-9F5E-B42103C10710}
37238>>>// ProgId:
37238>>>Class OLE_DDPDlg is a Message
37239>>>
37239>>>        Function DPDlgBrowseForComputer Returns Bool
37240>>>                Local Bool lpropVal
37241>>>                Get GetBoolProperty 1 to lpropVal
37242>>>                Function_Return lpropVal
37243>>>        End_Function
37244>>>
37244>>>        Procedure SET DPDlgBrowseForComputer Bool lpropVal
37245>>>                Send SetBoolProperty 1 lpropVal
37246>>>        End_Procedure
37247>>>
37247>>>        Function DPDlgBrowseForPrinter Returns Bool
37248>>>                Local Bool lpropVal
37249>>>                Get GetBoolProperty 2 to lpropVal
37250>>>                Function_Return lpropVal
37251>>>        End_Function
37252>>>
37252>>>        Procedure SET DPDlgBrowseForPrinter Bool lpropVal
37253>>>                Send SetBoolProperty 2 lpropVal
37254>>>        End_Procedure
37255>>>
37255>>>        Function DPDlgDontGoBelowDomain Returns Bool
37256>>>                Local Bool lpropVal
37257>>>                Get GetBoolProperty 3 to lpropVal
37258>>>                Function_Return lpropVal
37259>>>        End_Function
37260>>>
37260>>>        Procedure SET DPDlgDontGoBelowDomain Bool lpropVal
37261>>>                Send SetBoolProperty 3 lpropVal
37262>>>        End_Procedure
37263>>>
37263>>>        Function DPDlgReturnFSAncestors Returns Bool
37264>>>                Local Bool lpropVal
37265>>>                Get GetBoolProperty 4 to lpropVal
37266>>>                Function_Return lpropVal
37267>>>        End_Function
37268>>>
37268>>>        Procedure SET DPDlgReturnFSAncestors Bool lpropVal
37269>>>                Send SetBoolProperty 4 lpropVal
37270>>>        End_Procedure
37271>>>
37271>>>        Function DPDlgReturnOnlyFSDirs Returns Bool
37272>>>                Local Bool lpropVal
37273>>>                Get GetBoolProperty 5 to lpropVal
37274>>>                Function_Return lpropVal
37275>>>        End_Function
37276>>>
37276>>>        Procedure SET DPDlgReturnOnlyFSDirs Bool lpropVal
37277>>>                Send SetBoolProperty 5 lpropVal
37278>>>        End_Procedure
37279>>>
37279>>>        Function DPDlgRoot Returns OLE_ROOTSHORT
37280>>>                Local OLE_ROOTSHORT lpropVal
37281>>>                Get GetIntegerProperty 6 to lpropVal
37282>>>                Function_Return lpropVal
37283>>>        End_Function
37284>>>
37284>>>        Procedure SET DPDlgRoot OLE_ROOTSHORT lpropVal
37285>>>                Send SetIntegerProperty 6 lpropVal
37286>>>        End_Procedure
37287>>>
37287>>>        Function DPDlghWnd Returns OLE_HANDLE
37288>>>                Local OLE_HANDLE lpropVal
37289>>>                Get GetIntegerProperty -515 to lpropVal
37290>>>                Function_Return lpropVal
37291>>>        End_Function
37292>>>
37292>>>        Procedure SET DPDlghWnd OLE_HANDLE lpropVal
37293>>>                Send SetIntegerProperty -515 lpropVal
37294>>>        End_Procedure
37295>>>
37295>>>        Function DPDlgIcon Returns LPDispatch
37296>>>                Local LPDispatch lpropVal
37297>>>                Get GetLPDispatchProperty 7 to lpropVal
37298>>>                Function_Return lpropVal
37299>>>        End_Function
37300>>>
37300>>>        Procedure SET DPDlgIcon LPDispatch lpropVal
37301>>>                Send SetLPDispatchProperty 7 lpropVal
37302>>>        End_Procedure
37303>>>
37303>>>        Function DPDlgFolder Returns String
37304>>>                Local String lpropVal
37305>>>                Get GetStringProperty 8 to lpropVal
37306>>>                Function_Return lpropVal
37307>>>        End_Function
37308>>>
37308>>>        Procedure SET DPDlgFolder String lpropVal
37309>>>                Send SetStringProperty 8 lpropVal
37310>>>        End_Procedure
37311>>>
37311>>>        Function DPDlgCaption Returns String
37312>>>                Local String lpropVal
37313>>>                Get GetStringProperty -518 to lpropVal
37314>>>                Function_Return lpropVal
37315>>>        End_Function
37316>>>
37316>>>        Procedure SET DPDlgCaption String lpropVal
37317>>>                Send SetStringProperty -518 lpropVal
37318>>>        End_Procedure
37319>>>
37319>>>        Function DPDlg_Caption Returns String
37320>>>                Local String lpropVal
37321>>>                Get GetStringProperty 0 to lpropVal
37322>>>                Function_Return lpropVal
37323>>>        End_Function
37324>>>
37324>>>        Procedure SET DPDlg_Caption String lpropVal
37325>>>                Send SetStringProperty 0 lpropVal
37326>>>        End_Procedure
37327>>>
37327>>>        Function DPDlgPath Returns String
37328>>>                Local String lpropVal
37329>>>                Get GetStringProperty 9 to lpropVal
37330>>>                Function_Return lpropVal
37331>>>        End_Function
37332>>>
37332>>>        Procedure SET DPDlgPath String lpropVal
37333>>>                Send SetStringProperty 9 lpropVal
37334>>>        End_Procedure
37335>>>
37335>>>        Function DPDlgCustomRoot Returns String
37336>>>                Local String lpropVal
37337>>>                Get GetStringProperty 10 to lpropVal
37338>>>                Function_Return lpropVal
37339>>>        End_Function
37340>>>
37340>>>        Procedure SET DPDlgCustomRoot String lpropVal
37341>>>                Send SetStringProperty 10 lpropVal
37342>>>        End_Procedure
37343>>>
37343>>>        Function DPDlgShow Returns Bool
37344>>>                Local Bool lretVal
37345>>>                Get InvokeBoolFunction 11 to lretVal
37346>>>                Function_Return lretVal
37347>>>        End_Function
37348>>>
37348>>>        Procedure DPDlgAboutBox
37349>>>                Send InvokeVoidFunction -552
37350>>>        End_Procedure
37351>>>
37351>>>End_Class
37352>>>
37352>>>// Event interface for DPDlg Control
37352>>>// CLSID:{BE5AB245-F888-11D0-9F5E-B42103C10710}
37352>>>// ProgId:
37352>>>Class OLE_DDPDlgEvents is a Message
37353>>>
37353>>>        Procedure OnDPDlgFolderSelected String lPath Bool lAllow
37354>>>        End_Procedure
37355>>>
37355>>>End_Class
37356>>>
37356>>>// DPDlg Control
37356>>>// CoClass CLSID:{BE5AB246-F888-11D0-9F5E-B42103C10710}
37356>>>// ProgId: DPDLG.DPDlgCtrl.1
37356>>>// Number of impl.Types:2
37356>>>// Referenced class _DDPDlg
37356>>>// Referenced class _DDPDlgEvents
37356>>>Class OLEDPDlg is a OCX_Client
37357>>>        Import_Class_Protocol OLE_DDPDlg
37358>>>        Import_Class_Protocol OLE_DDPDlgEvents
37359>>>
37359>>>        Procedure Construct_Object
37360>>>                Forward Send Construct_Object
37362>>>                Send DefineOCX_Client
37363>>>                Set progIdStr to "DPDLG.DPDlgCtrl.1"
37364>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEDPDlg"
37367>>>        End_Procedure
37368>>>
37368>>>        Procedure PreDPDlgFolderSelected Integer lParam
37369>>>                Local String lPath
37370>>>                Local Bool lAllow
37370>>>                Get GetEventStringParam lParam 0 to lPath
37371>>>                Get GetEventBoolParam lParam 1 to lAllow
37372>>>                Send OnDPDlgFolderSelected lPath lAllow
37373>>>        End_Procedure
37374>>>
37374>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
37375>>>                ON_EVENT 1 Fire PreDPDlgFolderSelected
37378>>>        End_Procedure
37379>>>End_Class
37380>>>
37380>>>// DPDlg Control
37380>>>// CoClass CLSID:{BE5AB246-F888-11D0-9F5E-B42103C10710}
37380>>>// ProgId: DPDLG.DPDlgCtrl.1
37380>>>// Number of impl.Types:2
37380>>>// Referenced class _DDPDlg
37380>>>// Referenced class _DDPDlgEvents
37380>>>Class dbOLEDPDlg is a dbOCX_Client
37381>>>        Import_Class_Protocol OLE_DDPDlg
37382>>>        Import_Class_Protocol OLE_DDPDlgEvents
37383>>>
37383>>>        Procedure Construct_Object
37384>>>                Forward Send Construct_Object
37386>>>                Send DefineDbOCX_Client
37387>>>                Set progIdStr to "DPDLG.DPDlgCtrl.1"
37388>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEDPDlg"
37391>>>        End_Procedure
37392>>>
37392>>>        Procedure PreDPDlgFolderSelected Integer lParam
37393>>>                Local String lPath
37394>>>                Local Bool lAllow
37394>>>                Get GetEventStringParam lParam 0 to lPath
37395>>>                Get GetEventBoolParam lParam 1 to lAllow
37396>>>                Send OnDPDlgFolderSelected lPath lAllow
37397>>>        End_Procedure
37398>>>
37398>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
37399>>>                ON_EVENT 1 Fire PreDPDlgFolderSelected
37402>>>        End_Procedure
37403>>>End_Class
37404>Use RasxDll  // Ras Package
INCLUDING FILE: RASXDLL.PKG
37404>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\RASX.DLL
37404>>>// Generated by FlexOLE Class Generator Friday, November 08, 2002 15:47:23
37404>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
37404>>>
37404>>>//Enum_List
37404>>>    Define OLERasActionNone         for 0 // No action
37404>>>    Define OLERasActionConnect      for 1 // Connect server
37404>>>    Define OLERasActionGetEntry     for 2 // Get phonebook entry
37404>>>    Define OLERasActionDisconnect   for 3 // Hang up (disconnect from server)
37404>>>    Define OLERasActionRefresh      for 4 // Refresh entries list
37404>>>    Define OLERasActionCreateEntry  for 5 // Create phonebook entry
37404>>>    Define OLERasActionEditEntry    for 6 // Edit phonebook entry
37404>>>//End_Enum_List
37404>>>
37404>>>// IRasXCom Interface
37404>>>// CLSID:{8E71552C-4915-11D3-B4C3-0020AFD69DE6}
37404>>>// ProgId:
37404>>>Class OLEIRasXCom is a Automation_Client
37405>>>
37405>>>// Sets or returns the filename of the phonebook to use.
37405>>>        Function RasXComPhoneBook Returns String
37406>>>                Local String lpropVal
37407>>>                Get GetStringProperty 1 to lpropVal
37408>>>                Function_Return lpropVal
37409>>>        End_Function
37410>>>
37410>>>// Sets or returns the filename of the phonebook to use.
37410>>>        Procedure SET RasXComPhoneBook String lpropVal
37411>>>                Send SetStringProperty 1 lpropVal
37412>>>        End_Procedure
37413>>>
37413>>>// Sets or returns the phone number to dial.
37413>>>        Function RasXComPhoneNumber Returns String
37414>>>                Local String lpropVal
37415>>>                Get GetStringProperty 2 to lpropVal
37416>>>                Function_Return lpropVal
37417>>>        End_Function
37418>>>
37418>>>// Sets or returns the phone number to dial.
37418>>>        Procedure SET RasXComPhoneNumber String lpropVal
37419>>>                Send SetStringProperty 2 lpropVal
37420>>>        End_Procedure
37421>>>
37421>>>// Sets or returns the name to use when logging on.
37421>>>        Function RasXComLogonName Returns String
37422>>>                Local String lpropVal
37423>>>                Get GetStringProperty 3 to lpropVal
37424>>>                Function_Return lpropVal
37425>>>        End_Function
37426>>>
37426>>>// Sets or returns the name to use when logging on.
37426>>>        Procedure SET RasXComLogonName String lpropVal
37427>>>                Send SetStringProperty 3 lpropVal
37428>>>        End_Procedure
37429>>>
37429>>>// Sets or returns the password to use.
37429>>>        Function RasXComLogonPassword Returns String
37430>>>                Local String lpropVal
37431>>>                Get GetStringProperty 4 to lpropVal
37432>>>                Function_Return lpropVal
37433>>>        End_Function
37434>>>
37434>>>// Sets or returns the password to use.
37434>>>        Procedure SET RasXComLogonPassword String lpropVal
37435>>>                Send SetStringProperty 4 lpropVal
37436>>>        End_Procedure
37437>>>
37437>>>// Sets or returns the phone number that a server should call back for certain kinds of verification.
37437>>>        Function RasXComCallbackNumber Returns String
37438>>>                Local String lpropVal
37439>>>                Get GetStringProperty 5 to lpropVal
37440>>>                Function_Return lpropVal
37441>>>        End_Function
37442>>>
37442>>>// Sets or returns the phone number that a server should call back for certain kinds of verification.
37442>>>        Procedure SET RasXComCallbackNumber String lpropVal
37443>>>                Send SetStringProperty 5 lpropVal
37444>>>        End_Procedure
37445>>>
37445>>>// Sets or returns the name of the current phone book entry.
37445>>>        Function RasXComEntryName Returns String
37446>>>                Local String lpropVal
37447>>>                Get GetStringProperty 6 to lpropVal
37448>>>                Function_Return lpropVal
37449>>>        End_Function
37450>>>
37450>>>// Sets or returns the name of the current phone book entry.
37450>>>        Procedure SET RasXComEntryName String lpropVal
37451>>>                Send SetStringProperty 6 lpropVal
37452>>>        End_Procedure
37453>>>
37453>>>// Sets or returns the domain to use for user authentication.
37453>>>        Function RasXComDomain Returns String
37454>>>                Local String lpropVal
37455>>>                Get GetStringProperty 7 to lpropVal
37456>>>                Function_Return lpropVal
37457>>>        End_Function
37458>>>
37458>>>// Sets or returns the domain to use for user authentication.
37458>>>        Procedure SET RasXComDomain String lpropVal
37459>>>                Send SetStringProperty 7 lpropVal
37460>>>        End_Procedure
37461>>>
37461>>>// Determines if methods are blocking.
37461>>>        Function RasXComBlocking Returns Bool
37462>>>                Local Bool lpropVal
37463>>>                Get GetBoolProperty 8 to lpropVal
37464>>>                Function_Return lpropVal
37465>>>        End_Function
37466>>>
37466>>>// Determines if methods are blocking.
37466>>>        Procedure SET RasXComBlocking Bool lpropVal
37467>>>                Send SetBoolProperty 8 lpropVal
37468>>>        End_Procedure
37469>>>
37469>>>// Returns the version of the control.
37469>>>        Function RasXComVersion Returns String
37470>>>                Local String lpropVal
37471>>>                Get GetStringProperty 9 to lpropVal
37472>>>                Function_Return lpropVal
37473>>>        End_Function
37474>>>
37474>>>// Returns the number of names in the current phonebook.
37474>>>        Function RasXComEntryCount Returns Integer
37475>>>                Local Integer lpropVal
37476>>>                Get GetShortProperty 10 to lpropVal
37477>>>                Function_Return lpropVal
37478>>>        End_Function
37479>>>
37479>>>// Returns whether or not RAS services are available.
37479>>>        Function RasXComRASAvailable Returns Bool
37480>>>                Local Bool lpropVal
37481>>>                Get GetBoolProperty 11 to lpropVal
37482>>>                Function_Return lpropVal
37483>>>        End_Function
37484>>>
37484>>>// Holds the last error number reported.
37484>>>        Function RasXComLastError Returns Integer
37485>>>                Local Integer lpropVal
37486>>>                Get GetShortProperty 12 to lpropVal
37487>>>                Function_Return lpropVal
37488>>>        End_Function
37489>>>
37489>>>// Returns the last method executed.
37489>>>        Function RasXComLastMethod Returns OLE_MethodsEnum
37490>>>                Local OLE_MethodsEnum lpropVal
37491>>>                Get GetIntegerProperty 13 to lpropVal
37492>>>                Function_Return lpropVal
37493>>>        End_Function
37494>>>
37494>>>// Holds a description of the last error number reported.
37494>>>        Function RasXComLastErrorString Returns String
37495>>>                Local String lpropVal
37496>>>                Get GetStringProperty 14 to lpropVal
37497>>>                Function_Return lpropVal
37498>>>        End_Function
37499>>>
37499>>>// The current state of the control.
37499>>>        Function RasXComState Returns Integer
37500>>>                Local Integer lpropVal
37501>>>                Get GetShortProperty 15 to lpropVal
37502>>>                Function_Return lpropVal
37503>>>        End_Function
37504>>>
37504>>>// A user-friendly version of the current state of the control.
37504>>>        Function RasXComStateString Returns String
37505>>>                Local String lpropVal
37506>>>                Get GetStringProperty 16 to lpropVal
37507>>>                Function_Return lpropVal
37508>>>        End_Function
37509>>>
37509>>>// Returns the RAS handle of a connection.
37509>>>        Function RasXComHandle Returns DWORD
37510>>>                Local DWORD lpropVal
37511>>>                Get GetIntegerProperty 17 to lpropVal
37512>>>                Function_Return lpropVal
37513>>>        End_Function
37514>>>
37514>>>// Returns whether or not a connection is active.
37514>>>        Function RasXComEntryConnected Returns Bool
37515>>>                Local Bool lpropVal
37516>>>                Get GetBoolProperty 18 to lpropVal
37517>>>                Function_Return lpropVal
37518>>>        End_Function
37519>>>
37519>>>// Returns the list of names in a phone book.
37519>>>        Function RasXComEntryList Integer lIndex Returns String
37520>>>                Local String lpropVal
37521>>>                Send DeclareParams 1
37522>>>                Send DefineShortParam lIndex
37523>>>                Get GetStringProperty 19 to lpropVal
37524>>>                Function_Return lpropVal
37525>>>        End_Function
37526>>>
37526>>>// Holds licensing information.
37526>>>        Function RasXComLicenseKey Returns String
37527>>>                Local String lpropVal
37528>>>                Get GetStringProperty 20 to lpropVal
37529>>>                Function_Return lpropVal
37530>>>        End_Function
37531>>>
37531>>>// Holds licensing information.
37531>>>        Procedure SET RasXComLicenseKey String lpropVal
37532>>>                Send SetStringProperty 20 lpropVal
37533>>>        End_Procedure
37534>>>
37534>>>// Connects to a server.
37534>>>        Procedure RasXComConnect
37535>>>                Send InvokeVoidFunction 22
37536>>>        End_Procedure
37537>>>
37537>>>// Disconnects (logs off) from the server.
37537>>>        Procedure RasXComDisconnect
37538>>>                Send InvokeVoidFunction 23
37539>>>        End_Procedure
37540>>>
37540>>>// Retrives an entry from the current phonebook.
37540>>>        Procedure RasXComGetEntry
37541>>>                Send InvokeVoidFunction 24
37542>>>        End_Procedure
37543>>>
37543>>>// Creates and entry in the current phone book.
37543>>>        Procedure RasXComCreateEntry
37544>>>                Send InvokeVoidFunction 25
37545>>>        End_Procedure
37546>>>
37546>>>// Allows the user to edit a RAS phone book entry.
37546>>>        Procedure RasXComEditEntry
37547>>>                Send InvokeVoidFunction 26
37548>>>        End_Procedure
37549>>>
37549>>>// Resets the component to its original state and re-loads the phone book.
37549>>>        Procedure RasXComRefresh
37550>>>                Send InvokeVoidFunction -550
37551>>>        End_Procedure
37552>>>
37552>>>// Displays About Box.
37552>>>        Procedure RasXComAbout
37553>>>                Send InvokeVoidFunction -552
37554>>>        End_Procedure
37555>>>
37555>>>// Allows object to unload without disconnecting the current connection.
37555>>>        Function RasXComDisconnectOnDestroy Returns Bool
37556>>>                Local Bool lpropVal
37557>>>                Get GetBoolProperty 28 to lpropVal
37558>>>                Function_Return lpropVal
37559>>>        End_Function
37560>>>
37560>>>// Allows object to unload without disconnecting the current connection.
37560>>>        Procedure SET RasXComDisconnectOnDestroy Bool lpropVal
37561>>>                Send SetBoolProperty 28 lpropVal
37562>>>        End_Procedure
37563>>>
37563>>>// Sets or returns an object reference to an object supporting the Fast Notification interface.
37563>>>        Function RasXComNotificationObject Returns LPDispatch
37564>>>                Local LPDispatch lpropVal
37565>>>                Get GetLPDispatchProperty 27 to lpropVal
37566>>>                Function_Return lpropVal
37567>>>        End_Function
37568>>>
37568>>>// Sets or returns an object reference to an object supporting the Fast Notification interface.
37568>>>        Procedure SET RasXComNotificationObject LPDispatch lpropVal
37569>>>                Send SetLPDispatchProperty 27 lpropVal
37570>>>        End_Procedure
37571>>>
37571>>>// Returns the version of the control.
37571>>>        Procedure SET RasXComVersion String lpropVal
37572>>>                Send SetStringProperty 9 lpropVal
37573>>>        End_Procedure
37574>>>
37574>>>End_Class
37575>>>
37575>>>// _IRasXComEvents Interface
37575>>>// CLSID:{8E71552E-4915-11D3-B4C3-0020AFD69DE6}
37575>>>// ProgId:
37575>>>Class OLE_IRasXComEvents is a Automation_Client
37576>>>
37576>>>// Fired when a method finishes.
37576>>>        Procedure RasXComDone OLE_MethodsEnum lLastMethod Integer lErrorCode String lErrorString
37577>>>                Send DeclareParams 3
37578>>>                Send DefineIntegerParam lLastMethod
37579>>>                Send DefineShortParam lErrorCode
37580>>>                Send DefineStringParam lErrorString
37581>>>                Send InvokeVoidFunction 1
37582>>>        End_Procedure
37583>>>
37583>>>// Fired when the control's internal state changes.
37583>>>        Procedure RasXComStateChanged Integer lNewState Integer lOldState
37584>>>                Send DeclareParams 2
37585>>>                Send DefineShortParam lNewState
37586>>>                Send DefineShortParam lOldState
37587>>>                Send InvokeVoidFunction 2
37588>>>        End_Procedure
37589>>>
37589>>>End_Class
37590>>>
37590>>>// RasXCom Class
37590>>>// CoClass CLSID:{8E71552D-4915-11D3-B4C3-0020AFD69DE6}
37590>>>// ProgId: Mabry.RasXCom.1
37590>>>// Number of impl.Types:2
37590>>>// Referenced class IRasXCom
37590>>>// Referenced class _IRasXComEvents
37590>>>Class OLERasXCom is a Automation_Client
37591>>>        Import_Class_Protocol OLEIRasXCom
37592>>>        Import_Class_Protocol OLE_IRasXComEvents
37593>>>
37593>>>        Procedure Construct_Object
37594>>>                Forward Send Construct_Object
37596>>>        Set progIdStr to "Mabry.RasXCom"
37597>>>        End_Procedure
37598>>>End_Class
37599>>>
37599>>>// IRasXComNotify Interface
37599>>>// CLSID:{40B44160-49E0-11D3-B4C3-0020AFD69DE6}
37599>>>// ProgId:
37599>>>Class OLEIRasXComNotify is a Automation_Client
37600>>>
37600>>>// Done
37600>>>        Procedure IRasXComNotifyDone LPDispatch lPackageObject OLE_MethodsEnum lLastMethod Integer lErrorCode String lErrorString
37601>>>                Send DeclareParams 4
37602>>>                Send DefineLPDispatchParam lPackageObject
37603>>>                Send DefineIntegerParam lLastMethod
37604>>>                Send DefineShortParam lErrorCode
37605>>>                Send DefineStringParam lErrorString
37606>>>                Send InvokeVoidFunction 1
37607>>>        End_Procedure
37608>>>
37608>>>// Fired when the control's internal state changes.
37608>>>        Procedure IRasXComNotifyStateChanged LPDispatch lPackageObject Integer lNewState Integer lOldState
37609>>>                Send DeclareParams 3
37610>>>                Send DefineLPDispatchParam lPackageObject
37611>>>                Send DefineShortParam lNewState
37612>>>                Send DefineShortParam lOldState
37613>>>                Send InvokeVoidFunction 2
37614>>>        End_Procedure
37615>>>
37615>>>End_Class
37616>Use Xfind    // Recursive Directory FILE FINDER
INCLUDING FILE: XFIND.PKG
37616>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\XFIND10DEMO.OCX
37616>>>// Generated by FlexOLE Class Generator Friday, November 10, 2000 16:23:24
37616>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
37616>>>
37616>>>// Dispatch interface for xfind Control
37616>>>// CLSID:{DF5A0221-37A0-11D4-881C-E7F891A83074}
37616>>>// ProgId: 
37616>>>Class OLEIxfind is a Message
37617>>>
37617>>>        Procedure xfindAboutBox
37618>>>                Send InvokeVoidFunction -552
37619>>>        End_Procedure 
37620>>>
37620>>>        Function xfindSearchString Returns String
37621>>>                Local String lpropVal
37622>>>                Get GetStringProperty 6 to lpropVal
37623>>>                Function_Return lpropVal
37624>>>        End_Function
37625>>>
37625>>>        Procedure SET xfindSearchString String lpropVal
37626>>>                Send SetStringProperty 6 lpropVal
37627>>>        End_Procedure
37628>>>
37628>>>        Function xfindSearchFrom Returns String
37629>>>                Local String lpropVal
37630>>>                Get GetStringProperty 7 to lpropVal
37631>>>                Function_Return lpropVal
37632>>>        End_Function
37633>>>
37633>>>        Procedure SET xfindSearchFrom String lpropVal
37634>>>                Send SetStringProperty 7 lpropVal
37635>>>        End_Procedure
37636>>>
37636>>>        Function xfindSearchSubDirs Returns Bool
37637>>>                Local Bool lpropVal
37638>>>                Get GetBoolProperty 8 to lpropVal
37639>>>                Function_Return lpropVal
37640>>>        End_Function
37641>>>
37641>>>        Procedure SET xfindSearchSubDirs Bool lpropVal
37642>>>                Send SetBoolProperty 8 lpropVal
37643>>>        End_Procedure
37644>>>
37644>>>        Procedure xfindStartSearching
37645>>>                Send InvokeVoidFunction 2
37646>>>        End_Procedure 
37647>>>
37647>>>        Function xfindIsSearching Returns Bool
37648>>>                Local Bool lpropVal
37649>>>                Get GetBoolProperty 5 to lpropVal
37650>>>                Function_Return lpropVal
37651>>>        End_Function
37652>>>
37652>>>        Procedure xfindAbortSearch
37653>>>                Send InvokeVoidFunction 9
37654>>>        End_Procedure 
37655>>>
37655>>>        Function xfindFileName Returns String
37656>>>                Local String lpropVal
37657>>>                Get GetStringProperty 3 to lpropVal
37658>>>                Function_Return lpropVal
37659>>>        End_Function
37660>>>
37660>>>        Function xfindFileSize Returns DWORD
37661>>>                Local DWORD lpropVal
37662>>>                Get GetIntegerProperty 4 to lpropVal
37663>>>                Function_Return lpropVal
37664>>>        End_Function
37665>>>
37665>>>End_Class
37666>>>
37666>>>// Events interface for xfind Control
37666>>>// CLSID:{DF5A0223-37A0-11D4-881C-E7F891A83074}
37666>>>// ProgId: 
37666>>>Class OLEIxfindEvents is a Message
37667>>>
37667>>>        Procedure OnxfindActivate
37668>>>        End_Procedure
37669>>>
37669>>>        Procedure OnxfindClick
37670>>>        End_Procedure
37671>>>
37671>>>        Procedure OnxfindCreate
37672>>>        End_Procedure
37673>>>
37673>>>        Procedure OnxfindDblClick
37674>>>        End_Procedure
37675>>>
37675>>>        Procedure OnxfindDestroy
37676>>>        End_Procedure
37677>>>
37677>>>        Procedure OnxfindDeactivate
37678>>>        End_Procedure
37679>>>
37679>>>        Procedure OnxfindKeyPress Integer lKey
37680>>>        End_Procedure
37681>>>
37681>>>        Procedure OnxfindPaint
37682>>>        End_Procedure
37683>>>
37683>>>        Procedure OnxfindFinishedSearch
37684>>>        End_Procedure
37685>>>
37685>>>        Procedure OnxfindFoundFile
37686>>>        End_Procedure
37687>>>
37687>>>End_Class
37688>>>
37688>>>// xfind Control
37688>>>// CoClass CLSID:{DF5A0225-37A0-11D4-881C-E7F891A83074}
37688>>>// ProgId: xfind10.xfind
37688>>>// Number of impl.Types:2
37688>>>// Referenced class Ixfind
37688>>>// Referenced class IxfindEvents
37688>>>Class OLExfind is a OCX_Client
37689>>>        Import_Class_Protocol OLEIxfind
37690>>>        Import_Class_Protocol OLEIxfindEvents
37691>>>
37691>>>        Procedure Construct_Object
37692>>>                Forward Send Construct_Object
37694>>>                Send DefineOCX_Client
37695>>>                Set progIdStr to "xfind10.xfind"
37696>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLExfind"
37699>>>        End_Procedure
37700>>>
37700>>>        Procedure PrexfindKeyPress Integer lParam
37701>>>                Local Integer lKey
37702>>>                Get GetEventShortParam lParam 0 to lKey
37703>>>                Send OnxfindKeyPress lKey
37704>>>        End_Procedure
37705>>>
37705>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
37706>>>                ON_EVENT 1 Fire OnxfindActivate
37709>>>                ON_EVENT 2 Fire OnxfindClick
37712>>>                ON_EVENT 3 Fire OnxfindCreate
37715>>>                ON_EVENT 5 Fire OnxfindDblClick
37718>>>                ON_EVENT 6 Fire OnxfindDestroy
37721>>>                ON_EVENT 7 Fire OnxfindDeactivate
37724>>>                ON_EVENT 11 Fire PrexfindKeyPress
37727>>>                ON_EVENT 16 Fire OnxfindPaint
37730>>>                ON_EVENT 4 Fire OnxfindFinishedSearch
37733>>>                ON_EVENT 8 Fire OnxfindFoundFile
37736>>>        End_Procedure
37737>>>End_Class
37738>>>
37738>>>// xfind Control
37738>>>// CoClass CLSID:{DF5A0225-37A0-11D4-881C-E7F891A83074}
37738>>>// ProgId: xfind10.xfind
37738>>>// Number of impl.Types:2
37738>>>// Referenced class Ixfind
37738>>>// Referenced class IxfindEvents
37738>>>Class dbOLExfind is a dbOCX_Client
37739>>>        Import_Class_Protocol OLEIxfind
37740>>>        Import_Class_Protocol OLEIxfindEvents
37741>>>
37741>>>        Procedure Construct_Object
37742>>>                Forward Send Construct_Object
37744>>>                Send DefineDbOCX_Client
37745>>>                Set progIdStr to "xfind10.xfind"
37746>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLExfind"
37749>>>        End_Procedure
37750>>>
37750>>>        Procedure PrexfindKeyPress Integer lParam
37751>>>                Local Integer lKey
37752>>>                Get GetEventShortParam lParam 0 to lKey
37753>>>                Send OnxfindKeyPress lKey
37754>>>        End_Procedure
37755>>>
37755>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
37756>>>                ON_EVENT 1 Fire OnxfindActivate
37759>>>                ON_EVENT 2 Fire OnxfindClick
37762>>>                ON_EVENT 3 Fire OnxfindCreate
37765>>>                ON_EVENT 5 Fire OnxfindDblClick
37768>>>                ON_EVENT 6 Fire OnxfindDestroy
37771>>>                ON_EVENT 7 Fire OnxfindDeactivate
37774>>>                ON_EVENT 11 Fire PrexfindKeyPress
37777>>>                ON_EVENT 16 Fire OnxfindPaint
37780>>>                ON_EVENT 4 Fire OnxfindFinishedSearch
37783>>>                ON_EVENT 8 Fire OnxfindFoundFile
37786>>>        End_Procedure
37787>>>End_Class
37788>Use dvFtp    // FTP Package
INCLUDING FILE: DVFTP.PKG
37788>>>// DVFTP.PKG - Internet File Transfer Protocol (FTP) functions
37788>>>//             for Visual Dataflex
37788>>>//
37788>>>// Created by: Marcel J. Zwiebel
37788>>>//             Dataview - The Netherlands
37788>>>// E-mail    : marcel@dataview-sc.com
37788>>>// CIS id    : 100273,2473
37788>>>// Web URL   : http://www.dataview-sc.com
37788>>>//
37788>>>// Date      : 28/07/1997 
37788>>>
37788>>>Use Windows.pkg
37788>>>Use DLL.pkg
37788>>>
37788>>>// register external functions of the dvftp.dll
37788>>>
37788>>>
37788>>>// function   : dvInternetAttemptConnect
37788>>>//
37788>>>// description: Attemps to make a connection to the Internet. If the user has a dialup-connection
37788>>>//              to an Internet Service Provider (ISP) and the computer is not connected to this 
37788>>>//              ISP, the standard dialup dialog box will be evoked.
37788>>>//                   
37788>>>// parameters : none
37788>>>//
37788>>>// returns    : integer - Is 0 (ok) or error-number.
37788>>>//
37788>>>External_Function dvInternetAttemptConnect "dvInternetAttemptConnect" DVFTP.DLL ;     Returns Integer
37789>>>
37789>>>
37789>>>// function   : dvInternetOpen
37789>>>//
37789>>>// description: Initializes the application's use of the WIN32 Internet functions.
37789>>>//
37789>>>// parameters : none
37789>>>//
37789>>>// returns    : integer - Is 0 (ok) or error-number.
37789>>>//
37789>>>External_Function dvInternetOpen "dvInternetOpen" DVFTP.DLL ;     Returns Integer
37790>>>
37790>>>
37790>>>// function   : dvInternetConnect
37790>>>//
37790>>>// description: Opens an FTP-session with a server.
37790>>>//
37790>>>// parameters : string ServerName - Can be a DNS-name (for example: ftp.daccess.com) or 
37790>>>//                                  an ip-number (for example: 145.58.31.4).
37790>>>//              string UserName   - Login-name for the server, can be empty for 
37790>>>//                                  "anonymous" login (default for most FTP servers).
37790>>>//              string Password   - Password for the server, can be empty for 
37790>>>//                                  "anonymous" login (default for most FTP servers).
37790>>>//              integer Firewall  - Must be 1 for connecting through a SOCKS firewall
37790>>>//                                  server, otherwise 0.
37790>>>//
37790>>>// returns    : integer - Is 0 (ok) or error-number.
37790>>>//
37790>>>External_Function dvInternetConnect "dvInternetConnect" DVFTP.DLL ;     String szServerName String szUserName String szPassword Integer iFirewall;     Returns Integer
37791>>>
37791>>>
37791>>>// function   : dvFtpSetCurrentDirectory
37791>>>//
37791>>>// description: Changes to a different working directory on the FTP server.
37791>>>//
37791>>>// parameters : string directory - Name of the directory to change to on the remote system. 
37791>>>//                                 This can be either a fully qualified path or a name 
37791>>>//                                 relative to the current directory. 
37791>>>//                                 A backslash (\) or forward slash (/) can be used as the 
37791>>>//                                 directory separator for either name. dvFtpSetCurrentDirectory
37791>>>//                                 translates the directory name separators to the appropriate 
37791>>>//                                 character before they are used. 
37791>>>//                                 Use dvFtpGetCurrentDirectory to determine the remote site's 
37791>>>//                                 current working directory (not all remote systems use a
37791>>>//                                 hierarchical naming scheme for directories).
37791>>>//
37791>>>// returns    : integer - Is 0 (ok) or error-number.
37791>>>//
37791>>>External_Function dvFtpSetCurrentDirectory "dvFtpSetCurrentDirectory" DVFTP.DLL ;     String szDirectory Returns Integer
37792>>>
37792>>>
37792>>>// function   : dvFtpGetCurrentDirectory
37792>>>//
37792>>>// description: Retrieves the current directory for the specified FTP session.
37792>>>//
37792>>>// parameters : none
37792>>>//
37792>>>// returns    : string - Name of the current directory.
37792>>>//
37792>>>External_Function dvFtpGetCurrentDirectory "dvFtpGetCurrentDirectory" DVFTP.DLL ;     Returns String
37793>>>
37793>>>
37793>>>// function   : dvFtpCreateDirectory
37793>>>//
37793>>>// description: Creates a new directory on the FTP server. 
37793>>>//
37793>>>// parameters : string Directory - The name of the directory to create on the remote system.
37793>>>//                                 This can be either a fully qualified path or a name 
37793>>>//                                 relative to the current directory. 
37793>>>//                                 A backslash (\) or forward slash (/) can be used as the 
37793>>>//                                 directory separator for either name. dvFtpCreateDirectory
37793>>>//                                 translates the directory name separators to the appropriate 
37793>>>//                                 character before they are used. 
37793>>>//                                 Use dvFtpGetCurrentDirectory to determine the remote site's 
37793>>>//                                 current working directory (not all remote systems use a
37793>>>//                                 hierarchical naming scheme for directories).
37793>>>//
37793>>>// returns    : integer - Is 0 (ok) or error-number.
37793>>>//
37793>>>External_Function dvFtpCreateDirectory "dvFtpCreateDirectory" DVFTP.DLL ;     String szDirectory Returns Integer
37794>>>
37794>>>
37794>>>// function   : dvFtpRemoveDirectory
37794>>>//
37794>>>// description: Removes the specified directory on the FTP server. 
37794>>>//
37794>>>// parameters : string Directory - The name of the directory to remove on the remote system.
37794>>>//                                 This can be either a fully qualified path or a name 
37794>>>//                                 relative to the current directory. 
37794>>>//                                 A backslash (\) or forward slash (/) can be used as the 
37794>>>//                                 directory separator for either name. dvFtpRemoveDirectory
37794>>>//                                 translates the directory name separators to the appropriate 
37794>>>//                                 character before they are used. 
37794>>>//                                 Use dvFtpGetCurrentDirectory to determine the remote site's 
37794>>>//                                 current working directory (not all remote systems use a
37794>>>//                                 hierarchical naming scheme for directories).
37794>>>//
37794>>>// returns    : integer - Is 0 (ok) or error-number.
37794>>>//
37794>>>External_Function dvFtpRemoveDirectory "dvFtpRemoveDirectory" DVFTP.DLL ;     String szDirectory Returns Integer
37795>>>
37795>>>
37795>>>// function   : dvFtpFindFirstFile
37795>>>//
37795>>>// description: Searches the specified directory of the given FTP session.
37795>>>//
37795>>>// parameters : string FileSelect - A valid directory path or file name (wildcards allowed) for
37795>>>//                                  the FTP server's file system. If the string is empty the 
37795>>>//                                  first file in the current directory on the server will be 
37795>>>//                                  searched for. 
37795>>>//              integer UseCache  - Indicates using the local computer's cache.
37795>>>//                                  If the value is 0 then the the cache will be used. 
37795>>>//                                  If the value is 1 then a download of the requested file, 
37795>>>//                                  object, or directory listing from the origin server will be 
37795>>>//                                  forced, not from the cache.
37795>>>//
37795>>>// returns    : string - Name of the first file found or empty when no files found. When the 
37795>>>//                       searched directory is empty the string "directory is empty" is returned.
37795>>>//
37795>>>External_Function dvFtpFindFirstFile "dvFtpFindFirstFile" DVFTP.DLL ;     String szFileSelect Integer iUseCache Returns String
37796>>>
37796>>>
37796>>>// function   : dvFtpFindNextFile
37796>>>//
37796>>>// description: Continues a file search started as a result of executing dvFtpFindFirstFile.
37796>>>//
37796>>>// parameters : none
37796>>>//
37796>>>// returns    : string - Name of the next file found or empty when no more files are found.
37796>>>//
37796>>>External_Function dvFtpFindNextFile "dvFtpFindNextFile" DVFTP.DLL ;     Returns String
37797>>>
37797>>>
37797>>>// function   : dvFtpDeleteFile
37797>>>//
37797>>>// description: Deletes a file stored on the FTP server. 
37797>>>//
37797>>>// parameters : string FileSelect - Name of the file to be deleted.
37797>>>//                                  Can be file names relative to the current directory. 
37797>>>//                                  A backslash (\) or forward slash (/) can be used as 
37797>>>//                                  the directory separator. dvFtpDeleteFile translates the 
37797>>>//                                  directory name separators to the appropriate character 
37797>>>//                                  before they are used. 
37797>>>//
37797>>>// returns    : integer - Is 0 (ok) or error-number.
37797>>>//
37797>>>External_Function dvFtpDeleteFile "dvFtpDeleteFile" DVFTP.DLL ;     String szFileSelect Returns Integer
37798>>>
37798>>>
37798>>>// function   : dvFtpRenameFile
37798>>>//
37798>>>// description: Renames a file stored on the FTP server. 
37798>>>//
37798>>>// parameters : string Existing - The name of the file that will have its name changed on the
37798>>>//                                remote FTP server. 
37798>>>//              string New      - The new name for the remote file. 
37798>>>//
37798>>>//                                Both names can be relative to the current directory. A backslash 
37798>>>//                                (\) or forward slash (/) can be used as the directory separator 
37798>>>//                                for either name. dvFtpRenameFile translates the directory name 
37798>>>//                                separators to the appropriate character before they are used. 
37798>>>//
37798>>>// returns    : integer - Is 0 (ok) or error-number.
37798>>>//
37798>>>External_Function dvFtpRenameFile "dvFtpRenameFile" DVFTP.DLL ;     String szExisting String szNew Returns Integer
37799>>>
37799>>>
37799>>>// function   : dvFtpGetFile
37799>>>//
37799>>>// description: Retrieves a file from the FTP server and stores it under the specified file name, 
37799>>>//              creating a new local file in the process. 
37799>>>//
37799>>>// parameters : string  RemoteFile   - The name of the file to retrieve from the remote system. 
37799>>>//              string  NewFile      - The name of the file to create on the local system. 
37799>>>//              integer FailIfExists - Boolean flag that indicates whether the function should 
37799>>>//                                     proceed if a local file of the specified name already exists. 
37799>>>//                                     If value is 1 and the local file exists, dvFtpGetFile fails. 
37799>>>//              integer FileType     - Indicates the transfer method.
37799>>>//                                     If the value is 0 then the function transfers the file using 
37799>>>//                                     FTP's ASCII (Type A) transfer method. Control and formatting 
37799>>>//                                     information is converted to local equivalents. 
37799>>>//                                     If the value is 1 then the function transfers the file using 
37799>>>//                                     FTP's Image (Type I) transfer method. The file is transferred 
37799>>>//                                     exactly as it exists with no changes. 
37799>>>//
37799>>>// returns    : integer - Is 0 (ok) or error-number.
37799>>>//
37799>>>External_Function dvFtpGetFile "dvFtpGetFile" DVFTP.DLL ;     String szRemoteFile String szNewFile Integer bFailIfExists Integer iFileType Returns Integer
37800>>>
37800>>>
37800>>>// function   : dvFtpPutFile
37800>>>//
37800>>>// description: Stores a file on the FTP server. 
37800>>>//
37800>>>// parameters : string  LocalFile     - The name of the file to send from the local system. 
37800>>>//              string  NewRemoteFile - The name of the file to create on the remote system.
37800>>>//              integer FileType      - Indicates the transfer method.
37800>>>//                                      If the value is 0 then the function transfers the 
37800>>>//                                      file as ASCII. 
37800>>>//                                      If the value is 1 then the function transfres the
37800>>>//                                      file as binary. 
37800>>>//
37800>>>// returns    : integer - Is 0 (ok) or error-number.
37800>>>//
37800>>>External_Function dvFtpPutFile "dvFtpPutFile" DVFTP.DLL ;     String szLocalFile String szNewRemoteFile Integer iFileType Returns Integer
37801>>>
37801>>>
37801>>>
37801>>>// The following functions give common file-information after performing dvFtpFindFirstFile
37801>>>// and dvFtpFindNextFile. Because the FTP protocol provides no standard means of enumerating, 
37801>>>// some of the common information about files, such as file creation date and time, is not 
37801>>>// always available or correct. When this happens, dvFtpFindFirstFile and dvFtpFindNextFile 
37801>>>// fill in unavailable information with a best guess based on available information. For example,
37801>>>// creation and last access dates will often be the same as the file's modification date.
37801>>>
37801>>>
37801>>>// function   : dvFtpFilename
37801>>>//
37801>>>// description: The name of the file. 
37801>>>//
37801>>>// parameters : none
37801>>>//
37801>>>// returns    : string - Name of the file
37801>>>//
37801>>>External_Function dvFtpFilename "dvFtpFilename" DVFTP.DLL ;     Returns String
37802>>>
37802>>>
37802>>>// function   : dvFtpAlternateFilename
37802>>>//
37802>>>// description: An alternative name for the file. This name is in the classic 8.3 (filename.ext)
37802>>>//              filename format.
37802>>>//
37802>>>// parameters : none
37802>>>//
37802>>>// returns    : string - Alternate name for the file. If the file has a long filename, the complete 
37802>>>//                       name can be retrieved by the dvFtpFilename function, and the 8.3 format
37802>>>//                       truncated version of the name can be retrieved with this function. Otherwise, 
37802>>>//                       this function returns an empty string.
37802>>>//
37802>>>External_Function dvFtpAlternateFilename "dvFtpAlternateFilename" DVFTP.DLL ;     Returns String
37803>>>
37803>>>
37803>>>// function   : dvFtpFileCreated
37803>>>//              
37803>>>// description: The date/time the file was created in 24-hour format.
37803>>>//
37803>>>// parameters : integer DateFormat - The format of the date to be retrieved.
37803>>>//                                   If value is 0 then US-formatted date is returned (mm/dd/yyyy).
37803>>>//                                   If value is 1 then European-formatted date is returned (dd/mm/yyyy).
37803>>>//                                   If value is 2 then military-formatted date is returned (yyyy.mm.dd).
37803>>>//
37803>>>// returns    : string - The file creation-date/time
37803>>>//
37803>>>External_Function dvFtpFileCreated "dvFtpFileCreated" DVFTP.DLL ;     Integer iDateFormat Returns String
37804>>>
37804>>>
37804>>>// function   : dvFtpFileAccessed
37804>>>//              
37804>>>// description: The last date/time the file was accessed in 24-hour format.
37804>>>//
37804>>>// parameters : integer DateFormat - The format of the date to be retrieved.
37804>>>//                                   If value is 0 then US-formatted date is returned (mm/dd/yyyy).
37804>>>//                                   If value is 1 then European-formatted date is returned (dd/mm/yyyy).
37804>>>//                                   If value is 2 then military-formatted date is returned (yyyy.mm.dd).
37804>>>//
37804>>>// returns    : string - The last file access-date/time
37804>>>//
37804>>>External_Function dvFtpFileAccessed "dvFtpFileAccessed" DVFTP.DLL ;     Integer iDateFormat Returns String
37805>>>
37805>>>
37805>>>// function   : dvFtpFileWritten
37805>>>//              
37805>>>// description: The last date/time the file was written to in 24-hour format.
37805>>>//
37805>>>// parameters : integer DateFormat - The format of the date to be retrieved.
37805>>>//                                   If value is 0 then US-formatted date is returned (mm/dd/yyyy).
37805>>>//                                   If value is 1 then European-formatted date is returned (dd/mm/yyyy).
37805>>>//                                   If value is 2 then military-formatted date is returned (yyyy.mm.dd).
37805>>>//
37805>>>// returns    : string - The last file written to-date/time
37805>>>//
37805>>>External_Function dvFtpFileWritten "dvFtpFileWritten" DVFTP.DLL ;     Integer iDateFormat Returns String
37806>>>
37806>>>
37806>>>// function   : dvFtpFileSize
37806>>>//              
37806>>>// description: The size of the file in bytes.
37806>>>//
37806>>>// parameters : none
37806>>>//
37806>>>// returns    : integer - Filesize in bytes.
37806>>>//
37806>>>External_Function dvFtpFileSize "dvFtpFileSize" DVFTP.DLL ;     Returns Integer
37807>>>
37807>>>
37807>>>// function   : dvFtpIsDirectory
37807>>>//              
37807>>>// description: The file is an directory.
37807>>>//
37807>>>// parameters : none
37807>>>//
37807>>>// returns    : integer - If value is 1 the file is directory, otherwise 0 will be returned.
37807>>>//
37807>>>External_Function dvFtpIsDirectory "dvFtpIsDirectory" DVFTP.DLL ;     Returns Integer
37808>>>
37808>>>
37808>>>// function   : dvGetServerMsg
37808>>>//              
37808>>>// description: Gets the returned message from the FTP server (error-number will
37808>>>//              be 12003 "extended error").
37808>>>//
37808>>>// parameters : none
37808>>>//
37808>>>// returns    : string - Return message from the FTP server.
37808>>>//
37808>>>External_Function dvGetServerMsg "dvGetServerMsg" DVFTP.DLL;     Returns String
37809>>>
37809>>>
37809>>>// error-numbers returned
37809>>>//
37809>>>// 12001  "out of handles"            
37809>>>// 12002  "timeout"
37809>>>// 12003  "extended error"
37809>>>// 12004  "internal error"            
37809>>>// 12005  "invalid url"               
37809>>>// 12006  "unrecognized scheme"       
37809>>>// 12007  "name not resolved"         
37809>>>// 12008  "protocol not found"        
37809>>>// 12009  "invalid option"            
37809>>>// 12010  "bad option length"         
37809>>>// 12011  "option not settable"      
37809>>>// 12012  "shutdown"                  
37809>>>// 12013  "incorrect user name"       
37809>>>// 12014  "incorrect password"
37809>>>// 12015  "login failure"             
37809>>>// 12016  "invalid operation"         
37809>>>// 12017  "operation cancelled"       
37809>>>// 12018  "incorrect handle type"     
37809>>>// 12019  "incorrect handle state"
37809>>>// 12020  "not proxy request"         
37809>>>// 12021  "registry value not found"
37809>>>// 12022  "bad registry parameter"    
37809>>>// 12023  "no direct access"          
37809>>>// 12024  "no context"                
37809>>>// 12025  "no callback"               
37809>>>// 12026  "request pending"           
37809>>>// 12027  "incorrect format"          
37809>>>// 12028  "item not found"            
37809>>>// 12029  "cannot connect"            
37809>>>// 12030  "connection aborted"        
37809>>>// 12031  "connection reset"          
37809>>>// 12032  "force retry"               
37809>>>// 12033  "invalid proxy request"     
37809>>>// 12034  "need ui"                   
37809>>>// 12036  "handle exists"             
37809>>>// 12037  "sec cert date invalid"     
37809>>>// 12038  "sec cert cn invalid"       
37809>>>// 12039  "http to https on redir"    
37809>>>// 12040  "https to http on_redir"    
37809>>>// 12041  "mixed security"            
37809>>>// 12042  "chg post is non secure"    
37809>>>// 12043  "post is non_secure"        
37809>>>// 12044  "client auth cert needed"   
37809>>>// 12045  "invalid ca"                
37809>>>// 12046  "client auth not setup"     
37809>>>// 12047  "async thread failed"       
37809>>>// 12048  "redirect scheme change"    
37809>>>// 12049  "dialog pending"            
37809>>>// 12050  "retry dialog"              
37809>>>// 12110  "ftp transfer in progress"  
37809>>>// 12111  "ftp dropped"               
37809>>>// 12112  "ftp no passive mode"       
37809>>>// 12157  "security channel error"    
37809>>>// 12158  "unable to cache file"      
37809>>>// 12159  "tcpip not installed"       
37809>>>// 12163  "disconnected"              
37809>>>// 12164  "server unreachable"        
37809>>>// 12165  "proxy server unreachable"  
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>>>
37809>Use DVDIALER // Vdf6 Dialer
INCLUDING FILE: DVDIALER.PKG
37809>>>// DVDIALER.PKG - Automatic dialing functions for dial-up access to the Internet
37809>>>//
37809>>>// Created by: Marcel J. Zwiebel
37809>>>//             Dataview - The Netherlands
37809>>>// E-mail    : marcel@dataview-sc.com
37809>>>// Web URL   : http://www.dataview-sc.com
37809>>>//
37809>>>// Date      : 03/24/1999
37809>>>
37809>>>Use Windows.pkg
37809>>>Use DLL.pkg 
37809>>>
37809>>>
37809>>>// register external functions of the dvdailer.dll
37809>>>
37809>>>
37809>>>// function   : dvInternetGetConnectedState
37809>>>//
37809>>>// description: Retrieves the connected state of the local system.
37809>>>//                   
37809>>>// parameters : none
37809>>>//
37809>>>// returns    : integer - value 1 = the local system is (currently) connected by a modem to the Internet.
37809>>>//                              2 = the local system uses a local area network to connect to the Internet.
37809>>>//                              3 = the local system uses a proxy server to connect to the Internet.
37809>>>//                              4 = the local system's modem is busy with a non-Internet connection.
37809>>>//                              0 = there is no Internet connection.
37809>>>//
37809>>>External_Function32 dvInternetGetConnectedState "dvInternetGetConnectedState" DVDIALER.DLL Returns Integer
37810>>>
37810>>>
37810>>>// function   : dvInternetAutodial
37810>>>//
37810>>>// description: Automatically causes the modem to dial the default Internet connection.
37810>>>//              Use the function dvInternetAutodialHangup to hangup this connection.
37810>>>//                   
37810>>>// parameters : none
37810>>>//
37810>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
37810>>>//
37810>>>External_Function32 dvInternetAutodial "dvInternetAutodial" DVDIALER.DLL Returns Integer
37811>>>
37811>>>
37811>>>// function   : dvInternetAutodialHangup
37811>>>//
37811>>>// description: Disconnects an automatic dial-up connection invoked by dvInternetAutodial. 
37811>>>//                   
37811>>>// parameters : none
37811>>>//
37811>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
37811>>>//
37811>>>External_Function32 dvInternetAutodialHangup "dvInternetAutodialHangup" DVDIALER.DLL Returns Integer
37812>>>
37812>>>
37812>>>// function   : dvInternetDial
37812>>>//
37812>>>// description: Initiates a connection to the Internet using a modem connection and a phonebook entry.
37812>>>//              Use the function dvInternetHangup to hangup this connection.
37812>>>//                   
37812>>>// parameters : string - The name of the dial-up connection to use (phonebook entry).
37812>>>//
37812>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
37812>>>//
37812>>>External_Function32 dvInternetDial "dvInternetDial" DVDIALER.DLL String szConnectiontoid Returns Integer
37813>>>
37813>>>
37813>>>// function   : dvInternetHangup
37813>>>//
37813>>>// description: Instructs the modem to disconnect from the Internet (connection invoked by dvInternetDial). 
37813>>>//              
37813>>>// parameters : none
37813>>>//
37813>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
37813>>>//
37813>>>External_Function32 dvInternetHangUp "dvInternetHangUp" DVDIALER.DLL Returns Integer
37814>>>
37814>>>
37814>>>
37814>>>
37814>>>
37814>>>
37814>>>
37814>>>
37814>>>
37814>>>
37814>>>
37814>>>
37814>Use mbForm
INCLUDING FILE: MBFORM.PKG
37814>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\MBFORMEX.OCX
37814>>>// Generated by FlexOLE Class Generator Friday, February 07, 2003 15:11:24
37814>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
37814>>>
37814>>>//Enum_List
37814>>>        Define OLEmbNone for 0 // mbNone
37814>>>        Define OLEmbClientOnly for 1 // mbClientOnly
37814>>>        Define OLEmbWindow for 2 // mbWindow
37814>>>//End_Enum_List
37814>>>
37814>>>// CLSID:{2BF273CB-D8EB-11D3-8ED1-CFAA7A653C7F}
37814>>>// ProgId:
37814>>>Class OLE_FormEx is a Message
37815>>>
37815>>>// Opens the AboutBox dialog.
37815>>>        Procedure FormExAbout
37816>>>                Send InvokeVoidFunction -552
37817>>>        End_Procedure
37818>>>
37818>>>// Saves the position and the size of all the controls. This method is useful if you add controls at runtime and you want to save their position and size as the ResizeControls can work correctly.
37818>>>        Procedure FormExSaveCtlPos
37819>>>                Send InvokeVoidFunction 1610809379
37820>>>        End_Procedure
37821>>>
37821>>>// Adds a item to the system menu and returns its identifier.
37821>>>        Function FormExAddSysItem LPString lsText Returns DWORD
37822>>>                Local DWORD lretVal
37823>>>                Send DeclareParams 1
37824>>>                Send DefineIntegerParam lsText
37825>>>                Get InvokeIntegerFunction 1610809363 to lretVal
37826>>>                Function_Return lretVal
37827>>>        End_Function
37828>>>
37828>>>// Removes the system menu item with the specified identifier.
37828>>>        Function FormExRemoveSysItem DWORD lID Returns Bool
37829>>>                Local Bool lretVal
37830>>>                Send DeclareParams 1
37831>>>                Send DefineIntegerParam lID
37832>>>                Get InvokeBoolFunction 1610809364 to lretVal
37833>>>                Function_Return lretVal
37834>>>        End_Function
37835>>>
37835>>>// Returns the identifier of the system menu item with the specified index.
37835>>>        Function FormExGetIdentifier DWORD lIndex Returns DWORD
37836>>>                Local DWORD lretVal
37837>>>                Send DeclareParams 1
37838>>>                Send DefineIntegerParam lIndex
37839>>>                Get InvokeIntegerFunction 1610809365 to lretVal
37840>>>                Function_Return lretVal
37841>>>        End_Function
37842>>>
37842>>>// Sets the text of the specified system menu item.
37842>>>        Function FormExGetSysItemText DWORD lID Returns String
37843>>>                Local String lretVal
37844>>>                Send DeclareParams 1
37845>>>                Send DefineIntegerParam lID
37846>>>                Get InvokeStringFunction 1610809366 to lretVal
37847>>>                Function_Return lretVal
37848>>>        End_Function
37849>>>
37849>>>// Sets the text of the specified system menu item.
37849>>>        Function FormExSetSysItemText DWORD lID LPString lsNewText Returns Bool
37850>>>                Local Bool lretVal
37851>>>                Send DeclareParams 2
37852>>>                Send DefineIntegerParam lID
37853>>>                Send DefineIntegerParam lsNewText
37854>>>                Get InvokeBoolFunction 1610809367 to lretVal
37855>>>                Function_Return lretVal
37856>>>        End_Function
37857>>>
37857>>>// Returns/Sets a value indicating whether the form's size is limited.
37857>>>        Function FormExLimitSize Returns Bool
37858>>>                Local Bool lpropVal
37859>>>                Get GetBoolProperty 1745027089 to lpropVal
37860>>>                Function_Return lpropVal
37861>>>        End_Function
37862>>>
37862>>>// Returns/Sets a value indicating whether the form's size is limited.
37862>>>        Procedure SET FormExLimitSize Bool lpropVal
37863>>>                Send SetBoolProperty 1745027089 lpropVal
37864>>>        End_Procedure
37865>>>
37865>>>// Returns/Sets the form's max width (in pixels).
37865>>>        Function FormExMaxWidth Returns DWORD
37866>>>                Local DWORD lpropVal
37867>>>                Get GetIntegerProperty 1745027088 to lpropVal
37868>>>                Function_Return lpropVal
37869>>>        End_Function
37870>>>
37870>>>// Returns/Sets the form's max width (in pixels).
37870>>>        Procedure SET FormExMaxWidth DWORD lpropVal
37871>>>                Send SetIntegerProperty 1745027088 lpropVal
37872>>>        End_Procedure
37873>>>
37873>>>// Returns/Sets the form's max height (in pixels).
37873>>>        Function FormExMaxHeight Returns DWORD
37874>>>                Local DWORD lpropVal
37875>>>                Get GetIntegerProperty 1745027087 to lpropVal
37876>>>                Function_Return lpropVal
37877>>>        End_Function
37878>>>
37878>>>// Returns/Sets the form's max height (in pixels).
37878>>>        Procedure SET FormExMaxHeight DWORD lpropVal
37879>>>                Send SetIntegerProperty 1745027087 lpropVal
37880>>>        End_Procedure
37881>>>
37881>>>// Returns/Sets the form's min height (in pixels).
37881>>>        Function FormExMinHeight Returns DWORD
37882>>>                Local DWORD lpropVal
37883>>>                Get GetIntegerProperty 1745027086 to lpropVal
37884>>>                Function_Return lpropVal
37885>>>        End_Function
37886>>>
37886>>>// Returns/Sets the form's min height (in pixels).
37886>>>        Procedure SET FormExMinHeight DWORD lpropVal
37887>>>                Send SetIntegerProperty 1745027086 lpropVal
37888>>>        End_Procedure
37889>>>
37889>>>// Returns/Sets the form's min width (in pixels).
37889>>>        Function FormExMinWidth Returns DWORD
37890>>>                Local DWORD lpropVal
37891>>>                Get GetIntegerProperty 1745027085 to lpropVal
37892>>>                Function_Return lpropVal
37893>>>        End_Function
37894>>>
37894>>>// Returns/Sets the form's min width (in pixels).
37894>>>        Procedure SET FormExMinWidth DWORD lpropVal
37895>>>                Send SetIntegerProperty 1745027085 lpropVal
37896>>>        End_Procedure
37897>>>
37897>>>// Returns/Sets the Left coordinate when the form is maximized.
37897>>>        Function FormExLeftWhenMax Returns DWORD
37898>>>                Local DWORD lpropVal
37899>>>                Get GetIntegerProperty 1745027084 to lpropVal
37900>>>                Function_Return lpropVal
37901>>>        End_Function
37902>>>
37902>>>// Returns/Sets the Left coordinate when the form is maximized.
37902>>>        Procedure SET FormExLeftWhenMax DWORD lpropVal
37903>>>                Send SetIntegerProperty 1745027084 lpropVal
37904>>>        End_Procedure
37905>>>
37905>>>// Returns/Sets the Topt coordinate when the form is maximized.
37905>>>        Function FormExTopWhenMax Returns DWORD
37906>>>                Local DWORD lpropVal
37907>>>                Get GetIntegerProperty 1745027083 to lpropVal
37908>>>                Function_Return lpropVal
37909>>>        End_Function
37910>>>
37910>>>// Returns/Sets the Topt coordinate when the form is maximized.
37910>>>        Procedure SET FormExTopWhenMax DWORD lpropVal
37911>>>                Send SetIntegerProperty 1745027083 lpropVal
37912>>>        End_Procedure
37913>>>
37913>>>// Returns/Sets a value indicating whether the form is visible in the Windows Task List.
37913>>>        Function FormExShowInTaskList Returns Bool
37914>>>                Local Bool lpropVal
37915>>>                Get GetBoolProperty 1745027082 to lpropVal
37916>>>                Function_Return lpropVal
37917>>>        End_Function
37918>>>
37918>>>// Returns/Sets a value indicating whether the form is visible in the Windows Task List.
37918>>>        Procedure SET FormExShowInTaskList Bool lpropVal
37919>>>                Send SetBoolProperty 1745027082 lpropVal
37920>>>        End_Procedure
37921>>>
37921>>>// Returns/Sets a value indicating whether the form is always on top.
37921>>>        Function FormExAlwaysOnTop Returns Bool
37922>>>                Local Bool lpropVal
37923>>>                Get GetBoolProperty 1745027081 to lpropVal
37924>>>                Function_Return lpropVal
37925>>>        End_Function
37926>>>
37926>>>// Returns/Sets a value indicating whether the form is always on top.
37926>>>        Procedure SET FormExAlwaysOnTop Bool lpropVal
37927>>>                Send SetBoolProperty 1745027081 lpropVal
37928>>>        End_Procedure
37929>>>
37929>>>// Returns/Sets a value indicating whether the form accepts drag-dropped files.
37929>>>        Function FormExAcceptFiles Returns Bool
37930>>>                Local Bool lpropVal
37931>>>                Get GetBoolProperty 1745027080 to lpropVal
37932>>>                Function_Return lpropVal
37933>>>        End_Function
37934>>>
37934>>>// Returns/Sets a value indicating whether the form accepts drag-dropped files.
37934>>>        Procedure SET FormExAcceptFiles Bool lpropVal
37935>>>                Send SetBoolProperty 1745027080 lpropVal
37936>>>        End_Procedure
37937>>>
37937>>>// Returns/Sets a value indicating whether the form is transparent (client only or the entire window).
37937>>>        Function FormExTransparent Returns OLE_mbTransparent
37938>>>                Local OLE_mbTransparent lpropVal
37939>>>                Get GetIntegerProperty 1745027079 to lpropVal
37940>>>                Function_Return lpropVal
37941>>>        End_Function
37942>>>
37942>>>// Returns/Sets a value indicating whether the form is transparent (client only or the entire window).
37942>>>        Procedure SET FormExTransparent OLE_mbTransparent lpropVal
37943>>>                Send SetIntegerProperty 1745027079 lpropVal
37944>>>        End_Procedure
37945>>>
37945>>>// Returns/Sets a value indicating whether the controls are resized with the form.
37945>>>        Function FormExResizeControls Returns Bool
37946>>>                Local Bool lpropVal
37947>>>                Get GetBoolProperty 1745027078 to lpropVal
37948>>>                Function_Return lpropVal
37949>>>        End_Function
37950>>>
37950>>>// Returns/Sets a value indicating whether the controls are resized with the form.
37950>>>        Procedure SET FormExResizeControls Bool lpropVal
37951>>>                Send SetBoolProperty 1745027078 lpropVal
37952>>>        End_Procedure
37953>>>
37953>>>// Returns/Sets a value indicating whether the controls' fonts are resized with the form.
37953>>>        Function FormExResizeFonts Returns Bool
37954>>>                Local Bool lpropVal
37955>>>                Get GetBoolProperty 1745027077 to lpropVal
37956>>>                Function_Return lpropVal
37957>>>        End_Function
37958>>>
37958>>>// Returns/Sets a value indicating whether the controls' fonts are resized with the form.
37958>>>        Procedure SET FormExResizeFonts Bool lpropVal
37959>>>                Send SetBoolProperty 1745027077 lpropVal
37960>>>        End_Procedure
37961>>>
37961>>>// Returns/Sets a value indicating whether the form is flashing.
37961>>>        Function FormExFlashingCaption Returns Bool
37962>>>                Local Bool lpropVal
37963>>>                Get GetBoolProperty 1745027076 to lpropVal
37964>>>                Function_Return lpropVal
37965>>>        End_Function
37966>>>
37966>>>// Returns/Sets a value indicating whether the form is flashing.
37966>>>        Procedure SET FormExFlashingCaption Bool lpropVal
37967>>>                Send SetBoolProperty 1745027076 lpropVal
37968>>>        End_Procedure
37969>>>
37969>>>// Returns/Sets the flash interval.
37969>>>        Function FormExFlashInterval Returns DWORD
37970>>>                Local DWORD lpropVal
37971>>>                Get GetIntegerProperty 1745027075 to lpropVal
37972>>>                Function_Return lpropVal
37973>>>        End_Function
37974>>>
37974>>>// Returns/Sets the flash interval.
37974>>>        Procedure SET FormExFlashInterval DWORD lpropVal
37975>>>                Send SetIntegerProperty 1745027075 lpropVal
37976>>>        End_Procedure
37977>>>
37977>>>// Returns/Sets a value indicating whether the form is in fullscreen mode.
37977>>>        Function FormExFullScreen Returns Bool
37978>>>                Local Bool lpropVal
37979>>>                Get GetBoolProperty 1745027074 to lpropVal
37980>>>                Function_Return lpropVal
37981>>>        End_Function
37982>>>
37982>>>// Returns/Sets a value indicating whether the form is in fullscreen mode.
37982>>>        Procedure SET FormExFullScreen Bool lpropVal
37983>>>                Send SetBoolProperty 1745027074 lpropVal
37984>>>        End_Procedure
37985>>>
37985>>>// Returns/Sets a value indicating whether the form can be moved clicking on its client area.
37985>>>        Function FormExDraggable Returns Bool
37986>>>                Local Bool lpropVal
37987>>>                Get GetBoolProperty 1745027073 to lpropVal
37988>>>                Function_Return lpropVal
37989>>>        End_Function
37990>>>
37990>>>// Returns/Sets a value indicating whether the form can be moved clicking on its client area.
37990>>>        Procedure SET FormExDraggable Bool lpropVal
37991>>>                Send SetBoolProperty 1745027073 lpropVal
37992>>>        End_Procedure
37993>>>
37993>>>// Returns/Sets the picture to tile to create the wallpaper.
37993>>>        Function FormExPicture Returns LPDispatch
37994>>>                Local LPDispatch lpropVal
37995>>>                Get GetLPDispatchProperty 1745027072 to lpropVal
37996>>>                Function_Return lpropVal
37997>>>        End_Function
37998>>>
37998>>>// Returns/Sets the picture to tile to create the wallpaper.
37998>>>        Procedure SET FormExPicture LPDispatch lpropVal
37999>>>                Send SetLPDispatchProperty 1745027072 lpropVal
38000>>>        End_Procedure
38001>>>
38001>>>End_Class
38002>>>
38002>>>// CLSID:{2BF273CE-D8EB-11D3-8ED1-CFAA7A653C7F}
38002>>>// ProgId:
38002>>>Class OLE__FormEx is a Message
38003>>>
38003>>>// Occurs when a custom item of the system menu is clicked. The parameter specifies the ID of the item that is the value returned by the AddSysItem method.
38003>>>        Procedure OnFormExSysItemClick DWORD lID String lsItem
38004>>>        End_Procedure
38005>>>
38005>>>// Occurs when a menu item (system or not) is selected.
38005>>>        Procedure OnFormExItemSelect DWORD lID
38006>>>        End_Procedure
38007>>>
38007>>>// Occurs when one or more files are dropped over the form.
38007>>>        Procedure OnFormExDragDropFiles String lFilesArray
38008>>>        End_Procedure
38009>>>
38009>>>// Occurs when the form is moved.
38009>>>        Procedure OnFormExMove
38010>>>        End_Procedure
38011>>>
38011>>>// Occurs when the form is painted.
38011>>>        Procedure OnFormExPaint
38012>>>        End_Procedure
38013>>>
38013>>>// Occurs when the application is activated.
38013>>>        Procedure OnFormExActivateApp
38014>>>        End_Procedure
38015>>>
38015>>>// Occurs when the application is deactivated.
38015>>>        Procedure OnFormExDeactivateApp
38016>>>        End_Procedure
38017>>>
38017>>>// Occurs when the system memory is low.
38017>>>        Procedure OnFormExCompactingMemory
38018>>>        End_Procedure
38019>>>
38019>>>// Occurs when the display resolution is changed. The parameters specify the new size and the number of colors.
38019>>>        Procedure OnFormExDisplayChanged DWORD lWidth DWORD lHeight DWORD lNumColors
38020>>>        End_Procedure
38021>>>
38021>>>End_Class
38022>>>
38022>>>// CoClass CLSID:{2BF273CC-D8EB-11D3-8ED1-CFAA7A653C7F}
38022>>>// ProgId: MBFormEx.FormEx
38022>>>// Number of impl.Types:2
38022>>>// Referenced class _FormEx
38022>>>// Referenced class __FormEx
38022>>>Class OLEFormEx is a OCX_Client
38023>>>        Import_Class_Protocol OLE_FormEx
38024>>>        Import_Class_Protocol OLE__FormEx
38025>>>
38025>>>        Procedure Construct_Object
38026>>>                Forward Send Construct_Object
38028>>>                Send DefineOCX_Client
38029>>>                Set progIdStr to "MBFormEx.FormEx"
38030>>>                Set OCXLicense to ""
38031>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEFormEx"
38034>>>        End_Procedure
38035>>>
38035>>>        Procedure PreFormExSysItemClick Integer lParam
38036>>>                Local DWORD lID
38037>>>                Local String lsItem
38037>>>                Get GetEventIntegerParam lParam 0 to lID
38038>>>                Get GetEventStringParam lParam 1 to lsItem
38039>>>                Send OnFormExSysItemClick lID lsItem
38040>>>        End_Procedure
38041>>>
38041>>>        Procedure PreFormExItemSelect Integer lParam
38042>>>                Local DWORD lID
38043>>>                Get GetEventIntegerParam lParam 0 to lID
38044>>>                Send OnFormExItemSelect lID
38045>>>        End_Procedure
38046>>>
38046>>>        Procedure PreFormExDragDropFiles Integer lParam
38047>>>                Local String lFilesArray
38048>>>                Get GetEventIntegerParam lParam 0 to lFilesArray
38049>>>                Send OnFormExDragDropFiles lFilesArray
38050>>>        End_Procedure
38051>>>
38051>>>        Procedure PreFormExDisplayChanged Integer lParam
38052>>>                Local DWORD lWidth
38053>>>                Local DWORD lHeight
38053>>>                Local DWORD lNumColors
38053>>>                Get GetEventIntegerParam lParam 0 to lWidth
38054>>>                Get GetEventIntegerParam lParam 1 to lHeight
38055>>>                Get GetEventIntegerParam lParam 2 to lNumColors
38056>>>                Send OnFormExDisplayChanged lWidth lHeight lNumColors
38057>>>        End_Procedure
38058>>>
38058>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
38059>>>                ON_EVENT 1 Fire PreFormExSysItemClick
38062>>>                ON_EVENT 2 Fire PreFormExItemSelect
38065>>>                ON_EVENT 3 Fire PreFormExDragDropFiles
38068>>>                ON_EVENT 4 Fire OnFormExMove
38071>>>                ON_EVENT 5 Fire OnFormExPaint
38074>>>                ON_EVENT 6 Fire OnFormExActivateApp
38077>>>                ON_EVENT 7 Fire OnFormExDeactivateApp
38080>>>                ON_EVENT 8 Fire OnFormExCompactingMemory
38083>>>                ON_EVENT 9 Fire PreFormExDisplayChanged
38086>>>        End_Procedure
38087>>>End_Class
38088>>>
38088>>>// CoClass CLSID:{2BF273CC-D8EB-11D3-8ED1-CFAA7A653C7F}
38088>>>// ProgId: MBFormEx.FormEx
38088>>>// Number of impl.Types:2
38088>>>// Referenced class _FormEx
38088>>>// Referenced class __FormEx
38088>>>Class dbOLEFormEx is a dbOCX_Client
38089>>>        Import_Class_Protocol OLE_FormEx
38090>>>        Import_Class_Protocol OLE__FormEx
38091>>>
38091>>>        Procedure Construct_Object
38092>>>                Forward Send Construct_Object
38094>>>                Send DefineDbOCX_Client
38095>>>                Set progIdStr to "MBFormEx.FormEx"
38096>>>                Set OCXLicense to ""
38097>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEFormEx"
38100>>>        End_Procedure
38101>>>
38101>>>        Procedure PreFormExSysItemClick Integer lParam
38102>>>                Local DWORD lID
38103>>>                Local String lsItem
38103>>>                Get GetEventIntegerParam lParam 0 to lID
38104>>>                Get GetEventStringParam lParam 1 to lsItem
38105>>>                Send OnFormExSysItemClick lID lsItem
38106>>>        End_Procedure
38107>>>
38107>>>        Procedure PreFormExItemSelect Integer lParam
38108>>>                Local DWORD lID
38109>>>                Get GetEventIntegerParam lParam 0 to lID
38110>>>                Send OnFormExItemSelect lID
38111>>>        End_Procedure
38112>>>
38112>>>        Procedure PreFormExDragDropFiles Integer lParam
38113>>>                Local String lFilesArray
38114>>>                Get GetEventIntegerParam lParam 0 to lFilesArray
38115>>>                Send OnFormExDragDropFiles lFilesArray
38116>>>        End_Procedure
38117>>>
38117>>>        Procedure PreFormExDisplayChanged Integer lParam
38118>>>                Local DWORD lWidth
38119>>>                Local DWORD lHeight
38119>>>                Local DWORD lNumColors
38119>>>                Get GetEventIntegerParam lParam 0 to lWidth
38120>>>                Get GetEventIntegerParam lParam 1 to lHeight
38121>>>                Get GetEventIntegerParam lParam 2 to lNumColors
38122>>>                Send OnFormExDisplayChanged lWidth lHeight lNumColors
38123>>>        End_Procedure
38124>>>
38124>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
38125>>>                ON_EVENT 1 Fire PreFormExSysItemClick
38128>>>                ON_EVENT 2 Fire PreFormExItemSelect
38131>>>                ON_EVENT 3 Fire PreFormExDragDropFiles
38134>>>                ON_EVENT 4 Fire OnFormExMove
38137>>>                ON_EVENT 5 Fire OnFormExPaint
38140>>>                ON_EVENT 6 Fire OnFormExActivateApp
38143>>>                ON_EVENT 7 Fire OnFormExDeactivateApp
38146>>>                ON_EVENT 8 Fire OnFormExCompactingMemory
38149>>>                ON_EVENT 9 Fire PreFormExDisplayChanged
38152>>>        End_Procedure
38153>>>End_Class
38154>>>
38154>>>// CLSID:{2BF273D2-D8EB-11D3-8ED1-CFAA7A653C7F}
38154>>>// ProgId:
38154>>>Class OLE_General is a Automation_Client
38155>>>//ERROR - No Function Description
38155>>>//ERROR - Failed to retrieve Function Descriptions
38155>>>
38155>>>End_Class
38156>>>
38156>>>// CoClass CLSID:{2BF273D3-D8EB-11D3-8ED1-CFAA7A653C7F}
38156>>>// ProgId:
38156>>>// Number of impl.Types:1
38156>>>// Referenced class _General
38156>>>Class OLEGeneral is a Automation_Client
38157>>>        Import_Class_Protocol OLE_General
38158>>>
38158>>>        Procedure Construct_Object
38159>>>                Forward Send Construct_Object
38161>>>                Set progIdStr to "{2BF273D3-D8EB-11D3-8ED1-CFAA7A653C7F}"
38162>>>        End_Procedure
38163>>>End_Class
38164>Use mbMessage
INCLUDING FILE: MBMESSAGE.PKG
38164>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\MBMSGEX.OCX
38164>>>// Generated by FlexOLE Class Generator Friday, February 07, 2003 15:12:11
38164>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
38164>>>
38164>>>//Enum_List
38164>>>        Define OLEmbApplicationModal for 0 // mbApplicationModal
38164>>>        Define OLEmbSystemModal for 4096 // mbSystemModal
38164>>>//End_Enum_List
38164>>>
38164>>>//Enum_List
38164>>>        Define OLEmbNone for 0 // mbNone
38164>>>        Define OLEmbCritical for 16 // mbCritical
38164>>>        Define OLEmbQuestion for 32 // mbQuestion
38164>>>        Define OLEmbExclamation for 48 // mbExclamation
38164>>>        Define OLEmbInformation for 64 // mbInformation
38164>>>        Define OLEmbCustomIcon for 100 // mbCustomIcon
38164>>>//End_Enum_List
38164>>>
38164>>>//Enum_List
38164>>>        Define OLEmbCriticalSound for 16 // mbCriticalSound
38164>>>        Define OLEmbQuestionSound for 32 // mbQuestionSound
38164>>>        Define OLEmbExclamationSound for 48 // mbExclamationSound
38164>>>        Define OLEmbInformationSound for 64 // mbInformationSound
38164>>>//End_Enum_List
38164>>>
38164>>>//Enum_List
38164>>>        Define OLEmbAbortRetryIgnore for 2 // mbAbortRetryIgnore
38164>>>        Define OLEmbOKCancel for 1 // mbOKCancel
38164>>>        Define OLEmbOKOnly for 0 // mbOKOnly
38164>>>        Define OLEmbRetryCancel for 5 // mbRetryCancel
38164>>>        Define OLEmbYesNo for 4 // mbYesNo
38164>>>        Define OLEmbYesNoCancel for 3 // mbYesNoCancel
38164>>>        Define OLEmbOneCustomButton for 101 // mbOneCustomButton
38164>>>        Define OLEmbTwoCustomButtons for 102 // mbTwoCustomButtons
38164>>>        Define OLEmbThreeCustomButtons for 103 // mbThreeCustomButtons
38164>>>        Define OLEmbFourCustomButtons for 104 // mbFourCustomButtons
38164>>>//End_Enum_List
38164>>>
38164>>>//Enum_List
38164>>>        Define OLEmbDefaultButton1 for 0 // mbDefaultButton1
38164>>>        Define OLEmbDefaultButton2 for 256 // mbDefaultButton2
38164>>>        Define OLEmbDefaultButton3 for 512 // mbDefaultButton3
38164>>>        Define OLEmbDefaultButton4 for 768 // mbDefaultButton4
38164>>>//End_Enum_List
38164>>>
38164>>>//Enum_List
38164>>>        Define OLEmbAbort for 3 // mbAbort
38164>>>        Define OLEmbCancel for 2 // mbCancel
38164>>>        Define OLEmbIgnore for 5 // mbIgnore
38164>>>        Define OLEmbNo for 7 // mbNo
38164>>>        Define OLEmbOK for 1 // mbOK
38164>>>        Define OLEmbRetry for 4 // mbRetry
38164>>>        Define OLEmbYes for 6 // mbYes
38164>>>        Define OLEmbCustomButton1 for 6 // mbCustomButton1
38164>>>        Define OLEmbCustomButton2 for 7 // mbCustomButton2
38164>>>        Define OLEmbCustomButton3 for 2 // mbCustomButton3
38164>>>        Define OLEmbCustomButton4 for 1 // mbCustomButton4
38164>>>//End_Enum_List
38164>>>
38164>>>// CLSID:{572FF23F-2066-11D4-8ED4-00E07D815373}
38164>>>// ProgId: 
38164>>>Class OLE_MsgBoxEx is a Message
38165>>>
38165>>>// Returns/sets a value that determines whether the message box window is the foreground window.
38165>>>        Function MsgBoxExForeground Returns Bool
38166>>>                Local Bool lpropVal
38167>>>                Get GetBoolProperty 1073938433 to lpropVal
38168>>>                Function_Return lpropVal
38169>>>        End_Function
38170>>>
38170>>>// Returns/sets a value that determines whether the message box window is the foreground window.
38170>>>        Procedure SET MsgBoxExForeground Bool lpropVal
38171>>>                Send SetBoolProperty 1073938433 lpropVal
38172>>>        End_Procedure
38173>>>
38173>>>// Returns/sets the text displayed as the message in the dialog box.
38173>>>        Function MsgBoxExPrompt Returns String
38174>>>                Local String lpropVal
38175>>>                Get GetStringProperty 1073938434 to lpropVal
38176>>>                Function_Return lpropVal
38177>>>        End_Function
38178>>>
38178>>>// Returns/sets the text displayed as the message in the dialog box.
38178>>>        Procedure SET MsgBoxExPrompt String lpropVal
38179>>>                Send SetStringProperty 1073938434 lpropVal
38180>>>        End_Procedure
38181>>>
38181>>>// Returns/sets the title of the message box.
38181>>>        Function MsgBoxExTitle Returns String
38182>>>                Local String lpropVal
38183>>>                Get GetStringProperty 1073938435 to lpropVal
38184>>>                Function_Return lpropVal
38185>>>        End_Function
38186>>>
38186>>>// Returns/sets the title of the message box.
38186>>>        Procedure SET MsgBoxExTitle String lpropVal
38187>>>                Send SetStringProperty 1073938435 lpropVal
38188>>>        End_Procedure
38189>>>
38189>>>// Returns/sets the number and the type of buttons to display.
38189>>>        Function MsgBoxExButtons Returns OLE_mbButtonConstants
38190>>>                Local OLE_mbButtonConstants lpropVal
38191>>>                Get GetIntegerProperty 1073938436 to lpropVal
38192>>>                Function_Return lpropVal
38193>>>        End_Function
38194>>>
38194>>>// Returns/sets the number and the type of buttons to display.
38194>>>        Procedure SET MsgBoxExButtons OLE_mbButtonConstants lpropVal
38195>>>                Send SetIntegerProperty 1073938436 lpropVal
38196>>>        End_Procedure
38197>>>
38197>>>// Returns/sets a value that determines whether the message box is modal to the parent application or to the entire system.
38197>>>        Function MsgBoxExModal Returns OLE_mbModalConstants
38198>>>                Local OLE_mbModalConstants lpropVal
38199>>>                Get GetIntegerProperty 1073938437 to lpropVal
38200>>>                Function_Return lpropVal
38201>>>        End_Function
38202>>>
38202>>>// Returns/sets a value that determines whether the message box is modal to the parent application or to the entire system.
38202>>>        Procedure SET MsgBoxExModal OLE_mbModalConstants lpropVal
38203>>>                Send SetIntegerProperty 1073938437 lpropVal
38204>>>        End_Procedure
38205>>>
38205>>>// Returns/sets the  default button.
38205>>>        Function MsgBoxExDefaultButton Returns OLE_mbDefaultButtonConstants
38206>>>                Local OLE_mbDefaultButtonConstants lpropVal
38207>>>                Get GetIntegerProperty 1073938438 to lpropVal
38208>>>                Function_Return lpropVal
38209>>>        End_Function
38210>>>
38210>>>// Returns/sets the  default button.
38210>>>        Procedure SET MsgBoxExDefaultButton OLE_mbDefaultButtonConstants lpropVal
38211>>>                Send SetIntegerProperty 1073938438 lpropVal
38212>>>        End_Procedure
38213>>>
38213>>>// Returns/sets the context number assigned to the appropriate Help topic by the Help author. If context is provided, HelpFile must also be provided. The Help button is added automatically.
38213>>>        Function MsgBoxExHelpContextID Returns DWORD
38214>>>                Local DWORD lpropVal
38215>>>                Get GetIntegerProperty 1073938439 to lpropVal
38216>>>                Function_Return lpropVal
38217>>>        End_Function
38218>>>
38218>>>// Returns/sets the context number assigned to the appropriate Help topic by the Help author. If context is provided, HelpFile must also be provided. The Help button is added automatically.
38218>>>        Procedure SET MsgBoxExHelpContextID DWORD lpropVal
38219>>>                Send SetIntegerProperty 1073938439 lpropVal
38220>>>        End_Procedure
38221>>>
38221>>>// Returns/sets the Help file to use to provide context-sensitive Help for the dialog box. If HelpFile is provided, context must also be provided. The Help button is added automatically.
38221>>>        Function MsgBoxExHelpFile Returns String
38222>>>                Local String lpropVal
38223>>>                Get GetStringProperty 1073938440 to lpropVal
38224>>>                Function_Return lpropVal
38225>>>        End_Function
38226>>>
38226>>>// Returns/sets the Help file to use to provide context-sensitive Help for the dialog box. If HelpFile is provided, context must also be provided. The Help button is added automatically.
38226>>>        Procedure SET MsgBoxExHelpFile String lpropVal
38227>>>                Send SetStringProperty 1073938440 lpropVal
38228>>>        End_Procedure
38229>>>
38229>>>// Returns/sets the type of icon to display on the left of the dialog.
38229>>>        Function MsgBoxExIcon Returns OLE_mbIconConstants
38230>>>                Local OLE_mbIconConstants lpropVal
38231>>>                Get GetIntegerProperty 1073938441 to lpropVal
38232>>>                Function_Return lpropVal
38233>>>        End_Function
38234>>>
38234>>>// Returns/sets the type of icon to display on the left of the dialog.
38234>>>        Procedure SET MsgBoxExIcon OLE_mbIconConstants lpropVal
38235>>>                Send SetIntegerProperty 1073938441 lpropVal
38236>>>        End_Procedure
38237>>>
38237>>>// Returns/sets the sound to use if the Icon property is mbCustomIcon.
38237>>>        Function MsgBoxExCustomIconSound Returns OLE_mbIconSoundConstants
38238>>>                Local OLE_mbIconSoundConstants lpropVal
38239>>>                Get GetIntegerProperty 1073938442 to lpropVal
38240>>>                Function_Return lpropVal
38241>>>        End_Function
38242>>>
38242>>>// Returns/sets the sound to use if the Icon property is mbCustomIcon.
38242>>>        Procedure SET MsgBoxExCustomIconSound OLE_mbIconSoundConstants lpropVal
38243>>>                Send SetIntegerProperty 1073938442 lpropVal
38244>>>        End_Procedure
38245>>>
38245>>>// Returns/sets a value indicating whether the text is aligned to the right.
38245>>>        Function MsgBoxExRightAligned Returns Bool
38246>>>                Local Bool lpropVal
38247>>>                Get GetBoolProperty 1073938443 to lpropVal
38248>>>                Function_Return lpropVal
38249>>>        End_Function
38250>>>
38250>>>// Returns/sets a value indicating whether the text is aligned to the right.
38250>>>        Procedure SET MsgBoxExRightAligned Bool lpropVal
38251>>>                Send SetBoolProperty 1073938443 lpropVal
38252>>>        End_Procedure
38253>>>
38253>>>// Returns or sets a value specifying the position of the message box when it first appears.
38253>>>        Function MsgBoxExPosition Returns DWORD //OLE_StartUpPositionConstants
38254>>>                Local DWORD lpropVal
38255>>>//              Local OLE_StartUpPositionConstants lpropVal
38255>>>                Get GetIntegerProperty 1073938444 to lpropVal
38256>>>                Function_Return lpropVal
38257>>>        End_Function
38258>>>
38258>>>// Returns or sets a value specifying the position of the message box when it first appears.
38258>>>        Procedure SET MsgBoxExPosition DWORD lpropVal//OLE_StartUpPositionConstants lpropVal
38259>>>                Send SetIntegerProperty 1073938444 lpropVal
38260>>>        End_Procedure
38261>>>
38261>>>// Returns/sets the pixel coordinate of the dialog box's top edge, relative to the entire screen. Evaluated only if Position is set to vbStartUpManual.
38261>>>        Function MsgBoxExTopDialogPos Returns DWORD
38262>>>                Local DWORD lpropVal
38263>>>                Get GetIntegerProperty 1073938445 to lpropVal
38264>>>                Function_Return lpropVal
38265>>>        End_Function
38266>>>
38266>>>// Returns/sets the pixel coordinate of the dialog box's top edge, relative to the entire screen. Evaluated only if Position is set to vbStartUpManual.
38266>>>        Procedure SET MsgBoxExTopDialogPos DWORD lpropVal
38267>>>                Send SetIntegerProperty 1073938445 lpropVal
38268>>>        End_Procedure
38269>>>
38269>>>// Returns/sets the pixel coordinate of the dialog box's left edge, relative to the entire screen. Evaluated only if Position is set to vbStartUpManual.
38269>>>        Function MsgBoxExLeftDialogPos Returns DWORD
38270>>>                Local DWORD lpropVal
38271>>>                Get GetIntegerProperty 1073938446 to lpropVal
38272>>>                Function_Return lpropVal
38273>>>        End_Function
38274>>>
38274>>>// Returns/sets the pixel coordinate of the dialog box's left edge, relative to the entire screen. Evaluated only if Position is set to vbStartUpManual.
38274>>>        Procedure SET MsgBoxExLeftDialogPos DWORD lpropVal
38275>>>                Send SetIntegerProperty 1073938446 lpropVal
38276>>>        End_Procedure
38277>>>
38277>>>// Returns/sets the icon to use if the Icon property is mbCustomIcon.
38277>>>        Function MsgBoxExCustomIcon Returns LPDispatch
38278>>>                Local LPDispatch lpropVal
38279>>>                Get GetLPDispatchProperty 1073938447 to lpropVal
38280>>>                Function_Return lpropVal
38281>>>        End_Function
38282>>>
38282>>>// Returns/sets the icon to use if the Icon property is mbCustomIcon.
38282>>>        Procedure SET MsgBoxExCustomIcon LPDispatch lpropVal
38283>>>                Send SetLPDispatchProperty 1073938447 lpropVal
38284>>>        End_Procedure
38285>>>
38285>>>// Returns/sets the caption of the first custom button.
38285>>>        Function MsgBoxExButton1Caption Returns String
38286>>>                Local String lpropVal
38287>>>                Get GetStringProperty 1073938448 to lpropVal
38288>>>                Function_Return lpropVal
38289>>>        End_Function
38290>>>
38290>>>// Returns/sets the caption of the first custom button.
38290>>>        Procedure SET MsgBoxExButton1Caption String lpropVal
38291>>>                Send SetStringProperty 1073938448 lpropVal
38292>>>        End_Procedure
38293>>>
38293>>>// Returns/sets the caption of the second custom button.
38293>>>        Function MsgBoxExButton2Caption Returns String
38294>>>                Local String lpropVal
38295>>>                Get GetStringProperty 1073938449 to lpropVal
38296>>>                Function_Return lpropVal
38297>>>        End_Function
38298>>>
38298>>>// Returns/sets the caption of the second custom button.
38298>>>        Procedure SET MsgBoxExButton2Caption String lpropVal
38299>>>                Send SetStringProperty 1073938449 lpropVal
38300>>>        End_Procedure
38301>>>
38301>>>// Returns/sets the caption of the third custom button.
38301>>>        Function MsgBoxExButton3Caption Returns String
38302>>>                Local String lpropVal
38303>>>                Get GetStringProperty 1073938450 to lpropVal
38304>>>                Function_Return lpropVal
38305>>>        End_Function
38306>>>
38306>>>// Returns/sets the caption of the third custom button.
38306>>>        Procedure SET MsgBoxExButton3Caption String lpropVal
38307>>>                Send SetStringProperty 1073938450 lpropVal
38308>>>        End_Procedure
38309>>>
38309>>>// Returns/sets the caption of the fourth custom button.
38309>>>        Function MsgBoxExButton4Caption Returns String
38310>>>                Local String lpropVal
38311>>>                Get GetStringProperty 1073938451 to lpropVal
38312>>>                Function_Return lpropVal
38313>>>        End_Function
38314>>>
38314>>>// Returns/sets the caption of the fourth custom button.
38314>>>        Procedure SET MsgBoxExButton4Caption String lpropVal
38315>>>                Send SetStringProperty 1073938451 lpropVal
38316>>>        End_Procedure
38317>>>
38317>>>// Returns the result of the message box.
38317>>>        Function MsgBoxExResult Returns OLE_mbResultConstants
38318>>>                Local OLE_mbResultConstants lpropVal
38319>>>                Get GetIntegerProperty 0 to lpropVal
38320>>>                Function_Return lpropVal
38321>>>        End_Function
38322>>>
38322>>>// Opens the AboutBox dialog.
38322>>>        Procedure MsgBoxExAbout
38323>>>                Send InvokeVoidFunction -552
38324>>>        End_Procedure 
38325>>>
38325>>>// Opens the message box.
38325>>>        Function MsgBoxExShow Returns OLE_mbResultConstants
38326>>>                Local OLE_mbResultConstants lretVal
38327>>>                Get InvokeIntegerFunction 1610809344 to lretVal
38328>>>                Function_Return lretVal
38329>>>        End_Function 
38330>>>
38330>>>End_Class
38331>>>
38331>>>// CLSID:{572FF241-2066-11D4-8ED4-00E07D815373}
38331>>>// ProgId: 
38331>>>Class OLE__MsgBoxEx is a Message
38332>>>
38332>>>End_Class
38333>>>
38333>>>// CoClass CLSID:{572FF240-2066-11D4-8ED4-00E07D815373}
38333>>>// ProgId: MBMsgBoxEx.MsgBoxEx
38333>>>// Number of impl.Types:2
38333>>>// Referenced class _MsgBoxEx
38333>>>// Referenced class __MsgBoxEx
38333>>>Class OLEMsgBoxEx is a OCX_Client
38334>>>        Import_Class_Protocol OLE_MsgBoxEx
38335>>>        Import_Class_Protocol OLE__MsgBoxEx
38336>>>
38336>>>        Procedure Construct_Object
38337>>>                Forward Send Construct_Object
38339>>>                Send DefineOCX_Client
38340>>>                Set progIdStr to "MBMsgBoxEx.MsgBoxEx"
38341>>>                Set OCXLicense to ""
38342>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEMsgBoxEx"
38345>>>        End_Procedure
38346>>>
38346>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
38347>>>        End_Procedure
38348>>>End_Class
38349>>>
38349>>>// CoClass CLSID:{572FF240-2066-11D4-8ED4-00E07D815373}
38349>>>// ProgId: MBMsgBoxEx.MsgBoxEx
38349>>>// Number of impl.Types:2
38349>>>// Referenced class _MsgBoxEx
38349>>>// Referenced class __MsgBoxEx
38349>>>Class dbOLEMsgBoxEx is a dbOCX_Client
38350>>>        Import_Class_Protocol OLE_MsgBoxEx
38351>>>        Import_Class_Protocol OLE__MsgBoxEx
38352>>>
38352>>>        Procedure Construct_Object
38353>>>                Forward Send Construct_Object
38355>>>                Send DefineDbOCX_Client
38356>>>                Set progIdStr to "MBMsgBoxEx.MsgBoxEx"
38357>>>                Set OCXLicense to ""
38358>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEMsgBoxEx"
38361>>>        End_Procedure
38362>>>
38362>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
38363>>>        End_Procedure
38364>>>End_Class
38365>>>
38365>>>// CLSID:{572FF237-2066-11D4-8ED4-00E07D815373}
38365>>>// ProgId: 
38365>>>Class OLE_CMsgBoxEx is a Automation_Client
38366>>>
38366>>>// Returns/sets a value that determines whether the message box window is the foreground window.
38366>>>        Function CMsgBoxExForeground Returns Bool
38367>>>                Local Bool lpropVal
38368>>>                Get GetBoolProperty 1073938432 to lpropVal
38369>>>                Function_Return lpropVal
38370>>>        End_Function
38371>>>
38371>>>// Returns/sets a value that determines whether the message box window is the foreground window.
38371>>>        Procedure SET CMsgBoxExForeground Bool lpropVal
38372>>>                Send SetBoolProperty 1073938432 lpropVal
38373>>>        End_Procedure
38374>>>
38374>>>// Returns/sets the text displayed as the message in the dialog box.
38374>>>        Function CMsgBoxExPrompt Returns String
38375>>>                Local String lpropVal
38376>>>                Get GetStringProperty 1073938433 to lpropVal
38377>>>                Function_Return lpropVal
38378>>>        End_Function
38379>>>
38379>>>// Returns/sets the text displayed as the message in the dialog box.
38379>>>        Procedure SET CMsgBoxExPrompt String lpropVal
38380>>>                Send SetStringProperty 1073938433 lpropVal
38381>>>        End_Procedure
38382>>>
38382>>>// Returns/sets the title of the message box.
38382>>>        Function CMsgBoxExTitle Returns String
38383>>>                Local String lpropVal
38384>>>                Get GetStringProperty 1073938434 to lpropVal
38385>>>                Function_Return lpropVal
38386>>>        End_Function
38387>>>
38387>>>// Returns/sets the title of the message box.
38387>>>        Procedure SET CMsgBoxExTitle String lpropVal
38388>>>                Send SetStringProperty 1073938434 lpropVal
38389>>>        End_Procedure
38390>>>
38390>>>// Returns/sets the number and the type of buttons to display.
38390>>>        Function CMsgBoxExButtons Returns OLE_mbButtonConstants
38391>>>                Local OLE_mbButtonConstants lpropVal
38392>>>                Get GetIntegerProperty 1073938435 to lpropVal
38393>>>                Function_Return lpropVal
38394>>>        End_Function
38395>>>
38395>>>// Returns/sets the number and the type of buttons to display.
38395>>>        Procedure SET CMsgBoxExButtons OLE_mbButtonConstants lpropVal
38396>>>                Send SetIntegerProperty 1073938435 lpropVal
38397>>>        End_Procedure
38398>>>
38398>>>// Returns/sets a value that determines whether the message box is modal to the parent application or to the entire system.
38398>>>        Function CMsgBoxExModal Returns OLE_mbModalConstants
38399>>>                Local OLE_mbModalConstants lpropVal
38400>>>                Get GetIntegerProperty 1073938436 to lpropVal
38401>>>                Function_Return lpropVal
38402>>>        End_Function
38403>>>
38403>>>// Returns/sets a value that determines whether the message box is modal to the parent application or to the entire system.
38403>>>        Procedure SET CMsgBoxExModal OLE_mbModalConstants lpropVal
38404>>>                Send SetIntegerProperty 1073938436 lpropVal
38405>>>        End_Procedure
38406>>>
38406>>>// Returns/sets the  default button.
38406>>>        Function CMsgBoxExDefaultButton Returns OLE_mbDefaultButtonConstants
38407>>>                Local OLE_mbDefaultButtonConstants lpropVal
38408>>>                Get GetIntegerProperty 1073938437 to lpropVal
38409>>>                Function_Return lpropVal
38410>>>        End_Function
38411>>>
38411>>>// Returns/sets the  default button.
38411>>>        Procedure SET CMsgBoxExDefaultButton OLE_mbDefaultButtonConstants lpropVal
38412>>>                Send SetIntegerProperty 1073938437 lpropVal
38413>>>        End_Procedure
38414>>>
38414>>>// Returns/sets the context number assigned to the appropriate Help topic by the Help author. If context is provided, HelpFile must also be provided. The Help button is added automatically.
38414>>>        Function CMsgBoxExHelpContextID Returns DWORD
38415>>>                Local DWORD lpropVal
38416>>>                Get GetIntegerProperty 1073938438 to lpropVal
38417>>>                Function_Return lpropVal
38418>>>        End_Function
38419>>>
38419>>>// Returns/sets the context number assigned to the appropriate Help topic by the Help author. If context is provided, HelpFile must also be provided. The Help button is added automatically.
38419>>>        Procedure SET CMsgBoxExHelpContextID DWORD lpropVal
38420>>>                Send SetIntegerProperty 1073938438 lpropVal
38421>>>        End_Procedure
38422>>>
38422>>>// Returns/sets the Help file to use to provide context-sensitive Help for the dialog box. If HelpFile is provided, context must also be provided. The Help button is added automatically.
38422>>>        Function CMsgBoxExHelpFile Returns String
38423>>>                Local String lpropVal
38424>>>                Get GetStringProperty 1073938439 to lpropVal
38425>>>                Function_Return lpropVal
38426>>>        End_Function
38427>>>
38427>>>// Returns/sets the Help file to use to provide context-sensitive Help for the dialog box. If HelpFile is provided, context must also be provided. The Help button is added automatically.
38427>>>        Procedure SET CMsgBoxExHelpFile String lpropVal
38428>>>                Send SetStringProperty 1073938439 lpropVal
38429>>>        End_Procedure
38430>>>
38430>>>// Returns/sets the type of icon to display on the left of the dialog.
38430>>>        Function CMsgBoxExIcon Returns OLE_mbIconConstants
38431>>>                Local OLE_mbIconConstants lpropVal
38432>>>                Get GetIntegerProperty 1073938440 to lpropVal
38433>>>                Function_Return lpropVal
38434>>>        End_Function
38435>>>
38435>>>// Returns/sets the type of icon to display on the left of the dialog.
38435>>>        Procedure SET CMsgBoxExIcon OLE_mbIconConstants lpropVal
38436>>>                Send SetIntegerProperty 1073938440 lpropVal
38437>>>        End_Procedure
38438>>>
38438>>>// Returns/sets the sound to use if the Icon property is mbCustomIcon.
38438>>>        Function CMsgBoxExCustomIconSound Returns OLE_mbIconSoundConstants
38439>>>                Local OLE_mbIconSoundConstants lpropVal
38440>>>                Get GetIntegerProperty 1073938441 to lpropVal
38441>>>                Function_Return lpropVal
38442>>>        End_Function
38443>>>
38443>>>// Returns/sets the sound to use if the Icon property is mbCustomIcon.
38443>>>        Procedure SET CMsgBoxExCustomIconSound OLE_mbIconSoundConstants lpropVal
38444>>>                Send SetIntegerProperty 1073938441 lpropVal
38445>>>        End_Procedure
38446>>>
38446>>>// Returns/sets a value indicating whether the text is aligned to the right.
38446>>>        Function CMsgBoxExRightAligned Returns Bool
38447>>>                Local Bool lpropVal
38448>>>                Get GetBoolProperty 1073938442 to lpropVal
38449>>>                Function_Return lpropVal
38450>>>        End_Function
38451>>>
38451>>>// Returns/sets a value indicating whether the text is aligned to the right.
38451>>>        Procedure SET CMsgBoxExRightAligned Bool lpropVal
38452>>>                Send SetBoolProperty 1073938442 lpropVal
38453>>>        End_Procedure
38454>>>
38454>>>// Returns or sets a value specifying the position of the message box when it first appears.
38454>>>        Function CMsgBoxExPosition Returns DWORD //OLE_StartUpPositionConstants
38455>>>                Local DWORD lpropVal //OLE_StartUpPositionConstants lpropVal
38456>>>                Get GetIntegerProperty 1073938443 to lpropVal
38457>>>                Function_Return lpropVal
38458>>>        End_Function
38459>>>
38459>>>// Returns or sets a value specifying the position of the message box when it first appears.
38459>>>        Procedure SET CMsgBoxExPosition DWORD lpropVal //OLE_StartUpPositionConstants lpropVal
38460>>>                Send SetIntegerProperty 1073938443 lpropVal
38461>>>        End_Procedure
38462>>>
38462>>>// Returns/sets the pixel coordinate of the dialog box's top edge, relative to the entire screen. Evaluated only if Position is set to vbStartUpManual.
38462>>>        Function CMsgBoxExTopDialogPos Returns DWORD
38463>>>                Local DWORD lpropVal
38464>>>                Get GetIntegerProperty 1073938444 to lpropVal
38465>>>                Function_Return lpropVal
38466>>>        End_Function
38467>>>
38467>>>// Returns/sets the pixel coordinate of the dialog box's top edge, relative to the entire screen. Evaluated only if Position is set to vbStartUpManual.
38467>>>        Procedure SET CMsgBoxExTopDialogPos DWORD lpropVal
38468>>>                Send SetIntegerProperty 1073938444 lpropVal
38469>>>        End_Procedure
38470>>>
38470>>>// Returns/sets the pixel coordinate of the dialog box's left edge, relative to the entire screen. Evaluated only if Position is set to vbStartUpManual.
38470>>>        Function CMsgBoxExLeftDialogPos Returns DWORD
38471>>>                Local DWORD lpropVal
38472>>>                Get GetIntegerProperty 1073938445 to lpropVal
38473>>>                Function_Return lpropVal
38474>>>        End_Function
38475>>>
38475>>>// Returns/sets the pixel coordinate of the dialog box's left edge, relative to the entire screen. Evaluated only if Position is set to vbStartUpManual.
38475>>>        Procedure SET CMsgBoxExLeftDialogPos DWORD lpropVal
38476>>>                Send SetIntegerProperty 1073938445 lpropVal
38477>>>        End_Procedure
38478>>>
38478>>>// Returns/sets the icon to use if the Icon property is mbCustomIcon.
38478>>>        Function CMsgBoxExCustomIcon Returns LPDispatch
38479>>>                Local LPDispatch lpropVal
38480>>>                Get GetLPDispatchProperty 1073938446 to lpropVal
38481>>>                Function_Return lpropVal
38482>>>        End_Function
38483>>>
38483>>>// Returns/sets the icon to use if the Icon property is mbCustomIcon.
38483>>>        Procedure SET CMsgBoxExCustomIcon LPDispatch lpropVal
38484>>>                Send SetLPDispatchProperty 1073938446 lpropVal
38485>>>        End_Procedure
38486>>>
38486>>>// Returns/sets the caption of the first custom button.
38486>>>        Function CMsgBoxExButton1Caption Returns String
38487>>>                Local String lpropVal
38488>>>                Get GetStringProperty 1073938447 to lpropVal
38489>>>                Function_Return lpropVal
38490>>>        End_Function
38491>>>
38491>>>// Returns/sets the caption of the first custom button.
38491>>>        Procedure SET CMsgBoxExButton1Caption String lpropVal
38492>>>                Send SetStringProperty 1073938447 lpropVal
38493>>>        End_Procedure
38494>>>
38494>>>// Returns/sets the caption of the second custom button.
38494>>>        Function CMsgBoxExButton2Caption Returns String
38495>>>                Local String lpropVal
38496>>>                Get GetStringProperty 1073938448 to lpropVal
38497>>>                Function_Return lpropVal
38498>>>        End_Function
38499>>>
38499>>>// Returns/sets the caption of the second custom button.
38499>>>        Procedure SET CMsgBoxExButton2Caption String lpropVal
38500>>>                Send SetStringProperty 1073938448 lpropVal
38501>>>        End_Procedure
38502>>>
38502>>>// Returns/sets the caption of the third custom button.
38502>>>        Function CMsgBoxExButton3Caption Returns String
38503>>>                Local String lpropVal
38504>>>                Get GetStringProperty 1073938449 to lpropVal
38505>>>                Function_Return lpropVal
38506>>>        End_Function
38507>>>
38507>>>// Returns/sets the caption of the third custom button.
38507>>>        Procedure SET CMsgBoxExButton3Caption String lpropVal
38508>>>                Send SetStringProperty 1073938449 lpropVal
38509>>>        End_Procedure
38510>>>
38510>>>// Returns/sets the caption of the fourth custom button.
38510>>>        Function CMsgBoxExButton4Caption Returns String
38511>>>                Local String lpropVal
38512>>>                Get GetStringProperty 1073938450 to lpropVal
38513>>>                Function_Return lpropVal
38514>>>        End_Function
38515>>>
38515>>>// Returns/sets the caption of the fourth custom button.
38515>>>        Procedure SET CMsgBoxExButton4Caption String lpropVal
38516>>>                Send SetStringProperty 1073938450 lpropVal
38517>>>        End_Procedure
38518>>>
38518>>>// Returns the result of the message box.
38518>>>        Function CMsgBoxExResult Returns OLE_mbResultConstants
38519>>>                Local OLE_mbResultConstants lpropVal
38520>>>                Get GetIntegerProperty 0 to lpropVal
38521>>>                Function_Return lpropVal
38522>>>        End_Function
38523>>>
38523>>>// Opens the AboutBox dialog.
38523>>>        Procedure CMsgBoxExAbout
38524>>>                Send InvokeVoidFunction -552
38525>>>        End_Procedure 
38526>>>
38526>>>// Opens the message box.
38526>>>        Function CMsgBoxExShow Returns OLE_mbResultConstants
38527>>>                Local OLE_mbResultConstants lretVal
38528>>>                Get InvokeIntegerFunction 1610809344 to lretVal
38529>>>                Function_Return lretVal
38530>>>        End_Function 
38531>>>
38531>>>End_Class
38532>>>
38532>>>// CoClass CLSID:{572FF238-2066-11D4-8ED4-00E07D815373}
38532>>>// ProgId: MBMsgBoxEx.CMsgBoxEx
38532>>>// Number of impl.Types:1
38532>>>// Referenced class _CMsgBoxEx
38532>>>Class OLECMsgBoxEx is a Automation_Client
38533>>>        Import_Class_Protocol OLE_CMsgBoxEx
38534>>>
38534>>>        Procedure Construct_Object
38535>>>                Forward Send Construct_Object
38537>>>                Set progIdStr to "MBMsgBoxEx.CMsgBoxEx"
38538>>>        End_Procedure
38539>>>End_Class
38540>Use Wait.Dg
38540>
INCLUDING FILE: FEM.PKG
38540>>///////////////////////////////////////////////
38540>>// Ginetai #Include sto Program //
38540>>///////////////////////////////////////////////
38540>>
38540>>Integer igC
38540>>String  sgC sgFull sgRootDir sgDevicePath
38540>>Move 0 to igC
38541>>
38541>>Move (fsReadRegistryFHMRootDir   ()) To sgRootDir
ERROR: 54 Invalid symbol in expression FSREADREGISTRYFHMROOTDIR ON LINE: 9 (38541) OF FILE: C:\Vdf6\Develop\Empor\AppSrc\FEM.PKG
38542>>Move (fsReadRegistryFHMDevicePath()) To sgDevicePath
ERROR: 54 Invalid symbol in expression FSREADREGISTRYFHMDEVICEPATH ON LINE: 10 (38542) OF FILE: C:\Vdf6\Develop\Empor\AppSrc\FEM.PKG
38543>>
38543>>If (Trim(sgRootDir)='' Or Trim(sgDevicePath)='') Begin
38545>>    Send Stop_Box 'ƒœ¤ ™¨âŸž¡˜¤ ¦  2 §˜¨á£œ«¨¦  ©«¦ Registry' '‘­á¢£˜ 1002'
38546>>    Abort
38547>>>
38547>>End
38547>>>
38547>>
38547>>// ** START ** Function ths forologikhs ektypotikhs mhxanhs
38547>>External_Function32 FSL_Command "FSL_Command" rapidsign.dll;                    String  sBaseDir    ;                    String  sCommand    ;                    String  sDevFile    ;                    String  sParam1     ;                    String  sParam2     ;                    Returns Integer
38548>>
38548>>External_Function32 FSL_SignDocument "FSL_SignDocument" rapidsign.dll;                    String  sDevFile    ;                    String  sParam      ;                    String  sResult     ;                    Returns Integer
38549>>// ** END ** Function ths forologikhs ektypotikhs mhxanhs
38549>>
38549>>
38549>>// ** START ** Gemisma global string me escape xarakthron gia afairesh tous apo to ascii ths forologikhs
38549>>Move '' to sgC
38550>>For igC From 1 to 254
38556>>>
38556>>    If ((igC<32) Or ((igC>175) And (igC<224)) Or (igC>240)) Begin
38558>>        Move (Append(sgC,Character(igC))) to sgC
38559>>    End
38559>>>
38559>>Loop
38560>>>
38560>>// ** END ** Gemisma escape xarakthron gia afairesh tous apo to ascii ths forologikhs
38560>>
38560>>
38560>>Function fiEtoimaseTaAscii Returns Integer
38561>>    Integer iFileExist iii iii2 isOK
38562>>    String  sLine sLine2 sLetter sLetter2
38562>>    // 1. Check if file was outputed (C:\##Parast.txt)
38562>>    Get Get_File_Exists 'C:\##Parast.txt' to iFileExist
38563>>    If (Not(iFileExist)) Function_Return 12556
38566>>
38566>>    // 2. Check if file is outputed but empty
38566>>    Direct_Input Channel 7 "C:\##Parast.txt"
38568>>    If (Seqeof) Begin
38570>>        Close_Input Channel 7
38572>>        Function_Return 12557
38573>>    End
38573>>>
38573>>
38573>>    // 3. Strip file from escape sequences
38573>>    Direct_Output Channel 9 "C:\##Parast0.txt"
38575>>    Repeat
38575>>>
38575>>        Readln Channel 7 sLine
38577>>        For iii From 1 to (Length(sgC))
38583>>>
38583>>            Move (Replaces((Mid(sgC,1,iii)),sLine,' ')) to sLine
38584>>        Loop
38585>>>
38585>>        Writeln Channel 9 sLine
38588>>    Until (Seqeof)
38590>>    Close_Input Channel 7
38592>>    Close_Output Channel 9
38594>>
38594>>    // 4. Check if new ascii without escape
38594>>    //    sequences is outputed (C:\##Parast0.txt)
38594>>    Get Get_File_Exists 'C:\##Parast0.txt' to iFileExist
38595>>    If (Not(iFileExist)) Function_Return 12558
38598>>
38598>>    // 5. Check if new file is outputed but empty
38598>>    Direct_Input Channel 7 "C:\##Parast0.txt"
38600>>    If (Seqeof) Begin
38602>>        Close_Input Channel 7
38604>>        Function_Return 12559
38605>>    End
38605>>>
38605>>
38605>>    // 6. Convert file to ELOT
38605>>    Direct_Output Channel 9 "C:\##Parast1.txt"
38607>>    Repeat
38607>>>
38607>>        Readln Channel 7        sLine
38609>>        Move (ToAnsi(sLine)) to sLine2
38610>>        Writeln Channel 9       sLine2
38613>>    Until (Seqeof)
38615>>    Close_Input  Channel 7
38617>>    Close_Output Channel 9
38619>>
38619>>    // 7. Check if converted ELOT ascii is outputed (C:\##Parast1.txt)
38619>>    Get Get_File_Exists 'C:\##Parast1.txt' to iFileExist
38620>>    If (Not(iFileExist)) Function_Return 12560
38623>>
38623>>    // 8. Check if converted ELOT ascii is NOT Empty
38623>>    Direct_Input Channel 7 "C:\##Parast1.txt"
38625>>    If (Seqeof) Begin
38627>>        Close_Output Channel 7
38629>>        Function_Return 12561
38630>>    End
38630>>>
38630>>    Close_Output Channel 7
38632>>
38632>>    Function_Return 1 // Everything OK
38633>>End_function
38634>>
38634>>Function fiPareYpografh Returns String
38635>>    Integer iFileExist iii iii2 isOK
38636>>    String  sLine sLine2 sLetter sLetter2
38636>>    Move 0 to isOK
38637>>
38637>>    Move (FSL_Command(sgRootDir,'SIGN',sgDevicePath ,'C:\##Parast1.txt','C:\##Signature.txt')) to isOK
38638>>    If (isOK<>0) Function_Return ''
38641>>
38641>>    Direct_Input Channel 7 'C:\##Signature.txt'
38643>>    If (Seqeof) Function_Return '12562'
38646>>    Readln Channel 7 sLine
38648>>    Move (Trim(sLine)) to sLine
38649>>    If (Length(sLine)<>77) Function_Return '12563'
38652>>
38652>>    EraseFile "C:\##Parast*.txt"
38653>>>
38653>>    EraseFile "C:\##Signature.txt"
38654>>>
38654>>
38654>>    Function_return (Trim(sLine))
38655>>End_function
38656>>
38656>>Function fiVgaleZ Returns Integer
38657>>    Integer isOK
38658>>    Move 0 to isOK
38659>>    Move (FSL_Command(sgRootDir,'Z',sgDevicePath ,'','')) to isOK
38660>>    Function_return isOK
38661>>    // 0= ok
38661>>End_function
38662>>
38662>>Function fiShowCTL Returns Integer
38663>>    Integer isOK
38664>>    Move 0 to isOK
38665>>    Move (FSL_Command(sgRootDir,'CTL',sgDevicePath ,'','')) to isOK
38666>>    Function_return isOK
38667>>    // 0= ok
38667>>End_function
38668>>
38668>>Use RptVwFem.Sub
INCLUDING FILE: RPTVWFEM.SUB
38668>>>>Use DFRptvw.pkg
38668>>>>Use dbRptvw.pkg
38668>>>>
38668>>>>Use RptVW.Sub
38668>>>>
38668>>>>Class ReportViewFEMSub is a ReportViewSub    
38669>>>>
38669>>>>    Procedure Construct_Object
38670>>>>        Forward Send Construct_Object
38672>>>>
38672>>>>        Property Integer    piIsReportCancelled     Public  0
38673>>>>        Property Integer    piAsciiOrPrinter        Public  0
38674>>>>    
38674>>>>    End_Procedure
38675>>>>    
38675>>>>
38675>>>>// ‡˜ â§¨œ§œ ž procedure ˜¬«ž
38675>>>>//
38675>>>>//    Procedure StartReport
38675>>>>//        send Gemise_Escape_Characters
38675>>>>//        String Whme_APO sRecr
38675>>>>//        integer wnees wclose
38675>>>>//        Local Integer iOutputDevice
38675>>>>//        Local String  FileName
38675>>>>//        local integer inew_state
38675>>>>//        Get Output_Device_Mode To iOutputDevice
38675>>>>//        get new_state to inew_state
38675>>>>//        set piprinter to 0
38675>>>>//        //?????????????????????????????????????????????
38675>>>>//        Get Output_Device_Mode To iOutputDevice
38675>>>>
38675>>>>//        If iOutputDevice EQ PRINT_TO_WINDOW Begin
38675>>>>//            Set piAsciiOrPrinter    to 0
38675>>>>//            Make_Temp_File "TXT" FileName
38675>>>>//            Move (".\" - FileName)  To FileName
38675>>>>//            Set Output_Device_Name  To FileName
38675>>>>//        End
38675>>>>//        Else Begin
38675>>>>
38675>>>>//            If (Sysfile.Use_Sql_Reports='1') Begin
38675>>>>//                If (piAsciiOrPrinter(Self)=0) Error 7000 'ƒœ¤ ©œ«á¨˜«œ «¦ piAsciiOrPrinter\n(ƒœ¤ §¨¦©› ¦¨å©«ž¡œ ˜¤ ˜­¦¨á ASCII ã „¡«¬§à«ã)'
38675>>>>//            End
38675>>>>
38675>>>>//            Get psRecr Of TIMOLOGIO_BasicReport to sRecr
38675>>>>//            Move (Trim(sRecr)) to sRecr
38675>>>>
38675>>>>//            If (sRecr='') Error 7003 'ƒœ¤ ¬§á¨®œ  Recr š ˜ «¦ §˜¨˜©«˜« ¡æ'
38675>>>>
38675>>>>//            Clear Particle
38675>>>>//            Move sRecr to Particle.Partl_Recr
38675>>>>//            Find Eq Particle by index.2
38675>>>>//            If (Not(Found)) Error 7001 'ƒœ¤ ™¨âŸž¡œ «¦ §˜¨˜©«˜« ¡æ'
38675>>>>
38675>>>>//            Clear Pseira
38675>>>>//            Move SyscurXr.Company_Code  to Pseira.Company_Code
38675>>>>//            Move SyscurXr.Branch_Code   to Pseira.Branch_Code
38675>>>>//            Move Particle.Ptyppar_Code  to Pseira.Ptyppar_Code
38675>>>>//            Move Particle.Pseira_Seira  to Pseira.Pseira_Seira
38675>>>>//            Find Eq Pseira By Index.1 // Pseira:Index.1:Company_Code+Branch_Code+Year_Year+Ptyppar_Code+Pseira_Seira
38675>>>>//            If (Not(Found)) Error 7002 'ƒœ¤ ™¨âŸž¡œ ž ©œ ¨á'
38675>>>>
38675>>>>//            If (piAsciiOrPrinter(Self)=1) Begin
38675>>>>//                // 1= Output ©œ Ascii
38675>>>>//                Set Output_Device_Name  To 'C:\##Parast.txt'
38675>>>>//            End
38675>>>>//            Else If (piAsciiOrPrinter(Self)=2) Begin
38675>>>>//                // 2= Output ©œ Printer
38675>>>>//                Set Output_Device_Name  To Pseira.Pseira_Printer
38675>>>>//            End
38675>>>>//            Else Error 7004 '’¦ Flag piAsciiOrPrinter ›œ¤ œå¤˜  ©à©«æ'
38675>>>>//        End
38675>>>>
38675>>>>//        Send Run_Report  //record
38675>>>>
38675>>>>//        If iOutputDevice EQ PRINT_TO_WINDOW Begin
38675>>>>//            RunProgram background "notepad" FileName
38675>>>>//            EraseFile FileName
38675>>>>//        End
38675>>>>
38675>>>>//    End_Procedure   // StartReport
38675>>>>
38675>>>>
38675>>>>End_Class
38676>>>>
38676>>>>Class dbReportViewFEMSub is a dbReportViewSub
38677>>>>    Procedure Construct_Object
38678>>>>        Forward Send Construct_Object
38680>>>>
38680>>>>        Property Integer    piIsReportCancelled     Public  0
38681>>>>        Property Integer    piAsciiOrPrinter        Public  0
38682>>>>    
38682>>>>    End_Procedure
38683>>>>End_Class
38684>>>>
38684>>Use BasrpFem.Sub
INCLUDING FILE: BASRPFEM.SUB
38684>>>>Use Dfrpt.pkg
38684>>>>
38684>>>>Use BasicRpt.Sub
INCLUDING FILE: BASICRPT.SUB
38684>>>>>>Use Dfrpt.pkg
38684>>>>>>
38684>>>>>>Class BasicReportSub is a BasicReport
38685>>>>>>
38685>>>>>>  Procedure Start_Log
38686>>>>>>     Send Log_Status ("Starting Report:"+Report_Title(Current_Object))
38687>>>>>>  End_Procedure // Start_Log
38688>>>>>>
38688>>>>>>  Procedure End_Log
38689>>>>>>     Send Log_Status ("Ending Report:  " + Report_Title(Current_Object))
38690>>>>>>  End_Procedure // End_Log
38691>>>>>>
38691>>>>>>  Procedure Error_Log_Status integer ErrNum integer Err_Line string ErrMsg
38692>>>>>>     Send Log_Status ("Error #"* String(ErrNum) + "." * ErrMsg)
38693>>>>>>  End_Procedure // Error_Log_Status
38694>>>>>>
38694>>>>>>  Procedure Update_Status_Page
38695>>>>>>     If (Page_End(Current_Object)) EQ 0 ;        Send Update_Status ("Record: " + String(Page_Count(Current_Object)))
38698>>>>>>     Else Send Update_Status ("Page: " + String(Page_Count(Current_Object)))
38700>>>>>>  End_Procedure // Update_Status_Page
38701>>>>>>
38701>>>>>>  Function Report_Interrupt Returns Integer
38702>>>>>>     Integer rVal
38703>>>>>>     String Mess
38703>>>>>>
38703>>>>>>     If (Error_Check_State(Current_Object)) ;        Move "An error occured during processing. Do you want to cancel ?" to Mess
38706>>>>>>     Else ;            Move  "Do you want to cancel the process ?" to Mess
38708>>>>>>            Get YesNo_Box Mess "Process Interrupted" to rVal
38709>>>>>>     Function_Return (Rval=MBR_YES)
38710>>>>>>  End_Function  // Report_Interrupt
38711>>>>>>
38711>>>>>>
38711>>>>>>
38711>>>>>>End_Class // BasicReportSub
38712>>>>>>
38712>>>>>>Class WinReportSub is a WinReport
38713>>>>>>
38713>>>>>>  Procedure Start_Log
38714>>>>>>     Send Log_Status ("Start Report:"+Report_Title(Current_Object))
38715>>>>>>  End_Procedure // Start_Log
38716>>>>>>
38716>>>>>>  Procedure End_Log
38717>>>>>>     Send Log_Status ("End Report:  " + Report_Title(Current_Object))
38718>>>>>>  End_Procedure // End_Log
38719>>>>>>
38719>>>>>>  Procedure Error_Log_Status integer ErrNum integer Err_Line string ErrMsg
38720>>>>>>     Send Log_Status ("Error #"* String(ErrNum) + "." * ErrMsg)
38721>>>>>>  End_Procedure // Error_Log_Status
38722>>>>>>
38722>>>>>>  Procedure Update_Status_Page
38723>>>>>>     If (Page_End(Current_Object)) EQ 0 ;        Send Update_Status ("Record: " + String(Page_Count(Current_Object)))
38726>>>>>>     Else Send Update_Status ("Page: " + String(Page_Count(Current_Object)))
38728>>>>>>  End_Procedure // Update_Status_Page
38729>>>>>>
38729>>>>>>  Function Report_Interrupt Returns Integer
38730>>>>>>     Integer rVal
38731>>>>>>     String Mess
38731>>>>>>
38731>>>>>>     If (Error_Check_State(Current_Object)) ;        Move "An error occured during processing. Do you want to cancel ?" to Mess
38734>>>>>>     Else ;            Move  "Do you want to cancel the process ?" to Mess
38736>>>>>>            Get YesNo_Box Mess "Process Interrupted" to rVal
38737>>>>>>     Function_Return (Rval=MBR_YES)
38738>>>>>>  End_Function  // Report_Interrupt
38739>>>>>>
38739>>>>>>End_Class // WinReportSub
38740>>>>>>
38740>>>>
38740>>>>Class BasicReportFemSub is a BasicReportSub
38741>>>>
38741>>>>    Function Starting_Main_Report Returns Integer
38742>>>>        Integer   iRetVal iindexr14_1
38743>>>>        Forward Get Starting_Main_Report to iRetval
38745>>>>        If (Report_View_Id(Self)) Set piIsReportCancelled Of (Report_View_Id(Self)) to 0
38748>>>>        Function_Return iRetval
38749>>>>    End_Function
38750>>>>
38750>>>>    Procedure Ending_Report
38751>>>>        Integer isCancelled
38752>>>>        Get Cancelled_State         to isCancelled
38753>>>>        //If Already with error do not touch
38753>>>>        If (Report_View_Id(Self)) Begin
38755>>>>            If (piIsReportCancelled(Report_View_Id(Self))<>1) ;                Set piIsReportCancelled Of (Report_View_ID(Self)) to (isCancelled=1)
38758>>>>        End
38758>>>>>
38758>>>>    End_Procedure
38759>>>>
38759>>>>    Procedure onError integer ErrNum integer Err_Line string ErrMsg
38760>>>>        Forward Send onError ErrNum Err_Line ErrMsg
38762>>>>        If (Display_Error_State(Self)) Send End_Status
38765>>>>        Set piIsReportCancelled Of (Report_View_ID(Self)) to 1
38766>>>>    End_procedure
38767>>>>
38767>>>>End_Class
38768>>>>
38768>>>>Class WinReportFEMSub is a WinReportSUB
38769>>>>
38769>>>>    Function Starting_Main_Report Returns Integer
38770>>>>        Integer   iRetVal iindexr14_1
38771>>>>        Forward Get Starting_Main_Report to iRetval
38773>>>>        If (Report_View_Id(Self)) Set piIsReportCancelled Of (Report_View_Id(Self)) to 0
38776>>>>        Function_Return iRetval
38777>>>>    End_Function
38778>>>>
38778>>>>    Procedure Ending_Report
38779>>>>        Integer isCancelled
38780>>>>        Get Cancelled_State         to isCancelled
38781>>>>        //If Already with error do not touch
38781>>>>        If (Report_View_Id(Self)) Begin
38783>>>>            If (piIsReportCancelled(Report_View_Id(Self))<>1) ;                Set piIsReportCancelled Of (Report_View_ID(Self)) to (isCancelled=1)
38786>>>>        End
38786>>>>>
38786>>>>    End_Procedure
38787>>>>
38787>>>>    Procedure onError integer ErrNum integer Err_Line string ErrMsg
38788>>>>        Forward Send onError ErrNum Err_Line ErrMsg
38790>>>>        If (Display_Error_State(Self)) Send End_Status
38793>>>>        Set piIsReportCancelled Of (Report_View_ID(Self)) to 1
38794>>>>    End_procedure
38795>>>>
38795>>>>End_Class
38796>>>>
38796>>
38796>
INCLUDING FILE: XRHSH.PKG
38796>>//------------------------------
38796>>Use SelectXr.Dg
INCLUDING FILE: SELECTXR.DG
38796>>>>//AB/ Project SelectXr
38796>>>>//AB/     Object prj is a Dialog_Project
38796>>>>//AB/         Set ProjectName to "SelectXr"
38796>>>>//AB/         Set ProjectFileName to "SelectXr.DG"
38796>>>>//AB/         Set GenerateFileName to "NONAME"
38796>>>>
38796>>>>// Project Object Structure
38796>>>>//   oSelectYear is a dbModalPanelSub
38796>>>>//     Company_DD is a DataDictionary
38796>>>>//     Branch_DD is a DataDictionary
38796>>>>//     Year_DD is a DataDictionary
38796>>>>//     Company_Company_Code is a dbFormSub
38796>>>>//     Company_Company_Name is a dbFormSub
38796>>>>//     Branch_Branch_Code is a dbFormSub
38796>>>>//     Branch_Branch_Name is a dbFormSub
38796>>>>//     Year_Year_Year is a dbFormSub
38796>>>>//     Year_Year_Descr is a dbFormSub
38796>>>>//     Year_Year_Entrydate is a dbFormSub
38796>>>>//     oOk_bn is a ButtonSub
38796>>>>//     oCancel_bn is a ButtonSub
38796>>>>//     otxtCompany is a TextBoxSub
38796>>>>//     otxtBranch is a TextBoxSub
38796>>>>//     otxtYear is a TextBoxSub
38796>>>>//     otxtWorkingDay is a TextBoxSub
38796>>>>//     otxtWorkingDay is a TextBoxSub
38796>>>>//     chkxr is a CheckBoxSub
38796>>>>
38796>>>>// Register all objects
38796>>>>Register_Object Branch_Branch_Code
38796>>>>Register_Object Branch_Branch_Name
38796>>>>Register_Object Branch_DD
38796>>>>Register_Object Company_Company_Code
38796>>>>Register_Object Company_Company_Name
38796>>>>Register_Object Company_DD
38796>>>>Register_Object chkxr
38796>>>>Register_Object oCancel_bn
38796>>>>Register_Object oOk_bn
38796>>>>Register_Object oSelectYear
38796>>>>Register_Object otxtBranch
38796>>>>Register_Object otxtCompany
38796>>>>Register_Object otxtWorkingDay
38796>>>>Register_Object otxtYear
38796>>>>Register_Object Year_DD
38796>>>>Register_Object Year_Year_Descr
38796>>>>Register_Object Year_Year_Entrydate
38796>>>>Register_Object Year_Year_Year
38796>>>>
38796>>>>
38796>>>>
38796>>>>    //AB-StoreTopStart
38796>>>>
38796>>>>
38796>>>>
38796>>>>
38796>>>>           String  gs_selected_beto_site
38796>>>>
38796>>>>    Open SysCurXR
38798>>>>    Open Nomisma
38800>>>>
38800>>>>    //AB-StoreTopEnd
38800>>>>
38800>>>>    //AB-IgnoreStart
38800>>>>
38800>>>>    Use DFAllEnt.pkg
38800>>>>    Use dbForm.Sub
38800>>>>    Use Button.Sub
38800>>>>    Use Txtbox.Sub
38800>>>>    Use Chkbox.Sub
38800>>>>
38800>>>>
38800>>>>    Use COMPANY.DD
INCLUDING FILE: COMPANY.DD
38800>>>>>>//DDB-FileStart
38800>>>>>>//DDB-HeaderStart
38800>>>>>>
38800>>>>>>// File Name : COMPANY.DD
38800>>>>>>// Class Name: Company_DataDictionary
38800>>>>>>// Revision  : 60
38800>>>>>>// Version   : 2
38800>>>>>>
38800>>>>>>Use  Windows           // Basic Definitions
38800>>>>>>Use  DataDict          // DataDictionary Class Definition
38800>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38800>>>>>>
38800>>>>>>Open Company
INCLUDING FILE: COMPANY.FD
38802>>>>>>Open Branch
38804>>>>>>
38804>>>>>>//DDB-HeaderEnd
38804>>>>>>//DDB-ValidationStart
38804>>>>>>
38804>>>>>>Register_Object Company_Company_Doy_VT
38804>>>>>>Register_Object Company_Company_J_Code_VT
38804>>>>>>
38804>>>>>>Object Company_Company_Doy_VT  is a CodeValidationTable
38806>>>>>>    Set Type_Value        To "DOY"
38807>>>>>>    Set Allow_Blank_State To TRUE
38808>>>>>>    //DDB-ValidationCustomStart
38808>>>>>>    //DDB-ValidationCustomEnd
38808>>>>>>End_Object   // Company_Company_Doy_VT
38809>>>>>>
38809>>>>>>Object Company_Company_J_Code_VT  is a CodeValidationTable
38811>>>>>>    Set Type_Value        To "JOB"
38812>>>>>>    Set Allow_Blank_State To TRUE
38813>>>>>>    //DDB-ValidationCustomStart
38813>>>>>>    //DDB-ValidationCustomEnd
38813>>>>>>End_Object   // Company_Company_J_Code_VT
38814>>>>>>//DDB-ValidationEnd
38814>>>>>>//DDB-SelectionStart
38814>>>>>>//DDB/ ExternalSelectionList sl001  sl001.sl
38814>>>>>>Register_Object sl001
38814>>>>>>//DDB-SelectionEnd
38814>>>>>> 
38814>>>>>>Class Company_DataDictionary  is a DataDictionary
38815>>>>>> 
38815>>>>>>    // Update:
38815>>>>>> 
38815>>>>>>    Procedure Update
38816>>>>>>        Forward Send Update
38818>>>>>>        move 'DOY' to company.doy_type
38819>>>>>>        move 'JOB' to company.jcode_type 
38820>>>>>>        // Insert Code Here
38820>>>>>>    End_Procedure   // Update
38821>>>>>> 
38821>>>>>>
38821>>>>>>    // Operation_Not_Allowed:
38821>>>>>>
38821>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
38822>>>>>>        // Insert Code Here
38822>>>>>>        Case Begin
38822>>>>>>             Case (iError_Num = 1001)
38824>>>>>>                  Error 1001 "DDC 051:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª „«˜ ¨œå˜ª!\n\n‰œ¤æª ‰à› ¡æª"
38825>>>>>>>
38825>>>>>>             Case Break
38826>>>>>>
38826>>>>>>             Case Else
38826>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
38828>>>>>>        Case End
38828>>>>>>    End_Procedure   // Operation_Not_Allowed
38829>>>>>>
38829>>>>>>
38829>>>>>>    // Validate_Save:
38829>>>>>>
38829>>>>>>    Function Validate_Save  Returns Integer
38830>>>>>>        Local Integer iReturnVal
38831>>>>>>        Forward Get Validate_Save  To iReturnVal
38833>>>>>>        If (Not(iReturnVal)) Begin
38835>>>>>>            // Insert Code Here
38835>>>>>>            If (Company.Company_Code="") Send Operation_Not_Allowed 1001
38838>>>>>>        End
38838>>>>>>>
38838>>>>>>        Function_Return iReturnVal
38839>>>>>>    End_Function   // Validate_Save
38840>>>>>>
38840>>>>>>
38840>>>>>>    // Define_Fields:
38840>>>>>>    // This procedure is used to set up all data-dictionary rules.
38840>>>>>>
38840>>>>>>    Procedure Define_Fields
38841>>>>>>        Forward Send Define_Fields
38843>>>>>>        //DDB-Generated-Code-Location
38843>>>>>>        //DDB-DefineFieldStart
38843>>>>>>
38843>>>>>>        Set Main_File            To Company.File_Number
38844>>>>>>        Set Cascade_Delete_State To FALSE
38845>>>>>>
38845>>>>>>
38845>>>>>>        // Child (Client) file structure................
38845>>>>>>        Send Add_Client_File  Branch.File_Number
38846>>>>>>
38846>>>>>>        // Field-based properties.......................
38846>>>>>>
38846>>>>>>        // Company.Company_Code
38846>>>>>>        Set Field_Options          Field Company.Company_Code To DD_AUTOFIND   
38847>>>>>>        Set Field_Prompt_Object    Field Company.Company_Code To (sl001(Self))
38848>>>>>>
38848>>>>>>        // Company.Company_Name
38848>>>>>>        Set Field_Options          Field Company.Company_Name To DD_REQUIRED   
38849>>>>>>        Set Field_Prompt_Object    Field Company.Company_Name To (sl001(Self))
38850>>>>>>
38850>>>>>>        // Company.Company_Afm
38850>>>>>>        Set Field_Options          Field Company.Company_Afm To DD_AUTOFIND   
38851>>>>>>
38851>>>>>>        // Company.Company_Addr
38851>>>>>>
38851>>>>>>        // Company.Company_Tk
38851>>>>>>
38851>>>>>>        // Company.Company_Poli
38851>>>>>>
38851>>>>>>        // Company.Company_Doy
38851>>>>>>        Set Field_Value_Table      Field Company.Company_Doy To (Company_Company_Doy_VT(Self))
38852>>>>>>
38852>>>>>>        // Company.Company_J_Code
38852>>>>>>        Set Field_Value_Table      Field Company.Company_J_Code To (Company_Company_J_Code_VT(Self))
38853>>>>>>
38853>>>>>>        // Company.Company_C_Code0
38853>>>>>>
38853>>>>>>        // Company.Company_C_Cod00
38853>>>>>>
38853>>>>>>        // Company.Company_C_Coder
38853>>>>>>
38853>>>>>>        // Company.Company_Tel
38853>>>>>>
38853>>>>>>        // Company.Company_Fax
38853>>>>>>
38853>>>>>>        // Company.Company_Email
38853>>>>>>
38853>>>>>>        // Company.Company_Resp
38853>>>>>>
38853>>>>>>        // Company.Company_Bitmap
38853>>>>>>
38853>>>>>>        // Company.Beto_Site
38853>>>>>>
38853>>>>>>        // Company.Logo
38853>>>>>>
38853>>>>>>        // Company.Doy_Type
38853>>>>>>
38853>>>>>>        // Company.Jcode_Type
38853>>>>>>
38853>>>>>>        // Company.Sap_Code
38853>>>>>>
38853>>>>>>        //DDB-DefineFieldEnd
38853>>>>>>    End_Procedure    // Define_Fields
38854>>>>>>
38854>>>>>>    // Field_Defaults:
38854>>>>>>    // This procedure is used to establish default field values.
38854>>>>>>
38854>>>>>>    Procedure Field_Defaults
38855>>>>>>        Forward Send Field_Defaults
38857>>>>>>        //DDB-Generated-Code-Location
38857>>>>>>        //DDB-FieldDefaultStart
38857>>>>>>        //DDB-FieldDefaultEnd
38857>>>>>>    End_Procedure    // Field_Defaults
38858>>>>>>End_Class    // Company_DataDictionary
38859>>>>>>
38859>>>>>>//DDB-Selection-pkg-Start
38859>>>>>>
38859>>>>>>Use sl001.sl         // sl001
INCLUDING FILE: SL001.SL
38859>>>>>>>>//AB/ Project sl001 : Etairies
38859>>>>>>>>//AB/     Object prj is a Lookup_Project
38859>>>>>>>>//AB/         Set ProjectName to "sl001 : Etairies"
38859>>>>>>>>//AB/         Set ProjectFileName to "sl001.SL"
38859>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
38859>>>>>>>>
38859>>>>>>>>// Project Object Structure
38859>>>>>>>>//   sl001 is a dbModalPanel
38859>>>>>>>>//     Company_DD is a DataDictionary
38859>>>>>>>>//     oSelList is a dbList
38859>>>>>>>>//     oOK_bn is a ButtonSub
38859>>>>>>>>//     oCancel_bn is a ButtonSub
38859>>>>>>>>//     oSearch_bn is a ButtonSub
38859>>>>>>>>
38859>>>>>>>>// Register all objects
38859>>>>>>>>Register_Object Company_DD
38859>>>>>>>>Register_Object oCancel_bn
38859>>>>>>>>Register_Object oOK_bn
38859>>>>>>>>Register_Object oSearch_bn
38859>>>>>>>>Register_Object oSelList
38859>>>>>>>>Register_Object sl001
38859>>>>>>>>
38859>>>>>>>>
38859>>>>>>>>    //AB-IgnoreStart
38859>>>>>>>>
38859>>>>>>>>    Use DFAllEnt.pkg
38859>>>>>>>>    Use Button.Sub
38859>>>>>>>>
38859>>>>>>>>
38859>>>>>>>>    Use COMPANY.DD
38859>>>>>>>>    
38859>>>>>>>>    //AB-IgnoreEnd
38859>>>>>>>>
38859>>>>>>>>    CD_Popup_Object sl001 is a dbModalPanel
38878>>>>>>>>        Set Label to "„«˜ ¨åœª"
38879>>>>>>>>        Set Size to 148 297
38880>>>>>>>>        Set Location to 12 27
38881>>>>>>>>
38881>>>>>>>>        //AB-DDOStart
38881>>>>>>>>
38881>>>>>>>>        Object Company_DD is a Company_DataDictionary
38883>>>>>>>>        End_Object    // Company_DD
38884>>>>>>>>
38884>>>>>>>>        Set Main_DD to (Company_DD(self))
38885>>>>>>>>        Set Server to (Company_DD(self))
38886>>>>>>>>
38886>>>>>>>>        //AB-DDOEnd
38886>>>>>>>>
38886>>>>>>>>        Object oSelList is a dbList
38888>>>>>>>>            Set Main_File to Company.File_Number
38889>>>>>>>>            Set Size to 105 280
38890>>>>>>>>            Set Location to 6 6
38891>>>>>>>>
38891>>>>>>>>            Begin_Row
38894>>>>>>>>                Entry_Item Company.Company_code
38895>>>>>>>>                Entry_Item Company.Company_name
38896>>>>>>>>                Entry_Item Company.Company_afm
38897>>>>>>>>            End_Row
38902>>>>>>>>
38902>>>>>>>>            Set Form_Width    item 0 to 42
38903>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
38904>>>>>>>>            
38904>>>>>>>>            Set Form_Width    item 1 to 150
38905>>>>>>>>            Set Header_Label  item 1 to "„§à¤¬£å˜"
38906>>>>>>>>            
38906>>>>>>>>            Set Form_Width    item 2 to 80
38907>>>>>>>>            Set Header_Label  item 2 to "€.”.‹"
38908>>>>>>>>            
38908>>>>>>>>        End_Object    // oSelList
38909>>>>>>>>
38909>>>>>>>>        Object oOK_bn is a ButtonSub
38911>>>>>>>>            Set Label to "&„§ ¢¦šã"
38912>>>>>>>>            Set Location to 115 126
38913>>>>>>>>
38913>>>>>>>>            //AB-StoreStart
38913>>>>>>>>            Procedure OnClick
38915>>>>>>>>                Send OK To (oSelList(current_object))
38916>>>>>>>>            End_Procedure
38917>>>>>>>>            //AB-StoreEnd
38917>>>>>>>>
38917>>>>>>>>        End_Object    // oOK_bn
38918>>>>>>>>
38918>>>>>>>>        Object oCancel_bn is a ButtonSub
38920>>>>>>>>            Set Label to "&€¡ç¨à©ž"
38921>>>>>>>>            Set Location to 115 181
38922>>>>>>>>
38922>>>>>>>>            //AB-StoreStart
38922>>>>>>>>            Procedure OnClick
38924>>>>>>>>                Send Cancel To (oSelList(current_object))
38925>>>>>>>>            End_Procedure
38926>>>>>>>>            //AB-StoreEnd
38926>>>>>>>>
38926>>>>>>>>        End_Object    // oCancel_bn
38927>>>>>>>>
38927>>>>>>>>        Object oSearch_bn is a ButtonSub
38929>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
38930>>>>>>>>            Set Location to 115 236
38931>>>>>>>>
38931>>>>>>>>            //AB-StoreStart
38931>>>>>>>>            Procedure OnClick
38933>>>>>>>>                Send Search To (oSelList(current_object))
38934>>>>>>>>            End_Procedure
38935>>>>>>>>            //AB-StoreEnd
38935>>>>>>>>
38935>>>>>>>>        End_Object    // oSearch_bn
38936>>>>>>>>
38936>>>>>>>>
38936>>>>>>>>        //AB-StoreStart
38936>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To oOk_bn
38937>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To oCancel_bn
38938>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To oSearch_bn
38939>>>>>>>>        //AB-StoreEnd
38939>>>>>>>>
38939>>>>>>>>    CD_End_Object    // sl001
38941>>>>>>>>>
38941>>>>>>>>
38941>>>>>>>>//AB/     End_Object    // prj
38941>>>>>>
38941>>>>>>//DDB-Selection-pkg-End
38941>>>>>>//DDB-FileEnd
38941>>>>    Use BRANCH.DD
INCLUDING FILE: BRANCH.DD
38941>>>>>>//DDB-FileStart
38941>>>>>>//DDB-HeaderStart
38941>>>>>>
38941>>>>>>// File Name : BRANCH.DD
38941>>>>>>// Class Name: Branch_DataDictionary
38941>>>>>>// Revision  : 87
38941>>>>>>// Version   : 2
38941>>>>>>
38941>>>>>>Use  Windows           // Basic Definitions
38941>>>>>>Use  DataDict          // DataDictionary Class Definition
38941>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38941>>>>>>
38941>>>>>>Open Branch
38943>>>>>>Open Year
38945>>>>>>Open Brzones
INCLUDING FILE: BRZONES.FD
38947>>>>>>Open Tpbranch
INCLUDING FILE: TPBRANCH.FD
38949>>>>>>Open Company
38951>>>>>>Open Sysrecg
INCLUDING FILE: SYSRECG.FD
38953>>>>>>
38953>>>>>>//DDB-HeaderEnd
38953>>>>>>//DDB-ValidationStart
38953>>>>>>
38953>>>>>>Register_Object Branch_Branch_Doy_VT
38953>>>>>>Register_Object Branch_Branch_C_Code0_VT
38953>>>>>>
38953>>>>>>Object Branch_Branch_Doy_VT  is a CodeValidationTable
38955>>>>>>    Set Type_Value        To "DOY"
38956>>>>>>    Set Validate_State    To FALSE
38957>>>>>>    Set Allow_Blank_State To TRUE
38958>>>>>>    //DDB-ValidationCustomStart
38958>>>>>>    //DDB-ValidationCustomEnd
38958>>>>>>End_Object   // Branch_Branch_Doy_VT
38959>>>>>>
38959>>>>>>Object Branch_Branch_C_Code0_VT  is a CodeValidationTable
38961>>>>>>    Set Type_Value        To ""
38962>>>>>>    Set Allow_Blank_State To TRUE
38963>>>>>>    //DDB-ValidationCustomStart
38963>>>>>>    //DDB-ValidationCustomEnd
38963>>>>>>End_Object   // Branch_Branch_C_Code0_VT
38964>>>>>>//DDB-ValidationEnd
38964>>>>>>//DDB-SelectionStart
38964>>>>>>//DDB/ ExternalSelectionList SL002  Sl002.sl
38964>>>>>>Register_Object SL002
38964>>>>>>//DDB-SelectionEnd
38964>>>>>>
38964>>>>>>Class Branch_DataDictionary  is a DataDictionary
38965>>>>>> 
38965>>>>>>    Procedure Save_Main_File
38966>>>>>>        Forward Send Save_Main_File
38968>>>>>>        // Insert Code Here
38968>>>>>>    End_Procedure   // Save_Main_File
38969>>>>>> 
38969>>>>>>    Procedure Creating
38970>>>>>>        Forward Send Creating
38972>>>>>>        // Insert Code Here
38972>>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Branch.Branch_Rec0)))))) to Branch.Branch_Recr
38973>>>>>>    End_Procedure   // Creating
38974>>>>>>
38974>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
38975>>>>>>        // Insert Code Here
38975>>>>>>        Case Begin
38975>>>>>>             Case (iError_Num = 1001)
38977>>>>>>                  Error 1001 "DDC 052:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
38978>>>>>>>
38978>>>>>>             Case Break
38979>>>>>>
38979>>>>>>             Case Else
38979>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
38981>>>>>>        Case End
38981>>>>>>    End_Procedure   // Operation_Not_Allowed
38982>>>>>>
38982>>>>>>
38982>>>>>>    // Validate_Save:
38982>>>>>>
38982>>>>>>    Function Validate_Save  Returns Integer
38983>>>>>>        Local Integer iReturnVal
38984>>>>>>        Forward Get Validate_Save  To iReturnVal
38986>>>>>>        If (Not(iReturnVal)) Begin
38988>>>>>>            // Insert Code Here
38988>>>>>>            If (Branch.Branch_Code="") Send Operation_Not_Allowed 1001
38991>>>>>>        End
38991>>>>>>>
38991>>>>>>        Function_Return iReturnVal
38992>>>>>>    End_Function   // Validate_Save
38993>>>>>>
38993>>>>>>
38993>>>>>>    // Define_Fields:
38993>>>>>>    // This procedure is used to set up all data-dictionary rules.
38993>>>>>>
38993>>>>>>    Procedure Define_Fields
38994>>>>>>        Forward Send Define_Fields
38996>>>>>>        //DDB-Generated-Code-Location
38996>>>>>>        //DDB-DefineFieldStart
38996>>>>>>
38996>>>>>>        Set Main_File            To Branch.File_Number
38997>>>>>>        Set Cascade_Delete_State To FALSE
38998>>>>>>
38998>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
38999>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOENTER     DD_FINDREQ    
39000>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39001>>>>>>
39001>>>>>>        // Child (Client) file structure................
39001>>>>>>        Send Add_Client_File  Year.File_Number
39002>>>>>>        Send Add_Client_File  Brzones.File_Number
39003>>>>>>        Send Add_Client_File  Tpbranch.File_Number
39004>>>>>>
39004>>>>>>        // Parent (Server) file structure...............
39004>>>>>>        Send Add_Server_File  Company.File_Number
39005>>>>>>
39005>>>>>>        // External (System) file structure.............
39005>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
39006>>>>>>
39006>>>>>>        Define_Auto_Increment  Sysrecg.Branch_Rec0  To Branch.Branch_Rec0
39009>>>>>>
39009>>>>>>        // Field-based properties.......................
39009>>>>>>
39009>>>>>>        // Branch.Company_Code
39009>>>>>>
39009>>>>>>        // Branch.Branch_Code
39009>>>>>>        Set Field_Options          Field Branch.Branch_Code To DD_AUTOFIND   
39010>>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Code To (SL002(Self))
39011>>>>>>        Set Key_Field_State        Field Branch.Branch_Code To TRUE
39012>>>>>>
39012>>>>>>        // Branch.Branch_Rec0
39012>>>>>>
39012>>>>>>        // Branch.Branch_Recr
39012>>>>>>
39012>>>>>>        // Branch.Branch_Name
39012>>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Name To (SL002(Self))
39013>>>>>>
39013>>>>>>        // Branch.Branch_Afm
39013>>>>>>
39013>>>>>>        // Branch.Branch_Addr
39013>>>>>>
39013>>>>>>        // Branch.Branch_Tk
39013>>>>>>
39013>>>>>>        // Branch.Branch_Poli
39013>>>>>>
39013>>>>>>        // Branch.Branch_Doy
39013>>>>>>        Set Field_Value_Table      Field Branch.Branch_Doy To (Branch_Branch_Doy_VT(Self))
39014>>>>>>
39014>>>>>>        // Branch.Branch_J_Code
39014>>>>>>
39014>>>>>>        // Branch.Branch_C_Code0
39014>>>>>>        Set Field_Value_Table      Field Branch.Branch_C_Code0 To (Branch_Branch_C_Code0_VT(Self))
39015>>>>>>
39015>>>>>>        // Branch.Branch_C_Code00
39015>>>>>>
39015>>>>>>        // Branch.Branch_C_Coder
39015>>>>>>
39015>>>>>>        // Branch.Branch_Tel
39015>>>>>>
39015>>>>>>        // Branch.Branch_Fax
39015>>>>>>
39015>>>>>>        // Branch.Branch_Email
39015>>>>>>
39015>>>>>>        // Branch.Branch_Resp
39015>>>>>>
39015>>>>>>        // Branch.Branch_Bitmap
39015>>>>>>
39015>>>>>>        // Branch.Branch_Site
39015>>>>>>
39015>>>>>>        // Branch.Branch_Apoth
39015>>>>>>
39015>>>>>>        // Branch.Beto_Site
39015>>>>>>
39015>>>>>>        // Branch.Path_Exp
39015>>>>>>
39015>>>>>>        // Branch.Exp_Txtname
39015>>>>>>
39015>>>>>>        // Branch.Send_Phone
39015>>>>>>
39015>>>>>>        // Branch.Send_Path_Files
39015>>>>>>
39015>>>>>>        // Branch.Send_Path_Conf
39015>>>>>>
39015>>>>>>        // Branch.Tomeas_Code
39015>>>>>>
39015>>>>>>        // Branch.Ftp_Sec_Retry
39015>>>>>>
39015>>>>>>        // Branch.Ftp_Sec_Exit
39015>>>>>>
39015>>>>>>        // Branch.Ras_Name
39015>>>>>>
39015>>>>>>        // Branch.Ras_Passw
39015>>>>>>
39015>>>>>>        // Branch.Ras_Domain
39015>>>>>>
39015>>>>>>        // Branch.Last_Hmnia_Ekt
39015>>>>>>
39015>>>>>>        // Branch.Deop_Logo
39015>>>>>>
39015>>>>>>        // Branch.Entolh
39015>>>>>>
39015>>>>>>        // Branch.Paragogh
39015>>>>>>
39015>>>>>>        // Branch.Locked_Until
39015>>>>>>
39015>>>>>>        // Branch.Sap_Code
39015>>>>>>
39015>>>>>>        //DDB-DefineFieldEnd
39015>>>>>>    End_Procedure    // Define_Fields
39016>>>>>>
39016>>>>>>    // Field_Defaults:
39016>>>>>>    // This procedure is used to establish default field values.
39016>>>>>>
39016>>>>>>    Procedure Field_Defaults
39017>>>>>>        Forward Send Field_Defaults
39019>>>>>>        //DDB-Generated-Code-Location
39019>>>>>>        //DDB-FieldDefaultStart
39019>>>>>>        //DDB-FieldDefaultEnd
39019>>>>>>    End_Procedure    // Field_Defaults
39020>>>>>>End_Class    // Branch_DataDictionary
39021>>>>>>
39021>>>>>>//DDB-Selection-pkg-Start
39021>>>>>>
39021>>>>>>Use Sl002.sl         // SL002
INCLUDING FILE: SL002.SL
39021>>>>>>>>//AB/ Project SL002:Branch
39021>>>>>>>>//AB/ Object prj is a Lookup_Project
39021>>>>>>>>//AB/     Set ProjectName to "SL002:Branch"
39021>>>>>>>>//AB/     Set ProjectFileName to "Sl002.sl"
39021>>>>>>>>
39021>>>>>>>>// Project Object Structure
39021>>>>>>>>//   SL002 is a dbModalPanelSub
39021>>>>>>>>//     Company_DD is a DataDictionary
39021>>>>>>>>//     Branch_DD is a DataDictionary
39021>>>>>>>>//     oSelList is a dbListSub
39021>>>>>>>>//     oOK_bn is a ButtonSub
39021>>>>>>>>//     oCancel_bn is a ButtonSub
39021>>>>>>>>//     oSearch_bn is a ButtonSub
39021>>>>>>>>
39021>>>>>>>>// Register all objects
39021>>>>>>>>Register_Object Branch_DD
39021>>>>>>>>Register_Object Company_DD
39021>>>>>>>>Register_Object oCancel_bn
39021>>>>>>>>Register_Object oOK_bn
39021>>>>>>>>Register_Object oSearch_bn
39021>>>>>>>>Register_Object oSelList
39021>>>>>>>>Register_Object SL002
39021>>>>>>>>
39021>>>>>>>>
39021>>>>>>>>//AB-IgnoreStart
39021>>>>>>>>
39021>>>>>>>>Use DFAllEnt.pkg
39021>>>>>>>>Use dbList.Sub
39021>>>>>>>>Use Button.Sub
39021>>>>>>>>
39021>>>>>>>>
39021>>>>>>>>Use COMPANY.DD
39021>>>>>>>>Use BRANCH.DD
39021>>>>>>>>
39021>>>>>>>>//AB-IgnoreEnd
39021>>>>>>>>
39021>>>>>>>>Object SL002 is a dbModalPanelSub
39023>>>>>>>>
39023>>>>>>>>    //AB-StoreTopStart
39023>>>>>>>>    Property String psFragmaCompanyCode  ""
39025>>>>>>>>    
39025>>>>>>>>    //AB-StoreTopEnd
39025>>>>>>>>
39025>>>>>>>>    Set Minimize_Icon to FALSE
39026>>>>>>>>    Set Label to "“§¦¡˜«˜©«ã£˜«˜"
39027>>>>>>>>    Set Size to 146 430
39028>>>>>>>>    Set Location to 4 5
39029>>>>>>>>    Set Exit_Application_Local_State to FALSE
39030>>>>>>>>    Set Modal_State to FALSE
39031>>>>>>>>
39031>>>>>>>>    //AB-DDOStart
39031>>>>>>>>
39031>>>>>>>>    Object Company_DD is a Company_DataDictionary
39033>>>>>>>>    End_Object    // Company_DD
39034>>>>>>>>
39034>>>>>>>>    Object Branch_DD is a Branch_DataDictionary
39036>>>>>>>>        Set DDO_Server to (Company_DD(self))
39037>>>>>>>>
39037>>>>>>>>        //AB-StoreStart
39037>>>>>>>>        Procedure OnConstrain
39039>>>>>>>>             String lsCompanyCode
39040>>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
39041>>>>>>>>             If (lsCompanyCode <> "") Constrain Branch.Company_code eq lsCompanyCode
39045>>>>>>>>        End_Procedure // OnConstrain
39046>>>>>>>>        
39046>>>>>>>>        
39046>>>>>>>>        
39046>>>>>>>>        //AB-StoreEnd
39046>>>>>>>>
39046>>>>>>>>    End_Object    // Branch_DD
39047>>>>>>>>
39047>>>>>>>>    Set Main_DD to (Branch_DD(self))
39048>>>>>>>>    Set Server to (Branch_DD(self))
39049>>>>>>>>
39049>>>>>>>>    //AB-DDOEnd
39049>>>>>>>>
39049>>>>>>>>    Object oSelList is a dbListSub
39051>>>>>>>>        Set Main_File to Branch.File_Number
39052>>>>>>>>        Set Size to 105 415
39053>>>>>>>>        Set Location to 6 6
39054>>>>>>>>
39054>>>>>>>>        Begin_Row
39057>>>>>>>>            Entry_Item Branch.Branch_code
39058>>>>>>>>            Entry_Item Branch.Branch_name
39059>>>>>>>>            Entry_Item Company.Company_code
39060>>>>>>>>            Entry_Item Company.Company_name
39061>>>>>>>>            Entry_Item Branch.Beto_site
39062>>>>>>>>            Entry_Item Branch.Branch_recr
39063>>>>>>>>        End_Row
39068>>>>>>>>
39068>>>>>>>>        Set Form_Width    item 0 to 60
39069>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
39070>>>>>>>>        
39070>>>>>>>>        Set Form_Width    item 1 to 128
39071>>>>>>>>        Set Header_Label  item 1 to "Ž¤¦£˜"
39072>>>>>>>>        
39072>>>>>>>>        Set Form_Width    item 2 to 69
39073>>>>>>>>        Set Header_Label  item 2 to "‰à› ¡æª „«˜ ¨å˜ª"
39074>>>>>>>>        
39074>>>>>>>>        Set Form_Width    item 3 to 109
39075>>>>>>>>        Set Header_Label  item 3 to "Ž¤¦£˜ „«˜ ¨å˜ª"
39076>>>>>>>>        
39076>>>>>>>>        Set Form_Width    item 4 to 42
39077>>>>>>>>        Set Header_Label  item 4 to "Site"
39078>>>>>>>>        
39078>>>>>>>>        Set Form_Width    item 5 to 0
39079>>>>>>>>        Set Header_Label  item 5 to ""
39080>>>>>>>>        
39080>>>>>>>>
39080>>>>>>>>        //AB-StoreStart
39080>>>>>>>>        
39080>>>>>>>>        Property String psStoreFragmaCompanyCode  ""
39082>>>>>>>>        
39082>>>>>>>>        Procedure Store_Defaults
39084>>>>>>>>            forward send Store_Defaults
39086>>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
39087>>>>>>>>        end_Procedure // Store_Defaults
39088>>>>>>>>        
39088>>>>>>>>        Procedure Restore_Defaults
39090>>>>>>>>            forward send Restore_Defaults
39092>>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
39093>>>>>>>>        end_Procedure // Restore_Defaults
39094>>>>>>>>        
39094>>>>>>>>        Procedure Activating
39096>>>>>>>>            Forward Send Activating
39098>>>>>>>>            Send Rebuild_Constraints to (Branch_DD(self))
39099>>>>>>>>        End_Procedure // Activating
39100>>>>>>>>        
39100>>>>>>>>        Set Column_Options Item 5 to NoEnter True
39101>>>>>>>>        
39101>>>>>>>>        
39101>>>>>>>>        //AB-StoreEnd
39101>>>>>>>>
39101>>>>>>>>    End_Object    // oSelList
39102>>>>>>>>
39102>>>>>>>>    Object oOK_bn is a ButtonSub
39104>>>>>>>>        Set Label to "&„§ ¢¦šã"
39105>>>>>>>>        Set Location to 112 262
39106>>>>>>>>
39106>>>>>>>>        //AB-StoreStart
39106>>>>>>>>        Procedure OnClick
39108>>>>>>>>            Send OK To (oSelList(current_object))
39109>>>>>>>>        End_Procedure
39110>>>>>>>>        //AB-StoreEnd
39110>>>>>>>>
39110>>>>>>>>    End_Object    // oOK_bn
39111>>>>>>>>
39111>>>>>>>>    Object oCancel_bn is a ButtonSub
39113>>>>>>>>        Set Label to "&€¡ç¨à©ž"
39114>>>>>>>>        Set Location to 112 317
39115>>>>>>>>
39115>>>>>>>>        //AB-StoreStart
39115>>>>>>>>        Procedure OnClick
39117>>>>>>>>            Send Cancel To (oSelList(current_object))
39118>>>>>>>>        End_Procedure
39119>>>>>>>>        //AB-StoreEnd
39119>>>>>>>>
39119>>>>>>>>    End_Object    // oCancel_bn
39120>>>>>>>>
39120>>>>>>>>    Object oSearch_bn is a ButtonSub
39122>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
39123>>>>>>>>        Set Location to 112 372
39124>>>>>>>>
39124>>>>>>>>        //AB-StoreStart
39124>>>>>>>>        Procedure OnClick
39126>>>>>>>>            Send Search To (oSelList(current_object))
39127>>>>>>>>        End_Procedure
39128>>>>>>>>        //AB-StoreEnd
39128>>>>>>>>
39128>>>>>>>>    End_Object    // oSearch_bn
39129>>>>>>>>
39129>>>>>>>>
39129>>>>>>>>    //AB-StoreStart
39129>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39130>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39131>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39132>>>>>>>>    
39132>>>>>>>>    
39132>>>>>>>>    //AB-StoreEnd
39132>>>>>>>>
39132>>>>>>>>End_Object    // SL002
39133>>>>>>>>
39133>>>>>>>>//AB/ End_Object    // prj
39133>>>>>>
39133>>>>>>//DDB-Selection-pkg-End
39133>>>>>>//DDB-FileEnd
39133>>>>    Use YEAR.DD
INCLUDING FILE: YEAR.DD
39133>>>>>>//DDB-FileStart
39133>>>>>>//DDB-HeaderStart
39133>>>>>>
39133>>>>>>// File Name : YEAR.DD
39133>>>>>>// Class Name: Year_DataDictionary
39133>>>>>>// Revision  : 118
39133>>>>>>// Version   : 2
39133>>>>>>
39133>>>>>>Use  Windows           // Basic Definitions
39133>>>>>>Use  DataDict          // DataDictionary Class Definition
39133>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39133>>>>>>
39133>>>>>>Open Year
39135>>>>>>Open Branch
39137>>>>>>Open Syscurxr
39139>>>>>>
39139>>>>>>//DDB-HeaderEnd
39139>>>>>>//DDB-ValidationStart
39139>>>>>>
39139>>>>>>Register_Object Year_Year_C_Code0_VT1
39139>>>>>>Register_Object Year_Year_C_Code00_VT1
39139>>>>>>Register_Object Year_Year_C_Coder_VT1
39139>>>>>>
39139>>>>>>Object Year_Year_C_Code0_VT1  is a CodeValidationTable
39141>>>>>>    Set Type_Value        To "CURRENCY"
39142>>>>>>    //DDB-ValidationCustomStart
39142>>>>>>    //DDB-ValidationCustomEnd
39142>>>>>>End_Object   // Year_Year_C_Code0_VT1
39143>>>>>>
39143>>>>>>Object Year_Year_C_Code00_VT1  is a CodeValidationTable
39145>>>>>>    Set Type_Value        To "CURRENCY"
39146>>>>>>    //DDB-ValidationCustomStart
39146>>>>>>    //DDB-ValidationCustomEnd
39146>>>>>>End_Object   // Year_Year_C_Code00_VT1
39147>>>>>>
39147>>>>>>Object Year_Year_C_Coder_VT1  is a CodeValidationTable
39149>>>>>>    Set Type_Value        To "CURRENCY"
39150>>>>>>    //DDB-ValidationCustomStart
39150>>>>>>    //DDB-ValidationCustomEnd
39150>>>>>>End_Object   // Year_Year_C_Coder_VT1
39151>>>>>>//DDB-ValidationEnd
39151>>>>>>//DDB-SelectionStart
39151>>>>>>//DDB/ ExternalSelectionList SL003  Sl003.sl
39151>>>>>>Register_Object SL003
39151>>>>>>//DDB-SelectionEnd
39151>>>>>>            
39151>>>>>>Class Year_DataDictionary  is a DataDictionary
39152>>>>>>    
39152>>>>>>    Procedure Creating
39153>>>>>>        Forward Send Creating
39155>>>>>>        // Insert Code Here
39155>>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Year.Year_Year)))))) to Year.Year_Recr
39156>>>>>>    End_Procedure   // Creating
39157>>>>>>
39157>>>>>>
39157>>>>>>    // Operation_Not_Allowed:
39157>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
39158>>>>>>        // Insert Code Here
39158>>>>>>        Case Begin    
39158>>>>>>             Case (iError_Num = 1001)
39160>>>>>>                  Error 1001 "DDC 053:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
39161>>>>>>>
39161>>>>>>             Case Break
39162>>>>>>             Case (iError_Num=1002)
39165>>>>>>                Error 1002 "DDC 053:Branch Site ¡˜«œ™˜å¤œ  ©«¦ Year ¡œ¤æ"
39166>>>>>>>
39166>>>>>>             Case Break
39167>>>>>>             Case (iError_Num=1003)
39170>>>>>>                Error 1003 "DDC 053:Company Code=0"
39171>>>>>>>
39171>>>>>>             Case Break
39172>>>>>>             Case (iError_Num=1004)
39175>>>>>>                Error 1004 "DDC 053:Branch Code=0"
39176>>>>>>>
39176>>>>>>             Case Break
39177>>>>>>             Case Else
39177>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
39179>>>>>>        Case End
39179>>>>>>    End_Procedure   // Operation_Not_Allowed
39180>>>>>>
39180>>>>>>
39180>>>>>>    // Update:
39180>>>>>>    // Use this message to effect changes in related-to files. The
39180>>>>>>    // Backout message should be designed to reverse the effects of this
39180>>>>>>    // message. It is invoked while the database is locked.
39180>>>>>>
39180>>>>>>    Procedure Update
39181>>>>>>        Forward Send Update
39183>>>>>>        // Insert Code Here
39183>>>>>>        Move Company.Company_Code   to Year.Company_Code
39184>>>>>>        Move Branch.Branch_Code     to Year.Branch_Code
39185>>>>>>        move branch.beto_site       to year.beto_site
39186>>>>>>
39186>>>>>>        //sos:parametrika apo sysfile?
39186>>>>>>       
39186>>>>>>       // If ((Year.Year_EntryDate-14) < Year.Year_XrhshFrom) Begin
39186>>>>>>       //     Move Year.Year_XrhshFrom to Year.Year_OpenFrom
39186>>>>>>       // End
39186>>>>>>       // Else Begin
39186>>>>>>       //     Move (Year.Year_EntryDate-14) to Year.Year_OpenFrom
39186>>>>>>       // End
39186>>>>>>      //  Move Year.Year_EntryDate      to Year.Year_OpenTo
39186>>>>>>    End_Procedure   // Update
39187>>>>>>
39187>>>>>>    // Validate_Save:
39187>>>>>>
39187>>>>>>    Function Validate_Save  Returns Integer
39188>>>>>>        Local Integer iReturnVal
39189>>>>>>        Forward Get Validate_Save  To iReturnVal
39191>>>>>>        If (Not(iReturnVal)) Begin
39193>>>>>>                 If (Year.Year_Year   = 0) Send Operation_Not_Allowed 1001
39196>>>>>>            Else If (Year.Company_Code='') Send Operation_Not_Allowed 1003
39200>>>>>>            Else If (Year.Branch_Code ='') Send Operation_Not_Allowed 1004
39204>>>>>>        End
39204>>>>>>>
39204>>>>>>        Function_Return iReturnVal
39205>>>>>>    End_Function   // Validate_Save
39206>>>>>>
39206>>>>>>
39206>>>>>>    // Define_Fields:
39206>>>>>>    // This procedure is used to set up all data-dictionary rules.
39206>>>>>>
39206>>>>>>    Procedure Define_Fields
39207>>>>>>        Forward Send Define_Fields
39209>>>>>>        //DDB-Generated-Code-Location
39209>>>>>>        //DDB-DefineFieldStart
39209>>>>>>
39209>>>>>>        Set Main_File            To Year.File_Number
39210>>>>>>        Set Cascade_Delete_State To FALSE
39211>>>>>>
39211>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39212>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39213>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39214>>>>>>
39214>>>>>>        // Parent (Server) file structure...............
39214>>>>>>        Send Add_Server_File  Branch.File_Number
39215>>>>>>
39215>>>>>>        // External (System) file structure.............
39215>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
39216>>>>>>
39216>>>>>>        // Field-based properties.......................
39216>>>>>>
39216>>>>>>        // Year.Company_Code
39216>>>>>>
39216>>>>>>        // Year.Branch_Code
39216>>>>>>
39216>>>>>>        // Year.Year_Year
39216>>>>>>        Set Field_Options          Field Year.Year_Year To DD_AUTOFIND    DD_REQUIRED   
39217>>>>>>        Set Field_Prompt_Object    Field Year.Year_Year To (SL003(Self))
39218>>>>>>        Set Key_Field_State        Field Year.Year_Year To TRUE
39219>>>>>>
39219>>>>>>        // Year.Year_Recr
39219>>>>>>        Set Field_Prompt_Object    Field Year.Year_Recr To (SL003(Self))
39220>>>>>>
39220>>>>>>        // Year.Branch_Recr
39220>>>>>>
39220>>>>>>        // Year.Year_Descr
39220>>>>>>
39220>>>>>>        // Year.Year_Isolfrom
39220>>>>>>
39220>>>>>>        // Year.Year_Isolto
39220>>>>>>
39220>>>>>>        // Year.Year_Openfrom
39220>>>>>>
39220>>>>>>        // Year.Year_Opento
39220>>>>>>
39220>>>>>>        // Year.Year_Entrydate
39220>>>>>>
39220>>>>>>        // Year.Year_Dateaa
39220>>>>>>
39220>>>>>>        // Year.Year_Xrhshfrom
39220>>>>>>
39220>>>>>>        // Year.Year_Xrhshto
39220>>>>>>
39220>>>>>>        // Year.Year_Myflimit
39220>>>>>>
39220>>>>>>        // Year.Year_Numgtypkin
39220>>>>>>
39220>>>>>>        // Year.Year_Numgarticl
39220>>>>>>
39220>>>>>>        // Year.Year_Numgmove
39220>>>>>>
39220>>>>>>        // Year.Year_Numgplan
39220>>>>>>
39220>>>>>>        // Year.Year_Numgformat
39220>>>>>>
39220>>>>>>        // Year.Year_Numgthaa
39220>>>>>>
39220>>>>>>        // Year.Year_Numgopen
39220>>>>>>
39220>>>>>>        // Year.Year_Numbtypkin
39220>>>>>>
39220>>>>>>        // Year.Year_Numbaxio
39220>>>>>>
39220>>>>>>        // Year.Year_Numbarticl
39220>>>>>>
39220>>>>>>        // Year.Year_Numbmove
39220>>>>>>
39220>>>>>>        // Year.Year_Delimiter
39220>>>>>>
39220>>>>>>        // Year.Year_Printer
39220>>>>>>
39220>>>>>>        // Year.Year_Valid_Char
39220>>>>>>
39220>>>>>>        // Year.Year_C_Code0
39220>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0 To "dbComboFormSub"
39221>>>>>>        Set Field_Value_Table      Field Year.Year_C_Code0 To (Year_Year_C_Code0_VT1(Self))
39222>>>>>>
39222>>>>>>        // Year.Year_C_Code00
39222>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00 To "dbComboFormSub"
39223>>>>>>        Set Field_Value_Table      Field Year.Year_C_Code00 To (Year_Year_C_Code00_VT1(Self))
39224>>>>>>
39224>>>>>>        // Year.Year_C_Coder
39224>>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder To "dbComboFormSub"
39225>>>>>>        Set Field_Value_Table      Field Year.Year_C_Coder To (Year_Year_C_Coder_VT1(Self))
39226>>>>>>
39226>>>>>>        // Year.Beto_Site
39226>>>>>>
39226>>>>>>        // Year.Clients_Plafon
39226>>>>>>
39226>>>>>>        // Year.Payresp_Plafon
39226>>>>>>
39226>>>>>>        // Year.Clients_Ofeilh
39226>>>>>>
39226>>>>>>        // Year.Payresp_Ofeilh
39226>>>>>>
39226>>>>>>        // Year.Working
39226>>>>>>
39226>>>>>>        //DDB-DefineFieldEnd
39226>>>>>>
39226>>>>>>        Set Main_File            To Year.File_Number
39227>>>>>>        Set Cascade_Delete_State To FALSE
39228>>>>>>
39228>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
39229>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
39230>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39231>>>>>>
39231>>>>>>        // Child (Client) file structure................
39231>>>>>>
39231>>>>>>        // Parent (Server) file structure...............
39231>>>>>>        Send Add_Server_File  Branch.File_Number
39232>>>>>>
39232>>>>>>        // Field-based properties.......................
39232>>>>>>
39232>>>>>>        // Year.Company_Code
39232>>>>>>
39232>>>>>>        // Year.Branch_Code
39232>>>>>>
39232>>>>>>        // Year.Year_Year
39232>>>>>>        Set Field_Label_Long       Field Year.Year_Year           To "•¨ã©ž"
39233>>>>>>        Set Field_Label_Short      Field Year.Year_Year           To "•¨ã©ž"
39234>>>>>>        Set Field_Options          Field Year.Year_Year           To DD_REQUIRED
39235>>>>>>        //Set Field_Prompt_Object    Field Year.Year_Year           To (SL053(Self))
39235>>>>>>
39235>>>>>>        // Year.Year_Descr
39235>>>>>>        Set Field_Label_Long       Field Year.Year_Descr          To "œ¨ š¨˜­ã •¨ã©žª"
39236>>>>>>        Set Field_Label_Short      Field Year.Year_Descr          To "œ¨.•¨ã©žª"
39237>>>>>>
39237>>>>>>        // Year.Year_C_Code0
39237>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0        To "dbComboForm"
39238>>>>>>        Set Field_Label_Long       Field Year.Year_C_Code0        To "‰ç¨ ¦ Œæ£ ©£˜"
39239>>>>>>        Set Field_Label_Short      Field Year.Year_C_Code0        To "‰¬¨.Œ¦£ ©£˜"
39240>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code0        To (Year_Year_C_Code0_VT(Self))
39240>>>>>>
39240>>>>>>        // Year.Year_C_Code00
39240>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00       To "dbComboForm"
39241>>>>>>        Set Field_Label_Long       Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
39242>>>>>>        Set Field_Label_Short      Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
39243>>>>>>        //Set Field_Options          Field Year.Year_C_Code00       To DD_REQUIRED
39243>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code00       To (Year_Year_C_Code1_VT(Self))
39243>>>>>>
39243>>>>>>        // Year.Year_C_Coder
39243>>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder        To "dbComboForm"
39244>>>>>>        Set Field_Label_Long       Field Year.Year_C_Coder        To "Œæ£ ©£˜ REPORTING"
39245>>>>>>        Set Field_Label_Short      Field Year.Year_C_Coder        To "Œæ£ ©£˜ REP"
39246>>>>>>        //Set Field_Options          Field Year.Year_C_Coder        To DD_REQUIRED
39246>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Coder        To (Year_Year_C_Coder_VT(Self))
39246>>>>>>
39246>>>>>>        // Year.Year_Isolfrom
39246>>>>>>        Set Field_Label_Long       Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
39247>>>>>>        Set Field_Label_Short      Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
39248>>>>>>
39248>>>>>>        // Year.Year_Isolto
39248>>>>>>        Set Field_Label_Long       Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
39249>>>>>>        Set Field_Label_Short      Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
39250>>>>>>
39250>>>>>>        // Year.Year_Openfrom
39250>>>>>>        Set Field_Label_Long       Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
39251>>>>>>        Set Field_Label_Short      Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
39252>>>>>>
39252>>>>>>        // Year.Year_Opento
39252>>>>>>        Set Field_Label_Long       Field Year.Year_Opento         To "„šš¨˜­âª „àª"
39253>>>>>>        Set Field_Label_Short      Field Year.Year_Opento         To "„šš¨˜­âª „àª"
39254>>>>>>
39254>>>>>>        // Year.Year_Entrydate
39254>>>>>>        Set Field_Label_Long       Field Year.Year_Entrydate      To "†£œ¨¦£ž¤å˜ „¨š˜©å˜ª"
39255>>>>>>        Set Field_Label_Short      Field Year.Year_Entrydate      To "†£/¤å˜ „¨š˜©å˜ª"
39256>>>>>>
39256>>>>>>        // Year.Year_Dateaa
39256>>>>>>
39256>>>>>>        // Year.Year_Xrhshfrom
39256>>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
39257>>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
39258>>>>>>
39258>>>>>>        // Year.Year_Xrhshto
39258>>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
39259>>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
39260>>>>>>
39260>>>>>>        // Year.Year_Myflimit
39260>>>>>>        Set Field_Label_Long       Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
39261>>>>>>        Set Field_Label_Short      Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
39262>>>>>>
39262>>>>>>        // Year.Year_Numgtypkin
39262>>>>>>        Set Field_Options          Field Year.Year_Numgtypkin     To DD_DISPLAYONLY
39263>>>>>>
39263>>>>>>        // Year.Year_Numgarticl
39263>>>>>>        Set Field_Options          Field Year.Year_Numgarticl     To DD_DISPLAYONLY
39264>>>>>>
39264>>>>>>        // Year.Year_Numgmove
39264>>>>>>        Set Field_Options          Field Year.Year_Numgmove       To DD_DISPLAYONLY
39265>>>>>>
39265>>>>>>        // Year.Year_Numgplan
39265>>>>>>        Set Field_Options          Field Year.Year_Numgplan       To DD_DISPLAYONLY
39266>>>>>>
39266>>>>>>        // Year.Year_Numgformat
39266>>>>>>        Set Field_Options          Field Year.Year_Numgformat     To DD_DISPLAYONLY
39267>>>>>>
39267>>>>>>        // Year.Year_Numgthaa
39267>>>>>>        Set Field_Options          Field Year.Year_Numgthaa       To DD_DISPLAYONLY
39268>>>>>>
39268>>>>>>        // Year.Year_Numgopen
39268>>>>>>        Set Field_Options          Field Year.Year_Numgopen       To DD_DISPLAYONLY
39269>>>>>>
39269>>>>>>        // Year.Year_Numbtypkin
39269>>>>>>        Set Field_Options          Field Year.Year_Numbtypkin     To DD_DISPLAYONLY
39270>>>>>>
39270>>>>>>        // Year.Year_Numbaxio
39270>>>>>>        Set Field_Options          Field Year.Year_Numbaxio       To DD_DISPLAYONLY
39271>>>>>>
39271>>>>>>        // Year.Year_Numbarticl
39271>>>>>>        Set Field_Options          Field Year.Year_Numbarticl     To DD_DISPLAYONLY
39272>>>>>>
39272>>>>>>        // Year.Year_Numbmove
39272>>>>>>        Set Field_Options          Field Year.Year_Numbmove       To DD_DISPLAYONLY
39273>>>>>>
39273>>>>>>        // Year.Year_Delimiter
39273>>>>>>        Set Status_Help            Field Year.Year_Delimiter      To "ƒ ˜®à¨ ©« ¡æ š ˜ «¦ Š‘ «žª •¨ã©œàª"
39274>>>>>>
39274>>>>>>        // Year.Year_Printer
39274>>>>>>
39274>>>>>>        // Year.Year_Valid_Char
39274>>>>>>
39274>>>>>>    End_Procedure    // Define_Fields
39275>>>>>>
39275>>>>>>    // Field_Defaults:
39275>>>>>>    // This procedure is used to establish default field values.
39275>>>>>>
39275>>>>>>    Procedure Field_Defaults
39276>>>>>>        Forward Send Field_Defaults
39278>>>>>>        //DDB-Generated-Code-Location
39278>>>>>>        //DDB-FieldDefaultStart
39278>>>>>>        //DDB-FieldDefaultEnd
39278>>>>>>        Set Field_Changed_Value   Field Year.Year_Delimiter      To "."
39279>>>>>>        Set Field_Changed_Value   Field Year.Year_Printer        To "LPT1:"
39280>>>>>>        Set Field_Changed_Value   Field Year.Year_Valid_Char     To "1234567890"
39281>>>>>>    End_Procedure    // Field_Defaults
39282>>>>>>
39282>>>>>>End_Class    // Year_DataDictionary
39283>>>>>>//DDB-Selection-pkg-Start
39283>>>>>>
39283>>>>>>Use Sl003.sl         // SL003
INCLUDING FILE: SL003.SL
39283>>>>>>>>//AB/ Project SL003:Year
39283>>>>>>>>//AB/ Object prj is a Lookup_Project
39283>>>>>>>>//AB/     Set ProjectName to "SL003:Year"
39283>>>>>>>>//AB/     Set ProjectFileName to "Sl003.sl"
39283>>>>>>>>
39283>>>>>>>>// Project Object Structure
39283>>>>>>>>//   SL003 is a dbModalPanelSub
39283>>>>>>>>//     Company_DD is a DataDictionary
39283>>>>>>>>//     Branch_DD is a DataDictionary
39283>>>>>>>>//     Year_DD is a DataDictionary
39283>>>>>>>>//     oSelList is a dbListSub
39283>>>>>>>>//     oOK_bn is a ButtonSub
39283>>>>>>>>//     oCancel_bn is a ButtonSub
39283>>>>>>>>//     oSearch_bn is a ButtonSub
39283>>>>>>>>
39283>>>>>>>>// Register all objects
39283>>>>>>>>Register_Object Branch_DD
39283>>>>>>>>Register_Object Company_DD
39283>>>>>>>>Register_Object oCancel_bn
39283>>>>>>>>Register_Object oOK_bn
39283>>>>>>>>Register_Object oSearch_bn
39283>>>>>>>>Register_Object oSelList
39283>>>>>>>>Register_Object SL003
39283>>>>>>>>Register_Object Year_DD
39283>>>>>>>>
39283>>>>>>>>
39283>>>>>>>>//AB-IgnoreStart
39283>>>>>>>>
39283>>>>>>>>Use DFAllEnt.pkg
39283>>>>>>>>Use dbList.Sub
39283>>>>>>>>Use Button.Sub
39283>>>>>>>>
39283>>>>>>>>
39283>>>>>>>>Use COMPANY.DD
39283>>>>>>>>Use BRANCH.DD
39283>>>>>>>>Use YEAR.DD
39283>>>>>>>>
39283>>>>>>>>//AB-IgnoreEnd
39283>>>>>>>>
39283>>>>>>>>CD_Popup_Object SL003 is a dbModalPanelSub
39302>>>>>>>>
39302>>>>>>>>    //AB-StoreTopStart
39302>>>>>>>>    Property String psFragmaCompanyCode  ""
39304>>>>>>>>    Property String psFragmaBranchCode   ""
39306>>>>>>>>    property integer pifragmaactive public 0
39308>>>>>>>>    //AB-StoreTopEnd
39308>>>>>>>>
39308>>>>>>>>    Set Minimize_Icon to FALSE
39309>>>>>>>>    Set Label to "•¨ã©œ ª"
39310>>>>>>>>    Set Size to 149 449
39311>>>>>>>>    Set Location to 4 7
39312>>>>>>>>    Set Exit_Application_Local_State to FALSE
39313>>>>>>>>    Set Modal_State to FALSE
39314>>>>>>>>
39314>>>>>>>>    //AB-DDOStart
39314>>>>>>>>
39314>>>>>>>>    Object Company_DD is a Company_DataDictionary
39316>>>>>>>>    End_Object    // Company_DD
39317>>>>>>>>
39317>>>>>>>>    Object Branch_DD is a Branch_DataDictionary
39319>>>>>>>>        Set DDO_Server to (Company_DD(self))
39320>>>>>>>>    End_Object    // Branch_DD
39321>>>>>>>>
39321>>>>>>>>    Object Year_DD is a Year_DataDictionary
39323>>>>>>>>        Set DDO_Server to (Branch_DD(self))
39324>>>>>>>>
39324>>>>>>>>        //AB-StoreStart
39324>>>>>>>>        Procedure OnConstrain
39326>>>>>>>>             String lsCompanyCode lsBranchCode
39327>>>>>>>>             integer iactive
39327>>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
39328>>>>>>>>             get pifragmaactive to iactive
39329>>>>>>>>             If (lsCompanyCode <> "") Begin
39331>>>>>>>>                Get psFragmaBranchCode  to lsBranchCode
39332>>>>>>>>                Constrain Year.Company_Code eq lsCompanyCode
39334>>>>>>>>                If (lsBranchCode <> "") Constrain Year.Branch_code eq lsBranchCode
39338>>>>>>>>             End
39338>>>>>>>>>
39338>>>>>>>>             if (iactive = 0) constrain year.working ne 1
39342>>>>>>>>        End_Procedure // OnConstrain
39343>>>>>>>>        
39343>>>>>>>>        
39343>>>>>>>>        
39343>>>>>>>>        
39343>>>>>>>>        
39343>>>>>>>>        //AB-StoreEnd
39343>>>>>>>>
39343>>>>>>>>    End_Object    // Year_DD
39344>>>>>>>>
39344>>>>>>>>    Set Main_DD to (Year_DD(self))
39345>>>>>>>>    Set Server to (Year_DD(self))
39346>>>>>>>>
39346>>>>>>>>    //AB-DDOEnd
39346>>>>>>>>
39346>>>>>>>>    Object oSelList is a dbListSub
39348>>>>>>>>        Set Main_File to Year.File_Number
39349>>>>>>>>        Set Size to 105 433
39350>>>>>>>>        Set Location to 6 6
39351>>>>>>>>
39351>>>>>>>>        Begin_Row
39354>>>>>>>>            Entry_Item Year.Year_year
39355>>>>>>>>            Entry_Item Company.Company_code
39356>>>>>>>>            Entry_Item Company.Company_name
39357>>>>>>>>            Entry_Item Branch.Branch_code
39358>>>>>>>>            Entry_Item Branch.Branch_name
39359>>>>>>>>        End_Row
39364>>>>>>>>
39364>>>>>>>>        Set Form_Width    item 0 to 36
39365>>>>>>>>        Set Header_Label  item 0 to "•¨ã©ž :          "
39366>>>>>>>>        
39366>>>>>>>>        Set Form_Width    item 1 to 71
39367>>>>>>>>        Set Header_Label  item 1 to "‰à› ¡æª „«˜ ¨å˜ª"
39368>>>>>>>>        
39368>>>>>>>>        Set Form_Width    item 2 to 136
39369>>>>>>>>        Set Header_Label  item 2 to "Ž¤¦£˜ „«˜ ¨å˜ª"
39370>>>>>>>>        
39370>>>>>>>>        Set Form_Width    item 3 to 73
39371>>>>>>>>        Set Header_Label  item 3 to "‰à› ¡æª “§¦¡/«¦ª"
39372>>>>>>>>        
39372>>>>>>>>        Set Form_Width    item 4 to 109
39373>>>>>>>>        Set Header_Label  item 4 to "Ž¤¦£˜ “§¦¡/«¦ª"
39374>>>>>>>>        
39374>>>>>>>>
39374>>>>>>>>        //AB-StoreStart
39374>>>>>>>>                                                
39374>>>>>>>>        Property String psStoreFragmaCompanyCode  ""
39376>>>>>>>>        Property String psStoreFragmaBranchCode   ""
39378>>>>>>>>        
39378>>>>>>>>        Procedure Store_Defaults
39380>>>>>>>>            forward send Store_Defaults
39382>>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
39383>>>>>>>>            Set psStoreFragmaBranchCode  to (psFragmaBranchCode(Self))
39384>>>>>>>>        end_Procedure // Store_Defaults
39385>>>>>>>>        
39385>>>>>>>>        Procedure Restore_Defaults
39387>>>>>>>>            forward send Restore_Defaults
39389>>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
39390>>>>>>>>            Set psFragmaBranchCode  to (psStoreFragmaBranchCode(self))
39391>>>>>>>>        end_Procedure // Restore_Defaults
39392>>>>>>>>        
39392>>>>>>>>        Procedure Activating
39394>>>>>>>>            Forward Send Activating
39396>>>>>>>>            Send Rebuild_Constraints to (Year_DD(self))
39397>>>>>>>>        End_Procedure // Activating
39398>>>>>>>>        
39398>>>>>>>>        
39398>>>>>>>>        
39398>>>>>>>>        //AB-StoreEnd
39398>>>>>>>>
39398>>>>>>>>    End_Object    // oSelList
39399>>>>>>>>
39399>>>>>>>>    Object oOK_bn is a ButtonSub
39401>>>>>>>>        Set Label to "&„§ ¢¦šã"
39402>>>>>>>>        Set Location to 112 280
39403>>>>>>>>
39403>>>>>>>>        //AB-StoreStart
39403>>>>>>>>        Procedure OnClick
39405>>>>>>>>            Send OK To (oSelList(current_object))
39406>>>>>>>>        End_Procedure
39407>>>>>>>>        //AB-StoreEnd
39407>>>>>>>>
39407>>>>>>>>    End_Object    // oOK_bn
39408>>>>>>>>
39408>>>>>>>>    Object oCancel_bn is a ButtonSub
39410>>>>>>>>        Set Label to "&€¡ç¨à©ž"
39411>>>>>>>>        Set Location to 112 335
39412>>>>>>>>
39412>>>>>>>>        //AB-StoreStart
39412>>>>>>>>        Procedure OnClick
39414>>>>>>>>            Send Cancel To (oSelList(current_object))
39415>>>>>>>>        End_Procedure
39416>>>>>>>>        //AB-StoreEnd
39416>>>>>>>>
39416>>>>>>>>    End_Object    // oCancel_bn
39417>>>>>>>>
39417>>>>>>>>    Object oSearch_bn is a ButtonSub
39419>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
39420>>>>>>>>        Set Location to 112 390
39421>>>>>>>>
39421>>>>>>>>        //AB-StoreStart
39421>>>>>>>>        Procedure OnClick
39423>>>>>>>>            Send Search To (oSelList(current_object))
39424>>>>>>>>        End_Procedure
39425>>>>>>>>        //AB-StoreEnd
39425>>>>>>>>
39425>>>>>>>>    End_Object    // oSearch_bn
39426>>>>>>>>
39426>>>>>>>>
39426>>>>>>>>    //AB-StoreStart
39426>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39427>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39428>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39429>>>>>>>>    
39429>>>>>>>>    
39429>>>>>>>>    
39429>>>>>>>>    //AB-StoreEnd
39429>>>>>>>>
39429>>>>>>>>CD_End_Object    // SL003
39431>>>>>>>>>
39431>>>>>>>>
39431>>>>>>>>//AB/ End_Object    // prj
39431>>>>>>
39431>>>>>>//DDB-Selection-pkg-End
39431>>>>>>//DDB-FileEnd
39431>>>>
39431>>>>    //AB-IgnoreEnd
39431>>>>
39431>>>>    Object oSelectYear is a dbModalPanelSub
39433>>>>
39433>>>>        //AB-StoreTopStart
39433>>>>
39433>>>>        Property String  psSelectedYearRecr  ''
39435>>>>        Property Integer piChangeState False
39437>>>>
39437>>>>        //AB-StoreTopEnd
39437>>>>
39437>>>>        Set Minimize_Icon to FALSE
39438>>>>        Set Label to "„§ ¢¦šã „«˜ ¨œå˜ª - “§¦¡˜«˜©«ã£˜«¦ª - •¨ã©žª"
39439>>>>        Set Size to 111 372
39440>>>>        Set Location to 60 40
39441>>>>        Set Color to 12232306
39442>>>>        Set Popup_State to TRUE
39443>>>>
39443>>>>        //AB-DDOStart
39443>>>>
39443>>>>        Object Company_DD is a Company_DataDictionary
39445>>>>
39445>>>>            //AB-StoreStart
39445>>>>            Set Foreign_Field_Options DD_KEYFIELD                   to DD_Clear_Field_Options DD_FindReq
39446>>>>            Set Foreign_Field_Options DD_INDEXFIELD                 to DD_Clear_Field_Options DD_FindReq
39447>>>>            Set Foreign_Field_Options Field Company.Company_Name    to DD_DisplayOnly
39448>>>>
39448>>>>
39448>>>>
39448>>>>            //AB-StoreEnd
39448>>>>
39448>>>>        End_Object    // Company_DD
39449>>>>
39449>>>>        Object Branch_DD is a Branch_DataDictionary
39451>>>>            Set DDO_Server to (Company_DD(self))
39452>>>>
39452>>>>            //AB-StoreStart
39452>>>>            Set Foreign_Field_Options DD_KEYFIELD   to DD_Clear_Field_Options DD_FindReq
39453>>>>            Set Foreign_Field_Options DD_INDEXFIELD to DD_Clear_Field_Options DD_FindReq
39454>>>>
39454>>>>            Set Foreign_Field_Options DD_KEYFIELD   to DD_AutoFind_GE
39455>>>>            Set Foreign_Field_Options DD_INDEXFIELD to DD_AutoFind_GE
39456>>>>
39456>>>>            Set Foreign_Field_Options Field Branch.Branch_Name to DD_DisplayOnly
39457>>>>            //AB-StoreEnd
39457>>>>
39457>>>>        End_Object    // Branch_DD
39458>>>>
39458>>>>        Object Year_DD is a Year_DataDictionary
39460>>>>            Set DDO_Server to (Branch_DD(self))
39461>>>>
39461>>>>            //AB-StoreStart
39461>>>>
39461>>>>            Set Field_Options Field Year.Year_Descr to DD_DisplayOnly
39462>>>>            Set Field_Options Field Year.Year_Year to DD_AutoFind_GE
39463>>>>
39463>>>>            Function Validate_Delete Returns Integer
39465>>>>                Function_Return 1
39466>>>>            End_Function
39467>>>>
39467>>>>            //AB-StoreEnd
39467>>>>
39467>>>>        End_Object    // Year_DD
39468>>>>
39468>>>>        Set Main_DD to (Year_DD(self))
39469>>>>        Set Server to (Year_DD(self))
39470>>>>
39470>>>>        //AB-DDOEnd
39470>>>>
39470>>>>        Object Company_Company_Code is a dbFormSub
39472>>>>            Entry_Item Company.Company_code
39473>>>>            Set Size to 13 71
39474>>>>            Set Location to 9 112
39475>>>>            Set Label_Col_Offset to 2
39476>>>>            Set Label_Justification_Mode to jMode_Right
39477>>>>            Set Prompt_Button_Mode to pb_PromptOn
39478>>>>            Set Auto_Clear_Deo_State to FALSE
39479>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39480>>>>
39480>>>>            //AB-StoreStart
39480>>>>
39480>>>>            Set Prompt_Object to (sl001(Self))
39481>>>>
39481>>>>
39481>>>>            //AB-StoreEnd
39481>>>>
39481>>>>        End_Object    // Company_Company_Code
39482>>>>
39482>>>>        Object Company_Company_Name is a dbFormSub
39484>>>>            Entry_Item Company.Company_name
39485>>>>            Set Size to 13 168
39486>>>>            Set Location to 9 188
39487>>>>            Set Label_Col_Offset to 2
39488>>>>            Set Label_Justification_Mode to jMode_Right
39489>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39490>>>>
39490>>>>            //AB-StoreStart
39490>>>>
39490>>>>            //AB-StoreEnd
39490>>>>
39490>>>>        End_Object    // Company_Company_Name
39491>>>>
39491>>>>        Object Branch_Branch_Code is a dbFormSub
39493>>>>            Entry_Item Branch.Branch_code
39494>>>>            Set Size to 13 71
39495>>>>            Set Location to 23 112
39496>>>>            Set Label_Col_Offset to 2
39497>>>>            Set Label_Justification_Mode to jMode_Right
39498>>>>            Set Prompt_Button_Mode to pb_PromptOn
39499>>>>            Set Auto_Clear_Deo_State to FALSE
39500>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39501>>>>
39501>>>>            //AB-StoreStart
39501>>>>            Set Prompt_Object to (sl002(Self))
39502>>>>
39502>>>>            Procedure Prompt_CallBack Integer hPrompt
39504>>>>                string lsCompanyCode
39505>>>>                Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
39506>>>>                Set psFragmaCompanyCode of hPrompt to lsCompanyCode
39507>>>>            End_Procedure
39508>>>>
39508>>>>
39508>>>>
39508>>>>
39508>>>>            //AB-StoreEnd
39508>>>>
39508>>>>        End_Object    // Branch_Branch_Code
39509>>>>
39509>>>>        Object Branch_Branch_Name is a dbFormSub
39511>>>>            Entry_Item Branch.Branch_name
39512>>>>            Set Size to 13 168
39513>>>>            Set Location to 23 188
39514>>>>            Set Label_Justification_Mode to jMode_Right
39515>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39516>>>>
39516>>>>            //AB-StoreStart
39516>>>>
39516>>>>
39516>>>>            //AB-StoreEnd
39516>>>>
39516>>>>        End_Object    // Branch_Branch_Name
39517>>>>
39517>>>>        Object Year_Year_Year is a dbFormSub
39519>>>>            Entry_Item Year.Year_year
39520>>>>            Set Size to 13 71
39521>>>>            Set Location to 37 112
39522>>>>            Set Label_Col_Offset to 2
39523>>>>            Set Label_Justification_Mode to jMode_Right
39524>>>>            Set Prompt_Button_Mode to pb_PromptOn
39525>>>>            Set Auto_Clear_Deo_State to FALSE
39526>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39527>>>>
39527>>>>            //AB-StoreStart
39527>>>>            Set Prompt_Object to (sl003(Self))
39528>>>>
39528>>>>            Procedure Prompt_CallBack Integer hPrompt
39530>>>>                String lsCompanyCode lsBranchCode
39531>>>>                integer icheck
39531>>>>                get checked_state of (chkxr(self)) to icheck
39532>>>>                Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
39533>>>>                Get Field_Current_Value of Branch_DD  Field Branch.Branch_Code   to lsBranchCode
39534>>>>                Set psFragmaCompanyCode of hPrompt to lsCompanyCode
39535>>>>                Set psFragmaBranchCode  of hPrompt to lsBranchCode
39536>>>>                set pifragmaactive      of hPrompt to icheck
39537>>>>            End_Procedure
39538>>>>
39538>>>>
39538>>>>
39538>>>>
39538>>>>
39538>>>>
39538>>>>            //AB-StoreEnd
39538>>>>
39538>>>>        End_Object    // Year_Year_Year
39539>>>>
39539>>>>        Object Year_Year_Descr is a dbFormSub
39541>>>>            Entry_Item Year.Year_descr
39542>>>>            Set Size to 13 168
39543>>>>            Set Location to 37 188
39544>>>>            Set Label_Col_Offset to 2
39545>>>>            Set Label_Justification_Mode to jMode_Right
39546>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39547>>>>
39547>>>>            //AB-StoreStart
39547>>>>
39547>>>>            //AB-StoreEnd
39547>>>>
39547>>>>        End_Object    // Year_Year_Descr
39548>>>>
39548>>>>        Object Year_Year_Entrydate is a dbFormSub
39550>>>>            Entry_Item Year.Year_entrydate
39551>>>>            Set Size to 13 71
39552>>>>            Set Location to 52 112
39553>>>>            Set Label_Col_Offset to 2
39554>>>>            Set Label_Justification_Mode to jMode_Right
39555>>>>            Set Auto_Clear_Deo_State to FALSE
39556>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39557>>>>        End_Object    // Year_Year_Entrydate
39558>>>>
39558>>>>        Object oOk_bn is a ButtonSub
39560>>>>            Set Label to "€§¦›¦®ã (F2)"
39561>>>>            Set Size to 17 54
39562>>>>            Set Location to 74 188
39563>>>>            Set Form_FontHeight Item 0 to 14
39564>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39565>>>>
39565>>>>            //AB-StoreStart
39565>>>>
39565>>>>            Procedure OnClick
39567>>>>                Delegate Send AcceptTheValues
39569>>>>            End_Procedure
39570>>>>
39570>>>>
39570>>>>
39570>>>>
39570>>>>            //AB-StoreEnd
39570>>>>
39570>>>>        End_Object    // oOk_bn
39571>>>>
39571>>>>        Object oCancel_bn is a ButtonSub
39573>>>>            Set Label to "„¥¦›¦ª "
39574>>>>            Set Size to 17 54
39575>>>>            Set Location to 74 302
39576>>>>            Set Form_FontHeight Item 0 to 14
39577>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39578>>>>
39578>>>>            //AB-StoreStart
39578>>>>
39578>>>>            Procedure OnClick
39580>>>>               Send Exit_Application to oSelectYear
39581>>>>            End_Procedure
39582>>>>
39582>>>>
39582>>>>
39582>>>>            //AB-StoreEnd
39582>>>>
39582>>>>        End_Object    // oCancel_bn
39583>>>>
39583>>>>        Object otxtCompany is a TextBoxSub
39585>>>>            Set Label to "„«˜ ¨œå˜"
39586>>>>            Set Auto_Size_State to FALSE
39587>>>>            Set Color to 12232306
39588>>>>            Set FontSize to 14 8
39589>>>>            Set Location to 9 10
39590>>>>            Set Size to 10 35
39591>>>>            Set FontWeight to 600
39592>>>>            Set TypeFace to "MS Sans Serif"
39593>>>>            Set Enabled_State to TRUE
39594>>>>        End_Object    // otxtCompany
39595>>>>
39595>>>>        Object otxtBranch is a TextBoxSub
39597>>>>            Set Label to "“§¦¡˜«˜©«ã£˜«˜"
39598>>>>            Set Auto_Size_State to FALSE
39599>>>>            Set Color to 12232306
39600>>>>            Set FontSize to 14 8
39601>>>>            Set Location to 23 10
39602>>>>            Set Size to 10 63
39603>>>>            Set FontWeight to 600
39604>>>>            Set TypeFace to "MS Sans Serif"
39605>>>>            Set Enabled_State to TRUE
39606>>>>        End_Object    // otxtBranch
39607>>>>
39607>>>>        Object otxtYear is a TextBoxSub
39609>>>>            Set Label to "•¨ã©ž :          "
39610>>>>            Set Auto_Size_State to FALSE
39611>>>>            Set Color to 12232306
39612>>>>            Set FontSize to 14 8
39613>>>>            Set Location to 38 10
39614>>>>            Set Size to 10 40
39615>>>>            Set FontWeight to 600
39616>>>>            Set TypeFace to "MS Sans Serif"
39617>>>>            Set Enabled_State to TRUE
39618>>>>        End_Object    // otxtYear
39619>>>>
39619>>>>        Object otxtWorkingDay is a TextBoxSub
39621>>>>            Set Label to "†£/¤å˜ „¨š˜©å˜ª"
39622>>>>            Set Auto_Size_State to FALSE
39623>>>>            Set Color to 12232306
39624>>>>            Set FontSize to 14 8
39625>>>>            Set Location to 52 10
39626>>>>            Set Size to 10 63
39627>>>>            Set FontWeight to 600
39628>>>>            Set TypeFace to "MS Sans Serif"
39629>>>>            Set Enabled_State to TRUE
39630>>>>        End_Object    // otxtWorkingDay
39631>>>>
39631>>>>        Object otxtWorkingDay is a TextBoxSub
39633>>>>            Set Label to "Ž¢œª ¦  ®¨ã©œ ª"
39634>>>>            Set Auto_Size_State to FALSE
39635>>>>            Set Color to 12232306
39636>>>>            Set FontSize to 14 8
39637>>>>            Set Location to 79 9
39638>>>>            Set Size to 10 63
39639>>>>            Set FontWeight to 600
39640>>>>            Set TypeFace to "MS Sans Serif"
39641>>>>            Set Enabled_State to TRUE
39642>>>>        End_Object    // otxtWorkingDay
39643>>>>
39643>>>>        Object chkxr is a CheckBoxSub
39645>>>>            Set Size to 13 22
39646>>>>            Set Location to 79 113
39647>>>>            Set Color to 12232306
39648>>>>        End_Object    // chkxr
39649>>>>
39649>>>>
39649>>>>        //AB-StoreStart
39649>>>>
39649>>>>        On_Key Key_Ctrl+Key_X Send None
39650>>>>        On_Key Key_Alt+Key_X  Send None
39651>>>>
39651>>>>        Function ifSelect_Xrhsh Returns String
39653>>>>            String  lsRecord_id
39654>>>>            Set psSelectedYearRecr to gs_Selected_Year_Recr
39655>>>>            send popup_modal
39656>>>>            Get psSelectedYearRecr to lsRecord_id
39657>>>>            Function_return lsRecord_Id
39658>>>>        End_Function
39659>>>>
39659>>>>        Procedure AcceptTheValues
39661>>>>            Integer iRetVal liYearDD liCompanyDD liBranchDD
39662>>>>            String ldcheck lsYearRecr lsSite sCname sBname sYname sNom1 sNom2 sNom3
39662>>>>            Date ldYearXrhsh_From ldYearXrhsh_To
39662>>>>            Move Year_DD to liYearDD
39663>>>>            Get Field_Current_Value of liYearDD Field Year.Year_EntryDate to ldcheck
39664>>>>            if (ldcheck = "") ;                Get Message_Box "ƒœ¤ œ§ ¢â¥˜«œ ©à©«ã ž£œ¨¦£ž¤å˜." "¨¦©¦®ã" MB_OK MB_ICONWARNING to iRetVal
39667>>>>            else begin
39668>>>>                Get Field_Current_Value of liYearDD Field Year.Year_XrhshFrom   to ldYearXrhsh_From
39669>>>>                Get Field_Current_Value of liYearDD Field Year.Year_XrhshTo     to ldYearXrhsh_To
39670>>>>                if ((ldcheck < ldYearXrhsh_From) or (ldcheck > ldYearXrhsh_To)) ;                    Get Message_Box "†£œ¨/¤å˜ œ¡«éª ¦¨åà¤" "¨¦©¦®ã" MB_OK MB_ICONWARNING to iRetVal
39673>>>>                else begin
39674>>>>                    Move Company_DD to liCompanyDD
39675>>>>                    Move Branch_DD  to liBranchDD
39676>>>>                    Move Year_DD    to liYearDD
39677>>>>                    send Request_Save to liYearDD
39678>>>>                    Get Field_Current_Value of liCompanyDD Field Company.Company_Code to gs_Selected_Company_Code
39679>>>>                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_Code   to gs_Selected_Branch_Code
39680>>>>
39680>>>>                    Get Field_Current_Value of liBranchDD  Field Branch.Beto_Site   to gs_Selected_Beto_Site
39681>>>>
39681>>>>                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_Site   to lsSite
39682>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_Year       to gi_Selected_Year
39683>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_Recr       to lsYearRecr
39684>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_C_Code0    to sNom1
39685>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_C_Code00   to sNom2
39686>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_C_CodeR    to sNom3
39687>>>>
39687>>>>                    Get Field_Current_Value of liCompanyDD Field Company.Company_Name to sCname
39688>>>>                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_name   to sBname
39689>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_Descr      to sYname
39690>>>>
39690>>>>
39690>>>>                    Local String    sCode
39690>>>>                    Local Integer   iBreak
39690>>>>                    Move 0 to iBreak
39691>>>>                    Clear Nomisma
39692>>>>                    Find Gt Nomisma.Recnum
39693>>>>>
39693>>>>                    While ((Found=1) And (iBreak=0))
39697>>>>                        If (Nomisma.Einai_Euro='1') Begin
39699>>>>                            Move 1 to iBreak
39700>>>>                            Move Nomisma.Nomisma_Code to sCode
39701>>>>                        End
39701>>>>>
39701>>>>                        If (Not(iBreak)) Find Gt Nomisma.Recnum
39704>>>>                    Loop
39705>>>>>
39705>>>>                    Move (Trim(sCode)) to sCode
39706>>>>
39706>>>>
39706>>>>                    Reread SysCurXR
39710>>>>                    Move gs_Selected_Company_Code   to SysCurXR.Company_Code
39711>>>>                    Move gs_Selected_beto_site      to SysCurXR.beto_site
39712>>>>                    Move gs_Selected_Branch_Code    to SysCurXR.Branch_Code
39713>>>>                    Move gi_Selected_Year           to SysCurXR.Year_Year
39714>>>>                    Move lsYearRecr                 to SysCurXR.Year_Recr
39715>>>>                    Move lsSite                     to SysCurXR.Branch_Site
39716>>>>
39716>>>>                    Move sCname                     to SysCurXR.Company_Name
39717>>>>                    Move sBname                     to SysCurXR.Branch_Name
39718>>>>                    Move sYname                     to SysCurXR.Year_Descr
39719>>>>
39719>>>>                    Move ldYearXrhsh_From           to SysCurXr.Year_XrhshFrom
39720>>>>                    Move ldYearXrhsh_To             to SysCurXr.Year_XrhshTo
39721>>>>
39721>>>>                    Move  (Trim(sNom1))             to SysCurXR.C_Code0
39722>>>>                    Move  (Trim(sNom2))             to SysCurXR.C_Code00
39723>>>>                    Move  (Trim(sNom3))             to SysCurXR.C_CodeR
39724>>>>
39724>>>>                    Move sCode                      to SysCurXR.Euro_Code
39725>>>>
39725>>>>                    Saverecord SysCurXR
39726>>>>                    Unlock
39727>>>>>
39727>>>>
39727>>>>                    Move lsYearRecr                 to gs_Selected_Year_Recr
39728>>>>                    Set psSelectedYearRecr          to lsYearRecr
39729>>>>
39729>>>>                    Send Stop_Modal_ui
39730>>>>
39730>>>>                    Set kEnter_Next_State of ghoWorkSpace to TRUE
39731>>>>                End
39731>>>>>
39731>>>>            end
39731>>>>>
39731>>>>        End_Procedure
39732>>>>
39732>>>>        Set Locate_Mode to Center_On_Screen
39733>>>>
39733>>>>        On_Key KCancel      Send KeyAction to (oCancel_Bn(Self))
39734>>>>        On_Key KClose_Panel Send KeyAction to (oCancel_Bn(Self))
39735>>>>        On_Key Ksave_record send KeyAction to (oOK_Bn(Self))
39736>>>>
39736>>>>        On_Key Key_alt+Key_A send KeyAction to (oOK_Bn(Self))
39737>>>>        On_Key Key_alt+Key_Q send KeyAction to (oCancel_Bn(Self))
39738>>>>
39738>>>>
39738>>>>
39738>>>>
39738>>>>
39738>>>>
39738>>>>
39738>>>>        //AB-StoreEnd
39738>>>>
39738>>>>    End_Object    // oSelectYear
39739>>>>
39739>>>>
39739>>>>    //AB-StoreStart
39739>>>>
39739>>>>
39739>>>>    //AB-StoreEnd
39739>>>>
39739>>>>//AB/     End_Object    // prj
39739>>
39739>>Procedure Epelexe_Xrhsh
39740>>    Integer liCompanyDD liBranchDD liYearDD liYear liModalId
39741>>    String lsCompany lsBranch lsWhatXrhsh
39741>>    Move oSelectYear to liModalId
39742>>    Get ifSelect_Xrhsh Of liModalId to lsWhatXrhsh
39743>>    if (Trim(lsWhatXrhsh)='') Send Exit_Application
39746>>End_Procedure
39747>>
39747>>Procedure Allaxe_Xrhsh
39748>>    Integer rVal liModalId iID
39749>>    If (Close_All_Views(Self,True)=0) Begin
39751>>        Move oSelectYear to liModalId
39752>>        Send Epelexe_Xrhsh
39753>>    End
39753>>>
39753>>End_Procedure
39754>>
39754>>On_Key Key_Ctrl+Key_X Send Allaxe_Xrhsh
39755>>On_Key Key_Alt+Key_X  Send Allaxe_Xrhsh
39756>>
39756>>Send Epelexe_Xrhsh
39757>>//------------------------------
39757>>
39757>
39757>//AB-StoreTopEnd
39757>
39757>
39757>Object Main is a Panelsub
39759>    Set Label To "#FEM"
39760>    Use Timol.mn //  Menu package.
INCLUDING FILE: TIMOL.MN
39760>>>
39760>>>Use Menu_Sec.Sub
39760>>>
39760>>>
39760>>>DFCreate_Menu Main_Menu 
39763>>>
39763>>>Property String psMenuModule Public ''           
39765>>>
39765>>>  
39765>>>  dfcreate_menu " — Š † ‘ „ ˆ ‘ " sales_popupmenu is a viewpopupmenu
39769>>>
39769>>>    on_item "ƒ ˜®œå¨ ©ž ˜¨˜©«˜« ¡é¤ é¢ž©žª"             send activate_particle
39770>>>    on_item "‹˜ ¡æª â¢œš®¦ª ¡˜  ¦¨ ©« ¡ã œ¡«ç§à©ž §˜¨˜©«˜« ¡é¤ "  send activate_v14a
39771>>>
39771>>>    Procedure OnInitMenu
39773>>>       Forward Send OnInitMenu
39775>>>       Set psMenuModule to '01'
39776>>>       Move '01' to gs_Module_Code
39777>>>    End_Procedure
39778>>>
39778>>>  END_PULL_DOWN // Polhseis
39780>>>
39780>>>  dfcreate_menu "€ ‚ Ž  „ ‘ " purchase_popupmenu is a viewpopupmenu
39784>>>
39784>>>    on_item "ƒ ˜®œå¨ ©ž ˜¨˜©«˜« ¡é¤ €š¦¨é¤"              send activate_particle
39785>>>
39785>>>    Procedure OnInitMenu
39787>>>       Forward Send OnInitMenu
39789>>>       Set psMenuModule to '02'
39790>>>       Move '02' to gs_Module_Code
39791>>>    End_Procedure 
39792>>>    
39792>>>  END_PULL_DOWN
39794>>>
39794>>>
39794>>>  dfcreate_menu "”¦¨¦¢¦š ¡æª „¡«¬§à«ãª" FHM_popupmenu is a viewpopupmenu
39798>>>
39798>>>    on_item "‰¢œå© £¦ †£â¨˜ª (…)"   Send Activate_vwZ
39799>>>    on_item ""                      Send None
39800>>>    on_item "‘«¦ ®œå˜"              Send Show_CTL
39801>>>
39801>>>    Procedure OnInitMenu
39803>>>       Forward Send OnInitMenu
39805>>>       Set psMenuModule to '02'
39806>>>       Move '02' to gs_Module_Code
39807>>>    End_Procedure 
39808>>>    
39808>>>
39808>>>  END_PULL_DOWN
39810>>>
39810>>>  End_Menu // Main_Menu
39812>>>
39812>>>    Procedure Show_CTL
39814>>>        Integer isOK  
39815>>>        Get fiShowCTL to isOK
39816>>>    End_Procedure
39817>>>       
39817>>>  
39817>>>Register_Object Client_Area
39817>>>
39817>    
39817>    Use Ewbtnbar.pkg //  Tool-Bar object.
INCLUDING FILE: EWBTNBAR.PKG
39817>>>// 23/07/1998 SPY
39817>>>
39817>>>Use DFMainBt  // dfMain_ButtonBar
INCLUDING FILE: DFMAINBT.PKG
39817>>>>>//-------------------------------------------------------------------------
39817>>>>>// DFMainBt.pkg - DfMain_ButtonBar class
39817>>>>>//
39817>>>>>//
39817>>>>>// 07/23/96 JJT - New Class names
39817>>>>>//-------------------------------------------------------------------------
39817>>>>>
39817>>>>>Use DfPanel // dfapp_buttonbar
39817>>>>>
39817>>>>>Class ToolBar is a AppToolBar
39818>>>>>
39818>>>>>    Function Is_Function Integer MsgId Integer ObjId Integer DelegateFg Returns Integer
39819>>>>>      Local integer rval MainObj#
39820>>>>>      Get Main_Panel_id to MainObj#
39821>>>>>      If (ObjId>Desktop AND MainObj#) ;         Get Is_Function of MainObj# MsgId ObjId DelegateFg to rVal
39824>>>>>      Function_Return rVal
39825>>>>>    End_Function
39826>>>>>
39826>>>>>    Procedure Redirect_Button_Message integer Itm
39827>>>>>         Local integer Msg# Aux# rval Understood
39828>>>>>         If (Shadow_State(Current_Object,itm)) Procedure_Return
39831>>>>>         Get Message   item itm  to Msg#
39832>>>>>         Get Aux_Value item itm  to Aux#
39833>>>>>         If Msg# Begin
39835>>>>>           If Aux# eq 0 Begin
39837>>>>>              Get Focus to Aux#
39838>>>>>              Get Is_Function Get_DEO_Object Aux# TRUE to Understood
39839>>>>>              If Not Understood Move 0 to Aux#
39842>>>>>           End
39842>>>>>>
39842>>>>>           If Aux# Get Msg# of Aux# to rval
39845>>>>>           Procedure_return rval
39846>>>>>         end
39846>>>>>>
39846>>>>>    End_Procedure // Redirect_Message
39847>>>>>
39847>>>>>End_Class
39848>>>>>
39848>>>>>
39848>>>Use Dates.utl
39848>>>
39848>>>Register_Object CalendarEz
39848>>>Register_Procedure Activate_Sort_Vw
39848>>>Register_Procedure DoPrintScreen
39848>>>
39848>>>Procedure doPopupCalendar
39850>>>    Send request_popup to (Popup_calendar(Self))
39851>>>End_Procedure
39852>>>
39852>>>Procedure doRebuild
39854>>>    Send Activate_Sort_Vw To (Client_Area(Main(Self)))
39855>>>End_Procedure
39856>>>
39856>>>Procedure doExit_Application
39858>>>    send Exit_Application to desktop
39859>>>End_Procedure
39860>>>
39860>>>Procedure DoRefresh_Grids
39862>>>    Integer liObj
39863>>>    
39863>>>    Move (Focus(Desktop)) to liObj
39864>>>    If (Base_class(liObj) = list_class) Send beginning_of_data to liObj
39867>>>End_Procedure
39868>>>
39868>>>Procedure DoPopupCalc
39870>>>    Runprogram background "Calc.exe"
39871>>>End_Procedure
39872>>>
39872>>>Procedure DoPopupSetup
39874>>>    string sRunPath
39875>>>    get_profile_string "workspaces\ad" "dfparamspath" to sRunPath
39878>>>    append sRunPath "\dfparams"
39879>>>    send DoRunApplication sRunPath
39880>>>End_Procedure
39881>>>
39881>>>Object oMyWinPrint is an DF_PRINTER
39883>>>    Procedure DFPrint
39885>>>        Integer iRetVal
39886>>>        Get DFGetPrintDialogFlags To iRetVal
39887>>>        If iRetVal Begin
39889>>>            Send DFPrintDoc
39890>>>            Send DFClearDoc
39891>>>        End
39891>>>>
39891>>>    End_Procedure
39892>>>    Move Current_Object to WinPrintId
39893>>>End_Object
39894>>>
39894>>>
39894>>>Procedure DoPrint
39896>>>    Send DfPrint to (oMyWinPrint(Self))
39897>>>End_Procedure
39898>>>
39898>>>Procedure DoShowPropertiesPage
39900>>>   If (Close_All_Views(Self,True)=0) Send Activate_View to (piPropertiesObjectId(self))
39903>>>End_Procedure
39904>>>
39904>>>   //  Button bar object.
39904>>>//
39904>>>Object Tool_Bar is a ToolBar     
39906>>>    
39906>>>    Property Integer piOutputDestination Public 0
39908>>>
39908>>>    Send ImageList_Add 'bgn.bmp'      // 0
39909>>>    Send ImageList_Add 'end.bmp'      // 1
39910>>>    Send ImageList_Add 'next.bmp'     // 2
39911>>>    Send ImageList_Add 'prev.bmp'     // 3
39912>>>    Send ImageList_Add 'clr.bmp'      // 4
39913>>>    Send ImageList_Add 'clra.bmp'     // 5
39914>>>    Send ImageList_Add 'calend.bmp'   // 6
39915>>>    Send ImageList_Add 'Abfile.bmp'   // 7
39916>>>    Send ImageList_Add 'Dbexplor.bmp' // 8
39917>>>    Send ImageList_Add 'Ddb_find.bmp' // 9
39918>>>    Send ImageList_Add 'Abup.bmp'     // 10
39919>>>    Send ImageList_Add 'Arrow2.bmp'   // 11
39920>>>    Send ImageList_Add 'Save1.bmp'    // 12
39921>>>    Send ImageList_Add 'Exitm.bmp'    // 13
39922>>>    Send ImageList_Add 'include.bmp'  // 14
39923>>>    Send ImageList_Add 'Zoom_m1.bmp'  // 15
39924>>>    Send ImageList_Add 'Zoom2mg.bmp'  // 16
39925>>>    Send ImageList_Add 'DbeRefrh.Bmp' // 17
39926>>>    Send ImageList_Add 'calc1.bmp'    // 18
39927>>>    Send ImageList_Add 'print_m0.bmp' // 19
39928>>>    Send ImageList_Add 'Abcodeed.bmp' // 20
39929>>>    Send ImageList_Add 'vuur.bmp'     // 21
39930>>>    //Send ImageList_Add 'wmsui329.bmp' // 22
39930>>>
39930>>>    send Add_button (ico_user+0) msg_beginning_of_data
39931>>>    Send Add_ToolTip "€¨®ã €¨®œå¦¬ (Ctrl+Home)"
39932>>>    Set  Status_Help To '¨å©¡œ  «ž¤ ¨é«ž „šš¨˜­ã (Ctrl+Home)'
39933>>>
39933>>>    send Add_button (ico_user+3) msg_find_previous
39934>>>    Send Add_ToolTip "¨¦žš¦ç£œ¤ž „šš¨˜­ã (F7)"
39935>>>    Set  Status_Help To '¨å©¡œ  «ž¤ ¨¦žš¦ç£œ¤ž „šš¨˜­ã (F7)'
39936>>>
39936>>>    send Add_button (ico_user+10) msg_find_GE
39937>>>    Send Add_ToolTip "€¤˜ã«ž©ž (F9)"
39938>>>    Set  Status_Help To '¨å©¡œ  «ž¤ „šš¨˜­ã á©œ  «à¤ ‘«¦ ®œåà¤ (F9)'
39939>>>
39939>>>    send Add_button (ico_user+2) msg_find_next
39940>>>    Send Add_ToolTip "„§æ£œ¤ž „šš¨˜­ã (F8)"
39941>>>    Set  Status_Help To '¨å©¡œ  «ž¤ „§æ£œ¤ž „šš¨˜­ã (F8)'
39942>>>
39942>>>    send Add_button (ico_user+1) msg_end_of_data
39943>>>    Send Add_ToolTip "’â¢¦ª €¨®œå¦¬ (Ctrl+End)"
39944>>>    Set  Status_Help To '¨å©¡œ  «ž¤ ’œ¢œ¬«˜å˜ „šš¨˜­ã (Ctrl+End)'
39945>>>
39945>>>    send Add_space
39946>>>
39946>>>    send Add_button ico_std_find msg_prompt
39947>>>    Send Add_ToolTip "Šå©«˜ (F4)"
39948>>>    Set  Status_Help To '‹§¦¨œåª ¤˜ ›œåª æ¢œª « ª › ˜Ÿâ© £œª œ§ ¢¦šâª (F4)'
39949>>>
39949>>>    send Add_button (ico_User+15) msg_zoom
39950>>>    Send Add_ToolTip "Z¦¦£ (Alt+F9)"
39951>>>    Set  Status_Help To '‹§¦¨œåª ¤˜ ›œåª §¨æ©Ÿœ«œª §¢ž¨¦­¦¨åœª (Alt+F9)'
39952>>>
39952>>>    send Add_button (ico_user+6) msg_doPopupCalendar
39953>>>    Send Add_ToolTip "†£œ¨¦¢æš ¦"
39954>>>    Set  Status_Help To "†£œ¨¦¢æš ¦ ƒ ˜Ÿâ© £¦ £æ¤¦ ©œ §œ›å˜-†£œ¨¦£ž¤åœª"
39955>>>
39955>>>    send Add_space
39956>>>
39956>>>    send Add_button (ico_user+4) msg_request_clear
39957>>>    Send Add_ToolTip "€¡ç¨à©ž (F5)"
39958>>>    Set  Status_Help To '€¡ç¨à©ž «¨â®¦¬©˜ª œšš¨˜­ãª / ¨æ©Ÿœ©ž ¤â˜ª œšš¨˜­ãª (F5)'
39959>>>
39959>>>    send Add_button (ico_user+5) msg_request_clear_all
39960>>>    Send Add_ToolTip "Ž¢ ¡ã €¡ç¨à©ž (Ctrl+F5)"
39961>>>    Set  Status_Help To 'Ž¢ ¡ã ˜¡ç¨à©ž «à¤ ›œ›¦£â¤à¤ ©«ž¤ æ¯ž §¦¬ › ˜®œ ¨åœ«˜  ¦ ®¨ã©«žª (Ctrl+F5)'
39962>>>
39962>>>    send Add_button (ico_user+17) msg_DoRefresh_Grids
39963>>>    Send Add_ToolTip "€¤˜¤âà©ž ƒœ›¦£â¤à¤ (Ctrl+Home)"
39964>>>    Set  Status_Help To '€¤˜¤œé¤œ  «˜ ›œ›¦£â¤˜ ©«˜ Grids (Ctrl+Home)'
39965>>>
39965>>>    send Add_space
39966>>>
39966>>>    send Add_button ico_std_filesave msg_request_save
39967>>>    Send Add_ToolTip "„šš¨˜­ã+€¡ç¨à©ž (F2)"
39968>>>    Set  Status_Help To '‘éœ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã ©«¦ ˜¨®œå¦ (F2)'
39969>>>
39969>>>    send Add_button ico_std_delete msg_request_delete
39970>>>    Send Add_ToolTip "ƒ ˜š¨˜­ã (Shift+F2)"
39971>>>    Set  Status_Help To 'ƒ ˜š¨á­œ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã ˜§æ «¦ ˜¨®œå¦ (Shift+F2)'
39972>>>
39972>>>    send Add_button (ico_user+12) msg_request_save_no_clear
39973>>>    Send Add_ToolTip "„šš¨˜­ã (F12)"
39974>>>    Set  Status_Help To '‘éœ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã ©«¦ ˜¨®œå¦ ®à¨åª ¤˜ ¡˜Ÿ˜¨åœ  «˜ ›œ›¦£â¤˜ (F12)'
39975>>>
39975>>>    send Add_space
39976>>>
39976>>>    send Add_button ico_std_cut msg_cut
39977>>>    Send Add_ToolTip "€§¦¡¦§ã"
39978>>>    Set  Status_Help To "€§¦¡æ§«œ  «¦ œ§ ¢œš£â¤¦ ¡¦££á«  ¡˜  «¦ ¡¨˜«áœ  ©«¦ Clipboard"
39979>>>
39979>>>    send Add_button ico_std_copy msg_copy
39980>>>    Send Add_ToolTip "€¤« š¨˜­ã"
39981>>>    Set  Status_Help To "€¤« š¨á­œ  «¦ œ§ ¢œš£â¤¦ ¡¦££á«  ¡˜  «¦ ¡¨˜«áœ  ©«¦ Clipboard"
39982>>>
39982>>>    send Add_button ico_std_paste msg_paste
39983>>>    Send Add_ToolTip "„ ©˜šàšã"
39984>>>    Set  Status_Help To "„ ©ášœ  §œ¨ œ®æ£œ¤˜ ˜§æ «¦ Clipboard"
39985>>>
39985>>>    //send Add_button (ico_user+19) msg_DoPrint
39985>>>    send Add_button ICO_STD_PRINT msg_DoPrint
39986>>>    Send Add_ToolTip "„¡«ç§à©ž"
39987>>>    Set  Status_Help To "„¡«¬§é©œ ª ‰œ £â¤à¤"
39988>>>
39988>>>    send Add_space              
39989>>>
39989>>>    //send Add_button (ico_user+20) msg_DoPrintScreen
39989>>>    send Add_button ICO_STD_PRINTPRE msg_DoPrintScreen
39990>>>    Send Add_ToolTip "„¡«ç§à©ž ¦Ÿæ¤žª"
39991>>>    Set  Status_Help To "„¡«ç§à©ž ¦Ÿæ¤žª ©«¦ Clipboard ã ©«¦¤ „¡«à§à«ã"
39992>>>    
39992>>>    Object oOutputSelector Is A ComboFormSub
39994>>>       Set Entry_State Item 0 to FALSE
39995>>>       Set Combo_Sort_State to FALSE
39996>>>       Set GuiLocation to 1 480
39997>>>       Set Size to 14 55
39998>>>       Set Status_Help to "„§â¢œ¥œ §¦¬ Ÿ˜ šå¤œ  ž œ¡«ç§à©ž «žª ¦Ÿæ¤žª"
39999>>>       Set Focus_Mode to Pointer_Only
40000>>>       Set Skip_State to True
40001>>>       
40001>>>       Procedure Combo_Fill_List
40003>>>       
40003>>>           Send Combo_Add_Item '„¡«¬§à«ãª'
40004>>>           Send Combo_Add_Item 'Clipboard'
40005>>>       
40005>>>       End_Procedure
40006>>>       
40006>>>       Procedure OnChange
40008>>>           String liValue
40009>>>           
40009>>>           Get Value Item 0 to liValue 
40010>>>           If (Combo_Value(Self,0) = liValue) Set piOutputDestination to 0
40013>>>           Else If (Combo_Value(Self,1) = liValue) Set piOutputDestination to 1
40017>>>       End_Procedure
40018>>>       
40018>>>    End_Object   // oReportSelector
40019>>>    
40019>>>    For WindowIndex from 1 to 12
40025>>>>
40025>>>        send Add_space              
40026>>>    Loop
40027>>>>
40027>>>
40027>>>    send Add_button (ico_user+7) msg_DoRebuild
40028>>>    Send Add_ToolTip "„§ › æ¨Ÿà©ž á©žª ƒœ›¦£â¤à¤"
40029>>>    Set  Status_Help To "€¤˜¡˜«˜©¡œ¬ã «à¤ ˆndexes (Reindex) ¡˜  ¡˜Ÿ˜¨ ©£æª «¦¬ª (CleanUp) ˜¤ ®¨œ áœ«˜ "
40030>>>
40030>>>    send Add_button (ico_user+18) msg_DoPopupCalc
40031>>>    Send Add_ToolTip "€¨ Ÿ£¦£ž®˜¤ã"
40032>>>    Set  Status_Help To ""
40033>>>
40033>>>    send Add_button (ico_user+21) msg_DoPopupSetup
40034>>>    Send Add_ToolTip "Setup Client"
40035>>>    Set  Status_Help To "Machine Settings Network Parameter"
40036>>>
40036>>>    send Add_space
40037>>>
40037>>>    send Add_button ico_std_properties msg_DoShowPropertiesPage
40038>>>    Send Add_ToolTip "ˆ› æ«ž«œª"
40039>>>    Set  Status_Help To "ˆ› æ«ž«œª ¡˜  ®˜¨˜¡«ž¨ ©« ¡á «žª œ­˜¨£¦šãª"
40040>>>
40040>>>    send Add_button ico_std_help msg_Help_On_Topic
40041>>>    Send Add_ToolTip "¦ãŸœ ˜ (F1)"
40042>>>    Set  Status_Help To "‰¢ã©ž ©¬©«ã£˜«¦ª ™¦žŸœå˜ª (F1)"
40043>>>
40043>>>    send Add_space
40044>>>
40044>>>    send Add_button (ico_user+13) msg_Exit_Application
40045>>>    Send Add_ToolTip "„¥¦›¦ª (Alt+F4)"
40046>>>    Set  Status_Help To "„¥¦›¦ ˜§æ „­˜¨£¦šã (Alt+F4)"
40047>>>
40047>>>    Procedure DoPrintScreen
40049>>>        Integer iVoid aiWhereTo
40050>>>        
40050>>>        Get piOutputDestination to aiWhereTo
40051>>>        If (aiWhereTo = 0) Send Print_Screen to Desktop ""
40054>>>        Else If (aiWhereTo = 1) Move (Keybd_Event(VK_SNAPSHOT, 0, 0, 0)) To iVoid
40058>>>    End_Procedure
40059>>>
40059>>>
40059>>>    Procedure Redirect_Button_Message integer Itm
40061>>>        Integer msg# liObj liCls
40062>>>        
40062>>>        Get Message   item itm  to Msg#
40063>>>        If (Msg_DoRebuild = Msg#)  Send DoRebuild
40066>>>        Else If (msg_Help_On_Topic = Msg#) Send Help_On_Topic
40070>>>        Else If (msg_Exit_Application = Msg#) Send Exit_Application
40074>>>        Else If (msg_DoPopupCalc = Msg#) Send DoPopupCalc
40078>>>        Else If (msg_DoPrintScreen = Msg#) Send DoPrintScreen
40082>>>        Else If (msg_DoShowPropertiesPage = Msg#) Send DoShowPropertiesPage
40086>>>        Else If (msg_DoPopupSetup = Msg#) Send DoPopupSetup
40090>>>        Else Forward Send Redirect_Button_Message Itm
40093>>>    End_Procedure // Redirect_Message
40094>>>
40094>>>    Procedure DoChangeToolBarIcon Integer iItem Integer iImageIndex
40096>>>        Integer hoClient
40097>>>        
40097>>>        Delegate Get Client_Id To hoClient
40099>>>        Delegate Set Client_Id To 0
40101>>>        //----Changes the Icon
40101>>>        //Set Toolbar_State To False
40101>>>        //Set Form_Image_Index Item iItem To iImageIndex
40101>>>        //Set Toolbar_State To True
40101>>>        //----Changes the Shadow_State
40101>>>        Set Shadow_State Item iItem To iImageIndex
40102>>>        Delegate Set Client_Id To hoClient
40104>>>    End_Procedure // DoChangeToolBarIcon
40105>>>
40105>>>    Procedure Page_Object Integer iState
40107>>>      Integer hoCurrentObject
40108>>>      
40108>>>      Forward Send Page_Object iState
40110>>>      Move (Self) to hoCurrentObject
40111>>>      Send Add_Focus To (oOutputSelector(SELF)) hoCurrentObject
40112>>>    End_Procedure   // Page_Object
40113>>>
40113>>>    
40113>>>    Procedure Page Integer iState
40115>>>        Forward Send Page iState
40117>>>        Set Shadow_State Item 40 to (piPropertiesObjectId(Main_Menu(Self))=0)
40118>>>        If iState Begin
40120>>>             //Set Timer_Active_State Of (oToolBarTimer (Self)) To True
40120>>>        End
40120>>>>
40120>>>    End_Procedure
40121>>>    
40121>>>//    Object oToolBarTimer Is A DfTimer
40121>>>//        Procedure OnTimer
40121>>>//           Local Integer hoFocus bIsDeo bState hoToolBar bIsModal
40121>>>//           
40121>>>//           Get Focus To hoFocus
40121>>>//           If hoFocus Gt Desktop Begin
40121>>>//                Get Is_Function Get_Modal_State hoFocus Dftrue To bIsModal
40121>>>//                // **WvA: 11-10-1999, we should not check the DEO object any more if 
40121>>>//                //                    if it is a modal panel, this could throw up error messages.
40121>>>//                If (bIsModal = DfFalse) Begin
40121>>>//                  Get Is_Function Get_DEO_Object hoFocus Dftrue To bIsDeo
40121>>>//                End
40121>>>//                Move (bIsDeo = Dffalse Or bIsModal = Dftrue) To bState
40121>>>//                Move (Parent (Self)) To hoToolBar
40121>>>//                If (pbToolbarWasDisabled (hoToolBar)) Ne bState Begin
40121>>>//                   Set pbToolbarWasDisabled Of hoToolBar To bState
40121>>>//                   Set Shadow_State Of hoToolBar Item 0 To bState
40121>>>//                   Set Shadow_State Of hoToolBar Item 1 To bState
40121>>>//                   Set Shadow_State Of hoToolBar Item 2 To bState
40121>>>//                   Set Shadow_State Of hoToolBar Item 3 To bState
40121>>>//                   Set Shadow_State Of hoToolBar Item 5 To bState
40121>>>//                   Set Shadow_State Of hoToolBar Item 6 To bState
40121>>>//                   Set Shadow_State Of hoToolBar Item 7 To bState
40121>>>//                   Set Shadow_State Of hoToolBar Item 9 To bState
40121>>>//                   Set Shadow_State Of hoToolBar Item 10 To bState
40121>>>//                End
40121>>>//           End
40121>>>//       End_Procedure // OnTimer
40121>>>//   End_Object // oToolBarTimer
40121>>>   
40121>>>End_Object
40122>>>
40122>>>
40122>    
40122>    Object Client_Area is a AppClientAreasub
40124>
40124>        //AB-ClientStoreTopStart
40124>        String  Plhktro_BIP  Plhktro_Esc  Plhktro_N11  Plhktro_N00  Plhktro_FS  Plhktro_AAA  Plhktro_DSI
40124>        String  Plhktro_SO   Plhktro_DC4    //expanded for 1 line
40124>        String  Plhktro_SI   Plhktro_DC2    //condesed
40124>        String  Plhktro_PAV                 //underline
40124>        String  Plhktro_EEE  Plhktro_FFF    //emphasized
40124>        String  Plhktro_GGG  Plhktro_HHH    //double strike
40124>        String  Plhktro_WWW                 //expanded
40124>        string  Plhktro_Q Plhktro_160
40124>        Integer giviewid
40124>        String  gsviewname
40124>        
40124>        Use DD_Sec.Sub
INCLUDING FILE: DD_SEC.SUB
ERROR: 52 Bad format of expression (operator)  ON LINE: 0 (40124) OF FILE: C:\VDF6\VDF6.SUB\SUBCLASS\DD_SEC.SUB
ERROR: 4121 Operation aborted  ON LINE: 0 (40124) OF FILE: C:\VDF6\VDF6.SUB\SUBCLASS\DD_SEC.SUB
Summary
Memory Available: 2147483647
Total Errors   : 4
Total Symbols  : 23755
Total Resources: 0
Total Commands : 40123
Total Windows  : 1
Total Pages    : 1
Static Data    : 274963
Message area   : 201422
Total Blocks   : 13384
4 ERRORS HAVE BEEN FOUND.
